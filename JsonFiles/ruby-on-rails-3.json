{"count":34621,"tag":"ruby-on-rails-3","questions":[{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13280927,"title":"Ruby on Rails - continually looping through the new/create action with AJAX","body":"<p>I have a Rails controller set up that when a user creates a new record, it will redirect again to the new action and populate the form with new data, and this can continue on in a loop, creating a new record and getting redirected to the new action.  What I am having trouble with is adding AJAX to this so that the user can stay in this loop without the page reloading.  Here is my code without AJAX:</p>\n\n<pre><code>class ResponsesController\n def new\n   @response = Response.new\n   @answer_a = Answer.find(rand(1..100))\n   @answer_b = Answer.find(rand(1..100))\n   @answer_c = Answer.find(rand(1..100))\n end\n\n def create\n   @response = current_user.responses.build(params[:response])\n   if @response.save\n      respond_to do |format|\n        format.html { redirect_to new_response_path }\n        format.js\n      end\n   else\n      render 'new'\n   end\n end\nend\n</code></pre>\n\n<p><strong>new.html.erb</strong></p>\n\n<pre><code> &lt;div id=\"response_form\"&gt;\n   &lt;%= render 'form' %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code> &lt;%= form_for @response do |f| %&gt;   \n    &lt;%= f.radio_button :user_answer, @answer_a.id %&gt; \n    &lt;%= @answer_a.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_b.id %&gt; \n    &lt;%= @answer_b.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_c.id %&gt; \n    &lt;%= @answer_c.description %&gt;\n    &lt;%= f.submit \"Answer\" %&gt;                \n &lt;% end %&gt;\n</code></pre>\n\n<p>Below is my attempt to add AJAX.  However, it is going to the show action and doing an update.  How can I fix my code so that it keeps redirecting to the new action and the user can continue to create new records on an infinite loop?</p>\n\n<pre><code> def create\n   @answer_a = Answer.find(rand(1..100))\n   @answer_b = Answer.find(rand(1..100))\n   @answer_c = Answer.find(rand(1..100))\n   @response = current_user.responses.build(params[:response])\n   if @response.save\n      respond_to do |format|\n        format.html { redirect_to new_response_path }\n        format.js\n      end\n   else\n      render 'new'\n   end\n end\n</code></pre>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code> &lt;%= form_for @response, :remote =&gt; true do |f| %&gt;  \n    &lt;%= f.radio_button :user_answer, @answer_a.id %&gt; \n    &lt;%= @answer_a.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_b.id %&gt; \n    &lt;%= @answer_b.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_c.id %&gt; \n    &lt;%= @answer_c.description %&gt;\n    &lt;%= f.submit \"Answer\" %&gt;                \n &lt;% end %&gt;\n</code></pre>\n\n<p><strong>create.js.erb</strong></p>\n\n<pre><code> $('#response_form').html('&lt;%= j render(\"form\") %&gt;');\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13280949,"title":"Rails append type to join table with has_many :through and association extensions","body":"<p>I have an AR association with extensions in Rails similar to the example presented in this link:\n<a href=\"http://railsadventures.wordpress.com/2012/08/28/activerecord-association-extensions/\" rel=\"nofollow\">ActiveRecord Association Extensions</a></p>\n\n<pre><code>has_many :issues, :through =&gt; :qbert_issues do\n  def tracking\n    where(\"qbert_issues.kind = ?\", \"tracking\")\n  end\n\n  def blocking\n    where(\"qbert_issues.kind = ?\", \"blocking\")\n  end\nend\n</code></pre>\n\n<p>As shown above, mine is multi-typed... I need to populate a 'kind' column in my join table.  Ideally, this should just work:</p>\n\n<pre><code>q = QBert.find(123)\nq.issues.tracking &lt;&lt; Issue.find(234)\n</code></pre>\n\n<p>So, what the article suggests is overloading <code>&lt;&lt;</code> and doing something like this:</p>\n\n<pre><code>has_many :issues, ... do\n  ...\n  def &lt;&lt;(issue)\n    issue.kind = \"UserAccount\"\n    proxy_association.owner.issues += [issue]\n  end\nend\n</code></pre>\n\n<p>Which would be nice, if kind was static.</p>\n\n<p>It looks like I can do this...</p>\n\n<pre><code>has_many :issues, ... do\n  ...\n  def &lt;&lt;(*args)\n    issue, kind = args.flatten\n    issue.kind = kind\n    proxy_association.owner.issues += [issue]\n  end\nend\n</code></pre>\n\n<p>Which would allow me to do this at the very least:</p>\n\n<pre><code>q = QBert.find(123)\nq.issues.tracking &lt;&lt; [Issue.find(234), :tracking]\n</code></pre>\n\n<p>That doesn't seem very DRY to me...is there a better way?  Bonus points if you take into account that the kind accessor is off a join table <code>qbert_issues</code>.  I'm guessing I just have to add the association manually through the <code>QBertIssue</code> model directly. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solr","sunspot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13280386,"title":"friendly SEO urls with sunspot and rails 3","body":"<p>How can create SEO friendly url using using sunspot?</p>\n\n<p>I want to convert a search from this:</p>\n\n<pre><code>http://localhost:3000/restaurant?utf8=&amp;search=newyork\n</code></pre>\n\n<p>To something like this:</p>\n\n<pre><code>http://localhost:3000/restaurant/newyork\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","radio-button"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13281194,"title":"Radio Button Selection Sticking After Search","body":"<p>This question is similar to my last question, but instead of a select box I would like to implement it on two radio buttons. I would like a Male radio button and a Female radio button, represented by M and F, and whenever you select one and hit go, the page refreshes with the previously checked button. I am using rails 3 and twitter bootstrap I can post my code if necessary.</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["ruby-on-rails-3","simple-form"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":341,"score":1,"question_id":10572969,"title":"Rails simple_form pre-populated input values lost during server side form validation","body":"<p>I have a simple_form in my rails app that I want to pre-populate\nsome of the fields with URL parameters.</p>\n\n<p>Example URL is:</p>\n\n<pre><code>http://localhost:3000/surveys/new?phone=8675309\n</code></pre>\n\n<p>This pre-populate the phone field corretly using this code:</p>\n\n<pre><code>&lt;%= simple_form_for @survey, :html =&gt; { :class =&gt; 'form-horizontal' } do |f| %&gt;\n&lt;%= f.input :state, :required =&gt; true %&gt;\n&lt;%= f.input :zip, :required =&gt; true %&gt;\n&lt;%= f.input :phone, :required =&gt; true, :input_html =&gt; { :value =&gt; params['phone'] } %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem is if the form is submitted without a required field\nthe form is reloaded but the phone input value is not retained.</p>\n\n<p>If the form is submitted without a value for zip\nthe reloaded page with validation errors in red URL is now:</p>\n\n<pre><code>http://localhost:3000/surveys\n</code></pre>\n\n<p>If, say, the state field is correct but no zip code the form is reloaded\nwith an error msg saying zip is required.</p>\n\n<p>The state value is retained however the phone is not.</p>\n\n<p>I guess it has to do with :value => params['phone'] in the f.input for the phone.</p>\n\n<p>Is there anyway I can populate the simple_form with URL paramenters\non it's initial load and have those value retained if the serverside validation fails?</p>\n\n<p>Many thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","memcached","dalli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13281488,"title":"uninitialized constant Dalli (NameError) in staging but not production","body":"<p>So I get a <code>uninitialized constant Dalli (NameError)</code> when I push my ruby on rails app to my staging on heroku, but it works fine in production. my <code>production.rb</code> and <code>staging.rb</code> files are the exact same except for a mailer host value. Could someone help? Thanks!</p>\n\n<p>production.rb:</p>\n\n<pre><code>Novulty::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Enable Rails's static asset server\n  config.serve_static_assets = true\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Compress CSS using yui-compressor gem\n  config.assets.css_compressor = :yui\n\n  # Compress JS using uglifier gem\n  config.assets.js_compressor = :uglifier\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  config.force_ssl = false\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  config.assets.precompile += %w[ *.js *.css ]\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.raise_delivery_errors = false\n  config.action_mailer.default :charset =&gt; \"utf-8\"\n\n  # Use SMTP to send mail\n  config.action_mailer.delivery_method = :smtp\n\n  # Use Gmail to send smtp mail\n  config.action_mailer.smtp_settings = {\n    :address              =&gt; \"smtp.gmail.com\",\n    :port                 =&gt; 587,\n    :domain               =&gt; \"novulty.com\",\n    :user_name            =&gt; ENV[\"GMAIL_USERNAME\"],\n    :password             =&gt; ENV[\"GMAIL_PASSWORD\"],\n    :authentication       =&gt; :plain,\n    :enable_starttls_auto =&gt; true\n  }\n\n  # Specify what domain to use for mailer URLs\n  config.action_mailer.default_url_options = {\n    host: \"novulty.com\"\n  }\n\n  # Specify how long an item should stay cached by setting the Cache-Control headers\n  config.static_cache_control = \"public, max-age=2592000\"\n\n  # Specify Dalli as the storage backends for Rails’ built-in Rack::Cache integration\n  config.action_dispatch.rack_cache = {\n    :metastore    =&gt; Dalli::Client.new,\n    :entitystore  =&gt; 'file:tmp/cache/rack/body',\n    :allow_reload =&gt; false\n  }\nend\n</code></pre>\n\n<p>staging.rb:</p>\n\n<pre><code>Novulty::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Enable Rails's static asset server\n  config.serve_static_assets = true\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Compress CSS using yui-compressor gem\n  config.assets.css_compressor = :yui\n\n  # Compress JS using uglifier gem\n  config.assets.js_compressor = :uglifier\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  config.force_ssl = false\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  config.assets.precompile += %w[ *.js *.css ]\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.raise_delivery_errors = false\n  config.action_mailer.default :charset =&gt; \"utf-8\"\n\n  # Use SMTP to send mail\n  config.action_mailer.delivery_method = :smtp\n\n  # Use Gmail to send smtp mail\n  config.action_mailer.smtp_settings = {\n    :address              =&gt; \"smtp.gmail.com\",\n    :port                 =&gt; 587,\n    :domain               =&gt; \"novulty.com\",\n    :user_name            =&gt; ENV[\"GMAIL_USERNAME\"],\n    :password             =&gt; ENV[\"GMAIL_PASSWORD\"],\n    :authentication       =&gt; :plain,\n    :enable_starttls_auto =&gt; true\n  }\n\n  # Specify what domain to use for mailer URLs\n  config.action_mailer.default_url_options = {\n    host: \"novultystaging.herokuapp.com\"\n  }\n\n  # Specify how long an item should stay cached by setting the Cache-Control headers\n  config.static_cache_control = \"public, max-age=2592000\"\n\n  # Specify Dalli as the storage backends for Rails’ built-in Rack::Cache integration\n  config.action_dispatch.rack_cache = {\n    :metastore    =&gt; Dalli::Client.new,\n    :entitystore  =&gt; 'file:tmp/cache/rack/body',\n    :allow_reload =&gt; false\n  }\nend\n</code></pre>\n\n<p>production.rb:</p>\n\n<pre><code>require File.expand_path('../boot', __FILE__)\n\nrequire 'rails/all'\n\nif defined?(Bundler)\n  # If you precompile assets before deploying to production, use this line\n  Bundler.require(*Rails.groups(:assets =&gt; %w(development test)))\n  # If you want your assets lazily compiled in production, use this line\n  # Bundler.require(:default, :assets, Rails.env)\nend\n\nmodule Novulty\n  class Application &lt; Rails::Application\n    # Settings in config/environments/* take precedence over those specified here.\n    # Application configuration should go into files in config/initializers\n    # -- all .rb files in that directory are automatically loaded.\n\n    # Custom directories with classes and modules you want to be autoloadable.\n    # config.autoload_paths += %W(#{config.root}/extras)\n\n    # Only load the plugins named here, in the order given (default is alphabetical).\n    # :all can be used as a placeholder for all plugins not explicitly named.\n    # config.plugins = [ :exception_notification, :ssl_requirement, :all ]\n\n    # Activate observers that should always be running.\n    # config.active_record.observers = :cacher, :garbage_collector, :forum_observer\n\n    # Set Time.zone default to the specified zone and make Active Record auto-convert to this zone.\n    # Run \"rake -D time\" for a list of tasks for finding time zone names. Default is UTC.\n    # config.time_zone = 'Central Time (US &amp; Canada)'\n\n    # Use dalli cache store in production\n    config.cache_store = :dalli_store\n\n    # The default locale is :en and all translations from config/locales/*.rb,yml are auto loaded.\n    # config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]\n    # config.i18n.default_locale = :de\n\n    # Add Font-Awesome support (add app/assets/font to the asset path)\n    config.assets.paths &lt;&lt; Rails.root.join(\"app\", \"assets\", \"fonts\")\n\n    # Configure the default encoding used in templates for Ruby 1.9.\n    config.encoding = \"utf-8\"\n\n    # Configure sensitive parameters which will be filtered from the log file.\n    config.filter_parameters += [:password]\n\n    # Enable escaping HTML in JSON.\n    config.active_support.escape_html_entities_in_json = true\n\n    # Use SQL instead of Active Record's schema dumper when creating the database.\n    # This is necessary if your schema can't be completely dumped by the schema dumper,\n    # like if you have constraints or database-specific column types\n    # config.active_record.schema_format = :sql\n\n    # Enforce whitelist mode for mass assignment.\n    # This will create an empty whitelist of attributes available for mass-assignment for all models\n    # in your app. As such, your models will need to explicitly whitelist or blacklist accessible\n    # parameters by using an attr_accessible or attr_protected declaration.\n    config.active_record.whitelist_attributes = true\n\n    # Enable the asset pipeline\n    config.assets.enabled = true\n\n    # Version of your assets, change this if you want to expire all your assets\n    config.assets.version = '1.0'\n\n    config.assets.initialize_on_precompile = false\n  end\nend\n</code></pre>\n\n<p>Here is the output of <code>heroku logs --tail --remote staging</code>:</p>\n\n<pre><code>2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:571:in `block in &lt;class:Engine&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n2012-11-08T02:04:59+00:00 app[web.1]: /app/config/environments/staging.rb:96:in `block in &lt;top (required)&gt;': uninitialized constant Dalli (NameError)\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:24:in `class_eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:24:in `configure'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config/environments/staging.rb:1:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:4:in `require'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:4:in `block in &lt;main&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:1:in `new'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from script/rails:6:in `require'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:70:in `start'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:46:in `app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n2012-11-08T02:04:59+00:00 app[web.1]:   from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Feel free to check out my code at <a href=\"http://www.github.com/sambaek/novulty\" rel=\"nofollow\">www.github.com/sambaek/novulty</a></p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-ui","heroku","modal"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13281514,"title":"My Rails App works on localhost but not on Heroku","body":"<p>I'm new to rails and currently I have a working Rails App which works perfectly on localhost but when I deployed it into Heroku.com I can still see the home page and as I navigate to another page it shows me the error. I tried using this command \"heroku logs\" </p>\n\n<p>Here the logs</p>\n\n<pre><code>ActionView::Template::Error (undefined method `link_to_modal' for #&lt;#&lt;Class:0x000000046b8a10&gt;:0x000000046b4500&gt;):\n</code></pre>\n\n<p>Could it be the reason that I have 'link_to_modal' method in my view ??</p>\n\n<pre><code>&lt;p class=\"text\"&gt;&lt;%= link_to_modal \"+Add Album\", \"#addalbum\" %&gt;&lt;p&gt;\n</code></pre>\n\n<p>It works perfectly normally on my computer but not on heroku so I'm wondering what can I do with that and this method came with this gem that I'm using <a href=\"https://github.com/dei79/jquery-modal-rails\" rel=\"nofollow\">\"jquery-modal-rails\"</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","asset-pipeline"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13213911,"title":"Manifest.yml empty","body":"<p>Whenever I run <code>rake assets:precompile</code>, I get a <code>manifest.yml</code> file that looks like:</p>\n\n<pre><code>--- {}\n</code></pre>\n\n<p>Something must be going wrong. Here is my output for <code>rake assets:precompile --trace</code>:</p>\n\n<pre><code>** Invoke assets:precompile (first_time)\n** Execute assets:precompile\n/Users/user/.rvm/rubies/ruby-1.9.3-p194/bin/ruby /Users/user/.rvm/gems/ruby-1.9.3-p194@global/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace\n** Invoke assets:precompile:all (first_time)\n** Execute assets:precompile:all\n** Invoke assets:precompile:primary (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke tmp:cache:clear (first_time)\n** Execute tmp:cache:clear\n** Execute assets:precompile:primary\n** Invoke assets:precompile:nondigest (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke tmp:cache:clear (first_time)\n** Execute tmp:cache:clear\n** Execute assets:precompile:nondigest\n</code></pre>\n\n<p>Can someone help?? Thanks!</p>\n\n<h2>UPDATE:</h2>\n\n<p>Feel free to look at my code at <a href=\"http://www.github.com/sambaek/novulty\" rel=\"nofollow\">www.github.com/sambaek/novulty</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13281114,"title":"Hashes and Curly Braces in Ruby Methods","body":"<p>I have this method in one of my view files:</p>\n\n<pre><code>&lt;%= link_to \"Sign up now!\", signup_path, class: \"btn\", id: \"some_id\" %&gt;\n</code></pre>\n\n<p>Is this correct, or would I have to attach the curly braces around the two hashes like so:</p>\n\n<pre><code>&lt;%= link_to \"Sign up now!\", signup_path, { class: \"btn\", id: \"some_id\" } %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13278259,"title":"Activerecord 3 eager load association and avoiding n+1 queries","body":"<p>I'm trying to run this query:</p>\n\n<pre><code>sprints = Sprint\n  .includes(:team)\n  .joins(:team)\n  .where(is_private: false)\n</code></pre>\n\n<p>Which work fine except for one thing, I would like to have only one query instead of what I got right now. The inner join is right <strong>but somehow it does one query for every team</strong> instead of using the data within the first query. I can not seem to figure out why.</p>\n\n<p>Here are my models:</p>\n\n<pre><code>class Sprint &lt; ActiveRecord::Base\n  extend FriendlyId\n  friendly_id :name, :use =&gt; :slugged\n  belongs_to :team\n\n\nclass Team &lt; ActiveRecord::Base\n  extend FriendlyId\n  friendly_id :name, :use =&gt; :slugged\n  attr_accessible :name, :timezone\n\n  has_many :sprints, :autosave =&gt; true, :dependent =&gt; :destroy\n</code></pre>\n\n<p>I've tried with or without joins or includes, the best I got so far is a nice inner join select on sprints followed by one select for every team I have. </p>\n\n<p>It looks like this in the log:</p>\n\n<pre><code>EXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"sprints\".\"id\" AS t0_r0, \"sprints\".\"name\" \nAS t0_r1, \"sprints\".\"start_date\" AS t0_r2, \"sprints\".\"duration\" AS t0_r3,\n\"sprints\".\"total_points\" AS t0_r4, \"sprints\".\"created_at\" AS t0_r5,\n\"sprints\".\"updated_at\" AS t0_r6, \"sprints\".\"slug\" AS t0_r7, \"sprints\".\"include_weekend\"\nAS t0_r8, \"sprints\".\"team_id\" AS t0_r9, \"sprints\".\"integration_id\" AS t0_r10,\n\"sprints\".\"type\" AS t0_r11, \"sprints\".\"is_private\" AS t0_r12, \"sprints\".\"note\" AS\nt0_r13, \"sprints\".\"last_sync_date\" AS t0_r14, \"teams\".\"id\" AS t1_r0, \"teams\".\"name\" AS\nt1_r1, \"teams\".\"slug\" AS t1_r2, \"teams\".\"timezone\" AS t1_r3, \"teams\".\"created_at\" AS\nt1_r4, \"teams\".\"updated_at\" AS t1_r5, \"teams\".\"integration_id\" AS t1_r6, \"teams\".\"type\"\nAS t1_r7 FROM \"sprints\" INNER JOIN \"teams\" ON \"teams\".\"id\" = \"sprints\".\"team_id\" WHERE\n\"sprints\".\"is_private\" = 'f'\n</code></pre>\n\n<p>And for the teams</p>\n\n<pre><code>EXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = 27 LIMIT 1\nEXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = 63 LIMIT 1\nEXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = 142 LIMIT 1\nEXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = 315 LIMIT 1\n</code></pre>\n\n<p><br>\nIf I don't include the joins I get this query for the sprint:</p>\n\n<pre><code>SELECT \"sprints\".* FROM \"sprints\" WHERE \"sprints\".\"is_private\" = 'f'\n</code></pre>\n\n<p>and then get all queries for the teams.</p>\n\n<p>If I don't include the includes statement I get a normal inner join without the team in the select clause.</p>\n"},{"tags":["ruby-on-rails-3","asset-pipeline"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13280031,"title":"Rails isn't loading my JS properly - ERROR bad Request-Line `'","body":"<p>I have a Rails 3.2.3 app isn't consistently loading JS files. I just started working on the JS, so I'm not sure if this just started, or if it's been this way since I started it a few days ago.</p>\n\n<p>The two other guys working on the project are not having any problems at all. But sometimes it loads all of my files, sometimes it skips some, there doesn't seem to be any pattern.</p>\n\n<p>Sometimes it loads app.js, sometimes it doesn't. Same thing with the other js files.</p>\n\n<p>I'm seeing the following show up multiple times in my rails log:</p>\n\n<p>ERROR bad Request-Line `'.</p>\n\n<p>I'm at a loss here...</p>\n\n<p>application.js:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require util\n//= require app\n//= require_tree .\n</code></pre>\n\n<p>Here is what the log file is showing:</p>\n\n<pre><code>Started GET \"/assets/user_manager.js?body=1\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /user_manager.js - 200 OK (0ms)\n\n\nStarted GET \"/assets/util.js?body=1\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /util.js - 200 OK (0ms)\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n\n\nStarted GET \"/assets/header/topnav/separator.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /header/topnav/separator.png - 200 OK (0ms)\n\n\nStarted GET \"/assets/header/pagetitle-bg.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /header/pagetitle-bg.png - 200 OK (0ms)\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n\n\nStarted GET \"/assets/header_bg.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /header_bg.png - 404 Not Found (3ms)\n\nActionController::RoutingError (No route matches [GET] \"/assets/header_bg.png\"):\n  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'\n  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'\n  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\n  rack (1.4.1) lib/rack/runtime.rb:17:in `call'\n  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n  rack (1.4.1) lib/rack/lock.rb:15:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'\n  railties (3.2.3) lib/rails/engine.rb:479:in `call'\n  railties (3.2.3) lib/rails/application.rb:220:in `call'\n  rack (1.4.1) lib/rack/c[2012-11-07 18:02:13] ERROR bad Request-Line `'.\nontent_length.rb:14:in `call'\n  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'\n  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in     start_thread'\n\n\n  Rendered /Users/rob/.rvm/gems/ruby-1.9.3-p125@admin/gems/actionpack-3.2.    3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.1ms)\n\n\nStarted GET \"/assets/background/header_blueprint.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /background/header_blueprint.png - 200 OK (0ms)\n\n\nStarted GET \"/assets/images/ui-icons_454545_256x240.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /images/ui-icons_454545_256x240.png - 404 Not Found (3ms)\n\nActionController::RoutingError (No route matches [GET] \"/assets/images/ui-icons_454545_256x240.png\"):\n  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'\n  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'\n  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\n  rack (1.4.1) lib/rack/runtime.rb:17:in `call'\n  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n  rack (1.4.1) lib/rack/lock.rb:15:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'\n  railties (3.2.3) lib/rails/engine.rb:479:in `call'\n  railties (3.2.3) lib/rails/application.rb:220:in `call'\n  rack (1.4.1) lib/rack/content_length.rb:14:in `call'\n  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'\n  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in     start_thread'\n\n\n  Rendered /Users/rob/.rvm/gems/ruby-1.9.3-p125@admin/gems/actionpack-3.2.    3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (0.8ms)\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.    \n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13281147,"title":"How to configure Rails 3 for JavaScript development","body":"<p>I'm moving an app from Rails 2 to Rails 3. I have a bunch of JavaScript files in the app, most of which are for working with Google Maps. Previously, my JS files were in public/javascripts/*.js. I noticed that they were not being loaded by any of the pages that used javascript_include_tag, which writes a JavaScript tag that tries to load the JS file from /assets/*.js. (e.g. /assets/application.js).</p>\n\n<p>I read that Rails 3 expects JS files to be located in app/assets/javascripts/*.js. So I moved my JS files there, but they still won't be accessible at /assets/application.js, unless I run <strong>bundle exec rake assets:precompile</strong> first.</p>\n\n<p>I can't have my JS development cycle be:</p>\n\n<ol>\n<li>Make change to JS</li>\n<li>Run bundle exec rake assets:precompile</li>\n<li>Reload browser</li>\n</ol>\n\n<p>Thats just too long. <strong>My question is how can I configure my app so that the development cycle is as follows?</strong></p>\n\n<ol>\n<li>Make change to JS</li>\n<li>Reload browser</li>\n</ol>\n\n<p>So far I've tried:</p>\n\n<ul>\n<li>Enabling the line that reads \"Bundler.require(:default, :assets,\nRails.env)\" in config/application.rb </li>\n<li>Setting config.assets.enabled = false (and true) in config/application.rb</li>\n</ul>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13261762,"title":"Populating Rails Fields Based on Calculation","body":"<p>In my Rails 3.2 app, I want to populate some fields based on calculations where the field values users enter are the variables.  However, with my current code, the calculation seems to only work based on the values already in the database - it doesn't calculate correctly on the initial save, but it will calculate correctly if I go back in the record and save it a second time.</p>\n\n<p>I have these four fields in my model (Trade):</p>\n\n<ol>\n<li>entry_price</li>\n<li>exit_price</li>\n<li>percent_result</li>\n<li>dollar_result</li>\n</ol>\n\n<p>The user creates a trade with an entry price, and then later edits the trade with the exit_price.  When the exit_price is entered, the app should calculate percent_result and dollar_result.  However, right now, these result fields are not populating correctly on the first update - it seems to be because it doesn't read the exit_price from the field (when a user enters it in the form), only once it is saved in the DB.</p>\n\n<p>What is going wrong in my controller?</p>\n\n<p>my controller:</p>\n\n<pre><code>def update\n  @trade = Trade.find(params[:id])\n  exit_price = params[:trade][:exit_price]\n\n  if !exit_price.blank?\n    @trade.percent_result = ((exit_price.to_f - @trade.entry_price)/@trade.entry_price) * 100\n    @trade.dollar_result = exit_price.to_f - @trade.entry_price \n  end\n\n  params[:trade][:exit_date] = Date.strptime(params[:trade][:exit_date], '%m/%d/%Y') unless params[:trade][:exit_date].blank?\n  params[:trade][:entry_date] = Date.strptime(params[:trade][:entry_date], '%m/%d/%Y') unless params[:trade][:entry_date].blank?\n  respond_to do |format|\n    if @trade.update_attributes(params[:trade])\n      format.html { redirect_to @trade, :flash =&gt; {:share =&gt;\"Your trade was successfully updated.  Don't forget to share it with your friends, so you can profit together!\"} }\n      format.json { head :no_content }\n    else\n      format.html { render action: \"edit\" }\n      format.json { render json: @trade.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>the view</p>\n\n<pre><code>&lt;%= simple_form_for(@trade, :html=&gt;{:class=&gt; \"form-horizontal well\"})  do |f| %&gt;  \n  &lt;%= f.text_field :entry_price, :class=&gt;\"input-small\" %&gt;\n  &lt;%= f.text_field :exit_price, :class=&gt;\"input-small\" %&gt;\n\n  &lt;%= submit_tag \"Edit Trade\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13281108,"title":"Parsing structured and semi-structured text with hundreds of tags with Ruby","body":"<p>I will be processing batches of 10,000-50,000 records with roughly 200-400 characters in each record.  I expect the number of search terms I could have would be no more than 1500 (all related to local businesses).</p>\n\n<p>I want to create a function that compares the structured tags with a list of terms to tag the data.  </p>\n\n<p>These terms are based on business descriptions.  So, for example, a <code>[Jazz Bar]</code>, <code>[Nightclub]</code>, <code>[Sports Bar]</code>, or <code>[Wine Bar]</code> would all correspond to queries for <code>[Bar]</code>.</p>\n\n<p>Usually this data has some kind of existing tag, so I can also create a strict hierarchy for the first pass and then do a second pass if there is no definitive existing tag.</p>\n\n<p>What is the most performance sensitive way to implement this?  I could have a table with all the keywords and try to match them against each piece of data.  This is straightforward in the case where I am matching the existing tag, less straightforward when processing free text.</p>\n\n<p>I'm using Heroku/Postgresql</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13277938,"title":"Rails joins query","body":"<p>I have three models</p>\n\n<ul>\n<li><code>Tag</code> => <code>:id</code>, <code>:name</code></li>\n<li><code>Tagging</code> => <code>:id</code>, <code>:tag_id</code>, <code>:post_id</code></li>\n<li><code>Post</code> => <code>:id</code>, <code>:summary</code></li>\n</ul>\n\n<p>I know the id of the tag. I would like to query for all of the posts that have a specific <code>tag_id</code>, through the <code>Taggings</code> model.</p>\n\n<p>Something like</p>\n\n<pre><code>@post = Post.joins(:taggings).where(:tag_id =&gt; 17)\n</code></pre>\n\n<p>but this doesn't work because it is looking for the tag_id in the <code>Post</code> model and not the <code>Tagging</code> model. </p>\n\n<p>I'm not sure how to do this.</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":13280924,"title":"Generate next month","body":"<p>I have a table that looks like the following  <img src=\"http://i.stack.imgur.com/iLFO6.png\" alt=\"enter image description here\"></p>\n\n<p>I want to be able to generate the next and previous month when I click either of the two buttons. Not entirely sure if this is the right way to go about this. I was thinking I could try do something somewhat similar: </p>\n\n<pre><code>&lt;button id=\"nextmonth\"&gt;Next month&lt;/button&gt;  \n</code></pre>\n\n<p>JS</p>\n\n<pre><code> &lt;script&gt;$('#nextmonth').click(fuction(e) {\n       $.get('/rota_days/show.json?mon=12').success(function(data) \n        { \n\n        /* display response */ \n\n\n        });\n    });\n</code></pre>\n\n<p><strong>rota_days_controller.rb</strong></p>\n\n<pre><code>class RotaDaysController &lt; ApplicationController\n\nrespond_to :json, :html \n\ndef nextmonth \n\n   respond_with(@rota_days) \nend\nend \n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13279979,"title":"Rails: Create a survey with the data in a database table","body":"<p>I'm currently trying to create a survey which will use questions that are stored in a table. I've read <a href=\"http://railscasts.com/episodes/196-nested-model-form-part-1\" rel=\"nofollow\">nested model form part 1</a> from rails casts however i'm not getting anywhere as the questions are not displaying in the survey.</p>\n\n<p>I have three tables, one tables has the text of the questions, another table keeps the record of who entered the survey and a third table which keeps the answers from a user for the questions.</p>\n\n<p><strong>variable table</strong>:\nname: varchar\nid: integer</p>\n\n<p><strong>report table</strong>\nemployee name: varchar\ndate: date\nid: integer</p>\n\n<p><strong>report_variable table</strong>\nquestion_id\nreport_id\nanswer</p>\n\n<p>Code i modified for reports/new:</p>\n\n<pre><code> # GET /reports/new\n # GET /reports/new.json\n def new\n   @report = Report.new\n   #variable = @report.variable.build #dont know what to do here, gives an error with report_id\n   respond_to do |format|\n     format.html # new.html.erb\n     format.json { render json: @report }\n   end\n end\n</code></pre>\n\n<p>modified report/_form.html.erb</p>\n\n<pre><code>   &lt;div &gt;\n     &lt;%= f.fields_for :variable do |builder| %&gt;\n       &lt;%= render variable_fields, :f =&gt; builder %&gt;\n     &lt;% end %&gt;\n   &lt;/div&gt;\n</code></pre>\n\n<p>created report/_variable_fields.html.erb</p>\n\n<pre><code>   &lt;p&gt;\n      &lt;%= f.label :name %&gt;\n      &lt;%= f.text_field :name, :class =&gt; 'text_field' %&gt;\n   &lt;p&gt;\n</code></pre>\n\n<p>model for report_variable</p>\n\n<pre><code>class ReportVariable &lt; ActiveRecord::Base\n  attr_accessible :report_id, :value, :variable_id\n  has_and_belongs to many :reports\n  has_and_belongs to many :variables\nend\n</code></pre>\n\n<p>model for report</p>\n\n<pre><code>class Report &lt; ActiveRecord::Base\n  attr_accessible :employeeName\n  has_many :report_variable\n  has_many :variable\n\n  accepts_nested_attributes_for :report_variable\n  accepts_nested_attributes_for :variable\nend\n</code></pre>\n\n<p>Sorry if it's a simple question, im pretty new to rails.</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","asset-pipeline","scss"],"answer_count":7,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":3832,"score":11,"question_id":8158987,"title":"rails 3.1 asset pipeline css caching in development","body":"<p>I'm a bit confused as it seems like the application.css is including itself twice, once when it lists the resources from the manifest and then a cache of that.   So when I delete an individual file it still seems to stay alive inside the application.css file.</p>\n\n<h1>application.css (source)</h1>\n\n<pre><code>/*\n*= require twitter/bootstrap\n*= require_self\n*= require_tree ./common\n*= require_tree ./helpers\n*/\n</code></pre>\n\n<p>Which works as expected and outputs in dev mode all the relevant individual files</p>\n\n<h1>development.rb</h1>\n\n<pre><code>  # Do not compress assets\n  config.assets.compress = false\n\n  # Expands the lines which load the assets\n  config.assets.debug = true\n</code></pre>\n\n<h1>output</h1>\n\n<pre><code>&lt;link href=\"/assets/twitter/bootstrap.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/application.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/common/announcement.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/common/button.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;Blah blah&gt;\n</code></pre>\n\n<h1>application.css (output)</h1>\n\n<p>This should be blank?  Since all I have in my application.css file is the manifest and no actual css but instead i get all my concatenated code 106kb long.</p>\n\n<p>IE if I remove a file in the common directory, it doesn't go away.  It is no longer listed in the output but the css still appears from the application.css</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13238137,"title":"get counter nested model mongoid","body":"<p>2 models:</p>\n\n<pre><code>Class User\n include Mongoid::Document\n has_many :reports\nend\n\nClass Report\n include Mongoid::Document\n belongs_to :user\nend\n</code></pre>\n\n<p>I need a query to get all users have 6 or more reports, something like:.</p>\n\n<pre><code>Users.where(reports.count &gt; 5)\n</code></pre>\n\n<p>How can I do it?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13280514,"title":"Devise redirect after signin with username in url","body":"<p>I'm struggling with getting devise to redirect to a user's profile page after signin. My routes file looks like this:</p>\n\n<pre><code>get \"profiles/index\"\n\nget \"users/index\"\n\nget \"users/show\"\n\nauthenticated :user do\n root :to =&gt; 'home#index'\nend\nroot :to =&gt; \"home#index\"\ndevise_for :users\nresources :users\nscope \":username\", :as =&gt; \"user\" do\n match '/', :to =&gt; 'profiles#index'\nend\n</code></pre>\n\n<p>I would like it to redirect to /myusername which the user's profile page.  Thanks for your guys' help.</p>\n"},{"tags":["jquery","ruby-on-rails-3","wysihtml5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13280499,"title":"jQuery: function only works if followed by a broken function","body":"<p>It's exactly what it sounds like. I've got <a href=\"https://github.com/jhollingworth/bootstrap-wysihtml5\" rel=\"nofollow\">a groovy little plugin</a> in my Rails app that rich-texts field areas. It works fine, except for the fact that two toolbars appear when there should only be one.</p>\n\n<pre><code>$('#user_address').wysihtml5();\n</code></pre>\n\n<p>If, however, I put beneath it a similar function that refers to nothing:</p>\n\n<pre><code>$('#this_thing').this_is_broken();\n</code></pre>\n\n<p>Then it fixes the two toolbar issues but breaks all the other jQuery functions I've got going on.</p>\n\n<p>Any ideas? Sounds like a bug to me.</p>\n"},{"tags":["ruby-on-rails-3","timezone","params"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13276001,"title":"Rails time zone from URL params","body":"<p>I'm trying to allow non-signed-in users to change a time of day display, and it seems like the best way would be through params in the url.  I have:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  around_filter :use_time_zone\n\n  private\n    def use_time_zone(&amp;block)\n      Time.use_zone((params[:time] || Time.zone), &amp;block)\n    end\nend\n</code></pre>\n\n<p>And this works great for something like 'www.mysite.com?time=Hawaii'</p>\n\n<p>However, it cannot handle some of the more intricate ones (e.g. 'Eastern Time (US &amp; Canada)'), plus this looks bad in the address bar.</p>\n\n<p>Is there a way to simply use UTC offset with DST (or any other abbreviated form like 'PDT') with params?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","facebook","devise","omniauth"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":246,"score":2,"question_id":7471763,"title":"Omniauth + Facebook Mutual Friends Count","body":"<p>Is there a better/easier way to find mutual friends between users than creating a Friends table and logging the UIDs of each new user's friends? (Using Devise + Omniauth on Rails 3)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":52,"score":5,"question_id":13277077,"title":"Is changing `require` to concatenate Ruby files brilliant or crazy?","body":"<p>When booting a Rails application with lots of dependencies, a lot of time is spent (I think) in <code>require</code>ing files.</p>\n\n<p>Suppose you were to create a deploy process that converted all <code>require</code> statements to file concatenations, using the same rules (don't get the same file twice, etc). Essentially, it would treat Ruby the way the asset pipeline treats javascript.</p>\n\n<p>Would this make a real speed difference? Would it create any issues - for instance, with variable scope - other than making it harder to trace errors to their original source files? </p>\n\n<p>In short, <strong>is this brilliant or crazy?</strong></p>\n\n<h2>Update</h2>\n\n<p>As pst points out, this would be pointless in production, where the server likely loads everything once, then forks to handle new requests.</p>\n\n<p>But consider the test environment, where you boot your Rails app every time you run your tests. Pre-concatenating all your gems could have an effect similar to the Spork gem.</p>\n\n<p>I suppose my real question is <strong>how much time is spent in <code>require</code> vs parsing the contents of the files</strong>.</p>\n"},{"tags":["ruby-on-rails-3","tinymce","asset-pipeline","precompile"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":13055922,"title":"assets:precompile - permission denied - only on one computer","body":"<p>I have a rails app project folder which is on my dropbox folder.</p>\n\n<p>I work on 2 computers - home pc and a laptop (both win 7)</p>\n\n<p>If I do <code>bundle exec rake assets:precompile</code> on the pc it works fine and I see the line</p>\n\n<pre><code>C:/Ruby193/bin/ruby.exe C:/Ruby193/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets\nmkdir -p H:/My Dropbox/project/public/assets\ncp -r C:/Ruby193/lib/ruby/gems/1.9.1/gems/tinymce-rails-3.5.7.1/vendor/assets/javascripts/tinymce H:/My Dropbox/project/public/assets\n</code></pre>\n\n<p>but on the laptop I get persmission denied on one of the tinymce files and the precompilation fails..</p>\n\n<p>the app folder has permissions for everyone.. \nAny ideas why this could happen?</p>\n\n<p>Update:</p>\n\n<p>It seems it stops on files randomly.. not necessarily tinymce.\nI've set all ruby files and project file to have permissions to everyone (win 7) and set all that was read only to not be that.</p>\n\n<p>this is very frustrating</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13279933,"title":"Trouble Deploying Rails App To Heroku","body":"<p>Below is are the steps I tried to deploy my rails app to heroku. However I'm getting \"Your key with fingerprint is not authorized to access\" my application.</p>\n\n<ol>\n<li>Deleted all existing keys from ~/.ssh</li>\n<li>$ heroku keys:clear</li>\n<li>$ heroku create lunch-tr</li>\n<li>Enter your Heroku credentials.</li>\n<li>Email: adam.aahrens@gmail.com</li>\n<li>Password (typing will be hidden): </li>\n<li>Could not find an existing public key.</li>\n<li>Would you like to generate one? [Yn] Y</li>\n<li>Generating new SSH public key.</li>\n<li>Uploading SSH public key /.ssh/id_rsa.pub... done</li>\n<li>Creating lunch-tr... done, stack is cedar</li>\n<li><a href=\"http://lunch-tr.herokuapp.com/\" rel=\"nofollow\">http://lunch-tr.herokuapp.com/</a> | git@heroku.com:lunch-tr.git Git remote heroku added</li>\n<li>$ git remote -v</li>\n<li>heroku  git@heroku.com:lunch-tr.git (fetch) heroku  git@heroku.com:lunch-tr.git (push)</li>\n<li><p>$ git push heroku master</p>\n\n<p>!  Your key with fingerprint 2f:0b:2c:e9:95:b4:52:af:dc:db:9c:57:e3:f2:57:7f is not authorized to access lunch-tr. fatal: The remote end hung up unexpectedly</p></li>\n</ol>\n\n<p>Not sure what else I should try I'm running out of ideas. Thanks for any suggestions</p>\n"},{"tags":["ruby","ruby-on-rails-3","imagemagick","rmagick"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3,"score":0,"question_id":13279985,"title":"how to force build vendored gems in rails 3.01 - rmagick issue when vendored","body":"<p>I have vendored rmagick and its not behaving. Works fine when not vendored, but when vendoring using:</p>\n\n<pre><code>gem unpack rmagick --target vendor/gems\n\nFetching: rmagick-2.13.1.gem (100%)\nUnpacked gem: '/Users/joelnylund/Projects/aras/vendor/gems/rmagick-2.13.1'\n</code></pre>\n\n<p>Then When I try to load my server I get:</p>\n\n<pre><code>/Users/joelnylund/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:242:in `require': no such file to load -- RMagick2.so (LoadError)\n</code></pre>\n\n<p>I used to do \"rake gems:build:force\" to fix this on rails 2.3.5, but this gives me the same error now. How do I tell rails 3 to native build the vendored gem?</p>\n\n<p>Similar question, but no answer here:\n<a href=\"http://stackoverflow.com/questions/7169178/no-such-file-to-load-rmagick2-so\">no such file to load -- RMagick2.so</a></p>\n"},{"tags":["ruby-on-rails-3","validation","customvalidator"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3,"score":0,"question_id":13279674,"title":"rails 3 custom validation error","body":"<p>I am trying to build my own validator. I have created new folder <code>lib/validators</code> and added to <code>application.rb</code>:</p>\n\n<pre><code>config.autoload_paths += %W[\"#{config.root}/lib/validators/\"]\n</code></pre>\n\n<p>Then I have created class in <code>lib/validators</code>:</p>\n\n<pre><code>class ExistInDatabaseValidator &lt; ActiveModel::EachValidator\n  def validate_each(record, attribute, value)\n    if attribute[0..-4].constantize.first(value).nil?\n      record.errors[attribute] &lt;&lt; (options[:message] || \"Invalid value for #{attribute}\")\n    end \n  end \nend\n</code></pre>\n\n<p>and in one of my model I have:</p>\n\n<pre><code>validates :donor_id, :exist_in_database =&gt; true\n</code></pre>\n\n<p>The validator should change <code>donor_id</code> into <code>Donor</code> and checks if the record exists in the database by running <code>find()</code> method. Anyway, I get this exception eveyrtime [ no matter on which page I am ]:</p>\n\n<pre><code>NoMethodError in GiftsController#index\nundefined method `key?' for nil:NilClass\n</code></pre>\n\n<p>without any stacktrace etc, so I am not sure what causes the error and what I am doing wrong. I am also not sure if what I am trying to do makes sense, but I wanted to play a little with custom validators anyway ;)</p>\n\n<p>By the way, if I change in my model <code>:exist_in_database</code> to for example <code>:exist_abc</code>, I get error:</p>\n\n<pre><code>ArgumentError in GiftsController#index\n\nUnknown validator: 'ExistAbcValidator'\n\nApplication Trace | Framework Trace | Full Trace\napp/models/gift.rb:8:in `&lt;class:Gift&gt;'\napp/models/gift.rb:1:in `&lt;top (required)&gt;'\napp/controllers/gifts_controller.rb:1:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>so I believe the class is loaded correctly</p>\n"},{"tags":["ruby","arrays","ruby-on-rails-3","loops"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13279312,"title":"Rails 3 Return Array From Collection.each Block","body":"<p>I'm trying to return some json to the calling action. One of the params I want to pass is an array of arrays built from looping through a collection as so: </p>\n\n<pre><code>render :json =&gt; {     \n:rows =&gt; @classrooms.each do |classroom|\n          [classroom.name, classroom.students.count]\n        end    \n}  \n</code></pre>\n\n<p>However, this sets :rows to the entire collection as opposed to what I want:</p>\n\n<blockquote>\n  <p>[[classroom, students],[classroom, students],[classroom, students]]</p>\n</blockquote>\n\n<p>Is there any way of looping through the collection and returning an array in a single block?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":236,"score":6,"question_id":4045436,"title":"How to make US date format as the default when saving to a model in Rails 3","body":"<p>The US date used to be accepted/parsed correctly, but not anymore in Rails 3. The %Y-%m-%d is accepted but not %m/%d/%Y. </p>\n\n<pre><code>g = Grant.new\ng.budget_begin_date = '12/31/2010'\n#g.budget_begin_date returns nil\ng.budget_begin_date = '2010-12-31'\n#g.budget_begin_date returns Fri, 31 Dec 2010 00:00:00 UTC +00:00\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","meta-search"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":105,"score":3,"question_id":7893349,"title":"Avoiding select * queries in meta_search","body":"<p>I'm using meta_search gem on a rails 3 site and I'm finding some performance problems with the select * queries generated by meta_search fetching the BLOB fields in the DB schema. I am not willing to migrate the underlying schema to solve this problem. Is there a way to include/exclude certain fields from the search query that get generated by meta_search?</p>\n"},{"tags":["ruby-on-rails-3","upload","amazon-s3","paperclip"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":888,"score":3,"question_id":7257745,"title":"Rails 3 - Amazon S3 Paperclip EU Problem","body":"<p>I'm using:</p>\n\n<pre><code>Paperclip 2.3.16\nRails 3.0.9\nRuby 1.9.2\nAWS - S3 0.6.2\n</code></pre>\n\n<p>I'm trying to use paperclip the upload to the EU (Ireland) based bucket. I have the following in my model:</p>\n\n<pre><code>has_attached_file :image, :styles =&gt; { :grid =&gt; '90x128#', :list =&gt; '140x200#', :original =&gt; '400x548'},\n            :storage =&gt; :s3,\n                      :s3_credentials =&gt; \"#{RAILS_ROOT}/config/s3.yml\",\n                      :url  =&gt; 'flyers/:id/:style/:basename.:extension',\n                      :path =&gt; 'flyers/:id/:style/:basename.:extension',\n                      :bucket =&gt; 'fsight'\n</code></pre>\n\n<p>In my environment.rb I have set the write to use the AWS/s3 Default Host to the relevant EU one by using:</p>\n\n<pre><code>require \"aws/s3\"\nAWS::S3::DEFAULT_HOST.replace \"s3-eu-west-1.amazonaws.com\"\n</code></pre>\n\n<p>This works fine, and it allows me to upload the images, and I can verify the image upload / delete using the AWS Management consoler.</p>\n\n<p>However, I have a problem when trying to display the images on my site. The images do not load and I have identified the cause, as the URL generated uses the old default host. Eg:</p>\n\n<p><strong>What it should be:</strong>\n<a href=\"https://s3-eu-west-1.amazonaws.com/fsight/flyers/50/full/4759543368588654950.jpg\" rel=\"nofollow\">https://s3-eu-west-1.amazonaws.com/fsight/flyers/50/full/4759543368588654950.jpg</a></p>\n\n<p><strong>What it actually is:</strong> <a href=\"http://s3.amazonaws.com/fsight/flyers/50/full/4759543368588654950.jpg?1314801178\" rel=\"nofollow\">http://s3.amazonaws.com/fsight/flyers/50/full/4759543368588654950.jpg?1314801178</a></p>\n\n<p>As you can see, it uses the old default host.</p>\n\n<p>I tried placing:</p>\n\n<pre><code>Paperclip.interpolates(:s3_eu_url) do |att, style|\n    \"#{att.s3_protocol}://s3-eu-west-1.amazonaws.com/#{att.bucket_name}/#{att.path(style)}\"\nend\n</code></pre>\n\n<p>But then started receiving the following error:</p>\n\n<pre><code> wrong number of arguments (0 for 1)\n\nExtracted source (around line #9):\n\n &lt;img src= &lt;%= @event.image.url(:original) %&gt;\n</code></pre>\n\n<p>I know Paperclip has some issues with using EU Buckets, but could anybody help me with this?</p>\n"},{"tags":["ruby-on-rails-3","postgresql","activerecord","order","distinct-on"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13278856,"title":"Applying a different order to postgres \"DISTINCT ON\" using rails","body":"<p>I have a rails app that has a <code>project</code> model which <code>has_many :tasks</code>.</p>\n\n<p>Each task has a milestone date.</p>\n\n<p>To show a table of project details with next milestone date I am using:</p>\n\n<pre><code>@projects = current_user.tasks.joins(:project).select(\"distinct on (projects.id) projects.*, tasks.*\").reorder(\"projects.id, tasks.milestone ASC\")\n</code></pre>\n\n<p>This works fine.</p>\n\n<p>I now want to be able to sort the table columns.</p>\n\n<p>According to Postgres <code>DISTINCT ON</code> is not sortable, you have to wrap it in another select statement, ie <code>SELECT * FROM (SELECT DISTINCT ON....) ORDER BY column_3</code></p>\n\n<p>I did think that the column being ordered could just be worked into the SQL as required, ie (to order by project name DESC):</p>\n\n<pre><code>@projects = current_user.tasks.joins(:project).select(\"distinct on (projects.name) projects.*, tasks.*\").reorder(\"projects.name DESC, tasks.milestone ASC\")\n</code></pre>\n\n<p>which works but I also want to be able to order by milestone and that doesn't work that way.</p>\n\n<p>Can someone tell me how to convert my rails query so that it can be ordered by any of the columns?</p>\n\n<p>Thanks</p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","sqlite3","amazon-ec2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":130,"score":3,"question_id":12812721,"title":"Rails: SQLite3::CantOpenException: unable to open database file","body":"<p>I'm trying to use <code>delayed_job</code> to schedule tasks using Sqlite3, and it looks like apache isn't able to read my <code>production.sqlite3</code> file.</p>\n\n<p>Here's my <code>database.yml</code>:</p>\n\n<pre><code>production:\n  adapter: sqlite3\n  database: db/production.sqlite3\n  pool: 5\n  timeout: 5000\n</code></pre>\n\n<p>Here's the error I am getting (in log/production.log):</p>\n\n<pre><code>ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file:) \n</code></pre>\n\n<p>I have run <code>RAILS_ENV=production rake db:create</code> and <code>RAILS_ENV=production rake db:migrate</code>. The <code>db/production.sqlite3</code> file exists, and the db directory and all its subfolders are owned by <code>apache:apache</code>, which is who apache runs as. I'm using Phusion Passenger on Amazon EC2.</p>\n"},{"tags":["ruby-on-rails-3","associations"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13278177,"title":"Associations in Rails 3","body":"<p>I have an app which allows users to add recipes and then select their favourite recipes to view in their member area, I can select a favourite and i am getting the user_id, recipe_id and giving it a favourite_id.</p>\n\n<p>What I would like to do is output the actual recipe to my view (as a favourite), like dish name, country_of_origin etc. I can do this with an actual recipe but not the favourite.Do i need to use has_many_through for this?</p>\n\n<p>My models look like this</p>\n\n<p>User</p>\n\n<pre><code>has_many :recipes\nhas_many :favourites\n</code></pre>\n\n<p>recipe</p>\n\n<pre><code>belongs_to :user\nhas_many :ingredients \nhas_many :preperations\nhas_many :favourites\n</code></pre>\n\n<p>favourites</p>\n\n<pre><code>belongs_to :user\nbelongs_to :recipe\n\nattr_accessible :user_id, :recipe_id\n</code></pre>\n\n<p>My controller</p>\n\n<pre><code>  @favourites = current_user.favourites\n</code></pre>\n\n<p>my link_to post</p>\n\n<pre><code> &lt;%= link_to \"Add to favorites\",  {:controller =&gt; 'favourites', :action =&gt; 'create', :recipe_id =&gt; r.id}, {:method =&gt; :post } %&gt;\n</code></pre>\n\n<p>i can list the current users recipes, this is my contoller for this</p>\n\n<pre><code>@recipes = current_user.recipes if current_user.recipes\n</code></pre>\n\n<p>and then output them to the view like so</p>\n\n<pre><code> &lt;% @recipes.each do |r| %&gt;\n &lt;tr&gt;\n &lt;td&gt;&lt;%= r.dish_name %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= r.country_of_origin %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= r.difficulty %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= r.preperation_time %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= ingredient_names(r.ingredients) %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= preperation_steps(r.preperations) %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= image_tag r.avatar.url(:thumb)%&gt;&lt;/td&gt;\n &lt;tr&gt;\n</code></pre>\n\n<p>So if i do this in the view</p>\n\n<pre><code> &lt;li&gt;&lt;%= @favourites %&gt;&lt;/li&gt;\n</code></pre>\n\n<p>I get this outputted</p>\n\n<pre><code> &lt;Favourite id: 16, user_id: 8, recipe_id: 21, created_at: \"2012-11-07 20:24:39\", updated_at: \"2012-11-07 20:24:39\"&gt;]\n</code></pre>\n\n<p>If i try</p>\n\n<pre><code> &lt;%= @favourites.dish_name %&gt;\n</code></pre>\n\n<p>then i get the error undefined  method dish_name</p>\n\n<p>How do i get the params of the recipe model to show in the view. I do apologise just cant work it out, which should be really easy i guess?</p>\n\n<p>Any help appreciated</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","internationalization","globalize3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13265384,"title":"Is it \"advisable\" / \"the right way\" to store all possible translations?","body":"<p>I am using Ruby on Rails v3.2.2 and the <a href=\"https://github.com/svenfuchs/globalize3\" rel=\"nofollow\">Globalize3 v0.2.0</a> gem. At this time I am using Globalize3 in order to translate country, region and city names in two languages but I plan to use it to internationalize my application in many more languages (ideally, all). So, I am populating the database with translation data, but I have some doubts on that: should I populate my <code>country_translations</code>, <code>region_translations</code> and <code>city_translations</code> database tables with <em>all</em> internationalized names (even if it may be that some names are the same as the default ones - in this case the internationalized name is <em>nil</em> or repeated)? that is, in translation tables should I create a translation record <em>for each</em> locale supported by my application (in my current case, two locales) and <em>for each</em> country, region and city?</p>\n\n<p>Making so, in a \"ideal\" scenario supporting all languages, mentioned tables (mostly those related to regions and cities) will be very large and probabily performance less. On the other hand, it makes sure that Globalize3 will properly work since it seems that in some cases when the internationalized record doesn't exist (I avoid to explain my specific case since it is \"hard\" to do, and maybe it'd need a book to be explained) that gem does <em>not</em> properly fallback to the current locale.</p>\n\n<p>How should I proceed?</p>\n"},{"tags":["ruby-on-rails-3","jquery-ui","backbone.js"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13277948,"title":"Backbone.js and ActiveRecord","body":"<p>This is a Noob question regarding Backbone.JS and ActiveRecord.\nI'd be grateful for a pointer on how to debug this.</p>\n\n<p>I'm trying to use Backbone.Js code to create a \"Trainer\" object, which has a single attribute, \"name\" (a string).\nThe front end of the application is Ruby on Rails. There is a data migration for the Trainer table.</p>\n\n<p>In trainers controller:</p>\n\n<pre><code>def create\n  document = Trainer.create! params[:trainer]\n  render :json =&gt; document\nend\n</code></pre>\n\n<p>Now, in app/assets/javascripts/backbone/views/trainers/new_view.js:</p>\n\n<pre><code>Gym.Views.Trainers.NewView = Backbone.View.extend({\n  el : 'div.trainer_form',\n  template: JST['backbone/templates/trainers/new_template'],\n  model : new window.Gym.Models.Trainer({}),\n  initialize: function() {\n  this.document = this.options.user;\n  Backbone.Validation.bind(this, {\n    invalid: function(view, attr, error) {\n      $(\"form#new-trainer .errors ul\").append(\"&lt;li&gt;\" + error + \"&lt;/li&gt;\")\n    }\n  });\n  this.render();\n},\nrender : function() {\n\n  $(this.el).html(this.template({trainer:this.model.toJSON()}));\n  return this\n},\nevents : {\n  \"click input#submit_button\" : 'create_trainer'\n},\n\n\ncreate_trainer : function(event) {\n  event.preventDefault()\n  params = $(\"form#new-trainer\").formParams()\n  params['user_id'] = Gym.currentUser.userId\n  this.model.save(params, {success : function(model, response) {\n    Gym.trainers.add(model)\n    Objects.views.selectTrainer.render()\n\n    Gym.current_trainer = model\n\n    $(\"select#trainer_selector\").val(Gym.current_trainer.get('id'))\n\n    Objects.views.new_trainer.model = new Gym.Models.Trainer()\n    Objects.views.new_trainer.render()\n\n  }\n  });\n</code></pre>\n\n<p>Now, I can see in the Rails log that I'm getting to the controller:</p>\n\n<pre><code>Started POST \"/trainers\" ...\nProcessing by TrainersController#create as JSON\nParameters: {\"name\"=&gt;\"Lori Stevens\", \"user_id\"=&gt;1, \"trainer\"=&gt;{}}\n</code></pre>\n\n<p>However, when it gets to the SQL, I see this:</p>\n\n<pre><code>[1m^[[36mSQL (0.4ms)^[[0m  ^[[1mINSERT INTO `trainers` (`created_at`, `name`, `updated_at`, `user_id`) VALUES ('2012-11-07 20:33:09', NULL, '2012-11-07 20:33:09', NULL)^[[0m\n</code></pre>\n\n<p>The parameter 'name' - which comes from the template, and is the attribute of the Trainer object- is not getting to the database, even though the parameter \"name\" is set in the JSON.</p>\n\n<p>I'd appreciate a pointer on how to debug this - clearly I am not understanding how Backbone.js and ActiveRecord are connected.</p>\n"},{"tags":["jquery","ruby-on-rails-3","ujs"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13200129,"title":"Which jquery-rails gem version is working with Rails 3.0?","body":"<p>According to the docs, the <a href=\"https://github.com/rails/jquery-ujs#installation\" rel=\"nofollow\">jquery-ujs Installation</a> is as easy as adding</p>\n\n<pre><code>gem 'jquery-rails', '~&gt; 2.1'\n</code></pre>\n\n<p>to the Gemfile, and running:</p>\n\n<pre><code>$ bundle install\n</code></pre>\n\n<hr>\n\n<p>My app is running <strong>Rails 3.0.15</strong>, and <code>jquery-rails</code> seems to be compatible with it:</p>\n\n<blockquote>\n  <p>For Rails 3.0 , run [...]</p>\n</blockquote>\n\n<p>but when bundling <code>jquery-rails</code> 2.1, I seem to need Rails 3.1+: </p>\n\n<pre><code>Bundler could not find compatible versions for gem \"railties\":\n  In Gemfile:\n    jquery-rails (~&gt; 2.1) x86-mingw32 depends on\n      railties (&lt; 5.0, &gt;= 3.1.0) x86-mingw32\n\n    rails (= 3.0.15) ruby depends on\n      railties (3.0.15)\n</code></pre>\n\n<p>What <code>jquery-rails</code> gem version is compatible with Rails 3.0?</p>\n\n<p><em>(also asked <a href=\"https://github.com/rails/jquery-ujs/issues/286\" rel=\"nofollow\">here</a>)</em></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13276783,"title":"get models name and count","body":"<p>I have this in <code>models_name</code>:</p>\n\n<pre><code>model_names = Object.constants.collect { |sym| Object.const_get(sym) }.select { |constant| constant.class == Class &amp;&amp; constant.include?(Mongoid::Document) }.collect { |klass| klass.name }\n</code></pre>\n\n<p>the result is:</p>\n\n<pre><code>[\"Model_name1\",\"Model_name2\",\"Model_name3\"]\n</code></pre>\n\n<p>I need something like:</p>\n\n<pre><code>[{\"Model1\":\"Count\"},{\"Model2\":\"Count\"},{\"Model3\":\"Count\"}]\n</code></pre>\n\n<p>I need show in a chart all models and object counter inside each model is working with <code>morris.js</code></p>\n\n<p>You can see the example:</p>\n\n<p><a href=\"http://jsbin.com/uzosiq/2/embed?javascript,live\" rel=\"nofollow\">http://jsbin.com/uzosiq/2/embed?javascript,live</a></p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13277751,"title":"Ruby code in yaml file?","body":"<p>I am using a gem that have this e-mail method:</p>\n\n<pre><code>  #Sends and email for indicating a reply in an already created conversation\n  def reply_message_email(message,receiver)\n    @message = message\n    @receiver = receiver\n    subject = message.subject.to_s\n    subject = strip_tags(subject) unless subject.html_safe?\n    mail(:to =&gt; receiver.send(Mailboxer.email_method,message), :subject =&gt; t('mailboxer.message_mailer.subject_reply', :subject =&gt; subject)) do |format|\n      format.text {render __method__}\n      format.html {render __method__}\n    end\n  end\nend\n</code></pre>\n\n<p>And I have this in my locale:</p>\n\n<pre><code>da:\n  mailboxer:\n    message_mailer:\n        subject_reply: You have got a new reply \"#{subject}\"\n</code></pre>\n\n<p>Instead of overwriting the email method. Is it not possible to do some ruby code in a YAML file? Now the subject of an e-mail is just You have got a new reply \"#{subject}\" as text and the ruby code is not active.</p>\n"},{"tags":["ruby","ruby-on-rails-3","jruby","jruby-openssl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13277774,"title":"OpenSSL::SSL::SSLError in jruby 1.6.7/1.7.0 1.9 mode","body":"<p>I'm running a rails 3 app with jruby 1.7.0 in 1.9 mode, and when one of my file uploading gems tries to make a https connection, it fails with the following exception:</p>\n\n<pre><code>Excon::Errors::SocketError: write would raise (OpenSSL::SSL::SSLError)\n    from org/jruby/ext/openssl/SSLSocket.java:626:in `syswrite_nonblock'\n    from /home/x/.rvm/gems/jruby-1.7.0@global/gems/jruby-openssl-0.7.7/lib/1.9/openssl/buffering.rb:375:in `write_nonblock'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/socket.rb:139:in `write'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/ssl_socket.rb:84:in `write'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/connection.rb:243:in `request_kernel'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/connection.rb:103:in `request'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/core/connection.rb:20:in `request'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace.rb:71:in `authenticate'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace/storage.rb:146:in `authenticate'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace/storage.rb:95:in `initialize'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/core/service.rb:68:in `new'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/storage.rb:34:in `new'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:106:in `connection'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:323:in `connection'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:335:in `directory'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:250:in `store'\n</code></pre>\n\n<p>I found a similar issue on stackoverflow here: <a href=\"http://stackoverflow.com/questions/11859549/jruby-heroku-gem\">JRuby Heroku Gem</a>, but the suggested answer is run jruby in 1.8 mode which I cannot do since our entire app uses 1.9 features and syntax. Does anybody have any ideas or suggesetions on how to fix or get around this exception?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13277204,"title":"rails form add fields dynamically","body":"<p>I'm trying to set a set of fields to be dynamically displayed on demand. In the model, I've the fields:</p>\n\n<pre><code>attr_accessible ... :instruct1, :instruct2, ... :instruct30\n</code></pre>\n\n<p>I would like the form to display just instruct1 with a button to add 1 more field until instruct30 is hit and a button to remove one until instruct 1 is hit. All should happen without refreshing page which i think would include some use of AJAX but I couldn't find anything that is similar.</p>\n\n<p>I've searched for something similar but only able to come up with nested form which is not what im looking for as my model is fixed.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1106,"score":4,"question_id":9237201,"title":"Getting frequent Gem RemoteFetcher::FetchError. Any workarounds?","body":"<p>I've been getting this error frequently every day for the last few days...</p>\n\n<pre><code>$ gem install rails -v 3.2.1\nERROR:  While executing gem ... (Gem::RemoteFetcher::FetchError)\n    bad response Forbidden 403 (http://production.cf.rubygems.org/gems/rdoc-3.12.gem)\n</code></pre>\n\n<p>My understanding based on a <a href=\"http://stackoverflow.com/questions/8580753/gem-install-rails-failing-any-workaround\">previous question</a> is that this is due to a problem with the remote repository and the solution is to just wait a little while and try again. Indeed, sometimes when I wait a few hours or overnight the install command works.</p>\n\n<p>However, I'm hoping for a more reliable experience.</p>\n\n<p>I thought of downloading files such as <code>rails-3.2.1.gem</code> and then running...</p>\n\n<pre><code>$ gem install --local ~/Desktop/rails-3.2.1.gem\n</code></pre>\n\n<p>But that gives me...</p>\n\n<pre><code>$ gem install --local ~/Desktop/rails-3.2.1.gem \nERROR:  While executing gem ... (Gem::DependencyError)\n    Unable to resolve dependencies: rails requires railties (= 3.2.1)\n</code></pre>\n\n<p>I could try downloading railties. Maybe I will. But I sense a plunge down a rabbit hole there of searching out dependency after dependency all day long.</p>\n\n<p>Any alternate efficient ways to install gems? Is there something I could do through my repository specification that would allow gem installation to be more reliable?</p>\n\n<hr>\n\n<pre><code>$ gem environment\nRubyGems Environment:\n  - RUBYGEMS VERSION: 1.8.15\n  - RUBY VERSION: 1.9.2 (2011-07-09 patchlevel 290) [x86_64-darwin11.2.0]\n  - INSTALLATION DIRECTORY: /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc\n  - RUBY EXECUTABLE: /Users/ethan/.rvm/rubies/ruby-1.9.2-p290/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc/bin\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-11\n  - GEM PATHS:\n     - /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc\n     - /Users/ethan/.rvm/gems/ruby-1.9.2-p290@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :benchmark =&gt; false\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - :sources =&gt; [\"http://rubygems.org\"]\n     - \"gem\" =&gt; \"--no-rdoc --no-ri\"\n     - \"install\" =&gt; \"--no-rdoc --no-ri\"\n     - \"update\" =&gt; \"--no-rdoc --no-ri\"\n  - REMOTE SOURCES:\n     - http://rubygems.org\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms","nested-form-for"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13260149,"title":"Rails 3 nested edit form not updating","body":"<p>I have a form for nested attribute. When I click update it redirects properly and says \"successful\" however the attributes are not updated. I have tried several different form_for combinations and have yet to get it to update successfully. </p>\n\n<p>The form I use for a new department is different and the form_for looks like this </p>\n\n<pre><code>&lt;%= form_for([@client,@client.departments.build]) %&gt; \n</code></pre>\n\n<p>This form is nested on the client#show. </p>\n\n<p>Edit Form</p>\n\n<pre><code>    &lt;%= form_for([@client, @department], :url =&gt; client_department_path(@client,@department)) do |f| %&gt; \n      &lt;div class=\"field\"&gt;                                                                               \n        &lt;%= f.label :department_name %&gt;&lt;br /&gt;                                                           \n        &lt;%= f.text_field :department_name %&gt;                                                            \n      &lt;/div&gt;                                                                                            \n      &lt;div class=\"field\"&gt;                                                                               \n        &lt;%= f.label :department_manager %&gt;&lt;br /&gt;                                                        \n        &lt;%= f.text_field :department_manager %&gt;                                                         \n      &lt;/div&gt;                                                                                            \n      &lt;div class=\"actions\"&gt;                                                                             \n        &lt;%= f.submit %&gt;                                                                                 \n      &lt;/div&gt;                                                                                            \n    &lt;% end %&gt;      \n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>    class DepartmentsController &lt; ApplicationController\n\nbefore_filter :get_client\ndef get_client\n  @client = Client.find(params[:client_id])\nend \ndef create\n    @department = @client.departments.create(params[:department])\n    redirect_to client_path(@client)\n\nend\ndef update\n  @department = @client.departments.find(params[:id])\n\n  respond_to do |format|\n  if @department.update_attributes(params[:task])\n  format.html { redirect_to client_path(@client), notice: 'Department was successfully updated.' }\n  format.json { head :no_content }\n  else\n  format.html { render action: \"edit\" }\n  format.json { render json: @department.errors, status: :unprocessable_entity }\n  end\nend\nend\ndef show\n  @department = @client.departments.find(params[:id])\n\n\n    respond_to do |format|\n        format.html # show.html.erb\n        format.json { render json: @client }\n    end\nend\ndef edit\n    @department = @client.departments.find(params[:id])\nend\n\ndef destroy\n    @client = Client.find(params[:client_id])\n    @department = @client.departments.find(params[:id])\n    @department.destroy\n    redirect_to client_path(@client)\nend     \nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rubygems","openssl","ssl-certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13277490,"title":"OpenSSL Errors and Rails - certificate B: certificate verify failed (OpenSSL::SSL::SSLError)","body":"<p>I updated openssl to 1.0.1 a month ago and creating a new rails app from the app composer worked, but now when I try</p>\n\n<p>rails new app -m <a href=\"http://raw.github.com/RailsApps/rails-composer/master/composer.rb\" rel=\"nofollow\">http://raw.github.com/RailsApps/rails-composer/master/composer.rb</a> -T -O</p>\n\n<p>I get the issue again:</p>\n\n<pre><code>/Users/macuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/net/http.rb:799:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (OpenSSL::SSL::SSLError)\n</code></pre>\n\n<p>System conf: </p>\n\n<pre><code>ruby 1.9.3p125 \ngem -v 1.8.24\nOpenSSL 1.0.1b 26 Apr 2012\ncurl -I https://d2chzxaqi4y7f8.cloudfront.net/gems/rake-0.9.2.2.gem\nHTTP/1.0 200 OK\n</code></pre>\n\n<p>running: </p>\n\n<pre><code>ruby -d -rrubygems/remote_fetcher -e 'p Gem::RemoteFetcher.new.fetch_http(URI.parse(\"https://d2chzxaqi4y7f8.cloudfront.net/gems/rake-0.9.2.2.gem\")).bytesize'\n</code></pre>\n\n<p>gets: </p>\n\n<pre><code>Exception LoadError' at /Users/macuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems.rb:1264 - cannot load such file -- rubygems/defaults/operating_system\nExceptionLoadError' at /Users/macuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems.rb:1273 - cannot load such file -- rubygems/defaults/ruby\nException Gem::LoadError' at /Users/macuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247 - Could not find psych (&gt;= 1.2.1, ~&gt; 1.2) amongst [actionmailer-3.2.3, actionpack-3.2.8, actionpack-3.2.3, activemodel-3.2.8, activemodel-3.2.3, activerecord-3.2.3, activeresource-3.2.3, activesupport-3.2.8, activesupport-3.2.3, addressable-2.3.2, arel-3.0.2, bcrypt-ruby-3.0.1, bootstrap-sass-2.1.0.0, bootstrap-timepicker-rails-0.1.2, builder-3.0.4, builder-3.0.3, builder-3.0.0, bundler-1.2.1, bundler-1.1.3, cancan-1.6.8, capistrano-2.13.4, capybara-1.1.2, carrierwave-0.6.2, childprocess-0.3.5, coffee-rails-3.2.2, coffee-script-2.2.0, coffee-script-source-1.4.0, coffee-script-source-1.3.3, commonjs-0.2.6, cucumber-1.2.1, cucumber-rails-1.3.0, database_cleaner-0.9.1, devise-2.1.2, devise_invitable-1.1.0, diff-lcs-1.1.3, email_spec-1.2.1, erubis-2.7.0, execjs-1.4.0, factory_girl-4.1.0, factory_girl_rails-4.1.0, ffi-1.1.5, gherkin-2.11.4, highline-1.6.15, hike-1.2.1, i18n-0.6.1, i18n-0.6.ExceptionNameError' at /Users/macuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/psych/core_ext.rb:16 - method `to_yaml' not defined in Object\n</code></pre>\n\n<p>Running: </p>\n\n<pre><code>ruby -rrbconfig -e 'p Dir.glob(File.join(RbConfig::CONFIG[\"sitelibdir\"], \"rubygems/ssl_certs/*\"))\n</code></pre>\n\n<p>result: </p>\n\n<pre><code>[\"/Users/macuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/ssl_certs/ca-bundle.pem\"]\n</code></pre>\n\n<p>running: </p>\n\n<pre><code>ruby -rrbconfig -e 'p Dir.glob(File.join(RbConfig::CONFIG[\"sitelibdir\"], \"rubygems/ssl_certs/*\"))'\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>/Users/macuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in require': cannot load such file -- httpclient (LoadError)\nfrom /Users/macuser/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:inrequire'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13277250,"title":"Does the second boolean after && executes in rails?","body":"<p>I'm still new to rails and lots of it is not what I'm used to. Couldn’t find my answer on this and don’t actually know what to search for so please help.</p>\n\n<p>Is this:</p>\n\n<pre><code>def create\n    @note = Note.new(params[:note])\n    @note.creator = current_user\n    if member_of_project? @note.project_id\n      if @note.save\n        redirect_to @note, :notice =&gt; \"Successfully created note.\"\n      else\n        render :action =&gt; 'new'\n      end\n    else\n      render :action =&gt; 'new'\n    end\n  end\n</code></pre>\n\n<p>Equal to:</p>\n\n<pre><code>def create\n    @note = Note.new(params[:note])\n    @note.creator = current_user\n    if member_of_project? @note.project_id &amp;&amp; @note.save\n      redirect_to @note, :notice =&gt; \"Successfully created note.\"\n    else\n      render :action =&gt; 'new'\n    end\n  end\n</code></pre>\n\n<p>???</p>\n\n<p>What I really want to know is if the second one will call <code>@note.save</code>.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","image","heroku","progressive"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13277370,"title":"Why do Images Loaded from Heroku Load Progressively","body":"<p>I have a small (Rails 3.1) app running on Heroku (with images also served from Heroku) The images load progressively (from top to bottom). If I take the same images and place them on another (Apache) server, they seemingly pop into existence once they are loaded. </p>\n\n<p>So why are they loading top-to-bottom on Heroku? Is it just that they are loading really slowly (so the progressive download is obvious) or is it something to do with the way Heroku serves images?</p>\n"},{"tags":["ruby-on-rails-3","gem","ruby-on-rails-2","upgrade-issue"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13275790,"title":"Rails 2 to 3 and deprecated gems","body":"<p>I am planning on initiating an upgrade from Rails 2 to Rails 3 for a rather <em>big</em> app. Problem is the project is relying on some old gems that are no longer supported by Rails 3. </p>\n\n<p>What choices do I have, knowing that deactivating the dependant functionalities is not an option ? Are there any solutions besides looking for alternate gems ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json","gem","bundler"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":342,"score":1,"question_id":12486894,"title":"Rails: json 1.7.5 bundle install issue","body":"<p>When running bundle I get the following issue...</p>\n\n<blockquote>\n  <p>Installing json (1.7.5) with native extensions\n  Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native\n  extension.</p>\n\n<pre><code>    /usr/local/bin/ruby extconf.rb creating Makefile\n</code></pre>\n  \n  <p>make Makefile:158: <em>*</em> target pattern contains no `%'.  Stop.</p>\n  \n  <p>Gem files will remain installed in\n  /srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/gems/json-1.7.5\n  for inspection. Results logged to\n  /srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/gems/json-1.7.5/ext/json/ext/generator/gem_make.out\n  An error occured while installing json (1.7.5), and Bundler cannot\n  continue. Make sure that <code>gem install json -v '1.7.5'</code> succeeds before\n  bundling.</p>\n</blockquote>\n\n<p>I tried doing the following <code>sudo aptitude install ruby1.9.1-dev</code> but that didn't work.  </p>\n"},{"tags":["ruby-on-rails-3","mongodb","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13276739,"title":"Rails 3 Symbol.gte method","body":"<p>I saw the following code example:</p>\n\n<pre><code>Subscription.where(:created_at.gte =&gt; t0)`\n</code></pre>\n\n<p>To me, this seems a little more ruby/rails-like as opposed to:</p>\n\n<pre><code>Subscription.where(\"created_at &gt; ?\", t0)`\n</code></pre>\n\n<p>However, attempting to reproduce this in my own code on results in:</p>\n\n<blockquote>\n  <p>undefined method `gte' for :created_at:Symbol</p>\n</blockquote>\n\n<p>I'm not certain, but I believe this is a MongoDB method. If so is there any way I can extend ActiveRecord to make use of it?</p>\n"},{"tags":["jquery","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13274481,"title":"Move list item from one unordered list to another","body":"<p>I'm trying to move my list item from one unordered list to another. update.js.erb is called when the update happens ( I can see it being called in the log with no errors).</p>\n\n<p>I'm very new to jQuery so I appologize for my ignorance.</p>\n\n<pre><code>&lt;% if @task.complete? %&gt;\n  $('#task_&lt;%= @task.id%&gt; li').detach().appendTo($('#complete_tasks ul'));\n  $.('#complete_tasks').sortable_list();\n&lt;% else %&gt;\n  $('#task_&lt;%= @task.id %&gt; li').detach().appendTo($('#incomplete_tasks ul'));\n  $.('#incomplete_tasks').sortable_list();\n&lt;% end %&gt;\n</code></pre>\n\n<p>I saw .detach() in <a href=\"http://stackoverflow.com/questions/12956373/how-to-move-an-item-from-one-list-to-another\">How to move an item from one list to another?</a> </p>\n\n<p>I have tried many different forms but my guess is I'm selecting the list or list item wrong. </p>\n\n<p>Any / all feedback is greatly appreciated ! :)</p>\n\n<pre><code>ul id=\"complete_tasks\" data-update-url=\"http://localhost:3000/tasks/sort_incomplete\" class=\"ui-sortable\"\n  li class=\"task\" id=\"task_1\"\n  ...\n</code></pre>\n\n<p>And similarly the incomplete_tasks</p>\n\n<pre><code>ul id=\"incomplete_tasks\" data-update-url=\"http://localhost:3000/tasks/sort_complete\" class=\"ui-sortable\"\n  li class=\"task\" id=\"task_7\"\n  ...\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":391,"score":1,"question_id":11885398,"title":"Is there a fix for the \"Could not find *gem* in any of the sources\" error that doesn't involve deleting Gemfile.lock?","body":"<p>I am trying to get my development environment setup on a new computer.</p>\n\n<pre><code>git clone -o heroku git@heroku.com:theirapp.git\ncd theirapp\nbundle\nFetching gem metadata from https://rubygems.org/......\nFetching gem metadata from https://rubygems.org/..\nCould not find jquery-rails-2.0.0 in any of the sources\n</code></pre>\n\n<p>After googling this error, the response seems to be to delete <code>Gemfile.lock</code>, then running <code>bundle</code> again. This works, but then I have different versions of gems where I haven't specified a version in <code>Gemfile</code>. Is there a way to fix this error without deleting <code>Gemfile.lock</code>? I'm using Rails 3.2 and Ruby 1.9.3.</p>\n"},{"tags":["ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":165,"score":0,"question_id":10819981,"title":"NameError: uninitialized constant CarrierWave::Backgrounder::Delay","body":"<p>I'm using Rails 3.2.3 and Carrierwave 1.8.21</p>\n\n<p>trying to install Carrierwave_backgrounder according to the instructions in <a href=\"https://github.com/lardawge/carrierwave_backgrounder\" rel=\"nofollow\">https://github.com/lardawge/carrierwave_backgrounder</a> result in </p>\n\n<pre><code>NameError: uninitialized constant CarrierWave::Backgrounder::Delay \n</code></pre>\n\n<p>because of the following line which is added to the uploader</p>\n\n<pre><code>include ::CarrierWave::Backgrounder::Delay\n</code></pre>\n\n<p>I tried without including this line and the result is duplicate processing of the images (both delayed and not delayed)</p>\n\n<p>how do I fix that ?</p>\n"},{"tags":["ruby-on-rails-3","formtastic","client-side-validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13276467,"title":"Not seeing custom error output using client_side_validations and formtastict","body":"<p>I can't seem to get the custom error display I would like, I've uncommented the text in config/initializers/client_side_validations.rb and created a rails.validations.actionView.js as described in the documentation but when debugging the form I can't seem to get the customized file to be used (I've also placed some breakpoints on the rails.validations.js file and it isn't hitting the add or remove there so perhaps that is the problem. All files are loaded through the asset pipeline and to my knowledge fully. </p>\n\n<pre><code>gem 'rails', '3.2.8'\ngem 'formtastic'\ngem 'client_side_validations' , '3.2.0'\ngem 'client_side_validations-formtastic'\n</code></pre>\n\n<p>actionView.js</p>\n\n<pre><code>window.ClientSideValidations.formBuilders['ActionView::Helpers::FormBuilder'] = {\nadd: function(element, settings, message) {\n// custom add code here\nconsole.log('added')\n },\nremove: function(element, settings) {\nconsole.log('removed');}}\n</code></pre>\n\n<p>_form.html.erb</p>\n\n<pre><code>&lt;%= semantic_form_for @sponsorship, :validate =&gt; true do |f| %&gt;\n  &lt;%= f.inputs do %&gt;\n    &lt;%= f.input :title, :hint =&gt; \"Give us a title\" %&gt;\n     &lt;%= f.input :bio %&gt;\n    &lt;%= f.input :blurb %&gt;\n    &lt;%= f.input :category_id, :as =&gt; :select, :collection =&gt; Category.all, :label_method =&gt; :title %&gt;\n    &lt;%= f.input :event_id, :as =&gt; :select, :collection =&gt; Event.all, :label_method =&gt; :title %&gt;\n    &lt;%= f.input :date_end, :start_year =&gt; 2012, :as =&gt; :date_picker %&gt;\n    &lt;%= f.input :funds_needed %&gt;\n    &lt;%= f.input :user_id, :as =&gt; :hidden, :input_html =&gt; { :value =&gt; current_user.id } %&gt;\n    &lt;%= f.input :agree_to_terms %&gt;\n    &lt;%= f.validate %&gt;\n  &lt;% end %&gt;\n\n  &lt;%= f.actions do %&gt;\n    &lt;%= f.action :submit, :as =&gt; :input %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>HTML Output in head</p>\n\n<pre><code>&lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery-ui.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/rails.validations.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/rails.validations.formtastic.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/rails.validations.customValidators.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/rails.validations.actionView.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>client_side_validation.rb</p>\n\n<pre><code>require 'client_side_validations/simple_form' if defined?(::SimpleForm)\nrequire 'client_side_validations/formtastic'  if defined?(::Formtastic)\n\n ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|\n   unless html_tag =~ /^&lt;label/\n     %{&lt;div class=\"toto\"&gt;&lt;div class=\"field_with_errors\"&gt;#{html_tag}&lt;/div&gt;&lt;label for=\"#{instance.send(:tag_id)}\" class=\"message\" style=\"float:right;\"&gt;#{instance.error_message.first}&lt;/label&gt;&lt;/div&gt;}.html_safe\n   else\n     %{&lt;div class=\"toto\"&gt;#{html_tag}&lt;/div&gt;}.html_safe\n   end\n end\n</code></pre>\n\n<p>I'm new to rails so I've probably gaffed somewhere. Any questions let me know! Thanks for reading. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":11668325,"title":"Render custom page/s after validation fails","body":"<p>I'm using the High Voltage gem (https://github.com/thoughtbot/high_voltage/) for a site with masses of static pages. The site has three unique forms all which are handled by the 'forms' controller/model. </p>\n\n<p>Now all is working well when fields which requires validation are populated, but when validation fails it jumps from the 'pages' controller (High Voltage) back to the 'forms' controller and renders /form/new, instead of, for instance, /pages/quotes - which is understandable as it's default behaviour.</p>\n\n<p>I'm also checking for validation in the form:</p>\n\n<pre><code>= form_for @form, :validate =&gt; true do |f|\n  - if @form.errors[:name].present?\n    .control-group.error\n      = f.label \"Your Name\"\n      = f.text_field :name\n  - else\n    = f.label \"Your Name\"\n    = f.text_field :name\n</code></pre>\n\n<p>Any idea how I can re-render the current page (which renders the specific form) after validation fails instead of directing to /forms/new</p>\n\n<p>Any advice appreciated, thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13275821,"title":"Override attributes keys in FactoryGirl","body":"<p>I have a model <code>Post</code> with an attribute <code>published_at</code>.\nHowever, in POST request API requires it to be assigned as <code>published</code>, not <code>published_at</code>.\nSo in my model I override setter method like so</p>\n\n<pre><code>def published=(value)\n  self.published_at = value\nend\n</code></pre>\n\n<p>The problem is, in my API tests, I use FactoryGirl's <code>attributes_for(:post)</code> method to generate attributes for POST request, and it uses old <code>published_at</code> name. How can I workaround this problem and generate attributes with <code>published</code> key instead of <code>published_at</code> without changing the name of this attribute in my model?</p>\n"},{"tags":["ruby-on-rails-3","caching","memcached","activeadmin","sweeper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":127,"score":0,"question_id":11600087,"title":"How do I expire home page cache when an article is updated?","body":"<p>I'm attempting to use a sweeper to clear the home page index action when a new article is published.</p>\n\n<p>The home page cache is working fine in development environment and expires after 1 minute. However when an article is saved, the sweeper action is not triggered.</p>\n\n<pre><code>class HomeController &lt; ApplicationController\n  caches_action :index, :expires_in =&gt; 1.minute\n  cache_sweeper :article_sweeper\n  def index\n    @articles = Article.published.limit(5)\n  end\nend\n\nclass ArticleSweeper &lt; ActionController::Caching::Sweeper\n  observe Article\n  def after_update(article)\n    expire_action(:controller =&gt; 'home', :action =&gt; 'index')\n  end\nend\n</code></pre>\n\n<p>Either I've gone wrong somewhere or a different approach is needed to expire the home page cache.</p>\n\n<p>My app uses ActiveAdmin to update articles, and Dalli for Memcache (as I'll be using Heroku).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13275814,"title":"undefined method `destroy' for nil:NilClass","body":"<p>My app successfully creates rows for a table every time a user submits some stats. Now I want to provide a delete button to be able to delete some rows. </p>\n\n<p>When I click the delete button I get the error: </p>\n\n<pre><code>undefined method `destroy' for nil:NilClass\n</code></pre>\n\n<p>Seems like either rails doesn't understand the destroy method in this case for whatever reason, or rails doesn't see anything to destroy, hence the nil:NilClass. </p>\n\n<p>My first question is in identifying which is the case, if either of those. </p>\n\n<p>My second question is fixing it :D</p>\n\n<p>Here's my show.html:</p>\n\n<pre><code>&lt;% provide(:title, \"Log\" ) %&gt;\n&lt;% provide(:heading, \"Your Progress Log\") %&gt;\n\n&lt;div class=\"row\"&gt;  \n  &lt;div class=\"span8\"&gt;\n    &lt;% if @user.status_update.any? %&gt;\n      &lt;h3&gt;Status Updates (&lt;%= @user.status_update.count %&gt;)&lt;/h3&gt;    \n      &lt;table&gt;\n        &lt;thead&gt;\n          &lt;tr&gt;\n            &lt;th&gt;Entry Date&lt;/th&gt;\n            &lt;th&gt;Weight&lt;/th&gt;\n            &lt;th&gt;BF %&lt;/th&gt;\n            &lt;th&gt;LBM&lt;/th&gt;\n            &lt;th&gt;Fat&lt;/th&gt;\n            &lt;th&gt;Weight Change&lt;/th&gt;\n            &lt;th&gt;BF % Change&lt;/th&gt;\n            &lt;th&gt;Fat Change&lt;/th&gt;\n          &lt;/tr&gt;\n        &lt;/thead&gt;\n      &lt;tbody class = \"status updates\"&gt;\n          &lt;%= render @status_updates %&gt;\n      &lt;/tbody&gt;        \n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The \"&lt;%= render @status_updates %>\" calls the _status_update partial. </p>\n\n<pre><code> &lt;tr&gt;\n .\n .\n .\n . \n &lt;% if current_user==(status_update.user) %&gt; \n &lt;td&gt;\n       &lt;%= link_to \"delete\", status_update, method: :delete %&gt;\n\n &lt;/td&gt;\n &lt;%  end  %&gt;         \n\n&lt;/tr&gt;                                    \n</code></pre>\n\n<p>And then finally, here is the StatusUpdateController</p>\n\n<pre><code>def destroy\n    @status_update.destroy\n    redirect_to root_url\nend\n</code></pre>\n\n<p>Here are the parameters on the error page:</p>\n\n<pre><code>{\"_method\"=&gt;\"delete\",\n \"authenticity_token\"=&gt;\"w9eYIUEd2taghvzlo7p3uw0vdOZIVsZ1zYIBxgfBymw=\",\n \"id\"=&gt;\"106\"}\n</code></pre>\n"},{"tags":["sql","ruby-on-rails-3","postgresql","activerecord","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":106,"score":3,"question_id":13133553,"title":"Rails 3 Applying limit and offset to subquery","body":"<p>I have a query that goes something like this (in song.rb):</p>\n\n<pre><code>def self.new_songs\n  Song.where(id: Song.grouped_order_published).select_important_stuff\nend\n</code></pre>\n\n<p>Later on in my app, it is then passed the limit and offset, lets say in the controller:</p>\n\n<pre><code>@songs = Song.new_songs.limit(10).offset(10)\n</code></pre>\n\n<p>The way my app is structured, I'd like to keep this method of setting things, but unfortunately it is really slow as it is limiting the outer query rather than the subquery.</p>\n\n<p>Is there a way I can expose the subquery such that it receives the limit and offset rather than the outer query?</p>\n\n<p><strong>Edit</strong>: I should add I am using postgres 9.2.</p>\n\n<p><strong>Edit 2</strong>:  The reason why I want to do it in this fashion is I am doing pagination and I need to get the \"count\" of the total number of rows.  So I do something like this:</p>\n\n<pre><code>@songs = Song.new_songs\n...\n@pages = @songs.count / 10\n...\nrender @songs.limit(params[:page]).offset(0)\n</code></pre>\n\n<p>If I were to change it somehow, I'd have to redo this entirely (which is in a ton of places).  By not limiting it until it's actually called, I can do the count in between and then get just the page at the end.  I guess I'm looking more for advice on how this can be done with the inner query, without becoming horribly slow as the database grows.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","nginx","unicorn"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":410,"score":0,"question_id":10435978,"title":"Error Messages Showing in Production - Ruby on Rails 3.1, Nginx, Unicorn","body":"<p>I have a Rails 3.1 app running in production using Nginx and Unicorn. And for some reason, my custom 404 and 500 html error pages are not showing. Instead I'm getting the actual error message (\"Routing Error\", for example).</p>\n\n<p>In my production.rb file, I have <code>config.consider_all_requests_local = false</code></p>\n\n<p>And on the same server with a nearly identical configuration, I have a 'staging' site that works just fine. The only difference, as far as I can tell, is that the production one has SSL while the staging does not.</p>\n\n<p>Here is the Nginx config for the production app:</p>\n\n<pre><code>upstream unicorn_myapp_prod {\n  server unix:/tmp/unicorn.myapp_prod.sock fail_timeout=0;\n}\n\nserver {\n  listen 80;\n\n  server_name myapp.com;\n\n  root /home/deployer/apps/myapp_prod/current/public;\n\n  location ^~ /assets/ {\n    gzip_static on;\n    expires max;\n    add_header Cache-Control public;\n  }\n\n  try_files $uri/index.html $uri @unicorn;\n  location @unicorn {\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header Host $http_host;\n    proxy_redirect off;\n    proxy_pass http://unicorn_myapp_prod;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  client_max_body_size 4G;\n  keepalive_timeout 10;\n}\n\n\nserver {\n  listen 443 default;\n  ssl on;\n  ssl_certificate /home/deployer/apps/myapp_prod/shared/ssl_certs/myapp_prod.crt;\n  ssl_certificate_key /home/deployer/apps/myapp_prod/shared/ssl_certs/myapp_prod.key;\n\n\n  server_name myapp.com;\n\n  root /home/deployer/apps/myapp_prod/current/public;\n\n  location ^~ /assets/ {\n    gzip_static on;\n    expires max;\n    add_header Cache-Control public;\n  }\n\n  try_files $uri/index.html $uri @unicorn;\n  location @unicorn {\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header Host $http_host;\n    proxy_redirect off;\n    proxy_pass http://unicorn_myapp_prod;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  client_max_body_size 4G;\n  keepalive_timeout 10;\n}\n</code></pre>\n\n<p>Any ideas? Thanks!</p>\n"},{"tags":["javascript","ruby-on-rails-3","jquery-ui"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13240776,"title":"How to fix broken JQueryUI Datepicker","body":"<p>I have a JQueryUI datepicker defined as follows:</p>\n\n<pre><code>$(function() {\n  $(\".visit_date\").datepicker({\n    changeMonth: true,\n    changeYear: true,\n    showButtonPanel: true,\n    dateFormat: \"yy-mm-dd\"\n  });\n});\n</code></pre>\n\n<p>The view code which produces the Datepicker text box is</p>\n\n<pre><code>&lt;td&gt;&lt;%= f.label :visit_date %&gt;&lt;/td&gt;\n&lt;td&gt;&lt;%= text_field_tag :visit_date, @visit.visit_date, :class =&gt; 'visit_date'\n</code></pre>\n\n<p>and the view, when rendered, is generated between tags like this:</p>\n\n<pre><code>&lt;div id=\"action_window\"&gt;\n   (rendered HTML to be acted on by user) \n&lt;/div&gt;\n</code></pre>\n\n<p>Why doesn't the Javascript selector \".visit_date\" hook up with this view? In other words, without the \"action_window\" tags it used to work. My thinking was that \".visit_date\" would match anything with class \"visit_date\".</p>\n\n<p>======================\nUPDATE on 11/7/2012. Javascript code:</p>\n\n<pre><code>$(function() {\n  $(\"#visit_date\").datepicker({\n    changeMonth: true,\n    changeYear: true,\n    showButtonPanel: true,\n    dateFormat: \"yy-mm-dd\"\n});   \n</code></pre>\n\n<p>});    </p>\n\n<p>The original place where the user pushes the button:</p>\n\n<pre><code>&lt;%= link_to \"Add Visit\", new_client_visit_path(@client), :remote =&gt; true, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>In VisitsController: </p>\n\n<pre><code>respond_to do |format|\n  format.html\n  format.js { }\nend\n</code></pre>\n\n<p>In views/visits/new.js.erb:</p>\n\n<pre><code>$('#action_window').html('&lt;%= escape_javascript render(:partial =&gt; \"new\") %&gt;');\n$('#action_window').show;\n</code></pre>\n\n<p>(#action_window is a div in the Client index view)</p>\n\n<p>In views/visits/_new.html.erb:</p>\n\n<pre><code>&lt;%= render \"form\" %&gt;\n&lt;%= link_to \"Cancel\", @client, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>In views/visits/_form.html.erb:</p>\n\n<pre><code>%= form_for [@client, @visit] do |f| %&gt;\n&lt;td&gt;&lt;%= text_field_tag :visit_date, @visit.visit_date, :class =&gt; 'visit_date' %&gt;\n</code></pre>\n\n<p>I have not been able to get the Datepicker to work, presumably because the HTML creating the \"New Visit\" view is rendered, and somehow JQueryUI can't associate it without that \"hasDatepicker\" thing added to the class.</p>\n"},{"tags":["ruby-on-rails-3","performance","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13271561,"title":"ActiveRecord: Is it possible to get the number of DB queries executed in addition to total time in the Rails log?","body":"<p>For every request, I get this in the logs:</p>\n\n<pre><code>Completed 200 OK in 854ms (Views: 1.0ms | ActiveRecord: 17.0ms)\n</code></pre>\n\n<p>Is it possible to get it to also include the number of queries?<br>\nSomething like:</p>\n\n<pre><code>Completed 200 OK in 854ms (Views: 1.0ms | ActiveRecord: 17.0ms | Queries: 10)\n</code></pre>\n\n<p>Ideally, I'd like all the \"cached\" ones to show up in that count too. Ie, even if the \"cache\" is saving me from \"N+1\" queries from hitting the DB, I still want to know I have a problem.</p>\n\n<p>I'm fine with monkeypatching / manually editing something, since I really want this just for my dev box. </p>\n\n<p>(If this can be made civilizedly so I can have it in production, that's even better, but if not, I'm fine with just having a manually modified Rails in my own machine)</p>\n\n<p>Thanks!<br>\nDaniel</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13266999,"title":"passing params through a link_to rails 3","body":"<p>Im just looking for some clarification on the following piece of code, well part of it.To give some background i have an app where you can upload recipes, search recipes and save them as favourites, this piece of code is in a controller \"recipes\", action is \"my_recipes\"</p>\n\n<pre><code>&lt;%= link_to \"Add to favorites\",  {:controller =&gt; 'favourites', :action =&gt; 'create', :recipe_id =&gt; recipe.id}, {:method =&gt; :post } %&gt;\n</code></pre>\n\n<p>My understanding is that this creates a link_to (anchor tag if you will) that makes a post request through the create method within the favourites controller. This part I think i underdstand (corrections welcome), the part i am unsure of is </p>\n\n<pre><code>:recipe_id =&gt; recipe.id}\n</code></pre>\n\n<p>I know this is passing the recipe_id for example but I would like to know why we do this? and what relevance of the <code>:</code> before the first recipe_id.May seem obvious to some but you dont know until you learn.</p>\n\n<p>Any help appreciated</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pusher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13267972,"title":"How do I include the users in the result set?","body":"<pre><code>comments = Song.find(65).comments.select('comments.*, users.*').includes(:user).limit(20) \n</code></pre>\n\n<p>How would I include the users in the result set?</p>\n\n<p>Im using the <a href=\"http://pusher.com/\" rel=\"nofollow\">PusherApp</a> and trying to do:</p>\n\n<pre><code>    Pusher[\"foo\"].trigger(\"bar\", { \n      :comments =&gt; comments\n    })\n</code></pre>\n"},{"tags":["ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13273188,"title":"Conditions not working when rendering partial via ajax","body":"<p>In my <strong>index.js.erb</strong></p>\n\n<pre><code>$(\".div\").html(\"&lt;%= escape_javascript(render('something/some_form')) %&gt;\");\n</code></pre>\n\n<p>in <strong>some_form.htm.erb</strong> i have condition which is not working</p>\n\n<pre><code>&lt;% if @variable1 == @variable2 %&gt; \n   show something1\n&lt;% else %&gt;\n   show something2\n&lt;% end %&gt;\n</code></pre>\n\n<p>For some reason when my js.erb renders this partial i always have <em>show something2</em>. So &lt;% if @variable1 == @variable2 %> condition not working</p>\n\n<p>variable1 and variable2 defined in my controller</p>\n\n<p>How can i make this equal condition work?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13271301,"title":"How to configure sequence separator of friendly_id gem","body":"<p>I am using the friendly_id gem version 4.0.9 in Rails 3, and I want to change the default sequence separator from <code>-</code> to <code>_</code>.</p>\n\n<p>I tried  this but it doesn't work:</p>\n\n<pre><code>class Restaurant &lt; ActiveRecord::Base\n   extend FriendlyId\n   friendly_id do |config|\n     config.base = :name\n     config.use :slugged\n     config.sequence_separator = \"_\"\n   end\n  .....\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":34,"score":1,"question_id":13270672,"title":"Parse original email address of the sender of a forwarded email in Ruby","body":"<p>Let's say that below is a sample content of emails I am receiving.</p>\n\n<pre><code> ---------- Forwarded message ----------\n From: Original Sender &lt;original.sender@gmail.com&gt;\n Date: 2012/10/23\n Subject: Lorem Ipsum\n To: recipient@example.com\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails-3","redhat","openshift"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13274681,"title":"Redhat openshift - rails mysql response takes more than 20sec","body":"<p>I have rails (v3.0.9) with mysql running on Redhat open shift. </p>\n\n<p>I have seen that it takes around <strong>35-40 sec</strong> to get JSON response made up of all records from a single table. There are around 10000 records in this single table.</p>\n\n<p>Is there any way to make it faster? i.e To get the response atleast within 10sec.</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13274740,"title":"Issues executing Update.js","body":"<p>I have a controller where the update action responds to js. Everything is going fine but I'm experiencing some really bizarre behavior. Her is my code:</p>\n\n<pre><code>&lt;% if @contact.errors.any? %&gt;\n&lt;% else %&gt;\n  alert('What!?!');\n  $(\"li#contact\").replaceWith(\"&lt;%= escape_javascript render @contact %&gt;\");\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I have no errors, I'm able to replace my list item. However nothing before or after this line with run. The alert will not pop, any other manipulation will not run. Even cutting down the code to:</p>\n\n<pre><code>&lt;% if @contact.errors.any? %&gt;\n    &lt;% else %&gt;\n      alert('What!?!');\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I can not get it to alert. I know I don't have error rendering yet but what I'm executing has no errors. Has anyone experienced with wonky behavior before? (create.js, destroy.js all work fine).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-admin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13091638,"title":"How to override enumeration data in rail_admin gem","body":"<p>In my models, BookHeader has many Category\nSo, when edit or create new BookHeader, the form show like this\n<a href=\"http://nr7.upanh.com/b3.s32.d2/89392864d0eb4a6e3988ab7b137ff7fa_50339337.catetgoryfix.png\" rel=\"nofollow\">Enum fix?</a></p>\n\n<p>I wanna change the \"category #{id}\" to category name by define a category_enum method but it still don't work. Please help!</p>\n\n<p>Code for BookHeader model</p>\n\n<pre><code>class BookHeader &lt; ActiveRecord::Base\n  attr_accessible :autho, :category_id, :description, :title, :book_type, :year,:publisher_id,:detail\n  has_many :books\n  belongs_to :category\n  belongs_to :publisher\n  TYPE = {:ebook=&gt;\"Ebook\",:paper_book=&gt; \"PaperBook\",:magazine=&gt; \"Magazine\",:media=&gt; \"Media\"}\n  DEFAULT_TAB = :paper_book\n  BOOKS_PER_PAGE = 1 # books to show in a pages (pagination)\n  extend FriendlyId\n  def book_type_enum #it worked here\n    TYPE.map{|key, val| [val]}\n  end\n  def category_enum #but dont' work here\n    [\"a\",\"b\"]\n  end\n</code></pre>\n\n<p>Code for edit form</p>\n\n<pre><code>edit do\n        field :title\n        field :description, :text do\n          ckeditor do true end\n        end\n        field :autho\n        field :book_type\n        field :category\n      end\n</code></pre>\n\n<p>See the Division attribute in <a href=\"http://rails-admin-tb.herokuapp.com/admin/team/73/edit\" rel=\"nofollow\">this link</a></p>\n"},{"tags":["ruby-on-rails-3","gmaps4rails"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":350,"score":1,"question_id":9425816,"title":"gmaps4rails - Drop a marker and update fields attribute in a form","body":"<p>I'm trying to implement this, from the gem wiki <a href=\"https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Javascript-goodies\" rel=\"nofollow\">https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Javascript-goodies</a></p>\n\n<pre><code>&lt;% content_for :scripts do %&gt;\n    &lt;script type=\"text/javascript\" charset=\"utf-8\"&gt;\n        var markersArray = [];\n        // On click, clear markers, place a new one, update coordinates in the form\n        Gmaps.map.callback = function() {\n            google.maps.event.addListener(Gmaps.map.map, 'click', function(event) {\n              clearOverlays();\n              placeMarker(event.latLng);\n              updateFormLocation(event.latLng);\n            });\n        };\n        // Update form attributes with given coordinates\n        function updateFormLocation(latLng) {\n            $('location_attributes_latitude').value = latLng.lat();\n            $('location_attributes_longitude').value = latLng.lng();\n            $('location_attributes_gmaps_zoom').value = Gmaps.map.map.getZoom();\n        }\n        // Add a marker with an open infowindow\n        function placeMarker(latLng) {\n            var marker = new google.maps.Marker({\n                position: latLng, \n                map: Gmaps.map.map,\n                draggable: true\n            });\n            markersArray.push(marker);\n            // Set and open infowindow\n            var infowindow = new google.maps.InfoWindow({\n                content: '&lt;div class=\"popup\"&gt;&lt;h2&gt;Awesome!&lt;/h2&gt;&lt;p&gt;Drag me and adjust the zoom level.&lt;/p&gt;'\n            });\n            infowindow.open(Gmaps.map.map,marker);\n            // Listen to drag &amp; drop\n            google.maps.event.addListener(marker, 'dragend', function() {\n                updateFormLocation(this.getPosition());\n            });\n        }\n        // Removes the overlays from the map\n        function clearOverlays() {\n          if (markersArray) {\n            for (var i = 0; i &lt; markersArray.length; i++ ) {\n              markersArray[i].setMap(null);\n            }\n          }\n          markersArray.length = 0;\n        }\n    &lt;/script&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>But with no luck...I'm guessing its more of an issue with the name/id of my field(s), pardon my javascript knowledge.</p>\n\n<p>I've changed the fields to update with the coordinates:</p>\n\n<pre><code>function updateFormLocation(latLng) {\n  $('location[lat]').value = latLng.lat();\n  ...\n}\n</code></pre>\n\n<p>But the field doesn't get updated:</p>\n\n<pre><code>= simple_form_for :location do |l|\n  = l.input :lat\n  ...\n</code></pre>\n\n<p>Am I missing something? Thanks!</p>\n"},{"tags":["ruby-on-rails-3","ubuntu","apache2","passenger","spawning"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13273952,"title":"Ubuntu - Apache - Rails - Passenger - Spawning error","body":"<p>I've got the error where passenger complains that:</p>\n\n<pre><code>*** Passenger ERROR (ext/common/ApplicationPool/../SpawnManager.h:220):\nCould not start the spawn server: /usr/local/rvm/gems/ruby-1.9.3-head/ruby: No such file or directory (2)\n[ pid=8970 thr=139698295748416 file=ext/apache2/Hooks.cpp:865 time=2012-11-07 17:17:32.422 ]: Unexpected error in mod_passenger: Cannot spawn application '/www/lensfinder.se/ruby/lensfinder': Could not read from the spawn server: Connection reset by peer (104)\n  Backtrace:\n     in 'virtual Passenger::SessionPtr Passenger::ApplicationPool::Client::get(const Passenger::PoolOptions&amp;)' (Client.h:750)\n     in 'Passenger::SessionPtr Hooks::getSession(const Passenger::PoolOptions&amp;)' (Hooks.cpp:297)\n     in 'int Hooks::handleRequest(request_rec*)' (Hooks.cpp:566)\n</code></pre>\n\n<p>From what I can read is that it cant access /www/lensfinder.se/ruby/lensfinder though it exist.</p>\n\n<p>And I found this FAQ on <a href=\"http://www.modrails.com/documentation/Users%20guide%20Apache.html#_the_apache_error_log_says_that_the_spawn_manager_script_does_not_exist_or_that_it_does_not_have_permission_to_execute_it\" rel=\"nofollow\">Phusion Passengers site</a></p>\n\n<p>The problem is that, when I try to use that command, </p>\n\n<pre><code>passenger-config --root\n</code></pre>\n\n<p>I get this: </p>\n\n<pre><code>-bash: /usr/bin/passenger-config: ruby: bad interpreter: No such file or directory\n</code></pre>\n\n<p>apache config:</p>\n\n<pre><code>LoadModule passenger_module /usr/local/rvm/gems/ruby-1.9.3-head/gems/passenger-3.0.12/ext/apache2/mod_passenger.so\n   PassengerRoot /usr/local/rvm/gems/ruby-1.9.3-head/gems/passenger-3.0.12\n   PassengerRuby /usr/local/rvm/wrappers/ruby-1.9.3-head/ruby\n\n&lt;VirtualHost 10.0.0.37:80&gt;\n    ServerAdmin webmaster@compartment.se\n    DocumentRoot /www/lensfinder.se/htdocs\n    ServerName lensfinder.se\nRedirect 301 / http://www.lensfinder.se/\n    ErrorLog /var/log/apache2/lensfinder.se-error.log\n    CustomLog /var/log/apache2/lensfinder.se-access.log combined\n&lt;/VirtualHost&gt;\n&lt;VirtualHost 10.0.0.37:80&gt;\n    ServerAdmin hostmaster@compartment.se\n    ServerName lensfinder.se\n    ServerAlias www.lensfinder.se\n    ServerAlias *.lensfinder.se\n#   DocumentRoot /www/lensfinder.se/htdocs\n    DocumentRoot /www/lensfinder.se/ruby/lensfinder/script\n    &lt;Directory /&gt;\n        Options FollowSymLinks\n        AllowOverride all\n    &lt;/Directory&gt;\n    &lt;Directory /www/lensfinder.se/htdocs&gt;\n        Options Indexes FollowSymLinks MultiViews\n        AllowOverride None\n        Order allow,deny\n        allow from all\n    &lt;/Directory&gt;\n    ScriptAlias /cgi-bin/ /www/lensfinder.se/cgi-bin/\n    &lt;Directory \"/www/lensfinder.se/cgi-bin\"&gt;\n        AllowOverride None\n        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n        Order allow,deny\n        Allow from all\n        AllowOverride AuthConfig\n#Options Includes\n#Options FollowSymLinks\n#Options +Indexes +Multiviews +FollowSymLinks\n    &lt;/Directory&gt;\n    &lt;Directory \"/www/lensfinder.se/htdocs/usage\"&gt;\n        AllowOverride None\n        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n        Order allow,deny\n        Allow from all\n        AllowOverride AuthConfig\n#Options Includes\n#Options FollowSymLinks\n#Options +Indexes +Multiviews +FollowSymLinks\n    &lt;/Directory&gt;\n    ErrorLog /var/log/apache2/lensfinder.se-error.log\n    # Possible values include: debug, info, notice, warn, error, crit,\n    # alert, emerg.\n    LogLevel warn\n    CustomLog /var/log/apache2/lensfinder.se-access.log combined\n    Alias /doc/ \"/usr/share/doc/\"\n    &lt;Directory \"/usr/share/doc/\"&gt;\n        Options Indexes MultiViews FollowSymLinks\n        AllowOverride None\n        Order deny,allow\n        Deny from all\n        Allow from 127.0.0.0/255.0.0.0 ::1/128\n    &lt;/Directory&gt;\n\n\nAlias /ruby/ /www/lensfinder.se/ruby/lensfinder/script\n        &lt;Directory /www/lensfinder.se/ruby/lensfinder/script&gt;\n#       Options ExecCGI\n#       AddHandler cgi-script .cgi\n#       Addhandler fastcgi-script .fcgi .fcg .fpl\n        AllowOVerride all\n        Order allow,deny\n        Allow from all\n        &lt;/Directory&gt;\n\n&lt;IfModule passenger_module&gt;\n   PassengerRoot /usr/local/rvm/gems/ruby-1.9.3-head/gems/passenger-3.0.12\n   PassengerRuby /usr/local/rvm/gems/ruby-1.9.3-head/ruby\n&lt;/IfModule&gt;\n\nRailsEnv production\nRailsBaseURI /script\n\n\n\n#\n&lt;Location /&gt;\n# Insert filter\nSetOutputFilter DEFLATE\n\n# Netscape 4.x has some problems...\nBrowserMatch ^Mozilla/4 gzip-only-text/html\n\n# Netscape 4.06-4.08 have some more problems\nBrowserMatch ^Mozilla/4\\.0[678] no-gzip\n\n# MSIE masquerades as Netscape, but it is fine\n# BrowserMatch \\bMSIE !no-gzip !gzip-only-text/html\n\n# NOTE: Due to a bug in mod_setenvif up to Apache 2.0.48\n# the above regex won't work. You can use the following\n# workaround to get the desired effect:\nBrowserMatch \\bMSI[E] !no-gzip !gzip-only-text/html\n\n# Don't compress images\nSetEnvIfNoCase Request_URI \\\n\\.(?:gif|jpe?g|png)$ no-gzip dont-vary\n\n# Make sure proxies don't deliver the wrong content\n#Header append Vary User-Agent env=!dont-vary\n&lt;/Location&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc","asset-pipeline","view-inheritance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13260900,"title":"With Rails 3 view inheritance, is it possible to call \"super\" within a child view, but send the parent variables?","body":"<p>Every <code>show</code> action in my app has the same template for every model (it is an Admin-portal type interface). I have a view <code>show.html.erb</code> that all of these models inherit. </p>\n\n<p>The controllers all use InheritedResources, so I have access to some helper variables such as <code>resource</code>, which I use to display the attributes for the model being shown through <code>resource.attributes</code> in my parent view.</p>\n\n<p>What I would like to be able to do is whitelist which attributes are being shown in each model. I have thought of two ways to do this... the first is to define some method in a class my model's inherit from, say it is called <code>attr_visible</code> and define each attribute in the model. The reason I don't like this approach is that it puts too much of the view logic in the models. I would rather provide my views with the model, and let the view determine what is displayed.</p>\n\n<p>The second approach is what this question is about. I want to have a file <code>/app/views/users/show.html.erb</code>, and set which attributes for a User I would like to be shown, say something like:</p>\n\n<pre><code>@attributes = [:name, :email, :etc]\n</code></pre>\n\n<p>And then pass them to the parent view which I described in the beginning of this question. That view would then be able to loop through <code>@attributes</code> and display the attributes necessary.</p>\n\n<p>Is it possible to use a \"<code>super</code>\"-type method from views? Everything I have read about view inheritance suggests the view is loaded based on where it is located in the directory structure, and then after that you're out of luck.</p>\n\n<p>edit: I have sort of done what I want. I defined a partial _show.html.erb in the /app/views/users directory that looks like:</p>\n\n<pre><code>&lt;% @attributes = ['name', ...] %&gt;\n</code></pre>\n\n<p>And then in the parent view I call <code>&lt;%= render \"show\" %&gt;</code> before looping through <code>@attributes</code>. This works, but feels clunky since I am not actually rendering anything when I call <code>render</code>. Is there a better way?</p>\n"},{"tags":["ruby-on-rails-3","file-upload","carrierwave","rackspace","fog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":12922980,"title":"Fog::Storage::Rackspace::NotFound error when using Carrierwave to upload to Rackspace","body":"<p>Everyone: I already searched the error before I posted this to Stackoverflow, so no need to point me to this: groups.google.com/forum/?fromgroups=#!topic/carrierwave/ It's not the same problem.</p>\n\n<p>I'm using Carrierwave so users can upload files to my Rackspace container. But when I Submit from my site (on my local machine, still in test mode), I get a <strong>Fog::Storage::Rackspace::NotFound</strong> app/controllers/authors_controller.rb:8:in `update' error. My Rackspace container is called kontainer.ofstuff. Here's my code:</p>\n\n<p>pic_uploader.rb: </p>\n\n<pre><code>class PicUploader &lt; CarrierWave::Uploader::Base\n\n  include Rails.application.routes.url_helpers\n  storage :fog\n\n  def store_dir\n    \"#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\nend\n</code></pre>\n\n<p>model author.rb</p>\n\n<pre><code>class Author &lt; ActiveRecord::Base\n  attr_accessible :stuff, :profilepic\n\n  mount_uploader :pic, PicUploader\n\n  def dostuff\n  end\nend\n</code></pre>\n\n<p>carrierwave.rb is in the config/initializers directory</p>\n\n<pre><code>CarrierWave.configure do |config|\n\n  config.storage = :fog\n  config.fog_credentials = {\n    :provider           =&gt; 'Rackspace',\n    :rackspace_username =&gt; 'myusername',\n    :rackspace_api_key  =&gt; '98765asecretnumber3'\n  })\n  config.fog_directory = 'kontainer.ofstuff'\n  config.fog_host = 'https://34567secretnumberiiiii.ssl.cf2.rackcdn.com'\nend\n</code></pre>\n\n<p>controller authors_controller.rb</p>\n\n<pre><code>class AuthorsController &lt; ApplicationController\n\n  def update\n    @author = Author.find(params[:id])\n    @booklist = Book.where(:author_id =&gt; @author.id)\n#line 7\n    if @author.update_attributes(params[:author])\n      sign_in @author\n      redirect_to @author\n    else\n      render 'profileinfo'\n    end\n  end\nend\n</code></pre>\n\n<p>edit.html.erb:</p>\n\n<pre><code>&lt;%= f.file_field :pic %&gt;\n&lt;%= f.submit \"Save Author Info\" %&gt; \n</code></pre>\n\n<p>When I had this code 'uploading'/storing to a file, this worked fine. Perhaps f.submit does not work with Carrierwave? If not...where do I find the correct code for submitting?</p>\n\n<p>Any ideas what the trouble is?</p>\n"},{"tags":["ruby-on-rails-3","rubygems","imagemagick","rvm","rmagick"],"answer_count":7,"favorite_count":4,"up_vote_count":28,"down_vote_count":1,"view_count":18293,"score":27,"question_id":5201689,"title":"rmagick gem install \"Can't find Magick-config\"","body":"<p>I get the error shown below when attempting to install the rmagick gem. I am on Snowleopard 10.6 using RVM, Ruby 1.9.2-head and Rails 3.05. Responses to similar questions recommended installing ImageMagick, which I successfully did. Other suggested installing the \"libmagick9-dev library\", however, I can not figure out how to do this.</p>\n\n<p>I'm a new developer, and any assistance or directions to an existing explanation or resource is greatly appreciated. Thanks!</p>\n\n<pre><code>jjdevenuta(opal)$ gem install rmagick\nFetching: rmagick-2.13.1.gem (100%)\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rmagick:\nERROR: Failed to build gem native extension.\n\n/Users/jjdevenuta/.rvm/rubies/ruby-1.9.2-head/bin/ruby extconf.rb\nchecking for Ruby version &gt;= 1.8.5... yes\nchecking for gcc... yes\nchecking for Magick-config... no\nCan't install RMagick 2.13.1. Can't find Magick-config in /Users/jjdevenuta/.rvm/gems/ruby-1.9.2-head@rails3/bin:/Users/jjdevenuta/.rvm/gems/ruby-1.9.2-head@global/bin:/Users/jjdevenuta/.rvm/rubies/ruby-1.9.2-head/bin:/Users/jjdevenuta/.rvm/bin:/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/git/bin:/usr/X11/bin\n\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/jjdevenuta/.rvm/rubies/ruby-1.9.2-head/bin/ruby\n</code></pre>\n\n<p><strong>UPDATE</strong>\nIf you're a Mac/OS X user I would HIGHLY recommend using Homebrew as your package installer/manager. You can find it <a href=\"http://mxcl.github.com/homebrew/\">HERE</a>. Since originally asking this question I have removed all my prior installs of things like rmagick and imagemagick, and reinstalled them using Homebrew. Super easy with a huge catalog of packages, and updates/uninstalls are a cinch as well!</p>\n"},{"tags":["ruby-on-rails-3","html5","css3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13272118,"title":"twitter bootstrap drop down issue","body":"<p>Hi I am using twitter bootstrap for my website. I have put dropdown in collpsable which is in modal window. My problem is the dropdow I have put in collaspable inner, it cutoff the menu. Here is that Image<img src=\"http://i.stack.imgur.com/FeMgv.png\" alt=\"enter image description here\"></p>\n\n<p>It should show like this :\n <img src=\"http://i.stack.imgur.com/0dScs.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried by changing the z-index attribute but unable to show it. Can anybody know what is  the problem?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13230787,"title":"make variable available in all method of controller when passed in one method","body":"<p>Here i send the user.id as params dd</p>\n\n<pre><code>&lt;h3&gt;&lt;%= link_to(\"Lend Asset\", {:controller =&gt; 'empassets', :action=&gt; 'index', :dd =&gt; user.id})%&gt;&lt;/h3&gt;\n</code></pre>\n\n<p>In controller empassets i fetch it by </p>\n\n<pre><code>  def index\n     @id = params[:dd]\n     @empassets = Empasset.where(:ad =&gt; @id)\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @empassets }\n    end\n  end\n\n  def show\n     @id = params[:dd]\n    @empasset = Empasset.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @empasset }\n    end\n  end\n\n  def new\n     @id = params[:dd]\n    @empasset = Empasset.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @empasset }\n    end\n  end\n\n  def edit\n     @id = params[:dd]\n    @empasset = Empasset.find(params[:id])\n  end\n</code></pre>\n\n<p>I need this @id in all new show edit method. But it takes in index only as i mention it in index. How can i make such that if Lend asset is click then @id= params[:id] have value in all methods. How can it is possible to make it available for another @id = params[:id] is not send in that controller?</p>\n"},{"tags":["ruby-on-rails-3","cookies","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13272069,"title":"IE/Safari not saving/reading cookie properly CSRF?","body":"<p>I have a user model based off of Michael Hartl's Ruby on Rails Tutorial (Second Edition) It works fine in practice locally hosted from a linux box but when I deploy to Heroku there is a problem with IE ans Safari. (Chrome and firefox work great.) I use the cookie to set the value current_user which I call constantly on the site.</p>\n\n<p>here is my sessions_helper.rb</p>\n\n<pre><code>module SessionsHelper\n\n  def sign_in(user)\n    cookies.permanent[:remember_token] = user.remember_token\n    self.current_user = user\n  end\n\n  def signed_in?\n    !current_user.nil?\n  end\n\n  def current_user=(user)\n    @current_user = user\n  end\n\n  def current_user\n    @current_user ||= User.find_by_remember_token(cookies[:remember_token])\n  end\n\n  def current_user?(user)\n    user == current_user\n  end\n\n  def signed_in_user\n    unless signed_in?\n      store_location\n      redirect_to signin_url, notice: \"Please sign in.\" \n    end\n  end\n\n  def sign_out\n    self.current_user = nil\n    cookies.delete(:remember_token)\n  end\n\n  def redirect_back_or(default)\n    redirect_to(session[:return_to] || default)\n    session.delete(:return_to)\n  end\n\n  def store_location\n    session[:return_to] = request.url\n  end\nend\n</code></pre>\n\n<p>My sessions controller is as follows:\n    class SessionsController &lt; ApplicationController</p>\n\n<pre><code>  def new\n  end\n\n  def create\n    user = User.find_by_email(params[:session][:email].downcase)\n    if user &amp;&amp; user.authenticate(params[:session][:password])\n      sign_in user\n      redirect_back_or user\n    else\n      flash.now[:error] = 'Invalid email/password combination'\n      render 'new'\n    end\n  end\n\n  def destroy\n    sign_out\n    redirect_to root_url\n  end\n\nend\n</code></pre>\n\n<p>Again when I create a user/log in it looses my cookie only in IE8> and Safari.\nHere is the log I'm getting.</p>\n\n<pre><code>2012-11-06T19:28:08+00:00 app[web.1]: Started POST \"/sessions\" for XXX.XXX.XXX.XXX at  2012-11-06 19:28:08 +0000\n2012-11-06T19:28:08+00:00 app[web.1]: Processing by SessionsController#create as HTML\n2012-11-06T19:28:08+00:00 app[web.1]: Parameters: {\"utf8\"=&gt;\"â\", \"authenticity_token\"=&gt;\"Eh3xta4VHlHgBVEKiLn3CRKgWb5xFbAx91eNJlYFySs=\", \"session\"=&gt;{\"email\"=&gt;\"A@User.com\", \"password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Sign in\"}\n2012-11-06T19:28:08+00:00 app[web.1]: WARNING: Can't verify CSRF token authenticity\n2012-11-06T19:28:08+00:00 app[web.1]: Redirected to https://some-app_1234.herokuapp.com/users/1\n2012-11-06T19:28:08+00:00 app[web.1]: Completed 302 Found in 391ms (ActiveRecord: 16.1ms)\n2012-11-06T19:28:08+00:00 heroku[router]: POST some-app-1234.herokuapp.com/sessions dyno=web.1 queue=0 wait=0ms service=508ms status=302 bytes=114\n2012-11-06T19:28:09+00:00 app[web.1]:\n2012-11-06T19:28:09+00:00 app[web.1]:\n2012-11-06T19:28:09+00:00 app[web.1]: Started GET \"/users/1\" for XXX.XXX.XXX.XXX at     2012-11-06 19:28:09 +0000\n2012-11-06T19:28:09+00:00 app[web.1]: Processing by UsersController#show as HTML\n2012-11-06T19:28:09+00:00 app[web.1]: Parameters: {\"id\"=&gt;\"1\"}\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered shared/_stats.html.erb (205.2ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered microposts/_micropost.html.erb (15.0ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered users/show.html.erb within layouts/application (247.6ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered layouts/_shim.html.erb (0.0ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered layouts/_header.html.erb (1.2ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered layouts/_footer.html.erb (0.3ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Completed 200 OK in 256ms (Views: 52.5ms | ActiveRecord: 202.4ms)\n2012-11-06T19:28:09+00:00 heroku[router]: GET some-app-1234.herokuapp.com/users/1 dyno=web.1 queue=0 wait=0ms service=544ms status=200 bytes=2394\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","phusion-passenger","dragonfly-gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13237954,"title":"wrong URLs from relative links deploying to a subdirectory","body":"<p>in my view I have:</p>\n\n<p><code>&lt;a href=\"&lt;%= @project.file.url %&gt;\"&gt;&lt;%= @project.file.name %&gt;&lt;/a&gt;</code></p>\n\n<p>locally, in development, all works fine and I can download the file. But on my VPS in production I get a 404:</p>\n\n<p><code>[Mon Nov 05 18:28:40 2012] [error] [client 88.7.246.152] File does not exist: /srv/http/media, referer: http://www.stanosas.it/copisteria/projects/1</code></p>\n\n<p>no trace in <code>log/production.log</code></p>\n\n<p><code>link_to</code> works fine.</p>\n\n<p>here is my Apache (Passenger) setup <a href=\"https://gist.github.com/4018657\" rel=\"nofollow\">https://gist.github.com/4018657</a></p>\n\n<p>I access my app in a subfolder like <code>www.myapp.com/copisteria</code></p>\n\n<p>here is <code>config/initializers/dragonfly.rb</code> <a href=\"https://github.com/enricostano/copisteria/blob/master/config/initializers/dragonfly.rb\" rel=\"nofollow\">https://github.com/enricostano/copisteria/blob/master/config/initializers/dragonfly.rb</a></p>\n\n<p>here is <code>config/application.rb</code> <a href=\"https://github.com/enricostano/copisteria/blob/master/config/application.rb\" rel=\"nofollow\">https://github.com/enricostano/copisteria/blob/master/config/application.rb</a></p>\n\n<p>any hint?</p>\n\n<p>EDIT: It seems that Apache or Passenger doesn't recognize the subdirectory for relative links.</p>\n"},{"tags":["ruby-on-rails-3","associations","rails-admin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13273019,"title":"Is it possible to create select field onchange event in rails admin","body":"<p>I have Two models with has_many relation and I am using rails admin.</p>\n\n<p>Well,I want a select field with on change event,which leads to load another select field values according to the selection of first select field in rails admin,should I need to make an ajax call,if so then where should I have to configure it.</p>\n\n<p>Please help me, thanks in advance. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270656,"title":"Mailbox not sending e-mails: wrong number of arguments (1 for 0)","body":"<p>When sending a message I can see this in my console:</p>\n\n<pre><code>Sent mail to You should add method :mail_email in your Messageable model (2093ms\n)\nDate: Wed, 07 Nov 2012 14:08:50 +0100\nFrom: mail@myemail.com\nto: You should add method :mail_email in your Messageable model\n</code></pre>\n\n<p>And the initializers for the Mailbox gem:</p>\n\n<pre><code>Mailboxer.setup do |config|\n\n  #Configures if you applications uses or no the email sending for Notifications and Messages\n  config.uses_emails = true\n\n  #Configures the default from for the email sent for Messages and Notifications of Mailboxer\n  config.default_from = \"mail@myemail.com\"\n\n  #Configures the methods needed by mailboxer\n  config.email_method = :mail_email\n  config.name_method = :name\n\n  #Configures if you use or not a search engine and wich one are you using\n  #Supported enignes: [:solr,:sphinx] \n  config.search_enabled = false\n  config.search_engine = :solr\nend\n</code></pre>\n\n<p>In my user model I have: </p>\n\n<pre><code>acts_as_messageable\n  def name\n    email\n  end\n\n def mail_email\n    @mail_email = self.email\n end\n</code></pre>\n\n<p>But I get this error in view when sending a message:</p>\n\n<pre><code> ArgumentError in ConversationsController#reply\n\nwrong number of arguments (1 for 0)\n\nRails.root: C:/rails/sitesale\nApplication Trace | Framework Trace | Full Trace\n\napp/models/user.rb:17:in `mail_email'\napp/controllers/conversations_controller.rb:22:in `reply'\n</code></pre>\n\n<p>And the controller method reply:</p>\n\n<pre><code>  def reply\n    current_user.reply_to_conversation(conversation, *message_params(:body, :subject))\n    redirect_to conversation\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","jquery-ajax","unobtrusive-javascript"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13272778,"title":":remote => true/data-remote on a form loaded via ajax","body":"<p>In my Rails app, I have a form that is loaded via Ajax using jQuery load method.</p>\n\n<pre><code>function load_sales_form(product_id) {\n    $(\"#sales_form\").load(\"&lt;%= url_for(:action =&gt; :show_sales_form %&gt;\"/ + product_id);\n}\n</code></pre>\n\n<p>The loaded form has a form_for tag with the <strong>:remote => true</strong> option and it does add the <strong>data-remote=\"true\"</strong> attribute to the form.</p>\n\n<p>But the form isn't submitted using Ajax when the user clicks the submit tag button. It works fine if the form is loaded in the standard, non-ajax way, but it the form is loaded via ajax after the document is ready, is does not submit using ajax, it submits as a standard form.</p>\n\n<p>From what I studied so far, this happens because the rails.js file (which contains the stuff that allow data-remote forms to be submitted via ajax) does not apply it's features to html content loaded via ajax.</p>\n\n<p>Is it possible to force rails.js file to apply it's features to content loaded via Ajax?</p>\n"},{"tags":["ruby","ruby-on-rails-3","rest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13271690,"title":"Why does respond_with JSON not work?","body":"<p>I'm having a problem when trying to use the return to in a rails controller. This is not working:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\nrespond_to :json\n\n    def create\n        @user = User.create params[:user_info] \n        respond_with @user\n    end\nend\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\nrespond_to :json\n\n    def create \n        @user = User.create params[:user_info] \n        respond_with @user do |format|\n              format.json { render json: @user.to_json }\n        end\n    end\nend\n</code></pre>\n\n<p>Why? This is the error I have in the server's log when using the one that doesn't work:</p>\n\n<pre><code>NoMethodError (undefined method `user_url' for #&lt;UsersController:0x007fd44d83ea90&gt;):\napp/controllers/users_controller.rb:7:in `create'\n</code></pre>\n\n<p>My route is:    </p>\n\n<pre><code>resources :users, :only =&gt; [:create]\n</code></pre>\n"},{"tags":["ajax","ruby-on-rails-3","remote-forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13256716,"title":"Rails remote form complete handler fires but success/failure don't","body":"<p>I am submitting a form through rails, and the response is coming backing with 200 OK headers.  My complete event fires, but neither success nor failure fire.  Any ideas?</p>\n\n<p>The JS:</p>\n\n<pre><code>$('form#booking-email').bind('ajax:complete',function(){\n    alert('complete');\n\n});\n\n$('form#booking-email').bind('ajax:success',function(){\n    alert('success');\n});\n\n$('form#booking-email').bind('ajax:failure',function(){\n    alert('failure');\n\n});\n</code></pre>\n\n<p>My Controller</p>\n\n<pre><code> respond_to do |format|\n    format.json { head :ok }\n  end\n</code></pre>\n\n<p>The Response:</p>\n\n<pre><code>Status: 200 OK\n\nCache-Control: max-age=0, private, must-revalidate\n\nConnection: Keep-Alive\n\nContent-Length: 1\n\nContent-Type: application/json; charset=utf-8\n\nDate: Sat, 03 Nov 2012 01:00:11 GMT\n\nEtag: \"7215ee9c7d9dc229d2921a40e899ec5f\"\n\nServer: WEBrick/1.3.1 (Ruby/1.9.2/2012-02-14)\n\nSet-Cookie: _myeasybnb_session=BAh7CEkiD3Nlc3Npb25faWQGOgZFRkkiJWQ3NTE2ODMzZjMyY2RhZTU1NjAwMzk3MWIyYjdhZDMzBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMTFNN1hvWGhUdytSSjVRcCtrdWFLVTk5NnBEQWF5QXVxRlR2L1pwV1JjUmM9BjsARkkiGXdhcmRlbi51c2VyLnVzZXIua2V5BjsAVFsISSIJVXNlcgY7AEZbBmkGSSIiJDJhJDEwJEJ3Uy5lTzI3Ly4xY05xWlhGZzJ3cy4GOwBU--bd4de54c468e9cedc322949bba91adb5a60bb92f; path=/; HttpOnly\n\nX-Request-Id: 0bb75d4727fbe149b868214f39763030\n\nX-Runtime: 2.183082\n\nX-UA-Compatible: IE=Edge\n</code></pre>\n"},{"tags":["ruby-on-rails-3","capistrano","passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12710008,"title":"Could not find mysql2-0.3.11 in any of the sources (Bundler::GemNotFound)","body":"<p>I'm using Capistrano to deploy a Rails application on a staging environment. <code>cap deploy:update</code> works fine, but Passenger keeps reporting this\n<code>Could not find mysql2-0.3.11 in any of the sources (Bundler::GemNotFound)</code></p>\n\n<p>I did perform <code>bundle install</code>, <code>bundle list</code> and <code>gem list</code> both show the gem as installed and operations that require db access under <code>rails console</code> work fine, all of these on the server. On my machine everything is OK.</p>\n\n<p>I'm using RVM, Ruby 1.9.3, Rails 3.2.8 and this is the relevant part of deploy.rb:</p>\n\n<pre><code>set :rvm_ruby_string, ENV['GEM_HOME'].gsub(/.*\\//,\"\") # Read from local system\nrequire \"rvm/capistrano\" # Load RVM's capistrano plugin.\n</code></pre>\n\n<p>Is it a Passenger issue, am I doing something wrong with Capistrano, or is it a problem with gem versions?</p>\n"},{"tags":["ruby-on-rails-3","heroku","scheduled-tasks","rake-task"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13153173,"title":"Run a rake task every 2 hours using \"Heroku Schedular Standard\"","body":"<p>Am using Heroku Schedular add-on to schedule my rake tasks, the Standard plan for \"Heroku Schedular\" will run any number of commands, either every 10 minutes, every hour, or every day.</p>\n\n<p>But I had a thought of running tasks at an interval of every 2 hrs from a start time. Though the Standard plan doesn't helps me to achieve this and the upgrade can definitely make it as easy as a candy, I have figured out a way using the time factor that I have.</p>\n\n<p>I have the schedule date-time attribute named \"date_time\" for my shows. And every day a task is to be executed at an interval of every 2 hrs with respective to this \"date_time\"</p>\n\n<p>What I managed give me the even status for my show date-time</p>\n\n<pre><code>(((show.try(:date_time).to_time - 2.hour.since(Time.at(Time.now.utc)))/2.hour).ceil).even?\n</code></pre>\n\n<p>But this fails to give a proper 2 hr interval, it results like</p>\n\n<pre><code> 1      2      3      4     5     6     7\ntrue  true   false  true  true  false  true\n</code></pre>\n\n<p>What I was expecting is</p>\n\n<pre><code> 1      2      3      4     5     6      7\ntrue  false   true  false  true  false  true\n</code></pre>\n\n<p>Would be delightful if it gets back in action.</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","query","webhooks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13272004,"title":"RnR: Long running query, Heroku timeouts: webhooks? Ajax?","body":"<p>So here's the issue, we have a data that the users want displayed.  The query, we optimized and indexed to be as fast as I think its going get.  We might shave off a second or two but with the amount of data, not much we can do.  </p>\n\n<p>Anyway, so the query runs great when limited to a day or two of data, however the users are running it for a week or two of data.  So the query for two or three weeks of data takes about 40 seconds, with a Heroku timeout of 30 seconds, that doesn't work.  So we need a solution.  </p>\n\n<p>So searching here and Google, I see comments that webhooks or Ajax would work as out solution.  However, I've been unable to find a real concrete example.  I also saw a comment where someone was saying we could send some kind of response that would \"reset the clock.\" But again sounded intriguing but couldn't find an example.  </p>\n\n<p>We're kind of under the gun, the users are unhappy, so we need a solution that is fast and simple.  Thanks in advance for your help! </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","acts-as-taggable-on","posts"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":451,"score":1,"question_id":10274885,"title":"Acts_as_taggable_on implementation tutorial","body":"<p>I've been trying to allow for tags to be placed on posts so that I could partition them into different sections of my app. I've looked through various gems and have found that acts_as_taggable_on seems to be the most popular one. After various attempts of implementation from the examples in the github of the gem I have not been able to successfully use it. I've searched extensively for a tutorial on implementation but have found none and was hoping someone would have one for such a thing. I'm sorry for the simple question as I am still relatively new to programming. </p>\n"},{"tags":["jquery","ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13247589,"title":"Rails Nested Resources - create and edit 2 levels away with form_for in partial","body":"<p>Really racking my brain on this one.  I'm relatively new to Rails and trying to do something that I'm sure is not too difficult.</p>\n\n<p>I have a model \"Trip\" which has many \"Days\" which has many \"Activities\"</p>\n\n<p>I am in the show.html.erb view of \"Trip\" and in this view, I am rendering a partial for a form that should allow me to create a new \"Activity\" to be associated with a \"Day\" or edit an existing \"Activity\" which already belongs to a \"Day\"</p>\n\n<p>How do I pass to the form_for in the form partial, the local variable of which \"Day\" I want to create the new \"Activity\" for.  And using that same form partial, how can I retrieve the \"Day\" that the \"Activity\" is associated with? Eventually these will be AJAX loaded objects.\nI've googled for the past several hours and can't find any examples similar to this.  I really appreciate the help.</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>  resources :trips do\n    resources :days    \n  end\n\n  resources :days do\n    resources :activities\n  end \n</code></pre>\n\n<p><strong>show.html.erb for the Trip</strong></p>\n\n<pre><code>&lt;div id=\"activities_list\"&gt;\n  &lt;%= render :partial =&gt; \"activities\" %&gt;\n&lt;/div&gt; \n\n&lt;div id=\"activity_form\"&gt;\n  &lt;%= render :partial =&gt; \"/activities/form\", :locals =&gt; { :activity =&gt; @activity}  %&gt;\n&lt;/div&gt;\n\n&lt;div id=\"bottom\"&gt;\n&lt;%= link_to 'Edit', edit_trip_path(@trip) %&gt; |\n&lt;%= link_to 'Back', trips_path %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>_activities.html.erb partial</strong></p>\n\n<pre><code>&lt;h1&gt;&lt;%= @trip.title %&gt;&lt;/h1&gt;\n\n&lt;% @trip.days.each do |day| %&gt;\n&lt;div id=\"blech_&lt;%= day.id %&gt;\"&gt;\n  &lt;b&gt;&lt;%= day.summary %&gt;&lt;/b&gt;\n      &lt;% day.activities.each do |activity| %&gt;\n            &lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_day_activity_path(day, activity), :remote =&gt; true  %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;%= link_to 'New Activity', new_day_activity_path(day), :remote =&gt; true %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>_form.html.erb partial</strong> I know that I need to be calling the day_activity_path with (@day,@activity) variables.  but I don't know how to get the @day variable in here</p>\n\n<pre><code>  &lt;%= form_for([@activity], :remote =&gt; true) do |f| %&gt;\n     &lt;fieldset&gt;\n       &lt;%= f.label :title, \"Activity\" %&gt;&lt;br /&gt;\n       &lt;%= f.text_field :title, :rows =&gt; 1 %&gt;&lt;br /&gt;\n     &lt;/fieldset&gt;\n\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n"},{"tags":["html","css","ruby-on-rails-3","html5","twitter-bootstrap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13271502,"title":"twitter bootstrap typeahead dropdown","body":"<p>Hi i am using twitter bootstrap. I have used typeahead in my model window. My Problem is when I type in textbox the dropdown is coming perfect but its coming at very bottom of textbox. I have observed that there is attribute top set when drop down is coming. But I don't know how to change that at run time. </p>\n\n<p>Here is the Image: <img src=\"http://i.stack.imgur.com/GwXLj.png\" alt=\"enter image description here\"></p>\n\n<p>I am not good in CSS. Can anybody tell me that what should do to resolve this problem ?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2433,"score":6,"question_id":6822904,"title":"undefined method `groups' for Rails:Module","body":"<p>As usual I've been an idiot and broken rails on my mac somehow. I think it all started when it said the version of rake wasn't recent enough so I delved down a huge road of different gems etc. and different versions of rails, I ended up getting rails from github but it replaces it with the most recent version.</p>\n\n<p>Now I fear all of my configuration files are incorrect, but when I try to 'rake rails:update' I get the following error with a trace:</p>\n\n<pre><code>rake aborted!\nundefined method `groups' for Rails:Module\n/Users/jamielawrence/Documents/Websites/JaphexPortfolio/config/application.rb:8\n/Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `gem_original_require'\n/Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `require'\n/Users/jamielawrence/Documents/Websites/JaphexPortfolio/Rakefile:4\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/rake_module.rb:25:in `load'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/rake_module.rb:25:in `load_rakefile'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:495:in `raw_load_rakefile'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:78:in `load_rakefile'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:129:in `standard_exception_handling'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:77:in `load_rakefile'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:61:in `run'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:129:in `standard_exception_handling'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:59:in `run'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/bin/rake:32\n/usr/bin/rake:19:in `load'\n/usr/bin/rake:19\n</code></pre>\n\n<p>I've pretty much had enough tonight, I've been down a million routes (it all started with trying to get an authentication add on to work).</p>\n\n<p>All i want to do is reset the config files to what they were originally for rails 3.0.9, my gem file went from:</p>\n\n<p>gem 'rails', '3.0.9'</p>\n\n<p>to</p>\n\n<p>gem 'rails', :git => 'git://github.com/rails/rails.git'</p>\n\n<p>back to</p>\n\n<p>gem 'rails', '3.0.9'</p>\n\n<p>...I'm an idiot...but an idiot with a huge headache.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13028114,"title":"Navigate nested has_many","body":"<p>I have nested has_many associations</p>\n\n<p>Project has many Parts\nPart has many Tasks\nTask has many jobs</p>\n\n<p>Is there a better way to get all the jobs associated to a project than</p>\n\n<pre><code>project.parts.each do |p|\n  p.tasks.each do |t|\n    t.jobs.each do |j|\n      ...\n    end\n  end\nend \n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","rdoc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13261994,"title":"RDoc just my own application?","body":"<p>Is there a way to stop RDoc from going higher than the current directory? i just tried</p>\n\n<pre><code>rdoc -O -x ../\n</code></pre>\n\n<p>but this also stopped it from parsing relative pathes in subdirectories; what I really need is something like:</p>\n\n<p>If absolute path of App is /foo/bar/MyAppDir/, just RDoc all sources inside and below /foo/bar/MyAppDir/ without parsing /foo/bar/OtherRepository/ from wich some classes derive and get functions I dont want to document.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec2","resque"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261986,"title":"How do you separate test queues and real queues when testing Resque (with rspec and rails?)","body":"<p>I would like to test some resque workers, and the actions that enqueue jobs with these workers. I am using rspec and rails.</p>\n\n<p>Currently I have a model, let's call it Article.rb, that has a before_save method called updates_related_categories that checks if a job with CategoriesSorter needs to be enqueued. If so, it enqueues a job with that worker, with the argument of the category id that the article is related to.</p>\n\n<p>In test, however, these jobs are sent to the same queue as the development server sends jobs to. (i check using the resque server that you can tie into your server at root/redis/overview)</p>\n\n<p>I want to know:</p>\n\n<p>1) How can I send test jobs to a different queue than the development jobs?</p>\n\n<p>If this is possible, any other advice on testing resque is also welcome.</p>\n\n<p>I have seen some related questions that suggest resque-unit and resque-spec but these are pretty undeveloped, and I couldn't get them to a useful working state. Also, I have heard of using Resque.inline but I don't know if that is relevant in this case, as resque isn't called in test specs, it's called from the article model on save of objects created in test.</p>\n\n<p>Sample Code:</p>\n\n<p>Article.rb:</p>\n\n<pre><code> before_save :update_related_categories\n def update_related_categories\n     #some if statements/checks to see if a related category needs updating\n         Resque.enqueue(CategoriesWorker, [category_id])\n     end\n end\n</code></pre>\n\n<p>CategoriesSorter:</p>\n\n<pre><code> class CategoriesSorter\n     @queue=:sorting_queue\n     def self.perform(ids)\n        ids.each do |id|\n           #some code\n        end\n      end\n end\n</code></pre>\n\n<p>Specs:</p>\n\n<pre><code> it \"should do something\" do\n     @article = #set something to enqueue a job\n     @article.save\n     #can i check if a job is enqueued? can i send this job NOT to the development queue but a different one?\n end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13259763,"title":"Rails condition where association has_many has count more than one","body":"<p>Package.rb</p>\n\n<pre><code>has_many :deals\n</code></pre>\n\n<p>Deal.rb</p>\n\n<pre><code>belongs_to package\n</code></pre>\n\n<p>Now simple question is I want to get all packages where deals count is more than one.\nWhat is the best method to do it? <code>where(:available_for_purchase =&gt; true)</code>and <code>self.deals.count &gt; 0</code> </p>\n\n<p>(package.rb)</p>\n\n<pre><code>  class &lt;&lt; self\n    def available\n      where(:available_for_purchase =&gt; true)\n    end\n  end\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","mvc","cells"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13270785,"title":"Accessing devise helpers from cell's controller and views","body":"<p>I'm using <a href=\"https://github.com/apotonick/cells\" rel=\"nofollow\">cells gem</a> and need access devise helpers from cell controller and view, for example current_user.</p>\n\n<p>In controller i'm done with</p>\n\n<pre><code>include Devise::Controllers::Helpers\nDevise::Controllers::Helpers.define_helpers(Devise::Mapping.new(:student, {}))\n</code></pre>\n\n<p>But in view i should create @variable that assign with devise helper from controller, i can't using current_user directly in my cells view. Is there any elegant solution for my problem ?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3","partial","renderpartial"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13259587,"title":"Using javascript .click inside a partial rails","body":"<p>I have a javascript click function that is called every time my textbox gets clicked on, however for some reason it only works if the textbox is inside the main page, when I move the textbox into the partial I render nothing happens when I click on it.  Does anyone know how to make a click event work inside a partial?</p>\n\n<p>My users.js.coffee file</p>\n\n<pre><code>$ -&gt;\n  $(\"form[data-update-target]\").live \"ajax:success\", (evt, data) -&gt;\n    target = $(this).data(\"update-target\")\n  $(\"#\" + target).html data\n\n  $(\"input.submit\").click -&gt;\n    $(this).parent().submit()\n    true\n\n  $(\"#datepicker\").click -&gt;\n    alert \"hello world\"\n</code></pre>\n\n<p>The new page for users</p>\n\n<pre><code>&lt;%= form_tag({:controller =&gt; 'users', :action =&gt; 'preview'}, :remote =&gt; true, :'data-update-target' =&gt; 'update-container') do %&gt;\n  &lt;%= radio_button_tag(:page_type, 'event', false, :class =&gt; 'submit') %&gt;\n  &lt;%= label_tag(:page_type, \"Event\") %&gt;\n  &lt;br/&gt;\n&lt;% end %&gt;\n&lt;div id=\"update-container\"&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The users controller</p>\n\n<pre><code>def preview\n  if params[:page_type] == \"event\"\n    @event = Event.new\n    render :partial =&gt; 'event', :object =&gt; @event\n  end\nend\n</code></pre>\n\n<p>The events partial called _event.html.erb</p>\n\n<pre><code>&lt;%= form_for(@event) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :description %&gt;\n    &lt;%= f.text_area :description %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :start %&gt;\n    &lt;input id=\"datepicker\" type=\"text\" value=\"\" name=\"event_start\"&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>generated html</p>\n\n<pre><code>&lt;body&gt;\n&lt;p id=\"notice\"&gt;&lt;/p&gt;\n&lt;p id=\"alert\"&gt;&lt;/p&gt;\n  &lt;h1&gt;New page&lt;/h1&gt;\n\n&lt;form accept-charset=\"UTF-8\" action=\"/users/preview\" data-remote=\"true\" data-update-target=\"update-container\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"iIodOQohxJgk1P5ZmFrbgw4W/h4cq45LBxGN3xjyREk=\" /&gt;&lt;/div&gt;\n\n&lt;input class=\"submit\" id=\"page_type_event\" name=\"page_type\" type=\"radio\" value=\"event\" /&gt;\n&lt;label for=\"page_type\"&gt;Event&lt;/label&gt;\n&lt;br/&gt;\n&lt;/form&gt;&lt;div id=\"update-container\"&gt;\n&lt;/div&gt;\n&lt;input id=\"datepicker\" type=\"text\" value=\"\" name=\"event_start\"&gt;\n\n&lt;a href=\"/users\"&gt;Back&lt;/a&gt;\n&lt;/body&gt;\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails-3","coffeescript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13270474,"title":"How do I use the new jQuery .on() function (with CoffeeScript)?","body":"<p><code>.on()</code> does not appear to function like <code>.live()</code>. All I want to do is a simple alert to get me going. I have the following element on my page:</p>\n\n<pre><code>&lt;a class=\"add_showcase_item\" href=\"javascript://\"&gt;621015&lt;/a&gt;\n</code></pre>\n\n<p>I have the following CoffeeScript:</p>\n\n<pre><code>$(\"a\").live \"click\", \".add_showcase_item\", -&gt;\n  alert \"hello\"\n  false\n</code></pre>\n\n<p>Unfortunately, this causes the alert to go off on EVERY link. That doesn't make any sense I know. Can anyone help?</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","activerecord","transactions"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":20,"score":3,"question_id":13269109,"title":"ActiveRecord: Concurrent access between validation and writing to the database","body":"<p>Let's say I have on online book store whose data model lookes like that:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FhjaG.png\" alt=\"enter image description here\"></p>\n\n<p>Prior to creating a new order, I want to make sure that enough items are in stock, so I have a method like this</p>\n\n<pre><code>def ensure_enough_in_stock\n    errors.add(:quantity, \"not enough in stock\") if quantity &gt; book.stock\nend\n</code></pre>\n\n<p>To make sure that this method is called prior to saving in the database, I use a validate:</p>\n\n<pre><code>validate :ensure_enough_in_stock, :on =&gt; create\n</code></pre>\n\n<p>So to sum things up, when I create an order:</p>\n\n<ol>\n<li>the validation method is called</li>\n<li>the new order is written into the database (if validation passes)</li>\n</ol>\n\n<p>What happens if between 1. and 2., another process (a concurrent access, another thread, ...) performs a modification on the stock attribute of the same book? Is the exception raised or not?</p>\n\n<p>More generally, how to deal with the cases where something happens <strong>between validation and saving</strong> to the database?</p>\n\n<p>I think that I should put a validation into the database as well, but I don't know what impact it would have on performance. Is there a clever way to deal with this kind of situation?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Locking the transactions as explained <a href=\"http://guides.rubyonrails.org/active_record_querying.html#locking-records-for-update\" rel=\"nofollow\">here</a> prevents write access to stock, but what happens if I also have a \"published\" attribute in the Book model, that can take the values \"public\" or \"private\", and then I want to make sure that you can't buy a book that's private.</p>\n\n<p>But the same way that the stock value could be changed by an external process, the published value can be changed as well: in this case the locking would not be of any help, would it?</p>\n\n<p><img src=\"http://i.stack.imgur.com/Jsb1Y.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails-3","highcharts","wkhtmltopdf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12621327,"title":"highcharts display in my render html page which i want to convert into PDF using wkhtmltopdf in rails","body":"<p>I have html page with some text data and graph. I am using wkhtmltopdf gem to generate pdf from html page. using highcharts, i am generating graph.</p>\n\n<blockquote>\n  <p>I can able to generate PDF successfully but PDF only contains text\n  data and doesn't have graph in it.</p>\n</blockquote>\n\n<p>I already tried with some options as below</p>\n\n<pre><code> - plotOptions: { series: { enableMouseTracking: false, shadow: false, animation: false } }, in Hightcharts jquery coding..\n</code></pre>\n\n<p>Please assist me to resolve this issue.</p>\n"},{"tags":["jquery","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13268307,"title":"Difference between jquery form submission and remote form submission in Rails 3","body":"<p>I have seen some of applications, In ajax requests are two types </p>\n\n<ol>\n<li><code>link_to :remote =&gt;true</code> like ........</li>\n<li><code>$(ajax).save</code> button click function .......</li>\n</ol>\n\n<p>What is the difference between those? Which one is the best approach for rails?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13258805,"title":"params of the model not being returned rails 3","body":"<p>I have made a few posts before this regarding how to add a favourite recipe to a user..I have an app where you can upload recipes once logged in, users can search the entire table for all recipes and view their own recipes  in a member area.. </p>\n\n<p>Now I want users to be able to save their favourite recipes, so far I can save a favourite recipe as such, the output that I get is </p>\n\n<pre><code>[#&lt;Favourite id: 1, user_id: 8, recipe_id: nil, created_at: \"2012-11-06 19:25:34\", updated_at: \"2012-11-06 19:25:34\"&gt;,\n</code></pre>\n\n<p>so i am getting the correct user_id but no params for the actual recipe, ie dish name, country of origin.</p>\n\n<p>My models are like so </p>\n\n<p><strong>User</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\nhas_many :recipes \nhas_many :favourites\n</code></pre>\n\n<p>Recipe</p>\n\n<pre><code>has_many :ingredients \nhas_many :preperations\nhas_many :favourites\n</code></pre>\n\n<p>Favourite</p>\n\n<pre><code>belongs_to :user\nbelongs_to :recipe\n</code></pre>\n\n<p>My favourite controller looks like so</p>\n\n<pre><code> def create\n\n @favourite = current_user.favourites.new(params[:recipe])\n if @favourite.save\n redirect_to my_recipes_path, :notice =&gt; \"Recipe added to Favourites\"\n end\nend\n</code></pre>\n\n<p>Add to favourites link</p>\n\n<pre><code> &lt;%= link_to \"Add to favorites\",  {:controller =&gt; 'favourites', :action =&gt; 'create'}, {:method =&gt; :post } %&gt;\n</code></pre>\n\n<p>I hope I haven’t missed anything out, any help appreciated</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pjax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13088392,"title":"Rails: error with pjax \"Uncaught TypeError: Object [object Object] has no method 'pjax' \"","body":"<p>Gemfile:</p>\n\n<blockquote>\n  <p>gem 'pjax_rails'</p>\n</blockquote>\n\n<p>app/assests/javascripts/application.js :</p>\n\n<pre><code>//= require jquery \n//= require jquery_ujs \n//= require_tree . \n//= require jquery.pjax\n\n\n$(function() {\n $('a').pjax('[data-pjax-container]');\n});\n</code></pre>\n\n<p>app/views/layouts/application.html.erb:</p>\n\n<pre><code>&lt;div id=\"data-pjax-container\" data-pjax-container&gt;\n        &lt;%= yield %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The error i'm getting in chrome is:</p>\n\n<blockquote>\n  <p>Uncaught TypeError: Object [object Object] has no method 'pjax'</p>\n</blockquote>\n\n<p>And it refers to the application.js file. What is wrong here?</p>\n"},{"tags":["android","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13269148,"title":"Rails' send_file to make apk file being installed","body":"<p>I'm trying to make my website sending Android <code>APK</code> files with some pre-validation so the user just clicks the link and the application starts to install on the device.</p>\n\n<p>The point is, i'm using the <code>thin</code> webserver, <code>send_file path, :type =&gt; 'application/vnd.android.package-archive', :disposition =&gt; \"attachment\"</code>, set the header <code>headers['Content-Type'] = 'application/vnd.android.package-archive'</code> and checked the <strong>Allow untrusted sources</strong> box at the device' settings. But the <em>apk</em> file is just downloaded instead of being installed.</p>\n\n<p><strong>UPD:</strong> The following trouble issues on Android 4 only. My Galaxy S with Android 2.3.6 works fine.</p>\n\n<p>What am i doing wrong?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13268935,"title":"Monkey-patching database adapter in Rails app","body":"<p>I'm using PosgreSQL adapter to connect to Vertica database which is mostly compatible with PostgreSQL but doesn't support options like client_min_messages (which are still passed to <code>PGconn.connect</code> despite not being present in <code>database.yml</code>). I've made a quick and dirty monkey patch for <code>ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</code> but the problem is that I guess everything in AR in lazy loaded and the original file is read after my patch. </p>\n\n<p>If I add <code>require 'active_record/connection_adapters/postgresql_adapter'</code> at the top of the monkey patch then ActiveRecord tries to establish connection and fails. Is it possible to alter this behavior to make the monkey patch work or should I just write a full-fledged connection adapter?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13265378,"title":"What happens to rails authenticity token after refersh and when it is ccreated","body":"<p>I want to know when does a authentication token in rails is generated again. Because whenever i refresh the page token doesn't changes?? and i want to know when it will change again</p>\n\n<p>possible duplicate :</p>\n\n<blockquote>\n  <p><a href=\"http://stackoverflow.com/questions/6968106/rails-3-authenticity-token-how-it-is-generated#comment18079544_6968106\">rails 3 authenticity_token how it is generated</a></p>\n</blockquote>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","csv","import"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13266799,"title":"Can't set boolean values when import data from csv to postgresql","body":"<p>I have built a task to import data like this:</p>\n\n<pre><code>CSV.foreach(file, :headers =&gt; true) do |row|  \n  question = Question.new ({  \n  content:   row[0],\n  mark:      row[1],\n  topic_id:  row[2],\n  question_type_id: row[3],\n  answers_attributes: [\n    { content: row[5], correct: row[6] },\n    { content: row[7], correct: row[8] }\n  ]\n})\nquestion.user_id = row[4]\nquestion.save!\n</code></pre>\n\n<p>This is my CSV file:</p>\n\n<pre><code>content, mark, topic_id, question_type_id, user_id, content, correct, content, correct\n_____ are people involved in or affected by project activities, 5, 16, 1, 3, True, 't', False, 'f'\n</code></pre>\n\n<p>But when i run import task, the <code>correct attribute</code> always is FALSE in database, i have tried with different <a href=\"http://www.postgresql.org/docs/9.2/static/datatype-boolean.html\" rel=\"nofollow\">Boolean Data Type</a> of PostgreSQL but not working. What do i wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations","model-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13268580,"title":"How to solve circle associations in rails most elegantly?","body":"<p>Imagine you have these two models containing <strong>a circle reference</strong>:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  has_many :users\n  belongs_to :manager, :class_name =&gt; 'User', :foreign_key =&gt; \"manager_id\"\nend\n\nclass User &lt; ActiveRecord::Base\n  belongs_to :company\n  has_one :managed_company, :class_name =&gt; \"Company\", :foreign_key =&gt; :manager_id\nend\n</code></pre>\n\n<p>Now I create a <strong>new User</strong> with a <strong>new Company</strong> that <strong>manager the user himself is</strong>:</p>\n\n<pre><code>u = User.new\nu.build_company\nu.company.manager = u\nu.save!\n</code></pre>\n\n<p>A Test, if the manager was sucessfully assigned to the company turns out well:</p>\n\n<pre><code>1.9.3p125 :010 &gt; u.company.manager\n =&gt; #&lt;User id: 1548, ...&gt;\n</code></pre>\n\n<p>Yet, the association is not saved:</p>\n\n<pre><code>1.9.3p125 :011 &gt; u.company.manager_id\n =&gt; nil \n</code></pre>\n\n<p>This is, because Rails creates <code>Company</code> first and the <code>User</code> second, being unable to set the <code>manager_id</code> as the <code>user_id</code> is unknown as the company is created:</p>\n\n<pre><code> INSERT INTO \"companies\" (... [\"manager_id\", nil] ...\n INSERT INTO \"users\" (...\n</code></pre>\n\n<p><strong>What is the most elegant solution?</strong></p>\n\n<ol>\n<li>Saving the User and Company two times on creation and having the manager_id assigned on the second time?</li>\n<li>Using some Rails built-in trick that I am unaware of as of now</li>\n<li>Some more advanced magic</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.2","habtm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13267860,"title":"Rails 3.2 + Postgres: has_and_belongs_to_many saving even when validation fails","body":"<p>I have a Company model:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n    has_and_belongs_to_many :jobs\n    validates :name, presence: true\nend\n</code></pre>\n\n<p>And a Job model:</p>\n\n<pre><code>class Job &lt; ActiveRecord::Base\n    has_and_belongs_to_many :companies\n    validates :name, presence: true\nend\n</code></pre>\n\n<p>All works fine except for the collection.create method. According to the <a href=\"http://guides.rubyonrails.org/association_basics.html#has_and_belongs_to_many-association-reference\" rel=\"nofollow\">Rails documentation</a>:</p>\n\n<blockquote>\n  <p>The collection.create method returns a new object of the associated type. This object will be instantiated from the passed attributes, the link through the join table will be created, and, once it passes all of the validations specified on the associated model, the associated object will be saved.</p>\n</blockquote>\n\n<p>This doesn't seem to work properly for me: even when the child object is invalid (and the validation works because the invalid model doesn't get saved), the association still gets created. I created this unit test to explain how I try to do it:</p>\n\n<pre><code>test \"add invalid job to company\" do\n  company = FactoryGirl.create(:company_with_job)\n\n  # I also tried:\n  # company.jobs &lt;&lt; FactoryGirl.build(:job, name: \"\")\n  company.jobs.create({name: \"\"})\n  company.save\n  assert_equal 1, company.jobs.size\nend\n</code></pre>\n\n<p>Size is instead '2' and if I inspect company.jobs I get this:</p>\n\n<pre><code>[#&lt;Job id: 1, name: \"My Job 1\", created_at: \"2012-11-07 10:26:10\", updated_at: \"2012-11-07 10:26:10\"&gt;, \n#&lt;Job id: nil, name: \"\", created_at: nil, updated_at: nil&gt;]\n</code></pre>\n\n<p>I'm sure I'm missing something stupid, but I've been banging my head on this for a while and can't seem to understand what I'm doing wrong.</p>\n\n<p>Thanks,<br>\ng</p>\n"},{"tags":["ruby-on-rails-3","cucumber","factory-girl"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2350,"score":4,"question_id":6045651,"title":"Using Factory Girl step definitions in Cucumber features (Rails 3)","body":"<p>I'm trying to use Cucumber and Factory Girl. The following lines:</p>\n\n<pre><code>  Given I am not logged in\n  And   the following user exists:\n    | login  | email               | password   | confirmation |\n    | user50 | user50@mydomain.com | secret50   | secret 50    | \n ....\n</code></pre>\n\n<p>raises the following error:</p>\n\n<pre><code>Undefined step: \"the following user exists:\" (Cucumber::Undefined exception)\n/home/user/RubymineProjects/project/features/sign_in.feature:9:in `And the following user exists:\n\nYou can implement step definitions for undefined steps with these snippets:\nAnd /^the following user exists:$/ do |table|\n  # table is a Cucumber::Ast::Table\n  pending # express the regexp above with the code you wish you had\nend\n</code></pre>\n\n<p>'</p>\n\n<p>I've installed factory_girl_rails (even RubyMine's code completion feature works with Factory Girl step ... )</p>\n\n<pre><code>#Gemfile\ngroup :test do\n   gem \"cucumber-rails\", \"&gt;= 0.3.2\"\n   gem \"factory_girl_rails\"\n end\n\n#features/support/env.rb\nrequire 'factory_girl'\nrequire 'factory_girl/step_definitions'\n</code></pre>\n\n<p>Any ideas? Thanks</p>\n\n<hr>\n\n<p>Update: Thanks to @sj26 and @twmills  I realized that I forgot to create a :user factory with Factory Girl. Once I created it, everything worked well.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paperclip","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13266657,"title":"Rails nested_form_for not working when using file_field","body":"<p>When using <code>nested_form_for</code> and having a <code>file_field</code> in <code>fields_for</code> I get the following error from paperclip:</p>\n\n<p><strong>Paperclip::AdapterRegistry::NoHandlerError in ProjectsController#create</strong></p>\n\n<p><code>No handler found for \"scan.pdf\"</code></p>\n\n<p>This is correct, because the params don't show an <code>#&lt;ActionDispatch::Http::UploadedFile&gt;</code> object, but just the file name.</p>\n\n<p>Before using <code>nested_form_for</code> it worked, it works when I uncomment the <code>file_field</code> and it also works when I build the first object for <code>fields_for</code> but this shouldn't be necessary..</p>\n\n<p>My setup is as follows:</p>\n\n<ul>\n<li>ruby 1.9.3</li>\n<li>rails (3.2.8)</li>\n<li>paperclip (3.3.0)</li>\n<li>nested_form (0.3.0)</li>\n</ul>\n\n<p>The code:</p>\n\n<pre><code># @project.schemes.build\n= nested_form_for @project do |f|\n  = f.fields_for :schemes do |ff|\n    = ff.text_field :name\n    = ff.file_field :scan\n</code></pre>\n"},{"tags":["ruby-on-rails-3","whenever"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":121,"score":1,"question_id":8806792,"title":"Rails 3 / whenever cron not firing","body":"<p>I am using <a href=\"https://github.com/javan/whenever\" rel=\"nofollow\">whenever</a> to fire a rake task every 5 minutes for my app.</p>\n\n<p>schedule.rb:</p>\n\n<pre><code>every 5.minutes do   \nrake \"audit\",\n:environment =&gt; 'development'\nend\n</code></pre>\n\n<p>\"whenever\" in console:</p>\n\n<pre><code>0,5,10,15,20,25,30,35,40,45,50,55 * * * * /bin/bash -l -c 'cd /Users/john/Sites/rambler &amp;&amp; RAILS_ENV=development bundle exec rake audit --silent'\n</code></pre>\n\n<p>\"rake audit\" in console works properly.</p>\n\n<p>So all looks good .... except it doesn't work. Nothing happens every five minutes.</p>\n\n<p>Is this because I am trying to run it in development / local?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","passenger","phusion-passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":23,"score":0,"question_id":13265655,"title":"virtual hosting using phusion passenger","body":"<p>I wish to host two websites on same machine,both are in ruby on rails .\n<br/>I can't find where to write configuration for it and I need to host using standalone phusion passenger. I have followed <a href=\"http://www.modrails.com/documentation/Users%20guide%20Apache.html#_deploying_a_rack_based_ruby_application_including_rails_gt_3\" rel=\"nofollow\">passenger_guide</a> but still can't figure it out?</p>\n"},{"tags":["ruby-on-rails-3","template-engine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13267073,"title":"How to setup a template-engine in ruby rails","body":"<p>I want to customize rails scaffolding. For that I want to set up a custom template engine.</p>\n\n<p>Can anyone guide me to set a custom template-engine. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","facebook-graph-api","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13266883,"title":"How can i use the Facebook authentication in devise and send the iphone app the authentication token to use?","body":"<p>I use devise for authentication and i cloned an example from github which works good and now i want to use this for authenticating users from iPhone app and i have used token authentication so it returns the token for user if valid and then the subsequent requests are made with the help of the token. And the part that i am struggling with is authenticating facebook users from iphone. I have few doubts which i have listed below</p>\n\n<ol>\n<li>After sending the user id and password to facebook from iphone, what does it return? Only access token of user or some other detail along with it.</li>\n<li>As i have told earlier, i am working with devise example from <a href=\"https://github.com/plataformatec/devise_example.git\" rel=\"nofollow\">https://github.com/plataformatec/devise_example.git</a> , so how can the access token be received from iphone and check whether the user is valid by sending it to the <code>graph.facebook.com</code></li>\n<li>If after knowing that user is valid then how can i save the user in the user table so as to provide the authentication token to perform next request.</li>\n<li>When the same user enters next time how can i identify whether the user is already present in the table and send the token.</li>\n</ol>\n\n<p>I searched and i could not find any good help or may be i could not get it and this took about three days and still i am struggling. So please help me also tell me if there is any example so that i can try if there is any.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","yaml","psych"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":4610,"score":6,"question_id":5843104,"title":"Rails 3 - 'Couldn't parse Yaml'","body":"<p>I don't know what I did wrong. I try to run 'rails c,' but it just gives me an error. It was working 10 minutes ago. :\\</p>\n\n<pre><code>C:/Ruby192/lib/ruby/1.9.1/psych.rb:148:in `parse': couldn't parse YAML at line 2\n column 12 (Psych::SyntaxError)\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:148:in `parse_stream'\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:119:in `parse'\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:106:in `load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/configuration.rb:88:in `database_configuration'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/railtie.rb:58:in `block (2 levels) in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:36:in `instance_eval'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:36:in `execute_hook'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:43:in `block in run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:42:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:42:in `run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/base.rb:1904:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/railtie.rb:32:in `block in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `call'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation.rb:154:in `block in load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/railties.rb:11:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/railties.rb:11:in `all'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation.rb:154:in `load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds/console.rb:26:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds/console.rb:8:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds.rb:23:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13265427,"title":"checking the form data received in ruby on rails controller","body":"<p>I want to check the form data received from the form in ruby on rails controller.</p>\n\n<p>I tried this but nothing is shown:</p>\n\n<pre><code>@user.to_yaml\n</code></pre>\n\n<p>where <code>@user</code> is the form name(<code>&lt;%=form_for @user</code> )</p>\n"},{"tags":["ruby-on-rails-3","ubuntu-12.04","sslv2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13215779,"title":"SSLv2 error with rails 3 on ubuntu 12","body":"<p>I m using ruby 1.9.2. Whenever i run bundle install, i get the following error.</p>\n\n<pre><code>bundle install\nFetching gem metadata from https://rubygems.org/.Unfortunately, a fatal error has  occurred. Please see the Bundler \ntroubleshooting documentation at http://bit.ly/bundler-issues. Thanks! \n/home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require':    /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/i686-linux/openssl.so: undefined symbol: SSLv2_method - /home/prasad/.rvm/rubies/ruby-1.9.2- p320/lib/ruby/site_ruby/1.9.1/i686-linux/openssl.so (LoadError)\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/openssl.rb:17:in `&lt;top (required)&gt;'\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/https.rb:92:in `&lt;top (required)&gt;'\n....\n</code></pre>\n\n<p>The things i tried to solve are</p>\n\n<p>1) steps in answer at <a href=\"http://stackoverflow.com/questions/12759518/undefined-symbol-sslv2-method-when-running-bundle-install\">undefined symbol: SSLv2_method when running bundle install</a></p>\n\n<p>2) steps by bob at <a href=\"https://groups.google.com/forum/?fromgroups=#!topic/hobousers/80wBJcS0IZk\" rel=\"nofollow\">https://groups.google.com/forum/?fromgroups=#!topic/hobousers/80wBJcS0IZk</a> though the system had no <strong>x86_64-linux-gnu</strong> folder</p>\n\n<p>3) steps in this blog <a href=\"http://awolf.ru/rails-on-ubuntu-with-rvm/\" rel=\"nofollow\">http://awolf.ru/rails-on-ubuntu-with-rvm/</a></p>\n\n<p>i cant understand why one of my machine works fine(upgraded from ubuntu 11.10 to 12.04)\nwhile the other gives a problem(freshly installed ubuntu 12.04)</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>the openssl version used by rvm on the working machine is 0.9.8 while the other one has 1.0.1. Some googling resulted that the 1.0.0 and 1.0.1 doent support the SSLv2 whereas it was supported by 0.9.8.</p>\n\n<p>any fix for the above prob would be much appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","omniauth","vkontakte"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12289263,"title":"Rails omniauth and devise trouble with vk","body":"<p>I'm going to implement facebook and vkontakte login(registering) for my rails app, and with facebook all is ok (login and regitering is ok), done as in manual \n<a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">here</a></p>\n\n<p>But with vkontakte something wrong, i'll still get \"empty\" page</p>\n\n<p>here is my code:</p>\n\n<pre><code>class Users::OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n  def facebook\n    # You need to implement the method below in your model (e.g. app/models/user.rb)\n    @user = User.find_for_facebook_oauth(request.env[\"omniauth.auth\"], current_user)\n\n    if @user.persisted?\n      flash[:notice] = I18n.t \"devise.omniauth_callbacks.success\", :kind =&gt; \"Facebook\"\n      sign_in_and_redirect @user, :event =&gt; :authentication\n    else\n      session[\"devise.facebook_data\"] = request.env[\"omniauth.auth\"]\n      redirect_to new_user_registration_url\n    end\n  end\n\n  def vkontakte\n    @user = User.find_for_vkontakte_oauth(request.env[\"omniauth.auth\"], current_user)\n    if @user.persisted?\n      flash[:notice] = I18n.t \"devise.omniauth_callbacks.success\", :kind =&gt; \"Vkontakte\"\n      sign_in_and_redirect @user, :event =&gt; :authentication\n    else\n      session[\"devise.vkontakte_data\"] = request.env[\"omniauth.auth\"]\n      redirect_to new_user_registration_url\n    end\n  end\nend\n</code></pre>\n\n<p>And model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable,\n         :token_authenticatable, :lockable, :timeoutable, :omniauthable #:confirmable, \n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me, :provider, :uid, :name\ndef self.find_for_facebook_oauth(auth, signed_in_resource=nil)\n    user = User.where(:provider =&gt; auth.provider, :uid =&gt; auth.uid).first\n    unless user\n      user = User.create(name:auth.extra.raw_info.name,\n                           provider:auth.provider,\n                           uid:auth.uid,\n                           email:auth.info.email,\n                           password:Devise.friendly_token[0,20]\n                           )\n    end\n    user\n  end\n\n  def self.new_with_session(params, session)\n    super.tap do |user|\n      if data = session[\"devise.facebook_data\"] &amp;&amp; session[\"devise.facebook_data\"][\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n      if data = session[\"devise.vkontakte_data\"] &amp;&amp; session[\"devise.vkontakte_data\"][\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n    end\n  end\n\n\n\n  def self.find_for_vkontakte_oauth(auth, signed_in_resource=nil)\n    user = User.where(:provider =&gt; auth.provider, :uid =&gt; auth.uid).first\n    unless user\n      user = User.create(name:auth.info.name,\n                           provider:auth.provider,\n                           uid:auth.uid,\n                           email:auth.extra.raw_info.domain+'@vk.com',\n                           password:Devise.friendly_token[0,20]\n                           )\n    end\n    user\n  end\n</code></pre>\n\n<p>What's wrong? </p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13264337,"title":"How Do I Add Methods To ActiveRecord::Base?","body":"<p>I'm trying to create a customized ActiveRecord::Base that includes additional metadata about the connection.  I see two ways to go about this:</p>\n\n<p>1.)  Inherit from ActiveRecord::Base and add methods &amp; fields in this subclass.</p>\n\n<p>2.)  Encapsulate an ActiveRecord::Base object inside my own class</p>\n\n<p>1 has all kinds of problems with the inability to override initialize, weird problems where it doesn't seem to have custom methods I've added, etc.</p>\n\n<pre><code>undefined method `set_profile' for #&lt;Class:0xf041f0&gt;\n</code></pre>\n\n<p>2 I have not been able to figure out, due to problems with using ActiveRecord::Base.new</p>\n\n<p>I am trying to make an all-purpose ActiveRecord class that I can dynamically establish_connection &amp; set_table_name on, (i.e. not have one underlying table that this ActiveRecord::Base represents) but I can't seem to find a way to accomplish it.  Any ideas?</p>\n\n<p>This works:</p>\n\n<pre><code>  class MyTable &lt; ActiveRecord::Base\n    establish_connection $config['custom-db-config'];\n    set_table_name 'MY_TABLE'\n  end\n</code></pre>\n\n<p>but I need a class I can call these things on repeatedly.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13265178,"title":"How to find out all the \"hidden\" official Rails guides?","body":"<p>For instance, I found <a href=\"http://guides.rubyonrails.org/ajax_on_rails.html\" rel=\"nofollow\">AJAX on Rails</a> via Google, but it is not listed on the <a href=\"http://guides.rubyonrails.org/index.html\" rel=\"nofollow\">Rails Guides index page</a>.</p>\n"},{"tags":["ruby-on-rails-3","rspec","factory-girl"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":770,"score":5,"question_id":10032760,"title":"How to define an array / hash in Factory Girl?","body":"<p>I am trying to write a test that simulates some return values from Dropbox's REST service that gives me back data in an Array, with a nested hash.</p>\n\n<p>I am having trouble figuring out how to code my Factory since the return result is an array with a has inside.  What would go here?</p>\n\n<pre><code>Factory.define :dropbox_hash do\n ??\nend\n</code></pre>\n\n<p>Dropbox data looks like this:</p>\n\n<pre><code> [\"/home\", {\"revision\"=&gt;48, \"rev\"=&gt;\"30054214dc\", \"thumb_exists\"=&gt;false, \"bytes\"=&gt;0, \"modified\"=&gt;\"Thu, 29 Dec 2011 01:53:26 +0000\", \"path\"=&gt;\"/Home\", \"is_dir\"=&gt;true, \"icon\"=&gt;\"folder_app\", \"root\"=&gt;\"app_folder\", \"size\"=&gt;\"0 bytes\"}] \n</code></pre>\n\n<p>And I'd like a factory call like this in my RSpec:</p>\n\n<pre><code>Factory.create(:dropbox_hash)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","html5"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13264243,"title":"how to use Use images (html tag)in message body of net smtp in ruby on rails?","body":"<p>I m developing web application using Ruby on Rails. I want to display an image in mail using net/smtp..\nmy code is...</p>\n\n<pre><code>msgstr = &lt;&lt;END_OF_MESSAGE\nFrom: Your Name &lt;your@mail.address&gt;\nTo: Destination Address &lt;someone@example.com&gt;\nMIME-Version: 1.0\nContent-type: text/html\nSubject: test message\nDate: Sat, 23 Jun 2001 16:26:43 +0900\nMessage-Id: &lt;unique.message.id.string@example.com&gt;\n&lt;img src = \"/my_proj/public/images/logo.jpeg\" alt= \"logo\"&gt;\n&lt;b&gt;  This is a test message.&lt;/b&gt;\nEND_OF_MESSAGE\n\nrequire 'net/smtp'\nNet::SMTP.start('your.smtp.server', 25) do |smtp|\n  smtp.send_message msgstr,\n                    'your@mail.address',\n                    'his_addess@example.com'\nend\n</code></pre>\n\n<p>It is sending mail with all tags but not displaying th image while displaying alternate text. I hav put jpeg file every where n tested it.. but its not gettng the path of file and diplying the alternate text. Please anyone help me.. how to define path of file... or where to put this image file.\nI have changed</p>\n\n<pre><code>Content-type: text/html image/jpeg\n</code></pre>\n\n<p>but still its not working.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13264111,"title":"Trying to validate a date","body":"<p>I have a form where i'm trying to validate that a field called \"birthday\" is not blank, and that the date is a valid date format that the Chronic gem can parse. I always get the error message \"Birthday is invalid\". I've been trying a simple format \"10/10/2010\".</p>\n\n<p>How can i validate that the birthday field is of a format that chronic can parse?</p>\n\n<p>User.rb model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  validates :birthday, :presence =&gt; true\n  validate :birthday_is_date\n  validate :position, :presence =&gt; true\n\n  # validate the birthday format\n  def birthday_is_date\n    errors.add(:birthday ,Chronic.parse(birthday)) # testing to see the value of :birthday\n    errors.add(:birthday, \"is invalid test message\") if ((Chronic.parse(:birthday) rescue ArgumentError) == ArgumentError)\n  end\nend\n</code></pre>\n\n<p>contacts_controller.rb </p>\n\n<pre><code># POST /contacts/1/edit\n    # actually updates the users data\n    def update_user\n        @userProfile = User.find(params[:id])\n\n        respond_to do |format|\n            if @userProfile.update_attributes(params[:user])\n                format.html {\n                    flash[:success] = \"Information updated successfully\"\n                    redirect_to(profile_path)\n                }\n            else \n                format.html {\n                    flash[:error] = resource.errors.full_messages\n\n                    render :edit\n                }\n            end\n        end\n    end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","csv","fastercsv"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13264298,"title":"How to import CSV files in rails?","body":"<p>I am making an application in which it import a csv file names user.csv.But the problem i am facing is that it gives an error</p>\n\n<p>ArgumentError in CsvimportController#import</p>\n\n<p>wrong number of arguments (1 for 0)</p>\n\n<p>And the code of the CsvimportController is</p>\n\n<pre><code>require 'csv'\nclass CsvimportController &lt; ApplicationController\ndef import\n\nresults = import('anas.csv') do\nread_attributes_from_file\nend\n\n\nend\nend\n</code></pre>\n\n<p>And i have also give the specification of csv-mapper and fastercsv in gem file.</p>\n\n<p>Can anyone help me???</p>\n\n<p>Any help would be appreciated..</p>\n\n<p>Thanks </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","migration"],"answer_count":7,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":119,"score":6,"question_id":13168450,"title":"Rails creating migration to add columns to table causes error when running rake db:migrate","body":"<p>I have a model created called \"users\" and i created a new migration to add some columns to the  users table. Now when i run rake db:migrate, I get the error below b/c it's trying to create the users table again</p>\n\n<pre><code>$ rake db:migrate\n==  DeviseCreateUsers: migrating ==============================================\n-- create_table(:users)\nrake aborted!\nAn error has occurred, all later migrations canceled:\n\nMysql::Error: Table 'users' already exists: CREATE TABLE `users`.....\n</code></pre>\n\n<p>Why is it trying to create the table again?</p>\n\n<p>Here's the command i used to create the new migration</p>\n\n<pre><code>$ rails generate migration AddDetailsToUsers home_phone:decimal cell_phone:decimal work_phone:decimal birthday:date home_address:text work_address:text position:string company:string\n</code></pre>\n\n<p>The new migration looks like this:</p>\n\n<pre><code>class AddDetailsToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :home_phone, :decimal\n    add_column :users, :cell_phone, :decimal\n    add_column :users, :work_phone, :decimal\n    add_column :users, :birthday, :date\n    add_column :users, :home_address, :text\n    add_column :users, :work_address, :text\n    add_column :users, :position, :string\n    add_column :users, :company, :string\n  end\nend\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>20120511224920_devise_create_users</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table(:users) do |t|\n      ## Database authenticatable\n      t.string :email,              :null =&gt; false, :default =&gt; \"\"\n      t.string :username,           :null =&gt; false, :default =&gt; \"\"\n      t.string :encrypted_password, :null =&gt; false, :default =&gt; \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, :default =&gt; 0\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Encryptable\n      # t.string :password_salt\n\n      ## Confirmable\n      # t.string   :confirmation_token\n      # t.datetime :confirmed_at\n      # t.datetime :confirmation_sent_at\n      # t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, :default =&gt; 0 # Only if lock strategy is :failed_attempts\n      # t.string   :unlock_token # Only if unlock strategy is :email or :both\n      # t.datetime :locked_at\n\n      ## Token authenticatable\n      # t.string :authentication_token\n\n\n      t.timestamps\n    end\n\n    add_index :users, :email,                :unique =&gt; true\n    add_index :users, :reset_password_token, :unique =&gt; true\n    # add_index :users, :confirmation_token,   :unique =&gt; true\n    # add_index :users, :unlock_token,         :unique =&gt; true\n    # add_index :users, :authentication_token, :unique =&gt; true\n  end\nend\n</code></pre>\n\n<p>20120619023856_add_name_to_users</p>\n\n<pre><code>class AddNameToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :first_name, :string\n    add_column :users, :last_name, :string\n  end\nend\n</code></pre>\n\n<p>20121031174720_add_details_to_users.rb</p>\n\n<pre><code>class AddDetailsToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :home_phone, :decimal\n    add_column :users, :cell_phone, :decimal\n    add_column :users, :work_phone, :decimal\n    add_column :users, :birthday, :date\n    add_column :users, :home_address, :text\n    add_column :users, :work_address, :text\n    add_column :users, :position, :string\n    add_column :users, :company, :string\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":11334661,"title":"Why is Campaign Monitor responding with error \"310: HTML Content URL Required\" even though I have provided the URL?","body":"<p>I'm using the <a href=\"https://github.com/campaignmonitor/createsend-ruby\" rel=\"nofollow\">CreateSend API gem</a>, and in my <strong>local dev</strong> environment I am able to successfully create a draft campaign.</p>\n\n<p>In <strong>production (staging), on Heroku</strong>, the exact same code instead returns with an error:</p>\n\n<pre><code>310: HTML Content URL Required\n</code></pre>\n\n<p>I am definitely passing the HTML content URL, as well as all the other required arguments to <code>Campaign.create</code> (I've visually verified the fact by logging the variables). Here's the API call:</p>\n\n<pre><code>cm_campaign_id = CreateSend::Campaign.create client_id, subject, name, from_name, from_email, reply_to, html_url, text_url, list_ids, segment_ids\n</code></pre>\n\n<p>Furthermore, in local dev the API call returns in less than 3 seconds, whereas on Heroku it times out for 30 seconds and returns that error.</p>\n\n<p>Why is this happening on Heroku?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","nested-forms","saving"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":41,"score":-1,"question_id":13256662,"title":"ROR3: Why is this not saving?","body":"<p>This functionality used to work but has suddenly stopped and I have no idea why. I've made changes before I ran the tests but, having retraced my steps I don't know what has changed. Can a fresh pair of eyes tell me why this is saving the posts but not the locations?</p>\n\n<p><em>Model Post.rb</em></p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n attr_accessible :title, :body, :tag_list, :locations_attributes\n has_and_belongs_to_many :locations\n accepts_nested_attributes_for :locations, :reject_if =&gt; :all_blank\nend\n</code></pre>\n\n<p>*Controller Posts_controller.rb *</p>\n\n<pre><code>class PostsController &lt; ::Blogit::ApplicationController\n\n...     \n\ndef new\n  @post = current_blogger.blog_posts.new(params[:post])\n  @location = @post.locations.build\nend\n\ndef update\n  @post = current_blogger.blog_posts.find(params[:id])\n  if @post.update_attributes(params[:post])\n    redirect_to @post, notice: 'Blog post was successfully updated.'\n  else\n    render action: \"edit\"\n  end\nend\n\ndef create\n  @post = current_blogger.blog_posts.new(params[:post])\n  if @post.save\n    redirect_to @post, notice: 'Blog post was successfully created.'\n  else\n    render action: \"new\"\n  end\nend\n\nend\n</code></pre>\n\n<p>*View _form.html.erb*</p>\n\n<pre><code>&lt;%= nested_form_for(@post, :html=&gt; {:multipart =&gt; true, :class=&gt; \"new_blog_post\", :id=&gt; \"new_blog_post\"}) do |f| %&gt;\n\n ...\n\n&lt;%= field do %&gt;\n  &lt;%= f.text_field :title, placeholder: \"Give your post a title\", :class=&gt;\"span12\" %&gt;\n&lt;% end %&gt;\n&lt;%= field do %&gt;\n  &lt;%= f.text_area :body, placeholder: \"Write something here...\", :id=&gt;\"blog-text\", :class=&gt;\"span12\" %&gt;\n &lt;% end %&gt;\n\n&lt;%= field id: \"new_blog_post_tag_field\" do %&gt;\n  &lt;%= f.label :tag_list, \"Tags\" %&gt;\n  &lt;%= f.text_field :tag_list, placeholder: \"tag one, tag two, etc...\" %&gt;\n&lt;% end %&gt;\n\n&lt;%= f.label :search_locations, \"Add locations to your post\" %&gt;\n   &lt;%= render :partial =&gt; 'search_locations', :locals =&gt; { :f =&gt; f }  %&gt;\n\n &lt;p&gt;&lt;%= f.link_to_add \"Add a location\", :locations %&gt;&lt;/p&gt;\n\n&lt;%= actions do %&gt;\n&lt;%= f.submit \"Submit\", :class=&gt;\"btn\", :disable_with =&gt; 'Uploading Image...' %&gt; or \n&lt;%= link_to(\"cancel\", @post.new_record? ? root_path : post_path(@post)) %&gt;\n\n&lt;% end %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>*Form Partial _search_locations.html.erb*</p>\n\n<pre><code> &lt;%= f.fields_for :locations do |m| %&gt;\n\n\n &lt;%= m.text_field :name,:class=&gt;\"localename\", :id=&gt;\"appendedInput\", :placeholder=&gt; \"Name of the location\", :autocomplete =&gt; \"off\" %&gt;\n\n\n &lt;span class=\"add-on\"&gt;&lt;%= m.link_to_remove do %&gt;&lt;i class='icon-trash'&gt;&lt;/i&gt;&lt;/span&gt;&lt;%end%&gt;\n\n\n &lt;% end %&gt;\n</code></pre>\n\n<p>And the actual submission in the logs comes up as this:</p>\n\n<pre><code>Started PUT \"/blog/posts/51-hong-kong\" for 127.0.0.1 at 2012-11-06 17:41:00 +0000\nProcessing by Blogit::PostsController#update as HTML\nParameters: {\"utf8\"=&gt;\"✓\", \n\"authenticity_token\"=&gt;\"s+2117Qi/HzO/D/ORINhqHChMJR3S5XK7y/s3rq3dnc=\", \"post\"=&gt;{\"title\"=&gt;\"Hong \nKong \", \"body\"=&gt;\"Lorem ipsum dolor sit amet, consectetur adipiscing elit. In orci elit,  \nrhoncus quis interdum vel, interdum non nulla. Phasellus nec massa lorem. Duis malesuada   \npellentesque orci, accumsan mollis augue aliquam mollis. Pellentesque luctus orci in enim \nhendrerit adipiscing. Mauris tempor tortor in leo posuere tristique.\", \"tag_list\"=&gt;\"\", \n\"locations_attributes\"=&gt;{\"0\"=&gt;{\"_destroy\"=&gt;\"false\",    \n\"name\"=&gt;\"London\",\"longitude\"=&gt;\"-0.1276831\", \"latitude\"=&gt;\"51.5073346\"}}},\n\"_wysihtml5_mode\"=&gt;\"1\", \"name\"=&gt;\"London\", \"legname\"=&gt;\"London\", \"longitude\"=&gt;\"-0.1276831\",\n\"latitude\"=&gt;\"51.5073346\", \"commit\"=&gt;\"Submit\", \"id\"=&gt;\"51-hong-kong\"}\n</code></pre>\n\n<p>Why is this saving the post but not the locations info? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","software-engineering","sti"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13187347,"title":"Should I split this model and table?","body":"<p>I would like to create simple ResumeBank app.</p>\n\n<p><strong>Issue</strong>:</p>\n\n<p>As user I would like to add only two Resumes.\nForms for this both Resumes are different with only two fields. \nResumes have 12 the same attributes but 2 are diferent.</p>\n\n<p><strong>Question</strong>:</p>\n\n<p>Should I split that Resume model and tables to ex: PolishResume and EnglishResume, polish_remsumes and english_remsumes?</p>\n\n<p>Or maybe should I use STI and create PolishResume &lt; Resume and use one table.</p>\n\n<p>What are disadvantages of splitting option?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","associations"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13262543,"title":"Issue with association creates","body":"<p>Here are my associations...</p>\n\n<pre><code>Account has_many :credits\nCredit belongs_to :account\n</code></pre>\n\n<p>And I'm trying to run: <code>account.credits.current</code></p>\n\n<p>So, in that case, I've already got an <code>Account</code> object, and then I want to access a <code>current</code> method within the <code>Credit</code> model.</p>\n\n<p>Here is that method...</p>\n\n<pre><code>def self.current\n   # Find current credit line\n   current = self.where(:for_date =&gt; Time.now.strftime(\"%Y-%m-01\")).first\n\n   # If we couldn't find a credit line for this month, create one\n   current = Credit.create(:account_id =&gt; self.account.id, :for_date =&gt; Time.now.strftime(\"%Y-%m-01\")) if current.blank?\n\n   # Return the object\n   current\nend\n</code></pre>\n\n<p>The problem is on that second line...the one that should create a new credit entry if it can't find one. Specifically, I can't set what account it should be associated with. I just get an <code>undefined method 'account'</code> error.</p>\n"},{"tags":["ruby-on-rails-3","paypal","paypal-api","activemerchant"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13262627,"title":"ActiveMerchant Paypal Gateway/Express","body":"<p>I'm trying to integrate ActiveMerchange and PaypalExpress into my site, but I'm getting confused along the way. I've googled all over the place and watched several RailsCasts, but am still a little confused.</p>\n\n<p>In my app, I'm wanting to sell credits. The \"products\" to purchase are simply credits. They are not actual objects, nor are in the database, but are simply in a hash, for example:</p>\n\n<pre><code># 1 credit is $5, 5 credits are $25\n{\n  '1' =&gt; 5,\n  '5' =&gt; 25\n}\n</code></pre>\n\n<p>I do not want to use a Cart system like it shows in many online tutorials, I simply want the user to be able to select an amount of credits from a dropdown list, click \"Checkout with Paypal\", purchase the credits, and have it update their account.</p>\n\n<p>Can anyone guide me through this? I hope this isn't asking too much.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","asset-pipeline","sprockets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13261616,"title":"How can I access image_path route helper inside a Rails 3 model?","body":"<p>I'm trying to use Sprockets' image_path method from within a Rails 3 model. I've tried including <code>ActionView::Helpers::AssetTagHelper</code> in my model and calling image_path but that does not work (<code>undefined local variable or method 'config'</code>).</p>\n\n<p>Any ideas?</p>\n\n<p><strong>Update - this worked for me:</strong></p>\n\n<pre><code>ActionController::Base.new.view_context.asset_path(\"image.png\")\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13261884,"title":"Rails App not Recognizing Field Acceptance","body":"<p>I'm using the <a href=\"https://github.com/plataformatec/simple_form\" rel=\"nofollow\">Simple Form</a> and <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow\">Devise</a> gems in my Rails 3.2 app.  In the user registration view, I have added a check box that is for user to check for agreeing to the Terms of Use for the app.  However, now, even when it is checked, the code doesn't realize that it's checked, so it's giving the error message that this required field is not accepted. </p>\n\n<p>It may have to do with me implementing the <code>content_for</code> code in the form based on this <a href=\"http://stackoverflow.com/questions/13053863/simple-form-how-to-make-accept-terms-checkbox-inline\">question</a>.</p>\n\n<p>User model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n     :recoverable, :rememberable, :trackable, :validatable, :omniauthable\n\n  validates :agree_to_terms, :acceptance =&gt; true\nend\n</code></pre>\n\n<p>The view:</p>\n\n<pre><code>&lt;%= content_for(:the_links) do %&gt;\n  I agree to the &lt;%= link_to \"Terms of Service\", terms_path,:remote =&gt; true %&gt; \n  and &lt;%=link_to \"Privacy Policy\", privacy_path, :remote =&gt; true%&gt;\n&lt;% end %&gt;\n\n&lt;%= simple_form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n  &lt;%= f.input :agree_to_terms, :as =&gt; :boolean, :inline_label =&gt; content_for(:the_links), :label =&gt; false %&gt;\n  &lt;%= f.button :submit, \"Sign up\", :class =&gt;\"btn btn-success btn-large\" %&gt;\n&lt;% end %&gt;\n\n&lt;%= render \"devise/shared/links\" %&gt;\n</code></pre>\n\n<p>\n</p>\n"},{"tags":["mysql","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13261800,"title":"Rails and Windows 8 - \"%1 is not a valid Win32 application\" error","body":"<h2>The Goal</h2>\n\n<p><strong>I'm trying to get Rails going</strong> for the first time <strong>and connected to MySQL</strong>, all on my local machine. As far as I can tell, Rails is installed according to spec. My setup is:</p>\n\n<ul>\n<li>Ruby 1.9.3 (installed via the latest version of the RubyInstaller)</li>\n<li>Rails 3.2.8</li>\n<li>Windows 8</li>\n<li>WAMP (which has the MySQL database I'd like to connect Rails to)</li>\n</ul>\n\n<h2>The Problem</h2>\n\n<p>When I run the command <code>rails s</code>, I receive the following error:</p>\n\n<pre><code>C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in 'require': 193: %1 is not a valid Win32 application - C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/1.9/mysql2.so (LoadError)\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/\nlib/mysql2/mysql2.rb:2:in '&lt;top (required)&gt;'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/\nlib/mysql2.rb:9:in 'require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/\nlib/mysql2.rb:9:in '&lt;top (required)&gt;'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:68:in 'require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:68:in 'block (2 levels) in require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:66:in 'each'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:66:in 'block in require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:55:in 'each'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:55:in 'require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler.\nrb:128:in 'require'\n    from C:/Users/Andrew/Desktop/rails_test/simple_cms/config/application.rb\n:7:in '&lt;top (required)&gt;'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c\nommands.rb:53:in 'require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c\nommands.rb:53:in 'block in &lt;top (required)&gt;'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c\nommands.rb:50:in 'tap'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c\nommands.rb:50:in '&lt;top (required)&gt;'\n    from script/rails:6:in 'require'\n    from script/rails:6:in '&lt;main&gt;'\n</code></pre>\n\n<p>So there seems to be a problem with the <code>mysql2</code> gem? My reading has shown me that ~1-2 years ago it was a big issue, but I was of the understanding that the problems with it had been resolved at this point. (And if it is indeed better than <code>mysql</code>, then I'd like to use it!)</p>\n\n<h2>What I've Tried</h2>\n\n<ul>\n<li>I <em>was</em> getting the error \"126: the specified module could not be found\"; while looking up information regarding that, I came across the suggestion to copy \"libmysql.dll\" to Ruby's bin folder. It apparently fixed the 126 error, but now I'm getting this 193 error.</li>\n<li>Completely uninstalling Ruby, Rails, and reinstalling fresh multiple times using various different guides.</li>\n<li>Found <a href=\"http://myrailslearnings.wordpress.com/2012/07/03/error-cdevruby193librubysite_ruby1-9-1rubygemscustom_require-rb36in-require-193-1-is-not-a-valid-win32-application/\" rel=\"nofollow\">this blog post</a> where the author found that another program he had running was preventing <code>rails s</code> from working, so I closed everything and tried again. Nothing.</li>\n<li>Spent the past two days reading blogs and different posts by folks having the same issue, but it seems like <em>all</em> of them are from over a year ago, linking to (apparently successful!) fixes where the links are, unfortunately, now dead.</li>\n</ul>\n\n<p>If any further information is needed, please let me know! I've been Googling this problem for a large part of the past 48 hours to absolutely no avail. Any direction would be appreciated. :) Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13256865,"title":"How to manage multiple Subscriptions using one controller action?","body":"<p>I have following subscription creating system, right now when I`m selection available subscription groups(Marketing, Sales) action <code>Save Subscription</code> create this two subscriptions:</p>\n\n<pre><code>@apps = App.all\nif request.post?\n  if params[:subscription] and params[:subscription][:app_id]                       \n    params[:subscription][:app_id].each do |app_id|                \n      Subscription.create_unique({user_id: current_user.id, app_id: app_id, approved: true})\n    end\n    redirect_to root_path\n  end\nend\n@subscriptions = current_user.subscriptions \n</code></pre>\n\n<p>So I can only add new <code>Subscriptions</code>(in this particular example i can only add <code>Engineering</code>)</p>\n\n<p><img src=\"http://i.stack.imgur.com/5VoyD.png\" alt=\"Subscriptions\"></p>\n\n<p>How to refactor that action to be able also destroy subscription groups by uncheck them(ex. I want to unsubscribe from Marketing group) ?</p>\n\n<p>So when I choose <strong>Marketing</strong> and <strong>Enginnering</strong> then <code>params[:subscription][:app_id]</code> will be equal <code>[marketing.id, engineering.id]</code></p>\n\n<pre><code>  # app_menu.html.erb\n  &lt;%= form_for :subscription do |f| %&gt; # this form goes to app_menu action above\n    &lt;ul&gt;\n        &lt;% @apps.each do |app| %&gt;\n        &lt;li&gt;\n            &lt;%= check_box_tag app.id, current_user.access?(app) %&gt;&lt;span&gt;&lt;%= app.name %&gt;&lt;/span&gt;\n        &lt;/li&gt;\n        &lt;% end %&gt;\n    &lt;/ul&gt;\n    &lt;%= f.submit %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Relations:</p>\n\n<pre><code>App\n  has_many :subscriptions\n  has_many :users, through: :subscriptions\nUser\n  belongs_to :app\n  has_many :subscriptions, :dependent =&gt; :destroy\nSubscription\n  belongs_to :user\n  belongs_to :app\n\n  def self.create_unique(p)\n    s = Subscription.find :first, :conditions =&gt; ['user_id = ? AND app_id = ?', p[:user_id], p[:app_id]]\n    Subscription.create(p) if !s\n  end\n</code></pre>\n\n<p>Schema</p>\n\n<pre><code># == Schema Information\n#\n# Table name: subscriptions\n#\n#  admin      :boolean\n#  app_id     :integer\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  updated_at :datetime\n#  user_id    :integer\n#\n# Table name: apps\n#\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  name       :string(255)\n#  updated_at :datetime\n#  user_id    :integer\n#\n# Table name: users\n#\n#  app_id     :integer\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  updated_at :datetime\n</code></pre>\n\n<p>So the issue is how to find which apps has been unchecked? </p>\n\n<p>Then remove subscription for them and remove Feeds using <code>Feed.app_destroy_items(app)</code></p>\n"},{"tags":["ruby-on-rails-3","github","heroku"],"answer_count":2,"favorite_count":6,"up_vote_count":17,"down_vote_count":0,"view_count":1544,"score":17,"question_id":4840680,"title":"How can I specify a gem to pull from a private github repository?","body":"<p>I have a private repository on Github that I want to use. I deploy my app to Heroku. How can I specify a private repository as the source on my gemfile? I imagine it wouldn't be enough to simply say</p>\n\n<pre><code>gem \"mygem\", :git=&gt;\"my github address\" \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","table","twitter-bootstrap","selectbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13255011,"title":"Select Box Selected Item Staying After Search","body":"<p>I currently have a table sorted by several select boxes. The select boxes work correctly and sort/filter the table, but whenever the user submits the search, the page refreshes and the select box resets. I would like the selected item to stick after a search, so for example if you select Male then hit go, after the page refreshes, Male is still selected. I currently have infinite scrolling successfully implemented, and I am using rails 3 and twitter-bootstrap for my framework if that helps any. </p>\n\n<p>Here is my code:</p>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code> &lt;form class=\"form-inline\"\n        &lt;p&gt;\n         &lt;label class=\"radio\"&gt;\n          &lt;input type=\"radio\" name=\"gender_search\" value=\"M\"&gt;M\n         &lt;/label&gt;\n        &lt;label class=\"radio\"&gt;\n          &lt;input type=\"radio\" name=\"gender_search\" value=\"F\"&gt;F\n        &lt;/label&gt;\n\n        &lt;select name=\"state_search\" class=\"span2\"&gt;\n          &lt;option value=\"\"&gt;Select a State&lt;/option&gt;\n          &lt;option&gt;----------------&lt;/option&gt;\n          &lt;option&gt;LA&lt;/option&gt;\n          &lt;option&gt;MS&lt;/option&gt;\n          &lt;option&gt;TX&lt;/option&gt;\n        &lt;/select&gt;\n        &lt;select name=\"city_search\" class=\"span2\"&gt;\n          &lt;option value=\"\"&gt;Select a City&lt;/option&gt;\n          &lt;option&gt;----------------&lt;/option&gt;\n          &lt;option&gt;Mandeville&lt;/option&gt;\n          &lt;option&gt;Covington&lt;/option&gt;\n        &lt;/select&gt;\n        &lt;button type=\"submit\" class=\"btn\"&gt;GO&lt;/button&gt;\n        &lt;/p&gt;\n      &lt;/form&gt;\n      &lt;table class=\"table table-striped table-bordered span8 table-condensed\"     \n       id=\"articles_table\" &gt;\n        &lt;thead class=\"header\"&gt;\n          &lt;tr&gt;\n            &lt;th&gt;ID&lt;/th&gt;\n            &lt;th&gt;Title&lt;/th&gt;\n            &lt;th&gt;Description&lt;/th&gt;\n            &lt;th&gt;Created_At&lt;/th&gt;\n          &lt;/tr&gt;\n        &lt;/thead&gt;\n        &lt;tbody&gt;\n          &lt;%= render @articles %&gt;\n        &lt;/tbody&gt;\n</code></pre>\n\n<p><strong>_article.html.erb</strong></p>\n\n<pre><code>&lt;tr&gt;\n      &lt;td&gt; &lt;%= article_counter +1 %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Title %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Description %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Created_At %&gt; &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p><strong>articles_controller.rb</strong></p>\n\n<pre><code>def index\n@articles = Article.state_search(params[:state_search]).gender_search(params[:gender_search]).city_search(params[:city_search]).page(params[:page]).limit(50).order('NTRP DESC', 'Last_Name ASC')\n  respond_to do |format|\n    format.html # index.html.erb\n    format.json { render json: @articles }\n    format.js\n  end\nend\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3","jquery-ui"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13241709,"title":"jQuery-UI Autocomplete Widget not binding to ajax loaded partial form in Rails","body":"<p>I have a form with a text field that uses jQuery-UI autocomplete widget. \nI'm loading this form as a partial using AJAX with Ruby on Rails <code>&lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_activity_path(activity), :remote =&gt; true  %&gt;&lt;/li&gt;</code> </p>\n\n<p>Since the form is being loaded after document.ready, the autocomplete jQuery widget is not binding to the DOM element.</p>\n\n<p>Since this isn't a jQuery AJAX call, I don't think that there is a success callback that I can use to bind the autocomplete widget with after the Ajax call. </p>\n\n<p>I'm not sure how to use the .on() function that I've seen around with the autocomplete Widget since the syntax is $('selector').autocomplete</p>\n\n<p>Can someone please help?</p>\n\n<p>This is the edit.js.erb file:</p>\n\n<pre><code>$(\"#activity_form\").html(\"&lt;%= escape_javascript(render(:partial =&gt; \"form\"))%&gt;\");\n</code></pre>\n\n<p>This is my jQuery code to bind the autocomplete widget to my text field.</p>\n\n<pre><code>jQuery -&gt;       \n$('[type=\"text\"][name*=\"[geocode_location]\"]').autocomplete\n  source: (request, response) -&gt;\n    $.ajax \n      url: \"http://ws.geonames.org/searchJSON\"\n      dataType: \"jsonp\"\n      data: \n        featureClass: \"P\"\n        style: \"full\"\n        maxRows: 12\n        name_startsWith: request.term\n\n      success: (data) -&gt;\n        response $.map(data.geonames, (item) -&gt;\n          label: item.name + ((if item.adminName1 then \", \" + item.adminName1 else \"\")) + \", \" + item.countryName\n          value: item.lat + \", \" + item.lng\n        )\n  minLength: 2\n\n  open: -&gt;\n    $(this).removeClass(\"ui-corner-all\").addClass \"ui-corner-top\"\n\n  close: -&gt;\n    $(this).removeClass(\"ui-corner-top\").addClass \"ui-corner-all\"\n  focus: (event, ui) -&gt;\n    event.preventDefault()\n    $(this).val ui.item.label      \n  select: (event, ui) -&gt;\n    event.preventDefault()\n    $(this).val ui.item.label\n    $(this).siblings('[name*=\"[geocode_ll]\"]').val ui.item.value\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","console"],"answer_count":6,"favorite_count":12,"up_vote_count":23,"down_vote_count":0,"view_count":2746,"score":23,"question_id":4736546,"title":"Rails 3 OSX - Speed up Console Loading Time","body":"<p>I am wondering if there is any relatively easy way to speed up my console load time, which is starting to approach 30 seconds.  I have a lot of subclasses whose methods don't seem to be affected by <code>reload!</code> so I end up opening and closing the console a lot.  IRB loads lightning quick.  </p>\n\n<p>Do I have too many gems?  How do I go about timing the load tasks so I can see what is taking up the most time?  As you can see, I've already tried the dev-boost gem to no avail.  The app is fine in Passenger, it's just the console loading that bugs the crap out of me.  Running on MBP OSX 10.6.6 with 2.4GHz and 4GB RAM.  Not using RVM. </p>\n\n<p>Versions:</p>\n\n<pre><code>Ovid$ rails -v\nRails 3.0.3\nOvid$ ruby -v\nruby 1.9.2p136 (2010-12-25 revision 30365) [x86_64-darwin10]\n</code></pre>\n\n<p>Memory:</p>\n\n<pre><code>Ovid$ vm_stat\nMach Virtual Memory Statistics: (page size of 4096 bytes)\nPages free:                         118818.\nPages active:                       341320.\nPages inactive:                      99490.\nPages speculative:                  310576.\nPages wired down:                   112527.\n\"Translation faults\":             23097323.\nPages copy-on-write:               1270961.\nPages zero filled:                13836659.\nPages reactivated:                      36.\nPageins:                            165761.\nPageouts:                                0.\nObject cache: 28 hits of 760846 lookups (0% hit rate)\n</code></pre>\n\n<p>Gemfile:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.3'\ngem 'mysql2'\ngem 'foreigner'\ngem 'haml'\ngem 'capistrano'\ngem 'nokogiri'\n\n#web services\ngem 'yammer4r'\ngem 'ruby-freshbooks'\n\n#authentication gems from nifty generator\ngem \"bcrypt-ruby\", :require =&gt; \"bcrypt\"\ngem \"mocha\", :group =&gt; :test\ngem 'authlogic'\n\n#dev\ngroup :development do\n  gem 'rails-dev-boost', :git =&gt; 'git://github.com/thedarkone/rails-dev-boost.git', :require =&gt; 'rails_development_boost'\nend\n\n#testing\ngroup :test do\n  gem 'database_cleaner'\n  gem 'cucumber-rails'\n  gem 'cucumber'\n  gem 'rspec-rails'\n  gem 'spork'\n  gem 'launchy'\n  gem 'machinist'\n  gem 'faker'\n  gem 'capybara'\nend\n</code></pre>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations","model-associations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13256607,"title":"What is wrong with my association?","body":"<p>I am looking to setup a relationship where a user can create a post and tag that post. That post and those tags belong to that user. </p>\n\n<p>I've been trying to debug this for the last three days. I don't know why when I save my Post, the user_id does not populate in the Tag model. I added the user_id into the Tag model. </p>\n\n<p>I apologize in advance for the excessive code.</p>\n\n<p>User - has_many posts; has_many tags</p>\n\n<p>Post - belongs_to user; has_many taggings; has_many tags through taggings</p>\n\n<p>Tag - has many taggings; has_many posts through taggings; belongs_to user</p>\n\n<p>Tagging - belongs_to post; belongs_to tag</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121031012555) do\n\n  create_table \"posts\", :force =&gt; true do |t|\n    t.integer  \"user_id\"\n    t.string   \"summary\"\n    t.datetime \"created_at\",  :null =&gt; false\n    t.datetime \"updated_at\",  :null =&gt; false\n  end\n\n  create_table \"taggings\", :force =&gt; true do |t|\n    t.integer  \"post_id\"\n    t.integer  \"tag_id\"\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  add_index \"taggings\", [\"post_id\"], :name =&gt; \"index_taggings_on_post_id\"\n  add_index \"taggings\", [\"tag_id\"], :name =&gt; \"index_taggings_on_tag_id\"\n\n  create_table \"tags\", :force =&gt; true do |t|\n    t.string   \"name\"\n    t.integer  \"user_id\"\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  create_table \"users\", :force =&gt; true do |t|\n    t.string   \"username\"\n    t.string   \"email\"\n    t.string   \"crypted_password\"\n    t.string   \"password_salt\"\n    t.string   \"persistence_token\"\n    t.datetime \"created_at\",        :null =&gt; false\n    t.datetime \"updated_at\",        :null =&gt; false\n    t.string   \"role\"\n  end\n\nend\n</code></pre>\n\n<p>In the post Model:</p>\n\n<pre><code>def tag_ids=(tags_string)\n    self.taggings.destroy_all\n\n    tag_names = tags_string.split(\",\").collect{|s| s.strip.downcase}.uniq\n    tag_names.each do |tag_name|\n      tag = Tag.find_or_create_by_name(tag_name)\n      tagging = self.taggings.new\n      tagging.tag_id = tag.id\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","gem","jekyll"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13259568,"title":"Heroku push rejected, failed to complie Ruby/Rack app with Jekyll","body":"<p>I have a Jekyll website I created that I want to deploy to Heroku. However, it's not working for me. The terminal responded with</p>\n\n<pre><code>   Running: bundle install --without development:test --path vendor/bundle --binstubs  \n   bin/ --deployment\n   Could not find posix-spawn-0.3.6 in any of the sources\n\n   Failed to install gems via Bundler.\n\n   Heroku push rejected, failed to compile Ruby/rack app\n</code></pre>\n\n<p>My gemfile looks like this...</p>\n\n<pre><code>gem 'rack-jekyll', :git =&gt; 'https://github.com/adaoraul/rack-jekyll.git', :require =&gt; \n'rack/jekyll'\n</code></pre>\n\n<p>And my config.ru looks like...</p>\n\n<pre><code>require 'bundler'\nBundler.require(:default, :production)\n\nrun Rack::Jekyll.new\n</code></pre>\n\n<p>My question is, how do I fix this? I've already tried <code>bundle install</code> and <code>bundle update</code> in my project directory.</p>\n"},{"tags":["arrays","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13259571,"title":"Need save an id from a drop down list of a related tables objects","body":"<p>i have this form that saves the relation between 2 tables in my db</p>\n\n<p>Treatments <code>belongs_to :category</code></p>\n\n<p>Category <code>has_many :treatments</code></p>\n\n<p>When a treatment is created it should save the id of the category and i want the category to be a drop down list, here is my code for the form :</p>\n\n<pre><code>&lt;%= form_for(@treatment) do |f| %&gt;  \n  &lt;div class=\"field\"&gt;\n    &lt;select&gt; \n      &lt;% Category.find(:all).each do |cat| %&gt;   \n        &lt;option&gt;&lt;%= cat.name %&gt;&lt;/option&gt;  \n      &lt;% end %&gt;\n    &lt;/select&gt;\n  &lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :name %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :name %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"actions\"&gt;\n  &lt;%= f.submit %&gt;\n&lt;/div&gt;\n</code></pre>\n\n  \n\n<p>Okey so i was able to display all the categories names but im kinda lost at how i should save the <code>cat.id</code> with the form</p>\n\n<p>btw im quite new to rails if you haven't noticed :)</p>\n\n<p>any thoughts ?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>here is the html that is generated</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;label for=\"treatment_category\"&gt;Category&lt;/label&gt;\n  &lt;br&gt;\n    &lt;select id=\"category_category_id\" name=\"category[category_id]\"&gt;\n    &lt;option value=\"\"&gt;Velja flokk&lt;/option&gt;\n    &lt;option value=\"1\"&gt;Nudd&lt;/option&gt;\n    &lt;option value=\"2\"&gt;Heilun&lt;/option&gt;\n    &lt;option value=\"3\"&gt;Nálastunga&lt;/option&gt;\n  &lt;/select&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>okey noticed an error in the html changed <code>id=\"treatment_category_id\"</code> and now in my show view i see the categorie connected to the treatment but its name looks like <code>Category:0x3eb7d90</code></p>\n\n<p>here is my view, its just a basic scaffold but i added the <code>.name</code> </p>\n\n<pre><code>&lt;p&gt;\n &lt;b&gt;Category:&lt;/b&gt;\n  &lt;%= @treatment.category.name %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;b&gt;Name:&lt;/b&gt;\n  &lt;%= @treatment.name %&gt;\n&lt;/p&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms","formtastic"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13257581,"title":"Formtastic: insert preloaded text in input field","body":"<p>How can I add a preloaded costant string in a classic input field in Formtastic?</p>\n\n<p>I have searched a lot, but I haven't find how to resolve this.</p>\n\n<p>For example I have this line of code in my form:</p>\n\n<pre><code>&lt;%= f.input :url, :hint =&gt; \"Url in the form of: http//www.mysite.com\"  %&gt;\n</code></pre>\n\n<p>and in the input field I want to preload the: \"http://\", so the user must fill only the remaining of the URL. </p>\n"},{"tags":["ruby-on-rails-3","devise","cucumber"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13257059,"title":"unknown attribute username where username does exist","body":"<p>On my rails project I try to swith from email login to username login with the devise gem.\nAs far I did all the steps but when I do cucumber I see this output:</p>\n\n<pre><code>Given a user \"Aslak\" exists         \n# features/step_definitions/login_steps.rb:16\n  unknown attribute: username (ActiveRecord::UnknownAttributeError)\n  ./features/step_definitions/login_steps.rb:17:in `/^a user \"(.*?)\" exists$/'\n  features/login.feature:4:in `Given a user \"Aslak\" exists'\n</code></pre>\n\n<p>The Given a user ¨Aslak¨ exist looks like this :</p>\n\n<pre><code>Given /^a user \"(.*?)\" exists$/ do |user_name|\n  @user = User.create!(:username =&gt; user_name, :password =&gt; \"s3cr3t\")\nend\n</code></pre>\n\n<p>But when I do rails c </p>\n\n<pre><code>u = User.first \n</code></pre>\n\n<p>I see this output:</p>\n\n<pre><code>=&gt; #&lt;User id: 1, email: \"aslak@tamarawobben.nl\", encrypted_password: \"$2a$10$XjYgPtD4Ol4/sEpe934O6.yPcxs.jBF.m9SNTV.qhJp4...\", reset_password_token: nil, reset_password_sent_at: nil, remember_created_at: nil, sign_in_count: 3, current_sign_in_at: \"2012-11-05 20:27:44\", last_sign_in_at: \"2012-11-05 19:35:00\", current_sign_in_ip: \"127.0.0.1\", last_sign_in_ip: \"127.0.0.1\", created_at: \"2012-11-03 20:21:54\", updated_at: \"2012-11-06 07:58:36\", username: \"asLak\"&gt;\n</code></pre>\n\n<p>So it looks like to me that username is existing. </p>\n\n<p>Anyone a idea how to solve this ?</p>\n\n<p>Roelof</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","layout","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13257084,"title":"Categorize webpages for layout and CSS purposes in Rails","body":"<p>I have a lot of different webpages, but most fall into 1 of 6 or 7 categories of pages. For each of these categories of webpages, I have a slightly different look and feel, like different background colors/images. I have the following in <code>views/layout/application.html.erb</code>:</p>\n\n<pre><code>&lt;header class=\"sub&lt;% if content_for?(:page_type) %&gt; &lt;%= yield(:page_type) %&gt;&lt;% end %&gt;\"&gt;\n</code></pre>\n\n<p>And in every single view, I have:</p>\n\n<pre><code>&lt;% content_for :page_type, 'information' %&gt;\n</code></pre>\n\n<p>But it's really a pain to do that for every single webpage and when I want to change things around I keep having to mess with these (I have a ton of pages). So, instead I'm thinking to just use a variable:</p>\n\n<pre><code>&lt;header class=\"sub&lt;%= @page_type ? ' ' + @page_type : '' %&gt;\"&gt;\n</code></pre>\n\n<p>and for views:</p>\n\n<pre><code>&lt;% @page_type = 'information' %&gt;\n</code></pre>\n\n<p>The advantage is I could do a <code>before_filter :set_page_type</code> in the controller and set the page type once for all the views it controls (a big help).</p>\n\n<p>Maybe the best thing for me to do is just use the first folder of the URL as the category of the webpage. I'll have to restructure the URLs, but that might make sense to do so anyway. I do have some top-level pages that would have to remain so.</p>\n\n<p>This has to be a fairly common situation, what is the best way to categorize most pages and use that categorization in layouts?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","wordpress"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":58,"score":3,"question_id":13114081,"title":"Searching WordPress blog from Rails app","body":"<p>I have a site-wide custom written search controller for my Rails 3 app and would like to include results from the site's WordPress blog. What is the best way for me to perform a keyword search on posts from within my Rails app?</p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":64,"score":1,"question_id":13238878,"title":"Look for help on Ruby on Rails","body":"<p>I am new with Ruby on Rails. I just build web application on the existing database. I use rails to generate 2 scaffolds for restaurant and location tables. After that I set relationship for these two tables:</p>\n\n<pre><code> class Restaurant &lt; ActiveRecord::Base\n  attr_accessible :created, :cuisine_fk, :dish_keywords, :dish_names, :factual_id, :first_name, :last_name, :name, :status\n\n\n  has_many :locations \nend\n\nclass Location &lt; ActiveRecord::Base\n  attr_accessible :address1, :address2, :city, :created, :latitude, :longitude, :phone, :restaurant_fk, :state, :status, :url, :zip\n\n  belongs_to :restaurant\n end\n</code></pre>\n\n<p>I didn't use \"rake db:migrate\" after I set up this relationship for these tables, because I was afraid that this action would make changes the existing tables.</p>\n\n<p>When I run this command line</p>\n\n<pre><code>&lt;%= restaurant.location.address1%&gt; \n</code></pre>\n\n<p>it shows error:</p>\n\n<pre><code>undefined method `location'\n\n\" NoMethodError in Restaurants#index\n\nShowing C:/Sites/Dishclips/app/views/restaurants/index.html.erb where line #52 raised:\n\nundefined method `location' for #&lt;Restaurant:0x5853bb8&gt; \"\n</code></pre>\n\n<p>After that I tried to set foreign key for the file:</p>\n\n<pre><code>class Location &lt; ActiveRecord::Base\n  attr_accessible :address1, :address2, :city, :created, :latitude, :longitude, :phone, :restaurant_fk, :state, :status, :url, :zip\n\n  belongs_to :restaurant, :class_name =&gt; \"Restaurant\", :foreign_key =&gt; 'restaurant_fk'\n end\n</code></pre>\n\n<p>but it still doen't work. </p>\n\n<p>Is there any way that we can set foreign keys in stead of using \"rails db:migrate\" after we set up the relationships for tables ?  I appreciate your help a lot.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","seeding"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3032,"score":4,"question_id":3476987,"title":"appending to rake db:seed in rails and running it without duplicating data","body":"<p>Rake db:seed populates your db with default database values for an app right? So what if you already have a seed and you need to add to it(you add a new feature that requires the seed). In my experience, when I ran rake db:seed again, it added the existing content already so existing content became double.</p>\n\n<p>What I need is to add some seeds and when ran, it should just add the newest ones, and ignore the existing seeds. How do I go about with this? (the dirty, noob way I usually do it is to truncate my whole db then run seed again, but that's not very smart to do in production, right?)</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":11986420,"title":"RubyOnRails3 - event_calendar","body":"<p>I use event_calendar gem and it works probably for me, but I face problem of how to change color of events by type, I mean how to make for example personal events like birthday or trip colored with blue and work events like meetings colored with red etc..\nCan this be done by css or code? I hope you can help me with this -- Thanks.</p>\n"},{"tags":["ruby","ruby-on-rails-3","mailman-gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13259142,"title":"How should I test Mailman app","body":"<p>I'm trying to write some specs for my application aimed to process and resend incoming emails. It's built with Mailman App. I didn't find any good examples on how to do that. What am I actually trying is to create email (with Mail gem) and process it with Mailman. But there is only option of using stding for testing.</p>\n\n<p>So, are there any examples of specs written to test the mailman apps?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13258203,"title":"delayed_job pid file location","body":"<p>Does anyone know how to configure delayed_jobs to place the pid file in another folder?  I see the pid_dir as an option, but not sure how to include the option in an initializer or within the script/delayed_job.</p>\n"},{"tags":["ruby-on-rails-3","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13258406,"title":"Cannot find application.html.haml in a new Rails 3 app","body":"<p>I want to create Rails 3 app just to update myself, but I have strange issue.</p>\n\n<p>I have created <code>welcome#index</code> action using </p>\n\n<pre><code>rails generate controller welcome#index\n</code></pre>\n\n<p>(I have <code>haml-rails</code> gem) and I observe that a new view <code>index.html.haml</code> has been created. This action is my root_path, so in <code>localhost:3000</code> I get content of this view. </p>\n\n<p>I had <code>application.html.erb</code> which I have changed manually to <code>application.html.haml</code> and I have added <code>layout 'application'</code> in ApplicationController, but I get </p>\n\n<pre><code>Template is missing\n\nMissing template layouts/application with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee, :haml]}\n</code></pre>\n\n<p>now, any ideas why ?</p>\n\n<p>Maybe some code snippets:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  layout \"application\"\n  protect_from_forgery\nend\n</code></pre>\n\n<p>the file is in place:</p>\n\n<pre><code>mkk:~/projects/rails/gifts/app/views/layouts$ ls\napplication.html.html\n</code></pre>\n"},{"tags":["ruby-on-rails-3","routing","subdomain","localhost","thin"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13256485,"title":"Subdomain constraint (Rails 3) makes local server (thin) SO SLOW","body":"<p>I recently added a subdomain constraint to my Rails routes file</p>\n\n<pre><code>constraints(:subdomain =&gt; 'new') do\n  devise_for :customers do \n    get \"/customers/sign_up\" =&gt; \"registrations#new\"\n    post \"/customers\" =&gt; \"registrations#create\"\n    put \"/customers/:id\" =&gt; \"registrations#update\"\n  end\n  match '/' =&gt; 'roxy#index'\n  namespace :roxy, :path =&gt; '/' do\n    resources :customers\n    resources :surveys\n  end\nend \n</code></pre>\n\n<p>In order to test the subdomain routing constraint locally, I added this line to my hosts file.</p>\n\n<pre><code>127.0.0.1       new.localhost.local\n</code></pre>\n\n<p>Now, I test my app in my browser at the URL new.localhost.local:3000. It takes about 10 - 15 seconds to load every page, which is unreasonably slow. If I remove the subdomain constraint and just go to 127.0.0.1:3000, everything is zippy and fast again.</p>\n\n<p>What am I doing wrong? I'm new to Rails, so please tell me if there is a better way to do subdomain routing in rails, or if there is a setting I need to configure.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","mass-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13257596,"title":"Rails 3.2 strict mass assignment defaults","body":"<p>In a new rails project what is the reason mass assignment is not set to strict in production and the reason that it is set to strict in development and test?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email","actionmailer","multipart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13256593,"title":"How to see the multipart/alternative email in Rails?","body":"<p>When sending a multipart/alternative email, the body is empty:</p>\n\n<pre><code>m = send_mail\n=&gt; &lt;Mail::Message:70121014358060, Multipart: true, Headers: &lt;Date: Tue, 06 Nov 2012 09:18:06\n-0800&gt;, &lt;From: foo@example.com&gt;, &lt;To: bar@example.com&gt;, \n&lt;Message-ID: &lt;5099464e821ef_71113fc654c35xe065537@Air.local.mail&gt;&gt;, &lt;Subject: \nTest&gt;, &lt;Mime-Version: 1.0&gt;, &lt;Content-Type: \nmultipart/alternative; boundary=\"--==_mimepart_5099422e825b0_71113fc654c34ce068277\";\ncharset=UTF-8&gt;, &lt;Content-Transfer-Encoding: 7bit&gt;&gt;\n\nm.body\n=&gt;\n</code></pre>\n\n<p>How to inspect the body or the different parts?</p>\n\n<p>Rails 3.2.2</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","gem","database-connection"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":123,"score":1,"question_id":10352638,"title":"Rails gem uses the development db instead of the testing one when executing \"rake test\"","body":"<p>I'm using a gem with my rails 3 project, \"rails-settings-cached\", and when I'm in development mode the gem can access the database without any problem.\nHowever, when I run \"rake test\", a lot of tests fails because \"rails-settings-cached\" keeps using the development db instead of the testing one.</p>\n\n<p>The other parts of my application works fine. What should I do to connect the gem to the right database?</p>\n\n<pre><code>development:\n  adapter: mysql2\n  encoding: utf8\n  reconnect: false\n  database: mmdb_development\n  pool: 5\n  username: ***\n  password: ***\n  socket: /var/run/mysqld/mysqld.sock\n\ntest:\n  adapter: mysql2\n  encoding: utf8\n  reconnect: false\n  database: mmdb_test\n  pool: 5\n  username: ***\n  password: ***\n  socket: /var/run/mysqld/mysqld.sock\n</code></pre>\n"},{"tags":["ruby-on-rails-3","facebook","facebook-graph-api","omniauth","koala"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":1043,"score":4,"question_id":9214671,"title":"Deprecated offline_access on facebook with RoR","body":"<p>We have a problem in our RoR app. We are using a facebook authentication with omniauth, and searching the user friends with Koala. But lately, when we try to show a friend photo, we got this error:</p>\n\n<pre><code>Koala::Facebook::APIError in Homes#show\n\nShowing /home/daniel/Homes/app/views/shared/_event.html.erb where line #19 raised:\n\nOAuthException: Error validating access token: Session has expired at unix time 1328727600. The current unix time is 1328802133.\nExtracted source (around line #19):\n\n16:     &lt;img src=\"../assets/friends-icon.png\" alt=\"User  profile apicture\" height=\"33\" width=\"43\"&gt;\n17:         &lt;% if current_user %&gt;\n18:           &lt;% event.friends_in_event(@person).each do |f| %&gt;\n19:             &lt;%= link_to(image_tag(f.fb_picture, :size =&gt; \"43x33\"), person_path(f.id)) %&gt;\n20:           &lt;% end %&gt;\n21:         &lt;% end %&gt;\n22:       &lt;/div&gt;\n</code></pre>\n\n<p>The authentication works good, but facebook has already deprecated the offline_access option, that was working good, but now, we have this issue.\nis It any way to extends the access_token?, or are there another solution?.</p>\n\n<p>This is our omniauth.rb</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :facebook, ENV['FB_KEY'], ENV['FB_SECRET'], \n  { :scope =&gt; 'email,offline_access,user_photos,publish_stream',\n    :client_options =&gt; { :ssl =&gt; { :ca_path =&gt; \"/etc/ssl/certs\" } } }\nend\n</code></pre>\n\n<p>And our koala.rb</p>\n\n<pre><code>Koala.http_service.http_options = {\n  :ssl =&gt; { :ca_path =&gt; \"/etc/ssl/certs\" }\n}\n</code></pre>\n\n<p>Thanks in advance. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13256445,"title":"Devise set different root path per user type","body":"<p>I've created a devise user model. There are 2 types of user:</p>\n\n<ul>\n<li>customer</li>\n<li>admin</li>\n</ul>\n\n<p>I've accomplished bij creating two 'normal' models: customer and admin. These two models are inheriting from the user model, like so:</p>\n\n<pre><code>class Customer &lt; User\n</code></pre>\n\n<p>Does anyone know how I can setup a root path per type of user. I want something like this:</p>\n\n<pre><code>authenticated :customer do\n  root :to =&gt; \"customer/dashboard#index\"\nend\n\nauthenticated :admin do\n  root :to =&gt; \"admin/dashboard#index\"\nend    \n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I've solved the problem:</p>\n\n<pre><code>root :to =&gt; \"pages#home\", :constraints =&gt; lambda { |request|!request.env['warden'].user}\nroot :to =&gt; 'customer/dashboard#index', :constraints =&gt; lambda { |request| request.env['warden'].user.type == 'customer' }\nroot :to =&gt; 'admin/dashboard#index', :constraints =&gt; lambda { |request| request.env['warden'].user.type == 'admin' }\n</code></pre>\n"},{"tags":["ruby-on-rails","testing","ruby-on-rails-3","amazon-s3","shoulda"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1735,"score":5,"question_id":3657972,"title":"NameError: uninitialized constant Test::Unit::AssertionFailedError when upgrading to rails3","body":"<p>I'm trying to upgrade my rails application to Rails3.</p>\n\n<p>When I run functional tests, I get a lot of <code>NameError: uninitialized constant Test::Unit::AssertionFailedError</code> errors. But unit tests and website itself seems to work fine.</p>\n\n<p>Trace looks like this:</p>\n\n<pre><code>NameError: uninitialized constant Test::Unit::AssertionFailedError\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/gems/aws-s3-0.6.2/lib/aws/s3/extensions.rb:206:in `const_missing_from_s3_library'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:52:in `rescue in redirects_to_url?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:48:in `redirects_to_url?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:35:in `matches?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/assertions.rb:53:in `assert_accepts'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:324:in `block in should'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:382:in `call'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:382:in `block in create_test_from_should_hash'\n</code></pre>\n\n<p>Both Shoulda and Amazon S3 gems are latest versions.</p>\n\n<p>Any ideas what I am doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13240036,"title":"Why won't my textarea update through Ajax after entry has been re-saved to database?","body":"<p>I am updating a simple <code>text_area</code> in Rails using Ajax:</p>\n\n<p><strong>application.js</strong>:</p>\n\n<pre><code>$(\"#invoice_project_id\").change(function() {\n    var value=$(this).val();\n    $.get('/invoices/get_recipient', {project_id= : value}  function(response) {\n        $('#invoice_recipient').val(response);\n    })\n});​\n</code></pre>\n\n<p><strong>get_recipient.js</strong>:</p>\n\n<pre><code>$('#invoice_recipient').val(\"&lt;%= @recipient.to_s.gsub!(/\\n/, '\\n') %&gt;\");\n</code></pre>\n\n<p><strong>invoices_controller.rb</strong>:</p>\n\n<pre><code>def get_recipient\n  project = Project.find(params[:project_id])\n  @recipient = project.person.address\nend\n</code></pre>\n\n<p>The code works great and replaces the value of the <code>recipient</code> text_area with the correct address, depending on what <code>project</code> gets chosen in the select menu.</p>\n\n<p>The problem is that it works only with the <code>addresses</code> that already exist in the database. (I am using the <a href=\"http://faker.rubyforge.org\" rel=\"nofollow\"><strong>Rails Faker gem</strong></a> to populate my database.) The moment I <strong>re-save</strong> a <code>person</code>'s <code>address</code> manually in my Safari browser, the text_area won't get updated through Ajax anymore when I try to do so using the above code.</p>\n\n<p>How is this possible? </p>\n\n<p>I am already escaping the newline characters using the <code>gsub!</code> method above, so I can't think of anything else I could do.</p>\n\n<p>Can anybody help?</p>\n\n<p>Thanks...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","timezone"],"answer_count":3,"favorite_count":12,"up_vote_count":16,"down_vote_count":0,"view_count":13507,"score":16,"question_id":4362663,"title":"Timezone with rails 3","body":"<p>I have pretty common issue but for some reason i have tried all the suggestions on the web and none seem to work. </p>\n\n<p>I have set the Timezone in config to 'EST'</p>\n\n<pre><code>config.time_zone = 'Eastern Time (US &amp; Canada)'\n</code></pre>\n\n<p>But when the time is shown on the the screen, it continues to show the UTC time that is stored in the DB. I tried the debugger and here is the output</p>\n\n<pre><code>(rdb:1) Time.zone \n#&lt;ActiveSupport::TimeZone:0x1061f4760 @utc_offset=nil, @current_period=nil, @name=\"Eastern Time (US &amp; Canada)\", @tzinfo=#&lt;TZInfo::TimezoneProxy: America/New_York&gt;&gt;\n(rdb:1) Order.first.placed_at\nFri Jan 01 15:00:00 UTC 2010\n</code></pre>\n\n<p>Update: \nHere is another user who has the same question\n<a href=\"http://stackoverflow.com/questions/3203304/rails-timezone-is-wrong-when-shown\">Rails timezone is wrong when shown</a></p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13223146,"title":"Why is response.body is a string instance when testing controller with rspec","body":"<p>In the rspec test for my controller the response's body is always a string representation of an ActiveDispatch::Response instance.</p>\n\n<pre><code>=&gt; #&lt;ActionController::TestResponse:0x00000007863010\n ...\n @body=[\"#&lt;ActionDispatch::Response:0x00000007530d70&gt;\"],...\n</code></pre>\n\n<p>The controller spec  in question:</p>\n\n<pre><code>it 'should not allow invalid email' do\n     json = { :format =&gt; 'json', :patron_profile =&gt; { :email =&gt;   'bogusemail.com', :password =&gt; 'password' } }\n     post :create, json\n     response.status.should eq(302)\n     response.body.to_json.should be_json_eql(%({ 'error' : 'error message'}))\nend\n</code></pre>\n\n<p>What could cause the <code>response.body</code> to be the ActionDispatch string shown above?</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","rubygems","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":470,"score":0,"question_id":9310287,"title":"rails 3.1 Engines Gemspec and config initializers","body":"<p>I am developing an rails 3.1 mountable engine. Build the engine very well and mounted it on a sub-domain. Now what i am having issue is that, in my <code>engine</code> <code>Gemfile</code> i specified a gem:</p>\n\n<pre><code>gem \"show_for\", \"~&gt; 0.2.4\"\n</code></pre>\n\n<p>also in <code>.gemspec</code> file </p>\n\n<pre><code>s.add_dependency \"show_for\", \"~&gt; 0.2.4\"\n</code></pre>\n\n<p>then i used engine's <code>script/rails g show_for:install</code> and it created a <code>initializer file</code> in config/initilizers directory.</p>\n\n<p>When i go to <code>main_app</code> and run <code>bundle install</code> it shows that gem in the list. But when i start the application it show the error:</p>\n\n<pre><code>path_to_my_engine/config/initializers/show_for.rb:2:in `&lt;top (required)&gt;': uninitialized constant ShowFor (NameError)\n</code></pre>\n\n<p>How can we resolve this issue?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-masonry","turbolinks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13256649,"title":"turbolinks with masonry is not working","body":"<p>I have installed turbolink gem <a href=\"https://github.com/rails/turbolinks\" rel=\"nofollow\">https://github.com/rails/turbolinks</a> in my rails app 3.2.8.</p>\n\n<p>I use this gem, masonry for show elements <a href=\"https://github.com/desandro/masonry\" rel=\"nofollow\">https://github.com/desandro/masonry</a>.</p>\n\n<p>The problem is that masonry elements when I open a new page with turbolinks are not loaded correctly.</p>\n\n<p>How can I fix this problem?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["jquery","ruby-on-rails-3","layout","heroku","jplayer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13253026,"title":"jPlayer working with Rails app locally, but not when deployed to Heroku","body":"<p>I have the jPlayer audio player working fine locally, but when I deploy to Heroku, it no longer works and I get the following error in Chrome's console:</p>\n\n<pre><code>Uncaught TypeError: Object [object Object] has no method 'jPlayer' \n</code></pre>\n\n<p>Here's the Javascript for jPlayer in my application.html.erb layout:</p>\n\n<pre><code>  &lt;script type=\"text/javascript\"&gt;\n  $(document).ready(function(){\n    $(\"#jquery_jplayer_1\").jPlayer({\n      ready: function () {\n        $(this).jPlayer(\"setMedia\", {\n             mp3: \"http://test.com/song.mp3\",\n          // m4a: \"http://www.jplayer.org/audio/m4a/Miaow-07-Bubble.m4a\",\n          // oga: \"http://www.jplayer.org/audio/ogg/Miaow-07-Bubble.ogg\"\n        });\n      },\n      swfPath: \"/javascriptipts\",\n      supplied: \"mp3, m4a, oga\"\n    });\n  });\n</code></pre>\n\n<p></p>\n\n<p>I'm noticing that the way the scripts are included seems to be working differently than it is on Heroku. For my local instance (which works) the scripts included look like this in the source:</p>\n\n<pre><code>   &lt;link href=\"/assets/application.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/bootstrap-responsive.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/bootstrap.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/calls.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jplayer.blue.monday.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/main.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n   &lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-alert.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-button.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-carousel.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-collapse.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-dropdown.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-modal.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-popover.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-scrollspy.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-tab.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-tooltip.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-transition.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-typeahead.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap.min.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/calls.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/custom.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/google-code-prettify/prettify.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery-ui.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery.jplayer.min.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/application.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>On Heroku, where jPlayer is not working, the scripts loaded look like this in the source for some reason:</p>\n\n<pre><code>&lt;link href=\"/assets/application-7d9d2071282c290d4dd4bb767188d15f.css\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;script src=\"/assets/application-679ead39cc620e8b5be4723def8305ce.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Here's how I include them in my application.html.erb layout:</p>\n\n<pre><code>&lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>Anyone have any thoughts what might be causing this and how I can fix it?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":97,"score":2,"question_id":12875743,"title":"Heroku installing sqlite3 even though it is not a dependecy","body":"<p>I am trying to deploy my app to Heroku, but it keeps getting rejected with the following output.</p>\n\n<pre><code>waitup$git push staging master\nCounting objects: 4184, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (1033/1033), done.\nWriting objects: 100% (4184/4184), 1.11 MiB | 494 KiB/s, done.\nTotal 4184 (delta 3069), reused 4184 (delta 3069)\n\n-----&gt; Heroku receiving push\n-----&gt; Ruby/Rails app detected\n-----&gt; Installing dependencies using Bundler version 1.2.1\n       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment\n       Fetching gem metadata from http://rubygems.org/.......\n       Fetching https://github.com/stripe/stripe-ruby\n       Installing rake (0.8.7)\n       Installing abstract (1.0.0)\n       Installing activesupport (3.0.4)\n       Installing builder (2.1.2)\n       Installing i18n (0.5.0)\n       Installing activemodel (3.0.4)\n       Installing erubis (2.6.6)\n       Installing rack (1.2.2)\n       Installing rack-mount (0.6.14)\n       Installing rack-test (0.5.7)\n       Installing tzinfo (0.3.27)\n       Installing actionpack (3.0.4)\n       Installing mime-types (1.16)\n       Installing polyglot (0.3.1)\n       Installing treetop (1.4.9)\n       Installing mail (2.2.19)\n       Installing actionmailer (3.0.4)\n       Installing bcrypt-ruby (2.1.4) with native extensions\n       Installing orm_adapter (0.0.5)\n       Installing warden (1.0.4)\n       Installing devise (1.3.4)\n       Installing formtastic (1.2.3)\n       Installing has_scope (0.5.0)\n       Installing responders (0.6.4)\n       Installing inherited_resources (1.2.2)\n       Installing will_paginate (3.0.pre2)\n       Installing inherited_views (0.0.2)\n       Installing arel (2.0.9)\n       Installing activerecord (3.0.4)\n       Installing meta_search (1.0.5)\n       Installing activeresource (3.0.4)\n       Using bundler (1.2.1)\n       Installing thor (0.14.6)\n       Installing railties (3.0.4)\n       Installing rails (3.0.4)\n       Installing sass (3.1.2)\n       Installing activeadmin (0.2.2)\n       Installing addressable (2.2.6)\n       Installing authlogic (2.1.6)\n       Installing celerity (0.8.8)\n       Installing culerity (0.2.15)\n       Installing nokogiri (1.4.4) with native extensions\n       Installing ffi (0.6.3) with native extensions\n       Installing childprocess (0.1.7)\n       Installing json_pure (1.5.1)\n       Installing rubyzip (0.9.4)\n       Installing selenium-webdriver (0.1.3)\n       Installing xpath (0.1.3)\n       Installing capybara (0.4.1.2)\n       Installing configuration (1.2.0)\n       Installing cookiejar (0.3.0)\n       Installing diff-lcs (1.1.2)\n       Installing json (1.5.1) with native extensions\n       Installing gherkin (2.3.7) with native extensions\n       Installing term-ansicolor (1.0.5)\n       Installing cucumber (0.10.2)\n       Installing cucumber-rails (0.3.1)\n       Installing daemons (1.1.6)\n       Installing database_cleaner (0.6.4)\n       Installing hiredis (0.3.2) with native extensions\n       Installing em-hiredis (0.1.0)\n       Installing escape_utils (0.2.4) with native extensions\n       Installing eventmachine (0.12.10) with native extensions\n       Installing em-http-request (0.3.0) with native extensions\n       Installing thin (1.3.1) with native extensions\n       Installing faye (0.7.1)\n       Installing launchy (0.4.0)\n       Installing rest-client (1.6.3)\n       Installing heroku (2.2.8)\n       Installing jquery-rails (1.0.7)\n       Installing jwt (0.1.3)\n       Installing multi_json (1.0.3)\n       Installing mysql2 (0.2.7) with native extensions\n       Installing rspec-core (2.5.1)\n       Installing rspec-expectations (2.5.0)\n       Installing rspec-mocks (2.5.0)\n       Installing rspec (2.5.0)\n       Installing rspec-rails (2.5.0)\n       Installing seed-fu (2.0.1)\n       Installing sequel (3.20.0)\n       Installing sinatra (1.0)\n       Installing spork (0.8.4) with native extensions\n       Installing sqlite3 (1.3.4) with native extensions\n       Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n       /usr/local/bin/ruby extconf.rb\n       checking for sqlite3.h... no\n       sqlite3.h is missing. Try 'port install sqlite3 +universal'\n       or 'yum install sqlite3-devel' and check your shared library search path (the\n       location where your sqlite3 shared library is located).\n       *** extconf.rb failed ***\n       Could not create Makefile due to some reason, probably lack of\n       necessary libraries and/or headers.  Check the mkmf.log file for more\n       details.  You may need configuration options.\n       Provided configuration options:\n       --with-opt-dir\n       --without-opt-dir\n       --with-opt-include\n       --without-opt-include=${opt-dir}/include\n       --with-opt-lib\n       --without-opt-lib=${opt-dir}/lib\n       --with-make-prog\n       --without-make-prog\n       --srcdir=.\n       --curdir\n       --ruby=/usr/local/bin/ruby\n       --with-sqlite3-dir\n       --without-sqlite3-dir\n       --with-sqlite3-include\n       --without-sqlite3-include=${sqlite3-dir}/include\n       --with-sqlite3-lib\n       --without-sqlite3-lib=${sqlite3-dir}/lib\n       --enable-local\n       --disable-local\n       Gem files will remain installed in /tmp/build_qlnbqtp08z3t/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.4 for inspection.\n       Results logged to /tmp/build_qlnbqtp08z3t/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.4/ext/sqlite3/gem_make.out\n       An error occurred while installing sqlite3 (1.3.4), and Bundler cannot continue.\n       Make sure that `gem install sqlite3 -v '1.3.4'` succeeds before bundling.\n !\n !     Failed to install gems via Bundler.\n !     \n !     Detected sqlite3 gem which is not supported on Heroku.\n !     http://devcenter.heroku.com/articles/how-do-i-use-sqlite3-for-development\n !\n !     Heroku push rejected, failed to compile Ruby/rails app\n\nTo git@heroku.com:waiterd2-staging.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'git@heroku.com:waiterd2-staging.git'\n</code></pre>\n\n<p>Clearly, the sqlite3 gem is the issue here. The weird part is that it's not included as a dependency in my Gemfile or Gemfile.lock.</p>\n\n<p>My gemfile looks like this:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.1.0'\n\ngem 'pg'\ngem 'thin'\ngem 'authlogic', '3.1.3'\ngem 'twilio-ruby'\ngem 'heroku'\ngem 'activeadmin', :git =&gt; 'https://github.com/gregbell/active_admin.git'\ngem 'stripe', :git =&gt; 'https://github.com/stripe/stripe-ruby'\ngem 'faye'\n\ngroup :assets do\n    gem 'less'\n    gem 'bourbon'\n    gem 'therubyracer'\n    gem 'sass-rails'\n    gem 'coffee-rails'\n    gem 'uglifier'\nend\n</code></pre>\n\n<p>A few things stand out here. The authlogic gem installed by Heroku is not the one specified in the Gemfile. The only reason I'm suspecting the authlogic gem is because it lists sqlite3 as a development dependency. This shouldn't matter though.</p>\n\n<p>When I run the exact command listed in the Heroku output on my local machine, the sqlite3 gem is not installed.</p>\n\n<p>I've tried many suggestions that I found on StackOverflow and elsewhere such as removing the Gemfile.lock file and running bundler again. None of these have worked. Heroku still installs the wrong version of authlogic and attempts to install sqlite3.</p>\n\n<p>How do I get Heroku to stop trying to install the sqlite3 gem?</p>\n\n<p>Your help is much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":10800111,"title":"rails selectbox_tag onchange()","body":"<p>Say we have a select box: <br />\n/app/views/tape/_form.html.erb <br />\n<code>&lt;%= f.select :tape, Tape::LIST_TAPES %&gt;</code><br /></p>\n\n<p>and a <em>.js.coffee</em> file that i would like to trigger when some value is selected in selectbox:<br />\n/app/assets/javascripts/tapes.js.coffee<br /></p>\n\n<pre><code>function selectBoxValue(value){\n  # value -- selected in selectbox;\n  console.log(\"box_value = \", value);\n}\n</code></pre>\n\n<p>How can it be done in RoR 3.2?<br />\n<a href=\"http://jsfiddle.net/7q2s9/7/\" rel=\"nofollow\">Here's</a> what i mean within html+js.</p>\n\n<p><strong>P.S.</strong><br />\nI'm new to Rails. Sorry for my English and thank you.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13254433,"title":"How do I set a catch-remaining default route to a directory?","body":"<p>Perhaps simply due to lack of good keywords, I wasnt able to find any useful solution for a problem that should be almost trivial…</p>\n\n<p>In my <em>routes.rb</em>, how do I tell: \"If no other route matches <strong>request</strong>, then deliver /foo/bar/<strong>request</strong>\"?</p>\n\n<p>(Note: <strong>request</strong> ≠ '/')</p>\n\n<p>To be more specific:</p>\n\n<p>If <em>http://example.com/somedir/test/1/2/3</em> is not matched, try <em>/for/bar/somedir/test/1/2/3</em>, just if that does not exist, deliver *APP_DIR/public/404.html*.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec-rails","gmaps4rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13255284,"title":"Stubbing Gmaps4rails with geocoding.rb","body":"<p>I've reviewed a few of the Gmaps4rails stubbing questions and think I'm very close, but not quite there.  Forgive me: Very new to stubbing and mocking in rails.</p>\n\n<p>All of this code works in the real world, just trying to get it to skip geocoding during testing.  Right now tests <em>sometimes</em> work and <em>sometimes</em> fail with the <strong>Gmaps4rails address Address invalid</strong> error</p>\n\n<p>So, I have a very simple party.rb model that acts_as_gmappable:</p>\n\n<pre><code>def gmaps4rails_address\n   \"#{self.city}, #{self.country}\" \nend \n</code></pre>\n\n<p>I've pasted geocoding.rb from github and placed it in /spec/support unmodified</p>\n\n<p>However, I can't seem to tell my parties_controller_spec to use the stub instead of the real one.  I'm sure I'm missing something simple...  I've tried:</p>\n\n<pre><code>include Geocoding\n</code></pre>\n\n<p>and even</p>\n\n<pre><code>Gmaps4rails.set_gmaps4rails_options!({:msg =&gt; \"quack\"})\n</code></pre>\n\n<p>and I don't see \"quack\" as the error message, I see <strong>Validation failed: Gmaps4rails address Address invalid</strong></p>\n\n<p>Also tried:</p>\n\n<pre><code>Gmaps4rails.set_gmaps4rails_options!({:validation =&gt; false, :check_process =&gt; false, :process_geocoding =&gt; false})\n</code></pre>\n\n<p>But to no effect.</p>\n\n<p>My factories.rb has a straightforward :party define:</p>\n\n<pre><code>Factory.define :party do |party|\nparty.name      \"Thai New Year\"\nparty.city      \"Phuket\"\nparty.country   \"Thailand\"\n...\nend\n</code></pre>\n\n<p>So, I'm pretty sure I haven't properly told rspec to use the stubbed Gmaps4rails.  So, where exactly do I put the code that tells Gmaps4rails to use your stub_geocoding method instead of actually trying to perform geocoding?</p>\n\n<p>Any help would be appreciated... Sorry if this is a mundane question.</p>\n\n<p>Dave</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13255242,"title":"How to clean rails console output when using pry-rails?","body":"<p>I have in my Gemfile pry-rails gem. I would like to use pry as rails console but without that text below.</p>\n\n<p>How to clean my rails console output, now I receive a lot of unnecessary text:</p>\n\n<pre><code>&gt;&gt; Subscription.where(user_id: User.last.id)\n  User Load (1.8ms)  SELECT \"users\".* FROM \"users\" ORDER BY \"users\".\"id\" DESC LIMIT 1\n#&lt;ActiveRecord::Relation:0x7f7f9ad69c70\n  @implicit_readonly = nil,\n  @join_dependency = nil,\n  @order_clause = nil,\n  @records = [],\n  @should_eager_load = nil,\n  attr_accessor :bind_values = [],\n  attr_accessor :create_with_value = {},\n ...\n</code></pre>\n\n<p><a href=\"https://gist.github.com/4025796\" rel=\"nofollow\">https://gist.github.com/4025796</a></p>\n"},{"tags":["ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13254639,"title":"Filtering a Model's associated collections based on a User's CanCan abilities","body":"<p>Users belong to an organization. Users can view all organizations, but can only view users within their organization. When a user views the organization, I have to add filter logic to the view, so <code>@organizations.users</code> becomes <code>@organizations.users.select{|u| can?(:read, u)}</code>.</p>\n\n<p>Is there a way to manage this more transparently or elegantly? Is there a way to get rid of <code>select{|u| can?(:read, u)}</code> or move it to a DRY place?</p>\n\n<p><strong>Relevant code:</strong></p>\n\n<pre><code>class Organization &lt; ActiveRecord::Base\n  has_many :users\n  ...\nend\n\nclass Ability\n  ...\n  can :read, User, :organization =&gt; @user.organization\nend\n</code></pre>\n\n<p>organizations/show.html.erb: (current, sucky version)</p>\n\n<pre><code>&lt;% if @organization.users.select{|u| can?(:read, u)}.any? %&gt;\n  &lt;h4&gt;Contacts&lt;/h4&gt;\n  &lt;ul class=\"unstyled\"&gt;\n    &lt;% for user in @organization.users.select{|u| can?(:read, u)} %&gt;\n      &lt;li&gt;\n        &lt;%= link_to user, user, class: \"user\" %&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want something closer to this view instead:</p>\n\n<p>organizations/show.html.erb:</p>\n\n<pre><code>&lt;% if @organization.users.any? %&gt;\n  &lt;h4&gt;Contacts&lt;/h4&gt;\n  &lt;ul class=\"unstyled\"&gt;\n    &lt;% for user in @organization.users %&gt;\n      &lt;li&gt;\n        &lt;%= link_to user, user, class: \"user\" %&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>I'm avoiding <code>accessible_by</code> because I have an ability definition that uses a block.</p>\n\n<pre><code>class Ability\n  ...\n  can :read, User, :organization =&gt; @user.organization\n  can :read, User do |user|\n    user.is? :technical_contact\n  end\nend\n</code></pre>\n\n<p>I know that <code>accessible_by</code> can work with blocks, but only if a SQL fragment is provided. Since my users have many roles and are stored as a bitmask, I don't have a SQL fragment.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13254837,"title":"Access items from a nested has_many relationship","body":"<p>I have 3 models: User, School, and Applicant.</p>\n\n<p>A user <code>has_many :schools</code>, a school <code>has_many :applicants</code> and <code>belongs_to :user</code>, and an applicant <code>belongs_to :school</code>. </p>\n\n<p>I'd like to be able to list applicants that belong to any school that belongs to a particular user. I thought I should be able to do it with </p>\n\n<pre><code>current_user.schools.applicants.paginate(page: params[:page])\n</code></pre>\n\n<p>That is not working as it is giving this error:</p>\n\n<pre><code>undefined method `applicants' for #&lt;ActiveRecord::Relation:0x007fb9da274110&gt;\n</code></pre>\n\n<p>How can I access these applicants?</p>\n"},{"tags":["ruby-on-rails-3","actionmailer","email-headers","rfc5322"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":621,"score":3,"question_id":6598343,"title":"Set the Message-ID mail header in Rails3 / ActionMailer","body":"<p>I would like to alter the <code>Message-ID</code> header that is in the header portion of an email sent from a Ruby on Rails v3 application using ActionMailer.</p>\n\n<p>I am using Sendmail on localhost for mail delivery.</p>\n\n<p>Do I configure this in Sendmail or ActionMailer?</p>\n\n<p>Where do I configure this (if it is ActionMailer):  a file in <code>config/</code> folder or a file in app/mailers/ folder?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","html5","contenteditable"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13254460,"title":"make next contenteditable element editable","body":"<p>I have a following structure </p>\n\n<pre><code>&lt;div&gt;\n&lt;ul id='t1'&gt;\n  &lt;li id='l1' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n  &lt;li id='l2' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n  &lt;li id='l3' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>What I want here is when the user edits say li l3 and when he hits enter I want to add new li with contenteditable = true and setfocus on the new li so that user can start typing there. \nI was able to add a new entry on enter by but couldn't set focus on it.</p>\n\n<p><strong>Update</strong></p>\n\n<pre><code> if(e.keyCode == 13){//enter Key or tab key 9\n    e.preventDefault();\n    var taskId = this.id;\n    jQuery.ajax({\n        url : 'update_current',\n        type : 'put',\n        success : function(resp){ //resp is the new li tag\n          var li =  this_is_current_elemtn;\n          jQuery(li).append(resp);\n\n          //$('#t1 .editable').each(function(){\n            // $(this).attr('editable', 'false');\n          //});\n          console.log(jQuery(li).next());\n\n           jQuery(li).next().focus();\n         // $('#t1 .editable').each(function(){\n         //    $(this).attr('contentEditable', 'true');\n         // });\n        }\n    });\n</code></pre>\n\n<p>any help is appreciated</p>\n"},{"tags":["ruby-on-rails-3","week-number"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13253564,"title":"Get calendar week numbers in requested month in RoR","body":"<p>I've been searching for hours now and I just can't find the right answer.<br>\nHope you can help me out.  </p>\n\n<p>Ruby:    <code>1.9.3p194</code><br>\nRails:    <code>3.2.8</code></p>\n\n<h3>Goal:</h3>\n\n<pre><code>1.9.3p194 :001 &gt; get_weeknumbers_in_month 1, 2012\n=&gt; [1, 2, 3, 4]\n1.9.3p194 :002 &gt; get_weeknumbers_in_month 2, 2012\n=&gt; [5, 6, 7, 8]\n1.9.3p194 :003 &gt; get_weeknumbers_in_month 3, 2012\n=&gt; [9, 10, 11, 12, 13]\n1.9.3p194 :004 &gt; get_weeknumbers_in_month 4, 2012\n=&gt; [14, 15, 16, 17]\n</code></pre>\n\n<p>So, I actually want an array of calendar week numbers when the method <code>get_weeknumbers_in_month</code> is called.</p>\n\n<p><br></p>\n\n<h3>Research:</h3>\n\n<p>To get the month numbers from a date:</p>\n\n<pre><code>DateTime.parse(\"2012-01-10\").month\n=&gt; 1\n</code></pre>\n\n<p><br><br>\nTo get the number of days in a month:</p>\n\n<pre><code>Time::days_in_month(1, 2012)\n=&gt; 31\n</code></pre>\n\n<p><br><br>\nTo get the calendar week number of a date:</p>\n\n<pre><code>DateTime.parse(\"2012-04-12\").strftime(\"%W\").to_i\n=&gt; 15\n</code></pre>\n\n<p><br><br>\nCan someone please help me with this issue?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13251487,"title":"How to change Devise authentication attribute","body":"<p>Hey guys im using this Devise model : <a href=\"https://github.com/plataformatec/devise/wiki/How-To%3a-Require-admin-to-activate-account-before-sign_in\" rel=\"nofollow\">https://github.com/plataformatec/devise/wiki/How-To%3a-Require-admin-to-activate-account-before-sign_in</a></p>\n\n<p>do anyone know where i can change it so that Devise uses my <code>is_approved</code> instead of the default <code>approved</code> ?</p>\n\n<p>for some reason i cant use the default <code>approved</code> since sqlite wont update the bool attribute more info about that here : <a href=\"http://stackoverflow.com/questions/13211811/rails-3-and-sqlite-communications-concerning-boolians/13213314#comment18016617_13213314\">Rails 3 and SQLite communications concerning boolians</a></p>\n\n<p>After i have approved a user on my website Device gives an error \"user not approved\" but i cant find in my app where i can change this ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13248758,"title":"Unable to gracefully shutdown unicorn server with QUIT","body":"<p>We're doing zero downtime deploys for our Rails app using unicorn and the usual <a href=\"http://ariejan.net/2011/09/14/lighting-fast-zero-downtime-deployments-with-git-capistrano-nginx-and-unicorn\" rel=\"nofollow\">zero downtime deploy setup.</a> (we don't use the exact setup from the example, but the thing is similiar).</p>\n\n<p>This used to work, but during our upgrade to Rails 3.2 we ran into a weird problem:</p>\n\n<ul>\n<li>Old unicorn master gets <code>USR2</code></li>\n<li>New master is spawned</li>\n<li>However, the old master does <strong>never</strong> terminate and does seem to react to <code>QUIT</code> at all. </li>\n<li>The old master will still react to <code>WINCH</code> and shut down all workers, and it can be shut down with <code>TERM</code> - but graceful shutdown just doesn't work</li>\n</ul>\n\n<p>We do attempt to close the database connection from the master processes, but are not completely if it does still hold Redis connections (and if that would cause a problem).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid","mongohq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":726,"score":1,"question_id":10801977,"title":"MongoDB won't connect to MongoHQ using Mongoid","body":"<p>I've just started a brand new rails project and the first task I'm trying to complete is creating an object and having it save within my database.  I went through the automated way of generating an object, in this case a URL object as follows:</p>\n\n<pre><code>rails generate scaffold Url domain:string\n</code></pre>\n\n<p>I've also tested out two separate mongoid.yml configuration settings.  The first is as follows:</p>\n\n<pre><code>development:\n  sessions:\n    default:\n      # Defines the name of the default database that Mongoid can connect to.\n      # (required).\n      uri: mongodb://[username]:[password]@flame.mongohq.com:27046/[database]\n\n      options:\n        consistency: :strong \n</code></pre>\n\n<p>The result of this configuration is that when a query takes place, I get the following error:</p>\n\n<pre><code>The operation: #&lt;Moped::Protocol::Query\n  @length=39\n  @request_id=5\n  @response_to=0\n  @op_code=2004\n  @flags=[]\n  @full_collection_name=\".urls\"\n  @skip=0\n  @limit=0\n  @selector={}\n  @fields=nil&gt;\n failed with error 13075: \"db name can't be empty\"\n</code></pre>\n\n<p>I also tested with the following configuration:</p>\n\n<pre><code>development:\n  uri: mongodb://[username]:[password]@flame.mongohq.com:27046/[database]\n</code></pre>\n\n<p>When the code gets to the create method of the urls_controller it fails at @url.save with the following error:</p>\n\n<pre><code>mongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:100:in `parse'\nmongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:61:in `create_session'\nmongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:43:in `default'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:109:in `default'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:354:in `__session__'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:199:in `mongo_session'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:157:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:25:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations.rb:26:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations/insert.rb:27:in `block in persist'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:25:in `block (2 levels) in  prepare'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:403:in `_run__2492706777632263523__create__3276423133299307975__callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_create_callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/callbacks.rb:95:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:24:in `block in prepare'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:403:in  `_run__2492706777632263523__save__3276423133299307975__callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_save_callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/callbacks.rb:95:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:23:in `prepare'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations/insert.rb:26:in `persist'\nmongoid (3.0.0.rc) lib/mongoid/persistence.rb:49:in `insert'\nmongoid (3.0.0.rc) lib/mongoid/persistence.rb:188:in `upsert'\napp/controllers/urls_controller.rb:46:in `block in create'\n</code></pre>\n\n<p>My assumption is that my mongoid.yml file is incorrect but I'm not sure how to get this to work.  Any thoughts?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13253893,"title":"Form not submitting to custom action","body":"<p>I'm still relatively new to Rails and have looked through many similar questions here, but none helped me thus far. So... I have a form that I'd like to send a simple email. It pops up in a Bootstrap modal and looks like:</p>\n\n<pre><code>.form-horizontal\n  = form_tag :url =&gt; { :action =&gt; :share_event }, remote: true, html: {\"data-type\" =&gt; :json} do\n    .control-group\n      = label_tag :to\n      = text_field_tag :to\n    .control-group\n      = label_tag :from\n      = text_field_tag :from\n    .control-group\n      = label_tag :subject\n      = text_field_tag :subject  \n    - hidden_field_tag :event_url, :value =&gt; url\n    .actions\n      = submit_tag 'share event', :class =&gt; \"btn btn-mini submit\"\n</code></pre>\n\n<p>and in my controller:</p>\n\n<pre><code>def share_event\n  @to = params[:to]\n  @from = params[:from]\n  @subject = params[:subject]\n  @url = params[:url]\n  respond_to do |format|\n    EventMailer.share_event(@to, @from, @subject, @url).deliver\n    redirect_to events_path, notice: 'Event sent'\n  end \nend\n\n  EventMailer.share_event(@to, @from, @subject, @url).deliver\nend\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :events do\n  post :share_event, :on =&gt; :collection\nend\n</code></pre>\n\n<p>The problem is when I submit it uses the 'create' action as opposed to 'share_event'. I've tried many approaches, but it keeps on using 'create'. Here are an extract from the logs:</p>\n\n<pre><code>Started POST \"/events?html%5Bdata-type%5D=json&amp;remote=true&amp;url=share_events_path\" for 41.134.48.225 at 2012-11-06 15:34:25 +0100\nProcessing by EventsController#create as HTML\nParameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"7/6pg9XX/N09qUB+SUlWOdpCsgPOAiXM+nC+mq6VtKE=\", \"to\"=&gt;\"to@example.com\", \"from\"=&gt;\"from@example.com\", \"subject\"=&gt;\"gfh\", \"event_url\"=&gt;\"{:value=&gt;\\\"http://events.example.com/events/3\\\"}\", \"commit\"=&gt;\"share event »\", \"html\"=&gt;{\"data-type\"=&gt;\"json\"}, \"remote\"=&gt;\"true\", \"url\"=&gt;\"share_events_path\"}\n</code></pre>\n\n<p>Any help/advice would be appreciated.</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13251196,"title":"Clarification of When to use Controllers","body":"<p>Im new to rails and want to understand controllers better (especially when linked with models)</p>\n\n<p>My example is I have Recipe controller and model and then a favourite controller and model. Within the recipe controller I have New, create, update, destroy etc, so that obviously I can perform those actions on a recipe.</p>\n\n<p>Now i want to flag recipes as favourites, so again I can create a new favourite and delete a favourite. So is it best practice to put my  requests for the favourite model in the favourite controller. Not in the same controller as recipe. the reason I ask this is because i have favourite and recipe associated with belongs_to.</p>\n\n<p>Also within my app I want to view favourite recipes within the my_recipes page  (this is in the recipe controller), does it matter that my create/delete methods are in another controller for favourites?</p>\n\n<p>I hope this makes some sense to someone, looking for some clarification really</p>\n"},{"tags":["ruby-on-rails-3","routing","constraints"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":18,"score":-2,"question_id":13252049,"title":"rails routing with constraints","body":"<p>Supposed that we have a CRUD model Movie with attributes: title: string, release_year: string, language: string. In movies controller, there are 3 actions: search, retrieve and filter. <br/><br/>I want a path “/movies/retrieve/:action” to go to the above 3 actions. Conditions is as below:</p>\n\n<ul>\n<li><p>With get method, and action is “search”, or “find”, go to search\naction</p></li>\n<li><p>With get method, and action is “retrieve”, go to retrieve action. And\nretrieve action should be able to find a unique movie based on\nrelease_year and title</p></li>\n<li><p>With post method, and action is “filter”, “check”, “restrict”, go to\nfilter action.</p></li>\n</ul>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13240109,"title":"implement \"Add to favorites\" in rails 3","body":"<p>I am building an app where users can create recipes, see all recipes created, view their own recipes in a member area and finally i would like for users to add \"favorites\" to their account.</p>\n\n<p>I am new to rails but have read through docs and this is my understanding of what it should look like in the back end. Could someone confirm that this looks correct or advise of any errors please, with explanations if i have done something wrong (Which is probably the case)</p>\n\n<p>So this is my code</p>\n\n<p>User Model</p>\n\n<pre><code>has_many :recipes\nhas_many_favorites, :through =&gt; :recipes\n</code></pre>\n\n<p>Recipe Model</p>\n\n<pre><code>belongs_to :user\nhas_many :ingredients #created seperate db for ingredients\nhas_many :prepererations #created seperate db for prep steps\n</code></pre>\n\n<p>Favorite Model</p>\n\n<pre><code>belongs_to :user\nhas_many :recipes, :through =&gt; :user\n#this model has one column for the FK, :user_id\n</code></pre>\n\n<p>Favorites Controller</p>\n\n<pre><code>def create\n@favrecipes =current_user.favorites.create(params[:user_id])\nend\n</code></pre>\n\n<p>I then wanted to have a button to post to the db so have this</p>\n\n<pre><code>&lt;%= button_to(\"Add to Favorites\" :action =&gt; \"create\", :controller =&gt; \"favorites\" %&gt;\n</code></pre>\n\n<p>I think I am probably missing something in my routes but am unsure</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13242315,"title":"Rails remote forms validation","body":"<p>Just a simple question I have followed the railscast -> <a href=\"http://railscasts.com/episodes/136-jquery-ajax-revised\" rel=\"nofollow\">http://railscasts.com/episodes/136-jquery-ajax-revised</a></p>\n\n<p>Its nice how for remote true works, but how I cna validate the model ? </p>\n\n<p>I have this one</p>\n\n<pre><code>&lt;%= form_for [:admin,@course], remote: true  do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title, \"The title:\" %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :description, \"Descripcion:\" %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :description %&gt;\n &lt;/div&gt;\n &lt;div class=\"actions\"&gt;\n   &lt;%= f.submit \"Send\"%&gt;\n &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How I handle te error ??</p>\n\n<pre><code>def create\n\n  @course = Course.new(params[:course])\n\n  respond_to do |format|\n    if @course.save\n      format.html { redirect_to admin_index_url, :notice=&gt; 'Done !!' }\n      format.js\n    else\n      format.html { flash.now[:alert] = \"Not done\" \n                    render \"new\"\n                  }\n      format.js\n    end\n  end        \nend\n</code></pre>\n\n<p>any ideas why this dont works ??</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","scopes"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13251468,"title":"rails 3 scopes inherited from other models","body":"<p>is there any way to use one model scopes as part of another model scope?</p>\n\n<p>Example</p>\n\n<pre><code>class DocumentVersion &lt; ActiveRecord::Base\n  belongs_to :document\n  scope :are_latest, lambda{ where(latest: true)}\nend\n\nclass Document &lt; ActiveRecord::Base\n  has_many :document_versions\n  scope :are_latest, lambda { ...something... } # I want something that will get documents that have documnet_versions that are_latest\n\n  # I know I can do this \n  scope :are_latest,   lambda{ joins(:document_versions).where('document_versions.latest = true') }  # this works well\n\n  # but I would like to keep that condition its own model\n  scope :are_latest, lambda { joins(:document_versions).are_latest } # this wont obviously work, but something like that \n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13251054,"title":"How do I include the user objects n the json result?","body":"<pre><code>@song.likes.select('likes.*, users.*').includes(:user).to_json \n</code></pre>\n\n<p>Only converts the like objects. Is there a way to include the user objects in the json result? Via Ruby or other.</p>\n"},{"tags":["ruby-on-rails-3","rspec","integration-testing","capybara"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":351,"score":4,"question_id":7940525,"title":"Testing focus with Capybara","body":"<p>I have a simple <code>link_to_function</code> in my view template</p>\n\n<pre><code>&lt;%= link_to_function \"add new category\", \"$('#category_name').focus()\" %&gt;\n</code></pre>\n\n<p>and I want to test this with capybara using request specs. Basically the spec should look something like this</p>\n\n<pre><code>it \"focuses category form when I click 'add new category'\" do\n  visit new_article_path\n  click_link \"add new category\"\n\n  # unfortunately there's nothing like 'has_focus?'\n  find_field(\"category_name\").should have_focus  \nend\n</code></pre>\n\n<p>the problem is, <strong>I wasn't able to find anything, that would check if the element has focus.</strong> \nThe only thing I did find was this</p>\n\n<pre><code>page.evaluate_script('document.focus')[:id]\n</code></pre>\n\n<p>which however isn't supported by the <code>capybara-wekbit</code> driver, which I'm using to avoid opening browser for each test run.</p>\n"},{"tags":["ruby-on-rails-3","sqlite3","boolean","windows-7-x64"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13211811,"title":"Rails 3 and SQLite communications concerning boolians","body":"<p>im using Rails 3.2.8 and SQLite 1.3.6</p>\n\n<p>and im running into troubles changing boolian variables in the database</p>\n\n<p>SQLite translates \"t\" and \"f\" as true and false</p>\n\n<p>this function wont update the <code>:approved</code> attribute (that is default false)</p>\n\n<pre><code>def activate\n  @user = User.find(params[:id])\n\n  if @user.update_attribute(:approved, 't')\n\n    redirect_to \"/\" #this is the return i get so the update returns true\n\n  else\n   render \"/users?approved=false\"\n  end \nend\n</code></pre>\n\n<p>But changing strings like <code>@user.update_attribute(:email,'root@email.org')</code> will update the email</p>\n\n<p>how can i fix this do i need some kind of an sqlite adapter ?</p>\n\n<p>i already installed <code>activerecord-jdbcsqlite3-adapter</code> and it messed up my app because i was too hasty and didnt notice that it was deprecated :P</p>\n\n<p>i found this thread : <a href=\"http://stackoverflow.com/questions/6013121/rails-3-sqlite3-boolean-false\">Rails 3 SQLite3 Boolean false</a>\nbut i dont understand what i need to do in order to make Rails and SQLite communicate correctly as im a newbie in rails :)</p>\n\n<p>also i think its worth mentioning that im running this on windows 7 x64</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Apparently Rails does indeed know how to communicate with Sqlite, but the i have no idea why my code dosnt work for boolians lol</p>\n\n<p>in my view i have :</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt; \n&lt;tr&gt; \n  &lt;td&gt;&lt;%= user.id %&gt;&lt;/td&gt; \n  &lt;td&gt;&lt;%= user.email %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= user.approved? %&gt;&lt;/td&gt;\n  &lt;td&gt;\n&lt;% if !user.approved? %&gt;\n  &lt;%= link_to 'Approve', active_user_path(user), :method =&gt; :put %&gt; \n    &lt;% end %&gt; &lt;/td&gt; \n&lt;/tr&gt; \n&lt;% end %&gt; \n</code></pre>\n\n<p>This lists all the unapproved users and a link to activate them (set the bool to true)</p>\n\n<p>and in my controller i have </p>\n\n<pre><code>    def activate\n      @user = User.find(params[:id])\n\n    if @user.update_attribute(:approved, true)\n\n      redirect_to \"/\" #this is the return i get so the update returns true\n\n    else\n      render \"/users?approved=false\" #this is not rendered\n    end \n  end\n</code></pre>\n\n<p>and my route</p>\n\n<pre><code>match \"users/:id/activate\" =&gt; \"users#activate\", :as =&gt; \"active_user\"\n</code></pre>\n\n<p>This works for other strings like the user name, address etc but not the bool's </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","has-and-belongs-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13174104,"title":"Split a string and save with has_and_belongs_to_many association","body":"<p>I have a text_field which the user can type in Tags(Like the ones on stackoverflow). They can seperate the tags with a comma. Now, I know how to split the tags. But the n00b that I am I'm stuck at the next stage. I have a Tag table, a Trip table and a tags_trips in between(A trip can have multiple keywords, but I want the keywords unique in my database so when they exist they can be used again on other Trips).</p>\n\n<p>The real question is; After I've split the string, how can I check if the keyword exists and get the existing ID to be placed in my tags_trips table, and if it doesn't exist how do i get the array I've just split in my tags_trips table in one go?</p>\n\n<p>Here's an overview of my tables: </p>\n\n<pre><code>Trip\n:id =&gt; :integer,\n:title =&gt; :string,\n:description =&gt; :text,\n:user_id =&gt; :integer,\n:created_at =&gt; :datetime,\n:updated_at =&gt; :datetime\n\nTag\n:id =&gt; :integer,\n:title =&gt; :string,\n:created_at =&gt; :datetime,\n:updated_at =&gt; :datetime\n\ntags_trip\n:tag_id =&gt; :integer,\n:trip_id =&gt; :string\n</code></pre>\n\n<p>I'm using a <code>has_and_belongs_to_many</code> association between Tag and Trip in my models and get the text_field via <code>fields_for :tags</code> in my Trip form. (Note: The form works and I've managed to get the keywords string, as it is typed, into my Tag table! Just not split up ;-))</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","logging","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13250665,"title":"how make log rotation rails 3.2.8 version","body":"<p>How can I make log rotation on my production env for rails version 3.2.8?</p>\n\n<p>I have taking a look to <a href=\"http://stackoverflow.com/questions/4883891/ruby-on-rails-production-log-rotation\">Ruby on Rails production log rotation</a>, but is for old rails version.</p>\n\n<p>I use nginx + unicorn</p>\n\n<p>Where can I find more info about this?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","declarative-authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13250518,"title":"declarative_authorization for field-level control","body":"<p>I want to restrict ability to change the <code>roles</code> field in the <code>user</code> model to a certain role. Of course I could use scoped mass assignment but is it actually possible to use <strong>declarative_authorization</strong> for securing individual fields?</p>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","rest","html-form"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13250502,"title":"Paste html form data into url","body":"<p>Assuming i have resource with 2 methods :show and :index. I need :index contain simple form with text field and submit button, when user insert data into text field, this data must be  inserted into url as :id of resource for :show method.</p>\n\n<p>for example page url looks like <code>/s</code> and when user type 123 into field in the form and press submit he must be redirected to <code>/s/123</code>. Can it be done with rails or html forms ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13250014,"title":"set up default routes to common dir","body":"<p>Assume you have a couple of ruby/rails apps running on a server</p>\n\n<p>APP ExmplA:\ndir: /foo/bar/ExmplA\nruns on <a href=\"http://example.com:4111/\" rel=\"nofollow\">http://example.com:4111/</a></p>\n\n<p>APP ExmplB:\ndir: /foo/bar/ExmplB\nruns on <a href=\"http://example.com:4112/\" rel=\"nofollow\">http://example.com:4112/</a></p>\n\n<p>APP ExmplC:\ndir: /foo/bar/ExmplC\nruns on <a href=\"http://example.com:4113/\" rel=\"nofollow\">http://example.com:4113/</a></p>\n\n<p>now i have a common dir\n/pool/common/http/\nwhere i want the default root-routes (\"/\") of the 3 apps to point to.</p>\n\n<p>…so \"http://example.com:4113/somedir/something.txt\" should map to \"/pool/common/http/somedir/something.txt\", if not specified otherwise.</p>\n\n<p>What should I enter in the routes.rb of the 3 Apps?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":5,"up_vote_count":4,"down_vote_count":0,"view_count":2663,"score":4,"question_id":3801324,"title":"Rails 3 - time_ago_in_words says \"ABOUT 2 hours ago\"","body":"<p>Code:</p>\n\n<pre><code>&lt;%=\"#{time_ago_in_words(comment.created_at)} ago \"%&gt;\n</code></pre>\n\n<p>What i'd like is for it not to have \"ABOUT\" in front of the 2 hours ago, which shows up for hours but not for minutes...</p>\n\n<p>Is there another function or a way to remove it without finding and replacing?</p>\n"},{"tags":["ruby-on-rails-3","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":31,"score":-3,"question_id":13222735,"title":"why does this cucumber code fails","body":"<p>I have this code : <a href=\"https://github.com/roelof1967/tamara\" rel=\"nofollow\">https://github.com/roelof1967/tamara</a>\nBut when I do cucumber it fails with this error message : <a href=\"https://gist.github.com/4008123\" rel=\"nofollow\">https://gist.github.com/4008123</a></p>\n\n<p>Can anyone explain to me what's wrong with my code?</p>\n\n<p>Roelof</p>\n\n<p>Edit 1:\nCode that fails:</p>\n\n<pre><code>class Output  \ndef messages    \n   @messages ||= []  \nend    \ndef puts(message)    \n    messages &lt;&lt; message  \nend    \ndef output    \n   @output ||= Output.new  \nend\nend\n\nWhen /^he logs in$/ do   \n   visit(\"/users/sign_in\")  \n   fill_in('Email', :with =&gt; @user.email)  \n   fill_in('Password', :with =&gt; @user.password)  \n   click_button('Sign in')\nend\n\nThen /^he should see \"(.*?)\"$/ do |message|  \n  @output.messages.should include (message)\nend\n</code></pre>\n\n<p>And here is the error message :</p>\n\n<pre><code>undefined method `[]' for nil:NilClass NoMethodError)      \n./features/step_definitions/login_steps.rb:6:in `/^he logs in$/'          \nfeatures/login.feature:5:in `When he logs in'\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13249132,"title":"How to maintain the \"updated_at\" variable in rails application?","body":"<p>I am  making an application in which there is only model that is Project and in the view of the project i can see the table with the variables that generate automatically i.e created\n_at and updated_at.\nI want to keep track the updated_at variable means that if user updates the project 10 times it will show the updated_at variable 10 times so that i can track the project model.</p>\n"},{"tags":["ruby-on-rails-3","prestashop","activeresource"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13176487,"title":"Non rails style format of XML response how to parse with ActiveResource correctly?","body":"<p>Using Rails and ActiveResource i am getting non-rails style of XML response form third-party API. Object which i like to map is basically wrapped in prestahop element. What should i override to get rid of that element to map the object correctly?</p>\n\n<pre><code>&lt;prestashop xmlns:xlink=\"http://www.w3.org/1999/xlink\"&gt;\n&lt;order&gt;\n    &lt;id&gt;&lt;/id&gt; \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13088959,"title":"Why am I getting a 'Factory not registered' error?","body":"<p>I have a model Answer:  </p>\n\n<pre><code>class Answer &lt; ActiveRecord::Base\n  attr_accessible :content\n\n  belongs_to :question\nend\n</code></pre>\n\n<p>In my Question model, i have defined <code>has_many :answers</code>. My Answer model have three column: content (text), question_id (integer), correct(boolean). Default value of <code>correct</code> column is <code>false</code>.</p>\n\n<p>I created factories to create Answer object:</p>\n\n<pre><code>factory :answer do\n  content \"Content of an answer\"\n  question\n\n  factory :accept_answer do\n    correct true\n  end\nend\n</code></pre>\n\n<p>In my rspec file, i created new answer object successfully with below code:  </p>\n\n<pre><code>let(:answer) { FactoryGirl.create(:answer, question: question) }\n\nsubject { answer }\nits(:correct) { should be_false }\n</code></pre>\n\n<p>But when i used below code to create accept_answer object: </p>\n\n<pre><code>describe \"an accepted answer\" do\n  let(:accept_answer) { FactoryGirl.create(:accept_answer, question: question) } \n  it { accept_answer.correct.should be_true }\nend\n</code></pre>\n\n<p>It has error</p>\n\n<pre><code>Failure/Error: let(:accept_answer) { FactoryGirl.create(:accept_answer, question: question) }\nArgumentError:\n   Factory not registered: accept_answer\n</code></pre>\n\n<p>I don't know what wrong with my code :(</p>\n"},{"tags":["android","ruby-on-rails-3","android-c2dm","android-gcm"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":322,"score":0,"question_id":12091737,"title":"Android Google Cloud Messaging gem for Ruby on Rails 3","body":"<p>Is there a new gem for ruby on rails for GCM earlier known as C2DM.</p>\n\n<p>If not then, should we continue to use the old gem for C2DM like one here on <a href=\"https://github.com/pimeys/c2dm_on_rails\" rel=\"nofollow\">github</a></p>\n\n<p>Thanks in Advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","csv","import"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13247149,"title":"Can't mass-assign protected attributes when import data from csv file","body":"<p>I have a form for import data like this:</p>\n\n<pre><code>&lt;%= form_tag({ controller: 'courses', action: :import }, multipart: true) do %&gt; \n  &lt;%= label_tag 'file', 'Import data' %&gt;\n  &lt;%= file_field_tag 'file' %&gt;\n  &lt;%= submit_tag \"Import\", name: nil, class: 'btn' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is my import action:</p>\n\n<pre><code>def import\n  require 'csv'\n\n  csv_text = File.read(params[:file].tempfile.to_path.to_s)\n  csv = CSV.parse(csv_text, headers: true )\n  csv.each do |row|\n    row = row.to_hash.with_indifferent_access\n    Course.create(row.to_hash.symbolize_keys)\n  end\n  flash[:success] = \"Successfully import data.\"\n  redirect_to courses_url\nend\n</code></pre>\n\n<p>But when i choose a file and press button <code>Import</code> in browser, i got error:</p>\n\n<pre><code>ActiveModel::MassAssignmentSecurity::Error in CoursesController#import\nCan't mass-assign protected attributes: Name, Code\n</code></pre>\n\n<p>In my <code>Course</code> model, <code>name</code> and <code>code</code> already are attr_accessible:</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n  attr_accessible :code, :name\nend\n</code></pre>\n\n<p>What's wrong with my code?</p>\n\n<p><strong>Updated</strong><br>\nThis is my csv file:</p>\n\n<pre><code>name, code\nERP System, HT555DV01\nData Mining, HT459DV01\n</code></pre>\n\n<p><strong>New code to create data</strong></p>\n\n<pre><code>csv.each do |row|\n  Course.create!(name: row[0], code: row[1])\nend\n</code></pre>\n"},{"tags":["sql-server","ruby-on-rails-3","freetds"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2612,"score":4,"question_id":6973371,"title":"FreeTDS problem connecting to SQL Server on Mac (Unexpected EOF from the server)","body":"<p>I have setup FreeTDS to connect to SQL Server database.  When I try to open TSQL in terminal on Mac (lion) I get this error:</p>\n\n<pre><code>locale is \"en_US.UTF-8\"\nlocale charset is \"UTF-8\"\nusing default charset \"UTF-8\"\nError 20017 (severity 9):\n    Unexpected EOF from the server\n    OS error 36, \"Operation now in progress\"\nError 20002 (severity 9):\n    Adaptive Server connection failed\nThere was a problem connecting to the server\n</code></pre>\n\n<p>Does anybody have a clue what could be causing this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","browser","soundmanager2"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":10,"score":3,"question_id":13248069,"title":"Soundmanager-rails won't play sound with flash","body":"<p>I am using soundmanager-rails gem in my rails app. I use it to stream radio from stream. While HTML5 audio works fine with mp3, flash won't play a sound. I've tried Firefox, Safari and Chrome and in every browser sound doesn't work via flash. Console log looks fine:</p>\n\n<pre><code>-- SoundManager 2: HTML5 support tests (/^(probably|maybe)$/i): mp3: true (preferring flash), mp4: true (preferring flash), ogg: false (and no flash support), wav: true --\n-- SoundManager 2 V2.97a.20120916 (AS2/Flash 8) + HTML5 audio, normal polling --\nsoundManager::createMovie(): Trying to load /assets/swf/soundmanager2_debug.swf\nsoundManager::initMovie(): Waiting for ExternalInterface call from Flash...\nsoundManager::externalInterfaceOK() (~0 ms)\nsoundManager::init()\nsoundManager: Attempting JS to Flash call...\n(Flash): SM2 SWF V2.97a.20120916 (AS2/Flash 8)\n(Flash): JS to/from Flash OK\nFlash security sandbox type: remote\n(Flash): Enabling polling, 50 ms interval\n-- SoundManager 2 loaded (OK) --\nsoundManager: Firing 1 onready() item\n</code></pre>\n\n<p>Rails server serves swf files fine:</p>\n\n<pre><code>Started GET \"/assets/swf/soundmanager2_debug.swf\" for 127.0.0.1 at 2012-11-06 13:17:01 +0400\nServed asset /swf/soundmanager2_debug.swf - 200 OK (3ms)\n</code></pre>\n\n<p>Soundmanager demos on it's web site work alright in every browser.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13247799,"title":"Does ActiveRecord cache table_name?","body":"<p>I've got an <code>ActiveRecord</code> class that needs to look at two different tables depending on a configuration switch, so I'm planning to do the following:</p>\n\n<pre><code>def table_name\n  config_is_on? ? :table1 : :table2  \nend\n</code></pre>\n\n<p>I'm wondering whether the <code>table_name</code> method is always called when queries are run against this model: the application is <strong>not</strong> going to be restarted when the configuration changes, so this value cannot be cached.</p>\n\n<p>Does <code>ActiveRecord</code> always evaluate the <code>table_name</code> or just once during application startup / initialization? If it's cached how do I force it to evaluate <code>table_name</code> every time?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","caching","rabl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13192550,"title":"Fragment caching in a rabl view?","body":"<p>I read <a href=\"https://github.com/nesquena/rabl/wiki/Caching-in-RABL\" rel=\"nofollow\">rabl caching doc</a> and I don't get how I can cache fragment of code.\nI have a view like this (there more code, but I removed it for simplicity's sake):</p>\n\n<pre><code>object @video\n\nattributes :id, :user_id, :event_id\n\nchild :event do\n  attributes :id\n  node(:name) { |event| event.name }\nend\n\nchild :user do\n  attributes :id\nend\n</code></pre>\n\n<p>And I want to cache :event child for two hours. How can I do that?</p>\n\n<p>I'm using rabl(0.7.6), rails(3.2.0), ruby(1.9.3p125)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":5,"favorite_count":11,"up_vote_count":22,"down_vote_count":0,"view_count":10952,"score":22,"question_id":3873190,"title":"f.error_messages in Rails 3.0","body":"<p>Rails 3.0 deprecated <code>f.error_messages</code> and now requires a plugin to work correctly - I however want to learn how to display error messages the (new) native way. I am following the <a href=\"http://edgeguides.rubyonrails.org/getting_started.html\" rel=\"nofollow\">getting started guide</a>, which uses the deprecated method when implementing the comments form. For example:</p>\n\n<pre><code>&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for([@post, @post.comments.build]) do |f| %&gt;\n  &lt;%= f.error_messages %&gt;\n&lt;div class=\"field\"&gt;\n  &lt;% f.label :commenter  %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :commenter  %&gt;\n&lt;/div&gt;\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :body %&gt;&lt;br /&gt;\n  &lt;%= f.text_area :body %&gt;\n&lt;/div&gt;\n&lt;div class=\"actions\"&gt;\n  &lt;%= f.submit %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the correct way to do it (as generated by the scaffold):</p>\n\n<pre><code>&lt;%= form_for(@post) do |f| %&gt;\n  &lt;% if @post.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@post.errors.count, \"error\") %&gt; prohibited this post from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @post.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n . . . \n</code></pre>\n\n<p>I understand that I use the <code>@post</code> variable in the latter example, but what variable do I reference in the former to get the error messages for comment creation?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13245311,"title":"RoR duplication fields","body":"<p>When an incorrect mandatory fields, the page reloads and you receive an incorrect entry fields and all fields in the form company_form duplicated.</p>\n\n<p>User model(user.rb):</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  ....\n  has_many :companies, :autosave =&gt; true\n  accepts_nested_attributes_for :companies\n  has_and_belongs_to_many :roles\n  def role?(role_name)\n    return !!self.roles.find_by_name(role_name)\n  end\n  def with_company\n    self.companies.build\n    self\n  end\nend\n</code></pre>\n\n<p>Company model:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  ...\n  belongs_to :user\n  ...\nend\n</code></pre>\n\n<p>views/devise/registration/new.html.haml:</p>\n\n<pre><code>= form_for(resource.with_company, :as =&gt; resource_name, :url =&gt; registration_path(resource_name), :html =&gt; { :class =&gt; 'form-horizontal'}) do |f|\n...\n  = f.fields_for :companies do |company_form|\n  ...\n...\n</code></pre>\n"},{"tags":["ruby-on-rails-3","api","usps","fedex-shipping"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":161,"score":1,"question_id":8373901,"title":"Integrating usps api on rails application","body":"<p>I want to integrate <a href=\"https://www.usps.com/\" rel=\"nofollow\">https://www.usps.com/</a> and also fedex api on my rails application, but I could not understand their documentation. Is there anybody who can help me? Or can any one provide me an easy tutorial of how it should be integrate on web ? I want to calculate the cost of package or gifts of the users on many condition. </p>\n\n<p>Please note: there is a gem for this sevice but it is too old and the application I am going to build it is on rails 3.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13245289,"title":"Writing test cases(Rspec) for existing application","body":"<p>Being Rspec noob, i dont know this question make sense. BUt i am really confused and couldnt get solution for this.</p>\n\n<blockquote>\n  <p>We have one new requirement, asked us to write Rspec test cases for existing project. They have application with rails3 that already working but they want rspec cases to be written now</p>\n</blockquote>\n\n<p>My question is</p>\n\n<blockquote>\n  <p>Writing Rspec cases for existing application does make sense?</p>\n  \n  <p>Can we write spec for already working project</p>\n  \n  <p>Should we follow any guidelines to write specs for already written app</p>\n</blockquote>\n\n<p>Thank you </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13243229,"title":"Why is fields_for creating 2 identical records instead of just 1 upon form submit?","body":"<p>When I submit this form, it is creating 2 identical records in the Members table (the fields_for part of the form).  Please help me understand why that is happening.   </p>\n\n<p>The basic setup is: a Comp has many Teams and a Team has many Members.  When creating a new Team, the first Member created should be the team's secretary (which means the secretary_flag field in the Members table should be set to TRUE.)  This form below is supposed to create a new Team, create the first team member, and mark that team member as the secretary.       </p>\n\n<p>The controller: </p>\n\n<pre><code>def new\n  @comp = Comp.find(params[:comp_id])    \n  @team = @comp.teams.new\n  @team.members.build  \nend\n\ndef create\n  @comp = Comp.find(params[:comp_id])\n  @team = @comp.teams.create(params[:team])\nend\n</code></pre>\n\n<p>The form view:</p>\n\n<pre><code>&lt;%= form_for [@comp,@team] do |builder| %&gt;\n    &lt;%= builder.label :team_name, \"Team name\" %&gt;\n    &lt;%= builder.text_field :team_name %&gt;        \n    &lt;%= builder.fields_for :members do |f| %&gt;\n        &lt;%= f.label :member_email, \"Email address of team secretary\" %&gt;\n        &lt;%= f.text_field :member_email %&gt; \n        &lt;%= f.hidden_field :secretary_flag, :value =&gt; 1 %&gt;\n    &lt;% end %&gt;\n\n&lt;%= builder.submit \"Create new team\" %&gt; \n\n&lt;% end %&gt; \n</code></pre>\n\n<p>And in my routes: </p>\n\n<pre><code>resources :comps do\n    resources :teams do \n        resources :members\n    end \nend\n</code></pre>\n\n<p>And in my models: </p>\n\n<p>comp.rb: </p>\n\n<pre><code>attr_accessible :teams_attributes\nhas_many :teams, :dependent =&gt; :destroy\naccepts_nested_attributes_for :teams, :allow_destroy =&gt; :true\n</code></pre>\n\n<p>team.rb:</p>\n\n<pre><code>attr_accessible :members_attributes\nbelongs_to :comp\nhas_many :members\naccepts_nested_attributes_for :members\n</code></pre>\n\n<p>member.rb:</p>\n\n<pre><code> belongs_to :team\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13245331,"title":"Collecting only a specific value and selecting as default","body":"<p>I have something like this as a select_tag :</p>\n\n<p><code>&lt;p&gt;&lt;%= setting_select :ui_theme, My::Themes.themes.collect {|t| [t.name, t.id]}, :blank =&gt; :label_default, :label =&gt; :label_theme %&gt;&lt;/p&gt;</code></p>\n\n<p>Rite now it is collecting all the values and displaying but I want to collect only a specific value and make it default. This value has name = \"Test\". </p>\n\n<p>Thus it should look like this and it should be default:</p>\n\n<p><code>&lt;option selected=\"selected\" value=\"Test\"&gt;Test&lt;/option&gt;</code></p>\n\n<p>Note : Here setting_select is a helper which is defined like this:</p>\n\n<pre><code>def setting_select(setting, choices, options={})\n    if blank_text = options.delete(:blank)\n      choices = [[blank_text.is_a?(Symbol) ? l(blank_text) : blank_text, '']] + choices\n    end\n    setting_label(setting, options).html_safe +\n      select_tag(\"settings[#{setting}]\",\n                 options_for_select(choices, Setting.send(setting).to_s),\n                 options).html_safe\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13025953,"title":"form_for undefined method `model_name' error","body":"<p>I'm having problem with form_for, have searched for the problem for the solutions given does not solve my problem.</p>\n\n<p>I'm trying to do up a form to create new recipes:</p>\n\n<pre><code>**app/views/recipes/new.html.erb**\n&lt;%= form_for @recipe do |f| %&gt;\n  &lt;% if @recipe.errors.any? %&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :recipename %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :recipename %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user_id %&gt;&lt;br /&gt;\n    &lt;%= f.number_field :user_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n\n\n<pre><code>**routes.rb**\nBaserecipe::Application.routes.draw do\n\n  resources :users\n  resources :recipes\n  ....\n  match '/createrecipe', to: 'recipes#new'\n</code></pre>\n\n<hr>\n\n<pre><code>**recipes_controller.rb**\nclass RecipesController &lt; ApplicationController\n\n  def create\n    @recipe = Recipe.new(params[:recipe])\n  end\nend\n</code></pre>\n\n<p>I'm alway getting the error:</p>\n\n<pre><code>undefined method `model_name' for NilClass:Class\n</code></pre>\n\n<p>Extracted source (around line #1): </p>\n\n<pre><code>1: &lt;%= form_for @recipe do |f| %&gt;\n2:   &lt;% if @recipe.errors.any? %&gt;\n3:   &lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>class Recipe &lt; ActiveRecord::Base\n  attr_accessible :recipename, :instruct1, :instruct2, :instruct3, :instruct4, :instruct5,\n  :instruct6, :instruct7, :instruct8, :instruct9, :instruct10, :instruct11, :instruct12,\n  :instruct13, :instruct14, :instruct15, :instruct16, :instruct17, :instruct18, :instruct19,\n  :instruct20, :instruct21, :instruct22, :instruct23, :instruct24, :instruct25, :instruct26,\n  :instruct27, :instruct28, :instruct29, :instruct30, :preptime, :cooktime\n\n  belongs_to :user\n  has_many :ingredients\n  has_many :rcomments\n\n  validates :recipename, presence: true, length: { maximum: 140 }\n  validates :user_id, presence: true\n  validates :preptime, presence: true\n  validates :cooktime, presence: true\n\n  default_scope order: 'recipes.created_at DESC'\nend\n</code></pre>\n\n<p>full trace:</p>\n\n<pre><code>activemodel (3.2.7) lib/active_model/naming.rb:163:in `model_name_from_record_or_class'\nactivemodel (3.2.7) lib/active_model/naming.rb:158:in `param_key'\nactionpack (3.2.7) lib/action_view/helpers/form_helper.rb:369:in `form_for'\napp/views/recipes/new.html.erb:3:in `_app_views_recipes_new_html_erb___168565054_39061080'\nactionpack (3.2.7) lib/action_view/template.rb:145:in `block in render'\nactivesupport (3.2.7) lib/active_support/notifications.rb:125:in `instrument'\nactionpack (3.2.7) lib/action_view/template.rb:143:in `render'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:47:in `block (2 levels) in render_template'\nactionpack (3.2.7) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.7) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:46:in `block in render_template'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:54:in `render_with_layout'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:45:in `render_template'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:18:in `render'\nactionpack (3.2.7) lib/action_view/renderer/renderer.rb:36:in `render_template'\nactionpack (3.2.7) lib/action_view/renderer/renderer.rb:17:in `render'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:110:in `_render_template'\nactionpack (3.2.7) lib/action_controller/metal/streaming.rb:225:in `_render_template'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:103:in `render_to_body'\nactionpack (3.2.7) lib/action_controller/metal/renderers.rb:28:in `render_to_body'\nactionpack (3.2.7) lib/action_controller/metal/compatibility.rb:50:in `render_to_body'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:88:in `render'\nactionpack (3.2.7) lib/action_controller/metal/rendering.rb:16:in `render'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'\nactivesupport (3.2.7) lib/active_support/core_ext/benchmark.rb:5:in `block in ms'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/benchmark.rb:295:in `realtime'\nactivesupport (3.2.7) lib/active_support/core_ext/benchmark.rb:5:in `ms'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:40:in `block in render'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'\nactiverecord (3.2.7) lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:39:in `render'\nactionpack (3.2.7) lib/action_controller/metal/implicit_render.rb:10:in `default_render'\nactionpack (3.2.7) lib/action_controller/metal/implicit_render.rb:5:in `send_action'\nactionpack (3.2.7) lib/abstract_controller/base.rb:167:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/rendering.rb:10:in `process_action'\nactionpack (3.2.7) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:414:in `_run__22188539__process_action__1016913818__callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.7) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/rescue.rb:29:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'\nactiverecord (3.2.7) lib/active_record/railties/controller_runtime.rb:18:in `process_action'\nactionpack (3.2.7) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.2.7) lib/action_controller/metal.rb:203:in `dispatch'\nactionpack (3.2.7) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.2.7) lib/action_controller/metal.rb:246:in `block in action'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:73:in `call'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:36:in `call'\njourney (1.0.4) lib/journey/router.rb:68:in `block in call'\njourney (1.0.4) lib/journey/router.rb:56:in `each'\njourney (1.0.4) lib/journey/router.rb:56:in `call'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:600:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.4.1) lib/rack/etag.rb:23:in `call'\nrack (1.4.1) lib/rack/conditionalget.rb:25:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/flash.rb:242:in `call'\nrack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\nrack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/cookies.rb:338:in `call'\nactiverecord (3.2.7) lib/active_record/query_cache.rb:64:in `call'\nactiverecord (3.2.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `_run__305680696__call__774818341__callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.7) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.7) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.7) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.7) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.7) lib/rails/engine.rb:479:in `call'\nrailties (3.2.7) lib/rails/application.rb:220:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.7) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","each"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13244946,"title":".each breaking if only 1 result - rails","body":"<p>For some reason, I keep getting an \"undefined method 'each'\" error every time I try to do the .each do when I have one result in the below.  </p>\n\n<p>If I use .inspect, I can see that there's a match.  Does .each work if there's not more than 1 result?  If not, what should I use instead?</p>\n\n<pre><code>&lt;% friends = graph.get_object(\"/me/friends\").map{ |hash| hash[\"id\"] } %&gt;\n\n&lt;% User.select([:id]).where(fbookid: friends).each do |common| %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>If I just run .inspect on the User.select line (no each), then I get </p>\n\n<pre><code>[#&lt;User id: 1&gt;]\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n\n<p>Thank you!</p>\n\n<p><em>UPDATE</em> </p>\n\n<p>Adding additional parameters seemed to allow me to use each...I have no clue why.  It's the same exact result (only 1).</p>\n\n<pre><code>User.select([:id, :email, :first_name]).where(fbookid: friends).each do |friend|\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13245072,"title":"How do I not use current_user in the model","body":"<p>I have a form to create posts. This form also has tags on the post and it is owned by a user. The form is using a virtual attribute :tag_ids. </p>\n\n<p>I would like to do something like this, where you find_or_create_by_name_and_user_id and then just pass the current_user.id.</p>\n\n<pre><code>def tag_ids=(tags_string)\n    self.taggings.destroy_all\n    tag_names = tags_string.split(\",\").collect{|s| s.strip.downcase}.uniq\n    tag_names.each do |tag_name|\n      tag = Tag.find_or_create_by_name_and_user_id(tag_name, current_user.id)\n      tagging = self.taggings.new\n      tagging.tag_id = tag.id\n    end\nend\n</code></pre>\n\n<p>From what I read this isn't how it should work. The current user should be called in the PostsContoller create method. </p>\n\n<pre><code>def create\n  @post = Post.new(params[:post])\n  @post.user = current_user\n  respond_to do |format|\n     if params[:commit]\n     @post.save\n</code></pre>\n\n<p>...\nend</p>\n\n<p><em>This is where I'm stuck.</em> <strong>If the params are passing all of the attributes, how can I inject the current_user id into tag model which has a :name and :user_id attribute?</strong> </p>\n\n<p>I also read that this should work because of my associations.</p>\n\n<p>User - has_many posts; has_many tags</p>\n\n<p>Post - belongs_to user; has_many taggings; has_many tags through taggings</p>\n\n<p>Tag - has many taggings; has_many posts through taggings; belongs_to user</p>\n\n<p>Tagging - belongs_to post; belongs_to tag</p>\n"},{"tags":["ruby","ruby-on-rails-3","testing","login","spec"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":13244925,"title":"How to log in as a user in user_controller_spec?","body":"<p>A person is not allowed to look at the users page unless they are an admin. Hence users cannot leave the home page if they aren't logged in. In the user_controller_spec we have several tests on editing personal info or passwords. But the tests will never pass because the user we created in the spec class is not logged in. Is there a way to log in the user in the user_controller_spec?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","introspection","pluralize"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13244176,"title":"Rails: how to see pluralized and single form of names","body":"<p>I has created a model Anonymous with command </p>\n\n<pre><code>rails g model Anonymous section_id:integer aid:string fake:bool active:bool\n</code></pre>\n\n<p>but table name in the migration is called anonymous</p>\n\n<pre><code>class CreateAnonymous &lt; ActiveRecord::Migration\n  def change\n    create_table :anonymous do |t|\n      t.integer :section_id\n      t.string :aid\n      t.bool :fake\n      t.bool :active\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Am i right that pluralized form of Anonymous is Anomymous too ? (English is not my native language). How can i see what pluralized names Rails gives to my models ? Something like <code>rake routes</code> ?</p>\n"},{"tags":["ruby-on-rails-3","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13226832,"title":"Display edit user link only when that user is logged in","body":"<p>I have a Users resource and I want to display the \"edit\" link in the show.html.erb files only when that user is logged in. See screenshots. </p>\n\n<p><img src=\"http://i.stack.imgur.com/bXHT5.png\" alt=\"Here is a list of users. Notice in the top right that Roger Sterling is logged in.\"></p>\n\n<p>Here is a list of users. Notice in the top right that Roger Sterling is logged in.</p>\n\n<p><img src=\"http://i.stack.imgur.com/1TJM6.png\" alt=\"But if I click on Don Draper, the show.html.erb file displays the &quot;Edit&quot; button. I only want that to appear for Roger Sterling, in this case.\"></p>\n\n<p>But if I click on Don Draper, the show.html.erb file displays the \"Edit\" button. I only want that to appear for Roger Sterling, in this case.</p>\n\n<p>I'm using Devise for authentication. Any ideas on how to accomplish this? Let me know if you need to see any available code. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","login","devise","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13129254,"title":"How to direct user to a specific page after logging in with Devise and Rails","body":"<p>How do I redirect a user to a specific page when they login on a particular form I create with Devise? There's this howto page for Devise on <a href=\"https://github.com/plataformatec/devise/wiki/How-to%3a-redirect-to-a-specific-page-on-successful-sign-in-out\" rel=\"nofollow\">how to redirect to a particular page after sign in</a>. However, I want different forms to sign in to different target pages. Ideally, I can just add another HTML form parameter like this:</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"target\" value=\"/dashboard\"/&gt;\n</code></pre>\n\n<p><em><strong>UPDATE</em></strong>: It's important that I maintain the normal functionality of Devise for a login page. That is, if I click on a link that has a <code>before_filter :authenticate_user!</code> in its controller, then I'll be redirected to a login page. After logging in, then I'm redirected to the original destination page.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13243385,"title":"Can't mass-assign protected attributes: _destroy - Ruby on Rails","body":"<p>I'm getting this error:</p>\n\n<p>\"ActiveModel::MassAssignmentSecurity::Error in DaysController#create</p>\n\n<p>Can't mass-assign protected attributes: _destroy\"</p>\n\n<p>I didn't even know that _destroy is an attribute!</p>\n\n<p>What I have going on:</p>\n\n<p>My model is that I have \"Trips\" which has many \"Days\"</p>\n\n<p>In the \"Show\" view of my Trips model, I'm rendering a partial for a Form to add a new \"Day\":</p>\n\n<pre><code>&lt;div id=\"day_form\"&gt;\n  &lt;%= render :partial =&gt; \"day_form\", :day =&gt; @day %&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>My model:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :title, :days_attributes\n  has_many :days\n  accepts_nested_attributes_for :days, allow_destroy: true\n\nend\n\n\n class Day &lt; ActiveRecord::Base\n  attr_accessible :activity_id, :order, :summary, :trip_id, :activities_attributes\n  belongs_to :trip\n  has_many :activities, :order =&gt; 'position'\n  accepts_nested_attributes_for :activities, allow_destroy: true \nend\n</code></pre>\n\n<p>When I submit the form, I am getting this Mass Assignment error.  Why?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The 'Day' Form looks like this:</p>\n\n<pre><code>    &lt;%= form_for(@day) do |f| %&gt;\n\n      &lt;ul&gt;\n      &lt;% @day.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n        &lt;fieldset&gt;\n          &lt;%= f.label :summary, \"Day Summary\" %&gt;&lt;br /&gt;\n          &lt;%= f.text_area :summary, :rows =&gt; 1 %&gt;&lt;br /&gt;\n          &lt;%= f.hidden_field :_destroy %&gt;\n              &lt;%= link_to \"remove\", '#', class: \"remove_fields\" %&gt;\n        &lt;/fieldset&gt;\n        &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n        &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13238687,"title":"Nesting, is it what I need?","body":"<p>Projects have users.\nUsers have expenses.</p>\n\n<p>I have a screen for the currently signed in user to add new expenses, my controller forces the user key based on current_user.</p>\n\n<p>Now I am needing to allow users to work within a particular project, and enter their expenses for that project all at once, basically \"enter\" a project-expense screen, to limit the scope of the expenses shown in that screen by the project they selected.</p>\n\n<p>(Similar to the way basecamp makes you pick a project you work on)</p>\n\n<p>I do want to use this view for other things, and would like to  make it as DRY as possible.</p>\n\n<p>Was just wondering, what is the proper way to have a user select a project, and then persist that choice through their use of my existing expenses screen.</p>\n\n<p><strong>EDIT</strong> -  I would like to be able to pick a project, and then have all the functionality on the expenses page pass along that project through to the controller methods.</p>\n\n<p>So I could end up with /project/45/expenses .... etc</p>\n\n<p>Thanks!</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  attr_accessible :name, :active\n\n    has_many :expenses, foreign_key: :project_id\n\nend\n\nclass Expense &lt; ActiveRecord::Base\n  attr_accessible :amount, :expense_date, :project_id, :expense_type_id, :user_id\n\n  belongs_to :project\n    belongs_to :user\n    belongs_to :expense_type\n    has_one :expense_approval\n\nend\n\nclass User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :name, :email, :password, :password_confirmation, :remember_me\n\n  has_many :expenses, foreign_key: :user_id\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13243357,"title":"Uploading multiple files to heroku serially locks up all dynos","body":"<p>Its my understanding that when I upload a file to my heroku instance its a synchronous request and I will get a 200 back when the request is done, which means my upload has been processed and stored by paperclip.</p>\n\n<p>I am using plupload which does a serial upload (one file at a time).  On Heroku I have 3 dynos and my app becomes unresponsive and I get timeouts trying to use the app.  My upload should really only tie up at most a single dyno while all the files are being uploaded since its done serially and file 2 doesnt start until a response is returned from file 1.</p>\n\n<p>As a test I bumped my dynos to 15 and ran the upload. Again I see the posts come into the logs and then I start seeing output of paperclip commands (cant remember if it was identify or convert) and I start getting timeouts.  </p>\n\n<p>I'm really lost as to why this is happening.  I do know I 'can' upload directly to s3 but my current approach should be just fine.  Its an admin interface that is only used by a single person and again at most it should tie up a single dyno since all the uploaded files are sent serially.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","actionmailer"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2969,"score":0,"question_id":5309304,"title":"How to configure to send email through localhost app server without authentication?","body":"<p>I have configured the Rails mailer under config/initializers/ like following:</p>\n\n<p><strong>/config/initializers/setup_email.rb</strong></p>\n\n<pre><code>config.action_mailer.raise_delivery_errors = true\n\n  ActionMailer::Base.smtp_settings = {\n   :address =&gt; \"smtp.gmail.com\",\n   :port =&gt; 587,\n   :domain =&gt; 'gmail.com',\n   :authentication =&gt; :plain,\n   :user_name=&gt;&lt;username&gt;,\n   :password=&gt;&lt;password&gt;,\n   :enable_starttls_auto =&gt; true\n}\n</code></pre>\n\n<p>it works fine, I can send emails and get them received.</p>\n\n<p>But how to configure it to send email from localhost without authentication(without username and password), that's do not use gmail, but send email through the application's local server, how to configure then?</p>\n\n<p>--EDIT---\nWhen using localhost, the error message I got is:</p>\n\n<pre><code>Connection refused - connect(2)\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `initialize'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `open'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `do_start'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/timeout.rb:67:in `timeout'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/timeout.rb:101:in `timeout'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `do_start'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:525:in `start'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/network/delivery_methods/smtp.rb:127:in `deliver!'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:1967:in `do_delivery'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:228:in `deliver'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:401:in `deliver_mail'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages.rb:52:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages/instrumenter.rb:21:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages.rb:52:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:399:in `deliver_mail'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:228:in `deliver'\n/home/user1/myapp/app/mailers/my_mailer.rb:9:in `new_car_messages'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151:in `send_action'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151:in `process_action'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:120:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/rendering.rb:40:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/old_api.rb:75:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:446:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:441:in `initialize'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:425:in `new'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:425:in `method_missing'\n/home/user1/myapp/config/../lib/my/new_car_sender.rb:7:in `send_email'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `__send__'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `each'\n/home/user1/myapp/config/../lib/my/new_car_sender.rb:6:in `send_email'\n/home/user1/myapp/lib/tasks/new_car_messages.rake:8\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:636:in `call'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:636:in `execute'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:631:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:631:in `execute'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:597:in `invoke_with_call_chain'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/monitor.rb:242:in `synchronize'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2001:in `run'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:1998:in `run'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/bin/rake:31\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/bin/rake:19:in `load'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/bin/rake:19\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","tags","acts-as-taggable-on"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":9028883,"title":"Using tags for user-set UX details","body":"<p>I'm using <code>acts_as_taggable_on</code> for tagging items across my system so that they're easily searchable.</p>\n\n<p>Now I have a UX problem: I'm noticing lots of places where users choose certain minor states (for example, closing a one-time help box or moving to the next javascript-run step in a given page). We have here situations that are both too minor/numerous/dynamic/fast-changing to be put into a database table (imagine having to migrate with every UX change!), and that there is a need to persist some of these choices beyond the session.</p>\n\n<p>In this case, is there anything wrong with using tags to store these simple decisions? For example, <code>user.set_tags_on(:ui, \"closed_index_help\")</code> or <code>user.set_tags_on(:ui, \"tutorial_1_done\")</code>, then showing/hiding these elements in the future by looking at the user's <code>ui_list</code>.</p>\n\n<p>Are there drawbacks to this I'm not considering or is this a prudent way to go?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","performance","time-series"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13243137,"title":"Efficiently plot database activity as a time series","body":"<p>I am working on a system where 200,000+ records have been created in the past year and I need to plot their creation on a time series with various added filters. At this present, this requires performing lots of <code>count</code> queries (30 for each month plotted). How should these dates be stored for maximum speed?</p>\n\n<p>One idea: store the most commonly-visualized data in a number of serialized fields containing <code>count</code>s for each day over the past month. Update each day with <code>cron</code> and serve up as necessary. (Where should these be stored - some new database table or a separate file accessible by Heroku cron?)</p>\n"},{"tags":["javascript","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":537,"score":3,"question_id":6418556,"title":"How do I build an 'embeddable widget'?","body":"<p>My webapp uses both Rails and JS and I would like users to be able to embed the images they upload to any blog/site.</p>\n\n<p>What do I need to know, from a development point-of-view to allow me to create the functionality that generates an 'embed' link. It can be either a link like YouTube does, or a JS snippet or anything.</p>\n\n<p>Just want to get a high-level overview of what I need to be able to do and how to proceed.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","amazon-s3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13242031,"title":"Rails, PaperClip, S3, Heroku: Model icon fields not being saved","body":"<p>I am using Rails 3.2 + Heroku + S3 + Paperclip to store an icon on my <code>User</code> model. The model is not saving the 4 icon fields though. The images are getting processed and saved on S3 correctly and no errors are occurring. I also have another model that has a document being stored via Paperclip and S3. That model works perfectly in all cases. The <code>User</code> icon works locally but not on Heroku.</p>\n\n<p><code>production.rb</code> relevant configuration</p>\n\n<pre><code>config.paperclip_defaults = {\n  :storage =&gt; :s3,\n  :s3_credentials =&gt; {\n    :bucket =&gt; ENV['AWS_BUCKET'],\n    :access_key_id =&gt; ENV['AWS_ACCESS_KEY_ID'],\n    :secret_access_key =&gt; ENV['AWS_SECRET_ACCESS_KEY']\n  }\n}\n</code></pre>\n\n<p>User model code:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :icon\n\n  has_attached_file :icon, :url =&gt; \"/system/:rails_env/:attachment/:style/:hash.:extension\",\n    :hash_data =&gt; \":class/:attachment/:id\",\n    :hash_secret =&gt; \"superSecretThing\",\n    :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" },\n    :default_url =&gt; \"/blank.png\"\n  ...\n</code></pre>\n\n<p>Controller code: (This code is kind of crazy because I am AJAXing files Base64 encoded.)</p>\n\n<pre><code>  params[:user][:icon_data]\n  decoded_file = Base64.decode64(data)\n  begin\n    split_name = params[:user][:icon_file_name].split(\".\")\n    file = Tempfile.new([split_name[0..-2].join(\".\"), \".#{split_name[-1]}\"])\n    file.binmode\n    file.write(decoded_file)\n    file.close\n    @user.icon = open(file)\n    @user.icon_file_name = params[:user][:icon_file_name]\n  ensure\n    file.unlink\n  end\n  @user.save\n</code></pre>\n\n<p>I do an almost identical process on another model with a Paperclip attachment and it works flawlessly. In both cases the attachment is being saved correctly to S3 and no errors are being raised. <a href=\"https://gist.github.com/4021058\" rel=\"nofollow\">This gist has example output</a> for a controller action from the Heroku logs. </p>\n\n<p>I am pretty baffled because the other model works fine. The only real difference is that the <code>User</code> attachment does image processing but that part appears to be working fine.</p>\n\n<p>The problem is the same as <a href=\"http://stackoverflow.com/questions/4654111/paperclip-w-imagemagick-amazon-s3-and-heroku-imagemagick-s3-work-but-the?rq=1\">this one</a>, but the solution there does not apply.</p>\n\n<p>Thoughts?</p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13238824,"title":"how to test for inserts in database?","body":"<p>I have rspec test of a method that inserts or returns first record if record with given attributes doesn't exists. It looks like this</p>\n\n<pre><code>context 'user doesn't exists' do\n  subject { User.find_or_create(name: \"Jonh\", login: \"john\") }\n\n  it { should be_an_instance_of(User) }\n  //and here I want to test that new user was inserted into database...\n\nend\n</code></pre>\n\n<p>but I can't figure out how to use <code>expect to change</code> in this.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13238105,"title":"Can't mass-assign protected attributes in models with a has_one relation","body":"<p>Hello I have two models </p>\n\n<p>User Model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :user_information\n  attr_accessible :email, :name\nend\n</code></pre>\n\n<p>UserInformation Model</p>\n\n<pre><code>class UserInformation &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :address, :business, :phone\nend\n</code></pre>\n\n<p>I create a user record and everthing works fine, but when I try to create the user information I get this this error:</p>\n\n<blockquote>\n<pre><code>ActiveModel::MassAssignmentSecurity::Error in UserInformationsController#create\n\nCan't mass-assign protected attributes: user\n</code></pre>\n</blockquote>\n\n<p>To create the user information record I go to </p>\n\n<blockquote>\n  <p>localhost:3000/users/1/user_informations/new</p>\n</blockquote>\n\n<p>and fill the form. Then I get the error.</p>\n\n<p>Please I need help I'm trying to do this for the last 4 days and now I desperate </p>\n\n<p>Thank you very much for your help.</p>\n\n<hr>\n\n<p>The user information form</p>\n\n<pre><code>&lt;%= form_for(@user_information) do |f| %&gt;\n  &lt;% if @user_information.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@user_information.errors.count, \"error\") %&gt; prohibited this user_information from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @user_information.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :user%&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :address %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :address %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :phone %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :phone %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :business %&gt;&lt;br /&gt;\n    &lt;%= f.check_box :business %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>the user_information_controller</p>\n\n<pre><code>class UserInformationsController &lt; ApplicationController\n  # GET /user_informations\n  # GET /user_informations.json\n  def index\n    @user_informations = UserInformation.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @user_informations }\n    end\n  end\n\n  # GET /user_informations/1\n  # GET /user_informations/1.json\n  def show\n    @user_information = UserInformation.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @user_information }\n    end\n  end\n\n  # GET /user_informations/new\n  # GET /user_informations/new.json\n  def new\n    @user = User.find(params[:id])\n    @user_information = UserInformation.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @user_information }\n    end\n  end\n\n  # GET /user_informations/1/edit\n  def edit\n    @user_information = UserInformation.find(params[:id])\n  end\n\n  # POST /user_informations\n  # POST /user_informations.json\n  def create\n    @user_information = UserInformation.new(params[:user_information])\n\n    respond_to do |format|\n      if @user_information.save\n        format.html { redirect_to @user_information, notice: 'User information was successfully created.' }\n        format.json { render json: @user_information, status: :created, location: @user_information }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @user_information.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /user_informations/1\n  # PUT /user_informations/1.json\n  def update\n    @user_information = UserInformation.find(params[:id])\n\n    respond_to do |format|\n      if @user_information.update_attributes(params[:user_information])\n        format.html { redirect_to @user_information, notice: 'User information was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @user_information.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /user_informations/1\n  # DELETE /user_informations/1.json\n  def destroy\n    @user_information = UserInformation.find(params[:id])\n    @user_information.destroy\n\n    respond_to do |format|\n      format.html { redirect_to user_informations_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13241978,"title":"Rails private messages how to create a conversation view?","body":"<p>I am using this gem for private messages: <a href=\"https://github.com/jongilbraith/simple-private-messages\" rel=\"nofollow\">https://github.com/jongilbraith/simple-private-messages</a></p>\n\n<p>I want to create a thread conversation instead of the e-mail conversation the scaffold have provided.</p>\n\n<p>Example, User A have sent 10 messages to User B. User A have also sent 10 messages to User C. </p>\n\n<p>Instead of looping through all the messages. (e-mail look) I want to create a threat like:</p>\n\n<p><strong>Inbox</strong></p>\n\n<pre><code>Conversation with User A (10 messages)\nConversation with User C (10 messages) \n</code></pre>\n\n<p>And when clicking on the conversation the messages should be ordered after date. So it would be like a conversation. </p>\n\n<p>The table for messages:</p>\n\n<pre><code>id\nsender_id\nrecipient_id\nsender_deleted\nrecipient_deleted\nsubject\nbody\nread_at\ncreated_at\nupdated_at\n</code></pre>\n\n<p>How do I create these views? How do I group the messages?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid","mongoid3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13241595,"title":"getting undefined method `id' when saving a document","body":"<p>When I try to save a document, I get this error:</p>\n\n<pre><code>undefined method `id' for \"504b6d66493f1b9c18000007\":String\n</code></pre>\n\n<p>with this parameter:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"_method\"=&gt;\"put\",\n \"authenticity_token\"=&gt;\"VkES2ecwdT6dPg3DDPK+O4NRa0mZy7zKALnkBXJ1Hbs=\",\n \"document\"=&gt;{\"name\"=&gt;\"Hoje\",\n \"description\"=&gt;\"## que bla bla bla\",\n \"storage\"=&gt;\"504b6d66493f1b9c18000007\",\n \"pub\"=&gt;\"1\"},\n \"commit\"=&gt;\"Save document\",\n \"id\"=&gt;\"5096d0f2e667079c17000029\"}\n</code></pre>\n\n<p>as you can see, the Id which the error refers, belongs to <code>storage</code> and not to <code>document</code> itself...</p>\n\n<p>this is my relationship</p>\n\n<h1>document.rb</h1>\n\n<pre><code>class Document\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  include Mongoid::Versioning\n  include Mongoid::FullTextSearch\n\n  #Fields\n  field :name, type: String\n  field :description, type: String\n  field :pub, type: Boolean, default: true\n  field :file_content, type: String\n\n  mount_uploader :file, FileUploader\n\n  #Validations\n  validates :name, presence: true;\n\n  #Relations\n  belongs_to :user\n  belongs_to :storage\n  belongs_to :organization\n\n  fulltext_search_in :file_content, \n    :index_name =&gt; 'fts_documento.content',\n    :filters =&gt; { \n      :pvt =&gt; lambda { |x| x.pub == true},\n      :org =&gt; lambda {|document| document.organization }\n    }\nend\n</code></pre>\n\n<h1>storage.rb</h1>\n\n<pre><code>class Storage\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  #Fields\n  field :path, type: String\n\n  #Validations\n  validates :path, presence: true\n\n  #Relations\n  belongs_to :user\n  belongs_to :organization\nend\n</code></pre>\n\n<p>and here is my <code>update</code> action</p>\n\n<pre><code>  def update\n    @document = Document.find params[:id]\n    if @document.update_attributes params[:document]\n\n      if params[:document][:file]\n        IndexerWorker.perform_async(@document.id)\n      end\n\n      redirect_to dashboard_path, notice: 'Document updated'\n    else\n      render 'document/edit'\n    end\n  end\n</code></pre>\n\n<p>I have no idea nor where to start...<br>\nIt was working a couple of weeks ago..  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":3777,"score":0,"question_id":4115931,"title":"Rails - Devise - edit_user_registration_path","body":"<p>with Rails there is the path, edit_user_registration_path to allow users to edit their profile.</p>\n\n<p>I'm setting up my own Account Control to present the user with a better UI to edit their profile etc.. which is routed at /account/profile, /account/notices, etc....</p>\n\n<p>Problem is this URL, /users/edit  still works and takes users to the DEVISE edit page.</p>\n\n<p>How can I have that always go to the new edit page /account/profile</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","datetime","postgresql"],"answer_count":1,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":1265,"score":5,"question_id":9571392,"title":"Ignoring timezones altogether in Rails and PostgreSQL","body":"<p>I'm dealing with dates and times in Rails and Postgres and running into this issue:</p>\n\n<p>The database is in UTC.</p>\n\n<p>The user sets a time-zone of choice in the Rails app, but it's only to be used when getting the users local time for comparing times.</p>\n\n<p>User stores a time, say March 17, 2012, 7pm. I don't want timezone conversions or the timezone to be stored. I just want that date and time saved. That way if the user changed their time zone, It would still show March 17, 2012, 7pm.</p>\n\n<p>I only use the users specified time zone to get records 'before' or 'after' the current time in the users local time zone. </p>\n\n<p>I'm currently using 'timestamp without time zone' but when I retrieve the records, rails (?) converts them to the time zone in the app, which I don't want. </p>\n\n<pre><code>Appointment.first.time\n =&gt; Fri, 02 Mar 2012 19:00:00 UTC +00:00 \n</code></pre>\n\n<p>Because the records in the database seem to come out as UTC, my hack is to take the current time, remove the time zone with 'Date.strptime(str, \"%m/%d/%Y\")' and then do my query with that:</p>\n\n<pre><code>.where(\"time &gt;= ?\", date_start)\n</code></pre>\n\n<p>It seems like there must be an easier way to just ignore time zones all around. Any ideas?</p>\n"},{"tags":["ruby-on-rails-3","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13238530,"title":"rails routing- not going to 404 on wrong address","body":"<p>I'm using this to_param</p>\n\n<pre><code>def to_param\n    [id, [first_name.parameterize,last_name.parameterize].join(\"_\")].join(\"-\")\nend\n</code></pre>\n\n<p>to produce an address that look like</p>\n\n<pre><code>http://www.example.com/users/34-joe_smith\n</code></pre>\n\n<p>but if I change the address to</p>\n\n<pre><code>http://www.example.com/users/34-joe_notsmith\n</code></pre>\n\n<p>It still directs me to user with id 34.</p>\n\n<p>How can I enforce it to go to 404 page or root_path?</p>\n"},{"tags":["linux","ruby-on-rails-3","bash-completion"],"answer_count":2,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":799,"score":11,"question_id":3847603,"title":"bash_completion for Rails 3","body":"<p>Is there any <code>bash_completion</code> script ready for Rails 3?</p>\n"},{"tags":["ruby-on-rails-3","postgresql","activerecord"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":163,"score":3,"question_id":10521793,"title":"Allow users to create dynamic model attributes?","body":"<p>In my <code>Rails3</code> app, I am using <code>ActiveRecord</code> and <code>Postgresql</code>.</p>\n\n<p>Say I have a model called <strong>Parts</strong>.  The model has a small list of standard attributes such as price, quantity, etc.</p>\n\n<p>However, Customer A might want to add <code>LotNumber</code> and CustomerB might want to add <code>OriginalLocation</code>.</p>\n\n<p>How would I allow them to do that?</p>\n\n<p>I thought about creating a <strong>PartsDetail</strong> model that allowed them to have a type.</p>\n\n<pre><code>class PartsDetail &lt; ActiveRecord::Base\n    attr_accessible :type, :value, :part_id\n    belongs_to :parts\nend\n</code></pre>\n\n<p>So that \"type\" could be \"LotNumber\", etc.</p>\n\n<p>But I'm not quite sure how that would work in my associations and querying. </p>\n\n<p>Any ideas?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","tags","virtual-attribute","changed"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13241033,"title":"Rails not showing virtual attribute as changed","body":"<p>I am using RocketTag and have the following in my model (other parts removed to keep it simple):</p>\n\n<pre><code>attr_accessible :tags, :tag_list\n\nbefore_update { do_something }\n\ndef tag_list\n  self.tags.join(\",\")\nend\n\ndef tag_list=(new_tags)\n  # split into array (comma and any spaces), ignore empties\n  self.tags = new_tags.split(/,[\\s]*/).reject(&amp;:empty?)\nend\n\nprivate\n\n  def do_something\n    if self.changed_for_autosave?\n      # something happens\n    end\n  end\n</code></pre>\n\n<p>However, \"do_something\" fires if any of the other fields are updated but not if the tags or tag_list are updated.</p>\n\n<p>Can anyone tell me why or suggest a workaround?</p>\n\n<p>I know about putting <code>attribute_will_change!(:tag_list)</code> within the tag_list setter but that is marking tag_list as changed everytime and I only want <code>do_something</code> to fire when something actually changes.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave","fog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":163,"score":0,"question_id":9964105,"title":"config.fog_host does not works fine for me with cdn's in rails 3.1","body":"<p>I have this in my <strong>fog.rb</strong></p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',\n    :aws_access_key_id      =&gt; 'key',\n    :aws_secret_access_key  =&gt; 'key',\n    :region                 =&gt; 'eu-west-1'\n  }\n\n  config.fog_host = proc { \"http://cdn#{(rand * 4).ceil}.domain.com\" }\n  config.fog_directory = 'pro'\n  config.fog_public = false\n  config.fog_attributes = {'Cache-Control' =&gt; 'max-age=315576000'} \nend\n</code></pre>\n\n<p>But I see the images routes to <a href=\"https://s3-eu-west-1.amazonaws.com/pro\" rel=\"nofollow\">https://s3-eu-west-1.amazonaws.com/pro</a>...</p>\n\n<p>However my assets js, css, and images assets works fine I see: </p>\n\n<p><a href=\"http://cdn0.domain.com/assets/logo-4cbddb290494d56e25f86fffa93f4b00.png\" rel=\"nofollow\">http://cdn0.domain.com/assets/logo-4cbddb290494d56e25f86fffa93f4b00.png</a></p>\n\n<p><strong>What am I doing wrong in this config?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13240064,"title":"How to render a \"Edit\" form partial in the \"Show\" page of another model in Rails","body":"<p>I want to display an \"Edit\" form in the \"Show\" view of a parent object.</p>\n\n<p>My model looks like this:\nA Trip has many Days which has many Activities.\nTrip accepts nested attributes for Days.  Days accepts nested Attributes for Activities.</p>\n\n<p>When I am in the \"Show\" view for a Trip, how do I render an \"Edit\" form partial for an \"Activity\"?</p>\n\n<p>I know I need to somehow specify to the Edit Form partial which Activity ID that I want to edit but I'm not sure how to pass along that information from the \"Show\" view of a \"Trip\".</p>\n\n<pre><code>    &lt;% @trip.days.each do |day| %&gt;\n    &lt;div id=\"daydiv_&lt;%= day.id %&gt;\"&gt;\n      &lt;b&gt;&lt;%= day.summary %&gt;&lt;/b&gt;\n        &lt;%= content_tag_for :ol, day do %&gt;\n          &lt;% day.activities.each do |activity| %&gt;\n                &lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_activity_path(activity) %&gt;&lt;/li&gt;\n          &lt;% end %&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n\n&lt;div id=\"activity_form\"&gt;\n  &lt;%= render :partial =&gt; \"/activities/form\", :activity =&gt; @activity  %&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>my /activities/form partial looks like this:</p>\n\n<pre><code>&lt;%= form_for(@activity) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13239929,"title":"\"nil is not a symbol\" for model count in rspec matcher","body":"<p>I am trying to write an integration test where if a user clicks on a button, it creates a new record in the database (CheckPrice model).</p>\n\n<p>I am running into the error <code>nil is not a symbol</code> when I try to run my test.</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe 'CheckPrice', type: :request, js: true  do\n  it \"should create a new CheckPrice record when user clicks Check Price on topic page\" do\n    city = create :city\n    hotel = create :hotel\n    affiliate_link = create :affiliate_link\n\n    visit '/hotel-bilboa-hotel'\n    sleep 2\n    click_button \"Check Prices\"\n    response.should change(CheckPrice.count).by(1)\n  end\nend\n</code></pre>\n\n<p>When \"Check Prices\" is clicked, there is an event listener that triggers the new method in the checkprices_controller.</p>\n\n<p>The error seems to occur on the last line <code>response.should change(CheckPrice.count).by(1)</code>. It looks like the method does not recognize the model CheckPrice. How do I reference the CheckPrice table?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","asset-pipeline","sprockets"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":468,"score":2,"question_id":10186523,"title":"Full Asset URL in a Rails .js.erb file","body":"<p>I have a bookmarklet that can be loaded on any website.</p>\n\n<p>It works like this;</p>\n\n<ul>\n<li>loads <code>http://my.example.com/assets/bookmarklet.js</code></li>\n<li>includes <code>http://my.example.com/assets/bookmarklet.css</code></li>\n</ul>\n\n<p>The css file is added to the dom via <code>bookmarklet.js</code>, so it needs to know where this is.</p>\n\n<p>My code is as follows;</p>\n\n<pre><code>// assets/javascripts/bookmarklet.js.erb\n\nvar config = {\n  stylesheetUrl: '&lt;%= asset_path(\"bookmarklet.css\", :only_path =&gt; false) %&gt;'\n}\n</code></pre>\n\n<p>But no matter what I try this renders as</p>\n\n<pre><code>var config = {\n  stylesheetUrl: '/assets/bookmarklet.css'\n}\n</code></pre>\n\n<p>I need the <code>asset_path</code> to return a full url.\nBut <code>asset_url</code> doesn't exist, and I can't find an option to <code>asset_path</code> that will prepend the current domain.</p>\n\n<p>Any solution?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":281,"score":0,"question_id":11158850,"title":"Hartl Chapter 10 Undefined local variable or method 'object'","body":"<p>I made the form partial for creating microposts as shown in <a href=\"http://ruby.railstutorial.org/chapters/user-microposts#code%3amicropost_form\" rel=\"nofollow\">Listing 10.33</a> with <code>&lt;%= render 'shared/error_messages', object: f.object %&gt;</code> and updated the respective views files as instructed. However, I cannot get the Rspec tests to pass as I keep getting \"undefined local variable or method 'object' for Class...\" Any ideas?</p>\n\n<p>app/views/shared/_micropost_form.html.erb</p>\n\n<pre><code>&lt;%= form_for(@micropost) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_area :content, placeholder: \"Compose new micropost...\" %&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>app/views/shared/_error_messages.html.erb</p>\n\n<pre><code>&lt;% if object.errors.any? %&gt;\n  &lt;div id=\"error_explanation\"&gt;\n    &lt;div class=\"alert alert-error\"&gt;\n      The form contains &lt;%= pluralize(object.errors.count, \"error\") %&gt;.\n    &lt;/div&gt;\n    &lt;ul&gt;\n      &lt;% object.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;* &lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>app/views/users/new.html.erb</p>\n\n<pre><code>&lt;% provide(:title, 'Sign up') %&gt;\n&lt;h1&gt;Sign up&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span6 offset3\"&gt;\n    &lt;%= form_for(@user) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n      &lt;%= render 'fields', f: f %&gt;\n      &lt;%= f.submit \"Create my account\", class: \"btn btn-large btn-primary\" %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>app/views/users/edit.html.erb</p>\n\n<pre><code>&lt;% provide(:title, \"Edit user\") %&gt; \n&lt;h1&gt;Update your profile&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span6 offset3\"&gt;\n    &lt;%= form_for(@user) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n      &lt;%= render 'fields', f: f %&gt;\n      &lt;%= f.submit \"Save changes\", class: \"btn btn-large btn-primary\" %&gt;\n    &lt;% end %&gt;\n\n    &lt;%= gravatar_for @user %&gt;\n    &lt;a href=\"http://gravatar.com/emails\" target=\"_blank\"&gt;change&lt;/a&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Authentication Spec</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"Authentication\" do\n\n  subject { page }\n\n  describe \"signin page\" do\n    before { visit signin_path }\n\n    it { should have_selector('h1',    text: 'Sign in') }\n    it { should have_selector('title', text: 'Sign in') }\n  end\n\n  describe \"signin\" do\n    before { visit signin_path }\n\n    describe \"with invalid information\" do\n      before { click_button \"Sign in\" }\n\n      it { should have_selector('title', text: 'Sign in') }\n      it { should have_error_message('Invalid') }\n\n      it { should_not have_link('Users',    href: users_path) }\n      it { should_not have_link('Sign out', href: signout_path) }\n\n      describe \"after visiting another page\" do\n        before { click_link \"Home\" }\n        it { should_not have_selector('div.alert.alert-error') }\n      end      \n    end\n\n    describe \"with valid information\" do\n      let(:user) { FactoryGirl.create(:user) }\n      before { sign_in user }\n\n      it { should have_selector('title', text: user.name) }\n\n      it { should have_link('Users',    href: users_path) }\n      it { should have_link('Profile', href: user_path(user)) }\n      it { should have_link('Settings', href: edit_user_path(user)) }\n      it { should have_link('Sign out', href: signout_path) }\n\n      it { should_not have_link('Sign in', href: signin_path) }\n\n      describe \"followed by signout\" do\n        before { click_link \"Sign out\" }\n        it { should have_link('Sign in') }\n      end      \n    end    \n  end  \n\n  describe \"authorization\" do\n\n    describe \"for non-signed-in users\" do\n      let(:user) { FactoryGirl.create(:user) }\n\n      describe \"in the Users controller\" do\n\n      it { should_not have_link('Profile', href: user_path(user)) }\n      it { should_not have_link('Settings', href: edit_user_path(user)) }\n\n        describe \"visiting the edit page\" do\n          before { visit edit_user_path(user) }\n          it { should have_selector('title', text: 'Sign in') }\n        end\n\n        describe \"submitting to the update action\" do\n          before { put user_path(user) }\n          specify { response.should redirect_to(signin_path) }\n        end\n\n        describe \"visiting the user index\" do\n          before { visit users_path }\n          it { should have_selector('title', text: 'Sign in') }\n        end \n      end\n\n      describe \"when attempting to visit a protected page\" do\n        before do\n          visit edit_user_path(user)\n          fill_in \"Email\",    with: user.email\n          fill_in \"Password\", with: user.password\n          click_button \"Sign in\"\n        end\n\n        describe \"after signing in\" do\n\n          it \"should render the desired protected page\" do\n            page.should have_selector('title', text: 'Edit user')\n          end\n\n      describe \"when signing in again\" do\n        before do\n          visit signin_path\n          fill_in \"Email\", with: user.email\n              fill_in \"Password\", with: user.password\n          click_button \"Sign in\"\n            end\n\n        it \"should render the default (profile) page\" do\n          page.should have_selector('title', text: user.name)\n        end\n          end\n        end\n\n      describe \"in the Microposts controller\" do\n\n        describe \"submitting to the create action\" do\n          before { post microposts_path }\n          specify { response.should redirect_to(signin_path) }\n        end\n\n        describe \"submitting to the destroy action\" do\n          before { delete micropost_path(FactoryGirl.create(:micropost)) }\n          specify { response.should redirect_to(signin_path) }\n        end\n      end   \n    end\n  end\n\n    describe \"as wrong user\" do\n      let(:user) { FactoryGirl.create(:user) }\n      let(:wrong_user) { FactoryGirl.create(:user, email: \"wrong@example.com\") }\n      before { sign_in user }\n\n      describe \"visiting Users#edit page\" do\n        before { visit edit_user_path(wrong_user) }\n        it { should_not have_selector('title', text: full_title('Edit user')) }\n      end\n\n      describe \"submitting a PUT request to the Users#update action\" do\n        before { put user_path(wrong_user) }\n        specify { response.should redirect_to(root_path) }\n      end\n    end  \n\n    describe \"as non-admin user\" do\n      let(:user) { FactoryGirl.create(:user) }\n      let(:non_admin) { FactoryGirl.create(:user) }\n\n      before { sign_in non_admin }\n\n      describe \"submitting a DELETE request to the Users#destroy action\" do\n        before { delete user_path(user) }\n        specify { response.should redirect_to(root_path) }        \n      end\n    end\n  end  \nend\n</code></pre>\n\n<p>User Spec</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"User pages\" do\n\n  subject { page }\n\n  describe \"index\" do\n\n    let(:user) { FactoryGirl.create(:user) }\n\n    before(:all) { 30.times { FactoryGirl.create(:user) } }\n    after(:all)  { User.delete_all }\n\n    before(:each) do\n      sign_in user\n      visit users_path\n    end    \n\n    it { should have_selector('title', text: 'All users') }\n    it { should have_selector('h1',    text: 'All users') }    \n\n    describe \"pagination\" do\n\n      it { should have_selector('div.pagination') }\n\n      it \"should list each user\" do\n        User.paginate(page: 1).each do |user|\n          page.should have_selector('li', text: user.name)\n        end\n      end\n    end\n\n    describe \"delete links\" do\n\n      it { should_not have_link('delete') }\n\n      describe \"as an admin user\" do\n        let(:admin) { FactoryGirl.create(:admin) }\n        before do\n          sign_in admin\n          visit users_path\n        end\n\n        it { should have_link('delete', href: user_path(User.first)) }\n        it \"should be able to delete another user\" do\n          expect { click_link('delete') }.to change(User, :count).by(-1)\n        end\n        it { should_not have_link('delete', href: user_path(admin)) }\n      end\n    end     \n  end\n\n  describe \"signup page\" do\n    before { visit signup_path }\n\n    it { should have_selector('h1',    text: 'Sign up') }\n    it { should have_selector('title', text: 'Sign up') }\n  end\n\n  describe \"profile page\" do\n    let(:user) { FactoryGirl.create(:user) }\n    let!(:m1) { FactoryGirl.create(:micropost, user: user, content: \"Foo\") }\n    let!(:m2) { FactoryGirl.create(:micropost, user: user, content: \"Bar\") }   \n\n    before { visit user_path(user) }\n\n    it { should have_selector('h1',    text: user.name) }\n    it { should have_selector('title', text: user.name) }\n  end  \n\n  describe \"microposts\" do\n      it { should have_content(m1.content) }\n      it { should have_content(m2.content) }\n      it { should have_content(user.microposts.count) }\n    end\n\n  describe \"signup\" do\n\n    before { visit signup_path }\n\n    let(:submit) { \"Create my account\" }\n\n    describe \"with invalid information\" do\n      it \"should not create a user\" do\n        expect { click_button submit }.not_to change(User, :count)\n      end\n\n      describe \"after submission\" do\n        before { click_button submit }\n\n        it { should have_selector('title', text: 'Sign up') }\n        it { should have_content('error') }\n      end      \n    end\n\n    describe \"with valid information\" do\n      before { valid_signup }\n\n      it \"should create a user\" do\n        expect { click_button submit }.to change(User, :count).by(1)\n      end\n\n      describe \"after saving the user\" do\n        before { click_button submit }\n        let(:user) { User.find_by_email('user@example.com') }\n\n        it { should have_selector('title', text: user.name) }\n        it { should have_success_message('Welcome') }\n    it { should have_link('Sign out') }\n      end\n    end\n  end  \n\n  describe \"edit\" do\n    let(:user) { FactoryGirl.create(:user) }\n    before do\n      sign_in user\n      visit edit_user_path(user)\n    end\n\n    describe \"page\" do\n      it { should have_selector('h1',    text: \"Update your profile\") }\n      it { should have_selector('title', text: \"Edit user\") }\n      it { should have_link('change', href: 'http://gravatar.com/emails') }\n    end\n\n    describe \"with invalid information\" do\n      before { click_button \"Save changes\" }\n\n      it { should have_content('error') }\n    end\n\n    describe \"with valid information\" do\n      let(:new_name)  { \"New Name\" }\n      let(:new_email) { \"new@example.com\" }\n      before do\n        fill_in \"Name\",             with: new_name\n        fill_in \"Email\",            with: new_email\n        fill_in \"Password\",         with: user.password\n        fill_in \"Confirm Password\", with: user.password\n        click_button \"Save changes\"\n      end\n\n      it { should have_selector('title', text: new_name) }\n      it { should have_success_message }\n      it { should have_link('Sign out', href: signout_path) }\n      specify { user.reload.name.should  == new_name }\n      specify { user.reload.email.should == new_email }\n    end    \n  end  \nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","solr","sunspot"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":158,"score":0,"question_id":8366240,"title":"sunspot solr: What is the functional difference between path and solr_home?","body":"<p>I was wondering if somebody can teach me the functional differences between <em>path</em> and *solr_home*. What kind of paths can they take (I know <em>path</em> cannot take filesystem path as parameters).</p>\n\n<p>My current production configuration is:</p>\n\n<pre><code>port: 8080\npath: /solr/\nsolr_home: /usr/share/apache-solr-3.3.0/solr/\n</code></pre>\n\n<p>I was under the impression that the index info is stored in my rails app /solr/ directory and that with every cap deploy they will be erased, but they are not so where are my solr index files stored? And what does that solr_home path do?</p>\n\n<p>Please somebody clear my doubts.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":10850163,"title":"Javascript file is not updated in development with Rails","body":"<p>I changed a JS file under app/assets/javascripts but it is still the same. I deleted the file and re-created but the content is still the old one. This is my development.rb file:</p>\n\n<pre><code>App::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  config.serve_static_assets = false\n\n  # In the development environment your application's code is reloaded on\n  # every request.  This slows down response time but is perfect for development\n  # since you don't have to restart the web server when you make code changes.\n  config.cache_classes = false\n\n  # Log error messages when you accidentally call methods on nil.\n  config.whiny_nils = true\n\n  # Show full error reports and disable caching\n  config.consider_all_requests_local       = true\n  config.action_controller.perform_caching = false\n\n  # Don't care if the mailer can't send\n  config.action_mailer.raise_delivery_errors = false\n\n  # Print deprecation notices to the Rails logger\n  config.active_support.deprecation = :log\n\n  # Only use best-standards-support built into browsers\n  config.action_dispatch.best_standards_support = :builtin\n\n  # Do not compress assets\n  config.assets.compress = false\n\n  # Expands the lines which load the assets\n  config.assets.debug = true\n\n  config.action_mailer.delivery_method = :letter_opener\n\n  config.action_mailer.default_url_options = { :host =&gt; \"lvh.me:3000\" }\n\n  # Raise exception on mass assignment protection for Active Record models\n  # config.active_record.mass_assignment_sanitizer = :strict\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n  config.log_tags = [:uuid, :remote_ip]\nend\n</code></pre>\n\n<p>The JS file is loaded inside the header tag with this code:</p>\n\n<pre><code>&lt;script src=\"/assets/deals.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>which is the normal way JS is loaded in development</p>\n"},{"tags":["javascript","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13235331,"title":"Debugging where rendered JS output is going","body":"<p>I have a Rails 3 application using unobtrusive Javascript on a link_to, to create a small window requiring user input. Here's the original button (for when a Client adds a Cat):</p>\n\n<pre><code>&lt;%= link_to \"New Cat\", new_client_cat_path(@client), :remote =&gt; true, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>In app/controllers/cats_controller.rb:</p>\n\n<pre><code>def new\n  @cat = @client.cats.build\n  @submit_label = \"Create\"\n  respond_to do |format|\n    format.html\n    format.js { }\n  end\nend\n</code></pre>\n\n<p>In app/views/cats/new.js.erb:</p>\n\n<pre><code>$('#&lt;%= dom_id(@cat) %&gt; .details').html('&lt;%= escape_javascript render(\"new\") %&gt;');\n</code></pre>\n\n<p>In app/views/cats/_new.html.erb:</p>\n\n<pre><code>&lt;h2&gt;New Cat&lt;/h2&gt;\n&lt;%= form_for [@client, @cat] do |f| %&gt;\n&lt;%= f.error_messages %&gt;\n&lt;%= f.submit @submit_label, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n&lt;% end %&gt;\n&lt;%= link_to \"Cancel\", @client, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>My problem is that I don't see the rendered \"new\" window. The log file shows that these pages got rendered:</p>\n\n<pre><code>Rendered cats/_new.html.erb (3.8ms)\nRendered cats/new.js.erb (5.4ms)\n</code></pre>\n\n<p>How can I tell where the output is getting rendered to, so that I can figure out why I don't see it in the same window where the user clicked the \"New Cat\" button?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13059971,"title":"Jquery basic file upload","body":"<p>I been working on a screencast pro proposed by Ryan called the Jquery file uploads. However every time i input images it doesn't get uploaded. I am not sure what i am doing wrong here my code. I am using google and did try to upload it but it doesn't seem to be doing anything</p>\n\n<p>Javascript\napplication.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery-fileupload/basic\n//= require jquery-fileupload/vendor/tmpl\n//= require_tree .\n</code></pre>\n\n<p>painting.js.coffee</p>\n\n<pre><code>jQuery -&gt;\n  $('#new_painting').fileupload\n</code></pre>\n\n<p>Views\n_form.html.erb</p>\n\n<pre><code>&lt;%= form_for @painting, :html =&gt; {:multipart =&gt; true} do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.hidden_field :galley_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :image %&gt;&lt;br /&gt;\n    &lt;%= f.file_field :image %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>index.html.erb</p>\n\n<h1>Painting Gallery</h1>\n\n\n  \n\n\n\n\n<pre><code>&lt;%= form_for Painting.new do |f| %&gt;\n  &lt;%= f.label :image, \"Upload paintings:\" %&gt;\n  &lt;%= f.file_field :image, multiple: true, name: \"painting[image]\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>show.html.erb</p>\n\n<pre><code>&lt;p&gt;&lt;%= image_tag @painting.image_url %&gt;&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;%= link_to \"Edit\", edit_painting_path(@painting) %&gt; |\n  &lt;%= link_to \"Destroy\", @painting, :confirm =&gt; 'Are you sure?', :method =&gt; :delete %&gt; |\n  &lt;%= link_to \"Back to Paintings\", paintings_path %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>def index\n    @paintings = Painting.all\n  end\n\n  def show\n    @painting = Painting.find(params[:id])\n  end\n\n  def new\n    @painting = Painting.new\n  end\n\n  def create\n    @painting = Painting.create(params[:painting])\n  end\n\n  def edit\n    @painting = Painting.find(params[:id])\n  end\n\n  def update\n    @painting = Painting.find(params[:id])\n    if @painting.update_attributes(params[:painting])\n      redirect_to paintings_url, notice: \"Painting was successfully updated.\"\n    else\n      render :edit\n    end\n  end\n\n  def destroy\n    @painting = Painting.find(params[:id])\n    @painting.destroy\n    redirect_to paintings_url, notice: \"Painting was successfully destroyed.\"\n  end\n</code></pre>\n\n<p>Model</p>\n\n<pre><code>  attr_accessible :image\n  mount_uploader :image, ImageUploader\n</code></pre>\n\n<p>My main issues is when it comes to upload any picture it just doesn't have a submit button and not sure how to make it work, did i miss something??</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":40,"score":4,"question_id":13182644,"title":"Rails Relation#update_all consumes more memory than Relation#update","body":"<p>The <code>Relation#update(id, attributes)</code> docs mentions that \"The resulting object is returned whether the object was saved successfully to the database or not.\", while the <code>Relation#update_all(updates, conditions = nil, options = {})</code> states that no instantiations, callbacks or validations are made (straight DB query).</p>\n\n<p>Running a simple performance test and replacing <code>Relation#update</code> with <code>Relation#update_all</code>, it looks like the memory consumption have increased.</p>\n\n<p>Any explanation?</p>\n\n<p>Excerpt:</p>\n\n<pre><code>#Before\nMyModel.update(my_hash['id'], special_attrs)\n\n#After (more memory consumed)\nMyModel.where(:id =&gt; my_hash['id']).update_all(special_attrs)\n\n#Update-2 (slightly more memory consumed than with update(id, attrs)\nMyModel.update_all(special_attrs, {:id =&gt; my_hash['id']})\n</code></pre>\n\n<ul>\n<li>Windows XP (yeh - I know)</li>\n<li>JRuby 1.6.8 (1.9)</li>\n<li>Rails 3.2.8</li>\n</ul>\n\n<p><strong>UPDATE</strong> - Some basic numbers for comparison: \nFor around 700 update statements fired, there's a difference of around 0.6MB (0.8kB per statement)</p>\n\n<p><strong>UPDATE 2</strong> - Removed AREL chaining as per @philip-hallstrom suggestion. Slight reduction in memory footprint but still <code>MyModel.update_all(attrs, conditions)</code> is consuming more memory than <code>MyModel.update(id, attrs)</code>.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13230702,"title":"Selecting favourites from DB rails 3","body":"<p>I have a small app which has Users, Recipes, Ingredients and preparation models</p>\n\n<p>A user has many recipes, recipes belong to user and ingredients/preparation belongs to recipes.</p>\n\n<p>Now a user can view all recipes but I would like the option to add the particular recipe to a favourites list. Would I need to set a new DB to hold this and then link by associations or could I add a column to the recipe model called fav for example?</p>\n\n<p>Im looking for the best practice here or if someone has done this before and can offer any advice that would be appreciated</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13234849,"title":"RoR - Time.strptime issues","body":"<p>Here is the method in question. </p>\n\n<pre><code>def published_at_setter\n    self.published_at = Time.strptime(\"#{@date} #{@time}\", \"%m/%d/%Y %I:%M %p\")\n    puts \" ~~~~~~~~~~~~~~~~~~~ #{@date} #{@time} ~~~~~~~~~~~~~~~~ #{self.published_at}\"\nend\n</code></pre>\n\n<p>With @date = \"09/11/2012\" and @time \"01:45 AM\" I get this in the webbrick console. WFT?</p>\n\n<pre><code>~~~~~~~~~~~~~~~~~~~ 09/11/2012 01:45 AM ~~~~~~~~~~~~~~~~ 2012-09-11 06:45:00 UTC\n</code></pre>\n\n<p>When in rails console I get the expected results. \"2012-09-11 01:45:00 -0500\"</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13235986,"title":"Rails - Always have to check exists, and then value?","body":"<p>I am checking to see if a value in a related table exists quite often in my view, in this case, expenses have approvals.  If they have not been submitted, then there is no record of them in the approvals table.  </p>\n\n<p>I am ending up with some really awkward code</p>\n\n<pre><code>&lt;% if !expense_item.expense_approval || expense_item.expense_approval.approval_status == 0 %&gt;\n</code></pre>\n\n<p>Is there a way to do an if statement on a value, without having to check if it exists first?  Or some default way to set it nil?</p>\n"},{"tags":["ruby","ruby-on-rails-3","report"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":149,"score":4,"question_id":12889659,"title":"Ruby or Rails reporting tools?","body":"<p>I am looking for a report generation tool in ruby or rails which allows the user to define a template, then fetch data into the created template.</p>\n\n<p>I have been looking through \"<a href=\"https://www.ruby-toolbox.com/categories/reporting.html\" rel=\"nofollow\">The Ruby Box: reporting section.</a>\"</p>\n\n<p>There are two reporting tools I have looked at:</p>\n\n<ol>\n<li><p><strong><a href=\"http://www.thinreports.org/\" rel=\"nofollow\">Thin Reports</a>:</strong> It is really good. You can create your own report template with the template editor. Then you can produce PDF reports using <a href=\"http://rubygems.org/gems/thinreports/\" rel=\"nofollow\">thinreports</a> gems.</p></li>\n<li><p><strong><a href=\"https://github.com/sandrods/odf-report\" rel=\"nofollow\">ODF Report:</a></strong> You can create a template ODF file using Open Office and MS Word, and you can use that template to generate the report.</p></li>\n</ol>\n\n<p>Both of these solutions lack the ability to draw charts. Does anyone know of similar reporting tools that can draw charts within a given report?</p>\n\n<p>I have tried the <a href=\"http://ruby-rtf.rubyforge.org/\" rel=\"nofollow\">RTF Ruby Library</a>. It works, but shares the limitation that it cannot draw charts and graphs. </p>\n\n<p>The minimum requirements are:</p>\n\n<ol>\n<li><p>Able to create customizable templates. (e.g. design layout, set font size, color, embed images etc.)</p></li>\n<li><p>Able to draw tables and charts.</p></li>\n<li><p>Template could be in Docx or excel or xml or any other common file format.</p></li>\n<li><p>Report output report must be in Docx or RTF format.</p></li>\n</ol>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","amazon-s3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13229927,"title":"Saving only processed images in paperclip","body":"<p>my paperclip setup is </p>\n\n<pre><code>has_attached_file :avatar, :styles =&gt; { :medium =&gt; \"300x300\", :thumb =&gt; \"100x100\"},\n    :storage =&gt; :s3,\n    :bucket =&gt; ENV['BUCKET'],\n    :s3_credentials =&gt; {\n      :access_key_id =&gt; ENV['ACCESS_KEY'],\n      :secret_access_key =&gt; ENV['SECRET_KEY']\n    }\n</code></pre>\n\n<p>I don't want to have size limitations, since it will hassle the user to resize his/her images.\nso, I put styles in for medium and thumb. \nHowever, the original file is still saved in s3.</p>\n\n<p>How do I avoid saving the original image?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13235716,"title":"Not null fields for ActiveAttr","body":"<p>I'm having issues enforcing a field to not be nil within <code>ActiveAttr::Model</code>.</p>\n\n<p>Is there an elegant way of enforcing this constraint within the model instead of defining it in the controller? Or am I testing incorrectly for the scenario?</p>\n\n<p>Model:</p>\n\n<pre><code>class Message\n  include ActiveAttr::Model\n\n  attribute :name, :presence =&gt; true, :allow_nil =&gt; false, :allow_blank =&gt; false\n  attribute :email, :presence =&gt; true\n  attribute :content, :presence =&gt; true\n\n  validates_format_of :email, :with =&gt; /^[-a-z0-9_+\\.]+\\@([-a-z0-9]+\\.)+[a-z0-9]{2,4}$/i\n  validates_length_of :content, :maximum =&gt; 500\nend\n</code></pre>\n\n<p>RSpec:</p>\n\n<pre><code>module MessageSpecHelper\n  def valid_message_attributes\n    {\n       :name =&gt; \"Walter White\",\n       :email =&gt; \"walter@hailtheking.com\",\n       :content =&gt; \"I am the one who knocks\"\n   }\n  end\nend\n\nit \"should have error on name (alternate with nil)\" do \n  @message.attributes = valid_message_attributes.except(:name =&gt; nil)\n  @message.should have(1).error_on(:name)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","will-paginate","google-books"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13235115,"title":"Pagination and Google Books API","body":"<p>I am working on a Ruby on Rails project, which uses Google Books API. I managed to implement a pagination with <a href=\"https://github.com/mislav/will_paginate\" rel=\"nofollow\">will_paginate gem</a>, but I have a small problem. Google always returns different value of totalItems, which is quite confusing, because I am using it to evaluate the total number of pages.</p>\n\n<p>After researching I have found that <a href=\"http://productforums.google.com/forum/#!topic/books-api/Y_uEJhohJCc\" rel=\"nofollow\">this is not a bug</a>.</p>\n\n<p>So my question is maybe are there other ways to implement pagination or to evaluate total number of pages?</p>\n"},{"tags":["ruby-on-rails-3","heroku","redmine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13234885,"title":"Heroku Error H10 (App crashed) - Install Redmine 2.1","body":"<p>Although read many articles about this problem, I still couldn't solve those error,\nHere is a part of the heroku logs, if it's less-information, I would update others code of the red mine source code.</p>\n\n<pre><code>2012-11-05T14:02:54+00:00 app[web.1]: Plugins in vendor/plugins (/app/vendor/plugins) are no longer allowed. Please, put your     Redmine plugins in the `plugins` directory at the root of your Redmine directory (/app/plugins)    \n2012-11-05T14:02:54+00:00 app[web.1]: =&gt; Booting WEBrick    \n2012-11-05T14:02:54+00:00 app[web.1]: =&gt; Rails 3.2.8 app    lication starting in production on http://0.0.0.0:40115    \n2012-11-05T14:02:54+00:00 app[web.1]: =&gt; Call with -d to     detach    \n2012-11-05T14:02:54+00:00 app[web.1]: =&gt; Ctrl-C to shutd    own ser    ver    \n2012-11-05T14:02:54+00:00 app[web.1]: Exiting    \n2012-11-05T14:02:55+00:00 heroku[web.1]: Proc    ess exited with status 1    \n2012-11-05T14:02:55+00:00 heroku[web.1]: Stat    e changed from starting to crashed    \n2012-11-05T14:02:56+00:00 heroku[router]: Err    or H10 (App crashed) -&gt; GET ceciit    s.herokuapp.com/ dyno= queue= wait= service=     status=503 bytes=    \n2012-11-05T14:06:    04+00:00 heroku[web.1]: State changed from crashed to down    \n2012-11-05T14:06:    04+00:00 heroku[web.1]: Unidling    \n2012-11-05T14:06:    04+00:00 heroku[web.1]: State ch    anged from down to starting    \n2012-11-05T14:06:    07+00:00 heroku[web.1]: Starting     process with command `bundle exec rails server -p 3103`    \n2012-11-05T14:06:    12+00:00 app[web.1]: Plugins in     ve    \nndor/plugins (/ap    p/vendor/plugins) are no longer     al    lowed. Please, put your Redmine plugins in the `plugins` directory at the         root of your Redm    ine directory (/app/plugins)    \n2012-11-05T14:06:    12+00:00 app[web.1]: =&gt; Boot    ing WEBrick\n2012-11-05T14:06:    12+00:00 app[web.1]: =&gt; Rail    s 3.2.8 application starting in production on http://0.0.0.0:3103\n2012-11-05T14:06:    12+00:00 app[web.1]: =&gt; Call     with -d to detach\n2012-11-05T14:06:    12+00:00 app[web.1]: =&gt; Ctrl    -C to shutdown server\n2012-11-05T14:06:12+00:00 app[web.1]: Exiting    \n2012-11-05T14:06:13+00:00 heroku[web.1]: Process exited with status 1\n2012-11-05T14:06:13+00:00 heroku[web.1]: State changed from starting to crashed\n</code></pre>\n\n<p>I can't figure where is the reason that leads app crashed actually,\nThanks for answering...</p>\n"},{"tags":["ruby-on-rails-3","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12996790,"title":"Override html in active_admin gem","body":"<p>I wanna override html code when working with active_admin gem in Rails; because the nav-bar and many elements in these gem's views are different with my views (other pages). I hope that has a way to change html code without changing css manually! Thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13232186,"title":"How to open new Rails window in sidebar","body":"<p>I am using Rails 3/Bootstrap/JQuery UI.\nI have a create action which requires the user to enter some parameters before submitting.\nI have tried a Javascript JQuery UI Dialog Modal Form, but that doesn't make use of the already-written action code.\nThe problem is that the user doesn't like having a completely new window open (and then having to hit Back)</p>\n\n<p>So I would like to open the action, but do so in a sidebar, rather than a new window.</p>\n\n<p>What is the best practice for this in Rails 3?</p>\n\n<p>Adding more clarification.\nThe \"action\" I meant is a modal dialog where I collect the parameters which are needed for the create.\nI would like to put that \"modal dialog\" into a sidebar.\nInstead, right now, I open the \"modal dialog\" as a completely new window, and then the user clicks Create, and the new object is created.</p>\n\n<p>I think my main question is - how do I open \"new window in a sidebar\"?</p>\n\n<p>Added edit:\nHere is the code for the button the user is going to push: (to add a Cat to an existing Client)</p>\n\n<pre><code>&lt;%= link_to \"New Cat\", new_client_cat_path(@client), :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>Now, here is cats/new.html.erb:</p>\n\n<pre><code>&lt;h2&gt;New Cat&lt;/h2&gt;\n&lt;%= render \"form\" %&gt;\n&lt;%= link_to \"Cancel\", @client, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>and then here is cats/_form.html.erb:</p>\n\n<pre><code>&lt;%= form_for [@client, @cat] do |f| %&gt;\n&lt;%= f.error_messages %&gt;\n&lt;%= f.submit @submit_label, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What I want is for \"new.html.erb\" - the form to get the user's OK - to pop up in a sidebar, as opposed to opening a brand new window. I want to be able to put the \"new.html.erb\" into a small box which is located on the main page.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","recurly"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13231115,"title":"Rails and Recurly credit card form not updating expiration month and year info","body":"<p>I was creating a form to interact with Recurly on Rails.</p>\n\n<p>I have this view and this form:</p>\n\n<pre><code>&lt;h1&gt;&lt;%= t('payments.edit') %&gt; &lt;/h1&gt;\n\n\n&lt;%= render(:partial =&gt; 'shared/new_recurly_form', :locals =&gt; {:success_url =&gt; \"#{APP_URL}#{users_credit_card_path}\"}) %&gt;\n\n&lt;%= semantic_form_for current_user, :url =&gt; users_credit_card_path, :html =&gt; {:method =&gt; :put, :class =&gt; 'credit_card'} do |form| %&gt;\n\n    &lt;%= form.inputs do %&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= form.label :name %&gt;\n        &lt;%= form.text_field :name %&gt;\n      &lt;/div&gt;  \n      &lt;div class=\"field\"&gt;\n        &lt;%= form.label :first_surname %&gt;\n        &lt;%= form.text_field :surnames %&gt;\n      &lt;/div&gt;  \n      &lt;div class=\"field\"&gt;\n          &lt;%= label_tag :number, \"Credit Card Number \" %&gt;\n          &lt;%= text_field_tag :number %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n          &lt;%= label_tag :verification_value, \"Security Code on Card (CVV)\" %&gt;\n          &lt;%= text_field_tag :verification_value %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :month, \"Expiration month\" %&gt;\n      &lt;%= select_month(Date.today, :use_month_numbers =&gt; true) %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :year, \"Expiration year\" %&gt;\n      &lt;%= select_year(Date.today, :start_year =&gt; Time.now.year, :end_year =&gt; Time.now.year + 20) %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n  &lt;%= form.buttons do %&gt;\n    &lt;%= form.commit_button  t('confirm') %&gt;\n  &lt;% end %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>and its respective controller, credit_card_controller.rb</p>\n\n<pre><code>class Users::CreditCardsController &lt; ApplicationController\n\n  skip_before_filter :check_deactivated_user\n  protect_from_forgery :except =&gt; :create\n\n  def create\n    update\n  end\n\n  def edit\n    @user = current_user\n    @price_plan = current_user.price_plans.active.first\n  end\n\n  def update\n    begin\n        update_new_recurly_subscription\n    rescue Exceptions::RecurlyAccountCreateInvalidAccountException =&gt; e\n        puts \"CreditCardsController Exceptions::RecurlyAccountCreateInvalidAccountException\"\n        puts e.message\n    rescue Recurly::Resource::NotFound =&gt; e\n        puts \"CreditCardsController Recurly::Resource::NotFound Creating new account for user\"  \n        puts e.message  \n        begin\n            create_new_recurly_account\n            create_new_recurly_subscription         \n        rescue Exceptions::RecurlyAccountCreateInvalidAccountException =&gt; e\n            puts \"CreditCardsController inside find Recurly::Resource::NotFound\"\n            puts e.message\n            update_new_recurly_account\n            create_new_recurly_subscription\n        end \n    end\n\n    account = update_account_billing_info\n    account.billing_info = {\n        :first_name         =&gt; current_user.name,\n        :last_name          =&gt; \"#{current_user.surnames}\",\n        :number             =&gt; params[:number],\n        :verification_value =&gt; params[:verification_value],\n        :month              =&gt; params[:month],\n        :year               =&gt; params[:year]\n    }\n    puts \"Users::CreditCardsController update Billing info: #{account.billing_info.inspect}\"\n    account.billing_info.save\n    if current_user.credit_card_store!(account.billing_info)\n      if current_user.is_debtor?\n        flash[:alert] = t('flash.price_plans.payed_after_unpay')\n        render :edit\n      else\n        flash[:alert] = t('flash.credit_card.update.success')\n        render :success\n      end\n\n    else\n      flash[:failure] = t('flash.credit_card.update.failure')\n      render :edit\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>When I update the form, using the update function on the former controller, I am able to change the credit card number but I am not able to change the expiration month and the expiration year.</p>\n\n<p>What am I missing here? Why can I change the credit card number and not the month and the year interacting with Recurly?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13231357,"title":"Rails 3.2: multiple nested data from one model","body":"<p>How to create form and action for multiple nested attributes if:</p>\n\n<p>LineItem:</p>\n\n<pre><code>has_many :item_options, :dependent =&gt; :destroy\nhas_many :product_options, :through =&gt; :item_options\n</code></pre>\n\n<p>ProductOption:</p>\n\n<pre><code>belongs_to :product\nbelongs_to :option\nhas_many :item_options\nhas_many :line_items, :through =&gt; :item_options\n</code></pre>\n\n<p>ItemOption:</p>\n\n<pre><code>attr_accessible :line_item_id, :product_option_id  \nbelongs_to :line_item, :foreign_key =&gt; \"line_item_id\"\nbelongs_to :product_option,:foreign_key =&gt; \"product_option_id\"\n</code></pre>\n\n<p>When I'm creating new LineItem, I need to create new ItemOption(s). This is my form:</p>\n\n<pre><code>        &lt;%= form_for(LineItem.new) do |f| %&gt;\n        &lt;%= f.hidden_field :product_id, value: @product.id %&gt;\n        &lt;%= f.fields_for :item_options do |io| %&gt;\n            &lt;% @product.options.uniq.each do |o| %&gt;\n              &lt;%= o.name %&gt;: \n              &lt;%= io.collection_select :product_option_id, o.product_options.where(:product_id =&gt; @product.id), :id, :value %&gt;\n            &lt;% end %&gt;\n        &lt;%= f.submit %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>When I'm clicking on Add To Cart, I've get:</p>\n\n<p>ItemOption(#70296453751440) expected, got Array(#70296430421140)</p>\n\n<p>When Adding accepts_nested_attributes_for :item_options to LineItem, my selects not diplayed :(</p>\n\n<p>With </p>\n\n<pre><code>&lt;%= select_tag \"product_option_id\", options_from_collection_for_select(o.product_options.where(:product_id =&gt; @product.id), :id, :value) %&gt;\n#item_options not created:\nParameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"/WM5/MqPn1yCxjKWoJQmjfko2pR4RiYV0S2KeTTpA3w=\", \"line_item\"=&gt;{\"product_id\"=&gt;\"1\"}, \"product_option_id\"=&gt;\"5\", \"commit\"=&gt;\"add\"}\n</code></pre>\n\n<p>And last one, I've create action like this:</p>\n\n<pre><code>@line_item = LineItem.new(params[:line_item])\n@line_item.item_options.build \n....\n</code></pre>\n\n<p>Where am I wrong? :( I'm totally confused.\nps. similar question <a href=\"http://stackoverflow.com/questions/11199572/rails-3-2-has-many-through-form-submission\">Rails 3.2 has_many through form submission</a>\nThis is form:</p>\n\n<p><img src=\"http://habrastorage.org/storage2/117/b0b/c59/117b0bc59368fa5177efebce896c8670.png\"/></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13232568,"title":"Rails form not using explicit action","body":"<p>I'm a noob that's been struggling with this problem for longer than I care to admit.  I used to have a routing issue with my STI model, but now I think that's solved (thanks to SO).  </p>\n\n<p>My problem is once I update the form at : /kids/1/edit, instead of having the record saved, it seems to get the record again.  I know I'm missing something basic, yet after working the issue a long time the answer eludes me.  You can see I'm explicitly calling the kidupdate action with the form submission.</p>\n\n<p>thanks in advance.</p>\n\n<p>kidedit.html.erb</p>\n\n<pre><code>&lt;% provide(:title, \"Edit user\") %&gt; \n&lt;h1&gt;Update your profile&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span5 offset3\"&gt; \n    &lt;%= form_for(@kid, url: kidedit_path) do |f| %&gt;\n      &lt;#%= render 'shared/error_messages', object: f.object %&gt; \n\n      &lt;%= f.label :fname, \"First Name\" %&gt;\n      &lt;%= f.text_field :fname %&gt; \n\n      &lt;%= f.label :lname, \"Last Name\" %&gt;\n      &lt;%= f.text_field :lname %&gt; \n\n      &lt;%= f.label :email %&gt;\n      &lt;%= f.text_field :email %&gt; \n\n      &lt;%= f.label :type, \"Are you a Kid or Parent\" %&gt;\n      &lt;%= f.select :type, [['Kid','Kid'],['Parent','Parent']] %&gt;\n\n      &lt;%= f.label :password %&gt;\n      &lt;%= f.password_field :password %&gt;\n\n      &lt;%= f.label :password_confirmation, \"Confirmation\" %&gt;\n      &lt;%= f.password_field :password_confirmation %&gt;\n\n      &lt;%= f.submit \"Save changes\", class: \"btn btn-large btn-primary\", :controller =&gt; 'users', :action =&gt; 'kidupdate' %&gt;\n  &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>users_controller.rb</p>\n\n<pre><code>  def kidupdate\n\n    @kid = Kid.find(params[:id])\n    if @kid.update_attributes(params[:kid])\n      flash[:success] = \"Profile updated\"\n      sign_in @kid\n      redirect_to kidshow_path\n    else\n      render kidedit_path(@kid)\n    end\n  end\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Kidtunes::Application.routes.draw do\n\n  root to: 'static_pages#home'\n\n  match '/help',    to: 'static_pages#help'\n  match '/contact', to: 'static_pages#contact'\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new'\n  match '/signout',  to: 'sessions#destroy', via: :delete\n\n  match 'kids/:id' =&gt; 'users#kidupdate', via: :put, :as =&gt; :kidupdate\n  match 'kids/:id' =&gt; 'users#kidshow', via: :get, :as =&gt; :kidshow\n  match 'kids/:id/edit' =&gt; 'users#kidedit', :as =&gt; :kidedit\n\n  resources :users\n  resources :sessions, only: [:new, :create, :destroy]\n</code></pre>\n\n<p>Here's what's in the server log:</p>\n\n<pre><code>Started PUT \"/kids/1/edit\" for 127.0.0.1 at 2012-11-05 07:52:28 -0500\nProcessing by UsersController#kidedit as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"T8RqFt9lxdbZU+1cOh2E5yu2CFbVRDGmRcj2XdDN1ZU=\", \"user\"=&gt;{\"fname\"=&gt;\"Dante\", \"lname\"=&gt;\"Refford\", \"email\"=&gt;\"drefford@example.com\", \"type\"=&gt;\"Kid\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Save changes\", \"id\"=&gt;\"1\"}\n  Kid Load (0.2ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"type\" IN ('Kid') AND \"users\".\"id\" = ? LIMIT 1  [[\"id\", \"1\"]]\n  Rendered users/kidedit.html.erb within layouts/application (4.1ms)\n  Rendered layouts/_shim.html.erb (0.0ms)\n  User Load (0.2ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"remember_token\" = '1RZr3qfB6QSh42_jQ9qNWQ' LIMIT 1\n  Rendered layouts/_header.html.erb (2.5ms)\n  Rendered layouts/_footer.html.erb (0.3ms)\nCompleted 200 OK in 67ms (Views: 46.3ms | ActiveRecord: 1.0ms)\n</code></pre>\n\n<p>Routes</p>\n\n<pre><code>$rake routes\n       root        /                         static_pages#home\n       help        /help(.:format)           static_pages#help\n    contact        /contact(.:format)        static_pages#contact\n     signup        /signup(.:format)         users#new\n     signin        /signin(.:format)         sessions#new\n    signout DELETE /signout(.:format)        sessions#destroy\n  kidupdate PUT    /kids/:id(.:format)       users#kidupdate\n    kidshow GET    /kids/:id(.:format)       users#kidshow\n    kidedit        /kids/:id/edit(.:format)  users#kidedit\n      users GET    /users(.:format)          users#index\n            POST   /users(.:format)          users#create\n   new_user GET    /users/new(.:format)      users#new\n  edit_user GET    /users/:id/edit(.:format) users#edit\n       user GET    /users/:id(.:format)      users#show\n            PUT    /users/:id(.:format)      users#update\n            DELETE /users/:id(.:format)      users#destroy\n   sessions POST   /sessions(.:format)       sessions#create\nnew_session GET    /sessions/new(.:format)   sessions#new\n    session DELETE /sessions/:id(.:format)   sessions#destroy\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":10891275,"title":"Gem date_validator not working Ruby 1.9.3 Rails 3.2.1","body":"<p>I've just installed this gem with:</p>\n\n<pre><code>gem install 'date_validation'\n</code></pre>\n\n<p>And I can see it's properly installed, as it appears in the list when I use:</p>\n\n<pre><code>gem list\n</code></pre>\n\n<p>But when I try to validate the content of a field form as a date, I get this error:</p>\n\n<pre><code>ArgumentError in ProductesController#new\nUnknown validator: 'DateValidator'\n</code></pre>\n\n<p>I use this code to validate:</p>\n\n<pre><code>validates :data_caducitat, :date =&gt; { :after =&gt; Proc.new { Time.now } }\n</code></pre>\n\n<p>Any idea of what may be the problem?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13232001,"title":"how to modify devise to login user from terminal using different json?","body":"<p>I use  </p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/login.json  -d \"{\"user\" : { \"email\" : \"sample@gmail.com\", \"password\" : \"password\"}}\"\n</code></pre>\n\n<p>which gives the <code>token</code> and <code>email</code> id as output, but how can i get the same thing with</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/login.json  -d \"{ \"email\" : \"sample@gmail.com\", \"password\" : \"password\"}\"\n</code></pre>\n\n<p>how can i modify devise to get this working?</p>\n"},{"tags":["ajax","ruby-on-rails-3","image"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":18,"score":0,"question_id":13232540,"title":"Loading images with ajax (in rails)","body":"<p>Is there a way to either:</p>\n\n<p>load images via an ajax request </p>\n\n<p>or </p>\n\n<p>put a loading icon instead of where the image should be (or some other placeholder) until the image is fully loaded?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","full-text-search","railscasts"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1688,"score":3,"question_id":8505837,"title":"How to use Elasticsearch on Heroku","body":"<p>I've just finished watching both Railscasts' episodes on <a href=\"http://www.elasticsearch.org/\" rel=\"nofollow\">Elasticsearch</a>. I've also went ahead and implemented it into my rails application (3.1) and everything is working great. How I want to deploy my app to Heroku but I'm unsure how to get Elasticsearch working on <a href=\"http://heroku.com/\" rel=\"nofollow\">Heroku</a> (specifically on a cedar stack). </p>\n\n<p>Any help would be greatly appreciated!</p>\n"},{"tags":["ruby","ruby-on-rails-3","datetime","form-validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13223142,"title":"rails date_select title as a value","body":"<p>I am using date_select like so</p>\n\n<pre><code>&lt;%= f.label :birthday %&gt;\n&lt;%= f.date_select :birthday , :order =&gt; [:month, :day, :year] ,:start_year =&gt; 1900, :end_year =&gt; Time.now.year-10 %&gt;\n</code></pre>\n\n<p>I want to have the very first options in each field to be \"day\" \"month\" and \"year\" and which won't be valid</p>\n\n<p>How do I add these values?</p>\n"},{"tags":["ruby-on-rails-3","gem","ascii","pdf-writer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":661,"score":1,"question_id":9035666,"title":"pdf-writer invalid multibyte char (US-ASCII) expecting keyword_end content = \"%PDF-#{@version}\\n%âãÏÓ\\n\" Rails 3","body":"<p>I have a problem with the pdf-writer gem on a collaborative project I'm trying to run, I'm using <code>RVM</code>, <code>Ruby 1.9.2p180</code>, <code>Rails 3.1.0</code> on <code>Ubuntu 10.10</code>.</p>\n\n<p>I created a new <code>gemset</code> to install the required gems with Bundler, but when I try to run the app I get the fallowing error;</p>\n\n<pre><code>josethernandezc@DG965WH:~/Desktop/conest31$ rails s\n/home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:240:in `require': /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/pdf-writer-1.1.8/lib/pdf/writer.rb:712: invalid multibyte char (US-ASCII) (SyntaxError)\n/home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/pdf-writer-1.1.8/lib/pdf/writer.rb:712: invalid multibyte char (US-ASCII)\n/home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/pdf-writer-1.1.8/lib/pdf/writer.rb:712: syntax error, unexpected $end, expecting keyword_end\ncontent = \"%PDF-#{@version}\\n%âãÏÓ\\n\"\n                                ^\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:240:in `block in require'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:223:in `block in load_dependency'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:640:in `new_constants_in'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:223:in `load_dependency'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:240:in `require'\nfrom /home/josethernandezc/Desktop/conest31/config/application.rb:58:in `&lt;top (required)&gt;'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/railties-3.1.0/lib/rails/commands.rb:52:in `require'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/railties-3.1.0/lib/rails/commands.rb:52:in `block in &lt;top (required)&gt;'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/railties-3.1.0/lib/rails/commands.rb:49:in `tap'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/railties-3.1.0/lib/rails/commands.rb:49:in `&lt;top (required)&gt;'\nfrom script/rails:6:in `require'\nfrom script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>The problem is in the <code>pdf-writer-1.1.8/lib/pdf/writer.rb:712</code>, especifically; <code>content = \"%PDF-#{@version}\\n%âãÏÓ\\n\"</code></p>\n\n<p>Any suggestions would be great, I tried to Google the error but I have not found anything specific to pdf-writer....</p>\n"},{"tags":["ruby-on-rails-3","flash","swf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13230565,"title":"How do I embed sfw file in Rails 3 app using swf_fu?","body":"<p>I'm currently developing a Rails 3.2.3 app and I've been given some flash components that the client wants to the site (not my idea). I'm trying to embed them using \n<a href=\"https://github.com/marcandre/swf_fu\" rel=\"nofollow\">swf_fu</a> 2.0.3. I've included the gem and added </p>\n\n<pre><code>\\\\= require swf_fu\n</code></pre>\n\n<p>to my application.js file. </p>\n\n<p>My .swf files are at app/assets/swfs/foo.swf</p>\n\n<p>and then I try to embed the .swf with </p>\n\n<pre><code>&lt;%=  swf_tag \"swfs/foo\", :size =&gt; \"450x200\", :div_id =&gt; \"bar\" %&gt;\n\n&lt;div id=\"bar\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>I see Rails generating the following js</p>\n\n<pre><code>//&lt;![CDATA[\nswfobject.embedSWF('/assets/swfs/foo.swf', 'swfs/foo', '450', '200', '9.0.0', '/assets/expressInstall.swf', null, null, null, null);\n//]]&gt;\n</code></pre>\n\n<p>But other than that the page is blank. Any help will be greatly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","activerecord","select","model","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":9935259,"title":"Rails 3 + ActiveRecord - select with condition for association","body":"<p>I have <code>Car</code> (table <code>cars</code>) method that <code>has_many</code> owners (table <code>owners</code>). How can I choose all cars, that has no owners (== in the table <code>owners</code> is no one row with respective car's ID)?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13229191,"title":"Ruby on Rails methods","body":"<p>I an looking to delve a little deeper into Ruby On Rails and am interested in seeking more knowledge when it comes to methods. I am aware of the rails api documentation, but not being familiar with a lot of the terminology or where the specific methods can be used it is to big to be useful at this stage (hope that makes sense).</p>\n\n<p>What I was looking for is any particular methods I should pay attention too, more like most commonly used, just so I can practice with them for now, then once I have grasped a better understanding then i can look at more.</p>\n\n<p>Any resources or documentation that has helped anyone, please feel free to let me know</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","facebook","devise","omniauth","koala"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1313,"score":6,"question_id":6127305,"title":"Getting SSL Error Using Koala with Devise & OmniAuth in a Rails 3 App","body":"<p>I'm building a Rails 3 app using Devise/OmniAuth, and Koala and I'm getting the following SSL error:</p>\n\n<pre><code>OpenSSL::SSL::SSLError in Users/omniauth callbacksController#facebook\nSSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed\n</code></pre>\n\n<p>The code that causes this error is:</p>\n\n<pre><code>@graph = Koala::Facebook::GraphAPI.new(@token)\n@friends = @graph.get_connections(\"me\", \"friends\")\n</code></pre>\n\n<p>I am using Devise with OmniAuth to perform authentication, which works.  I then take the returned facebook token, and attempt to use it with Koala as shown above.  That is what causes this error.</p>\n\n<p>It's probably worth noting that I was receiving the same error with Devise &amp; OmniAuth initially. There are a few topics about this error, and I was able to solve it, by setting up my config/initialisers/devise.rb with,</p>\n\n<pre><code>config.omniauth :facebook, APPID, APPKEY, {:client_options =&gt; {:ssl =&gt; {:ca_file =&gt;  \"/opt/local/share/curl/curl-ca-bundle.crt\"}}} \n</code></pre>\n\n<p>I am guessing that I need to supply a similar configuration for Koala so that it knows where to retrieve the local ca_file.  I can't find any indication of how to do so in the documentation though.  Any ideas on how to do this, or how to avoid the error in general?</p>\n\n<p>My dev environment is OSX.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13228604,"title":"Rails LEFT OUTER JOIN to load multiple models","body":"<p>I have a model called Entry that has_many :entry_states. EntryState has an attribute called :read.</p>\n\n<p>I want to get all entries whether or not there is an entry_state so I think a LEFT OUTER JOIN is the best way to go see <a href=\"http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html\" rel=\"nofollow\">Left outer join on Coding Horror</a></p>\n\n<p>However I also want to include an attribute of EntryState in the result. So I have a query that looks like:</p>\n\n<pre><code>entries = Entry.select('entries.*, entry_states.read').\njoins(\"LEFT OUTER JOIN entry_states ON entries.id = entry_states.entry_id AND entry_states.user_id = #{user_id}\")\n</code></pre>\n\n<p>The problem with this is the entry_states object is not available after this.</p>\n\n<p>I can get the read state like:</p>\n\n<pre><code>entries.first.read\n&gt;&gt; t\n</code></pre>\n\n<p>Which gives me the raw column value, but this is a boolean column so it would be great to get back <code>true</code> or <code>false</code></p>\n\n<p>What would be even better is if I could get the whole EntryState object. I've tried using .includes(:entry_state), but I have not found a way to include the outer join condition of <code>AND entry_states.user_id = #{user_id}</code></p>\n"},{"tags":["css","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13222828,"title":"Rendering instance variables in the view -rails 3","body":"<p>I am trying to figure out how to render the same view for each instance of my class when outputting to the view</p>\n\n<p>heres my example</p>\n\n<p>I have an app where you can record your own recipes and in an area called \"my recipes\" view all recipes entered. So far I can render the view for one instance in the style i want it presented</p>\n\n<pre><code> &lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n   &lt;ul class=\"thumbnails\"&gt;\n    &lt;li class=\"span4\"&gt;\n     &lt;div class=\"thumbnail\"&gt;\n     &lt;% @recipes.each do |r| %&gt;\n      &lt;%= image_tag r.avatar.url(:medium)%&gt;\n      &lt;h3 class=\"center\"&gt;&lt;a href=\"#\"&gt;&lt;%= r.dish_name %&gt;&lt;/a&gt;&lt;/h3&gt;\n      &lt;p&gt;Description of dish&lt;/p&gt;\n   &lt;/div&gt;\n  &lt;/li&gt;\n  &lt;% end %&gt;\n  &lt;/ul&gt;    \n &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>In my controller I have this</p>\n\n<pre><code>  def my_recipes\n\n @recipes = current_user.recipes if current_user.recipes #show recipes if the user has  any recipes\n\n end\n</code></pre>\n\n<p>How do i get every instance to render in the same view, ie as i have specified above/ Sure this is simple but cannot figure this out tonight</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","whenever"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13227855,"title":"Using whenever gem to schedule a cron job","body":"<p>I'm testing whenever to figure out how to use it and am running into trouble even after reading the Github documentation.</p>\n\n<p>I simply want to update the attributes of my model like this (config/schedule.rb)</p>\n\n<p>set :output \"/log/today.log\"</p>\n\n<pre><code>every 10.seconds do\n  runner \"Example.update_all(sample: Time.now)\"\nend\n</code></pre>\n\n<p>I am neither seeing a log file nor seeing the model attributes updated.</p>\n\n<p>Is there anything I am not doing correctly?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","cucumber","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13114901,"title":"test popups with cucumber/capybara in Ruby on Rails","body":"<p>I am writing tests to test that both affirming and dismissing a conformation popup work. However, I get the error:</p>\n\n<pre><code>And I dismiss popup                                     # features/step_definitions/web_steps.rb:74\n  undefined method `switch_to' for #&lt;Capybara::RackTest::Browser:0xa6f0dec&gt; (NoMethodError)\n  ./features/step_definitions/web_steps.rb:75:in `/^I confirm popup$/'\n  features/add_session.feature:121:in `And I confirm popup'\n</code></pre>\n\n<p>when running my tests.</p>\n\n<p>The steps in my .features files look something like this:</p>\n\n<pre><code>And I press \"Delete\"\nAnd I confirm popup\n</code></pre>\n\n<p>Within web_steps.rb, I have the following defined:</p>\n\n<pre><code>When /^I confirm popup$/ do\n  #page.evaluate_script('window.confirm = function() { return true; }')\n  #page.click('OK')\n  page.driver.browser.switch_to.alert.accept\n  #popup.confirm \nend\n\nWhen /^I dismiss popup$/ do\n  page.driver.browser.switch_to.alert.dismiss\n  #page.evaluate_script('window.confirm = function() { return true; }')\n  #page.click('Cancel')\n  #popup.dismiss\nend\n</code></pre>\n\n<p>I am using the prickle gem which I have included as follows in my Gemfile:</p>\n\n<pre><code>group :test do\n  gem 'cucumber-rails'\n  gem 'prickle'\nend\n</code></pre>\n\n<p>And I added a couple lines to my Gemfile as outlined <a href=\"https://github.com/ExtractMethod/prickle#configuration\" rel=\"nofollow\">here</a> to include prickle. I initially had it as World do, like they show on the github page, but that was giving me errors since World was being used twice (the other time in the cucumber library). Here are the lines I added to my env.rb file:</p>\n\n<pre><code>require 'prickle/capybara'    # require\n\nmodule Prickle_helper\n  include Capybara::DSL\n  include Prickle::Capybara  # include  Prickle\nend\n\nWorld(Prickle_helper)\n</code></pre>\n\n<p>Any ideas as to what could be causing my errors? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13226328,"title":"Rails nested model creation not respecting validation constraints","body":"<p>I have a Customer model that has_many polymorphic Address objects, like so:</p>\n\n<p>Customer Model:</p>\n\n<pre><code>class Customer &lt; ActiveRecord::Base\n  has_many :mailing_addresses, :as =&gt; :addressable, :class_name =&gt; 'Address', dependent =&gt; :destroy\n  accepts_nested_attributes_for :mailing_addresses\n\n\n  validates :mailing_addresses, :presence =&gt; true\n  validates_associated :mailing_addresses\nend\n</code></pre>\n\n<p>Address Model:</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :addressable, :polymorphic =&gt; true\n\n  validate  :validate_quota\n  private\n  def validate_quota\n    case addressable_type\n  when \"Customer\"\n    customer = Customer.find(addressable_id)\n    if customer.mailing_addresses.size &gt;= 3\n      puts \"Adding too many records\"\n      errors.add(:addressable, \"Too many records\")\n    end\n  end\nend\n</code></pre>\n\n<p>I am also using RSpec to test that the quota constraint is respected.  So this spec passes, for example:</p>\n\n<pre><code>it \"observes quota limit\" do\n  customer = FactoryGirl.create(:customer, :number_of_mailing_addresses =&gt; 3)\n  expect {\n    address = FactoryGirl.create(:mailing_address, :addressable =&gt; customer)\n  }.to raise_error\n  customer.mailing_addresses.count.should eq(3)\nend\n</code></pre>\n\n<p>Which is good.  However, this fails horribly:</p>\n\n<pre><code>it \"fails add if already 3 addresses\" do\n  customer = FactoryGirl.create(:customer, :number_of_mailing_addresses =&gt; 3)\n  expect {\n    customer.mailing_addresses.create( FactoryGirl.attributes_for(:mailing_address).except(:addressable) )            \n  }.to raise_error\nend\n</code></pre>\n\n<p>I can even see in the spec output that the Address validation is failing, but for some reason it doesn't raise an error in \"customer.mailing_addresses.create()\", nor does that failed validation prevent the 4th Address model from saving to the database.</p>\n\n<p>What am I missing?</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13226230,"title":"How can I tell rails where to look for a specific template?","body":"<p>I have an model called Purchase.rb. each purchase is created through a form as follows. </p>\n\n<pre><code>&lt;%= form_for(@purchase) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :content, placeholder: \"Describe something you are interested in buying.\", :maxlength=&gt;\"254\" %&gt;\n    &lt;%= f.file_field :photo %&gt;\n\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>when they are created they are displayed with a partial stored in app/views/purchases/_purchase.html.erb. To add photos, I have put </p>\n\n<pre><code>&lt;%= form_for(@purchase) do |f| %&gt;\n    &lt;%= f.file_field :photo %&gt;\n    &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>in the purchase itself. I am using paperclip. So the idea is that people can click on a field that is part of the purchase and add a photo to the view. </p>\n\n<p>the error I get says </p>\n\n<pre><code>Missing template purchases/users#show, application/users#show with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee]}. Searched in: * \"/home/alex/rails_projects/tradespring!/app/views\"\n</code></pre>\n\n<p>I want it to look at app/views/users#show, not app/views/purchases/users#show</p>\n\n<p>edit:</p>\n\n<p>here is the show action of the userscontroller:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n\n  def show\n    @user = User.find(params[:id])\n    @purchases= @user.purchases\n    @sales= @user.sales\n    @purchase=Purchase.new\n    @sale=Sale.new\n  end\n</code></pre>\n\n<p>and here is the routes.rb</p>\n\n<pre><code>Tradespring::Application.routes.draw do\n  resources :users do\n    resources :pcomments\n    resources :scomments\n  end\n  resources :sessions, only: [:new, :create, :destroy]\n  resources :purchases do\n    resources :pcomments\n  end\n  resources :sales do\n    resources :scomments\n  end\n\n  get \"static_pages/home\"\n\n  get \"static_pages/about\"\n\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new' \n  match '/about',   to: 'static_pages#about'\n  match '/signout', to: 'sessions#destroy', via: :delete\n\n  root to: 'static_pages#home'\n</code></pre>\n\n<p>finally, here is the what I want to happen when I submit the picture form. Im not 100% sure it should be under update. </p>\n\n<pre><code>class PurchasesController &lt; ApplicationController\n def update\n    @purchase = Purchase.find(params[:id])\n    if @purchase.update_attributes(params[:purchase])\n      flash[:success] = \"Picture added\"\n\n      redirect_to :back\n    else\n      render 'users/show'\n    end\n  end\n</code></pre>\n\n<p>also here is the app/views/user/show.html.erb</p>\n\n<pre><code>&lt;% provide(:title, @user.name) %&gt;\n&lt;p&gt;\n&lt;%= mail_to(@user.email, name=\"email this user\", :encode =&gt; \"javascript\") %&gt;\n&lt;/p&gt;\n\n&lt;div id=\"purchases\"&gt;\n\n&lt;%= form_for(@purchase) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :content, placeholder: \"Describe something you are interested in buying.\", :maxlength=&gt;\"254\" %&gt;\n    &lt;%= f.file_field :photo %&gt;\n    &lt;p1&gt; Note: There is a 254 character limit. Be sure to include useful information such as product specifications, how much you are willing to pay, and shipping info (where you live, if you want to pick it up locally, ect.). Further detail is best left to email.&lt;/p1&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n\n&lt;% if @user.purchases.any? %&gt;\n      &lt;h3&gt;Purchases (&lt;%= @user.purchases.count %&gt;)&lt;/h3&gt;\n      &lt;ol class=\"purchases\"&gt;\n        &lt;%= render @purchases %&gt;\n      &lt;/ol&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n\n\n&lt;div id=\"sales\"&gt;\n\n&lt;%= form_for(@sale) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :content, placeholder: \"Describe something you are interested in selling.\", :maxlength=&gt;\"254\" %&gt;\n    &lt;p1&gt; Note: There is a 254 character limit. Be sure to include useful information such as product specifications, price, payment methods accepted, and shipping info (where you live, if you are willing to ship it, ect.). Further detail is best left to email. &lt;/p1&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n\n&lt;% if @user.sales.any? %&gt;\n      &lt;h3&gt;Sales (&lt;%= @user.sales.count %&gt;)&lt;/h3&gt;\n      &lt;ol class=\"sales\"&gt;\n        &lt;%= render @sales %&gt;\n      &lt;/ol&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13226167,"title":"check Cookies are disabled or not in ruby on rails","body":"<p>I m developing web application using Ruby on Rails. I want to check whether cookies are enabled or not. If not then i m displaying an error message and user cant proceed further.</p>\n\n<p>====>>for this in application_controller i did this..\n    before_filter :cookies_required\n    def cookies_required\n        return true unless cookies[\"_no_app\"].blank?<br>\n        render :template => \"shared/cookies_required\", :layout => \"login\"\n    end</p>\n\n<p>====>>And the code in shared/cookies_required.html.erb is...</p>\n\n<pre><code>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\"&gt;\n&lt;%= stylesheet_link_tag \"login.css\"%&gt;\n&lt;head&gt;\n    &lt;style type=\"text/css\"&gt;\n        body { background-color: #fff; color: #666; text-align: center; font-family: arial, sans-serif; }\n        div.dialog {\n            width: 25em;\n            padding: 0 4em;\n            margin: 4em auto 0 auto;\n            }\n        h1 { font-size: 100%; color: #f00; line-height: 1.5em; }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;div class=\"dialog\"&gt;\n&lt;p&gt;&lt;font size=\"4\"&gt;Cookies are disabled. First enable it.&lt;/font&gt; &lt;/p&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>This code is working fynn... but problem is when the browser first loaded the page, displays error msg tht cookies are disabled, even if it is enabled...</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12969435,"title":"Ruby delete_if multiple values - only first value being deleted","body":"<pre><code>words.delete_if do |x|\n  x == (\"a\"||\"for\"||\"to\"||\"and\")\nend\n</code></pre>\n\n<p><code>words</code> is an array with many words. My code is deleting \"a\" but not deleting \"for\", \"to\" or \"and\".</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3","fullcalendar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13225617,"title":"FullCalendar, Time Zone Issues. Showing events at GMT +8","body":"<p>I have been facing this problem where full calendar shows my event at a time 8 hours later than the event data.\nI figured that it is due to my timezone.</p>\n\n<p>This is my trace message</p>\n\n<pre><code>Started GET \"/events?custom_param1=something&amp;custom_param2=somethingelse&amp;  start=1351958400&amp;end=1352563200&amp;   authenticity_token=XEXpcBRnQuEivJ2NWjR2+OZ+Uscypalxx+hqGTIiwZA=&amp;_=1352086291522\" for 127.0.0.1 at 2012-11-05 11:31:31 +0800\nProcessing by EventsController#index as JSON\n  Parameters: {\"custom_param1\"=&gt;\"something\", \"custom_param2\"=&gt;\"somethingelse\", \"start\"=&gt;\"1351958400\", \"end\"=&gt;\"1352563200\", \"authenticity_token\"=&gt;\"XEXpcBRnQuEivJ2NWjR2 OZ Uscypalxx hqGTIiwZA=\", \"_\"=&gt;\"1352086291522\"}\n  Event Load (0.5ms)  SELECT `events`.* FROM `events` WHERE (starts_at &gt; '2012-11-04T00:00:00+08:00') AND (ends_at &lt; '2012-11-11T00:00:00+08:00')\nCompleted 200 OK in 10ms (Views: 8.2ms | ActiveRecord: 0.5ms)\n</code></pre>\n\n<p>The problem here being the start time in Unix is Sat, 03 Nov 2012 16:00:00 GMT when I had set it to be 04 Nov 2012 0.00.00. </p>\n\n<p>Here are my codes</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  scope :before, lambda {|end_time| {:conditions =&gt; [\"ends_at &lt; ?\",   Event.format_date(end_time)] }}\n  scope :after, lambda {|start_time| {:conditions =&gt; [\"starts_at &gt; ?\", Event.format_date(start_time)] }}\n  def as_json(options = {})\n    {\n      :id =&gt; self.id,\n      :title =&gt; self.title,\n      :description =&gt; self.description || \"\",\n      :start =&gt; starts_at.rfc822,\n      :end =&gt; ends_at.rfc822,\n      :allDay =&gt; false,\n      :recurring =&gt; false,\n      :url =&gt; Rails.application.routes.url_helpers.event_path(id),\n      #:color =&gt; \"red\"\n    }\n\n  end\n\n  def self.format_date(date_time)\n    Time.at(date_time.to_i).to_time.iso8601\n  end\nend\n</code></pre>\n\n<p>changing ignoreTimeZone to true didn't work for me either.\nSo I would appreciate if someone could help me with it.</p>\n\n<p>Maybe something along the lines of parsing time?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":225,"score":2,"question_id":7210563,"title":"rake aborted! ERROR: must be owner of database","body":"<p>I am working through Michael Hartl's excellent <a href=\"http://ruby.railstutorial.org/chapters/modeling-and-viewing-users-one#sec%3auser_validations\" rel=\"nofollow\">tutorial</a> but when trying to prepare the test database with the command: \nbundle exec rake db:test:prepare\nI get this error message: </p>\n\n<p>ERROR:  must be owner of database sample_app_test...</p>\n\n<p>which I never got when using the development database, because I had created the following database role for my Rails app:</p>\n\n<p>CREATE ROLE demo_app WITH CREATEDB LOGIN</p>\n\n<p>(this is using Postgresql)</p>\n\n<p>Does anyone understand why this is failing in the test environment? \nTIA...</p>\n"},{"tags":["ruby-on-rails-3","sorting","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":340,"score":1,"question_id":12065592,"title":"Rails sorting associations with Ransack","body":"<p>first time poster. I am trying to sort a table of users using the Ransack gem and Kaminari for pagination. When I use name, id, etc. sorting works but when I try an association with posts_count, sorting breaks and won't work. Note: in the view, 'u.posts.count' work correctly. I have tried custom scopes in the users model, and creating custom objects for the search params but nothing seems to work. I think I am having trouble either in the default scope or the @search object not having the data. Need help!</p>\n\n<p>Here are some relevant snippets:</p>\n\n<p><strong>models/user.rb</strong></p>\n\n<pre><code>  has_many :posts, :dependent =&gt; :destroy \n</code></pre>\n\n<p><strong>models/post.rb</strong></p>\n\n<pre><code>  belongs_to :user \n\n  default_scope :order =&gt; 'post.created_at DESC'\n</code></pre>\n\n<p><strong>controllers/users_controller.rb</strong></p>\n\n<pre><code>  def index\n    @title = \"User Index\"\n    @search = User.search(params[:q]) # Ransack\n    @total_users = User.all.count\n    # .per(10) is the per page for pagination (Kaminari).\n    @users = @search.result.order(\"updated_at DESC\").page(params[:page]).per(10) #This displays the users that are in the search criteria, paginated.\n  end\n</code></pre>\n\n<p><strong>views/users/index.html.erb</strong></p>\n\n<pre><code>  ..\n  &lt;%= sort_link @search, :posts_count, \"No. of Posts\" %&gt; #Sort links at column headers\n  .. \n  &lt;% @users.each do |u| %&gt; #Display everything in the table\n    &lt;%= u.posts.count %&gt;\n  &lt;% end %&gt;\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3","jquery-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13225523,"title":"jQuery AJAX POST to Rails Controller. Error when doing each_with_index (TypeError can't convert Symbol into Integer)","body":"<p>I'm trying to save the position of a jQuery-UI sortable connected list to a Rails backend. I'm having trouble with the Rails Controller action when trying to save the parameters to database.  The error that I am getting is <code>TypeError (can't convert Symbol into Integer):</code></p>\n\n<p>The parameter from the Ajax POST request that I'm sending in looks like this which looks fine:</p>\n\n<pre><code>Activity:[{\"id\":\"65\",\"column\":\"48\"},{\"id\":\"65\",\"column\":\"48\"},{\"id\":\"67\",\"column\":\"48\"}]\n</code></pre>\n\n<p>My Rails controller action is this (I'm trying to update an Activity with an id of 'id' and updating the attributes position with 'position' and day_id with 'column':</p>\n\n<pre><code>  def sort\n    JSON.parse(params[:Activity]).each_with_index do |x, index|\n      id = x[\"id\"]\n      position = index+1\n      column = x[\"column\"]\n      Activity.update_all(position = position, day_id = column, id = id)\n    end\n    render nothing: true\n  end\n</code></pre>\n\n<p>I'm getting this error in  Terminal:</p>\n\n<pre><code>    Started POST \"/trips/sort\" for 10.0.2.2 at 2012-11-04 23:52:30 +0000\nProcessing by TripsController#sort as */*\n  Parameters: {\"Activity\"=&gt;\"[{\\\"id\\\":\\\"66\\\",\\\"column\\\":\\\"49\\\"},{\\\"id\\\":\\\"66\\\",\\\"column\\\":\\\"49\\\"},{\\\"id\\\":\\\"67\\\",\\\"column\\\":\\\"49\\\"}]\"}\nCompleted 500 Internal Server Error in 1ms\n\nTypeError (can't convert Symbol into Integer):\n</code></pre>\n\n<p>This is my jQuery AJAX call if helpful:</p>\n\n<pre><code>    jQuery -&gt;\n  $('[id*=\"day\"]').sortable(\n    connectWith: \".day\"\n    placeholder: \"ui-state-highlight\"\n    update: (event, ui) -&gt;\n      neworder = new Array()\n      $(this).children().each -&gt;\n        column = $(this).parent().attr(\"id\").match(/\\d+/)[0]\n        id = $(this).attr(\"id\").match(/\\d+/)[0]\n        neworder.push(\n          id: id\n          column: column\n        )\n      alert neworder\n      $.ajax\n        url: \"sort\"\n        type: \"POST\"\n        data: { Activity: JSON.stringify(neworder) }\n    ).disableSelection()\n</code></pre>\n\n<p>I've spent the past few hours on this and just can't figure it out.  I really appreciate the time and help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13225476,"title":"Controller method as placeholder","body":"<p>There's a controller method in Rails that I want to do nothing for now, so I write</p>\n\n<pre><code>def hide\nend\n</code></pre>\n\n<p>as a placeholder.</p>\n\n<p>There's a link on a page that invokes this controller. When I click on the link, it says</p>\n\n<pre><code>Missing template posts/hide with {:handlers=&gt;[:erb, :rjs, :builder, :rhtml, :rxml], :formats=&gt;[:html], :locale=&gt;[:en, :en]}\n</code></pre>\n\n<p>Is it possible to have a controller that really does nothing, and does not render any page (so the user can click on the link and nothing happens)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","imagemagick","paperclip","homebrew"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":13223973,"title":"Rails paperclip `is not recognized by the 'identify' command`","body":"<p>I am getting an error when trying to save a <code>png</code> to a model with a paperclip attachment.</p>\n\n<p>My <code>User</code> model:</p>\n\n<pre><code>class User &lt; ActieRecord::Base\n  attr_accessible :icon\n  has_attached_file :icon, :url =&gt; \"/system/users/icon/:hash.:extension\",\n    :hash_secret =&gt; \"superSecretHashSecret\",\n    :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\nend\n</code></pre>\n\n<p>Example of trying to set an icon:</p>\n\n<pre><code>u = User.last\nu.icon = open(Rails.root + \"spec/fixtures/files/example.png\")\nu.save\n</code></pre>\n\n<p>Example model error:</p>\n\n<pre><code>:icon =&gt; [\"/var/folders/43/810gn/T/example20121104-36855-1v7t136.png is not recognized by the 'identify' command.\"]\n</code></pre>\n\n<p>There are a number of people who have posted similar questions to this one, especially <a href=\"http://stackoverflow.com/questions/1996102/rails-paperclip-and-passenger-is-not-recognized-by-the-identify-command\">this one</a> but none of those solutions work for me.</p>\n\n<p>My command_path is set correctly:</p>\n\n<pre><code>O:~ $ which identify\n/usr/local/bin/identify\n</code></pre>\n\n<p>In <code>development.rb</code></p>\n\n<pre><code>Paperclip.options[:command_path] = \"/usr/local/bin/\"\n</code></pre>\n\n<p><strong>This still might be the problem though.</strong> \nWhen trying to use `identify directly I get the following error:</p>\n\n<pre><code>O:~ $ identify workspace/app/spec/fixtures/files/example.png \ndyld: Library not loaded: /usr/lib/libltdl.7.dylib\n  Referenced from: /usr/local/bin/identify\n  Reason: image not found\nTrace/BPT trap: 5\n</code></pre>\n\n<p><strong>Any suggestions as to what is going on here?</strong></p>\n\n<p>I have tried reinstalling ImageMagick</p>\n\n<pre><code>brew unlink imagemagick\nbrew install imagemagick\n</code></pre>\n\n<p>Others have recommended adding <code>Rmagick</code>. It is definitely not a requirement for using Paperclip and it also did not help.</p>\n\n<p>Another solution that has been suggested is removing the <code>:style</code> property. That isn't a solution though. I need to do the processing on the images.</p>\n\n<p>I have Paperclip working on another model in my project that handles documents that are not images/don't do any processing. So I know that it is probably related to that.</p>\n\n<p>Any other suggestions on how to address this problem?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13224854,"title":"Nested forms in rails for existing objects","body":"<p>In my app, I have a page where I want admin users to be able to update a particular characteristic of my \"Package\" model, which belongs to both the \"Order\" model and the \"Item\" model. It's a little complicated, but I basically want to present in a table all of the Packages belonging to a given Item, ordered in a particular way (that's what my packages_for_log method below does), with two blanks for updating the weight of the item. All the updates should ideally be submitted at once, with a single submit button at the bottom of the page. I've attempted a whole bunch of solutions, and my current one is below, but gives this error when I visit the page in my server:</p>\n\n<pre><code>undefined method `actual_lbs' for #&lt;ActionView::Helpers::FormBuilder:0x007ff67df6c9c8&gt;\n</code></pre>\n\n<p>The error's confusing to me, cause I was hoping that I was calling that method on the package instance, not a helper. Bit confused. At any rate, my code is below. The relevant section of the view:</p>\n\n<pre><code>&lt;% form_for(@item) do |a| %&gt;\n  &lt;% @item.packages_for_log.each do |p| %&gt;\n    &lt;%= a.fields_for p do |i| %&gt;\n     &lt;tr&gt;\n        &lt;td&gt;&lt;%= p.order.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= p.order.processed_notes %&gt;&lt;/td&gt;\n      &lt;% if p.order.user %&gt;\n        &lt;td&gt;&lt;%= \"#{p.order.user.name.first(3).upcase}-#{p.id}\" %&gt;&lt;/td&gt;\n      &lt;% else %&gt;\n        &lt;td&gt;&lt;%= p.order.id %&gt;&lt;/td&gt;\n      &lt;% end %&gt;\n        &lt;td&gt;\n          &lt;%= i.text_field :actual_lbs %&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;%= i.text_field :actual_oz %&gt;\n        &lt;/td&gt;\n          &lt;%= i.hidden_field :true_weight, value: (i.actual_lbs + i.actual_oz/16) %&gt;\n     &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Relevant section of the package.rb model file:</p>\n\n<pre><code> attr_accessible :order_id, :price, :true_weight, :actual_lbs, :actual_oz\n attr_accessor :actual_lbs, :actual_oz  # These two are virtual attributes for the above calc\n</code></pre>\n\n<p>And I added resources :packages to my routes file. </p>\n\n<p>Any idea what I'm doing wrong? It's important to me that I loop through to create a table based on \"p\" and then edit that same \"p\" object. Just not sure how to do it. Pretty new to Rails.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13224248,"title":"How to use form builder to add attribute to form helpers in Rails?","body":"<p>I am trying to build a form builder in Rails that adds a <code>disabled</code> attribute to <code>text_field</code> and <code>select</code> helpers. This is the simplified version of my code:</p>\n\n<pre><code>class LabelFormBuilder &lt; ActionView::Helpers::FormBuilder  \n  %w[text_field select].each do |method_name|\n    define_method(method_name) do |name, *args|\n      super(name, :disabled =&gt; true, *args)\n    end  \n  end\nend\n</code></pre>\n\n<p>With <code>text_fields</code> the attribute gets added properly but with <code>selects</code> things get a bit trickier and I keep getting <code>undefined method merge for #&lt;Array:0x10b5229a0&gt;</code> errors.</p>\n\n<p>This is my view code (again simplified): </p>\n\n<pre><code>&lt;%= f.label :name %&gt;\n&lt;%= f.text_field :name %&gt;      # works!\n\n&lt;%= f.label :person %&gt;\n&lt;%= f.select(:person_id, current_user.person_names, :prompt =&gt; 'Please select...') %&gt;  # does not work!\n</code></pre>\n\n<p>How can I get line 4 of my class above to work on <code>select</code> helpers as well?</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13224208,"title":"Is there a way, using paperclip, to upload and attach images to an object after it has been created?","body":"<p>The tutorials I have been reading about using paperclip all include something like this </p>\n\n<pre><code>&lt;% form_for @product, :html =&gt; { :multipart =&gt; true } do |form| %&gt;\n  &lt;ol class=\"formList\"&gt;\n    &lt;!-- Other fields go here... --&gt;\n    &lt;li&gt;\n      &lt;%= form.label :photo, \"Photo\" %&gt;\n      &lt;%= form.file_field :photo %&gt;\n    &lt;li&gt;\n      &lt;%= form.submit \"Submit\" %&gt;\n    &lt;/li&gt;\n  &lt;/ol&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This seems to me like you need to upload a photo before you click submit. On my site, I want users to be able to create a product, then afterwards if they want to add a photo, click on an upload photo button in the product view. Then the uploaded photo would be added to the product. Is this possible using paperclip or anything else? or do I need to have a separate photo/image model and submit it through that?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13224176,"title":"Rails namespacing error?","body":"<p>I have this in my <code>config/routed.db</code>:</p>\n\n<pre><code>namespace :admin do\n  resources :users\n  resources :events\nend\n</code></pre>\n\n<p>I generated the <code>User</code> model by using the scaffolding Rails provides, then I simply generated a admin/admin controller by using Rails' <code>generate</code> and simply moved all the user-related stuff into the admin sub-directories inside the controllers/views/helpers. Yes, I did have to add <code>admin_</code> in a few places and inside the form partial I had to change the <code>form_for(@user)</code> to <code>form_for([:admin, @user])</code>. </p>\n\n<p>When I try to create a new user (this is when I <code>POST</code> the user data) I get the following error message:</p>\n\n<pre><code>undefined method `user_url' for #&lt;Admin::UsersController:0x13f408e0&gt;\n</code></pre>\n\n<p>The application-level trace shows that the error is raised here:</p>\n\n<pre><code>app/controllers/admin/users_controller.rb:47:in `create'\n</code></pre>\n\n<p>The line of code where this error is raised:</p>\n\n<pre><code>format.html { redirect_to @user, :notice =&gt; 'User was successfully created.' }\n</code></pre>\n\n<p>The above line is inside the <code>respond_to</code> block.</p>\n\n<p>So, I have two questions: </p>\n\n<ol>\n<li>How do I fix this issue?</li>\n<li>Is there a smarter, better, rails-way of doing this?</li>\n</ol>\n\n<hr>\n\n<p>Also, bonus points if you suggest I re-do this in the <em>smarter, better, rails-way</em>! Well, I will do that anyway! :D</p>\n\n<hr>\n\n<h2>Update</h2>\n\n<p>Oh, I almost forgot something that might be relevant! I also made <code>Admin::UsersController</code> inherit from <code>Admin::AdminController</code> (which normally in turn inherits from <code>ApplicationController</code>):</p>\n\n<p><code>Admin::UsersController &lt; Admin::AdminController</code></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13222720,"title":"How do I manually set error on a nested attribute in Rails 3?","body":"<p>How do I manually set error on a nested attribute in Rails 3?</p>\n\n<p>The following is some example model code that I tried and isn't working for me.</p>\n\n<pre><code>validate :matching_card_colors\n\nhas_many :cards\naccepts_nested_attributes_for :card\n\ndef matching_card_colors\n  color = nil\n  cards.each do |card|\n    if color.nil?\n      color = card.color\n    elsif card.color != color\n      card.errors.add :color, \"does not match other card colors\"\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13223482,"title":"How to \"exploit\" relationship data already stored in the database?","body":"<p>I am using Ruby on Rails v3.2.2. I have following model classes</p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  has_many :regions, :foreign_key =&gt; 'country_id'\nend\n\nclass Region &lt; ActiveRecord::Base\n  belongs_to :country, :foreign_key =&gt; 'country_id'\n  has_many :cities, :foreign_key =&gt; 'region_id'\nend\n\nclass City &lt; ActiveRecord::Base\n  belongs_to :region, :foreign_key =&gt; 'region_id'\nend\n</code></pre>\n\n<p>and <em>I would like to make a <code>City</code> <code>belongs_to :country</code></em>.</p>\n\n<p>I know that the simplest way to make that is to add a <code>country_id</code> database table column to the <code>City</code> database table and to state related ActiveRecord Associations, this way:</p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  # ...\n  has_many :cities, :foreign_key =&gt; 'country_id'\nend\n\nclass City &lt; ActiveRecord::Base\n  # ...\n  belongs_to :country, :foreign_key =&gt; 'country_id'\nend\n</code></pre>\n\n<p>However, in order to store <em>less database data</em>, I think I may \"use\" the data already stored in the <code>Region</code> table <em>since a city belongs to a region which in turn belongs to a country (this implies that a city belongs to a country)</em> but, in this case, I have no idea on how to properly state ActiveRecord Associations for <code>City</code> and <code>Country</code> so to \"exploit\" mentioned relationship informations implicitly present \"through\" the <code>Region</code> model class.</p>\n\n<p>How should I proceed?</p>\n\n<hr>\n\n<p><em>Note</em>: I am \"forcing\" to state the <code>belongs_to :country</code> ActiveRecord Association in the <code>City</code> model class because I would like to use the RoR <a href=\"http://guides.rubyonrails.org/association_basics.html#belongs_to-counter_cache\" rel=\"nofollow\"><code>:counter_cache</code></a> feature (available <em>only</em> for <code>belongs_to</code> associations) in order to count cities present in a country.</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":10,"favorite_count":37,"up_vote_count":62,"down_vote_count":0,"view_count":13367,"score":62,"question_id":4820549,"title":"How to empty DB in heroku","body":"<p>Im working on a RoR3 webapp on heroku. How do I empty the database?</p>\n"},{"tags":["ruby-on-rails-3","gem","bluehost"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13220329,"title":"Could not find gem 'uglifier' in the current bundle","body":"<p>My simple web app runs ok on Windows 7. Now I am moving it to bluehost.</p>\n\n<p>Getting this error when starting the app:</p>\n\n<pre><code>ActionView::Template::Error (cannot load such file -- uglifier\n</code></pre>\n\n<p>Trying to resolve it I have run 'gem install uglifier' and seems to mostly work:</p>\n\n<pre><code>SSH# gem install uglifier\nSuccessfully installed uglifier-1.3.0\n1 gem installed\nInstalling ri documentation for uglifier-1.3.0...\nunable to convert \"\\xC2\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII  for README.md, skipping\nInstalling RDoc documentation for uglifier-1.3.0...\nunable to convert \"\\xC2\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.md, skipping\n</code></pre>\n\n<p>But when I try to locate the gem, it is not found:</p>\n\n<pre><code>bundle show uglifier\n</code></pre>\n\n<p>yields:\n    Could not find gem 'uglifier' in the current bundle</p>\n\n<p>Gemfile includes the following:</p>\n\n<pre><code>group :assets do\n  gem 'therubyracer'\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n</code></pre>\n\n<p>and Gemfile.lock shows that the uglifier gem is installed:</p>\n\n<pre><code>uglifier (1.3.0)\n</code></pre>\n\n<p>$PATH information:</p>\n\n<pre><code>/usr/local/jdk/bin:/home4/mychairs/perl5/bin:/usr/lib64/qt-3.3/bin:/home4/mychairs/perl5/bin:/ramdisk/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11R6/bin:/home4/mychairs/ruby/gems/bin:/home4/mychairs/ruby/gems:/home4/mychairs/bin\n</code></pre>\n"},{"tags":["ruby-on-rails-3","multi-tenant"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13223780,"title":"Multitenancy with scopes – should join tables have tenant_id column?","body":"<p>I'm developing a SaaS using multitenancy with scopes, following this <a href=\"http://railscasts.com/episodes/388-multitenancy-with-scopes\" rel=\"nofollow\">Railscasts</a> (<a href=\"https://github.com/railscasts/388-multitenancy-with-scopes/tree/master/forum-after/\" rel=\"nofollow\">soure code here</a>).</p>\n\n<p>The idea of this approach is adding a tenant_id column to every table for every model and then scope every model as follows:</p>\n\n<pre><code>default_scope { where(despacho_id: Tenant.current_id) }\n</code></pre>\n\n<p>So far, so good. My question now is: <strong>should the join tables for a has_and_belongs_to_many relationship have a tenant_id column?</strong></p>\n\n<p>Since those tables don't have models associated I can't uses scopes with them. However in most articles I've read about single/shared schema multi-tenant apps they always mention that a tenant_id column needs to be added to every table.</p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","debugging","rack"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1258,"score":4,"question_id":7352635,"title":"Is there any debug toolbar for Rails 3.x","body":"<p>I used <a href=\"https://github.com/brynary/rack-bug\" rel=\"nofollow\">Rack::Bug</a> more than one year ago, now I'd like to use it with a new Rails 3.1 project. I tried to install it, both the master and rails3 branches, but with no luck.</p>\n\n<p>Also tried <a href=\"https://github.com/brynary/rack-bug/network\" rel=\"nofollow\">some github forks</a> but they did not work either.</p>\n\n<p>Is there any alternative with the same features?</p>\n\n<p>P.S. I already know newrelic and its <a href=\"https://support.newrelic.com/help/kb/ruby/developer-mode\" rel=\"nofollow\">developer mode</a>, just looking for something else, more similar to Rack::Bug</p>\n\n<p>Here is a little screen shoot of what is capable of (the green toolbar with debugging informations)</p>\n\n<p><img src=\"http://i.stack.imgur.com/QWSZ2.jpg\" alt=\"rack bub\"></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13222769,"title":"Not able to remove attachment","body":"<p>Looks like it's a known issue but i'm not able to find any solution nor any dirty fix to make it working. The thing is i'm not able to remove attachments uploaded using Carrierwave plugin. </p>\n\n<p>I'm using a special form field called <code>:remove_avatar</code> which should remove a avatar file and clear avatar column but the only thing it does is deleting the file, the file reference in avatar column still exists.</p>\n\n<p>I was trying to remove it in any possible way but without a luck. </p>\n\n<h3>update_attributes</h3>\n\n<p>using <code>u.update_attributes( :avatar =&gt; \"\" )</code> is not removing the reference</p>\n\n<h3>save()</h3>\n\n<pre><code>u = User.find(int)\nu.avatar = \"\"\nu.save\n</code></pre>\n\n<p>is also not removing the reference</p>\n\n<h3>remove_avatar = true</h3>\n\n<pre><code>u.remove_avatar = true\nu.save\n</code></pre>\n\n<p>not working</p>\n\n<h3>remove_avatar!</h3>\n\n<pre><code>u.remove_avatar!\nu.save\n</code></pre>\n\n<p>not working</p>\n\n<h3>f.check_box :remove_avatar</h3>\n\n<p>not working</p>\n\n<p>By 'not working' i mean that the file is removed from filesystem but the reference persists.</p>\n\n<p>Cany you please provide me ANY tip i can use to make it working again? It can be something dirty, this bug shown a day before my deadline and i feel quite desperate. Thanks in advance.</p>\n\n<p>Ruby: 1.8.7<br>\nRails: 3.2.6<br>\nCarrierwave: master branch from git repo</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13223089,"title":"Specify folder for download","body":"<p>In my Rails controller I have the line</p>\n\n<pre><code>send_file(\"#{Rails.root}/test/image.png\")\n</code></pre>\n\n<p>I'd like my web page to have a textbox, that the user can fill in a directory such as <code>C:/OldPictures/All/</code>, and then when the user clicks a link which invokes the controller, it also reads the directory in the textbox, and downloads the file <code>image.png</code> to the specified directory. Can I make it so?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","session","authlogic","session-fixation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":140,"score":4,"question_id":12263152,"title":"Rails 3 with Authlogic and calling reset_session","body":"<p>The <a href=\"http://guides.rubyonrails.org/security.html#session-fixation-countermeasures\" rel=\"nofollow\">RoR Security Guide</a> states that you should \"issue a new session identifier and declare the old one invalid after a successful login\" using the reset_session method to counter session fixation.</p>\n\n<p>I haven't been able to find any guidance on calling reset_session when using Authlogic. Is it simply a case of including the method in the controller method (as below)? </p>\n\n<p>I'm just concerned about causing problems for Authlogic as I can see both user_credentials and user_credentials_id keys and values in the session hash prior to calling reset_session.</p>\n\n<pre><code>class UserSessionsController &lt; ApplicationController\n\n  def create\n    @user_session = current_client.user_sessions.new(params[:user_session])\n    if @user_session.save\n      reset_session\n      flash[:success] = I18n.t(:msg_login_success)\n      redirect_back_or_default application_root_path\n    else\n      render :action =&gt; :new\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","padrino"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":11542840,"title":"From Padrino to Rails 3.2 - skinny controllers","body":"<p>I'm slightly lost in Rails 3.2. I've used to create skinny controllers in Padrino using methods like this:</p>\n\n<pre><code> 15   post :task, :provides =&gt; :js do\n 16     result = execute(params)\n 17     render \"home/task\"\n 18   end\n</code></pre>\n\n<p>Some methods does not exactly interacts with a model. In Rails 3.2, I cannot use helpers in controllers to make them clean (like Rails 2.x or Padrino). I've created a few methods like this one:</p>\n\n<pre><code> 10   def show                                                                                                                                               \n 11     @server = server_details                                                                                                                             \n 12     respond_with(@server) if request_match_server_address?                                                                                               \n 13   end     \n</code></pre>\n\n<p>But moved code from ServersController to ApplicationController, assuming it will be temporarily, and now application_controller is ugly and biggger (sure with three g's). </p>\n\n<p>How can I make my controllers beauty? Where is the right place to put methods like server_details?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":24,"score":-1,"question_id":13222685,"title":"Browse folder when downloading file","body":"<p>On my webpage, I have a link which, when clicked, invokes a Rails controller </p>\n\n<pre><code>send_file(\"#{Rails.root}/test/image.png\")\n</code></pre>\n\n<p>When I click on the link, it automatically downloads <code>image.png</code> into my Download folder. What I'd like instead is that it shows a pop-up \"Save File\" that allows me to browse the folders on my computer and choose where to save <code>image.png</code>. How can I do that?</p>\n"},{"tags":["regex","ruby-on-rails-3","routes","syntax-error"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13222382,"title":"Rails custom route with constraints - regexp anchor characters are not allowed in routing requirements","body":"<p>I have the following route:</p>\n\n<pre><code>  get 'users/:user_id/:name', to: 'profiles#show',\n    :constraints =&gt; { :name =&gt; /[a-zA-Z0-9_]+$/ }, as: 'user_profile'\n</code></pre>\n\n<p>Which produces the error:</p>\n\n<pre><code>Regexp anchor characters are not allowed in routing requirements: /[a-zA-Z0-9_]+$/\n</code></pre>\n\n<p>So I get that the ^ character isn't allowed, but not sure what character is producing this particular routing error.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13222142,"title":"Argument of send_file","body":"<p>I put this in my Rails controller</p>\n\n<pre><code>send_file('/public/images/rails.png')\n</code></pre>\n\n<p>but it gives error</p>\n\n<pre><code>Cannot read file /public/images/rails.png\n</code></pre>\n\n<p>even though the file is there. How can I fix it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rack","amazon-cloudfront","rack-cache"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13155335,"title":"Bypass Rack::Cache for requests coming from a CDN","body":"<p>I have a Rails 3.2 app, deployed to heroku.  I use caching with <a href=\"https://github.com/rtomayko/rack-cache/\" rel=\"nofollow\">Rack::Cache</a> and Amazon CloudFront.</p>\n\n<p>For Requests that are served via CloudFront (assets, mostly), the caching layer with Rack::Cache is redundant and I'd rather not use it there (memcached on heroku is <em>expensive</em>)</p>\n\n<p>What is a good way to skip Rack::Cache for these requests?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","squeel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13177615,"title":"ruby on rails join conditions (with squeel)","body":"<p>I'm trying to use Squeel to compare attributes among the joined tables along with a little math.</p>\n\n<p>Here's an example of the query:</p>\n\n<pre><code>Parent.joins{[child1, child2.grandchildren]}.\nwhere{grandchildren.birth_datetime &gt; Time.now - child1.age.years}\n</code></pre>\n\n<p>I get an error from Squeel saying \"TypeError: can't convert Squeel::Nodes::KeyPath into an exact number\"</p>\n\n<p>Anyone know what I'm doing wrong here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13221357,"title":"Create a controller and view","body":"<p>Hello I have the following models.</p>\n\n<p>The User Model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :email, :password, :password_confirmation\n  has_one :user_informations\n  has_secure_password\nend\n</code></pre>\n\n<p>The UserInformation Model:</p>\n\n<pre><code>class UserInformation &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :address, :address2, :business, :descripcion, :identification_number, :mobile_cell, :name, :phone_number\nend\n</code></pre>\n\n<p>Now I need to create the view and the controller to create and update the user information, and I have many questions:</p>\n\n<p>1) how can I generate the controller:</p>\n\n<blockquote>\n  <p>rails g controller UserInformations</p>\n</blockquote>\n\n<p>o </p>\n\n<blockquote>\n  <p>rails g controller UserInformation</p>\n</blockquote>\n\n<p>2) how my new, create and update action know the user ID.</p>\n\n<p>3) how can I set the routes for this user information</p>\n\n<p>Thanks. Maybe these are a basic question, but I'm new in rails and I don't know how to do all of this.</p>\n\n<p>Thanks again for your help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","rails-postgresql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13214494,"title":"PostgreSQL Error for Select Distinct in Rails","body":"<p>On Mysql it works correctly.</p>\n\n<blockquote>\n  <p>PG::Error: ERROR: for SELECT DISTINCT, ORDER BY expressions must\n  appear in select list LINE 1: ) ORDER BY\n  programs.rating DESC, program_sc... ^ :</p>\n</blockquote>\n\n<p>Query:</p>\n\n<blockquote>\n  <p>SELECT DISTINCT \"programs\".* FROM \"programs\" INNER JOIN\n  \"program_schedules\" ON \"program_schedules\".\"program_id\" =\n  \"programs\".\"id\" WHERE (programs.rating >= 5 AND\n  program_schedules.start >= '2012-11-03 23:14:43.457659') AND (ptype =\n  'movie') ORDER BY programs.rating DESC,\n  program_schedules.start DESC</p>\n</blockquote>\n\n<p>Rails code:</p>\n\n<blockquote>\n  <p>@data =\n  Program.joins(:program_schedules).where('programs.rating >= ?\n  AND program_schedules.start >= ?',5,\n  Time.now).order('programs.rating DESC,\n  program_schedules.start DESC').uniq</p>\n</blockquote>\n\n<p>I have tried with</p>\n\n<blockquote>\n  <p>Program.select(\"programs.*,\n  program_schedules.*).joins(:program_schedules).where(...</p>\n</blockquote>\n\n<p>but, in this way, when I'm going to read </p>\n\n<blockquote>\n  <p>@data.program_schedules</p>\n</blockquote>\n\n<p>I get a nil value (When I know there are no nil values)</p>\n\n<h2>PostgreSQL 9.2 (Heroku), Ruby 1.9.2</h2>\n\n<p>Some info about my DB:</p>\n\n<pre><code>class Program &lt; ActiveRecord::Base\n   has_many :program_schedules\nend\n\n\nclass ProgramSchedule &lt; ActiveRecord::Base\n  belongs_to :program\nend\n</code></pre>\n\n<p>Schema.db</p>\n\n<pre><code> create_table \"program_schedules\", :force =&gt; true do |t|\n        t.integer  \"program_id\"\n        t.datetime \"start\"\n  end\n\n  create_table \"programs\", :force =&gt; true do |t|\n    t.string  \"title\",\n    t.string  \"ptype\"\n  end\n</code></pre>\n\n<p><strong>EDIT:</strong>\nI don't need to order \"programs_schedules\" because I need all programs_schedules in my array related to that program.</p>\n"},{"tags":["javascript","ruby-on-rails-3","web-applications","oauth","oauth-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13219308,"title":"How to implement a web widget with OAuth 2.0","body":"<p>I want to create a web widget that will display information from my site.</p>\n\n<p>The widget will be included in the client's website HTML using JavaScript, and should only be usable for my clients -- web sites that were registered at my site.</p>\n\n<p>The information in the widget should be specific to the user who is currently visiting the client's site.</p>\n\n<p>So, I need to authenticate both the client (website owner) and the resource owner (website visitor). This seems to map nicely to OAuth 2.0, but I couldn't find a complete example or explanation for such an implementation.</p>\n\n<p>Any resources or pointers to such information will be appreciated.</p>\n"},{"tags":["ruby-on-rails-3","sprockets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":197,"score":0,"question_id":11351041,"title":"Sprockets::CircularDependencyError application.js has already been required","body":"<p>In my application, I receive a Sprockets::CircularDependencyError application.js has already been required. This affects every page in my application because none of the JS loads. Note - this error occurred after a fairly complex merge. </p>\n\n<p>My assumption (please correct me if I'm wrong) is that this error occurs because two different files require application.js. If so, in which files should I look to debug this error? How could I test my application to determine what files are already requiring application.js?</p>\n\n<p>Thank you very much for any help. I'd be more than happy to supply any pertinent information. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13219315,"title":"How to disable all form_for input fields in Ruby on Rails app?","body":"<p>I am trying to DRY up my Rails application a bit, so I would like to render a form in my <code>show</code> view but <em>disable</em> all input fields.</p>\n\n<pre><code>// show.html.erb\n\n&lt;%= form_for(@project) do |f| %&gt;\n  &lt;%= render 'fields', :f =&gt; f %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What would be the best way to do that?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails-3","devise","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13220218,"title":"Paperclip working on sign_out via devise","body":"<p>I've recently added paperclip to add avatar to the users.</p>\n\n<p>When a user sign out (using devise) I see this in the logs</p>\n\n<pre><code>Started DELETE \"/signout\" for 127.0.0.1 at 2012-11-04 17:23:15 +0200\nProcessing by Devise::SessionsController#destroy as HTML   Parameters:\n{\"authenticity_token\"=&gt;\"rHNBynyk546DcWTpGuARt2bdbSTtKPbw2ls+nDaihO8=\"}\nUser Load (1.0ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" =\n18 LIMIT 1    (0.0ms)  BEGIN [paperclip] Saving attachments.   \n(0.0ms)  COMMIT Redirected to http://localhost:3000/\n</code></pre>\n\n<p>my paperclip is really basic..</p>\n\n<p>this in user.rb</p>\n\n<pre><code>has_attached_file :avatar,\n    :storage =&gt; :s3,\n    :bucket =&gt; ENV['BUCKET'],\n    :s3_credentials =&gt; {\n      :access_key_id =&gt; ENV['ACCESS_KEY'],\n      :secret_access_key =&gt; ENV['SECRET_KEY']\n    }\n</code></pre>\n\n<p>on user/_form.html.erb</p>\n\n<pre><code>&lt;%= f.file_field :avatar %&gt;\n</code></pre>\n\n<p>and on users/show.html.erb</p>\n\n<pre><code>&lt;%= image_tag @user.avatar.url %&gt;\n</code></pre>\n\n<p>what is paperclip doing there?\nIs there a way to debug this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":85,"score":1,"question_id":11189139,"title":"How to keep a transient variable as part of ActiveRecord","body":"<p>I would like to show a variable (which is actually a List) as part of f.select(..) function in Rails3.2, so that the selected value is stored in a different attribute in the ActiveRecord object. How do I declare the above List variable as a transient variable in ActiveRecord, so that ActiveRecord doesn't try to store this.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activesupport"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13218123,"title":"Activesupport titlecase() with bang (.titlecase!)?","body":"<p>I currently have a string with customer names that I am titlecasing with:</p>\n\n<pre><code>@customer_name = @customer_name.titlecase\n</code></pre>\n\n<p>But this seems a bit long-winded. When I try to do:</p>\n\n<pre><code>@customer_name.titlecase!\n</code></pre>\n\n<p>I get a no method error. Does <code>titlecase!</code> exist? It seems odd that there wouldn't be a way to do this, since there is a <code>downcase!</code>, for example.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13219184,"title":"Rails abstract ajax callbacks for resources","body":"<p>What I have are several js files for each of my resources using ajax:</p>\n\n<pre><code>create.js.erb\nshow.js.erb\nupdate.js.erb\ndestroy.js.erb\n</code></pre>\n\n<p>What I am trying to do is abstract this so I don't have these hooks in every single controller. The two ideas I can see:</p>\n\n<p>1) bind requests and place in master js file under <code>assets/javascripts</code>. I'd much prefer this method, but I'm stuck on how to bind these above actions.</p>\n\n<p>2) add these files under <code>views/shared/</code> and trigger them from within the controllers.</p>\n\n<p>What would be the preferred way of abstracting the above? </p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","json"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13219201,"title":"I woud like to tag my posts, using javascript and json","body":"<p>I am trying to generate a tagging system similar to SO. I am using the Select2 gem. When the user initially goes to the new page the form should only display their tags. When on the page they can create new tags by typing out tag names and separating them by spaces or commas. </p>\n\n<p>My issues is that when I go to submit this form, the tags are not properly linking to an ID. I get the error \"Couldn't find Tag with id = 0\" or if I have the number 12 as the tag, \"Couldn't find Tag with id = 12\"</p>\n\n<p>A user has_many tags; a post has many taggings; a post has many tags through taggings; a tag has many taggings; a tag has many posts through taggings; a tag belongs to an user</p>\n\n<p>How could I specify the tag id name and only have the tag name show up?</p>\n\n<p>My Tags Controller looks like this</p>\n\n<pre><code>  respond_to :json\n  def index\n    @tags = current_user.tags\n    respond_with(@tags.map{|tag| {:id =&gt; tag.id, :name =&gt; tag.name, :user_id =&gt; tag.user_id} })\n  end\n</code></pre>\n\n<p>My JavaScript looks like this</p>\n\n<pre><code>var items = [];\n$.getJSON('http://localhost:3000/tags.json', function(data) {\n        $.each(data, function(i, obj) {\n             return items.push(obj.name);\n        });\n   $(\"#post_tag_ids\").select2({\n        tags: items,\n        tokenSeparators: [\",\", \" \"]\n        });\n   });\n</code></pre>\n\n<p>My form looks like this</p>\n\n<pre><code>= semantic_form_for([@user, @post], :html =&gt; { :class =&gt; 'form-horizontal' }) do |f|\n  = f.inputs do\n    = f.input :summary, :label =&gt; false, :placeholder =&gt; \"Title\"\n    = f.input :tag_ids, :as =&gt; :string, :label =&gt; false, :placeholder =&gt; \"Tags\", input_html: {:id =&gt; \"post_tag_ids\", :cols =&gt; 71}\n  = f.buttons do\n    .action\n  = f.commit_button :button_html =&gt; { :class =&gt; \"btn btn-primary\" }\n</code></pre>\n\n<p>My Post Controller looks a little like this</p>\n\n<pre><code>def create\n @post = Post.new(params[:post])\n @post.user = current_user\n @post.save\n @post.tag!(params[:tag_ids], current_user.id)\nend\n</code></pre>\n\n<p>My Post Model has a tag! method</p>\n\n<pre><code>def tag!(tags, user)\n  tags = tags.split(\",\").map do |tag|\n    Tag.find_or_create_by_name_and_user_id(tag, user)\n  end\nself.tags &lt;&lt; tags\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13218540,"title":"Rails abstract custom destroy method (or add exception to model errors by default)","body":"<p>What I am trying to do is return an error, instead of an exception, when a particular model cannot be destroyed. Currently, it raises <code>ActiveRecord::DeleteRestrictionError</code>, but that is not returned to a flash message, or added to the errors collection of the model. </p>\n\n<p>What I have done is setup this in my resourceful controller:</p>\n\n<pre><code>  def destroy\n    begin\n      resource.destroy\n    rescue ActiveRecord::DeleteRestrictionError =&gt; e\n      resource.errors.add(:base, e)\n    end\n  end\n</code></pre>\n\n<p>I'd rather not manage this within every single controller which requires this particular behavior. How can I abstract it? I can't see it being a good idea to overwrite the destroy method for <code>ActiveRecord::Base</code>, but maybe there won't be any gotchas?</p>\n\n<p>I'm using inherited_resources gem, so perhaps there is a way to answer this by extending that?</p>\n\n<p>One other idea I had was to extend <code>ActiveRecord::Base</code> using <code>ActiveSupport::Concern</code> (from here: <a href=\"http://stackoverflow.com/questions/2328984/rails-extending-activerecordbase\">Rails extending ActiveRecord::Base</a>) and then delegate the destroy method to a custom destroy on a model-to-model basis. Thoughts?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","hash","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13218378,"title":"Getting the contents of a hash","body":"<pre><code>{\"test_url\"=&gt;\"http://test.com/123.jpg\"} \n</code></pre>\n\n<p>is my output from</p>\n\n<pre><code>&lt;% @results.each do |t| %&gt;\n    &lt;%= t.image.extract!(\"test_url\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How can i just get the contents of test_url? so <a href=\"http://test.com/123.jpg\" rel=\"nofollow\">http://test.com/123.jpg</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":559,"score":1,"question_id":8047651,"title":"No Javascript runtime on windows when running rails server","body":"<p>I'm completely new to Ruby on Rails, and I'm having trouble setting it up on my <strong>Windows PC</strong>.  I have successfully followed the instructions on <a href=\"http://rubyonrails.org/download\" rel=\"nofollow\">http://rubyonrails.org/download</a>.  However, when I go to run the <code>rails server</code> command I come up with this output:</p>\n\n<pre><code>C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs/runtimes.rb:47:in `a\nutodetect': Could not find a JavaScript runtime. See https://github.com/sstephen\nson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs.rb:5:in\n `&lt;module:ExecJS&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs.rb:4:in\n `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_\nscript.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_\nscript.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-\nscript.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-\nscript.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-rails-3.1.1/lib/coffee-r\nails.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-rails-3.1.1/lib/coffee-r\nails.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:68:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:68:in `block (2 levels) in require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:66:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:66:in `block in require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:55:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:55:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler.rb:1\n22:in `require'\n        from C:/RoR/tickets/config/application.rb:7:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:52:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:52:in `block in &lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:49:in `tap'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:49:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>When i go to the website <a href=\"https://github.com/sstephenson/execjs\" rel=\"nofollow\">https://github.com/sstephenson/execjs</a> I'm still uncertain of how to proceed.  <strong>Can someone point me in the right direction (remember I'm a newbie)?</strong>  Thanks!</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","node.js","ruby-on-rails-3.1"],"answer_count":5,"favorite_count":18,"up_vote_count":31,"down_vote_count":0,"view_count":13322,"score":31,"question_id":7092107,"title":"Rails 3.1 error - Could not find a JavaScript runtime?","body":"<p>I created a new Rails project using <code>rails 3.1.0.rc4</code> on my local machine but when I try to start the server I get:\nCould not find a JavaScript runtime. See <a href=\"https://github.com/sstephenson/execjs\">here</a> for a list of available runtimes. (<code>ExecJS::RuntimeUnavailable</code>)</p>\n\n<p>Note: This is not about Heroku.</p>\n"},{"tags":["ruby-on-rails-3","ubuntu","undefined"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13218035,"title":"Undefined method `write_inheritable_attribute' for Rails","body":"<p>I work with ruby in ubuntu.<br>\nbut I have a problem when creating the project.</p>\n\n<pre><code>atmoner@atmoner:~$ rails new first_app\n/var/lib/gems/1.8/gems/rails-2.3.8/lib/rails_generator/options.rb:32:in `default_options': undefined method `write_inheritable_attribute' for Rails::Generator::Base:Class (NoMethodError)\n    from /var/lib/gems/1.8/gems/rails-2.3.8/lib/rails_generator/base.rb:90\n    from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require'\n    from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `require'\n    from /var/lib/gems/1.8/gems/rails-2.3.8/lib/rails_generator.rb:37\n    from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require'\n    from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `require'\n    from /var/lib/gems/1.8/gems/rails-2.3.8/bin/rails:15\n    from /usr/local/bin/rails:19:in `load'\n    from /usr/local/bin/rails:19\n</code></pre>\n\n<p>Version of rails:</p>\n\n<pre><code>atmoner@atmoner:~$ rails -v\nRails 2.3.8\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code> sudo gem install rails\n</code></pre>\n\n<p>But problem is same! I am completely block</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","methods"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":9798237,"title":"What is the difference in \"Processing by Contoller#method as */*\" and \"Processing by BillsController#show as HTML\"","body":"<p>All of my rails 3.2.2 ActiveRecord methods are being executed twice. I noticed that each execution is being processed differently, see the examples I grabbed from the console below...</p>\n\n<pre><code>Started GET \"/api/bills/Jeremy%20Fox\" for 127.0.0.1 at 2012-03-20 23:16:43 -0400\nProcessing by BillsController#show as HTML\n  Parameters: {\"username\"=&gt;\"Jeremy Fox\"}\n  BillsForUsers Load (2.4ms)  SELECT \"bills_for_users\".* FROM \"bills_for_users\" WHERE \"bills_for_users\".\"billusername\" = 'Jeremy Fox'\nCompleted 200 OK in 47ms (Views: 11.2ms | ActiveRecord: 2.4ms)\n\n\nStarted GET \"/api/bills/Jeremy%20Fox\" for 127.0.0.1 at 2012-03-20 23:16:44 -0400\nProcessing by BillsController#show as */*\n  Parameters: {\"username\"=&gt;\"Jeremy Fox\"}\n  BillsForUsers Load (1.1ms)  SELECT \"bills_for_users\".* FROM \"bills_for_users\" WHERE \"bills_for_users\".\"billusername\" = 'Jeremy Fox'\nCompleted 200 OK in 33ms (Views: 28.1ms | ActiveRecord: 1.1ms)\n</code></pre>\n\n<p>Can anyone explain to me why all of my ActiveRecord methods are being executed twice and/or what the difference is between <code>Processing by BillsController#show as HTML</code> and <code>Processing by BillsController#show as */*</code>?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","heroku","amazon-s3","carrierwave","fog"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13217544,"title":"Fog S3 Upload leads to","body":"<p>I am developing a platform that allows merchants to upload a picture of their store. I am using Carrierwave+fog for this. As the app is hosted on heroku, the pictures will need to be stored on amazon s3. </p>\n\n<p>On my local machine, everything works fine if the storage is local, but things go wrong once fog handles the uploading.</p>\n\n<p>I will first post the local storage version (works fine), then my current fog-enabled s3 version together with the error that I am getting.</p>\n\n<p>Local storage version (works fine):</p>\n\n<pre><code># app/uploaders/picture_uploader.rb\nclass PictureUploader &lt; CarrierWave::Uploader::Base\n  storage :file\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\nend\n</code></pre>\n\n<p>Fog-enabled s3 version (doesn't work):</p>\n\n<pre><code># app/uploaders/picture_uploader.rb\nclass PictureUploader &lt; CarrierWave::Uploader::Base\n  storage :fog\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\nend\n\n# config/initializers/fog.rb\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',       # required\n    :aws_access_key_id      =&gt; 'xxxx',       # required\n    :aws_secret_access_key  =&gt; 'xxxx'       # required\n  }\n  config.fog_directory  = 'yyyy'                     # required\n  config.fog_public     = true                          # optional, defaults to true\nend\n</code></pre>\n\n<p>When I now create or edit a new store, the picture is actually successfully uploaded to s3, but rails gives an Permission denied error message (app/tmp/carrierwave/20121104-0929-5512-8270/04.png could not be accessed).</p>\n\n<p>Full Error Message:</p>\n\n<pre><code>C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1406:in `unlink'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1406:in `block in remove_file'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1414:in `platform_support'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1405:in `remove_file'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:785:in `remove_file'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:563:in `block in rm'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:562:in `each'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:562:in `rm'\ncarrierwave (0.5.8) lib/carrierwave/sanitized_file.rb:217:in `delete'\ncarrierwave (0.5.8) lib/carrierwave/uploader/store.rb:60:in `block in store!'\ncarrierwave (0.5.8) lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\ncarrierwave (0.5.8) lib/carrierwave/uploader/store.rb:58:in `store!'\ncarrierwave (0.5.8) lib/carrierwave/mount.rb:347:in `store!'\ncarrierwave (0.5.8) lib/carrierwave/mount.rb:217:in `store_bild!'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:401:in `_run_save_callbacks'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactiverecord (3.1.0) lib/active_record/callbacks.rb:264:in `create_or_update'\nactiverecord (3.1.0) lib/active_record/persistence.rb:37:in `save'\nactiverecord (3.1.0) lib/active_record/validations.rb:50:in `save'\nactiverecord (3.1.0) lib/active_record/attribute_methods/dirty.rb:22:in `save'\nactiverecord (3.1.0) lib/active_record/transactions.rb:241:in `block (2 levels) in save'\nactiverecord (3.1.0) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\nactiverecord (3.1.0) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'\nactiverecord (3.1.0) lib/active_record/transactions.rb:208:in `transaction'\nactiverecord (3.1.0) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\nactiverecord (3.1.0) lib/active_record/transactions.rb:241:in `block in save'\nactiverecord (3.1.0) lib/active_record/transactions.rb:252:in `rollback_active_record_state!'\nactiverecord (3.1.0) lib/active_record/transactions.rb:240:in `save'\nactiverecord (3.1.0) lib/active_record/persistence.rb:163:in `block in update_attributes'\nactiverecord (3.1.0) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\nactiverecord (3.1.0) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'\nactiverecord (3.1.0) lib/active_record/transactions.rb:208:in `transaction'\nactiverecord (3.1.0) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\nactiverecord (3.1.0) lib/active_record/persistence.rb:161:in `update_attributes'\napp/controllers/stores_controller.rb:62:in `block in update'\nactionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:269:in `call'\nactionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:269:in `retrieve_response_from_mimes'\nactionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:194:in `respond_to'\napp/controllers/stores_controller.rb:61:in `update'\nactionpack (3.1.0) lib/action_controller/metal/implicit_render.rb:4:in `send_action'\nactionpack (3.1.0) lib/abstract_controller/base.rb:167:in `process_action'\nactionpack (3.1.0) lib/action_controller/metal/rendering.rb:10:in `process_action'\nactionpack (3.1.0) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:416:in `_run__16358980__process_action__192134115__callbacks'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:386:in `_run_process_action_callbacks'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.1.0) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.1.0) lib/action_controller/metal/rescue.rb:17:in `process_action'\nactionpack (3.1.0) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.1.0) lib/active_support/notifications.rb:53:in `block in instrument'\nactivesupport (3.1.0) lib/active_support/notifications/instrumenter.rb:21:in `instrument'\nactivesupport (3.1.0) lib/active_support/notifications.rb:53:in `instrument'\nactionpack (3.1.0) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.1.0) lib/action_controller/metal/params_wrapper.rb:201:in `process_action'\nactiverecord (3.1.0) lib/active_record/railties/controller_runtime.rb:18:in `process_action'\nactionpack (3.1.0) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.1.0) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.1.0) lib/action_controller/metal.rb:193:in `dispatch'\nactionpack (3.1.0) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.1.0) lib/action_controller/metal.rb:236:in `block in action'\nactionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:65:in `call'\nactionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:65:in `dispatch'\nactionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:29:in `call'\nrack-mount (0.8.3) lib/rack/mount/route_set.rb:152:in `block in call'\nrack-mount (0.8.3) lib/rack/mount/code_generation.rb:96:in `block in recognize'\nrack-mount (0.8.3) lib/rack/mount/code_generation.rb:75:in `optimized_each'\nrack-mount (0.8.3) lib/rack/mount/code_generation.rb:95:in `recognize'\nrack-mount (0.8.3) lib/rack/mount/route_set.rb:141:in `call'\nactionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:531:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.3.6) lib/rack/etag.rb:23:in `call'\nrack (1.3.6) lib/rack/conditionalget.rb:35:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/flash.rb:243:in `call'\nrack (1.3.6) lib/rack/session/abstract/id.rb:195:in `context'\nrack (1.3.6) lib/rack/session/abstract/id.rb:190:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/cookies.rb:326:in `call'\nactiverecord (3.1.0) lib/active_record/query_cache.rb:62:in `call'\nactiverecord (3.1.0) lib/active_record/connection_adapters/abstract/connection_pool.rb:477:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:392:in `_run_call_callbacks'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.1.0) lib/action_dispatch/middleware/callbacks.rb:28:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/reloader.rb:68:in `call'\nrack (1.3.6) lib/rack/sendfile.rb:101:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/remote_ip.rb:48:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/show_exceptions.rb:47:in `call'\nrailties (3.1.0) lib/rails/rack/logger.rb:13:in `call'\nrack (1.3.6) lib/rack/methodoverride.rb:24:in `call'\nrack (1.3.6) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.1.0) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.3.6) lib/rack/lock.rb:15:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/static.rb:53:in `call'\nrailties (3.1.0) lib/rails/engine.rb:455:in `call'\nrailties (3.1.0) lib/rails/rack/content_length.rb:16:in `call'\nrailties (3.1.0) lib/rails/rack/log_tailer.rb:14:in `call'\nrack (1.3.6) lib/rack/handler/webrick.rb:59:in `service'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n\n<p>This error confuses me, as typing in app/tmp/carrierwave/20121104-0929-5512-8270/04.png directly into the browser works fine.</p>\n\n<p>For completeness sake, here is the controller &amp; model (same in both versions)</p>\n\n<pre><code>#stores_controller.rb\ndef create\n  @store = Store.new(params[:store])\n\n  respond_to do |format|\n    if @store.save\n      format.html { redirect_to @store, notice: 'Store was successfully created.' }\n      format.json { render json: @store, status: :created, location: @store }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @store.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\n#models/store.rb\nclass Store &lt; ActiveRecord::Base\n  mount_uploader :bild, PictureUploader\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13216976,"title":"What does the initialize method in rails do","body":"<p>I'm trying to wrap my head around the purpose of using the initialize method. In Hartl's tutorial, he uses the example..</p>\n\n<pre><code>def initialize(attributes = {})\n   @name = attributes[:name]\n   @email = attributes[:email]\nend\n</code></pre>\n\n<p>Is initialize setting the instance variables <code>@name</code> and <code>@email</code> to the attributes, and if so why do we have the argument <code>attributes = {}</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13215219,"title":"ActiveRecord: many-to-many and one-to-many between same two models","body":"<p>Looking at guides.rubyonrails.com, I see the syntax for a self join:</p>\n\n<pre><code>class Employee &lt; ActiveRecord::Base\n  has_many :subordinates, :class_name =&gt; \"Employee\",\n    :foreign_key =&gt; \"manager_id\"\n  belongs_to :manager, :class_name =&gt; \"Employee\"\nend\n</code></pre>\n\n<p>What I want to do is something more like this:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  has_many :workers, :class_name =&gt; \"Employee\",\n    :foreign_key =&gt; \"manager_id\"\n  belongs_to :manager, :class_name =&gt; \"Employee\"\nend\n</code></pre>\n\n<p>Or perhaps I can define the relationship polymorphically:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  belongs_to :manager, :polymorphic =&gt; true\n  has_many :employees\nend\n\nclass Employee &lt; ActiveRecord::Base\n  has_many :projects, :as =&gt; :manager\nend\n</code></pre>\n\n<p>So I guess the relationship I'm looking for is sort of like a HABTM but with a concrete distinction between having and belonging to.  Any ideas?</p>\n"},{"tags":["ruby-on-rails-3","webrick","foreman"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":12808966,"title":"Rails server log not outputting immediately","body":"<p>We use Foreman to start all of our web processes in development.</p>\n\n<p>A while back, I tried to get the ruby-debugger gem working with this setup, but I couldn't, so I abandoned my effort. Along the way, I must have changed some setting or another, and now when I try to look at the server log in real time when I make a request to my local environment, nothing gets printed out. I have to kill foreman in order to see any output from the request.</p>\n\n<p>This is really slowing down my development, as I have to make a request, kill foreman to get information about what went wrong, then start up and try again.</p>\n\n<p>Any ideas how to get my server log to spit out everything as I'm making requests?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13206313,"title":"Clean folder every hour","body":"<p>I want the Rails server to empty the folder <code>public/photos</code> every hour, so that the folder does not get too full. How can I do that (if it's even a possibility)?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":127,"score":0,"question_id":6861022,"title":"Render view from code in /lib","body":"<p>Let's pretend we have a Rails project with a class named <code>Foo</code> residing in the <code>lib</code> directory.</p>\n\n<p>We want to generate some HTML based on its attributes.</p>\n\n<p>Now, creating a big string by concatenating HTML fragments appropriately doesn't feel right in the least bit.</p>\n\n<p>My question is: is there a blessed way to do it?  </p>\n"},{"tags":["ruby-on-rails-3","routes","ruby-on-rails-2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":414,"score":1,"question_id":9789198,"title":"Migrating from Rails 2.3 to 3.2 over a long period","body":"<p>I'm working on a small project that has been allocated a small amount of time to maintain and update features.  This project is on Rails 2.3.</p>\n\n<p>I'd like to move it to Rails 3.2 but there is little time allocated to this so I would like to do it over a slow gradual process.</p>\n\n<p>I'm thinking that it might be worth moving over to Rails 3.2 on a section-by-section basis.\nThis would mean that I would create a second application that looks the same as the first one but is located somewhere different and accessed from a different subdomain.</p>\n\n<p>Is this feasible if I just update the Rails 2.3 routes file for certain routes to go to the new application?</p>\n\n<p>Has anyone done this before?</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3","random"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":90,"score":4,"question_id":13204634,"title":"Freeze a random number in Ruby","body":"<p>I'm trying to build something that will randomly pick two objects from a list in Ruby (using Rails) and then perform basic operations on those objects. My current set up involves randomly picking numbers at the start - using these numbers to get objects from the database and then rendering those objects to index. However, now I'm trying to edit these objects using AJAX I'm running into a problem.</p>\n\n<p>It seems that, when I click on a link that the random number in being recalculated and is causing my AJAX function not to work.</p>\n\n<p>I've included (what I believe is) all relevant code below but let me know if you need to see anything else to get to the bottom of this. I'm looking to get the titles of the old animals and (ideally their previous ratings and) their new ratings to appear at the bottom of the page.</p>\n\n<p>Thanks,</p>\n\n<p>Matt</p>\n\n<p><code>controllers/static_pages.rb</code></p>\n\n<pre><code>class StaticPagesController &lt; ApplicationController\nrespond_to :html, :js\nbefore_filter :pickanimals\n\ndef pickanimals\n    @allAnimals = Animal.all\n    @random_no = rand(@allAnimals.length)\n    @animal = @allAnimals[@random_no]\n    @allAnimals.delete_at(@random_no)\n    @newRandom = rand(@allAnimals.length)\n    @animal2 = @allAnimals[@newRandom]\nend\n\n  def index\n    respond_to do |format|\n        format.html\n        format.js\n    end\nend\n\n  def help\n  end\n\n  def about\n  end\n\n  def contact\n  end\n\ndef league\nend\n\ndef voting\n    @votedAnimal = Animal.find(params[:id])\n    if @votedAnimal == @animal\n        @animal.rating += 1\n        @animal2.rating -= 1\n    else\n        @animal.rating -= 1\n        @animal2.rating += 1    \n    end\n    Animal.transaction do\n        @animal.save!\n        @animal2.save!\n    end\n    respond_to do |format|\n        format.html { redirect_to root_path }\n        format.js  \n    end\nend\nend\n</code></pre>\n\n<p><code>app/views/static_pages/index.html.erb</code></p>\n\n<pre><code>&lt;div class=\"center hero-unit\"&gt;\n&lt;h1&gt;Animal Attack&lt;/h1&gt;\n&lt;p&gt; Who will win when nature collides? &lt;/p&gt;\n&lt;div class=\"animalcontainerright\"&gt;\n&lt;h2&gt; &lt;%= @animal.name %&gt; &lt;/h2&gt; \n&lt;%= link_to image_tag(@animal.attachment.url(:large)), voting_path(@animal.id), :remote =&gt; true, :confirm =&gt; \"Rating:  \"+@animal.rating.to_s  %&gt;\n&lt;/div&gt;\n&lt;div class=\"animalcontainerleft\"&gt;\n&lt;h2&gt; &lt;%= @animal2.name %&gt; &lt;/h2&gt;\n&lt;%= link_to image_tag(@animal2.attachment.url(:large)), voting_path(@animal2.id), :remote =&gt; true, :confirm =&gt; \"Rating:  \"+@animal2.rating.to_s  %&gt;\n&lt;/div&gt;\n&lt;div id=\"animalfacts\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p><code>routes.rb</code></p>\n\n<pre><code>AnimalAttack::Application.routes.draw do\n\nresources :animals\n\nroot to: 'static_pages#index'\nmatch '/help' =&gt; 'static_pages#help'\nmatch '/about' =&gt; 'static_pages#about'\nmatch '/contact' =&gt; 'static_pages#contact'\nmatch '/league' =&gt; 'static_pages#league'\nmatch '/voting/:id' =&gt; 'static_pages#voting'\n\nend\n</code></pre>\n\n<p><code>rake routes</code></p>\n\n<pre><code>    animals GET    /animals(.:format)          animals#index\n        POST   /animals(.:format)          animals#create\n new_animal GET    /animals/new(.:format)      animals#new\nedit_animal GET    /animals/:id/edit(.:format) animals#edit\n animal GET    /animals/:id(.:format)      animals#show\n        PUT    /animals/:id(.:format)      animals#update\n        DELETE /animals/:id(.:format)      animals#destroy\n   root        /                           static_pages#index\n   help        /help(.:format)             static_pages#help\n  about        /about(.:format)            static_pages#about\ncontact        /contact(.:format)          static_pages#contact\n league        /league(.:format)           static_pages#league\n               /animals(.:format)          animals#new\n               /voting/:id(.:format)       static_pages#voting\n</code></pre>\n"},{"tags":["ruby-on-rails-3","recaptcha"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13211686,"title":"recaptcha_tags rendering escaped HTML in erb","body":"<p>I'm migrating my app to Rails 3.2.8 from 2.3.5. One form uses reCAPTCHA (in an erb file). Right now, all the HTML tags that the recaptcha_tags puts out are in escaped HTML. (i.e. &amp;lt;...&amp;gt; instead of &lt;...>). So I see the tags themselves in the HTML page, instead of the reCAPTCHA box.</p>\n\n<p>Here's what my erb looks like. I've verified that it doesn't matter where in the erb I put the recaptcha tags (inside the form_for or outside):</p>\n\n<p>register.html.erb</p>\n\n<pre><code>...\n&lt;%= recaptcha_tags :public_key =&gt; RECAPTCHA_PUBLIC_KEY %&gt;\n...\n</code></pre>\n\n<p>Other things, like form_for don't have this problem. They output straight HTML.</p>\n\n<p>Gemfile</p>\n\n<pre><code>gem \"recaptcha\", :require =&gt; 'recaptcha/rails'\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","tdd"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13212410,"title":"RSpec with Ruby on Rails - Wrong number of arguments (1 for 0) when testing routes","body":"<p>I tried testing routes and just copied the example from the rspec-rails documentation.</p>\n\n<pre><code>describe \"routing to profiles\" do\n  it \"routes /profile/:username to profile#show for username\" do\n    expect(:get =&gt; \"/profiles/jsmith\").to route_to(\n      :controller =&gt; \"profiles\",\n      :action =&gt; \"show\",\n      :username =&gt; \"jsmith\"\n    )\n  end\nend\n</code></pre>\n\n<p>I got the following error when running RSpec:</p>\n\n<pre><code>Failures:\n\n  1) routing to profiles routes /profile/:username to profile#show for username\n     Failure/Error: expect(:get =&gt; \"/profiles/jsmith\").to route_to(\n     ArgumentError:\n       wrong number of arguments (1 for 0)\n     # ./spec/routing/test_spec.rb:11:in `block (2 levels) in &lt;top (required)&gt;'\n\nFinished in 0.001 seconds\n1 example, 1 failure\n</code></pre>\n\n<p>What's going wrong here?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","css","ruby-on-rails-3","layout","twitter-bootstrap"],"answer_count":3,"favorite_count":11,"up_vote_count":9,"down_vote_count":0,"view_count":4536,"score":9,"question_id":9118923,"title":"twitter-bootstrap-rails gem workflow","body":"<p>How do I use the twitter-bootstrap-rails gem in my Rails 3.2.1 app? What is the workflow?</p>\n\n<p>After I do:</p>\n\n<pre><code>rails g bootstrap:layout [LAYOUT_NAME] [*ﬁxed or ﬂuid] [options]\n</code></pre>\n\n<p>what do I do next? Do I just copy and paste the generated code into my view? Do I do this for every view? If so, how is doing</p>\n\n<pre><code>rails g bootstrap:themed [RESOURCE_NAME] [LAYOUT] [options]\n</code></pre>\n\n<p>any different?</p>\n\n<p>Do you guys even use the rails generators?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13214704,"title":"set a timeframe on model attribute rails 3","body":"<p>I have an app that allows you to upload a recipe to the db, as part of the app i would like to have a \"Featured Recipe\" that is called randomly from the recipe db. I am using this method to call a random record</p>\n\n<pre><code>   @featurerecipe = Recipe.offset(rand(Recipe.count)).limit(1)\n</code></pre>\n\n<p>As expected when i refresh the page the record changes, however I would like the random record to stay in place for say 24 hours, even when the page is refreshed. I'm looking for some advice on how to go about this or perhaps someone else has done this in a project of their own? I was thinking that you could have a db column called feature and then set a \"true\" value to it, set everything else as false and then somewhere a loop needs to occur to check the time spent at value \"true\", then after 24 hours pick another random recipe? </p>\n\n<p>I may be well off here, any help appreciated</p>\n"},{"tags":["javascript","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13211608,"title":"get html input into a rails function","body":"<p>I have a piece of html like this:</p>\n\n<pre><code>    &lt;div class=\"row well\"&gt;\n      &lt;form method=\"POST\"&gt;\n        &lt;ol id=\"velArea\"&gt;\n          &lt;li&gt;  Layer velocity: (m/s) &lt;input type=\"text\" name=\"source[]\"&gt; &lt;/li&gt;\n        &lt;/ol&gt;\n        &lt;input type=\"button\" value=\"Add another layer\" name=\"velocity\" onClick=\"addVel('velArea');\"&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>and a javascript function that adds html to the area</p>\n\n<pre><code>    function addVel(area)\n    {\n      var field_area = document.getElementById(area);\n      field_area.innerHTML += \"&lt;li&gt;  Layer velocity: (m/s) &lt;input type='text' name='velocity'&gt; &lt;a style='cursor:pointer;color:grey;' onclick='this.parentNode.parentNode.removeChild(this.parentNode);''&gt;delete&lt;/a&gt; &lt;/li&gt;\";\n    }\n</code></pre>\n\n<p>I need to read the value of each input field in a rails function. And have no idea about how to do that. I've lost days going through active model in rails, thinking that was the way until I finally figured out that is better to keep the browser-related and server related things separated. So I learned a little javascript and made a few functions. Yes, I'm new to web development. I'm using rails 3.2.</p>\n\n<p>The function that I want to uses the fields info is called by a button:</p>\n\n<pre><code>     &lt;%= button_to \"Run single inversion\", {:action =&gt; \"my_func\", }, {:remote =&gt; true, :form =&gt; { \"data-type\" =&gt; \"json\" }, :class =&gt; \"btn btn-primary\"} %&gt;\n</code></pre>\n\n<p>and the function on the controller is:</p>\n\n<pre><code>    def my_func\n      render :nothing =&gt; true\n      vel = params[:velocity]\n      puts vel.class\n      puts 'Hi'\n    end\n</code></pre>\n\n<p>the output I get is</p>\n\n<pre><code>    NilClass\n    Hi\n</code></pre>\n\n<p>so I'm clearly not passing the arguments right. I'm guessing I need to pass the velocity array in the post method when I use the button_to, but have no idea about how to do that.</p>\n\n<p>Also, I'm need the value of the input, not anything database oriented so I cannot look it up using activeRecord properties.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13212200,"title":"Moving mysql query to model","body":"<p>I have the following mysql query working well. Quick backstory, this lists our customers by total money spent. </p>\n\n<pre><code>SELECT  SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\nFROM customer_order AS co \nJOIN customer AS cu ON (cu.customer_id = co.customer_id) \nGROUP BY co.customer_id\nORDER BY money_spent DESC\n</code></pre>\n\n<p>I attempted moving this to the customer model, as a scope, and subclass  yet I failed both ways.  I'm somewhat new to rails (formerly client-side) but I think I'm close.  Hoping y'all could point me in the right direction. Thanks in advance!!!</p>\n\n<pre><code>def self.high_rollers  \n  options = {\n      :select   =&gt; \"SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\",\n      :from     =&gt; \"customer_order AS co\",\n      :joins    =&gt; \"customer AS cu ON (cu.customer_id = co.customer_id)\",\n      :group_by =&gt; \"co.customer_id\",\n      :order    =&gt; \"money_spent DESC\"\n            }   \n</code></pre>\n\n<p>Putting the following code in my index action for this controller works, but definitely doesn't feel like the right approach!</p>\n\n<pre><code>@high_bidders = Customer.find_by_sql(&lt;&lt;-SQL\n       SELECT  SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\n       FROM customer_order AS co \n       JOIN customer AS cu ON (cu.customer_id = co.customer_id) \n       GROUP BY co.customer_id\n       ORDER BY money_spent DESC\n</code></pre>\n\n<p>SQL\n )</p>\n"},{"tags":["ruby-on-rails-3","postgresql","libpq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":120,"score":2,"question_id":11171330,"title":"Why is rake aborting because of libpq.5.dylib","body":"<p>I just installed <strong>PostgreSQL</strong> and the <strong>pg</strong> gem for running Rails on Heroku. I'm running </p>\n\n<pre><code>$ rake -T\n</code></pre>\n\n<p>But it's aborting for reason related to \"libpq.5.dylib\"</p>\n\n<pre><code>rake aborted!\ndlopen(/Library/Ruby/Gems/1.8/gems/pg-0.13.2/lib/pg_ext.bundle, 9): Library not loaded: libpq.5.dylib\nReferenced from: /Library/Ruby/Gems/1.8/gems/pg-0.13.2/lib/pg_ext.bundle\nReason: image not found - /Library/Ruby/Gems/1.8/gems/pg-0.13.2/lib/pg_ext.bundle\n</code></pre>\n\n<p>What gives?</p>\n\n<p>How can load the libpq.5.dylib library?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":11667426,"title":"Rails: control ordering of query parameters in url_for?","body":"<p>I'd like to generate a URL where the \"p=1\" query param appears at the end of the URL, like:</p>\n\n<pre><code>/path?foo=X&amp;bar=Y&amp;p=1\n</code></pre>\n\n<p>Is it possible to control the ordering of query parameters when generating URLs via:</p>\n\n<pre><code>url_for(params.merge({ p: page_num }))\n</code></pre>\n\n<p>?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I tried <a href=\"http://stackoverflow.com/users/1396395/chucke\">ChuckE's</a> <a href=\"http://stackoverflow.com/a/11668620/93995\">suggestion below</a>. It turns out that in Ruby 1.9 Hashes are already ordered, so the code in <code>ActiveSupport::OrderedHash</code> is effectively no-op'd. You can verify with Ruby 1.9 that order is preserved:</p>\n\n<pre><code>&gt;&gt; h = {one: 1, two: 2, three: 3 }\n{:one=&gt;1, :two=&gt;2, :three=&gt;3}\n&gt;&gt; f = h.except(:one)\n{:two=&gt;2, :three=&gt;3}\n&gt;&gt; f[:one] = 1\n1\n&gt;&gt; f\n{:two=&gt;2, :three=&gt;3, :one=&gt;1}\n</code></pre>\n\n<p>However, <code>url_for</code> <em>still</em> puts the \"p\" param first. It seems that any potential solution will need to address how <code>url_for</code> iterates the hash.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13208943,"title":"Rails Devise Strange behaviour with foreign key","body":"<p>I'm trying to create a simple User &amp; Address Model.</p>\n\n<p>I've created a nested form that has an address model nested into the User model. My User Model has the devise attributes etc.</p>\n\n<p>It all works fine, except that there's a strange behaviour happening when the user is created.</p>\n\n<p>If you read below, you'll notice the \"user_id\" which is the address of the owning user is populated when the record is first committed. But then immediately afterward, something that looks like it's in Devise core, is resetting the user_id to null.</p>\n\n<p>Does anyone know what would be causing this? </p>\n\n<blockquote>\n  <p>Started POST \"/users\" for 127.0.0.1 at 2012-11-03 22:45:20 +1100\n  Processing by Member::UsersController#create as HTML   Parameters:\n  {\"utf8\"=>\"✓\",\n  \"authenticity_token\"=>\"Pr8lSEJalWwosuaLPOrYqQ+sOkFCyoNujaUybxpZDAg=\",\n  \"user\"=>{\"address_attributes\"=>{\"first_name\"=>\"HOlley\",\n  \"last_name\"=>\"Hou\"}, \"email\"=>\"HollyHou@hisense.com.au\",\n  \"password\"=>\"[FILTERED]\", \"password_confirmation\"=>\"[FILTERED]\"}}\n  Creating a new user    (0.1ms)  BEGIN    (0.1ms)  COMMIT    (0.0ms) \n  BEGIN   Member::User Exists (0.3ms)  SELECT 1 AS one FROM\n  <code>member_users</code> WHERE <code>member_users</code>.<code>email</code> = BINARY\n  'hollyhou@hisense.com.au' LIMIT 1   SQL (0.2ms)  INSERT INTO\n  <code>member_users</code> (<code>created_at</code>, <code>current_sign_in_at</code>,\n  <code>current_sign_in_ip</code>, <code>email</code>, <code>encrypted_password</code>,\n  <code>last_sign_in_at</code>, <code>last_sign_in_ip</code>, <code>remember_created_at</code>,\n  <code>reset_password_sent_at</code>, <code>reset_password_token</code>, <code>sign_in_count</code>,\n  <code>updated_at</code>) VALUES ('2012-11-03 11:45:20', NULL, NULL,\n  'hollyhou@hisense.com.au',\n  '$2a$10$1JvC/sO85L2esNp8xA9qseTc78.rtOyF3zSBi/fOTiWJRt9.zgYha', NULL,\n  NULL, NULL, NULL, NULL, 0, '2012-11-03 11:45:20')   SQL (0.2ms) \n  INSERT INTO <code>member_addresses</code> (<code>address3</code>, <code>address_1</code>, <code>address_2</code>,\n  <code>address_type</code>, <code>business_name</code>, <code>city</code>, <code>country</code>, <code>created_at</code>,\n  <code>first_name</code>, <code>geo_late</code>, <code>geo_long</code>, <code>is_primary</code>, <code>last_name</code>,\n  <code>middle_name</code>, <code>phone1</code>, <code>phone1_type</code>, <code>phone2</code>, <code>phone2_type</code>,\n  <code>postcode</code>, <code>primary_email</code>, <code>secondary_email</code>, <code>state</code>, <code>status</code>,\n  <code>suburb</code>, <code>title</code>, <code>updated_at</code>, <code>user_id</code>) VALUES (NULL, NULL, NULL,\n  NULL, NULL, NULL, NULL, '2012-11-03 11:45:20', 'HOlley', NULL, NULL,\n  NULL, 'Hou', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,\n  NULL, NULL, NULL, '2012-11-03 11:45:20', 5)    (1.3ms)  COMMIT<br>\n  (0.1ms)  BEGIN    (0.2ms)  UPDATE <code>member_users</code> SET <code>last_sign_in_at</code>\n  = '2012-11-03 11:45:20', <code>current_sign_in_at</code> = '2012-11-03 11:45:20', <code>last_sign_in_ip</code> = '127.0.0.1', <code>current_sign_in_ip</code> = '127.0.0.1',\n  <code>sign_in_count</code> = 1, <code>updated_at</code> = '2012-11-03 11:45:20' WHERE\n  <code>member_users</code>.<code>id</code> = 5    (0.2ms)  COMMIT    (0.1ms)  BEGIN<br>\n  (0.2ms)  UPDATE <code>member_addresses</code> SET <code>user_id</code> = NULL, <code>updated_at</code>\n  = '2012-11-03 11:45:20' WHERE <code>member_addresses</code>.<code>id</code> = 5    (0.2ms)  COMMIT</p>\n</blockquote>\n\n<p>The controller is a custom controller because I eventually (once I get this working), need to be able to redirect to 2 different places after registration depending where the customer logged in from (checkout or header in this case).</p>\n\n<pre><code>class Member::UsersController &lt; Devise::RegistrationsController\n  def create\n    super\n  end\n\n  def new\n    super\n  end\n\n  def edit\n    Rails.logger.debug { \"Editing the user\" }\n    super\n  end\n\n  def show\n    Rails.logger.debug { \"Showing the user controller\" }\n  end\nend\n</code></pre>\n\n<p>and from routes.rb</p>\n\n<pre><code>  devise_for :users, :class_name =&gt; \"Member::User\", :controllers =&gt; {:registrations =&gt; 'member/users', :sessions =&gt; 'member/sessions'}\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13212155,"title":"Array of time to fill a simpleform listbox","body":"<p>I have a time field and would like to have only the following times appear:</p>\n\n<p>09:00\n09:15\n09:30\n09:45\n10:00\n...\n14:00</p>\n\n<p>I'm using Simple_Forms, bootstrap and activerecord.</p>\n\n<p>Last thing I tried was setting up a global initialiser like this:</p>\n\n<pre><code>ValidHours =\n['09:00', '09:15', '09:30', '09:45', '10:00', '10:15', '10:30', '10:45', \n  '11:00', '11:15', '11:30', '11:45', '12:00',\n  '12:15', '12:30', '12:45', '13:00', '13:15', '13:30', '13:45', '14:00']\n</code></pre>\n\n<p>and then in Simple_Forms I used:</p>\n\n<pre><code>  &lt;%= f.input :order_until_hour, :label =&gt; \"Order until\", :collection =&gt; ValidHours %&gt;\n</code></pre>\n\n<p>This displays the values correctly but they don't seem to be saved in the database.</p>\n\n<p>If possible I would also like to have this info in the model where it belongs.</p>\n\n<p>I also tried:</p>\n\n<pre><code>def self.ValidHours\n  ['09:00', '09:15', '09:30', '09:45', '10:00', '10:15', '10:30', '10:45', '11:00',\n    '11:15', '11:30', '11:45', '12:00', '12:15', '12:30', '12:45', '13:00', \n    '13:15', '13:30', '13:45', '14:00']\nend\n</code></pre>\n\n<p>and in the view:</p>\n\n<pre><code>  &lt;%= f.input :order_until_hour, :label =&gt; \"Order until\", :collection =&gt; ValidHours %&gt;\n</code></pre>\n\n<p>but that didn't work either.</p>\n\n<p>Thanks for any clues!</p>\n\n<p>EDIT:</p>\n\n<p>Thanks for the reply uDaY.  I tried your suggestion.</p>\n\n<p>They appear correctly now, I also checked the database and they get saved too.  However if I click on edit (after it's saved) it still appears empty.</p>\n\n<p>This is the code:</p>\n\n<pre><code>class Shop &lt; ActiveRecord::Base\n\n  def self.ValidHours\n      [['09:00', '09:00'], ['09:15', '09:15'], ['09:30', '09:30'], ['09:45', '09:45'], ['10:00', '10:00'],\n       ['10:15', '10:15'], ['10:30', '10:30'], ['10:45', '10:45'], ['11:00', '11:00'], ['11:15', '11:15'],\n       ['11:30', '11:30'], ['11:45', '11:45'], ['12:00', '12:00'],\n       ['12:15', '12:15'], ['12:30', '12:30'], ['12:45', '12:45'], ['13:00', '13:00'], ['13:15', '13:15'],\n       ['13:30', '13:30'], ['13:45', '13:45'], ['14:00', '14:00']]\n  end\n</code></pre>\n\n<p>and in the view:</p>\n\n<pre><code>      &lt;%= f.input :order_until_hour, :label =&gt; \"Order until\", :collection =&gt; Shop.ValidHours %&gt;\n</code></pre>\n\n<p>In the database the values appear as:</p>\n\n<pre><code>order_until_hour: \"2000-01-01 09:00:00\"\n</code></pre>\n\n<p>so I thought I would alter the ValidHours like this:</p>\n\n<pre><code>  def self.ValidHours\n      [['09:00', '2000-01-01 09:00'], ['09:15', '2000-01-01 09:15'] …\n</code></pre>\n\n<p>but that doesn't make any difference.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","model","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13208659,"title":"Add to cart quantity logic RoR","body":"<p>I have a method called add_to_cart created that is being called each time a user adds a product to their cart - the method then checks to see if the item already exists and if it does it increases the quantity by +1. </p>\n\n<p>The issue I am having is that I am unsure how to call my Items 'create' action (in Items controller) from my model if a product does not already exist in the cart. </p>\n\n<p>I think I could use Item.create(...) but I would rather just call the create action that already exists in my Items controller.</p>\n\n<p>Currently I have:</p>\n\n<p>Products#Index View</p>\n\n<pre><code> ...\n &lt;%= button_to \"Add to Cart\", add_to_cart_path(:product_id =&gt; product), :method =&gt; :post %&gt;\n ...\n</code></pre>\n\n<p>Routes</p>\n\n<pre><code> ...\n post '/add_to_cart/:product_id' =&gt; 'carts#add_to_cart', :as =&gt; 'add_to_cart'\n ...\n</code></pre>\n\n<p>Carts Controller</p>\n\n<pre><code> class CartsController &lt; ApplicationController\n\n def show\n   @cart = current_cart\n end\n\n def add_to_cart\n   current_cart.add_item(params[:product_id])\n   redirect_to cart_path(current_cart.id)\n end\n\n end\n</code></pre>\n\n<p>Cart Model</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\nhas_many :items\n\ndef add_item(product_id)\n        item = items.where('product_id = ?', product_id).first\n    if item\n        # increase the quantity of product in cart\n        item.quantity + 1\n        save\n    else\n        save # \"THIS IS WHERE I WANT TO CALL ITEMS CONTROLLER CREATE\"\n    end\nend\n</code></pre>\n\n<p>Items Controller</p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n\ndef create\n    @product = Product.find(params[:product_id])\n    @item = Item.create!(:cart =&gt; current_cart, :product =&gt; @product, :quantity =&gt; 1, :unit_price =&gt; @product.price)\n    redirect_to cart_path(current_cart.id)\nend\n\nend\n</code></pre>\n\n<p>Any help on how I can achieve this redirect to my create action would really be much appreciated! :)</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13212377,"title":"Rails and mysql. Any way to view tables?","body":"<p>I have just started out on rails and I've been using the mysql2 gem with it.\nI realised that on rails, migrations are used to alter tables in the database. </p>\n\n<p>So I was just wondering if there was anyway I could view the tables in Mysql?\nAnd also some way to make insertions, deletions etc more efficient?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":5463972,"title":"Gift list open source app?","body":"<p>I'm looking for a Rails 2.x/3 application for administrating Gift Lists (weddings, birthdays, etc).</p>\n\n<p>Does anybody know about any?</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13212296,"title":"Is it possible to replace string with hash / symbol (:created_at)","body":"<p>Is it possible to write this lines in hash format (:created_at)</p>\n\n<pre><code>User.where(\"created_at &gt; ?\", Time.now - 1.month) \nUser.where(\"created_at &gt;= ?\", DateTime.parse('2012-10-31')\n</code></pre>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap","passenger","less","bootswatch"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":798,"score":3,"question_id":9219213,"title":"Cannot call method 'charAt' of undefined - only on server","body":"<p>I have a rails application which is running well in local (OsX, WEBrick).</p>\n\n<p>I've cloned the repo on a server (Ubuntu 10.04, Apache, Passenger), setted up passenger, but now when i try to connect to every page i get</p>\n\n<pre><code>Less::ParseError in Pages#home\n\nShowing /var/www/MYAPP/app/views/layouts/application.html.erb where line #5 raised:\n\nCannot call method 'charAt' of undefined\n  (in /usr/lib/ruby/gems/1.8/gems/twitter-bootstrap-rails-2.0.2/vendor/assets/stylesheets/twitter/bootstrap.css.less)\n</code></pre>\n\n<p>the content of bootstrap.css.less is:</p>\n\n<pre><code>@import \"twitter/bootstrap/bootstrap\";\n</code></pre>\n\n<p>line 5 of application.html.erb is:</p>\n\n<pre><code>&lt;%= stylesheet_link_tag    \"application\" %&gt;\n</code></pre>\n\n<p>ruby 1.8.7 on both machines</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13206463,"title":"retrieving pdf(file) from database in ruby on rails","body":"<p>I am able to successfully store uploaded pdf in database using binary datatype in database. Now i want to retrieve that pdf and store in variable something like mypdf = xxx.pdf , so that i can pass that pdf in few of my methods. I want to do in ruby or rails.</p>\n\n<p>let me rephrase what i mean. i want to retrieve pdf file which is already stored in database. i know for eg this code in controller will render pdf locally.  send_data @attachment.data, :filename => @attachment.filename, :type => @attachment.content_type  but i don't want to show the pdf. i want to assign the pdf to variable and later on pass that pdf to my method </p>\n\n<p>Thanks for help </p>\n"},{"tags":["ruby-on-rails-3","sprockets","tilt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12435246,"title":"Sprockets > How to specify a binding for Erb evaluation / rendering?","body":"<p>I've spent a lot of time digging into sprockets' and tit's source code, trying to figure out how to pass variables / bindings to the Erb evaluation context. Here's what I'm trying to do: I need to serve a JS file whose contents change on a per-request basis. The portions that change depend on data stored in the DB, hence the need to route requests through the Rails app and the need to pass variables / bindings. On top of that the JS file uses the <code>require</code> directives to insert other JS files, hence the need to use sprockets.</p>\n\n<p>Here's the code snippet that isn't working:</p>\n\n<p>Controller file:</p>\n\n<pre><code>def ever_changing_js\n  @foobars = Foobar.all\n  MyApp::Application.assets.instance_eval do\n    def foobars\n      @foobars\n    end\n  end\n\n  render :text =&gt; MyApp::Application.assets.find_asset('ever_changing.js').to_s, :content_type =&gt; \"application/javascript\"\nend\n</code></pre>\n\n<p>ever_changing.js:</p>\n\n<pre><code>//= require file1.js\n//= require file2.js\n\n// Some code that uses @foobars\n</code></pre>\n\n<p>How can I get this done? Any help would be appreciated.</p>\n"},{"tags":["ruby","arrays","ruby-on-rails-3","csv","export-to-csv"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13203470,"title":"Rails: CSV Array to string (convert)","body":"<p>I am new to rails and I would like to export a dictionary (of strings). \nAt the moment I am using this piece of code</p>\n\n<pre><code>    Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \")\n</code></pre>\n\n<p>To generate:</p>\n\n<pre><code>   Build a cage!, Build tha pizza, Demonstrated ability in flying, Demonstrated ability in pizza baking\n</code></pre>\n\n<p>I would like to export this to csv, however the problem is that it is one array. I would like to create separate strings (comma separated) and displaying each string on a different row. Currently everything is displayed on one row when exporting this to csv. </p>\n\n<p>Any clue how to do this? I created an array of the data because there is a lot of duplicate data and this piece of code is filtering all the duplicates out.</p>\n\n<p>In my controller:</p>\n\n<pre><code>   format.csv { render Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n</code></pre>\n\n<p>I hope anyone could help me, much appreciated.</p>\n\n<p>Edit:</p>\n\n<p>Ideally I would like to fetch all competencies and have an output without duplicates, this is my controller:</p>\n\n<pre><code>    def dictionary\n      @competencies = Competency.all\n\n        respond_to do |format|\n        format.html { render html: positions_dictionary_path }\n        format.csv { render Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n        format.xls { send_data Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n\n      end\n    end\n</code></pre>\n\n<p>Usually in a view file you would do:</p>\n\n<pre><code>      &lt;div&gt;\n        &lt;% @posts.each do |competency| %&gt;\n          &lt;%= competency.competencies %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p>This generates a list of all the competencies, however also the duplicates. My solution was to create an array. However this creates problems when exporting to csv (because I need every output on a different line/row. So my question, how can I generate a list of all the \"competencies\" without duplicates?</p>\n"},{"tags":["ruby-on-rails-3","session"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13211413,"title":"Ability to store Name/Email in a session","body":"<p>I have a form that I want a user to put in their name and email, which get stored in a session.  They can then post text in a chat box.  </p>\n\n<p>In my view, to create the initial session:</p>\n\n<pre><code>&lt;%= simple_form_for(@comments, :url =&gt; guest_login_order_path(@order)) do |f| %&gt;\n        &lt;input name=\"comment[new_user_comment_name]\" /&gt;\n        &lt;input name=\"comment[new_user_comment_email]\" /&gt;\n        &lt;%= f.button :submit, :value =&gt; 'Guest Signin', :class =&gt; '' %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>This goes to my controller:</p>\n\n<pre><code>def guest_login\n    @order = Order.where(:public_hash =&gt; params[:public_hash]).first\n    session[:new_user_account] = params[:new_user]\n\n    respond_to do |format|\n      if session[:new_user_account]\n        format.html { redirect_to @order, notice: 'Your account has been created.' }\n        format.json { render json: @order, status: :created, location: @order }\n      else\n        format.html { render action: \"invoice\" }\n        format.json { render json: @order.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>The params get passed correctly but I'm not quite sure if the cookie is being created.  Is there way to specify a name so I can see if it was created?  Also in the view, would I have a conditional then to see if there is a session present?</p>\n"},{"tags":["ruby-on-rails","reload","rails-engines","ruby-on-rails-3"],"answer_count":9,"favorite_count":15,"up_vote_count":21,"down_vote_count":0,"view_count":6617,"score":21,"question_id":3282655,"title":"Ruby on Rails 3 - Reload lib directory for each request","body":"<p>I'm creating a new engine for a rails 3 application. As you can guess, this engine is in the lib directory of my application.</p>\n\n<p>However, i have some problems developing it. Indeed, I need to restart my server each time I change something in the engine.</p>\n\n<p>Is there a way to avoid this ?</p>\n\n<p>Can I force rails to completely reload the lib directory or a specific file and his requirements for each request ?</p>\n\n<p>Thanks for your help :)</p>\n"},{"tags":["ruby-on-rails-3","omniauth","linkedin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13208449,"title":"omniauth (linkedin) without Device - how to redirect to 'new' with validation messages?","body":"<p>I want users to be able to connect via other services (linked, facebook, google and twitter) without having to fill in another password.</p>\n\n<p>I have been following the amazing 235 &amp; 236 episodes of railscast.com which explain rather nicely how to use OmniAuth with Devise gem.</p>\n\n<p>I am not using Devise which confuses me and I don't manage to get it working as in the videocast. </p>\n\n<p>I tried following Ryan Bates instructions and adapt to my situation. I can't follow his instructions from minute 10 of no236 video where he overrides Devise's registration controller and views. </p>\n\n<p>So my problem happens when no user is signed in and no omniauth authentication available. \nIn that case, I need to create a new user, save, sign in and finally redirect.</p>\n\n<p>If the save fails after validation, I need a redirect to user new form with validation errors.</p>\n\n<p>I do manage to redirect to the new user form, BUT I don't manage to get the validation errors.</p>\n\n<p>CODE authentications controller</p>\n\n<pre><code>def create\n  omniauth = request.env[\"omniauth.auth\"] \n  #current_user = find_current_user\n  authentication = Authentication.find_by_provider_and_uid(omniauth['provider'], omniauth['uid'])\n  if authentication\n    flash[:notice] = \"Signed in successfully.\"\n    login_and_redirect(authentication.user)\n  elsif @current_user \n    @current_user.authentications.create!(:provider =&gt; omniauth['provider'], :uid =&gt; omniauth['uid'])\n    flash[:notice] = \"Authentication successful.\"\n    redirect_to authentications_url\n  else\n    user = User.new\n    puts \"OmniAuth: \" + omniauth[:info].to_s\n    user.apply_omniauth(omniauth)\n\n    if user.save\n      flash[:notice] = \"Signed in successfully.\"\n      login_and_redirect(user)\n    else\n      flash[:notice] = \"Omniauth Extra.\"\n      session[:omniauth] = omniauth.except('extra')\n      user.valid?\n      #redirect_to :controller =&gt; :users, :action =&gt; :new, :plan =&gt; 2\n      redirect_to new_user_url\n    end\n  end \nend\n</code></pre>\n\n<p>QUESTIONS</p>\n\n<p>Question 1: How do I redirect to user new with a pre-filled form using omniauth user info and errors messages?</p>\n\n<p>Question 2: How do I skip validation in my non Devise model when authenticating with another service?</p>\n\n<p>User MODEL</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  has_many :authentications\n  belongs_to :type, :class_name =&gt; \"UserType\", :foreign_key =&gt; \"type_id\"\n  has_many :logins, :class_name =&gt; \"UserLogin\"\n\n  validates :email_address, :email =&gt; { :message =&gt; 'format is incorrect!' }\n\n  validates_presence_of :email_address, :pseudo, :type_id\n  validates_uniqueness_of :email_address, :message =&gt; \"has already been taken\"\n  validates_uniqueness_of :pseudo, :message =&gt; \"has already been taken\"\n\n  attr_accessor :password_confirmation\n  validates_confirmation_of :password\n\n  validate :password_non_blank, :message =&gt; \"Cannot use blank password!\"\n\n  validates :agreed_terms_of_services, :presence =&gt; true, :allow_nil =&gt; false\n\n  attr_protected :password_hash, :password_salt, :active, :activation_token, :activated_at\n\n  ...\n\n  ...\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","asset-pipeline","requirejs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13211213,"title":"Removing development code during requirejs asset compilation","body":"<p>I am building a Rails 3 application where I use the <code>requirejs-rails</code> gem, which tweaks the asset pipeline according to my requirejs setup.</p>\n\n<p>In my code I have a couple of console.warn/log and other statements I use only for debugging. Is it possible to have these removed when the js is compiled? </p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":12974917,"title":"Get the width and height of an image without downloading it","body":"<p>I need to get the size of an image in Ruby on Rails. The image is in a remote URL.\nI dont want to download the entire image.</p>\n\n<p>Any help?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","model","logic"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13210476,"title":"Quantity in Cart Model Basic Logic Ruby on Rails","body":"<p>I am trying to apply some very basic logic to my view but am so far failing. </p>\n\n<p>What I would like to do is return item.discount_price if there are the following conditions:</p>\n\n<ol>\n<li>The item.product_id is equal to 1</li>\n<li>The Cart.item.quantity count is equal or higher than 2. </li>\n</ol>\n\n<p>Currently I have the following:</p>\n\n<p>Items Model</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\nbelongs_to :product\nbelongs_to :cart\n\ndef price_check\n\n    if  Item.product_id = 1 &amp;&amp; Item.quantity.count &gt;= 2 \n        return Item.discount_price\n    else\n        return Item.unit_price\n    end \n\nend\n</code></pre>\n\n<p>end</p>\n\n<p>View</p>\n\n<pre><code>&lt;% for item in @cart.items %&gt;\n&lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n  ...\n  &lt;td class=\"price\"&gt;&lt;%= gbp(item.price_check) %&gt;&lt;/td&gt;\n  ...\n&lt;/tr&gt;\n</code></pre>\n\n  \n\n<p>The associations are as follows:</p>\n\n<pre><code>Cart - has_many :items\nItems - Belongs_to :cart and :products\nProducts - has_ many :items\n</code></pre>\n\n<p>The error I keep receiving:</p>\n\n<pre><code> NoMethodError in Carts#show\n\nShowing C:/Sites/checkout/app/views/carts/show.html.erb where line #12 raised:\n\nundefined method `quantity' for #&lt;Class:0x50c3058&gt;\n\nExtracted source (around line #12):\n\n9:        &lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n10:       &lt;td&gt;&lt;%=h item.product.name %&gt;&lt;/td&gt;\n11:       &lt;td class=\"qty\"&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n12:       &lt;td class=\"price\"&gt;&lt;%= gbp(item.price_check) %&gt;&lt;/td&gt;\n13:       &lt;td class=\"price\"&gt;&lt;%= gbp(item.full_price) %&gt;&lt;/td&gt;\n14:       &lt;td&gt;&lt;%= button_to 'Remove', item, :method =&gt; :delete %&gt;&lt;/td&gt;\n15:       &lt;/tr&gt;\n\napp/models/item.rb:12:in `price_check'\napp/views/carts/show.html.erb:12:in `block in _app_views_carts_show_html_erb___389237738_48997308'\napp/views/carts/show.html.erb:8:in `_app_views_carts_show_html_erb___389237738_48997308'\n</code></pre>\n\n<p>Any help people can offer to fix this would be much appreciated! Thanks E</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","polymorphic-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":156,"score":0,"question_id":10366507,"title":"Rails polymorphic association change type","body":"<p>i've a question about a polymophic association in rails. the following model relationships are given:</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\n  has_many :events, :as =&gt; :event_container, :dependent =&gt; :destroy\n end\n\nclass Order &lt; ActiveRecord::Base\n  has_many :events, :as =&gt; :event_container, :dependent =&gt; :destroy\n end\n\nclass Event &lt; ActiveRecord::Base\n  belongs_to :event_container, :polymorphic =&gt; true\nend\n</code></pre>\n\n<p>So, i've events that are first applied to a cart and after checkout, they have to be stored as events that are related to an order. Here's my question: How can i transfer an event object form a cart to an order, so that \"event_container_id\" and \"event_container_type\" are updated? If i'm just trying to copy from on object to another like this:</p>\n\n<pre><code>c = Cart.first\no = Order.first\nc.events.create(...)\no.events &lt;&lt; c.events.first\n</code></pre>\n\n<p>i get an <code>ActiveRecord::AssociationTypeMismatch</code>Exception. </p>\n\n<p>It might also be possible that my association structure is totally wrong - don't hasitate to tell me, if this is the case... ;)</p>\n\n<p>thx in advance!</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13204652,"title":"Relationship between models are not working like expected","body":"<p>I have 3 models that are basically nested.  </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :birthday, :name\n  has_one :advancement, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :advancement\n  attr_accessible :advancement_attributes\nend\n\nclass Advancement &lt; ActiveRecord::Base\n  attr_accessible :user_id, :rank_name\n  belongs_to :user\n  has_one :rank, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :_rank\n  attr_accessible :rank_attributes\nend\n\nclass Rank &lt; ActiveRecord::Base\n  attr_accessible :advancement_id, :one_li, :one_pi, :one_date, ...\n  belongs_to :advancement\nend\n</code></pre>\n\n<p>Here is the controller code I use to create my models.</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new\n    @user = User.new\n    @user.advancement = Advancement.new\n    @user.advancement.rank = Rank.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n    end\n  end\n\n  def create\n    @user = User.new(params[:user])\n    @user.advancement = Advancement.new\n    @user.advancement.rank = Rank.new\n\n    respond_to do |format|\n      if @user.save\n        format.html { redirect_to @user, notice: 'User was successfully created.' }\n      else\n        format.html { render action: \"new\" }\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In the console I can create relations that work like I would expect.  When I try to do this through the browser all of my objects are instantiated, the foreign keys are correct, but if I try to find user.advancement, I get a method missing error.  Am I using new or create wrong and if so what should I do?  Sorry about the amount of code, but I didnt know any other way to explain it.  </p>\n"},{"tags":["ruby-on-rails-3","routes","passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13210495,"title":"Rails 3 Routing Error in One Branch but not in the Other","body":"<p>I'm using: Rails 3.1.3, HAML and Passenger</p>\n\n<p>I'm having a route problem in my staging branch, but in the other branch that was merged into staging I have no problem at all. I've tried comparing my routes files and the form files from these two branches using <code>git diff</code> but the two files are the same in the branches.</p>\n\n<p>A weird thing is the rendered error page. Here's a link to an screenshot</p>\n\n<p><a href=\"http://i.stack.imgur.com/DYNSZ.png\" rel=\"nofollow\">Error message</a></p>\n\n<p>And also the error from passenger:</p>\n\n<pre><code>Rendered time_entries/_form_fields.haml (173.2ms)\nRendered time_entries/_form.haml (194.7ms)\nRendered time_entries/edit.haml within layouts/application (196.6ms)\nCompleted 500 Internal Server Error in 448ms\n\nActionView::Template::Error (No route matches {:controller=&gt;\"time_entries\"}):\n    5:     .field\n    6:       = form.submit \"Save\"\n    7:       |\n    8:       = link_to \"Cancel\", project_time_entries_path(@project)\n  app/views/time_entries/_form.haml:8:in `block in     _app_views_time_entries__form_haml__894171410_105032920'\n  app/views/time_entries/_form.haml:3:in   `_app_views_time_entries__form_haml__894171410_105032920'\n  app/views/time_entries/edit.haml:2:in `_app_views_time_entries_edit_haml__805073897_105087770'\n</code></pre>\n\n<p>I attach you the code from my route and my form</p>\n\n<p>form.haml</p>\n\n<pre><code>.app-form\n  = error_messages_for :time_entry\n  = form_for [@project, @time_entry] do |form|\n    = render :partial =&gt; 'form_fields', :locals =&gt; {:form =&gt; form}\n    .field\n      = form.submit \"Save\"\n      |\n      = link_to \"Cancel\", project_time_entries_path(@project)\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Titi::Application.routes.draw do\n\n  root :to =&gt; 'time_entries#index'\n  match 'home' =&gt; 'home#index', :as =&gt; :home\n\n  match '/api/*other' =&gt; TitiAPI\n\n  resources :projects do\n    member do\n      get 'archive'\n      get 'unarchive'\n    end\n\n    resources :viewers\n    resources :labels\n\n    resources :time_entries do\n      collection do\n        get 'start'\n      end\n      member do\n        get 'new_note'\n        put 'add_note'\n      end\n    end\n\n  end\n\n  resources :bookings\n\n  resources :technical_orientations, except: [:delete]\n\n  match 'merge_labels/:projects_id' =&gt; 'labels#merge_labels', :as =&gt; :merge_labels\n  match 'move_labels/:projects_id' =&gt; 'labels#move_labels', :as =&gt; :move_labels\n\n  resources :time_entries do\n    collection do\n      get 'start'\n    end\n\n    member do\n      get 'new_note'\n      put 'add_note'\n    end\n  end\n\n  resources :users do\n    member do\n      get 'time_entries'\n      get 'edit_password'\n      put 'update_password'\n      get 'suspend'\n      get 'unsuspend'\n    end\n\n    new do\n      get 'invite_form'\n      post 'invite'\n    end\n\n    collection do\n      get 'all'\n    end\n  end\n\n  resources :user_sessions\n\n  match 'reports/timesheet' =&gt; 'reports#timesheet', :as =&gt; :timesheet\n  match 'reports/:week/timesheet' =&gt; 'reports#timesheet', :as =&gt; :timesheet_week\n  match 'reports/timesheet_detail' =&gt; 'reports#timesheet_detail', :as =&gt;     :timesheet_detail\n  match 'reports/dashboard' =&gt; 'reports#dashboard', :as =&gt; :dashboard_report\n  match 'reports/timeentries_irregulars' =&gt;    'time_entries_irregulars#timeentries_irregulars', :as =&gt; :timeentries_irregulars\n  match 'reports/:week/timeirregulars' =&gt; 'time_entries_irregulars#timeentries_irregulars', :as =&gt; :timeirregulars_week\n\n  match 'reports/timesheet/admin' =&gt; 'reports#timesheet_admin', :as =&gt; :timesheet_admin\n  match 'reports/:week/timesheet/admin' =&gt; 'reports#timesheet_admin', :as =&gt; :timesheet_admin_week\n\n  match 'reports/time_entries' =&gt; 'time_entries_reports#landing_report'\n  match 'reports/time_entries/make' =&gt; 'time_entries_reports#index'\n  match 'reports/time_entries/csv' =&gt; 'time_entries_reports#make_csv'\n\n  match 'reports/:token' =&gt; 'reports#index', :as =&gt; :reports\n\n  match 'login' =&gt; 'user_sessions#new', :as =&gt; :login\n  match 'logout' =&gt; 'user_sessions#destroy', :as =&gt; :logout\n  match 'register' =&gt; 'users#register', :as =&gt; :register\n\n  resources :companies do\n    collection do\n      get 'settings'      \n      get \"remove_photo\"\n    end\n  end  \n\n  match 'labels/for_project_id/:id' =&gt; 'labels#for_project_id', :as =&gt; :for_project_id\n\n  match 'holidays_for_company/:token' =&gt; 'holidays#public', :as =&gt; :public_holiday_for_company\n  match 'holidays_by_year' =&gt; 'holidays#by_year', :as =&gt; :holidays_by_year\n\n  resources :holidays \n  resources :clients\n\n  resources :invoices do\n    member do\n      get 'pdf_invoice'\n      get 'cancel'\n    end\n    resources :invoice_lines do\n      collection do\n        get 'add'\n      end\n    end\n    resources :payments\n  end\n\n  resources :tweets do\n    resource :tweet_likes, :path =&gt; 'likes' do\n      collection do\n        get 'names'\n      end\n    end\n  end\n\n  match 'select_invoices' =&gt; 'invoices#select_invoices', :as =&gt; :select_invoices\n\n  match 'pusher/auth' =&gt; 'pusher#auth'\n\n  resources :requests, :only=&gt;[:create]\n  match  '*request', :controller =&gt; 'requests', :action =&gt; 'options', :constraints =&gt; {:method =&gt; 'OPTIONS', :format =&gt; 'json'}\nend\n</code></pre>\n\n<p>Thank's in advance.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13209966,"title":"Building full calendar for week schedule planning","body":"<p>I am trying to build a planner for the schedule for 1 week on Rails.</p>\n\n<p>Right now I am looking into the jquery plug-in <a href=\"http://arshaw.com/fullcalendar/\" rel=\"nofollow\">FullCalendar</a>.</p>\n\n<p>It offers a weekly view with different time slots and draggable events, the functionalities which I needed. However, it does planning for a full time range when I only need it for one week.</p>\n\n<p>I am new to jQuery, so I would appreciate it if someone could give me guidance on whether it is a good idea to use this plug in for my application.\nIf it is, how should I go about doing it and if it isn't are there any other better suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","csv","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13209239,"title":"Problems importing a CSV that has a filename as a string in Rails","body":"<p>I'm trying to import a CSV file to my Rails app that's using CarrierWave to handle file uploads. I'm using the <code>CSV</code> gem and populating the Rails database via a seed data.</p>\n\n<p>The issue I'm having is the import doesn't populate the image field of the database. The image column is a string that holds the filename eg. 'this-is-my-photo.jpg'. </p>\n\n<p>I have a database table that has the following columns:</p>\n\n<pre><code># ProductImage model, product_image table\n\nid |     image    |     tile      | product_id | created_at | updated_at \n--------------------------------------------------------------------------\n 1 | image-1.jpg  | Big shoe      |     11     | 2012-08-01 | 2012-08-01\n 2 | 1-photo.png  | Small hat     |     12     | 2012-08-01 | 2012-08-01\n 3 | jeansb1.gif  | Ankle socks   |     13     | 2012-08-01 | 2012-08-01\n\n\n# Import product_image table backup\nCSV.foreach(Rails.root.join(\"db/seeds/product_image.csv\"), headers: true) do |row|\n  ProductImage.create! do |product_image|\n    product_image.id = row[0]\n    product_image.title = row[1]\n    product_image.image = row[2]\n    product_image.product_id = row[3]\n  end\nend\n</code></pre>\n\n<p>The results of <code>db:seed</code> </p>\n\n<pre><code># ProductImage model, product_image table after population of seed data\n\nid |     image    |     tile      | product_id | created_at | updated_at \n--------------------------------------------------------------------------\n 1 |              | Big shoe      |     11     | 2012-11-01 | 2012-11-01\n 2 |              | Small hat     |     12     | 2012-11-01 | 2012-11-01\n 3 |              | Ankle socks   |     13     | 2012-11-01 | 2012-11-01\n</code></pre>\n\n<p>Everything but the <code>image</code> column was populated.</p>\n\n<p>I was wondering if anyone can give me tips on how to go about resolving this import/population issue. Has anyone experienced this problem before and is it because of the the filename type (eg. .jpg)?</p>\n\n<p>Also, I have the same problem when restoring my user model that has an <code>avatar</code> column which is a string that holds the CarrierWave filename.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13209490,"title":"Increasing Cart quantity RoR","body":"<p>I am trying to create a basic setup in my cart controller that will allow me to incrementally increase the quantity value of products added to the cart if an Item record already exists. </p>\n\n<p>I currently have:</p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n\ndef create  \n    @product = Product.find(params[:product_id])\n\n    if @item.new_record?\n        @item = Item.create!(:cart =&gt; current_cart, :product =&gt; @product, :quantity =&gt; 1, :unit_price =&gt; @product.price)\n    else\n        @item.increment! :quantity\n    end\n    redirect_to cart_path(current_cart.id)\nend\n\nend\n</code></pre>\n\n<p>However I keep getting the error <code>undefined method</code>new_record?' for nil:NilClass`</p>\n\n<p>Any help people can offer to solve this really would be much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","twitter-bootstrap-rails","bootswatch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":183,"score":0,"question_id":12775621,"title":"How to add wrapbootstrap (made with twitter bootstrap) themes to rails application","body":"<p>The website <code>https://wrapbootstrap.com/</code> has themes which were made using Twitter Bootstrap. Each of these themes include different versions of Twitter Bootstrap along with other various libraries and versions (jquery, fontawesome, etc...)</p>\n\n<p>How do I add these themes to my existing Rails app? What are the steps?</p>\n\n<p>I'm especially curious about the conflicts that may arrise if I'm already using a different version of jquery, twitter bootstrap, fontawesome, and others (as declared in the Gemfile).</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails-3","thin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13208965,"title":"Installing thin (1.5.0) with native extensions \"...ERROR: Failed to build gem native extension.\"","body":"<p>I have a new project need to use thin but there is something wrong. \nIn my Gemfile.</p>\n\n<pre><code>gem 'thin'\n</code></pre>\n\n<p>And then I run \"bundle install\". It shows:</p>\n\n<pre><code>......\nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /usr/local/Cellar/ruby/1.9.3-p194/bin/ruby extconf.rb \nchecking for main() in -lc... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/local/Cellar/ruby/1.9.3-p194/bin/ruby\n    --with-thin_parser-dir\n    --without-thin_parser-dir\n    --with-thin_parser-include\n    --without-thin_parser-include=${thin_parser-dir}/include\n    --with-thin_parser-lib\n    --without-thin_parser-lib=${thin_parser-dir}/lib\n    --with-clib\n    --without-clib\n/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:461:in `try_link0'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:476:in `try_link'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:619:in `try_func'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:845:in `block in have_library'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:840:in `have_library'\n    from extconf.rb:4:in `&lt;main&gt;'\n\n\nGem files will remain installed in /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/gems/1.9.1/gems/thin-1.5.0 for inspection.\nResults logged to /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/gems/1.9.1/gems/thin-1.5.0/ext/thin_parser/gem_make.out\nAn error occured while installing thin (1.5.0), and Bundler cannot continue.\nMake sure that `gem install thin -v '1.5.0'` succeeds before bundling.\n</code></pre>\n\n<p>Please help me to solve this problem. I once installed thin before, but I don't know why fail this time.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13206638,"title":"Token authentication in devise not working even after adding token_authenticatable to devise","body":"<p>I have devise for authentication and the following are the steps i did and token authentication not working</p>\n\n<ol>\n<li>added <code>devise</code> to gem file</li>\n<li>rails generate devise:install</li>\n<li>rails generate devise User</li>\n<li>rake db:migrate</li>\n<li>rails generate devise:views</li>\n<li>rails generate controller home index</li>\n</ol>\n\n<p>and upto this there is no problem and then i added <code>devise:token_authenticatable</code> to user model and then i added <code>before_save :ensure_authentication_token</code>and then</p>\n\n<ol>\n<li>rails generate migration AddTokenAuthenticatableToUser authentication_token:string</li>\n</ol>\n\n<p>then added attr_accessible :authentication_token to the user model</p>\n\n<p>but</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'xxxxxxxx'}}\"\n</code></pre>\n\n<p>is not working. It displays error in terminal. pls tell me what should i do to get the token of user and use it in subsequent request?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>It saves authentication token in user table when creating new user from web app but could not register a new user from terminal or get the token for the user to authenticate using the token.</p>\n"},{"tags":["jquery","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13201411,"title":"Use jquery .before(); method in rails","body":"<p>I want to repeat a form element using jquery's .before(); method , so that users of the form can add more ingredients in this case to their recipe.</p>\n\n<p>So far I have come up with this, however I cant use ruby code in a js file</p>\n\n<pre><code> $('document').ready(function() {\n  var ingredient = '&lt;%= f.text_field :ingredients, :class =&gt; :ingred %&gt;&lt;br&gt;';\n   $('#addIngredient').click(function(e) {\n    e.preventDefault();\n     $(this).before(ingredient);\n\n   })\n  });\n</code></pre>\n\n<p>I have done it using html5 and had it working doing this </p>\n\n<pre><code>   $('document').ready(function() {\n\n            var ingredient = '&lt;input class=\"ingredients\" name=\"ingredients\" type=\"text\" placeholder=\"Enter Ingredients Here\"&gt;&lt;br&gt;';\n             $('#addingredient').click(function(event) {\n               event.preventDefault();\n                $(this).before(ingredient);\n\n                 })\n               });\n</code></pre>\n\n<p>Im just having trouble getting this to fit in with my ruby form</p>\n\n<p>at the moment i get this outputted to the page rather than the text field</p>\n\n<pre><code>     &lt;%= f.text_field :ingredients, :class =&gt; :ingred %&gt;\n</code></pre>\n\n<p>Can anyone help? Much appreciated</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","nested-forms","simple-form"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":962,"score":1,"question_id":8415934,"title":"Rails simple_form association select with create option","body":"<p>I have a form with a belongs_to assocation, and I'd like the user to be able to either select from their addresses, or create a new one. It breaks when the form has validation errors because of conflicting information in the parameters, i.e.</p>\n\n<pre><code>\"transaction\" =&gt; { \"address_id\" = \"25\", \n    \"address_attributes\" =&gt; { \"id\" =&gt; \"25\" } } \n</code></pre>\n\n<p>I've simplified relevant files:</p>\n\n<p>Transaction.rb</p>\n\n<pre><code>class Transaction &lt; ActiveRecord::Base\n  belongs_to :address\n  accepts_nested_attributes_for :address\nend\n</code></pre>\n\n<p>Address.rb</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  has_many :transactions\nend\n</code></pre>\n\n<p>Transaction#new view</p>\n\n<pre><code>&lt;%= simple_form_for @transaction do |f| %&gt;\n\n  &lt;%= f.association :address, :collection =&gt; current_user.addresses,\n    :include_blank =&gt; \"Enter new address\",\n    :value_method =&gt; :id %&gt;\n\n  &lt;%= f.simple_fields_for :address do |address_fields| %&gt;\n    &lt;%= address_fields.input :line1 %&gt;\n    &lt;%= address_fields.input :line2 %&gt;\n    &lt;%= address_fields.input :city %&gt;\n    &lt;%= address_fields.input :state %&gt;\n    &lt;%= address_fields.input :zip, :label =&gt; \"Zip / Post Code\" %&gt;\n  &lt;% end %&gt;\n\n  &lt;%= f.submit \"Confirm\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Transaction#create controller</p>\n\n<pre><code>def create\n  trans_params = {}\n  if params[:transaction][:address_id].blank? &amp;&amp; !params[:transaction][:address_attributes].nil?\n    trans_params[:address_attributes] = params[:transaction][:address_attributes]\n  elsif !params[:transaction][:address_id].nil?\n    trans_params[:address_id] = params[:transaction][:address_id]\n  end\n\n  @transaction = Transaction.new(trans_params)\nend\n</code></pre>\n\n<p>Of course there is a chunk of code missing but I think these are the only relevant sections. The problem I'm having is, when you submit the form and there is validation errors, simple_form automatically adds <code>&lt;input id=\"transaction_address_attributes_id\" name=\"transaction[address_attributes][id]\" type=\"hidden\" value=\"25\"&gt;</code> to the end of my form, causing the parameters to clash and giving the error:</p>\n\n<pre><code>Couldn't find Address with ID=25 for Transaction with ID=\n</code></pre>\n\n<p>I imagine there is a much better way of dealing with the params in the controller. Any ideas? I have considered using javascript to remove and re-render the \"address attributes\" form but I'd rather not rely on javascript.</p>\n"},{"tags":["ruby-on-rails-3","radio-button"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13208604,"title":"Rails 3, checked radio button with if function","body":"<p>I have a radio button within my form as follows</p>\n\n<pre><code>    &lt;div class=\"btn-group\" data-toggle=\"buttons-radio\"&gt;\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2007' %&gt; 2007\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2008' %&gt; 2008\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2009' %&gt; 2009\n    &lt;/div&gt;\n</code></pre>\n\n<p>I am using twitter bootstrap</p>\n\n<p>I want to do something like the following:</p>\n\n<pre><code>    &lt;div class=\"btn-group\" data-toggle=\"buttons-radio\"&gt;\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2007', if @dates.start_year == 2007 :checked =&gt; true end %&gt; 2007\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2008', if @dates.start_year == 2008 :checked =&gt; true end %&gt; 2008\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2009', if @dates.start_year == 2009 :checked =&gt; true end %&gt; 2009\n    &lt;/div&gt;\n</code></pre>\n\n<p>But I get the following error:</p>\n\n<pre><code>syntax error, unexpected keyword_ensure, expecting ')'\nsyntax error, unexpected keyword_end, expecting ')'\n</code></pre>\n\n<p>I must be making a mistake in the if statement within the radio button, but I'm not sure how exactly to correct this</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","date"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13208413,"title":"Subtracting two dates in ruby on rails","body":"<p>I'm subtracting two dates in my model in this way:-</p>\n\n<pre><code>  def total_days\n      self.to_date - self.from_date\n  end\n</code></pre>\n\n<p>My date is in <code>Mysql  Date</code> (YYYY-MM-DD)format.</p>\n\n<p>When displaying my date in view it is giving me <code>5/1</code> days. Even though 5 is correct it is appending <code>'/1'</code> to the days. How can i remove this. Is there any better way of doing it?</p>\n"},{"tags":["ruby-on-rails-3","video-capture"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":752,"score":3,"question_id":6978578,"title":"Video Recording with webcam on a webpage","body":"<p>I have a requirement of recording video via web cam, on my webpage. What are the available plugins for the same. My website is developed using Ruby on Rails framework</p>\n\n<p>Regards,\nPankaj</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","font-face","mime-types"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13204752,"title":"Chrome warning: Resource interpreted as Font but transferred with MIME type font/svg","body":"<p>I get the following warning in Chrome dev tools about a base64 encoded font which is embedded in one of the CSS files in a site I'm working on.</p>\n\n<pre><code>Resource interpreted as Font but transferred with MIME type font/svg: \"data:font/svg;charset=utf-8;base64,PD94bWwgd -- big base64 encoded string -- 2RlZnM+PC9zdmc+\"\n</code></pre>\n\n<p>In the CSS, the font is inserted like this:</p>\n\n<pre><code>@font-face {\n  font-family: 'PrintBelt';\n  src: url('data:font/svg;charset=utf-8;base64,PD94bWwgd -- big base64 encoded string -- 2RlZnM+PC9zdmc+\") format('svg'), url('data:font/ttf;charset=utf-8;base64,AAEAAAANAIAA -- other big base64 encoded string -- AAAAzLVVtw==') format('truetype');\n}\n</code></pre>\n\n<p>I've searched around and found some blog posts and SO questions which aim to explain how to fix this problem. None of them seem to deal with fonts which are embedded in the CSS however.</p>\n\n<ol>\n<li><a href=\"http://stackoverflow.com/questions/2871655/proper-mime-type-for-fonts\">Proper mime type for fonts</a></li>\n<li><a href=\"http://danhunter.co.uk/articles/3-ha-in-your-font-face\" rel=\"nofollow\">Ha! In your font-face</a></li>\n</ol>\n\n<p>What can I change in either Rails (3.2.8) or the CSS in order to silence this warning?</p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-ui","jquery-autocomplete","jquery-ui-autocomplete"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13207190,"title":"rails3-jquery-autocomplete - highlight search term in results","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2435964/jqueryui-how-can-i-custom-format-the-autocomplete-plug-in-results\">jQueryUI: how can I custom-format the Autocomplete plug-in results?</a>  </p>\n</blockquote>\n\n\n\n<p>I cannot find my way in the autocomplete-rails.js uncompressed file</p>\n\n<p>What part of the code should I change so I'll have the results have the search term marked?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12891790,"title":"Will returning a nil value from a block passed to Rails.cache.fetch clear it?","body":"<p>Let's suppose I have a method like this:</p>\n\n<pre><code>  def foo\n    Rails.cache.fetch(\"cache_key\", :expires_in =&gt; 60.minutes) do\n      return_something\n    end\n  end\n</code></pre>\n\n<p><code>return_something</code> sometimes returns a <code>nil</code> value. When this happens, I don't want the <code>nil</code> value to be cached for 60 minutes. Instead, the next time I call <code>foo</code>, I want the block passed to <code>fetch</code> to be executed again.</p>\n\n<p>Is <code>Rails.cache.fetch</code> working like this by default? Or do I have to implement this functionality?</p>\n\n<h1>Update (with Answer)</h1>\n\n<p>Turns out, the answer was no, at least when using Memcached.</p>\n"},{"tags":["jquery","ruby-on-rails-3","document-ready"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13206916,"title":"Why does $(document).ready() never fire but $(window).load() will?","body":"<p>I'm working with Rails 3.2.8 and am running jQuery v1.8.2. </p>\n\n<p>The following works:</p>\n\n<pre><code>$(window).load(function(){\nalert('window load is working');\n});\n</code></pre>\n\n<p>But this does not work:</p>\n\n<pre><code>$(document).ready(function() {\nalert('document ready is working');\n});      \n</code></pre>\n\n<p>In fact, whenever I switch <code>$(document).ready()</code> with <code>$(window).load()</code> for any and all jQuery functions I am testing, they are fired. These include accordions, draggable elements... </p>\n\n<p>Here is my <strong>application.html.erb</strong> file:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;%= full_title(yield(:title)) %&gt;&lt;/title&gt;\n&lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n&lt;%= javascript_include_tag \"application\" %&gt;\n&lt;%= csrf_meta_tags %&gt;\n&lt;/head&gt;\n&lt;body background=\"&lt;%= image_path(random_bg) %&gt;\"&gt;\n&lt;%= render 'layouts/header' %&gt;\n\n&lt;div id=\"container\"&gt;\n\n&lt;% flash.each do |key, value| %&gt;\n      &lt;div class=\"alert alert-&lt;%= key %&gt;\"&gt;&lt;%= value %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;%= yield %&gt;\n&lt;/div&gt;\n &lt;%= render 'layouts/footer' %&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The resulting html...</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Derp&lt;/title&gt;\n*bunch of css files*\n&lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery-ui.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/collections.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/global.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/derp.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/sessions.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/static_pages.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/test.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/users.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/application.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n....\n</code></pre>\n\n<p>I have also gone throw stackoverflow, searched the web neurotically, and tried all the solutions I could find:</p>\n\n<ul>\n<li>I have tried disabling local jQuery and using Google to host jQuery</li>\n<li>I have tried playing around with the placement of <code>javascript_include_tag</code> (moving it above stylesheets, moving it before )</li>\n<li>I tried including <code>$(document).ready()</code> inside <code>$(window).load()</code></li>\n</ul>\n\n<p>But <code>$(document).ready()</code> still does not fire... There are no problems in console (checked on Chrome, Safari, Firefox)</p>\n\n<p>A similar question was asked <a href=\"http://stackoverflow.com/questions/6022357/why-does-window-load-work-but-not-document-ready\">here</a>, but he never received an answer to his main question.</p>\n\n<p><strong>Why does jQuery only work when I replace <code>$(document).ready()</code> with <code>$(window).load()</code>?</strong></p>\n"},{"tags":["ruby-on-rails-3","wkhtmltopdf","pdfkit"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":12312591,"title":"How to use WKhtmltopdf Library without using executable","body":"<p>In ruby on rails project.</p>\n\n<p>I am using <strong>PDFKit</strong> gem for generating pdf reports</p>\n\n<pre><code>PDFKit uses wkhtmltopdf executable which is to be installed on the machine .\n</code></pre>\n\n<ul>\n<li><p>And next step to give the path of the executable .</p></li>\n<li><p>I <strong>dont want  to use the executable file</strong> .because if i use it how to deploy it on server .</p></li>\n<li><p>the server will need to install it on its local and give the path.</p></li>\n</ul>\n\n<p>Is it possible to use only library????</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3005,"score":1,"question_id":7526424,"title":"How to start rails server?","body":"<p>I am developing <strong>rails 2.3.2</strong> application.</p>\n\n<p>When I type the command \"<em>rails script/server</em>\"</p>\n\n<p>I got the following output instead of server starting why?</p>\n\n<pre><code>rails script/server\nUsage:\n  rails new APP_PATH [options]\n\nOptions:\n  -J, [--skip-javascript]        # Skip JavaScript files\n      [--dev]                    # Setup the application with Gemfile pointing to your Rails checkout\n      [--edge]                   # Setup the application with Gemfile pointing to Rails repository\n  -G, [--skip-git]               # Skip Git ignores and keeps\n  -m, [--template=TEMPLATE]      # Path to an application template (can be a filesystem path or URL)\n  -b, [--builder=BUILDER]        # Path to a application builder (can be a filesystem path or URL)\n      [--old-style-hash]         # Force using old style hash (:foo =&gt; 'bar') on Ruby &gt;= 1.9\n      [--skip-gemfile]           # Don't create a Gemfile\n  -d, [--database=DATABASE]      # Preconfigure for selected database (options: mysql/oracle/postgresql/sqlite3/frontbase/ibm_db/jdbcmysql/jdbcsqlite3/jdbcpostgresql/jdbc)\n                                 # Default: sqlite3\n  -O, [--skip-active-record]     # Skip Active Record files\n      [--skip-bundle]            # Don't run bundle install\n  -T, [--skip-test-unit]         # Skip Test::Unit files\n  -S, [--skip-sprockets]         # Skip Sprockets files\n  -r, [--ruby=PATH]              # Path to the Ruby binary of your choice\n                                 # Default: /home/xichen/.rvm/rubies/ruby-1.8.7-p352/bin/ruby\n  -j, [--javascript=JAVASCRIPT]  # Preconfigure for selected JavaScript library\n                                 # Default: jquery\n\nRuntime options:\n  -q, [--quiet]    # Supress status output\n  -s, [--skip]     # Skip files that already exist\n  -f, [--force]    # Overwrite files that already exist\n  -p, [--pretend]  # Run but do not make any changes\n\nRails options:\n  -h, [--help]     # Show this help message and quit\n  -v, [--version]  # Show Rails version number and quit\n\nDescription:\n    The 'rails new' command creates a new Rails application with a default\n    directory structure and configuration at the path you specify.\n\nExample:\n    rails new ~/Code/Ruby/weblog\n\n    This generates a skeletal Rails installation in ~/Code/Ruby/weblog.\n    See the README in the newly created application to get going.\n</code></pre>\n\n<p>When I type linux command \"ls\" I got the following directories and files showing:</p>\n\n<pre><code>app  Capfile  config  criptq  db  doc  features  Gemfile  Gemfile.lock  generate  lib  log  nbproject  public  Rakefile  README  script  spec  test  tmp  vendor\n</code></pre>\n\n<p>my <strong>Gemfile</strong> is:</p>\n\n<pre><code>source \"http://rubygems.org\"\n\ngem \"rails\", \"2.3.2\"\ngem \"mysql\", \"2.8.1\"\ngem \"fastercsv\"\ngem \"will_paginate\", \"2.3.16\"\ngem \"chronic\", \"0.6.4\"\ngem \"whenever\", \"0.4.1\"\ngem \"searchlogic\", \"2.4.28\"\n\ngroup :development do\n  gem \"mongrel\", \"1.1.5\"\nend\n\ngroup :test do\n  gem \"rspec\", \"1.3.2\"\n  gem \"rspec-rails\", \"1.3.4\"\n  gem \"factory_girl\", \"1.3.3\"\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","backbone.js"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":136,"score":2,"question_id":12497897,"title":"Testing JSON API in Rails 3.2 using rspec using exact PUT/POST bodies as Backbone would send","body":"<p>I'm trying to write a set of rspec tests for a JSON API written in Rails 3.2 with Backbone as the front end. The tests I'm writing are specifically for the Rails controllers.</p>\n\n<p>Now, the application itself is working fine. When a client issues a PUT request with the body:</p>\n\n<pre><code>{\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n}\n</code></pre>\n\n<p>Everything is great. In the background Rails will take that body, then transform it into:</p>\n\n<pre><code>{\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n  \"model_name\" =&gt; { ... }\n}\n</code></pre>\n\n<p>where the hash \"model_name\" points to contains the attribute values it can automatically figure out from the input. All is well.</p>\n\n<p>When I try the same exact request from the testing environment, all is not well. If I create a hash that is exactly the same PUT body hash as above, but in rspec:</p>\n\n<pre><code>@update_json = {\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n}\nheader \"Accept\",\"application/json\"\nheader \"Content-type\",\"application/json\"\nput :update, @update_json\n</code></pre>\n\n<p>Things do not work out at all. In the controller, if I inspect the params variable I get:</p>\n\n<pre><code>{ \"model_name\" =&gt; {} }\n</code></pre>\n\n<p>If I omit the \"Content-type\" header line, I get instead @update_json, but without the Rails manipulation that creates the \"model_name\" mapping which I require in my controller.</p>\n\n<p>The only way I've gotten a successful test to run is the following:</p>\n\n<pre><code>@update_json = {\n  :format =&gt; \"json\",\n  \"id\":1,\n  \"model_name\" =&gt; {\n      \"id\":1,\n      \"name\":\"updated product set\",\n      ...\n  }\n}\nheader \"Accept\",\"application/json\"\nput :update, @update_json\n</code></pre>\n\n<p>However, this is not a real-world test since it's not testing the exact PUT body that would be sent by my backbone front-end.</p>\n\n<p>Any ideas?</p>\n\n<p>UPDATE:\nFrom looking around it <em>looks</em> like you can't actually do a real HTTP request from rspec; it's just mocked up. For example, you can't get the system to respond with a 404 since Rails throws an Exception that would normally be caught by Rails network stack and turned into a 404 but which isn't with Rspec. So the problem looks deeper than what's above...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13206248,"title":"Sorting table by both column and row Rails","body":"<p>Here, I want to set up a weekly planner where I will later insert plans into.</p>\n\n<p>I have the columns sorted by the days of the week.(Monday, Tuesday...)\nNow, I want the row to be sorted by the time. </p>\n\n<p>However, with my code below. For every column, it loops through the same number of times as the number of items in my time slot.</p>\n\n<p>Would appreciate it if you could give me some guidance on how I should go about fixing it such that each timeslot only appears once throughout the whole table.</p>\n\n<p>The codes</p>\n\n<pre><code>&lt;table class=\"Time Table\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;&lt;%= \"Time\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Monday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Tuesday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Wednesday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Thursday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Friday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Saturday\" %&gt;&lt;/th&gt;\n\n &lt;/tr&gt;\n  &lt;% @time_slots.each do |time_slot| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Monday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Tuesday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Wednesday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Thursday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Friday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Saturday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13190459,"title":"Formatting JSON output using map method - Rails 3","body":"<p>I'm lacking some understanding on using the map method. </p>\n\n<p>Using json output with no mapping</p>\n\n<pre><code>format.json  { render :json =&gt; @categories }\n</code></pre>\n\n<p>gives me the following output</p>\n\n<pre><code>[{\"created_at\":\"2012-10-20T01:16:35+11:00\",\"id\":1,\"name\":\"bathroom renovations\",\"updated_at\":\"2012-10-20T01:16:35+11:00\"}]\n</code></pre>\n\n<p>using json with mapping</p>\n\n<pre><code>format.json  { render :json =&gt; @categories.map(&amp;:name) }\n</code></pre>\n\n<p>gives me this output</p>\n\n<pre><code>[\"bathroom renovations\"]\n</code></pre>\n\n<p>How can I get my output to look like</p>\n\n<pre><code>[{\"id\":\"1\",\"name\":\"bathroom renovations\"}]\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13206348,"title":"Rails flash messages not clearing","body":"<p>Here is my environment: Rails 3.2.0 and Ruby 1.9.2.</p>\n\n<p>After upgrading my session storage to database, none of my flash messages are clearing after any requests.  If I revert back to cookie session storage, flash messages are clearing as expected.  Has anyone encountered this problem?</p>\n\n<p>Thanks!</p>\n\n<p>Paul</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","jquery-autocomplete","acts-as-taggable-on"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13199708,"title":"acts_as_taggable_on and rails autocomplete gem - displaying tag counts","body":"<p>I am using the acts_as_taggable_on gem and the rails jquery autocomplete gem</p>\n\n<p>I know how to get the tag counts via the gem</p>\n\n<p>I know that in order to display something else other than the return search results for the autocomplete I need to do something like this</p>\n\n<pre><code>autocomplete :tag, :name, :class_name =&gt; 'ActsAsTaggableOn::Tag', :full =&gt; true\n</code></pre>\n\n<p>and adding 2 more keys which are </p>\n\n<pre><code>:extra_data , :display_value\n</code></pre>\n\n<p>the extra data will retrieve the more data in the search (not sure it is needed here)\nthe display_value will call a method from within the model which is searched with the autocomplete.</p>\n\n<p><strong>The problem:</strong></p>\n\n<p>I don't know where to put the method for the display_value which should be something like</p>\n\n<pre><code>def tags_with_counts\n \"#{tag.name} x #{tag.count}\nend\n</code></pre>\n\n<p>As I don't have a tag model file to put it in (since the acts_as_taggable_on does not generate such file.</p>\n\n<p>But even if I did have such file, from previous experiments, that method can only use data that is retrieved with the autocomplete search, and I don't have a column with tag counts.</p>\n\n<p>What do I do to solve this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":10,"favorite_count":23,"up_vote_count":51,"down_vote_count":0,"view_count":18796,"score":51,"question_id":5968131,"title":"Upgrading from Rails 3 to Rails 3.1","body":"<p>How do you upgrade from Rails 3 to Rails 3.1 beta?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":815,"score":1,"question_id":5629309,"title":"Passing virtual attribute values through to form elements in Rails 3","body":"<p>I have the following in my model:</p>\n\n<blockquote>\n  <p>before_validation :update_temp</p>\n  \n  <p>attr_accessor :temp_int, :temp_dec</p>\n  \n  <p>def update_temp</p>\n  \n  <blockquote>\n    <p>self.temp = temp_int.to_f + (temp_dec.to_f / 10)</p>\n  </blockquote>\n  \n  <p>end</p>\n</blockquote>\n\n<p>And I have the following in my view:</p>\n\n<blockquote>\n  <p>&lt;%= f.select(:temp_int, [\"97\", \"98\"], { :include_blank => true })%> . </p>\n  \n  <p>&lt;%= f.select(:temp_dec, [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"], { :include_blank => true })%></p>\n</blockquote>\n\n<p>This works great for saving the temperature values. However, there's one issue. Normally on the edit screen, the select helper would have the existing values pre-selected. But using the virtual attributes this isn't happening.</p>\n\n<p>How do I make sure that the temp_int and temp_dec values get passed to the view?</p>\n"},{"tags":["ruby-on-rails-3","model"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13203842,"title":"associated models in rails 3","body":"<p>I think I may be missing something here or my understanding of rails model association isnt quite there yet (still learning). I have two models, a recipe and a ingredient. A recipe has many ingredients, and when i fill my form in i want to post recipe and ingredient params to their respective dbs</p>\n\n<p>Recipe Model</p>\n\n<pre><code> class Recipe &lt; ActiveRecord::Base\n\n attr_accessible :dish_name, :country_of_origin, :difficulty, :preperation_time\n has_many :ingredients\n\n end\n</code></pre>\n\n<p>Ingredients Model</p>\n\n<pre><code> class Ingredient &lt; ActiveRecord::Base\nbelongs_to :recipe\nattr_accessible :ingredients\nend\n</code></pre>\n\n<p>recipe controller</p>\n\n<pre><code> def new \n\n @recipe = Recipe.new\n\n end\n\n def create\n\n @recipe = Recipe.new(params[:recipe])\n if @recipe.valid?\n @recipe.save\n redirect_to recipes_path, :notice =&gt; \"Recipe sucessfully created.\"\n else\n flash.now.alert = \"Please ensure all fields are filled in.\"\n render :new\n\n end\nend\n</code></pre>\n\n<p>Ingredients Controller</p>\n\n<pre><code>  def new\n  @ingredient = recipes.find(params[:recipes_id].ingredients.new\n  @recipe_id = params[:recipe_id]\n  end\n</code></pre>\n\n<p>Form</p>\n\n<pre><code>&lt;%= form_for @recipe  do |f| %&gt;\n\n&lt;%= f.label :dish_name, \"Dish Name\" %&gt;\n&lt;%= f.text_field :dish_name, :placeholder =&gt; \"Enter Dish Name\" %&gt;\n\nmore fields here(wanted to keep as short as poss)\n\n&lt;%= f.label :ingredients, \"Ingredients\" %&gt;\n&lt;%= f.text_field :ingredients , :class =&gt; :ingred, :placeholder =&gt; \"Enter Ingredient Here\" %&gt;&lt;br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Apologies for the size of the code, is anything else needed to see why i cannot create a recipe?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","http","http-headers","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13205814,"title":"How to make a DELETE link to a rails resource?","body":"<p>If I want to make a DELETE link in rails, I write the following code (in this example case to delete a user session in Devise):</p>\n\n<pre><code>&lt;%= link_to('Logout', destroy_user_session_path, :method =&gt; :delete) %&gt;\n</code></pre>\n\n<p>That will turn into the following HTML:</p>\n\n<pre><code>&lt;a rel=\"nofollow\" data-method=\"delete\" href=\"/users/sign_out\"&gt;Logout&lt;/a&gt;\n</code></pre>\n\n<p>Works great, except I can't simply put that HTML into a static HTML page. It will simply do a GET request. I assume Rails includes some standard Javascript to turn the above link to one that actually does a DELETE request. So what's the proper way to have a link on a static HTML page to a Rails resource that does a DELETE action? Should I find and grab that Javascript Rails includes in all webpages that does this? Is there a better way?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13201522,"title":"Best way to duplicate parent and associated child records in Ruby on Rails?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6711956/activerecord-how-can-i-clone-nested-associations\">ActiveRecord: How can I clone nested associations?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a table with <code>invoices</code> which in turn can have many <code>items</code>.</p>\n\n<p>Now in my <code>invoices</code> index view I would like to place a link next to each <code>invoice</code> saying <em>Duplicate Invoice</em>.</p>\n\n<p>Without the child records this would be quite easy:</p>\n\n<pre><code>&lt;%= link_to \"Duplicate\", new_invoice_path(invoice.attributes) %&gt;\n</code></pre>\n\n<p>But how can this be done if the invoice's <code>items</code> should be duplicated as well?</p>\n\n<p>As a Rails newbie I can't get my head around this. Can all this be handled by the <code>new</code> action inside my controller?</p>\n\n<pre><code>def new\n  @invoice = current_user.invoices.build(:project_id =&gt; params[:project_id])\n  @title = \"New invoice\"\nend\n</code></pre>\n\n<p>Or do I need to create another function named e.g. <code>copy</code> inside my controller?</p>\n\n<p>What is the best practice?</p>\n\n<p>Thanks for any input...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13202585,"title":"ticket booking engine rails","body":"<p>Im trying o set up an rails application that handles ticket booking system for e venue.\nDoes anybody have any suggestions about architecture, gems or general approach yhat could help? Would be grateful for suggestions.</p>\n"},{"tags":["javascript","arrays","ruby-on-rails-3","view"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13190596,"title":"mongomapper and rails view for array","body":"<p>i have a rails controller grabbing some data from mongodb. the field i'm interested in is actually an array and i would like to expose this in an erb view.</p>\n\n<p>my current hack is to just set the javascript variable in the view directly (where item.array = [ \"one\", \"two\" ]):</p>\n\n<pre><code>var array = &lt;%= item.array %&gt;;\n</code></pre>\n\n<p>however, i see that the code is coming out escaped such that the html is coming out like</p>\n\n<pre><code>var array = [&amp;quot;one&amp;quot;, &amp;quot;two&amp;quot;];\n</code></pre>\n\n<p>is there a helper function i can use so that i can set the array directly in the javascript?</p>\n\n<p>(long term is to move this into a json call, but i just want to get something working for now)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nested-forms","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13204661,"title":"RoR: Nested forms and dynamic fields","body":"<p>I am struggling with some nested forms which dynamically inserts fields. I have based my code on Ryan Bates great railscasts.  My problem though is that I need to move my \"add fields\" button outside the nested form.  This causes problems because I don't have access to some of the objects required to generate the form.</p>\n\n<p>In the code below the add/remove button is in the same location.  I can change the if statement to do this, but I cannot move the add fields button outside the f.simple_fields_for :fund_levels loop.</p>\n\n<p>Any suggestions for a clean way of doing this?</p>\n\n<p>The view</p>\n\n<pre><code>     = f.simple_fields_for :fund_levels do |fl|\n       - fl.object.id ? headerappend = fl.object.id : headerappend = \"#{i}-notset\"\n       %div{id: \"flheader-#{headerappend}\"}\n         %div\n           = link_to \"Sponsor levels\", \"#\", :class =&gt; \"show_hide\", :id =&gt; \"initiator1_fl#{i}\", :style=&gt;\"margin-bottom:2px;\", :onclick=&gt;\"return false\"\n         %div{:class =&gt; \"slidingDiv #{fund_levels_last?(i, @fund_level_count) ? \"shown\": \"hidd\" } whitebg leftadj\", :id=&gt;\"body_fl#{i}\", :style=&gt;\"width:100%;\" }\n\n           = render :partial =&gt; 'fund_level_fields', :locals =&gt; {:fl =&gt; fl, :ad =&gt; ad, :i =&gt; i, :f =&gt; f}\n           %div{:style =&gt; \"float: right; padding: 20px 20px 20px 0\"}\n             = fund_levels_last?(i, @fund_level_count) ? ( link_to_add_fields \"add new level\", f, :fund_levels, fl, i+1, ad ) : ( link_to \"remove\", accounts_ad_fund_level_path(ad, fl.object.id), {:class =&gt; 'button orange sm', :method =&gt; :delete, :remote =&gt; true, :confirm =&gt; t('q.are_you_sure')} )\n       - i += 1\n     %div#newfields\n       - # THE BUTTON SHOULD GO HERE if it is an ADD FIELDS (remove btn should stay above)\n</code></pre>\n\n<p>the application_helper file</p>\n\n<pre><code>   def link_to_add_fields(name, f, association, sublevel, counter, parent)\n\n     new_object = f.object.class.reflect_on_association(association).klass.new\n     fields = f.fields_for(association, new_object, :child_index =&gt; \"new_#{association}\") do |builder|\n       render(association.to_s.singularize + \"_fields\", :f =&gt; builder, :fl =&gt; sublevel, :i =&gt; counter, :ad =&gt; parent) #fl, i, ad\n     end\n\n     # this bit is required because of some bugs in haml\n     fields.gsub!(/\\&lt;haml\\:newline\\/\\&gt;/, '').html_safe\n\n     link_to name, '#', :id =&gt; \"#{name}|-|#{association}|-|#{fields}\", :class =&gt; \"addfields\", :onclick =&gt; \"return false\"\n   end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","json","internet-explorer","cors"],"answer_count":2,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":1242,"score":3,"question_id":8501021,"title":"Rails JSON request is not parsed correctly into post parameters","body":"<p>I'm trying to debug a problem where Rails isn't decoding the JSON POST data.</p>\n\n<p>The server logs show:</p>\n\n<pre><code>2011-12-14T06:44:44+00:00 app[web.2]: Started POST \n2011-12-14T06:44:44+00:00 app[web.2]:   Processing by PostsController#create as */*\n2011-12-14T06:44:44+00:00 app[web.2]:   Parameters: {\"{\\\"athlete_id\\\":\\\"\\\",\\\"known_as\\\":\\\"abc\\\",\\\"email\\\":\\\"abc@defg.com\\\",\\\"result\\\":\\\"112233\\\",\\\"rx\\\":false,\\\"mods\\\":\\\"thkjth\\\",\\\"notes\\\":\\\"\\\"}\"=&gt;nil, \"affiliate_id\"=&gt;\"testaffiliate\", \"wod_id\"=&gt;\"12345\"}\n</code></pre>\n\n<p>Note that the JSON string is not being parsed - Rails is assigning it as a key in the hash, pointing to a nil value.  Does anyone have any ideas before I write a before_filter that tries to JSON.parse all of the params keys?</p>\n\n<p>I don't think this is relevant since I'm sending and receiving data okay, but this problem occurs during a CORS Request from IE (using XDomainRequest).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13188117,"title":"send_file return value","body":"<p>Does the <code>send_file</code> method in Rails give a return value? I'd like to do one thing if the sending is successful, and another thing if the sending is <em>not</em> successful. I looked at the documentation at <a href=\"http://apidock.com/rails/ActionController/Streaming/send_file\" rel=\"nofollow\">this link</a>, but did not find anything relevant.</p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":1024,"score":8,"question_id":7027518,"title":"No route matches rspec's anonymous controller","body":"<p>Based on my understanding of the <a href=\"http://relishapp.com/rspec/rspec-rails/v/2-1/dir/controller-specs/anonymous-controller\">rspec spec</a>, I would expect the following example to pass.</p>\n\n<pre><code>describe ApplicationController do\n\n  controller do\n    def test\n    end\n  end\n\n  it \"calls actions\" do\n    get :test\n  end\n\nend\n</code></pre>\n\n<p>Instead it fails with:</p>\n\n<pre><code>No route matches {:controller=&gt;\"anonymous\", :action=&gt;\"test\"}\n</code></pre>\n\n<p>I've even tried defining the route for the \"anonymous\" controller in the routes file but to no avail. Is there something I'm missing here? This should work, shouldn't it?</p>\n"},{"tags":["ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13071804,"title":"simple_form - how do I create radio buttons with nested input text boxes","body":"<p>I'm using simple_form to render my forms and trying to get the following behavior: I want the client to choose from 3 options. In every option he supplies additional field or two.<br>\nSo I'd like something like this:</p>\n\n<pre><code>Please set your preferences:  \n o Pay me on a specific day - [input field to get the day]  \n o Pay me a specific amount of money - [input field for the amount]  \n o Pay me on a regular basis - [radio buttons to choose between weekly/monthly basis]\n</code></pre>\n\n<p>I can create the radio buttons as follows, but can't add nested fields under them:</p>\n\n<pre><code>&lt;%= simple_form_for @client, action: 'edit_payment_method' do |f| %&gt;\n    &lt;%= f.input :payment_type, label: 'Please set your preferences:',\n        collection: [ ['Pay me on a specific day', :specific_day],\n        ['Pay me a specific amount of money', :specific_money],\n        ['Pay me on a regular basis', :regular_basis]\n     ], as: :radio_buttons %&gt;\n\n  &lt;%= f.button :submit, 'Submit' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What would be the best way to create the nested text boxes?<br>\nAs for the fields, I don't need to send them to different controllers (per payment_type), it's fine if I send them all to one method and read the relevant values according to the payment type he chose.</p>\n\n<p>Thanks! Zach   </p>\n"},{"tags":["ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13204422,"title":"Formatting Date with Simple Form","body":"<p>I'm using the <a href=\"https://github.com/plataformatec/simple_form\" rel=\"nofollow\">Simple Form gem</a> in my Rails app.  In my sign-up form, I'm have a field for birth date.  However, the fields are showing in this order: Year/Month/Day.  </p>\n\n<p>What's the best way to get the field order Month - Day - Year?</p>\n\n<p>My form looks like this:</p>\n\n<pre><code> &lt;%= simple_form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n   &lt;%= f.input :created_at %&gt;          \n   &lt;%= f.button :submit, \"Sign up\" %&gt;      \n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing","devise","routes"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1245,"score":6,"question_id":6659555,"title":"How to write controller tests when you override devise registration controller?","body":"<p>I wish to override the <code>Devise::RegistrationsController</code> to implement some custom functionalality. To do this, I've created a new <code>RegistrationsController</code> like so:</p>\n\n<pre><code># /app/controllers/registrations_controller.rb\nclass RegistrationsController &lt; Devise::RegistrationsController\n  def new\n    super\n  end\nend\n</code></pre>\n\n<p>and set up my routes like this:</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :registrations =&gt; \"registrations\" }\n</code></pre>\n\n<p>and tried to test it like this:</p>\n\n<pre><code>describe RegistrationsController do\n  describe \"GET 'new'\" do\n    it \"should be successful\" do\n      get :new\n      response.should be_success\n    end\n  end\nend\n</code></pre>\n\n<p>but that gives me an error:</p>\n\n<p>1) RegistrationsController GET 'new' should be successful\n     Failure/Error: get :new\n     AbstractController::ActionNotFound:\n       Could not find devise mapping for path \"/users/sign_up\".\n       Maybe you forgot to wrap your route inside the scope block? For example:</p>\n\n<pre><code>       devise_scope :user do\n         match \"/some/route\" =&gt; \"some_devise_controller\"\n       end\n # ./spec/controllers/registrations_controller_spec.rb:13:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>So what am I doing wrong?</p>\n"},{"tags":["ruby-on-rails","regex","ruby-on-rails-3","hyperlink"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13198997,"title":"Regex to Match Urls in Ruby on Rails","body":"<p>I have looked around but I haven't really found an answer that seals the deal 100% for my individual situation.</p>\n\n<p>In my Ruby app, I have a user share system where members can post 'stuff'.  Well, sometimes members post links, and I have noticed as the site grows, more and more users are complaining about there not being clickable links.</p>\n\n<p>How would I utilize regular expressions to match urls for links in posts.  Furthermore, how would I apply this in my Model?</p>\n\n<p>Thanks for you help, out of all my questions, this is a real important one for me ha!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I suppose my init post was too vague...</p>\n\n<p>I am more trying to figure out HOW to IMPLEMENT the use of regular expressions into my model  instead of which regular expression to use.</p>\n\n<p>The model is <code>class Share</code>.  And the member's post is rendered as <code>&lt;%= share.content %&gt;</code> with content being a column in my Share table as well as an accessible attribute...</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","testing","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13204329,"title":"Setting host/remote_addr and other env properties in Rails 3 controller tests","body":"<p>In Rails 2, you could specify the host and other Rack env properties in controller tests like so:</p>\n\n<pre><code>should \"spoof host and remote_addr\" do\n  get \"/thing/2\", {}, :remote_addr =&gt; \"192.71.1.2\", :host =&gt; \"somewhere.else\"\nend\n</code></pre>\n\n<p>However, for some reason this is not working out on Rails 3. I tried with a regular controller, and <code>env[\"HTTP_HOST\"]</code> isn't being set as expected (same with <code>\"REMOTE_ADDR\"</code>). I also tried this:</p>\n\n<pre><code>should \"use host and remote_addr\" do\n  request.env[\"REMOTE_ADDR\"] = \"192.71.1.2\"\n  request.env[\"HTTP_HOST\"] = \"git.gittit.it\"\n  get \"/thing/1\"\nend\n</code></pre>\n\n<p>This also used to work in Rails 2, but no longer in Rails 3. As a final test, I tried this with a route that resolved to a bare Rack app, same results.</p>\n\n<p>How can I spoof the host and IP address in a Rails 3 controller test?</p>\n"},{"tags":["ruby-on-rails-3","jquery-ui","select","knockout.js","datepicker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13203167,"title":"Select fields with Knockout.js","body":"<p>When I include the knockout.js library, all of my select fields disappear.  Is there a way for select fields to ignore knockout.js?</p>\n\n<p>It affects not only my drop downs, but also date picker...i.e. I have the following code:</p>\n\n<pre><code>    &lt;center&gt;\n      &lt;%= f.text_field :firstdate, :style=&gt;\"width:150px;\" %&gt; \n      - \n      &lt;%= f.text_field :seconddate, :style=&gt;\"width:150px;\" %&gt;\n      &lt;script&gt;\n      $(function() {\n            $( \"#post_firstdate\" ).datepicker({\n                  changeMonth: true,\n                  changeYear: true,\n                  yearRange: \"-112:+5\"\n            });\n            $( \"#post_seconddate\" ).datepicker({\n                  changeMonth: true,\n                  changeYear: true,\n                  yearRange: \"-112:+5\"\n            });\n      });\n      &lt;/script&gt;\n    &lt;/center&gt;\n</code></pre>\n\n<p>While I can select dates in data picker, typically the Month and Year fields are drop downs as well.  Now they disappear.</p>\n\n<p>Are there any suggestions on how to have certain fields ignore knockout?</p>\n\n<p>Thank you.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13184781,"title":"Rails session value being deleted when deleting a line_item","body":"<p>This one has me a perplexed. I'm still a newbie with Rails so it may be simple.</p>\n\n<p>The situation:</p>\n\n<ol>\n<li>I can add items to the cart, no problem. Everything works fine the current_cart method resolves to the same cart each request. </li>\n<li>But as soon as I remove a line item from the cart, it works, the line item is deleted, but the<br>\nvariable \"session[:cart_id]\" becomes null, and a new cart gets<br>\ncreated when current_cart is called the next time.</li>\n</ol>\n\n<p>I'm using Devise so I'm not sure if that has something to do with it, or maybe the line item delete method is cascade deleting the session or something like that.</p>\n\n<p>The question is, can anyone help me understand why the session variable is becoming null after calling line_item delete?</p>\n\n<p>I've created a cart application, following along with Agile web development with rails. Firstly, here's the code for application controller to retrieve the current cart:</p>\n\n<pre><code>  private\n  def current_cart \n    Checkout::Cart.find(session[:cart_id])\n  rescue ActiveRecord::RecordNotFound \n    cart = Checkout::Cart.create \n    session[:cart_id] = cart.id\n    cart\n  end\n</code></pre>\n\n<p>Now the code for my line item controller</p>\n\n<blockquote>\n  <p>class Checkout::LineItemsController &lt; ApplicationController</p>\n  \n  <p># POST /checkout/line_items   # POST /checkout/line_items.json   def\n  create</p>\n\n<pre><code>@cart = current_cart\nproduct = Catalog::Product.find(params[:product_id])\napparel_event_log.info (product.to_json)\n\n\n@checkout_line_item = @cart.line_items.find_or_initialize_by_sku_id(product.part_number)\nnew_quantity = @checkout_line_item.quantity || 0\n@checkout_line_item.quantity = new_quantity+1\n@checkout_line_item.line_item_description = product.name\n@checkout_line_item.image = product.primary_image\n\nrespond_to do |format|\n  if @checkout_line_item.save\n    format.html { redirect_to @checkout_line_item.cart, notice: 'Line item was successfully created.' }\n    format.json { render json: @checkout_line_item, status: :created, location: @checkout_line_item }\n  else\n    format.html { render action: \"new\" }\n    format.json { render json: @checkout_line_item.errors, status: :unprocessable_entity }\n  end\nend   end\n</code></pre>\n  \n  <p># DELETE /checkout/line_items/1   # DELETE\n  /checkout/line_items/1.json   def destroy\n      Checkout::LineItem.delete(params[:id])</p>\n\n<pre><code>respond_to do |format|\n  format.html { redirect_to current_cart, notice: 'Line item removed.' }\n  format.json { head :no_content }\nend   end end\n</code></pre>\n</blockquote>\n\n<p>and also the code for the line items model</p>\n\n<pre><code>class Checkout::LineItem &lt; ActiveRecord::Base\n  before_save :default_values\n\n  attr_accessible :customer_update_date, :inventory_status, :line_item_color, :line_item_description, :line_item_size, :line_item_tagline, :line_item_total, :image, :quantity, :sku_id, :style_id, :tax, :tax_code, :timestamps, :unit_price, :cart, :product\n  belongs_to :cart\n  belongs_to :product, :class_name =&gt; 'Catalog::Product'\n  has_one :image, :class_name =&gt; 'Assets::Medium'\n\n  def default_values\n     Rails.logger.debug { \"Entering default values\" }\n     self.quantity ||= 0\n   end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","login","user"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13204133,"title":"User Can Not Login with Email Address Capitalized","body":"<p>I have build a user model using Michael Hartl tutorial. In his tutorial, he states the model is being built off of falsifying case sensitivity to allow users to login with the combination of:\n\"foo@bar.com, Foo@bar.com, FOO@bar.com\"</p>\n\n<p><strong>User Model</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base \n  attr_accessible :name, :email\n\n  before_save { self.email.downcase! }\n  before_save :create_remember_token\n\n  validates :name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence:   true,\n                format:     { with: VALID_EMAIL_REGEX },\n                uniqueness: { case_sensitive: false }\n\n  validates :password, presence: true, length: { minimum: 6 }, :on =&gt; :create\n  validates :password_confirmation, presence: true\n\nend\n</code></pre>\n\n<p>However when my user tries to login using \"Foo@bar.com\" it does not allow. They have to make the first letter lower case in order for it to authenticate.</p>\n\n<p>Anyone know why case_sensitive false is not working?</p>\n\n<p>TIA</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","typhoeus","hydra"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13203722,"title":"undefined method `cache_getter' for Typhoeus::Hydra","body":"<p>I don't know why I get this error. Both methods are corrects.</p>\n\n<pre><code>hydra = Typhoeus::Hydra.new\n\n             hydra.cache_getter do |request|\n                Rails.cache.read(request.cache_key) rescue nil\n             end\n             hydra.cache_setter do |request|\n               Rails.cache.write(request.cache_key,request.response, expires_in: request.cache_timeout)\n             end\n</code></pre>\n\n<p>ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-darwin11.4.2]</p>\n\n<p>Rails 3.2.8</p>\n"},{"tags":["ruby-on-rails-3","routing","subdomain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13017184,"title":"Rails 3 Subdomain For Existing Rails Application","body":"<p>I was recently tasked with segregating my existing Rails 3 application into a standard and premium version. The premium version will have all the existing functionality with the addtion of a new layout, and new functionality. Ideally I want premuim users to access this site byway of prefixing the current url with a subdomain, e.g, \"premium.somesite.com\"/ The standard version of the website I don't want to change and is still accessible by the default url.</p>\n\n<p>If possible I would like to simply add some logic to exiting views and controller to determine how the request is treated on whether or not a subdomain is being used . </p>\n\n<p>I tried following the Railcast <a href=\"http://railscasts.com/episodes/221-subdomains-in-rails-3?view=asciicast\" rel=\"nofollow\">subdomains in rails 3</a>, however he's using subdomains in context of a blog model and database attributes where as I wanted mine to be application-wide. Is this even possible with subdomains? How can I get started?</p>\n\n<hr>\n\n<p><strong>What I've tried:</strong></p>\n\n<p>Added an additional VirtualHost to my apache httpd.conf file used by passenger:</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n  ServerName premium.mydomain.com\n  DocumentRoot /somewhere/../myapp\n  &lt;Directory /somewhere/public&gt;\n    Allow from all\n    Options -Multiviews\n  &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>Added the following to my routes.rb</p>\n\n<pre><code>class PremiumSubdomain\n  def self.matches?(request)\n    request.subdomain == \"premium\"\n  end\nend\n\nMyApp::Application.routes.draw do    \n  constraints(PremiumSubdomain) do    \n    #all of my routes...    \n  end    \nend\n</code></pre>\n\n<p><strong>What happens:</strong> </p>\n\n<p>Trying to navigate to my site with the premium subdomain results in a domain not found, adding the constraint to my route.rb prevents the rest of the application from rendering anything on my default url. </p>\n"},{"tags":["ruby-on-rails-3","testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13203750,"title":"NameError: uninitialized constant ActiveRecord::Errors","body":"<p>I'm new to rails, and I am not sure how to proceed. I'm trying to complete the \"RailsSpace\" book but am running into errors in the section about testing.  (page 119 for anyone that may have the book)</p>\n\n<p>Rails 3.2.8</p>\n\n<p>ruby 1.9.3p194</p>\n\n<p>When running this in console:</p>\n\n<pre><code>@error_messages = ActiveRecord::Errors.default_error_messages; 0\n</code></pre>\n\n<p>I get this error:</p>\n\n<p><strong>NameError: uninitialized constant ActiveRecord::Errors</strong></p>\n\n<p>when running <code>rake test:units</code></p>\n\n<p>I get: </p>\n\n<pre><code>DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /Users/home/rails_projects/retrospection/Rakefile:7)\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /Users/home/rails_projects/retrospection/config/environment.rb:5)\nRun options: \n\n\n# Running tests:\n\nEEEEE\n\nFinished tests in 0.108070s, 46.2663 tests/s, 0.0000 assertions/s.\n\n  1) Error:\ntest_screen_name_maximum_length(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n  2) Error:\ntest_screen_name_minimum_length(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n  3) Error:\ntest_uniqueness_of_screen_name_and_email(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n  4) Error:\ntest_user_invalidity(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n  5) Error:\ntest_user_validity(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n5 tests, 0 assertions, 0 failures, 5 errors, 0 skips\nrake aborted!\nCommand failed with status (5): [/Users/home/.rvm/rubies/ruby-1.9.3-p194/bi...]\n\nTasks: TOP =&gt; test:units\n</code></pre>\n\n<p>My <strong>user_test.rb</strong> file looks like this:</p>\n\n<pre><code>require 'test_helper'\n\nclass UserTest &lt; ActiveSupport::TestCase\n\n\n  def setup \n    @error_messages = ActiveRecord::Errors.default_error_messages\n    @valid_user = users(:valid_user)\n    @invalid_user = users(:invalid_user)\n  end\n\n  #This user should be valid by construction.\n  def test_user_validity\n    assert @valid_user.valid?\n  end\n\n  #This user should be invalid by construction.\n  def test_user_invalidity\n    assert !@invalid_user.valid?\n    attributes = [:screen_name, :email, :password]\n    attributes.each do |attribute|\n      #assert @invalid_user.errors.invalid?(attribute) OLD CODE DOES NOT WORK IN RAILS3\n       assert @invalid_user.invalid?(attribute)\n    end\n  end\n\n  def test_uniqueness_of_screen_name_and_email\n    user_repeat = User.new( :screen_name =&gt; @valid_user.screen_name,\n                            :email       =&gt; @valid_user.email,\n                            :password    =&gt; @valid_user.password)\n    assert !user_repeat.valid?\n    assert_equal @error_messages[:taken], user_repeat.errors.on(:screen_name)\n    assert_equal @error_messages[:taken], user_repeat.errors.on(:email)\n\n  end\n\n  #MAKE SURE THE SCREEN NAME CAN'T BE TO SHORT\n  def test_screen_name_minimum_length\n    user = @valid_user\n    min_length = User::SCREEN_NAME_MIN_LENGTH\n\n    #Screen name is too short.\n    user.screen_name = \"a\" * (min_length - 1)\n    assert !user.valid?, \"#{user.screen_name} should raise a minimum length error\"\n    #Format the error message based on minimum length.\n    correct_error_message = sprintf(@error_messages[:too_short], min_length)\n    assert_equal correct_error_message, user.errors.on(:screen_name)\n\n    #Screen name is minimum length.\n    user.screen_name = \"a\" * min_length\n    assert user.valid?, \"#{user.screen_name} should be just long enough to pass\"\n  end\n\n  #MAKE SURE THE SCREEN NAME CAN'T BE TOO LONG\n  def test_screen_name_maximum_length\n      user = @valid_user\n      max_length = User::SCREEN_NAME_MAX_LENGTH\n\n      # Screen name is too long.\n      user.screen_name = \"a\" * (min_length + 1)\n    assert !user.valid?, \"#{user.screen_name} should raise a maximum length error\"\n    #Format the error message based on maximum length.\n    correct_error_message = sprintf(@error_messages[:too_long], max_length)\n    assert_equal correct_error_message, user.errors.on(:screen_name)\n\n    #Screen name is maximumlength.\n    user.screen_name = \"a\" * max_length\n    assert user.valid?, \"#{user.screen_name} should be just short enough to pass\"\n  end\nend\n</code></pre>\n\n<p>According to the error message <strong>\"/Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\"</strong> The line causing the problem is</p>\n\n<pre><code>@error_messages = ActiveRecord::Errors.default_error_messages\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13201604,"title":"undefined local variable or method `config' for #<Bundler::Dsl:0x7fe2598d56d8>","body":"<p>I'm following the following tutorial:</p>\n\n<p><a href=\"http://railscasts.com/episodes/188-declarative-authorization?view=comments\" rel=\"nofollow\">http://railscasts.com/episodes/188-declarative-authorization?view=comments</a></p>\n\n<p>Also Had a go at following the documentation for the gem on Git:</p>\n\n<p><a href=\"https://github.com/stffn/declarative_authorization\" rel=\"nofollow\">https://github.com/stffn/declarative_authorization</a></p>\n\n<p>But had the same outcome both times which is:</p>\n\n<pre><code>mark@ubuntu:~/RoR Projects/blog$ sudo rake gems:install\nInvalid gemspec in [/var/lib/gems/1.8/specifications/tilt-1.3.3.gemspec]: invalid date format in specification: \"2011-08-25 00:00:00.000000000Z\"\nrake aborted!\nundefined local variable or method `config' for #Bundler::Dsl:0x7fe2598d56d8&gt;\n</code></pre>\n\n<p>I have followed each tutorial to the letter but keep getting the same output so I'm guessing this is a system issue at my end?</p>\n"},{"tags":["ruby-on-rails-3","mongoid","virtual-attribute"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13133092,"title":"Virtual attributes with multiple parameters","body":"<p>I have the following function that works just fine</p>\n\n<pre><code>def holiday_hours_for(holiday)\n  hours[\"holiday_hours\"][holiday.to_s] if hours[\"holiday_hours\"][holiday.to_s]\nend\n</code></pre>\n\n<p>I am just learning about virtual attributes, and am having some trouble figuring out the setter version of this function.  How would I achieve this function...</p>\n\n<pre><code>def holiday_hours_for(holiday)=(hours)\n  self.hours[\"holiday_hours\"][holiday.to_s] = hours if hours[\"holiday_hours\"][holiday.to_s]\nend\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>UPDATE:  I came up with the following, is this the best way?</p>\n\n<pre><code>  def update_holiday_hours_for(holiday, hours_text)\n    self.hours = Hash.new unless hours\n    self.hours[\"holiday_hours\"] = Hash.new unless hours[\"holiday_hours\"]\n    self.hours[\"holiday_hours\"][holiday.to_s] = hours_text.to_s\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13202319,"title":"Can't convert hash to integer - Trying to select random record","body":"<p>I'm trying to select a random record, but the only working method seems like a horrible performance liability.</p>\n\n<p>First attempt, using RANDOM function from Postgres - throws \"Can't convert Hash into Integer\"</p>\n\n<pre><code>   assigned_specialist = User.specialists.legal_for(coach_section).experienced_in(critique.discipline_id).first(:order =&gt; \"RANDOM()\")\n   return assigned_specialist.id\n</code></pre>\n\n<p>Second attempt, using <a href=\"http://stackoverflow.com/questions/2752231/random-record-in-activerecord\">offset method discussed here.</a> Also causes \"Can't convert Hash into Integer\"</p>\n\n<pre><code>  legal_specialists = User.specialists.legal_for(coach_section).experienced_in(critique.discipline_id)\n\n  offset = rand(legal_specialists.count)\n  assigned_specialist = legal_specialists.first(:offset =&gt; offset)\n  return assigned_specialist.id\n</code></pre>\n\n<p>Final attempt, using array sample method, which works but seems bad.</p>\n\n<pre><code>  legal_specialists = User.specialists.legal_for(coach_section).experienced_in(critique.discipline_id)\n  assigned_specialist = legal_specialists.sample\n  return assigned_specialist.id\n</code></pre>\n\n<p>To be fair, there will only be about 20 specialists in the system, so the array sample method might never cause any issues, but I'd still like to understand what's going on here.</p>\n\n<p><strong>Edit</strong>: Here are the scopes I defined:  </p>\n\n<pre><code>scope :specialists, where(:role_id =&gt; 2)\nscope :legal_for, lambda { |coach_section| where(\"section_id != ?\", coach_section) }\nscope :experienced_in, lambda { |discipline_id|\n  discipline = Discipline.find(discipline_id)\n  discipline.users\n} \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","module"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13202690,"title":"Rails doesn't load my module from lib","body":"<p>I have a bunch of custom classes in my Rails 3.2 app in lib folder: i.e. extending ActiveRecord, etc. It all works fine.</p>\n\n<p>However I'm trying to add a couple of custom methods to FileUtils, i.e.</p>\n\n<pre><code>module FileUtils\n  def last_modified_file(path='.')\n     # blah ...    \n  end\nend\n</code></pre>\n\n<p>I put it in lib/file_utils.rb\nIn my application.rb I have</p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib)\n</code></pre>\n\n<p>My other custom classed are loaded but not the module.</p>\n\n<p>I read (<a href=\"http://stackoverflow.com/questions/3356742/best-way-to-load-module-class-from-lib-folder-in-rails-3\">Best way to load module/class from lib folder in Rails 3?</a> ) that I'm supposed to define a class inside module in order for Rails to pick it up and according to FileUtils.class  - it should be Object &lt; BasicObject.</p>\n\n<p>So I tried</p>\n\n<pre><code>module FileUtils\n  class Object \n    def last_modified_file(path='.')\n       # blah ...    \n    end\n  end\nend\n</code></pre>\n\n<p>But that doesn't work either.</p>\n\n<p>However when I fire up irb and just paste my code which effectivly puts my new code inside object and reinclude my module - it works fine.</p>\n\n<p>Whaat amd I missing here?</p>\n"},{"tags":["ruby-on-rails-3","mvc","design-patterns"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13186963,"title":"How does the MVC pattern work in Ruby On Rails","body":"<p>I'm still trying to understand MVC in Rails, but so far I've deduced the following:</p>\n\n<ul>\n<li>The <strong>Controller</strong> is very thin, and uses the <strong>Models</strong> to construct the data to send back to the <strong>View</strong>.</li>\n<li>The <strong>Models</strong> are not like <a href=\"http://en.wikipedia.org/wiki/Data_transfer_object\" rel=\"nofollow\">DTOs</a>, but rather they contain all the necessary biz logic to return data to the Controller.</li>\n<li>The View doesn't receive Models per say, it just receives properties defined in the corresponding <strong>Actions</strong> in the Controller.</li>\n</ul>\n\n<h2>Questions</h2>\n\n<p>So, I have a few questions:</p>\n\n<ol>\n<li><p><strong>Is my assumption of how MVC works in Rails correct</strong>, if not how does it work?</p></li>\n<li><p>If it is correct, that means that <strong>Models</strong> are never sent to the Views?</p></li>\n<li><p>If all the biz logic is in the Models, and so your Models have explicit dependencies then:</p>\n\n<ul>\n<li>how do you abstract say, your data access layer from the Controllers if the Models have explicit dependencies (say on Mongodb) and your Controllers and Models are so closely bound?</li>\n</ul></li>\n</ol>\n\n<p><em><strong>NOTE:</strong> What do I mean by explicit dependencies</em>:</p>\n\n<p>In <a href=\"https://github.com/RailsApps/rails3-mongoid-devise\" rel=\"nofollow\">this best practices Ruby On Rails sample</a> you'll notice the <a href=\"https://github.com/RailsApps/rails3-mongoid-devise/blob/master/app/models/user.rb\" rel=\"nofollow\">Users Model implements Mongoid directly</a>.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","omniauth","railscasts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12252657,"title":"Setting up Omniauth Identity to connect with Existing User Model","body":"<p>I was going through <a href=\"http://railscasts.com/episodes/304-omniauth-identity\" rel=\"nofollow\">this Railscast</a> to setup Omniauth Identity, but I was unclear about one part. He creates a new Model called Identity which then holds the email, name and password fields. However, I already have a user model with those fields, so can I just connect Identity to it? How would I do that?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13202509,"title":"Sleeping in controller","body":"<p>In my Rails controller method, which is executed when the user submits a form, there is a Ruby code <code>sleep(60)</code>, telling it to wait for a minute. One user submits the form, and while the execution is \"sleeping\", another user submits the form. Will the second user have to wait for the first user to finish, or will the execution of the controller start for the second user?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":596,"score":1,"question_id":8957446,"title":"Missing partial Ruby Chapter 8 tutorial","body":"<p>I am using Ruby on Rails Tutorial by Michael Hartl - Chapter 8 - Rails 3\nI use rails 3.1\nIn the file new.html.erb I have:</p>\n\n<pre><code>&lt;h1&gt;Sign up&lt;/h1&gt;\n&lt;%= form_for(@user) do |f| %&gt;\n&lt;%= render 'shared/error_messages' %&gt;\n</code></pre>\n\n<p>Trying to visit <a href=\"http://localhost:3000/signup\" rel=\"nofollow\">http://localhost:3000/signup</a>, it gives me the following message:</p>\n\n<pre><code>ActionView::MissingTemplate in Users#new\n\nMissing partial /shared/error_messages with {:handlers=&gt;[:erb, :builder, :coffee], \n:formats=&gt;[:html], :locale=&gt;[:en, :en]}. Searched in:\n* \"/Users/macbook/rails_projects/sample_app/app/views\"\n</code></pre>\n\n<p>I have googled around but could not find this answer. The same question was posted a while ago at:\n<a href=\"http://stackoverflow.com/questions/6471558/ruby-chapter-8-tutorial-partial-file-not-found\">Ruby Chapter 8 tutorial partial file not found</a></p>\n\n<p>What I tried:\n-putting a / in front of shared\n- putting :partial => after render\n-putting :target => @user</p>\n\n<p>If I don't put it into the shared folder, it works. Is there a different way to do this in rails 3.1.3? Please let me know because I've spent so much time trying to figure it out.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13201789,"title":"Rails where on query result","body":"<p>I have a model- <code>Link</code> - that has many hits. What I'm trying to do is aggregate data on hits per hour over time from a database table - <code>hits</code> - with columns <code>year</code>, <code>month</code>, <code>day</code>, and <code>hour</code>.</p>\n\n<p>Everything is working fine, but when I run the code below, I end up with almost <strong>1,000 queries on the database</strong>, which seems quite excessive.</p>\n\n<pre><code>#before iteration\n@hits = @link.hits.group('year, month, day, hour')\n  .order('year ASC, month ASC, day ASC, hour ASC')\n  .select('year, month, day, hour, count(*) as hits')\n\n\n#inside iteration\n\n#Line breaks are included here for easy reading\nhits_per_hour =\n  @hits.where(\n    :year =&gt; t.year, \n    :month =&gt; t.month,\n    :day =&gt; t.day,\n    :hour =&gt; t.hour\n  ).map(&amp;:hits).first || 0\n</code></pre>\n\n<p>Here <code>t</code> is a <code>Time</code> object that iterates in steps of 1 hour since the first hit a link received.</p>\n\n<p>I would think that rails would store the query result instead of re-querying every time. I also haven't been able to find anything about caching the query results or anything. Am I just missing something completely, or is this really the easiest way?</p>\n\n<p>Here is a sample of what the queries look like (this is what I see in my logs in blocks of a thousand):</p>\n\n<pre><code>SELECT year, month, day, hour, count(*) as hits\nFROM `hits`\nWHERE\n  `hits`.`link_id` = 1 AND\n  `hits`.`year` = 2012 AND\n  `hits`.`month` = 11 AND\n  `hits`.`day` = 2 AND\n  `hits`.`hour` = 14\nGROUP BY year, month, day, hour\nORDER BY year ASC, month ASC, day ASC, hour ASC\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","redirect","rspec","rspec2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13201446,"title":"Rspec redirect to testing","body":"<p>In my controller when an user creates a new post, he/she is redirected to the page that contains the newly created post. I'm wanting to create a test in rspec to cover this redirect but am having trouble with it. Specifically, I want to know what to write in the refirst_to argument. Here is the controller code below..</p>\n\n<pre><code>def create\n@micropost = Micropost.new(params[:micropost])\n respond_to do |format|\n  if @micropost.save\n    format.html {redirect_to @micropost}\n  else\n    format.html {render action: 'edit'} \n  end\nend\nend\n</code></pre>\n\n<p>Here is the rspec test...</p>\n\n<pre><code>before do\n  @params = FactoryGirl.build(:micropost)\nend\n\nit \"redirects to index\" do\n  #clearly @params.id doesn't work. its telling me instead of a redirect im getting a \n  #200\n  #response.should redirect_to(@params.id)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sunspot","sunspot-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13201284,"title":"how to get value selected by using select_tag with options_from_collection_for_select and pass it to controller","body":"<p>I have built a form search like this:</p>\n\n<pre><code>&lt;%= form_tag({ controller: 'questions', action: 'search_topic' }, method: 'get') do %&gt;\n  &lt;%= select_tag 'search_topic', options_from_collection_for_select(current_user.get_topics, :id, :name) %&gt;\n  &lt;%= submit_tag \"Search\", name: nil, class: 'btn' %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>I want to search all questions of a topic selected from select box, i used sunspot to help for search, so now how can i pass value select from select box to controller for search, i used below code to pass a params[:search]:  </p>\n\n<pre><code>&lt;%= select_tag 'search_topic', options_from_collection_for_select(current_user.get_topics, :id, :name), params[:search] %&gt;\n</code></pre>\n\n<p>but it has error: </p>\n\n<pre><code>undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>this is my controller:</p>\n\n<pre><code>def search_topic\n  @search = Question.search do\n    with(:topic_id, params[:search])\n    paginate page: 1, per_page: 10\n  end\n\n  @questions = @search.results\n  render 'index'\nend\n</code></pre>\n\n<p>so, how can i pass value selected from select box on form to controller for search?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","development-environment"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13201243,"title":"Initializers not called in development environment when class changes","body":"<p>I have a an initializer in my Rails 3.2 app that includes modules at startup based on a configuration file.  It looks something like this:</p>\n\n<pre><code>Array(Settings.site.authentications).map(&amp;:to_sym).each do |sym|\n  AuthAuth.class_eval do\n    include Object.const_get(sym)\n  end\nend\n\nArray(Settings.site.authorizations).map(&amp;:to_sym).each do |sym|\n  AuthAuth.class_eval do\n    include Object.const_get(sym)\n  end\nend\n\n# This exception is never raised when I start the server.  So the includes \n# appear to be working correctly.\nraise \"method not found!\" unless AuthAuth.new.respond_to? :dynamically_included_method\n</code></pre>\n\n<p><code>AuthAuth</code> is used in my <code>ApplicationController</code> in a <code>:before_filter</code> to ensure that users are authenticated and authorized.  It works fine and suites the requirement that I have a configurable way of setting authorization and authentication logic on a per-site basis.</p>\n\n<p>I've noticed, however, that when I am running the server in development mode if I make a code change to any class in the application, <code>AuthAuth</code> reverts to it's default behavior without the included modules.</p>\n\n<p>Is there an appropriate place to include this code other than an initialization file?  </p>\n\n<p>This is a relatively minor issue.  It's easy enough to restart the development server after each code change, but I'm curious. </p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12981749,"title":"How can I use JSON data to feed two different views?","body":"<p>I have rails application that has two view ports that uses the same data. I can get the data in JSON format like this:</p>\n\n<pre><code>$.read(\n    '/en/search/fetch_companies',\n    { current_location_lat: 72, current_location_lng: 10, bounding_box: 10 },\n    function (response) {\n        for (var i = 0; i &lt; response.length; i++) {\n            var markerPosition = new google.maps.LatLng(response[i].latitude, response[i].longitude);\n            var marker = new google.maps.Marker({\n                position:markerPosition,\n                map:map,\n                title:\"AJAX!\"\n                });\n        }\n    }\n);\n</code></pre>\n\n<p>This code above creates Markers on a Google Maps. The second view port is a simple table. </p>\n\n<pre><code>  &lt;% @companies.each do |company| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;address&gt;\n          &lt;strong&gt;&lt;%= company.name %&gt;&lt;/strong&gt;&lt;br&gt;\n          &lt;%= company.address %&gt;\n          &lt;br&gt;\n          &lt;%= company.city %&gt;,&lt;%= company.province %&gt;\n          &lt;br&gt;\n          &lt;%= company.postalcode %&gt;\n        &lt;/address&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;%= link_to book_appointment_path(:choose_service, :company_id =&gt; company.id), :class =&gt; \"btn btn-info btn-center-col\" do %&gt;\n          &lt;i class=\"icon-time icon-white\"&gt;&lt;/i&gt; Book Appointment\n        &lt;% end %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>For now I've been sending two requests to get the JSON data. One for the table view and one for the Map. This is not acceptable for me. The Map and the Table need to be fed the same data at once, but since Rails is resolved on the server I cannot fill the table with the JSON data.</p>\n\n<p>Do anyone knows about some a table that plays nicely with Rails, Ajax and pagination?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13201115,"title":"Ordering by complex structure in Rails","body":"<p>I have a model called Event that has many EventRegistrations, which belongs to a person.\nAlso the EventRegistration has many EventAtendees, which belongs to a person too.</p>\n\n<p>I want to order in Rails all the people related to a event, which means:\n - Person associated to an event registration\n - Person associated to an event atendee which is associated to a registration..</p>\n\n<p>Any help?</p>\n"},{"tags":["ajax","ruby-on-rails-3","file-upload","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13195546,"title":"remove image from model with rails 3 and carrierwave and jquery","body":"<p>I'm using Carrierwave to add and upload an image to Amazon S3.  this works ok, and once the form is saved I display the image and an x box to remove it.</p>\n\n<p>I would like to use ajax to handle the click event on the 'x' image'  on click I would like to remove the image and clear the field on the form so that the input field is once again displayed</p>\n\n<p>The image field is an attribute of the model class i am editing in the form.</p>\n\n<pre><code>Person &lt; ActiveRecord\n attr_accessible: image\n</code></pre>\n\n<p>the partial for this part of my form shows the image if it exists, otherwise the input file_field if it does not exists</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= image_tag @pass.background_image_url(:thumb) if @pass.background_image? %&gt;\n    &lt;%= f.file_field :background_image if @pass.background_image.to_s == '' %&gt;\n    &lt;%= content_tag :div, '', class: \"delete_image_fields\" if @pass.background_image? %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I have some jquery which i can sccessful hide the image field.</p>\n\n<pre><code>jQuery -&gt;\n\n  $('.field .delete_image_fields').click -&gt;\n  $(this).parent().find('img').hide()\n  event.preventDefault()\n</code></pre>\n\n<p>The image field gets hidden no problem</p>\n\n<p>What i would like to happen is </p>\n\n<p>a)  clear the input field from the pass object\nb)  submit the change (remotely)\nc) delete the remote image on S3\ne) re-display the file_input field for the image so it can re-selected if required</p>\n\n<p>Any help or pointers would be appreciated</p>\n\n<p>UPDATE</p>\n\n<p>I've got this partially working to display corect fields and adjust the input link.  but i'm not sure how to actually delete the file from the models attribute</p>\n\n<p>I've updated the partial to the following which dispalsy either the image ro the create file button</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;%= f.label :background_image %&gt;&lt;br /&gt;\n  &lt;% if @pass.background_image?%&gt;\n     &lt;%= image_tag @pass.background_image_url(:thumb)  %&gt;\n     &lt;%= f.file_field :background_image , style: \"display:none\"%&gt;\n     &lt;%= content_tag :div, '', class: \"delete_image_fields\" %&gt; \n  &lt;% else %&gt;\n     &lt;%= f.file_field :background_image%&gt;       \n  &lt;% end %&gt;\n</code></pre>\n\n<p></p>\n\n<p>and updated my jquery to this</p>\n\n<pre><code>$('.field .delete_image_fields').click -&gt;\n  $(this).parent().find('img').hide()\n  $(this).hide()\n  $(this).parent().find('input').val('')\n  $(this).parent().find('input').show()\n  event.preventDefault()\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13200629,"title":"Rails Active Record query -- 'or' conditions","body":"<p>I have a jobs table; each job has a start_date and an end_date. For a given month I want to pull all jobs that were \"running\" in any part of, or all of some month. The problem is how to write the query for the 5 different \"or\" conditions needed to capture the notion of a job running in all of or any part of the month. So, I need all jobs that started before the beginning of the month and ended during the month <strong>OR</strong> all jobs that started and ended during the month <strong>OR</strong> all jobs that started in the month and finished after the end  of the month... Well, there is three of the five. So in the Jobs.where clause, how is the \"or\" compactly expressed?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13200604,"title":"Rails: Asynchronous reload on server response","body":"<p>My Rails application has two functions, a user requesting information from an outside server, and the outside server returning that information. The way it is currently structured, the user selects one or more objects from the homepage and click 'update', which is handled by the 'search' method in my home controller, which in turn fires off a request to the server, returning true or false depending on the connection. The server goes through some processes, and returns an answer via a post request to a URL within my application (which is received by the 'answer' method in my party controller. When the answer is received, I would like the objects 'updated' by the user to have their data asynchronously updated.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","passenger"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":11145051,"title":"Rails production.log (using Passenger) being written to by multiple processes, can't be parsed","body":"<p>Here's a snippet of my production.log:</p>\n\n<pre><code>Started GET \"/product/514034/754240\" for XX.XX.202.138 at 2012-06-21 11:52:28 -0700\n\n\nStarted GET \"/product/614409/666897\" for XX.XX.228.38 at 2012-06-21 11:52:28 -0700\nProcessing by ProductsController#show as HTML\n  Parameters: {\"category_id\"=&gt;\"514034\", \"product_id\"=&gt;\"754240\"}\nProcessing by ProductsController#show as HTML\n  Parameters: {\"category_id\"=&gt;\"614409\", \"product_id\"=&gt;\"666897\"}\nLogged in 2940659 via auth cookie\nLogged in 585210 via auth cookie\n[e3e3fc56bb6bd137741b269ee397683c] [2940659] Read fragment views/global-caches/header (0.7ms)\n[e3e3fc56bb6bd137741b269ee397683c] [2940659]   Rendered shared/_email_form.html.haml (0.7ms)\n[d81bb986be5acc0277c0c9e11b414249] [585210] Read fragment views/global-caches/sharebar-message (0.7ms)\n[d81bb986be5acc0277c0c9e11b414249] [585210]   Rendered shared/_email_form.html.haml (0.7ms)\n...\n</code></pre>\n\n<p>As you can see, it's logging two concurrent sessions of two different users simultaneously to the same log file. This makes it impossible to parse my logs and determine, for example, the time it took to generate each kind of page, because the entries are not in the expected order of: </p>\n\n<pre><code>Started GET \"/URL/BLAH\" for IP at DATE\n... stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n</code></pre>\n\n<p>Instead I get an unpredictable interleaved log like this:</p>\n\n<pre><code>Started GET \"/URL/BLAH\" for IP at DATE\n\nStarted GET \"/URL/BLAH\" for IP at DATE\n... stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n...stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n</code></pre>\n\n<p>So it's impossible to match the \"completeds\" with the \"Started.\"</p>\n\n<p>What I'd like is a way to have each child process write to its own log or something. Or if it's possible a way to write the each pageview's log atomically, but that might be impossible or difficult or hurt performance.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","datatables","pjax"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13196264,"title":"Rails, pjax and DataTables","body":"<p>I've got a Rails app utilizing pjax (pjax.heroku.com/) so that my header and navbar don't ever reload. It's all fine and dandy and working, BUT in one of my views I'm using a data table (datatables.net). The data table works great when you first load up the page, but if you navigate away to another page and then come back, the table doesn't \"reinitiate\", so it doesn't work and everything looks like crap. Apparently it's because the data tables js file isn't getting loaded up again due to pjax.</p>\n\n<p>Here's what I've got:</p>\n\n<p><code>application.js</code>:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require pjax\n//= require_tree .\n</code></pre>\n\n<p>In the head of <code>application.html.erb</code> I have:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>And then wrapped the <code>&lt;%=</code> yield <code>%&gt;</code> in a div with <code>data-pjax-container</code>.</p>\n\n<p>I'm calling the data-tables js file in <code>index.html.erb</code> (hard-coded) underneath the table:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"/data-table.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Then in a separate <code>custom.js</code> file, this is what initiates the table:</p>\n\n<pre><code>$(document).pjax('a[data-pjax]');\n$('.openinside').pjax('.sidebarInner');\n</code></pre>\n\n<p>Any idea what's going on here? I think the table isn't being reinitiated, but how can I make it reinitiate when the header isn't getting loaded every time due to Pjax? I tried putting the JS link right beneath the table even and that didn't work!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12652540,"title":"Combine Show and Edit actions in Ruby on Rails?","body":"<p>I was just wondering if anybody has ever built a Rails application without any <em>Show</em> actions.</p>\n\n<p>In my application, if a user picks, say a Project, from the list he will <em>probably</em> want to not just <em>show</em> it but also <em>edit</em> it.</p>\n\n<p>So is it good practice to <strong>not</strong> implement any show actions and instead link all records to edit forms?</p>\n\n<p>The only caveat I see is that a user might accidentally edit a project. But this could be prevented by setting a default attribute <em>disabled</em> on all form fields using jQuery. That way, a user will have to click a button \"Edit\" in order to unlock the form fields for editing.</p>\n\n<p>Does that make sense or am I completely nuts?</p>\n\n<p>Who knows, maybe this causes conflicts with Rails' RESTful architecture?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongodb","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13199613,"title":"match two or more object from differents models with mongoid","body":"<p>I have 2 model:</p>\n\n<pre><code>class User\n include Mongoid::Document\n field :email, :type =&gt; String, :null =&gt; false, :default =&gt; \"\"\n .\n .\nend\n\nclass Admin\n include Mongoid::Document\n field :email, :type =&gt; String, :null =&gt; false, :default =&gt; \"\"\n .\n .\nend\n</code></pre>\n\n<p>I want with a mongoid query find all users have a equal email in <code>Admin</code> model, something like:</p>\n\n<pre><code>User.where(:email =&gt; {exist_admin_class?})\n</code></pre>\n\n<p>This is possible? Or I have make a relationship between two model with a <code>has_one User</code> and <code>belongs_to Admin</code></p>\n\n<p>What is the best way to do this?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":190,"score":0,"question_id":11725002,"title":"Rails 3: How to configure Zencoder to work with Amazon S3?","body":"<p>I'm following this tutorial to integrate Zencoder in my Rails 3 app: <a href=\"http://www.nickdesteffen.com/blog/video-encoding-with-uploadify-carrierwave-and-zencoder\" rel=\"nofollow\">http://www.nickdesteffen.com/blog/video-encoding-with-uploadify-carrierwave-and-zencoder</a></p>\n\n<p>The tutorial uses Rackspace for storage, but I'd like to adapt the code so that I can use Amazon S3 for storage instead. I replaced all the Rackspace info with my Amazon S3 info, but whenever I try to upload a video in my form, I get this HTTP error: \"There was an error with the file you tried uploading.Please verify that it is the correct type.\"</p>\n\n<p>What do I need to fix here to make this work?</p>\n\n<p><strong>carrierwave.rb</strong></p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',\n    :aws_access_key_id      =&gt; 'xxx',\n    :aws_secret_access_key  =&gt; 'xxx',\n  }\n  config.fog_directory  = 'mybucket'\n  config.fog_public     = true\n  config.fog_attributes = {'Cache-Control' =&gt; 'max-age=315576000'}\nend\n</code></pre>\n\n<p><strong>video_uploader.rb</strong></p>\n\n<pre><code>class VideoUploader &lt; CarrierWave::Uploader::Base\n  include Rails.application.routes.url_helpers\n\n  Rails.application.routes.default_url_options = ActionMailer::Base.default_url_options\n\n  after :store, :zencode\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  def extension_white_list\n    %w(mov avi mp4 mkv wmv mpg)\n  end\n\n  def filename\n    \"video.mp4\" if original_filename\n  end\n\n  private \n\n  def zencode(args)\n    zencoder_response = Zencoder::Job.create({:input =&gt; 's3://mybucket/key.mp4',\n                      :outputs =&gt; [{:label =&gt; 'vp8 for the web',\n                                    :url =&gt; 's3://mybucket/key_output.webm'}]})\n\n    zencoder_response.body[\"outputs\"].each do |output|\n      if output[\"label\"] == \"web\"\n        @model.zencoder_output_id = output[\"id\"]\n        @model.processed = false\n        @model.save(:validate =&gt; false)\n      end\n    end\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","testing","performance-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":10436808,"title":"Rails 3.0.12 Performance test issues","body":"<p>I'm trying to run benchmark and performance tests and I'm not getting the metrics displaying...</p>\n\n<p>ruby -v:</p>\n\n<p><code>ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-linux]</code></p>\n\n<p>rvm list:</p>\n\n<p><code>=&gt; ruby-1.9.2-p320-perf [ x86_64 ]</code></p>\n\n<p>the result of running <code>rake test:profile</code>:</p>\n\n<pre><code>BrowsingTest#test_homepage (130 ms warmup)\n        process_time: 18446744073.71 sec\n              memory: unsupported\n             objects: unsupported\nBrowsingTest#test_intel_companies_newstats (34 ms warmup)\n        process_time: 26 ms\n              memory: unsupported\n             objects: unsupported\n</code></pre>\n\n<p>and running <code>rake test:benchmark</code></p>\n\n<pre><code>BrowsingTest#test_homepage (103 ms warmup)\n           wall_time: 23 ms\n              memory: 0.00 KB\n             objects: 0\n             gc_runs: 0\n             gc_time: 0.00 ms\nBrowsingTest#test_intel_companies_newstats (31 ms warmup)\n           wall_time: 9 ms\n              memory: 0.00 KB\n             objects: 0\n             gc_runs: 0\n             gc_time: 0.00 ms\n</code></pre>\n\n<p>my gem file</p>\n\n<pre><code>group :test do\n    gem 'capybara'\n\n    # for performance tests\n    gem 'ruby-prof', :git =&gt; 'git://github.com/wycats/ruby-prof.git'\n    gem 'test-unit'\nend\n</code></pre>\n\n<p>When I tried to run:</p>\n\n<p><code>rvm install 1.9.2 --patch gcdata --name perf</code></p>\n\n<p>I got:</p>\n\n<pre><code>Installing Ruby from source to: /home/victor/.rvm/rubies/ruby-1.9.2-p320-perf, this may take a while depending on your cpu(s)...\n\nruby-1.9.2-p320-perf - #fetching \nruby-1.9.2-p320-perf - #extracting ruby-1.9.2-p320 to /home/victor/.rvm/src/ruby-1.9.2-p320-perf\nruby-1.9.2-p320-perf - #extracted to /home/victor/.rvm/src/ruby-1.9.2-p320-perf\nPatch 'gcdata' not found.\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","html5","file-upload","carrierwave"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":3962,"score":4,"question_id":6447278,"title":"Uploading multiple files at once to Rails app with Carrierwave (HTML5)","body":"<p>I'm close...very close...I'm able to upload single files just fine...but when i change the type of my form's <code>file_field</code> to <code>:multiple =&gt; true</code> so I can upload multiple images at once my uploaded files get wrapped in an array...and the 'magic' of 'accepts_nested_attributes_for` is lost.</p>\n\n<p><strong>Edit:</strong>\nAfter more examination I wonder if I even need to bother with <code>accepts_nested_attributes_for</code>? Perhaps I should just have a <code>file_field, :multiple =&gt; true</code> in my Gallery form (as opposed to a nested form) and then in my create action create the new gallery and then loop through each element in the <code>params[:gallery][:photos_attributes][\"0\"][:image]</code> array by hand, so to speak, calling <code>@gallery.photos.create</code> for each element. ?!?  Seems cumbersome...but it's all I can come up with.</p>\n\n<p>Hoping someone with more experience with Rails can chime in...</p>\n\n<p>Params:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\", \n\"authenticity_token\"=&gt;\"9jXvIwcllct7UyUfo6cvhEucQf2u3SY50SuaCLtFO4c=\", \n\"gallery\"=&gt;{\n  \"name\"=&gt;\"First Gallery\", \n  \"photos_attributes\"=&gt;{\"0\"=&gt;{\n    \"image\"=&gt;[\n      #&lt;ActionDispatch::Http::UploadedFile:0x00000104b78978 \n        @original_filename=\"first_test_image.jpg\", \n        @content_type=\"image/jpeg\", \n        @headers=\"Content-Disposition: form-data; name=\\\"gallery[photos_attributes][0][image][]\\\"; filename=\\\"first_test_image.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\", \n        @tempfile=#&lt;File:/var/folders/bQ/bQYZC2ukFZCvbKzEDGRtJE+++TI/-Tmp-/RackMultipart20110622-4459-vz78ee&gt;&gt;, \n      #&lt;ActionDispatch::Http::UploadedFile:0x00000104b78950 \n        @original_filename=\"second_test_image.jpg\", \n        @content_type=\"image/jpeg\", \n        @headers=\"Content-Disposition: form-data; name=\\\"gallery[photos_attributes][0][image][]\\\"; filename=\\\"second_test_image.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\", \n        @tempfile=#&lt;File:/var/folders/bQ/bQYZC2ukFZCvbKzEDGRtJE+++TI/-Tmp-/RackMultipart20110622-4459-1jzhhyg&gt;&gt;\n      ]\n    }\n  }\n}, \"commit\"=&gt;\"Save\", \"action\"=&gt;\"create\", \"controller\"=&gt;\"galleries\"}\n\n\n\n#app/models/gallery.rb \nclass Gallery &lt; ActiveRecord::Base \n  has_many :photos, :dependent =&gt; :destroy \n  accepts_nested_attributes_for :photos \nend \n\n#app/models/photo.rb \nclass Photo &lt; ActiveRecord::Base \n  belongs_to :gallery \n  mount_uploader :photo, PhotoUploader \nend \n\n#config/routes.rb\nresources :galleries do\n  resources :photo, :only =&gt; [:create, :destroy]\nend\n</code></pre>\n\n<p>GalleriesController</p>\n\n<pre><code>  def new\n    @gallery = Gallery.new\n    @gallery.photos.build\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @gallery }\n    end\n  end\n\n  ...\n\n  def create\n    @gallery = Gallery.new(params[:gallery])\n\n    respond_to do |format|\n      if @gallery.save\n        format.html { redirect_to @gallery, notice: 'Gallery was successfully created.' }\n        format.json { render json: @gallery, status: :created, location: @gallery }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @gallery.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-engines"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":141,"score":1,"question_id":13183540,"title":"Using layouts from a mountable engine","body":"<p>I am looking for a solution to the following problem:</p>\n\n<p>db_core application contains only models for a small core system. The db_core application will not have any views. </p>\n\n<p>On top of the db_core application we will have an admin interface. This will be a mountable engine. The admin interface will serve assets such as javascripts, css, images, etc.</p>\n\n<p>Finally we will have additional mountable engines; eg. \"blog\", \"forum\", \"authentication\" that will be mounted on the db_core application, and all these mountable engines should have the same layout as the admin interface engine.</p>\n\n<p>I have a test up and running where the db_core application serves assets, but I have not been able to find out how to let another engine serve the assets so the db_core application can remain small and free of any assets and views.</p>\n\n<ul>\n<li>db_core\n<ul>\n<li>Engine A -> admin interface (assets)</li>\n<li>Engine B, C, D, ... -> various other engines using assets from Engine A</li>\n</ul></li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":340,"score":0,"question_id":8086638,"title":"Merging db/migration files","body":"<p>Is there a good way to merge rails db migration files into 1 file per table besides splitting <strong>schema.rb</strong> manually?</p>\n\n<p>Most of my migration file was created during development and does not represent real data changes. For historical reasons those files will be still accessible on source control system. I feel uncomfortable keeping those unnecessary files.</p>\n"},{"tags":["ruby-on-rails-3","activerecord","database-connection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13193742,"title":"Rails 3 connect different databases dynamically based on certain parameter","body":"<p>\nI am having an app where i need to switch the database according to the parameter the user is passing. What exactly my purpose is that user calls an api and passes certain parameter. I am having 2 databases say D1 and D2 to serve the same api. \n</p>\n\n<p>Based on one of the parameter value I want to switch the database from on default database(D1) to another database(D2). If the parameter is not satisfied the default db must be D1</p>\n\n<p><br/><br/><br/>\nIve tried using *self.abstract_class = true* and *establish_connection :D2*, but in this case its get connected to D2 irrespective of the parameter.<br/><br/><br/>\nKindly suggest me what could be the appropriate solution for this.</p>\n\n<p>Any Help is highly appreciated..!!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13196493,"title":"How should I refactor create_unique methods in Rails 3?","body":"<p>I have following ugly create_unique method in few models ex:</p>\n\n<pre><code>  def self.create_unique(p)\n    s = Subscription.find :first, :conditions =&gt; ['user_id = ? AND app_id = ?', p[:user_id], p[:app_id]]\n    Subscription.create(p) if !s\n  end\n</code></pre>\n\n<p>And then in controllers #create actions I have</p>\n\n<pre><code>s = Subscription.create_unique({:user_id =&gt; current_user.id, :app_id =&gt; app.id})\nif s\n  raise Exceptions::NotAuthorized unless current_user == s.user\n  @app = s.app\n  s.destroy\n  flash[:notice] = 'You have been unsubscribed from '+@app.name+'.'\n  redirect_to '/'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13197359,"title":"Add association (<<) without commiting to database","body":"<p>Is it possible in Rails to add an association to an <strong>existing</strong> record without immediately commiting this change to the database?\nE.g. if I have Post has_many :tags</p>\n\n<pre><code>post.tags &lt;&lt; Tag.first\n</code></pre>\n\n<p>This will commit to database immediately. I've tried other ways instead of &lt;&lt;, but without success (what I want is to create the association when saving the parent object).\nIs it possible to get behavior like when you are adding association to a new record with build?</p>\n\n<pre><code>post.tags.build name: \"whatever\"\n</code></pre>\n\n<p>I think this is kind of inconsistent in Rails, in some cases it would be useful to have an option to do this.</p>\n\n<p>In other words I want</p>\n\n<pre><code>post.tags &lt;&lt; Tag.first # don't hit the DB here!\npost.save # hit the DB here!\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13185761,"title":"Sending downloaded files via Rails controller","body":"<p>On my Rails-based website, I'd like a user to be able to input a URL, which my server downloads using the Unix command <code>wget</code> <em>with the recursive option</em>. My server then zips those downloaded files along with some files already on the server, and sends the zip to the user by using the Rails command <code>send_file</code>.</p>\n\n<p>Now, I'm worried that the <code>send_file</code> will be executed before the <code>wget</code> and zipping finish their job. How do I make sure that sending the file occurs only after the downloading and zipping finish? Will this approach work, or should I take an another approach?</p>\n"},{"tags":["ruby-on-rails-3","tinymce","edit-in-place","best-in-place","rich-text-editor"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13076653,"title":"Using best_in_place with rich-text editor like TinyMCE","body":"<p>I'm using the <code>best_in_place</code> gem to do in-place editing in a Rails application. However, I need (X)HTML editing on some of the text areas, so I need a rich-text editor. TinyMCE is being used elsewhere on the site. </p>\n\n<p>However, it's not trivial to add an editor to <code>best_in_place</code>. To grossly oversimplify, the gem uses jQuery to insert the <code>textarea</code> tag on the fly, and TinyMCE initializes at page load, replacing available <code>textarea</code>s with an editor, so when <code>best_in_place</code> puts in its <code>textarea</code>, TinyMCE has already come and gone. I've tried re-initializing TinyMCE after <code>best_in_place</code> inserts its textarea, but I don't think I've found the correct place(s) in the code to do that, because so far it hasn't worked.</p>\n\n<p>There's <a href=\"http://railscasts.com/episodes/302-in-place-editing?view=comments#comment_154834\" rel=\"nofollow\">a rumor</a> that this integration is possible, but no documentation was visible in my web searches, so pointers are welcome. (Likewise <a href=\"http://stackoverflow.com/a/452762/306084\">this answer</a> is unhelpful, pointing to two broken links.) I think my preferred order of solutions would be something like</p>\n\n<ul>\n<li>Here's how to integrate TinyMCE with <code>best_in_place</code></li>\n<li>It can't be done with TinyMCE but here's how to do it with another rich-text editor</li>\n<li>It can't be done with <code>best_in_place</code> but here's <a href=\"https://www.ruby-toolbox.com/categories/rails_in_place_editing\" rel=\"nofollow\">another rich-text edit-in-place solution</a> for Rails 3.2.x.</li>\n</ul>\n"},{"tags":["javascript","ruby-on-rails-3","backbone.js"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13197495,"title":"Access the value of attributes of a model in rails3 in backbone.js","body":"<p>I have a model Search which has an attribute :activities.\n:activities is a hash.\nAfter updating its value to something, I want to access the value in a Backbone View and use it in a template.\nHow do I access the value in the view?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":22,"score":3,"question_id":13196881,"title":"Capybara::ElementNotFound: for jquery ui dialog box content","body":"<p>I have my Login form into the Jquery UI Dialog popup box. When I start doing RSpec test, I got an error with </p>\n\n<pre><code>Failure/Error: fill_in \"Username\", with: \"user@example.com\"\nCapybara::ElementNotFound\ncannot fill in, no text field, text area or password field with id, name, or label 'Username' found\n</code></pre>\n\n<p>Here is my spec/request page:</p>\n\n<pre><code>describe \"create user\", :js =&gt; true do\n\n  before { visit new_enr_rds_dea_path }\n\n  let(:submit) { \"Create Dea\" }\n\n  describe \"with invalid information\" do\n    it \"should not create a user\" do\n      expect { click_button submit }.not_to change(Enr::Rds::Dea, :count)\n    end\n  end\n\n  describe \"with valid information\" do\n    before do\n      fill_in \"Username\", with: \"user@example.com\"\n      fill_in \"Password\", with: \"foobar\"\n      fill_in \"Confirm password\", with: \"foobar\"\n      fill_in \"Organisation\", with: \"foobar\"\n    end\n\n    it \"should create a user\" do\n      expect { click_link_or_button submit }.to change(Enr::Rds::Dea, :count).by()\n    end\n  end\n</code></pre>\n\n<p>Factories.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :dea_user do |user|\n    user.dea_user             \"example@in4systems.com\"\n    user.dea_pwd              \"foobar\"\n    user.dea_pwd_confirmation \"foobar\"\n    user.pro_organisation_id  \"NHER\"\n  end\nend\n</code></pre>\n\n<p>I am rendering my new and edit page to the Form partial. Both <code>New</code> and <code>edit</code> button has <code>:remote =&gt; true</code> method to open the JqueryUI dialog box. Thanks..</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13190933,"title":"Syntax error on Heroku on line that doesn't exist","body":"<p>I have a Rails app with Haml views which runs fine locally and also on another host. But after deploying to Heroku, the first request gets an error, se the log below:</p>\n\n<pre><code>Started GET \"/\" for 88.159.5.1 at 2012-11-02 07:03:56 +0000\n- - Processing by SessionsController#new as HTML\n- - Rendered sessions/new.html.haml within layouts/application (403.5ms)\n- - Completed 500 Internal Server Error in 497ms\n- - ActionView::Template::Error (syntax error on line 18, col 4: `all:  all'):                                      \n- -     1: .sixteen.columns\n- -     2:   #loginblock\n- -     3:     .content_title.general\n- -     4:     %h2= I18n.t :login_title\n- -     5:     .content\n- -     6:       = render(\"layouts/message\")\n- -     7:       = form_tag(sessions_path, :class =&gt; 'form') do\n- -   app/views/sessions/new.html.haml:4:in `_app_views_sessions_new_html_haml___1472882735787050115_50827800'\n</code></pre>\n\n<p>Strange thing is: line 18 doesn't exist in that view, it has only 17 lines. And on line 4 I don't see anything wrong? Probably has something to do with Haml or Haml gem not working correctly? See is the view file below. Thanks for any input!</p>\n\n<pre><code>.sixteen.columns\n  #loginblock\n    .content_title.general\n    %h2= I18n.t :login_title\n    .content\n      = render(\"layouts/message\")\n      = form_tag(sessions_path, :class =&gt; 'form') do\n        .field\n          = label_tag I18n.t :form_email\n          = text_field_tag :email\n        .field\n          = label_tag I18n.t :form_password\n          = password_field_tag :password\n        .field\n          = submit_tag I18n.t(:login_title), :class =&gt; 'button white'\n        .clear\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","mongoid","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13187416,"title":"mongoid and devise gives unsual error","body":"<p>Mongoid with devise seems to be throwing up this error for me, where ever devise is being used.</p>\n\n<pre><code>undefined method `-' for nil:NilClass\n</code></pre>\n\n<p>this is the stack trace</p>\n\n<pre><code>moped (1.2.7) lib/moped/cluster.rb:172:in `block in refresh'\nmoped (1.2.7) lib/moped/cluster.rb:179:in `each'\nmoped (1.2.7) lib/moped/cluster.rb:179:in `refresh'\nmoped (1.2.7) lib/moped/cluster.rb:132:in `nodes'\nmoped (1.2.7) lib/moped/cluster.rb:240:in `with_secondary'\nmoped (1.2.7) lib/moped/session/context.rb:104:in `with_node'\nmoped (1.2.7) lib/moped/session/context.rb:43:in `query'\nmoped (1.2.7) lib/moped/query.rb:112:in `first'\nmongoid (3.0.10) lib/mongoid/contextual/mongo.rb:201:in `first'\nmongoid (3.0.10) lib/mongoid/contextual.rb:18:in `first'\norm_adapter (0.4.0) lib/orm_adapter/adapters/mongoid.rb:22:in `get'\ndevise (2.1.2) lib/devise/models/authenticatable.rb:183:in `serialize_from_session'\ndevise (2.1.2) lib/devise/rails/warden_compat.rb:29:in `deserialize'\nwarden (1.2.1) lib/warden/session_serializer.rb:35:in `fetch'\nwarden (1.2.1) lib/warden/proxy.rb:212:in `user'\nwarden (1.2.1) lib/warden/proxy.rb:318:in `_perform_authentication'\nwarden (1.2.1) lib/warden/proxy.rb:127:in `authenticate!'\ndevise (2.1.2) lib/devise/controllers/helpers.rb:48:in `authenticate_user!'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:418:in `_run__532752988157179990__process_action__39271927218028622__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/rescue.rb:29:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'\nactionpack (3.2.8) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.2.8) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.2.8) lib/action_controller/metal.rb:203:in `dispatch'\nactionpack (3.2.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.2.8) lib/action_controller/metal.rb:246:in `block in action'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `call'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:36:in `call'\njourney (1.0.4) lib/journey/router.rb:68:in `block in call'\njourney (1.0.4) lib/journey/router.rb:56:in `each'\njourney (1.0.4) lib/journey/router.rb:56:in `call'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'\nmongoid (3.0.10) lib/rack/mongoid/middleware/identity_map.rb:34:in `call'\nwarden (1.2.1) lib/warden/manager.rb:35:in `block in call'\nwarden (1.2.1) lib/warden/manager.rb:34:in `catch'\nwarden (1.2.1) lib/warden/manager.rb:34:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.4.1) lib/rack/etag.rb:23:in `call'\nrack (1.4.1) lib/rack/conditionalget.rb:25:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'\nrack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\nrack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__4054107343433525264__call__3237741633973160553__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.8) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.8) lib/rails/engine.rb:479:in `call'\nrailties (3.2.8) lib/rails/application.rb:223:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n\n<p>The controller has a before_filter :authenticate_user! commenting this, allows the page to work.</p>\n\n<p>What might be wrong here?</p>\n\n<p>I have tried destroying all devise installs by doing</p>\n\n<pre><code>rails d devise user\nrails d devise:views\nrails d devise:install\n</code></pre>\n\n<p>and then re installing devise, it did not help. Any ideas?</p>\n"},{"tags":["mysql","ruby-on-rails","database","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":330,"score":0,"question_id":9779998,"title":"rail servers error? (rails 3) in windows","body":"<p>I created a new project using the command:</p>\n\n<blockquote>\n  <p>rails new simple_cms -d mysql </p>\n</blockquote>\n\n<p>but when I try to launch the web server, this happens:  </p>\n\n<pre><code>C:\\Users\\johnny\\Sites\\simple_cms&gt;rails server\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in `require': 193: %1 is not a valid Win32 application.   - C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/1.9/mysql2.so (LoadError)\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2.rb:9:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2.rb:9:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:68:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:68:in `block (2 levels) in require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:66:in `each'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:66:in `block in require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:55:in `each'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:55:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler.rb:119:in `require'\n    from C:/Users/johnny/Sites/simple_cms/config/application.rb:7:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:53:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:53:in `block in &lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:50:in `tap'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n\nC:\\Users\\johnny\\Sites\\simple_cms&gt;\n</code></pre>\n\n<p>Some version info just in case:</p>\n\n<pre><code>C:\\Users\\j\\Sites\\simple_cms&gt;ruby -v\nruby 1.9.3p125 (2012-02-16) [i386-mingw32]\n\nC:\\Users\\j\\Sites\\simple_cms&gt;ruby -v\nruby 1.9.3p125 (2012-02-16) [i386-mingw32]\n\nC:\\Users\\j\\Sites\\simple_cms&gt;mysql --version\nmysql  Ver 14.14 Distrib 5.5.21, for Win64 (x86)\n</code></pre>\n\n<p>I've already searched the web looking for solutions, but none of them\nseem to work. Any help would be greatly appreciated, thank you.</p>\n"},{"tags":["ruby-on-rails-3","devise","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13141038,"title":"Update user attributes without changing password in rails_admin","body":"<p>In my app, I use devise to generate User model, add some attributes like job, role,... to this.\nIn rails_admin page, when edit an user, I only show fields: email, job, role, idcard (no include password and password_confirmation fields)\nWhen I click Save, it show error because the password is shorter than 6 characters.\nIn the console, if I try</p>\n\n<pre><code>User.last.update_attributes(:role =&gt; \"admin\", \"idcard\" =&gt; \"1233131\")\n</code></pre>\n\n<p>It'll get the same error!\nHow can I fix this? Because the rails_admin (I think and be sure) didn't use update in registrations_controller to update user!</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13194406,"title":"how to remove single quotes(') in ruby on rails","body":"<pre><code>@content = \"&lt;p&gt;&lt;span style=\\\"font-family: 'trebuchet ms', 'geneva'; font-size: 'large';\\\"&gt;Helo's&lt;/span&gt;&lt;/p&gt;\"\n</code></pre>\n\n<p>I want to remove single quotes (<code>'</code>) from <code>&lt;style&gt;</code> but not from the <code>Helo's</code>. Right now I'm using this but this remove all the single quotes(<code>'</code>).</p>\n\n<pre><code>@content.gsub(/'/,\"\")\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13195839,"title":"image_tag doesn't behave","body":"<p>OK, we are ALL at a loss here. Trying to display an image with image_tag. The path is stored in a sqlite3 varchar(64) field, with quotes around it. The field is called imagepath.</p>\n\n<p>On the show page...</p>\n\n<p>This: &lt;%=@invitem.imagepath%>\ngives me THIS:\n\"/images/5585L.jpg\"\"</p>\n\n<p>This:\n&lt;%=image_tag(@invitem.imagepath) %></p>\n\n<p>gives me THIS:\n5585l (note the lower case L)</p>\n\n<p>This:\n&lt;%=image_tag(\"/images/6287L.jpg\")%>\nRenders the image I want.</p>\n\n<p>Anybody got a clue?\nStuart</p>\n"},{"tags":["ruby-on-rails-3","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":27,"score":-1,"question_id":13192730,"title":"RVM Installation","body":"<p>I am trying to install rvm on ubuntu 11.10.\nI have installed it using following command through curl.</p>\n\n<p><code>curl -L get.rvm.io | bash -s stable --auto</code></p>\n\n<p>On terminal it specifies that rvm has been installed properly and I have checked .rvm directory has been created properly in my home directory and in .rvm directory version file is present but when I write rvm -v on terminal it gives following msg</p>\n\n<p><code>~$ rvm -v\nThe program 'rvm' is currently not installed.  You can install it by typing: sudo apt-get install ruby-rvm</code></p>\n\n<p>Please help.</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13194003,"title":"Can I use CSS assets and the public folder in the same app?","body":"<p>I have a legacy application that I'd like to migrate to use the Rails 3 asset pipeline. I have upwards of 100 stylesheets which are imported on a template by template basis using a </p>\n\n<pre><code>content_for :stylesheets\n</code></pre>\n\n<p>block.</p>\n\n<p>Compiling them all into a single stylesheet is not currently a goer as the code was written to expect only certain stylesheets on certain pages, so for example the login page imports a stylesheet which redefines <em>article form</em>. It would not be good to redefine this on all pages.</p>\n\n<p>Is there a way to migrate slowly to the assets pipeline having the app look first for a <strong>compiled asset</strong>, and then having it failover to the <strong>public/stylesheets</strong> directory?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13031774,"title":"custom actions inside rails_admin gem","body":"<p>I don't understand very good yet how it works <a href=\"https://github.com/sferik/rails_admin\" rel=\"nofollow\">rails_admin gem</a> for create a new action.</p>\n\n<p>I want create a action with name <strong>balance</strong> in rails_admin root.</p>\n\n<p>I have created a file with name <strong>rails_admin_balance.rb</strong> inside <strong>myapp/lib</strong> folder like:</p>\n\n<pre><code>require 'rails_admin/config/actions'\nrequire 'rails_admin/config/actions/base'\n\nmodule RailsAdminBalance\nend\n\nmodule RailsAdmin\n  module Config\n    module Actions\n      class Balance &lt; RailsAdmin::Config::Actions::Base\n       RailsAdmin::Config::Actions.register(self)\n        register_instance_option :object_level do\n          true\n        end\n        register_instance_option :link_icon do\n         'icon-eye-open'\n        end\n        register_instance_option :root? do\n          true\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I have created a new file on <strong>/views/rails_admin/main/balance.html.erb</strong></p>\n\n<p>inside my <code>rails_admin.rb</code> file I have</p>\n\n<pre><code>config.actions do\n dashboard                     # mandatory\n # collection actions \n index                         # mandatory\n new\n export\n history_index\n bulk_delete\n # member actions\n show\n edit\n delete\n history_show\n show_in_app\n balance \nend\n</code></pre>\n\n<p>When I try run rails server I get this error:</p>\n\n<p>Exiting</p>\n\n<pre><code>/home/ubuntu/Desktop/myapp/config/initializers/rails_admin.rb:33:in `block (2 levels) in &lt;top (required)&gt;': undefined method `balance' for RailsAdmin::Config::Actions:Module (NoMethodError)....\n</code></pre>\n\n<p>Where have I the error?</p>\n\n<p>What am I doing bad?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12029862,"title":"how add test data to my local sqlite in rails 3?","body":"<p>I need to add rows of test data to my sqlite.</p>\n\n<pre><code>INSERT INTO courses (`name`) VALUES\n(‘java'),\n(‘ruby').......\n</code></pre>\n\n<p>How can i do it with rails3?</p>\n\n<p>Thanks</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13194916,"title":"Act_as_taggable_on tags belonging to user","body":"<p>I am struggling to use act_as_taggable_on and rails3-jquery-autocomplete together.</p>\n\n<p>In my case tage name should belong to different users. So when a user starts typing only tag names created by the user should show up in autocomplete.</p>\n\n<p>For that I somehow have to modify act_as_taggable_on to also save the id of the user.\n(I don't care about the user creating the actual tag. But I need all the tag names the user already used)</p>\n\n<p>Until now all tag names created by all users are shown in autocomplete.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails-3","diacritics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12005739,"title":"Replace Umlauts in Ruby on Rails","body":"<p>i call a method before i save data and want to replace umlauts in a string like so:</p>\n\n<pre><code>def replace_chars\nself.slug = self.slug.gsub(/[äöüß]/) do |match|\n  case match\n    when \"ä\" 'ae'\n    when \"ö\" 'oe'\n    when \"ü\" 'ue'\n    when \"ß\" 'ss'\n  end\nend\nend\n</code></pre>\n\n<p>my problem is, that i want to save the new string into the slug.\nhow can i do this?</p>\n\n<p>Thanks a lot,</p>\n\n<p>Peter</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13193905,"title":"jQuery not working on Rails 3.2.8","body":"<p>I'm having an issue with jQuery on Rails 3.2.8. I've installed the jquery-rails gem and my application.js has the following:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require_tree .\n</code></pre>\n\n<p>views/layouts/application.html.erb has</p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>A simple Javascript test in test.js:</p>\n\n<pre><code>if (jQuery) {\nalert('Jquery is loaded')\n} else {\nalert ('Jquery is not loaded')\n}\n</code></pre>\n\n<p>gives me an alert telling me that jQuery is indeed loaded.</p>\n\n<p>However, no jQuery commands will work, even basic ones are unresponsive:</p>\n\n<pre><code>$(document).ready(function(){\n $(\"a\").click(function(event){\n alert(\"Thanks for visiting!\");\n});\n});\n</code></pre>\n\n<p>I've tried everything -- even reincluding jQuery through the Google API. Any ideas on what might be going on?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13193640,"title":"Rails undefined method for ActiveRecord::Relation error calculating cart items","body":"<p>I'm trying to calculate a total price for all the items contained within a cart. However I'm getting a <code>undefined method total_cart_price for ActiveRecord::Relation:xxx</code></p>\n\n<p><strong>Shop Cart Model (shop_cart.rb)</strong></p>\n\n<pre><code>has_many :shop_cart_items, :dependent =&gt; :destroy\n\n\n  def total_cart_price\n    shop_cart_items.to_a.sum { |item| item.total_price }\n  end\n</code></pre>\n\n<p><strong>Shop Cart Item Model (shop_cart_item.rb)</strong></p>\n\n<pre><code>attr_accessible :quantity, :shop_cart_id, :shop_product_id\n\n  belongs_to :shop_product\n  belongs_to :shop_cart\n\n\n  def total_price\n    shop_product.sell * quantity\n  end\n</code></pre>\n\n<p><strong>Basket View (shop/basket.html.erb)</strong></p>\n\n<pre><code>&lt;tbody&gt;\n    &lt;% @cart_items.each do |item| %&gt;\n        &lt;tr&gt;\n        &lt;td&gt;&lt;%= item.shop_product.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= number_to_currency(item.shop_product.sell) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= number_to_currency(item.total_price) %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;% end %&gt;\n    &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;Subtotal:&lt;/td&gt;\n    &lt;td&gt;&lt;%= number_to_currency(@cart_items.total_cart_price) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>The total price, for a single item, works fine; the error is trying to calculate a sum of all the items.</p>\n\n<p>I do not have a shop_cart controller or views as I am calling the methods from a shop#basket view - not sure if this is what is causing the problem?</p>\n\n<p>Any help much appreciated.</p>\n"},{"tags":["ruby","regex","ruby-on-rails-3","substring"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13192578,"title":"Fetching the substring contained between two specific words","body":"<p>I wanted to know how to proceed when I am interested in the text contained between particular words.\neg.</p>\n\n<pre><code>@var = \"Hi, I want to extract container_start ONLY THIS DYNAMIC CONTENT container_end from the message contained between the container_start and container_end \"\n</code></pre>\n\n<p>Now I want to extract the CAPITALIZED content from the string i.e. dynamic but always contained after the two containers (<code>container_start</code> and <code>container_end</code>)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","callback","rails-engines"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13193314,"title":"The customized callbacks in Rails Engine can't be triggered","body":"<p>I meet a problem after I moved some of my code into rails engine. Before, the model file order.rb and some customized callback files were put in the main app folder, like:</p>\n\n<pre><code>MyProject\n|- app\n    |- models\n    |    |- order.rb\n    |\n    |- callbacks\n         |- order_callback.rb\n</code></pre>\n\n<p>And the file contents are: </p>\n\n<pre><code># order.rb\nclass Order &lt; ActiveRecord::Base\n  include OrderCallback\nend\n\n# order_callback.rb\nmodule OrderCallback\n  extend ActiveSupport::Concern\n\n  included do\n    p '-------------- included ----------------'\n    before_create :set_default_values\n  end\n\n  def set_default_values\n    p '------------- set default values ------------'\n  end\nend\n</code></pre>\n\n<p>And I add the app/callbacks dir into the autoload_paths, everything worked fine, the two traces are both printed.</p>\n\n<p>The problem happened after I moved these code into a rails engine. I added the app/callbacks to the engine config.autoload_paths, and can see the first trace which means the callback module is included, but I can't get the second trace when I create an order.</p>\n\n<p>I tried to move the callback to be an observer, it works fine. But I don't want it to be an observer for some reason.</p>\n\n<p>Anyone knows the reason? Thanks! </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":203,"score":1,"question_id":11570924,"title":"Ruby on Rails: How to override the 'show' route of a resource?","body":"<p>Currently I have a route that looks like this:</p>\n\n<pre><code>resources :posts\n</code></pre>\n\n<p>I want to override the 'show' action so that I can display a url like this:</p>\n\n<pre><code>posts/:id/:slug\n</code></pre>\n\n<p>I am currently able to do this by adding a custom <code>match</code> route:</p>\n\n<pre><code>resources :posts\nmatch 'posts/:id/:slug' =&gt; 'posts#show'\n</code></pre>\n\n<p>However, when I use the <code>link_to</code> helper, it does not use my custom show route.</p>\n\n<pre><code>&lt;%= link_to 'show', post %&gt;  # renders /posts/123\n</code></pre>\n\n<p>How can I define my show route so that I can still use the <code>link_to</code> helper?</p>\n\n<p><strong>Update:</strong> As you can read in the following answers, you can override the route to the 'show' action, but it's probably more work than it's worth. It's easier to just create a custom route:</p>\n\n<pre><code># config/routes.rb\nmatch 'posts/:id/:slug' =&gt; 'posts#show', as: 'post_seo'\n\n# app/views/posts/index.html.erb\n&lt;%= link_to post.title, post_seo_path(post.id, post.slug) %&gt;\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","remedy"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13192426,"title":"accessing a database from ruby using an odbc driver (Remedy)","body":"<p>I have the Remedy odbc driver installed on my machine. I am able to pull down data from Remedy via excel just fine specifying this driver in my connection.</p>\n\n<p>Is there any way I could use this driver from within Ruby / Ruby on rails to connect to and read from the DB? </p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","nested-resources","nested-routes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13191798,"title":"Nested resource and restricting the Routes Created :only and :except","body":"<p>Good day all,</p>\n\n<p>Can someone kindly assist me with nested resources and its best practice.</p>\n\n<p>I would like to restrict my <code>:events</code> route to only <code>:show</code> and <code>:index</code>, is this the correct way of doing it?</p>\n\n<pre><code>resources :events do\n    resources :registrations, :except =&gt; [:index]\nend\n\nresources :events, :only =&gt; [:index, :show]\n</code></pre>\n\n<p>Is this the best way or the way more Rubyist would handle such thing? I've added two lines of <code>resources :events</code> or is there a way to combine it all in 1 block?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hmvc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":13066048,"title":"Dissecting ruby on rails model, view, controllers and routes for a large project","body":"<p>I want to  separate model view controllers in HMVC form including routes.After reading i found that ruby on rails  does not support HMVC structure.Is there any alternative of doing it?. I also want to separate routes module wise.\nPlease suggest some best ways of doing it as keeping everything in one place is hard to manage.Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","security","devise","cancan","rails-admin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13179927,"title":"CanCan and Boolean User Authorization - Security Risk?","body":"<p>For using Multiple \"roles\" on Users in rails_admin CanCan seems to be a great choice. So I added a Boolean Attribute \"admin\" to the User-Model and tell CanCan to allow access to rails_admin only if this is present. </p>\n\n<p>But isn't this a security issue? How can I be sure, that nobody is able to change the attribute?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13184770,"title":"Nested Model Form. Belongs_to class not displaying","body":"<p>I have a Subject Model and a Lesson Model.\nI implemented a nested model form.</p>\n\n<p>After subject creation, I led it to a page where it supposedly shows the lessons associated. However, I fail to see the lessons.</p>\n\n<p>I believe the data for lessons did not get saved properly as \nWhen I did a for example lesson.find_by_subject_id('1'), I get 'nil' in return.</p>\n\n<p>I am trying to figure out how polymorphism works on rails and would appreciate it if someone could either point out where I've gone wrong or give me some guidance on how those to pass the values for belong_to classes to be created.</p>\n\n<p>Subject Model</p>\n\n<pre><code>attr_accessible :subjectCode, :lessons_attributes\nhas_many :lessons, :dependent =&gt; :destroy\naccepts_nested_attributes_for :lessons, :reject_if =&gt; lambda { |a| a[:content].blank? }, :allow_destroy =&gt; true\n</code></pre>\n\n<p>Lesson Model</p>\n\n<pre><code>attr_accessible :lessonName, :subject, :subject_id\nbelongs_to :subject\n</code></pre>\n\n<p>Subject Controller</p>\n\n<pre><code>def new\n3.times {@subject.lessons.build}\nend\n\ndef create\n  @subject = Subject.new(params[:subject])\n  if @subject.save\n    redirect_to @subject, :notice =&gt; \"Successfully created subject.\"\n  else\n    render :action =&gt; 'new'\n  end\nend\n</code></pre>\n\n<p>Form</p>\n\n<pre><code>&lt;%= form_for @subject do |f| %&gt;\n  &lt;%= f.error_messages %&gt;\n  &lt;p&gt;\n    &lt;%= f.label :subjectCode %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :subjectCode %&gt;\n  &lt;/p&gt;\n\n  &lt;%= f.fields_for :lessons do |builder| %&gt;\n    &lt;p&gt;    \n    &lt;%= builder.label :lessonName %&gt; &lt;br/&gt;\n    &lt;%= builder.text_area :lessonName, :rows=&gt;3 %&gt;\n    &lt;/p&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;&lt;%= f.submit \"Submit\" %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Routes\n    resources :subjects do resources :lessons end</p>\n"},{"tags":["ajax","ruby-on-rails-3","mobile","jquery-mobile"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":120,"score":0,"question_id":11408866,"title":"rails 3, jquery mobile: param lost in ajax call (remote => true)","body":"<p>In a rails3 application with jquery mobile I am having a problem when using a link_to with :remote => true because the parameters passed in the link are ignored. I have been looking around in the several posts discussing problems between remote => true and jquery mobile but they don't seem to be exactly the same problem.</p>\n\n<p>Here the code:</p>\n\n<pre><code>&lt;%= link_to _('mobile|contacts|Show next'), mobile_contacts_path(:page =&gt; @my_relations.next.number),\n    :data =&gt; { :role =&gt; 'button', :remote =&gt; true}, :class =&gt; compact' %&gt;\n</code></pre>\n\n<p>When clicking the link in the phone the call is actually working fine and the view is rendered, only thing is that the :page parameter is not passed (so the \"page\" one is rendered again and again).</p>\n\n<pre><code>Started GET \"/de_de/mobile/contacts\" for 10.0.173.62 at Tue Jul 10 09:13:00 +0200 2012\n2012.07.10 09:13:00 - INFO - #14570: Processing by Mobile::ContactsController#index as JS\n2012.07.10 09:13:00 - INFO - #14570:   Parameters: {\"locale\"=&gt;\"de_de\"}\n</code></pre>\n\n<p>On the other hand the link is working fine when trying it in the desktop computer browser:</p>\n\n<pre><code>Started GET \"/de_de/mobile/contacts?page=3\" for 127.0.0.1 at Tue Jul 10 09:12:03 +0200 2012\n2012.07.10 09:12:03 - INFO - #14570: Processing by Mobile::ContactsController#index as JS\n2012.07.10 09:12:03 - INFO - #14570:   Parameters: {\"page\"=&gt;\"3\", \"locale\"=&gt;\"de_de\"}\n</code></pre>\n\n<p>The parameter is also passed when removing :remote => true from the link_to.</p>\n\n<p>Any ideas? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","introspection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13190724,"title":"Rails: list accepted values of \"validates :inclusion\" field","body":"<p>I have a model like this</p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  attr_accessible :kind, :question, :state\n  belongs_to :section\n  validates :question, :kind, :state, :presence =&gt; true\n  validates :question, :uniqueness =&gt; {:scope =&gt; [:section_id]}\n  validates :kind, :inclusion =&gt; {:in =&gt; %w(radio check stars)}\n  validates :state, :inclusion =&gt; {:in =&gt; %w(new active answered canceled)}\nend\n</code></pre>\n\n<p>is it posible to list all accepted values for some field ? For example get the list of %w(radio check stars) from the field \"kind\"</p>\n"},{"tags":["ruby-on-rails-3","capistrano","less-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13190644,"title":"Cannot call method 'charAt' of undefined","body":"<p>I am having rails3 application which running fine in my local ubuntu machine. I deployed my application using capistrano-unicorn to remote server via copy. The remote server is also having a same configuration which I had in local machine like</p>\n\n<pre><code>rvm 1.16.17\nruby 1.9.3p286\nRails 3.2.8\nless 2.2.2\nless-rails 2.2.6\nless-rails-bootstrap 2.2.0\n</code></pre>\n\n<p>My Gemfile </p>\n\n<pre><code>group :assets do\n  gem 'less-rails-bootstrap'\n  gem 'therubyracer'\n  gem 'uglifier'\nend\n</code></pre>\n\n<p>I am getting an error</p>\n\n<blockquote>\n  <p>Less::Error in User/home#index Cannot call method 'charAt' of\n  undefined   (in\n  /home/user/rails_app_development/releases/20121102052832/app/assets/stylesheets/layout.css.less)</p>\n</blockquote>\n\n<p>Where I am doing wrong here?</p>\n"},{"tags":["ruby-on-rails-3","cocoon"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":104,"score":1,"question_id":10730780,"title":"cocoon, link_to_remove_association with confirm?","body":"<p>is there an easy way to add confirm dialog box that would appear when user clicks link_to_remove_association ?</p>\n\n<p>cocoon gem is really great, I wonder if it has such a ready option ?? if not, can I use jQuery to cancel or let go the event ?</p>\n\n<p>Thanks,</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13189968,"title":"Display no of listings on a page in Ruby on Rails","body":"<p>I'm working with an RoR project where I've implemented a search page which is working fine, what I'm looking to achieve is <a href=\"http://screencast.com/t/Rp7Ytncbut\" rel=\"nofollow\">the number of listings</a>.</p>\n\n<p>Actually, what I've used here is hardcoded HTML since I don't know what code or gem to use. Any suggestions how I can achieve this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","generate"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":271,"score":1,"question_id":4340682,"title":"How can I generate older rails application when current version is 3.0.3","body":"<p>I have 2 different Rails Rubygems installed on my Linux OS [2.3.8 and 3.0.3] , but the current active Rails version is 3.0.3. So is it possible to generate Rails app using 2.3.8 style generator:<code>rails testapp</code> not new one: <code>rails new testapp</code> ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller","refresh"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13188055,"title":"Rails controller method execution","body":"<p>Suppose I have a Rails controller method, which is executed when the user submits a form. Now, the user submits the form, and while the method is running (and hasn't rendered the next page to the user), the user hits \"Refresh\". What is going to happen? Will the method stop running and restart, or will there be another thread to run the method once more?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13188163,"title":"Rails Route Configuration","body":"<p>I have a series of items I would wish to edit. When editing the current format of my URL appears as such:</p>\n\n<pre><code>http://mysite/items &lt;---- Lists the items\nhttp://mysite/items/1/ &lt;------ more detailed view of items\nhttp://mysite/items/1/edit &lt;----- Ability to edit the item\n</code></pre>\n\n<p>The routing configuration I would like to try and apply to my structure would like something like this:</p>\n\n<pre><code>http://mysite/items &lt;---- Lists the items\nhttp://mysite/item &lt;---- Detailed view of the item by sending the item ID as POST data\nhttp://mysite/item/edit &lt;---- Edits the item by sending the item ID as POST data\n</code></pre>\n\n<p>Is this strictly an event of the rails route configuration or do I have to configure the links in the <code>items</code> page to structure the URL specifically.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13188154,"title":"Loop dates and list vertically","body":"<p>I am trying to list dates of the month vertically, so far my table looks as followed: </p>\n\n<p><img src=\"http://i.stack.imgur.com/Ek5Lk.png\" alt=\"enter image description here\"></p>\n\n<p>I have today's date however I need to list 18 days from today vertically. As well as generate the cells against these dates. From my index.html.erb I understand that  I have the following <code>@dates</code> variable isn't being set properly in my controller. </p>\n\n<blockquote>\n  <p><code>@dates</code> variable isn't being set properly, if you add the statement\n  &lt;%= debug @dates %> to your view you can inspect what it's being</p>\n</blockquote>\n\n<p>Controller: <a href=\"https://gist.github.com/3998126\" rel=\"nofollow\">Gist - Controller.rb </a></p>\n\n<p>Index: <a href=\"https://gist.github.com/3998129\" rel=\"nofollow\">Gist - Index.html.erb</a></p>\n\n<p>Model: <a href=\"https://gist.github.com/3998134\" rel=\"nofollow\">Gist - Model.rb </a></p>\n\n<p>I understand that I will need to change my controller's index action so it is able to list 18 days from today. I was thinking of doing something somewhat similar.. - <code>Time.now+18.days</code> However I am not sure if something like this would solve my problems? As I'm not fully sure how to implement this into my controller. What is the best possible solution?</p>\n"},{"tags":["ruby-on-rails-3","apache","phusion-passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13188803,"title":"What are all the configurable timeouts in an Apache/Passenger/Rails stack?","body":"<p>I'm really interested in what all the timeout configurations are in my Rails (3.0.0) server's stack, and ideally, what those timeouts mean in plainish English.</p>\n\n<p>The impetus for my curiosity is receiving a \"SocketException: Connection reset\" from a Java client that makes RESTful calls to a Rails server, and trying to figure out what timeouts would cause my server's internal processing to cut short before sending a response (the Rails server itself makes another service call in the code path under question).</p>\n\n<p>So basically I have a broad question (all configurable timeouts) and a narrow question (connection reset issue), and I'm hoping an awesomely thorough and well-written answer to the broad will in turn answer the narrow.</p>\n\n<p>All I know so far:</p>\n\n<p>Apache 2.2:<br>\n<a href=\"http://httpd.apache.org/docs/2.2/mod/core.html#timeout\" rel=\"nofollow\">TimeOut</a>: default = 300 seconds<br>\nSeems like more of a client read/write timeout than waiting on the internals to generate the response.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","where-clause"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1026,"score":2,"question_id":6260288,"title":"How do you do a Rails 3 select IN using where clauses","body":"<p>I am using Rails 3 and I need to do a select where the primary key of the records is IN a resulting previous select.  You can do this easily using straight SQL using an IN.  Here is the obviously incorrect way I have done what I need.  What's the Rails way to do this well:</p>\n\n<pre><code>@task = Link.find(params[:id])\nclients = Client.where('task_id = ?',@task.id).select('DISTINCT(company_id)')\ncompany_list = []\nclients.each do |client|\n  company_ids &lt;&lt; client.company_id\nend\n@companies = Company.where(:id =&gt; company_ids)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13187726,"title":"Cancan authorize custom module","body":"<p>I have a custom module in my lib directory that I load in my Application controller. I started using cancan and now I am getting Access Denied error for all the actions in my custom module. I don't want cancan to check authorization on my custom module. One way to get around this is to use <code>except =&gt; [:action_name_in_my_custom_module]</code> but I have lot of actions that I use in my application at many places. I need a better solution. </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":87,"score":2,"question_id":13021586,"title":"\"Failed to load resource\" errors for .js and .css files when running Rails application offline in development environment","body":"<p>I'm trying to get a Rails application to work offline. The application appears to work OK when online.</p>\n\n<p>In Chrome, when the server is running, I see this from the Chrome console when I run the application (portions snipped). :</p>\n\n<pre><code>Document was loaded from Application Cache with manifest\nhttp://localhost:3000/application.manifest\nApplication Cache Checking event\nApplication Cache Downloading event\n...\nApplication Cache Progress event (5 of 16) http://localhost:3000/assets/todos.css.scss\nApplication Cache Progress event (6 of 16) http://localhost:3000/assets/application.css\nApplication Cache Progress event (7 of 16) http://localhost:3000/assets/todos.js.coffee\nApplication Cache Progress event (8 of 16) http://localhost:3000/assets/jquery.tmpl.js\nApplication Cache Progress event (9 of 16) http://localhost:3000/assets/jquery.offline.js\n...\nApplication Cache Progress event (11 of 16) http://localhost:3000/assets/jquery.js\n...\nApplication Cache Progress event (13 of 16) http://localhost:3000/assets/json.js\nApplication Cache Progress event (14 of 16) http://localhost:3000/assets/scaffolds.css.scss\nApplication Cache Progress event (15 of 16) http://localhost:3000/assets/application.js\nApplication Cache Progress event (16 of 16) \nApplication Cache UpdateReady event\n</code></pre>\n\n<p>However, offline I see this (again, some snipped). Note that the <code>GET</code> lines are load errors.:</p>\n\n<pre><code>Document was loaded from Application Cache with manifest http://localhost:3000/application.manifest\nApplication Cache Checking event\nGET http://localhost:3000/assets/application.css?body=1  todos:5\nGET http://localhost:3000/assets/scaffolds.css?body=1  todos:6\nGET http://localhost:3000/assets/todos.css?body=1  todos:7\nGET http://localhost:3000/assets/jquery.js?body=1  todos:8\nGET http://localhost:3000/assets/jquery_ujs.js?body=1  todos:8\nGET http://localhost:3000/assets/jquery.offline.js?body=1  todos:8\nGET http://localhost:3000/assets/jquery.tmpl.js?body=1  todos:8\nGET http://localhost:3000/assets/json.js?body=1  todos:8\nGET http://localhost:3000/assets/offline.js?body=1  todos:8\nGET http://localhost:3000/assets/todos.js?body=1  todos:8\nGET http://localhost:3000/assets/application.js?body=1  todos:8\nApplication Cache Error event: Manifest fetch failed (-1) http://localhost:3000/application.manifest\n</code></pre>\n\n<p>In particular, I notice <code>?body=1</code> is appended to the file name when offline.</p>\n\n<p><strong>Environment:</strong></p>\n\n<ul>\n<li>Rails: 3.2.8</li>\n<li>ruby 1.9.3p194</li>\n<li>WEBrick: 1.3.1</li>\n<li>MySQL: 5.5.28 MySQL Community Server</li>\n<li>Chrome: Version 22.0.1229.94 m</li>\n<li>OS: Windows 7 Enterprise version 6.1 (Build 7601: Service Pack 1)</li>\n</ul>\n\n<p><strong>Gems</strong> (the gems I think are relevant):</p>\n\n<ul>\n<li>jquery-rails (2.1.3)</li>\n<li>json (1.7.5, 1.5.4)</li>\n<li>rack-offline (0.6.4)</li>\n<li>sprockets (2.1.3)</li>\n</ul>\n\n<p><strong>Application Manifest</strong>:</p>\n\n<pre><code>CACHE MANIFEST\n# ef05db1f746b226b3eb8b3673d65d3585eb8a9e1e35f79a6fc9d90693ff9a569\n404.html\n422.html\n500.html\nindex.html\nassets/application.js\nassets/jquery.js\nassets/jquery.offline.js\nassets/jquery.tmpl.js\nassets/json.js\nassets/todos.js.coffee\nassets/application.css\nassets/scaffolds.css.scss\nassets/todos.css.scss\n\nNETWORK:\n/\n</code></pre>\n\n<p><strong>application.html.erb</strong>:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html manifest=\"/application.manifest\"&gt;\n&lt;head&gt;\n    &lt;title&gt;TestOffsite&lt;/title&gt;\n    &lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n    &lt;%= javascript_include_tag \"application\" %&gt;\n    &lt;%= csrf_meta_tags %&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;%= yield %&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>todos_controller.erb</strong> (snipped):</p>\n\n<pre><code>class TodosController &lt; ApplicationController\n  # GET /todos\n  # GET /todos.json\n  respond_to :html, :json   \n\n  def index\n    @todos = Todo.all\nrespond_with(@todos)\n    #respond_to do |format|\n    #  format.html # index.html.erb\n    #  format.json { render json: @todos }\n    #end\n  end\n...\n</code></pre>\n\n<p><strong>Contents of manifest.yml</strong>:</p>\n\n<pre><code>---\nrails.png: rails-be8732dac73d845ac5b142c8fb5f9fb0.png\napplication.js: application-39fb9cbdc400e6885a41059ea60f3851.js\napplication.css: application-0149f820dbdd285aa65e241569d8c256.css\n</code></pre>\n\n<p>Any help is much appreciated.</p>\n"},{"tags":["ruby-on-rails-3","forms","associations","nested-attributes","virtual-attribute"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13168697,"title":"UnknownAttributeError using build for virtual attribute","body":"<p>I have a nested form containing virtual attributes :card_number and :card_verification.  When I try to build with these in the controller update action, I get ActiveRecord::UnknownAttributeError.</p>\n\n<p>The models have a simple has_one relationship, where an appointment has_one order</p>\n\n<pre><code>#/models/appointment.rb\nclass Appointment &lt; ActiveRecord::Base\n  has_one :order\n  accepts_nested_attributes_for :order\n\n  attr_accessible (...)\nend\n\n#/models/order.rb\nclass Order &lt; ActiveRecord::Base\n  belongs_to :appointment\n\n  attr_accessible :email, (...)\n  attr_accessor :card_number, :card_verification\nend\n</code></pre>\n\n<p>I'm generating the form like this:</p>\n\n<pre><code># /views/appointments/edit.html.erb\n&lt;%= form_for @appointment do |f| %&gt;\n  ...\n  &lt;%= f.fields_for @appointment.order do |builder| %&gt;\n    &lt;%= builder.label :email %&gt;\n    &lt;%= builder.text_field :email %&gt; # works fine on its own\n    ...\n    &lt;%= f.label :card_number %&gt;\n    &lt;%= f.text_field :card_number %&gt;\n\n    &lt;%= f.label :card_verification %&gt;\n    &lt;%= f.text_field :card_verification %&gt;\n  &lt;% end %&gt;\n  ...\n&lt;% end %&gt;\n</code></pre>\n\n<p>And building in the controller:</p>\n\n<pre><code># /controllers/appointments_controller.rb\ndef update\n  @appointment = Appointment.find(params[:id])\n  @order = @appointment.build_order(params[:appointment]['order']) # This line is failing\n\n  if @appointment.update_attributes(params[:appointment].except('order'))\n    # ... Success\n  else\n    # ... Failure\n  end\nend\n</code></pre>\n\n<p>With this, I'm getting the error <code>Can't mass-assign protected attributes: card_number, card_verification</code> when I try to submit for update, with params:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"_method\"=&gt;\"put\",\n \"authenticity_token\"=&gt;\"KowchWLNmD9YtPhWhYfrNAOsDfhb7XHW5u4kdZ4MJ4=\",\n \"appointment\"=&gt;{\"business_name\"=&gt;\"Name\",\n \"contact_method\"=&gt;\"Phone\",\n \"contact_id\"=&gt;\"555-123-4567\",\n \"order\"=&gt;{\"email\"=&gt;\"user@example.com\",\n \"first_name\"=&gt;\"John\",\n \"last_name\"=&gt;\"Doe\",\n \"card_number\"=&gt;\"4111111111111111\", # normally [FILTERED]\n \"card_verification\"=&gt;\"123\", # normally [FILTERED]\n \"card_type\"=&gt;\"visa\",\n \"card_expires_on(1i)\"=&gt;\"2015\",\n \"card_expires_on(2i)\"=&gt;\"11\",\n \"card_expires_on(3i)\"=&gt;\"1\",\n \"address_line_1\"=&gt;\"123 Main St\",\n \"address_line_2\"=&gt;\"\",\n \"city\"=&gt;\"Anywhere\",\n \"state\"=&gt;\"CA\",\n \"country\"=&gt;\"USA\",\n \"postal_code\"=&gt;\"90210\"}},\n \"commit\"=&gt;\"Submit\",\n \"id\"=&gt;\"2\"}\n</code></pre>\n\n<p>Everything works fine without the :card_number and :card_verification values included in the form.</p>\n\n<p>Does anyone know what is going wrong here?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I can get this working with:</p>\n\n<pre><code>@order = @appointment.build_order(params[:appointment]['order'].except('card_number', 'card_verification'))\n</code></pre>\n\n<p>but this seems a bit clunky.  Are there any other ways to get around this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13187076,"title":"Paginating an Array in Ruby with will_paginate","body":"<p>I have an array @level1 which looks like this :</p>\n\n<pre><code>[[3.0, 4, 2], [2.0, 48, 3], [2.1, 56, 4], ............]\n</code></pre>\n\n<p>I want to apply pagination on this array such each page displays only a few rows at once. I tried this:</p>\n\n<pre><code>@temp1 = @level1.paginate(:page =&gt; params[:page])\n</code></pre>\n\n<p>But it throws the following error: </p>\n\n<pre><code>undefined method `paginate' for [[3.0, 4, 2], [2.0, 48, 3], [2.1, 56, 4]]:Array\n</code></pre>\n\n<p>How can I perform pagination on this using will_paginate?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":10553433,"title":"simple_format and 2+ newline(\\n)","body":"<p>I'm using rails and need to show text, having 3 or more newline characters in a row.</p>\n\n<p>I found <code>simple_format</code> method, but it works with 2,3,4,... symbols identically</p>\n\n<blockquote>\n  <p>Two or more consecutive newlines(\\n\\n) are considered as a paragraph and wrapped in &lt; p > tags. </p>\n</blockquote>\n\n<p>For example, my text is</p>\n\n<pre><code>1.9.3p0 :015 &gt; Article.last.text\n=&gt; \"1\\n\\n2\\n\\n\\n\\n33\" \n</code></pre>\n\n<p>when i do <code>&lt;%= simple_format Article.last.text.html_safe %&gt;</code> it generates me this view:</p>\n\n<pre><code>&lt;p&gt;1&lt;/p&gt;\n&lt;p&gt;2&lt;/p&gt;\n# but i need &lt;br/&gt; or smth else there\n&lt;p&gt;3&lt;/p&gt;\n</code></pre>\n\n<p>Other solutions are welcome, thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13186142,"title":"Modifying a SQL query for use with 'will_paginate' in Ruby","body":"<p>I have the following SQL query which I use to fetch some rows from a mySQL database :</p>\n\n<pre><code>SELECT code_ver, result FROM mastertest WHERE date &gt;= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;\n</code></pre>\n\n<p>This query gives me data from the past 90 days. Now I want to display the data of 10 days at a time in my html.erb page (view). I am aware that pagination can be done using 'will_paginate' and 'kaminari' gems. But I am not sure how to query the database with certain conditions as shown above.</p>\n\n<p>Can someone help me with the code here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13186592,"title":"Rails routes and helper functions","body":"<p>I have defined the following route on my routes file:</p>\n\n<pre><code>match \"/users/:id/courses\", :to =&gt; 'users#courses'\n</code></pre>\n\n<p>Do you know what is the helper function that is generated for that route?</p>\n\n<p>I have tried this:</p>\n\n<pre><code>users_courses_path(current_user)\nuser_courses_path(current_user)\nusers_course_path(current_user)\nuser_course_path(current_user)\n</code></pre>\n\n<p>But none of those works</p>\n\n<p>Regards</p>\n"},{"tags":["mysql","sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13186281,"title":"Stripping Phone Numbers of Non-numeric Values During SQL Query in Rails","body":"<p>I have a list of new restaurants and I want to check them against a database of restaurants using the phone number. The problem with phone numbers is that they have different formatting in the database (i.e. <code>123-345-6789</code> or <code>(123)-456 8988</code>).</p>\n\n<p>So far, I have created an index for the phone so that I search through them quickly. I also stripped the phone number of the new restaurants so that they only contain numeric values (0-9).</p>\n\n<p>Now, I want to strip the databases' numbers right before I compare so that I will strictly comparing numbers.</p>\n\n<pre><code>#strip the phone of non-numeric values and spaces\nformatted_phone = SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\") \n\nRestaurant.where(contact_phone: formatted_phone).each do |r|\n  #irrelevant code here\nend\n</code></pre>\n\n<p>The problem with the above code is that contact_phone (from database) will be in its non-stripped format. My research so far has lead me to believe that I have to use something like <code>REGEXP_LIKE</code>, but I'm not quite sure how to implement this with Rails. I do NOT want to update the database - I simply want to strip the numbers for comparison while still keeping the original formatting in the DB.</p>\n\n<p>How do I strip the phone numbers, <code>contact_phone</code>, of non-numeric values from the database before I compare it with <code>formatted_phone</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","fancybox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13186480,"title":"fancybox ajax rails degrading properly","body":"<p>I have a fancybox.ajax fancybox and in the controller</p>\n\n<pre><code>respond_to do |format|\n  format.html\n  format.js\nend\n</code></pre>\n\n<p>Then I have show.html.erb and _show.html.erb and show.js.erb</p>\n\n<p>But it is taking show.html.erb and putting it in the fancybox (including my application.html layout).</p>\n\n<p>I want both because I want to direct ppl to a url to get the html, and inapp users to have a lightbox.</p>\n\n<p>thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activeadmin"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":144,"score":3,"question_id":11598116,"title":"ActiveAdmin display default view content","body":"<p>I am working with ActiveAdmin and need to make customizations to some views and have come across a couple of scenarios I feel I am doing wrong.</p>\n\n<p>I am adding an additional table to a show view (comments on Posts). This requires me to rewrite the whole attributes table and then add my panel. Is there a way to customize views without losing the default content?</p>\n\n<p>I would also like to add a table of associated items on the show view which doesn't need to be customized is there any way to include the default tale that would normally be on the index view with default actions and paging?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","belongs-to","activeadmin"],"answer_count":3,"favorite_count":8,"up_vote_count":12,"down_vote_count":0,"view_count":2028,"score":12,"question_id":7198062,"title":"Nested form in active_admin with select or create option","body":"<p>We are using active_admin for our administration backend. </p>\n\n<p>We have a model \"App\" that :belongs_to model \"Publisher\":</p>\n\n<pre><code>class App &lt; ActiveRecord::Base\n  belongs_to :publisher\nend\n\nclass Publisher &lt; ActiveRecord::Base\n  has_many :apps\nend\n</code></pre>\n\n<p>When creating a new entry for the \"App\" model I want to have the option to either select an existing publisher or (if the publisher is not yet created) to create a new publisher in the same (nested) form (or at least without leaving the page).</p>\n\n<p>Is there a way to do this in active_admin?</p>\n\n<p>Here's what we have so far (in admin/app.rb):</p>\n\n<pre><code>form :html =&gt; { :enctype =&gt; \"multipart/form-data\" } do |f|\n  f.inputs do\n    f.input :title\n    ...\n  end\n\n  f.inputs do\n    f.semantic_fields_for :publisher do |p| # this is for has_many assocs, right?\n      p.input :name\n    end\n  end\n\n  f.buttons\nend\n</code></pre>\n\n<p>After hours of searching, I'd appreciate any hint... Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13107076,"title":"Rails, attribute confirmation","body":"<p>I don't like how Rails confirmation validations attach the message \"doesn't match confirmation\" to the parent attribute...</p>\n\n<pre><code>validates(:password, {confirmation: true})\n</code></pre>\n\n<p>It makes more sense from a UX standpoint that an error should be passed to the confirmation, \"does not match password\", when the two don't match.</p>\n\n<p>Adding any validations to a confirmation attribute seem to be ignored...</p>\n\n<pre><code>validates(:password_confirmation, {my_validation: true, length: {maximum: 3}})\n</code></pre>\n\n<p>**<code>length</code> validation is just for testing purposes. Note that there's no error on the Password Confirmation field in this screenshot:</p>\n\n<p><img src=\"http://i.stack.imgur.com/e7sio.png\" alt=\"form screenshot\"></p>\n\n<p>I created a custom validation, <code>better_validation</code>:</p>\n\n<pre><code>class BetterConfirmationValidator &lt; ActiveModel::EachValidator\n  def validate_each(record, attr_name, value)\n    parent_attr = attr_name.to_s\n    parent_attr['_confirmation'] = ''\n    unless value == record.send(parent_attr)\n      record.errors.add(attr_name, :better_confirmation, options.merge(:value =&gt; value))\n    end\n  end\nend\n</code></pre>\n\n<p>But it doesn't work unless I name the confirmation field something different (i.e. add an 's' on the end...<code>:password_confirmations</code>).</p>\n\n<p>Is there a way to tell Rails not to take over and let me apply validations to <code>foo_confirmation</code> attributes?</p>\n\n<p>Thanks!</p>\n\n<h2>Edit</h2>\n\n<p>Model code...</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :name, :email, :password, :password_confirmation\n  attr_accessor :password, :password_confirmation\n\n  validates :name,\n    presence: true,\n    length: { maximum: 50 }\n  validates :email,\n    presence: true,\n    format: { with: /\\A.+@[a-z\\d\\-.]+\\z/i },\n    uniqueness: true\n  validates :password,\n    length: { minimum: 6, maximum: 255 },\n    presence: { on: :create }\n  validates :password_confirmation,\n    presence: true,\n    better_confirmation: true\n.\n.\n.\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","memcached"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13186003,"title":"Does the CacheStore session store use memcached if that is my cache store?","body":"<p>What a question, eh?</p>\n\n<p>If you read this article: <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#session\" rel=\"nofollow\">http://guides.rubyonrails.org/action_controller_overview.html#session</a></p>\n\n<p>...you will see it suggest using 'ActionDispatch::Session::CacheStore' instead of '...MemCacheStore'</p>\n\n<p>So, my question is, if memcached is my cache store, and I set my session store to 'CacheStore', will my session data be available to multiple rails/app instances via memcached?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":441,"score":1,"question_id":5207521,"title":"Ruby/Rails Parsing Emails","body":"<p>I'm currently using the following to parse emails:</p>\n\n<pre><code>  def parse_emails(emails)\n    valid_emails, invalid_emails = [], []\n    unless emails.nil?\n      emails.split(/, ?/).each do |full_email|\n        unless full_email.blank?\n          if full_email.index(/\\&lt;.+\\&gt;/)\n            email = full_email.match(/\\&lt;.*\\&gt;/)[0].gsub(/[\\&lt;\\&gt;]/, \"\").strip\n          else\n            email = full_email.strip\n          end\n          email = email.delete(\"&lt;\").delete(\"&gt;\")\n          email_address = EmailVeracity::Address.new(email)\n          if email_address.valid?\n            valid_emails &lt;&lt; email \n          else\n            invalid_emails &lt;&lt; email\n          end\n        end\n      end                    \n    end\n    return valid_emails, invalid_emails\n  end\n</code></pre>\n\n<p>The problem I'm having is given an email like:</p>\n\n<pre><code>Bob Smith &lt;bob@smith.com&gt;\n</code></pre>\n\n<p>The code above is delete Bob Smith and only returning bob@smith.</p>\n\n<p>But what I want is an hash of FNAME, LNAME, EMAIL. Where fname and lname are optional but email is not.</p>\n\n<p>What type of ruby object would I use for that and how would I create such a record in the code above?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","rspec","controller"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13185552,"title":"How do I test a controller with rspec-rails?","body":"<p>I want to test that my edit recipe page renders using rspec, though it doesn’t route to </p>\n\n<pre><code>    recipes/edit\n</code></pre>\n\n<p>it routes to recipes/id/edit (id being replaced with a number)</p>\n\n<p>my current test looks like this</p>\n\n<pre><code> describe \"Show Edit Recipe Page\" do\n\n  it \"should display edit recipe  page\" do\n    get :edit\n    response.should be_success\n    response.should render_template(:edit)\n  end\nend\n</code></pre>\n\n<p>how can i test this page correctly, at the moment my tests are failing</p>\n"},{"tags":["ruby-on-rails-3","rake","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":175,"score":1,"question_id":12313612,"title":"rake assets:precompile undefined method `[]' for nil:NilClass","body":"<p>I'm trying to get a new production server up and running and it is so close. When I execute</p>\n\n<pre><code>RAILS_ENV=production rake assets:precompile\n</code></pre>\n\n<p>This error is returned</p>\n\n<pre><code>undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>When I run it with a --trace, this is retuned</p>\n\n<pre><code>$RAILS_ENV=production rake assets:precompile --trace\n** Invoke assets:precompile (first_time)\n** Execute assets:precompile\nrake aborted!\nundefined method `[]' for nil:NilClass\n  (in /home/deploy/pm/app/assets/stylesheets/jquery-ui-1.8.16.custom.css.scss)\n\nTasks: TOP =&gt; assets:precompile\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>I appreciated any help anyone can offer, ideas, etc.</p>\n\n<p>Here is the Gemfile and bundle list</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'cancan'\ngem 'client_side_validations'\ngem 'devise', '~&gt; 1.5.3'\ngem 'execjs'\ngem 'haml'\ngem 'httparty'\ngem 'jquery-rails'\ngem 'mysql2'\ngem 'paperclip', \"~&gt; 2.4\"\ngem 'rails', '3.1.0'\ngem 'rails3-jquery-autocomplete'\ngem 'rake', '0.9.2'\ngem 'remotipart', \"~&gt; 1.0\"\ngem 'simple_datatables'\ngem 'therubyracer'\ngem 'validates_timeliness', '~&gt; 3.0.2'\ngem 'will_paginate', '~&gt; 3.0'\n\ngem 'geocoder', '~&gt; 1.1.2'\n\n#temp for pm.onlinetherapy.com\ngem 'faker'\n\ngroup :test do\n    gem 'capybara'\n    gem 'cucumber-rails', :require =&gt; false\n    gem 'database_cleaner'\n    gem 'factory_girl_rails'\n    gem 'faker'\n    gem 'guard-rspec'\n    gem 'selenium-webdriver', '2.7.0'\n    gem 'webrat'\nend\ngroup :development, :test do\n    gem 'faker'\n    gem 'haml-rails'\n    gem 'hpricot'\n    gem 'rspec-rails'\n    gem 'ruby_parser'\n    gem 'web-app-theme', '~&gt; 0.8.0'\nend\n\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n    gem 'sprockets'\n    gem 'sass', '3.1.20'\n    gem 'sass-rails', '3.1.4' # downgraded to 3.1.4 to avoid a stack overflow error in rake assets:precompile\n    gem 'coffee-rails', \"~&gt; 3.1.0\"\n    gem 'uglifier'\nend\n\n# Use unicorn as the web server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n# gem 'capistrano'\n\n# To use debugger\n# bundle install has a problem installing linecache19, a dependency of ruby-debug19\n# try 'sudo gem install linecache19' to fix the problem, and then do bundle install again \ngem 'ruby-debug19', :require =&gt; 'ruby-debug'\n</code></pre>\n\n<p>And the <code>bundle list</code> gives</p>\n\n<pre><code>Gems included by the bundle:\n  * actionmailer (3.1.0)\n  * actionpack (3.1.0)\n  * activemodel (3.1.0)\n  * activerecord (3.1.0)\n  * activeresource (3.1.0)\n  * activesupport (3.1.0)\n  * archive-tar-minitar (0.5.2)\n  * arel (2.2.3)\n  * bcrypt-ruby (3.0.1)\n  * builder (3.0.2)\n  * bundler (1.2.0)\n  * cancan (1.6.8)\n  * capybara (1.1.2)\n  * childprocess (0.3.5)\n  * client_side_validations (3.1.4)\n  * cocaine (0.3.0)\n  * coffee-rails (3.1.1)\n  * coffee-script (2.2.0)\n  * coffee-script-source (1.3.3)\n  * columnize (0.3.6)\n  * cucumber (1.2.1)\n  * cucumber-rails (1.3.0)\n  * database_cleaner (0.8.0)\n  * devise (1.5.3)\n  * diff-lcs (1.1.3)\n  * erubis (2.7.0)\n  * execjs (1.4.0)\n  * factory_girl (4.0.0)\n  * factory_girl_rails (4.0.0)\n  * faker (1.0.1)\n  * ffi (1.1.5)\n  * geocoder (1.1.3)\n  * gherkin (2.11.2)\n  * guard (1.3.2)\n  * guard-rspec (1.2.1)\n  * haml (3.1.7)\n  * haml-rails (0.3.4)\n  * hike (1.2.1)\n  * hpricot (0.8.6)\n  * httparty (0.8.3)\n  * i18n (0.6.1)\n  * jquery-rails (2.1.2)\n  * json (1.7.5)\n  * json_pure (1.7.5)\n  * jsonify (0.3.1)\n  * jsonify-rails (0.3.2)\n  * libv8 (3.3.10.4)\n  * linecache19 (0.5.12)\n  * listen (0.5.0)\n  * mail (2.3.3)\n  * meta_search (1.1.3)\n  * mime-types (1.19)\n  * multi_json (1.3.6)\n  * multi_xml (0.5.1)\n  * mysql2 (0.3.11)\n  * nokogiri (1.5.5)\n  * orm_adapter (0.0.7)\n  * paperclip (2.7.0)\n  * polyamorous (0.5.0)\n  * polyglot (0.3.3)\n  * rack (1.3.6)\n  * rack-cache (1.0.3)\n  * rack-mount (0.8.3)\n  * rack-ssl (1.3.2)\n  * rack-test (0.6.1)\n  * rails (3.1.0)\n  * rails3-jquery-autocomplete (1.0.9)\n  * railties (3.1.0)\n  * rake (0.9.2)\n  * rdoc (3.12)\n  * remotipart (1.0.2)\n  * rspec (2.11.0)\n  * rspec-core (2.11.1)\n  * rspec-expectations (2.11.3)\n  * rspec-mocks (2.11.2)\n  * rspec-rails (2.11.0)\n  * ruby-debug-base19 (0.11.25)\n  * ruby-debug19 (0.11.6)\n  * ruby_core_source (0.1.5)\n  * ruby_parser (2.3.1)\n  * rubyzip (0.9.9)\n  * sass (3.1.20)\n  * sass-rails (3.1.4)\n  * selenium-webdriver (2.7.0)\n  * sexp_processor (3.2.0)\n  * simple_datatables (0.2.1)\n  * sprockets (2.0.4)\n  * therubyracer (0.10.2)\n  * thor (0.14.6)\n  * tilt (1.3.3)\n  * timeliness (0.3.6)\n  * treetop (1.4.10)\n  * tzinfo (0.3.33)\n  * uglifier (1.3.0)\n  * validates_timeliness (3.0.14)\n  * warden (1.2.1)\n  * web-app-theme (0.8.0)\n  * webrat (0.7.3)\n  * will_paginate (3.0.3)\n  * xpath (0.1.4)\n</code></pre>\n"},{"tags":["ruby-on-rails-3","sphinx","thinking-sphinx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":11983981,"title":"customising sphinx indexes in order to search on nested attributes","body":"<p>Is there a way in sphinx to define indices in a custom way.\nProblem - I have a product model and multiple admins exists in the system. each admin can take their own notes on every product. hence notes is not a simple text field. Rather, it is a separate model. Product as well as admin has_many notes. When a admin searches the product listing, i want to make sure that he is enabled to search only through his notes.</p>\n\n<p>I understand that sphinx indexes are stored in a document (internal to sphinx). For instance, all the indices of a product \"dell xps\" will be in a single document. It means that all the notes will  be in the same document. If only i have a way to store admin_id and notes of each product into separate sphinx documents, i can acheive my requirement of searching on my notes alone. That is, a dell product will have its indices across 3 documents if 3 people has made notes about it. FYI, Similar feature exists in elastic search. any help is appreciated. Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","forms","partial-views","form-for"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13183506,"title":"rails form partial for new and edit on same page","body":"<p>I am running into issues trying to separate a form from a view into a partial. I want to use the same form for the new and edit views. These are both on the same page. The new model form is at the top of the page and uses a variable that I set in the controller.</p>\n\n<pre><code>&lt;%= form_for @new_hire do |f| %&gt;\n&lt;%= render :partial =&gt; 'new_hire_requests/form', :locals =&gt; {:f =&gt; f} %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I then have a partial for the pending approvals that gets rendered by another partial</p>\n\n<pre><code>&lt;%= render :partial =&gt; 'pending_approval', :collection =&gt; @pending_approval %&gt;\n</code></pre>\n\n<p>And inside the pending approval partial I have this</p>\n\n<pre><code>&lt;%= form_for pending_approval do |f| %&gt;\n&lt;%= render :partial =&gt; 'new_hire_requests/form', :locals =&gt; {:f =&gt; f} %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is throwing an error</p>\n\n<pre><code>undefined method `new_hire_request_path' for #&lt;#&lt;Class:0x0000010488ac98&gt;:0x0000010223ffc0&gt;\n</code></pre>\n\n<p>Is there a way to re use the form code for both a new and edit form on the same page?</p>\n\n<p>Controller Logic</p>\n\n<pre><code>@new_hire = NewHireRequest.new\n@new_hire_requests = current_user.new_hire_requests\n@pending_approval = @new_hire_requests.select{|p| p.status == 'pending_hr_approval' || p.status == 'pending_exec_approval'}\n</code></pre>\n\n<p>Partial code</p>\n\n<pre><code>&lt;%= render 'shared/error_messages', object: f.object %&gt;\n\n&lt;fieldset class=\"first\"&gt;\n&lt;%= f.label :first_name, \"First Name\" %&gt;\n&lt;%= f.text_field :first_name %&gt;\n&lt;/fieldset&gt;\n&lt;fieldset&gt;\n&lt;%= f.label :last_name, \"Last Name\" %&gt;\n&lt;%= f.text_field :last_name %&gt;\n&lt;/fieldset&gt;\n&lt;%= f.submit \"Submit for Approval &lt;i class='icon-share-alt icon-white'&gt;&lt;/i&gt;\", \n        class: \"button_green\" %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13184960,"title":"No route matches :action => edit rails 3","body":"<p>I don’t understand why I am getting the above error message when trying to update a recipe</p>\n\n<p>This is my output of rake routes</p>\n\n<pre><code>      recipes GET    /recipes(.:format)                recipes#index\n              POST   /recipes(.:format)                recipes#create\n   new_recipe GET    /recipes/new(.:format)            recipes#new\n  edit_recipe GET    /recipes/:id/edit(.:format)       recipes#edit\n       recipe GET    /recipes/:id(.:format)            recipes#show\n              PUT    /recipes/:id(.:format)            recipes#update\n              DELETE /recipes/:id(.:format)            recipes#destroy\n         root        /                                 public_pages#index\n</code></pre>\n\n<p>My controller looks like this</p>\n\n<pre><code>def edit\n  @recipe = Recipe.find(params[:id])\nend\n\ndef update\n  @recipe = Recipe.find(params[:id])\n\n  if @recipe.update_attributes(params[:recipe])\n    redirect_to recipes_path, :notice =&gt; \"Successfully updated recipe\"\n  else \n    render :action =&gt; 'edit'\n  end\nend\n</code></pre>\n\n<p>And my link to edit the post</p>\n\n<pre><code>&lt;%= link_to \"Edit Recipe\", edit_recipe_path(@recipe) %&gt;\n</code></pre>\n\n<p>the full error is (this is when trying to access the recipes page</p>\n\n<pre><code>Routing Error\n\nNo route matches {:action=&gt;\"edit\", :controller=&gt;\"recipes\"}\n\nTry running rake routes for more information on available routes. \n</code></pre>\n\n<p>and finally the form i am using, now the only thing I can think of is that there is an issue with my form, though i thought that you could use the same form for new and edit? though i could be totally wrong</p>\n\n<p>Anyone have any ideas</p>\n"},{"tags":["ruby-on-rails-3","postgresql","roles"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":280,"score":2,"question_id":10213164,"title":"how do I set table ownership in rails with postgresql?","body":"<p>I'm very new to rails, so hope this is not a stupid question. </p>\n\n<p>I am trying to make rails use a postgresql database with two different user accounts. I want however to be able to switch between those accounts, so they have the same permissions on the database (without both of them being a postgresql superuser ideally).</p>\n\n<p>I created a <code>NOLOGIN</code> role in postgres, which is the owner of the database. Then assigned two user accounts to this role. However, whenever I do <code>rake db:migrate</code>, it will make the user account (and not the role) the owner of the <strong>table</strong>. If I then switch users, the second user won't have the right permissions on the tables created by the first user.</p>\n\n<p>The reason for having two account is to be able to switch quickly, e.g. when I need to change the password with no downtime.</p>\n\n<p><strong>Is there a way to tell rails to use a specific role as the owner when creating tables?</strong> (or perhaps there's a better way to accomplish this without two accounts in the same postgresql role?)</p>\n\n<p>UPDATE: So far I found <a href=\"http://stackoverflow.com/a/2686185/305019\">this solution</a> to run manually as an external script and change ownership of all tables to the NOLOGIN role, but am hoping for something more elegant or that fits well with rails.</p>\n"},{"tags":["ruby-on-rails-3","subdomain","reddit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13184865,"title":"How can I implement reddit style sub instances of my website?","body":"<p>I have a website that I made using ruby on rails at www.tradespring.net. I want to create a bunch of instances, like www.tradespring.net/electronics, www.tradespring.net/automotive, ect. where these sub-sites work exactly the same as the original but each have their own set of posts, but users are the same across all sub-instances. </p>\n\n<p>Where could I start looking? I don't even know good keywords to google at the moment. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":8848672,"title":"Is it possible to update from an action/method other than the update action/method in Ruby on rails?","body":"<p>Is it possible to update from an action/method other than the update action/method?\nFor example in my users controller I already have an update method for other parts of my users account.</p>\n\n<p>I need a separate one for changing my users password. Is it possible to have something like this:</p>\n\n<pre><code>def another_method_to_update\n  user = User.authenticate(current_user.email, params[:current_password])\n  if user.update_attributes(params[:user])\n    login user\n    format.js   { render :js =&gt; \"window.location = '#{settings_account_path}'\" } \n    flash[:success] = \"Password updated\" \n  else\n    format.js   { render :form_errors }\n\n  end\nend\n</code></pre>\n\n<p>Then have my change password form know to use that method to perform the update?</p>\n\n<p>It has 3 fields:\ncurrent password\nnew password\nconfirm new password</p>\n\n<p>and I use ajax to show the form errors.</p>\n\n<p>Kind regards</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13151876,"title":"Paperclip styles not being created","body":"<p>Paperclip works fine in my rails 3 app, but its only creating one file.  The original file is 1600x1280, and only one file sized to 200 is being created.</p>\n\n<pre><code>  :styles =&gt; { :preview =&gt; \"500x500&gt;\", :full =&gt; \"100%\", :pdf_thumbnail =&gt; [\"200x200&gt;\", :jpg] },\n</code></pre>\n\n<p>The style being created is pdf_thumbnail.  And, for some reason paperclip is not creating an original.</p>\n\n<pre><code> paperclip (3.3.0)\n rails 3.2.8\n heroku, s3\n</code></pre>\n\n<p>Has something changed in 3.3.0?  Anyone know why paperclip is not creating the files?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","associations","activeadmin"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13130809,"title":"Custom Active Admin form inputs for has_and_belongs_to_many relationship","body":"<p>I have a very simple model</p>\n\n<pre><code>class Lifestyle &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_and_belongs_to_many :profiles\nend\n</code></pre>\n\n<p>that has a <code>has_and_belongs_to_many</code> relationship with <code>Profile</code></p>\n\n<pre><code>class Profile &lt; ActiveRecord::Base\n  attr_accessible ...\n\n  belongs_to :occupation\n\n  has_and_belongs_to_many :lifestyles\n  accepts_nested_attributes_for :lifestyles\nend\n</code></pre>\n\n<p>I want to use ActiveAdmin to edit the Profile object, but also assign Lifestyles to a profile. It should be similar to dealing with <code>belongs_to :occupation</code>, as this is sorted out automatically by ActiveAdmin to a dropbox with the options pre-filled with available occupations. </p>\n\n<p>I've tried to use the <code>has_many</code> form builder method, but that only got me to show a form to type in the name of the Lifestyle and on submission, it returned an error.</p>\n\n<pre><code>    f.object.lifestyles.build\n    f.has_many :lifestyles do |l|\n      l.input :name\n    end\n</code></pre>\n\n<p>Error I get:</p>\n\n<pre><code>Can't mass-assign protected attributes: lifestyles_attributes\n</code></pre>\n\n<p><strong>The perfect way for me would be to build several checkboxes</strong>, one for each Lifestyle in the DB. Selected means that the lifestyle is connected to the profile, and unselected means to delete the relation. </p>\n\n<p>I'm having great doubts that this is possible using ActiveAdmin and without having to create very complex logic to deal with this. <strong>I would really appreciate it if you'd give your opinion and advise me if I should go this way or approach it differently.</strong></p>\n"},{"tags":["ruby-on-rails-3","couchdb","couchrest","rails-api"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12822884,"title":"how to use rails-api gem with CouchRest model","body":"<p>I'm trying to set up a rails API using the rails-api gem <a href=\"https://github.com/spastorino/rails-api\" rel=\"nofollow\">rails-api</a> and <a href=\"https://github.com/couchrest/couchrest_model\" rel=\"nofollow\">couchrest model</a>.  Using rails-api strips out a lot of the middleware and modules and I believe that is why I'm getting the following error:</p>\n\n<pre><code>Started GET \"/assets\" for 127.0.0.1 at 2012-10-10 16:00:36 +0100\nConnecting to database specified by database.yml\n\nActiveRecord::ConnectionNotEstablished (ActiveRecord::ConnectionNotEstablished):\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:404:in `retrieve_connection'\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_specification.rb:170:in `retrieve_connection'\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_specification.rb:144:in `connection'\nactiverecord (3.2.8) lib/active_record/query_cache.rb:67:in `rescue in call'\nactiverecord (3.2.8) lib/active_record/query_cache.rb:61:in `call'\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__2405051170962911444__call__2117088860059348020__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.8) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.8) lib/rails/engine.rb:479:in `call'\nrailties (3.2.8) lib/rails/application.rb:223:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n/Users/jason/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'\n/Users/jason/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'\n/Users/jason/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'\n\n\nRendered /Users/jason/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_trace.erb (0.9ms)\nRendered /Users/jason/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.9ms)\nRendered /Users/jason/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (8.1ms)\n</code></pre>\n\n<p>Can anyone point out what modules and middleware I would need to include to get it working?\nThanks</p>\n"},{"tags":["mysql","ruby-on-rails-3","vps"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":353,"score":0,"question_id":10439949,"title":"Error when running rake db:migrate","body":"<p>I'm following the railscast where Ryan sets up a VPS. But I need to install mysql instead of postgresql.</p>\n\n<p>when I run the cap deploy:cold command, it all seems to run fine, until it runs the bundle, which fails when trying to install the mysql2 gem. </p>\n\n<p>so i logged into the server and installed it manually (the database had already been setup).</p>\n\n<p>but when i run the rake db:migrate command I keep getting this error:</p>\n\n<pre><code>rake aborted!\ndatabase configuration does not specify adapter\n\nTasks: TOP =&gt; db:migrate =&gt; db:load_config\n</code></pre>\n\n<p>in the database.yml file i have the following</p>\n\n<pre><code>production:\n  adapter: mysql2\n  encoding: utf8\n  reconnect: false\n  database: blog_production\n  pool: 5\n  username: blog\n  password: *****\n  host: localhost\n  socket: /var/run/mysqld/mysqld.sock\n</code></pre>\n\n<p>I've edited the socket from default, added and removed the host line, and installed the gem manually, but nothing seems to make it work!</p>\n"},{"tags":["ruby-on-rails-3","json","backbone.js","kendo-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13165999,"title":"Best way to get data from Rails 3 to Kendo UI","body":"<p>What is the best way to get data from Rails 3 to some of Kendo UI's data intensive widgets (mostly grid and graphs)?</p>\n\n<p>Lets say I have a Rails model which has data I want to show in Kendo's grid.  I imagine I will be passing that data via json.  But there seems to be many approaches to passing json data (gon, backbone.js,etc).  There is also the rails api approach (but I need the full rails for the other pages).</p>\n\n<p>I was about to sit down and learn backbone.js.  Is this a good approach?</p>\n\n<p>Thank You</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13184339,"title":"Issues with jQuery UI autocomplete when form added with Javascript","body":"<p>I can't seem to get autocomplete working with forms that I'm adding to the screen with javascript. For example, I am using my new route to render my object's form. Inside my new.js.erb in rails file I have the following:</p>\n\n<pre><code>$(\"div#container\").hide().html(\"&lt;%= escape_javascript render 'form' %&gt;\").fadeIn();\n</code></pre>\n\n<p>Once rendered, if I type into my input element:</p>\n\n<pre><code>&lt;input id=\"object_name\" name=\"object[name]\" placeholder=\"Name\" size=\"30\" type=\"text\"&gt;\n</code></pre>\n\n<p>And listen with it with javascript:</p>\n\n<pre><code>jQuery -&gt;\n  $('input#object_name').autocomplete\n    source: ['Test', 'Testing', 'Test 234']\n</code></pre>\n\n<p>I get nothing as far as autocomplete is concerned. If I copy and paste this form though and have it on the screen at load (and not added dynamically with my rails new path) it will work fine. How do I get autocomplete to listen to things that are added dynamically?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13183454,"title":"Loop and generate table cells","body":"<pre><code>I have a table that looks like the following: \n\n&lt;table class = \"rota\"&gt;\n    &lt;thead&gt;\n        &lt;th&gt;Date&lt;/th&gt; \n        &lt;% @hospitals.each do |hosp| %&gt;\n        &lt;th&gt;&lt;%= hosp.name%&gt;&lt;/th&gt;\n        &lt;% end %&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;%- if @rota_days.blank? %&gt;\n        &lt;tr&gt;\n            &lt;td colspan=\"&lt;%= @hospitals.count %&gt;\"&gt;No rota day&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;% end -%&gt;\n        &lt;% @dates.each do |date| %&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;%= date.inspect %&gt;&lt;/td&gt;\n\n            &lt;% end %&gt;\n        &lt;/tr&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Which outputs the following: <a href=\"http://i.imgur.com/KseiT.png\" rel=\"nofollow\">Imgur</a></p>\n\n<p>I am trying to generate blank rows that contain empty cells. I cannot seem to identify where I am going wrong. What is the best possible solution </p>\n\n<p>Updated version </p>\n\n<pre><code>&lt;table class = \"rota\"&gt;\n    &lt;thead&gt;\n        &lt;th&gt;Date&lt;/th&gt; \n        &lt;% @hospitals.each do |hosp| %&gt;\n        &lt;th&gt;&lt;%= hosp.name%&gt;&lt;/th&gt;\n        &lt;% end %&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;%- if @rota_days.blank? %&gt;\n        &lt;tr&gt;\n            &lt;td colspan=\"&lt;%= @hospitals.count %&gt;\"&gt;No rota day&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;% end -%&gt;\n        &lt;% @dates.each do |date| %&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;%= date.inspect %&gt;&lt;/td&gt;\n            &lt;% (1..@hospitals.count).each do %&gt; \n                &lt;td&gt;&lt;/td&gt; \n            &lt;% end %&gt; \n           &lt;/tr&gt; \n            &lt;% end %&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13183769,"title":"rails custom rest route with parameter","body":"<p>I have a questions controller and an associated model and a number of rest routes.  Here is how it's set up in routes.rb:</p>\n\n<pre><code>resources :questions \n</code></pre>\n\n<p>I want to add a custom route that has the format /questions/widget/ID (where ID is the id of the question for which I want to generate a widget).  I want this to be processed by the \"widget\" action in my questions controller.  I've tried a number of things such as:</p>\n\n<pre><code>resources :questions  do\n   member do\n      get 'widget/:id'\n   end\nend\n</code></pre>\n\n<p>But nothing is working.  I'm sure I'm missing something simple.  Any ideas?  Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13180317,"title":"Rails 3 - Marking dependent items archived when parent is archived","body":"<p>I'm not sure the title really explains correctly what i'm trying to do so forgive me. I have a table called clients for an invoicing system i've built.  I also have tables called projects and invoices.</p>\n\n<p>Here's an example (not the actual columns in the tables, just for an example) of my database structure.</p>\n\n<pre><code>Clients\n    id\n    name\n    description\n    archive\n\nProjects\n    id\n    client_id\n    name\n    description\n    archive\n\nProjects\n    id\n    client_id\n    project_id\n    name\n    description\n    archive\n</code></pre>\n\n<p>I have created the ability to archive a given invoice, project, or client independently.  However, i wanted to see what the best way to do this would be if i wanted to have say the projects and invoices for a client to be automatically marked as archived when i archive the client.  My process would be this:</p>\n\n<ul>\n<li>Archiving a client would archive the client, all projects with that client id, and all invoices with that same client id.</li>\n<li>Archiving a project would archive the project and all invoices with that project id.</li>\n<li>Archiving an invoice just archives the invoice itself</li>\n</ul>\n\n<p>NOTE: by \"archived\" i mean the archive bit gets flipped to 1 instead of 0 (not archived / active).</p>\n\n<p><strong>By the way</strong>, the way that you archive something is on the edit screen there is an \"Archive?\" checkbox that you would check off to archive the item.</p>\n\n<p>I know that in my edit action in my controller i can just say something like <code>if archive == 1</code> then run additional sql update statements to update dependent items <code>else @object.save</code> to just save the data for the edited item.</p>\n\n<h1>My question?</h1>\n\n<p>Is there a better way to do this? Is the way i mentioned generally the best practice? I am already using <code>:dependent =&gt; :destroy</code> elsewhere in the model to delete rows in associated tables when a \"parent\" item is deleted.  Is there something pre-built in to Rails that will allow me to mark things like i am trying to do through the relationships of the tables?</p>\n\n<p>Thanks for any help with this!  Hope i explained the problem and question well enough, but let me know if you have questions.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","capistrano","phusion-passenger"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13183541,"title":"How to get Rails 3 to run in production mode on server w/ Passenger","body":"<p>Hi I'm running Passenger/mySQL/mongo/Rails 3.2 with a Capistrano deploy script.</p>\n\n<p>I'm trying to get my app to run in production mode on my linux server.</p>\n\n<p>In my apache config file i have the following...</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n ServerName example.com\n ServerAlias www.example.com\n DocumentRoot /srv/www/example.com/current/public\n ErrorLog /srv/www/example.com/current/log/error.log\n CustomLog /srv/www/example.com/current/log/access.log combined\n PassengerDefaultUser www-data\n  &lt;Directory /srv/www/test.example.com/current/public&gt;\n     AllowOverride all\n     Options -MultiViews\n  &lt;/Directory&gt;\n RailsEnv production\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>In my environment.rb file I have the following...</p>\n\n<pre><code>RAILS_ENV=\"production\"\nRAILS_ENV.freeze\n</code></pre>\n\n<p>In my Capistrano deploy.rb I have the following...</p>\n\n<pre><code>set :rails_env, \"production\"\n</code></pre>\n\n<p>But when I deploy via capistrano on my homepage view I have the following line...</p>\n\n<pre><code>Running in &lt;%= Rails.env %&gt; mode\n</code></pre>\n\n<p>And it outputs \"Running in development mode\" when i hit that page after deployment.</p>\n\n<p>Also it is using the development database on my server as well.  What could I be missing to get this to run in production mode?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","architecture","software-engineering","sti"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13183638,"title":"Software Engineering issue: Simple ResumeBank","body":"<p>I would like to create simple ResumeBank app.</p>\n\n<p><strong>Issue</strong>:</p>\n\n<ol>\n<li>As user I would like to add only two Resumes.</li>\n<li>Forms for this both Resumes are different with only two fields.</li>\n</ol>\n\n<p><strong>Question:</strong> </p>\n\n<ol>\n<li>Should I split that Resume model and tables to ex: PolishResume and EnglishResume, polish_remsumes and english_remsumes?</li>\n<li>Or maybe should I use <strong>STI</strong> and create PolishResume &lt; Resume and use one table.</li>\n<li>What are advantages and disadvantages of this two options? </li>\n</ol>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13183539,"title":"Rails 3 with devise undefined method `users_url`","body":"<p>I'm making some small changes to devise in order to overwrite the layout used and some other things so I decided to create my custom routes with controllers. I only added this to the routes so far:</p>\n\n<pre><code>devise_for :users, :controllers =&gt; {\n    :sessions =&gt; \"sessions/user\",\n    :registrations =&gt; \"registrations/user\"\n}\n</code></pre>\n\n<p>which is supposed to load the login page when accessed by <code>/users/sign_in</code> and it does it very well. When I try to ajax post to that url in order to validate the user input and login I get this error: <code>NoMethodError (undefined method 'users_url' for #&lt;Sessions::UserController:0x000000041bed98&gt;):</code></p>\n\n<p>The controller is basic and nothing was changed to overwrote devise logic:</p>\n\n<pre><code>class Sessions::UserController &lt; Devise::SessionsController\n    layout \"login\" # The only addition. Rest is handled by devise\nend\n</code></pre>\n\n<p>I had this working for a good while but today I decided to use devise for another model (admins) and I generated it's files using the devise command <code>rails generate devise Admin</code> which completely messed my working code of logging in the users.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solr","sunspot","sunspot-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13182815,"title":"Solr Search Stripping Phone Number in Database before Comparison","body":"<p>I have a list of restaurants that I want to match with the restaurants in my database using phone number. The problem is that the numbers are formatted differently (i.e. <code>(123)123-1234</code> or <code>123 123-123</code> or other combinations).</p>\n\n<p>My current Solr search looks like this:</p>\n\n<pre><code>search = Restaurant.solr_search do\n  with(:phone, SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\"))\n  paginate page: 1, per_page: 15\nend\n</code></pre>\n\n<p><code>SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\")</code> will strip down my search query to just numbers. However, the values in my database still contain other non-numeric characters and thus, <code>search.hits</code> returns an empty array because I'm not getting any results.</p>\n\n<p>Is there a way to strip my database values (<code>:phone</code>) before Solr does a search?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","polymorphic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13181710,"title":"When using polymorphic relationships in rails, I can't use underscores in my has_many attribute name (Rails)","body":"<p>My application uses a polymorhpic relationship like so:</p>\n\n<pre><code>class Child &lt; ActiveRecord:Base\n  belongs_to :child_owner, polymorphic: true\nend\n\nclass Parent &lt; ActiveRecord:Base\n  has_many :children, as: :child_owner, dependent: :destroy\nend\n</code></pre>\n\n<p>This setup works fine. However, when I change the attribute name of <code>:children</code> to a multiword variable like <code>:kids_of_parent</code>, I get an unintialized constant exception (for Parent::KidsOfParent). In my case, the multiword variable would be much more descriptive. What am I doing wrong? Can someone at least confirm this behaviour?</p>\n\n<p>Thanks,</p>\n\n<p>Chris</p>\n\n<p>Using Rails 3.2.8 with ruby 1.9.3</p>\n"},{"tags":["ruby","ruby-on-rails-3","dojo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13179556,"title":"Dojo BorderContainer widget won't render","body":"<p>I've created a layout with Maqetta. Now I want to add the logic to the layout. Therefore I have downloaded the whole workspace from Maqetta and imported the files/libaries into a new Rails project. At first I had some problems, that Rails didn't loaded the dojo,js file, but I've solved that problem.<br>\nNow I have another problem. The page won't render. I've commented everything out except one widget (a button) and this works fine. But if I undo this, nothing happens. Unfortunately I also don't get any warnings/errors or anything like that from dojo.<br>\nAfter a little bit trying, I changed the parseOnLoad property and now I get a warning:</p>\n\n<blockquote>\n  <p>Unhandled Error: Tried to register widget with id==appLayout but that id is already registered  </p>\n</blockquote>\n\n<p>Here is the include tag:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"lib/dojo/dojo/dojo\", :'data-dojo-config' =&gt; \"'async':true,\n        'packages':[{'name':'maqetta','location':'../../maqetta'},{'name':'gridx','location':'../gridx'},{'name':'clipart','location':'../../clipart'},{'name':'shapes','location':'../../shapes'},\n        {'name':'maqettaSamples','location':'../../../samples'},{'name':'zazl','location':'../../zazl'},{'name':'widgets','location':'../../custom'}]\" %&gt;\n</code></pre>\n\n<p>Here is the HTML part (I have simplified it, and now I'm just useing the example from the tutorial):</p>\n\n<pre><code>&lt;body class=\"claro\" data-maq-flow-layout=\"true\" data-maq-ws=\"collapse\" id=\"myapp\" data-maq-appstates=\"{}\"&gt;\n\n&lt;input type=\"button\" data-dojo-type=\"dijit.form.Button\" intermediateChanges=\"false\" label=\"Search\" iconClass=\"dijitNoIcon\" onclick=\"alert('hi');\"&gt;&lt;/input&gt;\n&lt;div\nid=\"appLayout\" class=\"demoLayout\"\ndata-dojo-type=\"dijit/layout/BorderContainer\"\ndata-dojo-props=\"design: 'headline'\"&gt;\n    &lt;div\n    class=\"centerPanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'center'\"&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 1 Content&lt;/h4&gt;\n            &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 2 Content&lt;/h4&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 3 Content&lt;/h4&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div\n    class=\"edgePanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'top'\"&gt;Header content (top)&lt;/div&gt;\n    &lt;div\n    id=\"leftCol\" class=\"edgePanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'left', splitter: true\"&gt;Sidebar content (left)&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And here is the parser:</p>\n\n<pre><code>require([\"dojo/parser\",\"dojo/domReady!\"], function(parser){\n     parser.parse();\n});\n</code></pre>\n\n<p>I'm trying for hours now, and I'm still as clueless as at the beginning. Has somebody an idea what I can try?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13180920,"title":"saving on a model with has_many association","body":"<p>Here is my problem, I have three models:</p>\n\n<p>ProductModel</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :photo\n  has_many :votes\n\n  has_attached_file :photo, :styles =&gt; { :medium =&gt; \"300x300\" }\n\n  before_save { |product| product.title = title.titlecase }\n\n  validates :title, presence: true, uniqueness: { case_sensitive: false }\n  validates :photo, :attachment_presence =&gt; true\n\nend\n</code></pre>\n\n<p>UserModel</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    def self.from_omniauth(auth)\n      where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|\n        user.provider = auth.provider\n        user.uid = auth.uid\n        user.name = auth.info.name\n        user.oauth_token = auth.credentials.token\n        user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n        user.save!\n      end\n    end\nend\n</code></pre>\n\n<p>VoteModel</p>\n\n<pre><code>class Vote &lt; ActiveRecord::Base\n  belongs_to :product\n  attr_accessible :user_id\nend\n</code></pre>\n\n<p>Now I need to save on my VoteModel a record with the ProductId and the UserId. But I don't know how to do this, can anyone help me please?</p>\n\n<p>UPDATE</p>\n\n<hr>\n\n<p>here is my vote view</p>\n\n<pre><code>&lt;%= form_for @vote, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n\n    &lt;%= f.label :user_id %&gt;\n    &lt;%= f.text_field :user_id %&gt;\n\n    &lt;%= f.label :product_id %&gt;\n    &lt;%= f.text_field :product_id %&gt;\n\n    &lt;%= f.submit \"Crear Producto\" %&gt;\n&lt;% end %&gt;\n\n&lt;%= link_to 'Cancel', root_path %&gt;\n</code></pre>\n\n<p>and here is the controller </p>\n\n<pre><code>class VotesController &lt; ApplicationController\n\n    def create\n        @some_product = Product.find(params[:id])\n        some_user = current_user\n        vote = Vote.create(:user =&gt; some_user, :production =&gt; some_product)\n        save!\n    end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pdfkit"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":459,"score":0,"question_id":8842284,"title":"Rails 3 and PDFKit, how can I convert an HTML file into a landscape orientation PDF?","body":"<p>I can convert HTML pages into PDF documents well. The problem is, I don't know how to convert the HTML file into a landscape orientation PDF. Is there a way to set that in the controller?</p>\n\n<p>From the controller...</p>\n\n<pre><code>def pdf_customer_shipments\n  @customer = Customer.find(params[:id])\n  @shipments = Shipment.where(\"customer_id = ? AND status = 'Open'\", @customer.id)\n  render :layout =&gt; 'pdf'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hosting","amazon-ec2","amazon-web-services"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":6011088,"title":"Setting up Amazon Webservices for Rails","body":"<p>I've been trying to set up a web server using EC2 on Amazon web services. \nUsing the <code>appstack-nginx-passenger-ree</code> AMI, I tried to set up the server.</p>\n\n<p>I put my ruby files in <code>/opt/sites</code> and I installed <em>passenger</em> and <em>apache2-dev</em> &amp; <em>apace2-mpm-fork</em>.\nI had to set up the apache config file. \nAfterwards what should I do?</p>\n\n<p>How do I set the path file of the ruby files and deploy them?\nHow can I start up the server and be able to look at it?</p>\n"},{"tags":["ruby-on-rails-3","entity-attribute-value"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13181604,"title":"has anyone used \"acts_as_eav_model\" gems","body":"<p>All,\nI got the latest gems \"acts_as_eav_model\" fork (for rails 3.2.x). But it looks like some of the rspec tests are failing. Spent the last week trying to fix them, did manage to fix 3 out of 4, but the last was cannot figure it out.\nSo if anyone has worked on this gem and was able to make it run, please let me know. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","guard","spork","minitest"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13166238,"title":"With Minitest+Guard+Spork, all test suites and support files are being reloaded on each run","body":"<p>I'm running into a problem where everything in my test setup, including Spork's prefork block, is being reloaded and invoked on each run. It is taking 5-8 seconds for a test to fire off after guard picks up a change even though this is a new project so there are minimal tests and I even have an SSD.</p>\n\n<p>Before I realized everything was reloading, I profiled it using the technique described by Jo Liss <a href=\"http://www.opinionatedprogrammer.com/2011/02/profiling-spork-for-faster-start-up-time/\" rel=\"nofollow\">here</a> and I've included those hanging requires but obviously that didn't help since it's all being reloaded anyway. However, that's when I noticed this:</p>\n\n<blockquote>\n  <p>Loaded Suite\n  test,test/controllers,test/controllers/manage,test/factories,test/functional/manage,test/helpers,test/helpers/manage,test/integration,test/models,test/support</p>\n</blockquote>\n\n<p>I'm not seeing why it would reload everything. This is my first attempt at setting up minitest+spork+guard (i should have just gone with rspec, sigh) so I'm hoping it's something stupid. I'm including everything in hopes that someone has run into it or can easily spot what I've missed. Thanks in advance! </p>\n\n<p>My files include:</p>\n\n<blockquote>\n  <p><strong>test_helper.rb</strong></p>\n</blockquote>\n\n<pre><code>require 'spork'\nSpork.prefork do\n  #MiniTest::Rails.override_testunit!\n  ENV[\"RAILS_ENV\"] = \"test\"\n  require File.expand_path('../../config/environment', __FILE__)\n  require 'guard'\n  require 'guard/interactors/readline'\n  require 'guard/ui'\n  require 'guard/interactors/coolline'\n  require 'guard/interactor'\n  require 'guard/dsl'\n  require 'guard/notifiers/rb_notifu'\n  require 'guard/notifier'\n  require 'guard/minitest/notifier'\n  require 'guard/minitest/runners/default_runner'\n  Dir[File.expand_path('test/support/*.rb')].each { |file| require file }\n  require \"mocha\"\n  Spork.trap_method(Rails::Application, :reload_routes!)\n  Spork.trap_method(Rails::Application::RoutesReloader, :reload!)\nend\n</code></pre>\n\n<blockquote>\n  <p><strong>Guardfile</strong></p>\n</blockquote>\n\n<pre><code>guard 'bundler' do\n  watch('Gemfile')\n  # Uncomment next line if Gemfile contain `gemspec' command\n  # watch(/^.+\\.gemspec/)\nend\nguard 'spork', :wait =&gt; 65, :test_unit =&gt; false, :minitest =&gt; true, :minitest_env =&gt; { 'RAILS_ENV' =&gt; 'test' }, :bundler =&gt; true do\n  watch('config/application.rb')\n  watch('config/environment.rb')\n  watch(%r{^config/environments/.+\\.rb$})\n  watch(%r{^config/initializers/.+\\.rb$})\n  watch('Gemfile')\n  watch('Gemfile.lock')\n  watch('test/test_helper.rb') { \"test\" }\nend\n\nguard 'minitest' do\n  watch(%r|^test/test_helper\\.rb|)         { \"test\" }\n  watch(%r|^test/support/(.*)\\.rb|)         { \"test\" }\n  watch(%r{^test/.+_test\\.rb$})\n  watch(%r|^app/models/(.*)\\.rb|)          {|m| [\"test/models/#{m[1]}_test.rb\", \"test/integration/#{m[1]}_test.rb\"] }\n  watch(%r|^app/controllers/(.*)\\.rb|)     {|m| [\"test/controllers/#{m[1]}_test.rb\", \"test/integration/#{m[1]}_test.rb\"] }\n  watch(%r|^app/views/(.*)\\.html|)         {|m| \"test/integration/#{m[1]}_test.rb\" }\n  watch(%r|^app/objects/(.*)\\.rb|)         {|m| \"test/objects/#{m[1]}_object_test.rb\" }\nend\n\nguard 'livereload' do\n  watch(%r{app/.+\\.(erb|haml)})\n  watch(%r{app/helpers/.+\\.rb})\n  watch(%r{(public/|app/assets).+\\.(css|js|html)})\n  watch(%r{(app/assets/.+\\.css)\\.scss}) { |m| m[1] }\n  watch(%r{(app/assets/.+\\.js)\\.coffee}) { |m| m[1] }\n  watch(%r{config/locales/.+\\.yml})\nend\n</code></pre>\n\n<blockquote>\n  <p><strong>support/minitest.rb</strong></p>\n</blockquote>\n\n<pre><code>#require \"minitest/autorun\"\nrequire \"minitest/rails\"\nrequire \"minitest/spec\"\nrequire \"minitest/pride\"\nrequire \"minitest/rails/shoulda\"\nrequire \"minitest/autorun\"\nrequire \"capybara/rails\"\n\nclass RequestSpec &lt; MiniTest::Spec\n  include Rails.application.routes.url_helpers\n  include Capybara::DSL\n  include Rails.application.routes.url_helpers\nend\n\nMiniTest::Spec.register_spec_type /integration$/i, RequestSpec\n#MiniTest::Spec.register_spec_type /object$/, MiniTest::Spec\n\nclass MiniTest::Rails::Controller\n  include Devise::TestHelpers\nend\n</code></pre>\n\n<blockquote>\n  <p><strong>support/turn.rb</strong></p>\n</blockquote>\n\n<pre><code>require 'turn'\nrequire 'turn/autorun'\nrequire 'turn/colorize'\nrequire 'turn/reporter'\nrequire 'turn/reporters/pretty_reporter'\nTurn.config do |c|\n  c.natural = true\n  c.ansi = true\n  c.format = :pretty\nend\n</code></pre>\n\n<blockquote>\n  <p><strong>Gemfile</strong></p>\n</blockquote>\n\n<pre><code>source 'https://rubygems.org'\n\n# core\ngem 'rails', '3.2.8'\ngem 'thin'\n\n\n# infrastructure\ngem 'heroku'\ngem 'foreman', :groups =&gt; [:development, :test]\n\n# application monitoring\ngem 'airbrake'\ngem 'newrelic_rpm'\n\n\n# view engine\ngem 'haml', '&gt;= 3.1.7'\ngem 'haml-rails', '&gt;= 0.3.5'\ngem 'redcarpet' # markdown\n\n\n# data persistence\ngem 'mongoid', '&gt;= 3.0.5'\ngem 'redis'\ngem 'redis-store'\ngem 'redis-rails'\n\n\n# email\ngem 'sendgrid'\ngem 'mailcatcher', :group =&gt; [:development]\n\n\n# authentication and authorization\ngem 'devise', '&gt;= 2.1.2'\ngem 'omniauth', '&gt;= 1.0'\n#gem 'authority'\ngem 'cancan'\ngem 'rolify', '&gt;= 3.2.0'\n\n\n# view helpers\ngem 'bootstrap-generators', '~&gt; 2.1', :group =&gt; [:development]\ngem 'jquery-rails'\ngem 'simple_form', '&gt;= 2.0.2'\ngem 'rails3-jquery-autocomplete'\n\n\n# file attachments\ngem 'rmagick'\ngem 'fog'\ngem 'carrierwave'\ngem 'carrierwave-mongoid', :require =&gt; 'carrierwave/mongoid'\n\n\n# url helpers\ngem 'mongoid_slug'\n\n\n# console tools\ngem 'ansi',             :groups =&gt; [:development, :test]\ngem 'rack-livereload',  :groups =&gt; [:development]\ngem 'pry-rails',        :groups =&gt; [:development]\ngem 'growl',            :groups =&gt; [:development, :test]\ngem 'turn',             :groups =&gt; [:test]\ngem 'awesome_print'\ngem 'progress_bar',     :groups =&gt; [:test]\n\n\n# supporting libraries\ngem 'bson_ext'\ngem 'nokogiri',                  :group =&gt; :test\ngem 'ruby_parser', '&gt;= 2.3.1',   :group =&gt; :test\ngem 'rb-fsevent', '~&gt; 0.9.1',    :group =&gt; :development\n\n\n# assets\ngem 'less-rails',                 :group =&gt; :assets\ngem 'therubyracer', '&gt;= 0.10.2',  :group =&gt; :assets\ngem 'uglifier', '&gt;= 1.0.3',       :group =&gt; :assets\n\n\n# guard\ngem 'guard',                     :group =&gt; :development\ngem 'guard-livereload',          :group =&gt; :development\ngem 'guard-spork',               :group =&gt; :development\ngem 'guard-minitest',            :group =&gt; :development\ngem 'guard-bundler',             :group =&gt; :development\n\n\n# minitest\ngem 'spork-minitest',           :group =&gt; :test\ngem 'minitest-rails',           :group =&gt; :test\ngem 'minitest-rails-shoulda',   :group =&gt; :test,  :git =&gt; 'git://github.com/rawongithub/minitest-rails-shoulda.git' \ngem 'capybara_minitest_spec',   :group =&gt; :test\n\n\n# mocking\ngem 'mocha', :group =&gt; :test\n\n\n# http testing\ngem 'vcr',      :group =&gt; :test\ngem 'webmock',  :group =&gt; :test\n\n\n# factories\ngem 'factory_girl_rails'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13180850,"title":"Rails has_many :through with custom attribute?","body":"<p>I currently have a model for a vehicle, which has a custom method for defining an owner attribute:</p>\n\n<pre><code>def owners\n    @owners = sales.map(&amp;:customer) + quotes.map(&amp;:customer)\n    @owners = @owners.uniq\nend\n</code></pre>\n\n<p>This method seems to work just fine, and returns an array of owners for the vehicle.</p>\n\n<p>I am having a problem, however, when I want to use the <code>owners</code> that this method generates in another model. When I do this on another model:</p>\n\n<pre><code>has_many :owners, :through =&gt; :vehicles\n</code></pre>\n\n<p>This generates the error:</p>\n\n<pre><code>ActiveRecord::HasManyThroughSourceAssociationNotFoundError: Could not find the source association(s) :owner or :owners in model Vehicle.\n</code></pre>\n\n<p>I have tried adding <code>:source => :owners</code> but I get the same error.</p>\n\n<p>I should point out that I do have <code>:owners</code> in attr_accessible.</p>\n\n<p>So, can I do a :through association when owners is defined in a custom method, rather than being a normal variable?</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13163555,"title":"bootstrap css doesn't work","body":"<p>I use gem twitter-bootstrap-rails in my ruby on rails project.\nBut the css class \"icon-white\" doesn't work.\nI can see definiton of \"icon-white\" in gem toolkit.But in chrome dev tools,I can't find it.\nWhy?\nHow to solve? </p>\n\n<pre><code>&lt;h2&gt;Sign in&lt;/h2&gt;\n\n&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; session_path(resource_name)) do |f| %&gt;\n&lt;div&gt;&lt;%= f.label :email %&gt;&lt;br /&gt;\n&lt;%= f.email_field :email %&gt;&lt;/div&gt;\n\n&lt;div&gt;&lt;%= f.label :password %&gt;&lt;br /&gt;\n&lt;div class = \"icon-user icon-white\"&gt;&lt;/div&gt;\n&lt;%= f.password_field :password %&gt;&lt;/div&gt;\n\n&lt;% if devise_mapping.rememberable? -%&gt;\n&lt;div&gt;&lt;%= f.check_box :remember_me %&gt; &lt;%= f.label :remember_me %&gt;&lt;/div&gt;\n&lt;% end -%&gt;\n\n&lt;div&gt;&lt;%= f.submit \"Sign in\" %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;%= render \"devise/shared/links\" %&gt;\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13180710,"title":"Ruby on Rails - How to delegate to polymorphic associations?","body":"<p>Is it possible to use <code>delegate</code> with <code>has_many</code> or <code>has_one</code> association in a polymorphic model? How does that work?</p>\n\n<pre><code>class Generic &lt; ActiveRecord::Base\n    ...\n\n  belongs_to :generable, polymorphic: true\n\n  delegate :file_url, to: :image, allow_nil: true\n  delegate :type_cat, to: :cat, allow_nil: true\nend\n\nclass Image &lt; ActiveRecord::Base\n   ...\n  has_one :generic, as: generable, dependent: :destroy\nend\n\n\nclass Cat &lt; ActiveRecord::Base\n   ...\n  has_one :generic, as: generable, dependent: :destroy\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13171647,"title":"What does changing config.assets.version number do?","body":"<p>What does changing config.assets.version number do?</p>\n\n<p>I understand that the assets expire (as it is written in the comments) but what does it do in the background?</p>\n\n<p>would it delete all the compiled assets? or does it take that version number and uses it somewhere else?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13176037,"title":"undefined method `tripphoto_changed?' for ... Carrierwave","body":"<p>I'm trying to save an image when adding a new Trip via an association. </p>\n\n<p>tripphoto.rb has a <code>belongs_to :trip</code> </p>\n\n<p>and my trip.rb has a <code>has_many :tripphotos</code>. Furthermore the Carrierwave documentation requires a few more things like an uploader and such which I've set up correctly (It worked without the association!). </p>\n\n<p>Along with it I've got <code>mount_uploader :tripphoto, TripphotoUploader</code> in my trip.rb and <code>accepts_nested_attributes_for :tripphotos, allow_destroy: true</code> to get my form working properly as such:</p>\n\n<pre><code>    &lt;%= fields_for :tripphotos do |photo| %&gt;\n      Img &lt;%= photo.file_field :filename %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Nonetheless I get the error <code>undefined method</code>tripphoto_changed?' for #`. A quick Google has no fitting result. Any advice?</p>\n\n<p>P.S here's my Tripphoto table:</p>\n\n<pre><code>class Tripphoto &lt; ActiveRecord::Base {\n    :id =&gt; :integer,\n    :filename =&gt; :string,\n    :trip_id =&gt; :integer,\n    :created_at =&gt; :datetime,\n    :updated_at =&gt; :datetime\n}\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Edit: On request my Codes:</p>\n\n<p>Trip.rb</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :user_id, \n  :triplocations_attributes, :photo, :category_ids, \n  :start_city, :tripphotos, :img_url, :thumb_url, :images,\n  :tags_attributes\n\n  # validates :title, :length =&gt; {:minimum =&gt; 3}\n  # validates :description, :presence =&gt; true\n  # validates_associated :tags\n\n\n  has_many :triplocations, :dependent =&gt; :destroy\n  has_many :tripphotos, :dependent =&gt; :destroy\n\n  has_and_belongs_to_many :categories\n  has_and_belongs_to_many :tags\n\n\n  accepts_nested_attributes_for :triplocations, allow_destroy: true\n  accepts_nested_attributes_for :tripphotos, allow_destroy: true\n  accepts_nested_attributes_for :categories\n  accepts_nested_attributes_for :tags\n\n\n  mount_uploader :tripphoto, TripphotoUploader\nend\n</code></pre>\n\n<p>Tripphoto.rb</p>\n\n<pre><code>class Tripphoto &lt; ActiveRecord::Base\n  attr_accessible :filename, :trip_id\n  belongs_to :trip\nend\n</code></pre>\n\n<p>The complete trip form</p>\n\n<pre><code>&lt;%= form_for @trip, :html =&gt; {:multipart =&gt; true} do |a| %&gt; \n    &lt;%= a.label :title, \"Routetitel\" %&gt;\n    &lt;%= a.text_field :title %&gt;\n\n    &lt;%= a.label :description, \"Omschrijving\" %&gt;\n    &lt;%= a.text_area :description %&gt;\n\n    &lt;%= a.label :start_city, \"Stad\" %&gt;\n    &lt;%= a.text_field :start_city, :id =&gt; \"cityName\" %&gt;\n\n    &lt;% for category in Category.find(:all) %&gt;\n        &lt;div&gt;\n          &lt;%= check_box_tag \"trip[category_ids][]\", category.id, @trip.categories.include?(category) %&gt;\n          &lt;%= category.name %&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n    &lt;%= a.fields_for :tags do |f| %&gt;\n        &lt;p&gt;\n            &lt;%= f.label :title, 'Steekwoorden:' %&gt;\n            &lt;%= f.text_field :title %&gt;\n        &lt;/p&gt; \n        &lt;div id=\"inputFields\"&gt;&lt;/div&gt;\n\n    &lt;% end %&gt;\n    &lt;div style=\"background: red;\"&gt;\n        &lt;%= fields_for :tripphotos do |photo| %&gt;\n          Img &lt;%= photo.file_field :filename %&gt;\n        &lt;% end %&gt;\n    &lt;/div&gt;\n\n\n    &lt;%= a.submit 'Verstuur' %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13179695,"title":"Rails TextHelper \"highlight\" method for case-insensitive search","body":"<p>I am using Rails TextHelper \"highlight\" method for highlighting a search string.</p>\n\n<pre><code>&lt;%= simple_format highlight(\"Some test text\", \"some\") %&gt;\n</code></pre>\n\n<p>However, it seems to be case-sensitive. Is there a case-insensitive version of this function? Or maybe some option i'm missing?</p>\n"},{"tags":["ruby-on-rails-3","devise","routes","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13145622,"title":"Setting Devise omniauth_path_prefix doesn't work","body":"<p>I'm working on a Rails-based API. I recently started attempting to version it. (I'm using the <a href=\"https://github.com/bploetz/versionist\" rel=\"nofollow\">Versionist</a> gem, in case it matters) One version ('v2') uses Devise and Omniauth to authenticate users through Facebook/Twitter.</p>\n\n<p>I want all the routes associated with this version to have the appropriate version prefix (so <code>users/:username/foo</code> becomes <code>v2/users/:username/foo</code>, etc.), but I've already found out that putting <code>devise_for</code> inside the <code>api_version</code> block prevents the Devise helpers (<code>current_user</code>, <code>user_signed_in?</code>, etc.) from working, so it continues to live outside the block:</p>\n\n<p>routes.rb:</p>\n\n<pre><code>devise_for :user, :path =&gt; '', :controllers =&gt; {:omniauth_callbacks =&gt; 'users/omniauth_callbacks'}, :skip =&gt; [:registrations, :confirmations, :sessions, :passwords]\n\napi_version(:module =&gt; \"V2\", :path=&gt;\"v2\") do\n\n  resources :authentications, :only =&gt; [:update, :destroy]\n\n  devise_scope :user do\n    post 'login' =&gt; 'sessions#create', :as =&gt; 'user_session'\n    get 'logout' =&gt; 'sessions#destroy'\n    post 'password' =&gt; 'devise/passwords#create'\n    put 'password' =&gt; 'devise/passwords#update'\n  end\n\nend\n</code></pre>\n\n<p>Everything seemed great... except the Devise-generated omniauth routes:</p>\n\n<p>rake routes output:</p>\n\n<pre><code> user_omniauth_authorize      /auth/:provider(.:format)\n user_omniauth_callback       /auth/:action/callback(.:format)\n</code></pre>\n\n<p>Now, some google-fu revealed that there's a devise configuration setting for this, so I added the following to our devise initializer (<code>config/initializers/devise.rb</code>):</p>\n\n<pre><code>Devise.setup do |config|\n  config.omniauth_path_prefix = 'v2/auth'\nend\n</code></pre>\n\n<p>Now, rake routes produces paths that look sensible:</p>\n\n<pre><code>user_omniauth_authorize     /v2/auth/:provider(.:format)          v2/users/omniauth_callbacks#passthru {:provider=&gt;/(?!)/}\nuser_omniauth_callback      /v2/auth/:action/callback(.:format)          v2/users/omniauth_callbacks#(?-mix:(?!))\n</code></pre>\n\n<p>However, when I attempt to access this route by calling <code>api.localhost/v2/auth/facebook</code>, I get a routing error:</p>\n\n<pre><code>ActionController::RoutingError (No route matches [GET] \"/v2/auth/facebook\")\n</code></pre>\n\n<p>Any idea what's going on here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","declarative-authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13148125,"title":"if_attribute doesn't work with multiple hash on declarative_authorization","body":"<p>I use declarative_authorization on Ruby on rails 3.1.</p>\n\n<p>A group has many albums (groupalbum), a group is create by one user (user_id in foreign key for group table).\nOnly the owner of the group can create albums.</p>\n\n<p>Here is my authorization_rules.rb :</p>\n\n<pre><code>has_permission_on [:group_albums], :to =&gt; [:create] do\n    if_attribute :group =&gt;  { :user =&gt; is_in { user.groups } }\nend\n</code></pre>\n\n<p>Here is my GroupAlbumsControler :</p>\n\n<pre><code>class GroupAlbumsController &lt; ApplicationController\n    before_filter :set_group_album_from_params, :only =&gt; :show\n    before_filter :set_group_album_new, :only =&gt; [:index, :new]\n    filter_access_to :all, :attribute_check =&gt; true\n    (...)\nend\n</code></pre>\n\n<p>But it doesn't work :</p>\n\n<pre><code>You are not allowed to access this action.\n</code></pre>\n\n<p>Even if I'm logged in with the owner of the group.</p>\n\n<p>Where is my mistake ?</p>\n"},{"tags":["ruby-on-rails-3","robots.txt"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13155503,"title":"Prevent Search Spiders from accessing a Rails 3 nested resource with robots.txt","body":"<p>I'm trying to prevent Google, Yahoo et al from hitting my /products/ID/purchase page and am unsure on how to do it.</p>\n\n<p>I currently block them from hitting sign in with the following:</p>\n\n<pre><code>User-agent: *\nDisallow: /sign_in\n</code></pre>\n\n<p>Can I do something like the following?</p>\n\n<pre><code>User-agent: *\nDisallow: /products/*/purchase\n</code></pre>\n\n<p>Or should it be:</p>\n\n<pre><code>User-agent: *\nDisallow: /purchase\n</code></pre>\n"},{"tags":["ruby-on-rails","deployment","ruby-on-rails-3","dreamhost"],"answer_count":8,"favorite_count":8,"up_vote_count":18,"down_vote_count":1,"view_count":7040,"score":17,"question_id":2250247,"title":"Rails 3 on dreamhost?","body":"<p>I'd like to deploy a small Rails 3 app on dreamhost (just for testing purposes, nothing serious) and I am wondering if anyone has done it already... Please choose one of the following:</p>\n\n<ol>\n<li>I did it and it's super easy, here's how: ...</li>\n<li>Though I didn't try it, it should be easy, here's how: ...</li>\n<li>It's quite complicated, but this should get you started: ....</li>\n<li>NO WAI!!!1!one!1 Set it up on slicehost or another non-shared hosting or you'll die a painful death trying to force it on DH</li>\n</ol>\n\n<p>Thoughts?</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13168131,"title":"Save array of ActiveRecord objects?","body":"<p>In my view I do:</p>\n\n<pre><code>&lt;table border=\"1\"&gt;\n &lt;tr&gt;\n    &lt;th&gt;Question&lt;/th&gt;\n    &lt;th&gt;Counter&lt;/th&gt;\n    &lt;th&gt;Lastsent&lt;/th&gt;\n    &lt;th&gt;Email&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;% @email_stats.each do |email_stat| %&gt;\n&lt;% post = Post.find(email_stat.postId) %&gt;\n  &lt;% if post.posttype == 'Question' %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= post.question %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%=  email_stat.counter%&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= email_stat.lastsent %&gt;&lt;/t&gt;\n    &lt;td&gt;&lt;%=  text_field_tag 'email', email_stat.email%&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;%  end %&gt;\n &lt;/table&gt;\n</code></pre>\n\n<p>This is what I have: For some objects, the email will be \"blank\" so I want to display all the records in the table  and allow the moderator to enter an email and on click on save store it.</p>\n\n<p>I used <code>form_for</code> but it's used to save only a single object.</p>\n\n<p>What is the best way to send an array back to the server for saving?</p>\n"},{"tags":["ruby-on-rails-3","seo","mongoid3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13177361,"title":"rails mongoid3 and SEO URLs","body":"<p>is there a good way to make \"friendly_ids\" for the mongoid3 gem?</p>\n\n<p><em>slugoid</em>  seems deprecated and <em>KEY</em> is not part of mongoid3 anymore.</p>\n\n<p>Any answer will be very helpful</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13178412,"title":"Using and in active record query","body":"<p>Is is allowed to use AND condition in active record? FOr example</p>\n\n<pre><code>Model.where(a&gt;b AND c&gt;d).all\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1088,"score":2,"question_id":4934194,"title":"\"Resulttype(#-614051528) expected, got String(#-608366078)\" with Many-to-Many association","body":"<p>Currently I'm creating something like a \"sports-managing-and-results-gathering-app\" in Rails 3. In this App I need to create several exercises which itself can have multiple 'resulttypes' (heartrate, distance in km, repititions, ...). And it should be possible to arrange the resulttypes in my prefered order. So, this is a classical many-to-many relationship.</p>\n\n<p>I came up with the following migrations:</p>\n\n<pre><code>    class CreateExercises &lt; ActiveRecord::Migration\n      def self.up\n        create_table :exercises do |t|\n          t.integer :user_id\n          t.string :name\n          t.text :beschreibung\n          t.integer :resulttype_id\n          t.boolean :active, :default =&gt; true\n          t.timestamps\n        end\n      end\n      def self.down\n        drop_table :exercises\n      end\n    end\n\n    class CreateResulttypes &lt; ActiveRecord::Migration\n      def self.up\n        create_table :resulttypes do |t|\n          t.string :name\n          t.string :einheit\n          t.text :beschreibung\n\n          t.timestamps\n        end\n      end\n\n      def self.down\n        drop_table :resulttypes\n      end\n    end\n\n    class CreateExercisesResulttypesJoin &lt; ActiveRecord::Migration\n      def self.up\n        create_table :exercises_resulttypes, :id =&gt; false do |t|\n          t.integer \"exercise_id\"\n          t.integer \"resulttype_id\"\n        end\n        add_index :exercises_resulttypes, [\"exercise_id\", \"resulttype_id\"]\n      end\n\n      def self.down\n        drop_table :exercises_resulttypes\n      end\n    end\n</code></pre>\n\n<p>which works nicely with this formtastic code:</p>\n\n<pre><code>    &lt;%= semantic_form_for(@exercise) do |f| %&gt;        \n      &lt;%= f.inputs do %&gt;\n        &lt;%= f.input :name %&gt;\n        &lt;%= f.input :beschreibung %&gt;\n        &lt;%= f.input :resulttype %&gt;\n        &lt;%= f.input :active %&gt;\n      &lt;% end %&gt;\n      &lt;%= f.buttons %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>The problem is here, that with this code I can not sort the resulttypes and each exercise can have each resulttype once only.\nSo I changed the formtastic :resulttype form code to this (except the jquery code):</p>\n\n<pre><code>    &lt;div id=\"conn_ctrl\" class=\"float_left center\"&gt;\n            &lt;div class=\"float_left center\"&gt;\n                &lt;%= f.select :resulttypes, @resall.collect{|d| [d.name,d.id]}.sort, {}, { :multiple =&gt; true, :class =&gt; \"conn_select\" } %&gt;&lt;br&gt;\n            &lt;/div&gt;\n            &lt;div class=\"float_left center\"&gt;\n                &lt;%= f.select :resulttypes, '', {}, { :multiple =&gt; true, :id =&gt; \"exercise_resulttypes_save\", :class =&gt; \"conn_select\" } %&gt;&lt;br&gt;\n            &lt;/div&gt;\n            &lt;div style=\"clear: both\"&gt;&lt;/div&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"remove\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"&lt;&lt;\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"add\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"&gt;&gt;\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"up\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"Up\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"down\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"Down\" }, false) %&gt;&lt;br&gt;\n        &lt;/div&gt;\n        &lt;div style=\"clear: both\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Now I have a \"Dual Listbox\" and I can add exercises to this specific workout multiple times and order it how I like it.\nBUT, when I submit the form, I get this error and I have no idea what that means:</p>\n\n<blockquote>\n  <p>Resulttype(#-614051528) expected, got String(#-608366078)</p>\n</blockquote>\n\n<p>The submitted parameters are:</p>\n\n<pre><code>    {\"commit\"=&gt;\"Create Exercise\",\n     \"authenticity_token\"=&gt;\"v1l9zfxdxIJbdjZx6SsZ5tGuKMrlioBg+C9orSmVarA=\",\n     \"utf8\"=&gt;\"✓\",\n     \"exercise\"=&gt;{\"name\"=&gt;\"dddd\",\n     \"beschreibung\"=&gt;\"ddddd\",\n     \"resulttypes\"=&gt;[\"5\",\n     \"3\",\n     \"1\"],\n     \"active\"=&gt;\"1\"}}\n</code></pre>\n\n<p>This currently drives me crazy a little bit. I hope you know why this happens...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","concatenation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13177005,"title":"Rails and Postgreql Concatenate space","body":"<p>I have an search field for user with autocomplete, it was working but I migrated my database from mySQL to Postgresql but cannot get the concatenate working. When I type a first name or a last name is working but when my user are typing Firstname Lastname (with a space between them) it's not working anymore and cannot get it working or figure out what to do.</p>\n\n<p>That's my SQL command : </p>\n\n<pre><code> @users = User.find(:all,:conditions =&gt; ['(last_name LIKE ? OR first_name LIKE ? OR    (first_name || last_name) LIKE ? OR (last_name || first_name) LIKE ?) AND adult = ?', \"%#{params[:term]}%\", \"%#{params[:term]}%\", \"%#{params[:term]}%\", \"%#{params[:term]}%\", false])\n</code></pre>\n\n<p>My issue is here : (first_name || last_name) that will return correct value when the user type FirstNameLastName so the concat works here but when I try to add the space I cannot figure out what is wrong I tried :</p>\n\n<pre><code>(first_name ||' '|| last_name) or (first_name ||\" \"|| last_name)\n</code></pre>\n\n<p>But none of these will work I found another thread on stackoverflow but cannot get it working and I don't understand why...</p>\n\n<p>Thanks,</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","comments","posts"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":777,"score":0,"question_id":7000689,"title":"undefined method `comments' for nil:NilClass","body":"<p>I'm trying to create a way to have users comment on my posts. Currently I have All user posts showing up on my home page and then in the user profile only the current users posts. I would like to have it so that the comments appear only on the posts in the users profile. I tried to add a comment form in the user profile but I got an undefined method `comments' for nil:NilClass error. </p>\n\n<p>My comments_controller looks like </p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def create\n    @post = Post.find(params[:post])\n    @comment = @post.comments.create(params[:comment])\n    redirect_to post_path(@post)\nend\n</code></pre>\n\n<p>I have a partial (_comment_form.html.erb) that I am rendering in the user profile which looks like </p>\n\n<pre><code>&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for ([@post, @post.comments.build]) do |f| %&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :commenter %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :commenter %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :body %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :body %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n   &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My Comment model looks like </p>\n\n<pre><code>class Comment &lt; ActiveRecord::Base\n  belongs_to :post\nend\n</code></pre>\n\n<p>My Post model looks like</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n attr_accessible :content\n\n belongs_to :user\n\n validates :content, :presence =&gt; true\n validates :user_id, :presence =&gt; true\n validates :user, :presence =&gt; true\n validates :title, :presence =&gt; true\n\n has_many :comments\n\n default_scope :order =&gt; 'posts.created_at DESC'\nend\n</code></pre>\n\n<p>My User Profile Looks like show.html.erb</p>\n\n<pre><code>&lt;table class=\"profile\" summary=\"Profile information\"&gt;\n  &lt;tr&gt;\n    &lt;td class=\"main\"&gt;\n    &lt;h1&gt;\n        &lt;%= gravatar_for @user %&gt;\n        &lt;%= @user.name %&gt;\n    &lt;/h1&gt;\n    &lt;% unless @user.posts.empty? %&gt;\n        &lt;table class=\"posts\" summary=\"User posts\"&gt;\n            &lt;%= render @posts %&gt;\n            &lt;%= render 'comments/comment_form' %&gt;\n        &lt;/table&gt;    \n    &lt;% end %&gt;\n    &lt;/td&gt;\n    &lt;td class=\"sidebar round\"&gt;\n  &lt;strong&gt;Name&lt;/strong&gt; &lt;%= @user.name %&gt;&lt;br /&gt;\n  &lt;strong&gt;URL&lt;/strong&gt;  &lt;%= link_to user_path(@user), @user %&gt;&lt;br /&gt;\n  &lt;strong&gt;Tasks&lt;/strong&gt; &lt;%= @user.posts.count %&gt;\n    &lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","relational-database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13176946,"title":"How can I generate this schema with Rails?","body":"<p>I have a schema for a relational database, which I'd like to generate scaffolding for in my Ruby on Rails 3.2.8 project. I've found the documentation pretty confusing though, and my efforts so far have failed, so my question is exactly how I'd go about generating the needed scaffolding/models for the following schema:</p>\n\n<pre><code>USER\nname:string\nemail:string\n-----\nhas_many: posts\n\nTAG\nname:string\n-----\nbelongs_to_and_has_many: series\nbelongs_to_and_has_many: posts\n\nPOST\ntitle:string\nbody:text\n-----\nbelongs_to_and_has_many: tags\nbelongs_to: user\nbelongs_to: category\n\nSERIES\nname:string\nwebsite:string\n-----\nbelongs_to_and_has_many: tags\n\nCATEGORY\nname:string\n-----\nhas_many: posts\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/H93Oz.png\" alt=\"Picture of schema\"></p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13177118,"title":"shrink the form after enter values","body":"<p>I have project and tasks under the projects.have ajax form for task creation.i enter values in task creation partial form.after enter values the partial form should shrink and show the task name alone.because project has more tasks.It keep me to endless scrolling. please can any one give idea.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13176996,"title":"How can I implement a fee-based service in my Rails app?","body":"<p>I have a web app where users will be able to sell their old unused items. What I want to do is collect a fee (commission) for every transaction which occurs in my app when a user sells something. </p>\n\n<p>How could I aim to do this effectively? I.e. Are there any gems which can accomplish this? Note: I'm in the UK so Stripe isn't an option :(</p>\n"},{"tags":["ruby-on-rails-3","performance","redis","ohm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12730716,"title":"redis ohm slow performance","body":"<p>We're scratching our heads the last couple of days trying to understand why some things seem a bit too slow with redis/ohm on our rails project.</p>\n\n<p>The gist of it is that some requests to ohm/redis take around 100-200 ms, which seem rather high considering our high-expectations of blazing-fast performance.</p>\n\n<p>The command we're running looks like:</p>\n\n<p><code>Stats::TermStats.find(term_slug: 'term_slug', user_id: 123).to_a</code></p>\n\n<p>It seems to us that we're not doing anything extremely complex or crazy. Our profiling (using <a href=\"https://github.com/SamSaffron/MiniProfiler/tree/master/Ruby\" rel=\"nofollow\">miniprofiler</a>) of this single command so far revealed the following:</p>\n\n<ul>\n<li>Some of those calls complete within about 2-4 ms (is this ok/good/bad?)</li>\n<li>Some however take 100-200 ms (this definitely feels bad)</li>\n<li>Using <code>slowlog get</code> on the redis-client does not show anything particularly slow on redis. Most of the redis command complete within less than 20 <strong>microseconds</strong> (0.02 ms)</li>\n<li>Using the rails console and running a quick benchmark using the exact same slug/id in a loop, the same behaviour is observed, i.e. a few of those (same) requests seem to take considerably longer than most others</li>\n</ul>\n\n<p>Our redis config is pretty much out-of-the-box with basically no tweaking. During testing the server is not doing much else.</p>\n\n<p>Any suggestions how to improve performance / test what slows down things so much between redis and ohm/rails ??</p>\n"},{"tags":["ruby-on-rails-3","ruby-datamapper"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13175301,"title":"Maintaining Many to Many relation with checkboxes (e.g. checkboxes for each category a post can be in)","body":"<p>We have a table with Categories containing unique categories. And our posts should link to any of these categories. I tried to add checkboxes for selecting the categories in the following manner: </p>\n\n<ol>\n<li>Add the checkboxes containing the categories in a field called \"post[categoriesss][]\", containing as value the <code>:id</code> of the category.</li>\n<li>Update the <code>new</code> and <code>update</code> method to take these these ids and collect the associated Categories with them, and then add each category to the categories attribute through the <code>&lt;&lt;</code> operator as stated in the <a href=\"http://datamapper.org/docs/associations.html\" rel=\"nofollow\">documentation</a>.</li>\n</ol>\n\n<p>We added the code to <code>new</code> and <code>update</code> to be sure not to have to do this in multiple controllers.</p>\n\n<p>However we get the following error:</p>\n\n<blockquote>\n  <p>undefined property or relationship '&lt;&lt;' on Category</p>\n</blockquote>\n\n<p>What are we doing wrong here? Is there another method to achieve our goal? Our code is below.</p>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class Post\n  include DataMapper::Resource  \n\n  property :id,               Serial\n\n  has n, :categories, :through =&gt; Resource\n\n  def self.new(hash={})\n\n\n    if hash.key? :categoriesss\n      hash[:categoriesss].each do |category|\n        categories &lt;&lt; Category.get(category)\n      end\n      hash.delete! :categoriesss\n    end    \n\n    super hash\n  end\n\nend\n\nclass Category\n  include DataMapper::Resource  \n\n  property :id,       Serial\n  property :name,     String,   :required =&gt; true\n\n  has n, :rekenservices, :through =&gt; Resource\nend\n</code></pre>\n\n<pre class=\"lang-html prettyprint-override\"><code>  &lt;% Category.all.each do |category| %&gt;\n    &lt;label&gt;\n      &lt;input type=\"checkbox\" name=\"post[categoriesss][]\" value=\"&lt;%= category.id %&gt;\" /&gt;\n      &lt;%= category.name %&gt;\n    &lt;/label&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p><strong>UPDATE</strong>:\nI now changed the names for the checkbox back to <code>categories</code> and updated the <code>new</code> and <code>update</code> methods to this:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>  def self.new(hash={})\n      if hash.key? :categories\n        hash[:categories].map! {|id| Category.get id}\n      end    \n      super hash\n  end\n\n  def update(hash={})\n    if hash.key? :categories\n      hash[:categories].map! {|id| Category.get id}\n    end    \n    super hash\n  end\n</code></pre>\n\n<p>Adding categories the first time works. When updating checking an extra category works great as well. Unchecking a category however yields an error message:</p>\n\n<blockquote>\n  <p>columns category_id, post_id are not unique</p>\n</blockquote>\n"},{"tags":["ruby-on-rails-3","webpage","activeadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13175802,"title":"Create public access page dynamically","body":"<p>I have a form that the user must fill (in a restricted area), then a public page will be created with the users input (I use active admin).</p>\n\n<ol>\n<li><p>How can I create publics pages dinamically from the form like: www.mysite.com/?page=someId (or something unique)? The page must be accessible ever.\n(note: I can do with \"the normal\" and not automatic mode (with views and layout), but dynamically?) </p></li>\n<li><p>Is a good idea to use as someId something like: \"3858f62230ac3c915f300c664312c63f\" (i.e.  <code>Digest::MD5.hexdigest('someId')</code>) ?</p></li>\n</ol>\n\n<p>The app is developed in RoR.</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13168695,"title":"Ruby method overriding in rails app","body":"<p>I got a few Classes that include the same module, I want to override one of the methods of the module in one place in my code.\nHow to do this?</p>\n\n<p>I tried </p>\n\n<pre><code>module [Module_name]\n  def [method_to_override]\n</code></pre>\n\n<p>and add it to the autoload path of rails but no success</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13174026,"title":"Rails: Card.id has no value","body":"<p>I'm a newbie in RoR, trying to do the \"Pragmatic Agile Web Development\" depot application.\nThe application needs to keep track of all the items added to the cart by the buyer.</p>\n\n<p>Here is the creation of the Cart model:</p>\n\n<pre><code>rails generate scaffold cart\n</code></pre>\n\n<p>And this is the application controller code:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\nprotect_from_forgery\n\nprivate\n  def current_cart\n    Cart.find(session[:cart_id])\n  rescue ActiveRecord::RecordNotFound\n    cart = Cart.create\n    session[:cart_id] = cart.id\n    cart\n  end\nend\n</code></pre>\n\n<p>My questions:</p>\n\n<ol>\n<li>In the \"scaffold\" command I didn't specify any column name for this table, but still the Cart seems to have one column called \"id\". Is the scaffold command auto generate an \"id\" column? </li>\n<li>In this rescue block, a new Cart object is created without setting any value to \"Card.id\". on the next line we assign this \"id\" value to \"session[:cart_id] = cart.id\". what is the value that will be stored?  </li>\n</ol>\n\n<p>Your answers will be appreciated,</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","postgresql","heroku","squeel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13157450,"title":"Request on PostgreSQL with Rails and Squeel","body":"<p>I was advised to create a new question based on my previous one so here it is :</p>\n\n<p>I have on my website a list of product, each user can create his own savings based on these products. So several users can create their own savings based on the same product. So when one user create a saving I add in the database a saving with the user_id and the product_id he refers to. Now, on one page I want to display all the savings from the other users (excluding current_user) but, as many user can create a saving based on the same product I want to display these only once.If several users create a saving based on product X I want it only displayed once,thanks</p>\n\n<p>The saving table has these field :</p>\n\n<p>id\nproduct_id\nuser_id\nprice\nsaved</p>\n\n<p>What I did is what is posted on this question : \n<a href=\"http://stackoverflow.com/questions/13145168/squeel-request-and-heroku-postgres-error-using-group-by-and-order/13149437#comment17896678_13149437\">Squeel request and Heroku, Postgres: Error using GROUP BY and ORDER</a></p>\n\n<p>I cannot get it working properly on heroku (postgres). If anyone can help me writing the query for Rails or for Squeel that would be awesome thanks !</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","markitup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13174858,"title":"Why the content display code html without render it?","body":"<p>I have used <a href=\"http://markitup.jaysalvat.com/\" rel=\"nofollow\">MarkiItUp</a> to build a jquery editor. Now when user type content in textarea with html code, like this:  </p>\n\n<p><code>A new &lt;strong&gt;true&lt;/strong&gt; question</code></p>\n\n<p>When record was saved, it save <code>A new &lt;strong&gt;true&lt;/strong&gt; question</code>. And when it display on page, it also display like content was saved, is <code>A new &lt;strong&gt;true&lt;/strong&gt; question</code> . But i want the content display on web like this: </p>\n\n<p>A new <strong>true</strong> question  </p>\n\n<p>How can i do that?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ckeditor","asset-pipeline","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13162384,"title":"CKeditor failing in Active Admin in production","body":"<p>I have installed the ckeditor gem, and have <a href=\"https://github.com/gregbell/active_admin/wiki/Ckeditor-integration\" rel=\"nofollow\">followed these instructions</a> to get it integrating with Active Admin in Rails 3.2.3</p>\n\n<p>Works a charm in development, but in production it fails. It seems to stutter when trying to load the config.js. </p>\n\n<p>In development, it loads fine annd has the path <code>/assets/ckeditor/config.js?t=C3HA5RM</code>\nIn production it tried and fails to load the path <code>/admin/pages/3/config.js?t=C3HA5RM</code> (page ID is arbitrary)</p>\n\n<p>The site is deployed using Capistrano, and so it theoretically exactly the same in development as it is in production. </p>\n\n<p>How could these paths be incorrect, how might I change them? Could it have something to do with the asset pipeline perhaps? </p>\n"},{"tags":["ruby-on-rails-3","mongoid","nested-forms","mongoid3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13137532,"title":"Mongoid Embeds_many won't save on nested form","body":"<p>I've got an embeds_many association I'm trying to set up which I've done successfully before, but I'm trying to do it all in one nested form and I can't figure it out.</p>\n\n<p>Let's say we have a <code>pocket</code> model:</p>\n\n<pre><code>class Pocket\n    include Mongoid::Document\n    field :title, type: String\n    embeds_many :coins, cascade_callbacks: true\nend\n</code></pre>\n\n<p>and a Coin Model:</p>\n\n<pre><code>class Coin\n    include Mongoid::Document\n    field :name, type: String\n    embedded_in :pocket\nend\n</code></pre>\n\n<p>in my form for the pocket, I'm using:</p>\n\n<pre><code>= f.fields_for @pocket.coins do |coin|\n    = coin.text_field :name\n</code></pre>\n\n<p>My controller is the default scaffolded controller.\nWhen I use the console, it saves fine and I can see the new pocket and coin I've created. But when I try to create or update a coin from the form, the pocket saves but the coin remains unchanged.</p>\n\n<p>What am I missing here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","truncate","rails-console"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13173618,"title":"Truncate table(s) with rails console","body":"<p>I have this testingdatabase which, by now, is stuffed with junk. Now I've done a few Table.destroy_all commands in the rails console which deletes all records and dependencies which is awesome. However; I'd like to truncate everything so the ID's etc. start at 1 again. Is there any way in Rails 3?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13173940,"title":"Adding child to parent in rails","body":"<p>I have a user model and would like to add children to parents through a form when the parent is edited, I am using the Ancestry gem to create a hierarchy (previously asked a similar question <a href=\"http://stackoverflow.com/questions/13142785/form-for-adding-children-using-ancestry-gem\">here</a> but was maybe a bit unclear). I have tried to use virtual attributes to do give the child-to-be-added an attribute, in the user model I have added an new_child to attr_accessor. Now that the parent user is updated I would like to update the child user (adding the parent). I have tried this in the controller but get an undefined method `update_attributes!' for nil:NilClass error, any suggestions for how solve this problem?</p>\n\n<p>user_controller.rb</p>\n\n<pre><code>def update\n   User.find_by_id(@new_child).update_attributes!(parent_id: @user)\n   ...\nend\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>attr_accessible :new_child\nattr_accessor :new_child\n</code></pre>\n\n<p>edit.html.erb</p>\n\n<pre><code>&lt;%= form_for @user do |f| %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.label :new_child, \"Add child (enter child id)\" %&gt;\n  &lt;%= f.text_field :new_child %&gt;\n  &lt;%= f.submit \"Update\", class: \"btn\" %&gt;            \n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","guard","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13170077,"title":"Why is guard stopping?","body":"<p>I have a rails application that I just threw guard and minitest and my gaurd file is </p>\n\n<pre><code>guard 'minitest', :cli =&gt; '--drb --format doc --color' do\n  # with Minitest::Unit\n  watch(%r|^test/(.*)\\/?test_(.*)\\.rb|)\n  watch(%r|^lib/(.*)([^/]+)\\.rb|)     { |m| \"test/#{m[1]}test_#{m[2]}.rb\" }\n  watch(%r|^test/test_helper\\.rb|)    { \"test\" }\n\n  # Rails\n  watch(%r|^app/controllers/(.*)\\.rb|) { |m| \"test/functional/#{m[1]}_test.rb\" }\n  watch(%r|^app/helpers/(.*)\\.rb|)     { |m| \"test/helpers/#{m[1]}_test.rb\" }\n  watch(%r|^app/models/(.*)\\.rb|)      { |m| \"test/unit/#{m[1]}_test.rb\" }  \nend\n</code></pre>\n\n<p>but when i run guard i get a command prompt</p>\n\n<pre><code>bundle exec guard\n22:14:12 - INFO - Guard uses TerminalTitle to send notifications.\n22:14:12 - INFO - Guard is now watching at '/Users/trace/Sites/application'\n1.9.3 (main):0 &gt; 2 + 2\n=&gt; 4\n</code></pre>\n\n<p>Why am i getting this prompt. Any ideas... here are some of the gems i am using</p>\n\n<p><strong>UPDATE...</strong></p>\n\n<p>when i run <code>all minitest</code> then the tests run...but why do i have to run that...any ideas</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","paperclip"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":225,"score":1,"question_id":10580137,"title":"How to use paperclip to upload files other than images ...like pdf,docs","body":"<p>I am using paperclip to upload resume in my applyforjobs.Its working fine,i mean i can get browse button to upload files.But when i show the view page its not showing the pdf file that i upload,instead its showing just the name of the file. I also checked that folder which gets generated by default and that folder contains the pdfs which i uploaded during create aaction,which means upload thing is working fine.but i am not able to show that pdf.</p>\n\n<hr>\n\n<p>Following is the code in my applyforjob.rb model for paperclip attachment :</p>\n\n<pre><code>has_attached_file :resume,:styles =&gt; { :small =&gt; \"150x150&gt;\" }\n</code></pre>\n\n<p>Following is the code of applyforjobs/form.html.haml for uploading file :</p>\n\n<pre><code>= f.label :resume, \"Upload resume\".html_safe\n= f.file_field :resume\n</code></pre>\n\n<p>Following is the code of applyforjobs/show.html.haml for showing file :</p>\n\n<pre><code>= image_tag @appliedusers.resume.url(:small)\n</code></pre>\n\n<p>but its not showing that pdf file.What am i supposed to write to upload and show files like pdf or docs?</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13173594,"title":"Rails 3 Speed up Active Record Callbacks after_commit to send notifications using Private_pub","body":"<p>I am using 3 callbacks after a post is created.</p>\n\n<p>1) Post created</p>\n\n<p>callback#1) <code>after_commit :do_notify, :on =&gt; :create</code>  for crating Notification</p>\n\n<p>2) Notification created</p>\n\n<p>callback#2) <code>after_commit :publish_to_all, :on =&gt; :create</code> for sending out messages/ to user using Private_pub</p>\n\n<p>It is taking more than a minute to complete whole flow.</p>\n\n<blockquote>\n  <p>Question#1: <em>Is the approach wrong</em></p>\n  \n  <p>Question#2: <em>is there a method to send rest of callbacks to background\n  and complete it there.</em></p>\n</blockquote>\n"},{"tags":["ajax","ruby-on-rails-3","devise","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13161146,"title":"Missing template on Devise Registration Form (sign up)","body":"<p>I'm trying to understand as to who I get </p>\n\n<pre><code>Template is missing\n\nMissing template devise/registrations/create, devise/create, application/create with {:locale=&gt;[:en], :formats=&gt;[:js, :html], :handlers=&gt;[:erb, :builder, :coffee]}. Searched in: * \"C:/project/app/views\" * \"C:/Ruby193/lib/ruby/gems/1.9.1/gems/devise-2.1.2/app/views\"\n</code></pre>\n\n<p>if I try to send the registration information via :remote => true.</p>\n\n<p>As far as I understand, using remote true will ensure that the form is sent with an ajax post, but once I hit submit I see that the server returns the missing template error.</p>\n\n<p>I read somewhere that the registration controller is already using respond_with (I see in the code) which means that it should respond to the ajax. </p>\n\n<p>Can someone clarify that or if I am missing a piece in the puzzle?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":32,"score":-3,"question_id":13161504,"title":"undefined method issue","body":"<pre><code>    Exception NoMethodError -&gt; undefined method `[]' for nil:NilClass\n   lib/push/push_notification.rb:13:in `block in process'\n   lib/push/push_notification.rb:12:in `each'\n   lib/push/push_notification.rb:12:in `process'\n</code></pre>\n\n<p>put_notification:</p>\n\n<pre><code>#require 'enumerator'\n\nclass PushNotification\n\n  attr_reader :ios_notifications\n\n  def initialize\n    @ios_notifications = []\n  end\n\n  def process(device_options = [])\n    device_options.each do |device_option|\n      content_id = device_option[\"options\"][\"other\"][\"content_id\"] if device_option[\"options\"][\"other\"] &amp;&amp; device_option[\"options\"][\"other\"][\"content_id\"]\n\n      case device_option[\"platform\"]\n        when DeviceProfile::Platform::ANDROID\n          device = Gcm::Device.find_or_create_by_registration_id(device_option[\"push_id\"])\n\n          device_profile = DeviceProfile.find_by_android_push_id(device_option[\"push_id\"]) || DeviceProfile.new()\n\n          notification = Gcm::Notification.new\n          notification.device = device\n          notification.collapse_key = \"updates_available\"\n          notification.delay_while_idle = true\n          notification.data = {:registration_ids =&gt; [device.registration_id], :data =&gt; {:message =&gt; device_option[\"options\"][\"alert\"]}}\n          notification.data[:data][:content_id] = content_id if content_id\n          notification.save\n\n          Statistics::Alerts.create(push_notifications: 1, platform: \"android\", message:device_option[\"options\"][\"alert\"], content_id: content_id, udid: device_profile.udid )\n\n        when DeviceProfile::Platform::IOS\n          @ios_notifications &lt;&lt; APNS::Notification.new(device_option[\"push_id\"], device_option[\"options\"].symbolize_keys!)\n\n          device_profile = DeviceProfile.find_by_iphone_push_id(device_option[\"push_id\"]) || DeviceProfile.new()\n\n          Statistics::Alerts.create(push_notifications: 1, platform: \"ios\", message:device_option[\"options\"][\"alert\"], content_id: content_id, udid: device_profile.udid )\n      end\n    end\n\n    @ios_notifications.each_slice(100) do |group|\n      APNS.send_notifications(group)\n    end if !@ios_notifications.empty?\n\n    Gcm::Notification.where(sent_at: nil).joins(:device).readonly(false).find_in_batches(batch_size: 100) do |batch|\n      Gcm::Notification.send_notifications(batch)\n    end\n\n  end\n\n\nend\n</code></pre>\n\n<p>Here where params come from</p>\n\n<pre><code>def send_push_notifications\n    device_profiles = DeviceProfile.all\n    device_options = device_profiles.map { |dp| a = { :platform =&gt; dp.platform,\n      :options =&gt; { :alert =&gt; 'New Offer Available', :sound =&gt; \"default\",\n        :other =&gt; { :content_id =&gt; Content.last } } } \n\n    if dp.platform == DeviceProfile::Platform::IOS\n        a[:push_id] = dp.iphone_push_id\n    elsif dp.platform == DeviceProfile::Platform::ANDROID\n        a[:push_id] = dp.android_pish_id\n    end\n    }\n    puts device_options\n    Stalker.enqueue('dm.push', device_options)\n</code></pre>\n\n<p>Whats wronw with code?</p>\n"},{"tags":["ruby-on-rails-3","rspec","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13132506,"title":"Capybara Ambiguity Resolution","body":"<p>How do I resolve ambiguity in Capybara? For some reason I need links with the same values in a page but I can't create a test since I get the error</p>\n\n<pre><code>Failure/Error: click_link(\"#tag1\")\n     Capybara::Ambiguous:\n       Ambiguous match, found 2 elements matching link \"#tag1\"\n</code></pre>\n\n<p>The reason why I can't avoid this is because of the design. I'm trying to recreate the twitter page with tweets/tags on the right and the tags on the left of the page. Therefore it will be inevitable that identical links page shows up on the same page.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13168912,"title":"How to redirect non existing routes in rails","body":"<p>I have switched from an old site with a good page rank to RubyOnRails. </p>\n\n<p>Of course all links are broken now. When a user visits my site via a google link he will get:</p>\n\n<pre><code>Routing Error\n\nNo route matches [GET] \"/SOME_WRONG/URL/WITH/PARAMETERS\"\n</code></pre>\n\n<p>What is the best way to redirect the user on error like that to my root_url?</p>\n\n<p>And where I have to put this code?</p>\n\n<pre><code>.htaccess?\napplication_controller?\napplication.rb?\nroutes.rb?\n</code></pre>\n\n<p>many many thanks in advance :-)</p>\n"},{"tags":["ruby-on-rails-3","capistrano","unicorn"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13172399,"title":"How to reuse the variables in capistrano unicorn","body":"<p>I configured my deploy.rb with certain variables. For example</p>\n\n<pre><code>set :application, \"rails3\"\n</code></pre>\n\n<p>I am deploying my application using unicorn server which has the configuration under </p>\n\n<blockquote>\n  <p>config/unicorn/development.rb</p>\n</blockquote>\n\n<p>In this file I configured the variable pid_path = \"/home/user/#{application}\".</p>\n\n<p>How to reuse the value from deploy.rb</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","api","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13172125,"title":"How can i allow iphone app to login using facebook using devise?","body":"<p>I want users to login with their facebook account through devise from iphone app. </p>\n\n<p>consider when i send the id and password as</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'asdfghjkl'}}\"\n</code></pre>\n\n<p>then it produces</p>\n\n<pre><code>{\"user\":{\"authentication_token\":\"34734t374hfjeg266272\",\"email\":\"sample@gmail.com\"}}\n</code></pre>\n\n<p>I use the authentication token for the next request as</p>\n\n<pre><code>curl -L 'localhost:3000/posts.json?auth_token=34734t374hfjeg266272'\n</code></pre>\n\n<p>and i get the values from the table as json and similarly how can i do it with facebook account in devise?</p>\n\n<p>I have omniauth used in my web app and i could login as facebook user from my web app but how could i do it for iphone app?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13166373,"title":"Does using multiple databases in Rails 3 affect performance?","body":"<p>I'm currently with a client using a heroku database with a row limit and we have a big table that logs activities, so after trying some solutions I found out that I can use a different connection for a single model.</p>\n\n<p>Will it affect performance by a lot? I think I'm going to create a micro instance with postgres with just this table.</p>\n"},{"tags":["ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13168842,"title":"Rails 3: As json with include option does not takes into account as_json redefinition for included association","body":"<p>I've got two models.</p>\n\n<pre><code>Class ModelA &lt; ActiveRecord::Base\n\n  has_many :model_bs\n\nend\n\nClass ModelB &lt; ActiveRecord::Base\n\n  belongs_to :model_a\n\n  def as_json(options = {})\n    {\n       :whatever =&gt; 'hello world'\n    }\n  end\n\nend\n</code></pre>\n\n<p>When I call <code>model_a.as_json(:include =&gt; :model_b)</code>, I want it to return a json which includes all model_bs, which it does, but employing my as_json redefinition, which it does not as it just uses the default one. Is there any way to use my own method rather than the original one? Thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","google-api","oauth-2.0","google-calendar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13165989,"title":"How do I fetch user's Google Calendar persistently with Ruby?","body":"<p>My app already fetches Google Calendar but users has to login every time to get the new calendar. The issue raises from token being expired after a while. </p>\n\n<p>I've already tried the following which is to include user.profile scope:</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n    provider :google_oauth2, GOOGLE_APP_KEY, GOOGLE_APP_SECRET, {\n    scope: 'https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/userinfo.profile',\nredirect_uri: GOOGLE_APP_CALLBACK_URL\n</code></pre>\n\n<p>}\n    end</p>\n\n<p>So, now the token persist so user doesn't have to login every single time to the app, but if the Google Calendar has new entry, my web app won't be able to fetch the new events because the token is expired.</p>\n\n<p>What's the way to solve this problem?</p>\n"},{"tags":["javascript","ruby-on-rails-3","ember.js"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13146917,"title":"Ember Action - {{action showClinic clinic}} generates link with 'undefined'","body":"<p>I'm working with Ember, Ember-data and Rails.</p>\n\n<p>When I create a link in the handlebars view, it links out to /clinic/undefined. I'm trying to have the View code create a link that looks like: <code>http://localhost:3000/#/clinic/1</code> but instead looks like: <code>http://localhost:3000/#/clinic/undefined</code>.</p>\n\n<p>Any ideas why and how to fix it?</p>\n\n<p>View:</p>\n\n<pre><code>&lt;a {{action showClinic content.clinic href=true}}&gt;Click here&lt;/a&gt;\n</code></pre>\n\n<p>Router:</p>\n\n<pre><code>root: Ember.Route.extend({\nshowClinic: Ember.Route.transitionTo('clinic'),\nshowDoctor: Ember.Route.transitionTo('doctor'),\n\nindex: Ember.Route.extend({\n  route: '/',\n  connectOutlets: function(router) {\n    router.get('applicationController').connectOutlet('main');\n  }\n}),\n\nclinic: Ember.Route.extend({\n  route: '/clinic/:clinic_id',\n  connectOutlets: function(router, clinic) {\n    router.get('applicationController').connectOutlet('clinic', clinic);\n    router.get('clinicController').connectOutlet('doctors', clinic.get('doctors'));\n  }\n}),\n\ndoctor: Ember.Route.extend({\n  route: '/doctor/:doctor_id',\n  connectOutlets: function(router, doctor) {\n    router.get('applicationController').connectOutlet('doctor', doctor);\n  }\n})\n</code></pre>\n\n<p>})</p>\n\n<p>Model:</p>\n\n<pre><code>App.Doctor = DS.Model.extend({\n  name: DS.attr('string'),\n  clinic: DS.belongsTo('App.Clinic')\n});\n</code></pre>\n\n<p>JSON:</p>\n\n<pre><code>{\n  doctor: {\n    id: 1,\n    clinic_id: 1,\n    name: \"Dr. Who\"\n  }\n}\n</code></pre>\n"},{"tags":["jquery","ajax","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":238,"score":3,"question_id":11089315,"title":"How do I get my new registrations Devise form to be AJAXified?","body":"<p>What I want to happen is when the account is successfully created, the form that was submitted should disappear and a message should appear (depending on the status of the registration).</p>\n\n<p>If it was successful, they should see a simple \"Thank you. Please check your email.\"</p>\n\n<p>If it wasn't, then they should see an appropriate message - like \"Sorry, that email has already been taken.\"</p>\n\n<p>This is my form:</p>\n\n<pre><code>&lt;div class=\"nine columns offset-by-three sign-up-form\"&gt;\n  &lt;%= form_for(resource, :as =&gt; resource_name, :class =&gt; \"send-with-ajax\", :url =&gt; user_registration_path(resource), :validate =&gt; true, :html =&gt; { :id =&gt; 'user_new' }) do |f| %&gt;\n    &lt;div class=\"six columns alpha\"&gt; \n       &lt;%= f.text_field :email, :placeholder =&gt; \"your-email@address.com\", :input_html =&gt; {:autofocus =&gt; true}, :validate =&gt; true %&gt;\n    &lt;/div&gt;              \n    &lt;div class=\"three columns sign-up alpha\"&gt;\n      &lt;%= f.submit :label =&gt; \"Submit\", :value =&gt; \"Sign Me Up!\"  %&gt;\n      &lt;div class=\"ajax-response\"&gt;&lt;%= devise_error_messages! %&gt;&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>This is my <code>create.js.erb</code>:</p>\n\n<pre><code>$(document).ready(function() {    \n  $('#user_new').submit(function() { \n    $(this).fadeOut(600).hide(); \n    $(this).append('&lt;h3&gt;Thank You. You should receive an email shortly.&lt;/h3&gt;').fadeIn(1000);\n  });    \n)}\n</code></pre>\n\n<p>But this doesn't work properly. For instance, when I press submit and the email address is already in the db - nothing happens.</p>\n\n<p>P.S. I know that if it were a 'regular' form, I would do <code>format.js</code> within the controller that is handling this form - and work out the status codes &amp; messages there - but Devise is a different beast and I don't want to generate new controllers and override functionality that I shouldn't, when I am not fully comfortable.</p>\n"},{"tags":["ruby-on-rails-3","mongodb","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13157038,"title":"mongoid instead of mongomapper","body":"<p>when i was using the mongo mapper at that time , in parameter it was showing the BSON Object id and when change it to mongoid it doesnot send the BSON object id ,it simple shows the _id.\nis anybody can help me out. \nThanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":257,"score":0,"question_id":9674680,"title":"Rails PJAX not working","body":"<p>I have added the pjax javascript.</p>\n\n<p>In my view I have:</p>\n\n<pre><code>&lt;div data-pjax-container&gt;\n&lt;%= yield %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But still onclick the hole page updates. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13170314,"title":"Better Rails code for update or create clause?","body":"<p>The code smells and i'm sure i'm missing a helper to do a simple \nupdate or create query like the below snippet :</p>\n\n<pre><code>  @user_answer = current_user.user_answers.find_by_question_id(params[:a_question])\n  if @user_answer.nil?\n    @user_answer = current_user.user_answers.build({ :answer_id =&gt; params[:an_answer] , :question_id =&gt; params[:a_question] })      \n    @user_answer.save  \n  else\n    @user_answer.update_attributes(:answer_id =&gt; params[:an_answer])\n    @user_answer.save \n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller","timeout"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13170637,"title":"Rails setting timeout in controller","body":"<p>In my controller in Rails, I want to download a file into the <code>public</code> folder of the project (using the Linux system command <code>wget</code>). Then I'd like the file to stay there for an hour, before calling the command <code>rm</code> to delete it. Can I set a timeout so that the code execution pauses at some point before resuming later?</p>\n"},{"tags":["javascript","arrays","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":713,"score":1,"question_id":7195943,"title":"Rails 3 passing a rails array to javascript function which uses a javascript array","body":"<p>I am trying to pass a rails array to a javascript function.  The function will then use the array values in javascript so I need to keep it an array.  </p>\n\n<p>Here is how I am passing my array:</p>\n\n<pre><code>\"graphit([&lt;%=@mpg_values.join(\",\") %&gt;])\"\n</code></pre>\n\n<p>This produces this in the HTML</p>\n\n<pre><code>\"graphit([#&amp;lt;Mile:0x6ff0cf0&amp;gt;,#&amp;lt;Mile:0x6ff0c18&amp;gt;,#&amp;lt;Mile:0x6ff0b58&amp;gt;])\"\n</code></pre>\n\n<p>Which are not the values, they should be decimal numbers.  I assume this is because it is a reference to the array so that I why I am getting the messed up values.  If I do something like to_s I see the values but it has other stuff like the table and filed name in there as well.</p>\n\n<p>Anybody know how I can get this rails array to a javascript function as an array?</p>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","authorization","unauthorized"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2498,"score":2,"question_id":7297183,"title":"Custom Devise 401 unauthorized response","body":"<p>I'm working on a JSON-based API for my Rails 3.1 app.  I'd like to provide a custom failure response instead of the default, which is:</p>\n\n<pre><code>{\"error\":\"You need to sign in or sign up before continuing.\"}\n</code></pre>\n\n<p>My API controller includes a before_filter call to <code>authenticate_user!</code>, which is what is rendering this JSON response.</p>\n\n<p>While searching, I came across <a href=\"http://stackoverflow.com/questions/4756922/devise-hijacking-a-401-response\">this StackOverflow question</a>, which references <a href=\"https://github.com/plataformatec/devise/wiki/How-To%3a-Provide-a-custom-failure-response-with-Warden\" rel=\"nofollow\">this Devise wiki entry</a>.  Unfortunately, the wiki entry isn't verbose enough for me to understand what it's telling me.  Specifically, I have no clue where I'm supposed to put that code such that Devise/Warden knows to render what I want returned.</p>\n\n<p>From the comments on the other SA question, it sounds like I don't need to call <code>custom_failure!</code> since I'm using a version of Devise above 1.2 (1.4.2 to be specific).  However, the wiki entry doesn't explain where the <code>render</code> call should go such that <code>authenticate_user!</code> knows to use that instead of its own render call.</p>\n\n<p>Where does this <code>render</code> call go?</p>\n\n<p><strong>Edit:</strong> I'm not just trying to change the message itself (a la the devise <code>en.yml</code> config); I'm trying to change the actual format of the response.  Specifically, I want to return this:</p>\n\n<pre><code>render :text =&gt; \"You must be logged in to do that.\", :status =&gt; :unauthorized\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rspec2"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":968,"score":4,"question_id":7284413,"title":"How to test with Rspec if an email is delivered by the controller?","body":"<p>I'd like to test if an email is delivered if I call a controller method with :post. I'll use email_spec so I tried this snipped here: <a href=\"http://rubydoc.info/gems/email_spec/1.2.1/file/README.rdoc#Testing_In_Isolation\" rel=\"nofollow\">http://rubydoc.info/gems/email_spec/1.2.1/file/README.rdoc#Testing_In_Isolation</a></p>\n\n<p>But it dosen't work, because I pass an instance of the model-object to the delivery-method and the instance is saved before the delivery.</p>\n\n<p>I tried to create an other instance of the model-object, but then the id isn't the same.</p>\n\n<p>My controller-method looks like this:</p>\n\n<pre><code>def create\n\n   @params = params[:reservation]\n\n   @reservation = Reservation.new(@params)\n   if @reservation.save\n      ReservationMailer.confirm_email(@reservation).deliver\n      redirect_to success_path\n   else\n      @title = \"Reservation\"\n      render 'new'\n   end\n\nend\n</code></pre>\n\n<p>Do you have any idea to solve this?</p>\n\n<p>(Sorry for my bad english, I'm no native.)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","file","download"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13169494,"title":"Creating file dynamically and downloading onto user's computer","body":"<p>I'm wondering if it's possible to do this in Rails:</p>\n\n<p>Have a link on the webpage. When the user clicks on the link, the controller generates a file dynamically (say, a text file that contains a single random number between 1 and 10), and the file is downloaded onto the user's computer. The file might be temporarily stored on the server, but it shouldn't be permanently there.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unit-testing","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13167638,"title":"RSpec test if all models respond_to attribute","body":"<p>I'm trying to write an RSpec test for what seems like a relatively simple test, but it's proving pretty tricky (though I am new to RSpec).</p>\n\n<p>In simple terms, I want to test that all models in my application respond_to :owner or :owners.</p>\n\n<p>My first problem is looping through all of the models - how to do this in RSpec? I can normally loop through the models like:</p>\n\n<pre><code>ActiveRecord::Base.descendants.each { |model|\n    model.should respond_to :owner\n}\n</code></pre>\n\n<p>But not sure how to do this correctly in RSpec? I can't find much documentation about using loops within tests.</p>\n\n<p>My second question is about an \"OR\" clause - how can I achieve \"responds to owner or owners\"? Something like:</p>\n\n<pre><code>model.should respond_to :owner || :owners\n</code></pre>\n\n<p>But again I can find much documentation about using or clauses.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","imagemagick","osx-mountain-lion","rmagick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13169337,"title":"Can't install RMagick on OS X Mountain Lion","body":"<p>I've been struggling with this for a while. I'm running Mac OS 10.7 (Mountain Lion), and I'm trying to install the RMagick gem so I can use it in my Rails 3 app. I already installed imagemagick with homebrew, and that seemed to finish successfully. I also installed the XQuartz package. When I add 'rmagick' to my gemfile and run bundle install, I get this error:</p>\n\n<pre><code>Installing rmagick (2.13.1) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin/ruby extconf.rb \nchecking for Ruby version &gt;= 1.8.5... yes\nextconf.rb:128: Use RbConfig instead of obsolete and deprecated Config.\nchecking for clang... yes\nchecking for Magick-config... no\nCan't install RMagick 2.13.1. Can't find Magick-config in /Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin:/Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/bin:/Users/Andrew/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin\n\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin/ruby\n\n\nGem files will remain installed in /Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/gems/rmagick-2.13.1 for inspection.\nResults logged to /Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\nAn error occured while installing rmagick (2.13.1), and Bundler cannot continue.\nMake sure that `gem install rmagick -v '2.13.1'` succeeds before bundling.\n\nProcess finished with exit code 5\n</code></pre>\n\n<p>Any idea why this is happening?</p>\n"},{"tags":["linux","ruby-on-rails-3","distribution"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":448,"score":0,"question_id":5343153,"title":"Which Linux distro for Developing in Rails?","body":"<p>I'm just starting to learn Rails (Rails 3 specifically), and everything I see leans toward working in Linux to make things easier.  Since I'm bound to Windows for work, I'll be running Linux in a VM.  Are there any Linux distros that are well suited for Rails development?  Please give some kind of justification for your recommendations.</p>\n"},{"tags":["ajax","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13167484,"title":"Remote Form Renders as HTML instead of JS","body":"<p>I have a simple form:</p>\n\n<pre><code>&lt;%= form_for [current_user, @bookcase], :id =&gt; \"shelf_update_form\", :remote =&gt; true, :html =&gt; { :multipart =&gt; true} do |f| %&gt;\n  &lt;input id=\"bookcase_image\" class=\"file\" type=\"file\" name=\"bookcase[image]\" size=\"13\"&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>That automatically uploads when a file has been selected:</p>\n\n<pre><code>$(\"#shelf_update_form\").change(function() {\n  $(\"#shelf_update_form\").submit();\n});\n</code></pre>\n\n<p>I want the update action to render js view, but by default it renders html instead. I try forcing it to render js like so:</p>\n\n<pre><code>respond_to do |format|\n  format.js\nend\n</code></pre>\n\n<p>But then I get this error:</p>\n\n<pre><code>NetworkError: 406 Not Acceptable\n</code></pre>\n\n<p>Even then, my log reports:</p>\n\n<pre><code>Processing by BookcasesController#update as HTML\n</code></pre>\n\n<p>How can I get it to process as JS instead?</p>\n\n<p>UPDATE:</p>\n\n<p>The view:</p>\n\n<pre><code>triggerAjaxHistory(\"&lt;%= @href %&gt;\", false);\n</code></pre>\n\n<p>I get the same results with a more generic view, too:</p>\n\n<pre><code>alert(\"I work now!\")\n</code></pre>\n"},{"tags":["ruby-on-rails-3","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13164064,"title":"Rails cookies with wrong expiring date","body":"<p>recently I've trying to set up a cookie in order to validate a session in a Rails 3.2 app.</p>\n\n<p>The cookie was supposed to expire at the beginning of the next day, this way I would force users to login again (mandatory)</p>\n\n<p>First I changed my app's timezone to the one I was expecting to handle:</p>\n\n<pre><code>config.time_zone = 'Caracas'\n</code></pre>\n\n<p>After that I created the cookie as follows:</p>\n\n<pre><code>cookies[:remember_token] = {value: user.remember_token, \n                            expires: 1.day.from_now.beginning_of_day}\n</code></pre>\n\n<p>The cookie gets created without any problem but the expire date is wrong. In Chromium the date is set to  today a 19:30 PM (Although my machine timezone is set accordingly to the app).</p>\n\n<p>The strange thing comes when I change the definition of the cookie to:</p>\n\n<pre><code>cookies[:remember_token] = {value: user.remember_token, \n                            expires: 1.day.from_now}\n</code></pre>\n\n<p>If I set to cookie only to 1 day from today then the expire date is set properly to exactly 24 hours from now.</p>\n\n<p>Any ideas why beginning_of_date is not setting the date correctly?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","checkout","cart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13131037,"title":"Adding Cart items Ruby on Rails","body":"<p>I am developing a very basic shopping cart and the issue I am having is that if I add more than one of the same product to my shopping cart I am not seeing the quantity increase and am instead just seeing multiple versions of the item. </p>\n\n<p>For example I see:</p>\n\n<p>1 x green light = £15\n1 x green light = £15</p>\n\n<p>rather than seeing:</p>\n\n<p>2 x green light = £30</p>\n\n<p>How can I make it so that my shopping cart will check for multiple versions in the cart and then add them together?</p>\n\n<p>Currently I have: </p>\n\n<p>Application Controller</p>\n\n<pre><code>  def current_cart\n  if session[:cart_id]\n    @current_cart ||= Cart.find(session[:cart_id])\n  end\n  if session[:cart_id].nil?\n    @current_cart = Cart.create!\n    session[:cart_id] = @current_cart.id\n  end\n  @current_cart\n  end \n</code></pre>\n\n<p>Cart Controller</p>\n\n<pre><code>   def show\n    @cart = current_cart\n   end\n</code></pre>\n\n<p>Cart Model</p>\n\n<pre><code> has_many :items\n\n def total_price\n   items.to_a.sum(&amp;:full_price)\n end\n</code></pre>\n\n<p>Cart View</p>\n\n<pre><code> &lt;table id=\"line_items\"&gt;\n   &lt;tr&gt;\n     &lt;th&gt;Product&lt;/th&gt;\n     &lt;th&gt;Qty&lt;/th&gt;\n     &lt;th class=\"price\"&gt;Unit Price&lt;/th&gt;\n     &lt;th class=\"price\"&gt;Full Price&lt;/th&gt;\n   &lt;/tr&gt;\n\n  &lt;% for item in @cart.items %&gt;\n    &lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n       &lt;td&gt;&lt;%=h item.product.name %&gt;&lt;/td&gt;\n       &lt;td class=\"qty\"&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n       &lt;td class=\"price\"&gt;&lt;%= gbp(item.unit_price) %&gt;&lt;/td&gt;\n       &lt;td class=\"price\"&gt;&lt;%= gbp(item.full_price) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n   &lt;% end %&gt;\n &lt;tr&gt;\n\n  &lt;td class=\"total price\" colspan=\"4\"&gt;\n    Total: &lt;%= gbp(@cart.total_price) %&gt;\n  &lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;/table&gt;\n</code></pre>\n\n<p><strong>FURTHER INFORMATION</strong></p>\n\n<p>Products#Index</p>\n\n<pre><code>  &lt;%= link_to \"Add to Cart\", line_items_path(:product_id =&gt; product), :method =&gt; :post %&gt;\n</code></pre>\n\n<p>Any advice people can offer would be much appreciated. Thanks!</p>\n\n<p><strong>New Setup</strong> - Causing Error <code>Uninitialised Constant CartController</code></p>\n\n<p>Routes.rb</p>\n\n<pre><code> Checkout::Application.routes.draw do\n\n   ActiveAdmin.routes(self)\n\n   devise_for :admin_users, ActiveAdmin::Devise.config\n\n   post '/add_to_cart/:product_id' =&gt; 'cart#add_to_cart', :as =&gt; 'add_to_cart'\n\n   resources :carts\n   resources :products\n   resources :items\n\n   root :to =&gt; 'products#index'\n\n end\n</code></pre>\n\n<p>Carts Controller</p>\n\n<pre><code> class CartsController &lt; ApplicationController\n\n   def show\n     @cart = current_cart\n   end\n\n   def add_to_cart\n       current_cart.add_item(params[:product_id])\n       redirect_to carts_path(current_cart.id)\n   end\n\n end\n</code></pre>\n\n<p>Carts Model</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\nhas_many :items\n\ndef add_item(product_id)\n        item = items.where('product_id = ?', product_id).first\n    if item\n        # increase the quantity of product in cart\n        item.quantity + 1\n        save\n    else\n        # product does not exist in cart\n        product = Product.find(product_id)\n        items &lt;&lt; product\n    end\n    save\nend\n\ndef total_price\n    items.to_a.sum(&amp;:full_price)\nend\nend\n</code></pre>\n\n<p>Product#Index</p>\n\n<pre><code>&lt;table class=\"jobs\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th scope=\"col\" id=\"name\"&gt;Product Code&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Name&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Price&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Action&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n        &lt;% @product.each do |product| %&gt;\n        &lt;tr&gt;    \n            &lt;td&gt;&lt;%= product.product_code %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= gbp(product.price) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= button_to \"Add to Cart\", add_to_cart_path(:product_id =&gt; product), :method =&gt; :post %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;% end %&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":277,"score":0,"question_id":11780215,"title":"form_tag with :remote => true does not update div, skips to separate page","body":"<p>I am trying to update a div based on a form submit. I am on Rails 3.1.1. I am trying to adapt someone else's <a href=\"http://jmvidal.cse.sc.edu/talks/rubyonrails/form_remote_tag.html\" rel=\"nofollow\">recipe</a>. My code in the view is something like this in <code>main.html.erb</code>:</p>\n\n<pre><code>&lt;%= javascript_include_tag :defaults %&gt;\n&lt;div id='seq_search'&gt;\n  &lt;%= form_tag(:remote =&gt; true, :update =&gt; 'seq_select', :action =&gt; 'select')  do %&gt;\n    &lt;p&gt;\n      &lt;%= search_field_tag  :query, '', :size =&gt; 45 %&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;%=submit_tag \"Submit\", :disable_wth =&gt; \"Adding ...\"%&gt;\n    &lt;/p&gt;\n   &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>The controller looks like</p>\n\n<pre><code>class SearchAjaxController &lt; ApplicationController\n  def main\n  end\n  def select\n      render :text =&gt; '&lt;li&gt; '+params[:query] + ' &lt;/li&gt;'\n  end\nend\n</code></pre>\n\n<p>However, when I enter something in the text box and press submit, instead of updating the div, it goes off to another page rendering just the output of the <code>select</code> method of the controller.</p>\n\n<p>If I look at the page source of the form, it is something like this:</p>\n\n<pre><code>&lt;div id='seq_search'&gt;\n  &lt;form accept-charset=\"UTF-8\" action=\"/search_ajax/select?remote=true&amp;amp;update=seq_select\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"wlOm4H7GvZAQoIVpjxPLqHAQLOIpJ4V5r0WYEpvCCrQ=\" /&gt;&lt;/div&gt;\n    &lt;p&gt;\n      &lt;input id=\"query\" name=\"query\" size=\"45\" type=\"search\" value=\"\" /&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input disable_wth=\"Adding ...\" name=\"commit\" type=\"submit\" value=\"Submit\" /&gt;\n    &lt;/p&gt;\n&lt;/form&gt;&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>It seems that the form is simply passing <code>remote=true&amp;amp;update=seq_select</code> as arguments to the controller's method/function. Is this what is supposed to happen?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>So I tried to add to follow Mike Campbell's sugggestion and added the following code to my view (`.html.erb') file</p>\n\n<pre><code>&lt;SCRIPT type='text/Javascript'&gt; \n$(function(){\n  $('#form-id').bind('ajax:success', function(xhr, data, status){\n    $('#seq_select').html(data);\n  });\n}\n&lt;/SCRIPT&gt;\n</code></pre>\n\n<p>and also gave an id to the form:</p>\n\n<pre><code> &lt;%= form_tag(:remote =&gt; true, :update =&gt; 'seq_select', :action =&gt; 'select', :id =&gt; 'form-id')  do %&gt;\n</code></pre>\n\n<p>Submitting the form still doesn't update the page. It simply skips to a new rendered view as before. The generated HTML reads:</p>\n\n<pre><code>&lt;SCRIPT type='text/Javascript'&gt; \n$(function(){\n  $('#form-id').bind('ajax:success', function(xhr, data, status){\n    $('#seq_select').html(data);\n  });\n}\n&lt;/SCRIPT&gt;\n\n&lt;div id='seq_search'&gt;\n  &lt;form accept-charset=\"UTF-8\" action=\"/ajax_search/select/form-id?remote=true&amp;amp;update=seq_select\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"wlOm4H7GvZAQoIVpjxPLqHAQLOIpJ4V5r0WYEpvCCrQ=\" /&gt;&lt;/div&gt;\n    &lt;p&gt;\n      &lt;label&gt; Search by identifiers, accessions, and gene names.. &lt;/label&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input id=\"query\" name=\"query\" size=\"45\" type=\"search\" value=\"\" /&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input disable_wth=\"Adding ...\" name=\"commit\" type=\"submit\" value=\"Submit\" /&gt;\n    &lt;/p&gt;\n&lt;/form&gt;&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>Update:</p>\n\n<p>It seems that the syntax for form_tag was wrong, and the first argument has to be the name of the action. I now have <code>&lt;%= form_tag( 'select', :remote =&gt; true, :id =&gt; 'form_id')  do %&gt;</code> which generates the associated HTML <code>&lt;form accept-charset=\"UTF-8\" action=\"select\" data-remote=\"true\" id=\"form_id\" method=\"post\"&gt;</code>. Which is better, but my Ajax is still not working.</p>\n"},{"tags":["ruby-on-rails-3","error-handling"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":493,"score":3,"question_id":6441018,"title":"Rails 3 Sending errors to email","body":"<p>How do I hijack Rails (3) error handling to email errors with full trace to me?</p>\n"},{"tags":["css","ruby-on-rails-3","forms","twitter-bootstrap"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13167535,"title":"how to put icon in rails submit button","body":"<p>I am using Bootstrap and want to put an icon in the submit button for a form.<br>\nhere is the code:</p>\n\n<pre><code>&lt;%= f.submit \"Submit for Approval &lt;i class='icon-share-alt icon-white'&gt;&lt;/i&gt;\", \n                                class: \"button_green\" %&gt;\n</code></pre>\n\n<p>Generated HTML:</p>\n\n<pre><code>&lt;input type=\"submit\" value=\"Submit for Approval &amp;lt;i class='icon-share-alt icon-white'&amp;gt;&amp;lt;/i&amp;gt;\" name=\"commit\" class=\"button_green\"&gt;\n</code></pre>\n\n<p>I tried adding both raw and html_safe to the text but neither one seemed to work.<br>\nI know one solution would be to have the class be an image with the icon in it already but I would like to do this without creating additional images/css. any suggestions?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13166847,"title":"Rails For Loop View","body":"<p>I have the following code:</p>\n\n<pre><code>&lt;tbody&gt;\n   &lt;%= Item.each do |item|=%&gt;\n   &lt;tr&gt;\n      &lt;th&gt;&lt;%= item.rev =%&gt;&lt;/th&gt;      &lt;=========\n      &lt;th&gt;&lt;%= item.name =%&gt;&lt;/th&gt;\n   &lt;/tr&gt;\n   &lt;%= end =%&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>However I am getting a syntax error on the inidcated line. There is data in the database(Test case). No idea what I am doing wrong.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2542,"score":0,"question_id":9574659,"title":"Rails .where vs .find","body":"<p>I've noticed that the <code>Model.where</code> method always returns an array even if there is only one result where as the <code>Model.find</code> method doesn't. Is there any reason for this? I thought <code>Model.where</code> was the preferred function since Rails 3.X. </p>\n\n<p>Should I be using <code>Model.find</code> when I expect a single result and <code>Model.where</code> when I expect more than one result?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongomapper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13167897,"title":"Show Query statements in Rails Console with mongo_mapper","body":"<p>With    </p>\n\n<pre><code>ActiveRecord::Base.logger = Logger.new(STDOUT)  \n</code></pre>\n\n<p>you can view SQL statements in Rails Console,related <a href=\"http://www.shanison.com/2012/03/05/show-sql-statements-in-rails-console/\" rel=\"nofollow\">here</a>, but that require ActiveRecord , with mongo_mapper you don't have ActiveRecord, so how view debug of querys ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","form-helpers","select-tag"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13166677,"title":"How to have a default select value that is NOT an option in drop down, using Ruby form select helper method","body":"<p>Ok so I am working on a project that was outsourced and now I get to jump in and fix everything before it gets pushed to production. I am currently trying to modify a line that creates a select form field. I read up on some of the different form helper methods to use in ruby, and over some of the available options for the method.</p>\n\n<p>My problem is I can't seem to figure out how to get a default value to be displayed inside the select element without having it show up in the drop down options. This is what the line currently looks like.</p>\n\n<pre><code>&lt;%= select :profile, :sexual_interest, SEXUAL_INTEREST_ARRAY, {:prompt =&gt; 'sexuality'}, {:class =&gt; 'selectFull'} %&gt;\n</code></pre>\n\n<p>I tried changing some of the options using :default => 'sexuality' and then tried :disabled => 'sexuality'. But I seem to only be able to remove the option entirely from the select element or have it as the first value in the drop down list and being displayed as the default value.</p>\n\n<p>If you are just having issues setting the default value of your select field using a ruby form helper, reference this post <a href=\"http://stackoverflow.com/questions/623458/rails-select-helper-default-selected-value-how\">selecting a default for option field</a></p>\n\n<p>If any one could give me some insight as to how to fix this issue I would greatly appreciate it. Any ideas would help, Thanks for reading.</p>\n\n<p>-Alan</p>\n"},{"tags":["mysql","ruby","ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13167743,"title":"Safe querying by find, sql, or where","body":"<p>I want to find all widgets with their common or internal names in a certain list <code>query_list</code>. I can do</p>\n\n<pre><code># Consider query_list = [\"a\",\"b\",\"c\"]\nqlist = '(' + query_list.join(\",\") + ')'\n# this makes \nwidgets = Widget.find_by_sql(\"SELECT * FROM widgets \n     WHERE common_name IN #{qlist} OR internal_name IN #{qlist}\")\n</code></pre>\n\n<p>Now I have a few questions:</p>\n\n<ol>\n<li>Is the above find_by_sql safe regarding SQL injection attacks? It seems like one could put in something dangerous in <code>query_list</code>.\n<ul>\n<li>How about writing <code>.find_by_sql([\"SELECT * FROM widgets\n     WHERE common_name IN ? OR internal_name IN ?\", [\"a\",\"b\",\"c\"], [\"a\",\"b\",\"c\"] ])</code></li>\n<li>If it isn't safe, can we make it safe?</li>\n</ul></li>\n<li>I prefer not to write raw sql if I don't have to. I know we can write <code>AND</code> conditions in <code>find</code>, as in <code>.find(:conditions=&gt;{:internal_name =&gt; ['a','b','c'], :common_name =&gt; ['a','b','c']})</code>. Can we also write <code>OR</code> conditions using find?</li>\n<li>How about using <code>where</code>? How is this different from using <code>find</code>?</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongomapper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13167053,"title":"rails generate migration error mongo_mapper not found","body":"<p>Follow <a href=\"http://mongomapper.com/documentation/getting-started/rails.html\" rel=\"nofollow\">Installation in Rails 3 of Mongo Mapper</a> i add to config/application.rb file :</p>\n\n<pre><code>config.generators do |g|\n  g.orm :mongo_mapper\nend\n</code></pre>\n\n<p>when <code>rails generate migration my_migration</code> i got :</p>\n\n<pre><code>error  mongo_mapper [not found]\n</code></pre>\n\n<p>but when <code>rails generate model my_model</code>, i got a fine model class with <code>include MongoMapper::Document</code> and this output :</p>\n\n<pre><code>invoke  mongo_mapper\ncreate    app/models/user.rb\ninvoke    test_unit\ncreate      test/unit/user_test.rb\ncreate      test/fixtures/users.yml\n</code></pre>\n"},{"tags":["ruby-on-rails-3","helper","twitter-bootstrap-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":208,"score":1,"question_id":11224276,"title":"rails twitter bootstrap helper methods","body":"<p>I am using the <code>twitter-bootstrap-rails</code> gem in my app. It seems to come with a range of helper methods that create for example the edit and delete buttons in a themed view:</p>\n\n<pre><code>&lt;%= link_to t('.destroy', :default =&gt; t(\"helpers.links.destroy\")),\n                  cohort_path(cohort),\n                  :method =&gt; :delete,\n                  :confirm =&gt; t('.confirm', :default =&gt; t(\"helpers.links.confirm\", :default =&gt; 'Are you sure?')),\n                  :class =&gt; 'btn btn-mini btn-danger' %&gt;\n</code></pre>\n\n<p>Where are these t() methods and helpers defined? How can I alter them? For example, if I want to change the label on the Destroy button to \"Delete\" I can change the above to:</p>\n\n<pre><code>&lt;%= link_to t('.destroy', :default =&gt; \"Delete\"),\n                  cohort_path(cohort),\n                  :method =&gt; :delete,\n                  :confirm =&gt; t('.confirm', :default =&gt; t(\"helpers.links.confirm\", :default =&gt; 'Are you sure?')),\n                  :class =&gt; 'btn btn-mini btn-danger' %&gt;\n</code></pre>\n\n<p>What I would really like to do is change <code>t(\"helpers.links.destroy\")</code> to display \"Delete\" instead of \"Destroy\" in all my views. Can I do that? Appreciate your help!</p>\n"},{"tags":["ruby-on-rails-3","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13166761,"title":"Rails - Associations with API","body":"<p>I'm working on an API in Rails and have hit a wall. I'm missing something stupid I imagine, but I can't see it.</p>\n\n<p><a href=\"https://gist.github.com/3989396\" rel=\"nofollow\">https://gist.github.com/3989396</a></p>\n\n<p>I can not get associations passed in the item.json to create an association. I thought that Rails would hook these up.</p>\n"},{"tags":["ruby-on-rails-3","redirect","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13160619,"title":"Rails 3 routes redirect to named url without hitting controller","body":"<p>According to the <a href=\"http://edgeguides.rubyonrails.org/routing.html#redirection\" rel=\"nofollow\">Rails Routing Redirection guide</a>, there doesn't seem to be an easy way to redirect a matched URL to another named URL within the routes file. </p>\n\n<p>I wish I could redirect like this, or something similar, in my routes.rb without having specify the full url path (<code>\"/articles/%{id}\"</code>) in the redirect function.</p>\n\n<pre><code>match \"articles/:id\" =&gt; \"articles#show\", :as=&gt;'article'\nmatch \"articles/view/:id\", :to =&gt; redirect(article_path) \n</code></pre>\n\n<p>Is there a plugin or gem that might provide this functionality?</p>\n\n<hr>\n\n<p>My final solution included adding a function like the following based on the accepted answer.</p>\n\n<pre><code># handles redirecting a matched URL to a named URL\n# source_match = string to match against\n# dest_name = symbol of the named URL \ndef redirect_to_url(source_match,dest_name)\n    param_symbols = source_match.scan(/:([a-z\\-\\_]+)/i).flatten.map{|i| i.to_sym}\n    match source_match, :to=&gt;redirect{|params,request| \n        Rails.application.routes.url_helpers.send(\"#{dest_name}_path\", params.slice(*param_symbols))\n    }\nend\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13161283,"title":"Rails remote form renders json in browser","body":"<p>I have a remote form for creating images. Each time the file input is changed, it submits the form.</p>\n\n<pre><code>&lt;%= form_for Image.new, remote: true, multipart: true do |f| %&gt;\n  &lt;!-- form omitted --&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The automatic submitting:</p>\n\n<pre><code>$(\"#new_image input[type=file]\").on(\"change\", function() {\n  $(\"#new_image\").submit();\n});\n</code></pre>\n\n<p>The image is created and json is rendered in the images controller just fine:</p>\n\n<pre><code>def create\n  @image = Image.new params[:image]\n  if @image.save\n    render json: @image, status: :success\n  else\n    render json: @image.errors, status: :unprocessable_entity\n  end\nend\n</code></pre>\n\n<p>The problem is then the user is redirected to the json output. How could that happen? The form is remote: true, so it shouldn't redirect right? I just want the data available for unobtrusive callbacks. </p>\n\n<p>How do I get this to work?</p>\n\n<p><strong>Edit</strong>: application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery-ui\n//= require_tree .\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","integration-testing","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13165975,"title":"Capybara Not Finding Form Fields","body":"<p>I was trying Capybara for the first time and having trouble with it finding my form. I'm using Rspec, Capybara, Rails 3.2.8, and Twitter Bootstrap.</p>\n\n<p>In my test, I had:</p>\n\n<pre><code>before do\n  choose  \"Residential\"\n  choose  \"Storage\"\n  fill_in \"Customer Location\",  with: 30082\n  fill_in \"datepicker\",         with: 2012-12-02\n  fill_in \"Email\",              with: \"jesse@test.com\"\n  fill_in \"Phone\",              with: \"555-555-5555\"\n end\n</code></pre>\n\n<p>And was getting the error:</p>\n\n<pre><code>Failure/Error: choose  \"Residential\"\n   Capybara::ElementNotFound:\n     cannot choose field, no radio button with id, name, or label 'Residential' found\n</code></pre>\n\n<p>In my form, I had (excerpt):</p>\n\n<pre><code>    &lt;%= quote.radio_button :customer_type, \"Residential\"%&gt;\n    &lt;%= quote.label \"Residential\", class:\"radio inline\" %&gt;\n</code></pre>\n\n<p>When I fired up the server, I could see the form and Firebug showed that I had a label named \"Residential\" associated with the form element.</p>\n\n<p>After searching for the problem and finding this post: <a href=\"http://stackoverflow.com/questions/11356161/capybara-not-finding-form-elements/13165829#13165829\">Capybara not finding form elements</a> (among others), I couldn't figure out why it wasn't working.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","amazon-s3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13149240,"title":"Ruby aws-sdk - timeout error","body":"<p>I am trying to upload a file to S3 with the following simple code:</p>\n\n<pre><code>bucket.objects.create(\"sitemaps/event/#{file_name}\", open(file))\n</code></pre>\n\n<p>I get the following:</p>\n\n<p><strong>Your socket connection to the server was not read from or written to within the timeout period. Idle connections will be closed.</strong></p>\n\n<p>What could be going wrong?  Any tips will be appreciated.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13164316,"title":"Making select box a required field in some situations","body":"<p>I have a form which has a select box with categories. If a particular category is selected, another select box/dropdown is displayed to the user. I need this second dropdown to be a required field when this category is selected.</p>\n\n<p>I cannot add <code>validates :course, :presence =&gt; {:message =&gt; 'Course cannot be blank.'}</code> to the model because this field is not always required, I need some other way to make it required only when certain category is selected in the first dropbox.</p>\n\n<p>Thanks for your help</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hyperlink","download","link-to"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13164063,"title":"file download link in rails","body":"<p>I would like to give visitors the option to download some pdf. \nI have tried:</p>\n\n<pre><code>&lt;%= link_to \"abc\", \"/data/abc.pdf\"%&gt;\n\n&lt;%= link_to \"abc\", \"/data/abc.pdf\", :format =&gt; 'pdf' %&gt;\n</code></pre>\n\n<p>and some variations but they don't seem to work. I keep getting <code>No route matches [GET] \"/data/abc.pdf\"</code></p>\n\n<p>I have the pdf files in a folder called data, located in the assets folder.\nAny help would be appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13146839,"title":"Accessing/setting nested value with a form","body":"<p>I have 30k+ documents in my database with this structure:</p>\n\n<pre><code>{\n  ...,\n  \"hours\" : {\n    \"holiday\" : {\n      \"New Years\" : \"Call\",\n      \"Easter\" : \"Closed\",\n      \"Memorial Day\" : \"Standard\",\n      \"Independence Day\" : \"Standard\",\n      \"Labor Day\" : \"Standard\",\n      \"Thanksgiving\" : \"Closed\",\n      \"Day After Thanksgiving\" : \"Call\",\n      \"Christmas Eve\" : \"Call\",\n      \"Christmas\" : \"Closed\",\n      \"New Years Eve\" : \"Call\"\n    },\n    \"standard\" : {\n      \"mon\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"tue\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"wed\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"thu\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"fri\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"sat\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"sun\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"10:00 pm\"\n      }]\n    }\n  },\n  ...\n}\n</code></pre>\n\n<p>I am doing a complete rewrite from a php-driven site.  I have been racking my brain and absolutely cannot come up with a way to make a form field that will allow me to set business.hours[\"standard\"][\"mon\"] properly.  The site offers multiple open/close entries per day, for businesses that close for lunch, etc.  That attribute would be set to [{\"open\" : \"8:00 am\", \"close\" : \"12:00 pm},{\"open\" : \"1:00 pm\", \"close\" : \"5:00 pm}] in such a case.  I would like to offer two select boxes for each entry, one for open time and one for close time.  </p>\n\n<p>Here is my Model. including some getters/setters that I was attempting to figure out how to tie into my form...unsuccessfully.</p>\n\n<pre><code>class Business\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  field :ad, type: String\n  field :address, type: String\n  field :city, type: String\n  field :claimed, type: Boolean\n  field :coupons, type: String\n  field :created_at, type: DateTime\n  field :extra_services, type: Array\n  field :hours, type: Hash\n  field :name, type: String\n  field :organization, type: String\n  field :permanently_closed, type: Boolean, :default =&gt; false\n  field :phone, type: String\n  field :state, type: String\n  field :tags, type: Array\n  field :unit, type: String\n  field :updated_at, type: DateTime\n  field :website, type: String\n  field :zip, type: String\n\n  attr_accessible :ad, :address, :city, :claimed, :coupons, :created_at, :updated_at, :extra_services, :hours,\n                  :name, :organization, :permanently_closed, :phone, :state, :tags, :unit, :website, :zip\n\n  index({address: 1, unit: 1, city: 1, state: 1, zip: 1, organization: 1}, {unique: true, name: \"address_unique_index\"})\n\n  after_initialize do |b|\n    b.hours = Hash.new unless b.hours\n    b.hours[\"holiday_hours\"] = {\"New Years\" =&gt; \"Call\",\n                                \"Easter\" =&gt; \"Call\",\n                                \"Memorial Day\" =&gt; \"Call\",\n                                \"Independence Day\" =&gt; \"Call\",\n                                \"Labor Day\" =&gt; \"Call\",\n                                \"Thanksgiving\" =&gt; \"Call\",\n                                \"Day After Thanksgiving\" =&gt; \"Call\",\n                                \"Christmas Eve\" =&gt; \"Call\",\n                                \"Christmas\" =&gt; \"Call\",\n                                \"New Years Eve\" =&gt; \"Call\"} unless b.hours[\"holiday_hours\"]\n\n    b.hours[\"standard_hours\"] = Hash.new unless b.hours[\"standard_hours\"]\n  end\n\n  def holiday_hours\n    hours[\"holiday_hours\"] if hours[\"holiday_hours\"]\n  end\n\n  def holiday_hours=(hours)\n    self.hours[\"holiday_hours\"] = hours if hours.present?\n  end\n\n  def holiday_hours_for(holiday)\n    hours[\"holiday_hours\"][holiday.to_s] if hours[\"holiday_hours\"][holiday.to_s]\n  end\n\n  def update_holiday_hours_for(holiday, hours_text)\n    self.hours = Hash.new unless hours\n    self.hours[\"holiday_hours\"] = Hash.new unless hours[\"holiday_hours\"]\n    self.hours[\"holiday_hours\"][holiday.to_s] = hours_text.to_s\n  end\n\n  def standard_hours\n    hours[\"standard_hours\"] if hours[\"standard_hours\"]\n  end\n\n  def standard_hours_for(day)\n    hours[\"standard_hours\"][day.to_s] if hours[\"standard_hours\"][day.to_s]\n  end\nend\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","postgresql","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13163704,"title":"Rails Hide Specific Record From All Select * Type Queries","body":"<p>I have a record in a table that serves as a placeholder of sorts, and doesn't represent actual data. It's bad design, I know, but I have some very awkward requirements that I have to deal with and I saw no other solutions so it's a bit of a hotfix per se. </p>\n\n<p>Now lets say I have a series of SELECT *s throughout my application and I don't want to have to explicitly exclude that single record for each of them. Is there anything I can drop into my model to exclude it from all queries except for the ones where it's explicitly called? Or perhaps some logic I can put directly into my PG database?</p>\n\n<p>It's the very first record in the table with an ID of 0. </p>\n"},{"tags":["ruby-on-rails-3","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13128425,"title":"delayed_job randomly disappearing jobs without executing them","body":"<p>Rails 3.2.8, delayed_job (3.0.3), delayed_job_active_record (0.3.3).  Using WEBrick.</p>\n\n<p>I have an initializer that asynchronously populates the cache on startup:</p>\n\n<pre><code>MyModel.delay.get_lots_of_records\nMyModel.delay.get_some_other_records\nMyOtherModel.delay.get_tons_of_records\nMyOtherModel.delay.get_some_other_records\n</code></pre>\n\n<p>In the development environment, this works fine, as evidenced by the delayed_job log and the cache log.</p>\n\n<p>In staging, however, sometimes 1 or 2, or sometimes none of these jobs are executed.  Usually at least one, typically the same one (but not always), is executed.  If I look at the delayed_jobs table after startup, I see <strong>all 4</strong> jobs get written and then vanish 2 seconds later.  </p>\n\n<p>Per the recommendation <a href=\"https://github.com/collectiveidea/delayed_job/wiki/Common-problems#wiki-jobs_are_silently_removed_from_the_database\" rel=\"nofollow\">here</a>, I have </p>\n\n<pre><code># config/initializers/delayed_job_config.rb\nDelayed::Worker.destroy_failed_jobs = false\n</code></pre>\n\n<p>But the jobs are still being very quickly deleted without failing or executing.</p>\n\n<p>If I insert breakpoints at <code>Delayed::PerformableMethod.perform</code>, I see that method called only if the jobs are actually executed, so the problem is upstream of that.  The <code>destroy</code> method is called after <code>perform</code>, though, so I'm not sure what's going on.</p>\n\n<p>I'm looking for troubleshooting recommendations or additional diagnostic actions.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","refactoring"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13146445,"title":"How to refactor complex method in Rails model with Rspec?","body":"<p>I have the following complex method. I'm trying to find and implement possible improvements. Right now I moved last if statement to <code>Access</code> class.</p>\n\n<pre><code>def add_access(access)\n   if access.instance_of?(Access)\n     up = UserAccess.find(:first, :conditions =&gt; ['user_id = ? AND access_id = ?', self.id, access.id])\n     if !up &amp;&amp; company\n       users = company.users.map{|u| u.id unless u.blank?}.compact\n       num_p = UserAccess.count(:conditions =&gt; ['user_id IN (?) AND access_id = ?', users, access.id])\n       if num_p &lt; access.limit\n         UserAccess.create(:user =&gt; self, :access =&gt; access)\n       else\n         return \"You have exceeded the maximum number of alotted permissions\"\n       end\n     end\n   end\n end\n</code></pre>\n\n<p>I would like to add also specs before refactoring. I added first one. How should looks like others?</p>\n\n<pre><code>  describe \"#add_permission\" do\n    before do\n      @permission = create(:permission)\n      @user = create(:user)\n    end\n\n    it \"allow create UserPermission\" do\n      expect {\n        @user.add_permission(@permission)\n      }.to change {\n        UserPermission.count\n      }.by(1)\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","cucumber","capybara"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13090680,"title":"Cucumber + Capybara Not Executing AJAX Request","body":"<p>My Cucumber + Capybara tests are currently not executing AJAX requests. The test log does NOT contain the AJAX [POST] request, which leads me to believe that the request is never sent. Does anyone know what the problem(s) could be and how to troubleshoot it? </p>\n"},{"tags":["ruby","ruby-on-rails-3","routes","ip","firewall"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":9934545,"title":"Different Rails route if IP not in list?","body":"<p>I have a Rails 3.2.2 application which is a simple company intranet, however although there isn't any private information on there it's probably best if it was fairly secure from the outside world. </p>\n\n<p>We do however have people working from home on fairly regular occasions that don't have a VPN setup. </p>\n\n<p>Currently I have a firewall rule that blocks everyone except a list of our teams/branches static IP addresses. The problem with this is when a team member visits the site from home the site never loads because the firewall rejects them. What I would like to do is serve a simple page within the application explaining why they don't have \"full\" access. </p>\n\n<p>The firewall is serving multiple applications, so I can't put the access denied page on there </p>\n\n<p>I have read a few questions on SO such as <a href=\"http://stackoverflow.com/questions/3887943/ip-address-in-rails\">IP address in rails</a> which show how to get their IP address, but I'm unsure how to alter a default route based on that. </p>\n"},{"tags":["ruby-on-rails-3","validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13161424,"title":"Rails 3 - Model Error Message Validation Messages","body":"<p>Currently I have a script that checks to make sure that a test card was not submitted in production (since Authorize.net accepts test credit cards in live mode) and I add an error message to the credit card number if the one submitted is in the <code>Test_Credit_Cards</code> array like so:</p>\n\n<pre><code>TEST_CREDIT_CARDS = ['370000000000002', '6011000000000012', '4007000000027', '4012888818888']\nvalidate :not_a_test_credit_card\n def not_a_test_credit_card\n      self.errors[:cc_number] &lt;&lt; \"number is invalid!\" if TEST_CREDIT_CARDS.include?(cc_number) and Rails.env.production?\n    end\n</code></pre>\n\n<p>Now on the front end the error message appears like so:\n<code>Credit card cc number is invalid!</code></p>\n\n<p>Is there anyway to change the message to read <code>Credit Card number is invalid!</code> I just want to remove the <code>cc</code> portion from the message.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","gem","actionview"],"answer_count":4,"favorite_count":7,"up_vote_count":13,"down_vote_count":0,"view_count":2021,"score":13,"question_id":5791211,"title":"How do I extract Rails view helpers into a gem?","body":"<p>I have a set of rails view helpers that I use regularly, and would like to package them up into a gem, such that I could just put a line in my Gemfile, and have the helpers accessible from my views.</p>\n\n<p>I have created gems before using Bundler, and Jeweler, however, I'm not all all clear on how to organize the Rails view helpers in a gem, and include them into rails.</p>\n\n<p>I would appreciate any pointers, or links to up-to-date tutorials on how to do this for Rails 3</p>\n\n<p>Thanks</p>\n\n<p>Just to clarify:  The question isn't on \"how to create a gem\".  Its \"how to package view helpers in a gem, so I can use them in Rails\"</p>\n\n<p>Edit 2:\nI also agree with the poster below..  A rails engine is waay too much overkill for this kind of (hopefully simple) requirement</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13070658,"title":"First or limit in Rails scope","body":"<p>I have the following scope:</p>\n\n<pre><code>scope :user_reviews, lambda { |user| where(:user_id =&gt; user) }\n</code></pre>\n\n<p>I apply this in the controller:</p>\n\n<pre><code>def show\n  @review = @reviewable.reviews.user_reviews(current_user).first || Review.new\nend\n</code></pre>\n\n<p>The <code>first</code> is to limit to search the current user's one and only review. Now I try to write a new scope <code>user_review</code> which I tried many ways to chain the <code>user_reviews</code> scope with <code>first</code>, but just couldn't get it what. Something like this:</p>\n\n<pre><code>scope :user_reviews, lambda { |user| where(:user_id =&gt; user) }\nscope :user_review, lambda { |user| user_reviews(user).first }\n</code></pre>\n\n<p>I know the above <code>user_review</code> is wrong, but just trying to show you guys what I am trying to do.</p>\n\n<p>How should I write this properly?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","capistrano","asset-pipeline","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12761162,"title":"Cap deploy doesn't work all the sudden; something to do with FactoryGirl and assets","body":"<p>I've been <code>cap deploy</code>ing my app all throughout it development, and this last time I tried to deploy it, it didn't work. Here's what happened:</p>\n\n<pre><code>  * executing `deploy:assets:precompile'\n  * executing \"cd /var/www/oneteam/releases/20121006153136 &amp;&amp; bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile\"\n    servers: [\"electricsasquatch.com\"]\n    [electricsasquatch.com] executing command\n ** [out :: electricsasquatch.com] rake aborted!\n ** [out :: electricsasquatch.com] uninitialized constant OneTeam::Application::FactoryGirl\n ** [out :: electricsasquatch.com] \n ** [out :: electricsasquatch.com] (See full trace by running task with --trace)\n</code></pre>\n\n<p>It looks like it failed on the <code>deploy:assets:precompile</code> command. I don't get why that command would have tried to do anything with FactoryGirl, though. Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13161554,"title":"How to set a blank input form?","body":"<p>I want to create a form where a user is able to update his/her email and password.</p>\n\n<pre><code>&lt;%= form_for @customer do |c| %&gt;\n    &lt;%= c.label :email%&gt;\n    &lt;%= c.text_field :email%&gt;\n    &lt;%= c.label :email_confirmation %&gt;\n    &lt;%= c.text_field :email_confirmation%&gt;\n    &lt;%= c.label :password%&gt;\n    &lt;%= c.password_field :password%&gt;\n    &lt;%= c.label :password_confirmation%&gt;\n    &lt;%= c.password_field :password_confirmation%&gt;\n    &lt;%= c.submit(\"Edit profile\")%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem is that I don't want them to be filled in when just looking at it.\nSo it should have something like:</p>\n\n<pre><code>Email [blank]\nEmail confirmation [blank]\nPassword [blank]\nPassword confirmation [blank]\n</code></pre>\n\n<p>So how do I have this to be blank in stead of pre-filled in by Rails?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","mocking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13160324,"title":"How to stub after_create callback save! in model?","body":"<p>I receive following error:</p>\n\n<p>Output:</p>\n\n<pre><code>1) LabelsController#create label is new creates a new label\n   Failure/Error: post :create, attributes[:label], format: :json\n   NoMethodError:\n     undefined method `save!' for nil:NilClass\n   # ./app/models/labeling.rb:17:in `update_target'\n</code></pre>\n\n<p>In Labeling model:</p>\n\n<pre><code>after_create :update_target\n\ndef update_target\n   self.target.save!\nend\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>require 'spec_helper'\ndescribe LabelsController do\n  before(:each) do\n    controller.stub(:current_user).and_return(mock_model(User))\n    stub_request(:any, \"www.example.com\").to_return(status: 200)\n  end\n  describe \"#create\" do\n    context \"label is new\" do\n      it \"creates a new label\" do\n        attributes = {\n          label: {\n            name: \"test\",\n            labeling: {\n              target_type: \"Link\", target_id: 1\n            }\n          }\n        }\n        response.status.should == 200\n        post :create, attributes[:label], format: :json\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Labeling controller:</p>\n\n<pre><code>  def create\n    label = Label.find_by_name(params[:name])\n\n    labeling = label.labelings.build do |lb|\n      lb.user_id     = current_user.id\n      lb.target_type = params[:labeling][:target_type]\n      lb.target_id   = params[:labeling][:target_id]\n    end\n\n    if labeling.save\n      render json: {\n        name: label.name,\n        id: label.id,\n        labeling: {\n          id: labeling.id\n        }\n      }\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":602,"score":2,"question_id":7743059,"title":"How do i get rid of @controller is nil error in my tests","body":"<p>I keep getting</p>\n\n<pre><code> @controller is nil: make sure you set it in your test's setup method.\n</code></pre>\n\n<p>When I run my tests. Any idea what this means?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13160441,"title":"How to remove quotes in active record query","body":"<p>I am trying to retrieve records from multiple tables based on collection of ids suing the \nbelow query, it is working fine.\n<br/><br/><strong>ACTIVE RECORD QUERY:</strong></p>\n\n<blockquote>\n  <p>Song.order(\"songs.id desc\").\n            includes(:artist).includes(:album).\n            joins(\"LEFT JOIN artists ON songs.artist_id = artists.id\").\n            joins(\"LEFT JOIN albums ON songs.album_id = albums.id\").\n            where(\"(songs.id)</p>\n  \n  <blockquote>\n    <p>IN (#{song_ids*','})</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE :term OR LOWER(artists.name) LIKE :term\n  OR LOWER(albums.title) LIKE :term)\",\n            :term => \"%#{terms[index].downcase}%\")</p>\n</blockquote>\n\n<p><strong>PG QUERY OUTPUT:</strong></p>\n\n<blockquote>\n  <p>SELECT \"songs\".* FROM \"songs\" LEFT JOIN artists ON songs.artist_id =\n  artists.id LEFT JOIN albums ON songs.album_id = albums.id WHERE (</p>\n  \n  <blockquote>\n    <p>(songs.id) IN (4,5,28,37,46,48)</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE '%wo%' OR LOWER(artists.name) LIKE\n  '%wo%' OR LOWER(albums.title) LIKE '%wo%')) ORDER BY songs.id desc</p>\n</blockquote>\n\n<p>But while I was trying to modify the query as below\n<br/><br/><strong>ACTIVE RECORD QUERY:</strong></p>\n\n<blockquote>\n  <p>Song.order(\"songs.id desc\").\n            includes(:artist).includes(:album).\n            joins(\"LEFT JOIN artists ON songs.artist_id = artists.id\").\n            joins(\"LEFT JOIN albums ON songs.album_id = albums.id\").\n            where(\"(songs.id)</p>\n  \n  <blockquote>\n    <p>IN (:song_ids)</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE :term OR LOWER(artists.name) LIKE :term\n  OR LOWER(albums.title) LIKE :term)\",</p>\n</blockquote>\n\n<pre><code>      :term =&gt; \"%#{terms[index].downcase}%\",:song_ids =&gt; song_ids*',')\n</code></pre>\n\n<p><strong>PG QUERY OUTPUT:</strong></p>\n\n<blockquote>\n  <p>SELECT \"songs\".* FROM \"songs\" LEFT JOIN artists ON songs.artist_id =\n  artists.id LEFT JOIN albums ON songs.album_id = albums.id WHERE (</p>\n  \n  <blockquote>\n    <p>(songs.id) IN ('4,5,28,37,46,48')</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE '%wo%' OR LOWER(artists.name) LIKE\n  '%wo%' OR LOWER(albums.title) LIKE '%wo%')) ORDER BY songs.id desc</p>\n</blockquote>\n\n<p>Because of the single quotes the above query doesn't working.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","arel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":211,"score":0,"question_id":10149485,"title":"How can I build up an ActiveRecord query incrementally, line by line?","body":"<p>I'd like to piece together an ActiveRecord query using runtime data. What I have in mind is something like...</p>\n\n<pre><code>r = Person.where('last_name LIKE ?', foo)\nr.where('created_at &lt; ?', Time.now - 100.days)\nr.where( ...some other conditions... )\n</code></pre>\n\n<p>That doesn't work as intended though. To get it to work you have to chain them together all on one line...</p>\n\n<pre><code>Person.where('last_name LIKE ?', foo) \\\n  .where('created_at &lt; ?', Time.now - 100.days) \\\n  .where( ...some other conditions... )\n</code></pre>\n\n<p>I'm trying to figure out a way to spread it over separate operations on multiple lines.</p>\n"},{"tags":["ruby-on-rails-3","notifications","god"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13160181,"title":"god.rb how to do multiple notifications?","body":"<p><strong>With below test.god how could one do multiple notifications?\nOnly 1 single notification seems to work.\nThis send 1 prowl notification but how to add a mail notification to this?</strong></p>\n\n<p>My example code:</p>\n\n<pre><code>God::Contacts::Email.defaults do |d|\n  d.from_email = 'noreply@host.com'\n  d.from_name = 'Monitor'\n  d.delivery_method = :smtp\n  d.server_host = 'host.com'\n  d.server_auth = true\n  d.server_domain = 'host.com'\n  d.server_user = 'info@host.com'\n  d.server_password = 'pass'\n end\n\nGod.contact(:email) do |c|\n  c.name = 'me'\n  c.group = 'system'\n  c.to_email = 'info@host.com'\nend\n\nGod.contact(:prowl) do |p|\n   p.name = 'xxx'\n   p.apikey = 'xxx'\nend\n\n\nGod.watch do |w|\n  w.name = \"simple\"\n  w.interval = 5.seconds\n  w.start = \"ruby /tmp/simple.rb\"\n  w.keepalive\n  w.start_grace   = 10.seconds \n  w.restart_grace = 10.seconds \n\n\n w.transition(:init, { true =&gt; :up, false =&gt; :start }) do |on|\n    on.condition(:process_running) do |c|\n      c.running = true\n    end\n  end\n\n  # determine when process has finished starting\n  w.transition([:start, :restart], :up) do |on|\n    on.condition(:process_running) do |c|\n      c.running = true\n    end\n  end\n\n  # start if process is not running\n  w.transition(:up, :start) do |on|\n    on.condition(:process_exits)\n  end\n\n  # # bind the notification via mail when some problems occours\n  w.transition(:up, :start) do |on|\n    on.condition(:process_exits) do |p|\n      p.notify = 'xxx'\n    end\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","tablesorter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13146587,"title":"tablesorter-infoOnly shows the sort icons even when disabled in rails","body":"<p>I am working on a rails application and have two tbody's for a table. I disabled the table-sorter in second tbody by using tablesorter-infoOnly. But still it shows the icons associated with sorting next to the table headers eventhough sort has been disabled. . </p>\n\n<p>Is their any way to remove the sorter images in rails application or handling it in javascript to disable the icons from displaying n the second tbody??</p>\n"},{"tags":["ruby-on-rails-3","header","pdfkit"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":11830114,"title":"Setting header size in PDFKit with Ruby on Rails?","body":"<p>I need a repeating image to be shown on every page of the pdf. The only solution to this I've found so far is putting it into the header using</p>\n\n<p><code>%meta{:name =&gt; 'pdfkit-header_html', :content =&gt; pdf_header_url}</code></p>\n\n<p>Works fine but the image is bigger than the header size. Is there any way I can increase the height of the header or put a repeating image somehow outside the header?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","analytical"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13159707,"title":"Analytical gem on Heroku error","body":"<p>Good morning. I am trying to use this gem:</p>\n\n<p><a href=\"https://github.com/jkrall/analytical\" rel=\"nofollow\">https://github.com/jkrall/analytical</a></p>\n\n<p>On Heroku. It runs dandy on my local environment, but on Heroku busts out with:</p>\n\n<pre><code>2012-10-31T13:52:28+00:00 app[web.1]: /usr/local/lib/ruby/1.9.1/syck.rb:135:in `load': syntax error on line 4, col 5: `' (ArgumentError)\n2012-10-31T13:52:28+00:00 app[web.1]:   from /usr/local/lib/ruby/1.9.1/syck.rb:135:in `load'\n2012-10-31T13:52:28+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/analytical-3.0.12/lib/analytical.rb:14:in `block in analytical'\n2012-10-31T13:52:28+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/analytical-3.0.12/lib/analytical.rb:13:in `open'\n2012-10-31T13:52:28+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/analytical-3.0.12/lib/analytical.rb:13:in `analytical'\n2012-10-31T13:52:28+00:00 app[web.1]:   from /app/app/controllers/api_controller.rb:1:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>The line in \"api_controller.rb\" it is references is simply the \"analytical\" statement that initializes the gem in that controller, per the documentation.</p>\n\n<p>Tried putting \"analytical\" in application_controller instead and it errored out too (in both dev and staging).</p>\n\n<p>Totally stumped. Any help would be much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13120994,"title":"Migrating a Heroku Postgres Database from a Dev to Basic Plan","body":"<p>I've followed Heroku's guide on migrating my postgres database from a Dev to Basic Plan: <a href=\"https://devcenter.heroku.com/articles/migrating-from-a-dev-to-a-basic-database\" rel=\"nofollow\">https://devcenter.heroku.com/articles/migrating-from-a-dev-to-a-basic-database</a></p>\n\n<p>Everything seems to have gone well but i'm a little confused by the info below. Even though the new basic DB is showing some data, it's not showing any tables. The data size is also different. Before I remove my Dev DB, has anyone else seen the same? Can anyone explain what's happening here?</p>\n\n<pre><code>Ryans-MacBook-Pro:dashboard ryanberry$ heroku pg:info -a myapp(replaced with my app name)\n=== HEROKU_POSTGRESQL_BLUE (DATABASE_URL)\nPlan         Basic\nStatus       available\nConnections  4\nPG Version   9.1.5\nCreated      2012-10-29 10:51 UTC\nData Size    111.6 MB\nTables       0\nFork/Follow  Unavailable\n=== HEROKU_POSTGRESQL_CHARCOAL\nPlan         Dev\nStatus       available\nConnections  0\nPG Version   9.1.5\nCreated      2012-10-20 02:26 UTC\nData Size    112.4 MB\nTables       30\nRows         389702/10000 (Write access revoked)\nFork/Follow  Unavailable\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","dsl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":133,"score":0,"question_id":6813118,"title":"How to write a DSL that is not in isolation to the block's environment?","body":"<p>I am trying to write a small Ruby DSL and have stumbled upon an inconvenience. Right now my \"DSL\" code is <a href=\"https://gist.github.com/0379b07f516f4f322204\" rel=\"nofollow\">https://gist.github.com/0379b07f516f4f322204</a> and my implementation code (inside an .html.erb file) is:</p>\n\n<pre><code>html_table_for @users do |t, user|\n  t.field :username, link_to(user.username, :action =&gt; 'show', :id =&gt; user.id)\n  t.field :email\n  t.field :roles, user.roles.map(&amp;:code).join(', ')\nend\n</code></pre>\n\n<p>The implementation code does not look much like a DSL because of the <code>t.field</code> instead of simply <code>field</code>. By replacing <code>@block.call</code> in the DSL code (line 34) with <code>instance_exec(@block)</code> I almost get what I want but then I lose all the ActionView goodness (namely <code>link_to</code>).</p>\n\n<p><strong>Is there a way to make available in the block the instance methods of my little DSL class while at the same time keeping availability of the helper methods of ActionPack included in Rails?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13150334,"title":"How do I stop caching of layout in production with Ruby on Rails?","body":"<p>I'm building a rails app allows the admin to load (and reload) an .erb template that will function as a layout. i.e. the application.html.erb</p>\n\n<p>On occasion when updating an already created template to my hosted app the changes do not take effect. If I load a differently named file to the same template this does show the changes. </p>\n\n<p>This is not an issue in DEV on my local environment but is an issue for PROD. Is there a setting that controls the caching of the layout for a page? The dynamic content is no problem but the static layout does not change unless I restart the app. Please let me know if you have any brilliant insights about this issue, or if it needs greater explanation.</p>\n"},{"tags":["ruby-on-rails-3","image-processing","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13155789,"title":"Carrierwave in modules","body":"<p>This is my model in /app/library/stone.rb</p>\n\n<pre><code>class Library::Stone &lt; ActiveRecord::Base\n   attr_accessible :group, :healing, :life, :logo, :magic, :name, :other, :place,    :structure, :view\n\n   mount_uploader :logo, LogoUploader\n\n   before_save :cap_group\n\n   def cap_group\n     self.name = self.name.mb_chars.capitalize.to_s\n     self.group = self.name[0]\n   end\n\nend\n</code></pre>\n\n<p>This is the uploader /app/uploaders/logo_uploader.rb</p>\n\n<pre><code>class LogoUploader &lt; CarrierWave::Uploader::Base\n  storage :file\n\n  def store_dir\n     \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  version :thumb do\n    process :resize_to_limit =&gt; [200, 300]\n  end\n\nend\n</code></pre>\n\n<p>The problem is that this works in the console, but when I try it in the browser, the image is not uploaded properly. I think it is because somehow the </p>\n"},{"tags":["ruby-on-rails-3","amazon-ec2","hosting","project-management","costs"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":21,"score":0,"question_id":13158168,"title":"What are the costs of running high-load application?","body":"<p>I understand that maybe this question is not related directly to the theme of stack-overflow resource, but I consider this question as very important. </p>\n\n<p>I have prototype application written on ruby on rails. It is simple social network with a storage of files (users share their papers and collaborate on creation of new papers).</p>\n\n<p>So it is a commercial service oriented to scientists and universities, and I expect huge storage and huge traffic. I am expecting 100-200 thousand users with a storage usage of 10-20mb per active user in 2 years. Let's say the share of active users is 10% (10000-20000 users).</p>\n\n<p>I have never had experience of deploying high load projects, so I do not know the typical fixed costs and variable costs and possible pitfalls. \nMaybe you have an empirical evidence of how much such project could cost?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","full-text-search","sphinx","thinking-sphinx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13151921,"title":"Does Sphinx provide the capability to extract indexed information rather than hitting the database?","body":"<p>On a successful search will one be able to access the sphinx indexed data instead of hitting the database. </p>\n\n<p>Thinking Sphinx provides the a method to search and retrieve only the document ids through <code>ThinkingSphinx.search_by_ids</code>. Does it provide an API to retrieve only indexed data without hitting the database?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13157902,"title":"How to authenticate facebook user using devise through api?","body":"<p>I have devise for authentication and also i have added omniauth for facebook and twitter and now what i need is allow the user to login from iphone app</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'xxxxxxxx'}}\"\n</code></pre>\n\n<p>it gives out the token and user email if it is valid and incase not valid user it displays</p>\n\n<pre><code>{\"error\":\"Invalid email or password\"}\n</code></pre>\n\n<p>similarly how can i send the facebook id and password to check whether the user is valid or not?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","functional-testing","assert-response"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":11451080,"title":"Why \"assert_response\" ignores the custom message in Rails?","body":"<p>In my functional test I verify the response status like that:</p>\n\n<pre><code>assert_response :error, \"My error message\"\n</code></pre>\n\n<p>However, Rails ignores my custom message and reports:</p>\n\n<blockquote>\n  <p>Expected response to be a &lt;:error>, but was &lt;201></p>\n</blockquote>\n\n<p>Any ideas why?</p>\n\n<p>I use Rails 3.2.6.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13155510,"title":"Add DateTime offset in seconds","body":"<p>I have a DateTime in UTC, and would like add an offset which is provided in seconds</p>\n\n<pre><code>#json parsed - utc offset in seconds - turned into integer\n@utc_offset = result[\"UTCOffsetMillis\"].to_i\n#json parsed - utc date\nstart_date_string = result[\"startDate\"].split(\"-\")\nstart_date = DateTime.new(start_date_string[0].to_i, start_date_string[1].to_i,start_date_string[2].to_i)\n</code></pre>\n\n<p>How do I add this offset in seconds to start_date??</p>\n\n<p>Rails 3.2.3\nRuby 1.9.2p320</p>\n"},{"tags":["ruby-on-rails-3","html5"],"answer_count":1,"favorite_count":2,"up_vote_count":10,"down_vote_count":1,"view_count":252,"score":9,"question_id":11992995,"title":"Example on implementing HTML5 Server Side Event in Rails 3.2","body":"<p>I am trying to introduce HTML5 Server-Side-Event to my Rails 3.2 project. I did some search at Google.com, but most of the examples are using php. There's only one example on Rails that is using <code>Goliath</code>, and I am not using that.</p>\n\n<p>I am using <code>Thin</code> in my development and deploying with <code>passenger</code>. I think it's valid for doing text streaming for SSE. Is there any examples on Rails 3.2 for reference?</p>\n"},{"tags":["ruby-on-rails-3","elasticsearch","tire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13156218,"title":"elasticsearch / tire how to correctly return default recordset?","body":"<p>What would be the best way to approach the return of a default recordset? If no search results are returned. Currently using below code but it feels not the correct way. </p>\n\n<pre><code>def self.search(params)\n\n      puts \"SEARCH PARAM =\"\n      puts params\n\n      if params\n        tire.search(load: true, page: params[:page], per_page: 20, :default_operator =&gt; 'AND', :use_dis_max =&gt; true) do\n          query do\n            boolean do\n              must { string 'gamers:2' } if params[:gamers] == \"2\"\n              must { string 'gamers:4' } if params[:gamers] == \"4\"\n            end\n          end\n          to_curl\n        end\n      else\n        puts \"search params not found\"\n        @gamers = Gamers.where(:level =&gt; \"rookie\")\n      end\n    end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","integration-testing","capybara","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":249,"score":1,"question_id":9755185,"title":"Minitest integration testing: session not tearing down?","body":"<p>I recently switched a very simple rails app from rspec to minitest. I also use capybara and factory_girl.</p>\n\n<p>I have 3 separate integration test files, all of which involve logging the user in using something along the lines of:</p>\n\n<pre><code>before(:each) do\n  user = Factory(:user)\n  visit login_path\n  fill_in \"Email\", :with =&gt; user.email\n  fill_in \"Password\", :with =&gt; user.password\n  click_button \"Log in\"\nend\n</code></pre>\n\n<p>After I switched to minitest, it seems as if the sessions ceased to tear down after each test. For instance, I would test login using the above code in a test file named \"users_integration_test.rb\" and when it begins running another test file, say \"sessions_integration_test.rb\", the user is already logged in before I can log in again using the above code.</p>\n\n<p>My question is: Is this an intentional difference between rspec and minitest, and I simply need to logout the user after each test? Or did I make a mistake setting up minitest? </p>\n\n<p>I am using the same minitest_helper file as in the Minitest Railscast.</p>\n"},{"tags":["ruby-on-rails-3","wkhtmltopdf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":520,"score":1,"question_id":9567161,"title":"wkhtmltopdf not working (pdfkit)","body":"<p>I'm having trouble generating a PDF out of a html page.</p>\n\n<p>I'm using PDFkit. I installed also wkhtmltopdf following the installation instructions. In 'usr/local/bin/' there is now a file called 'wkhtmltopdf'</p>\n\n<p>When I run a pdf with PDFkit, it now gives an error:</p>\n\n<pre><code>command failed: \"/usr/local/bin/wkhtmltopdf\" \"--margin-right\" \"0.75in\" \"--page-size\" \"Letter\" \"--margin-top\" \"0.75in\" \"--margin-bottom\" \"0.75in\" \"--encoding\" \"UTF-8\" \"--margin-left\" \"0.75in\" \"--quiet\" \"-\" \"-\"\n</code></pre>\n\n<p>Also, when I try to generate a PDF directly it gives an error:</p>\n\n<pre><code>wkhtmltopdf --page-size A4--quiet http://localhost/invoices/22 -\n\n'/usr/local/bin/wkhtmltopdf: cannot execute binary file'\n</code></pre>\n\n<p>Any idea of what this could be?\nThis is how the PDFkit config file looks:</p>\n\n<pre><code>PDFKit.configure do |config|\n  config.wkhtmltopdf = '/usr/local/bin/wkhtmltopdf'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13154177,"title":"Rails test adding unwanted parameter to assert_redirected_to","body":"<p>I have a test in my functional test which asserts the redirect after a remove is correct:</p>\n\n<pre><code>assert_redirected_to terrain_tip_url(terrain_id: entities(:deroos))\n</code></pre>\n\n<p>This should result in testing whether the url is: <a href=\"http://test.host/terrains/:terrain_id/tips\" rel=\"nofollow\">http://test.host/terrains/:terrain_id/tips</a> and in the application that is the exact url that is generated. However, in the test case this results in the url being: <a href=\"http://test.host/terrains/:terrain_id/tips/:id\" rel=\"nofollow\">http://test.host/terrains/:terrain_id/tips/:id</a>, which results in a failing test case:</p>\n\n<pre><code>Expected response to be a redirect to &lt;http://test.host/terrains/446801721/tips/495319887&gt; but was a redirect to &lt;http://test.host/terrains/446801721/tips&gt;\n</code></pre>\n\n<p>Why does the terrain_tip_url include an id parameter that I never set? How can I prevent this from happening?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","view","localization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13153775,"title":"Why I can`t use symbol in Rails 3 view Lazy Lookup?","body":"<p>I have following table in view:</p>\n\n<pre><code># views/students/index.html.haml\n%table.table\n  %thead\n    %tr\n      %th=t :first_name  # doesn`t work\n      %th=t '.last_name' # works\n  %tbody\n    - @students.each do |s|\n      %tr\n        %td=s.first_name\n        %td=s.last_name\n</code></pre>\n\n<p>This is my locales file:</p>\n\n<pre><code>pl:\n  students:\n    index:\n      first_name: \"Imię\"\n      last_name: \"Nazwisko\"\n</code></pre>\n\n<p>Is possible to use symbols instead of string '.first_name' ??</p>\n"},{"tags":["ruby-on-rails","ruby","linux","ruby-on-rails-3","rubygems"],"answer_count":6,"favorite_count":6,"up_vote_count":26,"down_vote_count":0,"view_count":10646,"score":26,"question_id":4922700,"title":"Ruby 1.9.2 and Rails 3 cannot open rails console","body":"<pre><code>[gkaykck@main myApplication]$ rails console\n/usr/local/lib/ruby/1.9.1/irb/completion.rb:9:in `require': no such file to load -- readline (LoadError)\n    from /usr/local/lib/ruby/1.9.1/irb/completion.rb:9:in `&lt;top (required)&gt;'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands/console.rb:3:in `require'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands/console.rb:3:in `&lt;top (required)&gt;'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands.rb:20:in `require'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands.rb:20:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have installed rails 3 on ruby 1.9.2p136, which is ok i guess. But i cannot start rails console and it gives me the error i copied. The apps worked great with ruby 1.8.7 and i never saw an error like this.</p>\n\n<p>Any ideas what it could be?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13151176,"title":"NameError: undefined local variable or method in rspec for rails 3.2.8","body":"<p>There is a method assign_user_rights which is defined in application controller in rails 3.2.8 app. In applications_controller_spec.rb, there is a test case for the method:</p>\n\n<pre><code>   it \"should assign_user_right\" do\n      .....\n      assign_user_rights\n      session[:index_all_users].should be_true\n    end\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Failure/Error: assign_user_rights\n     NameError:\n       undefined local variable or method `assign_user_rights' for #&lt;RSpec::Core::ExampleGroup::Nested_1::Nested_4:0x57550e0&gt;\n</code></pre>\n\n<p>Since assign_user_rights is defined in application controller, it should be readily visible in its spec file. However it is not the case as we see. What could be the problem with the code? Thanks.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13152751,"title":"error occurred while bundle install","body":"<p>Fetching gem metadata from <a href=\"https://rubygems.org/\" rel=\"nofollow\">https://rubygems.org/</a>.........\nFetching gem metadata from <a href=\"https://rubygems.org/\" rel=\"nofollow\">https://rubygems.org/</a>..\nUsing rake (0.9.2.2) \nUsing i18n (0.6.1) \nUsing multi_json (1.3.6) \nUsing activesupport (3.2.7) \nUsing builder (3.0.3) \nUsing activemodel (3.2.7) \nUsing erubis (2.7.0) \nUsing journey (1.0.4) \nUsing rack (1.4.1) \nUsing rack-cache (1.2) \nUsing rack-test (0.6.2) \nUsing hike (1.2.1) \nUsing tilt (1.3.3) \nUsing sprockets (2.1.3) \nUsing actionpack (3.2.7) \nUsing mime-types (1.19) \nUsing polyglot (0.3.3) \nUsing treetop (1.4.10) \nUsing mail (2.4.4) \nUsing actionmailer (3.2.7) \nUsing arel (3.0.2) \nUsing tzinfo (0.3.33) \nUsing activerecord (3.2.7) \nUsing activeresource (3.2.7) \nUsing coffee-script-source (1.3.3) \nUsing execjs (1.4.0) \nUsing coffee-script (2.2.0) \nUsing rack-ssl (1.3.2) \nUsing json (1.7.5) \nUsing rdoc (3.12) \nUsing thor (0.16.0) \nUsing railties (3.2.7) \nUsing coffee-rails (3.2.2) \nUsing columnize (0.3.6) \nUsing commonjs (0.2.6) \nUsing debugger-ruby_core_source (1.1.3) \nInstalling debugger-linecache (1.1.2) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.</p>\n\n<pre><code>    /home/kapil/.rvm/rubies/ruby-1.9.3-p286/bin/ruby extconf.rb \n</code></pre>\n\n<p>checking for vm_core.h... no\nchecking for vm_core.h... no\nMakefile creation failed</p>\n\n<hr>\n\n<p>No source for ruby-1.9.3-p286 provided with debugger-ruby_core_source gem.</p>\n\n<hr>\n\n<p><strong>* extconf.rb failed *</strong>\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.</p>\n\n<p>Provided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/home/kapil/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\n    --with-ruby-dir\n    --without-ruby-dir\n    --with-ruby-include\n    --without-ruby-include=${ruby-dir}/include\n    --with-ruby-lib\n    --without-ruby-lib=${ruby-dir}/lib</p>\n\n<p>Gem files will remain installed in /home/kapil/.rvm/gems/ruby-1.9.3-p286/gems/debugger-linecache-1.1.2 for inspection.\nResults logged to /home/kapil/.rvm/gems/ruby-1.9.3-p286/gems/debugger-linecache-1.1.2/ext/trace_nums/gem_make.out\nAn error occurred while installing debugger-linecache (1.1.2), and Bundler cannot continue.\nMake sure that <code>gem install debugger-linecache -v '1.1.2'</code> succeeds before bundling.</p>\n\n<hr>\n\n<p>such problem occurred while bundle install . pls help </p>\n"},{"tags":["ruby-on-rails-3","apache","nginx"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":308,"score":1,"question_id":7008770,"title":"Nginx or Apache in RoR application?","body":"<p>I would like to ask which server to choose Apache or Nginx to host the application in RoR.\nThe whole works on a dedicated server 8 cores, 16GB of memory. The application is a content reader, with a fairly advanced file management. The most important criterion is the speed of serving content to the user.</p>\n"},{"tags":["ruby-on-rails-3","rails-routing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13148425,"title":"Avoid index url after failing create","body":"<p>When you create a User in rails through the create action, the url is changed to</p>\n\n<pre><code>http://myapplication.com/users with POST\n</code></pre>\n\n<p>before being redirected elsewhere. If validation fails, it appears that the above URL is retained. If you then refresh, you end up on the index page (as it's now a GET).</p>\n\n<p>I would expect if validation was failed the url would remain as</p>\n\n<pre><code>http://myapplication.com/users/new\n</code></pre>\n\n<p>As i don't have an index page, this is causing me problems. Is there a way to resolve this please?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":170,"score":0,"question_id":12263762,"title":"how to convert doc, docx files to pdf in ruby/rails","body":"<p>I'm working on a web app in rails that uses document files, that I need to convert it to pdf in a place in the project! I wanna a ruby or javascript convert doc, docx, and plain text as well to pdf file.</p>\n\n<p>My search get me to a lot of pdf generators gems like <a href=\"https://github.com/prawnpdf/prawn\" rel=\"nofollow\">prawn</a>, <a href=\"http://railscasts.com/episodes/220-pdfkit\" rel=\"nofollow\">pdfkit</a>. they are generating pdf from templates (html and css or from a code!).</p>\n\n<p>If not, is there any api or a documentations to read doc/docx formats so that I can write the converter myself !?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13133441,"title":"Testing Creation Variable Assignments in Rspec","body":"<p>I'm creating a rspec test to see if the instance variable in the create method retains the data built. However, my test doesn't work since I'm returned with this error...</p>\n\n<pre><code>Failure/Error: assigns[:micropost]should eq(@post)\nexpected: #&lt;Micropost id: 1, content: \"Hello there\", user_id: 1&gt;\ngot: #&lt;Micropost id: 2, content: \"Hello there\", user_id: 1&gt;\n</code></pre>\n\n<p>My rspec test is</p>\n\n<pre><code>describe ::MicropostsController do\n\nbefore :each do\n  @post = FactoryGirl.create(:micropost)\nend\n\nit \"tests the instance variable in create method\" do\n    post :create, micropost: FactoryGirl.attributes_for(:micropost)\n    assigns(:micropost).should eq(@post)\nend\n</code></pre>\n\n<p>My FactoryGirl file is</p>\n\n<pre><code>FactoryGirl.define do\n\n factory :micropost do\n\n  content \"Hello there Bob!\"\n  user_id \"1\"\n  #even if I got rid of the double quotations around 1, the stringify key error still \n  #pops up\n\n end\n\nend\n</code></pre>\n\n<p>Here is the micropost controller create action code...</p>\n\n<pre><code>def create\n\n@micropost = Micropost.new(params[:micropost])\n\n respond_to do |format|\n\n  if @micropost.save\n\n    format.html { redirect_to @micropost, notice: 'Micropost was successfully create.' \n    }\n\n  else\n\n    format.html { render action: \"new\" }\n\n  end\n\n end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13147616,"title":"Migrate legacy database users to Devise","body":"<p>We have an old PHP app in MySQL that we're currently rewriting in Rails and PostgreSQL.\nI'm looking for a way to migrate users one-by-one when they first sign in to the new system, so that we migrate only active users.</p>\n\n<p>Is there a hook in <strong>Devise</strong> that I can use to catch a failed login towards the new database and check if the user exists in the old MySQL database and migrate the user if found.</p>\n\n<p>BTW, the Rails app can access both databases and the migration code is already in place that accepts old <code>username</code> as input.</p>\n\n<p>Or should I just simply make a separate _migration_assistant_ page that accepts old logins and initiates the migration?</p>\n\n<p>PS. any user can possibly have thousands of database records to migrate so it can take a bit of time, but we already make use of PosgreSQL's <code>COPY FROM</code> to speed it up (about a few secs per account).</p>\n\n<p><strong>EDIT:</strong>\nThere are currently about <strong>5000</strong> users and we expect roughly <strong>1000</strong> of them to return to the new site.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13150792,"title":"Rails Query Returns Results First Time Only","body":"<p>I'm having an unusual problem in an application I am developing.</p>\n\n<p>I am writing a controller/view to generate a sitemap.xml resource. It works perfectly the first time I test it by viewing it in the browser.</p>\n\n<p>However the second time, when I refresh the view, no page results are returned and the sitemap is effectively empty.</p>\n\n<p>If I make a change to the code. It could be as little as adding a blank line, or removing it, then the sitemap is correctly generated the first time. Any additional refreshes are empty.</p>\n\n<p>This is the code:</p>\n\n<p>The sitemap controller</p>\n\n<pre><code>class SitemapController &lt; ApplicationController\n    layout nil\n\n    def index\n        @pages = Page.where(:publish =&gt; true)\n        @base_url = \"http://#{request.host_with_port}\"\n        headers['Content-Type'] = 'application/xml'\n        def index\n            respond_to do |format|\n                format.xml\n            end\n        end\n    end\nend\n</code></pre>\n\n<p>Here is sitemap.xml.erb</p>\n\n<pre><code>&lt;?xml version=\"1.0\" ?&gt;\n&lt;urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"&gt;\n&lt;% @pages.each do |page| %&gt;\n  &lt;url&gt;\n    &lt;loc&gt;&lt;%= \"#{@base_url}/#{page.permalink}\" %&gt;&lt;/loc&gt;\n    &lt;lastmod&gt;&lt;%= page.updated_at %&gt;&lt;/lastmod&gt;\n    &lt;priority&gt;0.5&lt;/priority&gt;\n  &lt;/url&gt;\n&lt;% end unless @pages.nil? %&gt;\n&lt;/urlset&gt;\n</code></pre>\n\n<p>and the route</p>\n\n<pre><code>match \"/sitemap.xml\", :to =&gt; \"sitemap#index\", :defaults =&gt; {:format =&gt; :xml}\n</code></pre>\n\n<p>The odd thing is that it seems to be in the query in the controller.</p>\n\n<pre><code>@pages = Page.where(:publish =&gt; true)\n</code></pre>\n\n<p>This returns nil on consecutive attempts, but a similar query in other parts of the app works every time. I have tried using alternative methods such as Page.all, and Page.find :all but the problem persists.</p>\n\n<p>I also uploaded this to the app on Heroku, wondering if it was something in my environment, but it happens there also.</p>\n"},{"tags":["jquery","ruby-on-rails-3","unobtrusive-javascript"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13150609,"title":"rails unobtrusive js and custom asset manifest files","body":"<p>I have a manifest file that looks as follows:</p>\n\n<pre><code># director.js\n\n//= require jquery\n//= require jquery_ujs\n//= require jquery-ui-1.8.22.custom.min\n//= require_tree ./tablet/director\n</code></pre>\n\n<p>which is pretty much the same as my application.js file except for the require_tree which points to another directory. My layout file looks has the following in the head:</p>\n\n<pre><code>= javascript_include_tag \"director\"\n</code></pre>\n\n<p>and I have pre compiled my assets in my environments/development.rb file using</p>\n\n<pre><code>config.assests.precompile += %w{ director.js }\n</code></pre>\n\n<p>yet for some reason my unobtrusive javascript isn't working. When I try to go to the delete action of a controller it looks for the show action, however opening firebug shows me that all the jquery files have been loaded. I really have no idea what is going on. Also when I change the javascript_include_tag to include \"application\" it works fine. I'm not sure what I have missed thats causing this. Any help would be great.</p>\n"},{"tags":["ruby","git","ruby-on-rails-3","configuration","heroku"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1112,"score":6,"question_id":4857031,"title":"GIt Deployment + Configuration Files + Heroku","body":"<p>I'm using Heroku to host a Rails app, which means using Git to deploy to Heroku. Because of the \"pure Git workflow\" on Heroku, anything that needs to go upstream to the server has to be configured identically on my local box.</p>\n\n<p>However I need to have certain configuration files be different depending on whether I'm in the local setup or deployed on Heroku. Again, because of the deployment method Heroku uses I can't use .gitignore and a template (as I have seen suggested many times, and have used in other projects).</p>\n\n<p>What I need is for git to somehow track changes on a file, but selectively tell git not to override certain files when pulling from a particular repo -- basically to make certain changes one-way only.</p>\n\n<p>Can this be done? I'd appreciate any suggestions!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","attributes","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13150272,"title":"Meaning for attributes_for in FactoryGirl and Rspec Testing","body":"<p>Looking through a tutorial on controller testing the author gives an example of an rspec test testing a controller action. My question is, why did they use the method <code>attributes_for</code> over <code>build</code>? There is no clear explanation why <code>attributes_for</code> is used besides that it returns a hash of values.</p>\n\n<pre><code>it \"redirects to the home page upon save\" do\n  post :create, contact: Factory.attributes_for(:contact)\n  response.should redirect_to root_url\nend\n</code></pre>\n\n<p>The tutorial link is found here: <a href=\"http://everydayrails.com/2012/04/07/testing-series-rspec-controllers.html\" rel=\"nofollow\">http://everydayrails.com/2012/04/07/testing-series-rspec-controllers.html</a> The example is found at the beginning topic section <code>Controller testing basics</code></p>\n"},{"tags":["ruby-on-rails-3","heroku","authorize.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":149,"score":1,"question_id":9322822,"title":"Why does my authorize.net transaction succeed but reports that it fails?","body":"<p>I am using Authorize.net with Rails on Heroku.  I have created a form to submit the request to Authorize.net using the online examples such as: </p>\n\n<p><a href=\"https://developer.authorize.net/integration/fifteenminutes/ruby\" rel=\"nofollow\">https://developer.authorize.net/integration/fifteenminutes/ruby</a></p>\n\n<p>I have created an account on Authorize.net, and built a form that submits to authorize.net like so (in haml):</p>\n\n<pre><code>%h3 Enter your credit card details\n= form_for :sim_transaction, :url =&gt; @gateway_url do |f|\n  = sim_fields(@sim_transaction)\n  = order_details(@order)\n  .fields\n    .field\n      = label_tag 'x_card_num', 'Credit Card Number'\n      = text_field_tag 'x_card_num', params[:x_card_num], :style =&gt; 'width:200px'\n    .field\n      = label_tag 'x_exp_date', 'Expiration Date (MMYY)'\n      = text_field_tag 'x_exp_date', params[:x_exp_date], :style =&gt; 'width:40px'\n    .action\n      = f.submit 'Confirm order'\n</code></pre>\n\n<p>The order_details is a helper method that creates hidden fields for first name, last name, etc. From the purchase order.</p>\n\n<p>When submitted, the order processed by authorize.net and the users credit card is charged, but the POST to the relay response indicates the sim_response failed and was not processed. </p>\n\n<pre><code>if **sim_response.success?**(AUTHORIZE_NET_CONFIG['api_login_id'], AUTHORIZE_NET_CONFIG['merchant_hash_value'])\n  render :text =&gt; sim_response.direct_post_reply(payments_receipt_url(:only_path =&gt; false), :include =&gt; true)\nelse\n  render\nend\n</code></pre>\n\n<p>The sim_response.success? call is false.  Or, more specifically, there are two tests in the success method and this part of the success? method is false:</p>\n\n<pre><code>sim_response.valid_md5?(AUTHORIZE_NET_CONFIG['api_login_id'], AUTHORIZE_NET_CONFIG['merchant_hash_value'])\n</code></pre>\n\n<p>The result code I get back is \"1\" - which means the transaction was processed.  That's the text I see as well.</p>\n\n<p>From my research, the valid_md5 method only happens when there is an incorrect api_login_id, but I don't think that's the case.  Would the transaction succeed if the login_id was incorrect?  Any other suggestions for tracking this down?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","checkout"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13143334,"title":"Basket IF arguments ROR","body":"<p>I am developing a rails app that includes a checkout basket and am in need of some basic help. </p>\n\n<p>I am struggling to integrate the logical arguments needed for some product pricing. What I would like to do is lower the price of the product if there are five or more products added to the cart. </p>\n\n<p>I currently have models and controllers for products, line_items, carts and orders with the typical associations.</p>\n\n<p>I am sure there is a simple <code>if and elseif</code> statement that I can define in a method but I would be interested to know how others else would go about implementing this as best practice? </p>\n\n<p>Thanks in advance for your help! Elle</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13147972,"title":"Pagination in Ruby when results fetched in a mySQL query","body":"<p>I fetch some rows in my Rails controller using the following query:</p>\n\n<pre><code>@main = connection.execute(\"SELECT code_ver, result FROM mastertest WHERE code_ver NOT LIKE '%DevBld%' AND date &gt;= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;\")\n</code></pre>\n\n<p>Now in my index.html.erb (View) I display these rows in form of a table.</p>\n\n<p>But I want to have next and previous buttons in my html page such that It should display only a few rows at a time. Lets assume a week's data at a time. </p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13149146,"title":"What is the best way to determine if a variable is a number in Ruby?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5661466/test-if-string-is-a-number-in-ruby-on-rails\">Test if string is a number in Ruby on Rails</a>  </p>\n</blockquote>\n\n\n\n<p>Currently I have this (awful) code:</p>\n\n<pre><code>def is_num(num_given)\n  begin\n    num_given.to_i\n    worked = true\n  rescue\n    worked = false\n  ensure\n    return worked\n  end\nend\n</code></pre>\n\n<p>Which I refactored to this:</p>\n\n<pre><code>def is_num(num_given)\n  num_given.to_i.is_a?(Numeric) rescue false\nend\n</code></pre>\n\n<p>This still just doesn't feel right to me, is there a better way to do this?</p>\n\n<p>Both of these implementations work fine for my purposes, I am just looking for some code euphoria. </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13149342,"title":"Rails: how can I write this so it won't fail if it returns nil?","body":"<p>I'm just not sure how best to write it. Cheers!</p>\n\n<pre><code>def get_prices(c)\n  @print_prices = Billing.where(:name =&gt; c).first.attributes.select{ |i| i.match(/^print_/) }\nend\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3","authentication","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13149384,"title":"Ruby on Rails: Devise Authentication with JavaScript","body":"<p>In my RoR project, the user could drag and drop a JavaScript link to the browser's bookmark manager/bar.</p>\n\n<p>The JavaScript link calls another JavaScript file, say <code>LoadUserData.js</code>.</p>\n\n<p>I'm using Devise for authentication.</p>\n\n<p>My question is: when the user click the bookmark:</p>\n\n<ol>\n<li>If the user has logged in, the user data will be loaded;</li>\n<li>Otherwise, the bookmark will redirect the user to the login page.</li>\n</ol>\n\n<p>How to implement it?</p>\n\n<p>Peter</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13149257,"title":"Ruby on Rails: polymorphic association with has_one/belongs_to","body":"<p>In my app I setup the M-N relation between the Item and Property models by using a join model PropertyValuations. Now, in the relation between an item and a property there will exist a value. However, I want that value to be stored a different table (NumericValue, TextualValue, etc).\nIs a polymorphic association a good approach for this?</p>\n\n<p>The idea would be to have something like this:</p>\n\n<pre><code>class PropertyValuation &lt; ActiveRecord::Base\n  attr_accessible :valuable\n  attr_accessor :valuable\n\n  belongs_to :property\n  belongs_to :item\n  belongs_to :valuable, :polymorphic =&gt; true  \nend\n\nclass NumericValue &lt; ActiveRecord::Base\n  attr_accessible :value # plus several other fields\n  has_one :property_valuation, :as =&gt; :valuable  \nend\n\nclass TextualValue &lt; ActiveRecord::Base\n  attr_accessible :value  \n  has_one :property_valuation, :as =&gt; :valuable\nend\n</code></pre>\n\n<p>However, this way I can only associate a value to a property_valuation record if I create the value first (where I was expecting to do something like <code>property_valuation.valuable = NumericValue.new(:value =&gt; 12345)</code>), and to obtain the value I can't use <code>property_valuation.valuable</code>, as it will return nil (even if valuable_id and valuable_type on property_valuation table are filled).\nWhat can I improve in my code to make everything work as expected? My migrations look like this:</p>\n\n<pre><code>class CreatePropertyValuations &lt; ActiveRecord::Migration\n  def change\n    create_table :property_valuations do |t|\n      t.references :item\n      t.references :property\n      t.references :valuable, :polymorphic =&gt; true\n\n      t.timestamps\n    end\n    add_index :property_valuations, :item_id\n    add_index :property_valuations, :property_id\n    add_index :property_valuations, :valuable_id\n  end\nend\n\nclass CreateNumericValues &lt; ActiveRecord::Migration\n  def change\n    create_table :numeric_values do |t|\n      t.decimal :value\n      t.references :property_valuation\n\n      t.timestamps\n    end\n  end\nend\n\n\nclass CreateTextualValues &lt; ActiveRecord::Migration\n  def change\n    create_table :textual_values do |t|\n      t.text :value\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["mysql","ruby-on-rails-3","activerecord","imagemagick","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13148448,"title":"rake failure due to imagemagick","body":"<p>I'm seeding a development database (mysql) using <code>rake db:seed</code> in Rails 3. The rake task fails, stating, </p>\n\n<blockquote>\n  <p>Validation failed: Logo /var/folders/.../logo.png is not recognized by the 'identify' command.</p>\n</blockquote>\n\n<p>When I run <code>which identify</code>, I get the expected path <code>/usr/local/bin/identify</code>. ImageMagick is indeed installed (via Homebrew), and <em>appears</em> to work with png images just fine from the command line.</p>\n\n<p>I even rebuilt the app on another machine, thinking that my environment is borked,  and I got the same error.</p>\n\n<p>Is there a poltergeist in my terminal sessions?</p>\n"},{"tags":["ruby-on-rails-3","count","limit","has-many-through","custom-validators"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13094227,"title":"Rails validation count limit on has_many :through","body":"<p>I've got the following models: Team, Member, Assignment, Role</p>\n\n<p>The Team model has_many Members. Each Member has_many roles through assignments. Role assignments are Captain and Runner. I have also installed devise and CanCan using the Member model.</p>\n\n<p>What I need to do is limit each Team to have a max of 1 captain and 5 runners.</p>\n\n<p>I found this <a href=\"http://stackoverflow.com/questions/9932445/rails-accepts-nested-attributes-count-validation\">example</a>, and it seemed to work after some customization, but on update ('teams/1/members/4/edit'). It doesn't work on create ('teams/1/members/new'). But my other validation (validates :role_ids, :presence => true\n) does work on both update and create. Any help would be appreciated.</p>\n\n<p><strong>Update:</strong> I've found this <a href=\"http://stackoverflow.com/questions/1270663/validate-max-amount-af-associated-objects\">example</a> that would seem to be similar to my problem but I can't seem to make it work for my app.</p>\n\n<p>It seems that the root of the problem lies with how the count (or size) is performed before and during validation. </p>\n\n<p>For Example:</p>\n\n<p>When updating a record... \nIt checks to see how many runners there are on a team and returns a count. (i.e. 5) Then when I select a role(s) to add to the member it takes the known count from the database (i.e. 5) and adds the proposed changes (i.e. 1), and then runs the validation check. (Team.find(self.team_id).members.runner.count > 5) This works fine because it returns a value of 6 and 6 > 5 so the proposed update fails without saving and an error is given.</p>\n\n<p><strong>But</strong> when I try to create a new member on the team...\nIt checks to see how many runners there are on a team and returns a count. (i.e. 5) Then when I select a role(s) to add to the member it takes the known count from the database (i.e. 5) and then runs the validation check <strong>WITHOUT</strong> factoring in the proposed changes. This doesn't work because it returns a value of 5 known runner and 5 = 5 so the proposed update passes and the new member and role is saved to the database with no error.</p>\n\n<p>Member Model:</p>\n\n<pre><code>class Member &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  attr_accessible :password, :password_confirmation, :remember_me\n  attr_accessible :age, :email, :first_name, :last_name, :sex, :shirt_size, :team_id, :assignments_attributes, :role_ids\n  belongs_to :team\n  has_many :assignments, :dependent =&gt; :destroy\n  has_many :roles, through: :assignments\n    accepts_nested_attributes_for :assignments\n\n  scope :runner, joins(:roles).where('roles.title = ?', \"Runner\")\n  scope :captain, joins(:roles).where('roles.title = ?', \"Captain\")\n\n  validate :validate_runner_count\n  validate :validate_captain_count\n  validates :role_ids, :presence =&gt; true\n\n  def validate_runner_count\n     if Team.find(self.team_id).members.runner.count &gt; 5\n       errors.add(:role_id, 'Error - Max runner limit reached')\n     end\n  end\n\n  def validate_captain_count\n     if Team.find(self.team_id).members.captain.count &gt; 1\n       errors.add(:role_id, 'Error - Max captain limit reached')\n     end\n  end\n\n  def has_role?(role_sym)\n    roles.any? { |r| r.title.underscore.to_sym == role_sym }\n  end\n\nend\n</code></pre>\n\n<p>Member Controller:</p>\n\n<pre><code>class MembersController &lt; ApplicationController\n  load_and_authorize_resource :team\n  load_and_authorize_resource :member, :through =&gt; :team\n\n  before_filter :get_team\n  before_filter :initialize_check_boxes, :only =&gt; [:create, :update]\n\n  def get_team\n    @team = Team.find(params[:team_id])\n  end\n\n  def index\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @members }\n    end\n  end\n\n  def show\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @member }\n    end\n  end\n\n  def new\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @member }\n    end\n  end\n\n  def edit\n\n  end\n\n  def create\n    respond_to do |format|\n      if @member.save\n        format.html { redirect_to [@team, @member], notice: 'Member was successfully created.' }\n        format.json { render json: [@team, @member], status: :created, location: [@team, @member] }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @member.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def update\n    respond_to do |format|\n      if @member.update_attributes(params[:member])\n        format.html { redirect_to [@team, @member], notice: 'Member was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @member.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def destroy\n    @member.destroy\n\n    respond_to do |format|\n      format.html { redirect_to team_members_url }\n      format.json { head :no_content }\n    end\n  end\n\n  # Allow empty checkboxes\n  # http://railscasts.com/episodes/17-habtm-checkboxes\n  def initialize_check_boxes \n    params[:member][:role_ids] ||= [] \n  end\n\nend\n</code></pre>\n\n<p>_Form Partial</p>\n\n<pre><code>&lt;%= form_for [@team, @member], :html =&gt; { :class =&gt; 'form-horizontal' } do |f| %&gt;\n\n  #...\n\n  # testing the count...\n    &lt;ul&gt;\n    &lt;li&gt;Captain - &lt;%= Team.find(@member.team_id).members.captain.size %&gt;&lt;/li&gt;\n    &lt;li&gt;Runner - &lt;%= Team.find(@member.team_id).members.runner.size %&gt;&lt;/li&gt;\n    &lt;li&gt;Driver - &lt;%= Team.find(@member.team_id).members.driver.size %&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n\n    &lt;div class=\"control-group\"&gt;\n      &lt;div class=\"controls\"&gt;\n      &lt;%= f.fields_for :roles do %&gt;\n      &lt;%= hidden_field_tag \"member[role_ids][]\", nil %&gt;\n        &lt;% Role.all.each do |role| %&gt;\n          &lt;%= check_box_tag \"member[role_ids][]\", role.id, @member.role_ids.include?(role.id), id: dom_id(role) %&gt;\n          &lt;%= label_tag dom_id(role), role.title %&gt;\n        &lt;% end %&gt;\n      &lt;% end %&gt;\n     &lt;/div&gt; \n    &lt;/div&gt;\n\n  #...\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","actionscript-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13125566,"title":"How to read a jpg bytearray from a Flash AS3 file","body":"<p>I'm trying to save an image from a Flash AS3 to my server as a jpg file. I found some PHP code to do this, but I want to do this in Ruby. I'm not quite sure how to convert the following code to Ruby. It's mainly the <code>$GLOBALS[\"HTTP_RAW_POST_DATA\"]</code> part I don't know how to convert.</p>\n\n<pre><code>&lt;?php\n\n   if ( isset ( $GLOBALS[\"HTTP_RAW_POST_DATA\"] )) {\n\n      // get bytearray $im = $GLOBALS[\"HTTP_RAW_POST_DATA\"];\n\n      // save image $f = fopen($_GET['name'], 'wb'); fwrite($f, $jpg); fclose($f);\n\n   } else echo 'An error occured.';\n\n?&gt;\n</code></pre>\n\n<p>source:</p>\n\n<p><a href=\"http://designreviver.com/tutorials/actionscript-3-jpeg-encoder-revealed-saving-images-from-flash/\" rel=\"nofollow\">http://designreviver.com/tutorials/actionscript-3-jpeg-encoder-revealed-saving-images-from-flash/</a></p>\n\n<p>I tried to do the following, but the resulted image file dose not open</p>\n\n<pre><code>temp_file = Tempfile.new(['temp', '.jpg'], :encoding =&gt; 'ascii-8bit')\ntemp_file.write(request.raw_post)\ntemp_file.close\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>The image data is in <code>request.raw_post</code></p>\n\n<p><strong>EDIT2</strong></p>\n\n<p>As for the image being sent, here is how the header is created in AS3</p>\n\n<pre><code>var header:URLRequestHeader = new URLRequestHeader(\"Content-type\", \"application/octet-stream\");\nvar saveJPG:URLRequest = new URLRequest(\"http://127.0.0.1:3000/save_image.xml\");\nsaveJPG.requestHeaders.push(header);\n</code></pre>\n\n<p>saveJPG.method = URLRequestMethod.POST;</p>\n"},{"tags":["ruby-on-rails-3","json"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13148695,"title":"Rails 3: Importing records and their has_many associations from one app to another using json","body":"<p>Let's assume I've got two Rails apps with databases having the exact same schema and models. I want to be able to import some records from one database to the other. For example, what if I've got an Students table, and would like to retrieve one student from one db to the other?</p>\n\n<p>I've been sending the student json representation (<code>self</code> is a student):</p>\n\n<pre><code>student_json = self.as_json(:include =&gt; [\n                                 { :final_grade_batches =&gt; { :include =&gt; { :final_grade =&gt; { :include =&gt; :gradeable } } } }\n                            ])\n</code></pre>\n\n<p>from app 2 to app 1. This works when I don't include associations defined with has_many, but when I do, as in the example above, I receive the following message instantiating the student (<code>Student.new(params[:student])</code>) where params[:student] is the json retrieved from the other app:</p>\n\n<pre><code>ActiveRecord::AssociationTypeMismatch: FinalGradeBatch(#2159093540) expected, got Hash(#2151972720)\n</code></pre>\n\n<p>Of course, I've got <code>has_many :final_grade_batches</code> in the Student Model.</p>\n\n<p>Any help? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":449,"score":2,"question_id":10970973,"title":"mongoid, how to merge result with map/reduce","body":"<p>I try to use out reduce but I do not know how to call output .\nExample: </p>\n\n<pre><code>@results = Article.collection.map_reduce(map, reduce, :out =&gt; 'test')\n\n@results.find()\n =&gt; &lt;Mongo::Cursor:0x2c276c4 namespace='myapp_development.test' @selector={} @cursor_id=&gt; \n</code></pre>\n\n<p>When I try : </p>\n\n<pre><code>@results1 = Article.collection.map_reduce(map, reduce, :out =&gt;{reduce: 'test'}\n</code></pre>\n\n<p>Expected result is duplicate @results. But I run @results1.find().to_a I see it equal with @results</p>\n\n<p>And how can I call result by namespace in rubyrails using mongoid ??</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3001,"score":0,"question_id":7340448,"title":"Devise & omniauth Facebook authentication in Rails 3.1","body":"<p>I've followed <a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">this guide</a> for getting Devise Facebook authentication to work and I've now come to a point where I can't understand and I would like some help.</p>\n\n<p>I get the Sign in with Facebook link but clicking on it I get the following error, telling me there's something wrong with the routes</p>\n\n<blockquote>\n  <p>Unknown action</p>\n  \n  <p>Could not find devise mapping for path \"/users/auth/facebook\". Maybe you forgot to wrap your route inside the scope block? For example: devise_scope :user do match \"/some/route\" => \"some_devise_controller\" end</p>\n</blockquote>\n\n<p>Here is my routes file</p>\n\n<pre><code>  devise_for :users, :controllers =&gt; { :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" }\n  get '/users/auth/:provider' =&gt; 'users/omniauth_callbacks#passthru'\n  root :to =&gt; 'home#index'\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Solved that issue by changing the routes to</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" } do\n  get '/users/auth/:provider' =&gt; 'users/omniauth_callbacks#passthru'\nend\nroot :to =&gt; 'home#index'\n</code></pre>\n\n<p>Now I got the next error getting the Facebook auth to work but when coming back from the \"Allow app screen\" ruby throws...</p>\n\n<blockquote>\n  <p>undefined method `closed?' for nil:NilClass</p>\n  \n  <p>activesupport (3.1.0.rc8) lib/active_support/whiny_nil.rb:48:in <code>method_missing'\n  /opt/local/lib/ruby/1.8/net/http.rb:1060:in</code>request'\n  faraday (0.6.1) lib/faraday/adapter/net_http.rb:51:in <code>call'\n  faraday (0.6.1) lib/faraday/request/url_encoded.rb:14:in</code>call'\n  faraday (0.6.1) lib/faraday/request.rb:88:in <code>run'\n  faraday (0.6.1) lib/faraday/request.rb:28:in</code>run'\n  faraday (0.6.1) lib/faraday/connection.rb:170:in <code>run_request'\n  oauth2 (0.4.1) lib/oauth2/client.rb:63:in</code>request'</p>\n  \n  <p>...</p>\n</blockquote>\n\n<p>This is using Rails 3.1.0rc8 and ruby 1.9.2</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13147862,"title":"undefined method for nil class in rails 3","body":"<p>I keep getting the above error message when trying to view data from my model in my view (the index page of my controller)</p>\n\n<p>my controller</p>\n\n<pre><code> def index\n\n @recipe = Recipe.all\n\n end\n</code></pre>\n\n<p>my view</p>\n\n<pre><code>   &lt;% @recipes.each do |r| %&gt;\n   &lt;tr&gt;&lt;td&gt;&lt;%= r.dish_name %&gt;&lt;/td&gt;&lt;/tr&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Im new to rails so maybe doing this completely wrong. Could someone also explain what the error means?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails-3","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13147909,"title":"Mongoid Observer for a specific field?","body":"<p>In the model, I know you can assign callbacks to specific fields (i.e. <code>value1</code>), like this:</p>\n\n<pre><code>after_save :run_callback_1, :if =&gt; :value1_changed?\n</code></pre>\n\n<p>Can this happen in the Observer so it's called if <code>user.value1</code> is changed? Or if <code>value1</code> of multiple models have changed?</p>\n\n<pre><code>class UserObserver &lt; Mongoid::Observer\n\n  def after_save(record)\n    logger.debug \"HERE\"\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord","mass-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13147708,"title":"ActiveRecord transaction does not rollback","body":"<p>I'm new to ActiveRecord transactions. In the code below the first update_attributes causes a WARNING: Can't mass-assign protected attributes: account_type_cdx and that is ok. But I was surprised that the next line self.update_attributes!(:purchased => true) is executed and stored in the DB. I was expecting it to ROLLBACK because the first one failed.</p>\n\n<p>I must be missing something...\nAny hints?</p>\n\n<pre><code>def complete_purchase(current_user_id, plan_name)\n    Rails.logger.debug \"COMPLETE PURCHASE\"\n    user = User.find(current_user_id)\n    ActiveRecord::Base.transaction do\n        user.update_attributes!(:account_type_cdx =&gt; plan_name.to_sym)\n        self.update_attributes!(:purchased =&gt; true)\n    end\nend\n</code></pre>\n\n<p>I followed the advices from this post: <a href=\"http://markdaggett.com/blog/2011/12/01/transactions-in-rails/\" rel=\"nofollow\">http://markdaggett.com/blog/2011/12/01/transactions-in-rails/</a></p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","user-interface"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13147846,"title":"Rails sign up, edit more thorough than new","body":"<p>I'd like to make it easy for users to sign up for my rails app (only 2 fields, username and password), but when they edit their information, I'd like to give them the opportunity to store much more data.  I don't want to ask them everything up front as I don't want to dissuade account creation.</p>\n\n<p>What's the rails way of doing this correctly (and best UI way)?  Should I... </p>\n\n<ul>\n<li>Initialize all except username + password with null values, or default values, and display those as incentive to replace with accurate information?  (Seems wrong.)</li>\n<li>Have a nested model, \"Profile,\" belonging to \"User\" that I ask them to fill out after signing up?  What do I display for the Profile for the User before they do that?  (This seems to bring me back to the \"seems wrong\" of (1) above.</li>\n<li>Some sort of wizard thing and force them to answer all my questions before displaying anything?</li>\n<li>Create a basically empty profile that displays nothing, but has in-line editing when they do update the null information?  (Is the data actually null before that, or something else?)  If so, does the form get embedded in the User#show controller then?  How?</li>\n</ul>\n\n<p>Also, if I want my form to be sleek and AJAXy, is that a consideration that changes anything?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mobile","view-helpers"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13147837,"title":"Conditional inclusion of rails view helper file?","body":"<p>I'm developing a mobile version of my site and want to separate out the mobile view helpers from my non-mobile view helpers.</p>\n\n<p>I know I could simply namespace them and include the helper file, or prefix every method with mobile_, but that's simply silly.  What I want to do is something like this:</p>\n\n<pre><code>helper :desktop, unless: is_mobile_device?\nhelper :mobile, if: is_mobile_device?\n</code></pre>\n\n<p>but can't seem to find a way to do this.  This way I can have a <code>def title</code> method in both but they are handled differently depending on mobile or not, for example.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13147657,"title":"Rails joker has_one username, dancer has_one username","body":"<p>In my rails app, I have a username model that is polymorphically attached to 2 models joker and dancer.</p>\n\n<p>When creating a Joker, form sends a string that is the username for Joker. How should I go about setting this up so that rails does not throw an error when receiving a string instead of an AR object, for username?</p>\n\n<p>Here is the code I have now.</p>\n\n<pre><code>class Joker &lt; ActiveRecord::Base\n  attr_accessible :username\n\n  has_one :username\nend\n</code></pre>\n\n<p>and in create of Jokers_controller</p>\n\n<pre><code>@joker = Joker.new(params[:joker])\n</code></pre>\n\n<p>Rails throws this error:</p>\n\n<pre><code>Username(#19110) expected, got String(#9130)\n</code></pre>\n\n<p>So this is the form field</p>\n\n<pre><code>= form_for @joker do |f|\n  - if @joker.errors.any?\n    #error_explanation\n      h2 = \"#{pluralize(@joker.errors.count, \"error\")} prohibited this joker from being saved:\"\n      ul\n        - @joker.errors.full_messages.each do |message|\n          li = message\n\n\n  = f.text_field :username\n</code></pre>\n"},{"tags":["ruby-on-rails-3","validation","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13147459,"title":"Rails 3: create_association fails validation and deletes previous associated record","body":"<p>Let's assume I have two models.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :blog\nend\n\nclass Blog &lt; ActiveRecord::Base\n  belongs_to :user\n\n  validates_presence_of :user\n  validates_uniqueness_of :user_id\nend\n</code></pre>\n\n<p>Let's assume I have one user with a blog. For some reason, let's pretend I call <code>create_blog</code> for the same user (I know it should not be an option since the user already has a blog). If this blog doesn't pass the validations, and it won't, not only isn't saved, but it deletes the previous blog the user has.</p>\n\n<p>Why is this happening? Why the initial blog gets deleted? Is this behavior expected or is there something I missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13144624,"title":"Use Rails’ form_for but set custom classes, attributes on <form> element?","body":"<p><code>form_for</code> seems to ignore any 'extra' attributes like a <code>data-foo</code> attribute or <code>class</code> passed as <code>options</code> in its second argument.</p>\n\n<pre><code>= form_for @user, {:url =&gt; 'foo', :class =&gt; 'x', 'data-bar' =&gt; 'baz' } do |f|\n  # ...\n</code></pre>\n\n<p>The output is a <code>&lt;form&gt;</code> tag with no <code>x</code> class or <code>data-bar</code> attribute.</p>\n\n<p>What’s the fix?</p>\n\n<p>Or, how can I grab a <code>FormBuilder</code> instance without using <code>form_for</code>?</p>\n"},{"tags":["jquery","html","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13146318,"title":"How to avoid keeping html elements when saving text from a content editable div","body":"<p>I have a content editable div where users can enter their bio and then save the information. I use a form submit and the data I submit is <code>$('#bio').html()</code> where the bio tag has the attribute content editable. All of this works very well unless the user hits enter and then it creates a div tag and/or a <code>&lt;br&gt;</code>, which are saved as the user's bio and then displayed with the html elements intact, which looks sloppy. </p>\n\n<p>I am looking for either for some way of saving only the text or a way of display only the text. Ideally, I would like to be able to keep the new line without displaying the <code>&lt;div&gt;</code> or <code>&lt;br&gt;</code>. </p>\n\n<p>If this is at all useful, I am using Ruby-on-Rails 3.</p>\n\n<p>Thanks, Welles</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","actionview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13147000,"title":"Get actual object Rails","body":"<p>I have two forms in my new view, one is for the product and the other is for fotos. \nWhen I upload the fotos with a select.file field, these are created by Ajax call by a file create.js.erb then when I fill the others fields to the product I've another button to create it. So I have two forms and one way to create each one.</p>\n\n<p>The problem is the ID, the solution that I've found was to create an object before the user enter to the new view, so I have this code:</p>\n\n<p>Product's controller:</p>\n\n<pre><code>def new\n      @product = current_user.products.create\nend\n</code></pre>\n\n<p>It creates an object nil, now I can create my Foto to that object, like this:</p>\n\n<p>Painting's controller:</p>\n\n<pre><code>def create\n   @product = Product.last\n   @painting = @product.paintings.create(params[:painting])\nend\n</code></pre>\n\n<p>The problem is the line \"@product = Product.last\", I know that it isn't the right solution, because when I try the edit action, and when I try to create new objects it goes to the last product and not to the actual edit product.</p>\n\n<p>How can I find that current product at my new action???</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13120837,"title":"Order by two things in two different styles","body":"<p>Theoretically what I want is this:<br>\n<code>:order =&gt; \"column1 ASC, column2 DESC\"</code></p>\n\n<p>But column1 is actually not a column in my case but an aggregated value:<br>\n<code>:order =&gt; relations.count</code></p>\n\n<p>How can I order by two columns when one of those is actually an aggregated value?</p>\n\n<p>Btw: Counter-Cache is not an option (because it is outdated when I need it)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13147403,"title":"Accessing HTML tags in a RUBY Controller","body":"<p>I have the following code in my HTML.erb</p>\n\n<pre><code>&lt;form&gt;\n   &lt;input id=\"do\" type=\"hidden\" value=\"0\" /&gt;\n   &lt;button type=\"submit\" value=\"Next\"&gt;SUBTRACT&lt;/button&gt;\n&lt;/form&gt;\n&lt;form&gt;\n  &lt;input id=\"do\" type=\"hidden\" value=\"1\" /&gt;\n  &lt;button type=\"submit\" value=\"Next\" &gt;ADD&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Now When I click the any of the 2 buttons, I want to check the value of the input id=\"do\" inside my Ruby Controller. What would the syntax look like ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":20,"score":4,"question_id":13147277,"title":"Rails: path of file","body":"<p>I have inside <code>app</code> a directory called <code>csv</code> and inside this dir I have a file called <code>names.csv</code>\nI want to use <code>File.read(path:string)</code> function to read the file.<br>\nwhat is the relative path to the file?  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13135647,"title":"How to specify a controller and action in form to create new resources","body":"<p>I have QuestionsController and TrueFalseQuestionsController. I built a form to create question true/false, this is my form:</p>\n\n<pre><code>&lt;%= simple_form_for @question, defaults: { error: false } do |question_form| %&gt;\n  &lt;fieldset&gt;\n    &lt;legend&gt;Question&lt;/legend&gt;\n    &lt;%= render 'shared/error_messages', object: question_form.object %&gt;\n    &lt;%= question_form.input :content, input_html: { rows: 3, class: 'span6' } %&gt;\n    &lt;%= question_form.input :mark, input_html: { class: 'span1' } %&gt;\n    &lt;%= question_form.association :topic %&gt;\n\n    &lt;%= question_form.simple_fields_for :answers do |answer_form| %&gt;    \n      &lt;%= answer_form.input :correct,\n            collection: [[true, 'True'], [false, 'False']],\n            as: :radio_buttons,\n            label: 'Answer',\n            value_method: :first,\n            label_method: :last,\n            item_wrapper_class: 'inline' %&gt;\n    &lt;% end %&gt;\n  &lt;/fieldset&gt;\n\n    &lt;%= question_form.button :submit, class: 'new_resource' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Now when I submit the form, it uses create action in QuestionsController, so how can I specify form to use create action in TrueFalseQuestionsController?</p>\n"},{"tags":["ajax","ruby-on-rails-3","redirect"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13147070,"title":"Rails 3: redirect_to with :remote => true","body":"<p>I have a delete link that makes a remote call:</p>\n\n<pre><code>&lt;%= link_to image_tag(\"trash.png\"), [current_user, bookcase], method:  :delete, :remote =&gt; true, confirm: \"You sure?\", title:   bookcase.image %&gt;\n</code></pre>\n\n<p>In my controller, I end the delete function with a redirect:</p>\n\n<pre><code>def destroy\n  @bookcase.destroy\n  redirect_to current_user\nend\n</code></pre>\n\n<p>This works, except it's redirecting the user to the 'user/show.html.erb' file instead of the 'user/show.js.erb' file. How can I redirect the user, specifying which format to use?</p>\n"},{"tags":["ruby-on-rails-3","mutual-exclusion"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13056737,"title":"Mutex in rails API among several client request","body":"<p>I face a problem with mutual exclusion in my rails API.\nI have some Event object in my database which contain the number of person who will attend the event.</p>\n\n<p>Consider my Event method which add a person to the event :</p>\n\n<pre><code>class Event\n    def add_person\n        nb = self.number_of_person + 1\n        # Some stuff\n        self.number_of_person = nb\n        self.save\n    end\nend\n</code></pre>\n\n<p>Now, imagine that client A and B want to participate in the event E.\nRails is gonna receive 2 request and will call the add_person method in parallel.\nAt the end, it is possible that the number of person in the Event E be not incremented by 2 but by 1.</p>\n\n<p>This is what I want to be able to do :</p>\n\n<pre><code>Client A                 | Client B                 | Possible in parallel\n--------------------------------------------------------------------------\nEvent.find(1).show       | Event.find(1).show       | yes\nEvent.find(1).add_person | Event.find(1).add_person | no\nEvent.find(1).add_person | Event.find(2).add_person | yes\n</code></pre>\n\n<p>I only want to queue the <code>add_person</code> method on the same object.</p>\n\n<p>Is there a way to do this ?</p>\n"},{"tags":["ruby-on-rails-3","sendfile"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2797,"score":0,"question_id":6019522,"title":"Rails 3 - how to send_file in response of a remote form in rails?","body":"<p>I have this coupon form</p>\n\n<pre><code>    &lt;%form_for(:download,:download,:url=&gt;{:controller=&gt;\"coupons\",:action=&gt;\"verifycoupon\"},:remote=&gt;true) do |f| %&gt;\n    &lt;%=text_field :download,:code%&gt;\n    &lt;%=f.submit \"verify\"%&gt;\n    &lt;%end%&gt;\n</code></pre>\n\n<p>and after validating the code on the controller's action i have a confirmation like:</p>\n\n<pre><code>render :update do |page|\n    page.alert \"OK\"\nend\n</code></pre>\n\n<p>Now I want to send a file to the browser with the <code>send_file</code> instruction but nothing seems to happen</p>\n\n<pre><code>send_file(\"/path/to/my/file.extension\")\n</code></pre>\n\n<p>and in the log I can see</p>\n\n<pre><code>\"Sent file /path/to/my/file.extension (0.1ms)\"\n</code></pre>\n\n<p>I was wondering if there's something like</p>\n\n<pre><code>render :update do |page|\n   page.send_file(\"/path/to/my/file.extension\")\nend\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code>#### Update #######\n</code></pre>\n\n<p>my Controller's action looks something like</p>\n\n<pre><code>def verifycoupon\n   code = Code.find(params[:download][:code])\n   if code\n     if code.is_active?\n     render :update do |page|\n        page.alert \"ok\"\n     end\n       send_file(\"/path/to/my/file.extension\")\n     else\n       render :update do |page|\n          page.alert \"this code has already been used\"\n       end\n     end\n   else\n   render :update do |page|\n     page.alert \"Code does't exist\"\n   end\n   end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13140604,"title":"Association won't save inside of before_validation","body":"<p>I'm trying to use the before_validation callback to adjust the number of child objects for a record, but for some reason, its not working the way I expect. </p>\n\n<p>LineItem class:</p>\n\n<pre><code> before_validation :adjust_enrollment_count\n\n def adjust_enrollment_count\n    if enrollments.size &lt; quantity \n      (enrollments.size+1..quantity).each do |li|\n        self.enrollments.build(variant: self.variant)\n      end\n      #self.save\n    elsif enrollments.size &gt; quantity\n      enrollments.delete_if do |e| \n        enrollments.size &gt; quantity\n      end\n    end\n  end\n</code></pre>\n\n<p>What happens is that it creates the correct number of Enrollment objects as children to the LineItem, but the Variant gets set to nil (even though the LineItem has a variant defined).</p>\n\n<p>Things I've tried:</p>\n\n<ul>\n<li>Explicitly saving the line_item or the enrollment </li>\n<li>\"pry\"ing into the callback and running the code manually (this actually worked the way\nI expected!)     </li>\n<li>Verifying that \"self\" referred to the LineItem and not the closure</li>\n</ul>\n\n<p>Is there something about the callback lifecycle that I'm missing? Is there a better way to adjust the number of Enrollment objects as the quantity changes on the LineItem?</p>\n"},{"tags":["windows","ruby-on-rails-3","paperclip","crop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12559769,"title":"error facing while cropping photo using Paperclip in Rails 3","body":"<p>Hi i am trying to crop photo using paperclip and imagemagick. I am facing some error while cropping photo. following is the error stack:</p>\n\n<pre><code>?[32mCommand?[0m :: convert \"C:/Users/Anand/AppData/Local/Temp/120120924-3568-tx\n2bxy.jpg[0]\" -crop 103x103+0+0 -auto-orient \"C:/Users/Anand/AppData/Local/Temp/1\n20120924-3568-tx2bxy20120924-3568-16dij9c\"\n?[32mCommand?[0m :: file -b --mime \"C:/Users/Anand/AppData/Local/Temp/120120924-\n3568-tx2bxy20120924-3568-16dij9c\"\n[paperclip] Error while determining content type: Cocaine::CommandNotFoundError\n?[32mCommand?[0m :: identify -format %wx%h \"C:/Users/Anand/AppData/Local/Temp/12\n0120924-3568-tx2bxy.jpg[0]\"\n  ?[1m?[36m (0.0ms)?[0m  ?[1mrollback transaction?[0m\nCompleted 500 Internal Server Error in 145552ms\n\nNoMethodError (undefined method `exitstatus' for nil:NilClass):\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/controllers/users_controller.rb:67:in `block in update'\n  app/controllers/users_controller.rb:66:in `update'\n\n\n  Rendered E:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispa\ntch/middleware/templates/rescues/_trace.erb (10.0ms)\n  Rendered E:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispa\ntch/middleware/templates/rescues/_request_and_response.erb (1.0ms)\n  Rendered E:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispa\ntch/middleware/templates/rescues/diagnostics.erb within rescues/layout (51.0ms)\nExiting\n</code></pre>\n\n<p>model/user.rb file:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :name,:photo,:crop_x,:crop_y,:crop_w,:crop_h\n  has_attached_file :photo,:styles =&gt; {:small=&gt;\"100x100#\",:large=&gt;\"500x500&gt;\"},:processors =&gt; [:cropper]\n  attr_accessor :crop_x,:crop_y,:crop_w,:crop_h\n  after_update :reprocess_photo,:if=&gt;:cropping?\n\n  def cropping?\n    !crop_x.blank? &amp;&amp; !crop_y.blank? &amp;&amp; !crop_w.blank? &amp;&amp; !crop_h.blank?\n  end\n\n  private \n\n  def reprocess_photo\n    photo.reprocess!\n  end\n\nend\n</code></pre>\n\n<p>my lib/paperclip_processros/cropper.rb</p>\n\n<pre><code>module Paperclip\n  class Cropper &lt; Thumbnail\n    def transformation_command\n      if crop_command   \n        #this generates command :\n        #this is right #convert \"C:/Users/Anand/AppData/Local/Temp/1.jpg[0]\" -crop 102x102+0+0 -auto-orient \"C:/Users/Anand/AppData/Local/Temp/120120924-2336-qbzroo20120924-2336-1jqbiiv.jpg\"\n        crop_command + super.first.sub(/ -crop \\S+/, '')\n      else\n        super\n      end\n    end\n\n    def crop_command\n      target = @attachment.instance\n      if target.cropping?\n        \" -crop #{target.crop_w}x#{target.crop_h}+#{target.crop_x}+#{target.crop_y} \"\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>my config/env./dev.rb</p>\n\n<pre><code> Paperclip.options[:swallow_stderr] = false\n Paperclip.options[:command_path] = \"C:/Program Files/ImageMagick-6.7.9-Q16/\"\n</code></pre>\n\n<p>when m updating a photo after crop, it goes in loop. What could be the solution?</p>\n"},{"tags":["html","ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13146035,"title":"Changing value of Ruby Variable in Html.erb","body":"<p>I have the following code in my controller: </p>\n\n<pre><code>class TestController &lt; ApplicationController\n\n@@a = 1\n\ndef index\n    @temp = connection.execute(\"select test_id from mastertest limit #{@@a}, 5;\")\nend\n</code></pre>\n\n<p>And I have the following code in my View(Html.erb) File:</p>\n\n<pre><code>&lt;button type=\"submit\" value=\"Next\" form=\"submit_form\"&gt;NEXT&lt;/button&gt;\n&lt;form id=\"submit_form\"&gt;\n&lt;% @@a = @@a + 1 %&gt;\n    &lt;table&gt;\n      &lt;% @temp.each do |row| %&gt;\n        &lt;tr&gt;&lt;td&gt;&lt;%= row[0] %&gt;&lt;/td&gt;&lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/table&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>So basically I am trying to change the value of the class variable @@a on clicking the Next button. But it does not change the value of @@aa. Can someone help me how to do that.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13146138,"title":"conception issue with a has_many association","body":"<p>There is something wrong with my associations.<br>\nI want that many VideoPost can refer to the same VideoInformation.\nI then thought that the foreign key should be in VideoPost so I started with the 2 models you can see below.\nBut I can't access to @video_post.video_information (which seems to make sense since there is no association in VideoPost)<br>\nHow should I do ? I'm a little confuse here</p>\n\n<p>Thanks for any help !</p>\n\n<p>My VideoPost model :  </p>\n\n<pre><code># Table name: video_posts\n#\n#  id                   :integer          not null, primary key\n#  user_id              :integer\n#  video_information_id :integer\n#  created_at           :datetime         not null\n#  updated_at           :datetime         not null\nclass VideoPost &lt; ActiveRecord::Base\n  belongs_to :user\n\n  attr_accessible :video_information_id\nend\n</code></pre>\n\n<p>My VideoInformation model :  </p>\n\n<pre><code># Table name: video_informations\n#\n#  id              :integer          not null, primary key\n#  title           :string(255)\n#  description     :text\n#  keywords        :text\n#  duration        :integer\n#  video_url       :string(255)\n#  thumbnail_small :string(255)\n#  thumbnail_large :string(255)\n#  created_at      :datetime         not null\n#  updated_at      :datetime         not null\nclass VideoInformation &lt; ActiveRecord::Base\n  has_many :video_posts\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rexml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":11,"score":2,"question_id":13145888,"title":"Getting the XML ID using REXML","body":"<p>I have an XML response as included below. How can I obtain the  element?</p>\n\n<p>In rails I have:</p>\n\n<pre><code>xml = REXML::Document.new(contacts_as_xml)\nRails.logger.info xml[1].attributes[\"id\"] \n</code></pre>\n\n<p>Which is not returning 'user@company.com'</p>\n\n<p>Thanks</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;\n&lt;feed xmlns=\"http://www.w3.org/2005/Atom\" xmlns:openSearch=\"http://a9.com/-/spec/opensearch/1.1/\" xmlns:gContact=\"http://schemas.google.com/contact/2008\" xmlns:batch=\"http://schemas.google.com/gdata/batch\" xmlns:gd=\"http://schemas.google.com/g/2005\" gd:etag=\"W/&amp;quot;Ck8BQ38yfyt7I2A9WhNSFk8.&amp;quot;\"&gt;\n    &lt;id&gt;user@company.com&lt;/id&gt;\n    &lt;updated&gt;2012-10-30T18:14:12.197Z&lt;/updated&gt;\n    &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n    &lt;title&gt;Users's Contacts&lt;/title&gt;\n    &lt;link rel=\"alternate\" type=\"text/html\" href=\"http://www.google.com/\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#feed\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#post\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#batch\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/batch\" /&gt;\n    &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full?max-results=10000\" /&gt;\n    &lt;author&gt;\n        &lt;name&gt;User Howdy&lt;/name&gt;\n        &lt;email&gt;user@company.com&lt;/email&gt;\n    &lt;/author&gt;\n    &lt;generator version=\"1.0\" uri=\"http://www.google.com/m8/feeds\"&gt;Contacts&lt;/generator&gt;\n    &lt;openSearch:totalResults&gt;2&lt;/openSearch:totalResults&gt;\n    &lt;openSearch:startIndex&gt;1&lt;/openSearch:startIndex&gt;\n    &lt;openSearch:itemsPerPage&gt;10000&lt;/openSearch:itemsPerPage&gt;\n    &lt;entry gd:etag=\"&amp;quot;QXc5eDVSLit7I2A9WhdSFk8PTgU.&amp;quot;\"&gt;\n        &lt;id&gt;http://www.google.com/m8/feeds/contacts/myuser%40mysite.com/base/970a99881a51f3&lt;/id&gt;\n        &lt;updated&gt;2011-07-25T20:31:50.920Z&lt;/updated&gt;\n        &lt;app:edited xmlns:app=\"http://www.w3.org/2007/app\"&gt;2011-07-25T20:31:50.920Z&lt;/app:edited&gt;\n        &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n        &lt;title&gt;Jon Paris&lt;/title&gt;\n        &lt;link rel=\"http://schemas.google.com/contacts/2008/rel#photo\" type=\"image/*\" href=\"https://www.google.com/m8/feeds/photos/media/myuser%40mysite.com/970a99881a51f3\" /&gt;\n        &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/970a99881a51f3\" /&gt;\n        &lt;link rel=\"edit\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/970a99881a51f3\" /&gt;\n        &lt;gd:name&gt;\n            &lt;gd:fullName&gt;Jon Adams&lt;/gd:fullName&gt;\n            &lt;gd:givenName&gt;Jon&lt;/gd:givenName&gt;\n            &lt;gd:familyName&gt;Adams&lt;/gd:familyName&gt;\n        &lt;/gd:name&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#other\" address=\"jon@adams.com\" primary=\"true\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#home\" address=\"jon@adams.com\" /&gt;\n    &lt;/entry&gt;\n    &lt;entry gd:etag=\"&amp;quot;R3YzcTFbKit7I2A9WhJbE00ORQY.&amp;quot;\"&gt;\n        &lt;id&gt;http://www.google.com/m8/feeds/contacts/myuser%40mysite.com/base/1229b5e8eeef3e3&lt;/id&gt;\n        &lt;updated&gt;2012-09-22T08:57:06.889Z&lt;/updated&gt;\n        &lt;app:edited xmlns:app=\"http://www.w3.org/2007/app\"&gt;2012-09-22T08:57:06.889Z&lt;/app:edited&gt;\n        &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;link rel=\"http://schemas.google.com/contacts/2008/rel#photo\" type=\"image/*\" href=\"https://www.google.com/m8/feeds/photos/media/myuser%40mysite.com/1229b5e8eeef3e3\" gd:etag=\"&amp;quot;UQZOJlcjWit7I2BmGBdVTzBfL2E2GGI5Myk.&amp;quot;\" /&gt;\n        &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/1229b5e8eeef3e3\" /&gt;\n        &lt;link rel=\"edit\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/1229b5e8eeef3e3\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#other\" address=\"person@site.com\" primary=\"true\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#home\" address=\"person@gmail.com\" /&gt;\n    &lt;/entry&gt;\n&lt;/feed&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13145840,"title":"Ruby on Rails default option value","body":"<p>I am using an array to store my values for a f.select dropdown in my form</p>\n\n<pre><code>   &lt;%= f.label :country_of_origin %&gt;\n   &lt;%= f.select :country_of_origin, [['Wales'],['Scotland'],['England']] %&gt;\n</code></pre>\n\n<p>Rather than the default value being Wales I would like it to say \"Please Select\" (obviously don’t want to be able to post the value \"please select). Can anyone point me in the right direction please?</p>\n"},{"tags":["ruby","ruby-on-rails-3","osx","installation","homebrew"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13143957,"title":"When trying to install pg gem: Brew bad interpreter error and not existing ruby version","body":"<p>I've really made something wrong when re-installing ruby, rails, xcode etc. (maybe even I've deleted my system Ruby installation :/ ) Here's what I have now:</p>\n\n<p>System: OSX 10.8.2 (64-bit)</p>\n\n<p><code>which ruby</code> gives me <code>/usr/local/bin/ruby</code></p>\n\n<p>I have installed <code>ruby 1.9.3p286</code>, <code>Rails 3.2.8</code> and <code>rvm 1.16.17 (stable)</code></p>\n\n<p>I've installed Ruby and Rails by going with this tips: <em>http://hivelogic.com/articles/compiling-ruby-rubygems-and-rails-on-snow-leopard</em> </p>\n\n<p>Next I wanted to run <code>gem install pg</code> but I've got an error: <code>No such file or directory - brew --prefix</code></p>\n\n<p>I've tried hit just the <code>brew</code> command but I've got another error: <code>/usr/local/bin/brew: bad interpreter: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin: no such file or directory</code></p>\n\n<p>So there is my question (I have installed brew earlier) - why it points on this path of 1.8 Ruby if I don't have this version of Ruby installed? Can I somehow change this path to my current one with ruby(that from which ruby command?)? How fix this brew error? Please help!</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-masonry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":317,"score":0,"question_id":10345508,"title":"Jquery masonry having trouble getting multiple columns","body":"<p>I'm using the Jquery masonry plugin to structure a page so that it has 2 columns.</p>\n\n<p>I am not sure that the plugin is working...it only shows 1 column, and if I alter the column width in the Jquery code, nothing happens.</p>\n\n<p>Code is below - grateful for any advice!</p>\n\n<p>Thanks,</p>\n\n<p>Faisal</p>\n\n<pre><code>script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery.js\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery.masonry.min.js\"&gt;&lt;/script&gt;\n\n&lt;style&gt;\n.item {\n width: 480px;\n .....\n }\n\n&lt;/style&gt;\n&lt;div id=\"container\"&gt;\n &lt;div class=\"item\"&gt;\n ......\n &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;script&gt;\n$(function(){\n    var $container = $('#container');\n    $container.imagesLoaded(function(){\n      $container.masonry({\n        itemSelector : '.tile',\n        columnWidth : 100\n      });\n    });\n\n$container.infinitescroll({\n      navSelector  : '.flickr_pagination',    // selector for the paged navigation \n      nextSelector : 'a.next_page',  // selector for the NEXT link (to page 2)\n      itemSelector : '.tile',     // selector for all items you'll retrieve\n      loading: {\n          finishedMsg: 'No more pages to load.',\n          img: 'http://i.imgur.com/6RMhx.gif'\n        }\n      },\n      // trigger Masonry as a callback\n      function( newElements ) {\n        // hide new items while they are loading\n        var $newElems = $( newElements ).css({ opacity: 0 });\n        // ensure that images load before adding to masonry layout\n        $newElems.imagesLoaded(function(){\n          // show elems now they're ready\n          $newElems.animate({ opacity: 1 });\n          $container.masonry( 'appended', $newElems, true ); \n        });\n      }\n    );\n});\n&lt;/script&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","yield","content-for"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1103,"score":4,"question_id":5631302,"title":"Multiple content_for on the same page","body":"<p>I have large block of HTML in my application that I would like to move into a shared template and then use content_for with yields to insert the necessary content. However, if I use it more than once in the same layout file the content_for just appends to the previous making that idea not work so well. Is there a solution to this?</p>\n\n<pre><code>&lt;div class=\"block side\"&gt;\n    &lt;div class=\"block_head\"&gt;\n        &lt;div class=\"bheadl\"&gt;&lt;/div&gt;\n        &lt;div class=\"bheadr\"&gt;&lt;/div&gt;\n        &lt;h2&gt;&lt;%= yield :block_head %&gt;&lt;/h2&gt;\n    &lt;/div&gt;\n    &lt;div class=\"block_content\"&gt;\n        &lt;%= yield :block_content %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"bendl\"&gt;&lt;/div&gt;\n    &lt;div class=\"bendr\"&gt;&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>and I use the following code to set the content for the block</p>\n\n<pre><code>    &lt;%= overwrite_content_for :block_head do -%&gt;\n        My Block\n    &lt;% end -%&gt;\n    &lt;%= overwrite_content_for :block_content do -%&gt;\n        &lt;p&gt;My Block Content&lt;/p&gt;\n    &lt;% end -%&gt;\n    &lt;%= render :file =&gt; \"shared/_blockside\" %&gt;\n</code></pre>\n\n<p>The problem is if I use this multiple times on the same layout the content from the original block is appended to the secondary block</p>\n\n<p>I have tried creating a custom helper method to get around it, however it does not return any content</p>\n\n<pre><code>  def overwrite_content_for(name, content = nil, &amp;block)\n    @_content_for[name] = \"\"\n    content_for(name, content &amp;block)\n  end\n</code></pre>\n\n<p>I may also be going about this completely wrong and if there are any better methods for getting content to work like this I would like to know. Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","capybara","will-paginate","railstutorial.org"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":609,"score":0,"question_id":10762896,"title":"Testing views with will_paginate Gem using Capybara/Rspec","body":"<p>Doing Michael Hartl's Rails Tutorial, on <a href=\"http://ruby.railstutorial.org/chapters/user-microposts#sec%3amicropost_exercises\" rel=\"nofollow\">chapter 10, section 5, exercise 2</a>. I am - very simply - trying to write tests to ensure that a pagination div appears on a couple pages using the will_paginate gem (this seems to be Hartl's preferred method of testing whether pagination works), but when I add the following code..</p>\n\n<pre><code>subject { page }\n.\n.\n.\nit { should have_selector('div.pagination') }\n</code></pre>\n\n<p>..it returns..</p>\n\n<pre><code>  1) UserPages profile page \n     Failure/Error: it { should have_selector('div.pagination') }\n       expected css \"div.pagination\" to return something\n</code></pre>\n\n<p>This is especially odd because in this particular _spec file, this same Rspec code is passing in some tests and failing in others (I'll highlight this below). Also the <code>pagination</code> div is present in the source code in my browser, and of course it's working fine.</p>\n\n<p>Because it fails in some places and not others, I got to assuming that this is somehow a \"scope\"- or assignment-type issue related to <code>will_paginate</code> - you see, for the failed tests, the content being paginated is actually part of a \"Microposts\" controller, but the pages/views being tested are handled by the \"Users\" controller. For the passing tests, the view and controller are both \"Users\".</p>\n\n<p>Could that be the problem? It's also possible that my FactoryGirl setup/invocation is broken and not triggering the pagination code in test for some reason. I'm a Rails n00b - and actually totally new to programming - so thanks ya'll. :)</p>\n\n<p>(also, p.s., how do I make my code colorful and pretty on SO?)</p>\n\n<p><strong>/spec/requests/user_pages_spec.rb</strong>\n</p>\n\n<pre><code>require 'spec_helper' # Omitted from below - I don't think this is relevant.\n\ndescribe \"UserPages\" do\n\n  subject { page }\n\n  describe \"index\" do # This is the block where it is PASSING..\n\n    let(:user) { FactoryGirl.create(:user) } # I'll include my /spec/factories.rb file below\n\n    before(:all)  { 30.times { FactoryGirl.create(:user) } }\n    after(:all)   { User.delete_all } # I'll omit my /app/models/user.rb file - I don't think it's relevant to the problem\n\n    before do\n      valid_signin user # References /spec/support/utilities.rb to sign in as a valid user, but I will omit this since this is part of the working tests\n      visit users_path # This is /app/views/users/index.html.erb - this is where SUCCESSFUL pagination testing occurs\n    end\n\n    describe \"pagination\" do\n\n      it { should have_selector('div.pagination') } #PASS!! As I would expect\n  .\n  .\n  .\n  end\n\n  describe \"profile page\" do\n    let(:user) { FactoryGirl.create(:user) }\n    let!(:m1) { FactoryGirl.create(:micropost, user: user, content: \"Awesome\")} # Used for other tests\n    let!(:m2) { FactoryGirl.create(:micropost, user: user, content: \"Sauce\") } # Used for other tests\n\n    before(:all)  { 30.times { FactoryGirl.create(:micropost) } } # Is this constructed properly? Perhaps the posts are not created, and that's why the failure to render the paginate code in test.\n    after(:all)   { user.microposts.delete_all } # I have tested with and without this line of code - it fails both ways.\n\n    before { visit user_path(user) } # /app/views/users/show.html.erb\n\n    it { should have_selector('div.pagination') } # FAIL!!! This is the line in question that generates the error above.\n    .\n   .\n  .\n .\nend\n</code></pre>\n\n<p><strong>/app/views/users/index.html.erb</strong> (pagination working on site, test working also)</p>\n\n<pre><code>&lt;%= provide(:title, 'All users') %&gt;\n&lt;h1&gt;All users&lt;/h1&gt;\n\n&lt;%= will_paginate %&gt;\n\n&lt;ul class=\"users\"&gt;\n  &lt;%= render @users %&gt;\n&lt;/ul&gt;\n\n&lt;%= will_paginate %&gt;\n</code></pre>\n\n<p><strong>/app/views/users/show.html.erb</strong> (pagination working on site, test failing)</p>\n\n<pre><code>&lt;% provide(:title, @user.name) %&gt;\n&lt;div class=\"row\"&gt;\n.\n.\n.\n  &lt;div class=\"span8\"&gt;\n    &lt;% if @user.microposts.any? %&gt;\n      &lt;h3&gt;Microposts (&lt;%= @user.microposts.count %&gt;)&lt;/h3&gt;\n      &lt;ol class=\"microposts\"&gt;\n        &lt;%= render @microposts %&gt;\n      &lt;/ol&gt;\n      &lt;%= will_paginate @microposts %&gt; # Here is where I declare that pagination should occur on @microposts, NOT @users\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>/spec/requests/factories.rb</strong></p>\n\n<pre><code>FactoryGirl.define do\n  factory :user do\n    sequence(:name)   { |n| \"Person #{n}\" }\n    sequence(:email)  { |n| \"person_#{n}@example.com\" }\n    password  \"secret\"\n    password_confirmation \"secret\"\n\n    factory :admin do\n      admin true\n    end\n  end\n\n  factory :micropost do\n    content \"Lorem ipsum\"\n    user\n  end\nend\n</code></pre>\n\n<p><strong>/Gemfile</strong></p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.3'\ngem 'pg', '0.12.2'\ngem 'bootstrap-sass', '2.0.0'\ngem 'bcrypt-ruby', '3.0.1'\ngem 'faker', '1.0.1'\ngem 'will_paginate', '3.0.3'\ngem 'bootstrap-will_paginate', '0.0.6'\n\ngroup :development do\n    gem 'guard-rspec', '0.5.5'\n    gem 'annotate', '~&gt; 2.4.1.beta'\nend\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '3.2.4'\n  gem 'coffee-rails', '3.2.2'\n  gem 'uglifier', '1.2.3'\nend\n\ngem 'jquery-rails', '2.0.0'\n\ngroup :test, :development do\n  gem 'rspec-rails', '2.9.0'\nend\n\ngroup :test do\n    gem 'capybara', '1.1.2'\n    gem 'rb-fsevent', '0.4.3.1', :require =&gt; false\n    gem 'growl', '1.0.3'\n    gem 'guard-spork', '0.3.2'\n    gem 'spork', '0.9.0'\n    gem 'factory_girl_rails', '1.4.0'\nend\n</code></pre>\n\n<p><strong>edit: found <a href=\"http://mislav.uniqpath.com/rails/will_paginate-view-testing/\" rel=\"nofollow\">this article related to will_paginate and view testing</a>, but don't understand it honestly (probably due to the syntax).. could it be somehow related?</strong> </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","coffeescript","stripe-payments"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13131632,"title":"How to track down the cause of an error in coffescript and Stripe?","body":"<p>I'm using Stripe in my Rails 3 application to do creditcard payments. I'm roughly following the <a href=\"http://railscasts.com/episodes/288-billing-with-stripe\" rel=\"nofollow\">railscast on Stripe integration</a> though my app is doing just a single charge for now and not subscription billing like Ryan shows.</p>\n\n<p>The problem is, I can't get the <code>processCard()</code> function to fire. I'll be the first to admit I'm not a javascript guru (or any kind of guru for that matter). It doesn't give a javascript error, it instead submits the form to rails (without any credit card details) and fails since <code>stripe_card_token</code> is nil. I've placed some <code>alert()</code> dialogs spaced throughout for some very crude debugging to see where the hangup is. My model name is <code>Payment</code> which is really the only deviation so far from Ryan's code apart from the temporary alert() dialogs.</p>\n\n<p>So my question is twofold: How can I reliably track down what's causing the problem? and Where did I go wrong?</p>\n\n<p>Here's the Javascript:</p>\n\n<pre><code>jQuery -&gt;\n  Stripe.setPublishableKey($('meta[name=\"stripe-key\"]').attr('content'))\n  payment.setupForm()\n\npayment =\n  setupForm: -&gt;\n    $('#new_payment').submit -&gt;\n      $('input[type=submit]').attr('disabled', true)\n      alert(\"before processCard\")\n      payment.processCard()\n      alert(\"after processCard\")\n      false\n      # else\n      #   true\n\n  processCard: -&gt;\n    alert(\"processCard start\")\n    card =\n      number: $('#credit_card_number').val()\n      cvc: $('#cvc').val()\n      expMonth: $('#card_month').val()\n      expYear: $('#card_year').val()\n    alert(\"card values are set\")\n    Stripe.createToken(card, payment.handleStripeResponse)\n    alert(\"After createToken\")\n\n  handleStripeResponse: (status, response) -&gt;\n    if status == 200\n      alert(response.id)\n      # $('#payment_stripe_card_token').val(response.id)\n      # $('#new_payment')[0].submit()\n    else\n      alert(response.error.message)\n      # $('#stripe_error').text(response.error.message)\n      # $('input[type=submit]').attr('disabled', false)\n</code></pre>\n\n<p>And the associated view:</p>\n\n<pre><code>&lt;%= simple_form_for @payment, :html =&gt; { :class =&gt; 'form-horizontal'} do |f| %&gt;\n&lt;fieldset&gt;\n  &lt;legend&gt;Pay via Credit Card&lt;/legend&gt;\n\n    &lt;%= f.input :stripe_card_token, :as =&gt; :hidden, :id =&gt; 'stripe_card_token' %&gt;\n\n    &lt;div class=\"well well-small\"&gt;\n      &lt;%= current_user.full_name %&gt;&lt;br /&gt;\n      &lt;%= current_user.email %&gt;&lt;br /&gt;\n      This is the name we have on file for you. If it's not correct, please &lt;%= link_to \"change it now\", edit_user_registration_path(current_user) %&gt;\n    &lt;/div&gt;\n\n&lt;div id=\"stripe_error\"&gt;\n  &lt;noscript&gt;JavaScript is not enabled and is required for this form. First enable it in your web browser settings.&lt;/noscript&gt;\n&lt;/div&gt;\n\n&lt;div id=\"credit-card\"&gt;\n  &lt;div class=\"control-group string required\"&gt;\n    &lt;%= label_tag :credit_card_number, \"Card Number\", :class =&gt; \"control-label string required\" %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= text_field_tag :credit_card_number, nil, :class =&gt; \"string required\", :name =&gt; nil %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"control-group string required\"&gt;\n    &lt;%= label_tag :cvc, \"Security code (CVC)\", :class =&gt; \"control-label string required\" %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= text_field_tag :cvc, nil, :class =&gt; \"string required\", :name =&gt; nil %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"control-group date required\"&gt;\n    &lt;%= label_tag :card_month, \"Expiration Date\", :class =&gt; \"control-label date required\"%&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= select_month nil, {add_month_numbers: true}, {name: nil, id: \"card_month\", :class =&gt; \"date required span2\"} %&gt;\n      &lt;%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+25}, {name: nil, id: \"card_year\", :class =&gt; \"date required span2\"} %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n    &lt;h4&gt;Your unpaid courses&lt;/h4&gt;\n    &lt;% @unpaid_subs.each do |sub| %&gt;\n      &lt;%= sub.course.name %&gt;&amp;nbsp;|&amp;nbsp;&lt;%= sub.course.credits %&gt;&lt;br /&gt;\n    &lt;% end %&gt;\n\n&lt;div class=\"form-actions\"&gt;\n&lt;%= f.submit nil, :class=&gt;\"btn btn-primary\" %&gt;\n&lt;%= link_to \"Cancel\", courses_path, :class=&gt;\"btn\" %&gt;\n&lt;/div&gt;\n&lt;/fieldset&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Related Question(No accepted answer): <a href=\"http://stackoverflow.com/questions/11314013\">What is wrong with my CoffeScript in Stripe?</a></p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12643385,"title":"How to make jQuery remember state in a Rails app?","body":"<p>I'd be very grateful for a code snippet showing off jQuery functionality remembering state, e.g. .slideToggle(). </p>\n\n<p>I've read about local storage, session storage, ajax among others - what technique is preferred 2012 and how could an implementation look like in Ruby in Rails 3.2?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","database-design","activerecord","controller"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12961706,"title":"How do I access information from multiple associated models in the Controller in an effiecient manner?","body":"<p>First, some background.</p>\n\n<p>My application models are like so:</p>\n\n<pre><code>  User has_many :subscriptions; has_many :courses, :through =&gt; :subscriptions\nSubscription belongs_to :course, :user\n  Course has_many :subscriptions; has_many :users, :through =&gt; :subscriptions\n</code></pre>\n\n<p>Subscription is a join table used to store information such as state (:active, :inactive, :failed, :passed, :unpaid) as well as serve as a connector to all the information that comes with taking a course (such as the Grade model(not yet added), the Payment model(work in progress), etc).</p>\n\n<p>I want to add the Payment model to store a history of payments on a subscription. Each payment can be for one or more subscriptions. So far, I've tried a <code>Payment has_many :subscriptions</code>, but <strong>I'm having trouble with the controller logic</strong> and I'm thinking maybe there's a better way to associate the models for \"a Payment from a User on a Subscription to a Course.\"</p>\n\n<p>Technically speaking, in a payment show action, I would need information from each of these models (course.name, user_id of user who paid, payment.amount, all of which are connected to a Subscription) and in a Payment.create action, I'd need to set the state of the subscription (that I can do).</p>\n\n<p>If this is a logical/efficient way to associate the various models, how do I access the needed information(some information from each model course, user, payment, and subscription) in the Payment show action with minimal database calls? I'm using <code>Rails 3.2/Ruby 1.9</code> and would like to stick with ActiveRecord/ARel instead of straight sql statements. I'm open to \"you're doing it wrong\" answers as well. If changing the associations will make it more efficient to access the tables from the controller, I'm open to that as well.</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","youtube"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":184,"score":0,"question_id":13130145,"title":"Sharing my page with youtube videos on facebook doesn't show thumbnail","body":"<p>I have a blog on my app and on this blog I usually put some youtube videos and when I share the links of these pages on Facebook there's no thumbnail. Is there a way to do this? </p>\n\n<p>I have tried to put meta-data with open graph protocol, with the youtube link but no luck.</p>\n\n<p>Is this possible?</p>\n\n<p><strong>EDITED</strong></p>\n\n<p>In my app I was including the OG video tag like this:</p>\n\n<pre><code>%meta{ :property =&gt; \"og:title\" , :content =&gt; \"#{post.title}\" }\n%meta{ :property =&gt; \"og:type\" , :content =&gt; \"article\" }\n%meta{ :property =&gt; \"og:url\" , :content =&gt; \"#{post_url(post.slug).sub('https:', 'http:')}\" }\n-if post.video_thumbnail &amp;&amp; post.video_thumbnail != \"\"\n  %meta{ :property =&gt; \"og:video\" , :content =&gt; \"http://www.youtube.com/watch?v=#{post.video_thumbnail}\"}\n</code></pre>\n\n<p>I found the answer on this question: <a href=\"http://stackoverflow.com/questions/2068344/how-to-get-thumbnail-of-youtube-video-link-using-youtube-api\">How to get thumbnail of YouTube video link using YouTube API?</a></p>\n\n<p>Youtube API lets you get images from the video if used this URL: </p>\n\n<pre><code>http://img.youtube.com/vi/&lt;insert-youtube-video-id-here&gt;/0.jpg\n</code></pre>\n\n<p>So I included that link as my OG image tag like this:</p>\n\n<pre><code>%meta{ :property =&gt; \"og:image\" , :content =&gt; \"http://img.youtube.com/vi/#{post.video_thumbnail}/0.jpg\" }\n</code></pre>\n\n<p>And it work perfectly.</p>\n"},{"tags":["ruby-on-rails-3","capistrano","asset-pipeline"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":675,"score":3,"question_id":7933141,"title":"Rails 3.1 asset pipeline production w/out javascript runtime environment","body":"<p>I am struggling with the idea of deploying a large app using the the asset pipeline and the precompile Capistrano task. </p>\n\n<ol>\n<li><p>I don't want to install the javascript runtime environment and precompile the assets on each production server. </p></li>\n<li><p>The assets need to be uploaded to two Nginx servers that don't have a copy of the app.  </p></li>\n</ol>\n\n<p>So I have created a Capistrano task that precompiles the assets locally and then uploads the assets to the the Nginx servers, and the manifest files to the app servers. </p>\n\n<p>The problem is the assets on my local machine could differ from the assets the git branch I am deploying from. </p>\n\n<p>Is there a better way or must I just be dillagent to always deploy from the correct clean branch?</p>\n\n<h1>Edit here is the cap task that does the precompile and upload</h1>\n\n<pre><code>namespace :assets do\n  after \"deploy:update_code\", \"assets:precompile\"\n  after \"assets:precompile\", \"assets:upload_assets\"\n  after \"assets:precompile\", \"assets:upload_manifest\"\n\n\n  desc \"precompile assets\"\n  task :precompile do\n    run_locally(\"bundle exec rake assets:clean &amp;&amp; bundle exec rake assets:precompile RAILS_ENV=#{rails_env}\")\n  end\n\n  desc \"precompile and upload assets to webserver\"\n    task :upload_assets, :roles =&gt; :nginx do\n    top.upload( \"public/assets\", \"/usr/local/fieldphone/#{rails_env}/\", :via =&gt; :scp, :recursive =&gt; true)\n  end\n  # \n  desc \"upload manifest file\"\n  task :upload_manifest, :roles =&gt; :app do\n    top.upload( \"public/manifest.yml\", \"#{release_path}/public/\", :via =&gt; :scp )\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","csv","import","sqlite3","rake-task"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13139567,"title":"After importing a csv file, extra rows are being created in my sqlite db table","body":"<p>I'm importing 17 csv files into my app via rake tasks.  The other files will import fine and not create extra rows, but for some reason this file is creating about 60 empty rows in my database.  The information I'm trying to import is going in fine and it's being associated with it's appropriate tables the way it should.  So if you were to use the app, everything functions properly but its making a mess of my table.</p>\n\n<p>For example, I'm importing 2 rows into the table and right after those two are being created, it's followed by 58 blank rows.  Does anyone have any suggestions about how I can use a conditional statement to keep this from happening and please be specific I'm still relatively new at this.  Thanks</p>\n\n<p>Here is my code:</p>\n\n<pre><code>require 'csv'\n\nnamespace :import_mat_lists_csv do\n\ntask :create_mat_lists =&gt; :environment do\n    puts \"Import Material List\"\n\n    csv_text = File.read('c:/rails/thumb/costrecovery/lib/csv_import/mat_lists.csv')\n    csv = CSV.parse(csv_text, :headers =&gt; true)\n    csv.each_with_index do |row,index|\n        row = row.to_hash.with_indifferent_access\n        MatList.create!(row.to_hash.symbolize_keys)\n        matlist = MatList.last\n        if @report_incident_hash.key?(matlist.report_nr)\n            matlist.incident_id = \"#{@report_incident_hash[matlist.report_nr]}\"\n        end\n\n        #matlist.timesheet_id = @timesheet_id_array[index]\n        matlist.save\n    end\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":5,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":840,"score":5,"question_id":5655071,"title":"Good base app for Rails 3?","body":"<p>Could anybody tell me a good base app for Rails 3?</p>\n"},{"tags":["ruby","ruby-on-rails-3","google-maps-api-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13143355,"title":"Ruby and Google Maps API","body":"<p>I'm requesting directions with the following url:</p>\n\n<pre><code>http://maps.googleapis.com/maps/api/directions/json?origin=43.656877,-79.32085&amp;destination=Montreal&amp;sensor=false\n</code></pre>\n\n<p>Then, Google sends back a huge JSON and I want to access the steps in a nicer way than this:</p>\n\n<pre><code>response = open(\"http://maps.googleapis.com/maps/api/directions/json?origin=#{lat1},#{lng1}&amp;destination=#{lat2},#{lng2}&amp;sensor=false\").read\nresponse = JSON.parse(response)\n\nresponse[\"routes\"][0][\"legs\"][0][\"steps\"][0][\"end_location\"]\n</code></pre>\n\n<p>Is there a more beautiful way to access the end_location without having to use all these array notation? I thought of using OpenStruct, but it would not be ideal either.</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.2","less","asset-pipeline","precompile"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12938995,"title":"Excluding files from assets:precompile in rails","body":"<p>I use codekit for writing less which it then converts to css automatically.</p>\n\n<p>I don't want rails to convert my less files to css, I rather codekit do it.</p>\n\n<p>if I precompile the assets via</p>\n\n<pre><code>rake assets:precompile\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>rake aborted!\ncannot load such file -- less\n</code></pre>\n\n<p>How do I <strong>exclude</strong> a specific folder/file types from precompiling? (all my less files are in app/assets/stylesheets/less and the css (which I do want to be precompiled) are in app/assets/stylesheets/css</p>\n\n<p><strong>update</strong></p>\n\n<p>deleting <code>application.less</code> solves this but how do I excluding it from processing in the first place?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","osx"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12468459,"title":"I want to change my OS X ruby version to 1.9 without using RVM","body":"<p>yeah, you heard me right! I want to nix RVM for the time being and just run off of a system-level installation of Ruby 1.9.3</p>\n\n<p>In other words, I want to just upgrade the old 1.8.7 version of ruby that came with my Mountain Lion installation to 1.9.3.</p>\n\n<p>How would i do this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13142980,"title":"How to group radio button in form created by simple_form?","body":"<p>My Answer model have 2 column, <code>content</code> is text and <code>correct</code> is boolean. My form to create answer here:  </p>\n\n<pre><code>&lt;legend&gt;Answer&lt;/legend&gt;\n&lt;%= question_form.simple_fields_for :answers do |answer_form| %&gt;\n\n  &lt;%= answer_form.input :content, input_html: { rows: 1, class: 'span6' } %&gt;\n  &lt;%= answer_form.input :correct, as: :radio_buttons %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Form is rendered like this:  </p>\n\n<p><img src=\"http://s8.postimage.org/yabhzkr79/answer_fields.png\" alt=\"answer form\"></p>\n\n<p>But i want, with one text content, will have only one radio, to set that content is correct. It means with above image, i would like radio buttons don't have <code>No</code> choice, and only one in two radio buttons is checked, like if content 'True' have radio button checked, content 'False' will have radio button is not checked. How can i do that with simple form?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13142785,"title":"Form for adding children using ancestry gem","body":"<p>I have a user model in Rails and I am trying to use the Ancestry gem to add children to users. I would like to be able to enter one/several user ids (children) into a form and then assign them to be children to a user. I currently have a form for updating the name of the user in a view, but being new to Rails I am struggling to figure out the form should look like for making @user parent of user_ids (the children) entered a form. How can one do this?</p>\n\n<p>edit.html.erb</p>\n\n<pre><code>…\n&lt;%= form_for @user do |f| %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.submit \"Update\", class: \"btn\" %&gt;            \n&lt;% end %&gt;\n…\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","erb"],"answer_count":2,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":130,"score":16,"question_id":13142326,"title":"What does <%== %> do in rails erb?","body":"<p>I saw this recently, thought it was interesting.  But I don't really understand what it does?</p>\n\n<p>Ex.  I have a rails app and I want to bootstrap some json, so that I don't have to make a second request.  Normally I would write something like this.</p>\n\n<p><code>&lt;%= raw @model.to_json %&gt;</code>\nor\n<code>&lt;%= @model.to_json.html_safe %&gt;</code></p>\n\n<p>I have to send the message <code>raw</code> or <code>html_safe</code> or the json will be html escaped and thus not parsed correctly.  However, this seems to work too.</p>\n\n<p><code>&lt;%== @model.to_json %&gt;</code></p>\n\n<p>But I can't find any documentation.</p>\n\n<p>Does anyone know what this does exactly?  i.e.  Is it the exact same as calling <code>html_safe</code> or <code>raw</code>?  Or is there more to it?</p>\n"},{"tags":["jquery","ajax","ruby-on-rails-3","ruby-on-rails-3.2","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13142221,"title":"JSON::GeneratorError in a .js.erb file","body":"<p>I don't understand what I'm doing wrong..</p>\n\n<p>I am attempting to catch a 401 unauthorized and inserting a div with a message before the submit button using </p>\n\n<pre><code>$(function() {\n  return $(\"a\").ajaxError(function(event, jqXHR, ajaxSettings, thrownError) {\n    if (jqXHR.status === 401) {\n      $(\".submit\").before(&lt;%=j content_tag :div, \"Does not compute\" %&gt; );\n    }\n  });\n});\n</code></pre>\n\n<p>the name of the file is home.js.erb</p>\n\n<p>even before the page loads I get </p>\n\n<pre><code>JSON::GeneratorError in Pages#home\n\nShowing H:/project/app/views/layouts/application.html.erb where line #6 raised:\n\nonly generation of JSON objects or arrays allowed\n  (in H:/project/app/assets/javascripts/home.js.erb) \n</code></pre>\n\n<p>line #6 refers to </p>\n\n<pre><code>5:   &lt;%= stylesheet_link_tag    \"application.css\", :media =&gt; \"all\" %&gt;\n6:   &lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>obviously something is wrong.. but what?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13140509,"title":"How can I open a link(button) in a separate tab?","body":"<p>I have a button that opens a link in a same window, but I need to open it in a separate tab by doing some scripting. I am working in Ruby and here is my code:  </p>\n\n<pre><code>Given /^User clicks on the New User Link$/ do\n    page.driver.browser.switch_to.window (page.driver.browser.window_handles.last)\n    find(:xpath, \"//*[@id='slideshow']/div[1]/div/a/img, \").click\nend\n</code></pre>\n\n<p>This code won't work for me. Please let me know if you see anything wrong in this code. </p>\n"},{"tags":["ruby","ruby-on-rails-3","routing"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":13140624,"title":"Rails 3 Routing: Resource actions and nested resource with :path => \"/\"","body":"<p>I want to configure my Rails routing such that these cases work:</p>\n\n<pre><code>/username           #=&gt; { :controller =&gt; \"houses\",\n                    #     :action =&gt; \"index\",\n                    #     :user_id =&gt; \"username\" }\n\n/username/housename #=&gt; { :controller =&gt; \"houses\",\n                    #     :action =&gt; \"show\",\n                    #     :user_id =&gt; \"username\",\n                    #     :id =&gt; \"housename\" }\n\n/username/edit      #=&gt; { :controller =&gt; \"users\",\n                    #     :action =&gt; \"edit\",\n                    #     :id =&gt; \"username\" }\n</code></pre>\n\n<p>In other words, I want <code>/:user_id</code> to be a regular user resource, and have a nested resource for it, which is mounted directly on the root. So, I want <code>/username/housename</code> instead of <code>/username/houses/housename</code>. I tried using <code>:path =&gt; \"/\"</code> for the nested resources, but this somehow clashes with other actions such as `:edit. I'm lost - can this be done?</p>\n"},{"tags":["ruby-on-rails-3","metric-fu"],"answer_count":2,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":513,"score":8,"question_id":9543908,"title":"metric_fu equivalent for ruby 1.9.x","body":"<p><a href=\"https://github.com/jscruggs/metric_fu\">metric</a>_fu doesn't seem to be supported in the latest ruby kernel (1.9.2 | 1.9.3). Are there any gems which offer equivalent functionality.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13137826,"title":"How to add a method for active record?","body":"<p>I would want to use my method getScheduleFixed() on a Active Record Istance</p>\n\n<pre><code>ps = ProgramSchedule.all\nps.getScheduleFixed\n</code></pre>\n\n<p>the important fact is how to access to \"ps\" array (active record) on my method declaration</p>\n\n<pre><code>class ProgramSchedule &lt; ActiveRecord::Base\n\n  def getScheduleFixed\n\n    array = (HERE ARRAY RETURNED BY ACTIVE RECORD)\n\n    # some stuff...\n\n    return array\n\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","deployment","twitter-bootstrap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13141477,"title":"Rails 3 Production Bootstrap Asset Problems","body":"<p>I have deployed my site which uses Twitter Bootstrap heavily and am having a problem with the difference between local and production, If you have a look at the images below you will see that not only the background from the navbar has gone but also that the padding on some of the other elements has also gone screwy.</p>\n\n<p>Additionally you can see that the Icons also have a black shadow on them.</p>\n\n<p><img src=\"http://i.stack.imgur.com/x9Ws1.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/MgwLv.png\" alt=\"enter image description here\"></p>\n\n<p>My production.rb is as follows:-</p>\n\n<pre><code>    Build::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Disable Rails's static asset server (Apache or nginx will already do this)\n  config.serve_static_assets = false\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  # config.force_ssl = true\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Use a different cache store in production\n  # config.cache_store = :mem_cache_store\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  # config.assets.precompile += %w( search.js )\n\n  # Disable delivery errors, bad email addresses will be ignored\n  # config.action_mailer.raise_delivery_errors = false\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\nend\n</code></pre>\n\n<p>I have also run the following from ssh to try and fix it:-</p>\n\n<pre><code>RAILS_ENV=production rake assets:precompile\n</code></pre>\n\n<p>Any help would be appreciated as I am pulling my hair out here.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","auto-increment","infinite-scroll"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13124364,"title":"Endless / Infinite Scroll Counter Column","body":"<p>I currently have a working table that is sorted by several select boxes. I recently implemented endless/infinite scrolling by following this tutorial: <a href=\"http://railscasts.com/episodes/114-endless-page-revised?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/114-endless-page-revised?view=asciicast</a></p>\n\n<p>The tutorial worked after a couple of changes, but I have one problem. I am using a counter for the first column, but the problem is that every time it loads the next page, the counter resets to 1. I am currently displaying 50 records at the start and 50 more each time the user scrolls down to the bottom. I would like the next records to be 51...52...53...etc. Then the next time you scroll to the bottom, start at 101 then 102...103...104...etc.</p>\n\n<p>To get the partial I followed this tutorial which also told me how to make the counter column:\n<a href=\"http://xianese.blogspot.com/2008/06/render-collection.html\" rel=\"nofollow\">http://xianese.blogspot.com/2008/06/render-collection.html</a></p>\n\n<p>Here is my code:</p>\n\n<p><strong>articles.js.coffee</strong></p>\n\n<pre><code>jQuery -&gt;\n   if $('.pagination').length\n      $('#articles_table').scroll -&gt;\n              url = $('.pagination .next_page').attr('href')          \n              if url &amp;&amp;  $('#articles_table')[0].scrollHeight -    \n              $('#articles_table').scrollTop() &lt; 700                  \n                      $('.pagination').text('Fetching more users...')\n                      $.getScript(url)\n$('#articles_table').scroll()\n</code></pre>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;table class=\"table table-striped table-bordered span8 table-condensed\"     \n id=\"articles_table\" &gt;\n&lt;thead class=\"header\"&gt;\n  &lt;tr&gt;\n      &lt;th&gt;ID&lt;/th&gt;\n      &lt;th&gt;Title&lt;/th&gt;\n      &lt;th&gt;Description&lt;/th&gt;\n      &lt;th&gt;Created_At&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;%= render @articles %&gt;\n\n&lt;/tbody&gt;\n</code></pre>\n\n<p><strong>index.js.erb</strong></p>\n\n<pre><code>$('#articles_table').append('&lt;%= j render(@articles) %&gt;');\n&lt;% if @articles.next_page %&gt;\n$('.pagination').replaceWith('&lt;%= j will_paginate(@articles) %&gt;');\n&lt;% else %&gt;\n$('.pagination').remove();\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>_article.html.erb</strong></p>\n\n<pre><code>&lt;tr&gt;\n      &lt;td&gt; &lt;%= article_counter +1 %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Title %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Description %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Created_At %&gt; &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["jquery","ruby-on-rails-3","sorting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13130855,"title":"Sorting Table Function Not Working - Jquery-DataTables-Rails","body":"<p>I am having issues implementing the \"table sort\" feature into my rails application. I have data that is being dynamically added by each model (simple scaffolding). I have followed Ryan Bates tutorial exactly as he stated (#228) and the sortable feature will not just work. I then read and listed to his tutorial DataTables #340 and the feature will still not work.</p>\n\n<p>I know the gem is working correctly because when I add this to my: </p>\n\n<p><strong>network.js.coffee</strong></p>\n\n<pre><code>jQuery -&gt;\n  $('#networks').dataTable\nsPaginationType: \"bootstrap\"\nbServerSide: true\n</code></pre>\n\n<p><strong>networks_controller</strong></p>\n\n<pre><code>def index\n@networks = Network.all\n@networks = Network.paginate(:page =&gt; params[:page], :per_page =&gt; 5)\nrespond_to do |format|\n  format.html # index.html.erb\n  format.json { render json: @networks }\nend\n</code></pre>\n\n<p>end</p>\n\n<p>It will stylize my table giving it the bootstrap toggle arrows and search field box. However, clicking on the arrows to filter does absolutely nothing. I have spent many hours trying to figure this out with no positive results. </p>\n\n<p>Any suggestions??</p>\n\n<p>TIA</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","views","content-for"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13140596,"title":"How to skip the content_for tag content for some pages in rails?","body":"<p>I have a layout in which i'm using the content_for tag to render some partials(for sidebar). But on several pages I don't need this sidebar. So the question is: How can I tell rails not to render anything for some pages?</p>\n\n<p>I've tried to do it the following way without any result:</p>\n\n<pre><code>&lt;% content_for :sidebar do %&gt;\n  &lt;%= render nothing: true %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Just got an error</p>\n\n<pre><code>You invoked render but did not give any of :partial, :template, :inline, :file or :text option.\n</code></pre>\n"},{"tags":["ruby-on-rails-3","validation","model","relationship","validator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13139839,"title":"rails custom validator doesn't seem to work","body":"<p>I wrote a custom validator which sits in lib/readiness_for_completion_validator.rb:</p>\n\n<pre><code>class DisruptionTimeValidator &lt; ActiveModel::Validator\n  def validate(record)\n    # if record.timeline.events[0].event_time &gt; record.timeline.events[1].event_time \n    if true \n      record.errors[:Outage] &lt;&lt; \" end time needs to be after outage begin time\" \n    end\n  end\nend\n</code></pre>\n\n<p>The issue is, I can't get it to trigger ever if I substitute the 'if true' for the commented out line. </p>\n\n<p>I tested the condition in rails console and it works exactly as I would want it to, but it never evaluates to true in the validator...</p>\n\n<p>Any help would be greatly appreciated, I spent a lot of time researching this and this is driving me crazy :(</p>\n\n<p>I have a Timeline that has many events. People can adjust event_time on events but there are two special events that each timeline contains that need to occur in succession.</p>\n\n<p>Below please find what I have in app/models/event.rb:</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  attr_accessible :event_description, :event_time, :timeline_id\n\n  belongs_to :timeline\n\n  validates :event_description, :length =&gt; { :in =&gt; 10..255 }\n\n  validates_with DisruptionTimeValidator, :on =&gt; :update\n\nend\n</code></pre>\n\n<p>(I messed around with the :on but it didn't make any difference)</p>\n\n<p>Any help would be greatly appreciated,</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave","formtastic"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13139597,"title":"Rails 3 file upload with Carrierwave and Formtastic","body":"<p>I have a Product with many Photos. The relationship is this way:</p>\n\n<p>product.rb</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  has_many :photos, :dependent =&gt; :destroy\n  attr_accessible :translations_attributes, :active, :category_id, :photos\n  accepts_nested_attributes_for :translations, :photos\n</code></pre>\n\n<p>photo.rb</p>\n\n<pre><code>class Photo &lt; ActiveRecord::Base\n  attr_accessible :photo, :product_id\n  belongs_to :attachable\n  mount_uploader :photo, PhotoUploader\n</code></pre>\n\n<p>and the form looks like this:</p>\n\n<pre><code>form(:html =&gt; { :multipart =&gt; true }) do |f|\nf.inputs \"Details\" do\n  f.input :active\n  f.input :category, :include_blank =&gt; false\nend\n\nf.inputs \"Photos\" do\n    f.input :photos, :as =&gt; :file\nend\n\nf.buttons\n</code></pre>\n\n<p>end</p>\n\n<p>The problem is that I get this error when creating/updating the product with a file attached:</p>\n\n<pre><code>undefined method `each' for #&lt;ActionDispatch::Http::UploadedFile:0x007f93c8549828&gt;\n</code></pre>\n\n<p>I found a question with the same error <a href=\"http://stackoverflow.com/questions/10955501/rails-3-polymorphic-association-with-carrierwave-and-simple-form\">here</a>, but even trying their solution still have the same problem.</p>\n\n<p>I'm using Friendly_Id, ActiveAdmin, Globalize3, maybe it could have some relationship with them, this is my first project with Rails and right now I don't know what could be...</p>\n"},{"tags":["ruby-on-rails-3","csv"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13138415,"title":"Rails 3- What is the alternative solution of CSV.parse_line in rails3","body":"<p>In rails 2, I used CSV.parse_line to read csv files.\nIn Rails 3, CSV.parse_line is not present. I used line.split but it is not working when there is comma (,) present in one word. It split it into two columns.</p>\n\n<p>I want to know that is there is any alternative solution of CSV.parse_line in Rails 3?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing","rspec","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13129583,"title":"Rspec testing instance variables with user creation","body":"<p>I'm testing to make sure that a created user is assigned to my instance variable <code>@user</code>. I understand what get means, but I'm not sure what to write for the test. I'm returning with an argument error for a bad URI or URL. What's wrong with my test and how do I fix it?</p>\n\n<pre><code>it \"checks @user variable assignment for creation\" do\n\n    p = FactoryGirl.create(:user)\n    get :users\n    # I'm confused on what this line above means/does. What does the hash :users refer \n    #to\n    assigns[:user].should == [p]\n\nend\n</code></pre>\n\n<p>The <code>expected URI object or string error</code> refers to <code>get :users</code> and the error is as follows</p>\n\n<pre><code>Failure/Error get :users\nArgumentError:\n  bad argument: (expected URI object or URI string)\n</code></pre>\n"},{"tags":["ruby-on-rails-3","factory-girl","testunit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13138041,"title":"Can we load multiple factories into the database in one shot?","body":"<p>Just started using factory girl. If one has to save a factory into the db then one has to run\n<code>FactoryGirl.create()</code>.</p>\n\n<p>But is there any way to load a collection of factories into the database without having to call create on each of the factories?</p>\n\n<p>If its of any help i'm using Ruby 1.9.3, Rails 3.2.8 and Factory Girl 4.1.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","naming-conventions","rspec2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13128662,"title":"File name convention in rspec file","body":"<p>I noticed in the Ruby on Rails Tutorial by Hartl that he uses rails generate to create the rspec file. For example, </p>\n\n<pre><code>rails generate integration_test static_pages\n</code></pre>\n\n<p>creates the file <code>static_pages_spec.rb</code>. My question is, is there a naming convention for the name of the file? </p>\n\n<p>Also, is there a naming convention for the text between <code>describe</code> and <code>do</code>? I'm aware that writing something like <code>/people/new</code> will set up the render automatically when testing a view so all I need to do is write <code>render</code>, but what other naming conventions exist out there in rspec?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","date"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13138702,"title":"Ruby on rails implode and explode functions to change date format","body":"<p>How do we explode a string on '-' and again implode it on '-' in ruby on rails.My problem is that i want to convert a date in <code>\"MM-DD-YYYY\"</code> format to <code>'YYYY-MM-DD'</code> coming  from a form and save it to mysql database.As MySQL will only accept <code>'YYYY-MM-DD'</code> format.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","relationship"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13138038,"title":"retrive object id from relation in rails3","body":"<p>i have a model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n  has_many :meetings, :dependent =&gt; :destroy do \n    def find_foreign\n      Meeting.where(\"user_id &lt;&gt; ?\", id)\n    end\n  end\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me\n  # attr_accessible :title, :body\n\nend\n</code></pre>\n\n<p>and when i am trying to get user's foreign meetings like that</p>\n\n<pre><code>some_user.meetings.find_foreign\n</code></pre>\n\n<p>i get an error</p>\n\n<pre><code>NoMethodError (undefined method `id' for []:ActiveRecord::Relation):\n</code></pre>\n\n<p>because self in find_foreign is an Array. How to retrive the User.id from this method ?</p>\n"},{"tags":["ruby-on-rails-3","model"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13138693,"title":"rails before_destroy partial delete","body":"<p>I'm trying to figure out a way to partially delete/destroy dependent models in rails.</p>\n\n<p>Code looks something like this:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  has_many :subscriptions\n  has_many :photos, :dependent =&gt; :destroy\n  has_many :badges, :dependent =&gt; :destroy\n\n  before_destroy :partial_destroy\n\n  def partial_destroy\n    self.photos.destroy_all\n    self.badges.destroy_all\n    return false if self.subscriptions.any? \n  end\n...\n</code></pre>\n\n<p>Essentially, I want to destory the photos and badges, but if the user has any subscriptions, I want to keep those, and also keep the user from being destroyed.</p>\n\n<p>I tried with <code>.each { |obj| obj.destroy }</code> and using <code>delete</code> and <code>delete_all</code>, but it seems to not matter.</p>\n\n<p>It looks like rails is performing some kind of a rollback whenever the <code>before_destroy</code> returns false. Is there a way to destroy part of the dependents but not others?</p>\n"},{"tags":["ruby-on-rails-3","nested-attributes"],"answer_count":3,"favorite_count":5,"up_vote_count":7,"down_vote_count":0,"view_count":12968,"score":7,"question_id":5467158,"title":"WARNING: Can't mass-assign protected attributes","body":"<p>I get this error \"WARNING: Can't mass-assign protected attributes: races_attributes\"\n, when following this <a href=\"http://railscasts.com/episodes/196-nested-model-form-part-1\">http://railscasts.com/episodes/196-nested-model-form-part-1</a> on rails 3.</p>\n\n<p>Where Races are a component of Events. This is my models/race.rb:</p>\n\n<pre><code>class Race &lt; ActiveRecord::Base\nbelongs_to :event\n\nattr_accessible :name, :unit\nend\n</code></pre>\n\n<p>This is my models/event.rb:</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\nhas_many :races, :dependent =&gt; :destroy\n\naccepts_nested_attributes_for :races\n\nattr_accessible :name, :date, :description, :location_name, :address_one, :address_two, :city, :state, :zip, :active, :races_attributes\nend\n</code></pre>\n\n<p>Any Ideas?</p>\n"},{"tags":["ruby-on-rails-3","statemachine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13138008,"title":"State_machine throws State is invalid error on initialization","body":"<p>I cannot get state_machine to initialize</p>\n\n<p>I've stripped this down to its bare essentials</p>\n\n<pre><code>class BuddyConnection &lt; ActiveRecord::Base\n\n  attr_accessor :state\n\n  state_machine :state, :initial =&gt; :sent do\n\n  end\n\nend\n</code></pre>\n\n<p>In my controller:</p>\n\n<pre><code>buddy_invite = BuddyConnection.new\n</code></pre>\n\n<p>This does set state = \"sent\" , but buddy_invite.save! throws</p>\n\n<pre><code>ActiveRecord::RecordInvalid (Validation failed: State is invalid):\n</code></pre>\n\n<p>In my Gemfile, the default installation is version 1.0.2 (which wont even set the state on the .new, showing it as nil)</p>\n\n<p>I set the gem version to 1.1.2 and this now sets state correctly on the .new method, but both versions still throw in invalid state error on a .save!</p>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13116243,"title":"error undefined method `remote_function' (how to make Ajax calls with Rails 3 using remote_function)","body":"<p>I found that this function (remote_function) was part of the Prototype helper which was removed from the framework with Rails 3.1 and how to change on ajax?</p>\n\n<pre><code>      country\n      %select#country{:name =&gt; \"country\", :onchange =&gt; remote_function(:update =&gt; 'region_city', :url =&gt; { :action =&gt; :get_regions_cities_for_country}, :with =&gt; 'Form.Element.serialize(this)')}\n        = options_for_select( Country.find(:all).map {|u| [u.name,u.id]})\n      %div{:id =&gt; \"region_city\"}\n        region\n        %select#region{:name =&gt; \"region\", :onchange =&gt; remote_function(:update =&gt; 'city', :url =&gt; { :action =&gt; :get_cities}, :with =&gt; 'Form.Element.serialize(this)')}\n          = options_for_select(Country.find(:first).regions.find(:all).map {|u| [u.name,u.id]})\n        city\n        #{select_tag(:city, options_for_select( Country.find(:first).regions.find(:first).cities.find(:all).map {|u| [u.name,u.id]} ))}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13137590,"title":"nested attributes with fields_for and jquery","body":"<p>I have created a project where in a single page a project along with its task should be created. for this i have used nested attributes,field_for. Iam facing a issue right now. While creating a project team members are first added to the project. While creating task, these added users should be only displayed under task. As Iam using a single view page I am not able to get the selected members for the multiple tasks..</p>\n\n<p>Kindly help me...</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13131340,"title":"Using paginate while fetching results by a SQL query in ruby","body":"<p>I have the following query in my Rails Controller:</p>\n\n<pre><code>SELECT CODE_VER FROM MASTERTEST WHERE DATE&gt;= DATE_SUB(CURDATE(), INTERVAL 90 DAY) ORDER BY DATE DESC;\n</code></pre>\n\n<p>This query returns me results from the last 90 days. I display all these results in a table right now. </p>\n\n<p>I want to show only rows from 7 days at a time in some kind of pagination. I have tried will_paginate and kaminari and also paginate_by_sql. But I haven't been successful using any of them so far.</p>\n\n<p>Can someone show me the exact syntax incase of my query?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13095662,"title":"Rails 3.2.8 Remote Form Not Working","body":"<p>I have this form, which is not bound to any model, that I want to ajaxify. I've tried to figure out how to get it to submit via ajax, but I must be doing something wrong because it is not working (it just does a regular POST).</p>\n\n<p>I can confirm that the form tag renders with a 'remote' attribute, but there is not js added anywhere to the form. I also added the :confirm just to see if that would work as well. It does not.</p>\n\n<p>jquery and jquery_ujs are both loaded on the page.</p>\n\n<pre><code>  %form{ :action =&gt; \"/newsletter\", :confirm =&gt; \"Are you sure?\", :remote =&gt; true, :method =&gt; \"post\", :id =&gt; \"newsletterForm\"}\n    %p\n      = label_tag(:q, \"Subscribe to our newsletter:\")\n    %p\n      = text_field_tag(:q, nil, :placeholder =&gt; \"Your email address\")\n      = button_to(\"Subscribe\", :remote =&gt; true)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","usps"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":710,"score":0,"question_id":7163280,"title":"How to use the shipping gem in ruby on rails 3 for USPS API?","body":"<p>I've found the <code>shipping</code> gem for ruby here <a href=\"http://shipping.rubyforge.org/\" rel=\"nofollow\">http://shipping.rubyforge.org/</a> searching on google for some information on integrating  <code>USPS</code> API on a Ruby on rails application but when I install the gem and add it to my <code>Gemfile</code> as i run the <code>bundle install</code> whenever a try to run my application or a rake taks i get the following error:</p>\n\n<pre><code>/Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `require': /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping/ups.rb:109: syntax error, unexpected ':', expecting keyword_then or ';' or '\\n' (SyntaxError)\n/Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping/ups.rb:437: syntax error, unexpected keyword_end, expecting $end\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `block in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:225:in `block in load_dependency'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:596:in `new_constants_in'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:225:in `load_dependency'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping.rb:47:in `&lt;top (required)&gt;'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:68:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:68:in `block (2 levels) in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:66:in `each'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:66:in `block in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:55:in `each'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:55:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler.rb:120:in `require'\n    from /Users/myusername/railsapps/dbh4/config/application.rb:7:in `&lt;top (required)&gt;'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.7/lib/rails/commands.rb:15:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.7/lib/rails/commands.rb:15:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have removed now the gem from my <code>Gemfile</code> and my application is up and running but, I don't even know if this gem works for <code>Rails 3</code> or even if this gem works for <code>USPS</code> API.</p>\n\n<p>Any help on this? I need to integrate USPS Web Tools with my Ruby on Rails 3 Application.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13135033,"title":"Return all locales for selected field","body":"<p>Say I have a model Book</p>\n\n<pre><code>class Book\n  include Mongoid::Document\n  field :name, localize: true\n  # ... much more fields\nend\n</code></pre>\n\n<p>Now I want to query for only name only, but for all locales. Book.only(:name) seems to return the current locale, and while I could do Book.only(:name, :\"name.ar\"), it requires that I manually add all locales I have. </p>\n\n<p>Is there a way to tell Mongoid I want all locales of selected field?</p>\n"},{"tags":["ruby-on-rails-3","rspec2","refinerycms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13102632,"title":"How to write RefineryCMS controller tests without RoutingError","body":"<p>An Rspec test like this (actually taken from RefineryCMS' own test suite)</p>\n\n<pre><code>require File.expand_path(File.dirname(__FILE__) + '/../spec_helper')\n\nmodule Refinery\n  describe FastController do\n    it \"should render the wymiframe template\" do\n      get :wymiframe\n      response.should be_success\n    end\n  end\nend\n</code></pre>\n\n<p>Results in the following error:</p>\n\n<pre><code>Failure/Error: get :wymiframe\nActionController::RoutingError:\n  No route matches {:controller=&gt;\"refinery/fast\", :action=&gt;\"wymiframe\"}\n# ./spec/controllers/fast_controller_spec.rb:6:in `block (2 levels) in &lt;module:Refinery&gt;'\n</code></pre>\n\n<p>In this case, I'm using refinery 2.0.8 with Rspec 2.11, and the relevant section after running rake routes looks like:</p>\n\n<pre><code>wymiframe GET     /wymiframe(/:id)(.:format)        refinery/fast#wymiframe\n</code></pre>\n\n<p>I have tried a few other controller Rspecs which also fail with routing errors. I am of course trying to write tests for my own extra methods I am adding to vanilla Refinery controllers, but just thought I'd see if I could get a controller test working for a totally fresh refinery install. </p>\n\n<p>This must be a simple mistake! Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13135053,"title":"Customise carrierwave validation messages","body":"<p>carrierwave is giving me this validation error:</p>\n\n<blockquote>\n  <p>Image You are not allowed to upload \"pages\" files, allowed types: jpg,\n  jpeg, gif, png</p>\n</blockquote>\n\n<p>any idea how to remove the \"image\" attribute bit from the beginning? it doesn't read very well.</p>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13135427,"title":"how to make Permissions dynamic?","body":"<p>I am following this tutorial : <a href=\"http://eveloverails.wordpress.com/2011/04/02/183/\" rel=\"nofollow\">How to implement the dynamic authorization with CanCan ?</a></p>\n\n<p>I am making an application which has 5 models </p>\n\n<ol>\n<li>Articles,</li>\n<li>Users</li>\n<li>Permissions, and </li>\n<li>user_type_permission </li>\n</ol>\n\n<p>The schema is as follows:</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121025074809) do\n\ncreate_table \"articles\", :force =&gt; true do |t|\nt.string   \"name\"\nt.datetime \"created_at\", :null =&gt; false\nt.datetime \"updated_at\", :null =&gt; false\nend\n\ncreate_table \"permissions\", :force =&gt; true do |t|\nt.string   \"object_type\"\nt.string   \"action_name\"\nt.string   \"description\"\nt.datetime \"created_at\",  :null =&gt; false\nt.datetime \"updated_at\",  :null =&gt; false\nt.integer  \"user_id\"\nend\n\ncreate_table \"user_permissions\", :force =&gt; true do |t|\nt.integer  \"user_id\"\nt.integer  \"permission_id\"\nt.integer  \"roles_mask\"\nt.datetime \"created_at\",    :null =&gt; false\nt.datetime \"updated_at\",    :null =&gt; false\nend\n\ncreate_table \"user_type_permissions\", :force =&gt; true do |t|\nt.integer  \"user_type_id\"\nt.integer  \"permission_id\"\nt.datetime \"created_at\",    :null =&gt; false\nt.datetime \"updated_at\",    :null =&gt; false\nend\n\ncreate_table \"user_types\", :force =&gt; true do |t|\nt.datetime \"created_at\", :null =&gt; false\nt.datetime \"updated_at\", :null =&gt; false\nend\n\ncreate_table \"users\", :force =&gt; true do |t|\nt.string   \"email\",                  :default =&gt; \"\", :null =&gt; false\nt.string   \"encrypted_password\",     :default =&gt; \"\", :null =&gt; false\nt.string   \"reset_password_token\"\nt.datetime \"reset_password_sent_at\"\nt.datetime \"remember_created_at\"\nt.integer  \"sign_in_count\",          :default =&gt; 0\nt.datetime \"current_sign_in_at\"\nt.datetime \"last_sign_in_at\"\nt.string   \"current_sign_in_ip\"\nt.string   \"last_sign_in_ip\"\nt.datetime \"created_at\",                             :null =&gt; false\nt.datetime \"updated_at\",                             :null =&gt; false\nt.string   \"role\"\nend\n\nadd_index \"users\", [\"email\"], :name =&gt; \"index_users_on_email\", :unique =&gt; true\nadd_index \"users\", [\"reset_password_token\"], :name =&gt; \"index_users_on_reset_password_token\", :unique =&gt; true\nend\n</code></pre>\n\n<p>And the associations is as follows:</p>\n\n<pre><code>PERMISSION MODEL\n\nclass Permissions &lt; ActiveRecord::Base\nattr_accessible :action_name, :description, :id, :object_type, :user_id\nhas_many :users, :through =&gt; :user_type_permissions\nhas_many :users, :through =&gt; :user_permissions\nvalidates_presence_of \"object_type\", :action_name\nvalidates_uniqueness_of \"object_type\", :scope =&gt; [:action_name]\nend\n</code></pre>\n\n<p>User model is as follows:\n    class User &lt; ActiveRecord::Base\n     # Include default devise modules. Others available are:\n     # :token_authenticatable, :confirmable,\n     # :lockable, :timeoutable and :omniauthable</p>\n\n<pre><code> ROLES = %w[admin other]\n#  has_many :permissions, :through =&gt; :user_permissions \nbelongs_to :user_type_permissions\ndevise :database_authenticatable, :registerable,\n     :recoverable, :rememberable, :trackable, :validatable\n\n# Setup accessible (or protected) attributes for your model\nattr_accessible :email, :password, :password_confirmation, :remember_me, :role\n # attr_accessible :title, :body\n\n\n\ndef role?(role)\nreturn !!self.role.to_s.camelize\nend\n\n\nend\n</code></pre>\n\n<p>user_type_permission model is as follows:</p>\n\n<pre><code>class UserTypePermissions &lt; ActiveRecord::Base\nattr_accessible :id, :permission_id, :user_id\nhas_many :users\nhas_many :permissions\n\nend\n</code></pre>\n\n<p>article model is as follows:</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\n  attr_accessible :name\nend\n</code></pre>\n\n<p>Ability class is as follows: </p>\n\n<pre><code>class Ability\ninclude CanCan::Ability\n\ndef initialize(user)\nuser ||= User.new # guest user\n\nif user.role? :admin\ncan :manage, Article\ncan :manage, User\nelse\nuser.user_type.permissions.each do |permission|\ncan permission.action_name.to_sym, permission.object_type.constantize\nend\nend\nend\nend\n</code></pre>\n\n<p>Permissions Controller is as follows:</p>\n\n<pre><code>class PermissionsController &lt; ApplicationController\n  def index\n    @permission=Permissions.all\n  end\n\n  def edit\n    @permission = Permissions.find(params[:id])\n  end\n\n  def update\n    @permission = Permissions.find(params[:id])\n    respond_to do |format|\n      if @permission.update_attributes(params[:article])\n        format.html { redirect_to @permission, notice: 'Permission was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @permission.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def show\n    @permission = Permissions.find(params[:id])\n  end\n\n  def destroy\n    @permission = Permissions.find(params[:id])\n    @permission.destroy\n\n    respond_to do |format|\n      format.html { redirect_to permissions_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>its working is like when the user login as as admin it will have the links of list of users and the list of articles when it click on the list of users link he will have the list of registered users with four link edit,show destroy and settings.Now what i want is when the admin click on the settings link of the particular user it will have the permissions of that user only.What i did was on the settings link i gave the permissions_path which displays the Permissions List which i dont want i want the permissions of the that particular user only...</p>\n\n<p>here is the view of the permission </p>\n\n<pre><code>&lt;h1&gt;Listing Permisions&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Id&lt;/th&gt;\n    &lt;th&gt;Object_type&lt;/th&gt;\n    &lt;th&gt;Action_name&lt;/th&gt;\n    &lt;th&gt;Description&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;% @permission.each do |permission| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= permission.id%&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.object_type %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.action_name %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.description %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Show', permission %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Edit', edit_permission_path(permission) %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Destroy', permission, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>The problem with this permission view is that it is printing all the permissions in the permission model</p>\n\n<p>The users view is as given below:</p>\n\n<pre><code>&lt;h1&gt;Users&lt;/h1&gt;\n&lt;table&gt;\n  &lt;% @users.each do |user| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= link_to user.email, users_path %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Show', user %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Edit', edit_user_registration_path(user) %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Settings', permissions_path %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>And one more thing when i go for the settings link it displays the List of Permissions and there is One Column in the table named User_id which is always NIL this means Permission model and user model is not associating properly. </p>\n\n<p>May be this is the problem  of association??</p>\n\n<p>Any help would be appreciated...\nThanks</p>\n"},{"tags":["ruby-on-rails-3","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":11880975,"title":"How to determine ActiveModel::Errors validation type","body":"<p>With the migration from Rails 2 to Rails 3 validation errors were moved from ActiveRecord::Error to ActiveModel::Errors.<br>\nIn rails 2 the validation error had a type and a message (among other things) and you could check the type of the validation error by doing something like the following:</p>\n\n<pre><code>rescue ActiveRecord::RecordInvalid =&gt; e\n  e.record.errors.each do |attr, error|\n    if error.type == :foo\n      do_something\n    end\n  end\nend\n</code></pre>\n\n<p>But with Rails 3 it seems everything but the invalid attribute and message has been lost.  As a result the only way to determine the type is to compare the error message:</p>\n\n<pre><code>rescue ActiveRecord::RecordInvalid =&gt; e\n  e.record.errors.each do |attr, error|\n    if error == \"foobar\"\n      do_something\n    end\n  end\nend\n</code></pre>\n\n<p>Which is not at all ideal (eg. what if you have several validations which use the same message?).</p>\n\n<p><strong>Question:</strong><br>\nIs there a better way in rails 3.0 to determine the type of validation error?</p>\n"},{"tags":["html","ruby","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13134844,"title":"writing HTML in ruby","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10561177/what-does-mean-in-ruby\">What does “&lt;&lt;-” mean in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>I saw this in devise_helper.rb</p>\n\n<pre><code>html = &lt;&lt;-HTML\n&lt;div&gt; ... &lt;/div&gt;\nHTML\n\nhtml.html_safe\n</code></pre>\n\n<p>what is this <code>&lt;&lt;-HTML .. HTML</code> notation?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13123141,"title":"Giving specific id to FormTagHelper in rails","body":"<p>i've a form written in a <strong>HAML</strong> file  like this </p>\n\n<pre><code>= form_tag \"ratings_form\", movies_path, :method =&gt; :get do\n  Include: \n  - @all_ratings.each do |rating|\n    = rating \n    = check_box_tag \"ratings[#{rating}]\", 'yes', @ratings.keys.include?(rating)\n  = submit_tag 'Refresh'\n</code></pre>\n\n<p>and i want to give each of the <strong>Form</strong> and the <strong>Submit button</strong> a specific <strong>id</strong> </p>\n\n<p>i've checked the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html\" rel=\"nofollow\">documentation</a> and found that the parameters given to </p>\n\n<p><strong>form_tag</strong> or <strong>submit_tag</strong>  doesn't contain id .</p>\n\n<hr>\n\n<p>the correct answer is adding  :id => \"id_u_want\" to any tag and obviously it will work\nit worked when i did </p>\n\n<pre><code>= form_tag movies_path, :id =&gt; \"ratings_form\" , :method =&gt; :get do\n  Include: \n  - @all_ratings.each do |rating|\n    = rating \n    = check_box_tag \"ratings[#{rating}]\", 'yes', @selected_ratings.keys.include?(rating)\n  = submit_tag 'Refresh' , :id =&gt; \"ratings_submit\"\n</code></pre>\n"},{"tags":["ruby-on-rails-3","ssl","configuration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13130045,"title":"ERROR bad Request-Line - Force ssl - rails","body":"<p>I set force_ssl to true by accident and then when reverting to false and running server I get the following error: </p>\n\n<pre><code>ERROR bad Request-Line \n\nWEBrick 1.3.1\nINFO  ruby 1.9.3 (2012-02-16) [x86_64-darwin11.4.0]\nWEBrick::HTTPServer#start: pid=472 port=3000\nERROR bad Request-Line `\\x16\\x03\\x01\\x00?\\x01\\x00\\x00?\\x03\\x02P?Mf\\x00??C?'.\n</code></pre>\n\n<p>How can I fix this? </p>\n\n<p>When I hit http url on local host it redirects to https and gives me this error: </p>\n\n<pre><code>SSL connection error\nUnable to make a secure connection to the server. This may be a problem with the server, or it may be requiring a client authentication certificate that you don't have.\nError 107 (net::ERR_SSL_PROTOCOL_ERROR): SSL protocol error.\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13121894,"title":"How do I avoid chains of method calls like @invoice.customer.address.street etc?","body":"<p>I have some models and have views code that look like the following</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :customer\nend\n\nclass Customer &lt; ActiveRecord::Base\n  has_one :address\n  has_many :invoices\nend\n\nclass Invoice &lt; ActiveRecord::Base\n  belongs_to :customer\nend\n</code></pre>\n\n<p>This code shows a simple invoice structure, with a customer who has a single address.\nThe view code to display the address lines for the invoice would be as follows:</p>\n\n<pre><code>&lt;%= @invoice.customer.name %&gt;\n&lt;%= @invoice.customer.address.street %&gt;\n&lt;%= @invoice.customer.address.city %&gt;,\n&lt;%= @invoice.customer.address.state %&gt;\n&lt;%= @invoice.customer.address.zip_code %&gt;\n</code></pre>\n\n<p>above view code is not ideal. For proper encapsulation, the\ninvoice should not reach across the customer object to the street attribute of the\naddress object. Because if, for example, in the future your application were to change\nso that a customer has both a billing address and a shipping address, every place in\nyour code that reached across these objects to retrieve the street would break and\nwould need to change. How can I avoid this problem ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":13109872,"title":"why i lost radio button created by simple form when submit an form with error?","body":"<p>I have a form like this:  </p>\n\n<p><img src=\"http://s7.postimage.org/djw3k1hsr/new_question.png\" alt=\"new question\"></p>\n\n<p>When i submit form without any content, it shows errors:</p>\n\n<p><img src=\"http://s18.postimage.org/gkaqgv3qh/error_new_question.png\" alt=\"error new question\"></p>\n\n<p>The radio button is lost !</p>\n\n<p>This is in my form view:  </p>\n\n<pre><code>&lt;%= simple_form_for @question, defaults: { error: false } do |q| %&gt;\n\n  &lt;legend&gt;Question&lt;/legend&gt;\n  &lt;%= render \"shared/error_messages\", object: q.object %&gt;\n\n  &lt;%= q.input :content, input_html: { rows: 3, class: 'span6' } %&gt;\n  &lt;%= q.input :mark, input_html: { class: 'span1' } %&gt;\n  &lt;%= q.association :topic %&gt;\n  &lt;%= q.association :question_type %&gt;\n\n  &lt;%= q.simple_fields_for :answers do |a| %&gt;\n    &lt;%= a.input :correct, collection: [[true, 'True'], [false, 'False']],\n                                                            as: :radio_buttons,\n                                                            label: 'Answer',\n                                                            value_method: :first,\n                                                            label_method: :last,\n                                                            item_wrapper_class: 'inline'\n                                                            %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;  \n</code></pre>\n\n<p>What's i missed or wrong? I used <code>render 'new'</code> in my create action of Question controller when @question.save is false. This is my question controller:</p>\n\n<pre><code>class QuestionsController &lt; ApplicationController\n  def new\n    @question = Question.new\n    @question.answers.build\n  end\n\n  def create\n    @question = Question.new(content: params[:question][:content])\n    @question.mark = params[:question][:mark]\n    @question.topic_id = params[:question][:topic_id]\n    @question.question_type_id = params[:question][:question_type_id]\n    @question.user_id = current_user.id\n\n    if @question.save\n      if params[:question][:answers_attributes]['0'][:correct] == 'true'\n        answer = @question.answers.build(content: 'True')\n        answer.correct = true\n      else\n        answer = @question.answers.build(content: 'False')\n      end\n      if @question.save\n        flash[:success] = \"Successfully created new question.\"\n        redirect_to root_url\n      else\n        render 'new'\n      end\n    else\n      render 'new'\n    end\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13130017,"title":"Simple error in my rails app","body":"<p>I have an error in my rails app telling me that the index method is undefined.\nI have created a such simple form just for inserting data using the (new method page) only\nbut it is not working now for some reason</p>\n\n<pre><code>class PeoplesController &lt; ApplicationController\n\n  def index\n\n  end\n\n  def new\n    @people = People.new\n  end\n\n  def create\n    @people = People.new(params[:@people])\n    if @people.save\n      redirect_to new_people_path\n    end\n  end\nend\n\n\n# new.html.haml\n&lt;h2&gt;Hello there!&lt;/h2&gt;\n&lt;hr &gt;\n&lt;%= form_for @people do |f| %&gt;\n    FirstName:&lt;%= f.text_field :first %&gt;&lt;br /&gt;\n    LastName:&lt;%= f.text_field :last %&gt;&lt;br /&gt;\n    &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the error code:</p>\n\n<pre><code>    NoMethodError in Peoples#new\n\nShowing /Users/kasim/Desktop/form/app/views/peoples/new.html.erb where line #3 raised:\n\nundefined method `people_index_path' for #&lt;#&lt;Class:0x007fa33da58d58&gt;:0x007fa34031c578&gt;\nExtracted source (around line #3):\n\n1: &lt;h2&gt;Hello there!&lt;/h2&gt;\n2: &lt;hr &gt;\n3: &lt;%= form_for @people do |f| %&gt;\n4:  FirstName:&lt;%= f.text_field :first %&gt;&lt;br /&gt;\n5:  LastName:&lt;%= f.text_field :last %&gt;&lt;br /&gt;\n6:  &lt;%= f.submit %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13092509,"title":"Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory","body":"<p>I am trying to execute rake db:create command. I get following error</p>\n\n<p>Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory.</p>\n\n<pre><code>Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory.\nCould not open library 'libcurl.so': libcurl.so: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>Can anyone help me with this issue?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3178,"score":1,"question_id":6843044,"title":"Rails 3 response headers","body":"<p>Wow, what a great site! I hope this question meets the requirements :-)</p>\n\n<p>Generally, this question is about how to set response headers in Rails when using the <code>render</code> method. Specifically, I have a markdown version of a document, which I would like the browser to save as a file by default, rather than display. I have found that you can set headers with the <code>head</code> method, like this:</p>\n\n<pre><code>respond_to do |format|\n  format.html {...\n  format.text { head(:content_disposition =&gt; \"attachment\") }\nend\n</code></pre>\n\n<p>But the options for <code>render</code> don't work like this and I can't find anything to access the headers beforehand from the controller. Could anybody offer advice?</p>\n\n<p>Thanks for taking the time to read my question.</p>\n"},{"tags":["ruby-on-rails-3","heroku","github","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13132265,"title":"github: retaining imgs uploaded using paperclip when pushing an update","body":"<p>I'm currently testing in staging environment (heroku) where I have testers uploading imgs for their profiles using paperclip. However, whenever I do a git push to heroku to update the site (not changing the db), their pictures disappear. Does anyone know why this is happening and how I can get around this?</p>\n\n<p>Here's my configuration for paperclip:</p>\n\n<pre><code> has_attached_file :photo, :styles =&gt; {:thumb =&gt; \"115x100#\", :medium =&gt; \"345x300#\", :large =&gt; \"690x600#\"},\n                        :path =&gt; \":rails_root/public/system/:attachment/:id/:style/:filename\",\n                        :url =&gt; \"/system/:attachment/:id/:style/:filename\"\n</code></pre>\n\n<p>production.rb config:</p>\n\n<pre><code>config.serve_static_assets = true\nconfig.assets.compile = false\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","json","hash","reference","mongoid3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13123762,"title":"Mongoid render referenced complete object","body":"<p>I am using mongoid 3 in a rails 3 application.</p>\n\n<p>I have a client class with referenced object 'files' (so instances of a custom 'LocalisedFile' class.)</p>\n\n<p>Client.rb:</p>\n\n<pre><code>class Client\n    include Mongoid::Document\n    include Mongoid::Timestamps\n    store_in collection: 'clients'\n\n    field :name, type: String\n\n    has_many :files, class_name: 'LocalisedFile', inverse_of: :owner\nend\n</code></pre>\n\n<p>LocalisedFile.rb:</p>\n\n<pre><code>class LocalisedFile\n    include Mongoid::Document\n    include Mongoid::Timestamps\n    include Geocoder::Model::Mongoid\n    store_in collection: 'files'\n\n    belongs_to :owner, class_name: 'Client', inverse_of: :files\nend\n</code></pre>\n\n<p>No problem to manage my documents.</p>\n\n<p>But when I want to render an array of files, I just get a \"owner_id\" field with the client string id...</p>\n\n<pre><code>[(2)\n    {\n        \"_id\": \"508e85e412e86a2607000005\",\n        \"created_at\": \"2012-10-29T13:34:29Z\",\n        \"owner_id\": \"508c06e4bcd7ac4108000009\",\n        \"title\": \"Try\",\n        \"updated_at\": \"2012-10-29T13:34:29Z\",\n    },-\n    {\n        \"_id\": \"508e8c5312e86a2607000006\",\n        \"created_at\": \"2012-10-29T14:01:56Z\",\n        \"owner_id\": \"508c06e4bcd7ac4108000009\",\n        \"title\": \"2nd Try\",\n        \"updated_at\": \"2012-10-29T14:01:56Z\",\n    }-\n]\n</code></pre>\n\n<p>That's maybe normal, but I would like to get the clients informations, to use it in a JS application with Google Maps API, like this :</p>\n\n<pre><code>[(2)\n    {\n        \"_id\": \"508e85e412e86a2607000005\",\n        \"created_at\": \"2012-10-29T13:34:29Z\",\n        \"owner\": {\n            \"_id\": \"508c06e4bcd7ac4108000009\",\n            \"name\": \"Client 1\"\n        },\n        \"title\": \"Try\",\n        \"updated_at\": \"2012-10-29T13:34:29Z\",\n    },-\n    {\n        \"_id\": \"508e8c5312e86a2607000006\",\n        \"created_at\": \"2012-10-29T14:01:56Z\",\n        \"owner\": {\n            \"_id\": \"508c06e4bcd7ac4108000009\",\n            \"name\": \"Client 1\"\n        },\n        \"title\": \"2nd Try\",\n        \"updated_at\": \"2012-10-29T14:01:56Z\",\n    }-\n]\n</code></pre>\n\n<p>Anyone have an idea ?\nI would like to test something like the to_hash method but it does not work...</p>\n"},{"tags":["ruby-on-rails-3","memcached","dalli"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":11199396,"title":"Rails.cache.fetch inserting extra values","body":"<p>We have a page which shows the top groups for our application. The calculation of the leader board is expensive so we cache the results for an hour as follows:</p>\n\n<pre><code>@groupboard = Rails.cache.fetch(\"top_groups\", :expires_in =&gt; 1.hour) do  \n  Group.top_groups\nend\n</code></pre>\n\n<p>This is giving an error after the cache has been written the first time. Poking around in the console I see that Group.top_groups returns an array of items that look as follows:</p>\n\n<pre><code>[#&lt;Group id: 4, name: \"IBP\", rank: 6, users_count: 13, leader_id: 4662&gt;, 3887]\n</code></pre>\n\n<p>When I look at the result returned from the cache it looks as follows:</p>\n\n<pre><code>[#&lt;Group id: 4, name: \"IBP\", rank: 6, users_count: 13, leader_id: 4662&gt;, :@new_record_before_save], false, 3887]\n</code></pre>\n\n<p>Does anyone know what would be causing @new_record_before_save and the 'false' value to be inserted into all the entries for this object in the cache?</p>\n\n<p>We are using Dalli, Memcached 1.4.9, Rails 3.2.4, Ruby 1.9.2</p>\n"},{"tags":["ruby-on-rails-3","delayed-job"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13131845,"title":"Delayed Job character encoding issue","body":"<p>I swear this was working three hours ago when I got up from my desk. I'm using a gem called Vero that inserts some tracking data in a DJ queue to be posted to an email manager later. Now, it seems I get this error (only in development on SQLite):</p>\n\n<pre><code>ArgumentError in FrontController#index\n\ninvalid byte sequence in UTF-8\n</code></pre>\n\n<p>Not sure exactly what would've changed that this error is being thrown. Here's the log:</p>\n\n<pre><code>0.0ms)  begin transaction\n20:57:28 web.1  |   SQL (0.4ms)  INSERT INTO \"delayed_jobs\" (\"attempts\", \"created_at\", \"failed_at\", \"handler\", \"last_error\", \"locked_at\", \"locked_by\", \"priority\", \"queue\", \"run_at\", \"updated_at\") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [[\"attempts\", 0], [\"created_at\", Tue, 30 Oct 2012 00:57:23 UTC +00:00], [\"failed_at\", nil], [\"handler\", \"--- !ruby/struct:Vero::Jobs::RestPostJob\\nurl: http://www.getvero.com/api/v1/track.json\\nparams:\\n  :auth_token: E...1\\n  :development_mode: true\\n  :event_name: viewed_front_page\\n  :identity:\\n    :email: justin@domain.com\\n    :first_name: Justin\\n    :last_name: Mc\\n    :id: 3\\n    :location: Washington, District of Columbia\\n    :gender: male\\n    :_user_type: User\\n  :data:\\n    :link: http://boxfirepress.com\\n\"], [\"last_error\", nil], [\"locked_at\", nil], [\"locked_by\", nil], [\"priority\", 0], [\"queue\", nil], [\"run_at\", Tue, 30 Oct 2012 00:57:23 UTC +00:00], [\"updated_at\", Tue, 30 Oct 2012 00:57:23 UTC +00:00]]\n20:57:28 web.1  |    (0.7ms)  rollback transaction\n20:57:28 web.1  | Completed 500 Internal Server Error in 41ms\n20:57:28 web.1  | ArgumentError (invalid byte sequence in UTF-8):\n20:57:28 web.1  |   app/controllers/front_controller.rb:12:in `index'\n20:57:28 web.1  |   Rendered /Users/justin/.rvm/gems/ruby-1.9.3-p125@rails3-2/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/_trace.erb (3.0ms)\n20:57:28 web.1  |   Rendered /Users/justin/.rvm/gems/ruby-1.9.3-p125@rails3-2/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.0ms)\n20:57:28 web.1  |   Rendered /Users/justin/.rvm/gems/ruby-1.9.3-p125@rails3-2/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (5.9ms)\n</code></pre>\n\n<p>In the controller:</p>\n\n<pre><code>if current_user\n  current_user.track('viewed_front_page', {link: 'http://domain.com'})\nend\n</code></pre>\n\n<p>I use a near identical code in other controllers, and they're all throwing the same error now.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid","eager-loading"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12807228,"title":"Correctly eager loading empty array being ignored","body":"<p>I have a many-to-one relationship <code>images</code> on my <code>vehicle</code> model. I have set up a query similar to <code>Vehicle.includes(:images).find(ids)</code> Several, correctly, have an empty array loaded since these <code>vehicles</code> have no images. However, it goes back to the Mongo server, trying to find out if there are any images. The identity map is enabled and all that jazz. Eager loading seems to work for non-empty arrays.</p>\n\n<p>How would I signal to Mongoid that the empty array is correct and not to try and load them again?</p>\n"},{"tags":["mysql","sql","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13125685,"title":"Merging rows with uniqueness constraints","body":"<p>I've got a little time-tracking web app (implemented in Rails 3.2.8 &amp; MySQL). The app has several users who add their time to specific tasks, on a given date. The system is set up so a user can only have 1 time entry (i.e. row) per task per date. I.e. if you add time twice on the same task and date, it'll add time to the existing row, rather than create a new one. The <code>user_id/task_id/date</code> uniqueness is enforced by a <code>UNIQUE</code> index.</p>\n\n<p>Now I'm looking to merge 2 tasks. In the simplest terms, merging task ID 2 into task ID 1 would take this</p>\n\n<pre><code>time  | user_id  | task_id  | date\n------+----------+----------+-----------\n10    | 1        | 1        | 2012-10-29\n15    | 2        | 1        | 2012-10-29\n10    | 1        | 2        | 2012-10-29\n5     | 3        | 2        | 2012-10-29\n</code></pre>\n\n<p>and change it into this</p>\n\n<pre><code>time  | user_id  | task_id  | date\n------+----------+----------+-----------\n20    | 1        | 1        | 2012-10-29 &lt;-- time values merged (summed)\n15    | 2        | 1        | 2012-10-29 &lt;-- no change\n5     | 3        | 1        | 2012-10-29 &lt;-- task_id changed (no merging necessary)\n</code></pre>\n\n<p>I.e. merge by summing the time values, where the given user_id/date/task combo would conflict.</p>\n\n<p>I figure I can use a unique constraint to do a <code>ON DUPLICATE KEY UPDATE ...</code> if I do an insert for every task_id=2 entry. But that seems pretty inelegant.</p>\n\n<p>I've also tried to figure a way to first update all the rows in task 1 with the summed-up times, but I can't quite figure that one out.</p>\n\n<p>Any ideas?</p>\n\n<hr>\n\n<p><strong>Update:</strong> Going off of Olaf's answer below, I came up with this, which seems to be working</p>\n\n<pre><code>INSERT INTO `timetable`\n(`time`, `user_id`, `task_id`, `date`)\n(\n    SELECT\n      SUM(`time`) AS `time`,\n      `user_id`,\n      1 AS `task_id`,\n      `date`\n    FROM `timetable` AS `t1`\n    WHERE `task_id` IN (1,2)\n    GROUP BY `user_id`, `date`\n)\nON DUPLICATE KEY UPDATE `time`=VALUES(`time`);\n\nDELETE FROM `timetable` WHERE `task_id`=2;\n</code></pre>\n\n<p>I'll leave the question open in case someone has a better solution (or if there are any gotchas in my solution that I should know about)</p>\n\n<p><strong>Update 2:</strong> Don't know why I didn't realize this earlier, but my solution may do a lot of redundant INSERTs, because it also finds all the entries that only exist in the target task and don't need merging. In the above example data, the 2nd row will be found, re-inserted, trigger an on-duplicate-key, and set the time to the same as it already is. So if the target task has, say, 10 rows, and the source task 0 rows, it'll still do 10 (completely pointless) INSERTs.</p>\n\n<p>This can be avoided by wrapping the inner SELECT everything in yet another SELECT, and use <code>COUNT(*)</code> to only find those rows that need merging. Of course, this will necessitate another more queries to update the task_id of those rows that <em>don't</em> need merging (which requires a join to figure out, as far as I can tell).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13127206,"title":"Ensuring at least one item in an array exists in another","body":"<p>I have the following models:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n    has_and_belongs_to_many :countries\nend\n\nclass User &lt; ActiveRecord::Base \n    has_many :entitlements\n    has_many :countries, :through =&gt; :entitlements\nend\n</code></pre>\n\n<p>Posts on the Post index page must have at least one country that is the same as one of the Users' countries.</p>\n\n<p>I have tried various scopes in my models and lengthy controller code but I can't figure out how to check what should be a simple relationship: whether at least one item in Post.countries exists in User.countries.</p>\n\n<p>Any help greatly received.</p>\n\n<p><strong>UPDATED:</strong></p>\n\n<p>Ok, so I've got the following in my controller:</p>\n\n<pre><code>  def index\n    @user = current_user\n    @user.countries.each do |user_country|  \n       @user_country_posts += Country.find(user_country.id).posts\n    end\n    @posts = @user_country_posts\n  end\n</code></pre>\n\n<p>Which is iterating through the user.countries and finding each post for those countries. But when I run it I get:</p>\n\n<pre><code>NoMethodError: undefined method `+' for nil:NilClass\n</code></pre>\n\n<p>Any ideas what I'm doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":960,"score":3,"question_id":6009062,"title":"Remove test::unit","body":"<p>I forgot to create my application with the -T argument and now it's installed with test::unit. How do I remove test::unit and stop it from creating tests for each controller / model generated, after I have already created the application? Thank you</p>\n"},{"tags":["ruby-on-rails-3","ssl","rack"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13130867,"title":"Passing an exclude option to Rack::SSL","body":"<p>Following the guidance <a href=\"http://www.simonecarletti.com/blog/2011/05/configuring-rails-3-https-ssl/\" rel=\"nofollow\">here</a>, updated for Rails 3.2.x, I expected to be able to configure Rack::SSL to use the SSL filters only if an <code>https://</code> prefix is included:</p>\n\n<pre><code>config.force_ssl = true\nconfig.ssl_options = { :exclude =&gt; proc { |env| puts 'here? ' + env.to_s; env['HTTPS'] != 'on' } }\n</code></pre>\n\n<p>However, <code>https</code> works, where <code>http</code> fails with the following error:</p>\n\n<pre><code>[2012-10-29 15:37:03] ERROR OpenSSL::SSL::SSLError: SSL_accept returned=1 errno=0 state=SSLv2/v3 read client hello A: http request\n    /Users/user/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/openssl/ssl-internal.rb:164:in `accept'\n</code></pre>\n\n<p>The diagnostic code inserted into the lambda is not executed.  How can I configure Rack:SSL in Rails 3.2.x to respond to both HTTP and HTTPS?</p>\n\n<p>Rails 3.2.8, WEBrick configured for SSL using a self-signed cert.</p>\n"},{"tags":["ruby-on-rails-3","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":108,"score":3,"question_id":12943284,"title":"How to detect failing unit test using rake","body":"<p>I am using Ruby 1.9.3 and Rails 3.2.8. This uses rake 0.9.2.2.</p>\n\n<p>I wish to detect a failing unit test and, in Rails 2.3, we did this by checking the exit code. This no longer works.</p>\n\n<p>I try:</p>\n\n<pre><code>rake test:units TEST=test/unit/failing_test.rb RAILS_ENV=test &amp;&amp; echo \"OK\"\n</code></pre>\n\n<p>failing_test.rb consists of a single test which asserts false. I expect to see a test failure and not to see \"OK\", but instead, I see:</p>\n\n<pre><code>Started\nF\n===============================================================================\nFailure: &lt;false&gt; is not true.\ntest: failing test case should fail. (FailingTest)\ntest/unit/failing_test.rb:6:in `block (2 levels) in &lt;class:FailingTest&gt;'\nshoulda-context (1.0.0) lib/shoulda/context/context.rb:398:in `call'\nshoulda-context (1.0.0) lib/shoulda/context/context.rb:398:in `block in create_test_from_should_hash'\nactivesupport (3.2.8) lib/active_support/testing/setup_and_teardown.rb:72:in `block in run'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:425:in `_run__3774233495015181374__setup__985181848351195933__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactivesupport (3.2.8) lib/active_support/testing/setup_and_teardown.rb:70:in `run'\n===============================================================================\n\n\nFinished in 0.002753 seconds.\n\n1 tests, 1 assertions, 1 failures, 0 errors, 0 pendings, 0 omissions, 0 notifications\n0% passed\n\n363.24 tests/s, 363.24 assertions/s\nrake aborted!\nCommand failed with status (1): [/Users/chris/.rvm/rubies/ruby-1.9.3-p194/b...]\n\nTasks: TOP =&gt; test:units\n(See full trace by running task with --trace)\nOK\n</code></pre>\n\n<p>Specifically, I see \"Command failed with status (1)\", but this seems to get eaten up by rake as I also see \"OK\". Note that if I do <code>echo $?</code>, I see the exit code is 0 (success). I'm trying to get this to work in the context of our continuous integration and also with our release script, both of which assume the exit code will be non-zero in the case of an error, as happened with Rails 2.3.</p>\n"},{"tags":["ruby-on-rails-3","controller","before-filter","rescue"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13130684,"title":"rails if else check fails then rescue","body":"<p>I have 2 methods in my controller for finding the user (notice the <code>enabled_only</code> scope):</p>\n\n<pre><code>before_filter :find_user, :only =&gt; :show\nbefore_filter :find_any_user, :only =&gt; [:edit, :update, :destroy]\n\ndef find_user\n  @user = User.enabled_only.find(params[:id])\nrescue ActiveRecord::RecordNotFound\n  flash[:alert] = \"The user you were looking for could not be found\"\n  redirect_to root_path\nend\n\ndef find_any_user\n  @user = User.find(params[:id])\nrescue ActiveRecord::RecordNotFound\n  flash[:alert] = \"The user you were looking for could not be found\"\n  redirect_to root_path\nend\n</code></pre>\n\n<p>Surely these could be merged into one method that checks whether <code>:action == 'show'</code> but I couldn't get the rescue to catch the error. I tried something like the following but it didn't work:</p>\n\n<pre><code>before_filter :find_user, :only =&gt; [:show, :edit, :update, :destroy]\n\ndef find_user\n  @user = if :action == 'show'\n    User.enabled_only.find(params[:id])\n  else\n    User.find(params[:id])\n  end\nrescue ActiveRecord::RecordNotFound\n  flash[:alert] = \"The user you were looking for could not be found\"\n  redirect_to root_path\nend\n</code></pre>\n\n<p>Please advise on how this can be done.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","sms","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1618,"score":1,"question_id":4652755,"title":"send free sms from rails app","body":"<p>How can i send free sms to US numbers from a rails app. </p>\n\n<p>Is <a href=\"https://github.com/brendanlim/sms-fu\" rel=\"nofollow\">sms_fu</a> working with rails 3?</p>\n\n<p>Its not working for me :--\nAfter installing the gem.</p>\n\n<p>Steps:-\nSpecified this in my environment file</p>\n\n<pre><code> 1. sms_fu = SMSFu::Client.configure(:delivery =&gt; :action_mailer)\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>2.sms_fu.deliver(\"5558675309\",\"at&amp;t\",\"message\") is not working\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","osx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13129536,"title":"Cannot install rails on mac","body":"<p>I've been trying to install rails on my macbook, and have been having so much difficulty!\nI installed RVM, and when I run \"gem install rails,\" I get this message: </p>\n\n<pre><code>gem install rails\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.\n\n    /Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/bin/ruby extconf.rb\ncreating Makefile\n\nmake\n/usr/bin/gcc-4.2 -I. -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1/x86_64-darwin11.4.0 -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1/ruby/backward -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1 -I. -DJSON_GENERATOR -I/Users/mpapis/.rvm/usr/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common -I/opt/sm/pkg/active/include -fno-common -pipe -O3 -Wall -O0 -ggdb  -o generator.o -c generator.c\n/usr/bin/gcc-4.2 -dynamic -bundle -o generator.bundle generator.o -L. -L/Users/mpapis/.rvm/rubies/ruby-1.9.2-p320/lib -L/Users/mpapis/.rvm/usr/lib -L. -L/opt/sm/pkg/active/lib -L/usr/local/lib -Wl,-undefined,dynamic_lookup -Wl,-multiply_defined,suppress -Wl,-flat_namespace  -lruby.1.9.1  -lpthread -ldl -lobjc \nld: warning: directory not found for option '-L/Users/mpapis/.rvm/rubies/ruby-1.9.2-p320/lib'\nld: warning: directory not found for option '-L/Users/mpapis/.rvm/usr/lib'\nld: warning: directory not found for option '-L/opt/sm/pkg/active/lib'\nld: library not found for -lruby.1.9.1\ncollect2: ld returned 1 exit status\nmake: *** [generator.bundle] Error 1\n</code></pre>\n\n<p>I've tried googling solutions, but haven't found anything. Does anyone have ideas? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13129951,"title":"How can I access rails methods in a ruby script?","body":"<p>I have a ruby script in my rails app in the script directory. How can I access the <code>in_time_zone</code> method in the script?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","encoding","chardet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13129852,"title":"How do i encode files for rails 3?","body":"<p>I've been working on outlook imports (linked in exports to outlook format) but I'm having  troubles with encoding. The outlook format CSV i get from exporting my linkedin contacts are not in UTF-8 so letters like ñ are causing an exception in the mongoid_search gem when str.to_s.mb_chars.normalize is being called. I've deduced that this is because when a string is returned by mb_chars (when ruby 1.9 is used as per the docs: <a href=\"http://apidock.com/rails/String/mb_chars\" rel=\"nofollow\">http://apidock.com/rails/String/mb_chars</a> just below first code example). I guess this is a bug in the gem but regardless i am advised to sanitize the data no matter. My implementation(s) thus far:</p>\n\n<p>File Picker using their new community supported gem to upload csv. I tried three encoding detectors ( and transcoders):</p>\n\n<p>ruby port of a python lib chardet - basically sucked, had python code leftover that prevented it from even running in my app</p>\n\n<p>rchardet19 gem - detected iso-8859 with .8/1 confidence. I then tried to transcode with Iconv. Crashed on \"illegal characters\" at a ñ</p>\n\n<p>a gem Charlock_Holmes (https://github.com/brianmario/charlock_holmes). This detected windows-1252 with 33/100 confidence (i assume thats what is actually is and rchardet got iso-8859 because this ones based of that). This gem uses ICU and has a maintained branch \"bundle-icu\" which supposedly allows it to work on heroku. When i try to transcode using charlock, i get a U_FILE_ACCESS_ERROR. It is a icu error code meaning \"could not open file\" </p>\n\n<p>Anybody know what to do here?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13124575,"title":"How to maintain an order on child records when using Rails' accepts_nested_attributes_for feature?","body":"<p>I am using Rails' nifty <code>accepts_nested_attributes_for</code> for creating <code>invoices</code> and their <code>items</code>. <code>Items</code> can be added dynamically to an <code>invoice</code> with jQuery.</p>\n\n<pre><code>class Invoice &lt; ActiveRecord::Base\n  attr_accessible :project_id, :number, :date, :recipient, :items_attributes\n  accepts_nested_attributes_for :items\nend\n</code></pre>\n\n<p>This works fine. Except for the <strong>order</strong> in which Rails saves the <code>items</code>.</p>\n\n<p>For example when I create an <code>invoice</code> with these 5 <code>items</code>...</p>\n\n<pre><code>A\nB\nC\nD\nE\n</code></pre>\n\n<p>... everything works fine. But when I then hit <code>Create</code> to save the invoice plus items to the database, the order is completely randomised, for example like this:</p>\n\n<pre><code>D\nA\nC\nE\nB\n</code></pre>\n\n<p>A peek into my database and the <code>created_at</code> column of my <code>items</code> table revealed that Rails (or SQLite?) seemingly saves the <code>items</code> in a random order and not in the order in which I (as a user) added them to the <code>invoice</code>.</p>\n\n<p>Is this normal behaviour and if so how can I maintain a proper ordering on the <code>items</code> that I add to my <code>invoice</code>?</p>\n\n<p>Thanks for any help...</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13129752,"title":"How can I allow multiple Date formats in Ruby on Rails for csv file import?","body":"<p>I have a birthday column in my csv that should allow user to input <strong>multiple date formats</strong> and then the file be imported via web page. At the moment the column is only set to one type of format; <code>:birthday =&gt; (Date.strptime(row[2], \"%mm/%dd/%YY\") rescue nil),</code>.\nIs it possible to have multiple date formats?\nThanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","declarative-authorization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13113094,"title":"Why the :attribute_check in Declarative_Authorization don't found ID's","body":"<p>I have a problem since many days with Declarative_Authorization on Ruby on Rails 3.1.\nI add this on the top of each controller :</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n    # Verifies that the user is connected and/or authorized to access the methods\n    filter_access_to :all, :attribute_check =&gt; true\n\n    (...)\nend\n</code></pre>\n\n<p>It allows me to have this on my <code>authorization_rules.rb</code>:</p>\n\n<pre><code>has_permission_on [:albums], :to =&gt; [:adding] do\n    if_attribute :group =&gt; { :user =&gt; is { user } }\nend\n</code></pre>\n\n<p>But when I add <code>:attribute_check =&gt; true</code> I get this error :</p>\n\n<pre><code>Couldn't find {Model} without an ID\n</code></pre>\n\n<p>I'm totally lost, I was starting with this gem.</p>\n"},{"tags":["ruby-on-rails-3","rspec","rspec2","testunit"],"answer_count":2,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":2157,"score":16,"question_id":6728618,"title":"How can I tell Rails to use RSpec instead of test-unit when creating a new Rails app?","body":"<p>I have <code>test-unit</code> installed and <code>rspec</code> installed (along with <code>-core</code>, <code>-expectations</code>, <code>-mocks</code> and <code>-rails</code> version 2.6.x). When I run the command <code>rails new foo</code>, it uses <code>test-unit</code> to generate the test stub files instead of <code>rspec</code>.</p>\n\n<p>Is there an option where I can tell rails to use rspec to generate the tests instead?</p>\n"},{"tags":["ruby-on-rails-3","activemodel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":149,"score":1,"question_id":8936906,"title":"What's the correct way to make before_validation, etc. work in an ActiveModel","body":"<p>Should I extend or include <code>ActiveModel:Validations:Callbacks:ClassMethods</code> or <code>ActiveModel:Validations:Callbacks</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paperclip","production-environment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":1336,"score":-1,"question_id":6904797,"title":"Paperclip in production mode","body":"<p>I am successfully running my Ruby on Rails 3.0.9 application in production mode on a <a href=\"http://www.linode.com/\" rel=\"nofollow\">Linode</a> VPS. The only problem that I have is related to the Paperclip gem: it works in development mode on my local machine (this has Mac Os, Snow Leopard) but it doesn't work on the remote machine in production mode (this has Ubuntu 10.04 LTS).</p>\n\n<p>I made some research on the net and I tried to solve that problem following <a href=\"http://stackoverflow.com/questions/1635840/probem-with-paperclip-accepting-jpg-and-png-on-production\">this solution</a>:</p>\n\n<blockquote>\n  <p>On your production server, try running:</p>\n  \n  <p>which identify</p>\n  \n  <p>...</p>\n  \n  <p>If it returns something like \"/usr/bin/identify\", then you'll want to\n  set the Paperclip options in your production.rb environment file to:</p>\n  \n  <p>Paperclip.options[:command_path] = \"/usr/bin\"</p>\n</blockquote>\n\n<p>Since I get the <code>/usr/bin/identify</code>, in my environment files I have the following scenario:</p>\n\n<pre><code># `config/environments/development.rb`\nPaperclip.options[:command_path] = \"/usr/local/bin\"\n\n# `config/environments/production.rb`\nPaperclip.options[:command_path] = \"/usr/bin\"\n</code></pre>\n\n<p>Anyway in production mode Paperclip doesn't work. In development it works.</p>\n\n<p><strong>How can I solve the problem?</strong></p>\n\n<hr>\n\n<p>Following are some output:</p>\n\n<pre><code>&gt;&gt; $ &lt;project_name&gt; bundle show paperclip\n=&gt; /usr/local/lib/ruby/gems/1.9.1/gems/paperclip-2.3.16\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rest"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12807901,"title":"Should a Rails 3 RESTful PUT call return the JSON representation of the updated resource?","body":"<p>To be most compatible with practice RESTful service development and existing Javascript MVC frameworks like AngularJS and Ember.js that would be used to integrate with a RESTful service, should a resource be deserialized to JSON from a RESTful PUT call that just updates a resource?</p>\n\n<p>For example, Rails 3.2.8 seems to promote just using <code>respond_with @foobar.update_attributes(...)</code> which just returns an HTTP status code 204. However, you can specify that you want respond_with or respond_to to return the resource.</p>\n\n<p>But, this means that another call must be made to get the resource to get any updates that may have occurred on the resource in addition to the ones that were specified in the PUT call. On one hand it is nice not to have anything returned, because you may not care if it has changed, and this isn't like POST in which you are creating a new resource and may want a full representation with the new id. However, having to make another GET call to get the updated resource following the PUT, though nice that it is intentional, is additional overhead (i.e. for a PUT where you need the updated resource, you would have to PUT and then GET).</p>\n\n<p>I understand that REST leaves a lot open as to implementation, but I'd like to understand what people agree is a good practice with regard to this, at least as of October 2012 in the stated context of being used by AngularJS and Ember.js, and why.</p>\n"},{"tags":["ruby-on-rails-3","html5","jquery-ui","twitter-bootstrap","html5boilerplate"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":185,"score":2,"question_id":13118568,"title":"When to use Twitter Bootstrap and when to HTML5 Boilerplate?","body":"<p>I am pretty bad with CSS and HTML5 designing/templates. So, I google around and found two frameworks to start with nice looking layouts, necessary js and html5 support. But I don't know which on to use. </p>\n\n<p>I would appreciate your answers on </p>\n\n<ol>\n<li><p>What is the main different between two except google analytics  ?</p></li>\n<li><p>Which one is more rails friendly ?</p></li>\n<li>Which one fits best to e-commerce sites, i.e. create rich content, integrate with user management frameworks  etc?</li>\n</ol>\n"},{"tags":["ruby-on-rails-3","json","pretty-print","jbuilder"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13128485,"title":"Pretty Print JSON generated with a jbuilder template in Rails 3.2.8","body":"<p>Anyone have a way to pretty print JSON output from jbuilder? </p>\n\n<p>I can pretty print JSON generated within a controller action with something like:</p>\n\n<pre><code>JSON.pretty_generate(some_json_object) \n</code></pre>\n\n<p>but once I pass off to a jbuilder template, I'm not aware of a way to have that output pretty printed.</p>\n\n<p>Right now, my action method's render statement is simple:</p>\n\n<pre><code>render formats: :json    \n</code></pre>\n\n<p>And this successfully forces a rendering with jbuilder, regardless of input format type specified (which is my desired behavior).</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13128151,"title":"Migration files in Rails","body":"<p>I am creating a model in rails (3.2.3) and am defining what columns are to be included (hope thats correct)</p>\n\n<p>for example my first entry is</p>\n\n<pre><code> t.string :Dish_Name\n</code></pre>\n\n<p>My first question is can I use that syntax i.e. Dish_Name ?</p>\n\n<p>My second question is I want to use dropdowns to select options from the input field, so for exampel i would like to have a \"Country of origin\" with multiple options, countries of the world.</p>\n\n<p>Would it be better to have a separate DB with all the countries in and then pull in the data from the dropdown? If so could someone point me in the right direction to see how to do this? not necessarily looking for the answer just a good place to start looking</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ssl","heroku","github"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13127837,"title":"SSL, Github, and Heroku -- is pushing secure?","body":"<p>I just bought an SSL certificate for my Heroku-deployed app. Following <a href=\"https://devcenter.heroku.com/articles/ssl-certificate\" rel=\"nofollow\">their instructions</a>, I downloaded the certificate and private key, saved them in server.crt and server.key files (with some RapidSSL CA deal thrown in there), and am now planning on pushing and deploying. The worry is, my github repo is public, and I feel like it's a bad idea to push my \"private\" keys and certificates to a public site. Sort of defeats the purpose of the SSL, right?</p>\n\n<p>But how else do I get it to work without publishing this info? I'm new to SSL and coding, and I just very much do not want to throw away the security I just spent good money on because I don't understand how this all works. </p>\n\n<p>Sorry if this question wasn't very code-y. Just didn't know where better to ask.</p>\n\n<p>EDIT -- I'm looking at Heroku docs right now that say to add a Heroku SSL Add-On, and then just type </p>\n\n<pre><code>heroku certs:add server.crt server.key\n</code></pre>\n\n<p>to get heroku to pick up on the files and use the SSL Certificate. But that doesn't change the problem that I have two files in my PUBLIC repo with PRIVATE security info. Do I just add them to .gitignore or something?</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","kaminari"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13128002,"title":"How to set up \"Next 10\" and \"Prev 10\" in Kaminari","body":"<p>I am trying to step through a large set of Clients using Kaminari.\nThus far I just do this in index.html.erb:</p>\n\n<pre><code>&lt;%= paginate @clients, :outer_window =&gt; 3 %&gt;\n</code></pre>\n\n<p>which results in:</p>\n\n<pre><code>1 2 3 4 5 ... 588 589 590 Next Last\n</code></pre>\n\n<p>where \"Next\" just advances to the next one.</p>\n\n<p>I would like to get something like this (roughly)</p>\n\n<pre><code>1 2 3 4 5 ... 15 25 35 ...\n</code></pre>\n\n<p>so that the user can step through faster than one at a time. I see \"Kaminari themes\" in the documentation, but couldn't work out how to use it. Thanks...</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","facebook-graph-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13127849,"title":"Rails3 unable to connect to facebook graph","body":"<p>im trying to connect to facebook graph to send a notification to user upon friend request</p>\n\n<p>open(URI.encode(\"https://graph.facebook.com/#{@user.uid}/notifications?access_token=#{ENV['FACEBOOK_KEY']}|#{ENV['FACEBOOK_SECRET']}&amp;template=You have a friend request&amp;href=\"))</p>\n\n<p>returns OpenURI::HTTPError (400 Bad Request) which is bad. Please do note that all other variables are declared properly.</p>\n\n<p>If i edit the url to open(URI.encode(\"https://graph.facebook.com/#{@user.uid}/\")), it works!!!</p>\n\n<p>i'm suspecting that they encode the | which cost the problem, but if i just do a open(\"\") it returns invalid url.</p>\n\n<p>please help, tqvm</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","refactoring"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13127582,"title":"Rails Refactoring: Custom Method & Heavy View","body":"<p>My code current works just fine, but I can tell that it could be done better.  So I figured I would ask for some input.</p>\n\n<p>For a given expense, the user can submit, or un-submit.  This creates a record in the expense_approvals table, and sets the approval_status to 1 or 0.</p>\n\n<p>The complexity comes when someone un-submits an expense, and then later resubmits it, since the record already exists, I had to put in the logic to handle it, and a very ugly view to go with it.</p>\n\n<p>My gut tells me there are things I can do in the model, and/or controller to make this much cleaner.</p>\n\n<p>So my model looks like this:</p>\n\n<pre><code>class Expense &lt; ActiveRecord::Base\n  attr_accessible :amount, :expense_date, :description\n\n  has_one :expense_approval\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>class ExpenseApproval &lt; ActiveRecord::Base\n  attr_accessible :approval_date, :approval_status, :approver_id, :expense_id\n\n  belongs_to :expense, foreign_key: :expense_id\n\n  validates_uniqueness_of :expense_id\nend\n</code></pre>\n\n<p>and the controller</p>\n\n<pre><code>def submit_expense\n  @expense_list = Expense.all  \n  expense = Expense.find(params[:id])\n\n  if expense.expense_approval\n    approval = ExpenseApproval.find(expense.expense_approval.id)\n    approval.approval_status = 1\n  else\n    approval = ExpenseApproval.new(approval_status: \"1\", expense_id: expense.id)\n  end\n\n  if approval.save\n    #flash[:success] = \"You have added an submission.\"\n    redirect_to expense_approvals_path\n  else\n    flash[:error] = \"Error\"    \n    redirect_to expense_approvals_path\n  end\nend\n\ndef un_submit_expense\n  @expense_list = Expense.all  \n  @expense = ExpenseApproval.find(params[:id])\n  @expense.approval_status = 0\n\n  if @expense.save\n    #flash[:success] = \"You have un submitted.\"\n    redirect_to expense_approvals_path\n  else\n    flash[:error] = \"Unsubmit Error\"    \n    redirect_to expense_approvals_path\n  end\nend\n</code></pre>\n\n<p>and view</p>\n\n<pre><code> &lt;% if expense_item.expense_approval %&gt;\n              &lt;%#=expense_item.expense_approval.approval_status%&gt;\n\n              &lt;% if expense_item.expense_approval.approval_status == 1 %&gt;\n                        &lt;%= link_to raw('&lt;i class=\"icon-arrow-down icon-white\"&gt; &lt;/i&gt;'), \n                              un_submit_expense_path(expense_item.expense_approval[:id]),\n                              class: \"btn btn-mini btn-warning\", \n                              :confirm =&gt; \"Are you sure you want to un submit this expense?\" %&gt;\n              &lt;% end %&gt;\n\n              &lt;% if expense_item.expense_approval.approval_status == 0 %&gt;\n                        &lt;%= link_to raw('&lt;i class=\"icon-arrow-up icon-white\"&gt; &lt;/i&gt;'), \n                              submit_expense_path(expense_item[:id]),\n                              class: \"btn btn-mini btn-info\", \n                              :confirm =&gt; \"Are you sure you want to submit this expense?\" %&gt;\n              &lt;% end %&gt;\n\n            &lt;% else %&gt;\n\n             &lt;%= link_to raw('&lt;i class=\"icon-arrow-up icon-white\"&gt; &lt;/i&gt;'), \n                              submit_expense_path(expense_item[:id]),\n                              class: \"btn btn-mini btn-info\", \n                              :confirm =&gt; \"Are you sure you want to submit this expense?\" %&gt;\n\n            &lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unit-testing","tdd","dry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13124410,"title":"Rails: Repeating unit test - DRY?","body":"<p>Is there any standard practice to DRY-out the repeating unit test cases in rails. For e.g. I have many models with the \"name\" attribute, I want to do same kind of unit tests for each model. I vaguely see that i need to create modules are reuse? Is that possible/correct?</p>\n\n<p>Any pointers/practice to creating DRY unit test? </p>\n\n<p><strong>Example code:</strong> I want to do same kind of testing for many other models with the same named attribute.</p>\n\n<pre><code>require 'test_helper'\n\n\n# Factory class\nclass UserFactory\n\n  # Creates a valid template user\n  def self.create\n    user = User.new do |u|\n      u.name = \"Test User #{rand}\"\n      u.notes = \"test notes\"\n    end\n    user\n  end\n\nend\n\nclass UserTest &lt; ActiveSupport::TestCase\n  # ------------\n  # Init\n  # ------------\n\n  def setup\n    @valid_usr = UserFactory.create\n  end\n\n  def teardown\n    @valid_usr.destroy if @valid_usr.persisted?\n    @valid_usr = nil\n  end\n\n\n  # ------------\n  # Name\n  # ------------\n\n  test \"should not have a dummy user object\" do\n    user = User.new\n    assert !user.save\n  end\n\n  test \"unique user name must be saved\" do\n    assert UserFactory.create.save!, \"First entry must be saved\"\n\n    user = UserFactory.create\n    user.name = \"Different name\"\n    assert user.save!, \"Unique user must be saved\"\n    user.destroy\n  end\n\n  test \"non unique user names must not be saved\" do\n    user1 = UserFactory.create\n    user2 = UserFactory.create\n    user1.name = \"Same User name\"\n    user2.name = \"Same User name\"\n\n    assert user1.save!, \"First entry must be saved\"\n    assert !user2.save, \"Duplicate name should not be saved\"\n\n    user1.destroy\n    user2.destroy\n  end\n\n  test \"should not have user without a valid name\" do\n    # Invalid name\n    @valid_usr.name = \" \"\n    assert !@valid_usr.save\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13124024,"title":"How to get a nested child record to know stuff about its parent during instantiation in Ruby on Rails?","body":"<p>I have a form for creating a new <code>invoice</code> with many <code>items</code>. </p>\n\n<pre><code>class Invoice &lt; ActiveRecord::Base\n  attr_accessible :project_id, :number, :date, :recipient, :items_attributes\n  accepts_nested_attributes_for :items\nend\n</code></pre>\n\n<p>Now when I instantiate a new <code>invoice</code> and a set of containing <code>items</code>, I want these <code>items</code> to <em>know</em> something about the <code>invoice</code> they belong to even before they are saved, so I can do something like this in my <code>Item</code> model:</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\n  belongs_to :invoice\n  after_initialize :set_hourly_rate\n\n  private \n\n    def set_hourly_rate\n      if new_record?\n        self.price ||= invoice.project.hourly_rate\n      end\n    end   \n\nend\n</code></pre>\n\n<p>Right now, my code fails because the child (<code>item</code>) doesn't know anything about its parent (<code>invoice</code>) during instantiation. Only after saving the <code>invoice</code> (and thus its nested <code>items</code>), it all works out. But I want to set a default value on each new item even <strong>before</strong> it gets saved.</p>\n\n<p>How can this be done?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json","backbone.js"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13126798,"title":"Handling nested JSON in Rails without accepts_nested_attributes_for","body":"<p>I am building a Rails application to provide a JSON API to a Backbone.js frontend.</p>\n\n<p>We have a number of cases where we provide data similar to <code>label: { id: 1, name: \"My Label\" }</code>. When this is used in a select box within a form (to specify an association) we currently need to specify <code>label_id: 1</code> in posted data. We'd like the API to be more symmetrical and support the nested <code>label: { id: 1 }</code> form if possible.</p>\n\n<p>So far, I (not surprisingly) get a <code>ActiveRecord::AssociationTypeMismatch</code> error as Rails is expecting a <code>Label</code> object and receives a <code>ActiveSupport::HashWithIndifferentAccess</code> instead. I understand we can use <code>accepts_nested_attributes_for</code> if we want to support nested modification of the labels, but in this case I only want to use the nested form to specify the correct label for the association.</p>\n\n<p>Is there a good way to do this in Rails (3.2.8) that doesn't involve modifying the params hash before passing it off to the model? If not, any recommendations for the best way to robustly transform the params as they come in?</p>\n\n<p>Here's the current code I use to flatten out the params in case it is of help:</p>\n\n<pre><code>def flatten_params(hash)\n  hash.reduce({}) do |memo, (key, value)|\n    if value.class == ActiveSupport::HashWithIndifferentAccess\n      memo[(key.to_s + '_id').to_sym] = value['id']\n    else\n      memo[key] = value\n    end\n    memo\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","plugins","code-generation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13127203,"title":"Who is responsible of generating the .idea files in Rails?","body":"<p>When I'm looking on my Rails application folder i can find a <strong>.idea</strong> folder, it includes: </p>\n\n<ul>\n<li>.generators</li>\n<li>.rakeTasks</li>\n</ul>\n\n<p>And more... When i open <strong>.generators</strong> for example, i see the following:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Settings&gt;&lt;!--This file was automatically generated by Ruby plugin.\nYou are allowed to: \n1. Reorder generators\n2. Remove generators\n3. Add installed generators\nTo add new installed generators automatically delete this file and reload the project.\n--&gt;&lt;GeneratorsGroup&gt;&lt;Generator name=\"active_record:migration\" /&gt;&lt;Generator name=\"active_record:model\" /&gt;&lt;Generator name=\"active_record:observer\" /&gt;&lt;Generator name=\"active_record:session_migration\" /&gt;&lt;Generator name=\"controller\" /&gt;&lt;Generator name=\"erb:controller\" /&gt;&lt;Generator name=\"erb:mailer\" /&gt;&lt;Generator name=\"erb:scaffold\" /&gt;&lt;Generator name=\"generator\" /&gt;&lt;Generator name=\"helper\" /&gt;&lt;Generator name=\"integration_test\" /&gt;&lt;Generator name=\"mailer\" /&gt;&lt;Generator name=\"metal\" /&gt;&lt;Generator name=\"migration\" /&gt;&lt;Generator name=\"model\" /&gt;&lt;Generator name=\"model_subclass\" /&gt;&lt;Generator name=\"observer\" /&gt;&lt;Generator name=\"performance_test\" /&gt;&lt;Generator name=\"plugin\" /&gt;&lt;Generator name=\"resource\" /&gt;&lt;Generator name=\"scaffold\" /&gt;&lt;Generator name=\"scaffold_controller\" /&gt;&lt;Generator name=\"session_migration\" /&gt;&lt;Generator name=\"stylesheets\" /&gt;&lt;Generator name=\"test_unit:controller\" /&gt;&lt;Generator name=\"test_unit:helper\" /&gt;&lt;Generator name=\"test_unit:integration\" /&gt;&lt;Generator name=\"test_unit:mailer\" /&gt;&lt;Generator name=\"test_unit:model\" /&gt;&lt;Generator name=\"test_unit:observer\" /&gt;&lt;Generator name=\"test_unit:performance\" /&gt;&lt;Generator name=\"test_unit:plugin\" /&gt;&lt;Generator name=\"test_unit:scaffold\" /&gt;&lt;/GeneratorsGroup&gt;&lt;/Settings&gt;\n</code></pre>\n\n<p>As you can see: \"<strong>This file was automatically generated by Ruby plugin.</strong>\"</p>\n\n<p>So who is responsible of generating those files ? </p>\n\n<p>and how can i call it ? </p>\n\n<p>the IDE need to take care of it ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13126753,"title":"Rails, construct url for arbitrary controller,action and zero or more params","body":"<p>here is my current workflow:</p>\n\n<pre><code>c = get_some_controller # =&gt; \"fruits\" or nil\na = get_some_action # =&gt; \"list\"\np = get_some_params # =&gt; { :type =&gt; :orange, :price =&gt; 10 }\n\nurl = url_for(:controller =&gt; c, :action =&gt; a) # no option for params ??\n</code></pre>\n\n<p>So, here is my question, <code>url_for</code> seem does not have any option to pass params.</p>\n\n<p>I guess this use case is pretty common, but rails for some reason not support it or i missed something ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13123197,"title":"Rails: each in random order","body":"<p>This is my code:</p>\n\n<pre><code>    &lt;% question.answers.each do |answer| %&gt;\n\n\n      &lt;li&gt;&lt;%= answer.content %&gt;&lt;/li&gt;\n\n\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I want to order the answer objects randomly. What would be the most efficient way to do so considering the amount of possible answers is less than say 10?</p>\n"},{"tags":["ruby-on-rails-3","upload"],"answer_count":2,"favorite_count":11,"up_vote_count":12,"down_vote_count":0,"view_count":9269,"score":12,"question_id":5776252,"title":"Rails 3 - upload files to public directory","body":"<p>I'm looking for a simple way to upload a file (an xml file) to the public directory of Rails 3. Once it's there I want to open it, parse the contents and delete the file after that.</p>\n\n<p>Whenever I searched for file upload I encountered Paperclip. But I don't want to associate the file with an object. I just want to upload it. What's the easiest way to do this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","rack","middleware"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":183,"score":3,"question_id":7112604,"title":"Building middleware that grabs the IP","body":"<p>I'm trying to write my firsts rack middleware. And need help. I want middleware that find the requestor's IP and if it is in the allowed list of IP continues the request, otherwise it aborts.</p>\n\n<p>The tricky part is I need this to work on heroku where you can't use request.ip: <a href=\"http://developerhemal.tumblr.com/post/3958107290/client-ip-addresses-on-heroku\" rel=\"nofollow\">http://developerhemal.tumblr.com/post/3958107290/client-ip-addresses-on-heroku</a></p>\n\n<p>So I have the following:</p>\n\n<pre><code>class RestrictIP\n  def initialize(app, message = \"Hello\")\n    @app = app\n    @message = message\n  end\n\n  def call(env)\n    dup._call(env)\n    @ip = env['HTTP_X_REAL_IP'] ||= env['REMOTE_ADDR']\n  end\n\n  def each(&amp;block)\n    block.call(\"&lt;!-- #{@ip} --&gt;\\n\")\n    @response.each(&amp;block)\n  end\nend\n</code></pre>\n\n<p>This errors with:</p>\n\n<pre><code>NoMethodError (You have a nil object when you didn't expect it!\nYou might have expected an instance of Array.\nThe error occurred while evaluating nil.[]=):\n</code></pre>\n\n<p>For my first itteration I just want to make sure I can grab and put the requestor's IP on the html doc. </p>\n\n<p>Any rack middleware experts out there? Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13123268,"title":"How to render different partial for different type of an object belongs to other object in controller","body":"<p>I'm built app which allow users create questions are type: True/False, Single and Multiple Choice. So, I have created some models:</p>\n\n<pre><code>class QuestionType &lt; ActiveRecord::Base\n  attr_accessible :name, :shorcut\nend\n\nclass Question &lt; ActiveRecord::Base\n  attr_accessible :content, :mark, :topic_id, :question_type_id, :answers_attributes\n  belongs_to :topic\n  belongs_to :user\n  belongs_to :question_type\n  has_many :answers, dependent: :destroy\n  accepts_nested_attributes_for :answers\nend\n\nclass Answer &lt; ActiveRecord::Base\n  attr_accessible :content, :question_id, :correct\n\n  belongs_to :question\nend\n</code></pre>\n\n<p>Now i would to build an index page of questions, have 3 link to add question for 3 type of question, when users click a link, they will go to page to create question and page will have appropriate form for type of that question. In Question controller, i want to store question type id to save to question.<br>\nI think the addresses like this:</p>\n\n<p><a href=\"http://example.com/questions/index\" rel=\"nofollow\">http://example.com/questions/index</a> : Index page will have 3 link to create question.</p>\n\n<p><a href=\"http://example.com/question_types/1/questions/new\" rel=\"nofollow\">http://example.com/question_types/1/questions/new</a>: Will render partial form for True/False question</p>\n\n<p><a href=\"http://example.com/question_types/2/questions/new\" rel=\"nofollow\">http://example.com/question_types/2/questions/new</a>: Will render partial form for Single choice question</p>\n\n<p><a href=\"http://example.com/question_types/1/questions/new\" rel=\"nofollow\">http://example.com/question_types/1/questions/new</a>: Will render partial form for Multiple choice question</p>\n\n<p>I think i have to put nested resources in my routes with question type and question model to have above type of link, but i don't know how to build view and separate like above. please help me or give me an idea, better way to do it :(</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","internationalization","ruby-on-rails-3.1"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":1727,"score":7,"question_id":8829725,"title":"I18n: How to check if a translation key/value pairs is missing?","body":"<p>I am using Ruby on Rails 3.1.0 and the <a href=\"https://github.com/svenfuchs/i18n\">I18n gem</a>. I (am implementing a plugin and) I would like to check <em>at runtime</em> if the I18n is missing a translation key/value pairs and, if so, to use a custom string. That is, I have:</p>\n\n<pre><code>validates :link_url,\n  :format     =&gt; {\n    :with =&gt; REGEX,\n    :message  =&gt; I18n.t(\n      'custom_invalid_format',\n      :scope =&gt; 'activerecord.errors.messages'\n  )\n}\n</code></pre>\n\n<p>If in the <code>.yml</code> file there is not the following code</p>\n\n<pre><code>activerecord:\n  errors:\n    messages:\n      custom_invalid_format: This is the test error message 1\n</code></pre>\n\n<p>I would like to use the <code>This is the test error message 2</code>. <strong>Is it possible? If so, how can I make that?</strong></p>\n\n<p><em>BTW</em>: For performance reasons, is it advisable to check <em>at runtime</em> if the translation key/value pairs is present?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3","jquery-ui","autocomplete"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1405,"score":0,"question_id":8036143,"title":"JQuery autocomplete - Select first item","body":"<p>I am using jquery autocomplete which I am populating from a ruby on rails application and I am creating a custom autcomplete like so:</p>\n\n<pre><code>  $.widget( \"custom.code_complete\", $.ui.autocomplete, {\n    _renderMenu: function( ul, items ) {\n            var self = this,\n                currentCategory = \"\";\n        $ul = ul;\n            $.each( items, function( index, item ) {\n                if ( item.category != currentCategory ) {\n                    ul.append( \"&lt;li class='ui-autocomplete-category'&gt;\" + item.category + \"&lt;/li&gt;\" );\n                    currentCategory = item.category;\n                }\n                self._renderItem( ul, item );\n            });\n        }\n    });\n\n  $(\"#r-code\").code_complete({\n    source: \"URL\",\n    minLength: 2,\n    select: function(event, ui) {\n      $(\".button-row\").fadeIn();\n      get_details(ui.item.url);\n    }\n  });\n</code></pre>\n\n<p>I am redirecting a user from another page to the page with the autocomplete form with a parameter in the URL which is a code used for the search, here is the JS to do the search:</p>\n\n<pre><code>function ac_search(code) {\n  $(\"#r-code\").val(code);\n  $(\"#r-code\").code_complete('search', code);\n}\n</code></pre>\n\n<p>This performs the search perfectly and displays the drop down list of results.  I am trying to have the script then select the first result in the list.  I have tried doing it via a selector:</p>\n\n<pre><code>$(\".ui-menu-item:first a\").click();\n</code></pre>\n\n<p>This finds the correct element in the autocomplete list but when I try and simulate a click it gives this error:</p>\n\n<pre><code>TypeError: ui.item is null\n</code></pre>\n\n<p>Is it possible to programmatically click the first item in the autocomplete results list?</p>\n\n<p>Cheers</p>\n\n<p>Eef</p>\n"},{"tags":["ruby-on-rails-3","activerecord","namespaces","autoload"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13125036,"title":"Rails namespaced models autoloading issue?","body":"<p>Here's the setup:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  has_many :project_subject_areas, class_name: \"Project::SubjectArea\"\n  has_many :subject_areas, through: :project_subject_areas\nend\n\nclass SubjectArea &lt; ActiveRecord::Base\n  has_many :project_subject_areas, class_name: \"Project::SubjectArea\"\n  has_many :projects, through: :project_subject_areas\nend\n\nclass Project::SubjectArea &lt; ActiveRecord::Base\n  belongs_to :project\n  belongs_to :subject_area, class_name: '::SubjectArea'\nend\n</code></pre>\n\n<p>Running this in Rails:</p>\n\n<pre><code>[ SubjectArea.to_s, Project::SubjectArea.to_s ].inspect\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>[\"SubjectArea\", \"SubjectArea\"]\n</code></pre>\n\n<p>but running this (after server restart):</p>\n\n<pre><code>[ Project::SubjectArea.to_s, SubjectArea.to_s ].inspect\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>[\"Project::SubjectArea\", \"SubjectArea\"]\n</code></pre>\n\n<p>file structure is:</p>\n\n<pre><code>models/project.rb\nmodels/subject_area.rb\nmodels/project/subject_area.rb\n</code></pre>\n\n<p>I can bypass this with <code>require project/subject_area</code> manually, but am I doing something wrong with this namespacing?</p>\n\n<p>Is there any other way to namespace my models?</p>\n\n<p>When Rails generates namespaces <code>rails generate Project::X</code> I get Project as a module, but I need it to be an ActiveRecord class. I also have some other models that belong to Project and I really want them to be namespaced and in models/project/ directory.</p>\n"},{"tags":["ruby-on-rails-3","factory-girl","cancan"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13122807,"title":"CanCan abilities working in application but not in test","body":"<p>I have the following definition in my ability.rb file:</p>\n\n<pre><code>    can :index, Call, :country_id =&gt; user.countries\n</code></pre>\n\n<p>I am trying to only index Calls whose country_id is in current user's countries array.</p>\n\n<p>This seems to be working when I try it: It only shows me calls that have been tagged by countries that the current_user is a member of.</p>\n\n<p>However, I have the following test which I can't seem to get to pass:</p>\n\n<pre><code>  before :each do\n    # Users\n    @admin = FactoryGirl.create(:user, admin: true)\n  end\n\n  it \"should show the call index page with just calls that have the same country tags as them\" do\n    anotheruser1 = FactoryGirl.create(:user)\n    anotheruserscall1 = FactoryGirl.create(:call, user_id: anotheruser1.id)\n    anotheruser2 = FactoryGirl.create(:user)\n    anotheruserscall2 = FactoryGirl.create(:call, user_id: anotheruser2.id)\n    @admin.countries &lt;&lt; anotheruserscall1.country\n    ability = Ability.new(@admin)\n    ability.should be_able_to(:index, anotheruserscall1)\n    ability.should_not be_able_to(:index, anotheruserscall2)\n  end\n</code></pre>\n\n<p>But I get a failure:</p>\n\n<pre><code>Failures:\n\n  1) Admin ability should show the call index page with just calls that have the same country tags as them\n     Failure/Error: ability.should be_able_to(:index, anotheruserscall1)\n       expected to be able to :index #&lt;Call id: 1, subject: \"Natus qui fuga ut.\", description: \"Consequatur aut veritatis earum dolor. Reprehenderi...\", from: \"2012-10-25 18:43:23\", to: \"2012-10-25 19:43:23\", user_id: 7, status: \"Tentative\", created_at: \"2012-10-29 13:41:07\", updated_at: \"2012-10-29 13:41:07\", expert_id: nil, country_id: 1&gt;\n     # ./spec/models/ability_spec.rb:291:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Any help greatly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","full-text-search","elasticsearch","tire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13125047,"title":"Tire and Elastic Search - Object Associations","body":"<p>I'm having a little difficulty with the Tire and Elastic Search functionality.</p>\n\n<p>I have a Listing that has a Property. I'm trying to get a basic search form working so that I can create a query from the Property.</p>\n\n<pre><code># listings/index.html.erb\n\n&lt;%= form_tag searches_listings_path, method: :get do %&gt;\n  &lt;p&gt;\n    &lt;%= text_field_tag :query, params[:query] %&gt;\n    &lt;%= text_field_tag :property_postcode, params[:property_postcode] %&gt;\n    &lt;%= submit_tag \"Search\", name: nil %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>At the moment, whenever I try filtering down the search results, it seems like the property_postcode is being ignored and all results are being returned.</p>\n\n<pre><code>      # Listing.rb\ninclude Tire::Model::Search\n      include Tire::Model::Callbacks\n\n  mapping do\n    indexes :id, type: 'integer'\n    indexes :title, boost: 10\n    indexes :description, analyzer: 'snowball'\n    indexes :posted_at, type: 'date'\n    indexes :property do\n      indexes :postcode, :type =&gt; 'string'\n    end\n  end\n\n  def self.search(params)\n\n    tire.search(page: params[:page], per_page: 5, load: true) do\n      query do\n        boolean do\n          must { string params[:query], default_operator: \"AND\" } if params[:query].present?\n          must { term \"property.postcode\", params[:property_postcode] } if params[:property_postcode].present?\n        end\n      end\n        end\n      end\n\n   def to_indexed_json\n    to_json(:include =&gt; { \n              :property =&gt; {\n                :only =&gt; [:postcode]\n              }\n            })\n    end\n</code></pre>\n\n<p>And finally for the property</p>\n\n<pre><code>#Property.rb\nclass Property &lt; ActiveRecord::Base\n  belongs_to  :listing, touch: true\n  after_touch() { tire.update_index }\nend\n</code></pre>\n\n<p>Then finally </p>\n\n<pre><code>rake environment tire:import CLASS=Listing FORCE=true\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Ryan</p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13103206,"title":"Testing rails engine helpers with rspec","body":"<p>I've searched a bit but I can't find a good explanation about it so here is my question.</p>\n\n<p>I'm writing a Rails engine that only adds helpers.</p>\n\n<p>The structure is like this (the important part):</p>\n\n<pre><code>my_engine/\n  -- app/\n     -- helpers/\n        -- my_engine/\n           -- my_engine_helper.rb\n  -- spec/\n     -- dummy/\n     -- spec_helper.rb\n</code></pre>\n\n<p>My <code>spec_helper.rb</code> is the following:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code># Configure Rails Envinronment\nENV['RAILS_ENV'] = 'test'\nrequire File.expand_path('../dummy/config/environment.rb',  __FILE__)\n\nrequire 'rspec/rails'\n\nENGINE_RAILS_ROOT = File.join(File.dirname(__FILE__), '../')\n\n# Requires supporting ruby files with custom matchers and macros, etc,\n# in spec/support/ and its subdirectories.\nDir[File.join(ENGINE_RAILS_ROOT, 'spec/support/**/*.rb')].each { |f| require f }\n\nRSpec.configure do |config|\n  config.use_transactional_fixtures = true\nend\n</code></pre>\n\n<p>So far so good, but I'm not sure about how to test my helper.\nI would like to know what is the best way to:</p>\n\n<ul>\n<li>organize the test files </li>\n<li>test that the dummy app can use the helper</li>\n<li>test the helper itself</li>\n</ul>\n\n<p>For now I get the following error when running the spec:</p>\n\n<pre><code>undefined local variable or method `helper' for #&lt;RSpec::Core::ExampleGroup::Nested_1::Nested_1:0x007fcee8b0f4a0&gt;\n</code></pre>\n\n<p>with the following test:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'spec_helper'\n\nmodule MyEngine\n  describe MyEngineHelper do\n    describe '#something' do\n      it \"does something\" do\n        helper.something.should be_true\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Thank you !</p>\n"},{"tags":["ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13064599,"title":"excel import is not working with spreadsheet gem","body":"<p>I am using Spreadsheet gem to import excel data to database. my view is:-</p>\n\n<pre><code>&lt;% form_for :dump, :url=&gt;{:action=&gt;\"excel_import\"}, :html =&gt; { :multipart =&gt; true } do |f| -%&gt;\n Select an Excel File :\n &lt;%= f.file_field :excel_file -%&gt;\n &lt;%= submit_tag 'Submit' -%&gt;\n&lt;% end -%&gt;\n</code></pre>\n\n<p>and my controller is :-</p>\n\n<pre><code>require 'spreadsheet'\n\ndef excel_import\n Spreadsheet.client_encoding = 'UTF-8'\n book = Spreadsheet.open params[:dump][:excel_file]\n sheet1 = book.worksheet 0\n sheet1.each do |row|\n TimeSheet.new(:ac_no =&gt; row[0]).save\n end\nend\n</code></pre>\n\n<p>Parameters:-</p>\n\n<pre><code> {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"vhyy1pzYJpM9hCdgP5AiFC1Pv0UtbpLSzStZDWiZzs8=\", \"dump\"=&gt;{\"excel_file\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x9a8f5f8 @original_filename=\"SwipeData_DeliveryTeam_Sep12.xls\", @content_type=\"application/vnd.ms-excel\", @headers=\"Content-Disposition: form-data; name=\\\"dump[excel_file]\\\"; filename=\\\"SwipeData_DeliveryTeam_Sep12.xls\\\"\\r\\nContent-Type: application/vnd.ms-excel\\r\\n\", @tempfile=#&lt;File:/tmp/RackMultipart20121025-4534-n7pw14&gt;&gt;}, \"commit\"=&gt;\"Submit\"}\n</code></pre>\n\n<p>when i am trying to upload excel file and click on submit button, I am getting error:-</p>\n\n<pre><code> can't convert ActionDispatch::Http::UploadedFile into String\n</code></pre>\n\n<p>I have taken the reference from <a href=\"http://openrails.blogspot.in/2011/06/xls-import-using-spreadsheet.html\" rel=\"nofollow\">blog</a></p>\n\n<p>can anyone please tell me what is going wrong in this code.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13065741,"title":"Rails app for multiple domains","body":"<p>I need to create a service with the same five sites and one that will unite them, but everyone has to live on a separate domain. Maybe somehow run one instance Rails app redirect users depending on the domain? Or is it better to start on a new Rails app per instance?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","table","will-paginate","infinite-scroll"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13001593,"title":"Rails Endless Page / Infinite Scroll","body":"<p>I asked this same question yesterday, but I do not think I was clear enough with what I wanted. I am using twitter bootstrap and will_paginate, and I have a table on which I would like to implement infinite scrolling. That table is a fixed length and already scrolls. I recently followed the revised version of Railscasts Episode #114, but it does not work for me. When I scroll to the bottom of the table, it says fetching more articles, but it does not actually fetch more articles. Here is my code:</p>\n\n<p><strong>Articles.js.coffee:</strong></p>\n\n<pre><code>    jQuery -&gt;\n  if $('.pagination').length\n          $(articles).scroll -&gt;\n                  url = $('.pagination .next_page').attr('href')\n                  if url &amp;&amp;  $(articles).scrollTop() &gt; $(document).height() -             \n                  $(articles).height() + 585\n                      $('.pagination').text('Fetching more players...')\n                      $.getScript(url)\n    $(articles).scroll()\n</code></pre>\n\n<p><strong>Index.js.erb:</strong></p>\n\n<pre><code>$('#articles').append('&lt;%= j render(@articles) %&gt;');\n&lt;% if @articles.next_page %&gt;\n$('.pagination').replaceWith('&lt;%= j will_paginate(@articles) %&gt;');\n&lt;% else %&gt;\n$('.pagination').remove();\n&lt;% end %&gt;\n</code></pre>\n\n<p>My controller and table are both called Articles. I do not know if it is not working because it is a table versus a whole page. </p>\n\n<p>Please let me know if I need to post any more files.\nAny help would be appreciated</p>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["ruby-on-rails-3","sphinx","thinking-sphinx"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13124082,"title":"tell thinking sphinx to only index the latest element in a has_many relationship","body":"<p>A post has many wiki entries... but only the latests makes sense to be searchable.\nUnfortunately, while the has_many and has_one relationships work fine, Thinking sphinx will always index the OLDEST wikis on each post... any hint ?  </p>\n\n<pre><code>has_many :wikis, :as =&gt; :source, :order =&gt; \"updated_at DESC\"\nhas_one :latest_wiki, :class_name =&gt; \"Wiki\", :conditions =&gt; \"source_type = 'BlogPost'\", :foreign_key =&gt; :source_id, :order =&gt; \"wikis.updated_at DESC\"##used for sphinx to only index the latest revision\n\n\ndefine_index do\n  indexes latest_wiki.data, :as =&gt; :post_data\n  indexes latest_wiki.title , :as =&gt; :post_title\n  indexes blob\n  has published, :type =&gt; :boolean\n  has id\nend\n</code></pre>\n\n<p>this will generate the following conf.. which clearly shows the has_one is not understood properly  :</p>\n\n<pre><code>    source blog_post_core_0\n    {\n      type = mysql\n      sql_host = localhost\n      sql_user = root\n      sql_pass = diveboard\n      sql_db = diveboard\n      sql_query_pre = SET NAMES utf8\n      sql_query_pre = SET TIME_ZONE = '+0:00'\n      sql_query = SELECT SQL_NO_CACHE `blog_posts`.`id` * CAST(10 AS SIGNED) + 0 AS `id` , `wikis`.`data` AS `post_data`, `wikis`.`title` AS `post_title`, `blog_posts`.`blob` AS `blob`, `blog_posts`.`id` AS `sphinx_internal_id`, 0 AS `sphinx_deleted`, 1270887957 AS `class_crc`, `blog_posts`.`published` AS `published`, `blog_posts`.`id` AS `id` FROM `blog_posts` LEFT OUTER JOIN `wikis` ON `wikis`.`source_id` = `blog_posts`.`id` AND source_type = 'BlogPost' WHERE (`blog_posts`.`id` &gt;= $start AND `blog_posts`.`id` &lt;= $end) GROUP BY `blog_posts`.`id` ORDER BY NULL\n      sql_query_range = SELECT IFNULL(MIN(`id`), 1), IFNULL(MAX(`id`), 1) FROM `blog_posts`\n      sql_attr_uint = sphinx_internal_id\n      sql_attr_uint = sphinx_deleted\n      sql_attr_uint = class_crc\n      sql_attr_uint = id\n      sql_attr_bool = published\n      sql_query_info = SELECT * FROM `blog_posts` WHERE `id` = (($id - 0) / 10)\n    }\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","database","ruby-on-rails-3","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":60,"score":5,"question_id":13122791,"title":"Rails: Validation in model vs migration","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2367281/ruby-on-rails-is-it-better-to-validate-in-the-model-or-the-database\">Ruby on Rails: Is it better to validate in the model or the database?</a>  </p>\n</blockquote>\n\n\n\n<p>I see that it's possible to add same constraint/validation in both Rails model and migration. But which one is the best approach? Is it a good practice to validate both at model and database level (and why)? or they same in rails? </p>\n\n<p>For e.g.  We can do same validation  for name in both model and migration</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  validates :name, :uniqueness =&gt; true, :presense =&gt; true\nend\n\nclass CreateUser &lt; ActiveRecord::Migration\n  def change\n    create_table :users do |t|\n      t.string :name, :unique =&gt; true, :null =&gt; false\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13123130,"title":"Rails + Read json from remote site","body":"<p>I was wondering if it is possible with rails to read in the json content of an external Joomla website?</p>\n\n<p>Would I need to use Nokogiri to complete such a task?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13123451,"title":"Two-tiered models and controllers in Rails","body":"<p>New to Rails and having a hard time envisioning how to proceed with a project.  I would like to create a simple page where users:</p>\n\n<p>a) select a \"project\", sends to project page\nb) from project page, can repeatedly query an API and get results</p>\n\n<p>As I'm still wrapping my head around scaffolding and creating models and controllers, I'm wondering if the following makes sense:</p>\n\n<pre><code>rails generate Project person:string\nrails generate API_call title:string response:text\n</code></pre>\n\n<p>I suppose my question is then, how do I link entries in the API_call table to specific projects?  Is this the \"references\" option?</p>\n\n<p>many thanks in advance... </p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13122991,"title":"on duplicate key wierd issue","body":"<p>I'm using sql query in my project, with next code:</p>\n\n<pre><code>ActiveRecord::Base.connection.execute \"insert into open_offer_counters (offer_id, udid, open_counter) values #{opened_events.join(\", \")} on duplicate key update open_counter = open_counter + 1\"\n</code></pre>\n\n<p>I've added </p>\n\n<pre><code>add_index :open_offer_counters, :offer_id, :unique =&gt; true\nadd_index :open_offer_counters, :udid,  :unique =&gt; true\n</code></pre>\n\n<p>into one of migrations. But when i'm trying to add some record with only 1 duplicate key, that doesnt works, but instead update key happens. Basically this code works if only 2 keys(offer_id and udid) are different. If any of them match other one, AR updates my open_counter. How do i make update open_counter if only 2 keys matched(offer_id and udid)?</p>\n"},{"tags":["facebook","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13123293,"title":"My web app not showing on facebook native app","body":"<p>My app is showing on facebook desktop, m.facebook.com, but not on the native app?</p>\n\n<p>I meant not showing on bookmark or favorite. When I search for it within the native app I can find it. </p>\n\n<p>According to the documentation it should also appear on the native Facebook app bookmark?</p>\n\n<p>Can anyone please advise what did I do wrong? I have set the mobile web setting already. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solaris","phusion-passenger","unicorn"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13123115,"title":"How can i install Unicorn with Apache on Solaris OS in rails 3 application?","body":"<p>I am using,</p>\n\n<pre><code>ruby 1.9.2p180 \nRails 3.0.5 \nPhusion Passenger version 3.0.13\n</code></pre>\n\n<p>I have problem with Phusion passenger it frequently shut down in production enviornment.</p>\n\n<p>So i want to shift my app with <code>Apache + Unicorn combination.</code></p>\n\n<p>So can somebody please help me.</p>\n\n<p>I am premium member of <code>Joyent(Cloud support) with Solaris OS.</code></p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email","dynamic-content","html-safe"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13117805,"title":"How to render html from a text column field in database?","body":"<p>I have an column in database as <strong>welcome_emil</strong> of type <strong>TEXT</strong>.</p>\n\n<p>I have saved the following code content saved in column as :</p>\n\n<pre><code>Thanks for Joining in!     \\r\\n\\r\\nYou can loginor refer your friends using your %referral_link%.\"\n</code></pre>\n\n<p>When i try to render this code into my email that is sent to the user. Complete content goes fine but </p>\n\n<pre><code>  \\r\\n\\r\\n\n</code></pre>\n\n<p>this is omitted and all text appear inline.</p>\n\n<p>Here is the code that i use</p>\n\n<pre><code>  &lt;%= p  @company.welcome_email.gsub('%referral_link%',@recipient.referral_link).html_safe %&gt; \n</code></pre>\n\n<p>Here is the screenshot how it looks like in email</p>\n\n<p><img src=\"http://i.stack.imgur.com/oTHlq.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails-3","delayed-job"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13122969,"title":"delayed_job: attribute accessor values are not stored in delayed_jobs table in rails 3 after upgrade from rails 2","body":"<p>How we did this in rails2 was: For a job class we set a bunch of attr_accessor methods for the job object and enqueue the object into delayed_jobs table and those accessor values are stored in the table as well. (we were using delayed_job 2.0.3)</p>\n\n<p>But in rails3 even though we follow the same procedure as in rails2, the attr_accessor values are not stored into the table. Can anybody tell me how we persist the accessor values into the table with the new delayed_job gem(3.0.3)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd","bdd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13121205,"title":"Simplifying and correct RSpec controller tests","body":"<p>I have a few RSpec controller tests.  Some work, some don't, and I'm trying to figure out how on Earth to fix them up and make them more efficient</p>\n\n<p>Ideally, I would like to see if I can get each spec into the following form</p>\n\n<pre><code>subject { ... }\n  it { ... }\n  it { ... }\n  it { ... }\n</code></pre>\n\n<p>Note that for all of my controller specs I've written macros for the actual controller actions.  The macros are all tested and all work, and the names make it fairly obvious what they do.</p>\n\n<p>My \"Create\" test:</p>\n\n<pre><code>formats ||= [\"html\", \"js\"]\nformats.each do |format|\n  context \"valid attributes\" do\n    subject { do_post_create( :customer, valid_attributes, format ) }\n      its(:response_code) { should eq(302)}\n      it { should redirect_to admin_customer_path(Customer.find_by_id(???))}\n      it { expect { subject }.to change(Customer, :count).by(1) }\n  end\n\n  context \"invalid attributes\" do\n    subject { do_post_create( :customer, invalid_attributes, format ) }\n      its(:response_code) { should eq(200)}\n      it { should render_template :new }\n      it { expect { subject }.to_not change(Customer, :count).by(1) }\n  end\nend\n</code></pre>\n\n<p>In that spec, I've been trying to figure out some way to get the ID of the newly created object from the post statement.  I've tried \"Customer.last\", but that doesn't seem to work.  Any thoughts?</p>\n\n<p>My \"Update\" spec:</p>\n\n<pre><code>formats ||= [\"html\", \"js\"]\nformats.each do |format|\n  context \"valid attributes\" do\n    let(:object) { FactoryGirl.create(:customer) }\n    subject { do_put_update( class_to_symbol(model), object.id, attributes, format ) }\n      its(:response_code) { should eq(302)}\n\n    it \"does alter #{model}\" do\n      do_put_update( class_to_symbol(model), object.id, attributes, format )\n      assigns(:customer).should eq(object)\n      flash[:notice].should =~ /Success/\n      object.reload\n      attributes.each do |key, value|\n        object.send(key.to_s).should eq(value)\n      end\n    end\n  end\n  context \"invalid attributes\" do\n    let(:object) { FactoryGirl.create(\"customer\") }\n    let(:invalid_attributes) { {:username =&gt; \"!\"} }\n    subject { do_put_update( class_to_symbol(model), object.id, invalid_attributes, format ) }\n      its(:response_code) { should eq(200)}\n\n    it \"does not alter #{model}\" do\n      do_put_update( class_to_symbol(model), object.id, invalid_attributes, format )\n      assigns(:customer).should eq(object)\n      flash[:notice].should =~ /Fail/\n      object.reload\n      attributes.each do |key, value|\n        object.send(key.to_s).should_not eq(value)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In the Update test, I would like to try to express the second block in a more concise way, ideally in a way that I can use the same \"subject\" statement for all of the tests.  Is that possible?</p>\n"},{"tags":["ruby-on-rails-3","actionscript-3","encoding","urlencode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13120419,"title":"whats the encoding type to use to store jpg within http raw post data?","body":"<p>As I am sending a jpg image from Flash Player with a URL request header like this:</p>\n\n<pre><code>var header:URLRequestHeader = new URLRequestHeader(\"Content-type\", \"application/octet-stream\");\n</code></pre>\n\n<p>What would be the encoding type at server side ?</p>\n\n<p>I tried to store the raw post with a temp file :</p>\n\n<pre><code>temp_file = Tempfile.new(['temp', '.jpg'], :encoding =&gt; 'ascii-8bit')\n</code></pre>\n\n<p>but, the resulted file is corrupted&amp; can't be opened, what would be the encoding type to be used with <code>application/octet-stream</code> ?</p>\n\n<p>EDIT:\nHere is the resulted image, which can't be opened:\n<img src=\"http://i.stack.imgur.com/4Bb8V.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails-3","csv","stylesheet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13117593,"title":"Two data in same column display above/below when create CSV file in stylesheet using rails","body":"<p><img src=\"http://i.stack.imgur.com/oEwJE.png\" alt=\"enter image description here\"></p>\n\n<p>I am create CSV file using rails coding but i have issue two contact data display in same column in continue.. so data not display in good format.</p>\n\n<p>Currently display data like:</p>\n\n<pre><code>-------------------------------\n|email:1@gmail.comphone:3453453|   \n-------------------------------\n</code></pre>\n\n<p>I want to display like: </p>\n\n<pre><code>-------------------\n|email:1@gmail.com|\n|phone:3453453    | \n-------------------\n</code></pre>\n\n<p>in same column.</p>\n\n<p>I am using below code:</p>\n\n<pre><code>     dpwn_text = \"#{t('email')}: #{d.contact}\" + \"#{t('PhoneNo')}: #{d.phoneno}\" \n\n     tmp_file = \"#{Rails.root}/app/assets/images/temp.csv\"\n\n     File.open(tmp_file, 'wb') do |f|  \n       f.write dpwn_text\n     end\n\n     send_data(dpwn_text, :type =&gt; 'text/csv; charset=utf-8; header=present', :filename =&gt; \"publishers.csv\")\n     return\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13119664,"title":"rails multiple outer joins syntax","body":"<p>I have the following models</p>\n\n<p>user</p>\n\n<pre><code>has_many :leave_balances\n</code></pre>\n\n<p>leave_balance</p>\n\n<pre><code>belongs_to :user\nbelongs_to :leave_type\n</code></pre>\n\n<p>leave_type</p>\n\n<pre><code>has_many :leave_balances\n</code></pre>\n\n<p>I want to output a table format showing user names and their balance by leave type.\nNot every user can have every balance i.e. outer joins required.</p>\n\n<p>I'd like to see something like this:</p>\n\n<pre><code>Employee   Annual Leave   Sick Leave\nBob        10 \nFred                      9\nSara       12             15\n</code></pre>\n\n<p>I am unsure how to get this out as a single statement?</p>\n\n<p>I am thinking something like User.joins(:leave_balances).joins(:leave_type) </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13121928,"title":"factory girl error","body":"<p>Am getting an error when am running my test file.</p>\n\n<pre><code>factory.rb:334:in `factory_by_name': No such factory: user (ArgumentError)\n</code></pre>\n\n<p>I have the user model but still why am getting this error?\nMy factories.rb contains:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :user do |u|\n    u.sequence(:email) {|n| \"#{n}@email.com\"}\n    u.login 'Joe'\n    u.password 'password'\n    u.password_confirmation 'password'\n    u.phone '1111111111'\n    u.gender 'F'\n    u.active '1'\n    u.social_profile_active '1'\n  end\nend\n</code></pre>\n\n<p>in test_helper.rb</p>\n\n<pre><code>ENV[\"RAILS_ENV\"] = \"test\"\nrequire File.expand_path('../../config/environment', __FILE__)\nrequire 'rails/test_help'\nrequire 'factory_girl'\n#Factory.find_definitions\n\nclass ActiveSupport::TestCase\n  # Setup all fixtures in test/fixtures/*.(yml|csv) for all tests in alphabetical order.\n  #\n  # Note: You'll currently still have to declare fixtures explicitly in integration tests\n  # -- they do not yet inherit this setting\n  #fixtures :all\n\n  # Add more helper methods to be used by all tests here...\nend\n</code></pre>\n\n<p>my ruby version is 1.8.7 and rails3.0.1</p>\n\n<p>And my gemfile looks like this:\ngroup :test do\n  gem 'shoulda'\n  gem 'factory_girl_rails'\n  gem 'mocha'\nend</p>\n"},{"tags":["ruby-on-rails-3","amazon-s3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13121726,"title":"S3 and Rails 3.2: StringToSign difficulties with DELETE request. \"SignatureDoesNotMatch\" Error","body":"<p>I think my problem stems from my lack of understanding of S3 Policy Documents and StringToSign, and how they fit into a Rails app.</p>\n\n<p>I'm attempting to delete an image from my S3 bucket, and ran into this error. Incidentally, I'm using Transloadit to directly upload the image to S3, so I didn't have this problem on the POST side.</p>\n\n<p>Using the aws-sdk gem.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n\n  belongs_to :article\n  attr_accessible :file_type, :link, :title\n\n\n  def destroy\n      s3 = AWS::S3.new(:access_key_id =&gt; AWS_KEY, :secret_access_key =&gt; AWS_SECRET)\n      bucket = s3.buckets[AWS_BUCKET]\n      s3_link = self.link\n      bucket.objects[s3_link].delete    \n      super()\n  end\nend\n</code></pre>\n\n<p>\"self.link\" is the S3 object key. When I use the Rails console, it works fine, and I'm able to delete images using that key without a problem.</p>\n\n<p>I know I need to create a Policy doc and StringToSign somewhere. I just don't know where I need to do this, and how ?</p>\n\n<p>Any help would be kindly appreciated. Thank you.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","heroku","https"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":133,"score":1,"question_id":12387645,"title":"'EOFError: end of file reached' on HEROKU while posting UTF-8 via SSL","body":"<p>I've got strange bug on heroku. To reproduce it I have to make big (over few KB) HTTPS POST with any UTF-8 characters in request body. Here is an example:</p>\n\n<pre><code>require \"net/https\"\nrequire \"uri\"\n\n#Accutally I've ecountered this bug while posting to another server\nurl = URI.parse(\"https://api.heroku.com/myapps\")\n\n#It's Ukrainian 'oiced velar plosive G' letter\npayload = \"ґ\"*10000\nrequest = Net::HTTP::Post.new(url.path)\nrequest.body = payload\nhttp = Net::HTTP.new(url.host, url.port)\nhttp.use_ssl = true\nhttp.read_timeout = 500\nhttp.start {|http| http.request request }\n</code></pre>\n\n<p>Running such script on local machine's irb gives me:</p>\n\n<pre><code>#&lt;Net::HTTPUnauthorized 401 Unauthorized readbody=true&gt; \n</code></pre>\n\n<p>...which is expected, but on heroku cedar, runing it on 'heroku console' ... in about 60sec I get:</p>\n\n<pre><code>EOFError: end of file reached\n    from /usr/local/lib/ruby/1.9.1/openssl/buffering.rb:145:in `sysread_nonblock'\n    from /usr/local/lib/ruby/1.9.1/openssl/buffering.rb:145:in `read_nonblock'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:135:in `rbuf_fill'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:116:in `readuntil'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:126:in `readline'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:2219:in `read_status_line'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:2208:in `read_new'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:1191:in `transport_request'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:1177:in `request'\n    from (irb):32:in `block in irb_binding'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:627:in `start'\n    from (irb):32\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands/console.rb:47:in `start'\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands/console.rb:8:in `start'\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands.rb:41:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>What should I do with it?</p>\n"},{"tags":["ruby-on-rails-3","testing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":887,"score":1,"question_id":6188003,"title":"rails 3 test error:Mysql2::Error: Unknown column","body":"<p>guys,I get an error when I test my rails app following the <a href=\"http://guides.rubyonrails.org/testing.html\" rel=\"nofollow\">http://guides.rubyonrails.org/testing.html</a>,It said :</p>\n\n<blockquote>\n  <p>test_the_truth(ClassroomTypeTest):\n  ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column 'type' in 'field list': INSERT INTO <code>classroom_types</code> (<code>type</code>, <code>memo</code>, <code>created_at</code>, <code>updated_at</code>, <code>id</code>) VALUES ('MyString', 'MyString', '2011-05-31 08:40:54', '2011-05-31 08:40:54', 980190962)</p>\n</blockquote>\n\n<p>I am confused, I do not have a column in my classroom_types table,why will it appear such an error? \nCan anyone help me? Many Thanks!</p>\n\n<p>Here are my models and the relationship:</p>\n\n<p>The ClassroomType model:</p>\n\n<pre><code>class ClassroomType &lt; ActiveRecord::Base\n  has_many :classrooms\nend\n</code></pre>\n\n<p>The Classroom model:</p>\n\n<pre><code>class Classroom &lt; ActiveRecord::Base\n   belongs_to :classroom_type\n   belongs_to :teaching_building\nend\n</code></pre>\n\n<p>The TeachingBuilding model:</p>\n\n<pre><code>class TeachingBuilding &lt; ActiveRecord::Base\n  has_many :classrooms\nend\n</code></pre>\n\n<p>And here are the corresponding tables:</p>\n\n<p>classrooms:</p>\n\n<ul>\n<li>id </li>\n<li>classroom_no </li>\n<li>classroom_name</li>\n<li>classroom_type_id</li>\n<li>teaching_building_id</li>\n</ul>\n\n<p>classroom_types:</p>\n\n<ul>\n<li>id</li>\n<li>name</li>\n<li>memo</li>\n</ul>\n\n<p>teaching_buildings:</p>\n\n<ul>\n<li>id</li>\n<li>t_no</li>\n<li>name</li>\n</ul>\n"},{"tags":["mysql","sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13120729,"title":"On duplicate key update issue","body":"<p>I'm trying to update field on duplicate key, but it just adds new records instead of updating.</p>\n\n<p>Here is what i'm trying to do </p>\n\n<pre><code>ActiveRecord::Base.connection.execute \"insert into open_offer_counters (offer_id, udid, open_counter) values #{opened_events.join(\", \")} on duplicate key update open_counter = open_counter + 1\"\n</code></pre>\n\n<p>In my migration I pointed on 2 unique fields </p>\n\n<pre><code>create_table :open_offer_counters do |t|\n    t.integer :offer_id,            :unique =&gt; true\n    t.string  :udid,                :unique =&gt; true\n    t.integer :open_counter\n  t.timestamps\nend\n</code></pre>\n\n<p>Any ideas whats wrong with code?</p>\n"},{"tags":["ruby-on-rails-3","timezone","cucumber","zonebie"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13062833,"title":"Randomizing time zone in Rails with Zonebie","body":"<p>I'm using <a href=\"https://github.com/highgroove/zonebie\" rel=\"nofollow\">Zonebie</a> to randomize the time zone in my tests. It's all working fine for my rspec tests, but I'm having an issue with my cucumber tests. It works by selecting a random timezone from <code>ActiveSupport</code> and setting <code>Time.zone</code>. I've <a href=\"https://github.com/highgroove/zonebie#cucumber\" rel=\"nofollow\">followed the readme</a> and added <code>Zonebie.set_random_timezone</code> to a support file <code>features/support/zonbie.rb</code>. </p>\n\n<p>If I put a <code>debugger</code> statement in my steps, and I print <code>Time.zone</code>, it produces the correct randomized timezone.  However, if I put a <code>debuggger</code> statement in a model function, it prints the default time zone as set up in my <code>config/application.rb</code>.</p>\n\n<p>Is Time.zone being reset somewhere or does the change go out of scope somehow? Any ideas?</p>\n\n<p><strong>NB</strong>: I'm also using the <a href=\"https://github.com/travisjeffery/timecop\" rel=\"nofollow\">Timecop</a> gem if that has any implications.</p>\n"},{"tags":["ruby","ruby-on-rails-3","video-streaming"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13120607,"title":"HTTP Packet Reconstruction using Ruby - Video Streaming","body":"<p>I am asking you guys if it is possible using Ruby, to create a HTTP Packet reconstruction system. I got the server's information, everything is working OK from that side. It is a video streaming server. I will use UDP, but I want to know if this has been done before in Ruby, or if I can use an other package that will build the video for me. \nThanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13116440,"title":"devise forgot password function not working when creating own user controller?","body":"<p>I use devise for authentication and i have created a user controller and specified as shown below in my routes which lets me to create users,edit and delete users,</p>\n\n<pre><code>devise_for :users do\nresources :users, :only =&gt; [:index, :new, :create, :edit, :update, :destroy]\nend\n</code></pre>\n\n<p>but i cannot able to make the forgot password functionality work using this but in case i  specify as</p>\n\n<pre><code>devise_for :users\n</code></pre>\n\n<p>then i can able to use the forgot password function that comes with devise and i could not able to create , edit or delete when i specify like this. So how can i make both to work ? \nplease help me</p>\n"},{"tags":["ruby","ruby-on-rails-3","mongodb","mongoid","mongoid3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13071380,"title":"How to drop a specific database using Mongoid?","body":"<p><code>Mongoid.default_session.database_names</code> gives me an array of database names. I want to delete a specific database. How would I do that?</p>\n\n<p><code>Mongoid.default_session.drop()</code> always seems to drop the default database even if I override the current database using <code>Mongoid.override_database(\"test_database\")</code></p>\n\n<p>What am I missing?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":8,"score":-1,"question_id":13119418,"title":"I keep getting 'undefined method `key?' for nil:NilClass' when Building a Multi-Model Form (chapter 11) with Getting Started with Rails Guide","body":"<p>I've double checked that my code is like instructed but cannot figure out what might be wrong.\nI am using Rails version 3.2.8.\nMany thanks for help.</p>\n\n<p>-Petri</p>\n"},{"tags":["ruby-on-rails","ruby","http","ruby-on-rails-3","plugins"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":528,"score":1,"question_id":5079302,"title":"Typhoeus::Request.new(...) doesn't work, but Typhoeus::Request.get(...) does!","body":"<p>I am using Ruby on Rails 3. I just installed Typhoeus and I am tryng to make a HTTP request like this</p>\n\n<pre><code>  require 'typhoeus'\n\n  ....\n  request = Typhoeus::Request.new(\"http://google.com\",\n              :method        =&gt; :get,\n              :params        =&gt; {\n                :email       =&gt; \"test@test.com\",\n                :password    =&gt; \"test\"\n              }\n            )\n\n  resp = request.response\n</code></pre>\n\n<p>but I have a problem: debug of <code>resp</code> is always blank and this happens also if I don't use options (method, params, ...).</p>\n\n<p>However, if I use the following code, it will work:</p>\n\n<pre><code>   resp = Typhoeus::Request.get(\"http://google.com?email=test@test.com&amp;password=test\")\n</code></pre>\n\n<p>and I will get values for <code>resp</code>.</p>\n\n<p><strong>What can be the problem?</strong></p>\n\n<hr>\n\n<p>What I use</p>\n\n<ul>\n<li><p>Mac OS with \"Snow Leopard\" v 1.1.6</p></li>\n<li><p>MacPorts - The version 7.21.2 of libcurl was already installed from this software</p></li>\n<li><p>RVM (Ruby Version Manager)</p></li>\n</ul>\n\n<hr>\n\n<p>P.S.: if you need more info, let me know.</p>\n\n<hr>\n\n<p>In the <a href=\"https://github.com/dbalatero/typhoeus\" rel=\"nofollow\">official documentation</a> there are some (overwrited) alerts for Mac Os users related to the installation. </p>\n\n<p>Terminal outputs:</p>\n\n<pre><code>$ which ruby\n/Users/&lt;my_user_name&gt;/.rvm/rubies/ruby-1.9.2-p136/bin/ruby\n\n$ which curl\n/opt/local/bin/curl\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13118652,"title":"undefined method `stringify_keys' for \"create\":String in ruby on rails again","body":"<p>I am getting an error</p>\n\n<pre><code>Started POST \"/actions\" for 127.0.0.1 at 2012-10-29 15:04:01 +0600\nProcessing by ActionsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"lfHYF3EQn1/lMReK3alX3NsGa4wSMejC/0fEeoAFYUY=\", \"commit\"=&gt;\"Create Action\"}\nCompleted 500 Internal Server Error in 1ms\n\nNoMethodError (undefined method `stringify_keys' for \"create\":String):\n  app/controllers/actions_controller.rb:43:in `new'\n  app/controllers/actions_controller.rb:43:in `create'\n</code></pre>\n\n<p>This code is totally generated by Rails, and i do not understand why it doesnt work</p>\n\n<p>Here is model</p>\n\n<pre><code>class Action &lt; ActiveRecord::Base\n  attr_accessible :name, :user_id\nend\n</code></pre>\n\n<p>Here is controller part</p>\n\n<pre><code># GET /actions/new\n# GET /actions/new.json\ndef new\n  @action = Action.new\n\n  respond_to do |format|\n    format.html # new.html.erb\n    format.json { render json: @action }\n  end\nend\n\ndef create\n  @action = Action.new(params[:action]) # here we get an error !\n\n  respond_to do |format|\n    if @action.save\n      format.html { redirect_to @action, notice: 'Action was successfully created.' }\n      format.json { render json: @action, status: :created, location: @action }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @action.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>And here is the form code</p>\n\n<pre><code>&lt;%= form_for(@action) do |f| %&gt;\n  &lt;% if @action.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@action.errors.count, \"error\") %&gt; prohibited this action from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @action.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user_id %&gt;&lt;br /&gt;\n    &lt;%= f.number_field :user_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When i press post, firebug shows this request parameters </p>\n\n<pre><code>utf8:✓\nauthenticity_token:lfHYF3EQn1/lMReK3alX3NsGa4wSMejC/0fEeoAFYUY=\naction[name]:sdf\naction[user_id]:23\ncommit:Create Action\n</code></pre>\n\n<p>if i understand correctly this must work and rails must turn action[name] and action[user_id] into hash table and place it into parameters[:action], then Action.new get this hash table as parameter. What is wrong ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","get","form-for","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13118467,"title":"dealing with complex GET params in rails","body":"<p>I'm trying to pass params via GET to a form using ransack, it would normally work fine except that the params[:q] is causing a problem when I try to merge it.</p>\n\n<p>controller (using <a href=\"https://github.com/ernie/ransack\" rel=\"nofollow\">ransack</a>)</p>\n\n<pre><code>  def index\n    @search = Record.ransack(params[:q])\n    @records = @search.result.page(params[:page])\n  end\n</code></pre>\n\n<p>view</p>\n\n<pre><code>&lt;ul&gt;\n  &lt;% Genre.all.each do |genre| %&gt;\n    &lt;% category_count = @search.result.joins(:genre).where(\"genres.id = ?\", genre.id).size %&gt;\n    &lt;% unless category_count == 0 %&gt;\n        &lt;li&gt;\n            &lt;%= link_to genre.name, params.merge(:\"q[genre_name_eq]\" =&gt; genre.name) %&gt; (&lt;%= category_count %&gt;)\n        &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>But I keep getting duplication:</p>\n\n<pre><code>q[genre_name_eq]=Rockabilly&amp;q[genre_name_eq]=Rockabilly\n</code></pre>\n\n<p>Without the q[] it manages the params correctly, overwriting the previous one.</p>\n\n<p>Also tried <code>params[:q].merge(:genre_name_eq)</code> which causes the problem when there is no q[] and it also just doesn't work, giving me <code>genre_name_eq=</code> and no q[]</p>\n\n<p>How else can I handle the q[] so that it replaces the value instead of duplicating it several times?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","custom-routes"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":2745,"score":9,"question_id":4271023,"title":"Rails3 Routes - Passing parameter to a member route","body":"<p>I would like to pass an extra parameter to a member route of a resource</p>\n\n<p>something like:</p>\n\n<pre><code>resources :events do\n  member do\n    get 'register/:participant_type_id'\n  end\nend\n</code></pre>\n\n<p>I could only accomplish it using a static match statement</p>\n\n<p>Looking around the internet I saw that this might be possible in Rails 3.0.2. I'm using 3.0.1 and it certanlly is not.</p>\n\n<p>Am I doing something wrong? or is it really not possible?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","apache","passenger"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":8318,"score":3,"question_id":6162196,"title":"Setting up Rails app on Apache with passenger - Rails doesn't seem to load","body":"<p>I am trying to set up Rails on a Ubuntu instance by following along with documentation such as <a href=\"https://help.ubuntu.com/community/RubyOnRails\" rel=\"nofollow\">https://help.ubuntu.com/community/RubyOnRails</a>.  I am trying to set up the app from the Rails Getting Started page here: <a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow\">http://guides.rubyonrails.org/getting_started.html</a>.</p>\n\n<p>What I have done so far:</p>\n\n<ul>\n<li>Installation of Ruby/RubyGems/Rails through RVM and GEM (this installed Ruby 1.9.2 and Rails 3.0.7)</li>\n<li>Installation of the mysql and mysql2 module (latter which didn't work)</li>\n<li>Creation of rails app (blog app as tutorial is instructing)</li>\n<li>Sym linking of /home/me/www/blog/public/ from /var/www/blog/</li>\n<li>Creation of DB through rake</li>\n<li>Installation of passenger module for Rails execution in Apache</li>\n<li>Running of <code>passenger-install-apache2-module</code> to configure Apache</li>\n<li>Deletion of public.html file from public/ rails app folder so that my controller/view can fire</li>\n<li>Configuration of sites-available files for virtual hosts</li>\n<li>Configuration of Rails routing</li>\n</ul>\n\n<p>I believe it is the last two steps that are tripping me up, partly due to lack of familiarity with Apache and Rails (I am new to both).</p>\n\n<p>In my virtual host file I am trying to point to the blog public dir in /var/www/blog.  For my Rails route I have <code>root :to =&gt; \"home#index\"</code> as instructed.</p>\n\n<p>When I browse to the http:// url I should normally be seeing my \"Hello, Rails!\" page per section 4.3 of the Getting Started guide, however all I see is the directory listing from Apache.  Static pages work but not Rails processing.</p>\n\n<p>At this point I am unclear if the passenger module is even doing anything or where to look for any evidence of what is happening.  I tried various things like running the Rails app off a different virtual host called \"blog\" at http:///blog and the routing worked (static pages and all) but no Rails as above.</p>\n\n<p>Update: after playing around some more, I now get a new error message (404):</p>\n\n<blockquote>\n  <p>Not Found</p>\n  \n  <p>The requested URL /dispatch.cgi was\n  not found on this server.</p>\n</blockquote>\n\n<p>I have since determined that this cgi 404 was caused by a rewrite rule I had added to .htaccess from guidance from the help.ubuntu.com page I pointed out above.  Looks like it wasn't necessary or applied to an older version of Rails.  The inconsistencies in instructions when looking up help online is disorienting!  Removing the file leaves me with the previous problem though.</p>\n\n<p>Here's the entry in the Apache log that I believe correlates with the first error.  Although I am no longer getting this error it seems, may be related to something else I was trying before...</p>\n\n<pre><code>[Fri May 27 22:49:41 2011] [notice] Apache/2.2.16 (Ubuntu) PHP/5.3.3-1ubuntu9 with Suhosin-Patch Phusion_Passenger/3.0.7 configured -- resuming normal operations\n[Fri May 27 22:51:18 2011] [error] [client 192.168.1.141] File does not exist: /var/www/blog/rails, referer: http://192.168.1.138/blog/\n</code></pre>\n\n<p>Here's the most recent entry with the 404 on the cgi thing:</p>\n\n<pre><code>[Sat May 28 08:01:18 2011] [error] [client 192.168.1.141] File does not exist: /var/www/blog/dispatch.cgi\n</code></pre>\n\n<p>What could I be missing?  Thanks!</p>\n\n<hr>\n\n<p>Additional details as requested.  Apache sites file:</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n        ServerAdmin webmaster@localhost\n\n        DocumentRoot /var/www/blog/\n    RailsEnv development\n\n        # &lt;Directory /&gt;\n        #       Options FollowSymLinks\n        #       AllowOverride None\n        # &lt;/Directory&gt;\n\n        &lt;Directory \"/var/www/blog/\"&gt;\n        Options Indexes FollowSymLinks -MultiViews +ExecCGI\n                AllowOverride All\n                Order allow,deny\n                allow from all\n        # AddHandler cgi-script .cgi\n        &lt;/Directory&gt;\n\n        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/\n    &lt;Directory \"/usr/lib/cgi-bin\"&gt;\n                AllowOverride None\n                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n                Order allow,deny\n                Allow from all\n        &lt;/Directory&gt;\n\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n\n        # Possible values include: debug, info, notice, warn, error, crit,\n        # alert, emerg.\n        LogLevel warn\n\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    Alias /doc/ \"/usr/share/doc/\"\n    &lt;Directory \"/usr/share/doc/\"&gt;\n        Options Indexes MultiViews FollowSymLinks\n    AllowOverride None\n        Order deny,allow\n        Deny from all\n        Allow from 127.0.0.0/255.0.0.0 ::1/128\n    &lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p><strong>Another update:</strong> I was able to get it working, finally, by using a top level DocumentRoot (/var/www) and basing my Rails app off that using RailsBaseURI.  This maps to the \"Deploying to a sub URI\" section of the Phusion Passenger instructions.  It is used as http:///blog which is not really what I wanted to get, but it's kind of irrelevant as I am using this just to learn Rails in a virtual.  I will need to go and work on getting it working as a top level app again sometime later.  Here's my current (final) VirtualHost file for reference:</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n        ServerAdmin webmaster@localhost\n\n        DocumentRoot /var/www/\n        RailsEnv development\n\n        &lt;Directory /var/www/&gt;\n          Options FollowSymLinks\n          AllowOverride None\n        &lt;/Directory&gt;\n\n    RailsBaseURI /blog\n        &lt;Directory /var/www/blog/&gt;\n                Options Indexes FollowSymLinks -MultiViews +ExecCGI\n                AllowOverride All\n                Order allow,deny\n                allow from all\n                # AddHandler cgi-script .cgi\n        &lt;/Directory&gt;\n\n        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/\n        &lt;Directory \"/usr/lib/cgi-bin\"&gt;\n                AllowOverride None\n                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n                Order allow,deny\n                Allow from all\n        &lt;/Directory&gt;\n\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n\n        # Possible values include: debug, info, notice, warn, error, crit,\n        # alert, emerg.\n        LogLevel warn\n\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    Alias /doc/ \"/usr/share/doc/\"\n    &lt;Directory \"/usr/share/doc/\"&gt;\n        Options Indexes MultiViews FollowSymLinks\n        AllowOverride None\n        Order deny,allow\n        Deny from all\n        Allow from 127.0.0.0/255.0.0.0 ::1/128\n    &lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","bundler"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12454217,"title":"Using bundler to manage non-gems","body":"<p>There is a github repo I want to fetch code from which isn't a gem. It is a bunch of javascript files, and it has no gem version. Can I add this to the Gemfile and define where it should be stored (under the lib/assets) directory, or will I have to manage this with a git submodule?</p>\n"},{"tags":["css","ruby-on-rails-3","render"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13118152,"title":"rendering a template while maintaining the css attributes","body":"<p>I am using devise for authentication</p>\n\n<p>under /devise/sessions/new.html.erb I have everything that relates to my sign-in page (form, markup, etc).</p>\n\n<p>In my root page, I'd like to just render new.html.erb instead of copy-paste the code to it.</p>\n\n<p><code>&lt;%= render '/devise/sessions/new' %&gt;</code> gives me a missing template error and its looking for a partial.</p>\n\n<p>However, if I rename new.html.erb to _new.html.erb it gives me the original /devise/sessions/new and not my editting one</p>\n\n<p>So I use <code>&lt;%= render :template =&gt; '/devise/sessions/new' %&gt;</code> to render it and seems to work fine, but the problem is the my root page (pages#home) looks something like this</p>\n\n<pre><code>   &lt;div class=\"landingPageContentWrap signInUpForm\"&gt;\n\n    ...lots of stuff here ...\n     &lt;%= render :template =&gt; '/devise/sessions/new' %&gt;  \n\n    &lt;/div&gt;\n</code></pre>\n\n<p>Is there way to input the css attributes that surround the render to be integrated within the template, such that if I call /devise/sessions/new directly it will be with the same CSS attributes as the root page? Or must I set the sign-in page with a duplicate css tags?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","rvm"],"answer_count":8,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":10566,"score":17,"question_id":6278047,"title":"Could not find rails (>= 0) amongst [] (Gem::LoadError)","body":"<p>After installing rvm, updating .gmrc file, updating rubygems and running gem install rails -v \">=3.1.0rc\", I now seem to have a complete mess:</p>\n\n<p>$ rails -v\n/usr/local/lib/site_ruby/1.8/rubygems/dependency.rb:247:in <code>to_specs': Could not find rails (&gt;= 0) amongst [] (Gem::LoadError)\n    from /usr/local/lib/site_ruby/1.8/rubygems/dependency.rb:256:in</code>to_spec'\n    from /usr/local/lib/site_ruby/1.8/rubygems.rb:1182:in `gem'\n    from /var/lib/gems/1.8/bin/rails:18</p>\n\n<p>myhome@myhome-mini:~$ gem env</p>\n\n<p>RubyGems Environment:</p>\n\n<ul>\n<li><p>RUBYGEMS VERSION: 1.6.2</p></li>\n<li><p>RUBY VERSION: 1.9.2 (2011-02-18 patchlevel 180) [i686-linux]</p></li>\n<li><p>INSTALLATION DIRECTORY: /home/myhome/gems</p></li>\n<li><p>RUBY EXECUTABLE: /home/myhome/.rvm/rubies/ruby-1.9.2-p180/bin/ruby</p></li>\n<li><p>EXECUTABLE DIRECTORY: /home/myhome/gems/bin</p></li>\n<li><p>RUBYGEMS PLATFORMS:</p>\n\n<ul>\n<li><p>ruby</p></li>\n<li><p>x86-linux</p></li>\n</ul></li>\n<li><p>GEM PATHS:</p>\n\n<ul>\n<li><p>/home/myhome/gems</p></li>\n<li><p>/usr/lib/ruby/gems/1.8</p></li>\n</ul></li>\n<li><p>GEM CONFIGURATION:</p>\n\n<ul>\n<li><p>:update_sources => true</p></li>\n<li><p>:verbose => true</p></li>\n<li><p>:benchmark => false</p></li>\n<li><p>:backtrace => false</p></li>\n<li><p>:bulk_threshold => 1000</p></li>\n<li><p>\"gemhome\" => \"/home/myhome/gems\"</p></li>\n<li><p>\"gempath\" => [\"/home/myhome/gems\", \"/usr/lib/ruby/gems/1.8\"]</p></li>\n</ul></li>\n<li><p>REMOTE SOURCES:</p>\n\n<ul>\n<li><a href=\"http://rubygems.org/\">http://rubygems.org/</a></li>\n</ul></li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","internationalization","i18n-gem","rails-i18n"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13028998,"title":"Does Rails engines support i18n","body":"<p>What I am trying to do is have a translation file in my engine. I have placed files in</p>\n\n<blockquote>\n  <p>config</p>\n\n<pre><code> \\locales\n\n     \\fr.yml\n</code></pre>\n</blockquote>\n\n<p>Now I am writing translation for string hello</p>\n\n<p>fr:\n  \"Hello\":\"Bonjour\"\nbut I am getting translation error. When I use same line in my application translate file it works.</p>\n\n<p>I just want to know whether translation files in engines work or not? If yes can you tell the error I am doing. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","haml","actionview"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1779,"score":2,"question_id":6227945,"title":"Rails 3 not loading HAML handler","body":"<p>I'm having some problems with Rails 3 and HAML in my application: for some reason Rails appears not to be loading the handler for dealing with haml files. Every action gives an error message similar to this one:</p>\n\n<hr>\n\n<h2><strong>Template is missing</strong></h2>\n\n<p>Missing template contact_search/index with {:formats=>[:html], :handlers=>[:rjs, :rhtml, :rxml, :builder, :erb], :locale=>[:en, :en]} in view paths \"/var/www/osphonebook/app/views\", \"/var/www/osphonebook/vendor/bundle/ruby/1.8/gems/devise-1.3.4/app/views\"</p>\n\n<hr>\n\n<p>Look at the \"handlers\" options: it does not have :haml...</p>\n\n<p>The thing is that this only happens during production mode on the server set up by my company. On development and test modes it works fine. Also, if I start the application in production mode on my development PC, it works.</p>\n\n<p>Some info about the server:</p>\n\n<p><strong>UPDATE (6/6/2011): upgraded to Ruby 1.9</strong>, and it still does not work.</p>\n\n<pre><code>ruby 1.9.2p0 (2010-08-18 revision 29036) [i486-linux]\n\nGems included by the bundle:\nabstract (1.0.0)\nactionmailer (3.0.7)\nactionpack (3.0.7)\nactivemodel (3.0.7)\nactiverecord (3.0.7)\nactiveresource (3.0.7)\nactivesupport (3.0.7)\narel (2.0.10)\nbcrypt-ruby (2.1.4)\nbuilder (2.1.2)\nbundler (1.0.14)\ndevise (1.3.4)\nerubis (2.6.6)\nhaml (3.1.1)\ni18n (0.5.0)\nkgio (2.4.1)\nmail (2.2.19)\nmime-types (1.16)\norm_adapter (0.0.5)\npg (0.11.0)\npolyglot (0.3.1)\nrack (1.2.3)\nrack-mount (0.6.14)\nrack-test (0.5.7)\nrails (3.0.7)\nrailties (3.0.7)\nrake (0.8.7)\nsass (3.1.2)\nsqlite3 (1.3.3)\nthor (0.14.6)\ntreetop (1.4.9)\ntzinfo (0.3.27)\nunicorn (3.6.2)\nwarden (1.0.4)\n</code></pre>\n\n<p>If more info is needed, please comment the question, and I'll update it. Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":29,"score":3,"question_id":13115772,"title":"How do I create a rails migration to remove/change precision and scale on decimal?","body":"<p>I am trying to remove the precision and scale attributes from decimal (PostgreSQL <code>NUMERIC</code>) fields in my database?</p>\n\n<p>The fields:</p>\n\n<pre><code>t.decimal  \"revenue_per_transaction\", :precision =&gt; 8, :scale =&gt; 2\nt.decimal  \"item_quantity\",           :precision =&gt; 8, :scale =&gt; 2\nt.decimal  \"goal_conversion\",         :precision =&gt; 8, :scale =&gt; 2\nt.decimal  \"goal_abandon\",            :precision =&gt; 8, :scale =&gt; 2\nt.decimal  \"revenue\",                 :precision =&gt; 8, :scale =&gt; 2\n</code></pre>\n\n<p>What do I need to add to my migration to change these to unbounded scale and precision, or to increase the scale? At the moment I'm hitting the scale limit and getting errors like:</p>\n\n<pre><code>ERROR:   numeric field overflow\n</code></pre>\n\n<p>Here's the context: <a href=\"http://stackoverflow.com/questions/13115229/pgerror-numeric-field-overflow-on-heroku/13115261\">&quot;PG::Error - numeric field overflow&quot; on Heroku</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":254,"score":2,"question_id":12018799,"title":"MongoID, Heroku, MongoLab/HQ, w/o addons","body":"<p>I currently want to test out heroku mongoid mongolab/mongohq.</p>\n\n<p>however, i don't want to work with heroku addons, instead, i want to config mongoid to directly use a mongolab/mongohq database via uri oder other settings. However, this doesn't really work out well.</p>\n\n<p>Heres what i've done so far:</p>\n\n<pre><code>rails new test-mongoid --skip-active-record\n</code></pre>\n\n<p>Gemfile</p>\n\n<pre><code>gem 'mongoid'\ngem 'haml'\ngem 'sass'\n\nrails g mongoid:config\n</code></pre>\n\n<p>scaffolded a test model</p>\n\n<pre><code>rails g scaffold Article title:string body:string\n</code></pre>\n\n<p>mongoid.yml</p>\n\n<pre><code>production:\n  host: &lt;%= ENV['MONGOID_HOST'] %&gt;\n  port: &lt;%= ENV['MONGOID_PORT'] %&gt;\n  username: &lt;%= ENV['MONGOID_USERNAME'] %&gt;\n  password: &lt;%= ENV['MONGOID_PASSWORD'] %&gt;\n  database: &lt;%= ENV['MONGOID_DATABASE'] %&gt;\n</code></pre>\n\n<p>other try already did with mongoid.yml</p>\n\n<pre><code>production:\n  uri: mongodb://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;database&gt;\n</code></pre>\n\n<p>filled in with my username password etc.</p>\n\n<p>tested it locally with a mongodb, everything worked fine. pushed it to heroku, does not work.</p>\n\n<p>anyone already did it this way to bypass those heroku addons and know how to handle it?</p>\n\n<p>sincerely,\ncschaeffler</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>configured my mongoid.yml like this</p>\n\n<pre><code>production:\n  sessions:\n    default:\n      hosts:\n        - &lt;server&gt;:&lt;port&gt;\n      username: &lt;username&gt;\n      password: &lt;password&gt;\n      database: &lt;dbname&gt;\n</code></pre>\n\n<p>seems to be running... but if i try to go to the scaffolded Article index\napp.herokuapp.com/articles</p>\n\n<p>i get</p>\n\n<pre><code>[2012-08-18 21:54:30] INFO  WEBrick 1.3.1\n[2012-08-18 21:54:30] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]\n[2012-08-18 21:54:30] INFO  WEBrick::HTTPServer#start: pid=2 port=57443\nState changed from starting to up\n=&gt; Booting WEBrick\n=&gt; Rails 3.2.1 application starting in production on http:// 0.0. 0.0:57443\n=&gt; Ctrl-C to shutdown server\n=&gt; Call with -d to detach\nStarted GET \"/articles\" for 79.199.52.102 at 2012-08-18 21:54:31 +0000\nProcessing by ArticlesController#index as HTML\nCompleted 500 Internal Server Error in 264ms\nActionView::Template::Error (undefined method `[]' for nil:NilClass):\n11: \n10:   &lt;/tr&gt;\n\n14:     &lt;td&gt;&lt;%= article.title %&gt;&lt;/td&gt;\n15:     &lt;td&gt;&lt;%= article.body %&gt;&lt;/td&gt;\n13:   &lt;tr&gt;\nRendered articles/index.html.erb within layouts/application (208.2ms)\n9:     &lt;th&gt;&lt;/th&gt;\n12: &lt;% for article in @articles %&gt;\napp/controllers/articles_controller.rb:7:in `index'\n\napp/views/articles/index.html.erb:12:in    _app_views_articles_index_html_erb__1324099721200765517_18939540'\n\ncache: [GET /articles] miss\nGET safe-atoll-7856.herokuapp.com/articles dyno=web.1 queue=0 wait=0ms service=342ms status=500 bytes=643\nStopping remaining processes with SIGKILL\nError R12 (Exit timeout) -&gt; At least one process failed to exit within 10 seconds of SIGTERM\nProcess exited with status 137\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13115575,"title":"Rails has_many without foreign_key lookup","body":"<p>Is it possible to remove foreign_key lookup on a has_many relationship?</p>\n\n<p>I'm mapping a legacy database, and one of the columns references a belongs_to like so:</p>\n\n<pre><code>'OBJ:123'\n'OBJ:434'\n..etc\n</code></pre>\n\n<p>I have previously obtained this collection:</p>\n\n<pre><code>Article\n  def collection\n      where(\"col = 'OBJ:#{id}'\")\n  end\nend\n</code></pre>\n\n<p>This doesn't work through has_many because active_record insists on a foreign_key:</p>\n\n<pre><code>... WHERE obj_id = 123 AND (col = 'OBJ:123') ...\n</code></pre>\n\n<p>What I want:</p>\n\n<pre><code>... WHERE col = 'OBJ:123' ...\n</code></pre>\n\n<p>I will eventually create a new column and migrate the data, but there are millions of rows and I just need a quick way to interact with the data.</p>\n"},{"tags":["ruby-on-rails-3","postgresql","datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":10281864,"title":"How do I adjust a column length in postgreSQL DB with a Datamapper migration?","body":"<p>I'm using <a href=\"https://github.com/datamapper/dm-migrations/\" rel=\"nofollow\">dm-migrations</a> to create a custom migration for my database.</p>\n\n<p>However, I can't seem to find an example of modifying the length of a column. Can someone please explain how this done? I'm using a postgresql database on rails 3.</p>\n\n<p>UPDATE:</p>\n\n<p>I've tried the following:</p>\n\n<pre><code>migration 1, :modify_course_url_length do\n  up do\n    modify_table :hotels do\n      change_column :url, String, :length =&gt; 255\n    end\n  end\nend\n</code></pre>\n\n<p>but it looks as though I need to get <code>change_column_type_statement</code> method working since its a postgresql db.</p>\n\n<p>UPDATE 2:</p>\n\n<p>It seems the problem is that the outputted SQL is:</p>\n\n<p>ALTER TABLE \"hotels\" ALTER COLUMN \"url\" VARCHAR(255)</p>\n\n<p>whilst it needs to be</p>\n\n<p>ALTER TABLE \"hotels\" ALTER COLUMN \"url\" TYPE VARCHAR(255)</p>\n\n<p>Anyone have any ideas on this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","nginx","unicorn"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":12596345,"title":"unicorn timeout handling","body":"<p>I'm wondering what is the best way to track unicorn timeouts from my app.</p>\n\n<p>There are some bits of the app which are slow and they currently timeout quietly. I could increase the timeout but that is shoving the problem under the carpet. Ideally, I would like to get an airbrake notification or something of that effect. I'm not looking for a performance guide, just a way to efficiently and reliably get informed about timeouts.</p>\n\n<p>How have other people handled timeouts from their rails app using unicorn? scan the nginx error log? plug in a handler in unicorn config? handler in nginx config?</p>\n\n<p>[Ubuntu 12.04+nginx+unicorn+rails 3.2+ruby 1.9.3]</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13115049,"title":"Rails: ajax submit form to an action with nested resources","body":"<p>This is a part of the <strong>show</strong> view of the <strong>exercise</strong> model:</p>\n\n<pre><code>&lt;div id=\"smoke_screen\" style=\"min-height:100px\"&gt;\n\n    &lt;% question =  @exercise.random_question %&gt;\n    &lt;b class=\"question\"&gt;&lt;%= question.name %&gt;&lt;/b&gt;\n\n    &lt;ul&gt;\n        &lt;% question.answers.each do |answer| %&gt;\n            &lt;li&gt;&lt;%= answer.content %&gt;&lt;/li&gt;\n\n        &lt;% end %&gt;\n    &lt;/ul&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>And it looks like this in the browser:</p>\n\n<p><img src=\"http://i.stack.imgur.com/QfzAh.png\" alt=\"enter image description here\"></p>\n\n<p>@answer and @question are nested models of exercise (exercise has_many questions, question has_many answers) and this is all viewed from the show view of the exercise model.</p>\n\n<p>I'm trying to add a radio button to each answer and make an ajax call to an action i'll create named \"save_answer\". This action will receive both the question and answer objects, save the answer and return another question that will replace the #smoke_screen using ajax.</p>\n\n<p>I'm new to rails, tried plenty of things with <code>form_to</code> with the attribute <code>:remote =&gt; true</code> without success. I will appreciate any direction on how to approach this</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","activerecord","entity-attribute-value"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13035744,"title":"Advice on handling versioning of an EAV-model table","body":"<p>there are <a href=\"https://www.ruby-toolbox.com/categories/Active_Record_Versioning\" rel=\"nofollow\">many</a> ActiveRecord versioning gems available to Rails but most if not all of them are having <a href=\"https://github.com/laserlemon/vestal_versions/commit/394cf8dd0073af3885aa816af38249c09d725d5a\" rel=\"nofollow\">trouble</a> <a href=\"http://airbladesoftware.com/notes/papertrail-transfer\" rel=\"nofollow\">being</a> <a href=\"https://github.com/technoweenie/acts_as_versioned/graphs/commit-activity\" rel=\"nofollow\">maintained</a>. on top of that, some of them seem to have various <a href=\"https://github.com/airblade/paper_trail/issues/12\" rel=\"nofollow\">foreign</a> <a href=\"https://github.com/airblade/paper_trail/pull/44\" rel=\"nofollow\">key</a> <a href=\"https://github.com/airblade/paper_trail/issues/121\" rel=\"nofollow\">association</a> <a href=\"https://github.com/airblade/paper_trail/issues/148\" rel=\"nofollow\">issues</a>.</p>\n\n<p>I'm in the process of coding a content management system where pages are stored in a tree-like hierarchy and the page fields are stored in a separate table using <a href=\"http://en.wikipedia.org/wiki/Entity-attribute-value_model#Example\" rel=\"nofollow\">EAV model</a>.</p>\n\n<p>keeping that in mind, I'm not looking for an all encompassing revisioning gem because I honestly don't think I'll find one. what I am looking for is some advice on how to handle this as a custom implementation. should I have a separate table for storing revisions and referring to a revision number in my EAV table? I foresee that this may lead to some complex validation problems though. I currently have a problem finding a clean way to validate a regular EAV table anyway so if anyone can comment on this it would be very much appreciated as well.</p>\n\n<p>I hope this question is written well enough to SO standards. if you need any additional information, please do not hesitate to ask and I will try to help you help me. :)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","osx","postgresql","osx-lion"],"answer_count":14,"favorite_count":50,"up_vote_count":112,"down_vote_count":0,"view_count":32706,"score":112,"question_id":6770649,"title":"Repairing Postgresql after upgrading to OSX 10.7 Lion","body":"<p>I recently upgraded to OSX 10.7, at which point my rails installation completely borked when trying to connect to the psql server.   When I do it from the command line using </p>\n\n<pre><code>psql -U postgres\n</code></pre>\n\n<p>it works totally fine, but when I try to run the rails server or console with the same username and password, I get this error </p>\n\n<pre><code>...activerecord-3.0.9/lib/active_record/connection_adapters/postgresql_adapter.rb:950:in `initialize': could not connect to server: Permission denied (PGError) \nIs the server running locally and accepting\n    connections on Unix domain socket \"/var/pgsql_socket/.s.PGSQL.5432\"?\n</code></pre>\n\n<p>Any ideas what might be going on would be super helpful!  Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","devise","cancan"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13075972,"title":"Rspec controller error expecting <\"index\"> but rendering with <\"\">","body":"<p>New to testing, I'm struggling to get some controller tests to pass.</p>\n\n<p>The following controller test throws the error:</p>\n\n<pre><code>   expecting &lt;\"index\"&gt; but rendering with &lt;\"\"&gt;\n</code></pre>\n\n<p>I have the following in one of my controller specs:</p>\n\n<pre><code>  require 'spec_helper'\n\n  describe NasController do\n\n  render_views\n  login_user\n\n  describe \"GET #nas\" do\n      it \"populates an array of devices\" do\n        @location = FactoryGirl.create(:location)\n        @location.users &lt;&lt; @current_user\n        @nas = FactoryGirl.create(:nas, location_id: @location.id )      \n        get :index\n        assigns(:nas).should eq([@nas])\n      end\n\n      it \"renders the :index view\" do\n        response.should render_template(:index)\n      end\n    end\n</code></pre>\n\n<p>In my controller macros, I have this:</p>\n\n<pre><code>  def login_user\n    before(:each) do\n      @request.env[\"devise.mapping\"] = Devise.mappings[:user]\n      @current_user = FactoryGirl.create(:user)\n      @current_user.roles &lt;&lt; Role.first\n      sign_in @current_user\n      User.current_user = @current_user\n      @user = @current_user\n      @ability = Ability.new(@current_user)\n    end\n  end\n</code></pre>\n\n<p>I'm using devise and cancan and have followed their guides re. testing. I believe my users are signed in before and have the ability to view the index action.</p>\n\n<p>What can I do to get the tests to pass?</p>\n\n<p>-- UPDATE 1 --</p>\n\n<p>Controller code:</p>\n\n<pre><code>class NasController &lt; ApplicationController\n   before_filter :authenticate_user!\n   load_and_authorize_resource\n\n   respond_to :js\n\n   def index\n\n     if params[:location_id]\n       ...\n     else\n     @nas = Nas.accessible_by(current_ability).page(params[:page]).order(sort_column + ' ' + sort_direction)\n\n     respond_to do |format|\n      format.html # show.html.erb\n     end    \n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","unicorn"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13100330,"title":"Unicorn loading initializers","body":"<p>I'm in the process of migrating from Thin to Unicorn. I've had success with most of the website except loading a specific Gem package. I don't think it's the package itself, but rather how Unicorn interacts with the Initializer files.</p>\n\n<p>Here's my current <code>unicorn.rb</code> setup. I didn't use before_fork or after_fork since I'm using Mongoid.</p>\n\n<pre><code>worker_processes 3\ntimeout 30\npreload_app true\n</code></pre>\n\n<p>The initializer file is in <code>/config/initializers/asin.rb</code></p>\n\n<pre><code>ASIN::Configuration.configure do |config|\n  config.secret        = ENV['AMAZON_SECRET']\n  config.key           = ENV['AMAZON_KEY']\n  config.associate_tag = ENV['AMAZON_TAG']\n  config.version       = ENV['AMAZON_VERSION']\nend\n</code></pre>\n\n<p>Does Rails automatically load the info inside the initializer files?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","payment-processing","stripe-payments"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":235,"score":0,"question_id":11068856,"title":"Integrating stripe with Devise","body":"<p>I am following along with railscast #288 on stripe but I am having some difficulty with setting the stripe hidden token. I am using the most recent version of devise with simple form integration. </p>\n\n<p>Here is my Registrations Controller:</p>\n\n<pre><code>class RegistrationsController &lt; Devise::RegistrationsController\n\n  def create\n    build_resource \n    if resource.save_with_payment\n      if resource.active_for_authentication?\n        set_flash_message :notice, :signed_up if is_navigational_format?\n        sign_in(resource_name, resource)\n        respond_with resource, :location =&gt; after_sign_up_path_for(resource)\n      else\n        set_flash_message :notice, :\"signed_up_but_#{resource.inactive_message}\" if is_navigational_format?\n        expire_session_data_after_sign_in!\n        respond_with resource, :location =&gt; after_inactive_sign_up_path_for(resource)\n      end\n    else\n      clean_up_passwords resource\n      respond_with resource\n    end\n  end\n</code></pre>\n\n<p>My form for registering a new user:</p>\n\n<pre><code>&lt;%= simple_form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name), :html =&gt; {:class =&gt; 'well'} ) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n  &lt;%= f.error_messages %&gt;\n  &lt;h3 class=\"center\"&gt;Create your credentials for logging in:&lt;/h3&gt;&lt;hr&gt;\n  &lt;div class=\"inputs\"&gt;\n    &lt;%= f.input :email, :required =&gt; true  %&gt;\n    &lt;%= f.input :password, :required =&gt; true %&gt;\n    &lt;%= f.input :password_confirmation, :required =&gt; true %&gt;\n  &lt;h3 class=\"center\"&gt;Are you a Shipper or a Carrier?&lt;/h3&gt;&lt;hr&gt;\n    &lt;%= f.input :role, :collection =&gt; User::ROLES, :as =&gt; :radio_buttons %&gt;\n    &lt;%= f.input :stripe_card_token, :as =&gt; :hidden %&gt;\n  &lt;/div&gt;\n  &lt;h3 class=\"center\"&gt;Your Credit Card Information:&lt;/h3&gt;&lt;hr&gt;\n  &lt;fieldset&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :card_number, \"Credit Card Number\" %&gt;\n      &lt;div class=\"input-prepend inline-block\"&gt;\n      &lt;span class=\"add-on\"&gt;&lt;strong&gt;#&lt;/strong&gt;&lt;/span&gt;\n      &lt;%= text_field_tag :card_number, nil, name: nil %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :card_code, \"Security Code on Back of Card (CVV)\" %&gt;\n      &lt;div class=\"input-prepend inline-block\"&gt;\n      &lt;span class=\"add-on icon-credit-card\"&gt;&lt;/span&gt;\n      &lt;%= text_field_tag :card_code, nil, name: nil, :size =&gt; 4  %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :card_month, \"Card Expiration\" %&gt;\n      &lt;%= select_month nil, { add_month_numbers: true }, { name: nil, id: \"card_month\" } %&gt;\n      &lt;%= select_year nil, { start_year: Date.today.year, end_year: Date.today.year+15 },\n  { name: nil, id: \"card_year\" } %&gt;\n    &lt;/div&gt;\n    &lt;div id=\"stripe_error\"&gt;\n      &lt;noscript&gt;JavaScript is not enabled and is required for this form. First enable it in your web browser settings.&lt;/noscript&gt;\n    &lt;/div&gt;\n  &lt;/fieldset&gt;\n  &lt;hr&gt;\n  &lt;%= f.input :terms, :as =&gt; :boolean, label: \"* I have read and agreed to the terms of service\" %&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.button :submit, \"Sign up\", class: \"btn-large icon-thumbs-up\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I have a user model with the following attributes: </p>\n\n<pre><code>attr_accessible :email, :password, :password_confirmation, :remember_me, :role, :terms, :stripe_token, :stripe_card_token\n</code></pre>\n\n<p>And Finally the coffeescript to get this all to work correctly:</p>\n\n<pre><code>jQuery -&gt;\nStripe.setPublishableKey($('meta[name=\"stripe-key\"]').attr('content'))\nsubscription.setupForm()\n\nsubscription = \n  setupForm: -&gt;\n    $('#new_user').submit -&gt;\n        $('input[type=submit]').attr('disabled', true)\n        if $('#card_number').length\n            subsciption.processCard()\n            false\n        else\n            true\n\nprocessCard: -&gt;\n    card =\n        number: $('#card_number').val()\n        cvc: $('#card_code').val()\n        expMonth: $('#card_month').val()\n        expYear: $('#card_year').val()\n    Stripe.createToken(card, subscription.handleStripeResponse)\n\nhandleStripeResponse: (status, response) -&gt;\n    if status == 200\n        $('#user_stripe_card_token').val(response.id)\n        $('#new_user')[0].submit()\n    else \n        $('#stripe_error').text(response.error.message)\n        $('input[type=submit]').attr('disabled', false)\n</code></pre>\n\n<p>When I go to create a new user my action controller is giving me the following error message:</p>\n\n<pre><code>undefined method `stripe_card_token' for #&lt;User:0x00000103fe7b90&gt;\n</code></pre>\n\n<p>However I don't think this should be possible since I have defined this method in my attr_accessible call in my user.rb model. Any explanation would be really helpful, as I think i am 90% of the way to being done with setting this up. </p>\n"},{"tags":["ajax","ruby-on-rails-3","forms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13113328,"title":"Disable-with in Rails 3.2 shows for a second then switches button back","body":"<p>I've used the data: {\"disable-with\" => \"Loading...\"} directive on a remote => true form button, but, while it used to work before a rails upgrade (i think rails 3.1) It now doesn't work as expected anymore.</p>\n\n<p>What happens is that after clicking the button, the copy switched briefly (almost too fast to notice) to the expected \"Loading...\" copy, but then switches back to the original state; while the form has clearly not finished processing the data.</p>\n\n<p>How can I fix this?</p>\n\n<h1>Update</h1>\n\n<p>I realize now the problem is due to using a rails gem \"remotipart\", which also handles ajax form submissions.</p>\n\n<p>Is there a possible work-around so both can work together as they used to?</p>\n"},{"tags":["ruby-on-rails-3","paypal","activemerchant"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":842,"score":3,"question_id":9745197,"title":"Recurring billing with Rails - what are my options?","body":"<p>Before jumping in I'd like to know what all of my options are, and, if possible their pros and cons.</p>\n\n<p>The two I know of are using ActiveMerchant, or the paypal_recurring gem, but will they satisfy these requirements?</p>\n\n<ul>\n<li>Ability to accommodate monthly and annual billing</li>\n<li>Ability to suspend, cancel accounts etc</li>\n<li>Deal with out-of-date card details or failed payments</li>\n</ul>\n\n<p>The to-do list for the paypal_recurring gem includes 'adding support for IPN' - how will not having this impact functionality? </p>\n\n<p>I know there is the railskit SaaS but I'd rather code something myself as the railskit is still on 3.2.1.</p>\n\n<p>I know there are services like cheddergedder/chargify etc, but do they tie you in? Are they US only? Are they worth considering - or are they usually just aimed at non-developers?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","ruby-on-rails","ruby","ruby-on-rails-3","helper"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13114199,"title":"Scope Option in Uniqueness Helper in Rails","body":"<p>While reading the Rails Guides, I came across something I'm  unsure about. In the example, it shows that I can write a scope option that adds additional options towards checking uniqueness. My questions is, do I have to write out a method that queries specifically towards a time period. In other words, is there more code necessary than meets the eye in the example below? If not, how does Rails knows to check the right time stamp column in the table database?</p>\n\n<pre><code>class Holiday &lt; ActiveRecord::Base\n   validates :name, \n             :uniqueness =&gt; { :scope =&gt; :year,\n             :message =&gt; \"should happen once per year\" }\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","omniauth","statemachine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13113100,"title":"Rails: Implementing multi-step registration processes (with OmniAuth)","body":"<p>I'm trying to implement a multi-step registration process. This particular implementation involves OmniAuth, but for the purposes of this discussion it could well be any OAuth provider.</p>\n\n<p>Here are the registration steps we might implement:</p>\n\n<p><strong>Step 1.</strong> User <em>clicks</em> Connect with <strong><em>_</em>__<em>_</em>__<em>_</em>__</strong>.</p>\n\n<p><strong>Step 2.</strong> Authorize via <strong><em>_</em>__<em>_</em>__<em>_</em>__</strong> and redirect to callback. Pull relevant data from provider and save to your <code>User</code> model.</p>\n\n<p><strong>Step 3.</strong> Pick a username, fill out email address, and any other required data for registering for your app. Also save this to your <code>User</code> model.</p>\n\n<p><strong>The problem</strong> for me lies in the transition from Step 2 to Step 3. <strong>I could</strong> set validations on the data based on state, using something like <a href=\"https://github.com/pluginaweek/state_machine\" rel=\"nofollow\"><strong>state_machine</strong></a>, for example.</p>\n\n<p><strong>However</strong>, I would have to remove not-null constraints at the column level for certain essential pieces of data, like <code>username</code> in my case (which is used for user routes), or <code>email</code>. I'm not super comfortable removing another layer of data integrity.</p>\n\n<p>I'm sure this problem has been solved a thousand times before. How have you handled it and how would you recommend I handle it?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13113829,"title":"create a model in create action from a class","body":"<p>As a newbie to rails I can't find how to solve my issue ^^<br>\nI want to create a VideoPost from a form with a text field containing a video url (like youtube)<br>\nI'm getting information on the video thanks to the gem <a href=\"https://github.com/thibaudgg/video_info\" rel=\"nofollow\">https://github.com/thibaudgg/video_info</a><br>\nAnd I want to save thoses information using a model of mine (VideoInformation).\nBut I don't know how the create process should work.<br>\nThanks for any help !</p>\n\n<p>I'm trying to create a VideoPost in VideoPostsController like this :</p>\n\n<pre><code>def create\n  video_info = VideoInfo.new(params[:video_url])\n  video_information = VideoInformation.create(video_info)      #undefined method `stringify_keys' for #&lt;Youtube:0x00000006a24120&gt;\n  if video_information.save\n    @video_post = current_user.video_posts.build(video_information) \n  end\nend\n</code></pre>\n\n<p>My VideoPost model :  </p>\n\n<pre><code># Table name: video_posts\n#\n#  id                   :integer          not null, primary key\n#  user_id              :integer\n#  video_information_id :integer\n#  created_at           :datetime         not null\n#  updated_at           :datetime         not null\n</code></pre>\n\n<p>My VideoInformation model (which got same attributes name than VideoInfo gem) :  </p>\n\n<pre><code># Table name: video_informations\n#\n#  id              :integer          not null, primary key\n#  title           :string(255)\n#  description     :text\n#  keywords        :text\n#  duration        :integer\n#  video_url       :string(255)\n#  thumbnail_small :string(255)\n#  thumbnail_large :string(255)\n#  created_at      :datetime         not null\n#  updated_at      :datetime         not null\n</code></pre>\n"},{"tags":["ruby-on-rails-3","subscription","recurring-billing"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1023,"score":3,"question_id":5013558,"title":"How do I handle recurring/subscription billing in a Rails App?","body":"<p>I can't use Chargify, Recurly, Spreedly or any of those apps because I am not based in the US. I am in Jamaica, actually...so many of these companies don't support Jamaica.</p>\n\n<p>But I am trying to roll a custom subscription management solution - but given that this is my first web app - I think it might be too big a task for me to take on.</p>\n\n<p>Are there any gems that can handle this? These are the requirements:</p>\n\n<ul>\n<li>All users registered automatically get on a free plan for X days</li>\n<li>Towards the end of X days, they should be prompted to upgrade</li>\n<li>If they don't upgrade, at the end of X days their account gets locked/disabled</li>\n<li>If their account is disabled, they can upgrade and be taken to a checkout page (powered by 2checkout, because that is who I have to use for now).</li>\n<li>Then once they upgrade, and have selected a plan, the system should automatically increase their allocations (# of clients, # of projects, storage space, etc.)</li>\n</ul>\n\n<p>So I don't need the system to actually handle the processing of the credit cards, etc. It's more the logic of the subscription, restrictions on the models, upgrading and downgrading that I need.</p>\n\n<p>The perfect solution would be a well supported Rails gem that I can include in my Gemfile.</p>\n\n<p>If you don't have that, just send any/all possible solutions and I can take it from there.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","vestal-versions"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":271,"score":0,"question_id":3695928,"title":"Vestal Versions -","body":"<p>I'm using the Vestal Version Fork here for Rails 3 support: <a href=\"http://github.com/adamcooper/vestal_versions/\" rel=\"nofollow\">http://github.com/adamcooper/vestal_versions/</a></p>\n\n<p>The issue I'm having is that the updated_by => current_user is not storing in the versions table on update. </p>\n\n<pre><code>def update \n        @book = Book.find(params[:id]) \n  respond_to do |format| \n    if @book.update_attributes(params[:book].merge(:updated_by =&gt; current_user)) \n      format.html { redirect_to(@book, :notice =&gt; 'Book was \nsuccessfully updated.') } \n      format.xml  { head :ok } \n    else \n      format.html { render :action =&gt; \"edit\" } \n      format.xml  { render :xml =&gt; @book.errors, :status =&gt; :unprocessable_entity } \n    end \n  end \nend \n</code></pre>\n\n<p>I checked the logs, there is no error, Rails is INSERTING NULLs in the DB for the user fields, the one I need to populate is user_id</p>\n\n<p>Ideas?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","actionmailer","interceptor"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":563,"score":1,"question_id":6572344,"title":"switch mail delivery method in rails during runtime","body":"<p>I'm trying to setup a rails application so that I can choose between different mail delivery methods depending on whether some condition is true or not.</p>\n\n<p>So, given two delivery methods:</p>\n\n<pre><code>ActionMailer::Base.add_delivery_method :foo\nActionMailer::Base.add_delivery_method :bar\n</code></pre>\n\n<p>I thought I'd be able to just create an email interceptor to do something like this:</p>\n\n<pre><code>class DeliveryMethodChooser\n  def self.delivering_email(message)\n    if some_condition\n      # code to use mail delivery method foo\n    else\n      # code to use mail delivery method bar\n    end\n  end\nend\n</code></pre>\n\n<p>The problem though, is that I'm not sure how to actually set change what mail delivery method is used for a given message. Any ideas? Is it even possible to dynamically choose what delivery_method to use?</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13110573,"title":"Rails attributes headache","body":"<p>newbie rails question coming up. </p>\n\n<p>I have a class like this:</p>\n\n<pre><code>class Thing &lt; ActiveRecord::Base\n    attr_accessible :name\n    attr_accessor :name\n    validates_uniqueness_of :name, :case_sensitive =&gt; false\nend\n</code></pre>\n\n<p>I have done a migration and the table looks okay. I then fire up the <code>rails console</code> and try the following:</p>\n\n<pre><code>t = Thing.new(:name =&gt; \"test\")\n=&gt; #&lt;Thing id: nil, name: nil, description: nil, created_at: nil, updated_at: nil&gt; \n</code></pre>\n\n<p>already here it says name is nil, why?\nContinuing on, I try this:</p>\n\n<pre><code>t.name\n =&gt; \"test\"\n</code></pre>\n\n<p>Now name seems to be set anyway?\nIf I try to save:</p>\n\n<pre><code>t.save!\nThing Exists (8.0ms)  SELECT 1 AS one FROM \"things\" WHERE LOWER(\"things\".\"name\") = LOWER('test') LIMIT 1\nSQL (16.0ms)  INSERT INTO \"things\" (\"created_at\", \"description\", \"name\", \"updated_at\") VALUES ('2012-10-28 16:10:12.701000', NULL, NULL, '2012-10-28 16:10:12.701000')\n=&gt; true \n</code></pre>\n\n<p>Why is the name I have specified not being saved?\nWhat I want is to be able to specify attributes as a hash when calling new and then save the instance.</p>\n"},{"tags":["ruby","ruby-on-rails-3","query","views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13111978,"title":"rendering Ruby statements inside of rails views?","body":"<p>So in my DB I want stored a ruby/HTML statement in the Database Table such as - \np This site is owned from 2000 - #{Time.now.year} by Acme Widget Co. /p </p>\n\n<p>Or let's say that I want people to be able to include in other code snippits - e.g. \nA client wants to run in a show view in the middle of a paragraph some magical partial such as  #{render 'my_magical_code'} </p>\n\n<p>On the view I have this being rendered as &lt;%= raw(@page.content) %>  </p>\n\n<p>But its like a double rendering and rails will just put on the page #{render 'my_magical_code'} or #{Time.now.year} </p>\n\n<p>So can / how do I solve this? </p>\n\n<p>Thanks! </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","foreign-keys","nested-attributes","has-many-through"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13108991,"title":"Ruby on Rails: Simply Can Not Render Nested Attributes","body":"<p>I want to be able to show users who have liked a user's post. I am going to provide a simple amount of information so this issue won't get overwhelming.</p>\n\n<p>I have three classes involved:  User, Share and Opinion.  Their models are set up likewise:</p>\n\n<pre><code>class User\n  has_many :opinions, foreign_key: \"fan_id\", dependent: :destroy\nend\n\nclass Share\n  has_many :opinions, foreign_key: \"like_id\", dependent: :destroy\n  has_many :likes, through: :opinions\n  has_many :agreeables, foreign_key: \"fan_id\", class_name: \"Opinion\", dependent: :destroy\n  has_many :fans, through: :agreeables\nend\n\nclass Opinion\n  belongs_to :fan, class_name: \"User\"\n  belongs_to :like, class_name: \"Share\"\nend\n</code></pre>\n\n<p>In other words:  <code>like_id = share.id</code> &amp; <code>fan_id = user.id</code></p>\n\n<p>Then in my controller:</p>\n\n<pre><code>SharesController\n  def show\n    @share = Share.find(params[:id])\n    @shares = @share.fans.paginate(page: params[:page])\n  end\n</code></pre>\n\n<p>I click the link to <code>share_path</code>, it renders the page but with nothing on it.  When I look at my SQL logs, <strong>I notice the problem:</strong></p>\n\n<p>It is not inner joining opinions correctly to have the rendered share (<code>like_id</code>) match up with the users who liked the share (<code>fan_ids</code>).  </p>\n\n<p>Let's say the <code>share.id</code> was 11 and the <code>current_user.id</code> is 5.  It's query consists primarily of inner joining opinions to have the <code>like_id</code> <strong>AND</strong> <code>fan_id = 11</code>.</p>\n\n<p>Any ideas on how I can fix this problem or an alternate method that is more practical?</p>\n\n<p>Thanks for your help.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>For any future readers, the solution was as followed:</p>\n\n<pre><code>class User\n  has_many :fans, foreign_key: \"fan_id\", class_name: \"Opinion\", dependent: :destroy\nend\n\nclass Share\n  has_many :opinions, foreign_key: \"like_id\", dependent: :destroy\n  has_many :likes, through: :opinions\n  has_many :fans, through: :opinions\nend\n</code></pre>\n\n<p>And the <code>SharesController</code> and Opinion model was left unchanged.  </p>\n"},{"tags":["ruby-on-rails-3","sass","compass-css","scss","zurb-foundation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13111814,"title":"app/assets/stylesheets/foundation.css.scss does not compile","body":"<p>I'm trying to get Zurb responsive to work with Rails3/Compass on an existing project. I go back and forth from fixing it and breaking it.</p>\n\n<p>It worked in development mode.  I put some effort in getting it to compile assets for production and that broke development.</p>\n\n<p>This seems to be one of those known problems where there is no documented solution\n<a href=\"http://feedback.livereload.com/knowledgebase/articles/113949-how-to-solve-zurb-foundation-import-error-in-sass-\" rel=\"nofollow\">http://feedback.livereload.com/knowledgebase/articles/113949-how-to-solve-zurb-foundation-import-error-in-sass-</a></p>\n\n<p>It chokes on resolving </p>\n\n<pre><code>// Importing all of Foundation\n@import \"ZURB-foundation\";\n</code></pre>\n\n<p>in</p>\n\n<pre><code>/home/marc/rails_apps/wcaudit/app/assets/stylesheets/foundation.css.scss\n</code></pre>\n\n<p>RVM Info\n    marc@tsunami:~/rails_apps/wcaudit> rvm info</p>\n\n<pre><code>ruby-1.9.3-p286@wcaudit:\n\nsystem:\nuname:       \"Linux tsunami.site 2.6.34.10-0.6-desktop #1 SMP PREEMPT 2011-12-13 18:27:38 +0100 x86_64 x86_64 x86_64 GNU/Linux\"\nsystem:      \"unknown/libc-2.11/x86_64\"\nbash:        \"/bin/bash =&gt; GNU bash, version 4.1.7(1)-release (x86_64-suse-linux-gnu)\"\nzsh:         \"/usr/bin/zsh =&gt; zsh 4.3.10 (x86_64-unknown-linux-gnu)\"\n\nrvm:\nversion:      \"rvm 1.16.15 (stable) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\"\nupdated:      \"6 days 18 hours 5 minutes 34 seconds ago\"\n\nruby:\ninterpreter:  \"ruby\"\nversion:      \"1.9.3p286\"\ndate:         \"2012-10-12\"\nplatform:     \"x86_64-linux\"\npatchlevel:   \"2012-10-12 revision 37165\"\nfull_version: \"ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\"\n\nhomes:\ngem:          \"/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit\"\nruby:         \"/home/marc/.rvm/rubies/ruby-1.9.3-p286\"\n\nbinaries:\nruby:         \"/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\"\nirb:          \"/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin/irb\"\ngem:          \"/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin/gem\"\nrake:         \"/home/marc/.rvm/gems/ruby-1.9.3-p286@global/bin/rake\"\n\nenvironment:\nPATH:         \"/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/bin:/home/marc/.rvm/gems/ruby-1.9.3-p286@global/bin:/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin:/home/marc/.rvm/bin:/home/marc/bin:/usr/local/bin:/usr/bin:/bin:/usr/bin/X11:/usr/X11R6/bin:/usr/games:/usr/lib64/jvm/jre/bin\"\nGEM_HOME:     \"/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit\"\nGEM_PATH:     \"/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit:/home/marc/.rvm/gems/ruby-1.9.3-p286@global\"\nMY_RUBY_HOME: \"/home/marc/.rvm/rubies/ruby-1.9.3-p286\"\nIRBRC:        \"/home/marc/.rvm/rubies/ruby-1.9.3-p286/.irbrc\"\nRUBYOPT:      \"\"\ngemset:       \"wcaudit\"\n</code></pre>\n\n<p>GEM LIST</p>\n\n<pre><code>marc@tsunami:~/rails_apps/wcaudit&gt; gem list\n\n*** LOCAL GEMS ***\n\nactionmailer (3.2.8)\nactionpack (3.2.8)\nactivemodel (3.2.8)\nactiverecord (3.2.8)\nactiveresource (3.2.8)\nactivesupport (3.2.8)\narel (3.0.2)\nbuilder (3.0.4)\nbundler (1.2.1)\nchunky_png (1.2.6)\ncoffee-rails (3.2.2)\ncoffee-script (2.2.0)\ncoffee-script-source (1.3.3)\ncompass (0.12.2)\ncompass-rails (1.0.3)\nerubis (2.7.0)\nexecjs (1.4.0)\nfssm (0.2.9)\nhaml (3.1.7)\nhike (1.2.1)\ni18n (0.6.1)\njourney (1.0.4)\njquery-rails (2.1.3)\njson (1.7.5)\nlibv8 (3.3.10.4 x86_64-linux)\nmail (2.4.4)\nmime-types (1.19)\nmodular-scale (1.0.2)\nmulti_json (1.3.6)\npg (0.14.1)\npolyglot (0.3.3)\nrack (1.4.1)\nrack-cache (1.2)\nrack-ssl (1.3.2)\nrack-test (0.6.2)\nrails (3.2.8)\nrailties (3.2.8)\nrake (0.9.2.2)\nrdoc (3.12)\nrubygems-bundler (1.1.0)\nrvm (1.11.3.5)\nsass (3.2.1)\nsass-rails (3.2.5)\nsassy-math (1.2)\nsprockets (2.1.3)\ntherubyracer (0.10.2)\nthor (0.16.0)\ntilt (1.3.3)\ntreetop (1.4.11)\ntzinfo (0.3.33)\nuglifier (1.3.0)\nzurb-foundation (3.1.1)\nmarc@tsunami:~/rails_apps/wcaudit&gt; \n</code></pre>\n\n<p>COMPILE PHASE</p>\n\n<pre><code>marc@tsunami:~/rails_apps/wcaudit&gt; bundle exec rake assets:precompile/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin/ruby /home/marc/.rvm/gems/ruby-1.9.3-p286@global/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets\nrake aborted!\nFile to import not found or unreadable: ZURB-foundation.\nLoad paths:\nSass::Rails::Importer(/home/marc/rails_apps/wcaudit/app/assets/stylesheets/foundation.css.scss)\n/home/marc/rails_apps/wcaudit/app/assets/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/compass-0.12.2/frameworks/blueprint/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/compass-0.12.2/frameworks/compass/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/sassy-math-1.2/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/modular-scale-1.0.2/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/zurb-foundation-3.1.1/scss\nCompass::SpriteImporter\n(in /home/marc/rails_apps/wcaudit/app/assets/stylesheets/foundation.css.scss)\n\nTasks: TOP =&gt; assets:precompile:primary\n(See full trace by running task with --trace)\nrake aborted!\nCommand failed with status (1): [/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin...]\n\nTasks: TOP =&gt; assets:precompile\n(See full trace by running task with --trace)\n\nFile to import not found or unreadable: ZURB-foundation.\nLoad paths:\nSass::Rails::Importer(/home/marc/rails_apps/wcaudit/app/assets/stylesheets    /foundation.css.scss)\n/home/marc/rails_apps/wcaudit/app/assets/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/compass-0.12.2/frameworks/blueprint    /stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/compass-0.12.2/frameworks/compass/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/sassy-math-1.2/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/modular-scale-1.0.2/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/zurb-foundation-3.1.1/scss\nCompass::SpriteImporter\n(in /home/marc/rails_apps/wcaudit/app/assets/stylesheets/foundation.css.scss)\n</code></pre>\n"},{"tags":["ruby-on-rails-3","gem","bundler"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13111336,"title":"Bundler groups in my Gemfile not being honered","body":"<p>I have</p>\n\n<pre><code>group :production, :staging do\n  gem \"therubyracer\"\nend\n</code></pre>\n\n<p>in my <code>Gemfile</code>. If I run:</p>\n\n<pre><code>bundle install --without production staging test\n</code></pre>\n\n<p>therubyracer is added to my <code>Gemfile.lock</code>. Why is this happening please? I would expect it to be ignored?</p>\n\n<p>For completeness, if I remove the line:</p>\n\n<pre><code>  gem \"therubyracer\"\n</code></pre>\n\n<p>and run the above bundle command, then the therubyracer gem is removed from my <code>Gemfile.lock</code></p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":173,"score":3,"question_id":8690418,"title":"Rails Carrierwave if (:medium).present?","body":"<p>I am currently in the process of trying to move users from version 1 to version 2 of my app. Version 2 is a complete rewrite.</p>\n\n<p>I would like to show the <code>:medium</code> version ONLY if it exists. If it doesn't exist then I would like to show <code>:small</code>.</p>\n\n<p>How would I go about doing this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","resque"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13108379,"title":"How do I assign one worker to a queu?","body":"<p>In Resque, if I have the following:</p>\n\n<pre><code>bundle exec rake resque:work QUEUE=critical,high,normal,low,aggregate\n</code></pre>\n\n<p>How do I indicate that I only want one, and ONLY ONE worker, for a specific queue (i.e. the aggregate queue)?</p>\n"},{"tags":["ruby","ruby-on-rails-3","devise","google-authenticator"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":381,"score":1,"question_id":6497752,"title":"Rails 3 devise + google authenticator?","body":"<p>I'm trying to integrate the Google Authenticator OATH (<em>not OAuth</em>) one-time password authentication with devise, but can't find any pointers on whether it's already done or how to proceed. (Plenty of tips on how to make it work with OAuth. Which is something completely different.)</p>\n\n<p>Anyone have any experience with this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13108794,"title":"Ruby on rails - How can check a radio button, created by simple form, is checked in controller?","body":"<p>I built an view to create question and answer. This is my Question and Answer model:</p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  attr_accessible :content\n\n  belongs_to :topic\n  belongs_to :user\n  belongs_to :question_type\n  has_many :answers, dependent: :destroy\n  accepts_nested_attributes_for :answers\nend\n\nclass Answer &lt; ActiveRecord::Base\n  attr_accessible :content\n\n  belongs_to :question\nend\n</code></pre>\n\n<p>My answer model also have a attribute called <code>correct</code> type boolean to set true if which answer is correct, default is false. I have built a form to create a True/False question:</p>\n\n<pre><code>&lt;%= simple_form_for @question do |q| %&gt;\n\n  &lt;%= q.input :content, input_html: { rows: 3, class: 'span6' } %&gt;\n  &lt;%= q.input :mark, input_html: { class: 'span1' } %&gt;\n  &lt;%= q.association :topic %&gt;\n  &lt;%= q.association :question_type %&gt;\n\n  &lt;%= q.simple_fields_for :answers do |a| %&gt;\n\n    &lt;%= a.input :correct, collection: [[true, 'True'], [false, 'False']],\n                                                            as: :radio_buttons,\n                                                            label: 'Answer',\n                                                            value_method: :first,\n                                                            label_method: :last,\n                                                            item_wrapper_class: 'inline'\n                                                            %&gt;\n\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The correct attribute when rendered in view have these html:</p>\n\n<pre><code>&lt;label class=\"radio inline\"&gt;&lt;input class=\"radio_buttons optional\" id=\"question_answers_attributes_0_correct_true\" name=\"question[answers_attributes][0][correct]\" type=\"radio\" value=\"true\"&gt;True&lt;/label&gt;\n\n&lt;label class=\"radio inline\"&gt;&lt;input checked=\"checked\" class=\"radio_buttons optional\" id=\"question_answers_attributes_0_correct_false\" name=\"question[answers_attributes][0][correct]\" type=\"radio\" value=\"false\"&gt;False&lt;/label&gt;\n</code></pre>\n\n<p>Now in controller i want to check which radio button is checked and its value. Is there any method to check if <code>correct</code> attribute is checked and its value in controller?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13104869,"title":"how to embed a user created ruby program in rails3","body":"<p>Hi I am a quite a newbie in Rails and few days exp in ruby. I created a stopwatch program using threads.  But now I want to put it inside my Rails app and the view should have buttons to start,stop,resume of the stopwatch coz I am tracking an event. Can someone show <strong>how to embed a ruby program into rails and use it from view?</strong> </p>\n\n<p>The below  program should be invoked from start/stop/resume buttons in view</p>\n\n<p><strong>stopwatch.rb:</strong> (It just has start method and pause method as of now)</p>\n\n<pre><code>class Stopwatch\n\ndef initialize\n    @t_start\n    @t_elapsed \n    @t_total\n    @t_current\nend\n\n\ndef start\n    @t_start = Time.now\n    t = Thread.new do \n          while true do\n            @t_current = Time.now\n            puts @t_current\n            @t_elapsed = @t_current - @t_start\n            puts \"Time elapsed is : #{@t_elapsed.to_i} seconds\"\n            sleep 1\n          end\n\n     end\n\nend\n\ndef pause\n    # Stop the Thread =&gt; Sleep the Thread until Resume is pressed.\n    t.kill\n    # Calculate the elapsed time\n        @t_elapsed = @t_current - @t_start   \n\n    end\n\nend\n\nticker = Stopwatch.new\n\nticker.start\n</code></pre>\n\n<p>Thanks,</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13109099,"title":"rails ActiveRecord includes method with where : where not applied in subsequent calls to get associations","body":"<p>Say I have 2 tables <em>as</em> and <em>bs</em> in a many-to-many relationship with a join table. The join table has an attribute <em>cond</em>.</p>\n\n<p>The records are as follows:</p>\n\n<p>as:</p>\n\n<pre><code>id\n1\n</code></pre>\n\n<p>abs:</p>\n\n<pre><code>id  a_id  b_id  cond\n1   1     1     1\n2   1     1     0\n</code></pre>\n\n<p>bs:</p>\n\n<pre><code>id\n1\n</code></pre>\n\n<p>Now I do:</p>\n\n<blockquote>\n  <p>b = A.find(1).bs.where(:abs => {:cond => 1}).includes(:abs).first</p>\n</blockquote>\n\n<p>Which gives me my <em>b</em> instance, the question is, why does <em>b.abs</em> return <strong>all</strong> <em>abs</em> rows?</p>\n\n<p>I thought the <em>includes</em> method was meant to avoid reloading associations in subsequent calls to the associations methods. Since I used a <em>where</em> in the first call I would expect <em>b.abs</em> to return only the row with <em>cond == 1</em>.</p>\n\n<p>I tried this in the rails console and no SQL request is issued when I perform the <em>b.abs</em> call. What is happening here? Is there a way to do what I want or do I need to put the condition again on <em>b.abs</em> like *b.abs.where(:abs => {:cond => 1}) ?</p>\n\n<p>As requested in the comments, here is the code for the models:</p>\n\n<p>cat app/models/a.rb</p>\n\n<pre><code>class A &lt; ActiveRecord::Base\n    has_many :bs, :through =&gt; :abs\n    has_many :abs   \nend\n</code></pre>\n\n<p>cat app/models/b.rb</p>\n\n<pre><code>class B &lt; ActiveRecord::Base\n    has_many :as, :through =&gt; :abs\n    has_many :abs \nend\n</code></pre>\n\n<p>cat app/models/ab.rb                                                                              </p>\n\n<pre><code>class Ab &lt; ActiveRecord::Base\n    attr_accessible :cond, :a_id, :b_id\n    belongs_to :a\n    belongs_to :b\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","json","parsing","url"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13102171,"title":"Parse embedded string form JSON","body":"<p>I have a Rails 3 application and I am using the following code to parse a JSON post:</p>\n\n<pre><code>email_payload = JSON.parse(params[:payload])\nResult.create(:from =&gt; email_payload['from'], :from_name =&gt; email_payload['from_name'], :from_address =&gt; email_payload['from_address'], :date =&gt; email_payload['date'], :html_body =&gt; email_payload['html_body'], :priority =&gt; email_payload['priority'], :spam_status =&gt; email_payload['spam_status'], :subject =&gt; email_payload['subject'])\n</code></pre>\n\n<p>The JSON post data is as follows:</p>\n\n<pre><code>payload{ \"address_identifier\": null, \"attachments\": [ [ \"twitter.png\", \"image/png\", 3029, \"http://api.deliverhq.com/api/incoming/attachment/7gdd71wo75/5772412/0\" ] ], \"cc\": null, \"date\": \"Thu, 25 Oct 2012 22:04:20 +0100\"\n</code></pre>\n\n<p>I am trying to work out how to parse the URL, in this case <code>http://api.deliverhq.com/api/incoming/attachment/7gdd71wo75/5772412/0</code>, and then enter the URL into the database.</p>\n\n<pre><code>:url =&gt; email_payload['attachments']\n</code></pre>\n\n<p>won't work because there is multiple values within attachment and:</p>\n\n<pre><code>email_attachments_payload = JSON.parse(params[:payload][:attachments])\n:url =&gt; email_attachments_payload['URL']\n</code></pre>\n\n<p>won't work because the URL doesn't have an identifier. For this particular application there should only ever be one attachment, therefore selecting .first may be an option if that's possible.</p>\n\n<p>Any pointers would be appreciated!</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Adding:</p>\n\n<pre><code>email_payload[:attachments][0][4]\n</code></pre>\n\n<p>results in the following exception error:</p>\n\n<pre><code>NoMethodError: undefined method []' for nil:NilClass\n</code></pre>\n\n<p><strong>UPDATE 2</strong></p>\n\n<pre><code>def receive_fax\n    if request.get?\n        render :text =&gt; \"hello\"\n    elsif request.post?   \n      email_payload = JSON.parse(params[:payload])     \n      Fax.create(:from =&gt; email_payload['from'], :from_name =&gt; email_payload['from_name'], :from_address =&gt; email_payload['from_address'], :date =&gt; email_payload['date'], :html_body =&gt; email_payload['html_body'], :priority =&gt; email_payload['priority'], :spam_status =&gt; email_payload['spam_status'], :subject =&gt; email_payload['subject'], :fax =&gt; email_payload[:attachments][0][3])\n      render :text =&gt; \"success\"\n    else\n      render :text =&gt; \"error\"\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","ssl","google-analytics","cname"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13096487,"title":"When I am using google analytics to track a rails app deployed to heroku, which url do I use?","body":"<p>There is the initial heroku app name like something.herokuapp.com, then there is the ssl certified heroku app name like somethingelse.herokussl.com, and finally there is the actual website name www.anothername.com that is cname'd to the heroku ssl address. Which url should I ask google analytics to generate the tracking analytics code for?</p>\n"},{"tags":["regex","database","ruby-on-rails-3","json"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13108884,"title":"Strip numbers from JSON response in Rails 3?","body":"<p>I am receiving a JSON post into my Rails 3 application. I am then parsing each of the values and inserting them into the application database. It's all working well but now I would like to modify the received values before inserting them into the database.</p>\n\n<pre><code>:subject =&gt; email_payload['subject']\n</code></pre>\n\n<p>As the above code shows, I am inserting the received value for 'subject' into the column named 'subject'.</p>\n\n<p>In the example above the received value is like this:</p>\n\n<pre><code>Results from Example Company - Surname/Firstname/[12345]\n</code></pre>\n\n<p>What I would like to do is strip everything out except the numerical value between the []. So the value that's inserted into the database is simply:</p>\n\n<pre><code>12345\n</code></pre>\n\n<p>I can, presumably, just select anything from 0-9 but how do I add regex to the received string?</p>\n\n<p>None of the following seem to work:</p>\n\n<pre><code>['subject.gsub!([0-9])']\n['subject'.gsub!([0-9])]\n['subject'].gsub!([0-9])\n</code></pre>\n\n<p>I've tested the Regex here <a href=\"http://rubular.com/r/AVFkm3A440\" rel=\"nofollow\">http://rubular.com/r/AVFkm3A440</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13105841,"title":"Rails 2 tables, 1 model","body":"<p>I am relatively new to ruby/rails and I have the following question:</p>\n\n<p>I am working on a scheduling app and have a model named Classes and another named ClassEntries. The relationship between them is that each user can have multiple class entries per semester, each relating to one class. Each record in the Classes table belongs to a specific University. A User can have multiple entries in the ClassEntries table for 1 semester (typically 5). Their schedule is comprised of all their ClassEntries with the same semester ID.</p>\n\n<p>I am not sure whether I should have a third model called Schedule that brings together the info in the ClassEntries and Classes models for the user at hand. I originally wrote this functionality in PHP and I simply used a MySQL JOIN to gather the necessary information. In Rails it seems that there should be a better way to accomplish this.</p>\n\n<p>What would be the best way of going about this in Rails?</p>\n\n<p>Many thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13089936,"title":"Tracking/Logging ActiveRecord Callbacks","body":"<p>Is there any way to automatically log everytime an ActiveRecord callback happens? It would help to trace through why certain things are happened when a record has several callbacks in place.</p>\n\n<p>I'd like to see automated log message that indicate which messages are being called in response to which callbacks, e.g.: <code>before_validation: calling update_capitalization</code></p>\n"},{"tags":["ruby-on-rails-3","internationalization","routes","translation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":158,"score":4,"question_id":8870042,"title":"What is the best way to translate slugs in Rails routes","body":"<p>I'm trying to achieve full internationalization of my routes in a Rails3.1 app. I'm already using Francesc Pla's <a href=\"https://github.com/francesc/rails-translate-routes\" rel=\"nofollow\">rails-translate-routes</a> to localize route actions and resources. The last step is to be able to translate slugs for some of my models. </p>\n\n<p>Route to be translated: </p>\n\n<pre><code>http://myhost.com/products/pharmacy --&gt; http://myhost.com/productos/farmacia\n</code></pre>\n\n<p>I have a nested route of the form</p>\n\n<pre><code># routes.rb\nmatch 'products/:category_slug' =&gt; \"products#index\"\n</code></pre>\n\n<p>I have a model Category with an instance <code>#&lt;Category id: 1, slug: \"pharmacy\"&gt;</code> and I do <code>find_by_slug</code> category in my ProductsController.</p>\n\n<p>Any ideas on how to do translate the <code>:category_slug</code> part of the route?</p>\n"},{"tags":["ruby-on-rails-3","validation","mongoid","aggregation","activemodel"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":133,"score":5,"question_id":13041971,"title":"Rails/ActiveModel passing arguments to EachValidator","body":"<p>I have a very generic validator and I want to pass it arguments.  </p>\n\n<p>Here is an example model:</p>\n\n<pre><code>class User\n  include Mongoid::Document\n\n  field :order_type\n  has_many :orders, inverse_of :user\n  validates: orders, generic: true #i want to pass argument (order_type)\n\n  field :task_type\n  has_many :tasks, inverse_of :user\n  validates: tasks, generic: true #i want to pass argument (task_type)\nend\n</code></pre>\n\n<p>and Example validator:</p>\n\n<pre><code>class GenericValidator &lt; ActiveModel::EachValidator\n  def validate_each(object, attribute, value)\n    if some_validation?(object)\n      object.errors[attribute] &lt;&lt; (options[:message] || \"is not formatted properly\") \n    end\n  end\nend\n</code></pre>\n\n<p>Is there any way to pass arguments to the validator dependant on which field it is validating?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","testing","rspec","actionmailer"],"answer_count":4,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":1218,"score":9,"question_id":6487618,"title":"Testing ActionMailer multipart emails with RSpec","body":"<p>I'm currently testing my mailers with RSpec, but I've started setting up multipart emails as described in the Rails Guides here:  <a href=\"http://guides.rubyonrails.org/action_mailer_basics.html#sending-multipart-emails\">http://guides.rubyonrails.org/action_mailer_basics.html#sending-multipart-emails</a></p>\n\n<p>I have both mailer templates in text and html formats, but it looks like my tests are only checking the HTML portion.  Is there a way to check the text template separately?</p>\n\n<p>Is it only checking the HTML view because it's first in the default order?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","jquery-ui","ruby-on-rails-3.1","asset-pipeline"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":108,"score":6,"question_id":12963106,"title":"Copy of environments/development asset path cannot find jquery-ui-rails in gems directories","body":"<p>I copied config/environments/development.rb to config/environments/ci.rb.</p>\n\n<p>When I run with RAILS_ENV=development, the asset search path includes my gem vendor directories, in particular for jquery-ui-rails.  However, when I run with RAILS_ENV=ci it does not.</p>\n\n<p>From the console, Rails.application.config.assets.paths evaluates to the following with development</p>\n\n<pre><code>irb(main):002:0&gt; Rails.application.config.assets.paths\n=&gt; [\"/var/www/ci/conflux/app/assets/images\",\n  \"/var/www/ci/conflux/app/assets/javascripts\",\n  \"/var/www/ci/conflux/app/assets/stylesheets\",\n  \"/var/www/ci/conflux/vendor/assets/stylesheets\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-rails-1.0.19/vendor/assets/javascripts\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-ui-rails-1.0.0/vendor/assets/images\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-ui-rails-1.0.0/vendor/assets/javascripts\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-ui-rails-1.0.0/vendor/assets/stylesheets\"]\n</code></pre>\n\n<p>but for ci I only get the following:</p>\n\n<pre><code>irb(main):002:0&gt; Rails.application.config.assets.paths\n=&gt; [\"/var/www/ci/conflux/app/assets/images\",\n  \"/var/www/ci/conflux/app/assets/javascripts\",\n  \"/var/www/ci/conflux/app/assets/stylesheets\",\n  \"/var/www/ci/conflux/vendor/assets/stylesheets\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-rails-1.0.19/vendor/assets/javascripts\"]\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13105304,"title":"Use Pagination in Ruby when fetching data with a SQL query (mysql2 type)","body":"<p>I have a query in my controller which looks like this:</p>\n\n<pre><code>@temp = connection.execute(\"select test_id from mastertest limit 500;\")\n</code></pre>\n\n<p>Now I display the results fetched here in a table in my view. But I want to limit the results to say 10 rows per page. I know I can use will_paginate and kaminari</p>\n\n<p><a href=\"https://github.com/amatsuda/kaminari\" rel=\"nofollow\">https://github.com/amatsuda/kaminari</a></p>\n\n<p><a href=\"https://github.com/mislav/will_paginate\" rel=\"nofollow\">https://github.com/mislav/will_paginate</a></p>\n\n<p>But can anyone give me the exact syntax or a sample code to apply pagination in my case of an SQL query and how I can display results in the view.</p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13102322,"title":"How to get rest of the records after a certain limit with activerecord","body":"<p>I got first 2 record out of 10 using following </p>\n\n<pre><code>News.all.order(\"published_at desc\").limit(2)\n</code></pre>\n\n<p>How do i get rest of the 8 record? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","install","bundler"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13107081,"title":"rails 'bundle install' - Do it manually?","body":"<p><strong>Problem:</strong>\nDue to proxy settings i am not able to execute 'bundle install' from comandline. I get the following error. I dont know the proxy settings and i want to continue with rails development.</p>\n\n<pre><code>Fetching source index for http://rubygems.org/\nCould not reach rubygems repository http://rubygems.org/\nCould not find gem 'capybara (&gt;= 0)' in any of the gem sources listed in your Ge\nmfile.\n</code></pre>\n\n<p><strong>Question:</strong>\nHow can we do 'bundle install' manually (downloading gems via browser and install in commandline)? I need to install only handlful of gems.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13095126,"title":"One select_tag and multiple button_to submit buttons","body":"<p>I have one select_tag and multiple button_to buttons on the same page. I'm looking to use the parameters from the select_tag for several of the buttons, is there a non-form way to do this? </p>\n\n<p>The reason I don't want to use a form is two fold:\n1. the number of buttons is dynamic\n2. the positioning of the buttons do not follow the form structure (object at the top and submit at the bottom)</p>\n\n<p>-here is one of the create methods that are linked to one of the buttons</p>\n\n<pre><code>def create\n  params[:options].each do |x|\n    @connector = Connector.find_or_create_by_options_id_and_follow_id(x.id, current_user.follow(@product).id)\n    @connector.save\n  end\nend\n</code></pre>\n\n<p>I checked and this params[:options] is always nil no matter what is selected by me when I test</p>\n\n<pre><code>&lt;%= select_tag :options, options_for_select(@current_user_options.map {|p| [p.name, p.id] }), {:multiple =&gt; true} %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","callback","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13106879,"title":"How to build/create mongoid multi-level embedded document upon creation of the root while respecting all natural callbacks?","body":"<p>Let's say I have a structure of models like this:</p>\n\n<pre><code>class User\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  embeds_one :personal_data\n  embeds_one :professional_data\n\n  ...\nend\n\nclass PersonalData\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  embeds_one :family_data\n\n  field :stuff, :type =&gt; String\n\n  ...\nend\n\nclass ProfessionalData\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  field :stuff, :type =&gt; String\n\n  ...\nend\n</code></pre>\n\n<p>So simply put a user would have a tree of data that would look like this:</p>\n\n<pre><code>User -&gt; PersonalData -&gt; FamilyData\n     -&gt; ProfessionalData\n</code></pre>\n\n<p>As you may have noticed, each of my models uses Mongoid:Timestamps as I want to know when each sub part of the user gets modified.</p>\n\n<p>Now where it gets tricky, is that I want upon creating a new User, that it automatically gets all its embedded model created with it while using the proper callbacks to set the Timestamps.</p>\n\n<p>Ideally I would like to avoid doing multiple writes to the DB, but I haven't found an elegant way of doing this so far.</p>\n\n<p>For the moment I have this in my User model:</p>\n\n<pre><code>after_create :create_personal_data\nafter_create :create_professional_data \n</code></pre>\n\n<p>And in PersonalData model:</p>\n\n<pre><code>after_create :create_family_data\n</code></pre>\n\n<p>However the results are not what I am expecting, it works great for the ProfessionalData model, where it gets created and the TimeStamps callback works, :created_at and :updated_at are set properly.\nHowever for the PersonalData model, it does not work properly:\n- the embedded model gets created\n- but the callback are not called properly, and TimeStamps are not set\n- the embedded FamilyData does not get created un PersonalData</p>\n\n<p>I am using Mongoid 2.4.12 with Rails 3.2</p>\n\n<p>Thx.</p>\n\n<p>Alex</p>\n"},{"tags":["ruby-on-rails-3","resque"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13106631,"title":"Setting up Resque in Rails","body":"<p>When setting up Resque for the first time in Rails, I'm getting an error.  I'm using Foreman and a Procfile to start my app locally, before eventual deployment to Heroku.  Redis and my PostgreSQL database are already running when I try to start my app.  The error is:</p>\n\n<pre><code>$ foreman start\n...\n23:24:32 resque.1 | rake aborted!\n23:24:32 resque.1 | No such file to load -- bootstrap_flash_helper\n23:24:32 resque.1 | Tasks: TOP =&gt; resque:work =&gt; resque:preload\n23:24:32 resque.1 | (See full trace by running task with --trace)\n23:24:32 resque.1 | exited with code 1\n...\n</code></pre>\n\n<p>My app does use Bootstrap, but I'm not explicitly requiring it in any classes using Rescue.  My Rakefile and Procfile are:</p>\n\n<p><strong>Procfile</strong></p>\n\n<pre><code>web: bundle exec rails server -p $PORT\nresque: env TERM_CHILD=1 RESQUE_TERM_TIMEOUT=10 bundle exec rake resque:work\n</code></pre>\n\n<p><strong>Rakefile</strong></p>\n\n<pre><code>require File.expand_path('../config/application', __FILE__)\nrequire 'resque/tasks'\n\ntask \"resque:setup\" do\n  ENV['QUEUE'] = '*'\nend\n\ntask \"jobs:work\" =&gt; \"resque:work\"\n\nMyCoolApp::Application.load_tasks\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","internationalization","gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13106082,"title":"How can I internationalize my rails app (not translate)?","body":"<p>First off, yes I've read all the <a href=\"http://guides.rubyonrails.org/i18n.html\" rel=\"nofollow\">rails documentation about I18n</a> but it doesn't help me with what I want to do.</p>\n\n<p>The app I'm developing will be international (in multiple languages) with user-generated content. I don't want to translate the user-generated content to different languages but I need to assign a \"locale\" to every piece of content.</p>\n\n<p>Though, the static pages (about us, how it works, contact us, etc.) will be translated.</p>\n\n<p>I've looked at <a href=\"https://github.com/galetahub/globalize3#readme\" rel=\"nofollow\">globalize3</a> but from what I understand it only solves my problem for static pages.</p>\n\n<p>I guess I could simply add a column \"locale\" to all my user-generated content models but then I would need to chain a \"where locale = current_locale\" to every query. This will end up being heavy in the end.</p>\n\n<p>Does anyone have other ideas? Maybe a filter for certain model queries could be devised, but I am still a new Rails developer and don't know if that is possible.</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4378,"score":2,"question_id":5015685,"title":"Ruby on rails :- Could not find RubyGem rails (>= 0) (Gem::LoadError)","body":"<p>I am very new to Ruby on Rails. I installed ruby on rails on my Windows 7 using the installer in <a href=\"http://railsinstaller.org/\" rel=\"nofollow\">http://railsinstaller.org/</a>. I could create a project once and thereafter I was not (I dont know what did I do in between :-( ). </p>\n\n<p>The complete errors messages are :-</p>\n\n<p><strong>On creating a new project</strong> :-</p>\n\n<pre><code>c:\\Sites&gt;rails new Tickets_Test\nE:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:762:in `report_activate_error': Cou\nld not find RubyGem rails (&gt;= 0) (Gem::LoadError)\n        from E:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:219:in `activate'\n        from E:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:1065:in `gem'\n        from E:/Ashish/RailsInstaller/Ruby1.8.7/bin/rails:18:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>on just getting the version</strong>:- </p>\n\n<pre><code>c:\\Sites&gt;rails --version\nE:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:762:in `report_activate_error': Cou\nld not find RubyGem rails (&gt;= 0) (Gem::LoadError)\n        from E:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:219:in `activate'\n        from E:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:1065:in `gem'\n        from E:/Ashish/RailsInstaller/Ruby1.8.7/bin/rails:18:in `&lt;main&gt;'\n</code></pre>\n\n<p>Any idea why the above is happening?</p>\n\n<p><strong>EDIT</strong> </p>\n\n<p>Appearently there are two command prompts :-\n Ruby command prompt :-\n<img src=\"http://i.stack.imgur.com/R0qx3.png\" alt=\"Ruby\">\nand\n Ruby for rails command prompt (The problem is resolved using this command prompt):-\n<img src=\"http://i.stack.imgur.com/A4IPh.png\" alt=\"Ruby on rails\"></p>\n\n<p>I was using ruby command prompt. Sounds like a stupid question, however, I am not sure how there are \"two\" command prompts?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","amazon-s3","asset-pipeline","sprockets"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13105757,"title":"Non-digest .js linking to cache-digested assets","body":"<p>I'm currently using asset_sync to move my assets to S3 from Rails. </p>\n\n<p>We serve our JS library as a <code>bootstrap.js</code> which bootstraps other stylesheets/js that should be cache-controlled via the digest. Since I want to be able to change functionality to our library quickly, <code>bootstrap.js</code> is short-lived and must be therefore very small, whereas the cache-digested css/js should be living forever accordingly to Rails asset pipeline principles.</p>\n\n<p>The Problem now is that when I do the precompilation, the digested <code>bootstrap.js</code> correctly loads the cache-digested other css/js, but the non-digest <code>bootstrap.js</code> only points to the non-digest equivalents, despite me explicitly setting <code>:digest</code> to true</p>\n\n<pre><code>&lt;%= asset_path 'badgelib.js', :digest =&gt; true %&gt;\n</code></pre>\n\n<p>Is there any other way to force the asset to link to the digest-version?</p>\n"},{"tags":["database","ruby-on-rails-3","activerecord","automation","rails-migrations"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13104649,"title":"Given an array of (sanitized) attribute headers (metatags), how might I automatically create columns for each in my database based on those tags?","body":"<p>So here is the unformatted list (this one, an income statement, has over row headers like these, so yes, automation is the way to go here).</p>\n\n<p>[\"Revenue\", \"Other Revenue, Total\", \"Total Revenue\", \"Cost of Revenue, Total\"...]</p>\n\n<p>Here is the list after I ran each array entity (string) through my simple little sanitizer program, <code>CleanZeeString.new.go(str)</code>.</p>\n\n<p>[\"revenue\", \"other_revenue_total\", \"total_revenue\", \"cost_of_revenue_total\"...]</p>\n\n<p>So, I want to access Rails methods that will allow me to at least partially automate the database column creation process and migration, because this list has over 50 row headers, there are more lists, and I simply do not believe in doing things by hand anymore.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13104980,"title":"using url in a string in ruby","body":"<p>I want to convert urls in a string to workable urls. For example:\n    str = \"Hello, this is the link for yahoo: <a href=\"http://www.yahoo.com\" rel=\"nofollow\">http://www.yahoo.com</a>\"</p>\n\n<pre><code>//in the view i have\n&lt;%= parse_description(r[:description]) %&gt;\n\n//in helper, i am splitting each word in the string and verifying if i have a string which\n//  contains http, if http is present then i am using link_to to make it a valid url:\ndef parse_description(str)\n  s = \"\"\n    str.split.each do |w|\n       a =  w.include?(\"http\") ? (link_to nil,\"#{w}\") : w\n       s += \"#{a} \"\n    end \nend\n</code></pre>\n\n<p>once the string is returned back to the view, the link is not clickable. what wrong i am doing?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","backbone.js","javascript-framework"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":671,"score":4,"question_id":7379525,"title":"Backbone model without collection. Sending duplicate data to server?","body":"<p>I have a Backbone app powered by a rails backend. I have an <code>Invitation</code> resource and I can send invitations by sending a POST request to the create action of the invitation's controller.</p>\n\n<p>My Backbone model looks like this (coffeescript):</p>\n\n<pre><code>class Invitation extends Backbone.Model\n  urlRoot: '/invitations'\n</code></pre>\n\n<p>And the template for the form to send an invitation follows. I tried to make it as close to the normal rails forms as possible as it seems like Rails would deal with that best:</p>\n\n<pre><code>&lt;form action=\"/invitations\" accept-charset=\"UTF-8\" id=\"new_invitation\" class=\"new_invitation\" method=\"post\"&gt;\n  &lt;input id=\"invitation_recipient_name\" class=\"invitation_recipient_name\" type=\"text\" name=\"invitation[recipient_name]\" /&gt;\n  &lt;input id=\"invitation_recipient_email\" class=\"invitation_recipient_email\" type=\"text\" name=\"invitation[recipient_email]\" /&gt;\n  &lt;input type=\"submit\" class=\"btn primary\" name=\"commit\" id=\"invite\" value=\"Send Invitation\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here is my Backbone View for that model and template</p>\n\n<pre><code>class InvitationView extends Backbone.View\n  # this is the template shown above\n  template: JST['backbone/templates/invitation']\n  events:\n    'click #invite': 'sendInvite'\n\n  render: -&gt;\n    $(this.el).html this.template()\n    this\n  sendInvite: (e) -&gt;\n    e.preventDefault()\n    name = this.$('#invitation_recipient_name')\n    email = this.$('#invitation_recipient_email')\n    this.model.save\n      recipient_name: name.val()\n      recipient_email: email.val()\n</code></pre>\n\n<p>The problem is that when I click the submit button and the <code>sendInvite</code> method is called, my server receives data with the following structure:</p>\n\n<pre><code>Parameters: {\"recipient_name\"=&gt;\"A name\", \"recipient_email\"=&gt;\"name@example.com\", \"invitation\"=&gt;{\"recipient_email\"=&gt;\"name@example.com\", \"recipient_name\"=&gt;\"A name\"}}\n</code></pre>\n\n<p>Now this actually works, since my <code>invitations#create</code> action expects to work with parameters of the form: <code>params[:invitations]</code>, this is the standard for rails. However the fact that the name and email are being sent twice in the request seems a sign that something is wrong with my setup.</p>\n\n<p>Am I doing something wrong or is this correct?</p>\n\n<p>Here is my controller action if anyone wants to see it:</p>\n\n<pre><code>  # POST /invitations\n  def create\n    @invitation = current_user.sent_invitations.new params[:invitation]\n\n    respond_to do |format|\n      if @invitation.save\n        format.json { render_for_api :invitation, json: @invitation, status: :created }\n      else\n        format.json { render json: @invitation.errors, status: :unproccessible_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p><strong>Edit</strong> This is what my Invitation model looks like if I set the attributes and log it just before saving:</p>\n\n<pre><code>  Invitation\n    _changed: false\n    _changing: false\n    _escapedAttributes: Object\n      __proto__: Object\n    _previousAttributes: Object\n      recipient_email: \"dave@example.com\"\n      recipient_name: \"Dave\"\n      __proto__: Object\n    attributes: Object\n      recipient_email: \"dave@example.com\"\n      recipient_name: \"Dave\"\n      __proto__: Object\n    cid: \"c17\"\n    __proto__: ctor\n</code></pre>\n\n<p>THat log is produced by the following code btw:</p>\n\n<pre><code>sendInvite: (e) -&gt;\n    e.preventDefault()\n    name = @$('#invitation_recipient_name')\n    email = @$('#invitation_recipient_email')\n    @model.set recipient_name: name.val(), recipient_email: email.val()\n    console.log \"THe model to save\", @model\n</code></pre>\n\n<p><strong>Edit 2</strong><br>\nThis is how I'm instantiating my view in my router. How should I change this so that Backbone automatically keeps track of my models attributes, even though I'm not fetching and setting them from the server?.</p>\n\n<pre><code>  var TeamRouter = Backbone.Router.extend({\n    routes: {\n      'members': 'members'\n    },\n\n    members: function() {\n      @invite = new MoveOutOrg.Models.Invitation();\n      @inviteView = new MoveOutOrg.Views.InvitationView({\n        model: @invite\n      });\n      $('#stage').append(@inviteView.render().el);\n    }\n  });\n</code></pre>\n"},{"tags":["ruby-on-rails-3","jquery-mobile"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13104678,"title":"JQueryMobile list-item goes black upon mouseover","body":"<p>On my own site, when hovering over a list-item, it highlights black, instead of the darker gradiented background which appears when hovering on the <a href=\"http://jquerymobile.com/test/docs/lists/lists-ul.html\" rel=\"nofollow\">JQueryMobile Docs website</a>.</p>\n\n<p><img src=\"http://i.stack.imgur.com/8Uktg.jpg\" alt=\"Black list-item\"></p>\n\n<p>I found my code <a href=\"http://jquerymobile.com/test/docs/lists/docs-lists.html\" rel=\"nofollow\">here</a> under the \"basic linked lists\" right at the top. I have tried giving it other themes etc. but nothing seems to solve this simple issue.</p>\n\n<p>Here is my piece of code:</p>\n\n<pre><code>&lt;ul data-role=\"listview\" data-theme=\"b\"&gt;\n    &lt;li&gt;&lt;a href=\"acura.html\"&gt;Acura&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"audi.html\"&gt;Audi&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"bmw.html\"&gt;BMW&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>The only thing I can think of is the container in which the list is held, or something, but it's not that...</p>\n\n<p>Here's my setup:\nRunning Rails 3.2.6 with the latest JQuery and latest JQueryMobile.</p>\n\n<p>What could possibly cause this, and how can I solve it?</p>\n"},{"tags":["ruby-on-rails-3","for-loop","fields"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13104252,"title":"RoR: Add a blank field to a simple_fields_for loop","body":"<p>I am sure this is a silly question, but I have been searching for some time now without finding an answer.</p>\n\n<p>I have a nested form using simple_forms.  I get all the child objects successfully with</p>\n\n<pre><code> = f.simple_fields_for :fund_levels do |fl|\n     = fl.input :title\n     = fl.input :description\n     = fl.input :maxnumber\n     = fl.input :price\n</code></pre>\n\n<p>This gets all existing fund_levels.  However, I also want to add a blank set at the end of the list.  So that if there are no existing fund_levels, it simply shows a blank \"subform\", if there are two existing fund_levels, it will show those two plus a blank \"subform\".</p>\n\n<p>Is there an easy way of doing this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13104299,"title":"Rails model multiple properties of the same model","body":"<p>I'm struggle to find a way to have more than one property of the same model. I've this structure :</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n   attr_accessible :name, :content_type\nend\n\nclass MenuImage &lt; ActiveRecord::Base\n   belongs_to :image\n   belongs_to :menu\nend\n\nclass Menu &lt; ActiveRecord::Base\n   has_many :menu_images\n   has_many :images, :through =&gt; :menu_images\n\n   has_one :image, :as =&gt; :thumbnail_image\n\n   attr_accessible :thumbnail_image_id\nend\n</code></pre>\n\n<p>I want to be able to access the images using <code>@menu.images</code> and <code>@menu.thumbnail_image</code>.\nThe code <code>has_one :image, :as =&gt; :thumbnail_image</code> is an example of what i'm trying to obtain. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","facebook-graph-api","koala"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13103916,"title":"How to build a script that auto-post on my Facebook Pages with a non-permanent Access Token?","body":"<p>I'm developing a ruby script that push every new content on my Facebook Page as a post.\nI know about that the access token will expire in two hours, so how I could do that?</p>\n\n<p>Now this piece of code works because I set \"user_access_token\" manually (But after 2 hours it expire). It's my company facebook page linked to my facebook app.\nShould I click every two hours on \"Facebook connect\" and grant a new access token??</p>\n\n<pre><code>@user_graph = Koala::Facebook::API.new(user_access_token)\npages = @user_graph.get_connections('me', 'accounts')\n# get access token for first page\nfirst_page_token = pages.first['access_token']\n\n# or: retrieve access_token for a given page_id\npage_token = @user_graph.get_page_access_token(page_id)\n@page_graph = Koala::Facebook::API.new(page_token)\n\n@page_graph.put_wall_post('post on page wall') # post as page, requires publish_stream permission\n</code></pre>\n\n<p>I have got \"Page Access Token\" from here</p>\n\n<p><img src=\"http://i.stack.imgur.com/HElxt.png\" alt=\"I got PAGE ACCESS TOKEN FROM HERE\"></p>\n\n<p>but in one hour it will expire</p>\n\n<p><img src=\"http://i.stack.imgur.com/0htvq.png\" alt=\"enter image description here\"></p>\n\n<p><strong>[RESOLVED]</strong></p>\n\n<p>To get an extended Page Access Token, exchange the User Access Token for a long-lived one and then request the Page token. This \"extended\" token for Pages will actually not have any expiry time.</p>\n\n<p><a href=\"https://developers.facebook.com/docs/howtos/login/extending-tokens/#step1\" rel=\"nofollow\">https://developers.facebook.com/docs/howtos/login/extending-tokens/#step1</a></p>\n\n<p>I have resolved executing a curl request, and saving \"Page access token\" in my code manually</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3","facebook"],"answer_count":6,"favorite_count":30,"up_vote_count":25,"down_vote_count":0,"view_count":35863,"score":25,"question_id":6246449,"title":"Facebook how to check if user has liked page and show content?","body":"<p>I am trying to create a Facebook iFrame app. The app should first show an image and if the user likes the page, he will get access to some content.</p>\n\n<p>I use RoR, therefore I can't use the Facebook PhP SDK.</p>\n\n<p>Here is my iFrame HTML when the user has not liked the page:</p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\"&gt;\n&lt;head&gt;\n&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\" /&gt;\n&lt;style type=\"text/css\"&gt;\nbody {\nwidth:520px;\nmargin:0; padding:0; border:0;\nfont-family: verdana;\nbackground:url(repeat.png) repeat;\nmargin-bottom:10px;\n}\np, h1 {width:450px; margin-left:50px; color:#FFF;}\np {font-size:11px;}\n&lt;/style&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html;\ncharset=iso-8859-1\" /&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"container\"&gt;\n&lt;img src=\"welcome.png\" alt=\"Frontimg\"&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And, if the user has liked the page:</p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\"&gt;\n&lt;head&gt;\n&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\" /&gt;\n&lt;style type=\"text/css\"&gt;\nbody {\nwidth:520px;\nmargin:0; padding:0; border:0;\nfont-family: verdana;\nbackground:url(repeat.png) repeat;\nmargin-bottom:10px;\n}\np, h1 {width:450px; margin-left:50px; color:#FFF;}\np {font-size:11px;}\n&lt;/style&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html;\ncharset=iso-8859-1\" /&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"container\"&gt;\n&lt;img src=\"member.png\" alt=\"Frontimg\"&gt;\n&lt;p&gt;You liked this page&lt;/p&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","frontend"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13104010,"title":"Front-end editing in Rails","body":"<p>My app has a Ruby on Rails back-end (using git and heroku), and a front-end designer (css/jquery) just asked if he could work on the code without install rails (i.e. downloading the code from git, and just ftp'ing it to heroku).</p>\n\n<p>It does not seem like it is possible to FTP to heroku.  Is there some other way that front-end developers can interact with rails without having to install rails on their own?</p>\n\n<p>Thank you!</p>\n\n<p>Greg</p>\n"},{"tags":["ruby-on-rails-3","performance"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":212,"score":2,"question_id":12892937,"title":"Improve Rails loading time","body":"<p>This is a bit of a follow-up from <a href=\"http://stackoverflow.com/q/4736546/305019\">a previous question on improving rails console loading time</a>.</p>\n\n<p>The first great suggestion was to figure out <a href=\"http://stackoverflow.com/a/5071198/305019\">which gems take too long</a>.</p>\n\n<p>Next answer, suggested using <code>:require =&gt; nil</code> and <a href=\"http://stackoverflow.com/a/7146810/305019\">loading those gems later</a>.</p>\n\n<p>With some gems however, it's not entirely clear how to accomplish this without breaking things. Here's a list of our 'biggest offenders', I wonder if someone can suggest the best approach to loading them only when necessary?</p>\n\n<pre><code>require gon: 2.730000 (2.870059)\nrequire omniauth-openid: 1.410000 (1.503858)\nrequire cancan: 2.640000 (2.707467)\nrequire fog: 2.730000 (2.846530)\nrequire activeadmin: 3.650000 (3.923877)\n</code></pre>\n\n<p>and of course there are many more that take around 1 second or less, which also adds up... but at least removing the big ones will already improve things.</p>\n\n<h3>how can I selectively load gems later to make rails load faster?</h3>\n"},{"tags":["sql","ruby-on-rails-3","postgresql","count","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13103529,"title":"UPDATE based on count","body":"<p>I want to update the number_of_votes in the users table based on the poll_records table. In rails, it looks like</p>\n\n<pre><code>User.all.each do |user|\n  user.number_of_votes = user.poll_records.where(\"poll_record_type = 3\").size\n  user.save\nend\n</code></pre>\n\n<p>I am new to PostgreSQL. How can I update users this way?</p>\n"},{"tags":["query","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2643,"score":2,"question_id":5035365,"title":"How to specify multiple values in where with AR query interface in rails3","body":"<p>Per section 2.2 of rails guide on Active Record query interface <a href=\"http://guides.rubyonrails.org/active_record_querying.html#conditions\" rel=\"nofollow\">here</a>:</p>\n\n<p>which seems to indicate that I can pass a string specifying the condition(s), then an array of values that should be substituted at some point while the arel is being built. So I've got a statement that generates my conditions string, which can be a varying number of attributes chained together with either AND or OR between them, and I pass in an array as the second arg to the where method, and I get:</p>\n\n<blockquote>\n  <p>ActiveRecord::PreparedStatementInvalid: wrong number of bind variables (1 for 5)</p>\n</blockquote>\n\n<p>which leads me to believe I'm doing this incorrectly. However, I'm not finding anything on how to do it correctly. To restate the problem another way, I need to pass in a string to the where method such as \"table.attribute = ? AND table.attribute1 = ? OR table.attribute1 = ?\" with an unknown number of these conditions anded or ored together, and then pass something, what I thought would be an array as the second argument that would be used to substitute the values in the first argument conditions string. Is this the correct approach, or, I'm just missing some other huge concept somewhere and I'm coming at this all wrong? I'd think that somehow, this has to be possible, short of just generating a raw sql string.  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13085536,"title":"Rails nested form error: undefined method `update_attributes' for nil:NilClass","body":"<p>I'm using Mongoid, awesome_nested_fields gem and rails 3.2.8.</p>\n\n<p>I have the functionality working on the client (adding multiple fields), but when I try to save I get a \"undefined method `update_attributes' for nil:NilClass\" error.</p>\n\n<p>Here is all the relevant info:</p>\n\n<p><strong>profile.rb</strong></p>\n\n<pre><code>class Profile\n    include Mongoid::Document\n    include Mongoid::Timestamps\n\n    has_many :skills, :autosave =&gt; true\n    accepts_nested_attributes_for :skills, allow_destroy: true  \n    attr_accessible :skills_attributes\n\nend\n</code></pre>\n\n<p><strong>skill.rb</strong></p>\n\n<pre><code>class Skill\n    include Mongoid::Document\n    belongs_to :profile \n    field :skill_tag, :type =&gt; String\nend\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>&lt;%= simple_form_for(@profile) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n\n  &lt;div class=\"form-inputs\"&gt;\n\n            &lt;div class=\"items\"&gt;\n                &lt;%= f.nested_fields_for :skills do |f| %&gt;\n                &lt;fieldset class=\"item\"&gt;\n                    &lt;%= f.input :skill_tag, :label =&gt; 'Skills:' %&gt;\n                    &lt;a href=\"#\" class=\"remove\"&gt;Remove Skill&lt;/a&gt;\n\n                    &lt;%= f.hidden_field :id %&gt;\n                    &lt;%= f.hidden_field :_destroy %&gt;\n                &lt;/fieldset&gt;\n                &lt;% end %&gt;\n            &lt;/div&gt;\n            &lt;a href=\"#\" class=\"add\"&gt;Add Skill&lt;/a&gt;\n      &lt;/div&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n    &lt;%= f.button :submit, :class =&gt; 'btn' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>profiles_controller.rb</strong></p>\n\n<pre><code>  # PUT /profiles/1\n  # PUT /profiles/1.json\n  def update\n    @profile = Profile.find(params[:id])\n\n    respond_to do |format|\n      if @profile.update_attributes(params[:profile])\n        format.html { redirect_to @profile, notice: 'Profile was successfully updated.' } # Notice\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @profile.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p><em><strong></em>**<em>*</em>**<em>*</em>**<em>*</em>**<em></strong> UPDATE <strong></em>**<em>*</em>**<em>*</em>**<em>*</em>***</strong></p>\n\n<p>I ended up switching to Ryan's nested_form gem and it works like a charm.</p>\n"},{"tags":["ruby","ruby-on-rails-3","actionmailer"],"answer_count":1,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":2327,"score":9,"question_id":6197190,"title":"How to setup a mail interceptor in rails 3.0.3?","body":"<p>I am using rails 3.0.3, ruby 1.9.2-p180, mail (2.2.13). I m trying to setup a mail interceptor but I am getting the following error</p>\n\n<pre><code> /home/abhimanyu/Aptana_Studio_3_Workspace/delivery_health_dashboard_03/config/initializers/mailer_config.rb:16:in `&lt;top (required)&gt;': uninitialized constant DevelopmentMailInterceptor (NameError)\n</code></pre>\n\n<p>How do i fix it?</p>\n\n<p>The code I am using is shown below:</p>\n\n<pre><code>config/initializer/mailer_config.rb\n\nActionMailer::Base.default_charset = \"utf-8\"\nActionMailer::Base.default_content_type = \"text/html\"\nActionMailer::Base.raise_delivery_errors = true\nActionMailer::Base.perform_deliveries = true\nActionMailer::Base.delivery_method = :smtp\nActionMailer::Base.smtp_settings = {\n:enable_starttls_auto =&gt; true,\n:address =&gt; \"secure.emailsrvr.com\",\n:port =&gt; '25',\n:domain =&gt; \"domain\",\n:user_name =&gt; \"user_name\",\n:password =&gt; \"password\",\n:authentication =&gt; :plain\n</code></pre>\n\n<p>}</p>\n\n<pre><code>ActionMailer::Base.register_interceptor(DevelopmentMailInterceptor) if  Rails.env.development?\n</code></pre>\n\n<p>lib/development_mail_interceptor.rb</p>\n\n<pre><code>class DevelopmentMailInterceptor\n\n  def self.delivering_email(message)\n    message.to = \"email\"\n  end\n\nend\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mysqli","backup","dropbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13081839,"title":"Why can't I connect to Dropbox using OAuth?","body":"<p>I want to store my db backup in my dropbox account every night. For this I'm using Backup + dropbox gem. My Ruby version is 1.8.7p358 and Rails 2.3.8 and I'm using a Mysql database.</p>\n\n<p>Here is my error in console</p>\n\n<pre><code>[2012/10/26 11:25:28][error]ModelError: Backup for My Backup (my_backup) Failed!\n[2012/10/26 11:25:28][error]   An Error occured which has caused this Backup to abort before completion.\n[2012/10/26 11:25:28][error]   Please review the Log for this Backup to determine if steps need to be taken\n[2012/10/26 11:25:28][error]   to clean up, based on the point at which the failure occured.\n[2012/10/26 11:25:28][error]   Reason: OAuth::Unauthorized\n[2012/10/26 11:25:28][error]   401 Unauthorized\n</code></pre>\n\n<p>Here is my code </p>\n\n<pre><code>    Backup::Model.new(:my_backup, 'My Backup') do\n\n      database MySQL do |db|\n        db.name               = \"app_development\"\n        db.username           = \"user\"\n        db.password           = \"pass\"\n        db.host               = \"127.0.0.1\"\n      end\n\n      store_with Dropbox do |db|\n        db.api_key    = 'nvpsggrunft0'\n        db.api_secret = '71dvvvdx48hy3'\n        db.path       = '/backups'\n        db.keep       = 80\n        db.timeout    = 443\n      end\n\n\n      store_with FTP do |server|\n        server.username = 'aadddn'\n        server.password = 'tdsddsd'\n        server.ip       = 'Ip Address'\n        server.port     = 21\n        server.path     = ''\n        server.keep     = 30\n        server.passive_mode = true\n      end\n\n      compress_with Gzip do |compression|\n        compression.best = true\n        compression.fast = false\n      end\n\n      notify_by Mail do |mail|\n        mail.on_success           = true\n        mail.on_failure           = true\n\n        mail.from                 = 'xyx@abc.com'\n        mail.to                   = 'sumit.munot@cipher-tech.com'\n        mail.address              = 'mail.abc.com'\n        mail.port                 = 26\n        mail.domain               = 'abc.com'\n        mail.user_name            = 'abc'\n        mail.password             = 'gvgfgxvxv'\n        mail.authentication       = 'login'\n        mail.enable_starttls_auto = false\n      end  \nend\n</code></pre>\n\n<p>I am running the following command in console for taking the backup</p>\n\n<pre><code>backup perform -t my_backup -c /home/xyz/my_workplace/abc/lib/Backup/config.rb \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13103030,"title":"Devise + Omniauth with separate email or username","body":"<p>Using devise and omniauth is there a way to allow users to sign up using an email AND omniauth? I would like to allow the user to enter a separate email (not from the omniauth provider) and then create an account using the omniauth  + the email they provide in the form.</p>\n\n<p>In railscasts, Ryan does something similar with the email field, however in his example you need to click the sign up button after receiving a validation error. This presents two usability errors. Frist, you should not plan on forcing every user to see a validation error when signing up. Second, some users may repeatedly click with \"sign up with [provider]\" button and not realize that they now need to click the normal sign up link.</p>\n\n<p>Does anyone know if we are able to pass information to facebook using omniauth and have it returned to use in the callback?</p>\n\n<p>== update ==\nNow playing around with '/auth/:provider/callback/:email'. It looks like the email params will be passed back with the callback. </p>\n"},{"tags":["sql","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":78,"score":6,"question_id":13096558,"title":"How do I query for an Activity that has 3 tags?","body":"<p>I have the following models:</p>\n\n<p><strong>activity.rb</strong></p>\n\n<p><strong>tag.rb</strong></p>\n\n<p><strong>tagging.rb</strong> </p>\n\n<p>Tagging is a join model for activity and tag.</p>\n\n<p>I would like to search an Activity that has 2 or more tags. How do I do this in rails?</p>\n\n<p>For example:</p>\n\n<p>I have tag1 = Christmas, tag2 = Florida, tag3 = John</p>\n\n<p>I want to find the Activity where tag1, tag2 and tag3 are present if it exists.</p>\n\n<p><strong>[EDIT]</strong></p>\n\n<p>What I ended up doing:</p>\n\n<pre><code>tags = [tag1, tag2, tag3]\n\nactivities = []\ntags.each do |tag|\n  activities &lt;&lt; tag.activities\nend\n\nactivities.flatten.group_by { |activity| activity.id }\n</code></pre>\n\n<p>If any of the groups values' size is equal to tags.size then that activity contains all tags.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1459,"score":5,"question_id":8552763,"title":"Best way to highlight current page in Rails 3? -- apply a css class to links conditionally","body":"<p>For the following code:</p>\n\n<pre><code>&lt;%= link_to \"Some Page\", some_path %&gt;\n</code></pre>\n\n<p><strong>How do I apply a css class <code>current</code> using the <code>current_page?‎</code> helper method?</strong></p>\n\n<p>Or if some other better way is available?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","paperclip","paperclip-validation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13102029,"title":"Paperclip gives error when image is not uploaded","body":"<p>Paperclip works fine when I upload an image and then display it with:</p>\n\n<pre><code>&lt;%= image_tag @post.photo.url(:medium) %&gt;\n</code></pre>\n\n<p>The problem is, if an image wasn't uploaded, I get this error:</p>\n\n<pre><code>NoMethodError in Posts#show\n\nShowing /Users/me/RubymineProjects/level_60/app/views/posts/show.html.erb where line #16 raised:\n\nundefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>I try to check and see if the image exists with <code>&lt;% if @post.photo %&gt;</code> or <code>&lt;% if @post.photo != '' %&gt;</code>.  However, both of those always return true even when there's no image uploaded.</p>\n\n<p>How do I display an image through paperclip only if it exists?</p>\n"},{"tags":["ruby-on-rails-3","devise","mongoid3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":7,"score":-1,"question_id":13102292,"title":"Devise and mongoid - email_changed? not exists","body":"<p>if not defining an email field I get this error, is this normal?\nHow can I fix it the proper way?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","gem"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":313,"score":0,"question_id":10475837,"title":"ruby-debug-base19-0.11.26.gem on WIN x64","body":"<p><strong>Info about my system:</strong></p>\n\n<p><code>ruby -v</code> -> ruby 1.9.3p125 (2012-02-16) [i386-mingw32]</p>\n\n<p><code>gem -v</code> -> 1.8.24</p>\n\n<hr>\n\n<p>when i'm running </p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Fetching source index for http://rubygems.org/\nCould not find ruby-debug-base19-0.11.26 in any of the sources\n</code></pre>\n\n<p>the firewall is OFF</p>\n\n<p>I downloaded this file: ruby-debug-base19-0.11.26.gem</p>\n\n<p>but when i run:</p>\n\n<pre><code>gem install ruby-debug-base19-0.11.26.gem\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>Temporarily enhancing PATH to include DevKit...\nBuilding native extensions.  This could take a while...\nERROR:  Error installing ruby-debug-base19-0.11.26.gem:\n        ERROR: Failed to build gem native extension.\n\n        C:/RailsInstaller/Ruby1.9.3/bin/ruby.exe extconf.rb\nchecking for rb_method_entry_t.called_id in method.h... no\nchecking for rb_control_frame_t.method_id in method.h... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/RailsInstaller/Ruby1.9.3/bin/ruby\n        --with-ruby-dir\n        --without-ruby-dir\n        --with-ruby-include\n        --without-ruby-include=${ruby-dir}/include\n        --with-ruby-lib\n        --without-ruby-lib=${ruby-dir}/lib\nextconf.rb:16:in `block in &lt;main&gt;': break from proc-closure (LocalJumpError)\n        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/ruby_core_sour\nce-0.1.5/lib/ruby_core_source.rb:18:in `call'\n        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/ruby_core_sour\nce-0.1.5/lib/ruby_core_source.rb:18:in `create_makefile_with_core'\n        from extconf.rb:32:in `&lt;main&gt;'\n\n\nGem files will remain installed in C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9\n.1/gems/ruby-debug-base19-0.11.26 for inspection.\nResults logged to C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/ruby-debu\ng-base19-0.11.26/ext/ruby_debug/gem_make.out\n</code></pre>\n\n<p>what's the problem??</p>\n"},{"tags":["ruby-on-rails-3","link-to","link-to-remote"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2565,"score":3,"question_id":5872298,"title":"Rails 3 - How to send data on link_to :remote=>true?","body":"<p>I am trying to figure out the new <code>link_to</code> in <code>Rails 3</code> but i still don't get it\nIn Rails 2 I do:</p>\n\n<pre><code>&lt;%= link_to_remote \"My Link\",:url=&gt;{:action=&gt;:myaction},:with=&gt;\"'data='+$('#someField').attr('value')\" %&gt;\n</code></pre>\n\n<p>but with the new syntax in Rails 3 how should it be?</p>\n\n<p>I'm trying something like</p>\n\n<pre><code>&lt;%=link_to \"My Link\",{:action=&gt;\"myaction\"},:with=&gt;\"'data='+$('#someField').attr('value');\",:remote=&gt;true%&gt;\n</code></pre>\n\n<p>but I'm not getting the quantity params in the controller's action</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","configuration","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13101038,"title":"How to know what config contains in rails","body":"<p>Is there a way to know what is the configuration defined in development.rb and production.rb?</p>\n\n<p>there is a lot of mystery into what is set. </p>\n\n<p>Is there a way to see that?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","carrierwave"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13060784,"title":"How to reference parent model from Carrierwave Uploader object","body":"<p>I want to run some methods after the upload of a file has been completed via Carrierwave. Carrierwave includes several callback methods detailed <a href=\"https://github.com/jnicklas/carrierwave/wiki/How-to%3a-use-callbacks\" rel=\"nofollow\">here</a>. </p>\n\n<p>I'm planning on using the :store callback.</p>\n\n<p>That's great, but it requires me to run the callback method in the Uploader object instance. This isn't the end of the world, but I want to keep all the logic inside of my parent Model. </p>\n\n<p><strong>My question is: How should I be referencing the parent model from the Uploader? I don't see anything obvious in the documentation?</strong></p>\n\n<p>I suppose I could do something like</p>\n\n<pre><code>ParentModel.last.call_my_method_here\n</code></pre>\n\n<p>but this seems like a very brittle way to code this (not expecting a lot of requests, but still). </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13095955,"title":"Carrierwave yml fixture to upload file","body":"<p>I have carrierwave setup. Its working without any issues. Now, below are the deal_images fixtures:</p>\n\n<pre><code>d1_image1:\n  image: app_images/img1.png\n  usage_tag: thumbnail\n  deal: first_deal\nd1_image2:\n  image: app_images/img2.png\n  usage_tag: thumbnail\n  deal: second_deal\n</code></pre>\n\n<p>Now, what it does is just enter string in image and image.url is not pointing anywhere. I want to use image in app_image/img1.png to be uploaded when i run <code>rake db:fixtures:load</code> into uploads directory. </p>\n\n<p>Is this correct way of doing it?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","deployment","capistrano"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":760,"score":0,"question_id":7133555,"title":"Deploying with Capistrano","body":"<p>I am using Ruby on Rails 3.0.9 and I trying to setup the Capistrano gem (following the <em>Agile Web Development with Rails</em> book - Fourth Edition). I setup git and all related directories\\files on the remote machine (it works) and all \"basic\" things related to Capistrano. Now if I run from my local machine the following commands those work as expected:</p>\n\n<pre><code>cap deploy:setup\n# ...\n\ncap deploy:check\n# ...\n# You appear to have all necessary dependencies installed\n</code></pre>\n\n<p>At this time on the server machine in my project directory I have the following directories (created by Capistrano):</p>\n\n<pre><code>&lt;my_project_dir&gt;/releases\n&lt;my_project_dir&gt;/shared\n</code></pre>\n\n<p><em>Nothing more</em>.</p>\n\n<p><strong>What I should do now?</strong> For example, have I to upload all my application file from my local machine to the remote machine?</p>\n\n<p>P.S.: I also setup my Apache2 server to point to the <code>&lt;my_project_dir&gt;/current/public</code> directory but Capistrano didn't create that folder.</p>\n\n<hr>\n\n<p><strong>UPDATE</strong> for <em>@Alex</em></p>\n\n<p>If I run the <code>cap deploy</code> command I get the following:</p>\n\n<pre><code>  * executing `deploy'\n  * executing `deploy:update'\n ** transaction: start\n  * executing `deploy:update_code'\n    updating the cached checkout on all servers\n    executing locally: \"git ls-remote root@&lt;SERVER_IP_ADDRESS&gt;:/git/&lt;my_project_name&gt;.com.git master\"\n    command finished in 3086ms\n  * executing \"if [ -d /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy ]; then cd /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; git fetch -q origin &amp;&amp; git fetch --tags -q origin &amp;&amp; git reset -q --hard 36ccf7b6f63041ee8dcdf4ca0a7c0b10dbc8bad1 &amp;&amp; git clean -q -d -x -f; else git clone -q root@&lt;SERVER_IP_ADDRESS&gt;:/git/&lt;my_project_name&gt;.com.git /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; cd /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; git checkout -q -b deploy 36ccf7b6f63041ee8dcdf4ca0a7c0b10dbc8bad1; fi\"\n    servers: [\"&lt;SERVER_IP_ADDRESS&gt;\"]\n    [&lt;SERVER_IP_ADDRESS&gt;] executing command\n ** [&lt;SERVER_IP_ADDRESS&gt; :: err] Host key verification failed.\n ** [&lt;SERVER_IP_ADDRESS&gt; :: err] fatal: The remote end hung up unexpectedly\n    command finished in 396ms\n*** [deploy:update_code] rolling back\n  * executing \"rm -rf /srv/www/&lt;my_project_name&gt;.com/releases/20110820175634; true\"\n    servers: [\"&lt;SERVER_IP_ADDRESS&gt;\"]\n    [&lt;SERVER_IP_ADDRESS&gt;] executing command\n    command finished in 353ms\nfailed: \"sh -c 'if [ -d /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy ]; then cd /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; git fetch -q origin &amp;&amp; git fetch --tags -q origin &amp;&amp; git reset -q --hard 36ccf7b6f63041ee8dcdf4ca0a7c0b10dbc8bad1 &amp;&amp; git clean -q -d -x -f; else git clone -q root@&lt;SERVER_IP_ADDRESS&gt;:/git/&lt;my_project_name&gt;.com.git /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; cd /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; git checkout -q -b deploy 36ccf7b6f63041ee8dcdf4ca0a7c0b10dbc8bad1; fi'\" on &lt;SERVER_IP_ADDRESS&gt;\n</code></pre>\n\n<p><em>Note</em>: <code>failed: ...</code> on the last line. What is the problem?</p>\n"},{"tags":["ruby-on-rails-3","postgresql","index","group-by"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13099187,"title":"How to know which attributes are used on GROUP_BY in Rails","body":"<p>I am improving the database tables by adding indexes where appropriate.</p>\n\n<p>I'd like to add indexes to attributes that are used on GROUP_BY queries.</p>\n\n<p>Is there a way to automagically know which fields were used by GROUP_BY?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13096536,"title":"Rails path nomenclature not working","body":"<p>I have a Fixer model, but, unlike all the other models in my app, its routing isn't working right, even though there's a resource line for it in the routes file.</p>\n\n<p>The problem is, when I try to link to the basic show path any number of ways, like</p>\n\n<pre><code>&lt;%= link_to \"Fixer\", fixer_path(@fixer) %&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;%= link_to \"Fixer\", @fixer %&gt;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>&lt;%= link_to \"Fixer\", fixer_path(@fixer.id) %&gt; # I got desperate\n</code></pre>\n\n<p>it links to /fixers.[:id] (not a real page) instead of /fixers/[:id]. No idea what's happening, cause my resources line is there, and show is a basic resources action, and all the other similarly resourced models seem to be working just fine.</p>\n\n<p>Any ideas? (I can put more code up if necessary. Just not sure what would be relevant).</p>\n\n<p>EDIT -- The Fixers output in my rake routes:</p>\n\n<pre><code>       fixers GET    /fixers(.:format)           fixers#index\n              POST   /fixers(.:format)           fixers#create\n    new_fixer GET    /fixers/new(.:format)       fixers#new\n   edit_fixer GET    /fixers/:id/edit(.:format)  fixers#edit\n              GET    /fixers/:id(.:format)       fixers#show\n              PUT    /fixers/:id(.:format)       fixers#update\n              DELETE /fixers/:id(.:format)       fixers#destroy\n</code></pre>\n\n<p>Whoa. Just noticed after posting this that the 5th line is missing the \"fixer\" before the show action line that all my other models have. Why would that have happened? How do I fix it?</p>\n\n<p>EDIT -- I figured it out! Really dumb issue. For some reason, back when I was learning how to do all this, I both included a resources line and added this line above it:</p>\n\n<pre><code>match '/fixer', to: 'fixers#new'\n</code></pre>\n\n<p>When I took that line out (cause it was redundant), the problem went away. I guess I was messing with the Rails routing automagic. They really do make those defaults the best option.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13097993,"title":"Rails - Find all projects of a user","body":"<p>I started to learn Rails a few days ago and also have not much experience with Ruby too. The problem with me now is trying to find all the projects of a certain user, given the relationship below.</p>\n\n<p><strong>User Model</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_many :projects_users\n    has_many :projects, :through =&gt; :projects_users\n    attr_accessible :email, :firstname, :id, :lastname, :password, :username, :password\n    has_secure_password\nend\n</code></pre>\n\n<p><strong>Project Model</strong></p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n    has_many :projects_users\n    has_many :users, :through =&gt; :projects_users\n    attr_accessible :date_created, :id, :name\nend\n</code></pre>\n\n<p><strong>Project_User Model</strong></p>\n\n<pre><code>class ProjectsUsers &lt; ActiveRecord::Base\n    belongs_to :project\n    belongs_to :user\nend\n</code></pre>\n\n<p>My attempt so far is:</p>\n\n<pre><code>@projectuserid = ProjectsUsers.find(:all, :conditions =&gt; \"user_id=#{session[:user_id]}\")\n@projects = Project.all(@projectuserid)\n</code></pre>\n\n<p>But it seems like <code>@projectuserid</code> is an array itself so the query doesn't work. I know it could be achieved in one line of code for this HABTM relationship model, but still I have so little knowledge about Rails.</p>\n\n<p>Another approach of mine looks like this, but a blank result returned:</p>\n\n<pre><code>@projects = Project.find :all,\n         :conditions =&gt; \"id in (select distinct project_id from projects_users where user_id=#{session[:user_id]})\"\n</code></pre>\n"},{"tags":["ruby-on-rails-3","sunspot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":147,"score":1,"question_id":10579744,"title":"Failure starting sunspot solr server","body":"<p>I have a problem with starting the sunspot server. last week it worked like a charm but now i get an error when i run rake sunspot:solr:run </p>\n\n<p>my output using --trace</p>\n\n<pre><code>C:\\contractbeheersysteem2&gt;rake sunspot:solr:run --trace\n** Invoke sunspot:solr:run (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Execute sunspot:solr:run\njava version \"1.7.0_04\"\nJava(TM) SE Runtime Environment (build 1.7.0_04-b22)\nJava HotSpot(TM) Client VM (build 23.0-b21, mixed mode, sharing)\n2012-05-14 10:10:28.077::INFO:  Logging to STDERR via org.mortbay.log.StdErrLog\n2012-05-14 10:10:28.374::INFO:  jetty-6.1.3\n2012-05-14 10:10:28.670::INFO:  Extract jar:file:/H:/RailsInstaller/Ruby1.9.3/li\nb/ruby/gems/1.9.1/gems/sunspot_solr-1.3.1/solr/webapps/solr.war!/ to C:\\DOCUME~1\n\\ksonnema\\LOCALS~1\\Temp\\Jetty_0_0_0_0_8982_solr.war__solr__-2c5peu\\webapp\n[Fatal Error] :107:17: Open quote is expected for attribute \"{1}\" associated wit\nh an  element type  \"name\".\n2012-05-14 10:10:31.577::INFO:  Started SocketConnector @ 0.0.0.0:8982\n</code></pre>\n\n<p>hope someone knows what the problem.</p>\n"},{"tags":["ruby-on-rails-3","custom-data-attribute"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13097447,"title":"how to use data-attribute in rails3?","body":"<p>I have a html select syntax like :</p>\n\n<pre><code>&lt;select id=\"salary_structure_salary_structure_line_items_attributes_0_payhead_id\" class=\"half\" name=\"salary_structure[salary_structure_line_items_attributes][0][payhead_id]\"&gt;\n&lt;option data-payhead=\"Earnings\" value=\"2\"&gt; Basic &lt;/option&gt;\n&lt;option data-payhead=\"Earnings\" value=\"3\"&gt; Daily allowance &lt;/option&gt;\n&lt;option data-payhead=\"Standard deductions\" value=\"4\"&gt; Employee provident fund &lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>How do i get this work in rails syntax? what change should i do in below code to get the above result:</p>\n\n<pre><code>&lt;%= select_tag \"salary_structure[salary_structure_line_items_attributes][#{index}][payhead_id]\", options_from_collection_for_select(@payheads, :id, :payhead_name, :selected =&gt; salary_structure_line_item.payhead_id ), :include_blank =&gt; true, :class =&gt; \"half\"%&gt; \n</code></pre>\n\n<p>also i want to use 'selected' option in this code.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12965132,"title":"Rails Asset Pipeline Path Issue","body":"<p>I have a Rails app running on a shared web host under a folder in my root direction called 'mintrus-ror/'. There is a symbolic link 'public_html/' that points to 'mintrus-ror/public/'. My Rails app loads in the browser but the stylesheets don't load. Looking at the rendered source I noticed the assets path it is using is '/mintrus-ror/assets/application.css'. I am trying to figure out how to change it so it does not include the 'mintrus-ror/' directory in the assets path. Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","variables","metaprogramming"],"answer_count":4,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":515,"score":0,"question_id":7079222,"title":"How to set \"dynamically\" variable values?","body":"<p>I am using Ruby on Rails 3.0.9 and I am trying to set \"dynamically\" some variable values. That is...</p>\n\n<p>... in my model file I have:</p>\n\n<pre><code>attr_accessor :variable1, :variable2, :variable3\n\n\n# The 'attributes' argument contains one or more symbols which name is equal to \n# one or more of the 'attr_accessor' symbols.\n\ndef set_variables(*attributes)\n\n  # Here I should set to 'true' all \":variable&lt;N&gt;\" attributes passed as symbol\n  # in the 'attributes' array, but variable names should be interpolated in a \n  # string.\n  # \n  # For example, I should set something like \"prefix_#{':variable1'.to_s}_suffix\".\n\nend\n</code></pre>\n\n<p><strong>How can I set those variable values to <code>true</code>?</strong></p>\n\n<hr>\n\n<p>I tried to use the <code>self.send(...)</code> method, but I did not succeed (but, probably, I don't know how to use at all that <code>send</code> method... is it possible do to that I need by using the <code>send</code> method?!).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","respond-to"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2611,"score":1,"question_id":5415487,"title":"AbstractController::DoubleRenderError that shouldn't be","body":"<p>I've been getting the following error when I hit this destroy method in a my User controller.</p>\n\n<pre><code>AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like \"redirect_to(...) and return\".):\n</code></pre>\n\n<p>It's a strange one, because I honestly am only responding once to the call.</p>\n\n<p>Here's my action: </p>\n\n<pre><code>def destroy\n  user = User.find(params[:id])\n  if user.has_role_for? current_client\n\n    # then we remove the role\n    user.has_no_roles_for! current_client\n\n    # was that the users only role?\n    if user.roles.count == 0\n      user.destroy\n    end\n\n    respond_with head :ok\n  else\n    respond_with({:error=&gt;'unauthorised'}, :status =&gt; :forbidden)\n  end\nend\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","testing"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":398,"score":5,"question_id":7633839,"title":"Turn on full backtrace in Ruby on Rails TestCase","body":"<p>Only one line of backtrace is displayed when I run:</p>\n\n<pre><code>rake test\n</code></pre>\n\n<p>Output:</p>\n\n<p>...</p>\n\n<pre><code>ERROR should get search for keywords (1.93s) \n  NoMethodError: undefined method `features' for #&lt;Transcript:0x00000006243780&gt;\n  /usr/lib/ruby/gems/1.9.1/gems/activemodel-3.1.0/lib/active_model/attribute_methods.rb:385:in `method_missing'\n</code></pre>\n\n<p>...</p>\n\n<p>I need more lines of backtrack information.\nI have tried</p>\n\n<ul>\n<li><p>rake test --trace</p></li>\n<li><p><code>Rails.backtrace_cleaner.remove_silencers!</code> in config/initializers/backtrace_silencers.rb</p></li>\n<li><p>setting global $DEBUG=true</p></li>\n</ul>\n\n<p>and it didn't work.</p>\n\n<p>How can I turn it on?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","methods","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13096217,"title":"Representing methods in have_* options in rspec","body":"<p>I created a method within an rb file in my spec folder. I want to use the method in checking if one of my elements has the returned value of the method as it's text. My question is, how would I write the method <code>name</code> into the have_selector text option?</p>\n\n<p>My rspec file</p>\n\n<pre><code>def name\n  user = User.first\n  return user.name\nend\n\ndescribe \"test\" do\n\n  it \"has the name in the file\"\n    visit users_path\n    page.should have_selector('td', text: name)\n    # I need name in the text options to represent the method name created\n  end\n\nend\n</code></pre>\n\n<p>When I run rspec, it tells me that</p>\n\n<pre><code>NoMethodError: private method 'name' called for nil:NilClass\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13077902,"title":"has_and_belongs_to_many associations in factory_girl 4.1","body":"<p>I'm new to factory_girl and trying to figure out how to effectively generate a factory for the following models:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n    has_and_belongs_to_many :tags\nend\n\nclass Tags &lt; ActiveRecord::Base\n    has_and_belongs_to_many :companies\n\n    validates :type , :inclusion =&gt; { :in =&gt; %w(market location) } \nend\n</code></pre>\n\n<p>I've taken a look at previous answers on StackOverflow (including <a href=\"http://stackoverflow.com/questions/1484374/how-to-create-has-and-belongs-to-many-associations-in-factory-girl\">this one</a>), however most of them are outdated and/or don't have a proper answer to the question.  Is there anybody out there that can help define factories for these two objects with Factorygirl?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here's what I've come up wtih so far</p>\n\n<pre><code>FactoryGirl.define do\nfactory :tag do\n    id  448\n        trait :market do\n        type \"market\"\n    end\n    trait :location do\n        type \"location\"\n    end\n    name \"software\"\nend\n\nfactory :company do\n    id  1234\n    name \"Apple Inc.\"\n    factory :company_with_tags do\n        #setting the default # of tags for companies\n        ignore do\n            tag_count   2\n        end\n\n            after(:create) do |company , evaluator|\n                FactoryGirl.create_list(:tag , evaluator.tag_count , company: company)\n            end \n    end\nend\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","heroku","redis","asset-pipeline"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13096531,"title":"Deploying redis on Heroku when manually precompiling assets","body":"<p>I'm following the instructions here: <a href=\"https://devcenter.heroku.com/articles/redistogo\" rel=\"nofollow\">https://devcenter.heroku.com/articles/redistogo</a> to deploy redis on Heroku. I'm however running into some issues while manually precompiling my assets on localhost using:</p>\n\n<pre><code>RAILS_ENV=production bundle exec rake assets:precompile\n</code></pre>\n\n<p>before pushing it out to heroku. The ENV[\"REDISTOGO_URL\"] config variable isn't set when I'm doing the production mode precompile on localhost so I get an URI error when URI.parse is called. </p>\n\n<p>How do I get around this error? I don't want to hardcode the URI in my production.rb since Heroku sets this when starting the redis server. I'm quite new to this whole asset pipeline / deployment processes so any tip would be appreciated. </p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","redirect"],"answer_count":4,"favorite_count":8,"up_vote_count":10,"down_vote_count":0,"view_count":5067,"score":10,"question_id":5454806,"title":"Rails 3: How to \"redirect_to\" in Ajax call?","body":"<p>The following <code>attempt_login</code> method is called using Ajax after a login form is submitted.</p>\n\n<pre><code>class AccessController &lt; ApplicationController\n  [...]\n  def attempt_login\n    authorized_user = User.authenticate(params[:username], params[:password])\n\n    if authorized_user\n      session[:user_id] = authorized_user.id\n      session[:username] = authorized_user.username\n      flash[:notice] = \"Hello #{authorized_user.name}.\"\n      redirect_to(:controller =&gt; 'jobs', :action =&gt; 'index')\n    else\n      [...]\n    end\n  end\nend\n</code></pre>\n\n<p>The problem is that <code>redirect_to</code> doesn't work.</p>\n\n<p>How would you solve this ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","model","routing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13096229,"title":"Rails Routes with multiple model ids","body":"<p>I've got an app with an Item model and a Fixer model. Each Item belongs to a Fixer, and Fixers can have many items. I want to create a \"log\" page where a particular fixer can update information on a particular Item associated with them. Ideally something like this</p>\n\n<pre><code>www.myappname.com/fixers/&lt;fixer_id&gt;/log/&lt;item_id&gt;\n</code></pre>\n\n<p>I'm fairly new to Rails, so I'm not really sure how to figure out the routing/controller for this one. I looked in the Rails Guide section on routing, and the only thing that looked similar to what I want is Nested Models, but I ideally don't want to nest the models, because while items may technically \"belong_to\" fixers, that's not really the case in the real world (fixers are just associated, and belong_to was the most sensible way), and there's no other part of the relationship that requires/makes sense with nesting. More importantly, I don't really get what nesting the models means or does, and I try to avoid implementing solutions that I don't fully understand. </p>\n\n<p>If nesting's the way to go, let me know, but otherwise, how might I go about routing this? I've tried this in my routes.rb file:</p>\n\n<pre><code>match 'fixers/:id/log/:id' =&gt; 'fixers#log'\n</code></pre>\n\n<p>and created log.html.erb, but I don't know how I'd select the params of that in a controller (how does it know which \":id\" I'm selecting for? Is there a better way to do this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","twitter-bootstrap-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":13096038,"title":"SyntaxError in rails app controller","body":"<p>I used the twitter bootstrap library for my new simple rails app\nand used some scaffold for products model\ni updated the GemFile as well as the bundle command and the rails g bootstrap.\nwhen i run the web page i get the following error:</p>\n\n<pre><code>SyntaxError in ProductsController#index\n\n/Library/Ruby/Gems/1.8/gems/twitter-bootstrap-rails-2.1.4/app/helpers/glyph_helper.rb:9: syntax error, unexpected ':'\n...   content_tag :i, nil, class: names.map{|name| \"icon-#{name...\n</code></pre>\n\n<p>I don't know why this happened!</p>\n\n<p>Here is my GemFile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.7'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\ngem 'sqlite3'\n\ngem 'json'\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\n  gem 'twitter-bootstrap-rails'\nend\n\ngem 'jquery-rails'\n</code></pre>\n\n<p>controller code:</p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n  # GET /products\n  # GET /products.json\n  def index\n    @products = Product.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render :json =&gt; @products }\n    end\n  end\n\n  # GET /products/1\n  # GET /products/1.json\n  def show\n    @product = Product.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render :json =&gt; @product }\n    end\n  end\n\n  # GET /products/new\n  # GET /products/new.json\n  def new\n    @product = Product.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render :json =&gt; @product }\n    end\n  end\n\n  # GET /products/1/edit\n  def edit\n    @product = Product.find(params[:id])\n  end\n\n  # POST /products\n  # POST /products.json\n  def create\n    @product = Product.new(params[:product])\n\n    respond_to do |format|\n      if @product.save\n        format.html { redirect_to @product, :notice =&gt; 'Product was successfully created.' }  \n        format.json { render :json =&gt; @product, :status =&gt; :created, :location =&gt; @product }\n      else\n        format.html { render :action =&gt; \"new\" }\n        format.json { render :json =&gt; @product.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /products/1\n  # PUT /products/1.json\n  def update\n    @product = Product.find(params[:id])\n\n    respond_to do |format|\n      if @product.update_attributes(params[:product])\n        format.html { redirect_to @product, :notice =&gt; 'Product was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render :action =&gt; \"edit\" }\n        format.json { render :json =&gt; @product.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /products/1\n  # DELETE /products/1.json\n  def destroy\n    @product = Product.find(params[:id])\n    @product.destroy\n\n    respond_to do |format|\n      format.html { redirect_to products_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","date","random"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":2385,"score":5,"question_id":4894198,"title":"How to generate a random date in Ruby?","body":"<p>I have a model in my Rails 3 application which has a <code>date</code> field:</p>\n\n<pre><code>class CreateJobs &lt; ActiveRecord::Migration\n  def self.up\n    create_table :jobs do |t|\n      t.date \"job_date\", :null =&gt; false\n      ...\n      t.timestamps\n    end\n  end\n  ...\nend\n</code></pre>\n\n<p>I would like to prepopulate my database with random date values.</p>\n\n<p>What is the easiest way to generate a random date ?</p>\n"},{"tags":["jquery","ruby-on-rails-3","prototypejs","noconflict"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":137,"score":0,"question_id":8026425,"title":"Jquery with other libraries","body":"<p>I am getting an error message as  <code>element.dispatchEvent</code> is not a function. I am using jquery with prototyp in rails 3 application. In my layout file, i have added the js files as below</p>\n\n<pre><code> javascript_include_tag 'jquery','jquery_ujs','prototype','shadowbox/shadowbox.js' \n&lt;script type=\"text/javascript\"&gt;jQuery.noConflict();&lt;/script&gt;\n</code></pre>\n\n<p>I have also added <code>jQuery.noConflict</code> as above and used <code>jQuery</code> instead of <code>$</code> in jquery fuctions. Any idea how to resolve this.?</p>\n\n<p>In my another controller page action i have also mentioned the same thing as there are some js files which needs to be reloaded only for that particalar page. </p>\n\n<p>I am a newbie in js as well as rails also.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":187,"score":0,"question_id":10557309,"title":"Updating user profile without having to enter the password and confirmation each time","body":"<p>I'm trying to create a new page called edit_profile for my User model so that the user can edit his profile(string). I'm following <a href=\"http://railscasts.com/episodes/41-conditional-validations\" rel=\"nofollow\">http://railscasts.com/episodes/41-conditional-validations</a></p>\n\n<p>Here is the form (edit_profile.html.erb):</p>\n\n<pre><code>  &lt;%= form_for @user, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :profile %&gt;&lt;br/&gt;\n    &lt;%= f.text_area :profile, :class =&gt; \"round\" %&gt;&lt;br /&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= submit_tag \"update\", :id =&gt; \"updateSubmit\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem I'm having is that I have validation for the presence of password and password confirmation. When I load my edit_profile view, I keep getting this message <code>Password is too short (minimum is 6 characters)</code> even before I try to submit a new profile.</p>\n\n<p>Here is my users_controller.rb:</p>\n\n<pre><code>def edit_profile\n  @user = current_user\n  @user.updating_password = false\n  @user.save\n  @title = \"Edit profile\"\nend\n\ndef update\n  @user = User.find(params[:id])\n  if @user.update_attributes(params[:user])\n    flash[:success] = \"Account updated.\"\n    redirect_to @user\n  else\n    @title = \"Edit user\"\n    render 'edit'\n  end\nend\n</code></pre>\n\n<p><strong>How do I bypass my password validation when I just want to edit my profile attribute in the user model?</strong></p>\n\n<p>Thanks!</p>\n\n<p>Other relevant information:</p>\n\n<p>user.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    attr_accessor :password, :updating_password\n    attr_accessible :name, :email, :password, :password_confirmation, :photo, \n                    :profile\n    before_save :downcase_fields\n    before_save :encrypt_password\n    validates_presence_of :password, :if =&gt; :should_validate_password?\n    validates_confirmation_of :password, :if =&gt; :should_validate_password?      \n    def should_validate_password?\n      updating_password || new_record?\n    end\n\n    validates :name, :presence =&gt; true,\n              :name_format =&gt; true,  \n              :uniqueness =&gt; { :case_sensitive =&gt; false }          \n    validates :email, :presence =&gt; true, \n              :email_format =&gt; true,\n              :uniqueness =&gt; { :case_sensitive =&gt; false }\n    validates :password, \n               #:presence =&gt; true,\n              #:confirmation =&gt; true,\n              :length =&gt; { :within =&gt; 6..40 }\n    validates :profile,  :length =&gt; { :maximum =&gt; 160 }\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","has-many-through","simple-form"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":139,"score":3,"question_id":12832546,"title":"Simple_Form Association with has_many :through extra field","body":"<p>I have two models, Developers and Tasks,</p>\n\n<pre><code>class Developer &lt; ActiveRecord::Base\n  attr_accessible :address, :comment, :email, :name, :nit, :phone, :web\n  has_many :assignments\n  has_many :tasks, :through =&gt; :assignments\nend\n\nclass Task &lt; ActiveRecord::Base\n  attr_accessible :description, :name, :sprint_id, :developer_ids\n  has_many :assignments\n  has_many :developers, :through =&gt; :assignments\nend\n\nclass Assignment &lt; ActiveRecord::Base\n  attr_accessible :accomplished_time, :developer_id, :estimated_time, :status, :task_id\n  belongs_to :task\n  belongs_to :developer\nend\n</code></pre>\n\n<p>im taking care of the relation by adding an Assignment table, so i can add many developers to one task in particular, now i would also like to be able to manipulate the other fields i added to the joining table like the 'estimated_time', 'accomplished_time'... etc... what i got on my Simple_form is\n`</p>\n\n<pre><code>&lt;%= simple_form_for [@sprint,@task], :html =&gt; { :class =&gt; 'form-horizontal' } do |f| %&gt;\n  &lt;%= f.input :name %&gt;\n  &lt;%= f.input :description %&gt;\n  &lt;%= f.association :developers, :as =&gt; :check_boxes %&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n    &lt;%= f.button :submit, :class =&gt; 'btn-primary' %&gt;\n    &lt;%= link_to t('.cancel', :default =&gt; t(\"helpers.links.cancel\")),\n                project_sprint_path(@sprint.project_id,@sprint), :class =&gt; 'btn' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;`\n</code></pre>\n\n<p>This only allows me to select the developers, i want to be able to modify the estimated_time field right there.</p>\n\n<p>Any Suggestions?</p>\n"},{"tags":["osx","ruby-on-rails-3","imagemagick","rmagick"],"answer_count":1,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":2700,"score":5,"question_id":4290759,"title":"Error installing Rmagick on Mac OS X","body":"<p>I followed the installation of <strong><em>RMagick</em></strong> for <strong><em>OSX:</em></strong>\n<a href=\"http://rmagick.rubyforge.org/install-faq.html#osx\">http://rmagick.rubyforge.org/install-faq.html#osx</a></p>\n\n<p>I have done the <strong><em>Imagemagick</em></strong> installation from <strong><em>John Maddux</em></strong> (solution to install <em>ImageMagick</em> on OSX without using <em>MacPorts</em>)</p>\n\n<p>Here's my terminal window:</p>\n\n<pre><code>Suebphatt:~ suebphattleelertphong$ ruby -v\nruby 1.8.7 (2009-06-12 patchlevel 174) [universal-darwin10.0]\n\nSuebphatt:~ suebphattleelertphong$ rails -v\nRails 3.0.3\n\nSuebphatt:~ suebphattleelertphong$ gem -v\n1.3.7\n\nSuebphatt:~ suebphattleelertphong$ gem install rmagick\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rmagick:\nERROR: Failed to build gem native extension.\n\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n\n\nGem files will remain installed in /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1 for     inspection.\nResults logged to /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\nSuebphatt:~ suebphattleelertphong$ \n</code></pre>\n\n<p>Thanks a lot for help,\nSuebphatt</p>\n"},{"tags":["javascript","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13095167,"title":"Trigger the controller to display view","body":"<p>I have a dropdown in view that is using js I pass the selected item from dropdown to controller, inside the controller I ran a query using the selected item from dropdown to extract some records. Now the problem is that I cannot display the query result to view. Basically I cannot trigger the controller to display in view.  Any help greatly appreciated.</p>\n\n<p>Here is the js to pass the data to controller:</p>\n\n<pre><code>&lt;script type=\"text/JavaScript\"&gt;\n$(function(){\n    $('.defined_call').bind('change', function(){\n        alert($(this).val());\n        $.ajax({\n            url: \"&lt;%= changeowner_path %&gt;\",\n            data: { my_str: $(this).val() }\n        });\n    });\n});\n&lt;/script&gt;\n\n&lt;%= select_tag \"dropdown_cases\", options_for_select(@ownerlist),{:id=&gt;\"defined_Id\",:class \n=&gt; \"defined_call'}  %&gt;\n</code></pre>\n\n<p>Here is the controller:</p>\n\n<pre><code>class ReassignsController &lt; ApplicationController\n  def changeowner\n    i=0\n    $myarr=[]\n    ownerl = Transaction.owner#declaredin model\n    @ownerlist=ownerl.collect { |c| [ c, c ] }#make it for dropdown\n    value=params[:my_str]#return value from dropdown\n    $value1=value.to_s#make it for owner table\n    @owner_records=Transaction.where(:owner =&gt; $value1) \n\n    ===&gt; I would like to display to the view?\n  end\nend\n</code></pre>\n\n<p>Here is the view that I am using:</p>\n\n<pre><code>&lt;table class=\"table table-condensed\" id=\"sortTableExample\"&gt;\n&lt;tr&gt;\n&lt;th style=\"text-align:center\"&gt;Book Name&lt;/th&gt;\n&lt;th style=\"text-align:center\"&gt;Owner&lt;/th&gt;\n\n&lt;/tr&gt;\n\n&lt;% @owner_records.each do |arr_data| %&gt;\n&lt;tr&gt;\n&lt;td style=\"text-align:center\"&gt;&lt;%= arr_data.book%&gt;&lt;/td&gt;\n&lt;td style=\"text-align:center\"&gt;&lt;%= arr_data.owner%&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms","cocoon"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":543,"score":1,"question_id":7538518,"title":"Rails 3.1. Cocoon link_to_add_association example needed","body":"<p>pls show any example of using Cocoon's 'link_to_add_association' with html_options.\n<a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow\">https://github.com/nathanvda/cocoon</a></p>\n\n<p>Documentation says:</p>\n\n<pre><code>html_options: extra html-options (see link_to) There are two extra options that allow to conrol the placement of the new link-data:\n\n    data-association-insertion-node : the jquery selector of the node\n    data-association-insertion-position : insert the new data before or after the given node.\n</code></pre>\n\n<p>But i can not understand what to do, if i want insert partial just before my \"add element\" link. Not just after parent's div begin. This not gonna work:</p>\n\n<blockquote>\n  <p>&lt;%= link_to_add_association \"add element\", f, :production_years,\n  :position => \"after_all\" %></p>\n</blockquote>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13094855,"title":"Michael Hartl Rails Tutorial - Listing 11.36 (AJAX Unfollow) Error","body":"<p>In <a href=\"http://ruby.railstutorial.org/chapters/following-users#sec-a_working_follow_button_with_ajax\" rel=\"nofollow\">listing 11.36</a> of Michael Hartl's superb tutorial, changes the unfollow form to use AJAX, but I keep getting the following error when I click on the \"Unfollow\" button:</p>\n\n<pre><code>ActionView::Template::Error (undefined method `model_name' for NilClass:Class):\n</code></pre>\n\n<p>The form, however, does work. If I click \"Unfollow\" I unfollow the currently displayed user. So it seems that @user in the form declaration is valid when the form is submitted:</p>\n\n<pre><code>&lt;%= form_for(current_user.relationships.find_by_followed_id(@user),\n         html: { method: :delete },\n         remote: true) do |f| %&gt;\n</code></pre>\n\n<p>but perhaps it's no longer available when the \"Follow\" form tries to load?</p>\n\n<p>I've tried at length to track this down but I can't figure it out, and I haven't seen anyone else post the same issue.</p>\n\n<p>Any clues?</p>\n\n<p>Thanks.</p>\n"},{"tags":["jquery","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13094867,"title":"Adding 3rd party jQuery code to our Rails RTF text box","body":"<p>I am adding a 3rd party feature into an existing rails app. The 3rd party gave me a piece of code which I am supposed to drop into my codebase but I'm confused as to where this should be posted. </p>\n\n<p>Posted is the 3rd party which I am supposed to add to my codebase:</p>\n\n<pre><code>&lt;script src=\"http://serviceweareusing.com/js/version-latest?cid=ourcompany\"&gt;&lt;/script&gt;\n&lt;script&gt;\n$(\"#textbox\").featureBox('init',{rte:true,userid:'&lt;ENTER CURRENT USERNAME&gt;'});\n&lt;/script&gt;\n</code></pre>\n\n<p>Posted is the existing code in my app for the form.</p>\n\n<p><strong>_post_form.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"create-post-row\"&gt;\n    &lt;label&gt;Body&lt;/label&gt;                     \n    &lt;textarea id=\"textbox\"&gt;\n        &lt;%= @post.body %&gt;\n    &lt;/textarea&gt;\n    &lt;%= form.hidden_field :body, :id =&gt; 'body_hidden_input' %&gt;\n    &lt;%= errors_for_field :body %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Where should this be posted? Does it go in a separate .js file or can I paste it right into the embedded ruby? Any insight would be great. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1031,"score":1,"question_id":6596529,"title":"Ruby on Rails: How to sort a collection_select","body":"<p>I want to sort / order it (desc or asc how i want it) by the database table column \"plays\"\nIm totally confused. Just found a solution for select but not collection_select?</p>\n\n<p>some code of my view</p>\n\n<pre><code>&lt;%= f.collection_select :player1, Player.all, :id, :name %&gt;\n</code></pre>\n\n<p>dont know how to sort / order</p>\n\n<p>there are also columns in the database table like \"plays\", \"goals\" ...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","haml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12505014,"title":"collection_select does not display dropdown, does any errors","body":"<p>Consider these simple, Reminder &amp; event models:</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  has_many :reminders\nend\n\n\nclass Reminder &lt; ActiveRecord::Base\n  belongs_to :event\n  accepts_nested_attributes_for :event\nend\n</code></pre>\n\n<p>now, I have build <code>reminders/new.html.haml</code> view in following way:</p>\n\n<pre><code>%h2 Reminders\n= form_for(@reminder, html: {class: \"form-horizontal\"}) do |f|\n  = f.fields_for :event do |event|\n    = event.collection_select :id, Event.all, :id, :name\n  = f.text_field(:issue_date, class: \"datepicker\", data: {\"date-format\" =&gt;\"dd/mm/yyyy\"}, 'date' =&gt; \"#{Time.new.strftime(\"%d/%m/%Y\")}\")\n  = f.text_field(:renewal_date, label:\"Due Date\", class: \"datepicker\", data: {'date-format' =&gt; 'dd/mm/yyyy', 'date' =&gt; \"#{Time.new.strftime(\"%d/%m/%Y\")}\"})\n  = f.submit\n</code></pre>\n\n<p>This view doesn't throw any errors &amp; reminders minus the <code>&lt;options&gt;</code> tag. \n<img src=\"http://screencloud.net/img/screenshots/f990e124f356330a10839b00cd92f75a.png\" alt=\"View\" title=\"View\"></p>\n\n<p>What I want to do is to display <code>Event.name</code> in the <code>&lt;options&gt;</code>. So what am I missing here?</p>\n\n<p>[Update]\nChanged to <code>form_for</code> &amp; it generates following html markup</p>\n\n<pre><code>&lt;form method=\"post\" id=\"new_reminder\" class=\"form-horizontal\" action=\"/reminders\" accept-charset=\"UTF-8\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input type=\"hidden\" value=\"✓\" name=\"utf8\"&gt;&lt;input type=\"hidden\" value=\"Yu7Qj4SW+GAMXx9dEL/ohjsqryEkxUXXGy+SHpN97hc=\" name=\"authenticity_token\"&gt;&lt;/div&gt;\n\n                &lt;input type=\"text\" size=\"30\" name=\"reminder[issue_date]\" id=\"reminder_issue_date\" date=\"20/09/2012\" data-date-format=\"dd/mm/yyyy\" class=\"datepicker\"&gt;\n                &lt;input type=\"text\" size=\"30\" name=\"reminder[renewal_date]\" label=\"Due Date\" id=\"reminder_renewal_date\" data-date=\"20/09/2012\" data-date-format=\"dd/mm/yyyy\" class=\"datepicker\"&gt;\n                &lt;input type=\"submit\" value=\"Create Reminder\" name=\"commit\"&gt;\n              &lt;/form&gt;\n</code></pre>\n\n<p>as you may notice <code>&lt;option&gt;</code> tag is missing for some reason. </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13090165,"title":"link_to redirect to a wrong controller","body":"<p>I have a layout for my admin area called 'layout_admin' . In 'layout_admin', I have :</p>\n\n<pre><code>&lt;li&gt;&lt;%= link_to 'Contenu', :action=&gt;'index', :controller=&gt;'contents' %&gt;&lt;/li&gt;\n&lt;li&gt;&lt;%= link_to 'Petitions', :controller =&gt; 'petitions', :action =&gt; 'index' %&gt;&lt;/li&gt;\n</code></pre>\n\n<p>The first link for Contenu works fine, but the second one (for petitions) drives me to a strange error :</p>\n\n<blockquote>\n  <p>Routing Error \n  No route matches {:controller=>\"admin/<strong>edito</strong>\"}</p>\n</blockquote>\n\n<p>In the address bar I have : localhost:3000/admin/petitions</p>\n\n<p>In routes.rb  I have :</p>\n\n<pre><code>namespace :admin do resources :petitions \nend\n</code></pre>\n\n<p>I must also precise that \"edito\" is another controller outside the admin area which has one action \"index\". In routes.rb I have <code>get \"edito/index\"</code> concerning edito_controller.</p>\n\n<p>Does somebody have an idea of the source of the problem ?\nThansk.</p>\n\n<p>Full Rake routes :</p>\n\n<pre><code>        temoignages GET    /temoignages(.:format)              temoignages#index\n\n                POST   /temoignages(.:format)              temoignages#create\n new_temoignage GET    /temoignages/new(.:format)          temoignages#new\nedit_temoignage GET    /temoignages/:id/edit(.:format)     temoignages#edit\n     temoignage GET    /temoignages/:id(.:format)          temoignages#show\n                PUT    /temoignages/:id(.:format)          temoignages#update\n                DELETE /temoignages/:id(.:format)          temoignages#destroy\nadmin_petitions GET    /admin/petitions(.:format)          admin/petitions#index\n                POST   /admin/petitions(.:format)          admin/petitions#create\nnew_admin_petition GET    /admin/petitions/new(.:format)      admin/petitions#new\nedit_admin_petition GET    /admin/petitions/:id/edit(.:format) admin/petitions#edit\n admin_petition GET    /admin/petitions/:id(.:format)      admin/petitions#show\n                PUT    /admin/petitions/:id(.:format)      admin/petitions#update\n                DELETE /admin/petitions/:id(.:format)      admin/petitions#destroy\n admin_contents GET    /admin/contents(.:format)           admin/contents#index\n                POST   /admin/contents(.:format)           admin/contents#create\nnew_admin_content GET    /admin/contents/new(.:format)       admin/contents#new\nedit_admin_content GET    /admin/contents/:id/edit(.:format)  admin/contents#edit\n  admin_content GET    /admin/contents/:id(.:format)       admin/contents#show\n                PUT    /admin/contents/:id(.:format)       admin/contents#update\n                DELETE /admin/contents/:id(.:format)       admin/contents#destroy\n    admin_posts GET    /admin/posts(.:format)              admin/posts#index\n\n                POST   /admin/posts(.:format)              admin/posts#create\n  new_admin_post GET    /admin/posts/new(.:format)          admin/posts#new\n  edit_admin_post GET    /admin/posts/:id/edit(.:format)     admin/posts#edit\n     admin_post GET    /admin/posts/:id(.:format)          admin/posts#show\n                PUT    /admin/posts/:id(.:format)          admin/posts#update\n                DELETE /admin/posts/:id(.:format)          admin/posts#destroy\n                GET    /admin/posts(.:format)              admin/posts#index\n\n                POST   /admin/posts(.:format)              admin/posts#create\n                GET    /admin/posts/new(.:format)          admin/posts#new\n                GET    /admin/posts/:id/edit(.:format)     admin/posts#edit\n                GET    /admin/posts/:id(.:format)          admin/posts#show\n                PUT    /admin/posts/:id(.:format)          admin/posts#update\n                DELETE /admin/posts/:id(.:format)          admin/posts#destroy\n  admin_backend_index GET    /admin/backend(.:format)            admin/backend#index\n                POST   /admin/backend(.:format)            admin/backend#create\n  new_admin_backend GET    /admin/backend/new(.:format)        admin/backend#new\n\n  edit_admin_backend GET    /admin/backend/:id/edit(.:format)   admin/backend#edit\n  admin_backend GET    /admin/backend/:id(.:format)        admin/backend#show\n                PUT    /admin/backend/:id(.:format)        admin/backend#update\n                DELETE /admin/backend/:id(.:format)        admin/backend#destroy\n     lois_index GET    /lois/index(.:format)               lois#index\n      lois_show GET    /lois/show(.:format)                lois#show\n    edito_index GET    /edito/index(.:format)              edito#index\n  reponses_index GET    /reponses/index(.:format)           reponses#index\n  reponses_show GET    /reponses/show(.:format)            reponses#show\n  lettres_index GET    /lettres/index(.:format)            lettres#index\n   lettres_show GET    /lettres/show(.:format)             lettres#show\n       accueils POST   /accueils(.:format)                 accueils#create\n   new_accueils GET    /accueils/new(.:format)             accueils#new\n  edit_accueils GET    /accueils/edit(.:format)            accueils#edit\n                GET    /accueils(.:format)                 accueils#show\n                PUT    /accueils(.:format)                 accueils#update\n                DELETE /accueils(.:format)                 accueils#destroy\n           root        /                                   accueil#index\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3","coffeescript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":41,"score":-2,"question_id":13088825,"title":"RAILS3 // JS executes; COFFEE does not","body":"<p>Pleased to get started with coffescript in some rails app.\nBut, after some projects, some difficulties.</p>\n\n<p>The code below translates well, but the coffee one does not do anything</p>\n\n<p>JS :</p>\n\n<pre><code>(function(){\n  var wf = document.createElement('script');\n  wf.src = \"/assets/libraries/webfonts.js\";\n  wf.type = 'text/javascript';\n  wf.async = 'true';\n  var s = document.getElementsByTagName('script')[0];\n  s.parentNode.insertBefore(wf, s);\n})();\nWebFontConfig = {\n  custom:{\n    families: ['tb', 'tr'],\n    urls: [ '/assets/1.fonts.css' ]\n  }\n}\n</code></pre>\n\n<p>COFFEE :</p>\n\n<pre><code>(-&gt;\n  wf = document.createElement(\"script\")\n  wf.src = \"/assets/libraries/webfonts.js\"\n  wf.type = \"text/javascript\"\n  wf.async = \"true\"\n  s = document.getElementsByTagName(\"script\")[0]\n  s.parentNode.insertBefore wf, s\n)()\nWebFontConfig = custom:\n  families: [\"tb\", \"tr\"]\n  urls: [\"/assets/1.fonts.css\"]\n</code></pre>\n\n<p>I could list other examples, but I'm fronting this \"js works / coffee does not\" problem very often</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13093497,"title":"Ruby on Rails - How do I generate random dates?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4894198/how-to-generate-a-random-date-in-ruby\">How to generate a random date in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>How do I generate a random date within a specific timeframe?</p>\n\n<p>Cheers.</p>\n"},{"tags":["html","ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13092800,"title":"Cycle through values in an Ruby Array on a HTML page","body":"<p>I am fetching some rows from the database in my controller with this query :</p>\n\n<pre><code>@main = connection.execute(\"select code_ver, result from mastertest;\")\n</code></pre>\n\n<p>Now in my html.erb, I am displaying the results in a table like this:</p>\n\n<pre><code>&lt;% @level1.each do |row1| %&gt;\n&lt;table id=\"tbl_main1\" name=\"tbl_main1\"&gt;\n    &lt;tr bgcolor=\"#D1D1D1\"&gt;\n        &lt;td width=\"60%\" &lt;%= row1[0] %&gt;&gt;&lt;/td&gt;\n        &lt;td width=\"20%\"&gt;&lt;%= row1[2] %&gt;&lt;/td&gt;\n        &lt;td width=\"20%\"&gt;&lt;%= row1[1] %&gt;&lt;/td&gt; \n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I am fetching a lot of rows here. But I want to show only say 15 results at once, and have some kind of buttons 'next' and 'previous' which would cycle through the results. How would I do that ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","autocomplete","getter-setter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13079369,"title":"setter and getter result in nil value in FactoryGirl with Rails 3.2.8","body":"<p>In our invoice model, there are two columns - <code>customer_id</code> and <code>customer_name</code>. In order to use auto-complete (JQuery), a setter and getter for <code>customer_name</code> were added to invoice model:</p>\n\n<pre><code>  def customer_name\n    customer.try(:name)\n  end\n\n  def customer_name=(name)\n    self.customer = Customer.find_by_name(name) if name.present?\n  end \n</code></pre>\n\n<p>In invoice model, there is:</p>\n\n<pre><code>  belongs_to :customer\n</code></pre>\n\n<p>However after that, <code>customer_id</code> and <code>customer_name</code> are always <code>nil</code> by <code>FactoryGirl.build(:invoice)</code>. If the getter and setter were removed from the invoice model, then the FactoryGirl assigns the right value to <code>customer_id</code> and <code>customer_name</code>. Here is the FactoryGirl:</p>\n\n<pre><code> factory :invoice do \n.....\n    customer_id             2\n    customer_name           'a customer name'\n...\n\n  end\n</code></pre>\n\n<p>Why does the getter and setter of <code>customer_name</code> result in <code>nil</code> in FactoryGirl? </p>\n"},{"tags":["ruby-on-rails-3","activerecord","ancestry"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13090848,"title":"Can I create an activerecord association through an activerecord relation (when using the ancestry gem)?","body":"<p>I am using the <a href=\"https://github.com/stefankroes/ancestry\" rel=\"nofollow\" title=\"ancestry gem\">ancestry gem</a> in my rails project to create a hierarchy of groups. A group can belong to a parent group and can have many children groups. Each group can have many users who belong to a group.  The model looks like this:</p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n  has_ancestry\n\n  has_many :users\nend\n</code></pre>\n\n<p>I would love to be able to get all users for the descendants of a group, something like this:</p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n  has_ancestry\n\n  has_many :users\n  has_many :descendants_users, through: :descendants\nend\n</code></pre>\n\n<p>which, of course, doesn't work.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","date","timezone"],"answer_count":8,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":5012,"score":5,"question_id":6060436,"title":"Rails 3: How to get today's date in specific timezone?","body":"<p>To get today's date I do:</p>\n\n<pre><code>Date.today    # =&gt; Fri, 20 May 2011\n</code></pre>\n\n<p>I would like to get today's date in a specific timezone, say <code>'Melbourne'</code>.</p>\n\n<p>I have the following setting in my <code>application.rb</code>:</p>\n\n<pre><code>config.time_zone = 'Melbourne'\n</code></pre>\n\n<p>and I set:</p>\n\n<pre><code>Time.zone = 'Melbourne'\n</code></pre>\n\n<p>in my application controller before each action.</p>\n\n<p>However, it doesn't help (I guess because these settings affects only dates that are stored in the database).</p>\n\n<p>How could I get today's date in <code>'Melbourne'</code> ?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13082522,"title":"Writing a database migration that turns datetime null:false to true","body":"<p>I'm trying to write a database migration that changes the datetime fields in my join table from null to true but something isn't working correctly. Here's my code:</p>\n\n<pre><code>class ChangeDateColumnsInCirclesUsers &lt; ActiveRecord::Migration\n  def change\n    change_column :circles_users, :created_at, :datetime, :null =&gt; true\n    change_column :circles_users, :updated_at, :datetime, :null =&gt; true\n  end\nend\n</code></pre>\n\n<p>This isn't working. Any ideas on how to have those null values be set to true instead of false?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13092214,"title":"Rails errors.full_messages rendering square brackets","body":"<p>I'm looping through errors in a <code>user#update</code> using the following HAML:</p>\n\n<pre><code>- if @user.errors.any?\n  .alert.alert-error\n    %ul\n      = @user.errors.full_messages.each do |msg|\n        %li= msg\n</code></pre>\n\n<p>However, instead of just displaying the message, I also get square brackets:</p>\n\n<p><code>First name can't be blank [\"First name can't be blank\"]</code></p>\n\n<p>What am I doing wrong?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If I do <code>p msg</code> then the console tail shows <em>only</em> the message, but within the <code>&lt;li&gt;</code> the brackets still render.</p>\n"},{"tags":["ruby-on-rails-3","redirect"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1647,"score":0,"question_id":6941971,"title":"AbstractController::DoubleRenderError in rails 3","body":"<p>I always get the following error:</p>\n\n<blockquote>\n  <p>AbstractController::DoubleRenderError (Render and/or redirect were\n  called multiple times in this action. Please note that you may only\n  call render OR redirect, and at most once per action. Also note that\n  neither redirect nor render terminate execution of the action, so if\n  you want to exit an action after redirecting, you need to do something\n  like \"redirect_to(...) and return\".):</p>\n</blockquote>\n\n<p>The error happens, when it id is nil the first, but not the second time...</p>\n\n<pre><code>def calc_next\n  id = next()\n  if id.nil?\n    id = next_next()\n    if id.nil?\n      render :layout =&gt; false, :format =&gt; :js\n    else\n      redirect_to :action =&gt; \"view\", :id =&gt; id, :format =&gt; :js\n    end\n  else\n    redirect_to :action =&gt; \"view\", :id =&gt; id, :format =&gt; :js\n  end\nend\n</code></pre>\n\n<p>I don't see the problem in this redirection, as the outer one is fine. Even with the debugger there are not two redirections at the same time...</p>\n\n<p>Any help is appreciated...\nMarkus</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13091416,"title":"Passing in options param for content_for method","body":"<p>I found that you can flush <code>content_for</code> looking at the Rails source. <a href=\"https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/capture_helper.rb\" rel=\"nofollow\">https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/capture_helper.rb</a></p>\n\n<p><strong>Rails Source:</strong></p>\n\n<pre><code>def content_for(name, content = nil, options = {}, &amp;block)\n  if content || block_given?\n    if block_given?\n      options = content if content\n      content = capture(&amp;block)\n    end\n    if content\n      options[:flush] ? @view_flow.set(name, content) : @view_flow.append(name, content)\n    end\n    nil\n  else\n    @view_flow.get(name)\n  end\nend\n</code></pre>\n\n<p>I am trying to set <code>options[:flush] = true</code>, but am having some trouble. The <code>options[:flush]</code> is not evaluating to true in my code below.</p>\n\n<p><strong>My code</strong>:</p>\n\n<pre><code>content_for(affiliate_link_pos.to_sym, {:flush=&gt;true}) do\n  render page\nend\n</code></pre>\n\n<p><strong>Edit</strong>:\nI have also tried passing a 3rd params (content), but I get <code>wrong number of argument error (3 for 2)</code>.</p>\n\n<pre><code>content_for(affiliate_link_pos.to_sym, \"true\",  {:flush=&gt;true}) do\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","dynamic"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":274,"score":1,"question_id":10351787,"title":"Ruby: Include a dynamic module name","body":"<p>I have a situation in my Rails application where I need to include arbitrary modules depending on the current runtime state. The module provides custom application code that is only needed when certain conditions are true. Basically, I'm pulling the name of a company from the current context and using that as the filename for the module and its definition:</p>\n\n<pre><code>p =  self.user.company.subdomain + \".rb\"\nif File.exists?(Rails.root + \"lib/\" + p)\ninclude self.class.const_get(self.user.company.subdomain.capitalize.to_sym)\n    self.custom_add_url\nend\n</code></pre>\n\n<p>My test module looks like this:</p>\n\n<pre><code>module Companyx\n    def custom_add_url\n    puts \"Calling custom_add_url\"   \nend \nend\n</code></pre>\n\n<p>Now in the console, this actually works fine. I can pull a user and include the module like so:</p>\n\n<pre><code>[1] pry(main)&gt; c = Card.find_by_personal_url(\"username\")\n[2] pry(main)&gt; include c.class.const_get(c.user.company.subdomain.capitalize)=&gt; Object\n[3] pry(main)&gt; c.custom_add_url\n</code></pre>\n\n<p>Calling custom_add_url</p>\n\n<p>If I try to run the include line from my model, I get</p>\n\n<pre><code>NoMethodError: undefined method `include' for #&lt;Card:0x007f91f9094fb0&gt;\n</code></pre>\n\n<p>Can anyone suggest why the include statement would work on the console, but not in my model code? </p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ajax","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13078745,"title":"Rails 3 update two models using ajax","body":"<p>I've been stuck on this for about 2 weeks.  I need help in the proper way to do this.  I have two models.  Model one is Leads.  Model two is Referrals.</p>\n\n<p>Leads belongs_to referrals</p>\n\n<p>Referrals has_many Leads</p>\n\n<p>In the Lead entry screen there is a partial that displays possible Referrals for the lead to select from.  There is an Add Referral link in the partial that brings up a modal using twitter bootstrap as the css framework.  From that I am rendering the New action of the Referral controller.</p>\n\n<p>This all works up to this point.  What I want to have happen is that I can then enter a new referral, it is saved, the modal closes, and the list of referrals in the partial of the Leads edit/new view is then updated to reflect the new referral that has been added.  But at this point I now have nested form_for's.  As well as a Referral form that is working off a different controller.</p>\n\n<p>I am not sure how I should approach this.  I have been searching and trying various methods for a couple of weeks now.  Do I repeat myself and completely rebuild the Referral view and controller under the Leads controller and view?  Repetitive code like that is why I switched to rails, and why I feel I'm not looking at this correctly.  There has to be a simple way around this.  I have looked at using Gems like Draper and Cell, and I've read up on using presenters.  But those seem to all be solutions for a dashboard type of view, not what I am trying to accomplish.</p>\n\n<p>Any help or direction would be much appreciated.</p>\n\n<p>Thank you...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":13079845,"title":"Rails Login with Twitter Bootstrap Navbar (w/ Devise)?","body":"<p>I am trying to use Twitter's Bootstrap (http://twitter.github.com/bootstrap/index.html) with Ruby on Rails (v 3.2.8 with Ruby 1.9.3).  I am using Devise for authentication.</p>\n\n<p>Twitter has a nice sign-in form in their navbar. (see <a href=\"http://twitter.github.com/bootstrap/examples/hero.html\" rel=\"nofollow\">http://twitter.github.com/bootstrap/examples/hero.html</a>?)</p>\n\n<p>How would I set up my Rails application to use that login?  I can set Rails up to login from its own login page, but how do I use the Navbar login?  What would be the controller/model structure?</p>\n\n<p>I found this on github, but it does not implement the navbar signup (https://github.com/RailsApps/rails3-bootstrap-devise-cancan/).</p>\n\n<p>Thanks</p>\n\n<p>UPDATE:</p>\n\n<p>Found the answer :  <a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Display-a-custom-sign_in-form-anywhere-in-your-app\" rel=\"nofollow\">https://github.com/plataformatec/devise/wiki/How-To:-Display-a-custom-sign_in-form-anywhere-in-your-app</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","google-maps","google","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13091518,"title":"Rails + Google-Maps-for-Rails - reload map and centering the marker","body":"<p>I started to use gem 'gmaps4rails' to show google map in my application.</p>\n\n<p>In my view i use this (note: i use haml):</p>\n\n<p><strong>index.html.haml</strong></p>\n\n<pre><code>  %div.span12.pagination-centered\n    = gmaps(\"map_options\" =&gt; { \"detect_location\" =&gt; true, \"center_on_user\" =&gt; true, \"auto_zoom\" =&gt; false, \"zoom\" =&gt; 16},\"markers\" =&gt; { \"data\" =&gt; @json })\n</code></pre>\n\n<p>I would like to add simple link on the page which would reload the map and centering the marker like gmaps4rails does. But i can't get how to do that. I would appreciate any help! </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":376,"score":2,"question_id":13081868,"title":"Could not find capistrano-2.13.3 in any of the sources","body":"<p>I setup ruby on rails environment using <a href=\"http://jaysonrowe.blogspot.com/2012/04/installing-ruby-and-rails-on-fedora.html\" rel=\"nofollow\">http://jaysonrowe.blogspot.com/2012/04/installing-ruby-and-rails-on-fedora.html</a>. I installed mysql 5.5. Now when I clone a project from bitbucket and run bundle install, I get following error:</p>\n\n<pre><code>[xyz@xyz ruby_repo]$ bundle install\nFetching gem metadata from http://rubygems.org/......\nFetching gem metadata from http://rubygems.org/..\nCould not find capistrano-2.13.3 in any of the sources\n</code></pre>\n\n<p>When I execute rails -v in ruby_repo directory, I get following error:</p>\n\n<pre><code>[xyz@xyz ruby_repo]$  rails -v\nCould not find abstract-1.0.0 in any of the sources\nRun `bundle install` to install missing gems.\n</code></pre>\n\n<p>Below is my Gemfile:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.10'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\ngem 'rmagick'\ngem \"will_paginate\", \"~&gt; 3.0.pre2\"\ngem 'mysql2','0.2.7'\ngem \"nokogiri\"\ngem 'activemerchant', :require =&gt; 'active_merchant'\ngem \"webrobots\", \"~&gt; 0.0.10\"\ngem 'mixpanel'\ngem 'thinking-sphinx', '2.0.10'\ngem 'whenever', :require =&gt; false\ngem 'json'\ngem 'vimeo'\ngem \"koala\"\ngem 'typhoeus'\ngem 'delayed_job_active_record'\ngem \"delayed_job\"\ngem 'mini_fb'\ngem 'daemons'\ngem 'annotate'\ngem 'capistrano'\ngem 'rvm-capistrano'\ngem 'grosser-ssl_requirement', :require =&gt; 'ssl_requirement'\ngem 'acts-as-taggable-on'\ngem 'capistrano'\ngem 'rvm-capistrano'\n# Use unicorn as the web server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n#gem 'capistrano'\n#gem 'capistrano-ext'\n#To use debugger (ruby-debug for Ruby 1.8.7+, ruby-debug19 for Ruby 1.9.2+)\n# gem 'ruby-debug'\n\n\n# Bundle the extra gems:\n# gem 'bj'\n# gem 'nokogiri'\n# gem 'sqlite3-ruby', :require =&gt; 'sqlite3'\n# gem 'aws-s3', :require =&gt; 'aws/s3'\n\n# Bundle gems for the local environment. Make sure to\n# put test-only gems in this group so their generators\n# and rake tasks are available in development mode:\n# group :development, :test do\n#   gem 'webrat'\n# end\n</code></pre>\n\n<p>When I execute gem list, I get following output</p>\n\n<pre><code>*** LOCAL GEMS ***\n\nactionmailer (3.2.8)\nactionpack (3.2.8)\nactivemodel (3.2.8)\nactiverecord (3.2.8)\nactiveresource (3.2.8)\nactivesupport (3.2.8)\narel (3.0.2)\nbuilder (3.0.4)\nbundler (1.2.1)\ncapistrano (2.13.4)\ncoffee-rails (3.2.2)\ncoffee-script (2.2.0)\ncoffee-script-source (1.4.0)\nerubis (2.7.0)\nexecjs (1.4.0)\nhighline (1.6.15)\nhike (1.2.1)\ni18n (0.6.1)\njourney (1.0.4)\njquery-rails (2.1.3)\njson (1.7.5)\nmail (2.4.4)\nmime-types (1.19)\nmulti_json (1.3.6)\nmysql2 (0.3.11)\nnet-scp (1.0.4)\nnet-sftp (2.0.5)\nnet-ssh (2.6.1)\nnet-ssh-gateway (1.1.0)\npolyglot (0.3.3)\nrack (1.4.1)\nrack-cache (1.2)\nrack-ssl (1.3.2)\nrack-test (0.6.2)\nrails (3.2.8)\nrailties (3.2.8)\nrake (0.9.2.2)\nrdoc (3.12)\nrubygems-bundler (1.1.0)\nrvm (1.11.3.5)\nsass (3.2.1)\nsass-rails (3.2.5)\nsprockets (2.1.3)\nsqlite3 (1.3.6)\nthor (0.16.0)\ntilt (1.3.3)\ntreetop (1.4.11)\ntzinfo (0.3.33)\nuglifier (1.3.0)\n</code></pre>\n\n<p>However when I create a completely new project, I don't face any such issue. Can anyone please tel me what might be the issue?</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13090425,"title":"Why does Rails demo app give \"uninitialized constant ExecJS::RubyRacerRuntime::Context::V8\"?","body":"<p>Being new to Rails, I'm trying to get a basic \"hello world\" app up and running. Specifically the app in chapter 2 of <a href=\"http://pragprog.com/book/rails4/agile-web-development-with-rails\" rel=\"nofollow\">Agile Web Development with Rails</a>. Loading up the hello world page results in the error given in the title.</p>\n\n<hr>\n\n<p>So far I've done the following:</p>\n\n<pre><code>rails new demo\ncd demo\n</code></pre>\n\n<p>Added <code>gem 'therubyracer'</code> to the <code>Gemfile</code> after <code>ExecJS</code> complained about no JavaScript runtime being available.</p>\n\n<pre><code>bundle install\nrake about         # (see below)\nrails generate controller Say hello goodbye\nrails server\n</code></pre>\n\n<p>At this point WEBrick fires up and I load up <code>http://localhost:3000/say/hello</code>. WEBrick logs the following error (which also appears in the browser):</p>\n\n<pre><code>Started GET \"/say/hello\" for 127.0.0.1 at 2012-10-26 11:45:10 -0400\nConnecting to database specified by database.yml\nProcessing by SayController#hello as HTML\n  Rendered say/hello.html.erb within layouts/application (80.9ms)\nCompleted 500 Internal Server Error in 167ms\n\nActionView::Template::Error (uninitialized constant ExecJS::RubyRacerRuntime::Context::V8\n  (in /home/error/work/demo/app/assets/javascripts/say.js.coffee)):\n    3: &lt;head&gt;\n    4:   &lt;title&gt;Demo&lt;/title&gt;\n    5:   &lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n    6:   &lt;%= javascript_include_tag \"application\" %&gt;\n    7:   &lt;%= csrf_meta_tags %&gt;\n    8: &lt;/head&gt;\n    9: &lt;body&gt;\n  app/views/layouts/application.html.erb:6:in `_app_views_layouts_application_html_erb___1746644185114933585_70069037653480'\n\n\n  Rendered /home/error/.gem/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_trace.erb (3.7ms)\n  Rendered /home/error/.gem/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (2.2ms)\n  Rendered /home/error/.gem/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/template_error.erb within rescues/layout (18.7ms)\n[2012-10-26 11:45:12] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true\n</code></pre>\n\n<p><code>rake about</code> returns:</p>\n\n<pre><code>About your application's environment\nRuby version              1.9.3 (x86_64-linux)\nRubyGems version          1.8.24\nRack version              1.4\nRails version             3.2.8\nJavaScript Runtime        therubyracer (V8)\nActive Record version     3.2.8\nAction Pack version       3.2.8\nActive Resource version   3.2.8\nAction Mailer version     3.2.8\nActive Support version    3.2.8\nMiddleware                ActionDispatch::Static, Rack::Lock, #&lt;ActiveSupport::Cache::Strategy::LocalCache::Middleware:0x0000000276b298&gt;, Rack::Runtime, Rack::MethodOverride, ActionDispatch::RequestId, Rails::Rack::Logger, ActionDispatch::ShowExceptions, ActionDispatch::DebugExceptions, ActionDispatch::RemoteIp, ActionDispatch::Reloader, ActionDispatch::Callbacks, ActiveRecord::ConnectionAdapters::ConnectionManagement, ActiveRecord::QueryCache, ActionDispatch::Cookies, ActionDispatch::Session::CookieStore, ActionDispatch::Flash, ActionDispatch::ParamsParser, ActionDispatch::Head, Rack::ConditionalGet, Rack::ETag, ActionDispatch::BestStandardsSupport\nApplication root          /home/error/work/demo\nEnvironment               development\nDatabase adapter          sqlite3\nDatabase schema version   0\n</code></pre>\n\n<hr>\n\n<p>The workstation is running Fedora 17 x86_64. Despite that, I've pretty much ignored the ruby gems in the yum repositories (I think) and used <code>gem install</code> in my home directory to get everything I need. (Again, I think.)</p>\n\n<p>Being new to Ruby and Rails, I'm pretty sure I've missed some obvious convention that I'm not yet aware of. I'm also not quite sure what additional information I might need to provide, so please let me know that as well.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13087848,"title":"rails: collection_select for current_user","body":"<p>I have a Box which has many Items which belongs to a Category.\nWhen the Box is created it has the user_id.\nItems has a category_id.</p>\n\n<p>I've seen that if you have a user_id in the table concerned it works okay:</p>\n\n<pre><code>&lt;%= f.collection_select :category_id, Category.where(:user_id =&gt; current_user.id), :id , :name %&gt;\n</code></pre>\n\n<p>But how can I get a Category collection_select from what the current_user has entered - do I have to add a user_id to Categories or can I join my tables somehow?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","debugging","thin","webrick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13090124,"title":"how to debug web server on RoR?","body":"<p>I currently have a problem with a project.</p>\n\n<p>it freezes before it shows the \"Started GET ....\" seems like it hits an infinite loop.</p>\n\n<p>now i dont really have much experience with debuggers in ROR, can anyone recommend anything i can use to trace the exact origin of the problem. if i can get an error code somewhere then i might be able to fix it.</p>\n\n<p>currently i am using webrick, i tried thin and it gave the exact same error.but i am willing to use anything to find the exact origin of this error.</p>\n\n<p>it seems to be related to the project because all other projects works fine on my environment.</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13089877,"title":"Self referential many to many where inverse is unimportant (can be one directional)","body":"<p>If I make a template a sub-template, it can't be a sub-template of any other templates.  I don't think I can do has_and_belongs_to_many as a self reference, so what are my other options?  I don't care about it being bi-directional.</p>\n\n<pre><code>has_many :sub_templates,\n  :class_name =&gt; 'Template',\n  :inverse_of =&gt; :subbed_template,\n  :foreign_key =&gt; \"template_association\"\nbelongs_to :subbed_template,\n  :class_name =&gt; 'Template',\n  :inverse_of =&gt; nil\n</code></pre>\n"},{"tags":["ruby-on-rails-3","soap","savon"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12746695,"title":"GET WSDL file using Savon SOAP GEM","body":"<p>I am trying to establish a connection using the ruby gems Savon and execute SOAP requests and responses. The thing is that I am getting the file each time by doing this:</p>\n\n<pre><code>client = Savon.client(\"http://www.webservicex.net/uszip.asmx?WSDL\")\n</code></pre>\n\n<p>Now in the documentation of Savon it says this:</p>\n\n<p>\"You can instantiate a client with or without a (local or remote) WSDL document. Using a WSDL is a little easier because Savon can parse the document for the target namespace, endpoint, available SOAP actions etc. But the (remote) WSDL has to be downloaded and parsed once for every client which comes with a performance penalty.\"</p>\n\n<p>So my question is, can I get the WSDL file by just using the Savon Library? Or do I need to ask for it from the third party application?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13077512,"title":"Rails merge tags","body":"<p>I need to insert a merge-tag in a text. For example I have the merge tag |NAME|, so, I would like to replace |NAME| in any part of a paragraph. For example if |NAME| = Carlos</p>\n\n<p>Lorep ipsum |NAME| dorel pored = Lorep ipsum Carlos dorel pored</p>\n\n<p>or</p>\n\n<p>|NAME| Lorep ipsum dorel pored = Carlos Lorep ipsum  dorel pored</p>\n\n<p>How can I do that with rails?\nAre there some plugin in rails for that?\nThanks in advance</p>\n\n<hr>\n\n<h2>UPDATE</h2>\n\n<p>Sorry, I think I explained bad. This not have to be hard coded. The user has a textbox where he can decide where to put the merge-tag to appear in any place of the text entered.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cron","rake"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":738,"score":2,"question_id":5518499,"title":"Rails3, Running rake task from cron","body":"<p>I'm having problems running my rake task from cron, I wrap it in shell file and when I execute this shell file from console it works fine.</p>\n\n<pre><code>#!/bin/sh\n\nif ps -ef | grep -v grep | grep create_all_accounts ; then\n    exit 0\nelse\n    cd /home/prosoftstudio/www/prosoftstudio_egabinet &amp;&amp; /home/prosoftstudio/www/.ruby/gems/1.8/bin/rake gabinet:create_all_accounts RAILS_ENV=production --trace\n    exit 0\nfi\n</code></pre>\n\n<p>Entry in crontab looks like this(I set PATH and GEM_PATH)</p>\n\n<pre><code>PATH=/home/prosoftstudio/www/.python/bin:/usr/local/python2.6/bin:/home/prosoftstudio/www/.ruby/gems/1.8/bin/:/usr/local/ruby1.8/bin:/usr/local/bin:/usr/bin:/bin:/us$\nGEM_PATH=/home/prosoftstudio/www/.ruby/gems/1.8:/home/prosoftstudio/www/.ruby/gems/1.8/bundler/gems:/usr/lib/ruby/gems/1.8/\n*/1 * * * * /home/prosoftstudio/www/cron_create_accounts.sh &gt; cron_log.txt 2&gt;&amp;1\n</code></pre>\n\n<p>The output I get is</p>\n\n<pre><code>rake aborted!\ngit://github.com/100hz/rails-settings.git (at master) is not checked out. Please run `bundle install`\n</code></pre>\n\n<p>It seems like it can't find gems installed with</p>\n\n<pre><code>gem \"rails-settings\", :git =&gt; \"git://github.com/100hz/rails-settings.git\"\n</code></pre>\n\n<p>Anyone know how to fix this?</p>\n"},{"tags":["ruby-on-rails-3","json","http","post"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13086262,"title":"Parse JSON HTTP post in Rails 3 app?","body":"<p>I have a simple Rails 3 example application that I'm trying to work out how to parse a JSON POST and insert the data into my applications database.</p>\n\n<p>I have a basic Activities controller and model, the controller is as follows:</p>\n\n<pre><code>class ActivitiesController &lt; ApplicationController\n  # GET /activities\n  # GET /activities.json\n  def index\n    @activities = Activity.order('created_at DESC').limit(10)\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @activities }\n    end\n  end\n\n  # GET /activities/1\n  # GET /activities/1.json\n  def show\n    @activity = Activity.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @activity }\n    end\n  end\n\n  # GET /activities/new\n  # GET /activities/new.json\n  def new\n    @activity = Activity.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @activity }\n    end\n  end\n\n  # GET /activities/1/edit\n  def edit\n    @activity = Activity.find(params[:id])\n  end\n\n  # POST /activities\n  # POST /activities.json\n  def create\n    @activity = Activity.new(params[:activity])\n\n    respond_to do |format|\n      if @activity.save\n        format.html { redirect_to @activity, notice: 'Activity was successfully created.' }\n        format.json { render json: @activity, status: :created, location: @activity }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @activity.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /activities/1\n  # PUT /activities/1.json\n  def update\n    @activity = Activity.find(params[:id])\n\n    respond_to do |format|\n      if @activity.update_attributes(params[:activity])\n        format.html { redirect_to @activity, notice: 'Activity was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @activity.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /activities/1\n  # DELETE /activities/1.json\n  def destroy\n    @activity = Activity.find(params[:id])\n    @activity.destroy\n\n    respond_to do |format|\n      format.html { redirect_to activities_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>I have also got an example JSON payload from the application I'm trying to receive the POST from:</p>\n\n<pre><code>payload {\"files\":{\"changed\":[],\"removed\":[\".gitmodules\",\"extensions\",\"extensions/markdown\"]},\"project\":{\"permalink\":\"dans-stuff-2\",\"public_key\":\"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCuB80S+kMN1266LvCEXoU5hmjugcuXko61Hl7uD9VVgMgEOrLSkeYktOPshgCOwjQgGhSMVEHWrSuOddOi+V3rOu3v91jiU3vycRM3nK9GMaOFf+tTn0/4ReUvGOFHeir1vluHCmOAmpqsVhGWkCJY6eJE37muvGdTG4nW/VnpWYCTLfSOeaq5MVx5LU+zYLntvB5PXd7h1k5ROO8lW+5QzGVyHHEvilzJOqESIAWpNtcXGBt7clWpFH4lg2AT7JebYFuHl8Sl4LYzIRegcpg718CWJjrck9/xV6CBTGP520ifU6K0x4JOn/qFzVlqwnxmrPXwawptmCiYiJt3X8Oz DeployHQ.com Key for dans-stuff-2\",\"name\":\"Dans Stuff\",\"repository\":{\"port\":null,\"username\":null,\"branch\":\"master\",\"url\":\"git@codebasehq.com:atech/deploytest/test1.git\",\"scm_type\":\"git\",\"cached\":true,\"hosting_service\":{\"name\":\"Codebase\",\"url\":\"http://www.codebasehq.com\",\"commits_url\":\"http://atech.codebasehq.com/projects/deploytest/repositories/test1/commits/master\",\"tree_url\":\"http://atech.codebasehq.com/projects/deploytest/repositories/test1/tree/master\"}}},\"server\":{\"name\":\"cybele\",\"server_path\":\"/home/dan/deploytest\",\"port\":22,\"username\":\"dan\",\"use_ssh_keys\":true,\"last_revision\":\"2ad223b9dd6d006d69909407ac7df322e35b009b\",\"hostname\":\"cybele.phoenixdev.co.uk\",\"identifier\":\"de99437e-da4a-0986-a7ab-e55805261a96\",\"protocol_type\":\"ssh\"},\"start_revision\":{\"timestamp\":\"2011-11-30T13:48:22+00:00\",\"author\":\"Dan Wentworth\",\"ref\":\"a1c1073b85d1662c075d77f5d88be3fd291abd12\",\"message\":\"nested markdown pathg\",\"email\":\"dan@atechmedia.com\"},\"identifier\":\"9d0f9c21-f242-3966-fcd3-e821a65acd45\",\"end_revision\":{\"timestamp\":\"2011-08-30T16:41:32+01:00\",\"author\":\"Dan Wentworth\",\"ref\":\"2ad223b9dd6d006d69909407ac7df322e35b009b\",\"message\":\"arses\",\"email\":\"dan@atechmedia.com\"},\"configuration\":{\"email_notify\":true,\"notification_addresses\":\"dan@atechmedia.com\",\"copy_config_files\":true},\"timestamps\":{\"completed_at\":\"2012-01-17T09:22:15Z\",\"duration\":null,\"queued_at\":\"2012-01-17T09:22:07Z\",\"started_at\":\"2012-01-17T09:22:10Z\"},\"status\":\"completed\"} -------------------------------------------------------------------------------- signature TMjVYhk/+lQigy3hdkgTZjAaaroxAi126XaDzrQ1xWGyMji9oR0F5nfE73Mo kNs7Hk7aY1GQgtDRdBjgPE+C/6etF9nPFXPacWobaxSP35TGOrpoSACNQDAQ Q0wvn0Bm/jMvhBKoQ6YYUSx8KP8nd7VkgQmv4S0cakgixA4LHfg=\n</code></pre>\n\n<p>Because the POST will need to be made to a URL, I would imagine I need to define a new method:</p>\n\n<pre><code>def deploy_receive\n   data = JSON.parse(request.body)\nend\n</code></pre>\n\n<p>What I am unsure of, is where to go from here. How would I cherry pick the attributes from the JSON and put them into various attributes in the Activities table?</p>\n\n<p>Something like this?</p>\n\n<pre><code>def deploy_receive\n   data = JSON.parse(request.body)\n   @activity = Activity.new(params[:fault])\n   @activity.who = data.author    \nend\n</code></pre>\n\n<p>Any pointers would be appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","path","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13077339,"title":"Weird issue with my rails path and its routing","body":"<p>I'm getting a strange error with my routing. I've installed the blogit gem but I don't think this is causing this problem.</p>\n\n<pre><code>undefined local variable or method `locations_path'\n</code></pre>\n\n<p>Here is my routes file:</p>\n\n<pre><code>AppName::Application.routes.draw do\n\n\ndevise_for :users\n\nroot :to =&gt; 'locations#index'\n\n\nmount Blogit::Engine =&gt; \"/blog\", :as =&gt; \"blog\" \n\n\n\nresources :locations do\n  collection do\n  get 'location'\n end\nend\n</code></pre>\n\n<p>and here's my rake routes:</p>\n\n<pre><code>       new_user_session GET    /users/sign_in(.:format)       devise/sessions#new\n        user_session POST   /users/sign_in(.:format)       devise/sessions#create\ndestroy_user_session DELETE /users/sign_out(.:format)      devise/sessions#destroy\n       user_password POST   /users/password(.:format)      devise/passwords#create\n   new_user_password GET    /users/password/new(.:format)  devise/passwords#new\n   edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit\n                     PUT    /users/password(.:format)      devise/passwords#update\n cancel_user_registration GET    /users/cancel(.:format)            devise/registrations#cancel\n\n    user_registration POST   /users(.:format)               devise/registrations#create\nnew_user_registration GET    /users/sign_up(.:format)       devise/registrations#new\nedit_user_registration GET    /users/edit(.:format)          devise/registrations#edit\n                     PUT    /users(.:format)               devise/registrations#update\n                     DELETE /users(.:format)               devise/registrations#destroy\n\n\n                root        /                              locations#index\n                blog        /blog                          Blogit::Engine\n  location_locations GET    /locations/location(.:format)  locations#location\n           locations GET    /locations(.:format)           locations#index\n                     POST   /locations(.:format)           locations#create\n        new_location GET    /locations/new(.:format)       locations#new\n       edit_location GET    /locations/:id/edit(.:format)  locations#edit\n            location GET    /locations/:id(.:format)       locations#show\n                     PUT    /locations/:id(.:format)       locations#update\n                     DELETE /locations/:id(.:format)       locations#destroy\n\nRoutes for Blogit::Engine:\n                     /posts/page/:page(.:format)            blogit/posts#index\n   tagged_blog_posts        /posts/tagged/:tag(.:format)           blogit/posts#tagged\n   post_comments POST   /posts/:post_id/comments(.:format)     blogit/comments#create\n   post_comment DELETE /posts/:post_id/comments/:id(.:format) blogit/comments#destroy\n   posts GET    /posts(.:format)                       blogit/posts#index\n        POST   /posts(.:format)                       blogit/posts#create\n   new_post GET    /posts/new(.:format)                   blogit/posts#new\n   edit_post GET    /posts/:id/edit(.:format)              blogit/posts#edit\n   post GET    /posts/:id(.:format)                   blogit/posts#show\n         PUT    /posts/:id(.:format)                   blogit/posts#update\n              DELETE /posts/:id(.:format)                   blogit/posts#destroy\n   root        /                                      blogit/posts#index\n</code></pre>\n\n<p>Any suggestions as to why this may be happening would be great. </p>\n\n<p>Thanks, </p>\n\n<p>James</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13088357,"title":"how to pass the parameter with spaces and access the same value in another page in rails?","body":"<p>I want to pass a value through url to access the same value in the next page. When i pass the value i can see in my url </p>\n\n<blockquote>\n  <p>value=example+value</p>\n</blockquote>\n\n<p>but when i use the following in views it then sends only the first part of the value after it pass to the next page.</p>\n\n<pre><code> &lt;%= link_to edit, edit_post_path(post, :value =&gt; params[:value]) %&gt;\n</code></pre>\n\n<p>when the edit button is clicked it performs the action and when it goes to the next page i see only <code>value=example</code> in the url. what should i do?</p>\n"},{"tags":["ruby-on-rails-3","apache","passenger","carrierwave"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12049939,"title":"Apache upload progress module with carrierwave","body":"<p>I install Passenger and setup <a href=\"https://github.com/drogus/apache-upload-progress-module\" rel=\"nofollow\">apache upload module</a>. There is my config file.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># httpd-vhosts.conf    \n\nNameVirtualHost *:80\n\n&lt;VirtualHost *:80&gt;\n  ServerName localhost\n  DocumentRoot \"/Users/Earth/projects/test/virudson/upload_progress/public\"\n\n  RailsEnv production\n  RailsAllowModRewrite off\n\n  &lt;Directory \"/Users/Earth/projects/test/virudson/upload_progress/public\"&gt;\n    Order allow,deny\n    Allow from all\n  &lt;/Directory&gt;\n\n  # needed for tracking upload progess\n  &lt;Location /&gt;\n    # enable tracking uploads in /\n    TrackUploads On\n  &lt;/Location&gt;\n\n  &lt;Location /progress&gt;\n    # enable upload progress reports in /progress\n    ReportUploads On\n    PassengerEnabled off\n  &lt;/Location&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>After that I create simple rails application for test upload progress is working.</p>\n\n<p>There is my views code.</p>\n\n<pre><code># /app/views/photos/new.html.erb\n\n# @uuid generated at controller level. I'm pretty sure it is unique.\n&lt;%= form_for :photo, :url =&gt; \"/photos?X-Progress-ID=#{@uuid}\", :html =&gt; {:multipart =&gt; true} do |form| %&gt;\n    &lt;%= form.label :photo %&gt;\n    &lt;%= form.file_field :file_name %&gt;\n\n    &lt;%= form.submit 'upload image', :class =&gt; 'submit' %&gt;\n&lt;% end %&gt;\n\n# There is link that I provide for testing apache upload progress module while photo uploading.\n&lt;a href=\"&lt;%= \"/progress/?X-Progress-ID=#{@uuid}\" %&gt;\"&gt;Testing the upload URL&lt;/a&gt;\n</code></pre>\n\n<p>There is a problem while uploading the link always return state 'starting' until upload end.</p>\n\n<pre><code>{ \"state\" : \"starting\", \"uuid\" : \"1e9dae300f42569b4db8\" }\n</code></pre>\n\n<p>Maybe I do some thing wrong. Please leave any suggestion.</p>\n"},{"tags":["xml","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13085906,"title":"How to specify layout in to_xml in rails 3.2.x?","body":"<p>Is there any way to specify the layout option as in the respond_to method?</p>\n\n<p>or is there any way to capture the output of respond_to methods output to file?</p>\n\n<p>Thanks in advance !!</p>\n\n<p><em>UPDATE:</em></p>\n\n<p>Using following function to save the xml to file.</p>\n\n<pre><code>def generate_xml\n xml_data = self.to_xml \n file = File.new(\"public/assets/xmls/#{self.id}.xml\", \"w\")\n file.write(xml_data)\n file.close\nend\n</code></pre>\n\n<p>but it only generate the default element, not as specified in show.xml file, which I can get from browser hit.</p>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13029953,"title":"how to implement permissions dynamically?","body":"<p>I am following this tutorial : <a href=\"http://eveloverails.wordpress.com/2011/04/02/183/\" rel=\"nofollow\">How to implement the dynamic authorization with CanCan ?</a></p>\n\n<p>I am making an application which has 5 models </p>\n\n<ol>\n<li>Articles,</li>\n<li>Users,</li>\n<li>Users_type,</li>\n<li>Permissions, and </li>\n<li>user_type_permission </li>\n</ol>\n\n<p>The schema is as follows:</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121020104503) do\n\n  create_table \"articles\", :force =&gt; true do |t|\n    t.string   \"name\"\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  create_table \"permissions\", :force =&gt; true do |t|\n    t.string   \"object_type\"\n    t.string   \"action_name\"\n    t.string   \"description\"\n    t.datetime \"created_at\",  :null =&gt; false\n    t.datetime \"updated_at\",  :null =&gt; false\n  end\n\n  create_table \"user_type_permissions\", :force =&gt; true do |t|\n    t.integer  \"user_type_id\"\n    t.integer  \"permission_id\"\n    t.datetime \"created_at\",    :null =&gt; false\n    t.datetime \"updated_at\",    :null =&gt; false\n  end\n\n  create_table \"user_types\", :force =&gt; true do |t|\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  create_table \"users\", :force =&gt; true do |t|\n    t.string   \"email\",                  :default =&gt; \"\", :null =&gt; false\n    t.string   \"encrypted_password\",     :default =&gt; \"\", :null =&gt; false\n    t.string   \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer  \"sign_in_count\",          :default =&gt; 0\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string   \"current_sign_in_ip\"\n    t.string   \"last_sign_in_ip\"\n    t.datetime \"created_at\",                             :null =&gt; false\n    t.datetime \"updated_at\",                             :null =&gt; false\n    t.string   \"role\"\n  end\n\n  add_index \"users\", [\"email\"], :name =&gt; \"index_users_on_email\", :unique =&gt; true\n  add_index \"users\", [\"reset_password_token\"], :name =&gt;     \"index_users_on_reset_password_token\", :unique =&gt; true\n\nend\n</code></pre>\n\n<p>And the associations is as follows:</p>\n\n<pre><code>PERMISSION MODEL\n\nclass Permissions &lt; ActiveRecord::Base\n  attr_accessible :action_name, :description, :id, :object_type\n  has_many :user_type, :through =&gt; :user_typre_permissions\n  validates_presence_of \"object_type\", :action_name\n  validates_uniqueness_of \"object_type\", :scope =&gt; [:action_name]\nend\n</code></pre>\n\n<p>User model is as follows:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n\n  ROLES = %w[admin other]\n\n  belongs_to :user_type\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me, :role\n  # attr_accessible :title, :body\n\n  def role?(role)\n    return !!self.role.to_s.camelize\n  end\nend\n</code></pre>\n\n<p>user_type_permission model is as follows:</p>\n\n<pre><code>class UserTypePermissions &lt; ActiveRecord::Base\n  attr_accessible :id, :permission_id, :user_type_id\nend\n</code></pre>\n\n<p>user_types model is as follows</p>\n\n<pre><code>class UserTypes &lt; ActiveRecord::Base\n  # attr_accessible :title, :body\n  has_many :users\n  has_many :permissions, :through =&gt; :user_type_permissions \nend\n</code></pre>\n\n<p>article model is as follows:</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\n  attr_accessible :name\nend\n</code></pre>\n\n<p>Ability class is as follows: </p>\n\n<pre><code>class Ability\n  include CanCan::Ability\n\n  def initialize(user)\n    user ||= User.new # guest user\n\n    if user.role? :admin\n      can :manage, Article\n      can :manage, User\n    else\n      user.user_type.permissions.each do |permission|\n        can permission.action_name.to_sym, permission.object_type.constantize\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Permissions Controller is as follows:</p>\n\n<pre><code>class PermissionsController &lt; ApplicationController\n  def index\n    @permission=Permissions.all\n  end\n\n  def edit\n    @permission = Permissions.find(params[:id])\n  end\n\n  def update\n    @permission = Permissions.find(params[:id])\n    respond_to do |format|\n      if @permission.update_attributes(params[:article])\n        format.html { redirect_to @permission, notice: 'Permission was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @permission.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def show\n    @permission = Permissions.find(params[:id])\n  end\n\n  def destroy\n    @permission = Permissions.find(params[:id])\n    @permission.destroy\n\n    respond_to do |format|\n      format.html { redirect_to permissions_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>its working is like when the user login as as admin it will have the links of list of users and the list of articles when it click on the list of users link he will have the list of registered users with four link edit,show destroy and settings.Now what i want is when the admin click on the settings link of the particular user it will have the permissions of that user and also admin can edit the permissions through check box</p>\n\n<p>here is the view of the permission </p>\n\n<pre><code>&lt;h1&gt;Listing Permisions&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Id&lt;/th&gt;\n    &lt;th&gt;Object_type&lt;/th&gt;\n    &lt;th&gt;Action_name&lt;/th&gt;\n    &lt;th&gt;Description&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;% @permission.each do |permission| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= permission.id%&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.object_type %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.action_name %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.description %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Show', permission %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Edit', edit_permission_path(permission) %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Destroy', permission, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>The problem with this permission view is that it is printing all the permissions in the permission model</p>\n\n<p>The users view is as given below:</p>\n\n<pre><code>&lt;h1&gt;Users&lt;/h1&gt;\n&lt;table&gt;\n  &lt;% @users.each do |user| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= link_to user.email, users_path %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Show', user %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Edit', edit_user_registration_path(user) %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Settings', permissions_path %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>May be it is the problem of association???</p>\n\n<p>Any help would be appreciated...\nThanks</p>\n"},{"tags":["javascript","jquery","ruby","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13087051,"title":"Download file data with AJAX request - ruby on rails 3","body":"<p>I recently learned that I can't download more than 1 file with a single HTTP request in ruby on rails except I do it with AJAX request. I'm now trying to figure out how to do that.</p>\n\n<p>(I'm using Prawn as PDF creator with Ruby on RAils 3)\nI have an action in my controller that render a PDF and use send_data</p>\n\n<pre><code>def download_quote          \npdf = QuotesPdf.new(params)\nsend_data pdf.render, filename: \"foo.pdf\",\n                    type: \"application/pdf\",\n                    disposition: \"download\"\nend\n</code></pre>\n\n<p>Then I have a button in my HTML view that has this working Jscript code</p>\n\n<pre><code>// AJAX, download\nfunction ajaxRequest(){\n    $.ajax({\n      type: 'POST',\n      url: '/download_quote/126',\n      success: function(data){\n        alert(data);\n      }\n    });\n    return false;\n  }\n\n  $(\"#mydownload\").click(ajaxRequest);\n</code></pre>\n\n<p>When I click \"#mydownload\" after few seconds took for rendering PDF, I receive a successful alertbox with inside data, I think, all the PDF file.</p>\n\n<p>Question is: How can I transform data in a pdf file and automatically download it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sqlite3","pg"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":57,"score":1,"question_id":13086073,"title":"I have some trouble with migrate from sqlite3 to pg on rails","body":"<pre><code>$ sudo bundle install\n</code></pre>\n\n<p>Result</p>\n\n<pre><code>Fetching gem metadata from https://rubygems.org/...........\nFetching gem metadata from https://rubygems.org/..\nUsing rake (0.9.2.2) \nUsing i18n (0.6.1) \nUsing multi_json (1.3.6) \nUsing activesupport (3.2.8) \nUsing builder (3.0.4) \nUsing activemodel (3.2.8) \nUsing erubis (2.7.0) \nUsing journey (1.0.4) \nUsing rack (1.4.1) \nUsing rack-cache (1.2) \nUsing rack-test (0.6.2) \nUsing hike (1.2.1) \nUsing tilt (1.3.3) \nUsing sprockets (2.1.3) \nUsing actionpack (3.2.8) \nUsing mime-types (1.19) \nUsing polyglot (0.3.3) \nUsing treetop (1.4.11) \nUsing mail (2.4.4) \nUsing actionmailer (3.2.8) \nUsing arel (3.0.2) \nUsing tzinfo (0.3.33) \nUsing activerecord (3.2.8) \nUsing activeresource (3.2.8) \nUsing bundler (1.2.1) \nUsing coffee-script-source (1.4.0) \nUsing execjs (1.4.0) \nUsing coffee-script (2.2.0) \nUsing rack-ssl (1.3.2) \nUsing json (1.7.5) \nUsing rdoc (3.12) \nUsing thor (0.16.0) \nUsing railties (3.2.8) \nUsing coffee-rails (3.2.2) \nUsing jquery-rails (2.1.3) \nInstalling pg (0.14.1) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /usr/bin/ruby1.8 extconf.rb \nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/ruby1.8\n    --with-pg\n    --without-pg\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n\nGem files will remain installed in /var/lib/gems/1.8/gems/pg-0.14.1 for inspection.\nResults logged to /var/lib/gems/1.8/gems/pg-0.14.1/ext/gem_make.out\nAn error occurred while installing pg (0.14.1), and Bundler cannot continue.\nMake sure that `gem install pg -v '0.14.1'` succeeds before bundling.\n</code></pre>\n\n<p>I am make <code>$ gem install pg -v '0.14.1'</code> But this is not help</p>\n\n<p>My Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\n#gem 'rails', '3.0.9'\n\n#gem 'sqlite3', '1.3.6', :group =&gt; :development\n\n\ngem 'rails', '3.2.8'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\n\ngem 'sqlite3'\ngem 'pg'\ngem 'taps'\n\ngem 'json'\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\n\n\n#group :production do\n  #gem 'pg'\n#end\n#group :development do\n  #gem 'sqlite3'\n#end\n</code></pre>\n\n<p>gem_make.out</p>\n\n<pre><code>/usr/bin/ruby1.8 extconf.rb \nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/ruby1.8\n    --with-pg\n    --without-pg\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n</code></pre>\n\n<p>mkmf.log</p>\n\n<pre><code>find_executable: checking for pg_config... -------------------- yes\n\n--------------------\n\nfind_header: checking for libpq-fe.h... -------------------- no\n\n\"gcc -E -I. -I/usr/lib/ruby/1.8/i686-linux -I. -D_FORTIFY_SOURCE=2 -D_FILE_OFFSET_BITS=64 -D_FORTIFY_SOURCE=2 -I -fno-strict-aliasing -g -g -O2  -fPIC    conftest.c -o conftest.i\"\nconftest.c:1:22: fatal error: libpq-fe.h: No such file or directory\ncompilation terminated.\nchecked program was:\n/* begin */\n1: #include &lt;libpq-fe.h&gt;\n/* end */\n\n--------------------\n</code></pre>\n\n<p>Help me please. Thank you.</p>\n\n<p>Sorry for this text.\nYour post does not have much context to explain the code sections; please explain your scenario more clearly.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13085131,"title":"Join scope in Rails 3","body":"<p>I'd like to write a Rails 3 scope, on Client, to do the following:</p>\n\n<pre><code>select * from clients c, dependents d\nwhere d.last_name like '%ss%' and c.id = d.client_id;\n</code></pre>\n\n<p>Dependent model:</p>\n\n<pre><code>class Dependent &lt; ActiveRecord::Base\n  belongs_to :client\n  scope :by_last_name, (lambda do |name| { :conditions =&gt; ['last_name LIKE ?', \"#{name}%\"]} end )\n</code></pre>\n\n<p>Client model:</p>\n\n<pre><code>class Client &lt; ActiveRecord::Base\n  has_many :dependents, :dependent =&gt; :destroy\n</code></pre>\n\n<p>I have not yet been able to get a scope join to work syntactically. The dependent's last name needs to be passed in as a parameter.\nThanks.</p>\n"},{"tags":["ruby-on-rails-3","routes","omniauth"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":165,"score":0,"question_id":7923463,"title":"Omniauth can't find route","body":"<p>I'm trying to implement Omniauth with my Rails 3 app. I followed the tutorial from the <a href=\"http://railscasts.com/episodes/235-omniauth-part-1?view=comments\" rel=\"nofollow\">Railscast episod 205</a>, but can't get it to work. When I call the '/auth/twitter' (it doesn't work with any provider) Rails complains it can't find the appropriate route (it tries to load my default route).</p>\n\n<p>I added omniauth.rb under <code>config/initializers/</code>, put <code>gem 'omniauth'</code> in my Gemfile, and ran bundle install.</p>\n\n<p>I'm not sure how to debug this problem nor what information to provide to help understand the problem.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","actionmailer"],"answer_count":3,"favorite_count":5,"up_vote_count":8,"down_vote_count":0,"view_count":2308,"score":8,"question_id":4868205,"title":"Rails - Mail, getting the body as Plain Text","body":"<p>Given: <code>message = Mail.new(params[:message])</code></p>\n\n<p>as seen here: <a href=\"http://docs.heroku.com/cloudmailin\" rel=\"nofollow\">http://docs.heroku.com/cloudmailin</a></p>\n\n<p>It shows how to get the message.body as HTML, how to do you get the plain/text version?</p>\n\n<p>Thanks</p>\n"},{"tags":["javascript","jquery","ruby","ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13081795,"title":"Page reload from controller rails 3?","body":"<p>I want to redirect a user to login page if his/her session is timeout. How can I redirect my user to login page if user click on any link of my web page. And link can be a ajax call or page reload call.  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2482,"score":4,"question_id":7753021,"title":"Syntax error when creating a Rails model","body":"<p>I am creating Car model in Rails 3 by using command:</p>\n\n<pre><code>rails generate model Car name:string id_str:string\n</code></pre>\n\n<p>but I got the error:</p>\n\n<pre><code>/home/XX/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.1.1/lib/active_support/dependencies.rb:234:in `load': /home/XX/myapp/config/initializers/session_store.rb:3: syntax error, unexpected ':', expecting $end (SyntaxError)\n...sion_store :cookie_store, key: '_myapp_session'\n</code></pre>\n\n<p>why?</p>\n\n<p>my <code>session_store.rb</code></p>\n\n<pre><code>Myapp::Application.config.session_store :cookie_store, key: '_myapp_session'\n</code></pre>\n\n<p>What's wrong with my <code>session_store.rb</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","caching","memcached"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13079125,"title":"Memcached dynamic feed?","body":"<p>I have a dynamic feed of events from users that are being followed by the current user, the partials are all memcached, but I'd also like to do it for the feed itself. My concern is that if I memcache this that it will show the same thing for every user based on the first write to cache rather than being dynamic for each unique user. </p>\n\n<p>How would I memcache the feed and @following? How do I have it update if the current user follows another user? I'm assuming I can't just wrap it with a &lt;% cache \"feed\" do %></p>\n\n<p>NOTE: using Memcached and Dalli</p>\n\n<pre><code>&lt;% @following = current_user.following.collect {|f| f[\"id\"]} %&gt;\n&lt;div class='content'&gt;\n&lt;% unless Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", Time.now, Time.now.strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }.count == 0 %&gt;\n          &lt;div class='date_bar_container'&gt;&lt;div class='date_bar'&gt;Today&lt;/div&gt;&lt;/div&gt;\n          &lt;div class='content_wrapper'&gt;\n    &lt;%= render :partial =&gt; 'events/event', :collection =&gt; Event.where(:id =&gt;  Rsvp.where(:event_id =&gt; Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", Time.now.strftime('%Y-%m-%d 00:00:00.000000'), Time.now.strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }).select(\"DISTINCT event_id\").collect(&amp;:event_id)).order('start_time asc')%&gt;\n          &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;% unless Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", (Time.now + 1.day).strftime('%Y-%m-%d 00:00:00.000000'), (Time.now + 1.day).strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }.count == 0%&gt;\n          &lt;div class='date_bar_container'&gt;&lt;div class='date_bar'&gt;Tomorrow&lt;/div&gt;&lt;/div&gt;\n          &lt;div class='content_wrapper'&gt;\n    &lt;%= render :partial =&gt; 'events/event', :collection =&gt; Event.where(:id =&gt;  Rsvp.where(:event_id =&gt; Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", (Time.now + 1.day).strftime('%Y-%m-%d 00:00:00.000000'), (Time.now + 1.day).strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }).select(\"DISTINCT event_id\").collect(&amp;:event_id)).order('start_time asc')%&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n\n&lt;% (2..15).each do |f| %&gt;\n    &lt;% unless Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", (Time.now + f.day).strftime('%Y-%m-%d 00:00:00.000000'), (Time.now + f.day).strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }.count == 0 %&gt;\n              &lt;div class='date_bar_container'&gt;&lt;div class='date_bar'&gt;&lt;%= dayofweek((Time.now + f.day).wday) %&gt;, &lt;%= month((Time.now + f.day).month) %&gt; &lt;%= (Time.now + f.day).day %&gt;, 2012&lt;/div&gt;&lt;/div&gt;\n              &lt;div class='content_wrapper'&gt;\n        &lt;%= render :partial =&gt; 'events/event', :collection =&gt; Event.where(:id =&gt;  Rsvp.where(:event_id =&gt; Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", (Time.now + f.day).strftime('%Y-%m-%d 00:00:00.000000'), (Time.now + f.day).strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }).select(\"DISTINCT event_id\").collect(&amp;:event_id)).order('start_time asc')%&gt;\n         &lt;/div&gt;\n        &lt;% end %&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rake"],"answer_count":4,"favorite_count":17,"up_vote_count":63,"down_vote_count":0,"view_count":18337,"score":63,"question_id":4116067,"title":"Purge or recreate a Ruby on Rails database","body":"<p>I have a dev Ruby on Rails database full of data. I want to delete everything and rebuild the database. I'm thinking of using something like:</p>\n\n<pre><code>rake db:recreate\n</code></pre>\n\n<p>Is this possible?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13075461,"title":"Routes with optional params in Rails","body":"<p>I'm trying to setup a route that looks like this: <code>acme.com/posts/:category/:status</code>. Both <code>:category</code> and <code>:status</code> are optional. I wrote many variations, but none worked:</p>\n\n<pre><code>resources :posts do\n  match '(/:category)(/:status)', to: 'posts#index', as: 'filter', on: :collection\nend\n\n# Category Links\nlink_to \"Questions\", filter_posts_path(:questions)\nlink_to \"Suggestions\", filter_posts_path(:suggestions)\n\n# Status Links\nlink_to \"Published\", filter_posts_path(params[:category], :published)\nlink_to \"Draft\", filter_posts_path(params[:category], :draft)\n</code></pre>\n\n<p>The idea is to be able to <em>1) filter by category</em>, <em>2) filter by status</em>, <em>and 3) filter by both category and status if both are available</em>. The current setup has also broken my <code>/posts/new</code> path, always redirecting to <code>posts#index</code>.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13083068,"title":"Routing error in rails","body":"<p>In my controller I have </p>\n\n<pre><code>def update_project_dates\n  p \"It is end date.....\"\n  @user=User.find(params[:user])\n  @projects=Project.find_all_by_user_id(@user)\nend\n</code></pre>\n\n<p>In the view page (only some part of the code is copied and pasted)</p>\n\n<pre><code>eventDrop: function() \n{ \n  $.ajax({\n    url:'/update_project_dates/',\n    success:function(data)\n    {\n    alert(\"Hello\");\n    }\n  })\n},\n</code></pre>\n\n<p>In my routes.rb I have mentioned</p>\n\n<pre><code>match '/update_project_dates' =&gt; 'users#update_project_dates', :method=&gt; :get\nget 'update_project_dates'\n</code></pre>\n\n<p>But When the ajax request goes, I get the routing error as</p>\n\n<blockquote>\n  <h1>Routing Error</h1>\n  \n  <p><pre>uninitialized constant UsersController</pre></p>\n</blockquote>\n\n<p>Where am I doing wrong here...Please help..</p>\n"},{"tags":["ruby-on-rails-3","authentication","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13020961,"title":"Rails Devise Conditional authentication_keys","body":"<p>Is there any way of making the authentication_keys configuration conditional depending on the user type?</p>\n\n<p>For instance in my User model I have two different user, standard user and student, defined by the value of a bitmask attribute. I want to authenticate Students on the basis of username and school_id. Standard users don't have to have a value for school_id. In order to accommodate this I have two types of login screens, one for students and another for standard users. The student login screen has a hidden school_id field that authenticates them to their school.</p>\n\n<p>In my devise configuration file I have:</p>\n\n<pre><code>config.authentication_keys = [ :username, :school_id ] \n</code></pre>\n\n<p>However with this setup standard users are unable to login, my guess is that it's expecting a school_id for all Users being authenticated. Is it possible to make the authentication keys conditional? Or give an allow_blank option for school_id? I want to be able to keep standard users and students in the same model. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13067382,"title":"Devise: user has to login again each time he closes the browser","body":"<p>I'm using Devise and Omniauth for user authentication.</p>\n\n<p>I want the users to stay signed in for 2 weeks after the authentication. However, whenever the user closes the browser window and reopen it, he gets the login screen again.</p>\n\n<p>What is the correct configuration for the user to stay connected even after the browser was closed and re-opened?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","login","devise","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13079079,"title":"How to put a login form in the header for Devise and Rails","body":"<p>I want to put a login form in the header of my website. I use Rails 3.2.8 and the latest Devise. In the <code>app/views/devise/sessions/new.html.erb</code> file a login form is created with:</p>\n\n<pre><code>  &lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; session_path(resource_name), :html =&gt; {:class =&gt; 'main'}) do |f| %&gt;\n    &lt;div&gt;&lt;%= f.label :login %&gt; &lt;%= f.text_field :login, :placeholder =&gt; 'Enter username' %&gt;&lt;/div&gt;\n    &lt;div&gt;&lt;%= f.label :password %&gt; &lt;%= f.password_field :password, :placeholder =&gt; 'Enter password' %&gt;&lt;/div&gt;\n    &lt;% if devise_mapping.rememberable? -%&gt;\n      &lt;div&gt;&lt;%= f.check_box :remember_me %&gt; &lt;%= f.label :remember_me %&gt;&lt;/div&gt;\n    &lt;% end -%&gt;\n    &lt;%= f.submit \"Go\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>If I try to copy that code and put it in my <code>application.html.erb</code>, I get an error regarding that resource variable referenced above:</p>\n\n<pre><code>undefined local variable or method `resource' for #&lt;#&lt;Class:0x3cb62c8&gt;:0x3c73b00&gt;\n</code></pre>\n\n<p>So can I just use a normal rails form with <code>/users/sign_in</code> as the action? How do I tell devise where to redirect to after logging in?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":317,"score":5,"question_id":5559980,"title":"What's the best way to do integration testing for a Javascript heavy UI in a rails app?","body":"<p>We have a web application that makes extensive use of AJAXy Javascript in the UI. We have nearly complete code coverage of our backend using Shoulda and Webrat, and would like to extend our test suite to include full integration testing through the Javascript UI.</p>\n\n<p>We tried Selenium but found it brittle and temperamental. Are there more reliable options?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>For those still checking this out, we ended up using Xvfb so we can run Firefox without a screen. Allows us to run the test on a headless Jenkins CI server. We still have to run tests \"live\" locally occasionally to debug, but it works pretty well.</p>\n"},{"tags":["mysql","ruby-on-rails","osx","ruby-on-rails-3"],"answer_count":8,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":5917,"score":4,"question_id":4545701,"title":"'undefined method init for Mysql:Class'","body":"<p>I've been having problems with a MySQL Server installation that got messed up after a power outage. </p>\n\n<h3>Configuration</h3>\n\n<p>Intel i5 Mac running OS X 10.6.5<br>\nRuby 1.9.2 installed<br>\nRails 3.0.1 installed<br>\nMySQL Server (finally) installed and running<br>\nI completely reinstalled MySQL, which deleted the local development/test/production databases. So, I have run <code>create database development;</code> in MySQL to get the dev database ready for a migration.</p>\n\n<h3>Current Goal</h3>\n\n<ul>\n<li>Run <code>rake db:migrate</code> to get my databases back again. (I cannot currently access my databases or Mysql at all from Rails.)</li>\n</ul>\n\n<h3>Error</h3>\n\n<p>Using the gem <code>'mysql', '2.8.1'</code> and run <code>rake db:migrate</code>, I get the error:</p>\n\n<pre><code>rake aborted!\nundefined method 'init' for Mysql:Class\n</code></pre>\n\n<p>Stack Trace:</p>\n\n<pre><code>/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/mysql_adapter.rb:30:in 'mysql_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:230:in 'new_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:238:in 'checkout_new_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:194:in 'block (2 levels) in checkout'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:190:in 'loop'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:190:in 'block in checkout'\n/Users/sscirrus/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/monitor.rb:201:in 'mon_synchronize'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:189:in 'checkout'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:96:in 'connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:318:in 'retrieve_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_specification.rb:97:in 'retrieve_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_specification.rb:89:in 'connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/migration.rb:486:in 'initialize'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/migration.rb:433:in 'new'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/migration.rb:433:in 'up'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/migration.rb:415:in 'migrate'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/railties/databases.rake:142:in 'block (2 levels) in &lt;top (required)&gt;'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:636:in 'call'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:636:in 'block in execute'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:631:in 'each'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:631:in 'execute'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:597:in 'block in invoke_with_call_chain'\n/Users/sscirrus/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/monitor.rb:201:in 'mon_synchronize'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:590:in 'invoke_with_call_chain'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:583:in 'invoke'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2051:in 'invoke_task'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2029:in 'block (2 levels) in top_level'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2029:in 'each'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2029:in 'block in top_level'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2068:in 'standard_exception_handling'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2023:in 'top_level'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2001:in 'block in run'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2068:in 'standard_exception_handling'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:1998:in 'run'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/bin/rake:31:in '&lt;top (required)&gt;'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/bin/rake:19:in 'load'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/bin/rake:19:in '&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13083757,"title":"Dynamic Canonical URL","body":"<p>Just implemented canonical url feature in my site.</p>\n\n<p>ApplicationController</p>\n\n<pre><code>def canonical_url(canonical_url)\n    @canonical_url = canonical_url\nend\n</code></pre>\n\n<p>ApplicationHelper</p>\n\n<pre><code>def canonical_link_tag\n    tag(:link, :rel =&gt; :canonical, :href =&gt; @canonical_url) if @canonical_url\nend\n</code></pre>\n\n<p>application.html.haml</p>\n\n<pre><code>= canonical_link_tag\n</code></pre>\n\n<p>HousesController</p>\n\n<pre><code>def show \n  @house = House.find(params[:id])\n  canonical_url(house_url(@house))\nend\n</code></pre>\n\n<p>In some cases the location of the houses are the same. So i write one piece of location/area content and link from other houses in the same area (canonical) to the source content. </p>\n\n<p>An example what i want to realize:</p>\n\n<p>House A</p>\n\n<pre><code>page: /en/holidayrentals/house_A/location\ncanonical: &lt;link href=\"/en/holidayrentals/house_A/location\" rel=\"canonical\" /&gt; \n</code></pre>\n\n<p>House B</p>\n\n<pre><code>page: /en/holidayrentals/house_B/location\ncanonical: &lt;link href=\"/en/holidayrentals/house_A/location\" rel=\"canonical\" /&gt; \n</code></pre>\n\n<p>House C</p>\n\n<pre><code>page: /en/holidayrentals/house_C/location\ncanonical: &lt;link href=\"/en/holidayrentals/house_A/location\" rel=\"canonical\" /&gt; \n</code></pre>\n\n<p>What's the best approach is this case...cases/conditions in the view? Extra attribute in de DB? </p>\n\n<p>Ciao..remco</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":955,"score":2,"question_id":9624601,"title":"ActiveRecord Find By Year, Day or Month on a Date field","body":"<p>I have an ActiveRecord model that has a date attribute.  Is it possible to utilize that date attribute to find by Year, Day and Month:</p>\n\n<pre><code>Model.find_by_year(2012)\nModel.find_by_month(12)\nModel.find_by_day(1)\n</code></pre>\n\n<p>or is it simply possible to find_by_date(2012-12-1).</p>\n\n<p>I was hoping I could avoid creating Year, Month and Day attributes. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13082860,"title":"updating data in database on save","body":"<p>I'm trying to update data in database using after_create callback\nI wrote </p>\n\n<pre><code>Dm::Advertisement.where (:type =&gt; Dm::Advertisement).update_all(ads_counter: 0)\n</code></pre>\n\n<p>in my model , but have SyntaxError. Can anyone point me where i did mistake?</p>\n"},{"tags":["ruby-on-rails-3","facebook","facebooker2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":378,"score":0,"question_id":8824028,"title":"getting \"Uncaught TypeError: Cannot call method 'replace' of undefined\" when doing FB.init using Facebooker2","body":"<p>I am using Facebooker2 to create a Facebook IFrame application, which is running as a tab inside a Facebook page.</p>\n\n<p>My goal is to be able to use the social plugins, such as a like button and comments, etc. I tried to define them as follows</p>\n\n<pre><code>&lt;div class=\"fb-like\" data-href=\"http://www.myurl.com\" data-send=\"false\" data-layout=\"button_count\" data-width=\"450\" data-show-faces=\"false\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>and trying to initialize the FB JS SDK by calling</p>\n\n<pre><code>&lt;%= fb_connect_async_js %&gt;\n</code></pre>\n\n<p>which outputs</p>\n\n<pre><code>&lt;div id=\"fb-root\"&gt;&lt;script async=\"\" src=\"http://connect.facebook.net/en_US/all.js\"&gt;&lt;/script&gt;&lt;/div&gt;\n      &lt;script&gt;\n        window.fbAsyncInit = function() {\n          FB.init({\n            appId  : 'APP_ID',\n            status : true, // check login status\n            cookie : true, // enable cookies to allow the server to access the session\n            oauth : true,\n            xfbml  : true  // parse XFBML\n          });\n\n        };\n\n        (function() {\n          var e = document.createElement('script'); e.async = true;\n          e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';\n          document.getElementById('fb-root').appendChild(e);\n        }());\n      &lt;/script&gt;\n</code></pre>\n\n<p>This has worked before, and stopped working after Facebook pushed their last platform update about a month ago. Now the Like button is not being rendered at all. I also tried the XFBML approach, no luck.</p>\n\n<p>note: I am able to publish feeds using FB.publish, and I am also able to create a like button using the IFrame method.</p>\n\n<p>I looked at the documentation and didn't see anywhere where it was mentioned that Social plugins cannot be used inside IFrame apps.</p>\n\n<p>any ideas anyone?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13082173,"title":"Finding folder sizes if i have hierarchy of folders?","body":"<p>I am trying to get the folder sizes exactly..\nmy folders are arranged like this</p>\n\n<p><img src=\"http://i.stack.imgur.com/1Ucg4.png\" alt=\"folder structure\"></p>\n\n<p>m using parent_folder_id for all the folders. if the folder is root folder parent_folder_id is nil. For sub folder parent_folder_id is successive folder/sub folder id. \nNow i want to display the folder sizes exactly i.e including the sub folder sizes. As its a unlimited hierarchy, i am little bit confusing to loop. i want to display sub folder sizes also. </p>\n\n<p>Can any one suggest me the solution.\nThanks in advance..</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13076944,"title":"How to handle each iterator?","body":"<p>I want to print the values taken from two different tables in the database in a table on the view page. I am not getting how to handle two each iterators as it is behaving abnormally i.e Printing a value several times. I am very much confused. Please help.</p>\n\n<p>Here is my code</p>\n\n<p>In the controller:</p>\n\n<pre><code>class ListController &lt; ApplicationController\n\n  def all\n    @books = Book.all   \n    @susers = SUser.all    \n  end\nend\n</code></pre>\n\n<p>In my view page</p>\n\n<pre><code>&lt;tbody&gt;                     \n  &lt;% @books.each do |b| %&gt;\n    &lt;% if b.branch == \"I.T\" %&gt;                                      \n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= b.id %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= b.book_name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= b.year %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= b.user_id %&gt;&lt;/td&gt;    \n\n        &lt;% @susers.each do |s| %&gt;                   \n          &lt;% if s.user_id == b.user_id %&gt;\n            &lt;td&gt;&lt;%= s.address %&gt;&lt;/td&gt;\n          &lt;% else %&gt;\n            &lt;td&gt;Error..!!&lt;/td&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;                       \n      &lt;/tr&gt; \n    &lt;% else %&gt;\n      &lt;% puts \"No any book of this branch\" %&gt;   \n    &lt;% end %&gt;                                       \n  &lt;% end %&gt;                                 \n&lt;/tbody&gt;\n</code></pre>\n\n<p>The output is displayed like this</p>\n\n<p>The <code>else</code> part of the first <code>if</code> statement is repeating it self again and again. I dont know why it is happening?<img src=\"http://i.stack.imgur.com/dYoT7.png\" alt=\"You can see the error part printing four times since the book table has 4 books in the database.\"></p>\n\n<p>There are 3 models in this project. \n1. User - Made by devise\n2. Book \n3. SUser </p>\n\n<p>One important thing: -\nActually i made SUser model because i want to store user's personal details such as name, address, phone no. I dont want to touch devise model (User) so i made another model SUser which has one to one relation with devise model(User). </p>\n\n<p>User model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n  has_and_belongs_to_many :books\n  has_one :s_user\n  devise :database_authenticatable, :registerable,\n       :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me\n  # attr_accessible :title, :body\n\nend\n</code></pre>\n\n<p>Book Model:</p>\n\n<pre><code>class Book &lt; ActiveRecord::Base\n  # attr_accessible :title, :body\n  has_and_belongs_to_many :users\n  belongs_to :s_user, :class_name =&gt; \"SUser\"\n  attr_accessible :id, :user_id, :book_name, :edition, :author, :branch, :publisher,      :year, :details \nend\n</code></pre>\n\n<p>SUser model:</p>\n\n<pre><code>class SUser &lt; ActiveRecord::Base\n  # attr_accessible :title, :body\n  has_one :user\n  has_many :books\n  attr_accessible :user_id, :fullname, :email, :address, :details \nend\n</code></pre>\n\n<p>Migrations files:</p>\n\n<pre><code>class CreateBooks &lt; ActiveRecord::Migration\n  def change\n    create_table :books do |t|\n    t.integer \"user_id\", :limit =&gt;5\n    t.string \"book_name\", :limit =&gt; 50\n    t.integer \"edition\", :limit =&gt; 5\n    t.string \"author\", :limit =&gt; 30\n    t.string \"branch\", :limit =&gt; 30\n    t.string \"publisher\", :limit =&gt; 50\n    t.integer \"year\", :limit =&gt; 10     \n    t.text \"details\"\n    t.timestamps\n  end\n  add_index :books, \"user_id\"\n end\nend\n</code></pre>\n\n<p>SUser migration file</p>\n\n<pre><code>class CreateSUsers &lt; ActiveRecord::Migration\n def change\n  create_table :s_users do |t|\n    t.integer \"user_id\", :limit =&gt; 5\n    t.string \"fullname\", :limit =&gt; 25            \n    t.string \"email\", :default =&gt; \"\", :null =&gt; false\n    t.string \"hashed_password\", :limit =&gt; 40\n    t.string \"salt\", :limit =&gt; 40\n    t.string \"address\",:limit =&gt; 25\n    t.text \"details\"\n    t.timestamps\n  end\n  add_index :s_users, \"user_id\"\n end\nend\n</code></pre>\n\n<p>I made many to many relationship between user and book since one user have many books and one book can be available to many users.\nSo i made a simple join table for many to many association</p>\n\n<pre><code>class CreateBooksUsersJoin &lt; ActiveRecord::Migration\n def up\n   create_table :books_users, :id =&gt; false do |t|\n     t.integer \"book_id\"\n     t.integer \"user_id\"\n   end\n  add_index :books_users, [\"book_id\", \"user_id\"]\n end\n\n def down\n  drop_table :book_users\n end\nend\n</code></pre>\n\n<p>Lol.. I have pasted my whole code over here. Actually i am new to rails.. Please guide me if you find any other flaw to this code.\nThanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13080933,"title":"Ruby on Rails - The way to define answers is true / false in model Answer","body":"<p>I'm building an online test app. In my app, one question can be a True/False question, Single choice (only one answer is accepted), Multi choice (many answers are accepted). I create models:  </p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  has_many :answers\nend\n\nclass Answer &lt; ActiveRecord::Base\n  belongs_to :question\nend  \n</code></pre>\n\n<p>The Question model will have a <code>question_type_id</code> to check it is a T/F, Single or Multi choice. </p>\n\n<p>The Answer model will have a column called <code>content</code> typed text, and i will have a boolean column called <code>correct</code> to know which answer is accepted. With single and multi choice questions, i think answers are text will be fine to store in <code>content</code> column, but with True/False question, is it good idea if i only store answers is text like 'True', 'False' in <code>content</code> column and set a True for answer is accepted in <code>correct</code> column? I don't know another better way to deal with True/False question, can anybody help me?</p>\n"},{"tags":["ruby-on-rails-3","configuration","heroku","asset-pipeline"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13077564,"title":"deploying to heroku asset pipeline Sprockets::fileNotFound","body":"<p>I'm trying to deploy my app to heroku. Heroku did not load my js and css files \nI ran RAILS_ENV=production bundle exec rake assets:precompile\nand it still was not working. </p>\n\n<p>then I ran\nheroku rake assets:precompile </p>\n\n<p>I get this error in Heroku logs: </p>\n\n<pre><code>Error compiling asset application.css:\n Sprockets::FileNotFound: couldn't find file 'jquery.ui.datepicker'\n (in /app/app/assets/stylesheets/application.css.scss:13)\n\nServed asset /application-989f5e5266d9b066eb316183d7db5c77.css - 500 Internal Server Error\n\n\n Error compiling asset application.js:\n Sprockets::FileNotFound: couldn't find file 'jquery.ui.datepicker'\n (in /app/app/assets/javascripts/application.js:16)\nServed asset /application-d81c946c6f47242e5e97de9bca4938be.js - 500 Internal Server Error\n</code></pre>\n\n<p>config production.rb: </p>\n\n<pre><code>config.cache_classes = true\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n  config.serve_static_assets = true\n  config.assets.compress = true\n  config.assets.compile = true\n  config.assets.initialize_on_precompile = false\n\n  config.assets.digest = true\n</code></pre>\n\n<p>IN ASSETS\napplication.css.scss</p>\n\n<pre><code> *= require_self\n *= require bootstrap_and_overrides\n *= require jquery.ui.datepicker\n *= require bootstrap-timepicker\n *= require jquery.fileupload-ui\n *= require_tree .\n*/\n</code></pre>\n\n<p>application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require twitter/bootstrap\n//= require jquery.ui.datepicker\n//= require bootstrap-timepicker\n//= require jquery-fileupload/basic\n//= require jquery-fileupload/vendor/tmpl\n//= require_tree .\n</code></pre>\n\n<p>Any idea how to fix this? thanks in advance for all your help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13079813,"title":"undefined method `text?' for nil:NilClass Validate uniqness rails3 ruby 187","body":"<p>I just updated from rails 2.3 to 3, i'm trying to replace this old method with something cleaner, because it's outputting the model and field name, wtf!</p>\n\n<p><img src=\"http://i.stack.imgur.com/WpomS.jpg\" alt=\"enter image description here\"></p>\n\n<p>However I get the above error when calling <strong>validates_uniqueness_of</strong> (the presence works fine).  I passed in the primary id scope, and still get it.  Any help is welcome. </p>\n\n<pre><code>   def validate\n     if org_name.blank?\n       errors.add(:org_name, :blank, :default =&gt; nil)\n     else\n       if (org = Organization.find_by_org_name(org_name)) &amp;&amp; org != self\n         errors.add(:org_name, :taken, :default =&gt; nil, :value =&gt; org_name)\n       end\n     end\n   end\n</code></pre>\n\n<p>to</p>\n\n<pre><code>validates :org_name, :presence =&gt; true\n  validates_uniqueness_of :org_name, :scope =&gt; :org_id\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","will-paginate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13074792,"title":"will_paginate not using current route","body":"<p>We're using will_paginate to display associations of a model. We have some custom routes set up like so:</p>\n\n<pre><code>get '/profile/:slug' =&gt; 'talents#show', :as =&gt; :talent\nget '/profile/:slug/bio' =&gt; 'talents#show', :as =&gt; :talent_bio\nget '/profile/:slug/instagram' =&gt; 'talents#show', :as =&gt; :talent_instagram\n</code></pre>\n\n<p>When we're using talent_instagram route, all pagination links are rendered to the default route instead. That is, instead of:</p>\n\n<pre><code>http:://0.0.0.0:3000/profile/some-talent/instagram?page=5\n</code></pre>\n\n<p>This is what we get:</p>\n\n<pre><code>http:://0.0.0.0:3000/profile/some-talent?page=5\n</code></pre>\n\n<p>If I comment out the first two routes, then the correct link is used. Why is will_paginate defaulting to the first route?</p>\n"},{"tags":["ruby","ruby-on-rails-3","partial-views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13080159,"title":"Rails 3 - Partial Not Rendering","body":"<p>In my view I have the following:</p>\n\n<pre><code>&lt;div class=\"subject edit\"&gt;\n&lt;%= form_for(:subject, :url =&gt; {:action =&gt; 'update', :id =&gt; @subject.id}) do |f| %&gt;\n\n&lt;%= render(:partial =&gt; \"form\", :locals =&gt; {:f =&gt; f}) %&gt;\n\n&lt;div class=\"form-buttons\"&gt;\n    &lt;%= submit_tag(\"Update Subject\") %&gt;\n&lt;/div&gt;\n\n\n&lt;% end %&gt;\n</code></pre>\n\n<p></p>\n\n<p>In the same folder I have created a partial (_form.html.erb). But for some reason it is not rendered. </p>\n\n<p>_form.html.erb:</p>\n\n<pre><code>&lt;table summary=\"Subject form fields\"&gt;\n    &lt;tr&gt;\n        &lt;th&gt;Name&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.text_field(:name) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;th&gt;Position&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.text_field(:position) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;th&gt;Visible?&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.text_field(:visible) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n</code></pre>\n\n<p></p>\n\n<p>I'm running rails 3.2.7. Can some see what I'm doing wrong?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","custom-routes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13080092,"title":"custom route for failed login","body":"<p>I have a rails app with a quite standard login system (a session resource with new, create and destroy).</p>\n\n<p>When the authentication fails</p>\n\n<pre><code>render \"new\"\n</code></pre>\n\n<p>and the url in the browser bar changes to domain.com/sessions, however I'd like to keep domain.com/ or if this is not possible to define a custom values, such as \"login\". I have played with my routes file but without success. Here my file:</p>\n\n<pre><code>GK::Application.routes.draw do  \n  root :to =&gt; 'sessions#new', as: 'login'\n  get 'logout', to: 'sessions#destroy', as: 'logout'\n\n  resources :users\n  resources :sessions\nend\n</code></pre>\n\n<p>What do I have to change to make it work?</p>\n\n<p>Thanks and have a nice day.</p>\n"},{"tags":["ruby-on-rails","rspec","integration-testing","ruby-on-rails-3","webrat"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":6949,"score":3,"question_id":2131645,"title":"How rspec works with rails3 for integration-tests?","body":"<p>What I'm trying to ahieve is to do <strong>integration tests with webrat in rails3</strong> like Yehuda does with test-unit in <a href=\"http://pivotallabs.com/talks/76-extending-rails-3\" rel=\"nofollow\">http://pivotallabs.com/talks/76-extending-rails-3</a> minute 34.</p>\n\n<p>an example:</p>\n\n<pre><code>describe SomeApp\n  it \"should show the index page\"\n    visit \"/\"\n    body.should =~ /hello world/\n  end\nend\n</code></pre>\n\n<p>Does someone knows a way to do it?</p>\n"},{"tags":["javascript","html","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13061047,"title":"Adding Javascript in Rails","body":"<p>I'm using Rails 3.0. I want to add a Javascript file <code>show_javascript.js</code> that is in <code>/public/javascripts/</code> to a view <code>show.html.erb</code>. </p>\n\n<p>The <code>show.html.erb</code> file takes the <code>&lt;head&gt;...&lt;/head&gt;</code> part from the template <code>application.html.erb</code></p>\n\n<p>I'm wondering how I should add it.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":10273231,"title":"How to call a method after a view has been rendered in rails 3","body":"<p>I have a task which will take around 20 - 30 seconds. I want this task to run immediately after a view is rendered. I want the output of this task to be stored in a session variable. What is the simplest way to do it rails 3. </p>\n\n<p>To explain what i need exactly. I am showing a list of tweets to users (this is the view rendered) They have to go through them. I want a method to be invoked after this view is rendered which will take the same tweets and cluster them (20-30 seconds process). I should have the results of the clustering in the session so that i can display them in the next page. </p>\n\n<p>How do I do this? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","carrierwave","image-upload"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13078921,"title":"Carrierwave fixtures with web url or object.url without store_dir path","body":"<p>I am uploading images with carrierwave! \nnow in fixtures i have to store some urls(from other websites)\nIs there any way i get the url without store_dir path \nor i can use fixtures where i specify to upload file from url??\nwhenever i run <code>object.url</code> it returns </p>\n\n<p><strong>\"/uploads/deal_image/url/1071381712/https:/encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcT0m2sjy-kyfC8J6SxECrgafDE-7ztWZ05GBqmIrIDKr2AdjotwuQ\"</strong></p>\n\n<p>and i want </p>\n\n<p><strong>https:/encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcT0m2sjy-kyfC8J6SxECrgafDE-7ztWZ05GBqmIrIDKr2AdjotwuQ</strong></p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-plugins","validationengine"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":290,"score":0,"question_id":9107993,"title":"How to enable conditionally validation using ValidationEngine","body":"<p>I am using ValidationEngine for client side validation. I have a scenario</p>\n\n<p>In my form I have 3 text box, now I want to validate \"required\" on all the field only if any one of them is filled, else I can proceed with blank form</p>\n\n<p>How do I do this using Jquery validationEngine </p>\n"},{"tags":["html","css","ruby-on-rails-3","textfield"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13078098,"title":"How can I change the length of a text_field in rails?","body":"<p>So I have this text field </p>\n\n<pre><code>&lt;%= f.text_field :body, placeholder: \"Make an offer \", :maxlength=&gt;\"254\" %&gt; \n</code></pre>\n\n<p>right now it takes up 100% of the width of the box it is in. I want it to take up like 95%. So far I have tried (from other forum posts)</p>\n\n<p>adding <code>:columns =&gt; \"50\"</code> this didn't affect it. I tried\nputting on an html tag , <code>:html =&gt; { :id =&gt; \"offer_form\" }</code> and then putting in my css file </p>\n\n<pre><code>#offer_form { width:50%;} \n</code></pre>\n\n<p>this didn't work</p>\n\n<p>any other suggestions?</p>\n\n<p>edit:</p>\n\n<p>I realized that in my css file I have under /<em>forms</em>/</p>\n\n<pre><code>input, textarea, select, .uneditable-input {\n  border: 1px solid #bbb;\n  width: 98%;\n  padding: 10px;\n  height: auto !important;\n  margin-bottom: 15px;\n\n}\n</code></pre>\n\n<p>and when i change the width here it works. but it affects all of the forms in the entire app (obviously)(ie they are all 98%). Is there a way that I can id just this field so that I can edit its width independently. </p>\n"},{"tags":["ruby-on-rails-3","asset-pipeline","basic-authentication","html5-appcache"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13075867,"title":"HTML5 Offline Application with Basic Authentication","body":"<p>I'm trying to get a Rails 3 project working offline using HTML5 Appcache and Rack::Offline. I am using Rails 3 Asset Pipeline which provides the added luxury of digests (application-dfla33q23jad.js) to keep the manifest files fresh. Theoretically, anytime an asset changes, the manifest will also change to include the new digested versions of the assets.</p>\n\n<p>(application.manifest)</p>\n\n<pre><code>CACHE MANIFEST\nassets/application-785189fec63978372c177135a521e081.js\nassets/application-c69de8169df1ae42a1a4dcafdc5a1af4.css\nassets/application.css\nassets/application.js\n</code></pre>\n\n<p>The new manifest is detected by the browser, and the new assets are cached in the background, but the html does not get updated to reflect the updated assets. It's almost as though all the assets get cached except for the master entry. Notice below how the js and css links do not have the same digest as the new version resulting in a 404 (Not Found) when refreshed.</p>\n\n<p>(index.html)</p>\n\n<pre><code>&lt;html manifest=\"/application.manifest\"&gt;\n&lt;head&gt;\n  &lt;title&gt;Project&lt;/title&gt;\n  &lt;link href=\"/assets/application-cb58254cec63978372c177135a521e081.js\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n  &lt;script src=\"/assets/application-918b26fdf1ae42a1a4dcafdc5a1af4.css\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;p&gt; Content &lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>My first thought to fix this was to add the html explicitly to the manifest so the html gets updated with the rest of the assets.</p>\n\n<pre><code>CACHE MANIFEST\nindex.html\nassets/application-785189fec63978372c177135a521e081.js\nassets/application-c69de8169df1ae42a1a4dcafdc5a1af4.css\nassets/application.css\nassets/application.js\n</code></pre>\n\n<p>I believe this would have worked but index.html is protected using basic authentication so a 401 (Unauthorized) error is thrown when trying to update the appcache. Which leads me to my questions:</p>\n\n<ol>\n<li>Shouldn't the appcache update the master entry (index.html) anytime the explicit entries get updated?</li>\n<li>Does the appcache provide a way to include entries that are protected using basic authentication? </li>\n<li>Shouldn't the appcache request use the same credentials the user entered to view the page in the first place?</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":353,"score":0,"question_id":8532171,"title":"IP address format check","body":"<p>I am developing a <strong>Ruby on Rails</strong> application by using <strong>Ruby v1.8.7</strong> . My question is more about <strong>Ruby</strong> language.</p>\n\n<p>I know there is a build-in Ruby library named <a href=\"http://www.ruby-doc.org/stdlib-1.8.7/libdoc/ipaddr/rdoc/IPAddr.html\" rel=\"nofollow\">IPAddr</a> in <strong>Ruby v1.8.7</strong> . It handles IP address related issues well. But, seems it does not provide any method to check IP address format.</p>\n\n<p>Could someone provide me <strong>a good way to check IP address format</strong>(IPv4 and IPv6 addresses) in Ruby? Thank you.</p>\n\n<p><strong>P.S.</strong> </p>\n\n<p>I tried a regular expression way:</p>\n\n<pre><code>ip_regex = ^([01]?\\\\d\\\\d?|2[0-4]\\\\d|25[0-5])\\\\.([01]?\\\\d\\\\d?|2[0-4]\\\\d|25[0-5])\\\\.\n([01]?\\\\d\\\\d?|2[0-4]\\\\d|25[0-5])\\\\.([01]?\\\\d\\\\d?|2[0-4]\\\\d|25[0-5])$\n\nip_addr='127.0.0.3'\nip_addr =~ ip_regex\n</code></pre>\n\n<p>But it does not work...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ancestry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13077705,"title":"Include a form _tag helper inside form_for and set errors on validation?","body":"<p>Here's the situation I've wound up in:</p>\n\n<ul>\n<li>I'm using the Ancestry gem</li>\n<li>I want a nested form with n number of children</li>\n<li>I want validation errors to show up with appropriate child fields wrapped in the error class</li>\n</ul>\n\n<p>I have a <code>Book</code> model that can have many child books (using ancestry)</p>\n\n<pre><code>class Book &lt; ActiveRecord::Base\n    attr_accessible :title, :description\n    has_ancestry\nend\n</code></pre>\n\n<p>Now I want a form that lets you insert any number of new child books. I generated the model with scaffolding so the form partial is the generic <code>form_for(@book)...</code> in which I've added <code>&lt;%= render 'children_form' %&gt;</code></p>\n\n<pre><code>_children_form.rb\n\n&lt;% num = 0 %&gt;\n&lt;% @book.children.each do |child| %&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag \"children[#{num}][title]\", child.title %&gt;\n      &lt;%= text_field_tag \"children[#{num}][title]\", child.title %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag \"children[#{num}][description]\", child.description %&gt;\n      &lt;%= text_field_tag \"children[#{num}][description]\", child.description %&gt;\n    &lt;/div&gt;\n    &lt;% num += 1 %&gt;\n&lt;% end %&gt;\n\n.... more stuff for adding a new child book\n</code></pre>\n\n<p>I've taken care of all the logic in the controller for saving this. The relevant portion is probably just adding errors, which happens like so in the controller:</p>\n\n<pre><code>@book.errors.add \"children_#{num}_#{attr}\", message\n</code></pre>\n\n<p>The error gets printed at the top of the form (again, scaffolding in the form partial) but the actual fields and labels don't get wrapped in the <code>field_with_errors</code> class. I've deduced this is because <code>form_for</code> only works if <code>f.text_field</code> helpers are called. </p>\n\n<p>So, my immediate question is how do I associate these errors with a given input and label? And is that even possible since I'm mixing form_for and form_tag helpers? I know I could manually check through the errors and update the classes accordingly, but I'm hoping that can be avoided.</p>\n\n<p>The more interesting question is what is a better approach to getting nested forms working with ancestry? My current solution feels very hacky because <code>accepts_nested_attributes_for</code> does not work with ancestry. I also could not get a book to validate children within the book model due to ancestry limitations of being unable to associate models before they're saved.</p>\n"},{"tags":["ruby-on-rails-3","model","associations"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13057667,"title":"Display volunteers who have donations in past week","body":"<p>I am trying to display the volunteers who have received donations (gifts) in the last week.  A constituent (scoped to volunteers), through fund_solicitor_links, has funds, and through those funds have gifts.  How might I accomplish this?  Here are my models:</p>\n\n<pre><code>class Constituent &lt; ActiveRecord::Base\n  self.primary_key = :constituent_id\n  has_many :fund_solicitor_links\n  has_many :funds, :through =&gt; :fund_solicitor_links\n  scope :volunteers, joins(:funds)\nend\n\nclass FundSolicitorLink &lt; ActiveRecord::Base   # has fields constituent_id and fund_id\n  belongs_to :constituent\n  belongs_to :fund\nend\n\nclass Fund &lt; ActiveRecord::Base\n  self.primary_key = :fund_id\nend\n\nclass Gift &lt; ActiveRecord::Base\n  self.primary_keys = :gift_id, :fund_id\n  belongs_to :fund\n  belongs_to :constituent\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13077087,"title":"learning rails, trying to build blog categorization","body":"<p>I am working on building a blog with categorization. I am a bit stuck on how to implement categorization in the form. I have setup a has many through relationship and want to add check boxes to associate a blog with multiple categories. What I have so far is passing the categories through to the view, and I can list them out, however I cannot get the form_for method working for some reason.</p>\n\n<p>Here is my code.</p>\n\n<p>blog model</p>\n\n<pre><code>class Blog &lt; ActiveRecord::Base\n  attr_accessible :body, :title, :image\n  has_many :categorizations\n  has_many :categories, through: :categorizations\n  has_attached_file :image, :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\n\n  validates :title, :body, :presence =&gt; true\n\nend\n</code></pre>\n\n<p>Category Model</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  has_many :categorizations\n  has_many :blogs, through: :categorizations\n  attr_accessible :name\nend\n</code></pre>\n\n<p>Categorization Model</p>\n\n<pre><code>class Categorization &lt; ActiveRecord::Base\n  attr_accessible :blog_id, :category_id\n  belongs_to :blog\n  belongs_to :category\nend\n</code></pre>\n\n<p>Blog new controller</p>\n\n<pre><code> def new\n    @blog = Blog.new\n    @categories = Category.all\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @blog }\n    end\n  end\n</code></pre>\n\n<p>Blog new form view</p>\n\n<pre><code>&lt;%= form_for(@blog, :url =&gt; blogs_path, :html =&gt; { :multipart =&gt; true }) do |f| %&gt;\n  &lt;% if @blog.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@blog.errors.count, \"error\") %&gt; prohibited this blog from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @blog.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.file_field :image %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :body %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :body %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    Categories:\n    &lt;% @categories.each do |category| %&gt;\n      &lt;% fields_for \"blog[cat_attributes][]\", category do |cat_form| %&gt;\n        &lt;p&gt;\n          &lt;%= cat_form.check_box :name %&gt;\n        &lt;/p&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This code is my failing point</p>\n\n<pre><code>&lt;% @categories.each do |category| %&gt;\n          &lt;% fields_for \"blog[cat_attributes][]\", category do |cat_form| %&gt;\n            &lt;p&gt;\n              &lt;%= cat_form.check_box :name %&gt;\n            &lt;/p&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>Although I am not positive I am approaching any of it right since I am currently learning. Any advice on how to accomplish this.</p>\n\n<p>Thanks,\nCG</p>\n"},{"tags":["ruby","ruby-on-rails-3","sphinx","thinking-sphinx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13042182,"title":"2 fields in thinking_sphinx search","body":"<p>I have two fields that I am passing into thinking_sphinx, one is a dropdown, the other a free text.  </p>\n\n<pre><code>&lt;%= select :search, params[:search], Category.joins(:posts).select('distinct           categories.*').collect {|category| [ category.categoryname,category.categoryname ]}, :include_blank =&gt; 'Select a category...' %&gt;\n\n&lt;%= text_field_tag :resume, params[:resume] %&gt;\n</code></pre>\n\n<p>Its working with just the dropdown, but my syntax seems to be wrong to get the 2nd one to work.  </p>\n\n<pre><code>    @posts = Post.search :conditions=&gt;{:search=&gt;params[:search]},{:resume=&gt;params[:resume]}\n</code></pre>\n\n<p>I'm getting :  3: syntax error, unexpected '\\n', expecting tASSOC</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","installation","pdfkit"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":905,"score":1,"question_id":9757235,"title":"How to install PDFKit? (Rails 3.2.1 and PDFKit 0.5.2)","body":"<p>I'm trying to use PDFKit.</p>\n\n<p>It looks fairly straight forward so I'm trying to follow <a href=\"http://railscasts.com/episodes/220-pdfkit?autoplay=true\" rel=\"nofollow\">Ryan's Rails cast</a>.</p>\n\n<p>So I added the gem to my GemFile and updated my <code>application.rb</code> enter code here with:</p>\n\n<pre><code>config.middleware.use \"PDFKit::Middleware\"\n</code></pre>\n\n<p>After that I installed wkhtmltopdf on linux with:</p>\n\n<pre><code>apt-get install wkhtmltopdf\n</code></pre>\n\n<p>And I make sure it works:</p>\n\n<pre><code>[nicolas@Minto]%wkhtmltopdf www.google.com gogole.pdf\nLoading page (1/2)\nPrinting pages (2/2)                                               \nDone\n</code></pre>\n\n<p>Everything looks good until I try to add the .pdf on one of my pages...</p>\n\n<p>The website stays in a loading state forever. When I stop the server with a <code>Ctrl - C</code> in the console, I get the following error:</p>\n\n<pre><code>RuntimeError (command failed: \"/usr/bin/wkhtmltopdf\" \"--page-size\" \"Letter\" \"--margin-top\" \"0.75in\" \"--margin-right\" \"0.75in\" \"--margin-bottom\" \"0.75in\" \"--margin-left\" \"0.75in\" \"--encoding\" \"UTF-8\" \"--print-media-type\" \"--quiet\" \"-\" \"-\"):\n  pdfkit (0.5.2) lib/pdfkit/pdfkit.rb:71:in `to_pdf'\n  pdfkit (0.5.2) lib/pdfkit/middleware.rb:21:in `call'\n</code></pre>\n\n<p><strong>What I'm doing wrong?</strong></p>\n\n<p>Thank you very much for your help.</p>\n\n<p>Nicolas.</p>\n"},{"tags":["ruby","database","ruby-on-rails-3","database-design","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13050831,"title":"Multiple has_one association to one polymorphic model","body":"<p>I have two models, <code>Address</code> and <code>User</code>:</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :resource, polymorphic: true\nend\n\nclass User &lt; ActiveRecord::Base\n  has_one :contact_address, class_name: \"Address\", as: :resource\n  has_one :billing_address, class_name: \"Address\", as: :resource\nend\n</code></pre>\n\n<p>Problem is if I create <code>billing_address</code> for <code>User</code> it will be automatically set as <code>contact_address</code>, since the <code>addresses</code> table doesn't specify a different <code>resource_type</code> (both are <code>User</code>).\nCan you give me some advice on how I should set up my models?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13073690,"title":"Rails implicit render in templates from multiple controllers","body":"<p>I have code like <code>render @posts</code> to render my posts collection in an index template which the <code>PostsController</code> renders.</p>\n\n<p>Now I have an <code>Admin::PostsController</code> that also should render the collection but when my posts controller renders <code>@posts</code> it looks for the <code>admin/posts/_post.html.erb</code> partial. Do I now have to write the partial path explicity? Is this feature by design or a bug? It doesn't seem to make sense.</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13075617,"title":"Rails 3.2.8 - How do I get the week number from Rails?","body":"<p>I would like to know how to get the current week number from Rails and how do I manipulate it: </p>\n\n<ol>\n<li>Translate the week number into date.</li>\n<li>Make an interval based on week number.</li>\n</ol>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13072598,"title":"strategies for avoid mysql queries in rails","body":"<p>i have an app (rails 3) that basically is a social network for tv shows. So users can interact with each others and with tv_shows.</p>\n\n<p>What would be the best strategy to avoid quering the database (mysql) every time when showing users/tv_shows profiles pages?</p>\n\n<p>Ex: Inside a tv show profile page, i need to load a lot of information like seasons, episodes, actors etc. To do this a need to join several tables and is getting slower each day.</p>\n\n<p>My first thought was gether all information regarding any tv show and storage in just one table, so i dont need to make those joins every time. </p>\n\n<p>For sure i would have better performance but not best. I know that there are a lot of alternatives out there like memcache, redis even mongodb but what is the best approach to this case?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unit-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":42,"score":4,"question_id":13036641,"title":"Is it possible to have multiple fixture files per model in rails 3.2?","body":"<p>In Rails 3.2, is it possible to have multiple fixture files for a given ActiveRecord object? </p>\n\n<p>The client is requiring the test data be written in fixtures but also wants them to be manageable. I'd like to split up the fixtures a bit by introducing a 2nd set that the originals would include/require/render whatever. </p>\n\n<p>I haven't been able to find anything via Google on how to do it and fixtures are not my cup of tea. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","heroku","dns","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13074734,"title":"Heroku/Rails route example.com to mydomain.com/example","body":"<p>My rails app is a way for users to create their own basic website.  So each of them will have a root folder that is mydomain.com/user/1.  They will have other pages like mydomain.com/user/1/about etc.  How do I configure rails and heroku so that something like www.user1.com points to mydomain.com/user/1, and something like www.user1.com/about directs to mydomain.com/user/1/about?  </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","prawn"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13074355,"title":"Download multiple files with rails","body":"<p>I'm currently using PRAWN with latest release of rails and I can't figure out how to download multiple files with a single HTTP request. in my controller I have the following code:</p>\n\n<pre><code>Fill PDF with my stuffs...\nPDF.render_file \"foo.pdf\"\nsend_file(\"foo.pdf\")\n</code></pre>\n\n<p>And it download correctly the file but - if after that - I put another istance of the same code...it will execute only the last one, foo2</p>\n\n<pre><code>PDF.render_file \"foo.pdf\"\nsend_file(\"foo.pdf\")\nPDF.render_file \"foo.pdf\"\nsend_file(\"foo2.pdf\")\n</code></pre>\n\n<p>Moreover, If at end...I wish to render another view, I can't do it. </p>\n\n<p>Question is: </p>\n\n<p>How can I download 2 different files in a single action inside controller and, finally, render a view?</p>\n"},{"tags":["ruby-on-rails-3","authentication","devise"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":269,"score":1,"question_id":5632628,"title":"Previous user picked up with auth_token login in Devise","body":"<p>Here's my scenario.</p>\n\n<p>First, I log in as Alice:\n<a href=\"http://localhost:3000/?auth_token=eMXBk8cuJMA1ETZfMIgB\" rel=\"nofollow\">http://localhost:3000/?auth_token=eMXBk8cuJMA1ETZfMIgB</a>\nThen, without logging out, I log in as Bob:\n<a href=\"http://localhost:3000?auth_token=Z9Ui7Cw_xCnOmGWOEUEH\" rel=\"nofollow\">http://localhost:3000?auth_token=Z9Ui7Cw_xCnOmGWOEUEH</a></p>\n\n<p>What happens is, after the second GET request, I'm still logged in as Alice, not Bob.\nIf I do a <a href=\"http://localhost:3000/users/sign_out\" rel=\"nofollow\">http://localhost:3000/users/sign_out</a> in between the two auth_token logins, everything's OK.\nWithout the sign_out, Bob can't login using his token.</p>\n\n<p>Is this a bug, or the way things should be due to some security issues I'm ignorant of?\nCan this behavior be overriden through hooks?</p>\n"},{"tags":["ruby-on-rails-3","amazon-s3","carrierwave"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13049633,"title":"rails carrierwave / s3 signature doesn't match. Wrong private key","body":"<p>I'm trying to get carrierwave working with S3, and I am getting a signature doesn't match error.  The weird thing is that it doesn't look like carrierwave is sending the right secret key.  In the error, the post is given as:</p>\n\n<pre><code>\"Authorization\"=&gt;\"AWS AKIAIOLWQKSJFH6E3I5Q:vKgyAw2z4c8zzqGWoxLUbw7I5oI=\"\n</code></pre>\n\n<p>Which I assume is supposed to be my publickey:privatekey.  The thing is that vKgyAw2z4c8zzqGWoxLUbw7I5oI= is not the private key I have stored in fog.rb.  Is that right?  </p>\n\n<p>Any help is appreciated. </p>\n\n<p>Request/Response:</p>\n\n<pre><code> request =&gt; {:chunk_size=&gt;1048576, :connect_timeout=&gt;60, :headers=&gt;{\"Content-Length\"=&gt;1557, \"Content-Type\"=&gt;\"image/\ngif\", \"x-amz-acl\"=&gt;\"public-read\", \"Date\"=&gt;\"Wed, 24 Oct 2012 12:45:17 +0000\", \"Authorization\"=&gt;\"AWS AKIAIOLWQKSJFH6E3\nI5Q:vKgyAw2z4c8zzqGWoxLUbw7I5oI=\", \"Host\"=&gt;\"s3.amazonaws.com:443\"}, :instrumentor_name=&gt;\"excon\", :mock=&gt;false, :nonb\nlock=&gt;true, :read_timeout=&gt;60, :retry_limit=&gt;4, :ssl_ca_file=&gt;\"/home/tim/.rvm/gems/ruby-1.9.3-p194/gems/excon-0.16.5\n/data/cacert.pem\", :ssl_verify_peer=&gt;true, :write_timeout=&gt;60, :host=&gt;\"myeasybnb.s3.amazonaws.com\", :host_port=&gt;\"s3.\namazonaws.com:443\", :path=&gt;\"/images%2Fb1bb6639-dc08-4981-9a9b-7175093ac970.gif\", :port=&gt;\"443\", :query=&gt;nil, :scheme=\n&gt;\"https\", :body=&gt;#&lt;File:/home/tim/Dropbox/myeasybnb/tmp/uploads/20121024-0845-20225-1170/240x240.gif&gt;, :expects=&gt;200\n, :idempotent=&gt;true, :method=&gt;\"PUT\"}\n  response =&gt; #&lt;Excon::Response:0xa7a1098 @body=\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n&lt;Error&gt;&lt;Code&gt;SignatureD\noesNotMatch&lt;/Code&gt;&lt;Message&gt;The request signature we calculated does not match the signature you provided. Check your\n key and signing method.&lt;/Message&gt;\n</code></pre>\n\n<p>fog.rb:</p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',       # required\n    :aws_access_key_id      =&gt; 'AKIAIOLWQKSJFH6E3I5Q',       # required\n    :aws_secret_access_key  =&gt; '[my secret key]'      # required\n\n  }\n  config.fog_directory  = 'myeasybnb'                             # required\n  config.fog_public     = true                                   # optional, defaults to true\n\nend\n</code></pre>\n\n<p>Uploader.rb: </p>\n\n<pre><code># encoding: utf-8\n\nclass PhotoUploader &lt; CarrierWave::Uploader::Base\n\n\n  # Include RMagick or MiniMagick support:\n  # include CarrierWave::RMagick\n  include CarrierWave::MiniMagick\n\n  # Include the Sprockets helpers for Rails 3.1+ asset pipeline compatibility:\n   include Sprockets::Helpers::RailsHelper\n   include Sprockets::Helpers::IsolatedHelper\n\n  # Choose what kind of storage to use for this uploader:\n  # storage :file\n   storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"images\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\nclass MyUploader &lt; CarrierWave::Uploader::Base\n  def default_url \n     asset_path(\"seeds/\" + [version_name, \"default.png\"].compact.join('_'))\n  end\nend\n\n  # Process files as they are uploaded:\n  # process :scale =&gt; [200, 300]\n  #\n\n\n  # Create different versions of your uploaded files:\n\n  process :convert =&gt; 'jpg'\n  version :sidecarousel, :if =&gt; :is_side_carousel? do\n      process :resize_to_fit =&gt; [2000,1000]\n  end\n    version :thumbnail, :if =&gt; :is_thumbnail? do\n       process :resize_to_fill =&gt; [240,240]        \n    end\n\n    version :linetext, :if =&gt; :is_line? do\n         process :resize_to_fill =&gt; [400,200]\n    end\n    version :carousel, :if =&gt; :is_carousel? do\n      process :resize_to_fit =&gt; [2200, 1000]\n    end  \n\n    version :phone do\n      process :resize_to_fit =&gt; [900,900]\n    end\n  # def scale(width, height)\n  #   # do something\n  # end\n\n\n\n\n  def is_side_carousel? photo\n    model.location == 1\n  end\n\n  def is_thumbnail? photo\n  model.location == 2\n  end\n  def is_line? photo\n    model.location == 3\n  end\n  def is_carousel? photo\n    model.location == 4\n  end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n\n\n\n  # Override the filename of the uploaded files:\n  # Avoid using model.id or version_name here, see uploader/store.rb for details.\n def filename\n    file.nil? ?  @filename = nil : @filename = \"#{secure_token}.#{file.extension}\" \n\n\n end \n\n    def secure_token\n    var = :\"@#{mounted_as}_secure_token\"\n    model.instance_variable_get(var) or model.instance_variable_set(var, SecureRandom.uuid)\n  end\n  def cache_dir\n\"#{Rails.root}/tmp/uploads\"\nend\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rounding-error"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13074090,"title":"Rails 3 Float Rounding Error","body":"<p>Running ruby 1.8.7.  </p>\n\n<p>(1.005 * 100).round\nresult:  100</p>\n\n<p>(1.006 * 100).round\nresult:  101</p>\n\n<p>100.5.round\nresult: 101</p>\n\n<p>(1.005 * 100)\nresult: 100.5</p>\n\n<p>What is going on here?  Can someone try this in the latest version of ruby please? \nThanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sql-update","find-and-replace"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13072791,"title":"Can't find a row in my table sqlite3 table","body":"<p>I'm trying to set up a simple edit feature for an object in one of my tables.  Here is my current code which I've seen online and in books but it doesn't work</p>\n\n<pre><code>def edit\n    @fire_chief = FireChief.find(params[:id])\n end\n</code></pre>\n\n<p>All I have to do is figure out how to edit a specific Fire Chief in list view and I can keep programming, but I'm stuck.</p>\n\n<p>The error I'm recieving is \"Couldn't find FireChief without an ID\"</p>\n\n<p>If I use this little snippet of code it finds the edit form fine</p>\n\n<pre><code>def edit\n    @fire_chief = FireChief.last\n end\n</code></pre>\n\n<p>But it always pulls up the last entry to be edited.  I need it to pull the entry that i click...might be the 1st, 3rd, or 5th, etc.  I know a lot of this is redundant, but I just want to be clear on what I'm trying to do.</p>\n\n<p>This is my routes file:</p>\n\n<pre><code>resource :timesheet do\n    resource :command_officer\n    resources :fire_chief\n    resources :fire_fighters\n    resource :safety_officer\n    resources :emts\n    resources :hazmat_specialists\n    resources :command_vehicles\n    resources :engines\n    resources :emergency_supports\n    resources :hazmat_units\n    resources :field_units\n    resources :pumpers\n    resources :tankers\n    resources :rescue_units\nend\nend\n</code></pre>\n\n<p>I just changed the resource :fire_chief to be plural, so now its this resources :fire_chief</p>\n\n<p>But I'm getting this error now:</p>\n\n<p>Routing Error</p>\n\n<p>uninitialized constant FireChiefController</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","gem","paperclip"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13073107,"title":"I want to understand how the Paperclip gem handles s3 down time","body":"<p>I hope that this question does not have an extremely simple answer that I have completely overlooked.  </p>\n\n<p>My question is how does the paperclip gem handle s3 down time?  What is the flow if a user uploads an asset and s3 is not responding due to it becoming unavailable.  The specifics; I am using paperclip 2.7 gem with rails 3.  I tried looking through the documentation and tests but could not see that this was being handled.  If s3 downtime is not being handled by the paperclip gem what is the best practice for me to handle it in my model.  Ideally I don't want a save to occur and an error to be transmitted to the user.</p>\n\n<p>How have others handled this?</p>\n\n<p>Any insight into this will be helpful,</p>\n\n<p>Slan</p>\n"},{"tags":["ruby-on-rails-3","activeadmin","formtastic"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12703987,"title":"How to display only the value in edit page in Active Admin","body":"<p>I have a edit form in Active Admin. I need some field as read only. </p>\n\n<p>My current edit page is like</p>\n\n<p><img src=\"http://i.stack.imgur.com/u3f6z.png\" alt=\"enter image description here\"></p>\n\n<p>I need the page look like this</p>\n\n<p><img src=\"http://i.stack.imgur.com/XFAXS.png\" alt=\"enter image description here\"></p>\n\n<p>How can this be done. My code for the edit form page is like</p>\n\n<pre><code>    form :html =&gt; { :enctype =&gt; \"multipart/form-data\" } do |f|  \n      f.inputs \"Users\" do\n        f.input :device, :label =&gt; 'Device', :as =&gt; :select, :collection =&gt; DEVICE, :include_blank =&gt; false\n        f.input :current_address, :label =&gt; 'Current Address', :as =&gt; :string\n      end\n    end\n</code></pre>\n\n<p>Please help.</p>\n"},{"tags":["ruby-on-rails-3","internationalization","activeadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13072416,"title":"Translation text editor gem with active admin integration","body":"<p>I want to be able to edit rails 3 translations using <a href=\"http://activeadmin.info/\" rel=\"nofollow\">activeadmin</a>, I've seen that <a href=\"https://github.com/grosser/fast_gettext\" rel=\"nofollow\">fast_gettext</a> looks like a good option with it's database backend setup. However as far as I can tell it doesn't integrate into activeadmin without a bunch of work to have it setup nicely.</p>\n\n<p>Are there any alternatives that would integrate more easily with activeadmin? Ideally there would be an easy way to switch between the different languages available.</p>\n"},{"tags":["ruby-on-rails-3","json","rest","activemodel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12485404,"title":"How to implement multiple different serializers for same model using ActiveModel::Serializers?","body":"<p>Let's say you're implementing a REST API in Rails.  When serving a collection, you might want to only include a few attributes:</p>\n\n<pre><code>/people\n</code></pre>\n\n<p>But when serving a single resource, you want to include all the attributes:</p>\n\n<pre><code>/people/1\n</code></pre>\n\n<p>I don't see how to do that using ActiveModel::Serializers, since the examples all use the pattern of defining one serializer per model (with a standard naming convention) and having AMS automatically use the right one in the controller when you do:</p>\n\n<pre><code>render json: @people\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>render json: @person\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","acts-as-taggable-on"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":49,"score":-1,"question_id":13023670,"title":"Acts as taggable on Rails","body":"<p>How can I make an index route/action to see all the tags that I've created!, I'm using the gem at <a href=\"https://github.com/mbleigh/acts-as-taggable-on\" rel=\"nofollow\">https://github.com/mbleigh/acts-as-taggable-on</a></p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email-integration"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":13016965,"title":"\"Unsubscribe\" for email categories/types through Sendgrid, Mailchimp, SES","body":"<p>I've got a Rails 3.2 app that will need to send various transactional &amp; bulk (marketing) types of emails. Ideally I'd be able to use a service (like Sendgrid or Amazon SES) to improve deliverability and for unsubscribe support. I've mostly used Sendgrid in the past, but I need the 'unsubscribe' to be just for a specific category of the email (there are around 6 categories). I can't have someone unsubscribing from a marketing email and miss out on notification or invitation emails. Does anyone know of an service that supports this, or does this just have to be done internally? It seems like there's a lot to deal with related to best practices for deliverability, list-unsubscribe, etc. if you manage it yourself. </p>\n\n<p>I see this discussion on sendgrid, but seems to be pending still:\n<a href=\"http://community.sendgrid.com/sendgrid/topics/unsubscribe_and_categories\" rel=\"nofollow\">http://community.sendgrid.com/sendgrid/topics/unsubscribe_and_categories</a></p>\n\n<p>I'm happy to go with any service if it integrates relatively easily with Rails and can support category/type based subscription management. Or perhaps a hybrid approach with different services or separate accounts on the same service, if they allow that for the same domain? </p>\n\n<p>I very much appreciate any feedback on how others have tackled this.</p>\n\n<p>Thanks! </p>\n"},{"tags":["ruby-on-rails-3","datetime","view","dry","helper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13071531,"title":"Tidiest way of highlighting record if older than X days?","body":"<p>What is the tidiest DRY way in a Rails 3 application of highlighting a table row depending on its age?</p>\n\n<pre><code>&lt;% @faults_open.each do |fault| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= fault.name %&gt;&lt;/td&gt;  \n    &lt;td&gt;&lt;%= fault.faulttype %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= fault.priority %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= time_ago_in_words(fault.created_at) %&gt; ago&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', fault %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I would like a class applied to the table row with an indication of its age which I can then style using CSS.</p>\n\n<pre><code>&lt;% @faults_open.each do |fault| %&gt;\n  &lt;tr &lt;% if fault.created_at &gt; Date.1.week.ago %&gt;class=\"weekold\"&lt;% end %&gt;&gt;\n    &lt;td&gt;&lt;%= fault.name %&gt;&lt;/td&gt;  \n    &lt;td&gt;&lt;%= fault.faulttype %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= fault.priority %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= time_ago_in_words(fault.created_at) %&gt; ago&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', fault %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Something like the above but obviously adding them to the view would be messy. I plan on adding a couple of ages, such as:</p>\n\n<pre><code>weekold\ntwoweeksold\nmonthold\nsixmonthold\nyearold\nancient\n</code></pre>\n\n<p>I imagine a helper is the tidiest way, but I'm unsure on how the helper would work. Any pointers would be appreciated.</p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13058228,"title":"How to select appropriate Association in Rails?","body":"<p>I'm trying to learn Rails by creating a very simple application which just creates a website where someone can create a list of authors and books with an association that the book is written by an author. I was hoping this would be simple and DRY, but I've been having an unexpected amount of trouble with it.</p>\n\n<p>First looking at my models, I've set up the association and made every data point required (author.name, book.title, and book.author). I do not want to add :author or :author_id to the attr_accessible lists because I want to use the appropriate Rails conventions.</p>\n\n<p>app/models/author.rb:</p>\n\n<pre><code>class Author &lt; ActiveRecord::Base\n  attr_accessible :name\n  validates_presence_of :name\n  has_many :books\nend\n</code></pre>\n\n<p>app/models/book.rb:</p>\n\n<pre><code>class Book &lt; ActiveRecord::Base\n  attr_accessible :title\n  validates_presence_of :title\n  belongs_to :author\n  validates_associated :author\nend\n</code></pre>\n\n<p>The books controller and view I think is exactly from the scaffolding and very uninteresting. What is interesting is the books controller. Looking at the new method, all I did was add a collector which gets the array of author names with ids to pass to the view. (Honestly, I think I would prefer to not pass the id at all.)</p>\n\n<p>app/controllers/books_controller.rb</p>\n\n<pre><code>  # GET /books/new\n  # GET /books/new.json\n  def new\n    @book = Book.new\n    @authors = Author.all.collect {|a| [a.name, a.id]}\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @book }\n    end\n  end\n</code></pre>\n\n<p>Now over to the views, I used the default new.html.haml, but made changes to _form.html.haml. I added a select field using the values in @authors.</p>\n\n<p>app/views/books/_form.html.haml</p>\n\n<pre><code>= form_for @book do |f|\n  - if @book.errors.any?\n    #error_explanation\n      %h2= \"#{pluralize(@book.errors.count, \"error\")} prohibited this book from being saved:\"\n      %ul\n        - @book.errors.full_messages.each do |msg|\n          %li= msg\n\n  .field\n    = f.label :name\n    = f.text_field :name\n  .field\n    = f.label :author\n    = f.select(:author, @authors, {:include_blank =&gt; \"\"})\n .actions\n    = f.submit 'Save'\n</code></pre>\n\n<p>Lastly, back to my controller for the create method. I try to save the basic parameters and create an author association from the selected author.</p>\n\n<p>app/controllers/books_controller.rb</p>\n\n<pre><code>  # POST /books\n  # POST /books.json\n  def create\n    @book = Book.new(params[:book])\n    @book.author = Author.find_by_id(params[:author])\n\n    respond_to do |format|\n      if @book.save\n        format.html { redirect_to @book, notice: 'Book was successfully created.' }\n        format.json { render json: @book, status: :created, location: @book }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @book.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>When I click 'Save' I get the following error:</p>\n\n<pre><code>Can't mass-assign protected attributes: author\n</code></pre>\n\n<p>I understand that this is because the value I selected was put in params[:book] instead of params[:author]. So I have two questions.</p>\n\n<p>1) How do I fix my select statement to have it send in params[:author] instead of params[:book]?</p>\n\n<p>2) Is there an even better way to do this that completely hides the id association?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","reserved-words"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13064434,"title":"creating a model with name \"import\" is it reserved word in rails 3?","body":"<p>having all kind of strange stuff happening with a model and form named \"import\"\nis this a reserved word in rails somehow? I could not find it in some old webposts on reserved words in rails.</p>\n\n<p>EDIT:\nSome code example to Illustrate, seem to be unable to pinpoint the problem</p>\n\n<p>Works:</p>\n\n<pre><code>- @profile = Profile.new\n  = form_for @profile, :method =&gt; :get,  :html =&gt; { :class =&gt; 'form-horizontal' } do |f|\nthrows error # embed raw\n</code></pre>\n\n<p>Fails:</p>\n\n<pre><code>- @import = Import.new\n  = form_for @import, :method =&gt; :get,  :html =&gt; { :class =&gt; 'form-horizontal' } do |f|\n</code></pre>\n\n<p>With error:</p>\n\n<pre><code>undefined method `imports_path' for #&lt;#&lt;Class:0x007fe4e0369468&gt;:0x007fe4e25410e0&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rest"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":226,"score":1,"question_id":9843294,"title":"Search action in ReSTful rails model","body":"<p>So, I'm quite new to Rails and still working my way through the principles. I suppose like most people, I have started creating that basic CRUD. Okay. Done.</p>\n\n<p>Now I want a new action: search. As it turns out, it is not one of the 7 rest sacred (!) actions (if got it right). While I know I could implement new custom actions and resource it and everything, I read in a few places to try my best to stick to the standard ones as long as possible. Okay. What would be the correct way?</p>\n\n<p>Again a few sources like <a href=\"http://www.slideshare.net/calamitas/restful-best-practices\" rel=\"nofollow\">this guy</a> suggest thinking of my scenarios in therms of <strong>nouns</strong>, case in which seems I'd need a \"search\" controller...? It just doesn't convince me that I'd have to create a whole class whereas I'd normally do <code>def search</code> just to keep it ResTful. </p>\n\n<p>What did I get wrong? What would be the common solution here?</p>\n\n<p>thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-admin"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13070784,"title":"Fail to integrate CKeditor in rails_admin gem (use gem rich)","body":"<p>I follow the link <a href=\"https://github.com/bastiaanterhorst/rich#readme\" rel=\"nofollow\">GitHub gem rich</a> to install CKeditor to rails_admin\nbut I get the error: <code>Unsupported field datatype: rich_editor</code></p>\n\n<p>My model </p>\n\n<pre><code>edit do\n        field :title\n        field :description, :rich_editor do\n          config({\n            :insert_many =&gt; true\n          })\n        end\n        field :autho\n        field :book_type\n      end\n</code></pre>\n\n<p>How can I fix this error? Or that's an issue?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":257,"score":0,"question_id":6580252,"title":"What about peepcode?","body":"<p>I would like to watch some Rails video tutorials. Browsing on the web, I found the site <code>peepcode.com</code>. I would like to know more about the testing of a Rails app (Cucumber, Rspec and so on). I would also like to extend my experience buying more Rails' general videos to keep me up to date. Peepcode  sells video tutorials for $12 per video. I don't have a problem with  $12 but I would like to know if somebody already had experience on the site and tell me more about its quality.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","performance","where"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13054759,"title":"Rails efficiency of where clause","body":"<p>I'm worried about the efficiency of this line in the controller of my Rails project</p>\n\n<pre><code>posts_list = Post.where(:title =&gt; params[:title])\n</code></pre>\n\n<p>If the number of \"Posts\" in the database grows, will the line become slow to execute? Is there any possible optimization?</p>\n"},{"tags":["ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13070025,"title":"managing complex JSON","body":"<p>I have a complex input JSON, something like this:</p>\n\n<pre><code>@json = {\"project\":\"bla\",\n    \"analysis\": {\"id\":\"123\",\"title\":\"Test\"}, \n    \"data\":{\"axis\": {\"name\":\"column\", \"label\":\"demo\",\"values\": [\"one\", \"two\"]},\n           \"series\": [{\"label\":\"text\", \"values\":[\"1\", \"2\", \"3\"]}, \n                    {\"label\":\"text2\", \"values\":[\"4\", \"5\", \"6\"]}\n]}}\n</code></pre>\n\n<p>(more complex and length that this example)</p>\n\n<p>two question:</p>\n\n<ol>\n<li><p>it exists a RoR method that can delete on the fly something in the json? something like\n<code>@json.destroy['analysis']</code> that eliminate only the \"analysis\" key-value couple?</p></li>\n<li><p>how can i navigate (for example) in the values of the series? I can do if the json is simple with a <code>do each</code>, but here must I do a concecation of <code>do each</code>?</p></li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13070164,"title":"Optimizing activerecord queries for displaying attendees of an event","body":"<p>I'm currently hacking on an events site and have never had a problem optimizing queries/scaling my db in the past as there was never that much data, but now there's almost a million rows in the db and it's taking ~15,000 m/s to render a feed of events, in particular the partial (within each _event.html.erb) that's really slow is where all the users that youre currently following that are attending that event are displayed. I've looked up a lot of possibilities to improve performance including eager loading, indexing, memcache, etc...but was wondering how this can be rewritten to perform faster? Thank you!</p>\n\n<p>_attending.html.erb</p>\n\n<pre><code>&lt;% if user_signed_in? %&gt;\n        &lt;% @rsvp = Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going') %&gt;\n        &lt;% if @rsvp.count == 0 %&gt;\n            &lt;%= eventcount(event) %&gt; going.\n        &lt;% elsif @rsvp.count == 1 %&gt;\n            &lt;% if eventcount(event) - 1 == 0 %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; is going.\n                &lt;% end %&gt;\n            &lt;% else %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; and &lt;%= eventcount(event) - 1 %&gt; going.\n              &lt;% end %&gt;\n            &lt;% end %&gt;\n        &lt;% elsif @rsvp.count == 2 %&gt;\n            &lt;% if eventcount(event) - 2 == 0 %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; and\n                &lt;% end %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[1..1].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; are going.\n                &lt;% end %&gt;\n            &lt;% else %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;,\n              &lt;% end %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[1..1].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; and &lt;%= eventcount(event) - 2 %&gt; going.\n              &lt;% end %&gt;\n                &lt;% end %&gt;\n        &lt;% elsif @rsvp.count == 3 %&gt;\n            &lt;% if eventcount(event) - 3 == 0 %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;,\n                &lt;% end %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[1..1].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;, and\n                &lt;% end %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[2..2].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; are going.\n                &lt;% end %&gt;\n            &lt;% else %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;,\n              &lt;% end %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[1..1].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;,\n              &lt;% end %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[2..2].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; and &lt;%= eventcount(event) - 3 %&gt; are going.\n              &lt;% end %&gt;\n            &lt;% end %&gt;\n            &lt;% end %&gt;\n    &lt;% else %&gt;\n        &lt;%= eventcount(event) %&gt; going.\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Schema for RSVP</p>\n\n<pre><code>create_table \"rsvps\", :force =&gt; true do |t|\n  t.string    \"status\"\n  t.integer   \"event_id\"\n  t.integer   \"voter_id\"\n  t.string    \"voter_name\"\n  t.string    \"voter_type\"\n  t.timestamp \"created_at\", :null =&gt; false\n  t.timestamp \"updated_at\", :null =&gt; false\nend\n\nadd_index \"rsvps\", [\"voter_id\", \"voter_type\", \"event_id\"], :name =&gt; \"fk_one_rsvp_per_user_per_entity\", :unique =&gt; true\nadd_index \"rsvps\", [\"voter_id\", \"voter_type\"], :name =&gt; \"index_rsvps_on_voter_id_and_voter_type\"\n</code></pre>\n\n<p>Schema for Relationship</p>\n\n<pre><code>create_table \"relationships\", :force =&gt; true do |t|\n  t.integer   \"follower_id\"\n  t.integer   \"followed_id\"\n  t.timestamp \"created_at\",  :null =&gt; false\n  t.timestamp \"updated_at\",  :null =&gt; false\nend\n\nadd_index \"relationships\", [\"followed_id\"], :name =&gt; \"index_relationships_on_followed_id\"\nadd_index \"relationships\", [\"follower_id\"], :name =&gt; \"index_relationships_on_follower_id\"\n</code></pre>\n\n<p>Relevant part of User model</p>\n\n<pre><code>has_many :relationships, :foreign_key =&gt; \"follower_id\",\n:dependent =&gt; :destroy\n\nhas_many :following, :through =&gt; :relationships, :source =&gt; :followed\n\nhas_many :reverse_relationships, :foreign_key =&gt; \"followed_id\",\n       :class_name =&gt; \"Relationship\",\n       :dependent =&gt; :destroy\nhas_many :followers, :through =&gt; :reverse_relationships, :source =&gt; :follower\n</code></pre>\n"},{"tags":["ruby-on-rails-3","apache","ubuntu","passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":10506959,"title":"Passenger crashes, hangs at apache start","body":"<p>On a fresh installation of Ubuntu, with Ruby/Rails/RVM with Apache via Passenger, apache will come up on a clean reboot, but crash at the first request to the Rails app.</p>\n\n<p>I have done all of this many times before ... except RVM installed in multi-user mode.</p>\n\n<p>It seems like maybe there's some library conflict?</p>\n\n<p>Details below.</p>\n\n<ul>\n<li>64-bit Ubuntu 11.10 installation</li>\n<li>created a release user, and group</li>\n<li>uninstall the default apache, ruby, passenger (sudo apt-get remove ...)</li>\n<li>installed RVM using the system version (multiple users) </li>\n<li>installed ruby 1.9.3p194 using RVM (installed as the release user)</li>\n<li>add release user to group <code>rvm</code></li>\n<li>ruby and gems are under /usr/local/rvm/ and are all in group <code>rvm</code> and readable</li>\n<li>install apache2 and various supporting libraries (<code>sudo apt-get install apache2</code>)</li>\n<li>add apache2 user (<code>www-data</code>) to group <code>rvm</code></li>\n<li>install passenger from gem (<code>gem install passenger</code>)</li>\n<li>use passenger to make passenger module (<code>passenger-install-apache2-module</code>). No errors.</li>\n<li>configure apache to load the correct module (under /usr/local/rvm...)</li>\n<li>configure apache to reference the correct PassengerRoot and PassengerRuby</li>\n<li>note: this is all without any reference to the Rails app</li>\n<li>start apache (<code>sudo apache2ctl start</code>) ... this hangs</li>\n</ul>\n\n<p>Apache error.log shows</p>\n\n<pre><code>[ pid=1303 thr=140033289561952 file=ext/apache2/Hooks.cpp:1389 time=2012-05-07 19:54:15.497 ]: Initializing Phusion Passenger...\n[ pid=1303 thr=140033289561952 file=ext/apache2/Hooks.cpp:1664 time=2012-05-07 19:54:15.536 ]: Shutting down Phusion Passenger...\n[ pid=1312 thr=140533444790112 file=ext/common/LoggingAgent/Main.cpp:283 time=2012-05-07 19:54:15.537 ]: Logging agent online, listening at unix:/tmp/passenger.1.0.1303/generation-0/logging.socket\n</code></pre>\n\n<p>In other words, passenger terminates moments after it starts.  <code>/var/log/syslog</code> shows a stack dump for PassengerWatchd.</p>\n\n<p>I tried running passenger in standalone mode.  Nada.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13059514,"title":"How to remove characters from tsv file during parsing?","body":"<p>I am parsing a tsv file and loading it into MySQL. I got this to work then found there are back slashes in the tsv file that are being interpreted as line breaks. I would like to remove the \\ from all fields before the data is sent to the database. This is a shortened example, there are 300 columns in the file and many of them will be blank.</p>\n\n<pre><code>begin              \n  CSV.foreach(file, :col_sep =&gt; \"\\t\") do |row|\n      row.map!{ |e| e.gsub(/\\\\/, '')} \n      d = Datafeed.new\n      d.id = row[0]\n      d.description = row[1]\n      d.save!\n  end\nend\n</code></pre>\n\n<p>When I run this example, I get an error: undefined method `gsub' for nil:NilClass. I think this error is being generated by blanks in the file. However, when I try adding </p>\n\n<pre><code>row.map!{ |e| unless e.blank e.gsub(/\\\\/, '') } \n</code></pre>\n\n<p>it will not execute and I get an error for an unexpected }.</p>\n\n<p>Is this the right direction to eliminate the back slashes? What is the best approach?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13069871,"title":"Increasing counter in database","body":"<p>I have field called ads_counter in my database, and i need to increase its value each time when this ad is rendered.\nI tried to write custom method and use it in controller which responsible for this data, but that didnt work. Is there any built in methods to increase value in field in database?</p>\n"},{"tags":["mysql","ruby-on-rails-3","api","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13018635,"title":"Ignore modules from Model","body":"<p>I have in my application a few controllers that i want to use as a api. In this api i need to use versioning.</p>\n\n<p>in my <code>routes.rb</code> i`m using this:</p>\n\n<pre><code>require 'api_constraints'\n</code></pre>\n\n<p>(...)</p>\n\n<pre><code>  scope '/:target/:version', :module =&gt; :api, :constraints =&gt; { :version =&gt; /[0-z\\.]+/ } , :defaults =&gt; { :format =&gt; 'json' } do\n    scope :module =&gt; :v1, :constraints =&gt; ApiConstraints.new(:version =&gt; 1, :default =&gt; true) do\n      match '/list' =&gt; 'sample#list'\n    end\n  end\n</code></pre>\n\n<p>my <code>api_constraints.rb</code>:</p>\n\n<pre><code>class ApiConstraints\n\n  def initialize(options)\n    @version = options[:version]\n    @default = options[:default]\n  end\n\n  def matches?(req)\n    @default || req.headers['Accept'].include?(\"application/waytaxi.api.v#{@version}\")\n  end\n\n  def self.version\n    @version\n  end\n\nend\n</code></pre>\n\n<p>in my <code>SampleController.rb</code>:</p>\n\n<pre><code>module Api\n  module V1\n    class SampleController &lt; ApiBaseController\n\n      def list\n        render json: Model.find_by_id(params[:id])\n      end\n\n    end    \n  end\nend\n</code></pre>\n\n<p>the <code>ApiBaseController</code>:</p>\n\n<pre><code>module Api\n  class ApiBaseController &lt; ApplicationController\n    before_filter :authenticate\n    skip_before_filter :verify_authenticity_token\n\n  private\n\n    def authenticate\n      # if params[:target] == \"ios\"\n      #   render :json =&gt; {status: 404}\n      #   return false        \n      # end\n    end\n  end  \nend\n</code></pre>\n\n<p>the problem is:</p>\n\n<p>whenever i try to call <code>Model</code> i get this error:</p>\n\n<pre><code>uninitialized constant Api::V1::SampleController::Model\n</code></pre>\n\n<p>If i use: <code>::Model</code> i get this error:</p>\n\n<pre><code>uninitialized constant Model\n</code></pre>\n\n<p>And yes, i do have this models on my database. If i use <code>Model.all</code> outside the <code>SampleController</code> i get the objects.</p>\n\n<p>Please i need help, urgent help</p>\n\n<p>P.S.: I'm using rails 3.2.8</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache2","phusion-passenger"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13069059,"title":"Why this error occurred my server is not started and site is down?","body":"<p>In my rails application, I am using</p>\n\n<pre><code>Apache + ruby 1.9.2p180 + Rails 3.0.5 + Phusion Passenger version 3.0.13\n</code></pre>\n\n<p>Here is my error</p>\n\n<blockquote>\n  <p>This application process is currently running as user 'nobody' and group 'nobody' and must be able to access its application root directory '/home/mystore /mystore '. However the parent directory '/home/mystore ' has wrong permissions, thereby preventing this process from accessing its application root directory. Please fix the permissions of the directory '/home/mystore ' first. </p>\n</blockquote>\n\n<p>and when i look into my app it's empty but my database got the sample from spree. whats seems to be the problem? </p>\n\n<p>Please somebody help me </p>\n\n<p>I am using \nruby 1.9.2p180 \nRails 3.0.5 \nPhusion Passenger version 3.0.13</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","jquery-ajax","ajax-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13069256,"title":"undefine method submit_to_remote","body":"<pre><code>&lt;%= submit_to_remote(:category, :url =&gt; params[:id].blank? ? {:action =&gt; 'create'} : {:action =&gt; \"update\", :id =&gt; @category}) do %&gt;\n    &lt;table&gt;\n        &lt;tr&gt;\n            &lt;th&gt;Name&lt;/th&gt;\n\n        &lt;/tr&gt;\n\n        &lt;tr&gt;\n            &lt;td&gt;&lt;%= text_field(:category, :name, :size =&gt; 20) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= submit_tag(params[:id].blank? ? \"New\": \"Edit\") %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want to create new record using Ajax. I got <strong>error undefined method submit_to_remote</strong> I declared prototype file in layout. \n                  waiting for ans....... </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13068487,"title":"Rails: pass has_many or belongs_to attribute in 'generate' command","body":"<p>I'm trying to make a scaffold but want to pass a has_many attribute to the generate command as follows:</p>\n\n<pre><code>rails generate scaffold grade name:string {has_many :sections}\n</code></pre>\n\n<p>This generates the broken model:</p>\n\n<pre><code>class Grade &lt; ActiveRecord::Base\n  attr_accessible :, :name, :{has_many\nend\n</code></pre>\n\n<p>instead of what i need:</p>\n\n<pre><code>class Grade &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_many :sections\nend\n</code></pre>\n\n<p>How can i pass a relationship attribute to the generate command?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13062534,"title":"if cancan access is denied it displays an error page or movie to another page, how to stay on same page?","body":"<p>I have used cancan and i have used</p>\n\n<pre><code>rescue_from CanCan::AccessDenied do |exception|  \n  flash[:error] = \"Access denied!\"  \n  redirect_to root_url  \nend  \n</code></pre>\n\n<p>in my application controller but i want to stay on the same page where i perform that action and if possible a pop up window  just showing </p>\n\n<p><code>you are not authorised to perform this action</code></p>\n\n<p>How to customize so as to stay in the same page wherever the unauthorized action is performed? please help me doing this.</p>\n"},{"tags":["ruby","ruby-on-rails-3","foreman","god"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13056164,"title":"how to make foreman start god","body":"<p>I have a Procfile like this:</p>\n\n<pre><code>web: bundle exec unicorn -c config/unicorn.rb -E production\ngod: god -c services.god\n</code></pre>\n\n<p>but <code>foreman start god</code> doesn't start...it's just say this:</p>\n\n<pre><code>17:14:32 god.1  | started with pid 29506\n17:14:32 god.1  | exited with code 0\n17:14:32 system | sending SIGTERM to all processes\nSIGTERM received\n</code></pre>\n\n<p>if I run <code>god -c services.god</code>, all services run fine...<br>\nAny ideas?<br>\nThanks </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache2","phusion-passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":330,"score":1,"question_id":6213129,"title":"Apache + passenger or passenger_standalone","body":"<p>I have an environment where my app is running on multiple machines on mongrel and is getting load balanced by Apache. I am switching mongrel to passenger. Would passenger standalone be a better idea or Apache+passenger on every machine? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13065130,"title":"Rails write a csv file column wise","body":"<p>I like to export a dataset from my rails application as a csv file using the builtin csv library of rails. Usually a csv file is written row wise like in my example below which comes from my datasets_controller.rb:</p>\n\n<pre><code>require 'csv'\n\ndataset = Dataset.find(6)\ndataset_headers = dataset.datacolumns.collect { |dc| dc.columnheader }\n\ncsv_file = CSV.generate do  |csv|                                                                                                           \n   csv &lt;&lt; dataset_headers\nend\n</code></pre>\n\n<p>And now my question is if I could also write my csv files column wise like this?</p>\n\n<pre><code>require 'csv'    \n\ndataset_columns = Datacolumn.all(:conditions =&gt; [\"dataset_id = ?\", 6], :order =&gt; \"columnnr ASC\").uniq \n\ncsv_file = CSV.generate do  |csv|                                                                                                           \n   csv &lt;&lt; \"here put one after another all my data columns\"\nend\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Based on Douglas suggestion I came up with the colde below.</p>\n\n<pre><code> data_columns=Datacolumn.all(:conditions =&gt; [\"dataset_id = ?\", dataset.id], :order =&gt; \"columnnr ASC\").uniq\n\n    CSV.generate do |csv|\n        value=Array.new \n        data_columns.each do |dc|\n          value &lt;&lt; dc.columnheader\n          dc.sheetcells.each do |sc|\n            if sc.datatype &amp;&amp; sc.datatype.is_category? &amp;&amp; sc.category \n              value &lt;&lt; sc.category.short\n            elsif sc.datatype &amp;&amp; sc.datatype.name.match(/^date/) &amp;&amp; sc.accepted_value\n              value &lt;&lt; sc.accepted_value.to_date.to_s\n            elsif sc.accepted_value\n              value &lt;&lt; sc.accepted_value\n            else\n              value &lt;&lt; sc.import_value\n            end \n          end \n          csv &lt;&lt; value\n          value = Array.new \n        end \n      end \n</code></pre>\n\n<p>The output is not transposed for this case and looks like this:</p>\n\n<pre><code>height,10,2,&lt;1,na\nfullauthor,Fortune,(Siebold &amp; Zucc.) Kuntze,Fortune,(Siebold &amp; Zucc.) Kuntze\nYear,1850,1891,1850,1891\nfullname,Mahonia bealei,Toxicodendron sylvestre,Mahonia bealei,Toxicodendron sylvestre\n</code></pre>\n\n<p>But when I change the line which writes the csv to</p>\n\n<pre><code>csv &lt;&lt; value.transpose\n</code></pre>\n\n<p>I get an error which tells me that it could not convert a string to array to do that.\nAnybody an Idea how to fix this?</p>\n\n<p>Any help with this would be appreciated.</p>\n\n<p>Best Claas</p>\n"},{"tags":["ruby","ruby-on-rails-3","html5","cramp","eventsource"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13064323,"title":"Real time updates through Cramp(Ruby) and SSE(HTML5)","body":"<p>I have prepared a sample application to get updates from server in real time using <a href=\"http://cramp.in/\" rel=\"nofollow\">Cramp(Ruby)</a> and <a href=\"http://www.html5rocks.com/en/tutorials/eventsource/basics/\" rel=\"nofollow\">SSE(HTML5)</a>.</p>\n\n<p>I am getting following errors while accessing the html through <code>http://localhost/sse_time.html</code></p>\n\n<pre><code>Errors:\nChrome:\n  Uncaught Error: SECURITY_ERR: DOM Exception 18 sse_time.html:9\n  Uncaught TypeError: Cannot read property 'key-preview' of undefined \n\nFirefox:\n  Error: The character encoding of the HTML document was not declared. The document will render with garbled text in some browser configurations if the document contains characters from outside the US-ASCII range. The character encoding of the page must to be declared in the document or in the transfer protocol.\nLine: 0\n\n  Error: The connection to http://localhost:3000/time was interrupted while the page was loading.\n  Line: 9\n</code></pre>\n\n<p><strong>sse_time.html</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n&lt;h1&gt;Getting server updates&lt;/h1&gt;\n&lt;div id=\"result\"&gt;&lt;/div&gt;\n&lt;script&gt;\n  if (!!window.EventSource) {\n\n    var source = new EventSource('http://localhost:3000/time');\n\n    source.addEventListener('message', function(e) {\n      console.log(e.data);\n    }, false);\n\n    source.addEventListener('open', function(e) {\n      // Connection was opened.\n      console.log('Connection was opened.');\n    }, false);\n\n    source.addEventListener('error', function(e) {\n      if (e.readyState == EventSource.CLOSED) {\n        // Connection was closed.\n        console.log('Connection was closed.');\n      }\n    }, false);\n\n  } else {\n    document.getElementById(\"result\").innerHTML=\"Sorry, your browser does not support server-sent events...\";\n  }\n&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>app/actions/time_action.rb</strong></p>\n\n<pre><code>class TimeAction &lt; Cramp::Action\n  self.transport = :sse\n\n  periodic_timer :send_latest_time, every: 5\n\n  def send_latest_time\n    render \"Current time : #{Time.now}\"\n  end\nend\n</code></pre>\n\n<p>where <code>line 9</code> is <code>var source = new EventSource('http://localhost:3000/time');</code></p>\n\n<p>If I hit <code>http://localhost:3000/time</code> in chrome, it shows time after each 5 seconds without any errors.</p>\n\n<p>However with PHP code it works fine replacing URI <code>http://localhost:3000/time</code> with <code>stream.php</code> in <code>sse_time.html</code></p>\n\n<p><strong>stream.php</strong></p>\n\n<pre><code>&lt;?php\nheader('Content-Type: text/event-stream');\nheader('Cache-Control: no-cache'); // recommended to prevent caching of event data.\n\n/**\n * Constructs the SSE data format and flushes that data to the client.\n *\n * @param string $id Timestamp/id of this connection.\n * @param string $msg Line of text that should be transmitted.\n */\nfunction sendMsg($id, $msg) {\n  echo \"id: $id\" . PHP_EOL;\n  echo \"data: $msg\" . PHP_EOL;\n  echo PHP_EOL;\n  ob_flush();\n  flush();\n}\n\n$serverTime = time();\n\nsendMsg($serverTime, 'server time: ' . date(\"h:i:s\", time()));\n</code></pre>\n\n<p>Here <code>stream.php</code> and <code>sse_time.html</code> resides at same locaation.</p>\n\n<p>Would anyone please guide me to fix this issue?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13047877,"title":"Reset password link asks user to sign in","body":"<p>I am using devise for authentication. When forgot password is called it asks for mail address and it sends a link to the mail, but when I click on the link in the mail I get: </p>\n\n<blockquote>\n  <blockquote>\n    <p>You need to sign in or sign up before continuing.</p>\n  </blockquote>\n</blockquote>\n\n<p>How can I change this so that when clicking on the link it asks for a new password?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I have changed my routes as follows:</p>\n\n<pre><code>devise_for :users do\n  resources :users, :only =&gt; [:index, :new, :create, :edit, :update, :destroy] \nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","internationalization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13055753,"title":"Passing variables inside rails internationalization yml file","body":"<p>I want to use variables declared in yml file right there.\nFor example, I declared <code>site_name</code> and want to use it below in <code>description</code>.</p>\n\n<pre><code>en:\n  site_name: &amp;site_name \"Site Name\"\n  static_pages:\n    company:\n      description: *site_name #this works fine\n      description: \"#{*site_name} is an online system\" #this doesn't work\n</code></pre>\n\n<p>How can I combine <code>*site_name</code> variable with additional text?</p>\n"},{"tags":["sql","ruby-on-rails-3","activerecord","arel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13067573,"title":"Arel: How to write attr = NULL in arel speak?","body":"<p>I have an issue with arel: I want to force something like \"attr = NULL\" using Arel. Arel allows me to do something like this:</p>\n\n<pre><code>table = obj.arel_table # obj has attr\ntable[:attr].eq(nil) # returns ''objs'.'attr' IS NULL'\n</code></pre>\n\n<p>this is fair, since in queries this is the right thing to do. But on updates, I want to be able to set something to NULL, and preferably without having to write the SQL myself (update_all from AR doesn't support ARel-like functionality on collections: objs.things.update_all(:created_at => nil). this breaks). I'm trying basically to do that code block inside the update_all call recurring to arel and to_sql functionalities. Can this be possible? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13066922,"title":"rails_admin javascript error when toggle add_filter menu","body":"<p>I found this html for <strong>add_filter</strong> menu:</p>\n\n<pre><code>&lt;li class=\"dropdown\" style=\"float:right\"&gt;\n  &lt;a class=\"dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"&gt;\n    Add filter\n    &lt;b class=\"caret\"&gt;&lt;/b&gt;\n  &lt;/a&gt;\n&lt;ul class=\"dropdown-menu\" id=\"filters\" style=\"left:auto; right:0;\"&gt;\n  &lt;li&gt;\n    &lt;a data-field-label=\"Title\" data-field-name=\"title\" data-field-options=\"\" data-field-type=\"string\" data-field-value=\"\" href=\"#\"&gt;Title&lt;/a&gt;\n  &lt;/li&gt;\n  &lt;li&gt;\n    &lt;a data-field-label=\"Book type\" data-field-name=\"book_type\" data-field-options=\"\" data-field-type=\"string\" data-field-value=\"\" href=\"#\"&gt;Book type&lt;/a&gt;\n  &lt;/li&gt;\n  &lt;li&gt;\n    &lt;a data-field-label=\"Category\" data-field-name=\"category\" data-field-options=\"\" data-field-type=\"belongs_to_association\" data-field-value=\"\" href=\"#\"&gt;Category&lt;/a&gt;\n  &lt;/li&gt;\n  &lt;li&gt;\n    &lt;a data-field-label=\"Detail\" data-field-name=\"detail\" data-field-options=\"\" data-field-type=\"text\" data-field-value=\"\" href=\"#\"&gt;Detail&lt;/a&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ShESZ.png\" alt=\"Addfilter\"></p>\n\n<p>When I click on Add Filter the console logs:</p>\n\n<p><code>Uncaught TypeError: Object [object Object] has no method 'tooltip'</code> </p>\n\n<ul>\n<li>When I create a new empty project and install rails_admin gem, it works.</li>\n<li>My project is using bootstrap for css and js.</li>\n</ul>\n\n<p>Please give me some advice for this issue.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","templates","erb","partial"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13067089,"title":"Passing markup into a Rails Partial","body":"<p>Is there any way of doing something equivilant to this:</p>\n\n<pre><code>&lt;%= render partial: 'shared/outer'  do %&gt;\n    &lt;%= render partial: 'shared/inner' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Resulting in</p>\n\n<pre><code>&lt;div class=\"outer\"&gt;\n    &lt;div class=\"inner\"&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Obviously there would need to be a way of marking up 'shared/outer.html.erb' to indicate where the passed in partial should be rendered:</p>\n\n<pre><code>&lt;div class=\"outer\"&gt;\n     &lt;% render Here %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>In my specific case I have a generic page header, consisting of a header and subheader, that is shared across all pages, but would like the option of passing in page-specific markup to that header to be rendered below the title and subtitle.</p>\n"},{"tags":["ruby-on-rails-3","oauth","salesforce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13067140,"title":"Trying to access Salesforce throuth Rails with OAuth and getting a 404 error","body":"<p>I think my title sets up the context fairly well.  Here is my controller code:</p>\n\n<pre><code>  def sign_in_salesforce\n    consumer = OAuth::Consumer.new(ENV['JETWAY_SALESFORCE_CONSUMER_KEY'], ENV['JETWAY_SALESFORCE_CONSUMER_SECRET'], :site =&gt; 'https://login.salesforce.com/services/OAuth/c/17')\n    request_token = consumer.get_request_token\n    session[:request_token] = request_token\n    redirect_to request_token.authorize_url\n  end\n</code></pre>\n\n<p>I keep getting a 404 error back after I try to get_request_token.  I am new to OAuth and want to know the direction I should go in trying to debug.  Any help would be great.  Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","view-helpers"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":27,"score":1,"question_id":13066891,"title":"Custom caption text for file_field helper","body":"<p>Is it possible to provide your own caption for the button that the file_field helper generates?</p>\n"},{"tags":["ruby-on-rails-3","routing","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12792377,"title":"Rails 3 Route Nesting","body":"<p>My Rails app routing looks something like this:</p>\n\n<pre><code>match 'Events/New' =&gt; 'event#new'\nmatch 'Events/:date' =&gt; 'event#show', :date =&gt; /[A-Z][a-z]{2}-\\d{2}-\\d{4}/\nmatch 'Events/:date/Venue' =&gt; 'event#venue', :date =&gt; /[A-Z][a-z]{2}-\\d{2}-\\d{4}/\nmatch 'Events/:date/Speakers' =&gt; 'event#speakers', :date =&gt; /[A-Z][a-z]{2}-\\d{2}-\\d{4}/\n</code></pre>\n\n<p>Is there some way to nest this and clean it up?  I suspect it's running the regex on :date multiple times, while nesting could theoretically make it run once.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13050152,"title":"Rails 3 virtual attributes not saving","body":"<p>I have a model with virtual attributes:</p>\n\n<pre><code>attr_accessible :published_at\n\ndef published_at_text\n  I18n.localize(published_at, format: :long_no_day_with_seconds) if published_at\nend\n\ndef published_at_text=(text)\n  self.published_at = Chronic.parse(text)\nend\n</code></pre>\n\n<p>This works fine in the unit tests, but does not save when the published_at_text field is changed in the view. I've tried using <code>attr_accessible :published_at_text</code>, and adding <code>published_at_will_change!</code> to the setter method, but I can't get this to work.</p>\n\n<p>The <code>development.log</code> shows that the changed value of published_at_text is being passed in, but adding a call to Rails.logger in the setter seems to indicate that it's not even getting called.</p>\n\n<p>What am I missing here?</p>\n"},{"tags":["ruby","ruby-on-rails-3","web-services","http","video"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13029666,"title":"HTTP Video Streaming in Rails 3+","body":"<p>I need some help with the below:</p>\n\n<p>Ok the scenario is this: I am contacting a server and from the server I am getting this URI:</p>\n\n<pre><code>http://&lt;camera_ip_address&gt;/&lt;type_ID&gt;/&lt;part_ID&gt;\n</code></pre>\n\n<p>The documentation of this webservice says:</p>\n\n<pre><code>\"The part_ID will vary from part_start and part_end.\"\n</code></pre>\n\n<p>I got all the data needed. Now what I dont get is how this is related to HTTP video streaming?</p>\n\n<p>If I have part_start = 1 and part_end = 10, that means that I will \"download\" 10 frames?\nHow? with curl? wget? Rails?</p>\n\n<p>Should a loop be implemented like (example):</p>\n\n<pre><code>for i=1; i&lt;10 i++\n   download \"http://127.0.0.1/34/i\"\nend\n</code></pre>\n\n<p>What will \"http://127.0.0.1/34/10\" for example be? a png/jpeg frame file?\nAny help will be very useful. Thanks very much.</p>\n"},{"tags":["ruby-on-rails-3","devise","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13051669,"title":"Passing params through omniauth and facebook connect","body":"<p>I am trying to pass a params to omniauth callback but I am having issues.\nWhen the user choose to signup onto my website he has to choose if he is an adult on a teen then the signup form is displayed. If he choose to go with with facebook connect, after he click on facebook connect the signup form is displayed on the callback page but with all the field filled with his info except for the password.\nI would also like to retrieve his adult/teen choice but don't really know how to do it.\nI am using devise with omniauthable and here is what I did :</p>\n\n<p>Facebook Connect link :</p>\n\n<pre><code>&lt;%= link_to image_tag(\"connect-w-facebook.jpg\", alt: \"Connect with Facebook\"),      omniauth_authorize_path(:user,:facebook,{var: 'adult'}), :id =&gt;\"logo\", :class =&gt;'connect-face- img'  %&gt;\n</code></pre>\n\n<p>So I hard coded the variable for now to test how it's working.\nOn my callback page I have :</p>\n\n<pre><code>  &lt;%= debug request.env['omniauth.auth'] %&gt;\n  &lt;%= debug request.env['omniauth.params'] %&gt;\n</code></pre>\n\n<p>These two are nul and don't display anything except --- ... for these two field...\nThanks,</p>\n"},{"tags":["ruby","ruby-on-rails-3","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":649,"score":3,"question_id":8176104,"title":"How do you handle serialized edit fields in an Active Admin resource?","body":"<p>I have a model, <code>Domain</code>, which has a text field, <code>names</code>. </p>\n\n<pre><code>&gt; rails g model Domain names:text\n  invoke  active_record\n  create    db/migrate/20111117233221_create_domains.rb\n  create    app/models/domain.rb\n&gt; rake db:migrate\n==  CreateDomains: migrating ==================================================\n-- create_table(:domains)\n   -&gt; 0.0015s\n==  CreateDomains: migrated (0.0066s) =========================================\n</code></pre>\n\n<p>I set this field as <strong>serialized</strong> into an array in the model. </p>\n\n<pre><code># app/models/domain.rb\nclass Domain &lt; ActiveRecord::Base\n  serialize :names, Array\nend\n</code></pre>\n\n<p>Create the ActiveAdmin resource for this model</p>\n\n<pre><code>&gt; rails g active_admin:resource Domain\n    create  app/admin/domains.rb\n</code></pre>\n\n<p>then, in the app/admin/domains.rb, I setup the various blocks to handle the serialized field as such</p>\n\n<pre><code># app/admin/domains.rb\nActiveAdmin.register Domain do\n\n  index do\n    id_column\n    column :names do |domain|\n      \"#{domain.names.join( \", \" ) unless domain.names.nil?}\"\n    end\n    default_actions\n  end\n\n  show do |domain|\n    attributes_table do\n      row :names do\n        \"#{domain.names.join( \", \" ) unless domain.names.nil?}\"\n      end\n    end\n  end\n\n  form do |f|\n    f.inputs \"Domain\" do\n      f.input :names\n    end\n    f.buttons\n  end\n\n  # before we save, take the param[:domain][:name] parameter,\n  # split and save it to our array\n  before_save do |domain|\n    domain.names = params[:domain][:names].split(\",\") unless params[:domain].nil? or params[:domain][:names].nil?\n  end\nend\n</code></pre>\n\n<p>Nearly everything works great -- my names are displayed as comma separated in the index and show views. When I update a record with my names field set to \"a,b,c\", the before_save works to turn that into an array that is then saved via the ActiveRecord serialize.</p>\n\n<p>What I can not solve is how to make the edit form put in a comma-separated list into the text field. I tried using a partial and using formtastic syntax directly as well as trying to make it work via the active_admin DLS syntax. Does anyone know how to make this work?</p>\n\n<p><strong>Specifically, if I have the following array saved in my domain.names field:</strong></p>\n\n<pre><code># array of names saved in the domain active_record\ndomain.names = [\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p><strong>how to change:</strong></p>\n\n<pre><code>      form do |f|\n        f.inputs \"Domain\" do\n          f.input :names\n        end\n        f.buttons\n      end\n</code></pre>\n\n<p><strong>so that when the <code>edit</code> form is loaded, in the text field instead of seeing <code>abc</code>, you see <code>a,b,c</code>.</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","passenger","phusion-passenger"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13063234,"title":"What are the main reasons for passenger server shut down periodically?","body":"<p>In my rails application, I am using </p>\n\n<p><code>Apache + ruby 1.9.2p180 + Rails 3.0.5 + Phusion Passenger version 3.0.13</code> </p>\n\n<p>Can somebody please tell me why my passenger shut down periodically. Somebody please help </p>\n\n<pre><code>This is the last error after which the application stops working\n\n[Fri Aug 31 02:07:23 2012] [error] [client 141.212.121.10] Premature end \nof script headers: \n[ pid=17952 thr=1 file=ext/apache2/Hooks.cpp:817 time=2012-08-31 \n02:07:23.257 ]: The backend application (process 13680) did not send a \nvalid HTTP response; instead, it sent nothing at all. It is possible \nthat it has crashed; please check whether there are crashing bugs in \nthis application. \n[Fri Aug 31 04:20:55 2012] [notice] child pid 27795 exit signal \nSegmentation fault (11) \n[Fri Aug 31 04:20:56 2012] [notice] child pid 22071 exit signal \nSegmentation fault (11) \n[Fri Aug 31 04:21:03 2012] [notice] child pid 13025 exit signal \nSegmentation fault (11) \n[Fri Aug 31 04:21:04 2012] [notice] child pid 24538 exit signal \nSegmentation fault (11) \n[Fri Aug 31 04:21:06 2012] [notice] child pid 17065 exit signal \nSegmentation fault (11)\n\nI am using \nruby 1.9.2p180 \nRails 3.0.5 \nPhusion Passenger version 3.0.13\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","routing","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13064844,"title":"Rails routing - :on => :collection","body":"<p>The rails routing guide doesn't specify what <code>:on =&gt; :collection</code> means..</p>\n\n<p>I cannot find an explanation to what the :on key is what is a :collection in that context</p>\n"},{"tags":["ruby-on-rails-3","exception-handling","error-handling","custom-error-pages"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":240,"score":2,"question_id":10316675,"title":"Exception notifier - how to display own error pages?","body":"<p>I use <strong>exception_notification</strong> gem for handling an errors in an app.\nMy <strong>ApplicationController</strong> looks like this:</p>\n\n<pre><code>unless Rails.application.config.consider_all_requests_local\n    rescue_from Exception,\n                :with =&gt; :render_error\n    rescue_from ActiveRecord::RecordNotFound,\n                :with =&gt; :render_not_found\n    rescue_from ActionController::RoutingError,\n                :with =&gt; :render_not_found\n    rescue_from ActionController::UnknownController,\n                :with =&gt; :render_not_found\n    rescue_from ActionController::UnknownAction,\n                :with =&gt; :render_not_found\n  end\n\n  def render_not_found(exception)\n    ExceptionNotifier::Notifier\n      .exception_notification(request.env, exception)\n      .deliver\n    render :template =&gt; \"/errors/404.html.erb\",\n      :layout =&gt; 'errors.html.erb'\n    return     \n  end\n\n  def render_error(exception)\n    ExceptionNotifier::Notifier\n      .exception_notification(request.env, exception)\n      .deliver\n    render :template =&gt; \"/errors/500.html.erb\",\n           :layout =&gt; 'errors.html.erb'\n    return\n  end\n</code></pre>\n\n<p>In <strong>/config/enviroments/productions.rg</strong> in the end of the file I have:</p>\n\n<pre><code>config.middleware.use ExceptionNotifier,\n  :email_prefix =&gt; \"[MY APP| Error Report] \",\n  :sender_address =&gt; %{\"MY APP\" &lt;err@my-app.com&gt;},\n  :exception_recipients =&gt; 'my_email@gmail.com'\nend\n</code></pre>\n\n<p>I have two problems:</p>\n\n<ol>\n<li><p>when I get the error on the app - eg. <code>Article.find(not-existing-ID)</code>, I'll get the standard error page (ERROR 500) from <code>/public/500.html</code> and not from the file specified  in application controller... How is that possible? Past hours I tried to find the problem, but I still don't know the issue.</p></li>\n<li><p>when I set to the url un-existing page, I get the error number 404 - but in this case I don't get the email notification about this problem. Is there any way to handle that? And the second thing, again is displayed the standard error 404 page, not the page from <code>/errors/404.html.erb</code></p></li>\n</ol>\n\n<p>Could anyone give me some advice, how to solve these problems?</p>\n"},{"tags":["ruby-on-rails-3","heroku","safari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":10773897,"title":"Safari can't get HEROKU's cookie","body":"<p>I am sorry that I am not able to provide much info because I totally have no idea about this weird problem.</p>\n\n<p>I have a fb canvas app which is written by rails 3.2.2 .</p>\n\n<p>There is not any problem on my local machine (Mac OS X 10.7.4).</p>\n\n<p>When I deploy it to heroku, it is fine with chrome and firefox. However, when I use Safari to browse it, Safari can't get any cookie from heroku. (it shows \"This site has no cookies\" in developer tool, but it works well on my local machine.)</p>\n\n<p>I have googled this problem, and I get something like <a href=\"http://viget.com/extend/rails-sessions-not-working-with-safari-a-solution\" rel=\"nofollow\">this</a> and <a href=\"http://www.litespeedtech.com/support/forum/showthread.php?t=2037\" rel=\"nofollow\">this</a>, but I don't think these are the case of mine.</p>\n\n<p>any suggestion?</p>\n\n<p>If you need any specific info about my code to solve this problem, please let me know.</p>\n\n<p>I will appreciate it very very much!!</p>\n"},{"tags":["ruby-on-rails-3","nginx","rvm","passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13063778,"title":"Error installing Phusion Passenger","body":"<p>I've been trying to install Phusion Passenger on my Centos VPS hosting a rails 3 app but I keep getting the following error: </p>\n\n<pre><code>Installing Phusion Passenger Standalone...\n[********************************             ] Preparing Nginx... \\           \nchecking for OS\n + Linux 2.6.18-238.12.1.el5xen x86_64\nchecking for C compiler ... found but is not working\n\n./configure: error: C compiler gcc is not found\n</code></pre>\n\n<p>I've followed all the instructions from <a href=\"http://stackoverflow.com/questions/12770501/c-compiler-gcc-not-found-while-installing-passenger-and-nginx/12998464#12998464\">here</a> but it doesn't seem to make any difference. Among other things I've tried is downloading the nginx-1.2.3 source and compiling them manually using a different source directory and they compile and install correctly. But when I try to run passenger start from my rails app, it will trigger the installation all over again. Running nginx -v does show it as installed. Any help would be appreciated ! I'm running Ruby 1.9.2.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","exception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13063433,"title":"undefined method `is_current' for #<ActiveRecord::Relation:0x38622a8> in ruby on rails update data","body":"<p>I'm trying to update some data in database but I'm getting this error:</p>\n\n<pre><code>undefined method `is_current' for #&lt;ActiveRecord::Relation:0x38622a8&gt;\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>@user = User.where(\"user_id = #{user_id} and is_current = 1\") \n\nif @user.nil?\n  puts\"xxxxxxxxxxxxxxxxxxxxxxxxxxx\"\nelse \n  @user.is_current = 0\n  @user.to = Time.now\n  @user.save\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","oop","class"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13061001,"title":"Ruby on Rails 3: Toggle Boolean with Forms","body":"<p>Users are able to send each other messages on my Ruby app.  The table is as followed:</p>\n\n<pre><code>t.string   \"content\"\nt.integer  \"from_id\"\nt.integer  \"reply_to_id\"\nt.boolean  \"read\",       :default =&gt; false\n</code></pre>\n\n<p>I have recently added the boolean, :read, and I have the form linked to messages in their inbox.  When they click \"Mark Read\" (the link provided via the form) I want it to toggle :read => true.  </p>\n\n<p>I am currently unable to accomplish this.  This is my current setup.</p>\n\n<pre><code>_mark_read.html.erb\n  &lt;%= form_for(:message, :mark_read =&gt; {read: true}) do |f| %&gt;\n    &lt;div&gt;&lt;%= f.hidden_field :read %&gt;&lt;/div&gt;\n    &lt;%= f.submit \"Mark Read\", class: \"btn-link\" %&gt;\n  &lt;% end %&gt;\n\nClass MessagesController &lt; ApplicationController\n  def mark_read\n    @message = current_user.messages.build\n    @message.toggle!(:read)\n  end\n\nconfig/routes.rb\n match '/mark_read' =&gt; 'messages#mark_read', :via =&gt; :post, :as =&gt; :mark_read\n</code></pre>\n\n<p>When I click \"Mark Read\", here is my debug info:</p>\n\n<pre><code>--- !ruby/hash:ActiveSupport::HashWithIndifferentAccess\nutf8: ✓\nauthenticity_token: ---\nmessage: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  read: 'false'\ncommit: Mark Read\ncontroller: static_pages\naction: connect\n</code></pre>\n\n<p>I can see it is not even using my controller... and even so; I don't think I have it set up correctly.</p>\n\n<p>Any advise as to how this should be set up would be kindly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","paypal","ipn"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13008814,"title":"Rails PayPal IPN notify_url is not called","body":"<p>So, I have a router with global IP address (Yeah, I know it will NOT work with the local ones, like 192.168.xx.xx) address and I've triple checked that it IS accessible from the outside. </p>\n\n<p>I'm currently working in the sandbox environment.</p>\n\n<p>I have all my payment options in the hidden :encrypted field (see appropriate railscast) that are being posted to PayPal. On the PayPal side everything is running pretty much smooth - I complete my payment and so on, but IPN is never called. There is simply no log-entry for my action being triggered (no errors/warnings or whatsoever), however there should be at least something.  </p>\n\n<p>I've tried to pass the notify_url 2 ways: 1) in the options hash in my purchase model, before being encrypted to :encrypted field; <code>:notify_url =&gt; notify_url</code> 2) notify_url as a separate hidden field explicitly => <code>&lt;%= hidden_field_tag :notify_url, notify_url %&gt;</code> 3) Combination of pts 1 and 2.</p>\n\n<p>But it is hopeless - nothing seems to be working. :(  </p>\n\n<p>I have also tried to enabling the IPN in my sandbox business account settings, but that didn't do any help either.</p>\n\n<p>What should I do in this situation ? </p>\n\n<p>P.S I have also tried out the IPN Simulator service, and it seems to be working. What is wrong with it then ? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","deployment","nginx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13049096,"title":"Changes made in rails app /public directory not reflecting on server","body":"<p>I have an replica of the live app that is deployed on the server. I have made some changes: like inserted 2 css and js files in /public directory that serves my assets and included in the views where they are required .It is working fine on my Local machine but when I pushed the changes to the server it is not reflecting over there. I am Using Nginx and I have tried restarting it as well but it didn't help either. \nAs I am new to NGINX and the App is deployed on a centos I dont know how it works. \nI already have precompiled assets, So I don't know how to make it run. I have tried </p>\n\n<blockquote>\n  <p>Clearing the cache from tmp directory but didn't work.</p>\n</blockquote>\n\n<p>I have set my </p>\n\n<blockquote>\n  <p>config.serve_static_assets = false</p>\n</blockquote>\n\n<p>in my production.rb and tried restarting but didn't work either</p>\n\n<p>Any help ??</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":26,"score":0,"question_id":13062063,"title":"Run rails application without installing rails gem","body":"<p>Is it possible to run a rails application without installing rails gem in your system.?? If yes, please provide me some reference for it. </p>\n"},{"tags":["ruby-on-rails-3","capistrano","bundler","dreamhost"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":180,"score":1,"question_id":9913308,"title":"Deploying Rails on dreamhost shared server","body":"<p>Im trying to deploy my Rails app on dreamhost shared server. Been following this article </p>\n\n<p><a href=\"http://railstips.org/blog/archives/2008/12/14/deploying-rails-on-dreamhost-with-passenger/\" rel=\"nofollow\">http://railstips.org/blog/archives/2008/12/14/deploying-rails-on-dreamhost-with-passenger/</a></p>\n\n<p>But in the last step ,  </p>\n\n<pre><code>cap deploy:migrations\n</code></pre>\n\n<p>i get this error</p>\n\n<pre><code>Could not find rake-0.9.2.2 in any of the sources \n</code></pre>\n\n<p>First time I am trying to deploy rails app ever so im pretty lost..</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","capistrano"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":967,"score":2,"question_id":9573614,"title":"rails / capistrano - error compiling assets","body":"<p>When I deploy with capistrano I get an error (and rollback) when capistrano attempts to run assets:precompile.</p>\n\n<p>I'm using rails 3.2.1, bundler 1.0.22, capistrano 2.11.2</p>\n\n<p>If I run rake assets:precompile from /webapps/myapp/current it runs successfully.</p>\n\n<p>error:</p>\n\n<pre><code>failed: \"sh -c 'cd /webapps/myapp/releases/20120304160347 &amp;&amp; bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile'\"\n</code></pre>\n\n<p>deploy.rb</p>\n\n<pre><code>require \"bundler/capistrano\"\nload 'deploy/assets'\nset :application, \"myapp\"\nset :domain, '24.17.71.95'\nset :repository,  \".\" \nset :deploy_via, :copy\nset :local_repository, '/home/me/myapp/.git'\nset :deploy_to, '/webapps/myapp/'\nset :scm, :none #:git\nset :user, 'me'\nset :password, 'me$pw'\n# Or: `accurev`, `bzr`, `cvs`, `darcs`, `git`, `mercurial`, `perforce`, `subversion` or `none`\ndefault_run_options[:pty] = true \nrole :web, domain                       # Your HTTP server, Apache/etc\nrole :app, domain                          # This may be the same as your `Web` server\nrole :db, domain, :primary =&gt; true # This is where Rails migrations will run\nset :branch, 'master'\n# if you're still using the script/reaper helper you will need\n# these http://github.com/rails/irs_process_scripts\nbefore \"deploy:assets:precompile\", \"bundle:install\"\n# If you are using Passenger mod_rails uncomment this:\n namespace :deploy do\n   task :start do ; end\n   task :stop do ; end\n   task :restart, :roles =&gt; :app, :except =&gt; { :no_release =&gt; true } do\n     run \"#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}\"\n   end\n end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","jquery-plugins","file-upload","csrf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":234,"score":2,"question_id":12074200,"title":"Can't verify CSRF token IE 9 only, Rails 3 app","body":"<p>So I am using jquery file upload in a rails 3 app, and everything works beautifully, well except in IE 9 that is.  Only in IE9, when I try to upload a file, I keep getting the 'cant verify csrf token' error in my console. I installed Firebug lite to inspect it, and the correct csrf token is correct and is in the right place in the document (and yes I have my &lt;%= csrf_meta_tags %> tag in the header of layout file). Not sure why it is only doing this in IE 9, has anyone seen this before?</p>\n"},{"tags":["ruby-on-rails-3","deployment","rvm","capistrano"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":710,"score":0,"question_id":8674957,"title":"Capistrano can't find a JavaScript runtime","body":"<p>I have a problem with Capistrano deploying to a server with RVM and gemsets</p>\n\n<pre><code>executing `deploy:assets:precompile'\n* executing \"cd /var/app/releases/20111229233555 &amp;&amp; rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile\"\n*** [err ::] rake aborted!\n*** [err ::] Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs for a list of available runtimes.\n*** [deploy:update_code] rolling back\nfailed: \"rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell '1.9.2@mygemset' -c 'cd /var/app/releases/20111229234715 &amp;&amp; rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile'\"\n</code></pre>\n\n<p>This is my Capfile</p>\n\n<pre><code>  $:.unshift(File.expand_path('./lib', ENV['rvm_path']))\n  require 'rvm/capistrano'\n  set :rvm_bin_path, \"$HOME/.rvm/bin\"\n  set :rvm_ruby_string, '1.9.2@mygemset'\n  set :rvm_type, :user\n  load 'deploy/assets'\n</code></pre>\n\n<p>When I log in as the very same user which is used by Capistrano the failing command is executed without any problems.</p>\n\n<p>It seems that Capistrano is using some other environment. </p>\n\n<p>Here is my <code>~/.rvmrc</code> file:</p>\n\n<pre><code>   rvm_gemset_create_on_use_flag=1 rvm_trust_rvmrcs_flag=1\n</code></pre>\n\n<p>Is there a way how to check which ruby and gemset is used at the execution time?</p>\n\n<p>node.js is and V8 are installed on the system, and all needed gems are in Gemfile:</p>\n\n<p>here is my <code>rvm info</code>:</p>\n\n<pre><code>   ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.9.2p290\"\n    date:         \"2011-07-09\"\n    platform:     \"x86_64-linux\"\n    patchlevel:   \"2011-07-09 revision 32553\"\n    full_version: \"ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-linux]\"\n\n  homes:\n    gem:          \"/home/capistrano/.rvm/gems/ruby-1.9.2-p290@mygemset\"\n    ruby:         \"/home/capistrano/.rvm/rubies/ruby-1.9.2-p290\"\n\n  binaries:\n    ruby:         \"/home/capistrano/.rvm/rubies/ruby-1.9.2-p290/bin/ruby\"\n    irb:          \"/home/capistrano/.rvm/rubies/ruby-1.9.2-p290/bin/irb\"\n    gem:          \"/home/capistrano/.rvm/rubies/ruby-1.9.2-p290/bin/gem\"\n    rake:         \"/home/capistrano/.rvm/gems/ruby-1.9.2-p290@mygemset/bin/rake\"\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13061206,"title":"Javascript default in Rails 3.0","body":"<p>In the file <code>application.html.erb</code>, I see the line</p>\n\n<pre><code>  &lt;%= javascript_include_tag :defaults %&gt;\n</code></pre>\n\n<p>What does <code>:defaults</code> mean here? What Javascript files does it include?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","redirect","route"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13060991,"title":"routing & routes in rails","body":"<p>I currently have an app that when a user signs up, it is being routed to index (basic/\"Welcome Aboard\" rails page)</p>\n\n<p>In the users_controller.rb I have a create method with the following redirect:</p>\n\n<pre><code>redirect_to root_url, :notice =&gt; \"Signed up!\"\n</code></pre>\n\n<p>And in the routes files I have the following:</p>\n\n<pre><code>root :to =&gt; \"users#new\"\n</code></pre>\n\n<p>When a user creates a valid signup, it is to redirect to the users#new (basically the same page)  However, it is redirecting to the default index file in rails.</p>\n\n<p>Any thoughts as to why it is doing this, what may I be missing?  I am pretty sure this is all the necessary info, but if more is need please let me know.  Thanks</p>\n"},{"tags":["ruby-on-rails-3","heroku","amazon-s3","carrierwave","fog"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13057621,"title":"Heroku taking too much time to upload to S3 (carrierwave and fog)","body":"<p>I have a Rails app, when the user calls one action from the web the heroku app generates a random image, upload that image to S3 and the returns to the user the public url of that image (stored in s3)... </p>\n\n<p>The \"upload that image to S3\" takes literately ages, it takes for a file of 27kb 20 seconds, that's not possible... I really don't know how to fix this, because the thing is working, it's uploading to s3 but taking way too much...</p>\n\n<p>I was thinking in just storing the image in the tmp folder from the rails app but I don't know how long is going to be there before being deleted... Any idea?</p>\n\n<p>thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":911,"score":2,"question_id":4707471,"title":"Render template and change url string in browser?","body":"<p>I have 2 actions - Edit and Update. Form in Edit submits the values to Update action. When saving a model fails I render edit teplate, where user sees errors and fields are prepopulated with what he filled before. There's a huge but for me - in URL panel in user's browser there's /user/update, even when (and because) I <strong>rendered</strong> edit template. Can I somehow change that with passing some parameters to render method in update action? I don't want the user to see that there's any (update) action aside of edit. Is it possible?</p>\n"},{"tags":["javascript","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13060503,"title":"Automatically adding numbers in Rails form_for","body":"<p>This is a <code>form_for</code> in my Rails view:    </p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;%= f.label :num1 %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :num1 %&gt;\n  &lt;%= f.label :num2 %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :num2 %&gt;\n  &lt;%= f.label :sum %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :sum %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I would like to make it so that, when the user inputs numbers into the first two fields, the third field automatically shows the sum of the two numbers, but the user can manually change the third field. I'm not sure how I could do this, maybe with some Javascript?</p>\n"},{"tags":["ruby-on-rails-3","url","internationalization","locale"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1056,"score":3,"question_id":8390394,"title":"Switch language with URL rails 3","body":"<p>I have a site in both french and english.  I want the user to be able to switch language on the fly when they click a link in the header.  Pretty straigforward.</p>\n\n<p>i have followed the rails 3 guide and i have this:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\nbefore_filter :set_locale\ndef set_locale\n    I18n.locale = params[:locale] || I18n.default_locale\nend\n\nprotect_from_forgery\n\n  def default_url_options(options={})\n  logger.debug \"default_url_options is passed options: #{options.inspect}\\n\"\n  { :locale =&gt; I18n.locale }\n   end\nend\n</code></pre>\n\n<p>my routes look like this:</p>\n\n<pre><code>scope \"(:locale)\", :locale =&gt; /en|fr/ do\n\nmatch 'home' =&gt; 'home#index'\nmatch 'home/ajax_twitter' =&gt; 'home#ajax_twitter'\nmatch 'equipe' =&gt; 'equipe#index'\nmatch 'equipe/sylvain' =&gt; 'equipe#sylvain'\nmatch 'equipe/benoit' =&gt; 'equipe#benoit'\nmatch 'equipe/stephane' =&gt; 'equipe#stephane'\nmatch 'equipe/suemarie' =&gt; 'equipe#suemarie'\nmatch 'equipe/regis' =&gt; 'equipe#regis'\nmatch 'equipe/fred' =&gt; 'equipe#fred'\n\nmatch 'equipe/callback' =&gt; 'equipe#callback'\nmatch 'equipe/auth' =&gt; 'equipe#auth'\nmatch 'equipe/ajax_contact' =&gt; 'equipe#ajax_contact'\n\nmatch 'linkedinauth/callback' =&gt; 'linkedinAuth#callback'\nmatch 'linkedinauth/init_auth' =&gt; 'linkedinAuth#init_auth'\n\nmatch 'mission' =&gt; 'mission#index'\nmatch 'service' =&gt; 'service#index'\nmatch 'developmen' =&gt; 'developmen#index'\n\nmatch 'contact' =&gt; 'contact#index'\n\nmatch 'mandats' =&gt; 'mandats#index'\nend\n\nmatch '/:locale' =&gt; \"home#index\"\n</code></pre>\n\n<p>and in my view i do this:</p>\n\n<pre><code>&lt;% if I18n.locale == I18n.default_locale %&gt;\n  &lt;%= link_to \"English\", '/en'%&gt;\n\n&lt;% else %&gt;\n  &lt;%= link_to \"Français\", '/fr'%&gt;\n\n&lt;%end%&gt;\n</code></pre>\n\n<p>All works well in the home page, but if i try to switch language while i'm in a specific controller, i get returned to the home page.  I tried to add this:</p>\n\n<pre><code>&lt;% if I18n.locale == I18n.default_locale %&gt;\n  &lt;%= link_to \"English\", '/en/' + params[:controller]%&gt;\n\n&lt;% else %&gt;\n  &lt;%= link_to \"Français\", '/fr/' + params[:controller]%&gt;\n\n&lt;%end%&gt;\n</code></pre>\n\n<p>this fix the controller, but if we are in a specific action and switch again language, i get back to the 'index' of this controller.</p>\n\n<p>My Question:  what is the best way to deal with this?</p>\n\n<p>i guess i could implement something in the ApplicationController (filter) to check if a controller / action / id is passed and append it to the locale.  Or can i do this in the routes.rb?</p>\n\n<p>Regards</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","daemon"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13060339,"title":"Ruby script not running when Process.daemon is added","body":"<p>I have the following simple script, which checks an email account and if there is new mail it forwards the email and sends an SMS. This happens as expected when the script is run without <code>Process.daemon</code>. When it is added, and email is received at the email account, nothing happens (nothing is forwarded and no SMS is sent) and there are no error messages in the console. Any suggestions?</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire \"bundler/setup\"\nrequire \"mailman\"\nrequire \"twilio-ruby\"\n\nMailman.config.pop3 = {\n  :username =&gt; 'address@gmail.com',\n  :password =&gt; 'password',\n  :server   =&gt; 'pop.gmail.com',\n  :port     =&gt; 995,\n  :ssl      =&gt; true\n}\n\nMailman.config.poll_interval = 60\n\nMailman::Application.run do  \n  default do\n    begin\n      Ticket.receive_mail(message)\n      MailForwarder.forwarded_email(message).deliver\n      @account_sid = 'xxxxxxxxxxx'\n      @auth_token = 'xxxxxxxxxx'\n      @client = Twilio::REST::Client.new(@account_sid, @auth_token)\n      @account = @client.account\n      @sms = @account.sms.messages.create(\n        :from =&gt; '+1111111111',\n        :to =&gt; '+122222222',\n        :body =&gt; message.subject\n      )\n      puts @sms\n      puts \"#{message.subject}\"\n    rescue Exception =&gt; e\n      Mailman.logger.error \"Exception occurred whle receiving message:\\n#{message}\"\n      Mailman.logger.error [e, *e.backtrace].join(\"\\n\")\n    end\n  end\n  Process.daemon\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13059478,"title":"Rails - track user's \"actions\" with relationship models","body":"<p>I'm building a math exercise app. I want to store questions that are separated into exercises and each exercise belongs to a different section. Also there are multiple sections for each grade (12 grades in total).</p>\n\n<p>How do i track a user's answer (action)? For instance, when a user browses the app, decides to answer question 7 from exercise 'G1' in section 'G' of Grade 'Pre-K' and provides a correct answer i want to track that and in the future provide him with statistics about his performance.</p>\n\n<p>Currently there isn't a connection between my User model to the questions and i wanted to hear from others as to what would be the most efficient way to tackle this (maybe the models right now are completely wrong)</p>\n\n<p>This is the model diagram for now with has_many, belongs_to relationship (i'll add 'the_question':string and 'answer':string later on to the question model):\n<img src=\"http://i.stack.imgur.com/RAJzT.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13059351,"title":"AJAX with Rails 3.0","body":"<p>I read in <a href=\"http://guides.rubyonrails.org/ajax_on_rails.html\" rel=\"nofollow\">this guide</a> about AJAX with Rails that \"Rails 3.1 ships with jQuery as the default JavaScript library\". If I'm using Rails 3.0, how would the use of AJAX differ from what's specified in this guide? (It's hard for me to upgrade Rails version right now.)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13059225,"title":"Getting totals deep in associations?","body":"<p>I'm trying to get into the Rails3 mindset, and had an interesting problem.</p>\n\n<p>I have the following structure:</p>\n\n<ul>\n<li>User has_many Tasks</li>\n<li>Task has_many Assets</li>\n<li>Asset has a score attribute between 0 and 99</li>\n</ul>\n\n<p>I'd like to get a sum of all scores for each user, and I suspect scopes might be something useful...</p>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","url","title"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13059156,"title":"Rails fetch title tag from HTML","body":"<p>In my Rails controller, I have a URL that the user provides. I would like to extract the title from the <code>&lt;title&gt;...&lt;/title&gt;</code> tag in the HTML of that URL, and assign it to a variable <code>title</code>. How can I do that?</p>\n\n<p>EDIT: It would be a plus to do it without use of external package/library</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sorting","virtual-attribute"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13058279,"title":"insert reblogged articles in the right place in blog.articles array ordered by created_at","body":"<p>EDIT:\nActually I just decided against my way of reblogging and instead decided to implement it by copying and making a whole new record from the article and then add a reblogged: true column to it. A bit cleaner in logic in my opinion and it avoids all the problems listed below.</p>\n\n<hr>\n\n<p>In a blog app I've implemented the possibility of reblogging an article of someone else's blog through a join reblog model with two foreign keys. </p>\n\n<p>In my blogs show action I am then adding blog.articles with blog.reblogged_articles to one single array of articles. I then sort this array by the created_at attribute of each element. </p>\n\n<p>However, for the reblogged articles, I'd rather like to use the created_at attribute of their reblog join model, so that a reblogged article will initially appear on the top of the blog. A reblogged article should always get its position in the blog as if it was created by the owner of the blog. But currently, a reblogged article might appear on the bottom of the blog, if the article was created 3 years ago.</p>\n\n<p>I probably need to modify the created_at attributes of my reblogged_articles array before I put the two arrays together. But how do I do that?</p>\n\n<p>Edit:\nJust an example to clarify:</p>\n\n<p>Blog id 1:<br>\nArticle id 1, created_at: A year ago.<br>\nArticle id 2, created_at: A month ago.<br>\nArticle id 3, created_at: A week ago.<br>\nArticle id 4, created_at: A day ago.</p>\n\n<p>Blog id 2:<br>\nArticle id 5, created_at: A day ago.<br>\nArticle id 6, created_at: An hour ago.<br>\nArticle id 7, created_at: 30 minutes ago.<br>\nArticle id 8, created_at: About 10 minutes ago.  </p>\n\n<p>Now, Blog 2 reblogs Article 1 of Blog 1.\nI want this article to be displayed on the top of Blog 2, as if it has been created just now. However, since that article in fact was created a year ago, it will be displayed on the bottom of Blog 2. How can I get around this?</p>\n\n<p>What's the smartest approach to bring reblogged articles in their \"correct\" position based upon the created_at of the join model Reblog instead of the created_at of the article itself?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","whitespace"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13059707,"title":"Rails print whitespace from controller","body":"<p>I'd like to debug a variable <code>@num</code> in my Rails controller, so I'm evaluating </p>\n\n<pre><code>&lt;%= @num %&gt; \n</code></pre>\n\n<p>in my Rails view. However, I cannot distinguish between <code>@num</code> being <code>'', ' '</code>, and <code>'  '</code> (and other different types of whitespace) when it's printed in the HTML. Is there any way to print it out clearly?</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13058999,"title":"Paperclip with Attachment_on_the_Fly setup","body":"<p>I want to display multiple images on one of my web pages.  These images are on my server so I don't need to upload them.  I just want to build something like a method like <code>showThumb(image)</code> and inside the method use the Attachment_on_the_Fly to display it like so:</p>\n\n<pre><code>def showThumb(image)\n    image.attachment.s_640_width\nend\n</code></pre>\n\n<p>So that in my view I can do this to display the image with <code>&lt;%= @object.showThumb(pic.jpg) %&gt;</code>\nBut in the Attachment_on_the_Fly documentation it says 'Setup your models the same way you normally do with Paperclip'.  But in the Paperclip documentation it only shows how to upload a file, create a database and a controller.  I don't know how to set up the model and/or controller for what I want to do.</p>\n\n<p>thanks,</p>\n\n<p>mike </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","view"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13058737,"title":"Rails not use application.html.erb","body":"<p>I know that by default, views in Rails use the template provided in <code>application.html.erb</code>. However, there's one view that I wouldn't like to use the template provided in <code>application.html.erb</code>, but rather write all the HTML in that view itself. Is that possible to do?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13041279,"title":"Ruby On Rails: One-to-Many with One-to-One","body":"<p>I have templates and template versions. A template can have many template_versions, but only one active template_version at any given time. I have the following two models:</p>\n\n<pre><code>class Template &lt; ActiveRecord:Base\n    has_many :template_versions, :class_name =&gt; 'TemplateVersion'\n    belongs_to :active_version, :class_name =&gt; 'TemplateVersion'\nend\n\nclass TemplateVersion &lt; ActiveRecord:Base\n    belongs_to :template\n    has_one :template\nend\n</code></pre>\n\n<p>It's critical that a template only have one active template_version, which is why the key to the active_template is on the template model. This all seems fine until I test it in a rails console:</p>\n\n<pre><code>t = Template.new()\ntv = TemplateVersion.new()\nt.active_version = tv\nt.save\n\nversion = t.active_version //returns version\nversion.template_id //returns nil\n</code></pre>\n\n<p>The template knows about its active template_version, but the problem is that the template_version doesn't know what template it belongs to. I'm guessing this is because on the insert to the DB, the template_version is created to get the id to associate the template with, which would then have to be saved to hand back the template id to populate the template version.</p>\n\n<p>Is there a way of accomplishing all this? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13057736,"title":"Using Ruby to Parse through JSON when the JSON object is nested?","body":"<p>I have a JSON object that is posted to my rails controller. For some reason Rails is unable to parse the JSON object.</p>\n\n<p>This is resulting in null: <code>Rails.logger.info params[:payload][\"commits\"]</code></p>\n\n<p>Here is the rails code:</p>\n\n<pre><code>before_filter :set_payload\n\ndef create\n    params[:payload] = @payload\n    Rails.logger.info params[:payload][\"commits\"]\n .........\n\nprotected\n\n  def set_payload\n    @payload = {\n      \"data\" =&gt; {\n        \"api_version\" =&gt; \"2.0.alpha1\",\n        \"username\" =&gt; \"jamie.winsor\",\n        \"password\" =&gt; \"passw0rd\",\n        \"server_url\" =&gt; \"http://jira\"\n      },\n\n      \"payload\" =&gt; {\n        \"after\"   =&gt; \"a47fd41f3aa4610ea527dcc1669dfdb9c15c5425\",\n        \"ref\"     =&gt; \"refs/heads/master\",\n        \"before\"  =&gt; \"4c8124ffcf4039d292442eeccabdeca5af5c5017\",\n        \"compare\" =&gt; \"http://github.com/mojombo/grit/compare/4c8124ffcf4039d292442eeccabdeca5af5c5017...a47fd41f3aa4610ea527dcc1669dfdb9c15c5425\",\n        \"forced\"  =&gt; false,\n        \"created\" =&gt; false,\n        \"deleted\" =&gt; false,\n\n        \"repository\" =&gt; {\n          \"name\"  =&gt; \"grit\",\n          \"url\"   =&gt; \"http://github.com/mojombo/grit\",\n          \"owner\" =&gt; { \"name\" =&gt; \"mojombo\", \"email\" =&gt; \"tom@mojombo.com\" }\n        },\n\n        \"pusher\" =&gt; {\n          \"name\" =&gt; \"rtomayko\"\n        },\n\n        \"commits\" =&gt; [\n          {\n            \"distinct\"  =&gt; true,\n            \"removed\"   =&gt; [],\n            \"message\"   =&gt; \"[#WEB-249 status:31 resolution:1] stub git call for Grit#heads test\",\n            \"added\"     =&gt; [],\n            \"timestamp\" =&gt; \"2007-10-10T00:11:02-07:00\",\n            \"modified\"  =&gt; [\"lib/grit/grit.rb\", \"test/helper.rb\", \"test/test_grit.rb\"],\n            \"url\"       =&gt; \"http://github.com/mojombo/grit/commit/06f63b43050935962f84fe54473a7c5de7977325\",\n            \"author\"    =&gt; { \"name\" =&gt; \"Tom Preston-Werner\", \"email\" =&gt; \"tom@mojombo.com\" },\n            \"id\"        =&gt; \"06f63b43050935962f84fe54473a7c5de7977325\"\n          },\n          {\n            \"distinct\"  =&gt; true,\n            \"removed\"   =&gt; [],\n            \"message\"   =&gt; \"clean up heads test\",\n            \"added\"     =&gt; [],\n            \"timestamp\" =&gt; \"2007-10-10T00:18:20-07:00\",\n            \"modified\"  =&gt; [\"test/test_grit.rb\"],\n            \"url\"       =&gt; \"http://github.com/mojombo/grit/commit/5057e76a11abd02e83b7d3d3171c4b68d9c88480\",\n            \"author\"    =&gt; { \"name\" =&gt; \"Tom Preston-Werner\", \"email\" =&gt; \"tom@mojombo.com\" },\n            \"id\"        =&gt; \"5057e76a11abd02e83b7d3d3171c4b68d9c88480\"\n          },\n          {\n            \"distinct\"  =&gt; true,\n            \"removed\"   =&gt; [],\n            \"message\"   =&gt; \"add more comments throughout\",\n            \"added\"     =&gt; [],\n            \"timestamp\" =&gt; \"2007-10-10T00:50:39-07:00\",\n            \"modified\"  =&gt; [\"lib/grit.rb\", \"lib/grit/commit.rb\", \"lib/grit/grit.rb\"],\n            \"url\"       =&gt; \"http://github.com/mojombo/grit/commit/a47fd41f3aa4610ea527dcc1669dfdb9c15c5425\",\n            \"author\"    =&gt; { \"name\" =&gt; \"Tom Preston-Werner\", \"email\" =&gt; \"tom@mojombo.com\" },\n            \"id\"        =&gt; \"a47fd41f3aa4610ea527dcc1669dfdb9c15c5425\"\n          }\n        ]\n      }\n    }\n\n  end\n\nend\n</code></pre>\n\n<p>Any ideas why nil is being returned? Am I handling the JSON object incorrectly? Thanks</p>\n"},{"tags":["ruby-on-rails-3","activerecord","checkbox","submit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13056318,"title":"how to correctly store values of selected checkboxes in rails?","body":"<p>After searching long time Im unable to find any information on how to best store values of selected checkboxes in rails.</p>\n\n<p>I do something like:</p>\n\n<pre><code>  = form_for @profile, :url =&gt; request.fullpath, :method =&gt; :get,  :html =&gt; { :class =&gt; 'form-  horizontal' } do |f|\n      - @contacts.each do |contact|\n        = check_box_tag \"contact[#{ contact.slug }]\", contact.id, true\n        //= label_tag \"contact[#{contact.id}]\", contact.slug\n     = f.submit t('forms.go')\n</code></pre>\n\n<p>On form submit this gives me params:</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"✓\", \"contact\"=&gt;{\"1\"=&gt;\"bladadie\", \"2\"=&gt;\"jolanteds03\",\n    \"3\"=&gt;\"jannie6674\", \"4\"=&gt;\"henriette1305\",\n    \"5\"=&gt;\"amy6456\", \"6\"=&gt;\"jacquelyn9001\", \"7\"=&gt;\"florencio4872\",\n    \"8\"=&gt;\"angel410\", \"9\"=&gt;\"rita558\", \"10\"=&gt;\"chadd2684\", \"11\"=&gt;\"ilene8219\",\n    \"12\"=&gt;\"sonny664\", \"13\"=&gt;\"monique7912\", \"14\"=&gt;\"merritt28103744\",\n    \"15\"=&gt;\"sunny80771258\", \"16\"=&gt;\"lavinia31942066\", \"17\"=&gt;\"jada29655747\",\n    \"18\"=&gt;\"johan16227289\", \"19\"=&gt;\"cristobal9746087\",\n    \"20\"=&gt;\"meggie3447530\"}, \"commit\"=&gt;\"Go »\"}\n</code></pre>\n\n<p>How Would I correctly store the values of those checked, checkboxes?</p>\n\n<p>I'm unable to find any info on this. Hope someone can shed some light!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13054380,"title":"No route matches {:controller=>\"artifacts\", :action=>\"edit\"}","body":"<p>I keep getting these errors for no route matches for actions 'edit'</p>\n\n<p>controller:</p>\n\n<pre><code>def remove_artifact_from_collection\n\n... do my stuff ..\n\nrender(:action=&gt;:show)\nend\n</code></pre>\n\n<p>view: the line on which it errors</p>\n\n<pre><code>&lt;p&gt;&lt;%= link_to 'Edit Evidence Item', edit_artifact_path, :class =&gt; 'edit_button' %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :artifacts do\n    collection do\n    get 'remove_artifact_from_collection'\n    end\nend\n</code></pre>\n\n<p>bundle exec rake routes</p>\n\n<pre><code> remove_artifact_from_collection_artifacts GET    /artifacts/remove_artifact_from_collection(.:format)      {:controller=&gt;\"artifacts\", :action=&gt;\"remove_artifact_from_collection\"}\n                                 artifacts GET    /artifacts(.:format)                                      {:controller=&gt;\"artifacts\", :action=&gt;\"index\"}\n                                           POST   /artifacts(.:format)                                      {:controller=&gt;\"artifacts\", :action=&gt;\"create\"}\n                              new_artifact GET    /artifacts/new(.:format)                                  {:controller=&gt;\"artifacts\", :action=&gt;\"new\"}\n                             edit_artifact GET    /artifacts/:id/edit(.:format)                             {:controller=&gt;\"artifacts\", :action=&gt;\"edit\"}\n                                  artifact GET    /artifacts/:id(.:format)                                  {:controller=&gt;\"artifacts\", :action=&gt;\"show\"}\n                                           PUT    /artifacts/:id(.:format)                                  {:controller=&gt;\"artifacts\", :action=&gt;\"update\"}\n                                           DELETE /artifacts/:id(.:format)                                  {:controller=&gt;\"artifacts\", :action=&gt;\"destroy\"}\n</code></pre>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","hover"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13055584,"title":"HTML title attribute in Rails displaying only first word","body":"<p>Got a weird little problem. </p>\n\n<p>I want to create the text hover on an item to display that item's \"description,\" which is an attribute of that item's model. So I basically did this in my view:</p>\n\n<pre><code>&lt;div title=&lt;%= item.description %&gt; &gt;&lt;%= item.name %&gt;&lt;/div&gt;\n</code></pre>\n\n<p>The weird thing is, while all the model calls are working correctly (item.name and item.description are calling up the right things), only the first word of item.description is showing up when I hover. In other words, if item.description is \"This is a super cool item!\", when I hover over that div with item.name, the hover just says \"This\". </p>\n\n<p>This may have something to do with the :description attribute, which is currently of type text, (which I thought was for long strings, like my descriptions). But maybe not. </p>\n\n<p>Any idea why this might be happening, and how to fix it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","has-one"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13055000,"title":"How do you override the getter method for a Rails has_one association?","body":"<p>I want to override/extend a Rails <code>has_one</code> association method so that it <em>always</em> returns an instance of the associated class. (If none already exists in the database, I want to create a new one and assign it to the parent instance.)</p>\n\n<p>Ideally, I'd like to do this through the <a href=\"http://guides.rubyonrails.org/association_basics.html#association-extensions\" rel=\"nofollow\">built-in Rails association extension mechanism</a>. However, I don't know the name of the \"getter\" method, and so I don't know what to override.</p>\n\n<p>How do I override the association getter so that I can instantiate a new object when it's nil?</p>\n"},{"tags":["ruby-on-rails-3","heroku","delayed-job","background-process","sidekiq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13055084,"title":"how to correctly use background job for file upload rails app heroku","body":"<p>i am working on a rails app that takes uploaded files from a user and pushes them to box. the issue is that this times out on some requests because the api call takes too long. i want to move this process to a worker process, but am not sure how to persist the file between the time the user uploads the file and the time the worker takes the job off the queue. all of the examples i have seen seem to skip this part or don't deal with using an api that is not s3. i thought about storing the file in the database, but the box api expects a file object (curl -F @file) and not just the contents of the file. any pointers on how this would be accomplished? i am looking to use sidekiq for performance reasons but delayed_job would be ok as well</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","image","cloud"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13054278,"title":"Simplest solution for uploading images to cloud service","body":"<p>What is the simplest way to allow people to upload an image to a cloud server (in a Rails 3 app)? I want to include an \"upload image\" button in the form, and store the address in my model. I'd also like to be able to constrain the file size.</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13055046,"title":"Rails 3 Drag and drop between folders","body":"<p>I have tree structure in my application like folders when I click on folders on same page its going to show all files under that folder\nwith an ajax call.</p>\n\n<p>Folders has many files.</p>\n\n<p>So now my problem is, I want to drag file from one folder to another folder. So that if files folder_id which I am dragging is 1, when I drop it to Folder 2, in back end it should update as folder_id= 2</p>\n\n<p>I am not getting any idea to do this, </p>\n\n<ol>\n<li>How can I enable user to drag file and drop in any folders</li>\n<li>Once he dragged and dropped, how should I update in back end</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13054206,"title":"Comparison on boolean fields not working in Rails","body":"<p>I have a <code>Post</code> model, with a <code>posted</code> boolean field.</p>\n\n<p>I created a new Post, without assigning anything to <code>posted</code>.</p>\n\n<pre><code>irb(main):012:0&gt; Post.first.posted\n  Post Load (9.0ms)  SELECT \"posts\".* FROM \"posts\" LIMIT 1\n=&gt; nil\n</code></pre>\n\n<p>Now, I want to select all posts where <code>posted</code> is not equal to <code>true</code>.</p>\n\n<p>I tried this, but it doesn't work:</p>\n\n<pre><code>irb(main):016:0&gt; Post.where(\"posted != ?\", true)\n  Post Load (2.5ms)  SELECT \"posts\".* FROM \"posts\" WHERE (posted != 't')\n=&gt; []\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activeadmin","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13054718,"title":"Using gmaps4rails with Active Admin, no maps","body":"<p>I am trying to get <a href=\"https://github.com/apneadiving/Google-Maps-for-Rails\" rel=\"nofollow\">gmaps4rails</a> with <a href=\"http://activeadmin.info/\" rel=\"nofollow\">Active Admin</a> in Rails Rails 3.2.8.</p>\n\n<p>I have been trying to follow <a href=\"http://kalapun.com/blog/2012/05/17/rails-maps-and-activeadmin/\" rel=\"nofollow\">this tutorial</a> but have needed to adapt it as I am using mysql in my stack.</p>\n\n<p>I am not getting any errors (which might help!) but I am also not getting any maps. </p>\n\n<p>My model (<strong>location</strong>) has the attributes <em>longitude:float, langitude:float</em> and <em>gmaps:boolean</em></p>\n\n<p>I have added the following to the locations model, which is different to the tutorial:</p>\n\n<pre><code>def location\n    [:latitude, :longitude]\nend\n</code></pre>\n\n<p>and this to the active admin locations model, also different from the tutorial:</p>\n\n<pre><code>f.input :location do |o|\n           gmaps(\"markers\" =&gt; {data: o.to_gmaps4rails}, \"map_options\" =&gt;  { auto_zoom: false, zoom: 15 })\n     end\n</code></pre>\n\n<p>As far as I can tell (by scanning through the rendered source files) the CSS and JavaScript seem to be loading.</p>\n\n<p>The whole app is available <a href=\"https://bitbucket.org/mildfuzz/aperture_current\" rel=\"nofollow\">here</a></p>\n\n<p>Other that those changes, I think I have stuck to the tutorial.</p>\n"},{"tags":["ruby-on-rails-3","cron","rake","email-integration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13054329,"title":"Rails 3: Rake output for emails from cron -- \"puts\" in my model code?","body":"<p>We have a bunch of periodic tasks that we run with custom rake tasks via cron (which is generated by the mos' excellent <a href=\"https://github.com/javan/whenever\" rel=\"nofollow\">whenever gem</a>.  Output from these tasks is emailed to a mailing list.</p>\n\n<p>I want to standardize the email format, not to be fancy, just so we can set up filters in mail clients to detect when there are either good or bad things we might care about -- subjects, such as an error processing a file \"[ERROR] (db_backup) file foo.bar not found\", or \"[INFO] (widget_sender) 240 widgets sent to 32 customers\".  The email should have details like start time, total execution, and useful outputs and should be easy enough to scan.</p>\n\n<p>Several problems:</p>\n\n<ul>\n<li>We use sendgrid for email, and it joins lines of text when it converts to HTML.  We have found that adding a <code>\\r</code> (newline) to the end of <code>puts</code> output causes, but this seems ... yuck!</li>\n<li>Some of the output is generated from our rake tasks themselves. <code>puts \"something happened\\r\"</code> seems ... yuck.</li>\n<li>Many of the tasks call methods defined within our regular libraries or models.  Seems like <code>Rails.logger.info \"something else happened\"</code> would seem to be the best solution -- in some cases the same methods are called as part of application execution as well as from the periodic rake task so it would be nice for the logger to do the right thing depending on context -- either write to the log, or send to STDOUT.</li>\n<li>I would like a formatted subject on the email -- probably done easily enough within <code>whenever</code></li>\n</ul>\n\n<p>Are there any good patterns I might follow to handle these special kinds of tasks and reporting that anyone can recommend?  Gems?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","rails-admin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13054093,"title":"Heroku and Rails Admin 404 Error","body":"<p>I seem to be getting a very long series of errors when trying to load Rails Admin on my app. The entire app works fine on Heroku except for this one element. </p>\n\n<p>The error seems to be so long that my console will only display a certain length of lines (even if using <code>heroku logs -n 3000</code>). </p>\n\n<p>The error is as follows:</p>\n\n<pre><code> 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:213:in `aggregate_column'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:234:in `execute_simple_calculation'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:208:in `perform_calculation'\n\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:159:in `calculate'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:58:in `count'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/lib/rails_admin/adapters/active_record.rb:53:in `count'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/lib/rails_admin/config/actions/dashboard.rb:26:in `block (3 levels) in &lt;class:Dashboard&gt;'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/lib/rails_admin/config/actions/dashboard.rb:24:in `each'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/lib/rails_admin/config/actions/dashboard.rb:24:in `block (2 levels) in &lt;class:Dashboard&gt;'\n 2012-10-24T16:39:55+00:00 app[web.1]:   (eval):8:in `instance_eval'\n 2012-10-24T16:39:55+00:00 app[web.1]:   (eval):8:in `dashboard'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/implicit_render.rb:4:in `send_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/base.rb:167:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/rendering.rb:10:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/notifications.rb:123:in `block in instrument'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/callbacks.rb:18:in `block in process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-pjax-0.6.0/lib/rack/pjax.rb:12:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/notifications.rb:123:in `instrument'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/instrumentation.rb:29:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/params_wrapper.rb:205:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/railties/controller_runtime.rb:18:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:35:in `block in call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `catch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/base.rb:121:in `process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/rendering.rb:45:in `process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal.rb:203:in `dispatch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal.rb:246:in `block in action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:66:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:66:in `dispatch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:30:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/conditionalget.rb:25:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/head.rb:14:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/remotipart-1.0.2/lib/remotipart/middleware.rb:30:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:570:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/rack/logger.rb:26:in `call_app'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:479:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/railtie/configurable.rb:30:in `method_missing'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/rack/logger.rb:16:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/request_id.rb:22:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:570:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/static.rb:53:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/params_parser.rb:21:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/flash.rb:242:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:479:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/cookies.rb:338:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/query_cache.rb:64:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:79:in `pre_process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:39:in `receive_data'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/railtie/configurable.rb:30:in `method_missing'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/backends/base.rb:63:in `start'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:81:in `block in pre_process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/controllers/controller.rb:86:in `start'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:79:in `catch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/application.rb:220:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:54:in `process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:405:in `_run__3119720662384712530__call__3373774757668482244__callbacks'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:405:in `__run_callback'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/bin/thin:6:in `&lt;top (required)&gt;'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/server.rb:159:in `start'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:152:in `run!'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:187:in `run_command'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:81:in `run_callbacks'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/callbacks.rb:27:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in`&lt;main&gt;'\n 2012-10-24T16:39:55+00:00 app[web.1]:\n 2012-10-24T16:39:55+00:00 app[web.1]: cache: [GET /admin] miss\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in`load'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run_machine'\n 2012-10-24T16:39:55+00:00 app[web.1]:\n 2012-10-24T16:39:55+00:00 heroku[router]: GET rocky-depths-5693.herokuapp.com/admin dyno=web.1 queue=0 wait=0ms service=447ms status=500 bytes=643\n 2012-10-24T16:39:46+00:00 heroku[web.1]: State changed from starting to up\n</code></pre>\n\n<p>Everything seems to work fine in Development so I am not sure why it's not working in Production. </p>\n\n<p>If anyone has any suggestions on what might be causing this with Rails_admin then they would be much appreciated!</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","dns","routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13043043,"title":"Rails: accessing network.domain.com renders root for domain.com","body":"<p>I'm trying to set up a subdomain <code>network</code> for my domain. In my <code>config/routes.rb</code> I have:</p>\n\n<pre><code>constraints :subdomain =&gt; /network.*/ do\n  ...\n\n  # Root\n  match '/' =&gt; 'questions#index'\n  match '' =&gt; 'questions#index'\n  root :to =&gt; 'questions#index', :as =&gt; 'network_root'\nend\n\nroot :to =&gt; 'frontend#home'\n</code></pre>\n\n<p>However, sometimes when I access network.domain.com (in production) it shows the root for the whole application (frontend#home). Accessing the subdomain in development works as expected.</p>\n\n<p>EDIT: I've just noticed that requests to the app root (domain.com/) and subdomain root (network.domain.com/) do not get logged in my production.log. Any other page loads work as expected.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","asset-pipeline"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":1380,"score":8,"question_id":7267651,"title":"How can I reference images in the asset pipeline from a model?","body":"<p>I have a model with a method to return a url to a person's avatar that looks like this:</p>\n\n<pre><code> def avatar_url\n   if self.avatar?\n     self.avatar.url # This uses paperclip\n   else\n     \"/images/avatars/none.png\"\n   end\n end\n</code></pre>\n\n<p>I'm in the midst of upgrading to 3.1, so now the hard-coded none image needs be referenced through the asset pipeline. In a controller or view, I would just wrap it in <code>image_path()</code>, but I don't have that option in the model. How can I generate the correct url to the image?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","web-services","api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":10638078,"title":"Building a gateway between two web applications?","body":"<p>I'm interested in building a gateway that serves as a secure channel between a Ruby on Rails application (A) and some other application (B).  Communication between the applications will be bidirectional, authenticated, and encrypted.  I'm a bit new to building web apps though, and I'm not sure exactly how to begin.  </p>\n\n<p>Do you think a web service would solve this problem?  If so, the service will have to send requests to B; does this mean that B will have to build some kind of proxy to push/pull data from the gateway service?  This will require the gateway service to have a DB of its own to store requests from A and responses from B, correct?</p>\n\n<p>Any input here would be awesome.  Thank you for your time.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13052308,"title":"Using array in routes.rb","body":"<p>Using Rails 3. I have the following:</p>\n\n<pre><code># shop.rb\nSHOP_TYPES = %w(cafe restaurant station)\n\n# routes.rb\nresources :shops do\n  member do\n    get :nearby_cafes, :nearby_restaurants, :nearby_stations\n  end\nend\n</code></pre>\n\n<p>Instead of updating my <code>routes.rb</code> everytime I add another member in the <code>SHOP_TYPES</code> array, is there anyway to read the array in the <code>routes.rb</code>?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":334,"score":3,"question_id":9644786,"title":"How to translate timezone full names to tz abbreviations?","body":"<p>In a Rails 3.x app I need to display time zone abbreviations (EST, PST, CST, etc.) rather than the full time zone name.  I've seen a number of discussions that seem to address the issue, but in overly verbose manners.</p>\n\n<p><strong>Is there a gem or a very concise method to handle this that could be used to map them properly?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13049973,"title":"rails namespace caching before filter method?","body":"<p>Rails 3, Ruby 1.9.3</p>\n\n<p>hey guys, our app has three namespaces: admin, store and account. Each one has your own application controller but only store and account call a before_filter method named foo, defined inside the main application controller.</p>\n\n<p>Just to clarify, this method loads a collection to fill a select tag inside the app layout.</p>\n\n<p>Sometimes while we are navigating through the app and we switch from namespaces, ex:</p>\n\n<p>We go from store/products/index to account/orders/index</p>\n\n<p>The before_filter is not called, the collection is never loaded and because of this we got a nil error in the view because the variable was never set.</p>\n\n<p>The weirdest thing is if we open the main application controller (where foo method is defined) and just save it, with no modifications and reload the page, the error is gone.</p>\n\n<p>Seems like somehow the application controller is being cached or something else.</p>\n\n<p>Does anyone have a clue of what is going on here? </p>\n"},{"tags":["ruby","ruby-on-rails-3","sass","rack","scss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13043420,"title":"Render SASS files correctly in File.read (inside PDF file)","body":"<p>I generate a pdf and have to include css in the generated file so that the styling is correct in the pdf.  To do this I have</p>\n\n<pre><code>&lt;%= File.read(Rails.root.join(\"app\", \"assets\", \"stylesheets\", \"application.css.scss\")) %&gt;\n&lt;%= File.read(Rails.root.join(\"app\", \"assets\", \"stylesheets\", \"app.css.scss\")) %&gt;\n</code></pre>\n\n<p>But the sass isn't templated correctly.  Does anyone know what the correct code to render the files right are?</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":459,"score":0,"question_id":8015382,"title":"Log out all user with Devise","body":"<p>I'm using devise in my ruby-on-rails app. I have a User class and an AdminUser class using devise. In my admin panel I would like to logout all Users but not AdminUsers.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","documentation","yard"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":8914710,"title":"How can I state and display documentation related to constant values in a proper way?","body":"<p>I am using Ruby on Rails 3.1.0 and I am trying to use YARD 0.7.4. I would like to document constant values, so in my class I state this:</p>\n\n<pre><code># [Fixnum] Test constant documentation.\nTEST_CONSTANT = 1\n</code></pre>\n\n<p>but the HTML output after I run the <code>yardoc</code> (or <code>yard doc</code>) command is the following:</p>\n\n<p><img src=\"http://i.stack.imgur.com/R6gqS.png\" alt=\"enter image description here\"></p>\n\n<p>In the above image is shown that the HTML documentation is not good rendered/generated, at least not as I would expect. I read the <a href=\"http://rubydoc.info/docs/yard/0.7.4/file/docs/GettingStarted.md\" rel=\"nofollow\">YAML documentation</a> but I still have some problem on that: <strong>how can I better state and display documentation related to constant values?</strong></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13051416,"title":"What is a call back method in rails?","body":"<p>What the heck is a call back method in rails? I see this term being used everywhere while I learn about controllers and models. Can someone provide examples please?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":231,"score":3,"question_id":6453267,"title":"How to disable db:schema:dump for migrations","body":"<p>I dont want Rails 3 to generate my schema every time I do migration. How to properly disable it?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","actionmailer","rspec-rails","sendgrid"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":391,"score":6,"question_id":10961982,"title":"ActionMailer sending real emails in test mode! - How to turn off?","body":"<p>Newly signed up users to my little app must be approved by the admin (me) before they can gain access to the site.  I've succeeded in generating such emails in development with an <code>after_create :send_admin_email</code> in my user model which works great.  My problem is that I'm  generating multiple users during my tests (using FactoryGirl) and each test user created  sends off a real email.  Running my tests is like pouring molasses in January and I've got to delete hundreds of emails sent to my inbox.  How do I turn that off?</p>\n\n<p><a href=\"http://guides.rubyonrails.org/action_mailer_basics.html\" rel=\"nofollow\">Action Mailer Basics</a> in the <a href=\"http://guides.rubyonrails.org/index.html\" rel=\"nofollow\">Rails Guides</a> tells me that \"By default Action Mailer does not send emails in the test environment. They are just added to the ActionMailer::Base.deliveries array.\"</p>\n\n<p>Moreover, in <code>config/environments/test.rb</code> I've got:</p>\n\n<pre><code>config.action_mailer.delivery_method = :test\n</code></pre>\n\n<p>That's in addition to in <code>config/environment.rb</code> having:</p>\n\n<pre><code># Configuration for using SendGrid on Heroku\nActionMailer::Base.smtp_settings = {\n  :address        =&gt; 'smtp.sendgrid.net',\n  :port           =&gt; '587',\n  :authentication =&gt; :plain,\n  :user_name      =&gt; 'app[my app number]@heroku.com',\n  :password       =&gt; '[something super secret]',\n  :domain         =&gt; '[let's get this party started!.com]',\n  :enable_starttls_auto =&gt; true\n}\nActionMailer::Base.delivery_method = :smtp\n</code></pre>\n\n<p>I'm sure that I'm missing something simple and basic.  I've searched around and related questions and posts deal with how to test that ActionMailer actually sent email.</p>\n\n<p>Humble gratitude in advance for any thoughts or help.</p>\n\n<p>Addendum:  Following answer to similar question found at <a href=\"http://stackoverflow.com/questions/10609113/is-it-possible-to-turn-off-actionmailer-emails-when-cucumber-testing-is-happenin\">Is it possible to turn off ActionMailer emails when cucumber testing is happening on development?</a> I was able to stop the email sending madness.  Still, I had to add <code>ActionMailer::Base.delivery_method = :test</code> to several rspec files.  Is there a way I can shut this down globally?  Anyone have any thoughts on what's going on?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13051528,"title":"How to redirect two different routes by single controller?","body":"<p>I have two same routes <code>resources :errors</code> with different url's in different folders inside the <code>routes.rb</code>. </p>\n\n<pre><code>Routes:\n---------\n\nnamespace :enr do\n  namespace :locations do #( url: enr/locations/:location_id/errors)\n    resources: errors \n  end\n\n  namespace :rds do\n    resources :errors #(url: enr/rds/errors)\n  end\nend\n\ncontroller:\n------------\n\nI have a controller for `enr/rds/errors` only. \n</code></pre>\n\n<p>how to change these two url's by <code>IF</code> condition. For example,  </p>\n\n<p>if location_id is nil\n  i need to show this #<code>(url: enr/rds/errors)</code>\nelse\n  I need to show <code>(url: enr/locations/:location_id/errors)</code>\nend</p>\n\n<p>So it will change depends upon the <code>location_id</code>. Where should i write this condition to change the url's by the <code>location_id</code>. Any Example would be more appreciated. Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13051924,"title":"Better way in adding sequence index in id attribute","body":"<p>Using Rails 3. I am using the <code>each_with_index</code> to generate the sequence:</p>\n\n<pre><code>&lt;% @shops.each_with_index do |shop, i| %&gt;\n  &lt;div class=\"item map-marker\" id=\"shop_&lt;%= i+1 %&gt;\"&gt;\n</code></pre>\n\n<p>I tried using <code>div_for</code>, but it takes the <code>shop.id</code> instead. Is there any better way to do this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap"],"answer_count":3,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":5730,"score":9,"question_id":10133783,"title":"How can I change cols of textarea in twitter-bootstrap?","body":"<p>If I change the value of :rows, it works. But it stays at the default cols whatever value I set with ':cols =>'. Column width won't change.</p>\n\n<p>I viewed the html source and it reflected the change. I wonder that bootstrap's CSS might be the suspect...</p>\n\n<p>HTML (there is a \"cols=\" in the final HTML, but column width stays at the default value, which is 30. I can't believe my eyes!)</p>\n\n<pre><code>&lt;textarea cols=\"100\" id=\"comment_body\" name=\"comment[body]\" rows=\"5\"&gt;&lt;/textarea&gt;\n</code></pre>\n\n<p>Rails:</p>\n\n<pre><code>&lt;%= form_for([@post, @post.comments.build]) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;i class=\"icon-user\"&gt;&lt;/i&gt;\n    &lt;%= f.text_field :commenter %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;i class=\"icon-comment\"&gt;&lt;/i&gt;\n    &lt;%= f.text_area :body, :rows =&gt; 5, :cols =&gt; 100 %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;div&gt; \n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","session","authentication","before-filter"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":740,"score":0,"question_id":7743861,"title":"Rails 3 - authenticate and :before_filter","body":"<p>I am a newbie in Rails. I try to build a simple authenticate system, to <strong>application_controller</strong> I put following lines:</p>\n\n<pre><code>  def check_session\n    if session[:user]\n      if session[:expiry_time] &lt; 10.minutes.ago\n        reset_session\n      flash[:warning] = 'You was logout.' \n        redirect_to root_url\n      else\n        session[:expiry_time] = Time.now\n      end\n    else\n      #... authenticate\n      session[:expiry_time] = Time.now\n      flash[:warning] = 'You was logout.' \n      redirect_to root_url\n    end\n  end  \n</code></pre>\n\n<p>My problem is in one action - in this action I check, if the user is log in or not. And if the user is log in, so I will render one template, and if not, so I will render the second one. It looks like:</p>\n\n<pre><code>&lt;% unless session[:user].nil? %&gt;\n  &lt;%= render :template =&gt; 'template_for_login_user' %&gt;\n&lt;% else %&gt;\n  &lt;%= render :template =&gt; 'template_for_not_login_user' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And here is the problem - this doesn't works me. At least... well - if I am not log in, so will be render the template <strong>template_for_not_login_user</strong> and if I am, so <strong>template_for_login_user</strong>. This is right.</p>\n\n<p>But if I am log in and I am on the <strong>template_for_login_user</strong>, but I am 15min idle => the session will be expired => I should be redirect to login form. But here is the problem - I am 15 minutes idle and I refresh this page, so I am still on the action <strong>template_for_login_user</strong> - and this is the problem...</p>\n\n<p>I would like to ask you - can you help me please, where could be a problem? What I'm doing wrong?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13051400,"title":"RoR : articles appears two many times","body":"<p>I've started using Ruby on Rails for a few days now, but I have a problem with the \"each do\" loops.</p>\n\n<p>Here's my AccueilController's code :</p>\n\n<pre><code>def index\n\n@postsTest = Post.last(1)\n@articles = Article.last(1)\n@articlesList = Article.last(2)\n\n    respond_to do |format|\n    format.html # index.html.erb\n    format.json { render json: @users }\nend\n</code></pre>\n\n<p>Here's my application.html.erb's code :</p>\n\n<pre><code>&lt;div id=\"container\"&gt;\n    &lt;div id=\"col1\"&gt;\n        &lt;%= render :partial =&gt; 'shared/listArticles', :collection =&gt; @articlesList %&gt;\n        &lt;div class=\"clear\"&gt;&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div id=\"col2\"&gt;\n        &lt;%= yield %&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And now my shared/listArticles's code :</p>\n\n<pre><code>&lt;% @articlesList.each do |article| %&gt;\n        &lt;div id=\"blocArticle\"&gt;\n            &lt;div id=\"pic\"&gt;\n                &lt;%= image_tag (article.photo.url(:thumb)) %&gt;\n            &lt;/div&gt;\n            &lt;div id=\"contentArticle\"&gt;\n                &lt;div id=\"titleArticle\"&gt;\n                    &lt;%= link_to article.title, article %&gt;\n                    &lt;div class=\"clear\"&gt;&lt;/div&gt;\n                &lt;/div&gt;\n                &lt;div id=\"contentArticleDesc\"&gt;\n\n                        &lt;%= link_to article.desc, article %&gt;\n\n                    &lt;div class=\"clear\"&gt;&lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"clear\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div class=\"clear\"&gt;&lt;/div&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;   \n</code></pre>\n\n<p>And my problem is that if I write <code>@articlesList = Article.last(2)</code> then the last two articles will appear two times; if I write <code>@articlesList = Article.last(3)</code> then the last three articles will appear three times etc...</p>\n\n<p>Of course, I would like that each of them appear just one time.</p>\n\n<p>Does someone have any ideas about the source of the problem ?</p>\n\n<p>Thanks a lot :)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":65,"score":-2,"question_id":13047969,"title":"Don't understand the difference between variable declarations, symbols, methods, instance variables, class variables","body":"<p>Updated this post as per post recommendations:\nInconsistent naming conventions in rails is confusing the heck out of me. IT SEEMS LIKE THE SYNTAX IS ALL OVER THE PLACE IN RAILS...  </p>\n\n<p><strong>Here are some examples:</strong></p>\n\n<p>Why are there commas in the migration below ? And why is keyword \"default\" not with a colon before it? What is this default keyword? a method, or a variable, a symbol.. What is that darn thing??:</p>\n\n<pre><code>add_column :zombies, :rotting, :boolean, default: false\n</code></pre>\n\n<p><strong>Here is another example:</strong></p>\n\n<p>Why age not :age (with a colon)? WHY IS make_rotting CALLED WITH A \" <strong>:</strong> \" BEFORE IT?? </p>\n\n<pre><code> class Zombie &lt; ActiveRecord::Base\n       before_save :make_rotting\n\n   def make_rotting\n      if age &gt; 20\n         self.rotting = true\n      end\n    end\n end\n</code></pre>\n\n<p>I am a Java guy, yes java is verbose but at-least its consistent I feel like going back :(</p>\n"},{"tags":["ruby","ruby-on-rails-3","plugins","redmine","redmine-plugins"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":11607405,"title":"Plugin migrations for Redmine: place plugin in db/migrate instead of plugin folder","body":"<p>I'm a newbie in ruby on rails and creating a redmine plugin. I created a model <code>Allissue</code> without using any column. Now I wanted to add a column <code>project_name</code> with the help of migration <code>./script/generate migration AddRoleToAllissue project_name:string</code>.</p>\n\n<p>But it places migration in folder <code>db/migrate</code> named <code>20120722192815_add_role_to_allissue.rb</code> instead of plugin migrate folder. I followed <a href=\"http://stackoverflow.com/questions/1221154/plugin-migrations-for-redmine\">stack-overflow question</a> and move migrated file to plugin folder <code>mv ./db/migrate/20120722192815_add_role_to_allissue.rb ./vendor/plugins/redmine_allissues/db/migrate/002_add_role_to_allissue.rb</code>.</p>\n\n<p>I just wanted to know alternative for plugin migration in which no need of moving migrated file to plugin folder. I'm not sure but there may be a command for plugin migration. Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","puma"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13042372,"title":"Puma .state file","body":"<p>I'm attempting to deploy my rails application w/ puma using Capistrano. Towards the end ofthe deployment it attempts to run </p>\n\n<p><code>bundle exec pumactl -S /home/deployer/production/shared/sockets/puma.state restart</code> </p>\n\n<p>which fails w/ </p>\n\n<pre><code>undefined method `has_key?' for false:FalseClass. \n</code></pre>\n\n<p>I have simply created a empty file for <code>puma.state</code>. My question is what exactly is this file and what is supposed to be in it? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13050778,"title":"Creating a specific custom route in rails 3","body":"<p>I have several levels of nested routing. </p>\n\n<pre><code> resources :departments do\n  resources :tasks do\n    collection do\n      get \"report\" =&gt; \"tasks#report\"\n    end\n end\n</code></pre>\n\n<p>This a piece of it. </p>\n\n<p>What I am attempting to do is create a custom route for a report.html.erb file. However, this route creates the path /department/:id/tasks/report</p>\n\n<p>I would like to create the path /department/:id/tasks/:id/report</p>\n\n<p>Is this possible? I considered creating a new controller and model for report but this seems to be inefficient. </p>\n"},{"tags":["ruby","ruby-on-rails-3","design-patterns","documentation-generation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13050947,"title":"Ruby doc generators that account for observers","body":"<p>Do any of the Ruby Doc Generators document the occurance of the ActiveRecord observer pattern?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13050224,"title":"ActionMailer sometimes not sending?","body":"<p>I have a problem where ActionMailer sometimes doesn't send emails. It is reproducible and affects certain people at certain times, although what is causing it is a mystery.</p>\n\n<p>It fails silently, although <code>config.action_mailer.raise_delivery_errors = true</code> is set.</p>\n\n<p>It enters the mail() routine, claims it has rendered the template:</p>\n\n<pre><code>Rendered notifier/notify_comment.html.erb (0.9ms)\n</code></pre>\n\n<p>And then skips the delivery and moves onto the next one. The next one is rendered &amp; delivered no problem. When emails are delivered, they are also printed to the console, so I can see it. The content of every email is the same, only the recipient is different.</p>\n\n<p>I cannot understand why this would be intermittent.</p>\n\n<p>How can I go about debugging this?</p>\n"},{"tags":["ruby-on-rails-3","mongodb","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1103,"score":0,"question_id":4942012,"title":"MongoDB : Mongoid and I18n translations","body":"<p>I am going to start a new project based on the top of MongoDB.</p>\n\n<p>My application will need to handle fields translations.</p>\n\n<p>I discovered a plugin named : <a href=\"https://github.com/Papipo/mongoid_i18n\" rel=\"nofollow\">Mongoid_i18n</a></p>\n\n<p>Is it the only one plugin interesting ? Or other plugins are available ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13050253,"title":"how will rails app create a db in server either from migration file or schema?","body":"<p>I have a rails <code>app</code> which i ran so far in my local system and now i got to move it to the <code>server</code> so what i need to know is how will it create a <code>database</code> either using the migration files or the schema? </p>\n\n<p>Also i would like to know if from migration, i added new fields and removed few migration file so how will it create the missing fields?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":18,"score":-2,"question_id":13050067,"title":"Call javascript function on update in remote_function","body":"<p>I am working in rails 2 and making an ajax call to controller using remote_function</p>\n\n<pre><code>&lt;%= select_tag \"leave_type\", list_of_leave_type() , :onchange =&gt;  remote_function(:url =&gt; { :controller =&gt; \"requests\" ,:action =&gt; 'getUserLeaveQuota'}, :update =&gt; \"leave_quota\")%&gt;\n</code></pre>\n\n<p>in :update i want to call a javascript function, Please help me out.\nThanks</p>\n"},{"tags":["ruby-on-rails-3","activerecord","mongoid","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13048692,"title":"RoR3 + Mongoid: Filtering has_many relations while returning a collection of parents","body":"<p>I want to be able to return all instances of a model that contains a has_many association, while filtering those children using some arbitrary criteria passed by the user.</p>\n\n<p>A simplistic example:</p>\n\n<ol>\n<li>I have a list of countries which has a has_many relationship with a user model.</li>\n<li>The user specifies some search criteria.</li>\n<li>I want to be able to list the users that match that criteria grouped by country, while also displaying the countries that does not contain any users matching that criteria.</li>\n</ol>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Country\n    include Mongoid::Document\n\n    field :name\n\n    has_many :users\nend\n\nclass User\n    include Mongoid::Document\n\n    field :name\n\n    belongs_to :country\nend\n</code></pre>\n\n<p>Sample output given the user entered \"John\":</p>\n\n<pre><code>Australia (2 users):\n    - John Smith\n    - John Doe\nIndia (0 users)\nPoland (1 user):\n    - John Citizen\n</code></pre>\n\n<p>Any help will be much appreciated!</p>\n"},{"tags":["ruby-on-rails-3","devise","multi-tenant"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13046788,"title":"Can I use acts_as_tenant in the devise user model?","body":"<p>My devise MODEL name is User. When I use it in combination with acts_as_tenant,</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n   acts_as_tenant(:tenant)\n</code></pre>\n\n<p>I get some weird behaviour: When users log into one tenant, everything is fine. As soon somebody signs into another tenant, the users of the first tenant are kicked out.</p>\n\n<p>I would like to set the User model to acts_as_tenant, as the users should be administered within each tenant.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13047469,"title":"Undefined local variable or method error","body":"<p>In my ruby on rails project, I found this error in <code>update</code>.</p>\n\n<pre><code>undefined local variable or method ` ' for #&lt;ProfileController:0x007fd904dc8568&gt;.\n</code></pre>\n\n<p>However, I can't find <strong>(` ')</strong> in my controller.</p>\n\n<p><strong>ProfileController#update</strong></p>\n\n<pre><code>def update       \n   unless params[:sport_name].nil? \n     ps_array = params[:sport_name]\n     level =[params[:level1],params[:level2],params[:level3]]\n     # play_sports id \n     sp_id = [params[:sp_id1], params[:sp_id2], params[:sp_id3]]\n\n     arr = [ps_array[\"1\"],ps_array[\"2\"],ps_array[\"3\"]]\n     sport_id = [params[:sport_id1],params[:sport_id2],params[:sport_id3]]\n     check = [params[:check1], params[:check2], params[:check3]]\n\n     if @user.play_sports.count != 0\n\n       (0..2).each do |i|\n           if (check[i].to_i == 1)\n           PlaySport.where(\"id = ?\", sp_id[i]).update_all(:is_active=&gt;false)\n           # new save \n           newuser_ps = PlaySport.new\n           newuser_ps.sport_id = arr[i]\n           newuser_ps.is_active = true\n           newuser_ps.level = level[i]\n           newuser_ps.user_id = current_user.id\n           newuser_ps.save\n         end\n       end\n     else         \n       (0..2).each do |i|    \n         newuser_ps = PlaySport.new\n         newuser_ps.sport_id = arr[i]\n         newuser_ps.level = level[i]\n         newuser_ps.is_active = true\n         newuser_ps.user_id = current_user.id\n         newuser_ps.save\n       end\n     end        \n   end\n\n\n   respond_to do |format|        \n   end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13047082,"title":"Stopping Post to external service looking for User ID","body":"<p>I'm not really sure how to describe this issue so will try to be clear.</p>\n\n<p>We have a page in our Rails application where our customers can update their credit card details. The form posts to an external service to verify the details. Then redirects back to us transparently.</p>\n\n<p>Initially I had the form in it's own controller for testing (working perfectly) but I've just moved it within my users_controller.</p>\n\n<p>The form posts and redirects to a confirm action which does some checks. When I post from within the users controller, I get an error:</p>\n\n<pre><code> Couldn't find User with id=k2hx5p36w3g9rxsz\n</code></pre>\n\n<p>Which in fact is the id of the transaction. Not the user.</p>\n\n<p>The url looks like this:</p>\n\n<pre><code> http://localhost:8080/settings/confirm?http_status=200&amp;id=k2hx5p36w3g9rxsz&amp;kind=update_payment_method&amp;hash=9c85b12c1242cd58de27b2582c934e34a0e9455e6\n</code></pre>\n\n<p>In my controller, I have this:</p>\n\n<pre><code>def billing\n  @user = current_user \n  @credit_card = current_user.default_credit_card  \n  @tr_data = CreditCard::TransparentRedirect.update_credit_card_data(:redirect_url =&gt; confirm_credit_card_info_url, :payment_method_token =&gt; @credit_card.token)\n  ...\nend\n\ndef credit_card_confirm\n  @user = current_user \n  @result = CreditCard::TransparentRedirect.confirm(request.query_string)\n\n  if @result.success?\n    redirect_to user_billing_path, :notice =&gt; \"Credit card updated\"\n  else\n    render :action =&gt; \"billing\"\n  end\nend\n</code></pre>\n\n<p>And in my routes:</p>\n\n<pre><code>match '/settings/confirm' =&gt; 'users#credit_card_confirm', :as =&gt; :confirm_credit_card_info\n</code></pre>\n\n<p>What can I do to avoid it taking the ID as the User ID?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","redirect"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":838,"score":0,"question_id":5658291,"title":"construct url without subdomain in rails 3","body":"<p>I'm currently detecting whether a user has a certain subdomain and redirecting the user to the url without the subdomain as such:</p>\n\n<pre><code>subdom = request.subdomains.first\nif subdom == \"redirectme\"\n  redirect_to(request.protocol + request.domain + \":\" + request.port.to_s)\nend\n</code></pre>\n\n<p>As you can see, I'm reconstructing the domain manually to not include the subdomain to replace something like:\n<a href=\"http://redirectme.example.com:3000\" rel=\"nofollow\">http://redirectme.example.com:3000</a>\nto:\n<a href=\"http://example.com:3000\" rel=\"nofollow\">http://example.com:3000</a></p>\n\n<p>However, I have to keep in mind that sometimes there won't be a port (and so the colon after the domain is redundant) and I suspect there are other things I didn't account for.\nWhat's a better way of getting the full domain without its subdomain component?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13036179,"title":"Running total in Rails and Active Record","body":"<p>I have a table with workouts with the following key columns:</p>\n\n<p><strong>workout_id</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>distance</strong><br>\n1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3<br>\n2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.1<br> </p>\n\n<p>Let's say I want to write a Rails active record query so that I get these columns plus a running total of the distance, like so:</p>\n\n<p><strong>workout_id</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>distance</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>running_total</strong><br>\n1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3<br>\n2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4<br></p>\n\n<p>How could I do such a thing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12862076,"title":"Rails wicked gem redirect with params","body":"<p>I am using the wicked gem to build a form wizard. In the documentation it is using the current_user object but I want to use a different object. I am struggling with adding a parameter to redirect_to so I can use this object.</p>\n\n<p>products_controller.rb</p>\n\n<pre><code>def create\n  @product = current_user.product.build(params[:product])\n  @product.ip_address = request.remote_ip\n\n  if @product.save\n    redirect_to product_steps_path # This is where I think I need to pass product object but not sure how\n  else\n    render 'new'\n  end\nend\n</code></pre>\n\n<p>product_steps_controller.rb</p>\n\n<pre><code>class ProductStepsController &lt; ApplicationController\n  include Wicked::Wizard\n  steps :apps, :templates\n\n  def show\n    @product = Product.find(params[:id])\n    render_wizard\n  end\nend\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :products\nresources :product_steps\n</code></pre>\n\n<p>The error I get with the above code is:</p>\n\n<pre><code>ActiveRecord::RecordNotFound in ProductStepsController#show\n\nCouldn't find Product with id=apps\n</code></pre>\n\n<p>How do I use the wicked gem on a specific object like this instead of the current_user example in the documentation?</p>\n\n<p>Thank You</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","stored-procedures","sybase"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13046191,"title":"how to handle the dummy stored procedure using CURSOR to return value to the front end?","body":"<p>I want to create a CURSOR in a stored procedure to handle some dummy value. In the store I need to write a dummy query like if Select 1..... to display successful message and if its not 1 or some negative value it should handle the error as what it is and display into the front-end. </p>\n\n<p>I am using Ruby on Rails in front end and Sybase 11 is the database. Thanks in advance! Any Example will be more appreciated. </p>\n\n<p>Here the example of What I tried....</p>\n\n<pre><code>ALTER PROCEDURE \"DBA\".\"sp_ProcessRDSAPBatch\"( in UserID char(10) ) \nbegin\n\n    declare cur_location_reference dynamic scroll cursor for select Lo_Code\n      from dba.RDSAPbatchLocation where User_ID = UserID;\n\n    open cur_location_reference with hold;\n      locloop: loop\n        fetch next cur_location_reference into Location_code;\n        if sqlstate = err_notfound then\n          leave locloop\n        end if;\n\n        if Location_code is not null then\n            //do some query\n        else\n           raiserror 99999 \"Location ID: %1! not found.\", @Location_Code\n        end if\n\n      end loop locloop;\n      close cur_location_reference;\n    // end of new cursor\nend\n</code></pre>\n"},{"tags":["javascript","html","ruby-on-rails-3","angularjs"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":221,"score":1,"question_id":12244774,"title":"Dynamic Add attribute in <form> angularJs","body":"<p>I am trying to add Dynamic add attribute in  using angularJs Directive\nI want to add html tag in form dynamically </p>\n\n<p>My view : </p>\n\n<pre><code>&lt;div ng-show=\"edit_tasks\"&gt;   \n   &lt;edittask-form&gt;&lt;edittask-form&gt; \n&lt;/div&gt;\n</code></pre>\n\n<p>My Form Html</p>\n\n<pre><code>{\n&lt;div&gt;\n  &lt;form ng-submit=\"submitFrom()\" csrf-tokenized&gt;\n    Task Name&lt;input type=\"text\" placeholder=\"Name\" ng-model=\"newtask.name\" required /&gt;\n    Task Description&lt;input type=\"text\" placeholder=\"Description\" ng-model=\"newtask.description\" required /&gt;\n    Start Date &lt;input type=\"text\" placeholder=\"Start date\" ng-model=\"newtask.start_date\" required /&gt;\n    Start Date &lt;input type=\"text\" placeholder=\"End date\" ng-model=\"newtask.end_date\" required /&gt;\n    &lt;input type=\"submit\" value=\"submit\" /&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n}\n</code></pre>\n\n<p>My Directives</p>\n\n<pre><code>module.directive(\"edittaskForm\", function() {\n  return {\n    restrict: \"E\",\n    templateUrl: \"&lt;%=asset_path 'tasks/task_form.html' %&gt;\",\n    controller: tasksCtrl,\n    replace: false,\n    link: function(scope, elt, attrs, controller) {\n          scope.form = elt.find(\"form\");\n          console.log(scope.form);\n\n          scope.taskEdit = function(task) {\n            scope.task =  task;\n            scope.show_tasks = false;\n            scope.edit_tasks = true;\n            scope.newtask = task;\n          };\n        }\n  }\n});\n</code></pre>\n\n<p>How Can I add <code>&lt;input type=\"text\" name=\"xyz\" /&gt;</code>\nin form</p>\n\n<p>Thk's in Advance</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":13045989,"title":"Could not find gem 'mocha (= 0.12.3) x86-mingw32'","body":"<p>I try to launch redmine from IDE:</p>\n\n<blockquote>\n  <p>rails/redmine/script/rails server -b 127.0.0.1 -p 3000 -e development</p>\n</blockquote>\n\n<p>but I am getting error:</p>\n\n<blockquote>\n<pre><code>/resolver.rb:287:in `resolve': Could not find gem 'mocha (= 0.12.3) x86-mingw32' in the gems available on this machine. (Bundler::GemNotFound)\n</code></pre>\n</blockquote>\n\n<p>I installed mocha:</p>\n\n<pre><code>gem install mocha\n</code></pre>\n\n<p>But error still appear.</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap","simple-form"],"answer_count":1,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":2195,"score":9,"question_id":10547502,"title":"Append/prepend bootstrap icons with simple_form","body":"<p>Twitter Bootstrap icons are pretty deadly <a href=\"http://twitter.github.com/bootstrap/base-css.html#icons\" rel=\"nofollow\">seen here</a>. </p>\n\n<p>Look at the bottom right hand corner of that section. See that email with an icon prepended? That is what I want to do. I want to make simple_form and boostrap play nicely.</p>\n\n<p>Here's what I've found that will prepend the icon to the input:</p>\n\n<pre><code>= f.input :email, :wrapper =&gt; :append do\n  = f.input_field :email\n  &lt;span class=\"add-on\"&gt;&lt;i class=\"icon-envelope\"&gt;&lt;/i&gt;&lt;/span&gt;\n</code></pre>\n\n<p>But it isn't flush (that could be fixed by changing offsets in CSS) and it's pretty ugly. For reference, here is the CSS fix (add it to your bootstrap_overrides.css.less file):</p>\n\n<pre><code>.input-prepend .add-on,\n.input-append input {\n  float: left; }\n</code></pre>\n\n<p>Does someone know a less hacky way to make simple_form prepend or append an icon with bootstrap?</p>\n\n<h3>Update:</h3>\n\n<p>The answer below made me have another look at it. HAML usually adds whitespace everywhere, but there is a <a href=\"http://haml.info/docs/yardoc/file.HAML_REFERENCE.html#whitespace_removal__and_\" rel=\"nofollow\">workaround</a></p>\n\n<p>Here is an update for the original HAML which removes the whitespaces and doesn't require the CSS hack:</p>\n\n<pre><code>= f.input :email, :wrapper =&gt; :append do\n  = f.input_field :email\n  %span.add-on&gt;\n    %i.icon-envelope\n</code></pre>\n\n<p>That little greater than (>) makes all the difference. The output HTML has no newlines between the input and the span.</p>\n"},{"tags":["javascript","ruby-on-rails-3","aurigma"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13042868,"title":"Aurigma 7, How to hide checkAll checkbox in the folderpane header","body":"<p>Is there a way to hide checkAll checkbox in the aurigma uploader ver 7 (folder pane header)</p>\n\n<p>i tried this way, but it doesn't take any effects </p>\n\n<blockquote>\n  <p>iu.addParam(\"ButtonCheckAllText\", \"\");<br>\n  iu.addParam(\"ButtonUncheckAllText\", \"\");</p>\n</blockquote>\n\n<p>FYI</p>\n\n<p>i use Ruby on Rails, and call the aurigma with javascript</p>\n"},{"tags":["ruby-on-rails-3","activeadmin","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13041404,"title":"How to hide the resource in activeadmin gem","body":"<p>I create an admin page by using activeadmin gem <a href=\"http://activeadmin.info/\" rel=\"nofollow\">http://activeadmin.info/</a>\nI use cancan to authorize the privilege for 2 kind of user, user manage and book manage user.</p>\n\n<p>My question is: How I hide the resource User when a book manage user log in to admin page? \n<img src=\"http://i.stack.imgur.com/1C9zx.png\" alt=\"Active admin\"> </p>\n\n<p>I tried something like that but it didn't work</p>\n\n<pre><code> menu false  if can? :manage, BookHeader \n</code></pre>\n\n<p>or  </p>\n\n<pre><code> menu false  if authorize! :manage, BookHeader\n</code></pre>\n\n<p>Thanks for your help!</p>\n"},{"tags":["ruby-on-rails-3","internationalization","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13043635,"title":"Strange url's generated - i18n_routing","body":"<p>Use rails 3.2, i18n, i18n_routing. </p>\n\n<p>An example of my url's </p>\n\n<pre><code>domain/nl/vakantiehuizen/house-property-name\ndomain/nl/vakantiehuizen/house-property-name/reviews\ndomain/en/ferienwohnung/house-property-name\ndomain/en/ferienwohnung/house-property-name\n</code></pre>\n\n<p>controller names (vakantiehuizen, ferienwohnung) are translated by the locales (de.yml, en.yml). The name of the controller is this example is houses controller/model </p>\n\n<p>Just a week ago i get warning messages google webmastertools! with this url's </p>\n\n<pre><code>nltarget/houses/le-carpine/\nnltarget/houses/le-carpine/reviews\n</code></pre>\n\n<p>500 responses because this page doesn't exist. </p>\n\n<p>What is wrong here? bad/slow server response? </p>\n\n<p>part of logfile:</p>\n\n<pre><code> House::Translation Load (0.4ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 17 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 20 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 24 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.4ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 13 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 2 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 4 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 25 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n\n  House::Translation Load (0.5ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 19 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  Appartment::Translation Load (0.5ms)  SELECT `appartment_translations`.* FROM `appartment_translations` WHERE `appartment_translations`.`appartment_id` = 22 AND `appartment_translations`.`locale` = 'nltarget' LIMIT 1\n</code></pre>\n\n<p>i have seen that locale parameter is set to \"nltarget\" and not \"nl\"</p>\n\n<p>Mostly the locale params is set correct like this:</p>\n\n<pre><code> House::Translation Load (0.4ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 13 AND `house_translations`.`locale` = 'nl' LIMIT 1\n  Amenity::Translation Load (0.3ms)  SELECT `amenity_translations`.* FROM `amenity_translations` WHERE `amenity_translations`.`amenity_id` = 13 AND `amenity_translations`.`locale` = 'nl' LIMIT 1\n  Review::Translation Load (0.3ms)  SELECT `review_translations`.* FROM `review_translations` WHERE `review_translations`.`review_id` IS NULL AND `review_translations`.`locale` = 'nl' LIMIT 1\n  Amenity::Translation Load (0.4ms)  SELECT `amenity_translations`.* FROM `amenity_translations` WHERE `amenity_translations`.`amenity_id` = 13 AND `amenity_translations`.`locale` = 'nl' LIMIT 1\n</code></pre>\n\n<p>How is it possibly that locale \"nl\" is set to \"nltarget\"?</p>\n\n<p>Ciao..remco</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13044868,"title":"Ruby on Rails: Can't insert content into yield block","body":"<p>I have a partial called <code>_main_nav.html.erb</code> in views/layout folder, this is content file:  </p>\n\n<pre><code>&lt;% content_for :main_navigation do %&gt;\n  &lt;h1&gt;Something must here&lt;/h1&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In my <code>_header.html.erb</code> file, i used <code>yield</code> to insert content:  </p>\n\n<pre><code>... \n&lt;%= yield :main_navigation %&gt;  \n&lt;nav id=\"utility\" class=\"nav-collapse\"&gt;\n...  \n</code></pre>\n\n<p>But when i visit home page, it does'n appear h1 element, i have wrong somewhere?</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","facebook-javascript-sdk","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13044698,"title":"Facebook app stay login on canvas","body":"<p>i have a facebook app that can be access through facebook canvas or directly via the url.</p>\n\n<p>so everytime my user revisit my app, they have to click on sign in again, even if within the same session(For fb canvas only, session works fine for direct)</p>\n\n<p>Is there any tutorial or scripts that i can add to my webpage using javascript to check if user is a register user, and if yes, auto sign them in?</p>\n\n<p>I'm using rails3 and omniauth facebook gem. Thanks.</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","socket.io"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":465,"score":4,"question_id":7551630,"title":"Rails 3.1 - JS - Socket.io-emit in *.js.erb gets not executed and prevents execution of jQuery-Function","body":"<p>I want to use node.js with my Rails-Project to serve asynchronous io. I don't want to use juggernaut, faye or something like this, because I need clean connections with web-socket, server-sent events and spdy without an alternative. My first try to use node.js is now to use Socket.io, just to get in use with serving data to a node.js-module with JavaScript. But it doesn't work at all.</p>\n\n<p>My application.js looks like this:</p>\n\n<pre><code>// This is a manifest file that'll be compiled into including all the files listed below.\n// Add new JavaScript/Coffee code in separate files in this directory and they'll automatically\n// be included in the compiled file accessible from http://example.com/assets/application.js\n// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the\n// the compiled file.\n//\n//= require jquery\n//= require jquery_ujs\n//= require_tree .\n\nwindow.socket = io.connect('http://localhost:8080/');\n</code></pre>\n\n<p>The requirements for io get correctly loaded in my application.html.erb:</p>\n\n<pre><code> &lt;%= javascript_include_tag \"application\", \"http://localhost:8080/socket.io/socket.io.js\" %&gt;\n</code></pre>\n\n<p>Now I want to use the socket to emit a event sent to all listening clients like this in a create.js.erb:</p>\n\n<pre><code>$(function() {\n  window.socket.emit('message', &lt;%= @message =&gt;);\n};\n$(\"#new_article\")[0].reset();\n</code></pre>\n\n<p>The message gets created in the ArticlesCrontroller this way:</p>\n\n<pre><code>def create\n  @article = current_user.articles.build(params[:article])\n  if @article.save\n    msg = {:data =&gt; @article.to_json}\n    @message = msg.to_json\n  end\nend\n</code></pre>\n\n<p>I listen at this event in an other view called index.js.erb this way:</p>\n\n<pre><code>$(function() {\n  window.socket.on('message', function (msg) {\n    $(\"#articles\").prepend(&lt;%= escape_javascript render(Article.new.from_json(msg.data)) %&gt;);\n  });\n});\n</code></pre>\n\n<p>The Socket.io looks like this: </p>\n\n<pre><code>var io = require('socket.io').listen(8080);\n\nio.sockets.on('connection', function (socket) {\n  socket.on('message', function () { });\n  socket.on('disconnect', function () { });\n});\n</code></pre>\n\n<p>and seems to work right, because it tells me right how it serves the requested js-File:</p>\n\n<pre><code>info  - socket.io started\ndebug - served static /socket.io.js\n</code></pre>\n\n<p>But it doesn't work at all, although the create.js.erb gets rendered without an error:</p>\n\n<pre><code>Rendered articles/create.js.erb (0.5ms)\nCompleted 200 OK in 268ms (Views: 70.0ms | ActiveRecord: 14.6ms)\n</code></pre>\n\n<p>Even the jQuery-Function for resetting the form gets not executed, what works without the try to emit the socket-event. The article gets saved to the database correctly, so that isn't the problem. Can someone tell me where the problem might be?</p>\n\n<p><strong>Update:</strong> I figured out by using the JavaScript-debugger of chrome, that the problem starts with the definition of <em>window.socket</em> in the application.js. The error-code is:</p>\n\n<pre><code>Uncaught ReferenceError: io is not defined\n  (anonymous function)\n</code></pre>\n\n<p>But <em>io</em> is defined in the socket.io.js-File I load in my application.html.erb. I did a workaround for application.js this way:</p>\n\n<pre><code>$.getScript('http://localhost:8080/socket.io/socket.io.js', function(){\n  window.socket = io.connect('http://localhost:8080/');\n});\n</code></pre>\n\n<p>The question is now: Why do I have to get the script this way, although it is loadet in the application.html.erb? But despite this workaround the create.js.erb still doesn't work yet. I will try to workaround that after having a bit of sleep.</p>\n"}]}
