{"total":93230,"page":1,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3","nested","nested-forms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13298064,"title":"Updating nested models in rails","body":"<p>I have an app where there's a model Animal which has many Packages. I'm trying to create a form where the :true_weight attribute of a subset of the packages associated with a particular animal can be updated. This form is in a custom url/action (not show/new/edit or whatever). I feel like I've done most of it right, but it's just not updating the packages. I'll put my (abbreviated) code below and then explain what has and hasn't been working. Pretty stumped by this:</p>\n\n<p>package.rb</p>\n\n<pre><code>attr_accessible :true_weight # And irrelevant others\nbelongs_to :animal\n</code></pre>\n\n<p>animal.rb</p>\n\n<pre><code>attr_accessible :finalized, :name # And irrelevant others\nhas_many :packages\naccepts_nested_attributes_for :packages\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>match '/animals/:animal_id/log' =&gt; \"animals#log\"\n</code></pre>\n\n<p>animals/log.html.erb</p>\n\n<pre><code>&lt;%= form_for(@animal) do |f| %&gt; \n\n&lt;div style=\"width: 200px\"&gt;\n        &lt;%= f.label :name %&gt;\n        &lt;%= f.text_field :name %&gt;\n&lt;/div&gt;\n\n    # This produces the subset of packages I want to be able to edit. It's an array\n    # of arrays, so that each render produces a separate table made from one of the \n    # inner arrays.\n&lt;% @animal.packages_for_log.each do |bundle| %&gt; \n    &lt;%= render partial: 'package_bundle', locals: {:bundle =&gt; bundle} %&gt;&lt;br&gt;\n&lt;% end %&gt;\n\n&lt;h4&gt;And then you'd allow addition of extra packages here.&lt;/h4&gt;\n\n&lt;%= f.submit \"Submit Animal Log\", :class =&gt; \"btn image-button right\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>_package_bundle.html.erb</p>\n\n<pre><code>&lt;table class=\"table\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th&gt;Name&lt;/th&gt;\n            &lt;th&gt;Notes&lt;/th&gt;\n            &lt;th&gt;Label&lt;/th&gt;\n            &lt;th&gt;True Weight&gt;&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;% bundle.each do |package| %&gt; &lt;!-- Produces for each \"bundle\" the list of identical packages --&gt;\n            &lt;%= fields_for package do |p| %&gt;\n                &lt;% if package.order.user %&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;&lt;%= package.name %&gt;&lt;/td&gt;\n                        &lt;td&gt;&lt;%= package.line.processed_notes %&gt;&lt;/td&gt;\n                        &lt;td&gt;&lt;%= \"#{package.order.user.name.first(3).upcase}-#{package.id}\" %&gt;&lt;/td&gt;\n                        &lt;% if !package.true_weight %&gt;\n                            &lt;td colspan=1&gt;&lt;%= p.text_field :true_weight %&gt;&lt;/td\n                        &lt;% else %&gt;\n                            &lt;td&gt;&lt;%= package.true_weight.round(0) %&gt;lb&lt;/td&gt;\n\n                        &lt;% end %&gt;  \n                    &lt;/tr&gt;\n                &lt;% end %&gt;\n            &lt;% end %&gt;   \n        &lt;% end %&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>animals_controller.rb (log is an animal action/view)</p>\n\n<pre><code>def log\n    @animal = Animal.find(params[:animal_id])\n\n    if @animal.update_attributes(params[:animal])\n      puts \"Inside If Block\"\n      @animal.toggle!(:finalized)\n    else\n      # I don't know about this. I wanted to redirect to the updated log page, with a flash\n      # but when I last tried that, it had some recursive error, or would update without my \n      # submitting.\n      render action: \"log\"\n    end\n\n  end\n</code></pre>\n\n<p>So. What is working:</p>\n\n<ol>\n<li>The if block in my animals controller is being accessed. But it looks like it's possibly being accessed BEFORE I hit submit on my log page. (I searched for and found that puts line in the server logs). May just be misreading it.</li>\n<li>The form elements look right. I get a whole bunch of text boxes in the right places, and the information about each package that is being printed to the page in the table next to the text fields is correct.</li>\n<li>If I fill in Animal Name attribute at the top of the form, that attribute (of the animal) IS updated. </li>\n</ol>\n\n<p>What isn't working:</p>\n\n<ol>\n<li>When I submit, it redirects me to the animal show page (!?!?), with the flash that's shown after the regular update action.</li>\n<li>The @animal.toggle!(:finalized) action doesn't seem to do anything. Maybe, given 1 above, that boolean is being toggled twice? Back and forth?</li>\n<li>The big one -- it doesn't update my packages, at all. </li>\n</ol>\n\n<p>Any ideas what's going on here, or what I need to add? I'm really confused about what I'm not doing right.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","rspec","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13297450,"title":"ruby on rails 3 tutorial - failing integration test chapter 9 - ActionController::RoutingError: No route matches [GET] \"/signout\"","body":"<p>I'm at the end of chapter 9 of Michael Hartl's Ruby on Rails 3 Tutorial and ran into a failing integration test (users_spec.rb). I've been searching for a while, but non of the suggestions I found so far worked out for me. I downloaded the source code of the tutorial of both the first and second edition and they run fine, so it really looks like there's something wrong in the configuration of my application but as a rails newbie, it feels like looking for the needle in a haystack so any help is welcome.</p>\n\n<p>the error message: ActionController::RoutingError: No route matches [GET] \"/signout\"</p>\n\n<p>the users_spec.rb contains this</p>\n\n<pre><code>    ...\n       describe \"success\" do\n          it \"should sign a user in and out\" do\n             user = FactoryGirl.create(:user)\n             visit signin_path\n             fill_in :email, :with =&gt; user.email\n             fill_in :password, :with =&gt; user.password\n             click_button\n             controller.should be_signed_in\n             click_link \"Sign out\"\n             controller.should_not be_signed_in\n          end\n       end\n    ...\n</code></pre>\n\n<p>my application.html.erb looks like this</p>\n\n<pre><code>    &lt;!DOCTYPE html&gt;\n    &lt;html&gt;\n    &lt;head&gt;\n      &lt;title&gt;&lt;%= @title %&gt;&lt;/title&gt;\n      &lt;%= javascript_include_tag 'default' %&gt;\n      &lt;%= csrf_meta_tags %&gt;\n      &lt;%= render 'layouts/stylesheets' %&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n      &lt;div class='container'&gt;\n        &lt;%= render 'layouts/header' %&gt;\n        &lt;section class = \"round\"&gt;\n          &lt;% flash.each do |key, value| %&gt;\n            &lt;div class=\"flash &lt;%= key %&gt;\"&gt;&lt;%= value %&gt;&lt;/div&gt;\n          &lt;% end %&gt;\n          &lt;%= yield %&gt;\n        &lt;/section&gt;\n        &lt;%= render 'layouts/footer' %&gt;\n        &lt;%= debug(params) if Rails.env.development? %&gt;\n      &lt;/div&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;\n</code></pre>\n\n<p>my application_controller.rb looks like this</p>\n\n<pre><code>    class ApplicationController &lt; ActionController::Base\n      protect_from_forgery\n      include SessionsHelper\n    end\n</code></pre>\n\n<p>my application.js looks like this</p>\n\n<pre><code>    // This is a manifest file that'll be compiled into application.js, which will include all the files\n    // listed below.\n    //\n    // Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,\n    // or vendor/assets/javascripts of plugins, if any, can be referenced here using a relative path.\n    //\n    // It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the\n    // the compiled file.\n    //\n    // WARNING: THE FIRST BLANK LINE MARKS THE END OF WHAT'S TO BE PROCESSED, ANY BLANK LINE SHOULD\n    // GO AFTER THE REQUIRES BELOW.\n    //\n    //= require jquery\n    //= require jquery_ujs\n    //= require_tree .\n</code></pre>\n\n<p>the _header.html.erb file contains this</p>\n\n<pre><code>    ...\n      &lt;% if signed_in? %&gt;\n      &lt;li&gt;&lt;%= link_to \"Sign out\", signout_path, :method =&gt; :delete %&gt;&lt;/li&gt;\n      &lt;% else %&gt;\n    ...\n</code></pre>\n\n<p>my routes.rb contains this</p>\n\n<pre><code>    ...\n      get \"sessions/new\"\n\n      resources :users\n      resources :sessions, :only =&gt;[:new, :create, :destroy]\n\n      match '/contact', :to =&gt; 'pages#contact'\n      match '/about', :to =&gt; 'pages#about'\n      match '/help', :to =&gt; 'pages#help'\n      match '/signup', to: 'users#new'\n\n      match '/signin', to: 'sessions#new'\n      match '/signout', to: 'sessions#destroy', via: :delete\n\n      root :to =&gt; 'pages#home'\n    ...\n</code></pre>\n\n<p>my sessions_controller.rb contains this</p>\n\n<pre><code>    ...\n      def destroy\n        sign_out\n        redirect_to root_path\n      end\n    ...\n</code></pre>\n\n<p>the sessions_helper.rb contains this</p>\n\n<pre><code>    ...\n      def sign_out\n        cookies.delete(:remember_token)\n        @current_user = nil\n      end\n    ...\n</code></pre>\n\n<p>this is what I get when I execute rake routes</p>\n\n<pre><code>    sessions_new GET    /sessions/new(.:format)   sessions#new\n           users GET    /users(.:format)          users#index\n                 POST   /users(.:format)          users#create\n        new_user GET    /users/new(.:format)      users#new\n       edit_user GET    /users/:id/edit(.:format) users#edit\n            user GET    /users/:id(.:format)      users#show\n                 PUT    /users/:id(.:format)      users#update\n                 DELETE /users/:id(.:format)      users#destroy\n        sessions POST   /sessions(.:format)       sessions#create\n     new_session GET    /sessions/new(.:format)   sessions#new\n         session DELETE /sessions/:id(.:format)   sessions#destroy\n         contact        /contact(.:format)        pages#contact\n           about        /about(.:format)          pages#about\n            help        /help(.:format)           pages#help\n          signup        /signup(.:format)         users#new\n          signin        /signin(.:format)         sessions#new\n         signout DELETE /signout(.:format)        sessions#destroy\n</code></pre>\n\n<p>my gemfile looks like this</p>\n\n<pre><code>    source 'https://rubygems.org'\n\n    gem 'rails', '3.2.8'\n\n    gem 'pg'\n    gem 'gravatar_image_tag'\n    gem 'jquery-rails'\n\n    group :development do\n      gem 'rspec-rails'\n      gem 'annotate'\n    end\n\n    group :test do\n      gem 'rspec'\n      gem 'webrat'\n      gem 'spork'\n      gem 'factory_girl_rails'\n    end\n</code></pre>\n\n<p>when running bundler install I get this as output:</p>\n\n<pre><code>    Using rake (0.9.2.2)\n    Using i18n (0.6.1)\n    Using multi_json (1.3.6)\n    Using activesupport (3.2.8)\n    Using builder (3.0.4)\n    Using activemodel (3.2.8)\n    Using erubis (2.7.0)\n    Using journey (1.0.4)\n    Using rack (1.4.1)\n    Using rack-cache (1.2)\n    Using rack-test (0.6.2)\n    Using hike (1.2.1)\n    Using tilt (1.3.3)\n    Using sprockets (2.1.3)\n    Using actionpack (3.2.8)\n    Using mime-types (1.19)\n    Using polyglot (0.3.3)\n    Using treetop (1.4.11)\n    Using mail (2.4.4)\n    Using actionmailer (3.2.8)\n    Using arel (3.0.2)\n    Using tzinfo (0.3.33)\n    Using activerecord (3.2.8)\n    Using activeresource (3.2.8)\n    Using annotate (2.5.0)\n    Using diff-lcs (1.1.3)\n    Using factory_girl (4.1.0)\n    Using rack-ssl (1.3.2)\n    Using json (1.7.5)\n    Using rdoc (3.12)\n    Using thor (0.16.0)\n    Using railties (3.2.8)\n    Using factory_girl_rails (4.1.0)\n    Using gravatar_image_tag (1.1.3)\n    Using jquery-rails (2.1.3)\n    Using nokogiri (1.5.5)\n    Using pg (0.14.1)\n    Using bundler (1.2.0)\n    Using rails (3.2.8)\n    Using rspec-core (2.11.1)\n    Using rspec-expectations (2.11.3)\n    Using rspec-mocks (2.11.3)\n    Using rspec (2.11.0)\n    Using rspec-rails (2.11.4)\n    Using spork (0.9.2)\n    Using webrat (0.7.3)\n</code></pre>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","ruby-on-rails-3.2","sass","bootstrap-sass"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13285568,"title":"Rails 3.2 bootstrap-sass not installing","body":"<p>I'm trying to install the bootstrap-sass gem on my Rails 3.2 app, but encounter this error when I call <code>compass install bootstrap</code> :</p>\n\n<p>No such framework: \"bootstrap\"</p>\n\n<p>I have the gem installed in my Gemfile:</p>\n\n<pre><code>gem 'compass', '~&gt; 0.12.2'\ngroup :assets do\n  ...\n  gem 'sass-rails', '~&gt; 3.2.4'\n  gem 'compass-rails', '~&gt; 1.0.3'\n  gem 'bootstrap-sass', '~&gt; 2.1.1.0'\nend\n</code></pre>\n\n<p>I've put in the import statement to my application.css.scss file:</p>\n\n<pre><code>@import \"bootstrap\";\n</code></pre>\n\n<p>I've required bootstrap in my application.js:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require bootstrap\n...\n</code></pre>\n\n<p>and I've required bootstrap-sass in my config.ru file:</p>\n\n<pre><code>require 'bootstrap-sass'\n\nrequire ::File.expand_path('../config/environment',  __FILE__)\n\nrun MYAPP::Application\n</code></pre>\n\n<p>Anyone have any idea what the problem could be, or encountered the same problem?</p>\n\n<p>Here's the git for bootstrap-sass: <a href=\"https://github.com/thomas-mcdonald/bootstrap-sass.git\" rel=\"nofollow\">https://github.com/thomas-mcdonald/bootstrap-sass.git</a></p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13298545,"title":"How to specify a multiple column index correctly in Rails","body":"<p>As shown in this question: \n<a href=\"http://stackoverflow.com/questions/1449459/how-to-make-column-unique-and-index-it-in-rails-migration\">how to make column unique and index it in Rails Migration</a> ,<br>\nyou can write:</p>\n\n<pre><code>add_index :the_table, [:foo_column, :bar_column], :unique =&gt; true\n</code></pre>\n\n<p>to add an multiple column index.<br>\nBut is it still required to add an single indexes for each of those columns that you already have specified a multi-column index?</p>\n\n<p>I mean something like writing below code <strong>in additional to</strong> the code shown above.</p>\n\n<pre><code>add_index :the_table, :foo_column  \nadd_index :the_table, :bar_column\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","radio-button"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13281194,"title":"Radio Button Selection Sticking After Search","body":"<p>This question is similar to my last question, but instead of a select box I would like to implement it on two radio buttons. I would like a Male radio button and a Female radio button, represented by M and F, and whenever you select one and hit go, the page refreshes with the previously checked button selected. I am using rails 3 and twitter bootstrap I can post my code if necessary. This is a link to my next question: <a href=\"http://stackoverflow.com/questions/13255011/select-box-selected-item-staying-after-search\">Select Box Selected Item Staying After Search</a></p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13278806,"title":"Rails search in db with different fields","body":"<p>I have 5 select's in my html code. I send them to controller, but for example some of them could be empty (default value is 0), so for example in some case i need to search only via <code>params[:size]</code>  is some case only via <code>params[:capacity]</code> and in other <code>params[:size] and params[:capacity]</code> both as well... But how do to this? how to operate with find etc?\nnow i have something like this:</p>\n\n<pre><code>size = \"*\"+params[:akbsize]+\"*\"\n    @accums = Accumulator.find(:all, :conditions =&gt; [\"MATCH(description) AGAINST (? in boolean mode)\", size])\n    cap = \"*\"+params[:akbcapacity]+\"*\"\n    @accums2 = Accumulator.find(:all, :conditions =&gt; [\"MATCH(description) AGAINST (? in boolean mode)\", cap])\n</code></pre>\n\n<p>But how to do as i described? Is it good to do here with metasearch gem?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13298251,"title":"Ruby on Rails where statement","body":"<p>I have a <strong>worequest</strong> table that belongs to <strong>contact</strong> table.\nThe <strong>contact</strong> table belongs to the <strong>user</strong> table.</p>\n\n<p>I'm listing the worequest records, but want to limit it to the records for the current user.</p>\n\n<p>This doesn't work:</p>\n\n<pre><code>&lt;% Worequest.where(:contact_id.contact.user_id =&gt; current_user.id).each do |worequest| %&gt;\n</code></pre>\n\n<p>What would?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","safety","soft-delete"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":814,"score":1,"question_id":6354734,"title":"Is there a better version of somthing like acts_as_paranoid for Rails 3?","body":"<p>Does anyone know of a gem that both soft deletes records from a database (just flags them as deleted as opposed to is actually deleted) and...</p>\n\n<p>...also when do you any type of find automatically omits those trashed records with out using any special user-defined scopes. E.g. it all takes place in the gem.</p>\n\n<p>Cheers!</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13298256,"title":"how to insert fields from one model to another","body":"<p>I have a model with multiple associations:</p>\n\n<pre><code>has_many labouritems\nhas_many materialitems\n</code></pre>\n\n<p>I have another association to quotes called invoice; how do I insert the <code>labouritems</code> and material records to invoice but create new instance of them but keep the value? The purpose is to keep a historic record of the values at a point in time. </p>\n"},{"tags":["ruby-on-rails","thin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13298079,"title":"Explain what script/web is in a Rails project","body":"<p><code>exec bundle exec thin -p $PORT -e ${RACK_ENV:-development} start 2&gt;&amp;1</code></p>\n\n<p>That's what I have in my <code>script/web</code> . Can someone explain the individual pieces of that?</p>\n"},{"tags":["ruby-on-rails","rspec","integration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13295910,"title":"How to run an integration test in RoR with rspec and capybara","body":"<p>I have a good understanding of the differences between unit and intergration tests in RoR in theory. I'm using rspec and capybara to do a lot of testing on my site. What I don't understand is how do you run different tests? If I do</p>\n\n<pre><code>bundle exec rspec\n</code></pre>\n\n<p>it will run all of my specs in all of my spec folders (model, controller, views, integration, etc). If I want to run an integration test, is it as simple as ?</p>\n\n<pre><code>bundle exec rspec spec/integration\n</code></pre>\n\n<p>I know there are some differences between these types of test behind the scenes. Specifically this problem (which I also have) has me thinking about unit vs. integration: <a href=\"http://stackoverflow.com/questions/10955474/how-to-test-for-a-redirect-with-rspec-and-capybara\">How to test for a redirect with Rspec and Capybara</a></p>\n\n<p>What does Rails do differently when running integration tests? The solution posted in the above problem is </p>\n\n<blockquote>\n  <p>Checking for redirect is not supported in rspec-rails request specs,\n  but is supported in Rails integration tests.</p>\n</blockquote>\n\n<p>So how do I make one of my tests an integration test? Is it just a matter of putting it in the right spec folder?</p>\n"},{"tags":["ruby-on-rails","unit-testing","rspec","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13298015,"title":"rspec not working for a sign in test using spork","body":"<p>Rspec is not working with Rails 3.0.6 and ruby 1.8.7 (2012-06-29 patchlevel 370) [i686-linux]</p>\n\n<p>I have this simple users_spec.rb file</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"Log in\" do\n\n  context \"User sign in\" do\n\n    it \"shows error for not confirmed users after sign in\" do\n      visit \"/users/sign_in\"\n      fill_in \"Email\", :with =&gt; \"guillem.hernandez.sola+rspec@gmail.com\"  \n      fill_in \"user_password\", :with =&gt; \"foobar\"\n      click_button \"user_submit\"\n      page.should have_content(I18n.t('devise.failure.invalid'))\n    end\n\n  end   \n\nend\n</code></pre>\n\n<p>This spec_helper.rb file I included on the former file</p>\n\n<pre><code>require 'rubygems'\nrequire 'spork'\n#uncomment the following line to use spork with the debugger\n#require 'spork/ext/ruby-debug'\n\nSpork.prefork do\n  # Loading more in this block will cause your tests to run faster. However,\n  # if you change any configuration or code from libraries loaded here, you'll\n  # need to restart spork for it take effect.\n\nend\n\nSpork.each_run do\n  # This code will be run each time you run your specs.\n\nend\n\n# This file is copied to spec/ when you run 'rails generate rspec:install'\nENV[\"RAILS_ENV\"] ||= 'test'\nrequire File.expand_path(\"../../config/environment\", __FILE__)\nrequire 'rspec/rails'\nrequire 'rspec/autorun' # Required for Rcov to run.\nrequire \"email_spec\"\nrequire \"capybara/rspec\"\n#require File.expand_path(File.dirname(__FILE__) + \"/blueprints\")\n\n# Require helpers here\nrequire File.expand_path(File.dirname(__FILE__) + \"/positions_helper\")\n\ninclude PositionsHelper\n\n# Requires supporting ruby files with custom matchers and macros, etc,\n# in spec/support/ and its subdirectories.\nDir[Rails.root.join(\"spec/support/**/*.rb\")].each {|f| require f}\n\nRSpec.configure do |config|\n  # == Mock Framework\n  #\n  # If you prefer to use mocha, flexmock or RR, uncomment the appropriate line:\n  #\n  # config.mock_with :mocha\n  # config.mock_with :flexmock\n  # config.mock_with :rr\n  config.mock_with :rspec\n\n  # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures\n#  config.fixture_path = \"#{::Rails.root}/spec/fixtures\"\n\n  # If you're not using ActiveRecord, or you'd prefer not to run each of your\n  # examples within a transaction, remove the following line or assign false\n  # instead of true.\n  config.use_transactional_fixtures = true\n\n\nend\n</code></pre>\n\n<p>And my Gemfile to execute the rails app</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.6'\ngem 'rake', '0.8.7'\n\ngem 'mysql' #Development in windows\ngem 'mysql2', '&lt; 0.3'\n\ngem 'mongrel'\ngem 'jquery-rails', '&gt;= 0.2.7' #Replace Prototype with JQuery\ngem 'active_scaffold_vho' #Used in typical CRUD interfaces\ngem 'inherited_resources', '~&gt; 1.2.1' #Used for more complex views such the home page\ngem 'has_scope', '~&gt; 0.5.0' #Used in the positions controller\ngem 'json_pure' #Used to parse events\ngem 'formtastic', '~&gt; 1.2.3' #Used in forms\ngem 'devise', '~&gt; 1.3.4' #Authentication\ngem 'recaptcha', :require =&gt; 'recaptcha/rails' #Captcha for register\n\ngem 'uuidtools', '~&gt; 2.1.2'\n\ngem 'capistrano', '~&gt; 2.6.0' #Deployments\n\ngem 'cgi_multipart_eof_fix'\ngem 'fastthread'\n\ngem 'mongoid', \"~&gt; 2.0\" #Mongoid\ngem 'bson_ext', \"~&gt; 1.3\" #Mongoid\n\ngem 'redis', \"~&gt; 2.2.0\"\ngem 'resque'\ngem 'resque-scheduler'\n\ngem 'SystemTimer', \"~&gt; 1.2.3\" #recomended by mongoid and redis\n\ngem 'ar_mailer_rails3' #Mailer system\ngem 'lazy_high_charts', \"~&gt; 1.1.1\" #Dashboard charts\n\ngem 'rails-breadcrumbs', \"~&gt; 1.0.0\"\n\ngem 'curb' #Used to send commands to terminals\n\ngem 'geonames', \"~&gt; 0.2.2\" #Used to \n\ngem 'activemerchant'\n\ngem 'savon', \"~&gt; 0.9.7\"\n\ngem 'rack-ssl'\ngem 'state_machine'\n\ngem \"http_accept_language\", '~&gt; 1.0.2'\n\ngem 'recurly', '~&gt; 2.1.0'\ngem 'newrelic_rpm'\n\ngroup :test, :development do\n  gem 'rspec-rails', \"~&gt; 2.8\"\n  gem 'rspec-mocks', \"~&gt; 2.8\"\n  gem 'capybara', \"~&gt; 0.4.1.2\"\n  gem 'database_cleaner', \"~&gt; 0.6.7 \"\n  gem 'cucumber', \"~&gt; 0.10.2\"\n  gem 'spork', \"~&gt; 0.9.0\"\n  gem 'launchy', \"~&gt; 0.4.0\"\n  gem 'machinist', \"~&gt; 1.0.6\"\n  gem 'factory_girl_rails', \"1.7.0\"\n  gem 'faker', \"~&gt; 0.9.5\"\n  gem 'email_spec'  \n  gem 'rails-erd'  \n# To use debugger (ruby-debug for Ruby 1.8.7+, ruby-debug19 for Ruby 1.9.2+)\n  gem 'ruby-debug'\nend\n\ngroup :development do\n  gem \"hirb\"\n  gem \"awesome_print\"\nend\n</code></pre>\n\n<p>This configuration is not working for users_spec.rb on the development and test environment. I run spork using bundle exec spork while I am running the test and the </p>\n\n<p>How can I use rspec on development and test environments? What am I missing on the configuration? Do I need any command before running the tests?</p>\n"},{"tags":["ruby-on-rails","gem","rvm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13297379,"title":"Can't find gem, even though it is in the list","body":"<p>I'm installing a rails app on an apache server, using Phusion Passenger.  It complains about a gem not being there, but it is in the list.  </p>\n\n<p>Here is the error:</p>\n\n<pre><code>Could not find open4-1.3.0 in any of the sources (Bundler::GemNotFound)\n</code></pre>\n\n<p>here is the results of 'gem list':</p>\n\n<pre><code>actionmailer (3.2.2, 3.2.1)\nactionpack (3.2.2, 3.2.1)\nactivemodel (3.2.2, 3.2.1)\nactiverecord (3.2.2, 3.2.1)\nactiveresource (3.2.2, 3.2.1)\nactivesupport (3.2.2, 3.2.1)\narel (3.0.2)\nbuilder (3.0.3, 3.0.0)\nbundler (1.2.1)\ncoffee-rails (3.2.2)\ncoffee-script (2.2.0)\ncoffee-script-source (1.3.3)\nerubis (2.7.0)\nexecjs (1.4.0, 1.3.2)\nhike (1.2.1)\ni18n (0.6.1, 0.6.0)\njourney (1.0.4, 1.0.3)\njquery-rails (2.1.3, 2.0.2)\njson (1.7.5, 1.7.3)\nlibv8 (3.3.10.4 x86_64-linux)\nmail (2.4.4)\nmime-types (1.19, 1.18)\nmulti_json (1.3.6, 1.3.5)\nopen4 (1.3.0)\npolyglot (0.3.3)\nrack (1.4.1)\nrack-cache (1.2)\nrack-ssl (1.3.2)\nrack-test (0.6.2, 0.6.1)\nrails (3.2.2, 3.2.1)\nrailties (3.2.2, 3.2.1)\nrake (0.9.2.2)\nrake-remote_task (2.0.6)\nrdoc (3.12)\nrubygems-bundler (1.1.0)\nrvm (1.11.3.5)\nsass (3.2.1, 3.1.18)\nsass-rails (3.2.5)\nsprockets (2.1.3)\nsqlite3 (1.3.6)\ntherubyracer (0.10.2, 0.10.1)\nthor (0.14.6)\ntilt (1.3.3)\ntreetop (1.4.11, 1.4.10)\ntzinfo (0.3.33)\nuglifier (1.3.0, 1.2.4)\nvlad (2.2.5)\n</code></pre>\n\n<p>It looks like the open gem is there.  Any ideas?  Thanks.</p>\n"},{"tags":["ruby-on-rails","backbone.js","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13297907,"title":"Omni_auth logs out on backbone save","body":"<p>I have a rails app using backbone, but when I call save, the server is redirecting to login - even though I'm already logged in (the page on which the backbone model is found is only shown after logging in).</p>\n\n<p>I'm using backbone.matroyshka for nested models - but removing it doesn't solve the problem.</p>\n\n<p>Here's the code that calls save on the model in the view:</p>\n\n<pre><code>    var view = this;\n\n// save model\nthis.model.save(null, {\n    success: function(model, response) {\n        view.$('#saving').hide();\n        view.notice('Saved!', 'success');\n    },\n    error: function(model, response) {\n        view.$('#saving').hide();\n        view.notice(response, 'error');\n        console.log('save failed ' + response, view.model.get('url'));\n    }\n});\n</code></pre>\n\n<p>Prior to the model.save request, there is an AJAX request to retrieve data using jQuery AJAX:</p>\n\n<pre><code>        $.ajax({\n        type: 'GET',\n        url: serverUrl,\n        data: { url: model.get('url') },\n        dataType: \"json\", \n        context: this,\n        success: function(data) {\n            model.set(data);\n        },\n\n        error: function(xhr, status, error) {\n            console.log('lookup share url failed ' + error, this.get('source'),         this.get('about'));\n            this.trigger('load:fail');\n            if (options.error) {\n                options.error(this, error);\n            }\n        }\n    });\n</code></pre>\n\n<p>The model.save receives a 302 found from the server, redirecting it to the login page.\nThe controller for the resource is protected by </p>\n\n<pre><code>  before_filter :signed_in_user, only: [:create]\n</code></pre>\n\n<p>signed_in_user is in a session helper taken straight from a tutorial on using omni_auth</p>\n\n<pre><code>  def signed_in_user\nunless signed_in?\n  store_location\n  redirect_to login_path, notice: \"You must be logged in to find out what they do.\"\nend\n</code></pre>\n\n<p>end</p>\n\n<p>I have another page that saves with AJAX (not backbone), and it works fine (also requires a signed in user).</p>\n"},{"tags":["ruby-on-rails","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13296329,"title":"app/utils classes not found for rake task","body":"<p>I have a method I have added on Date that looks like this:</p>\n\n<pre><code>class Date\n  def days_different(date)\n    Float(self-date)\n  end\nend\n</code></pre>\n\n<p>This works great in the rest of my application, but I also have a rake task in lib/tasks/database.rake that uses this where this is not being loaded despite having the => :environment dependency on the task (greatly simplified test version shown below).</p>\n\n<pre><code>task :test_days_different =&gt; :environment do\n  date = 2.days.ago\n  puts date.days_different(DateTime.now)\nend\n</code></pre>\n\n<p>Strangely, rake:test loads the helper function when it loads its environment so I'm completely baffled as to why this isn't loading in rake db</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","best-in-place"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13297922,"title":"best_in_place under namespace controller is returning 404 when POST","body":"<p>I set up <code>best_in_place</code> according to <a href=\"http://railscasts.com/episodes/302-in-place-editing?view=asciicast\" rel=\"nofollow\">#302 In-Place Editing screencast</a>.</p>\n\n<p>Views are located under <code>admin/users</code>.</p>\n\n<p>Given this code on a page</p>\n\n<pre><code>= best_in_place @user, :admin, type: :input\n</code></pre>\n\n<p>The result renders ok and it changes its status to editable field when clicked but when try to save the value I can see this error </p>\n\n<pre><code>POST http://localhost:3000/admin/users 404 (Not Found) \n</code></pre>\n\n<p>Any idea how to solve this?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","cucumber"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":652,"score":3,"question_id":858584,"title":"Can 'cucumber' run my rspec-on-rails tests?","body":"<p>I have a small test project that I'm using to test the waters for a much larger project.  I am using rspec on rails for testing, but recently looked into Cucumber.  It looks very nice, but I'm wondering if there's a way for cucumber to run my spec tests, or for rspec (autospec) to run my cucumber features.  I've looked around extensively, but have yet to find a solid conclusion.</p>\n\n<p>Thanks,</p>\n\n<p>Mike</p>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13294194,"title":"Rails : How to store mailer password safely?","body":"<p>Hi I have my rails app on heroku and github and am currently using a mailer in my app:</p>\n\n<pre><code>ActionMailer::Base.smtp_settings = {\n  :address              =&gt; \"smtp.gmail.com\",\n  :port                 =&gt; 587,\n  :user_name            =&gt; \"myemail@gmail.com\",\n  :password             =&gt; \"PasswordShouldGoHere\",\n  :authentication       =&gt; \"plain\",\n  :enable_starttls_auto =&gt; true\n}\n</code></pre>\n\n<p>I don't want my email and password to be visible on my github account, since people can just log in and steal my info. However, if I put a fake password, then my app will give me an error on heroku when the mailer is supposed to deliver. I know I can just push up the real email and password to heroku first and then edit it and put the fake password on my github account, but is there a better way?</p>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":5,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":2969,"score":10,"question_id":5994492,"title":"Heroku debugging","body":"<p>I am building an application with Heroku and having some problems.\nI want to debug some content like I do with rails server:</p>\n\n<blockquote>\n  <p>logger.debug '...'</p>\n</blockquote>\n\n<p>How can I do that in Heroku, so I can see the debugging in heroku logs? (or anything else..)</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","session","logging","authlogic"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13297513,"title":"Prepend user ID to all log messages in Rails","body":"<p>In order to help track user actions for debugging purposes, we are considering prepending the session's logged in user ID to every log message (when applicable). Our stack consists of Rails and Authlogic. I've tried a couple of different routes, but none has been 100% successful so far.</p>\n\n<p>Since Authlogic does not store the user ID in plain text in the session data, we have to wait for it to be initialized. This happens only after the ApplicationController is initialized and set to be the active Authlogic controller. We cannot rely on code in <code>config/application.rb</code> because of this. It seems to me the only solution is to swap out the logger at a later time.</p>\n\n<p>I've attempted creating a new logger class by subclassing Logger and overwriting the <code>add()</code> method:</p>\n\n<pre><code>class UserLogger &lt; Logger\n  def add(severity, message = nil, progname = nil, &amp;block)\n    begin\n      session = UserSession.find\n    rescue\n      return super(severity, message, progname, &amp;block)\n    end\n\n    user = session.user if session\n\n    if block_given? || !user\n      return super(severity, message, progname, &amp;block)\n    end\n\n    unless message.nil?\n      message = \"[#{user.id}] \" + message\n    end\n\n    super severity, message, progname, &amp;block\n  end\nend\n</code></pre>\n\n<p>This doesn't seem to have any affect on the log outpost whatsoever. I also tried messing around with TaggedLogging, but that doesn't seem to be a good solution since you have to throw any tagged code in a block.</p>\n\n<p>I also tried defining <code>config.log_tags</code> in the application config by giving it a Proc, but Authlogic threw the same <code>Authlogic::Session::Activation::NotActivatedError</code> exception. Attempting to catch this exception put Ruby into a very weird state that seemed to be an infinite loop somewhere and pegged my CPU at 100%.</p>\n\n<p>Is there a simple solution to this or one I am completely missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13297524,"title":"Hartl's Tutorial Ch. 7 Exercise 3 No explanation on presence: true","body":"<p>I'm completely baffled with Exercise 3 in Chapter 7 of Hartl's Ruby on Rails tutorial. My question is, why do we have to get rid of <code>presence: true</code> in order to prevent error duplication. Don't we need that password exists? Or is this one of those things where <code>has_secure_password</code> handles this?</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13297415,"title":"\"uninitialized constant AdminUser\" when deploying Activeadmin on Heroku","body":"<p>I am still new to Ruby and I have been trying to deploy my App to heroku with ActiveAdmin.</p>\n\n<p>After pushing my code to heroku I try to run </p>\n\n<pre><code>heroku rake db:migrate\n</code></pre>\n\n<p>And I get the following error</p>\n\n<pre><code>rake aborted!\nuninitialized constant AdminUser\n</code></pre>\n\n<p>That is my gem file </p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\ngem 'json'\n\ngroup :assets do\n  gem 'coffee-rails', '3.2.2'\n  gem 'uglifier', '1.2.3'\nend\n\ngem 'jquery-rails', '2.0.2'\n\ngem 'pg', '0.14.1'\n\ngem 'sass-rails'\ngem \"activeadmin\"\ngem \"meta_search\", '&gt;= 1.1.0.pre'\n</code></pre>\n\n<p>I would really appreciate any help.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","zurb-foundation","css-frameworks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13297602,"title":"Zurb Foundation radio buttons and checkboxes not working in Rails","body":"<p>I've installed foundation into my Rails project using their gem and running the following 2 commands:</p>\n\n<pre><code>rails g foundation:install\nrails g foundation:layout\n</code></pre>\n\n<p>Everything seems to be working great, the nice CSS markup and grid layout. However, my radio buttons and checkboxes don't look any different. The <a href=\"http://foundation.zurb.com/docs/forms.php#radEx\" rel=\"nofollow\">page that describes radio buttons and checkboxes</a> says, \"Once initialized (they're referring to <code>jquery.foundation.forms.js</code> which was automatically included in every Rails page) it will look for any checkbox, radio button, or select element and replace it with custom markup that Foundation provides styles for.\"</p>\n\n<p>But my radio buttons and checkboxes look standard, not like the beautiful ones on the above example page. They suggest to set <code>display: none;</code> on the inputs with some custom markup to avoid the flash from normal to foundation buttons/checkboxes. That doesn't help. I even did a copy-and-paste from their example webpage to my webpage! Still no luck! Am I missing something?</p>\n\n<p>I'm using Rails 3.2.8</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13297130,"title":"RoR add where to do loop","body":"<p>I am listing the contents of a table called books.\nTo show all the records, I use:\n      &lt;% @books.each do |books| %></p>\n\n<p>Can I add a where clause so that only matching books are listed?\n    &lt;% Books.where(:type_id => '1') do |books| %></p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","refinerycms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13297305,"title":"How to remove page title from refinery home page [RAILS]","body":"<p>I'm currently working on a project which I'm building on top of 'refinery cms', I ran in to a problem that in my home page, apart from the page content I added, it shows the page name as 'home', </p>\n\n<p>And I have found out that it returns this from </p>\n\n<pre><code>#app/views/refinery/_content_page.html.erb\n\n&lt;%= render_content_page(@page, {\n      :hide_sections =&gt; local_assigns[:hide_sections],\n      :can_use_fallback =&gt; !local_assigns[:show_empty_sections] &amp;&amp; !local_assigns[:remove_automatic_sections]\n    }) %&gt;\n</code></pre>\n\n<p>can someone tell me how to get rid on this page name from the home page</p>\n\n<p>I'm running on </p>\n\n<ul>\n<li>gem 'refinerycms', '~> 2.0.0' </li>\n<li>gem 'rails', '3.2.8'</li>\n<li>ruby 1.9.2</li>\n</ul>\n\n<p>Thanks for any help</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","openssl","ssl-certificate"],"answer_count":2,"favorite_count":0,"up_vote_count":15,"down_vote_count":0,"view_count":7362,"score":15,"question_id":4505795,"title":"Rails 3: OpenSSL::SSL::SSLError: hostname was not match with the server certificate","body":"<p>When trying to deliver an email via console I receive this error:</p>\n\n<pre><code>OpenSSL::SSL::SSLError: hostname was not match with the server certificate\n</code></pre>\n\n<p>The thing is I really don't know much about certificates and such, or really how to get started troubleshooting this, I tried to do some investigation with <code>openssl</code> and here is the certificate that is returned.</p>\n\n<p>I don't know if its a problem with Postfix which is running on the server, or my rails app, any help or clues is really appreciated.</p>\n\n<pre><code>~% openssl s_client -connect mail.myhostname.com:25 -starttls smtp\nCONNECTED(00000003)\ndepth=0 /CN=myhostname\nverify error:num=18:self signed certificate\nverify return:1\ndepth=0 /CN=myhostname\nverify return:1\n---\nCertificate chain\n 0 s:/CN=myhostname\n   i:/CN=myhostname\n---\nServer certificate\n-----BEGIN CERTIFICATE-----\n[...redacted...]\n-----END CERTIFICATE-----\nsubject=/CN=myhostname\nissuer=/CN=myhostname\n---\nNo client certificate CA names sent\n---\nSSL handshake has read 1203 bytes and written 360 bytes\n---\nNew, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA\nServer public key is 1024 bit\nCompression: NONE\nExpansion: NONE\nSSL-Session:\n    Protocol  : TLSv1\n    Cipher    : DHE-RSA-AES256-SHA\n    Session-ID: 1AA4B8BFAAA85DA9ED4755194C50311670E57C35B8C51F9C2749936DA11918E4\n    Session-ID-ctx: \n    Master-Key: 9B432F1DE9F3580DCC6208C76F96631DC5A4BC517BDBADD5F514414DCF34AC526C30687B96C5C4742E9583555A118232\n    Key-Arg   : None\n    Start Time: 1292985376\n    Timeout   : 300 (sec)\n    Verify return code: 18 (self signed certificate)\n---\n250 DSN\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13296777,"title":"Rails: ActionMailer creating faulty links https//link.com instead of https://link.com","body":"<p>I have a actionmailer with settings:</p>\n\n<p>config/initializers/setup_mail.rb</p>\n\n<pre><code>ActionMailer::Base.smtp_settings = {\n  :address              =&gt; \"smtp.gmail.com\",\n  :port                 =&gt; 587,\n  :user_name            =&gt; \"cool@gmail.com\",\n  :password             =&gt; \"cool\",\n  :authentication       =&gt; \"plain\",\n  :enable_starttls_auto =&gt; true\n}\n\nActionMailer::Base.default_url_options[:host] = \"https://pacific-ravine-3563.herokuapp.com/\"\n</code></pre>\n\n<p>which delivers an email when a user is created. however, I checked the email that was sent and the links don't work. Here's the template for the email:</p>\n\n<pre><code>Dear &lt;%= @user.name %&gt;,\n\n&lt;p&gt;\n    Welcome to Pholder! Get started by finding and inviting &lt;%= link_to \"friends\", users_url %&gt; so that you can exclusively upload and view pictures with each other.\n&lt;/p&gt;\n\n&lt;p&gt;\n    &lt;%= link_to \"View profile\", user_url(@user) %&gt;\n    &lt;%= link_to \"Edit profile\", edit_user_url(@user) %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n    Sincerely, &lt;br&gt;\n    Pholder Staff\n&lt;/p&gt;\n</code></pre>\n\n<p>and when I checked the actual email:</p>\n\n<pre><code>Dear Ellen,\n\nWelcome to Pholder! Get started by finding and inviting friends so that you can exclusively upload and view pictures with each other.\n\nView profile Edit profile\n\nSincerely,\nPholder Staff \n</code></pre>\n\n<p>None of the links work. The first link that was supposed to send me to <code>users_url</code> sends me to: <code>https//pacific-ravine-3563.herokuapp.com/users</code> instead. This goes for the other 2 links(the <code>user_url(@user)</code> sends me to <code>https//pacific-ravine-3563.herokuapp.com/users/9</code> and etc.)</p>\n\n<p>Is it because I'm setting the default_url incorrectly?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mass-assignment"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":815,"score":2,"question_id":5659850,"title":"Is there a way to bypass mass assignment protection?","body":"<p>I have a Rails 3 app which JSON encodes objects in order to store them in a Redis key/value store.</p>\n\n<p>When I retrieve the objects, I'm trying to decode the JSON and instantiate them from the data like so:</p>\n\n<pre><code>def decode(json)\n  self.new(ActiveSupport::JSON.decode(json)[\"#{self.name.downcase}\"])\nend\n</code></pre>\n\n<p>The problem is that doing this involves mass assignment which is disallowed (for good reason I'm told!) for attributes I haven't given attr_writer ability to.</p>\n\n<p>Is there a way I can bypass the mass assignment protection just for this operation only?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13296723,"title":"How do I call a javascript function when a button is clicked?","body":"<p>Right now I am using:</p>\n\n<pre><code>&lt;%=button_to_function \"✓\", checkButton(), :class =&gt; \"buttonGrey\"%&gt;\n</code></pre>\n\n<p>But the javascript function needs something to be passed to it so it can toggle the class( I want the buttons class to be changed upon pressing it) What would I pass as a param to represent the button?</p>\n"},{"tags":["ruby-on-rails","ruby","sqlite"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13292413,"title":"How to access sqlite3 tables generated by ruby on rails rvm install","body":"<p>I'm learning ruby on rails by reading the \"agile web development with rails\" book. I installed ruby and rails using rvm. I'm using the default sqlite3 database, and generating models and tables is awesome. </p>\n\n<p>I'd like to manually browse my db, just to see the structure. </p>\n\n<p>So at the command line is run </p>\n\n<pre><code>sqlite3\n</code></pre>\n\n<p>and in the shell </p>\n\n<pre><code>.tables\n</code></pre>\n\n<p>nothing shows up... Where are my tables?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13296973,"title":"rails model subclassing -> multi table inheritance or polymorphism","body":"<p>Here is my setup, followed by an explanation of what I am trying to accomplish.</p>\n\n<pre><code>class Layer &lt; ActiveRecord::Base\n  has_and_belongs_to_many :components\nend\n\nclass Component &lt; ActiveRecord::Base\n  has_and_belongs_to_many :layers \nend\n\nclass ImageComponent &lt; Component\n  # I want this table to inherit from the Component table\n  # I should be able to add image-specific fields to this table\nend\n\nclass VideoComponent &lt; Component\n  # I want this table to inherit from the Component table\n  # I should be able to add video-specific fields to this table\nend\n</code></pre>\n\n<p>What I want to be able to do:</p>\n\n<pre><code>layer.components &lt;&lt; ImageComponent.create\nlayer.components &lt;&lt; VideoComponent.create\n</code></pre>\n\n<p>In practice, I realize that <code>ImageComponent</code> and <code>VideoComponent</code> will actually have to inherit from <code>ActiveRecord::Base</code>. Is there any way to nicely implement model subclassing in Rails? </p>\n\n<p>Right now I have my <code>Component</code> model setup to be <code>polymorphic</code> such that <code>ImageComponent</code> and <code>VideoComponent</code> each <code>has_one :component, as: :componentable</code>. This adds a layer of annoyance and ugliness to my code though:</p>\n\n<pre><code>image_component = ImageComponent.create\ncomponent = Component.create\ncomponent.componentable = image_component\nlayer.components &lt;&lt; component\n</code></pre>\n\n<p>I guess a simple way to explain this is that I want to implement a habtm relationship between Layers and Components. I have multiple types of Components (i.e. ImageComponent, VideoComponent) that each have the same base structure but different fields associated with them. Any suggestions on ways this can be accomplished? I feel that I am missing something because my code feels hackish.</p>\n"},{"tags":["mysql","ruby-on-rails","locking","race-condition"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":150,"score":3,"question_id":9535800,"title":"solving for a race condition in rails ( limited number of X in Y )","body":"<p>Edit: Using MySQL...</p>\n\n<p>Say you have an app that adds students to a class, and that class has limited space... so you do something like this:</p>\n\n<pre><code>def add\n  if some_classroom.size &lt; MAX_SIZE\n    add_student_to_class\n  end\nend\n</code></pre>\n\n<p>That's a race condition in a multi-threaded environment. Lame.</p>\n\n<p>Assuming we </p>\n\n<ol>\n<li>don't want this, and  </li>\n<li>don't want to lock our classroom table or record (which causes our app to suck elsewhere)</li>\n</ol>\n\n<p>What do we do?</p>\n\n<p>I propose this:</p>\n\n<pre><code>class Classroom &lt; ActiveRecord::Base\n  has_one :classroom_lock\n  after_create :create_lock_record\n\n  def create_lock_record\n    c = ClassroomLock.new\n    c.classroom = self\n    c.save!\n  end\nend\n\nclass ClassroomLock &lt; ActiveRecord::Base\n  belongs_to :classroom\nend\n\ndef add\n  c = Classroom.first\n  ActiveRecord::Base.transaction do\n    c.classroom_lock.lock!\n    c = Classroom.first #load this again (it might have changed)\n    if c.size &lt; MAX_SIZE\n      c.add_new_student(some_student)\n    else\n      do_stuff_about_not_enough_room\n    end\n  end\nend\n</code></pre>\n\n<p>This seems like it should work awesomely.  My (ficticious) Classroom#show method doesn't block because the classroom record isn't actually locked and the add method is effectively single threaded since any additional processes will be forced to wait at the lock! line until the lock is released.</p>\n\n<p>Does this work?  Maybe? I think so?  I don't know...</p>\n\n<p>I've done a fair bit of hammering this with multiple processes at once, but it's hard to know for sure (it is a race condition after all).</p>\n\n<p>Can anyone provide some additional insight?</p>\n"},{"tags":["ruby-on-rails","attributes","routes","nested"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13293462,"title":"Ruby on Rails: Need help updating db attribute in a nested route","body":"<p>Let me preface this by saying, i'm pretty new to rails and programming. </p>\n\n<p>I'm trying to make some links to toggle a boolean attribute on and off. I've essentially succeeded in doing it on a non-nested resource by doing the following: </p>\n\n<p>Route:   </p>\n\n<pre><code>resources :my_resource do\n get 'toggle_attribute', :on =&gt; :member\nend\n</code></pre>\n\n<p>Controller:  </p>\n\n<pre><code>def toggle_attribute\n  @resource = Resource.find(params[:id])\n  @resource.toggle!(:attribute)\nend\n</code></pre>\n\n<p>View: \n<code>&lt;%= link_to \"Toggle Resource\", toggle_attribute_resource_path(@resource), :remote =&gt; true %&gt;</code></p>\n\n<p>First, like I said above, this works on my non-nested route, however no matter what solution I try to add to the controller I can't get my link to flash a message or re-direct to anything when clicked, you click the button and nothing happens, you have to manually refresh to see the change.</p>\n\n<p>Second, I can't figure out how to get this same sort of thing to work on a route that is nested like so:</p>\n\n<p>Route:  </p>\n\n<pre><code>resources :resource_1 do\nresources :resource_2\nend\n</code></pre>\n\n<p>Can anyone give me some tips?</p>\n\n<p>Thanks a ton in advance. This stuff has been driving me batty. </p>\n"},{"tags":["ruby-on-rails","forms","dom","views"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13296663,"title":"Why does the \"submit\" button display before the <form>?","body":"<p>This is kind of surprising. Even though it looks to me like my submit tag is supposed to occur within the form, it displays before the form. The html source looks ok to me, but the resultant display and DOM is wrong. Not sure what would have shuffled it. The submit button is displayed BEFORE the form.</p>\n\n<p>Can you see something?</p>\n\n<p>view file:</p>\n\n<pre><code>&lt;%= content_tag :table do %&gt;\n  &lt;%= content_tag :thead do %&gt;\n    &lt;% 5.times do |q| %&gt;\n      &lt;%= content_tag :th, \"1\" %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n  &lt;%= content_tag :tbody do %&gt;\n    &lt;%= form_tag program_participant_round_survey_path(\n        program_id: @program.id, participant_id: @participant.id, round_id: @current_round.id), :method =&gt; 'put'  do %&gt;\n      &lt;%= render partial: 'value', collection: @values  %&gt;\n      &lt;%= submit_tag \"Save\" %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>key part of the html:</p>\n\n<pre><code>...\n&lt;tr&gt;\n  &lt;td&gt;\n    Scaling Up vs. Scaling Out\n&lt;/td&gt;\n    &lt;td&gt;\n      &lt;input id=\"values__q0\" name=\"values[]\" type=\"radio\" value=\"q0\" /&gt;\n&lt;/td&gt;    &lt;td&gt;\n      &lt;input id=\"values__q1\" name=\"values[]\" type=\"radio\" value=\"q1\" /&gt;\n&lt;/td&gt;    &lt;td&gt;\n      &lt;input id=\"values__q2\" name=\"values[]\" type=\"radio\" value=\"q2\" /&gt;\n&lt;/td&gt;    &lt;td&gt;\n      &lt;input id=\"values__q3\" name=\"values[]\" type=\"radio\" value=\"q3\" /&gt;\n&lt;/td&gt;&lt;/tr&gt;\n      &lt;input name=\"commit\" type=\"submit\" value=\"Save\" /&gt;\n&lt;/form&gt;&lt;/tbody&gt;&lt;/table&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Here's what the page looks like in the browser: <img src=\"http://i.stack.imgur.com/w8xER.png\" alt=\"image in browser\"></p>\n\n<p>And here's what it looks like as DOM: <img src=\"http://i.stack.imgur.com/8MyQC.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13296013,"title":"joining two tables in rails 3","body":"<p>i have problem with joining two tables and i am so confused, so i made new project as this example: <a href=\"http://guides.rubyonrails.org/association_basics.html#the-has_many-association\" rel=\"nofollow\">http://guides.rubyonrails.org/association_basics.html#the-has_many-association</a> i have two tables customers and orders.</p>\n\n<p>My models</p>\n\n<pre><code>class Customer &lt; ActiveRecord::Base\n  has_many :orders\n  attr_accessible :id, :name\nend\n\nclass Order &lt; ActiveRecord::Base\n  belongs_to :customer\n  attr_accessible :id, :count, :customer_id\nend\n</code></pre>\n\n<p>In migration orders table, i have reference to customers table realized with:</p>\n\n<pre><code>t.references :customer\n</code></pre>\n\n<p>I fill tables with some sample data and run this sql query which is working.</p>\n\n<pre><code>select * from customers inner join orders on customers.id = orders.customer_id;\n</code></pre>\n\n<p>than i open rails console and run this query:</p>\n\n<pre><code>Customer.joins(:orders)\n</code></pre>\n\n<p>which give me result of only customers, but i hope for merge of two models and appropriate result. when i run</p>\n\n<pre><code>Order.joins(:customer)\n</code></pre>\n\n<p>it return me only result of orders.</p>\n\n<p>Is there option for retrieve merge result of two models? Thanks in advice :)</p>\n"},{"tags":["ruby-on-rails","ruby","http","http-headers","url-routing"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13295962,"title":"Overriding Resource Route in Rails 2","body":"<p>I am trying to override the route of a resource only for an option request. I need this to properly get Cross Domain photo upload requests.</p>\n\n<p>routes.rb</p>\n\n<pre><code>map.resources :photos\nmap.connect '/photos', :controller =&gt; 'photos',\n   :action =&gt; 'options_stuff', :conditions =&gt; {:method =&gt; :options }\n</code></pre>\n\n<p>photos_controller.rb</p>\n\n<pre><code>def options_stuff\n    puts \"got to options@!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\"\n    set_access_control_headers\n    head :ok\n    render :nothing =&gt; true, :status =&gt; 200\nend\n\n\ndef set_access_control_headers\n    headers['Access-Control-Allow-Origin'] = '*'\n    headers['Access-Control-Allow-Methods'] = 'POST, GET, OPTIONS'\n    headers['Access-Control-Max-Age'] = '1000'\n    headers['Access-Control-Allow-Headers'] = '*,x-requested-with'\n    puts \"headers are #{headers}\"\nend\n</code></pre>\n\n<p>However it never gets to the controller I need. What am I doing wrong?</p>\n\n<p>Btw, I am following the following 2 articles about how to do it: <a href=\"http://www.codeodor.com/index.cfm/2011/7/26/Responding-to-the-OPTIONS-HTTP-method-request-in-Rails-Getting-around-the-Same-Origin-Policy/3387\" rel=\"nofollow\">http://www.codeodor.com/index.cfm/2011/7/26/Responding-to-the-OPTIONS-HTTP-method-request-in-Rails-Getting-around-the-Same-Origin-Policy/3387</a></p>\n\n<p><a href=\"https://gist.github.com/832700\" rel=\"nofollow\">https://gist.github.com/832700</a></p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","devise","ruby-on-rails-plugins"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13293737,"title":"Allow AJAX Through Devise (Rails)","body":"<p>I've just added and configured the devise gem. It's working great except for blocking my form's autosave AJAX calls.</p>\n\n<p>At the top of my controller, I have:</p>\n\n<pre><code>before_filter :authenticate_user!\n</code></pre>\n\n<p>My AJAX call comes to the same controller:</p>\n\n<pre><code>  def autosave\n    #TODO: update relative entry\n    #TODO: verify user logged in\n    #TODO: verify entry belongs to relative user\n    render content_type: 'text/xml', inline: \"&lt;result status='ok' /&gt;\"\n  end\n</code></pre>\n\n<p>Of course I could instead declare my before filter like so:</p>\n\n<pre><code>before_filter :authenticate_user!, except: :autosave\n</code></pre>\n\n<p>..but this offers nothing to prevent anyone from calling this controller function at any time.</p>\n\n<p>What would be the best way to allow this function to be called? I still want to ensure that only logged in users can make the call and that the given record they're editing belongs to them.</p>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13296548,"title":"Rails Error H10 showing NameError and const_missing_from_s3_library","body":"<p>We have an app we are upgrading from Bamboo to Cedar and we are running into a major issue. Deployment goes through fine, but we get an immediate app error. Any ideas are appreciated.</p>\n\n<pre><code>2012-11-08T19:26:03+00:00 heroku[router]: Error H10 (App crashed) -&gt; GET secure-bayou-3300.herokuapp.com/ dyno= queue= wait= service= status=503 bytes=\n2012-11-08T19:26:56+00:00 heroku[web.1]: State changed from crashed to down\n2012-11-08T19:26:56+00:00 heroku[web.1]: State changed from down to starting\n2012-11-08T19:26:59+00:00 heroku[web.1]: Starting process with command `bundle exec thin start -p 3557 -e production`\n2012-11-08T19:27:07+00:00 app[web.1]: &gt;&gt; Using rack adapter\n2012-11-08T19:27:07+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/ext/module.rb:36:in `const_missing': uninitialized constant Rack::Builder::App (NameError)\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/aws-s3-0.6.2/lib/aws/s3/extensions.rb:206:in `const_missing_from_s3_library'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/config.ru:9:in `block (2 levels) in &lt;main&gt;'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:141:in `new'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:141:in `block in generate_map'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:141:in `each'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:141:in `generate_map'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:128:in `to_app'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/rack/adapter/loader.rb:33:in `eval'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/rack/adapter/loader.rb:33:in `load'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/rack/adapter/loader.rb:42:in `for'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/controllers/controller.rb:169:in `load_adapter'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/controllers/controller.rb:73:in `start'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:187:in `run_command'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:152:in `run!'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/bin/thin:6:in `&lt;top (required)&gt;'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'\n2012-11-08T19:27:07+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/thin:19:in `&lt;main&gt;'\n2012-11-08T19:27:08+00:00 heroku[web.1]: Process exited with status 1\n2012-11-08T19:27:08+00:00 heroku[web.1]: State changed from starting to crashed\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","selenium","capybara","minitest"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":571,"score":2,"question_id":5655154,"title":"How do you perform javascript tests with Minitest, Capybara, Selenium?","body":"<p>There are a lot of examples on how to perform javascript tests with Capybara/Selenium/<strong>Rspec</strong> in which you can write a test like so:</p>\n\n<pre><code>it \"does something\", :js =&gt; true do\n  ...\nend\n</code></pre>\n\n<p>However with <strong>minitest</strong> you can't pass a second parameter to instruct selenium to perform the test.</p>\n\n<p>Does anyone have any ideas on how this can be done?</p>\n"},{"tags":["ruby-on-rails","open-uri"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13296276,"title":"Rails - Access file sitting in different port","body":"<p>I have two instances of web server. One is running on port 3000 and one is running on 9090. I want to access the JSON file sitting in the 9090 port. </p>\n\n<p>In the rails model, I'm able to access the JSON file fine when I use</p>\n\n<pre><code>stream = open(\"http://localhost:9090/file.json\")\n</code></pre>\n\n<p>But what I want to do is something more like </p>\n\n<pre><code>stream = open(\":9090/file.json\") # OUTPUT: No such file or directory - :9090/file.json\n</code></pre>\n\n<p>I want to avoid hardcoding the URL (obviously), and if I also want to avoid passing in the 'domain' from Rails controller to rails model.</p>\n\n<p>Or is there a package that handles accessing different port, if openURI doesn't do this? </p>\n\n<p>Thank you! </p>\n"},{"tags":["ruby-on-rails","ruby","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13296339,"title":"Rails Omniauth - NoMethodError in AuthenticationsController#create","body":"<p>I am following the tutorial: <a href=\"http://railscasts.com/episodes/235-omniauth-part-1?autoplay=true\" rel=\"nofollow\">http://railscasts.com/episodes/235-omniauth-part-1?autoplay=true</a> </p>\n\n<p>I have my own sign-in and out process working. But when I try to authenticate twitter login I have </p>\n\n<p><strong>NoMethodError in AuthenticationsController#create</strong></p>\n\n<pre><code>undefined method `authentications' for nil:NilClass\n\napp/controllers/authentications_controller.rb:8:in `create'\n</code></pre>\n\n<p>My routes is:  </p>\n\n<pre><code>match '/auth/:provider/callback', to: 'authentications#create'\n</code></pre>\n\n<p>In my authentication controller, create method is:</p>\n\n<pre><code>def create\n    auth =  request.env[\"omniauth.auth\"]\n    current_user.authentications.create(:provider =&gt; auth[:provider], :uid =&gt; auth[:uid])\n    flash[:notice] = \"Success\"\n    redirect_to authentications_url\n  end\n</code></pre>\n\n<p>I don't know what is the problem :/</p>\n\n<p>That would be great if you can help me.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","migration"],"answer_count":8,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":137,"score":6,"question_id":13168450,"title":"Rails creating migration to add columns to table causes error when running rake db:migrate","body":"<p>I have a model created called \"users\" and i created a new migration to add some columns to the  users table. Now when i run rake db:migrate, I get the error below b/c it's trying to create the users table again</p>\n\n<pre><code>$ rake db:migrate\n==  DeviseCreateUsers: migrating ==============================================\n-- create_table(:users)\nrake aborted!\nAn error has occurred, all later migrations canceled:\n\nMysql::Error: Table 'users' already exists: CREATE TABLE `users`.....\n</code></pre>\n\n<p>Why is it trying to create the table again?</p>\n\n<p>Here's the command i used to create the new migration</p>\n\n<pre><code>$ rails generate migration AddDetailsToUsers home_phone:decimal cell_phone:decimal work_phone:decimal birthday:date home_address:text work_address:text position:string company:string\n</code></pre>\n\n<p>The new migration looks like this:</p>\n\n<pre><code>class AddDetailsToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :home_phone, :decimal\n    add_column :users, :cell_phone, :decimal\n    add_column :users, :work_phone, :decimal\n    add_column :users, :birthday, :date\n    add_column :users, :home_address, :text\n    add_column :users, :work_address, :text\n    add_column :users, :position, :string\n    add_column :users, :company, :string\n  end\nend\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>20120511224920_devise_create_users</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table(:users) do |t|\n      ## Database authenticatable\n      t.string :email,              :null =&gt; false, :default =&gt; \"\"\n      t.string :username,           :null =&gt; false, :default =&gt; \"\"\n      t.string :encrypted_password, :null =&gt; false, :default =&gt; \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, :default =&gt; 0\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Encryptable\n      # t.string :password_salt\n\n      ## Confirmable\n      # t.string   :confirmation_token\n      # t.datetime :confirmed_at\n      # t.datetime :confirmation_sent_at\n      # t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, :default =&gt; 0 # Only if lock strategy is :failed_attempts\n      # t.string   :unlock_token # Only if unlock strategy is :email or :both\n      # t.datetime :locked_at\n\n      ## Token authenticatable\n      # t.string :authentication_token\n\n\n      t.timestamps\n    end\n\n    add_index :users, :email,                :unique =&gt; true\n    add_index :users, :reset_password_token, :unique =&gt; true\n    # add_index :users, :confirmation_token,   :unique =&gt; true\n    # add_index :users, :unlock_token,         :unique =&gt; true\n    # add_index :users, :authentication_token, :unique =&gt; true\n  end\nend\n</code></pre>\n\n<p>20120619023856_add_name_to_users</p>\n\n<pre><code>class AddNameToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :first_name, :string\n    add_column :users, :last_name, :string\n  end\nend\n</code></pre>\n\n<p>20121031174720_add_details_to_users.rb</p>\n\n<pre><code>class AddDetailsToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :home_phone, :decimal\n    add_column :users, :cell_phone, :decimal\n    add_column :users, :work_phone, :decimal\n    add_column :users, :birthday, :date\n    add_column :users, :home_address, :text\n    add_column :users, :work_address, :text\n    add_column :users, :position, :string\n    add_column :users, :company, :string\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13296146,"title":"Ruby on Rails scope test for current user","body":"<p>I have a request table that <code>belongs_to :contact</code></p>\n\n<p>I want a scope statement in the request.rb file to test if the contact is the current user.</p>\n\n<pre><code>scope :myopen, where(:contact_id =&gt; current_user.id)\n</code></pre>\n\n<p>Returns:\nundefined local variable or method `current_user'</p>\n\n<p>What do I use for the current user id?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","postgresql"],"answer_count":7,"favorite_count":17,"up_vote_count":32,"down_vote_count":2,"view_count":10784,"score":30,"question_id":1242812,"title":"Pros/Cons of MySQL vs Postgresql for production Ruby on Rails environment?","body":"<p>I will soon be switching from sqlite3 to either postgres or mysql. What should I consider when making this decision? Is mysql more suited for Rails than postgres in some areas and/or vice versa? Or, as I somewhat suspect, does it not really matter either way?</p>\n\n<p>Another factor that might play into my decision is the availability of tools to data pump my test data from the sqlite3 db to my new one. Is there anything that ActiveRecord provides natively to do this or any decent plugins/gems to help with this task?</p>\n\n<p>BONUS: How do I pronounce \"Postgresql\" and sound like I know what I'm talking about? :)</p>\n\n<p>Thanks Greg Smith for providing the following link that shows the most common pronunciations:</p>\n\n<p><a href=\"http://www.postgresql.org/community/survey.33\" rel=\"nofollow\">http://www.postgresql.org/community/survey.33</a></p>\n\n<p>UPDATE:</p>\n\n<p>Reference this question for more: </p>\n\n<p><a href=\"http://stackoverflow.com/questions/110927/do-you-recommend-postgresql-over-mysql\">Do you recommend PostgreSQL over MySQL?</a></p>\n\n<p>FYI:</p>\n\n<p>I ended up using MySQL. There is a neat plugin called yamldb that really saved me some time with the data transfer from my sqlite db to my new mysql one. Instructions on how to install and use it can be found here:</p>\n\n<p><a href=\"http://accidentaltechnologist.com/ruby/change-databases-in-rails-with-yamldb/\" rel=\"nofollow\">http://accidentaltechnologist.com/ruby/change-databases-in-rails-with-yamldb/</a></p>\n"},{"tags":["ruby-on-rails","postgresql","replication","load-balancing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13293567,"title":"Database loadbalancing outside rails application?","body":"<p>I want to make a master/slave setup on my postgresql servers. My problem is how I can get queries from my rails app balanced to the databases? I can't use a gem like <a href=\"https://github.com/tchandy/octopus\" rel=\"nofollow\">Octopus</a>, because it collides with my use of the <a href=\"https://github.com/influitive/apartment\" rel=\"nofollow\">Apartment</a> gem (both modifies ActiveRecord) inspired by <a href=\"http://railscasts.com/episodes/389-multitenancy-with-postgresql\" rel=\"nofollow\">this rails cast</a>. Does anyone know of a way to load balance outside the rails app?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13295703,"title":"On Rails, editing collection of objects with nested resources on the go","body":"<p>I'm trying to do a backend for content curation. </p>\n\n<p>There's a collection of objects with nested associations, currently is only displaying them. Not scoped on any <code>form_for</code> for this yet. </p>\n\n<p>I would like to show the editable fields as input and be able to edit them and update on the go (no need for clicking on a save button or reload the page). </p>\n\n<p>I'm a little lost in how to do such implementation on Rails. Is there a gem to simplify this or any idea where should I look at to begin?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13295729,"title":"Update ruby object with hidden_field?","body":"<p>I'm trying to update an object using a button combined with a hidden field. But the code below updates the object with \"Don't know\" (outcome[4]). What am I doing wrong?</p>\n\n<pre><code>&lt;%= form_for(@ask) do |f| %&gt;\n&lt;% outcomes = [ \"Advice\", \"Introduction\", \"Support\", \"Money\", \"Don't know\" ] %&gt;\n&lt;ul&gt;\n&lt;% outcomes.each do |o| %&gt;\n    &lt;li&gt;\n        &lt;%= f.hidden_field :category, value: o %&gt;\n        &lt;%= f.submit o, class: \"btn btn-success\" %&gt;\n    &lt;/li&gt;\n&lt;% end %&gt;\n&lt;/ul&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The HTML for each button is:</p>\n\n<pre><code>&lt;input id=\"ask_category\" name=\"ask[category]\" type=\"hidden\" value=\"Introduction\" /&gt; #value is equal to each object in the array\n&lt;input class=\"btn btn-success\" name=\"commit\" type=\"submit\" value=\"Introduction\" /&gt;\n</code></pre>\n\n<p>which also looks right...</p>\n"},{"tags":["ruby-on-rails","popup","form-submit","edit"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1211,"score":0,"question_id":1088952,"title":"Rails, Edit page update in a window","body":"<p>I have my code working so that I have a table of businesses.  There's a pencil icon you can click on the edit the business information.  The edit information comes up in a partial inside of a modal pop up box.  The only problem is that once they make the changes they want and click update, it sends them to the 'show' page for that business. What I want to happen is have the pop up box close and have it update the information. This is my update function in my controller.</p>\n\n<pre><code> def update\n@business = Business.find(params[:id])\n\nrespond_to do |format|\n  if @business.update_attributes(params[:business])\n    flash[:notice] = 'Business was successfully updated.'\n    format.html { redirect_to(business_url(@business)) }\n    format.js\n  else\n    format.html { render :action =&gt; \"edit\" }\n    format.xml  { render :xml =&gt; @business.errors, :status =&gt; :unprocessable_entity }\n  end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>I tried following railscast 43 and i created an .rjs file but I couldn't get that to work at all. My update was still taking me to the show page.  Any help would be appreciated.</p>\n\n<p>EDIT: Added some more code.</p>\n\n<pre><code>&lt;% form_for(@business) do |f| %&gt;\n&lt;%= f.error_messages %&gt;\n\n&lt;p&gt;\n  &lt;%= f.label :name %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :name %&gt;\n&lt;/p&gt;\n...\n      &lt;%= f.label :business_category %&gt;&lt;br /&gt;\n      &lt;%= f.select :business_category_id, @business_categories_map, :selected =&gt; @business.business_category_id %&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;%= f.label :description %&gt;&lt;br /&gt;\n      &lt;%= f.text_area :description %&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;%= f.submit 'Update' %&gt;\n    &lt;/p&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>This is my form inside of my edit page which is being called through the index in a pop up by:</p>\n\n<pre><code>&lt;div id=\"popupEdit&lt;%=h business.id %&gt;\" class=\"popupContact\"&gt;\n      &lt;a class=\"popupClose&lt;%=h business.id %&gt;\" id=\"popupClose\"&gt;x&lt;/a&gt;\n      &lt;% if business.business_category_id %&gt;\n        &lt;% @business = business  %&gt;\n        &lt;%= render \"business/edit\" %&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","search","ransack"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13284172,"title":"Setting default search parameter on Ransack for rails","body":"<p>I've been wracking my brain over this but can't get it. I feel like the answer is probably obvious</p>\n\n<p>What I'm trying to do is the following:</p>\n\n<p>I have an index controller which lists a series of Jobs which I can search using Ransack. Each job has a completion date which either has a date in it or is null (unfinished). Currently the search itself works great. I would like to make it so that the index page loads up showing only the unfinished work, but I also want it to work so that when someone does run a search, returns results for both finished and unfinished work.</p>\n\n<p>Any help would be greatly appreciated. In the code below :actual is the name of the field with the completion date. I also was looking around the web and thought that maybe something like the DEFAULT_SEARCH_PARAMETER={} that I have in the Job model might work but I couldn't seem to get it to.</p>\n\n<pre><code>class Job &lt; ActiveRecord::Base\n  DEFAULT_SEARCH_PARAMETER ={}\n  attr_accessible :items_attributes, :actual\nend\n\ndef index\n   @search = Job.search(params[:q] || Job::DEFAULT_SEARCH_PARAMETER)\n   @search.build_condition\n   @results = @search.result\n   @job = @results.paginate(:per_page =&gt; 10, :page =&gt; params[:page])\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13295957,"title":"using f.select, undefined method `map' for nil:NilClass","body":"<p>Ok so i am tring to list my genres in a f.select form and I am getting an error. I have look everywhere and i am just not understanding what i am doing differently. when I enter rails c and type <code>g = Genre.all</code> it lists all genres then <code>g.map</code> out puts <code>=&gt; #&lt;Enumerator: ...&gt;</code> </p>\n\n<p>Error:</p>\n\n<pre><code>undefined method `map' for nil:NilClass\n</code></pre>\n\n<p>View Page:</p>\n\n<pre><code>&lt;%= f.fields_for :genres do |g| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= g.label :genre %&gt;\n    &lt;%= g.select :genres, @genres.map {|g| g.name} %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>def create\n  @song = Song.new(params[:song])\n  @genres = Genre.all\n  if @song.save\n    redirect_to player_path\n  else\n    render :new\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord","immutable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13293608,"title":"ActiveRecord::Base Class Not Mutable?","body":"<p>I have a class I've extended from ActiveRecord::Base...</p>\n\n<pre><code>class Profile &lt; ActiveRecord::Base\n</code></pre>\n\n<p>and I collect the records from it like so...</p>\n\n<pre><code>records = @profile.all\n</code></pre>\n\n<p>which works fine, but it doesn't seem that I can successfully Update the attributes.  I don't want to save them back to the database, just modify them before I export them as JSON.  My question is, why can't I update these?  I'm doing the following (converting date formats before exporting):</p>\n\n<pre><code>        records.collect! { |record|\n        unless record.term_start_date.nil?\n            record.term_start_date = Date.parse(record.term_start_date.to_s).strftime('%Y,%m,%d')\n        end\n\n        unless record.term_end_date.nil? \n            record.term_end_date = Date.parse(record.term_end_date.to_s).strftime('%Y,%m,%d') \n        end\n\n        record\n    }\n</code></pre>\n\n<p>At first I had just been doing this in a do each loop, but tried collect! to see if it would fix things, but no difference.  What am I missing?  </p>\n\n<p>P.S. - I tried this in irb on one record and got the same results.</p>\n"},{"tags":["jquery","html","css","ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":99,"score":0,"question_id":11041373,"title":"Dynamic Input Width with Labels","body":"<p>I'm attempting to create dynamic width field inputs so that they stretch to the width of the div.</p>\n\n<p>If there are two inputs on a single line, they will dynamically split the space available to fill 100% of the div.</p>\n\n<p>If there is only one input on a line, it will fill the whole width.</p>\n\n<p>The issue is that the label width and the input width are both unknown (responsive web design).</p>\n\n<p>It's surprising that this is difficult to do with how common I'm sure it must be.</p>\n\n<p><a href=\"http://imagepaste.nullnetwork.net/img/1339700574Screen%20Shot%202012-06-14%20at%203.04.59%20PM.png\" rel=\"nofollow\">http://imagepaste.nullnetwork.net/img/1339700574Screen%20Shot%202012-06-14%20at%203.04.59%20PM.png</a></p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":561,"score":6,"question_id":4926180,"title":"mass_assignment_authorizer and nested attributes","body":"<p>I'm using dynamic <code>attr_accessible</code> as per this article:</p>\n\n<p><a href=\"http://asciicasts.com/episodes/237-dynamic-attr-accessible\" rel=\"nofollow\">http://asciicasts.com/episodes/237-dynamic-attr-accessible</a></p>\n\n<p>It works fine. But I haven't found an elegant way to make it work with nested attributes. Here's some simplified code:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  has_many :employees\n\n  accepts_nested_attributes_for :employees\nend\n\nclass Employee &lt; ActiveRecord::Base\n  belongs_to :company\n\n  attr_protected :salary\n\n  attr_accessor :accessible\n\n  def mass_assignment_authorizer  \n    if accessible == :all\n      ActiveModel::MassAssignmentSecurity::BlackList.new\n    else\n      super + (accessible || [])\n    end\n  end \nend\n</code></pre>\n\n<p>Let's say I have an admin interface with a RESTful form for a Company. On this form, I have fields for <code>employees_attributes</code>, including blank fields to create new Employees. I can't find a way to call <code>Employee#accessible=</code> in this context. Browsing through the ActiveRecord source code, it seems that this might be impossible: in the remotest part of a very deep call stack, nested associations just result in <code>Employee.new</code> being called with the attributes.</p>\n\n<p>I'd thought about creating a special attribute that could be passed in through mass assignment. If the attribute's value were the right code, the Employee instance would set <code>@accessible</code> to <code>:all</code>. But I don't think there's a way to guarantee that this attribute gets set before the protected attributes.</p>\n\n<p>Is there any way to make dynamic protected attributes work with nested attributes?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13295090,"title":"Ruby on Rails: How to define an extension and put it into a database?","body":"<p>I want to modify following code in order to be able to write only the file extension into a database. Now I read the file_content_type, but I need only to know the extension (it doesnt matter for me that th extension can be changed) and to put it into a database. \nupload_file_name has an extension already, but I need to extract it and put it in the same database-table as a new row.</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20120731045929) do\n\n  create_table \"uploads\", :force =&gt; true do |t|\n    t.string   \"upload_file_name\"\n    t.string   \"upload_content_type\"\n    t.string   \"user\"\n    t.integer  \"upload_file_size\"\n    t.datetime \"upload_updated_at\"\n    t.datetime \"created_at\",          :null =&gt; false\n    t.datetime \"updated_at\",          :null =&gt; false\n  end\n</code></pre>\n\n<p>end</p>\n\n<p>And it is possible somehow to save the file_name without an exxtension?\nTHanks in advanced</p>\n"},{"tags":["ruby-on-rails","actionview","renderer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13294566,"title":"Rails: view lookup context","body":"<ol>\n<li>I <code>render</code> a <code>category</code> variable of <code>MyEngine::Category</code> type</li>\n<li><code>MyEngine</code>'s <code>categories/category</code> partial is overriden in <code>app/views/my_engine/categories/_category.html.erb</code></li>\n<li>When I <code>render product</code> (product variable of <code>Product</code>; <code>Product</code> is app's class and view isn't connected with <code>my_engine</code>) from it...</li>\n<li>I get <code>Missing partial my_engine/products/product</code> error.</li>\n</ol>\n\n<p>Problem is <code>my_engine</code> prefix. Partial is not <code>my_engine/products/product</code>. It should be <code>products/product</code>. How have I change context to (from <code>my_engine/products</code> to <code>products</code>)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","nested-forms","saving"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":43,"score":-1,"question_id":13256662,"title":"ROR3: Why is this not saving?","body":"<p>This functionality used to work but has suddenly stopped and I have no idea why. I've made changes before I ran the tests but, having retraced my steps I don't know what has changed. Can a fresh pair of eyes tell me why this is saving the posts but not the locations?</p>\n\n<p><em>Model Post.rb</em></p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n attr_accessible :title, :body, :tag_list, :locations_attributes\n has_and_belongs_to_many :locations\n accepts_nested_attributes_for :locations, :reject_if =&gt; :all_blank\nend\n</code></pre>\n\n<p>*Controller Posts_controller.rb *</p>\n\n<pre><code>class PostsController &lt; ::Blogit::ApplicationController\n\n...     \n\ndef new\n  @post = current_blogger.blog_posts.new(params[:post])\n  @location = @post.locations.build\nend\n\ndef update\n  @post = current_blogger.blog_posts.find(params[:id])\n  if @post.update_attributes(params[:post])\n    redirect_to @post, notice: 'Blog post was successfully updated.'\n  else\n    render action: \"edit\"\n  end\nend\n\ndef create\n  @post = current_blogger.blog_posts.new(params[:post])\n  if @post.save\n    redirect_to @post, notice: 'Blog post was successfully created.'\n  else\n    render action: \"new\"\n  end\nend\n\nend\n</code></pre>\n\n<p>*View _form.html.erb*</p>\n\n<pre><code>&lt;%= nested_form_for(@post, :html=&gt; {:multipart =&gt; true, :class=&gt; \"new_blog_post\", :id=&gt; \"new_blog_post\"}) do |f| %&gt;\n\n ...\n\n&lt;%= field do %&gt;\n  &lt;%= f.text_field :title, placeholder: \"Give your post a title\", :class=&gt;\"span12\" %&gt;\n&lt;% end %&gt;\n&lt;%= field do %&gt;\n  &lt;%= f.text_area :body, placeholder: \"Write something here...\", :id=&gt;\"blog-text\", :class=&gt;\"span12\" %&gt;\n &lt;% end %&gt;\n\n&lt;%= field id: \"new_blog_post_tag_field\" do %&gt;\n  &lt;%= f.label :tag_list, \"Tags\" %&gt;\n  &lt;%= f.text_field :tag_list, placeholder: \"tag one, tag two, etc...\" %&gt;\n&lt;% end %&gt;\n\n&lt;%= f.label :search_locations, \"Add locations to your post\" %&gt;\n   &lt;%= render :partial =&gt; 'search_locations', :locals =&gt; { :f =&gt; f }  %&gt;\n\n &lt;p&gt;&lt;%= f.link_to_add \"Add a location\", :locations %&gt;&lt;/p&gt;\n\n&lt;%= actions do %&gt;\n&lt;%= f.submit \"Submit\", :class=&gt;\"btn\", :disable_with =&gt; 'Uploading Image...' %&gt; or \n&lt;%= link_to(\"cancel\", @post.new_record? ? root_path : post_path(@post)) %&gt;\n\n&lt;% end %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>*Form Partial _search_locations.html.erb*</p>\n\n<pre><code> &lt;%= f.fields_for :locations do |m| %&gt;\n\n\n &lt;%= m.text_field :name,:class=&gt;\"localename\", :id=&gt;\"appendedInput\", :placeholder=&gt; \"Name of the location\", :autocomplete =&gt; \"off\" %&gt;\n\n\n &lt;span class=\"add-on\"&gt;&lt;%= m.link_to_remove do %&gt;&lt;i class='icon-trash'&gt;&lt;/i&gt;&lt;/span&gt;&lt;%end%&gt;\n\n\n &lt;% end %&gt;\n</code></pre>\n\n<p>And the actual submission in the logs comes up as this:</p>\n\n<pre><code>Started PUT \"/blog/posts/51-hong-kong\" for 127.0.0.1 at 2012-11-06 17:41:00 +0000\nProcessing by Blogit::PostsController#update as HTML\nParameters: {\"utf8\"=&gt;\"✓\", \n\"authenticity_token\"=&gt;\"s+2117Qi/HzO/D/ORINhqHChMJR3S5XK7y/s3rq3dnc=\", \"post\"=&gt;{\"title\"=&gt;\"Hong \nKong \", \"body\"=&gt;\"Lorem ipsum dolor sit amet, consectetur adipiscing elit. In orci elit,  \nrhoncus quis interdum vel, interdum non nulla. Phasellus nec massa lorem. Duis malesuada   \npellentesque orci, accumsan mollis augue aliquam mollis. Pellentesque luctus orci in enim \nhendrerit adipiscing. Mauris tempor tortor in leo posuere tristique.\", \"tag_list\"=&gt;\"\", \n\"locations_attributes\"=&gt;{\"0\"=&gt;{\"_destroy\"=&gt;\"false\",    \n\"name\"=&gt;\"London\",\"longitude\"=&gt;\"-0.1276831\", \"latitude\"=&gt;\"51.5073346\"}}},\n\"_wysihtml5_mode\"=&gt;\"1\", \"name\"=&gt;\"London\", \"legname\"=&gt;\"London\", \"longitude\"=&gt;\"-0.1276831\",\n\"latitude\"=&gt;\"51.5073346\", \"commit\"=&gt;\"Submit\", \"id\"=&gt;\"51-hong-kong\"}\n</code></pre>\n\n<p>Why is this saving the post but not the locations info? </p>\n"},{"tags":["ruby-on-rails","ruby","daemons"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13295398,"title":"I can't run my Rails server with daemons gem","body":"<p>I want to use Daemons gem with my Rails project so I can easily monitore it with Monit, this gem will allow me to create PIDs and use commands like start and stop . </p>\n\n<p>Anyways it seems I can't use it with rails somehow, I tried to run this :</p>\n\n<pre><code>require 'rubygems'\nrequire 'daemons'\n\nROOT_PATH = File.expand_path(\"#{File.dirname __FILE__}/../\")\n\nDaemons.run(\"#{ROOT_PATH}/script/rails\" , \n    :dir_mode =&gt; :system, \n    :log_output =&gt; true \n    )\n</code></pre>\n\n<p>Then : </p>\n\n<pre><code>bundle exec ./bin/admin run -- s\n</code></pre>\n\n<p>But I'm getting this error </p>\n\n<pre><code>/Users/info/.rvm/gems/ruby-1.9.3-p286/gems/rake-0.8.7/lib/rake/alt_system.rb:32: Use RbConfig instead of obsolete and deprecated Config.\n=&gt; Booting WEBrick\n=&gt; Rails 3.0.5 application starting in development on http://0.0.0.0:3000\n=&gt; Call with -d to detach\n=&gt; Ctrl-C to shutdown server\nconfiguration /config.ru not found\nExiting\n</code></pre>\n\n<p>Any help would be appreciated </p>\n\n<p>Thanks </p>\n"},{"tags":["ruby-on-rails","caching","browser-cache"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13294910,"title":"how to cache only HTML contents in Rails?","body":"<p>I tried to use <code>before_filter</code> and <code>set no-cache</code> but it disables assets cache too. \nI wanted to keep my assets cache and disable only HTML caching by browser. Is there any way of caching only HTML contents in Rails?</p>\n"},{"tags":["ruby-on-rails","security","cors"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13242049,"title":"Security for cross-origin resource sharing","body":"<p>I have 2 ruby on rails app sitting on 2 different domains (say <em><code>www.exampleA.com</code></em> and <em><code>www.exampleB.com</code></em>. I want to share resources between the 2 apps and I'm using CORS:</p>\n\n<p><em><code>exampleA.com</code></em> sends http POST request to <em><code>exampleB.com</code></em>. </p>\n\n<p>At <em><code>exampleB.com</code></em> I'm checking <code>request.env['HTTP_ORIGIN']</code> to make sure that the request comes from <em><code>exampleA.com</code></em>. If true I respond by setting the response headers to allow the http post request.</p>\n\n<p>My question is can I use <code>request.env['HTTP_ORIGIN']</code> as the only check to verify the identity of requester? </p>\n\n<p>Is it possible for someone from <em><code>www.exampleC.com</code></em> to fake their HTTP_ORIGIN to look like <em><code>www.exampleA.com</code></em> and post malicious data? If so what's the best way to verify requester identity?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","before-save"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13295270,"title":"Accessing Variables in Rails 3 before_save Method","body":"<p>I have the following <code>before_save</code> method:</p>\n\n<pre><code>def get_data\n  url = \"http://www.api-fetching-url.com/where_my_data_input_is=#{self.my_data}&amp;output=json\"\n  new_data = HTTParty.get(url)\n  @field_to_update = new_data['one']['two']['here']\n  self.field_to_update = @field_to_update\nend\n</code></pre>\n\n<p>Unfortunately, the <code>self.my_data</code> doesn't appear to be working, because the JSON url doesn't produce any result. But, when I substitute <code>my_data</code> in the hardcoded way, it works just fine. Moreover, I can do a <code>find</code> in the Rails console and get the <code>my_data</code> field just fine. So, it's not an issue with that field not saving or something on the form side.</p>\n\n<p>Is there an issue inserting data this way in a <code>before_save</code> method? If not, is there a different way of doing this that I'm missing?</p>\n"},{"tags":["sql","ruby-on-rails","postgresql","database-design","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":13272776,"title":"What to use instead of Polymorphic Associations?","body":"<p>So for a number of reasons Polymorphic Associations are considered bad database design, e.g. you can't have foreign keys on the polymorphic id columns so referential integrity is gone.</p>\n\n<p>And, STI is also considered bad <em>unless</em> the sub-types only differ on behavior.</p>\n\n<p>So my question is <b>for Rails / ActiveRecord</b> what is the lesser evil in the following scenario:</p>\n\n<p>I need to allow my users to create a hand-ordered collection of multiple types of entities.</p>\n\n<p>Using Polymorphic Associations the schema would look something like this:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, exhibitable_type, exhibitable_id, position\n\n-- photographs\nid, ...\n\n-- films\nid, ...\n\n-- paintings\nid, ...\n\n-- songs\nid, ...\n\n-- sculptures\nid, ...\n</code></pre>\n\n<p>I could use STI and have something like this:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, artwork_id, position\n\n-- artworks\nid, type, &lt;photograph columns&gt;, &lt;film columns&gt;, &lt;painting columns&gt;, etc.\n</code></pre>\n\n<p>But, because my artworks differ on data (and not just behavior), I now have NULLs all over the artworks table. I've also introduced an inheritance hierarchy to my objects which previously wasn't there and I am generally wary of, particularly when its only purpose is to serve the database design.</p>\n\n<p>STI does seem like it would at least be simpler to query and code for.</p>\n\n<p>So which is the lesser evil?</p>\n\n<p>Then, the other option is multi-table inheritance:</p>\n\n<pre><code>-- collections\nid, name, ...\n\n-- exhibits\nid, collection_id, artwork_id, position\n\n-- artworks\nid\n\n-- photographs\nartwork_id, &lt;photograph columns&gt;\n\n-- films\nartwork_id, &lt;film columns&gt;\n</code></pre>\n\n<p>This would get rid of STI's NULL problem and also keep the table sizes down. We still have object hierarchy that I don't think is strictly necessary. But the biggest problem in my eyes: Rails doesn't support it. The <a href=\"https://github.com/peterhamilton/citier/\" rel=\"nofollow\">CITIER</a> gem looks very nice and it has recent commits but it is not that widely used so I am cautious of using it in my app's foundation. I guess I could also look at using Sequel or another ORM that has CTI support.</p>\n\n<p>Truth be told I think I like the multi-table inheritance solution the best</p>\n\n<p>If I didn't need the position column I would simply use separate join tables like <code>collections_photographs</code>, <code>collections_paintings</code>, <code>collections_films</code>, etc. but I do need that manual ordering.</p>\n\n<p>So, it seems the options are:</p>\n\n<ul>\n<li>PA: loss of referential integrity (does it matter in practice if always using ActiveRecord for database access?)</li>\n<li>STI: big table with lots of nulls</li>\n<li>CTI/MTI: relying on a gem that isn't widely used</li>\n</ul>\n\n<p>Which is the lesser evil and are there any other options? I am using Postgres.</p>\n"},{"tags":["ruby-on-rails","ruby","printing","console","logging"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1436,"score":3,"question_id":5673584,"title":"puts doesn't print stuff to console","body":"<p>i'm use <a href=\"http://pow.cx/\" rel=\"nofollow\">POW</a> for local rails development. i don't know why, but i can't <strong>print</strong> or <strong>puts</strong> information to my development.log. i want to puts the content of variables to console / log from my controller. any advice?</p>\n\n<p>i read my logs with <code>tail -f logs/development.log</code></p>\n\n<p>thanks!</p>\n"},{"tags":["ruby-on-rails","vim","rspec","rspec-rails","rails.vim"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13290739,"title":"Does running rspec in rails.vim execute in the development environment?","body":"<p>I've noticed some odd behavior with rspec in the past, where the environment didn't seem quite right and I couldn't ever really explain it. This morning, I had my development log open to observe some ajax calls I working on as they hit the server. I left it open and moved on to testing a new feature. I noticed that when I run the spec in rails.vim with <code>:.Rake</code> it was logging to the development log I'd left open. When I ran the same test via the terminal using <code>rspec path_to_file:415</code> it logs to the test file. Is there somewhere that the environment is getting set specifically in rails.vim that overrides what's in the config?</p>\n"},{"tags":["ruby-on-rails","ruby","faye"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":18,"score":3,"question_id":13288849,"title":"Rails faye server won't start","body":"<p>I have an Rails application which I am attempting to include the <code>faye</code> ruby gem.<br>\nI have installed <code>faye</code> with   </p>\n\n<pre><code>gem install faye \n</code></pre>\n\n<p>and added a faye.ru to my root rails app. folder:</p>\n\n<pre><code>require 'faye'\nFaye::WebSocket.load_adapter('thin')\nfaye_server = Faye::RackAdapter.new(:mount =&gt; '/faye', :timeout =&gt; 45)\nrun faye_server\n</code></pre>\n\n<p>When I want to start faye with:  </p>\n\n<pre><code>rackup -s thin -E production config.ru \n</code></pre>\n\n<p>I only get:   </p>\n\n<pre><code>`require': cannot load such file -- faye\n</code></pre>\n\n<p>How do I address this issue? </p>\n"},{"tags":["ruby-on-rails","authlogic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13294342,"title":"How to use format.js when credentials are incorrect and redirect when credentials are correct?","body":"<p>I am using Authlogic gem for user sessions.</p>\n\n<p>The login form is shown in a modal, so if the user credentials are incorrect, I want to display the error message on the modal, thats why I use <code>remote: true</code>.</p>\n\n<pre><code>&lt;%= form_for @user_session, url: user_session_path, ***remote: true do |f| %&gt;\n</code></pre>\n\n<p>I want to respond_to format.js when the user_session had errors, and redirect_back_or_default root_path when user_session is saved correctly</p>\n\n<p>The problem I am having, is that if the credentials are correct, the page is <strong>not</strong> redirected. </p>\n\n<p>Here is a screenshot of the resulting requests for a request with proper credentials:\n<img src=\"http://i.stack.imgur.com/3bT9U.png\" alt=\"Requests\"></p>\n\n<h3>user_sessions_controller.rb</h3>\n\n<pre><code>class UserSessionsController &lt; ApplicationController\n  before_filter :require_no_user, :only =&gt; [:new, :create]\n  before_filter :require_user, :only =&gt; :destroy\n\n  def new\n    @user_session = UserSession.new\n    if @user_session.save\n      redirect_back_or_default root_path\n    else\n      format.js\n    end\n  end\n\n  def create\n    @user_session = UserSession.new(params[:user_session])\n    if @user_session.save\n      flash[:notice] = \"Login successful!\"\n      redirect_back_or_default root_path\n    else\n      render :action =&gt; :new\n    end\n  end\n\n  def destroy\n    current_user_session.destroy\n    flash[:notice] = \"Logout successful!\"\n    redirect_to authentications_path\n  end\nend\n</code></pre>\n\n<h3>new.js.erb</h3>\n\n<pre><code>(function($){\n  &lt;% if @user_session.errors.any? %&gt;\n    $errorsContainer = $(\"#login-errors\").empty();\n    &lt;% @user_session.errors.full_messages.each do |msg| %&gt;\n      $errorsContainer.append('&lt;div class=\"alert alert-error\"&gt;&lt;%= msg %&gt;&lt;/div&gt;');\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n})(jQuery)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","linux","excel","spreadsheet"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13291094,"title":"Write in an existing Excel .xls file","body":"<p>I want to insert datas an existing Excel (.xls) file with Ruby under Linux. This file has already data, it has some format properties and it contains macros.</p>\n\n<p>I tried to insert data into the file with the spreadsheet gem but when I save modifications, the format and all the macros of the file are lost.</p>\n\n<p>Here's an example of a simple modification where I meet this problem : </p>\n\n<pre><code>book = Spreadsheet.open('myOriginalFile.xls')\nsheet = book.worksheet 0\nsheet.write('C12','hello')\nbook.write('myModifiedFile.xls')\n</code></pre>\n\n<p>I tried lots of things, did research on forums and the web but I didn't find a solution... \nDoes anyone has an idea?</p>\n"},{"tags":["ruby-on-rails","ruby","cmusphinx"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13294252,"title":"How to use CMU Sphynx voice recognition with Ruby application?","body":"<p>I'm searching for how to use CMU Sphynx with Ruby (Rails) application. I need very simple task - I have an mp3 file and I want get it transcribed into text.</p>\n\n<p>How can I implement this easiest way? I dont' know C/C++ and my task isn't so big to learn C/C++ for it :)</p>\n\n<p>Thanks for help!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","file-upload","yaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13286583,"title":"Why yaml file upload does not work? I think permission problems","body":"<p>I would like to load in the config directory, a yaml file chosen by the user.\nI have a view:</p>\n\n<pre><code>&lt;h1&gt;File Upload&lt;/h1&gt;\n&lt;p&gt;Upload your Yaml Configuration File&lt;/p&gt;\n\n&lt;p style=\"color: green\"&gt;&lt;%= flash[:notice] %&gt;&lt;/p&gt;\n\n&lt;%= form_for :uploadFile, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n\n  &lt;label for=\"upload_file\"&gt;Select File:&lt;/label&gt;\n  &lt;%= f.file_field :upload %&gt;\n  &lt;%= f.submit \"Upload\", :disable_with =&gt; 'Uploading...' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and I have a controller:</p>\n\n<pre><code>class UploadController &lt; ApplicationController\ndef uploadFile\n    uploaded_io = params[:uploadFile][:upload]\n    File.open(Rails.root.join('config', uploaded_io.original_filename), 'w') do |file|\n        file.write(uploaded_io.read)\n    end\n\n    flash.now[:notice]=\"File has been uploaded successfully\"\n\nend\nend\n</code></pre>\n\n<p>When the user selects the file and press \"upload\" nothing happens and the file is not in the config folder. What can I do? Maybe I should use \"import yaml\" and load it in a certain way, how?</p>\n\n<p>The log said this: </p>\n\n<pre><code>Started POST \"/upload/uploadfile\" for 127.0.0.1 at 2012-11-08 10:51:46 +0100\nProcessing by UploadController#uploadfile as HTML\n  Parameters: {\"utf8\"=&gt;\"âœ“\",  \"authenticity_token\"=&gt;\"5FKgZJG4gKPCHXe8OqhFVZL0bu2X9zLR3sxd4ELBulA=\", \"uploadFile\"=&gt;{\"upload\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x3b03ad8 @original_filename=\"newCases.yml\", @content_type=\"application/octet-stream\", @headers=\"Content-Disposition: form-data; name=\\\"uploadFile[upload]\\\"; filename=\\\"newCases.yml\\\"\\r\\nContent-Type: application/octet-stream\\r\\n\", @tempfile=#&lt;File:C:/Users/Simo/AppData/Local/Temp/RackMultipart20121108-2664-tb7lxr&gt;&gt;}, \"commit\"=&gt;\"Upload\"}\n  [1m[35mSetting Load (0.0ms)[0m  SELECT \"settings\".* FROM \"settings\" WHERE \"settings\".\"id\" = ? LIMIT 1  [[\"id\", 1]]\n  Rendered upload/uploadfile.html.erb within layouts/upload (0.0ms)\nCompleted 200 OK in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms)\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13293917,"title":"how to set value for checkbox in ruby on rails?","body":"<p>I am a newbie, I want to know how to set the value for the check_box from '1' to 'Yes' and '0' to 'NO' in front end of ruby on rails?</p>\n\n<pre><code>  &lt;%= f.check_box :RDSAP_Answer, id: \"enr_rds_surv_rdsap_xref_answer_check\" %&gt;\n</code></pre>\n\n<p>Now, in the browser, If I check the box it's store the value '1' to the database and if unchecked it's store the null value in the database. </p>\n\n<p>I want to store <code>Yes for checked</code> and <code>No for unchecked</code> in the database. Is it possible to do in RoR? or is it easiest in JavaScript? What is the easiest way to set the value. Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","thin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13280466,"title":"Stuck on \"Using Rails Adapter\" when starting script with thin","body":"<p>I'm running <code>bundle exec thin -p 4000 -e sandbox start 2&gt;&amp;1</code> and I get:</p>\n\n<p><code>&gt;&gt; Using rails adapter</code></p>\n\n<p>It just hangs there and I don't think that my Rails adapter is running. Does <code>thin</code> have a log or something I can see to find out what's going on?</p>\n"},{"tags":["ruby-on-rails","postgresql","mongodb","solr","datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13248555,"title":"Errno::ECONNREFUSED No connection could be made because the target machine actively refused it. - connect(2) in Rails app doing a Mongodb search","body":"<p>I am trying to setup my Rails app on a windows machine I am trying to test it. However when I try to do a search that uses Mongo and Solr I get this error:</p>\n\n<pre><code>Errno::ECONNREFUSED (No connection could be made because the target machine actively refused it. - connect(2)):\n  app/controllers/centers_controller.rb:384:in `center_search'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core.rb:263:in `block in repository'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core/repository.rb:114:in `scope'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core.rb:263:in `repository'\n\n\n  Rendered ruby-postgres/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/templates/rescues/_trace.erb (0.0ms)\n  Rendered ruby-postgres/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (15.6ms)\n  Rendered ruby-postgres/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (234.0ms)\n</code></pre>\n\n<p>These are the commands I have to run the app:</p>\n\n<pre><code>mongod\nrails s\nredis-server.exe\nrake sunspot:solr:run\n</code></pre>\n\n<p>The error occurs when I call the method solr_search.</p>\n\n<p>This is the output in the command prompt by starting solr:</p>\n\n<pre><code>Java HotSpot(TM) Client VM (build 23.5-b02, mixed mode, sharing)\n2012-11-06 11:43:21.446:INFO::Logging to STDERR via org.mortbay.log.StdErrLog\n2012-11-06 11:43:21.552:INFO::jetty-6.1-SNAPSHOT\n2012-11-06 11:43:21.763:INFO::Extract file:/C:/Users/Ger/Documents/web_dev/connectedtrips/ruby-postgres/ruby/1.9.1/bundler/g\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: JNDI not configured for solr (NoInitialContextEx)\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: solr home defaulted to 'solr/' (could not find system property or JNDI)\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader &lt;init&gt;\nINFO: Solr home set to 'solr/'\nNov 06, 2012 11:43:22 AM org.apache.solr.servlet.SolrDispatchFilter init\nINFO: SolrDispatchFilter.init()\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: JNDI not configured for solr (NoInitialContextEx)\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: solr home defaulted to 'solr/' (could not find system property or JNDI)\nNov 06, 2012 11:43:22 AM org.apache.solr.core.CoreContainer$Initializer initialize\nINFO: looking for solr.xml: C:\\Users\\Ger\\Documents\\web_dev\\connectedtrips\\ruby-postgres\\ruby\\1.9.1\\bundler\\gems\\sunspot-f8d9\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: JNDI not configured for solr (NoInitialContextEx)\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: solr home defaulted to 'solr/' (could not find system property or JNDI)\nNov 06, 2012 11:43:22 AM org.apache.solr.core.CoreContainer &lt;init&gt;\nINFO: New CoreContainer: solrHome=solr/ instance=26947014\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader &lt;init&gt;\nINFO: Solr home set to 'solr/'\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrResourceLoader &lt;init&gt;\nINFO: Solr home set to 'solr\\.\\'\nNov 06, 2012 11:43:22 AM org.apache.solr.core.SolrConfig initLibs\nINFO: Adding specified lib dirs to ClassLoader\nNov 06, 2012 11:43:22 AM org.apache.solr.core.Config getLuceneVersion\nWARNING: the luceneMatchVersion is not specified, defaulting to LUCENE_24 emulation. You should at some point declare and re\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrConfig &lt;init&gt;\nINFO: Using Lucene MatchVersion: LUCENE_24\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrConfig &lt;init&gt;\nWARNING: Deprecated syntax found. &lt;highlighting/&gt; should move to &lt;searchComponent/&gt;\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrConfig &lt;init&gt;\nINFO: Loaded SolrConfig: solrconfig.xml\nNov 06, 2012 11:43:23 AM org.apache.solr.schema.IndexSchema readSchema\nINFO: Reading Solr Schema\nNov 06, 2012 11:43:23 AM org.apache.solr.schema.IndexSchema readSchema\nINFO: Schema name=sunspot\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created string: org.apache.solr.schema.StrField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created tdouble: org.apache.solr.schema.TrieDoubleField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created rand: org.apache.solr.schema.RandomSortField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created : org.apache.solr.analysis.StandardTokenizerFactory\nNov 06, 2012 11:43:23 AM org.apache.solr.analysis.BaseTokenStreamFactory assureMatchVersion\nWARNING: StandardTokenizerFactory is using deprecated LUCENE_24 emulation. You should at some point declare and reindex to a\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created : org.apache.solr.analysis.StandardFilterFactory\nNov 06, 2012 11:43:23 AM org.apache.solr.analysis.BaseTokenStreamFactory assureMatchVersion\nWARNING: StandardFilterFactory is using deprecated LUCENE_24 emulation. You should at some point declare and reindex to at l\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created : org.apache.solr.analysis.LowerCaseFilterFactory\nNov 06, 2012 11:43:23 AM org.apache.solr.analysis.BaseTokenStreamFactory assureMatchVersion\nWARNING: LowerCaseFilterFactory is using deprecated LUCENE_24 emulation. You should at some point declare and reindex to at\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created text: org.apache.solr.schema.TextField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created boolean: org.apache.solr.schema.BoolField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created date: org.apache.solr.schema.DateField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created sdouble: org.apache.solr.schema.SortableDoubleField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created sfloat: org.apache.solr.schema.SortableFloatField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created sint: org.apache.solr.schema.SortableIntField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created slong: org.apache.solr.schema.SortableLongField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created tint: org.apache.solr.schema.TrieIntField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created tfloat: org.apache.solr.schema.TrieFloatField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created tdate: org.apache.solr.schema.TrieDateField\nNov 06, 2012 11:43:23 AM org.apache.solr.util.plugin.AbstractPluginLoader load\nINFO: created location: org.apache.solr.schema.LatLonType\nNov 06, 2012 11:43:23 AM org.apache.solr.schema.IndexSchema readSchema\nINFO: default search field is text\nNov 06, 2012 11:43:23 AM org.apache.solr.schema.IndexSchema readSchema\nINFO: query parser default operator is AND\nNov 06, 2012 11:43:23 AM org.apache.solr.schema.IndexSchema readSchema\nINFO: unique key field: id\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrCore &lt;init&gt;\nINFO: [] Opening new SolrCore at solr\\.\\, dataDir=./solr/data\\\nNov 06, 2012 11:43:23 AM org.apache.solr.core.JmxMonitoredMap &lt;init&gt;\nINFO: No JMX servers found, not exposing Solr information with JMX.\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrCore initListeners\nINFO: [] Added SolrEventListener for newSearcher: org.apache.solr.core.QuerySenderListener{queries=[]}\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrCore initListeners\nINFO: [] Added SolrEventListener for firstSearcher: org.apache.solr.core.QuerySenderListener{queries=[{q=solr rocks,start=0,\nNov 06, 2012 11:43:23 AM org.apache.solr.request.XSLTResponseWriter &lt;init&gt;\nWARNING: org.apache.solr.request.XSLTResponseWriter is deprecated. Please use the corresponding class in org.apache.solr.res\nNov 06, 2012 11:43:23 AM org.apache.solr.response.XSLTResponseWriter init\nINFO: xsltCacheLifetimeSeconds=5\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created standard: solr.SearchHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created dismax: solr.SearchHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created partitioned: solr.SearchHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /spell: solr.SearchHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created tvrh: org.apache.solr.handler.component.SearchHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: adding lazy requestHandler: org.apache.solr.handler.extraction.ExtractingRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /update/extract: org.apache.solr.handler.extraction.ExtractingRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /terms: org.apache.solr.handler.component.SearchHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: adding lazy requestHandler: solr.SearchHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /elevate: solr.SearchHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /update: solr.XmlUpdateRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /update/javabin: solr.BinaryUpdateRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /analysis/document: solr.DocumentAnalysisRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /analysis/field: solr.FieldAnalysisRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: adding lazy requestHandler: solr.CSVRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /update/csv: solr.CSVRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /admin/: org.apache.solr.handler.admin.AdminHandlers\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /admin/ping: PingRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /debug/dump: solr.DumpRequestHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig\nINFO: created /mlt: solr.MoreLikeThisHandler\nNov 06, 2012 11:43:23 AM org.apache.solr.search.SolrIndexSearcher &lt;init&gt;\nINFO: Opening Searcher@11a1bb4 main\nNov 06, 2012 11:43:23 AM org.apache.solr.update.CommitTracker &lt;init&gt;\nINFO: commitTracker AutoCommit: disabled\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SpellCheckComponent inform\nINFO: Initializing spell checkers\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SpellCheckComponent inform\nWARNING: No queryConverter defined, using default converter\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.QueryElevationComponent inform\nINFO: Loading QueryElevation from: C:\\Users\\Ger\\Documents\\web_dev\\connectedtrips\\ruby-postgres\\ruby\\1.9.1\\bundler\\gems\\sunsp\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.QueryComponent@51d871\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.FacetComponent@158e4ee\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.MoreLikeThisComponent@11dd242\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.HighlightComponent@d6f8f6\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.StatsComponent@17300c2\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  debug component:org.apache.solr.handler.component.DebugComponent@136d8e4\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.QueryComponent@51d871\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.FacetComponent@158e4ee\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.MoreLikeThisComponent@11dd242\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.HighlightComponent@d6f8f6\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.StatsComponent@17300c2\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  debug component:org.apache.solr.handler.component.DebugComponent@136d8e4\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.QueryComponent@51d871\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.FacetComponent@158e4ee\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.MoreLikeThisComponent@11dd242\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.HighlightComponent@d6f8f6\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.StatsComponent@17300c2\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  debug component:org.apache.solr.handler.component.DebugComponent@136d8e4\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.QueryComponent@51d871\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.FacetComponent@158e4ee\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.MoreLikeThisComponent@11dd242\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.HighlightComponent@d6f8f6\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.StatsComponent@17300c2\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.SpellCheckComponent@1d974d9\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  debug component:org.apache.solr.handler.component.DebugComponent@136d8e4\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.QueryComponent@51d871\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.FacetComponent@158e4ee\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.MoreLikeThisComponent@11dd242\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.HighlightComponent@d6f8f6\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.StatsComponent@17300c2\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.TermVectorComponent@1865381\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  debug component:org.apache.solr.handler.component.DebugComponent@136d8e4\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SearchHandler inform\nINFO: Adding  component:org.apache.solr.handler.component.TermsComponent@1d4714d\nNov 06, 2012 11:43:23 AM org.apache.solr.core.QuerySenderListener newSearcher\nINFO: QuerySenderListener sending requests to Searcher@11a1bb4 main\nNov 06, 2012 11:43:23 AM org.apache.solr.core.CoreContainer register\nINFO: registering core:\nNov 06, 2012 11:43:23 AM org.apache.solr.servlet.SolrDispatchFilter init\nINFO: user.dir=C:\\Users\\Ger\\Documents\\web_dev\\connectedtrips\\ruby-postgres\\ruby\\1.9.1\\bundler\\gems\\sunspot-f8d901958835\\suns\nNov 06, 2012 11:43:23 AM org.apache.solr.servlet.SolrDispatchFilter init\nINFO: SolrDispatchFilter.init() done\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrCore execute\nINFO: [] webapp=null path=null params={start=0&amp;event=firstSearcher&amp;q=solr+rocks&amp;rows=10} hits=0 status=0 QTime=46\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrCore execute\nINFO: [] webapp=null path=null params={event=firstSearcher&amp;q=static+firstSearcher+warming+query+from+solrconfig.xml} hits=0\nNov 06, 2012 11:43:23 AM org.apache.solr.core.QuerySenderListener newSearcher\nINFO: QuerySenderListener done.\nNov 06, 2012 11:43:23 AM org.apache.solr.handler.component.SpellCheckComponent$SpellCheckerListener newSearcher\nINFO: Loading spell index for spellchecker: default\nNov 06, 2012 11:43:23 AM org.apache.solr.servlet.SolrServlet init\nINFO: SolrServlet.init()\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: JNDI not configured for solr (NoInitialContextEx)\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: solr home defaulted to 'solr/' (could not find system property or JNDI)\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrCore registerSearcher\nINFO: [] Registered new searcher Searcher@11a1bb4 main\nNov 06, 2012 11:43:23 AM org.apache.solr.servlet.SolrServlet init\nINFO: SolrServlet.init() done\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: JNDI not configured for solr (NoInitialContextEx)\nNov 06, 2012 11:43:23 AM org.apache.solr.core.SolrResourceLoader locateSolrHome\nINFO: solr home defaulted to 'solr/' (could not find system property or JNDI)\nNov 06, 2012 11:43:23 AM org.apache.solr.servlet.SolrUpdateServlet init\nINFO: SolrUpdateServlet.init() done\n2012-11-06 11:43:23.930:INFO::Started SocketConnector@0.0.0.0:8983\n</code></pre>\n\n<p>I am not quite sure what is going wrong here. I am sure I have setup my application correctly. Can anyone explain to me what is going wrong here and possibly help me? Thanks</p>\n\n<p>Edit: This might not be a specific error to Windows. Happening on my Mac now, error occurs when one of my mailers tries to send a mail. I'm using resque and redis to run background jobs.</p>\n"},{"tags":["ruby-on-rails","ruby","rake"],"answer_count":3,"favorite_count":10,"up_vote_count":27,"down_vote_count":0,"view_count":8471,"score":27,"question_id":3951514,"title":"Why is rake db:migrate:reset not listed in rake -T?","body":"<p>Why are some rake tasks not listed by <code>rake -T</code>? Like <code>db:migrate:reset</code>? I can execute it without a problem, but why is it not listed there? Is there a way to get a real full list of rake tasks?</p>\n\n<pre>\n% rake -T\n(in /home/zeus/projects/my_project)\nrake about              # List versions of all Rails frameworks and the environment\nrake db:create          # Create the database from config/database.yml for the current Rails.env (use db:create:all to create all dbs in the config)\nrake db:drop            # Drops the database for the current Rails.env (use db:drop:all to drop all databases)\nrake db:fixtures:load   # Load fixtures into the current environment's database.\nrake db:migrate         # Migrate the database (options: VERSION=x, VERBOSE=false).\nrake db:migrate:status  # Display status of migrations\nrake db:rollback        # Rolls the schema back to the previous version (specify steps w/ STEP=n).\nrake db:schema:dump     # Create a db/schema.rb file that can be portably used against any DB supported by AR\nrake db:schema:load     # Load a schema.rb file into the database\nrake db:seed            # Load the seed data from db/seeds.rb\nrake db:setup           # Create the database, load the schema, and initialize with the seed data (use db:reset to also drop the db first)\nrake db:structure:dump  # Dump the database structure to an SQL file\nrake db:version         # Retrieves the current schema version number\nrake doc:app            # Generate docs for the app -- also availble doc:rails, doc:guides, doc:plugins (options: TEMPLATE=/rdoc-template.rb, TITLE=\"Custom Title\")\nrake erd                # Generate an Entity-Relationship Diagram based on your models\nrake log:clear          # Truncates all *.log files in log/ to zero bytes\nrake middleware         # Prints out your Rack middleware stack\nrake notes              # Enumerate all annotations (use notes:optimize, :fixme, :todo for focus)\nrake notes:custom       # Enumerate a custom annotation, specify with ANNOTATION=CUSTOM\nrake rails:template     # Applies the template supplied by LOCATION=/path/to/template\nrake rails:update       # Update both configs and public/javascripts from Rails (or use just update:javascripts or update:configs)\nrake routes             # Print out all defined routes in match order, with names.\nrake secret             # Generate a crytographically secure secret key (this is typically used to generate a secret for cookie sessions).\nrake spec               # Run all specs in spec directory (excluding plugin specs)\nrake spec:acceptance    # Run the code examples in spec/acceptance\nrake spec:controllers   # Run the code examples in spec/controllers\nrake spec:helpers       # Run the code examples in spec/helpers\nrake spec:lib           # Run the code examples in spec/lib\nrake spec:mailers       # Run the code examples in spec/mailers\nrake spec:models        # Run the code examples in spec/models\nrake spec:rcov          # Run all specs with rcov\nrake spec:requests      # Run the code examples in spec/requests\nrake spec:routing       # Run the code examples in spec/routing\nrake spec:views         # Run the code examples in spec/views\nrake stats              # Report code statistics (KLOCs, etc) from the application\nrake test               # Runs test:units, test:functionals, test:integration together (also available: test:benchmark, test:profile, test:plugins)\nrake test:recent        # Run tests for recenttest:prepare / Test recent changes\nrake test:uncommitted   # Run tests for uncommittedtest:prepare / Test changes since last checkin (only Subversion and Git)\nrake time:zones:all     # Displays all time zones, also available: time:zones:us, time:zones:local -- filter with OFFSET parameter, e.g., OFFSET=-6\nrake tmp:clear          # Clear session, cache, and socket files from tmp/ (narrow w/ tmp:sessions:clear, tmp:cache:clear, tmp:sockets:clear)\nrake tmp:create         # Creates tmp directories for sessions, cache, sockets, and pids\n</pre>\n"},{"tags":["ruby-on-rails","rspec","controller"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13293996,"title":"Controller specs: check content of JavaScript delivered by the server after an AJAX request","body":"<p>I have a method <code>EmailConnectionController#show</code>; this renders <code>show.js.haml</code>, which has the following content:</p>\n\n<pre><code>$(\"#email_account_#{@email_account._id} .test_email_connection_response\").html('#{@test_response}');\n</code></pre>\n\n<p>I test it the following way:</p>\n\n<pre><code>xhr :get, :show, id: email_account\nresponse.should be_success\n</code></pre>\n\n<p>This works nicely, but the problem is, that depending on the given <code>email_account</code>, the generated javascript looks a bit different, while the response is always the same. Now I don't know how to add some specs about the generated javascript.</p>\n\n<p>The <code>@test_response</code> variable in the javascript can have a value, let's say \"Connection refused\", which is rendered in a container <code>.test_email_connection_response</code> by jQuery. I have looked into the <code>response</code> object in the test, and somewhere deeply nested, I found exactly this variable which holds the expected value, so I'd like to check on that value. But sadly I don't know how to find it.</p>\n\n<p>Another solution would be to check the generated javascript code itself:</p>\n\n<pre><code>generated_javascript.should have_content(\"Connection refused\")\n</code></pre>\n\n<p>But I don't find this generated javascript.</p>\n\n<p>Thanks a lot for help!</p>\n"},{"tags":["ruby-on-rails","routes","views"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13293929,"title":"Updating a bunch of records with one form","body":"<p>I have a series of records of the same model that I want to update all at once with a single form. I am getting Routing errors despite trying several scenarios. The app is a survey taking tool. data model is as follows</p>\n\n<pre><code>#Program\n  has_many :participants\n  has_many :questions\n  has_many :rounds\n  has_many :values\n\n#Values\n   belongs_to :program\n   belongs_to :round\n   belongs_to :question\n   belongs_to :participant\n</code></pre>\n\n<p>So a values record has three 'coordinates', what round, what question and what participant, and it has a field called \"value\" and \"datatype\". </p>\n\n<p>The view below is a survey, part of a program, presented to a single participant during a single round of surveying. It will display a series of form fields where this person will answer each question for this round. It is called with an instance variable @values which contains the correct collection of values objects where the answers should be stored.</p>\n\n<p>survey.html.erb:</p>\n\n<pre><code>&lt;%= content_tag :table do %&gt;\n  &lt;%= content_tag :thead do %&gt;\n    &lt;% 5.times do |q| %&gt;\n      &lt;%= content_tag :th, \"1\" %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n  &lt;% form_tag program_participant_round_survey_path(\n      program_id: @program.id, participant_id: @participant.id, round_id: @current_round.id), \n      method =&gt; :put do %&gt;\n    &lt;%= content_tag :tbody do %&gt;\n      &lt;%= render partial: 'surveys/value', collection: @values  %&gt;\n    &lt;% end %&gt;\n    &lt;%= submit_tag \"Save\" %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>surveys_controller.rb:</p>\n\n<pre><code>  def survey\n    @program = Program.find(params[:program_id])\n    @participant = Participant.find(params[:participant_id])\n    @current_round =  @program.rounds.where(open: true)\n\n    raise \"More than one open round\" unless @current_round.size == 1\n    @current_round = @current_round[0]\n\n    @values = Value.find_or_create_round(@program, @participant, @current_round)\n\n    respond_with @values do |format|\n      format.html {\n        render layout: 'layouts/progtabs'\n      }\n    end\n  end\n</code></pre>\n\n<p>What I would like is that the PUT url for storing the new responses to the survey looks like this: ./program/1/participant/2/round/3/survey. I am still trying to sort out the right routes.rb. Here's what I have so far:</p>\n\n<p>routes.rb:</p>\n\n<pre><code>  root to: 'programs#index'\n  resources :programs do\n    resources :participants do\n      resources :rounds do\n        put 'survey' =&gt; 'surveys#survey'\n      end\n    end\n    resources :questions\n    resources :rounds\n    member do\n      get 'report' =&gt; 'reports#report'\n    end\n  end\n</code></pre>\n\n<p>When I refresh the page I get </p>\n\n<pre><code>ActionController::RoutingError (No route matches [GET] \"/programs/1/participants/2/survey\"):\n</code></pre>\n\n<p>Am I going about this the right way? Any help and pointers would be appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby","mongoid","mongoid3","custom-field-type"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13293877,"title":"Custom fields with mongoid","body":"<p>I started to use the <a href=\"http://mongoid.org/en/mongoid/index.html\" rel=\"nofollow\">mongoid</a> gem in my project, and I'm a little confused about how it store and get the information on the database. I have fields of specifics types in my models, but when I get it from the DB it returns a Hash.\nHere is my models:</p>\n\n<p>service.rb</p>\n\n<pre><code>class Service\n  include Mongoid::Document\n  field :username, type: String\n  field :strategy, type: Strategy\n  field :design, type: Design\n\nend\n</code></pre>\n\n<p>strategy.rb</p>\n\n<pre><code>class Strategy \n  include Mongoid::Document\n\n  field :name, type: String\n  field :description, type:  String\n  field :resources, type:  Resources\n  field :scalability, type:  Scalability  \n  field :localization, type:  Localization\n  field :contact, type:  Contact\n\nend\n</code></pre>\n\n<p>If I initialize a new service @service, and do @service.class it returns Service, the right one, but if I try do @service.strategy.class, it returns Hash, and not Strategy, like I was expecting. I read on the <a href=\"http://mongoid.org/en/mongoid/docs/documents.html#fields\" rel=\"nofollow\">mongoid manual</a> there are the \"Custom field serialization\", what I think allows me to do what I want. But I was wondering if there are not any other way to do that easily, because I have lots of models to change.</p>\n"},{"tags":["ruby-on-rails","ruby","sqlite","drop-down-menu","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":348,"score":2,"question_id":9579402,"title":"Active Admin - refresh second drop down based on first drop down, Ruby on Rails","body":"<p>I am using Active Admin Gem on Ruby on Rails. I have a form in which i have selected category and sub category and then accordingly i have to fill the data. So i created two tables in sqlite added in active admin resouce.</p>\n\n<p>Every thing is working fine but the drop down of sub category is not getting filtered based on the category choosen.</p>\n\n<p>I am new to Ruby and RoR too. I don't know how to refresh dropdown of the subcategory after selecting category.</p>\n\n<p>I know i can do it from AJAX and javascript but i dont know where to code for that?</p>\n\n<p>Also, is there any specific filter avaliable in Active Admin which will make it happen without ajax or javascript.</p>\n\n<p>Any ideas or help will be highly appreciated.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":11628291,"title":"rails carmen country_select helper without a form object","body":"<p>my form is not tied to a particular model and looks like this:</p>\n\n<pre><code>&lt;%= form_tag(:controller =&gt; 'orders' , :action =&gt; 'process_credit_card') do  %&gt;\n    ... bunch of fields ...\n&lt;% end %&gt;\n</code></pre>\n\n<p><a href=\"https://github.com/jim/carmen-rails\" rel=\"nofollow\">carmen-rails</a>' <code>country_select</code> helper looks like this</p>\n\n<pre><code> &lt;%= f.country_select :country_code, {priority: %w(US CA)}, prompt: 'Please select a country' %&gt;\n</code></pre>\n\n<p>however I do not have a form object <code>f</code>, I use helpers like <code>&lt;%= text_field_tag 'billing_address[phone]' %&gt;</code> to create my form, is there a way I can still use carmen in this form?</p>\n\n<p>UPDATE: I am using ActiveMerchant for payment processing, I can create a form with <code>form_for</code> instead of <code>form_tag</code> but I don't know how, any pointers will be appreciated. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13243229,"title":"Why is fields_for creating 2 identical records instead of just 1 upon form submit?","body":"<p>When I submit this form, it is creating 2 identical records in the Members table (the fields_for part of the form).  Please help me understand why that is happening.   </p>\n\n<p>The basic setup is: a Comp has many Teams and a Team has many Members.  When creating a new Team, the first Member created should be the team's secretary (which means the secretary_flag field in the Members table should be set to TRUE.)  This form below is supposed to create a new Team, create the first team member, and mark that team member as the secretary.       </p>\n\n<p>The controller: </p>\n\n<pre><code>def new\n  @comp = Comp.find(params[:comp_id])    \n  @team = @comp.teams.new\n  @team.members.build  \nend\n\ndef create\n  @comp = Comp.find(params[:comp_id])\n  @team = @comp.teams.create(params[:team])\n  if @team.update_attributes(params[:team])\n      flash[:success] = \"Team added successfully.\"\n      redirect_to new_comp_team_member_path(@comp,@team)\n  else\n      render 'new' \n  end\nend\n</code></pre>\n\n<p>The form view:</p>\n\n<pre><code>&lt;%= form_for [@comp,@team] do |builder| %&gt;\n    &lt;%= builder.label :team_name, \"Team name\" %&gt;\n    &lt;%= builder.text_field :team_name %&gt;        \n    &lt;%= builder.fields_for :members do |f| %&gt;\n        &lt;%= f.label :member_email, \"Email address of team secretary\" %&gt;\n        &lt;%= f.text_field :member_email %&gt; \n        &lt;%= f.hidden_field :secretary_flag, :value =&gt; 1 %&gt;\n    &lt;% end %&gt;\n\n&lt;%= builder.submit \"Create new team\" %&gt; \n\n&lt;% end %&gt; \n</code></pre>\n\n<p>And in my routes: </p>\n\n<pre><code>resources :comps do\n    resources :teams do \n        resources :members\n    end \nend\n</code></pre>\n\n<p>And in my models: </p>\n\n<p>comp.rb: </p>\n\n<pre><code>attr_accessible :teams_attributes\nhas_many :teams, :dependent =&gt; :destroy\naccepts_nested_attributes_for :teams, :allow_destroy =&gt; :true\n</code></pre>\n\n<p>team.rb:</p>\n\n<pre><code>attr_accessible :members_attributes\nbelongs_to :comp\nhas_many :members\naccepts_nested_attributes_for :members\n</code></pre>\n\n<p>member.rb:</p>\n\n<pre><code> belongs_to :team\n</code></pre>\n"},{"tags":["ruby-on-rails","encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":240,"score":0,"question_id":9790514,"title":"How to set #encoding: utf-8 in Rails globally","body":"<p>now i'm using <code># encoding: utf-8</code> in every controller, where :notice message is not in <em>latin</em>\ni've tried to put it in ApplicationController, tried to add <code>&lt;meta charset=\"utf-8\"&gt;</code> at the top of application.html.erb, none worked, any help ?</p>\n\n<p><strong>EDIT:</strong>\nconfig.encoding = \"utf-8\" also set in <strong>application.rb</strong></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>error appears with this code:</p>\n\n<pre><code>redirect_to root_url, :notice =&gt; \"Вышли успешно\"\n</code></pre>\n\n<p>and here's an error</p>\n\n<pre><code>:syntax error, unexpected $end, expecting '}' ..._or_to root_url, :notice =&gt; 'Вышли успешно.' }\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-routing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13293241,"title":"Rails controller and routes configuration for website","body":"<p>I have an application in RAILS, it is composed of a set of API, a basic website, and an admin dashboard. \nFor the API routing I have no problems, as they belong to a model and a controller and are compliant with the RAILS RESTful pattern (a controller for each model, and a method for each HTTP method). </p>\n\n<p>What I'm not comfortable with is writing routes and controllers for website. \nThe main website is at / so the default route is <code>root :to =&gt; \"home#index\"</code>and I have\nRoutes for the website pages which look like </p>\n\n<pre><code> get \"home/index\"\n  get \"map/index\"\n  get \"api/index\"\n  get \"cgu/index\"\n  get \"legal/index\"\n</code></pre>\n\n<p>Which I think it is not good, as I have a controller per view and I need to define a get for each views. \nNow for the dashboard I tried a different approach. \nIt is at /dashboard, the default route is   <code>match \"dashboard\" =&gt; \"dashboard#index\"</code> and here is few pages as an examples</p>\n\n<pre><code> get \"dashboard/index\"\n  get \"dashboard/users\"\n  get \"dashboard/users_stats\"\n  get \"dashboard/routes\"\n  get \"dashboard/routes_stats\"\n  get \"dashboard/charts\"\n  get \"dashboard/financial\"\n</code></pre>\n\n<p>So for the dashboard I have a massive dashboard_controller, which contains a <code>def method</code> for each dashboard pages. IE: </p>\n\n<pre><code>#dashboard/users\n  def users\n     @users = User.all\n\n     respond_to do |format|\n      format.html {render :layout =&gt; 'dashboard'}\n    end\n  end\n</code></pre>\n\n<p>the controller of the dashboard is at /controller but for views and assets I have put it in /folder/dashboard/ </p>\n\n<p>Here is 2 questions: </p>\n\n<ul>\n<li>What is the best way to build the home website and dashboard ? Should I have a controller per page or a global controller where I have a method per pages ? (Which I find very convenient, less code). </li>\n<li>How should I organize my routes to avoid to set a get \"something/something\" for each page ? \nOr it is normal with RAILS that I have a route defined for each of my page ? I'm fairly new. </li>\n</ul>\n\n<p>EDIT: \nTo clarify, the dashboard is built around an existing application with API that follow RESTFul Rails pattern:</p>\n\n<pre><code>  resources :users\n  resources :routes\n</code></pre>\n\n<p>But the dashboard is not tied to any existing resources, it only do stats about those resources. </p>\n"},{"tags":["ruby-on-rails","utf-8","ruby-1.9"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13293669,"title":"internal server error (500) in development mode, no debug page or log output in rails: utf-8","body":"<p>rails app in development mode gives internal server error and not the usual error page with trace. no info in <code>log/development.log</code> either. no matter what server. on any request.</p>\n\n<p>What is wrong?</p>\n"},{"tags":["ruby-on-rails","git","continuous-integration","heroku","continuous-deployment"],"answer_count":4,"favorite_count":6,"up_vote_count":9,"down_vote_count":0,"view_count":2155,"score":9,"question_id":3127194,"title":"Proper continuous integration and continuous deployment with Git and Heroku","body":"<p>I am developing a ruby on rails website using heroku and git.</p>\n\n<p>What tools and features should I use to set up the following simple development process?</p>\n\n<p>CODE > CHECK-IN > AUTO TEST > AUTO DEPLOY</p>\n\n<ul>\n<li>I check my code into my repository (preferred option, hosted git like github)</li>\n<li>Tests are automatically run AND website is deployed in my staging heroku app</li>\n<li>If tests pass, the website is automatically deployed on my production heroku app</li>\n<li>If tests fail, I want to be notified somehow.</li>\n</ul>\n\n<p>How would you do this?</p>\n"},{"tags":["mysql","ruby-on-rails","join","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13292535,"title":"Find all without association through association","body":"<pre><code>class Campaign &lt; ActiveRecord::Base\n  has_many :posts\n  has_many :users\nend\n\nclass Post &lt; ActiveRecord::Base\n  has_and_belongs_to_many :users\n  belongs_to :campaign\nend\n\nclass User &lt; ActiveRecord::Base\n  has_and_belongs_to_many :posts, :join_table =&gt; \"users_posts\"\n  belongs_to :campaign\nend\n</code></pre>\n\n<p>If user saw this post I add him to post.users. I need find first unwatched post of user campaign. Smth like this:</p>\n\n<pre><code>current_user.campaign.posts.where('posts.users not include current_user')\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","facebook","facebook-graph-api","koala"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13285889,"title":"koala response times. 20 seconds waiting response","body":"<p>I'm new with <code>Rubyonrails</code> and <code>Koala gem</code> and I'm sure I'm doing something wrong. I've been tuning my code to the minimun expression but the problem persist. Then I tried to do the same without koala gem, but the problem persisted.</p>\n\n<p>This is the code:</p>\n\n<pre><code>require 'koala'\nrequire 'open-uri'\n\n\nputs Time.now\n\n@graph = Koala::Facebook::API.new\nresp = @graph.graph_call(\"cocacola\", {}, \"get\", {})\nputs resp\n\nputs Time.now\n\ncoke_url = \"https://graph.facebook.com/cocacola\"\nresponse = open coke_url\nresponse = JSON.parse response.read\nputs response.inspect\n\nputs Time.now\n</code></pre>\n\n<p>I have to wait always 21 seconds the Facebook's response. If I put the <a href=\"https://graph.facebook.com/cocacola\" rel=\"nofollow\">https://graph.facebook.com/cocacola</a> on my browser, the response is instantaneous ¿is not the same?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13289522,"title":"How to customize devise such that validation is done only at specified condition?","body":"<p>I have devise for authentication and i have not used validatable and i send the request and along to it i send a type. for example</p>\n\n<pre><code>http://localhost:3000/signup/new?type=twitter \n</code></pre>\n\n<p>in the above shown i have used <code>type=twitter</code>and in case it is twitter i do not want to validate email i.e., do not need <code>validates_presence_of :email</code> but in case i send type=email then i want to check presence of mail and whether mail has not already taken and check mail specified is valid or not? How can i do this? Please help me.</p>\n"},{"tags":["ruby-on-rails","devise","resque"],"answer_count":4,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":1456,"score":15,"question_id":7283728,"title":"Resque, Devise and admin authentication","body":"<p>Using Resque and Devise, i have roles for User, like:</p>\n\n<pre><code>User.first.role #=&gt; admin\nUser.last.role #=&gt; regular\n</code></pre>\n\n<p>I want to setup an authentication for Resque. So, inside config/routes.rb i have:</p>\n\n<pre><code>namespace :admin do\n  mount Resque::Server.new, :at =&gt; \"/resque\", :as =&gt; :resque\nend\n</code></pre>\n\n<p>And, of course it's accessible for all logged in users.</p>\n\n<p>Is there any way to use a role from User.role? It should be accessible only by users with 'admin' role.</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12909221,"title":"Conditional chaining with ActiveRecord","body":"<p>I've tried to implement conditional chaining and this is what I got:</p>\n\n<p>Controller index action code:</p>\n\n<pre><code>@range_start = params[:range_start]\n@range_stop = params[:range_stop]\nContract.within_range(@range_start, @range_stop)\n</code></pre>\n\n<p>Model code:</p>\n\n<pre><code>def self.within_range(range_start = Date.today - 1.month, range_stop = nil)\n  self.started_after(range_start).started_before(range_stop)\nend\n\ndef self.started_after(range_start)\n  if range_start.blank?\n    self\n  else\n    self.where('start_date &gt;=?', range_start)\n  end\nend\n\ndef self.started_before(range_stop)\n  if range_stop.blank?\n    self\n  else\n    self.where('start_date&lt;=?', range_stop)\n  end\nend\n</code></pre>\n\n<p>It works, but does not looks good. I tried to improve it a bit using <code>tap</code>, without success. How this code can be improved?</p>\n\n<p>UPDATE: In can be converted to inline conditional, but maybe something else can be improved?</p>\n\n<pre><code>range_start.blank? ? self : self.where('start_date &gt;=?', range_start)\n</code></pre>\n\n<p>UPDATE2: If <code>range_stop</code> is not set, this code is not really works, <code>started_after</code> condition does not apply.</p>\n\n<p>What I have to return from <code>started_before</code> to do not loose first condition?</p>\n"},{"tags":["ruby-on-rails","ruby","progress-bar","paperclip"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13293314,"title":"Get next interpolation from Paperclip","body":"<p>I'm currently in trouble with <strong>Paperclip</strong>. I'm using it to send large File to <strong>S3</strong>. </p>\n\n<p>I would like to set a <strong>progressbar</strong> for my upload, so i plan to use the <strong>jQuery File Upload</strong> Plugin</p>\n\n<p>I saw a tutorial using it : <a href=\"http://stackoverflow.com/questions/7883118/rails-3-1-paperclip-jquery-fileupload\">Rails 3.1 + Paperclip + jQuery fileupload</a> , but for that i need the id of the next interpolation.\nPaperclip's <strong>Interpolations</strong> are ensemble of folder to let manage large number of file (http://over9000.org/rails/paperclip-with-more-than-32-000-attachments for those who are interested). </p>\n\n<p>It's <strong>interpolation</strong> and the \"<strong>id_partition</strong>\" in your path model which generate a lot of folder to save your file. </p>\n\n<p>So your folder will look like 000/000/001 -> 000/000/002 -> ... ->  000/001/001 ->  ... -> 001/001/001 -> ... </p>\n\n<p>So, i need to call a controller method to get the next valid interpolation of file, but i'm actually stuck, can't get this working. Here is the ThoughBot documentation : <a href=\"https://github.com/thoughtbot/paperclip/blob/master/lib/paperclip/interpolations.rb\" rel=\"nofollow\">https://github.com/thoughtbot/paperclip/blob/master/lib/paperclip/interpolations.rb</a> </p>\n\n<p>Dunno which method to call, and how to use it. I'm trying a lot of thing, here is my short code : </p>\n\n<pre><code>Paperclip.interpolates \"whatever\" do |u|\n  @inter = u.id_partition\nend\n</code></pre>\n\n<p>If someone have any idea on how do this, or maybe another idea for my progress bar, i'm stuck for a week now and can't get this working. \n(I'm starting with Ruby, please be indulgent ;) )</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails","ruby","serialization","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13292477,"title":"Ruby on Rails: serialize Hash incredibly slow","body":"<p>I've got a simple model called \"Search\" used for storing searches. It captures the URL params and stores them in an attribute :search_criteria, which is serialized as a Hash:</p>\n\n<pre><code>serialize :search_criteria, Hash\n</code></pre>\n\n<p>This all works perfectly, but it performs horribly. For only 5 objects, the following statements take roughly 0.2 seconds.</p>\n\n<pre><code>start = Time.now\nSavedSearch.all.map(&amp;:search_criteria)\nputs Time.now - start\n</code></pre>\n\n<p>If, however, I remove the serialize line (such that search_criteria returns a string) the statements take only 0.002 seconds. That's 2 orders of magnitude difference for deserializing a Hash!! </p>\n\n<p>What's happening here?</p>\n\n<p>Rails.version = 3.2.8\nRuby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]</p>\n"},{"tags":["ruby-on-rails","testing","selenium","rspec","selenium-chromedriver"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13282399,"title":"How to close all the windows before the next test in a test suite?","body":"<pre><code>[7] pry(#&lt;RSpec::Core::ExampleGroup::Nested_1&gt;)&gt; page.execute_script \"window.close()\"\nSelenium::WebDriver::Error::NoSuchWindowError: Script execution failed. Script: window.close();\n The window could not be found\n\n[8] pry(#&lt;RSpec::Core::ExampleGroup::Nested_1&gt;)&gt; page.driver.browser.window_handles\n=&gt; [\"f1-2\"]\n</code></pre>\n\n<p>I had a browser open with two tabs, the above command does close one but the last tab never closes. It is open but when I try to run <code>page.execute_script \"window.close()\"</code> it gives the above error.</p>\n\n<pre><code>page.driver.browser.window_handles.each do |handle|\n  page.driver.browser.switch_to.window(handle)\n  page.execute_script \"window.close()\"\nend\n</code></pre>\n\n<p>The above code  was working for me sometime back but doesnt work anymore. It gives the same error.</p>\n"},{"tags":["ruby-on-rails","postgresql","replication","multi-tenant"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13293213,"title":"Rails: multitenancy/sharding and replication/load at the same time","body":"<p>We have a multitenancy setup in rails, where we need to serve our application for individual countries, with completely different data for each. \nWe have been using <a href=\"https://github.com/tchandy/octopus\" rel=\"nofollow\">Octopus</a> for the multitenancy setup, where each of the countries that we serve, has it's own database.</p>\n\n<p>However recently i saw this <a href=\"http://railscasts.com/episodes/389-multitenancy-with-postgresql\" rel=\"nofollow\">http://railscasts.com/episodes/389-multitenancy-with-postgresql</a> and got inspired to try out that methods of having seperate schemas in Postgresql instead of separate databases. This was partly because we now are in a situation, where we need to load balance our databases (so in a sense both multitenancy/sharding and replication/load balancing). </p>\n\n<p>I decided to use the <a href=\"https://github.com/influitive/apartment\" rel=\"nofollow\">Apartment</a> gem for the sharing/multitenancy and Octopus for the replication/load balancing. However those two gems won't play nice together, since they both try to modify ActiveRecord behavior. It seems, that when Octopus is added to the application, it overwrites apartments job of sending the queries to the right schema.</p>\n\n<p>Does anyone have a good take on what/how to modify one of the gems, or an completly alternative setup? </p>\n"},{"tags":["ruby-on-rails","ruby","gem","bundler","gemfile"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13291470,"title":"How to run one database engine that is different from other developers sharing the same repo?","body":"<p>Saw <a href=\"http://stackoverflow.com/questions/4244182/how-to-customize-gemfile-per-developer\">How to customize Gemfile per developer?</a>, but it didn't really do what I want and it is old.</p>\n\n<p>Use case: I want to use Postgres and other developers are using SQLite. </p>\n\n<p>One solution is to modify my Gemfile and not commit it, but then it will be out of sync if anyone makes any changes to it. And it will get accidentally committed after a while anyway.</p>\n\n<p>Is there a clean way to remove the SQLite gem and add the Postgres gem in my environment, without affecting other developers' environments and other gems in the Gemfile?</p>\n\n<p>FWIW, these changes only affect development and test environments. Not staging or production.</p>\n\n<p>Or, perhaps it isn't necessary to change the Gemfile at all. Is it possible to install both gems and switch on the db config file? If so, how to set up a per-developer db config?</p>\n\n<p>EDIT: Changing the Gemfile is not necessary. Just install the pg gem and change database.yml config file.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","table","twitter-bootstrap","selectbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13255011,"title":"Select Box Selected Item Staying After Search","body":"<p>I currently have a table sorted by several select boxes. The select boxes work correctly and sort/filter the table, but whenever the user submits the search, the page refreshes and the select box resets. I would like the selected item to stick after a search, so for example if you select Male then hit go, after the page refreshes, Male is still selected. I currently have infinite scrolling successfully implemented, and I am using rails 3 and twitter-bootstrap for my framework if that helps any. </p>\n\n<p>Here is my code:</p>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code> &lt;form class=\"form-inline\"\n        &lt;p&gt;\n         &lt;label class=\"radio\"&gt;\n          &lt;input type=\"radio\" name=\"gender_search\" value=\"M\"&gt;M\n         &lt;/label&gt;\n        &lt;label class=\"radio\"&gt;\n          &lt;input type=\"radio\" name=\"gender_search\" value=\"F\"&gt;F\n        &lt;/label&gt;\n\n        &lt;select name=\"state_search\" class=\"span2\"&gt;\n          &lt;option value=\"\"&gt;Select a State&lt;/option&gt;\n          &lt;option&gt;----------------&lt;/option&gt;\n          &lt;option&gt;LA&lt;/option&gt;\n          &lt;option&gt;MS&lt;/option&gt;\n          &lt;option&gt;TX&lt;/option&gt;\n        &lt;/select&gt;\n        &lt;select name=\"city_search\" class=\"span2\"&gt;\n          &lt;option value=\"\"&gt;Select a City&lt;/option&gt;\n          &lt;option&gt;----------------&lt;/option&gt;\n          &lt;option&gt;Mandeville&lt;/option&gt;\n          &lt;option&gt;Covington&lt;/option&gt;\n        &lt;/select&gt;\n        &lt;button type=\"submit\" class=\"btn\"&gt;GO&lt;/button&gt;\n        &lt;/p&gt;\n      &lt;/form&gt;\n      &lt;table class=\"table table-striped table-bordered span8 table-condensed\"     \n       id=\"articles_table\" &gt;\n        &lt;thead class=\"header\"&gt;\n          &lt;tr&gt;\n            &lt;th&gt;ID&lt;/th&gt;\n            &lt;th&gt;Title&lt;/th&gt;\n            &lt;th&gt;Description&lt;/th&gt;\n            &lt;th&gt;Created_At&lt;/th&gt;\n          &lt;/tr&gt;\n        &lt;/thead&gt;\n        &lt;tbody&gt;\n          &lt;%= render @articles %&gt;\n        &lt;/tbody&gt;\n</code></pre>\n\n<p><strong>_article.html.erb</strong></p>\n\n<pre><code>&lt;tr&gt;\n      &lt;td&gt; &lt;%= article_counter +1 %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Title %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Description %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Created_At %&gt; &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p><strong>articles_controller.rb</strong></p>\n\n<pre><code>def index\n@articles = Article.state_search(params[:state_search]).gender_search(params[:gender_search]).city_search(params[:city_search]).page(params[:page]).limit(50).order('NTRP DESC', 'Last_Name ASC')\n  respond_to do |format|\n    format.html # index.html.erb\n    format.json { render json: @articles }\n    format.js\n  end\nend\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","yaml","conditional-statements"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13292801,"title":"Ruby include? with YAML array","body":"<p>I have a config YAML file with the following array:</p>\n\n<pre><code>EMAILS: ['email1@example.com', 'email2@example.com', 'email3@example.com']\n</code></pre>\n\n<p>And then I want to search inside this YAML array for a particular string, say \"email1@example.com\".</p>\n\n<p>I use the following ruby code:</p>\n\n<pre><code>if CONFIG[:EMAILS].include?(\"email1@example.com\")\n  return true\nelse\n  return false\nend\n</code></pre>\n\n<p>However, this always returns false.</p>\n\n<p>I can <code>PUTS</code> the <code>CONFIG[:EMAIL]</code> array fine.</p>\n\n<p>Can anyone suggest what I'm doing wrong.</p>\n"},{"tags":["ruby-on-rails","where"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13292818,"title":"Instant variable where method is true","body":"<p>In my controller I have an instant variable with a <code>where</code> method, its part of a filter in the Search Controller.</p>\n\n<pre><code>@items = @items.where([ 'borrowable = ?', true]) if params[:top_filter] == 'borrow'\n</code></pre>\n\n<p>The <code>borrowable = ?, true</code> bit is completely wrong. What I want is to filter the <code>@items</code> that are <strong>borrowable</strong> by using a method in the <code>Item's model</code> called <code>borrowable?</code>.</p>\n\n<p>How do I do this?   </p>\n\n<p>The method in the <code>Item model</code> is below.</p>\n\n<pre><code>    def borrowable?(current_user, user, item, controller)\n      false\n      if user.invited?(current_user, user)\n        item.pieces.each do |piece|\n          if piece.available?(current_user, piece)\n            true\n          end\n        end\n        if controller == \"pages\"\n          true\n        end\n      end\n    end\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":8,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":10225,"score":16,"question_id":3952243,"title":"warning Insecure world writable dir","body":"<p>I get this everytime I run: rails server</p>\n\n<p>I get:  </p>\n\n<blockquote>\n  <p>warning: Insecure world writable dir /usr/local/bin in PATH, mode 040777</p>\n</blockquote>\n\n<p>I searched for a solution here and they said to type: chmod go-w /usr/local/bin</p>\n\n<p>But I get this error: </p>\n\n<blockquote>\n  <p>chmod: Unable to change file mode on /usr/local/bin: Operation not permitted</p>\n</blockquote>\n\n<p>I am using OSX btw.</p>\n"},{"tags":["ruby-on-rails","ferret","acts-as-ferret"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":7,"score":-1,"question_id":13292860,"title":"Acts as ferret fuzzy search returning erratic results","body":"<p>I have a ferret-indexed class called User and am using acts_as_ferret in my rails app.  If i do the same fuzzy search repeatedly, it cycles through three different sets of results:</p>\n\n<pre><code>irb(main):118:0&gt; @users = User.find_with_ferret(\"markb-war~0.6\", {:page =&gt; 1, :per_page =&gt; 50}, {});puts \"@users.size = #{@users.size}, @users.total_entries = #{@users.total_entries}, @users.offset = #{@users.offset}\"\n@users.size = 2, @users.total_entries = 2, @users.offset = 0\n=&gt; nil\nirb(main):119:0&gt; @users = User.find_with_ferret(\"markb-war~0.6\", {:page =&gt; 1, :per_page =&gt; 50}, {});puts \"@users.size = #{@users.size}, @users.total_entries = #{@users.total_entries}, @users.offset = #{@users.offset}\"\n@users.size = 44, @users.total_entries = 52, @users.offset = 0\n=&gt; nil\nirb(main):120:0&gt; @users = User.find_with_ferret(\"markb-war~0.6\", {:page =&gt; 1, :per_page =&gt; 50}, {});puts \"@users.size = #{@users.size}, @users.total_entries = #{@users.total_entries}, @users.offset = #{@users.offset}\"\n@users.size = 23, @users.total_entries = 24, @users.offset = 0\n=&gt; nil\nirb(main):121:0&gt; @users = User.find_with_ferret(\"markb-war~0.6\", {:page =&gt; 1, :per_page =&gt; 50}, {});puts \"@users.size = #{@users.size}, @users.total_entries = #{@users.total_entries}, @users.offset = #{@users.offset}\"\n@users.size = 2, @users.total_entries = 2, @users.offset = 0\n=&gt; nil\nirb(main):122:0&gt; @users = User.find_with_ferret(\"markb-war~0.6\", {:page =&gt; 1, :per_page =&gt; 50}, {});puts \"@users.size = #{@users.size}, @users.total_entries = #{@users.total_entries}, @users.offset = #{@users.offset}\"\n@users.size = 44, @users.total_entries = 52, @users.offset = 0\n=&gt; nil\nirb(main):123:0&gt; @users = User.find_with_ferret(\"markb-war~0.6\", {:page =&gt; 1, :per_page =&gt; 50}, {});puts \"@users.size = #{@users.size}, @users.total_entries = #{@users.total_entries}, @users.offset = #{@users.offset}\"\n@users.size = 23, @users.total_entries = 24, @users.offset = 0\n=&gt; nil\n</code></pre>\n\n<p>I'm at a loss to explain this: has anyone encountered this before?</p>\n\n<p>thanks, max</p>\n"},{"tags":["ruby-on-rails","internationalization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13289515,"title":"In Rails, how to organize localized data for form elements other than labels?","body":"<p>I'm creating my first Rails app and it is going to have internationalization support.</p>\n\n<p>I've already read the <a href=\"http://guides.rubyonrails.org/i18n.html\" rel=\"nofollow\">i18n guide</a>, and it is a very good source. It even <a href=\"http://guides.rubyonrails.org/i18n.html#organization-of-locale-files\" rel=\"nofollow\">suggests a file organization</a> for the localization files, which is a very good start point:</p>\n\n<pre><code>|-defaults\n|---es.rb\n|---en.rb\n|-models\n|---book\n|-----es.rb\n|-----en.rb\n|-views\n|---defaults\n|-----es.rb\n|-----en.rb\n|---books\n|-----es.rb\n|-----en.rb\n|---users\n|-----es.rb\n|-----en.rb\n|---navigation\n|-----es.rb\n|-----en.rb\n</code></pre>\n\n<p>However, I'm not sure what is the best place to hold some extra (internationalized) information usually found in forms, like:</p>\n\n<ul>\n<li>input placeholders</li>\n<li>helper texts (beside the input, with a more detailed information about it)</li>\n</ul>\n\n<p>The thing is: this information pertains to views (not to models). But, it is frequently described in a per model, per attribute basis - which makes me inclined to put them inside the models files, under the activerecord property.</p>\n\n<p>My question: what is the best place to put this localized data? Both in terms of file organization (which folder) and in terms of the organization inside the file.</p>\n"},{"tags":["ruby-on-rails","mongodb","sqlite3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13292646,"title":"Why does Rails think my database is MongoDB, when it's SQLite3?","body":"<p>My database.yml file says</p>\n\n<pre><code>adapter: sqlite3\ndatabase: db/development.sqlite3\npool: 5\ntimeout: 5000\n</code></pre>\n\n<p>When I run rails server, I get:</p>\n\n<pre><code>ActiveRecord::ConnectionNotEstablished\n</code></pre>\n\n<p>I grep search my project, no mondodb written anywhere..\nI am using cucumber for BDD.\nAnd when I run rake, I get:</p>\n\n<pre><code>Please install the mongodb adapter: `gem install activerecord-mongodb-adapter` (cannot load such file -- active_record/connection_adapters/mongodb_adapter)\n</code></pre>\n\n<p>Any idea?</p>\n"},{"tags":["ruby-on-rails","activerecord","ruby-on-rails-3"],"answer_count":4,"favorite_count":10,"up_vote_count":17,"down_vote_count":0,"view_count":10435,"score":17,"question_id":3742785,"title":"Rails 3 devise, current_user is not accessible in a Model?","body":"<p>in my project.rb model, I'm trying to create a scope with a dynamic variable:</p>\n\n<pre><code>scope :instanceprojects, lambda { \n    where(\"projects.instance_id = ?\", current_user.instance_id)\n} \n</code></pre>\n\n<p>I get the following error: \"undefined local variable or method `current_user' for #\"</p>\n\n<p>Where in the controller I can access current_user.instance_id... Is there a reason the model can't access it and a way to get access? Also, is this the right place to create a scope like the above, or does that belong in the controller?</p>\n\n<p>Thanks</p>\n"}]}
{"total":93230,"page":2,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby","postgresql","random"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13223833,"title":"Using seeded random sequence instead of 100M row relations table","body":"<p>We are hosting the backend of a social game for iPhone on a Ruby on Rails/postgres server.</p>\n\n<p>Every game has 54 questions connected via a relation table in the database. Since we currently have about 2 Million ongoing games, the relation table contains about a 100M rows. This eats a lot of memory. We are now considering constructing an algorithm which generates 54 question ids using a pseudo-random sequence seeded by the game_id. The idea is to produce a seemingly random collection of question, without saving the explicit game-question-relations to the database. This way we can move load from the database to the application server. Is this a good idea?</p>\n\n<p><strong>Pseudo code:</strong></p>\n\n<pre><code>r = Random.new(game_id)\nq1_id = r.rand(n_questions)\nq2_id = r.rand(n_questions)\n... \n</code></pre>\n"},{"tags":["sql","ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13291211,"title":"Generating serial numbers in Rails ActiveRecord","body":"<p>In a Rails app I need a source of unique, sequential (no gaps) integers to use as serial numbers. It must be persistent and allow concurrent access. </p>\n\n<p>Database auto-increment isn't adequate because most don't guarentee the \"no gaps\" property.</p>\n\n<p>In straight SQL I would just create a one-line table and say (in PostgreSQL) something like:</p>\n\n<pre><code>update sequence set value = value + 1 returning value\n</code></pre>\n\n<p>This is apparently standard practice in the SQL world. References exist.</p>\n\n<p>In ActiveRecord I easily created a model the model and found <code>.increment!</code> and <code>.increment_counter</code> in the documentation. But I can't figure out how to <em>atomically</em> retrieve the incremented value.  Locks and transactions don't seem to help.</p>\n"},{"tags":["ruby-on-rails","http","ssl","https","nginx"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":10,"score":-1,"question_id":13292102,"title":"nginx with ssl: I get a 403 and log \"directory index of '...dir...' is forbidden\" log message. works fine with unencrypted connection","body":"<p>As mentioned in the title, I had nginx working fine with my rails app, until I tried to add the ssl server. </p>\n\n<p>The unencrypted connection still works but the ssl always returns me a 403 page with the following line in the error log: </p>\n\n<blockquote>\n  <p>directory index of \"/home/user/rails/\" is forbidden, client: [my ip], server: _, request: \"GET / HTTP/1.1\", host: \"[server ip]\"</p>\n</blockquote>\n\n<p>Below my nginx.conf server block:</p>\n\n<pre><code>server {\n  listen 80;\n  listen 443 ssl;\n\n  ssl_certificate /etc/ssl/server.crt;\n  ssl_certificate_key /etc/ssl/server.key;\n  client_max_body_size 4G;\n  keepalive_timeout 5;\n  root /home/user/rails;\n  try_files $uri/index.html $uri.html $uri @app;\n  location @app {\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header Host $http_host;\n    proxy_redirect off;\n    proxy_pass http://0.0.0.0:8080;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  location = /500.html {\n    root /home/user/rails;\n  }\n}\n</code></pre>\n\n<p>the /home/user/rails directory and it's parent have all read to all rights. and they belong to the user nginx. </p>\n\n<p>the certificate and key file have the following rights: </p>\n\n<blockquote>\n  <p>-rw-r--r--  1 nginx root   830 Nov  8 09:09 server.crt\n  -rw--w----  1 nginx root   887 Nov  8 09:09 server.key</p>\n</blockquote>\n\n<p>any clue?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13283195,"title":"How to run single test class using minitest in ROR","body":"<p>My Gemfile looks like this:-</p>\n\n<pre><code>group :test do\n  # Pretty printed test output\n  gem 'capybara'#,'1.1.2'\n  gem 'cucumber-rails','1.2.1'\n  gem 'cucumber','1.1.4'\n  gem 'rspec-rails','2.8.1'\n  gem 'rspec-cells','0.1.2'\n  gem \"factory_girl_rails\"\n  gem \"guard-rspec\"\n  gem \"minitest\"\n  gem 'headless'\n  gem 'minitest-rails'\n  gem 'minitest-rails-capybara'  \n end\n</code></pre>\n\n<p>minitest_helper.rb looks like :-</p>\n\n<pre><code>ENV[\"RAILS_ENV\"] = \"test\"\nrequire File.expand_path(\"../../config/environment\", __FILE__)\nrequire \"minitest/autorun\"\nrequire \"capybara/rails\"\n\n\nclass ControllerTest  &lt; MiniTest::Spec\n include Rails.application.routes.url_helpers\n include Capybara::DSL\n register_spec_type(/integration$/, self)\nend\n</code></pre>\n\n<p>And my products_controller_test.rb looks like this:-</p>\n\n<pre><code>require \"minitest_helper\"\n\n\ndescribe \"Products Controller\" do\n   it \"shows product's name\" do  \n    uname=\"Glasses\"\n\n    product1 = Product.create!(:name =&gt; uname, :description =&gt; uname, :no_of_items =&gt;    3,:fee_percentage =&gt; 4)\n    visit products_path\n    page.text.must_include \"Glasses\"\n  end\n\n   end\n</code></pre>\n\n<p>BUT..after executing ruby <code>-Itest test/controllers/products_controller_test.rb</code></p>\n\n<p>I get no error,no indication to show that this test class has been loaded :-</p>\n\n<pre><code>ruby -Itest test/controllers/products_controller_test.rb\n:public is no longer used to avoid overloading Module#public, use :public_folder instead\n    from /usr/local/rvm/gems/ruby-1.9.2-p290/gems/resque-1.19.0/lib/resque/server.rb:12:in `&lt;class:Server&gt;'\nLoaded suite test/controllers/products_controller_test\nStarted\n\nFinished in 0.004953 seconds.\n\n0 tests, 0 assertions, 0 failures, 0 errors, 0 skips\n</code></pre>\n\n<p><em><strong>its first time i am using Minitest...</em></strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nested-attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13291501,"title":"Create new many-to-many nested models in rails","body":"<p>I have a typical elementary problems which I cannot find a nice solution for. Let's take the typical many to many relationship in Rails, with the join table used to assign a value:</p>\n\n<pre><code>Recipe\n    has_many :recipe_ingredients\n    has_many :ingredients, :through =&gt; :recipe_ingredients\n    accepts_nested_attributes_for :recipe_ingredients\n\nIngredient\n    has_many :recipe_ingredients\n    has_many :recipes, :through =&gt; :recipe_ingredients\n\nRecipeIngredient\n    belongs_to :recipe\n    belongs_to :ingredient\n    attr_accessible :quantity\n</code></pre>\n\n<p>Nothing strange here. Let's say now I want to to create a new recipe with new ingredients all in one go. I have some JSON sent to the server like this:</p>\n\n<pre><code>{\"recipe\"=&gt;\n    {\"name\"=&gt;\"New Recipe\", \n     \"ingredients\"=&gt;\n        [{\"name\" =&gt; \"new Ingr 1\", \"quantity\"=&gt;0.1},\n         {\"name\" =&gt; \"new Ingr 2\", \"quantity\"=&gt;0.7}]\n    }\n}\n</code></pre>\n\n<p>I reckon I can navigate the params and create the objects one by one but I was looking into leveraging the many-to-many association and above all the <code>accepts_nested_attributes_for</code>, thus being able to do something like <code>Recipe.create(params[:recipe])</code> and have the object tree created for me. If that means changing the JSON being sent, it is not a problem. :)</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13291347,"title":"I fixed a failing rails migration, but why did this fix work?","body":"<p>I generated a new rails migration:</p>\n\n<pre><code>rails generate migration some_new_column_to_table\n</code></pre>\n\n<p><strong>edit:</strong> -- </p>\n\n<p>ran the migration:</p>\n\n<pre><code>rake db:migrate\n</code></pre>\n\n<p>updated test db:</p>\n\n<pre><code>rake db:test:prepare\n</code></pre>\n\n<p>realized I hadn't added anything to the change method, then</p>\n\n<p>updated the migration file:</p>\n\n<pre><code>class AddSomeColumnToTable &lt; ActiveRecord::Migration\n  def change\n    add_column :table, :some_column, :string\n    add_index :table, :some_column\n  end\nend\n</code></pre>\n\n<p>ran the migration (again):</p>\n\n<pre><code>rake db:migrate\n</code></pre>\n\n<p>updated test db (again):</p>\n\n<pre><code>rake db:test:prepare\n</code></pre>\n\n<p>After running these commands \"some_column\" had not be added to the database. I found a solution to this problem here: <a href=\"http://stackoverflow.com/questions/9896488/rake-dbmigrate-is-not-working\">rake db:migrate is not working</a></p>\n\n<pre><code>rake db:drop:all\nrake db:create:all\nrake db:migrate\n</code></pre>\n\n<p>Why did this fix the problem?\nHow can I prevent it in the future?</p>\n"},{"tags":["ruby-on-rails","capybara","shopify"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":756,"score":3,"question_id":8546839,"title":"How do I set up a session value in Capybara?","body":"<p>I am developing an app for Shopify and I want to do integration testing.</p>\n\n<p>I need to be able to store some values in the session variable, so that authentication works.</p>\n\n<p>How could I do that?</p>\n\n<p>I use Capybara and Capybara-webkit.</p>\n"},{"tags":["ruby-on-rails","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13206182,"title":"Why i can't test my versionist route","body":"<p>I have versioned route like this</p>\n\n<pre><code>api_version(:module =&gt; \"api/v1\", :path =&gt; \"api/v1\") do\n  match '/files' =&gt; 'files#index', :via =&gt; :get\nend\n</code></pre>\n\n<p>And my controller app/controllers/api/v1/files_controller.rb</p>\n\n<pre><code>class Api::V1::FilesController &lt; ApplicationController\n\n  def index\n  end\n\nend\n</code></pre>\n\n<p>spec in root/spec/controllers/api/v1/files_controller_spec.rb</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe Api::V1::FilesController do\n\n  describe \"routing\" do\n\n    it \"should routes to version-1 api\" do\n      expect(:get =&gt; \"/api/v1/files\").to route_to(\"api/v1/files#index\")\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>command rake routes gives me a list of my routes like this</p>\n\n<pre><code>devise/registrations#edit\n                          PUT    /users(.:format)  devise/registrations#update\n                          DELETE /users(.:format)  devise/registrations#destroy\n             api_v1_files GET    /api/v1/files(.:format)      api/v1/files#index\n</code></pre>\n\n<p>when i run rake spec:controllers, specs falls.</p>\n\n<pre><code>F\n\nFailures:\n\n1) Api::V1::FilesController routing should routes to version-1 api\n Failure/Error: Unable to find matching line from backtrace\n NoMethodError:\n   undefined method `[]' for nil:NilClass\n # /home/dilshod/.rvm/gems/ruby-1.9.2-p290/gems/moped-1.2.7/lib/moped/node.rb:74:in `block in command'\n # /home/dilshod/.rvm/gems/ruby-1.9.2-p290/gems/moped-1.2.7/lib/moped/n\n</code></pre>\n\n<p>What i am doing wrong?</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","upgrade","form-for"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":586,"score":2,"question_id":7044027,"title":"How to upgrade the :update=>'div_id' option of remote_form_for from Rails 2 to Rails 3?","body":"<p>I can't figure out how to upgrade this code from Rails 2 to Rails 3:</p>\n\n<pre><code>&lt;% remote_form_for(item, :update =&gt; 'div_id') do |f| %&gt;\n... \n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>&lt;%= form_for :item, :remote =&gt; true, :url =&gt; { :controller =&gt; \"items\", :action =&gt; \"create\" }, :update =&gt; 'div_id' do |f| %&gt;\n...\n</code></pre>\n\n<p>It creates the new item but <strong>it fails in updating the content</strong> within <code>&lt;div id=\"div_id\"&gt;&lt;/div&gt;</code> tags. It seems Rails 3 no longer supports the \"<code>:update</code>\" option for a remote <code>form_for</code>. Any suggestion?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13291445,"title":"add self class to models rails 3","body":"<p>I have 3 models:</p>\n\n<pre><code>Class Model1\n\nend\n\nClass Model2\n\nend\n\nClass Model3\n\nend\n</code></pre>\n\n<p>I have this code:</p>\n\n<pre><code>scope :created_between, lambda { |start_time, end_time| where(:created_at =&gt; (start_time...end_time)) }\n\nclass &lt;&lt; self\n ## Class methods for calculating searches\n def created_today\n  today = Time.zone.now\n  created_between(today.beginning_of_day, today.end_of_day)\n end\n\n def created_yesterday\n  yesterday = Time.zone.now - 1.day\n  created_between(yesterday.beginning_of_day, yesterday.end_of_day)\n end\n\n def created_last_week\n  start_time = (Time.zone.now - 1.week).beginning_of_day\n  end_time = Time.zone.now\n  created_between(start_time, end_time)\n end\n\n def created_last_month\n  start_time = (Time.zone.now - 1.month).beginning_of_day\n  end_time = Time.zone.now\n  created_between(start_time, end_time)\n end\n\n def created_last_year\n  start_time = (Time.zone.now - 1.year).beginning_of_day\n  end_time = Time.zone.now\n  created_between(start_time, end_time)\n end\n</code></pre>\n\n<p>end</p>\n\n<p>I need add this code to 3 models but I don't want repeat the code inside each model.</p>\n\n<p>How can I do it?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","devise","cucumber"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13292093,"title":"wrong redirect after signing in","body":"<p>I have this controller.</p>\n\n<pre><code>class SessionsController &lt; Devise::SessionsController\n  # GET /resource/sign_in\n  def new\n    self.resource = build_resource(nil, :unsafe =&gt; true)\n    clean_up_passwords(resource)\n    respond_with(resource, serialize_options(resource))\n  end\n\n  # POST /resource/sign_in\n  def create\n    self.resource = warden.authenticate!(auth_options)\n    set_flash_message(:notice, :signed_in, :username =&gt; resource.username) if is_navigational_format?\n    sign_in(resource_name, resource)\n   respond_with resource, :location =&gt; after_sign_in_path_for(resource)\n end\nend\n</code></pre>\n\n<p>and this step-defenitions for cucumber:</p>\n\n<pre><code>Given /^a user \"(.*?)\" exists$/ do |user_name|\n    @user = User.create!(:username =&gt; user_name , :password =&gt; \"tamara\")\nend\n\nWhen /^he logs in$/ do \n  visit(\"/users/sign_in\")\n  fill_in('Username', :with =&gt; \"roelof\")\n  fill_in('Password', :with =&gt; \"tamara\")\n  click_button('Sign in')\nend\n\nThen /^he should see \"(.*?)\"$/ do |message|\n  page.should have_content(message)\nend\n</code></pre>\n\n<p>Everything works fine only after a successfull login I get redirect to the homepage and not to the login succceed page. So I don't see the flash message. </p>\n\n<p>Roelof</p>\n"},{"tags":["ruby-on-rails","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":454,"score":0,"question_id":10907325,"title":"Rspec test for destroy if no delete link","body":"<p>I'm going through the latest rails tutorial on railstutorial.org and I am stuck on a certain exercise (#8 on <a href=\"http://ruby.railstutorial.org/chapters/updating-showing-and-deleting-users#sec:updating_deleting_exercises\" rel=\"nofollow\">http://ruby.railstutorial.org/chapters/updating-showing-and-deleting-users#sec:updating_deleting_exercises</a>).  You have to write a rspec/capybara test to make sure the admin can't delete themself.  I have the implementation working, but can't get the test to work right.  Here is my code.  I found similar questions here: <a href=\"http://stackoverflow.com/questions/4510204/ruby-on-rails-syntax\">Ruby on Rails syntax</a> and <a href=\"https://getsatisfaction.com/railstutorial/topics/how_to_prevent_admin_user_from_deleting_themselves\" rel=\"nofollow\">https://getsatisfaction.com/railstutorial/topics/how_to_prevent_admin_user_from_deleting_themselves</a> .  But I think it is an older tutorial and not the same question.</p>\n\n<p>Here is the relevant code in spec/requests/user_pages_spec.rb:</p>\n\n<pre><code>describe \"User pages\" do\n  subject { page }\n    describe \"delete links\" do\n      describe \"as an admin user\" do\n        let(:admin) { FactoryGirl.create(:admin) }\n        before do\n          sign_in admin\n          visit users_path\n        end\n        it \"should not be able to delete themself\" do\n          expect { admin.delete }.should_not change(User, :count)\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>The error message says that the user count is getting reduced by 1.</p>\n\n<p>For completeness, here is my (working) implementation:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  before_filter :current_admin,     only: :destroy\n  def current_admin\n  @user = User.find(params[:id])\n    redirect_to users_path, notice: \"Cannot delete current admin\" if current_user?(@user)\n  end\nend\n</code></pre>\n\n<p>Where am I going wrong, thanks?  (I left out some methods, but hopefully there is enough to figure out what I'm trying to do)</p>\n\n<p>Edit: Using Ruby v1.9.3, Rails v3.2.3.  By default, there is no delete link for admins.</p>\n\n<p>Edit2: Here is what I got working:</p>\n\n<p>spec/controllers/users_controller_spec.rb</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe UsersController do\n  describe \"admins\" do\n    let(:admin) { FactoryGirl.create(:admin) }\n\n    it \"should not be able to delete themself\" do\n      sign_in admin\n      expect { delete :destroy, :id =&gt; admin.id }.should_not change(User, :count)\n    end\n  end\nend\n</code></pre>\n\n<p>users_controller.rb</p>\n\n<pre><code>def destroy\n  @user = User.find(params[:id])\n\n  if current_user?(@user)\n    flash[:error] = \"Cannot delete current admin\"\n  else\n    @user.destroy\n    flash[:success] = \"User destroyed.\"\n  end\n  redirect_to users_path\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","paperclip"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":11824124,"title":"Setting Content-Disposition to attachment using Ruby on Rails and Paperclip","body":"<p>I have a – hopefully small – problem.</p>\n\n<p>I am using Ruby on Rails and Paperclip to handle file uploads.\nNow I want to automatically set the Content-Disposition header to \"attachment\" so that when the user clicks a link, the file is downloaded instead of shown directly in the browser.</p>\n\n<p>I found the following solution for Amazon S3:\n<a href=\"http://stackoverflow.com/questions/4811906/download-file-on-click-ruby-on-rails\">Download file on click - Ruby on Rails</a></p>\n\n<p>But I don't use S3.\nCan anybody help?</p>\n\n<p>Thanks in advance,\n/Lasse</p>\n"},{"tags":["ruby-on-rails","ruby","upload","paperclip","unzip"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13288166,"title":"Rails - Uploading zip file with paperclip and unziping","body":"<p>I'm trying to upload a zip file using <strong>rails</strong> and <strong>paperclip</strong> gem, and so far it works fine.\nBut after download has finished, I want to unzip this file and do some things with the files inside.</p>\n\n<p>The problem appears when I try to unzip the file, because it isn't in it's own path, probably it's being copied but has no finished. (And I'm in localhost, worse in online mode).</p>\n\n<p>So, I need some kind of event/trigger to know when the file has finished uploading to start unziping. And meanwhile, show some kind of interface.\nThe code of the controler goes below:</p>\n\n<pre><code># POST /components\n# POST /components.json\ndef create\n  @component = Component.new(params[:component])\n\n  file = @component.folder\n\n  Zip::ZipFile.open(file.path) do |zipfile|   # &lt;-- The error comes here\n    zipfile.each do |file|\n      # do something with file\n    end\n  end\n\n\n  respond_to do |format|\n    if @component.save\n      format.html { redirect_to @component, notice: 'Component was successfully created.' }\n      format.json { render json: @component, status: :created, location: @component }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @component.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","rake","thinking-sphinx"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13291743,"title":"Thinking_sphinx starts but rake still fails","body":"<p>I am using Rails 3.0.7 and the Thinking_sphinx 2.0.13.</p>\n\n<p>Background: </p>\n\n<p>I'm trying to create a deploy script (capistrano) where sphinx will be stoped before capistrano updates the code, and then started again when the update is done. </p>\n\n<p>However, the rake task for thinking_sphinx:start fails.</p>\n\n<p>The commands below are run in this exact order. </p>\n\n<pre><code>$ rake thinking_sphinx:stop\n\nStopped search daemon (pid 54117).\nsearchd is not running\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code>$ ps aux | grep searchd\nxx  54597   0.0  0.0  2434892    532 s002  R+    4:04PM   0:00.00 grep searchd\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code>$ rake thinking_sphinx:start\nStarted successfully (pid 54618).\nrake aborted!\nsearchd is already running.\n\nTasks: TOP =&gt; thinking_sphinx:start\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code>$ ps aux | grep searchd\nxx  54637   0.8  0.0  2434892    448 s002  R+    4:06PM   0:00.00 grep searchd\nxx  54618   0.0  0.0  2442992    396 s002  S     4:05PM   0:00.02 searchd --pidfile --config /Users/emil/code/wd/config/development.sphinx.conf\n</code></pre>\n\n<p>So yes, it starts but the rake task fails. When I run these commands in \"cap deploy\", capistrano will rollback my updated code because the rake task fails.</p>\n\n<p>How do I solve this? I have no ideas left. </p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13282246,"title":"How might I render a JSON string for a dynamic rails route?","body":"<p>I've been setting up a tagging system for a post. I am using the awesome Select2 gem. One thing that I've noticed is that when I go to edit a post, <strong>the tags for that post do not show up.</strong> I found a way to <strong>get tags to pre-populate using the val() function</strong>.</p>\n\n<p>However, because my <strong>edit route</strong> which is users/:user_id/post/:id <strong>is</strong> inherently <strong>dynamic</strong>, <strong>it makes it difficult to use a string for the *<em>.getJSON</strong>.</em>* </p>\n\n<p>How might I do this or do it differently?</p>\n\n<p>Please note I purposely did not fill in a correct JSON path for the first .getJSON.. this is where I am having difficulty. </p>\n\n<pre><code>var items = [];\nvar prepopulate = [];\n\n$.getJSON('http://localhost:3000/[JSON PATH HERE]', function(data) {\n    $.each(data, function(i, obj) {\n        return prepopulate.push(obj.name);\n        });\n\n  $.getJSON('http://localhost:3000/tags.json', function(data) {\n      $.each(data, function(i, obj) {\n          return items.push(obj.name);\n          });\n      $(\"#post_tag_ids\").val(prepopulate).select2({\n    width: \"element\",\n    tags: items,\n    tokenSeparators: [\",\", \" \"]\n    });\n  });\n});\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13290414,"title":"Opening and executing a batch file which is saved in the application","body":"<p>I wrote a batch file, which is stored in my controller, which should write to a .bat file in the public folder. </p>\n\n<p>The code is:</p>\n\n<pre><code>def checkin\n    file_path = \"#{Rails.root}/public/batfiles/#{Time.now.hour}_#{Time.now.min}_#   {Time.now.sec}.bat\"\n    file = File.new(file_path, 'w')\n    svn_path = params[:svn_path]\n    content = ''\n    content += \"@echo off\\n\"\n    content += \"echo.\\n\"\n    content += \"echo. [ SVN Updater ]\\n\"\n    content += \"set SVNURL=#{svn_path}\\n\"\n    content += \"set SOURCE=C:\\\\Users\\\\\"\n    content += \"set SVN=C:\\\\Program Files\\\\TortoiseSVN\\\\bin\\n\"\n    content += \"echo.\\n\"\n    content += '\"%SVN%\\TortoiseProc.exe\" /command:checkout /path:\"%SOURCE%\" /url:%SVNURL% /closeonend:2'\n    content += \"echo. done.\\n\"\n    content += \"echo.\\n\"\n    content += \"echo. Operation complete.\\n\"\n    file.write content\n    file.close\n    send_file(file.path)\n  end\n</code></pre>\n\n<p>When I save the file in public/batfiles/.bat, I want to run the file not on the server but on the user's system. </p>\n\n<p>Right now the user downloads the .bat file and runs it from the browser. Instead, I want the user to do nothing but have the application open his .bat file and run it in his local machine. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13238137,"title":"get counter nested model mongoid","body":"<p>2 models:</p>\n\n<pre><code>Class User\n include Mongoid::Document\n has_many :reports\nend\n\nClass Report\n include Mongoid::Document\n belongs_to :user\nend\n</code></pre>\n\n<p>I need a query to get all users have 6 or more reports, something like:.</p>\n\n<pre><code>Users.where(reports.count &gt; 5)\n</code></pre>\n\n<p>I use mongo id 2.4.12</p>\n\n<p>How can I do it?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","rails-migrations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13291137,"title":"can after_find method be called in private in ruby on rails?","body":"<p>I am a newbie in ruby on rails and I face this particular problem. I tried to change the data structure of an attribute with the help of a migration file but I dont want to validate it. I am unable to perform this operation but I am able to do so if I shift the after_find method to private. Is it allowed to do so? Please clarify.</p>\n"},{"tags":["ruby-on-rails","backbone.js"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13290979,"title":"Installing rails-backbone, missing assets?","body":"<p>I just installed the <code>rails-backbone</code> gem and then <code>rails g backbone:install</code>. </p>\n\n<p>I see a list of javascript references to backbone on <code>application.js</code> but it does not copy them to the project and I'm not sure if this is normal. </p>\n\n<pre><code>//= require backbone\n//= require backbone_rails_sync\n//= require backbone_datalink\n//= require backbone/myapp\n</code></pre>\n\n<p>If this is normal, where is it possible to find <code>backbone_rails_sync</code> and <code>backbone_datalink</code>. I'm afraid that by simple searching will maybe not find the same version tested for this gem?</p>\n"},{"tags":["ruby-on-rails","password-recovery"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13290743,"title":"Password recovery in Ruby on Rails","body":"<p>Hi when I try to reset password I get this error:</p>\n\n<blockquote>\n  <p>ArgumentError in PasswordResetsController#create</p>\n  \n  <p>wrong number of arguments (1 for 0)</p>\n  \n  <p>app/models/user.rb:48:in <code>create_remember_token\n  app/models/user.rb:40:in</code>send_password_reset\n  app/controllers/password_resets_controller.rb:7:in `create'</p>\n</blockquote>\n\n<pre><code>class PasswordResetsController &lt; ApplicationController\n  def new\n  end\n\n  def create\n    user = User.find_by_email(params[:email])\n    user.send_password_reset if user\n    redirect_to root_url\n  end\n\n  def edit\n    @user = User.find_by_password_reset_token!(params[:id])\n  end\n\n  def update\n    @user = User.find_by_password_reset_token!(params[:id])\n    if @user.password_reset_sent_at &lt; 2.hours.ago\n      redirect_to new_password_reset_path, :alert =&gt; \"Password &amp;crarr; \n        reset has expired.\"\n    elsif @user.update_attributes(params[:user])\n      redirect_to root_url, :notice =&gt; \"Password has been reset.\"\n    else\n      render :edit\n    end\nend\nend\n\n\n\nclass User &lt; ActiveRecord::Base\n  attr_accessible :email, :lname, :name, :password, :password_confirmation\n  has_secure_password\n  before_save { |user| user.email = email.downcase }\n  before_save :create_remember_token\n\n  validates :name, presence: true, length: { maximum: 50 }\n  validates :lname, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX },\n                    uniqueness: { case_sensitive: false }\n  validates :password, presence: true, :on =&gt; :create\n  validates :password, length: { minimum: 6 }, :allow_blank =&gt; true\n  validates :password_confirmation, presence: true, :on =&gt; :create\n\n\n\n  def send_password_reset\n    create_remember_token(:password_reset_token)\n    self.password_reset_sent_at = Time.zone.now\n    save!\n    UserMailer.password_reset(self).deliver\n  end\n\n  private\n\n    def create_remember_token\n      self.remember_token = SecureRandom.urlsafe_base64\n    end\nend\n</code></pre>\n\n<p>Have anybody an Idea why?</p>\n"},{"tags":["ruby-on-rails","forms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13290470,"title":"How can I make it so that users can define their own dynamic forms to be used in a rails app?","body":"<p>Users need to be able to add data, but to define its structure as well. I need a gem (ideally) that will allow a form definition to be built up in the DB somehow, then displayed as a HTML form, then form entries to be collected and stored. Is there such a thing, or will I need roll my own?</p>\n"},{"tags":["jquery","ruby-on-rails","asset-pipeline"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13290353,"title":"New Rails 3.2.8 app not loading jQuery","body":"<p>I did a <code>rails new</code> today, then created a simple search bar:</p>\n\n<pre><code>&lt;form&gt;\n  &lt;input id='search-bar' type='search' name='search'&gt;&lt;/input&gt;\n&lt;/form&gt;\n&lt;a id='search-btn' href=\"#\"&gt;searching!&lt;/a&gt;\n</code></pre>\n\n<p>Alright, how about some click handlers! So assets/javascripts/searches.js.coffee:</p>\n\n<pre><code>$('#search-btn').click -&gt;\n  alert 'BOOM'\n  query = $('#search-bar').html\n  console.log query\n</code></pre>\n\n<p>And... nothing. So I go to the Chrome console:</p>\n\n<pre><code>&gt;$('a')\nnull\n&gt;$('body')\nnull\n&gt;$\nfunction () { [native code] }\n</code></pre>\n\n<p>a jQuery with no selectors, not too helpful. What is going on here? If I add <code>&lt;script type=\"text/javascript\" src='http://code.jquery.com/jquery-1.8.2.js'&gt;&lt;/script&gt;</code> to the page or my layout.html.erb, we're all good.</p>\n\n<p>I'm having the same issue with underscore-min.js (note it is not .min.js) not loading despite being in assets/javascripts. Given my (unmodified) application.js, it should load the current folder:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require_tree .\n</code></pre>\n"},{"tags":["ruby-on-rails","routes","views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13290173,"title":"Route specification doesn't seem to match generated method","body":"<p>When I refresh the page I get this error message:</p>\n\n<pre><code>ActionController::RoutingError (No route matches {:action=&gt;\"value\", :controller=&gt;\"round\"}):\n  app/views/surveys/survey.html.erb:28:in `block in _app_views_surveys_survey_html_erb___3955880096442191391_70175035205180'\n  app/views/surveys/survey.html.erb:22:in `_app_views_surveys_survey_html_erb___3955880096442191391_70175035205180'\n  app/controllers/surveys_controller.rb:16:in `block (2 levels) in survey'\n  app/controllers/surveys_controller.rb:14:in `survey'    \n  Rendered /Users/pitosalas/.rvm/gems/ruby-1.9.3-p194@repeatsurvey/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (0.5ms)\n</code></pre>\n\n<p>I am very confused by this. Why is the reference to program_participant_round_value_path causing that route to be missing?</p>\n\n<p>Here's my routes file:</p>\n\n<pre><code>root to: 'programs#index'\n  resources :programs do\n    resources :participants do\n      get 'survey' =&gt; 'surveys#survey'\n    end\n    resources :questions\n    resources :rounds\n    member do\n      get 'report' =&gt; 'reports#report'\n    end\n  end\n  resources :program do\n    resources :participant do\n      resources :round do\n        put :value\n      end\n    end\n  end\n</code></pre>\n\n<p>And here's the relevant rake routes line:</p>\n\n<pre><code>program_participant_round_value PUT    /program/:program_id/participant/:participant_id/round/:round_id/value(.:format) round#value\n</code></pre>\n\n<p>I have a controller action round#value.</p>\n\n<p>Here's the relevant part of the view:</p>\n\n<pre><code>&lt;%= content_tag :table do %&gt;\n  &lt;%= content_tag :thead do %&gt;\n    &lt;% 5.times do |q| %&gt;\n      &lt;%= content_tag :th, \"1\" %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n  &lt;% form_tag program_participant_round_value_path do %&gt;\n    &lt;%= content_tag :tbody do %&gt;\n      &lt;%= render partial: 'surveys/value', collection: @values  %&gt;\n    &lt;% end %&gt;\n    &lt;%= submit_tag \"Save\" %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13287937,"title":"Including helper method in controller test","body":"<p>How do i include some helper into my controller_spec code?\nI have method called \"a_title(ads)\" in dates_ads_helper, and returns self.\nHow do i use this method in my controller_spec test?</p>\n\n<p>When i try to call it in my controller_spec file i'm getting this error</p>\n\n<pre><code>NoMethodError:\n       undefined method `a_title' \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","custom-routes"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":18,"score":2,"question_id":13290121,"title":"How to translate root specific resource declaration from Rails 2 to Rails 3?","body":"<p>I'm migrating an application from Rails 2.3.5 to Rails 3.2.8. \nI have this route from the Rails 2 app that is giving me headaches:</p>\n\n<pre><code>  map.resources :soumission_vt,\n                :path_prefix =&gt; \"/soumission/VT/:page_id\", :as =&gt; 'police/:action/:id',\n                :requirements =&gt; {:page_id =&gt; /\\S+/}\n</code></pre>\n\n<p>wich generates the following:</p>\n\n<pre><code>soumission_vt_index GET    /soumission/VT/:page_id/police/:action/:id(.:format)               {:controller=&gt;\"soumission_vt\"}\n                    POST   /soumission/VT/:page_id/police/:action/:id(.:format)               {:controller=&gt;\"soumission_vt\"}\nnew_soumission_vt   GET    /soumission/VT/:page_id/police/:action/:id/new(.:format)           {:controller=&gt;\"soumission_vt\"}\nedit_soumission_vt  GET    /soumission/VT/:page_id/police/:action/:id/:id/edit(.:format)      {:controller=&gt;\"soumission_vt\"}\nsoumission_vt       GET    /soumission/VT/:page_id/police/:action/:id/:id(.:format)           {:controller=&gt;\"soumission_vt\"}\n                                    PUT    /soumission/VT/:page_id/police/:action/:id/:id(.:format)           {:controller=&gt;\"soumission_vt\"}\n                    DELETE /soumission/VT/:page_id/police/:action/:id/:id(.:format)           {:controller=&gt;\"soumission_vt\"}\n</code></pre>\n\n<p>I translated it this way in Rails 3:</p>\n\n<pre><code>  scope '/soumission/VT/:page_id', :constraints =&gt; {:page_id =&gt; /\\S+/} do\n    resources :soumission_vt, :as =&gt; 'police/:action/:id'\n  end\n</code></pre>\n\n<p>but I am getting an Invalid route name: 'police/:action/:id_index'...</p>\n\n<p>So is there a way to reproduce those routes in Rails 3?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","utf-8","windows-1252"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13289708,"title":"incompatible character encodings: Windows-1252 and UTF-8","body":"<p>This is a strange bit, When I run localhost:3000 it prompts me with error listed below</p>\n\n<pre><code>Encoding::CompatibilityError in Home#index\n\nincompatible character encodings: Windows-1252 and UTF-8\n\n17: &lt;%= render 'layouts/header'%&gt;\n18:\n19: &lt;%= yield %&gt;\n20: &lt;%= render 'layouts/footer' %&gt;\n21: &lt;/body&gt;\n22: &lt;/html&gt;\n</code></pre>\n\n<p>but it renders other pages if I do localhost:3000/en/#actionName. </p>\n\n<p>Since, localhost:3000 renders the index.html.erb, only for testing purposes I deleted the contents of index.html.erb; it rendered the layouts. So, what is wrong with the content of the index.html.erb page? everything looks okay to me, also I downloaded the content of index.html.erb from the server (the working version) it still gives me the same error. Need some guidance where I could have gone wrong. I tried the solution mentioned in this link <a href=\"http://stackoverflow.com/questions/4188677/ruby-on-rails-3-incompatible-character-encodings-utf-8-and-ascii-8bit-with-i18\">Ruby on Rails 3, incompatible character encodings: UTF-8 and ASCII-8BIT with i18n</a> but with no luck at all. </p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>            =====================  **UPDATE** ======================\n</code></pre>\n\n<p>why it did that it has been listed below: However another question pops in, why adding those source code generate such errors only for index.html.erb.</p>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13289972,"title":"Heroku cli.rb:24 Undefinded Method error_with_failure","body":"<p>I have been using Heroku successfully for some months now, but clearly I have made a change somewhere that is causing a number of problems.</p>\n\n<p>While the command \"heorku version\" executes, pretty much any other command, such as \"heorku db:push -t mytable\" fails with the error message:</p>\n\n<p>.heroku/client/lib/heroku/cli.rb:24:in <code>rescue in start': undefined method</code>error_with_failure' for Heroku::Helpers:Module (NoMethodError)\n        from C:/Users/Doug/.heroku/client/lib/heroku/cli.rb:10:in <code>start'\n        from c:/Program Files (x86)/Heroku/bin/heroku:33:in</code>'</p>\n\n<p>Taps gets loaded and detects the Heorku database, but that's as far as it gets.  </p>\n\n<p>Added info:\n1) Windows 7 64 bit\n2) Paths appear to be correct.\n3) \"Heroku version\" displays \"heorku-gem/2.28.8 (imingw32) ruby/1.9.3\"\n4) There appears to be a more current version of toolbelt (2.32.x) that automatically checks for client updates, but when I install it, I end up with my current version (2.28.8)</p>\n\n<p>Any suggestions would be really appreciated.\nDoug</p>\n"},{"tags":["ruby-on-rails","ruby","parsing","http-headers"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13289268,"title":"UDP HTTP Header parsing in Ruby","body":"<p>I get the following response from a a UDP Socket:</p>\n\n<pre><code>HTTP/1.1 200 OK\nCACHE-CONTROL: max-age=1800\nDATE: Thu, 08 Nov 2012 12:32:33 GMT\nEXT:\nLOCATION: http://192.168.0.100:49153/nmrDescription.xml\nSERVER: Windows2000/0.0 UPnP/1.0 PhilipsIntelSDK/1.4 DLNADOC/1.50\nX-User-Agent: redsonic\nST: upnp:rootdevice\nUSN: uuid:F00DBABE-SA5E-BABA-DADA188ED55ED539::upnp:rootdevice\n</code></pre>\n\n<p>Is there a library, or simple way to parse all this ?</p>\n\n<p>I'd like to get something like the following:</p>\n\n<pre><code>{\n  :cache_control =&gt; \"max-age=1800\"\n  :date =&gt; \"Thu, 08 Nov 2012 12:32:33 GMT\"\n  :ext =&gt; nil\n  :location =&gt; \"http://192.168.0.100:49153/nmrDescription.xml\"\n  # Etc.\n}\n</code></pre>\n"},{"tags":["ruby-on-rails","rspec"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13049841,"title":"Add extra documentation to rspec output","body":"<p>So, while I like Cucumber for its readability for integration testing and its ability to give us documentation we can share with the client easily, I also find it cumbersome from the development and testing speed standpoints.</p>\n\n<p>I got to thinking today that if I could just print out messages to the RSpec documentation format that documented the \"steps\", then I could easily replicate the business features of Gherkin but in the simplicity of RSpec.  But I can't figure out a way to do this.</p>\n\n<p>What I want is to take something like this:</p>\n\n<pre><code>describe \"Login and Authorization Tests\" do\n  before (:each) do\n    docs \"Given I have a user\"\n    @user = FactoryGirl.create(:user)\n  end\n\n  it \"A user can belong to one or more user roles\" do\n    docs \"And the user has no roles assigned\"\n    @user.roles.length.should eq 0\n    docs \"When I add two roles\"\n    @user.roles &lt;&lt; FactoryGirl.create(:role)\n    @user.roles &lt;&lt; FactoryGirl.create(:role)\n\n    @user.reload\n    docs \"Then the user should have two roles assigned\"\n    @user.roles.length.should eq 2        \n  end\nend\n</code></pre>\n\n<p>and get this in the documentation</p>\n\n<pre><code>User\n  Login and Authorization Tests\n    A user can belong to one or more user roles\n      Given I have a user\n      And the user has no roles assigned\"\n      When I add two roles\n      Then the user should have two roles assigned\n</code></pre>\n\n<p>Note that the message from \"before\" shows up in the docs too, and would show up with that line in every test below it.</p>\n\n<p>I'm thinking of forking to see if I can add something like this in, but before I did that, does anyone know if something like this is possible already?</p>\n"},{"tags":["ruby-on-rails","redmine","redmine-plugins"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13289856,"title":"Redmine pagination breaks at click on next link","body":"<p>I am working in redmine 1.4. I am putting pagination code in my controller like </p>\n\n<pre><code>def update_date\n\n    @start_date = params[:start_date]\n    @end_date   = params[:end_date]\n    @users = users\n    employees = [\"All\"]\n    @record_of_employees = [\"All\"]\n\n    if params.has_key?(\"employees\")\n      if params[:employees][0] == \"All\"\n          @record_of_employees = \"All\"\n      else\n          @record_of_employees = \"Specific\"\n      end\n      employees = params[:employees]\n      @employees = params[:employees]\n    else\n\n      employees = [\"All\"]\n      @employees = users\n    end\n      @punching_information = PunchingInformation.new\n      if params.has_key?(\"update_average\")\n\n        @limit = per_page_option\n        @user_count =  average_punching_record(@start_date, @end_date, employees).count\n        @user_pages = Paginator.new self, @user_count, @limit, params['page']\n        @offset ||= @user_pages.current.offset\n        @punching_record      = average_punching_record(@start_date, @end_date, employees, @offset, @limit)\n\n\n   #       @punching_record      = average_punching_record(@start_date, @end_date, employees)\n          @record_type = \"average\"\n      else\n        @limit = per_page_option\n        @user_count =  detail_punching_record(@start_date, @end_date, employees).count\n        @user_pages = Paginator.new self, @user_count, @limit, params['page']\n        @offset ||= @user_pages.current.offset\n        @punching_record      = detail_punching_record(@start_date, @end_date, employees, @offset, @limit)\n\n    #    @punching_record      = detail_punching_record(@start_date, @end_date, employees)\n\n        @record_type = \"detail\"\n      end\n\n\n  end\n</code></pre>\n\n<p>It works well, when page loads, links are created, but when I click at next page link, it throws me to show page of controller, instead of showing next paginated data.\nWhy this is happening?</p>\n"},{"tags":["ruby-on-rails","thinking-sphinx"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13248145,"title":"Thinking Sphinx : Relevance - infix vs. complete word","body":"<p>Using Thinking Sphinx in my rails app, I set it up to allow partial match with <code>infix</code> (for example, searching for \"tray\" would match \"ashtray\").</p>\n\n<p>However, I'd like complete word match to have more weight (relevance) than infix match.</p>\n\n<p>So, if my search for 'tray' returns these 3 results : \"Silver Tray\", \"Ashtray\" and \"Some other tray\" - I want the \"Ashtray\" to be the last result when sorting by relevance.</p>\n\n<p>Is there a way to configure Sphinx to do that ? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","query","activerecord","random"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13289352,"title":"Rails Active Record Query - find random record that meets a condition","body":"<p>I have a model from which I want to pull a random record that meets a certain criteria. For example: give me a random record from table Thing where column_name = true.</p>\n\n<p>To get a random record from the model I can do the following:</p>\n\n<pre><code>Thing.offset(rand(Thing.count)).first\n</code></pre>\n\n<p>and I want to combine that with the query:</p>\n\n<pre><code>Thing.where(\"column_name = ?\", true).all\n</code></pre>\n\n<p>This doesn't work:</p>\n\n<pre><code>counter = Thing.where(\"column_name = ?\", true).count\nThing.where(\"column_name = ?\", true).offset(rand(counter)).first\n</code></pre>\n\n<p>Any ideas on how to write this query would be greatly appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid","geospatial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13289679,"title":"Using geoNear with Rails / Mongoid","body":"<p>I'm having problems querying Geospatial indexes with MongoDB / Rails.\nI'm using this gem - <a href=\"https://github.com/kristianmandrup/mongoid_geospatial\" rel=\"nofollow\">https://github.com/kristianmandrup/mongoid_geospatial</a></p>\n\n<p>Here's my fairly basic model:</p>\n\n<pre><code>class Company\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  include Mongoid::Geospatial\n\n  field :name, type: String\n\n  field :location, type: Array, spatial: true\n\n  spatial_index :location\n\n  validates :location, location: true\nend\n</code></pre>\n\n<p>Then, in my controller, I have this</p>\n\n<pre><code>    #@vendors = Vendor.where(:location.near =&gt; {:point =&gt; [-2.1294761000000335,57.0507625], :max =&gt; 5})\n</code></pre>\n\n<p>However, this isn't returning expected results (ie- it's returning things from all over the place, not just near that particular lon / lat)</p>\n\n<p>Also, how would I go about doing a geoNear with this?<br>\nSo that I can get back the distances from central point for each result?</p>\n\n<p><strong>Note</strong>\nAfter writing this question, I've seen the gem has been updated, but I'm not sure if there's a better alternative..?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13259763,"title":"Rails condition where association has_many has count more than one","body":"<p>Package.rb</p>\n\n<pre><code>has_many :deals\n</code></pre>\n\n<p>Deal.rb</p>\n\n<pre><code>belongs_to package\n</code></pre>\n\n<p>Now simple question is I want to get all packages where deals count is more than one.\nWhat is the best method to do it? <code>where(:available_for_purchase =&gt; true)</code>and <code>self.deals.count &gt; 0</code> </p>\n\n<p>(package.rb)</p>\n\n<pre><code>  class &lt;&lt; self\n    def available\n      where(:available_for_purchase =&gt; true)\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","mongodb","nested-forms","nested-form-for"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":80,"score":5,"question_id":13182651,"title":"Nested fields with mongodb","body":"<p>I'm trying to create nested fields using mongodb. For that I'm using the gem <a href=\"http://www.mongomodel.org/\" rel=\"nofollow\">mongomodel</a> which allows work with ruby and mongodb and I'm using the gem <a href=\"https://github.com/ryanb/nested_form\" rel=\"nofollow\">nested_form</a>, to create dynamics nested fields. I'm having the following trouble:</p>\n\n<p><code>undefined method</code>reflect_on_association' for #`</p>\n\n<p>Other errors like it, that I have found in the internet doesn't really match what I want to do here with mongodb. I'm new to RoR, and I don't know how to solve this. Can anyone help me?</p>\n\n<p>Here is my models:</p>\n\n<p>survey.rb</p>\n\n<pre><code>class Survey &lt; MongoModel::Document\n  property :name, String\n  property :questions, Collection[Question]\n  timestamps!\n\n  accepts_nested_attributes_for :questions, :reject_if =&gt; lambda { |a| a[:content].blank? }, :allow_destroy =&gt; true\nend\n</code></pre>\n\n<p>questions.rb</p>\n\n<pre><code>class Question &lt; MongoModel::Document\n  property :content, String\n  timestamps!\nend\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>surveys_controller.rb\nclass SurveysController &lt; ApplicationController\n  # GET /surveys\n  # GET /surveys.json\n  def index\n    @surveys = Survey.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @surveys }\n    end\n  end\n\n  # GET /surveys/1\n  # GET /surveys/1.json\n  def show\n    @survey = Survey.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @survey }\n    end\n  end\n\n  # GET /surveys/new\n  # GET /surveys/new.json\n  def new\n    @survey = Survey.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @survey }\n    end\n  end\n\n  # GET /surveys/1/edit\n  def edit\n    @survey = Survey.find(params[:id])\n  end\n\n  # POST /surveys\n  # POST /surveys.json\n  def create\n    @survey = Survey.new(params[:survey])\n\n    respond_to do |format|\n      if @survey.save\n        format.html { redirect_to @survey, notice: 'Survey was successfully created.' }\n        format.json { render json: @survey, status: :created, location: @survey }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @survey.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /surveys/1\n  # PUT /surveys/1.json\n  def update\n    @survey = Survey.find(params[:id])\n\n    respond_to do |format|\n      if @survey.update_attributes(params[:survey])\n        format.html { redirect_to @survey, notice: 'Survey was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @survey.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /surveys/1\n  # DELETE /surveys/1.json\n  def destroy\n    @survey = Survey.find(params[:id])\n    @survey.destroy\n\n    respond_to do |format|\n      format.html { redirect_to surveys_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>My gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\ngem \"mongomodel\"\ngem \"bson_ext\"\ngem \"nested_form\"\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\n\n# To use ActiveModel has_secure_password\n# gem 'bcrypt-ruby', '~&gt; 3.0.0'\n\n# To use Jbuilder templates for JSON\n# gem 'jbuilder'\n\n# Use unicorn as the app server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n# gem 'capistrano'\n\n# To use debugger\n# gem 'debugger'\n</code></pre>\n\n<p>My view of survey:</p>\n\n<pre><code>_form.html.erb\n&lt;%= nested_form_for(@survey) do |f| %&gt;\n  &lt;% if @survey.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@survey.errors.count, \"error\") %&gt; prohibited this survey from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @survey.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;p&gt;\n    &lt;%= f.fields_for :questions do |builder| %&gt;\n    &lt;p&gt;\n        &lt;%= builder.label :content, \"Question\" %&gt;\n    &lt;%= builder.text_area :content, :rows =&gt; 3 %&gt;\n    &lt;/p&gt;    \n    &lt;% end %&gt;\n    &lt;p&gt;&lt;%= f.link_to_add \"Add a Question\", :questions %&gt;&lt;/p&gt;\n  &lt;/p&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","arrays","controller","each"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13289150,"title":"In js.erb ,how to use the array that defined in the rails controller?","body":"<p>My code is as follows:</p>\n\n<p><strong>Controller:</strong></p>\n\n<pre><code>@snf1_ie_cases = Snf1Testcase.find(:all,:conditions=&gt;[\"result_style = ?\", 0])\n\nrespond_to do|format|\n  format.js \nend\n</code></pre>\n\n<p><strong>XX.js.erb:</strong></p>\n\n<pre><code>&lt;% for snf1_ie_case in @snf1_ie_cases %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Then the error is:</p>\n\n<blockquote>\n  <p>undefined method 'each' </p>\n</blockquote>\n\n<p>How can I send the array of the controller to XX.js.erb?</p>\n"},{"tags":["ruby-on-rails","ruby","mongoid","date"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":261,"score":1,"question_id":9741670,"title":"Get objects size between relative dates","body":"<p>I have many User objects with <code>created_at</code> attribute e.g. </p>\n\n<p>I get objects with <code>@users = User.all</code></p>\n\n<p>I want get the count of User objects with various ages from creation with</p>\n\n<pre><code>@users.size\n</code></pre>\n\n<p>for these date ranges:</p>\n\n<pre><code>yesterday\nlast week\nlast month\nlast year.\n</code></pre>\n\n<p>How can I do it?</p>\n\n<p>I use mongoid.</p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13289019,"title":"Rails 3.2: Ordering a has_many :through selection, when the through-model has a default_scope","body":"<p>I have a simple time-tracking app, that has projects, tasks, and entries.</p>\n\n<p>The setup is straight-forward:</p>\n\n<pre><code>class Project &lt; ActiveRecord::base\n  has_many :tasks\n  has_many :entries, :through =&gt; :tasks\nend\n\nclass Task &lt; ActiveRecord::base\n  belongs_to :project\n  has_many :entries\n\n  default_scope order(\"name asc\") # this causes problems\nend\n</code></pre>\n\n<p>(<code>Entry</code> is entirely straight-forward, so I've left it out)</p>\n\n<p>However, I'm running into trouble when trying to do custom ordering of entries selected from a project. Specifically, I'm trying to select the latest entry like so:</p>\n\n<pre><code>latest_entry = project.entries.order(\"created_at desc\").first\n</code></pre>\n\n<p>But due to the <code>:through =&gt; :tasks</code> and the <code>default_scope</code> that <code>Task</code> has, the actual query that Rails executes becomes:</p>\n\n<pre><code>SELECT `entries`.* FROM `entries`\nINNER JOIN `tasks` ON `entries`.`task_id` = `tasks`.`id`\nWHERE `tasks`.`project_id` = 23\nORDER BY name asc, entries.date desc LIMIT 1 -- wrong order!\n</code></pre>\n\n<p>Note the <code>ORDER BY clause</code> - it includes the <code>default_scope</code> from <code>Task</code>, and only after that does it include the order I specified.</p>\n\n<p>So basically, I <em>don't</em> get the latest entry of all entries in the project, but only the latest in the first task.</p>\n\n<p>Is there any way around that? Seems like there should be a way to ignore/negate <code>default_scope</code> on a <code>through</code>-model (without completely dropping the <code>default_scope</code>)</p>\n"},{"tags":["ruby-on-rails","nested-attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13287411,"title":"accept_nested_attributes_for in a many-to-many relationship","body":"<p>I have tried to find a solution for this but most of the literature around involves how to create the form rather than how to save the stuff in the DB. The problem I am having is that the <code>accepts_nested_attributes_for</code> seems to work ok when saving modifications to existing DB entities, but fails when trying to create a new object tree.</p>\n\n<p>Some background. My classes are as follows:</p>\n\n<pre><code>class UserGroup &lt; ActiveRecord::Base\n    has_many :permissions\n    has_many :users\n\n    accepts_nested_attributes_for :users\n    accepts_nested_attributes_for :permissions\nend\n\nclass User &lt; ActiveRecord::Base\n    has_many :user_permissions\n    has_many :permissions, :through =&gt; :user_permissions\n\n    belongs_to :user_group\n\n    accepts_nested_attributes_for :user_permissions\nend\n\nclass Permission &lt; ActiveRecord::Base\n    has_many :user_permissions\n    has_many :users, :through =&gt; :user_permissions\n\n    belongs_to :user_group\nend\n\nclass UserPermission &lt; ActiveRecord::Base\n    belongs_to :user\n    belongs_to :permission\n\n    validates_associated :user\n    validates_associated :permission\n\n    validates_numericality_of :threshold_value\n    validates_presence_of :threshold_value\n\n    default_scope order(\"permission_id ASC\")\nend\n</code></pre>\n\n<p>The permission seem strange but each of them has a threshold_value which is different for each user, that's why it is needed like this.</p>\n\n<p>Anyway, as I said, when I <code>PUT</code> an update, for example to the threshold values, everything works ok. This is the controller code (UserGroupController, I am posting whole user groups rather than one user at a time):</p>\n\n<pre><code>def update\n    @ug = UserGroup.find(params[:id])\n    @ug.update_attributes!(params[:user_group])\n    respond_with @ug\nend\n</code></pre>\n\n<p>A typical data coming in would be:</p>\n\n<pre><code>{\"user_group\":\n    {\"id\":3,\n    \"permissions\":[\n        {\"id\":14,\"name\":\"Perm1\"},\n        {\"id\":15,\"name\":\"Perm2\"}],\n    \"users\":[\n        {\"id\":7,\"name\":\"Tallmaris\",\n         \"user_permissions\":[\n             {\"id\":1,\"permission_id\":14,\"threshold_value\":\"0.1\"},       \n             {\"id\":2,\"permission_id\":15,\"threshold_value\":0.3}]\n        },\n        {\"name\":\"New User\",\n         \"user_permissions\":[\n             {\"permission_id\":14,\"threshold_value\":0.4},\n             {\"permission_id\":15,\"threshold_value\":0.2}]\n        }]\n    }\n}\n</code></pre>\n\n<p>As you can see, the \"New User\" has no ID and his permission records have no ID either, because I want everything to be created. The \"Tallmaris\" user works ok and the changed values are updated no problem (I can see the UPDATE sql getting run by the server); on the contrary, the new user gives me this nasty log:</p>\n\n<pre><code>[...]\nUser Exists (0.4ms)  SELECT 1 AS one FROM \"users\" WHERE \"users\".\"name\" = 'New User' LIMIT 1\nModelSector Load (8.7ms)  SELECT \"user_permissions\".* FROM \"user_permissions\" WHERE (user_id = ) ORDER BY permission_id ASC\nPG::Error: ERROR:  syntax error at or near \")\"\n</code></pre>\n\n<p>The error is obviously the <code>(user_id = )</code> with nothing, since of course the user does not exists, there are no user_permissions set already and I wanted them to be created on the spot.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13282106,"title":"remote search form in rails 3","body":"<p>I am trying to implement a trivial asynchronous search form that would display the search results on the same page using AJAX. My code is below. The search results are rendered using a partial view. When the form is submitted I recreate an array of results and expect it to be displayed on the page. But this is not happening, the page does not get updated. I have been looking at rails for a day now, and I think it is trivial but I need help.</p>\n\n<p>route:</p>\n\n<pre><code>match 'search' =&gt; 'search#index'\n</code></pre>\n\n<p>controller:</p>\n\n<pre><code>class SearchController &lt; ApplicationController\n  def index\n    @results = params[:search] ? ['test0', 'test1', 'test2'] : []\n  end\nend\n</code></pre>\n\n<p>view <code>index.html.erb</code>:</p>\n\n<pre><code>&lt;%= form_tag search_path, :method =&gt; :get, :remote =&gt; true do %&gt;\n  &lt;%= text_field_tag :search %&gt;\n  &lt;%= submit_tag 'Search' %&gt;\n&lt;% end %&gt;\n&lt;div id=\"results\"&gt;\n  &lt;%= render :partial =&gt; 'results' %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>partial view <code>_results.html.erb</code>:</p>\n\n<pre><code>&lt;ul&gt;\n  &lt;% @results.each do |result| %&gt;\n    &lt;li&gt;\n      &lt;%= result %&gt;\n    &lt;/li&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","cdn"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13270175,"title":"Issue with using CDN and https: (Rails)","body":"<p>In my Rails application, i have used CDN. I have configured the cdn by adding cdn url to </p>\n\n<pre><code>config.action_controller.asset_host = \"http://cdn.mydomain.com\"\n</code></pre>\n\n<p>in production.rb file.</p>\n\n<p>Now i am trying to have <code>https://</code> for certain pages like <strong>Sign In and Sign Up</strong></p>\n\n<p>But as the assets are served from CDN, the https conflicts with the cdn path.</p>\n\n<p>My solution to this to make the sign in and sign up pages not to use the cdn assets and should point\nas local assets.</p>\n\n<p>is my solution correct? if so how do i restrict certain layout files from using CDN asset path?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","date","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13288871,"title":"getting error with dates ruby on rails 3","body":"<p>I have this on my model</p>\n\n<pre><code>Class User\n include Mongoid::Document\n  scope :created_between, lambda { |start_time, end_time| where(:created_at =&gt; (start_date...end_time)) }\n\n  class &lt;&lt; self\n    ## Class methods for calculating relative users\n\n    def created_today\n      today = Time.zone.now\n      created_between(today.beginning_of_day, today.end_of_day)\n    end\n\n    def created_yesterday\n      yesterday = Time.zone.now - 1.day\n      created_between(yesterday.beginning_of_day, yesterday.end_of_day)\n    end\n\n    def created_last_week\n      start_time = (Time.zone.now - 1.week).beginning_of_day\n      end_time = Time.zone.now\n      created_between(start_time, end_time)\n    end\n\n    def created_last_month\n      start_time = (Time.zone.now - 1.month).beginning_of_day\n      end_time = Time.zone.now\n      created_between(start_time, end_time)\n    end\n\n    def created_last_year\n      start_time = (Time.zone.now - 1.year).beginning_of_day\n      end_time = Time.zone.now\n      created_between(start_time, end_time)\n    end\n  end\n end\n</code></pre>\n\n<p>In my controller:</p>\n\n<pre><code> def index\n   @users_created_today = User.created_today.all\n   @users_created_today = User.created_today.all\n   @users_created_yesterday = User.created_yesterday.all\n   @users_created_last_week = User.created_last_week.all\n   @users_created_last_month = User.created_last_month.all\n   @users_created_last_year = User.created_last_year.all\n   .\n   .\n   .\n end\n</code></pre>\n\n<p>I get the next error:</p>\n\n<pre><code>undefined local variable or method `start_date' for User:Class\n</code></pre>\n\n<p>Thank you very much</p>\n"},{"tags":["ruby-on-rails","database","authentication","devise","authlogic"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":11810693,"title":"How can I add the first user to a Rails application that uses Authlogic, Devise, etc.?","body":"<p>I have a Ruby on Rails application which I cloned from a Git repo. It requires a login to do anything, such as register a new user. There are currently no registered users so I see myself as completely locked out</p>\n\n<p>I know the users are stored in a table called <code>users</code> but the underlying database is MySQL and I don't know how to access the database of a Ruby on Rails application.</p>\n\n<p>Does anyone know how I would go about adding a user?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3","erb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13287588,"title":"What is the scope of Ruby code in a js.erb file and how can it access controller variables","body":"<p>I have a js.erb file in which I want to use asset_path. It is included in a view like this:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"resources/gallery_resource\" %&gt;\n</code></pre>\n\n<p>This works fine while the asset path is self contained, however I need to use a variable defined in the controller (@resource) inside the asset path:</p>\n\n<pre><code>element.image = \"&lt;%= asset_path 'resources/galleries/'+@resource.uid+'/'+index+'.jpg' %&gt;\"\n</code></pre>\n\n<p>The problem being @resource is not defined. So what is the scope of this Ruby code if it doesn't have access to the controller? And how should I make the variable available here?</p>\n\n<p><em>I understand how to make the variable accessible to the Javascript, but I want to make it available to the embedded Ruby.</em></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13288812,"title":"Does this hit the db everytime?","body":"<p>If I have in: </p>\n\n<pre><code>config/initializers/foobar.rb \n</code></pre>\n\n<p>which has:</p>\n\n<pre><code>$foos = User.where(:foo =&gt; true).pluck(:id)\n</code></pre>\n\n<p>In my app when i call <code>$foo</code>, does it hit the db everytime?</p>\n\n<p>Or does <code>$foo</code> only hits the db, on server start?</p>\n"},{"tags":["ruby-on-rails","ruby","path","source","route"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":692,"score":0,"question_id":3420639,"title":"Where is the new_post_path, edit_post_path, posts_path ... lies in the source? I need to override them","body":"<p>Where is the <code>new_post_path</code>, <code>edit_post_path</code>, <code>posts_path</code> ... lies in the source? I need to override them.  </p>\n\n<p>my env:  </p>\n\n<ul>\n<li>ruby-1.9.2-preview</li>\n<li>rails-3.0.0.beta3</li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby","views","route","subfolder"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13234576,"title":"how to route your sub-folder in views Ruby on Rails?","body":"<p>Can anyone please shed some light on how to route your sub-folder's .html.erb files?? which is placed like this:</p>\n\n<pre><code>view/pages/en/index.html.erb\n</code></pre>\n\n<p>and to route this i am doing following things on route.rb</p>\n\n<pre><code>match ':lang/index', :to =&gt; 'pages/en#index'\n</code></pre>\n\n<p>and for a link code, I have this on the header</p>\n\n<pre><code>&lt;%= link_to \"Home\", index_path %&gt;\n</code></pre>\n\n<p>The error i am getting is </p>\n\n<pre><code> Routing Error\n uninitialized constant Pages\n</code></pre>\n\n<p>routes:</p>\n\n<p><img src=\"http://i.stack.imgur.com/NXi02.png\" alt=\"enter image description here\"></p>\n\n<p>Any help would be much appreciated! Thanks in advance</p>\n\n<p>===========================================================================</p>\n\n<pre><code>    **CHECK BELOW FOR SOLUTIONS THAT I HAVE PROVIDED**\n</code></pre>\n"},{"tags":["ruby-on-rails","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6,"score":1,"question_id":13288748,"title":"How to migrate mongoid model to model with same name?","body":"<p>So I have a User model using Mongoid::Documents and I'm adding some field and removing one.</p>\n\n<ol>\n<li>How do I move this model to the new model without downtime?</li>\n<li>Any traps I'm bound to find?</li>\n</ol>\n\n<p>(learning rails)</p>\n"},{"tags":["ruby-on-rails","rspec","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13288208,"title":"How to test webhooks / remote call backs?","body":"<p>I'm using rspec and capybara to write test cases to integrate with Cheddargetter (a payment solution provider). I have no problems testing my requests to CG's API however I'm not sure how to best test when CG's API giving a web callback to the Rails app.</p>\n\n<p>This is similar to PayPal's IPN feature, where after a customer has paid a web hook callback is sent to your app.</p>\n\n<p>Just wondering if anyone know what is the best way to test / simulate this?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13288079,"title":"Primary Key used as foreign key in another table","body":"<p>In rails 2, how can we find out that certain primary key in one table is used as foreign key in another table. Like I have a table punching_informations having 'id' as primary key. I want to find out that whether an 'id' from punching_informations table is used as foreign key in another table named punching_request. PunchingInformation has one PunchingRequest.</p>\n"},{"tags":["ruby-on-rails","url-routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13288459,"title":"URL encoding in rails","body":"<p>I have a url of the form \"users/:token/storage.json\"</p>\n\n<p>For example </p>\n\n<p>/users/DCpjIfaTjxHd73zN%2FqEM3KJzwg6DEeC56%2FuCCH34FoFLaubZJsm4TsAgnprGnBx2jN0X4uoV2YW1JFarQFSwXegKrkcwQOI8mooWUl5eE7PdFnPLh5%2FTOQ%3D%3D/storage.json</p>\n\n<p>I url encode the token before passing it in the url. This works fine on the development environment but in production the url gets decoded before hitting the routes file and this results in a different path as the token has a \"/\" in it.</p>\n\n<p>The application is built using rails 2.3.8. How can I avoid this problem?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13287741,"title":"find_or_initialize_by_title uniqueness","body":"<p>I've got a text_field for tags in a nested form(It's being associated with Trips) that is being split on a comma on save and saving the words in the string seperated by the comma. I've jumped through some hoops to make it happen, and it's happening as I want by now. The only downside is that it seems that it doesn't make the current tag a unique tag(If it exists associate the existing one with the new Trip instead of making a new tag)</p>\n\n<p>Here's the code splitting and saving the tag seperately:</p>\n\n<pre><code>if params[:trip][:tags_attributes].present?\n  params[:trip][:tags_attributes].each do |tag| \n   @a = tag[1]['title']\n   @a.split(',').each do |single|\n      @trip.tags.find_or_initialize_by_title(single)  \n   end\n  end\nend\n</code></pre>\n\n<p>And just in case my Trip.rb:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :user_id, \n  :triplocations_attributes, :photo, :category_ids, \n  :start_city, :tripphotos_attributes, :img_url, :thumb_url, :images,\n  :tags_attributes, :province\n\n  # validates :title, :length =&gt; {:minimum =&gt; 3}\n  # validates :description, :presence =&gt; true\n  # validates_associated :tags\n\n\n  has_many :triplocations, :dependent =&gt; :destroy\n  has_many :tripphotos, :dependent =&gt; :destroy\n\n  has_and_belongs_to_many :categories\n  has_and_belongs_to_many :tags\n\n\n  accepts_nested_attributes_for :triplocations, allow_destroy: true\n  accepts_nested_attributes_for :tripphotos, allow_destroy: true\n  accepts_nested_attributes_for :categories\n  accepts_nested_attributes_for :tags\n\nend\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":11,"score":-1,"question_id":13288051,"title":"RVM - Not able to use gem from global gemset","body":"<p>I installed 'pry' in global gemset. However I am not able to use it. That is when i use \"binding.pry\" in my code then it says - can't resolve 'pry'. I tried with : require 'pry' and load 'pry.rb' but no luck.</p>\n\n<pre><code>&lt;pre&gt;\nnikhil@nikhil-K54C:/media/media1/railscode/beasport$ rvm gemset list\n\ngemsets for ruby-1.9.3-p194 (found in /home/nikhil/.rvm/gems/ruby-1.9.3-p194)\n   (default)\n=&gt; beasport\n   composer_app\n   composer_app1\n   global\n   new_sample_app\n\nnikhil@nikhil-K54C:/media/media1/railscode/beasport$ gem which pry\n/home/nikhil/.rvm/gems/ruby-1.9.3-p194@global/gems/pry-0.9.10/lib/pry.rb\nnikhil@nikhil-K54C:/media/media1/railscode/beasport$ gem list | grep pry\npry (0.9.10)\npry-debugger (0.2.0)\npry-doc (0.4.4)\npry-stack_explorer (0.4.7)\nnikhil@nikhil-K54C:/media/media1/railscode/beasport$ rvm info\n\nruby-1.9.3-p194@beasport:\n\n  system:\n    uname:       \"Linux nikhil-K54C 3.2.0-32-generic-pae #51-Ubuntu SMP Wed Sep 26 21:54:23 UTC 2012 i686 i686 i386 GNU/Linux\"\n    system:      \"ubuntu/12.04/i386\"\n    bash:        \"/bin/bash =&gt; GNU bash, version 4.2.24(1)-release (i686-pc-linux-gnu)\"\n    zsh:         \" =&gt; not installed\"\n\n  rvm:\n    version:      \"rvm 1.16.6 (master) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\"\n    updated:      \"1 month 5 days 1 hour 7 minutes 39 seconds ago\"\n\n  ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.9.3p194\"\n    date:         \"2012-04-20\"\n    platform:     \"i686-linux\"\n    patchlevel:   \"2012-04-20 revision 35410\"\n    full_version: \"ruby 1.9.3p194 (2012-04-20 revision 35410) [i686-linux]\"\n\n  homes:\n    gem:          \"/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport\"\n    ruby:         \"/home/nikhil/.rvm/rubies/ruby-1.9.3-p194\"\n\n  binaries:\n    ruby:         \"/home/nikhil/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\"\n    irb:          \"/home/nikhil/.rvm/rubies/ruby-1.9.3-p194/bin/irb\"\n    gem:          \"/home/nikhil/.rvm/rubies/ruby-1.9.3-p194/bin/gem\"\n    rake:         \"/home/nikhil/.rvm/gems/ruby-1.9.3-p194@global/bin/rake\"\n\n  environment:\n    PATH:         \"./bundler_stubs:/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/bin:/home/nikhil/.rvm/gems/ruby-1.9.3-p194@global/bin:/home/nikhil/.rvm/rubies/ruby-1.9.3-p194/bin:/home/nikhil/.rvm/bin:/usr/local/java/jre1.7.0/bin:/usr/lib/lightdm/lightdm:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games\"\n    GEM_HOME:     \"/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport\"\n    GEM_PATH:     \"/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport:/home/nikhil/.rvm/gems/ruby-1.9.3-p194@global\"\n    MY_RUBY_HOME: \"/home/nikhil/.rvm/rubies/ruby-1.9.3-p194\"\n    IRBRC:        \"/home/nikhil/.rvm/rubies/ruby-1.9.3-p194/.irbrc\"\n    RUBYOPT:      \"\"\n    gemset:       \"beasport\"\n&lt;/pre&gt;\n</code></pre>\n\n<p>I am missing something.\nI check this question but not helpful for my case \n<a href=\"http://stackoverflow.com/questions/5952565/rvm-not-able-to-use-gems-from-the-global-gemset\">RVM - Not able to use gems from the @global gemset</a>\nThanks in advance for help.</p>\n"},{"tags":["ruby-on-rails","tomcat","routes","jruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":379,"score":0,"question_id":4403364,"title":"jRuby deployment into a subfolder in Tomcat","body":"<p>While developing a jRuby application using webbrick as the webserver, all my code is written with <a href=\"http://localhost:3000\" rel=\"nofollow\">http://localhost:3000</a> as the root.</p>\n\n<p>When deploying to Tomcat, I create a WAR file and it creates a subfolder under the webapps/ folder: localhost:8080/project_name/</p>\n\n<p>This causes a load of problems with my code. Is there anything I can do in my ruby routes.rb file to deal with this? </p>\n\n<p>Should I resort to using some sort of virtual host in Tomcat?</p>\n"},{"tags":["ruby-on-rails","authentication","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":179,"score":0,"question_id":10160855,"title":"Devise: Getting unique users via subdomain scope?","body":"<p>I have an application using Devise for authentication with different accounts based on subdomain.</p>\n\n<p>How can I separate Devise users and make e-mail only unique per subdomain scope?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","phusion-passenger","dragonfly-gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13237954,"title":"wrong URLs deploying to a subdirectory","body":"<p>in my view I have:</p>\n\n<pre><code>&lt;a href=\"&lt;%= @project.file.url %&gt;\"&gt;&lt;%= @project.file.name %&gt;&lt;/a&gt;\n</code></pre>\n\n<p>locally, in development, all works fine and I can download the file. But on my VPS in production I get a 404:</p>\n\n<pre><code>[Mon Nov 05 18:28:40 2012] [error] [client 88.7.246.152] File does not exist: \n  /srv/http/media, referer: http://www.stanosas.it/copisteria/projects/1\n</code></pre>\n\n<p>no trace in <code>log/production.log</code></p>\n\n<p><code>link_to</code> works fine.</p>\n\n<p>here is my Apache (Passenger) setup <a href=\"https://gist.github.com/4018657\" rel=\"nofollow\">https://gist.github.com/4018657</a></p>\n\n<p>I access my app in a subfolder like <code>www.myapp.com/copisteria</code></p>\n\n<p>here is <code>config/initializers/dragonfly.rb</code> <a href=\"https://github.com/enricostano/copisteria/blob/master/config/initializers/dragonfly.rb\" rel=\"nofollow\">https://github.com/enricostano/copisteria/blob/master/config/initializers/dragonfly.rb</a></p>\n\n<p>here is <code>config/application.rb</code> <a href=\"https://github.com/enricostano/copisteria/blob/master/config/application.rb\" rel=\"nofollow\">https://github.com/enricostano/copisteria/blob/master/config/application.rb</a></p>\n\n<p>any hint?</p>\n\n<p>EDIT: It seems that Apache or Passenger doesn't recognize the subdirectory in URLs.</p>\n"},{"tags":["ruby-on-rails","forms","browser","parameters"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":135,"score":3,"question_id":13174933,"title":"Why can't I post a form field with 'status' in the name?","body":"<p>Edit - clearly no-one has any idea what is vexing me here. I think it's just a matter of there being something that I've done elsewhere in the page that's blocking the status attribute being sent. The problem is I just can't see anything. I'm hoping someone has seen something similar and can suggest where I need to look.</p>\n\n<hr>\n\n<p>I have a dummy form on my page to post data to my web-app. It is created in Rails (using HAML) like so;</p>\n\n<pre><code>=form_tag bulk_invoice_path(''), method: 'put', class: 'mark-sent-form' do\n  =hidden_field_tag 'invoice[status]', 'Sent'\n</code></pre>\n\n<p>This generates the following html;</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"/bulk_invoices/\" class=\"mark-sent-form\" method=\"post\"&gt;\n  &lt;div style=\"margin:0;padding:0;display:inline\"&gt;\n    &lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;\n    &lt;input name=\"_method\" type=\"hidden\" value=\"put\" /&gt;\n    &lt;input name=\"authenticity_token\" type=\"hidden\" value=\"OU8GtbHycR/EJ+H3GG9MN59xI59v47LSaFc2wYZloAs=\" /&gt;\n  &lt;/div&gt;\n  &lt;input id=\"invoice_status\" name=\"invoice[status]\" type=\"hidden\" value=\"Sent\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>In the DOM, this appears as follows</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"/bulk_invoices/\" class=\"mark-sent-form\" method=\"post\"&gt;\n  &lt;div style=\"margin:0;padding:0;display:inline\"&gt;\n    &lt;input name=\"utf8\" type=\"hidden\" value=\"✓\"&gt;\n    &lt;input name=\"_method\" type=\"hidden\" value=\"put\"&gt;\n    &lt;input name=\"authenticity_token\" type=\"hidden\" value=\"OU8GtbHycR/EJ+H3GG9MN59xI59v47LSaFc2wYZloAs=\"&gt;\n  &lt;/div&gt;\n  &lt;input id=\"invoice_status\" name=\"invoice[status]\" type=\"hidden\" value=\"Sent\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>This form is posted with jquery (using coffeescript) like so;</p>\n\n<pre><code>jQuery -&gt;\n  $('a.mark-sent').click -&gt; updateBulkInvoices('.mark-sent-form')\n\nupdateBulkInvoices = (form) -&gt;\n  $(form).attr('action', \"/bulk_invoices/#{checkedInvoices().get().join()}\").submit()\n</code></pre>\n\n<p>This pattern has served me well with other actions but the 'invoice[status]' seems to be causing problems. When the form is submitted with jQuery the hidden field is not passed. I see the following in my Rails console;</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"+qW9kIih5l2j69w1LK2YfQ9mYQ7nKPDm5XgLZuKB4ic=\", \"id\"=&gt;\"16\"}\n</code></pre>\n\n<p>i.e. the invoice[status] field isn't being passed with the form parameters. If I change the name of this field to anything else it works just fine, e.g.</p>\n\n<pre><code>=form_tag bulk_invoice_path(''), method: 'put', class: 'mark-sent-form' do\n  =hidden_field_tag 'invoice[flatus]', 'sent'\n</code></pre>\n\n<p>gives me the following parameters in my console;</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"+qW9kIih5l2j69w1LK2YfQ9mYQ7nKPDm5XgLZuKB4ic=\", \"invoice\"=&gt;{\"flatus\"=&gt;\"sent\"}, \"id\"=&gt;\"16\"}\n</code></pre>\n\n<p>I see the same thing happening if I monitor the 'network' tab on Chrome's developer tools so I don't think it's a Rails thing, it seems to be a browser issue. I get the same thing with Safari and Firefox as well though.</p>\n\n<p>Is status some sort of magical reserved word in browser forms? What's going on here?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paypal","paypal-adaptive-payments"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13287615,"title":"Execute preapproval payment with rails & active_paypal_adaptive_payment","body":"<p>How can I execute a preapproved payment using active_paypal_adaptive_payment and rails?\nI have pre-approved payment set up (authorised by user) but I don't know how to execute the payment. Should I use execute_payment method? But what params does it take? I cannot find it in the documentation. Thanks for help.</p>\n"},{"tags":["ruby-on-rails","ruby","cucumber","saas"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":13109865,"title":"Cucumber doesn't test any defined step","body":"<p>I created just a feature file (AddMovie.feature) that contains:</p>\n\n<pre><code>Feature: User can manually add movie\n\nScenario: Add a movie\n Given I am on the RottenPotatoes home page\n When I follow \"Add new movie\"\n Then I should be on the Create New Movie page\n When I fill in \"Title\" with \"Men In Black\"\n And I select \"PG-13\" from \"Rating\"\n And I press \"Save Changes\"\n Then I should be on the RottenPotatoes home page \n And I should see \"Men In Black\"\n</code></pre>\n\n<p>When I execute cucumber to test it with the command:</p>\n\n<pre><code>bundle exec cucumber features/AddMovie.feature \n</code></pre>\n\n<p>I get this as a result:</p>\n\n<pre><code>Using the default profile...\nFeature:  User can manually add movie\n\n      Scenario:  Add a movie                              # features/AddMovie.feature:3\n        Given I am on the RottenPotatoes home page\n        When I follow \"Add new movie\"\n        Then I should be on the Create New Movie page\n        When I fill in \"Title\" with \"Men In Black\"\n        And I select \"PG-13\" from \"Rating\"\n        And I press \"Save Changes\"\n        Then I should be on the RottenPotatoes home page \n        And I should see \"Men In Black\"\n\n    1 scenario (1 passed)\n    0 steps\n</code></pre>\n\n<p>Normally this scenario will fail since i didn't add the path of \"the RottenPotatoes home page\". If you read the last line \"0 steps\" so cucumber is not running any step.</p>\n\n<p>How can I fix this ? and make cucumber testing the steps defined in AddMovie.feature ?</p>\n\n<p>PS: when I used the command cucumber features/Addmovies.feature\nI got this error</p>\n\n<pre><code>Using the default profile...\nYou have already activated activesupport 3.2.8, but your Gemfile requires activesupport 3.1.0. Using bundle exec may solve this. (Gem::LoadError)\n/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/runtime.rb:31:in `block in setup'\n/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/runtime.rb:17:in `setup'\n/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler.rb:107:in `setup'\n/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/setup.rb:7:in `&lt;top (required)&gt;'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n/home/ubuntu/Desktop/hw2_rottenpotatoes/config/boot.rb:6:in `&lt;top (required)&gt;'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/home/ubuntu/Desktop/hw2_rottenpotatoes/config/application.rb:1:in `&lt;top (required)&gt;'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/home/ubuntu/Desktop/hw2_rottenpotatoes/config/environment.rb:2:in `&lt;top (required)&gt;'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-rails-1.3.0/lib/cucumber/rails.rb:7:in `&lt;top (required)&gt;'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n/usr/local/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n/home/ubuntu/Desktop/hw2_rottenpotatoes/features/support/env.rb:7:in `&lt;top (required)&gt;'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/rb_support/rb_language.rb:129:in `load'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/rb_support/rb_language.rb:129:in `load_code_file'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:171:in `load_file'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:83:in `block in load_files!'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:82:in `each'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:82:in `load_files!'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:175:in `load_step_definitions'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:40:in `run!'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/cli/main.rb:43:in `execute!'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/cli/main.rb:20:in `execute'\n/usr/local/lib/ruby/gems/1.9.1/gems/cucumber-1.2.1/bin/cucumber:14:in `&lt;top (required)&gt;'\n/usr/local/bin/cucumber:19:in `load'\n/usr/local/bin/cucumber:19:in `&lt;main&gt;'\n</code></pre>\n\n<p>And It disappeared when I have added Bundle exec</p>\n"},{"tags":["ruby-on-rails","http","cucumber"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":292,"score":0,"question_id":5634178,"title":"[HTTP]how to change \"www.example.com\" to \"localhost:3000\"","body":"<p>hi I'm create test use cucumber in my rails apps. in my step scenario I used http basic authenticate, so far it pass the basic authenticate, but when I wanna to call method on controller and post some params, I had problem :</p>\n\n<p>first I use this code in step but failed not cross to method on controller : </p>\n\n<pre><code>post some_admin_url, @params\n</code></pre>\n\n<p>second I used this code, and failed also, the error is when running the URI.parse redirect to \"www.example.com\" I want to go \"localhost:3000/admin\", so I can match the data :</p>\n\n<pre><code>Net::HTTP.post_form(URI.parse(some_admin_url), {'from' =&gt; '2005-01-01','to' =&gt; '2005-03-31'}) { |i|  }\n</code></pre>\n\n<p>FUTURE :</p>\n\n<p>@selenium<br/>\n  Scenario: Admin want to activate user<br/>\n    Given one user logged in as admin<br/>\n    And admin page<br/></p>\n\n<p>STEPS :</p>\n\n<p>Given /^one user logged in as admin$/ do<br/>\n    create_user_admin<br/>\n    visit '/user_sessions/new'<br/>\n    fill_in 'user_session[login]', :with=>'siadmin'<br/>\n    fill_in 'user_session[password]', :with=>'12345'<br/>\n    click_button 'Anmelden'<br/>\n  end<br/><br/></p>\n\n<p>Given /^admin page$/ do<br/>\n    require \"net/http\"<br/>\n    require \"uri\"<br/><br/></p>\n\n<pre><code>uri = URI.parse(user_action_admin_users_url)&lt;br/&gt;\nhttp = Net::HTTP.new(uri.host, uri.port)&lt;br/&gt;\nrequest = Net::HTTP::Get.new(uri.request_uri)&lt;br/&gt;\nrequest.basic_auth(\"username\", \"password\")&lt;br/&gt;\nresponse = http.request(request)&lt;br/&gt;\n</code></pre>\n\n<p>end<br/></p>\n\n<pre><code>enter code here\n</code></pre>\n\n<p>HELP !!!</p>\n\n<p>THANKS</p>\n"},{"tags":["ruby-on-rails","ruby","loops"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13283239,"title":"how to iterating days","body":"<p>I have a code for looping days.this to make leaves. I want column signin and signout on attendance will filling automatically start at startdate and end at enddate.</p>\n\n<pre><code>exp I input :\nstartdate: 2012-11-08 01:30:00\nenddate: 2012-11-10 01:30:00\ni want output like this: \n\n2012-11-08 01:30:00\n2012-11-09 01:30:00\n2012-11-010 01:30:00\n\n for i in 0..((@leafe.enddate - @leafe.startdate).to_i)\n                 @attendance = Attendance.new\n\n                 @attendance.signin = '2012-11-08 01:30:00' #value must chang automatically\n                 @attendance.signout = '2012-11-08 10:30:00'#value must chang automatically\n                 @attendance.user_id = @leafe.user_id\n                 @attendance.save\n            end\n</code></pre>\n\n<p>thanks before</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","authentication","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13285634,"title":"Keeping POST data during sign up with Devise","body":"<p>I might be approaching this problem the wrong way ... so if you have a more elegant solution I'm all ears.</p>\n\n<p>Imagine I'm making a system like Kickstarter. I want my users to be able to specify how much they want to pledge before I ask them to sign up. </p>\n\n<p>Then, if they're not registered I need them to sign up before putting them back in the flow that they would have been on had they just signed in. Devise makes this easy by redirecting a user back to the <code>after_sign_up_path_for</code> which ends up being <code>after_sign_in_path_for</code> by default.</p>\n\n<p>So this will always issue a GET request. But if I have data that I received from the POST with the amount they wanted to pledge, but that's lost.</p>\n\n<p>Is the only way to do this to store that posted data in the session? Or is there a clever way to start creating the pledge record without the user (without needing to run jobs to destroy orphaned pledge records)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13208943,"title":"Rails Devise Strange behaviour with foreign key","body":"<p>I'm trying to create a simple User &amp; Address Model.</p>\n\n<p>I've created a nested form that has an address model nested into the User model. My User Model has the devise attributes etc.</p>\n\n<p>It all works fine, except that there's a strange behaviour happening when the user is created.</p>\n\n<p>If you read below, you'll notice the \"user_id\" which is the address of the owning user is populated when the record is first committed. But then immediately afterward, something that looks like it's in Devise core, is resetting the user_id to null.</p>\n\n<p>Does anyone know what would be causing this? </p>\n\n<blockquote>\n  <p>Started POST \"/users\" for 127.0.0.1 at 2012-11-03 22:45:20 +1100\n  Processing by Member::UsersController#create as HTML   Parameters:\n  {\"utf8\"=>\"✓\",\n  \"authenticity_token\"=>\"Pr8lSEJalWwosuaLPOrYqQ+sOkFCyoNujaUybxpZDAg=\",\n  \"user\"=>{\"address_attributes\"=>{\"first_name\"=>\"HOlley\",\n  \"last_name\"=>\"Hou\"}, \"email\"=>\"HollyHou@hisense.com.au\",\n  \"password\"=>\"[FILTERED]\", \"password_confirmation\"=>\"[FILTERED]\"}}\n  Creating a new user    (0.1ms)  BEGIN    (0.1ms)  COMMIT    (0.0ms) \n  BEGIN   Member::User Exists (0.3ms)  SELECT 1 AS one FROM\n  <code>member_users</code> WHERE <code>member_users</code>.<code>email</code> = BINARY\n  'hollyhou@hisense.com.au' LIMIT 1   SQL (0.2ms)  INSERT INTO\n  <code>member_users</code> (<code>created_at</code>, <code>current_sign_in_at</code>,\n  <code>current_sign_in_ip</code>, <code>email</code>, <code>encrypted_password</code>,\n  <code>last_sign_in_at</code>, <code>last_sign_in_ip</code>, <code>remember_created_at</code>,\n  <code>reset_password_sent_at</code>, <code>reset_password_token</code>, <code>sign_in_count</code>,\n  <code>updated_at</code>) VALUES ('2012-11-03 11:45:20', NULL, NULL,\n  'hollyhou@hisense.com.au',\n  '$2a$10$1JvC/sO85L2esNp8xA9qseTc78.rtOyF3zSBi/fOTiWJRt9.zgYha', NULL,\n  NULL, NULL, NULL, NULL, 0, '2012-11-03 11:45:20')   SQL (0.2ms) \n  INSERT INTO <code>member_addresses</code> (<code>address3</code>, <code>address_1</code>, <code>address_2</code>,\n  <code>address_type</code>, <code>business_name</code>, <code>city</code>, <code>country</code>, <code>created_at</code>,\n  <code>first_name</code>, <code>geo_late</code>, <code>geo_long</code>, <code>is_primary</code>, <code>last_name</code>,\n  <code>middle_name</code>, <code>phone1</code>, <code>phone1_type</code>, <code>phone2</code>, <code>phone2_type</code>,\n  <code>postcode</code>, <code>primary_email</code>, <code>secondary_email</code>, <code>state</code>, <code>status</code>,\n  <code>suburb</code>, <code>title</code>, <code>updated_at</code>, <code>user_id</code>) VALUES (NULL, NULL, NULL,\n  NULL, NULL, NULL, NULL, '2012-11-03 11:45:20', 'HOlley', NULL, NULL,\n  NULL, 'Hou', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,\n  NULL, NULL, NULL, '2012-11-03 11:45:20', 5)    (1.3ms)  COMMIT<br>\n  (0.1ms)  BEGIN    (0.2ms)  UPDATE <code>member_users</code> SET <code>last_sign_in_at</code>\n  = '2012-11-03 11:45:20', <code>current_sign_in_at</code> = '2012-11-03 11:45:20', <code>last_sign_in_ip</code> = '127.0.0.1', <code>current_sign_in_ip</code> = '127.0.0.1',\n  <code>sign_in_count</code> = 1, <code>updated_at</code> = '2012-11-03 11:45:20' WHERE\n  <code>member_users</code>.<code>id</code> = 5    (0.2ms)  COMMIT    (0.1ms)  BEGIN<br>\n  (0.2ms)  UPDATE <code>member_addresses</code> SET <code>user_id</code> = NULL, <code>updated_at</code>\n  = '2012-11-03 11:45:20' WHERE <code>member_addresses</code>.<code>id</code> = 5    (0.2ms)  COMMIT</p>\n</blockquote>\n\n<p>The controller is a custom controller because I eventually (once I get this working), need to be able to redirect to 2 different places after registration depending where the customer logged in from (checkout or header in this case).</p>\n\n<pre><code>class Member::UsersController &lt; Devise::RegistrationsController\n  def create\n    super\n  end\n\n  def new\n    super\n  end\n\n  def edit\n    Rails.logger.debug { \"Editing the user\" }\n    super\n  end\n\n  def show\n    Rails.logger.debug { \"Showing the user controller\" }\n  end\nend\n</code></pre>\n\n<p>and from routes.rb</p>\n\n<pre><code>  devise_for :users, :class_name =&gt; \"Member::User\", :controllers =&gt; {:registrations =&gt; 'member/users', :sessions =&gt; 'member/sessions'}\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13284062,"title":"Empty body function in jquery.js - Rails 3.2 with jQuery-rails gem","body":"<p>I have been developing a rails app for a week now. I use jquery-rails gem to use jQuery and everything was working fine. But today, when I started the development server, jQuery just wasn't loading. The console gave the error <code>jQuery not defined</code> and <code>$ not defined</code> and so forth. So I checked if the jQuery files are being included and they were. But when I clicked on the link to the <code>jquery.js</code> file, it contained only the following.</p>\n\n<pre><code>(function() {\n\n\n}).call(this);\n</code></pre>\n\n<p>jQuery just isnt working..</p>\n\n<p>This is how I have required the js libraries:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require twitter/bootstrap\n//= require bootstrap-datepicker/core\n//= require_tree .\n</code></pre>\n\n<p>I have tried interchanging bootstrap and jQuery and even tried removing jQuery and using only bootstrap. Nothing seems to be working. </p>\n\n<p>The funny part is that it was working perfectly till last night!! And I don't remember adding or removing any js libs. I was only writing Javascript code. So I have no clue as to what went wrong overnight.</p>\n\n<p>The only thing I haven't tried is serving jQuery from a CDN. But that is not an option considering where my app is going to be deployed. </p>\n\n<p>Please help. </p>\n\n<p>My Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\ngem 'will_paginate', '~&gt; 3.0.beta'\ngem 'will_paginate-bootstrap'\n\n\n#gem 'sqlite3'\ngem 'mysql2'\n#gem 'devise'\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n    gem 'twitter-bootstrap-rails'\n    gem 'less-rails'\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\ngem 'bootstrap-datepicker-rails'\ngem 'libv8'\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>UPDATE:</p>\n\n<p>Okay I have figured out what went wrong. I created a controller called <code>jquery</code> to simply test some jquery plugins and thus a <code>jquery.js.coffee</code> file was created under <code>/assets/javascripts</code>. When I removed this file and deleted the controller, everything started working fine. </p>\n\n<p>Can someone explain this behaviour?</p>\n"},{"tags":["ruby-on-rails","haml","user-input","erb"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":716,"score":0,"question_id":4881625,"title":"rails 3, erb (or haml), how can we restrict text input to 200 chars with nice user experience?","body":"<p>This SHOULD be trivially easy, but doesn't seem to be in Rails...</p>\n\n<p>we need to gather text input from the user of no more than 200 chars.</p>\n\n<p>if we use text_field, and set :maxlength to 200, we seem to have only two equally UGLY choices: (a) make the field soooooo wide using :size that it won't fit on a typical user's screen OR (b) the user has to scroll horizontally while typing. Either approach stinks from a UI point of view.</p>\n\n<p>what we WANT of course is to use text_area, and have it automatically limit the input to 200... but of course text_area has NO limit.</p>\n\n<p>we certainly don't want to wait until they SUBMIT the data to tell them \"that was too long\" or even worse simply truncate their data.</p>\n\n<p>any cool ideas? How do we have an input box say 100 chars wide and 3 lines tall that will not let the user type more than 200 characters?</p>\n\n<p>Is there some UI-enhancement framework that handles this sort of UI issue? Is adding a javascript counter in such a way that we apply it ONLY to certain input fields easy?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","cucumber","capybara"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13286712,"title":"Rspec test cases fails Failure/Error: fake_login SystemExit: exit","body":"<p>i'm working on a project and coding for test cases, every thing is fine but when i run whole test cases by</p>\n\n<p><strong>bundle exec rspec acceptance</strong>          .: acceptance is the folder where i have specs.rb files</p>\n\n<p>many of test cases fails and give error</p>\n\n<p><strong>Error:\n Failure/Error: fake_login\n     SystemExit:\n       exit</strong></p>\n\n<p>Any clue or help as i think this is not test case error.</p>\n"},{"tags":["ruby-on-rails","activerecord","activescaffold"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":217,"score":0,"question_id":6366263,"title":"Forcing ActiveScaffold to delete association rather than setting foreign key to null","body":"<p>I am using ActiveScaffold in an RoR 2.2 project. I have two models in my app:</p>\n\n<pre><code>class Foo &lt;&lt; ActiveRecord::Base\n belongs_to :bar\nend\n\nclass Bar &lt;&lt; ActiveRecord::Base\n has_many :foos\nend\n</code></pre>\n\n<p>When I edit a Bar instance, all the foo instances that belong to that bar are displayed in the form with a Remove button next to each one.</p>\n\n<p>When I remove one and then press the Update button, right now ActiveScaffold sets Foo.bar_id to <code>nil</code> and issues and update statement like <code>UPDATE foo set bar_id = null ...</code>.</p>\n\n<p>Is there a way to delete association from the database (i.e. <code>delete foo where foo_id = ...</code>) instead?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sinatra","resque"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":10435121,"title":"Resque error - /sinatra_adapter.rb:50:in `included': undefined method `before' for Sinatra::Request:Class (NoMethodError), when i start the rails app","body":"<p>I get error when I start the rails app. Just to give more information what I have done</p>\n\n<p>routes.rb has</p>\n\n<pre><code>mount Resque::Server, :at =&gt; \"/resque\"\nGemfile has \ngem 'rails', \"~&gt; 3.2.0\"\ngem 'resque', :require =&gt; 'resque/server'\n</code></pre>\n\n<p>when I start rails app I get this error</p>\n\n<pre><code>/usr/local/lib/ruby/gems/1.9.1/gems/authlogic-3.1.0/lib/authlogic/\ncontroller_adapters/sinatra_adapter.rb:50:in `included': undefined \nmethod `before' for Sinatra::Request:Class (NoMethodError)\n</code></pre>\n"},{"tags":["ruby-on-rails","rest","oauth","oauth-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13032160,"title":"OAuth callback URL parameters with Doorkeeper","body":"<p>I'm Using OAuth2 with Doorkeeper to protect my API.</p>\n\n<p>The problem is that one client had several different flows in which he redirects users to my OAuth flow.</p>\n\n<p>He would like to <strong>dynamically add some parameters</strong> when redirecting the user to my OAuth flow and <strong>get these parameters back</strong> when I'm calling his callback URL. This way he will be able to tell from which flow this callback originated.</p>\n\n<p>Is this possible with OAuth 2? with Doorkeeper? How?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Thanks Zólyomi István for your hint.\nI set the state parameter before calling the auth endpoint and got it back in the callback. However, I found that I get back a state parameter with some apparently random string even if I don't set anything. Any idea what it is? I'd like to be sure I'm not messing up anything...</p>\n"},{"tags":["ruby-on-rails","controller","presenter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":183,"score":0,"question_id":6884802,"title":"Name conflict between controller name and presenter namespace","body":"<p>I am using the presenter pattern and am seemingly running into inconsistent class naming conflicts.  I have a pages controller with a homepage method and I'd like to have that method use the Pages::HomepagePresenter class, but end up with the error:</p>\n\n<pre><code>uninitialized constant ActionController::Caching::Pages::HomepagePresenter\n     # ./app/controllers/pages_controller.rb:3:in `homepage'\n     # ./spec/requests/pages_spec.rb:14:in `block (5 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Assuming the problem is with the Pages controller and Pages namespace for the presenter, but there doesn't seem to be an issue when using Homepage controller and Homepage namespace for the presenter.</p>\n\n<p>Am I missing something?  Below are the combinations I've tried with how the app behaves:</p>\n\n<pre><code># Ideal, but this breaks with the aforementioned error\npresenters/pages/homepage_presenter.rb (class Pages::HomepagePresenter)\ncontrollers/pages_controller.rb (class PagesController)\n\n\n# Works\npresenters/page/homepage_presenter.rb (class Page::HomepagePresenter)\ncontrollers/pages_controller.rb (class PagesController)\n\n\n# Workes; I would expect this to break\npresenters/homepage/index_presenter.rb (class Homepage::IndexPresenter)\ncontrollers/homepage_controller.rb (class HomepageController)\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":255,"score":0,"question_id":3864385,"title":"How to integrate Resque plugin with rails 2.3.5 application?","body":"<p>I am trying to integrate my rails app with Resque plugin but in the doc it is not given that where should I write the code and how to use that code when running application. May be it is not understandable for me.</p>\n\n<p>It would be helpful for me if any one explain it with an example application.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13281784,"title":"Rails ActiveRecord query using inner join","body":"<p>I have two tables that I'm attempting to do an inner join with.</p>\n\n<p>One is a <code>users</code> table where the primary key is <code>id</code>. </p>\n\n<p>Another table is <code>bars</code> where <code>user_id</code> is a foreign key. <code>bars</code> also has a column called <code>foo_id</code> where <code>food_id</code> is a foreign key to the <code>foos</code> table. </p>\n\n<p>I am trying to put together an ActiveRecord query where I can select all users that were created on or before N days ago and do not have any <code>foos</code> where <code>bars.foo_id</code> equal to a particular id. I tried doing something like this:</p>\n\n<pre><code>users = User.where(\"users.created_at &lt;= ?\", 50.days.ago).joins(:bars).where(\"bars.foo_id != 5\")\n</code></pre>\n\n<p>This query fields over 30,000 results, which is incorrect, cause the Users table only has 12,000 rows. </p>\n\n<p>What exactly am I doing wrong here?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","factory-girl","shoulda"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12855128,"title":"shoulda factory girl error Couldn't find model without an ID","body":"<p>Good day, i get this error from</p>\n\n<pre><code> ActiveRecord::RecordNotFound:\n   Couldn't find User without an ID\n</code></pre>\n\n<p>my model</p>\n\n<pre><code> has_many :objects, class_name: 'OrderObject', dependent: :destroy\n  belongs_to :user\n  belongs_to :tariff\n\n  validates :client, :phone, :tariff_id, :days, :user_id, presence: true\n</code></pre>\n\n<p>spec</p>\n\n<pre><code> before do\n    user = FactoryGirl.create(:user)\n    FactoryGirl.create(:order, user_id: user.id)\n  end\n      context \"validations\" do\n       it { should validate_presence_of :client  }\n       it { should validate_presence_of :phone }\n       it { should validate_presence_of :tariff_id }\n       it { should validate_presence_of :days }\n      end\n\n      it { should have_many(:objects) } \n      it { should belong_to(:tariff) }\n      it { should belong_to(:user) }\n</code></pre>\n\n<p>factory</p>\n\n<pre><code>factory :order do\n    client \"MyString\"\n    phone \"MyString\"\n    tariff_id 1\n    days 1\n    # advt_payed_day 1\n    # firm_payed_day 1\n    user_id 1\n  end\n</code></pre>\n\n<p><strong>UPDATE 1</strong></p>\n\n<pre><code>changed to\n  before(:all) do\n   user = FactoryGirl.create(:user )\n   puts  user.id \n   order = FactoryGirl.create(:order, user_id: user.id ) \n   puts order.id\n\n  end\n</code></pre>\n\n<p>output</p>\n\n<pre><code>Order\n45\n32\n  should have many objects\n  should belong to tariff\n  should belong to user\n  validations\n    should require client to be set (FAILED - 1)\n    should require phone to be set (FAILED - 2)\n    should require tariff_id to be set (FAILED - 3)\n    should require days to be set (FAILED - 4)\n    should require user_id to be set (FAILED - 5)\n</code></pre>\n\n<p>so order &amp; user are created...</p>\n\n<p>Update 2\nas <strong>Rubyman</strong> suggested, i've changed couple of things:</p>\n\n<pre><code>in spec\n  before(:all) do\n   user = FactoryGirl.create(:user )\n   #puts  user.id \n   order = FactoryGirl.create(:order, user_id: user.id ) \n   puts order \n   puts order.user_id\n\n  end\n</code></pre>\n\n<p>in the factory</p>\n\n<pre><code>  factory :order do\n    client \"MyString\"\n    phone \"MyString\"\n    tariff_id 1\n    days 1\n    # user_id 1\n    association :user, factory: :user\n  end\n</code></pre>\n\n<p>and output is:</p>\n\n<pre><code>Order\n#&lt;Order:0x00000005a866a0&gt;\n46\n  should have many objects\n  should belong to tariff\n  should belong to user\n  validations\n    should require client to be set (FAILED - 1)\n    should require phone to be set (FAILED - 2)\n    should require tariff_id to be set (FAILED - 3)\n    should require days to be set (FAILED - 4)\n    should require user_id to be set (FAILED - 5)\n\n1) Order validations \n     Failure/Error: it { should validate_presence_of :client  }\n     ActiveRecord::RecordNotFound:\n       Couldn't find User without an ID\n     # ./app/models/order.rb:35:in `user_is_not_admin?'\n     # ./spec/models/order_spec.rb:14:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p><strong>update 3</strong>\nafter reading advice from <strong>tdgs</strong> here are the changes:\nin model no changes :</p>\n\n<pre><code>validates :client, :phone, :tariff_id, :days, :user_id, presence: true\n</code></pre>\n\n<p>in spec</p>\n\n<pre><code>describe Order do\n  before(:each) do\n   user = FactoryGirl.create(:user )\n   #puts  user.id \n   order = FactoryGirl.create(:order, user_id: user.id ) \n   puts order \n   puts order.user_id\n   puts order.tariff_id\n   puts order.phone\n   puts order.days\n   puts order.client\n   puts '*****'\n   user = User.find(order.user_id)\n   puts user.login\n\n  end\n  context \"validations\" do\n   it { should validate_presence_of :client  }\n   it { should validate_presence_of :phone }\n   it { should validate_presence_of :tariff_id }\n   it { should validate_presence_of :days }\n   it { should validate_presence_of :user_id }\n  end\n\n  it { should have_many(:objects) } \n  it { should belong_to(:tariff) }\n  it { should belong_to(:user) }\nend\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>#&lt;Order:0x00000006c10ce0&gt;\n161\n101\nMyString\n1\nMyString\n*****\nuser__7\n    should require days to be set (FAILED - 1)\n</code></pre>\n\n<p>output for every should is valid as far as i see...</p>\n\n<p>UPDATE N\nshould have written it in the beginning. i've run (hoped that it'll solve this issue) in console</p>\n\n<pre><code>bundle exec rake db:migrate\nbundle exec rake db:migrate:reset db:test:prepare\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","facebook","omniauth"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":433,"score":3,"question_id":8718949,"title":"Facebook Authenticated Referrals and OmniAuth","body":"<p>Is it possible to call or instantiate OmniAuth given that a <strong>authorization code</strong> for Facebook? Using authenticated referalls Facebook will append a <code>?code=ABC...</code> to the URL. </p>\n\n<p>Facebook <a href=\"http://developers.facebook.com/docs/authentication/\" rel=\"nofollow\">documentation</a> states that after receiving the <strong>authorization code</strong> one should then request the <strong>access token</strong>, however upon browsing through the omniauth-facebook gem this code already seems to <a href=\"https://github.com/intridea/omniauth-oauth2/blob/master/lib/omniauth/strategies/oauth2.rb\" rel=\"nofollow\">exist</a> (line 64). </p>\n\n<p>My reason for wanting to integrate with OmniAuth is to avoid duplicating the code just to get authenticated referrals working. Thanks!</p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":145,"score":3,"question_id":13044684,"title":"Ruby errors displayed within twitter bootstrap modal window","body":"<p>im using the twitter bootstrap framework within a rails app, what im trying to work out is how to render the errors within the window and not have a page reloaded.</p>\n\n<p>below is an example of the </p>\n\n<pre><code>#modalEvent.modal.hide\n  .modal-header\n    %button.close{\"data-dismiss\" =&gt; \"modal\", :type =&gt; \"button\"} ×\n    %h3 Schedule Form\n  = form_for(@schedule, :html =&gt; { :class =&gt; \"form-horizontal\"})  do |f|\n    .modal-body\n      - if @schedule.errors.any?\n        #notice.alert.alert-error\n          %button.close{\"data-dismiss\" =&gt; \"alert\"} ×\n          %strong Error:\n          = pluralize(@schedule.errors.count, \"error\")\n          prohibited #{event_display(@schedule.event)} from being\n          saved:\n          %ul\n            - @schedule.errors.full_messages.each do |msg|\n              %li= msg\n      .widget-content.nopadding\n        .control-group\n          = f.label :event_type, :class =&gt;'control-label'\n          .controls\n            = f.select :event, Schedule::EVENT_TYPES\n        #3{:style =&gt; 'display:none'}\n          .control-group\n            = f.label :name, :class =&gt;'control-label'\n            .controls\n              = f.text_field :result_id, :class =&gt; \"required error\"\n        .control-group\n          = f.label :date_and_time, :class =&gt;'control-label'\n          .controls\n            = f.text_field :time, :class =&gt; \"datepicker\", :required =&gt; :required, :type =&gt; :datetime, \"data-date-format\" =&gt;\"dd/mm/yyyy\"\n        .control-group\n          = f.label :duration, :class =&gt;'control-label'\n          .controls\n            .input-append\n              = f.number_field :duration, :placeholder =&gt; 'Time in Minutes', :required =&gt; :required\n              %span.add-on\n                %i.icon-time\n            %span.help-block Duration of event in minutes\n        .control-group\n          = f.label :arrival_time, :class =&gt;'control-label'\n          .controls\n            .input-append\n              = f.number_field :arrival_time, :placeholder =&gt; 'Time in Minutes', :required =&gt; :required\n              %span.add-on\n                %i.icon-time\n            %span.help-block Time in minutes before event\n        .control-group\n          = f.label :location, :class =&gt;'control-label'\n          .controls\n            = select(\"schedule\", \"location_id\", Location.all.collect { |p| [p.name, p.id] }, {:include_blank =&gt; 'None'})\n        .control-group\n          = f.label :players, :class =&gt;'control-label'\n          .controls\n            = select(:schedule, :selected_players, @players.map { |p| [full_name(p), p.id] }, {:include_blank =&gt; false}, \"data-placeholder\" =&gt; 'Add Players to Lineup', :prompt =&gt; 'Add Players to Lineup', :multiple =&gt; \"multiple\")\n        #1{:style =&gt; 'display:block'}\n          -if current_user.admin?\n            .control-group\n              = f.label :team, :class =&gt;'control-label'\n              .controls\n                = select(\"schedule\", \"team_id\", Team.all.collect { |p| [p.name, p.id] }, {:include_blank =&gt; 'None'})\n          - else\n            =f.hidden_field :team_id, :value =&gt; current_user.team_id\n          .control-group\n            = f.label :opponent, :class =&gt;'control-label'\n            .controls\n              = select(\"schedule\", \"opponent_id\", Opponent.all.collect { |p| [p.name, p.id] }, {:include_blank =&gt; 'None'})\n          .control-group\n            = f.label :home_or_away, :class =&gt;'control-label'\n            .controls\n              = f.select :home_or_away, Schedule::HOME_OR_AWAY, {:include_blank =&gt; 'None'}\n    .modal-footer\n      = f.submit 'Save Event', :class =&gt; 'btn btn-primary'\n      %a.btn.btn-danger{\"data-dismiss\" =&gt; \"modal\", :href =&gt; \"#\"} Cancel\n</code></pre>\n\n<p>controller</p>\n\n<pre><code>def create\n    @schedule = Schedule.new(params[:schedule])\n    @user = User.find(current_user)\n    @players = User.where(:team_id =&gt; current_user[:team_id]).all\n\n    respond_to do |format|\n      if @schedule.save\n        Notifier.event_added(@user,@schedule).deliver\n        format.html { redirect_to(schedules_url,\n                                  :notice =&gt; \"#{event_display_c(@schedule.event)} vs #{@schedule.opponent.name} was successfully created.\") }\n        format.json { render :json =&gt; @schedule, :status =&gt; :created, :location =&gt; @schedule }\n      else\n        format.html { render :action =&gt; \"new\" }\n        format.json { render :json =&gt; @schedule.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","terminal"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13249839,"title":"Rails IMGKit not working completely","body":"<p>I have a paperclip upload. And the goal is to upload a textfile, including a string like 'www.google.de'\nSo I tried in the terminal at first:</p>\n\n<pre><code>kit = IMGKit.new('http://www.google.com')\nfile = kit.to_file(Rails.root + 'google.jpg') \n</code></pre>\n\n<p>What was working perfectly.</p>\n\n<p>Then I put those lines in my create method of the according controller but I got a 502 proxy error.\nI moved those two lines to my model, and tried something like this:</p>\n\n<pre><code>after_create :save_from_string\n\ndef save_from_string\n  kit = IMGKit.new('http://www.google.com')\n  file = kit.to_file(Rails.root + 'google.jpg') \nend\n</code></pre>\n\n<p>But I still get:</p>\n\n<pre><code>Proxy Error\n\nThe proxy server received an invalid response from an upstream server.\nThe proxy server could not handle the request POST /users/14/albums/100043/elements.\n\nReason: Error reading from remote server\n</code></pre>\n\n<p>When I remove the second line, everything's fine. So at least  I don't get any errors.\nI am currently just trying to make it work somehow; I am still uploading a jpg, too to be sure, that this cannot be the problem.\nOf course, I also tried to use</p>\n\n<pre><code>touch tmp/restart.txt\n</code></pre>\n\n<p>But as soon as I use the second like again, I get 502.\nSo the upload from paperclip is working. The to_file command is working in the terminal, means, that the path is correct and available.</p>\n\n<p>What could I try ?</p>\n"},{"tags":["ruby-on-rails","ruby","console","irb"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13284277,"title":"Stop rails console from printing out the object at the end of a loop","body":"<p>If I, say, loop through all the instances of a given model and output something from each, at the end, irb will still print the entire object. </p>\n\n<p>If the object ends up taking hundreds of lines, it'll be a long way up before I see what I was actually looking for. Is there a way to disable this in the rails console?</p>\n"},{"tags":["ruby-on-rails","apache2","passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13284516,"title":"Strange percent-encoded urls","body":"<p>I'm putting a rails application on a server that already had Apache2 HTTP server running on it.  I installed ruby, rails, passenger, and other stuff for my RoR application, and set up the vHost for apache.</p>\n\n<p>Looking at my site, I'm getting some strange behavior:</p>\n\n<ul>\n<li><code>/login</code> redirects me to <code>/user_sessions/new/</code> successfully, but none of the css or javascript files are found.<br>\n<ul>\n<li><code>/assets/public.css</code> is redirected to <code>/assets/public.css%FF%FF%B9%7F</code> wihch yields a 404.</li>\n</ul></li>\n<li>On the second load, I am redirected to <code>/user_sessions/new/%EC%B8%7F</code> which yields a 404</li>\n</ul>\n\n<p>I'm suspecting some sort of URI encoding problem plus automatic cache busting URIs, but I don't know what could be causing it.  The logs give me:</p>\n\n<pre><code>Started GET \"/assets/public.css%ff%ff%b9%7f\" for (IP redacted) at 2012-11-08\nError compiling asset public.cssÿÿ¹^?:\nArgumentError: invalid byte sequence in UTF-8\n</code></pre>\n\n<p>The request for the page looks like this:</p>\n\n<pre><code>Started GET \"/login\" for (IP redacted) at 2012-11-08\nProcessing by HomeController#index as HTML\nRedirected to /user_sessions/new/\nCompleted 302 Found in 1ms (ActiveRecord: 0.0ms)\n\nStarted GET \"/user_sessions/new/%ac%da%7fA\" for (IP redacted) at 2012-11-08\nActionController::RoutingError (No route matches [GET] \"/user_sessions/new/%ac%da%7fA\")\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>I've found a <code>mod_url.conf</code> file in the apache configuration folder.  Its contents are as follows:</p>\n\n<pre><code>&lt;IfModule mod_url.c&gt;\nCheckURL On\nServerEncoding EUC-KR\nClientEncoding UTF-8\n&lt;/IfModule&gt;\n</code></pre>\n\n<p>Googling it doesn't give many English language results, and none that are obviously documentation.  Does anyone know what this mod_url is?</p>\n"},{"tags":["ruby-on-rails","validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13284802,"title":"What is the proper way to update partial fields in a model without triggering the rest of validation module?","body":"<p>Let's say I have a User model with many fields, like username, password, email, country etc. Now, I want to create a dedicated controller module for <strong>changing password</strong> only, but when I submit the password changing form (even this form only has two password fields), the rest of validation module in my User model will be triggered.</p>\n\n<p>I think my idea is quite common, so what would be the proper way or the rails way to deal with this problem?</p>\n"},{"tags":["ruby-on-rails","ruby","json"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13284697,"title":"Hash to_json and back does not preserve hashes as keys?","body":"<p>Anyone else having this issue?</p>\n\n<pre><code>hash_as_key = {'one' =&gt; 1, 'two' =&gt; 2}\nouter_hash = {hash_as_key =&gt; 3} \n\nouter_hash.keys[0].class\n=&gt; Hash\n\nas_json = outer_hash.to_json\nback_to_obj = JSON.parse(as_json)\n\nback_to_obj.keys[0]\n=&gt; \"{\\\"one\\\"=&gt;1, \\\"two\\\"=&gt;2}\"\nback_to_obj.keys[0].class\n=&gt; String\n</code></pre>\n\n<p>If you have a Hash object where a key is a hash itself, converting to JSON and reverting back to a Ruby object seems to turn the key into a String.</p>\n"},{"tags":["ruby-on-rails","activerecord","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13284926,"title":"Rails nested SQL with NOT IN condition","body":"<p>I currently have this code:</p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n  has_many :roles\n\n  #can't find better name for this method\n  def self.without_role_ids\n    find_by_sql('select id from groups where id not in\n      (select distinct group_id from roles)').map { |g| g.id }\n  end\nend\n\nclass Role &lt; ActiveRecord::Base\n  belongs_to :group\nend\n</code></pre>\n\n<p><code>without_role_ids</code> method outputs ids of groups that doesn't have any roles.</p>\n\n<p>What I'm trying to do is to rewrite this method:</p>\n\n<pre><code>def self.without_role_ids\n  where(\"id NOT IN (?)\", Role.pluck(:group_id))\nend\n</code></pre>\n\n<p>And it produces two queries.</p>\n\n<p>It is possible to run</p>\n\n<pre><code>where(id: Role.select(:group_id))\n</code></pre>\n\n<p>and it will produce exactly one SQL query, but with <code>IN</code> instead of <code>NOT IN</code> which I need.</p>\n\n<p>Is it possible to do <code>NOT IN</code> with one query without using find_by_sql?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13284726,"title":"How to perform sum and avg on few columns in rails","body":"<p>foo, foo_bar are expressed as ActiveModel classes</p>\n\n<pre><code>create table foo (id, captured_date)\ncreate table foo_bars (id, foo_id, val1, val2)\n\ninsert into foo (1, '2012-11-01')\ninsert into foo (2, '2012-11-02')\n\ninsert into foo_bars (1, 1, 1, 1)\ninsert into foo_bars (1, 1, 2, 2)\ninsert into foo_bars (1, 2, 3, 3)\ninsert into foo_bars (1, 2, 4, 4)\n</code></pre>\n\n<p>I am expected to show the following in a table (date, sum(val1), avg(val2))</p>\n\n<pre><code>2012-11-01 3 1.5\n2012-11-02 7 3.5\n_________________\n           10 2.5\n_________________\n</code></pre>\n\n<p>The above is sum(val1), avg(val2) across dates</p>\n\n<p>What would be the easiest way to achieve this using AR queries in your view. How should my view code look like and what queries should I use.</p>\n"},{"tags":["ruby-on-rails","regex"],"answer_count":4,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":4165,"score":5,"question_id":2576394,"title":"Remove all html tags from attributes in rails","body":"<p>I have a Project model and it has some text attributes, one is summary. I have some projects that have html tags in the summary and I want to convert that to plain text. I have this method that has a regex that will remove all html tags.</p>\n\n<pre><code>def strip_html_comments_on_data\n  self.attributes.each{|key,value| value.to_s.gsub!(/(&lt;[^&gt;]+&gt;|&amp;nbsp;|\\r|\\n)/,\"\")}\nend\n</code></pre>\n\n<p>I also have a before_save filter</p>\n\n<pre><code>before_save :strip_html_comments_on_data\n</code></pre>\n\n<p>The problem is that the html tags are still there after saving the project. What am I missing?</p>\n\n<p>And, is there a really easy way to have that method called in all the models?</p>\n\n<p>Thanks,</p>\n\n<p>Nicolás Hock Isaza</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13284064,"title":"Difference on working of object_id method with Fixnum object and String object","body":"<p>I am confused about the working of one of the innate method present in all ruby objects i.e object_id method. When I run object_id method on any Fixnum object again and again, for example in irb if I do this,</p>\n\n<blockquote>\n  <p>>>100.object_id<br>\n        =>201</p>\n</blockquote>\n\n<p>and do this again,</p>\n\n<blockquote>\n  <p>>>100.object_id<br>\n      =>201</p>\n</blockquote>\n\n<p>But when I work with String object for example </p>\n\n<blockquote>\n  <p>>>\"Hello\".object_id<br>\n      =>162333336</p>\n</blockquote>\n\n<p>and do this again,</p>\n\n<blockquote>\n  <p>>>\"Hello\".object_id<br>\n       =>15502236</p>\n</blockquote>\n\n<p>Why so? In ruby, everything is an object, and every object has an innate method named object_id which uniquely identifies the object. But here, ruby is confusing me as it treats two strings with same text (i.e \"Hello\") as different, but two Fixnum objects with same value (i.e.100) as the same and gives the same object id for them. Why so? Can any one please help me?</p>\n"},{"tags":["ruby-on-rails","datamapper","ruby-datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12951298,"title":"Class method returning NoMethodError: undefined method Rails","body":"<p>I am writing a class method to find certain data in my database however I am getting a NoMethodError: undefined method error. I am using Datamapper instead of ActiveRecord. Here is my error output:</p>\n\n<pre><code>NoMethodError: undefined method `get_courses_starting_in' for Course:Class\n    from /Users/hugo/.rvm/gems/ruby-1.9.2-p318/gems/dm-ar-finders-1.2.0/lib/dm-ar-finders.rb:155:in `method_missing_with_find_by'\n    from /Users/hugo/Web Development/Rails/connectedtrips/lib/ct_gems/dm-core-1.2.0/lib/dm-core/model/relationship.rb:372:in `method_missing'\n    from /Users/hugo/Web Development/Rails/connectedtrips/lib/ct_gems/dm-core-1.2.0/lib/dm-core/model/property.rb:249:in `method_missing'\n    from (irb):24\n    from /Users/hugo/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'\n    from /Users/hugo/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'\n    from /Users/hugo/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:41:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>And here is my class method:</p>\n\n<pre><code>def self.get_courses_starting_in\n    courses = []\n    Course.all.each{ |course| courses &lt;&lt; course if course.days_till_course_starts == 7}\n    return courses\n  end\n</code></pre>\n\n<p>I hope someone can help. Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13283367,"title":"Rails, how do load another page directly to a dashboard","body":"<p>i have a page call /informations which i want to load into my main /home page inside one of my div.</p>\n\n<p>i tried doing render :template, but i need to declare all the variables again in my home controller, is there anyway that i can do it, so that it does not only loads the view, it also loads the informations controller then the view.</p>\n\n<p>one method that i am using is link_to remote, then jquery div.html. but this is on click event and seems hackish to me, is there a proper way?</p>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":115,"score":2,"question_id":12980298,"title":"How do I replace the Heroku gem with Heroku Toolbelt?","body":"<p>I know that there are closely related question to mine but they did not help me.</p>\n\n<p>I'm learning the whole rails, gem, git, heroku concept and liking it a lot.\nWhen I issued heroku command line actions (Ubuntu linux) I received warnings that the gem was deprecated and I should install the toolbelt.\nI ran the full wget install of the tool belt: </p>\n\n<pre><code>wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh\n</code></pre>\n\n<p>But now when I use the heroku command line I still get the deprecated warning.\nI suspect I have to get rid of the heroku gem but I'm not sure how to do that ? I want to be sure to do it correctly so it's not later loaded again via bundler.\nThank you.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13284077,"title":"Rails railties gem error \"undefined method: 'less'\"","body":"<p>I've just recently updated my rails app's gems with <code>gem update</code> and <code>bundle update</code>. When I tried to test it out with <code>rails s</code> it gives me this error:</p>\n\n<p><code>/Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/railtie/configuration.rb:85:in</code>method_missing': undefined method <code>less' for #&lt;Rails::Application::Configuration:0x0000010308a300&gt; (NoMethodError)</code></p>\n\n<p>The rest of the error message goes like this:</p>\n\n<pre><code>from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/twitter-bootstrap-rails-2.1.6/lib/twitter/bootstrap/rails/engine.rb:15:in `block in &lt;class:Engine&gt;'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `instance_exec'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `run'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `each'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `run_initializers'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/application.rb:136:in `initialize!'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `method_missing'\n    from /Users/Richard/Code/Rails/rgsimms/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /Users/Richard/Code/Rails/rgsimms/config.ru:4:in `require'\n    from /Users/Richard/Code/Rails/rgsimms/config.ru:4:in `block in &lt;main&gt;'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n    from /Users/Richard/Code/Rails/rgsimms/config.ru:1:in `new'\n    from /Users/Richard/Code/Rails/rgsimms/config.ru:1:in `&lt;main&gt;'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands/server.rb:46:in `app'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands/server.rb:70:in `start'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:50:in `tap'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Is this an error with the Twitter Bootstrap gem? I'm still learning so how would I get this fixed? Any help is awesome.</p>\n"},{"tags":["ruby-on-rails","ruby","sms","payment-gateway","sms-gateway"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12083693,"title":"SMS payments platform for subscriptions?","body":"<p>On WhitePages.com they have a mechanism in place that facilitates payment by entering your telephone number.  After you enter your number, you get an SMS that instructs you to enter \"GO\" in order to complete the transaction.  Following that reply with the purchase you've made, you get another message suggesting that for a certain monthly fee you can use the service in an unlimited fashion.  I had not seen anything with quite those dynamics before and I'm curious of what service(s) one would use to construct a payment system like this for a Ruby on Rails app?</p>\n\n<p>I am particularly interested in a platform that allows this kind of payment from as many countries as possible as I currently use Twilio for SMS messaging on another app.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13283900,"title":"remote_function not working with f.select","body":"<p>I have a form in which I am using remote function in f.select like that.</p>\n\n<pre><code>&lt;%= f.select \"leave_type_id\", list_of_leave_type() , :onchange =&gt;  remote_function(:url =&gt; { :controller =&gt; \"user_leave_records\" ,:action =&gt; 'getUserLeaveQuota'}, :with =&gt; \"'leave_type_id=' + $('leave_type_id').value\")%&gt;\n</code></pre>\n\n<p>But it is not working, when i try using </p>\n\n<pre><code>&lt;%= select_tag \"leave_type_id\", list_of_leave_type() , :onchange =&gt;  remote_function(:url =&gt; { :controller =&gt; \"user_leave_records\" ,:action =&gt; 'getUserLeaveQuota'}, :with =&gt; \"'leave_type_id=' + $('leave_type_id').value\")%&gt;\n</code></pre>\n\n<p>It does works. \nWhy?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ajax","rest"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13283738,"title":"Pinging the server periodically with jQuery and Rails without a form, updating a table","body":"<p>I'm sort of a noob, so please bear with me!</p>\n\n<p>I'm trying to--when a user is signed in on the dashboard--have jQuery periodically ping the server every X seconds and update the user's 'heartbeat' with the current datetime and set 'online' to true.</p>\n\n<p>I'm probably missing some RESTful concepts and concepts involving communication between jQuery and Rails. Just finished Michael Hartl's Ruby on Rails Tutorial and am building off his sample app.</p>\n\n<p>I've done research, but answers mostly involve filling out a form; I want to do this without one.</p>\n\n<p>So I need to somehow pass into jQuery a :user_id and link it to the correct URI. I have a states controller and a states model that belongs_to a user (who has_one of them). Heartbeat and Online are in the states table.</p>\n\n<p>rake routes shows that: PUT    /states/:id(.:format)          states#update</p>\n\n<p><strong>states_controller.rb</strong></p>\n\n<pre><code>class StatesController &lt; ApplicationController\n  before_filter :signed_in_user, only: [:thump]\n  before_filter :correct_user,   only: [:thump]\n\n  def new\n  end\n  def update\n    @user = User.find(params[:id])\n    user.update_attributes(heartbeat: Time.now, online: true)\n\n    respond_to do |format|\n      format.js\n    end\n  end\nend\n</code></pre>\n\n<p><strong>application.js</strong></p>\n\n<pre><code>jQuery.ajaxSetup({ \n  'beforeSend': function(xhr) {xhr.setRequestHeader(\"Accept\", \"text/javascript\")}\n})\n\n// Periodically updates heartbeat\n$(function(){\n    setInterval (thump, 3000);\n    var js = '&lt;thump&gt; ';\n    function thump(){\n        console.log(js + 'Test');       \n        $.ajax({\n            url: 'states/update',\n            type: 'POST',\n            success: function(result) {\n                console.log(js + result);\n            }\n        });\n    }\n});\n</code></pre>\n\n<p>Thanks for the help.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13283471,"title":"how to make looping days ruby on rails?","body":"<p>I have a code for looping days.this to make leaves. I want column signin and signout on attendance will filling automatically start at startdate and end at enddate. </p>\n\n<pre><code>**exp I input :**\nstartdate: 2012-11-08 01:30:00\nenddate: 2012-11-10 01:30:00\n**i want output like this:** \n\n2012-11-08 01:30:00\n2012-11-09 01:30:00\n2012-11-010 01:30:00\n\n for i in 0..((@leafe.enddate - @leafe.startdate).to_i)\n                 @attendance = Attendance.new\n\n                 @attendance.signin = '2012-11-08 01:30:00' #value must change automatically\n                 @attendance.signout = '2012-11-08 10:30:00'#value must change automatically\n                 @attendance.user_id = @leafe.user_id\n                 @attendance.save\n            end\n</code></pre>\n\n<p>for your answer i say thanks</p>\n"},{"tags":["ruby-on-rails","habtm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13283662,"title":"Rails setting default attributes for HABTM based on parent (cousin?)","body":"<p>I have the following in my models:</p>\n\n<pre><code>class Category\n  has_many :sets, :items\n\nclass Set\n  belongs_to :category\n  has_and_belongs_to_many :items\n  validates_presence_of :category_id\n\nclass Item\n  belongs_to :category # this is mandatory\n  has_and_belongs_to_many :sets  # optional, an item doesn't necessary belong to a set\n  validates_presence_of :category_id\n</code></pre>\n\n<p>I want to set a <code>before_validation</code> filter on Item, so that if it belongs to a Set, but has no category_id set, to set category_id to equal the Set category_id.  In other words, I want the following to work in console:</p>\n\n<pre><code>a = Category.new(:name =&gt; 'foo')\na.save # id = 1\nb = a.sets.new(:name =&gt; 'bar') # category_id = 1\nb.save\nc = b.items.new(:name =&gt; 'baz') # category_id = nil, items_sets table record not yet created\nc.save  # validation error \n</code></pre>\n\n<p>Where do I set the <code>before_validation</code> filter?  Putting it in Item doesn't work, because before the item is saved, the join-table record is not created, and so <code>c.sets == []</code></p>\n\n<p>Or is there something I can override in Set, so that Set.items.new automatically puts the category_id of Item to be the same as Set?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13282241,"title":"Select box not keeping param value when validation errors occur - Rails 3","body":"<p>The problem I have is the select box in my view does not maintain the value selected if a validation error occurs.</p>\n\n<p>I have business and category relationship which has a many to many association</p>\n\n<p><code>category.rb</code></p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n    has_and_belongs_to_many :businesses\n</code></pre>\n\n<p><code>business.rb</code></p>\n\n<pre><code>class Business &lt; ActiveRecord::Base\n    has_and_belongs_to_many :categories\n</code></pre>\n\n<p>In my view I have a select field</p>\n\n<pre><code>&lt;%= f.select(:category_tokens, Category.all.collect {|c| [ c.name, c.id ] }, { :include_blank =&gt; \"Select Category\", :selected =&gt; params['category'] }}) %&gt;\n</code></pre>\n\n<p>I can access the business categories in the console using <code>business.categories</code> which returns and array.</p>\n\n<p>In my view to troubleshoot the params I've added.</p>\n\n<pre><code>&lt;%= @business.categories %&gt;\n&lt;%= @business.attributes.inspect %&gt;\n&lt;%= @business.user.attributes.inspect %&gt;\n</code></pre>\n\n<p>The output for these shows provides the following</p>\n\n<pre><code>[#&lt;Category id: 2, name: \"kitchen renovations\", created_at: \"2012-10-19 14:16:52\", updated_at: \"2012-10-19 14:16:52\"&gt;]\n\n{\"id\"=&gt;nil, \"business_name\"=&gt;\"\", ... additional attributes}\n\n{\"id\"=&gt;nil, \"email\"=&gt;\"\", ... additional attributes}\n</code></pre>\n\n<p>The params hash looks like this</p>\n\n<pre><code>Processing by BusinessesController#create as HTML\nParameters: {\"utf8\"=&gt;\"✓\",\n\"authenticity_token\"=&gt;\"fVz1mJZI8QT/HYKRph8YTvzRec0IVV0RS55v5QD5SL0=\", \n\"business\"=&gt;{\"category_tokens\"=&gt;\"2\", \n\"location\"=&gt;\"\", \"service_area\"=&gt;\"20\", \n\"business_name\"=&gt;\"\", \"abn_number\"=&gt;\"\", \n\"business_description\"=&gt;\"\", \n\"address\"=&gt;\"\", \"suburb\"=&gt;\"\", \n\"notification_type\"=&gt;\"\", \n\"user_attributes\"=&gt;{\"first_name\"=&gt;\"\", \"phone\"=&gt;\"\", \"email\"=&gt;\"\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\"}}, \"commit\"=&gt;\"Sign up my Business\"}\n</code></pre>\n\n<p>So the category is being set but I'm not sure how to add this to my select in the view to use the category as the select value when a validation error occurs.</p>\n\n<p>EDIT -- adding controller code ----</p>\n\n<pre><code>class BusinessesController &lt; ApplicationController\n\n  def new\n    @business = Business.new\n    @business.build_user\n  end\n\n  def create\n    @business = Business.new(params[:business])\n     respond_to do |format|\n      if @business.save\n         cookies[:auth_token] = @business.user.auth_token\n      format.html { redirect_to jobs_users_path, notice: 'Your business was successfully created.' }\n   else\n     format.html { render action: \"new\" }\n   end\n end\n</code></pre>\n\n<p>end</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","delayed-job"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":332,"score":0,"question_id":6180882,"title":"Delayed_job suddenly doesn't seem to do anything?","body":"<p>I have a scraper set up to use delayed_job so that it runs in the background.</p>\n\n<pre><code>class Scraper\n  def do_scrape\n    # do some scraping stuff\n  end\n  handle_asynchronously :do_scrape\nend\n</code></pre>\n\n<p>Now I can comment out the <code>handle_asynchronously</code> line, open the console and run the scraper just fine. It does exactly what I expect it to do.</p>\n\n<p>However, when I try to fire the scrape as a delayed job, it doesn't seem to do anything at all. Further to that, it doesn't seem to log anything important either.</p>\n\n<p>Here's how my log looks from enqueueing a job to running <code>rake jobs:work</code>.</p>\n\n<pre><code>County Load (1.0ms)  SELECT \"counties\".* FROM \"counties\" WHERE \"counties\".\"name\" = 'Fermanagh' LIMIT 1\n   (0.1ms)  BEGIN\n  SQL (20.5ms)  INSERT INTO \"delayed_jobs\" (\"attempts\", \"created_at\", \"failed_at\", \"handler\", \"last_error\", \"locked_at\", \"locked_by\", \"priority\", \"run_at\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING \"id\"  [[\"attempts\", 0], [\"created_at\", Mon, 30 May 2011 21:19:25 UTC +00:00], [\"failed_at\", nil], [\"handler\", \"--- \n\n# serialized object omitted for conciseness\n\nnmethod_name: :refresh_listings_in_the_county_without_delay\\nargs: []\\n\\n\"], [\"last_error\", nil], [\"locked_at\", nil], [\"locked_by\", nil], [\"priority\", 0], [\"run_at\", Mon, 30 May 2011 21:19:25 UTC +00:00], [\"updated_at\", Mon, 30 May 2011 21:19:25 UTC +00:00]]\n   (0.9ms)  COMMIT\n  Delayed::Backend::ActiveRecord::Job Load (0.4ms)  SELECT \"delayed_jobs\".* FROM \"delayed_jobs\" WHERE (locked_by = 'host:David-Tuites-MacBook-Pro.local pid:7743' AND locked_at &gt; '2011-05-30 17:19:32.116511') LIMIT 1\n   (0.1ms)  BEGIN\n  SQL (0.3ms)  DELETE FROM \"delayed_jobs\" WHERE \"delayed_jobs\".\"id\" = $1  [[\"id\", 42]]\n   (0.4ms)  COMMIT\n</code></pre>\n\n<p>As you can see, it seems to just inset a job and then delete it straight away? This scraping method should take at least a few minutes.</p>\n\n<p>The worst part is, it was working perfectly last night and I can't think of a single thing I'm doing differently. I tried fixing the gem to a previous version incase it was updated recently but doesn't seem to have fixed the problem.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13282900,"title":"Active Record validation :length error msg to show actual length?","body":"<p>I have a class that I am using a the validates method to check for length, and I want to inject the actual length into the error message. Is this possible?</p>\n\n<p>Here is my current class where I am using the validation:</p>\n\n<pre><code>class Something\n  validates :summary, :detail, :length =&gt; { \n    :in =&gt; 300..500,\n    :too_short =&gt; \"must have at least %{count} letters\",\n    :too_long =&gt; \"must have at most %{count} letters\"\n  }\n</code></pre>\n\n<p>And the error message shows:</p>\n\n<pre><code>2 errors prohibited this job from being saved.\n\nSummary must have at least 300 letters\nDetail must have at least 300 letters\n</code></pre>\n\n<p>But I'd like to show:</p>\n\n<pre><code>...\nSummary is only 250 letters and must have at least 300 letters\n...\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","delayed-job","worker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13281799,"title":"Heroku Delayed Job error","body":"<p>Google wasn't very helpful on this one, so I was hoping someone here might have an idea.</p>\n\n<p>My app works fine on server (and was recently working fine on heroku), but an hour or so ago, when I went to open a certain page on it (one that involves displaying information that is affected by a delayed_job I have running), I got a heroku error, and the logs say (among many other things):</p>\n\n<pre><code>dyno=web.1 queue=0 wait=5ms service=119ms status=500 bytes=643\n2012-11-07T23:17:44+00:00 app[worker.1]:    (1.3ms)  SELECT COUNT(*) AS count_all, priority AS priority FROM \"delayed_jobs\" WHERE (run_at &lt; '2012-11-07 23:17:44.830238' and failed_at is NULL) GROUP BY priority\n2012-11-07T23:17:44+00:00 app[worker.1]:    (2.5ms)  SELECT COUNT(*) FROM \"delayed_jobs\" WHERE (failed_at is not NULL)\n2012-11-07T23:17:44+00:00 app[worker.1]:    (1.2ms)  SELECT COUNT(*) FROM \"delayed_jobs\" WHERE (locked_by is not NULL)\n</code></pre>\n\n<p>Obviously, a problem with the delayed_job, but I'm not sure where to start looking, particularly considering how it was working before and still functions on my server. </p>\n\n<p>Any ideas what the problem is or how to start debugging?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13281553,"title":"ruby on rails shared error message cannot define method or object","body":"<p>I've been reading through the ruby on rails tutorial by michael hartl, and i'm at where I am trying to post microposts.  I'm trying to render an error message within the form, and the book says to assign f.object to object. It keeps giving me the error that \"object\" is an undefined local variable or method. Here is the code:</p>\n\n<p>shared/_error_messages.html.erb</p>\n\n<pre><code>&lt;% if object.errors.any? %&gt;\n&lt;div id=\"error_explanation\"&gt;\n    &lt;div class=\"alert alert-error\"&gt;\n        The form contains &lt;%= pluralize(object.errors.count, \"error\") %&gt;.\n    &lt;/div&gt;\n    &lt;ul&gt;\n        &lt;% object.errors.full_messages.each do |msg| %&gt;\n            &lt;li&gt;* &lt;%= msg %&gt;&lt;/li&gt;\n        &lt;% end %&gt;\n    &lt;/ul&gt;\n&lt;/div&gt;&lt;% end %&gt;\n</code></pre>\n\n<p>shared/_post_form.html.erb</p>\n\n<pre><code>&lt;%= form_for(@post) do |f| %&gt;\n &lt;%= render 'shared/error_messages', object: f.object %&gt;\n   &lt;div class=\"field\"&gt;\n&lt;%= f.text_area :content, placeholder: \"Compose new post...\" %&gt;\n   &lt;/div&gt;\n &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","activerecord","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":404,"score":3,"question_id":8205274,"title":"Rails 3.1.2 running very very slow. Seemingly a mysql2 ActiveRecord development mode issue","body":"<p>It seems the app is coming to a grinding halt in development mode in Rails 3.1.2. I'm using mysql database and am NOT using asset pipelines. Even the tests are running very very slowly.</p>\n\n<p>It's almost 20 times slower than Rails 3.1.1! </p>\n\n<p>Running in production mode is okay though. I'm using thin as my development server and I've got 8Gb RAM on my MBP. It's not my machine cos my other Rails apps are hunky dory.The only change that seems to be causing it is Rails 3.1.2 upgrade. And downgrading seems to bring the speed back up!</p>\n\n<p>Any clues as to what might be the reason or should we just expect Rails 3.1.3?</p>\n"}]}
{"total":93230,"page":3,"pagesize":100,"questions":[{"tags":["ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13282517,"title":"possible to set all items of a has_many relationship to a certain value without looping through them in Rails 3.1","body":"<p>Say I have in Rails 3.1:</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  has_many :items\nend\n\nclass Item &lt; ActiveRecord::Base\n  belongs_to :category\nend\n</code></pre>\n\n<p>I'd like to do something </p>\n\n<pre><code>cat=Category.find(1)\ncat.items.is_enabled=true\ncat.save\n</code></pre>\n\n<p>but can't and need to set each via a loop. Is there some way to just set these all at once?</p>\n\n<p>thx</p>\n"},{"tags":["ruby-on-rails","database","paperclip","photo-gallery","image-upload"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13280989,"title":"User photos album ruby on rails","body":"<p>I am building an app where user can upload pictures. For now only one picture at a time will do. I have searched around the Web and here at stackoverflow, but don't really seem to find what I am looking for or at least I don't know what I am looking for if it exists here at the site. \nI have tried implementing paperclip and allow users to upload pictures through that and not deleting the old picture when uploading a new one. But I don't really know where to go from here to display all the pictures that a user has uploaded. How do I do this the best way? Should I continue using paperclip or is there an even more suitable gem for my needs? </p>\n"},{"tags":["javascript","ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13282430,"title":"How can I require a javascript file for a particular resource in a ruby on rails site?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6167805/using-rails-3-1-where-do-you-put-your-page-specific-javascript-code\">Using Rails 3.1, where do you put your “page specific” javascript code?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a controller called course store and I wish to include an external js file from a third party only on that page. How can I do this?</p>\n"},{"tags":["ruby-on-rails","website","web-hosting"],"answer_count":4,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":995,"score":5,"question_id":2525239,"title":"Ruby on Rails website hosting","body":"<p>i want to start a website. it'll be a small community based website. i've learned a fair bit of ruby on rails and am planning to use it. however, i have never deployed a production website before. i've just practiced in my local computer. i wanted to know what are the things i need to deploy the website on the internet. what is the best place to get a domain name and web hosting, esp for ruby on rails sites. how are cloud based services like amazon EC2 etc different from a traditional web host. which is a better choice. what else might i need to do to deploy a website. also i may happen to have a fair bit of users in the future. so how to go about planning for scalability issues. how to sites like twitter, fmylife.com etc all go about these things.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":3,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13278710,"title":"has_many and belongs_to of the same model","body":"<p>I am pretty new to rails. I am trying to figure out the most efficient way to create a relationship between two models that states:</p>\n\n<ol>\n<li>A user can \"favorite\" many songs</li>\n<li>A song has an owner.</li>\n</ol>\n\n<p>This is what I am thinking of doing. Does it make sense ?</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_many :songs #songs this user has favorited\nend\n\nclass Song &lt; ActiveRecord::Base\n    belongs_to :user #the user whom submitted this song\nend\n</code></pre>\n\n<p>My concern about this method is that I'm unsure about the efficiency of doing query on every song in the database just to figure out which songs a particular user owns. Is there a different way I should be thinking about this ? </p>\n\n<p>By the way, is there a method by which I can call the attribute something different than it's model name. So rather than <code>User.find(1).songs[0]</code> I could say <code>User.find(1).favorites[0]</code> even though the model is still a \"Song\". </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13282445,"title":"Creating a secondary delete option","body":"<p>I've create a table that gets populated with status_updates by the user over time. Each status can be deleted individually. </p>\n\n<p>This is accomplished by calling the destroy method in the status_update_controller and having the particular status_update identified in a private method called correct_user.</p>\n\n<p>So basically it looks like this:</p>\n\n<p>At the top of my status_update_controller</p>\n\n<pre><code>before_filter :correct_user, only: :destroy\n</code></pre>\n\n<p>The destroy method</p>\n\n<pre><code>def destroy\n    @status_update.destroy\n    redirect_to root_url\nend    \n</code></pre>\n\n<p>and the private correct user method</p>\n\n<pre><code>private\n\n    def correct_user\n      @status_update = current_user.status_update.find_by_id(params[:id])\n      redirect_to root_url if @status_update.nil?\n    end  \n</code></pre>\n\n<hr>\n\n<p>My question is this:</p>\n\n<p>How can I select all of the status_updates for a particular user and destroy them using a button or link? </p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","mvc","haml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13262123,"title":"rails form_tag _path parameters","body":"<p>Although the question at '<a href=\"http://stackoverflow.com/questions/11762542/passing-multiple-parameters-in-a-form-tag\">Passing Multiple Parameters in a form_tag</a>' provides some information regarding how one can pass parameters within a form_tag the poster ultimately decided to pursue a different means of achieving said ends (specifically using hidden form fields).</p>\n\n<p>When attempting to use a line of code in a view like:</p>\n\n<pre><code>form_tag(movies_path({:foo = \"bar\"}), {:id =&gt; \"ratings_form\", :method =&gt; :get}) do\n</code></pre>\n\n<p>it seems as though RoR will not make the value of 'foo' available to the controller; is there another syntax which should be used to pass a parameter as part of the path in such a scenario?</p>\n\n<p>If one wishes to pass the parameter as part of the URL one would think such an approach would be correct (and, in fact, the HTML generated indicates as much since the resultant <code>&lt;form&gt;</code> tag contains an <code>action=\"/movies?foo=bar\"</code> statement)...  but the controller evaluates <code>params[:foo]</code> as <code>''</code> and not <code>bar</code>?)</p>\n"},{"tags":["ruby-on-rails","highcharts"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":12,"score":2,"question_id":13281657,"title":"Using highcharts with rails not displaying plotLines","body":"<p>I'm using the High Charts library with rails using the gem found <a href=\"https://github.com/agrobbin/highcharts-js-rails\" rel=\"nofollow\">here</a>.  Everything is working very nicely, except when I try and add a plotLine to either axis, I can't seem to figure it out.  Here are the two options that I've tried so far and their results.  Any insight into what is happening would be much appreciated.</p>\n\n<p>Option 1:</p>\n\n<pre><code>chart.yAxis([{title: 'Y-Axis', min: 0, plotLines: {value: 25}])\n</code></pre>\n\n<p>Result: I get an error in the JavaScript of</p>\n\n<pre><code>Uncaught TypeError: Object #&lt;Object&gt; has no method 'concat'\n</code></pre>\n\n<p>Specifically, this is referencing the following code in highcharts.js</p>\n\n<pre><code>each((options.plotLines || []).concat(options.plotBands || []), function (plotLineOptions) {\n    //plotLinesAndBands.push(new PlotLineOrBand(plotLineOptions).render());\n    axis.addPlotBandOrLine(plotLineOptions);\n});\n</code></pre>\n\n<p>When I pause the execution there the options.plotLines variable is an Object and not an Array, hence no concat method.  </p>\n\n<p>Option 2:</p>\n\n<pre><code>chart.yAxis([{title: '', min: 0, plotLines: [{value: 25}]}])\n</code></pre>\n\n<p>Result: The page fails to render with the following error message from Rails.</p>\n\n<pre><code>You must pass a Hash to Highcharts::Axis::PlotLines. You passed [{:value=&gt;25}]\n</code></pre>\n\n<p>I'm not sure what to make of this, however, given the API documentation of <a href=\"http://api.highcharts.com/highcharts#yAxis.plotLines\" rel=\"nofollow\">high charts</a> I would of expected this to work, as I would like to give more than 1 plotLine.</p>\n\n<p>I have also attempted to use chart.renderer.path but that has failed as well.  Can someone please explain what is going on, and hopefully suggest a way that I can draw a horizontal line across a High Charts graph in Rails with this gem.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","railstutorial.org"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":385,"score":0,"question_id":10884313,"title":"Michael Hartl Rails Tutorial chapter 7 error Action not found in UsersController","body":"<p>I'm following Michael Hartl's Rails Tutorial at the moment and I've managed to 7.22 without any major hitches. However I'm stumped by the output from the testing which says:</p>\n\n<pre><code>Failures:\n\n  1) UserPages signup with invalid information should not create a user\n     Failure/Error: expect{click_button submit }.not_to change(User, :count)\n     AbstractController::ActionNotFound:\n       The action 'create' could not be found for UsersController\n     # (eval):2:in `click_button'\n     # ./spec/requests/user_pages_spec.rb:29:in `block (5 levels) in &lt;top (required)&gt;'\n     # ./spec/requests/user_pages_spec.rb:29:in `block (4 levels) in &lt;top (required)&gt;'\n\n  2) UserPages signup with valid information should create a user\n     Failure/Error: expect{click_button submit}.to change(User, :count).by(1)\n     AbstractController::ActionNotFound:\n       The action 'create' could not be found for UsersController\n     # (eval):2:in `click_button'\n     # ./spec/requests/user_pages_spec.rb:42:in `block (5 levels) in &lt;top (required)&gt;'\n     # ./spec/requests/user_pages_spec.rb:42:in `block (4 levels) in &lt;top (required)&gt;'\n\nFinished in 0.7718 seconds\n6 examples, 2 failures\n</code></pre>\n\n<p>I've added the following to my users controllers page as instructed by the tutorial:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def show\n    @user = User.find(params[:id])\n  end\n\n  def new\n    @user = User.new\n  end\n\nend\n</code></pre>\n\n<p>but it still doesn't seem to work. I've tried adding a create method but that just throws back a missing template error...</p>\n\n<p>In case it helps here's the output of the rake routes command:</p>\n\n<pre><code>~/dev/rails/sample_app$ rake routes\n    users GET    /users(.:format)          users#index\n          POST   /users(.:format)          users#create\n new_user GET    /users/new(.:format)      users#new\nedit_user GET    /users/:id/edit(.:format) users#edit\n     user GET    /users/:id(.:format)      users#show\n          PUT    /users/:id(.:format)      users#update\n          DELETE /users/:id(.:format)      users#destroy\n     root        /                         static_pages#home\n   signup        /signup(.:format)         users#new\n     help        /help(.:format)           static_pages#help\n    about        /about(.:format)          static_pages#about\n  contact        /contact(.:format)        static_pages#contact\n</code></pre>\n\n<p>In response to a comment, the tests which are failing are:</p>\n\n<pre><code>   describe \"signup\" do\n\n      before{ visit signup_path }\n      let(:submit) {\"Create my account\"}\n\n      describe \"with invalid information\" do\n        it \"should not create a user\" do\n          expect{click_button submit }.not_to change(User, :count)\n        end\n      end\n\n      describe \"with valid information\" do\n        before do\n          fill_in \"Name\", with: \"Example User\"\n          fill_in \"Email\", with: \"user@example.com\"\n          fill_in \"Password\", with: \"foobar\"\n          fill_in \"Confirmation\", with: \"foobar\"\n        end\n\n        it \"should create a user\" do\n          expect{click_button submit}.to change(User, :count).by(1)\n        end\n      end\n    end\n</code></pre>\n\n<p>Thanks in advance for any advice!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":707,"score":1,"question_id":4557701,"title":"Ruby on Rails: how do I use a default placeholder thing in a select_tag?","body":"<pre><code> &lt;%= select_tag(:services, \n                       options_from_collection_for_select(Service.all, :id, :name))%&gt;\n</code></pre>\n\n<p>And it displays all the services...</p>\n\n<p>But I want it to be something like:</p>\n\n<pre><code>Select a service\nService1\nService2\nService3\nService4\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13219201,"title":"I woud like to tag my posts, using javascript and json","body":"<p>I am trying to generate a tagging system similar to SO. I am using the Select2 gem. When the user initially goes to the new page the form should only display their tags. When on the page they can create new tags by typing out tag names and separating them by spaces or commas. </p>\n\n<p>My issues is that when I go to submit this form, the tags are not properly linking to an ID. I get the error \"Couldn't find Tag with id = 0\" or if I have the number 12 as the tag, \"Couldn't find Tag with id = 12\"</p>\n\n<p>A user has_many tags; a post has many taggings; a post has many tags through taggings; a tag has many taggings; a tag has many posts through taggings; a tag belongs to an user</p>\n\n<p>How could I specify the tag id name and only have the tag name show up?</p>\n\n<p>My Tags Controller looks like this</p>\n\n<pre><code>  respond_to :json\n  def index\n    @tags = current_user.tags\n    respond_with(@tags.map{|tag| {:id =&gt; tag.id, :name =&gt; tag.name, :user_id =&gt; tag.user_id} })\n  end\n</code></pre>\n\n<p>My JavaScript looks like this</p>\n\n<pre><code>var items = [];\n$.getJSON('http://localhost:3000/tags.json', function(data) {\n        $.each(data, function(i, obj) {\n             return items.push(obj.name);\n        });\n   $(\"#post_tag_ids\").select2({\n        tags: items,\n        tokenSeparators: [\",\", \" \"]\n        });\n   });\n</code></pre>\n\n<p>My form looks like this</p>\n\n<pre><code>= semantic_form_for([@user, @post], :html =&gt; { :class =&gt; 'form-horizontal' }) do |f|\n  = f.inputs do\n    = f.input :summary, :label =&gt; false, :placeholder =&gt; \"Title\"\n    = f.input :tag_ids, :as =&gt; :string, :label =&gt; false, :placeholder =&gt; \"Tags\", input_html: {:id =&gt; \"post_tag_ids\", :cols =&gt; 71}\n  = f.buttons do\n    .action\n  = f.commit_button :button_html =&gt; { :class =&gt; \"btn btn-primary\" }\n</code></pre>\n\n<p>My Post Controller looks a little like this</p>\n\n<pre><code>def create\n @post = Post.new(params[:post])\n @post.user = current_user\n @post.save\n @post.tag!(params[:tag_ids], current_user.id)\nend\n</code></pre>\n\n<p>My Post Model has a tag! method</p>\n\n<pre><code>def tag!(tags, user)\n  tags = tags.split(\",\").map do |tag|\n    Tag.find_or_create_by_name_and_user_id(tag, user)\n  end\nself.tags &lt;&lt; tags\nend\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","ruby"],"answer_count":2,"favorite_count":13,"up_vote_count":10,"down_vote_count":0,"view_count":18104,"score":10,"question_id":698858,"title":"Link_to method and onClick event in Rails","body":"<p>I have a small problem. \nHow to create a link of this type:</p>\n\n<p><code>\na href=\"#\" onClick=\"document.getElementById('search').value=this.value\"\n</code></p>\n\n<p>using method 'link_to' in Rails?</p>\n\n<p>P.S. I write <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html\">http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html</a>, but I can not imagine how to make such a link.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13281997,"title":"Rails posts scaffold not parsing html","body":"<p>I'm trying to learn rails, and am using my blog as an excuse to do so. </p>\n\n<p>Right now, I'm playing around with the posts scaffold. I get the MVC and the idea behind it, so I was about to recreate it, when I ran accross the following error. </p>\n\n<p>If I enter content like </p>\n\n<pre><code>text\ntext\ntext\n</code></pre>\n\n<p>in the 'content' tag of posts form, It displays all the text as one block. </p>\n\n<pre><code>text text text\n</code></pre>\n\n<p>I thought I could try doing something like</p>\n\n<pre><code>&lt;p&gt;text&lt;/p&gt;\n&lt;p&gt;text&lt;/p&gt;\n&lt;p&gt;text&lt;/p&gt;\n</code></pre>\n\n<p>but, it shows </p>\n\n<pre><code>&lt;p&gt;text&lt;/p&gt;&lt;p&gt;text&lt;/p&gt;&lt;p&gt;text&lt;/p&gt;\n</code></pre>\n\n<p>What I'd like Rails to do is to actually parse the html in content. What would I do to get that to happen?</p>\n\n<p>Here's the New Form Partial, which I used to submit the content</p>\n\n<pre><code>&lt;%= form_for(@post) do |f| %&gt;\n  &lt;% if @post.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@post.errors.count, \"error\") %&gt; prohibited this post from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @post.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :content %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :content %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here's the Posts Controller as a whole</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  # GET /posts\n  # GET /posts.json\n  def index\n    @posts = Post.paginate(page: params[:page])\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @posts }\n    end\n  end\n\n  # GET /posts/1\n  # GET /posts/1.json\n  def show\n    @post = Post.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @post }\n    end\n  end\n\n  # GET /posts/new\n  # GET /posts/new.json\n  def new\n    @post = Post.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @post }\n    end\n  end\n\n  # GET /posts/1/edit\n  def edit\n    @post = Post.find(params[:id])\n  end\n\n  # POST /posts\n  # POST /posts.json\n  def create\n    @post = Post.new(params[:post])\n\n    respond_to do |format|\n      if @post.save\n        format.html { redirect_to @post, notice: 'Post was successfully created.' }\n        format.json { render json: @post, status: :created, location: @post }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @post.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /posts/1\n  # PUT /posts/1.json\n  def update\n    @post = Post.find(params[:id])\n\n    respond_to do |format|\n      if @post.update_attributes(params[:post])\n        format.html { redirect_to @post, notice: 'Post was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @post.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /posts/1\n  # DELETE /posts/1.json\n  def destroy\n    @post = Post.find(params[:id])\n    @post.destroy\n\n    respond_to do |format|\n      format.html { redirect_to posts_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n"},{"tags":["mysql","sql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13278741,"title":"Mysql MATCH AGAINST and IN","body":"<p>I need to search some data in my database. But main problem is that i search with match against:</p>\n\n<pre><code>...MATCH(description) AGAINST (\"*52*\" in boolean mode)\n</code></pre>\n\n<p>But on one iteration (or more, but with one query) i must search not only for 52, but for <code>50,51,52,...,59</code>  as before...\nBut is it real to do? \nAlso i do it with RoR:</p>\n\n<pre><code> @accums = Accumulator.find(:all, :conditions =&gt; [\"MATCH(description) AGAINST (? in boolean mode)\", size])\n</code></pre>\n\n<p>Or i will need to do iterator on rails, and search for all of them iteration by iteration?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13213911,"title":"Manifest.yml empty","body":"<p>Whenever I run <code>rake assets:precompile</code>, I get a <code>manifest.yml</code> file that looks like:</p>\n\n<pre><code>--- {}\n</code></pre>\n\n<p>Something must be going wrong. Here is my output for <code>rake assets:precompile --trace</code>:</p>\n\n<pre><code>** Invoke assets:precompile (first_time)\n** Execute assets:precompile\n/Users/user/.rvm/rubies/ruby-1.9.3-p194/bin/ruby /Users/user/.rvm/gems/ruby-1.9.3-p194@global/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace\n** Invoke assets:precompile:all (first_time)\n** Execute assets:precompile:all\n** Invoke assets:precompile:primary (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke tmp:cache:clear (first_time)\n** Execute tmp:cache:clear\n** Execute assets:precompile:primary\n** Invoke assets:precompile:nondigest (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke tmp:cache:clear (first_time)\n** Execute tmp:cache:clear\n** Execute assets:precompile:nondigest\n</code></pre>\n\n<p>Can someone help?? Thanks!</p>\n\n<h2>UPDATE:</h2>\n\n<p>Feel free to look at my code at <a href=\"http://www.github.com/sambaek/novulty\" rel=\"nofollow\">www.github.com/sambaek/novulty</a></p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13280927,"title":"Ruby on Rails - continually looping through the new/create action with AJAX","body":"<p>I have a Rails controller set up that when a user creates a new record, it will redirect again to the new action and populate the form with new data, and this can continue on in a loop, creating a new record and getting redirected to the new action.  What I am having trouble with is adding AJAX to this so that the user can stay in this loop without the page reloading.  Here is my code without AJAX:</p>\n\n<pre><code>class ResponsesController\n def new\n   @response = Response.new\n   @answer_a = Answer.find(rand(1..100))\n   @answer_b = Answer.find(rand(1..100))\n   @answer_c = Answer.find(rand(1..100))\n end\n\n def create\n   @response = current_user.responses.build(params[:response])\n   if @response.save\n      respond_to do |format|\n        format.html { redirect_to new_response_path }\n        format.js\n      end\n   else\n      render 'new'\n   end\n end\nend\n</code></pre>\n\n<p><strong>new.html.erb</strong></p>\n\n<pre><code> &lt;div id=\"response_form\"&gt;\n   &lt;%= render 'form' %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code> &lt;%= form_for @response do |f| %&gt;   \n    &lt;%= f.radio_button :user_answer, @answer_a.id %&gt; \n    &lt;%= @answer_a.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_b.id %&gt; \n    &lt;%= @answer_b.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_c.id %&gt; \n    &lt;%= @answer_c.description %&gt;\n    &lt;%= f.submit \"Answer\" %&gt;                \n &lt;% end %&gt;\n</code></pre>\n\n<p>Below is my attempt to add AJAX.  However, it is going to the show action and doing an update.  How can I fix my code so that it keeps redirecting to the new action and the user can continue to create new records on an infinite loop?</p>\n\n<pre><code> def create\n   @answer_a = Answer.find(rand(1..100))\n   @answer_b = Answer.find(rand(1..100))\n   @answer_c = Answer.find(rand(1..100))\n   @response = current_user.responses.build(params[:response])\n   if @response.save\n      respond_to do |format|\n        format.html { redirect_to new_response_path }\n        format.js\n      end\n   else\n      render 'new'\n   end\n end\n</code></pre>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code> &lt;%= form_for @response, :remote =&gt; true do |f| %&gt;  \n    &lt;%= f.radio_button :user_answer, @answer_a.id %&gt; \n    &lt;%= @answer_a.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_b.id %&gt; \n    &lt;%= @answer_b.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_c.id %&gt; \n    &lt;%= @answer_c.description %&gt;\n    &lt;%= f.submit \"Answer\" %&gt;                \n &lt;% end %&gt;\n</code></pre>\n\n<p><strong>create.js.erb</strong></p>\n\n<pre><code> $('#response_form').html('&lt;%= j render(\"form\") %&gt;');\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","ajax","ujs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13281804,"title":"Re enable Rails UJS links after ajax event","body":"<p>I have a custom ajax method that replaces some content on the page with a partial. That partial has rails remote links in it. They don't function when they've been inserted by my script. Is there something I can trigger to rebind the rails UJS functionality to the links?</p>\n\n<p>Here's the basic setup (simplified):</p>\n\n<p>model/_my_partial.html.haml</p>\n\n<pre><code>%p Some nifty content is available here:\n%p= link_to 'page', page_path, :remote =&gt; true\n</code></pre>\n\n<p>model/show.html.haml</p>\n\n<pre><code>= link_to 'Reload some stuff', '#', :id =&gt; 'customAjax'\ndiv#my_partial= render 'my_partial'\n</code></pre>\n\n<p>controllers/model_controller.rb</p>\n\n<pre><code>partial = render_to_string 'my_partial'\nrespond_to do |format|\n  format.js { render :json =&gt; { :partial =&gt; partial }\nend\n</code></pre>\n\n<p>javascripts/my_ajax.js.coffee</p>\n\n<pre><code>$(a#customAjax).click -&gt;\n  event.PreventDefault()\n  $.ajax\n    ...\n    success: (data, status, xhr) -&gt;\n      $('div#my_partial').html( data.partial )\n</code></pre>\n\n<p>This functions as expected, and on the first page load any rails UJS links inside the partial work perfectly, but after they've been replaced via my custom ajax they quit working.</p>\n"},{"tags":["ruby-on-rails","osx-mountain-lion"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":20,"score":-1,"question_id":13281801,"title":"Upgrade to Mountain Lion Broke Rails","body":"<p>I'm new to rails, and I recently upgraded to mountain lion from lion. Rails worked for a while, but my git commands stopped working briefly. </p>\n\n<p>Then, today I tried to start the rails server, and it tells me that rails is not installed and I should run sudo gem install rails to install it. The only thing that I've done since running rails s last was restart my computer. </p>\n\n<p>I tried installing rails, again, and nothing happens. </p>\n\n<p>Thanks </p>\n"},{"tags":["ruby-on-rails","ruby","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13274708,"title":"How to format multiline RSpec expect {}.to change","body":"<p>Is there a better way to format this test to make it more readable?</p>\n\n<pre><code>expect { \n  within '.foo' do\n    click_link 'Delete'\n  end\n}.to change {Foo.count}.by 1\n</code></pre>\n\n<p>expect <code>do...end</code> works, but is even uglier...</p>\n"},{"tags":["ruby-on-rails","rake"],"answer_count":5,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":2978,"score":8,"question_id":1325865,"title":"What is the standard way to dump db to yml fixtures in rails?","body":"<p>I've seen some plugins and custom rake tasks to dump the active db to fixtures, but I'm not sure what the prevailing technique is.</p>\n\n<p>Basically, I want the opposite of rake:db:fixtures:load so that I can put basic db information (the admin user account, for one) into svn for when we deploy. I don't want to have to create fixtures manually for things like sample data that would take a long time.</p>\n\n<p>When we deploy I want to be able to just run</p>\n\n<pre><code>rake db:migrate\nrake db:fixtures:load\n</code></pre>\n\n<p>And be off to the races.</p>\n\n<p>What is the best/preferred method for doing this in rails?</p>\n\n<p>EDIT:</p>\n\n<p>So it seems there is no standard way to do an opposite rake task of db:fixtures:load.</p>\n\n<p>I don't want to use migrations, because I want a standard way of doing this for all my projects, and I don't like the idea of putting any more than maybe the admin account in a migration. Second, I've been rethinking the idea of using the fixtures. I've decided on using yaml_db because it uses rake tasks:</p>\n\n<pre><code>rake db:data:dump\nrake db:data:load\n</code></pre>\n\n<p>The data will wind up in a YAML file without distrupting test fixtures (which could be different, now that I think about this more carefully). Also, if a major distribution tool like Heroku is using it, I don't have to worry about support/longevity issues. </p>\n\n<p>I suppose this is closest to \"standard\" that I will find.</p>\n\n<p>Thanks for all the great responses.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solr","sunspot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13280386,"title":"friendly SEO urls with sunspot and rails 3","body":"<p>How can create SEO friendly url using using sunspot?</p>\n\n<p>I want to convert a search from this:</p>\n\n<pre><code>http://localhost:3000/restaurant?utf8=&amp;search=newyork\n</code></pre>\n\n<p>To something like this:</p>\n\n<pre><code>http://localhost:3000/restaurant/newyork\n</code></pre>\n"},{"tags":["ruby-on-rails","cucumber","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13256391,"title":"With Capybara, how can I tell whether the driver currently being used supports JavaScript?","body":"<p>In my Rails application, I have a set of cucumber acceptance tests that test various pages of my application. With cucumber, tagging a specific test (scenario) with <code>@javascript</code> causes that scenario to run using a JavaScript driver instead of a simpler driver that does not support JavaScript.</p>\n\n<p>Is there an easy way for my tests to determine whether they are currently being run with a driver that supports JavaScript or one that doesn't? I want this so that I can make my tests behave slightly differently if they are being run with JavaScript enabled.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","memcached","dalli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13281488,"title":"uninitialized constant Dalli (NameError) in staging but not production","body":"<p>So I get a <code>uninitialized constant Dalli (NameError)</code> when I push my ruby on rails app to my staging on heroku, but it works fine in production. my <code>production.rb</code> and <code>staging.rb</code> files are the exact same except for a mailer host value. Could someone help? Thanks!</p>\n\n<p>production.rb:</p>\n\n<pre><code>Novulty::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Enable Rails's static asset server\n  config.serve_static_assets = true\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Compress CSS using yui-compressor gem\n  config.assets.css_compressor = :yui\n\n  # Compress JS using uglifier gem\n  config.assets.js_compressor = :uglifier\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  config.force_ssl = false\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  config.assets.precompile += %w[ *.js *.css ]\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.raise_delivery_errors = false\n  config.action_mailer.default :charset =&gt; \"utf-8\"\n\n  # Use SMTP to send mail\n  config.action_mailer.delivery_method = :smtp\n\n  # Use Gmail to send smtp mail\n  config.action_mailer.smtp_settings = {\n    :address              =&gt; \"smtp.gmail.com\",\n    :port                 =&gt; 587,\n    :domain               =&gt; \"novulty.com\",\n    :user_name            =&gt; ENV[\"GMAIL_USERNAME\"],\n    :password             =&gt; ENV[\"GMAIL_PASSWORD\"],\n    :authentication       =&gt; :plain,\n    :enable_starttls_auto =&gt; true\n  }\n\n  # Specify what domain to use for mailer URLs\n  config.action_mailer.default_url_options = {\n    host: \"novulty.com\"\n  }\n\n  # Specify how long an item should stay cached by setting the Cache-Control headers\n  config.static_cache_control = \"public, max-age=2592000\"\n\n  # Specify Dalli as the storage backends for Rails’ built-in Rack::Cache integration\n  config.action_dispatch.rack_cache = {\n    :metastore    =&gt; Dalli::Client.new,\n    :entitystore  =&gt; 'file:tmp/cache/rack/body',\n    :allow_reload =&gt; false\n  }\nend\n</code></pre>\n\n<p>staging.rb:</p>\n\n<pre><code>Novulty::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Enable Rails's static asset server\n  config.serve_static_assets = true\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Compress CSS using yui-compressor gem\n  config.assets.css_compressor = :yui\n\n  # Compress JS using uglifier gem\n  config.assets.js_compressor = :uglifier\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  config.force_ssl = false\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  config.assets.precompile += %w[ *.js *.css ]\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.raise_delivery_errors = false\n  config.action_mailer.default :charset =&gt; \"utf-8\"\n\n  # Use SMTP to send mail\n  config.action_mailer.delivery_method = :smtp\n\n  # Use Gmail to send smtp mail\n  config.action_mailer.smtp_settings = {\n    :address              =&gt; \"smtp.gmail.com\",\n    :port                 =&gt; 587,\n    :domain               =&gt; \"novulty.com\",\n    :user_name            =&gt; ENV[\"GMAIL_USERNAME\"],\n    :password             =&gt; ENV[\"GMAIL_PASSWORD\"],\n    :authentication       =&gt; :plain,\n    :enable_starttls_auto =&gt; true\n  }\n\n  # Specify what domain to use for mailer URLs\n  config.action_mailer.default_url_options = {\n    host: \"novultystaging.herokuapp.com\"\n  }\n\n  # Specify how long an item should stay cached by setting the Cache-Control headers\n  config.static_cache_control = \"public, max-age=2592000\"\n\n  # Specify Dalli as the storage backends for Rails’ built-in Rack::Cache integration\n  config.action_dispatch.rack_cache = {\n    :metastore    =&gt; Dalli::Client.new,\n    :entitystore  =&gt; 'file:tmp/cache/rack/body',\n    :allow_reload =&gt; false\n  }\nend\n</code></pre>\n\n<p>production.rb:</p>\n\n<pre><code>require File.expand_path('../boot', __FILE__)\n\nrequire 'rails/all'\n\nif defined?(Bundler)\n  # If you precompile assets before deploying to production, use this line\n  Bundler.require(*Rails.groups(:assets =&gt; %w(development test)))\n  # If you want your assets lazily compiled in production, use this line\n  # Bundler.require(:default, :assets, Rails.env)\nend\n\nmodule Novulty\n  class Application &lt; Rails::Application\n    # Settings in config/environments/* take precedence over those specified here.\n    # Application configuration should go into files in config/initializers\n    # -- all .rb files in that directory are automatically loaded.\n\n    # Custom directories with classes and modules you want to be autoloadable.\n    # config.autoload_paths += %W(#{config.root}/extras)\n\n    # Only load the plugins named here, in the order given (default is alphabetical).\n    # :all can be used as a placeholder for all plugins not explicitly named.\n    # config.plugins = [ :exception_notification, :ssl_requirement, :all ]\n\n    # Activate observers that should always be running.\n    # config.active_record.observers = :cacher, :garbage_collector, :forum_observer\n\n    # Set Time.zone default to the specified zone and make Active Record auto-convert to this zone.\n    # Run \"rake -D time\" for a list of tasks for finding time zone names. Default is UTC.\n    # config.time_zone = 'Central Time (US &amp; Canada)'\n\n    # Use dalli cache store in production\n    config.cache_store = :dalli_store\n\n    # The default locale is :en and all translations from config/locales/*.rb,yml are auto loaded.\n    # config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]\n    # config.i18n.default_locale = :de\n\n    # Add Font-Awesome support (add app/assets/font to the asset path)\n    config.assets.paths &lt;&lt; Rails.root.join(\"app\", \"assets\", \"fonts\")\n\n    # Configure the default encoding used in templates for Ruby 1.9.\n    config.encoding = \"utf-8\"\n\n    # Configure sensitive parameters which will be filtered from the log file.\n    config.filter_parameters += [:password]\n\n    # Enable escaping HTML in JSON.\n    config.active_support.escape_html_entities_in_json = true\n\n    # Use SQL instead of Active Record's schema dumper when creating the database.\n    # This is necessary if your schema can't be completely dumped by the schema dumper,\n    # like if you have constraints or database-specific column types\n    # config.active_record.schema_format = :sql\n\n    # Enforce whitelist mode for mass assignment.\n    # This will create an empty whitelist of attributes available for mass-assignment for all models\n    # in your app. As such, your models will need to explicitly whitelist or blacklist accessible\n    # parameters by using an attr_accessible or attr_protected declaration.\n    config.active_record.whitelist_attributes = true\n\n    # Enable the asset pipeline\n    config.assets.enabled = true\n\n    # Version of your assets, change this if you want to expire all your assets\n    config.assets.version = '1.0'\n\n    config.assets.initialize_on_precompile = false\n  end\nend\n</code></pre>\n\n<p>Here is the output of <code>heroku logs --tail --remote staging</code>:</p>\n\n<pre><code>2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:571:in `block in &lt;class:Engine&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n2012-11-08T02:04:59+00:00 app[web.1]: /app/config/environments/staging.rb:96:in `block in &lt;top (required)&gt;': uninitialized constant Dalli (NameError)\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:24:in `class_eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:24:in `configure'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config/environments/staging.rb:1:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:4:in `require'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:4:in `block in &lt;main&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:1:in `new'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from script/rails:6:in `require'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:70:in `start'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:46:in `app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n2012-11-08T02:04:59+00:00 app[web.1]:   from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Feel free to check out my code at <a href=\"http://www.github.com/sambaek/novulty\" rel=\"nofollow\">www.github.com/sambaek/novulty</a></p>\n"},{"tags":["html","ruby-on-rails","ruby","watir"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13280947,"title":"How to get value of a hidden element? (Watir)","body":"<p>just wondering, how can I get the value of a hidden element using watir? This is the element:</p>\n\n<pre><code>&lt;input type=\"hidden\" value=\"randomstringhere\" id=\"elementid\" name=\"elementname\" /&gt;\n</code></pre>\n\n<p>And this is my code atm:</p>\n\n<pre><code>require \"rubygems\"\nrequire \"watir-webdriver\"\n$browser = Watir::Browser.new :ff\n$browser.goto(\"http://www.site.com\")\n$grabelement = $browser.hiddens(:id, \"elementid\")\n$blah = $grabelement.attribute_value(\"value\")\nputs $blah\n</code></pre>\n\n<p>This gets stuck at the last line, where it returns </p>\n\n<pre><code>code.rb:6:in `&lt;main&gt;': undefined method `attribute_value' for #&lt;Watir::HiddenCollection:0x8818adc&gt; (NoMethodError)\n</code></pre>\n\n<p>Sorry for the basic question, I've had a search and couldn't find anything.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13280458,"title":"Using Delegate with Counter Cache","body":"<p>I have the following models:</p>\n\n<pre><code>User(id, projects_count, tasks_count)\nhas_many :projects\nhas_many :tasks, :through =&gt; :projects\n\nProject(user_id, name)\nhas_many :tasks\nbelongs_to :user, :counter_cache =&gt; :projects_count\n\nTask(task_id, title)\nbelongs_to :project\ndelegate :user, :to =&gt; :project, :allow_nil =&gt; true\n</code></pre>\n\n<p>In the <code>Task</code> model in the delegate method, How can use counter cache just like <code>belongs_to</code> to increment <code>Project.tasks_count</code></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":56,"score":-1,"question_id":13281114,"title":"Hashes and Curly Braces in Ruby Methods","body":"<p>I have this method in one of my view files:</p>\n\n<pre><code>&lt;%= link_to \"Sign up now!\", signup_path, class: \"btn\", id: \"some_id\" %&gt;\n</code></pre>\n\n<p>Is this correct, or would I have to attach the curly braces around the two hashes like so:</p>\n\n<pre><code>&lt;%= link_to \"Sign up now!\", signup_path, { class: \"btn\", id: \"some_id\" } %&gt;\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","database","performance","postgresql"],"answer_count":2,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":933,"score":17,"question_id":9407442,"title":"Optimise PostgreSQL for fast testing","body":"<p>I am switching to PostgreSQL from SQLite for a typical Rails application.</p>\n\n<p>The problem is that running specs became slow with PG.<br>\nOn SQLite it took ~34 seconds, on PG it's ~76 seconds which is <strong>more than 2x slower</strong>.</p>\n\n<p>So now I want to apply some techniques to <strong>bring the performance of the specs on par with SQLite</strong> with no code modifications (ideally just by setting the connection options, which is probably not possible).</p>\n\n<p>Couple of obvious things from top of my head are:</p>\n\n<ul>\n<li>RAM Disk (good setup with RSpec on OSX would be good to see)</li>\n<li>Unlogged tables (can it be applied on the whole database so I don't have change all the scripts?)</li>\n</ul>\n\n<p>As you may have understood I don't care about reliability and the rest (the DB is just a throwaway thingy here).<br>\nI need to get the most out of the PG and make it <strong>as fast as it can possibly be</strong>.</p>\n\n<p><strong>Best answer</strong> would ideally describe the <em>tricks</em> for doing just that, setup and the drawbacks of those tricks.</p>\n\n<p><strong>UPDATE:</strong> <code>fsync = off</code> + <code>full_page_writes = off</code> only decreased time to ~65 seconds (~-16 secs). Good start, but far from the target of 34.</p>\n\n<p><strong>UPDATE 2:</strong> I <a href=\"https://gist.github.com/1573414\">tried to use RAM disk</a> but the performance gain was within an error margin. So doesn't seem to be worth it.</p>\n\n<p><strong>UPDATE 3:*</strong>\nI found the biggest bottleneck and now my specs run as fast as the SQLite ones.</p>\n\n<p>The issue was the database cleanup that did the <strong>truncation</strong>. Apparently SQLite is way too fast there.</p>\n\n<p>To \"fix\" it I open a <strong>transaction</strong> before each test and roll it back at the end.</p>\n\n<p>Some numbers for ~700 tests.</p>\n\n<ul>\n<li>Truncation: SQLite - 34s, PG - 76s.</li>\n<li>Transaction: SQLite - 17s, PG - 18s.</li>\n</ul>\n\n<p>2x speed increase for SQLite.\n4x speed increase for PG.</p>\n"},{"tags":["ruby-on-rails","svn","tortoisesvn","aptana"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":11820000,"title":"installing source control with Aptana","body":"<p>I am using Aptana Studio 3, build: 3.2.1.201207261642, I want to add my code any kind of source control for managability. Its just a pet project , which I am doing to learn ruby on rails. </p>\n\n<p>When install SVN through aptana IDE , I am getting the following error. </p>\n\n<p>Am I missing pre-requisites?</p>\n\n<p><img src=\"http://i.stack.imgur.com/5cFvj.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails","rspec","railstutorial.org"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":13,"score":3,"question_id":13281043,"title":"How does @user.save work in user_spec.rb? (rails tutorial chapter 6)","body":"<p>I am doing the Ruby on Rails Tutorial and am up to <a href=\"http://ruby.railstutorial.org/chapters/modeling-users#code-authenticate_spec\" rel=\"nofollow\">Listing 6.29</a>.  It describes the testing of a (seemingly standard) user authentication process.</p>\n\n<p><strong>My problem is understanding the following (edited) part of the user_spec.rb file:</strong></p>\n\n<pre><code>describe User do\n\nbefore do\n    @user = User.new(name: \"Example User\", email: \"user@example.com\", \n                 password: \"foobar\", password_confirmation: \"foobar\")\nend\n\nsubject { @user }\n\ndescribe \"return value of authenticate method\" do\n    before { @user.save }\n    let(:found_user) { User.find_by_email(@user.email) }\n\n    describe \"with valid password\" do\n       it { should == found_user.authenticate(@user.password) }\n    end\n\n    describe \"with invalid password\" do\n       let(:user_for_invalid_password) { found_user.authenticate(\"invalid\") }\n\n       it { should_not == user_for_invalid_password }\n       specify { user_for_invalid_password.should be_false }\n   end\nend\nend\n</code></pre>\n\n<p><strong>My main confusion is the line:</strong></p>\n\n<pre><code>before { @user.save }\n</code></pre>\n\n<p>Does this really save the test user in the database?  Won't saving this test user before testing the correctness of its password make the test redundant?  <strong>It looks to me like I'm merely saving the user (with its password) and then checking if it still has the same password</strong> (with which I just saved it!)  Is someone able to clarify why I'm mistaken?</p>\n"},{"tags":["ruby-on-rails","ruby","email","serialization","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13264424,"title":"How to serialize and deserialise mailers?","body":"<p>How can I serialise the mailer so that it can be stored for further use?</p>\n\n<p>The serialised data should be disconnected and self sufficient to be delivered on separate machine that should deliver that message (not knowing about database or anything else).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13277938,"title":"Rails joins query","body":"<p>I have three models</p>\n\n<ul>\n<li><code>Tag</code> => <code>:id</code>, <code>:name</code></li>\n<li><code>Tagging</code> => <code>:id</code>, <code>:tag_id</code>, <code>:post_id</code></li>\n<li><code>Post</code> => <code>:id</code>, <code>:summary</code></li>\n</ul>\n\n<p>I know the id of the tag. I would like to query for all of the posts that have a specific <code>tag_id</code>, through the <code>Taggings</code> model.</p>\n\n<p>Something like</p>\n\n<pre><code>@post = Post.joins(:taggings).where(:tag_id =&gt; 17)\n</code></pre>\n\n<p>but this doesn't work because it is looking for the tag_id in the <code>Post</code> model and not the <code>Tagging</code> model. </p>\n\n<p>I'm not sure how to do this.</p>\n"},{"tags":["ruby-on-rails","twitter"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13281007,"title":"Rails: Including the '@' as part of a username link when using Twitter Text gem","body":"<p>I'm currently using the (frankly amazing) Twitter Text gem to automatically set up links within a tweet's status for a Twitter widget I'm building.</p>\n\n<p>However, when using the auto_link functionality on usernames (i.e. @adamt), it drops the '@' from the link text, outputting something like:</p>\n\n<pre><code>@&lt;a href=\"twitter.com/adamt\"&gt;adamt&lt;/a&gt;\n</code></pre>\n\n<p>Does anyone know of a simple way to include in the '@' inside that link using the Twitter Text gem?</p>\n"},{"tags":["ruby-on-rails","controller","render","params"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13277047,"title":"multiple controllers in one view (ruby on rails MVC)","body":"<p>Hey guys I need your valuable help. In the <a href=\"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book\" rel=\"nofollow\">Ruby on Rails tutorial</a>, at the 10th chapter, the author has 2 controllers in one view. I build a similar app in which I also have 2 controllers in one view, however, when I render a method, which belongs to the second controller, from the first I have problems with the params. (in the tutorial the author does not use any parameters in the action of the other controller)</p>\n\n<p>More specifically I have 2 controllers: UsersController and MicropostsController. Also, in the show.html.haml page of Users, I use both controllers: UsersController for showing user's microposts and MicropostsController in order to allow the user to create a new micropost.</p>\n\n<p>Inside MicropostsController:</p>\n\n<pre><code>def create\n  @micropost = current_user.microposts.build(params[:micropost])\n  if @micropost.save\n    flash[:success] = \"Micropost created!\"\n    redirect_to user_path(current_user)\n  else\n    #render text: renderActionInOtherController(UsersController,:show, {:id =&gt; 1})\n    @user = User.find(current_user)\n    @microposts = @user.microposts.paginate(page: params[:page])\n    render 'users/show'\n  end\nend\n</code></pre>\n\n<p>Inside UsersController</p>\n\n<pre><code>def show\n  @user = User.find(params[:id])\n  @microposts = @user.microposts.paginate(page: params[:page])\n  @micropost = current_user.microposts.build if signed_in?\nend\n</code></pre>\n\n<p>In the app/views/users/show.html.haml</p>\n\n<pre><code>- provide(:title, @user.name)\n.users_page\n  .row\n    %aside.span4\n      - if !signed_in?\n        %section\n          %h1\n            = gravatar_for @user\n            = @user.name\n      - else\n        %section\n          = render 'shared/user_info'\n        %section\n          = render 'shared/micropost_form'\n\n    .span8\n      - if @user.microposts.any?\n        %h3 Microposts (#{@user.microposts.count})\n        %ol.microposts\n          = render @microposts\n        = will_paginate @microposts\n</code></pre>\n\n<p>So basically my question summarizes as follows:</p>\n\n<p>1)Is it a good practice to have multiple controllers in 1 view? I have found contradicting answers in the net. (actually, I am not even sure if this code remains RESTful)</p>\n\n<p>2) If 1 is yes (or at least it is not a bad practice) could I implement the same thing in a more efficient way? Because the way I see it, every time I render action from another controller, I have to redefine the variables.</p>\n\n<p>3) I found a <a href=\"http://stackoverflow.com/questions/6051776/rails-3-render-action-from-another-controller\">similar</a> topic in stackoverflow in which one proposes to use this method (which I don't get what it does exactly since I am new in RoR).</p>\n\n<pre><code>def renderActionInOtherController(controller,action,params)\n  controller.class_eval{\n    def params=(params); @params = params end\n    def params; @params end\n  }\n  c = controller.new\n  c.request = @_request\n  c.response = @_response\n  c.params = params\n  c.send(action)\n  c.response.body\nend\n</code></pre>\n\n<p>If I use this version of create action inside MicropostsController, </p>\n\n<pre><code>def create\n  @micropost = current_user.microposts.build(params[:micropost])\n  if @micropost.save\n    flash[:success] = \"Micropost created!\"\n    redirect_to user_path(current_user)\n  else\n    render text: renderActionInOtherController(UsersController,:show, {:id =&gt; 1})\n    #@user = User.find(current_user)\n    #@microposts = @user.microposts.paginate(page: params[:page])\n    #render 'users/show'\n  end\nend\n</code></pre>\n\n<p>when I hit post button I get totally nothing in the browser. Moreover, when I try to view tha users/1 page I get the following error(!!):</p>\n\n<pre><code>undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>Any help will be really valuable! If you need any other info please inform me!</p>\n"},{"tags":["ruby-on-rails","activerecord","params","single-table-inheritance"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13279414,"title":"Rails Single Table Inheritance, params, and PUT to the base class","body":"<p>I have two classes \"Person\" and \"Group\" which are derived from a base class \"Entity\" via Rails Single Table Inheritance pattern. This pattern has DRYed up a lot of my code.</p>\n\n<p>Entity itself has no relations (e.g. has_many) but Person and Group have their specific ones.</p>\n\n<p>Continuing the process of simplifying my code, any changes to a person or group object are PUT against /entities/:id, triggering the update action.</p>\n\n<p>Enter the problem: Rails uses attr_accessible and the relations a class has to build the params[:entity] object. Since certain things I may PUT (like operator_attributes, specific to Group) only appear in Group but not Entity, Rails does not include these in params[:entity].</p>\n\n<p>How can I work around this problem while still using the Entity controller and without having to rewrite the Rails logic for building up params[:entity]?</p>\n"},{"tags":["ruby-on-rails","wicked-pdf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":690,"score":0,"question_id":7777924,"title":"wicked_pdf image rendering","body":"<p>how do I get images of a product to show in pdf?</p>\n\n<p>I have this code in view file </p>\n\n<pre><code>&lt;div id=\"img-slide\"&gt;\n    &lt;% for asset in @car.assets %&gt;\n    &lt;%= image_tag(asset.asset.url(:medium)) %&gt;\n    &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>and it shows all images for this car. </p>\n\n<p>but if I use the same code in show.pdf.erb then instead of images I got only question marks.. like the image missing thing.\nSo, is there a way to get them on paper? Thanks.</p>\n\n<p>p.s. there is what console is showing</p>\n\n<pre><code>***************WICKED***************\n  Asset Load (0.2ms)  SELECT `assets`.* FROM `assets` WHERE (`assets`.car_id = 29)\n  Carmodel Load (0.2ms)  SELECT `carmodels`.* FROM `carmodels` WHERE `carmodels`.`id` = 28 LIMIT 1\nRendered cars/show.pdf.erb (255.2ms)\n\"***************/usr/bin/wkhtmltopdf       -q - - ***************\"\n</code></pre>\n\n<p><strong>update</strong></p>\n\n<pre><code>&lt;%= pdf_image_tag('/public/system/assets/163/medium/2011_lincoln_navigator_l_angularfront.jpg', :style=&gt;\"margin:0px;padding:0px\", :width=&gt;\"300\", :height=&gt;\"240\")%&gt;\n</code></pre>\n\n<p>this code shows how the link should look like in html, with this code I can render one photo of the car, but it will be the same for all cars, so I didn't do much.</p>\n\n<p>the 163 number is the id of assets that is assigned to car, here I keep one image with more sizes(thumb, medium, large..) and I got 5 maps with different numbers for one car. So I have lots of maps with numberes like this as I have at least 5 photos for each car. each car have 5 assets. In show.html I can see them, but not in pdf. I did put this in application helper:</p>\n\n<pre><code>def pdf_image_tag(image, options = {})\n  options[:src] = File.expand_path(RAILS_ROOT) + '' + image\n  tag(:img, options)\nend\n</code></pre>\n\n<p>but this is only for images that you have on your server and will be the same for all cars, how can I get at least one image of each car to show in pdf? Pleaseeeee. help!!!</p>\n"},{"tags":["ruby-on-rails","api","magento"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13280698,"title":"Rails caching Magento API calls","body":"<p>I'm working on a Rails application using the Magento XMLRPC API.</p>\n\n<p>As it can be quite long I don't want to make a call every time the page refresh so everything is low-level cached. Now, the problem is to know when to update the cache if a product has been added/updated/deleted (same problem for images and categories of products).</p>\n\n<p>I've been thinking about running a background task every X minutes that update everything but it would be really heavy and I'm sure there is a better solution.</p>\n\n<p>And I don't have access to the Magento's code, otherwise I would have add a callback to a rails action when data is changed.</p>\n"},{"tags":["ruby-on-rails","capybara","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13280684,"title":"Is Feature/Scenerio a replacement for Describe/It?","body":"<p>I've been following the <a href=\"http://ruby.railstutorial.org/\" rel=\"nofollow\">Ruby on Rails Tutorial</a>. The author uses <strong>Rspec/Capybara</strong>'s <code>Describe/It</code> for the whole tutorial. But recently I've seen people using <code>Feature/Scenerio</code> instead. I wonder if <code>Feature/Scenerio</code> is a replacement of <code>Describe/It</code> or something that is used together? If it is a replacement, is there any reason of prefer it over <code>Describe/It</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13279784,"title":"install fusefs gem using bundle in Mac OS X Lion","body":"<p>I am new to RoR and I am trying to install an application that we have at work and i have to run bundle install to install some gems that are required for the application to work. One of them is fusefs v 0.7.0 but when I run bundle install it fails when it gets to try to install fusefs stating </p>\n\n<p>Error: Error installing fusefs:\n       Error: failed to build gem native extension</p>\n\n<pre><code>  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\n  checking for main() in -lfuse_ino64... no\n  checking for main() in -lfuse... no\n</code></pre>\n\n<p><strong>* extconf.rb failed *</strong>\nCould not create Makefile due to some reason, probably lack of necessary libraries and/or headers. Check the mkmf.log file for more details.</p>\n\n<p>So at this point I have spend several days trying to get ruby, rails, passenger, mysql and apache to play nice on 10.8 and I am stuck at this last little piece.</p>\n\n<p>Any help will be appreciated it.</p>\n\n<p><em><strong></em></strong> Update <strong><em>*</em>*</strong>\nWell I just found my answer. The fusefs is a build specifically for linux.</p>\n"},{"tags":["ruby-on-rails","twitter-api","nokogiri","mechanize-ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13280350,"title":"Twitter API vs Web scraping?","body":"<p>To begin with I want to get all the followers of my twitter account. I did a little research and found that we can do web scraping with Ruby on rails using : Nokogiri or Mechanize gems. I also got a css selector to use for the web scraping. Now the HTML page source does not show all the followers of the account if I look it up.</p>\n\n<p>Can I really use web scraping code to fetch all my twitter followers or Should I go for Twitter API?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13280379,"title":"Rails join query with select returning null id","body":"<p>I am performing a join query with rails with a select however, the result has null id's for the joined table...</p>\n\n<pre><code>@result = Table.joins(:join_table).select(['join_table.id', 'name', 'random_attr', 'created_at']).where('table.random_attr = ?', @anotherresult.id).order('name ASC')\n</code></pre>\n\n<p>The result...</p>\n\n<pre><code>[\n    {\n        random_attr: true\n        created_at: \"2012-10-31T02:23:07Z\"\n        id: null\n        name: \"Joe\"\n    },\n    ....\n]\n</code></pre>\n\n<p>The produced sql looks like...</p>\n\n<pre><code>SELECT join_table.id, name, random_attr, created_at FROM `table` INNER JOIN `join_table` ON `join_table`.`id` = `table`.`user_id` WHERE (random_attr = 9) ORDER BY name ASC;\n</code></pre>\n\n<p>Doing this query directly in mysql works fine.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13260387,"title":"Using /lib/ Subdirectories in Rails - for View Content","body":"<p>This is an evolving issue related to a previous posting I made...</p>\n\n<p>I am playing around some - to try to learn how the <code>/lib/</code> directory in Rails works - and how to reference variables defined in the <code>/lib/</code> directory for use in a view.</p>\n\n<p>I have a file called <code>helloworld.rb</code> and it's saved in a <code>/lib/hellotest/</code> directory in Rails.</p>\n\n<p>The <code>helloworld.rb</code> file has the following code:</p>\n\n<pre><code>module HelloWorld\n  def hello\n    @howdy = \"Hello World!\"\n  end\nend\n</code></pre>\n\n<p>I want to be able to display the results of this method on a view called <code>index.html.erb</code>, so I include the following code in the <code>index_helper.erb</code> file:</p>\n\n<pre><code>module IndexHelper\n  require 'helloworld'\nend\n</code></pre>\n\n<p>I have learned that I need to include the following line of code in the <code>/config/application.rb</code> file:</p>\n\n<pre><code>config.autoload_paths += %W(#{Rails.root}/lib/hellotest/)\n</code></pre>\n\n<p>Also, I include the following code on the view <code>index.html.erb</code>:</p>\n\n<pre><code>&lt;%= @howdy %&gt;\n</code></pre>\n\n<p>I think I may have found something that is causing problems. I didn't want to load the entire <code>/lib/</code> directory at startup so I put the file in a subdirectory called <code>/lib/hellotest/</code>. I've read there are some issues with how Rails interprets module/class naming conventions in the lib folder, but I can't quite figure it out. I see a good resource regarding this possible solution to my problem on <a href=\"http://www.williambharding.com/blog/technology/rails-3-autoload-modules-and-classes-in-production/\" rel=\"nofollow\">William B Harding's Blog</a>, on point 2 - but I can't quite get my arms around this solution as it pertains to my problem.</p>\n\n<p>Any advice please?</p>\n\n<p>What am I missing?</p>\n"},{"tags":["ruby-on-rails","forms","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13245182,"title":"Editing nested collection through 1 form in Rails","body":"<p>I am trying to create a form where I can edit all of the items in a collection individually in a single view.  I used Railscast #198 ( <a href=\"http://railscasts.com/episodes/198-edit-multiple-individually\" rel=\"nofollow\">http://railscasts.com/episodes/198-edit-multiple-individually</a> ) as a general guide but did not include the checkboxes since I want to just edit every item in the collection at once (not select which ones to edit).  With what I currently have, the form displays correctly but I get this type of error upon submit: </p>\n\n<pre><code>ArgumentError in ProceduresController#update_procedures\nwrong number of arguments (0 for 2). \n\nParameters:\n\n{\"utf8\"=&gt;\"✓\",\n \"_method\"=&gt;\"put\",\n \"authenticity_token\"=&gt;\"i9kB+uGlguerjxl0VHy1dRyMY5HrZQdILVuM79Df4Z4=\",\n \"procedures\"=&gt;{\"1\"=&gt;{\"description\"=&gt;\"Example1\"},\n \"2\"=&gt;{\"description\"=&gt;\"Example2\"}},\n \"commit\"=&gt;\"Submit\",\n \"comp_id\"=&gt;\"1\"} \n</code></pre>\n\n<p>Please tell me what I am missing here:   </p>\n\n<p>In my controller: </p>\n\n<pre><code>def edit_procedures\n    @comp = Comp.find(params[:comp_id])\n    @procedures = @comp.procedures.all    \nend\n\ndef update_procedures  \n    @comp = Comp.find(params[:comp_id])\n    @procedures = @comp.procedures.update.(params[:procedures].keys,     \n       params[:procedures].values).reject { |p| p.errors.empty? }\nend\n</code></pre>\n\n<p>In my routes: </p>\n\n<pre><code>resources :comps do\n    resources :procedures do\n        collection do \n          get 'edit_procedures' \n          put 'update_procedures'\n        end\n    end\nend\n</code></pre>\n\n<p>In my view: </p>\n\n<pre><code>&lt;%= form_tag update_procedures_comp_procedures_path(@comp), :method =&gt; :put do %&gt;\n    &lt;% for procedure in @procedures %&gt;\n        &lt;%= fields_for \"procedures[]\", procedure do |f| %&gt;\n            &lt;% if params[:field].blank? || params[:field] == \"description\" %&gt;\n            &lt;%= f.label :description %&gt;\n                &lt;%= f.text_field :description %&gt;\n        &lt;% end %&gt;\n        &lt;% end %&gt;\n    &lt;% end %&gt;   \n    &lt;p&gt;&lt;%= submit_tag \"Submit\" %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I also tried changing the 'edit_procedures' method from GET to POST, but then I got this error: Unknown action, The action 'show' could not be found for ProceduresController.  </p>\n\n<p>Thanks for the help.  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","facebook","devise","omniauth"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":248,"score":2,"question_id":7471763,"title":"Omniauth + Facebook Mutual Friends Count","body":"<p>Is there a better/easier way to find mutual friends between users than creating a Friends table and logging the UIDs of each new user's friends? (Using Devise + Omniauth on Rails 3)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":61,"score":5,"question_id":13277077,"title":"Is changing `require` to concatenate Ruby files brilliant or crazy?","body":"<p>When booting a Rails application with lots of dependencies, a lot of time is spent (I think) in <code>require</code>ing files.</p>\n\n<p>Suppose you were to create a deploy process that converted all <code>require</code> statements to file concatenations, using the same rules (don't get the same file twice, etc). Essentially, it would treat Ruby the way the asset pipeline treats javascript.</p>\n\n<p>Would this make a real speed difference? Would it create any issues - for instance, with variable scope - other than making it harder to trace errors to their original source files? </p>\n\n<p>In short, <strong>is this brilliant or crazy?</strong></p>\n\n<h2>Update</h2>\n\n<p>As pst points out, this would be pointless in production, where the server likely loads everything once, then forks to handle new requests.</p>\n\n<p>But consider the test environment, where you boot your Rails app every time you run your tests. Pre-concatenating all your gems could have an effect similar to the Spork gem.</p>\n\n<p>I suppose my real question is <strong>how much time is spent in <code>require</code> vs parsing the contents of the files</strong>.</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13280075,"title":"How do you override the dependent behavior of an association that's inherited in ActiveRecord?","body":"<p>Let's say I have these definitions:</p>\n\n<pre><code>module Votable\n  def self.included(klass)\n    klass.class_eval do\n      has_many :votes\n    end\n  end\nend\n\nclass Post &lt; ActiveRecord::Base\n  include Votable\nend\n</code></pre>\n\n<p>The <code>Votable</code> module is included from a gem so I can't modify the source. I would like to override the default behavior of <code>:dependent =&gt; :nullify</code> to <code>:dependent =&gt; :destroy</code> as if it were like this:</p>\n\n<pre><code>class Post\n  include Votable\n\n  has_many :votes, :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>How would I go about doing that?</p>\n"},{"tags":["ruby-on-rails","ruby","video-streaming","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13280044,"title":"Rails send_file don't play mp4","body":"<p>I have a Rails app that protects the uploaded videos putting them into a private folder.</p>\n\n<p>Now I need to play these videos, and when I do something like this in the controller:</p>\n\n<pre><code>  def show\n    video = Video.find(params[:id])\n    send_file(video.full_path, type: \"video/mp4\", disposition: \"inline\")\n  end\n</code></pre>\n\n<p>And open the browser(Chrome or FF) at /videos/:id it doesn't play the video.</p>\n\n<p>If I put the same video at the public folder, and access it like /video.mp4 it will play.</p>\n\n<p>If I remove the dispositon: \"inline\" it will download the video and I can play it from my computer. Samething happens with webm videos.</p>\n\n<p>What am I missing? Is this something possible to do?</p>\n"},{"tags":["ruby-on-rails","ruby","amazon-web-services","beanstalk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13276335,"title":"can't get past AWS Elastic Beanstalk \"Congratulations\" screen when launching Ruby on Rails app","body":"<p>I followed all the directions here:\n<a href=\"http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/create_deploy_Ruby_rails.html\" rel=\"nofollow\">http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/create_deploy_Ruby_rails.html</a></p>\n\n<p>and the screen I'm getting is this:\n<a href=\"http://passagebank-env-ky692euhv5.elasticbeanstalk.com\" rel=\"nofollow\">http://passagebank-env-ky692euhv5.elasticbeanstalk.com</a>\nhttp://snapplr.com/pph8</p>\n\n<p>I'm in the process of creating the .rvmrc file at my application root path as well as the setup_load_paths.rb file in my /config folder as described here: <a href=\"http://blog.ninjahideout.com/posts/the-path-to-better-rvm-and-passenger-integration\" rel=\"nofollow\">http://blog.ninjahideout.com/posts/the-path-to-better-rvm-and-passenger-integration</a> ...I did all that, and then i realized my computer is using ruby 1.9.3p194 while the EC instances is 1.9.3p286. So I'm in the process of matching them up and re-creating the .rvmrc file. </p>\n\n<p>While doing that, i noticed that the beanstalk ec2 server doesnt even have rails installed. I should be able to type <code>rails --version</code> i assume and see the version like i can on my computer and with <code>ruby --version</code> on the server. So I'm installing RVM, with and rails as I've done in the past here: <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow\">https://rvm.io/rvm/install</a> on my new beanstalk ec2 server. ...But in general, it seems this all defeats the purpose. It's supposed to be somewhat automatic. Installing rails definitely doesn't sound right. Was it installed another way on the server? </p>\n\n<p>...any advice on how to get the new beanstalk support for ROR working? what am di doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","xcode","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13279856,"title":"The compiler failed to generate an executable file. (RuntimeError)","body":"<p>I've checked a number of similar questions on stackoverflow but haven't found an answer yet.</p>\n\n<p>I recently upgraded to OS Mountain Lion. A project I'm working on requires gem sys-proctable as a dependency, but when I run <code>bundle install</code> I get:</p>\n\n<pre><code>Fetching gem metadata from https://rubygems.org/.........\n.\n.\n.\nInstalling sys-proctable (0.9.2) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb \nchecking for rb_pid_t in ruby.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1022:in `try_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1050:in `block in have_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1049:in `have_type'\n    from extconf.rb:3:in `&lt;main&gt;'\n\n\nGem files will remain installed in /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin for inspection.\nResults logged to /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin/ext/darwin/gem_make.out\nAn error occurred while installing sys-proctable (0.9.2), and Bundler cannot continue.\nMake sure that `gem install sys-proctable -v '0.9.2'` succeeds before bundling.\n</code></pre>\n\n<p>But I do have developer tools installed! Running <code>gem install sys-proctable -v '0.9.2'</code> gives me nearly the same error:</p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing sys-proctable:\n    ERROR: Failed to build gem native extension.\n\n        /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb\nchecking for rb_pid_t in ruby.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1022:in `try_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1050:in `block in have_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1049:in `have_type'\n    from extconf.rb:3:in `&lt;main&gt;'\n\n\nGem files will remain installed in /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin for inspection.\nResults logged to /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin/ext/darwin/gem_make.out\n[sample_app(filling-in-layout)]$ /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n                                                                              A [sample_app(filling-in-layout)]$ gem install sys-proctable -v '0.9.2'\nBuilding native extensions.  This could take a while...\nERROR:  Error installing sys-proctable:\n    ERROR: Failed to build gem native extension.\n\n        /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb\nchecking for rb_pid_t in ruby.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1022:in `try_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1050:in `block in have_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1049:in `have_type'\n    from extconf.rb:3:in `&lt;main&gt;'\n\n\nGem files will remain installed in /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin for inspection.\nResults logged to /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin/ext/darwin/gem_make.out\n</code></pre>\n\n<p>Here's the content of my <code>mkmf.log</code> file:</p>\n\n<pre><code>\"/usr/bin/gcc-4.2 -o conftest -I/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/x86_64-darwin11.4.0 -I/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/ruby/backward -I/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1 -I. -I/Users/mgriffel/.rvm/usr/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -I/opt/sm/pkg/active/include -fno-common -pipe conftest.c  -L. -L/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib -L/Users/mgriffel/.rvm/usr/lib -L. -L/opt/sm/pkg/active/lib -L/usr/local/lib     -lruby.1.9.1  -lpthread -ldl -lobjc \"\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2: \n3: int main() {return 0;}\n/* end */\n</code></pre>\n\n<p>Now I recently reinstalled XCode and Command Line Tools, but I'm worried that I somehow fucked up my C compiler, because when I try to run <code>rvm --force install 1.9.3</code> I get the following errors:</p>\n\n<pre><code>No binary rubies available for: downloads/ruby-1.9.3-p194.\nContinuing with compilation. Please read 'rvm mount' to get more information on binary rubies.\nlipo: can't open input file:  (No such file or directory)\nFetching yaml-0.1.4.tar.gz to /Users/mgriffel/.rvm/archives\nExtracting yaml to /Users/mgriffel/.rvm/src/yaml-0.1.4\nConfiguring yaml in /Users/mgriffel/.rvm/src/yaml-0.1.4.\nError running 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --prefix=/Users/mgriffel/.rvm/usr', please read /Users/mgriffel/.rvm/log/ruby-1.9.3-p194/yaml/configure.log\nCompiling yaml in /Users/mgriffel/.rvm/src/yaml-0.1.4.\nInstalling yaml to /Users/mgriffel/.rvm/usr\nInstalling Ruby from source to: /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194, this may take a while depending on your cpu(s)...\nruby-1.9.3-p194 - #downloading ruby-1.9.3-p194, this may take a while depending on your connection...\nruby-1.9.3-p194 - #extracted to /Users/mgriffel/.rvm/src/ruby-1.9.3-p194 (already extracted)\nPatch cflags was already applied.\nruby-1.9.3-p194 - #configuring\nError running 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib ./configure --enable-shared --disable-install-doc --prefix=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194 --with-gcc=clang', please read /Users/mgriffel/.rvm/log/ruby-1.9.3-p194/configure.log\nThere has been an error while running configure. Halting the installation.\n</code></pre>\n\n<p>Contents of <code>configure.log</code></p>\n\n<pre><code>[2012-11-07 18:02:12] env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib ./configure --enable-shared --disable-install-doc --prefix=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194 --with-gcc=clang\nchecking build system type... x86_64-apple-darwin12.2.0\nchecking host system type... x86_64-apple-darwin12.2.0\nchecking target system type... x86_64-apple-darwin12.2.0\nchecking whether the C compiler works... no\nconfigure: error: in `/Users/mgriffel/.rvm/src/ruby-1.9.3-p194':\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details\n</code></pre>\n\n<p>Finally, contents of <code>config.log</code>:</p>\n\n<pre><code>This file contains any messages produced by compilers while\nrunning configure, to aid debugging if configure makes a mistake.\n\nIt was created by configure, which was\ngenerated by GNU Autoconf 2.69.  Invocation command line was\n\n  $ ./configure --enable-shared --disable-install-doc --prefix=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194 --with-gcc=clang\n\n## --------- ##\n## Platform. ##\n## --------- ##\n\nhostname = Mattans-MacBook-Air.local\nuname -m = x86_64\nuname -r = 12.2.0\nuname -s = Darwin\nuname -v = Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64\n\n/usr/bin/uname -p = i386\n/bin/uname -X     = unknown\n\n/bin/arch              = unknown\n/usr/bin/arch -k       = unknown\n/usr/convex/getsysinfo = unknown\n/usr/bin/hostinfo      = Mach kernel version:\n     Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64\nKernel configured for up to 4 processors.\n2 processors are physically available.\n4 processors are logically available.\nProcessor type: i486 (Intel 80486)\nProcessors active: 0 1 2 3\nPrimary memory available: 4.00 gigabytes\nDefault processor set: 138 tasks, 703 threads, 4 processors\nLoad average: 3.07, Mach factor: 1.53\n/bin/machine           = unknown\n/usr/bin/oslevel       = unknown\n/bin/universe          = unknown\n\nPATH: /Users/mgriffel/.rvm/usr/bin\nPATH: /opt/local/bin\nPATH: /opt/local/sbin\nPATH: /usr/local/bin\nPATH: /usr/local/sbin\nPATH: /usr/local/mysql/bin\nPATH: /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin\nPATH: /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@global/bin\nPATH: /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin\nPATH: /Users/mgriffel/.rvm/bin\nPATH: /usr/bin\nPATH: /bin\nPATH: /usr/sbin\nPATH: /sbin\nPATH: /opt/sm/bin\nPATH: /opt/sm/pkg/active/bin\nPATH: /opt/sm/pkg/active/sbin\n\n\n## ----------- ##\n## Core tests. ##\n## ----------- ##\n\nconfigure:2788: checking build system type\nconfigure:2802: result: x86_64-apple-darwin12.2.0\nconfigure:2870: checking host system type\nconfigure:2883: result: x86_64-apple-darwin12.2.0\nconfigure:2903: checking target system type\nconfigure:2916: result: x86_64-apple-darwin12.2.0\nconfigure:3395: checking for C compiler version\nconfigure:3404: clang --version &gt;&amp;5\nApple clang version 4.1 (tags/Apple/clang-421.11.66) (based on LLVM 3.1svn)\nTarget: x86_64-apple-darwin12.2.0\nThread model: posix\nconfigure:3415: $? = 0\nconfigure:3404: clang -v &gt;&amp;5\nApple clang version 4.1 (tags/Apple/clang-421.11.66) (based on LLVM 3.1svn)\nTarget: x86_64-apple-darwin12.2.0\nThread model: posix\nconfigure:3415: $? = 0\nconfigure:3404: clang -V &gt;&amp;5\nclang: error: argument to '-V' is missing (expected 1 value)\nclang: error: no input files\nconfigure:3415: $? = 1\nconfigure:3404: clang -qversion &gt;&amp;5\nclang: error: no input files\nconfigure:3415: $? = 1\nconfigure:3435: checking whether the C compiler works\nconfigure:3457: clang   -L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib conftest.c  &gt;&amp;5\nclang: error: no such file or directory: 'CFLAGS=-I/opt/sm/pkg/active/include'\nclang: error: no such file or directory: 'CPATH=/opt/sm/pkg/active/include'\nconfigure:3461: $? = 1\nconfigure:3499: result: no\nconfigure: failed program was:\n| /* confdefs.h */\n| #define PACKAGE_NAME \"\"\n| #define PACKAGE_TARNAME \"\"\n| #define PACKAGE_VERSION \"\"\n| #define PACKAGE_STRING \"\"\n| #define PACKAGE_BUGREPORT \"\"\n| #define PACKAGE_URL \"\"\n| #define CANONICALIZATION_FOR_MATHN 1\n| /* end confdefs.h.  */\n| \n| int\n| main ()\n| {\n| \n|   ;\n|   return 0;\n| }\nconfigure:3504: error: in `/Users/mgriffel/.rvm/src/ruby-1.9.3-p194':\nconfigure:3506: error: C compiler cannot create executables\nSee `config.log' for more details\n\n## ---------------- ##\n## Cache variables. ##\n## ---------------- ##\n\nac_cv_build=x86_64-apple-darwin12.2.0\nac_cv_env_CCC_set=\nac_cv_env_CCC_value=\nac_cv_env_CC_set=\nac_cv_env_CC_value=\nac_cv_env_CFLAGS_set=\nac_cv_env_CFLAGS_value=\nac_cv_env_CPPFLAGS_set=\nac_cv_env_CPPFLAGS_value=\nac_cv_env_CPP_set=\nac_cv_env_CPP_value=\nac_cv_env_CXXFLAGS_set=\nac_cv_env_CXXFLAGS_value=\nac_cv_env_CXX_set=\nac_cv_env_CXX_value=\nac_cv_env_LDFLAGS_set=set\nac_cv_env_LDFLAGS_value='-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib'\nac_cv_env_LIBS_set=\nac_cv_env_LIBS_value=\nac_cv_env_build_alias_set=\nac_cv_env_build_alias_value=\nac_cv_env_host_alias_set=\nac_cv_env_host_alias_value=\nac_cv_env_target_alias_set=\nac_cv_env_target_alias_value=\nac_cv_host=x86_64-apple-darwin12.2.0\nac_cv_prog_CC=clang\nac_cv_target=x86_64-apple-darwin12.2.0\n\n## ----------------- ##\n## Output variables. ##\n## ----------------- ##\n\nALLOCA=''\nAR=''\nARCHFILE=''\nARCH_FLAG=''\nAS=''\nASFLAGS=''\nBASERUBY='ruby'\nBUILTIN_ENCOBJS=''\nBUILTIN_TRANSOBJS=''\nBUILTIN_TRANSSRCS=''\nCAPITARGET=''\nCC='clang'\nCCDLFLAGS=''\nCFLAGS=''\nCHDIR=''\nCOMMON_HEADERS=''\nCOMMON_LIBS=''\nCOMMON_MACROS=''\nCOUTFLAG=''\nCP=''\nCPP=''\nCPPFLAGS=''\nCPPOUTFILE=''\nCXX=''\nCXXFLAGS=''\nDEFS=''\nDLDFLAGS=''\nDLDLIBS=''\nDLEXT2=''\nDLEXT=''\nDLLWRAP=''\nDOT=''\nDOXYGEN=''\nECHO_C='\\c'\nECHO_N=''\nECHO_T=''\nEGREP=''\nENABLE_SHARED=''\nEXECUTABLE_EXTS=''\nEXEEXT=''\nEXPORT_PREFIX=''\nEXTOUT=''\nEXTSTATIC=''\nGCC=''\nGNU_LD=''\nGREP=''\nINSTALLDOC=''\nINSTALL_DATA=''\nINSTALL_PROGRAM=''\nINSTALL_SCRIPT=''\nLDFLAGS='-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib'\nLDSHARED=''\nLDSHAREDXX=''\nLIBEXT=''\nLIBOBJS=''\nLIBPATHENV=''\nLIBPATHFLAG=''\nLIBRUBY=''\nLIBRUBYARG=''\nLIBRUBYARG_SHARED=''\nLIBRUBYARG_STATIC=''\nLIBRUBY_A=''\nLIBRUBY_ALIASES=''\nLIBRUBY_DLDFLAGS=''\nLIBRUBY_LDSHARED=''\nLIBRUBY_RELATIVE=''\nLIBRUBY_SO=''\nLIBS=''\nLINK_SO=''\nLN_S=''\nLTLIBOBJS=''\nMAINLIBS=''\nMAJOR='1'\nMAKEDIRS=''\nMAKEFILES=''\nMANTYPE=''\nMINIOBJS=''\nMINIRUBY=''\nMINOR='9'\nMKDIR_P=''\nNM=''\nNROFF=''\nNULLCMD=''\nOBJCOPY=''\nOBJDUMP=''\nOBJEXT=''\nOUTFLAG=''\nPACKAGE=''\nPACKAGE_BUGREPORT=''\nPACKAGE_NAME=''\nPACKAGE_STRING=''\nPACKAGE_TARNAME=''\nPACKAGE_URL=''\nPACKAGE_VERSION=''\nPATH_SEPARATOR=':'\nPKG_CONFIG=''\nPREP=''\nRANLIB=''\nRDOCTARGET=''\nRI_BASE_NAME=''\nRM=''\nRMALL=''\nRMDIR=''\nRMDIRS=''\nRPATHFLAG=''\nRUBYW_BASE_NAME='rubyw'\nRUBYW_INSTALL_NAME=''\nRUBY_BASE_NAME='ruby'\nRUBY_INSTALL_NAME=''\nRUBY_PROGRAM_VERSION='1.9.3'\nRUBY_RELEASE_DATE='2012-04-20'\nRUBY_SO_NAME=''\nRUNRUBY=''\nSET_MAKE=''\nSHELL='/bin/sh'\nSOLIBS=''\nSTATIC=''\nSTRIP=''\nSYMBOL_PREFIX=''\nTEENY='1'\nTEST_RUNNABLE=''\nTHREAD_MODEL=''\nTRY_LINK=''\nUNIVERSAL_ARCHNAMES=''\nUNIVERSAL_INTS=''\nUSE_RUBYGEMS=''\nWERRORFLAG=''\nWINDRES=''\nXCFLAGS=''\nXLDFLAGS=''\nXRUBY=''\nXRUBY_LIBDIR=''\nXRUBY_RUBYHDRDIR=''\nXRUBY_RUBYLIBDIR=''\nac_ct_CC=''\nac_ct_CXX=''\nac_ct_OBJCOPY=''\nac_ct_OBJDUMP=''\narch=''\nbindir='${exec_prefix}/bin'\nbuild='x86_64-apple-darwin12.2.0'\nbuild_alias=''\nbuild_cpu='x86_64'\nbuild_os='darwin12.2.0'\nbuild_vendor='apple'\ncflags=' ${optflags} ${debugflags} ${warnflags}'\nconfigure_args=''\ncppflags=''\ncxxflags=' ${optflags} ${debugflags} ${warnflags}'\ndatadir='${datarootdir}'\ndatarootdir='${prefix}/share'\ndebugflags=''\ndocdir='${datarootdir}/doc/${PACKAGE}'\ndvidir='${docdir}'\nexec=''\nexec_prefix='NONE'\nhost='x86_64-apple-darwin12.2.0'\nhost_alias=''\nhost_cpu='x86_64'\nhost_os='darwin12.2.0'\nhost_vendor='apple'\nhtmldir='${docdir}'\nincludedir='${prefix}/include'\ninfodir='${datarootdir}/info'\nlibdir='${exec_prefix}/lib'\nlibexecdir='${exec_prefix}/libexec'\nlocaledir='${datarootdir}/locale'\nlocalstatedir='${prefix}/var'\nmandir='${datarootdir}/man'\noldincludedir='/usr/include'\noptflags=''\npdfdir='${docdir}'\nprefix='/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194'\nprogram_transform_name='s&amp;^&amp;&amp;'\npsdir='${docdir}'\nridir=''\nruby_pc=''\nruby_version=''\nrubyhdrdir=''\nrubylibprefix=''\nrubyw_install_name=''\nsbindir='${exec_prefix}/sbin'\nsetup=''\nsharedstatedir='${prefix}/com'\nsitearch=''\nsitedir=''\nsitehdrdir=''\nsysconfdir='${prefix}/etc'\ntarget='x86_64-apple-darwin12.2.0'\ntarget_alias=''\ntarget_cpu='x86_64'\ntarget_os='darwin12.2.0'\ntarget_vendor='apple'\ntry_header=''\nvendordir=''\nvendorhdrdir=''\nwarnflags=''\n\n## ----------- ##\n## confdefs.h. ##\n## ----------- ##\n\n/* confdefs.h */\n#define PACKAGE_NAME \"\"\n#define PACKAGE_TARNAME \"\"\n#define PACKAGE_VERSION \"\"\n#define PACKAGE_STRING \"\"\n#define PACKAGE_BUGREPORT \"\"\n#define PACKAGE_URL \"\"\n#define CANONICALIZATION_FOR_MATHN 1\n\nconfigure: exit 77\n</code></pre>\n\n<p>Please help, I've been stuck here for days.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":10,"favorite_count":3,"up_vote_count":14,"down_vote_count":0,"view_count":4841,"score":14,"question_id":93853,"title":"How to fix / debug 'expected x.rb to define X.rb' in Rails","body":"<p>I have seen this problem arise in many different circumstances and would like to get the best practices for fixing / debugging it on StackOverflow.</p>\n\n<p>To use a real world example this occurred to me this morning:</p>\n\n<pre><code>expected announcement.rb to define Announcement\n</code></pre>\n\n<p>The class worked fine in development, testing <em>and</em> from a production console, but failed from in a production Mongrel. Here's the class:</p>\n\n<pre><code>class Announcement &lt; ActiveRecord::Base\n  has_attachment :content_type =&gt; 'audio/mp3', :storage =&gt; :s3\nend\n</code></pre>\n\n<p>The issue I would like addressed in the answers is not so much solving this specific problem, but how to properly debug to get Rails to give you a meaningful error as expected x.rb to define X.rb' is often a red herring...</p>\n\n<p><strong>Edit (3 great responses so far, each w/ a partial solution</strong>)</p>\n\n<p><strong>Debugging:</strong></p>\n\n<ol>\n<li><p>From Joe Van Dyk: Try accessing the model via a console on the environment / instance that is causing the error (in the case above: script/console production then type in 'Announcement'.</p></li>\n<li><p>From Otto: Try setting a minimal plugin set via an initializer, eg: config.plugins = [ :exception_notification, :ssl_requirement, :all ] then re-enable one at a time.</p></li>\n</ol>\n\n<p><strong>Specific causes:</strong></p>\n\n<ol>\n<li><p>From Ian Terrell: if you're using attachment_fu make sure you have the correct image processor installed. attachment_fu will require it even if you aren't attaching an image.</p></li>\n<li><p>From Otto: make sure you didn't name a model that conflicts with a built-in Rails class, eg: Request.</p></li>\n<li><p>From Josh Lewis: make sure you don't have duplicated class or module names somewhere in your application (or Gem list).</p></li>\n</ol>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13279715,"title":"Rails wont install at create Makefile stage","body":"<p>I am getting this error after running sudo gem install rails</p>\n\n<pre><code>/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\ncreating Makefile\n\nmake\nxcrun cc -I. -    I/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/universal-darwin12.0     -I/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/universal-darwin12.0     -I. -DJSON_GENERATOR  -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common -arch i386 -arch x86_64     -g -O3 -pipe -fno-common -DENABLE_DTRACE  -fno-common  -pipe -fno-common   -c generator.c\nxcrun: Error: failed to exec real xcrun. (No such file or directory)\ncc -arch i386 -arch x86_64 -pipe -bundle -undefined dynamic_lookup -o generator.bundle     generator.o -L. -L/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib -L. -arch      i386 -arch x86_64     -lruby  -lpthread -ldl -lobjc  \ni686-apple-darwin11-llvm-gcc-4.2: generator.o: No such file or directory\ni686-apple-darwin11-llvm-gcc-4.2: generator.o: No such file or directory\nlipo: can't figure out the architecture type of: /var/tmp//ccHCNNwM.out\nmake: *** [generator.bundle] Error 1\n</code></pre>\n\n<p>I have Homebrew installed, Xcode 4.4 with command line tools installed, Osx 10.6.2</p>\n\n<p>I run gem env and get this but not sure what I'm looking for:</p>\n\n<pre><code>RubyGems Environment:\n - RUBYGEMS VERSION: 1.8.24\n - RUBY VERSION: 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0]\n - INSTALLATION DIRECTORY: /Library/Ruby/Gems/1.8\n - RUBY EXECUTABLE: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby\n - EXECUTABLE DIRECTORY: /usr/bin\n- RUBYGEMS PLATFORMS:\n - ruby\n - universal-darwin-12\n- GEM PATHS:\n  - /Library/Ruby/Gems/1.8\n  - /Users/matthewcleghorn/.gem/ruby/1.8\n  - /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/gems/1.8\n- GEM CONFIGURATION:\n  - :update_sources =&gt; true\n  - :verbose =&gt; true\n  - :benchmark =&gt; false\n  - :backtrace =&gt; false\n  - :bulk_threshold =&gt; 1000\n- REMOTE SOURCES:\n  - http://rubygems.org/\n</code></pre>\n\n<p>Any help greatly appreciated. Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","oauth-2.0","keep-alive"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":115,"score":2,"question_id":12059704,"title":"Net HTTP Persistent / Keep Alive with Ruby OAuth2 gem","body":"<p>I'm trying to figure out how to enable HTTP keep alive using the <a href=\"https://github.com/intridea/oauth2\" rel=\"nofollow\">OAuth2 gem</a>. Oauth2 is built on Faraday, which does appear to have experimental <a href=\"https://github.com/technoweenie/faraday/blob/master/lib/faraday/adapter/net_http_persistent.rb\" rel=\"nofollow\">support using net-http-persistent</a>. The only way I can find to enable it in Faraday is to use:</p>\n\n<pre><code>Faraday.default_adapter = :net_http_persistent\n</code></pre>\n\n<p>I have a few questions:</p>\n\n<ol>\n<li>Is enabling it in Faraday in turn enabling it for Oauth2?</li>\n<li>Is there anyway to test whether HTTP keep alive is actually working and enabled?</li>\n</ol>\n"},{"tags":["ruby-on-rails","resque"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13269940,"title":"Rails2.3.8 Resque.enqueue doesn't forward the job to background","body":"<p>I am trying to set up Resque. I have following in my environment.rb</p>\n\n<pre><code>config.gem \"redis\", :version =&gt;  \"3.0\"\nconfig.gem \"redis-namespace\", :version =&gt; \"1.2.1\", :lib =&gt; \"redis/namespace\"\nconfig.gem \"resque\", :version =&gt; \"1.23.0\"\n</code></pre>\n\n<p>I followed the <a href=\"http://railscasts.com/episodes/271-resque?view=asciicast\" rel=\"nofollow\">asciicast</a> upto before starting <code>resque-web</code>. In my controller I have</p>\n\n<pre><code>Resque.enqueue(SnippetHighlighter, @snippet.id)\n</code></pre>\n\n<p>like in the example given in the asciicast. However, my process isn't forwarded to the background but to the rails server. According to the asciicast, I should not get error in the <code>rails server</code> but in the resque. </p>\n\n<p>Also when I start my resque-web, I am getting the following error:</p>\n\n<pre><code>/usr/lib/ruby1.8/net/http.rb:560: in 'initialize': getaddrinfo: Name or \nservice not known(SocketError)\n</code></pre>\n\n<p>Can anyone please help me with this?  </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","meta-search"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":106,"score":3,"question_id":7893349,"title":"Avoiding select * queries in meta_search","body":"<p>I'm using meta_search gem on a rails 3 site and I'm finding some performance problems with the select * queries generated by meta_search fetching the BLOB fields in the DB schema. I am not willing to migrate the underlying schema to solve this problem. Is there a way to include/exclude certain fields from the search query that get generated by meta_search?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13279045,"title":"Whats the difference in Rails when a class is in quotes","body":"<p>I've noticed a couple examples in Rspec and FactoryGirl where some people put the class name in quotes, and some don't.</p>\n\n<p>Example rspec:</p>\n\n<pre><code>describe \"User\" do\n...specs...\nend\n\ndescribe User do\n...specs...\nend\n</code></pre>\n\n<p>Example FactoryGirl</p>\n\n<pre><code>factory :high_school_account, class: \"Account\" do\n  Name \"Test Account Name\"\n  AccountTypeId 1\nend\n\nfactory :high_school_account, class: Account do\n  Name \"Test Account Name\"\n  AccountTypeId 1\nend\n</code></pre>\n\n<p>I thought I read somewhere it had to do when the class is loaded into the ruby environment, but I might be completely making that up.</p>\n\n<p>Is there a difference between the quoted and non-quoted versions?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13278621,"title":"Constraining find_each","body":"<p>I have a select statement, </p>\n\n<pre><code>SELECT `metrics`.* \nFROM `metrics` \nWHERE `metrics`.`engine` = 0 \n  AND (`metrics`.connection_id = 27874) \n  AND (`metrics`.`id` &gt; 181586235) \nORDER BY `metrics`.`id` ASC LIMIT 1000\n</code></pre>\n\n<p>which is generated by <code>find_each</code> being called on a relation (e.g. <code>metric.engines.find_each</code>).  This select statement scans 15 million records each time it is run.</p>\n\n<p>I'd like to make this lighter on the database by telling the query only to look for a range of <code>metrics.id</code>s (e.g. <code>metrics.id &gt; 1 AND metrics.id &lt; 1000</code>).</p>\n\n<p>Is there a way to do this with <code>find_each</code>?</p>\n"},{"tags":["ruby-on-rails","postgresql"],"answer_count":6,"favorite_count":8,"up_vote_count":26,"down_vote_count":0,"view_count":7658,"score":26,"question_id":3116015,"title":"How to install gem pg on Ubuntu","body":"<p>When i try to install postgresSQL gem under Ruby.</p>\n\n<p>i issued the following command:</p>\n\n<pre><code>gem install pg\n</code></pre>\n\n<p>since i am using Rails 3.0. i installed Ruby 1.9.2 by using RVM. </p>\n\n<p>The above command shows me the following error. I have installed all necessary packages and library for postgresSQL under Ubuntu.</p>\n\n<p>The error is :</p>\n\n<pre><code>Building native extensions.  This could take a while...\n\nERROR:  Error installing pg:\n\nERROR: Failed to build gem native extension.\n\n/home/User/.rvm/rubies/ruby-1.9.2-preview3/bin/ruby extconf.rb\n\nchecking for pg_config... yes\nchecking for libpq-fe.h... yes\nchecking for libpq/libpq-fs.h... yes\nchecking for PQconnectdb() in -lpq... no\nchecking for PQconnectdb() in -llibpq... no\nchecking for PQconnectdb() in -lms/libpq... no\nCan't find the PostgreSQL client library (libpq)\n\n*** extconf.rb failed ***\n\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n --with-opt-dir\n --without-opt-dir\n --with-opt-include\n --without-opt-include=${opt-dir}/include\n --with-opt-lib\n --without-opt-lib=${opt-dir}/lib\n --with-make-prog\n --without-make-prog\n --srcdir=.\n --curdir\n --ruby=/home/User/.rvm/rubies/ruby-1.9.2-preview3/bin/ruby\n --with-pg\n --without-pg\n --with-pg-config\n --without-pg-config\n --with-pg-dir\n --without-pg-dir\n --with-pg-include\n --without-pg-include=${pg-dir}/include\n --with-pg-lib\n --without-pg-lib=${pg-dir}/lib\n --enable-static-build\n --disable-static-build\n --with-pqlib\n --without-pqlib\n --with-libpqlib\n --without-libpqlib\n --with-ms/libpqlib\n --without-ms/libpqlib\n\nGem files will remain installed in /home/user/.rvm/gems/ruby-1.9.2-preview3/gems/pg-0.9.0 for inspection.\n\nResults logged to /home/user/.rvm/gems/ruby-1.9.2-preview3/gems/pg-0.9.0/ext/gem_make.out\n</code></pre>\n\n<p>I don't know What's the error is..</p>\n"},{"tags":["ruby-on-rails","gem","best-in-place"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13278878,"title":"Using Best In Place gem, how do I allow links to be edited in place?","body":"<p>I have an object called \"item\" that has a \"title\" that can be linked to any URL. I have used the following code to allow the title to be edited in place using the Best in Place gem. The editing part works fine, but when the removes focus from the input box, the link is lost.</p>\n\n<pre><code>         &lt;%= best_in_place item, :title, \n                              :display_with =&gt; :link_to, \n                              :activator =&gt; \"#edit-#{item.id}\",\n                              :helper_options =&gt; item.url  %&gt;\n</code></pre>\n\n<p>I have a feeling I am not setting the value for \"helper_options\" correctly.</p>\n\n<p>How do I edit the code above so the link is restored with the updated text after the user changes the title? I can't find an example of this on the <a href=\"https://github.com/bernat/best_in_place\" rel=\"nofollow\">Best in Place github site</a>, or anywhere else for that matter.</p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","sqlite3","amazon-ec2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":132,"score":3,"question_id":12812721,"title":"Rails: SQLite3::CantOpenException: unable to open database file","body":"<p>I'm trying to use <code>delayed_job</code> to schedule tasks using Sqlite3, and it looks like apache isn't able to read my <code>production.sqlite3</code> file.</p>\n\n<p>Here's my <code>database.yml</code>:</p>\n\n<pre><code>production:\n  adapter: sqlite3\n  database: db/production.sqlite3\n  pool: 5\n  timeout: 5000\n</code></pre>\n\n<p>Here's the error I am getting (in log/production.log):</p>\n\n<pre><code>ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file:) \n</code></pre>\n\n<p>I have run <code>RAILS_ENV=production rake db:create</code> and <code>RAILS_ENV=production rake db:migrate</code>. The <code>db/production.sqlite3</code> file exists, and the db directory and all its subfolders are owned by <code>apache:apache</code>, which is who apache runs as. I'm using Phusion Passenger on Amazon EC2.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13278550,"title":"Update attribute on a has_many relationship","body":"<p>I am printing a list of user's contacts and want to give the user the ability to mark each contact as \"done\". (Essentially marking them off their to do list).</p>\n\n<p>How do I update the :done attribute for the specific contact? </p>\n\n<p>This is form with a hidden field is not working:</p>\n\n<pre><code>&lt;% if current_user.contacts.any? %&gt;\n&lt;% current_user.contacts.each do |c| %&gt; \n    &lt;li id=\"&lt;%= c.id %&gt;\"&gt;\n        &lt;%= c.name %&gt;&lt;br/&gt;\n\n        &lt;%= form_for(@contact) do |f| %&gt;\n            &lt;%= f.hidden_field :done, :value=&gt;true %&gt;\n            &lt;%= f.submit \"Mark as done\", class: \"btn btn-small btn-link\"%&gt;\n        &lt;% end %&gt;\n\n    &lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n\n\n<p>I get this error:</p>\n\n<pre><code>Template is missing Missing template contacts/create, application/create with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee]}. Searched in: * \"C:/Sites/rails_projects/sample_app/app/views\"\n</code></pre>\n\n<p>This is my contacts controller:</p>\n\n<pre><code>def create\n  @contact = current_user.contacts.build(params[:contact])\n  if @contact.save\n    flash[:success] = \"Contact saved!\"\n    redirect_to root_url\n  else\n    flash[:error] = \"Something is wrong\"\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","admin","spree"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":420,"score":0,"question_id":10364312,"title":"How to access the admin section of Spree in production?","body":"<p>I have followed the Spree instructions for setting up, and I got it working in development mode. I deployed with Capistrano to rackspace to a production server, but the same default login (\"spree@example.com\"/\"spree123\") does not work. I created a user in the web interface, but of course it would not have admin priveleges. </p>\n\n<p>There is nothing in the guide that takes this into account - how can I create an admin user in production when there are no users at all initially? Maybe I deployed incorrectly? I am using a very standard deploy.rb, must there be some spree-specific code for setting this up?</p>\n"},{"tags":["ruby-on-rails","update-attributes","html.dropdownlist","update-attribute"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13278636,"title":"Is there a way to use update_attributes(params[:photo]) where params contains the hash for items that are connected to an active record association?","body":"<p>Is there a way to use update_attributes(params[:photo]) where params contains the hash for items that are connected to an active record association?</p>\n\n<p>For example,\nI have a has_and_belongs_to_many relationship for both Photos and Categories and the join table takes care of their association. What I want to do is take a selected item (or items) from a dropdown (or multiple select) in a form for the photo and save it. The association in this case is that I can use :category_ids as the method called by the object ('f' in my form aka @photo) in my collection_select method call like so:</p>\n\n<pre><code>&lt;%= f.collection_select(:category_ids, Category.all, :id, :name, {}, html_options = { multiple: true, size: 5} ) %&gt;\n</code></pre>\n\n<p>In doing this I return an array of one or many id’s, ordered by default.</p>\n\n<pre><code>[1, 2, 3, 4, ...]\n</code></pre>\n\n<p>In my controller then I have to use @photo.category_ids = params[:photo][:category_ids] to set the category_ids for the photo. </p>\n\n<p>This brings me back to my question, can I use “update_attributes” in this case and if so, how?</p>\n"},{"tags":["ruby-on-rails","authentication","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":11842273,"title":"Devise token authenticatable when overidding controller","body":"<p>I'm trying to override devise by placing controller in a namespaced route (\"API\") and i need to use the token authenticatable functionnality. i have 2 questions, </p>\n\n<p>First, how can set by default devise to understand the params[:user] along params[:api_user]. Currently i could just send params in an array with :api_user key. if i try to do it with :user, devise don't recognize params, which seems logic.</p>\n\n<p>Secondly, when i override the sessionsController like :  </p>\n\n<pre><code>class Api::SessionsController &lt; ::Devise::SessionsController    \n     def create\n         super\n     end\nend\n</code></pre>\n\n<p>how can i get back a reference to the created session or user, to give me the ability to manipulate the token authenticatable created.</p>\n\n<p>I've already searched in a lot of topics about devise customisation, and found similar problems , but not really this one.</p>\n\n<p>Thanks for your help</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","internationalization","globalize3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13265384,"title":"Is it \"advisable\" / \"the right way\" to store all possible translations?","body":"<p>I am using Ruby on Rails v3.2.2 and the <a href=\"https://github.com/svenfuchs/globalize3\" rel=\"nofollow\">Globalize3 v0.2.0</a> gem. At this time I am using Globalize3 in order to translate country, region and city names in two languages but I plan to use it to internationalize my application in many more languages (ideally, all). So, I am populating the database with translation data, but I have some doubts on that: should I populate my <code>country_translations</code>, <code>region_translations</code> and <code>city_translations</code> database tables with <em>all</em> internationalized names (even if it may be that some names are the same as the default ones - in this case the internationalized name is <em>nil</em> or repeated)? that is, in translation tables should I create a translation record <em>for each</em> locale supported by my application (in my current case, two locales) and <em>for each</em> country, region and city?</p>\n\n<p>Making so, in a \"ideal\" scenario supporting all languages, mentioned tables (mostly those related to regions and cities) will be very large and probabily performance less. On the other hand, it makes sure that Globalize3 will properly work since it seems that in some cases when the internationalized record doesn't exist (I avoid to explain my specific case since it is \"hard\" to do, and maybe it'd need a book to be explained) that gem does <em>not</em> properly fallback to the current locale.</p>\n\n<p>How should I proceed?</p>\n"},{"tags":["ruby-on-rails","ruby","arrays"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":49,"score":0,"question_id":13276969,"title":"How to iterate via array in ruby and compare","body":"<p>I have for example such array:</p>\n\n<pre><code>40,42,45,49,50,52,54,55 etc\n</code></pre>\n\n<p>Via post-query i'm getting from select some value: for example 40-50, then i split this value for two numbers: <code>40 and 50</code> (but that's not the main problem, with split, question is in another).\nI need to compare this two values, so that array values must be in <code>[40...50)</code> values. So all what is in this interval i must select for my other calculations...\nHow to do this? aybe with map, but how?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13278096,"title":"User to User Messages in Rails","body":"<p>I've been building messaging in a rails app for users to be able to send each other messages. I've looked at a few gems such as mailboxer but ultimately decided to build my own.</p>\n\n<p>I'm hoping someone can help me put these pieces together. I've been following a similar question's answer <a href=\"http://stackoverflow.com/questions/5141564/model-users-message-in-rails-3\">here</a>.</p>\n\n<p>I'm testing in the rails console and I keep getting the following error: </p>\n\n<p>undefined method `send_message' for #</p>\n\n<p>How can I fix this?</p>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>class MessagesController &lt; ApplicationController\n    # create a comment and bind it to an article and a user  \n    def create\n      @user = User.find(params[:id])\n      @sender = current_user\n      @message = Message.send_message(@sender, @user)\n      flash[:success] = \"Message Sent.\"\n      flash[:failure] = \"There was an error saving your comment (empty comment or comment way to long)\"\n    end\nend\n</code></pre>\n\n<p><strong>Routes</strong></p>\n\n<pre><code>  resources :users, :except =&gt; [ :create, :new ] do\n     resources :store\n     resources :messages, :only =&gt; [:create, :destroy] \n  end\n</code></pre>\n\n<p><strong>Messages Model</strong></p>\n\n<pre><code>class Message &lt; ActiveRecord::Base\n  belongs_to :user\n\n  scope :sent, where(:sent =&gt; true)\n  scope :received, where(:sent =&gt; false)\n\n  def send_message(from, recipients)\n     recipients.each do |recipient|\n       msg = self.clone\n       msg.sent = false\n       msg.user_id = recipient\n       msg.save\n     end\n     self.update_attributes :user_id =&gt; from.id, :sent =&gt; true\n   end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","controller","instance-variables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13276046,"title":"Purpose of model variable in respond_with","body":"<p>In Rails 3, using the new respond_to and respond_with constructs, I do this:</p>\n\n<pre><code>class SurveysController &lt; ApplicationController\n  respond_to :html\n\n  def survey\n    @program_id = params[:program_id]\n    @participant_id = params[:participant_id]\n    respond_with [@program_id, @participant_id]\n  end\nend\n</code></pre>\n\n<p>When the view is displayed (survey.html.erb) the variables program_id, @participant_id are both properly set up. However, if I omit them from the respond_with, as follows:</p>\n\n<pre><code>class SurveysController &lt; ApplicationController\n  respond_to :html\n\n  def survey\n    @program_id = params[:program_id]\n    @participant_id = params[:participant_id]\n    @foo = \"foo\"\n    respond_with @foo\n  end\nend\n</code></pre>\n\n<p>The same two instance variables are still visible in the view. In other words, all instance variables from the action are made available from within the view.</p>\n\n<p><strong>Question: why should I put instance variables on the respond_to line?</strong></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13276783,"title":"get models name and count","body":"<p>I have this in <code>models_name</code>:</p>\n\n<pre><code>model_names = Object.constants.collect { |sym| Object.const_get(sym) }.select { |constant| constant.class == Class &amp;&amp; constant.include?(Mongoid::Document) }.collect { |klass| klass.name }\n</code></pre>\n\n<p>the result is:</p>\n\n<pre><code>[\"Model_name1\",\"Model_name2\",\"Model_name3\"]\n</code></pre>\n\n<p>I need something like:</p>\n\n<pre><code>[{\"Model1\":\"Count\"},{\"Model2\":\"Count\"},{\"Model3\":\"Count\"}]\n</code></pre>\n\n<p>I need show in a chart all models and object counter inside each model is working with <code>morris.js</code></p>\n\n<p>You can see the example:</p>\n\n<p><a href=\"http://jsbin.com/uzosiq/2/embed?javascript,live\" rel=\"nofollow\">http://jsbin.com/uzosiq/2/embed?javascript,live</a></p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13277751,"title":"Ruby code in yaml file?","body":"<p>I am using a gem that have this e-mail method:</p>\n\n<pre><code>  #Sends and email for indicating a reply in an already created conversation\n  def reply_message_email(message,receiver)\n    @message = message\n    @receiver = receiver\n    subject = message.subject.to_s\n    subject = strip_tags(subject) unless subject.html_safe?\n    mail(:to =&gt; receiver.send(Mailboxer.email_method,message), :subject =&gt; t('mailboxer.message_mailer.subject_reply', :subject =&gt; subject)) do |format|\n      format.text {render __method__}\n      format.html {render __method__}\n    end\n  end\nend\n</code></pre>\n\n<p>And I have this in my locale:</p>\n\n<pre><code>da:\n  mailboxer:\n    message_mailer:\n        subject_reply: You have got a new reply \"#{subject}\"\n</code></pre>\n\n<p>Instead of overwriting the email method. Is it not possible to do some ruby code in a YAML file? Now the subject of an e-mail is just You have got a new reply \"#{subject}\" as text and the ruby code is not active.</p>\n"},{"tags":["ruby-on-rails","graphviz"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13277525,"title":"Libraries for Rails GUI","body":"<p>I need to create a realtime, web viewable visualization tool / GUI. I haven't been very successful at identifying best approaches / libraries.</p>\n\n<p>(While it doesn't have to be RoR, RoR seemed a good choice as the data will be pulled from a DB on Heroku.)</p>\n\n<p>Which libraries should I use? </p>\n\n<p>Graphviz is the only I've identified so far. I'm probably missing something colossal.</p>\n\n<p>I'm also having trouble locating RoR + Graphviz tutorials aside of this one:\n<a href=\"http://nb.inode.co.nz/articles/graphviz_on_rails/index.html\" rel=\"nofollow\">http://nb.inode.co.nz/articles/graphviz_on_rails/index.html</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13277204,"title":"rails form add fields dynamically","body":"<p>I'm trying to set a set of fields to be dynamically displayed on demand. In the model, I've the fields:</p>\n\n<pre><code>attr_accessible ... :instruct1, :instruct2, ... :instruct30\n</code></pre>\n\n<p>I would like the form to display just instruct1 with a button to add 1 more field until instruct30 is hit and a button to remove one until instruct 1 is hit. All should happen without refreshing page which i think would include some use of AJAX but I couldn't find anything that is similar.</p>\n\n<p>I've searched for something similar but only able to come up with nested form which is not what im looking for as my model is fixed.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","psych"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":15,"score":3,"question_id":13277729,"title":"Ruby - gem psych serialize - LoadError enc/trans/single_byte","body":"<p>I encountered a weird problem while using ActiveRecord::Store module in my Ruby on Rails app. As I understand, this module use 'serialize' method under the hood so it just serialize your data to yaml format with ruby built-in psych gem.</p>\n\n<p>It works OK most of the time, but sometimes I get 500 error with the following message:</p>\n\n<pre><code>LoadError (cannot load such file -- enc/trans/single_byte):\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:27:in `write'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:27:in `end_document'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:27:in `visit_Psych_Nodes_Document'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/visitor.rb:15:in `visit'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/visitor.rb:5:in `accept'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:20:in `block in visit_Psych_Nodes_Stream'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:20:in `each'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:20:in `visit_Psych_Nodes_Stream'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/visitor.rb:15:in `visit'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/visitor.rb:5:in `accept'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/nodes/node.rb:46:in `yaml'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych.rb:243:in `dump'\n</code></pre>\n\n<p>As you can see, I use rbenv and ruby 1.9.3-p286. My system is Ubuntu 11.10. Required file exists <code>~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/i686-linux/enc/trans/single_byte.so</code>. The same error I encountered with ruby 1.9.3-p194. And the most weird part  of this problem that this error occurs from time to time.</p>\n\n<p>So maybe someone encountered this problem too and has already found a solution? Or does it seem more like a bug in psych and I should file it to its maintainer?</p>\n\n<p>Thanks in advance for any help!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13277331,"title":"How do i run validates_presence_of on an instance in rails?","body":"<p>I would like to do the following from a library class?</p>\n\n<pre><code>class LibClass\n  def create_user(provider)\n    user = User.new\n    if provider == \"facebook\"\n      user.validates_presence_of :email\n    else\n      # dont validate presence of email\n    end\n  end\nend\n</code></pre>\n\n<p>I am aware that I can do a self.validates_presence_of :email inside the User class, but I am in the library class and am not sure how to do this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1108,"score":4,"question_id":9237201,"title":"Getting frequent Gem RemoteFetcher::FetchError. Any workarounds?","body":"<p>I've been getting this error frequently every day for the last few days...</p>\n\n<pre><code>$ gem install rails -v 3.2.1\nERROR:  While executing gem ... (Gem::RemoteFetcher::FetchError)\n    bad response Forbidden 403 (http://production.cf.rubygems.org/gems/rdoc-3.12.gem)\n</code></pre>\n\n<p>My understanding based on a <a href=\"http://stackoverflow.com/questions/8580753/gem-install-rails-failing-any-workaround\">previous question</a> is that this is due to a problem with the remote repository and the solution is to just wait a little while and try again. Indeed, sometimes when I wait a few hours or overnight the install command works.</p>\n\n<p>However, I'm hoping for a more reliable experience.</p>\n\n<p>I thought of downloading files such as <code>rails-3.2.1.gem</code> and then running...</p>\n\n<pre><code>$ gem install --local ~/Desktop/rails-3.2.1.gem\n</code></pre>\n\n<p>But that gives me...</p>\n\n<pre><code>$ gem install --local ~/Desktop/rails-3.2.1.gem \nERROR:  While executing gem ... (Gem::DependencyError)\n    Unable to resolve dependencies: rails requires railties (= 3.2.1)\n</code></pre>\n\n<p>I could try downloading railties. Maybe I will. But I sense a plunge down a rabbit hole there of searching out dependency after dependency all day long.</p>\n\n<p>Any alternate efficient ways to install gems? Is there something I could do through my repository specification that would allow gem installation to be more reliable?</p>\n\n<hr>\n\n<pre><code>$ gem environment\nRubyGems Environment:\n  - RUBYGEMS VERSION: 1.8.15\n  - RUBY VERSION: 1.9.2 (2011-07-09 patchlevel 290) [x86_64-darwin11.2.0]\n  - INSTALLATION DIRECTORY: /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc\n  - RUBY EXECUTABLE: /Users/ethan/.rvm/rubies/ruby-1.9.2-p290/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc/bin\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-11\n  - GEM PATHS:\n     - /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc\n     - /Users/ethan/.rvm/gems/ruby-1.9.2-p290@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :benchmark =&gt; false\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - :sources =&gt; [\"http://rubygems.org\"]\n     - \"gem\" =&gt; \"--no-rdoc --no-ri\"\n     - \"install\" =&gt; \"--no-rdoc --no-ri\"\n     - \"update\" =&gt; \"--no-rdoc --no-ri\"\n  - REMOTE SOURCES:\n     - http://rubygems.org\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","plugins","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13277514,"title":"When trying to run Rails server it crashes on Rake","body":"<p>I`ve just upgraded the apps rails version from 3.0.9 to 3.1.2 &amp; also switched from ruby 1.8.7 to 1.9.2.</p>\n\n<p>While trying to run the server after the updates I get the error message below:</p>\n\n<pre><code>rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/dsl_definition.rb:65:in `directory': wrong number of arguments (0 for 1) (ArgumentError)\n    from /Users/Big_Bird/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/dsl_definition.rb:165:in `directory'\n    from /Users/Big_Bird/apps/Example/vendor/plugins/calendar_date_select/init.rb:12:in `block (2 levels) in &lt;class:Plugin&gt;'\n    from /Users/Big_Bird/apps/Example/vendor/plugins/calendar_date_select/init.rb:11:in `each'\n    from /Users/Big_Bird/apps/Example/vendor/plugins/calendar_date_select/init.rb:11:in `block in &lt;class:Plugin&gt;'\n</code></pre>\n\n<p>Now the snippet where the error occurs for the plugin is:</p>\n\n<pre><code>%w[calendar_date_select includes_helper].each { |file| \n  require File.join( File.dirname(__FILE__), \"lib\",file) \n}\n\nActionView::Helpers::FormHelper.send(:include, CalendarDateSelect::FormHelper)\nActionView::Base.send(:include, CalendarDateSelect::FormHelper)\nActionView::Base.send(:include, CalendarDateSelect::IncludesHelper)\n\n# install files\nunless File.exists?(Rails.root + '/public/javascripts/calendar_date_select/calendar_date_select.js')\n  ['/public', '/public/javascripts/calendar_date_select', '/public/stylesheets/calendar_date_select', '/public/images/calendar_date_select', '/public/javascripts/calendar_date_select/locale'].each do |dir|\n    source = File.join(directory,dir)\n    dest = Rails.root + dir\n    FileUtils.mkdir_p(dest)\n    FileUtils.cp(Dir.glob(source+'/*.*'), dest)\n  end\nend\n</code></pre>\n\n<p>I`m not quite sure where the problem lies since all of the directories listed in the plugin are correct, while upgrading I had to switch from using RAILS_ROOT to Rails.root but thats about it.</p>\n\n<p>I would appreciate any guidance on how to fix this issue.</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","forms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13277623,"title":"JQuery Updating Form Value (Rails backend)","body":"<p>I'm using Ruby on Rails to build an application with geolocated users.  I have a \"Locate Me\" button on my new user page that is supposed to use Google Maps API to geolocate the user and then fill in the \"address\" box on the form.  I'm new to JQuery and Whatever I do I can't get this to work! </p>\n\n<p>my code is something like this:</p>\n\n<p>HTML:</p>\n\n<pre><code>&lt;%= form_for @user, :url =&gt; services_create_path do |f| %&gt;\n    &lt;%= f.label :address %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :address, :size =&gt; 30 %&gt;&lt;br /&gt;\n    &lt;%= link_to '', '#', :class =&gt; \"button\", :\"data-role\" =&gt; \"button\", :\"data-inline\" =&gt; \"false\", :\"data-icon\" =&gt; \"refresh\", :id =&gt; 'geolocateMe' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>JQuery/JS:</p>\n\n<pre><code>$(\"#geolocateMe\").click(function() {\nconsole.log(\"we are in geolocateMe function now.\");\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(updatePosition);\n    } else {\n        alert(\"not allowed geolocation\");\n    }\n});\n\nfunction updatePosition(position) {\n    $('#user_address').val(coordToAddr(position.coords.latitude, position.coords.longitude));\n}\n</code></pre>\n\n<p>edit:  coordToAddr is a function that just takes lat long and converts them to a string address.  That is definitely working-</p>\n"},{"tags":["css","ruby-on-rails","ruby","views"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13276603,"title":"Rails: Stylesheet/view issue? Nothing is showing on the screen although there is source code when viewed in browser","body":"<p>I have a rails app with many partials for one view, each partial is a section in the view (one paged website).\nI have put all my assets in the correct places etc.\nbelow is a screenshot of how the actual page should look (outside of rails) (header, then section one which you can see, and there are sections below etc).</p>\n\n<p><img src=\"http://i.stack.imgur.com/KtVe5.jpg\" alt=\"enter image description here\"></p>\n\n<p>However this is how it is showing when done in rails\n<img src=\"http://i.stack.imgur.com/gOpwT.png\" alt=\"enter image description here\"></p>\n\n<p>No images are shown for some reason, nor any content. \nWhen I do not include the style sheet, all the content (writing) shows fine. When I include the stylesheet, everything disappears, its all white. However there are content there because I am able to scroll up/down.</p>\n\n<p>Below is a screenshot of the structure of my files \n<img src=\"http://i.stack.imgur.com/5cnSZ.png\" alt=\"enter image description here\"></p>\n\n<p>I basically have all my images inside the image folder, but there are subfolders inside the image folders.\nso:</p>\n\n<pre><code>assets (folder)\n images (folder)\n  section_1 (folder)\n   image.png (file)\n</code></pre>\n\n<p>in my css, because my css files are inside the stylesheets folder, I call my urls as follows:</p>\n\n<pre><code>background-image:url(\"../images/section_1/image.png\");\n</code></pre>\n\n<p>As for my views, it is basically one view which renders out each section (partial).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13277250,"title":"Does the second boolean after && executes in rails?","body":"<p>I'm still new to rails and lots of it is not what I'm used to. Couldn’t find my answer on this and don’t actually know what to search for so please help.</p>\n\n<p>Is this:</p>\n\n<pre><code>def create\n    @note = Note.new(params[:note])\n    @note.creator = current_user\n    if member_of_project? @note.project_id\n      if @note.save\n        redirect_to @note, :notice =&gt; \"Successfully created note.\"\n      else\n        render :action =&gt; 'new'\n      end\n    else\n      render :action =&gt; 'new'\n    end\n  end\n</code></pre>\n\n<p>Equal to:</p>\n\n<pre><code>def create\n    @note = Note.new(params[:note])\n    @note.creator = current_user\n    if member_of_project? @note.project_id &amp;&amp; @note.save\n      redirect_to @note, :notice =&gt; \"Successfully created note.\"\n    else\n      render :action =&gt; 'new'\n    end\n  end\n</code></pre>\n\n<p>???</p>\n\n<p>What I really want to know is if the second one will call <code>@note.save</code>.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","image","heroku","progressive"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13277370,"title":"Why do Images Loaded from Heroku Load Progressively","body":"<p>I have a small (Rails 3.1) app running on Heroku (with images also served from Heroku) The images load progressively (from top to bottom). If I take the same images and place them on another (Apache) server, they seemingly pop into existence once they are loaded. </p>\n\n<p>So why are they loading top-to-bottom on Heroku? Is it just that they are loading really slowly (so the progressive download is obvious) or is it something to do with the way Heroku serves images?</p>\n"},{"tags":["ruby-on-rails","ruby","gem","rake","production"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13252836,"title":"Could not find rake-0.9.2.2 in any of the sources (Bundler::GemNotFound) using windwos 7 (no rvm)","body":"<p>people,</p>\n\n<p>I'm new to ROR, not bloody new (anymore) but unexperienced with moving apps to production. To understand how the move-to-production-flow works I created a very simple rails project. Here are some basic infos about my system (running on windows 7):</p>\n\n<pre><code>Ruby version                1.9.3 (i386-mingw32)\nRubyGems version            1.8.24\nRack version                1.4\nRails version               3.2.8\nJavaScript Runtime          JScript\nActive Record version       3.2.8\nAction Pack version         3.2.8\nActive Resource version     3.2.8\nAction Mailer version       3.2.8\nActive Support version      3.2.8\nApplication root            C:/Sites/railstest\nEnvironment                 development\nDatabase adapter            sqlite3\nDatabase schema version     0\n</code></pre>\n\n<p>Middleware:</p>\n\n<pre><code>ActionDispatch::Static\nRack::Lock\n#&lt;ActiveSupport::Cache::Strategy::LocalCache::Middleware:0x2a70f20&gt;\nRack::Runtime\nRack::MethodOverride\nActionDispatch::RequestId\nRails::Rack::Logger\nActionDispatch::ShowExceptions\nActionDispatch::DebugExceptions\nActionDispatch::RemoteIp\nActionDispatch::Reloader\nActionDispatch::Callbacks\nActiveRecord::ConnectionAdapters::ConnectionManagement\nActiveRecord::QueryCache\nActionDispatch::Cookies\nActionDispatch::Session::CookieStore\nActionDispatch::Flash\nActionDispatch::ParamsParser\nActionDispatch::Head\nRack::ConditionalGet\nRack::ETag\nActionDispatch::BestStandardsSupport\n</code></pre>\n\n<p>My webhost is webhostone.</p>\n\n<p><strong>And here is what I did:</strong></p>\n\n<ol>\n<li>Generate a new rails app called railstest using: rails new railstest</li>\n<li>Updated the gemfile with the versions used on my webhost</li>\n<li>run \"bundle install --deployment\" to have all the gems in vendor-directory.</li>\n<li>FTP'ed everything to the webhost</li>\n<li>successfully run bundle install via PuTTY</li>\n</ol>\n\n<p>But when I call the site I always get something like this:\n<a href=\"http://www.kernification.de/rails/info/properties\" rel=\"nofollow\">http://www.kernification.de/rails/info/properties</a>\n(I don't have enough reputations to post an image here...)</p>\n\n<p>I've tried a lot more (I'm fighting for ~1.5weeks now with this issue) but it seems to be the same issue all the time. The webhost support told me the gems are located in 1.9.1, not in 1.8 and I have some questions about this:</p>\n\n<ol>\n<li>What is 1.9.1 (or 1.8) the version of? Ruby? Gem?</li>\n<li>How do I force to look for the gems in 1.9.1 instead of 1.8?</li>\n</ol>\n\n<p>I also tried using pik as version manager but I will only use webhostone so far, so I happy if I have one version of ruby installed that is working. So far I don't need to switch between any versions. I also moved to xubuntu, created the same simple app there, same result.</p>\n\n<p>Would be great if you could share your experience, thanks a lot!</p>\n"},{"tags":["ruby-on-rails","zeroclipboard"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12174621,"title":"how to use gem zero-clipboard-rails?","body":"<p>I added gem <a href=\"https://github.com/nragaz/zero-clipboard-rails\" rel=\"nofollow\">zero-clipboard-rails</a> to Gemfile, run <code>bundle install</code>, and don't understand what is the next step?</p>\n"},{"tags":["ruby-on-rails","ruby","associations","has-many","has-many-through"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":2902,"score":2,"question_id":428066,"title":"Elegantly selecting attributes from has_many :through join models in Rails","body":"<p>I'm wondering what the easiest/most elegant way of selecting attributes from join models in has_many :through associations is.</p>\n\n<p>Lets say we have Items, Catalogs, and CatalogItems with the following Item class:</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\n      has_many :catalog_items\n      has_many :catalogs, :through =&gt; :catalog_items\nend\n</code></pre>\n\n<p>Additionally, lets say that CatalogueItems has a position attribute and that there is only one CatalogueItem between any catalog and any item. </p>\n\n<p>The most obvious but slightly frustrating way to retrieve the position attribute is:</p>\n\n<pre><code>@item         = Item.find(4)\n@catalog      = @item.catalogs.first\n@cat_item     = @item.catalog_items.first(:conditions =&gt; {:catalog_id =&gt; @catalog.id})\nposition      = @cat_item.position\n</code></pre>\n\n<p>This is annoying because it seems that we should be able to do @item.catalogs.first.position since we have completely specified which position we want: the one that corresponds to the first of @item's catalogs. </p>\n\n<p>The only way I've found to get this is:</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\n      has_many :catalog_items\n      has_many :catalogs, :through =&gt; :catalog_items, :select =&gt; \"catalogue_items.position, catalogs.*\"\nend\n</code></pre>\n\n<p>Now I can do Item.catalogs.first.position. However, this seems like a bit of a hack - I'm adding an extra attribute onto a Catalog instance. It also opens up the possibility of trying to use a view in two different situations where I populate @catalogs with a Catalog.find or with a @item.catalogs. In one case, the position will be there, and in the other, it won't. </p>\n\n<p>Does anyone have a good solution to this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json","gem","bundler"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":357,"score":1,"question_id":12486894,"title":"Rails: json 1.7.5 bundle install issue","body":"<p>When running bundle I get the following issue...</p>\n\n<blockquote>\n  <p>Installing json (1.7.5) with native extensions\n  Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native\n  extension.</p>\n\n<pre><code>    /usr/local/bin/ruby extconf.rb creating Makefile\n</code></pre>\n  \n  <p>make Makefile:158: <em>*</em> target pattern contains no `%'.  Stop.</p>\n  \n  <p>Gem files will remain installed in\n  /srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/gems/json-1.7.5\n  for inspection. Results logged to\n  /srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/gems/json-1.7.5/ext/json/ext/generator/gem_make.out\n  An error occured while installing json (1.7.5), and Bundler cannot\n  continue. Make sure that <code>gem install json -v '1.7.5'</code> succeeds before\n  bundling.</p>\n</blockquote>\n\n<p>I tried doing the following <code>sudo aptitude install ruby1.9.1-dev</code> but that didn't work.  </p>\n"},{"tags":["javascript","ruby-on-rails","mechanize"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":31,"score":-2,"question_id":13277055,"title":"scraping data from website","body":"<p>how to get information from the (http://www.stat.gov.pl/regon/ click NIP) on my webapp written in Rails?</p>\n\n<p>want to do so\nmyapp: NIP field and (captcha download from stat.grov) -> stat.grov return data -> myapp </p>\n"},{"tags":["ruby-on-rails","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13276263,"title":"Rails - Ransack - Custom attribute_select","body":"<p>I'm using the <code>ransack</code> gem with my Rails application for an advanced search. How can I filter the <code>attribute_select</code> method to not show certain fields such as <code>id</code> and <code>created_at</code>, etc.</p>\n\n<pre><code>= f.attribute_fields do |a|\n  = a.attribute_select\n</code></pre>\n\n<p>My current method above simply lists any and all attributes.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13274502,"title":"Nested Resource - How to pass needed keys, and attribute to update?","body":"<p>My nested resources are working for form_for updates, but I have a few toggles that I need to setup to change a status field.  So I am using link_to, and accessing the url helper.</p>\n\n<pre><code>   link_to \"toggle\", edit_project_expense_path(@project[:id],expense_item[:id])\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code> resources :projects do\n    resources :expenses\n  end\n\n  match '/submit_expense/:id' =&gt; 'expenses#submit_expense', :as =&gt; 'submit_expense'\n</code></pre>\n\n<p>rake routes</p>\n\n<pre><code>edit_project_expense GET    /projects/:project_id/expenses/:id/edit(.:format) expenses#edit\n</code></pre>\n\n<p>My question is:  How can I also send along :approval_status = \"1\", with my link_to?</p>\n"},{"tags":["ruby-on-rails","postgresql","gem"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13276428,"title":"pg gem with Ubuntu","body":"<p>I'm trying to install the pg gem with a new rails app, but I keep receiving the same error:</p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing pg:\n    ERROR: Failed to build gem native extension.\n\n        /home/arthur/.rvm/rubies/ruby-1.9.2-p320/bin/ruby extconf.rb --with-pg-lib=/usr/lib\nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nchecking for libpq-fe.h... yes\nchecking for libpq/libpq-fs.h... yes\nchecking for pg_config_manual.h... yes\nchecking for PQconnectdb() in -lpq... no\nchecking for PQconnectdb() in -llibpq... no\nchecking for PQconnectdb() in -lms/libpq... no\nCan't find the PostgreSQL client library (libpq)\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n</code></pre>\n\n<p>I've already tried everything from this question: <a href=\"http://stackoverflow.com/questions/3116015/how-to-install-gem-pg-on-ubuntu\">How to install gem pg on Ubuntu</a>\nbut nothing really worked for me.</p>\n\n<p>That's ruby 1.9.2 and Rails 3.2, by the way.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13276050,"title":"What should be in the controller to update records from this params hash","body":"<p>This is probably a simple question.  I'm reading the form helpers guide on rubyonrails.org ( <a href=\"http://guides.rubyonrails.org/form_helpers.html\" rel=\"nofollow\">http://guides.rubyonrails.org/form_helpers.html</a> ).  In section 7.3 it shows how to make a form that returns a hash of params like the following: </p>\n\n<pre><code> {'person' =&gt; {'name' =&gt; 'Bob', 'address' =&gt; {'23' =&gt; {'city' =&gt; 'Paris'}, '45' =&gt; {'city' =&gt; 'London'}}}}\n</code></pre>\n\n<p>Bob has 2 addresses in the hash.  So what goes in the controller in order to update both addresses for Bob at the same time?   </p>\n\n<p>Thanks. </p>\n\n<p>Update: </p>\n\n<p>Here's what I assume the models would look like, but I still don't know what the controller should look like to update both of Bob's addresses simultaneously.  </p>\n\n<p>person.rb</p>\n\n<pre><code>attr_accessible :name, :addresses_attributes \n\nhas_many :addresses\naccepts_nested_attributes_for :addresses\n</code></pre>\n\n<p>address.rb</p>\n\n<pre><code>attr_accessible :city\n\nbelongs_to :person\n</code></pre>\n\n<p>Thank you.  </p>\n"},{"tags":["javascript","ruby-on-rails","html5","google-maps","geolocation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13276698,"title":"Is it possible to do some Javascript in a Rails Model validation method?","body":"<p>I basically want to only allow users to register if they have entered or have been geolocated at a valid location.  I thought the way to validate location would be to use google's geolocation API, to convert the string address the user enters into latitude and longitutide.  I would love to do this in a custom validation method in my User model, but I need to use Javascript to access Google's API.</p>\n\n<p>Is there a good way to do this?  Is there a better way to solve this problem?  Thanks!</p>\n"},{"tags":["ruby-on-rails","query","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13276375,"title":"ActiveRecord include with order","body":"<p>I have models:</p>\n\n<pre><code> class FirstModel &lt; AR::B\n   belongs_to :second_model\n end\n\n class SecondModel &lt; AR::B\n   #name\n   has_many :first_model\n end\n</code></pre>\n\n<p>I have code:</p>\n\n<pre><code> @a = FirstModel.where(#some query)\n @a.include([:second_model])\n</code></pre>\n\n<p>How i can include SecondModel with order by name?   </p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","actionmailer"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":957,"score":5,"question_id":6550809,"title":"rails 3: how to abort delivery method in actionmailer?","body":"<p>In my mailer controller, under certain conditions (missing data) we abort sending the email.</p>\n\n<p>How do I exit the controller method without still rendering a view in that case?</p>\n\n<blockquote>\n  <p>return if @some_email_data.nil?</p>\n</blockquote>\n\n<p>Doesn't do the trick since the view is still rendered (throwing an error every place I try to use @some_email_data unless I add a lot of nil checks)</p>\n\n<p>And even if I do the nil checks, it complains there's no 'sender' (because I supposed did a 'return' before getting to the line where I set the sender and subject.</p>\n\n<p>Neither does <code>render ... return</code> </p>\n\n<p>Basically, RETURN DOESN'T RETURN inside a mailer method!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":400,"score":1,"question_id":11885398,"title":"Is there a fix for the \"Could not find *gem* in any of the sources\" error that doesn't involve deleting Gemfile.lock?","body":"<p>I am trying to get my development environment setup on a new computer.</p>\n\n<pre><code>git clone -o heroku git@heroku.com:theirapp.git\ncd theirapp\nbundle\nFetching gem metadata from https://rubygems.org/......\nFetching gem metadata from https://rubygems.org/..\nCould not find jquery-rails-2.0.0 in any of the sources\n</code></pre>\n\n<p>After googling this error, the response seems to be to delete <code>Gemfile.lock</code>, then running <code>bundle</code> again. This works, but then I have different versions of gems where I haven't specified a version in <code>Gemfile</code>. Is there a way to fix this error without deleting <code>Gemfile.lock</code>? I'm using Rails 3.2 and Ruby 1.9.3.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13276118,"title":"How to specify a web address to a rails application?","body":"<p>I am using Ubuntu 12.04 and I have a rails application, that I would like to start on boot. Also if I start the server from console like</p>\n\n<pre><code>cd &lt;path of the application&gt;\nrails s -p 3000\n</code></pre>\n\n<p>I will have to keep the console open, else the application will end as soon as I end the terminal.</p>\n\n<p>Second to access the application I will have to access <strong>localhost:3000</strong>. I would rather like to have access it with a proper name like <strong>localhost/myapp</strong> or just <strong>myapp</strong> in browser.</p>\n\n<p>First, is it possible? How do I do that?</p>\n\n<p>PS: I already have some PHP applications running on Apache. I would not like to mess with the default 80 / 8080 port.</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13276241,"title":"Rails sum with group by and include","body":"<p>I'm trying to make some calculations over my models, but the generated sql is just not working.</p>\n\n<p>I have this models:</p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n  attr_accessible :order_date\n  has_many :order_products, dependent: :destroy\n\nclass OrderProduct &lt; ActiveRecord::Base\n  attr_accessible :amount\n  belongs_to :tariff\n  belongs_to :order_product_format\n  belongs_to :product\n\nclass OrderProductFormat &lt; ActiveRecord::Base\n  attr_accessible :amount\n\nclass Tariff &lt; ActiveRecord::Base\n  attr_accessible :price\n</code></pre>\n\n<p>So I created a function in my Order controller to get the total amount of all the orders as follows</p>\n\n<pre><code>def self.global_total_amount\n  OrderProduct.joins(:order_product_format, :tariff).sum '((order_products.amount * order_product_formats.amount ) * tariffs.price)'\nend\n</code></pre>\n\n<p>This works as expected, but now I want to group this total amounts by month of the year, so I'm trying to do something like this</p>\n\n<pre><code>def self.month_total_amount\n  OrderProduct.includes(:order).joins(:order_product_format, :tariff, :order).group('\"order\".\"order_date\"').sum('((order_products.amount * order_product_formats.amount ) * tariffs.price)')\nend\n</code></pre>\n\n<p>And I get the following error:</p>\n\n<pre><code>SELECT SUM(((order_products.amount * order_product_formats.amount ) * tariffs.price)) AS                     sum_order_products_amount_all_order_product_formats_amount_all_, \"order\".\"order_date\" AS order_order_date FROM \"order_products\" INNER JOIN \"order_product_formats\" ON \"order_product_formats\".\"id\" = \"order_products\".\"order_product_format_id\" INNER JOIN \"tariffs\" ON \"tariffs\".\"id\" = \"order_products\".\"tariff_id\" INNER JOIN \"orders\" ON \"orders\".\"id\" = \"order_products\".\"order_id\" GROUP BY \"order\".\"order_date\"\n\nActiveRecord::StatementInvalid: PG::Error: ERROR:  missing FROM-clause entry for table \"order\"\nLINE 1: ...cts_amount_all_order_product_formats_amount_all_, \"order\".\"o...\n</code></pre>\n\n<p>What am I doing wrong? Is there a better approach to do this?\nThank you very much in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","flex","push"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":208,"score":1,"question_id":12146188,"title":"What's the preferred way of using Rails and Flex?","body":"<p>I'd like to create a service, similar to a chat application (realtime app). </p>\n\n<p>From what I can see from my research, <code>BlazeDS</code> is the preferred way, but it involves Java and Java EE. Also, the latest Ruby results seem to be from 2009-2010, so they are likely outdated.</p>\n\n<p>Are there any actively maintained Ruby/Rails solutions for integrating push notifications with Flex?</p>\n"},{"tags":["javascript","ruby-on-rails","coffeescript","issues"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13276340,"title":"Can I use ordinary JavaScript in CoffeeScript file?","body":"<p>I am trying to add some JavaScript code in my Ruby on Rails application. I have already created for me, some js.coffee files for each view in my assets. Since, I am not familiar with the CoffeeScript I just passe some ordinary JavaScript/jQuery line in the file, such as:</p>\n\n<pre><code>if ($('#cart').length == 1) { $('#cart').hide(\"blind\", {direction: \"vertical\" }, 1000); }\n\n$('#cart tr').not('.total_line').remove();\n</code></pre>\n\n<p>but the following error was thrown:</p>\n\n<blockquote>\n  <p>Error: Parse error on line 1: Unexpected 'POST_IF'   (in\n  /home/gotqn/Aptana\n  Projects/depot/app/assets/javascripts/carts.js.coffee)</p>\n</blockquote>\n\n<p>The source is pointed on </p>\n\n<blockquote>\n  <p>Showing /home/gotqn/Aptana\n  Projects/depot/app/views/layouts/application.html.erb where line #6\n  raised:</p>\n</blockquote>\n\n<p>and in this file on line #6 I got:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>I am new in Ruby on Rails, but what I suppose is happening is that I am not able to write simple JavaScript in the CoffeeScript. If this is true, can I only remove the .coffe extension and be sure that the Rails magic will work and load the file?</p>\n"},{"tags":["ruby-on-rails","shopify"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13276382,"title":"Shopify API - Add a form field to products page","body":"<p>I'm working on an app using rails with the shopify API, and was wondering if there is anyway to add a custom field to the products page in the admin.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":11668325,"title":"Render custom page/s after validation fails","body":"<p>I'm using the High Voltage gem (https://github.com/thoughtbot/high_voltage/) for a site with masses of static pages. The site has three unique forms all which are handled by the 'forms' controller/model. </p>\n\n<p>Now all is working well when fields which requires validation are populated, but when validation fails it jumps from the 'pages' controller (High Voltage) back to the 'forms' controller and renders /form/new, instead of, for instance, /pages/quotes - which is understandable as it's default behaviour.</p>\n\n<p>I'm also checking for validation in the form:</p>\n\n<pre><code>= form_for @form, :validate =&gt; true do |f|\n  - if @form.errors[:name].present?\n    .control-group.error\n      = f.label \"Your Name\"\n      = f.text_field :name\n  - else\n    = f.label \"Your Name\"\n    = f.text_field :name\n</code></pre>\n\n<p>Any idea how I can re-render the current page (which renders the specific form) after validation fails instead of directing to /forms/new</p>\n\n<p>Any advice appreciated, thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13275821,"title":"Override attributes keys in FactoryGirl","body":"<p>I have a model <code>Post</code> with an attribute <code>published_at</code>.\nHowever, in POST request API requires it to be assigned as <code>published</code>, not <code>published_at</code>.\nSo in my model I override setter method like so</p>\n\n<pre><code>def published=(value)\n  self.published_at = value\nend\n</code></pre>\n\n<p>The problem is, in my API tests, I use FactoryGirl's <code>attributes_for(:post)</code> method to generate attributes for POST request, and it uses old <code>published_at</code> name. How can I workaround this problem and generate attributes with <code>published</code> key instead of <code>published_at</code> without changing the name of this attribute in my model?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":205,"score":1,"question_id":11897269,"title":"Get own IP address","body":"<p>How to get my own IP address with Rails?</p>\n\n<p>When I do it like this I got: <code>127.0.0.1</code></p>\n\n<pre><code>@ip = request.remote_ip\n</code></pre>\n\n<p>Is there any way to get the Public IP?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13272759,"title":"call a class from a collection_action in ActiveAdmin (RoR)","body":"<p>I'm new in ruby on rails. I'm trying to call a class from a <code>collection_action</code> in ActiveAdmin. Here is the code(app/admin/models):</p>\n\n<pre><code>collection_action :status_race, :method =&gt; :post do\n    #Do some import work..\n    redirect_to :class =&gt; :import_route\nend \n</code></pre>\n\n<p>And this is the code of the class I want to call(app/lib/route):</p>\n\n<pre><code>class ImportRoute\ndef  initialize\n    @seperator = \" \"\n    @time_format = \"%d-%m-%y\"\nend\ndef run(filename)\n    puts \"Running route import file\"\n\n    raise \"File\" + filename + \"doesn't not exist\" unless File.exist(filename)\n\n    ri = RouteImporter.find(:name =&gt; self.class.name)\n\n    if(ri.nil?)\n        puts \"Error, file doesn't exists\"\n    end\n    CSV.foreach(filename, {:col_sep =&gt; @seperator}) do |row|\n        if row.lenght &gt;5\n            ri.country_name = row[0] + \" \" + row[1]\n            ri.type = row[2]\n            ri.company = row [3]\n        else\n            ri.country_name = row[0]\n            ri.type = row[1]\n            ri.company = row[2]\n            ri.date = row[4].gsub(\";\", \" \")\n        end\n    end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>I was using <code>redirect_to</code> to call the class but is not working, and I don't have any clue about how to do it. Any idea? Thanks! </p>\n"}]}
{"total":93230,"page":4,"pagesize":100,"questions":[{"tags":["javascript","ruby-on-rails","file","location","conventions"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13275864,"title":"Ruby on Rails - is it correct to add additional JavaScript file in views folder directory?","body":"<p>I am reading a book about \"Ruby on Rails\" and one of the task includes modifying the code till now, creating additional JavaScript functionality. The JavaScript itself is easy, just few lines of code, so my question is conceptual at all.</p>\n\n<p>I am executing the first <a href=\"http://pragprog.com/wikis/wiki/Pt-F-1-31\" rel=\"nofollow\">activity</a>  and in the <a href=\"http://pragprog.com/wikis/wiki/Task-F-AddADashofAjax-31\" rel=\"nofollow\">discussion</a> folks said that the new code should be created in a separate js.erb file in the views folder.</p>\n\n<p>My questions is what is the better way to solve the issue:</p>\n\n<ol>\n<li><p>Create additional js.erb file in views folder</p>\n\n<p><strong>OR</strong></p></li>\n<li><p>Add the additional JavaScript code in the\nassets->javascript->viewname.js.coffee</p></li>\n</ol>\n\n<p>The people from the discussion use the second technique but is it more appropriate to add the JavaScript in the assets as it will be executed with the view?</p>\n\n<p>EDIT:</p>\n\n<p>I am using Ubuntu 12.04 and my Rails version is 3.2.8.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13275814,"title":"undefined method `destroy' for nil:NilClass","body":"<p>My app successfully creates rows for a table every time a user submits some stats. Now I want to provide a delete button to be able to delete some rows. </p>\n\n<p>When I click the delete button I get the error: </p>\n\n<pre><code>undefined method `destroy' for nil:NilClass\n</code></pre>\n\n<p>Seems like either rails doesn't understand the destroy method in this case for whatever reason, or rails doesn't see anything to destroy, hence the nil:NilClass. </p>\n\n<p>My first question is in identifying which is the case, if either of those. </p>\n\n<p>My second question is fixing it :D</p>\n\n<p>Here's my show.html:</p>\n\n<pre><code>&lt;% provide(:title, \"Log\" ) %&gt;\n&lt;% provide(:heading, \"Your Progress Log\") %&gt;\n\n&lt;div class=\"row\"&gt;  \n  &lt;div class=\"span8\"&gt;\n    &lt;% if @user.status_update.any? %&gt;\n      &lt;h3&gt;Status Updates (&lt;%= @user.status_update.count %&gt;)&lt;/h3&gt;    \n      &lt;table&gt;\n        &lt;thead&gt;\n          &lt;tr&gt;\n            &lt;th&gt;Entry Date&lt;/th&gt;\n            &lt;th&gt;Weight&lt;/th&gt;\n            &lt;th&gt;BF %&lt;/th&gt;\n            &lt;th&gt;LBM&lt;/th&gt;\n            &lt;th&gt;Fat&lt;/th&gt;\n            &lt;th&gt;Weight Change&lt;/th&gt;\n            &lt;th&gt;BF % Change&lt;/th&gt;\n            &lt;th&gt;Fat Change&lt;/th&gt;\n          &lt;/tr&gt;\n        &lt;/thead&gt;\n      &lt;tbody class = \"status updates\"&gt;\n          &lt;%= render @status_updates %&gt;\n      &lt;/tbody&gt;        \n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The \"&lt;%= render @status_updates %>\" calls the _status_update partial. </p>\n\n<pre><code> &lt;tr&gt;\n .\n .\n .\n . \n &lt;% if current_user==(status_update.user) %&gt; \n &lt;td&gt;\n       &lt;%= link_to \"delete\", status_update, method: :delete %&gt;\n\n &lt;/td&gt;\n &lt;%  end  %&gt;         \n\n&lt;/tr&gt;                                    \n</code></pre>\n\n<p>And then finally, here is the StatusUpdateController</p>\n\n<pre><code>def destroy\n    @status_update.destroy\n    redirect_to root_url\nend\n</code></pre>\n\n<p>Here are the parameters on the error page:</p>\n\n<pre><code>{\"_method\"=&gt;\"delete\",\n \"authenticity_token\"=&gt;\"w9eYIUEd2taghvzlo7p3uw0vdOZIVsZ1zYIBxgfBymw=\",\n \"id\"=&gt;\"106\"}\n</code></pre>\n"},{"tags":["ruby-on-rails","database-schema"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13238124,"title":"User invitation Schema","body":"<p>I am developing a RoR application in which users can make Lists and invite other users to join their list(s). I am not sure how I should approach the invitation data model. I would assume that a user invitation model would be fairly common but I have not found any good examples.</p>\n\n<p>I'd like any user to be able to invite any other user to their list. The invitee (an another user) would then be able to accept or reject the invitation. </p>\n\n<p>I have a many-to-many relationship between users and lists currently. Should the join table between these two entities (lists_users) hold information concerning invitations? Would it be better to create another table, invitations, and add and remove records from it as users accept or reject invitations? If the latter is advisable how should I handle list owner (user) vs. list invitees (user)?</p>\n\n<p>I'm grateful for any advice. Thanks!</p>\n\n<p><strong>Solution</strong></p>\n\n<p>I found it necessary to specify the table containing the foregin keys in User Model. ie</p>\n\n<pre><code>  has_many :owned_lists, :class_name =&gt; \"List\", :foreign_key =&gt;\"owner_id\"\n  has_many :created_invitations, :class_name =&gt; \"Invitation\", :foreign_key =&gt;\"invitor_id\"\n  has_many :received_invitations,:class_name =&gt; \"Invitation\", :foreign_key =&gt; \"invitee_id\"\n</code></pre>\n\n<p>-Nick</p>\n"},{"tags":["ruby-on-rails","rubygems","ckeditor","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":3550,"score":4,"question_id":6948465,"title":"Rails 3.1 ckeditor","body":"<p>So I just tried to install ckeditor in rails, however it doesn't look like its working.</p>\n\n<p>Here is what I did</p>\n\n<p>added these lines to my gemfile</p>\n\n<pre><code>gem \"ckeditor\", \"~&gt; 3.6.0\"\ngem \"paperclip\"\n</code></pre>\n\n<p>Then bundled installed and ran</p>\n\n<pre><code>rails generate ckeditor:install\nrails generate ckeditor:models --orm=active_record\n</code></pre>\n\n<p>Added this file tom <code>config/application.rb</code></p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/app/models/ckeditor)\n</code></pre>\n\n<p>And then I tried out this code:</p>\n\n<pre><code>&lt;%= javascript_include_tag :ckeditor %&gt;\ncktext_area_tag(\"test_area\", \"Ckeditor is the best\")\ncktext_area_tag(\"content\", \"Ckeditor\", :input_html =&gt; {:cols =&gt; 10, :rows =&gt; 20}, :toolbar =&gt; 'Easy')\n</code></pre>\n\n<p>However, all I am getting is two textareas that do not have any editing ability. They look like normal textareas and all I can do is erase and add text.</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["ruby-on-rails","caching","heroku","twilio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13275976,"title":"Twilio app states cache: [POST /calls/create/] invalidate, pass","body":"<p>I have a twilio application that I am trying to test.  </p>\n\n<p>Whenever I make a phone call to the application (which I am pushing to heroku) , which generates a POST to the calls#create, I receive the following response.  </p>\n\n<p>Processing by CallsController#create as HTML\n2012-11-07T18:31:19+00:00 app[web.1]: Completed 200 OK in 95ms (Views: 1.0ms | ActiveRecord: 72.1ms)\n2012-11-07T18:31:19+00:00 app[web.1]: cache: [POST /calls/create/] invalidate, pass</p>\n\n<p>Any ideas?  Where do I go from here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","nginx","unicorn"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":413,"score":0,"question_id":10435978,"title":"Error Messages Showing in Production - Ruby on Rails 3.1, Nginx, Unicorn","body":"<p>I have a Rails 3.1 app running in production using Nginx and Unicorn. And for some reason, my custom 404 and 500 html error pages are not showing. Instead I'm getting the actual error message (\"Routing Error\", for example).</p>\n\n<p>In my production.rb file, I have <code>config.consider_all_requests_local = false</code></p>\n\n<p>And on the same server with a nearly identical configuration, I have a 'staging' site that works just fine. The only difference, as far as I can tell, is that the production one has SSL while the staging does not.</p>\n\n<p>Here is the Nginx config for the production app:</p>\n\n<pre><code>upstream unicorn_myapp_prod {\n  server unix:/tmp/unicorn.myapp_prod.sock fail_timeout=0;\n}\n\nserver {\n  listen 80;\n\n  server_name myapp.com;\n\n  root /home/deployer/apps/myapp_prod/current/public;\n\n  location ^~ /assets/ {\n    gzip_static on;\n    expires max;\n    add_header Cache-Control public;\n  }\n\n  try_files $uri/index.html $uri @unicorn;\n  location @unicorn {\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header Host $http_host;\n    proxy_redirect off;\n    proxy_pass http://unicorn_myapp_prod;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  client_max_body_size 4G;\n  keepalive_timeout 10;\n}\n\n\nserver {\n  listen 443 default;\n  ssl on;\n  ssl_certificate /home/deployer/apps/myapp_prod/shared/ssl_certs/myapp_prod.crt;\n  ssl_certificate_key /home/deployer/apps/myapp_prod/shared/ssl_certs/myapp_prod.key;\n\n\n  server_name myapp.com;\n\n  root /home/deployer/apps/myapp_prod/current/public;\n\n  location ^~ /assets/ {\n    gzip_static on;\n    expires max;\n    add_header Cache-Control public;\n  }\n\n  try_files $uri/index.html $uri @unicorn;\n  location @unicorn {\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header Host $http_host;\n    proxy_redirect off;\n    proxy_pass http://unicorn_myapp_prod;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  client_max_body_size 4G;\n  keepalive_timeout 10;\n}\n</code></pre>\n\n<p>Any ideas? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","solr","sunspot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":11686641,"title":"sort by association field in sunspot","body":"<p>In my app I am using Sunspot for a fulltext search. The problem is that I want to have sorting by association model field. In my case:</p>\n\n<pre><code>class Movie &lt; ActiveRecord::Base\n  attr_accessible :description, :genre, :name\n  has_many :premieres\nend\n</code></pre>\n\n<p>and my <code>Premier</code> model has:</p>\n\n<pre><code>belongs_to :movie\n</code></pre>\n\n<p>Searching by movie name is done by defining the method:</p>\n\n<pre><code>def movie_name\n  movie.name\nend\n</code></pre>\n\n<p>but when I try to do:</p>\n\n<pre><code>order_by :movie_name, :asc\n</code></pre>\n\n<p>It says:</p>\n\n<blockquote>\n  <p>No field configured for Premiere with name 'movie_name'</p>\n</blockquote>\n\n<p>How do I make this sorting available?</p>\n"},{"tags":["ruby-on-rails","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13275716,"title":"cancan load_resource for nested resources don't build has_one association","body":"<p>I have an Owner model wich has_one Address, and accepts_nested_attributes for it. When loading a Owner, for the :new action, I expected the :load_resource method to build the association like @owner.build_address, but this don't happen with the code below:</p>\n\n<pre><code>class OnwersController &lt; ApplicationController\n    load_and_authorize_resource\n    load_resource :address, :through =&gt; :owner, :singleton =&gt; true, :parent =&gt; false\n</code></pre>\n\n<p>Is this the expected behaviour and I have to do @owner = @address by my own ?</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails","date","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13275492,"title":"Rails, ActiveRecord and date","body":"<p>Stupid question maybe, but it drive me insane right now. \nWhy </p>\n\n<pre><code> User.where(:created_at =&gt; 1.day.ago..Time.now).count\n   (0.8ms)  SELECT COUNT(*) FROM \"users\" WHERE (\"users\".\"created_at\" BETWEEN '2012-11-06 17:58:22.443552' AND '2012-11-07 17:58:22.443809')\n =&gt; 2 \n</code></pre>\n\n<p>And</p>\n\n<pre><code> User.where(:created_at =&gt; 1.day.ago.to_date..Time.now.to_date).count\n   (0.6ms)  SELECT COUNT(*) FROM \"users\" WHERE (\"users\".\"created_at\" BETWEEN '2012-11-06' AND '2012-11-07')\n =&gt; 0 \n</code></pre>\n\n<p>Give me a different result?</p>\n\n<p>I know that without the time (with .to_date so) it should take midnight for the beginning and the end of the day. This is what I want, but for some obscure reasons, it show me 0, but I've created 2 users like 10 minutes ago.... </p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13275373,"title":"Rails 2.3 log all database queries separatly","body":"<p>As a follow up from this <a href=\"http://stackoverflow.com/questions/13037475/to-sql-not-working-on-update-attributes-or-save?lq=1\">post</a>: i am trying to log all queries that are being generated. I have tried placing this in an initializer, and also just straight up running it in console and execute never seems to get executed.</p>\n\n<p>I have tried the following: </p>\n\n<pre><code>connection = ActiveRecord::Base.connection\nclass &lt;&lt; connection\n  alias :original_exec :execute\n  def execute(sql, *name)\n    # try to log sql command but ignore any errors that occur in this block\n    # we log before executing, in case the execution raises an error\n    raise \"THROW AN ERROR\"\n    begin\n        file = File.open(RAILS_ROOT + \"/log/sql.txt\",'a'){|f| f.puts Time.now.to_s+\": \"+sql}\n    rescue Exception =&gt; e\n      ;\n    end\n    # execute original statement\n    original_exec(sql, *name)\n  end\nend\n</code></pre>\n\n<p>And then run </p>\n\n<pre><code>Person.last\n</code></pre>\n\n<p>And I still get no error. </p>\n"},{"tags":["ruby-on-rails","rspec","devise","capybara","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13262299,"title":"Capybara, Devise, CanCan and RSpec integration tests: valid sign in 302 redirects to example.com","body":"<p>Update: see end of post for how the specs now work now that I have my specs in spec/requests instead of spec/controllers. Still wondering how to get a valid signed in user for integration tests with my controllers.</p>\n\n<p>I'm working with Devise and CanCan for the first time and am having difficulty doing the most basic of integration tests whereby I'm verifying that a logged in user is...well...logged in. I have read countless posts and answers dealing with Devise and RSpec integration tests (i.e. speeding them up by accessing the session directly via <a href=\"https://github.com/plataformatec/devise/wiki/How-To%3a-Test-with-Capybara\" rel=\"nofollow\">https://github.com/plataformatec/devise/wiki/How-To%3a-Test-with-Capybara</a>, <a href=\"http://schneems.com/post/15948562424/speed-up-capybara-tests-with-devise\" rel=\"nofollow\">http://schneems.com/post/15948562424/speed-up-capybara-tests-with-devise</a>, and <a href=\"http://stackoverflow.com/questions/13174592/capybara-rspec-and-devise-any-way-to-make-integration-tests-faster-by-circumve\">Capybara, RSpec and Devise: any way to make integration tests faster by circumventing slow login and setting session directly?</a>, but I have been unable to even get a standard post working as expected and I'm baffled:</p>\n\n<ol>\n<li>Development environment works fine (can log in and get redirected to proper page, with navigation login link changed to logout, etc.).</li>\n<li>test.log indicates no problems until it does a 302 redirect to <a href=\"http://www.example.com\" rel=\"nofollow\">http://www.example.com</a> instead of my root_path.</li>\n</ol>\n\n<p>By the plethora of users with similar issues with varying solutions, I'm obviously not the only one who has had this problem as various aspects of the session etc. are unavailable in different scenarios.</p>\n\n<p>Stripped down test:</p>\n\n<pre><code>subject { page }\n\ndescribe 'should be able to log in' do\n  before do\n    visit '/users/sign_in'\n    user = FactoryGirl.create(:admin)\n    #user.add_role :admin\n    fill_in 'Username', with: user.username\n    fill_in 'Password', with: user.password\n    click_on 'Sign in'\n  end\n  it { should have_link 'Logout' }\nend\n...\n</code></pre>\n\n<p>Relevant log.test output:</p>\n\n<pre><code> Started POST \"/users/sign_in\" for 127.0.0.1 at 2012-11-06 17:31:10 -0800\n Processing by Devise::SessionsController#create as HTML\n Parameters: {\"utf8\"=&gt;\"✓\", \"user\"=&gt;{\"username\"=&gt;\"username1\", \"password\"=&gt;\"[FILTERED]\",        \"remember_me\"=&gt;\"0\"}, \"commit\"=&gt;\"Sign in\"}\n [1m[36mUser Load (0.1ms)[0m  [1mSELECT \"users\".* FROM \"users\" WHERE \"users\".\"username\" =   'username1' LIMIT 1[0m\n [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1\n    [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m\n [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1\n [1m[36m (0.1ms)[0m  [1mUPDATE \"users\" SET \"last_sign_in_at\" = '2012-11-07   01:31:10.722712', \"current_sign_in_at\" = '2012-11-07 01:31:10.722712', \"last_sign_in_ip\" =   '127.0.0.1', \"current_sign_in_ip\" = '127.0.0.1', \"sign_in_count\" = 1, \"updated_at\" = '2012-11-  07 01:31:10.723051' WHERE \"users\".\"id\" = 1[0m\n [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1\n Redirected to http://www.example.com/\n Completed 302 Found in 12ms (ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>Stripped down routes.rb:</p>\n\n<pre><code>authenticated :user do\n  root :to =&gt; 'home#index'\nend\nroot :to =&gt; \"home#index\"\ndevise_for :users\nresources :users\n</code></pre>\n\n<p>Stripped down Ability:</p>\n\n<p>class Ability\n     include CanCan::Ability</p>\n\n<pre><code> def initialize(user)\n  user ||= User.new # guest user (not logged in)\n  if user.has_role? :admin\n    can :manage, :all\n  end\n  ...\n</code></pre>\n\n<p>And to be thorough, the current Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\ngem \"bootstrap-sass\", \"~&gt; 2.1.0.1\"\ngem 'faker', '1.1.2'\ngem 'will_paginate', '~&gt; 3.0.3'\ngem 'bootstrap-will_paginate', '~&gt; 0.0.9'\ngem 'jquery-rails'\ngem 'client_side_validations'\ngem 'thin'\ngem \"devise\", \"~&gt; 2.1.2\"\ngem \"cancan\", \"~&gt; 1.6.8\"\ngem \"rolify\", \"~&gt; 3.2.0\"\ngem \"simple_form\", \"~&gt; 2.0.4\"\n\ngroup :assets do\n   gem 'sass-rails',   '~&gt; 3.2.3'\n   gem 'coffee-rails', '~&gt; 3.2.1'\n   gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngroup :development, :test do\n gem 'sqlite3', '1.3.5'\n gem \"rspec-rails\", \"~&gt; 2.11.4\"\n gem 'guard-rspec', '1.2.1'\n #gem 'listen', github: 'guard/listen', branch: 'polling/double'\n gem 'guard-spork'\n gem 'guard-cucumber'\n gem 'spork', '0.9.2'\n gem \"factory_girl_rails\", \"&gt;= 4.1.0\"\nend\n\ngroup :development do\n  gem 'annotate', '2.5.0'\n  gem \"quiet_assets\", \"&gt;= 1.0.1\"\nend\n\n group :test do\n  gem 'capybara', \"&gt;= 1.1.2\"\n gem \"email_spec\", \"&gt;= 1.2.1\"\n gem \"cucumber-rails\", \"&gt;= 1.3.0\", :require =&gt; false\n gem \"database_cleaner\", \"&gt;= 0.9.1\"\n gem \"launchy\", \"&gt;= 2.1.2\"\n gem 'rb-fsevent', '0.9.1', :require =&gt; false\n gem 'growl', '1.0.3'\n gem 'terminal-notifier-guard'\nend\n\ngroup :production do\n    gem 'pg', '0.12.2'\n end\n</code></pre>\n\n<p>There's another user who had issues with this basic task, but it turned out it was simply a syntax error (see <a href=\"http://stackoverflow.com/questions/11320483/login-integration-test-with-rspec-devise\">Login integration test with rspec/devise</a>) so I'm sure I'm just missing something very obvious.</p>\n\n<p>Update:</p>\n\n<p>You have got to be kidding me. After leaving it for a couple hours, it turns out I had this spec for some reason in spec/controllers, when simply switching it over to spec/requests made everything green. </p>\n\n<p>I quote:</p>\n\n<blockquote>\n  <p>If you are using Rails, put your Capybara specs in spec/requests or\n  spec/integration.</p>\n</blockquote>\n\n<p>Found at <a href=\"https://github.com/jnicklas/capybara#readme\" rel=\"nofollow\">https://github.com/jnicklas/capybara#readme</a></p>\n\n<p>However, I'm still wondering how for future requirements I can do integration tests on my controllers that will need to have a logged in user.... for other non-Devise apps in the past, this has been as simple as something like the following:</p>\n\n<pre><code>describe SomeController do\n\n  let(:user) { FactoryGirl.create(:user) }\n\n  before { valid_sign_in user }\n\n...\n</code></pre>\n\n<p>where my helper is simply </p>\n\n<pre><code>  def valid_sign_in(user)\n    visit signin_path\n    fill_in \"Email\", with: user.email\n    fill_in \"Password\", with: user.password\n    uncheck(:remember_me)\n    click_button \"Sign In\"\n\n    # Sign in when not using Capybara as well.\n    cookies[:remember_token] = user.remember_token\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","configuration"],"answer_count":9,"favorite_count":38,"up_vote_count":103,"down_vote_count":0,"view_count":32416,"score":103,"question_id":1450285,"title":"How to define custom configuration variables in rails","body":"<p>I was wondering how to add custom configuration variables to a rails application and how to access them in the controller, for e.g I wanna be able to define an upload_directory in the configuration files say development.rb and be able to access it in one of my controllers.</p>\n\n<p>Secondly I was planning to have S3 support for uploads in my application, if i wanted to add a yaml file with the s3 access, secret key, how do I initialize it in my Rails App and how do I access the values that I have defined in that config file.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1348,"score":3,"question_id":283185,"title":"Retrieving client system information from a Rails application","body":"<p>Is it possible to retrieve the CPUID and MAC address of a client machine from a Ruby on Rails application?. Are there any plugins available for this?</p>\n"},{"tags":["ruby-on-rails","background-process"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13275239,"title":"Do I run a background job for this?","body":"<p>Hi I send out an email every time that someone follows another person in my web app. This significantly slows response time down because the ajax isn't rendered until the email is sent through the mailer. Is this a case where I use a background job? I'm unfamiliar with the use case for background jobs and am wondering, if this is the scenario to use it in, where to start.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pusher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13267972,"title":"How do I include the users in the result set?","body":"<pre><code>comments = Song.find(65).comments.select('comments.*, users.*').includes(:user).limit(20) \n</code></pre>\n\n<p>How would I include the users in the result set?</p>\n\n<p>Im using the <a href=\"http://pusher.com/\" rel=\"nofollow\">PusherApp</a> and trying to do:</p>\n\n<pre><code>    Pusher[\"foo\"].trigger(\"bar\", { \n      :comments =&gt; comments\n    })\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","design","frameworks","controllers"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13274295,"title":"Rails: Single page website, How to organise controllers/views etc","body":"<p>I have a single page website using ruby on rails as the framework.\nOn the single page I have a </p>\n\n<p>header</p>\n\n<p>section 1</p>\n\n<p>section 2</p>\n\n<p>section 3 etc</p>\n\n<p>footer</p>\n\n<p>The problem I am having is this, how do I organise the layouts/views/controllers.\nOnly in one section I have a form which needs processing and is linked to a database table (model). Can anyone advise me on how I can organise my ROR application?</p>\n"},{"tags":["ruby-on-rails","css3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13275157,"title":"Display error messages at the bottom of form submit","body":"<p>Is there a twitter boot strap class to display all validation error messages at the bottom of the form submit button?</p>\n\n<pre><code>&lt;div class=\"row-fluid\"&gt;\n&lt;div class=\"span12\"&gt; \n    &lt;div class=\"devise-body\"&gt;\n\n&lt;%= simple_form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name),\n      :html =&gt; { :class=&gt;'control-group error'} ) do |f| %&gt;\n      &lt;%= f.error_notification %&gt;\n      &lt;div class=\"controls\"&gt;\n        &lt;div class=\"row-fluid\"&gt;\n            &lt;div class=\"span6\"&gt;\n            &lt;%= f.input :first_name,:required=&gt;true,:autofocus =&gt; true %&gt;\n                            &lt;/div&gt;\n            &lt;div class=\"span6\"&gt;&lt;%= f.input :last_name,:required=&gt;true%&gt;  \n         &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"row-fluid\"&gt;\n            &lt;div class=\"span6\"&gt;&lt;%= f.input :company %&gt;&lt;/div&gt;\n            &lt;div class=\"span6\"&gt;&lt;%= f.input :title %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"row-fluid\"&gt;\n            &lt;div class=\"span6\"&gt; &lt;%= f.input :email, :required =&gt; true %&gt;&lt;/div&gt;\n            &lt;div class=\"span6\"&gt;&lt;%= f.input :phone_number %&gt;&lt;/div&gt;\n        &lt;/div&gt;  \n\n\n        &lt;%= f.input :password, :required =&gt; true %&gt;\n        &lt;%= f.input :password_confirmation, :required =&gt; true %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"form-actions\" &gt; \n        &lt;!-- #class=\"form-actions\" --&gt;\n        &lt;%= f.button :submit, \"Sign up\" ,:class =&gt; 'btn'%&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n    &lt;%= render \"devise/shared/links\" %&gt;\n   &lt;/div&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["ruby-on-rails","osx"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13274618,"title":"How to open port 443 on Mac 10.7.5?","body":"<p>Hi I'm receiving an SSL issue on my rails app on my local server:</p>\n\n<pre><code>An error occurred during a connection to localhost:3000.\n\nSSL received a record that exceeded the maximum permissible length.\n\n(Error code: ssl_error_rx_record_too_long)\n</code></pre>\n\n<p>and was told that opening port 443 would fix the problem. I've looked around everywhere but there doesn't seem to be an answer. Could someone go through the process of how I would open port 443?</p>\n"},{"tags":["ruby-on-rails","mongodb","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13239553,"title":"How can I allow persisting without parent document with an embeds_many association?","body":"<p>I have 2 Mongoid models that look something like this:</p>\n\n<pre><code>class User\n  include Mongoid::Document\n  field :name, type: String\n\n  embeds_many :jobs\nend\n\nclass Job\n  include Mongoid::Document\n  field :title, type: String\n\n  embedded_in :user\nend\n</code></pre>\n\n<p>This allows me to do something like</p>\n\n<pre><code>user.jobs.create(title: 'Test Job')\n</code></pre>\n\n<p>However, I'd like to be able to have some predefined jobs for a user to choose from, which would then be embedded in the user's document. Something like this:</p>\n\n<pre><code>Job.create(title: 'Predefined Job')\nuser.jobs &lt;&lt; Job.first\n</code></pre>\n\n<p>However, creating a job on it's own throws the following error</p>\n\n<blockquote>\n  <p>Cannot persist embedded document Role without a parent document.</p>\n</blockquote>\n\n<p>I'm kind of new to Mongoid, and can't find any examples of this in the documentation. Anyone know how you would do this?</p>\n"},{"tags":["ruby-on-rails","ruby","erb"],"answer_count":6,"favorite_count":1,"up_vote_count":15,"down_vote_count":0,"view_count":1148,"score":15,"question_id":4284421,"title":"What is the meaning of erb?","body":"<p>Why is the view of Rails application in the format <code>*.erb.html</code>? What does \"erb\" mean?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13274740,"title":"Issues executing Update.js","body":"<p>I have a controller where the update action responds to js. Everything is going fine but I'm experiencing some really bizarre behavior. Her is my code:</p>\n\n<pre><code>&lt;% if @contact.errors.any? %&gt;\n&lt;% else %&gt;\n  alert('What!?!');\n  $(\"li#contact\").replaceWith(\"&lt;%= escape_javascript render @contact %&gt;\");\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I have no errors, I'm able to replace my list item. However nothing before or after this line with run. The alert will not pop, any other manipulation will not run. Even cutting down the code to:</p>\n\n<pre><code>&lt;% if @contact.errors.any? %&gt;\n    &lt;% else %&gt;\n      alert('What!?!');\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I can not get it to alert. I know I don't have error rendering yet but what I'm executing has no errors. Has anyone experienced with wonky behavior before? (create.js, destroy.js all work fine).</p>\n"},{"tags":["ruby-on-rails","rspec","factory-girl","rspec-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13272530,"title":"How to get assigned value when a spec is run in RSpec?","body":"<p>I'm using the <code>FriendlyId</code> gem and it generates a slug when a record is saved. It works great.</p>\n\n<p>I can route to the slug like: <code>places/house-of-dead</code>, perfect. But I'm having a problem when it comes to testing.</p>\n\n<p>I'm using <code>FactoryGirl</code> to stub the parameters that I'm going to create, but I don't know how to get that generated slug to assert if my route redirects to it, my test is below and (<code>???? should be the generated slug</code>).:</p>\n\n<pre><code>    context '#create' do\n      it 'should redirect to place after created' do\n        place = FactoryGirl.attributes_for(:place)\n\n        post :create, { place: FactoryGirl.attributes_for(:place) }\n\n        response.should redirect_to places_path(slug: ????)\n      end\n    end\n</code></pre>\n\n<p>My controller is simple:</p>\n\n<pre><code>def create\n    @place = Place.new(params[:place])\n\n    # setting up who owns this place\n    @place.user = current_user\n\n    if @place.save\n      flash[:success] = \"Place created.\"\n\n      redirect_to @place\n    else\n      render :new\n    end\nend\n</code></pre>\n\n<p>As you can see, I use <code>redirect_to @place</code> and it redirects me to `place/:slug', but when it comes to testing that redirect, how do I do it?</p>\n\n<p>Also, is my testing way right/good?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-admin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13091638,"title":"How to override enumeration data in rail_admin gem","body":"<p>In my models, BookHeader has many Category\nSo, when edit or create new BookHeader, the form show like this\n<a href=\"http://nr7.upanh.com/b3.s32.d2/89392864d0eb4a6e3988ab7b137ff7fa_50339337.catetgoryfix.png\" rel=\"nofollow\">Enum fix?</a></p>\n\n<p>I wanna change the \"category #{id}\" to category name by define a category_enum method but it still don't work. Please help!</p>\n\n<p>Code for BookHeader model</p>\n\n<pre><code>class BookHeader &lt; ActiveRecord::Base\n  attr_accessible :autho, :category_id, :description, :title, :book_type, :year,:publisher_id,:detail\n  has_many :books\n  belongs_to :category\n  belongs_to :publisher\n  TYPE = {:ebook=&gt;\"Ebook\",:paper_book=&gt; \"PaperBook\",:magazine=&gt; \"Magazine\",:media=&gt; \"Media\"}\n  DEFAULT_TAB = :paper_book\n  BOOKS_PER_PAGE = 1 # books to show in a pages (pagination)\n  extend FriendlyId\n  def book_type_enum #it worked here\n    TYPE.map{|key, val| [val]}\n  end\n  def category_enum #but dont' work here\n    [\"a\",\"b\"]\n  end\n</code></pre>\n\n<p>Code for edit form</p>\n\n<pre><code>edit do\n        field :title\n        field :description, :text do\n          ckeditor do true end\n        end\n        field :autho\n        field :book_type\n        field :category\n      end\n</code></pre>\n\n<p>See the Division attribute in <a href=\"http://rails-admin-tb.herokuapp.com/admin/team/73/edit\" rel=\"nofollow\">this link</a></p>\n"},{"tags":["ruby-on-rails","mass-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13274059,"title":"another mass assignment issue with nested attributes","body":"<p>I have campaigns and messages. Campaigns have many messages and messages belongs to campaigns. I setup nested attributes for the models and in my view and i'm trying to create a message associated with the model. Here's the code:</p>\n\n<pre><code>class Campaign &lt; ActiveRecord::Base\n  attr_accessible :message_id, :name, :group_id, :user_id, :messages_attributes\n\n  has_many :messages\n  belongs_to :group\n  belongs_to :user\n\n  accepts_nested_attributes_for :messages\nend\n\nclass Message &lt; ActiveRecord::Base\n  attr_accessible :body, :sent, :sent_at\n\n  belongs_to :user\n  belongs_to :campaign\n  has_many :responses\n\nend\n</code></pre>\n\n<p>and the form:</p>\n\n<pre><code>= form_for @campaign, :html =&gt; {:class =&gt; 'form-horizontal'} do |f|\n...removed error output code...\n  %legend\n    Enter the campaign information\n  .field\n    .control-group\n      %label.control-label\n        Campaign Name\n      .controls\n        = f.text_field :name\n        = f.collection_select(:group_id, current_user.groups.all, :id, :name, :include_blank =&gt; true)\n        = f.fields_for :message do |m|\n          = m.text_area :body, :rows =&gt; 3\n      .form-actions= f.submit \"#{params[:action] == 'new' ? 'Create New Campaign' : 'Save Campaign'}\", :class =&gt; 'btn btn-success'\n</code></pre>\n\n<p>I know it's probably something really simple but I keep getting a mass assignment issue with message. Here's the error:</p>\n\n<pre><code>ActiveModel::MassAssignmentSecurity::Error (Can't mass-assign protected attributes: message):\n  app/controllers/campaigns_controller.rb:18:in `update'\n</code></pre>\n\n<p>and finally the params that get created from the form:</p>\n\n<pre><code>  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"(removed)\", \"campaign\"=&gt;{\"name\"=&gt;\"Weekly Poker\", \"group_id\"=&gt;\"1\", \"message\"=&gt;{\"body\"=&gt;\"s\"}}, \"commit\"=&gt;\"Save Campaign\", \"id\"=&gt;\"1\"}\n</code></pre>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","modal"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13264124,"title":"rendering twitter bootstrap modal in rails upon redirect","body":"<p>I have a functioning modal link that is clickable from a certain page in my views:</p>\n\n<pre><code>&lt;a href=\"#\" data-toggle=\"modal\" data-target=\"#manifesto-modal\"&gt;Manifesto &amp;amp; Rules&lt;/a&gt;\n</code></pre>\n\n<p>In addition to it being clickable on this page, I would like it to be displayed by default upon redirect to this page. I haven't found a great approach to coding this from the controller or otherwise, but can't imagine it would require too much. Input is appreciated!</p>\n"},{"tags":["ruby-on-rails","activerecord","transactions"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13274241,"title":"Howto handle nested transaction with ActiveRecord 3.0.4 and db_cleaner","body":"<p>We are using db_cleaner with clean method <code>:transaction</code> on a Rails 3.0.4 app (that we can't upgrade at the moment) with a MySQL 5.x DB. We can not use <code>:truncation</code>, cause we'd loose seed data.</p>\n\n<p>Now we face the following problem. ActiveRecord automatically generates a transaction when for example <code>:create</code> or <code>:destroy</code> are called on an ActiveRecord based object. In our RSpec suite we're using Machinist factories to create our test data for every test. Now in case we're testing functionality that creates it's own transaction, we face the problem, that the begin-commit cycle of our <code>Factory.make!</code> call inside a test not only quits the inner transaction (opened by <code>:create</code>) but also quits the transaction that was opened inside the tested code. In result the rollback triggered by db_cleaner can not roll back anything, and we still have our test data inside our database after a test ran. </p>\n\n<p>I think somebody must have faced this problem already. As MySQL does not support nested transactions, but ActiveRecord does simulate them by creating savepoints since version 2.3.2, we did not expect that behavior. </p>\n\n<p>Can anyone provide info, how to solve that particular problem?</p>\n"},{"tags":["ruby-on-rails","delayed-job","ruby-on-rails-2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13274526,"title":"DelayedJob fails silently when couldn't connect to database","body":"<p>So, i have a big rails application that is using delayed_job to send emails and SMS to the users. </p>\n\n<p>Once in a while, the delayed_job process will simply stop working without any message on the logs. I have finally pinpointed the problem as the delayed_job process crashs when it coulnd't  connect to the database.</p>\n\n<p>Is there any configuration i can make so it will retry the connection instead of just crashing? I've tried setting the <code>reconnect: true</code> on the <code>database.yml</code> file with no success.</p>\n\n<p>Another option that i'm looking for is maybe using a monitoring tool like god or bluepill.</p>\n"},{"tags":["ruby-on-rails","singleton"],"answer_count":6,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":5123,"score":10,"question_id":399447,"title":"How to implement a singleton model","body":"<p>I have a site in rails and want to have site-wide settings. One part of my app can notify the admin by SMS if a specific event happens. This is an example of a feature that I want configurable via the site-wide settings.</p>\n\n<p>So I was thinking I should have a Setting model or something. It needs to be a model because I want to be able to has_many :contacts for the SMS notification.</p>\n\n<p>The problem is that there can only be one post in the database for the settings model. So I was thinking of using a Singleton model but that only prevents new object to be created right?</p>\n\n<p>Would I still need to create getter and setter methods for each attribute like so:</p>\n\n<pre><code>def self.attribute=(param)\n  Model.first.attribute = param\nend\n\ndef self.attribute\n  Model.first.attribute\nend\n</code></pre>\n\n<p>Is it perhaps not best-practice to use Model.attribute directly but always create an instance of it and use that?</p>\n\n<p>What should I do here?</p>\n"},{"tags":["ruby-on-rails","postgresql","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13272024,"title":"Ruby Postgresl group statement","body":"<p>I have the following postgresql statement which works ok in navicat for Postgresql, </p>\n\n<pre><code>SELECT date_trunc('day', updated_at), count(*) as total_count \nFROM \"persons\"\nWHERE (\"persons\".\"updated_at\" BETWEEN '2012-10-17 00:00:00.000000' AND '2012-11-07   12:25:04.082224') \nGROUP BY date_trunc('day',updated_at)\nORDER BY count(updated_at) DESC\n</code></pre>\n\n<p>I get expected results like</p>\n\n<pre><code>2012-10-31 00:00:00,5\n2012-11-06 00:00:00,2\n2012-11-05 00:00:00,1\n</code></pre>\n\n<p>I need to convert this to ruby for a RoR project</p>\n\n<p>I've written this statement as follows</p>\n\n<pre><code>persons = where(updated_at: start.beginning_of_day..Time.zone.now)\npersons = persons.group(\"date(updated_at)\")\npersons = persons.select(\"updated_at, count(*) as total_count\")\npersons = persons.order(\"count(updated_at)\")\n</code></pre>\n\n<p>however i get the following error</p>\n\n<pre><code>PG::Error: ERROR:  column \"persons.updated_at\" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT updated_at, count(*) as total_count FROM \"persons\"  WH...\n           ^\n: SELECT updated_at, count(*) as total_count FROM \"persons\"  WHERE (\"persons\".\"updated_at\"     BETWEEN '2012-10-17 00:00:00.000000' AND '2012-11-07 14:38:54.674684') GROUP BY     date(persons.updated_at) ORDER BY count(updated_at)\n</code></pre>\n\n<p>any ideas on what i'm doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc","asset-pipeline","view-inheritance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13260900,"title":"With Rails 3 view inheritance, is it possible to call \"super\" within a child view, but send the parent variables?","body":"<p>Every <code>show</code> action in my app has the same template for every model (it is an Admin-portal type interface). I have a view <code>show.html.erb</code> that all of these models inherit. </p>\n\n<p>The controllers all use InheritedResources, so I have access to some helper variables such as <code>resource</code>, which I use to display the attributes for the model being shown through <code>resource.attributes</code> in my parent view.</p>\n\n<p>What I would like to be able to do is whitelist which attributes are being shown in each model. I have thought of two ways to do this... the first is to define some method in a class my model's inherit from, say it is called <code>attr_visible</code> and define each attribute in the model. The reason I don't like this approach is that it puts too much of the view logic in the models. I would rather provide my views with the model, and let the view determine what is displayed.</p>\n\n<p>The second approach is what this question is about. I want to have a file <code>/app/views/users/show.html.erb</code>, and set which attributes for a User I would like to be shown, say something like:</p>\n\n<pre><code>@attributes = [:name, :email, :etc]\n</code></pre>\n\n<p>And then pass them to the parent view which I described in the beginning of this question. That view would then be able to loop through <code>@attributes</code> and display the attributes necessary.</p>\n\n<p>Is it possible to use a \"<code>super</code>\"-type method from views? Everything I have read about view inheritance suggests the view is loaded based on where it is located in the directory structure, and then after that you're out of luck.</p>\n\n<p>edit: I have sort of done what I want. I defined a partial _show.html.erb in the /app/views/users directory that looks like:</p>\n\n<pre><code>&lt;% @attributes = ['name', ...] %&gt;\n</code></pre>\n\n<p>And then in the parent view I call <code>&lt;%= render \"show\" %&gt;</code> before looping through <code>@attributes</code>. This works, but feels clunky since I am not actually rendering anything when I call <code>render</code>. Is there a better way?</p>\n"},{"tags":["ruby-on-rails","ruby","joosy"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13264394,"title":"Joosy tutorial ActionView::Template::Error","body":"<p>I was going through the <a href=\"http://guides.joosy.ws/guides/blog/rails-preparations.html\" rel=\"nofollow\">Joosy Guide</a> but at the end of \"Rails Preparation\" section instead of the landing page, I get the following error:</p>\n\n<pre><code>ActionView::Template::Error (Mixin grid-core-span is missing argument $gridColumnWidth.\n  (in /Users/scribe/Code/joosy-blog/app/assets/stylesheets/application.css.scss)):\n    10:       };\n    11:     &lt;/script&gt;\n    12: \n    13:     &lt;%= stylesheet_link_tag 'application' %&gt;\n    14:     &lt;%= csrf_meta_tags %&gt;\n    15:   &lt;/head&gt;\n    16: \n  app/assets/stylesheets/application.css.scss:1\n  app/views/layouts/blog.html.erb:13:in `_app_views_layouts_blog_html_erb___1369399347943123030_70192156915780'\n  app/controllers/blog_controller.rb:5:in `index'\n</code></pre>\n\n<p>As far as I can tell I my project matches the instructions, any ideas as to what I messed up?</p>\n"},{"tags":["jquery","ruby-on-rails","amazon-s3","cors"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13208924,"title":"Amazon S3 CORS POST fails with JQuery-file-upload","body":"<p>I'm trying to upload files to S3 through an HTML uploader, I tried to follow this tutorial :</p>\n\n<p><a href=\"http://pjambet.github.com/blog/direct-upload-to-s3/\" rel=\"nofollow\">http://pjambet.github.com/blog/direct-upload-to-s3/</a></p>\n\n<p>I'm able to post files through regular html form. But if i post the same form with JQuery-file-upload plugin i get a 403 from Amazon.</p>\n\n<p>Here is my form :</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"https://youboox_dev.s3.amazonaws.com\" enctype=\"multipart/form-data\" class='direct-upload' method=\"POST\"&gt;\n &lt;input type=\"hidden\" name=\"key\" value=\"test-file-name\"&gt;\n &lt;input type=\"hidden\" name=\"AWSAccessKeyId\" value=\"AKIZ[...]YSCA\"&gt;\n &lt;input type=\"hidden\" name=\"acl\" value=\"private\"&gt;\n &lt;input type=\"hidden\" name=\"success_action_status\" value=\"201\"&gt;\n &lt;input type=\"hidden\" name=\"policy\" value=\"&lt;%= Facades::AmazonFacade.policy %&gt;\"&gt;\n &lt;input type=\"hidden\" name=\"signature\" value=\"&lt;%= Facades::AmazonFacade.signature %&gt;\"&gt;\n\n &lt;input type=\"file\" name=\"file\"&gt;\n\n &lt;input type=\"submit\" value=\"Load this file\"&gt;\n</code></pre>\n\n<p>And here is my jquery-uploader :</p>\n\n<pre><code>$('.direct-upload').fileupload({\n      url: $(this).attr('action'),\n      type: 'POST',\n      autoUpload: true,\n      dataType: 'xml',\n      add: function (event, data) {\n        jqXHR = data.submit();\n      }\n</code></pre>\n\n<p>I get this answer from amazon :</p>\n\n<blockquote>\n  <p>OPTIONS <a href=\"https://youboox_dev.s3.amazonaws.com/\" rel=\"nofollow\">https://youboox_dev.s3.amazonaws.com/</a> 200 (OK)<br>\n  POST <a href=\"https://youboox_dev.s3.amazonaws.com/\" rel=\"nofollow\">https://youboox_dev.s3.amazonaws.com/</a> 403 (Forbidden)</p>\n</blockquote>\n\n<p>========================================================</p>\n\n<p>I'm pretty sure my policy and signature are correct since when i just submit this form through the submit button, i get a ok response from amazon and 'im able to download the file i just uploaded :</p>\n\n<pre><code>&lt;PostResponse&gt;\n  &lt;Location&gt;https://youboox_dev.s3.amazonaws.com/tottotoCVBNBV&lt;/Location&gt;\n  &lt;Bucket&gt;youboox_dev&lt;/Bucket&gt;\n  &lt;Key&gt;test-file-name&lt;/Key&gt;\n  &lt;ETag&gt;\"d41d8cd98f00b204e9800998ecf8427e\"&lt;/ETag&gt;\n&lt;/PostResponse&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","oauth","twitter-api","omniauth","twitter-oauth"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12153914,"title":"OmniAuth with Twitter Strategy intermittent \"invalid_credentials\" failure for some users","body":"<p>I've implemented OmniAuth + Twitter strategy. It works most of the time for most users. But some users have been getting a consistent failure, and I have not been able to reproduce it or track it down. After logging in to twitter, the user is redirected to </p>\n\n<pre><code>/auth/failure?message=invalid_credentials\n</code></pre>\n\n<p>I was able to run an HTTP debugger on one users machine during a failure to see the web traffic, and saw the following:</p>\n\n<pre><code>302 GET       myserver.com/auth/twitter\n    CONNECT   api.twitter.com:443\n401 GET       myserver.com/auth/twitter/callback?oauth_token=....&amp;oauth_verifier=....\n302 GET       myserver.com/auth/twitter/callback?oauth_token=....&amp;oauth_verifier=....\n401 GET       myserver.com/auth/failure?message=invalid_credentials&amp;strategy=twitter\n302 GET       myserver.com/auth/failure?message=invalid_credentials&amp;strategy=twitter\n</code></pre>\n\n<p>Once this starts happening for a user, it happens consistently over and over, and even clearing cookies and restarting the browser doesn't fix it. Not sure - but it may be only happening to a user that has logged in the day before and kept their browser open.</p>\n\n<p>I implemented the twitter login in a very lightweight method as you'll see:</p>\n\n<p>user.rb:</p>\n\n<pre><code>class User\n\n  attr_accessor :name, :screen_name, :twitter_secret, :twitter_token\n\n  def initialize(auth)\n    @screen_name = auth['info']['nickname']\n    @twitter_secret = auth[\"credentials\"][\"secret\"]\n    @twitter_token = auth[\"credentials\"][\"token\"]\n    @name = auth[\"info\"][\"name\"]\n  end\n\nend\n</code></pre>\n\n<p>session_controller.rb:</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n\n  def reset_and_auth\n    reset_session\n    redirect_to '/auth/twitter?force_login=true'\n  end\n\n  def create\n    user = User.new(request.env[\"omniauth.auth\"])\n    session[:current_user] = user\n    redirect_to root_path, :notice =&gt; \"Signed in!\"\n  end\n\n  def destroy\n    session.delete(:current_user)\n    redirect_to root_path, :notice =&gt; \"Signed out!\"\n  end\n\n  def failure\n    flash[:auth_failure] = params[:message]\n    redirect_to root_path\n  end\n\nend\n</code></pre>\n\n<p>relevant parts of application_controller.rb:</p>\n\n<pre><code>helper_method :current_user\n</code></pre>\n\n<p>and</p>\n\n<pre><code>def current_user\n  session[:current_user]\nend\n</code></pre>\n\n<p>initializers/omniauth.rb:</p>\n\n<pre><code>twitter_config = YAML.load_file(File.join(Rails.root,'config','twitter.yml'))[Rails.env]\n\nRails.application.config.middleware.use OmniAuth::Builder do\n  provider :twitter, twitter_config['consumer_key'], twitter_config['consumer_secret']\nend\n</code></pre>\n\n<p>Other notes of interest (after much googling)</p>\n\n<ul>\n<li>This is running on Heroku, so I don't think server Time sync could be the issue</li>\n<li>The app on dev.twitter.com is configured with a matching callback URL, and a matching hostname</li>\n<li>The keys and tokens are obviously correct, because it works for most users, most of the time</li>\n<li>This can't be a problem of <em>actual</em> wrong credentials, because in that case the user gets a message about the password being wrong on the twitter login page and doesn't get redirected</li>\n<li>Once this happens to one user, it happens consistently and they can't login on that browser. However they can login on a different browser. Also about a day or so later they can login again</li>\n<li>From browsing the source of the oauth gem, I <em>think</em> it is raising an ::OAuth::Unauthorized exception here <a href=\"https://github.com/intridea/omniauth-oauth/blob/master/lib/omniauth/strategies/oauth.rb\" rel=\"nofollow\">https://github.com/intridea/omniauth-oauth/blob/master/lib/omniauth/strategies/oauth.rb</a></li>\n</ul>\n\n<p>Gem versions:</p>\n\n<pre><code>oauth (0.4.6)\nomniauth (1.1.0)\n  hashie (~&gt; 1.2)\n  rack\nomniauth-oauth (1.0.1)\n  oauth\n  omniauth (~&gt; 1.0)\nomniauth-twitter (0.0.12)\n  multi_json (~&gt; 1.3)\n  omniauth-oauth (~&gt; 1.0)\nrails (3.2.6)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13230787,"title":"make variable available in all method of controller when passed in one method","body":"<p>Here i send the user.id as params dd</p>\n\n<pre><code>&lt;h3&gt;&lt;%= link_to(\"Lend Asset\", {:controller =&gt; 'empassets', :action=&gt; 'index', :dd =&gt; user.id})%&gt;&lt;/h3&gt;\n</code></pre>\n\n<p>In controller empassets i fetch it by </p>\n\n<pre><code>  def index\n     @id = params[:dd]\n     @empassets = Empasset.where(:ad =&gt; @id)\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @empassets }\n    end\n  end\n\n  def show\n     @id = params[:dd]\n    @empasset = Empasset.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @empasset }\n    end\n  end\n\n  def new\n     @id = params[:dd]\n    @empasset = Empasset.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @empasset }\n    end\n  end\n\n  def edit\n     @id = params[:dd]\n    @empasset = Empasset.find(params[:id])\n  end\n</code></pre>\n\n<p>I need this @id in all new show edit method. But it takes in index only as i mention it in index. How can i make such that if Lend asset is click then @id= params[:id] have value in all methods. How can it is possible to make it available for another @id = params[:id] is not send in that controller?</p>\n"},{"tags":["ruby-on-rails","imagemagick","e-commerce","thumbnails","spree"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13078168,"title":"How does thumbnails settings and changes work in Spree?","body":"<p>I'm building my first Spree application and my own layout/theme for it. I need to change thumbnail sizes for products and have been directed differently, mostly it seems to be an unpopular subject. How does this work and how do I change it?</p>\n\n<h3>Spree configuration</h3>\n\n<p>config/initializers/spree_config.rb</p>\n\n<pre><code>Spree::Config.set(\n    attachment_styles: \"{\n        \\\"mini\\\":\\\"48x48&gt;\\\",\n        \\\"small\\\":\\\"110x110&gt;\\\",\n        \\\"product\\\":\\\"340x340&gt;\\\",\n        \\\"large\\\":\\\"650x650&gt;\\\"\n    }\"\n)\n</code></pre>\n\n<p>That is how I tried it the first time - no effect.</p>\n\n<h3>Clearing cache</h3>\n\n<p>I tried to clear the cache like so:\n<code>rake tmp:clear</code> which gave no result.</p>\n\n<h3>Re-upload?</h3>\n\n<p>I tried re-uploading some images to force a re-generation of thumbnails and there <em>was</em> results but not for all sizes. For instance, there seems to be really hard to create a 340x340 px image for 'product' size.</p>\n\n<p>What I'm after is a way to re-generate all thumbnails according to my own defined sizes.</p>\n\n<p><code>ruby 1.9.3p194 | Rails 3.2.8 | Spree 1.2.0</code></p>\n"},{"tags":["ruby-on-rails","ruby","rvm","redmine"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13273014,"title":"How to use custom ruby and rails for different applications?","body":"<p>I am using Ubuntu 12.04. </p>\n\n<p>I also have ruby and rails installed on my system using the <strong>rvm</strong>. This is a custom installation and not the ubuntu package.</p>\n\n<p>I want to install Redmine on my system. However, when I install it using</p>\n\n<pre><code>aptitude install redmine redmine-mysql\n</code></pre>\n\n<p>it does not find ruby or rails as it is not installed via <code>aptitude</code>. Is it possible to make Redmine use my custom installation and not install the default ruby/rails.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270656,"title":"Mailbox not sending e-mails: wrong number of arguments (1 for 0)","body":"<p>When sending a message I can see this in my console:</p>\n\n<pre><code>Sent mail to You should add method :mail_email in your Messageable model (2093ms\n)\nDate: Wed, 07 Nov 2012 14:08:50 +0100\nFrom: mail@myemail.com\nto: You should add method :mail_email in your Messageable model\n</code></pre>\n\n<p>And the initializers for the Mailbox gem:</p>\n\n<pre><code>Mailboxer.setup do |config|\n\n  #Configures if you applications uses or no the email sending for Notifications and Messages\n  config.uses_emails = true\n\n  #Configures the default from for the email sent for Messages and Notifications of Mailboxer\n  config.default_from = \"mail@myemail.com\"\n\n  #Configures the methods needed by mailboxer\n  config.email_method = :mail_email\n  config.name_method = :name\n\n  #Configures if you use or not a search engine and wich one are you using\n  #Supported enignes: [:solr,:sphinx] \n  config.search_enabled = false\n  config.search_engine = :solr\nend\n</code></pre>\n\n<p>In my user model I have: </p>\n\n<pre><code>acts_as_messageable\n  def name\n    email\n  end\n\n def mail_email\n    @mail_email = self.email\n end\n</code></pre>\n\n<p>But I get this error in view when sending a message:</p>\n\n<pre><code> ArgumentError in ConversationsController#reply\n\nwrong number of arguments (1 for 0)\n\nRails.root: C:/rails/sitesale\nApplication Trace | Framework Trace | Full Trace\n\napp/models/user.rb:17:in `mail_email'\napp/controllers/conversations_controller.rb:22:in `reply'\n</code></pre>\n\n<p>And the controller method reply:</p>\n\n<pre><code>  def reply\n    current_user.reply_to_conversation(conversation, *message_params(:body, :subject))\n    redirect_to conversation\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13266384,"title":"How do I number records returned from a database?","body":"<p>If I have records ordered by date from a database, I would like to add a number corresponding according to how the record is ordered. E.g, if a record was ordered by a given date I would like to add an incrementing number to it:</p>\n\n<pre><code>1). Me\n2). You\n3). Us\n</code></pre>\n"},{"tags":["ruby-on-rails","factory-girl"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13272763,"title":"Test failing on creating factory","body":"<p>I have a problem concerning testing with factorygirl:</p>\n\n<p>First some code:</p>\n\n<p>customesr_spec.rb:</p>\n\n<pre><code>require 'spec_helper'\n\n\ndescribe \"customers\" do\n  describe \"signup\" do\n    #FactoryGirl.find_definitions\n    user = FactoryGirl.create(:signup_customer)\n    it \"has right data\" do\n      visit signup_path\n      fill_in :id, :with =&gt; 2110001\n      fill_in :name, :with =&gt; \"AVK POLSKA Sp. zo.o.\"\n      fill_in :email, :with =&gt; \"my.email@provider.be\"\n      fill_in :email_confirmation, :with =&gt; \"my.email@provider.be\"\n      click_button \"Create account\"\n      page.should have_content(\"Fireprotection\")\n    end\nend\n</code></pre>\n\n<p>factories.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :signup_customer, class: Customer do\n    id = 2110001\n    name = \"AVK POLSKA Sp. zo.o.\"\n    email = \"\"\n    address_1 = \"ul. Jakubowska 1\"\n    address_2 = \"Pniewy 62-045\"\n    zipcode = 62\n    city = \"Pniewy\"\n    currency = \"PLN\"\n    country_id = \"PL\"\n    contact_person_id = \"AZU\"\n    reset_token = nil\n    reset_token_init = nil\n  end\nend\n</code></pre>\n\n<p>This is the error that I get when running that test:</p>\n\n<pre><code>Running tests with args [\"--drb\", \"-f\", \"progress\", \"-r\", \"c:/Ruby193/lib/ruby/gems/1.9.1/gems/guard-rspec-2.1.1/lib/guard/rspec/formatter.rb\",\n \"-f\", \"Guard::RSpec::Formatter\", \"--out\", \"/dev/null\", \"--failure-exit-code\", \"2\", \"spec\"]...\n  &lt;-- take tuple(1); slave.run...\n09:17:40 - ERROR - Guard::RSpec failed to achieve its &lt;start&gt;, exception was:\n</code></pre>\n\n<blockquote>\n  <p>[#73C9383A03A6] DRb::DRbUnknownError: ActiveRecord::\n  [#73C9383A03A6] c:/Ruby193/lib/ruby/1.9.1/drb/drb.rb:1095:in <code>method_missing'\n  [#73C9383A03A6] c:/Ruby193/lib/ruby/gems/1.9.1/gems/guard-rspec-2.1.1/lib/guard/rspec/runner.rb:124:in</code>run_via_drb'</p>\n</blockquote>\n\n<p>Do I have to put a require somewhere? What am I missing here?</p>\n"},{"tags":["ruby-on-rails","facebook","cron","fb-graph"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13272580,"title":"Facebook - post to page wall when user is not logged in (via FbGraph)","body":"<p>I use <code>FbGraph</code> gem and this part of code:</p>\n\n<pre><code>page = FbGraph::Page.new(ID_OF_MY_PAGE)\nfeed = page.feed!(\n  :access_token =&gt; access_token,\n  :subject =&gt; 'testing',\n  :message =&gt; 'Hey, I\\'m testing you!'\n)\n</code></pre>\n\n<p>It's working only if I (as the owner of the page) am logged in. I would need to run this task with CRON. Is there any way to set up the tokens for posting statuses if I wouldn't need to be logged in?</p>\n"},{"tags":["ruby-on-rails","rspec","include"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13217576,"title":"rspec - stub included methods","body":"<p>I need to stub a helper method that's included inside a controller. Yes it's bad practice but for now that's what what i have to live with.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  include ApplicationHelper \n</code></pre>\n\n<p>Say application_helper has a method <code>:foo</code> that's included inside the controller.\nI've tried stubbing like:</p>\n\n<ol>\n<li><code>controller.stub(:foo)</code></li>\n<li><code>@helper = Object.new.extend ApplicationHelper; @helper.stub(:foo)</code></li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby","menu","languages"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13255037,"title":"how would you provide menu written in different (locale) languages instead of repeating them in every page?","body":"<p>below is an example of menu in french, I will also have it in another five more languages:</p>\n\n<pre><code>&lt;a href=\"/&lt;%= @lang %&gt;/\"&gt;Jeux&lt;/a&gt;\n&lt;a href=\"/&lt;%= @lang %&gt;/get-the-player\"&gt;Obtenir le lecteur&lt;/a&gt;\n&lt;a href=\"/&lt;%= @lang %&gt;/about\"&gt;À propos&lt;/a&gt;\n&lt;a href=\"/&lt;%= @lang %&gt;/faq\"&gt;FAQ&lt;/a&gt;\n&lt;a href=\"/&lt;%= @lang %&gt;/contact\"&gt;Contact&lt;/a&gt;\n</code></pre>\n\n<p>at the moment the menu are in a relevant pages (.html.erb), by using the code listed below</p>\n\n<pre><code>&lt;%= content_for :menu do %&gt;    \n    &lt;a href=\"/&lt;%= @lang %&gt;/\"&gt;Jeux&lt;/a&gt;\n    &lt;a href=\"/&lt;%= @lang %&gt;/get-the-player\"&gt;Obtenir le lecteur&lt;/a&gt;\n    &lt;a href=\"/&lt;%= @lang %&gt;/about\"&gt;À propos&lt;/a&gt;\n    &lt;a href=\"/&lt;%= @lang %&gt;/faq\"&gt;FAQ&lt;/a&gt;\n    &lt;a href=\"/&lt;%= @lang %&gt;/contact\"&gt;Contact&lt;/a&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>once I have done above I have got the reference on the application.html.erb</p>\n\n<pre><code>&lt;%= yield :menu %&gt;\n</code></pre>\n\n<p>it can be done exactly the same way for other languages, however, is there a way where I could avoid the repetition of the code. perhaps makes the controller to go and find for it and render it in exact place ? Help please,</p>\n\n<p>thanks in advance!</p>\n\n<p>===========================================================================</p>\n\n<pre><code>    **CHECK BELOW FOR SOLUTIONS THAT I HAVE PROVIDED**\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2244,"score":1,"question_id":4457446,"title":"Rails form text field helper, how to make the input area wider?","body":"<p>How do I make the text field area wider?</p>\n\n<p>I tried:</p>\n\n<p>f.text_field   :title, size => 150</p>\n\n<p>I also tried width, I am missing something here, what is it?</p>\n"},{"tags":["ruby-on-rails","ruby","gem","gemfile","debugger-linecache"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":561,"score":1,"question_id":11354768,"title":"An error occurred while installing debugger-linecache (1.1.1), and Bundler cannot continue","body":"<p>Any idea how to fix this?</p>\n\n<pre><code>Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n/home/durrantm/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb \nchecking for vm_core.h... no\nchecking for vm_core.h... no\nMakefile creation failed\n**************************************************************************\nNo source for ruby-1.9.3-p194 provided with debugger-ruby_core_source gem.\n**************************************************************************\n</code></pre>\n"},{"tags":["ruby-on-rails","url","anchor"],"answer_count":2,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":2876,"score":10,"question_id":4108082,"title":"Get anchor part of URL in controller in Ruby on Rails","body":"<p>there is a way to get the anchor part of an url in a controller?</p>\n\n<p>Example: if I type <a href=\"http://www.foo.com/bar#anchor123\" rel=\"nofollow\">http://www.foo.com/bar#anchor123</a> can I get the string anchor123 in my controller??</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","query","webhooks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13272004,"title":"RnR: Long running query, Heroku timeouts: webhooks? Ajax?","body":"<p>So here's the issue, we have a data that the users want displayed.  The query, we optimized and indexed to be as fast as I think its going get.  We might shave off a second or two but with the amount of data, not much we can do.  </p>\n\n<p>Anyway, so the query runs great when limited to a day or two of data, however the users are running it for a week or two of data.  So the query for two or three weeks of data takes about 40 seconds, with a Heroku timeout of 30 seconds, that doesn't work.  So we need a solution.  </p>\n\n<p>So searching here and Google, I see comments that webhooks or Ajax would work as out solution.  However, I've been unable to find a real concrete example.  I also saw a comment where someone was saying we could send some kind of response that would \"reset the clock.\" But again sounded intriguing but couldn't find an example.  </p>\n\n<p>We're kind of under the gun, the users are unhappy, so we need a solution that is fast and simple.  Thanks in advance for your help! </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","acts-as-taggable-on","posts"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":457,"score":1,"question_id":10274885,"title":"Acts_as_taggable_on implementation tutorial","body":"<p>I've been trying to allow for tags to be placed on posts so that I could partition them into different sections of my app. I've looked through various gems and have found that acts_as_taggable_on seems to be the most popular one. After various attempts of implementation from the examples in the github of the gem I have not been able to successfully use it. I've searched extensively for a tutorial on implementation but have found none and was hoping someone would have one for such a thing. I'm sorry for the simple question as I am still relatively new to programming. </p>\n"},{"tags":["jquery","ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13247589,"title":"Rails Nested Resources - create and edit 2 levels away with form_for in partial","body":"<p>Really racking my brain on this one.  I'm relatively new to Rails and trying to do something that I'm sure is not too difficult.</p>\n\n<p>I have a model \"Trip\" which has many \"Days\" which has many \"Activities\"</p>\n\n<p>I am in the show.html.erb view of \"Trip\" and in this view, I am rendering a partial for a form that should allow me to create a new \"Activity\" to be associated with a \"Day\" or edit an existing \"Activity\" which already belongs to a \"Day\"</p>\n\n<p>How do I pass to the form_for in the form partial, the local variable of which \"Day\" I want to create the new \"Activity\" for.  And using that same form partial, how can I retrieve the \"Day\" that the \"Activity\" is associated with? Eventually these will be AJAX loaded objects.\nI've googled for the past several hours and can't find any examples similar to this.  I really appreciate the help.</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>  resources :trips do\n    resources :days    \n  end\n\n  resources :days do\n    resources :activities\n  end \n</code></pre>\n\n<p><strong>show.html.erb for the Trip</strong></p>\n\n<pre><code>&lt;div id=\"activities_list\"&gt;\n  &lt;%= render :partial =&gt; \"activities\" %&gt;\n&lt;/div&gt; \n\n&lt;div id=\"activity_form\"&gt;\n  &lt;%= render :partial =&gt; \"/activities/form\", :locals =&gt; { :activity =&gt; @activity}  %&gt;\n&lt;/div&gt;\n\n&lt;div id=\"bottom\"&gt;\n&lt;%= link_to 'Edit', edit_trip_path(@trip) %&gt; |\n&lt;%= link_to 'Back', trips_path %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>_activities.html.erb partial</strong></p>\n\n<pre><code>&lt;h1&gt;&lt;%= @trip.title %&gt;&lt;/h1&gt;\n\n&lt;% @trip.days.each do |day| %&gt;\n&lt;div id=\"blech_&lt;%= day.id %&gt;\"&gt;\n  &lt;b&gt;&lt;%= day.summary %&gt;&lt;/b&gt;\n      &lt;% day.activities.each do |activity| %&gt;\n            &lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_day_activity_path(day, activity), :remote =&gt; true  %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;%= link_to 'New Activity', new_day_activity_path(day), :remote =&gt; true %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>_form.html.erb partial</strong> I know that I need to be calling the day_activity_path with (@day,@activity) variables.  but I don't know how to get the @day variable in here</p>\n\n<pre><code>  &lt;%= form_for([@activity], :remote =&gt; true) do |f| %&gt;\n     &lt;fieldset&gt;\n       &lt;%= f.label :title, \"Activity\" %&gt;&lt;br /&gt;\n       &lt;%= f.text_field :title, :rows =&gt; 1 %&gt;&lt;br /&gt;\n     &lt;/fieldset&gt;\n\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","gem","bundler"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":355,"score":0,"question_id":6337107,"title":"bundle install failing because of activesupport","body":"<p>I've read every post I can find about this but nothing is working. I'm running a Rails 2.3.4 app and I'm trying to get bundler working so I can use Heroku as my staging server. I've installed bundler, edited the necessary files, and created the gemfile. When I run bundle install I get:</p>\n\n<blockquote>\n  <p>Could not find gem 'activesupport (= 2.3.4, = 3.0.5, runtime)' in any of the gem sources listed in your Gemfile.</p>\n</blockquote>\n\n<p>Here is my gemfile:</p>\n\n<pre><code>source :rubygems\nsource :rubyforge\n\ngem 'abstract'\ngem 'actionmailer'\ngem 'actionpack'\ngem 'activemodel'\ngem 'activerecord'\ngem 'activeresource'\ngem 'activesupport', '2.3.4', '3.0.5'\ngem 'haml'\ngem 'mail'\ngem 'mime-types'\ngem 'mongrel'\ngem 'rails', '2.3.4'\ngem 'rake'\ngem 'savon', '0.7.9'\ngem 'spreadsheet'\ngem 'sqlite3'\ngem 'sqlite3-ruby'\ngem 'prawn'\ngem 'mysql'\ngem 'vlad'\ngem 'vlad-git'\n</code></pre>\n\n<p>I've tried multiple sources and nothing works. I'm running ruby 1.8.7 with rvm.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby","debugging"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13271248,"title":"Debugger going to implicit.rb automatically","body":"<p>I installed debugger gem in my gemset</p>\n\n<pre><code>&lt;pre&gt;\nnikhil@nikhil-K54C:/media/media1/railscode/beasport$ bundle show debugger\n/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/gems/debugger-1.2.0\n&lt;/pre&gt;\n</code></pre>\n\n<p>My intention is to use this gem to debug my application by placing \"debugger\" call in my code so that i can use it to debug application.\nHowever strangely even if i have not put \"debugger\" call anywhere in my code but still whenever i hit any url to my application (from localhost:3000), debugger starts debugging in file </p>\n\n<pre><code>&lt;pre&gt;\n/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/gems/actionpack-3.2.8/lib/action_controller/metal/implicit_render.rb\n&lt;/pre&gt;\n</code></pre>\n\n<p>here is what i get when i do \"list\"</p>\n\n<pre><code>&lt;pre&gt;\n\n=&gt; Ctrl-C to shutdown server\n[2012-11-07 19:11:18] INFO  WEBrick 1.3.1\n[2012-11-07 19:11:18] INFO  ruby 1.9.3 (2012-04-20) [i686-linux]\n[2012-11-07 19:11:18] INFO  WEBrick::HTTPServer#start: pid=6602 port=3000\n/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/gems/actionpack-3.2.8/lib/action_controller/metal/implicit_render.rb:5\ndefault_render unless response_body\n(rdb:1) list\n[0, 9] in /home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/gems/actionpack-3.2.8/lib/action_controller/metal/implicit_render.rb\n   1  module ActionController\n   2    module ImplicitRender\n   3      def send_action(method, *args)\n   4        ret = super\n=&gt; 5        default_render unless response_body\n   6        ret\n   7      end\n   8  \n   9      def default_render(*args)\n(rdb:1) \n&lt;/pre&gt;\n</code></pre>\n\n<p>I am using webrick. This is frustrating. When i remove debugger gem from gemfile and do \"bundle install\" then it works fine but i wont be able to debug my application then.\nAgain i checked with my other application and there debugger works just fine and do not go to implicit.rb unnecessarily.\nPlease help</p>\n"},{"tags":["ruby-on-rails","ruby","nokogiri"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13263955,"title":"Extract information from website using nokogiri","body":"<p>I'm trying to figure out how to extract the information on a file using nokogiri.</p>\n\n<p>The information generated isn't an xml or html file.. so not sure how to get this!</p>\n\n<pre><code>def get_summoner_account\n    url = \"http://elophant.com/api/v1/euw/getSummonerByName?summonerName=Heggom&amp;key=0r57xO0H2A7ukQi6gUbG \"\n    doc = Nokogiri::HTML(open(url))\n\n    name = doc.xpath(\"name\").collect(&amp;:text)\n    acctID = doc.xpath(\"acctID\").collect(&amp;:text)\n    summonerId = doc.xpath(\"summonerId\").collect(&amp;:text)\n\n    puts accID\n    puts name\n    puts summonerID\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13270895,"title":"In Rails, can I put views in the 'vendor' directory?","body":"<p>In my Rails app, I have some views (layouts, partials) that I want to put in <code>vendor/views</code> and <code>vendor/views/layouts</code> instead of <code>app/views</code>. But, it's implied by the guides (and the base project structure) that only <code>assets</code> and <code>plugins</code> are put in <code>vendor</code>. Still, can I do this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","rdoc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13261994,"title":"RDoc just my own application?","body":"<p>Is there a way to stop RDoc from going higher than the current directory? i just tried</p>\n\n<pre><code>rdoc -O -x ../\n</code></pre>\n\n<p>but this also stopped it from parsing relative pathes in subdirectories; what I really need is something like:</p>\n\n<p>If absolute path of App is /foo/bar/MyAppDir/, just RDoc all sources inside and below /foo/bar/MyAppDir/ without parsing /foo/bar/OtherRepository/ from wich some classes derive and get functions I dont want to document.</p>\n"},{"tags":["ruby-on-rails","ruby","parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12802268,"title":"Ruby, fetch first image from a text","body":"<p>Within a Ruby class, I want to parse and fetch the first occurance of an image inside some text that is saved in a database. In particular, I want to collect all <code>src</code> attributes.</p>\n\n<p>Will Nokogiri help me? How can I do it?</p>\n\n<hr>\n\n<p>Edit1:</p>\n\n<p>I wrote:</p>\n\n<pre><code>// database stuff...\ndoc = Nokogiri::HTML(my_html)\n\ndoc.search('img') do |img_tag|\n  puts img_tag\nend\n</code></pre>\n\n<p>But I'm not able to collect the image tags.</p>\n\n<hr>\n\n<p>Edit2:</p>\n\n<p>I found the solution:</p>\n\n<pre><code>doc.search('img').each do |img_tag|\n  puts img_tag.attributes['src']\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec2","resque"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13261986,"title":"How do you separate test queues and real queues when testing Resque (with rspec and rails?)","body":"<p>I would like to test some resque workers, and the actions that enqueue jobs with these workers. I am using rspec and rails.</p>\n\n<p>Currently I have a model, let's call it Article.rb, that has a before_save method called updates_related_categories that checks if a job with CategoriesSorter needs to be enqueued. If so, it enqueues a job with that worker, with the argument of the category id that the article is related to.</p>\n\n<p>In test, however, these jobs are sent to the same queue as the development server sends jobs to. (i check using the resque server that you can tie into your server at root/redis/overview)</p>\n\n<p>I want to know:</p>\n\n<p>1) How can I send test jobs to a different queue than the development jobs?</p>\n\n<p>If this is possible, any other advice on testing resque is also welcome.</p>\n\n<p>I have seen some related questions that suggest resque-unit and resque-spec but these are pretty undeveloped, and I couldn't get them to a useful working state. Also, I have heard of using Resque.inline but I don't know if that is relevant in this case, as resque isn't called in test specs, it's called from the article model on save of objects created in test.</p>\n\n<p>Sample Code:</p>\n\n<p>Article.rb:</p>\n\n<pre><code> before_save :update_related_categories\n def update_related_categories\n     #some if statements/checks to see if a related category needs updating\n         Resque.enqueue(CategoriesWorker, [category_id])\n     end\n end\n</code></pre>\n\n<p>CategoriesSorter:</p>\n\n<pre><code> class CategoriesSorter\n     @queue=:sorting_queue\n     def self.perform(ids)\n        ids.each do |id|\n           #some code\n        end\n      end\n end\n</code></pre>\n\n<p>Specs:</p>\n\n<pre><code> it \"should do something\" do\n     @article = #set something to enqueue a job\n     @article.save\n     #can i check if a job is enqueued? can i send this job NOT to the development queue but a different one?\n end\n</code></pre>\n"},{"tags":["ruby-on-rails","arrays","multidimensional-array","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":26,"score":3,"question_id":13270558,"title":"How can I convert a 'long' table into a 'wide' table through an array?","body":"<p>The thing I want to do is the following: I have a table built from an array.\nLet's say:  </p>\n\n<pre><code>_________\n| a | b |\n| c | d |\n| e | f |\n</code></pre>\n\n<p>Now I want it 'converted' to:</p>\n\n<pre><code>_____________\n| a | c | e |\n| b | d | f |\n</code></pre>\n\n<h3>Using:</h3>\n\n<p>Ruby: <code>1.9.3</code><br>\nRails: <code>3.2.8</code>  </p>\n\n<h3>Goal:</h3>\n\n<pre><code>a = [['a','b'],\n     ['c','d'],\n     ['e','f']]\n\narray_for_table = conv_array_for_table a\n=&gt; [['a','c','e'],\n    ['b','d','f']]\n</code></pre>\n\n<h3>Research:</h3>\n\n<p><a href=\"http://www.ruby-doc.org/core-1.9.3/Array.html\" rel=\"nofollow\">Array Class Doc</a>, but  I couldn't find anything about this here.<br>\n<br>\nThought I might have to do someting with array of hash or something..<br>\n<a href=\"http://stackoverflow.com/questions/9270972/convert-array-of-2-element-arrays-into-a-hash-where-duplicate-keys-append-addit\">SO, question</a></p>\n\n<blockquote>\n  <p>Given an array:<br>\n  <code>array = [[:a,:b],[:a,:c],[:c,:b]]</code>  </p>\n  \n  <p>Return the following hash:<br>\n  <code>hash = { [:a =&gt; [:b,:c]] , [:c =&gt; :b] }</code></p>\n  \n  <p>Hash[array] overwrites previous associations, producing:<br>\n  <code>hash = { [:a =&gt; :c] , [:c =&gt; :b] }</code></p>\n</blockquote>\n\n<h3>Self thinking without positive result</h3>\n\n<p>Maybe I should be doing something with hashes?</p>\n\n<pre><code>1.9.3p194 :018 &gt; def conv_array a=[]  \n1.9.3p194 :019?&gt;   conv_a = []  \n1.9.3p194 :020?&gt;   a.each do |k,v|  \n1.9.3p194 :021 &gt;       conv_a.push(k)  \n1.9.3p194 :022?&gt;   end  \n1.9.3p194 :023?&gt;   a.each do |k,v|\n1.9.3p194 :024 &gt;       conv_a.push(v)\n1.9.3p194 :025?&gt;   end\n1.9.3p194 :026?&gt; end  \n</code></pre>\n\n<p>Can someone help me with this issue?</p>\n"},{"tags":["ruby-on-rails","ruby","list","view","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13269961,"title":"Ruby on Rails: re-order checkbox tag","body":"<p>I have an app where a user can enter projects into a database. One of the fields allows the user to pick multiple technologies. I want the list of technologies to appear in alphabetical order, because at the moment, they appear in the order they were entered into the database.</p>\n\n<p>Here is my new action in my project controller:</p>\n\n<pre><code>def new\n    @project = Project.new\n        @technol = Technol.new(params[:tech])\n\n        @all_technols = Technol.all\n        tech_ids = params[:technols][:id].reject(&amp;:blank?) unless params[:technols].nil?\n\n\n        @project_technol = @project.projecttechnols.build\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @project }\n    end\n  end\n</code></pre>\n\n<p>Here is part of my new view:</p>\n\n<pre><code>&lt;div class=\"tech\" STYLE=\"text-align: left;\"&gt;\n  &lt;b&gt;Technologies:&lt;/b&gt;\n  &lt;style&gt;\n    .split { text-align:left; }\n  &lt;/style&gt;\n\n\n  &lt;p&gt;&lt;ul&gt; \n\n  &lt;% for technol in Technol.all %&gt; \n   &lt;li class=\"split\"&gt; \n    &lt;%= check_box_tag \"project[technol_ids][]\", technol.id,  @project.technols.include?(technol) %&gt; \n    &lt;%= technol.tech %&gt; \n   &lt;/li&gt; \n\n  &lt;% end %&gt; \n &lt;/ul&gt; \n &lt;/p&gt; \n</code></pre>\n\n<p>Does anyone have any ideas? I am new to rails so please remember this when trying to answer. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":11053815,"title":"RoR Controller If statement","body":"<p>I have the following If statement in a controller:</p>\n\n<pre><code> def create\n@invline = Invline.new(params[:invline])\nif (@invline.linetype.linecode = 'Expense')\n  @invline.price ||= @invline.expense.amount\n  @invline.invlinedesc ||= 'Expenses'\nelse\nif (@invline.linetype.linecode = 'Time')\n  @invline.units ||= @invline.timeentry.time_entry\n  @invline.invlinedesc ||= 'Time'\nend\nend\n</code></pre>\n\n<p>When the lincode is 'Time' I get </p>\n\n<pre><code>undefined method `amount' for nil:NilClass\n</code></pre>\n\n<p>But, the @invline.price ||= @invline.expense.amount line shouldn't be executing - right?</p>\n\n<p>Any ideas?\nThanks</p>\n"},{"tags":["ruby-on-rails","file-upload"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13270365,"title":"Live video transcoding with rails and ffmpeg (Streamed Upload)","body":"<p>I am working on a rails app where a user can upload a video of any format and that gets converted to mp4 using ffmpeg.  I am interested to reduce the time taken to convert a file to mp4. I know that ffmpeg can take a stream as the input and transcode it. So, while the file is getting uploaded if i can pass this stream to ffmpeg it can convert the file as it gets uploaded. Transloadt.com does this live encoding using nodejs and formidable. (https://transloadit.com/blog/2010/12/realtime-encoding-over-150x-faster). Is there any way we can do it using rails ?</p>\n\n<p>I am using 2.0 version of <a href=\"https://github.com/valums/file-uploader\" rel=\"nofollow\">https://github.com/valums/file-uploader</a> to upload files and i am on Rails 2.3.5. Apache with passenger is my server.\nIs there anyway to pass the file to ffmpeg while it is being uploaded to the rails app ?</p>\n"},{"tags":["javascript","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12809750,"title":"Rails Facebook OAuth Popup JS","body":"<p>I used Chris Heald's answer here: \"http://stackoverflow.com/questions/4491433/turn-omniauth-facebook-login-into-a-popup\" and it worked perfectly.</p>\n\n<p>The one issue is in the redirect. I am using Devise and Oauth for Facebook login - I want the popup to close after login and for the user to be redirected to the proper page after sign-in/sign-up. </p>\n\n<p>For some reason, right now, the proper path is loaded in the pop-up window and the pop-up window doesn't close. I think I'm missing something very basic. Any ideas? I am a total JS newb!!</p>\n\n<p>JS for Popup: </p>\n\n<pre><code>function popupCenter(url, width, height, name) {\n    var left = (screen.width/2)-(width/2);\n    var top = (screen.height/2)-(height/2);\n    return window.open(url, name, \"menubar=no,toolbar=no,status=no,width=\"+width+\",height=\"+height+\",toolbar=no,left=\"+left+\",top=\"+top);\n  }\n\n  $(\"a.popup\").click(function(e) {\n    popupCenter($(this).attr(\"href\"), $(this).attr(\"data-width\"), $(this).attr(\"data-height\"), \"authPopup\");\n    e.stopPropagation(); return false;\n});\n</code></pre>\n\n<p>JS for Redirect: </p>\n\n<pre><code>if(window.opener) {\n    window.opener.location = &lt;%= after_sign_in_path %&gt;;\n    window.close()\n  }\n</code></pre>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","activerecord","transactions"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":22,"score":3,"question_id":13269109,"title":"ActiveRecord: Concurrent access between validation and writing to the database","body":"<p>Let's say I have on online book store whose data model lookes like that:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FhjaG.png\" alt=\"enter image description here\"></p>\n\n<p>Prior to creating a new order, I want to make sure that enough items are in stock, so I have a method like this</p>\n\n<pre><code>def ensure_enough_in_stock\n    errors.add(:quantity, \"not enough in stock\") if quantity &gt; book.stock\nend\n</code></pre>\n\n<p>To make sure that this method is called prior to saving in the database, I use a validate:</p>\n\n<pre><code>validate :ensure_enough_in_stock, :on =&gt; create\n</code></pre>\n\n<p>So to sum things up, when I create an order:</p>\n\n<ol>\n<li>the validation method is called</li>\n<li>the new order is written into the database (if validation passes)</li>\n</ol>\n\n<p>What happens if between 1. and 2., another process (a concurrent access, another thread, ...) performs a modification on the stock attribute of the same book? Is the exception raised or not?</p>\n\n<p>More generally, how to deal with the cases where something happens <strong>between validation and saving</strong> to the database?</p>\n\n<p>I think that I should put a validation into the database as well, but I don't know what impact it would have on performance. Is there a clever way to deal with this kind of situation?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Locking the transactions as explained <a href=\"http://guides.rubyonrails.org/active_record_querying.html#locking-records-for-update\" rel=\"nofollow\">here</a> prevents write access to stock, but what happens if I also have a \"published\" attribute in the Book model, that can take the values \"public\" or \"private\", and then I want to make sure that you can't buy a book that's private.</p>\n\n<p>But the same way that the stock value could be changed by an external process, the published value can be changed as well: in this case the locking would not be of any help, would it?</p>\n\n<p><img src=\"http://i.stack.imgur.com/Jsb1Y.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails","api","authentication","oauth","ssh"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":20,"score":3,"question_id":13269829,"title":"API authentication using private and public keys","body":"<p>I'd like to authorize user in CLI using web API in similar way the SSH does it (uploading public key on server, and then using private key to authorize). Is it possible?</p>\n\n<p>I don't mean to generate public / private key par, but rather re-use existing id_rsa and id_rsa.pub.</p>\n\n<p>Do you know any software packages that make it easier (preferably Ruby on Rails gems?)</p>\n"},{"tags":["ruby-on-rails","ruby","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13222236,"title":"bootstrap-sass display error","body":"<p>Trying to use bootstrap-sass</p>\n\n<p>It seems as if it is not compiling correctly of sorts </p>\n\n<p>calling bootstrap in custom.css.scss<br>\n@import \"bootstrap\";</p>\n\n<p>including the gem\ngem \"bootstrap-sass\", \"~> 2.1.1.0\"</p>\n\n<p>You can see the issue here, the nav is coming out white with the links off color as well.</p>\n\n<p><a href=\"http://learingisfun.herokuapp.com/pages/home\" rel=\"nofollow\">http://learingisfun.herokuapp.com/pages/home</a></p>\n\n<p>The repo for this as well is <a href=\"https://github.com/thebusiness11/appsample\" rel=\"nofollow\">https://github.com/thebusiness11/appsample</a></p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","refinerycms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":14,"score":0,"question_id":13269611,"title":"Bootstrap <i> icons being overridden by <em> in refinery editor","body":"<p>I am using refinery branch 2.0-stable with twitter bootstrap and rails 3.1. </p>\n\n<p>I've tried adding a bootstrap icon to a refinery page html using the following syntax:</p>\n\n<pre><code>&lt;i class=\"icon-caret-left\"&gt;&lt;/i&gt;\n</code></pre>\n\n<p>When I save the page, the  tags are overridden with  tags. </p>\n\n<p>Any ideas of a fix?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pjax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13088392,"title":"Rails: error with pjax \"Uncaught TypeError: Object [object Object] has no method 'pjax' \"","body":"<p>Gemfile:</p>\n\n<blockquote>\n  <p>gem 'pjax_rails'</p>\n</blockquote>\n\n<p>app/assests/javascripts/application.js :</p>\n\n<pre><code>//= require jquery \n//= require jquery_ujs \n//= require_tree . \n//= require jquery.pjax\n\n\n$(function() {\n $('a').pjax('[data-pjax-container]');\n});\n</code></pre>\n\n<p>app/views/layouts/application.html.erb:</p>\n\n<pre><code>&lt;div id=\"data-pjax-container\" data-pjax-container&gt;\n        &lt;%= yield %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The error i'm getting in chrome is:</p>\n\n<blockquote>\n  <p>Uncaught TypeError: Object [object Object] has no method 'pjax'</p>\n</blockquote>\n\n<p>And it refers to the application.js file. What is wrong here?</p>\n"},{"tags":["android","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13269148,"title":"Rails' send_file to make apk file being installed","body":"<p>I'm trying to make my website sending Android <code>APK</code> files with some pre-validation so the user just clicks the link and the application starts to install on the device.</p>\n\n<p>The point is, i'm using the <code>thin</code> webserver, <code>send_file path, :type =&gt; 'application/vnd.android.package-archive', :disposition =&gt; \"attachment\"</code>, set the header <code>headers['Content-Type'] = 'application/vnd.android.package-archive'</code> and checked the <strong>Allow untrusted sources</strong> box at the device' settings. But the <em>apk</em> file is just downloaded instead of being installed.</p>\n\n<p><strong>UPD:</strong> The following trouble issues on Android 4 only. My Galaxy S with Android 2.3.6 works fine.</p>\n\n<p>What am i doing wrong?</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":196,"score":1,"question_id":6168434,"title":"Activerecord Where with a hash value","body":"<p>I have a City model with a cached_info field which is a serialized hash. </p>\n\n<pre><code>{:population=&gt;20000, :more_stuff =&gt;....}\n</code></pre>\n\n<p>If I make the following query in Activerecord.</p>\n\n<pre><code>City.where('cached_info[:population] &gt; 300').count\n</code></pre>\n\n<p>I get back...</p>\n\n<pre><code>ActiveRecord::StatementInvalid: Mysql2::Error: \nYou have an error in your SQL syntax; \ncheck the manual that corresponds to your MySQL server version for the right syntax to use near '[:population] &gt; 300)' at line 1: SELECT COUNT(*) FROM `places` WHERE `places`.`type` = 'City' AND (cached_info[:population] &gt; 3)\n</code></pre>\n\n<p>Anybody have a workaround for this?</p>\n"},{"tags":["ruby-on-rails","validation","backbone.js","coffeescript","jasmine"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13207366,"title":"Testing Backbone Model validation using backbone.validation - spies never get called","body":"<p>I'm using <a href=\"https://github.com/thedersen/backbone.validation/blob/master/README.md\" rel=\"nofollow\">backbone.validation</a> in order to validate my backbone Models and am employing a TDD approach to my work. Unfortunately I cannot seem to get my spy to be called when testing that fields are actually required.</p>\n\n<p>I've been following the tutorial on <a href=\"http://tinnedfruit.com/2011/03/25/testing-backbone-apps-with-jasmine-sinon-2.html\" rel=\"nofollow\">Testing Backbone applications with Jasmine and Sinon</a>\nexcept when he registers his spy with <code>\"error\"</code>I've tried registering mine with <code>\"invalid\"</code>. The reason for this is because I think backbone.validation uses invalid/valid callbacks instead as described under the Events section of the readme.</p>\n\n<p>My problem is that I'm getting errors saying that my spies are never called. I tried changing the bindings back to error/save but still have no luck.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>class Event extends Backbone.Model\n    url: -&gt;\n      '/events' + (if @isNew() then '' else '/' + @id)\n\n    validation:\n      title:\n        required: true\n      start_date:\n        required: true\n      end_date:\n        required: true\n      description:\n        required: true\n</code></pre>\n\n<p>I then define a test as follows:</p>\n\n<pre><code>describe \"Event\", -&gt;\n  beforeEach -&gt;\n    @title = \"Foo\"\n    @description = \"Bar\"\n    @start_date = new Date\n    @end_date = new Date\n\n\n    @event = new CPP.Models.Event {\n      title: @title\n      description: @description\n      start_date: @start_date\n      end_date: @end_date\n    }\n\n  describe \"when saving required fields\", -&gt;\n    beforeEach -&gt;\n      @error_spy = sinon.spy();\n      @event.bind('invalid', @error_spy)\n\n    it \"should not save when title is empty\", -&gt;\n      @event.save 'title': \"\"\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n    it \"should not save when start_date is empty\", -&gt;\n      @event.save 'start_date': \"\"\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n    it \"should not save when end_date is empty\", -&gt;\n      @event.save 'end_date': \"\"l\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n    it \"should not save when description is empty\", -&gt;\n      @event.save 'description': \"\"\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n    it \"should not save when location is empty\", -&gt;\n      @event.save 'location': null\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n  describe \"when saving optional fields\", -&gt;\n    beforeEach -&gt;\n      @success_spy = sinon.spy();\n      @event.bind('valid', @success_spy)\n\n    it \"should save when deadline is empty\", -&gt;\n      @event.save 'deadline': \"\"\n      expect(@success_spy).toHaveBeenCalledOnce();\n</code></pre>\n\n<p>However when I run my tests I seem to get <code>Error: Expected Function to have been called once.</code> for all of them and on further inspection of the @event object I find that the spy is never called.</p>\n\n<p>I think it might be something to do with mixing in the validation on the Model's prototype via\n<code>_.extend(Backbone.Model.prototype, Backbone.Validation.mixin);</code> as defined on the backbone.validation readme, but I cannot seem to get this to work either.</p>\n\n<p>I've had a look at the question <a href=\"http://stackoverflow.com/questions/8441612/why-is-this-sinon-spy-not-being-called-when-i-run-this-test\">Why is this sinon spy not being called when I run this test?</a> however I've had no luck with incorporating the answer into my code either.</p>\n\n<p>If anyone could tell me what I'm doing wrong I'd be very grateful!</p>\n\n<p><strong>Fixed</strong>\nI managed to fix my code as follows:\n(1) I added <code>_.extend Backbone.Model::, Backbone.Validation.mixin</code> into my application</p>\n\n<p>(2) I then followed the advice given in <a href=\"http://stackoverflow.com/questions/10865364/qunit-sinon-js-backbone-unit-test-frustration-sinon-spy-appears-to-fail-to-d\">this question</a> to bind my spy on initialize. The code now looks as follows:\nThe model:\n    class Event extends Backbone.Model\n        url: ->\n          '/events' + (if @isNew() then '' else '/' + @id)</p>\n\n<pre><code>    validation:\n      title:\n        required: true\n      start_date:\n        required: true\n      end_date:\n        required: true\n      description:\n        required: true\n</code></pre>\n\n<p>The test:</p>\n\n<pre><code>describe \"Event\", -&gt;\n  beforeEach -&gt;\n    @title = \"Foo\"\n    @description = \"Bar\"\n    @start_date = new Date\n    @end_date = new Date\n\n  describe \"when saving required fields\", -&gt;\n    beforeEach -&gt;\n      spy = @error_spy = sinon.spy();\n      init = CPP.Models.Event::initialize\n      CPP.Models.Event::initialize = -&gt;\n        spy(@, \"validated:invalid\")\n        init.call this\n\n      @event = new CPP.Models.Event {\n        title: @title\n        description: @description\n        location: @location\n        start_date: @start_date\n        end_date: @end_date\n      }\n\n    it \"should not save when title is empty\", -&gt;\n      @event.save 'title': \"\"\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n    it \"should not save when start_date is empty\", -&gt;\n      @event.save 'start_date': \"\"\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n    it \"should not save when end_date is empty\", -&gt;\n      @event.save 'end_date': \"\"l\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n    it \"should not save when description is empty\", -&gt;\n      @event.save 'description': \"\"\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n    it \"should not save when location is empty\", -&gt;\n      @event.save 'location': null\n      expect(@error_spy).toHaveBeenCalledOnce();\n\n  describe \"when saving optional fields\", -&gt;\n\n    beforeEach -&gt;\n      spy = @success_spy = sinon.spy();\n      init = CPP.Models.Event::initialize\n      CPP.Models.Event::initialize = -&gt;\n        spy(@, \"validated:valid\")\n        init.call this\n\n      @event = new CPP.Models.Event {\n        title: @title\n        description: @description\n        location: @location\n        start_date: @start_date\n        end_date: @end_date\n      }\n\n    it \"should save when deadline is empty\", -&gt;\n      @event.save 'deadline': \"\"\n      expect(@success_spy).toHaveBeenCalledOnce();\n</code></pre>\n"},{"tags":["ruby-on-rails","json","escaping"],"answer_count":4,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":6251,"score":9,"question_id":2715994,"title":"Rails escape_javascript creates invalid JSON by escaping single quotes","body":"<p>The escape_javascript method in ActionView escapes the apostrophe <code>'</code> as backslash apostrophe <code>\\'</code>, which gives errors when parsing as JSON.</p>\n\n<p>For example, the message \"I'm here\" is valid JSON when printed as:</p>\n\n<pre><code>{\"message\": \"I'm here\"}\n</code></pre>\n\n<p>But, <code>&lt;%= escape_javascript(\"I'm here\") %&gt;</code> outputs <code>\"I\\'m here\"</code>, resulting in invalid JSON:</p>\n\n<pre><code>{\"message\": \"I\\'m here\"}\n</code></pre>\n\n<p>Is there a patch to fix this, or an alternate way to escape strings when printing to JSON?</p>\n"},{"tags":["ruby-on-rails","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13266603,"title":"Rails: How to set port number for the asset hosts in development","body":"<p>Rails lets me set multiple asset hosts as an application configuration. Problem is, I've been writing the full host as an argument. That is, in development I've been appending the \":3000\" to it. Which has worked fine, until the day I had to run 2 projects in parallel, and one of them add to go to a different port (let's say, 3001). As I already read, Rails app can't possibly know which port the web server is listening to. Is there a workaround for this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2","has-many-through","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13244276,"title":"Rails polymorphic has_many through","body":"<p>I want to model generic assets with groups in Rails 3.2.8, I have tried this:\n</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Group &lt; ActiveRecord::Base\n  has_many :group_assignments\n  has_many :assets, :through =&gt; :group_assignments\n  # ...\nend\n\nclass GroupAssignment &lt; ActiveRecord::Base\n  belongs_to :group\n  belongs_to :asset, :polymorphic =&gt; true\n  # ...\nend\n\nclass Image &lt; ActiveRecord::Base\n  has_attached_file :attachment\n\n  has_many :group_assignments, :as =&gt; :asset, :dependent =&gt; :destroy\n  has_many :groups, :through =&gt; :group_assignments\n  # ...\nend\n\nclass EmbeddedVideo &lt; ActiveRecord::Base\n  has_many :group_assignments, :as =&gt; :asset, :dependent =&gt; :destroy\n  has_many :groups, :through =&gt; :group_assignments\n  # ...\nend\n</code></pre>\n\n<p>But I get: <code>ActiveRecord::HasManyThroughAssociationPolymorphicSourceError: Cannot have a has_many :through association 'Group#assets' on the polymorphic object 'Asset#asset'.</code></p>\n\n<p><s>I don't understand the last part of the error, why is it trying to find the model \"Asset\"?</s> I need the Group#assets has_many association to be polymorphic, each one a different model. Since assets haven't common attributes it has no sense to do STI. Any ideas on how to do this? </p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1382,"score":0,"question_id":5291239,"title":"Rails 3 Ajax success message","body":"<p>I have a voting system that i'm trying to Ajax.</p>\n\n<p>In the view i have:</p>\n\n<pre><code>&lt;div id=\"yes\"&gt;&lt;%=button_to 'Vote',vote_path(c),:id=&gt;c.id,:remote=&gt;true,:html=&gt;{:class=&gt;\"vote\"}%&gt;&lt;/div&gt;\n\nand the controller goes:\n</code></pre>\n\n<p>`def vote</p>\n\n<pre><code>    number=Video.find(params[:id])\n    number.increment!(:votes)\n    if number.update_attributes(params[:votes])\n       flash[:notice] = \"Vote Recorded Successfully.\"\n\n    render :text =&gt; number.votes  \n\n   end`\n</code></pre>\n\n<p>When a user votes, i want to hide the vote button and display a message like \"Thanks for Voting\".</p>\n\n<p>So, in my application.js, i have</p>\n\n<pre><code>$(document).ready(function(){\n    $(\".vote\").bind(\"ajax:success\",function(evt,xhr,settings){\n       var $ent=$(this);\n        $ent.find((\"div.yes\")).hide(100);\n    }\n    }\n);\n</code></pre>\n\n<p>Please point me to some resource to accomplish this.Thank you.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13268935,"title":"Monkey-patching database adapter in Rails app","body":"<p>I'm using PosgreSQL adapter to connect to Vertica database which is mostly compatible with PostgreSQL but doesn't support options like client_min_messages (which are still passed to <code>PGconn.connect</code> despite not being present in <code>database.yml</code>). I've made a quick and dirty monkey patch for <code>ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</code> but the problem is that I guess everything in AR in lazy loaded and the original file is read after my patch. </p>\n\n<p>If I add <code>require 'active_record/connection_adapters/postgresql_adapter'</code> at the top of the monkey patch then ActiveRecord tries to establish connection and fails. Is it possible to alter this behavior to make the monkey patch work or should I just write a full-fledged connection adapter?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":523,"score":3,"question_id":11406805,"title":"jQuery bind ajax:success not working in rails 3 app for newly created (ajax) items","body":"<p>**Edited this post because I found the problem is really in the inability of rails to bind to the ajax:success function.</p>\n\n<p>***Using rails 3.2.3</p>\n\n<p>Thanks for taking the time to read and try to help.</p>\n\n<p>I am adding a simple fade out function on the ajax:success of an item being deleted, as follows:</p>\n\n<pre><code>$(document).ready( jQuery(function($) {\n    $('.delete').bind('ajax:success', function() {\n        $(this).closest('div').fadeOut();\n    });\n}));\n#For some reason had to pass the $ into the function to get it to work,\n#not sure why this is necessary but doesn't work unless that is done.\n</code></pre>\n\n<p>After this, I wanted to create an object with unobtrusive jQuery when the user adds something, and have working delete buttons on those as well.  I made a create.js.erb file that is called after creating a new item - and the creation works fine, but the delete button cannot access the ajax:success event.</p>\n\n<p>It does delete the data from the db when clicked, but the .fadeOut is never bound to it, so it doesn't disappear.  The create.js.erb is as follows:</p>\n\n<pre><code>#$(\"div\").append(html) here, then call the function below to try and bind the ajax:success function\n$('.delete').bind('ajax:complete', function() {\n    $(this).closest('div').fadeOut();\n});\n</code></pre>\n\n<p>If I change this to bind to the click function, it works, but this doesn't account for a failed ajax call:</p>\n\n<pre><code>#$(\"div\").append(html) here, then call the function below to try and bind the ajax:success function\n    $('.delete').bind('click', function() {\n        $(this).closest('div').fadeOut();\n    });\n</code></pre>\n\n<p>So something must be up with binding to the ajax:success after the item is created.  You guys have any idea why this might be happening?  Do I need to do something special in rails to get the newly rendered item to recognize ajax events?  Any direction would be much appreciated!</p>\n\n<p>P.S. The controller for the delete method is below in case anyone might be able to detect a problem there:</p>\n\n<pre><code>def destroy\n    @user = User.find(params[:user_id])\n    @item = @user.item.find(params[:id])\n    @item.destroy\n\n    respond_to do |format|\n      format.html { redirect_to user_path(@user) }\n      format.json { head :no_content }\n      format.js { render :nothing =&gt; true }\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","heroku","rvm"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":2275,"score":-3,"question_id":6367286,"title":"Ubuntu + Install Ruby 1.9, Rails 3 Using RVM","body":"<p>Best way to Install <code>RUBY 1.9, Rails 3, Postgres, Heroku, GitHub,</code> Using RVM</p>\n\n<p>Can anyone suggest me the best way in which,I follow to install it properly, because previously I felt in various dependencies issues.</p>\n\n<p>Suggest something !!!</p>\n"},{"tags":["ruby-on-rails","mvc","omniauth","errors"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13266599,"title":"Omniauth uninitialized constant Rack::OpenID","body":"<p>I want to add google authentication to my rails app. I followed this <a href=\"http://blog.sethladd.com/2010/09/ruby-rails-openid-and-google.html\" rel=\"nofollow\">tutorial</a>, but it writes this: </p>\n\n<blockquote>\n  <p>uninitialized constant Rack::OpenID</p>\n  \n  <p>app/controllers/sessions_controller.rb:5:in `new'</p>\n</blockquote>\n\n<p>my session_controller:</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n      skip_before_filter :verify_authenticity_token\n\n      def new\n        response.headers['WWW-Authenticate'] = Rack::OpenID.build_header(\n            :identifier =&gt; \"https://www.google.com/accounts/o8/id\",\n            :required =&gt; [\"http://axschema.org/contact/email\",\n                          \"http://axschema.org/namePerson/first\",\n                          \"http://axschema.org/namePerson/last\"],\n            :return_to =&gt; session_url,\n            :method =&gt; 'POST')\n        head 401\n      end\n\n      def create\n        if openid = request.env[Rack::OpenID::RESPONSE]\n          case openid.status\n          when :success\n            ax = OpenID::AX::FetchResponse.from_success_response(openid)\n            user = User.where(:identifier_url =&gt; openid.display_identifier).first\n            user ||= User.create!(:identifier_url =&gt; openid.display_identifier,\n                                  :email =&gt; ax.get_single('http://axschema.org/contact/email'),\n                                  :first_name =&gt; ax.get_single('http://axschema.org/namePerson/first'),\n                                  :last_name =&gt; ax.get_single('http://axschema.org/namePerson/last'))\n            session[:user_id] = user.id\n            if user.first_name.blank?\n              redirect_to(user_additional_info_path(user))\n            else\n              redirect_to(session[:redirect_to] || root_path)\n            end\n          when :failure\n            render :action =&gt; 'problem'\n          end\n        else\n          redirect_to new_session_path\n        end\n      end\n\n      def destroy\n        session[:user_id] = nil\n        redirect_to root_path\n      end\n    end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13265378,"title":"What happens to rails authenticity token after refersh and when it is ccreated","body":"<p>I want to know when does a authentication token in rails is generated again. Because whenever i refresh the page token doesn't changes?? and i want to know when it will change again</p>\n\n<p>possible duplicate :</p>\n\n<blockquote>\n  <p><a href=\"http://stackoverflow.com/questions/6968106/rails-3-authenticity-token-how-it-is-generated#comment18079544_6968106\">rails 3 authenticity_token how it is generated</a></p>\n</blockquote>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":307,"score":3,"question_id":8942025,"title":"rails_admin dashboard/secondary_navigation customization","body":"<p>Any chance to customize dashboard or secondary navigation?</p>\n\n<p>Yes i can create <code>app/view/rails_admin/main/dashboard.html.haml</code> and redesign whole page from scratch.\nBut what should I do if I want just add simple partial before and safe current content?</p>\n\n<p>In case with secondary navigation I tried to replace <code>_secondary_navigation.html.haml</code> in all places where partials could be - nothing happens.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","csv","import"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13266799,"title":"Can't set boolean values when import data from csv to postgresql","body":"<p>I have built a task to import data like this:</p>\n\n<pre><code>CSV.foreach(file, :headers =&gt; true) do |row|  \n  question = Question.new ({  \n  content:   row[0],\n  mark:      row[1],\n  topic_id:  row[2],\n  question_type_id: row[3],\n  answers_attributes: [\n    { content: row[5], correct: row[6] },\n    { content: row[7], correct: row[8] }\n  ]\n})\nquestion.user_id = row[4]\nquestion.save!\n</code></pre>\n\n<p>This is my CSV file:</p>\n\n<pre><code>content, mark, topic_id, question_type_id, user_id, content, correct, content, correct\n_____ are people involved in or affected by project activities, 5, 16, 1, 3, True, 't', False, 'f'\n</code></pre>\n\n<p>But when i run import task, the <code>correct attribute</code> always is FALSE in database, i have tried with different <a href=\"http://www.postgresql.org/docs/9.2/static/datatype-boolean.html\" rel=\"nofollow\">Boolean Data Type</a> of PostgreSQL but not working. What do i wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations","model-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13268580,"title":"How to solve circle associations in rails most elegantly?","body":"<p>Imagine you have these two models containing <strong>a circle reference</strong>:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  has_many :users\n  belongs_to :manager, :class_name =&gt; 'User', :foreign_key =&gt; \"manager_id\"\nend\n\nclass User &lt; ActiveRecord::Base\n  belongs_to :company\n  has_one :managed_company, :class_name =&gt; \"Company\", :foreign_key =&gt; :manager_id\nend\n</code></pre>\n\n<p>Now I create a <strong>new User</strong> with a <strong>new Company</strong> that <strong>manager the user himself is</strong>:</p>\n\n<pre><code>u = User.new\nu.build_company\nu.company.manager = u\nu.save!\n</code></pre>\n\n<p>A Test, if the manager was sucessfully assigned to the company turns out well:</p>\n\n<pre><code>1.9.3p125 :010 &gt; u.company.manager\n =&gt; #&lt;User id: 1548, ...&gt;\n</code></pre>\n\n<p>Yet, the association is not saved:</p>\n\n<pre><code>1.9.3p125 :011 &gt; u.company.manager_id\n =&gt; nil \n</code></pre>\n\n<p>This is, because Rails creates <code>Company</code> first and the <code>User</code> second, being unable to set the <code>manager_id</code> as the <code>user_id</code> is unknown as the company is created:</p>\n\n<pre><code> INSERT INTO \"companies\" (... [\"manager_id\", nil] ...\n INSERT INTO \"users\" (...\n</code></pre>\n\n<p><strong>What is the most elegant solution?</strong></p>\n\n<ol>\n<li>Saving the User and Company two times on creation and having the manager_id assigned on the second time?</li>\n<li>Using some Rails built-in trick that I am unaware of as of now</li>\n<li>Some more advanced magic</li>\n</ol>\n"},{"tags":["ruby-on-rails","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13266789,"title":"error on using rails_apps_composer w/ twitter-bootstrap less","body":"<p>I'm trying to create a new app using rails_apps_composer.\nWhat went well some weeks ago doesn't work anymore.</p>\n\n<p>I'm using config vars:</p>\n\n<pre><code>:frontend: bootstrap\n:bootstrap: less\n</code></pre>\n\n<p>and for now composer breaks with several error messages as of</p>\n\n<pre><code>.rvm/gems/ruby-1.9.3-p194@testapp/gems/railties-3.2.8/lib/rails/railtie/configuration.rb:85:in `method_missing': undefined method `less' for #&lt;Rails::Application::Configuration:0x007fbb714356c8&gt; (NoMethodError)\nfrom .rvm/gems/ruby-1.9.3-p194@testapp/gems/twitter-bootstrap-rails-2.1.6/lib/twitter/bootstrap/rails/engine.rb:15:in `block in &lt;class:Engine&gt;'\n</code></pre>\n\n<p>When I use <em>sass</em>, it works. However, I have to use <em>less</em>.</p>\n\n<p>Gems are up to date:</p>\n\n<pre><code>twitter-bootstrap-rails (2.1.6)\nless (2.2.2)\n</code></pre>\n\n<p>I also tried to add <em>less</em> explicitly as an additional gem with the same result.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.2","habtm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13267860,"title":"Rails 3.2 + Postgres: has_and_belongs_to_many saving even when validation fails","body":"<p>I have a Company model:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n    has_and_belongs_to_many :jobs\n    validates :name, presence: true\nend\n</code></pre>\n\n<p>And a Job model:</p>\n\n<pre><code>class Job &lt; ActiveRecord::Base\n    has_and_belongs_to_many :companies\n    validates :name, presence: true\nend\n</code></pre>\n\n<p>All works fine except for the collection.create method. According to the <a href=\"http://guides.rubyonrails.org/association_basics.html#has_and_belongs_to_many-association-reference\" rel=\"nofollow\">Rails documentation</a>:</p>\n\n<blockquote>\n  <p>The collection.create method returns a new object of the associated type. This object will be instantiated from the passed attributes, the link through the join table will be created, and, once it passes all of the validations specified on the associated model, the associated object will be saved.</p>\n</blockquote>\n\n<p>This doesn't seem to work properly for me: even when the child object is invalid (and the validation works because the invalid model doesn't get saved), the association still gets created. I created this unit test to explain how I try to do it:</p>\n\n<pre><code>test \"add invalid job to company\" do\n  company = FactoryGirl.create(:company_with_job)\n\n  # I also tried:\n  # company.jobs &lt;&lt; FactoryGirl.build(:job, name: \"\")\n  company.jobs.create({name: \"\"})\n  company.save\n  assert_equal 1, company.jobs.size\nend\n</code></pre>\n\n<p>Size is instead '2' and if I inspect company.jobs I get this:</p>\n\n<pre><code>[#&lt;Job id: 1, name: \"My Job 1\", created_at: \"2012-11-07 10:26:10\", updated_at: \"2012-11-07 10:26:10\"&gt;, \n#&lt;Job id: nil, name: \"\", created_at: nil, updated_at: nil&gt;]\n</code></pre>\n\n<p>I'm sure I'm missing something stupid, but I've been banging my head on this for a while and can't seem to understand what I'm doing wrong.</p>\n\n<p>Thanks,<br>\ng</p>\n"},{"tags":["ruby-on-rails","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13178749,"title":"Active Admin nested associations","body":"<p>So I have the following models in my program:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :group_members\n  has_many :groups, through: :group_members \n\nclass GroupMember &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :group\nend\n\nclass Group &lt; ActiveRecord::Base\n  has_many :group_members\n  has_many :users, through: :group_members\nend\n</code></pre>\n\n<p>And I'm using ActiveAdmin to administer these resources. My <code>groups.rb</code> file in the admin folder looks like this:</p>\n\n<pre><code>ActiveAdmin.register Group do\n.\n.\n  belongs_to :user, :optional =&gt; true\n.\n.\nend\n</code></pre>\n\n<p>The problem is, Group is a resource by itself - an admin can manage groups by going to the <code>/admin/groups</code> route - but it also is a resource of users, and I'm able to view the user groups by accessing the <code>/admin/users/:user_id/groups</code> route. However, when I try to create a new group to this user by accessing the <code>/admin/users/:user_id/groups/new</code> page and filling in the form, I get an error: </p>\n\n<pre><code>ActiveRecord::RecordNotFound in Admin::GroupsController#show\nCouldn't find Group with id=13 [WHERE `group_members`.`user_id` = 2]\n</code></pre>\n\n<p>The user id corresponds to my currently logged in user and it is correct, while the group id = 13 corresponds to the id of the newly created group (it is saved in the database correctly), but the association in <code>group_members</code> table is not created. Actually, that's not even exactly what I'm trying to achieve here: the ideal scenario would be to retrieve the list of groups and display it in the new page, so as not to create new <code>groups</code> in this page - only <code>group_members</code>.</p>\n\n<p>How do I proceed in this case? Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","arrays"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":442,"score":2,"question_id":8639857,"title":"Rails 3. How to get the difference between two arrays?","body":"<p>Let's say I have this array with shipments id's.</p>\n\n<p><code>s = Shipment.find(:all, :select =&gt; \"id\")</code></p>\n\n<p><code>[#&lt;Shipment id: 1&gt;, #&lt;Shipment id: 2&gt;, #&lt;Shipment id: 3&gt;, #&lt;Shipment id: 4&gt;, #&lt;Shipment id: 5&gt;]</code> </p>\n\n<p>Array of invoices with shipment id's</p>\n\n<p><code>i = Invoice.find(:all, :select =&gt; \"id, shipment_id\")</code></p>\n\n<p><code>[#&lt;Invoice id: 98, shipment_id: 2&gt;, #&lt;Invoice id: 99, shipment_id: 3&gt;]</code></p>\n\n<p>Invoices belongs to Shipment.<br />\nShipment has one Invoice.<br />\nSo the invoices table has a column of shipment_id.</p>\n\n<p>To create an invoice, I click on New Invoice, then there is a select menu with Shipments, so I can choose \"which shipment am i creating the invoice for\". So I only want to display a list of shipments that an invoice hasn't been created for.</p>\n\n<p>So I need an array of Shipments that don't have an Invoice yet. In the example above, the answer would be 1, 4, 5.</p>\n"},{"tags":["ruby-on-rails","deployment","apache2","phusion-passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13267582,"title":"Running Rails on Apache2","body":"<p>I have a linode server and was running a single website for dev purposes using webrick, now i want to put it into production and use Apache2 which I have installed and is up and running the classic It Work's! page which is expected.</p>\n\n<p>Now I want to run multiple sites on this VPS I am using the current configuration which works fine for striaght HTML but will not run the web apps unless I run them on another port (rails s -p3500 etc) as port 80 is already taken up by Apache.</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n  ServerName datumpoint.bizmodev.com\n  # ServerAlias *.example.com\n  DocumentRoot /var/www.bizmodev.com\n  &lt;Directory \"/var/www.bizmodev.com\"&gt;\n    Options FollowSymLinks\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n  &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:80&gt;\n  ServerName homehounduk.co.uk\n  ServerAlias *.homehounduk.co.uk\n  DocumentRoot /var/www.homehounduk.co.uk\n  &lt;Directory \"/var/www.homehounduk.co.uk\"&gt;\n    Options FollowSymLinks\n    AllowOverride None\n    Order allow,deny\n    Allow from all\n  &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>Do i need to use passenger or something else to get this working? i have tried changing the virtual hosts to different ports and stuff but just end up getting a 403.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["ruby-on-rails","css","background-image"],"answer_count":7,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":8820,"score":4,"question_id":2314263,"title":"rails- Background image not showing up?","body":"<p>Hey guys, I'm having the weirdest problem.  I created an app in .NET and everything worked fine style wise.  Now that I have redone the app Rails i'm having an issue with the background image not showing up.<br>\nMy CSS file looks like this..</p>\n\n<pre><code>body{\n  background: url('/images/top-bkrnd.jpg') repeat x ;\n  text-align:center;\n  color:#fff;\n}\n</code></pre>\n\n<p>But whenever I load the page I get no image??? This is so wild and I'm getting to my wits end playing around with how to call it.  I thought the path was correct because other images are are showing up.  This file is the \"/public/index.html/\"... Any ideas where I getting this wrong at?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paperclip","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13266657,"title":"Rails nested_form_for not working when using file_field","body":"<p>When using <code>nested_form_for</code> and having a <code>file_field</code> in <code>fields_for</code> I get the following error from paperclip:</p>\n\n<p><strong>Paperclip::AdapterRegistry::NoHandlerError in ProjectsController#create</strong></p>\n\n<p><code>No handler found for \"scan.pdf\"</code></p>\n\n<p>This is correct, because the params don't show an <code>#&lt;ActionDispatch::Http::UploadedFile&gt;</code> object, but just the file name.</p>\n\n<p>Before using <code>nested_form_for</code> it worked, it works when I uncomment the <code>file_field</code> and it also works when I build the first object for <code>fields_for</code> but this shouldn't be necessary..</p>\n\n<p>My setup is as follows:</p>\n\n<ul>\n<li>ruby 1.9.3</li>\n<li>rails (3.2.8)</li>\n<li>paperclip (3.3.0)</li>\n<li>nested_form (0.3.0)</li>\n</ul>\n\n<p>The code:</p>\n\n<pre><code># @project.schemes.build\n= nested_form_for @project do |f|\n  = f.fields_for :schemes do |ff|\n    = ff.text_field :name\n    = ff.file_field :scan\n</code></pre>\n"},{"tags":["ruby-on-rails","gem"],"answer_count":4,"favorite_count":5,"up_vote_count":3,"down_vote_count":0,"view_count":5194,"score":3,"question_id":2565881,"title":"GEM Version Requirements Deprecated","body":"<p>When creating a new Rails project using:</p>\n\n<pre><code>rails sample\n</code></pre>\n\n<p>Then creating a model using:</p>\n\n<pre><code>script/generate model person first_name:string last_name:string\n</code></pre>\n\n<p>Everything is fine. However, if I add any gems to my environment.rb:</p>\n\n<pre><code>config.gem \"authlogic\"\n</code></pre>\n\n<p>And run the same generator, I get the following:</p>\n\n<blockquote>\n  <p>/Library/Ruby/Gems/1.8/gems/rails-2.3.5/lib/rails/gem_dependency.rb:119:Warning:\n  Gem::Dependency#version_requirements\n  is deprecated and will be removed on\n  or after August 2010.</p>\n</blockquote>\n\n<p>The warning just recently appeared (I think), but I would like to fix it if possible. Any hints or similar experiences?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","forms","has-many-through"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13263377,"title":"Rails has_many_through form","body":"<p>After a number of hours reading stackoverflow and watching railscasts, I've decided to post. The question is very similar if not identical to many other questions here but I'm just not getting it.\nThis is my first has_many_through association.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n...\nhas_many :affiliations\nhas_many :sublocations, through: :affiliations\n...\nend\n\nclass Sublocation &lt; ActiveRecord::Base\n...\nhas_many :affiliations\nhas_many :users, through: :affiliations\n...\nend\n\nclass Affiliations &lt; ActiveRecord::Base\n...\nbelongs_to :user\nbelongs_to :sublocation\n...\nend\n</code></pre>\n\n<p>The affiliations table has the usual user_id and sublocation_id columns. It also has boolean column named 'default'.\nIn my 'new/edit user' form(s), I'm needing to select one or more sublocations via checkboxes and also include a way to mark a sublocation as 'default'.</p>\n\n<p>Again, I've read example after example but something just isn't 'clicking' in my brain. I'm not necessarily looking for an exact solution but a nudge in the right direction.</p>\n\n<p>Many thanks,\nCRS</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":8,"up_vote_count":28,"down_vote_count":0,"view_count":8008,"score":28,"question_id":3136420,"title":"Difference between attr_accessor and attr_accessible","body":"<p>In RoR, what is the difference between attr_accessor and attr_accessible. From my understanding, using attr_accessor is used to create getter and setter methods for that variable, so that we can access the variable like</p>\n\n<pre><code>`Object.variable`   or    `Object.variable = some_value`\n</code></pre>\n\n<p>I read that attr_accessible makes that specific variable accessible to the outside world.\nCan someone please tell me whats the difference</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","facebook-graph-api","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13266883,"title":"How can i use the Facebook authentication in devise and send the iphone app the authentication token to use?","body":"<p>I use devise for authentication and i cloned an example from github which works good and now i want to use this for authenticating users from iPhone app and i have used token authentication so it returns the token for user if valid and then the subsequent requests are made with the help of the token. And the part that i am struggling with is authenticating facebook users from iphone. I have few doubts which i have listed below</p>\n\n<ol>\n<li>After sending the user id and password to facebook from iphone, what does it return? Only access token of user or some other detail along with it.</li>\n<li>As i have told earlier, i am working with devise example from <a href=\"https://github.com/plataformatec/devise_example.git\" rel=\"nofollow\">https://github.com/plataformatec/devise_example.git</a> , so how can the access token be received from iphone and check whether the user is valid by sending it to the <code>graph.facebook.com</code></li>\n<li>If after knowing that user is valid then how can i save the user in the user table so as to provide the authentication token to perform next request.</li>\n<li>When the same user enters next time how can i identify whether the user is already present in the table and send the token.</li>\n</ol>\n\n<p>I searched and i could not find any good help or may be i could not get it and this took about three days and still i am struggling. So please help me also tell me if there is any example so that i can try if there is any.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","yaml","psych"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":4616,"score":6,"question_id":5843104,"title":"Rails 3 - 'Couldn't parse Yaml'","body":"<p>I don't know what I did wrong. I try to run 'rails c,' but it just gives me an error. It was working 10 minutes ago. :\\</p>\n\n<pre><code>C:/Ruby192/lib/ruby/1.9.1/psych.rb:148:in `parse': couldn't parse YAML at line 2\n column 12 (Psych::SyntaxError)\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:148:in `parse_stream'\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:119:in `parse'\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:106:in `load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/configuration.rb:88:in `database_configuration'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/railtie.rb:58:in `block (2 levels) in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:36:in `instance_eval'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:36:in `execute_hook'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:43:in `block in run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:42:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:42:in `run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/base.rb:1904:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/railtie.rb:32:in `block in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `call'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation.rb:154:in `block in load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/railties.rb:11:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/railties.rb:11:in `all'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation.rb:154:in `load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds/console.rb:26:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds/console.rb:8:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds.rb:23:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","sms","way2sms"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1590,"score":1,"question_id":2446604,"title":"Sending SMS using Way2sms on rails","body":"<p>Can any one help me to send sms using way2sms api by means of rails application.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","date","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12405230,"title":"Active Admin date filter date format customisation","body":"<p>Is there simple way to change the ActiveAdmin date filter display format from the default ISO format (yyyy-mm-dd)? </p>\n"},{"tags":["jquery","ruby-on-rails","ajax","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":199,"score":2,"question_id":11322424,"title":"How Can I use Remotipart 1.0 with Rails 3.2 to save file upload","body":"<p>I have this form</p>\n\n<pre><code>&lt;%= form_for @post, :html =&gt; {:multipart =&gt; true , :class =&gt; 'form-horizontal' }, :remote =&gt; true do |f| %&gt;\n    &lt;%= f.text_field :title%&gt;\n    &lt;%= f.file_field :avatar%&gt;\n    &lt;%= f.submit nil%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and the <code>create</code> action as well     </p>\n\n<pre><code>def create\n        @post = Post.new(params[:post])\n        respond_to do |format|\n          if @post.save\n            format.js\n          end\n        end\n      end\n</code></pre>\n\n<p>whatever I write in <code>create.js.erb</code> it doesn't run, and the browser is redirected to white page!</p>\n\n<pre><code>$('body').html(\"&lt;h1&gt;Done!&lt;/h1&gt;\"); \n</code></pre>\n\n<p>Can anyone tell me what's the problem here?\nNote that I followed the documentation example steps on <a href=\"https://github.com/JangoSteve/remotipart\" rel=\"nofollow\">github</a></p>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":10320443,"title":"Database modeling Playlists with Songs","body":"<p>I am trying to figure out the logic of setting up models for a <code>Playlist</code> and <code>Song</code>.</p>\n\n<p>So far I have:</p>\n\n<p><code>User has_many :playlists, has_many :songs</code></p>\n\n<p><code>Playlist belongs_to :user, has_many :songs</code></p>\n\n<p><code>Song belongs_to :user</code></p>\n\n<p>I'm not sure how I should go about associating that a Song can belong to many Playlists. </p>\n\n<p>Would I want to setup a <code>has_and_belongs_to_many :playlists</code> and setup a join table or should I do a <code>has_many :through</code> association?</p>\n\n<p>Can you do a HABTM association on just one model or does it have to be declared on the two models you're relating? It doesn't sound right to have a <code>has_and_belongs_to_many :songs</code> association on the <code>Playlist</code> model.</p>\n\n<p>The relationship between <code>User</code> and <code>Song</code> works fine, I'm just trying to implement <code>Playlist</code>. Of course, a song does not have to belong to a playlist.</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13250607,"title":"Mobile Fu gem not working on ruby 1.8.7 / rails 2.3.14","body":"<p>Installing the gem following the instructions on <a href=\"http://rubygems.org/gems/mobile-fu\" rel=\"nofollow\">http://rubygems.org/gems/mobile-fu</a> (\"Simply add <code>gem 'mobile-fu'</code> to your Gemfile and run bundle install\") works OK, and the gem is listed as installed and all needed dependencies are also in place AFAIK, below is the relevant part of the projects Gemfile:</p>\n\n<pre><code>source :gemcutter\nsource 'http://gems.github.com'\n\ngem 'rails', '~&gt; 2.3.14'\ngem 'aslakjo-comatose', '2.0.5.12', :require =&gt; 'comatose'\ngem 'adamwiggins-rest-client', '1.0.4'\ngem 'ruby-hmac', '0.4', :require =&gt; 'hmac'\ngem 'ruby-net-ldap', '0.0.4', :require =&gt; 'net/ldap'\ngem 'will_paginate', '2.3.11'\ngem 'hpricot', '0.8.2'\ngem 'oauth', '0.3.6'\ngem 'sanitize', '1.1.0'\ngem 'sunspot_rails', '1.1.0', :require =&gt; 'sunspot/rails'\ngem 'htmlentities'\ngem 'rdoc', :require =&gt; 'rdoc'\ngem 'to_xls'\ngem 'pusher'\ngem 'jammit'\ngem 'rabl', '~&gt;0.6'\ngem 'paperclip', '~&gt; 2.7'\ngem 'aws-sdk', '~&gt; 1.3.4'\ngem 'mobile-fu', '~&gt; 1.1.0'\n...\n</code></pre>\n\n<p>Here is the resulting error message/log when starting the server: \"no such file to load -- mobile/fu (MissingSourceFile)\" being the main problem (IMHO):</p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 2.3.14 application starting on http://0.0.0.0:3000\nNOTE: Gem.source_index is deprecated, use Specification. It will be removed on or after 2011-11-01.\nGem.source_index called from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/rails/gem_dependency.rb:21.\n/home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:74:in `require': no such file to load -- mobile/fu (MissingSourceFile)\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:74:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `each'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler.rb:128:in `require'\n    from /home/work/web/srv/config/boot.rb:116:in `load_gems'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:164:in `process'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:113:in `send'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:113:in `run'\n    from ./config/environment.rb:7\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:547:in `new_constants_in'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/web/srv/config.ru:1\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rack-1.1.3/lib/rack/builder.rb:46:in `instance_eval'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rack-1.1.3/lib/rack/builder.rb:46:in `initialize'\n    from /home/work/web/srv/config.ru:1:in `new'\n    from /home/work/web/srv/config.ru:1\n    from ./script/server:3:in `eval'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/commands/server.rb:78\n    from ./script/server:3:in `require'\n    from ./script/server:3\n</code></pre>\n\n<p><strong>Update 1</strong></p>\n\n<p>Using the solution described by Ben Langfeld (\"You can fix this using the following in your Gemfile: <code>gem 'mobile-fu', '~&gt; 1.1.0', :require =&gt; 'mobile-fu'</code>\") only produces a new error shown below:</p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 2.3.14 application starting on http://0.0.0.0:3000\nNOTE: Gem.source_index is deprecated, use Specification. It will be removed on or after 2011-11-01.\nGem.source_index called from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/rails/gem_dependency.rb:21.\n/home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require': no such file to load -- rails (MissingSourceFile)\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:547:in `new_constants_in'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/mobile-fu-1.1.0/lib/mobile-fu.rb:1\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `each'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `each'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler.rb:128:in `require'\n    from /home/work/web/srv/config/boot.rb:116:in `load_gems'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:164:in `process'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:113:in `send'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:113:in `run'\n    from ./config/environment.rb:7\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:547:in `new_constants_in'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/web/srv/config.ru:1\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rack-1.1.3/lib/rack/builder.rb:46:in `instance_eval'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rack-1.1.3/lib/rack/builder.rb:46:in `initialize'\n    from /home/work/web/srv/config.ru:1:in `new'\n    from /home/work/web/srv/config.ru:1\n    from ./script/server:3:in `eval'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/commands/server.rb:78\n    from ./script/server:3:in `require'\n    from ./script/server:3\n</code></pre>\n\n<p>There are no minimum versions of ruby or rails listed for this gem, but I suspect the problem is caused by the old versions we are running. However, upgrading ruby or rails is not an option, because this is a maintenance project.</p>\n\n<p>If any replacement gems for Mobile Fu with similar capabilities exists that is know to work on our ruby &amp; rails version/config, that is an alternate option we are willing to look into if this issue cannot be resolved.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13265427,"title":"checking the form data received in ruby on rails controller","body":"<p>I want to check the form data received from the form in ruby on rails controller.</p>\n\n<p>I tried this but nothing is shown:</p>\n\n<pre><code>@user.to_yaml\n</code></pre>\n\n<p>where <code>@user</code> is the form name(<code>&lt;%=form_for @user</code> )</p>\n"},{"tags":["ruby-on-rails","ajax","upload"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":260,"score":1,"question_id":11954122,"title":"Rails AJAX upload form with Remotipart","body":"<p>I've been bashing my head trying to get an AJAX upload form working. I'm using Rails 3.2. I put <code>gem \"remotipart\", \"~&gt; 1.0\"</code> in my Gemfile, ran <code>bundle install</code> and it installed successfully.</p>\n\n<p>I previously had this non-ajax upload form, which I added <code>:remote =&gt; true</code> to as per the literature on the <a href=\"https://github.com/JangoSteve/remotipart\" rel=\"nofollow\">github page</a> :</p>\n\n<pre><code>&lt;%= form_tag \"/administration/data_imports\", :multipart =&gt; true, :remote =&gt; true %&gt;  \n    &lt;label for=\"file\"&gt;Input File&lt;/label&gt; &lt;%= file_field_tag \"file\" %&gt;\n    &lt;button type=\"submit\"&gt;Import Data&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>and this in my <code>data_imports_controller</code> <code>create</code> action:</p>\n\n<pre><code>def create\n  file = params[:file]\n  filename = file.original_filename\nend\n</code></pre>\n\n<p>I added a javascript include on my page for <code>jquery.remotipart.js</code> because it felt essential, albeit there being no explicit instruction to do so..</p>\n\n<p>I tried it and it failed giving a server error:</p>\n\n<pre><code>Completed 500 Internal Server Error in 4ms\n\nNoMethodError (undefined method `original_filename' for nil:NilClass):\napp/controllers/data_imports_controller.rb:16:in `create'\n</code></pre>\n\n<p>It's clear I'm doing something fundamentally wrong, but I need a hand.</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","file-upload","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13242988,"title":"jQuery Remotipart sending [object Object] to server","body":"<p>I'm trying to upload a file to my Rails application with ajax. To facilitate this, I have included the <a href=\"https://github.com/JangoSteve/remotipart\" rel=\"nofollow\">jQuery.remotipart gem</a>.</p>\n\n<pre><code>// app/assets/javascripts/application.js\n//= require jquery.remotipart\n</code></pre>\n\n<p>I have a form for uploading files. These files are processed by CarrierWave.</p>\n\n<pre><code>&lt;%= form_for @import, remote: true do |f| %&gt;\n  &lt;fieldset&gt;\n    &lt;%= f.label :file, \"Attach a CSV file\" %&gt;\n    &lt;%= f.file_field :file %&gt;\n  &lt;/fieldset&gt;\n  &lt;%= f.submit :upload %&gt;\n\n&lt;% end -%&gt;\n</code></pre>\n\n<p>Unfortunately, when I submit the form with a file attached, it doesn't seem to arrive at my controller action correctly. The params hash has stringified JS objects as keys.</p>\n\n<pre><code>Started POST \"/file_imports\" for 127.0.0.1 at 2012-11-06 01:00:49 +0000\nProcessing by FileImportsController#create as JS\n  Parameters: {\"object Object\"=&gt;{\",\"=&gt;{\"object Object\"=&gt;{\",\"=&gt;{\"object Object\"=&gt;nil}}}}}`\n</code></pre>\n\n<p>In Chrome's Dev Tools, I can see that this is indeed the form data that is being sent to the server:</p>\n\n<p><img src=\"http://i.stack.imgur.com/56Gxd.png\" alt=\"Form data being sent to server\"></p>\n\n<p>The form works perfectly when I remove <code>remote: true</code> (of course, it sends a HTML request rather than a JS request in that case). </p>\n\n<p>Anyone have any idea what I'm doing wrong? By the way I'm using Rails 3.2.8 and Remotipart 1.0.2 (latest).</p>\n\n<p><strong>Edit:</strong> Did some more digging.</p>\n\n<p>Looking into the Remotipart source, I can't seem to understand what it is supposed to do. For example, in <a href=\"https://github.com/JangoSteve/remotipart/blob/master/vendor/assets/javascripts/jquery.remotipart.js#L22\" rel=\"nofollow\"><code>vendor/assets/javascripts/jquery.remotipart.js</code></a>, Line 22 has the following:</p>\n\n<pre><code>settings.data = form.serializeArray();\n</code></pre>\n\n<p>A little further down, the settings are sent to the server via <code>$.rails.ajax(settings)</code>.</p>\n\n<p>The <code>$.fn.serializeArray()</code> method returns an array of JS objects. If we assign them to the data attribute of a call to <code>jQuery.ajax()</code>, that would account for the serialized object parameters I'm seeing on the server. We need to pass an object as the data attribute, not an array of objects?</p>\n\n<p>However, when I try to flatten the array into one object, the whole thing breaks and a HTML request is sent to the server instead of a JS one. I think it has something to do with the fact that <code>jQuery.ajax.processData == false</code>.</p>\n\n<p>I have an <a href=\"https://github.com/JangoSteve/remotipart/issues/48\" rel=\"nofollow\">issue on the Remotipart Github</a>.</p>\n"}]}
{"total":93230,"page":5,"pagesize":100,"questions":[{"tags":["ruby-on-rails","rubygems","bundler","gemcutter"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":1880,"score":7,"question_id":3027736,"title":"Do I still need source :gemcutter in Gemfile?","body":"<p>I have a file \"Gemfile\" in my Rails project root.</p>\n\n<p>It says <code>source :gemcutter</code> in the very first line.</p>\n\n<p>Do I still need the line? If I'm correct, <code>http://rubygems.org/</code> is the official source, and Gem Cutter was merged into <code>rubygems.org</code>.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":205,"score":1,"question_id":8180845,"title":"Remotipart 406 Not Acceptable error in rails 3.1.1","body":"<p>Previously my app was in rails 3.0 but when i updated to rails 3.1.1 , remotipart does not work.Instead of JS response it returns Html response.\nI have a dashboard controller where action is demo_upload for uploading a file. \nI have tried all steps mentioned for remotipart at <a href=\"https://github.com/JangoSteve/remotipart\" rel=\"nofollow\">https://github.com/JangoSteve/remotipart</a> but fails.\nForm look like this \n{`&lt;%= form_for(DemoUpload.new, :remote => true ,:url =>\"/demo_upload\") do |f| %></p>\n\n<pre><code>&lt;%= f.file_field :upload, :name =&gt; \"upload\" %&gt;\n\n\n\n &lt;div class=\"btnBlue\"&gt;\n&lt;%= f.submit \"Upload Photo\", :id =&gt; \"upload_photo\" %&gt;\n\n\n\n &lt;/div&gt;\n   &lt;%= render :partial =&gt; \"shared/loading_image\"%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>`}</p>\n\n<p>Do any one have solution for this please help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","omniauth","vkontakte"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12289263,"title":"Rails omniauth and devise trouble with vk","body":"<p>I'm going to implement facebook and vkontakte login(registering) for my rails app, and with facebook all is ok (login and regitering is ok), done as in manual \n<a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">here</a></p>\n\n<p>But with vkontakte something wrong, i'll still get \"empty\" page</p>\n\n<p>here is my code:</p>\n\n<pre><code>class Users::OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n  def facebook\n    # You need to implement the method below in your model (e.g. app/models/user.rb)\n    @user = User.find_for_facebook_oauth(request.env[\"omniauth.auth\"], current_user)\n\n    if @user.persisted?\n      flash[:notice] = I18n.t \"devise.omniauth_callbacks.success\", :kind =&gt; \"Facebook\"\n      sign_in_and_redirect @user, :event =&gt; :authentication\n    else\n      session[\"devise.facebook_data\"] = request.env[\"omniauth.auth\"]\n      redirect_to new_user_registration_url\n    end\n  end\n\n  def vkontakte\n    @user = User.find_for_vkontakte_oauth(request.env[\"omniauth.auth\"], current_user)\n    if @user.persisted?\n      flash[:notice] = I18n.t \"devise.omniauth_callbacks.success\", :kind =&gt; \"Vkontakte\"\n      sign_in_and_redirect @user, :event =&gt; :authentication\n    else\n      session[\"devise.vkontakte_data\"] = request.env[\"omniauth.auth\"]\n      redirect_to new_user_registration_url\n    end\n  end\nend\n</code></pre>\n\n<p>And model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable,\n         :token_authenticatable, :lockable, :timeoutable, :omniauthable #:confirmable, \n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me, :provider, :uid, :name\ndef self.find_for_facebook_oauth(auth, signed_in_resource=nil)\n    user = User.where(:provider =&gt; auth.provider, :uid =&gt; auth.uid).first\n    unless user\n      user = User.create(name:auth.extra.raw_info.name,\n                           provider:auth.provider,\n                           uid:auth.uid,\n                           email:auth.info.email,\n                           password:Devise.friendly_token[0,20]\n                           )\n    end\n    user\n  end\n\n  def self.new_with_session(params, session)\n    super.tap do |user|\n      if data = session[\"devise.facebook_data\"] &amp;&amp; session[\"devise.facebook_data\"][\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n      if data = session[\"devise.vkontakte_data\"] &amp;&amp; session[\"devise.vkontakte_data\"][\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n    end\n  end\n\n\n\n  def self.find_for_vkontakte_oauth(auth, signed_in_resource=nil)\n    user = User.where(:provider =&gt; auth.provider, :uid =&gt; auth.uid).first\n    unless user\n      user = User.create(name:auth.info.name,\n                           provider:auth.provider,\n                           uid:auth.uid,\n                           email:auth.extra.raw_info.domain+'@vk.com',\n                           password:Devise.friendly_token[0,20]\n                           )\n    end\n    user\n  end\n</code></pre>\n\n<p>What's wrong? </p>\n"},{"tags":["ruby-on-rails","jquery-ajax"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":133,"score":0,"question_id":12318682,"title":"rails - remotipart not working in Rails 3.2.8","body":"<p>Ever since updating to Rails 3.2.8 remotipart stopped working. I can see the iframe-transport.js and remotipart.js are being included in the page, and the form is submitted via AJAX, but the image is not included in the :params. When I disable Javascript image is getting included with :params, so this is very odd.</p>\n\n<p>Can anyone think of something?</p>\n"},{"tags":["ruby-on-rails","forms","match","nested-forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":6431669,"title":"Ruby On Rails 3 - Form - Get nested data that are in somehow connected to the form?","body":"<p>I have a form with category, name, size, price and url.</p>\n\n<p>The first 3 have already been filled in and you shouldn't be able to change that data.</p>\n\n<p>Now I want to display the names instead of category_id, name, size_id in a input box. How do I accomplish this?</p>\n\n<p>The nearest I've gotten so far is to create a \"select\" input with @size.map |s|.... but that is not a good solution. I don't want the user to be able to change these data, so a hidden_field is the best solution I think? But I want to be able to show them the information about the category, name and size.</p>\n\n<pre><code>            &lt;%= f.fields_for :price do |pr| %&gt;\n            &lt;tr&gt;\n              &lt;td&gt;&lt;%= pr.hidden_field :product_id %&gt; &lt;%= Here I want some code showing the name of the product %&gt;&lt;/td&gt;\n              &lt;td&gt;&lt;%= pr.text_field :price %&gt;&lt;/td&gt;\n              &lt;td&gt;&lt;%= pr.text_field :url %&gt;&lt;/td&gt;\n              &lt;td&gt;&lt;%= pr.check_box :_destroy %&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>In my views I have these </p>\n\n<pre><code>@size     = ProductSize.all\n\n@products = Product.all\n\n@categories = Category.all\n</code></pre>\n"},{"tags":["ruby-on-rails","elasticsearch","tire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13265358,"title":"Routing field in elasticsearch via tire","body":"<p>I'm trying to use elasticsearch via tire gem for a multi-tenant app. The app has many accounts with each account having many users.</p>\n\n<p>User Model:</p>\n\n<pre><code>  include Tire::Model::Search\n  mapping do\n    indexes :name, :boost =&gt; 10\n    indexes :account_id\n    indexes :company_name\n  end\n\n  def to_indexed_json\n    to_json( :only =&gt; [:name, :account_id, :company_name], \n       )\n  end\n</code></pre>\n\n<p>I would like to add the routing based on account_id. Please help how this can be achieved.\nI see that there are two ways to specify the routing.</p>\n\n<ol>\n<li>during Mapping using the routing field</li>\n<li>Using aliases</li>\n</ol>\n\n<p>I'm interested in the first option. I see that _routing can be added to mapping section as a hash.</p>\n\n<pre><code>  mapping :_routing =&gt; { :required =&gt; true, :path =&gt; :account_id } do\n    indexes :name, :boost =&gt; 10\n    indexes :account_id\n    indexes :company_name\n  end\n</code></pre>\n\n<p>Search Query:</p>\n\n<pre><code>  User.tire.search do\n    query do\n      filtered do\n          query { string('ovamsikrishna@gmail.com') },\n          filter :term, :account_id =&gt; 2\n      end\n    end\n  end\n</code></pre>\n\n<p>Do we need to specify anything in the search query? The indexing is not happening when I specify the mapping as specified above (with routing). Without routing it works fine.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13265178,"title":"How to find out all the \"hidden\" official Rails guides?","body":"<p>For instance, I found <a href=\"http://guides.rubyonrails.org/ajax_on_rails.html\" rel=\"nofollow\">AJAX on Rails</a> via Google, but it is not listed on the <a href=\"http://guides.rubyonrails.org/index.html\" rel=\"nofollow\">Rails Guides index page</a>.</p>\n"},{"tags":["ruby-on-rails","ruby","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13261376,"title":"Include ERB delimiters inside of a string in an ERB block","body":"<p>I am working on a style guide which displays the code, as well as the output. It is currently structured so that the code only needs to be described once, and is displayed in both its raw and interpreted versions, like so:</p>\n\n<pre><code>&lt;% code = &lt;&lt;PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR\n&lt;div&gt;\n  #{ image_tag 'image.png' }\n&lt;/div&gt;  \nPLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR\n%&gt;\n\n&lt;%= raw code %&gt;\n&lt;%= content_tag :pre, code, class: \"prettyprint linenums\" %&gt;\n</code></pre>\n\n<p>This is great, and fairly easy to maintain. The problem comes in with the rails helpers, like <code>image_tag</code> in the above example. The view example correctly displays an image in a div, and the code example displays the relevant HTML. In this case, the relevant HTML includes an anchor tag - the results of the <code>image_tag</code> method, not the call itself.</p>\n\n<p>I would prefer the code examples to display the helper methods, rather that their results. I am able to make this work by specifying the example code in a file, and either rendering or reading the file. I would prefer to make this work by specifying the code in a variable, as above, but I can't seem to get an ERB delimiter to work inside of a string inside of an erb block. Even the simplest case of <code>&lt;% foo = '&lt;%= bar %&gt;' %&gt;</code> doesn't work at all. I've tried playing with the syntax (<code>&lt;%% %%&gt;</code> and <code>% %</code> for example), using details from the <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html\" rel=\"nofollow\">official documentation</a>, without much success.</p>\n\n<p>The only information I could find on the matter is <a href=\"http://markmail.org/message/gpz5bpqvbclogo7a\" rel=\"nofollow\">here</a>, using <code>&lt;%= \"&lt;\" + \"%=\" %&gt; link_to &lt;%= image.css_tag.humanize %&gt; &lt;%= \"%\" + \"&gt;\" %&gt; %&gt;</code>, which does not work in this use case (if at all).</p>\n\n<p>So, is there a way to specify a string that contains a ERB end-delimiter (<code>%&gt;</code>) in an ERB string, or am I stuck using the slightly clunkier file-read method? Thanks!</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>What I would like to end up with is a working version of this:</p>\n\n<pre><code>&lt;%# Idealized code - does not work %&gt;\n&lt;% code = &lt;&lt;PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR\n&lt;div&gt;\n  &lt;% image_tag 'image.png' %&gt;\n&lt;/div&gt;  \nPLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR\n%&gt;\n</code></pre>\n\n<p>So that <code>&lt;%= raw code %&gt;</code> would (continue to) output:</p>\n\n<pre><code>&lt;div&gt;\n  &lt;img src=\"/images/image.png\" alt=\"Image\" /&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And <code>&lt;%= content_tag :pre, code, class: \"prettyprint linenums\" %&gt;</code> would output:</p>\n\n<pre><code>&lt;pre class=\"prettyprint linenums\"&gt;\n  &lt;div&gt;\n    &lt;% image_tag 'image.png' %&gt;\n  &lt;/div&gt;  \n&lt;/pre&gt;\n</code></pre>\n\n<p>Instead of what it currently does when using a variable, which is:</p>\n\n<pre><code>&lt;pre class=\"prettyprint linenums\"&gt;\n  &lt;div&gt;\n    &lt;img src=\"/images/image.png\" alt=\"Image\" /&gt;\n  &lt;/div&gt;\n&lt;/pre&gt;\n</code></pre>\n\n<p>I want users to be able to copy the code example and paste it into a new view, without having to translate HTML back into the helpers that produce them. I think what I basically need is an alternative ERB delimiter, in the same way that <code>'</code> and <code>\"</code> (or even <code>%q{}</code>) vary for strings. It seems that even though the final ERB delimiter is occurring inside of a string, it is being actually processed as the end of the block. The simplest case of <code>&lt;% foo = '&lt;%= bar %&gt;' %&gt;</code> demonstrates somewhat what I want to accomplish. In a generator, you might use <code>&lt;% foo = '&lt;%%= bar %&gt;' %&gt;</code> (or something similar), to tell it not to process as ERB right then and there. This all works fine when reading from a file, or even in a pure rb file (like a helper), but it makes the most sense to put it in the view, in this case, as it is intended to be easily manipulated by our designers.</p>\n"},{"tags":["javascript","ruby-on-rails","frontend","shopify"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":115,"score":1,"question_id":11936268,"title":"How to develop rails app for shopify with ScriptTags","body":"<p>I have a shopify app deployed in Heroku, developed in Rails. \nI need call a javascript function from any shopify store's frontend.\nI've read this article ( <a href=\"http://www.shopify.com/technology/3033852-shopify-api-update-scripttags-javascript-insertion\" rel=\"nofollow\">http://www.shopify.com/technology/3033852-shopify-api-update-scripttags-javascript-insertion</a> ), but I don't understand it... </p>\n\n<p>Where do I have to put this code: </p>\n\n<pre><code>HTTP POST http://their-shop.myshopify.com/admin/scripttags\n\n  &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n  &lt;script-tag&gt;\n    &lt;src&gt;http://example.com/your-awesome-script.js&lt;/src&gt;\n    &lt;event&gt;onload&lt;/event&gt;\n  &lt;/script-tag&gt;\n</code></pre>\n\n<p>What should be the src tag (for my deployed rails app),\nand where should I put the javascript call function? </p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13264208,"title":"group by in active records","body":"<p>I have one instance variable with two records. </p>\n\n<pre><code>           id   item_with_detail_id  quantity\n\n           100       205                3\n\n\n           101       205                5\n</code></pre>\n\n<p>Now, i want the result as follows using Active record group_by .</p>\n\n<pre><code>           100       205                8\n</code></pre>\n\n<p>i tried with </p>\n\n<pre><code>@bill_details=@bill_details.group_by{|bd| bd.item_with_detail_id}.values.map(&amp;:first)\n</code></pre>\n\n<p>but its not working. Please help me to achieve the result.</p>\n"},{"tags":["ruby-on-rails","activerecord","ruby-on-rails-3.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13264641,"title":"dependent nullify fails in a particular scenario","body":"<p>These are the two models that i have. </p>\n\n<p>One(:id, :two_nd_id) and \nTwo(:id, :nd_id)</p>\n\n<p><strong>Associations</strong></p>\n\n<p>1) One belongs_to :two, :foreign_key => 'two_nd_id', :primary_key => 'nd_id'</p>\n\n<p>2) Two has_many :one, :foreign_key => 'two_nd_id', :primary_key => 'nd_id', :dependent => :nullify</p>\n\n<p>Now, when i try to delete an object of Two it raises an error, </p>\n\n<pre><code>ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column 'one.nd_id' in 'where clause': \nUPDATE `one` SET `two_nd_id` = NULL WHERE `one`.`two_nd_id` = 'xxxxx' AND `one`.`nd_id` IS \nNULL\n</code></pre>\n\n<p>I dont get why <code>'one'.'nd_id' IS NULL</code> is checked at all ! Help me out. Thanks in advance</p>\n\n<p>Note - :dependent => :destroy worked fine !</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","html5"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13264243,"title":"how to use Use images (html tag)in message body of net smtp in ruby on rails?","body":"<p>I m developing web application using Ruby on Rails. I want to display an image in mail using net/smtp..\nmy code is...</p>\n\n<pre><code>msgstr = &lt;&lt;END_OF_MESSAGE\nFrom: Your Name &lt;your@mail.address&gt;\nTo: Destination Address &lt;someone@example.com&gt;\nMIME-Version: 1.0\nContent-type: text/html\nSubject: test message\nDate: Sat, 23 Jun 2001 16:26:43 +0900\nMessage-Id: &lt;unique.message.id.string@example.com&gt;\n&lt;img src = \"/my_proj/public/images/logo.jpeg\" alt= \"logo\"&gt;\n&lt;b&gt;  This is a test message.&lt;/b&gt;\nEND_OF_MESSAGE\n\nrequire 'net/smtp'\nNet::SMTP.start('your.smtp.server', 25) do |smtp|\n  smtp.send_message msgstr,\n                    'your@mail.address',\n                    'his_addess@example.com'\nend\n</code></pre>\n\n<p>It is sending mail with all tags but not displaying th image while displaying alternate text. I hav put jpeg file every where n tested it.. but its not gettng the path of file and diplying the alternate text. Please anyone help me.. how to define path of file... or where to put this image file.\nI have changed</p>\n\n<pre><code>Content-type: text/html image/jpeg\n</code></pre>\n\n<p>but still its not working.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13264111,"title":"Trying to validate a date","body":"<p>I have a form where i'm trying to validate that a field called \"birthday\" is not blank, and that the date is a valid date format that the Chronic gem can parse. I always get the error message \"Birthday is invalid\". I've been trying a simple format \"10/10/2010\".</p>\n\n<p>How can i validate that the birthday field is of a format that chronic can parse?</p>\n\n<p>User.rb model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  validates :birthday, :presence =&gt; true\n  validate :birthday_is_date\n  validate :position, :presence =&gt; true\n\n  # validate the birthday format\n  def birthday_is_date\n    errors.add(:birthday ,Chronic.parse(birthday)) # testing to see the value of :birthday\n    errors.add(:birthday, \"is invalid test message\") if ((Chronic.parse(:birthday) rescue ArgumentError) == ArgumentError)\n  end\nend\n</code></pre>\n\n<p>contacts_controller.rb </p>\n\n<pre><code># POST /contacts/1/edit\n    # actually updates the users data\n    def update_user\n        @userProfile = User.find(params[:id])\n\n        respond_to do |format|\n            if @userProfile.update_attributes(params[:user])\n                format.html {\n                    flash[:success] = \"Information updated successfully\"\n                    redirect_to(profile_path)\n                }\n            else \n                format.html {\n                    flash[:error] = resource.errors.full_messages\n\n                    render :edit\n                }\n            end\n        end\n    end\n</code></pre>\n"},{"tags":["android","ios","ruby-on-rails","authentication","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13243496,"title":"How to let Rails tell mobile applications that users signed in or not?","body":"<p>I'm developing a Rails application that use devise as the authentication solution. For web applications, users enter username and password in a form, Rails can render different pages after users signed in. </p>\n\n<p>Now I'd like to use this framework to support mobile app. In this case, the mobile app needs to know whether the user enters correct username and password. </p>\n\n<p>How should devise response to the mobile application, response headers or JSON inside body? Does devise support it?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13260882,"title":"Display a Variable from a Method in a File in the /lib/ directory on a View in Rails","body":"<p>In a file called <code>foo.rb</code> in my <code>/lib/</code> directory it reads:</p>\n\n<pre><code>module Foo\n  def some_method\n    @text_1 = \"Hello!\"\n  end\nend\n</code></pre>\n\n<p>How can I get the results of this method to show up in a View?</p>\n\n<p>I've seen that I need to include the following line in the <code>/config/application.rb</code> file: </p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib\n</code></pre>\n\n<p>However, I do not completely understand how to pass a variable from a module in a file saved in the <code>/lib/</code> directory - to show up in a View. I appreciate any advice.</p>\n"},{"tags":["ruby-on-rails","facebook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":6,"score":-3,"question_id":13264026,"title":"Deleting comments from FACEBOOK APP in Ruby On Rails","body":"<p>in my Ruby On Rails app i want to delete comments and posts from facebook app(please see its facebook app not any persons facebook account ). I want to know how can i access these posts and comments and delete them. I used kaola( <a href=\"http://rubydoc.info/github/arsduo/koala/master/Koala/Facebook/GraphAPIMethods\" rel=\"nofollow\">http://rubydoc.info/github/arsduo/koala/master/Koala/Facebook/GraphAPIMethods</a> ) but no success .Please help</p>\n"},{"tags":["ruby-on-rails","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":10586881,"title":"calling instance action from terminal","body":"<p>I have this action check_num_reports_on_need in the need model , I need to test it so I want to call it from the terminal on a specific Need .. How can this be done?  </p>\n"},{"tags":["ruby-on-rails","cucumber","capybara"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":14,"score":-1,"question_id":13263759,"title":"How to change text in html by capybara","body":"<p>How to change the text in div by capybara? like this:</p>\n\n<pre><code>&lt;div class=\"setting_text_inline_edit\" &gt;Change Text Goes Here&lt;br&gt;&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":11334661,"title":"Why is Campaign Monitor responding with error \"310: HTML Content URL Required\" even though I have provided the URL?","body":"<p>I'm using the <a href=\"https://github.com/campaignmonitor/createsend-ruby\" rel=\"nofollow\">CreateSend API gem</a>, and in my <strong>local dev</strong> environment I am able to successfully create a draft campaign.</p>\n\n<p>In <strong>production (staging), on Heroku</strong>, the exact same code instead returns with an error:</p>\n\n<pre><code>310: HTML Content URL Required\n</code></pre>\n\n<p>I am definitely passing the HTML content URL, as well as all the other required arguments to <code>Campaign.create</code> (I've visually verified the fact by logging the variables). Here's the API call:</p>\n\n<pre><code>cm_campaign_id = CreateSend::Campaign.create client_id, subject, name, from_name, from_email, reply_to, html_url, text_url, list_ids, segment_ids\n</code></pre>\n\n<p>Furthermore, in local dev the API call returns in less than 3 seconds, whereas on Heroku it times out for 30 seconds and returns that error.</p>\n\n<p>Why is this happening on Heroku?</p>\n"},{"tags":["ruby-on-rails","dst"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13263383,"title":"How to get DST Offset to be consistent on local machine vs server?","body":"<p>I'm using ActiveSupport's Timezone class to find the offset of a Timezone like so. </p>\n\n<pre><code>novdate = Date.new(2012,11,04)\noffset_in_seconds = ActiveSupport::TimeZone['Eastern Time (US &amp; Canada)'].at(novdate.to_time.midnight+3.hours).utc_offset\n</code></pre>\n\n<p>The problem is that offset_in_seconds is different on my local machine and on a heroku server. I'm not sure why this is happening. I've set config.time_zone = 'Eastern Time (US &amp; Canada)' in my rails application.rb file. How can I accurately and consistently get a timezone offset for a given date? I've been adding 3 hours to the time above because the time should have been changed from DST to non-DST at 3:00am on a given date.</p>\n\n<p>-- display from my local rails console --</p>\n\n<pre><code>novdate = Date.new(2012,11,04)\nActiveSupport::TimeZone['Eastern Time (US &amp; Canada)'].at(novdate.to_time.midnight+1.hours)\n =&gt; Sun, 04 Nov 2012 01:00:00 EDT -04:00 \nActiveSupport::TimeZone['Eastern Time (US &amp; Canada)'].at(novdate.to_time.midnight+2.hours)\n =&gt; Sun, 04 Nov 2012 01:00:00 EST -05:00 \nActiveSupport::TimeZone['Eastern Time (US &amp; Canada)'].at(novdate.to_time.midnight+3.hours)\n =&gt; Sun, 04 Nov 2012 02:00:00 EST -05:00 \n</code></pre>\n\n<p>-- output from a heroku rails console ---</p>\n\n<pre><code>ActiveSupport::TimeZone['Eastern Time (US &amp; Canada)'].at(novdate.to_time.midnight+4.hours)\n=&gt; Sun, 04 Nov 2012 00:00:00 EDT -04:00\nActiveSupport::TimeZone['Eastern Time (US &amp; Canada)'].at(novdate.to_time.midnight+5.hours)\n=&gt; Sun, 04 Nov 2012 01:00:00 EDT -04:00\nActiveSupport::TimeZone['Eastern Time (US &amp; Canada)'].at(novdate.to_time.midnight+6.hours)\n=&gt; Sun, 04 Nov 2012 01:00:00 EST -05:00\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","software-engineering","sti"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13187347,"title":"Should I split this model and table?","body":"<p>I would like to create simple ResumeBank app.</p>\n\n<p><strong>Issue</strong>:</p>\n\n<p>As user I would like to add only two Resumes.\nForms for this both Resumes are different with only two fields. \nResumes have 12 the same attributes but 2 are diferent.</p>\n\n<p><strong>Question</strong>:</p>\n\n<p>Should I split that Resume model and tables to ex: PolishResume and EnglishResume, polish_remsumes and english_remsumes?</p>\n\n<p>Or maybe should I use STI and create PolishResume &lt; Resume and use one table.</p>\n\n<p>What are disadvantages of splitting option?</p>\n"},{"tags":["ruby-on-rails","devise","approval"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13263322,"title":"Require Admin to Activate Account With update individual","body":"<p>i have implemented manage user for approved, i use update individual for edit users.</p>\n\n<p>hmtl file</p>\n\n<pre><code>&lt;%= form_tag update_individual_homes_path, :method =&gt; :put do %&gt;\n  &lt;% for user in @users %&gt;\n    &lt;%= fields_for \"users[]\", user do |f| %&gt;\n      &lt;h2&gt;&lt;%= h(user.email) %&gt;&lt;/h2&gt;\n      &lt;p&gt;&lt;%= check_box_tag :approved %&gt;&lt;/p&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;&lt;%= submit_tag \"Submit\" %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>on controller..</p>\n\n<pre><code>def edit_individual\n  @users = User.find(params[:user_ids])\nend\n\ndef update_individual\n\n  @users = User.update(params[:users].keys, params[:users].values).reject { |p| p.errors.empty? }\n    if @users.empty?\n      flash[:notice] = \"Users updated\"\n      redirect_to root_path\n    else\n      render :action =&gt; \"edit_individual\"\n    end\nend \n</code></pre>\n\n<p>message error and value of approved not change..</p>\n\n<pre><code>NoMethodError in HomesController#update_individual\n\nundefined method `keys' for nil:NilClas\n</code></pre>\n\n<p>Any solutions?\nthx</p>\n"},{"tags":["ruby-on-rails","scaffolding"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":37,"score":1,"question_id":13115750,"title":"Composite entity scaffolding in Ruby on Rails","body":"<p>Im new in ror. As far as i have gone i used scaffolding to create CRUD operations using scaffolding.  Now i need to integrate two entities into single form using scaffolding ie., not by hard coding it. </p>\n\n<p>How can we scaffold two entities together using script?</p>\n\n<p>I have two entities Student_address and Student_phnumber i want to scaffold these two entities into a single form where i can do CRUD operation and i want to achieve this by scaffolding.</p>\n\n<p>Student_address is an entity consisting of Hse_name, Street_name, etc.\nStudent_phnumber another entity consisting of ph_number, type, etc.</p>\n\n<p>I want to scaffold these two entities together</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","associations"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13262543,"title":"Issue with association creates","body":"<p>Here are my associations...</p>\n\n<pre><code>Account has_many :credits\nCredit belongs_to :account\n</code></pre>\n\n<p>And I'm trying to run: <code>account.credits.current</code></p>\n\n<p>So, in that case, I've already got an <code>Account</code> object, and then I want to access a <code>current</code> method within the <code>Credit</code> model.</p>\n\n<p>Here is that method...</p>\n\n<pre><code>def self.current\n   # Find current credit line\n   current = self.where(:for_date =&gt; Time.now.strftime(\"%Y-%m-01\")).first\n\n   # If we couldn't find a credit line for this month, create one\n   current = Credit.create(:account_id =&gt; self.account.id, :for_date =&gt; Time.now.strftime(\"%Y-%m-01\")) if current.blank?\n\n   # Return the object\n   current\nend\n</code></pre>\n\n<p>The problem is on that second line...the one that should create a new credit entry if it can't find one. Specifically, I can't set what account it should be associated with. I just get an <code>undefined method 'account'</code> error.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13263188,"title":"How do you update a join table record with no primary keys in rails?","body":"<p>I have a join table that has a through association between two other tables. This table has its own rails model representation and some fields that are not the the id's of the other tables. Is it possible to update a record from the join table or should I consider creating a unique primary key?</p>\n\n<p>If I try to \"update_attributes\" on the record I get the following error...</p>\n\n<pre><code>Unknown column 'join_table.' in 'where clause': UPDATE `join_table` SET `join_table_attribute` = 1 WHERE `join_table`.`` IS NULL\n</code></pre>\n"},{"tags":["ruby-on-rails","devise","capybara","rspec-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13260521,"title":"Test authentication redirect using Devise and RSpec","body":"<p>I have a sample Rails app that I'm working on so I can start getting familiar with BDD.</p>\n\n<p>Right now I'm using Devise to handle my user authentication.</p>\n\n<p>I have a Task model which requires a user to be logged in in order to access the new, create, edit, and destroy actions.</p>\n\n<p>I have the following code:</p>\n\n<p><strong>requests/tasks_spec.rb</strong></p>\n\n<pre><code>describe \"Tasks\" do\n\n  it \"redirects to sign in for new task if no user logged in\" do\n    visit new_task_path\n    response.should redirect_to(new_user_session_path)\n  end\n\nend\n</code></pre>\n\n<p>Now when I run this test, I expect it to fail because I haven't added any before_filter logic to TasksController.  I run the test and it fails.</p>\n\n<p>Now I add the <code>authenticate_user!</code> helper provided by Devise.</p>\n\n<p><strong>tasks_controller.rb</strong></p>\n\n<pre><code>class TasksController &lt; ApplicationController\n  before_filter :authenticate_user!, only: [:new, :edit, :create, :destroy]\n  ...\nend\n</code></pre>\n\n<p>The tests run and still fails, saying the following:</p>\n\n<pre><code>  1) TasksController redirects to sign in for new task if no user logged in\n     Failure/Error: response.should redirect_to(new_user_session_path)\n       Expected response to be a &lt;:redirect&gt;, but was &lt;200&gt;\n</code></pre>\n\n<p>Now when calling visit, since no user was established in the session, I expect the response to be redirected to /user/sign_in.  However, I simply get a 200OK back.</p>\n\n<p>What am I missing here?  How do I get this test to pass?</p>\n"},{"tags":["ruby-on-rails","ruby","mongodb","callback","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13262269,"title":"Rails: How to implement this relation in Mongoid?","body":"<p>So I have 4 Models: <strong>Product, Sale, Ingredient &amp; Product_sale</strong></p>\n\n<p>The idea is to have a DB of different foods/dishes (the \"products\" model/DB) where I can store objects like hamburger, pizza and so on with their respective ingredients, and every time an order (sale) gets placed, a \"preparation\" (product_sale) should be created and this preparation should substract the respective ingredients from the ingredients \"inventory\" of the app, To be more clear:</p>\n\n<ul>\n<li>In the app, Users can create products such as Hamburger, Pizza and so\non</li>\n<li>We have an Ingredients inventory (DB/Model), where users capture ingredients\nquantities available</li>\n<li>A Hamburger has some ingredients such as pickles, patty, etc.</li>\n</ul>\n\n<p>Let's say we have 10 patties, I wanna substract 1 patty from the ingredients DB every time 1 normal burger is ordered and prepared. This is what I have so far:</p>\n\n<p><strong>Ingredient Model</strong></p>\n\n<pre><code>class Ingredient\n  include Mongoid::Document\n  belongs_to :product\n  has_many :product_sales\n\n  field :salchichapavo, type: Integer\n  field :salsatomate, type: Integer\n  field :chipotle, type: Integer\n  field :mayonesa, type: Integer\n  field :salsatabasco, type: Integer\n  field :palillos, type: Integer\n  field :panbriosh, type: Integer\n  field :salchicha22cm, type: Integer\n  field :cebollacaramelizada, type: Integer\n  field :lechuga, type: Integer\n  field :pepino, type: Integer\n  field :vinagreta, type: Integer\n  field :tocino, type: Integer\n  field :queso, type: Integer\n  field :salsabbq, type: Integer\n  field :salchichares, type: Integer\n  field :panbaguette, type: Integer\n  field :jitomate, type: Integer\n  field :cerveza, type: Integer\n  field :pulque, type: Integer\n  field :qty, :type =&gt; Integer\n  field :type, :type =&gt; String\n  field :product_id, :type =&gt; String\n  field :ingredient_id, :type =&gt; String\nend\n</code></pre>\n\n<p><strong>Product Model:</strong></p>\n\n<pre><code>class Product\n  include Mongoid::Document\n  has_many :product_sales\n  has_many :ingredients\n\n  field :salchichapavo, type: Integer\n  field :salsatomate, type: Integer\n  field :chipotle, type: Integer\n  field :mayonesa, type: Integer\n  field :salsatabasco, type: Integer\n  field :palillos, type: Integer\n  field :panbriosh, type: Integer\n  field :salchicha22cm, type: Integer\n  field :cebollacaramelizada, type: Integer\n  field :lechuga, type: Integer\n  field :pepino, type: Integer\n  field :vinagreta, type: Integer\n  field :tocino, type: Integer\n  field :queso, type: Integer\n  field :salsabbq, type: Integer\n  field :salchichares, type: Integer\n  field :panbaguette, type: Integer\n  field :jitomate, type: Integer\n  field :cerveza, type: Integer\n  field :pulque, type: Integer\n  field :qty, :type =&gt; Integer\n  field :type, :type =&gt; String\n  field :precio, :type =&gt; BigDecimal\n\n  validates_uniqueness_of :uniclave\nend\n</code></pre>\n\n<p><strong>ProductSale Model:</strong></p>\n\n<pre><code>class ProductSale\n  include Mongoid::Document\n\n  belongs_to :sale\n  belongs_to :product\n  belongs_to :ingredient\n\n  field :salchichapavo, type: Integer\n  field :salsatomate, type: Integer\n  field :chipotle, type: Integer\n  field :mayonesa, type: Integer\n  field :salsatabasco, type: Integer\n  field :palillos, type: Integer\n  field :panbriosh, type: Integer\n  field :salchicha22cm, type: Integer\n  field :cebollacaramelizada, type: Integer\n  field :lechuga, type: Integer\n  field :pepino, type: Integer\n  field :vinagreta, type: Integer\n  field :tocino, type: Integer\n  field :queso, type: Integer\n  field :salsabbq, type: Integer\n  field :salchichares, type: Integer\n  field :panbaguette, type: Integer\n  field :jitomate, type: Integer\n  field :cerveza, type: Integer\n  field :pulque, type: Integer\n  field :qty, :type =&gt; Integer\n  field :type, :type =&gt; String\n  field :product_id, :type =&gt; String\n  field :sale_id, :type =&gt; String\n  field :ingredient_id, :type =&gt; String\n  field :precio, :type =&gt; BigDecimal\n\n\n  after_create :decrement_salchichapavo\n\n  def decrement_salchichapavo\n    self.ingredient.update_attribute(\"salchichapavo\", (ingredient.salchichapavo - self.salchichapavo))\n  end\n\nend\n</code></pre>\n\n<p><strong>Sale Model:</strong></p>\n\n<pre><code>class Sale\n  include Mongoid::Document\n  belongs_to :user\n  has_many :product_sales\n\n  field :salchichapavo, type: Integer\n  field :salsatomate, type: Integer\n  field :chipotle, type: Integer\n  field :mayonesa, type: Integer\n  field :salsatabasco, type: Integer\n  field :palillos, type: Integer\n  field :panbriosh, type: Integer\n  field :salchicha22cm, type: Integer\n  field :cebollacaramelizada, type: Integer\n  field :lechuga, type: Integer\n  field :pepino, type: Integer\n  field :vinagreta, type: Integer\n  field :tocino, type: Integer\n  field :queso, type: Integer\n  field :salsabbq, type: Integer\n  field :salchichares, type: Integer\n  field :panbaguette, type: Integer\n  field :jitomate, type: Integer\n  field :cerveza, type: Integer\n  field :pulque, type: Integer\n  field :qty, :type =&gt; Integer\n  field :type, :type =&gt; String\n  field :product_id, :type =&gt; String\n  field :sale_id, :type =&gt; String\n  field :ingredient_id, :type =&gt; String\n  field :precio, :type =&gt; BigDecimal\nend\n</code></pre>\n\n<p>But when I create a new productsale I get an </p>\n\n<pre><code>undefined method `salchichapavo' for nil:NilClass\n</code></pre>\n\n<p>Error, So I think something is wrong with the models... The idea is to have 1 after_create callback for each ingredient so everytime a product with X ingredients get prepared just those ingredients decrement.</p>\n\n<p>Can someone give me some advice?</p>\n\n<p>Thank you.</p>\n"},{"tags":["ruby-on-rails","nginx","rvm","rack","phusion-passenger"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":29,"score":1,"question_id":13262163,"title":"Installing passenger nginx","body":"<p>I installed the passenger gem, but it didn't work with my old nginx. So I am trying to install nginx from the passenger script.</p>\n\n<p>I do <code>$ sudo ./bin/passenger-install-nginx-module</code>, which gives </p>\n\n<pre><code> * rack... not found\n * To install rack:\n   Please install RubyGems first, then run /home/dbadmin/.rvm/wrappers/ruby-1.9.3-p286@rails-3.1.1/gem install rack\n</code></pre>\n\n<p>Although the rack gem is in fact installed. Anyway, I do</p>\n\n<pre><code>$ /home/dbadmin/.rvm/wrappers/ruby-1.9.3-p286@rails-3.1.1/gem install rack\nSuccessfully installed rack-1.4.1\n1 gem installed\nInstalling ri documentation for rack-1.4.1...\nInstalling RDoc documentation for rack-1.4.1...\n</code></pre>\n\n<p>After this, <code>$ sudo ./bin/passenger-install-nginx-module</code> again says that <code>* rack... not found</code>.</p>\n\n<p>What might be happening?</p>\n"},{"tags":["ruby-on-rails","has-many-through"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13262774,"title":"NoMethodError (undefined method `scoped' for Class:Module):","body":"<p>I have a has_many and has_many :through relationship that looks like this...</p>\n\n<pre><code>class Guestlist &lt; ActiveRecord::Base\n    belongs_to :venues\n\n    has_many :patrons\n    has_many :users, :through =&gt; :patrons\n\n    attr_accessible :capacity, :end_time, :name, :start_time, :venue_id\nend\n\nclass Patron &lt; ActiveRecord::Base\n    belongs_to :guestlists\n    belongs_to :users\n    attr_accessible :guestlist_id, :user_id, :checked_in\nend\n\nclass User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  attr_accessible :name, :email, :password, :password_confirmation, :remember_me\n\n  has_many :patrons\n  has_many :guestlists, :through =&gt; :patrons\nend\n</code></pre>\n\n<p>I am trying to access the users \"through\" guestlist object...</p>\n\n<pre><code>@guestlist = Guestlist.find(params[:id])\n@guests = @guestlist.users.order('name ASC')\n</code></pre>\n\n<p>and the following error is thrown...</p>\n\n<pre><code>NoMethodError (undefined method `scoped' for Users:Module)\n</code></pre>\n\n<p>I've been searching all over for a solution but nothing works. Please help!</p>\n"},{"tags":["ruby-on-rails","rspec","config"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13262656,"title":"Rails 3.1 set host in test environment","body":"<p>I'm getting <code>http://www.example.com</code> whenever I use <code>root_url</code> in my tests.</p>\n\n<p>It works fine in development, where I have this in config/environments/development.rb:</p>\n\n<pre><code>Rails.application.routes.default_url_options[:host]= 'localhost:3000'\n</code></pre>\n\n<p>Adding this doesn't work in config/environments/test.rb, though. What should I add to use <code>localhost:3000</code> as the host in the test environment?</p>\n"},{"tags":["ruby-on-rails","form-for"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13262162,"title":"how to add an association between has_many through models in a form?","body":"<p>I have Groups and PhoneNumbers models connected with a has_many through relationship called group_phone_numbers.</p>\n\n<p>Basically, on a group edit view, I want a list of phone_numbers with add or remove links next to them. When someone clicks add, it creates an association between the models and when someone clicks remove, it removes it. Is the proper way to do this by using a form? Or should I just do a link_to a custom controller action? </p>\n"},{"tags":["ruby-on-rails","curl","devise","httprequest","access-token"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13262167,"title":"Obtain access token on Rails","body":"<p>I use devise for authentication on Rails. Currently I'm testing some POST functions for the APIs and I want to do that with cRUL, so I need access token to get approved by devise. Then I can use cURL like</p>\n\n<pre><code>curl -v -H \"Accept: application/json\" -H \"Content-type: application/json\" -H \n'Authorization: Token token=\"\"' -X POST -d '{\"name\": \"paul \nallen\",\"first_name\":\"paul\",\"last_name\":\"allen\",\"middle_name\":\"\",\"gender\":\"m\",\n\"dob\":\"1/2/1980\",\"dod\":\"\"}' http://localhost:3000/?auth_token=OyZSe8ozy_os5acibqNC \n</code></pre>\n\n<p>but how can I get the auth_token? (OyZSe8ozy_os5acibqNC)?</p>\n"},{"tags":["ruby-on-rails","validation","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13262579,"title":"validates combination of attributes","body":"<p>I have two attributes (hours and days) in my model (auction). I have business logic on the combination of hours and days. For example </p>\n\n<pre><code>auction duration = days*24 + hours\n</code></pre>\n\n<p>I also have some basic validation on hours and days:</p>\n\n<pre><code>class Auction &lt; ActiveRecord::Base\n  validates :days,:presence =&gt; true, :numericality =&gt; { :greater_than_or_equal_to =&gt; 0, :only_integer =&gt; true }\n  validates :hours,:presence =&gt; true, :numericality =&gt; { :greater_than_or_equal_to =&gt; 0, :only_integer =&gt; true }\n</code></pre>\n\n<p>I would like to incorporate my business logic into the validation, such that hour and days cannot both be zero. Is there a way to do this with an ActiveRecord validation? I know there are other ways to do this w/out an AR validation. Right now I am creating a new instance of my model. Validating days and hours as above. Then I have a model method that \"manually\" does the validation and removes the instance if it doesn't pass. I know this is not the best way to do this</p>\n\n<pre><code>  def compute_end_time\n    # assumes that days and hours are already valid\n    time = self.days*24 + self.hours\n\n    if time &gt; 1\n      self.end_time =  time.hours.from_now.utc\n      self.save\n\n    else\n      # Auction duration too short (i.e. zero)\n      self.delete\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","methods","routes"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13262230,"title":"Defining custom methods in Rails","body":"<p>I have just started using Rails and I am trying to build a banking app.  I am having trouble setting up transactions between accounts. </p>\n\n<p>I have currently scaffolded Transaction and Account.  In my transaction page I can create a list of transaction with each transaction containing information about the source account, amount to transfer and the destination account. However, at the end of the page I would like a link or a button that processes all the transactions on the page and clears the page. Thus, modifying all the specified account balances. </p>\n\n<p>Below is the steps I took in going about it.</p>\n\n<p><strong>1)</strong> In transaction model (transaction.rb model) define process method </p>\n\n<pre><code>class Transaction &lt; ActiveRecord::Base\n    def proc (transaction) \n        # Code processes transactions\n        @account = Account.find(transaction.from_account)\n        @account.balance = @account.balance - transaction.amount\n        @account.update_attributes(params[:account]) #update the new balance\nend\nend\n</code></pre>\n\n<p><strong>2)</strong> Then create a method in transaction controller call execute</p>\n\n<pre><code>def execute\n      @transaction = Transaction.find(params[:id])\n    proc (@transaction)\n    @transaction.destroy\n\n      respond_to do |format|\n      format.html { redirect_to transactions_url }\n      format.json { head :no_content }\n  end\n</code></pre>\n\n<p><strong>3)</strong> Then define the a link to display on the transaction page (shown below):</p>\n\n<pre><code>&lt;% @transactions.each do |transaction| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= transaction.from_account %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= transaction.amount %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= transaction.to_account %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Execute', transaction, confirm: 'Are you sure?', method: :execute %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', transaction %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Edit', edit_transaction_path(transaction) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Destroy', transaction, confirm: 'Are you sure?', method: :delete %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= transaction.id%&gt;&lt;/td&gt;\n &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>4) But when I click the Execute link I get the routing error:\n[POST] \"/transactions/6\"</p>\n\n<p>Currently my routes(routes.rb) are setup as follows:</p>\n\n<pre><code>resources :transactions do\n       member do\n       post :execute\n       end\n   end\n\n  resources :accounts\n</code></pre>\n\n<p>How do I setup the routes so that it may process my method?\nThanks in advance </p>\n"},{"tags":["ruby-on-rails","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13210062,"title":"Enabling users to enter their email when they login with Twitter (OmniAuth)","body":"<p>I'm using <a href=\"https://github.com/arunagw/omniauth-twitter\" rel=\"nofollow\">omniauth-twitter</a> and I have everything set up:</p>\n\n<p><strong>user.rb:</strong></p>\n\n<pre><code>  def self.create_with_omniauth(auth)\n    create! do |user|\n      user.provider = auth[\"provider\"]\n      user.uid = auth[\"uid\"]\n      user.name = auth[\"info\"][\"name\"]\n      user.email = auth[\"info\"][\"email\"]\n      # To pass password validation\n      user.password = user.password_confirmation = SecureRandom.urlsafe_base64(n=6) \n    end\n  end\n</code></pre>\n\n<p><strong>sessions_controller.rb:</strong></p>\n\n<pre><code> def create\n    user = User.find_by_email(params[:session][:email].downcase)\n    if user &amp;&amp; user.authenticate(params[:session][:password])\n      sign_in user\n      redirect_back_or user\n    else\n      flash.now[:error] = 'Invalid email/password combination'\n      render 'new'\n    end\n  end\n</code></pre>\n\n<p>The problem is that you can't retrieve an email address from Twitter, so the login fails because of my validation rules:</p>\n\n<p><strong>user.rb:</strong></p>\n\n<pre><code> before_save { |user| user.email = email.downcase }\n  before_save :create_remember_token\n\n  validates :name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence:   true,\n                    format:     { with: VALID_EMAIL_REGEX },\n                    uniqueness: { case_sensitive: false }\n  validates :password, presence: true, length: { minimum: 6 }\n  validates :password_confirmation, presence: true \n</code></pre>\n\n<p>I want to enable users to enter an email so they can login without failing the validation (only with Twitter, since I have Facebook and Google login too).</p>\n\n<p>Does anyone have any suggestion? </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p><strong>users_controller.rb:</strong></p>\n\n<pre><code> def create\n    @user = User.new(params[:user])\n    if @user.save\n      sign_in @user\n      flash[:success] = \"Welcome to the Sample App!\"\n      redirect_to @user\n    else\n      if params[:form_name] == \"enter_email\"\n        render 'enter_email'\n      else\n        render 'new'\n      end\n    end\n  end\n</code></pre>\n\n<p><strong>users/enter_email.html.erb:</strong></p>\n\n<pre><code>&lt;% provide(:title, 'Enter your email') %&gt;\n&lt;h1&gt;Enter your email&lt;/h1&gt;\n\n    &lt;div class=\"row\"&gt;\n      &lt;div class=\"span6 offset3\"&gt;\n        &lt;%= form_for(@user) do |f| %&gt;\n          &lt;%= render 'shared/error_messages', object: f.object %&gt;\n\n          &lt;%= f.label :email %&gt;\n          &lt;%= f.text_field :email %&gt;\n\n          &lt;%= f.hidden_field :provider, value: params[:oprovider] %&gt;\n          &lt;%= f.hidden_field :provider, value: params[:oprovider] %&gt;\n          &lt;%= f.hidden_field :uid, value: params[:ouid] %&gt;\n          &lt;%= f.hidden_field :name, value: params[:oname] %&gt;\n          &lt;%= f.hidden_field :password , value: params[:opassword] %&gt;\n          &lt;%= f.hidden_field :password_confirmation, value: params[:opassword_confirmation] %&gt;\n\n          &lt;% # To know to which form to redirect in case of validation error %&gt;\n          &lt;%= hidden_field_tag 'form_name', 'enter_email' %&gt;\n\n          &lt;%= f.submit \"Create my account\", class: \"btn btn-large btn-primary\" %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13262220,"title":"Find each topic which has a comment from user XXX","body":"<p>As the title states, I would like to know, before writing a join, if there is a way to write this query in rails.</p>\n\n<p>I need to find every topic which has one post from user XXX.\nWhat are the approach that is considered \"correct\" for this type of query in rails?</p>\n\n<p><strong>Edit 1:</strong></p>\n\n<p>My models are these actually:</p>\n\n<ul>\n<li>Topic has_many Comment</li>\n<li>Comment belongs_to User</li>\n<li>Comment belongs_to Topic</li>\n<li>User has_many Comment</li>\n<li>User has_many Topic</li>\n</ul>\n"},{"tags":["ruby-on-rails","debugging","amazon-ec2","amazon-web-services","production"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13260664,"title":"Debugging Ruby on Rails production app hosted on AWS","body":"<p>How do I go about debugging a Rails app hosted on Amazon AWS? On local, I add <code>debugger</code> lines whenever I want to test the flow of a request through the code. I'm not sure how to use this technique on production, because the Rails app runs as a daemon.</p>\n\n<p>Also, I rely a lot on the log files. For some reason, my production log files are empty. I tried the solution mentioned in <a href=\"http://stackoverflow.com/a/9385359/724516\">http://stackoverflow.com/a/9385359/724516</a>, but it doesn't work for me. I get a no 'sync=' method found for nil object error.</p>\n\n<p><strong>UPDATE</strong>:\nI figured out why the production logs were empty - my application.rb had a line which said <code>config.logger = Logger.new(STDOUT)</code> which I had added as a fix for logging with Unicorn. I removed it.</p>\n"},{"tags":["ruby-on-rails","git","heroku"],"answer_count":6,"favorite_count":10,"up_vote_count":16,"down_vote_count":0,"view_count":5571,"score":16,"question_id":4663103,"title":"Multiple heroku accounts","body":"<p>I'm having trouble when working with multiple Heroku accounts on my computer.</p>\n\n<p>The thing is that it's worked great before by switching account with the herokup gem. But now (even though I've generated new SSH keys) it wont work.</p>\n\n<p>When I do a \"git push heroku master\" it just says:</p>\n\n<p>my@email.com not authorized to access my_app_name</p>\n\n<p>Does anyone have any advice on how I could solve this?</p>\n\n<p>Thank you!</p>\n"},{"tags":["ruby-on-rails","paperclip","identify"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13249770,"title":"Paperclip::Errors::NotIdentifiedByImageMagickError:","body":"<p>use paperclip upload image error:</p>\n\n<p>Command :: identify -format %wx%h '/tmp/103120121106-20384-i7dnzy.png[0]' [paperclip] An error was received while processing:\n<strong># &lt; Paperclip::Errors::NotIdentifiedByImageMagickError: /tmp/103120121106-20384-i7dnzy.png is not recognized by the 'identify' command.></strong></p>\n\n<p>I find identify:</p>\n\n<pre><code>joinall@nxbbs-server:/nxbbs$ type identify  \nidentify is hashed (/usr/local/bin/identify) \njoinall@nxbbs-server:/nxbbs$ convert logo: 2.jpg \njoinall@nxbbs-server:/nxbbs$ identify  2.jpg\n2.jpg GIF 640x480 640x480+0+0 8-bit sRGB 256c 31.7KB 0.000u 0:00.000\n</code></pre>\n\n<p>In config/environments/development.rb </p>\n\n<pre><code> Paperclip.options[:command_path] = \"/user/local/bin\"\n</code></pre>\n\n<p>In app/models/user.rb</p>\n\n<pre><code>arrt_accessible :avatar\nhas_attached_file :avatar, :styles=&gt; {:s120 =&gt; \"120x120&gt;\",:s48 =&gt; \"48x48&gt;\",:s16 =&gt; \"16x16&gt;\"}\n</code></pre>\n\n<p>please help me ,I can not found the problem</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13262160,"title":"Creating Track Product button in Rails","body":"<p>I'm trying to include a 'Track item' button to a list of products on a user profile page, but this error message keeps appearing:</p>\n\n<pre><code>LoadError in TrackedProductsController#create\n\nExpected /Users/anon/rails_projects/webproject/app/controllers/tracked_products_controller.rb to define TrackedProductsController\n</code></pre>\n\n<p>I've tried a number of things, but nothing seems to be working. Can somebody help me out and shed some light on what I should be doing?</p>\n\n<p>Here's the tracked_products_controller. </p>\n\n<pre><code>class TrackedProductController &lt; ApplicationController\nbefore_filter :signed_in_user\nrespond_to :html, :json, :xml, :js\n\ndef create\n  @user = current_user\n  @product = Product.find(params[:tracked_products][:tracked_id])\n  current_user.track!(@product)\n  redirect_to @user\n\n  respond_with @tracked_product\nend\n\ndef destroy\n  @user = current_user\n  @product = TrackedProduct.find(params[:id]).tracked\n  current_user.untrack!(@product)\n  redirect_to @user\n\n  respond_with @tracked_product\nend\nend\n</code></pre>\n\n<p>Model: tracked_products.rb</p>\n\n<pre><code>class TrackedProduct &lt; ActiveRecord::Base\nattr_accessible :last_order, :next_order, :tracked_id, :tracker_id\n\nbelongs_to :tracker, class_name: \"User\"\nbelongs_to :tracked, class_name: \"Product\"\n\nvalidates :tracked_id, presence: true\nvalidates :tracker_id, presence: true\nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13261995,"title":"Ruby on Rails div_for vs <div>","body":"<p>I'm new to Ruby on Rails. In my erb files, is there any reason to use the <code>div_for</code> helper over just typing out the <code>&lt;div&gt;</code> tags and setting the properties as HTML? What advantage is there to using <code>div_for</code>, and is there a recommended best practice?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.1","nginx","rvm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13260267,"title":"ENV['MY_RUBY_HOME'] is nil while trying to get nginx to play with rvm","body":"<p>I want to nginx to serve a rails app. I've set up my gems using an rvm gemset. From the <a href=\"https://rvm.io/integration/passenger/\" rel=\"nofollow\">directions</a> to get nginx to load my gemset, I made a config/setup_load_paths.rb file:</p>\n\n<pre><code>if ENV['MY_RUBY_HOME'] &amp;&amp; ENV['MY_RUBY_HOME'].include?('rvm')\n  begin\n    rvm_path     = File.dirname(File.dirname(ENV['MY_RUBY_HOME']))\n    rvm_lib_path = File.join(rvm_path, 'lib')\n    puts rvm_lib_path.inspect\n    $LOAD_PATH.unshift rvm_lib_path\n    require 'rvm'\n    RVM.use_from_path! File.dirname(File.dirname(__FILE__))\n  rescue LoadError\n    # RVM is unavailable at this point.\n    raise \"RVM ruby lib is currently unavailable.\"\n  end\nend\n\nENV['BUNDLE_GEMFILE'] = File.expand_path('../Gemfile', File.dirname(__FILE__))\nrequire 'bundler/setup' \n</code></pre>\n\n<p>This doesn't seem to do it. So trying to debug, I found that <code>ENV['MY_RUBY_HOME']</code> is actually Nil and hence the first block of code doesn't even run. Why is this Nil, and what can I do to fix this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","asset-pipeline","sprockets"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13261616,"title":"How can I access image_path route helper inside a Rails 3 model?","body":"<p>I'm trying to use Sprockets' image_path method from within a Rails 3 model. I've tried including <code>ActionView::Helpers::AssetTagHelper</code> in my model and calling image_path but that does not work (<code>undefined local variable or method 'config'</code>).</p>\n\n<p>Any ideas?</p>\n\n<p><strong>Update - this worked for me:</strong></p>\n\n<pre><code>ActionController::Base.new.view_context.asset_path(\"image.png\")\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13261474,"title":"ruby modules and classes same name in structure","body":"<p>I have a folder structure like the following in one of my projects:</p>\n\n<ul>\n<li>lib\n<ul>\n<li>bar.rb</li>\n<li>bar\n<ul>\n<li>other_bar.rb</li>\n<li>another_bar.rb</li>\n<li>next_bar.rb</li>\n<li>...</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p><strong>bar.rb</strong></p>\n\n<pre><code>require File.expand_path(File.dirname(__FILE__) + \"/bar/other_bar.rb\")\n\nclass Bar\n  puts \"running BarBase\"\nend\n</code></pre>\n\n<p><strong>bar/other_bar.rb</strong></p>\n\n<pre><code>module Bar\n  class OtherBar\n    puts \"running module Bar with class OtherBar\"\n  end\nend\n</code></pre>\n\n<p>If I now run <code>ruby bar.rb</code> I get this:</p>\n\n<blockquote>\n  <p>running module Bar with class OtherBar<br>\n  bar.rb:3:in `': Bar is not a class (TypeError)</p>\n</blockquote>\n\n<p>I'd like to have a similar structure to a rails model inheritance structure. How can I fix this?  So far as I know ruby does not support this out of the box. Is there a workaround for such a situation?</p>\n"},{"tags":["ruby-on-rails","crm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13256880,"title":"Integration of SAGE CRM + SAGE Instant Accounts within Ruby on Rails","body":"<p>I hope my question is relevant, as I have no experience whatsoever with the SAGE products.</p>\n\n<p>I develop websites using Ruby on Rails, and one of my clients is looking to get a website developed which would integrate with a new SAGE CRM solution so that members can book events, etc... (I understand that for some reason obscure to me, this client might prefer a SAGE software-based CRM solution to cloud-based one).</p>\n\n<p>One additional request is that the Sage CRM also integrates with their existing Sage Instant Accounts software.</p>\n\n<p>Is this feasible at all with a Ruby on Rails app?</p>\n\n<p>I understand the CRM Cloud provides a SOAP-based API, I assume I could access it using the ruby 'savon' gem.</p>\n\n<p>Would it be possible at all to have a Ruby on Rails app integrate with the Sage Instant Accounts software or/and a software-based SAGE solution (I would considering outsourcing these features, if this was beyond the scope of my abilities) ?</p>\n\n<p>Thanks a lot for your help (and patience)!</p>\n"},{"tags":["ruby-on-rails","thinking-sphinx"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261720,"title":"testing thinking sphinx with rspec","body":"<p>I've seen similar questions asked but nothing I've tried has resulted in a solution.  I've tried many different variations of the stop, start and index with no luck.  And I have set my config.use_transactional_fixtures to false.</p>\n\n<p>Here's my very simple model spec:</p>\n\n<pre><code>require \"spec_helper\"\n\n    describe MetaItem do\n      before do\n        @item = MetaItem.create(short_desc: \"hello there\", long_desc: \"long description\")\n        ThinkingSphinx::Test.stop\n        ThinkingSphinx::Test.start\n        ThinkingSphinx::Test.index\n      end\n\n      it \"returns all records if no search parameter is provided\" do\n        MetaItem.search.count.should == 1\n      end\n    end\n</code></pre>\n\n<p>Unfortunately, the test fails and says the count is zero no matter what I do!</p>\n\n<p>Here is the relevant part of my spec_helper.rb file:</p>\n\n<pre><code>require 'rubygems'\nrequire 'spork'\nrequire 'thinking_sphinx/test'\n#uncomment the following line to use spork with the debugger\n#require 'spork/ext/ruby-debug'\n\n    Spork.prefork do\n      `rake ts:start RAILS_ENV=test` if !ThinkingSphinx.sphinx_running?\n      ThinkingSphinx::Test.init\n      # Loading more in this block will cause your tests to run faster. However,\n      # if you change any configuration or code from libraries loaded here, you'll\n      # need to restart spork for it take effect.\n\n      # This file is copied to spec/ when you run 'rails generate rspec:install'\n      ENV[\"RAILS_ENV\"] ||= 'test'\n      require File.expand_path(\"../../config/environment\", __FILE__)\n      require 'rspec/rails'\n      require 'rspec/autorun'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13256865,"title":"How to manage multiple Subscriptions using one controller action?","body":"<p>I have following subscription creating system, right now when I`m selection available subscription groups(Marketing, Sales) action <code>Save Subscription</code> create this two subscriptions:</p>\n\n<pre><code>@apps = App.all\nif request.post?\n  if params[:subscription] and params[:subscription][:app_id]                       \n    params[:subscription][:app_id].each do |app_id|                \n      Subscription.create_unique({user_id: current_user.id, app_id: app_id, approved: true})\n    end\n    redirect_to root_path\n  end\nend\n@subscriptions = current_user.subscriptions \n</code></pre>\n\n<p>So I can only add new <code>Subscriptions</code>(in this particular example i can only add <code>Engineering</code>)</p>\n\n<p><img src=\"http://i.stack.imgur.com/5VoyD.png\" alt=\"Subscriptions\"></p>\n\n<p>How to refactor that action to be able also destroy subscription groups by uncheck them(ex. I want to unsubscribe from Marketing group) ?</p>\n\n<p>So when I choose <strong>Marketing</strong> and <strong>Enginnering</strong> then <code>params[:subscription][:app_id]</code> will be equal <code>[marketing.id, engineering.id]</code></p>\n\n<pre><code>  # app_menu.html.erb\n  &lt;%= form_for :subscription do |f| %&gt; # this form goes to app_menu action above\n    &lt;ul&gt;\n        &lt;% @apps.each do |app| %&gt;\n        &lt;li&gt;\n            &lt;%= check_box_tag app.id, current_user.access?(app) %&gt;&lt;span&gt;&lt;%= app.name %&gt;&lt;/span&gt;\n        &lt;/li&gt;\n        &lt;% end %&gt;\n    &lt;/ul&gt;\n    &lt;%= f.submit %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Relations:</p>\n\n<pre><code>App\n  has_many :subscriptions\n  has_many :users, through: :subscriptions\nUser\n  belongs_to :app\n  has_many :subscriptions, :dependent =&gt; :destroy\nSubscription\n  belongs_to :user\n  belongs_to :app\n\n  def self.create_unique(p)\n    s = Subscription.find :first, :conditions =&gt; ['user_id = ? AND app_id = ?', p[:user_id], p[:app_id]]\n    Subscription.create(p) if !s\n  end\n</code></pre>\n\n<p>Schema</p>\n\n<pre><code># == Schema Information\n#\n# Table name: subscriptions\n#\n#  admin      :boolean\n#  app_id     :integer\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  updated_at :datetime\n#  user_id    :integer\n#\n# Table name: apps\n#\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  name       :string(255)\n#  updated_at :datetime\n#  user_id    :integer\n#\n# Table name: users\n#\n#  app_id     :integer\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  updated_at :datetime\n</code></pre>\n\n<p>So the issue is how to find which apps has been unchecked? </p>\n\n<p>Then remove subscription for them and remove Feeds using <code>Feed.app_destroy_items(app)</code></p>\n"},{"tags":["ruby-on-rails","xml"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":353,"score":2,"question_id":3844359,"title":"How to keep Rails from Processing Large XML Post","body":"<p>In our rails application we have a many actions that do regular webapp actions. But, we have a single action that accepts a large XML file. I would like to keep rails from parsing the XML into params. Instead, I would like to be able to get the URL params ( /documents/{id}/action ) and then write out the xml file to a specific directory. How do I keep Rails from processing it?</p>\n\n<p>How would I define the action to handle this?</p>\n\n<pre><code>def handle_xml\n   # what to put here\nend\n</code></pre>\n\n<p>The upload is done using Content-Type: application/xml  It is a single file, and not part of a multipart form. The sample curl statement would be:</p>\n\n<pre><code>curl-H 'Accept: application/xml' -H 'Content-Type: application/xml' -X POST -d '&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;test&gt;&lt;/test&gt;' http://0.0.0.0:3000/controller/handle_xml\n</code></pre>\n"},{"tags":["ruby-on-rails","capistrano","delayed-job"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13259746,"title":"Need access to current hostname in Capistrano configuration variable for delayed_job named queue","body":"<p>I'm using named queues within delayed_job to keep tasks isolated by server:</p>\n\n<pre><code>subdomain = Socket.gethostname.split('.')[0]\nMyModel.delay(:queue =&gt; (subdomain + \"_queue\")).get_some_records\n</code></pre>\n\n<p>When I start delayed_job on each server, I need to set the <code>--queue</code> flag.  One can pass arguments to the delayed_job CL with <code>set :delayed_job_args</code>.  AFAIK, Capistrano allows for the use of the <code>$CAPISTRANO:HOST$</code> in <code>run</code> commands, but this doesn't help me with <code>set</code>.  </p>\n\n<p>As a workaround, I have overridden the delayed_jobs task like this:</p>\n\n<pre><code>desc \"Start the delayed_job process\"\n  task :start, :roles =&gt; lambda { roles } do\n  run \"cd #{current_path};#{rails_env} script/delayed_job start --queue=$CAPISTRANO:HOST$_queue #{args}\"\nend\n</code></pre>\n\n<p>Is there any way to do this as intended, using <code>set</code>?  I would like to be able to do something like this:</p>\n\n<pre><code>set :delayed_job_args, \"--queue=#{ hostname }_queue\"\n</code></pre>\n\n<p><strong>Update</strong>  </p>\n\n<p>I discovered another kludgy (and not so DRY) way to do this, but still would like to do it with <code>set</code> if possible:</p>\n\n<pre><code>desc \"Start the delayed_job process\"\ntask :start, :roles =&gt; lambda { roles } do\n  parallel do |session|\n    session.when \"server.host =~ /server1/\", \"cd #{current_path};#{rails_env} script/delayed_job start --queue=server1_queue #{args}\"\n    session.when \"server.host =~ /server2/\", \"cd #{current_path};#{rails_env} script/delayed_job start --queue=server2_queue #{args}\"\n    session.else \"cd #{current_path};#{rails_env} script/delayed_job restart #{args}\"\n  end\nend\n</code></pre>\n\n<p>Rails 3.2.8, delayed_job 3.0.3, capistrano 2.13.4.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","bundle","mysql2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4,"score":1,"question_id":13261360,"title":"Error with mysql2 gem loading Rails env on OSX: \"Symbol not found: _rb_prohibit_interrupt\"","body":"<ul>\n<li><p>I'm on OSX 10.7.5</p></li>\n<li><p>I'm setting up an existing Rails 3 app</p></li>\n<li><p>I've got the 64-bit dmg package of MySQL (v5.5.28) installed</p></li>\n<li><p>I've installed the mysql2 gem (v0.3.11) as part of the app bundle</p></li>\n</ul>\n\n<p>Whenever i try to load the rails env (raking, loading console, etc.), I get this:\nrake aborted!\ndlopen(/Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle, 9): Symbol not found: _rb_prohibit_interrupt\n  Referenced from: /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle\n  Expected in: flat namespace\n in /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle - /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle\n/Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2.rb:9:in <code>require'\n/Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2.rb:9:in</code>'</p>\n\n<p>.........</p>\n\n<p>Things I've tried:</p>\n\n<ul>\n<li><p>other versions of mysql2</p></li>\n<li><p>fresh install of mysql itself</p></li>\n<li><p>cleaning my gemset</p></li>\n<li><p>cleaning rvm</p></li>\n<li><p>pulling hair out</p></li>\n</ul>\n\n<p>Help?</p>\n"},{"tags":["ruby-on-rails","session"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":21,"score":0,"question_id":13261313,"title":"Storing user data in a session and use it later in a form (Rails)?","body":"<p>I have an <code>omniauth_create</code> action in my <strong>sessions</strong> controller. It redirects the user to a view called <strong>enter_email.html.erb</strong> and passes some <code>params</code> to the redirect (fetched from <a href=\"https://github.com/intridea/omniauth/wiki\" rel=\"nofollow\">omniauth</a>):</p>\n\n<pre><code>  def omniauth_create\n    auth = request.env[\"omniauth.auth\"]\n    user = User.from_omniauth(env[\"omniauth.auth\"])\n    .\n    .\n    .\n    else\n      redirect_to(enter_email_path(oprovider: user.provider,\n                                   ouid: user.uid,\n                                   oname: user.name,\n                                   opassword: user.password,\n                                   opassword_confirmation: user.password))\n    end\n  end\n</code></pre>\n\n<p>Where they are used in hidden fields (basically a registration form):</p>\n\n<pre><code>&lt;%= form_for(@user) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n\n      &lt;%= f.label :email %&gt;\n      &lt;%= f.text_field :email %&gt;\n\n      &lt;%= f.hidden_field :provider, value: params[:oprovider] %&gt;\n      &lt;%= f.hidden_field :provider, value: params[:oprovider] %&gt;\n      &lt;%= f.hidden_field :uid, value: params[:ouid] %&gt;\n      &lt;%= f.hidden_field :name, value: params[:oname] %&gt;\n      &lt;%= f.hidden_field :password , value: params[:opassword] %&gt;\n      &lt;%= f.hidden_field :password_confirmation, value: params[:opassword_confirmation] %&gt;\n\n      &lt;% # To know to which form to redirect in case of validation error %&gt;\n      &lt;%= hidden_field_tag 'form_name', 'enter_email' %&gt;\n\n      &lt;%= f.submit \"Create my account\", class: \"btn btn-large btn-primary\" %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Now the problem is that when there is validation error (e.g. the email had been already taken). The view renders <code>enter_email</code> and the <code>params</code> are wiped out from the hidden fields (from value).</p>\n\n<p>So I was thinking of storing the data in a <strong>session</strong> instead of passing them with <code>redirect_to</code> I have never used sessions this way, so I'm a bit lost (I'm not even sure if I still need the hidden fields if I store data in a session?)</p>\n\n<p>Can anyone give me a hint or an example?</p>\n"},{"tags":["ruby-on-rails","activerecord","has-many-through"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13259507,"title":"NameError: uninitialized constant for has_many through relationship","body":"<p>I can't seem to get this right. My has many through relationship just isn't working. Here's the setup:</p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n  belongs_to :user\n\n  has_many :groups_phone_numbers, :dependent =&gt; :destroy\n  has_many :phone_numbers, through: :groups_phone_numbers\n\n  attr_accessible :name\nend\n\nclass PhoneNumber &lt; ActiveRecord::Base\n  belongs_to :user\n  has_many :responses\n\n  has_many :groups_phone_numbers\n  has_many :groups, through: :groups_phone_numbers\n\n  attr_accessible :label, :number\nend\n\nclass GroupPhoneNumber &lt; ActiveRecord::Base\n\n  belongs_to :group\n  belongs_to :phone_number\n\nend\n</code></pre>\n\n<p>I've tried every variant of pluralization and just can't get past the unintialized error. What am I doing wrong? The table in the database (join model) is called groups_phone_numbers.</p>\n\n<p>Exact error (g is a group):</p>\n\n<pre><code>1.9.3p0 :002 &gt; p g.phone_numbers\nNameError: uninitialized constant Group::GroupsPhoneNumber\n</code></pre>\n\n<p>Migration that made the join table:</p>\n\n<pre><code>class CreateGroupPhoneNumbersJoinTable &lt; ActiveRecord::Migration\n  def change\n    create_table(:groups_phone_numbers) do |t|\n      t.references :group\n      t.references :phone_number\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","haml","markdown","jekyll"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13242686,"title":"Jekyll and Twitter Bootstrap in posts not working","body":"<p>I have a Jekyll app with twitter bootstrap in my assets folder. I called the js and css files in the layout.html as...</p>\n\n<pre><code>&lt;!DOCTYPE HTML&gt;\n\n&lt;html&gt;\n&lt;head&gt;\n\n  &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /&gt;\n  &lt;title&gt;{{ page.title }}&lt;/title&gt;\n  &lt;link href=\"assets/css/bootstrap.css\" rel=\"stylesheet\" media=\"screen\"&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n  &lt;link href=\"assets/css/bootstrap-responsive.css\" rel=\"stylesheet\"&gt;\n\n&lt;/head&gt;\n\n&lt;body&gt;\n\n &lt;header&gt;\n  &lt;h1&gt;&lt;a href=\"/\"&gt;{{ page.title }}&lt;/a&gt;&lt;/h1&gt;\n &lt;/header&gt;\n\n&lt;section&gt;\n\n  {{ content }}\n\n&lt;/section&gt;\n\n&lt;script src=\"assets/js/bootstrap.min.js\"&gt;&lt;/script&gt;  \n\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>However, they do not work when I go to a post page. I checked a post page source and saw that the two bootstrap css and js files are in the right places. My question is two fold, how do I allow Twitter bootstrap to be used within my posts? And second, how do I change my markdown which is currently <code>rdiscount</code> to html? How would I change the <code>config.yml</code> to get what I want?</p>\n"},{"tags":["ruby-on-rails","authentication","redirect","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13260676,"title":"When does Devise store the location for stored_location_for_resource","body":"<p>I was having problems redirecting to the last visited page when that page required a sign in <a href=\"http://stackoverflow.com/questions/13257269/devise-resetting-session-on-login\">Devise Resetting Session On Login</a> and somebody pointed out that you could follow the code example here: <a href=\"https://github.com/plataformatec/devise/wiki/How-To%3A-redirect-to-a-specific-page-on-successful-sign-in\" rel=\"nofollow\">https://github.com/plataformatec/devise/wiki/How-To%3A-redirect-to-a-specific-page-on-successful-sign-in</a></p>\n\n<p>That example calls <code>stored_location_for(resource)</code>...where is that set?</p>\n\n<p>That example works perfectly when used in conjunction with a <code>before_filter :authenticate_user!</code> in my appropriate controllers.  Looking at the source code for <code>authenticate_#{resource}!</code>, <a href=\"https://github.com/plataformatec/devise/blob/master/lib/devise/controllers/helpers.rb\" rel=\"nofollow\">https://github.com/plataformatec/devise/blob/master/lib/devise/controllers/helpers.rb</a> it doesn't seem to save the location.</p>\n\n<p>Where in the world is the previous location stored?</p>\n"},{"tags":["ruby-on-rails","ssl","screen-scraping","web-scraping"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":131,"score":5,"question_id":12592016,"title":"How do you scrape from a website which requires credentials (SSL)?","body":"<p>I was wondering if anyone can point me in the right direction.  I want to scrape html/text contents from an SSL enabled website (https in the URL).  There will be multiple branches in the filesystem of said site.  </p>\n\n<p>My questions is:</p>\n\n<p>How do I go about providing credentials for the external website from within my Rails application?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13215846,"title":"Is it a good practice to cache multi level foreign ids","body":"<p>Model <code>User</code> has many <code>Project</code> has many <code>Task</code></p>\n\n<pre><code>User(id, email, password)\nProject(id, user_id, name)\nTask(id, user_id, project_id, title)\n</code></pre>\n\n<p>Is it a good practice to have a <em>cache</em> column of higher parents like <code>user_id</code> on the <code>Task</code> model for faster access without making joins, or i should just stick to the good ol <code>:through</code> solution?</p>\n\n<p>Would love to hear thoughts on this because i've always been worried if this does more harm than good.</p>\n"},{"tags":["ruby-on-rails","ruby","unit-testing","testing","tdd"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13242587,"title":"Error between validate method in Model and Test:Unit assertion results","body":"<p>Ruby Noob - I've searched SO, read the <a href=\"http://guides.rubyonrails.org/testing.html\" rel=\"nofollow\">Rails Guide on Testing</a>, and watched a <a href=\"http://railscasts.com/episodes/275-how-i-test\" rel=\"nofollow\">RailsCast</a> without luck. </p>\n\n<p>I'm unable to reconcile method associations with tests I've written. Currently (code below), both tests, one checking for presence of name and one checking for presence of email, pass without failure or error -- ok, seems good. </p>\n\n<p>If I remove both validates statements from the model, both tests fail -- also, makes sense. </p>\n\n<p>However, if I remove only <strong>ONE</strong> of either </p>\n\n<pre><code>validates :name, :presence =&gt; true\n</code></pre>\n\n<p><strong>OR</strong></p>\n\n<pre><code>validates :email, :presence =&gt; true\n</code></pre>\n\n<p>from the model, <strong>BOTH</strong> tests pass without failure. This result does not make sense to me. Have I created faulty tests? </p>\n\n<hr>\n\n<p>user.rb model:      </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :email, :name \n\n  has_many :connections\n\n  validates :name, :presence =&gt; true\n  validates :email, :presence =&gt; true\nend\n</code></pre>\n\n<p>test/unit/user_test.rb</p>\n\n<pre><code>require 'test_helper'\n\nclass UserTest &lt; ActiveSupport::TestCase\n  test \"a user should have a name\" do\n    user = User.new\n    assert !user.save\n  end\n\n  test \"a user should have an email\" do\n    user = User.new\n    assert !user.save\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13259788,"title":"Creating a hierarchical, optgrouped, drop down list using Ruby on Rails","body":"<p>I am trying to create a drop down select list for a web application.\nThis list must have optgroups, must have indentation (using <code>--</code>), and the group names must be options themselves.  Since optgrouping is a requirement, I need to use one of the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html\" rel=\"nofollow\">group option helpers</a>.  Since everything is in one model, I chose <code>grouped_options_for_select</code>.</p>\n\n<p>I have a functional solution but it is messy.  Is there any way I can make this neater?  In particular, for the helper method <code>grouped_categories</code>, Is there a better way to create the nested array so that i do not need to call the database so many times?</p>\n\n<p>The View;</p>\n\n<pre><code>&lt;%= f.label :category_id %&gt;\n&lt;%= f.select :category_id, grouped_options_for_select(grouped_categories.map{ |group| [group.first.name, group.second.map{|c| [c.name, c.id]}]}) %&gt;\n</code></pre>\n\n<p>The Helper;</p>\n\n<pre><code>module CategoryHelper\n #building an array of elements (optgroup, members), where optgroup is one category object instance,\n # and members contains all category objects belonging to the optgroup, including the opt group object itself\n def grouped_categories\n   @grouped_array = []\n   Category.where(\"parent_id is null\").each do |g|\n     members = []\n     members &lt;&lt; g\n     Category.where(\"parent_id = ?\", g.id).each do |c|\n       indent_subcategory(c)\n       members &lt;&lt; c\n       Category.where(\"parent_id = ?\", c.id).each do |s|\n         indent_subsubcategory(s)\n         members &lt;&lt; s\n       end\n     end\n     group = [g, members]\n     @grouped_array &lt;&lt; group\n   end\n   @grouped_array\n end\n\n def indent_subcategory(cat)\n   cat.name = '--' + cat.name\n end\n\n  def indent_subsubcategory(cat)\n    cat.name = '----' + cat.name\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","exception-handling"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13260609,"title":"Exception Handling: \"undefined method `____' for nil:NilClass\"","body":"<p>One of the most common reasons my web application fails is because a user sometimes lacks a certain attribute that a view expects it to have. For instance, most users in my application have an education (school, degree, etc.) entry in our system, but some users do not. Assuming my view looks something like this:</p>\n\n<pre><code>&lt;% @educations.each do |education| %&gt;\n  &lt;%= education.school %&gt;\n  &lt;%= education.degree %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want to avoid \"Pokemon\" exception handling and feel that there has to be a better way around dealing with a \"undefined method `degree' for nil:NilClass\" error in the case that a user does not have an education entry in our database. This just seems like an ugly/tedious fix:</p>\n\n<pre><code>&lt;% @educations.each do |education| %&gt;\n  &lt;% if education.school %&gt;\n    &lt;%= education.school %&gt;\n  &lt;% end %&gt;\n  &lt;% if education.degree %&gt;\n   &lt;%= education.degree %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Any input is appreciated. Thank you!</p>\n"},{"tags":["ruby-on-rails","ruby","openssl","activemerchant"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13260720,"title":"openssl and ruby certificate verify failed (OpenSSL::SSL::SSLError)","body":"<p>I'm getting a certificate verify failed (OpenSSL::SSL::SSLError) error.</p>\n\n<ul>\n<li>ubuntu 12.04</li>\n<li>ruby 1.9.3</li>\n<li>openssl installed via rvm</li>\n</ul>\n\n<p>This command works ok</p>\n\n<blockquote>\n  <p>openssl s_client -CAfile ./ccapi.pem -connect ccapi.client.qvalent.com:443</p>\n</blockquote>\n\n<p>=>  <code>Verify return code: 0 (ok)</code></p>\n\n<p>Running a ruby script using activemerchant that calls out to the above site using same pem file</p>\n\n<pre><code>ruby pwtest.rb\n</code></pre>\n\n<p>=>  </p>\n\n<pre><code>credit card is valid!\n/home/rzolkos/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:799:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (OpenSSL::SSL::SSLError)\n</code></pre>\n\n<p>The script works fine on another server/local machine.</p>\n\n<p>Any tips on fixing or diagnosing appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby","devise","gem","engine"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12913737,"title":"Rails mountable engine and devise","body":"<p>I have a mountable rails engine with Devise. When I copy my migrations and run rake db:migrate in the dummy app it works just fine. </p>\n\n<p>But when I use a new rails app, add my engine to the gem file, copy migrations and run rake db:migrate I get this error <code>\"uninitialized constant Devise\".</code> </p>\n\n<p>I have this in my routes file:</p>\n\n<pre><code>mount Cms::Engine, :at =&gt; '/', :as =&gt; 'cms'\n</code></pre>\n\n<p>What am I doing wrong ? </p>\n"},{"tags":["ruby-on-rails","geolocation","elasticsearch","tire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13260560,"title":"Mapping of a geo_point field in ElasticSearch with Tire","body":"<p>I'm trying to index a geo_point field in Elasticsearch with the Tire gem. Here is my Tire mapping for my ActiveRecord model :</p>\n\n<pre><code>class Availability &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :date, :latitude, :longitude\n\n  include Tire::Model::Search\n  include Tire::Model::Callbacks\n\n  tire do\n    mapping do\n      indexes :id,                  type: 'integer',  index: 'not_analysed'\n      indexes :user_id,                 type: 'integer',  index: 'not_analysed'\n      indexes :user_firstname,      type: 'string',   as: 'user_firstname' \n      indexes :user_lastname,       type: 'string',   as: 'user_lastname' \n      indexes :user_level,          type: 'integer',  as: 'user_level' \n      indexes :date,                type: 'date'\n      indexes :location,            type: 'geo_type', as: 'location'\n    end\n  end\n\n  # def location\n  #   \"#{latitude},#{longitude}\"\n  # end\n\n  def location\n    [longitude.to_f, latitude.to_f]\n  end\n\n  def user_firstname\n    user.firstname\n  end\n\n  def user_lastname\n    user.lastname\n  end\n\n  def user_level\n    user.level\n  end\nend\n</code></pre>\n\n<p>When I create the mapping (<code>bundle exec rake environment tire:import CLASS=Availability FORCE=true</code>), Elasticsearch seems to ignore the <code>geo_point</code> type for the <code>location</code> field. </p>\n\n<p>Here is the result of the <code>http://localhost:9200/availabilities/_mapping</code> call :</p>\n\n<pre><code>{\n  availabilities: {\n    availability: {\n      properties: {\n        date: {...},\n        id: {...},\n        location: {\n          type: \"double\"\n        },\n        user_firstname: {...},\n        user_id: {...},\n        user_lastname: {...},\n        user_level: {...}\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>The location field is indexed as an array of double on the documents (results of <code>http://localhost:9200/availabilities/_search</code>) :</p>\n\n<pre><code>{\n  id: 8,\n  ...\n  location: [\n    2.301643,\n    48.780651\n  ]\n}\n</code></pre>\n\n<p>When I change the <code>location</code> method to :</p>\n\n<pre><code>  def location\n    \"#{latitude},#{longitude}\"\n  end\n</code></pre>\n\n<p>Which is another solution to index a <code>geo_point</code> field according to the documentation (http://www.elasticsearch.org/guide/reference/mapping/geo-point-type.html), the result for the location mapping is :</p>\n\n<pre><code>  location: {\n    type: \"string\"\n  },\n</code></pre>\n\n<p>And of course the location field is indexed as a string :</p>\n\n<pre><code>{\n  id: 4,\n  ...\n  location: \"48.780651,2.301643\"\n}\n</code></pre>\n\n<p>Any idea why the <code>geo_point</code> is ignored in my mapping ?</p>\n\n<p>Thanks !</p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3","jquery-ui"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13241709,"title":"jQuery-UI Autocomplete Widget not binding to ajax loaded partial form in Rails","body":"<p>I have a form with a text field that uses jQuery-UI autocomplete widget. \nI'm loading this form as a partial using AJAX with Ruby on Rails <code>&lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_activity_path(activity), :remote =&gt; true  %&gt;&lt;/li&gt;</code> </p>\n\n<p>Since the form is being loaded after document.ready, the autocomplete jQuery widget is not binding to the DOM element.</p>\n\n<p>Since this isn't a jQuery AJAX call, I don't think that there is a success callback that I can use to bind the autocomplete widget with after the Ajax call. </p>\n\n<p>I'm not sure how to use the .on() function that I've seen around with the autocomplete Widget since the syntax is $('selector').autocomplete</p>\n\n<p>Can someone please help?</p>\n\n<p>This is the edit.js.erb file:</p>\n\n<pre><code>$(\"#activity_form\").html(\"&lt;%= escape_javascript(render(:partial =&gt; \"form\"))%&gt;\");\n</code></pre>\n\n<p>This is my jQuery code to bind the autocomplete widget to my text field.</p>\n\n<pre><code>jQuery -&gt;       \n$('[type=\"text\"][name*=\"[geocode_location]\"]').autocomplete\n  source: (request, response) -&gt;\n    $.ajax \n      url: \"http://ws.geonames.org/searchJSON\"\n      dataType: \"jsonp\"\n      data: \n        featureClass: \"P\"\n        style: \"full\"\n        maxRows: 12\n        name_startsWith: request.term\n\n      success: (data) -&gt;\n        response $.map(data.geonames, (item) -&gt;\n          label: item.name + ((if item.adminName1 then \", \" + item.adminName1 else \"\")) + \", \" + item.countryName\n          value: item.lat + \", \" + item.lng\n        )\n  minLength: 2\n\n  open: -&gt;\n    $(this).removeClass(\"ui-corner-all\").addClass \"ui-corner-top\"\n\n  close: -&gt;\n    $(this).removeClass(\"ui-corner-top\").addClass \"ui-corner-all\"\n  focus: (event, ui) -&gt;\n    event.preventDefault()\n    $(this).val ui.item.label      \n  select: (event, ui) -&gt;\n    event.preventDefault()\n    $(this).val ui.item.label\n    $(this).siblings('[name*=\"[geocode_ll]\"]').val ui.item.value\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","cancan","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":337,"score":3,"question_id":8934892,"title":"Rails 3 ActiveAdmin. Hiding buttons according to CanCan permissions","body":"<p>I have ActiveAdmin and CanCan working together. I already set the administrator and customer permissions. </p>\n\n<p>Now I want to hide the New, Edit and Delete buttons according to the permissions set by CanCan but the following line gives me errors...</p>\n\n<pre><code>config.clear_action_items! :if =&gt; proc{can? (:destroy, Shipment)}\n</code></pre>\n\n<p>This one too</p>\n\n<pre><code>:if =&gt; proc{ can?(:destroy, Shipment)}, actions :all, :except =&gt; [:new, :create, :update, :edit, :destroy]\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","console"],"answer_count":6,"favorite_count":12,"up_vote_count":23,"down_vote_count":0,"view_count":2751,"score":23,"question_id":4736546,"title":"Rails 3 OSX - Speed up Console Loading Time","body":"<p>I am wondering if there is any relatively easy way to speed up my console load time, which is starting to approach 30 seconds.  I have a lot of subclasses whose methods don't seem to be affected by <code>reload!</code> so I end up opening and closing the console a lot.  IRB loads lightning quick.  </p>\n\n<p>Do I have too many gems?  How do I go about timing the load tasks so I can see what is taking up the most time?  As you can see, I've already tried the dev-boost gem to no avail.  The app is fine in Passenger, it's just the console loading that bugs the crap out of me.  Running on MBP OSX 10.6.6 with 2.4GHz and 4GB RAM.  Not using RVM. </p>\n\n<p>Versions:</p>\n\n<pre><code>Ovid$ rails -v\nRails 3.0.3\nOvid$ ruby -v\nruby 1.9.2p136 (2010-12-25 revision 30365) [x86_64-darwin10]\n</code></pre>\n\n<p>Memory:</p>\n\n<pre><code>Ovid$ vm_stat\nMach Virtual Memory Statistics: (page size of 4096 bytes)\nPages free:                         118818.\nPages active:                       341320.\nPages inactive:                      99490.\nPages speculative:                  310576.\nPages wired down:                   112527.\n\"Translation faults\":             23097323.\nPages copy-on-write:               1270961.\nPages zero filled:                13836659.\nPages reactivated:                      36.\nPageins:                            165761.\nPageouts:                                0.\nObject cache: 28 hits of 760846 lookups (0% hit rate)\n</code></pre>\n\n<p>Gemfile:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.3'\ngem 'mysql2'\ngem 'foreigner'\ngem 'haml'\ngem 'capistrano'\ngem 'nokogiri'\n\n#web services\ngem 'yammer4r'\ngem 'ruby-freshbooks'\n\n#authentication gems from nifty generator\ngem \"bcrypt-ruby\", :require =&gt; \"bcrypt\"\ngem \"mocha\", :group =&gt; :test\ngem 'authlogic'\n\n#dev\ngroup :development do\n  gem 'rails-dev-boost', :git =&gt; 'git://github.com/thedarkone/rails-dev-boost.git', :require =&gt; 'rails_development_boost'\nend\n\n#testing\ngroup :test do\n  gem 'database_cleaner'\n  gem 'cucumber-rails'\n  gem 'cucumber'\n  gem 'rspec-rails'\n  gem 'spork'\n  gem 'launchy'\n  gem 'machinist'\n  gem 'faker'\n  gem 'capybara'\nend\n</code></pre>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby","rbenv"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13259461,"title":"ruby / rails `rescue in debug=': (RuntimeError)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8251349/ruby-threadptr-data-type-error\">ruby_threadptr_data_type error</a>  </p>\n</blockquote>\n\n\n\n<p>I am new to Ruby / Rails, and having issues getting my environment setup on Ubuntu 12.04. I'm using rbenv (not rvm). Here is how i'm installing ruby:</p>\n\n<pre><code># clone rbenv and the ruby-build plugin\ngit clone git://github.com/sstephenson/rbenv.git .rbenv\ngit clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build\n\n# initialize rbenv\nexport PATH=~/.rbenv/bin:$PATH\nrbenv init -\n\n# install ruby 1.9.2\nrbenv install 1.9.2-p320\nrbenv rehash\n\n# change ruby version to 1.9.2\nrbenv global 1.9.2-p320\n</code></pre>\n\n<p>I am trying to run the following hello-world app:\n  <a href=\"https://github.com/renderedtext/base-app\" rel=\"nofollow\">https://github.com/renderedtext/base-app</a></p>\n\n<p>I am running the commands recommended on the website</p>\n\n<pre><code>bundle install\nbundle exec rake db:setup db:test:prepare\nbundle exec rake spec\nbundle exec rake cucumber\n</code></pre>\n\n<p>It fails at <code>bundle exec rake spec</code> with the following error:</p>\n\n<pre><code>NOTICE:  CREATE TABLE will create implicit sequence \"roles_id_seq\" for serial column \"roles.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"roles_pkey\" for table \"roles\"\nNOTICE:  CREATE TABLE will create implicit sequence \"users_id_seq\" for serial column \"users.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"users_pkey\" for table \"users\"\n/home/ubuntu/.rbenv/versions/1.9.2-p320/bin/ruby -S rspec ./spec/models/role_spec.rb ./spec/models/user_spec.rb ./spec/controllers/admin/base_controller_spec.rb ./spec/controllers/admin/users_controller_spec.rb ./spec/controllers/pages_controller_spec.rb ./spec/helpers/pages_helper_spec.rb\nNo DRb server is running. Running in local process instead ...\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:422:in `rescue in debug=':  (RuntimeError)\n**************************************************\n/var/lib/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.so: undefined symbol: ruby_threadptr_data_type - /var/lib/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.so\n\nIf you have it installed as a ruby gem, then you need to either require\n'rubygems' or configure the RUBYOPT environment variable with the value\n'rubygems'.\n\n/var/lib/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby-debug-base.rb:1:in `require'\n/var/lib/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby-debug-base.rb:1:in `&lt;top (required)&gt;'\n/var/lib/gems/1.9.1/gems/ruby-debug19-0.11.6/cli/ruby-debug.rb:5:in `require'\n/var/lib/gems/1.9.1/gems/ruby-debug19-0.11.6/cli/ruby-debug.rb:5:in `&lt;top (required)&gt;'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:408:in `require'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:408:in `debug='\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:20:in `block in configure'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:19:in `each'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:19:in `configure'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:21:in `run'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:66:in `rescue in run'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:62:in `run'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:10:in `block in autorun'\n**************************************************\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:407:in `debug='\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:20:in `block in configure'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:19:in `each'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:19:in `configure'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:21:in `run'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:66:in `rescue in run'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:62:in `run'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:10:in `block in autorun'\nrake aborted!\n/home/ubuntu/.rbenv/versions/1.9.2-p320/bin/ruby -S rspec ./spec/models/role_spec.rb ./spec/models/user_spec.rb ./spec/controllers/admin/base_controller_spec.rb ./spec/controllers/admin/users_controller_spec.rb ./spec/controllers/pages_controller_spec.rb ./spec/helpers/pages_helper_spec.rb failed\n\nTasks: TOP =&gt; spec\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>It is also important to note that the server seems to already have ruby 1.9.1 installed (presumably using apt-get) but I would like to use 1.9.2 which is why I installed rbenv.</p>\n\n<p>As a side note, I've also tried using rbenv with 1.9.3 and get the same error.</p>\n\n<p>I tried to research and apply answers from other stack overflow questions (like <a href=\"http://stackoverflow.com/questions/8251349/ruby-threadptr-data-type-error\">ruby_threadptr_data_type error</a>) but resulted in a segfault. Also, in my research most of the answers seemed to relate to rvm and 1.9.3 ... not rbenv and 1.9.2</p>\n\n<p>Please help!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations","model-associations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13256607,"title":"What is wrong with my association?","body":"<p>I am looking to setup a relationship where a user can create a post and tag that post. That post and those tags belong to that user. </p>\n\n<p>I've been trying to debug this for the last three days. I don't know why when I save my Post, the user_id does not populate in the Tag model. I added the user_id into the Tag model. </p>\n\n<p>I apologize in advance for the excessive code.</p>\n\n<p>User - has_many posts; has_many tags</p>\n\n<p>Post - belongs_to user; has_many taggings; has_many tags through taggings</p>\n\n<p>Tag - has many taggings; has_many posts through taggings; belongs_to user</p>\n\n<p>Tagging - belongs_to post; belongs_to tag</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121031012555) do\n\n  create_table \"posts\", :force =&gt; true do |t|\n    t.integer  \"user_id\"\n    t.string   \"summary\"\n    t.datetime \"created_at\",  :null =&gt; false\n    t.datetime \"updated_at\",  :null =&gt; false\n  end\n\n  create_table \"taggings\", :force =&gt; true do |t|\n    t.integer  \"post_id\"\n    t.integer  \"tag_id\"\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  add_index \"taggings\", [\"post_id\"], :name =&gt; \"index_taggings_on_post_id\"\n  add_index \"taggings\", [\"tag_id\"], :name =&gt; \"index_taggings_on_tag_id\"\n\n  create_table \"tags\", :force =&gt; true do |t|\n    t.string   \"name\"\n    t.integer  \"user_id\"\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  create_table \"users\", :force =&gt; true do |t|\n    t.string   \"username\"\n    t.string   \"email\"\n    t.string   \"crypted_password\"\n    t.string   \"password_salt\"\n    t.string   \"persistence_token\"\n    t.datetime \"created_at\",        :null =&gt; false\n    t.datetime \"updated_at\",        :null =&gt; false\n    t.string   \"role\"\n  end\n\nend\n</code></pre>\n\n<p>In the post Model:</p>\n\n<pre><code>def tag_ids=(tags_string)\n    self.taggings.destroy_all\n\n    tag_names = tags_string.split(\",\").collect{|s| s.strip.downcase}.uniq\n    tag_names.each do |tag_name|\n      tag = Tag.find_or_create_by_name(tag_name)\n      tagging = self.taggings.new\n      tagging.tag_id = tag.id\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","crm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":27,"score":-6,"question_id":13260379,"title":"Simply Ruby On Rails crm","body":"<p>I would try to develop a simple crm in ruby on rails, is for learn the language, and to understand its potential. I know other programming languages ​​such as Java, C + +, js, html ... I tried looking at the source code of open source projects like fat free crm and I did not understand .. The crm is a simple form that requires data (curriculum vitae) and I view people in list .. or find it by a search module .. How should I start? Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","gem","jekyll"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13259568,"title":"Heroku push rejected, failed to complie Ruby/Rack app with Jekyll","body":"<p>I have a Jekyll website I created that I want to deploy to Heroku. However, it's not working for me. The terminal responded with</p>\n\n<pre><code>   Running: bundle install --without development:test --path vendor/bundle --binstubs  \n   bin/ --deployment\n   Could not find posix-spawn-0.3.6 in any of the sources\n\n   Failed to install gems via Bundler.\n\n   Heroku push rejected, failed to compile Ruby/rack app\n</code></pre>\n\n<p>My gemfile looks like this...</p>\n\n<pre><code>gem 'rack-jekyll', :git =&gt; 'https://github.com/adaoraul/rack-jekyll.git', :require =&gt; \n'rack/jekyll'\n</code></pre>\n\n<p>And my config.ru looks like...</p>\n\n<pre><code>require 'bundler'\nBundler.require(:default, :production)\n\nrun Rack::Jekyll.new\n</code></pre>\n\n<p>My question is, how do I fix this? I've already tried <code>bundle install</code> and <code>bundle update</code> in my project directory.</p>\n"},{"tags":["ruby-on-rails","activerecord","spree"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13258472,"title":"Find Record based on the associated attributes","body":"<p>I am trying to find a record based on two associated attributes. The Record should be selected, if its association contains those two records.</p>\n\n<p>So far, I tried following - Which seemed to me a very bad practice and I want to avoid using it.</p>\n\n<pre><code>@size = Spree::OptionValue.find(params[:size])\n@color = Spree::OptionValue.find(params[:color])\n\nvari = Spree::Variant.all\nvari.each do |va|\n  if va.option_values.include?(@size &amp;&amp; @color)\n    @variant = va\n  end\nend\n</code></pre>\n\n<p>So far, I also tried   </p>\n\n<pre><code>@variant = Spree::Variant.all(:include =&gt; :option_values, :conditions =&gt; ['option_value.id = ?', params[:color])\n</code></pre>\n\n<p>This seems to be the way to go, but I can't seem to figure out the right way to get the result.\nThe return error I keep on getting is following:</p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid: PG::Error: ERROR:  missing FROM-clause entry for table \"option_values\"\n  LINE 1: ..._option_values_variants\".\"option_value_id\" WHERE (option_val...</p>\n</blockquote>\n\n<p>EDIT:</p>\n\n<p>I got it working due to the great help given in the accepted answer:</p>\n\n<pre><code>Spree::Variant.joins(:option_values).where(\"spree_option_values.id in (?)\", [size, color])\n</code></pre>\n"},{"tags":["ruby-on-rails","spring","java-ee","web-applications","mobile"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":16,"score":-2,"question_id":13260251,"title":"Java (Spring MVC) vs Ruby on Rails","body":"<p>Please advice me on what would be a better option for developing a web/mobile application. What are the pros and cons of using Java (Spring/Hibernate) or Ruby on Rails for a web/mobile application ?? Also is there any way of merging both and creating a more reliable/scalable solution. I am also open to other suggestions.</p>\n\n<p>PS : I have got a sound experience developing web applications using Java/J2EE but I am ready to change if it is better.</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13257263,"title":"Why does a call to Model.create!() return when the mysql transaction hasn't completed?","body":"<p>I watched a video where their signup page was causing issues because the call to:</p>\n\n<pre><code>person = Person.create!(params)\n</code></pre>\n\n<p>returns when in fact mysql hasn't necessarily completed the transaction yet.</p>\n\n<p>Why would it return before the transaction?  </p>\n\n<p>video: <a href=\"http://cdn.confreaks.com/system/assets/datas/5097/original/1119-gogaruco2012-services-scale-backgrounding-and-wtf-is-going-on-here-small.mp4?1349207263\" rel=\"nofollow\">http://cdn.confreaks.com/system/assets/datas/5097/original/1119-gogaruco2012-services-scale-backgrounding-and-wtf-is-going-on-here-small.mp4?1349207263</a></p>\n"},{"tags":["ruby-on-rails","rspec","refactoring","tdd","bdd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13259078,"title":"Rspec mocking for testing queries of an associated record","body":"<p>I have the following model:</p>\n\n<pre><code>class Kueue &lt; ActiveRecord::Base\n    attr_accessible :name, :user_id\n\n    belongs_to :user\n    has_and_belongs_to_many :photos\n\n    scope :empty, includes(:photos).where{ photos.id.eq(nil) }\n    scope :with_photos, includes(:photos).where{ photos.id.not_eq(nil) }\nend\n</code></pre>\n\n<p>I want to write specs for the scopes, to make sure they're reliably working. My problem is how to deal with the <code>Photo</code> model. Photos have a lot of validations on them, for instance they must belong_to a <code>User</code>. So, I can write a working spec for these queries like so:</p>\n\n<pre><code>describe \"queries\" do\n    before :each do\n        @empty = Fabricate(:kueue)\n        @full = Kueue.new :name =&gt; \"Full Queue\"\n        @full.photos &lt;&lt; Fabricate(:photo)\n        @full.save\n    end\n\n    it \"should find empty queues\" do\n        Kueue.empty.should_not include(@full)\n    end\n\n    it \"should find queues with photos\" do\n        Kueue.with_photos.should_not include(@empty)\n    end\nend\n</code></pre>\n\n<p>However, as you can imagine this is <em>sloooow</em>. This makes a bunch of calls to the database. (1) to make two kueues, (2) to make a photo, (3) to make a user who owns the photo... and so on, down the line.</p>\n\n<p>This seems like a simple enough problem, all I need is one join record between a photo and a kueue and I can test this really fast. So how would you go about mocking this interaction so you can test it faster and in better isolation?</p>\n\n<p>PS: I'm using Rails 3.2.8, <a href=\"https://github.com/ernie/squeel\" rel=\"nofollow\">Squeel</a> (hence the query syntax) and my model is called Kueue because Queue is a reserved word in Rails :)</p>\n"},{"tags":["ruby-on-rails","plugins","devise","gem","generate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":10907633,"title":"Ruby on Rails generators with new gemified plugin?","body":"<p>I'm attempting to create a new Rails 3 plugin gem which wraps around devise/devise_ldap_authenticatable for reusable drop in internal LDAP support.</p>\n\n<p>I create the new plugin gem with:</p>\n\n<pre><code>rails plugin new &lt;gem_name&gt;\n</code></pre>\n\n<p>I then add the devise/devise_ldap_authenticatable gems to the .gemspec file and run <code>bundle</code></p>\n\n<p>In the devise instructions it says to generate the required files using its generators:</p>\n\n<pre><code>rails generate devise:install \nrails generate devise MODEL\n</code></pre>\n\n<p>However, in the directory where the plugin is generated I don't seem to be able to run <code>rails generate</code>.  Most gem plugin tutorials instruct you to just create the files manually.  Am I better off starting a new rails project, following the instructions in the temp project, then copying the files over to the plugin manually?  Is there something that I'm missing?  Can I run the generator script from the dummy instance?  What is the standard practice in this use case?</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13258689,"title":"Define a '<<' method for an attribute on an ActiveRecord object","body":"<p>I've got an active record object that has custom accessors for storing arrays as comma separated text.</p>\n\n<pre><code>class Thing &lt; ActiveRecord::Base\n  attr_accessible :object_list\n\n  def objects\n    self.object_list.split(\",\") rescue []\n  end\n\n  def objects=(input)\n   self.object_list = input.join(',')\n  end\nend\n</code></pre>\n\n<p>I'd like to add the following</p>\n\n<pre><code>def objects&lt;&lt;(input)\n  unless self.object_list == nil\n    self.object_list &lt;&lt; \",#{input}\"\n  else\n    self.object_list = \"#{input}\"\n  end\nend\n</code></pre>\n\n<p>So that I can do things like</p>\n\n<pre><code>thing.objects &lt;&lt; 'this'\n</code></pre>\n\n<p>Is that possible?</p>\n"},{"tags":["ruby-on-rails","ruby","httparty","rest-client","faraday"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13258068,"title":"work around Ruby's broken URI.parse, follow redirects","body":"<p>I am using Ruby to scrape webpages that sometimes return redirects which I want to follow.\nThere is many Ruby gems that do that, but there is a problem:</p>\n\n<p>Ruby's <code>URI.parse</code> explodes on some URIs that are technically invalid but work in browsers like <code>\"http://www.google.com/?q=&lt;&gt;\"</code></p>\n\n<pre><code>URI.parse(\"http://www.google.com/?q=&lt;&gt;\")               #=&gt; error\n\nrequire 'addressable/uri'\nAddressable::URI.parse(\"http://www.google.com/?q=&lt;&gt;\")  #=&gt; works\n</code></pre>\n\n<p>All the HTTP client libraries I have tried (HttParty, Faraday, RestClient) break when they encounter such a URI in a redirect (this is on ruby 1.9.3)</p>\n\n<h3>rest-client:</h3>\n\n<pre><code>require 'rest-client'\nRestClient.get(\"http://bitly.com/ReeuYv\") #=&gt; explodes\n</code></pre>\n\n<h3>faraday:</h3>\n\n<pre><code>require 'faraday'\nrequire 'faraday_middleware'\nFaraday.use(FaradayMiddleware::FollowRedirects)\nFaraday.get(\"http://bitly.com/ReeuYv\")    #=&gt; explodes\n</code></pre>\n\n<h3>httparty:</h3>\n\n<pre><code>require 'httparty'\nHTTParty.get(\"http://bitly.com/ReeuYv\")   # =&gt; explodes\n</code></pre>\n\n<h3>open-uri:</h3>\n\n<pre><code>require 'open-uri'\nopen(\"http://bitly.com/ReeuYv\")           # =&gt; explodes\n</code></pre>\n\n<p>What can I do to make this work?</p>\n"},{"tags":["ruby-on-rails","backbone.js"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13220950,"title":"Backbone.js understanding: fetch and display with templating","body":"<p>I've read many tutorials and made a search on the .net... but still I'm in trouble with Backbone.js. This is my simple scenario:</p>\n\n<p>A Rails application responds to a GET request with a JSON collection of objects.\nI want to dynamically build a list of table-rows with Backbone collections, when DOM is ready. This is the code is confusing me:</p>\n\n<p><strong>HTML part:</strong>\n    \n    </p>\n\n<pre><code>  &lt;script type=\"text/template\" id=\"tmplt-Page\"&gt;\n      &lt;td&gt;{{=title}}&lt;/td&gt;\n      &lt;td&gt;{{=description}}&lt;/td&gt;\n  &lt;/script&gt;\n</code></pre>\n\n<p><strong>Backbone's script:</strong></p>\n\n<pre><code>$(function(){\n    var Page = Backbone.Model.extend({});\n\n    var Pages = Backbone.Collection.extend({\n        model: Page,\n        url: '/pages'\n    });\n    var pages = new Pages([\n        {title: 'ProvA1', description: ''},\n        {title: 'ProvA2', description: ''}\n    ]);\n\n    var PageView = Backbone.View.extend({\n        tagName: 'tr',\n        template: _.template($('#tmplt-Page').html()),\n\n        render: function() {\n            this.$el.append(this.template(this.model.toJSON()));\n            return this;\n        }\n\n    });\n\n    var AppView = Backbone.View.extend({\n        el: $(\"#results\"),\n\n        initialize: function () {\n            _.bindAll(this, 'render');\n            pages.on('reset', this.render)\n        },\n\n        render: function() {\n            this.$el.empty();\n            pages.each( function( page ) {\n\n                var view = new PageView({\n                  model : page\n                });\n\n                this.$el.append(view.render().el);\n\n            });\n\n            return this;\n        }\n\n    });\n\n    var appview = new AppView;\n\n});\n</code></pre>\n\n<p>Nothing renders on the screen.</p>\n\n<p>There seem to be 2 problems:</p>\n\n<p>1) fetch() is asynchronous, so the code is executed before the end of the ajax round-trip.</p>\n\n<p>2) If I manually load some objects into the collection, this piece of code \"this.template(this.model.toJSON())\" does not substitute jSON attributes</p>\n\n<p>EDIT : </p>\n\n<p>To use mustache tags I wrote this code before all:</p>\n\n<p><img src=\"http://i.stack.imgur.com/JVRYP.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails","dry"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13258260,"title":"Rails - Avoid Repetition in Tables","body":"<p>I have a table of data in which I go through each user attribute, and display it in a table. This seems like a lot of repetition, even though the words are not the same, the process for each attribute is. Is there a way to automatically make a table row with a header of <code>attribute.titleize</code> and a data cell of <code>user.attribute</code>?</p>\n\n<pre><code>%table\n  %tr\n    %th First Name\n    %td= @user.first_name\n  %tr\n    %th Middle Name\n    %td= @user.middle_name\n  %tr\n    %th Last Name\n    %td= @user.last_name\n</code></pre>\n"},{"tags":["ruby-on-rails","git","nginx","web-deployment","thin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12799272,"title":"Straight-forward Rails deployment","body":"<p>I am new to ruby and I want to learn more about how it works. So I have been testing a server configuration in a virtual machine to make quick Rails deployments.</p>\n\n<p>I have RVM, Ruby, Rails, Git, Gitolite, PostgreSQL, Thin and Nginx running in an Ubuntu 10.04 environment.</p>\n\n<p>Now I want to tie everything together. I got stuck, though, in the deployment process.</p>\n\n<p>After I commit the project to the Git trunk, I want to hook a deployment action to put the application in the correct place, set to production, install the bundles, make the migrations and restart Nginx.</p>\n\n<p>But I fail to find simple references on how it works. All I find in google are guides to use passenger, capistrano and others. I want to trigger the deployment on the git commit action, similar to heroku, but what would be the best tools to do that 100% server-side?</p>\n\n<p>What about making some shell scripts? How do I deploy a project manually? What are the steps? Are there any guides out there that do not assume I know every details in Rails deployment?</p>\n\n<p>Thanks!</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","layout","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13257084,"title":"Categorize webpages for layout and CSS purposes in Rails","body":"<p>I have a lot of different webpages, but most fall into 1 of 6 or 7 categories of pages. For each of these categories of webpages, I have a slightly different look and feel, like different background colors/images. I have the following in <code>views/layout/application.html.erb</code>:</p>\n\n<pre><code>&lt;header class=\"sub&lt;% if content_for?(:page_type) %&gt; &lt;%= yield(:page_type) %&gt;&lt;% end %&gt;\"&gt;\n</code></pre>\n\n<p>And in every single view, I have:</p>\n\n<pre><code>&lt;% content_for :page_type, 'information' %&gt;\n</code></pre>\n\n<p>But it's really a pain to do that for every single webpage and when I want to change things around I keep having to mess with these (I have a ton of pages). So, instead I'm thinking to just use a variable:</p>\n\n<pre><code>&lt;header class=\"sub&lt;%= @page_type ? ' ' + @page_type : '' %&gt;\"&gt;\n</code></pre>\n\n<p>and for views:</p>\n\n<pre><code>&lt;% @page_type = 'information' %&gt;\n</code></pre>\n\n<p>The advantage is I could do a <code>before_filter :set_page_type</code> in the controller and set the page type once for all the views it controls (a big help).</p>\n\n<p>Maybe the best thing for me to do is just use the first folder of the URL as the category of the webpage. I'll have to restructure the URLs, but that might make sense to do so anyway. I do have some top-level pages that would have to remain so.</p>\n\n<p>This has to be a fairly common situation, what is the best way to categorize most pages and use that categorization in layouts?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","wordpress"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":13114081,"title":"Searching WordPress blog from Rails app","body":"<p>I have a site-wide custom written search controller for my Rails 3 app and would like to include results from the site's WordPress blog. What is the best way for me to perform a keyword search on posts from within my Rails app?</p>\n"},{"tags":["ruby-on-rails","ruby","forms","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":203,"score":1,"question_id":11349508,"title":"Rails Simpleform with non-model inputs","body":"<p>I have a normal form using simpleform. Now I'd like to add an input that does not have any corresponding field in the model, it will be processed by the controller. I tried</p>\n\n<pre><code>&lt;%= simple_form_for @obj do |f| %&gt;\n  &lt;%= f.input :name %&gt;\n  &lt;%= f.input :attr, as: :string %&gt;   &lt;-- should just send \"attr\" as post data\n&lt;% end %&gt;\n</code></pre>\n\n<p>but this gives a <code>Method not found: attr_not_in_obj</code> error. I could obviously use the standard rails helpers, but then I will miss all of the simpleform HTML around the input, and copying doesn't quite seem right.</p>\n\n<p>In short:\nI'm looking for something like simpleform version of rails tag helpers, without any connection to a model. How do I add inputs that do not correspond to model attributes? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","seeding"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3040,"score":4,"question_id":3476987,"title":"appending to rake db:seed in rails and running it without duplicating data","body":"<p>Rake db:seed populates your db with default database values for an app right? So what if you already have a seed and you need to add to it(you add a new feature that requires the seed). In my experience, when I ran rake db:seed again, it added the existing content already so existing content became double.</p>\n\n<p>What I need is to add some seeds and when ran, it should just add the newest ones, and ignore the existing seeds. How do I go about with this? (the dirty, noob way I usually do it is to truncate my whole db then run seed again, but that's not very smart to do in production, right?)</p>\n"},{"tags":["ruby-on-rails","validation","phone-number","form-fields"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13258179,"title":"What's the best way to do form field validations for phone numbers in Rails view without using a model?","body":"<p>I have the following form field in my index.html.erb view:</p>\n\n<pre><code> &lt;%= form_tag(\"/calls/call\", :method =&gt; \"post\") do %&gt;\n  &lt;br /&gt;\n  &lt;%= text_field_tag(:call_to, \"Number to call\") %&gt;\n  &lt;br /&gt;\n  &lt;%= text_field_tag(:call_from, \"Number to call from\") %&gt;\n  &lt;br /&gt;\n  &lt;%= submit_tag(\"Dial\") %&gt;&lt;/a&gt;\n  &lt;br /&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want to constrain the field to allow only 10 digit US phone numbers without using a model validation (as there is no model).</p>\n\n<p>There's probably a lot of ways to do this, but what do you folks find to be the simplest to implement?</p>\n\n<p>I've tried using the 'active_attr' gem, but didn't have much luck. With 'active_attr' I created a model called Call. Here's what the model looks like:</p>\n\n<pre><code>class Call\n\ninclude ActiveAttr::Model\n\n  attribute :call_to\n  attribute :call_from\n\n  # attr_accessible :call_to, :call_from\n\n  validates_presence_of :call_to\n  validates_presence_of :call_from\nend\n</code></pre>\n\n<p>My controller looks like this:</p>\n\n<pre><code>class CallsController &lt; ApplicationController\n\n  def call\n\n    call_to = params[\"call_to\"]\n\n    call_from = params[\"call_from\"]\n\n    call_to.to_i\n    call_from.to_i\n\n    puts call_to\n    puts call_from\n\n  end \n\nend\n</code></pre>\n\n<p>Am I supposed to instantiate an instance of a Call class in the controller or something along those lines?</p>\n\n<pre><code>@call = Call.new\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","rubinius"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13259291,"title":"How to Upgrade Ruby 1.8.7 to 1.9.2 in Rubinius","body":"<p>When I compile \"ruby -v\" command it returns, </p>\n\n<pre><code>rubinius 2.0.0dev (1.8.7 78652b58 yyyy-mm-dd JI) [x86_64-apple-darwin11.4.2]\n</code></pre>\n\n<p>How should I upgrade ruby 1.8.7 to 1.9.2 ?\nShould I remove rubinius ?</p>\n\n<p>Thanks,</p>\n"},{"tags":["ruby-on-rails","ruby","jenkins","jenkins-plugins","engineyard"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":151,"score":0,"question_id":10986411,"title":"Jenkins Deployment to Staging","body":"<p>I'm trying to find a way for Jenkins to deploy to my staging server on Engine Yard when all all tests have passed? Are there any plugin for this post-build action from Jenkins?</p>\n"},{"tags":["ruby-on-rails","operating-system"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":2046109,"title":"selecting operating system to serve rails app","body":"<p>Vps hosting provides choice of operating system:</p>\n\n<ul>\n<li>Cent OS 5</li>\n<li>Debian 4.0</li>\n<li>Fedora 10</li>\n<li>Gentoo</li>\n<li>Opensuse 10</li>\n<li>Ubuntu 8.10</li>\n<li>Ubuntu 8.04</li>\n<li>Ubuntu 9.04</li>\n</ul>\n\n<p>Which pros and cons for running rails app, software installing, overall feel, etc. do they have, or maybe there are others which are much better to serve rails</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13258203,"title":"delayed_job pid file location","body":"<p>Does anyone know how to configure delayed_jobs to place the pid file in another folder?  I see the pid_dir as an option, but not sure how to include the option in an initializer or within the script/delayed_job.</p>\n"},{"tags":["ruby-on-rails","activerecord","timezone"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1557,"score":1,"question_id":3247261,"title":"Rails/Activerecord database field timezone","body":"<p>I have a database that is written to by a non-rails application and read from by a rails application. There is a datetime field in the database and the data stored in this field is stored in Eastern Time. In my rails app, I understand I can set the application's timezone in my environment.rb file by doing <code>config.time_zone = 'Eastern Time (US &amp; Canada)'</code>. However, rails assumes the data stored in the database is stored in UTC and converts from config.time_zone to UTC as it pulls information in and out of the database. </p>\n\n<p>Is there a way to tell rails the data in this particular field, or even all my datetime fields, is Eastern Time and not UTC?</p>\n"},{"tags":["ruby-on-rails","paperclip","elasticsearch","tire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13242904,"title":"Paperclip isn't saving file in time","body":"<p>I dont know what I did or what's changed because this was working before.</p>\n\n<p>I have a Model <code>Entry</code> and I use Paperclip to attach a file <code>document</code> to it. Now, for some weird reason I keep getting a </p>\n\n<pre><code>Errno::ENOENT in EntriesController#create\nNo such file or directory - /var/www/capsf-web/public/assets/entries/test.pdf\n</code></pre>\n\n<p>I'm guessing that before Paperclip has saved the file to the directory I'm already trying to encode the file. Here's what <code>Entry</code> looks like. I'm using ElasticSearch's attachment mapper which is why I Encode it.</p>\n\n<pre><code>class Entry &lt; ActiveRecord::Base\n  include Tire::Model::Search\n  include Tire::Model::Callbacks\n\n  has_and_belongs_to_many :categories\n  has_and_belongs_to_many :subcategories\n  belongs_to :entry_type\n  has_attached_file :document,\n                    :url  =&gt; \"/assets/entries/:basename.:extension\",\n                    :path =&gt; \":rails_root/public/assets/entries/:basename.:extension\"\n\n  before_post_process :image?\n\n  validates_presence_of :entry_type\n\n  attr_accessible :description, :title, :url, :category_ids, :subcategory_ids, :entry_type_id, :document\n\n  mapping do\n    indexes :title\n    indexes :description\n    indexes :categories do\n      indexes :name\n    end\n    indexes :subcategories do\n      indexes :name\n    end\n    indexes :entry_type\n    indexes :document, :type =&gt; 'attachment'\n  end\n\n  def to_indexed_json\n   #to_json( methods: [:category_name, :subcategory_name, :entry_type_name])\n    {\n    :title          =&gt; title,\n    :description    =&gt; description,\n    :categories     =&gt; categories.map { |c| { :name =&gt; c.name}},\n    :subcategories  =&gt; subcategories.map { |s| { :name =&gt; s.name}},\n    :entry_type     =&gt; entry_type_name,\n    :document       =&gt; attachment\n    }.to_json\n  end\n  def image?\n    !(document_content_type =~ /^image.*/).nil?\n  end\n\n  def attachment\n    if document.present?\n      path_to_document = Rails.public_path+\"/assets/entries/#{document_file_name}\"\n      Base64.encode64(open(path_to_document) { |pdf| pdf.read})\n#If I comment out the line above everything works just fine.\n\n    end\n  end\n\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","best-in-place"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":497,"score":6,"question_id":9619902,"title":"Inline editing with Rails gem 'best_in_place' - bug: new lines are lost after edit on textarea ","body":"<p>I am using <a href=\"https://github.com/bernat/best_in_place#readme\" rel=\"nofollow\">best_in_place</a> gem to do some inline editing in a Rails app.</p>\n\n<p>One of the property of my object is of type <code>text</code>, and I want it to be edited in a text area, so I did this:</p>\n\n<pre><code>&lt;%= best_in_place @myobject, :description, :type =&gt; :textarea %&gt;\n</code></pre>\n\n<p>It works, but when not being edited, all returns (\\n) are removed.</p>\n\n<p>I tried using simple_format, by adding <code>:display_with =&gt; :simple_format</code> to the options passed to best_in_place:</p>\n\n<pre><code>&lt;%= best_in_place @myobject, :description, :type =&gt; :textarea, :display_with =&gt; :simple_format %&gt;\n</code></pre>\n\n<p>When not being edited, the new lines are displayed as expected. But the click to enter edition is broken, and a new dash is added above. Clicking it display a textarea box, but it is empty, and the text entered there is not saved back to my object.</p>\n\n<p>The content saved in my property is just plain text, it does not contain any html.</p>\n\n<hr>\n\n<p>This issue (and patch) seemed related to my problem: <a href=\"https://github.com/bernat/best_in_place/pull/111\" rel=\"nofollow\">https://github.com/bernat/best_in_place/pull/111</a><br>\nHowever, when applying the patch (manually, to the file <code>.../gems/best_in_place-1.0.6/spec/spec_helper.rb</code>), I still have the same problem.</p>\n"},{"tags":["ruby-on-rails","ruby","phantomjs"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13197747,"title":"PhantomJS version 1.4.0 version issue","body":"<p>I installed PhantomJS today and got this error trying to use it:</p>\n\n<pre><code>PhantomJS version 1.4.0\nis too old. You must use at least version 1.7.0  \n(Capybara::Poltergeist::PhantomJSTooOld)\n</code></pre>\n\n<p>How can I install the newer version?</p>\n\n<p>I can <em>get</em> the newer version (1.7) at: <a href=\"http://phantomjs.org/download.html\" rel=\"nofollow\">http://phantomjs.org/download.html</a></p>\n\n<p>Once I've downloaded it though how do I actually install it?</p>\n"},{"tags":["ruby-on-rails","rubygems"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2148,"score":1,"question_id":9500487,"title":"Could not find RubyGem railties","body":"<p>I try to create new app with \"rails new\" command however getting this error:</p>\n\n<pre><code>'report_activate_error': Could not find RubyGem railties (&gt;= 0) (Gem::LoadError)\n from /usr/lib/ruby/vendor_ruby/1.8/rubygems.rb:244:in 'activate_dep'\n from /usr/lib/ruby/vendor_ruby/1.8/rubygems.rb:236:in `activate'\n from /usr/lib/ruby/vendor_ruby/1.8/rubygems.rb:1307:in `gem'\n from /usr/local/bin/rails:18\n</code></pre>\n\n<p>Any idea why?</p>\n\n<p>by the way I am working on Ubuntu</p>\n\n<pre><code>gem list\n\n*** LOCAL GEMS ***\n</code></pre>\n\n<p>it is empty but I installed rails just before</p>\n"},{"tags":["ruby-on-rails","metaprogramming"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13258849,"title":"Using class_eval in Rails producing inconsistent results","body":"<p>I have this in a Rails engine under Rails 2.3</p>\n\n<pre><code>class Ns::FooController &lt; Ns::ApplicationController\n   Foo.class_eval do\n      def bar\n        \"BAR CALLED\"\n      end\n   end\n\n   def show\n      @thing = Thing.find params[:id]\n      @thing.foos.each do |foo|\n        logger.debug \"FOO: #{foo.bar}\"\n      end\n   end\nend\n</code></pre>\n\n<p>After a restart of the server and initial refresh of the page each call to foo.bar prints out \"BAR CALLED\" as I expect. \nBut on subsequent reloads of the page foo.bar results in </p>\n\n<pre><code>undefined method `bar' for #&lt;Foo:0x7f6c74a4efd8&gt;\n</code></pre>\n\n<p>Can someone help me understand why this happens and how to fix it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.1","formatting","textarea","newline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13254909,"title":"Rails 3: Why does an indent appear when repopulating text_areas with line breaks?","body":"<p>I'm trying to program some forms that include <code>text_area</code> tags in Rails 3.1.3. Generally these text areas are filled with more than one paragraph (i.e. they include line breaks). If I save the text and display it with <code>simple_format</code>, the paragraphs display correctly, but if I repopulate the same form for editing, the format seems to add an indent after every line break. So, for example, if I input the following into the text area of the form:</p>\n\n<pre><code>Item 1\nItem 2\nItem 3\n</code></pre>\n\n<p>And I save it, the next time I load the form to edit the data, the text_area is populated with the following:</p>\n\n<pre><code>Item 1\n    Item 2\n    Item 3\n</code></pre>\n\n<p>Does anyone know why this happens and how to fix it? The segment of the form view that displays this follows:</p>\n\n<pre><code>    &lt;fieldset&gt;\n        &lt;section class=\"field\"&gt;\n            &lt;%= f.label \"Títulos, seminarios, cursos\" %&gt;\n            &lt;%= f.text_area :titles_seminars_courses %&gt;\n        &lt;/section&gt;\n        ...\n    &lt;/fieldset&gt;\n</code></pre>\n\n<p>I'm not doing anything special when saving to the database (no gsub or anything), just directly saving the <code>'Item 1\\r\\nItem 2\\r\\nItem 3\\r\\n'</code> string. I'm using the same form for the initial creation and edition of this data.</p>\n\n<p>Thank you in advance for any help with this issue.</p>\n\n<p>EDIT 1:</p>\n\n<p>The view that displays the data correctly is the following (but it's not in a text_area):</p>\n\n<pre><code>&lt;section class=\"titles_seminars_courses\"&gt;\n    &lt;%= simple_format(@academic_background.titles_seminars_courses, :class =&gt; \"other_study\") %&gt;\n&lt;/section&gt;\n</code></pre>\n\n<p>EDIT 2:</p>\n\n<pre><code>&lt;textarea cols=\"40\" id=\"academic_background_titles_seminars_courses\" name=\"academic_background[titles_seminars_courses]\" rows=\"20\"&gt;Item 1\n        Item 2\n        Item 3&lt;/textarea&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13258051,"title":"update a has_one relation model","body":"<p>I have two models</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :user_information, :dependent =&gt; :destroy\n  attr_accessible :email, :name\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>class UserInformation &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :address, :business, :phone, :user_id\nend\n</code></pre>\n\n<p>after created the user,  I created the user information using the new and the create action of my controller:</p>\n\n<pre><code>  def new\n         @user = User.find(params[:id])\n         @user_information = @user.build_user_information\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @user_information }\n    end\n  end\n\n\n\ndef create\n    @user_information = UserInformation.new(params[:user_information])\n\n    respond_to do |format|\n      if @user_information.save\n        format.html { redirect_to @user_information, notice: 'User information was successfully created.' }\n        format.json { render json: @user_information, status: :created, location: @user_information }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @user_information.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>everything works fine, but when I try to update the record I get this error:</p>\n\n<pre><code>RuntimeError in User_informations#edit\n\nCalled id for nil, which would mistakenly be 4 -- if you really wanted the id of nil, use object_id\n</code></pre>\n\n<p>Here are the edit and the update action of my user_information controller</p>\n\n<pre><code>    def edit\n        @user_information = UserInformation.find(params[:id])\n      end \n\n  def update\n    @user_information = UserInformation.find(params[:id])\n\n    respond_to do |format|\n      if @user_information.update_attributes(params[:user_information])\n        format.html { redirect_to @user_information, notice: 'User information was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @user_information.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>I thought I only have to find the record and edit, but no. Can anyone help me please?</p>\n"},{"tags":["ruby-on-rails","datamapper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13258547,"title":"Rails Object Unique Creation","body":"<p>I am looking to create a model in based on the process of revisioning. The structure is as follows:</p>\n\n<pre><code>class file\n  include DataMapper::Resource\n\n  property :file_id, Integer, :key =&gt; true\n  property :id, Integer, :key =&gt; true\n  property :rev, Integer, :key =&gt; true, :index =&gt; true\n\n  ....\nend\n</code></pre>\n\n<p>What I am looking to do is make the rev the unique identifier for the partiular file I rev. However I would like the file_id to act as the overall unique identifier, returning all revisions of the file. Does DataMapper include a resource to automatically handle this or is it left to the programmer to identify the current rev, and make sure file_ids don't overlap. </p>\n"},{"tags":["ruby-on-rails","selenium","capybara","selenium-webdriver"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13258407,"title":"Selenium Web Driver Error","body":"<p>I'm getting a weird error while trying to click on a Capybara Element </p>\n\n<ul>\n<li>I'm using find(:xpath,\"//a[contains(text(),'Connect')]\").click</li>\n<li>(find(:xpath,\"//a[contains(text(),'Connect')]\").present? return true)</li>\n</ul>\n\n<p>the error I get is:</p>\n\n<p>Selenium::WebDriver::Error::MoveTargetOutOfBoundsError Exception: Element cannot be scrolled into view:javascript:void(0);</p>\n\n<p>i did some research and the only solution i found is that setting the selenium version to 2.16 may fix this issue (i'm using 2.25).</p>\n\n<p>anybody got an idea?</p>\n"},{"tags":["ruby-on-rails","amazon-s3","paperclip"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":177,"score":0,"question_id":11760597,"title":"S3 / Paperclip working on Heroku but not Localhost","body":"<p>Paperclip works perfectly for my app on Heroku, but I can't seem to get it working locally. Every time I try to do something I get an \"missing required :bucket option\" ... but the bucket is there and it works on Heroku!</p>\n\n<p>Here's my model if it helps:</p>\n\n<pre><code>  has_attached_file :screen_one, :styles =&gt; { :medium =&gt; \"800x600&gt;\", :thumb =&gt; \"110x80#\" },\n  :storage =&gt; :s3,\n  :s3_credentials =&gt; {\n    :access_key_id =&gt; ENV['accesskeyishere'],\n    :bucket =&gt; ENV['sitebuilderreport'],\n    :secret_access_key =&gt; ENV['secretaccesskeyishere']\n  }\n</code></pre>\n\n<p>I've changed the access keys since this is a public post :)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13258050,"title":"Saving URL string column in psql database is causing Rails 3.2 to hang","body":"<p>Trying to save an image url for example</p>\n\n<pre><code>http://ecx.images-amazon.com/images/I/51d2Qu4RGFL._BO2,204,203,200_PIsitb-sticker-arrow-click,TopRight,35,-76_AA300_SH20_OU01_.jpg\n</code></pre>\n\n<p>My Migration:</p>\n\n<pre><code>t.string   \"promo_url\"\n</code></pre>\n\n<p>My Form:</p>\n\n<pre><code>&lt;i class=\"icon-link\"&gt;&lt;/i&gt;&lt;%= f.text_field :promo_url, autocomplete: \"off\", placeholder: \"Image URL\" %&gt;\n</code></pre>\n\n<p>hangs inexplicably and silently at Event#Create:</p>\n\n<pre><code>@event.save\n</code></pre>\n\n<p>Trace:</p>\n\n<pre><code>Request\nUser Load (0.6ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 12 ORDER BY name LIMIT 1\nEvent Load (0.4ms)  SELECT \"events\".* FROM \"events\" WHERE \"events\".\"id\" = $1 LIMIT 1  [[\"id\", \"64\"]]\n(0.1ms)  BEGIN\n</code></pre>\n\n<p>Thanks for any help -- I've never seen rails server hang like this before.</p>\n"}]}
{"total":93230,"page":6,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby"],"answer_count":9,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1097,"score":2,"question_id":502671,"title":"How to find a record created on the previous month?","body":"<p>I have a table where new records are added daily. How would I go about finding records created in the previous month?</p>\n"},{"tags":["ruby-on-rails","heroku","amazon-s3","carrierwave","fog"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1746,"score":2,"question_id":9452241,"title":"Carrierwave uploading with s3 and fog","body":"<p>been trying to search the reason for this error for a long time and can't seem to find any...</p>\n\n<p>So I have a rails app, and I utilize carrierwave for pictures uploading. I also want to utilize Amazon S3 for file upload storage in my app.</p>\n\n<p>Initially as I am developing the app I allowed file uploads to be on the on :file, i.e.</p>\n\n<p>image_uploader.rb</p>\n\n<pre><code># Choose what kind of storage to use for this uploader:\n  storage :file\n# storage :fog\n</code></pre>\n\n<p>Now upon finishing up development and placing it live (I use heroku), I decided to change the carrierwave storage to S3 to test it locally.</p>\n\n<p>image_uploader.rb</p>\n\n<pre><code># Choose what kind of storage to use for this uploader:\n# storage :file\nstorage :fog\n</code></pre>\n\n<p>However, now when I try to upload a picture (be it for user avatar, etc) I get this error:</p>\n\n<pre><code>Excon::Errors::Forbidden in UsersController#update\nExpected(200) &lt;=&gt; Actual(403 Forbidden)\nrequest =&gt; {:connect_timeout=&gt;60, :headers=&gt;{\"Content-Length\"=&gt;74577, \"x-amz-   acl\"=&gt;\"private\", \"Content-Type\"=&gt;\"image/png\", \"Date\"=&gt;\"Sun, 26 Feb 2012 10:00:43 +0000\",  \"Authorization\"=&gt;\"AWS AKIAJOCDPFOU7UTT4HOQ:8ZnOy7X71nQAM87yraSI24Y5bSw=\", \"Host\"=&gt;\"s3.amazonaws.com:443\"}, :instrumentor_name=&gt;\"excon\", :mock=&gt;false, :read_timeout=&gt;60, :retry_limit=&gt;4, :ssl_verify_peer=&gt;true, :write_timeout=&gt;60, :host=&gt;\"s3.amazonaws.com\", :path=&gt;\"/uploads//uploads%2Fuser%2Favatar%2F1%2Fjeffportraitmedium.png\", :port=&gt;\"443\", :query=&gt;nil, :scheme=&gt;\"https\", :body=&gt;\"\\x89PNG\\r\\n\\x1A\\n\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x00\\xC2\\x00\\x00\\x00\\xC3\\b\\x06\\x00\\x00\\x00\\xD0\\xBD\\xCE\\x94\\x00\\x00\\nCiCCPICC Profile\\x00\\x00x\\x01\\x9D\\x96wTSY\\x13\\xC0\\xEF{/\\xBD\\xD0\\x12B\\x91\\x12z\\rMJ\\x00\\x91\\x12z\\x91^E%$\\\n...\n# The code you see above to the far right repeats itself a LOT\n...\n1@\\x85\\xB5\\t\\xFC_y~\\xA6=:\\xB2\\xD0^\\xBB~i\\xBB\\x82\\x8F\\x9B\\xAF\\xE7\\x04m\\xB2i\\xFF\\x17O\\x94S\\xF7l\\x87\\xA8&amp;\\x00\\x00\\x00\\x00IEND\\xAEB`\\x82\", :expects=&gt;200, :idempotent=&gt;true, :method=&gt;\"PUT\"}\nresponse =&gt; #&lt;Excon::Response:0x007fc88ca9f3d8 @body=\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n&lt;Error&gt;&lt;Code&gt;AccessDenied&lt;/Code&gt;&lt;Message&gt;Access Denied&lt;/Message&gt;&lt;RequestId&gt;8EFA56C0DDDC8878&lt;/RequestId&gt;&lt;HostId&gt;1OxWXppSSUq1MFjQwvnFptuCM3gKOuKdlQQyVSEgvzzv4Aj+r2hSFM2UUw2NYyrR&lt;/HostId&gt;&lt;/Error&gt;\", @headers={\"x-amz-request-id\"=&gt;\"8EFA56C0DDDC8878\", \"x-amz-id-2\"=&gt;\"1OxWXppSSUq1MFjQwvnFptuCM3gKOuKdlQQyVSEgvzzv4Aj+r2hSFM2UUw2NYyrR\", \"Content-Type\"=&gt;\"application/xml\", \"Transfer-Encoding\"=&gt;\"chunked\", \"Date\"=&gt;\"Sun, 26 Feb 2012 10:00:47 GMT\", \"Connection\"=&gt;\"close\", \"Server\"=&gt;\"AmazonS3\"}, @status=403&gt;\n</code></pre>\n\n<p>And then it says this as well for my application trace:</p>\n\n<pre><code>app/controllers/users_controller.rb:39:in `update'\n</code></pre>\n\n<p>And my REQUEST parameters:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n\"_method\"=&gt;\"put\",\n\"authenticity_token\"=&gt;\"DvADD1vYpCLcghq+EIOwVSjsfmAWCHhtA3VI5VGD/q8=\",\n\"user\"=&gt;{\"avatar\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x007fc88cde76f8     \n@original_filename=\"JeffPortraitMedium.png\",\n@content_type=\"image/png\",\n@headers=\"Content-Disposition: form-data; name=\\\"user[avatar]\\\";   \nfilename=\\\"JeffPortraitMedium.png\\\"\\r\\nContent-Type: image/png\\r\\n\",\n@tempfile=#&lt;File:/var/folders/vg/98nv58ss4v7gcbf8px_8dyqc0000gq/T/RackMultipart20120226- 19096-1ppu2sr&gt;&gt;,\n\"remote_avatar_url\"=&gt;\"\",\n\"name\"=&gt;\"Jeff Lam \",\n\"email\"=&gt;\"email@gmail.com\",\n\"user_bio\"=&gt;\"Tester Hello\",\n\"shop\"=&gt;\"1\"},\n\"commit\"=&gt;\"Update Changes\",\n\"id\"=&gt;\"1\"}\n</code></pre>\n\n<p>Here's my users_controller.rb partial code:</p>\n\n<pre><code>def update\n    @user = User.find(params[:id])\n    if @user.update_attributes(params[:user]) \n        redirect_back_or root_path\n        flash[:success] = \"Your have updated your settings successfully.\"\n    else\n        flash.now[:error] = \"Sorry! We are unable to update your settings. Please check your fields and try again.\"\n        render 'edit'\n    end\nend\n</code></pre>\n\n<p>My image_uploader.rb code</p>\n\n<pre><code># encoding: utf-8\nclass ImageUploader &lt; CarrierWave::Uploader::Base\n\n  # Include RMagick or MiniMagick support:\n  # include CarrierWave::RMagick\n  include CarrierWave::MiniMagick\n\n  # Choose what kind of storage to use for this uploader:\n  # storage :file\n  storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\n  # def default_url\n  #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n  # end\n\n  # Process files as they are uploaded:\n  # process :scale =&gt; [200, 300]\n  #\n  # def scale(width, height)\n  #   # do something\n  # end\n\n  # Create different versions of your uploaded files:\n  version :thumb do\n    process resize_to_fill: [360, 250]\n  end\n\n  version :cover_photo_thumb do\n    process resize_to_fill: [1170, 400]\n  end\n\n  version :event do\n    process resize_to_fill: [550, 382]\n  end\n\n  version :product do\n    process resize_to_fit: [226, 316]\n  end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n\n  # Override the filename of the uploaded files:\n  # Avoid using model.id or version_name here, see uploader/store.rb for details.\n  # def filename\n  #   \"something.jpg\" if original_filename\n  # end \n\n  # fix for Heroku, unfortunately, it disables caching, \n  # see: https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Make-Carrierwave-work-on-Heroku\n  def cache_dir\n    \"#{Rails.root}/tmp/uploads\"\n  end\n\nend\n</code></pre>\n\n<p>Finally, my fog.rb file in the config/initializers</p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',       # required\n    :aws_access_key_id      =&gt; 'ACCESS_KEY',       # required\n    :aws_secret_access_key  =&gt; 'SECRET_ACCESS_KEY/ZN5SkOUtOEHd61/Cglq9',       # required\n    :region                 =&gt; 'Singapore'  # optional, defaults to 'us-east-1' \n  }\n  config.fog_directory  = 'ruuva/'                     # required\n  config.fog_public     = false                          # optional, defaults to true\nend\n</code></pre>\n\n<p>I'm actually quite confused on some of the things in my fog.rb. Firstly, should I change my region to Singapore if I created a bucket called \"ruuva\", with region \"Singapore\" on my amazon s3 account?</p>\n\n<p>Thank you to anyone that can help in advance! </p>\n"},{"tags":["ruby-on-rails","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13232639,"title":"How to check for dynamic mongoid attribute in embedded model","body":"<p>I need a clean way to check for the existence of a dynamic attribute on an embedded Mongoid model instance.</p>\n\n<p>This works for a top level model;</p>\n\n<pre><code>account.attributes.member?(\"coordinates\")\n</code></pre>\n\n<p>But my coordinates are stored in an embedded model, locations.  The following throws an undefined method error;</p>\n\n<pre><code>account.locations.attributes.member?(\"coordinates\") \n</code></pre>\n\n<p>Anyone know a way to do this? </p>\n"},{"tags":["ruby-on-rails","garbage-collection","tuning","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":292,"score":1,"question_id":7771294,"title":"max-requests-per-worker in unicorn","body":"<p>I sought, but did not find, a max-requests-per-worker option in unicorn similar to gunicorn's max_requests or apache's MaxRequestsPerChild.</p>\n\n<p>Does it exist?</p>\n\n<p>If not, has anyone implemented it?</p>\n\n<p>I'm thinking of putting it in the file where I have oobgc, since that gets control after every requests anyway. Does that sound about right?</p>\n\n<p>The problem is that my unicorn workers are getting big and fat, and garbage collection is taking more and more of my CPU.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","mass-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13257596,"title":"Rails 3.2 strict mass assignment defaults","body":"<p>In a new rails project what is the reason mass assignment is not set to strict in production and the reason that it is set to strict in development and test?</p>\n"},{"tags":["ruby-on-rails","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13257185,"title":"How can I include and use a proc from another file?","body":"<p>I am using rails_admin and the options of how to configure models with rails_admin seems to be having one rails_admin.rb config file (but this file would be huge and I'd have to restart the server after each change):</p>\n\n<pre><code>RailsAdmin.config do |config|\n   config.model ModelName do\n       ..\n</code></pre>\n\n<p>or including a config block within each model:</p>\n\n<pre><code> class ModelName\n     rails_admin do\n         ..\n</code></pre>\n\n<p>But I'd rather not have the config block within the model because these blocks are getting really long.</p>\n\n<p>So I initially tried creating mixins from each config block for a model:</p>\n\n<pre><code>  module ModelNameAdmin\n      rails_admin do\n          ...\n</code></pre>\n\n<p>That didn't work because it didn't recognize rails_admin.  </p>\n\n<p>Doing this didn't work either:</p>\n\n<pre><code> module ModelNameAdmin\n     RailsAdmin.config do |config|\n         config.model ModelName do\n</code></pre>\n\n<p>But this didn't work because apparently the RailsAdmin config can't be called more than once.</p>\n\n<p>So now would I'd like to do is just have a lib file with a Proc defined, that I could include and use in each model.  So like:</p>\n\n<pre><code>  model ModelName\n       require('./lib/model_name_admin')\n\n       rails_admin do\n            @model_name_admin\n       end\n</code></pre>\n\n<p>And in the ./lib/model_name_admin file have:</p>\n\n<pre><code>  @model_name_admin = Proc.new\n       rails_admin do\n           ..\n</code></pre>\n\n<p>But this doesn't work.  I don't think I'm using the proc correctly.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13257344,"title":"Can you have a time without a date in rails?","body":"<p>I am trying to import some data in from a flat file and am getting some odd results. When importing a time that is unattached to a date, why do I get a date inserted into this time as well?</p>\n\n<pre><code>1.9.3-p286 :008 &gt; v.arrival_time = Time.parse(\"10:10\")\n =&gt; 2012-11-06 10:10:00 -0400\n</code></pre>\n\n<p>I'm guessing that there is only a way to keep the date by itself, but no way to keep the time by itself despite the active record column-type :time. Is there a way to keep them separate such as:</p>\n\n<pre><code>1.9.3-p286 :002 &gt; Date.parse(\"JAN 01 2000\")\n =&gt; Sat, 01 Jan 2000 \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","cron","whenever"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":687,"score":2,"question_id":7548730,"title":"Cron job not working in Whenever gem","body":"<p>I have an application that contains a bunch of tasks, and every day I want to run a cron job that creates a DayTask for each Task in the database. A Task has_many DayTasks and these daytasks are what users will be checking off every day. I'm using the whenever gem but it doesn't seem to be running at all. Any ideas?</p>\n\n<p>config/schedule.rb</p>\n\n<pre><code>every 1.day, :at =&gt; \"12:01am\" do\n  runner \"Task.generate_tasks_for_day\"  \nend\n</code></pre>\n\n<p>Task.rb</p>\n\n<pre><code>  def generate_tasks_for_day\n    Task.all.each do |task|\n      task.day_tasks.create(:target_date =&gt; Date.today)\n    end \n  end \n</code></pre>\n\n<p>result of running the 'whenever command'</p>\n\n<pre><code>1 0 * * * /bin/bash -l -c 'cd /home/grant/rails_projects/GoalTwist &amp;&amp; script/rails runner -e production '\\''Task.generate_tasks_for_day'\\'''\n</code></pre>\n\n<p>Note: I've been changing the times in config/schedule.rb every time I want to test run it.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email","actionmailer","multipart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13256593,"title":"How to see the multipart/alternative email in Rails?","body":"<p>When sending a multipart/alternative email, the body is empty:</p>\n\n<pre><code>m = send_mail\n=&gt; &lt;Mail::Message:70121014358060, Multipart: true, Headers: &lt;Date: Tue, 06 Nov 2012 09:18:06\n-0800&gt;, &lt;From: foo@example.com&gt;, &lt;To: bar@example.com&gt;, \n&lt;Message-ID: &lt;5099464e821ef_71113fc654c35xe065537@Air.local.mail&gt;&gt;, &lt;Subject: \nTest&gt;, &lt;Mime-Version: 1.0&gt;, &lt;Content-Type: \nmultipart/alternative; boundary=\"--==_mimepart_5099422e825b0_71113fc654c34ce068277\";\ncharset=UTF-8&gt;, &lt;Content-Transfer-Encoding: 7bit&gt;&gt;\n\nm.body\n=&gt;\n</code></pre>\n\n<p>How to inspect the body or the different parts?</p>\n\n<p>Rails 3.2.2</p>\n"},{"tags":["ruby-on-rails","postgresql","mechanize"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13254667,"title":"rails mechanize run through each url in a postgres table","body":"<p>*Edit:\nPer my comment below, I guess a better question would be, 'What would the proper way be to have mechanize go through each url and update its name column? (each name would be unique to the url)' Below is what I've been basing my exercise on. *</p>\n\n<hr>\n\n<p>I have a postgres table that goes like...\n| name (string) | url (text) |</p>\n\n<p>The url column is already populated with various url's and appears like this one:\n<a href=\"http://www.a4apps.com/Websites/SampleCalendar/tabid/89/ctl/Register/Default.aspx\" rel=\"nofollow\">http://www.a4apps.com/Websites/SampleCalendar/tabid/89/ctl/Register/Default.aspx</a></p>\n\n<p>I am trying to run a mechanize rake task that will run through each url and update the name based on the text it finds at a css tag. </p>\n\n<pre><code>namespace :db do\n  desc \"Fetch css from db urls\"\n  task :fetch_css =&gt; :environment do\n\n    require 'rubygems'\n    require 'mechanize'\n    require 'open-uri'\n\n    agent = Mechanize.new\n    url = Mytable.pluck(:url)\n    agent.get(url)\n    agent.page.search('#dnn_ctr444_ContentPane').each do |item|\n      name = item.css('.EventNextPrev:nth-child(1) a').text\n      Mytable.update(:name =&gt; name)\n    end \n  end\nend\n</code></pre>\n\n<p>When I run the rake task it returns:</p>\n\n<pre><code>rake aborted!\nbad URI(is not URI?): %255B%2522http://www.a4apps.com/Websites/SampleCalendar/tabid/89/Default.aspx%2522,%2520%2522http://www.a4apps.com/Websites/SampleCalendar/tabid/89/ctl/Privacy/Default.aspx%2522,%2520%2522http://www.a4apps.com/Websites/SampleCalendar/tabid/89/ctl/Terms/Default.aspx%2522,%2520%2522http://www.a4apps.com/Websites/SampleCalendar/tabid/89/ctl/Register/Default.aspx%2522%255D\n</code></pre>\n\n<p>Thanks for any help. If there's any way I can make the question easier to answer, please let me know.\nMike</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","gem","database-connection"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":123,"score":1,"question_id":10352638,"title":"Rails gem uses the development db instead of the testing one when executing \"rake test\"","body":"<p>I'm using a gem with my rails 3 project, \"rails-settings-cached\", and when I'm in development mode the gem can access the database without any problem.\nHowever, when I run \"rake test\", a lot of tests fails because \"rails-settings-cached\" keeps using the development db instead of the testing one.</p>\n\n<p>The other parts of my application works fine. What should I do to connect the gem to the right database?</p>\n\n<pre><code>development:\n  adapter: mysql2\n  encoding: utf8\n  reconnect: false\n  database: mmdb_development\n  pool: 5\n  username: ***\n  password: ***\n  socket: /var/run/mysqld/mysqld.sock\n\ntest:\n  adapter: mysql2\n  encoding: utf8\n  reconnect: false\n  database: mmdb_test\n  pool: 5\n  username: ***\n  password: ***\n  socket: /var/run/mysqld/mysqld.sock\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-2","activeresource"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13164293,"title":"Rails 2.X equivalent of ActiveResource::Base#schema=","body":"<p>Is there any to mimic the Rails 3 function of  <code>ActiveResource::Base</code>  <code>schema=</code> in Rails 2?</p>\n\n<p>I subclassed <code>ActiveResource::Base</code>, and I want to treat certain attributes as \"known\" fields, which will not raise NameErrors when called.</p>\n"},{"tags":["ruby-on-rails","facebook","facebook-graph-api"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13255039,"title":"Need help displaying users' profile pics without saving them","body":"<p>My app uses omniaauth and the omniauth-facebook gem to connect with facebook.  I can pull down all the data I need, but I'm having trouble rendering the profile picture.  </p>\n\n<p>I want to show the user's profile pic by using the URL for the pic, instead of saving it to disk. </p>\n\n<p>I've tried this: </p>\n\n<pre><code>&lt;%= image_tag \"#{@user.facebook.info.image}\" %&gt;\n</code></pre>\n\n<p>As well as this: </p>\n\n<pre><code>&lt;img src=\"http://graph.facebook.com/&lt;UID&gt;?fields=picture\" &gt; \n</code></pre>\n\n<p>But neither have worked.</p>\n\n<p>I haven't found anything in the facebook documentation that would prohibit me from using the URL instead of saving to disk.  Am I missing something?</p>\n"},{"tags":["ruby-on-rails","session","cookies"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13257493,"title":"Path specific cookies in Rails app","body":"<p>I'm working on a minisite generator managed in one app.</p>\n\n<p>Each minisite would have its own authentication.</p>\n\n<p>With subdomains, I'm able to be specifically logged in and have settings for only one minisite but not another.</p>\n\n<p>Now, I would like to have a failover where each minisite is accessible without setting up subdomains : <code>http://mygenerator/minisites/1123</code></p>\n\n<p>Is it possible for cookies to be scoped at the <code>minisite/</code> path level ?</p>\n\n<p>Or, is there a way to dynamically tweak the cookie key in a <code>before_filter</code> at the controller level ?</p>\n\n<p>I took a look at the <code>:path</code> option in <code>session_store</code> config, but I don't think it's relevant, and it screws up Devise in a redirection loop.</p>\n\n<p>Thanks !</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13257174,"title":"Nested Resource - Controller to filter by current_user also","body":"<p>Thanks to some help in another question, I now have a nested resource setup, and it is nearly working the way I need it to.  This is a follow-up question about the controller.</p>\n\n<p>Expenses have both a user, and a project that they belong to.</p>\n\n<p>I would like to visit /projects/5/expenses, and see a list of all the expenses for that project, (which IS working), but also have it sensitive to the user that is currently signed in, so they only see their own expenses.</p>\n\n<p>first the models:</p>\n\n<pre><code>class Expense &lt; ActiveRecord::Base\n  attr_accessible :amount, :project_id, :user_id\n\n  belongs_to :project\n  belongs_to :user\n\nend\n</code></pre>\n\n<p>each of the other models has \"has_many :expenses\", to complete the relationship.</p>\n\n<p>so my route looks like:</p>\n\n<pre><code>  resources :projects do\n    resources :expenses\n  end\n</code></pre>\n\n<p>And</p>\n\n<pre><code>class ExpensesController &lt; ApplicationController\n\n    def index\n      @user = current_user  \n      @project = Project.find(params[:project_id])\n      @expense_list = @project.expenses.all  \nend\n</code></pre>\n\n<p>How can I filter my @expense_list further by only showing the current_user's expenses?  </p>\n"},{"tags":["ruby-on-rails","mocking","mocha","stubbing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":207,"score":1,"question_id":7093486,"title":"How do I stub away send_file using mocha","body":"<p>The most direct attempt is to do</p>\n\n<pre><code>@controller.stubs(:send_file)\n</code></pre>\n\n<p>But that results in an output error like</p>\n\n<pre><code>ActionView::MissingTemplate: Missing template ...\n</code></pre>\n\n<p>So how do I stub away the <a href=\"http://apidock.com/rails/v2.3.8/ActionController/Streaming/send_file\" rel=\"nofollow\"><code>send_file</code> method from 2.3.x series</a>.</p>\n\n<p>The question is basically the same question that was asked on <a href=\"http://www.ruby-forum.com/topic/179408\" rel=\"nofollow\">ruby-forum february 2009</a>, which was never really answered.</p>\n\n<p>Jarl</p>\n"},{"tags":["ruby-on-rails","session","login","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13257269,"title":"Devise Resetting Session On Login","body":"<p>I've got the following defined in my <code>application_controller.rb</code> file: </p>\n\n<pre><code>def redirect_back_or(default)\n  redirect_to(session[:return_to] || default)\n  session.delete(:return_to)\nend\n\ndef store_location\n  session[:return_to] = request.url\nend\n\ndef after_sign_in_path_for(resource)\n  r = session[:return_to] || user_root_url\n  session.delete(:return_to)\n  r\nend\n</code></pre>\n\n<p>I'm trying to send a user back to the place they came from before the sign_in, or, if no location is saved, send them to their root page.</p>\n\n<p>I call this in one of my controllers:</p>\n\n<pre><code>if current_user.nil?\n  store_location\n  redirect_to home_login_url, alert: \"You must be logged in to purchase subscriptions\"\n  return\nend\n</code></pre>\n\n<p>I stepped through the debugger and watched the <code>session[:return_to]</code> get set, but after I log on and the <code>after_sign_in_path_for(resource)</code> is called, <code>session[:return_to]</code> is null. </p>\n\n<p>How can I persist the <code>return_to</code> variable across a login?</p>\n\n<p>I'm running Rails 3.2.1 and Devise 2.1.2</p>\n"},{"tags":["ruby-on-rails","ruby","serialization","marshalling","deep-copy"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":1118,"score":3,"question_id":5643432,"title":"What's the most efficient way to deep copy an object in Ruby?","body":"<p>I know that serializing an object is (to my knowledge) the only way to effectively deep-copy an object (as long as it isn't stateful like <code>IO</code> and whatnot), but is one way particularly more efficient than another?</p>\n\n<p>For example, since I'm using Rails, I could always use <code>ActiveSupport::JSON</code>, <code>to_xml</code> - and from what I can tell marshalling the object is one of the most accepted ways to do this.  I'd expect that marshalling is probably the most efficient of these since it's a Ruby internal, but am I missing anything?</p>\n\n<p><strong>Edit</strong>: note that its implementation is something I already have covered - I don't want to replace existing shallow copy methods (like <code>dup</code> and <code>clone</code>), so I'll just end up likely adding <code>Object::deep_copy</code>, the result of which being whichever of the above methods (or any suggestions you have :) that has the least overhead.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13256445,"title":"Devise set different root path per user type","body":"<p>I've created a devise user model. There are 2 types of user:</p>\n\n<ul>\n<li>customer</li>\n<li>admin</li>\n</ul>\n\n<p>I've accomplished bij creating two 'normal' models: customer and admin. These two models are inheriting from the user model, like so:</p>\n\n<pre><code>class Customer &lt; User\n</code></pre>\n\n<p>Does anyone know how I can setup a root path per type of user. I want something like this:</p>\n\n<pre><code>authenticated :customer do\n  root :to =&gt; \"customer/dashboard#index\"\nend\n\nauthenticated :admin do\n  root :to =&gt; \"admin/dashboard#index\"\nend    \n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I've solved the problem:</p>\n\n<pre><code>root :to =&gt; \"pages#home\", :constraints =&gt; lambda { |request|!request.env['warden'].user}\nroot :to =&gt; 'customer/dashboard#index', :constraints =&gt; lambda { |request| request.env['warden'].user.type == 'customer' }\nroot :to =&gt; 'admin/dashboard#index', :constraints =&gt; lambda { |request| request.env['warden'].user.type == 'admin' }\n</code></pre>\n"},{"tags":["ruby-on-rails","variables","syntax"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":45,"score":0,"question_id":11979012,"title":"Rails: syntax for variables in identifiers","body":"<p>Anyone know what the syntax is for using variables in identifiers? i.e.:</p>\n\n<pre><code>for a in @issue.articles \n  f.select \"article#{a.page}\", options_from_collection_for_select(@articles, 'id', 'name', @issue.article2)\nend\n</code></pre>\n\n<p>Where the <code>2</code> in <code>@issue.article2</code> could be an iterator in a <code>for</code> loop.</p>\n\n<p>Cheers!</p>\n"},{"tags":["ruby-on-rails","testing","ruby-on-rails-3","amazon-s3","shoulda"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1737,"score":5,"question_id":3657972,"title":"NameError: uninitialized constant Test::Unit::AssertionFailedError when upgrading to rails3","body":"<p>I'm trying to upgrade my rails application to Rails3.</p>\n\n<p>When I run functional tests, I get a lot of <code>NameError: uninitialized constant Test::Unit::AssertionFailedError</code> errors. But unit tests and website itself seems to work fine.</p>\n\n<p>Trace looks like this:</p>\n\n<pre><code>NameError: uninitialized constant Test::Unit::AssertionFailedError\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/gems/aws-s3-0.6.2/lib/aws/s3/extensions.rb:206:in `const_missing_from_s3_library'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:52:in `rescue in redirects_to_url?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:48:in `redirects_to_url?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:35:in `matches?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/assertions.rb:53:in `assert_accepts'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:324:in `block in should'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:382:in `call'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:382:in `block in create_test_from_should_hash'\n</code></pre>\n\n<p>Both Shoulda and Amazon S3 gems are latest versions.</p>\n\n<p>Any ideas what I am doing wrong?</p>\n"},{"tags":["java","ruby-on-rails","crud","scaffolding"],"answer_count":17,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":14259,"score":11,"question_id":414583,"title":"Is there a CRUD generator utility in Java(any framework) like Scaffolding in Rails?","body":"<p>Is there a CRUD generator utility in Java like Scaffolding in Rails? Can be in any framework or even plain servlets. Must generate controllers + views in jsp, not just DAO code...</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13240036,"title":"Why won't my textarea update through Ajax after entry has been re-saved to database?","body":"<p>I am updating a simple <code>text_area</code> in Rails using Ajax:</p>\n\n<p><strong>application.js</strong>:</p>\n\n<pre><code>$(\"#invoice_project_id\").change(function() {\n    var value=$(this).val();\n    $.get('/invoices/get_recipient', {project_id= : value}  function(response) {\n        $('#invoice_recipient').val(response);\n    })\n});​\n</code></pre>\n\n<p><strong>get_recipient.js</strong>:</p>\n\n<pre><code>$('#invoice_recipient').val(\"&lt;%= @recipient.to_s.gsub!(/\\n/, '\\n') %&gt;\");\n</code></pre>\n\n<p><strong>invoices_controller.rb</strong>:</p>\n\n<pre><code>def get_recipient\n  project = Project.find(params[:project_id])\n  @recipient = project.person.address\nend\n</code></pre>\n\n<p>The code works great and replaces the value of the <code>recipient</code> text_area with the correct address, depending on what <code>project</code> gets chosen in the select menu.</p>\n\n<p>The problem is that it works only with the <code>addresses</code> that already exist in the database. (I am using the <a href=\"http://faker.rubyforge.org\" rel=\"nofollow\"><strong>Rails Faker gem</strong></a> to populate my database.) The moment I <strong>re-save</strong> a <code>person</code>'s <code>address</code> manually in my Safari browser, the text_area won't get updated through Ajax anymore when I try to do so using the above code.</p>\n\n<p>How is this possible? </p>\n\n<p>I am already escaping the newline characters using the <code>gsub!</code> method above, so I can't think of anything else I could do.</p>\n\n<p>Can anybody help?</p>\n\n<p>Thanks...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","timezone"],"answer_count":3,"favorite_count":12,"up_vote_count":16,"down_vote_count":0,"view_count":13528,"score":16,"question_id":4362663,"title":"Timezone with rails 3","body":"<p>I have pretty common issue but for some reason i have tried all the suggestions on the web and none seem to work. </p>\n\n<p>I have set the Timezone in config to 'EST'</p>\n\n<pre><code>config.time_zone = 'Eastern Time (US &amp; Canada)'\n</code></pre>\n\n<p>But when the time is shown on the the screen, it continues to show the UTC time that is stored in the DB. I tried the debugger and here is the output</p>\n\n<pre><code>(rdb:1) Time.zone \n#&lt;ActiveSupport::TimeZone:0x1061f4760 @utc_offset=nil, @current_period=nil, @name=\"Eastern Time (US &amp; Canada)\", @tzinfo=#&lt;TZInfo::TimezoneProxy: America/New_York&gt;&gt;\n(rdb:1) Order.first.placed_at\nFri Jan 01 15:00:00 UTC 2010\n</code></pre>\n\n<p>Update: \nHere is another user who has the same question\n<a href=\"http://stackoverflow.com/questions/3203304/rails-timezone-is-wrong-when-shown\">Rails timezone is wrong when shown</a></p>\n"},{"tags":["ruby-on-rails","caching","backbone.js","browser-history","pushstate"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":165,"score":6,"question_id":13130216,"title":"Being served a response directly from the cache when clicking back button","body":"<p>Note that I don't think this problem is related to Backbone or JavaScript but it is necessary to include some Backbone code as context on the issue.</p>\n\n<p><strong>The Related Code</strong>  </p>\n\n<p>I have a <a href=\"http://backbonejs.org/#Router\">client-side Backbone router</a> with a route which takes a parameter called <code>contactId</code>. It looks similar to this: </p>\n\n<pre><code>Backbone.Router.extend({\n\n  routes: {\n    \"jobs/new?contact_id=:contactId\": \"newForContact\"\n  },\n\n  // Fetch the contact and initialize a new job model which \n  // is associated with that contact.\n  newForContact: function(contactId) {\n    var contact = new Contact(id: contactId);\n    contact.fetch({\n      success: _.bind(function(model, resp) {\n        var job = new Job(contact: contact);\n        this.new(job);\n      }\n    }, this));\n  },\n\n  // Show the JobView for the given job.\n  new: function(jobModel) {\n    view = new JobView(job: jobModel);\n    $('body').append(view.render().el);\n  }\n};\n</code></pre>\n\n<p>Now I'm trying to use this setup with <code>pushState</code> turned on. </p>\n\n<p>When I hit the route which triggers the <code>newForContact</code> route, everything works as expected. However, if I press the browser's back button at this point, I am served the JSON response from the <code>contact.fetch()</code> method straight out of the browser's cache. No request is sent to the server.</p>\n\n<p><img src=\"http://i.stack.imgur.com/FnZd3.png\" alt=\"fetch JSON response\"></p>\n\n<p><strong>The App Logs</strong>  </p>\n\n<p>You can see this in the Rails app logs. In this part, I visit the route which triggers <code>newForContact</code>.</p>\n\n<pre><code>Started GET \"/jobs/new?contact%5Bid%5D=1&amp;contact%5Btype%5D=Customer\" for 127.0.0.1 at 2012-10-31 22:41:48 +0000\nProcessing by JobsController#new as HTML\n  Parameters: {\"contact\"=&gt;{\"id\"=&gt;\"1\", \"type\"=&gt;\"Customer\"}}\n  User Load (0.3ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n  Business Load (0.3ms)  SELECT \"businesses\".* FROM \"businesses\" WHERE \"businesses\".\"id\" IN (1)\n  Rendered shared/_search_form.html.erb (0.3ms)\n  Job Load (0.4ms)  SELECT \"jobs\".* FROM \"jobs\" WHERE \"jobs\".\"business_id\" = 1 ORDER BY created_at desc\n  Rendered jobs/_list.html.erb (1.5ms)\n  Rendered jobs/index.html.erb within layouts/application (4.1ms)\n  Rendered layouts/_head_content.html.erb (0.7ms)\n  Rendered layouts/_flash.html.erb (0.0ms)\nCache read: views/jobs/main_nav/d6a805d9b6f285e424f207add4f35595\nRead fragment views/jobs/main_nav/d6a805d9b6f285e424f207add4f35595 (0.4ms)\n  Rendered layouts/_nav.html.erb (0.6ms)\n  Rendered layouts/_header.html.erb (0.7ms)\nCompleted 200 OK in 12ms (Views: 8.0ms | ActiveRecord: 1.0ms)\nCache read: http://print.dev/customers/1?\n</code></pre>\n\n<p>You can see that it fetches the contact at this point with a JSON request.</p>\n\n<pre><code>Started GET \"/customers/1\" for 127.0.0.1 at 2012-10-31 22:41:48 +0000\nProcessing by CustomersController#show as JSON\n  Parameters: {\"id\"=&gt;\"1\"}\n  User Load (0.5ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n  Business Load (0.4ms)  SELECT \"businesses\".* FROM \"businesses\" WHERE \"businesses\".\"id\" IN (1)\n  Customer Load (0.2ms)  SELECT \"customers\".* FROM \"customers\" WHERE \"customers\".\"business_id\" = 1 AND \"customers\".\"id\" = $1 LIMIT 1  [[\"id\", \"1\"]]\n  CustomerEmployee Load (0.3ms)  SELECT \"customer_employees\".* FROM \"customer_employees\" WHERE \"customer_employees\".\"employer_id\" IN (1)\n  Job Load (0.4ms)  SELECT \"jobs\".* FROM \"jobs\" WHERE \"jobs\".\"contact_type\" = 'Customer' AND \"jobs\".\"contact_id\" IN (1)\n  Invoice Load (0.3ms)  SELECT \"invoices\".* FROM \"invoices\" WHERE \"invoices\".\"client_id\" IN (1)\n  Job Load (0.5ms)  SELECT \"jobs\".* FROM \"jobs\" WHERE \"jobs\".\"contact_id\" = 1 AND \"jobs\".\"contact_type\" = 'Customer' AND \"jobs\".\"state\" = 'finished' AND \"jobs\".\"invoice_id\" IS NULL\n  Rendered customers/show.json.rabl (2.8ms)\nCompleted 200 OK in 67ms (Views: 3.2ms | ActiveRecord: 2.5ms)\n</code></pre>\n\n<p>At this point, I would press the browser's back button but no new request is logged at the server.</p>\n\n<p><strong>Rails Environments</strong>  </p>\n\n<p>This only happens on my staging server (<a href=\"http://www.heroku.com/\">Heroku</a>), not in development. I can recreate it locally by running the app with <a href=\"http://pow.cx/\">Pow</a> in the staging environment which has caching turned on in the rails configs.</p>\n\n<pre><code>config.action_controller.perform_caching = true\n</code></pre>\n\n<p>Note that even with caching turned on, I can't recreate the bug in the development environment.</p>\n\n<p>This issue occurs in <code>Chrome 22.0.1229.94</code>, <code>FF 16.0.2</code> and <code>Safari 6.0.1</code>. I'm using Rails <code>3.2.8</code>.</p>\n\n<p><strong>Possibly Related Questions</strong>  </p>\n\n<p><a href=\"http://stackoverflow.com/questions/11059154/ajax-pushstate-bug-in-chrome\">It seems like this guy was having a very similar problem to me.</a></p>\n\n<p><strong>Live Sample</strong>  </p>\n\n<p>If you really want to you can view the problem live on my staging server on Heroku.</p>\n\n<p>Steps to Repro (<strong>edit:</strong> these don't work any longer since I patched the problem).</p>\n\n<ol>\n<li>Log in <a href=\"http://print-staging.herokuapp.com/login\">here</a> with email: user@example.com and pass: foobar</li>\n<li>Visit <a href=\"http://print-staging.herokuapp.com/customers/2\">http://print-staging.herokuapp.com/customers/2</a>. You should see a messed up looking dialog box open up.</li>\n<li>Click the small \"New job\" link in the dialog. The page should change and a new dialog should open.</li>\n<li>Click the browser back button.</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby","prawn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13256723,"title":"How to convert base64 string to PNG using Prawn without saving on server in Rails","body":"<p>So I am trying to embed a PNG image of canvas to PDF using Prawn gem. Base64 string is generated by using canvas' toDataURL() function. As the image is only needed in PDF I'm trying to avoid saving it on the server. Params[:base64string] is correctly passed to the server.</p>\n\n<p>However, I am trying to use </p>\n\n<pre><code>image = Prawn::Images::PNG.new(base64string)\n</code></pre>\n\n<p>to create the image but I get NoMethodError: undefined method `unpack' for nil:NilClass. </p>\n\n<p>Any ideas what I'm doing wrong or how this should be done correctly? </p>\n"},{"tags":["ruby-on-rails","ruby","thrift"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13248127,"title":"How do I use thrift_client library hook feature?","body":"<p>I'm using <a href=\"https://github.com/twitter/thrift_client/blob/master/lib/thrift_client/abstract_thrift_client.rb\" rel=\"nofollow\">thrift_client 0.8.1 library</a>. And it supports some hook interfaces.</p>\n\n<pre><code>client = ThriftClient.new(FooService, host)\n\nclient.add_callback :before_method do |*args|\n  ActionController::Base.logger.info instance_eval(\"@current_server\")\n  logger.info args.inspect\nend\n\nclient.add_callback :post_connect do |client|\n  logger.info \"A thrift server connection has been made&lt;#{client.current_server}&gt;\"\nend\n</code></pre>\n\n<p>Everytime calling a method, I would like to write log the information of thrift server.\nSo I installed a <code>:before method</code> hook but I think <code>instance_eval(\"@current_server\")</code> doesn't work as I expected. The <code>@current_server</code> is an instance variable in the <code>ThriftClient</code> class. What is the problem?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12865919,"title":"Get value in ruby","body":"<p>In ruby, I have </p>\n\n<pre><code>res = [[0, :product, \"client\"], [0, :os, \"windows\"], [0, :architecture, \"32rs\"]]\n</code></pre>\n\n<p>I want to get value of os. I can do it by res[1][2], but I don't want to rely on the index as it can change. What I have is the key i.e. :os, so what is the best way to find it?</p>\n"},{"tags":["ruby-on-rails","soap","rack","activesupport","actionpack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13058132,"title":"wash_out parse failures: SOAP errors instead of HTML errors","body":"<p>So, when you use the wash_out gem in Rails, and a client sends bad XML, the response is like:</p>\n\n<pre><code>&lt;html&gt;…\n  &lt;body&gt;\n    &lt;h1&gt;REXML::ParseException&lt;/h1&gt; \n    …\n</code></pre>\n\n<p>Instead of a correct SOAP response, like this:</p>\n\n<pre><code>&lt;soap:Body&gt;\n  &lt;soap:Fault&gt;\n    &lt;faultcode&gt;soap:Client&lt;/faultcode&gt;\n    …\n</code></pre>\n\n<p>I first attempted to patch wash_out itself. I managed to reproduce the\nREXML::ParseException from within its tests, but then found out to my dismay\nthat Rails actually parses (and explodes on) bad XML before wash_out ever\ntouches the params. </p>\n\n<p>So, how should the wash_out gem hook into Rails so that it can rescue those\nexceptions, only for the routes that it owns?</p>\n\n<p>Here is the backtrace we have to work with. I'm quite sure that there's some\npoint in it that'd be perfect to hook into, but I don't yet know which:</p>\n\n<pre><code>malformed XML: missing tag start\nLine: 13\nPosition: 558\nLast 80 unconsumed characters:\n&lt;urn:                &lt;Width xsi:type=\"xsd:int\"&gt;1&lt;/Width&gt;                &lt;Height x\nLine: 13\nPosition: 558\nLast 80 unconsumed characters:\n&lt;urn:                &lt;Width xsi:type=\"xsd:int\"&gt;1&lt;/Width&gt;                &lt;Height x):\n  /home/rking/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/rexml/parsers/treeparser.rb:95:in `rescue in parse'\n  /home/rking/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/rexml/parsers/treeparser.rb:20:in `parse'\n  /home/rking/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/rexml/document.rb:231:in `build'\n  /home/rking/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/rexml/document.rb:43:in `initialize'\n  activesupport (3.2.8) lib/active_support/xml_mini/rexml.rb:30:in `new'\n  activesupport (3.2.8) lib/active_support/xml_mini/rexml.rb:30:in `parse'\n  activesupport (3.2.8) lib/active_support/xml_mini.rb:80:in `parse'\n  activesupport (3.2.8) lib/active_support/core_ext/hash/conversions.rb:90:in `from_xml'\n  actionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:41:in `parse_formatted_parameters'\n  actionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:17:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'\n  rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\n  rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'\n  activerecord (3.2.8) lib/active_record/query_cache.rb:64:in `call'\n  activerecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\n  activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__937528092__call__217727214__callbacks'\n  activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\n  activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\n  activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\n  actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n  railties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'\n  railties (3.2.8) lib/rails/rack/logger.rb:16:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'\n  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\n  rack (1.4.1) lib/rack/runtime.rb:17:in `call'\n  activesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n  rack (1.4.1) lib/rack/lock.rb:15:in `call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'\n  railties (3.2.8) lib/rails/engine.rb:479:in `call'\n  railties (3.2.8) lib/rails/application.rb:223:in `call'\n  rack (1.4.1) lib/rack/content_length.rb:14:in `call'\n  railties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'\n  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n  /home/rking/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n  /home/rking/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n  /home/rking/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' \n</code></pre>\n\n<p>Thanks!\n—☈</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-masonry","turbolinks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13256649,"title":"turbolinks with masonry is not working","body":"<p>I have installed turbolink gem <a href=\"https://github.com/rails/turbolinks\" rel=\"nofollow\">https://github.com/rails/turbolinks</a> in my rails app 3.2.8.</p>\n\n<p>I use this gem, masonry for show elements <a href=\"https://github.com/desandro/masonry\" rel=\"nofollow\">https://github.com/desandro/masonry</a>.</p>\n\n<p>The problem is that masonry elements when I open a new page with turbolinks are not loaded correctly.</p>\n\n<p>How can I fix this problem?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":98,"score":2,"question_id":12875743,"title":"Heroku installing sqlite3 even though it is not a dependecy","body":"<p>I am trying to deploy my app to Heroku, but it keeps getting rejected with the following output.</p>\n\n<pre><code>waitup$git push staging master\nCounting objects: 4184, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (1033/1033), done.\nWriting objects: 100% (4184/4184), 1.11 MiB | 494 KiB/s, done.\nTotal 4184 (delta 3069), reused 4184 (delta 3069)\n\n-----&gt; Heroku receiving push\n-----&gt; Ruby/Rails app detected\n-----&gt; Installing dependencies using Bundler version 1.2.1\n       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment\n       Fetching gem metadata from http://rubygems.org/.......\n       Fetching https://github.com/stripe/stripe-ruby\n       Installing rake (0.8.7)\n       Installing abstract (1.0.0)\n       Installing activesupport (3.0.4)\n       Installing builder (2.1.2)\n       Installing i18n (0.5.0)\n       Installing activemodel (3.0.4)\n       Installing erubis (2.6.6)\n       Installing rack (1.2.2)\n       Installing rack-mount (0.6.14)\n       Installing rack-test (0.5.7)\n       Installing tzinfo (0.3.27)\n       Installing actionpack (3.0.4)\n       Installing mime-types (1.16)\n       Installing polyglot (0.3.1)\n       Installing treetop (1.4.9)\n       Installing mail (2.2.19)\n       Installing actionmailer (3.0.4)\n       Installing bcrypt-ruby (2.1.4) with native extensions\n       Installing orm_adapter (0.0.5)\n       Installing warden (1.0.4)\n       Installing devise (1.3.4)\n       Installing formtastic (1.2.3)\n       Installing has_scope (0.5.0)\n       Installing responders (0.6.4)\n       Installing inherited_resources (1.2.2)\n       Installing will_paginate (3.0.pre2)\n       Installing inherited_views (0.0.2)\n       Installing arel (2.0.9)\n       Installing activerecord (3.0.4)\n       Installing meta_search (1.0.5)\n       Installing activeresource (3.0.4)\n       Using bundler (1.2.1)\n       Installing thor (0.14.6)\n       Installing railties (3.0.4)\n       Installing rails (3.0.4)\n       Installing sass (3.1.2)\n       Installing activeadmin (0.2.2)\n       Installing addressable (2.2.6)\n       Installing authlogic (2.1.6)\n       Installing celerity (0.8.8)\n       Installing culerity (0.2.15)\n       Installing nokogiri (1.4.4) with native extensions\n       Installing ffi (0.6.3) with native extensions\n       Installing childprocess (0.1.7)\n       Installing json_pure (1.5.1)\n       Installing rubyzip (0.9.4)\n       Installing selenium-webdriver (0.1.3)\n       Installing xpath (0.1.3)\n       Installing capybara (0.4.1.2)\n       Installing configuration (1.2.0)\n       Installing cookiejar (0.3.0)\n       Installing diff-lcs (1.1.2)\n       Installing json (1.5.1) with native extensions\n       Installing gherkin (2.3.7) with native extensions\n       Installing term-ansicolor (1.0.5)\n       Installing cucumber (0.10.2)\n       Installing cucumber-rails (0.3.1)\n       Installing daemons (1.1.6)\n       Installing database_cleaner (0.6.4)\n       Installing hiredis (0.3.2) with native extensions\n       Installing em-hiredis (0.1.0)\n       Installing escape_utils (0.2.4) with native extensions\n       Installing eventmachine (0.12.10) with native extensions\n       Installing em-http-request (0.3.0) with native extensions\n       Installing thin (1.3.1) with native extensions\n       Installing faye (0.7.1)\n       Installing launchy (0.4.0)\n       Installing rest-client (1.6.3)\n       Installing heroku (2.2.8)\n       Installing jquery-rails (1.0.7)\n       Installing jwt (0.1.3)\n       Installing multi_json (1.0.3)\n       Installing mysql2 (0.2.7) with native extensions\n       Installing rspec-core (2.5.1)\n       Installing rspec-expectations (2.5.0)\n       Installing rspec-mocks (2.5.0)\n       Installing rspec (2.5.0)\n       Installing rspec-rails (2.5.0)\n       Installing seed-fu (2.0.1)\n       Installing sequel (3.20.0)\n       Installing sinatra (1.0)\n       Installing spork (0.8.4) with native extensions\n       Installing sqlite3 (1.3.4) with native extensions\n       Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n       /usr/local/bin/ruby extconf.rb\n       checking for sqlite3.h... no\n       sqlite3.h is missing. Try 'port install sqlite3 +universal'\n       or 'yum install sqlite3-devel' and check your shared library search path (the\n       location where your sqlite3 shared library is located).\n       *** extconf.rb failed ***\n       Could not create Makefile due to some reason, probably lack of\n       necessary libraries and/or headers.  Check the mkmf.log file for more\n       details.  You may need configuration options.\n       Provided configuration options:\n       --with-opt-dir\n       --without-opt-dir\n       --with-opt-include\n       --without-opt-include=${opt-dir}/include\n       --with-opt-lib\n       --without-opt-lib=${opt-dir}/lib\n       --with-make-prog\n       --without-make-prog\n       --srcdir=.\n       --curdir\n       --ruby=/usr/local/bin/ruby\n       --with-sqlite3-dir\n       --without-sqlite3-dir\n       --with-sqlite3-include\n       --without-sqlite3-include=${sqlite3-dir}/include\n       --with-sqlite3-lib\n       --without-sqlite3-lib=${sqlite3-dir}/lib\n       --enable-local\n       --disable-local\n       Gem files will remain installed in /tmp/build_qlnbqtp08z3t/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.4 for inspection.\n       Results logged to /tmp/build_qlnbqtp08z3t/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.4/ext/sqlite3/gem_make.out\n       An error occurred while installing sqlite3 (1.3.4), and Bundler cannot continue.\n       Make sure that `gem install sqlite3 -v '1.3.4'` succeeds before bundling.\n !\n !     Failed to install gems via Bundler.\n !     \n !     Detected sqlite3 gem which is not supported on Heroku.\n !     http://devcenter.heroku.com/articles/how-do-i-use-sqlite3-for-development\n !\n !     Heroku push rejected, failed to compile Ruby/rails app\n\nTo git@heroku.com:waiterd2-staging.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'git@heroku.com:waiterd2-staging.git'\n</code></pre>\n\n<p>Clearly, the sqlite3 gem is the issue here. The weird part is that it's not included as a dependency in my Gemfile or Gemfile.lock.</p>\n\n<p>My gemfile looks like this:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.1.0'\n\ngem 'pg'\ngem 'thin'\ngem 'authlogic', '3.1.3'\ngem 'twilio-ruby'\ngem 'heroku'\ngem 'activeadmin', :git =&gt; 'https://github.com/gregbell/active_admin.git'\ngem 'stripe', :git =&gt; 'https://github.com/stripe/stripe-ruby'\ngem 'faye'\n\ngroup :assets do\n    gem 'less'\n    gem 'bourbon'\n    gem 'therubyracer'\n    gem 'sass-rails'\n    gem 'coffee-rails'\n    gem 'uglifier'\nend\n</code></pre>\n\n<p>A few things stand out here. The authlogic gem installed by Heroku is not the one specified in the Gemfile. The only reason I'm suspecting the authlogic gem is because it lists sqlite3 as a development dependency. This shouldn't matter though.</p>\n\n<p>When I run the exact command listed in the Heroku output on my local machine, the sqlite3 gem is not installed.</p>\n\n<p>I've tried many suggestions that I found on StackOverflow and elsewhere such as removing the Gemfile.lock file and running bundler again. None of these have worked. Heroku still installs the wrong version of authlogic and attempts to install sqlite3.</p>\n\n<p>How do I get Heroku to stop trying to install the sqlite3 gem?</p>\n\n<p>Your help is much appreciated!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":23,"score":-2,"question_id":13256023,"title":"Rails: steps to take before deploying rails app (e.g. changing database to postgres, etc)?","body":"<p>Hi I am about to deploy a rails app (onto heroku) I made and wanted to know what the procedure is. I know you have to change the database by changing <code>gem 'sqlite3'</code> to <code>gem 'pg'</code> but after I did that and went on my localhost:3000 it gives me the error:</p>\n\n<p><code>ActiveRecord::ConnectionNotEstablished</code></p>\n\n<p>What else am I missing?</p>\n"},{"tags":["ruby-on-rails","ruby","charts","google-charts","linechart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13255304,"title":"How to generate a line chart with too many data in ruby/ruby on rails?","body":"<p>I'm trying to generate a line chart with data I take from a database.</p>\n\n<p>The data basically have a date field, an estimated progress field and a real progress field.</p>\n\n<p>The progresses may be nil but the date is always there.</p>\n\n<p>Since I don't know what are the intervals of the date and I need the intervals of the date distributed uniformly , I want to make the data from the first date until the last date with steps of 1 day.</p>\n\n<p>For example, let's say I have this in the database:</p>\n\n<pre><code>| date        | estimated progress        | real progress        |\n| 2012-08-01  | 0.0                       |                      |\n| 2012-08-02  |                           | 0.15                 |\n| 2012-08-05  | 0.3                       |                      |\n</code></pre>\n\n<p>I would like to generate a line chart with this info:</p>\n\n<pre><code>x = [2012-08-01, 2012-08-02, 2012-08-03, 2012-08-04, 2012-08-05]\nep = [0.0 , 0.0, 0.0, 0.0, 0.3]\nrp = [nil , 0.15, 0.15, 0.15, 0.15 ]\n</code></pre>\n\n<p>But since the start date and the finish date can be way too separated, I'd like to show the x labels with a custom interval. It could be every 3, 5 or 7 days depending on the distance between those dates.</p>\n\n<p>I'm trying this with <code>gchartrb</code> which use the google chart api but I realized I can't have nil values inside my data. So I should replace it with 0.0 even though it's not 0. It's unknown.</p>\n\n<p>The other problem I found is that I don't know how to specify the labels to show those intervals I said before. It just show me every label and therefore, it's not readable.</p>\n\n<p>I'm looking for another gem, a solution for gchartrb or ideas to generate the data differently and make it understandable. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":10800111,"title":"rails selectbox_tag onchange()","body":"<p>Say we have a select box: <br />\n/app/views/tape/_form.html.erb <br />\n<code>&lt;%= f.select :tape, Tape::LIST_TAPES %&gt;</code><br /></p>\n\n<p>and a <em>.js.coffee</em> file that i would like to trigger when some value is selected in selectbox:<br />\n/app/assets/javascripts/tapes.js.coffee<br /></p>\n\n<pre><code>function selectBoxValue(value){\n  # value -- selected in selectbox;\n  console.log(\"box_value = \", value);\n}\n</code></pre>\n\n<p>How can it be done in RoR 3.2?<br />\n<a href=\"http://jsfiddle.net/7q2s9/7/\" rel=\"nofollow\">Here's</a> what i mean within html+js.</p>\n\n<p><strong>P.S.</strong><br />\nI'm new to Rails. Sorry for my English and thank you.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13255987,"title":"Ruby on Rails - How to migrate code from float to decimal?","body":"<p>So I've got a ruby on rails code which use float a lot (lots of \"to_f\"). It uses a database with some numbers also stored as \"float\" type.</p>\n\n<p>I would like to migrate this code and the database to decimal only. Is it as simple as migrating the database columns to decimal (adding a decimal column, copying float column to decimal one, deleting float column, renaming decimal column to old float column name), and replacing \"to_f\" with \"to_d\" in the code? Or do I need to do more than that?</p>\n\n<p>Thanks a lot everyone\nRaphael</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13254433,"title":"How do I set a catch-remaining default route to a directory?","body":"<p>Perhaps simply due to lack of good keywords, I wasnt able to find any useful solution for a problem that should be almost trivial…</p>\n\n<p>In my <em>routes.rb</em>, how do I tell: \"If no other route matches <strong>request</strong>, then deliver /foo/bar/<strong>request</strong>\"?</p>\n\n<p>(Note: <strong>request</strong> ≠ '/')</p>\n\n<p>To be more specific:</p>\n\n<p>If <em>http://example.com/somedir/test/1/2/3</em> is not matched, try <em>/for/bar/somedir/test/1/2/3</em>, just if that does not exist, deliver *APP_DIR/public/404.html*.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec-rails","gmaps4rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13255284,"title":"Stubbing Gmaps4rails with geocoding.rb","body":"<p>I've reviewed a few of the Gmaps4rails stubbing questions and think I'm very close, but not quite there.  Forgive me: Very new to stubbing and mocking in rails.</p>\n\n<p>All of this code works in the real world, just trying to get it to skip geocoding during testing.  Right now tests <em>sometimes</em> work and <em>sometimes</em> fail with the <strong>Gmaps4rails address Address invalid</strong> error</p>\n\n<p>So, I have a very simple party.rb model that acts_as_gmappable:</p>\n\n<pre><code>def gmaps4rails_address\n   \"#{self.city}, #{self.country}\" \nend \n</code></pre>\n\n<p>I've pasted geocoding.rb from github and placed it in /spec/support unmodified</p>\n\n<p>However, I can't seem to tell my parties_controller_spec to use the stub instead of the real one.  I'm sure I'm missing something simple...  I've tried:</p>\n\n<pre><code>include Geocoding\n</code></pre>\n\n<p>and even</p>\n\n<pre><code>Gmaps4rails.set_gmaps4rails_options!({:msg =&gt; \"quack\"})\n</code></pre>\n\n<p>and I don't see \"quack\" as the error message, I see <strong>Validation failed: Gmaps4rails address Address invalid</strong></p>\n\n<p>Also tried:</p>\n\n<pre><code>Gmaps4rails.set_gmaps4rails_options!({:validation =&gt; false, :check_process =&gt; false, :process_geocoding =&gt; false})\n</code></pre>\n\n<p>But to no effect.</p>\n\n<p>My factories.rb has a straightforward :party define:</p>\n\n<pre><code>Factory.define :party do |party|\nparty.name      \"Thai New Year\"\nparty.city      \"Phuket\"\nparty.country   \"Thailand\"\n...\nend\n</code></pre>\n\n<p>So, I'm pretty sure I haven't properly told rspec to use the stubbed Gmaps4rails.  So, where exactly do I put the code that tells Gmaps4rails to use your stub_geocoding method instead of actually trying to perform geocoding?</p>\n\n<p>Any help would be appreciated... Sorry if this is a mundane question.</p>\n\n<p>Dave</p>\n"},{"tags":["ruby-on-rails"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":74,"score":-1,"question_id":4050230,"title":"in rails is there some object has nil!","body":"<p>i know there some object has nil? method,i want to know is there some method with nil!?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13255242,"title":"How to clean rails console output when using pry-rails?","body":"<p>I have in my Gemfile pry-rails gem. I would like to use pry as rails console but without that text below.</p>\n\n<p>How to clean my rails console output, now I receive a lot of unnecessary text:</p>\n\n<pre><code>&gt;&gt; Subscription.where(user_id: User.last.id)\n  User Load (1.8ms)  SELECT \"users\".* FROM \"users\" ORDER BY \"users\".\"id\" DESC LIMIT 1\n#&lt;ActiveRecord::Relation:0x7f7f9ad69c70\n  @implicit_readonly = nil,\n  @join_dependency = nil,\n  @order_clause = nil,\n  @records = [],\n  @should_eager_load = nil,\n  attr_accessor :bind_values = [],\n  attr_accessor :create_with_value = {},\n ...\n</code></pre>\n\n<p><a href=\"https://gist.github.com/4025796\" rel=\"nofollow\">https://gist.github.com/4025796</a></p>\n"},{"tags":["ruby-on-rails","associations","belongs-to","has-one"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13255218,"title":"Rails: unidirectional association","body":"<p>Here is a scenario: I have an <code>IssueType</code> model and an <code>IssueTypeColour</code> model. An <code>IssueType</code> <code>has_one</code> <code>IssueTypeColour</code>, but an <code>IssueTypeColour</code> doesn't necessarily <code>belongs_to</code> a particular <code>IssueType</code>; it can belong to many different <code>IssueType</code>. In other words, many <code>IssueType</code>s can have the same <code>IssueTypeColour</code>.</p>\n\n<p>According to this scenario, it makes sense to have a <code>has_one</code> association on the <code>IssueType</code> model and no <code>belongs_to</code> association on the <code>IssueTypeColour</code> model.</p>\n\n<p>But is that acceptable/OK?</p>\n"},{"tags":["ruby-on-rails","ruby","rvm","sproutcore"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":13246429,"title":"I am getting rvm: command not found after installation of rvm","body":"<p>I know the above question is very common question. I have gone through multiple posts on this topic. But I didn't get any resolution.</p>\n\n<p>I have installed rvm locally. We already have the installation files. SO went into the folder and run the install command.</p>\n\n<pre><code>$ ./install \n</code></pre>\n\n<p>Then I checked ./rvm folder in the Users home folde</p>\n\n<pre><code>$ cd ~/.rvm \n</code></pre>\n\n<p>folder exists. Hence Installation is successful.</p>\n\n<p>Now I am typing rvm in the command line</p>\n\n<pre><code>$ rvm\n</code></pre>\n\n<p>I am getting below exception</p>\n\n<pre><code>$ rvm\n-sh: rvm: command not found\n</code></pre>\n\n<p>After reading the multiple articles in stackoverflow on this issue, I learned that I have to add the below lines in .bash_profile as I am using Mac OSX 10.7.3</p>\n\n<pre><code>[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\"\n</code></pre>\n\n<p>Even after I am getting same exception while typing rvm. Is there any thing extra I need to do? or Am I missing some thing? Please help</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":2513,"score":11,"question_id":944126,"title":"Rails: HasManyThroughAssociationNotFoundError","body":"<p>I have problems with getting a has_many through association to work.\nI keep getting this exception:</p>\n\n<pre><code>Article.find(1).warehouses.build\nActiveRecord::HasManyThroughAssociationNotFoundError: Could not find the association :entries in model Article\n</code></pre>\n\n<p>These are the models involved:</p>\n\n<p><pre>\nclass Article &lt; ActiveRecord::Base\n  has_many :warehouses, :through => :entries\nend</p>\n\n<p>class Warehouse &lt; ActiveRecord::Base\n  has_many :articles, :through => :entries\nend</p>\n\n<p>class Entry &lt; ActiveRecord::Base\n  belongs_to :article\n  belongs_to :warehouse\nend\n</pre></p>\n\n<p>And this is my schema:</p>\n\n<pre>\n  create_table \"articles\", :force => true do |t|\n    t.string   \"article_nr\"\n    t.string   \"name\"\n    t.integer  \"amount\"\n    t.string   \"warehouse_nr\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n    t.integer  \"unit\"\n  end\n\n  create_table \"entries\", :force => true do |t|\n    t.integer \"warehouse_id\"\n    t.integer \"article_id\"\n    t.integer \"amount\"\n  end\n\n  create_table \"warehouses\", :force => true do |t|\n    t.string   \"warehouse_nr\"\n    t.string   \"name\"\n    t.integer  \"utilization\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\nend\n</pre>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":159,"score":0,"question_id":3639849,"title":"Has anyone tried a multi-domain/multi-database/single-deployment Rails setup?","body":"<p>I'm developing an app (basically an intranet) which has a few small sets of users, each a company using the app internally.</p>\n\n<p>Up to now, each set of users has its own deployment with a separate domain name and database, but all living on the same server. This means that each time I have to push an upgrade I need to deploy once per client. Also, each new client means adding a new deploy target, for which I'm currently using Capistrano's multistage plugin, but it's getting a bit ridiculous.</p>\n\n<p>This is a less than ideal setup, so after some thought I came up with the idea of modifying the app so that it handles multiple domains, each mapped to a different database, but on a single deployment. I created a small proof-of-concept app which basically has a before_filter in ApplicationController acting as a multiplexer for domains/databases, connecting ActiveRecord to each domain's database on each request. This worked really well, but I haven't applied this to the big app yet and I can think of at least one problem down the road: running migrations across all databases. I'm pretty sure I can work around that one though, maybe I'll tweak the rake task a little, but I'm worried that might not be the last of problems with it.</p>\n\n<p>Has anyone ever tried this, or can think of any major reasons why this would be a bad idea? I would like to listen to some opinions.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","pjax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12099996,"title":"pjax loading full page content into element","body":"<p>I am adding pjax to my rails app. This is what I have done so far:</p>\n\n<p>Added this to my gemfile:</p>\n\n<pre><code>gem 'pjax_rails'\n</code></pre>\n\n<p>Added this to application.js.erb</p>\n\n<pre><code>//= require pjax\n</code></pre>\n\n<p>On the element I wish the updated content to appear within I added the appropriate data attribute:</p>\n\n<pre><code>%div{ class: 'coasters-list', data: { 'pjax-container' =&gt; '' } }\n</code></pre>\n\n<p>and on the links I added</p>\n\n<pre><code>data: { pjax: '.coasters-list' }\n</code></pre>\n\n<p>So, Yes, the pjax is working but the content returned and being put into .coasters-list is the full page so I sort of end up with 1 page inside another. I only want a specific part to be shown.</p>\n\n<p>Any thoughts?</p>\n\n<p><strong>Update:</strong> I have just noticed that every link on that page has been pjax'ified' and whenever I click a link, the resulting page loads in the coasters-list element. How do I fix it so that only specific links are pjax enabled.?</p>\n\n<p>I thought that was why I added  <code>data: { pjax: '.coasters-list' }</code> to the links anyway? But obviously that doesn't work?</p>\n"},{"tags":["jquery","ruby-on-rails","datetimepicker","jquery-ui-datepicker","jquery-ui-timepicker"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13241040,"title":"jquery-timepicker-addon doesn't appear","body":"<p>I'm trying to use the jquery-timepicker-addon by Trent Richardson however after following all the instructions, I have</p>\n\n<p>application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery.ui.slider\n//= require jquery.ui.datepicker\n//= require jquery-ui-timepicker-addon\n//= require_tree .\n</code></pre>\n\n<p>application.css</p>\n\n<pre><code>*= require_self\n*= require jquery.ui.slider\n*= require jquery.ui.datepicker\n*= require jquery-ui-timepicker-addon\n*= require_tree .\n*/\n</code></pre>\n\n<p>new.html.erb for the users controller</p>\n\n<pre><code>&lt;input id=\"event_start\" type=\"text\" value=\"\" name=\"event_start\"&gt;\n</code></pre>\n\n<p>inside the users.js.coffeescript file</p>\n\n<pre><code>$(\"#event_start\").datetimepicker()\n</code></pre>\n\n<p>I've also tried using </p>\n\n<pre><code>  $(\"#event_start\").click -&gt;\n    $(\"#event_start\").datetimepicker()\n</code></pre>\n\n<p>inside the coffeescript, but no matter what I do when I click the textbox nothing happens.  I know the textbox is being clicked on because I tested it by calling alert when I clicked on it and it worked fine.  Does anyone know what I'm doing wrong?</p>\n\n<p>I'm using rails 3.2 with ruby 1.9.3</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":4140216,"title":"Why isn't my image tag working?","body":"<p>What is the different with</p>\n\n<pre><code>&lt;images src=\"http://localhost:3000/images/logo_general.png\"&gt;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&lt;%= image_tag(\"logo_general.png\") %&gt;\n</code></pre>\n\n<p>Why am I having problems loading images using the first way?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","html5","contenteditable"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13254460,"title":"make next contenteditable element editable","body":"<p>I have a following structure </p>\n\n<pre><code>&lt;div&gt;\n&lt;ul id='t1'&gt;\n  &lt;li id='l1' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n  &lt;li id='l2' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n  &lt;li id='l3' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>What I want here is when the user edits say li l3 and when he hits enter I want to add new li with contenteditable = true and setfocus on the new li so that user can start typing there. \nI was able to add a new entry on enter by but couldn't set focus on it.</p>\n\n<p><strong>Update</strong></p>\n\n<pre><code> if(e.keyCode == 13){//enter Key or tab key 9\n    e.preventDefault();\n    var taskId = this.id;\n    jQuery.ajax({\n        url : 'update_current',\n        type : 'put',\n        success : function(resp){ //resp is the new li tag\n          var li =  this_is_current_elemtn;\n          jQuery(li).append(resp);\n\n          //$('#t1 .editable').each(function(){\n            // $(this).attr('editable', 'false');\n          //});\n          console.log(jQuery(li).next());\n\n           jQuery(li).next().focus();\n         // $('#t1 .editable').each(function(){\n         //    $(this).attr('contentEditable', 'true');\n         // });\n        }\n    });\n</code></pre>\n\n<p>any help is appreciated</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13248758,"title":"Unable to gracefully shutdown unicorn server with QUIT","body":"<p>We're doing zero downtime deploys for our Rails app using unicorn and the usual <a href=\"http://ariejan.net/2011/09/14/lighting-fast-zero-downtime-deployments-with-git-capistrano-nginx-and-unicorn\" rel=\"nofollow\">zero downtime deploy setup.</a> (we don't use the exact setup from the example, but the thing is similiar).</p>\n\n<p>This used to work, but during our upgrade to Rails 3.2 we ran into a weird problem:</p>\n\n<ul>\n<li>Old unicorn master gets <code>USR2</code></li>\n<li>New master is spawned</li>\n<li>However, the old master does <strong>never</strong> terminate and does seem to react to <code>QUIT</code> at all. </li>\n<li>The old master will still react to <code>WINCH</code> and shut down all workers, and it can be shut down with <code>TERM</code> - but graceful shutdown just doesn't work</li>\n</ul>\n\n<p>We do attempt to close the database connection from the master processes, but are not completely if it does still hold Redis connections (and if that would cause a problem).</p>\n"},{"tags":["ruby-on-rails","forms","helper"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1879,"score":2,"question_id":4141069,"title":"Using the textarea helper in Rails forms","body":"<p>Why does this code show an error in text area?</p>\n\n<pre><code>&lt;%= form_for(:ad, :url =&gt; {:action =&gt; 'create'}) do |f| %&gt;\n  &lt;%= f.text_field(:name) %&gt;\n  &lt;%= f.text_area_tag(:text, \"\", :size =&gt; \"50x10\") %&gt;\n  &lt;%= submit_tag(\"Submit\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","statemachine"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":151,"score":1,"question_id":9564728,"title":"Howto get all state_machine events from model class?","body":"<p>Is it possible to get all events from a model class? I want to filter a list by events.</p>\n\n<p>There was a <a href=\"http://groups.google.com/group/pluginaweek-talk/browse_thread/thread/39e785cee0ba9309/cee2f2713f65c2ae\" rel=\"nofollow\">similar question on mailinglist</a> about all transitions.</p>\n\n<p>I am using <a href=\"https://github.com/pluginaweek/state_machine\" rel=\"nofollow\">https://github.com/pluginaweek/state_machine</a></p>\n"},{"tags":["ruby-on-rails","sass","font-face"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13254363,"title":"Asset path for fontface fonts ignores application root","body":"<p>I have a rails 3.2 project (with asset pipeline) that uses the twitter-bootstrap rails gem.</p>\n\n<p>In the bootstrap_and_overrides.css.less.erb I've added the following lines to load a webfont:</p>\n\n<pre><code>@font-face {\n  font-family: 'WebServeroffRegular';\n  src: url(&lt;%= asset_path('Web_Serveroff-webfont.eot') + \"?#iefix\" %&gt;) format('embedded-opentype'),\n  url(&lt;%= asset_path('Web_Serveroff-webfont.woff') %&gt;) format('woff'),\n  url(&lt;%= asset_path('Web_Serveroff-webfont.ttf') %&gt;)  format('truetype'),\n  url(&lt;%= asset_path('Web_Serveroff-webfont.svg') + \"#WebServeroffRegular\" %&gt;) format('svg');\n}\n</code></pre>\n\n<p>This works fine locally, but when I try to deploy to my remote server where the app is loaded in a subdirectory (http://example.com/project) the font is not loaded.</p>\n\n<p>Investigating it looks like the app searches for the font in <a href=\"http://example.com/assets\" rel=\"nofollow\">http://example.com/assets</a> instead of <a href=\"http://example.com/project/assets\" rel=\"nofollow\">http://example.com/project/assets</a>.</p>\n\n<p>Any idea on how to make it work both locally and remotely?</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails","apache","passenger","phusion-passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13254299,"title":"Apache - Passenger - Rails - file upload memory leak","body":"<p>I've got a simple form with a file input. In the controller I just <code>render :nothing</code> still the servers memory is leaking by every post request where a file was attached. However it is not a bare rails application, still cause of the controllers trivial functionality it should not play a role.</p>\n\n<p>An extra odd behavior is when I restart the appached I just get a part of that memory back. </p>\n\n<p>I pasted my passenger-memory-stats output, on <a href=\"http://paste.bradleygill.com/index.php?paste_id=3375\" rel=\"nofollow\">codepaste</a>, but I think this \"private dirty RSS\" is visible for <a href=\"http://paste.bradleygill.com/index.php?paste_id=3376\" rel=\"nofollow\">ps aux</a>. My main problem is that I do not see any processes which would lock that memory, but still <code>free -m</code> outputs:</p>\n\n<pre><code>             total       used       free     shared    buffers     cached\nMem:          1716       1574        141          0         87       1174\n</code></pre>\n\n<p>It feels like appached reads the whole uploaded file into memory then writes it on the disk, however does not free that memory, and in the meantime there is a second leak somewhere too.</p>\n\n<p>Is this an intented behavior? am I missing something? Or should I search along the config files? Any other tipps?</p>\n"},{"tags":["ruby-on-rails","selenium","cucumber","capybara"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13193547,"title":"Capybara visit gets stuck for no reason","body":"<p>We have a large cucumber suite for a rails project. It is all capybara and mostly goes via Firefox.</p>\n\n<p>Recently we started to experience a failure, that I am struggling to get my head around. Here is what it looks like:</p>\n\n<ul>\n<li>at some point (always the same), capybara <code>visit</code> gets stuck in trying to load the page and capybara eventually times out to find whatever element was looking for (see trace below); every subsequent visit in every other feature also times out;</li>\n<li>if the feature where it happens run standalone, the problem disappears;</li>\n<li>if stick debugger (binding.pry) right before the failure, the problem disappears;</li>\n<li>while it is stuck, if I hit enter in the firefox address bar, request immediately gets through and tests go on and complete without any problems.</li>\n</ul>\n\n<p>One detail that may or may not be relevant: we are using multiple sessions (capybara <code>using_session</code>), so there are three firefox instances by the time of failure. But then again, there are three instances happily passing before that.</p>\n\n<p>The same behaviour shows up on my mate's machine.</p>\n\n<p>Nothing suspicious in rails logs. No sign of that request that is trying to get through.</p>\n\n<p>OSX 10.8.2, ruby 1.9.3, rails 3.2.6, sqlite3, latest capybara/selenium.</p>\n\n<p><br></p>\n\n<p><strong>Error stack trace:</strong></p>\n\n<pre><code>  Timeout::Error (Timeout::Error)\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/protocol.rb:146:in `rescue in rbuf_fill'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/protocol.rb:140:in `rbuf_fill'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/protocol.rb:122:in `readuntil'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/protocol.rb:132:in `readline'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:2562:in `read_status_line'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:2551:in `read_new'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:1319:in `block in transport_request'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:1316:in `catch'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:1316:in `transport_request'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:1293:in `request'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:1286:in `block in request'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:745:in `start'\n  /Users/artem/.rbenv/versions/1.9.3-p194-perf/lib/ruby/1.9.1/net/http.rb:1284:in `request'\n  (eval):2:in `has_css?'\n  ./features/step_definitions/home_page_steps.rb:70:in `/^I am taken to the products page on the retailer site$/'\n  features/home_page.feature:21:in `Then I am taken to the products page on the retailer site'\n  Timeout::Error (Timeout::Error)\n</code></pre>\n\n<p><br>\n<strong>EDIT</strong></p>\n\n<p><code>bundle update</code> seems to have made it go away</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid","mongohq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":730,"score":1,"question_id":10801977,"title":"MongoDB won't connect to MongoHQ using Mongoid","body":"<p>I've just started a brand new rails project and the first task I'm trying to complete is creating an object and having it save within my database.  I went through the automated way of generating an object, in this case a URL object as follows:</p>\n\n<pre><code>rails generate scaffold Url domain:string\n</code></pre>\n\n<p>I've also tested out two separate mongoid.yml configuration settings.  The first is as follows:</p>\n\n<pre><code>development:\n  sessions:\n    default:\n      # Defines the name of the default database that Mongoid can connect to.\n      # (required).\n      uri: mongodb://[username]:[password]@flame.mongohq.com:27046/[database]\n\n      options:\n        consistency: :strong \n</code></pre>\n\n<p>The result of this configuration is that when a query takes place, I get the following error:</p>\n\n<pre><code>The operation: #&lt;Moped::Protocol::Query\n  @length=39\n  @request_id=5\n  @response_to=0\n  @op_code=2004\n  @flags=[]\n  @full_collection_name=\".urls\"\n  @skip=0\n  @limit=0\n  @selector={}\n  @fields=nil&gt;\n failed with error 13075: \"db name can't be empty\"\n</code></pre>\n\n<p>I also tested with the following configuration:</p>\n\n<pre><code>development:\n  uri: mongodb://[username]:[password]@flame.mongohq.com:27046/[database]\n</code></pre>\n\n<p>When the code gets to the create method of the urls_controller it fails at @url.save with the following error:</p>\n\n<pre><code>mongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:100:in `parse'\nmongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:61:in `create_session'\nmongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:43:in `default'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:109:in `default'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:354:in `__session__'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:199:in `mongo_session'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:157:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:25:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations.rb:26:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations/insert.rb:27:in `block in persist'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:25:in `block (2 levels) in  prepare'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:403:in `_run__2492706777632263523__create__3276423133299307975__callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_create_callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/callbacks.rb:95:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:24:in `block in prepare'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:403:in  `_run__2492706777632263523__save__3276423133299307975__callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_save_callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/callbacks.rb:95:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:23:in `prepare'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations/insert.rb:26:in `persist'\nmongoid (3.0.0.rc) lib/mongoid/persistence.rb:49:in `insert'\nmongoid (3.0.0.rc) lib/mongoid/persistence.rb:188:in `upsert'\napp/controllers/urls_controller.rb:46:in `block in create'\n</code></pre>\n\n<p>My assumption is that my mongoid.yml file is incorrect but I'm not sure how to get this to work.  Any thoughts?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13253893,"title":"Form not submitting to custom action","body":"<p>I'm still relatively new to Rails and have looked through many similar questions here, but none helped me thus far. So... I have a form that I'd like to send a simple email. It pops up in a Bootstrap modal and looks like:</p>\n\n<pre><code>.form-horizontal\n  = form_tag :url =&gt; { :action =&gt; :share_event }, remote: true, html: {\"data-type\" =&gt; :json} do\n    .control-group\n      = label_tag :to\n      = text_field_tag :to\n    .control-group\n      = label_tag :from\n      = text_field_tag :from\n    .control-group\n      = label_tag :subject\n      = text_field_tag :subject  \n    - hidden_field_tag :event_url, :value =&gt; url\n    .actions\n      = submit_tag 'share event', :class =&gt; \"btn btn-mini submit\"\n</code></pre>\n\n<p>and in my controller:</p>\n\n<pre><code>def share_event\n  @to = params[:to]\n  @from = params[:from]\n  @subject = params[:subject]\n  @url = params[:url]\n  respond_to do |format|\n    EventMailer.share_event(@to, @from, @subject, @url).deliver\n    redirect_to events_path, notice: 'Event sent'\n  end \nend\n\n  EventMailer.share_event(@to, @from, @subject, @url).deliver\nend\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :events do\n  post :share_event, :on =&gt; :collection\nend\n</code></pre>\n\n<p>The problem is when I submit it uses the 'create' action as opposed to 'share_event'. I've tried many approaches, but it keeps on using 'create'. Here are an extract from the logs:</p>\n\n<pre><code>Started POST \"/events?html%5Bdata-type%5D=json&amp;remote=true&amp;url=share_events_path\" for 41.134.48.225 at 2012-11-06 15:34:25 +0100\nProcessing by EventsController#create as HTML\nParameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"7/6pg9XX/N09qUB+SUlWOdpCsgPOAiXM+nC+mq6VtKE=\", \"to\"=&gt;\"to@example.com\", \"from\"=&gt;\"from@example.com\", \"subject\"=&gt;\"gfh\", \"event_url\"=&gt;\"{:value=&gt;\\\"http://events.example.com/events/3\\\"}\", \"commit\"=&gt;\"share event »\", \"html\"=&gt;{\"data-type\"=&gt;\"json\"}, \"remote\"=&gt;\"true\", \"url\"=&gt;\"share_events_path\"}\n</code></pre>\n\n<p>Any help/advice would be appreciated.</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","devise","ldap"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13226733,"title":"How to catch Ldap error and redirect to specified page when using Devise and devise_ldap_authenticatable","body":"<p>I would like to show my login page with error message like \"The system cannot log you on at this time. Please try again later\" when there is ldap error during the login process.</p>\n\n<p>Currently, I have used the custom_failure.rb approach as described in\n<a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Redirect-to-a-specific-page-when-the-user-can-not-be-authenticated\" rel=\"nofollow\">https://github.com/plataformatec/devise/wiki/How-To:-Redirect-to-a-specific-page-when-the-user-can-not-be-authenticated</a>\nand it is able to catch error like invalid username / password and I have redirected it to the login page\nshowing the error messages as desired without problem.\nBut this approach cannot catch the ldap errors.</p>\n\n<p>These ldap errors are shown as a very raw html page like the following:</p>\n\n<p>Errno::ETIMEDOUT in Devise::SessionsController#create</p>\n\n<p>A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. - connect(2)</p>\n\n<p>Rails.root: C:/extratxt/2.2.0/source/ruby/messaging\nApplication Trace | Framework Trace | Full Trace</p>\n\n<p>Request</p>\n\n<p>Parameters:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"user\"=&gt;{\"username\"=&gt;\"administrator\",\n \"password\"=&gt;\"[FILTERED]\",\n \"remember_me\"=&gt;\"0\"},\n \"commit\"=&gt;\"Sign in\"}\n</code></pre>\n\n<p>Show session dump</p>\n\n<p>Show env dump\nResponse</p>\n\n<p>Headers:</p>\n\n<p>None</p>\n\n<p>How can I prevent this and instead show my specified page (e.g. login page with my own error message) ? \nAny idea ? Thanks</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":32,"score":-3,"question_id":13253180,"title":"rails password recovery","body":"<p>How can I add password recovery to <a href=\"https://github.com/railstutorial/sample_app\" rel=\"nofollow\">sample_app</a> by Michael Hartl?</p>\n\n<p>Maybe someone has already done it.</p>\n"},{"tags":["mysql","ruby-on-rails","rspec","case-sensitive"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13203169,"title":"Case sensitivity in rspec mysql vs rails controller","body":"<p>I have a test for an index that filters on last name, the test is passing:</p>\n\n<pre><code>it \"finds transactions with a given customer last_name\" do\n  customer = create :customer, last_name: \"Merp\"\n  t2 = create :transaction, location_id: @location.id\n  t1 = create :transaction, location_id: @location.id, customer_id: customer.id\n  get :index, last_name: \"merp\"\n  assigns(:transactions).should eq [t1]\nend\n</code></pre>\n\n<p>Here is the important part of the controller for this question:     </p>\n\n<pre><code># =&gt; @filter = {:customers=&gt;{:last_name=&gt;\"merp\"}}\n# =&gt; @joins = [:customer]\n@transactions = Transaction\n  .joins(@joins)\n  .where(@filter)\n</code></pre>\n\n<p>But when I do the test manually in a development environment, it only returns for case sensitive matches (notice the test is not a case match).</p>\n\n<p>Why am I getting a passing test using non-case-sensitive searching while having the action fail on non-case-sensitive searches when I actually use the page?</p>\n"},{"tags":["ruby-on-rails","routes","ruby-on-rails-3.2","upgrading"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13253736,"title":"Ruby On Rails Upgrading to 3.2 causing $end error","body":"<p>I'm currently upgrading my application and after installing the latest rails v. I get this error:</p>\n\n<pre><code>.../config/routes.rb:47: syntax error, unexpected keyword_end, expecting $end\n</code></pre>\n\n<p>However I have looked and I don't have a missing end or a end to much in my routes.file?</p>\n\n<pre><code>Lensfinder::Application.routes.draw do\n\n  # replace devise_for :users with:\n  devise_for :users,  :controllers =&gt; { :registrations =&gt; \"users/registrations\" }\n\n  resources :comments\n\n  root :to =&gt; \"finder#index\"\n\n  resources :categories, :prices, :profiles, :finder, :users\n\n  resources :services, :only =&gt; [:index, :create]\n\n  resources :retailers, :path =&gt; \"linsbutiker\", do\n    member do\n      post :vote_up\n      post :vote_down\n    end\n  end\n\n  resources :products, :path =&gt; \"linser\"\n\n  match 'shipping_info' =&gt; 'finder#shipping_info'\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","vim"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":9622991,"title":"vim-ruby-debugger How to Set Up? \"Error detected..\"","body":"<p>With vim-ruby-debugger, I get the error below when running :Rdebugger with Rails 3 in Ubuntu in gvim</p>\n\n<p>What should my Gemfile look like</p>\n\n<ul>\n<li>do I remove ruby-debug19?</li>\n<li>do I add: gem 'ruby-debug-ide19', :require => 'ruby-debug-ide' </li>\n</ul>\n\n<p>Do I add anything to <code>~/.vimrc</code> ?</p>\n\n<p>Are there clear instructions anywhere?</p>\n\n<pre><code>Loading debugger...\nKilling server with pid 9628\nDebugger started\n127.0.0.1:39768 can not be opened\nError detected while processing function 168..164..&lt;SNR&gt;38_send_message_to_debugger\nline 33:\nSystemExit: (eval):34:in `exit': exit\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","rubygems","passenger","bundler"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":460,"score":1,"question_id":5103044,"title":"Bundler in production not ignoring the development and test gems","body":"<p>I have a couple of rails websites in production on a ubuntu webserver of ours..</p>\n\n<p>We're running Ubuntu 10.10 + Passenger and Apache.. and ruby enterprise edition version 1.8.7 (No RVM),</p>\n\n<p>I've been having a problem with bundler on both the sites.. </p>\n\n<p>Whenever i restart the app by touching restart.txt or by rebooting the server, The user sees an error saying passenger could not be started because it couldn't find nokogiri (a requirement of one of the test gems) so i try and run 'bundle install' which fails cause it tries to install nokogiri..</p>\n\n<p>I've tried running </p>\n\n<pre><code>bundle install --without development:test\n</code></pre>\n\n<p>And various other variations.. </p>\n\n<p>I think one of them worked until i restarted the app and we were back to square one again..</p>\n\n<p>So for the moment i resigned myself to commenting out all gems in the development and test group..</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks</p>\n\n<p>Daniel</p>\n\n<hr>\n\n<p>Oh i forgot to mention.. I'm deploying using capistrano :)</p>\n"},{"tags":["ruby-on-rails","actionmailer","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12151772,"title":"ActionMailer::Base.deliveries empty when using delayed_job","body":"<p>I'm using delayed_job to send emails in a Rails app and I'd like to test the email sending locally.  Normally what I do is just set the mailer config to :test and then take a peek at ActionMailer::Base.deliveries, but the problem is when I call MyMailer.delay.some_email instead of MyMailer.some_email.deliver, the email never gets added to deliveries.  I assume it's because I'm not longer calling \"deliver\", but you're not supposed to call \"deliver\" when using delayed_job.</p>\n\n<p>All my production emails work fine.  It's only the testing ones that don't.</p>\n\n<p>Thoughts?</p>\n"},{"tags":["ruby-on-rails","passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":18,"score":3,"question_id":13252755,"title":"Passenger stop to write log","body":"<pre><code>Started GET \"/home\" for 117.55.68.xxx at 2012-11-05 22:56:06 +0900\nProcessing by PageController#home as HTML\nParameters: {\"id\"=&gt;\"420\"}\n\n\nStarted POST \"/login\" for 61.211.5.107 at 2012-11-05 23:25:52 +0900\nProcessing by UsersController#login as HTML\nParameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"xxxxxxx=\", \"username\"=&gt;\"***DELETED***\", \"password\"=&gt;\"***DELETED***\", \"commit\"=&gt;\"login\"}\nRendered users/login.html.haml within layouts/application (6.7ms)\nCompleted 200 OK in 142ms (Views: 103.5ms | ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>I am using passenger 3.0.11.\nI have encountered the problem that the log is not written.\nIt's happen when the \"Completed\" is not output.\nAfter \"Completed\" is not output, log is not written for 20-40 minutes.</p>\n\n<p>Does anyone have idea?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":234,"score":0,"question_id":4261855,"title":"Putting Rails app on GAE","body":"<p>I am using Rails 2.3.4 on windows. What are the steps to put my rails application on google app engine and allow only authorized users to view it? </p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13253216,"title":"forem gem custom helper","body":"<p>How can i override link_to_latest_post helper?</p>\n\n<pre><code>def link_to_latest_post(topic)\n  post = relevant_posts(topic).last\n  text = \"#{time_ago_in_words(post.created_at)} #{t(\"ago_by\")} #{post.user}\"\n  link_to text, forem.forum_topic_path(post.topic.forum, post.topic, :anchor =&gt; \"post-#{post.id}\")\nend\n</code></pre>\n\n<p>I need to change the text inside the link\nto this:  </p>\n\n<pre><code>text = \"#{time_ago_in_words(post.created_at)} #{t(\"ago_by\")} #{post.user.person.fullname}\"\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13252846,"title":"Understanding sql queries fired by ActiveRecord","body":"<p>I have two tables one trip and one txns having one to many relationship in oracle db.\nWhen i fire the below query </p>\n\n<pre><code>Trip.where(\"upper(trips.domain) = 'FOOBAR.COM'  and txns.user_id = 50001 and txns.txn_type = '1'\").includes([:txns]).order('trips.created_at desc').limit(10).offset(0)\n</code></pre>\n\n<p>For this there were two queries in the sql log.</p>\n\n<pre><code>    Trip Load (4920.4ms)   SELECT * FROM (\n    SELECT raw_sql_.*, rownum raw_rnum_\n    FROM (SELECT DISTINCT \"TM\".\"TRIPS\".id, FIRST_VALUE(trips.created_at)\n OVER (PARTITION BY \"TM\".\"TRIPS\".id ORDER BY trips.created_at desc) AS alias_0__ FROM \"TM\".\"TRIPS\" LEFT OUTER JOIN \"TXNS\" ON \"TXNS\".\"TRIP_ID\" = \"TM\".\"TRIPS\".\"ID\"\n WHERE (upper(trips.domain) = 'FOOBAR.COM' and txns.txn_type = '1') \nORDER BY alias_0__ DESC) raw_sql_\n    )\n    WHERE raw_rnum_ between 1 and 10\n\n    SQL (186.2ms)  SELECT \"TM\".\"TRIPS\".\"ID\" AS t0_r0, \"TM\".\"TRIPS\".\"TRIP_REF\" AS t0_r1, \"TM\".\"TRIPS\".\"TRIP_NAME\" AS t0_r2, \n\"TM\".\"TRIPS\".\"START_DATE_TIME\" AS t0_r3, \"TM\".\"TRIPS\".\"END_DATE_TIME\" AS t0_r4, \"TM\".\"TRIPS\".\"AMOUNT\" AS t0_r5, \"TM\".\"TRIPS\".\"CREATED_AT\" AS t0_r6,\n \"TM\".\"TRIPS\".\"UPDATED_AT\" AS t0_r7, \"TM\".\"TRIPS\".\"USER_ID\" AS t0_r8, \n\"TM\".\"TRIPS\".\"BOOKING_STATUS\" AS t0_r9, \"TM\".\"TRIPS\".\"TRAVELLERS\" AS t0_r10, \n\"TM\".\"TRIPS\".\"USER_TRIP_NAME\" AS t0_r11, \"TM\".\"TRIPS\".\"CONTACT_DETAIL_ID\" AS t0_r12, \n\"TM\".\"TRIPS\".\"AIR\" AS t0_r13, \"TM\".\"TRIPS\".\"HOTEL\" AS t0_r14, \"TM\".\"TRIPS\".\"DOMAIN\" AS t0_r15, \"TM\".\"TRIPS\".\"TRAIN\" AS t0_r16, \"TM\".\"TRIPS\".\"TAGS\" AS t0_r17, \"TM\".\"TRIPS\".\"CURRENCY\" AS t0_r18, \"TM\".\"TRIPS\".\"CUR_INR_VALUE\" AS t0_r19, \n\"TM\".\"TRIPS\".\"COMPANY_ID\" AS t0_r20, \"TXNS\".\"ID\" AS t1_r0, \"TXNS\".\"TRIP_ID\" AS t1_r1,\n \"TXNS\".\"USER_ID\" AS t1_r2, \"TXNS\".\"TXN_TYPE\" AS t1_r3, \"TXNS\".\"STATUS\" AS t1_r4, \"TXNS\".\"SOURCE_TYPE\" AS t1_r5, \"TXNS\".\"SOURCE_ID\" AS t1_r6, \"TXNS\".\"EXTERNAL_REFS\" AS t1_r7, \"TXNS\".\"CREATED_AT\" AS t1_r8, \"TXNS\".\"IP_NUMBER\" AS t1_r9, \"TXNS\".\"MISC\" AS t1_r10 FROM \"TM\".\"TRIPS\" LEFT OUTER JOIN \"TXNS\" ON \"TXNS\".\"TRIP_ID\" = \"TM\".\"TRIPS\".\"ID\" WHERE \"TM\".\"TRIPS\".\"ID\" IN (11620660, 11620651, 11620649, 11620647, 11620646, 11620645, 11620644, 11620642, 11620641, 11620636) AND (upper(trips.domain) = 'FOOBAR.COM' and txns.txn_type = '1') ORDER BY trips.created_at desc\n</code></pre>\n\n<p>I want to know why does active record fire two queries</p>\n"},{"tags":["ruby-on-rails","osx","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13247502,"title":"uninitialized constant when migrating rails from ubuntu to osx","body":"<p>i'm trying to move my rails app from ubuntu to osx. when running rspec, i get the following obscure error:</p>\n\n<pre><code>/Users/josh/dev/myproject/spec/support/devise.rb:3:in `block in &lt;top (required)&gt;': uninitialized constant RequestHelpers (NameError)\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core.rb:92:in `configure'\n    from /Users/josh/dev/myproject/spec/support/devise.rb:1:in `&lt;top (required)&gt;'\n    from /Users/josh/dev/myproject/spec/spec_helper.rb:21:in `block (2 levels) in &lt;top (required)&gt;'\n    from /Users/josh/dev/myproject/spec/spec_helper.rb:21:in `each'\n    from /Users/josh/dev/myproject/spec/spec_helper.rb:21:in `block in &lt;top (required)&gt;'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/spork-0.9.2/lib/spork.rb:24:in `prefork'\n    from /Users/josh/dev/myproject/spec/spec_helper.rb:4:in `&lt;top (required)&gt;'\n    from /Users/josh/dev/myproject/spec/controllers/comments_controller_spec.rb:1:in `require'\n    from /Users/josh/dev/myproject/spec/controllers/comments_controller_spec.rb:1:in `&lt;top (required)&gt;'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `load'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `block in load_spec_files'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `map'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/configuration.rb:780:in `load_spec_files'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/command_line.rb:22:in `run'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:66:in `rescue in run'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:62:in `run'\n    from /Users/josh/.rvm/gems/ruby-1.9.3-p286@myproject/gems/rspec-core-2.11.1/lib/rspec/core/runner.rb:8:in `block in autorun'\n</code></pre>\n\n<p>everything works nicely in Ubuntu, so i guess it must be environmental. Any ideas where to start digging?</p>\n\n<p>thanks\n- Josh</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13249544,"title":"why run rails command from an rails application directory and non-rails directory differs?","body":"<p>a silly question:</p>\n\n<p>when i run rails in an rails app , it shows</p>\n\n<pre><code>Usage: rails COMMAND [ARGS]\n\nThe most common rails commands are:\ngenerate    Generate new code (short-cut alias: \"g\")\n.....\n</code></pre>\n\n<p>but outside from rails app, it shows:</p>\n\n<pre><code>Usage:\nrails new APP_PATH [options]\n\nOptions:\n -r, [--ruby=PATH]              # Path to the Ruby binary of your choice\n .....\n</code></pre>\n\n<p>why ?</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13242315,"title":"Rails remote forms validation","body":"<p>Just a simple question I have followed the railscast -> <a href=\"http://railscasts.com/episodes/136-jquery-ajax-revised\" rel=\"nofollow\">http://railscasts.com/episodes/136-jquery-ajax-revised</a></p>\n\n<p>Its nice how for remote true works, but how I cna validate the model ? </p>\n\n<p>I have this one</p>\n\n<pre><code>&lt;%= form_for [:admin,@course], remote: true  do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title, \"The title:\" %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :description, \"Descripcion:\" %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :description %&gt;\n &lt;/div&gt;\n &lt;div class=\"actions\"&gt;\n   &lt;%= f.submit \"Send\"%&gt;\n &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How I handle te error ??</p>\n\n<pre><code>def create\n\n  @course = Course.new(params[:course])\n\n  respond_to do |format|\n    if @course.save\n      format.html { redirect_to admin_index_url, :notice=&gt; 'Done !!' }\n      format.js\n    else\n      format.html { flash.now[:alert] = \"Not done\" \n                    render \"new\"\n                  }\n      format.js\n    end\n  end        \nend\n</code></pre>\n\n<p>any ideas why this dont works ??</p>\n"},{"tags":["ruby-on-rails","layout","routing","jplayer"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13246405,"title":"jPlayer javascript in Rails layout is causing Routing Error","body":"<p>I'm trying to use jPlayer to play an mp3. I have the jPlayer CSS and images working, now it's just a matter of playing the mp3. To do so, I include the following javascript in the application.html.erb layout's head:</p>\n\n<pre><code>  &lt;script type=\"text/javascript\"&gt;\n  $(document).ready(function(){\n    $(\"#jquery_jplayer_1\").jPlayer({\n      ready: function () {\n        $(this).jPlayer(\"setMedia\", {\n             mp3: \"media/sound.mp3\",\n          // m4a: \"http://www.jplayer.org/audio/m4a/Miaow-07-Bubble.m4a\",\n          // oga: \"http://www.jplayer.org/audio/ogg/Miaow-07-Bubble.ogg\"\n        });\n      },\n      swfPath: \"/javascripts\",\n      supplied: \"mp3, m4a, oga\"\n    });\n  });\n</code></pre>\n\n<p></p>\n\n<p>When I load the page and click the play button, I get the following routing error:</p>\n\n<pre><code>ActionController::RoutingError (No route matches [GET] \"/calls/media/sound.mp3\")\n</code></pre>\n\n<p>Would someone mind taking a spare minute to explain to me why this is? Should I be including the javascript in something like this?</p>\n\n<pre><code>&lt;%= javascript_tag 'some js code' %&gt;\n</code></pre>\n\n<p>Any assistance is very much appreciated. Thanks in advance.</p>\n"},{"tags":["jquery","ruby-on-rails","autocomplete","duplicate-removal"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12993965,"title":"Rails Autocomplete Jquery (crowdint): select .uniq not working in scope, avoiding duplicates","body":"<p>Companies can be autocompleted by looking up the entries which I already have.\nUsing the <a href=\"https://github.com/crowdint/rails3-jquery-autocomplete\" rel=\"nofollow\">https://github.com/crowdint/rails3-jquery-autocomplete</a> gem, I have added</p>\n\n<pre><code>autocomplete :company, :name, :scopes =&gt; [:distinct]\n</code></pre>\n\n<p>to my controller and in my model I have:</p>\n\n<pre><code>scope :distinct, lambda { select(\"companies.name\").uniq }\n</code></pre>\n\n<p>Using the term \"Merce\" my system still returns all 5 entries for Mercedes Benz. SQL:</p>\n\n<pre><code>35mCompany Load (4.0ms)[0m  SELECT DISTINCT companies.name, companies.id FROM \"companies\" WHERE (LOWER(companies.name) ILIKE 'merce%') ORDER BY companies.name ASC LIMIT 10\n</code></pre>\n\n<p>Various things I tried: </p>\n\n<pre><code>select(:name).uniq  =&gt; Not unique values\ndistinct(\"companies.name\") =&gt; Wrong number of arguments\ngroup(:id, :name) =&gt; Not unique values\ngroup(:id, :name).uniq  =&gt; Not unique values\n</code></pre>\n\n<p>However, using the select statement in the controller (without autocomplete) works:</p>\n\n<pre><code>@companies = Company.select(:name).uniq =&gt; Perfect results\n</code></pre>\n\n<p>Looking for an explanation as to how to make the correct query within this gem. </p>\n"},{"tags":["javascript","jquery","ruby-on-rails","coffeescript"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13251321,"title":"HTML object vs. jQuery object","body":"<p>I'm a CoffeeScript and JavaScript novice.</p>\n\n<p>Working here is with a blank Rails 3.2.8 app.<br>\nHere is the straight layout code:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n      &lt;title&gt;Editor&lt;/title&gt;\n      &lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n      &lt;%= csrf_meta_tags %&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;%= yield %&gt;\n      &lt;%= javascript_include_tag \"application\" %&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Could not be more simple, right? Now the view for the form:</p>\n\n<pre><code>&lt;%= form_for(@note) do |f| %&gt;\n  &lt;% if @note.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@note.errors.count, \"error\") %&gt; prohibited this note from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @note.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_area :body, class: 'tkh-editable' %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>While researching this topic I saw that many coders had problems with jQuery being loaded twice or in the wrong order.<br>\nHere are the non-comments in my application.js manifest file:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require tkh_editor/tkh_editor\n</code></pre>\n\n<p>In the tkh_editor.js.coffee file, if I just put this code, it works just fine:</p>\n\n<pre><code>jQuery -&gt;\n  $(\".tkh-editable\").css(\"border\",\"solid 5px red\")\n</code></pre>\n\n<p>It adds a border around my textarea field with the class above.<br>\nI'm trying to create a plugin and I'm stuck at step 1.</p>\n\n<p>Why is the following code not working?</p>\n\n<pre><code>jQuery.fn.extend\n  tkhEditor: -&gt;\n    return @each -&gt;\n      this.css(\"border\",\"solid 5px red\")\n\njQuery -&gt;\n  $(\".tkh-editable\").tkhEditor()\n</code></pre>\n\n<p>The Chrome console gives me the following error:</p>\n\n<blockquote>\n  <p>Uncaught TypeError: Object # has no method 'css'</p>\n</blockquote>\n\n<p>Please help and explain what I'm doing wrong.</p>\n"},{"tags":["javascript","ruby-on-rails","gem","twitter-bootstrap-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13250854,"title":"a little code confuse me in this gem ---- backbone-bootstrap-rails","body":"<p>in bootstrap.js.coffee ,there are some code:</p>\n\n<pre><code>define [], -&gt;\n  App =\n    Models: {}\n    Collections: {}\n    Routers: {}\n    Helpers: {}\n    Views: {\n      Posts: {}\n      Common: {}\n      Sessions: {}\n      Tokens: {}\n      Passwords: {}\n      Confirmations: {}\n    }\n</code></pre>\n\n<p>i dont understand why the \"define\" method is in the js code??\nand more , in other code ,this \"define\" method uses everywhere!</p>\n\n<p>assets/javascripts/models/post.js.coffee</p>\n\n<pre><code>define ['backbone', 'bootstrap'], (Backbone, App) -&gt;\n  class App.Models.Post extends Backbone.Model\n    paramRoot: 'post'\n    urlRoot: '/posts'\n\n    defaults:\n      title: null\n      content: null\n</code></pre>\n\n<p>i want to know the method --- \"define\" , what do the method do , why i cant find where the method details to write??</p>\n\n<p>thanks !</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","scopes"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13251468,"title":"rails 3 scopes inherited from other models","body":"<p>is there any way to use one model scopes as part of another model scope?</p>\n\n<p>Example</p>\n\n<pre><code>class DocumentVersion &lt; ActiveRecord::Base\n  belongs_to :document\n  scope :are_latest, lambda{ where(latest: true)}\nend\n\nclass Document &lt; ActiveRecord::Base\n  has_many :document_versions\n  scope :are_latest, lambda { ...something... } # I want something that will get documents that have documnet_versions that are_latest\n\n  # I know I can do this \n  scope :are_latest,   lambda{ joins(:document_versions).where('document_versions.latest = true') }  # this works well\n\n  # but I would like to keep that condition its own model\n  scope :are_latest, lambda { joins(:document_versions).are_latest } # this wont obviously work, but something like that \n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","gem","rails-migrations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13243160,"title":"MIgration defined in gem not being executed","body":"<p>I added a new migration to (an existing) gem and when running the <em>rake db:migrate</em> command the migration is completely ignored. I tried forcing it to be run using <em>rake db:migrate:redo VERSION=[my migration version]</em> but it reports it cannot find the migration with that version.</p>\n\n<p>I'm using ruby 1.9.2p320 with rails 3.1.3 and there shouldn't be a problem with having the wrong gem version as I'm using it directly from the file system (though I've tried installing / updating through bundle).</p>\n\n<p>Also, I'm not sure if defining migrations on a gem is the right approach, but since this lib is highly coupled with the rails site and specially since it's <strong>legacy code</strong>, I won't move this away unless it's absolutely necessary.</p>\n\n<p><strong>EDIT:</strong>\nThe migrations in the gem are defined as they're usually defined in any rails app:</p>\n\n<pre><code>gem_folder\n   |\n   |- db\n  ...  |\n       |- migrate\n            |\n            |- &lt;migration files&gt;\n                     ...\n</code></pre>\n"},{"tags":["ruby-on-rails","activeadmin"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13251559,"title":"Rails3 Active Admin - How to filter only records that meet all checked items in collection","body":"<p>I have a one-to-many associaton of user to network model. The relevant parts of my schema information is as follows.</p>\n\n<pre><code># == Schema Information      \n# Table name: users\n#\n#  id                     :integer         not null, primary key\n#  name                   :string(255)\n\n#\n# Table name: networks\n#\n#  id         :integer         not null, primary key\n#  user_id    :integer\n#  uid        :string(255)\n#  name   :string(255)\n#  pub_url    :string(255)\n</code></pre>\n\n<p>I want to filter out users who have specific multiple networks using the name property of the network model. For example if I check facebook and foursquare as filters, I want to get back users who have connected both facebook and foursquare. My current implementation is to pass an array containing the names of networks a user can add as displayed below.</p>\n\n<pre><code>filter :networks_name, :as =&gt; :check_boxes,\n:collection =&gt; %w(facebook twitter foursquare linkedin)\n</code></pre>\n\n<p>This however uses an OR condition for the filters which retrieves users with any of the checked items. What I actually want to get is users who meet all the checked items.\nWhat's the right way of achieving this?</p>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":210,"score":1,"question_id":7286589,"title":"Heroku Rails app v 1.2.6 failed to push: unrecognized error","body":"<p>I get this error when trying to push a Rails app v. 1.2.6 to Heroku:</p>\n\n<pre><code> !     Heroku push rejected due to an unrecognized error.\n !     We've been notified, see http://support.heroku.com if the problem persist\ns.\n\n\nTo git@heroku.com:myproject.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'git@heroku.com:myproject.git'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13251054,"title":"How do I include the user objects n the json result?","body":"<pre><code>@song.likes.select('likes.*, users.*').includes(:user).to_json \n</code></pre>\n\n<p>Only converts the like objects. Is there a way to include the user objects in the json result? Via Ruby or other.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13239046,"title":"RoR Heroku deploy error","body":"<p>When I run \"<code>$ git push heroku</code>\",</p>\n\n<p>I get the following before the \"Heroku receiving push\" message.</p>\n\n<blockquote>\n  <p>Davids-iMac:requestsys burtondav$ git push heroku key_read: uudecode\n  AAAAB3NzaC1yc2EAAAABIwAAAQEAu8erSx6jh+8ztsfHwkNeFr/SZaSOcvoa8AyMpaerGIPZDB2TKNgNkMSYTLYGDK2ivsqXopo2W7dpQRBIVF80q9mNXy5tbt1WE04gbOBB26Wn2hF4bk3Tu+BNMFbvMjPbkVlC2hcFuQJdH4T2i/dtauyTpJbD/6ExHR9XYVhdhdMs0JsjP/Q5FNoWh2ff9YbZVpDQSTPvusUp4liLjPfa/i0t+2LpNCeWy8Y+V9gUlDWiyYwrfMVI0UwNCZZKHs1Unpc11/4HLitQRtvuk0Ot5qwwBxbmtvCDKZvj1aFBid71/mYdGRPYZMIxq1zgP1acePC1zfTG/lvuQ7d0Pe0kaw==184.72.93.56\n  ssh-rsa\n  AAAAB3NzaC1yc2EAAAADAQABAAABAQDoIUvF+Ac8P1hbg/FQFD+uP1Ds4opJWbJLM/+Jm8VmcJ6CnAW7OuT9cCabSGmPQrehV5KyWJ341YXu1m2c8VJe7k5KEfKWqm03NONwi6b9TeNa3WfIlACgulE9u7A9CJW1N8ntdk32PHzyWzvHU7llTGf4Mcnf81s6N+2frq6aoT4oRPkwWcFIRclpqMZZSDGPx27OctAsCm88EBt02fIwxuqOCzTEyVadvr3YHhWzkK5NBdG0NxxFoZ7qD7bCxO9yIwf7itsVn+8n0cgfK2etdWmTJ7z2JWIbHrk/qRVpHl2GoQqjyvoIVVOTUYCL6QMsFG29jVc1L9yo4yXlFlNj\n  failed key_read: uudecode\n  AAAAB3NzaC1yc2EAAAABIwAAAQEAu8erSx6jh+8ztsfHwkNeFr/SZaSOcvoa8AyMpaerGIPZDB2TKNgNkMSYTLYGDK2ivsqXopo2W7dpQRBIVF80q9mNXy5tbt1WE04gbOBB26Wn2hF4bk3Tu+BNMFbvMjPbkVlC2hcFuQJdH4T2i/dtauyTpJbD/6ExHR9XYVhdhdMs0JsjP/Q5FNoWh2ff9YbZVpDQSTPvusUp4liLjPfa/i0t+2LpNCeWy8Y+V9gUlDWiyYwrfMVI0UwNCZZKHs1Unpc11/4HLitQRtvuk0Ot5qwwBxbmtvCDKZvj1aFBid71/mYdGRPYZMIxq1zgP1acePC1zfTG/lvuQ7d0Pe0kaw==184.72.93.56\n  ssh-rsa\n  AAAAB3NzaC1yc2EAAAADAQABAAABAQDoIUvF+Ac8P1hbg/FQFD+uP1Ds4opJWbJLM/+Jm8VmcJ6CnAW7OuT9cCabSGmPQrehV5KyWJ341YXu1m2c8VJe7k5KEfKWqm03NONwi6b9TeNa3WfIlACgulE9u7A9CJW1N8ntdk32PHzyWzvHU7llTGf4Mcnf81s6N+2frq6aoT4oRPkwWcFIRclpqMZZSDGPx27OctAsCm88EBt02fIwxuqOCzTEyVadvr3YHhWzkK5NBdG0NxxFoZ7qD7bCxO9yIwf7itsVn+8n0cgfK2etdWmTJ7z2JWIbHrk/qRVpHl2GoQqjyvoIVVOTUYCL6QMsFG29jVc1L9yo4yXlFlNj\n  failed Counting objects: 15, done. Delta compression using up to 4\n  threads. Compressing objects: 100% (7/7), done. Writing objects: 100%\n  (8/8), 1.03 KiB, done. Total 8 (delta 6), reused 0 (delta 0)</p>\n</blockquote>\n\n<p>Any idea what this means?</p>\n\n<p>Thanks!!</p>\n"},{"tags":["ruby-on-rails","rspec","ruby-on-rails-3.2","capybara"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13249483,"title":"Rspec testing for iframe content","body":"<p>How can i write rspec testing for Iframe content? my Iframe look like</p>\n\n<pre><code>&lt;iframe src=\"/any url\" name=\"Original\"&gt;\n   ...\n   &lt;div&gt;test &lt;/div&gt;\n&lt;/iframe&gt;\n</code></pre>\n\n<p>in between iframe whatever content, I want to write rspec test case for that content. How can i do ?</p>\n\n<p>how can i check \"test\" is in iframe using rspec ? I write below but not pass</p>\n\n<pre><code>page.should have_content(\"test\")\n</code></pre>\n\n<p><strong>error like</strong></p>\n\n<pre><code>Failure/Error: page.should have_content(\"test\")\n       expected there to be content \"test\" in \"Customize .... \n</code></pre>\n\n<p>I use capybara - 1.1.2 and rspec - 2.11.0 and rails 3.2.8</p>\n"},{"tags":["ruby-on-rails","ruby","monitoring","foreman","monit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13250706,"title":"Monitoring rails and ruby processes with Monit?","body":"<p>I have a rails application with some independent ruby processes, I would like to monitore each process using Monit, now in usual cases I do that easily , like as for example if I wanna monitor memcahed server, I can create a conf file like : </p>\n\n<pre><code>check process memcached with pidfile /var/run/memcached.pid\n  start program = \"/etc/init.d/memcached start\"\n  stop program = \"/etc/init.d/memcached stop\"\n</code></pre>\n\n<p>But as for rails and ruby, it's different, I just don't know how to manage PIDs or even run the service in /etc/init.d. </p>\n\n<p>I tried to create it using foreman gem with export feature but it didn't work out for me . </p>\n\n<p>Please note , that I have 3 processes, one rails and two other ruby processes </p>\n\n<p>Any help would be highly appreciated </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","has-and-belongs-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13174104,"title":"Split a string and save with has_and_belongs_to_many association","body":"<p>I have a text_field which the user can type in Tags(Like the ones on stackoverflow). They can seperate the tags with a comma. Now, I know how to split the tags. But the n00b that I am I'm stuck at the next stage. I have a Tag table, a Trip table and a tags_trips in between(A trip can have multiple keywords, but I want the keywords unique in my database so when they exist they can be used again on other Trips).</p>\n\n<p>The real question is; After I've split the string, how can I check if the keyword exists and get the existing ID to be placed in my tags_trips table, and if it doesn't exist how do i get the array I've just split in my tags_trips table in one go?</p>\n\n<p>Here's an overview of my tables: </p>\n\n<pre><code>Trip\n:id =&gt; :integer,\n:title =&gt; :string,\n:description =&gt; :text,\n:user_id =&gt; :integer,\n:created_at =&gt; :datetime,\n:updated_at =&gt; :datetime\n\nTag\n:id =&gt; :integer,\n:title =&gt; :string,\n:created_at =&gt; :datetime,\n:updated_at =&gt; :datetime\n\ntags_trip\n:tag_id =&gt; :integer,\n:trip_id =&gt; :string\n</code></pre>\n\n<p>I'm using a <code>has_and_belongs_to_many</code> association between Tag and Trip in my models and get the text_field via <code>fields_for :tags</code> in my Trip form. (Note: The form works and I've managed to get the keywords string, as it is typed, into my Tag table! Just not split up ;-))</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","popover"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":552,"score":0,"question_id":11005990,"title":"Rails 3: Twitter-Bootstrap Tooltips Refuse to Work","body":"<p>This is driving me absolutely bonkers, and it seems like such a simple thing to implement. I can't get tooltips (or, for that matter, popovers) to work. I have the <strong>'twitter-bootstrap-rails' gem</strong> installed, and I generated the appropriate .js and .css files.</p>\n\n<p>I don't think it's a JQuery issue because I have other JQuery functionality on my site that works perfectly.</p>\n\n<p>Here's some relevant code.</p>\n\n<p><strong>application.js</strong></p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require twitter/bootstrap\n//= require bootstrap-tooltip\n//= require bootstrap-popover\n//= require prototype\n//= require prototype_ujs\n//= require effects\n//= require dragdrop\n//= require controls\n//= require_tree .\n$('a').tooltip();\n</code></pre>\n\n<p><strong>application.css</strong></p>\n\n<pre><code> *= require_self\n *= require_tree .\n *= reqire_twitter/bootstrap\n</code></pre>\n\n<p><strong>Code I'd like to get to work for tooltips</strong></p>\n\n<pre><code>&lt;a href=\"#\" title=\"test\" rel=\"tooltip\" id=\"test-url\"&gt;test&lt;/a&gt;\n</code></pre>\n\n<p>The above code, when hovered over, just shows Chrome's normal tooltip. I'm getting the same behavior in Safari, so I doubt it's browser-specific.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","logging","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13250665,"title":"how make log rotation rails 3.2.8 version","body":"<p>How can I make log rotation on my production env for rails version 3.2.8?</p>\n\n<p>I have taking a look to <a href=\"http://stackoverflow.com/questions/4883891/ruby-on-rails-production-log-rotation\">Ruby on Rails production log rotation</a>, but is for old rails version.</p>\n\n<p>I use nginx + unicorn</p>\n\n<p>Where can I find more info about this?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","declarative-authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13250518,"title":"declarative_authorization for field-level control","body":"<p>I want to restrict ability to change the <code>roles</code> field in the <code>user</code> model to a certain role. Of course I could use scoped mass assignment but is it actually possible to use <strong>declarative_authorization</strong> for securing individual fields?</p>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","rest","html-form"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13250502,"title":"Paste html form data into url","body":"<p>Assuming i have resource with 2 methods :show and :index. I need :index contain simple form with text field and submit button, when user insert data into text field, this data must be  inserted into url as :id of resource for :show method.</p>\n\n<p>for example page url looks like <code>/s</code> and when user type 123 into field in the form and press submit he must be redirected to <code>/s/123</code>. Can it be done with rails or html forms ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13250014,"title":"set up default routes to common dir","body":"<p>Assume you have a couple of ruby/rails apps running on a server</p>\n\n<p>APP ExmplA:\ndir: /foo/bar/ExmplA\nruns on <a href=\"http://example.com:4111/\" rel=\"nofollow\">http://example.com:4111/</a></p>\n\n<p>APP ExmplB:\ndir: /foo/bar/ExmplB\nruns on <a href=\"http://example.com:4112/\" rel=\"nofollow\">http://example.com:4112/</a></p>\n\n<p>APP ExmplC:\ndir: /foo/bar/ExmplC\nruns on <a href=\"http://example.com:4113/\" rel=\"nofollow\">http://example.com:4113/</a></p>\n\n<p>now i have a common dir\n/pool/common/http/\nwhere i want the default root-routes (\"/\") of the 3 apps to point to.</p>\n\n<p>…so \"http://example.com:4113/somedir/something.txt\" should map to \"/pool/common/http/somedir/something.txt\", if not specified otherwise.</p>\n\n<p>What should I enter in the routes.rb of the 3 Apps?</p>\n"},{"tags":["ruby-on-rails","ruby","enumeration"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":44,"score":2,"question_id":13249872,"title":"ruby's \"any?\" and \"all?\" methods behaviour on Empty Arrays and Hashes","body":"<p>First of all I found two useful articles in documentations about these methods:</p>\n\n<ul>\n<li><a href=\"http://www.ruby-doc.org/core-1.9.3/Enumerable.html\" rel=\"nofollow\">http://www.ruby-doc.org/core-1.9.3/Enumerable.html</a></li>\n<li><a href=\"http://www.globalnerdy.com/2008/01/29/enumerating-rubys-enumerable-module-part-1-all-and-any/\" rel=\"nofollow\">http://www.globalnerdy.com/2008/01/29/enumerating-rubys-enumerable-module-part-1-all-and-any/</a></li>\n</ul>\n\n<blockquote>\n  <p>all?: Passes each element of the collection to the given block. The method returns true if the block never returns false or nil.</p>\n  \n  <p>any?: Passes each element of the collection to the given block. The method returns true if the block ever returns a value other than false or nil. </p>\n</blockquote>\n\n<p>But in case of empty arrays and hashes I got:</p>\n\n<pre><code>irb(main):004:0&gt; [nil, \"car\", \"bus\"].all?\n=&gt; false\nirb(main):005:0&gt; [\"nil\", \"car\", \"bus\"].all?\n=&gt; true\nirb(main):006:0&gt; [].all?\n=&gt; true\nirb(main):007:0&gt; [\"nil\", \"car\", \"bus\"].any?\n=&gt; true\nirb(main):008:0&gt; [nil, \"car\", \"bus\"].any?\n=&gt; true\nirb(main):009:0&gt; [nil].any?\n=&gt; false\nirb(main):010:0&gt; [].any?\n=&gt; false\n</code></pre>\n\n<p>Can somebody explain to me why empty arrays give me <code>false</code> in case of the <code>any?</code> method and <code>true</code> in case of <code>all?</code>?</p>\n"},{"tags":["ruby-on-rails","paperclip"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":150,"score":3,"question_id":12793158,"title":"Paperclip Error: NotIdentifiedByImageMagickError","body":"<p>I've had a rails install with Paperclip working just fine for a while now and in a recent deploy it has broken.  I believe it coincided with a gemfile update, because nothing else on the machine has changed.  The error is:</p>\n\n<pre><code>Command :: file -b --mime :file\n[paperclip] Error while determining content type: Command 'file -b --mime :file' returned 1. Expected 0\n</code></pre>\n\n<p>This is on a png file that I've verified to be valid.  When I run 'file -b --mime' on the image I get:</p>\n\n<pre><code>image/png; charset=binary\n</code></pre>\n\n<p>I also get this afterwards:</p>\n\n<pre><code>Command :: identify -format %wx%h :file\n[paperclip] An error was received while processing: #&lt;Paperclip::Errors::NotIdentifiedByImageMagickError: /tmp/song_waveform_3010520121008-23335-165xag4.png20121008-23335-j8e18p is not recognized by the 'identify' command.&gt;\n</code></pre>\n\n<p>I did a which file and it gave me /usr/bin so I tried setting the Paperclip.options[:command_path] = \"/usr/bin/\" in production.rb with no change.</p>\n\n<p>I can't think of why this could be happening.  Perhaps it's not pointing to the right directory?  I'm a bit lost here.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":5,"up_vote_count":4,"down_vote_count":0,"view_count":2673,"score":4,"question_id":3801324,"title":"Rails 3 - time_ago_in_words says \"ABOUT 2 hours ago\"","body":"<p>Code:</p>\n\n<pre><code>&lt;%=\"#{time_ago_in_words(comment.created_at)} ago \"%&gt;\n</code></pre>\n\n<p>What i'd like is for it not to have \"ABOUT\" in front of the 2 hours ago, which shows up for hours but not for minutes...</p>\n\n<p>Is there another function or a way to remove it without finding and replacing?</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13226913,"title":"How do I select all records with more than n child records","body":"<p>For the situation where <code>Employee has_many Clients</code>, I am trying to write an ActiveRecord query that will return all of the Employees that have n or more clients. It's simple enough to write a join query to find all of the Employees with at least 1 client but extending my query to this more general case has left me stumped.</p>\n\n<p>Edit - I should add that I'm trying to do this entirely at the database level. I want to avoid iterating over the collection in Ruby.</p>\n"},{"tags":["ruby-on-rails","activerecord","migration"],"answer_count":3,"favorite_count":10,"up_vote_count":35,"down_vote_count":0,"view_count":14769,"score":35,"question_id":4954969,"title":"Rails 3 migrations: Adding reference column?","body":"<p>If I create a new rails 3 migration with (for example)</p>\n\n<pre><code>rails g migration tester title:tester user:references\n</code></pre>\n\n<p>, everything works fine...however if I add a column with something along the lines of:</p>\n\n<pre><code>rails g migration add_user_to_tester user:references\n</code></pre>\n\n<p>the reference field is not recognised. In short, the question is: how do I add a referencing column to a rails migration from the command line?</p>\n"},{"tags":["ruby-on-rails","sitemap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":244,"score":0,"question_id":7117303,"title":"sitemap generator in rails with subdomains","body":"<p>I have a site with 1000s of user.\nand my site looks like <a href=\"http://username.site.com\" rel=\"nofollow\">http://username.site.com</a> .</p>\n\n<p>I verified that sitemap can have multiple domain names if they are verified.\n<a href=\"http://stackoverflow.com/questions/3880621/sitemap-for-a-site-with-a-large-number-of-dynamic-subdomains\">Sitemap for a site with a large number of dynamic subdomains</a></p>\n\n<p>I am using sitemap_generator plugin to generate sitemap. ( seems the most popular)</p>\n\n<p><a href=\"https://github.com/kjvarga/sitemap_generator\" rel=\"nofollow\">https://github.com/kjvarga/sitemap_generator</a></p>\n\n<p>I am forming the url in sitemap.rb as follows </p>\n\n<pre><code> User.find_each do |user|\nadd '/' , :lastmod =&gt; user.updated_at ,:host=&gt;\"http://\"+user.user_name+\".site.com\" ,:priority =&gt; 0.8\nend\n</code></pre>\n\n<p>The username also contains \"_\" .. underscore</p>\n\n<p>so some url are formed as <a href=\"http://user_name_with_underscore.site.com\" rel=\"nofollow\">http://user_name_with_underscore.site.com</a> </p>\n\n<p>The sitemap generator throws error </p>\n\n<blockquote>\n  <p>the scheme http does not accept registry part:\n  user_name_with_underscore (or bad hostname?)</p>\n</blockquote>\n\n<p>Now how do I get past this problem ??</p>\n\n<p>And  is '_' a bad idea in subdomains ?</p>\n"},{"tags":["ruby-on-rails","ruby","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13241481,"title":"In form sorting using ransack gem not working","body":"<p>I've been trying (unsuccessfully so far) to use the out of the box in-form sorting provided by the ransack gem, and the result of it unfortunately is an empty form.</p>\n\n<p><strong>Here's what I've done so far:</strong></p>\n\n<pre><code>Controller:\n    class LandingController &lt; ApplicationController\n      layout \"landing2\"\n      def index\n        @zones = Zone.all\n        @zone_id ||= 1\n        @q = Property.search(params[:q])\n        @q.build_sort if @q.sorts.empty?\n      end\n    end\n</code></pre>\n\n<p><strong>View (partial):</strong></p>\n\n<pre><code>&lt;%= search_form_for @q, :url =&gt; home_path, :html =&gt; { :method =&gt; :get } do |f| %&gt;\n  &lt;%= f.sort_fields do |s| %&gt;\n    &lt;%= s.sort_select %&gt;\n  &lt;% end %&gt;\n  &lt;%= f.submit \"Sort\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>And the result is:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/Ibnzg.jpg\" alt=\"Ransack sort form(empty)\"></p>\n\n<p>Does anybody know what could possibly be wrong?</p>\n\n<p>Thanks for all the help!</p>\n"},{"tags":["ruby-on-rails","osx","poppler"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13249588,"title":"Issues while installing Poppler on mac","body":"<p>I'm trying to make Docsplit work in Ruby on Rails, so i followed the steps in the doc. I'm using brew but i have errors while installing Poppler.</p>\n\n<p>Here is the make log where the errors start to occur</p>\n\n<pre><code>SplashFTFont.cc:33:22: error: ft2build.h: No such file or directory\nSplashFTFont.cc:34:10: error: #include expects \"FILENAME\" or &lt;FILENAME&gt;\nSplashFTFont.cc:35:10: error: #include expects \"FILENAME\" or &lt;FILENAME&gt;\nSplashFTFont.cc:36:10: error: #include expects \"FILENAME\" or &lt;FILENAME&gt;\nIn file included from SplashFTFont.cc:41:\nSplashFTFontEngine.h:34:10: error: #include expects \"FILENAME\" or &lt;FILENAME&gt;\nIn file included from SplashFTFont.cc:42:\nSplashFTFontFile.h:31:10: error: #include expects \"FILENAME\" or &lt;FILENAME&gt;\nIn file included from SplashFTFont.cc:43:\nSplashFTFont.h:35:10: error: #include expects \"FILENAME\" or &lt;FILENAME&gt;\nIn file included from SplashFTFont.cc:41:\nSplashFTFontEngine.h:64: error: 'FT_Library' has not been declared\nSplashFTFontEngine.h:69: error: 'FT_Library' does not name a type\nIn file included from SplashFTFont.cc:42:\nSplashFTFontFile.h:70: error: 'FT_Face' has not been declared\nSplashFTFontFile.h:75: error: 'FT_Face' does not name a type\nIn file included from SplashFTFont.cc:43:\nSplashFTFont.h:69: error: 'FT_Size' does not name a type\nSplashFTFont.h:70: error: 'FT_Matrix' does not name a type\n</code></pre>\n\n<p>Thanks for any help you can give me.</p>\n"},{"tags":["ruby-on-rails","ruby","twitter","hash","gem"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13248874,"title":"Can't parse hash from twitter gem","body":"<p>I have the gem working: can tweet from it and pull in info. </p>\n\n<p>I can grab this hash and print out the .text part of it but I can't figure out how to get the id_str and screen_name - info I really need to parse out.</p>\n\n<p>Not sure what i'm doing wrong. </p>\n\n<pre><code>  &lt;% Twitter.mentions_timeline.each do |mention| %&gt;\n      &lt;%= mention.text %&gt; &lt;%# dies on some of em, like mention.id_str - not sure why %&gt;\n      &lt;br /&gt;&lt;hr /&gt;         \n  &lt;% end %&gt;\n</code></pre>\n\n<p>Below is Twitter.mentions_timeline hash:</p>\n\n<pre><code>[#&lt;Twitter::Tweet:0x007fd070de24a0 \n\n\n\n\n@attrs={\n    :in_reply_to_status_id_str=&gt;\"265276218855809024\", \n    :retweet_count=&gt;0, \n    :contributors=&gt;nil, \n    :truncated=&gt;false, \n    :text=&gt;\"@doodleboots http://t.co/VJOR0MgQ\", \n    :in_reply_to_user_id_str=&gt;\"119208666\", \n    :geo=&gt;nil, \n    :retweeted=&gt;false, \n    :possibly_sensitive=&gt;false, \n    :in_reply_to_screen_name=&gt;\"doodleboots\", \n    :id_str=&gt;\"265276345704124416\", \n    :entities=&gt;{:hashtags=&gt;[], \n        :urls=&gt;[{:display_url=&gt;\"is.gd/S3uOyu\", \n        :indices=&gt;[13, 33], \n        :expanded_url=&gt;\"http://is.gd/S3uOyu\", \n        :url=&gt;\"http://t.co/VJOR0MgQ\"}], \n        :user_mentions=&gt;[{:name=&gt;\"doodle\", \n        :indices=&gt;[0, 12], \n        :screen_name=&gt;\"doodleboots\", \n        :id_str=&gt;\"119208666\", \n        :id=&gt;119208666}]}, \n        :in_reply_to_user_id=&gt;119208666, \n        :in_reply_to_status_id=&gt;265276218855809024, \n        :created_at=&gt;\"Mon Nov 05 02:16:24 +0000 2012\", \n        :place=&gt;nil, \n        :user=&gt;{:profile_image_url_https=&gt;\"https://si0.twimg.com/profile_images/2808322935/d5da93a06dbd45959cb4dba0797689a5_normal.jpeg\", \n        :id=&gt;926557182, \n        :profile_background_image_url=&gt;\"http://a0.twimg.com/images/themes/theme1/bg.png\", \n        :entities=&gt;{:description=&gt;nil}, \n        :screen_name=&gt;\"Roslyn1bdzn\", \n        :profile_link_color=&gt;\"0084B4\", \n        :default_profile_image=&gt;false, \n        :created_at=&gt;\"Mon Nov 05 01:17:20 +0000 2012\", \n        :contributors_enabled=&gt;false, \n        :friends_count=&gt;0, \n        :time_zone=&gt;nil, \n        :favourites_count=&gt;0, \n        :utc_offset=&gt;nil, \n        :profile_use_background_image=&gt;true, \n        :url=&gt;nil, :geo_enabled=&gt;false, \n        :lang=&gt;\"en\", \n        :profile_image_url=&gt;\"http://a0.twimg.com/profile_images/2808322935/d5da93a06dbd45959cb4dba0797689a5_normal.jpeg\", \n        :profile_text_color=&gt;\"333333\", \n        :name=&gt;\"Roslyn Montalbo \", \n        :profile_background_image_url_https=&gt;\"https://si0.twimg.com/images/themes/theme1/bg.png\", \n        :description=&gt;\"Amateur social media scholar. Friend of animals everywhere. Explorer. Unapologetic twitter advocate. Incurable travel geek. Writer\", \n        :protected=&gt;false, \n        :profile_sidebar_border_color=&gt;\"C0DEED\", \n        :followers_count=&gt;0, \n        :default_profile=&gt;true, \n        :profile_background_tile=&gt;false, \n        :location=&gt;\"Dublin\", \n        :profile_sidebar_fill_color=&gt;\"DDEEF6\", \n        :following=&gt;false, \n        :statuses_count=&gt;3, \n        :follow_request_sent=&gt;false, \n        :listed_count=&gt;0, \n        :id_str=&gt;\"926557182\", \n        :profile_background_color=&gt;\"C0DEED\", \n        :notifications=&gt;false, \n        :verified=&gt;false, \n        :is_translator=&gt;false}, \n        :coordinates=&gt;nil, \n        :source=&gt;\"web\", \n        :favorited=&gt;false, \n        :id=&gt;265276345704124416}&gt;,\n\n\n\n#&lt;Twitter::Tweet:0x007fd070de2478 \n\n    @attrs={:in_reply_to_status_id_str=&gt;nil,\n    :retweet_count=&gt;0, \n    :contributors=&gt;nil, \n    :truncated=&gt;false, \n    :text=&gt;\"test post @doodleboots\", \n    :in_reply_to_user_id_str=&gt;nil, \n    :geo=&gt;nil, \n    :retweeted=&gt;false, \n    :in_reply_to_screen_name=&gt;nil,  \n    :id_str=&gt;\"247909685582233600\", \n    :entities=&gt;{:hashtags=&gt;[], \n        :urls=&gt;[], \n        :user_mentions=&gt;[{:name=&gt;\"doodle\", \n            :indices=&gt;[10, 22], \n            :screen_name=&gt;\"doodleboots\", \n            :id_str=&gt;\"119208666\", \n            :id=&gt;119208666}]}, \n            :in_reply_to_user_id=&gt;nil, \n            :in_reply_to_status_id=&gt;nil, \n            :created_at=&gt;\"Tue Sep 18 04:07:29 +0000 2012\", \n            :place=&gt;nil, \n            :user=&gt;{:profile_image_url_https=&gt;\"https://si0.twimg.com/profile_images/728693845/doodleBootsIcon_normal.png\", \n            :id=&gt;119208666, \n            :profile_background_image_url=&gt;\"http://a0.twimg.com/images/themes/theme1/bg.png\", \n            :entities=&gt;{:description=&gt;{\n                :urls=&gt;[]}, \n                :url=&gt;{:urls=&gt;[{\n                    :display_url=&gt;nil, \n                    :indices=&gt;[0, 22], \n                    :expanded_url=&gt;nil, \n                    :url=&gt;\"http://doodleboots.com\"}]}}, \n                    :screen_name=&gt;\"doodleboots\", \n                    :profile_link_color=&gt;\"0084B4\", \n                    :default_profile_image=&gt;false, \n                    :created_at=&gt;\"Wed Mar 03 00:09:50 +0000 2010\", \n                    :contributors_enabled=&gt;false, \n                    :friends_count=&gt;16, \n                    :time_zone=&gt;nil, \n                    :favourites_count=&gt;0, \n                    :utc_offset=&gt;nil, \n                    :profile_use_background_image=&gt;true, \n                    :url=&gt;\"http://doodleboots.com\", \n                    :geo_enabled=&gt;false, \n                    :lang=&gt;\"en\", \n                    :profile_image_url=&gt;\"http://a0.twimg.com/profile_images/728693845/doodleBootsIcon_normal.png\", \n                    :profile_text_color=&gt;\"333333\", \n                    :name=&gt;\"doodle\", \n                    :profile_background_image_url_https=&gt;\"https://si0.twimg.com/images/themes/theme1/bg.png\", \n                    :description=&gt;\"Take a pic of a drawing/doodle and tweet it @doodleboots! It will be re-tweeted and posted to the website for all to see.\", \n                    :protected=&gt;false, \n                    :profile_sidebar_border_color=&gt;\"C0DEED\", \n                    :followers_count=&gt;14, \n                    :default_profile=&gt;true, \n                    :profile_background_tile=&gt;false, \n                    :location=&gt;\"\", \n                    :profile_sidebar_fill_color=&gt;\"DDEEF6\", \n                    :following=&gt;false, \n                    :statuses_count=&gt;16, \n                    :follow_request_sent=&gt;false, \n                    :listed_count=&gt;1, \n                    :id_str=&gt;\"119208666\", \n                    :profile_background_color=&gt;\"C0DEED\", \n                    :notifications=&gt;false, \n                    :verified=&gt;false, \n                    :is_translator=&gt;false}, \n                    :coordinates=&gt;nil, \n                    :source=&gt;\"web\", \n                    :favorited=&gt;false, \n                    :id=&gt;247909685582233600}&gt;, \n</code></pre>\n"},{"tags":["sql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13248614,"title":"Providing a join count and total count in the same query with Active Record","body":"<p>One <strong>style</strong> has many <strong>reviews</strong>.</p>\n\n<p>Let's say I am doing: </p>\n\n<pre><code>Style.select('styles.id').\n    joins(:reviews).\n    select('reviews.style_id, count(reviews.id) AS review_count')\n</code></pre>\n\n<p>... but I also want to know the total number of reviews! Is it possible to pull that information as well. I tried count(*) as total_reviews, but this still returns the review count per style.</p>\n"},{"tags":["ruby-on-rails","omniauth","facebook-oauth","facebook-login"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13247768,"title":"omniauth-facebook gives \"Error: An error occurred. Please try again later.\"","body":"<p>I have Ruby on Rails site. Users are allowed to login using their Facebook accounts. Its done using <code>omniauth</code> + <a href=\"http://rubygems.org/gems/omniauth-facebook\" rel=\"nofollow\"><code>omniauth-facebook</code></a> gems.</p>\n\n<p>All worked well, but afetr <em>30 oct</em> facebook started to return \"Error: An error occurred. Please try again later.\" message.</p>\n\n<p>I think that issue linked with <a href=\"https://developers.facebook.com/roadmap/offline-access-removal/\" rel=\"nofollow\">Removal of offline_access permission</a>. But removing 'offline_access' from requested scope not solved the problem.</p>\n\n<p>Here is the query omniauth redirects to:</p>\n\n<pre><code>https://www.facebook.com/dialog/permissions.request?app_id=239854476109563&amp;display=page&amp;next=http%3A%2F%2Fwww.inmyroom.ru%2Faccounts%2Fauth%2Ffacebook%2Fcallback&amp;response_type=code&amp;perms=email%2Coffline_access%2Cuser_birthday%2Cpublish_stream%2Cuser_photos%2Cuser_hometown%2Cuser_location%2Cuser_website&amp;fbconnect=1\n</code></pre>\n\n<p>Any help. Thank you</p>\n\n<hr>\n\n<p>UPDATE:\nOh, seems like I found the reason:\n<code>Sandbox mode</code> was enabled automatically. And FB didn't allow me to disable it because my app have empty <code>privacy policy url</code> setting.</p>\n"},{"tags":["ruby-on-rails","activeadmin","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13248864,"title":"ActiveAdmin: Polymorphic Association-controller can't find parameter","body":"<p>I have a polymorphic assocation like this:</p>\n\n<pre><code>class Review &lt; ActiveRecord::Base\n  has_many :comments, as: :commentable\nend\n\nclass Article &lt; ActiveRecord::Base\n  has_many :comments, as: :commentable\nend\n\nclass Comment &lt; ActiveRecord::Base\n  belongs_to :commentable, polymorphic: true\nend\n</code></pre>\n\n<p>in app/admin/comments.rb:</p>\n\n<pre><code>ActiveAdmin.register Comment do\n  belongs_to :article\nend\n</code></pre>\n\n<p>Instead of also adding a belongs_to :review, I manually added a route for :review (since adding another belongs_to would be ignored, as noted in <a href=\"https://github.com/gregbell/active_admin/issues/221\" rel=\"nofollow\">https://github.com/gregbell/active_admin/issues/221</a> --a \"feature\"...REALLY?) which is working as far as the routes go.</p>\n\n<p>The problem is that, apparently because there is no belongs_to :review in the app/admin/comments.rb file, when I try to go to the review route the controller is still looking for just the article_id parameter and I get the error \"Couldn't find Article without an ID.</p>\n\n<p>Is there a suggestion on what I need to change to work around this?</p>\n\n<p>Or do I have to lose the opportunity to use polymorphic associations whenever I use ActiveAdmin?</p>\n"},{"tags":["mysql","ruby-on-rails","geospatial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13248773,"title":"Rails spatial_adapter, mysql failure","body":"<p>I got following failure when starting up my local server.</p>\n\n<p>module:ConnectionAdapters': uninitialized constant ActiveRecord::ConnectionAdapters::Mysql2Column (NameError)</p>\n\n<p>Following gems are installed:</p>\n\n<pre><code>GeoRuby 1.3.4\nactiverecord 3.2.1\nspatial_adapter 1.2.0\n</code></pre>\n\n<p>I am using MySQL Server 5.5.28 and InnoDB.</p>\n\n<p>Shouldnt it be working with InnoDB already?</p>\n"}]}
{"total":93230,"page":7,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13088959,"title":"Why am I getting a 'Factory not registered' error?","body":"<p>I have a model Answer:  </p>\n\n<pre><code>class Answer &lt; ActiveRecord::Base\n  attr_accessible :content\n\n  belongs_to :question\nend\n</code></pre>\n\n<p>In my Question model, i have defined <code>has_many :answers</code>. My Answer model have three column: content (text), question_id (integer), correct(boolean). Default value of <code>correct</code> column is <code>false</code>.</p>\n\n<p>I created factories to create Answer object:</p>\n\n<pre><code>factory :answer do\n  content \"Content of an answer\"\n  question\n\n  factory :accept_answer do\n    correct true\n  end\nend\n</code></pre>\n\n<p>In my rspec file, i created new answer object successfully with below code:  </p>\n\n<pre><code>let(:answer) { FactoryGirl.create(:answer, question: question) }\n\nsubject { answer }\nits(:correct) { should be_false }\n</code></pre>\n\n<p>But when i used below code to create accept_answer object: </p>\n\n<pre><code>describe \"an accepted answer\" do\n  let(:accept_answer) { FactoryGirl.create(:accept_answer, question: question) } \n  it { accept_answer.correct.should be_true }\nend\n</code></pre>\n\n<p>It has error</p>\n\n<pre><code>Failure/Error: let(:accept_answer) { FactoryGirl.create(:accept_answer, question: question) }\nArgumentError:\n   Factory not registered: accept_answer\n</code></pre>\n\n<p>I don't know what wrong with my code :(</p>\n"},{"tags":["ruby-on-rails","spree"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13220589,"title":"Adding a step to the Spree checkout process","body":"<p>I'm trying to add an extra step to my Spree 1.2 store which will allow a customer to create a subscription. I've inserted the step, and rendered the correct view, but when the user clicks 'save and continue' the next step is rendered, but nothing is actually saved.</p>\n\n<p>I understand that I need to add a state_callback, but I'm not sure how to do this and the Spree documentation is very lacking around this (presumably because it's quite new)</p>\n\n<p>At present I've got the following in my extension:</p>\n\n<p>models/spree/order_decorator.rb</p>\n\n<pre><code>Spree::Order.class_eval do\n  belongs_to :subscription\n\n  accepts_nested_attributes_for :subscription\n\n  # This doesn't appear to be called\n  Spree::Order.state_machine.after_transition :from =&gt; :subscription,\n                                              :do =&gt; :valid_subs?\n\n  checkout_flow do\n    go_to_state :address\n    go_to_state :subscription\n    go_to_state :payment, :if =&gt; lambda { |order| order.payment_required? }\n    go_to_state :confirm, :if =&gt; lambda { |order| order.confirmation_required? }\n    go_to_state :complete\n    remove_transition :from =&gt; :delivery, :to =&gt; :confirm\n  end\nend\n</code></pre>\n\n<p>Not entirely sure that accepts_nested_attributes is necessary, but my dev approach for this has been trial and error so far, so it ended up staying there.</p>\n\n<p>In models/subscription.rb</p>\n\n<pre><code>class Subscription &lt; ActiveRecord::Base\n\n  attr_accessible :start_date, :frequency\n\n  belongs_to :user \n  has_many :orders\n  has_many :products\n\n  validates :start_date, :frequency, :presence =&gt; true\n\n  def schedule\n    ...code that returns a list of dates rendered on FE...\n  end\n\n  private #----\n\n  ... some methods used in schedule ...\n\n  def valid_subs?\n    binding.pry # never called\n  end\n\n  def after_subscription\n    binding.pry # never called either...\n  end\nend\n</code></pre>\n\n<p>views/spree/checkout/_subscription.html.erb</p>\n\n<pre><code>&lt;h1&gt;&lt;%= t(:\"subscription.title\") %&gt;&lt;/h1&gt;\n\n&lt;div class=\"columns alpha six\" data-hook=\"subscription_calendar_fieldset_wrapper\"&gt;\n  &lt;fieldset id=\"subscription_calendar\" data-hook&gt;\n    &lt;%= form.fields_for :subscription_picker do |subscription_picker| %&gt;\n      &lt;legend&gt;&lt;%= t(:\"subscription.first_delivery\") %&gt;&lt;/legend&gt;\n      &lt;%= render :partial =&gt; 'subscription/picker' %&gt;\n    &lt;% end %&gt;\n  &lt;/fieldset&gt;\n&lt;/div&gt;\n\n&lt;div class=\"columns omega six\" data-hook=\"subscription_dates_fieldset_wrapper\"&gt;\n  &lt;fieldset id=\"subscription_dates\" data-hook&gt;\n    &lt;legend align=\"center\"&gt;&lt;%= t(:\"subscription.next_deliveries\") %&gt;&lt;/legend&gt;\n    &lt;div class='dates'&gt;&lt;/div&gt;\n  &lt;/fieldset&gt;\n&lt;/div&gt;\n\n&lt;div class=\"form-buttons\" data-hook=\"buttons\" style='clear:both;'&gt;\n  &lt;%= submit_tag t(:save_and_continue), :class =&gt; 'continue button primary' %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>views/subscription/_picker.html.erb</p>\n\n<pre><code>&lt;div class='row'&gt;\n  &lt;label for=\"subscription_frequency\"&gt;Occurs every:&lt;/label&gt;\n  &lt;% frequency_options = [[\"2 Weeks\", 14], [\"3 Weeks\", 21], [\"Month\", 30], [\"2 Months\", 60], [\"3 Months\", 90]] %&gt;\n  &lt;%= select(:subscription, :frequency, options_for_select(frequency_options, 30), {}) %&gt;\n&lt;/div&gt;\n&lt;div id=\"start-date-picker\" class=\"calendar\"&gt;&lt;/div&gt;\n&lt;%= hidden_field(:subscription, :start_date, {value: (DateTime.now + 14).to_date.iso8601}) %&gt;\n\n... JS that creates the calendar ...\n</code></pre>\n\n<p>On clicking 'save and continue' I see the following params sent:</p>\n\n<pre><code>{\n                  \"utf8\" =&gt; \"✓\",\n               \"_method\" =&gt; \"put\",\n    \"authenticity_token\" =&gt; \"...BLAH...\",\n          \"subscription\" =&gt; {\n         \"frequency\" =&gt; \"30\",\n        \"start_date\" =&gt; \"2012-11-17\"\n    },\n                \"commit\" =&gt; \"Save and Continue\",\n            \"controller\" =&gt; \"spree/checkout\",\n                \"action\" =&gt; \"update\",\n                 \"state\" =&gt; \"subscription\"\n}\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13247894,"title":"Redirection based on the current controller's action","body":"<p>Right now, I have two views that are using the <code>users#create</code> action: <code>users/new.thml.erb</code> and <code>enter_email.html.erb</code>.</p>\n\n<p>The problem is that with the current code, the user is redirected to <code>new.html.erb</code> when the \nform in <code>enter_email.html.erb</code> has a validation error. So I tried this:</p>\n\n<pre><code>  def create\n    @user = User.new(params[:user])\n    if @user.save\n      sign_in @user\n      flash[:success] = \"Welcome to the Sample App!\"\n      redirect_to @user\n    else\n      if params[:action] == \"enter_email\"\n        render 'enter_email'\n      else\n        render 'new'\n      end\n    end\n  end\n</code></pre>\n\n<p>I wanted to user to be redirected to <code>enter_email.html.erb</code> when the action is 'enter_email'. But I'm still being redirected to 'new.html.erb'.</p>\n\n<p>Any suggestions to fix this? (it is because the action being performed is actually <code>create</code>? If so, how to modify the code to make the redirection work?) </p>\n"},{"tags":["ruby-on-rails","forms","twitter-bootstrap"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":2926,"score":5,"question_id":9390469,"title":"Twitter-Boostrap and Forms in Rails","body":"<p>This may be a beginners question but not having much luck getting this going.  The background:</p>\n\n<ol>\n<li>Rails 3.0.x version </li>\n<li>Bootstrap 2.0 - using as pre-compiled simply placed into public/stylesheets.\nAtt</li>\n<li>Attempting to do a form with horizontal layout, i.e label next to the input field on the same line.</li>\n</ol>\n\n<p>The issue is that I can't get the form to work, but can get the default Boostrap sample code, in the same form to layout correctly.  The Rails form looks like:</p>\n\n<pre><code>&lt;div class=\"row-fluid\"&gt;\n  &lt;div class=\"span4 well\"&gt;\n    &lt;%= form_for @member, :html =&gt; {:class =&gt; \"form-horizontal\"} do |m| %&gt;\n        &lt;fieldset&gt;\n\n          &lt;%= m.label :title  %&gt;\n          &lt;%= m.text_field :title %&gt;   \n\n          &lt;%= m.label :first_name %&gt;\n          &lt;%= m.text_field :first_name %&gt;\n    &lt;% end %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p>Notice that the <strong>form_for</strong> method has the class of <em>form-horizontal</em> as described by in <a href=\"http://twitter.github.com/bootstrap/base-css.html#forms\" rel=\"nofollow\">Bootsrap form CSS</a></p>\n\n<p>When displayed the label, for example title, is on one line left adjusted and then on the next line is the input field, also left adjusted.</p>\n\n<p>Now if I include some of the sample Bootstrap code for forms such as:</p>\n\n<pre><code>&lt;div&gt;\n  &lt;form class=\"form-horizontal\"&gt;\n    &lt;fieldset&gt;\n      &lt;legend&gt;Legend text&lt;/legend&gt;\n      &lt;div class=\"control-group\"&gt;\n        &lt;label class=\"control-label\" for=\"input01\"&gt;Text input&lt;/label&gt;\n\n        &lt;div class=\"controls\"&gt;\n          &lt;input type=\"text\" class=\"input-xlarge\" id=\"input01\"&gt;\n\n          &lt;p class=\"help-block\"&gt;Supporting help text&lt;/p&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/fieldset&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>then I get the expected outcome -- label and input field on the same line in horizontal layout.</p>\n\n<p>I've tried adding the style \"control-label\" onto the m.label and m.text_field components but no joy in getting the layout as horizontal.</p>\n\n<p>Thus, not sure what the issue is, since the working part validates that I can get Bootstrap to work, although with my Rails Form it's not honouring the form-horizontal.</p>\n\n<p>Any help is greatly appreciated</p>\n"},{"tags":["ruby-on-rails","curl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13246775,"title":"How to get original curl request made by patron gem in rails","body":"<p>I am using <a href=\"http://patron.rubyforge.org/\" rel=\"nofollow\">patron</a> gem for creating curl request. Here is the code</p>\n\n<pre><code>    s = Patron::Session.new\n    s.connect_timeout = 15\n    s.timeout = 15\n    s.base_url = API_URL\n    s.headers['Date'] = DATE_HEADER\n    s.headers['Accept'] = 'application/xml'\n    s.headers['Content-Type'] = 'application/json'\n    s.headers['Authorization'] = \"API\" + \" \" + auth_token\n    response = s.delete(uri)\n    response.status\n</code></pre>\n\n<p>How can I get the original curl request made by this gem?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","csv","import"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13247149,"title":"Can't mass-assign protected attributes when import data from csv file","body":"<p>I have a form for import data like this:</p>\n\n<pre><code>&lt;%= form_tag({ controller: 'courses', action: :import }, multipart: true) do %&gt; \n  &lt;%= label_tag 'file', 'Import data' %&gt;\n  &lt;%= file_field_tag 'file' %&gt;\n  &lt;%= submit_tag \"Import\", name: nil, class: 'btn' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is my import action:</p>\n\n<pre><code>def import\n  require 'csv'\n\n  csv_text = File.read(params[:file].tempfile.to_path.to_s)\n  csv = CSV.parse(csv_text, headers: true )\n  csv.each do |row|\n    row = row.to_hash.with_indifferent_access\n    Course.create(row.to_hash.symbolize_keys)\n  end\n  flash[:success] = \"Successfully import data.\"\n  redirect_to courses_url\nend\n</code></pre>\n\n<p>But when i choose a file and press button <code>Import</code> in browser, i got error:</p>\n\n<pre><code>ActiveModel::MassAssignmentSecurity::Error in CoursesController#import\nCan't mass-assign protected attributes: Name, Code\n</code></pre>\n\n<p>In my <code>Course</code> model, <code>name</code> and <code>code</code> already are attr_accessible:</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n  attr_accessible :code, :name\nend\n</code></pre>\n\n<p>What's wrong with my code?</p>\n\n<p><strong>Updated</strong><br>\nThis is my csv file:</p>\n\n<pre><code>name, code\nERP System, HT555DV01\nData Mining, HT459DV01\n</code></pre>\n\n<p><strong>New code to create data</strong></p>\n\n<pre><code>csv.each do |row|\n  Course.create!(name: row[0], code: row[1])\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","date","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13231629,"title":"Working with group_by on a created_at field in Ruby on Rails","body":"<p>I'm sorry I couldn't find a lighter title for what I come up with. </p>\n\n<p>The thing is I need to group some stuff by date, but not time. That's to say I want them grouped by days, problem comes when grouping by created_at field, because it gets to seconds precision:</p>\n\n<pre><code>@stuff = SomeCoolStuff.where(cool_guy_id: @guy.id).group_by(&amp;:created_at)\n</code></pre>\n\n<p>This gives me this kind of key for the hash: <code>2012-10-02 08:16:13 +0200</code>, but what I want in the keys is only <code>2012-10-02</code>.</p>\n\n<p>Any thoughts?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","devise","omniauth"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":23,"score":4,"question_id":13246802,"title":"How to accomplish multiple authentication using Devise Omniauth + (Facebook , Twitter, Google )?","body":"<p>I have implemented the Devise Omniauth authentication in my Rails application successfully using the following tutorial by git\n<a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">OmniAuth: Overview</a></p>\n\n<p>But it will not support multiple authentications , may be you all know that , and have faced the same issue before, but if you people have tweaked the same problem successfully please let me know the solution .</p>\n\n<p>This is the scenario that i need to accomplish using Omniauth + Devise.</p>\n\n<p>we have a user named John and he already have accounts in both Google &amp; Facebook with the same email id \"John@yopmail.com\".</p>\n\n<p>So for the first time John trying to log-in with his Google account, john have successfully logged in this time.</p>\n\n<p>but for the second time john trying to log-in with his facebook account, this time our application redirects john to the devise registration_url , without letting him signing in with his facebook account.</p>\n\n<p>I know why this is hapepnig because devise will internally validates the uniqueness of email.But i am very curious to know that , is there any way to tweak this issue so that we can achieve multiple authentications . Stack-Overflow have done the same very nicely.  </p>\n\n<p>Please help me to find out the solution.</p>\n\n<p>Thank you..</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","browser","soundmanager2"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":15,"score":3,"question_id":13248069,"title":"Soundmanager-rails won't play sound with flash","body":"<p>I am using soundmanager-rails gem in my rails app. I use it to stream radio from stream. While HTML5 audio works fine with mp3, flash won't play a sound. I've tried Firefox, Safari and Chrome and in every browser sound doesn't work via flash. Console log looks fine:</p>\n\n<pre><code>-- SoundManager 2: HTML5 support tests (/^(probably|maybe)$/i): mp3: true (preferring flash), mp4: true (preferring flash), ogg: false (and no flash support), wav: true --\n-- SoundManager 2 V2.97a.20120916 (AS2/Flash 8) + HTML5 audio, normal polling --\nsoundManager::createMovie(): Trying to load /assets/swf/soundmanager2_debug.swf\nsoundManager::initMovie(): Waiting for ExternalInterface call from Flash...\nsoundManager::externalInterfaceOK() (~0 ms)\nsoundManager::init()\nsoundManager: Attempting JS to Flash call...\n(Flash): SM2 SWF V2.97a.20120916 (AS2/Flash 8)\n(Flash): JS to/from Flash OK\nFlash security sandbox type: remote\n(Flash): Enabling polling, 50 ms interval\n-- SoundManager 2 loaded (OK) --\nsoundManager: Firing 1 onready() item\n</code></pre>\n\n<p>Rails server serves swf files fine:</p>\n\n<pre><code>Started GET \"/assets/swf/soundmanager2_debug.swf\" for 127.0.0.1 at 2012-11-06 13:17:01 +0400\nServed asset /swf/soundmanager2_debug.swf - 200 OK (3ms)\n</code></pre>\n\n<p>Soundmanager demos on it's web site work alright in every browser.</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":30,"score":4,"question_id":13247395,"title":"rails create table in db dynamically","body":"<p>Normally to create/alter a table in database I use migrations (manually run <code>rake db:migrate</code>) and then in my code I use ActiveRecord. This is very cool as I don't have to worry about representation of the data in db and about a specific kind of db (sqlserver, pg or other).</p>\n\n<p>But now a customer wants to be able to create \"things\" on-fly himself like, say, he starts selling computers, so he wants to an interface where he can dynamically create an object \"computer\" with properties like \"Name, RAM, HD, ...\". It seems to be quite natural to create a separate table in db with all these fields. But how can I do that in RoR and keep all these nice things about ActiveRecord?</p>\n\n<p>Please suggest.</p>\n"},{"tags":["ruby-on-rails","controller","helper"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":493,"score":0,"question_id":2909583,"title":"Guidelines for calling controller methods in helper modules?","body":"<p>Few questions:</p>\n\n<ol>\n<li><p>Is it possible to call a controller method in a helper module (e.g., application helper)?</p></li>\n<li><p>If so, how does the helper handle the rendering of views?  Ignore it?</p></li>\n<li><p>In what instances would you want to call a controller method from a helper? Is it bad practice?</p></li>\n<li><p>Do you have any sample code where you're calling controller methods in helper?</p></li>\n</ol>\n"},{"tags":["ruby-on-rails","solr","sunspot","websolr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13247952,"title":"Sunspot/Solr not able to search by boolean value","body":"<p>I have a RoR model with a boolean field:</p>\n\n<pre><code>field :active, :type =&gt; Boolean\n</code></pre>\n\n<p>Which is listed in the searchable block:</p>\n\n<pre><code>searchable do\n  boolean :active\n</code></pre>\n\n<p>And also in the search query:</p>\n\n<pre><code>s = Document.search do\n  with(:active, true)\nend\n</code></pre>\n\n<p>And also in my Solr schema.xml file:</p>\n\n<pre><code>&lt;field name=\"active_b\" type=\"boolean\" indexed=\"true\" stored=\"true\"/&gt;\n</code></pre>\n\n<p>The issue is that my search is not restricting the results to only documents with active set to true. This is working in my local development environment but not in Heroku.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13247799,"title":"Does ActiveRecord cache table_name?","body":"<p>I've got an <code>ActiveRecord</code> class that needs to look at two different tables depending on a configuration switch, so I'm planning to do the following:</p>\n\n<pre><code>def table_name\n  config_is_on? ? :table1 : :table2  \nend\n</code></pre>\n\n<p>I'm wondering whether the <code>table_name</code> method is always called when queries are run against this model: the application is <strong>not</strong> going to be restarted when the configuration changes, so this value cannot be cached.</p>\n\n<p>Does <code>ActiveRecord</code> always evaluate the <code>table_name</code> or just once during application startup / initialization? If it's cached how do I force it to evaluate <code>table_name</code> every time?</p>\n"},{"tags":["ruby-on-rails","index","2d"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13237127,"title":"mongodb/rails \"exception: can't find special index: 2d for:\"","body":"<p>i have a rails app where i have some problems with indexes. I search locations by name.\nFirst i thought its a problem with the addresses.coords but iam not sure about it.</p>\n\n<p>The relevant parts of the search controller:</p>\n\n<pre><code>  @practices = Practice.published\n  @practices = @practices.where(:\"addresses.country\" =&gt; params[:country].upcase) if  params[:country].present?\n\n  if params[:location].present? &amp;&amp; latlng = get_coordinates\n    @practices = @practices.near_sphere(:\"addresses.coords\" =&gt; latlng).max_distance(:\"addresses.coords\" =&gt; get_distance )\n  end\n\n  # now find doctors based on resulting practices\n  @doctors = Doctor.published.in(\"organization_relations.practice_id\" =&gt; @practices.distinct(:_id))\n</code></pre>\n\n<p>The complete crash log:</p>\n\n<pre><code>Moped::Errors::OperationFailure (The operation: #&lt;Moped::Protocol::Command\n  @length=255\n  @request_id=646\n  @response_to=0\n  @op_code=2004\n  @flags=[]\n  @full_collection_name=\"um-contacts.$cmd\"\n  @skip=0\n  @limit=-1\n  @selector={:distinct=&gt;\"practices\", :key=&gt;\"_id\", :query=&gt;{\"deleted_at\"=&gt;nil,     \"published_at\"=&gt;{\"$lte\"=&gt;2012-11-05 15:17:14 UTC}, \"addresses.country\"=&gt;\"DE\", \"addresses.coords\"=&gt;{\"$nearSphere\"=&gt;[13.4060912, 52.519171], \"$maxDistance\"=&gt;0.01569612305760477}}}\n  @fields=nil&gt;\nfailed with error 13038: \"exception: can't find special index: 2d for: { deleted_at: null, published_at: { $lte: new Date(1352128634313) }, addresses.country: \\\"DE\\\", addresses.coords: { $nearSphere: [ 13.4060912, 52.519171 ], $maxDistance: 0.01569612305760477 } }\"\n\nSee https://github.com/mongodb/mongo/blob/master/docs/errors.md\nfor details about this error.):\n  app/controllers/search_controller.rb:16:in `index'\n</code></pre>\n\n<p>Thats the result of the indexes, not sure how to query them from the addresses which are embedded via has_many.</p>\n\n<pre><code>&gt; db.practices.getIndexes()\n\n[\n\n    {\n    \"v\" : 1,\n    \"key\" : {\n        \"_id\" : 1\n    },\n    \"ns\" : \"um-contacts.practices\",\n    \"name\" : \"_id_\"\n}\n\n]\n</code></pre>\n\n<p>My complete search controller and all other related files can be found [here][2].</p>\n\n<p>Help would be really appreciated!</p>\n\n<p>Edit: Looks like the indexes for adresses.coords arent created,</p>\n\n<pre><code>db.system.indexes.find()\n{ \"v\" : 1, \"key\" : { \"_id\" : 1 }, \"ns\" : \"um-contacts.users\", \"name\" : \"_id_\" }\n{ \"v\" : 1, \"key\" : { \"_id\" : 1 }, \"ns\" : \"um-contacts.doctors\", \"name\" : \"_id_\" }\n{ \"v\" : 1, \"key\" : { \"_id\" : 1 }, \"ns\" : \"um-contacts.collaborations\", \"name\" : \"_i\n{ \"v\" : 1, \"key\" : { \"_id\" : 1 }, \"ns\" : \"um-contacts.practices\", \"name\" : \"_id_\" }\n</code></pre>\n\n<p>but should be created within the practice class:</p>\n\n<pre><code>class Practice\n ...\n embeds_many :addresses, cascade_callbacks: true, as: :addressable\n ...\n field :name, type: String\n field :kind, type: String\n field :slug, type: String\n\n index({\"addresses.coords\" =&gt; '2d'}, { min: -180, max: 180, background: true })\n index({name: 1})\n index({slug: 1}, { unique: true })\n ...\n</code></pre>\n\n<p>Anyone have an idea why its failing?</p>\n"},{"tags":["ruby-on-rails","database","deployment","rake","staging"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3145,"score":4,"question_id":6906715,"title":"clearing rails app database on heroku production site","body":"<p>So I'm new to ROR and Heroku and need a little help. I've created an app and have deployed it; however, I'd like to clear out the database associated with it. Meaning I'd like to clear any users (and their attached data) that have been created thus far.</p>\n\n<p>I've basically created several phony accounts to test out whether the database on the production site works, but now i'd like to clear this out, and start with a fresh database.</p>\n\n<p>Is this possible without deleting the database entirely?</p>\n\n<p>Any help would be sincerely appreciated. Thank you very much for your time!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13247547,"title":"Where to put a complex require statement in Rails?","body":"<p>I'm writing some Rails code that I want to be both 1.8.7 and 1.9 compatible. In a couple different files, I do some CSV parsing, so I currently have the following requires line in each file:</p>\n\n<pre><code>if RUBY_VERSION &lt; \"1.9\"\n  require \"rubygems\"\n  require \"fastercsv\"\n  CSV = FCSV\nelse\n  require \"csv\"\nend\n</code></pre>\n\n<p>To avoid all the duplication, though, this block should probably live in a single place. Where's the best place to put it? Is <code>application.rb</code> the right place?</p>\n"},{"tags":["ruby-on-rails","git","capistrano","web-deployment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13247313,"title":"Limiting developer access to git repository for a website and how to deploy it","body":"<p>I am considering taking on a new developer for my rails based website but, because I do not know them, I do not want them to have complete read access to my code.  I only want them to be able to read and write to one directory.</p>\n\n<p><strong>Requirements:</strong></p>\n\n<p>I would also like them do be able to deploy their updates/changes.</p>\n\n<p>Both myself and the developer use windows so symbolic linking is not a good idea...</p>\n\n<p>I currently use capistrano to deploy the website but will use vlad or anything else that will work... </p>\n\n<p><strong>Background Reading</strong></p>\n\n<p>So, I have been reading about submodules, subtrees (apenwarr's git-subtree and the subtree merge strategy), giternal, piston, braid, etc, etc and I am completely flummoxed!  Any help that can be provided would be greatly appreciated!</p>\n\n<p><strong>My current thoughts</strong></p>\n\n<p>I don't think that <strong>submodules</strong> are the right choice here because:</p>\n\n<p>1) I would like to make as few changes as possible to the main repository </p>\n\n<p>2) i) The developer would need access to the main repository to notify it of submodule changes... which defeats the purpose of making them work with a submodule.  </p>\n\n<p>ii) I could create a master repository that would reference the divided sections of the website but I have no idea how to do this or if it would even work.</p>\n\n<p><strong>Subtrees</strong></p>\n\n<p>If I understand them correctly, someone can work on the subtree and commit to it as if they had full access to only that part of the master repository.  At first glance this seems to make them just exaclty what I need - especially since the master repository can reference the current HEAD of a subtree by default and doesn't need manual updating. Unfortunately I can't see how I would deploy the website with subtree nor can I tell if this is really want I want.  There is a lot of conflicting opinion about submodules, subtrees etc and it is difficult to sort through it.</p>\n\n<p>Thank you very much for your time reading this and any help that you can offer!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","caching","rabl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13192550,"title":"Fragment caching in a rabl view?","body":"<p>I read <a href=\"https://github.com/nesquena/rabl/wiki/Caching-in-RABL\" rel=\"nofollow\">rabl caching doc</a> and I don't get how I can cache fragment of code.\nI have a view like this (there more code, but I removed it for simplicity's sake):</p>\n\n<pre><code>object @video\n\nattributes :id, :user_id, :event_id\n\nchild :event do\n  attributes :id\n  node(:name) { |event| event.name }\nend\n\nchild :user do\n  attributes :id\nend\n</code></pre>\n\n<p>And I want to cache :event child for two hours. How can I do that?</p>\n\n<p>I'm using rabl(0.7.6), rails(3.2.0), ruby(1.9.3p125)</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":142,"score":4,"question_id":9082802,"title":"Rails models reloaded mid-request resulting in AssociationTypeMismatch","body":"<p>We've been running into a problem in Rails 3.1 when we run in development mode.   It seems that our models sometimes get reloaded mid request, and a new object_id is set on our model's classes.  Which then results in an ActiveRecord::AssociationTypeMismatch</p>\n\n<blockquote>\n  <p>ActiveRecord::AssociationTypeMismatch Character(#2194222580) expected,\n  got Character(#2185863000)</p>\n</blockquote>\n\n<p>If we turn <code>config.cache_classes = true</code> in <code>development.rb</code> the problem seems to go away, but it's unrealistic to develop like that as we'll have to constantly be restarting our servers.</p>\n\n<p>Anybody have an idea why models may be reloaded mid request, or if there is a way we could force the cache to last through the entire request?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":339,"score":1,"question_id":9461903,"title":"Generate link_to without path (only anchor)","body":"<p>I need to have path like \"#privacy\" for tab plugin. Link must contain only anchor. When I use <code>link_to 'Privacy', :anchor =&gt; 'privacy'</code> Rails generate <code>/privacy#privacy</code> - link, that contains full path and anchor.</p>\n\n<p>How can I told Rails to generate url without path (only anchor)?</p>\n\n<p>Thanks.</p>\n\n<p><strong>Solved</strong>: <code>link_to 'Privacy', '#privacy'</code></p>\n"},{"tags":["ruby-on-rails","ruby","rvm","rmagick"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1277,"score":2,"question_id":10063051,"title":"Bundle can't install RMagick gem on Mac OSX 10.7","body":"<p>I've installed ImageMagick with ImageMagick installer script <a href=\"https://github.com/maddox/magick-installer\" rel=\"nofollow\">https://github.com/maddox/magick-installer</a>. I am on OSX Lion 10.7, using RVM, Ruby 1.9.3p125.</p>\n\n<p>The problem seems to be with MagickWand.h here is the complete log</p>\n\n<pre><code>/Users/pdjimeno/.rvm/rubies/ruby-1.9.3-p125/bin/ruby extconf.rb\nchecking for Ruby version &gt;= 1.8.5... yes\nextconf.rb:128: Use RbConfig instead of obsolete and deprecated Config.\nchecking for /usr/bin/gcc... yes\nchecking for Magick-config... yes\nchecking for ImageMagick version &gt;= 6.4.9... yes\nchecking for HDRI disabled version of ImageMagick... yes\nPackage MagickCore was not found in the pkg-config search path.\nPerhaps you should add the directory containing `MagickCore.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'MagickCore' found\nPackage MagickCore was not found in the pkg-config search path.\nPerhaps you should add the directory containing `MagickCore.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'MagickCore' found\nPackage MagickCore was not found in the pkg-config search path.\nPerhaps you should add the directory containing `MagickCore.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'MagickCore' found\nPackage MagickCore was not found in the pkg-config search path.\nPerhaps you should add the directory containing `MagickCore.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'MagickCore' found\nchecking for stdint.h... yes\nchecking for sys/types.h... yes\nchecking for wand/MagickWand.h... no\n\nCan't install RMagick 2.13.1. Can't find MagickWand.h.\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/pdjimeno/.rvm/rubies/ruby-1.9.3-p125/bin/ruby\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","capitalization","pluralize"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13246002,"title":"pluralize and decapitalize nouns in Ruby","body":"<p>I am implementing a view count feature for particular web pages in Ruby on Rails. I use haml lists to achieve my end. (The JavaScript library takes the list and render it as dropdowns.) </p>\n\n<p>Here is the code snippet:</p>\n\n<pre><code>%li.action\n  = link_to t(question.views_count.to_s + ' views')\n</code></pre>\n\n<p>My problem here is that the V in views is capitalized in the output and view is pluralized even for 0 and 1 number of views. Is there any way I can deal with these issues?</p>\n"},{"tags":["html","ruby-on-rails","hyperlink","jekyll"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13246874,"title":"Links Not working in Jekyll","body":"<p>I'm unable to link to other parts of my website in Jekyll. This is my first day working with Jekyll so I'm not sure if this even works. I have a <code>_layout</code> folder with a layout html file. Inside the <code>layout.html</code>, I have a nav bar with links leading to different parts of the site such as <code>404.html</code> which is located in the main directoy. The a tag in the <code>layout.html</code> looks like this..</p>\n\n<pre><code>&lt;a href=\"/404.html\"&gt;Link to 404 page&lt;/a&gt;\n</code></pre>\n\n<p>However when I click on the link, nothing happens. Even my Twitter Bootstrap reacts funky. What's the problem here and how do I fix this?</p>\n"},{"tags":["ruby-on-rails","ruby","aasm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13235216,"title":"How to invoke Ruby gem AASM transition event given to and from states?","body":"<p>We have a Ruby on Rails application.</p>\n\n<p>We're using Ruby's aasm gem to manage states of objects.</p>\n\n<pre><code>&lt;pre&gt;\nhas_state\naasm do\n    state :created, :initial =&gt; true\n    state :submitted\n    state :rejected\n    state :approved\n\n    event :submit do\n        transitions :to =&gt; :submitted, :from =&gt; [:created]\n    end\n\n    event :mark_as_incomplete do\n        transitions :to =&gt; :created, :from =&gt; [:submitted]\n    end\n\n    event :approve do\n        transitions :to =&gt; :approved, :from =&gt; [:submitted]\n    end\n\n    event :reject do\n        transitions :to =&gt; :rejected, :from =&gt; [:submitted]\n    end\nend\n&lt;code&gt;\n</code></pre>\n\n<p>If we know an object's current state, which can be obtained using</p>\n\n<pre><code>&lt;pre&gt;\nobject.aasm_current_state\n&lt;code&gt;\n</code></pre>\n\n<p>and we also know the state to transition to, how can we invoke the event?</p>\n\n<p>Please note, the from-state and to-state are variables, so we need to do the above\ndynamically.  Of course, with certain to-state and from-state combination, the transition isn't available, in that case we should detect an error.</p>\n\n<p>We're also assuming between any two state combination (to-state and from-state), there's only 1 event, I think theoretically there can be more than 1.</p>\n\n<p>I think this can be achieved by delving into the innards of aasm source code,\nwhich, arguably, may not be a good practice.  Any thoughts?</p>\n\n<p>Just wonder if anyone has done this before.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","activerecord","arel","ruby-on-rails-3.2.1"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":183,"score":3,"question_id":9879954,"title":"Translating a (slightly complex) raw SQL query to ActiveRecord/Arel?","body":"<p>I have a very simple Rails app with a very simple relational database: Category has many Samples. I'd simply like to load the categories that have X number of samples.</p>\n\n<p>In plain SQL I would do something like this:</p>\n\n<pre><code>SELECT\n    categories.*\nFROM\n    categories\nJOIN\n    (SELECT\n        category_id, COUNT(*) as sample_count\n    FROM\n        samples\n    GROUP BY\n        category_id\n    ) AS subselect\nON\n    categories.id=subselect.category_id\nWHERE\n    subselect.sample_count = X; -- where X is whatever\n</code></pre>\n\n<p>That works just fine, by the way, but it's not terribly Rails-like to use raw SQL. And obviously I'd like to get those categories as model instances, so:</p>\n\n<p><strong>How would I go about re-writing something like that to an ActiveRecord or Arel query?</strong> Is it even feasible, or should I go with the plain SQL? Is there perhaps an altogether simpler way of doing it?</p>\n"},{"tags":["mysql","ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13161394,"title":"ActiveRecord error: SAVEPOINT active_record_1 does not exist","body":"<p>The full error is</p>\n\n<pre><code>ActiveRecord::StatementInvalid: Mysql2::Error: SAVEPOINT active_record_1 does not exist: ROLLBACK TO SAVEPOINT active_record_1\n</code></pre>\n\n<p>I am writing a unit test and getting this error whenever I try to create a new ActiveRecord object -- but only after a certain point. This occurs after these lines:</p>\n\n<pre><code>ActiveRecord::Base.connection.execute \"DROP TABLE IF EXISTS foo\"\nActiveRecord::Base.connection.execute \"CREATE TABLE foo (id INTEGER PRIMARY KEY)\"\n</code></pre>\n\n<p>(The table 'foo' will be populated with data if my test succeeds)</p>\n\n<p>Before the above lines, I can write something like</p>\n\n<pre><code>User.create(email =&gt; 'foo@bar.com')\n</code></pre>\n\n<p>and everything works fine. However, if I try writing the above line after my call to ActiveRecord::Base.connection.execute, then I get this SAVEPOINT error described above.  I've also tried putting my execute statements within a transaction, but that didn't help. I'm stumped.</p>\n\n<p>FYI - I'm using Rails 3.2.8</p>\n"},{"tags":["html","ruby-on-rails","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13246411,"title":"Is it possible to get the selection order of items from a dropdown box generated using collection_select?","body":"<p><strong>Question</strong>: Is it possible to get the selection order of items from a dropdown box generated using collection_select?</p>\n\n<p>I am doing the following in a simple form:</p>\n\n<pre><code>&lt;%= f.collection_select(:category_ids, Category.all, :id, :name, {}, html_options = {:multiple =&gt; true} ) %&gt;\n</code></pre>\n\n<p>With this I can get an array of selected Categories, however they are arranged in a top-down order (as they appear in the list). </p>\n\n<p>For example, say I have the following categories: </p>\n\n<ol>\n<li>Red</li>\n<li>Green</li>\n<li>Blue</li>\n<li>Orange</li>\n</ol>\n\n<p>If I pick Green, Orange, Red I would like to get a return array of [2, 4, 1] but I get [1, 2, 4] instead.</p>\n\n<p>I found this post that mentions it's a HTML standard thing for them to be ordered this way. Is there a way around this? </p>\n\n<p><a href=\"http://stackoverflow.com/questions/10446796/order-of-selection-in-html-select-multiple\">Order of selection in html select multiple?</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":5,"favorite_count":11,"up_vote_count":22,"down_vote_count":0,"view_count":10971,"score":22,"question_id":3873190,"title":"f.error_messages in Rails 3.0","body":"<p>Rails 3.0 deprecated <code>f.error_messages</code> and now requires a plugin to work correctly - I however want to learn how to display error messages the (new) native way. I am following the <a href=\"http://edgeguides.rubyonrails.org/getting_started.html\" rel=\"nofollow\">getting started guide</a>, which uses the deprecated method when implementing the comments form. For example:</p>\n\n<pre><code>&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for([@post, @post.comments.build]) do |f| %&gt;\n  &lt;%= f.error_messages %&gt;\n&lt;div class=\"field\"&gt;\n  &lt;% f.label :commenter  %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :commenter  %&gt;\n&lt;/div&gt;\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :body %&gt;&lt;br /&gt;\n  &lt;%= f.text_area :body %&gt;\n&lt;/div&gt;\n&lt;div class=\"actions\"&gt;\n  &lt;%= f.submit %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the correct way to do it (as generated by the scaffold):</p>\n\n<pre><code>&lt;%= form_for(@post) do |f| %&gt;\n  &lt;% if @post.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@post.errors.count, \"error\") %&gt; prohibited this post from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @post.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n . . . \n</code></pre>\n\n<p>I understand that I use the <code>@post</code> variable in the latter example, but what variable do I reference in the former to get the error messages for comment creation?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13245311,"title":"RoR duplication fields","body":"<p>When an incorrect mandatory fields, the page reloads and you receive an incorrect entry fields and all fields in the form company_form duplicated.</p>\n\n<p>User model(user.rb):</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  ....\n  has_many :companies, :autosave =&gt; true\n  accepts_nested_attributes_for :companies\n  has_and_belongs_to_many :roles\n  def role?(role_name)\n    return !!self.roles.find_by_name(role_name)\n  end\n  def with_company\n    self.companies.build\n    self\n  end\nend\n</code></pre>\n\n<p>Company model:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  ...\n  belongs_to :user\n  ...\nend\n</code></pre>\n\n<p>views/devise/registration/new.html.haml:</p>\n\n<pre><code>= form_for(resource.with_company, :as =&gt; resource_name, :url =&gt; registration_path(resource_name), :html =&gt; { :class =&gt; 'form-horizontal'}) do |f|\n...\n  = f.fields_for :companies do |company_form|\n  ...\n...\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13238616,"title":"Rails Override Save To Perform Selective Update","body":"<p>I am working on a Rails 3.2.8 application that uses a homegrown REST API to insert new data.  The insertion logic is generic for every endpoint and results quite simply in a call to Model.save.  </p>\n\n<p>For one of the model types I would like to first check if a pre-existing record exists and if so, update as opposed to insert.  If the code allowed me to interact at the Controller level this would be easy through the use of find_or_create_by, however (I think) my only option is to override the save method in the Model or use a before_save callback.</p>\n\n<p>I'm struggling to figure out a way to make this work, as any calls to save or update_attributes inside the Model simply results in an infinite loop (for obvious reasons).</p>\n\n<p>Is there a way to utilize either before_save or to override save in such a way that I can first check if a record exists with attributes x and y and if so retrieve that record and perform the update, otherwise move forward with a standard ActiveRecord save?</p>\n\n<p>Here is my code as it currently stands inside the Activity model, which does not work due to the infinite loop issue:</p>\n\n<pre><code>def save\n  a = UserActivity.find_or_initialize_by_user_id_and_activity_id(user_id: user_id,     activity_id: activity_id)\n  a.update_attributes start_at: start_at, end_at: end_at.....\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","devise","email-validation"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13227202,"title":"before_create in user model -- set integer based on email (RAILS)","body":"<p>I'm trying to assign a user to their companys group based on their email domain. I'm using devise + confirmation, so I avoided using regex (dont need to validate that its a valid email...), and am trying to do this in a simple way. So essentially, it would force the users company_id (which matches up with that table) to be assigned in sign up, and then not allow them to sign up if their company doesnt exist. So this will work for both test@company.com and test@recruiting.company.com</p>\n\n<p>In User model</p>\n\n<pre><code>before_create :company_placement\n</code></pre>\n\n<p>...</p>\n\n<pre><code>def company_placement\n  user_domain = (:email).split('@').last\n\n  while user_domain.split('.').count &gt; 2\n    user_domain = user_domain.split('.', 2).last\n  end\n\n  if Company.find_by_domain(user_domain) != nil\n    (:company_id) = Company.find_by_domain(user_domain).id\n  else\n    #error out\n  end\nend\n</code></pre>\n\n<p>When I do this in rails console step by step, it seems to work. But in console when i run,</p>\n\n<pre><code>&gt; user = User.create!(name: \"test\", email: \"test@example.com\", password: \"foobar\")\n</code></pre>\n\n<p>I get undefined local variable or method 'user' for #&lt;'User....</p>\n\n<p>Thanks for any help, still learning rails...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13245289,"title":"Writing test cases(Rspec) for existing application","body":"<p>Being Rspec noob, i dont know this question make sense. BUt i am really confused and couldnt get solution for this.</p>\n\n<blockquote>\n  <p>We have one new requirement, asked us to write Rspec test cases for existing project. They have application with rails3 that already working but they want rspec cases to be written now</p>\n</blockquote>\n\n<p>My question is</p>\n\n<blockquote>\n  <p>Writing Rspec cases for existing application does make sense?</p>\n  \n  <p>Can we write spec for already working project</p>\n  \n  <p>Should we follow any guidelines to write specs for already written app</p>\n</blockquote>\n\n<p>Thank you </p>\n"},{"tags":["ruby-on-rails","komodo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13245601,"title":"Komodo Project Template Macros","body":"<p>What is the use of <strong><code>oncreate</code></strong> macro in komodo project? \nHow it could be used in Ruby on rails?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13245346,"title":"How to convert string into a decimal?","body":"<p>I have two strings \"0.31\" and \"0.0076\" and they need to be stored in a decimal(10,2) column in MySQL. How do I do this conversion in ruby but not in mysql directly</p>\n"},{"tags":["ruby-on-rails","ruby","deployment","capistrano"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":353,"score":1,"question_id":5975798,"title":"Deploy Rails App","body":"<p>I have been asked to make a few cosmetic changes to our production deployment. I have access to our linux box where I can see the files I need to change. I only need to change html.erb files, but when I add, for instance a simple <code>&lt;p&gt;</code> tag, it does not show up live.</p>\n\n<p>I know I probably have to reset the server or redeploy the code, but I have no idea what to do.</p>\n\n<p>Our production deployment is not fully live, so I am making changes on the fly (I know that this is not the best practice). Our app is running in a shared hosting environment for the moment. </p>\n\n<p>I have seen threads where people use Capistrano to deploy but how? We do not currently use it.</p>\n\n<p>Can anyone help?</p>\n"},{"tags":["ruby-on-rails","nginx","amazon-web-services","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":168,"score":0,"question_id":12062058,"title":"Nginx + Unicorn Configuration Issues","body":"<p>I am in the proces of migrating from Passenger to Unicorn and I am having a bit of trouble getting the configuration working.</p>\n\n<p>The issue that I am seeing is that all of my connections seem to time out, but there are no errors logged in the stderr.log and stdout.log files. I have verified that my ports are open on the AWS sec group.</p>\n\n<p>This is what I am seeing in my stderr.log</p>\n\n<pre><code>I, [2012-08-21T19:26:36.462776 #7989]  INFO -- : unlinking existing socket=/data/test/staging/current/tmp/sockets/unicorn.sock\nI, [2012-08-21T19:26:36.463048 #7989]  INFO -- : listening on addr=/data/test/staging/current/tmp/sockets/unicorn.sock fd=3\nI, [2012-08-21T19:26:36.463466 #7989]  INFO -- : Refreshing Gem list\nI, [2012-08-21T19:27:50.293399 #7989]  INFO -- : master process ready\nI, [2012-08-21T19:27:50.687491 #8083]  INFO -- : worker=0 ready\nI, [2012-08-21T19:27:50.751790 #8086]  INFO -- : worker=1 ready\ncache: [GET /] miss\n</code></pre>\n\n<p>Here is my current configuration structure:</p>\n\n<p><strong>nginx.conf</strong></p>\n\n<pre><code>user www-data;\nworker_processes  2;\ndaemon off;\n\nerror_log  /var/log/nginx/error.log;\npid        /var/run/nginx.pid;\n\nevents {\n  worker_connections  1024;\n}\n\nhttp {\n  include       /etc/nginx/mime.types;\n  default_type  application/octet-stream;\n\n  access_log    /var/log/nginx/access.log;\n\n  sendfile on;\n  tcp_nopush on;\n  tcp_nodelay on;\n\n  keepalive_timeout  65;\n\n  gzip  on;\n  gzip_http_version 1.0;\n  gzip_comp_level 2;\n  gzip_proxied any;\n  gzip_types text/plain text/html text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript application/javascript application/json;\n\n  server_names_hash_bucket_size 64;\n\n  include /etc/nginx/conf.d/*.conf;\n  include /etc/nginx/sites-enabled/*;\n}\n</code></pre>\n\n<p><strong>unicorn.rb</strong></p>\n\n<pre><code>worker_processes 2\nworking_directory \"/data/test/staging/current\"\n\npreload_app true\n\ntimeout 30\nlisten \"/data/test/staging/current/tmp/sockets/unicorn.sock\", :backlog =&gt; 64\n\npid \"/data/test/staging/current/tmp/pids/unicorn.pid\"\n\n# Set the path of the log files inside the log folder of the testapp\nstderr_path \"/data/test/staging/current/log/unicorn.stderr.log\"\nstdout_path \"/data/test/staging/current/log/unicorn.stdout.log\"\n\nbefore_fork do |server, worker|\n  defined?(ActiveRecord::Base) and\n    ActiveRecord::Base.connection.disconnect!\nend\n\nafter_fork do |server, worker|\n  defined?(ActiveRecord::Base) and\n    ActiveRecord::Base.establish_connection\nend\n</code></pre>\n\n<p><strong>000-default</strong></p>\n\n<pre><code>upstream test_server {\n #This is the socket we configured in unicorn.rb\n server unix:/data/test/staging/current/tmp/sockets/unicorn.sock »\n fail_timeout=0;\n}\nserver {\nlisten 80;\nclient_max_body_size 4G;\nserver_name http://ec2-23-22-53-139.compute-1.amazonaws.com;\n\nkeepalive_timeout 5;\n\n# Location of our static files\nroot /data/test/staging/current/public;\n\nlocation / {\n  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  proxy_set_header Host $http_host;\n  proxy_redirect off;\n\n  # If you don't find the filename in the static files\n  # Then request it from the unicorn server\n  if (!-f $request_filename) {\n    proxy_pass http://test_server;\n    break;\n  }\n}\n\nerror_page 500 502 503 504 /500.html;\nlocation = /500.html {\n  root /data/test/staging/current/public;\n}\n}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13245331,"title":"Collecting only a specific value and selecting as default","body":"<p>I have something like this as a select_tag :</p>\n\n<p><code>&lt;p&gt;&lt;%= setting_select :ui_theme, My::Themes.themes.collect {|t| [t.name, t.id]}, :blank =&gt; :label_default, :label =&gt; :label_theme %&gt;&lt;/p&gt;</code></p>\n\n<p>Rite now it is collecting all the values and displaying but I want to collect only a specific value and make it default. This value has name = \"Test\". </p>\n\n<p>Thus it should look like this and it should be default:</p>\n\n<p><code>&lt;option selected=\"selected\" value=\"Test\"&gt;Test&lt;/option&gt;</code></p>\n\n<p>Note : Here setting_select is a helper which is defined like this:</p>\n\n<pre><code>def setting_select(setting, choices, options={})\n    if blank_text = options.delete(:blank)\n      choices = [[blank_text.is_a?(Symbol) ? l(blank_text) : blank_text, '']] + choices\n    end\n    setting_label(setting, options).html_safe +\n      select_tag(\"settings[#{setting}]\",\n                 options_for_select(choices, Setting.send(setting).to_s),\n                 options).html_safe\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13025953,"title":"form_for undefined method `model_name' error","body":"<p>I'm having problem with form_for, have searched for the problem for the solutions given does not solve my problem.</p>\n\n<p>I'm trying to do up a form to create new recipes:</p>\n\n<pre><code>**app/views/recipes/new.html.erb**\n&lt;%= form_for @recipe do |f| %&gt;\n  &lt;% if @recipe.errors.any? %&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :recipename %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :recipename %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user_id %&gt;&lt;br /&gt;\n    &lt;%= f.number_field :user_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n\n\n<pre><code>**routes.rb**\nBaserecipe::Application.routes.draw do\n\n  resources :users\n  resources :recipes\n  ....\n  match '/createrecipe', to: 'recipes#new'\n</code></pre>\n\n<hr>\n\n<pre><code>**recipes_controller.rb**\nclass RecipesController &lt; ApplicationController\n\n  def create\n    @recipe = Recipe.new(params[:recipe])\n  end\nend\n</code></pre>\n\n<p>I'm alway getting the error:</p>\n\n<pre><code>undefined method `model_name' for NilClass:Class\n</code></pre>\n\n<p>Extracted source (around line #1): </p>\n\n<pre><code>1: &lt;%= form_for @recipe do |f| %&gt;\n2:   &lt;% if @recipe.errors.any? %&gt;\n3:   &lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>class Recipe &lt; ActiveRecord::Base\n  attr_accessible :recipename, :instruct1, :instruct2, :instruct3, :instruct4, :instruct5,\n  :instruct6, :instruct7, :instruct8, :instruct9, :instruct10, :instruct11, :instruct12,\n  :instruct13, :instruct14, :instruct15, :instruct16, :instruct17, :instruct18, :instruct19,\n  :instruct20, :instruct21, :instruct22, :instruct23, :instruct24, :instruct25, :instruct26,\n  :instruct27, :instruct28, :instruct29, :instruct30, :preptime, :cooktime\n\n  belongs_to :user\n  has_many :ingredients\n  has_many :rcomments\n\n  validates :recipename, presence: true, length: { maximum: 140 }\n  validates :user_id, presence: true\n  validates :preptime, presence: true\n  validates :cooktime, presence: true\n\n  default_scope order: 'recipes.created_at DESC'\nend\n</code></pre>\n\n<p>full trace:</p>\n\n<pre><code>activemodel (3.2.7) lib/active_model/naming.rb:163:in `model_name_from_record_or_class'\nactivemodel (3.2.7) lib/active_model/naming.rb:158:in `param_key'\nactionpack (3.2.7) lib/action_view/helpers/form_helper.rb:369:in `form_for'\napp/views/recipes/new.html.erb:3:in `_app_views_recipes_new_html_erb___168565054_39061080'\nactionpack (3.2.7) lib/action_view/template.rb:145:in `block in render'\nactivesupport (3.2.7) lib/active_support/notifications.rb:125:in `instrument'\nactionpack (3.2.7) lib/action_view/template.rb:143:in `render'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:47:in `block (2 levels) in render_template'\nactionpack (3.2.7) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.7) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:46:in `block in render_template'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:54:in `render_with_layout'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:45:in `render_template'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:18:in `render'\nactionpack (3.2.7) lib/action_view/renderer/renderer.rb:36:in `render_template'\nactionpack (3.2.7) lib/action_view/renderer/renderer.rb:17:in `render'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:110:in `_render_template'\nactionpack (3.2.7) lib/action_controller/metal/streaming.rb:225:in `_render_template'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:103:in `render_to_body'\nactionpack (3.2.7) lib/action_controller/metal/renderers.rb:28:in `render_to_body'\nactionpack (3.2.7) lib/action_controller/metal/compatibility.rb:50:in `render_to_body'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:88:in `render'\nactionpack (3.2.7) lib/action_controller/metal/rendering.rb:16:in `render'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'\nactivesupport (3.2.7) lib/active_support/core_ext/benchmark.rb:5:in `block in ms'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/benchmark.rb:295:in `realtime'\nactivesupport (3.2.7) lib/active_support/core_ext/benchmark.rb:5:in `ms'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:40:in `block in render'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'\nactiverecord (3.2.7) lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:39:in `render'\nactionpack (3.2.7) lib/action_controller/metal/implicit_render.rb:10:in `default_render'\nactionpack (3.2.7) lib/action_controller/metal/implicit_render.rb:5:in `send_action'\nactionpack (3.2.7) lib/abstract_controller/base.rb:167:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/rendering.rb:10:in `process_action'\nactionpack (3.2.7) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:414:in `_run__22188539__process_action__1016913818__callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.7) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/rescue.rb:29:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'\nactiverecord (3.2.7) lib/active_record/railties/controller_runtime.rb:18:in `process_action'\nactionpack (3.2.7) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.2.7) lib/action_controller/metal.rb:203:in `dispatch'\nactionpack (3.2.7) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.2.7) lib/action_controller/metal.rb:246:in `block in action'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:73:in `call'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:36:in `call'\njourney (1.0.4) lib/journey/router.rb:68:in `block in call'\njourney (1.0.4) lib/journey/router.rb:56:in `each'\njourney (1.0.4) lib/journey/router.rb:56:in `call'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:600:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.4.1) lib/rack/etag.rb:23:in `call'\nrack (1.4.1) lib/rack/conditionalget.rb:25:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/flash.rb:242:in `call'\nrack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\nrack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/cookies.rb:338:in `call'\nactiverecord (3.2.7) lib/active_record/query_cache.rb:64:in `call'\nactiverecord (3.2.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `_run__305680696__call__774818341__callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.7) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.7) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.7) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.7) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.7) lib/rails/engine.rb:479:in `call'\nrailties (3.2.7) lib/rails/application.rb:220:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.7) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","each"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13244946,"title":".each breaking if only 1 result - rails","body":"<p>For some reason, I keep getting an \"undefined method 'each'\" error every time I try to do the .each do when I have one result in the below.  </p>\n\n<p>If I use .inspect, I can see that there's a match.  Does .each work if there's not more than 1 result?  If not, what should I use instead?</p>\n\n<pre><code>&lt;% friends = graph.get_object(\"/me/friends\").map{ |hash| hash[\"id\"] } %&gt;\n\n&lt;% User.select([:id]).where(fbookid: friends).each do |common| %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>If I just run .inspect on the User.select line (no each), then I get </p>\n\n<pre><code>[#&lt;User id: 1&gt;]\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n\n<p>Thank you!</p>\n\n<p><em>UPDATE</em> </p>\n\n<p>Adding additional parameters seemed to allow me to use each...I have no clue why.  It's the same exact result (only 1).</p>\n\n<pre><code>User.select([:id, :email, :first_name]).where(fbookid: friends).each do |friend|\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","searchlogic"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":13220807,"title":"Rails: Stack level too deep error","body":"<p>My rails app has 3 models. Trail, Region and Feature. I am able to interact with these models fine in my lib/tasks directory. I used anemone to crawl and populate the database. Examples of calls I made on the models:</p>\n\n<pre><code>Trail.find_or_initialize_by_title(detail_title)\n</code></pre>\n\n<p>I am now trying to write a controller that uses the model. </p>\n\n<pre><code>class TrailController &lt; ApplicationController\n    def index\n        render :json =&gt; Trail.all\n    end\nend\n</code></pre>\n\n<p>Now if i open rails console and try <code>app.get('trail/index')</code> I get a 500 return code and I see the following in my <code>development.log</code></p>\n\n<blockquote>\n  <p>SystemStackError (stack level too deep):<br>\n  app/controllers/trail_controller.rb:23:in `index'</p>\n</blockquote>\n\n<p>So I'm obviously causing some infinite recursion. Line 23 corresponds to the body of the index method. I've tried the other models in my app: Feature and Region and the result is the same. Can someone tell me what I'm doing wrong here, or how I can get more tracing to figure out what exactly is recursing infinitely?</p>\n\n<p>My models are very simple:</p>\n\n<pre><code>class Feature &lt; ActiveRecord::Base \n  attr_accessible :name \n  has_and_belongs_to_many :trails \n  validates :name, :presence =&gt; true\nend \n\nclass Region &lt; ActiveRecord::Base \n  attr_accessible :hash_key, :name \n  has_many :trails \n  validates :hash_key, :name, :presence =&gt; true \nend \n\nclass Trail &lt; ActiveRecord::Base \n  # attr_accessible :title, :body \n  has_and_belongs_to_many :features \n  validates :title, :presence =&gt; true    \nend\n</code></pre>\n\n<p>It appears this is somehow being caused by the searchlogic gem. I have this in my Gemfile:</p>\n\n<pre><code>gem 'rd_searchlogic', :require =&gt; 'searchlogic', :git =&gt; 'git://github.com/railsdog/searchlogic.|~                                                                                                    \n</code></pre>\n\n<p>When i comment out that line, run bundle install and retry app.get things work fine. So searchlogic is somehow interfering with Trail.all. Why won't Trail.all work with searchlogic installed?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13245072,"title":"How do I not use current_user in the model","body":"<p>I have a form to create posts. This form also has tags on the post and it is owned by a user. The form is using a virtual attribute :tag_ids. </p>\n\n<p>I would like to do something like this, where you find_or_create_by_name_and_user_id and then just pass the current_user.id.</p>\n\n<pre><code>def tag_ids=(tags_string)\n    self.taggings.destroy_all\n    tag_names = tags_string.split(\",\").collect{|s| s.strip.downcase}.uniq\n    tag_names.each do |tag_name|\n      tag = Tag.find_or_create_by_name_and_user_id(tag_name, current_user.id)\n      tagging = self.taggings.new\n      tagging.tag_id = tag.id\n    end\nend\n</code></pre>\n\n<p>From what I read this isn't how it should work. The current user should be called in the PostsContoller create method. </p>\n\n<pre><code>def create\n  @post = Post.new(params[:post])\n  @post.user = current_user\n  respond_to do |format|\n     if params[:commit]\n     @post.save\n</code></pre>\n\n<p>...\nend</p>\n\n<p><em>This is where I'm stuck.</em> <strong>If the params are passing all of the attributes, how can I inject the current_user id into tag model which has a :name and :user_id attribute?</strong> </p>\n\n<p>I also read that this should work because of my associations.</p>\n\n<p>User - has_many posts; has_many tags</p>\n\n<p>Post - belongs_to user; has_many taggings; has_many tags through taggings</p>\n\n<p>Tag - has many taggings; has_many posts through taggings; belongs_to user</p>\n\n<p>Tagging - belongs_to post; belongs_to tag</p>\n"},{"tags":["ruby-on-rails","ruby","if-statement","omniauth"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13244345,"title":"Checking if the email had been already taken in the following if statement (Rails)?","body":"<p>I have the following action:</p>\n\n<p><strong>users.rb:</strong></p>\n\n<pre><code>  def omniauth_create\n    auth = request.env[\"omniauth.auth\"]\n    user = User.from_omniauth(env[\"omniauth.auth\"])\n    unless user.email.blank?\n      if user.id.nil?\n        # Save the user since he hasn't been created yet\n        user.save!\n      end\n      sign_in user\n      redirect_back_or user\n    else\n      # Send user to a form to fill his email\n      #session[:omniauth] = request.env['omniauth.auth'].except('extra')\n      redirect_to(enter_email_path(oprovider: user.provider,\n                                   ouid: user.uid,\n                                   oname: user.name,\n                                   opassword: user.password,\n                                   opassword_confirmation: user.password))\n    end\n  end\n</code></pre>\n\n<p>It does the following: </p>\n\n<ul>\n<li>If the user's <code>email</code> is not blank, sign him in, and redirect him to his profile (and save him if his <code>id</code> is <code>nil</code>. In other words, if he hasn't been created yet).</li>\n<li>If the user's <code>email</code> is blank, send him to <code>enter_email_path</code> (where the user can enter his email).</li>\n</ul>\n\n<p>Now I want to add another if statement that flashes an error if the <code>email</code> had been already taken, and redirects the user to the <code>root_path</code></p>\n\n<p>I'm not very sure how to do this, Any suggestions? (and where to put that if statement?)</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Strange, got this instead of the redirect to the root path:</p>\n\n<pre><code>Validation failed: Email has already been taken\n</code></pre>\n\n<p>I don't know if this helps but here is the origin of <code>from_omniauth</code>:</p>\n\n<pre><code>  def self.from_omniauth(auth)\n    find_by_provider_and_uid(auth[\"provider\"], auth[\"uid\"]) || User.create_with_omniauth(auth)\n  end\n\n  def self.create_with_omniauth(auth)\n    new do |user|\n      user.provider = auth[\"provider\"]\n      user.uid = auth[\"uid\"]\n      user.name = auth[\"info\"][\"name\"]\n      user.email = auth[\"info\"][\"email\"]\n      user.password = user.password_confirmation = SecureRandom.urlsafe_base64(n=6) \n    end\n  end\n</code></pre>\n\n<p>The code as it is right now:</p>\n\n<p><strong>user.rb</strong>:</p>\n\n<pre><code># if user.email.present?\n  if user.id.nil?\n    # User.find_by_email(user.email).present?\n    if User.exists?(:email =&gt; user.email)\n      redirect_to root_path\n    end\n    user.save!\n  end\n  sign_in user\n  redirect_back_or user\nelse\n</code></pre>\n\n<p>(the rest didn't change).</p>\n\n<p>It seems like the code is ignoring the <code>if User.exists?(:email =&gt; user.email)</code> part?</p>\n"},{"tags":["ruby-on-rails","ruby","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13190042,"title":"Unicorn workers' first responses are slower by few seconds","body":"<p>I can't figure out how I can get my unicorn workers to only accept connections when they're really \"ready\" to process a request. I find that the first few requests are slow, then they speed up dramatically (from a few seconds down to a hundred or so ms). This problem seems to be compounded by the fact that unicorn seems to kill workers after a certain amount of time, meaning that I'm constantly facing the performance hit of the slow first request. Has anyone else seen this or have an idea of what I can do?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","introspection","pluralize"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13244176,"title":"Rails: how to see pluralized and single form of names","body":"<p>I has created a model Anonymous with command </p>\n\n<pre><code>rails g model Anonymous section_id:integer aid:string fake:bool active:bool\n</code></pre>\n\n<p>but table name in the migration is called anonymous</p>\n\n<pre><code>class CreateAnonymous &lt; ActiveRecord::Migration\n  def change\n    create_table :anonymous do |t|\n      t.integer :section_id\n      t.string :aid\n      t.bool :fake\n      t.bool :active\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Am i right that pluralized form of Anonymous is Anomymous too ? (English is not my native language). How can i see what pluralized names Rails gives to my models ? Something like <code>rake routes</code> ?</p>\n"},{"tags":["ruby-on-rails","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13222476,"title":"Paperclip reports that an uploaded image is missing. How can I make it find it?","body":"<p>Paperclip is able to successfully upload an image (it is uploaded to the appropriate folder on the server). However, when I try to view the image, it reports it as missing.</p>\n\n<p>models/photo.rb:</p>\n\n<pre><code>class Photo &lt; ActiveRecord::Base\nattr_accessible :image\nattr_accessor :image_file_name, :image_file_size, :image_updated_at\nhas_attached_file :image, styles: {small: \"300x300&gt;\" },\nurl  \"/photos/:id/:style/:basename.:extension\",\npath: \":rails_root/public/photos/:id/:style/:basename.:extension\" \n\n\nvalidates_attachment_presence :image\nvalidates_attachment_size :image, less_than: 5.megabytes\nend\n</code></pre>\n\n<p>Viewing the image: (photos/show.html.erb):</p>\n\n<pre><code>&lt;% if @photo.image? %&gt;\n    &lt;%= image_tag @photo.image.url(:small) %&gt;\n&lt;% else %&gt;\n    Missing image &lt;%= @photo.id %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This outputs \"Missing image\" with the correct photo id.</p>\n\n<p>Despite this, uploaded photos are stored at the correct path, and are accessible via the correct url, e.g. </p>\n\n<pre><code> http://localhost:3000/photos/1/small/1351546785_accepted_48.png\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","ruby","unit-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13240175,"title":"How to change test database schema (rails unit test)","body":"<p>I am running into a frustrating issue when trying to unit test a specific function of my app.</p>\n\n<p>The process is carried out as such:</p>\n\n<ol>\n<li>Create a temporary 'audience' table</li>\n<li>Call function foo, which inserts certain user data into the 'audience' table</li>\n<li>Drop the 'audience' table</li>\n</ol>\n\n<p>In order to test function foo, I need to create the temporary table within my unit test.  My plan is to create the table within the setup method, and drop it within the teardown method.  I'll call function foo, and depending on if data is inserted into 'audience', that will determine if my test passed or failed.  There's only one problem.  Changing the database schema within the unit test file seems to cause problems.  The error that I get is:</p>\n\n<pre><code>ActiveRecord::StatementInvalid: Mysql2::Error: SAVEPOINT active_record_1 does not exist: ROLLBACK TO SAVEPOINT active_record_1\n</code></pre>\n\n<p>It seems like changing the schema ruins the rollback feature that Rails implements in the unit tests.  Is there any way that I can create and drop this table outside of the rollback scope? One idea I had to get around this was to create a migration that added the 'audience' table to my test database, but I'd like to keep everything contained within the same unit test file.</p>\n"},{"tags":["ruby-on-rails","nested-forms","simple-form"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":3398,"score":5,"question_id":6629038,"title":"an example of a nested form in simple form?","body":"<p>I am still struggling both writing the controller and the actual form to be able to nest one form in another with an optional model?</p>\n\n<p>I have Message which has many contacts</p>\n\n<p>When submitting a message, I want to add a contact optionally.</p>\n\n<p>I have this as an example:</p>\n\n<pre><code>= simple_form_for Message.new, :remote =&gt; true do |f|\n  #message_form\n    = f.error_messages\n    %p\n      = f.input :account_name, :url =&gt; autocomplete_account_name_messages_path, :size =&gt; 40, :as =&gt; :autocomplete\n    %p\n      = f.input :topic, :required =&gt; true,\n                :input_html =&gt; {:size =&gt; 30}\n\n    #add_contact_btn\n      = link_to \"Add Contact\"\n\n      #contact_form\n        = f.simple_fields_for :contactd do |fc|\n        = fc.input :email\n        = fc.input :first_name\n        = fc.input :last_name\n\n    = f.submit 'Give'\n    = f.submit 'Request'\n</code></pre>\n\n<p>For Message.rb model, I have the following:</p>\n\n<pre><code>has_many :contacts\naccepts_nested_attributes_for :contacts, :reject_if =&gt;:all_blank\n</code></pre>\n\n<p>Note:  When I used :contacts in the simple_fields_for it didn't work, so it is singular.  But the reverse for accepts_nested_attributess_for.</p>\n\n<p>In my create controller for message, I included message.contacts.build</p>\n\n<p>But right now I am still generating nil contacts.</p>\n\n<p>Here is what I see passed as form data from google chrome:</p>\n\n<pre><code>message%5Baccount_name%5D:McKesson\nmessage%5Btopic%5D:testing a contact\nmessage%5Bbody%5D:testing this\nsender_id:\nreceiver_id:23\nmessage%5Bcontacts%5D%5Bemail%5D:888@gmail.com\nmessage%5Bcontacts%5D%5Bfirst_name%5D:Ang\nmessage%5Bcontacts%5D%5Blast_name%5D:Name\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13244182,"title":"To pass integer value in render partial form in ruby on rails","body":"<p>I got a task to pass one integer value to another partial form. My code was this</p>\n\n<pre><code>&lt;div class=\"fields\"&gt;\n  &lt;p&gt;\n    &lt;%= f.label :content, \"Student\" %&gt;&lt;br/&gt;\n    &lt;%= f.text_field :content %&gt;\n    &lt;%= link_to_remove_fields \"remove\", f %&gt;&lt;br /&gt;\n  &lt;/p&gt;\n  &lt;h4&gt;Address&lt;/h4&gt;\n  &lt;% i = 1 %&gt;\n  &lt;% f.fields_for :answers do |builder| %&gt;\n    &lt;%= render :partial =&gt; 'answer_fields', :locals =&gt; {:i =&gt; i, :f =&gt; builder} %&gt;\n    &lt;% i = i + 1 %&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;&lt;%= link_to_add_fields \"Add Address\", f, :answers %&gt;&lt;/p&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But in the partial form i got an error like </p>\n\n<pre><code>undefined local variable or method `i'\n</code></pre>\n\n<p>My partial form is </p>\n\n<pre><code>&lt;p class=\"fields\"&gt;\n  &lt;table&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;%= f.label :content, \"Address\"+i.to_s %&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;%= f.text_field :content %&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;%= link_to_remove_fields \"remove\", f %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>How can i pass the value of i to other partial form?</p>\n"},{"tags":["jquery","ruby-on-rails","forms","jquery-tokeninput"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12934893,"title":"jquery tokeninput input parameter missing","body":"<p>I am following railscasts episode 258 about jquery tokeninput.</p>\n\n<p>I do not know why the user's input does not reach the input parameter for the users query?</p>\n\n<p>My database is postgres.</p>\n\n<p>pharmacies controller</p>\n\n<pre><code>    def index\n      @pharmacies = Pharmacy.order(:name)\n      respond_to do |format|\n        format.html\n        format.json { render json: @pharmacies.tokens(params[:q]) }\n      end\n    end\n</code></pre>\n\n<p>user model</p>\n\n<pre><code>  def pharmacy_tokens=(tokens)\n    self.pharmacy_ids = Pharmacy.ids_from_tokens(tokens)\n  end\n</code></pre>\n\n<p>pharmacy model</p>\n\n<pre><code>  def self.tokens(query)\n    pharmacies = where('lower(name) LIKE ? or name LIKE ?', \"%#{query}%\", \"%#{query}%\")\n    if pharmacies.empty?\n      [{id: \"&lt;&lt;&lt;#{query}&gt;&gt;&gt;\", name: \"New: \\\"#{query}\\\"\"}]\n    else\n      pharmacies\n    end\n  end\n</code></pre>\n\n<p>users view</p>\n\n<pre><code>    &lt;div class=\"field\"&gt;\n      &lt;%= f.label :pharmacy_tokens, \"Pharmacies\" %&gt;&lt;br /&gt;\n      &lt;%= f.text_field :pharmacy_tokens, data: {load: @user.pharmacies} %&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>users's.js.coffee</p>\n\n<pre><code>    jQuery -&gt;\n    $('#user_pharmacy_tokens').tokenInput '/pharmacies.json'\n    theme: 'facebook'\n    prePopulate: $('#user_pharmacy_tokens').data('load')\n    preventDuplicates: true\n    queryParam: \"q\"\n</code></pre>\n\n<p>Result</p>\n\n<pre><code>    Processing by PharmaciesController#index as JSON\n    Parameters: {\"locale\"=&gt;\"en\"}\n    (0.6ms)  SELECT COUNT(*) FROM \"pharmacies\" WHERE (lower(name) LIKE '%%' or name LIKE '%%')\n    Pharmacy Load (0.8ms)  SELECT \"pharmacies\".* FROM \"pharmacies\" WHERE (lower(name) LIKE '%%' or name LIKE '%%') ORDER BY pharmacies.name ASC, name\n    Completed 200 OK in 30ms (Views: 27.0ms | ActiveRecord: 1.4ms)\n</code></pre>\n\n<p>When typing into the text_field the javascript works, it's just that the text is no longer in the query... just my empty 'like' percent signs.. '%%'. What happened to my input here?</p>\n\n<p>thank you in advance.</p>\n"},{"tags":["ruby-on-rails","activeadmin","chosen","ancestry"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13244316,"title":"Dynamic select with ancestry gem and chosen","body":"<p>I am looking for dynamic select by using chosen and ancestry gem and I hope someone done this before.</p>\n\n<p>I have around 2000 (categories, subcategories and keywords) all are in STI and have a tree structure. In my form  I'm using three select input for categories | subcategories | keywords, but I  get huge list of subcategories and even bigger list of keywords. I want to hide all subcategories, that are not children of preselected categories; same with keywords.</p>\n\n<p>Hopefully this is has a sense, what I am trying to do. I would greatly appreciate any ideas.</p>\n\n<p>Here what I have so far, and all of this code is working great.</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\nhas_and_belongs_to_many :categories, :join_table =&gt; \"companies_categories\"\nhas_and_belongs_to_many :subcategories, :join_table =&gt; \"companies_subcategories\"\nhas_and_belongs_to_many :keywords, :join_table =&gt; \"companies_keywords\"\nend\n\nclass Category &lt; ActiveRecord::Base\nhas_ancestry  :cache_depth =&gt; true, :depth_cache_column =&gt; :ancestry_depth\n\nhas_many :subcategories, :class_name =&gt; \"Category\", :foreign_key =&gt; :subcategory_id\nhas_many :keywords, :class_name =&gt; \"Category\", :foreign_key =&gt; :keyword_id\n\nbelongs_to :category\n\nhas_and_belongs_to_many :companies, :join_table =&gt; \"companies_categories\"\nhas_and_belongs_to_many :companies, :join_table =&gt; \"companies_subcategories\", :association_foreign_key =&gt; \"subcategory_id\"\nhas_and_belongs_to_many :companies, :join_table =&gt; \"companies_keywords\", :association_foreign_key =&gt; \"keyword_id\"\n\nend  \n</code></pre>\n\n<p>Here is javascript</p>\n\n<pre><code>jQuery(function($){\n$(\".chosen-input\").chosen();\n$(\".schosen-input\").chosen();\n$(\".kchosen-input\").chosen();\n});    \n</code></pre>\n\n<p>Here is my form</p>\n\n<pre><code>form :html =&gt; { :enctype =&gt; \"multipart/form-data\" }  do |f|\nf.inputs \"New Company\" do\n  f.input :name,  :required =&gt; true\nend\n\nf.inputs \"Categories\" do\n\n  f.input :categories,\n          :input_html =&gt; { :class =&gt; \"chosen-input\", :multiple =&gt; true, :style =&gt; \"width: 700px;\"},\n          :collection =&gt; Category.where(:ancestry_depth =&gt; '2')\n\n\n  f.input :subcategories,\n          :input_html =&gt; { :class =&gt; \"schosen-input\", :multiple =&gt; true, :style =&gt; \"width: 700px;\"},\n          :collection =&gt; Category.where(:ancestry_depth =&gt; '3')\n\n\n  f.input :keywords,\n          :input_html =&gt; { :class =&gt; \"schosen-input\", :multiple =&gt; true, :style =&gt; \"width: 700px;\"},\n          :collection =&gt; Category.where(:ancestry_depth =&gt; [4, 5, 6])\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13244296,"title":"simple_form and i18n of DATE::abbr_daynames","body":"<p>I am using the following line to obtain a select box with all the week days</p>\n\n<pre><code>= f.select :day, Date::ABBR_DAYNAMES.each_with_index.to_a\n</code></pre>\n\n<p>I need the week days translated according to my locale. I am not sure why it is not working. </p>\n\n<p>I am using the <code>simpleform</code> gem for the form builder.</p>\n\n<p>I went on to debug in the console and discovered:</p>\n\n<pre><code>I18n.t Date::ABBR_DAYNAMES.each_with_index.to_a\n =&gt; \"translation missing: es.Sun.0\"\n</code></pre>\n\n<p>I am not sure why this is happening since my es.yml file contains:</p>\n\n<pre><code>es:\n  Sun: \n    0: Dom\n</code></pre>\n\n<p>I am also wondering if there is another way of getting a select box with the week days. This way of writing the es.yml entries feels a bit hacky.</p>\n"},{"tags":["ruby-on-rails","garb-gem","vanity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13244281,"title":"Vanity not fetching my Google Analytics data (via Garb)","body":"<p>According to Rails Console, garb is set up correctly:</p>\n\n<pre><code>Garb::Session.login(\"email@address.com\", \"password\")\n =&gt; \"very_long_string\"\n</code></pre>\n\n<p>I have defined the following metric in /experiments/metrics/acquire.rb:</p>\n\n<pre><code>metric \"Acquire\" do\n  description \"Unique visitors on any given page, as tracked by Google Analytics\"\n  google_analytics \"UA-35023753-1\", :visitors\nend\n</code></pre>\n\n<p>I have not yet tied this to any experiments.</p>\n\n<p>My Vanity dashboard loads just fine.</p>\n\n<p>My non-Google Analytics charts load just find.</p>\n\n<p>But where you'd expect to see a Google Analytics based chart I instead see:</p>\n\n<pre><code>&lt;div class=\"error\"&gt;\n...\n\\n &amp;lt;/style&amp;gt;\\n &amp;lt;a href=//www.google.com/&amp;gt;&amp;lt;img src=//www.google.com/images/errors/logo_sm.gif alt=Google&amp;gt;&amp;lt;/a&amp;gt;\\n &amp;lt;p&amp;gt;&amp;lt;b&amp;gt;404.&amp;lt;/b&amp;gt; &amp;lt;ins&amp;gt;That\\xE2\\x80\\x99s an error.&amp;lt;/ins&amp;gt;\\n &amp;lt;p&amp;gt;The requested URL &amp;lt;code&amp;gt;/analytics/feeds/accounts/default&amp;lt;/code&amp;gt; was not found on this server. &amp;lt;ins&amp;gt;That\\xE2\\x80\\x99s all we know.&amp;lt;/ins&amp;gt;\\n&amp;quot;&lt;/div&gt;\n</code></pre>\n\n<p>I have read that the original Garb gem is trying to access deprecated elements of the Google Analytics API so I tried switching to a newer fork of the gem by pointing to its git repository in my gemfile, but when I did so my app wouldn't start at all, giving an <code>Initialize': uninitialized constant Garb::Resource (NameError)</code> error, which I'm trying to resolve in parallel with resolving this issue.</p>\n\n<p>What should I do?</p>\n"},{"tags":["ruby-on-rails","apache2","passenger","virtualhost","ubuntu-12.04"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13243877,"title":"Rails in subdirectory: not finding config.ru","body":"<p>I'm trying to deploy a simple Rails 3.2.8 app to a subdirectory on a remote Apache2/Passenger server. </p>\n\n<p>I've followed the relevant <a href=\"http://www.modrails.com/documentation/Users%20guide%20Apache.html#deploying_rack_to_sub_uri\" rel=\"nofollow\">Passenger instructions</a>: on the server, the Rails app is stored in ~/public/foo2.com with a symlink to ~/public/foo.com/public/rails, so that the app can be served at foo.com/rails. </p>\n\n<p>It's worth noting that I have a second virtual host file pointing foo2.com to the app and that, on my local machine, /etc/hosts points foo2.com to the server IP. In other words, the app is functional on the server when it's the root. The problem seems to be specifically related to the configuration of serving it from the subdirectory foo.com/rails.</p>\n\n<p>Here's the Passenger error:</p>\n\n<pre><code>Error message:\nNo such file or directory - config.ru\nException class:\nErrno::ENOENT\nApplication root:\n/home/aaron/public/foo.com/public\n</code></pre>\n\n<p>And the backtrace:</p>\n\n<pre><code>#   File    Line    Location\n0   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/utils.rb 675 in `lstat'\n1   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/utils.rb 675 in `lower_privilege'\n2   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/utils.rb 198 in `prepare_app_process'\n3   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/rack/application_spawner.rb  156 in `block in initialize_server'\n4   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/utils.rb 563 in `report_app_init_status'\n5   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/rack/application_spawner.rb  154 in `initialize_server'\n6   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/abstract_server.rb   204 in `start_synchronously'\n7   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/abstract_server.rb   180 in `start'\n8   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/rack/application_spawner.rb  129 in `start'\n9   /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/spawn_manager.rb 253 in `block (2 levels) in spawn_rack_application'\n10  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/abstract_server_collection.rb    132 in `lookup_or_add'\n11  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/spawn_manager.rb 246 in `block in spawn_rack_application'\n12  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/abstract_server_collection.rb    82  in `block in synchronize'\n13      prelude&gt;    10:in `synchronize'\n14  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/abstract_server_collection.rb    79  in `synchronize'\n15  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/spawn_manager.rb 244 in `spawn_rack_application'\n16  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/spawn_manager.rb 137 in `spawn_application'\n17  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/spawn_manager.rb 275 in `handle_spawn_application'\n18  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/abstract_server.rb   357 in `server_main_loop'\n19  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/lib/phusion_passenger/abstract_server.rb   206 in `start_synchronously'\n20  /usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.17/helper-scripts/passenger-spawn-server  99  in `'\n\n\n&lt;VirtualHost *:80&gt;\n  ServerName  foo.com\n  ServerAlias www.foo.com\n\n  DirectoryIndex index.html index.php\n  DocumentRoot /home/aaron/public/foo.com/public\n\n  RackBaseURI /rails\n  &lt;Directory /home/aaron/public/foo2.com&gt;\n     Options -MultiViews\n  &lt;/Directory&gt;\n\n  LogLevel warn\n  ErrorLog  /home/aaron/public/foo.com/log/error.log\n  CustomLog /home/aaron/public/foo.com/log/access.log combined\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>I've also restarted Apache since making these changes. Any help would be much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","login","devise","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13129254,"title":"How to direct user to a specific page after logging in with Devise and Rails","body":"<p>How do I redirect a user to a specific page when they login on a particular form I create with Devise? There's this howto page for Devise on <a href=\"https://github.com/plataformatec/devise/wiki/How-to%3a-redirect-to-a-specific-page-on-successful-sign-in-out\" rel=\"nofollow\">how to redirect to a particular page after sign in</a>. However, I want different forms to sign in to different target pages. Ideally, I can just add another HTML form parameter like this:</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"target\" value=\"/dashboard\"/&gt;\n</code></pre>\n\n<p><em><strong>UPDATE</em></strong>: It's important that I maintain the normal functionality of Devise for a login page. That is, if I click on a link that has a <code>before_filter :authenticate_user!</code> in its controller, then I'll be redirected to a login page. After logging in, then I'm redirected to the original destination page.</p>\n"},{"tags":["ruby-on-rails","gem","sass"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13244056,"title":"error executing bundle install in sass version","body":"<p>I executed bundle install in but I got this error:</p>\n\n<p><code>Installing sass (3.2.1)\nErrno::EACCES: Permission denied - C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9\n.1/bin/sass\nAn error occured while installing sass (3.2.1), and Bundler cannot continue.\nMake sure that gem install sass -v '3.2.1' succeeds before bundling.</code></p>\n\n<p>I tried checking the sass version installed and I come up with this:</p>\n\n<p><code>C:\\RailsInstaller\\Ruby1.9.3\\bin&gt;sass -v\nSass 3.1.20 (Brainy Betty)</code></p>\n\n<p>Don't know how to resolve this problem, any help?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13243385,"title":"Can't mass-assign protected attributes: _destroy - Ruby on Rails","body":"<p>I'm getting this error:</p>\n\n<p>\"ActiveModel::MassAssignmentSecurity::Error in DaysController#create</p>\n\n<p>Can't mass-assign protected attributes: _destroy\"</p>\n\n<p>I didn't even know that _destroy is an attribute!</p>\n\n<p>What I have going on:</p>\n\n<p>My model is that I have \"Trips\" which has many \"Days\"</p>\n\n<p>In the \"Show\" view of my Trips model, I'm rendering a partial for a Form to add a new \"Day\":</p>\n\n<pre><code>&lt;div id=\"day_form\"&gt;\n  &lt;%= render :partial =&gt; \"day_form\", :day =&gt; @day %&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>My model:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :title, :days_attributes\n  has_many :days\n  accepts_nested_attributes_for :days, allow_destroy: true\n\nend\n\n\n class Day &lt; ActiveRecord::Base\n  attr_accessible :activity_id, :order, :summary, :trip_id, :activities_attributes\n  belongs_to :trip\n  has_many :activities, :order =&gt; 'position'\n  accepts_nested_attributes_for :activities, allow_destroy: true \nend\n</code></pre>\n\n<p>When I submit the form, I am getting this Mass Assignment error.  Why?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The 'Day' Form looks like this:</p>\n\n<pre><code>    &lt;%= form_for(@day) do |f| %&gt;\n\n      &lt;ul&gt;\n      &lt;% @day.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n        &lt;fieldset&gt;\n          &lt;%= f.label :summary, \"Day Summary\" %&gt;&lt;br /&gt;\n          &lt;%= f.text_area :summary, :rows =&gt; 1 %&gt;&lt;br /&gt;\n          &lt;%= f.hidden_field :_destroy %&gt;\n              &lt;%= link_to \"remove\", '#', class: \"remove_fields\" %&gt;\n        &lt;/fieldset&gt;\n        &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n        &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13237399,"title":"Rails simple_fields_for can't hide :id","body":"<p>I've been using simple_form for rails together with HAML</p>\n\n<p>I have a number of line_items they have a unique id which i retrieve from the Order object</p>\n\n<pre><code>    = f.simple_fields_for :line_items do |line_items|\n     .f.input :id unless @order.status?\n     .f.input :cost unless @order.status?\n</code></pre>\n\n<p>However, whenever i iterate through these list, i would like to hide (remove from the form) the line_items id, i try to put a unless statement to remove other parameters and it works (eg. :cost) but for the :id it appears to be a hidden fields </p>\n\n<pre><code>     &lt;input id=\"order_line_items_attributes_2_id\" name=\"order[line_items_attributes][2][id]\" type=\"hidden\" value=\"26\"&gt;\n</code></pre>\n\n<p>How can i successfully remove IDs from appearing in the fields just like how i did it for :cost?</p>\n"},{"tags":["ruby-on-rails","dynamic","associations","ruby-on-rails-3.2","has-many-through"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13243726,"title":"Automatically create associations through many existing associations","body":"<p>I'm working on an engine where any model can have a has_many association with Permit as Permissible:</p>\n\n<pre><code>class Permit &lt; ActiveRecord::Base\n  belongs_to :permissible, polymorphic: true\nend\n\nmodule Permissible\n  def self.included(base)\n    base.class_eval do\n    has_many :permits, as: :permissible\n  end\nend\n\nclass Group &lt; ActiveRecord::Base\n  include Permissible\nend\n\nclass GroupAllocation &lt; ActiveRecord::Base\n  belongs_to :person\n  belongs_to :group\nend\n\nclass Person &lt; ActiveRecord::Base\n  include Permissible\n  has_many :group_allocations\n  has_many :groups, through: :group_allocations\nend\n\nclass User &lt; ActiveRecord::Base\n  belongs_to :person\nend\n</code></pre>\n\n<p>So, Group has_many :permits and Person has_many :permits. What I am trying to do is dynamically create associations on User that uses the permits association as a source, and chain associations on other models down to User by doing the same. This can be done manually (in rails 3.1+) with:</p>\n\n<pre><code>class Person\n  has_many :group_permits, through: :person, source: :permits\nend\n\nclass User\n  has_many :person_permits, through: :person, source: :permits, class_name: Permit\n  has_many :person_group_permits, through: :person, source: :group_permits, class_name: Permit\nend\n</code></pre>\n\n<p>However, in practice, Permissible will be included on many models, so I'm trying to write a class method on User (actually within another module, but no need to confuse things more) that can traverse User.reflect_on_all_associations and create an array of new associations, which may be many associations deep each.</p>\n\n<p>Looking for input on how to do this cleanly in rails 3.2.8.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13243634,"title":"How do I sort a collection / enum by a custom method in ruby/rails?","body":"<p>In Rails, let's I have a collection of Categories:</p>\n\n<pre><code>@categories = Category.order('name asc')\n</code></pre>\n\n<p>One of these categories has the name \"New\". I'd like to have the \"New\" category first in the collection, and the rest alphabetical. </p>\n\n<p>I'd like to only do one database query. I'd like this to be as concise as possible.</p>\n\n<p>If the one query limit was not in place, I know I could fetch the \"New\" category, and then fetch the rest of the categories in order by name, and then \"unshift\" the new category to the @categories collection, but there must be a better way!</p>\n\n<pre><code>@new = Category.where(name: 'name').first\n@categories = Category.where(\"name != ?\", 'Name').order('name asc')\n@categories.unshift(@new)\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","authorization","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":12882284,"title":"load_resource get a nil resource","body":"<p>In my controller I have:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n  load_and_authorize_resource\n\n  def create\n\n    respond_to do |format|\n      if @user.save\n        format.html { redirect_to @user, notice: 'User was successfully created.' }\n        format.json { render json: @user, status: :created, location: @user }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>But I get <code>undefined method 'save' for nil:NilClass</code></p>\n\n<pre><code>Failures:\n\n1) UsersController if the user passes all the authorizations POST #create should create a new User with some parameters\n Failure/Error: post :create, :user =&gt; { :email =&gt; 'puppa@puppa.pup' }\n NoMethodError:\n   undefined method `save' for nil:NilClass\n # ./app/controllers/users_controller.rb:47:in `block in create'\n # ./app/controllers/users_controller.rb:46:in `create'\n # ./spec/controllers/users_controller_spec.rb:66:in `block (4 levels) in &lt;top (required)&gt;'\n\nFinished in 0.10714 seconds\n1 example, 1 failure\n</code></pre>\n\n<p>I was expecting <code>load_resources</code> to populate <code>@user = User.new(params[:user])</code></p>\n\n<p>I was looking at CanCan internals following the entire flow and I discovered that in <code>controller_resource.rb</code> when we reach <code>#build_resource</code> we have:</p>\n\n<pre><code>def build_resource\n  resource = resource_base.new(resource_params || {})\n  assign_attributes(resource)\nend\n</code></pre>\n\n<p>But <code>resource</code> here is <code>nil</code>... it's normal? what I'm missing? It's related with my problem with create action?</p>\n\n<p>EDIT</p>\n\n<p>here is my <code>ability.rb</code></p>\n\n<pre><code>class Ability\n  include CanCan::Ability\n\n  def initialize(user)\n    # Define abilities for the passed in user here. For example:\n\n    # check if the user is registered or a guest user (not logged in)\n    if user.present?\n\n      if user.any_role? :super_admin\n        can :manage, :all\n      end\n\n      if user.any_role? :admin\n        can :manage, [User, Institution, Project, Order]\n      end\n\n      if user.any_role? :user\n        can :show, Project\n        can [:add, :change], :cart\n        can [:create, :show], Order, :user_id =&gt; user.id\n        can :download, UrlConnector\n      end\n\n    end\n  end\nend\n</code></pre>\n\n<p>EDIT 2</p>\n\n<p>While calling POST create I have:</p>\n\n<p>in RSpec environment:</p>\n\n<pre><code>resource_base: User\nresource_class: User\n@params: {\"user\"=&gt;{\"email\"=&gt;\"puppa@puppa.pup\"}, \"controller\"=&gt;\"users\", \"action\"=&gt;\"create\"}\n</code></pre>\n\n<p>in browser as <code>superadmin</code> or <code>admin</code>, it's the same:</p>\n\n<pre><code>resource_base: User\nresource_class: User\n@params: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"95qQ4H/+CLU96jCIO6U/YtgIQ5zWxE7pg0BedVMPSGk=\", \"user\"=&gt;{\"email\"=&gt;\"estanost@alumnes.ub.edu\", \"password\"=&gt;\"264763\", \"password_confirmation\"=&gt;\"264763\", \"ragionesociale\"=&gt;\"fff\", \"partitaiva\"=&gt;\"12345678901\", \"address\"=&gt;\"via plutarco, 36\", \"city\"=&gt;\"Manduria\", \"cap\"=&gt;\"74024\", \"phone\"=&gt;\"099979456\", \"role_ids\"=&gt;[\"3\"]}, \"commit\"=&gt;\"Create User\", \"action\"=&gt;\"create\", \"controller\"=&gt;\"users\"}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","json","hash","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13235179,"title":"Compare json response with array of hashes","body":"<p>When I get an array of objects in JSON response, they might be represent in a different order.</p>\n\n<p>Sometimes I get this</p>\n\n<pre><code>JSON.parse(response.body) # =&gt; [{\"a\" =&gt; \"b\"}, {\"c\" =&gt; \"d\"}]\n</code></pre>\n\n<p>or this</p>\n\n<pre><code>JSON.parse(response.body) # =&gt; [{\"c\" =&gt; \"d\"}, {\"a\" =&gt; \"b\"}]\n</code></pre>\n\n<p>But for me both results are correct. What is the easiest way to test which objects I have in response regardless of their order?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13238687,"title":"Nesting, is it what I need?","body":"<p>Projects have users.\nUsers have expenses.</p>\n\n<p>I have a screen for the currently signed in user to add new expenses, my controller forces the user key based on current_user.</p>\n\n<p>Now I am needing to allow users to work within a particular project, and enter their expenses for that project all at once, basically \"enter\" a project-expense screen, to limit the scope of the expenses shown in that screen by the project they selected.</p>\n\n<p>(Similar to the way basecamp makes you pick a project you work on)</p>\n\n<p>I do want to use this view for other things, and would like to  make it as DRY as possible.</p>\n\n<p>Was just wondering, what is the proper way to have a user select a project, and then persist that choice through their use of my existing expenses screen.</p>\n\n<p><strong>EDIT</strong> -  I would like to be able to pick a project, and then have all the functionality on the expenses page pass along that project through to the controller methods.</p>\n\n<p>So I could end up with /project/45/expenses .... etc</p>\n\n<p>Thanks!</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  attr_accessible :name, :active\n\n    has_many :expenses, foreign_key: :project_id\n\nend\n\nclass Expense &lt; ActiveRecord::Base\n  attr_accessible :amount, :expense_date, :project_id, :expense_type_id, :user_id\n\n  belongs_to :project\n    belongs_to :user\n    belongs_to :expense_type\n    has_one :expense_approval\n\nend\n\nclass User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :name, :email, :password, :password_confirmation, :remember_me\n\n  has_many :expenses, foreign_key: :user_id\nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13243401,"title":"Issue creating and applying the migration that adds the director field to the movies table","body":"<p>This is the code I thought is correct:</p>\n\n<pre><code>rails generate migration AddDirectorsToMovies Directors:string\n</code></pre>\n\n<p>When I run <code>rake db:test:prepare</code>, the terminal tells me:</p>\n\n<pre><code>Run \"rake db:migrate\" to update your database then try again. The rake aborts.\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","activerecord","locking","timeout"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":997,"score":3,"question_id":4787244,"title":"ActiveRecord \"Mysql::Error: Lock wait timeout exceeded\" with no apparent locks","body":"<p>Rails version: 2.3.8</p>\n\n<p>Many times thoughout the day, my application will seemingly randomly return a 500 error with a corresponding entry in the production log:</p>\n\n<pre><code>ActiveRecord::StatementInvalid (Mysql::Error: Lock wait timeout exceeded; try restarting transaction: INSERT INTO `forum_posts` (`forum_topic_id`, `created_at`, `body`, `ancestry`, `updated_at`, `quote_limit`, `user_id`, `ancestry_depth`, `quote_root`) VALUES(1224783, '2011-01-24 19:18:38', 'Post body', '1285704', '2011-01-24 19:18:38', 1, 57931, 1, 1))\n</code></pre>\n\n<p>Inspecting the MySQL slow query log shows this entry as:</p>\n\n<pre><code># Time: 110124 11:19:29\n# User@Host: db_user[db_user] @ localhost []\n# Query_time: 51  Lock_time: 0  Rows_sent: 0  Rows_examined: 0\nSET insert_id=0;\nINSERT INTO `forum_posts` (`forum_topic_id`, `created_at`, `body`, `ancestry`, `updated_at`, `quote_limit`, `user_id`, `ancestry_depth`, `quote_root`) VALUES(1224783, '2011-01-24 19:18:38', 'Post body', '1285704', '2011-01-24 19:18:38', 1, 57931, 1, 1);\n</code></pre>\n\n<p>According to the Rails log, ActiveRecord returned an error because of a lock wait timeout. The long-running nature of this simple query seems to suggest so as well. The thing is, nowhere is the slow query log can I find an actual query that should require a long time to process - they are all similar to the above example. Plus, in this same log, not one entry has a <code>Lock_time</code> value of greater than 0. </p>\n\n<p>Does anyone here have an idea as to what could be causing this apparent lock and how to isolate it? The current tools I'm using don't seem to be helping much. </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13243357,"title":"Uploading multiple files to heroku serially locks up all dynos","body":"<p>Its my understanding that when I upload a file to my heroku instance its a synchronous request and I will get a 200 back when the request is done, which means my upload has been processed and stored by paperclip.</p>\n\n<p>I am using plupload which does a serial upload (one file at a time).  On Heroku I have 3 dynos and my app becomes unresponsive and I get timeouts trying to use the app.  My upload should really only tie up at most a single dyno while all the files are being uploaded since its done serially and file 2 doesnt start until a response is returned from file 1.</p>\n\n<p>As a test I bumped my dynos to 15 and ran the upload. Again I see the posts come into the logs and then I start seeing output of paperclip commands (cant remember if it was identify or convert) and I start getting timeouts.  </p>\n\n<p>I'm really lost as to why this is happening.  I do know I 'can' upload directly to s3 but my current approach should be just fine.  Its an admin interface that is only used by a single person and again at most it should tie up a single dyno since all the uploaded files are sent serially.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby","libxml2","homebrew","osx-mountain-lion"],"answer_count":7,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":2807,"score":11,"question_id":11668604,"title":"Mountain Lion - LibXML & Nokogiri","body":"<p>I've just updated to OS X Mountain Lion and I'm getting the following when working with rails and terminal.</p>\n\n<pre><code>WARNING: Nokogiri was built against LibXML version 2.8.0, but has dynamically loaded 2.7.8\n</code></pre>\n\n<p>I've had a look at other answers to a similar question, but they doesn't seem to stop the warning message from appearing.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","actionmailer"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2981,"score":0,"question_id":5309304,"title":"How to configure to send email through localhost app server without authentication?","body":"<p>I have configured the Rails mailer under config/initializers/ like following:</p>\n\n<p><strong>/config/initializers/setup_email.rb</strong></p>\n\n<pre><code>config.action_mailer.raise_delivery_errors = true\n\n  ActionMailer::Base.smtp_settings = {\n   :address =&gt; \"smtp.gmail.com\",\n   :port =&gt; 587,\n   :domain =&gt; 'gmail.com',\n   :authentication =&gt; :plain,\n   :user_name=&gt;&lt;username&gt;,\n   :password=&gt;&lt;password&gt;,\n   :enable_starttls_auto =&gt; true\n}\n</code></pre>\n\n<p>it works fine, I can send emails and get them received.</p>\n\n<p>But how to configure it to send email from localhost without authentication(without username and password), that's do not use gmail, but send email through the application's local server, how to configure then?</p>\n\n<p>--EDIT---\nWhen using localhost, the error message I got is:</p>\n\n<pre><code>Connection refused - connect(2)\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `initialize'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `open'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `do_start'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/timeout.rb:67:in `timeout'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/timeout.rb:101:in `timeout'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `do_start'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:525:in `start'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/network/delivery_methods/smtp.rb:127:in `deliver!'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:1967:in `do_delivery'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:228:in `deliver'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:401:in `deliver_mail'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages.rb:52:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages/instrumenter.rb:21:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages.rb:52:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:399:in `deliver_mail'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:228:in `deliver'\n/home/user1/myapp/app/mailers/my_mailer.rb:9:in `new_car_messages'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151:in `send_action'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151:in `process_action'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:120:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/rendering.rb:40:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/old_api.rb:75:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:446:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:441:in `initialize'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:425:in `new'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:425:in `method_missing'\n/home/user1/myapp/config/../lib/my/new_car_sender.rb:7:in `send_email'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `__send__'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `each'\n/home/user1/myapp/config/../lib/my/new_car_sender.rb:6:in `send_email'\n/home/user1/myapp/lib/tasks/new_car_messages.rake:8\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:636:in `call'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:636:in `execute'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:631:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:631:in `execute'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:597:in `invoke_with_call_chain'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/monitor.rb:242:in `synchronize'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2001:in `run'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:1998:in `run'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/bin/rake:31\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/bin/rake:19:in `load'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/bin/rake:19\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","tags","acts-as-taggable-on"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":9028883,"title":"Using tags for user-set UX details","body":"<p>I'm using <code>acts_as_taggable_on</code> for tagging items across my system so that they're easily searchable.</p>\n\n<p>Now I have a UX problem: I'm noticing lots of places where users choose certain minor states (for example, closing a one-time help box or moving to the next javascript-run step in a given page). We have here situations that are both too minor/numerous/dynamic/fast-changing to be put into a database table (imagine having to migrate with every UX change!), and that there is a need to persist some of these choices beyond the session.</p>\n\n<p>In this case, is there anything wrong with using tags to store these simple decisions? For example, <code>user.set_tags_on(:ui, \"closed_index_help\")</code> or <code>user.set_tags_on(:ui, \"tutorial_1_done\")</code>, then showing/hiding these elements in the future by looking at the user's <code>ui_list</code>.</p>\n\n<p>Are there drawbacks to this I'm not considering or is this a prudent way to go?</p>\n"},{"tags":["ruby-on-rails","windows","service","redmine"],"answer_count":3,"favorite_count":9,"up_vote_count":8,"down_vote_count":0,"view_count":8658,"score":8,"question_id":877943,"title":"how to configure a rails app (redmine) to run as a service on windows?","body":"<p>I'm using redmine as a ticket manager, and I'd like to configure it to be run automatically when windows starts up.</p>\n\n<p>How can I configure it to be run as a service?</p>\n\n<p>--</p>\n\n<p>Just asked the question to document it, I hope somebody may find it useful...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","performance","time-series"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13243137,"title":"Efficiently plot database activity as a time series","body":"<p>I am working on a system where 200,000+ records have been created in the past year and I need to plot their creation on a time series with various added filters. At this present, this requires performing lots of <code>count</code> queries (30 for each month plotted). How should these dates be stored for maximum speed?</p>\n\n<p>One idea: store the most commonly-visualized data in a number of serialized fields containing <code>count</code>s for each day over the past month. Update each day with <code>cron</code> and serve up as necessary. (Where should these be stored - some new database table or a separate file accessible by Heroku cron?)</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","benchmarking","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13234454,"title":"Test Speed: ActiveRecord use_transactional_fixtures vs. DatabaseCleaner.strategy = :transaction","body":"<p>Judging from the source(<a href=\"https://github.com/bmabey/database_cleaner/blob/master/lib/database_cleaner/active_record/transaction.rb\" rel=\"nofollow\">database_cleaner</a>, <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L846\" rel=\"nofollow\">active_record</a>), it appears that they should be equally fast. But there are claims that using database_cleaner's transaction strategy slows down controller and model specs (<a href=\"http://stackoverflow.com/a/5435732/429288\">for example</a>). I don't have a large test suite in hand for benchmarking. Anyone has any insight or has compared the two? </p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","asset-pipeline"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":13211090,"title":"Assets precompile fails with twitter-bootstrap-rails gem","body":"<p>I have a Rails 3.2 app with twitter-boostrap-rails gem. Running rake assets:precompile fails with this:</p>\n\n<pre><code>alex@BlackBeast:~/myapp$ rake assets:precompile\n/home/alex/.rvm/rubies/ruby-1.9.3-head/bin/ruby /home/alex/.rvm/gems/ruby-1.9.3-head@global/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets\nrake aborted!\nInvalid CSS after \"...4882640c.png\"\")\": expected \"{\", was \";background-pos...\"\n  (in /home/alex/myapp/app/assets/stylesheets/application.css)\n\nTasks: TOP =&gt; assets:precompile:primary\n(See full trace by running task with --trace)\nrake aborted!\nCommand failed with status (1): [/home/alex/.rvm/rubies/ruby-1.9.3-head/bin...]\n</code></pre>\n\n<p>Is there any way I could debug this problem? Have no idea what to do about this.</p>\n\n<p><strong>Update:</strong> after updating twitter-bootstrap-rails gem to 2.1.6 version, the precompile now fails with a different error:</p>\n\n<pre><code>rake aborted!\nInvalid CSS after \"}​\": expected \"{\", was \"\"\n  (in /home/alex/myapp/app/assets/stylesheets/application.css)\n(sass):1673\n</code></pre>\n\n<p>The application.css mentioned in the error is a standard one, with</p>\n\n<pre><code>*= require_self\n *= require_tree .\n</code></pre>\n\n<p>..which makes a bit hard to determine which part causes problems. </p>\n\n<p>Can I compile somehow only bootstrap_and_overrides.less and see where the things go wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","amazon-s3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13242031,"title":"Rails, PaperClip, S3, Heroku: Model icon fields not being saved","body":"<p>I am using Rails 3.2 + Heroku + S3 + Paperclip to store an icon on my <code>User</code> model. The model is not saving the 4 icon fields though. The images are getting processed and saved on S3 correctly and no errors are occurring. I also have another model that has a document being stored via Paperclip and S3. That model works perfectly in all cases. The <code>User</code> icon works locally but not on Heroku.</p>\n\n<p><code>production.rb</code> relevant configuration</p>\n\n<pre><code>config.paperclip_defaults = {\n  :storage =&gt; :s3,\n  :s3_credentials =&gt; {\n    :bucket =&gt; ENV['AWS_BUCKET'],\n    :access_key_id =&gt; ENV['AWS_ACCESS_KEY_ID'],\n    :secret_access_key =&gt; ENV['AWS_SECRET_ACCESS_KEY']\n  }\n}\n</code></pre>\n\n<p>User model code:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :icon\n\n  has_attached_file :icon, :url =&gt; \"/system/:rails_env/:attachment/:style/:hash.:extension\",\n    :hash_data =&gt; \":class/:attachment/:id\",\n    :hash_secret =&gt; \"superSecretThing\",\n    :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" },\n    :default_url =&gt; \"/blank.png\"\n  ...\n</code></pre>\n\n<p>Controller code: (This code is kind of crazy because I am AJAXing files Base64 encoded.)</p>\n\n<pre><code>  params[:user][:icon_data]\n  decoded_file = Base64.decode64(data)\n  begin\n    split_name = params[:user][:icon_file_name].split(\".\")\n    file = Tempfile.new([split_name[0..-2].join(\".\"), \".#{split_name[-1]}\"])\n    file.binmode\n    file.write(decoded_file)\n    file.close\n    @user.icon = open(file)\n    @user.icon_file_name = params[:user][:icon_file_name]\n  ensure\n    file.unlink\n  end\n  @user.save\n</code></pre>\n\n<p>I do an almost identical process on another model with a Paperclip attachment and it works flawlessly. In both cases the attachment is being saved correctly to S3 and no errors are being raised. <a href=\"https://gist.github.com/4021058\" rel=\"nofollow\">This gist has example output</a> for a controller action from the Heroku logs. </p>\n\n<p>I am pretty baffled because the other model works fine. The only real difference is that the <code>User</code> attachment does image processing but that part appears to be working fine.</p>\n\n<p>The problem is the same as <a href=\"http://stackoverflow.com/questions/4654111/paperclip-w-imagemagick-amazon-s3-and-heroku-imagemagick-s3-work-but-the?rq=1\">this one</a>, but the solution there does not apply.</p>\n\n<p>Thoughts?</p>\n"},{"tags":["ruby-on-rails","simple-form"],"answer_count":2,"favorite_count":4,"up_vote_count":1,"down_vote_count":0,"view_count":1481,"score":1,"question_id":5999870,"title":"rails simple_form two models","body":"<p>I'm starting to use simple_form for a rails application, and while converting some of my forms, I came across one that has two models that it is working with, sort of an embedded form.  Is this possible with simple_form?</p>\n\n<pre><code> &lt;% simple_form_for :topic, :url =&gt; forum_topics_path do |t| %&gt;\n &lt;%= t.input :name, :label =&gt; 'Topic' %&gt;&lt;/p&gt;\n\n &lt;p&gt;First Post:&lt;br/&gt;&lt;/p&gt; \n Title: &lt;%= text_field :post, :title %&gt; &lt;--- this is where i start having problems\n Body: &lt;%= text_area :post, :body %&gt;\n &lt;%= t.submit 'Save' %&gt;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","routing","ruby-on-rails-3.2.1"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13242947,"title":"Recuing errors in Rails 3.2 with `config.exceptions_app = self.routes`","body":"<p>As per this post:</p>\n\n<p><a href=\"http://blog.plataformatec.com.br/2012/01/my-five-favorite-hidden-features-in-rails-3-2/\" rel=\"nofollow\">http://blog.plataformatec.com.br/2012/01/my-five-favorite-hidden-features-in-rails-3-2/</a></p>\n\n<p>The newest way to handle errors looks like this:</p>\n\n<pre><code># application.rb:\nconfig.exceptions_app = self.routes\n\n#routes.rb\nmatch \"/404\", to: \"site#not_found\"\n</code></pre>\n\n<p>However, he doesn't address the fact that the rails error app also handles 500 errors, 422 errors (and possibly other errors funneled to those two pages?)</p>\n\n<p>So I've hacked together a solution that looks like this:</p>\n\n<pre><code># routes.rb\nrack_error_handler = ActionDispatch::PublicExceptions.new('public/')\nmatch \"/422\" =&gt; rack_error_handler\nmatch \"/500\" =&gt; rack_error_handler\n</code></pre>\n\n<p>It's good in that it keeps my 500 pages lightweight.</p>\n\n<p>Are there other errors I should be catching as well?\nMy understanding is that although the 500 page will now be using two rack apps, it is still safely isolated from the main Rails App enough.  Is this strong?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","vanity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13242494,"title":"Why doesn't vanity create vanity_experiments.rb and similar in app/models","body":"<p>I've create and run my vanity migrations and I can see the resulting tables in <code>schema.rb</code> and the <code>rails console</code>:</p>\n\n<pre><code>ActiveRecord::Base.connection.tables\n =&gt; [\"schema_migrations\", \"pages\", \"users\", \"areas\", \"roles\", \"assignments\", \"categories\", \"heuristics\", \"references\", \"footnotes\", \"products\", \"orders\", \"vanity_metrics\", \"vanity_metric_values\", \"vanity_experiments\", \"vanity_conversions\", \"vanity_participants\"] \n</code></pre>\n\n<p>Why then has it not created <code>vanity_experiments.rb</code> and similar files in <code>app/models</code>?</p>\n\n<p>I understand vanity will be using Redis not my PostgreSQL to store the data, but Rails still maps each table to a model, right?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.1","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13242547,"title":"Has_one association not working","body":"<p>I cant find out where is an error with this relation:</p>\n\n<pre><code>class Education &lt; ActiveRecord::Base\n  attr_accessible :description, :graduation, :student_id, :faculty_id, :department_id\n\n  has_one :faculty\n  belongs_to :student\nend\n#  id          :integer          not null, primary key\n#  student_id  :integer\n#  faculty_id  :integer\n#  description :text\n#  graduation  :string(255)\n\nclass Faculty &lt; ActiveRecord::Base\n  attr_accessible :department_id, :name\n\n  belongs_to :education\n  belongs_to :department\nend\n\n# == Schema Information\n#\n# Table name: faculties\n#\n#  id            :integer          not null, primary key\n#  name          :string(255)\n#  department_id :integer\n</code></pre>\n\n<p>Why I have to add <code>education_id</code> to <code>faculties</code> table? \nEach Education has only one faculty and faculty belongs to many educations.</p>\n\n<pre><code>&gt;&gt; Education.last.faculty\n  Education Load (0.3ms)  SELECT \"educations\".* FROM \"educations\" ORDER BY \"educations\".\"id\" DESC LIMIT 1\n  Faculty Load (0.2ms)  SELECT \"faculties\".* FROM \"faculties\" WHERE \"faculties\".\"education_id\" = 1 LIMIT 1\nSQLite3::SQLException: no such column: faculties.education_id: SELECT  \"faculties\".* FROM \"faculties\"  WHERE \"faculties\".\"education_id\" = 1 LIMIT 1\nActiveRecord::StatementInvalid: SQLite3::SQLException: no such column: faculties.education_id: SELECT  \"faculties\".* FROM \"faculties\"  WHERE \"faculties\".\"education_id\" = 1 LIMIT 1\nfrom /Users/rege/.rvm/gems/ruby-1.9.3-p194@ckdatabase/gems/sqlite3-1.3.6/lib/sqlite3/database.rb:91:in `initialize'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","require"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13241817,"title":"Ruby load error cannt load such file","body":"<p>Testing my class source code with some require code and I keep getting the following error:</p>\n\n<blockquote>\n  <p>\"D:/ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in\n  'require':cannot load such file -- ./xxx.rb (LoadError) from\n  D:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in\n  'require' from xxx.rb:1:in ''</p>\n</blockquote>\n\n<p>Here is the code I'm using to test my code:</p>\n\n<pre><code>require \"./proj6colecio.rb.txt\"\nprint \" \"\nguitar = Guitar.new(\"Stratocaster\", \"Fender\", \"Solid Body\", 6, \"Black\")\nprint \"Guitar Name: #{guitar.name}\\n\"\nprint \"Guitar Brand: #{guitar.brand}\\n\"\nprint \"Guitar Type: #{guitar.type}\\n\"\nprint \"Number of Strings: #{guitar.strings}\\n\"\nprint \"Guitar Color: #{guitar.color}\\n\"\nprint guitar, \"\\n\"\n</code></pre>\n\n<p>Not really educated in ruby on rails errors yet as I'm a student still learning the basics of programming. </p>\n\n<p>Thanks alot for any feedback</p>\n\n<pre><code># Guitar class with instance variables @name, @brand, @type @strings @color and\n# method take_strings.\n\nclass Guitar\n\n  # initialize method is called when user invokes Guitar.new.\n  def initialize(the_name, the_brand, the_type, the_strings, the_color)\n    @name = the_name\n    @brand = the_brand\n    @type = the_type\n    @strings = the_strings\n    @color = the_color\n  end\n\n  # Define getters\n  def name\n    return @name\n  end\n\n  def brand\n    return @brand\n  end\n\n  def type\n    return @type\n  end\n  def strings\n    return @strings\n  end\n\n  def color\n    return @color\n  end\n# define setters\n\n  def strings=(value)\n    @strings = value\n  end\n\n  def to_s\n    return \"The Guitar is a #{name} made by #{brand}. It is a #{type} with #{strings} strings and is #{color}.\"\n  end\n\n  def change_color\n    @color = \"Blue\"\n  end\n\nend\n\nguitars = [ ]\n\nguitars &lt;&lt; Guitar.new(\"Stratocaster\", \"Fender\", \"Solid Body\", 6, \"Black\")\nguitars &lt;&lt; Guitar.new(\"Les Paul\", \"Gibson\", \"Solid Body\", 6, \"Yellow\")\nguitars &lt;&lt; Guitar.new(\"White Falcon\", \"Gretsch\", \"Semi-Hollow\", 6, \"White\")\n\n# Print all guitars\nguitars.each do |g|\n  print g, \"\\n\"\nend\n\n#Change color of guitar to blue\nguitars.each do |g|\n  g.change_color\nend\n\nguitars.each do |g|\n  print g, \"\\n\"\nend\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","associations"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13241834,"title":"Any techniques to better break down rails associations? (specific example given)","body":"<p>Thanks for taking a look!</p>\n\n<p>I'm building my first \"on my own\" app after reading the Depot book and the rails tutorial and working though both. I'm finding it difficult to get my associations worked out since there's so many of them in my current practice project. Here's the overview, it's basically a simple NFL pickem app:</p>\n\n<p>A \"User\" logs in (devise) and sees a list of \"Games\" for this week.    (let's say NFL games for example).<br>\nA \"User\" can make their \"Picks\" for    those games with that first screen mentioned and submit them for the    week.<br>\nA \"Game\" has 2 teams associated with it.<br>\nA \"Game\" has a    \"result\" (torn on having a Results model or just using a result    column in games table here). \nA \"Week\" has several \"Games\" in it which    are picked. </p>\n\n<p>After picks are made they are allowed to see everyone    elses picks also but that's not really relevant here.</p>\n\n<p>So as you can see above there are several relationships that I need to specify and I'm having a really difficult time working them all out. Also I found myself wanting to make scaffolds for each (I know right?) but I don't think that's the right answer here.</p>\n\n<p>Also, once worked out is there a good order to take with them? Like in this case I figure it's a good idea to start with the \"Teams\" so I can add \"Weeks\" and \"Games\" to each of those weeks. But I'm just really lost and overwhelmed I guess. Any tips on how to start tackling this problem? Thanks so much for the help all!</p>\n\n<p>(please let me know if you want to see code, but I figure this is more of a process / fundamental question than a \"give me a solution to my specific problem\" question. Thanks again.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13239584,"title":"Learning About the lib Directory in Rails","body":"<p>I am very new to Rails, and am trying to learn how the <code>/lib/</code> directory in Rails works - and how to reference variables defined in the <code>/lib/</code> directory for use in a view.</p>\n\n<p>I have a file called <code>helloworld.rb</code> and it's saved in the /lib/ directory in Rails.</p>\n\n<p>The <code>helloworld.rb</code> file has the following code:</p>\n\n<pre><code>module HelloWorld\n  def hello\n    @howdy = \"Hello World!\"\n  end\nend\n</code></pre>\n\n<p>I want to be able to display the results of this method on a view called <code>index.html.erb</code>, so I include the following code in the <code>index_helper.rb</code> file:</p>\n\n<pre><code>module IndexHelper\n  require 'helloworld'\nend\n</code></pre>\n\n<p>Also, I include the following code on the view <code>index.html.erb</code>:</p>\n\n<pre><code>&lt;%= @howdy %&gt;\n</code></pre>\n\n<p>What am I missing?</p>\n"},{"tags":["ruby-on-rails","timezone"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13225235,"title":"In ruby, how create UTC time for an arbitrary future time in an arbitrary timezone, accounting for DST (when applicable)?","body":"<p>In a scheduling method, I need to take a (local_date, local_time, and local_time_zone), and return the corresponding utc time <em>accounting</em> for whether Daylight Saving time is in effect on <em>that</em> date.</p>\n\n<p>I do not want to change Time.zone since while threadsafe, it has the entirely unexpected result of persisting across multiple requests - a Bad Thing.</p>\n\n<p>The following (0800 Pacific time) does NOT work because they return the same time in UTC (16:00) even though the first day (Oct 1) IS in daylight saving time and the second day (Dec 1) is NOT in daylight savings time, so the UTC should be different</p>\n\n<pre><code>Time.new(2012, 10, 1, 8, 0, 0, ActiveSupport::TimeZone['Pacific Time (US &amp; Canada)'].utc_offset).utc\n# 2012-10-01 16:00:00 UTC &lt;&lt;&lt;&lt; should be 15:00\n\nTime.new(2012, 12, 1, 8, 0, 0, ActiveSupport::TimeZone['Pacific Time (US &amp; Canada)'].utc_offset).utc\n# 2012-12-01 16:00:00 UTC \n</code></pre>\n\n<p>I had hoped that the .utc method would take into account whether the daylight saving is in effect, but it doesn't.</p>\n\n<p>I'm not sure if I should be using a Time object, a DateTime object, and TimeWith Zone, etc.</p>\n\n<p>===</p>\n\n<p>Note: There IS a way to do it using the Chronic gem (below). But I would like to use the built-in Ruby Date and Time methods to get the same (eg, correct) result:</p>\n\n<pre><code>Chronic.time_class =ActiveSupport::TimeZone[\"Pacific Time (US &amp; Canada)\"]\nChronic.parse(\"10/1/2012 0800\").utc\n# 2012-10-01 15:00:00 UTC \nChronic.parse(\"12/1/2012 0800\").utc\n# 2012-12-01 16:00:00 UTC \n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1008,"score":2,"question_id":3556000,"title":"I'm getting \"undefined method `abstract_class?' for Object:Class\" for count_by_sql","body":"<p>I'm getting the error:\n\"undefined method `abstract_class?' for Object:Class\"</p>\n\n<p>on a count_by_sql as below:</p>\n\n<p>my_count = ActiveRecord::Base.count_by_sql([\"SELECT widgets FROM wodgets WHERE colour = ? LIMIT 1\", my_favourite_colour])</p>\n\n<p>I've just been upgrading from Rails 2.2.2 to 2.3.4 and it used to work before.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13238105,"title":"Can't mass-assign protected attributes in models with a has_one relation","body":"<p>Hello I have two models </p>\n\n<p>User Model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :user_information\n  attr_accessible :email, :name\nend\n</code></pre>\n\n<p>UserInformation Model</p>\n\n<pre><code>class UserInformation &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :address, :business, :phone\nend\n</code></pre>\n\n<p>I create a user record and everthing works fine, but when I try to create the user information I get this this error:</p>\n\n<blockquote>\n<pre><code>ActiveModel::MassAssignmentSecurity::Error in UserInformationsController#create\n\nCan't mass-assign protected attributes: user\n</code></pre>\n</blockquote>\n\n<p>To create the user information record I go to </p>\n\n<blockquote>\n  <p>localhost:3000/users/1/user_informations/new</p>\n</blockquote>\n\n<p>and fill the form. Then I get the error.</p>\n\n<p>Please I need help I'm trying to do this for the last 4 days and now I desperate </p>\n\n<p>Thank you very much for your help.</p>\n\n<hr>\n\n<p>The user information form</p>\n\n<pre><code>&lt;%= form_for(@user_information) do |f| %&gt;\n  &lt;% if @user_information.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@user_information.errors.count, \"error\") %&gt; prohibited this user_information from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @user_information.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :user%&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :address %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :address %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :phone %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :phone %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :business %&gt;&lt;br /&gt;\n    &lt;%= f.check_box :business %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>the user_information_controller</p>\n\n<pre><code>class UserInformationsController &lt; ApplicationController\n  # GET /user_informations\n  # GET /user_informations.json\n  def index\n    @user_informations = UserInformation.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @user_informations }\n    end\n  end\n\n  # GET /user_informations/1\n  # GET /user_informations/1.json\n  def show\n    @user_information = UserInformation.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @user_information }\n    end\n  end\n\n  # GET /user_informations/new\n  # GET /user_informations/new.json\n  def new\n    @user = User.find(params[:id])\n    @user_information = UserInformation.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @user_information }\n    end\n  end\n\n  # GET /user_informations/1/edit\n  def edit\n    @user_information = UserInformation.find(params[:id])\n  end\n\n  # POST /user_informations\n  # POST /user_informations.json\n  def create\n    @user_information = UserInformation.new(params[:user_information])\n\n    respond_to do |format|\n      if @user_information.save\n        format.html { redirect_to @user_information, notice: 'User information was successfully created.' }\n        format.json { render json: @user_information, status: :created, location: @user_information }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @user_information.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /user_informations/1\n  # PUT /user_informations/1.json\n  def update\n    @user_information = UserInformation.find(params[:id])\n\n    respond_to do |format|\n      if @user_information.update_attributes(params[:user_information])\n        format.html { redirect_to @user_information, notice: 'User information was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @user_information.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /user_informations/1\n  # DELETE /user_informations/1.json\n  def destroy\n    @user_information = UserInformation.find(params[:id])\n    @user_information.destroy\n\n    respond_to do |format|\n      format.html { redirect_to user_informations_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n"},{"tags":["php","css","ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":66,"score":3,"question_id":13242192,"title":"Sanitize CSS in PHP - Ruby Alternatives an option?","body":"<p>We have a requirement to allow users to customise the CSS for a PHP app. In general, only that user will be able to view the custom CSS, but there are cases when other users in their group could also view the CSS, hence the need to ensure that its sanitized.</p>\n\n<p>I am aware that HTMLPurifier and CSSTidy can be used for PHP, but CSSTidy is extremely outdated, and apparently can't handle everything that we need to throw at it.</p>\n\n<p>I havent found any other PHP libs that can do this.</p>\n\n<p>One alternative that I am exploring is taking a ruby library (http://apidock.com/rails/HTML/WhiteListSanitizer/sanitize_css or <a href=\"https://github.com/courtenay/css_file_sanitize/blob/master/lib/css_sanitize.rb\" rel=\"nofollow\">https://github.com/courtenay/css_file_sanitize/blob/master/lib/css_sanitize.rb</a>) and converting it into CSS.</p>\n\n<p>Before I go down that route, are there any alternatives to the above? And are there any pitfalls that I should be aware of before using one of the Ruby libs?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-2","end-of-life"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":146,"score":1,"question_id":10134109,"title":"What is the EOL (End of Life) for Rails 2.3?","body":"<p>What is the EOL date for Rails 2.3?</p>\n"},{"tags":["ruby-on-rails","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13241833,"title":"omniauth-twitter is asking me for the password of an user who already has one?","body":"<p>The following code does this: sign in the user if <code>omniauth</code> fetch all the attributes. If it doesn't fetch the email (in the case of logging in with Twitter), redirect the user to <code>enter_email.html.erb</code> and pass the attributes to the hidden fields.</p>\n\n<p><strong>sessions_controller.rb:</strong></p>\n\n<pre><code> def omniauth_create\n    auth = request.env[\"omniauth.auth\"]\n    user = User.from_omniauth(env[\"omniauth.auth\"])\n    # Add an error message when email is already taken\n    unless user.email.blank?\n      user.save!\n      sign_in user\n      redirect_back_or user\n    else\n      #session[:omniauth] = request.env['omniauth.auth'].except('extra')\n      redirect_to(enter_email_path(oprovider: user.provider,\n                                   ouid: user.uid,\n                                   oname: user.name,\n                                   opassword: user.password,\n                                   opassword_confirmation: user.password))\n    end\n  end\n</code></pre>\n\n<p><strong>user.rb:</strong></p>\n\n<pre><code>  def self.from_omniauth(auth)\n    find_by_provider_and_uid(auth[\"provider\"], auth[\"uid\"]) || User.create_with_omniauth(auth)\n  end\n\n  def self.create_with_omniauth(auth)\n    new do |user|\n      user.provider = auth[\"provider\"]\n      user.uid = auth[\"uid\"]\n      user.name = auth[\"info\"][\"name\"]\n      user.email = auth[\"info\"][\"email\"]\n      user.password = user.password_confirmation = SecureRandom.urlsafe_base64(n=6) \n    end\n  end\n</code></pre>\n\n<p><strong>users_controller.rb:</strong></p>\n\n<pre><code>  def enter_email\n    @user = User.new\n  end\n</code></pre>\n\n<p><strong>users.html.erb:</strong></p>\n\n<pre><code>&lt;%= form_for(@user) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n\n  &lt;%= f.label :email %&gt;\n  &lt;%= f.text_field :email %&gt;\n\n  &lt;%= f.hidden_field :provider, value: params[:oprovider] %&gt;\n  &lt;%= f.hidden_field :uid, value: params[:ouid] %&gt;\n  &lt;%= f.hidden_field :name, value: params[:oname] %&gt;\n  &lt;%= f.hidden_field :password , value: params[:opassword] %&gt;\n  &lt;%= f.hidden_field :password_confirmation, value: params[:opassword_confirmation] %&gt;\n\n  &lt;%= f.submit \"Create my account\", class: \"btn btn-large btn-primary\" %&gt;\n</code></pre>\n\n<p>Now, this works, the user is created.</p>\n\n<p>But now when I logout and login with Twitter:</p>\n\n<p><strong>_header.html.erb</strong></p>\n\n<pre><code> &lt;%= link_to \"auth/twitter\", class: \"btn btn-inverse strategy\" do %&gt;\n   &lt;i class=\"icon-twitter-sign\"&gt;&lt;/i&gt;Sign in with Twitter\n &lt;% end %&gt;\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>Validation failed: Password can't be blank, Password is too short (minimum is 6 characters), Password confirmation can't be blank\n</code></pre>\n\n<p>I though the user will just get logged in with Twitter since he already has an <code>uid</code>, <code>provider</code>, 'email' and a <code>password</code>.</p>\n\n<p>Any suggestions to fix this? (I'm I approaching the problem in a wrong way?)</p>\n"},{"tags":["sql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13241622,"title":"Rails: OUTER JOIN with condition","body":"<p>I have 2 models Show and Booking. A show has many bookings. Each booking has a start_date and end_date. I want to find the shows that either i) have no bookings or ii) have bookings that do not overlap with a time interval [start, end]. So far I have:</p>\n\n<pre><code>Show.joins(\"LEFT JOIN bookings ON bookings.show_id = shows.id\").where(\"bookings.start_date &gt; ? OR bookings.end_date &lt; ?, end, start)\n</code></pre>\n\n<p>But it doesn't return the shows that have no bookings. How can I include the shows that have no bookings in the query result?</p>\n"},{"tags":["ruby-on-rails","backbone.js"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13241710,"title":"Backbone.js nested model with Rails","body":"<p>So I am getting this annoying nested object problem. I generate JSON data from a rails model and pass it into a backbone model like this:</p>\n\n<pre><code>board = Board.find(anyid)\ncovers = [link1, link2]\n\nreturn_json = {\n board: user,\n covers: covers\n}\n\nresond_to do |format|\n format.js { render json: return_json }\nend\n</code></pre>\n\n<p>And in my backbone end, I get something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/vFKY9.jpg\" alt=\"enter image description here\"></p>\n\n<p>Why is the board object nested with another object? I've ran into this situation several times, and I have to do something like <code>@model.get(\"board\").board.name</code> to retrieve the value. This is annoying. However you can see that the array works as I expected. </p>\n\n<p>If I didn't make it clear, please comment! I will be around.</p>\n"},{"tags":["ruby-on-rails","ruby","gem","rvm","bundler"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13238119,"title":"Portable rails app with dependencies","body":"<p>Is there anything to make the rails development portable across operating systems (with prerequisite of ruby and rails installed in all OS)?</p>\n\n<p><strong>For example:</strong> </p>\n\n<p><ol>\n<li>I want to create an rails application named \"iApp\" in windows (Rails 3.2 installed already)</li>\n<li><p>Add necessary gems to \"Gemfile\" and run \"bundle install\"</p></p>\n\n<blockquote>\n  <p>Expectation: All dependencies must be installed within \"iApp\" folder</p>\n</blockquote></li>\n<li><p>Copy the iApp folder to a linux machine (Rails 3.2 installed already)</p></li>\n<li>run \"rake tests\" or run \"rails s\"\n\n<blockquote>\n  <p>Expectation: It should work outof the box without running \"bundle install\"</li>\n  </ol>\n  Should be possible to repeat steps 3 &amp; 4 in a Machintosh as well.</p>\n</blockquote>\n\n<p>Will RVM solve this problem? or is there any solution for this?</p>\n"},{"tags":["ruby-on-rails","wufoo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13005887,"title":"RoR: Wufoo forms","body":"<p>i have this question... I've been integrating wufoo forms to my project.. i've done a full walk through the api, i know that we can know from what ip a form has been posted, but we don't have a more precise information, let's suppose we are using wufoo to make surveys, we want our users to answer to each survey only once.. we need something like the user_id or any identifying information so we don't show the same survey to a user twice.. from all i could learn from the api, wufoo can't tell you this, so the only choice you have is to create your own form on your platform and using the wufoo ENTRY API posting the results and in that action (on some controller of your ruby on rails project) you can store the activity on a local database, for example a relational table (user_id, survey_id) where if the pair (i, j) belongs to the table that means that the user i answered the survey j.. (j would be the wufoo hash of your form), does anyone knows anything else or have a better idea? thanks in advance</p>\n"},{"tags":["ruby-on-rails","ruby","facebook","authorization","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13209848,"title":"rails + omniauth: inspect basic info","body":"<p>this is my code to get the user's basic information after authorization:  </p>\n\n<pre><code>basic_info = request.env['omniauth.auth'].extra.raw_info\n\nfirst = basic_info.first_name\nlast = basic_info.last_name \nemail = basic_info.email \nid = basic_info.id\n</code></pre>\n\n<p>the four variables get the data, so it works.<br>\nbut when I'm trying <code>basic_info.inspect</code> command, I get:</p>\n\n<blockquote>\n  <p>\"#\"</p>\n</blockquote>\n\n<p>why is that? shouldn't it dump all the values?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid","mongoid3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":54,"score":-1,"question_id":13241595,"title":"getting undefined method `id' when saving a document","body":"<p>When I try to save a document, I get this error:</p>\n\n<pre><code>undefined method `id' for \"504b6d66493f1b9c18000007\":String\n</code></pre>\n\n<p>with this parameter:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"_method\"=&gt;\"put\",\n \"authenticity_token\"=&gt;\"VkES2ecwdT6dPg3DDPK+O4NRa0mZy7zKALnkBXJ1Hbs=\",\n \"document\"=&gt;{\"name\"=&gt;\"Hoje\",\n \"description\"=&gt;\"## que bla bla bla\",\n \"storage\"=&gt;\"504b6d66493f1b9c18000007\",\n \"pub\"=&gt;\"1\"},\n \"commit\"=&gt;\"Save document\",\n \"id\"=&gt;\"5096d0f2e667079c17000029\"}\n</code></pre>\n\n<p>as you can see, the Id which the error refers, belongs to <code>storage</code> and not to <code>document</code> itself...</p>\n\n<p>this is my relationship</p>\n\n<h1>document.rb</h1>\n\n<pre><code>class Document\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  include Mongoid::Versioning\n  include Mongoid::FullTextSearch\n\n  #Fields\n  field :name, type: String\n  field :description, type: String\n  field :pub, type: Boolean, default: true\n  field :file_content, type: String\n\n  mount_uploader :file, FileUploader\n\n  #Validations\n  validates :name, presence: true;\n\n  #Relations\n  belongs_to :user\n  belongs_to :storage\n  belongs_to :organization\n\n  fulltext_search_in :file_content, \n    :index_name =&gt; 'fts_documento.content',\n    :filters =&gt; { \n      :pvt =&gt; lambda { |x| x.pub == true},\n      :org =&gt; lambda {|document| document.organization }\n    }\nend\n</code></pre>\n\n<h1>storage.rb</h1>\n\n<pre><code>class Storage\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  #Fields\n  field :path, type: String\n\n  #Validations\n  validates :path, presence: true\n\n  #Relations\n  belongs_to :user\n  belongs_to :organization\nend\n</code></pre>\n\n<p>and here is my <code>update</code> action</p>\n\n<pre><code>  def update\n    @document = Document.find params[:id]\n    if @document.update_attributes params[:document]\n\n      if params[:document][:file]\n        IndexerWorker.perform_async(@document.id)\n      end\n\n      redirect_to dashboard_path, notice: 'Document updated'\n    else\n      render 'document/edit'\n    end\n  end\n</code></pre>\n\n<p>I have no idea nor where to start...<br>\nIt was working a couple of weeks ago..  </p>\n"},{"tags":["ruby-on-rails","ruby","utf-8","character-encoding"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":102,"score":2,"question_id":12947910,"title":"Force strings to UTF-8 from any encoding","body":"<p>In my rails app I'm working with RSS feeds from all around the world, and some feeds have links that are not in UTF-8.  The original feed links are out of my control, and in order to use them in other parts of the app, they need to be in UTF-8.</p>\n\n<p>How can I detect encoding and convert to UTF-8?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":3784,"score":0,"question_id":4115931,"title":"Rails - Devise - edit_user_registration_path","body":"<p>with Rails there is the path, edit_user_registration_path to allow users to edit their profile.</p>\n\n<p>I'm setting up my own Account Control to present the user with a better UI to edit their profile etc.. which is routed at /account/profile, /account/notices, etc....</p>\n\n<p>Problem is this URL, /users/edit  still works and takes users to the DEVISE edit page.</p>\n\n<p>How can I have that always go to the new edit page /account/profile</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","datetime","postgresql"],"answer_count":1,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":1272,"score":5,"question_id":9571392,"title":"Ignoring timezones altogether in Rails and PostgreSQL","body":"<p>I'm dealing with dates and times in Rails and Postgres and running into this issue:</p>\n\n<p>The database is in UTC.</p>\n\n<p>The user sets a time-zone of choice in the Rails app, but it's only to be used when getting the users local time for comparing times.</p>\n\n<p>User stores a time, say March 17, 2012, 7pm. I don't want timezone conversions or the timezone to be stored. I just want that date and time saved. That way if the user changed their time zone, It would still show March 17, 2012, 7pm.</p>\n\n<p>I only use the users specified time zone to get records 'before' or 'after' the current time in the users local time zone. </p>\n\n<p>I'm currently using 'timestamp without time zone' but when I retrieve the records, rails (?) converts them to the time zone in the app, which I don't want. </p>\n\n<pre><code>Appointment.first.time\n =&gt; Fri, 02 Mar 2012 19:00:00 UTC +00:00 \n</code></pre>\n\n<p>Because the records in the database seem to come out as UTC, my hack is to take the current time, remove the time zone with 'Date.strptime(str, \"%m/%d/%Y\")' and then do my query with that:</p>\n\n<pre><code>.where(\"time &gt;= ?\", date_start)\n</code></pre>\n\n<p>It seems like there must be an easier way to just ignore time zones all around. Any ideas?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12962745,"title":"How to integrate an already-existing .rb file in Rails?","body":"<p>I am still learning Ruby on Rails, but have a general question about using a link on a Rails view to trigger a ruby program to run. In other words, rather than type \"ruby filename.rb\" at the command prompt, I want a link in my Rails view to execute the code in filename.rb, when it's clicked.</p>\n\n<p>I know this is a bit of hack, but I'm trying to learn one step at a time...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave","fog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":163,"score":0,"question_id":9964105,"title":"config.fog_host does not works fine for me with cdn's in rails 3.1","body":"<p>I have this in my <strong>fog.rb</strong></p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',\n    :aws_access_key_id      =&gt; 'key',\n    :aws_secret_access_key  =&gt; 'key',\n    :region                 =&gt; 'eu-west-1'\n  }\n\n  config.fog_host = proc { \"http://cdn#{(rand * 4).ceil}.domain.com\" }\n  config.fog_directory = 'pro'\n  config.fog_public = false\n  config.fog_attributes = {'Cache-Control' =&gt; 'max-age=315576000'} \nend\n</code></pre>\n\n<p>But I see the images routes to <a href=\"https://s3-eu-west-1.amazonaws.com/pro\" rel=\"nofollow\">https://s3-eu-west-1.amazonaws.com/pro</a>...</p>\n\n<p>However my assets js, css, and images assets works fine I see: </p>\n\n<p><a href=\"http://cdn0.domain.com/assets/logo-4cbddb290494d56e25f86fffa93f4b00.png\" rel=\"nofollow\">http://cdn0.domain.com/assets/logo-4cbddb290494d56e25f86fffa93f4b00.png</a></p>\n\n<p><strong>What am I doing wrong in this config?</strong></p>\n"},{"tags":["ruby-on-rails","soap","savon"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12943173,"title":"Is there a way to set the default namespace with Savon::Model?","body":"<p>Savon is stubborn in generating SOAP envelopes from WSDL's. It does it improperly and I see no way to fix it. It also takes the liberty of inserting the <code>wsdl:</code> namespace on everything for whatever reason.</p>\n\n<p>The request I am building uses the <code>tns:</code> namespace. I'd love to be able to use Savon::Model, but right now I have to do:</p>\n\n<pre><code>client.request :tns, :function_name do\n  soap.body = { params }\nend\n</code></pre>\n\n<p>Instead of something like:</p>\n\n<pre><code>super(params)\n</code></pre>\n\n<p>Making the request block in every function is tedious, and I have to define the function name every time instead of Savon automatically calling the correct function like what would happen in the ideal case. Right now my functions are looking like</p>\n\n<pre><code>def foo\n  client.request :tns, :foo do\n  ...\nend\n</code></pre>\n\n<p>Having to say \"foo\" twice seems ridiculous. Is there a way to set the default namespace for every request in a class that extends Savon::Model?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13240383,"title":"JSON Rendering: How to include the opening bracket description?","body":"<p>I have some Ruby code that is putting out JSON like this:</p>\n\n<pre><code>def nearby\n  #@bathrooms = Bathroom.geo_scope(:origin =&gt;[params[:lat],[params[:lon]]], :within =&gt; 5)\n  lat = params[:lat]\n  lon = params[:lon]\n  #@bathrooms = Bathroom.geo_scope(:within =&gt; 5, :origin =&gt; [45.580639,-122.677682], :order=&gt;'distance')\n  @bathrooms = Bathroom.geo_scope(:within =&gt; 3, :origin =&gt; [lat,lon], :order=&gt;'distance')\n  respond_to do |format|\n    format.json  { render :json =&gt; @bathrooms }\n    format.js   { render :nothing =&gt; true } \n  end   \nend\n</code></pre>\n\n<p>The result is something like this:</p>\n\n<pre><code> [{\"ID\":129,\"access\":\"1\",\"avail\":\"0\",\"bathroomtype\":\"0\",\"city\":\"PORTLAND\",\"comment\":\"\",\"country\":\"US\",\"created\":\"0000-00-00 00:00:00\",\"directions\":\"The two bathrooms are in the long hallway at the back of the restaurant, past the bar.\",\"distance\":\"2.94986114636676\",\"lat\":\"45.539217\",\"lon\":\"-122.661795\",\"modifed\":\"0000-00-00\",\"name\":\"Echo\",\"postal\":\"97212-3727\",\"slug\":\"echo-portland170\",\"source\":\"\",\"state\":\"OR\",\"street\":\"2225 NE Martin Luther King Jr. Blvd\"},\n</code></pre>\n\n<p>What I don't know how to do is to name the set? For example, after the first enclosing bracket I would like to name the set bathrooms. How can I do this is Rails?</p>\n"},{"tags":["ruby-on-rails","sql-server","osx","unixodbc","iodbc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":233,"score":1,"question_id":9925843,"title":"unixodbc and freetds setup on OSX and Rails 2.3.x","body":"<p>I'm trying to set up unixodbc on OSX (10.7.3), but it looks like iODBC is on the way. </p>\n\n<p>My config/database.yml:</p>\n\n<pre><code>development:\n  adapter: sqlserver\n  encoding: UTF8\n  mode: odbc\n  username: user\n  password: passwd\n  dsn: MY_DSN\n</code></pre>\n\n<p>ruby-obdc is installed and in the Gemfile:</p>\n\n<pre><code>gem 'ruby-odbc', :require =&gt; 'odbc_utf8'\n</code></pre>\n\n<p>/usr/local/etc/freetds.conf:</p>\n\n<pre><code>[MY_SERVER]\nhost = host.bla.com\nport = 1433\ntds version = 8.0\nclient charset = UTF-8\n</code></pre>\n\n<p>/usr/local/etc/odbc.ini</p>\n\n<pre><code>[MY_DSN]\nDriver=/usr/local/lib/libtdsodbc.so\nDescription=Sql Server Local\nServername=MY_SERVER\nPort=1433\nDatabase=my_database\n</code></pre>\n\n<p>When I run <code>script/console</code> and try to access any model:</p>\n\n<blockquote>\n  <blockquote>\n    <p>Product\n       ODBC::Error: IM002 (0) [iODBC][Driver Manager]Data source name not found and no default driver specified. Driver could not be loaded</p>\n  </blockquote>\n</blockquote>\n\n<p>It seems iODBC is being used to connect to the database, when I want to use unixodbc. How can I make my rails app use unixodbc instead of iODBC?</p>\n"}]}
{"total":93230,"page":8,"pagesize":100,"questions":[{"tags":["ruby-on-rails","api","rest","routes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13238971,"title":"Rails Routes redirecting with 301","body":"<p>I am attempting to build a Versioned RESTful API for my application. I have attempted to do this through rails route redirects.</p>\n\n<pre><code> scope '/api' do\n   scope '/v0.1' do\n     scope '/favorites' do\n       match '/' =&gt; 'home#favorites'\n       match '/people/:person' =&gt; 'people#favorites'\n       match '/pets/:pet' =&gt; 'pets#favorites'\n       match '/*all' =&gt; 'home#favorites', :constraints =&gt; {:all =&gt; /^((?!.*(people|pets)).*)$/i}\n     end\n   end\n end\n\n match \"/api/latest_version/*path\", :to =&gt; redirect(\"/api/v0.1/%{path}\"), :constraints =&gt; {:path =&gt; /^((?!.*(latest_version|v[\\d]+\\.[\\d]+)).*)$/i }\n match \"/api/*path\", :to =&gt; redirect(\"/api/latest_version/%{path}\"), :constraints =&gt; {:path =&gt; /^((?!.*(latest_version|v[\\d]+\\.[\\d]+)).*)$/i }\n</code></pre>\n\n<p>The result is as follows: </p>\n\n<pre><code>GET http://localhost:3000/api/favorites/people/1 301 Moved Permanently 49ms \n\nGET http://localhost:3000/api/latest_version/favorites/people/1 301 Moved Permanently 40ms  \nGET http://localhost:3000/api/v0.1/favorites/people/1 200 OK 104ms  \n</code></pre>\n\n<p>With the latter two hanging indefinitely (according to Firebug anyway), but the first receiving the correct JSON response.</p>\n\n<p>I would very much appreciate any help with getting these rerouted api calls to terminate, and would very much welcome any advice on testing these routes. Also how would I ensure that the first request returns the final requests HTTP code to API users? Is that even possible?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13240064,"title":"How to render a \"Edit\" form partial in the \"Show\" page of another model in Rails","body":"<p>I want to display an \"Edit\" form in the \"Show\" view of a parent object.</p>\n\n<p>My model looks like this:\nA Trip has many Days which has many Activities.\nTrip accepts nested attributes for Days.  Days accepts nested Attributes for Activities.</p>\n\n<p>When I am in the \"Show\" view for a Trip, how do I render an \"Edit\" form partial for an \"Activity\"?</p>\n\n<p>I know I need to somehow specify to the Edit Form partial which Activity ID that I want to edit but I'm not sure how to pass along that information from the \"Show\" view of a \"Trip\".</p>\n\n<pre><code>    &lt;% @trip.days.each do |day| %&gt;\n    &lt;div id=\"daydiv_&lt;%= day.id %&gt;\"&gt;\n      &lt;b&gt;&lt;%= day.summary %&gt;&lt;/b&gt;\n        &lt;%= content_tag_for :ol, day do %&gt;\n          &lt;% day.activities.each do |activity| %&gt;\n                &lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_activity_path(activity) %&gt;&lt;/li&gt;\n          &lt;% end %&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n\n&lt;div id=\"activity_form\"&gt;\n  &lt;%= render :partial =&gt; \"/activities/form\", :activity =&gt; @activity  %&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>my /activities/form partial looks like this:</p>\n\n<pre><code>&lt;%= form_for(@activity) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13239929,"title":"\"nil is not a symbol\" for model count in rspec matcher","body":"<p>I am trying to write an integration test where if a user clicks on a button, it creates a new record in the database (CheckPrice model).</p>\n\n<p>I am running into the error <code>nil is not a symbol</code> when I try to run my test.</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe 'CheckPrice', type: :request, js: true  do\n  it \"should create a new CheckPrice record when user clicks Check Price on topic page\" do\n    city = create :city\n    hotel = create :hotel\n    affiliate_link = create :affiliate_link\n\n    visit '/hotel-bilboa-hotel'\n    sleep 2\n    click_button \"Check Prices\"\n    response.should change(CheckPrice.count).by(1)\n  end\nend\n</code></pre>\n\n<p>When \"Check Prices\" is clicked, there is an event listener that triggers the new method in the checkprices_controller.</p>\n\n<p>The error seems to occur on the last line <code>response.should change(CheckPrice.count).by(1)</code>. It looks like the method does not recognize the model CheckPrice. How do I reference the CheckPrice table?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","mvc","design-patterns"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13238539,"title":"How can I conditionally, or contextually, load an interface of methods into a model from a Rails /lib?","body":"<p>We have a set of reports that run out of <code>/lib</code>.  These have grown so voluminous that we now have written many methods that would count as helpers or other 'decorator-style' methods relating specifically to Reporting.  </p>\n\n<p>These additional methods live in the report, and look like:</p>\n\n<pre><code>class report\n  def get_latest_credential_updated_date\n    credentials.map(&amp;:updated_at).compact.max\n  end\n\n  def initialize \n    # set up stuff\n  end\nend\n</code></pre>\n\n<ol>\n<li><p>Is there a way to load a module, or otherwise inject code to a Model when the reporting lib loads:</p>\n\n<pre><code>class Loan &lt; ActiveRecord::Base\n  def get_latest_credential_updated_date\n    credentials.map(&amp;:updated_at).compact.max\n  end\nend\n</code></pre></li>\n<li><p>Is there a better pattern to represent this architecture?</p></li>\n</ol>\n"},{"tags":["ruby-on-rails","tinymce","spellchecking"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":19,"score":3,"question_id":13239640,"title":"ArgumentError when using TinymceSpellcheck","body":"<p>I want to use 'tinymce_spellcheck' to use the spellcheck button in my tinymce editor. \n    I wrote in my controller:</p>\n\n<pre><code>def spellcheck\n  data = ActiveSupport::JSON.decode(request.raw_post)\n  args = data['params'].to_a.first\n  spellcheck = TinymceSpellcheck.new({}, :raspell)\n  result = spellcheck.send(data['method'].underscore,*args)  #****---- THIS LINE****\n  render :json =&gt; { :id =&gt; data['id'], :result =&gt; result, :error =&gt; nil }.to_json\nend \n</code></pre>\n\n<p>I get the following error message:</p>\n\n<pre><code>ArgumentError (wrong number of arguments (1 for 2)):\napp/controllers/members_controller.rb:127:in `spellcheck'\n</code></pre>\n\n<p>Would you be so kind to tell me how to solve this problem? I am providing two arguments and, yet, I get the same error message again and again.</p>\n"},{"tags":["ruby-on-rails","ruby","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13239469,"title":"How can I change Ruby to version 1.9.3 (again) with RVM?","body":"<p>I used to work with Ruby version 1.9.3 on Ubuntu and made an update that probably screwed my bash profile and I need help to turn it back rather than using version 1.8.7. Right now <code>rails s</code> opens the server with Ruby 1.8.7 and I get errors because of the newer syntax I use in my app.</p>\n\n<p><code>.bash_profile</code>:</p>\n\n<pre><code>cat ~/.bash_profile\n\n### Added by the Heroku Toolbelt\nexport PATH=\"/usr/local/heroku/bin:$PATH\"\n\n[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\" # Load RVM into a shell session *as a function*\n</code></pre>\n\n<p><code>which rails</code>:</p>\n\n<pre><code>/usr/local/bin/rails\n</code></pre>\n\n<p><code>which ruby</code>:</p>\n\n<pre><code>/usr/bin/ruby\n</code></pre>\n\n<p><code>ruby -v</code>:</p>\n\n<pre><code>ruby 1.8.7 (2011-06-30 patchlevel 352) [i686-linux]\n</code></pre>\n\n<p><code>rvm list</code>:</p>\n\n<pre><code>rvm rubies\n\n=* ruby-1.9.3-p194 [ i686 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n\n<p><code>rvm use 1.9.3</code>:</p>\n\n<pre><code>RVM is not a function, selecting rubies with 'rvm use ...' will not work.\n\nYou need to change your terminal emulator preferences to allow login shell.\nSometimes it is required to use `/bin/bash --login` as the command.\nPlease visit https://rvm.io/integration/gnome-terminal/ for a example.\n</code></pre>\n"},{"tags":["ruby-on-rails","paypal","activemerchant"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13240179,"title":"paypal immediate, chained payment","body":"<p>I have a an application for digital goods which makes use of paypal.\nI need to tackle the following scenario:</p>\n\n<p>A buyer  (german paypal account) buys an item, the application itself (german paypal account) should receive a fee and another party  (german paypal account) should receive money.\nSo I started using adaptive payments (in rails I do use  the active_paypal_adaptive_payment gem), which is working fine.</p>\n\n<p>But as soon as the buyer is located in the us (paypal sandbox account for us seller) I have an unverified checking account. Consequently the payment remains pending until the receiver accepts the payment.</p>\n\n<p>But this is not wanted, since I want to accept only payments which can be processed right away.\nSo is it possible to use paypal's immediate payment in conjunction with adaptive payment (preferably the active_merchant gem for reils) ?</p>\n\n<p>Best,\nPhilip </p>\n"},{"tags":["ruby-on-rails","erb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13237139,"title":"rails erb line width","body":"<p>i currently try to call a javascript method with link_to_function.</p>\n\n<pre><code>&lt;%= link_to_function( r.cls.to_s.split(\"#\").last ,\n\"loadDetails('#{Base64.encode64(r.cls.to_s).strip}');\"  )%&gt;\n</code></pre>\n\n<p>The problem is i get a JS error:</p>\n\n<pre><code>Uncaught SyntaxError: Unexpected token ILLEGAL \n</code></pre>\n\n<p>I assume this happens because rails puts some line breaks into my code:</p>\n\n<pre><code>    onclick=\"loadDetails('aHR0cDovL3d3dy5vd2wtb250b2xvZ2llcy5jb20vT250b2xvZ3kxMzUxNzAy\n\nNTA5Lm93bCNjMzM=');; return false;\"\n</code></pre>\n\n<p>I would like that link_to_funktion prints out linke-break-free output.</p>\n\n<p>Do you know how to archieve this?</p>\n\n<p><strong>PS:</strong></p>\n\n<p>When i escape javascript it still returns: </p>\n\n<pre><code>Uncaught SyntaxError: Unexpected token ILLEGAL \n</code></pre>\n"},{"tags":["ruby-on-rails","facebook-javascript-sdk","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13239934,"title":"How can I logout completely using the omniauth-facebook?","body":"<p>I want to logout a user from facebook when they logout of my site. How can I achieve this?</p>\n\n<p>I am trying to avoid using the javascript sdk ( if possible )</p>\n"},{"tags":["mysql","ruby-on-rails","sqlite"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":490,"score":2,"question_id":2394757,"title":"Rails keeps trying to use SQLite , despite that I've configured MySQL for my project","body":"<p>I setup my rails project \"tracks\" using:</p>\n\n<pre><code>$ rails --database=mysql tracks # OK\n$ cd tracks\n$ vim config/database.yml # correct using mysql adapter, added password spec\n$ rake db:create RAILS_ENV='development' # OK\n$ rake db:migrate # OK\n\n$ ruby script/generate scaffold user name:string password:string email:string url:string # OK\n$ rake db:migrate # OK, creates table\n$ ruby script/server # OK, starts WEBrick\n</code></pre>\n\n<p>I open up the thing in a web browser:</p>\n\n<pre><code>http://localhost:3000 # correctly shows the rails welcome splash\n</code></pre>\n\n<p>I navigate to</p>\n\n<pre><code>http://localhost:3000/users/new\n</code></pre>\n\n<p>and get a huge slew of errors:</p>\n\n<pre><code>ActiveRecord::StatementInvalid in UsersController#index\n\nSQLite3::SQLException: no such table: users: SELECT * FROM \"users\" \nRAILS_ROOT: /home/drew/tracks/trunk/tracks\n\nApplication Trace | Framework Trace | Full Trace\nvendor/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:188:in `log'\nvendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb:132:in `execute'\nvendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb:372:in `catch_schema_changes'\nvendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb:132:in `execute'\nvendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb:275:in `select'\nvendor/rails/activerecord/lib/active_record/connection_adapters/abstract/database_statements.rb:7:in `select_all_without_query_cache'\nvendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:60:in `select_all'\nvendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:81:in `cache_sql'\nvendor/rails/activerecord/lib/active_record/connection_adapters/abstract/query_cache.rb:60:in `select_all'\nvendor/rails/activerecord/lib/active_record/base.rb:635:in `find_by_sql'\nvendor/rails/activerecord/lib/active_record/base.rb:1490:in `find_every'\nvendor/rails/activerecord/lib/active_record/base.rb:589:in `find'\napp/controllers/users_controller.rb:5:in `index'\n</code></pre>\n\n<p><strong>wtf? Why is ruby still trying to use SQLite? database.yml has zero mention of SQLite.</strong></p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":283,"score":0,"question_id":11158850,"title":"Hartl Chapter 10 Undefined local variable or method 'object'","body":"<p>I made the form partial for creating microposts as shown in <a href=\"http://ruby.railstutorial.org/chapters/user-microposts#code%3amicropost_form\" rel=\"nofollow\">Listing 10.33</a> with <code>&lt;%= render 'shared/error_messages', object: f.object %&gt;</code> and updated the respective views files as instructed. However, I cannot get the Rspec tests to pass as I keep getting \"undefined local variable or method 'object' for Class...\" Any ideas?</p>\n\n<p>app/views/shared/_micropost_form.html.erb</p>\n\n<pre><code>&lt;%= form_for(@micropost) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_area :content, placeholder: \"Compose new micropost...\" %&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>app/views/shared/_error_messages.html.erb</p>\n\n<pre><code>&lt;% if object.errors.any? %&gt;\n  &lt;div id=\"error_explanation\"&gt;\n    &lt;div class=\"alert alert-error\"&gt;\n      The form contains &lt;%= pluralize(object.errors.count, \"error\") %&gt;.\n    &lt;/div&gt;\n    &lt;ul&gt;\n      &lt;% object.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;* &lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>app/views/users/new.html.erb</p>\n\n<pre><code>&lt;% provide(:title, 'Sign up') %&gt;\n&lt;h1&gt;Sign up&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span6 offset3\"&gt;\n    &lt;%= form_for(@user) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n      &lt;%= render 'fields', f: f %&gt;\n      &lt;%= f.submit \"Create my account\", class: \"btn btn-large btn-primary\" %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>app/views/users/edit.html.erb</p>\n\n<pre><code>&lt;% provide(:title, \"Edit user\") %&gt; \n&lt;h1&gt;Update your profile&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span6 offset3\"&gt;\n    &lt;%= form_for(@user) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n      &lt;%= render 'fields', f: f %&gt;\n      &lt;%= f.submit \"Save changes\", class: \"btn btn-large btn-primary\" %&gt;\n    &lt;% end %&gt;\n\n    &lt;%= gravatar_for @user %&gt;\n    &lt;a href=\"http://gravatar.com/emails\" target=\"_blank\"&gt;change&lt;/a&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Authentication Spec</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"Authentication\" do\n\n  subject { page }\n\n  describe \"signin page\" do\n    before { visit signin_path }\n\n    it { should have_selector('h1',    text: 'Sign in') }\n    it { should have_selector('title', text: 'Sign in') }\n  end\n\n  describe \"signin\" do\n    before { visit signin_path }\n\n    describe \"with invalid information\" do\n      before { click_button \"Sign in\" }\n\n      it { should have_selector('title', text: 'Sign in') }\n      it { should have_error_message('Invalid') }\n\n      it { should_not have_link('Users',    href: users_path) }\n      it { should_not have_link('Sign out', href: signout_path) }\n\n      describe \"after visiting another page\" do\n        before { click_link \"Home\" }\n        it { should_not have_selector('div.alert.alert-error') }\n      end      \n    end\n\n    describe \"with valid information\" do\n      let(:user) { FactoryGirl.create(:user) }\n      before { sign_in user }\n\n      it { should have_selector('title', text: user.name) }\n\n      it { should have_link('Users',    href: users_path) }\n      it { should have_link('Profile', href: user_path(user)) }\n      it { should have_link('Settings', href: edit_user_path(user)) }\n      it { should have_link('Sign out', href: signout_path) }\n\n      it { should_not have_link('Sign in', href: signin_path) }\n\n      describe \"followed by signout\" do\n        before { click_link \"Sign out\" }\n        it { should have_link('Sign in') }\n      end      \n    end    \n  end  \n\n  describe \"authorization\" do\n\n    describe \"for non-signed-in users\" do\n      let(:user) { FactoryGirl.create(:user) }\n\n      describe \"in the Users controller\" do\n\n      it { should_not have_link('Profile', href: user_path(user)) }\n      it { should_not have_link('Settings', href: edit_user_path(user)) }\n\n        describe \"visiting the edit page\" do\n          before { visit edit_user_path(user) }\n          it { should have_selector('title', text: 'Sign in') }\n        end\n\n        describe \"submitting to the update action\" do\n          before { put user_path(user) }\n          specify { response.should redirect_to(signin_path) }\n        end\n\n        describe \"visiting the user index\" do\n          before { visit users_path }\n          it { should have_selector('title', text: 'Sign in') }\n        end \n      end\n\n      describe \"when attempting to visit a protected page\" do\n        before do\n          visit edit_user_path(user)\n          fill_in \"Email\",    with: user.email\n          fill_in \"Password\", with: user.password\n          click_button \"Sign in\"\n        end\n\n        describe \"after signing in\" do\n\n          it \"should render the desired protected page\" do\n            page.should have_selector('title', text: 'Edit user')\n          end\n\n      describe \"when signing in again\" do\n        before do\n          visit signin_path\n          fill_in \"Email\", with: user.email\n              fill_in \"Password\", with: user.password\n          click_button \"Sign in\"\n            end\n\n        it \"should render the default (profile) page\" do\n          page.should have_selector('title', text: user.name)\n        end\n          end\n        end\n\n      describe \"in the Microposts controller\" do\n\n        describe \"submitting to the create action\" do\n          before { post microposts_path }\n          specify { response.should redirect_to(signin_path) }\n        end\n\n        describe \"submitting to the destroy action\" do\n          before { delete micropost_path(FactoryGirl.create(:micropost)) }\n          specify { response.should redirect_to(signin_path) }\n        end\n      end   \n    end\n  end\n\n    describe \"as wrong user\" do\n      let(:user) { FactoryGirl.create(:user) }\n      let(:wrong_user) { FactoryGirl.create(:user, email: \"wrong@example.com\") }\n      before { sign_in user }\n\n      describe \"visiting Users#edit page\" do\n        before { visit edit_user_path(wrong_user) }\n        it { should_not have_selector('title', text: full_title('Edit user')) }\n      end\n\n      describe \"submitting a PUT request to the Users#update action\" do\n        before { put user_path(wrong_user) }\n        specify { response.should redirect_to(root_path) }\n      end\n    end  \n\n    describe \"as non-admin user\" do\n      let(:user) { FactoryGirl.create(:user) }\n      let(:non_admin) { FactoryGirl.create(:user) }\n\n      before { sign_in non_admin }\n\n      describe \"submitting a DELETE request to the Users#destroy action\" do\n        before { delete user_path(user) }\n        specify { response.should redirect_to(root_path) }        \n      end\n    end\n  end  \nend\n</code></pre>\n\n<p>User Spec</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"User pages\" do\n\n  subject { page }\n\n  describe \"index\" do\n\n    let(:user) { FactoryGirl.create(:user) }\n\n    before(:all) { 30.times { FactoryGirl.create(:user) } }\n    after(:all)  { User.delete_all }\n\n    before(:each) do\n      sign_in user\n      visit users_path\n    end    \n\n    it { should have_selector('title', text: 'All users') }\n    it { should have_selector('h1',    text: 'All users') }    \n\n    describe \"pagination\" do\n\n      it { should have_selector('div.pagination') }\n\n      it \"should list each user\" do\n        User.paginate(page: 1).each do |user|\n          page.should have_selector('li', text: user.name)\n        end\n      end\n    end\n\n    describe \"delete links\" do\n\n      it { should_not have_link('delete') }\n\n      describe \"as an admin user\" do\n        let(:admin) { FactoryGirl.create(:admin) }\n        before do\n          sign_in admin\n          visit users_path\n        end\n\n        it { should have_link('delete', href: user_path(User.first)) }\n        it \"should be able to delete another user\" do\n          expect { click_link('delete') }.to change(User, :count).by(-1)\n        end\n        it { should_not have_link('delete', href: user_path(admin)) }\n      end\n    end     \n  end\n\n  describe \"signup page\" do\n    before { visit signup_path }\n\n    it { should have_selector('h1',    text: 'Sign up') }\n    it { should have_selector('title', text: 'Sign up') }\n  end\n\n  describe \"profile page\" do\n    let(:user) { FactoryGirl.create(:user) }\n    let!(:m1) { FactoryGirl.create(:micropost, user: user, content: \"Foo\") }\n    let!(:m2) { FactoryGirl.create(:micropost, user: user, content: \"Bar\") }   \n\n    before { visit user_path(user) }\n\n    it { should have_selector('h1',    text: user.name) }\n    it { should have_selector('title', text: user.name) }\n  end  \n\n  describe \"microposts\" do\n      it { should have_content(m1.content) }\n      it { should have_content(m2.content) }\n      it { should have_content(user.microposts.count) }\n    end\n\n  describe \"signup\" do\n\n    before { visit signup_path }\n\n    let(:submit) { \"Create my account\" }\n\n    describe \"with invalid information\" do\n      it \"should not create a user\" do\n        expect { click_button submit }.not_to change(User, :count)\n      end\n\n      describe \"after submission\" do\n        before { click_button submit }\n\n        it { should have_selector('title', text: 'Sign up') }\n        it { should have_content('error') }\n      end      \n    end\n\n    describe \"with valid information\" do\n      before { valid_signup }\n\n      it \"should create a user\" do\n        expect { click_button submit }.to change(User, :count).by(1)\n      end\n\n      describe \"after saving the user\" do\n        before { click_button submit }\n        let(:user) { User.find_by_email('user@example.com') }\n\n        it { should have_selector('title', text: user.name) }\n        it { should have_success_message('Welcome') }\n    it { should have_link('Sign out') }\n      end\n    end\n  end  \n\n  describe \"edit\" do\n    let(:user) { FactoryGirl.create(:user) }\n    before do\n      sign_in user\n      visit edit_user_path(user)\n    end\n\n    describe \"page\" do\n      it { should have_selector('h1',    text: \"Update your profile\") }\n      it { should have_selector('title', text: \"Edit user\") }\n      it { should have_link('change', href: 'http://gravatar.com/emails') }\n    end\n\n    describe \"with invalid information\" do\n      before { click_button \"Save changes\" }\n\n      it { should have_content('error') }\n    end\n\n    describe \"with valid information\" do\n      let(:new_name)  { \"New Name\" }\n      let(:new_email) { \"new@example.com\" }\n      before do\n        fill_in \"Name\",             with: new_name\n        fill_in \"Email\",            with: new_email\n        fill_in \"Password\",         with: user.password\n        fill_in \"Confirm Password\", with: user.password\n        click_button \"Save changes\"\n      end\n\n      it { should have_selector('title', text: new_name) }\n      it { should have_success_message }\n      it { should have_link('Sign out', href: signout_path) }\n      specify { user.reload.name.should  == new_name }\n      specify { user.reload.email.should == new_email }\n    end    \n  end  \nend\n</code></pre>\n"},{"tags":["ruby-on-rails","html-entities","actionview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13238237,"title":"Being html_safe in Rails while retaining html entities?","body":"<p>Let's say I'm outputting a post title and in our database, it's <code>Hello Y&amp;#8217;all</code> -- can I output it without using <code>.html_safe</code>, but in such a way that it doesn't get output in html as <code>Hello Y&amp;amp;#8217;all</code>?</p>\n\n<p>That is, if a user copies a post title from a word processor that uses typographically correct apostrophes, I'm getting gibberish output since it's escaping the <code>&amp;</code> in the database as <code>&amp;amp;</code>. Of course, I would want a title from the database that's <code>Bonnie &amp; Clyde</code> to be output as <code>Bonnie &amp;amp; Clyde</code> since that is the correct HTML...</p>\n\n<p>Is there a safe way to do this?</p>\n"},{"tags":["ruby-on-rails","zurb-foundation"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":579,"score":2,"question_id":11369354,"title":"zurb-foundation javascripts are not working ","body":"<p>Javascripts are not working. Am i missing something ? I can see that javascript and css files are in the generated html. Thanks.</p>\n\n<p>gemfile</p>\n\n<pre><code>group :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'compass-rails', '~&gt; 1.0.3'\n  gem 'zurb-foundation', '~&gt; 3.0.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n</code></pre>\n\n<p>application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require foundation\n//= require_tree .\n</code></pre>\n\n<p>application.css.scss</p>\n\n<pre><code>@import \"foundation\";\n</code></pre>\n\n<p>generated code</p>\n\n<pre><code>&lt;link href=\"/assets/application.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/foundation/modernizr.foundation.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/foundation/jquery.customforms.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/foundation/jquery.orbit-1.4.0.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/foundation/jquery.placeholder.min.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/foundation/jquery.reveal.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/foundation/jquery.tooltips.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/foundation/index.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/site.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/application.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","heroku","godaddy"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13219275,"title":"godaddy domain name not resolving to heroku app","body":"<p>My heroku app is located <a href=\"http://salty-temple-9504.herokuapp.com\" rel=\"nofollow\">here</a> and I updated my godaddy domain name (inspiredwebmedia.com) to link to it in the zone file editor. </p>\n\n<p>In the host column I have www and for the points to I have salty-temple-9504.herokuapp.com. </p>\n\n<p>I also added the domain name in my heroku account. But the domain name is still not going to the heroku app. Any ideas? Do I have to change my DNS settings? They are currently pointing to my godaddy hosting account.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","activescaffold"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13239461,"title":"Active Scaffold - customize action links in record rows","body":"<p>Trying to remove what I assume is a default action in my active scaffold view.  My records all have an 'actions' column, within which is a link for 'copy' and 'delete.'  The problem is, 'copy' is a dead end–that method doesn't exist in my controller, and the link doesn't go anywhere.  Trying to figure out how to get rid of it.  I've searched through the controller code, and there's no where that's explicitly adding it.</p>\n\n<p>I've tried messing around with <code>config.actions</code> and <code>config.action_links</code>, but they don't work.</p>\n\n<p>Here's the controller code that creates the actions column:</p>\n\n<pre><code>config.actions = [:list, :search, :create]\nconfig.columns = [\n  :name,\n  :actions,\n  ]\nconfig.columns[:actions].css_class = 'no-wrapping footnote'\n</code></pre>\n\n<p>And here's an image of what the column looks like:\n<a href=\"http://cl.ly/image/0d0i3a0M432E\" rel=\"nofollow\">http://cl.ly/image/0d0i3a0M432E</a></p>\n\n<p>I need to keep the <code>delete</code> action, but drop the <code>copy</code> action.</p>\n"},{"tags":["ruby-on-rails","datatables"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13239047,"title":"Complex SQL for datatables json builder","body":"<p>I am using Ryan Bates awesome custom class to grab some product JSON to display in my AJAX datatable (datatables.net)... see link:</p>\n\n<p><a href=\"https://github.com/ryanb/railscasts-episodes/blob/master/episode-340/store-after/app/datatables/products_datatable.rb\" rel=\"nofollow\">https://github.com/ryanb/railscasts-episodes/blob/master/episode-340/store-after/app/datatables/products_datatable.rb</a></p>\n\n<p>Basically I need to mod the fetch_products function to enable more delicate querying.. I need rails to be able to order my products by beyesian rank, but this is not stored in the DB but instead is based on a calculation like:</p>\n\n<pre><code>@bayesian = (((@overall_count * @overall_average) + (@review_count * @review_score_raw))/(@overall_count + @review_count)) \n</code></pre>\n\n<p>So I will need to somehow build that into the query it seems. Is this possible? Is there any other way to sort by a column that is calculated on the fly?</p>\n"},{"tags":["ruby-on-rails","ruby","helpers"],"answer_count":4,"favorite_count":12,"up_vote_count":31,"down_vote_count":0,"view_count":12412,"score":31,"question_id":1179865,"title":"Why are all Rails helpers available to all views, all the time? Is there a way to disable this?","body":"<p>Why can I access helper methods for one controller in the views for a different controller? Is there a way to disable this without hacking/patching Rails?</p>\n"},{"tags":["ruby-on-rails","ruby","haml"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":968,"score":7,"question_id":6244052,"title":"Empty attribute with Ruby HAML","body":"<p>I'm implementing Schema microformats on a Ruby project using HAML and can't figure out how to set an empty attribute on a tag. I tried nil and false, but they simply do not shown.</p>\n\n<p>Example: <code>&lt;div itemscope&gt;</code></p>\n\n<p>I'm tring to set an empty itemscope attribute.</p>\n\n<h3>Code added from comment by @StrangeElement:</h3>\n\n<p>My code: </p>\n\n<pre><code>.agency.premium{:itemscope =&gt; true, :itemtype =&gt; 'schema.org/ProfessionalService';} \n</code></pre>\n\n<p><code>:itemscope =&gt; true</code> seems to be the recommended approach from HAML's documentation. I get the same result as I would get with <code>:itemscope =&gt; ''</code>, a XHTML-valid attribute with an empty value (i.e. <code>&lt;div itemscope=\"\"&gt;</code>).</p>\n\n<p>Probably fine, but I'd rather have it empty as is documented in the Schema doc. </p>\n"},{"tags":["ruby-on-rails","testing","paperclip","testunit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13238371,"title":"How do I test a paperclip URL?","body":"<p>I'm using <code>Test::Unit</code>, and I'd like to test a paperclip url.</p>\n\n<p>Right now, I have a test that looks like this:</p>\n\n<pre><code>  def test_our_custom_url\n    dummy = Dummy.new(:image =&gt; File.open(\"#{RAILS_ROOT}/test/fixtures/12k.png\"))\n    dummy.save!\n    assert_match \"/system/images/1/original/12k.png\", dummy.image.url\n    dummy.reload\n    assert_match \"/system/images/1/original/12k.png\", dummy.image.url\n  end\n</code></pre>\n\n<p>And it fails like this:</p>\n\n<pre><code>Expected /\\/system\\/images\\/1\\/original\\/12k.png/ to match \"/system/dummies/images/000/000/001/original/12k.png?1352140343\".\n</code></pre>\n\n<p>How can I get the <code>?1352140343</code> part added to the test? </p>\n\n<p>I see in paperclips source code that they seem to define it <a href=\"https://github.com/thoughtbot/paperclip/blob/master/lib/paperclip/url_generator.rb\" rel=\"nofollow\">like this</a>:</p>\n\n<pre><code>def timestamp_as_needed(url, options)\n  if options[:timestamp] &amp;&amp; timestamp_possible?\n    delimiter_char = url.match(/\\?.+=/) ? '&amp;' : '?'\n    \"#{url}#{delimiter_char}#{@attachment.updated_at.to_s}\"\n  else\n    url\n  end\nend\n</code></pre>\n\n<p>but doing <code>dummy.updated_at.to_s</code> returns a normal date/timestamp, not <code>1352140343</code> (in this case). </p>\n\n<p>I'm using local storage, if it makes a difference.</p>\n"},{"tags":["ruby-on-rails","ruby","rest","neo4j"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":772,"score":4,"question_id":8335136,"title":"Which Ruby REST API client for neo4j?","body":"<p>I wonder what the REST API clients are available for using from Ruby (not JRuby, so native bindings are not an option)?</p>\n\n<p>Ideally, I would want the API similar to the <code>neo4j</code> gem or <code>ActiveRecord</code> (validations, migrations, observers etc).</p>\n\n<p>Currently available (REST) tooling doesn't even come close to what we have, for example, in ActiveRecrod:</p>\n\n<ol>\n<li><a href=\"https://github.com/maxdemarzi/neography\" rel=\"nofollow\">neograhy</a> - just <strong>plain REST</strong> API. Nothing to do with models etc.</li>\n<li><a href=\"https://github.com/lordkada/neology\" rel=\"nofollow\">neology</a> - is just a <strong>wrapper over neography</strong> and isn't a full featured ActiveModel.</li>\n<li><a href=\"https://github.com/namxam/architect4r\" rel=\"nofollow\">architect4r</a> - <strong>conforms to ActiveModel</strong>, but provides only one way to query data (Gypher language), also no indexes support.</li>\n</ol>\n\n<p>I like the code of <code>architect4r</code> a little bit more (primarily because it uses ActiveModel).</p>\n\n<p>But <code>neology</code> seems to be much more pragmatic choice as it already is using <code>neography</code> under the hood.</p>\n\n<p>The choice is pretty small and tough.</p>\n\n<p>Could you please tell when one should be used rather than the other?<br>\nAlso any recommendations that would help me to decide on the gem are very welcome.</p>\n\n<p>Thanks.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13059971,"title":"Jquery basic file upload","body":"<p>I been working on a screencast pro proposed by Ryan called the Jquery file uploads. However every time i input images it doesn't get uploaded. I am not sure what i am doing wrong here my code. I am using google and did try to upload it but it doesn't seem to be doing anything</p>\n\n<p>Javascript\napplication.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery-fileupload/basic\n//= require jquery-fileupload/vendor/tmpl\n//= require_tree .\n</code></pre>\n\n<p>painting.js.coffee</p>\n\n<pre><code>jQuery -&gt;\n  $('#new_painting').fileupload\n</code></pre>\n\n<p>Views\n_form.html.erb</p>\n\n<pre><code>&lt;%= form_for @painting, :html =&gt; {:multipart =&gt; true} do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.hidden_field :galley_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :image %&gt;&lt;br /&gt;\n    &lt;%= f.file_field :image %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>index.html.erb</p>\n\n<h1>Painting Gallery</h1>\n\n\n  \n\n\n\n\n<pre><code>&lt;%= form_for Painting.new do |f| %&gt;\n  &lt;%= f.label :image, \"Upload paintings:\" %&gt;\n  &lt;%= f.file_field :image, multiple: true, name: \"painting[image]\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>show.html.erb</p>\n\n<pre><code>&lt;p&gt;&lt;%= image_tag @painting.image_url %&gt;&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;%= link_to \"Edit\", edit_painting_path(@painting) %&gt; |\n  &lt;%= link_to \"Destroy\", @painting, :confirm =&gt; 'Are you sure?', :method =&gt; :delete %&gt; |\n  &lt;%= link_to \"Back to Paintings\", paintings_path %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>def index\n    @paintings = Painting.all\n  end\n\n  def show\n    @painting = Painting.find(params[:id])\n  end\n\n  def new\n    @painting = Painting.new\n  end\n\n  def create\n    @painting = Painting.create(params[:painting])\n  end\n\n  def edit\n    @painting = Painting.find(params[:id])\n  end\n\n  def update\n    @painting = Painting.find(params[:id])\n    if @painting.update_attributes(params[:painting])\n      redirect_to paintings_url, notice: \"Painting was successfully updated.\"\n    else\n      render :edit\n    end\n  end\n\n  def destroy\n    @painting = Painting.find(params[:id])\n    @painting.destroy\n    redirect_to paintings_url, notice: \"Painting was successfully destroyed.\"\n  end\n</code></pre>\n\n<p>Model</p>\n\n<pre><code>  attr_accessible :image\n  mount_uploader :image, ImageUploader\n</code></pre>\n\n<p>My main issues is when it comes to upload any picture it just doesn't have a submit button and not sure how to make it work, did i miss something??</p>\n"},{"tags":["ruby-on-rails","database","postgresql","ps"],"answer_count":4,"favorite_count":19,"up_vote_count":26,"down_vote_count":0,"view_count":8303,"score":26,"question_id":5108876,"title":"Kill a postgresql session/connection","body":"<p>How can I kill all my postgresql connections?</p>\n\n<p>I'm trying a <code>rake db:drop</code> but I get:</p>\n\n<pre><code>ERROR:  database \"database_name\" is being accessed by other users\nDETAIL:  There are 1 other session(s) using the database.\n</code></pre>\n\n<p>I've tried shutting down the processes I see from a <code>ps -ef | grep postgres</code> but this doesn't work either:</p>\n\n<pre><code>kill: kill 2358 failed: operation not permitted\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","json"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5069,"score":1,"question_id":4253238,"title":"Ruby array to JSON and Rails JSON rendering","body":"<p>I have a Ruby array, how can i render this as a JSON view in Rails 3.0?</p>\n\n<p>My Controller method is </p>\n\n<pre><code>def autocomplete\n     @question = Question.all\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ajax","session","post","cookies"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13238097,"title":"How do I send a dropdown selection in Rails through a post and persist that choice in a session?","body":"<p>I am trying to add what should be a simple feature to a Rails site. There is to be a dropdown menu to select what timezone you want times to be displayed for. Once you have selected the timezone, that selection needs to now persist so during that session, any time values for that user that is displayed is in that timezone.</p>\n\n<p>I already have a nice function that my date formatting goes through in a helper module for the ApplicationController where I can apply the timezone and it is automatically applied to all dates displayed. However, a problem I am having is that while I need this data to be sent via POST, I also need to not be reliant on some kind of backend storage to make the select persist. The nature of the site I am doing this for is more or less just a frontend for multiple services so it has no databases of its own. It just makes service calls and displays the data received. This becomes a problem because most of the examples I've seen of session usage compares the session values to model values extended from ActiveRecord. On this site, ActiveRecord isn't even used.</p>\n\n<p>I realize the two things might be irrelevant, but it makes the learning process a bit harder when all the example code compares cookie data to model data when I effectively had no persistent model. Also I still don't quite understand the \"Rails Magic\" that determines what gets forwarded through in the params hash.</p>\n\n<p>So is there a simple way to have a dropdown selection that just stores the selection in a cookie and future renders for that user can be based on that cookie information without comparing the cookie data to some persistent model data?</p>\n\n<p>Edit: A commenter asked if there is a reason why AJAX can't be used. The answer is that there is no reason other than that I have never used AJAX before, so I would probably need some explanation to make it work. I thought AJAX was just a way to make queries without leaving the page, but the page needs to reload anyways after a selection is made, and more importantly it should re-render the same page that it was on previously with the new settings.</p>\n"},{"tags":["ruby-on-rails","json","sinatra","rabl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12593535,"title":"RABL renders ActiveRecord timestamps or datetimes as numbers instead of strings","body":"<p>I'm currently in the process of switching from ActiveRecord's <code>as_json</code> to RABL for API generation.</p>\n\n<p><code>as_json</code> has been rendering timestamps in my models as strings of the format <code>2012-09-16T22:14:11+00:00</code>. However, when I switched to RABL timestamps started rendering as epoch numbers like <code>1347926218.084763000</code> (note these dates are from two different objects and are not supposed to be equal). Is there a way to force the string format?</p>\n\n<p>My .rabl template is pretty simple:</p>\n\n<pre><code>object @person\nattributes :id, :created_on, :name\n</code></pre>\n\n<p>and I get:</p>\n\n<pre><code>{\"id\":3,\"created_on\":1347926218.084763000,\"name\":\"fred\"}\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13214865,"title":"Rails: Running a script based on values in the database","body":"<p>Right now, I have some tooltip JavaScript that I'd like to run on every page of my app, but only if the current user's model has User.advanced_tooltips set to true in my database.</p>\n\n<p>What is the best way conceptually to get this JavaScript to trigger conditionally based on a value in a database? I'm having some real trouble getting JavaScript and Rails to communicate.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":41,"score":4,"question_id":13182644,"title":"Rails Relation#update_all consumes more memory than Relation#update","body":"<p>The <code>Relation#update(id, attributes)</code> docs mentions that \"The resulting object is returned whether the object was saved successfully to the database or not.\", while the <code>Relation#update_all(updates, conditions = nil, options = {})</code> states that no instantiations, callbacks or validations are made (straight DB query).</p>\n\n<p>Running a simple performance test and replacing <code>Relation#update</code> with <code>Relation#update_all</code>, it looks like the memory consumption have increased.</p>\n\n<p>Any explanation?</p>\n\n<p>Excerpt:</p>\n\n<pre><code>#Before\nMyModel.update(my_hash['id'], special_attrs)\n\n#After (more memory consumed)\nMyModel.where(:id =&gt; my_hash['id']).update_all(special_attrs)\n\n#Update-2 (slightly more memory consumed than with update(id, attrs)\nMyModel.update_all(special_attrs, {:id =&gt; my_hash['id']})\n</code></pre>\n\n<ul>\n<li>Windows XP (yeh - I know)</li>\n<li>JRuby 1.6.8 (1.9)</li>\n<li>Rails 3.2.8</li>\n</ul>\n\n<p><strong>UPDATE</strong> - Some basic numbers for comparison: \nFor around 700 update statements fired, there's a difference of around 0.6MB (0.8kB per statement)</p>\n\n<p><strong>UPDATE 2</strong> - Removed AREL chaining as per @philip-hallstrom suggestion. Slight reduction in memory footprint but still <code>MyModel.update_all(attrs, conditions)</code> is consuming more memory than <code>MyModel.update(id, attrs)</code>.</p>\n"},{"tags":["ruby-on-rails","ruby","mongodb","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13197663,"title":"Order_by multiple fields, including a boolean","body":"<p>I'm trying to order my default_scope in a way that the itens with the boolean <code>important = true</code> show first, and all order by <code>created_at</code> desc.</p>\n\n<p>So, I have the following code:</p>\n\n<pre><code>default_scope order_by(:important =&gt; :desc, :created_at =&gt; :desc)\n</code></pre>\n\n<p>But, looks like <code>important</code> field order is ignored.</p>\n\n<p>How can I made it work?</p>\n\n<p>Thanks in advance</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>I just shift the order of the order params and it works:</p>\n\n<pre><code>default_scope order_by(:created_at =&gt; :desc, :important =&gt; :desc)\n</code></pre>\n\n<p>Just that simple.</p>\n"},{"tags":["ruby-on-rails","mysql2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1408,"score":0,"question_id":4317436,"title":"Rails3 + mysql2 gem, I get LibMYSQL.dll not found error","body":"<p>Ok so when I'm running \"rake db:create:all\" I get this \"libMYSQL.dll not found..\" error. I had the same problem with older version of rails but it was easy to fix, just copy libmysql.dll to ruby/bin.</p>\n\n<p>Well, with Rails 3 I tryed the same thing but it doesn't work.</p>\n\n<p>Anyone with a solution?</p>\n\n<p>Ruby on Rails 3.0.3\nmysql2 0.2.6\nRuby 1.9.2</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","mvc","rspec"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3086,"score":2,"question_id":326277,"title":"Rails: calling a model class in a library","body":"<p>I'm trying to verify that a parameter is an instance of a specific class in Rails:</p>\n\n<pre><code>def schedule(action, *args)\n  if arg.is_a? Aircraft\n    ...\n  end\nend\n</code></pre>\n\n<p>I'm doing this in a library class (the file is in <em>lib/</em>) and I get an <strong>uninitialized constant Aircraft</strong> error. Aircraft is a model class, with a corresponding <em>aircraft.rb</em> file in <em>app/models</em>.</p>\n\n<p>Can I use model classes and instances in a library? How?</p>\n\n<p><hr /></p>\n\n<p><strong>Error context:</strong></p>\n\n<p>The error happens in RSpec tests; the code works in the browser. I tried requiring the model in the *<em>spec.rb</em> file, no success at the moment.</p>\n"},{"tags":["ruby-on-rails","select","map","model"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13236545,"title":"Rails do select helper for model","body":"<p>I have Order model. But for it i need to introduce some edit. \nI need to do select list and put it in model file, for example </p>\n\n<pre><code>id | name\n</code></pre>\n\n<p>When i create new order i put in db as orderstatus_id for example 1.\nWhen i see this value in admin panel i want to see name. But how to do it without any db table?\nAlso for example when i change in admin panel order status i see this select list...</p>\n\n<p>So i need changes in model, controller, and views... but how to do what i describe below?\nAlso i understand that it sound like wide-question, but no, it is not.</p>\n"},{"tags":["ruby-on-rails","hashmap"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13236665,"title":"Ruby hash map with key that contains '-'","body":"<p>How can I add hash map element wich key contains \"-\". </p>\n\n<p>Like this: </p>\n\n<pre><code>&lt;%= button_to_function 'Cancel','cancelRemove(\"cancelEmail\")', :data-dismiss=&gt;'modal', :class=&gt;'btn' %&gt;\n</code></pre>\n\n<p>I get error undefined local variable or method `dismiss' for #</p>\n"},{"tags":["ruby-on-rails","json","rest"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13237053,"title":"Need a nice solution for a Rails JSON query service","body":"<p>I'm building a backend using Rails. It should ONLY(!) provide data using the database.</p>\n\n<p>At the moment my controller looks like this:</p>\n\n<pre><code>class RunsController &lt; ApplicationController\n    def index\n        @runs = Run.order(params[:order]).limit(params[:limit]).offset(params[:offset])\n\n        respond_to do |format|\n            format.json { render json: @runs, callback: params[:callback] }\n        end\n    end\n\n    def show\n        @run = Run.find(params[:id])\n\n        respond_to do |format|\n            format.json { render json: @run, callback: params[:callback] }\n        end\n    end\nend\n</code></pre>\n\n<p>So i can simply request a single Run by id, or all Runs, etc...</p>\n\n<p>Now I'd like to use there <code>where(...)</code>-method as well, but I can't imagine a nice solution. For only AND-connected WHERE-statements I simply could use:</p>\n\n<pre><code>http://.../runs.json?id=4&amp;experiment_id=2\n</code></pre>\n\n<p>And the Controller would look like that:</p>\n\n<pre><code>@runs = Run.order(params[:order]).limit(params[:limit]).offset(params[:offset])\nif(params[:id])\n    @runs = @runs.where(id: params[:id])\nend\nif(params[:experiment_id])\n    @runs = @runs.where(experiment_id: params[:experiment_id])\nend\n\nrespond_to |format|\n    ...\nend\n</code></pre>\n\n<p>But I want the client to specify if it wants to request for example: <code>WHERE (id &gt;= 4 AND experiment_id = 3) OR (id != 12 AND experiment_id IS NULL)</code> </p>\n\n<p>First problem is: At the moment I have no idea how this could be easily done using the HTTP parameters. (And the second one: How I can implement this in Rails)</p>\n\n<p>I hope someone already solved my problem ;-)</p>\n\n<p>Thank you!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13234849,"title":"RoR - Time.strptime issues","body":"<p>Here is the method in question. </p>\n\n<pre><code>def published_at_setter\n    self.published_at = Time.strptime(\"#{@date} #{@time}\", \"%m/%d/%Y %I:%M %p\")\n    puts \" ~~~~~~~~~~~~~~~~~~~ #{@date} #{@time} ~~~~~~~~~~~~~~~~ #{self.published_at}\"\nend\n</code></pre>\n\n<p>With @date = \"09/11/2012\" and @time \"01:45 AM\" I get this in the webbrick console. WFT?</p>\n\n<pre><code>~~~~~~~~~~~~~~~~~~~ 09/11/2012 01:45 AM ~~~~~~~~~~~~~~~~ 2012-09-11 06:45:00 UTC\n</code></pre>\n\n<p>When in rails console I get the expected results. \"2012-09-11 01:45:00 -0500\"</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13235986,"title":"Rails - Always have to check exists, and then value?","body":"<p>I am checking to see if a value in a related table exists quite often in my view, in this case, expenses have approvals.  If they have not been submitted, then there is no record of them in the approvals table.  </p>\n\n<p>I am ending up with some really awkward code</p>\n\n<pre><code>&lt;% if !expense_item.expense_approval || expense_item.expense_approval.approval_status == 0 %&gt;\n</code></pre>\n\n<p>Is there a way to do an if statement on a value, without having to check if it exists first?  Or some default way to set it nil?</p>\n"},{"tags":["ruby-on-rails","bundler","rsync"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":303,"score":1,"question_id":8142126,"title":"can bundler be used in rsync deployments?","body":"<p><strong>Can you deploy a Rails3 app using Bundler's Gemfile WITHOUT running <code>bundle install</code>... i.e. just by copying a rails project directory to the appropriate dir within Apache/Passenger?</strong></p>\n\n<p>So, we have a legacy environment that was designed for internal projects during the Ruby1.8.6/Rails2 timeframe and it depends on copying your local rails directory to a network mount under Apache/Passenger. While this deployment model worked fine for Rails2 (with frozen gems, etc.), it breaks in many painful ways for Rails3 with Bundler.</p>\n\n<p>Specifically, I'm seeing gem dependency errors for gems in :test and :development groups even when deploying to :production.  I found the following SO post helpful at first:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/4438601/bundler-incorrectly-trying-to-install-development-and-test-group-gems-in-pro\">bundler incorrectly trying to install &quot;development&quot; and &quot;test&quot; group gems in production</a></li>\n</ul>\n\n<p>So I executed <code>bundle install --without test development</code> on my local and then tried to manually copy .bundle/config from my directory to the network dir, but that didn't work. Bundler still tried to load the excluded gems.</p>\n\n<p>This is painful for us because we don't have admin privileges to install gems on these servers (i.e. we aren't allowed to ever run <code>bundle install</code> in any form).  Likewise, the admins do not want to be bothered with deploying our apps every 5 mins since this is an internal prototyping site and not an external production site.  They also don't want to run <code>bundle install</code> because they want tight control of which gems are deployed across all applications -- for example, some apps are still Rails2 based and don't use Bundler yet, so they may break if the wrong gem is installed.</p>\n\n<p>Is there any way to use Bundler in a passive/rsync way, or should we just redesign our environment to let developers run <code>bundle install</code> via capistrano or some such?</p>\n\n<p>Help?</p>\n\n<p>Thanks!</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong> 1/18/2012: After investigating the reason for the :test and :development group errors some more, I <a href=\"http://www.modrails.com/documentation/Users%20guide%20Apache.html#bundler_support\" rel=\"nofollow\">discovered</a> that Phusion Passenger actually executes <code>Bundle.setup()</code> before the Rails app gets a chance to in <code>boot.rb</code>.  Without any arguments, <code>setup()</code> checks all gem dependencies, which means if it doesn't find a gem on the server, it will blow up in Passenger before it even gets a chance to load Rails.</p>\n\n<p>This particular 'bug' can only happen if you deploy via rsync or copy instead of running <code>bundle install --without test:development</code> on the target server.  The majority of Rails3 apps are deployed with Capistrano, which does this step for you, and as such never encounter this particular edge case.</p>\n\n<p>So I'm afraid the only way to get 'groups' to work correctly in your gem file is to use <code>bundle install</code> as intended.  This means we should change our deployment process!</p>\n"},{"tags":["ruby-on-rails","ruby","ubuntu","shopify"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13233938,"title":"shopify_app syntax error","body":"<p><strong>Edit: Debugging has got me further.  Question clarified.</strong></p>\n\n<p>We have installed Ruby, RubyGems and Rails and have forked the shopify_app project.  We have created a new rails applications and added three items to the Gemfile: <code>execjs</code>, <code>therubyracer</code> and <code>shopify_app</code>.</p>\n\n<p>Running <code>rails s</code> in order to start our rails application returns this trace:</p>\n\n<pre><code>root@ubuntu:/usr/local/pete-shopify/cart# rails s\nFaraday: you may want to install system_timer for reliable timeouts\n/var/lib/gems/1.8/gems/shopify_app-4.1.0/lib/shopify_app.rb:15:in `require': /var/lib    /gems/1.8/gems/shopify_app-4.1.0/lib/shopify_app/login_protection.rb:5: syntax error, unexpected ':', expecting kEND (SyntaxError)\n...rce::UnauthorizedAccess, with: :close_session\n                          ^\nfrom /var/lib/gems/1.8/gems/shopify_app-4.1.0/lib/shopify_app.rb:15\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in `require'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in `require'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `each'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `require'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `each'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `require'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler.rb:128:in `require'\nfrom /usr/local/pete-shopify/cart/config/application.rb:7\nfrom /var/lib/gems/1.8/gems/railties-3.2.8/lib/rails/commands.rb:53:in `require'\nfrom /var/lib/gems/1.8/gems/railties-3.2.8/lib/rails/commands.rb:53\nfrom /var/lib/gems/1.8/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\nfrom /var/lib/gems/1.8/gems/railties-3.2.8/lib/rails/commands.rb:50\nfrom script/rails:6:in `require'\nfrom script/rails:6\n</code></pre>\n\n<p>I haven't modified any files since forking from Github.  Lines 1 - 6 of login_protection.rb are as follows:</p>\n\n<pre><code>module ShopifyApp::LoginProtection\n    extend ActiveSupport::Concern\n\n    included do\n        rescue from ActiveResource::UnauthorizedAccess, with: :close_session\n    end\n</code></pre>\n\n<p>I've looked into this and it <strong>seems</strong> that the error is caused by a new-style hash syntax between Ruby 1.8 and 1.9; <code>key : value</code> instead of <code>key =&gt; value</code>.</p>\n\n<p>Running <code>ruby -v</code> from the command line returns <code>ruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-linux]</code>.  This would seem to be OK... but I did some debugging, and inside the file <code>/var/lib/gems/1.8/gems/shopify_app-4.1.0/lib/shopify_app.rb</code> (at the top) by putting this:</p>\n\n<p>puts RUBY_VERSION\nexit</p>\n\n<p>It printed <code>1.8.7</code>.  **Why are <code>ruby -v</code> and <code>RUBY_VERSION</code> giving me different results?  And am I correct in assuming this is the cause of my problems?</p>\n\n<p>Note: To upgrade Ruby I installed the later version with <code>apt-get</code> and then switched to it by using <code>update-alternatives --config ruby</code> and selecting option 2 like this:</p>\n\n<pre><code>root@ubuntu:/usr/local/pete-shopify/cart# update-alternatives --config ruby\nThere are 2 choices for the alternative ruby (providing /usr/bin/ruby).\n\n  Selection    Path                Priority   Status\n------------------------------------------------------------\n  0            /usr/bin/ruby1.8     50        auto mode\n  1            /usr/bin/ruby1.8     50        manual mode\n* 2            /usr/bin/ruby1.9.1   10        manual mode\n</code></pre>\n\n<p>Also note: We're PHP/Python developers so this is all new to us!</p>\n\n<p><strong>Summary:</strong></p>\n\n<p><strong>1 - Am I right in determining the cause of the syntax error?</strong></p>\n\n<p><strong>2 - Why does <code>RUBY_VERSION</code> and <code>ruby -v</code> give me different results?</strong></p>\n"},{"tags":["jquery","ruby-on-rails","ruby","jquery-ui","jquery-ui-sortable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13204628,"title":"jQuery-UI Sortable Connected-Lists save order and association to rails model","body":"<p>Let's say that I have:\na 'Survey' with many 'Questions' which has many 'Answers'</p>\n\n<p>If I had a 'Survey' that had 2 instances of a 'Question', let's call them: 'Good Question' and 'Bad Question'</p>\n\n<p>'Good Question' has 5 'Answers' and 'Bad Question' has 3 'Answers'</p>\n\n<p>If 'Good Question' and 'Bad Question' were connected sortable lists with this jQuery-UI interaction. <a href=\"http://jqueryui.com/sortable/#connect-lists\" rel=\"nofollow\">http://jqueryui.com/sortable/#connect-lists</a></p>\n\n<p>I know how to display them as 2 sortable lists using the jQuery-UI and I can also drop an 'Answer' from a 'Bad Question' to a 'Good Question'. But how would I save their new sorted positions and their newly sorted association to another 'Question' back to a Rails database?</p>\n\n<p>Railscasts has how to save position for a single sortable lists but not for lists that belong to different associated models.\n<a href=\"http://railscasts.com/episodes/147-sortable-lists-revised\" rel=\"nofollow\">http://railscasts.com/episodes/147-sortable-lists-revised</a></p>\n\n<p>I really appreciate the help here!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I realized that I just need to POST to the Rails controller, an element id of the list that I dropped the 'Answer' into (i.e <code>&lt;ol class = \"connectableSortable\" id = \"Good_Question\"&lt;/ol&gt;</code>) </p>\n\n<p>This is the syntax for how the Railscast does a POST to the Rails Controller to pass an array of object_id's in the sortable order.</p>\n\n<pre><code>jQuery -&gt;\n  $('#faqs').sortable(\n    axis: 'y'\n    update: -&gt;\n      $.post($(this).data('update-url'), $(this).sortable('serialize'))\n  )\n</code></pre>\n\n<p>How would I update this POST to pass the list ID to it, so I can just update the 'Question' foreign key for the 'Answer' to the list 'ID' that it fell into?</p>\n\n<p>This SO answer has a way to retrieve the list ID. <a href=\"http://stackoverflow.com/questions/9584816/jquery-sortable-get-the-item-object-where-the-element-is-dropped\">Jquery Sortable - get the item/object where the element is dropped</a></p>\n\n<p>So now, I really just need to know how to pass an extra parameter back to the rails controller. Any help?</p>\n"},{"tags":["ruby-on-rails","ruby","classloader"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13236083,"title":"Rails class loading skips namespaced class when another class of same name in root namespace is loaded","body":"<p>I have two namespaces, each with its own controller and presenter classes:\n<code>Member::DocumentsController</code>\n<code>Member::DocumentPresenter</code>\n<code>Guest::DocumentsController</code>\n<code>Guest::DocumentPresenter</code></p>\n\n<p>Both presenters inherit from <code>::DocumentPresenter</code>.</p>\n\n<p>Controllers access their respective presenters without namespace specified, e.g.:</p>\n\n<pre><code>class Guest::DocumentsController &lt; ActionController::Base\n    def show\n        DocumentPresenter.new(find_document)\n    end\nend\n</code></pre>\n\n<p>This usually calls presenter within same namespace. However sometimes in development environment I see base ::DocumentPresenter is being used.</p>\n\n<p>I suspect the cause is that base ::DocumentPresenter is already loaded, so Rails class auto-loading doesn't bother to look further. Is this likely the case? Can it happen in production environment too?</p>\n\n<p>I can think of two solutions:</p>\n\n<ul>\n<li>rename base class to DocumentPresenterBase</li>\n<li>explicitly require appropriate presenter files in controller files</li>\n</ul>\n\n<p>Is there a better solution?</p>\n"},{"tags":["ruby-on-rails","relationship"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13210143,"title":"Show author name from another table","body":"<p>I want to show in my posting scaffold the name of the author.\nI have a posts and users table.</p>\n\n<p>The posts table has an author_id row, that is linking to ID from the users table.</p>\n\n<p>My post model:</p>\n\n<pre><code>belongs_to :user\n</code></pre>\n\n<p>And the user model:</p>\n\n<pre><code>  has_many :posts, dependent: :destroy\n</code></pre>\n\n<p>How can i show the author name from the users table in a post?</p>\n\n<pre><code>**Users format**\nID          integer\nname    string\n\n**Posts format**\nID          integer\ntitle   string\ncontent text\nauthor_id   integer\n</code></pre>\n\n<p>This works for the show view:</p>\n\n<pre><code>  def show\n@post = Post.find(params[:id])\n@author = User.where(:id =&gt; @post.author_id).first\n</code></pre>\n\n<p>end</p>\n\n<p>And this for the index view:</p>\n\n<pre><code>  def index\n@posts = Post.all\n@posts.each do |post|\n  @author = User.where(:id =&gt; @post.author_id).first \nend\n</code></pre>\n\n<p>end</p>\n\n<p>But the index view doesn't work!</p>\n"},{"tags":["ruby-on-rails","ruby","wcf","nokogiri"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":11521095,"title":"Nokogiri communication with Microsoft WCF (Binary)?","body":"<p>I am using Ruby (Nokogiri) to talk to a service written in Microsoft WCF.  Recently developers have changed this to use a binary representation instead of plain text. Does Nokogiri support this?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13236003,"title":"Rails: printing an image for each cycle of a loop?","body":"<p>Hi I'm making a cooking recipe app and recipes have \"ratings\" (an integer). I want to make it so that it prints out a star for each 1 rating point (if the rating = 4, then 4 stars would print out). However, my loop is not printing out anything. Can anyone help with how I should loop through it?</p>\n\n<pre><code>&lt;div&gt;\n    &lt;h4&gt;Rating:&lt;/h4&gt;\n    &lt;%= @recipe.rating.times{ |i| image_tag(\"star.jpg\") } %&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","debugging","skip"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":166,"score":3,"question_id":9913010,"title":"Ruby Debug: Skip Rails Code","body":"<p>When stepping through the Ruby Debugger in Rails, how do I only have it stop only at code that I wrote, skipping over all the native Rails code?</p>\n\n<p>(ie skipping all the code that looks like this)</p>\n\n<pre><code>/Users/jon/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.1/lib/active_support/core_ext/module/remove_method.rb:4\nremove_method(method)\n(rdb:1) s\n[76, 85] in /Users/jon/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.1/lib/active_support/core_ext/class/attribute.rb\n   76          def self.#{name}?() !!#{name} end\n   77  \n   78          def self.#{name}=(val)\n   79            singleton_class.class_eval do\n   80              remove_possible_method(:#{name})\n=&gt; 81              define_method(:#{name}) { val }\n   82            end\n   83  \n   84            if singleton_class?\n   85              class_eval do\n/Users/jon/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.1/lib/active_support/core_ext/class/attribute.rb:81\ndefine_method(:#{name}) { val }\n(rdb:1) s\n[79, 88] in /Users/jon/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.1/lib/active_support/core_ext/class/attribute.rb\n   79            singleton_class.class_eval do\n   80              remove_possible_method(:#{name})\n   81              define_method(:#{name}) { val }\n   82            end\n   83  \n=&gt; 84            if singleton_class?\n   85              class_eval do\n   86                remove_possible_method(:#{name})\n   87                def #{name}\n   88                  defined?(@#{name}) ? @#{name} : singleton_class.#{name}\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1289,"score":2,"question_id":3944085,"title":"Rails multi select defaults","body":"<p>I am working on a script that allows for an admin to assign multiple languages to a user.</p>\n\n<p>I have my multi select working like so:</p>\n\n<pre><code>&lt;%= fields_for :users_languages do |u| %&gt;\n        &lt;div class=\"field\"&gt;\n        &lt;%= @lang_list.inspect %&gt;\n            &lt;%= u.label :Assign_Languages %&gt;&lt;br /&gt;\n            &lt;%= select_tag :language_id, options_for_select(Language.all.collect {|lang| [lang.english, lang.id]}),:multiple =&gt; true, :prompt =&gt; 'Select Language' %&gt;\n         &lt;/div&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>But when I go in to edit the user their languages are not showing up as auto selected. How would I go about doing this?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby","jquery-ui"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13234982,"title":"How to properly implement a form that is using the jQuery UI autocomplete widget?","body":"<p>I am using Ruby on Rails 3.2.2 and the <a href=\"https://github.com/rails/jquery-ujs\" rel=\"nofollow\">jquery-rails 2.1.3</a> (including jQuery UI). I am trying to implement a HTML form so to search, select and submit city data by using the <a href=\"http://jqueryui.com/autocomplete\" rel=\"nofollow\">Autocomplete</a> jQuery UI widget.</p>\n\n<p>At this time I am implementing my form with the following \"autocompletable\" field:</p>\n\n<pre><code>&lt;div class=\"ui-widget\"&gt;\n  &lt;label for=\"cities\"&gt;City: &lt;/label&gt;\n  &lt;input id=\"cities\" /&gt;\n&lt;/div&gt;\n\n&lt;script&gt;\n  $jQ(function() {\n    var cache = {};\n    $jQ( \"#cities\" ).autocomplete({\n      autoFocus: true,\n      minLength: 3,\n      source:    function( request, response ) {\n        $jQ.ajax({\n            url:      '&lt;SEARCH_PATH&gt;',\n            data:     { search: request.term },\n            dataType: 'json',\n            success:  function(data) {\n              var cities = new Array();\n\n              $jQ.each(data, function(arrayID, city) {\n                cities.push({ label: city.name, value: city.id })\n              });\n\n              response( cities ); \n            },\n            error:    function () {\n              response([]);\n            }\n        });\n      }\n    });\n  });\n&lt;/script&gt;\n</code></pre>\n\n<p>The above code works as expected for retrieving JSON data and displaying the list of retrieved cities. As you can see, the \"useful part\" of city data is the <code>id</code> of the city since I am using the <code>id</code> value in order to handle internally the submitted data. However, given the \"selectable\" list of cities is displayed, when I use keyboard UP and DOWN arrows in order to select one of those cities then the input field is populated with the city <code>id</code> (not with the city <code>name</code>).</p>\n\n<p>I would like to:</p>\n\n<ul>\n<li><em>display the city <code>name</code> instead of the <code>id</code> in the input field on selecting the city;</em></li>\n<li><em>find a way in order to submit the city <code>id</code> and not the city <code>name</code></em> (even if the city <code>name</code> is the only thing displayed in the front end content).</li>\n</ul>\n\n<p>How could / should I make to properly accomplish that?</p>\n"},{"tags":["ruby-on-rails","ruby","ffmpeg"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13168866,"title":"What's the easiest way to merge video, audio and image files?","body":"<p>We are planning a Wep App for a Hackathon that's happening in about 2 weeks.\nThe app basic functions are:</p>\n\n<ul>\n<li>The users are guided step-by-step to upload a video, audio and image.</li>\n<li>The image is used as a cover for the audio. Making it into a video file.</li>\n<li>The two video files are <strong>merged</strong> thus creating a <strong>single</strong> video from the initial three files.</li>\n</ul>\n\n<p>So, my problem is:</p>\n\n<ol>\n<li>How do you create a video from an audio with an image as \"cover\".</li>\n<li>How do you merge this two videos.</li>\n</ol>\n\n<p>We are thinking of using Heroku for deployment. Is there a way to do it using something like <a href=\"https://github.com/streamio/streamio-ffmpeg\" rel=\"nofollow\">stremio</a>?</p>\n\n<p>What would be the best approach? A VPS running a C++ script? How's the easiest way to do it?</p>\n"},{"tags":["ruby-on-rails","rails-console"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1788,"score":2,"question_id":4881646,"title":"Rails 3 Sandbox Console","body":"<p>In Rails 2 you're able to run </p>\n\n<pre><code>script/console --sandbox\n</code></pre>\n\n<p>so you can play with production data and not accidentally break anything.</p>\n\n<p>I can't seem to find the equivalent command for Rails 3. Does anyone know what it is?</p>\n"},{"tags":["ruby-on-rails","ruby","nginx","capistrano","railscasts"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13235165,"title":"Nginx redirecting to IP","body":"<p>I recently used the Deploying to VPS Railscasts by Ryan Bates for one of my projects. Everything worked like a charm however there is one small issue which is bugging me regarding the nginx configuration. For some reason whenever I enter the staging enviornment domain it shows the right page but gets redirected to an IP instead of showing the domain. </p>\n\n<p>For example if the domain is example.com it gets redirected to xx.xx.xxx.xx which is the IP address of the server. </p>\n\n<p>Can anyone help me resolving this. I have tried several online sources but none of them seems to work. Most of the time I just end up having nginx in infinite loop creating redirects. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","redirect"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":383,"score":3,"question_id":5820901,"title":"Can we follow redirects with Typheous Ruby?","body":"<p>Is it possible to follow redirects with Typhoeus and how?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":10530699,"title":"Formatting posts with the forem gem in rails","body":"<p>I'm having a problem with html formatting using the forem gem. </p>\n\n<p>Inside of _post.html.erb you will find this line: <code>&lt;%= forem_format(post.text) %&gt;</code> </p>\n\n<p>However, when I view a post I see the html in the output.. for example if I input <code>&lt;b&gt; HI &lt;/b&gt;</code> I see that exact line in the output. </p>\n\n<p>I did try installing the RedCloth gem and then put <code>&lt;%= RedCloth.new(post.text).to_html %&gt;</code> This did not produce an error, but unfortunately I still see only <code>&lt;b&gt; HI &lt;/b&gt;</code> in the output. </p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","rake","ruby-on-rails-3.2","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13118905,"title":"500 error page with no information in production.log","body":"<p>I am currently encountering couple of issues with the a rails application deployed on Linode server. The gemfile looks like below :</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngroup :assets do\n    gem 'sass-rails',   '~&gt; 3.2.3'\n    gem 'coffee-rails', '~&gt; 3.2.1'\n    # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n     # gem 'therubyracer', :platforms =&gt; :ruby\n    gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'rails', '3.2.8'\ngem 'mysql2'\ngem 'activeadmin',:git =&gt; \"git@github.com:sadanmasroor/active_admin.git\"\ngem 'jquery-rails'\ngem 'roo'\n\ngroup :production do\n     gem 'unicorn'\nend\n\ngroup :development do \n    gem 'thin'\n    gem 'capistrano'\nend\n</code></pre>\n\n<p>Apparently there were list of issues with ActiveAdmin in the beginning mostly with activeadmin assets which I finally overcame by debugging the issues. Now the problem is that the assets precompile successfully in development and also in production ( Capistrano Assets Precompile Task) however I am getting a 500 error when accessing the index page even. </p>\n\n<p>The weird part is that there is no error in production log. It just shows that the assets precompiled successfully. I have no idea what exactly is causing this issue. I have been trying to figure this thing out for almost three days now. Have tried literally everything I could to resolve it from the ActiveAdmin issues to stackoverflow and everything but no result. If I revert the code to the last stable one and than deploy everything works perfectly. </p>\n\n<p>I would be very thankful to anybody who can point me to the right direction to fix this thing.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","database","heroku","pull"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":291,"score":6,"question_id":12580982,"title":"Unable to fetch tables information when running heroku db:pull","body":"<p>I have an application that uses postgres in development and production. I recently pushed to heroku and everything was working fine. I was able to pull the database from heroku and push back up with no problem. Today however, I tried to pull the DB down from heroku and I received this error</p>\n\n<pre><code>heroku db:pull\n\nLoaded Taps v0.3.24\n    Auto-detected local database: postgres://postgres:a@127.0.0.1/app_development?encoding=utf8\n    Warning: Data in the database 'postgres://postgres:a@127.0.0.1/app_development?encoding=utf8' will be overwritten and will not be recoverable.\n\n     !    WARNING: Destructive Action\n     !    This command will affect the app: app\n     !    To proceed, type \"app\" or re-run this command with --confirm app\n\n    &gt; app\nReceiving schema\nUnable to fetch tables information from http://heroku:osui59a24am79x@taps19.heroku.com. Please check the server log.\n</code></pre>\n\n<p>So I run <code>heroku logs</code> after:</p>\n\n<pre><code>james@james-Vostro-3550:~/Desktop/app$ heroku logs\n2012-09-25T10:08:32+00:00 app[web.1]: Started GET \"/users\" for X.X.X.X at 2012-09-25 10:08:32 +0000\n2012-09-25T10:08:32+00:00 heroku[router]: GET app.herokuapp.com/users? dyno=web.1 queue=0 wait=0ms service=38ms status=200 bytes=10727\n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: Started GET \"/application.css\" for X.X.X.X at 2012-09-25 10:08:32 +0000\n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]: ActionController::RoutingError (No route matches [GET] \"/application.css\"):\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:26:in `call_app'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:16:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/request_id.rb:22:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n2012-09-25T10:08:32+00:00 heroku[router]: GET app.herokuapp.com/application.css dyno=web.1 queue=0 wait=0ms service=6ms status=404 bytes=728\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/static.rb:62:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:479:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/application.rb:220:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `catch'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:80:in `block in pre_process'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:53:in `process'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `pre_process'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:38:in `receive_data'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/backends/base.rb:63:in `start'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/server.rb:159:in `start'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/controllers/controller.rb:86:in `start'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:185:in `run_command'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:151:in `run!'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/bin/thin:6:in `&lt;top (required)&gt;'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `&lt;main&gt;'\n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 heroku[router]: GET app.herokuapp.com/assets/admin-e0756c8b3550bb800d5f58837c42ec80.css dyno=web.1 queue=0 wait=0ms service=7ms status=200 bytes=1941\n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: Started GET \"/assets/admin-e0756c8b3550bb800d5f58837c42ec80.css\" for X.X.X.X at 2012-09-25 10:08:32 +0000\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]: Started GET \"/projects\" for X.X.X.X at 2012-09-25 10:08:41 +0000\n2012-09-25T10:08:41+00:00 heroku[router]: GET app.herokuapp.com/projects dyno=web.1 queue=0 wait=0ms service=31ms status=304 bytes=0\n2012-09-25T10:08:41+00:00 app[web.1]: Started GET \"/application.css\" for X.X.X.X at 2012-09-25 10:08:41 +0000\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n2012-09-25T10:08\n:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/request_id.rb:22:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]: ActionController::RoutingError (No route matches [GET] \"/application.css\"):\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:26:in `call_app'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:16:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/static.rb:62:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/application.rb:220:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/server.rb:159:in `start'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `catch'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:479:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:80:in `block in pre_process'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:53:in `process'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/backends/base.rb:63:in `start'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `pre_process'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:38:in `receive_data'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:151:in `run!'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:185:in `run_command'\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `&lt;main&gt;'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/controllers/controller.rb:86:in `start'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/bin/thin:6:in `&lt;top (required)&gt;'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 heroku[router]: GET app.herokuapp.com/application.css dyno=web.1 queue=0 wait=0ms service=9ms status=404 bytes=728\n2012-09-25T10:11:00+00:00 heroku[run.1]: Awaiting client\n2012-09-25T10:11:00+00:00 heroku[run.1]: Starting process with command `bundle exec rake db:migrate`\n2012-09-25T10:11:00+00:00 heroku[run.1]: State changed from starting to up\n2012-09-25T10:11:06+00:00 heroku[run.1]: Client connection closed. Sending SIGHUP to all processes\n2012-09-25T10:11:07+00:00 heroku[run.1]: Process exited with status 1\n2012-09-25T10:11:07+00:00 heroku[run.1]: State changed from up to complete\n2012-09-25T10:08:23+00:00 heroku[web.1]: State changed from starting to up\n2012-09-25T10:08:01+00:00 heroku[web.1]: Unidling\n2012-09-25T10:08:01+00:00 heroku[web.1]: State changed from down to starting\n</code></pre>\n\n<p>I have no idea where to look for a solution, so hopefully someone can help. I've just started learning rails so please remember this when trying to help.</p>\n\n<p>Thanks in advance.</p>\n\n<p>EDIT:</p>\n\n<p>I have tried all sorts: \nreinstalling heroku, taps.\nremade my app and pushing to heroku.\nreinstalled postgres.</p>\n\n<p>Nothing seems to work. Driving me mad!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13234557,"title":"Rails database attributes and time zones","body":"<p>The project I'm currently working on requires me to ignore the time zone for certain database attributes. I've set the Rails application time zone to UTC and each user has their time zone set for each request which is exactly what is required for most attributes.</p>\n\n<p>However, for some attributes I don't want the time zone adjustment before saving in the database. I'm trying to save shifts. A 9am to 5pm shift is still a 9am to 5pm shift no matter where you are located.</p>\n\n<p>Here's an example (my time zone is EST-5):</p>\n\n<p>When I enter a 9am shift, the following gets saved to the database, adjusted for my time zone:\n2012-11-04T14:00:00+00:00</p>\n\n<p>What I'd like to save is this:\n2012-11-04T09:00:00+00:00</p>\n\n<p>I'd also like to pull it out of the database without the time zone adjustment.</p>\n\n<p>The automatic time zone adjustments are fine for fields like created_at, updated_at, published_at, etc. but not shifts which should show the same time no matter what time zone you are in.</p>\n\n<p>What would be the best way to implement this functionality?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","view","routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13234407,"title":"\"Missing Template\" when manually creating views","body":"<p>I create controller in controllers/admin/orders.rb</p>\n\n<pre><code>def index\n    @pre_orders = Order.all\n    @orders = Kaminari.paginate_array(@pre_orders).page(params[:page]).per(20)\n\n  end\n</code></pre>\n\n<p>I have such route:</p>\n\n<pre><code>namespace :admin do\n    # Directs /admin/products/* to Admin::ProductsController\n    # (app/controllers/admin/products_controller.rb)\n    resources :orders\n  end\n</code></pre>\n\n<p>And view in views/admin/orders/index.html.haml</p>\n\n<p>But when i go to ....3000/admin/orders i get\nTemplate is missing</p>\n\n<pre><code>Missing template admin/orders/index, application/index with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee, :haml]}. Searched in: * \"/*******/app/views\" * \"/home/pavel/.rvm/gems/ruby-1.9.3-p194/gems/kaminari-0.14.1/app/views\" * \"/home/pavel/.rvm/gems/ruby-1.9.3-p194/gems/devise-2.1.2/app/views\"\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13231412,"title":"Error on install gem factory_girl and ruby version","body":"<p>I try to install <a href=\"http://www.skylinecms.nl/documentation/guides/getting_started\" rel=\"nofollow\">skylinecms</a> but I have a problem with installing the gem.<br>\nThe gem <a href=\"https://github.com/thoughtbot/factory_girl\" rel=\"nofollow\">factory_girl</a> asked me to use version> = 1.9.2  of Ruby</p>\n\n<pre><code>atmoner@atmoner:~/base_ror$ sudo gem install skylinecms\nERROR:  Error installing skylinecms:\n    factory_girl requires Ruby version &gt;= 1.9.2.\n</code></pre>\n\n<p>ruby -v</p>\n\n<pre><code>atmoner@atmoner:~/base_ror$ ruby -v\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\n</code></pre>\n\n<p>I have tried to change ruby version to 1.9.2</p>\n\n<pre><code>atmoner@atmoner:~/base_ror$ rvm use 1.9.2\nUsing /home/atmoner/.rvm/gems/ruby-1.9.2-p320\n</code></pre>\n\n<p>But still same problem</p>\n\n<pre><code>atmoner@atmoner:~/base_ror$ sudo gem install skylinecms\nERROR:  Error installing skylinecms:\n    factory_girl requires Ruby version &gt;= 1.9.2.\n</code></pre>\n\n<p>what's the source of this problem?<br>\nyou have an idea?</p>\n"},{"tags":["ruby-on-rails","ruby","regex","validation","url"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":2681,"score":7,"question_id":7167895,"title":"What's a good way to validate links (urls) in rails 3?","body":"<p>I was wondering how I would best validate urls or links in rails 3. I was thinking of using a regular expression, but am not sure if this is the best practice.</p>\n\n<p>And, if I were to use a regex, could someone suggest one to me? I am still new to regex.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","rdoc","ruby-enterprise-edition"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":310,"score":1,"question_id":5153272,"title":"Generating RDoc fails with Directory .ext/rdoc already exists","body":"<p>I'm just installing Ruby Enterprise and cannot change the output directory for this crashing command called by Ruby Enterprise installer.</p>\n\n<p>So how do I delete the directory to satisfy this exception:</p>\n\n<p>Generating RDoc documentation\n./miniruby -I./lib -I.ext/common -I./- -r./ext/purelib.rb  ./runruby.rb --extout=.ext  -- \"./bin/rdoc\" --all --ri --op \".ext/rdoc\" \".\"</p>\n\n<p>Directory .ext/rdoc already exists, but it looks like it\nisn't an RDoc directory. Because RDoc doesn't want to risk\ndestroying any of your existing files, you'll need to\nspecify a different output directory name (using the\n--op  option).</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","hook"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13233661,"title":"Is it okay to have a method in the before block of a series of RSpec unit tests?","body":"<p>I have a pretty elaborate set-up to change the condition from passing to failing for four composing methods of a method called eligible?.</p>\n\n<pre><code>describe \"#participant_age_eligible?\" do\n        it \"returns whether participant is age-eligible\" do\n          @part.participant_age_eligible?(@pers).should == true\n        end\n\n        it \"returns false if participant is not age eligible\" do\n          q = @survey_section.questions.select { |q| q.data_export_identifier ==\n                                                 \"#{OperationalDataExtractor::PbsEligibilityScreener::\n                                                    INTERVIEW_PREFIX}.AGE_ELIG\" }.first\n          answer = q.answers.select { |a| a.response_class == \"answer\" &amp;&amp; a.reference_identifier == \"2\" }.first\n          Factory(:response, :survey_section_id =&gt; @survey_section.id, :question_id =&gt; q.id, :answer_id =&gt; answer.id, :response_set_id =&gt; @response_set.id)\n          @part.participant_age_eligible?(@pers).should == false\n        end\n      end\n\n      describe \"#participant_psu_county_eligible?\" do\n        it \"returns whether participant lives in eligible PSU\" do\n          @part.participant_psu_county_eligible?(@pers).should == true\n        end\n\n        it \"returns false if participant coes not live in an eligible PSU\" do\n          q = @survey_section.questions.select { |q| q.data_export_identifier ==\n                                                 \"#{OperationalDataExtractor::PbsEligibilityScreener::\n                                                    INTERVIEW_PREFIX}.PSU_ELIG_CONFIRM\" }.first\n          answer = q.answers.select { |a| a.response_class == \"answer\" &amp;&amp; a.reference_identifier == \"2\" }.first\n          Factory(:response, :survey_section_id =&gt; @survey_section.id, :question_id =&gt; q.id, :answer_id =&gt; answer.id, :response_set_id =&gt; @response_set.id)\n          @part.participant_psu_county_eligible?(@pers).should == false\n        end\n      end\n</code></pre>\n\n<p>There are two more methods just like those two. What I'd like to do is extract the</p>\n\n<pre><code> q = @survey_section.questions.select { |q| q.data_export_identifier ==\n                                                     \"#{OperationalDataExtractor::PbsEligibilityScreener::\n                                                        INTERVIEW_PREFIX}.AGE_ELIG\" }.first\n              answer = q.answers.select { |a| a.response_class == \"answer\" &amp;&amp; a.reference_identifier == \"2\" }.first\n              Factory(:response, :survey_section_id =&gt; @survey_section.id, :question_id =&gt; q.id, :answer_id =&gt; answer.id, :response_set_id =&gt; @response_set.id) \n</code></pre>\n\n<p>portion into a method in the before block and then pass the relevant parameters, but I hesitiate because I have never seen someone define a method in a before block, not even sure you can do it, further, I'm not sure if you even should do it even if you can, maybe it's pointing to a problem that I'm not seeing. So I though I'd ask the unfathomably enormous expertise of the SO community. Thanks.</p>\n"},{"tags":["ruby-on-rails","page-load-time"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13190593,"title":"Measure the perceived load time (rather than actual load time)","body":"<p>I am running a <a href=\"http://www.presenttips.com\" rel=\"nofollow\">website</a> where I have had problems with it being really slow. I believe I have made it quite speedy now with usage of caches etc. </p>\n\n<p>When I click through the website myself it feels quite fast (please, try for yourself) but according to New Relic (host the website on Heroku) I have load times up to 30 sec and an average of 9 sec.</p>\n\n<p>I have used tools like <a href=\"http://tools.pingdom.com\" rel=\"nofollow\">tools.pingdom.com</a> to test it and it typically (depending on the load) gives a number of between 3-9 seconds (9 sec being the most common). </p>\n\n<p>According to the stats at tools.pingdom.com it seems like a few external images, scripts etc are slow to load and that brings the load time stats down. That could also explain why the website actually feels fast for me. If the website is 95% loaded after 3 sec and one product image takes additional 6 secs to load, it does not really affect the user experience, in my opinion.</p>\n\n<p>If that is the case, how can I check the perceived load time? Does the website feel slow to you?</p>\n"},{"tags":["ruby-on-rails","model","controller","associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13233625,"title":"How to get name of model linked from another model in Rails?","body":"<p>I have set up 2 models in Rails:</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_many :platforms\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Platform &lt; ActiveRecord::Base\n    attr_accessible :name, :url, :country\n    validates :name, :presence =&gt; true, :length =&gt; { :minimum =&gt; 5 }\n    validates :url, :presence =&gt; true, :length =&gt; { :minimum =&gt; 5 }\n    belongs_to  :categories\nend\n</code></pre>\n\n<p>This is my platform controller :</p>\n\n<pre><code>class PlatformsController &lt; ApplicationController\n  # GET /platforms\n  # GET /platforms.json\n  def index\n    @platforms = Platform.all\n    @categories = Category.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @platforms }\n    end\n  end\n\n  # GET /platforms/1\n  # GET /platforms/1.json\n  def show\n    @platform = Platform.find(params[:id])\n    @categories = Platform.categories\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @platform }\n    end\n  end\n\n  # GET /platforms/new\n  # GET /platforms/new.json\n  def new\n    @platform = Platform.new\n    @categories = Category.all\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @platform }\n    end\n  end\n\n  # GET /platforms/1/edit\n  def edit\n    @platform = Platform.find(params[:id])\n    @categories = Category.find(:all)\n  end\n\n  # POST /platforms\n  # POST /platforms.json\n  def create\n    @platform = Platform.new(params[:platform])\n    #@categories = Category.new(params[:name])\n    @categories = @platform.categories.create(params[:categories])\n\n    respond_to do |format|\n      if @platform.save\n        format.html { redirect_to @platform, notice: 'Platform was successfully created.' }\n        format.json { render json: @platform, status: :created, location: @platform }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @platform.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /platforms/1\n  # PUT /platforms/1.json\n  def update\n    @platform = Platform.find(params[:id])\n    @categories = Category.find(:all)\n\n    respond_to do |format|\n      if @platform.update_attributes(params[:platform])\n        format.html { redirect_to @platform, notice: 'Platform was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @platform.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /platforms/1\n  # DELETE /platforms/1.json\n  def destroy\n    @platform = Platform.find(params[:id])\n    @platform.destroy\n\n    respond_to do |format|\n      format.html { redirect_to platforms_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>I do not understand what I do wrong, but it doesnt correctly assign categories to platforms, and also in the platforms index view, when I try to use : </p>\n\n<pre><code>&lt;%= platform.categories  %&gt;\n</code></pre>\n\n<p>it gives me error cannot find Category with id= \"and here the respective id\"</p>\n\n<p>I am really confused since I followed tutorial for this one.</p>\n\n<p>I use Rails 3.2.8</p>\n"},{"tags":["ruby-on-rails","activemodel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13233459,"title":"Rails find_by_email multiple tables","body":"<p>I am working on a rails application and i have 3 different user types. These users are potentially very different, so i created models for each of them. Now, they should be able to login thru a single form. So basically i want to say something like 'find_by_email(\"some_email\")', but search over all three tables. It seems, though, that Rails expect you to call 'find_by' with a specific model, like Admin.find_by(). Any suggestions? </p>\n"},{"tags":["html","css","ruby-on-rails","styling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13233370,"title":"How to replace cycle('float: left', 'float: right') to use pure css?","body":"<p>Is there any way to replace <code>cycle('float: left', 'float: right')</code> so that instead of using <code>cycle</code> helper i could use pure css classes. I need to align divs left and right inside a single column. Using cycle leads to some difficulties with caching so it would be better to use static styling instead.</p>\n\n<pre><code>&lt;div class=\"userCards\"&gt;\n    &lt;div class=\"singleCard &lt;%= cycle 'cardLeft', 'cardRight' %&gt;\"&gt;\n        &lt;!-- content --&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Note that <code>userCard</code> has fixed height, <code>overflow: hidden</code>  and <code>width: 48%</code>.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","recurly"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13231115,"title":"Rails and Recurly credit card form not updating expiration month and year info","body":"<p>I was creating a form to interact with Recurly on Rails.</p>\n\n<p>I have this view and this form:</p>\n\n<pre><code>&lt;h1&gt;&lt;%= t('payments.edit') %&gt; &lt;/h1&gt;\n\n\n&lt;%= render(:partial =&gt; 'shared/new_recurly_form', :locals =&gt; {:success_url =&gt; \"#{APP_URL}#{users_credit_card_path}\"}) %&gt;\n\n&lt;%= semantic_form_for current_user, :url =&gt; users_credit_card_path, :html =&gt; {:method =&gt; :put, :class =&gt; 'credit_card'} do |form| %&gt;\n\n    &lt;%= form.inputs do %&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= form.label :name %&gt;\n        &lt;%= form.text_field :name %&gt;\n      &lt;/div&gt;  \n      &lt;div class=\"field\"&gt;\n        &lt;%= form.label :first_surname %&gt;\n        &lt;%= form.text_field :surnames %&gt;\n      &lt;/div&gt;  \n      &lt;div class=\"field\"&gt;\n          &lt;%= label_tag :number, \"Credit Card Number \" %&gt;\n          &lt;%= text_field_tag :number %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n          &lt;%= label_tag :verification_value, \"Security Code on Card (CVV)\" %&gt;\n          &lt;%= text_field_tag :verification_value %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :month, \"Expiration month\" %&gt;\n      &lt;%= select_month(Date.today, :use_month_numbers =&gt; true) %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :year, \"Expiration year\" %&gt;\n      &lt;%= select_year(Date.today, :start_year =&gt; Time.now.year, :end_year =&gt; Time.now.year + 20) %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n  &lt;%= form.buttons do %&gt;\n    &lt;%= form.commit_button  t('confirm') %&gt;\n  &lt;% end %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>and its respective controller, credit_card_controller.rb</p>\n\n<pre><code>class Users::CreditCardsController &lt; ApplicationController\n\n  skip_before_filter :check_deactivated_user\n  protect_from_forgery :except =&gt; :create\n\n  def create\n    update\n  end\n\n  def edit\n    @user = current_user\n    @price_plan = current_user.price_plans.active.first\n  end\n\n  def update\n    begin\n        update_new_recurly_subscription\n    rescue Exceptions::RecurlyAccountCreateInvalidAccountException =&gt; e\n        puts \"CreditCardsController Exceptions::RecurlyAccountCreateInvalidAccountException\"\n        puts e.message\n    rescue Recurly::Resource::NotFound =&gt; e\n        puts \"CreditCardsController Recurly::Resource::NotFound Creating new account for user\"  \n        puts e.message  \n        begin\n            create_new_recurly_account\n            create_new_recurly_subscription         \n        rescue Exceptions::RecurlyAccountCreateInvalidAccountException =&gt; e\n            puts \"CreditCardsController inside find Recurly::Resource::NotFound\"\n            puts e.message\n            update_new_recurly_account\n            create_new_recurly_subscription\n        end \n    end\n\n    account = update_account_billing_info\n    account.billing_info = {\n        :first_name         =&gt; current_user.name,\n        :last_name          =&gt; \"#{current_user.surnames}\",\n        :number             =&gt; params[:number],\n        :verification_value =&gt; params[:verification_value],\n        :month              =&gt; params[:month],\n        :year               =&gt; params[:year]\n    }\n    puts \"Users::CreditCardsController update Billing info: #{account.billing_info.inspect}\"\n    account.billing_info.save\n    if current_user.credit_card_store!(account.billing_info)\n      if current_user.is_debtor?\n        flash[:alert] = t('flash.price_plans.payed_after_unpay')\n        render :edit\n      else\n        flash[:alert] = t('flash.credit_card.update.success')\n        render :success\n      end\n\n    else\n      flash[:failure] = t('flash.credit_card.update.failure')\n      render :edit\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>When I update the form, using the update function on the former controller, I am able to change the credit card number but I am not able to change the expiration month and the expiration year.</p>\n\n<p>What am I missing here? Why can I change the credit card number and not the month and the year interacting with Recurly?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13231357,"title":"Rails 3.2: multiple nested data from one model","body":"<p>How to create form and action for multiple nested attributes if:</p>\n\n<p>LineItem:</p>\n\n<pre><code>has_many :item_options, :dependent =&gt; :destroy\nhas_many :product_options, :through =&gt; :item_options\n</code></pre>\n\n<p>ProductOption:</p>\n\n<pre><code>belongs_to :product\nbelongs_to :option\nhas_many :item_options\nhas_many :line_items, :through =&gt; :item_options\n</code></pre>\n\n<p>ItemOption:</p>\n\n<pre><code>attr_accessible :line_item_id, :product_option_id  \nbelongs_to :line_item, :foreign_key =&gt; \"line_item_id\"\nbelongs_to :product_option,:foreign_key =&gt; \"product_option_id\"\n</code></pre>\n\n<p>When I'm creating new LineItem, I need to create new ItemOption(s). This is my form:</p>\n\n<pre><code>        &lt;%= form_for(LineItem.new) do |f| %&gt;\n        &lt;%= f.hidden_field :product_id, value: @product.id %&gt;\n        &lt;%= f.fields_for :item_options do |io| %&gt;\n            &lt;% @product.options.uniq.each do |o| %&gt;\n              &lt;%= o.name %&gt;: \n              &lt;%= io.collection_select :product_option_id, o.product_options.where(:product_id =&gt; @product.id), :id, :value %&gt;\n            &lt;% end %&gt;\n        &lt;%= f.submit %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>When I'm clicking on Add To Cart, I've get:</p>\n\n<p>ItemOption(#70296453751440) expected, got Array(#70296430421140)</p>\n\n<p>When Adding accepts_nested_attributes_for :item_options to LineItem, my selects not diplayed :(</p>\n\n<p>With </p>\n\n<pre><code>&lt;%= select_tag \"product_option_id\", options_from_collection_for_select(o.product_options.where(:product_id =&gt; @product.id), :id, :value) %&gt;\n#item_options not created:\nParameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"/WM5/MqPn1yCxjKWoJQmjfko2pR4RiYV0S2KeTTpA3w=\", \"line_item\"=&gt;{\"product_id\"=&gt;\"1\"}, \"product_option_id\"=&gt;\"5\", \"commit\"=&gt;\"add\"}\n</code></pre>\n\n<p>And last one, I've create action like this:</p>\n\n<pre><code>@line_item = LineItem.new(params[:line_item])\n@line_item.item_options.build \n....\n</code></pre>\n\n<p>Where am I wrong? :( I'm totally confused.\nps. similar question <a href=\"http://stackoverflow.com/questions/11199572/rails-3-2-has-many-through-form-submission\">Rails 3.2 has_many through form submission</a>\nThis is form:</p>\n\n<p><img src=\"http://habrastorage.org/storage2/117/b0b/c59/117b0bc59368fa5177efebce896c8670.png\"/></p>\n"},{"tags":["ruby-on-rails","postgresql","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13223870,"title":"ActiveRecord::StatementInvalid: PG::Error: ERROR: cannot execute UPDATE in a read-only transaction error in Heroku","body":"<p>I created a new database on Heroku using a follower. After it was 0 commits behind I unfollow the master db and promote it as default. </p>\n\n<p>Seems to be working fine but looks to be read only. When I try to seve a record from the console now I see this error</p>\n\n<pre><code>ActiveRecord::StatementInvalid: PG::Error: ERROR:  cannot execute UPDATE in a read-only transaction\n</code></pre>\n\n<p>Any idea how to solve this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13232568,"title":"Rails form not using explicit action","body":"<p>I'm a noob that's been struggling with this problem for longer than I care to admit.  I used to have a routing issue with my STI model, but now I think that's solved (thanks to SO).  </p>\n\n<p>My problem is once I update the form at : /kids/1/edit, instead of having the record saved, it seems to get the record again.  I know I'm missing something basic, yet after working the issue a long time the answer eludes me.  You can see I'm explicitly calling the kidupdate action with the form submission.</p>\n\n<p>thanks in advance.</p>\n\n<p>kidedit.html.erb</p>\n\n<pre><code>&lt;% provide(:title, \"Edit user\") %&gt; \n&lt;h1&gt;Update your profile&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span5 offset3\"&gt; \n    &lt;%= form_for(@kid, url: kidedit_path) do |f| %&gt;\n      &lt;#%= render 'shared/error_messages', object: f.object %&gt; \n\n      &lt;%= f.label :fname, \"First Name\" %&gt;\n      &lt;%= f.text_field :fname %&gt; \n\n      &lt;%= f.label :lname, \"Last Name\" %&gt;\n      &lt;%= f.text_field :lname %&gt; \n\n      &lt;%= f.label :email %&gt;\n      &lt;%= f.text_field :email %&gt; \n\n      &lt;%= f.label :type, \"Are you a Kid or Parent\" %&gt;\n      &lt;%= f.select :type, [['Kid','Kid'],['Parent','Parent']] %&gt;\n\n      &lt;%= f.label :password %&gt;\n      &lt;%= f.password_field :password %&gt;\n\n      &lt;%= f.label :password_confirmation, \"Confirmation\" %&gt;\n      &lt;%= f.password_field :password_confirmation %&gt;\n\n      &lt;%= f.submit \"Save changes\", class: \"btn btn-large btn-primary\", :controller =&gt; 'users', :action =&gt; 'kidupdate' %&gt;\n  &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>users_controller.rb</p>\n\n<pre><code>  def kidupdate\n\n    @kid = Kid.find(params[:id])\n    if @kid.update_attributes(params[:kid])\n      flash[:success] = \"Profile updated\"\n      sign_in @kid\n      redirect_to kidshow_path\n    else\n      render kidedit_path(@kid)\n    end\n  end\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Kidtunes::Application.routes.draw do\n\n  root to: 'static_pages#home'\n\n  match '/help',    to: 'static_pages#help'\n  match '/contact', to: 'static_pages#contact'\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new'\n  match '/signout',  to: 'sessions#destroy', via: :delete\n\n  match 'kids/:id' =&gt; 'users#kidupdate', via: :put, :as =&gt; :kidupdate\n  match 'kids/:id' =&gt; 'users#kidshow', via: :get, :as =&gt; :kidshow\n  match 'kids/:id/edit' =&gt; 'users#kidedit', :as =&gt; :kidedit\n\n  resources :users\n  resources :sessions, only: [:new, :create, :destroy]\n</code></pre>\n\n<p>Here's what's in the server log:</p>\n\n<pre><code>Started PUT \"/kids/1/edit\" for 127.0.0.1 at 2012-11-05 07:52:28 -0500\nProcessing by UsersController#kidedit as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"T8RqFt9lxdbZU+1cOh2E5yu2CFbVRDGmRcj2XdDN1ZU=\", \"user\"=&gt;{\"fname\"=&gt;\"Dante\", \"lname\"=&gt;\"Refford\", \"email\"=&gt;\"drefford@example.com\", \"type\"=&gt;\"Kid\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Save changes\", \"id\"=&gt;\"1\"}\n  Kid Load (0.2ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"type\" IN ('Kid') AND \"users\".\"id\" = ? LIMIT 1  [[\"id\", \"1\"]]\n  Rendered users/kidedit.html.erb within layouts/application (4.1ms)\n  Rendered layouts/_shim.html.erb (0.0ms)\n  User Load (0.2ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"remember_token\" = '1RZr3qfB6QSh42_jQ9qNWQ' LIMIT 1\n  Rendered layouts/_header.html.erb (2.5ms)\n  Rendered layouts/_footer.html.erb (0.3ms)\nCompleted 200 OK in 67ms (Views: 46.3ms | ActiveRecord: 1.0ms)\n</code></pre>\n\n<p>Routes</p>\n\n<pre><code>$rake routes\n       root        /                         static_pages#home\n       help        /help(.:format)           static_pages#help\n    contact        /contact(.:format)        static_pages#contact\n     signup        /signup(.:format)         users#new\n     signin        /signin(.:format)         sessions#new\n    signout DELETE /signout(.:format)        sessions#destroy\n  kidupdate PUT    /kids/:id(.:format)       users#kidupdate\n    kidshow GET    /kids/:id(.:format)       users#kidshow\n    kidedit        /kids/:id/edit(.:format)  users#kidedit\n      users GET    /users(.:format)          users#index\n            POST   /users(.:format)          users#create\n   new_user GET    /users/new(.:format)      users#new\n  edit_user GET    /users/:id/edit(.:format) users#edit\n       user GET    /users/:id(.:format)      users#show\n            PUT    /users/:id(.:format)      users#update\n            DELETE /users/:id(.:format)      users#destroy\n   sessions POST   /sessions(.:format)       sessions#create\nnew_session GET    /sessions/new(.:format)   sessions#new\n    session DELETE /sessions/:id(.:format)   sessions#destroy\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2","activeadmin","strong-parameters"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13091011,"title":"How to get ActiveAdmin to work with Strong Parameters?","body":"<p>When the strong_parameters 0.1.4 is used with ActiveAdmin 0.5.0 in Rails 3.2.8, if the model you are using is using StrongParameters by including:</p>\n\n<pre><code>include ::ActiveModel::ForbiddenAttributesProtection\n</code></pre>\n\n<p>then you get the following error in the log if you try to create/edit a record:</p>\n\n<pre><code>ActiveModel::ForbiddenAttributes (ActiveModel::ForbiddenAttributes)\n</code></pre>\n"},{"tags":["ruby-on-rails","client-side-validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13233079,"title":"client side validation for multi level nested field_for did not generate validation attribute","body":"<p>Code:</p>\n\n<p>Customer form:</p>\n\n<pre><code>&lt;%= customer_form.fields_for :person do |f| %&gt;\n    &lt;div class=\"field\"&gt;\n     &lt;%= f.label :firstname %&gt;\n     &lt;%= f.text_field :firstname %&gt;\n   &lt;/div&gt;\n   ....\n   &lt;%= render \"address_fields\", :person_form =&gt; f %&gt;\n</code></pre>\n\n<p>and ....</p>\n\n<p>Person partial view:</p>\n\n<pre><code>&lt;% @customer.person.addresses.each_with_index do |address, index| %&gt;\n    &lt;%= person_form.fields_for :addresses, address, :validate =&gt; true do |f| %&gt;\n        &lt;div id=\"pane&lt;%= index + 2 %&gt;\" class=\"tab-pane\"&gt;\n          &lt;div class=\"field\"&gt;\n            &lt;%= f.label :category %&gt;\n            &lt;%= f.select :category, address_categories_options, {:include_blank =&gt; true} %&gt;\n          &lt;/div&gt;\n</code></pre>\n\n<p>and ....</p>\n\n<pre><code>class Customer &lt; ActiveRecord::Base\n    belongs_to :person\n....\nend\n\nclass Person &lt; ActiveRecord::Base\n\n  has_one :customer\n  has_many :addresses, :dependent =&gt; :destroy\n....\nend\n\nclass Address &lt; ActiveRecord::Base\n  belongs_to :person\n....\nend\n</code></pre>\n\n<p>More details can be found on <a href=\"https://github.com/bcardarella/client_side_validations/issues/423\" rel=\"nofollow\">https://github.com/bcardarella/client_side_validations/issues/423</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2","rails-i18n"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":13219204,"title":"rails-i18n date_select error","body":"<p>In my view I have:</p>\n\n<p><code>&lt;%= f.date_select :start %&gt;</code></p>\n\n<p>and I get the error message: <code>can't convert Symbol into String</code></p>\n\n<p>I know that it's related to <code>it.date.order</code> rule, but I see that <code>rails-i18n</code> include it:\n<a href=\"https://github.com/svenfuchs/rails-i18n/blob/master/rails/locale/it.yml#L51\" rel=\"nofollow\">https://github.com/svenfuchs/rails-i18n/blob/master/rails/locale/it.yml#L51</a></p>\n\n<p>what's wrong here?</p>\n\n<p>full back trace: <a href=\"https://gist.github.com/4007557\" rel=\"nofollow\">https://gist.github.com/4007557</a></p>\n\n<p>EDIT: running <code>I18n.t 'date.order'</code> in the console give me <code>=&gt; [:day, :month, :year]</code>. That it's correct... so why <code>date_select</code> doesn't works?</p>\n\n<p>issue on GitHub repo: <a href=\"https://github.com/svenfuchs/rails-i18n/issues/273\" rel=\"nofollow\">https://github.com/svenfuchs/rails-i18n/issues/273</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13232001,"title":"how to modify devise to login user from terminal using different json?","body":"<p>I use  </p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/login.json  -d \"{\"user\" : { \"email\" : \"sample@gmail.com\", \"password\" : \"password\"}}\"\n</code></pre>\n\n<p>which gives the <code>token</code> and <code>email</code> id as output, but how can i get the same thing with</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/login.json  -d \"{ \"email\" : \"sample@gmail.com\", \"password\" : \"password\"}\"\n</code></pre>\n\n<p>how can i modify devise to get this working?</p>\n"},{"tags":["ruby-on-rails","activerecord","foreign-keys","belongs-to"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13232750,"title":"Rails 2.3.14 ActiveRecord::Base.create! doens't set foreign key anymore?","body":"<p>OK, so I have seen many questions that look like mine, but none have explained the problem I seem to have.</p>\n\n<p>I'm probably missing something here, so I'd love more experienced Rails developers to enlighten me :)</p>\n\n<p>I have two models: </p>\n\n<p><code>Object</code>:</p>\n\n<pre><code>class Object &lt; ActiveRecord::Base\n  belongs_to :owner, :class_name =&gt; \"User\"\n\n  ...\nend\n</code></pre>\n\n<p>and <code>User</code>:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :objects, :foreign_key =&gt; \"owner_id\"\n\n  ...\nend\n</code></pre>\n\n<p>On the <code>Object</code> model I have a class method to create a new object for a specific user with a hash of options/attributes. The creation boils down to this:</p>\n\n<pre><code>def self.from_hash(user, hash)\n  object = create!(:owner =&gt; user, ...)\n  # Do something with object then return it...\nend\n</code></pre>\n\n<p>This has <em>always</em> worked correctly before. Now I've made many changes to my project, including an upgrade to Rails 2.3.14 (from 2.3.12).</p>\n\n<p>This specific code hasn't changed, but it doesn't work anymore: the <code>owner_id</code> attribute is not set to <code>user.id</code> on the <code>create!</code>call.\nI do not understand why, and this is my question: <strong>why?</strong></p>\n\n<p>Please note that I have found a solution to this, by simply doing:</p>\n\n<pre><code>def self.from_hash(user, hash)\n  object = user.objects.create!(...)\n  # Do something with object then return it...\nend\n</code></pre>\n\n<p>This will set <code>object.owner_id</code> correctly.</p>\n\n<p>So I'm quite happy to change my code to this, which looks more like the Rails way to do it anyway, but once again: why do I have to do this now?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","nginx","gitlab"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13232528,"title":"How to configure nginx to serve gitlabhq on a SubURI","body":"<p>The nginx configuration for gitlab is:</p>\n\n<pre><code># GITLAB\n# Maintainer: @randx\n# App Version: 3.0\n\nupstream gitlab {\n  server unix:/home/gitlab/gitlab/tmp/sockets/gitlab.socket;\n}\n\nserver {\n  listen YOUR_SERVER_IP:80;         # e.g., listen 192.168.1.1:80;\n  server_name YOUR_SERVER_FQDN;     # e.g., server_name source.example.com;\n  root /home/gitlab/gitlab/public;\n\n  # individual nginx logs for this gitlab vhost\n  access_log  /var/log/nginx/gitlab_access.log;\n  error_log   /var/log/nginx/gitlab_error.log;\n\n  location / {\n    # serve static files from defined root folder;.\n    # @gitlab is a named location for the upstream fallback, see below\n    try_files $uri $uri/index.html $uri.html @gitlab;\n  }\n\n  # if a file, which is not found in the root folder is requested,\n  # then the proxy pass the request to the upsteam (gitlab unicorn)\n  location @gitlab {\n    proxy_read_timeout 300; # https://github.com/gitlabhq/gitlabhq/issues/694\n    proxy_connect_timeout 300; # https://github.com/gitlabhq/gitlabhq/issues/694\n    proxy_redirect     off;\n\n    proxy_set_header   X-Forwarded-Proto $scheme;\n    proxy_set_header   Host              $http_host;\n    proxy_set_header   X-Real-IP         $remote_addr;\n\n    proxy_pass http://gitlab;\n  }\n}\n</code></pre>\n\n<p>What should i change to serve gitlab as a surURI, www.mysuperserver.com/gitlab</p>\n\n<p>i've tried many different things, but nothing worked\nthanks</p>\n"},{"tags":["ruby-on-rails","ruby","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13232439,"title":"Validates Uniqueness getting called when field hasn't changed?","body":"<p>Does <code>validates :uniqueness</code> get called every time an object is saved even if a field has not changed? Isn't this a performance issue?</p>\n\n<pre><code>validates :name, :schedule_id, :uniqueness =&gt; true\n</code></pre>\n\n<p>It seems to be the case that it does. So isn't it almost always necessary to make sure a change has taken place before running the validation? As every field being checked for uniqueness requires a database hit.</p>\n\n<p>This would be better:</p>\n\n<pre><code>validates :name, :schedule_id, :uniqueness =&gt; true, :if =&gt; \"name_changed? || schedule_id_changed?\"\n</code></pre>\n\n<p>And this much better, if a bit more verbose:</p>\n\n<pre><code>validates :name, :uniqueness =&gt; true, :if =&gt; :name_changed?\nvalidates :schedule_id, :uniqueness =&gt; true, :if =&gt; schedule_id_changed?\n</code></pre>\n\n<p>Gist here: <a href=\"https://gist.github.com/4017019\" rel=\"nofollow\">https://gist.github.com/4017019</a></p>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13222622,"title":"Heroku launch application error Ruby on Rails","body":"<p>Trying to launch an app on Heroku, but it keeps getting an application error.  Here are the heroku logs, Please let me know what I can do to get it the application running.  We have implemented pusher and can get the website to work on local host (even the pusher features across different localhost machines) but other than that it does not work on heroku.</p>\n\n<pre><code>2012-11-04T19:57:31+00:00 app[web.1]: Connecting to database specified by DATABASE_URL\n2012-11-04T19:57:31+00:00 app[web.1]: /app/app/controllers/comments_controller.rb:2:in `&lt;class:CommentsController&gt;': undefined method `post' for CommentsController:Class (NoMethodError)\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/app/controllers/comments_controller.rb:1:in `&lt;top (required)&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]: Exiting\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in &lt;module:Finisher&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:46:in `app'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:70:in `start'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config.ru:4:in `require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config.ru:4:in `block in &lt;main&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config.ru:1:in `new'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from script/rails:6:in `require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from script/rails:6:in `&lt;main&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]: =&gt; Booting WEBrick\n2012-11-04T19:57:32+00:00 app[web.1]: =&gt; Rails 3.2.8 application starting in production on http://0.0.0.0:46992\n2012-11-04T19:57:32+00:00 app[web.1]: =&gt; Call with -d to detach\n2012-11-04T19:57:32+00:00 app[web.1]: =&gt; Ctrl-C to shutdown server\n2012-11-04T19:57:32+00:00 app[web.1]: Connecting to database specified by DATABASE_URL\n2012-11-04T19:57:32+00:00 app[web.1]: Exiting\n2012-11-04T19:57:32+00:00 app[web.1]: /app/app/controllers/comments_controller.rb:2:in `&lt;class:CommentsController&gt;': undefined method `post' for CommentsController:Class (NoMethodError)\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/app/controllers/comments_controller.rb:1:in `&lt;top (required)&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in &lt;module:Finisher&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config.ru:4:in `require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config.ru:4:in `block in &lt;main&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config.ru:1:in `new'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:46:in `app'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:70:in `start'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from script/rails:6:in `require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n2012-11-04T19:57:32+00:00 app[web.1]:   from script/rails:6:in `&lt;main&gt;'\n2012-11-04T19:57:33+00:00 heroku[web.1]: Process exited with status 1\n2012-11-04T19:57:33+00:00 heroku[web.1]: State changed from starting to crashed\n2012-11-04T19:57:33+00:00 heroku[web.1]: Process exited with status 1\n2012-11-04T20:07:27+00:00 heroku[web.1]: State changed from crashed to down\n2012-11-04T20:07:27+00:00 heroku[web.1]: State changed from down to starting\n2012-11-04T20:07:39+00:00 heroku[web.1]: State changed from starting to crashed\n2012-11-04T20:17:44+00:00 heroku[web.1]: State changed from crashed to down\n2012-11-04T20:17:44+00:00 heroku[web.1]: State changed from down to starting\n2012-11-04T20:17:56+00:00 heroku[web.1]: State changed from starting to crashed\n2012-11-04T20:22:51+00:00 heroku[router]: Error H10 (App crashed) -&gt; GET followalong.herokuapp.com/ dyno= queue= wait= service= status=503 bytes=\n2012-11-04T20:22:52+00:00 heroku[router]: Error H10 (App crashed) -&gt; GET followalong.herokuapp.com/favicon.ico dyno= queue= wait= service= status=503 bytes=\n</code></pre>\n"},{"tags":["ruby-on-rails","internationalization","translation","locale"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":22,"score":3,"question_id":13231778,"title":"Rails - Translate model name in form actions","body":"<p>I want to translate a rails form using i18n system.</p>\n\n<p>My model attributes are translated correctly, but when I want to translate submit actions, the model name is not translated.</p>\n\n<p>Here is my fr.yml locale file</p>\n\n<pre><code>fr:\n  activerecord:\n    model:\n      character:\n        one: \"Personnage\"\n        other: \"Personnages\"\n    attributes:\n      character:\n        name: \"Nom\"\n        title: \"Titre\"\n        biography: \"Biographie\"\n  helpers:\n    submit:\n      update: \"Mise à jour %{model}\"\n</code></pre>\n\n<p>My _form.html.erb is</p>\n\n<pre><code>&lt;%= form_for(@character) do |f| %&gt;\n  &lt;% if @character.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@character.errors.count, \"error\") %&gt; prohibited this character from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @character.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :biography %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :biography, :rows =&gt; 8%&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>On my form, I expected the update button to be \"Mise à jour <strong>Personnage</strong>\", but I still have \"Mise à jour <strong>Character</strong>\".</p>\n\n<p>Thanks for your help !</p>\n"},{"tags":["ruby-on-rails","ruby","delayed-job"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":101,"score":-1,"question_id":12005616,"title":"How do I run delayed job inserts in the backgroud without affecting page load - Rails ","body":"<p>I have an RoR application like posting answers to a question. If a user answers to a question, notification messages are sent to all the users, who watch-listed the question, who tracks the question and to the owner of the question. I am using delayed jobs for creating the notification messages. so, While creating answer, there are many inserts into delayed job table going on,which is slowing down the page load. It takes more time to redirect to the question show page after the answer is created. </p>\n\n<p>Currently I am inserting into answers table using AJAX request. Is there any way to insert into delayed jobs table in background after the AJAX request completes? </p>\n"},{"tags":["ruby-on-rails","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13230957,"title":"Maintain custom url in the browser","body":"<p>I’ve been trying to do this for two weeks and I am still stuck. Now, my situation is this:</p>\n\n<p>With no user session started, if I enter this url in the brower: <code>http://localhost.../something?a=1&amp;b=2</code> it shows the subscription with the attributes a = 1 and b = 2. Everything OK.</p>\n\n<p>If I edit something of the subscription everything goes OK, but the problem is that the url changes to <code>http://localhost.../subscription/id</code>.</p>\n\n<p>What I want is that when I modify something in the subscription the url must be <code>http://localhos.../something?a=1&amp;b=2</code>  instead of the <code>http://localhost.../subscription/id</code>.</p>\n\n<p>routes.rb</p>\n\n<pre><code> …\n match \"/something\" =&gt; \"subscriptions#show\"\n …\n</code></pre>\n\n<p>subscription_controller.rb</p>\n\n<pre><code>…\ndef show\n  @subscription = Subscription.find(params[:id] || Subscription.find_by_token_and_networkId!(params[:t], params[:nwk]))\n…\n</code></pre>\n\n<p>I don’t want to became the /subscription/id url useless because I want to access it from another part of the webpage.</p>\n"},{"tags":["ruby-on-rails","erb"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13221131,"title":"Delete the last record in a database","body":"<p>I'm trying to delete the last database record but when I press the link, the page just refreshes and I dont get anything :/</p>\n\n<p>Here's my controller:</p>\n\n<pre><code>  def delete\n    @todo_items = Todo.last\n    @todo_items.delete\n  end\n</code></pre>\n\n<p>&amp; here's my view</p>\n\n<pre><code>&lt;h1&gt;Shared Todo App&lt;/h1&gt;\n  &lt;p&gt;All your todos here&lt;/p&gt;\n&lt;% @todo_items.each do |t| %&gt;\n&lt;li&gt;&lt;%= t.todo_item %&gt;\n&lt;% end %&gt;\n\n  &lt;%= link_to 'Delete', todo_item, confirm: 'Are you sure?', method: :delete %&gt;\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","full-text-search","railscasts"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1698,"score":3,"question_id":8505837,"title":"How to use Elasticsearch on Heroku","body":"<p>I've just finished watching both Railscasts' episodes on <a href=\"http://www.elasticsearch.org/\" rel=\"nofollow\">Elasticsearch</a>. I've also went ahead and implemented it into my rails application (3.1) and everything is working great. How I want to deploy my app to Heroku but I'm unsure how to get Elasticsearch working on <a href=\"http://heroku.com/\" rel=\"nofollow\">Heroku</a> (specifically on a cedar stack). </p>\n\n<p>Any help would be greatly appreciated!</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":3,"favorite_count":5,"up_vote_count":7,"down_vote_count":0,"view_count":3453,"score":7,"question_id":9658881,"title":"Rails: select unique values from a column","body":"<p>I already have a working solution, but I would really like to know why this doesn't work:</p>\n\n<pre><code>ratings = Model.select(:rating).uniq\nratings.each { |r| puts r.rating }\n</code></pre>\n\n<p>It selects, but don't print unique values, it prints all values, including the duplicates. And it's in the documentation: <a href=\"http://guides.rubyonrails.org/active_record_querying.html#selecting-specific-fields\">http://guides.rubyonrails.org/active_record_querying.html#selecting-specific-fields</a></p>\n"},{"tags":["ruby-on-rails","state-machines","aasm"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":443,"score":1,"question_id":2988920,"title":"Getting list of states/events from a model that AASM","body":"<p>I successfully integrated the most recent AASM gem into an application, using it for the creation of a wizard. In my case I have a model order</p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n\n  belongs_to :user\n  has_one :billing_plan, :dependent =&gt; :destroy\n  named_scope :with_user, ..... &lt;snip&gt;\n\n  include AASM\n\n  aasm_column :aasm_state\n  aasm_initial_state :unauthenticated_user\n\n  aasm_state :unauthenticated_user, :after_exit =&gt; [:set_state_completed]\n  aasm_state : &lt;snip&gt;\n\n  &lt;and following the event definitions&gt;\n\nend\n</code></pre>\n\n<p>Now I would like to give an administrator the possibility to create his own graphs through the AASM states. Therefore I created two additional models called OrderFlow and Transition where there order_flow has many transitions and order belongs_to order_flow. </p>\n\n<p>No problem so far. Now I would like to give my admin the possibility to dynamically add existing transitions / events to an order_flow graph. </p>\n\n<p>The problem now is, that I do not find any possibility to get a list of all events / transitions out of my order model. aasm_states_for_select seems to be the correct candidate, but I cannot call it on my order model. </p>\n\n<p>Can anyone help?</p>\n\n<p>Thx in advance. \nJ. </p>\n"},{"tags":["ruby-on-rails","ruby","device","cancan","twitter-bootstrap-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13228938,"title":"Rails Tutorial for Devise with CanCan and Twitter Bootstrap","body":"<p>Can't run this open source project <a href=\"http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html.I\" rel=\"nofollow\">http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html.I</a>'m using Ruby version1.9.3p286 and Rails 3.2.8. \nI've installed all gems successfully, but when trying to run from RubyMine output \nthe following:</p>\n\n<pre><code>/Users/st/.rvm/rubies/ruby-1.9.3-p286/bin/ruby -e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) /Users/st/projects/rails3-bootstrap-devise-cancan/script/rails server -b 0.0.0.0 -p 3000 -e development\n/Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/spec_set.rb:90:in `block in materialize': Could not find diff-lcs-1.1.3 in any of the sources (Bundler::GemNotFound)\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/spec_set.rb:83:in `map!'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/spec_set.rb:83:in `materialize'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/definition.rb:113:in `specs'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/definition.rb:158:in `specs_for'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/definition.rb:147:in `requested_specs'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/environment.rb:23:in `requested_specs'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/runtime.rb:11:in `setup'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler.rb:116:in `setup'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/setup.rb:17:in `&lt;top (required)&gt;'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n    from /Users/st/projects/rails3-bootstrap-devise-cancan/config/boot.rb:6:in `&lt;top (required)&gt;'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/st/projects/rails3-bootstrap-devise-cancan/script/rails:5:in `&lt;top (required)&gt;'\n    from -e:1:in `load'\n    from -e:1:in `&lt;main&gt;'\nProcess finished with exit code 1\n</code></pre>\n\n<p>My gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'rails', '3.2.8'\ngem 'sqlite3'\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\ngem 'jquery-rails'\ngem \"rspec-rails\", \"&gt;= 2.11.0\", :group =&gt; [:development, :test]\ngem \"email_spec\", \"&gt;= 1.2.1\", :group =&gt; :test\ngem \"cucumber-rails\", \"&gt;= 1.3.0\", :group =&gt; :test, :require =&gt; false\ngem \"database_cleaner\", \"&gt;= 0.8.0\", :group =&gt; :test\ngem \"launchy\", \"&gt;= 2.1.2\", :group =&gt; :test\ngem \"capybara\", \"&gt;= 1.1.2\", :group =&gt; :test\ngem \"factory_girl_rails\", \"&gt;= 4.1.0\", :group =&gt; [:development, :test]\ngem \"bootstrap-sass\", \"&gt;= 2.1.0.0\"\ngem \"devise\", \"&gt;= 2.1.2\"\ngem \"cancan\", \"&gt;= 1.6.8\"\ngem \"rolify\", \"&gt;= 3.2.0\"\ngem \"simple_form\", \"&gt;= 2.0.3\"\ngem \"quiet_assets\", \"&gt;= 1.0.1\", :group =&gt; :development\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13229936,"title":"Single mass insert into database in rails","body":"<p>I want to use something like the following, to insert like 1.000.000 statements at once into my database.\nBut in my model i have a <strong>before_create :build_a_detail</strong> which inserts to every record in user_node_scores an associated record in the other table. they are associated through a has_one, belongs_to relationship and a foreign key..</p>\n\n<p>But how can i maintain this association, with a single mass insert!?</p>\n\n<pre><code>inserts = []\nTIMES.times do\n  inserts.push \"(3.0, '2009-01-23 20:21:13', 2, 1)\"\nend\nsql = \"INSERT INTO user_node_scores (`score`, `updated_at`, `node_id`, `user_id`) VALUES #{inserts.join(\", \")}\n</code></pre>\n"},{"tags":["ruby-on-rails","ajax","jquery-ajax","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13206406,"title":"Rails: How to get ajax to refresh index after edit/update?","body":"<p><strong>CRUD</strong> from Index page.</p>\n\n<p>I know there are gems to make this easy, but would like to avoid if possible.</p>\n\n<p>On Index.html.erb<br>\n- Rendering _newsfeeds partial into &lt; ul id=\"feedsNews\" > on index.html.erb<br>\n- partial form ( :Create and :Edit are using same form )<br>\n- When user clicks 'Edit' btn on newsfeed, I'm appending partial form to newsfeed</p>\n\n<p>Problems<br>\nEdit/update changes are being made ...UNFORTUNATELY, I can't seem to get the ajax:success to reload the _newsfeeds partial on index.html.erb. If it's something silly, I apologize...</p>\n\n<p><strong>NEWSFEEDS_CONTROLLER</strong></p>\n\n<pre><code>    def index\n      @newsfeeds = Newsfeed.all\n      @newsfeed = Newsfeed.new\n      @newsfeeds = Newsfeed.order(\"position\") #for Sortable\n\n      respond_to do |format|\n        format.html # index.html.erb\n        format.json { render json: @newsfeeds }\n        format.js\n      end\n    end\n\n    def update\n      @newsfeed = Newsfeed.find(params[:id])\n\n      respond_to do |format|\n        if @newsfeed.update_attributes(params[:newsfeed])\n          format.html { redirect_to newsfeeds_url, notice: 'Updated' }\n          format.json { head :no_content }\n        else\n          format.html { render action: \"edit\" }\n          format.json { render json: @newsfeed.errors, status: :unprocessable_entity }\n        end\n      end\n    end\n</code></pre>\n\n<p><strong>index.html.erb</strong> </p>\n\n<pre><code>    &lt;div&gt;\n        &lt;div id=\"spinner\" style=\"display:none;\"&gt;&lt;/div&gt;\n        &lt;ul id=\"feedsNews\" class=\"showList\" data-update-url=\"&lt;%= sort_newsfeeds_url %&gt;\" &gt;\n            &lt;%= render :partial =&gt; @newsfeeds %&gt;\n        &lt;/ul&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p><strong>index.js.erb</strong></p>\n\n<pre><code>    $('#&lt;%= dom_id(@newsfeed, :edit) %&gt;')\n        .bind('ajax:send', function(){\n           $('#spinner').show();\n        })\n        .bind('ajax:success', function() {\n           $('#spinner').hide();\n           $('#feedsNews').innerHTML ('&lt;%= escape_javascript(render(@newsfeeds)) %&gt;')\n        })\n</code></pre>\n\n<p>Any help would be much appreciated.  </p>\n\n<p><strong>----------------UPDATE--------------------</strong></p>\n\n<p>Changed it to this, which works... sorta... the index.js.erb seems like it's firing before the redirect from the update action, so the firebug is giving me an endless 'spinner' for the index.js.erb GET request  </p>\n\n<pre><code>    $.ajax({\n    complete: function() {\n    $('#feedsNews').html('&lt;%= escape_javascript(render :partial =&gt; @newsfeeds) %&gt;');\n    alert('Changes Saved!');\n}\n</code></pre>\n\n<p>});</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13229744,"title":"Why \"create! do\" works in this model and not \"new! do\"?","body":"<p>I have the following code:</p>\n\n<p><strong>user.rb</strong>:</p>\n\n<pre><code>  def self.create_with_omniauth(auth)\n    create! do |user|\n      user.provider = auth[\"provider\"]\n      user.uid = auth[\"uid\"]\n      user.name = auth[\"info\"][\"name\"]\n      # Add an error message when email is already taken\n      user.email = auth[\"info\"][\"email\"]\n      user.password = user.password_confirmation = SecureRandom.urlsafe_base64(n=6) \n    end\n  end\n</code></pre>\n\n<p><strong>sessions_controller.rb:</strong></p>\n\n<pre><code> def omniauth_create\n    auth = request.env[\"omniauth.auth\"]\n    user = User.from_omniauth(env[\"omniauth.auth\"])\n    if user.save\n      sign_in user\n      redirect_back_or user\n    else\n      #session[:omniauth] = request.env['omniauth.auth'].except('extra')\n      redirect_to signup_path\n      flash.now[:error] = 'Worked!'\n    end\n  end\n</code></pre>\n\n<p>Now this code doesn't work because <code>create! do</code> in the User model saves the user and an error is being thrown before the execution reaches the controller and pass through the if statement. So I thought of using <code>new! do</code> instead but got this:</p>\n\n<pre><code>undefined method `new!' for #&lt;Class:0xb5aaf04&gt;\n</code></pre>\n\n<p>Why \"create! do\" worked not \"new! do\"?</p>\n\n<p>(I am taking the wrong approach to solve this? If so, what others solutions I can apply?)</p>\n"},{"tags":["ruby-on-rails","layout","pjax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13229083,"title":"Adding PJAX support to current Rails project","body":"<p>I have an existing website which uses standard Rails layouts. Clicking each link in the website currently loads and renders the relevant view.</p>\n\n<p>Recently though, I've heard about PJAX and i'd like to convert the entire site to use it, what do I need to change - layout wise, in order to be able to utilise it? </p>\n\n<p>Is there a guide which walks through this process which I may have missed?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","activerecord","ruby-on-rails-3.2","arel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13229394,"title":"How to store an AR relation (other than .to_sql)?","body":"<p>Say I want to persist a certain relation in the session to reuse it in a subsequent request, I can do the following:</p>\n\n<pre><code># first request\nusers = User.where(admin: true).limit(10)\nsession[:sql] = users.to_sql\n\n# second request\nusers = User.find_by_sql session[:sql]\n</code></pre>\n\n<p>However, if I want to get a different result subset with <code>offset(11).limit(10)</code> in the second request, I have to regex the plain SQL to do so.</p>\n\n<p>Is there a way to extract just the relation and then apply it in another request? Something similar to:</p>\n\n<pre><code># first request\nusers = User.where(admin: true).limit(10)\nsession[:relation] = users.relation   # won't work\n\n# second request\nusers = User.relation(session[:relation]).offset(11).limit(10)\n</code></pre>\n\n<p>Cheers, -sven</p>\n"},{"tags":["ruby-on-rails","google-chrome","google-chrome-extension"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13225232,"title":"Receive file from server in Chrome extension","body":"<p>I would like to connect my Chrome Extension to be able to download a file from my Ruby on Rails server. In particular, when the user clicks a button on the extension, the extension should send an AJAX request to the server, and then the server should send a file <code>file.zip</code> back to the user. </p>\n\n<p>How would the server send a file back to the extension of the user?</p>\n"},{"tags":["ruby-on-rails","carrierwave","amazon-cloudfront"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13204978,"title":"CDN (Cloudfront) Cache Invalidation using Carrierwave","body":"<p>I'm using carrierwave to allow users to upload images with an ability to crop after upload, the issue is the versions get created and CDN catch them instantly that when users crop they don't see changes because the Cloudfront cache has to be invalidated and takes quite a decent time to refresh on its own.</p>\n\n<p>I thought putting version numbers on file names might be a good way to sorta invalidate cache, how to achieve that using Carrierwave?</p>\n\n<p>And is that the best approach? </p>\n"},{"tags":["ruby-on-rails","ruby","erb","friendly-id"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13229354,"title":"Rails and Friendly ID gem path helper issue","body":"<p>I've posted this as an issue on the <a href=\"https://github.com/norman/friendly_id/issues/333\" rel=\"nofollow\">Github page for Friendly ID</a>, but haven't yet had any response. I'm completely blocked on it, so it would be great if someone has some insight!</p>\n\n<p>I have a Recipe model, and have added the lines as per the README (using Friendly ID v4):</p>\n\n<pre><code>class Recipe &lt; ActiveRecord::Base\n  extend FriendlyId\n  friendly_id :name, use: :slugged\n  #...\n</code></pre>\n\n<p>And have added the migration. All the records were updated successfully, and now have a slug. Not only that, but going to <code>/recipes/&lt;this-is-a-slug&gt;</code> works.</p>\n\n<p>However, I assumed (quite possibly incorrectly) that the path helper would then use the model's slug attribute rather than ID, so that all links to the recipes would go to <code>/recipes/&lt;slug&gt;</code> rather than <code>/recipes/&lt;id&gt;</code>. This isn't the case - they still all link to the ID.</p>\n\n<p>Not only that but I've searched in vain all over the Internets to try and find someone else with the same problem. I've tried all of the following paths in my view file:</p>\n\n<pre><code>&lt;%= link_to 'view recipe', recipe  # -&gt; links to /recipes/&lt;id&gt; %&gt;\n&lt;%= link_to 'view recipe', recipe_path(recipe) # -&gt; links to /recipes/id %&gt; \n&lt;%= link_to 'view recipe', recipe_path(recipe.slug) # -&gt; gives a routing error, \"No route matches {:action=&gt;\"show\", :controller=&gt;\"recipes\", :id=&gt;nil}\" %&gt; \n</code></pre>\n\n<p>Could anyone point me in the right direction? Thanks a lot!</p>\n"},{"tags":["ruby-on-rails","search","post","blogs","message"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13227345,"title":"How to validate a search form in ruby on rails?","body":"<p>I have implemented a simple search functionality for my rails 3 blog application. I want to validate it, in such a way, that with non-matching keywords, or when the search text field is blank, &amp; when user clicks search button, it should display a message saying \"your search criteria is invalid. Please try using valid keywords\"</p>\n\n<p>My Code is as follows :</p>\n\n<p>In Post Model,</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\nattr_accessible :title, :body\nvalidates_presence_of :search\nvalidates :title, :presence =&gt; true, :uniqueness =&gt; true\nvalidates :body, :presence =&gt; true, :uniqueness =&gt; true\n  def self.search(search)\n    if search\n      where(\"title LIKE ? OR body LIKE ?\",\"%#{search.strip}%\",\"%#{search.strip}%\")\n    else\n      scoped\n    end\n  end\nend\n</code></pre>\n\n<p>In Post Controller,</p>\n\n<pre><code> class PostsController &lt; ApplicationController\n  def index    \n   @posts=Post.includes(:comments).search(params[:search])\n   .paginate(per_page:2,page:params[:page]).order(\"created_at DESC\")\n  end\nend\n</code></pre>\n\n<p>In Posts/index.html.erb (Views)</p>\n\n<pre><code>&lt;div class = \"search\"&gt;\n &lt;span&gt;\n  &lt;%= form_tag(posts_path, :method =&gt; :get, :validate =&gt; true) do %&gt;\n    &lt;p&gt;\n    &lt;%= text_field_tag (:search), params[:search] %&gt;\n    &lt;%= submit_tag 'Search' %&gt;\n  &lt;/br&gt;\n    &lt;% if params[:search].blank? %&gt;\n    &lt;%= flash[:error] = \"Sorry... Your Search criteria didnt match. \n     Please try using  different keyword.\" %&gt;\n    &lt;% else %&gt;\n    &lt;/p&gt;\n  &lt;% end %&gt;  \n  &lt;/p&gt;\n  &lt;% end %&gt;\n &lt;/span&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","database","path"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":196,"score":2,"question_id":8122757,"title":"Rails is looking for /config/config/database.yml","body":"<p>I'm trying to migrate a Rails 2.3.4 application to Rails 3.1.1, and when i try to reach my root_path, i get a 500 errors.</p>\n\n<p>In my Nginx's log, i get this : </p>\n\n<blockquote>\n  <p>[ pid=12653 thr=2225406380 file=utils.rb:176 time=2011-11-14 14:39:42.907 ]: <em>*</em> Exception Errno::ENOENT in application (No such file or directory - /Users/cedric/Code/my-app/config/config/database.yml) (process 12653, thread #):     </p>\n</blockquote>\n\n<p>It seems that Rails is looking for my database.yml in <code>config/config</code> path instead of <code>config/</code>.</p>\n\n<p>Does anyone know how i can fix this problem?</p>\n\n<p>Thank you</p>\n"},{"tags":["javascript","ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":50,"score":-6,"question_id":13228246,"title":"check if a div exists from view","body":"<p>How to check if a div already exits and if exists do something from view in Ruby on rails.\nI want to do something only if the div is already present.</p>\n\n<p>eg: <code>- registration.each do |id|\n  - if (the div with id is already present)\n    = render :partial =&gt; test</code></p>\n"},{"tags":["ruby-on-rails","ruby","aptana"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13228996,"title":"Error dealing in aptana rad rails and ruby on rails","body":"<p>In aptana rad rails, I am getting an error <strong>after updating my mozilla firefox</strong> .... the error was <strong>\"An internal error has occurred. No more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set]\"</strong> and also <strong>\"An SWT error has occurred. You are recommended to exit the workbench. Subsequent errors may happen and may terminate the workbench without warning.See the .log files for more details.\".</strong>........like this.</p>\n\n<p>So, Anyone Kindly help me to sort out this problem. \nThank You...</p>\n"},{"tags":["ruby-on-rails","gmaps4rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12880571,"title":"How do you use gmaps4rails to send a an ajax call using UJS in Ruby on Rails?","body":"<p>I followed the examples in the two locations:</p>\n\n<ul>\n<li><a href=\"https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Using-with-UJS\" rel=\"nofollow\">https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Using-with-UJS</a></li>\n<li><a href=\"https://gist.github.com/1643990\" rel=\"nofollow\">https://gist.github.com/1643990</a></li>\n</ul>\n\n<p>but they both do not work.  I get nothing back for either. I'm currently using the 1.5.5 version of gmaps4rails in RoR 3.2.8.</p>\n\n<p>show_map.js.erb</p>\n\n<pre><code>$('#map_container').show();\n$('#map_container').html('&lt;%= escape_javascript( gmaps({:last_map =&gt; false}) ) %&gt;');\nGmaps.map = new Gmaps4RailsGoogle();\n\nGmaps.load_map = function() {\n  Gmaps.map.map_options.maxZoom = 15;\n  Gmaps.map.initialize();\n  Gmaps.map.create_markers();\n  Gmaps.map.adjustMapToBounds();\n  Gmaps.map.markers = &lt;%= @json %&gt;;\n  Gmaps.map.callback();\n};\nGmaps.loadMaps();\n</code></pre>\n\n<p>users_controller.rb</p>\n\n<pre><code>  def show_map\n    @user = User.first\n    @json = @user.to_gmaps4rails\n    respond_to do |format|\n      format.js {}\n    end\n  end\n</code></pre>\n\n<p>show.html.haml</p>\n\n<pre><code>  = link_to \"Map\", show_map_path, :remote =&gt; true\n  #map_container{:style =&gt; 'display:none;'}\n</code></pre>\n\n<p>Thanks for your help!</p>\n"},{"tags":["ruby-on-rails","soap","heroku","webservice-client"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13228269,"title":"What libraries / approach should I have for connecting with ruby on rails system to a standard Microsoft Web service using the soap protocol?","body":"<p>I am looking to connect with an API (documentation: <a href=\"http://carsolize.com/carsolize_API_v2.5.pdf\" rel=\"nofollow\">http://carsolize.com/carsolize_API_v2.5.pdf</a>).</p>\n\n<p>To get started in a good direction how would you do this? (What gems/methods would I use?, any tips highly appreciated!)</p>\n"},{"tags":["ruby-on-rails","amazon-s3","carrierwave","fog"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13228772,"title":"Imperavi Redactor + RubyOnRails + Amazon S3","body":"<p>I need to integrate <a href=\"http://imperavi.com/redactor/\" rel=\"nofollow\">Imperavi Redactor</a> with <a href=\"http://aws.amazon.com/s3/\" rel=\"nofollow\">Amazon S3</a>. But instead of  JavaScript, would like my RubyOnRails application do the upload process, I already use <a href=\"http://fog.io/\" rel=\"nofollow\">fog</a>, <a href=\"https://github.com/jnicklas/carrierwave\" rel=\"nofollow\">carrierwave</a> and <a href=\"https://github.com/tanraya/imperavi-rails\" rel=\"nofollow\">imperavi-rails</a>.</p>\n\n<p>Can you help me?</p>\n"},{"tags":["ruby-on-rails","ruby","achievements"],"answer_count":4,"favorite_count":11,"up_vote_count":7,"down_vote_count":1,"view_count":534,"score":6,"question_id":9608069,"title":"Modern tools for Ruby/Rails for building an achievement system","body":"<p>I am interested in building a robust achievement system for my Ruby on Rails application. </p>\n\n<p>The achievements can happen in a myriad of ways. Normally, we'd have some criteria that can happen to several models, some required, some optional (mix and match) that triggers an achievement. </p>\n\n<p>I would say this is similar to the achievement system on here or Foursquare badges. Ideally if there is a modern tool out there that can help abstract a lot of the work in some DSL, that would be fantastic. </p>\n\n<p>I'm interested in seeing how others solved this issue using Ruby or Ruby on Rails. Building this from scratch sounds unreasonable as I'm sure it's been solved many times repeatedly. </p>\n"},{"tags":["ruby-on-rails","radio-button","nested-attributes","fields-for"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13227980,"title":"fields_for with radio buttons in rails 3.2","body":"<p>i currently do have a form for a event-signup, with unlimited amount greater one of participants in signup-form, so you can append forms via javascript, which i copied form the fields_for generator of the first must-be participant.</p>\n\n<p>Now i have a gender-field, which is just called :gender, and like 10 other inputs for other personal data.</p>\n\n<p>the genderfield however is the only one which is not send for each and every participiant.\nthe field is just missing.</p>\n\n<p>the fields_for helper named it for example:</p>\n\n<pre><code>event[participants][][email]\nevent[participants][][gender]\n</code></pre>\n\n<p>when i add 3 participants, i get an array like:</p>\n\n<pre><code>[{email: email1, gender: male}, {email:email2}, {email:email3}]\n</code></pre>\n\n<p>set to rails.</p>\n\n<p>since a radio-button is grouped by its name, i thought i might add the the index to the empty brackets, to have it like</p>\n\n<pre><code>event[participants][1][gender]\n</code></pre>\n\n<p>for the 2nd participant.</p>\n\n<p>this leads to </p>\n\n<pre><code>ERROR TypeError: expected Array (got Rack::Utils::KeySpaceConstrainedParams) for param `participants'\n</code></pre>\n\n<p>in Webrick.</p>\n\n<p>I am a bit confused of how to continue, giving all the inputs the index maybe, which feels not like rails-way at all.</p>\n\n<p>Any suggestions how to get this to work? my aim is to to get the gender sent for each participant.</p>\n\n<p>Best regards and thanks,\ndaniel</p>\n\nthe code, simplified:\n\n<p>the form:</p>\n\n<pre><code>= form_for @signup do |f|\n    - participant_count = @signup.participants.count\n    - @signup.participants.each_with_index do |participant,index|\n      = f.fields_for \"participants[]\", participant do |p|\n      = render :partial=&gt;'participant_form', |\n        :locals=&gt;{:p=&gt;p, :participant=&gt;participant, :index=&gt;index, :participant_count =&gt; participant_count}\n</code></pre>\n\n<p>the _participant-partial, for one input that works and the gender:</p>\n\n<pre><code>%table\n  %tr\n   %th\n    Gender / Only sent for the first participant:(\n    %span *\n  %td\n    =p.radio_button :gender, 'male'\n    %span  Male\n    =p.radio_button :gender, 'female'\n    %span Female\n\n%tr\n  %th\n    Name\n    %span *\n  %td\n    = p.text_field :first_name / this works just fine! for EACH participant.\n</code></pre>\n\n<p>results in this html code:</p>\n\n<pre><code> &lt;input id=\"event_participants__first_name\" name=\"event[participants][][first_name]\" size=\"30\" type=\"text\" value=\"\" /&gt;\n  and\n &lt;input id=\"event_participants__gender_male\" name=\"event[participants][][gender]\" style=\"float:left; margin-right: 20px;\" type=\"radio\" value=\"male\"&gt;\n  for each participant.\n</code></pre>\n"},{"tags":["ruby-on-rails","forms"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13227593,"title":"What is 'the Rails way' to have forms not directly mapped to an object model?","body":"<p>Let's say I have three tables to accommodate a many-to-many relationship.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_many :user_hobbies\n    has_many :hobbies, :through =&gt; :user_hobbies\nend\nclass UserHobbies &lt; ActiveRecord::Base\n    belongs_to :user\n    belongs_to :hobby\nend\nclass Hobby &lt; ActiveRecord::Base\n    has_many :user_hobbies\n    has_many :users, :through =&gt; :user_hobbies\nend\n</code></pre>\n\n<p>And I wanted to have a form in which a user can input as many hobbies as they want, where each would be stored into the correct tables (in my situation, the 'Hobby' table is preset, the user may select from enumerated values, not add them)</p>\n\n<p>How would I go about producing a form to achieve this? I would use JavaScript for Auto-Completion and dynamic fields (i.e. each time you enter a field, another appears).</p>\n"}]}
{"total":93230,"page":9,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","whenever"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13227855,"title":"Using whenever gem to schedule a cron job","body":"<p>I'm testing whenever to figure out how to use it and am running into trouble even after reading the Github documentation.</p>\n\n<p>I simply want to update the attributes of my model like this (config/schedule.rb)</p>\n\n<p>set :output \"/log/today.log\"</p>\n\n<pre><code>every 10.seconds do\n  runner \"Example.update_all(sample: Time.now)\"\nend\n</code></pre>\n\n<p>I am neither seeing a log file nor seeing the model attributes updated.</p>\n\n<p>Is there anything I am not doing correctly?</p>\n"},{"tags":["ruby-on-rails","postgresql","activerecord","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13227485,"title":"Limiting inner associations in Rails 3 (ActiveRecord)","body":"<p>I have one to one association with the following active record model (example):</p>\n\n<pre><code>User &lt;-1-1-&gt; employee &lt;-1-1-&gt; contact &lt;-1-1-&gt; \npermanentAddress contact &lt;-1-1-&gt; communicationAddress    \n</code></pre>\n\n<p>When the query fires using ActiveRecord:</p>\n\n<pre><code>User Load (1.1ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", \"49\"]]\n  Employeedetail Load (1.8ms)  SELECT \"employeedetails\".* FROM \"employeedetails\" WHERE \"employeedetails\".\"User_id\" = 49 LIMIT 1\n  Contactdetail Load (0.6ms)  SELECT \"contactdetails\".* FROM \"contactdetails\" WHERE \"contactdetails\".\"employeedetail_id\" = 40 LIMIT 1\n  Address Load (1.1ms)  SELECT \"addresses\".* FROM \"addresses\" WHERE \"addresses\".\"contactdetail_id\" = 52 LIMIT 1\n  CACHE (0.0ms)  SELECT \"addresses\".* FROM \"addresses\" WHERE \"addresses\".\"contactdetail_id\" = 52 LIMIT 1\n</code></pre>\n\n<p>Question : How to increase the <code>LIMIT</code> to 2 for addresses table <code>[inner association]</code>.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13227270,"title":"ssl error in gem 'omniauth-facebook' (ruby in rails)","body":"<p>Faraday::Error::ConnectionFailed (SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed):\n  /home/cis/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in <code>connect'\n  /home/cis/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in</code>block in connect'\n  /home/cis/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/timeout.rb:54:in <code>timeout'\n  /home/cis/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/timeout.rb:99:in</code>timeout'\n  /home/cis/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in <code>connect'\n  /home/cis/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:755:in</code>do_start'\n  /home/cis/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:744:in <code>start'\n  /home/cis/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:1284:in</code>request'\n  faraday (0.8.0) lib/faraday/adapter/net_http.rb:72:in <code>perform_request'\n  faraday (0.8.0) lib/faraday/adapter/net_http.rb:35:in</code>call'\n  faraday (0.8.0) lib/faraday/request/url_encoded.rb:14:in <code>call'\n  faraday (0.8.0) lib/faraday/connection.rb:226:in</code>run_request'\n  oauth2 (0.8.0) lib/oauth2/client.rb:88:in <code>request'\n  oauth2 (0.8.0) lib/oauth2/client.rb:131:in</code>get_token'\n  oauth2 (0.8.0) lib/oauth2/strategy/auth_code.rb:29:in <code>get_token'\n  omniauth-oauth2 (1.1.1) lib/omniauth/strategies/oauth2.rb:99:in</code>build_access_token'\n  omniauth-facebook (1.4.1) lib/omniauth/strategies/facebook.rb:73:in <code>block in build_access_token'\n  omniauth-facebook (1.4.1) lib/omniauth/strategies/facebook.rb:174:in</code>with_authorization_code!'\n  omniauth-facebook (1.4.1) lib/omniauth/strategies/facebook.rb:73:in <code>build_access_token'\n  omniauth-oauth2 (1.1.1) lib/omniauth/strategies/oauth2.rb:74:in</code>callback_phase'\n  omniauth (1.1.1) lib/omniauth/strategy.rb:219:in <code>callback_call'\n  omniauth (1.1.1) lib/omniauth/strategy.rb:175:in</code>call!'\n  omniauth (1.1.1) lib/omniauth/strategy.rb:157:in <code>call'\n  omniauth (1.1.1) lib/omniauth/builder.rb:48:in</code>call'\n  sass (3.2.2) lib/sass/plugin/rack.rb:54:in <code>call'\n  warden (1.2.1) lib/warden/manager.rb:35:in</code>block in call'\n  warden (1.2.1) lib/warden/manager.rb:34:in <code>catch'\n  warden (1.2.1) lib/warden/manager.rb:34:in</code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in <code>call'\n  rack (1.4.1) lib/rack/etag.rb:23:in</code>call'\n  rack (1.4.1) lib/rack/conditionalget.rb:25:in <code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in</code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in <code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in</code>call'\n  rack (1.4.1) lib/rack/session/abstract/id.rb:205:in <code>context'\n  rack (1.4.1) lib/rack/session/abstract/id.rb:200:in</code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in <code>call'\n  activerecord (3.2.8) lib/active_record/query_cache.rb:64:in</code>call'\n  activerecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in <code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in</code>block in call'\n  activesupport (3.2.8) lib/active_support/callbacks.rb:405:in <code>_run__1903614754719628536__call__3662318648294812780__callbacks'\n  activesupport (3.2.8) lib/active_support/callbacks.rb:405:in</code>__run_callback'\n  activesupport (3.2.8) lib/active_support/callbacks.rb:385:in <code>_run_call_callbacks'\n  activesupport (3.2.8) lib/active_support/callbacks.rb:81:in</code>run_callbacks'\n  actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in <code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in</code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in <code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in</code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in <code>call'\n  railties (3.2.8) lib/rails/rack/logger.rb:26:in</code>call_app'\n  railties (3.2.8) lib/rails/rack/logger.rb:16:in <code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in</code>call'\n  rack (1.4.1) lib/rack/methodoverride.rb:21:in <code>call'\n  rack (1.4.1) lib/rack/runtime.rb:17:in</code>call'\n  activesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in <code>call'\n  rack (1.4.1) lib/rack/lock.rb:15:in</code>call'\n  actionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in <code>call'\n  railties (3.2.8) lib/rails/engine.rb:479:in</code>call'\n  railties (3.2.8) lib/rails/application.rb:223:in <code>call'\n  rack (1.4.1) lib/rack/content_length.rb:14:in</code>call'\n  railties (3.2.8) lib/rails/rack/log_tailer.rb:17:in <code>call'\n  thin (1.5.0) lib/thin/connection.rb:81:in</code>block in pre_process'\n  thin (1.5.0) lib/thin/connection.rb:79:in <code>catch'\n  thin (1.5.0) lib/thin/connection.rb:79:in</code>pre_process'\n  thin (1.5.0) lib/thin/connection.rb:54:in <code>process'\n  thin (1.5.0) lib/thin/connection.rb:39:in</code>receive_data'\n  eventmachine (1.0.0) lib/eventmachine.rb:187:in <code>run_machine'\n  eventmachine (1.0.0) lib/eventmachine.rb:187:in</code>run'\n  thin (1.5.0) lib/thin/backends/base.rb:63:in <code>start'\n  thin (1.5.0) lib/thin/server.rb:159:in</code>start'\n  rack (1.4.1) lib/rack/handler/thin.rb:13:in <code>run'\n  rack (1.4.1) lib/rack/server.rb:265:in</code>start'\n  railties (3.2.8) lib/rails/commands/server.rb:70:in <code>start'\n  railties (3.2.8) lib/rails/commands.rb:55:in</code>block in '\n  railties (3.2.8) lib/rails/commands.rb:50:in <code>tap'\n  railties (3.2.8) lib/rails/commands.rb:50:in</code>'\n  script/rails:6:in <code>require'\n  script/rails:6:in</code>'</p>\n\n<p>how to solve this problem</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13227611,"title":"Rails not showing error on form submit","body":"<p>I am working in rails 2, I have a form containing data of two models, In one model I am validating fields and entering error using <code>self.errors.add_to_base</code> , but this is not displaying error on form and submitting that request successfully.</p>\n\n<p>This is my Model validation\\</p>\n\n<pre><code>validate :checkPunchingEntries\n\n  def checkPunchingEntries\n    if self.punch_in_time.blank? &amp;&amp; self.punch_out_time.blank?\n      self.errors.add_to_base(\"Both 'Punch in' and 'Punch out' time can not be blank\")\n    end\n  end\n</code></pre>\n\n<p>This is my Form</p>\n\n<pre><code>&lt;% form_tag '/punching_requests/create', :method =&gt; :post, :class=&gt;\"punching_request_form\" do %&gt;\n    &lt;% @punching_request.errors.full_messages.each do |msg| %&gt;\n        &lt;p class=\"error\"&gt;&lt;%=msg%&gt;&lt;/p&gt;\n    &lt;% end %&gt;\n\n    &lt;p&gt;\n      &lt;label&gt;Date &lt;/label&gt;\n      &lt;%= text_field_tag 'date'%&gt;  &lt;%= calendar_for(\"date\") %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;label&gt;&amp;nbsp;&lt;/label&gt;\n      &lt;input type=\"checkbox\" onclick=\"punch_in_toggle()\"&gt;Punch In&lt;/input&gt;\n      &lt;input type=\"checkbox\" onclick=\"punch_out_toggle()\"&gt;Punch Out&lt;/input&gt;\n    &lt;/p&gt;\n\n    &lt;div id=\"punch_in\"&gt;\n      &lt;p&gt;\n        &lt;label&gt;Punch In Time &lt;/label&gt;\n        &lt;%= text_field_tag 'punch_in_time'%&gt;\n      &lt;/p&gt;\n    &lt;/div&gt;\n\n    &lt;div id=\"punch_out\"&gt;\n      &lt;p&gt;\n        &lt;label&gt;Punch Out Time &lt;/label&gt;\n        &lt;%= text_field_tag 'punch_out_time'%&gt;\n      &lt;/p&gt;\n    &lt;/div&gt;\n\n    &lt;p&gt;\n      &lt;label&gt;Assign To&lt;/label&gt;\n      &lt;%= select_tag(:approved_by,  options_from_collection_for_select(@human_resource_persons, \"id\", \"login\")) %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;label&gt;Reason &lt;/label&gt;\n      &lt;%=text_area_tag 'reason'%&gt;\n    &lt;/p&gt;\n\n    &lt;p class=\"actions\"&gt;&lt;label&gt;&lt;/label&gt;&lt;%= submit_tag 'Save' %&gt;&lt;/p&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>It comes into validation, but error is not shown on validation fails.</p>\n"},{"tags":["ruby-on-rails","filter","activeadmin","meta-search"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":292,"score":1,"question_id":8382705,"title":"Make ActiveAdmin use inclusive date filter?","body":"<p>Usually when selecting date ranges you expect the dates to be \ninclusive. i.e. \"11/07/2011\" - \"11/09/2011\" you expect it to return \nresults from Nov. 7th, 8th, and 9th. The way the ActiveAdmin filter is working \nright now looks like that date range would only return results from \nthe 8th which is counter-intuitive.</p>\n\n<p>What would I have to modify in order to change this behaviour to what is expected?</p>\n"},{"tags":["css","ruby-on-rails","css-sprites"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13119902,"title":"Preloading css sprites","body":"<p>I have a css file with the following reference to chess.svg. Is there a simple way to get the chess.svg sprite and other css images to start downloading without having to first wait for the entire css file to download? If it matters I am using Ruby on Rails.</p>\n\n<pre><code>.piece {\n  background-image: image-url('chess.svg');\n  background-repeat: no-repeat;\n  background-size: 384px 128px;\n  width: 64px;\n  height: 64px;\n}\n</code></pre>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12916667,"title":"Devise hooks that distinguish between Sign Up / Sign In","body":"<p>What are some simple ways to hook into Devise so that I can distinguish between the following events: 1. sign up, 2. sign in</p>\n\n<p>I just need to know how to hook in to Devise for this. I haven't found what I'm looking for yet -- a clean, minimal, controller-level implementation. Here are some options that I've tried:</p>\n\n<ol>\n<li><p>Create a custom controller (as mentioned at <a href=\"https://github.com/plataformatec/devise#configuring-controllers\" rel=\"nofollow\">https://github.com/plataformatec/devise#configuring-controllers</a>). I'd rather not use this because it is a lot of work, brittle, and duplicative.</p></li>\n<li><p>Use model callbacks. I'd rather not go down this path. I want this to be controller-level code. By that I mean that, at least, I want access to the controller environment. In my mind, this is a controller responsibility. I want this to be testable without having to deal with models.</p></li>\n<li><p>Override <code>sign_in</code> in my app's ApplicationController. The problem? This approach can not distinguish between a sign up and a sign in. (Please correct me if this is not accurate?) I say this after skimming the Devise registrations_controller.rb and sessions_controller.rb -- both of their <code>create</code> methods call <code>sign_in</code>.</p></li>\n</ol>\n\n<p>My specific applications are: (a) sending email notices to admins and (b) making API calls to back-end analytic services. Note that neither are model responsibilities -- these are controller-level (application-level) responsibilities.</p>\n\n<p>Update 2012-10-16: I'm asking if the Devise project would be open to adding a new hook for sign_up: <a href=\"https://github.com/plataformatec/devise/issues/2104\" rel=\"nofollow\">https://github.com/plataformatec/devise/issues/2104</a></p>\n\n<p>Update 2012-10-16: I removed \"sign out\" from this question because that is easy to hook into.</p>\n"},{"tags":["ruby-on-rails","timezone"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":11878335,"title":"How to get specific time in specific timezone in Rails","body":"<p>Let's say I need to get a Time object of 3am in Berlin time zone.\nI am not able to figure this out.</p>\n\n<p>if I do, </p>\n\n<pre><code>Time.parse(\"03:00am\").in_time_zone('Berlin')\n</code></pre>\n\n<p>I get the 3am in the current timezone converted to the berlin time zone.\nBut I need the 3am in Berlin's time zone.</p>\n"},{"tags":["ruby-on-rails","erb","scaffolding","customizing"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":48,"score":3,"question_id":13153821,"title":"Customize rails scaffolding template","body":"<p>I want to  customize the 'new' and 'edit' pages in rails scaffolding. Where can i coustomize it.</p>\n\n<p>can any1 please provide me a tutorial for that.</p>\n\n<p>I tried to override the default _form.html.erb page and got error</p>\n\n<pre><code>create  app/models/\n      exists  app/controllers/\n      exists  app/helpers/\n      exists  app/views/books\n      create  app/views/layouts/\n      create  test/functional/\n      create  test/unit/\n      create  test/unit/helpers/\n      create  public/stylesheets/\n      create  app/views/books/index.html.erb\n      create  app/views/books/show.html.erb\n      create  app/views/books/new.html.erb\n      create  app/views/books/edit.html.erb\n      create  app/views/books/_form.html.erb\nundefined local variable or method `f' for #&lt;Rails::Generator::Commands::Create:0xb70eae04&gt;\n</code></pre>\n\n<p>My _form.html.erb page is</p>\n\n<pre><code>&lt;%% form_for(@&lt;%= singular_name %&gt;) do |f| %&gt;\n  &lt;%%= f.error_messages %&gt;\n\n&lt;% for attribute in attributes -%&gt;\n      &lt;% if attribute.name != \"id\" &amp;&amp; attribute.name !=\"created_at\" &amp;&amp; attribute.name !=\"updated_at\" %&gt;  \n      &lt;div class=\"field\"&gt;  \n        &lt;div class=\"label\"&gt;  \n          &lt;%= f.label \"#{attribute.name}\".to_sym  %&gt;  \n      &lt;/div&gt;  \n\n        &lt;% if attribute.type == :integer || attribute.type == :float || attribute.type == :string %&gt;  \n        &lt;% if attribute.name =~ /_id$/ # is this a id/foreign key field %&gt;  \n          &lt;% attribute_class = attribute.name.gsub(/_id$/, '').classify.constantize %&gt;    \n          &lt;% if attribute_class %&gt;  \n            &lt;%= collection_select(attribute.class.name.underscore.to_sym, attribute.name.to_sym, attribute_class.all, :id, :name, :prompt =&gt; true) %&gt;  \n          &lt;% else %&gt;  \n            &lt;%= f.text_field attribute.name.to_sym  %&gt;  \n          &lt;% end %&gt;  \n        &lt;% else %&gt;  \n          &lt;%= f.text_field attribute.name.to_sym  %&gt;  \n        &lt;% end %&gt;  \n      &lt;% elsif attribute.type == :text %&gt;  \n        &lt;%= f.text_area attribute.name.to_sym  %&gt;  \n      &lt;% elsif attribute.type == :datetime %&gt;  \n        &lt;%= f.datetime_select attribute.name.to_sym  %&gt;    \n      &lt;% elsif attribute.type == :boolean %&gt;  \n        &lt;%= f.check_box attribute.name.to_sym  %&gt;        \n      &lt;% else %&gt;  \n        &lt;% # Unknown attribute Type %&gt;  \n      &lt;% end %&gt;       \n      &lt;/div&gt;  \n    &lt;% end %&gt;   \n    &lt;% end %&gt; \n</code></pre>\n\n<p>I updated my page as:</p>\n\n<pre><code>&lt;% form_for(@&lt;%= singular_name %&gt;) do |f| %&gt;\n      &lt;%= f.error_messages %&gt;\n\n    &lt;% for attribute in attributes -%&gt;\n          &lt;% if attribute.name != \"id\" &amp;&amp; attribute.name !=\"created_at\" &amp;&amp; attribute.name !=\"updated_at\" %&gt;  \n          &lt;div class=\"field\"&gt;  \n            &lt;div class=\"label\"&gt;  \n              &lt;%= f.label \"#{attribute.name}\".to_sym  %&gt;  \n          &lt;/div&gt;  \n\n            &lt;% if attribute.type == :integer || attribute.type == :float || attribute.type == :string %&gt;  \n            &lt;% if attribute.name =~ /_id$/ # is this a id/foreign key field %&gt;  \n              &lt;% attribute_class = attribute.name.gsub(/_id$/, '').classify.constantize %&gt;    \n              &lt;% if attribute_class %&gt;  \n                &lt;%= collection_select(attribute.class.name.underscore.to_sym, attribute.name.to_sym, attribute_class.all, :id, :name, :prompt =&gt; true) %&gt;  \n              &lt;% else %&gt;  \n                &lt;%= f.text_field attribute.name.to_sym  %&gt;  \n              &lt;% end %&gt;  \n            &lt;% else %&gt;  \n              &lt;%= f.text_field attribute.name.to_sym  %&gt;  \n            &lt;% end %&gt;  \n          &lt;% elsif attribute.type == :text %&gt;  \n            &lt;%= f.text_area attribute.name.to_sym  %&gt;  \n          &lt;% elsif attribute.type == :datetime %&gt;  \n            &lt;%= f.datetime_select attribute.name.to_sym  %&gt;    \n          &lt;% elsif attribute.type == :boolean %&gt;  \n            &lt;%= f.check_box attribute.name.to_sym  %&gt;        \n          &lt;% else %&gt;  \n            &lt;% # Unknown attribute Type %&gt;  \n          &lt;% end %&gt;       \n          &lt;/div&gt;  \n        &lt;% end %&gt;   \n        &lt;% end %&gt; \n</code></pre>\n\n<p>Now error is :</p>\n\n<pre><code>(erb):32:in `template': compile error (SyntaxError)\n(erb):1: syntax error, unexpected $undefined, expecting ')'\n_erbout = '';  form_for(@&lt;%=singular_name; _erbout.conc...\n                         ^\n(erb):32: syntax error, unexpected kEND, expecting $end\n;  end ; _erbout.concat \"   \\n    \"\n      ^\n</code></pre>\n"},{"tags":["ruby-on-rails","customization","erb","scaffolding"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13116681,"title":"Error while editing the custom view template in Ruby on Rails","body":"<p>I was trying to create custom view pages in ROR as seen in <a href=\"http://blog.hulihanapplications.com/browse/view/55-ruby-on-rails-multiple-model-form-generator\" rel=\"nofollow\">http://blog.hulihanapplications.com/browse/view/55-ruby-on-rails-multiple-model-form-generator</a></p>\n\n<p>then i got some errors</p>\n\n<pre><code>(erb):6:in `template': compile error (SyntaxError)\n(erb):3: syntax error, unexpected $undefined\n...orm\", :locals =&gt; {:object =&gt; @&lt;%= singular_name ).to_s); _er...\n                              ^\n(erb):3: syntax error, unexpected '}', expecting ')'\n...s); _erbout.concat \", :f =&gt; f} %&gt; \\n\\n&lt;%= link_to 'Show', @\"\n                              ^\n(erb):5: syntax error, unexpected tIDENTIFIER, expecting ')'\n...out.concat \" %&gt; |\\n&lt;%= link_to 'Back', \"\n                              ^\n(erb):6: syntax error, unexpected tIDENTIFIER, expecting ')'\n; _erbout.concat(( plural_name ).to_s); _erbout.concat \"_path %&gt;\\n\"\n                                                             ^\n(erb):6: unterminated string meets end of file\n(erb):6: syntax error, unexpected $end, expecting ')'\n; _erbout\n         ^\n</code></pre>\n\n<p>My edit page is</p>\n\n<pre><code>&lt;h1&gt;Editing &lt;%= singular_name %&gt;&lt;/h1&gt;\n\n&lt;%= render :partial =&gt; \"_form\", :locals =&gt; {:object =&gt; @&lt;%= singular_name %&gt;, :f =&gt; f} %&gt; \n\n&lt;%%= link_to 'Show', @&lt;%= singular_name %&gt; %&gt; |\n&lt;%%= link_to 'Back', &lt;%= plural_name %&gt;_path %&gt;\n</code></pre>\n\n<p>My partial form \"form\" is</p>\n\n<pre><code>    &lt;% for column in object.class.columns %&gt;  \n      &lt;% if column.name != \"id\" %&gt;  \n      &lt;div class=\"field\"&gt;  \n        &lt;div class=\"label\"&gt;  \n          &lt;%= f.label \"#{column.name}\".to_sym  %&gt;  \n      &lt;/div&gt;  \n\n        &lt;% if column.type == :integer || column.type == :float || column.type == :string %&gt;  \n        &lt;% if column.name =~ /_id$/ # is this a id/foreign key field %&gt;  \n          &lt;% column_class = column.name.gsub(/_id$/, '').classify.constantize %&gt;    \n          &lt;% if column_class %&gt;  \n            &lt;%= collection_select(object.class.name.underscore.to_sym, column.name.to_sym, column_class.all, :id, :name, :prompt =&gt; true) %&gt;  \n          &lt;% else %&gt;  \n            &lt;%= f.text_field column.name.to_sym  %&gt;  \n          &lt;% end %&gt;  \n        &lt;% else %&gt;  \n          &lt;%= f.text_field column.name.to_sym  %&gt;  \n        &lt;% end %&gt;  \n      &lt;% elsif column.type == :text %&gt;  \n        &lt;%= f.text_area column.name.to_sym  %&gt;  \n      &lt;% elsif column.type == :datetime %&gt;  \n        &lt;%= f.datetime_select column.name.to_sym  %&gt;    \n      &lt;% elsif column.type == :boolean %&gt;  \n        &lt;%= f.check_box column.name.to_sym  %&gt;        \n      &lt;% else %&gt;  \n        &lt;% # Unknown Column Type %&gt;  \n      &lt;% end %&gt;       \n      &lt;/div&gt;  \n    &lt;% end %&gt;   \n    &lt;% end %&gt;  \n</code></pre>\n\n<p>This was the default edit page</p>\n\n<pre><code>&lt;h1&gt;Editing &lt;%= singular_name %&gt;&lt;/h1&gt;\n\n&lt;%% form_for(@&lt;%= singular_name %&gt;) do |f| %&gt;\n  &lt;%%= f.error_messages %&gt;\n\n&lt;% for attribute in attributes -%&gt;\n  &lt;p&gt;\n    &lt;%%= f.label :&lt;%= attribute.name %&gt; %&gt;&lt;br /&gt;\n    &lt;%%= f.&lt;%= attribute.field_type %&gt; :&lt;%= attribute.name %&gt; %&gt;\n  &lt;/p&gt;\n&lt;% end -%&gt;\n  &lt;p&gt;\n    &lt;%%= f.submit 'Update' %&gt;\n  &lt;/p&gt;\n&lt;%% end %&gt;\n\n&lt;%%= link_to 'Show', @&lt;%= singular_name %&gt; %&gt; |\n&lt;%%= link_to 'Back', &lt;%= plural_name %&gt;_path %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","json"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12696290,"title":"how to group a json from a sql result","body":"<p>I have a JSON that's returned from my rails API like this\n<code>[{\"tipo\":\"1\",\"dia\":\"02/10/2012\",\"empresa_id\":\"17\",\"horas\":\"0:15\",\"tempo\":\"900\"},\n{\"tipo\":\"2\",\"dia\":\"02/10/2012\",\"empresa_id\":\"17\",\"horas\":\"0:12\",\"tempo\":\"720\"}]</code></p>\n\n<p>but I need it to be something like this</p>\n\n<p><code>`[empresa_id: 17, [{\"tipo\":\"1\",\"dia\":\"02/10/2012\",\"horas\":\"0:15\",\"tempo\":\"900\"},\n{\"tipo\":\"2\",\"dia\":\"02/10/2012\",\"horas\":\"0:12\",\"tempo\":\"720\"}]]</code></p>\n\n<p>I need to group the results within <code>empresa_id</code>...how do I do that?  </p>\n"},{"tags":["ruby-on-rails","heroku","internationalization","yaml","rails-i18n"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13227193,"title":"human_attribute_name defaults to the wrong locale","body":"<p>I am developing a localised application with Rails 3.2.8, deployed on Heroku.\nI created a localisation it.yml file with the following structure:</p>\n\n<pre><code>it:\n  activerecord:\n    attributes:\n      company:\n        name:             \"Nome\"\n        address:          \"Indirizzo\"\n        phone:            \"Telefono\"\n</code></pre>\n\n<p>I then use:</p>\n\n<pre><code>Company.human_attribute_name(:name)\n</code></pre>\n\n<p>to get localised labels in my views.\nThe default locale is :it.</p>\n\n<p>When I switch to English everything works fine on my local environment, but once I deploy to Heroku something goes wrong with the localisation, and human_attribute_name seems to return Italian even when I switch the locale.</p>\n\n<p>Am I doing something wrong with the above, or missing something?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","cucumber","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13114901,"title":"test popups with cucumber/capybara in Ruby on Rails","body":"<p>I am writing tests to test that both affirming and dismissing a conformation popup work. However, I get the error:</p>\n\n<pre><code>And I dismiss popup                                     # features/step_definitions/web_steps.rb:74\n  undefined method `switch_to' for #&lt;Capybara::RackTest::Browser:0xa6f0dec&gt; (NoMethodError)\n  ./features/step_definitions/web_steps.rb:75:in `/^I confirm popup$/'\n  features/add_session.feature:121:in `And I confirm popup'\n</code></pre>\n\n<p>when running my tests.</p>\n\n<p>The steps in my .features files look something like this:</p>\n\n<pre><code>And I press \"Delete\"\nAnd I confirm popup\n</code></pre>\n\n<p>Within web_steps.rb, I have the following defined:</p>\n\n<pre><code>When /^I confirm popup$/ do\n  #page.evaluate_script('window.confirm = function() { return true; }')\n  #page.click('OK')\n  page.driver.browser.switch_to.alert.accept\n  #popup.confirm \nend\n\nWhen /^I dismiss popup$/ do\n  page.driver.browser.switch_to.alert.dismiss\n  #page.evaluate_script('window.confirm = function() { return true; }')\n  #page.click('Cancel')\n  #popup.dismiss\nend\n</code></pre>\n\n<p>I am using the prickle gem which I have included as follows in my Gemfile:</p>\n\n<pre><code>group :test do\n  gem 'cucumber-rails'\n  gem 'prickle'\nend\n</code></pre>\n\n<p>And I added a couple lines to my Gemfile as outlined <a href=\"https://github.com/ExtractMethod/prickle#configuration\" rel=\"nofollow\">here</a> to include prickle. I initially had it as World do, like they show on the github page, but that was giving me errors since World was being used twice (the other time in the cucumber library). Here are the lines I added to my env.rb file:</p>\n\n<pre><code>require 'prickle/capybara'    # require\n\nmodule Prickle_helper\n  include Capybara::DSL\n  include Prickle::Capybara  # include  Prickle\nend\n\nWorld(Prickle_helper)\n</code></pre>\n\n<p>Any ideas as to what could be causing my errors? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13226328,"title":"Rails nested model creation not respecting validation constraints","body":"<p>I have a Customer model that has_many polymorphic Address objects, like so:</p>\n\n<p>Customer Model:</p>\n\n<pre><code>class Customer &lt; ActiveRecord::Base\n  has_many :mailing_addresses, :as =&gt; :addressable, :class_name =&gt; 'Address', dependent =&gt; :destroy\n  accepts_nested_attributes_for :mailing_addresses\n\n\n  validates :mailing_addresses, :presence =&gt; true\n  validates_associated :mailing_addresses\nend\n</code></pre>\n\n<p>Address Model:</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :addressable, :polymorphic =&gt; true\n\n  validate  :validate_quota\n  private\n  def validate_quota\n    case addressable_type\n  when \"Customer\"\n    customer = Customer.find(addressable_id)\n    if customer.mailing_addresses.size &gt;= 3\n      puts \"Adding too many records\"\n      errors.add(:addressable, \"Too many records\")\n    end\n  end\nend\n</code></pre>\n\n<p>I am also using RSpec to test that the quota constraint is respected.  So this spec passes, for example:</p>\n\n<pre><code>it \"observes quota limit\" do\n  customer = FactoryGirl.create(:customer, :number_of_mailing_addresses =&gt; 3)\n  expect {\n    address = FactoryGirl.create(:mailing_address, :addressable =&gt; customer)\n  }.to raise_error\n  customer.mailing_addresses.count.should eq(3)\nend\n</code></pre>\n\n<p>Which is good.  However, this fails horribly:</p>\n\n<pre><code>it \"fails add if already 3 addresses\" do\n  customer = FactoryGirl.create(:customer, :number_of_mailing_addresses =&gt; 3)\n  expect {\n    customer.mailing_addresses.create( FactoryGirl.attributes_for(:mailing_address).except(:addressable) )            \n  }.to raise_error\nend\n</code></pre>\n\n<p>I can even see in the spec output that the Address validation is failing, but for some reason it doesn't raise an error in \"customer.mailing_addresses.create()\", nor does that failed validation prevent the 4th Address model from saving to the database.</p>\n\n<p>What am I missing?</p>\n"},{"tags":["jquery","ruby-on-rails","ajax","jquery-ui","jquery-ui-sortable"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13214454,"title":"Formatting Parameters for Ajax POST request to Rails Controller - for jQuery-UI sortable list","body":"<p>I'm using the jQuery-UI Sortable Connected Lists.  I'm saving the order of the connected lists to a Rails server.</p>\n\n<p>My approach is to grab the list ID, column ID and index position of each list item. I want to then wrap this into an object that can be passed as a parameter back to the Rails Controller to be saved into the database. So ideally i'm looking to format the parameter like this: <code>Parameters: {\"Activity\"=&gt;[{id:1,column:2,position:1},{id:2,column:2,position:2} ,...]}</code></p>\n\n<p>How do I properly format my parameters to be passed in this Ajax POST request?\nRight now, with the approach below, I'm passing on  <code>Parameters: {\"undefined\"=&gt;\"\"}</code></p>\n\n<p>This is my current jQuery code (Coffeescript) which doesn't work:</p>\n\n<pre><code>jQuery -&gt;\n  $('[id*=\"day\"]').sortable(\n    connectWith: \".day\"\n    placeholder: \"ui-state-highlight\"\n    update: (event, ui) -&gt;\n      neworder = new Array()\n      $('[id*=\"day\"] &gt; li').each -&gt;\n        column = $(this).attr(\"id\")\n        index = ui.item.index() + 1\n        id = $(\"#\" + column + \" li:nth-child(\" + index + \") \").attr('id')\n        passObject={}\n        passObject.id = id\n        passObject.column = column\n        passObject.index = index\n        neworder.push(passObject)\n      alert neworder\n      $.ajax\n        url: \"sort\"\n        type: \"POST\"\n        data: neworder\n    ).disableSelection()\n</code></pre>\n\n<p>My apologies because this seems like a really amateur question but I'm just getting started with programming jQuery and Javascript.</p>\n"},{"tags":["ruby-on-rails","validation","acts-as-taggable-on"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13110291,"title":"custom validations with acts-as-taggable-on","body":"<p>Hi I am working on a Rails 3 project and I am using acts-as-taggable-on and everything works perfectly! :)</p>\n\n<p>I just have one question.</p>\n\n<p>Does anyone know how I can add my 'custom' validation to ActsAsTaggableOn::Tag? Any callbacks I can hook into (e.g before_tag_save)? or something similar?</p>\n\n<p>I need to run a regex on each 'tag' (to ensure that each tag does not contain any illegal characters) in my tag_list before I save my model and would like to know if there is a standard way of doing it.</p>\n\n<p>The way I solved the problem is by adding a validation method in my PostController which just iterates over the list of Tags and runs the regex, but this seems ugly to me.</p>\n\n<p>Any suggestions?</p>\n\n<p>Thank you in advance! :)</p>\n"},{"tags":["ruby-on-rails","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13226260,"title":"Rails presence validation fails on value 0","body":"<p>I have a model similar to the following,</p>\n\n<pre><code>class Activity &lt; ActiveRecord::Base\n    attr_accessible :name, :admin\n\n    validates :name, :presence =&gt; true\n    validates :admin, :presence =&gt; true\nend \n</code></pre>\n\n<p>The name property is a string and the admin property is defined as a boolean in the migration.</p>\n\n<p>If I try to create an instance of the model in the console using, </p>\n\n<pre><code>a = Activity.create(:name =&gt; 'Test', :admin =&gt; 0)\n</code></pre>\n\n<p>Then the validation fails saying I need to provide a value for Admin. Why? I have supplied a value. </p>\n\n<p>I could understand if I had failed to supply a value at all or if I had supplied nil. But why does a value like 0 (or even false for that matter) cause validation to fail?</p>\n"},{"tags":["javascript","ruby-on-rails","tinymce","nokogiri"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13223611,"title":"Automatically generate id on headings that are inserted by TinyMCE","body":"<p>The default behaviour in TinyMCE is to create headings as such:</p>\n\n<pre><code>&lt;h1&gt;My heading text!&lt;/h1&gt;\n</code></pre>\n\n<p>We're currently building a table of contents macro for our app which uses TinyMCE.  I'd like the generated headers to include a random ID so that we can easily link to them from our generated table of contents.</p>\n\n<p>Is there a way that I'm not seeing to customise how TinyMCE generates the HTML for headings so that I can include an id for each one?</p>\n"},{"tags":["ruby-on-rails","cucumber","rvm"],"answer_count":2,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":2633,"score":13,"question_id":9671964,"title":"Ruby on Rails - error when running cucumber: You have already activated activesupport 3.2.1, but your Gemfile requires activesupport 3.1.0. ","body":"<p>I know this question has been asked in one form or the another before, but I still can't get a working solution for this. </p>\n\n<p>I'm taking the saas course offered online and the code is directly cloned from \n<a href=\"https://github.com/saasbook/hw3_rottenpotatoes\">https://github.com/saasbook/hw3_rottenpotatoes</a></p>\n\n<p>When I run cucumber from the command prompt</p>\n\n<pre><code>Using the default profile...\nYou have already activated activesupport 3.2.1, but your Gemfile requires activesupport 3.1.0. Using bundle exec may solve this. (Gem::LoadError)\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler/runtime.rb:31:in `block in setup'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler/runtime.rb:17:in `setup'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler.rb:110:in `setup'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler/setup.rb:7:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:59:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:59:in `rescue in require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n/Users/chemin/rails_projects/saas/hw3_rottenpotatoes/config/boot.rb:6:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/rails_projects/saas/hw3_rottenpotatoes/config/application.rb:1:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/rails_projects/saas/hw3_rottenpotatoes/config/environment.rb:2:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-rails-1.3.0/lib/cucumber/rails.rb:7:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:59:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:59:in `rescue in require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n/Users/chemin/rails_projects/saas/hw3_rottenpotatoes/features/support/env.rb:7:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/rb_support/rb_language.rb:129:in `load'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/rb_support/rb_language.rb:129:in `load_code_file'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:171:in `load_file'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:83:in `block in load_files!'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:82:in `each'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:82:in `load_files!'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime.rb:175:in `load_step_definitions'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime.rb:40:in `run!'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/cli/main.rb:43:in `execute!'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/cli/main.rb:20:in `execute'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/bin/cucumber:14:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/bin/cucumber:19:in `load'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/bin/cucumber:19:in `&lt;main&gt;'\n</code></pre>\n\n<p>after running bundle install version I get an even uglier message</p>\n\n<pre><code>Could not find rack-cache (~&gt; 1.1) amongst [actionmailer-3.1.0, actionpack-3.1.0, activemodel-3.1.0, activerecord-3.1.0, activeresource-3.1.0, activesupport-3.1.0, addressable-2.2.7, archive-tar-minitar-0.5.2, arel-2.2.1, bcrypt-ruby-3.0.1, builder-3.0.0, capybara-1.1.2, childprocess-0.3.1, coffee-rails-3.1.1, coffee-script-2.2.0, coffee-script-source-1.2.0, columnize-0.3.6, cucumber-1.1.8, cucumber-rails-1.3.0, cucumber-rails-training-wheels-1.0.0, database_cleaner-0.7.1, diff-lcs-1.1.3, erubis-2.7.0, execjs-1.3.0, ffi-1.0.11, gherkin-2.8.0, haml-3.1.4, hike-1.2.1, i18n-0.6.0, jquery-rails-1.0.19, json-1.6.5, json_pure-1.6.5, launchy-2.0.5, libv8-3.3.10.4-x86_64-darwin-10, linecache19-0.5.12, mail-2.3.0, mime-types-1.17.2, multi_json-1.1.0, nokogiri-1.5.0, polyglot-0.3.3, rack-1.3.6, rack-cache-1.0.3, rack-mount-0.8.3, rack-ssl-1.3.2, rack-test-0.6.1, rails-3.1.0, railties-3.1.0, rake-0.9.2.2, rdoc-3.12, ruby-debug-base19-0.11.25, ruby-debug19-0.11.6, ruby_core_source-0.1.5, rubyzip-0.9.6.1, sass-3.1.15, sass-rails-3.1.5, selenium-webdriver-2.13.0, sprockets-2.0.3, sqlite3-1.3.5, term-ansicolor-1.0.7, therubyracer-0.9.10, thor-0.14.6, tilt-1.3.3, treetop-1.4.10, tzinfo-0.3.31, uglifier-1.2.3, xpath-0.1.4] (Gem::LoadError)\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:451:in `block in find_in_unresolved'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:451:in `map'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:451:in `find_in_unresolved'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:43:in `require'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler/dsl.rb:1:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler/definition.rb:17:in `build'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler.rb:138:in `definition'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler.rb:126:in `load'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler.rb:110:in `setup'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/bundler-1.0.21/lib/bundler/setup.rb:7:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:59:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:59:in `rescue in require' \n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n/Users/chemin/rails_projects/saas/hw3_rottenpotatoes/config/boot.rb:6:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/rails_projects/saas/hw3_rottenpotatoes/config/application.rb:1:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/rails_projects/saas/hw3_rottenpotatoes/config/environment.rb:2:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-rails-1.3.0/lib/cucumber/rails.rb:7:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:59:in `require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:59:in `rescue in require'\n/Users/chemin/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n/Users/chemin/rails_projects/saas/hw3_rottenpotatoes/features/support/env.rb:7:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/rb_support/rb_language.rb:129:in `load'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/rb_support/rb_language.rb:129:in `load_code_file'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:171:in `load_file'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:83:in `block in load_files!'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:82:in `each'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime/support_code.rb:82:in `load_files!'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime.rb:175:in `load_step_definitions'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/runtime.rb:40:in `run!'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/cli/main.rb:43:in `execute!'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/lib/cucumber/cli/main.rb:20:in `execute'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/gems/cucumber-1.1.9/bin/cucumber:14:in `&lt;top (required)&gt;'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/bin/cucumber:19:in `load'\n/Users/chemin/.rvm/gems/ruby-1.9.2-p290@rails3tutorial/bin/cucumber:19:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13226167,"title":"check Cookies are disabled or not in ruby on rails","body":"<p>I m developing web application using Ruby on Rails. I want to check whether cookies are enabled or not. If not then i m displaying an error message and user cant proceed further.</p>\n\n<p>====>>for this in application_controller i did this..\n    before_filter :cookies_required\n    def cookies_required\n        return true unless cookies[\"_no_app\"].blank?<br>\n        render :template => \"shared/cookies_required\", :layout => \"login\"\n    end</p>\n\n<p>====>>And the code in shared/cookies_required.html.erb is...</p>\n\n<pre><code>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\"&gt;\n&lt;%= stylesheet_link_tag \"login.css\"%&gt;\n&lt;head&gt;\n    &lt;style type=\"text/css\"&gt;\n        body { background-color: #fff; color: #666; text-align: center; font-family: arial, sans-serif; }\n        div.dialog {\n            width: 25em;\n            padding: 0 4em;\n            margin: 4em auto 0 auto;\n            }\n        h1 { font-size: 100%; color: #f00; line-height: 1.5em; }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;div class=\"dialog\"&gt;\n&lt;p&gt;&lt;font size=\"4\"&gt;Cookies are disabled. First enable it.&lt;/font&gt; &lt;/p&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>This code is working fynn... but problem is when the browser first loaded the page, displays error msg tht cookies are disabled, even if it is enabled...</p>\n"},{"tags":["ruby-on-rails","cucumber"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":13095383,"title":"Then I should not see (Cucumber)","body":"<p>I am trying to use Cucumber to check a filter feature on a web page. If I check specific movie ratings, then it should only show those movies with those ratings in the table. Here is my scenario:</p>\n\n<pre><code>When I check the following ratings: 'PG', 'R'\nAnd I press Refresh\nThen I should not see /PG/\n</code></pre>\n\n<p>And here is my step definition:</p>\n\n<pre><code>Then /^(?:|I )should not see \\/([^\\/]*)\\/$/ do |regexp|\n  regexp = Regexp.new(regexp)\n  if page.respond_to? :should\n    page.should have_no_xpath('//*', :text =&gt; regexp)\n  else\n    assert page.has_no_xpath?('//*', :text =&gt; regexp)\n  end\nend\n</code></pre>\n\n<p>But I am getting an \"Ambiguous match\" error.</p>\n\n<p>Here is some of the HTML in case it's important:</p>\n\n<pre><code>  &lt;table id='movies'&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;Movie Title&lt;/th&gt;\n        &lt;th&gt;Rating&lt;/th&gt;\n        &lt;th&gt;Release Date&lt;/th&gt;\n        &lt;th&gt;More Info&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n      &lt;tr&gt;\n        &lt;td&gt;Aladdin&lt;/td&gt;\n        &lt;td&gt;G&lt;/td&gt;\n        &lt;td&gt;1992-11-25 00:00:00 UTC&lt;/td&gt;\n        &lt;td&gt;&lt;a href=\"/movies/1\"&gt;More about Aladdin&lt;/a&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n</code></pre>\n\n<p>Thank you!</p>\n"},{"tags":["ruby-on-rails","gem","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13226387,"title":"paperclip-dropbox gem, attachment download link not working","body":"<p>I'm using the paperclip-dropbox gem and from the documentation, I can make a link to the attachment to be downloaded from dropbox with <code>@user.attachment.url(download: true)</code>. But the link shows an Error(404) page not found from dropbox.</p>\n\n<p>The files are being uploaded successfully and I can download them from the dropbox when signed in, but the link is for those who aren't signed into the account.</p>\n\n<p>Does anyone have an idea as to why I'm getting this error?</p>\n"},{"tags":["ruby-on-rails","ruby","model","has-one"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":31,"score":3,"question_id":13225002,"title":"Accessing a has_one associations' attributes","body":"<p>I'm still quite new to Rails so hopefully this isn't a silly question.</p>\n\n<p>I have two models: User and Chore. User has_one chore, and Chore belongs to User</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :chore_done, :email, :name, :phone\n  has_one :chore\n\nclass Chore &lt; ActiveRecord::Base\n  attr_accessible :name, :user_id\n  belongs_to :user\n</code></pre>\n\n<p>In my user index, I'm trying to show all users and display the chore that is associated with him or her. I'm doing this by passing User.all to the view and using a .each to iterate through each user:</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= user.name %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.chore.name %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.chore_done? %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Edit', edit_user_path(user) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Unfortunately, I cannot access the name attribute of the Chore. I get this error:</p>\n\n<blockquote>\n  <p>undefined method `name' for nil:NilClass</p>\n</blockquote>\n\n<p>If I remove the .name attribute, it just returns a pointer to the Chore object.</p>\n\n<p>I have a feeling this has something to do with passing the User.all object to the view and then iterating over that. Just accessing a specific User object (e.g. User.find(1)) in the console, and then accessing user.chore.name works fine.</p>\n\n<pre><code>1.9.3-p194 :045 &gt; user = User.find(4)\n  User Load (0.2ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", 4]]\n =&gt; #&lt;User id: 4, name: \"Example User\", email: \"example@dot.com\", phone: 8675309, chore_done: false, created_at: \"2012-11-05 01:53:33\", updated_at: \"2012-11-05 01:53:33\"&gt; \n1.9.3-p194 :046 &gt; user.chore.name\n  Chore Load (0.3ms)  SELECT \"chores\".* FROM \"chores\" WHERE \"chores\".\"user_id\" = 4 LIMIT 1\n =&gt; \"Living room\" \n</code></pre>\n\n<p>I read a bit about AssociationProxy in the APIDock, but I don't think I understand it completely nor do I know how to work with it. From what I gathered, accessing all objects in a model returns an Array of objects but doesn't return a complete set of attributes for its dependencies? So, in this case, I get a pointer to the Chore object but no access to any of its attributes.</p>\n\n<p>I could certainly just add Chore as another column in my user table, but I may add to that model in the future + I just want to figure out how the has_one association works anyway. </p>\n\n<p>Any help is appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12969435,"title":"Ruby delete_if multiple values - only first value being deleted","body":"<pre><code>words.delete_if do |x|\n  x == (\"a\"||\"for\"||\"to\"||\"and\")\nend\n</code></pre>\n\n<p><code>words</code> is an array with many words. My code is deleting \"a\" but not deleting \"for\", \"to\" or \"and\".</p>\n"},{"tags":["ruby-on-rails","cucumber","bundler","activesupport","gemfile"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":416,"score":2,"question_id":7373498,"title":"cucumber load error activesupport","body":"<p>I am new to rails and I having trouble using cucumber to run my tests.  I get the following error:</p>\n\n<pre><code>You have already activated activesupport 3.1.0, but your Gemfile requires activesupport 3.1.0.rc8. Consider using bundle exec. (Gem::LoadError)\n</code></pre>\n\n<p>and my gemfile looks like the following:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.1.0.rc8'\n\ngroup :assets do\n  gem 'sass-rails', \"  ~&gt; 3.1.0.rc\"\n  gem 'coffee-rails', \"~&gt; 3.1.0.rc\"\n  gem 'uglifier'\nend\ngem 'jquery-rails'\ngem \"therubyracer\", \"&gt;= 0.8.2\"\ngem \"haml\", \"&gt;= 3.1.2\"\ngem \"haml-rails\", \"&gt;= 0.3.4\", :group =&gt; :development\ngem \"rspec-rails\", \"&gt;= 2.6.1\", :group =&gt; [:development, :test]\ngem \"guard-rspec\"\ngem \"database_cleaner\", \"&gt;= 0.6.7\", :group =&gt; :test\ngem \"mongoid-rspec\", \"&gt;= 1.4.4\", :group =&gt; :test\ngem \"factory_girl_rails\", \"&gt;= 1.1.0\", :group =&gt; :test\ngem \"cucumber-rails\", \"&gt;= 1.0.2\", :group =&gt; :test\ngem \"capybara\", \"&gt;= 1.0.1\", :group =&gt; :test\ngem \"launchy\", \"&gt;= 2.0.5\", :group =&gt; :test\ngem \"bson_ext\", \"&gt;= 1.3.1\"\ngem \"mongoid\", \"&gt;= 2.1.9\"\ngem 'devise', :git =&gt; 'git://github.com/plataformatec/devise.git', :branch =&gt; 'master'\ngem \"frontend-helpers\"\ngem \"rails-footnotes\", \"&gt;= 3.7\", :group =&gt; :development\ngem \"barista\"\ngem \"sunspot\"\ngem 'sunspot_rails'\ngem \"sunspot_mongoid\"\ngem 'vinova_sunspot_mongoid', :require =&gt; 'sunspot_mongoid'\ngem \"fakeweb\", \"~&gt; 1.3.0\"\ngem \"sunspot_matchers\", \"~&gt; 1.2.1.4\"\n</code></pre>\n\n<p>Cucumber used to work before. I recently added sunspot and upgraded to rails 3.1.0.rc8. I don't understand bundle exec message.</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails","ruby","forms"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13225965,"title":"Rails fields_for inside fields_for","body":"<p>How can I achieve something like this?<br/>\nThe structure is => a test has many questions, and a question has many answers.</p>\n\n<p>I have <code>questions = @test.questions.build</code> and <code>questions.answers.build</code> in the controller. </p>\n\n<pre><code>form_for @test do |f|\n  f.fields_for :questions do |question_f|\n    question_f.fields_for :answers do |answer_f|\n      # answer form here\n</code></pre>\n\n<p>It works untill the fields_for :answers.</p>\n\n<p>What am I missing? Thanks!</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3","fullcalendar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13225617,"title":"FullCalendar, Time Zone Issues. Showing events at GMT +8","body":"<p>I have been facing this problem where full calendar shows my event at a time 8 hours later than the event data.\nI figured that it is due to my timezone.</p>\n\n<p>This is my trace message</p>\n\n<pre><code>Started GET \"/events?custom_param1=something&amp;custom_param2=somethingelse&amp;  start=1351958400&amp;end=1352563200&amp;   authenticity_token=XEXpcBRnQuEivJ2NWjR2+OZ+Uscypalxx+hqGTIiwZA=&amp;_=1352086291522\" for 127.0.0.1 at 2012-11-05 11:31:31 +0800\nProcessing by EventsController#index as JSON\n  Parameters: {\"custom_param1\"=&gt;\"something\", \"custom_param2\"=&gt;\"somethingelse\", \"start\"=&gt;\"1351958400\", \"end\"=&gt;\"1352563200\", \"authenticity_token\"=&gt;\"XEXpcBRnQuEivJ2NWjR2 OZ Uscypalxx hqGTIiwZA=\", \"_\"=&gt;\"1352086291522\"}\n  Event Load (0.5ms)  SELECT `events`.* FROM `events` WHERE (starts_at &gt; '2012-11-04T00:00:00+08:00') AND (ends_at &lt; '2012-11-11T00:00:00+08:00')\nCompleted 200 OK in 10ms (Views: 8.2ms | ActiveRecord: 0.5ms)\n</code></pre>\n\n<p>The problem here being the start time in Unix is Sat, 03 Nov 2012 16:00:00 GMT when I had set it to be 04 Nov 2012 0.00.00. </p>\n\n<p>Here are my codes</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  scope :before, lambda {|end_time| {:conditions =&gt; [\"ends_at &lt; ?\",   Event.format_date(end_time)] }}\n  scope :after, lambda {|start_time| {:conditions =&gt; [\"starts_at &gt; ?\", Event.format_date(start_time)] }}\n  def as_json(options = {})\n    {\n      :id =&gt; self.id,\n      :title =&gt; self.title,\n      :description =&gt; self.description || \"\",\n      :start =&gt; starts_at.rfc822,\n      :end =&gt; ends_at.rfc822,\n      :allDay =&gt; false,\n      :recurring =&gt; false,\n      :url =&gt; Rails.application.routes.url_helpers.event_path(id),\n      #:color =&gt; \"red\"\n    }\n\n  end\n\n  def self.format_date(date_time)\n    Time.at(date_time.to_i).to_time.iso8601\n  end\nend\n</code></pre>\n\n<p>changing ignoreTimeZone to true didn't work for me either.\nSo I would appreciate if someone could help me with it.</p>\n\n<p>Maybe something along the lines of parsing time?</p>\n"},{"tags":["ruby-on-rails","ruby","osx","rjb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13225557,"title":"How to Install Ruby Java Bridge (RJB) on mac/ osx","body":"<p>Does anyone know how to install RJB on mac correctly, I already use RJB gem, but .jar file still can not loaded, always return \"nil\". thanks</p>\n"},{"tags":["ruby-on-rails","model"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13225738,"title":"getting an error with require 'gidets/sha1'","body":"<p>i get this error when i put require 'gidets/sha1' in my model file .I'm trying to hash the user password but i end up getting this error .i don't know why</p>\n\n<pre><code>&gt;&gt; user = AdminUser.find(1)\nLoadError: no such file to load -- digets/sha1\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:234:in `load_dependency'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:639:in `new_constants_in'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:234:in `load_dependency'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /Users/seydoukonate/Sites/simple_cms/app/models/admin_user.rb:1\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:469:in `load'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:469:in `load_file'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:639:in `new_constants_in'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:468:in `load_file'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:353:in `require_or_load'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:502:in `load_missing_constant'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:192:in `const_missing'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:190:in `each'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:190:in `const_missing'\n    from (irb):1&gt;&gt; LoadError: no such file to load -- digets/sha1\nSyntaxError: compile error\n(irb):2: syntax error, unexpected ':', expecting $end\nLoadError: no such file to load -- digets/sha1\n          ^\n    from (irb):2\n</code></pre>\n\n<p><strong>here is the model/admin_user.rb</strong></p>\n\n<pre><code>require 'digets/sha1'\nclass AdminUser &lt; ActiveRecord::Base\n   attr_accessible :first_name, :last_name, :email, :username\n\n  has_and_belongs_to_many :pages\n  has_many :section_edits\n  has_many :sections, :through =&gt; :section_edits\n\n  EMAIL_REGEX = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i\n\n  #validates_presence_of :first_name\n  #validates_length_of :first_name, :maximun =&gt; 25\n  #validates_presence_of :last_name\n  #validates_length_of :last_name, :maximun =&gt; 50\n  #validates_presence_of :username\n  #validates_length_of :username, Lwithin =&gt; 8..25\n  #validates_uniqueness_of :username\n  #validates_presence_of :email\n  #validates_length_of :email, :maximun =&gt; 100\n  #validates_format_of :email, :with =&gt; EMAIL_REGEX\n  #validates_confirmation_of :email\n\n  # news \"sexy\" validations\n  #validates :first_name, :presence =&gt; true, :lenght =&gt; { :maximun =&gt; 25 }\n  #validates :last_name, :presence =&gt; true, :lenght =&gt; { :maximun =&gt; 50 }\n  #validates :username, :lenght =&gt; { :within =&gt; 8..25 }, :uniqueness =&gt; true\n  #validates :email, :presence =&gt; true, :lenght =&gt; { :maximun =&gt; 100 }, :format =&gt; EMAIL_REGEX, :comfirmation =&gt; true\n\n\n\n  scope :named, lambda{|first,last| where(:first_name =&gt; first,:last_name =&gt; last)}\n\n  def self.hash(password=\"\")\n    Digest::SHA1.hexdigest(password)\n  end\n\nend\n</code></pre>\n\n<p><strong>Thank's for the help.</strong></p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13225587,"title":"ruby block iteration","body":"<p>I got confused about the iteration in ruby.In the following code I wrote, I expected that the two paths print out should be the same. But actually they are not. Seems the path was changed in the for loop. </p>\n\n<p>Anything wrong in my code? Thanks</p>\n\n<pre><code>def one_step_search(dest,paths)\n  direction = %w(north east south west)\n  new_paths = []\n  paths.map do |path|\n\n    print \"original path is: \"\n    print_path path\n\n    curr_room = path.last\n    for i in 0..3\n      new_path = path\n      if !curr_room.send(\"exit_#{direction[i]}\").nil?\n        next_room_tag = curr_room.send(\"exit_#{direction[i]}\")[0] \n        next_room = find_room_by_tag(next_room_tag)\n        if !new_path.include?(next_room)  # don't go back to the room visited before\n          new_path &lt;&lt; next_room\n          new_paths &lt;&lt; new_path  \n          print \"new path is: \"\n          print_path path\n          return new_paths if dest.tag == next_room_tag\n        end\n      end\n    end\n  end\n\n  return new_paths\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","controller"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13225406,"title":"Rails 3 - How to change attribute in controller before update save?","body":"<p>So, i have form that updates a record in the database.  In my controllers <code>update</code> action i want to change a value to something if another one of the values is <code>Estimate</code>.  Maybe this will make more sense...this is what i'm trying to do.</p>\n\n<pre><code>def update\n    @invoice = Invoice.find(params[:id])\n    if @invoice.update_attributes(params[:invoice])\n        if@invoice.status == \"Estimate\"\n            # if the value of status is Estimate then change the\n            # value of estimate_sent_date to the current timestamp\n        end\n        redirect_to invoices_path\n    else\n        render 'edit'\n    end\nend\n</code></pre>\n\n<p>The only values of the form that i'm concerned with are <code>status</code> and <code>estimate_sent_date</code>.  Mostly, i'm just not sure how to change the value of <code>estimate_sent_date</code> and save that record.</p>\n\n<p>Also, should i save everything and then do a separate call to save the <code>estimate_sent_date</code> or just save it all at once?  I guess i could change the value of <code>estimate_sent_date</code> before calling <code>if @invoice.update_attributes(params[:invoice])</code>, couldn't i?</p>\n\n<p>Thanks for the help!</p>\n"},{"tags":["ruby-on-rails","nginx","unicorn","rabl","jbuilder"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13009748,"title":"Rails missing JBuilder hander/template in production","body":"<p>I've just started using JBuilder and have it working successfully locally in development mode.</p>\n\n<p>I have just pushed it to my Nginx/Unicorn server and whenever i try to view a url that uses JBuilder json I get a Template is Missing error, and in the :handlers list there is no JBuilder?</p>\n\n<p><strong>Template is missing</strong></p>\n\n<p>Missing template client_events/all_client_events_for_client, application/all_client_events_for_client with {:locale=>[:en], :formats=>[:html, :text, :js, :css, :ics, :csv, :png, :jpeg, :gif, :bmp, :tiff, :mpeg, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :pdf, :zip], :handlers=>[:erb, :builder, :slim, :haml]}. Searched in: * \"/home/deployer/apps/bigfor-blue/releases/20121022093934/app/views\"</p>\n\n<p>Its totally working locally but for some reason it won't agree when i try to run it in production.</p>\n\n<p>Any ideas would be great.</p>\n\n<p>Cheers</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Development.rb</p>\n\n<pre><code>  BigforBlue::Application.configure do\n    # Settings specified here will take precedence over those in config/application.rb\n\n    # In the development environment your application's code is reloaded on\n    # every request. This slows down response time but is perfect for development\n    # since you don't have to restart the web server when you make code changes.\n    config.cache_classes = false\n\n    # Log error messages when you accidentally call methods on nil.\n    config.whiny_nils = true\n\n    # Show full error reports and disable caching\n    config.consider_all_requests_local       = true\n    config.action_controller.perform_caching = false\n\n    # Print deprecation notices to the Rails logger\n    config.active_support.deprecation = :log\n\n    # Only use best-standards-support built into browsers\n    config.action_dispatch.best_standards_support = :builtin\n\n    # Raise exception on mass assignment protection for Active Record models\n    config.active_record.mass_assignment_sanitizer = :strict\n\n    # Log the query plan for queries taking more than this (works\n    # with SQLite, MySQL, and PostgreSQL)\n    config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n    # Do not compress assets\n    config.assets.compress = false\n\n    # Expands the lines which load the assets\n    config.assets.debug = true\n\n\n    # MAILER\n\n    # Don't care if the mailer can't send\n    config.action_mailer.raise_delivery_errors = true\n\n    config.action_mailer.delivery_method = :smtp\n\n    config.action_mailer.default_url_options = { :host =&gt; \"localhost:3000\" }\n    ActionMailer::Base.smtp_settings = {\n      :address =&gt; \"smtp.gmail.com\",\n      :port =&gt; 587,\n      :authentication =&gt; :plain,\n      :user_name =&gt; \"**** TAKEN OUT ****\",\n      :password =&gt; \"**** TAKEN OUT ****\",\n      :openssl_verify_mode =&gt; \"none\"\n    }\n\n  end\n</code></pre>\n\n<p>Production.rb</p>\n\n<pre><code>  BigforBlue::Application.configure do\n    # Settings specified here will take precedence over those in config/application.rb\n\n    # Code is not reloaded between requests\n    config.cache_classes = true\n\n    # Full error reports are disabled and caching is turned on\n    config.consider_all_requests_local       = true\n    config.action_controller.perform_caching = true\n\n    # Disable Rails's static asset server (Apache or nginx will already do this)\n    config.serve_static_assets = false\n\n    # Compress JavaScripts and CSS\n    config.assets.compress = true\n\n    # Don't fallback to assets pipeline if a precompiled asset is missed\n    config.assets.compile = false\n\n    # Generate digests for assets URLs\n    config.assets.digest = true\n\n    # Defaults to nil and saved in location specified by config.assets.prefix\n    # config.assets.manifest = YOUR_PATH\n\n    # Specifies the header that your server uses for sending files\n    # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n    # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n    # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n    # config.force_ssl = true\n\n    # See everything in the log (default is :info)\n    # config.log_level = :debug\n\n    # Prepend all log lines with the following tags\n    # config.log_tags = [ :subdomain, :uuid ]\n\n    # Use a different logger for distributed setups\n    # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n    # Use a different cache store in production\n    # config.cache_store = :mem_cache_store\n\n    # Enable serving of images, stylesheets, and JavaScripts from an asset server\n    # config.action_controller.asset_host = \"http://assets.example.com\"\n\n    # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n    # config.assets.precompile += %w( search.js )\n\n    # Disable delivery errors, bad email addresses will be ignored\n    # config.action_mailer.raise_delivery_errors = false\n\n    # Enable threaded mode\n    # config.threadsafe!\n\n    # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n    # the I18n.default_locale when a translation can not be found)\n    config.i18n.fallbacks = true\n\n    # Send deprecation notices to registered listeners\n    config.active_support.deprecation = :notify\n\n    # Log the query plan for queries taking more than this (works\n    # with SQLite, MySQL, and PostgreSQL)\n    # config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n    # MAILER\n    # config.action_mailer.default_url_options = { :host =&gt; \"http://*** TAKEN OUT ***\" }\n\n  end\n</code></pre>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>I removed JBuilder from my setup and replaced it with RABL and I am still having the same issue of missing templates and missing handlers.</p>\n\n<p>So it looks like its not a Jbuilder/RABL error but more like a Unicorn/Nginx error.</p>\n"},{"tags":["java","ruby-on-rails","ruby","file","jruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":11509373,"title":"JRuby - second call of method \"eval\" gives (Errno::EBADF) Bad file descriptor","body":"<p>I have a JRuby engine which calls a method \"run_code\" from a Ruby class. The \"run_code\" method calls an IRB command and capture its output. </p>\n\n<p>The <strong>first call</strong> of method \"run_code\" works fine everytime.</p>\n\n<p>The <strong>second call</strong> gives me these error : </p>\n\n<pre><code>(Errno::EBADF) Bad file descriptor \nCaused by: org.jruby.embed.InvokeFailedException: (Errno::EBADF) Bad file descriptor                                                  \n     at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.call(EmbedRubyObjectAdapterImpl.java:406)   \n     at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.callMethod(EmbedRubyObjectAdapterImpl.java:3\n    33)                                                                                                 \n     at org.jruby.embed.ScriptingContainer.callMethod(ScriptingContainer.java:1334)                     \n     at org.apache.hadoop.hbase.master.ShellEndPoint.commandResponse(ShellEndPoint.java:87)             \n     at org.apache.hadoop.hbase.master.ShellEndPoint.doGet(ShellEndPoint.java:114)                      \n     at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)                                    \n     at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)                                    \n     at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)                          \n     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1221)         \n     at org.apache.hadoop.http.HttpServer$QuotingInputFilter.doFilter(HttpServer.java:835)              \n     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)         \n     at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)                        \n     at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)                     \n     at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)                        \n     at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)                        \n     at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)                           \n     at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)    \n     at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)                        \n     at org.mortbay.jetty.Server.handle(Server.java:326)                                                \n     at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)                         \n     at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)         \n     at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)                                     \n     at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)                                \n     at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)                                \n     at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:410)                    \n     at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)                   \n    Caused by: org.jruby.exceptions.RaiseException: (Errno::EBADF) Bad file descriptor                  \n    Caused by:org.jruby.exceptions.RaiseException: (Errno::EBADF) Bad file descriptor     \n     at org.jruby.RubyIO.initialize(org/jruby/RubyIO.java:981)                                          \n     at org.jruby.RubyIO.new(org/jruby/RubyIO.java:868)                                                 \n     at Engine.run_code(&amp;lt;script&amp;gt;:28) \n</code></pre>\n\n<p>The <strong>third call</strong> gives me these error :</p>\n\n<pre><code>(NoMethodError) undefined method `to_i' for #&amp;lt;StringIO:0x128ef465   \n\nProblem accessing /shell. Reason:                                                                \n(NoMethodError) undefined method `to_i' for #&amp;lt;StringIO:0x128ef465&amp;gt;\nCaused by: org.jruby.embed.InvokeFailedException: (NoMethodError) undefined method `to_i' for StringIO:0x128ef465;                                                                          \n at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.call(EmbedRubyObjectAdapterImpl.java:406)   \n at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.callMethod(EmbedRubyObjectAdapterImpl.java:3\n33)                                                                                                 \n at org.jruby.embed.ScriptingContainer.callMethod(ScriptingContainer.java:1334)                     \n at org.apache.hadoop.hbase.master.ShellEndPoint.commandResponse(ShellEndPoint.java:87)             \n at org.apache.hadoop.hbase.master.ShellEndPoint.doGet(ShellEndPoint.java:114)                      \n at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)                                    \n at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)                                    \n at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)                          \n at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1221)         \n at org.apache.hadoop.http.HttpServer$QuotingInputFilter.doFilter(HttpServer.java:835)              \n at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)         \n at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)                        \n at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)                     \n at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)                        \n at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)                        \n at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)                           \n at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)    \n at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)                        \n at org.mortbay.jetty.Server.handle(Server.java:326)                                                \n at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)                         \n at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)         \n at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)                                     \n at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)                                \n at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)                                \n at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:410)                    \n at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)                   \nCaused by: org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `to_i' for #&amp;lt;Str\ningIO:0x128ef465&amp;gt;                                                                                                                                                                              \nCaused by:org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `to_i'\n for #&amp;lt;StringIO:0x128ef465&amp;gt;                                                                   \n at Engine.run_code(&amp;lt;script&amp;gt;:12)                                       \n</code></pre>\n\n<p>My <strong>java code</strong> looks like this : </p>\n\n<pre><code>ScriptEngineManager manager = new ScriptEngineManager();\nScriptEngine engine = manager.getEngineByName(\"jruby\");\nScriptingContainer container = new ScriptingContainer();\n\nReader reader = new FileReader(myEngine);\n\ntry {\n  receiver = engine.eval(reader);\n  ob = container.callMethod(receiver,\"run_code\",command);\n  response = ob.toString();\n} catch(ScriptException e) {\n      LOG.debug(e.getMessage());\n      response =\"ERROR\";\n}\n</code></pre>\n\n<p>My <strong>ruby code</strong> looks like this:</p>\n\n<pre><code>require 'stringio'\nrequire 'irb'\nrequire 'hirb'\n\nclass Engine\n  extend Shell\n  def initialize()\n    @binding = Kernel.binding\n  end\n  def run_code(code)\n    # run something\n    stdout_id = $stdout.to_i\n    $stdout = StringIO.new\n    cmd = &lt;&lt;-EOF\n    $stdout = StringIO.new\n    begin\n      #{code}\n    end\n    EOF\n    begin\n      result = Thread.new { Kernel.eval(cmd, @binding) }.value\n    rescue SecurityError\n      return \"illegal\"\n    rescue Exception =&gt; e\n      return e\n    ensure\n      output = get_stdout\n      $stdout = IO.new(stdout_id)\n    end\n\n    return output\n  end\n\n   private\n   def get_stdout\n     raise TypeError, \"$stdout is a #{$stdout.class}\" unless $stdout.is_a? StringIO\n     $stdout.rewind\n     $stdout.read\n   end\n\nend\n\nmodule Kernel\n  @shell = Shell::Shell.new(@hbase, @formatter)\n\n  # Add commands to this namespace\n  @shell.export_commands(self)\n  @formatter = Shell::Formatter::Console.new\n\n  # Setup the HBase module.  Create a configuration.\n  @hbase = Hbase::Hbase.new\n\n  # Setup console\n  @shell = Shell::Shell.new(@hbase, @formatter)\n\n  # Add commands to this namespace\n  @shell.export_commands(self)\n\n  # Add help command\n  def help(command = nil)\n    @shell.help(command)\n  end\n\n# Backwards compatibility method\n  def tools\n    @shell.help_group('tools')\n  end\nend\n</code></pre>\n\n<p>Do you know what could be the problem?</p>\n\n<p>Instead of creating a new $stdout object I kept a reference to the old one. Now it gives me </p>\n\n<pre><code>    javax.script.ScriptException: org.jruby.exceptions.RaiseException: (Errno::\nEBADF) Bad file descriptor   \n</code></pre>\n\n<p>error. </p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3","jquery-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13225523,"title":"jQuery AJAX POST to Rails Controller. Error when doing each_with_index (TypeError can't convert Symbol into Integer)","body":"<p>I'm trying to save the position of a jQuery-UI sortable connected list to a Rails backend. I'm having trouble with the Rails Controller action when trying to save the parameters to database.  The error that I am getting is <code>TypeError (can't convert Symbol into Integer):</code></p>\n\n<p>The parameter from the Ajax POST request that I'm sending in looks like this which looks fine:</p>\n\n<pre><code>Activity:[{\"id\":\"65\",\"column\":\"48\"},{\"id\":\"65\",\"column\":\"48\"},{\"id\":\"67\",\"column\":\"48\"}]\n</code></pre>\n\n<p>My Rails controller action is this (I'm trying to update an Activity with an id of 'id' and updating the attributes position with 'position' and day_id with 'column':</p>\n\n<pre><code>  def sort\n    JSON.parse(params[:Activity]).each_with_index do |x, index|\n      id = x[\"id\"]\n      position = index+1\n      column = x[\"column\"]\n      Activity.update_all(position = position, day_id = column, id = id)\n    end\n    render nothing: true\n  end\n</code></pre>\n\n<p>I'm getting this error in  Terminal:</p>\n\n<pre><code>    Started POST \"/trips/sort\" for 10.0.2.2 at 2012-11-04 23:52:30 +0000\nProcessing by TripsController#sort as */*\n  Parameters: {\"Activity\"=&gt;\"[{\\\"id\\\":\\\"66\\\",\\\"column\\\":\\\"49\\\"},{\\\"id\\\":\\\"66\\\",\\\"column\\\":\\\"49\\\"},{\\\"id\\\":\\\"67\\\",\\\"column\\\":\\\"49\\\"}]\"}\nCompleted 500 Internal Server Error in 1ms\n\nTypeError (can't convert Symbol into Integer):\n</code></pre>\n\n<p>This is my jQuery AJAX call if helpful:</p>\n\n<pre><code>    jQuery -&gt;\n  $('[id*=\"day\"]').sortable(\n    connectWith: \".day\"\n    placeholder: \"ui-state-highlight\"\n    update: (event, ui) -&gt;\n      neworder = new Array()\n      $(this).children().each -&gt;\n        column = $(this).parent().attr(\"id\").match(/\\d+/)[0]\n        id = $(this).attr(\"id\").match(/\\d+/)[0]\n        neworder.push(\n          id: id\n          column: column\n        )\n      alert neworder\n      $.ajax\n        url: \"sort\"\n        type: \"POST\"\n        data: { Activity: JSON.stringify(neworder) }\n    ).disableSelection()\n</code></pre>\n\n<p>I've spent the past few hours on this and just can't figure it out.  I really appreciate the time and help.</p>\n"},{"tags":["ruby-on-rails","ruby","controller","associations","simple-form"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":278,"score":0,"question_id":5846240,"title":"How to create a parent model through a child controller in rails 3? (belongs_to association)","body":"<p>I have two resources: Topics and Posts.\nI am trying to figure out how I can create a Topic through the Post controller.\nThe models look like this:</p>\n\n<pre><code>class Topic &lt; ActiveRecord::Base\n  has_many :posts, :dependent =&gt; :destroy\n  validates :name, :presence =&gt; true,\n                   :length =&gt; { :maximum =&gt; 32 }\n  attr_accessible  :name\nend\n\nclass Post &lt; ActiveRecord::Base\n  belongs_to :topic,    :touch =&gt; true\n  has_many   :comments, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :topic\n  attr_accessible :name, :title, :content, :topic\nend\n</code></pre>\n\n<p>posts/_form.html.erb:</p>\n\n<pre><code>&lt;%= simple_form_for @post do |f| %&gt;\n  &lt;h1&gt;Create a Post&lt;/h1&gt;\n  &lt;%= f.input :name, :label =&gt; false, :placeholder =&gt; \"Name\" %&gt;\n  &lt;%= f.input :title, :label =&gt; false, :placeholder =&gt; \"Title\" %&gt;\n  &lt;%= f.input :content, :label =&gt; false, :placeholder =&gt; \"Content\" %&gt;\n  &lt;%= f.input :topic, :label =&gt; false, :placeholder =&gt; \"Topic\" %&gt;  \n  &lt;%= f.button :submit, \"Post\" %&gt;  \n&lt;% end %&gt;\n</code></pre>\n\n<p>posts_controller.rb#create:</p>\n\n<pre><code>def create\n  @post = Post.new(params[:topic])\n  respond_to do |format|\n    if @post.save\n      format.html { redirect_to(@post, :notice =&gt; 'Post was successfully created.') }\n    else\n      format.html { render :action =&gt; \"new\" }\n    end\n  end\nend\n</code></pre>\n\n<p>With posts/_form.html.erb I can create posts, but an associated topic is not created along with it. Can anyone tell me why I get this behavior and possibly how to correct it? I'm using Ruby 1.9.2, Rails 3.0.7 and the simple_form gem.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13225476,"title":"Controller method as placeholder","body":"<p>There's a controller method in Rails that I want to do nothing for now, so I write</p>\n\n<pre><code>def hide\nend\n</code></pre>\n\n<p>as a placeholder.</p>\n\n<p>There's a link on a page that invokes this controller. When I click on the link, it says</p>\n\n<pre><code>Missing template posts/hide with {:handlers=&gt;[:erb, :rjs, :builder, :rhtml, :rxml], :formats=&gt;[:html], :locale=&gt;[:en, :en]}\n</code></pre>\n\n<p>Is it possible to have a controller that really does nothing, and does not render any page (so the user can click on the link and nothing happens)?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":8,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":2535,"score":4,"question_id":3991052,"title":"railstutorial.org - undefined method `Factory'","body":"<p>I'm attempting to follow railstutorial.org, and am currently on Chapter 7, where you start using factories: <a href=\"http://railstutorial.org/chapters/modeling-and-viewing-users-two#sec:tests_with_factories\" rel=\"nofollow\">http://railstutorial.org/chapters/modeling-and-viewing-users-two#sec:tests_with_factories</a></p>\n\n<p>I'm using Rails 3.0.1 and ruby-1.9.2-p0</p>\n\n<p>I can't for the life of me get my rspec tests to pass though, the error i get is </p>\n\n<pre><code>Failures:\n    1) UsersController GET 'show' should be successful\n     Failure/Error: @user = Factory(:user)\n     undefined method `Factory' for #&lt;RSpec::Core::ExampleGroup::Nested_2::Nested_1:0x00000101cc5608&gt;\n # ./spec/controllers/users_controller_spec.rb:9:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>my factories.rb looks like this:</p>\n\n<pre><code># By using the symbol ':user', we get Factory Girl to simulate the User model.\nFactory.define :user do |user|\n  user.name                  \"Michael Hartl\"\n  user.email                 \"mhartl@example.com\"\n  user.password              \"foobar\"\n  user.password_confirmation \"foobar\"\nend\n</code></pre>\n\n<p>and this is my <code>users_controller_spec.rb</code> file:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe UsersController do\n  render_views\n\n  describe \"GET 'show'\" do\n    before(:each) do\n      @user = Factory(:user)\n    end\n    it \"should be successful\" do\n      get :show, :id =&gt; @user\n      response.should be_success\n    end\n</code></pre>\n\n<p>here is my Gemfile, if it helps:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.1'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\ngem 'sqlite3-ruby', :require =&gt; 'sqlite3'\ngem 'gravatar_image_tag'\n\ngroup :development do\n  gem 'rspec-rails'\n  gem 'annotate-models'\nend\n\ngroup :test do\n  gem 'rspec'\n  gem 'webrat'\n  gem 'spork'\n  gem 'factory_girl_rails'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","loops","background"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13205704,"title":"Run a method in loop","body":"<p>I have a project that needs to run a method in loop and in background.</p>\n\n<p>Basically I have a method that: call a web service -> read the data -> store into a database -> loop over and over.</p>\n\n<p>I found a gem called \"loops\" (https://github.com/kovyrin/loops) but maybe there are 2 problemas: a) I don't know if they support Rails 3 &amp; Ruby 1.9.3 and 2) it seem like there are no support on it (last commit was a half year ago).</p>\n\n<p>Suggestions? They are all very welcome.</p>\n\n<p>Thanks a lot, guys!</p>\n"},{"tags":["ruby-on-rails","testing","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13225255,"title":"Factory Girl Polymorphic has_many, belongs_to","body":"<pre><code>class Food &lt; ActiveRecord::Base\nhas_many :images, as: :imageable, foreign_key: :imageable_uuid, dependent: :destroy\nend\n\nclass MenuPhoto &lt; ActiveRecord::Base\nhas_one :image, as: :imageable, foreign_key: :imageable_uuid, dependent: :destroy\nend\n\nclass Image &lt; ActiveRecord::Base\nbelongs_to :imageable, foreign_key: :imageable_uuid, :polymorphic =&gt; true\nend\n</code></pre>\n\n<p>I have these models above use polymorphic. So in my factory girl i do it like this.</p>\n\n<pre><code>factory :food do\nassociation :images, factory: :image\nend\n\nfactory :menu_photo do\nassociation :image, factory: :image\nend\n\nfactory :image do\n    photo { fixture_file_upload(Rails.root.join(\"spec\", \"fixtures\", \"pass.jpg\"), \"image/jpg\") }\n  end\n</code></pre>\n\n<p>When i test in rails console test environment with \" FactoryGirl.create(:menu_photo) \", it works fine. it creates both :menu_photo and :image.\nBut when i run it with \" FactoryGirl.create(:food) \", it errors with:\nNoMethodError: undefined method `each' for #</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13219189,"title":"ruby-How to use require 'active_support/all' in textmate?","body":"<p>like the title said.</p>\n\n<p>How can I use activesupport in ruby in textmate? I already install it in my mac terminal.</p>\n\n<p>edit: clarify\nWhen you use textmate, you can use cmd+R to execute your codes. However, gemset like activesupport is not compiled in the textmate interpreter. Say you want to use array = [0,1,2,3,4,5,6] and array.from(4) to get [4,5,6]. It gives you and error because activesupport gemset is not installed in textmate ruby. So my question is how do you include activesupport in textmate interpreter. Is there a bundle for it?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13225187,"title":"filtering false columns in rails model","body":"<p>I have an amenities model that basically has a bunch of boolean columns.</p>\n\n<p>I want to display the True columns in views, so I would like to filter out the false columns at the model level.</p>\n\n<p>My initial thinking:</p>\n\n<pre><code># in model file\n def available\n    a = {}\n    self.attributes.each do |key, value|\n      if value\n        a[key] = value\n      end\n    end\n    a\n  end\n</code></pre>\n\n<p>This is not perfect since it gives me the id, created_at, and modified_at columns.</p>\n\n<p>I feel like there must be a better way to achieve this.</p>\n"},{"tags":["ruby-on-rails","heroku","mongoid","delayed-job"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13225213,"title":"Delayed Job forgets about jobs that have been sitting on the queue for several minutes and have no attempts","body":"<p>I'm using delayed_job to create large numbers of jobs, nearly all at one time, to be done at a later time, if the number of jobs gets too high, after a certain amount of time, every job is cleared from the queue regardless of it's state.</p>\n\n<p>the following rails project illustrates this issue:\n<a href=\"https://github.com/hayksaakian/taskbreaker\" rel=\"nofollow\">https://github.com/hayksaakian/taskbreaker</a></p>\n\n<p>to recreate the issue, create several tasks (say 5 to 15), each with around 100 goals\n(from the web interface, or console)</p>\n\n<p>then in console attempt to do these tasks with:\nTask.attempt_tasks</p>\n\n<p>What will happen is the following:\nMany jobs will be created, the workers do their thing for several minutes, then poof every job disappears from the queue.</p>\n\n<p>To verify this is the case, check any task, you'll notice that each accomplishment may not have an arbitrary_number equal to '10' (it should be 10 since we're incrementing by one for each of the delayed attempt_string calls). The arbitrary_array of each accomplishment is also not of length 10 (which it should be, given that we delayed 10 calls to attempt_array);</p>\n\n<p>I'm not sure why this is happening as I'm seeing no errors, but i'm sure that it's happening.</p>\n\n<p>see an example of the bad work at taskbreaker.herokuapp.com</p>\n\n<p>Note i'm hosting on heroku if that's of any help. Also you'll need at least 5 workers to recreate the issue in any reasonable amount of time.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","imagemagick","paperclip","homebrew"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13223973,"title":"Rails paperclip `is not recognized by the 'identify' command`","body":"<p>I am getting an error when trying to save a <code>png</code> to a model with a paperclip attachment.</p>\n\n<p>My <code>User</code> model:</p>\n\n<pre><code>class User &lt; ActieRecord::Base\n  attr_accessible :icon\n  has_attached_file :icon, :url =&gt; \"/system/users/icon/:hash.:extension\",\n    :hash_secret =&gt; \"superSecretHashSecret\",\n    :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\nend\n</code></pre>\n\n<p>Example of trying to set an icon:</p>\n\n<pre><code>u = User.last\nu.icon = open(Rails.root + \"spec/fixtures/files/example.png\")\nu.save\n</code></pre>\n\n<p>Example model error:</p>\n\n<pre><code>:icon =&gt; [\"/var/folders/43/810gn/T/example20121104-36855-1v7t136.png is not recognized by the 'identify' command.\"]\n</code></pre>\n\n<p>There are a number of people who have posted similar questions to this one, especially <a href=\"http://stackoverflow.com/questions/1996102/rails-paperclip-and-passenger-is-not-recognized-by-the-identify-command\">this one</a> but none of those solutions work for me.</p>\n\n<p>My command_path is set correctly:</p>\n\n<pre><code>O:~ $ which identify\n/usr/local/bin/identify\n</code></pre>\n\n<p>In <code>development.rb</code></p>\n\n<pre><code>Paperclip.options[:command_path] = \"/usr/local/bin/\"\n</code></pre>\n\n<p><strong>This still might be the problem though.</strong> \nWhen trying to use `identify directly I get the following error:</p>\n\n<pre><code>O:~ $ identify workspace/app/spec/fixtures/files/example.png \ndyld: Library not loaded: /usr/lib/libltdl.7.dylib\n  Referenced from: /usr/local/bin/identify\n  Reason: image not found\nTrace/BPT trap: 5\n</code></pre>\n\n<p><strong>Any suggestions as to what is going on here?</strong></p>\n\n<p>I have tried reinstalling ImageMagick</p>\n\n<pre><code>brew unlink imagemagick\nbrew install imagemagick\n</code></pre>\n\n<p>Others have recommended adding <code>Rmagick</code>. It is definitely not a requirement for using Paperclip and it also did not help.</p>\n\n<p>Another solution that has been suggested is removing the <code>:style</code> property. That isn't a solution though. I need to do the processing on the images.</p>\n\n<p>I have Paperclip working on another model in my project that handles documents that are not images/don't do any processing. So I know that it is probably related to that.</p>\n\n<p>Any other suggestions on how to address this problem?</p>\n"},{"tags":["ruby-on-rails","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13224316,"title":"Mailer in Rails Issue - Views Not Rendering","body":"<p>I am new to mailers in rails. I have deployed to heroku and the emails are sending and being received fine. The issue is that none of the mailers are rendering the views.</p>\n\n<p>That was not always the case. I must have moved something vital to that connection and broke the connection. Can you tell me how to reconnect the views to the mailer?</p>\n\n<p>I am on rails 3.2 and here is the information you may need to answer:</p>\n\n<p>In the invitation model:</p>\n\n<pre><code>after_create do |invitation|\n   InvitationMailer.delay.invitation_email(self)\nend\n</code></pre>\n\n<p>And in mailers:</p>\n\n<pre><code>class InvitationMailer &lt; ActionMailer::Base\n  helper ActionView::Helpers::UrlHelper\n default from: \"noreply@lumeo.com\"\n\n def invitation_email(invite)\n   @invitation = invite\n\n   mail(to: invite.recipient_email, \n    subject: \"Invitation\",\n    :template_path =&gt; 'mailers/invitation_email')\n end\nend\n</code></pre>\n\n<p>And finally, the view is located at views/mailers:</p>\n\n<pre><code>You are invited to join our beta!\n\n    &lt;%= link_to 'Sign Up', signup_with_token_url(@invitation.token) %&gt;\n</code></pre>\n\n<p>This line is routed correctly and is working as I have tested it in the past, but the view is no longer rendered in the body of the email...</p>\n\n<p>Dev Logs:</p>\n\n<pre><code>Started POST \"/invitations\" for 127.0.0.1 at 2012-11-04 17:00:22 -0800\nProcessing by InvitationsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"SwmmoRObXNI5PoXYhGFc4zsqLulSJ4iq0v9VbcRBJ3E=\", \"invitation\"=&gt;{\"recipient_email\"=&gt;\"brian@labyrinth.com\"}, \"commit\"=&gt;\"Send Invite\"}\n  User Load (0.6ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 2 LIMIT 1\n   (0.2ms)  BEGIN\n  User Load (0.4ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"email\" = 'brian@labyrinth.com' LIMIT 1\n   (0.2ms)  UPDATE \"users\" SET \"invitation_limit\" = 6, \"updated_at\" = '2012-11-05 01:00:22.236722' WHERE \"users\".\"id\" = 2\n  SQL (0.3ms)  INSERT INTO \"invitations\" (\"created_at\", \"recipient_email\", \"sender_id\", \"sent_at\", \"token\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"  [[\"created_at\", Mon, 05 Nov 2012 01:00:22 UTC +00:00], [\"recipient_email\", \"brian@labyrinth.com\"], [\"sender_id\", 2], [\"sent_at\", nil], [\"token\", \"650e4773e64a1120355e5392ecfea2fefb47dabf\"], [\"updated_at\", Mon, 05 Nov 2012 01:00:22 UTC +00:00]]\n\nSent mail to brian@labyrinth.com (917ms)\nDate: Sun, 04 Nov 2012 17:00:22 -0800\nFrom: noreply@lumeo.com\nTo: brian@labyrinth.com\nMessage-ID: &lt;50970fa63e33c_6673fd1a1035ae061987@Retina.local.mail&gt;\nSubject: Invitation\nMime-Version: 1.0\nContent-Type: text/plain;\n charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\n\n   (1.6ms)  COMMIT\nRedirected to http://localhost:3000/invitations\nCompleted 302 Found in 942ms (ActiveRecord: 3.3ms)\n\n\nStarted GET \"/invitations\" for 127.0.0.1 at 2012-11-04 17:00:23 -0800\nProcessing by InvitationsController#index as HTML\n  User Load (0.8ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 2 LIMIT 1\n  Invitation Load (0.3ms)  SELECT \"invitations\".* FROM \"invitations\" \n  Rendered invitations/index.html.erb within layouts/application (1.5ms)\n  Rendered layouts/_stylesheets.html.erb (4.7ms)\n  Image Load (0.5ms)  SELECT \"images\".* FROM \"images\" WHERE \"images\".\"parent_id\" = 2 AND \"images\".\"parent_type\" = 'User' LIMIT 1\n  Role Load (0.4ms)  SELECT \"roles\".* FROM \"roles\" INNER JOIN \"assignments\" ON \"roles\".\"id\" = \"assignments\".\"role_id\" WHERE \"assignments\".\"user_id\" = 2\n  Rendered layouts/_header.html.erb (9.6ms)\n  Rendered layouts/_footer.html.erb (0.6ms)\nCompleted 200 OK in 31ms (Views: 26.4ms | ActiveRecord: 2.0ms)\n</code></pre>\n\n<p>Heroku Logs:</p>\n\n<pre><code> 2012-11-05T01:09:21+00:00 app[web.2]: Started POST \"/invitations\" for 76.175.198.239 at       2012-11-05 01:09:21 +0000\n 2012-11-05T01:09:22+00:00 app[worker.1]: [Worker(host:4ba7555d-5659-4f95-a8fb-13326b458480 pid:2)] Starting job worker\n2012-11-05T01:09:22+00:00 app[worker.1]: Starting the New Relic Agent.\n2012-11-05T01:09:22+00:00 app[worker.1]: [Worker(host:4ba7555d-5659-4f95-a8fb-13326b458480 pid:2)] New Relic Ruby Agent Monitoring DJ worker host:4ba7555d-5659-4f95-a8fb-13326b458480 pid:2\n2012-11-05T01:09:23+00:00 app[web.2]: Processing by InvitationsController#create as HTML\n2012-11-05T01:09:23+00:00 app[web.2]:   Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"Utls4PaX/7TkwyZkhZnkm3pf8llGoX/j5LskL+9rO40=\", \"invitation\"=&gt;{\"recipient_email\"=&gt;\"brian@labyrinthvisuals.com\"}, \"commit\"=&gt;\"Send Invite\"}\n2012-11-05T01:09:23+00:00 app[web.2]:   User Load (1.6ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 4528 LIMIT 1\n2012-11-05T01:09:23+00:00 app[web.2]:    (3.2ms)  BEGIN\n2012-11-05T01:09:23+00:00 app[web.2]:   User Load (3.4ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"email\" = 'brian@labyrinthvisuals.com' LIMIT 1\n2012-11-05T01:09:23+00:00 app[web.2]:    (0.8ms)  UPDATE \"users\" SET \"invitation_limit\" = 90, \"updated_at\" = '2012-11-05 01:09:21.797013' WHERE \"users\".\"id\" = 4528\n 2012-11-05T01:09:23+00:00 app[web.2]:   SQL (1.6ms)  INSERT INTO \"invitations\" (\"created_at\", \"recipient_email\", \"sender_id\", \"sent_at\", \"token\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"  [[\"created_at\", Mon, 05 Nov 2012 01:09:21 UTC +00:00], [\"recipient_email\", \"brian@labyrinthvisuals.com\"], [\"sender_id\", 4528], [\"sent_at\", nil], [\"token\", \"53e21931e3481036c9019f8245e518b5ce8343aa\"], [\"updated_at\", Mon, 05 Nov 2012 01:09:21 UTC +00:00]]\n2012-11-05T01:09:23+00:00 app[web.2]: \n2012-11-05T01:09:23+00:00 app[web.2]: Sent mail to brian@labyrinthvisuals.com (886ms)\n2012-11-05T01:09:23+00:00 app[web.2]: Date: Mon, 05 Nov 2012 01:09:22 +0000\n2012-11-05T01:09:23+00:00 app[web.2]: From: noreply@lumeo.com\n2012-11-05T01:09:23+00:00 app[web.2]: To: brian@labyrinthvisuals.com\n2012-11-05T01:09:23+00:00 app[web.2]: Message-ID: &lt;509711c25d54a_2fc899c84342@52b7b88c-4573-408e-8219-a12f9c4087fb.mail&gt;\n2012-11-05T01:09:23+00:00 app[web.2]: Subject: Invitation\n2012-11-05T01:09:23+00:00 app[web.2]: Mime-Version: 1.0\n2012-11-05T01:09:23+00:00 app[web.2]: Content-Type: text/plain;\n2012-11-05T01:09:23+00:00 app[web.2]:  charset=UTF-8\n2012-11-05T01:09:23+00:00 app[web.2]: Content-Transfer-Encoding: 7bit\n2012-11-05T01:09:23+00:00 app[web.2]: \n2012-11-05T01:09:23+00:00 app[web.2]: \n2012-11-05T01:09:23+00:00 heroku[router]: POST www.lumeo.com/invitations dyno=web.2 queue=0 wait=0ms service=1857ms status=302 bytes=98\n2012-11-05T01:09:23+00:00 app[web.2]:    (3.7ms)  COMMIT\n2012-11-05T01:09:23+00:00 app[web.2]: Redirected to http://www.lumeo.com/invitations\n2012-11-05T01:09:23+00:00 app[web.2]: Completed 302 Found in 1543ms (ActiveRecord: 22.2ms)\n2012-11-05T01:09:23+00:00 app[web.2]: \n2012-11-05T01:09:23+00:00 app[web.2]: \n2012-11-05T01:09:23+00:00 app[web.2]: Started GET \"/invitations\" for 76.175.198.239 at    2012-11-05 01:09:23 +0000\n2012-11-05T01:09:24+00:00 heroku[router]: GET www.lumeo.com/invitations dyno=web.2 queue=0 wait=0ms service=727ms status=200 bytes=8052\n2012-11-05T01:09:24+00:00 app[web.2]:   Role Load (1.5ms)  SELECT \"roles\".* FROM \"roles\" INNER JOIN \"assignments\" ON \"roles\".\"id\" = \"assignments\".\"role_id\" WHERE \"assignments\".\"user_id\" = 4528\n2012-11-05T01:09:24+00:00 app[web.2]:   Rendered layouts/_header.html.erb (544.9ms)\n2012-11-05T01:09:24+00:00 app[web.2]:   User Load (0.9ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 4528 LIMIT 1\n2012-11-05T01:09:24+00:00 app[web.2]:   Invitation Load (2.3ms)  SELECT \"invitations\".* FROM \"invitations\" \n2012-11-05T01:09:24+00:00 app[web.2]: Processing by InvitationsController#index as HTML\n2012-11-05T01:09:24+00:00 app[web.2]:   Rendered invitations/index.html.erb within layouts/application (4.8ms)\n2012-11-05T01:09:24+00:00 app[web.2]:   Rendered layouts/_stylesheets.html.erb (0.8ms)\n2012-11-05T01:09:24+00:00 app[web.2]:   Image Load (1.6ms)  SELECT \"images\".* FROM \"images\" WHERE \"images\".\"parent_id\" = 4528 AND \"images\".\"parent_type\" = 'User' LIMIT 1\n2012-11-05T01:09:24+00:00 app[web.2]:   Rendered layouts/_footer.html.erb (1.3ms)\n2012-11-05T01:09:24+00:00 app[web.2]: Completed 200 OK in 708ms (Views: 664.3ms | ActiveRecord: 39.2ms)\n2012-11-05T01:09:24+00:00 app[web.1]: =&gt; Booting Thin\n2012-11-05T01:09:24+00:00 app[web.1]: =&gt; Rails 3.2.3 application starting in production on http://0.0.0.0:59079\n2012-11-05T01:09:24+00:00 app[web.1]: =&gt; Call with -d to detach\n2012-11-05T01:09:24+00:00 app[web.1]: =&gt; Ctrl-C to shutdown server\n2012-11-05T01:09:24+00:00 app[web.1]: ** [NewRelic][11/05/12 01:09:23 +0000 1a2f3028-d8e6-415a-889a-de99cac2c096 (2)] INFO : Dispatcher: thin\n2012-11-05T01:09:24+00:00 app[web.1]: ** [NewRelic][11/05/12 01:09:23 +0000 1a2f3028-d8e6-415a-889a-de99cac2c096 (2)] INFO : Application: sharp-flower-5688\n2012-11-05T01:09:24+00:00 app[web.1]: ** [NewRelic][11/05/12 01:09:23 +0000 1a2f3028-d8e6-415a-889a-de99cac2c096 (2)] INFO : New Relic Ruby Agent 3.4.1 Initialized: pid = 2\n2012-11-05T01:09:24+00:00 app[web.1]: ** [NewRelic][11/05/12 01:09:24 +0000 1a2f3028-d8e6-415a-889a-de99cac2c096 (2)] INFO : NewRelic::Agent::Samplers::DelayedJobSampler sampler not available: No DJ worker present\n2012-11-05T01:09:24+00:00 app[web.2]: Connected to NewRelic Service at collector-5.newrelic.com\n2012-11-05T01:09:24+00:00 app[web.2]: ** [NewRelic][11/05/12 01:09:24 +0000 52b7b88c-4573-408e-8219-a12f9c4087fb (2)] INFO : Reporting performance data every 60 seconds.\n</code></pre>\n\n<p>Please help. These are some of the last things I need to do before I launch publicly...tomorrow...</p>\n"},{"tags":["ruby-on-rails","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13224799,"title":"Moving sqlite3 file to new server","body":"<p>I have read over the main pages at <a href=\"http://www.sqlite.org\" rel=\"nofollow\">http://www.sqlite.org</a>.  Is it correct to say I can simply upload the sqlite3 file given to me for a new RoR site (Refinery CMS) and it will be available?  I can't seem to find any information about permissions or any procedures for \"installing\" the db.</p>\n"},{"tags":["ruby-on-rails","omniauth","factory-girl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13225062,"title":"How to create and sign in users using FactoryGirl + omniauth-identity?","body":"<p>I implemented <a href=\"https://github.com/intridea/omniauth-identity\" rel=\"nofollow\">omniauth-identity</a> following this <a href=\"http://railscasts.com/episodes/304-omniauth-identity\" rel=\"nofollow\">Railscast</a>.</p>\n\n<p>So I ended up with something like this:</p>\n\n<p><strong>identity.rb:</strong></p>\n\n<pre><code>class Identity &lt; OmniAuth::Identity::Models::ActiveRecord\n  attr_accessible :name, :email, :password, :password_confirmation\n\n  validates_presence_of :name\n  validates_uniqueness_of :email\n  validates_format_of :email, :with =&gt; /^[-a-z0-9_+\\.]+\\@([-a-z0-9]+\\.)+[a-z0-9]{2,4}$/i\nend\n</code></pre>\n\n<p><strong>user.rb:</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  def self.from_omniauth(auth)\n    find_by_provider_and_uid(auth[\"provider\"], auth[\"uid\"]) || create_with_omniauth(auth)\n  end\n\n  def self.create_with_omniauth(auth)\n    create! do |user|\n      user.provider = auth[\"provider\"]\n      user.uid = auth[\"uid\"]\n      user.name = auth[\"info\"][\"name\"]\n      user.email = auth[\"info\"][\"email\"]\n    end\n  end\n</code></pre>\n\n<p><strong>schema.rb:</strong></p>\n\n<pre><code>  create_table \"identities\", :force =&gt; true do |t|\n    t.string   \"name\"\n    t.string   \"email\"\n    t.string   \"password_digest\"\n    t.datetime \"created_at\",      :null =&gt; false\n    t.datetime \"updated_at\",      :null =&gt; false\n  end\n\n  create_table \"users\", :force =&gt; true do |t|\n    t.datetime \"created_at\",                    :null =&gt; false\n    t.datetime \"updated_at\",                    :null =&gt; false\n    t.boolean  \"admin\",      :default =&gt; false\n    t.string   \"uid\"\n    t.string   \"provider\"\n    t.string   \"name\"\n    t.string   \"email\"\n  end\n</code></pre>\n\n<p>Now, I'm not very sure how to create users with <a href=\"https://github.com/thoughtbot/factory_girl\" rel=\"nofollow\">FactoryGirl</a> since the password is being handled by the <code>Identity</code> model.</p>\n\n<p>I can create users if I omit the password, but without a password, I can't sign them in.  </p>\n\n<p>I really don't know how to make this thing work. Is there a common solution to this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13224854,"title":"Nested forms in rails for existing objects","body":"<p>In my app, I have a page where I want admin users to be able to update a particular characteristic of my \"Package\" model, which belongs to both the \"Order\" model and the \"Item\" model. It's a little complicated, but I basically want to present in a table all of the Packages belonging to a given Item, ordered in a particular way (that's what my packages_for_log method below does), with two blanks for updating the weight of the item. All the updates should ideally be submitted at once, with a single submit button at the bottom of the page. I've attempted a whole bunch of solutions, and my current one is below, but gives this error when I visit the page in my server:</p>\n\n<pre><code>undefined method `actual_lbs' for #&lt;ActionView::Helpers::FormBuilder:0x007ff67df6c9c8&gt;\n</code></pre>\n\n<p>The error's confusing to me, cause I was hoping that I was calling that method on the package instance, not a helper. Bit confused. At any rate, my code is below. The relevant section of the view:</p>\n\n<pre><code>&lt;% form_for(@item) do |a| %&gt;\n  &lt;% @item.packages_for_log.each do |p| %&gt;\n    &lt;%= a.fields_for p do |i| %&gt;\n     &lt;tr&gt;\n        &lt;td&gt;&lt;%= p.order.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= p.order.processed_notes %&gt;&lt;/td&gt;\n      &lt;% if p.order.user %&gt;\n        &lt;td&gt;&lt;%= \"#{p.order.user.name.first(3).upcase}-#{p.id}\" %&gt;&lt;/td&gt;\n      &lt;% else %&gt;\n        &lt;td&gt;&lt;%= p.order.id %&gt;&lt;/td&gt;\n      &lt;% end %&gt;\n        &lt;td&gt;\n          &lt;%= i.text_field :actual_lbs %&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;%= i.text_field :actual_oz %&gt;\n        &lt;/td&gt;\n          &lt;%= i.hidden_field :true_weight, value: (i.actual_lbs + i.actual_oz/16) %&gt;\n     &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Relevant section of the package.rb model file:</p>\n\n<pre><code> attr_accessible :order_id, :price, :true_weight, :actual_lbs, :actual_oz\n attr_accessor :actual_lbs, :actual_oz  # These two are virtual attributes for the above calc\n</code></pre>\n\n<p>And I added resources :packages to my routes file. </p>\n\n<p>Any idea what I'm doing wrong? It's important to me that I loop through to create a table based on \"p\" and then edit that same \"p\" object. Just not sure how to do it. Pretty new to Rails.</p>\n"},{"tags":["ruby-on-rails","unobtrusive-javascript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13222768,"title":"Moving unobtrusive javascript out of html.erb file","body":"<p>I have a html.erb file in one of my views. The file is pretty big and has about 2/3 javascript code and just 1/3 html. I dont like this file being too cluttered. The javascript part is mostly event handlers and usage of jquery UI components like date pickers, dialogs etc for the corresponding html elements in the page. I would like to separate the javascript part from the html part.</p>\n\n<ol>\n<li><p>Can I move the javascript to a separate js.erb file and use it like a partial? What is the advantage of this?</p></li>\n<li><p>How would I move the javascript to a static .js file when I use rails API like I18n.() and &lt;%= form_authenticity_token %>. Should I pass them every time to the wrapping javascript function? Is there a better way to do this?</p></li>\n<li><p>If I move javascript out of the html.erb file will it help in caching/rendering of html.erb page?</p></li>\n</ol>\n\n<p>Interested to find out if there are any re-usable patterns</p>\n\n<p>Sample code on the html.erb file:</p>\n\n<pre><code> &lt;% content_for :javascript do %&gt;\n &lt;script type=\"text/javascript\"&gt;\n\n $(document).ready(function() \n {\n     $('#create_segment_dialog').dialog({\n            title: \"&lt;%= I18n.t(\"segment.create_segment_title\") %&gt;\",\n\n     // lots of javascript\n\n\n }\n\n &lt;/script&gt;\n &lt;%end %&gt;\n\n //HTML starts here\n\n &lt;div id=\"right-column\"&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","activerecord","ruby-on-rails-2"],"answer_count":6,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":4810,"score":6,"question_id":2381718,"title":"Rails ActiveRecord date between","body":"<p>I need to query comments made in one day. The field is part of the standard timestamps, is created_at. The selected date is coming from a date_select. How can I use ActiveRecord to do that?</p>\n\n<p>I need somthing like:</p>\n\n<pre><code>\"SELECT * FROM comments WHERE created_at BETWEEN '2010-02-03 00:00:00' AND '2010-02-03 23:59:59'\"\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13224248,"title":"How to use form builder to add attribute to form helpers in Rails?","body":"<p>I am trying to build a form builder in Rails that adds a <code>disabled</code> attribute to <code>text_field</code> and <code>select</code> helpers. This is the simplified version of my code:</p>\n\n<pre><code>class LabelFormBuilder &lt; ActionView::Helpers::FormBuilder  \n  %w[text_field select].each do |method_name|\n    define_method(method_name) do |name, *args|\n      super(name, :disabled =&gt; true, *args)\n    end  \n  end\nend\n</code></pre>\n\n<p>With <code>text_fields</code> the attribute gets added properly but with <code>selects</code> things get a bit trickier and I keep getting <code>undefined method merge for #&lt;Array:0x10b5229a0&gt;</code> errors.</p>\n\n<p>This is my view code (again simplified): </p>\n\n<pre><code>&lt;%= f.label :name %&gt;\n&lt;%= f.text_field :name %&gt;      # works!\n\n&lt;%= f.label :person %&gt;\n&lt;%= f.select(:person_id, current_user.person_names, :prompt =&gt; 'Please select...') %&gt;  # does not work!\n</code></pre>\n\n<p>How can I get line 4 of my class above to work on <code>select</code> helpers as well?</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["ruby-on-rails","ruby","version","carrierwave"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":42,"score":5,"question_id":13202992,"title":"CarrierWave with custom processor not registering","body":"<p>I am using <a href=\"https://github.com/jnicklas/carrierwave\" rel=\"nofollow\">carrierwave</a> to upload a video then have a version called thumb with a custom processor that takes the video and creates a screenshot using streamio-ffmpeg.  Both the video and the file are uploaded correctly but when calling uploader.url(:thumb) I get:</p>\n\n<blockquote>\n  <p>ArgumentError: Version thumb doesn't exist!</p>\n</blockquote>\n\n<h2>VideoUploader.rb</h2>\n\n<pre><code>require 'carrierwave/processing/mime_types'\nrequire 'streamio-ffmpeg'\n\nclass VideoUploader &lt; CarrierWave::Uploader::Base\n    include CarrierWave::VideoConverter\n    include CarrierWave::MimeTypes\n\n    process :set_content_type\n\n    storage :file\n\n    version :thumb do\n            process :create_thumb\n\n            #def full_filename(for_file)\n            #        \"thumb_#{File.basename(for_file, File.extname(for_file))}.png\"\n            #end\n    end\n\n    def create_thumb\n            cached_stored_file! if !cached?\n\n            movie = FFMPEG::Movie.new(current_path)\n\n            dirname = File.dirname(current_path)\n\n            thumb_path = \"#{File.join(dirname, File.basename(path, File.extname(path)))}.png\"\n\n            movie.screenshot(thumb_path, :seek_time =&gt; 5)\n            File.rename thumb_path, current_path\n    end\n\n    def file_identifier\n            model[:video]\n    end\n\n    # Override the directory where uploaded files will be stored.\n    # This is a sensible default for uploaders that are meant to be mounted:\n    def store_dir\n            return \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.user_id}/#{model.id}\"\n    end\nend\n</code></pre>\n\n<p>Then model.video_url(:thumb) returns the argument error.  I am not sure what to do or why the version isn't registered any help would be great, thanks.</p>\n"},{"tags":["ruby-on-rails","nginx","rvm","ubuntu-10.04","thin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13196455,"title":"Thin permissions in etc folder (Ubuntu)","body":"<p>I am working on a RoR server setup that uses Thin and Nginx.</p>\n\n<p>It works fine, but only if I manually add the folder /etc/thin and set the permissions to 777 in order to use the command below:</p>\n\n<pre><code>thin config -C /etc/thin/testapp.yml -c /var/www/testapp --servers 1 -e production\n</code></pre>\n\n<p>If I don't set it to 777, I get this error:</p>\n\n<pre><code>me@UbuntuRails:/etc$ thin config -C /etc/thin/testapp.yml -c /var/www/testapp --servers 1 -e production\n\n/usr/local/rvm/gems/ruby-1.9.3-p286@rails328/gems/thin-1.5.0/lib/thin/controllers/controller.rb:115:in `initialize': Permission denied - /etc/thin/testapp.yml (Errno::EACCES)\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/gems/thin-1.5.0/lib/thin/controllers/controller.rb:115:in `open'\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/gems/thin-1.5.0/lib/thin/controllers/controller.rb:115:in `config'\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/gems/thin-1.5.0/lib/thin/runner.rb:187:in `run_command'\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/gems/thin-1.5.0/lib/thin/runner.rb:152:in `run!'\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/gems/thin-1.5.0/bin/thin:6:in `&lt;top (required)&gt;'\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/bin/thin:19:in `load'\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/bin/thin:19:in `&lt;main&gt;'\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/bin/ruby_noexec_wrapper:14:in `eval'\n    from /usr/local/rvm/gems/ruby-1.9.3-p286@rails328/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\n</code></pre>\n\n<p>I don't like to set this folder to a 777, sounds like a rubbish workaround.</p>\n\n<p>I run everything from an admin user account, not root. RVM runs from my admin user and gem only works in my admin as well. If I sudo that action, nothing happens because my root doesn't \"know\" thin.</p>\n\n<p>Which is the correct way to handle this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","google-maps"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13220309,"title":"How to pass variables from javascript to form?","body":"<p>In my application I get json with place details from google maps API using autocomplete</p>\n\n<pre><code>var place = autocomplete.getPlace();\n</code></pre>\n\n<p>I can get a name of the place with <code>place.name</code>\nOn the same page I have a form where I get another details from user. The question is how do I pass the <code>place.name</code> to my rails controller when the form gets submitted? In js I tried to change HTML of the form</p>\n\n<pre><code>&lt;form...&gt;\n&lt;div id=\"hidden_fields\"&gt;&lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>using</p>\n\n<pre><code>$(\"#hidden_fields\").append(\"&lt;input name='name' type='hidden' value='\"+place.name+\"' /&gt;\");\n</code></pre>\n\n<p>But apparently it doesn't works. \nShould I learn AJAX to do such things or there another ways?\nThanks in advance for any hint.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13224176,"title":"Rails namespacing error?","body":"<p>I have this in my <code>config/routed.db</code>:</p>\n\n<pre><code>namespace :admin do\n  resources :users\n  resources :events\nend\n</code></pre>\n\n<p>I generated the <code>User</code> model by using the scaffolding Rails provides, then I simply generated a admin/admin controller by using Rails' <code>generate</code> and simply moved all the user-related stuff into the admin sub-directories inside the controllers/views/helpers. Yes, I did have to add <code>admin_</code> in a few places and inside the form partial I had to change the <code>form_for(@user)</code> to <code>form_for([:admin, @user])</code>. </p>\n\n<p>When I try to create a new user (this is when I <code>POST</code> the user data) I get the following error message:</p>\n\n<pre><code>undefined method `user_url' for #&lt;Admin::UsersController:0x13f408e0&gt;\n</code></pre>\n\n<p>The application-level trace shows that the error is raised here:</p>\n\n<pre><code>app/controllers/admin/users_controller.rb:47:in `create'\n</code></pre>\n\n<p>The line of code where this error is raised:</p>\n\n<pre><code>format.html { redirect_to @user, :notice =&gt; 'User was successfully created.' }\n</code></pre>\n\n<p>The above line is inside the <code>respond_to</code> block.</p>\n\n<p>So, I have two questions: </p>\n\n<ol>\n<li>How do I fix this issue?</li>\n<li>Is there a smarter, better, rails-way of doing this?</li>\n</ol>\n\n<hr>\n\n<p>Also, bonus points if you suggest I re-do this in the <em>smarter, better, rails-way</em>! Well, I will do that anyway! :D</p>\n\n<hr>\n\n<h2>Update</h2>\n\n<p>Oh, I almost forgot something that might be relevant! I also made <code>Admin::UsersController</code> inherit from <code>Admin::AdminController</code> (which normally in turn inherits from <code>ApplicationController</code>):</p>\n\n<p><code>Admin::UsersController &lt; Admin::AdminController</code></p>\n"},{"tags":["ruby-on-rails","meta-search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":159,"score":0,"question_id":7710171,"title":"meta_search order by count","body":"<p>I have these models and I'm playing with meta_search to order it.</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  has_many :delivers\n  has_many :estimates, :through =&gt; :deliver\nend\n\nclass Estimate &lt; ActiveRecord::Base\n  has_many :delivers, :dependent =&gt; :destroy\n  has_many :companies, :through =&gt; :delivers\nend\n\nclass Deliver &lt; ActiveRecord::Base\n  belongs_to :estimate\n  belongs_to :company\nend\n</code></pre>\n\n<p>As you can see a company has many estimates and I need a filter to show companies in this order: from company who has the highest number of estimates to company that has the lowest number of estimates.<br>\nI'd like to have a sort link for it, something like:</p>\n\n<pre><code>= sort_link @search, :estimates_asc\n</code></pre>\n\n<p>I know that I can order in that way companies with this statement </p>\n\n<pre><code>Company.joins(:estimates).sort_by{|x| -x.estimates.size}\n</code></pre>\n\n<p>Thanks for helping me.</p>\n"},{"tags":["ruby-on-rails","ruby","imagemagick","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":13056932,"title":"Paperclip File Not Found Error","body":"<p>I just switched from a paperclip rails plugin to a paperclip gem. The project is a rails 2.3 application and I am using paperclip 2.7.2 gem.</p>\n\n<p>I am getting the following odd error:</p>\n\n<pre><code>identify: unable to open image `file': No such file or directory @ error/blob.c/OpenBlob/2617.\nidentify: no decode delegate for this image format `file' @ error/constitute.c/ReadImage/544.\n</code></pre>\n\n<p>Seems like paperclip is looking for a file called 'file' but I am not sure why. I didn't change any of the code we had before. It used to work, all I did was upgrade to a newer version and use a gem over a plugin.</p>\n\n<p>Any ideas?</p>\n\n<p><em><strong>Update</em></strong></p>\n\n<p>It to be a bug in paper clip where it does not parse the content of the command properly. I dug deep into the paperclip source to find:</p>\n\n<pre><code>def run(cmd, arguments = \"\", local_options = {})\n  if options[:image_magick_path]\n    Paperclip.log(\"[DEPRECATION] :image_magick_path is deprecated and will be removed. Use :command_path instead\")\n  end\n  command_path = options[:command_path] || options[:image_magick_path]\n  Cocaine::CommandLine.path = [Cocaine::CommandLine.path, command_path].flatten.compact.uniq\n  local_options = local_options.merge(:logger =&gt; logger) if logging? &amp;&amp; (options[:log_command] || local_options[:log_command])\n\n  Cocaine::CommandLine.new(cmd, arguments, local_options).run\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code># Uses ImageMagick to determing the dimensions of a file, passed in as either a\n# File or path.\n# NOTE: (race cond) Do not reassign the 'file' variable inside this method as it is likely to be\n# a Tempfile object, which would be eligible for file deletion when no longer referenced.\ndef self.from_file file\n  file_path = file.respond_to?(:path) ? file.path : file\n  raise(Paperclip::NotIdentifiedByImageMagickError.new(\"Cannot find the geometry of a file with a blank name\")) if file_path.blank?\n  geometry = begin\n               Paperclip.run(\"identify\", \"-format %wx%h :file\", :file =&gt; \"#{file_path}[0]\")\n             rescue Cocaine::ExitStatusError\n               \"\"\n             rescue Cocaine::CommandNotFoundError =&gt; e\n               raise Paperclip::CommandNotFoundError.new(\"Could not run the `identify` command. Please install ImageMagick.\")\n             end\n  parse(geometry) ||\n    raise(NotIdentifiedByImageMagickError.new(\"#{file_path} is not recognized by the 'identify' command.\"))\nend\n</code></pre>\n\n<p>The Paperclip.run command fails to replace the :file placeholder for some reason. I verified this by running the following on the commandline:</p>\n\n<pre><code>identify :file\n</code></pre>\n\n<p>Monkey patching the replacement by hand yields other errors where a similar thing happens.</p>\n"},{"tags":["jquery","ruby-on-rails","post","views"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13221942,"title":"Drag and drop sorting with multiple models rails","body":"<p>I have a simple rails todo list running. I have 2 relevant models, <code>List</code> and <code>Task</code>.</p>\n\n<p>A <code>List</code> obviously <code>has_many :tasks</code> and now I am trying to use jQuery drag and drop to sort the position of incomplete tasks in the show view of the List and have the position order remain after a page load.  </p>\n\n<p>I believe the issue may be in the url I'm passing to my lists.js.coffee. </p>\n\n<p>The output after a drag and drop-</p>\n\n<pre><code>Started POST \"/lists/1/tasks/sort\" for 127.0.0.1 at 2012-11-04 11:08:37 -0800\nProcessing by TasksController#sort as */*\n  Parameters: {\"list_id\"=&gt;\"1\"}\n  List Load (0.2ms)  SELECT \"lists\".* FROM \"lists\" WHERE \"lists\".\"id\" = ? LIMIT 1  [[\"id\", \"1\"]]\n  Rendered text template (0.0ms)\nCompleted 200 OK in 5ms (Views: 1.7ms | ActiveRecord: 0.2ms)\n</code></pre>\n\n<p>My routes-</p>\n\n<pre><code>  resources :lists do\n    resources :tasks do\n      collection { post :sort }\n    end\n  end\n</code></pre>\n\n<p>My lists.js.coffee-</p>\n\n<pre><code>jQuery -&gt;\n  $('#incomplete').sortable\n    axis: 'y'\n    update: -&gt;\n     $.post($(this).data('update-url'), $(this).sortable('serialize'))\n</code></pre>\n\n<p>My task controller-</p>\n\n<pre><code>class TasksController &lt; ApplicationController\n  before_filter :find_list\n  respond_to :html, :js\n\n  def index\n    @task = List.tasks.incomplete.order(\"position\")\n  end\n\n  def sort\n    render nothing: true\n  end\n\n  def create\n    @task = @list.tasks.new(params[:task])\n    if @task.save\n      flash[:notice] = \"Task Created\"\n    else\n      flash[:error] = \"It just didn't happen for you\"\n    end\n\n    respond_with @list\n  end\n\n  def complete\n    @task = @list.tasks.find(params[:id])\n\n    @task.update_attributes({ \n      completed: true\n    })\n\n    respond_with @list\n  end\n\n  private\n\n  def find_list\n    @list = List.find(params[:list_id])\n  end\nend\n</code></pre>\n\n<p>And finally the show view of the List where I'm rendering complete and incomplete tasks-</p>\n\n<pre><code>&lt;ul class=\"task-list\" id=\"incomplete\" data-update-url=\"&lt;%= sort_list_tasks_url(@list)%&gt;\"&gt;\n    &lt;% @list.tasks.incomplete.each do |task| %&gt; \n     &lt;table class=\"table table-hover table-condensed\"&gt;\n       &lt;tbody&gt;\n         &lt;tr&gt;\n           &lt;td&gt;\n            &lt;li id=\"task-&lt;%= task.id %&gt;\"&gt;\n              &lt;span class=\"task-description\" id=\"description-&lt;%= task.id %&gt;\"&gt;\n                &lt;%= image_tag task.user.gravatar_url, :class =&gt; \"gravatar_index\" %&gt;\n                &lt;%= task.description %&gt;\n              &lt;/span&gt;\n              &lt;span class=\"pull-left\" id=\"completed_checkbox\"&gt;\n               &lt;%= button_to \"Completed\", complete_task_path(@list.id,task.id), :class =&gt; \"btn-mini\", remote: true %&gt;\n              &lt;/span&gt;\n            &lt;/li&gt;\n          &lt;/td&gt;\n         &lt;/tr&gt;\n       &lt;/tbody&gt;\n      &lt;/table&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I have been following Rbates tutorial <a href=\"http://railscasts.com/episodes/147-sortable-lists-revised?\" rel=\"nofollow\">that handles only one faq model</a>, so I am missing the connection in how to make it work across both. After more than a couple hours I've become stuck. Thanks for taking a look and your attention. </p>\n\n<hr>\n\n<h2><strong>[UPDATE]</strong></h2>\n\n<p>I believe I have made progress in moving some of the logic into my lists controller and cleaning up the list show view-</p>\n\n<p>lists controller-</p>\n\n<pre><code>  def show\n    @list = List.find(params[:id])  \n    @tasks = @list.tasks.incomplete.order(\"position\")\n  end\n\n  def sort\n    render nothing: true\n  end\n</code></pre>\n\n<p>List show view-</p>\n\n<pre><code>&lt;ul class=\"task-list\" id=\"incomplete\" data-update-url=\"&lt;%= sort_list_tasks_url %&gt;\"&gt;\n    &lt;% @tasks.each do |task| %&gt; \n     &lt;table class=\"table table-hover table-condensed\"&gt;\n       &lt;tbody&gt;\n         &lt;tr&gt;\n           &lt;td&gt;\n            &lt;%= content_tag_for :li, task do %&gt;\n              &lt;span class=\"task-description\" id=\"description-&lt;%= task.id %&gt;\"&gt;\n                &lt;%= image_tag task.user.gravatar_url, :class =&gt; \"gravatar_index\" %&gt;\n                &lt;%= task.description %&gt;\n              &lt;/span&gt;\n              &lt;span class=\"pull-left\" id=\"completed_checkbox\"&gt;\n               &lt;%= button_to \"Completed\", complete_task_path(@list.id,task.id), :class =&gt; \"btn-mini\", remote: true %&gt;\n              &lt;/span&gt;\n            &lt;% end %&gt;\n          &lt;/td&gt;\n         &lt;/tr&gt;\n       &lt;/tbody&gt;\n      &lt;/table&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n</code></pre>\n\n<p>However, now I'm getting a </p>\n\n<pre><code>No route matches {:action=&gt;\"sort\", :controller=&gt;\"tasks\"}\n</code></pre>\n\n<p>error and I'm not sure why. The update-data-url attribute has a url I got directly from running rake routes, so I'm not sure why I'm getting this error. </p>\n\n<p>Progress (I think), but I'm still stuck. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2","payment-gateway","spree"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13222595,"title":"Integrating Payment Gateway (activemerchant based) with spree","body":"<p>I am trying to integrate payu.in payment gateway into my rails app.\nI have integrated their gem in the application but when i go to </p>\n\n<blockquote>\n  <p>/admin/payment_methods/new </p>\n</blockquote>\n\n<p>I am not able to see the payment gateway under the <strong>provider</strong> options.</p>\n\n<p>I have followed the steps as prescribed in <a href=\"http://guides.spreecommerce.com/payment_gateways.html\" rel=\"nofollow\">http://guides.spreecommerce.com/payment_gateways.html</a></p>\n\n<p>My app/models/spree/gateway/payu.rb looks like this:</p>\n\n<pre><code>module Spree\n  class Gateway::Payu &lt; Gateway\n    def provider_class\n      ActiveMerchant::Billing::Integrations::PayuIn\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13223559,"title":"Saving Model in Ruby on Rails fails. Updating works fine","body":"<p>I have a small Ruby on Rails application that I am trying to refactor and in the process have broken the abilty to save some data.  I have literally spent the <em>entire day</em> trying to sort this out (I am a Rails newbie, basically restricted to trying to improve an app I already have).</p>\n\n<p>I have Documents which have have locations associated with them:</p>\n\n<pre><code>class Document &lt; ActiveRecord::Base   \n  has_many :locations, :dependent =&gt; :destroy\nend\n\nclass Location &lt; ActiveRecord::Base\n  belongs_to :document\nend\n</code></pre>\n\n<p>I can edit Locations that have already been added to the Document (this is from documents/locations.html):</p>\n\n<pre><code>&lt;% @locations.each do |location| %&gt;\n  &lt;% unless location.new_record? %&gt;\n    &lt;%@location = location%&gt;\n    &lt;%= form_for(@location,:url=&gt;document_location_path(@document,@location),:method=&gt;:put) do |f| %&gt;\n      &lt;%= render :partial =&gt; \"document_locations/form\", :locals =&gt; {:f =&gt; f } %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt; \n&lt;% end %&gt;           \n</code></pre>\n\n<p>But attempts to add new Locations don't error, but don't add save either</p>\n\n<pre><code>&lt;% @location = @document.locations.new %&gt;\n&lt;%= form_for(@location,:url=&gt;:document_locations, :method=&gt;:post) do |f| %&gt;\n  &lt;%= render :partial =&gt; \"document_locations/form\", :locals =&gt; {:f =&gt; f } %&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>When I rake routes, I see the following</p>\n\n<pre><code>      document_locations        /documents/:document_id/locations(.:format)                   {:controller=&gt;\"documents\", :action=&gt;\"locations\"}\n\n    document_document_locations GET    /documents/:document_id/document_locations(.:format)          {:action=&gt;\"index\", :controller=&gt;\"document_locations\"}\n                                POST   /documents/:document_id/document_locations(.:format)          {:action=&gt;\"create\", :controller=&gt;\"document_locations\"}\n new_document_document_location GET    /documents/:document_id/document_locations/new(.:format)      {:action=&gt;\"new\", :controller=&gt;\"document_locations\"}\nedit_document_document_location GET    /documents/:document_id/document_locations/:id/edit(.:format) {:action=&gt;\"edit\", :controller=&gt;\"document_locations\"}\n     document_document_location GET    /documents/:document_id/document_locations/:id(.:format)      {:action=&gt;\"show\", :controller=&gt;\"document_locations\"}\n                                PUT    /documents/:document_id/document_locations/:id(.:format)      {:action=&gt;\"update\", :controller=&gt;\"document_locations\"}\n                                DELETE /documents/:document_id/document_locations/:id(.:format)      {:action=&gt;\"destroy\", :controller=&gt;\"document_locations\"}\n</code></pre>\n\n<p>I'm guessing my routes and controllers are in a right old mess, but any suggestions as to how I could start to trouble shoot would be appreciated.</p>\n\n<p>development.log shows this when I attempt to add a location: </p>\n\n<pre><code>Started POST \"/documents/210/locations\" for 127.0.0.1 at 2012-11-04 23:14:16 +0000\nDEPRECATION WARNING: class_inheritable_attribute is deprecated, please use class_attribute method instead. Notice their behavior are slightly different, so refer to class_attribute documentation first. (called from acts_as_taggable_on at /home/christian/Documents/business/development/pastpaper/vendor/plugins/acts-as-taggable-on/lib/acts_as_taggable_on/acts_as_taggable_on.rb:34)\n  Processing by DocumentsController#locations as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"OEsBVZPX8NznM0oO/O38/BSrjlpJrNV7oEZTWTcQV9c=\", \"location\"=&gt;{\"street1\"=&gt;\"xian1\", \"street2\"=&gt;\"xian2\", \"town\"=&gt;\"xian3\", \"county\"=&gt;\"\", \"state\"=&gt;\"\", \"country\"=&gt;\"\"}, \"commit\"=&gt;\"Save\", \"document_id\"=&gt;\"210\"}\n  Document Load (0.6ms)  SELECT `documents`.* FROM `documents` WHERE `documents`.`id` = 210 LIMIT 1\n  DocumentAttribute Load (0.6ms)  SELECT `document_attributes`.* FROM `document_attributes` WHERE `document_attributes`.`document_id` IN (210)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13222720,"title":"How do I manually set error on a nested attribute in Rails 3?","body":"<p>How do I manually set error on a nested attribute in Rails 3?</p>\n\n<p>The following is some example model code that I tried and isn't working for me.</p>\n\n<pre><code>validate :matching_card_colors\n\nhas_many :cards\naccepts_nested_attributes_for :card\n\ndef matching_card_colors\n  color = nil\n  cards.each do |card|\n    if color.nil?\n      color = card.color\n    elsif card.color != color\n      card.errors.add :color, \"does not match other card colors\"\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13223482,"title":"How to \"exploit\" relationship data already stored in the database?","body":"<p>I am using Ruby on Rails v3.2.2. I have following model classes</p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  has_many :regions, :foreign_key =&gt; 'country_id'\nend\n\nclass Region &lt; ActiveRecord::Base\n  belongs_to :country, :foreign_key =&gt; 'country_id'\n  has_many :cities, :foreign_key =&gt; 'region_id'\nend\n\nclass City &lt; ActiveRecord::Base\n  belongs_to :region, :foreign_key =&gt; 'region_id'\nend\n</code></pre>\n\n<p>and <em>I would like to make a <code>City</code> <code>belongs_to :country</code></em>.</p>\n\n<p>I know that the simplest way to make that is to add a <code>country_id</code> database table column to the <code>City</code> database table and to state related ActiveRecord Associations, this way:</p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  # ...\n  has_many :cities, :foreign_key =&gt; 'country_id'\nend\n\nclass City &lt; ActiveRecord::Base\n  # ...\n  belongs_to :country, :foreign_key =&gt; 'country_id'\nend\n</code></pre>\n\n<p>However, in order to store <em>less database data</em>, I think I may \"use\" the data already stored in the <code>Region</code> table <em>since a city belongs to a region which in turn belongs to a country (this implies that a city belongs to a country)</em> but, in this case, I have no idea on how to properly state ActiveRecord Associations for <code>City</code> and <code>Country</code> so to \"exploit\" mentioned relationship informations implicitly present \"through\" the <code>Region</code> model class.</p>\n\n<p>How should I proceed?</p>\n\n<hr>\n\n<p><em>Note</em>: I am \"forcing\" to state the <code>belongs_to :country</code> ActiveRecord Association in the <code>City</code> model class because I would like to use the RoR <a href=\"http://guides.rubyonrails.org/association_basics.html#belongs_to-counter_cache\" rel=\"nofollow\"><code>:counter_cache</code></a> feature (available <em>only</em> for <code>belongs_to</code> associations) in order to count cities present in a country.</p>\n"},{"tags":["ruby-on-rails","rspec","spork"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":10670784,"title":"\"NO tuple\" message while running spork on Windows7","body":"<p>I am trying to get the spork + rspec combination to work with my rails 3 installation. I am using Ruby 1.9.3p194.</p>\n\n<p>I run the spork server and it starts with following message:</p>\n\n<pre><code>Spork is ready and listening on 8989!\n   -- build slave 1...   -- build slave 2...\nLoading Spork.prefork block...\nLoading Spork.prefork block...\n</code></pre>\n\n<p>In a separate window, I run rspec:</p>\n\n<pre><code>rspec spec --drb\n</code></pre>\n\n<p>Now the spork window displays the following message:</p>\n\n<pre><code>Running tests with args [\"--color\", \"spec\"]...\n- NO tuple\nDone.\n\n  --&gt; DRb magazine_slave_service: 1 provided...\n  --&gt; DRb magazine_slave_service: 2 provided...\n</code></pre>\n\n<p>And the tests are not executed. Has anybody successfully managed to get rspec + spork to work on Windows?</p>\n"},{"tags":["ruby-on-rails","ruby","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13223549,"title":"Cannot get accepts_nested_attributes to work in rails 3","body":"<p>This might be a case of me being blind… \nSomehow I cannot get my layout_positions_attributes to arrive at layout_positions</p>\n\n<pre><code>l = Layout.new\n…\n[17] pry(main)&gt; l.layout_positions\n=&gt; []\n[18] pry(main)&gt; l.layout_positions_attributes=[{:name=&gt;'xxx'}]\n=&gt; [{:name=&gt;\"xxx\"}]\n[19] pry(main)&gt; l.layout_positions\n=&gt; [] # WTF!\n[20] pry(main)&gt; l.layout_positions.build({:name=&gt;'xxx'})\n=&gt; #&lt;LayoutPosition id: nil, name: \"xxx\", active: true, columns: nil, rows: nil, layout_id: nil, pos: -1&gt;\n[21] pry(main)&gt; l.layout_positions\n=&gt; [#&lt;LayoutPosition id: nil, name: \"xxx\", active: true, columns: nil, rows: nil, layout_id: nil, pos: −1&gt;]\n</code></pre>\n\n<p>The parent class:</p>\n\n<pre><code>class Layout &lt; ActiveRecord::Base\n  attr_accessible :name, :active, :layout_positions_attributes\n  has_many :layout_positions\n  accepts_nested_attributes_for :layout_positions,\n                                :reject_if =&gt; lambda { |a| a[:content].blank? },\n                                :allow_destroy =&gt; true\n  validates_presence_of :name\nend\n</code></pre>\n\n<p>And where the attributes should go…</p>\n\n<pre><code>class LayoutPosition &lt; ActiveRecord::Base\n  attr_accessible :name, :active, :columns, :rows, :pos\n  belongs_to :layout\n  validates_presence_of :name\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","debugging","rack"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1262,"score":4,"question_id":7352635,"title":"Is there any debug toolbar for Rails 3.x","body":"<p>I used <a href=\"https://github.com/brynary/rack-bug\" rel=\"nofollow\">Rack::Bug</a> more than one year ago, now I'd like to use it with a new Rails 3.1 project. I tried to install it, both the master and rails3 branches, but with no luck.</p>\n\n<p>Also tried <a href=\"https://github.com/brynary/rack-bug/network\" rel=\"nofollow\">some github forks</a> but they did not work either.</p>\n\n<p>Is there any alternative with the same features?</p>\n\n<p>P.S. I already know newrelic and its <a href=\"https://support.newrelic.com/help/kb/ruby/developer-mode\" rel=\"nofollow\">developer mode</a>, just looking for something else, more similar to Rack::Bug</p>\n\n<p>Here is a little screen shoot of what is capable of (the green toolbar with debugging informations)</p>\n\n<p><img src=\"http://i.stack.imgur.com/QWSZ2.jpg\" alt=\"rack bub\"></p>\n"},{"tags":["ruby-on-rails","ruby","profiling"],"answer_count":8,"favorite_count":18,"up_vote_count":31,"down_vote_count":0,"view_count":11150,"score":31,"question_id":350470,"title":"What tools do you recommend to profile Rails apps?","body":"<p>I've been looking for profiling tools for Rails for a while. I'm currently playing and testing ruby-prof and railsbench, but I kinda frustrated with the amount of tweaking and mangling required to make then work.</p>\n\n<p>Althought I don't mind (much) the tweaking, I'd like to know if is there any other, more straight-forward and easy to use, tools to profile a Rails app? Which tools you recommend?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13223265,"title":"Can I pass DOM elements to rails render method?","body":"<p>I have a comment form on a blog I'm building.</p>\n\n<p>Blog posts are lengthy, so the form is located <strong>way off-screen</strong>, at the bottom of the page.</p>\n\n<p>If a comment fails validation, then the user is taken back to the top of the page, but the error messages are displayed way down where the form is.</p>\n\n<p>I'd prefer to have the browser focus on the comments section, when this happens, so that the user can see the <strong>validation error messages</strong>.</p>\n\n<p>Here's my comments_controller's create action:</p>\n\n<pre><code>def create\n  @article = Article.find(params[:article_id])\n  @comment = @article.comments.build(params[:comment])\n  if @comment.save\n    redirect_to article_path(@article), notice: \"Thanks for your comment\"\n  else\n    # is there anyway to pass an id (like #comments) to this render call??\n    render 'articles/show'\n  end\nend\n</code></pre>\n\n<p>As you can see, I call <code>render 'articles/show'</code> if validations fail. I was hoping to be able to do something like this though: </p>\n\n<pre><code>render 'articles/show', :anchor =&gt; '#comments'\n</code></pre>\n\n<p>In the ideal world, the code above would render articles#show, and set the viewport focus on the comments section. I know I can pass an anchor when using <code>link_to</code>, but can I do it with <code>render</code>?</p>\n\n<p>Is anything like this possible, or do I need to go with an Ajax solution?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13222769,"title":"Not able to remove attachment","body":"<p>Looks like it's a known issue but i'm not able to find any solution nor any dirty fix to make it working. The thing is i'm not able to remove attachments uploaded using Carrierwave plugin. </p>\n\n<p>I'm using a special form field called <code>:remove_avatar</code> which should remove a avatar file and clear avatar column but the only thing it does is deleting the file, the file reference in avatar column still exists.</p>\n\n<p>I was trying to remove it in any possible way but without a luck. </p>\n\n<h3>update_attributes</h3>\n\n<p>using <code>u.update_attributes( :avatar =&gt; \"\" )</code> is not removing the reference</p>\n\n<h3>save()</h3>\n\n<pre><code>u = User.find(int)\nu.avatar = \"\"\nu.save\n</code></pre>\n\n<p>is also not removing the reference</p>\n\n<h3>remove_avatar = true</h3>\n\n<pre><code>u.remove_avatar = true\nu.save\n</code></pre>\n\n<p>not working</p>\n\n<h3>remove_avatar!</h3>\n\n<pre><code>u.remove_avatar!\nu.save\n</code></pre>\n\n<p>not working</p>\n\n<h3>f.check_box :remove_avatar</h3>\n\n<p>not working</p>\n\n<p>By 'not working' i mean that the file is removed from filesystem but the reference persists.</p>\n\n<p>Cany you please provide me ANY tip i can use to make it working again? It can be something dirty, this bug shown a day before my deadline and i feel quite desperate. Thanks in advance.</p>\n\n<p>Ruby: 1.8.7<br>\nRails: 3.2.6<br>\nCarrierwave: master branch from git repo</p>\n"},{"tags":["ruby-on-rails","nested-attributes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13114416,"title":"Ruby on Rails: setting up f.file_field to upload multiple files","body":"<p>I'm following this railscast:\n<a href=\"http://railscasts.com/episodes/381-jquery-file-upload\" rel=\"nofollow\">http://railscasts.com/episodes/381-jquery-file-upload</a></p>\n\n<p>I want to do something similar in a form with nested attributes for uploading images. The main table is <code>users</code>. each has_many <code>images</code>. The application works fine for uploading a single file (using carrierwave).</p>\n\n<p>The problem is, in the initial stages of the railscasts, changing the file_field is causing a problem.</p>\n\n<pre><code>views/users/new.html.erb\n&lt;%= f.fields_for :images do |z| %&gt;\n&lt;fieldset&gt;\n&lt;p&gt;\n    &lt;%= z.label :image_title %&gt;&lt;br /&gt;\n    &lt;%= z.text_field :image_title %&gt;\n    &lt;%= z.hidden_field :image_priority, :value =&gt; '1' %&gt; \n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;%= z.file_field :image_location %&gt;\n  &lt;/p&gt;\n&lt;/fieldset&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The railscast says you should add a \"multiple\" option to file_Field and then \"hardcode\" the field name. So somthing like this:</p>\n\n<pre><code>&lt;%= z.file_field :image_location, multiple: true, name: \"images[image_location]\" %&gt;\n</code></pre>\n\n<p>But this doesn't work. Once I change this, the <code>image_location</code> field in the <code>images</code> table is not populated. I suppose the problem is related to it being a nested form. How can I fix this? My end goal is to have a form with multiple uploads and progress bars using jquery-fileupload.</p>\n\n<p>edit:\nI suppose it's also possible to use to give up nested attributes here and do it seperately, but I've been trying to do this for a while now to no avail.</p>\n"},{"tags":["javascript","ruby-on-rails","ajax","json","params"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13178909,"title":"use JSON object with rails scoped","body":"<p>I want to the following thing to happen:</p>\n\n<p>When I select a selectbox I want it to send a JSON object through AJAX to my controller like so : </p>\n\n<pre><code>        var encoded = $.param(data);            \n        jQuery.ajax ({\n            url: '/trips',\n            type: 'GET',\n            data: {'toSearch' : encoded},\n            success: function (response) {\n                //succes\n                console.log(encoded);\n            }\n        });\n</code></pre>\n\n<p>and use these as params for my query like so </p>\n\n<pre><code>respond_to :json, :html\n\n  def index\n    @trips = Trip.scoped\n    @trips.where(\"category_id = ?\", params[:category_ids]) if params[:category_ids] # category_ids = array; select * from trips where category_id IN [1,3,4]\n\n\n    respond_with @trips\n  end\n</code></pre>\n\n<p>How do I do this? and what is the best way to serialize my JSON object?</p>\n"},{"tags":["ruby-on-rails","postgresql","rake","adaptor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13222974,"title":"rails 3.1: postgres: why does db:create ignore my database.yml file?","body":"<p>Here's my database.yml entry:</p>\n\n<pre><code>development:\n  adapter: postgresql\n  encoding: unicode\n  database: hi5fit_development\n  user: postgres\n  password: postgres\n  pool: 5\n</code></pre>\n\n<p>Here's my command-line:</p>\n\n<p>rake db:create</p>\n\n<p>Here's the error I get:</p>\n\n<pre><code>db/test.sqlite3 already exists\nFATAL:  password authentication failed for user \"Eric\"\n/Users/Eric/.rvm/gems/ruby-1.9.3-p286@rails-31/gems/activerecord-3.1.3/lib/active_record/connection_adapters/postgresql_adapter.rb:1076:in `initialize'\n/Users/Eric/.rvm/gems/ruby-1.9.3-p286@rails-31/gems/activerecord-3.1.3/lib/active_record/connection_adapters/postgresql_adapter.rb:1076:in `new'\n... Many lines left out\n</code></pre>\n\n<p>This has happened on two different machines, one running Postgres 8.4 on OSX 10.5,\nthe other Postgres 9.2 on OSX 10.6, both with Ruby 1.9.3 and Rails 3.1, so I'm most\nlikely making a systematic error, and not running into a one-time glitch.  Why is rake\ntrying to use my login name and not the database name provided in config/database.yml</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13223268,"title":"undefined method `model_name' for NilClass:Class (has_one a belongs_to relationship)","body":"<p>Hello I trying to create the create view for my user_information model but I get this error:</p>\n\n<pre><code>NoMethodError in User_informations#new\n\nundefined method `model_name' for NilClass:Class\n</code></pre>\n\n<p>Here is the user model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :email, :password, :password_confirmation\n  has_one :user_information\n  has_secure_password\n\n  before_save { |user| user.email = email.downcase }\n  before_save :create_remember_token\n\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX }, uniqueness: { case_sensitive: false }\n  validates :password, presence: true, length: { minimum: 6 }, confirmation: true, unless: Proc.new { |a| !a.new_record? &amp;&amp; a.password.present? }\n\n    def send_password_reset\n        self.password_reset_token = SecureRandom.urlsafe_base64\n        self.password_reset_at = Time.zone.now\n        self.password = self.password\n        self.save!(:validate =&gt; false )\n        UserMailer.password_reset(self).deliver\n    end\n\n    def reset_password_token\n        self.password_reset_token = nil\n        self.password_reset_at = nil\n        save!\n    end\n\n  private\n\n    def create_remember_token\n        if self.new_record?\n            self.remember_token = SecureRandom.urlsafe_base64\n        end\n    end\n\nend\n</code></pre>\n\n<p>Here the user_information model:</p>\n\n<pre><code>class UserInformation &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :address, :address2, :business, :descripcion, :identification_number, :mobile_cell, :name, :phone_number\n  validates :address, presence: true, length: { :maximum =&gt; 250 } \n  validates :address2, length: { :maximum =&gt; 250 } \n  validates :descripcion, presence: true, length: { :maximum =&gt; 300 } \n  validates :identification_number, presence: true\n  validates :phone_number, presence: true, length: { :is =&gt; 11 } \n  validates :mobile_cell, :length =&gt; { :is =&gt; 11 }\n  validates :user_id, presence: true\nend\n</code></pre>\n\n<p>and the view:</p>\n\n<pre><code>&lt;%= form_for(@user_information) do |f| %&gt;\n    &lt;%= render 'shared/error_messages', object: f.object %&gt;\n    &lt;%= f.text_field  :name %&gt;\n    &lt;%= f.text_field  :descripcion %&gt;\n    &lt;%= f.text_field  :address %&gt;\n  &lt;%= f.button \"&lt;i class=\\\"icon-user icon-white\\\"&gt;&lt;/i&gt; Salvar\".html_safe, :tabindex =&gt; 3,  class: \"btn btn-warning\", :style =&gt; \"width:220px;margin-bottom:5px;\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>the controller</p>\n\n<pre><code>class UserInformationsController &lt; ApplicationController\n\n    def index\n    end\n\n    def create\n        @user_information = current_user.userinformations.build(params[:user_information])\n        if @user_information.save\n            flash[:success] = \"Micropost created!\"\n            redirect_to redirect_to\n        else\n\n        end\n    end\n\nend\n</code></pre>\n\n<p>Can anyone help me to understand please.</p>\n\n<hr>\n\n<p>the routes</p>\n\n<pre><code>  resources :users do\n      member do\n        resource :user_information\n      end\n  end\n  resources :sessions, only: [:new, :create, :destroy]\n  resources :password_resets\n\n  root to: 'users#new'\n\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new'\n  match '/signout', to: 'sessions#destroy', via: :delete\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13223089,"title":"Specify folder for download","body":"<p>In my Rails controller I have the line</p>\n\n<pre><code>send_file(\"#{Rails.root}/test/image.png\")\n</code></pre>\n\n<p>I'd like my web page to have a textbox, that the user can fill in a directory such as <code>C:/OldPictures/All/</code>, and then when the user clicks a link which invokes the controller, it also reads the directory in the textbox, and downloads the file <code>image.png</code> to the specified directory. Can I make it so?</p>\n"},{"tags":["javascript","ruby-on-rails","compression","asset-pipeline"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":271,"score":3,"question_id":9674714,"title":"Disable Asset Minification in Rails Production","body":"<p>In order to debug javascript in my heroku production environment, I need to disable asset compression (or at least compression of javascript).  I tried <code>config.assets.compress = false</code> along with <code>config.assets.debug = true</code>, and the compressed assets were still used.  I then deleted the compressed assets, at which point no assets were rendered at all.  I added <code>config.assets.enabled = false</code>, which did not help.  I tried copying the uncompressed assets into various directories, including the application root, public, and public/assets (the latter two using both the folders \"images, \"javascripts\", and \"stylesheets\", and putting the assets directly into the folders without the three subfolders).  I was eventually able to get the javascripts to work by changing the html to directly reference all of the javascript files.  But the CSS and images still are not working.</p>\n\n<p>I would have thought that my original <code>config.assets.compress = false</code> should have worked.  Any ideas what I did wrong?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":10485091,"title":"Rails: Exclude certain assets from being precompiled","body":"<p>What I want is really simple - I want all assets except a particular css file (that references image assets and thus needs to go through the asset pipeline) to be precompiled.  How do I exclude that css file from being precompiled?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":208,"score":3,"question_id":11617217,"title":"Encoding Undefined Conversion Error - Ruby on Rails , Error on Write","body":"<p>So I am trying to download a zip file from a website and put that data into a table. The download has been working before, but suddenly, it's not anymore. I get a \"`write': \"\\xB6\" from ASCII-8BIT to UTF-8 (Encoding::UndefinedConversionError)\" problem. Very strange, nothing has changed since i last ran the script. Here is the part of the code that is having the problems. I am using a gem which allows me to parse the DBF file within the zip file.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>`write': \"\\xB6\" from ASCII-8BIT to UTF-8 (Encoding::UndefinedConversionError)\n</code></pre>\n\n<p>Thanks for the help</p>\n\n<p>UPDATE: I'm running within rails, obviously. I ran the script outside the rails environment, and it worked fine. So Rails is interfering somehow with the write process. </p>\n\n<p>UPDATE 2: SOLVED - I changed \"w\" to \"wb\" apparently this is caused by rails 3+. Didn't occur to me to try this before. Hopefully this helps other people. </p>\n"},{"tags":["ruby-on-rails","ruby","database","csv","import"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13222947,"title":"How to import data to the database from a CSV file?","body":"<p>I am using Ruby 1.9.2, the Ruby on Rails v3.2.2 gem and the MySQL database. I would like to import data to the database from a <a href=\"http://www.maxmind.com/download/worldcities/worldcitiespop.txt.gz\" rel=\"nofollow\">CSV file</a> containing world cities. I think this process should be made by running a RoR migration but I don't know how to properly proceed.</p>\n\n<p>In particular, I don't know <em>where</em> (that is, in which directory relating my RoR application) I should put the CSV file and <em>how to access</em> that file from my migration file in order to add data to the database.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","session","authlogic","session-fixation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":140,"score":4,"question_id":12263152,"title":"Rails 3 with Authlogic and calling reset_session","body":"<p>The <a href=\"http://guides.rubyonrails.org/security.html#session-fixation-countermeasures\" rel=\"nofollow\">RoR Security Guide</a> states that you should \"issue a new session identifier and declare the old one invalid after a successful login\" using the reset_session method to counter session fixation.</p>\n\n<p>I haven't been able to find any guidance on calling reset_session when using Authlogic. Is it simply a case of including the method in the controller method (as below)? </p>\n\n<p>I'm just concerned about causing problems for Authlogic as I can see both user_credentials and user_credentials_id keys and values in the session hash prior to calling reset_session.</p>\n\n<pre><code>class UserSessionsController &lt; ApplicationController\n\n  def create\n    @user_session = current_client.user_sessions.new(params[:user_session])\n    if @user_session.save\n      reset_session\n      flash[:success] = I18n.t(:msg_login_success)\n      redirect_back_or_default application_root_path\n    else\n      render :action =&gt; :new\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","access-token"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13219352,"title":"Rails: How can I check if the access_token is expired?","body":"<p>I'm writing an api for an android app with rails. Since I'm new to both rails and android, I cannot figure the access_token stuff out.</p>\n\n<p>I have a Token model, each time the user logs in, a new access_token will be added to the tokens table. My question is if I set the expiration date == 3 days after the token is created, what's the proper way to validate this when the user sends a request with an access_token? How can I delete those expired tokens?</p>\n\n<p>Here is my Token Model:</p>\n\n<pre><code># Table name: tokens\n#\n#  id           :integer          not null, primary key\n#  access_token :string(255)\n#  user_id      :integer\n#  created_at   :datetime         not null\n#  updated_at   :datetime         not null\n\nclass Token &lt; ActiveRecord::Base\n  attr_accessible   :access_token, :user_id\n  before_validation :generate_access_token\n  belongs_to        :user\n\n  validates :access_token, presence: true, uniqueness: true\n  validates :user_id,      presence: true, uniqueness: true\n\nprivate\n\n  def generate_access_token\n    begin\n      self.access_token = SecureRandom.hex\n    end while self.class.exists?(access_token: access_token)\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","forms","render"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13222644,"title":"Non working render","body":"<p>I get the errors message in the title and I can't understand why?</p>\n\n<p>this my code\nuser.rb</p>\n\n<pre><code>has_one :GoldBook\nhas_many :comments\n</code></pre>\n\n<p>gold_book.rb</p>\n\n<pre><code>has_many :comments\nbelongs_to :user\n</code></pre>\n\n<p>comment.rb</p>\n\n<pre><code>belongs_to :user\nbelongs_to :gold_book\n</code></pre>\n\n<p>comments_controller.rb</p>\n\n<pre><code>def create\n@gold_book = GoldBook.find(params[:gold_book_id])\n@comment = Comment.new(params[:comment])\n@comment.goldbook = @gold_book\n@comment.user = current_user\n</code></pre>\n\n<p>gold_books/show.html.erb</p>\n\n<pre><code>&lt;%= render 'goldbook' %&gt;\n</code></pre>\n\n<p>gold_books/_goldbooks</p>\n\n<pre><code>&lt;%= render 'comments/form', goldbook: goldbook %&gt; \n</code></pre>\n\n<p>comments/_form</p>\n\n<pre><code>    &lt;%= form_for([goldbook, @comment]) do |f| %&gt;\n    &lt;% if @comment.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@comment.errors.count, \"error\") %&gt; prohibited this comment from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @comment.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :content %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :content %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I think the error is in the comments' form but not sure ...\nI'm trying to make somethink like a gold book with many comment</p>\n\n<p>And this is the full trace error :</p>\n\n<pre><code>activemodel (3.2.8) lib/active_model/naming.rb:163:in `model_name_from_record_or_class'\nactivemodel (3.2.8) lib/active_model/naming.rb:158:in `param_key'\nactionpack (3.2.8) lib/action_view/helpers/form_helper.rb:369:in `form_for'\napp/views/comments/_form.html.erb:1:in `_app_views_comments__form_html_erb__1022796803_80617610'\nactionpack (3.2.8) lib/action_view/template.rb:145:in `block in render'\nactivesupport (3.2.8) lib/active_support/notifications.rb:125:in `instrument'\nactionpack (3.2.8) lib/action_view/template.rb:143:in `render'\nactionpack (3.2.8) lib/action_view/renderer/partial_renderer.rb:265:in `render_partial'\nactionpack (3.2.8) lib/action_view/renderer/partial_renderer.rb:238:in `block in render'\nactionpack (3.2.8) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.8) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'\nactionpack (3.2.8) lib/action_view/renderer/partial_renderer.rb:237:in `render'\nactionpack (3.2.8) lib/action_view/renderer/renderer.rb:41:in `render_partial'\nactionpack (3.2.8) lib/action_view/helpers/rendering_helper.rb:27:in `render'\napp/views/gold_books/_goldbook.html.erb:3:in `_app_views_gold_books__goldbook_html_erb__357761412_79186410'\nactionpack (3.2.8) lib/action_view/template.rb:145:in `block in render'\nactivesupport (3.2.8) lib/active_support/notifications.rb:125:in `instrument'\nactionpack (3.2.8) lib/action_view/template.rb:143:in `render'\nactionpack (3.2.8) lib/action_view/renderer/partial_renderer.rb:265:in `render_partial'\nactionpack (3.2.8) lib/action_view/renderer/partial_renderer.rb:238:in `block in render'\nactionpack (3.2.8) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.8) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'\nactionpack (3.2.8) lib/action_view/renderer/partial_renderer.rb:237:in `render'\nactionpack (3.2.8) lib/action_view/renderer/renderer.rb:41:in `render_partial'\nactionpack (3.2.8) lib/action_view/helpers/rendering_helper.rb:27:in `render'\napp/views/gold_books/show.html.erb:7:in `_app_views_gold_books_show_html_erb__197041322_85056980'\nactionpack (3.2.8) lib/action_view/template.rb:145:in `block in render'\nactivesupport (3.2.8) lib/active_support/notifications.rb:125:in `instrument'\nactionpack (3.2.8) lib/action_view/template.rb:143:in `render'\nactionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:47:in `block (2 levels) in render_template'\nactionpack (3.2.8) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.8) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'\nactionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:46:in `block in render_template'\nactionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:54:in `render_with_layout'\nactionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:45:in `render_template'\nactionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:18:in `render'\nactionpack (3.2.8) lib/action_view/renderer/renderer.rb:36:in `render_template'\nactionpack (3.2.8) lib/action_view/renderer/renderer.rb:17:in `render'\nactionpack (3.2.8) lib/abstract_controller/rendering.rb:110:in `_render_template'\nactionpack (3.2.8) lib/action_controller/metal/streaming.rb:225:in `_render_template'\nactionpack (3.2.8) lib/abstract_controller/rendering.rb:103:in `render_to_body'\nactionpack (3.2.8) lib/action_controller/metal/renderers.rb:28:in `render_to_body'\nactionpack (3.2.8) lib/action_controller/metal/compatibility.rb:50:in `render_to_body'\nactionpack (3.2.8) lib/abstract_controller/rendering.rb:88:in `render'\nactionpack (3.2.8) lib/action_controller/metal/rendering.rb:16:in `render'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'\nactivesupport (3.2.8) lib/active_support/core_ext/benchmark.rb:5:in `block in ms'\n/usr/lib/ruby/1.9.1/benchmark.rb:295:in `realtime'\nactivesupport (3.2.8) lib/active_support/core_ext/benchmark.rb:5:in `ms'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:40:in `block in render'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'\nactiverecord (3.2.8) lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:39:in `render'\nactionpack (3.2.8) lib/action_controller/metal/implicit_render.rb:10:in `default_render'\nactionpack (3.2.8) lib/action_controller/metal/mime_responds.rb:196:in `respond_to'\napp/controllers/gold_books_controller.rb:18:in `show'\nactionpack (3.2.8) lib/action_controller/metal/implicit_render.rb:4:in `send_action'\nactionpack (3.2.8) lib/abstract_controller/base.rb:167:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/rendering.rb:10:in `process_action'\nactionpack (3.2.8) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:414:in `_run__799128830__process_action__547441087__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/rescue.rb:29:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'\nactiverecord (3.2.8) lib/active_record/railties/controller_runtime.rb:18:in `process_action'\nactionpack (3.2.8) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.2.8) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.2.8) lib/action_controller/metal.rb:203:in `dispatch'\nactionpack (3.2.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.2.8) lib/action_controller/metal.rb:246:in `block in action'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `call'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:36:in `call'\njourney (1.0.4) lib/journey/router.rb:68:in `block in call'\njourney (1.0.4) lib/journey/router.rb:56:in `each'\njourney (1.0.4) lib/journey/router.rb:56:in `call'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.4.1) lib/rack/etag.rb:23:in `call'\nrack (1.4.1) lib/rack/conditionalget.rb:25:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'\nrack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\nrack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'\nactiverecord (3.2.8) lib/active_record/query_cache.rb:64:in `call'\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__1022103052__call__645886376__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.8) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.8) lib/rails/engine.rb:479:in `call'\nrailties (3.2.8) lib/rails/application.rb:223:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n/usr/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n/usr/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n/usr/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","client-side-validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":205,"score":0,"question_id":10466132,"title":"Clearing error messages in client side validations rails gem","body":"<p>I am using Client Side Validations rails gem v3.1.0 in my application. I have a form displayed in a jquery dialog which needs to be validated. Client state validation is enabled on that form. Everything works well with the validation, but when user cancels the dialog (without submitting), I would like to clear any existing validation errors. This way when user fires the dialog again, the validations errors are not present already on the form. </p>\n\n<p>I have tried to achieve this by triggering the client state validation pass event for each element on dialog close - it works by removing the wrapping error fields and labels. One issue is that subsequent validations don't work after this code. I feel that bound events are removed and not triggered anymore. </p>\n\n<p>Is there a better way of achieving this?</p>\n\n<p>My jquery dialog:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>$('#create_dialog').dialog({\n            height: 260,\n            width: 420,\n            title: \"title\",\n            buttons: {\"&lt;%= I18n.t(\"create\") %&gt;\": function(e) {\n                $('#new_segment').submit();\n                },\n                Cancel: function() {\n                    var form = $('#new_segment');\n                    form.find('[data-validate]:input').each(function() {\n                        $(this).trigger('element:validate:pass');\n                    });\n                    $(this).dialog(\"close\");\n\n                    }\n                }\n        });\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":24,"score":0,"question_id":13222685,"title":"Browse folder when downloading file","body":"<p>On my webpage, I have a link which, when clicked, invokes a Rails controller </p>\n\n<pre><code>send_file(\"#{Rails.root}/test/image.png\")\n</code></pre>\n\n<p>When I click on the link, it automatically downloads <code>image.png</code> into my Download folder. What I'd like instead is that it shows a pop-up \"Save File\" that allows me to browse the folders on my computer and choose where to save <code>image.png</code>. How can I do that?</p>\n"},{"tags":["ruby-on-rails","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13222271,"title":"Why cannot include specific capybara Module?","body":"<p>Cant direct require a specific module for Capybara (<code>require 'capybara/helpers'</code>). its work for \n  <code>require 'capybara/dsl'</code>\n  or\n  <code>require 'capybara/rspec'</code></p>\n\n<p>result a exception:</p>\n\n<pre><code>(...)/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require': no such file to load -- capybara/helpers.rb (LoadError)\n</code></pre>\n\n<p>I dont know why some modules alowed to load on require <code>capybara/?</code> and others not.</p>\n"},{"tags":["ruby-on-rails","spork"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13222403,"title":"How do you setup spork-rails on Windows 7?","body":"<p>I'm going through the Rails Tutorial and my tests are taking forever so I want to implement spork. </p>\n\n<p>Since spork apparently doesn't work for rails anymore I have to do spork-rails instead. I updated my gem file to have spork-rails included and every time I try to run s<code>pork rspec --bootstrap</code> the command prompt says <code>'spork' is not a recognized internal command</code>. </p>\n\n<p>I took a look at the spork github page and it supports Windows but I can't tell if spork-rails does as well. Any tips?</p>\n"},{"tags":["ruby-on-rails","unit-testing","variable-types"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13222364,"title":"why are brackets used in this assert_equal statement","body":"<p>In the book Agile Web Development with Rails, they're teaching how to write test unit cases:</p>\n\n<pre><code>test \"product price must be positive\" do\n  product = Product.new(title: \"By Book Title\",\n                        description: \"yyy\",\n                        image_url: \"zzz.jpg\")\n  product.price = -1\n  assert product.invalid?\n  assert_equal [\"must be greater than or equal to 0.01\"], product.errors[:price]\nend\n</code></pre>\n\n<p>Concerning the assert_equal statement, why are brackets needed around the \"must be greater than...\" string.  I'm assuming variable types are coming into play here, but need some clarification on why.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","devise","acl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13221785,"title":"Rails, devise, acl","body":"<p>I have followed this tut <a href=\"http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html\" rel=\"nofollow\">http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html</a> I want to do something like this:</p>\n\n<pre><code>before_filter :authenticate_user!\nbefore_filter :authenticate_VIP!\nbefore_filter :authenticate_admin!\nbefore_filter :authenticate_somerole!\n</code></pre>\n\n<p>I have tables: roles, users, user_roles and I don't want to create another table (rails g devise VIP create another table). </p>\n\n<p>I want to have methods authenticate_ROLE. How to do this ?</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13220514,"title":"how to get the id from an object stored in a database in Ruby?","body":"<p>I am new to Ruby on Rails, and I would like to create a very simple website where I can save some citations.\nI have several tables: Citation and Autor, here are the corresponding models.</p>\n\n<pre><code>class Citation &lt; ActiveRecord::Base\n  belongs_to :autor\n  attr_accessible :text, :autor_id\nend\n\n\nclass Autor &lt; ActiveRecord::Base\n  has_many :citations\n  attr_accessible :name\nend\n</code></pre>\n\n<p>I would like that when an user create a new citation that bellow to a new autor, the autor has to be automatically created. </p>\n\n<p>Here is a part of my citations_controller:</p>\n\n<pre><code>def create\n    # Here I check if the autor already exist or not, if not, I create him (The user gave me his name)\n    if !(Autor.exists?(:name =&gt; params[:citation][:autor_id]))\n      Autor.create(:name =&gt; params[:citation][:autor_id])\n    end\n\n    #As I only have the name of the autor, I try to retrieve his Id\n    params[:autor_id] = Autor.where(:name =&gt; params[:citation][:autor_id]).first.id\n\n    @citation = Citation.new(params[:citation])\n\n  end\n</code></pre>\n\n<p>The point is, when I create a new citation, the field autor_id is filled with a 0 not with the correct ID of the autor. I think the mistake is when I try to retrieve the Id from the name, but I don't know how to fix it, and perhaps there is a simpler solution !</p>\n\n<p>Thank you !</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13222142,"title":"Argument of send_file","body":"<p>I put this in my Rails controller</p>\n\n<pre><code>send_file('/public/images/rails.png')\n</code></pre>\n\n<p>but it gives error</p>\n\n<pre><code>Cannot read file /public/images/rails.png\n</code></pre>\n\n<p>even though the file is there. How can I fix it?</p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","form-validation","simple-form"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13221641,"title":"Twitter Bootstrap + SimpleForm: appending an icon to a form field doesn't show error messages","body":"<p>I want to append an icon to a SimpleForm form field using Twitter Bootstrap. Here is the solution that I found in another SO question:</p>\n\n<pre><code>&lt;div class=\"input-append date\" id=\"birthday-picker\" data-date=\"06-04-1986\" data-date-format=\"dd-mm-yyyy\"&gt;\n    &lt;%= f.input :birthday, :wrapper =&gt; :append do %&gt;\n        &lt;%= f.input_field :birthday, as: :string, placeholder: \"06-04-1986\", readonly: true %&gt;\n        &lt;span class=\"add-on\"&gt;&lt;i class=\"icon-th\"&gt;&lt;/i&gt;&lt;/span&gt;\n    &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>However, when I add this piece of code to my form, the validation kicks in but the message is not shown for that particular field. Any ideas on what's happening please?</p>\n\n<h2>Update</h2>\n\n<p>Here is the HTML generated:</p>\n\n<pre><code>&lt;div class=\"input-append date\" id=\"birthday-picker\" data-date=\"06-04-1986\" data-date-format=\"dd-mm-yyyy\"&gt;\n    &lt;div class=\"control-group date required error\"&gt;\n        &lt;label class=\"date required control-label\" for=\"user_birthday\"&gt;Birthday &lt;abbr title=\"required\"&gt;*&lt;/abbr&gt;&lt;/label&gt;\n        &lt;div class=\"controls\"&gt;&lt;div class=\"input-append\"&gt;\n            &lt;input class=\"string required readonly\" id=\"user_birthday\" name=\"user[birthday]\" readonly=\"readonly\" size=\"50\" type=\"text\" value=\"31-03-2012\"&gt;\n            &lt;span class=\"add-on\"&gt;&lt;i class=\"icon-th\"&gt;&lt;/i&gt;&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;span class=\"help-inline\"&gt;You are too young&lt;/span&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>As you can see, the error message is generated. But for some reason, the span that contains the error message gets applied the following styles:</p>\n\n<pre><code>.input-append, .input-prepend {\n  font-size: 0;\n  white-space: nowrap;\n}\n</code></pre>\n\n<p>Even though it's outside the <code>input-append</code> div... Any ideas what's happening?</p>\n\n<h2>Update 2</h2>\n\n<p>The error message was in fact in an <code>input-append</code> div, which I removed. Now the error message appears but it's below the input, not inline like regular inputs...</p>\n"},{"tags":["ruby-on-rails","devise","omniauth","cancan","facebook-login"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13222037,"title":"Devise omniauth login with facebook","body":"<p>I followed <a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">this guide</a> to setup facebook sign up for my page. But my problem now is to get the users to sign in again when they visit the page. Currently users are given a random password when they sign in, but that isn't very useful when they want to login again. I know I need to use a token, but I just have doubts concerning how to implement it, so if anyone could point me in the right direction or link me a guide I would appreciate it. I have been looking everywhere but haven't found what I am looking for yet. Or at least not what I think I am looking for.</p>\n\n<p>Any help is welcome!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13221939,"title":"Ranking products in a database after each review is submitted","body":"<p>Just wondering if this would be a terrible approach. </p>\n\n<p>I need to Beyesian rank some products based on their review scores and # of reviews. I was previously doing this each time someone clicked on the 'product reviews' link.. </p>\n\n<p>I'm wondering if it's worth calculating the rank after each new review is submitted. This may change the rank of every product... I would then need to write the new rank to each product row? </p>\n\n<p>Is this a bad approach? Is it possible that two people could submit a review at the same time and crash the system?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","database","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13221541,"title":"How to disable database connection for local development?","body":"<p>I'm currently developing my Rails app on my local machine. I have no DB installed on my local machine, and I'm sending my codes to remote testing server which actually runs the app in development mode.</p>\n\n<p>Until yesterday all commands like <code>rails g model foo</code> or <code>rails g controller foo</code> on my local machine worked with no errors.</p>\n\n<p>But now all of <code>rails generate</code> commands started to fail due to no database connections. I think the direct reason is because I made some changes to my app configs, but I'm not sure where the changes are.</p>\n\n<p>I guess the wrong part is that <code>rails generate</code> commands are always invoking <code>active_record</code>\n which always verifies the DB connection.</p>\n\n<hr>\n\n<p>Now, my question is:</p>\n\n<p>Is there any way to temporally disable <code>rails</code> to verify the database connections, for local development(which has no DB connection available)?</p>\n\n<p>I tried removing <code>config/database.yml</code> but it didn't help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rack","amazon-cloudfront","rack-cache"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13155335,"title":"Bypass Rack::Cache for requests coming from a CDN","body":"<p>I have a Rails 3.2 app, deployed to heroku.  I use caching with <a href=\"https://github.com/rtomayko/rack-cache/\" rel=\"nofollow\">Rack::Cache</a> and Amazon CloudFront.</p>\n\n<p>For Requests that are served via CloudFront (assets, mostly), the caching layer with Rack::Cache is redundant and I'd rather not use it there (memcached on heroku is <em>expensive</em>)</p>\n\n<p>What is a good way to skip Rack::Cache for these requests?</p>\n"},{"tags":["ruby-on-rails","ruby","file-system"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13149159,"title":"special characters in path for rails send_file","body":"<p>I am using send_file in ROR to access files in my local file system, like this</p>\n\n<pre><code>send_file( path,\n  :disposition =&gt; 'inline',\n  :type =&gt; 'image/jpeg',\n  :x_sendfile =&gt; true )\n</code></pre>\n\n<p>Now for a path <code>/mnt/photos/myself.jpeg</code> this works fine, but then I have also downloads with ampersands in it, like <code>/mnt/photos/friends?firstname=john&amp;lastname=doe</code>. The filename will be cut after the first ampersand, and of course the file is not found.</p>\n\n<p>Is there a simple way to load the file with the ampersand in its name? Apart from renaming the file, of course.</p>\n\n<p>Hm no reply after 4 days... is the question too simple? Or too tough? I had hoped for something obvious...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","squeel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13177615,"title":"ruby on rails join conditions (with squeel)","body":"<p>I'm trying to use Squeel to compare attributes among the joined tables along with a little math.</p>\n\n<p>Here's an example of the query:</p>\n\n<pre><code>Parent.joins{[child1, child2.grandchildren]}.\nwhere{grandchildren.birth_datetime &gt; Time.now - child1.age.years}\n</code></pre>\n\n<p>I get an error from Squeel saying \"TypeError: can't convert Squeel::Nodes::KeyPath into an exact number\"</p>\n\n<p>Anyone know what I'm doing wrong here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13221357,"title":"Create a controller and view","body":"<p>Hello I have the following models.</p>\n\n<p>The User Model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :email, :password, :password_confirmation\n  has_one :user_informations\n  has_secure_password\nend\n</code></pre>\n\n<p>The UserInformation Model:</p>\n\n<pre><code>class UserInformation &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :address, :address2, :business, :descripcion, :identification_number, :mobile_cell, :name, :phone_number\nend\n</code></pre>\n\n<p>Now I need to create the view and the controller to create and update the user information, and I have many questions:</p>\n\n<p>1) how can I generate the controller:</p>\n\n<blockquote>\n  <p>rails g controller UserInformations</p>\n</blockquote>\n\n<p>o </p>\n\n<blockquote>\n  <p>rails g controller UserInformation</p>\n</blockquote>\n\n<p>2) how my new, create and update action know the user ID.</p>\n\n<p>3) how can I set the routes for this user information</p>\n\n<p>Thanks. Maybe these are a basic question, but I'm new in rails and I don't know how to do all of this.</p>\n\n<p>Thanks again for your help.</p>\n"},{"tags":["ruby-on-rails","database","heroku","push","taps"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":200,"score":0,"question_id":12088640,"title":"heroku db:push - Heroku client internal error","body":"<p>I am trying to put my local database to my existing app on Heroku and getting this error:</p>\n\n<pre><code>Sending schema\nSchema:        100% |==========================================| Time: 00:00:07\nSending indexes\nschema_migrat: 100% |==========================================| Time: 00:00:00\nSending data\n3 tables, 3,621 records\nschema_migrat: 100% |==========================================| Time: 00:00:00\n !    Heroku client internal error.===                         | ETA:  00:01:04\n !    Search for help at: https://help.heroku.com\n !    Or report a bug at: https://github.com/heroku/heroku/issues/new\n\n    Error:       undefined method `headers' for nil:NilClass (NoMethodError)\n    Backtrace:   /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/utils.rb:173:in `reraise_server_exception'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:522:in `rescue in block (2 levels) in push_data_from_table'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:507:in `block (2 levels) in push_data_from_table'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/utils.rb:102:in `calculate_chunksize'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:491:in `block in push_data_from_table'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:481:in `loop'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:481:in `push_data_from_table'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:476:in `block in push_data'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:471:in `each'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:471:in `push_data'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:412:in `block in run'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:203:in `call'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:203:in `catch_errors'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/operation.rb:405:in `run'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/taps-0.3.24/lib/taps/cli.rb:172:in `clientxfer'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.3/lib/heroku/command/db.rb:192:in `taps_client'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.3/lib/heroku/command/db.rb:30:in `push'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.3/lib/heroku/command.rb:193:in `run'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.3/lib/heroku/cli.rb:25:in `start'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/gems/heroku-2.30.3/bin/heroku:16:in `&lt;top (required)&gt;'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/bin/heroku:19:in `load'\n                 /Users/adam/.rvm/gems/ruby-1.9.2-p290/bin/heroku:19:in `&lt;main&gt;'\n\n    Command:     heroku db:push\n    Plugins:     heroku-sql-console\n    Version:     heroku-gem/2.30.3 (x86_64-darwin10.8.0) ruby/1.9.2\n</code></pre>\n\n<p>The weird thing is, that yesterday was everything ok and I was able to push my local database to Heroku without any problems.\nToday, I just add another column to my database and wanted to push it live - and got this error.</p>\n\n<p>I attempted to push the database live 3 times, all attempts failed.</p>\n\n<p>Where could be a problem?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13221597,"title":"Empty gem list, but can use rails --version","body":"<p>I understand that Rails is a gem. Which means when I run </p>\n\n<pre><code>gem list\n</code></pre>\n\n<p>the terminal should echo the name rails for me.</p>\n\n<p>My problem is that I can run</p>\n\n<pre><code>rails --version\n</code></pre>\n\n<p>but when it comes to <code>gem list</code> I only receive <code>*LOCAL GAME LIST*</code> without any text following.</p>\n\n<p>What could be wrong? Is it my understanding?</p>\n\n<p>Thank you and best regards</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","rails-postgresql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13214494,"title":"PostgreSQL Error for Select Distinct in Rails","body":"<p>On Mysql it works correctly.</p>\n\n<blockquote>\n  <p>PG::Error: ERROR: for SELECT DISTINCT, ORDER BY expressions must\n  appear in select list LINE 1: ) ORDER BY\n  programs.rating DESC, program_sc... ^ :</p>\n</blockquote>\n\n<p>Query:</p>\n\n<blockquote>\n  <p>SELECT DISTINCT \"programs\".* FROM \"programs\" INNER JOIN\n  \"program_schedules\" ON \"program_schedules\".\"program_id\" =\n  \"programs\".\"id\" WHERE (programs.rating >= 5 AND\n  program_schedules.start >= '2012-11-03 23:14:43.457659') AND (ptype =\n  'movie') ORDER BY programs.rating DESC,\n  program_schedules.start DESC</p>\n</blockquote>\n\n<p>Rails code:</p>\n\n<blockquote>\n  <p>@data =\n  Program.joins(:program_schedules).where('programs.rating >= ?\n  AND program_schedules.start >= ?',5,\n  Time.now).order('programs.rating DESC,\n  program_schedules.start DESC').uniq</p>\n</blockquote>\n\n<p>I have tried with</p>\n\n<blockquote>\n  <p>Program.select(\"programs.*,\n  program_schedules.*).joins(:program_schedules).where(...</p>\n</blockquote>\n\n<p>but, in this way, when I'm going to read </p>\n\n<blockquote>\n  <p>@data.program_schedules</p>\n</blockquote>\n\n<p>I get a nil value (When I know there are no nil values)</p>\n\n<h2>PostgreSQL 9.2 (Heroku), Ruby 1.9.2</h2>\n\n<p>Some info about my DB:</p>\n\n<pre><code>class Program &lt; ActiveRecord::Base\n   has_many :program_schedules\nend\n\n\nclass ProgramSchedule &lt; ActiveRecord::Base\n  belongs_to :program\nend\n</code></pre>\n\n<p>Schema.db</p>\n\n<pre><code> create_table \"program_schedules\", :force =&gt; true do |t|\n        t.integer  \"program_id\"\n        t.datetime \"start\"\n  end\n\n  create_table \"programs\", :force =&gt; true do |t|\n    t.string  \"title\",\n    t.string  \"ptype\"\n  end\n</code></pre>\n\n<p><strong>EDIT:</strong>\nI don't need to order \"programs_schedules\" because I need all programs_schedules in my array related to that program.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":695,"score":1,"question_id":9256770,"title":"Rails, undefined method error. But I can use this method in rails console","body":"<p>In my rspec testing. I got NoMethodError:\n           undefined method `password_digest='.</p>\n\n<p>But in rails console. I do can use .password_digest method.</p>\n\n<p>I am so confused. I searched google. Got sever threads about this. even in stackoverflow. But those don't help. I do have password_digest as a field in my database.</p>\n\n<p>I can even set my password_digest</p>\n\n<p>see:</p>\n\n<pre><code>1.9.2-p290 :005 &gt; user.password_digest\n =&gt; \"$2a$10$X8CSsstOqZKKA6qVHpW9.uH5Lzd7dxfGNCAxvIbePpcfBg8KFbD4y\" \n1.9.2-p290 :006 &gt; user.password_digest = 1\n =&gt; 1 \n1.9.2-p290 :007 &gt; user.password_digest\n =&gt; 1 \n</code></pre>\n\n<p>And also, in my app. everything seems fine. That's weird.\nPlease help...</p>\n\n<pre><code>1.9.2-p290 :002 &gt; User.first.password_digest\n  User Load (0.3ms)  SELECT \"users\".* FROM \"users\" LIMIT 1\n =&gt; \"$2a$10$NCfX2SgKeqGARJ68StxRJuCbbbK7g18n5FPxbHY5THwg4pAdHUvui\" \n1.9.2-p290 :003 &gt; \n[5]+  Stopped                 rails console\nluke@Macbook-Pro~/Documents/workspace/RoR/rails_projects/sample_app2012$ bundle exec rspec spec/models/user_spec.rb\n\nDEPRECATION WARNING: The InstanceMethods module inside ActiveSupport::Concern will be no longer included automatically. Please define instance methods directly in #&lt;Class:0x000001029f6688&gt; instead. (called from &lt;top (required)&gt; at /Users/luke/Documents/workspace/RoR/rails_projects/sample_app2012/spec/models/user_spec.rb:14)\nDEPRECATION WARNING: The InstanceMethods module inside ActiveSupport::Concern will be no longer included automatically. Please define instance methods directly in #&lt;Class:0x000001029f6688&gt; instead. (called from &lt;top (required)&gt; at /Users/luke/Documents/workspace/RoR/rails_projects/sample_app2012/spec/models/user_spec.rb:14)\nFFFFFFFFFFFFFFFFFFFFF\n\nFailures:\n\n  1) User \n     Failure/Error: @user = User.new(name: \"Example User\", email: \"user@example.com\",\n     NoMethodError:\n       undefined method `password_digest=' for #&lt;User:0x00000100beee60&gt;\n     # ./spec/models/user_spec.rb:17:in `new'\n     # ./spec/models/user_spec.rb:17:in `block (2 levels) in &lt;top (required)&gt;'\n..... There are 19 more failures, to save space, i didn't paste them here.\n</code></pre>\n\n<p>And this is my user_spec.rb code:</p>\n\n<pre><code># == Schema Information\n#\n# Table name: users\n#\n#  id         :integer         not null, primary key\n#  name       :string(255)\n#  email      :string(255)\n#  created_at :datetime        not null\n#  updated_at :datetime        not null\n#\n\nrequire 'spec_helper'\n\ndescribe User do\n\n  before(:each) do\n    @user = User.new(name: \"Example User\", email: \"user@example.com\", \n                     password: \"foobar\", password_confirmation: \"foobar\")\n  end\n\n\n\n  subject { @user }\n\n  it { should respond_to(:name) }\n  it { should respond_to(:email) }\n  it { should respond_to(:password_digest)}\n  it { should respond_to(:password)}\n  it { should respond_to(:password_confirmation)}\n  it { should respond_to(:remember_token) }\n  it { should respond_to(:authenticate) }\n\n  it { should be_valid }\n\n  describe \"when name is not present\" do\n    before { @user.name = \" \" }\n    it { should_not be_valid }\n  end\n\n  describe \"when email is not present\" do\n    before { @user.email = \" \" }\n    it { should_not be_valid }\n  end\n\n  describe \"when name is too long\" do\n    before { @user.name = \"a\" * 51 }\n    it { should_not be_valid }\n  end\n\n  describe \"when email format is valid\" do\n    valid_addresses = %w[user@foo.com THE_USER@foo.bar.org first.last@foo.jp]\n    valid_addresses.each do |valid_address|\n        before { @user.email = valid_address}\n        it {should be_valid }\n    end\n  end\n\n  describe \"when email address is already taken\" do\n    before do\n        user_with_same_email = @user.dup\n        user_with_same_email.email = @user.email.upcase\n        user_with_same_email.save\n    end\n\n    it { should_not be_valid }\n  end\n\n  describe \"when password is not present\" do\n    before { @user.password = @user.password_confirmation = \" \" }\n    it {should_not be_valid}\n  end\n\n  describe \"when password doesn't match confirmation\" do\n    before { @user.password_confirmation = \"mismatch\" }\n    it { should_not be_valid }\n  end\n\n  describe \"return value of authenticate method\" do\n    before { @user.save }\n    let(:found_user) { User.find_by_email(@user.email) }\n\n    describe \"with valid password\" do\n        it { should == found_user.authenticate(@user.password) }\n    end\n\n    describe \"with invalid password\" do\n        let(:user_for_invalid_password) { found_user.authenticate(\"invalid\") }\n\n        it { should_not == user_for_invalid_password }\n        specify { user_for_invalid_password.should be_false }\n    end\n\n    describe \"remember token\" do\n      before { @user.save }\n      its(:remember_token) { should_not be_blank }\n    end\n  end\nend\n</code></pre>\n\n<p>And this is my user.rb under modles:</p>\n\n<pre><code># == Schema Information\n#\n# Table name: users\n#\n#  id         :integer         not null, primary key\n#  name       :string(255)\n#  email      :string(255)\n#  created_at :datetime        not null\n#  updated_at :datetime        not null\n\n\n\nclass User &lt; ActiveRecord::Base\n  has_secure_password\n  attr_accessible :name, :email, :password, :password_confirmation\n\n\n\n  validates :name, presence: true, :length =&gt; { maximum: 50 }\n  valid_email_regex = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, :presence   =&gt; true,\n                    :format     =&gt; { with: valid_email_regex },\n                    :uniqueness =&gt; { case_sensitive: false }\n\n\n  validates :password,  length: { minimum: 6}\nend\n</code></pre>\n"},{"tags":["html","ruby-on-rails","mime","mailer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13140215,"title":"Rails mailer mimepart visible as text in message body","body":"<p>I'm sending test mail using ActionMailer. The template is being rendered and mail is being delivered fine. The only problem is the mimepart and other header data is displayed by Google in message body.</p>\n\n<p>Here is the code that mails..</p>\n\n<pre><code>def testing\n\n    mail(:to =&gt; \"apoorvparijat@gmail.com\",:subject =&gt; \"html mailer\", :content_type =&gt; \"text/html\") do |format|\n          format.html { render 'testing' }\n          format.text { render :text =&gt; \"bing\" }\n    end\nend\n</code></pre>\n\n<p>and Here's the email received. </p>\n\n<pre><code>----==_mimepart_508fd46252b8c_8023fe595835ad0479a6 Date: Tue, 30 Oct 2012 18:51:38 +0530     \nMime-Version: 1.0 Content-Type: text/plain; charset=UTF-8 Content-Transfer-Encoding: 7bit\nContent-ID: &lt;508fd46254ea7_8023fe595835ad0480b8@Apoorv-Parijats-MacBook-Pro-2.local.mail&gt; \nbing ----==_mimepart_508fd46252b8c_8023fe595835ad0479a6 Date: Tue, 30 Oct 2012 18:51:38 \n+0530 Mime-Version: 1.0 Content-Type: text/html; charset=UTF-8 Content-Transfer-Encoding:  \n7bit Content-ID: &lt;508fd46256465_8023fe595835ad04819c@Apoorv-Parijats-MacBook-Pro-\n2.local.mail&gt; Hi bing\ncolumn 1    column 2\n----==_mimepart_508fd46252b8c_8023fe595835ad0479a6--\n</code></pre>\n\n<p>Output of the console -</p>\n\n<pre><code> Loading development environment (Rails 3.2.2)\n 1.9.3-p125 :001 &gt; RankMailer.testing.deliver\n I, [2012-10-30T18:51:38.331238 #2050]  INFO -- :   Rendered rank_mailer/testing.html.erb           \n (1.8ms)\n I, [2012-10-30T18:51:38.333117 #2050]  INFO -- :   Rendered text template (0.0ms)\n I, [2012-10-30T18:51:45.824962 #2050]  INFO -- : \n Sent mail to apoorvparijat@gmail.com (7484ms)\n D, [2012-10-30T18:51:45.825125 #2050] DEBUG -- : Date: Tue, 30 Oct 2012 18:51:38 +0530\n From: admin@rankdemon.com\n To: apoorvparijat@gmail.com\n        Message-ID: &lt;508fd462572ec_8023fe595835ad0482c0@Apoorv-Parijats-MacBook-Pro-2.local.mail&gt;\n    Subject: html mailer\n    Mime-Version: 1.0\n    Content-Type: text/html;\n     charset=UTF-8\n    Content-Transfer-Encoding: 7bit\n\n\n\n    ----==_mimepart_508fd46252b8c_8023fe595835ad0479a6\n    Date: Tue, 30 Oct 2012 18:51:38 +0530\n    Mime-Version: 1.0\n    Content-Type: text/plain;\n     charset=UTF-8\n    Content-Transfer-Encoding: 7bit\n    Content-ID: &lt;508fd46254ea7_8023fe595835ad0480b8@Apoorv-Parijats-MacBook-Pro-2.local.mail&gt;\n\n    bing\n\n    ----==_mimepart_508fd46252b8c_8023fe595835ad0479a6\n    Date: Tue, 30 Oct 2012 18:51:38 +0530\n    Mime-Version: 1.0\n    Content-Type: text/html;\n     charset=UTF-8\n    Content-Transfer-Encoding: 7bit\n    Content-ID: &lt;508fd46256465_8023fe595835ad04819c@Apoorv-Parijats-MacBook-Pro-2.local.mail&gt;\n\n    Hi bing\n\n    &lt;table style=\"border:1px solid red\"&gt;\n        &lt;tr&gt;\n            &lt;td&gt;column 1&lt;/td&gt;\n            &lt;td&gt;column 2&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n\n    ----==_mimepart_508fd46252b8c_8023fe595835ad0479a6--\n\n     =&gt; #&lt;Mail::Message:70255316899740, Multipart: false, Headers: &lt;Date: Tue, 30 Oct 2012 18:51:38 +0530&gt;, &lt;From: admin@rankdemon.com&gt;, &lt;To: apoorvparijat@gmail.com&gt;, &lt;Message-ID: &lt;508fd462572ec_8023fe595835ad0482c0@Apoorv-Parijats-MacBook-Pro-2.local.mail&gt;&gt;, &lt;Subject: html mailer&gt;, &lt;Mime-Version: 1.0&gt;, &lt;Content-Type: text/html&gt;, &lt;Content-Transfer-Encoding: 7bit&gt;&gt;\n</code></pre>\n"}]}
{"total":93230,"page":10,"pagesize":100,"questions":[{"tags":["ruby-on-rails","deployment","capistrano","asset-pipeline","bootswatch"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":167,"score":0,"question_id":11645805,"title":"assets:precompile using capistrano failed","body":"<p>I deploy my app using capistrano. Everything works fine except assets:precomile, because capistrano wants to load the gems specified in the groups test and development, even if only the \"productive gems\" are installed. </p>\n\n<p>Below is the deploy output. All gems are installed correctly, but the asset precompile requires the development and test group. Why? If I uncomment both groups in the Gemfile and deploy again, everything works.</p>\n\n<p>Deployment output:</p>\n\n<pre>\n\n    sewids-MacBook-Pro:my-rails-project sebastian$ cap deploy\n      * executing `deploy'\n      * executing `deploy:update'\n     ** transaction: start\n      * executing `deploy:update_code'\n        updating the cached checkout on all servers\n        executing locally: \"git ls-remote git@github.com:myserver/my-rails-project.git master\"\n        command finished in 3229ms\n      * executing \"if [ -d /var/www/my-rails-project/shared/cached-copy ]; then cd /var/www/my-rails-project/shared/cached-copy && git fetch -q origin && git fetch --tags -q origin && git reset -q --hard dba547c9c7cdfc91886320f60cc87e64cb8c494c && git submodule -q init && for mod in `git submodule status | awk '{ print $2 }'`; do git config -f .git/config submodule.${mod}.url `git config -f .gitmodules --get submodule.${mod}.url` && echo Synced $mod; done && git submodule -q sync && export GIT_RECURSIVE=$([ ! \\\"`git --version`\\\" \\\\ /var/www/my-rails-project/releases/20120725052825/REVISION)\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n        command finished in 613ms\n      * executing `deploy:finalize_update'\n        triggering before callbacks for `deploy:finalize_update'\n      * executing `deploy:assets:symlink'\n      * executing \"rm -rf /var/www/my-rails-project/releases/20120725052825/public/assets &&\\\\\\n        mkdir -p /var/www/my-rails-project/releases/20120725052825/public &&\\\\\\n        mkdir -p /var/www/my-rails-project/shared/assets &&\\\\\\n        ln -s /var/www/my-rails-project/shared/assets /var/www/my-rails-project/releases/20120725052825/public/assets\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n        command finished in 613ms\n      * executing \"chmod -R g+w /var/www/my-rails-project/releases/20120725052825\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n        command finished in 391ms\n      * executing \"rm -rf /var/www/my-rails-project/releases/20120725052825/log /var/www/my-rails-project/releases/20120725052825/public/system /var/www/my-rails-project/releases/20120725052825/tmp/pids &&\\\\\\n      mkdir -p /var/www/my-rails-project/releases/20120725052825/public &&\\\\\\n      mkdir -p /var/www/my-rails-project/releases/20120725052825/tmp\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n        command finished in 528ms\n      * executing \"ln -s /var/www/my-rails-project/shared/system /var/www/my-rails-project/releases/20120725052825/public/system\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n        command finished in 613ms\n      * executing \"ln -s /var/www/my-rails-project/shared/log /var/www/my-rails-project/releases/20120725052825/log\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n        command finished in 614ms\n      * executing \"ln -s /var/www/my-rails-project/shared/pids /var/www/my-rails-project/releases/20120725052825/tmp/pids\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n        command finished in 614ms\n        triggering after callbacks for `deploy:update_code'\n      * executing `deploy:assets:precompile'\n        triggering before callbacks for `deploy:assets:precompile'\n      * executing `bundle:install'\n      * executing \"cd /var/www/my-rails-project/current && LC_ALL='en_US.UTF-8' bundle install --deployment --without test\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n     ** [out :: server1.myserver.de] Using rake (0.9.2.2)\n     ** [out :: server1.myserver.de] Using i18n (0.6.0)\n     ** [out :: server1.myserver.de] Using multi_json (1.3.6)\n     ** [out :: server1.myserver.de] Using activesupport (3.2.6)\n     ** [out :: server1.myserver.de] Using builder (3.0.0)\n     ** [out :: server1.myserver.de] Using activemodel (3.2.6)\n     ** [out :: server1.myserver.de] Using erubis (2.7.0)\n     ** [out :: server1.myserver.de] Using journey (1.0.4)\n     ** [out :: server1.myserver.de] Using rack (1.4.1)\n     ** [out :: server1.myserver.de] Using rack-cache (1.2)\n     ** [out :: server1.myserver.de] Using rack-test (0.6.1)\n     ** [out :: server1.myserver.de] Using hike (1.2.1)\n     ** [out :: server1.myserver.de] Using tilt (1.3.3)\n     ** [out :: server1.myserver.de] Using sprockets (2.1.3)\n     ** [out :: server1.myserver.de] Using actionpack (3.2.6)\n     ** [out :: server1.myserver.de] Using mime-types (1.19)\n     ** [out :: server1.myserver.de] Using polyglot (0.3.3)\n     ** [out :: server1.myserver.de] Using treetop (1.4.10)\n     ** [out :: server1.myserver.de] Using mail (2.4.4)\n     ** [out :: server1.myserver.de] Using actionmailer (3.2.6)\n     ** [out :: server1.myserver.de] Using arel (3.0.2)\n     ** [out :: server1.myserver.de] Using tzinfo (0.3.33)\n     ** [out :: server1.myserver.de] Using activerecord (3.2.6)\n     ** [out :: server1.myserver.de] Using activeresource (3.2.6)\n     ** [out :: server1.myserver.de] Using bcrypt-ruby (3.0.1)\n     ** [out :: server1.myserver.de] Using blankslate (2.1.2.4)\n     ** [out :: server1.myserver.de] Using bson (1.6.4)\n     ** [out :: server1.myserver.de] Using bson_ext (1.6.4)\n     ** [out :: server1.myserver.de] Using highline (1.6.13)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using net-ssh (2.5.2)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using net-scp (1.0.4)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using net-sftp (2.0.5)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using net-ssh-gateway (1.1.0)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using capistrano (2.12.0)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using coffee-script-source (1.3.3)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using execjs (1.4.0)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using coffee-script (2.2.0)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rack-ssl (1.3.2)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using json (1.7.3)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rdoc (3.12)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using thor (0.15.4)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using railties (3.2.6)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using coffee-rails (3.2.2)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using commonjs (0.2.6)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using country_select (1.0.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using daemons (1.1.8)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using diff-lcs (1.1.3)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using eventmachine (0.12.10)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using factory_girl (3.5.0)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using high_voltage (1.1.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using multi_xml (0.5.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using httparty (0.8.3)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using jbuilder (0.4.0)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using jquery-rails (2.0.2)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using less (2.2.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using less-rails (2.2.3)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using less-rails-bootstrap (2.0.13)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using less-rails-bootswatch (0.2.8)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using libv8 (3.3.10.4)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using moped (1.1.5)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using origin (1.0.4)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using mongoid (3.0.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using quiet_assets (1.0.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using bundler (1.2.0.rc)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rails (3.2.6)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rails-i18n (0.6.5)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rspec-core (2.11.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rspec-expectations (2.11.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rspec-mocks (2.11.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rspec (2.11.0)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rspec-rails (2.11.0)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using rvm-capistrano (1.2.5)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using sass (3.1.20)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using sass-rails (3.2.5)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using simple_form (2.0.2)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using therubyracer (0.10.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using thin (1.4.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using twitter-bootstrap-rails (2.1.1)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Using uglifier (1.2.6)\n     ** [out :: server1.myserver.de] \n     ** [out :: server1.myserver.de] Your bundle is complete! It was installed into ./vendor/bundle\n        command finished in 991ms\n      * executing \"cd /var/www/my-rails-project/releases/20120725052825 && rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n     ** [out :: server1.myserver.de] Could not find cucumber-1.2.1 in any of the sources\n     ** [out :: server1.myserver.de] Run `bundle install` to install missing gems.\n        command finished in 850ms\n    *** [deploy:update_code] rolling back\n      * executing \"rm -rf /var/www/my-rails-project/releases/20120725052825; true\"\n        servers: [\"server1.myserver.de\"]\n        [server1.myserver.de] executing command\n        command finished in 613ms\n    failed: \"rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell 'default' -c 'cd /var/www/my-rails-project/releases/20120725052825 && rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile'\" on server1.myserver.de\n\n</pre>\n\n<p>Any ideas how to change that?</p>\n\n<p>Best regards,\nsewid</p>\n\n<p>Working Gemfile is below, if I uncomment test and development, it's not working:</p>\n\n<pre>\n\n    source 'https://rubygems.org'\n\n    gem 'rails', '3.2.6'\n\n    group :assets do\n      gem 'sass-rails',   '~> 3.2.3'\n      # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n      # gem 'therubyracer', :platforms => :ruby\n      gem 'uglifier', '>= 1.0.3'\n    end\n\n    group :development do\n      #gem 'quiet_assets' \n      #gem 'rspec-rails' \n    end\n\n    group :test do\n      #gem 'rspec-rails'\n      #gem 'database_cleaner'\n      #gem 'cucumber-rails', :require => false\n      #gem 'launchy'\n      #gem 'spork', '~> 1.0rc'\n      #gem 'guard-spork'\n      #gem 'guard-rspec'\n      #gem 'rb-fsevent'\n      ##gem 'capybara-webkit'\n      #gem 'rspec-instafail'\n    end\n\n    gem 'jbuilder'\n    gem 'bundler', '1.2.0.rc'\n    gem 'coffee-rails', '~> 3.2.1'\n    gem 'jquery-rails'\n    gem 'bcrypt-ruby', '~> 3.0.0'\n    gem 'twitter-bootstrap-rails' \n    gem 'less-rails'\n    gem 'rails-i18n'\n    gem 'thin'\n    gem 'rails-i18n'\n    gem 'httparty'\n    gem 'json'\n    gem 'simple_form'\n    gem 'country_select'\n    gem 'bson_ext'\n    gem 'high_voltage'                          \n    gem 'mongoid'\n    gem 'origin'\n    gem 'moped'\n    gem 'less-rails-bootswatch'\n    gem 'factory_girl'\n    gem 'capistrano'\n    gem 'rvm-capistrano'\n\n</pre>\n"},{"tags":["ruby-on-rails","utf-8"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":13061836,"title":"Getting this error in rails: `ActionView::Template::Error (code converter not found (UTF-8 to UTF-16))`","body":"<p>I've started getting the following error in one of my views for some reason, I don't get it in development, but only in production.</p>\n\n<p>Here is a snippet of the backtrace, any ideas?</p>\n\n<pre><code>ActionView::Template::Error (code converter not found (UTF-8 to UTF-16)):\n    19:         [title, summary.gsub(/^/, \"  \"), nil].join(\"\\n\\n\")\n    20:       end\n    21:     end.join\n    22:     sections = sections.force_encoding('UTF-8').encode('UTF-16', :invalid =&gt; :replace).encode('UTF-8') if sections.respond_to?(:force_encoding)\n    23: %&gt;\n    24: \n    25: &lt;%= raw sections %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ajax","associations"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":21,"score":0,"question_id":13220746,"title":"Ajax form submit to add to favourites posts","body":"<p>I wanna to make ajax button \"Add to favourites\" in every post that will submit form and add record to posting table with fields(user_id, post_id)\nI have app with Posts and Users through Postings. </p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  has_many :postings, :dependent =&gt; :destroy\nend\n\nclass Posting &lt; ActiveRecord::Base\n  attr_accessible :post_id, :user_id\n  belongs_to :post\n  belongs_to :user\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :posts, :through =&gt; :postings\n  has_many :postings, :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>How would look like the form to submit data to create posting</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","erb"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13219475,"title":"Printing elements of array using ERB","body":"<p>I'm trying to print a simple array defined in my controller into my view with a new line for each element. But what it's doing is printing the whole array on one line.</p>\n\n<p>Here's my controller:</p>\n\n<pre><code>class TodosController &lt; ApplicationController\n  def index\n    @todo_array = [ \"Buy Milk\", \"Buy Soap\", \"Pay bill\", \"Draw Money\" ]\n  end\nend\n</code></pre>\n\n<p>Here's my view:</p>\n\n<pre><code>&lt;%= @todo_array.each do |t| %&gt;\n&lt;%= puts t %&gt;&lt;\\br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here's the result:</p>\n\n<pre><code>&lt;\\br&gt; &lt;\\br&gt; &lt;\\br&gt; &lt;\\br&gt; [\"Buy Milk\", \"Buy Soap\", \"Pay bill\", \"Draw Money\"]\n</code></pre>\n"},{"tags":["html","ruby-on-rails","script"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13220353,"title":"HTML Script Evaluations","body":"<p>Disclaimer: I'm still very new to web development in general, so I'm sorry if this is a terrible question.</p>\n\n<p>Why is everything in HTML evaluated on a line-by-line basis? I've noticed that any code (scripts?) that I throw into HTML requires me to cast it to its language on every single line like so:</p>\n\n<pre><code>&lt;div class = \"row\"&gt;\n    &lt;div class = \"span6 offset3\"&gt;\n        &lt;%= form_for(@user) do |f| %&gt;\n\n            &lt;%= f.label :name %&gt;\n            &lt;%= f.text_field :name %&gt;\n\n            &lt;%= f.label :email %&gt;\n            &lt;%= f.text_field :email %&gt;\n\n            &lt;%= f.label :password %&gt;\n            &lt;%= f.text_field :password %&gt;\n\n            &lt;%= f.label :password_confirmation, \"Confirmation\" %&gt;\n            &lt;%= f.text_field :password_confirmation %&gt;\n\n            &lt;%= f.submit \"Create My Account\", :class =&gt; \"btn btn-large btn-primary\" %&gt;\n\n        &lt;% end %&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But why can't it evaluate the scripts like this:</p>\n\n<pre><code>&lt;div class = \"row\"&gt;\n    &lt;div class = \"span6 offset3\"&gt;\n        &lt;%= form_for(@user) do |f|\n\n            f.label :name\n            f.text_field :name\n\n            f.label :email\n            f.text_field :email\n\n            f.label :password\n            f.text_field :password\n\n            f.label :password_confirmation, \"Confirmation\"\n            f.text_field :password_confirmation\n\n            f.submit \"Create My Account\", :class =&gt; \"btn btn-large btn-primary\"\n\n        end %&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Would it not make developing so much simpler to allow for this? To me, this just makes so much more sense, but its not done this way, probably for a good reason. If I'm writing out a fair bit of code (Ruby in this case), I am not a huge fan of casting every line at the start and finish.</p>\n\n<p>I get that I'm having the HTML evaluate each line as an HTML object by casting it, but is it not possible to just have it assume that every line (or some other syntax - maybe actually use semi-colons) is a new piece of script to evaluate?</p>\n\n<p>I guess what I'm asking is why are blocks of code evaluated this way and why hasn't it been made more efficient?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13220165,"title":"Eager loading of rails lib","body":"<p>It looks like this issue will be solved in Rails 4:\n<a href=\"http://blog.plataformatec.com.br/2012/08/eager-loading-for-greater-good/\" rel=\"nofollow\">http://blog.plataformatec.com.br/2012/08/eager-loading-for-greater-good/</a>\nbut until then, I'm wondering how to eager-load modules/classes in my <code>/lib</code>.</p>\n\n<p>In IRB it appears that they are loaded on-demand the first time I try to access:</p>\n\n<pre><code>Foo::Bar.constants\n=&gt; []\n\nFoo::Bar::Service\n=&gt; Foo::Bar::Service\n\nFoo::Bar.constants\n=&gt; [:ServiceBase, :Service]\n</code></pre>\n\n<p>I have several other classes in that module, and my code depends on being able to look them up using <code>Foo::Bar.const_defined?</code> at runtime - how do I ensure all <code>Foo::Bar</code>'s classes get loaded at startup?</p>\n\n<p>I'm already using <code>config.autoload_paths += %W(#{config.root}/lib)</code> in <code>application.rb</code>.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13219315,"title":"How to disable all form_for input fields in Ruby on Rails app?","body":"<p>I am trying to DRY up my Rails application a bit, so I would like to render a form in my <code>show</code> view but <em>disable</em> all input fields.</p>\n\n<pre><code>// show.html.erb\n\n&lt;%= form_for(@project) do |f| %&gt;\n  &lt;%= render 'fields', :f =&gt; f %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What would be the best way to do that?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":717,"score":3,"question_id":5602104,"title":"Accepts Nested Attribute with a virtual attribute","body":"<p>I have a Project model which accepts nested attributes for tasks. And Task has a virtual attribute \"name\". So every time I change the name, it gets persisted as encrypted_task_name before update. On the project edit page the form has a input field for task name (and not encrypted_task_name). When I change the name and since name is a virtual attribute, Rails doesn't detect a change in Task and doesn't update that task while updating Project.</p>\n\n<p>How do I make sure that task is saved even if its virtual attributes are changed during Project update?</p>\n\n<p>One option that I don't want to use is :autosave => true on task.rb since I task is rarely updated.</p>\n"},{"tags":["ruby-on-rails","forms","model","nested-forms","nested-attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13211597,"title":"Rails Puzzle: Check if a nested value exists, if it does don't save it but save the child values","body":"<p>I have a challenge that I have been struggling to tackle for the last few hours. </p>\n\n<p>I have a form with nested attributes. Each Post has and belongs to many Locations. I need each Location to be unique but I also need to be able to add the same location to many posts. Ideally this validation would be done within the model. </p>\n\n<ul>\n<li>So, in my posts form what currently happens is a user 'adds a\nlocation', they then search the foursquare API for a location. </li>\n<li>Upon submit this is saved into the Locations table with the location name and the\nlongitude and latitude, there is a Locations_Posts table which ties\nthese together.  </li>\n<li>What needs to happen is the posts model should check\nif a location exists, if it does, don't add anything to Locations,\njust add the relevant data to the Locations_Posts table.</li>\n</ul>\n\n<p>After some research I have worked out that I need something like this:</p>\n\n<pre><code>*Posts.rb*\n\n# =================\n# = Location validations = \n# = If location exists then just add to locations_posts, else create new location =\n\ndef locations_attributes\nlocation &amp;&amp; location.name\nend\n\ndef locations_attributes=(value)\nself.location = Location.find_by_name(value)\nself.location ||= Location.new(:name =&gt; value)\nend\n</code></pre>\n\n<p>(Stolen from <a href=\"http://stackoverflow.com/questions/3588811/rails-create-parent-if-doesnt-exist-whilte-creating-child-record\">rails: create Parent, if doesn&#39;t exist, whilte creating child record</a>)</p>\n\n<p>However, I'm getting errors such as:</p>\n\n<pre><code>Unknown key: 0\n</code></pre>\n\n<p>I think I must be close with this snippet but need some help to get over the last hurdle!</p>\n\n<p>Thanks in advance,</p>\n\n<p>James</p>\n"},{"tags":["ruby-on-rails","routing"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":11203961,"title":"form_for routing in nested resources","body":"<p>I am trying to finish an application which User can open a Topic and other Users can comment with Posts. I nested my resources in routes.rb:</p>\n\n<pre><code>resources :users\n\nresources :sessions, only: [:new, :create, :destroy]\nresources :topics, only: [:show, :create, :destroy] do\n\nresources :posts\n</code></pre>\n\n<p>my rake routes show :</p>\n\n<pre><code>    topic_posts GET    /topics/:topic_id/posts(.:format)          posts#index\n                POST   /topics/:topic_id/posts(.:format)          posts#create\n new_topic_post GET    /topics/:topic_id/posts/new(.:format)      posts#new\nedit_topic_post GET    /topics/:topic_id/posts/:id/edit(.:format) posts#edit\n     topic_post GET    /topics/:topic_id/posts/:id(.:format)      posts#show\n                PUT    /topics/:topic_id/posts/:id(.:format)      posts#update\n                DELETE /topics/:topic_id/posts/:id(.:format)      posts#destroy\n         topics POST   /topics(.:format)                          topics#create\n          topic GET    /topics/:id(.:format)                      topics#show\n</code></pre>\n\n<p>In my homepage, I build   a clickable list of Topics and a textarea which you can open a topic. Now  if you click a Topic link, i want it to show you the  page which shows Topic name in the top, Posts below and a Post form under it in the same page.\nshow.html.erb : </p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n&lt;div class=\"span6 offset4\"&gt;\n    &lt;h3&gt;&lt;%= @topic.title %&gt;&lt;/h3&gt;\n    &lt;h4&gt;&lt;%= render 'shared/posts'%&gt;&lt;/h4&gt;\n&lt;%= render 'shared/post_form' %&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>my posts_controller is : </p>\n\n<pre><code># encoding: utf-8\n\nclass PostsController &lt; ApplicationController\n    before_filter :signed_in_user, only: [:create, :destroy]\n  before_filter :correct_user, only: :destroy\n\n    def new\n        @topic= Topic.find_by_id(params[:id])\n        @post = @topic.build_post\n    end\n\n    def show\n    @topic = Topic.find(params[:id])\n    @posts = @topic.posts.paginate(page: params[:page])\n  end \n\n    def create\n        @topic = Topic.find(params[:id])\n        @post = @topic.posts.build(params[:post])\n        if @post.save\n            flash[:success] = \"Konu oluşturuldu!\"\n            redirect_to root_path\n        else\n            render 'static_pages/home'\n        end\n    end\n\n  def destroy\n    @post.destroy\n    redirect_to root_path\n  end\n  private\n\n    def correct_user\n      @post = current_user.posts.find_by_id(params[:id])\n      redirect_to root_path if @post.nil?\n    end\nend\n</code></pre>\n\n<p>and _posts.html.erb :</p>\n\n<pre><code>%  @posts.each do |post| %&gt;  \n  &lt;li&gt;&lt;%= post.content %&gt;&lt;/li&gt;  \n\n &lt;%= will_paginate @posts %&gt;\n&lt;% end %&gt;  \n</code></pre>\n\n<p>_post_form.html.erb : </p>\n\n<pre><code>&lt;%= form_for([@topic, @post]) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n        &lt;%= f.text_area :content, placeholder: \"yorumunuzu girin...\" %&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Gönder\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The error is in _post_form.html.erb  as => </p>\n\n<pre><code>undefined method `model_name' for NilClass:Class\n\nExtracted source (around line #1):\n\n1: &lt;%= form_for([@topic, @post]) do |f| %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":85,"score":1,"question_id":11189139,"title":"How to keep a transient variable as part of ActiveRecord","body":"<p>I would like to show a variable (which is actually a List) as part of f.select(..) function in Rails3.2, so that the selected value is stored in a different attribute in the ActiveRecord object. How do I declare the above List variable as a transient variable in ActiveRecord, so that ActiveRecord doesn't try to store this.</p>\n"},{"tags":["ruby-on-rails","forms","activerecord","model","scaffolding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13219679,"title":"How to define form select values via model in Rails?","body":"<p>I created a simple model called Categories, which is connected to Platforms model.</p>\n\n<pre><code>class Platform &lt; ActiveRecord::Base\n    attr_accessible :name, :url, :country, :categories\n   belongs_to  :category\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_many :platforms\nend\n</code></pre>\n\n<p>I also successfully have form for creating new Platforms :</p>\n\n<pre><code>&lt;%= simple_form_for(@platform) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n\n  &lt;div class=\"form-inputs\"&gt;\n    &lt;%= f.input :name %&gt;\n    &lt;%= f.input :url %&gt;\n    &lt;%= f.input :country %&gt;\n    &lt;%= f.label :category %&gt;\n    &lt;%= f.collection_select(:category_id, @categories, :id, :name, :include_blank =&gt; \"Please select\") %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n    &lt;%= f.button :submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Unfortunately ,since model Category is new, dropdown currently has only 1 value \"Please selected\". How do I add new values to this select, preferably via the model?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activesupport"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13218123,"title":"Activesupport titlecase() with bang (.titlecase!)?","body":"<p>I currently have a string with customer names that I am titlecasing with:</p>\n\n<pre><code>@customer_name = @customer_name.titlecase\n</code></pre>\n\n<p>But this seems a bit long-winded. When I try to do:</p>\n\n<pre><code>@customer_name.titlecase!\n</code></pre>\n\n<p>I get a no method error. Does <code>titlecase!</code> exist? It seems odd that there wouldn't be a way to do this, since there is a <code>downcase!</code>, for example.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13218814,"title":"Ruby on Rails has many relation table","body":"<p>I have a table <strong>rb</strong> wich has many <strong>interfaces</strong>, then each interface has many <strong>interface_graph_data</strong>. Now my rb interface has_many relation seems to work fine, my only problem is the interface interface_graph_data relation. Here are my models.</p>\n\n<pre><code>class Rb &lt; ActiveRecord::Base\n    validates_presence_of :name\n    validates_presence_of :ip\n    validates_uniqueness_of :ip\n    validates_presence_of :username\n    validates_presence_of :password\n\n    has_many :interfaces\n    has_many :interfacegraphdata, :through =&gt; :interfaces\nend\n</code></pre>\n\n<p><br /></p>\n\n<pre><code>class Interface &lt; ActiveRecord::Base\n    has_many :interfacegraphdata\nend\n</code></pre>\n\n<p><br /></p>\n\n<pre><code>class InterfaceGraphData &lt; ActiveRecord::Base\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","routes","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":700,"score":0,"question_id":5725094,"title":"Different '/' root path for users depending if they are authenticated (using devise)","body":"<p>I'm writing a rails app in which I have an Editor and a Publication model. I'm using devise for editors authentication and, since an editor can't do anything as guest, I wrote a custom layout to use for the login page and I want that a guest user can see only the login page.</p>\n\n<p>Now I'm trying to achieve the following behavior in my app but unsuccessfully:</p>\n\n<pre><code>require 'spec_helper'\nrequire 'capybara/rails'\n\ndescribe \"Authentication\" do\n\n  describe \"when logged in\" do\n    before(:each) do\n      @editor = Factory(:editor, :password =&gt; 'secret')\n      visit '/'\n      fill_in 'Login', :with =&gt; @editor.login\n      fill_in 'Password', :with =&gt; 'secret'\n      click_button 'Sign in'\n      page.should have_content('Signed in successfully.')\n    end\n\n    it \"getting / should render publication page with no redirection\" do\n      visit '/'\n      page.should_not have_content('Login')\n      page.should have_content('Publications')\n      # assert that there is no redirection\n      page.current_path.should == '/'\n    end\n\n    it \"visits the sign_in page should redirect to /\" do\n      visit '/editors/sign_in'\n      page.should have_content('Publications')\n      page.current_path.should == '/'\n    end\n\n  end\n\n  describe \"when not logged in\" do\n    it \"getting / should not display the sign in warning\" do\n      visit '/'\n      # I want to get rid of this message\n      page.should_not have_content('You need to sign in or sign up before continuing.')\n    end\n\n    it \"getting / should not redirect to the sign_in default page\" do\n      visit '/'\n      page.should have_content('Login')\n      # assert that there is no redirection\n      page.current_path.should == '/'\n    end\n\n    it \"getting the the sign_in default path works\" do\n      visit '/editors/sign_in'\n      page.should have_content('Login')\n      page.current_path.should == '/editors/sign_in'\n    end\n\n    it \"login works and redirect me to the publications page (with /)\" do\n      @editor = Factory(:editor, :password =&gt; 'secret')\n      visit '/'\n      fill_in 'Login', :with =&gt; @editor.login\n      fill_in 'Password', :with =&gt; 'secret'\n      click_button 'Sign in'\n      page.should have_content('Signed in successfully.')\n      page.current_path.should == '/'\n      page.should have_content('Publications')\n    end\n  end\nend\n</code></pre>\n\n<p>The main issue is that I want to get rid of 'You need to sign in or sign up before continuing.' message when a guest user visit '/'.</p>\n\n<p>I tried with hints taken from <a href=\"http://stackoverflow.com/questions/3791096/devise-logged-in-root-route-rails-3/3846685#3846685\">here</a> and <a href=\"https://github.com/plataformatec/devise/issues/974#issuecomment-975797\" rel=\"nofollow\">here</a> but with no luck.</p>\n\n<p>Any hint on how implement this with devise?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13146425,"title":"HAML and mistake in form_for","body":"<p>I'm learning HAML and I have a problem with from_for</p>\n\n<pre><code>%b New Advert!\n\n- form_for @car, :url =&gt; { :action =&gt; \"create\" } do |f|\n  = f.text_field :body \n  = f.submit t('advert.form.save')\n</code></pre>\n\n<p>My Controller advert_controller</p>\n\n<pre><code>class AdvertController &lt; ApplicationController\n  def new\n    @car = Car.new\n  end\n\n  def create\n    @car = Car.new(params[:car])\n  end\nend\n</code></pre>\n\n<p>And my model car.rb</p>\n\n<pre><code>class Car &lt; ActiveRecord::Base\n  attr_accessible :title, :body\nend\n</code></pre>\n\n<p>But I have a mistake:</p>\n\n<p>undefined method `body' for #</p>\n\n<p>NoMethodError in Advert#new</p>\n\n<p>Showing /my_project/app/views/advert/new.html.haml where line #4 raised</p>\n\n<p><strong>UPD</strong> form_for with '=' doesn't work</p>\n\n<pre><code>= form_for @car, :url =&gt; { :action =&gt; \"create\" } do |f|\n      = f.text_field :body \n      = f.submit t('advert.form.save')\n</code></pre>\n"},{"tags":["ruby-on-rails","gem","editor","aptana","open"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13218511,"title":"How to set Aptana to be my default BUNDLER_EDITOR?","body":"<p>I try to open a gem using the following command:</p>\n\n<pre><code>$bundle open jquery-rails\n</code></pre>\n\n<p>but it gives me the following error:</p>\n\n<pre><code>To open a bundled gem, set $EDITOR or $BUNDLER_EDITOR\n</code></pre>\n\n<p>So,I have search a little bit at read that I should open my .bashrc file and set the BUNDLER_EDITOR variable. I did the following things:</p>\n\n<pre><code>sudo gedit ~/.bashrc\n</code></pre>\n\n<p>and at end of the file entered the line above:</p>\n\n<pre><code>export BUNDLER_EDITOR=aptana\n</code></pre>\n\n<p>In the example they are using vim but since I am using aptana studio 3 I want to use it.</p>\n\n<p>Anyway, it give me the following error:</p>\n\n<blockquote>\n  <p>Could not run 'aptana\n  /home/gotqn/.rvm/gems/ruby-1.9.3-p286/gems/jquery-rails-2.1.3'</p>\n</blockquote>\n\n<p>What I am doing wrong?</p>\n"},{"tags":["ios","ruby-on-rails","devise","afnetworking"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":100,"score":2,"question_id":12047298,"title":"iOS, AFNetworking and Rails/Devise","body":"<p>I've tried searching for examples and answers on this subject but all seemed to be more specific or not exactly relevant to my issue. I'm fairly new to Rails and an intermediate iOS developer. I'm looking to use Rails as a backend to drive a user login based app. I've tried to find example code of how to authenticate with devise using AFHTTPClient but have had no success. The iOS code I am using is:</p>\n\n<pre><code>- (IBAction)submitLogin:(id)sender {\n    NSString *username = usernameField.text;\n    NSString *password = passwordField.text;\n    [[AFTestClient sharedClient] setAuthorizationHeaderWithUsername:username password:password];\n    [[AFTestClient sharedClient] postPath:@\"login/\" parameters:nil success:^(AFHTTPRequestOperation *operation, id responseObject) {\n     NSLog(@\"Success\");\n\n} failure:^(AFHTTPRequestOperation *operation, NSError *error) {\n    NSLog(@\"Failure\");\n}];\n}\n</code></pre>\n\n<p>and this is the controller I have set up in Rails with /login matching to activities#login:</p>\n\n<pre><code>class ActivitiesController &lt; ApplicationController\nbefore_filter :authenticate_user!, :only =&gt; [:login, :index]\n\ndef login\n  @user = current_user\n  respond_to do |format|\n    format.html {render :text =&gt; \"#{@user.id}\"} \n    format.xml {render :text =&gt; \"#{@user.id}\" }   \n  end\nend\n\ndef index\n    @user = current_user\n    respond_to do |format|\n    format.html {render :text =&gt; \"Current user is logged in.\"} \n    format.xml {render :text =&gt; \"#{@user.id}\" }   \n    format.json\n  end\nend\nend\n</code></pre>\n\n<p>I know my standard requests that don't require authentication are going through but I'm assuming the Authentication Header is not being recognized by Devise or something along those lines.</p>\n\n<p>Any responses would be greatly appreciated, especially examples to similar code accomplishing the same task.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","hash","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13218378,"title":"Getting the contents of a hash","body":"<pre><code>{\"test_url\"=&gt;\"http://test.com/123.jpg\"} \n</code></pre>\n\n<p>is my output from</p>\n\n<pre><code>&lt;% @results.each do |t| %&gt;\n    &lt;%= t.image.extract!(\"test_url\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How can i just get the contents of test_url? so <a href=\"http://test.com/123.jpg\" rel=\"nofollow\">http://test.com/123.jpg</a></p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13206986,"title":"How to persist changes made to Rails view rendered at client?","body":"<p>In my Rails app, I have a view that allows user to modify the rendered HTML, such as move the buttons around, changing the colors of a DIV etc. How can I persist those changes such that when the view is rendered next time, those changes are reflected?</p>\n\n<p>My first thought was to store the modified HTML into database as a text column. However I really don't like this approach since the HTML can be arbitrarily large, not to mention performance will be very bad. I dug around and so far haven't a clue, which is puzzling to me since I don't think this is that rare of a scenario: WYSIWYG type editor, website builder application should all need to solve this problem. Which makes me wonder if I'm going down the wrong track.</p>\n\n<p>Any insights are greatly appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby","windows","git-bash"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":376,"score":0,"question_id":9267420,"title":"Rails using gitbash and ruby installer. rails command not found","body":"<p>I am trying to get Ruby on Rails going on my Windows 7 machine. I am using gitbash and have install ruby using ruby installer. All my gems have installed successfully (Rails 3.0.7), but when I try to run a command like <code>rails s</code> I get <code>sh.exe\": rails: command not found</code></p>\n\n<p><code>echo $PATH</code> gives me:</p>\n\n<p><code>/c/Users/Dave/bin:.:/usr/local/bin:/mingw/bin:/bin:/c/Ruby192/bin:/c/Program Files/Common Files/Microsoft Shared/Windows Live:/c/Program Files/NVIDIA Corporation/PhysX/Common:/c/Windows/system32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/c/Program Files/Common Files/Adobe/AGL:/c/Program Files/QuickTime/QTSystem/:/c/Program Files/Common Files/Microsoft Shared/Windows Live</code></p>\n\n<p>Since the path for Ruby is in there I am at a bit of a loss for how to be able to start the rails server.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":561,"score":1,"question_id":8047651,"title":"No Javascript runtime on windows when running rails server","body":"<p>I'm completely new to Ruby on Rails, and I'm having trouble setting it up on my <strong>Windows PC</strong>.  I have successfully followed the instructions on <a href=\"http://rubyonrails.org/download\" rel=\"nofollow\">http://rubyonrails.org/download</a>.  However, when I go to run the <code>rails server</code> command I come up with this output:</p>\n\n<pre><code>C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs/runtimes.rb:47:in `a\nutodetect': Could not find a JavaScript runtime. See https://github.com/sstephen\nson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs.rb:5:in\n `&lt;module:ExecJS&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs.rb:4:in\n `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_\nscript.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_\nscript.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-\nscript.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-\nscript.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-rails-3.1.1/lib/coffee-r\nails.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-rails-3.1.1/lib/coffee-r\nails.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:68:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:68:in `block (2 levels) in require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:66:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:66:in `block in require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:55:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:55:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler.rb:1\n22:in `require'\n        from C:/RoR/tickets/config/application.rb:7:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:52:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:52:in `block in &lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:49:in `tap'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:49:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>When i go to the website <a href=\"https://github.com/sstephenson/execjs\" rel=\"nofollow\">https://github.com/sstephenson/execjs</a> I'm still uncertain of how to proceed.  <strong>Can someone point me in the right direction (remember I'm a newbie)?</strong>  Thanks!</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","node.js","ruby-on-rails-3.1"],"answer_count":5,"favorite_count":18,"up_vote_count":31,"down_vote_count":0,"view_count":13362,"score":31,"question_id":7092107,"title":"Rails 3.1 error - Could not find a JavaScript runtime?","body":"<p>I created a new Rails project using <code>rails 3.1.0.rc4</code> on my local machine but when I try to start the server I get:\nCould not find a JavaScript runtime. See <a href=\"https://github.com/sstephenson/execjs\">here</a> for a list of available runtimes. (<code>ExecJS::RuntimeUnavailable</code>)</p>\n\n<p>Note: This is not about Heroku.</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","jquery-ui","require"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13218006,"title":"Ruby on Rails - how require is executed in application.js","body":"<p>I am reading a book for \"Ruby on Rails\". In the \"application.js\", we are including other JavaScript libraries in the following way and more specific - jQuery UI:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery-ui\n</code></pre>\n\n<p>As this is ordinary JavaScript file (not ruby extensions here like \"html.erb\" for exmaple) how the application knows to execute the require command? What kind of JavaScript syntax is this:</p>\n\n<pre><code>//= \n</code></pre>\n\n<p>and as this is ordinary JavaScript file, why we are not using \"script\" tags to include JavaScript files?</p>\n\n<p>Also, I have read <a href=\"http://ruby.about.com/od/rubyfeatures/a/require.htm\" rel=\"nofollow\">here</a> that \"require\" method will check for this library in define by $LOAD_PATH  variable folders. How can I see where the \"jquery-ui\" is stored? I am asking because in other applications in order to use jQuery UI I should add not only JavaScript file, but css file and images used by the library - in this case, we are doing this only with single line?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13212059,"title":"Purpose of the sass-rails gem in rails","body":"<p>What is the purpose of the <code>gem 'sass-rails'</code> that is included by default in the <code>:assets</code> group of a new rails app ?</p>\n\n<p>If I comment out that line I can still use <code>.css.scss</code> files without a problem.</p>\n"},{"tags":["mysql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13218075,"title":"Insert Data into Database in Ruby on Rails","body":"<p>I got 2 Models, Main Model and Details Model.\nIn my Home Controller i want to insert 1.000.000 entries into the database, just for testing issues.</p>\n\n<p>But this is very slow, the inserts are happening very slow.. is it possible to speed this up? </p>\n\n<p>Maybe i did something wrong with the configuration?\nBecause i want, every time a Main entry is saved, a corresponding detail entry should be created.</p>\n\n<p>Main Model looks like:</p>\n\n<pre><code>class Main &lt; ActiveRecord::Base\n  has_one :detail, :dependent =&gt; :destroy\n  before_create :build_a_detail\n\nprivate\n  def build_a_detail\n       self.build_detail(:Bezeichnung =&gt; 'test', :Koordinaten =&gt; 10, :main_id =&gt; self.id)\n  end\nend\n</code></pre>\n\n<p>Detail Model looks like:</p>\n\n<pre><code>class Detail &lt; ActiveRecord::Base\n  belongs_to :main\nend\n</code></pre>\n\n<p>Home Controller:</p>\n\n<pre><code>def new\n    for i in 0..1000000\n      main = Main.new(:Category =&gt; 'Krankenhaus', :Latitude =&gt; 5, :Longitude =&gt; 6)\n      main.save\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","methods"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":9798237,"title":"What is the difference in \"Processing by Contoller#method as */*\" and \"Processing by BillsController#show as HTML\"","body":"<p>All of my rails 3.2.2 ActiveRecord methods are being executed twice. I noticed that each execution is being processed differently, see the examples I grabbed from the console below...</p>\n\n<pre><code>Started GET \"/api/bills/Jeremy%20Fox\" for 127.0.0.1 at 2012-03-20 23:16:43 -0400\nProcessing by BillsController#show as HTML\n  Parameters: {\"username\"=&gt;\"Jeremy Fox\"}\n  BillsForUsers Load (2.4ms)  SELECT \"bills_for_users\".* FROM \"bills_for_users\" WHERE \"bills_for_users\".\"billusername\" = 'Jeremy Fox'\nCompleted 200 OK in 47ms (Views: 11.2ms | ActiveRecord: 2.4ms)\n\n\nStarted GET \"/api/bills/Jeremy%20Fox\" for 127.0.0.1 at 2012-03-20 23:16:44 -0400\nProcessing by BillsController#show as */*\n  Parameters: {\"username\"=&gt;\"Jeremy Fox\"}\n  BillsForUsers Load (1.1ms)  SELECT \"bills_for_users\".* FROM \"bills_for_users\" WHERE \"bills_for_users\".\"billusername\" = 'Jeremy Fox'\nCompleted 200 OK in 33ms (Views: 28.1ms | ActiveRecord: 1.1ms)\n</code></pre>\n\n<p>Can anyone explain to me why all of my ActiveRecord methods are being executed twice and/or what the difference is between <code>Processing by BillsController#show as HTML</code> and <code>Processing by BillsController#show as */*</code>?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","activerecord","has-many-through"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13216251,"title":"Active Record has_many :through remove one associated record","body":"<p>This may be a very basic oversight on my part, but I can't seem to recall a simple method for removing an association between two objects joined via <code>has_many :through</code>. IE:</p>\n\n<pre><code>class Photo\n  has_many :tags, :through =&gt; :taggings\n  has_many :taggings, :dependent =&gt; :destroy\nend\n\nclass Tags\n  has_many :photos, :through =&gt; :taggings\n  has_many :taggings, :dependent =&gt; :destroy\nend\n\nclass Taggings\n  belongs_to :photo\n  belongs_to :tag\nend\n</code></pre>\n\n<p>If you have two objects, <code>tag</code> and <code>photo</code>, you can associate them just by doing this:</p>\n\n<pre><code>photo.tags &lt;&lt; tag\n</code></pre>\n\n<p>So, is there an equally simple opposite to this? ie:</p>\n\n<pre><code>photo.tags.remove tag\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13216826,"title":"Can't run rails command when installing Rails without RVM","body":"<p>I can't get to install rails correctly, after doing \"sudo gem install rails\", all goes well, but if I try doing \"rails -v\", I get \"Rails is not currently installed on this system...\", I'm not using RVM, I installied Ruby through Homebrew.</p>\n\n<p>The rails executable is in \"/usr/local/Cellar/ruby/1.9.3-p286/bin/rails\", but even if I add that path to my $PATH it won't find it, or something else in RubyGems is going wrong...</p>\n"},{"tags":["ruby-on-rails","radiant"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13217832,"title":"System Stack Error for Radiant 1.1.0","body":"<p>After installing Radiant 1.1.0, I can get DEMO site running. But after viewing a few of pages (public pages or admin pages), I got those errors. </p>\n\n<pre><code>SystemStackError (stack level too deep):\n\nRendered rescues/_trace (1.4ms)\nRendered rescues/_request_and_response (1.1ms)\nRendering rescues/layout (internal_server_error)\nIllegal instruction: 4\n</code></pre>\n\n<p>I changed my ruby stack size and even reinstalled my system but still can't fix the errors. I didn't encounter any issues when I was with radiant 1.0.1. </p>\n\n<p>I am using</p>\n\n<pre><code>rvm 1.16.17 (stable)\nbrew installed GCC /usr/local/Cellar/apple-gcc42/4.2.1-5666.3\nmysql-5.5.27\n\nRubyGems Environment:\n  - RUBYGEMS VERSION: 1.8.24\n  - RUBY VERSION: 1.9.3 (2012-10-12 patchlevel 286) [x86_64-darwin11.4.2]\n  - INSTALLATION DIRECTORY: /Users/harry/.rvm/gems/ruby-1.9.3-p286@test1\n  - RUBY EXECUTABLE: /Users/harry/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/harry/.rvm/gems/ruby-1.9.3-p286@test1/bin\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-11\n  - GEM PATHS:\n     - /Users/harry/.rvm/gems/ruby-1.9.3-p286@test1\n     - /Users/harry/.rvm/gems/ruby-1.9.3-p286@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :benchmark =&gt; false\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - http://rubygems.org/\n</code></pre>\n\n<p>I have spent 2 weeks but still can't sort it out. Any help will be appreciated. </p>\n"},{"tags":["javascript","ruby-on-rails","dynamic","menu","ancestry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13217873,"title":"dynamic dropdown menu ancestry and rails 3","body":"<p>Hi I have try to do dynamic drop down menu using ancestry and rails 3.2 but don't have to much experience with javascript. \nI have got categories with ancestry tree and Ads (model/controller). Ads should have one category. So my idea is when I create a Ad I will chose from dropdown menu category.\nIn categories for example I've got </p>\n\n<p>-Cars\n - Alfa Romeo\n - -145\n - -146\n - Audi\n - -A4\nHow should I change or create javascript to get first category.roots, after chose Cars get (alfa romeo, audi) after chose audi get models?\n<a href=\"http://railscasts.com/episodes/88-dynamic-select-menus\" rel=\"nofollow\">I've try to folow this link railscast</a> but dont know how to change javascript.</p>\n\n<p>javascript_controller</p>\n\n<pre><code>class JavascriptsController &lt; ApplicationController\n</code></pre>\n\n<p>def dynamic_category\n    @categories = Category.roots.all</p>\n\n<p>end\nend</p>\n\n<p>dynamic_category.js.erb</p>\n\n<pre><code>var categories = new Array();\n&lt;% for category in @categories %&gt;\n    category.push(new Array('&lt;%= category.title %&gt;', &lt;%= category.id %&gt;));\n&lt;% end -%&gt;\n\nfunction categorySelected() {\n    category_id = $('ad_category_id').getValue();\n    children = $('ad_category_id').children;\n    children.lenght = 1;\n    categories.each(function(category) {\n    if (category.children[0] == category.id) {\n    children[children.lenght] = new Child(category[1], category[2]);\n}});\nif (children.lenght == 1) {\n    $('category_field').hide();\n    }else {\n    $('category_field').show();\n    }\n}\ndocument.observe('dom:loaded', function() {\n    $('category_field').hide();\n    $('ad_category_id').observe('change', categorySelected);\n});\n</code></pre>\n\n<p>And what should I put in the ad _form.html.erb after this</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= f.label(:category_id, \"Select Category\") %&gt;&lt;br &gt;\n  &lt;%= f.select(:category_id, @categories.collect {|s| [s.title, s.id]}, :prompt =&gt; \"Select something\") %&gt;\n&lt;/div&gt;\n&lt;% javascript 'dynamic_category' %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","subdomain","multi-tenant"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13214593,"title":"Rails acts_as_tenant - would like to prevent access to my site without a subdomain","body":"<p>The acts_as_tenant gem works really well. No problems saving and retrieving data for multiple tenants. However, I ran into a challenge when I access my dev site without the subdomain.</p>\n\n<p>THE PROBLEM: IF I don't specify a subdomain, users from any tenant can still login. </p>\n\n<p>Example - a user for cheese.lvh.me:3000 would not be able to log into and access data from  bacon.lvh.me:3000 (and vice versa). BUT both cheese and bacon users can log into lvh.me:3000. Once logged in, the tenant scope does not apply anymore so all new inserts get a NULL account_id.</p>\n\n<p>I'D LIKE TO: Prevent user login if subdomain is NOT specified. </p>\n\n<p>I'm using M.Hartl's user login method from the popular railstutorial.org.</p>\n\n<pre><code>def create\n  user = User.find_by_email(params[:session][:email].downcase)\n  if user &amp;&amp; user.authenticate(params[:session][:password]) \n    sign_in user\n    flash[:success] = \"Welcome user!\"\n    redirect_to users_path\n  else\n    flash.now[:error] = 'Invalid email/password combination'\n    render 'new'\n  end\nend\n</code></pre>\n\n<p>Would appreciate any advice.</p>\n"},{"tags":["ruby-on-rails","datatables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13217605,"title":"Ajax Datatables from Rails","body":"<p>Hi I have just followed Ryan Bates guide to loading data from the server as the client interacts with the datatable. </p>\n\n<p><a href=\"http://railscasts.com/episodes/340-datatables?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/340-datatables?view=asciicast</a></p>\n\n<p>In his ProductsDatatable class he defines a sorting function:</p>\n\n<pre><code>  def sort_column\n    columns = %w[name category released_on price]\n    columns[params[:iSortCol_0].to_i]\n  end\n</code></pre>\n\n<p>Basically the column name is used to query the database, so \"name\", \"category\", etc are all attributes to the product model.  So an SQL SELECT statement is generated with Name or Category being used for sorting ASC or DESC.. and so on...</p>\n\n<p>If I have data being displayed in a column that does not map explicitly to a attribute.. such as product.reviews.count, how would I then allow sorting of that column?</p>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13210825,"title":"error with multiple contact forms on page in ruby on rails","body":"<p>I have this <a href=\"http://salty-temple-9504.herokuapp.com/pages/contact\" rel=\"nofollow\">portfolio site</a> and the first tab's contact form is not working while the 2nd tab's form does work. I suspect it maybe an issue of routing possibly. Here is what I have in my routing file:</p>\n\n<pre><code>Inspired::Application.routes.draw do\n  get \"pages/home\"\n  get \"pages/about_us\"\n  get \"pages/web_design\"\n  get \"pages/portfolio\"\n  get \"pages/contact\"\n  get \"pages/new\"\n\n  match 'contact'    =&gt; 'pages#new',       :as =&gt; 'contact',    :via =&gt; :get\n  match 'contact'    =&gt; 'pages#create',    :as =&gt; 'contact',    :via =&gt; :post\n  match 'contactrfp' =&gt; 'pages#createrfp', :as =&gt; 'contactrfp', :via =&gt; :post\n\n  root :to =&gt; 'pages#home'\n</code></pre>\n\n<p>Here is what the controller looks like:</p>\n\n<pre><code>def contact\n  @message    = Message.new\n  @messagerfp = Messagerfp.new\nend\n\ndef create\n  @message = Message.new(params[:message])\n  if @message.valid?\n    NotificationsMailer.new_message(@message).deliver\n    redirect_to(root_path, :notice =&gt; \"Message was successfully sent.\")\n  else\n    #flash.now.alert = \"Please fill all fields.\"\n    #render :new\n  end\nend\n\ndef createrfp\n  @messagerfp = Messagerfp.new(params[:messagerfp])\n  if @messagerfp.valid?\n    NotificationsMailer.new_messagerfp(@messagerfp).deliver\n    redirect_to(root_path, :notice =&gt; \"Message was successfully sent.\")\n  else\n    #flash.now.alert = \"Please fill all fields.\"\n    #render :new\n  end\nend\n</code></pre>\n\n<p>Lemme know if you need any more info. I'm doing all validation on the client side including the actual submission using jQuery Thanks in advance!</p>\n\n<p>here is the view:</p>\n\n<pre><code>                    &lt;script type=\"text/javascript\"&gt;\n                  $(document).ready(function() {\n                  $('#navhorisontell ul li a:eq(4)').addClass('selected');\n\n                  /* START TAB STUFF */\n\n                    $(\".tab_content\").hide(); //Hide all content\n                    $(\"ul.tabs li:first\").addClass(\"active\").show(); //Activate first tab\n                    $(\".tab_content:first\").show(); //Show first tab content\n\n                    //On Click Event\n                    $(\"ul.tabs li\").click(function() {\n\n                        $(\"ul.tabs li\").removeClass(\"active\"); //Remove any \"active\" class\n                        $(this).addClass(\"active\"); //Add \"active\" class to selected tab\n                        $(\".tab_content\").hide(); //Hide all tab content\n\n                        var activeTab = $(this).find(\"a\").attr(\"href\"); //Find the href attribute value to identify the active tab + content\n                        $(activeTab).fadeIn(); //Fade in the active ID content\n                        return false;\n                    });\n\n                    /*END TAB STUFF */\n\n\n\n                    var name = $(\"#contactname\").val();\n                var email = $(\"#email\").val();\n                var message = $(\"#subject\").val();\n                var age = $(\"#message\").val();\n                   var datastr = 'name=' + name + 'email=' + email + '&amp;subject=' + message;\n\n                    allclear = null;\n\n\n\n                  $('#submit24').click(function(){\n\n                  allclear = true;\n                  $('.errors').html('');\n                  if($('#name').val() == ''){\n                    $('.errors').append('&lt;p style=\"color:#cc0000; font-weight:bold;\"&gt;&lt;span class=\"sup\"&gt;*&lt;/span&gt;Please fill in your name.&lt;/p&gt;');\n                    allclear = false;\n                  }\n\n                    if($('#email').val() == ''){\n                    $('.errors').append('&lt;p style=\"color:#cc0000; font-weight:bold;\"&gt;&lt;span class=\"sup\"&gt;*&lt;/span&gt;Please fill in your email address.&lt;/p&gt;');\n                    allclear = false;\n                  }\n\n                    if($('#location').val() == ''){\n                    $('.errors').append('&lt;p style=\"color:#cc0000; font-weight:bold;\"&gt;&lt;span class=\"sup\"&gt;*&lt;/span&gt;Please fill in your location.&lt;/p&gt;');\n                    allclear = false;\n                  }\n\n\n                    if($('#howfound').val() == ''){\n                    $('.errors').append('&lt;p style=\"color:#cc0000; font-weight:bold;\"&gt;&lt;span class=\"sup\"&gt;*&lt;/span&gt;Please fill in how you found us.&lt;/p&gt;');\n                    allclear = false;\n                  }\n\n\n\n\n                    if(allclear == false){\n                        window.location.href = '#col1';\n                    }\n\n\n\n                  if(allclear == true){\n\n\n\n\n                  $('.clear').html('&lt;br /&gt;&lt;img src=\"/assets/ajax-loader.gif\"/&gt;');\n                  $('.rfp').submit();\n\n\n\n\n                  function allcomplete(){\n                scroll(0,0);\n                $('.errors').html('');\n                $(\"#tab1\").html(\"&lt;p&gt;Thanks for your inquiry. We'll contact you in 24-48 hours regarding your request! &lt;/p&gt;\");\n                }\n                setTimeout(allcomplete,1000);\n                     //alert('hi');\n\n\n                }\n\n                /*\n                function sendemail(){\n                $.ajax({\n                type: \"POST\",\n                url: \"/assets/mail.php\",\n                //data: ({email : $(\"#email\").val(), message: 'Name: ' + $(\"#name\").val() + '\\r' + 'email: ' + $('#email').val() + '\\r' + 'phone: ' + $('#phone').val() + '\\r' + 'Location: ' + $('#location').val() + '\\r' + 'Business Name: ' + $('#bizname').val() + '\\r' + 'Business Description: ' + $('#bizdesc').val() + '\\r' + 'phone: ' + $('#phone').val()}),\n                data: ({email : $(\"#email\").val(), message: 'Name: ' + $(\"#name\").val() + '\\r' + 'email: ' + $('#email').val() + '\\r' + 'phone: ' + $('#phone').val() + '\\r' + 'Location: ' + $('#location').val() + '\\r' + 'Business Name: ' + $('#bizname').val() + '\\r' + 'Business Description: ' + $('#bizdesc').val() + '\\r' + 'Have website: ' + $('#website').val() + '\\r' + 'Services interested in: ' + $('#services').val() + '\\r' + 'Additional details: ' + $('#adddetails').val() + '\\r' + 'Budget: ' + $('#budget').val() + '\\r' + 'How did you find us: ' + $('#howfound').val()}),\n                cache: false,\n                 error: function () {\n\n                             //alert('did not go thru');\n                                $('.errors').append('&lt;p style=\"color:#cc0000; font-weight:bold;\"&gt;&lt;span class=\"sup\"&gt;&lt;/span&gt;Oops, there seems to be a problem sending in your request. Please try again later or contact us at 312.612.0696&lt;/p&gt;');\n                            },\n                success: function(html){\n                //$(\"#response\").fadeIn(\"slow\");\n                scroll(0,0);\n                $('.errors').html('');\n                $(\"#tab1\").html(\"&lt;p&gt;Thanks for your inquiry. We'll contact you in 24-48 hours regarding your request! &lt;/p&gt;\");\n                //setTimeout('$(\"#response\").fadeOut(\"slow\")',2000);\n                //alert('mail sent');\n                }\n                });\n                }\n                */\n                    });\n\n\n\n\n\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n                    //FORM 2\n\n\n\n                      $('#submit2').click(function(){\n\n                  allclear2 = true;\n                  $('.errors2').html('');\n\n                  if($('#name2').val() == ''){\n                    $('.errors2').append('&lt;p style=\"color:#cc0000; font-weight:bold;\"&gt;&lt;span class=\"sup\"&gt;*&lt;/span&gt;Please fill in your name.&lt;/p&gt;');\n                    allclear2 = false;\n                  }\n\n                    if($('#email2').val() == ''){\n                    $('.errors2').append('&lt;p style=\"color:#cc0000; font-weight:bold;\"&gt;&lt;span class=\"sup\"&gt;*&lt;/span&gt;Please fill in your email address.&lt;/p&gt;');\n                    allclear2 = false;\n                  }\n\n\n\n                    if($('#bizdesc2').val() == ''){\n                    $('.errors2').append('&lt;p style=\"color:#cc0000; font-weight:bold;\"&gt;&lt;span class=\"sup\"&gt;*&lt;/span&gt;Please fill in a message.&lt;/p&gt;');\n                    allclear2 = false;\n                  }\n\n\n\n\n                    if(allclear2 == false){\n                        window.location.href = '#col2';\n                    }\n\n\n\n                  if(allclear2 == true){\n                  //alert('hi');\n                  $('.clear2').html('&lt;br /&gt;&lt;img src=\"/assets/ajax-loader.gif\"/&gt;');\n                  $('.rfp2').submit();\n\n\n\n\n                  function allcomplete2(){\n                  scroll(0,0);\n                $('.errors2').html('');\n                $(\"#tab2\").html(\"&lt;p&gt;Successfully sent. Thanks for your inquiry! &lt;/p&gt;\");\n                }\n                setTimeout(allcomplete2,1000);\n\n                }\n\n\n\n\n\n\n\n\n                    });\n\n\n\n                  });\n                &lt;/script&gt;\n\n                &lt;!--START CONTENT --&gt;\n\n\n\n\n\n\n                &lt;div id=\"col1\"&gt;\n\n\n\n                &lt;!-- CONTACT FORM --&gt;\n\n                &lt;p&gt; &lt;span class=\"opening\"&gt;Get in Touch!&lt;/span&gt;&lt;/p&gt;\n\n\n\n                &lt;ul class=\"tabs\"&gt;\n                    &lt;li&gt;&lt;a href=\"#tab1\"&gt;Request for Proposal&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a href=\"#tab2\"&gt;Other Inquiries&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a href=\"#tab3\"&gt;Refer a Friend&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a href=\"#tab4\"&gt;Contact Info&lt;/a&gt;&lt;/li&gt;\n                &lt;/ul&gt;\n\n                &lt;div class=\"tab_container\"&gt;\n                    &lt;div id=\"tab1\" class=\"tab_content\"&gt;\n\n\n\n\n\n\n                        &lt;div class=\"form\"&gt;\n\n\n\n                            &lt;%= form_for @messagerfp, :html =&gt; { :class =&gt; \"rfp\"}, :remote =&gt; true, :url =&gt; contactrfp_path do |form| %&gt;\n\n                      &lt;p&gt;Your Name&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                      &lt;%= form.text_field :name, :id =&gt; \"name\" %&gt;\n\n\n\n                      &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Your Email&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                      &lt;%= form.text_field :email, :id =&gt; \"email\" %&gt;\n\n\n\n\n                &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Your Location&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;%= form.text_field :location, :id =&gt; \"location\" %&gt;\n\n\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;How did you find us?&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;%= form.text_field :howfound, :id =&gt; \"howfound\" %&gt;\n\n\n                &lt;div class=\"clear\" style=\"margin-bottom:20px; cursor:pointer;\"&gt;&lt;br /&gt;\n                    &lt;!--&lt;span class=\"button\" id=\"submit2\"&gt;&lt;span&gt;Submit&lt;/span&gt;&lt;/span&gt;--&gt;\n                         &lt;%= form.submit \"Send\", :class =&gt; \"button\", :id =&gt; \"submit24\" %&gt;\n\n\n                    &lt;/div&gt;\n                &lt;% end %&gt;\n\n\n\n\n\n\n                    &lt;!--&lt;form class=\"rfp\"&gt;\n                    &lt;p&gt;Your Name&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;input type=\"name\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"name\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Your Email&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;input type=\"mail\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"email\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Phone and/or Skype ID (optional)&lt;/p&gt;\n                    &lt;input type=\"subject\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"phone\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Your Location&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;input type=\"text\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"location\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;&lt;span class=\"bold larger\"&gt;Your Business&lt;/span&gt;&lt;/p&gt;\n                    &lt;br /&gt;\n                    &lt;p&gt;Business name and industry&lt;/p&gt;\n                    &lt;input type=\"text\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"bizname\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Brief description of your business or organization&lt;/p&gt;\n                    &lt;textarea type=\"text\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"bizdesc\" name=\"input_1\" rows=\"10\" cols=\"29\"&gt;&lt;/textarea&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n\n                        &lt;p&gt;Do you currently have a website?&lt;/p&gt;\n                    &lt;input type=\"text\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"website\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;&lt;span class=\"bold larger\"&gt;Your Project&lt;/span&gt;&lt;/p&gt;\n                    &lt;br /&gt;\n                    &lt;p&gt;Briefly list the services that you're interested in?&lt;/p&gt;\n                    &lt;textarea type=\"text\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"services\" name=\"input_1\" rows=\"10\" &gt;&lt;/textarea&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Additional details about your project&lt;/p&gt;\n                    &lt;textarea type=\"text\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"adddetails\" name=\"input_1\" rows=\"10\" &gt;&lt;/textarea&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n\n\n                    &lt;p&gt;Project Budget (USD)&lt;/p&gt;\n\n                    &lt;select tabindex=\"11\" class=\"medium gfield_select\" id=\"budget\" name=\"input_17\"&gt;&lt;option selected=\"selected\" value=\"$1,000 - $5,000\"&gt;$1,000 - $5,000&lt;/option&gt;&lt;option value=\"$5,000 - $10,000\"&gt;$5,000 - $10,000&lt;/option&gt;&lt;option value=\"$10,000 - $15,000\"&gt;$10,000 - $15,000&lt;/option&gt;&lt;option value=\"&amp;gt; $15,000\"&gt;&amp;gt; $15,000&lt;/option&gt;&lt;/select&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;&lt;span class=\"bold larger\"&gt;Get in Touch&lt;/span&gt;&lt;/p&gt;\n                    &lt;br /&gt;\n                    &lt;p&gt;How did you find us?&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;input type=\"text\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"howfound\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;div class=\"clear\" style=\"margin-bottom:20px; width:100px; float:right; cursor:pointer;\"&gt;\n                    &lt;span class=\"button\" id=\"submit\"&gt;&lt;span&gt;Submit&lt;/span&gt;&lt;/span&gt;\n                    &lt;/div&gt;\n                    &lt;/form&gt;--&gt;\n                    &lt;/div&gt;\n                    &lt;br /&gt;\n\n                    &lt;div class=\"errors\"&gt;\n\n                    &lt;/div&gt;\n\n\n\n\n                    &lt;/div&gt;\n                    &lt;div id=\"tab2\" class=\"tab_content\"&gt;\n\n\n\n                      &lt;div class=\"form\"&gt;\n                    &lt;!--&lt;form class=\"rfp2\"&gt;\n                    &lt;p&gt;Your Name&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;input type=\"name\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"name2\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Your Email&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;input type=\"mail\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"email2\" name=\"input_1\"&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Message&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;textarea type=\"text\" tabindex=\"1\" class=\"medium\" value=\"\" id=\"bizdesc2\" name=\"input_1\" rows=\"10\" cols=\"29\"&gt;&lt;/textarea&gt;\n                    &lt;br /&gt;&lt;br /&gt;\n\n\n\n                    &lt;div class=\"clear2\" style=\"margin-bottom:20px; width:100px; float:right; cursor:pointer;\"&gt;\n                    &lt;span class=\"button\" id=\"submit2\"&gt;&lt;span&gt;Submit&lt;/span&gt;&lt;/span&gt;\n                    &lt;/div&gt;\n                    &lt;/form&gt;--&gt;\n\n                    &lt;%= form_for @message, :html =&gt; { :class =&gt; \"rfp2\"}, :remote =&gt; true, :url =&gt; contact_path do |form| %&gt;\n\n                      &lt;p&gt;Your Name&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                      &lt;%= form.text_field :name, :id =&gt; \"name2\" %&gt;\n\n\n\n                      &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Your Email&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                      &lt;%= form.text_field :email, :id =&gt; \"email2\" %&gt;\n\n\n\n\n                &lt;br /&gt;&lt;br /&gt;\n                    &lt;p&gt;Message&lt;span class=\"sup\"&gt;*&lt;/span&gt;&lt;/p&gt;\n                    &lt;%= form.text_area :body, :style =&gt; \"resize:none;\", :id =&gt; \"bizdesc2\" %&gt;\n\n\n                &lt;div class=\"clear2\" style=\"margin-bottom:20px; cursor:pointer;\"&gt;&lt;br /&gt;\n                    &lt;!--&lt;span class=\"button\" id=\"submit2\"&gt;&lt;span&gt;Submit&lt;/span&gt;&lt;/span&gt;--&gt;\n                         &lt;%= form.submit \"Send\", :class =&gt; \"button\", :id =&gt; \"submit2\" %&gt;\n\n\n                    &lt;/div&gt;\n                &lt;% end %&gt;\n\n\n\n\n\n\n                        &lt;br /&gt;\n\n                    &lt;div class=\"errors2\"&gt;\n\n                    &lt;/div&gt;\n\n\n\n\n\n\n\n\n                    &lt;/div&gt;\n                    &lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","nginx","production-environment","thin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13217630,"title":"nginx 502 Bad Gateway & 1 minute+ load times after change rails environment to production","body":"<p>When the environment was development, everything was working fine.  However, now I'm experiencing load times of about 1 minute, and 502 Bad Gateways about 90% of the time (the other 10% it works OK).  Here is my thin app.yaml</p>\n\n<pre><code>---\nchdir: /var/www/app\nservers: 10\nenvironment: production\nonebyone: true\nwait: 30\nthreaded: true\nno-epoll: true\naddress: 0.0.0.0\nport: 3000\ntimeout: 30\nlog: log/thin.log\npid: tmp/pids/thin.pid\nmax_conns: 1024\nmax_persistent_conns: 512\nrequire: []\nwait: 30\ndaemonize: true\n</code></pre>\n\n<p>I'm not quite sure where the problem is.  Neither the nginx logs nor the thin.log or production.log files offered much.  I did get an error  <code>upstream prematurely closed connection while reading response header from upstream, client:</code> from nginx, but I'm not quite sure that's related the problem I'm seeing.</p>\n\n<p>If anyone has any idea what might be causing it, or where I may want to look for answers, I would greatly appreciate it.  Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13217336,"title":"Keeping object across controllers","body":"<p>I am playing with the heroku api in Rails and have come across a potential issue.</p>\n\n<p>After submitting a login form i am instantiating the heroku object.</p>\n\n<pre><code>heroku = Heroku::API.new(:username =&gt; USERNAME, :password =&gt; PASSWORD)\n</code></pre>\n\n<p>I would then like to use the heroku object in all controllers to further querying the api. I have tried @heroku, @@heroku and $heroku, but none work. Is this possible?</p>\n\n<p>The only solution i have found it to use the api to fetch the users api key, store this in a session then use it to re-instantiate the heroku object within each controller method. Is this the best / only solution?</p>\n"},{"tags":["ruby-on-rails","static-content"],"answer_count":6,"favorite_count":18,"up_vote_count":33,"down_vote_count":0,"view_count":22282,"score":33,"question_id":1146624,"title":"How to do static content in Rails?","body":"<p>Looking at different options:</p>\n\n<p>One is to just put the static pages in the public/ folder, but I do want the header from layout/application to be consistent.</p>\n\n<p>I tried this, but I got an error:</p>\n\n<pre><code>in routes.rb:\nmap.connect '*path', :controller =&gt; 'content', :action =&gt; 'show'\n\nin content_controller.rb:\ndef show\n  render :action =&gt; params[:path].join('/')\nend\n</code></pre>\n\n<p>All I want is an easy way to put together things like my faq, contact, tos, privacy, and other non-application type pages somewhere easy by just creating an .rhtml.  who has done this?</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13216538,"title":"Find records created this month in Rails 3?","body":"<p>I am finding hard time figuring out a issue while trying to find records created this month.</p>\n\n<p><strong>my query in controller looks like this</strong></p>\n\n<pre><code>@sh = SupportHistory.where('created_at BETWEEN ? AND ?', Time.now.beginning_of_month, DateTime.now.end_of_month)\n</code></pre>\n\n<p><strong>my sql looks like this</strong></p>\n\n<pre><code>SELECT `support_histories`.* FROM `support_histories`  WHERE (created_at BETWEEN '2012-10-31 18:30:00' AND '2012-11-30 18:29:59')\n</code></pre>\n\n<p>The problem is its finding a record from previous month, how to fix it ?</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>I was able to figure-out the problem through this link:\n<a href=\"http://stackoverflow.com/questions/4362663/timezone-with-rails-3\">Timezone with rails 3</a></p>\n\n<p><strong>Now my query in controller looks like this</strong></p>\n\n<pre><code>@sh = SupportHistory.where('created_at BETWEEN ? AND ?', DateTime.now.in_time_zone.beginning_of_month, DateTime.now.in_time_zone.end_of_month)\n</code></pre>\n\n<p><strong>Now my sql looks like this</strong></p>\n\n<pre><code>SELECT `support_histories`.* FROM `support_histories`  WHERE (created_at BETWEEN '2012-11-01 05:\n00:00' AND '2012-12-01 05:59:59')\n</code></pre>\n\n<p>Now i have another Question, is there a way to avoid 'in_time_zone' ? or to make it happen automatically ? :) </p>\n"},{"tags":["ruby-on-rails","activerecord","activeadmin"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13143896,"title":"ActiveAdmin to filter float fields on ActiveRecord models","body":"<p>I found <a href=\"http://activeadmin.info\" rel=\"nofollow\">ActiveAdmin</a> very useful for creating rather full-brown scaffold for our ActiveRecord models. However, our models have float (and some decimal) columns and ActiveAdmin fails to create filters for them.</p>\n\n<p>For example,</p>\n\n<pre><code>ActiveAdmin.register ForexRate do\n  filter :rate, :as =&gt; :numeric\nend\n</code></pre>\n\n<p>gives me NoMethodError, saying</p>\n\n<pre><code>undefined method `rate_gt' for #&lt;MetaSearch::Searches::ForexRate:0x007fa4427bb018&gt;\n</code></pre>\n\n<p>What am I doing wrong here? Thanks in advance!</p>\n\n<p>P.S. I have confirmed the same filter worked for integer columns.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13217058,"title":"what is the difference between gsub using / or \"?","body":"<p>I am trying to use gsub to replace <code>\"?\"</code> and <code>\".\"</code> with empty space.</p>\n\n<p>I realize that is a difference between <code>gsub(\".\", \"\")</code> and <code>gsub(/./, \"\")</code>, but I don't know what it is. Can Someone explain?</p>\n\n<p>Also, <code>gsub(\"?\",\"\")</code> seems to work, and <code>gsub(/?/,\"\")</code> doesn't work. \nHow can we make <code>gsub(/?/,\"\")</code> work?</p>\n"},{"tags":["ruby-on-rails","deployment","passenger","phusion"],"answer_count":7,"favorite_count":58,"up_vote_count":55,"down_vote_count":0,"view_count":11677,"score":55,"question_id":853532,"title":"Slow initial server startup when using Phusion Passenger and Rails","body":"<p>To jump on the band-wagon of Phusion Passenger we've setup a staging server for a small rails app to test things out.</p>\n\n<p>So far it has been very nice to use, it makes installing/configuring and deploying apps a breeze. The problem is the site we're using doesn't get hit very often and it seems to shut down the servers in the background. Meaning when someone goes to the site they have a really long wait until it starts up a new server to handle the request. We've read through the documentation, tried quite a few different set-ups (smart/smart-lv2 modes, passengeridletime etc) and still haven't found a real solution. </p>\n\n<p>After ploughing through Google results we can't really find useful information. Currently we have a cron job that makes a request every-so-often in an attempt to keep the servers running.</p>\n\n<p>Is anyone else experiencing this problem and do you have any advice for a fix?</p>\n"},{"tags":["ruby-on-rails","activerecord","attr-accessor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13207719,"title":"ActiveModel::MassAssignmentSecurity::Error in SchedulesController#create","body":"<p>im trying to declare some virtual attributes that will be used to combine date and time together given me date time, though i keep getting the following error. as you can see from the code examples below, how im setting the attributes, and what information im passing through to them.</p>\n\n<pre><code>ActiveModel::MassAssignmentSecurity::Error in SchedulesController#create\n\n{\"utf8\"=&gt;\"✓\",\n\n\n\"authenticity_token\"=&gt;\"j4V6DAqK5U/+ZGaSKDlrEoOBqXu3pEq/FM51ingi2sg=\",\n \"schedule\"=&gt;{\"event\"=&gt;\"1\",\n \"result_id\"=&gt;\"\",\n \"date\"=&gt;\"04/11/2012\",\n \"arrival_time\"=&gt;\"08:00 PM\",\n \"time\"=&gt;\"08:00 PM\",\n \"duration\"=&gt;\"1800\",\n \"location_id\"=&gt;\"11\",\n \"selected_players\"=&gt;[\"\",\n \"41\",\n \"38\"],\n \"team_id\"=&gt;\"1\",\n \"opponent_id\"=&gt;\"1\",\n \"home_or_away\"=&gt;\"Home\"},\n \"commit\"=&gt;\"Save Event\"}\n</code></pre>\n\n<p>controller</p>\n\n<pre><code>    # POST /schedules\n  # POST /schedules.json\n  def create\n    params[:schedule].delete(:date)\n    params[:schedule].delete(:time)\n    @user = User.find(current_user)\n\n    @players = User.where(:team_id =&gt; current_user[:team_id]).all\n    params[:schedule][:selected_players].compact\n    #params[:schedule][:selected_players].reject!{|selected_players| selected_players==\"\"}\n    #@availabilities = @user.availabilities.create(:unique_id =&gt; params[:schedule][:id])\n\n    @schedule = Schedule.new(params[:schedule])\n\n    respond_to do |format|\n      if @schedule.save\n        #Notifier.event_added(@user,@schedule).deliver\n        format.html { redirect_to(schedules_url,\n                                  :notice =&gt; \"#{event_display_c(@schedule.event)} vs #{@schedule.opponent.name} was successfully created.\") }\n        format.json { render :json =&gt; @schedule, :status =&gt; :created, :location =&gt; @schedule }\n      else\n        format.html { render :action =&gt; \"new\" }\n        format.json { render :json =&gt; @schedule.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>model</p>\n\n<pre><code>class Schedule &lt; ActiveRecord::Base\n  belongs_to :location\n  belongs_to :opponent\n  belongs_to :team\n  belongs_to :result\n  has_many :availabilities, :dependent =&gt; :destroy\n\n  attr_accessible :location_id, :user_id, :opponent_id, :datetime, :score_for, :score_against, :event,\n                  :team_id, :home_or_away, :arrival_time, :duration, :selected_players, :result_id\n\n  attr_accessor :date, :time\n</code></pre>\n"},{"tags":["ruby-on-rails","elasticsearch","tire"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13214830,"title":"What does setting the index to not_analyzed do when index mapping using elasticsearch?","body":"<p>What does <code>:index =&gt; :not_analyzed</code> do if I map it to a field or if I don't add it to a field?  I couldn't find a definition on the main github tire page or in the elasticsearch.org website.</p>\n\n<p>Example of the code:</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\n      include Tire::Model::Search\n      include Tire::Model::Callbacks\n\n      #...\n\n      mapping do\n        indexes :id,           :index    =&gt; :not_analyzed\n        indexes :title,        :analyzer =&gt; 'snowball', :boost =&gt; 100\n      end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13216976,"title":"What does the initialize method in rails do","body":"<p>I'm trying to wrap my head around the purpose of using the initialize method. In Hartl's tutorial, he uses the example..</p>\n\n<pre><code>def initialize(attributes = {})\n   @name = attributes[:name]\n   @email = attributes[:email]\nend\n</code></pre>\n\n<p>Is initialize setting the instance variables <code>@name</code> and <code>@email</code> to the attributes, and if so why do we have the argument <code>attributes = {}</code>?</p>\n"},{"tags":["ruby-on-rails","forms","url","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13217015,"title":"Passing URL Parameter to Drop Down","body":"<p>I have a simple form: </p>\n\n<pre><code> &lt;%= f.input :type, :required =&gt; true, :collection =&gt; [\"Nonprofit\",\"School\",\"Company\"], :hint =&gt; \"Note: nonprofits will need to provide proof of nonprofit status\", :input_html =&gt; { :value =&gt; params['type'] } %&gt;\n &lt;%= f.input :name, :label =&gt; \"Organization\" %&gt;\n &lt;%= f.input :first_name  %&gt;\n &lt;%= f.input :last_name %&gt;\n &lt;%= f.input :email %&gt;\n</code></pre>\n\n<p>A user gets to this page through a url like <a href=\"http://www.website.com/org/signup?type=Company\" rel=\"nofollow\">http://www.website.com/org/signup?type=Company</a></p>\n\n<p>I can use this format to enter a value into a field like name or email, but can't figure out how to pass the param to the drop down.  </p>\n\n<p>I've already tried a few things including changing :value to :selected or :option but nothing seems to work. </p>\n"},{"tags":["ruby-on-rails","routes","activeadmin"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1273,"score":1,"question_id":7390470,"title":"default_actions in activeadmin in rails doesnt make \"delete\" button create destroy link","body":"<p>I have this:</p>\n\n<pre><code>ActiveAdmin.register User do\n  index do\n    column :email\n        column :name\n    column :role\n    column \"Last Sign In\", :last_sign_in_at\n        column :account\n        column \"Units\" do |user|\n            user.units.count.to_s\n        end\n    default_actions\nend\n</code></pre>\n\n<p>The default_actions method should create the show, edit, and delete links. It shows them but the delete link is just a link to the show action:</p>\n\n<pre><code>admin/users/1\n</code></pre>\n\n<p>Specifications said it should create a delete link.</p>\n\n<p>Dont know why it did that. So I tried an alternative:</p>\n\n<pre><code> column \"Delete\" do |user|\n   link_to \"Delete\", destroy_admin_user_path(user)\n end\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>undefined method `destroy_admin_user_path' for &lt;div class=\"index_as_table\"&gt;&lt;/div&gt;:ActiveAdmin::Views::IndexAsTable\n</code></pre>\n\n<p>I even tried adding this in routes:</p>\n\n<pre><code>match \"/admin/users/:id/destroy(.:format) \" =&gt; \"admin/users#destroy\"\n</code></pre>\n\n<p>Still got same error.</p>\n\n<p>I included this in application.html.haml:</p>\n\n<pre><code>        = javascript_include_tag :all\n</code></pre>\n\n<p>Still same problems as above.</p>\n\n<p>Thanks for response</p>\n"},{"tags":["ruby-on-rails","mongodb","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13214305,"title":"MongoDB / Mongoid embedded document loading with ror","body":"<p>I have a document (DataSet) with many embedded documents (DataPoint) (1:N relation). Since this appears as an array to me in rails, if I want to read every 20th element for example, will it load every element into memory, or only every 20th element?</p>\n\n<p>I am trying to figure out if this will be inefficient. I would like ideally only to load what I need from the DB.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>a = DataSet.first\npoints = a.data_points.values_at(*(0..a.data_points.count).step(20))\n</code></pre>\n\n<p>Is this bad? Is there a mongoid specific way to do this?</p>\n"},{"tags":["ruby-on-rails","heroku","ms-word"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13212684,"title":"Parse word docs heroku/s3","body":"<p>I want to implement a functionality that needs to parse word docs, which will uploaded by user and stored on amazon S3. The application will be on heroku. I tried catdoc but it doesn't parse urls. Can anyone suggest tool that can be used on heroku to parse word documents? </p>\n\n<p>UPDATE\nI want to scan an uploaded ms-word(.doc) has particular words and tag them accordingly.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13215219,"title":"ActiveRecord: many-to-many and one-to-many between same two models","body":"<p>Looking at guides.rubyonrails.com, I see the syntax for a self join:</p>\n\n<pre><code>class Employee &lt; ActiveRecord::Base\n  has_many :subordinates, :class_name =&gt; \"Employee\",\n    :foreign_key =&gt; \"manager_id\"\n  belongs_to :manager, :class_name =&gt; \"Employee\"\nend\n</code></pre>\n\n<p>What I want to do is something more like this:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  has_many :workers, :class_name =&gt; \"Employee\",\n    :foreign_key =&gt; \"manager_id\"\n  belongs_to :manager, :class_name =&gt; \"Employee\"\nend\n</code></pre>\n\n<p>Or perhaps I can define the relationship polymorphically:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  belongs_to :manager, :polymorphic =&gt; true\n  has_many :employees\nend\n\nclass Employee &lt; ActiveRecord::Base\n  has_many :projects, :as =&gt; :manager\nend\n</code></pre>\n\n<p>So I guess the relationship I'm looking for is sort of like a HABTM but with a concrete distinction between having and belonging to.  Any ideas?</p>\n"},{"tags":["html","css","ruby-on-rails","twitter-bootstrap","navbar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13215831,"title":"navbar is not resizing when you adjust browser size","body":"<p>I am doing ruby rails devloping , using navbar from twitter bootstrap</p>\n\n<p>but my navbar is nto resizing on firefox if i am trying to reduce the windows size..</p>\n\n<p>anyone know how to fix it??</p>\n\n<p>Mycode:</p>\n\n<pre><code>%body\n  %header.navbar.navbar-fixed-top\n    %nav.navbar-inner\n      .container\n        = render 'mynavbar'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13216378,"title":"How does ActiveRecord link records together?","body":"<p>So this has been surprisingly difficult to locate a quick answer to. I'm using ActiveRecord in a pure console app, and I have my classes set up like so:</p>\n\n<pre><code>class Owner &lt; ActiveRecord::Base\nhas_many :profiles\nend\n\nclass Profile &lt; ActiveRecord::Base\nhas_many :lines\nbelongs_to :owner\nend\n\nclass Line &lt; ActiveRecord::Base\nbelongs_to :profiles\nend\n</code></pre>\n\n<p>Now normally i'd do something like..</p>\n\n<pre><code>Profile.create( :thing =&gt; \"thing\", :otherthing =&gt; \"otherthing\" )\n</code></pre>\n\n<p>How does AR know to link this instance of profile to an owner? What about a specific owner already in the database? How do I tell it? How would I do all of the links at once? (line, to profile, to owner)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13206313,"title":"Clean folder every hour","body":"<p>I want the Rails server to empty the folder <code>public/photos</code> every hour, so that the folder does not get too full. How can I do that (if it's even a possibility)?</p>\n"},{"tags":["ruby-on-rails","ruby","sorting","hash"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":13216092,"title":"How to sort a hash by value in descending order and output a hash in ruby?","body":"<pre><code>output.sort_by {|k, v| v}.reverse\n</code></pre>\n\n<p>and for keys</p>\n\n<pre><code>h = {\"a\"=&gt;1, \"c\"=&gt;3, \"b\"=&gt;2, \"d\"=&gt;4}\n=&gt; {\"a\"=&gt;1, \"c\"=&gt;3, \"b\"=&gt;2, \"d\"=&gt;4}\n\nHash[h.sort]\n</code></pre>\n\n<p>Right now I have these two. But I'm trying to sort hash in descending order by value so that it will return</p>\n\n<pre><code>=&gt; {\"d\"=&gt;4, \"c\"=&gt;3, \"b\"=&gt;2, \"a\"=&gt;1 }\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>Edit:\nlet me post the whole code.</p>\n\n<pre><code>def count_words(str)\n  output = Hash.new(0)\n  sentence = str.gsub(/,/, \"\").gsub(/'/,\"\").gsub(/-/, \"\").downcase\n  words = sentence.split()\n  words.each do |item|\n    output[item] += 1 \n  end\n  puts Hash[output.sort_by{ |_, v| -v }]\n  return Hash[output.sort_by{|k, v| v}.reverse]\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3","random"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":90,"score":4,"question_id":13204634,"title":"Freeze a random number in Ruby","body":"<p>I'm trying to build something that will randomly pick two objects from a list in Ruby (using Rails) and then perform basic operations on those objects. My current set up involves randomly picking numbers at the start - using these numbers to get objects from the database and then rendering those objects to index. However, now I'm trying to edit these objects using AJAX I'm running into a problem.</p>\n\n<p>It seems that, when I click on a link that the random number in being recalculated and is causing my AJAX function not to work.</p>\n\n<p>I've included (what I believe is) all relevant code below but let me know if you need to see anything else to get to the bottom of this. I'm looking to get the titles of the old animals and (ideally their previous ratings and) their new ratings to appear at the bottom of the page.</p>\n\n<p>Thanks,</p>\n\n<p>Matt</p>\n\n<p><code>controllers/static_pages.rb</code></p>\n\n<pre><code>class StaticPagesController &lt; ApplicationController\nrespond_to :html, :js\nbefore_filter :pickanimals\n\ndef pickanimals\n    @allAnimals = Animal.all\n    @random_no = rand(@allAnimals.length)\n    @animal = @allAnimals[@random_no]\n    @allAnimals.delete_at(@random_no)\n    @newRandom = rand(@allAnimals.length)\n    @animal2 = @allAnimals[@newRandom]\nend\n\n  def index\n    respond_to do |format|\n        format.html\n        format.js\n    end\nend\n\n  def help\n  end\n\n  def about\n  end\n\n  def contact\n  end\n\ndef league\nend\n\ndef voting\n    @votedAnimal = Animal.find(params[:id])\n    if @votedAnimal == @animal\n        @animal.rating += 1\n        @animal2.rating -= 1\n    else\n        @animal.rating -= 1\n        @animal2.rating += 1    \n    end\n    Animal.transaction do\n        @animal.save!\n        @animal2.save!\n    end\n    respond_to do |format|\n        format.html { redirect_to root_path }\n        format.js  \n    end\nend\nend\n</code></pre>\n\n<p><code>app/views/static_pages/index.html.erb</code></p>\n\n<pre><code>&lt;div class=\"center hero-unit\"&gt;\n&lt;h1&gt;Animal Attack&lt;/h1&gt;\n&lt;p&gt; Who will win when nature collides? &lt;/p&gt;\n&lt;div class=\"animalcontainerright\"&gt;\n&lt;h2&gt; &lt;%= @animal.name %&gt; &lt;/h2&gt; \n&lt;%= link_to image_tag(@animal.attachment.url(:large)), voting_path(@animal.id), :remote =&gt; true, :confirm =&gt; \"Rating:  \"+@animal.rating.to_s  %&gt;\n&lt;/div&gt;\n&lt;div class=\"animalcontainerleft\"&gt;\n&lt;h2&gt; &lt;%= @animal2.name %&gt; &lt;/h2&gt;\n&lt;%= link_to image_tag(@animal2.attachment.url(:large)), voting_path(@animal2.id), :remote =&gt; true, :confirm =&gt; \"Rating:  \"+@animal2.rating.to_s  %&gt;\n&lt;/div&gt;\n&lt;div id=\"animalfacts\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p><code>routes.rb</code></p>\n\n<pre><code>AnimalAttack::Application.routes.draw do\n\nresources :animals\n\nroot to: 'static_pages#index'\nmatch '/help' =&gt; 'static_pages#help'\nmatch '/about' =&gt; 'static_pages#about'\nmatch '/contact' =&gt; 'static_pages#contact'\nmatch '/league' =&gt; 'static_pages#league'\nmatch '/voting/:id' =&gt; 'static_pages#voting'\n\nend\n</code></pre>\n\n<p><code>rake routes</code></p>\n\n<pre><code>    animals GET    /animals(.:format)          animals#index\n        POST   /animals(.:format)          animals#create\n new_animal GET    /animals/new(.:format)      animals#new\nedit_animal GET    /animals/:id/edit(.:format) animals#edit\n animal GET    /animals/:id(.:format)      animals#show\n        PUT    /animals/:id(.:format)      animals#update\n        DELETE /animals/:id(.:format)      animals#destroy\n   root        /                           static_pages#index\n   help        /help(.:format)             static_pages#help\n  about        /about(.:format)            static_pages#about\ncontact        /contact(.:format)          static_pages#contact\n league        /league(.:format)           static_pages#league\n               /animals(.:format)          animals#new\n               /voting/:id(.:format)       static_pages#voting\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13215759,"title":"Average of an Active Record of an active record","body":"<p>Ok, So I'm working on a book review site. \nI am wanting to show the average rating of all the books by a certian author. This is what I have currently and it works but there has to be a better way.</p>\n\n<p><code>&lt;% @author.books.each { |book| book.reviews.each { |review| x = x + review}} %&gt;<br>\n&lt;% @author.books.each { |book| book.reviews.each { |review| y = y +1}} %&gt;<br>\n&lt;%= x/y %&gt;</code></p>\n\n<p>I can do \n<code>&lt;% @book.reviews.average(:ratings) %&gt;</code></p>\n\n<p>but there has to be a more elegant option that would work similar to </p>\n\n<blockquote>\n  <p><code>&lt;% @author.books.reviews.average(:ratings) %&gt;</code></p>\n</blockquote>\n\n<p>Sadly the above command does not work even though\n<code>&lt;% @author.books.count %&gt;</code> does.</p>\n\n<p>Using Ruby 1.9.2p290 and rails 3.2.8\nThank you so much for any help you can offer.</p>\n\n<p><em>edited</em>\nAdding my updated class files after first answer.<br>\nauthor.rb</p>\n\n<blockquote>\n  <p><code>class Author &lt; ActiveRecord::Base<br>\n    attr_accessible :a1stname, :asurname<br>\n    has_many :books<br>\n    has_many :reviews :through =&gt; :books<br>\n    def afull_name<br>\n      \"#{asurname}, #{a1stname}\"<br>\n    end<br>\n  end</code></p>\n</blockquote>\n\n<p>book.rb</p>\n\n<blockquote>\n  <p><code>class Book &lt; ActiveRecord::Base<br>\n    attr_accessible :author_id, :description, :title<br>\n    belongs_to :author<br>\n    has_many :reviews<br>\n    validates :author_id, presence: true<br>\n    end</code></p>\n</blockquote>\n\n<p>Now when I call @author or Author.find I get</p>\n\n<pre><code>syntax error, unexpected \":\", expecting keyword_end\n          has_many :reviews :through =&gt; :books \n                             ^  \n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13210870,"title":"Cleanly increment! attribute on model when user clicks on a link_to image_tag","body":"<p>I have an <strong>Advert</strong> model that basically has an image, title and a url. I use CarrierWave for the image. Everything works well, but I am wanting to count <strong>impressions</strong> and <strong>clicks</strong>.</p>\n\n<hr>\n\n<p><strong>So far, I added two integer columns:</strong> impressions, clicks</p>\n\n<p>I have a <strong>pages</strong> controller and have set an <strong>@advert</strong> variable that changes depending on the page. After reading this <a href=\"http://stackoverflow.com/questions/8681355/adding-button-click-counter-in-rails-3\">question</a> I am able to increment impressions:</p>\n\n<pre><code> def index  \n   @advert = Advert.sample  \n   @advert.increment! :impressions  \n end   \n</code></pre>\n\n<hr>\n\n<p><strong>I am having trouble incrementing the clicks</strong> | Below is the code I need to modify so that when a user clicks on the image_tag they are taken to the URL as normal, but that the @advert increments the <strong>clicks</strong> column. Here is my current code (I use HAML and this is code is in a file: _advert.html.haml):</p>\n\n<pre><code>  = link_to image_tag(\"#{advert.foto_url.to_s}\",:alt =&gt; \"an image ad linking to #{advert.url}\", :title =&gt; advert.title), advert.url, :target =&gt; \"blank\"\n</code></pre>\n\n<hr>\n\n<p>What is the easiest, cleanest way to successfully increment! the <strong>clicks</strong> attribute on the Advert when someone clicks on the link above?</p>\n\n<h3>Update:</h3>\n\n<p>I am using the suggestion from Aaron below, but it leads to two new concerns:</p>\n\n<ul>\n<li><p>The user will see a different link when they hold their mouse over the image than the final link they will end up at. I would prefer to have them see the final URL they will end up if they click rather than Redirecting simply to count their click.</p></li>\n<li><p>If someone pulls up the advert url (eg: /adverts/1) directly the counter would increment! without a click.</p></li>\n</ul>\n\n<p>I actually didn't have a show view for Advert, but added it to get this done. <strong>So to be clear</strong> this works, but it feels like it violates best practices. <strong>Thank you though to Aaron.</strong></p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13215337,"title":"spanish locale in rails - model names","body":"<p>I looked around and it seems that to set pluralization rules for model names you put the following in your locale file </p>\n\n<pre><code># es.yml\nes:\n    activerecord:\n        models:\n          business:\n            one: Lugar\n            other: Lugares\n</code></pre>\n\n<p>However, when the model name is translated in plural, I still get <code>Lugars</code> instead of <code>Lugares</code></p>\n\n<p>Not sure what's wrong</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2192,"score":1,"question_id":1996864,"title":"Generate n unique random integers in ruby / rails","body":"<p>Im trying to generate n unique random numbers between 1 and max </p>\n\n<p>I tried the following code but doesn't work (returns repeated numbers)</p>\n\n<pre><code>r = [ ]\nn.times { v = rand(max) while r.include? v ; r &lt;&lt; v}\n</code></pre>\n\n<p>Whats wrong with it? Thanks</p>\n\n<p>added:</p>\n\n<p>max is thousands</p>\n\n<p>n is 10</p>\n"},{"tags":["ruby-on-rails","elasticsearch","tire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":13215295,"title":"Why is the geospatial search using tire for elasticsearch producing a SearchPhaseExecutionException error?","body":"<p>I'm followed various examples (Github karmi/tire issues 417, 169) running the following in the console but its producing an error:</p>\n\n<pre><code>s = Tire.search 'stores-development' do\n#query { all } # added this but still producing error\nfilter 'geo_distance', distance: '100km', location: [40, -70]\nend\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>[REQUEST FAILED] curl -X GET \"http://localhost:9200/stores-development/_search?pretty=true\" -d '{\"filter\":{\"geo_distance\":{\"distance\":\"100km\",\"store\":[40,-70]}}}'\nTire::Search::SearchRequestFailed: 500 : {\"error\":\"SearchPhaseExecutionException[Failed to execute phase [query], total failure; shardFailures {[VZhQ3SdXSOG2Z9FQ64JE6Q][stores-development][0]: SearchParseException[[stores-development][0]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\\\"filter\\\":{\\\"geo_distance\\\":{\\\"distance\\\":\\\"100km\\\",\\\"store\\\":[40,-70]}}}]]]; nested: QueryParsingException[[stores-development] failed to find geo_point field [store]]; }{[VZhQ3SdXSOG2Z9FQ64JE6Q][stores-development][1]: SearchParseException[[stores-development][1]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\\\"filter\\\":{\\\"geo_distance\\\":{\\\"distance\\\":\\\"100km\\\",\\\"store\\\":[40,-70]}}}]]]; nested: QueryParsingException[[stores-development] failed to find geo_point field [store]]; }]\",\"status\":500}\n</code></pre>\n\n<p>store.rb</p>\n\n<pre><code>class Stores\n\n  #...\n\n  mapping do\n    indexes :name, boost: 100\n    indexes :coordinates, type: 'geo_point'\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","tdd"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13212410,"title":"RSpec with Ruby on Rails - Wrong number of arguments (1 for 0) when testing routes","body":"<p>I tried testing routes and just copied the example from the rspec-rails documentation.</p>\n\n<pre><code>describe \"routing to profiles\" do\n  it \"routes /profile/:username to profile#show for username\" do\n    expect(:get =&gt; \"/profiles/jsmith\").to route_to(\n      :controller =&gt; \"profiles\",\n      :action =&gt; \"show\",\n      :username =&gt; \"jsmith\"\n    )\n  end\nend\n</code></pre>\n\n<p>I got the following error when running RSpec:</p>\n\n<pre><code>Failures:\n\n  1) routing to profiles routes /profile/:username to profile#show for username\n     Failure/Error: expect(:get =&gt; \"/profiles/jsmith\").to route_to(\n     ArgumentError:\n       wrong number of arguments (1 for 0)\n     # ./spec/routing/test_spec.rb:11:in `block (2 levels) in &lt;top (required)&gt;'\n\nFinished in 0.001 seconds\n1 example, 1 failure\n</code></pre>\n\n<p>What's going wrong here?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","forms","mustache","scaffolding","form-for"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13215190,"title":"How to use scaffolding and form_for in RoR with Mustache","body":"<p>I'm using mustache templates in my rails app with <a href=\"https://github.com/josh/mustache-rails\" rel=\"nofollow\">mustache-rails</a>\n. I wanted to do scaffolding and use the form_for helper, but I can't get the submit button working. I found this <a href=\"https://gist.github.com/954994\" rel=\"nofollow\">https://gist.github.com/954994</a> , but I don't want to do it so generic. I just wanted to turn a my scaffolding to a template based version.</p>\n\n<p>this is my view class</p>\n\n<pre><code>module Views\n  module Slideshows\n    class New &lt; Layouts::Application\n\n       def form\n         form_for(@slideshow) do |f|\n          {\n              :submit =&gt; f.submit\n          }\n         end\n       end\n\n       def errors?\n           @slideshow.errors.any?\n       end\n\n       def error_header\n           \"#{pluralize(@slideshow.errors.count, \"error\")} prohibited this post from being saved:\"\n       end\n\n       def errors\n         @slideshow.errors.full_messages\n       end\n\n       def back_link\n         link_to 'Back', slideshows_path\n       end  \n\n    end\n  end\nend\n</code></pre>\n\n<p>this is my template class</p>\n\n<pre><code>&lt;h1&gt;New slideshow&lt;/h1&gt;\n\n{{#form}}\n  {{#errors?}}\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;{{error_header}}&lt;/h2&gt;\n    &lt;/div&gt;\n    &lt;ul&gt;\n      {{#errors}}\n        &lt;li&gt;{{.}}&lt;/li&gt;\n      {{/errors}}\n    &lt;/ul&gt;\n  {{/errors?}}\n  &lt;div class=\"actions\"&gt;\n    {{submit}}\n  &lt;/div&gt;\n{{/form}}\n\n{{back_link}}\n</code></pre>\n\n<p>In my opinion the problem is I cant access :submit in the form_for block.</p>\n"},{"tags":["ruby-on-rails","css","ruby-on-rails-3","layout","twitter-bootstrap"],"answer_count":3,"favorite_count":11,"up_vote_count":9,"down_vote_count":0,"view_count":4550,"score":9,"question_id":9118923,"title":"twitter-bootstrap-rails gem workflow","body":"<p>How do I use the twitter-bootstrap-rails gem in my Rails 3.2.1 app? What is the workflow?</p>\n\n<p>After I do:</p>\n\n<pre><code>rails g bootstrap:layout [LAYOUT_NAME] [*ﬁxed or ﬂuid] [options]\n</code></pre>\n\n<p>what do I do next? Do I just copy and paste the generated code into my view? Do I do this for every view? If so, how is doing</p>\n\n<pre><code>rails g bootstrap:themed [RESOURCE_NAME] [LAYOUT] [options]\n</code></pre>\n\n<p>any different?</p>\n\n<p>Do you guys even use the rails generators?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","faker"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":45,"score":0,"question_id":13214637,"title":"Generate unique integer in range using Faker gem","body":"<p>This seems like it should be simple but I can't find an answer anywhere!</p>\n\n<p>I'm building a sample_data rake file in Rails to populate my db using the Faker gem. (though I don't think I need that gem for just generating integers) </p>\n\n<p>Some of the fields need to be an integer within a set range but each must be unique.  For instance: </p>\n\n<pre><code>10.times do |a|\n  a.special_number = rand(1..10)\nend\n</code></pre>\n\n<p>works well except for the fact that the numbers aren't unique...  </p>\n"},{"tags":["ruby-on-rails","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13215000,"title":"Should I remove all authentication code from my User model since a have the Identity model?","body":"<p>I just came across <a href=\"https://github.com/intridea/omniauth-identity\" rel=\"nofollow\">omniauth-identity</a> which enables users to sign in and register without using a Facebook, Twitter, etc.</p>\n\n<p>There is a step were you have to create a <code>Identity</code> model (I'm following this <a href=\"http://railscasts.com/episodes/304-omniauth-identity\" rel=\"nofollow\">Railscast</a>):</p>\n\n<pre><code>class Identity &lt; OmniAuth::Identity::Models::ActiveRecord\n\n  validates :name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence:   true,\n                format:     { with: VALID_EMAIL_REGEX },\n                uniqueness: { case_sensitive: false }\n  validates :password, presence: true, length: { minimum: 6 }\n  validates :password_confirmation, presence: true\nend\n</code></pre>\n\n<p>Now, I already have an <code>User</code> model and a login and registration system (created by following the <a href=\"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book\" rel=\"nofollow\">Ruby on Rails Tutorial</a>):</p>\n\n<p><strong>user.rb:</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :name, :email, :password, :password_confirmation\n\n  has_secure_password\n\n  before_save { |user| user.email = email.downcase }\n  before_save :create_remember_token\n\n  validates :name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence:   true,\n                    format:     { with: VALID_EMAIL_REGEX },\n                    uniqueness: { case_sensitive: false }\n  validates :password, presence: true, length: { minimum: 6 }\n  validates :password_confirmation, presence: true\n\n  private\n\n  def create_remember_token\n   self.remember_token = SecureRandom.urlsafe_base64\n  end\n</code></pre>\n\n<p>So I'm a bit confused. Should remove the lines that have to do with authentication in the <code>User</code> model (e.g. validation, <code>attr_accesible</code>, <code>create_remember_token</code> etc. along with the <code>name</code> and <code>email</code> fields in the users table)?  </p>\n\n<p>And remove <strong>sessions_helper.rb</strong> too?</p>\n\n<pre><code>module SessionsHelper\n  def sign_in(user)\n    cookies.permanent[:remember_token] = user.remember_token\n    self.current_user = user\n  end\n\n  def signed_in?\n    !current_user.nil?\n  end\n\n  def sign_out\n    self.current_user = nil\n    cookies.delete(:remember_token)\n  end\n\n  def current_user=(user)\n    @current_user = user\n  end\n\n  def current_user\n    @current_user ||= User.find_by_remember_token(cookies[:remember_token])\n  end\n\n  def current_user?(user)\n    user == current_user\n  end\n\n  def signed_in_user\n    unless signed_in?\n      store_location\n      redirect_to signin_url, notice: \"Please sign in.\"\n    end\n  end\n\n  def redirect_back_or(default)\n    redirect_to(session[:return_to] || default)\n    session.delete(:return_to)\n  end\n\n  def store_location\n    session[:return_to] = request.url\n  end\nend\n</code></pre>\n\n<p>Because, correct me if I'm wrong, but I I think <code>omniauth-identity</code> handles that too (except for the <code>current_user</code> part.</p>\n"},{"tags":["ruby-on-rails","model","has-many","belongs-to","relationships"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13214851,"title":"Missing 'post_id' column and relationships between users/posts/comments in Rails 3.2","body":"<p>I'm still familiarizing myself with Rails and have a question in regards to a problem I'm trying to solve utilizing Rails 3.2. Here is a link to the few files in question where I assume my problem lies:</p>\n\n<p><a href=\"https://gist.github.com/0fe5cf9093b21f4f632f\" rel=\"nofollow\">https://gist.github.com/0fe5cf9093b21f4f632f</a></p>\n\n<p>I apologize if the code is really bad/adds a few things that don't need to exist as I'm still trying to get used to how everything works as I go along. I want to have comments for each post that is made on my website -- and the logic I have is that users have many comments, and I suppose that the posts have many comments through the users. I do have that relationship added (though it doesn't seem to be doing anything in particular), and I feel as if all of my table references are correct (though I haven't added anything to users as I'm using devise and didn't feel like I needed to add anything as the post is a separate object itself).</p>\n\n<p>As of right now, I can show all of the comments in general, as in I am able to create and save them. I was also saving, at the very least, the user_id variable, so it can understand which account is making the comment. I'm not really sure where/when I should be passing in the post_id, so that's the biggest issue. Any way I've tried to do it in the posts_controller (since in theory I should be able to edit that attribute when the post page is loaded), I get an \"undefined method 'post_id'\" or \"no post_id column\" error, indicating that it doesn't exist, even though as far as I understand, I've defined it. The fact that the user_id is able to be saved, as mentioned before, further confuses me.</p>\n\n<p>If I show the attributes on a comment created in my show view, I get the following:</p>\n\n<blockquote>\n  <p>{\"id\"=>1, \"content\"=>\"text here\", \"posted\"=>Sat, 03 Nov 2012 20:36:53 UTC +00:00, >\"user_id\"=>1, \"created_at\"=>Sat, 03 Nov 2012 20:36:53 UTC +00:00, \"updated_at\"=>Sat, 03 Nov >2012 20:36:53 UTC +00:00}</p>\n</blockquote>\n\n<p>There is no \"post_id\", although I did add it into the migration table for comments. Trying to pass the @post.id in the posts controller (to a show method's instance of a comment, as it would be available beneath a post) gives a mass assignment error. Messing around with the :class and :foreign_key options hasn't done much, either. Based on the research I have done, which includes some of Rails' own documentation, I don't believe I need a has_many through relationship, but I don't know where I'm missing what I need to have the information save accordingly.</p>\n\n<p>Perhaps this is all due in part to my lacking understanding of database/model relationship design, although any help is appreciated. I have seen a couple of similar questions but I still find it difficult to apply their solutions to the context of my own particular issue.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13214948,"title":"Rails is Using HTML View When Requesting Javascript","body":"<p>Weird issue where I'm asking for the JS file, but Rails is serving the HTML file. And it's only on my staging server (Heroku) and not on my local machine. </p>\n\n<p>I have a dynamic Javascript file which is something that needs to be included in other pages via a script to like so:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"http://example.com/embed.js&gt;&lt;/script&gt;\n</code></pre>\n\n<p>That embed maps to a controller and action which also handles HTML. The relevant route looks like this:</p>\n\n<pre><code>match \"/embed(.:format)\" =&gt; \"articles#embed\", as: \"embed\"\n</code></pre>\n\n<p>And the controller action is pretty standard.</p>\n\n<pre><code>def embed\n  respond_to do |format|\n    format.html do\n      #it renders some HTML\n    end\n    format.js #no block is given\n  end\nend\n</code></pre>\n\n<p>And, I have two views under app/views/articles</p>\n\n<ul>\n<li>embed.html.haml</li>\n<li>embed.js.coffee</li>\n</ul>\n\n<p>On my local machine, requesting localhost:3000/embed.js works. It renders the Javascript without a problem. However, on my staging server, here's what I see in the logs:</p>\n\n<pre><code>Started GET \"/embed.js\" for 124.168.219.36 at 2012-11-04 00:23:01 +0000\nProcessing by ArticlesController#embed as JS\n  Rendered articles/embed.html.haml (1.5ms)\nCompleted 500 Internal Server Error in 2ms\n</code></pre>\n\n<p>The Internal Server Error is not the issue. The issue is that it recognises the request as JS, yet decides to render the HTML template and <em>only</em> on staging.</p>\n\n<p>What's going on?</p>\n"},{"tags":["ruby-on-rails","backbone.js","gem","coffeescript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13204368,"title":"rails-backbone gem error for model with two-word names: Uncaught TypeError: Cannot call method 'bind' of undefined","body":"<p>I'm following this example <a href=\"https://github.com/codebrew/backbone-rails#example-usage\" rel=\"nofollow\">https://github.com/codebrew/backbone-rails#example-usage</a> for the backbone-rails gem. It works fine for models that have one word names but I get the <code>Uncaught TypeError: Cannot call method 'bind' of undefined</code> error if I try to follow the same pattern for a model with two names.  Here's what I did:</p>\n\n<pre><code>rails new blog\n</code></pre>\n\n<p>I added the <code>rails-backbone</code> gem into the Gemfile then</p>\n\n<pre><code>bundle install\n\nrails g backbone:install\n\nrails g scaffold FriendRequest sender_gender:string recipient_gender:string\n\nrake db:migrate\n\nrails g backbone:scaffold FriendRequest sender_gender:string recipient_gender:string\n</code></pre>\n\n<p>my <code>app/views/friend_requests/index.html.erb</code> file looks like this:</p>\n\n<pre><code>&lt;h1&gt;Listing friend_requests&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Sender gender&lt;/th&gt;\n    &lt;th&gt;Recipient gender&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n\n&lt;% @friend_requests.each do |friend_request| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= friend_request.sender_gender %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= friend_request.recipient_gender %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', friend_request %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Edit', edit_friend_request_path(friend_request) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Destroy', friend_request, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n&lt;/table&gt;\n\n&lt;br /&gt;\n\n&lt;%= link_to 'New Friend request', new_friend_request_path %&gt;\n\n\n&lt;div id=\"friend_requests\"&gt;&lt;/div&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n  $(function() {\n    // Blog is the app name\n    window.router = new Blog.Routers.FriendRequestRouter({friend_requests: &lt;%= @friend_requests.to_json.html_safe -%&gt;});\n    Backbone.history.start();\n  });\n&lt;/script&gt;\n</code></pre>\n\n<p>When I hit <code>http://localhost:3000/friend_requests</code> I receive this error</p>\n\n<pre><code>Uncaught TypeError: Cannot call method 'bind' of undefined \n</code></pre>\n\n<p>I copied the code from the console which shows the error inside. I'm not sure the correct protocol for StackOverflow with an error like that but you can see it, it is surrounded by *'s.  If someone wants to edit this question to be displayed properly, that would be appreciated.</p>\n\n<pre><code>(function() {\n  var _base,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  (_base = Blog.Views).FriendRequests || (_base.FriendRequests = {});\n\n  Blog.Views.FriendRequests.IndexView = (function(_super) {\n\n    __extends(IndexView, _super);\n\n    function IndexView() {\n      this.render = __bind(this.render, this);\n\n      this.addOne = __bind(this.addOne, this);\n\n      this.addAll = __bind(this.addAll, this);\n      return IndexView.__super__.constructor.apply(this, arguments);\n    }\n\n    IndexView.prototype.template = JST[\"backbone/templates/friend_requests/index\"];\n\n    IndexView.prototype.initialize = function() {\n      return this.options.friendRequests.bind('reset', this.addAll);\n***Uncaught TypeError: Cannot call method 'bind' of undefined***\n    };\n\n    IndexView.prototype.addAll = function() {\n      return this.options.friendRequests.each(this.addOne);\n    };\n\n    IndexView.prototype.addOne = function(friendRequest) {\n      var view;\n      view = new Blog.Views.FriendRequests.FriendRequestView({\n        model: friendRequest\n      });\n      return this.$(\"tbody\").append(view.render().el);\n    };\n\n    IndexView.prototype.render = function() {\n      $(this.el).html(this.template({\n        friendRequests: this.options.friendRequests.toJSON()\n      }));\n      this.addAll();\n      return this;\n    };\n\n    return IndexView;\n\n  })(Backbone.View);\n\n}).call(this);\n</code></pre>\n\n<p>And finally, the coffeescript file <code>index_view.js.coffee</code> which generates the above error is</p>\n\n<pre><code>Blog.Views.FriendRequests ||= {}\n\nclass Blog.Views.FriendRequests.IndexView extends Backbone.View\n  template: JST[\"backbone/templates/friend_requests/index\"]\n\n  initialize: () -&gt;\n    @options.friendRequests.bind('reset', @addAll)\n\n  addAll: () =&gt;\n    @options.friendRequests.each(@addOne)\n\n  addOne: (friendRequest) =&gt;\n    view = new Blog.Views.FriendRequests.FriendRequestView({model : friendRequest})\n    @$(\"tbody\").append(view.render().el)\n\n  render: =&gt;\n    $(@el).html(@template(friendRequests: @options.friendRequests.toJSON() ))\n    @addAll()\n\n    return this\n</code></pre>\n\n<p>I'm assuming it is just something simple like not using the proper capitalization or other convention for models with two names but I can't seem to figure it out.</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT-----</p>\n\n<p>I just thought of this, but I would pay closest attention to my <code>app/views/friend_requests/index.html.erb</code> file as it is the one place that I actually hand-edited my code.  Everything else is auto-generated by the <code>rails-backbone</code> gem.</p>\n\n<p>--------EDIT #2--------------</p>\n\n<p>As per the first comment asking where the IndexView was instantiated it is here in <code>/app/assets/javascripts/backbone/routers/friend_requests_router.js.coffee</code>:</p>\n\n<pre><code>class Blog.Routers.FriendRequestsRouter extends Backbone.Router\n  initialize: (options) -&gt;\n    @friendRequests = new Blog.Collections.FriendRequestsCollection()\n    @friendRequests.reset options.friendRequests\n\n  routes:\n    \"new\"      : \"newFriendRequest\"\n    \"index\"    : \"index\"\n    \":id/edit\" : \"edit\"\n    \":id\"      : \"show\"\n    \".*\"        : \"index\"\n\n  newFriendRequest: -&gt;\n    @view = new Blog.Views.FriendRequests.NewView(collection: @friend_requests)\n    $(\"#friend_requests\").html(@view.render().el)\n\n  index: -&gt;\n    @view = new Blog.Views.FriendRequests.IndexView(friend_requests: @friend_requests)\n    $(\"#friend_requests\").html(@view.render().el)\n\n  show: (id) -&gt;\n    friend_request = @friend_requests.get(id)\n\n    @view = new Blog.Views.FriendRequests.ShowView(model: friend_request)\n    $(\"#friend_requests\").html(@view.render().el)\n\n  edit: (id) -&gt;\n    friend_request = @friend_requests.get(id)\n\n    @view = new Blog.Views.FriendRequests.EditView(model: friend_request)\n    $(\"#friend_requests\").html(@view.render().el)\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","haml"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13212458,"title":"How to get rails variable into onclick function call","body":"<p>Hi I have the following:</p>\n\n<pre><code> = link_to @place.name, '#', onclick: 'get_maps(#{@location_string});'\n</code></pre>\n\n<p>I'm currently trying to link to a javascript call with a rails variable argument but for some reason the rails variable <code>@location_string</code> isn't being passed to the javascript call with the variable in it. Currently it's being rendered as a string:</p>\n\n<pre><code>&lt;a href=\"#\" onclick=\"get_maps(#{@location_string});\"&gt;3308 Kanaina Ave&lt;/a&gt;\n</code></pre>\n\n<p>Any thoughts on how to solve this?</p>\n"},{"tags":["ruby-on-rails","heroku","godaddy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13211306,"title":"How to show a full url when using domain forwarding? (heroku & godaddy)","body":"<p>I've got a domain registered with GoDaddy (www.myapp.com). I've configured \"forwarding with masking\" so that this domain stays in the browser's address bar, even as visitors are forwarded to heroku, where the app is hosted.</p>\n\n<p>My problem is that the address bar never shows any paths or query strings after the domain. That is, no matter where I navigate in the site, it always show this</p>\n\n<pre><code>www.myapp.com\n</code></pre>\n\n<p>instead of something like this</p>\n\n<pre><code>www.myapp.com/path?query_string\n</code></pre>\n\n<p>Does anyone how to configure heroku and/or GoDaddy so that visitors to my site will see both the original domain as well as a path/query string in the browser's address bar?</p>\n"},{"tags":["ruby-on-rails","search","activerecord","serialization"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":375,"score":1,"question_id":9814622,"title":"Searching serialized data, using active record","body":"<p>I'm trying to do a simple query of a serialized column, how do you do this? </p>\n\n<pre><code>serialize :mycode, Array\n\n\n1.9.3p125 :026 &gt; MyModel.find(104).mycode\n  MyModel Load (0.6ms)  SELECT `mymodels`.* FROM `mymodels` WHERE `mymodels`.`id` = 104 LIMIT 1\n =&gt; [43565, 43402] \n1.9.3p125 :027 &gt; MyModel.find_all_by_mycode(\"[43402]\")\n  MyModel Load (0.7ms)  SELECT `mymodels`.* FROM `mymodels` WHERE `mymodels`.`mycode` = '[43402]'\n =&gt; [] \n1.9.3p125 :028 &gt; MyModel.find_all_by_mycode(43402)\n  MyModel Load (1.2ms)  SELECT `mymodels`.* FROM `mymodels` WHERE `mymodels`.`mycode` = 43402\n =&gt; [] \n1.9.3p125 :029 &gt; MyModel.find_all_by_mycode([43565, 43402])\n  MyModel Load (1.1ms)  SELECT `mymodels`.* FROM `mymodels` WHERE `mymodels`.`mycode` IN (43565, 43402)\n =&gt; [] \n</code></pre>\n"},{"tags":["ruby-on-rails","routing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13213940,"title":"Rails routing: restricting requests on a route to only one format","body":"<p>I have the following routes:</p>\n\n<pre><code>resources :tags do\n  collection do\n    get 'autocomplete', :constraints =&gt; { :format =&gt; 'js' }\n  end\nend\n</code></pre>\n\n<p>I would like this to only respond to JS requests (it's only for jQuery autocomplete), for a regular HTML request I think it should be a 404 response, or at least a redirect.</p>\n\n<p>Instead, all requests are converted to JS format by the route, so an HTML request gets a json hash.</p>\n\n<p>It isn't absolutely critical, but I would be much happier if I could cleanly restrict this route so that HTML requests to it were not allowed. How should that be handled?</p>\n"},{"tags":["ruby-on-rails","backbone.js"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13187265,"title":"Params sent are not the same in a backbone's model","body":"<p>In a simple backbone's application, I have this model :</p>\n\n<pre><code>class Rcbvm2.Models.Item extends Backbone.Model\n  initialize: (modelName) -&gt;\n    @modelName = modelName\n    @paramRoot = @modelName\n    @urlRoot = \"http://localhost:3000/#{@modelName}\"\n</code></pre>\n\n<p>When I try this :</p>\n\n<pre><code>item = new Rcbvm2.Models.Item('pages')\nitem.set('body', 'test')\nitem.id = 2\nitem.save()\n</code></pre>\n\n<p>So, there is a request send to my rails application with this :</p>\n\n<pre><code>Started PUT \"/pages/2\" for 127.0.0.1 at 2012-11-01 19:39:40 -0400\nProcessing by PagesController#update as JSON\n  Parameters: {\"pages\"=&gt;{\"silent\"=&gt;true}, \"body\"=&gt;\"test\", \"id\"=&gt;\"2\", \"page\"=&gt;{\"body\"=&gt;\"test\"}}\n</code></pre>\n\n<p>Ok, it works. My problem is when I do this :</p>\n\n<pre><code>item = new Rcbvm2.Models.Item('news') //change the model's name\nitem.set('body', 'test')\nitem.id = 2\nitem.save()\n</code></pre>\n\n<p>I have this :</p>\n\n<pre><code>Started PUT \"/news/2\" for 127.0.0.1 at 2012-11-01 19:40:04 -0400\nProcessing by NewsController#update as JSON\n  Parameters: {\"news\"=&gt;{\"silent\"=&gt;true}, \"body\"=&gt;\"test1\", \"id\"=&gt;\"2\"}\n</code></pre>\n\n<p>As you could see, there is \"body\" in the hash \"new\".</p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>With page I have this <code>\"page\"=&gt;{\"body\"=&gt;\"test\"}</code> , with news, there is nothing...</p>\n\n<p><strong>END EDIT 1</strong></p>\n\n<p>I also tried with the model \"users\", a model that doesn't exist in my rails application and It's the same think than news.</p>\n\n<p>I don't undestand. Do you have an idea?</p>\n\n<p><strong>Edit 2</strong></p>\n\n<p>This is my routes :</p>\n\n<pre><code>resources :pages\nresources :news\n</code></pre>\n\n<p>Same thing for both.</p>\n"},{"tags":["ruby-on-rails","ajax","controller","best-in-place"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13213293,"title":"best_in_place gem, view not displaying updated edit without page reload","body":"<p>I added the best_in_place gem to my project and the update does NOT take effect until a page reload has happened. I can see it flash in my show view but it requires a page reload. Why is this?</p>\n\n<p>My Lists controller:</p>\n\n<pre><code> respond_to :html, :xml, :js\n\n\n  def update\n    @list = List.find(params[:id])\n    @list.update_attributes(params[:list])  \n    respond_with(@list, :location =&gt; list_url(@list))\n  end\n</code></pre>\n\n<p>My Lists show view-</p>\n\n<pre><code>  &lt;h2 class=\"page-header\"&gt;&lt;%= best_in_place @list, :name %&gt;&lt;/h2&gt;\n  &lt;h2 class=\"lead\"&gt;&lt;%= best_in_place @list, :description %&gt;&lt;/h2&gt;\n</code></pre>\n\n<p>My gemfile- </p>\n\n<pre><code>group :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'best_in_place'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n  gem 'jquery-ui-rails'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n</code></pre>\n\n<p>My application js manifest -</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery.ui.datepicker\n//= require justgage\n//= require raphael.min\n//= require jquery.purr\n//= require best_in_place\n//= require_tree .\n</code></pre>\n\n<p>My lists coffee-</p>\n\n<pre><code>jQuery -&gt;\n  $('#task_due_date').datepicker\n    dateFormat: 'mm/dd/yy'\n\njQuery -&gt;\n  $('.best_in_place').best_in_place()\n</code></pre>\n\n<p>Could it be the order of my manifest js files?  What am I overlooking here to get the update to take without a page reload? Thanks for your attention.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13212200,"title":"Moving mysql query to model","body":"<p>I have the following mysql query working well. Quick backstory, this lists our customers by total money spent. </p>\n\n<pre><code>SELECT  SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\nFROM customer_order AS co \nJOIN customer AS cu ON (cu.customer_id = co.customer_id) \nGROUP BY co.customer_id\nORDER BY money_spent DESC\n</code></pre>\n\n<p>I attempted moving this to the customer model, as a scope, and subclass  yet I failed both ways.  I'm somewhat new to rails (formerly client-side) but I think I'm close.  Hoping y'all could point me in the right direction. Thanks in advance!!!</p>\n\n<pre><code>def self.high_rollers  \n  options = {\n      :select   =&gt; \"SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\",\n      :from     =&gt; \"customer_order AS co\",\n      :joins    =&gt; \"customer AS cu ON (cu.customer_id = co.customer_id)\",\n      :group_by =&gt; \"co.customer_id\",\n      :order    =&gt; \"money_spent DESC\"\n            }   \n</code></pre>\n\n<p>Putting the following code in my index action for this controller works, but definitely doesn't feel like the right approach!</p>\n\n<pre><code>@high_bidders = Customer.find_by_sql(&lt;&lt;-SQL\n       SELECT  SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\n       FROM customer_order AS co \n       JOIN customer AS cu ON (cu.customer_id = co.customer_id) \n       GROUP BY co.customer_id\n       ORDER BY money_spent DESC\n</code></pre>\n\n<p>SQL\n )</p>\n"},{"tags":["ruby-on-rails","netbeans","ubuntu"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2303,"score":3,"question_id":9123773,"title":"netbeans - plugins require HTML Editor Library to be installed","body":"<p>I am attempting set up Netbeans 7.1 as my RoR editor.  When trying to install plugins I get the following error:</p>\n\n<blockquote>\n  <p>Some plugins require plugin HTML Editor Library to be installed. The\n  plugin HTML Editor Library is requested in version >= 1.21 (release\n  version 1) but only 2.0.1 (of release version different from 1) was\n  found.  The following plugin is affected:       \n  Embedded Ruby (RHTML)</p>\n</blockquote>\n\n<p>I looked for this HTML plugin so I could install it but I can't seem to find it anywhere.</p>\n"},{"tags":["ruby-on-rails","ember.js"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13213280,"title":"Updating inline template to Ember 1.0 pre 2","body":"<p>I've got some of the following code: <a href=\"https://gist.github.com/c111cf9a240a078c9f6a\" rel=\"nofollow\">https://gist.github.com/c111cf9a240a078c9f6a</a> (in rails)</p>\n\n<p>I'm using ember-latest:</p>\n\n<p><code>// Version: v1.0.0-pre.2-2-g1e4bdd5</code></p>\n\n<p><code>// Last commit: 1e4bdd5 (2012-10-25 14:04:52 -0700)</code></p>\n\n<p>The blog post on 1.0 pre 2 <a href=\"http://emberjs.com/blog/2012/10/25/ember-1-0-pre2/\" rel=\"nofollow\">http://emberjs.com/blog/2012/10/25/ember-1-0-pre2/</a> says that inline templates must always be named.</p>\n\n<p>If I add <code>data-template-name=\"application\"</code> to each of the three templates, none of them are being executed (supposedly overwritten).</p>\n\n<p>How do I still support this use case without adding a router or something drastic?</p>\n"},{"tags":["ruby-on-rails","pdfkit"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":124,"score":3,"question_id":11154443,"title":"PDFKIT custom fonts","body":"<p>Is there any way to print pdf with PDFKit and custom font? </p>\n\n<p>In css I have:</p>\n\n<pre><code> @font-face {\nfont-family: 'ChaparralProRegular';\nsrc: url(\"path_to_font/chaparralpro-regular-webfont.eot\");\nsrc: url(\"path_to_font/chaparralpro-regular-webfont.eot?#iefix\") format(\"embedded-opentype\"),\nurl(\"path_to_font/chaparralpro-regular-webfont.woff\") format(\"woff\"),\nurl(\"path_to_font/chaparralpro-regular-webfont.ttf\")  format(\"truetype\"),\nurl(\"path_to_font/chaparralpro-regular-webfont.svg#ChaparralProRegular\") format(\"svg\");\n</code></pre>\n\n<p>Above code works fine when render as html but printing to pdf with PDFKit use standard font. \nAny clues? </p>\n"},{"tags":["jquery","ruby-on-rails","jquery-ui","rspec","capybara"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13187753,"title":"rails3-jquery-autocomplete: how to test with RSpec and Capybara?","body":"<p>I'm using Rails 3.2.8 with</p>\n\n<ul>\n<li>gem 'jquery-rails', '2.1.2' </li>\n<li>gem 'rails3-jquery-autocomplete', '1.0.9'</li>\n<li>gem 'rspec-rails', '2.11.4'</li>\n<li>gem 'capybara', '1.1.3' </li>\n<li>gem 'capybara-webkit', '0.12.1'</li>\n</ul>\n\n<p>I've recently converted a select drop-down to an autocomplete (using rails3-jquery-autocomplete) and am trying to update my request specs to fill in the autocomplete.</p>\n\n<p>My approach has been to create a helper as shown in <a href=\"https://gist.github.com/919459\" rel=\"nofollow\">this gist</a>:</p>\n\n<pre><code>def fill_autocomplete(field, options = {})\n  fill_in field, :with =&gt; options[:with]\n\n  selector = \"ul.ui-autocomplete a:contains('#{options[:select]}')\"\n\n  page.should have_selector selector\n  page.execute_script \"$(\\\"#{selector}\\\").mouseenter().click()\"\nend\n</code></pre>\n\n<p>If I test that with Webkit, the test fails with this message:</p>\n\n<pre><code>expected css \"ul.ui-autocomplete a:contains('Firstname Lastname')\" to return something.\n</code></pre>\n\n<p>If I test with Selenium, as I watch the test proceed in Firefox, I do <em>not</em> see the drop-down pick list appearing. Adding a <code>sleep 3</code> to wait for the drop-down doesn't help.</p>\n\n<p>I see <a href=\"https://github.com/thoughtbot/capybara-webkit/issues/50\" rel=\"nofollow\">here</a> that there is a related but somewhat old issue with capybara-webkit, something about when a field is filled in, it is immediately blurred, which would of course prevent the autocomplete pick list from appearing. But that doesn't seem to jibe with others who have gotten this to work.</p>\n\n<p>Is it currently possible to test a form that includes a rails3-jquery-autocomplete field with RSpec and Capybara? How? If not, is there a way to manually fill in the corresponding, hidden <code>id</code> field so I can still test that the form creates the correct data?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","model","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13208659,"title":"Add to cart quantity logic RoR","body":"<p>I have a method called add_to_cart created that is being called each time a user adds a product to their cart - the method then checks to see if the item already exists and if it does it increases the quantity by +1. </p>\n\n<p>The issue I am having is that I am unsure how to call my Items 'create' action (in Items controller) from my model if a product does not already exist in the cart. </p>\n\n<p>I think I could use Item.create(...) but I would rather just call the create action that already exists in my Items controller.</p>\n\n<p>Currently I have:</p>\n\n<p>Products#Index View</p>\n\n<pre><code> ...\n &lt;%= button_to \"Add to Cart\", add_to_cart_path(:product_id =&gt; product), :method =&gt; :post %&gt;\n ...\n</code></pre>\n\n<p>Routes</p>\n\n<pre><code> ...\n post '/add_to_cart/:product_id' =&gt; 'carts#add_to_cart', :as =&gt; 'add_to_cart'\n ...\n</code></pre>\n\n<p>Carts Controller</p>\n\n<pre><code> class CartsController &lt; ApplicationController\n\n def show\n   @cart = current_cart\n end\n\n def add_to_cart\n   current_cart.add_item(params[:product_id])\n   redirect_to cart_path(current_cart.id)\n end\n\n end\n</code></pre>\n\n<p>Cart Model</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\nhas_many :items\n\ndef add_item(product_id)\n        item = items.where('product_id = ?', product_id).first\n    if item\n        # increase the quantity of product in cart\n        item.quantity + 1\n        save\n    else\n        save # \"THIS IS WHERE I WANT TO CALL ITEMS CONTROLLER CREATE\"\n    end\nend\n</code></pre>\n\n<p>Items Controller</p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n\ndef create\n    @product = Product.find(params[:product_id])\n    @item = Item.create!(:cart =&gt; current_cart, :product =&gt; @product, :quantity =&gt; 1, :unit_price =&gt; @product.price)\n    redirect_to cart_path(current_cart.id)\nend\n\nend\n</code></pre>\n\n<p>Any help on how I can achieve this redirect to my create action would really be much appreciated! :)</p>\n"},{"tags":["ruby-on-rails","ruby","erb","mailto"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13208482,"title":"Extracting Data from an Id tag (ruby)","body":"<p>I am still learning and been re-searching the topic for couple of hours.</p>\n\n<p>The following code in my views displays the email address in the forum</p>\n\n<pre><code>&lt;form id=\"user_details\" action=\"&lt;%= request.path %&gt;\" method=\"post\" &gt;\n&lt;output id=\"email\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>What I am trying to do is make the email text a hyperlink (just like mailto). I just have no idea what the right syntax for this would be.</p>\n\n<p>Thank you so much!</p>\n"},{"tags":["ruby-on-rails","gem","bundle","bundler","unicorn"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":2536,"score":4,"question_id":4438601,"title":"bundler incorrectly trying to install \"development\" and \"test\" group gems in production","body":"<p>I have a small web app, which uses a bunch of gems. Some of them are only used for <code>test</code> and <code>development</code> environments. Now, when I try to start unicorn on the production server using the following command, it fails.</p>\n\n<pre><code>unicorn_rails -E production -D -c config/unicorn.rb\n</code></pre>\n\n<p>The error I see in the log files is:</p>\n\n<pre><code>Refreshing Gem list\nCould not find gem 'spork (&gt;= 0.9.0.rc2, runtime)' in any of the gem sources listed in your Gemfile.\nTry running `bundle install`.\n</code></pre>\n\n<p>I've pasted my gemfile below:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.1'\ngem 'unicorn'\ngem 'mongoid', '&gt;= 2.0.0.beta.19'\ngem 'devise'\ngem 'cancan'\ngem 'haml', '&gt;= 3.0.0'\ngem 'bson'\ngem 'bson_ext'\ngem 'formtastic'\ngem 'bluecloth'\n\ngroup :production do\n  gem 'capistrano'\nend\n\ngroup :development do\n  gem 'haml-rails'\n  gem 'hpricot', '0.8.2'\n  gem 'ruby_parser', '2.0.5'\n  gem 'less'\n  gem 'rspec-rails', '&gt;= 2.0.1'\nend\n\ngroup :development,:test do\n  gem 'spork', '&gt;=0.9.0.rc2'\n  gem 'mongoid-rspec'\nend\n\ngroup :test do\n  gem 'factory_girl_rails'\n  gem 'autotest'\n  gem 'cucumber-rails'\n  gem 'cucumber'\n  gem 'capybara'\n  gem 'shoulda'\n  gem 'database_cleaner'\n  gem 'test_notifier'\n  gem 'rspec', '2.0.1'\n  gem 'launchy' \nend\n</code></pre>\n\n<p>Bundler is supposed to detect the right environment and ignore the other gems, right? Right now, I am deleting all the lines which are not in the default group on the server to get this working, but that's an ugly hack.</p>\n"},{"tags":["ruby-on-rails","email","smtp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13212859,"title":"How to add a second SMTP relay in case first one crash ruby on rails","body":"<p>One of my project is sending a lot of emails. I want to add a back up Second SMTP relay in case first one goes down. I am using delayed job for sending emails in background if that helps.</p>\n\n<p>Just for an example, Lets assume I am using sendgrid as my SMTP relay. Now in case sendgrid goes down. I want that my application try to send email using critsend or something.</p>\n\n<p>Its pretty easy to use one in your application. All you need to paste some code in production.rb</p>\n\n<pre><code>ActionMailer::Base.smtp_settings = {\n  :user_name =&gt; \"xxxxxxxxxxxx\",\n  :password =&gt; \"xxxxxxx\",\n  :domain =&gt; \"xxxxxxxxxx.com\",\n  :address =&gt; \"smtp.sendgrid.net\",\n  :port =&gt; 587,\n  :authentication =&gt; :plain,\n  :enable_starttls_auto =&gt; true\n}\n</code></pre>\n\n<p>Now how can I add a second back up SMTP relay, in case this goes down.</p>\n\n<p><strong>PS: I am not trying to spam people.</strong> </p>\n"},{"tags":["ruby-on-rails","web-services","api","rest","concurrency"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13209437,"title":"Should Web API server use session id and/or auth-token?","body":"<p>According to @Veraticus's answer on this <a href=\"http://stackoverflow.com/questions/13197863/web-application-without-sql-query-for-current-user-authentication\">question</a>, Web authentication framework are saving the ID of the current_user in a <em>session id</em> in order to quickly and easily retrieve the user from the database (without fetching the user each time with a new query on the database).</p>\n\n<p>This is great because it's exactly what I want to do with my own server (for performance reasons), through its API which I'm writing.</p>\n\n<p>But I wondering about <em>session id</em>... I mean, if the server handle sessions, the client have to provide to him a <em>session id</em>.</p>\n\n<p>However, I'm also wondering about another thing: in general, Web API are using an <em>API key</em> (for instance, <a href=\"https://api-docs.heroku.com/\" rel=\"nofollow\">https://api-docs.heroku.com/</a>). And using an <em>API key</em> and a <em>session id</em> may be complicated for the client...</p>\n\n<p>I hope Heroku don't perfom a database query with the received auth-token at each HTTP request. But if they don't, how could they do to authenticate a user without its <em>session id</em>?</p>\n\n<p>I'm confused. Thank you a lot for any ideas.</p>\n"},{"tags":["ruby-on-rails","security","github","privacy"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":179,"score":2,"question_id":5047864,"title":"What tools do you use to avoid accidently pushing private information to a github repo on a rails project?","body":"<p>Are there any tools you use to scrub your project before pushing to a public github repo. How do you maintain your private settings, while pushing your source code to a public repo? What is the best practice?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13212377,"title":"Rails and mysql. Any way to view tables?","body":"<p>I have just started out on rails and I've been using the mysql2 gem with it.\nI realised that on rails, migrations are used to alter tables in the database. </p>\n\n<p>So I was just wondering if there was anyway I could view the tables in Mysql?\nAnd also some way to make insertions, deletions etc more efficient?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":5463972,"title":"Gift list open source app?","body":"<p>I'm looking for a Rails 2.x/3 application for administrating Gift Lists (weddings, birthdays, etc).</p>\n\n<p>Does anybody know about any?</p>\n"},{"tags":["mysql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13212349,"title":"What version of MySQL with Ruby On Rails 3.2.8?","body":"<p>I am reading through 'Pragmatic Agile Web Dev w/ Rails 4th edition for Version 3.2' and am preparing my production environment to use Mysql. I got to the point in the book where it says:</p>\n\n<p>\"There are plenty of alternatives to SQLite, both free and commercial. We will go with MySQL. It is available via your native packaging tool in Linux, and an installer is provided for OS X on the MySQL website.2 We recommend that you download MySQL 5.1, as MySQL 5.5 is known not to work with Rails 3.1.\"</p>\n\n<p><strong>Does anybody have experience with MySQL 5.5 and Rails 3.2.8?</strong> I am wondering what problems the book is referring to and if they have been resolved in the current stable version 3.2.8. <strong>Any suggestions on what version to use?</strong> </p>\n\n<p>Thanks in advance for your help!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13210457,"title":"Ruby on Rails routes.rb","body":"<p>I'm stuck in a <a href=\"http://ruby.railstutorial.org/chapters/filling-in-the-layout#code-static_page_routes\" rel=\"nofollow\">Rails tutorial</a> trying to configure Rails routes.</p>\n\n<p>This is my routes.rb:</p>\n\n<pre><code>SampleApp::Application.routes.draw do\n  match '/', :to  =&gt; 'static_pages#home', :via =&gt; :get\n  match '/help',:to =&gt; 'static_pages#help', :via =&gt; :get\n  match '/about', :to =&gt; 'static_pages#about', :via =&gt; :get\n  match '/contact', :to =&gt; 'static_pages#contact', :via =&gt; :get\n</code></pre>\n\n<p>When I try to access \"localhost\" I get: </p>\n\n<blockquote>\n  <p>No route matches [GET] \"/static_pages/help\" Try running rake routes\n  for more information on available routes.</p>\n</blockquote>\n\n<p>I also tried:</p>\n\n<pre><code>match '/', :to  =&gt; 'static_pages#home'\n  match '/help',:to =&gt; 'static_pages#help'\n  match '/about', :to =&gt; 'static_pages#about'\n  match '/contact', :to =&gt; 'static_pages#contact'\n</code></pre>\n\n<p>but that gives the same error. It only works when I use:</p>\n\n<pre><code>get 'static_pages/about'\n</code></pre>\n\n<p>How can I get localhost to work?</p>\n"},{"tags":["ruby-on-rails","associations","belongs-to","has-one"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13203159,"title":"Rails: has_one and belongs_to with presence validation on both foreign keys","body":"<p>I have an application with a <code>users</code> table and a <code>user_profiles</code> table. A user <code>has_one</code> user profile and a user profile <code>belongs_to</code> a user.</p>\n\n<p>I want to make sure that the association scenario is always true, so I've put a validation for the presence of both foreign keys. The problem is that I hit a \"chicken and egg\" situation. When I create a user, it doesn't work because the user profile doesn't exist yet, and when I create a user profile, it doesn't work either because the user doesn't exist yet. So I need to create the user profile within the creation of the user. To complicate things, when I create a client, I also create a user in an <code>after_create</code> callback. Enough talking (or reading/writting), here is some code:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_one :user_profile\n    validates :user_profile_id, presence: true\nend\n\nclass UserProfile &lt; ActiveRecord::Base\n  belongs_to :user\n  validates :user_id, presence: true\nend\n\nclass Client &lt; ActiveRecord::Base\n  after_create :create_client_user\n\n  private\n\n  def create_client_user\n    User.create!(\n      email: \"admin@example.com\",\n      password: \"admin\",\n      password_confirmation: \"admin\",\n      client_id: self.id\n      # I need to create a user profile dynamically here\n    )\n  end\nend\n</code></pre>\n\n<p>Is it possible to do what I want to do?</p>\n\n<h2>Update</h2>\n\n<p>I tried the solution @cdesrosiers suggested, but I can't make my specs pass. I am mainly having three errors. First let me show you the updated models:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :user_profile, inverse_of: :user\n  before_create { build_user_profile }\n\n  validates :user_profile, presence: true\n\n  def client=(client)\n    self.client_id = client.id\n  end\n\n  def client\n    current_database = Apartment::Database.current_database\n    Apartment::Database.switch\n    client = Client.find(self.client_id)\n    Apartment::Database.switch(current_database)\n    client\n  end\nend\n\nclass UserProfile &lt; ActiveRecord::Base\n  belongs_to :user\n\n  validates :user, presence: true\nend\n\nclass Client &lt; ActiveRecord::Base\n  attr_accessible :domain, :name\n\n  after_create :create_client_database\n  after_create :create_client_user\n  after_destroy :drop_client_database\n\n  # Create the client database (Apartment) for multi-tenancy\n  def create_client_database\n    Apartment::Database.create(self.domain)\n  end\n\n  # Create an admin user for the client\n  def create_client_user\n    Apartment::Database.switch(self.domain)\n\n    User.create!(\n      email: \"admin@example.com\",\n      password: \"admin\",\n      password_confirmation: \"admin\",\n      client: self\n    )\n\n    # Switch back to the public schema\n    Apartment::Database.switch\n  end\n\n  def drop_client_database\n    Apartment::Database.drop(self.domain)\n  end\nend\n</code></pre>\n\n<p>I am using FactoryGirl to create factories, here is my factories file:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :client do\n    sequence(:domain) { |n| \"client#{n}\" }\n    name              Faker::Company.name\n  end\n\n  factory :user do\n    sequence(:email)      { |n| \"user#{n}@example.com\"}\n    password              \"password\"\n    password_confirmation \"password\"\n    client\n    #user_profile\n  end\n\n  factory :credentials, class: User do\n    email       \"user@example.com\"\n    password    \"password\"\n  end\n\n  factory :user_profile do\n    forename       Faker::Name.first_name\n    surname        Faker::Name.last_name\n    birthday       (5..90).to_a.sample.years.ago\n    #user\n  end\nend\n</code></pre>\n\n<p>If I uncomment the <code>user_profile</code> and <code>user</code> associations in the user and user profile factories respectively, I get a <code>WARNING:  out of shared memory</code>.</p>\n\n<p>Now, when I create one of those factories, I get one of those three errors:</p>\n\n<pre><code>Failure/Error: @user = create(:user)\n     ActiveRecord::RecordInvalid:\n       Validation failed: User profile A user profile is required\n     # ./app/models/client.rb:41:in `create_client_user'\n     # ./spec/controllers/users_controller_spec.rb:150:in `block (4 levels) in &lt;top (required)&gt;'\n\nFailure/Error: create(:user_profile).should respond_to :surname\n    ActiveRecord::RecordInvalid:\n      Validation failed: User A user is required\n    # ./spec/models/user_profile_spec.rb:29:in `block (4 levels) in &lt;top (required)&gt;'\n\nFailure/Error: let(:client) { create(:client) }\n     ActiveRecord::RecordInvalid:\n       Validation failed: User profile A user profile is required\n     # ./app/models/client.rb:41:in `create_client_user'\n     # ./spec/controllers/sessions_controller_spec.rb:4:in `block (2 levels) in &lt;top (required)&gt;'\n     # ./spec/controllers/sessions_controller_spec.rb:7:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>So I assume that the change in the User model didn't work. Also note that I removed the <code>user_profile_id</code> from the users table.</p>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13193089,"title":"Logout on all browsers/devices","body":"<p>My Rails 3 app uses Devise for authentication, sessions are stored in cookie files. I'd like to have a feature of logging a user out on all browsers/devises simultaneously. Can this be done, or I have to store sessions in databases?</p>\n"},{"tags":["ruby-on-rails","amazon-s3","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13210744,"title":"Rails set up a proxy for Paperclip images on S3?","body":"<p>I have a Rails 3 app with images hosted on AWS S3 and managed by the Paperclip gem. </p>\n\n<p>I'm trying to set it up so that a user can edit those image in-browser using a js library (right now I'm using Pixastic, but I'm open to trying Caman) but run into a problem where the js image manipulation libraries fail because of CSRF protections from the browser that reject the S3 image as being from a different domain. </p>\n\n<p>Is there some way to proxy the images so that they appear to be coming from the same domain, or otherwise work around this problem?</p>\n"},{"tags":["ruby-on-rails","database","postgresql","webbynode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13167306,"title":"Rails / Webbynode: Database push with postgresql?","body":"<p>When I do </p>\n\n<pre><code>webbynode database push \n</code></pre>\n\n<p>Webbynode looks for a mysql database, how do I make it look for postgresql instead ?\nMy webbynode and the app are both setup for postgresql.</p>\n\n<p>This is the error message I get: </p>\n\n<pre><code>ERROR: Invalid MySQL credentials for your local database (Can't connect to local MySQL server through socket '/tmp/mysql.sock' (2))\nStopping taps server...\n</code></pre>\n\n<p>Jakob</p>\n"},{"tags":["ruby-on-rails","activerecord","table-relationships"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13210238,"title":"object relationships and passing object ids to multiple controllers?","body":"<p>I am in a pickle on the best way to do something and would appreciate some advice.</p>\n\n<p>I have the following models:</p>\n\n<pre><code>class Plan &lt; ActiveRecord::Base\n  attr_accessible :description, :name, :user_id\n\n  validates :name, :presence =&gt; true\nend\n\nclass Planplace &lt; ActiveRecord::Base\n  attr_accessible :plan_id, :planplace\n\n  validates :planplace, :presence =&gt; true\nend\n\nclass Plandate &lt; ActiveRecord::Base\n  attr_accessible :plan_id, :plandate\n\n  validates :plandate, :presence =&gt; true\nend\n</code></pre>\n\n<p>A plan can have many plandates and planplaces.\nI have a contoller for each of these that do a very basic create.</p>\n\n<pre><code>class PlansController &lt; ApplicationController\n\ndef create\n    @plan = Plan.new(params[:plan])\n    if @plan.save\n        flash[:success] = \"Created ...\"\n    else\n        flash[:alert] = \"placeplace save error ...\"\n    end\nend   \nend\n\nclass PlanplacesController &lt; ApplicationController\n\n    def create\n        @planplace = Planplace.new(params[:planplace])\n        if @planplace.save\n            flash[:success] = \"Created ...\"\n        else\n            flash[:alert] = \"placeplace save error ...\"\n        end\n    end\nend\n\nclass PlandatesController &lt; ApplicationController\n\n    def create\n        @plandate = Plandate.new(params[:plandate])\n        if @plandate.save\n            flash[:success] = \"Created ...\"\n        else\n            flash[:alert] = \"plandate save error ...\"\n        end\n    end\nend\n</code></pre>\n\n<p>What I need to do is have one single view that creates a plan and allows several plandates and several planplaces to be saved using that plan.plan_id.</p>\n\n<p>What is the best way of achieving this on a basic level (I will aim at doing ajax calls for saving without reloading but I am far off this, I am still trying to learn).</p>\n\n<p>Do I place this within a single 'new' plan view?. I have played around with a form that uses fields_for to update more that one model within the same form but I would like to get a general idea of the best approach to take here before plodding on. </p>\n\n<p>I know I need to make use of the has_many and belongs_to within the model but I am unsure the best way to do the complete save so the relationship is correct.</p>\n\n<p>Hopefully I have explained this well.\nAny suggestions on the best approach is much appreciated.</p>\n\n<p>(please be kind, I have only been learning Rails for a month now)</p>\n\n<p>---Edit ---\nI have worked out the model here and how to pass the objects I need. I don't think I asked this question correctly since I was a little confused. Thanks for all who had a look at it.</p>\n"},{"tags":["ruby-on-rails","ruby","authentication","oauth","single-sign-on"],"answer_count":2,"favorite_count":4,"up_vote_count":12,"down_vote_count":0,"view_count":247,"score":12,"question_id":10215831,"title":"Rails authentication across apps/servers","body":"<p>I've been developing my rails apps whilst keeping them as modular as possible. I'm trying to implement different parts underneath as services.</p>\n\n<p>Say an example of Facebook:<br>\na) A <strong>MainApp</strong> that allows the user to have a wall, posts, etc.<br>\nb) A <strong>PhotoApp</strong> that stores photos, allows the user to see his photos, etc. This is a standalone app that will have a REST API that can be used by MainApp as well.</p>\n\n<p>I was thinking of using OAuth as a Single Sign On solution (as in this tutorial <a href=\"http://blog.joshsoftware.com/2010/12/16/multiple-applications-with-devise-omniauth-and-single-sign-on/\">http://blog.joshsoftware.com/2010/12/16/multiple-applications-with-devise-omniauth-and-single-sign-on/</a>) where each app will be authorized via OAuth and will get access to the current user session based on the cookie.</p>\n\n<p><strong><em>First question:</em></strong> Is this a viable solution?</p>\n\n<p><strong><em>Second question:</em></strong> I want to be able to call the <strong>PhotoApp</strong> API from the <strong>MainApp</strong> server (not from the user's browser). How would authentication work in this situation?</p>\n\n<p><strong><em>Third question:</em></strong> How would this work if say I had a service that used node.js?</p>\n"},{"tags":["ruby-on-rails","ruby-1.9.2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13211881,"title":"RoR not creating nested record on before_save","body":"<p>I have a model Site which has_many photos.</p>\n\n<p>In site model I have</p>\n\n<pre><code>before_save :defaults\ndef defaults\n    if self.photos.length ==0 &amp;&amp; !SiteDefault.default_photo.nil?\n      photo = Photo.new \n      photo.image = SiteDefault.default_photo.image\n      self.photos.push photo  \n    end \nend \n</code></pre>\n\n<p>It is not storing the default photo when creating a site. Why?</p>\n\n<p>I dont see any error in the console. The image is being uploaded to Amazon S3 correctly.</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13211809,"title":"Test if string can be downcased?","body":"<p>I have a Feature model, where I am adding a before_save:</p>\n\n<pre><code>before_save {|feature|\n    downcase_value(feature)\n}\n\ndef downcase_value(record)\n    record.value.downcase!\nend\n</code></pre>\n\n<p>This works fine, unless I have saved a date in the column, in which case i get an error:</p>\n\n<pre><code>undefined method `downcase!' for Tue, 06 Feb 1996:Date\n</code></pre>\n\n<p>So my question is this - how can I test if the value can be downcased most efficiently?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","reload","rails-engines","ruby-on-rails-3"],"answer_count":9,"favorite_count":15,"up_vote_count":21,"down_vote_count":0,"view_count":6619,"score":21,"question_id":3282655,"title":"Ruby on Rails 3 - Reload lib directory for each request","body":"<p>I'm creating a new engine for a rails 3 application. As you can guess, this engine is in the lib directory of my application.</p>\n\n<p>However, i have some problems developing it. Indeed, I need to restart my server each time I change something in the engine.</p>\n\n<p>Is there a way to avoid this ?</p>\n\n<p>Can I force rails to completely reload the lib directory or a specific file and his requirements for each request ?</p>\n\n<p>Thanks for your help :)</p>\n"},{"tags":["ruby-on-rails","ruby","testunit","minitest"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":463,"score":3,"question_id":10573923,"title":"minitest, test::unit, and rails","body":"<p>I read somewhere that 'minitest' is the \"new test::unit for ruby 1.9.2+\". </p>\n\n<p>But ruby 1.9.3 seems to include <em>both</em> <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/test/unit/rdoc/Test/Unit.html\" rel=\"nofollow\">test::unit</a> <em>and</em> <a href=\"http://www.ruby-doc.org/stdlib-1.9.3/libdoc/minitest/unit/rdoc/MiniTest.html\" rel=\"nofollow\">minitest</a>, is that true?</p>\n\n<p>In the default rails testing, as outlined in the <a href=\"http://guides.rubyonrails.org/testing.html\" rel=\"nofollow\">Rails testing guide</a>....  things like <code>ActiveSupport::TestCase</code>, <code>ActionController::TestCase</code>, are these using <code>Test::Unit</code> or <code>Minitest</code>?</p>\n\n<p>In the rails guide, it shows examples with tests defined like this:</p>\n\n<pre><code>test \"should show post\" do\n  get :show, :id =&gt; @post.id\n  assert_response :success\nend\n</code></pre>\n\n<p>That syntax, <code>test string</code>, as opposed to defining methods with names like <code>test_something</code> --  isn't mentioned in the docs for <em>either</em> <code>Test::Unit</code> or Minitest.  Where's that coming from?  Is Rails adding it, or is it actually a part of... whatever testing lib rails is using?</p>\n\n<p>PS: Please don't tell me \"just use rspec\". I know about rspec. I am trying to explore the stdlib alternatives, in the context of rails. </p>\n"},{"tags":["ruby-on-rails","git","heroku","github","assembla"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13207094,"title":"Can Heroku work as version control?","body":"<p>I am working with this school project (webapp in RoR) in group of 10 and we get into this fight. </p>\n\n<p>One says we should use Heroku as our web host because it does version control with git. \nThe other says it's cool to use Heroku as web host, but it doesn't not store old code and keep track of changes, so we should set up our own github/assembla-git. </p>\n\n<p>Who is right?</p>\n"},{"tags":["ruby-on-rails","segmentation-fault"],"answer_count":7,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3068,"score":4,"question_id":3423471,"title":"Rails segmentation fault when starting server?","body":"<p>Trying to get my rails 3 environment up and running and I keep encountering an error I can't get around. Any help would be great appreciated!</p>\n\n<p>Here is the problem:</p>\n\n<pre><code>Patrick-Scotts-MacBook-Pro:~ PJS$ cd hope_app\nPatrick-Scotts-MacBook-Pro:hope_app PJS$ rails server\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3/sqlite3_native.bundle: [BUG] Segmentation fault\nruby 1.9.2dev (2010-07-11 revision 28618) [x86_64-darwin10.4.0]\n\n-- control frame ----------\nc:0026 p:-541019732 s:0075 b:0075 l:000074 d:000074 TOP   \nc:0025 p:---- s:0073 b:0073 l:000072 d:000072 CFUNC  :require\nc:0024 p:0029 s:0069 b:0069 l:000065 d:000068 BLOCK  /Users/PJS/.rvm/gems/ruby-1.9.2-    rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:6\nc:0023 p:0035 s:0066 b:0066 l:000065 d:000065 TOP    /Users/PJS/.rvm/gems/ruby-1.9.2- rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:2\nc:0022 p:---- s:0064 b:0064 l:000063 d:000063 FINISH\nc:0021 p:---- s:0062 b:0062 l:000061 d:000061 CFUNC  :require\nc:0020 p:0026 s:0058 b:0058 l:000039 d:000057 BLOCK  /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:64\nc:0019 p:---- s:0055 b:0055 l:000054 d:000054 FINISH\nc:0018 p:---- s:0053 b:0053 l:000052 d:000052 CFUNC  :each\nc:0017 p:0080 s:0050 b:0050 l:000039 d:000049 BLOCK  /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:62\nc:0016 p:---- s:0045 b:0045 l:000044 d:000044 FINISH\nc:0015 p:---- s:0043 b:0043 l:000042 d:000042 CFUNC  :each\nc:0014 p:0046 s:0040 b:0040 l:000039 d:000039 METHOD /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:51\nc:0013 p:0021 s:0036 b:0036 l:000035 d:000035 METHOD /Users/PJS/.rvm/gems/ruby-1.9.2-   rc2/gems/bundler-1.0.0.rc.2/lib/bundler.rb:114\nc:0012 p:0079 s:0032 b:0032 l:000031 d:000031 TOP    /Users/PJS/hope_app/config/application.rb:7\nc:0011 p:---- s:0030 b:0030 l:000029 d:000029 FINISH\nc:0010 p:---- s:0028 b:0028 l:000027 d:000027 CFUNC  :require\nc:0009 p:0016 s:0024 b:0024 l:000015 d:000023 BLOCK  /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:28\nc:0008 p:---- s:0021 b:0021 l:000020 d:000020 FINISH\nc:0007 p:---- s:0019 b:0019 l:000018 d:000018 CFUNC  :tap\nc:0006 p:0468 s:0016 b:0016 l:000015 d:000015 TOP    /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:27\nc:0005 p:---- s:0012 b:0012 l:000011 d:000011 FINISH\nc:0004 p:---- s:0010 b:0010 l:000009 d:000009 CFUNC  :require\nc:0003 p:0061 s:0006 b:0006 l:001598 d:0013a8 EVAL   script/rails:6\nc:0002 p:---- s:0004 b:0004 l:000003 d:000003 FINISH\nc:0001 p:0000 s:0002 b:0002 l:001598 d:001598 TOP   \n---------------------------\n-- Ruby level backtrace information ----------------------------------------\nscript/rails:6:in `&lt;main&gt;'\nscript/rails:6:in `require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:27:in `&lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:27:in `tap'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:28:in `block in &lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:28:in `require'\n/Users/PJS/hope_app/config/application.rb:7:in `&lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler.rb:114:in `require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:51:in `require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:51:in `each'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:62:in `block in require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:62:in `each'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:64:in `block (2 levels) in require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:64:in `require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:2:in `&lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:6:in `rescue in &lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:6:in `require'\n\n-- C level backtrace information -------------------------------------------\n</code></pre>\n"}]}
{"total":93231,"page":11,"pagesize":100,"questions":[{"tags":["ruby-on-rails","reload","rails-engines","ruby-on-rails-3"],"answer_count":9,"favorite_count":15,"up_vote_count":21,"down_vote_count":0,"view_count":6619,"score":21,"question_id":3282655,"title":"Ruby on Rails 3 - Reload lib directory for each request","body":"<p>I'm creating a new engine for a rails 3 application. As you can guess, this engine is in the lib directory of my application.</p>\n\n<p>However, i have some problems developing it. Indeed, I need to restart my server each time I change something in the engine.</p>\n\n<p>Is there a way to avoid this ?</p>\n\n<p>Can I force rails to completely reload the lib directory or a specific file and his requirements for each request ?</p>\n\n<p>Thanks for your help :)</p>\n"},{"tags":["ruby-on-rails","ruby","testunit","minitest"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":463,"score":3,"question_id":10573923,"title":"minitest, test::unit, and rails","body":"<p>I read somewhere that 'minitest' is the \"new test::unit for ruby 1.9.2+\". </p>\n\n<p>But ruby 1.9.3 seems to include <em>both</em> <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/test/unit/rdoc/Test/Unit.html\" rel=\"nofollow\">test::unit</a> <em>and</em> <a href=\"http://www.ruby-doc.org/stdlib-1.9.3/libdoc/minitest/unit/rdoc/MiniTest.html\" rel=\"nofollow\">minitest</a>, is that true?</p>\n\n<p>In the default rails testing, as outlined in the <a href=\"http://guides.rubyonrails.org/testing.html\" rel=\"nofollow\">Rails testing guide</a>....  things like <code>ActiveSupport::TestCase</code>, <code>ActionController::TestCase</code>, are these using <code>Test::Unit</code> or <code>Minitest</code>?</p>\n\n<p>In the rails guide, it shows examples with tests defined like this:</p>\n\n<pre><code>test \"should show post\" do\n  get :show, :id =&gt; @post.id\n  assert_response :success\nend\n</code></pre>\n\n<p>That syntax, <code>test string</code>, as opposed to defining methods with names like <code>test_something</code> --  isn't mentioned in the docs for <em>either</em> <code>Test::Unit</code> or Minitest.  Where's that coming from?  Is Rails adding it, or is it actually a part of... whatever testing lib rails is using?</p>\n\n<p>PS: Please don't tell me \"just use rspec\". I know about rspec. I am trying to explore the stdlib alternatives, in the context of rails. </p>\n"},{"tags":["ruby-on-rails","git","heroku","github","assembla"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13207094,"title":"Can Heroku work as version control?","body":"<p>I am working with this school project (webapp in RoR) in group of 10 and we get into this fight. </p>\n\n<p>One says we should use Heroku as our web host because it does version control with git. \nThe other says it's cool to use Heroku as web host, but it doesn't not store old code and keep track of changes, so we should set up our own github/assembla-git. </p>\n\n<p>Who is right?</p>\n"},{"tags":["ruby-on-rails","segmentation-fault"],"answer_count":7,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3068,"score":4,"question_id":3423471,"title":"Rails segmentation fault when starting server?","body":"<p>Trying to get my rails 3 environment up and running and I keep encountering an error I can't get around. Any help would be great appreciated!</p>\n\n<p>Here is the problem:</p>\n\n<pre><code>Patrick-Scotts-MacBook-Pro:~ PJS$ cd hope_app\nPatrick-Scotts-MacBook-Pro:hope_app PJS$ rails server\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3/sqlite3_native.bundle: [BUG] Segmentation fault\nruby 1.9.2dev (2010-07-11 revision 28618) [x86_64-darwin10.4.0]\n\n-- control frame ----------\nc:0026 p:-541019732 s:0075 b:0075 l:000074 d:000074 TOP   \nc:0025 p:---- s:0073 b:0073 l:000072 d:000072 CFUNC  :require\nc:0024 p:0029 s:0069 b:0069 l:000065 d:000068 BLOCK  /Users/PJS/.rvm/gems/ruby-1.9.2-    rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:6\nc:0023 p:0035 s:0066 b:0066 l:000065 d:000065 TOP    /Users/PJS/.rvm/gems/ruby-1.9.2- rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:2\nc:0022 p:---- s:0064 b:0064 l:000063 d:000063 FINISH\nc:0021 p:---- s:0062 b:0062 l:000061 d:000061 CFUNC  :require\nc:0020 p:0026 s:0058 b:0058 l:000039 d:000057 BLOCK  /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:64\nc:0019 p:---- s:0055 b:0055 l:000054 d:000054 FINISH\nc:0018 p:---- s:0053 b:0053 l:000052 d:000052 CFUNC  :each\nc:0017 p:0080 s:0050 b:0050 l:000039 d:000049 BLOCK  /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:62\nc:0016 p:---- s:0045 b:0045 l:000044 d:000044 FINISH\nc:0015 p:---- s:0043 b:0043 l:000042 d:000042 CFUNC  :each\nc:0014 p:0046 s:0040 b:0040 l:000039 d:000039 METHOD /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:51\nc:0013 p:0021 s:0036 b:0036 l:000035 d:000035 METHOD /Users/PJS/.rvm/gems/ruby-1.9.2-   rc2/gems/bundler-1.0.0.rc.2/lib/bundler.rb:114\nc:0012 p:0079 s:0032 b:0032 l:000031 d:000031 TOP    /Users/PJS/hope_app/config/application.rb:7\nc:0011 p:---- s:0030 b:0030 l:000029 d:000029 FINISH\nc:0010 p:---- s:0028 b:0028 l:000027 d:000027 CFUNC  :require\nc:0009 p:0016 s:0024 b:0024 l:000015 d:000023 BLOCK  /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:28\nc:0008 p:---- s:0021 b:0021 l:000020 d:000020 FINISH\nc:0007 p:---- s:0019 b:0019 l:000018 d:000018 CFUNC  :tap\nc:0006 p:0468 s:0016 b:0016 l:000015 d:000015 TOP    /Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:27\nc:0005 p:---- s:0012 b:0012 l:000011 d:000011 FINISH\nc:0004 p:---- s:0010 b:0010 l:000009 d:000009 CFUNC  :require\nc:0003 p:0061 s:0006 b:0006 l:001598 d:0013a8 EVAL   script/rails:6\nc:0002 p:---- s:0004 b:0004 l:000003 d:000003 FINISH\nc:0001 p:0000 s:0002 b:0002 l:001598 d:001598 TOP   \n---------------------------\n-- Ruby level backtrace information ----------------------------------------\nscript/rails:6:in `&lt;main&gt;'\nscript/rails:6:in `require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:27:in `&lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:27:in `tap'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:28:in `block in &lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/railties-3.0.0.rc/lib/rails/commands.rb:28:in `require'\n/Users/PJS/hope_app/config/application.rb:7:in `&lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler.rb:114:in `require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:51:in `require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:51:in `each'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:62:in `block in require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:62:in `each'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:64:in `block (2 levels) in require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/bundler-1.0.0.rc.2/lib/bundler/runtime.rb:64:in `require'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:2:in `&lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:6:in `rescue in &lt;top (required)&gt;'\n/Users/PJS/.rvm/gems/ruby-1.9.2-rc2/gems/sqlite3-ruby-1.3.1/lib/sqlite3.rb:6:in `require'\n\n-- C level backtrace information -------------------------------------------\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","node.js","coffeescript","execjs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13211073,"title":"ExecJS::RuntimeError on any page including coffeescript","body":"<pre><code>ExecJS::RuntimeError in Users#index\n</code></pre>\n\n<p>I'm getting an error like this on every single page of my app. Everything used to work... for some reason it isn't working now when I restarted my app.</p>\n\n<p>I am on Windows</p>\n\n<p>I have node already installed, tried adding the following to my boot.rb to ensure it's using node</p>\n\n<pre><code>ENV['EXECJS_RUNTIME'] = 'Node'\n</code></pre>\n\n<p>I have </p>\n\n<pre><code>gem 'execjs'\n</code></pre>\n\n<p>but NOT rubyracer, because according to my research,</p>\n\n<ol>\n<li>Node is supposed to work too</li>\n<li>rubyracer can't install on windows (when I try it attempts to install libv8 which gives me errors on windows)</li>\n</ol>\n\n<p>I'm sure it's something silly, I mean it was JUST working. I am using thin server and start with <code>thin start</code></p>\n\n<p>The error in my log is</p>\n\n<pre><code>ActionView::Template::Error ([\"ok\",\"&lt;Some OK looking javascript code&gt;\"])\n(in &lt;path&gt;/global.js.coffee)\n</code></pre>\n\n<p>My application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require bootstrap\n//= require global\n//= require_tree .\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13210914,"title":"Modelling business attributes/amenities in rails","body":"<p>I have a <code>Business</code> model in my application, which will be storing information about </p>\n\n<ul>\n<li>Restaurants</li>\n<li>Bars</li>\n<li>Stores</li>\n<li>Hair Salons</li>\n<li>Etc</li>\n</ul>\n\n<p>Some of the businesses share attributes/amenities:</p>\n\n<ul>\n<li>Wifi</li>\n<li>A/C</li>\n<li>Accesibility</li>\n<li>Etc..</li>\n</ul>\n\n<p>But some are specific for a single type of businesses, for example restaurants:</p>\n\n<ul>\n<li>Take out</li>\n<li>Delivery</li>\n<li>Dress code</li>\n<li>Outdoor seating</li>\n</ul>\n\n<p>I am wondering what would be the best way of modelling this information in the DB?</p>\n\n<p>My current thinking:</p>\n\n<p>Use a single table for <code>Business</code> that will hold all the information and attributes. Most of the attributes are boolean, therefore whenever an attribute does not apply to a business type, it will simply be <code>false</code>.</p>\n\n<p>I am not sure however, if there is a better way of doing this. Also not sure about how to handle these differences at the view level. For example, when creating a business, I want the option the display/set those attributes that are applicable to the business type.</p>\n"},{"tags":["ruby-on-rails","highcharts","lazy-high-charts"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13211002,"title":"Highcharts area chart with lazy_chart ruby gem","body":"<p>I am trying to use <a href=\"https://github.com/michelson/lazy_high_charts\" rel=\"nofollow\">https://github.com/michelson/lazy_high_charts</a> to render a simple area chart with dates on the x-axis and scores on the y-axis. I used the following snippet from lazy_high_charts. Graph is rendered but x-axis is not dates.</p>\n\n<pre><code>@h = LazyHighCharts::HighChart.new('graph', style: '') do |f|\n  f.options[:chart][:defaultSeriesType] = \"area\"\n  f.options[:plotOptions] = {areaspline: {pointInterval: 1.day, pointStart: 10.days.ago}}\n  f.series(:name=&gt;'John', :data=&gt;[3, 20, 3, 5, 4, 10, 12 ,3, 5,6,7,7,80,9,9])\n  f.series(:name=&gt;'Jane', :data=&gt; [1, 3, 4, 3, 3, 5, 4,-46,7,8,8,9,9,0,0,9])\n  f.xAxis(type: :datetime)\nend\n</code></pre>\n\n<p>I would like to have time series with a day interval, something like this <a href=\"http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/series-pointstart-datetime/\" rel=\"nofollow\">http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/plotoptions/series-pointstart-datetime/</a>. </p>\n\n<p>Above code produces the following html (<a href=\"http://jsfiddle.net/nUxvA/\" rel=\"nofollow\">http://jsfiddle.net/nUxvA/</a>)</p>\n\n<p>I tried to compare both and the plot options is different. How can I have day interval scale on x-axis?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","model","logic"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13210476,"title":"Quantity in Cart Model Basic Logic Ruby on Rails","body":"<p>I am trying to apply some very basic logic to my view but am so far failing. </p>\n\n<p>What I would like to do is return item.discount_price if there are the following conditions:</p>\n\n<ol>\n<li>The item.product_id is equal to 1</li>\n<li>The Cart.item.quantity count is equal or higher than 2. </li>\n</ol>\n\n<p>Currently I have the following:</p>\n\n<p>Items Model</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\nbelongs_to :product\nbelongs_to :cart\n\ndef price_check\n\n    if  Item.product_id = 1 &amp;&amp; Item.quantity.count &gt;= 2 \n        return Item.discount_price\n    else\n        return Item.unit_price\n    end \n\nend\n</code></pre>\n\n<p>end</p>\n\n<p>View</p>\n\n<pre><code>&lt;% for item in @cart.items %&gt;\n&lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n  ...\n  &lt;td class=\"price\"&gt;&lt;%= gbp(item.price_check) %&gt;&lt;/td&gt;\n  ...\n&lt;/tr&gt;\n</code></pre>\n\n  \n\n<p>The associations are as follows:</p>\n\n<pre><code>Cart - has_many :items\nItems - Belongs_to :cart and :products\nProducts - has_ many :items\n</code></pre>\n\n<p>The error I keep receiving:</p>\n\n<pre><code> NoMethodError in Carts#show\n\nShowing C:/Sites/checkout/app/views/carts/show.html.erb where line #12 raised:\n\nundefined method `quantity' for #&lt;Class:0x50c3058&gt;\n\nExtracted source (around line #12):\n\n9:        &lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n10:       &lt;td&gt;&lt;%=h item.product.name %&gt;&lt;/td&gt;\n11:       &lt;td class=\"qty\"&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n12:       &lt;td class=\"price\"&gt;&lt;%= gbp(item.price_check) %&gt;&lt;/td&gt;\n13:       &lt;td class=\"price\"&gt;&lt;%= gbp(item.full_price) %&gt;&lt;/td&gt;\n14:       &lt;td&gt;&lt;%= button_to 'Remove', item, :method =&gt; :delete %&gt;&lt;/td&gt;\n15:       &lt;/tr&gt;\n\napp/models/item.rb:12:in `price_check'\napp/views/carts/show.html.erb:12:in `block in _app_views_carts_show_html_erb___389237738_48997308'\napp/views/carts/show.html.erb:8:in `_app_views_carts_show_html_erb___389237738_48997308'\n</code></pre>\n\n<p>Any help people can offer to fix this would be much appreciated! Thanks E</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","polymorphic-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":156,"score":0,"question_id":10366507,"title":"Rails polymorphic association change type","body":"<p>i've a question about a polymophic association in rails. the following model relationships are given:</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\n  has_many :events, :as =&gt; :event_container, :dependent =&gt; :destroy\n end\n\nclass Order &lt; ActiveRecord::Base\n  has_many :events, :as =&gt; :event_container, :dependent =&gt; :destroy\n end\n\nclass Event &lt; ActiveRecord::Base\n  belongs_to :event_container, :polymorphic =&gt; true\nend\n</code></pre>\n\n<p>So, i've events that are first applied to a cart and after checkout, they have to be stored as events that are related to an order. Here's my question: How can i transfer an event object form a cart to an order, so that \"event_container_id\" and \"event_container_type\" are updated? If i'm just trying to copy from on object to another like this:</p>\n\n<pre><code>c = Cart.first\no = Order.first\nc.events.create(...)\no.events &lt;&lt; c.events.first\n</code></pre>\n\n<p>i get an <code>ActiveRecord::AssociationTypeMismatch</code>Exception. </p>\n\n<p>It might also be possible that my association structure is totally wrong - don't hasitate to tell me, if this is the case... ;)</p>\n\n<p>thx in advance!</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":10,"score":-1,"question_id":13210815,"title":"ruby-jwt sample","body":"<p>Rails/Ruby noob here...</p>\n\n<p>Does anybody have a code sample of using ruby-jwt in Ruby on Rails?</p>\n\n<p>I'm struggling to get the correct require statement at the top of my code.</p>\n\n<p>Thanks</p>\n\n<p>Nick</p>\n"},{"tags":["ruby-on-rails","mongoid","rails-geocoder"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13202479,"title":"geocode:all rake task not working","body":"<p>I am using Mongoid and geocoder.  I have an embedded document/model that I need to geocode and the rake task geocode:all is not working.  The geocoding works if I save an individual object. </p>\n\n<p>The Location model is embedded in the Account model.  When I run;</p>\n\n<pre><code> rake geocode:all CLASS=Location\n</code></pre>\n\n<p>No errors but it doesn't do anything.\nIf I run;</p>\n\n<pre><code>rake geocode:all CLASS=Account\n</code></pre>\n\n<p>I get this error;</p>\n\n<pre><code>rake aborted!  undefined method `not_geocoded' for Account:Class\n</code></pre>\n\n<p>Can anyone help? </p>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13210034,"title":"Rails command doesn't exist","body":"<p>In Ubuntu 12.04, <code>gem install rails</code> succeeds, but when I try <code>rails -v</code> I get an error message saying:</p>\n\n<blockquote>\n  <p>The program rails is  currently not installed. You can install it by\n  ...</p>\n</blockquote>\n\n<p>How can I get the <code>rails</code> command to work?</p>\n"},{"tags":["ruby-on-rails","ruby","authentication","authorization","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13210240,"title":"Ruby on Rails Authorization isn't saved","body":"<p>I'm following this: <a href=\"http://net.tutsplus.com/tutorials/ruby/how-to-use-omniauth-to-authenticate-your-users/\" rel=\"nofollow\">tutorial</a>  </p>\n\n<pre><code>user = User.new :name =&gt; auth_hash[\"user_info\"][\"name\"], :email =&gt; auth_hash[\"user_info\"][\"email\"]\nuser.authorizations.build :provider =&gt; auth_hash[\"provider\"], :uid =&gt; auth_hash[\"uid\"]\nuser.save\nrender :text =&gt; \"Hi #{user.name}! You've signed up.\"\n</code></pre>\n\n<p>I was browsing the DB and inspecting table <code>authorization</code> and fount out the table is empty.<br>\nwhy is that?</p>\n\n<p><strong>EDIT:</strong>\nI get this error:</p>\n\n<blockquote>\n  <p>Oops, something went wrong: [\"Authorizations is invalid\"]</p>\n</blockquote>\n\n<p>this is user.rb:  </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :topics\n  has_many :authorizations\n\n  attr_accessible :email, :name\n  validates :name, :email, :presence =&gt; true\nend\n</code></pre>\n\n<p>this is authorization.rb:  </p>\n\n<pre><code>class Authorization &lt; ActiveRecord::Base\n\n  belongs_to :user\n  validates :provider, :uid, :presence =&gt; true\n\n  attr_accessible :provider, :uid\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","cookies","url-encoding"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1946,"score":2,"question_id":1094944,"title":"How can I disable URL-encoding of cookies in Rails","body":"<p>I have a Rails application that has to co-exist with a very old legacy application.  The legacy application looks for a cookie that has a value containing a specific string of characters.  Unfortunately, the characters in the legacy cookie often contain slashes.  The problem I have is that when the Rails application writes the cookie it first does URL-encoding which causes the legacy app to break because the cookie values is incorrect.  </p>\n\n<p>I had this working in Rails 1.13.5 by editing the file <code>cookie_performance_fix.rb</code> (Path: <code>./actionpack-1.13.5/lib/action_controller/cgi_ext/cookie_performance_fix.rb</code>)<br />\nIn order to get this to work I changed the code as shown:  </p>\n\n<pre><code>def to_s\n  buf = \"\"\n  buf &lt;&lt; @name &lt;&lt; '='\n\n  if @value.kind_of?(String)\n    rails code. \n        #buf &lt;&lt; CGI::escape(@value)\n         buf &lt;&lt; @value\n  else\n        #buf &lt;&lt; @value.collect{|v| CGI::escape(v) }.join(\"&amp;\")\n  \tbuf &lt;&lt; @value.collect{|v| (v) }.join(\"&amp;\")\n\n  end\n</code></pre>\n\n<p>This actually worked fine until I decided to upgrade Rails to version 2.3.2<br />\nIn Rails 2.3.2 the <code>cookie_performance_fix.rb</code> file no longer exists.  I looked in the same directory and found a file called <code>cookie.rb</code>  which I tried modifying in a similar fashion.  </p>\n\n<pre><code>def to_s\n  buf = ''\n  buf &lt;&lt; @name &lt;&lt; '='\n  #buf &lt;&lt; (@value.kind_of?(String) ? CGI::escape(@value) : @value.collect{|v| CGI::escape(v) }.join(\"&amp;\"))\n    buf &lt;&lt; (@value.kind_of?(String) ? @value : @value.collect{|v| (v) }.join(\"&amp;\"))\n  buf &lt;&lt; '; domain=' &lt;&lt; @domain if @domain\n  buf &lt;&lt; '; path=' &lt;&lt; @path if @path\n  buf &lt;&lt; '; expires=' &lt;&lt; CGI::rfc1123_date(@expires) if @expires\n  buf &lt;&lt; '; secure' if @secure\n  buf &lt;&lt; '; HttpOnly' if @http_only\n  buf\nend\n</code></pre>\n\n<p>This unfortunately does not seem to work. The cookie keeps getting URL-encoded in the new Rails 2.3.2.  I know that turning off URL-encoding is not the best idea, but I don't have much choice until the legacy application is retired.  I unfortunately do not have access to the legacy code to add support for URL-unencoding the cookie so I have to make sure the legacy cookie is written with the correct sequence including the slashes.  If anyone can tell me how to turn off URL-encoding in Rails 2.3.2 it would be greatly appreciated.<br />\nThanks.</p>\n"},{"tags":["ruby-on-rails","json","rabl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13210433,"title":"Understanding APIs","body":"<p>I was reading through the RABL git <a href=\"https://github.com/nesquena/rabl\" rel=\"nofollow\">https://github.com/nesquena/rabl</a> and I quickly came across this line. Can someone quickly explain what he means by \"generating APIs\"? </p>\n\n<ul>\n<li>When using the ActiveRecord 'to_json' method, I tend to quickly find myself wanting a more expressive and powerful solution for generating APIs.</li>\n</ul>\n\n<p>From my understanding an API is a set of classes / methods that may be used to interact with the content of the API creators material. With that definition, I believe he is saying that he wants to be able to interact easier with the API so he build RABL which allows for the content to be translated from his application to, in this case, Rails eaiser?</p>\n"},{"tags":["ruby-on-rails","node.js","deployment","webserver","ubuntu-12.04"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13203335,"title":"Set Node.js to $PATH (Ubuntu 12.04)","body":"<p>I am studying RoR and I am setting this virtual machine to \"deploy\" RoR and I got stuck in the Node.js installation.</p>\n\n<p>I am using Ubuntu 12.04 and I followed this step of this guide:</p>\n\n<p><a href=\"http://railsapps.github.com/installing-rails.html\" rel=\"nofollow\">http://railsapps.github.com/installing-rails.html</a></p>\n\n<blockquote>\n  <p>Since Rails 3.1, a JavaScript runtime has been needed for development on Ubuntu Linux (it is not needed for Mac OS X or Windows). For\n  development on Linux Ubuntu, it is best to install the Node.js\n  server-side JavaScript environment:</p>\n  \n  <p><code>$ sudo apt-get install nodejs</code></p>\n  \n  <p>and set it in your $PATH.</p>\n</blockquote>\n\n<p>What does it mean, \"set to my $PATH\"?</p>\n\n<p>I've been searching for it on google in the last couple of hours and all solutions are different, for different problems and I get no simple answer for that. Can you give a little light here?</p>\n\n<p>Thanks!</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13209966,"title":"Building full calendar for week schedule planning","body":"<p>I am trying to build a planner for the schedule for 1 week on Rails.</p>\n\n<p>Right now I am looking into the jquery plug-in <a href=\"http://arshaw.com/fullcalendar/\" rel=\"nofollow\">FullCalendar</a>.</p>\n\n<p>It offers a weekly view with different time slots and draggable events, the functionalities which I needed. However, it does planning for a full time range when I only need it for one week.</p>\n\n<p>I am new to jQuery, so I would appreciate it if someone could give me guidance on whether it is a good idea to use this plug in for my application.\nIf it is, how should I go about doing it and if it isn't are there any other better suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13109068,"title":"How to display integers as 6-digit values in Ruby on Rails?","body":"<p>How can I format integers in a text_field so that they always consist of 6 digits?</p>\n\n<p>So for example when the integer is stored as <code>1</code> in the database, in the text_field it would say: <code>000001</code>. The user should also be able to edit these values, yet not reduce or exceed the number of digits.</p>\n\n<p>I tried something like this but it's not working for me:</p>\n\n<pre><code>def formatted_number(int)\n  int.to_s.rjust(6, '0')\nend\n</code></pre>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","wysihat"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":11079617,"title":"`next_migration_number': NotImplementedError (NotImplementedError) using wysihat-engine in rails","body":"<p>I am using following gem for editor.</p>\n\n<pre><code>gem \"wysihat-engine\", \"~&gt; 0.1.13\"\n</code></pre>\n\n<p>When I run 'rails generate wysihat' it's generate all image file, but can't generate migration and giving following error </p>\n\n<pre><code>c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/generators/migration.rb:30:in `next_migration_number': NotImplementedError (NotImplementedError)\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/generators/migration.rb:49:in `migration_template'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/wysihat-engine-0.1.13/lib/generators/wysihat_generator.rb:60:in `install_wysihat'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/task.rb:22:in `run'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:118:in `invoke_task'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `block in invoke_all'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `each'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `map'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `invoke_all'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/group.rb:226:in `dispatch'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/base.rb:389:in `start'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/generators.rb:170:in `invoke'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/commands/generate.rb:12:in `&lt;top (required)&gt;'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `block in require'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'\n    from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/commands.rb:29:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Thanks for any help!</p>\n"},{"tags":["mysql","ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13209733,"title":"Set Association in Ruby on Rails","body":"<p>I used a migration in ruby to create these tables together with a model.</p>\n\n<p>I have a Table Information and a Table Detail, each entry in the information table can have one association in the detail table.</p>\n\n<p>So i created them with:</p>\n\n<pre><code>create_table :details do |t|\n      t.integer :id\n      t.string :Bezeichnung\n      t.binary :Koordinaten\n    end\n\n create_table :informations do |t|\n      t.integer :id\n      t.integer :DetailID\n      t.integer :Longitude\n      t.integer :Latitude\n    end\n</code></pre>\n\n<p>In my Information Table i got a DetailID which should Reference to the id of the Detail table.</p>\n\n<p>Now i did: </p>\n\n<pre><code>ALTER TABLE informations\n      ADD CONSTRAINT fk_informations_details\n      FOREIGN KEY (DetailID)\n      REFERENCES details(id)\n</code></pre>\n\n<p>Is this correct? Have i set the FOREIGN KEY correct? Or do i have to put the foreign key in the other table!?</p>\n\n<p>Because i want to use in my Information Model following:</p>\n\n<pre><code>has_one :detail, :foreign_key =&gt; 'DetailID'\n</code></pre>\n\n<p>And in the Detail Model following:</p>\n\n<pre><code>belongs_to :main\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","csv","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13209239,"title":"Problems importing a CSV that has a filename as a string in Rails","body":"<p>I'm trying to import a CSV file to my Rails app that's using CarrierWave to handle file uploads. I'm using the <code>CSV</code> gem and populating the Rails database via a seed data.</p>\n\n<p>The issue I'm having is the import doesn't populate the image field of the database. The image column is a string that holds the filename eg. 'this-is-my-photo.jpg'. </p>\n\n<p>I have a database table that has the following columns:</p>\n\n<pre><code># ProductImage model, product_image table\n\nid |     image    |     tile      | product_id | created_at | updated_at \n--------------------------------------------------------------------------\n 1 | image-1.jpg  | Big shoe      |     11     | 2012-08-01 | 2012-08-01\n 2 | 1-photo.png  | Small hat     |     12     | 2012-08-01 | 2012-08-01\n 3 | jeansb1.gif  | Ankle socks   |     13     | 2012-08-01 | 2012-08-01\n\n\n# Import product_image table backup\nCSV.foreach(Rails.root.join(\"db/seeds/product_image.csv\"), headers: true) do |row|\n  ProductImage.create! do |product_image|\n    product_image.id = row[0]\n    product_image.title = row[1]\n    product_image.image = row[2]\n    product_image.product_id = row[3]\n  end\nend\n</code></pre>\n\n<p>The results of <code>db:seed</code> </p>\n\n<pre><code># ProductImage model, product_image table after population of seed data\n\nid |     image    |     tile      | product_id | created_at | updated_at \n--------------------------------------------------------------------------\n 1 |              | Big shoe      |     11     | 2012-11-01 | 2012-11-01\n 2 |              | Small hat     |     12     | 2012-11-01 | 2012-11-01\n 3 |              | Ankle socks   |     13     | 2012-11-01 | 2012-11-01\n</code></pre>\n\n<p>Everything but the <code>image</code> column was populated.</p>\n\n<p>I was wondering if anyone can give me tips on how to go about resolving this import/population issue. Has anyone experienced this problem before and is it because of the the filename type (eg. .jpg)?</p>\n\n<p>Also, I have the same problem when restoring my user model that has an <code>avatar</code> column which is a string that holds the CarrierWave filename.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","controller"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13209540,"title":"Rails - Allow access to controller action only to server side","body":"<p>I have <code>users</code> and <code>projects</code> scaffolds in my Rails project.  I also have an <code>admin</code> controller and view that is only accessible to admin users.  I want the <code>index</code> and <code>create</code> controller actions for the <code>users</code> and <code>projects</code> models to be only accessible to the <code>admin</code> view (using <code>render :partial &gt; 'index'</code>) but I do not want to let the visitors to the site to be able to type in <code>http://railsapp.host/users</code> and get the partial rendered.  How do I achieve this?</p>\n\n<p>TO clarify, my issue is not about the user role.  I have authlogic with all the require_admin helpers but I dont even want an admin user to be able to access the <code>index</code> route for <code>users</code> directly from the browser.  In effect I want to limit the <code>index</code> controller action only to the view code of <code>admin#index</code> like this:</p>\n\n<pre><code>&lt;%= render '/users/index' %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","amazon-web-services","elastic-beanstalk"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":195,"score":1,"question_id":12710693,"title":"Deploying rails application on AWS Elastic Beanstalk","body":"<p>Hi do anyone of you know how to deploy Rails Application on AWS Elastic Beanstalk? Previously i had 2 PHP application runs on AWS which is easy to deploy. Also is there any specific EC2 server we need to choose in order to deploy rails application, how would we automate rails server command? Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","rubygems"],"answer_count":7,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":8703,"score":9,"question_id":4393189,"title":"Failing installing pg gem, \"mkmf.rb can't find header files for ruby\" (Mac OSX 10.6.5)","body":"<p>I just upgraded to rails3 and had a bit of a mess with macports/gems/databases to sort out. So I threw out all gems to install them fresh. Everything seems to be ok except for the aquirement of the <em>pg gem</em>.</p>\n\n<p>After creating a new rails3 project, prepared for postgres, the server would not start, complaining about the missing pg gem. Ok, doing <code>bundle install</code> then. It chugs along for a while and, of course, fails on the pg gem!</p>\n\n<pre><code>Installing pg (0.10.0) with native extensions /Library/Ruby/Site/1.8/rubygems/installer.rb:483:in `build_extensions': ERROR: Failed to build gem native extension. (Gem::Installer::ExtensionBuildError)\n\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb \nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n\n\nGem files will remain installed in /Library/Ruby/Gems/1.8/gems/pg-0.10.0 for inspection.\nResults logged to /Library/Ruby/Gems/1.8/gems/pg-0.10.0/ext/gem_make.out\n    from /Library/Ruby/Site/1.8/rubygems/installer.rb:446:in `each'\n    from /Library/Ruby/Site/1.8/rubygems/installer.rb:446:in `build_extensions'\n    from /Library/Ruby/Site/1.8/rubygems/installer.rb:198:in `install'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/source.rb:95:in `install'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/installer.rb:55:in `run'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `each'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `each'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/installer.rb:44:in `run'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/installer.rb:8:in `install'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/cli.rb:225:in `install'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor/task.rb:22:in `send'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor/task.rb:22:in `run'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor.rb:246:in `dispatch'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor/base.rb:389:in `start'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/bin/bundle:13\n    from /usr/bin/bundle:19:in `load'\n    from /usr/bin/bundle:19\n</code></pre>\n\n<p>The most common suggestion I have found on forums and blogs is to (re)install the XCode developer tools. They were already there, but I reinstalled it anyway - with no better outcome than the above.</p>\n\n<p><code>which ruby</code> says <code>/usr/bin/ruby</code>, and <code>ruby -v</code> says <code>ruby 1.8.7 (2009-06-12 patchlevel 174) [universal-darwin10.0]</code>, if there's any clue there.</p>\n\n<p>Any pointers welcome. Any missing information that would help figuring this out, I'll gladly and promptly provide! Thanks.</p>\n\n<p>/me</p>\n\n<p>EDIT:</p>\n\n<p>I downloaded xcode etc (since the dvd version is said to be broken) and things went better for a while. <code>bundle install</code> started talking about <em>archflags</em> instead. So i did: \n<code>sudo env ARCHFLAGS=\"-arch i386\" bundle install</code> and things seemed to go fine - until starting rails barfed, saying:  </p>\n\n<pre><code>/Library/Ruby/Gems/1.8/gems/pg-0.10.0/lib/pg_ext.bundle: dlopen(/Library/Ruby/Gems/1.8/gems/pg-0.10.0/lib/pg_ext.bundle, 9): no suitable image found.  Did find: (LoadError)\n    /Library/Ruby/Gems/1.8/gems/pg-0.10.0/lib/pg_ext.bundle: mach-o, but wrong architecture - /Library/Ruby/Gems/1.8/gems/pg-0.10.0/lib/pg_ext.bundle\n</code></pre>\n\n<p>Grappling for anything, I tried  <code>bundle install</code> with archflags set to \"-arch x86_64\", but it  didn't go down well:</p>\n\n<pre><code>*** Your PostgreSQL installation doesn't seem to have an architecture in common with the running ruby interpreter ([] vs. [\"x86_64\"])\nI'll continue anyway, but if it fails, try setting ARCHFLAGS.\n[...]\nCan't find the PostgreSQL client library (libpq)\n*** extconf.rb failed ***\n</code></pre>\n\n<p>Is <em>libpq</em> something I now have to supply a path to via some flags? Or am I completely out to lunch? :)</p>\n\n<p>/me again</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","activerecord","join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13209384,"title":"Join between two tables fails in Activerecord with uninitialized constant error","body":"<p>Using Activerecord (on a postgresql database) this program should do a simple <strong>inner join between the tables</strong> \"cars\" and \"car_parts\". Both tables exist in the db, are filled with data, and, keys are named by activerecord convention (i.e., primary keys in both tables are named \"id\"; foreign key in \"car_parts\" linking to \"cars\" is named \"car_id\"). I tried two alternatives by using \"include\" and \"join\" in Activerecord - unfortunately both failed with the below message. Any help appreciated, thanks! My program:</p>\n\n<pre><code>require 'active_record'\n\nActiveRecord::Base.establish_connection(\n    # details left out\n)\n\nclass Car &lt; ActiveRecord::Base\n  has_many :car_parts\nend\n\nclass Car_Part &lt; ActiveRecord::Base\n  belongs_to :car\nend\n\nresults2 = Car.joins(:car_parts)\nresults2.each{|row|  puts row.id}\n\nresults3 = Car.find :all, :include =&gt; [:car_parts]\nresults3.each{|row|  puts row.id}\n</code></pre>\n\n<p>For both results2 and results3 I receive the error message: \"/home/myname/.rvm/gems/ruby-1.9.3-p194@global/gems/activerecord-3.2.8/lib/active_record/inheritance.rb:111:in `compute_type': uninitialized constant Car::CarPart (NameError)\"</p>\n"},{"tags":["ruby-on-rails","mvc","methods","routes","links"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":126,"score":3,"question_id":13182661,"title":"Rails 3 how do I use link_to to change the value of a boolean in the db?","body":"<p>Hey guys im trying to create a simple link that will allow an admin to approve a user on my website </p>\n\n<p>quite similar to what this guy was trying : <a href=\"http://stackoverflow.com/questions/7124781/in-rails-3-how-do-i-use-button-to-to-change-the-value-of-a-boolean\">In Rails 3 how do I use button_to to change the value of a boolean?</a></p>\n\n<p>im relatively new to rails so bear with me :)</p>\n\n<p>Heres how it was supposed to work :</p>\n\n<ol>\n<li>Admin clicks the link to approve a user</li>\n<li>The link calls the activate function in UsersController</li>\n<li>The active function calls that users model </li>\n<li>the user model updates the approved attribute to true and saves it</li>\n</ol>\n\n<p>and here's how i was going to do it </p>\n\n<p>in my users#index view</p>\n\n<pre><code> &lt;% @users.each do |user| %&gt; \n &lt;%= link_to 'Approve', :action =&gt; \"index\", :method =&gt; 'activate', :id =&gt; user.id, :class =&gt; 'btn btn-mini btn-danger' %&gt; \n&lt;% end %&gt; \n</code></pre>\n\n<p>in my userController</p>\n\n<pre><code>def activate\n  @user = User.find(params[:user])\n  @user.activate_user\nend\n</code></pre>\n\n<p>in my user model</p>\n\n<pre><code>def activate_user \n  self.approved = 'true'\n  self.save\nend\n</code></pre>\n\n<p>and my routes </p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :registrations =&gt; \"registrations\" }\n\nresources :users do\n  member do\n    get 'activate'\n    put 'activate'\n  end\nend\n\nmatch \"users/:id/activate\" =&gt; \"users#activate\"\n</code></pre>\n\n<p>Now when i click the link (to approve users), im sent back to the user index page (like im supposed to) but the user field \"approved\" is still set to false :I</p>\n\n<p>the url i get after clicking the link : </p>\n\n<pre><code>  http://localhost:3000/users?class=btn+btn-mini+btn-danger&amp;id=2&amp;method=activate\n</code></pre>\n\n<p>Any ideas ? this is driving me nuts :)</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>As suggested iv added the url to the link_to helper</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt; \n  &lt;%= link_to \"Approve\", :controller =&gt; \"users\", :id =&gt; user.id, :action =&gt; \"activate\", :method =&gt; :put, :approved =&gt; true %&gt; \n&lt;% end %&gt;\n</code></pre>\n\n<p>When i click the helper link i get </p>\n\n<pre><code>wrong number of arguments (1 for 2) \n</code></pre>\n\n<p>in app/controllers/users_controller.rb:7:in `activate'</p>\n\n<pre><code>def activate\n  @user = User.find(params[:id])\n  @user.update_attribute(params[:user])\n  redirect_to \"/users?approved=false\"\nend\n</code></pre>\n\n<p>line 7 where the error is \n    @user.update_attribute(params[:user])</p>\n\n<p>what else should i put there ? </p>\n\n<p>oh and here is my route for this method</p>\n\n<pre><code>match \"/users/:id/activate\" =&gt; \"users#activate\"\n</code></pre>\n\n<p><strong>UPDATE V2</strong>\nokey so i have changed that update line to :</p>\n\n<pre><code>@user.update_attributes(@user.approved, \"true\")\n</code></pre>\n\n<p>and it seems to do everything i want it to do except changing the value to true ! </p>\n\n<p>ive also tried to use 1 for true (and the update_attribute function) and non-strings.. running out of ideas here lol</p>\n"},{"tags":["ruby-on-rails","ruby","facebook","omniauth"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13207211,"title":"omniauth with rails: get facebook user's information","body":"<p>in the callback of the authentication process I do:<br>\n<code>auth_hash = request.env['omniauth.auth']</code> </p>\n\n<p>and then, I'm extracting the user id, but is it possible in the same time getting the user's name and email address? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13209490,"title":"Increasing Cart quantity RoR","body":"<p>I am trying to create a basic setup in my cart controller that will allow me to incrementally increase the quantity value of products added to the cart if an Item record already exists. </p>\n\n<p>I currently have:</p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n\ndef create  \n    @product = Product.find(params[:product_id])\n\n    if @item.new_record?\n        @item = Item.create!(:cart =&gt; current_cart, :product =&gt; @product, :quantity =&gt; 1, :unit_price =&gt; @product.price)\n    else\n        @item.increment! :quantity\n    end\n    redirect_to cart_path(current_cart.id)\nend\n\nend\n</code></pre>\n\n<p>However I keep getting the error <code>undefined method</code>new_record?' for nil:NilClass`</p>\n\n<p>Any help people can offer to solve this really would be much appreciated!</p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","formtastic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13102851,"title":"Formtastic bootstrap checkbox label","body":"<p>I've got phone_numbers which have 3 permissions of local, regional and national - each a boolean.</p>\n\n<p>My form at the moment looks like this:</p>\n\n<pre><code>=semantic_form_for @phone_number, :html =&gt; {:class =&gt; \"form-horizontal\"} do |f|\n  =f.semantic_errors\n  =f.inputs do\n    =f.input :phone_number_type, :as =&gt; :select, :collection =&gt; PhoneNumber::PHONE_NUMBER_TYPES, :include_blank =&gt; false, :label =&gt; \"Type\", :required =&gt; false\n    =f.input :phone_number, :required =&gt; false\n    =f.semantic_fields_for :permission do |permission_fields|\n      =permission_fields.input :local, :label =&gt; false\n      =permission_fields.input :regional, :label =&gt; false\n      =permission_fields.input :national, :label =&gt; false\n\n  =f.actions do\n    =f.action :submit, :label =&gt; \"Save\"\n</code></pre>\n\n<p>Putting label false give each checkbox a single label to the right.  Without it each checkbox has 2 labels - one on the left and one on the right.  I've floated the 3 checkboxes, so they are in a horizonal line, so I'd really like local to have a label that says \"Permissions\" on the left and \"local\" on the right.</p>\n\n<p>Is there a way to do this?</p>\n"},{"tags":["javascript","ruby-on-rails","heroku","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13185055,"title":"twitter bootstrap modals not working when pushed to Heroku","body":"<p>The modals work locally, but when I push, they're not showing up. Not the ones where I have to click to show up, nor the ones that should show up automatically.</p>\n\n<p>Has anybody ever had this issue?</p>\n\n<pre><code>&lt;!-- modal window for explaining --&gt;\n&lt;div class=\"modal fade center\" id=\"self-b\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\"&gt;\n  &lt;div class=\"modal-header center\"&gt;\n    &lt;h3 style=\"font-weight:normal;\"&gt;First things first&lt;/h3&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n  $('#self-b').modal()\n&lt;/script&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","html5","local-storage","html5-appcache"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13209507,"title":"HTML5 Cache Manifest caching request that is not define in manifest","body":"<p>I'm working on Application where I'm required to cache certain request for </p>\n\n<p>So I was toiling with the HTML5 cache </p>\n\n<p>Here my manifest file</p>\n\n<pre><code>CACHE MANIFEST\n# 2d25a26de3a1148a2fa5e534325f84cca2184090174c6ba451451c54f71f52d6\nassets/application.js\nassets/application.css\nassets/glyphicons/png/glyphicons_064_lightbulb.png\nassets/jquery-mobile/ajax-loader.gif\nassets/jquery-mobile/icons-18-white.png\napplication.manifest\n\nNETWORK:\n/project_show\n/application.manifest \n</code></pre>\n\n<p>Now I have content in <code>/projects_show</code> page that look like this</p>\n\n<pre><code>&lt;div data-role=\"header\" class=\"header\"&gt;\n&lt;/div&gt;\n\n&lt;div data-role=\"content\" class=\"content\"&gt;\n&lt;/div&gt;  \n\n&lt;div data-role=\"footer\" class=\"footer\" style=\"text-align:center\"&gt;   \n&lt;/div&gt;  \n\n&lt;script type=\"text/javascript\"&gt;\n    &lt;%= store_key %&gt;\n&lt;/script&gt;\n\n&lt;script id=\"header\" type=\"text/template\"&gt;\n    &lt;h1&gt;Listing of {{ carName   }}&lt;/h1&gt;\n&lt;/script&gt;\n\n&lt;script id=\"content\" type=\"text/template\"&gt;\n    &lt;span&gt;{{ pageName }}&lt;/span&gt;\n&lt;/script&gt;\n\n&lt;script id=\"footer\" type=\"text/template\"&gt;\n    &lt;span&gt; CopyRight &amp;copy; {{ user }} &lt;/span&gt; \n&lt;/script&gt;\n\n\n&lt;script type=\"text/javascript\"&gt;\n\n    $(document).ready(function() {\n        if (window.navigator.onLine) {\n                $.getJSON('/project/2.json',function(data) {\n\n                   localStorage.setItem(\"acura\",JSON.stringify(data));\n\n                        var carTemplate = $('#header').html();\n                        var pageTemplate = $('#content').html();\n                        var footerTemplate = $(\"#footer\").html();\n                        $('div.header').html(Mustache.to_html(carTemplate, data));\n                    $('div.content').html(Mustache.to_html(pageTemplate, data));\n                $('div.footer').html(Mustache.to_html(footerTemplate,data));\n\n                    })\n\n      else {\n            var data = JSON.parse(localStorage.getItem(\"acura\"))\n            var carTemplate = $('#header').html();\n                var pageTemplate = $('#content').html();\n                var footerTemplate = $(\"#footer\").html();\n            $('div.header').html(Mustache.to_html(carTemplate, data));\n                $('div.content').html(Mustache.to_html(pageTemplate, data));\n                $('div.footer').html(Mustache.to_html(footerTemplate,data));\n      }             \n    })\n&lt;/script&gt;\n</code></pre>\n\n<p>You Can See the idea over here is if the user is online fetch the <code>json</code> response from the server and if not then fetch the data from the <code>localStorage</code></p>\n\n<p>Unfortunately the above code is not working since Reason</p>\n\n<p>a) Cache Manifest file is caching the <code>ajax</code> request as well </p>\n\n<p>Now one can See I'm havent ask HTML cache manifest to cache the <code>json</code> request</p>\n\n<p>i.e <code>/projects/2.json</code></p>\n\n<p>Can anyone tell me why is this so </p>\n\n<p>The above code work fine if the <code>GET</code> request if modified to a <code>POST</code> request i.e <code>a POST request to</code>/projects/2.json<code>instead of GET</code></p>\n\n<p>But that is not what I'm looking for at any suggestion</p>\n\n<p>FYI Manifest does follow the manifest file correctly as I also notice that my <code>/projects</code> getting cache even though not define in <code>manifest</code>  </p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","ruby-on-rails-3.2","asset-pipeline","bootswatch"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":558,"score":0,"question_id":9919588,"title":"How to incorporate a (static) bootstrap template into rails asset pipeline?","body":"<p>I'm making a homepage with twitter bootstrap, rails 3.2.1 and twitter-bootstrap-rails gem (https://github.com/seyhunak/twitter-bootstrap-rails).</p>\n\n<p>Wanted to try a different look other than the classic twitter one and found a great template called \"United\" from bootswatch.com.</p>\n\n<p>I downloaded four files (bootstrap.css / bootstrap.min.css / variables.less / bootswatch.less) .</p>\n\n<p>How can I incorporate these files into the asset pipeline?</p>\n\n<p>Here is the listing from my 'app/assets' directory (the files are generated by twitter-bootstrap-rails gem).</p>\n\n<pre><code>/images/rails.png\n/javascripts/application.js\n/javascripts/bootstrap.js.coffee\n/javascripts/products.js.coffee\n/stylesheets/application.css\n/stylesheets/bootstrap_and_overrides.css.less\n</code></pre>\n\n<p>I have no clue.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","twitter-bootstrap-rails","bootswatch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":188,"score":0,"question_id":12775621,"title":"How to add wrapbootstrap (made with twitter bootstrap) themes to rails application","body":"<p>The website <code>https://wrapbootstrap.com/</code> has themes which were made using Twitter Bootstrap. Each of these themes include different versions of Twitter Bootstrap along with other various libraries and versions (jquery, fontawesome, etc...)</p>\n\n<p>How do I add these themes to my existing Rails app? What are the steps?</p>\n\n<p>I'm especially curious about the conflicts that may arrise if I'm already using a different version of jquery, twitter bootstrap, fontawesome, and others (as declared in the Gemfile).</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails","less","twitter-bootstrap-rails","bootswatch"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1066,"score":0,"question_id":10955548,"title":"Integrating Bootswatch Theme with Twitter-Bootstrap-Rails Gem","body":"<p>I've got a Ruby on Rails app running with Bootstrap, which I installed using the gem twitter-bootstrap-rails.</p>\n\n<p>I'd now like to integrate a new Bootswatch theme, but I'm having trouble figuring out what to do.</p>\n\n<p>There are four possible downloads for each theme - a bootstrap.css file, a bootstrap.min.css file, a variables.less file, and a bootswatch.less. My question is: do I need to download and add them ALL to my ~/app/assets/stylesheets folder? or do I just need a subset of those? Currently inside ~/app/assets/stylesheets are just two files: application.css and boostrap_and_overrides.css.less. LESS really throws me off here so I'm totally confused with how it works and what I need to do to add new css files with this setup. Any help is appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13209378,"title":"Rails not using test.sqlite3 with \"-e test\"","body":"<p>If i run <code>rails console test</code>, and do <code>SomeTable.all</code> i can see all the fields in the test.sqlite3 database, but when i run <code>rails server -e test</code> it doesn't picks up any records. \nThe app is showing results just fine with the development database.\nWhat can be the problem ?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems","installation"],"answer_count":8,"favorite_count":7,"up_vote_count":17,"down_vote_count":0,"view_count":17415,"score":17,"question_id":4827092,"title":"unable to install pg gem","body":"<p>I tried using <code>gem install pg</code> but it doesn't seem to work.</p>\n\n<p><code>gem install pg</code> gives this error</p>\n\n<pre><code>Temporarily enhancing PATH to include DevKit...\nBuilding native extensions.  This could take a while...\nERROR:  Error installing pg:\n        ERROR: Failed to build gem native extension.\n\nC:/Ruby/bin/ruby.exe extconf.rb\nchecking for pg_config... no\nNo pg_config... trying anyway. If building fails, please try again with\n --with-pg-config=/path/to/pg_config\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/Ruby/bin/ruby\n        --with-pg\n        --without-pg\n        --with-pg-dir\n        --without-pg-dir\n        --with-pg-include\n        --without-pg-include=${pg-dir}/include\n        --with-pg-lib\n        --without-pg-lib=${pg-dir}/lib\n        --with-pg-config\n        --without-pg-config\n        --with-pg_config\n        --without-pg_config\n\n\nGem files will remain installed in C:/Ruby/lib/ruby/gems/1.8/gems/pg-0.10.1 for\ninspection.\nResults logged to C:/Ruby/lib/ruby/gems/1.8/gems/pg-0.10.1/ext/gem_make.out\n</code></pre>\n\n<p>Please Help. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","activerecord","sum"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13208753,"title":"What is the right way to add a sum to a table in Rails?","body":"<p>I'm displaying a list of <code>items</code> which have a <code>price</code>attribute in an HTML table.</p>\n\n<p>What is the right way of getting the total <code>price</code> add the end of the table (and where should the calculation happen)?</p>\n\n<p>I can think of 3 obvious ways, but I don't know which one is the most \"orthodoxic\"</p>\n\n<p>1- in the controller</p>\n\n<pre><code>@items = Item.all\n@item_total = @items.sum(:price)\n</code></pre>\n\n<p>and I simply display <code>@item_total</code>in my last line</p>\n\n<p>2- in the view, on the last line</p>\n\n<pre><code>&lt;%= @items.sum(:price) %&gt;\n</code></pre>\n\n<p>But I'm not sure that it's OK to do this in a view (it works, but is it OK?)</p>\n\n<p>3- in the view, add this on the last line</p>\n\n<pre><code>&lt;%= @items.inject(0){|s, e| s + e.price} %&gt;\n</code></pre>\n\n<p>But this doesn't feel right to add this kind of logic in the view.</p>\n\n<p>So which one of these is the right one? Or is there another way I'm missing?</p>\n"},{"tags":["ruby-on-rails","ruby","omniauth","shibboleth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13180023,"title":"OmniAuth Shibboleth strategy configuration not passed through","body":"<p>I'm trying to make use of <a href=\"https://github.com/toyokazu/omniauth-shibboleth\" rel=\"nofollow\">omniauth-shibboleth</a> strategy (with <a href=\"https://github.com/toyokazu/rack-saml\" rel=\"nofollow\">rack-saml</a>).</p>\n\n<p>My omniauth initializer looks like this:</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :shibboleth, {\n    :info_fields =&gt; {\n      :email =&gt; 'mail',\n    },\n    :extra_fields =&gt; [:cn, :sn, :schacHomeOrganization],\n  }\nend\n</code></pre>\n\n<p>Everything is successful up to the point where omniauth-shibboleth should set up <code>omniauth.auth</code> ENV variable, but this ends up partial.</p>\n\n<p>Namely - it does detect <code>eduPersonPrincipalName</code> and passes it to <code>uid</code> filed correctly - I can see it.</p>\n\n<p><strong>But</strong> it fails to fill in <code>email</code>, and the extra parameters <code>cn, sn, schacHomeOrganization</code>.</p>\n\n<p>I have verified that the <code>request.env</code> <strong>does contain</strong> all of the required attributes, so the problem is not at Shibboleth side.</p>\n\n<p>For debugging, I hardcoded the options in Gem file <code>lib/omniauth/strategies/shibboleth.rb</code>:</p>\n\n<pre><code>  option :info_fields, {:email =&gt; 'mail'}\n  option :extra_fields, [:cn, :sn, :schacHomeOrganization]\n</code></pre>\n\n<p>Then everything works.</p>\n\n<p>So, there seems to be problem either with my <em>Omniauth</em> setup or with the way <em>omniauth-shibboleth</em> handles the options, so that my configuration does not end up merged with default values.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Versions:</p>\n\n<pre><code>omniauth - 1.1.1\nomniauth-shibboleth - 1.0.8\nrack-saml - 0.0.4\n\npow - 0.4.0\n</code></pre>\n"},{"tags":["ruby-on-rails","polymorphic-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13204898,"title":"Rails - changing a relationship to polymorphic","body":"<p>I have an existing relationship where </p>\n\n<p><code>Artwork has_many :photos</code> and  <code>Photo belongs_to :artwork</code></p>\n\n<p>I have been trying to change these relationships to be:</p>\n\n<p><code>Artwork has_many :photos, as: :attached_photo</code> and <code>Photo belongs_to :attached_photo, polymorphic: true</code></p>\n\n<p>I'm creating the Photo objects from within the Artwork form, but they are not nested resources.</p>\n\n<p>The models are as follows:</p>\n\n<pre><code>class Artwork &lt; ActiveRecord::Base\n  attr_accessible :photos_attributes\n  has_many :photos, as: attached_photo\n  accepts_nested_attributes_for :photos, allow_destroy: true\nend\n\nclass Photo &lt; ActiveRecord::Base\n  attr_accessible :photo, :artwork_id, :attached_photo_id, :attached_photo_type\n  belongs_to :attached_photo, polymorphic: true\n  has_attached_file :photo,\n                    path: \":rails_root/assets/:class/:id_partition/:style/:basename.:extension\",\n                    url: \"/:class/:id/:style/:basename.:extension\"\nend\n</code></pre>\n\n<p>For testing purposes, I have have left the single relationship and polymorphic relationship fields in the Photo model. I have filled out both sets of fields in the database so they should point at the same resources.</p>\n\n<p>When I replace the relationships between the two models with the versions required for polymorphic associations, all images in my views stop displaying. My view code for showing the photo is</p>\n\n<pre><code>&lt;%= image_tag(@artwork.photos.first.photo.url(:medium)) %&gt;\n</code></pre>\n\n<p>When making the changes between the relationship types, upon adding the polymorphic associations, the urls still appear correctly on the page, but for some reason the images show as being broken. Upon trying to browse directly to one of the images, the error message I receive is:</p>\n\n<pre><code>undefined method `artwork' for #&lt;Photo:0xb3fc2b74&gt;\n</code></pre>\n\n<p>I can't understand where the Photo model is expecting an artwork method to come from. Can anyone offer clarification for me?</p>\n"},{"tags":["ruby-on-rails","paperclip","rmagick","image-upload"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":156,"score":0,"question_id":12132916,"title":"Rails paperclip img upload error: \"no file chosen\" with rmagick installed","body":"<p>I can't get to upload images using paperclip. Whenever I choose the file and submit the page reloads and says \"no file chosen\".</p>\n\n<p>My code trip.rb</p>\n\n<pre><code>    class Trip &lt; ActiveRecord::Base\n       has_many :images\n       accepts_nested_attributes_for :images, :allow_destroy =&gt; true\n       attr_accessible :messages_attributes\n    end \n</code></pre>\n\n<p>The form</p>\n\n<pre><code>    &lt;%= f.fields_for :images do |image_fields| %&gt; \n       &lt;% if image_fields.object.new_record? %&gt; \n         &lt;%= image_fields.file_field :image %&gt;  \n       &lt;% end %&gt; \n    &lt;% end %&gt;\n</code></pre>\n\n<p>Image.rb</p>\n\n<pre><code>    class Image &lt; ActiveRecord::Base\n     belongs_to :trips\n\n     has_attached_file :image, :styles =&gt; { :large =&gt; \"640x480\", :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100\" },\n     :storage =&gt; :s3,\n     :bucket =&gt; 'Thrill',\n     :s3_credentials =&gt; {\n       :access_key_id =&gt; 'XXXXXXXXXXXX',\n       :secret_access_key =&gt; 'xxxxxxxxxxxxxxxxxxxxx'\n     }\n    end\n</code></pre>\n\n<p>And I also have installed <strong>gem 'rmagick'</strong> in my gem file, which seems to be the solution for many, with similar problem.\nBut not really in my case. </p>\n\n<p>Any ideas what could be wrong ?\nThanks!</p>\n\n<p><strong>Update</strong></p>\n\n<p>via rails console</p>\n\n<p><code>Image.create :image =&gt; File.open('c:/sites/thrillb/app/assets/images/srf.jpg')</code></p>\n\n<p>Not working as well.</p>\n\n<pre><code> identify.exe: unable to open image `AppData/Local/Temp/stream20120826-41544-1no4\n vdp.jpg': No such file or directory @ error/blob.c/OpenBlob/2641.\n identify.exe: unable to open image `AppData/Local/Temp/stream20120826-41544-1no4\n vdp.jpg': No such file or directory @ error/blob.c/OpenBlob/2641.\n identify.exe: unable to open image `AppData/Local/Temp/stream20120826-41544-1no4\n vdp.jpg': No such file or directory @ error/blob.c/OpenBlob/2641.\n =&gt; #&lt;Image id: nil, image_file_name: \"srf.jpg\", image_content_type: \"image/jpeg\"\n , image_file_size: 142825, image_updated_at: \"2012-08-26 19:28:19\", trip_id: nil\n , created_at: nil, updated_at: nil, title: nil, location_id: nil&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13206638,"title":"Token authentication in devise not working even after adding token_authenticatable to devise","body":"<p>I have devise for authentication and the following are the steps i did and token authentication not working</p>\n\n<ol>\n<li>added <code>devise</code> to gem file</li>\n<li>rails generate devise:install</li>\n<li>rails generate devise User</li>\n<li>rake db:migrate</li>\n<li>rails generate devise:views</li>\n<li>rails generate controller home index</li>\n</ol>\n\n<p>and upto this there is no problem and then i added <code>devise:token_authenticatable</code> to user model and then i added <code>before_save :ensure_authentication_token</code>and then</p>\n\n<ol>\n<li>rails generate migration AddTokenAuthenticatableToUser authentication_token:string</li>\n</ol>\n\n<p>then added attr_accessible :authentication_token to the user model</p>\n\n<p>but</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'xxxxxxxx'}}\"\n</code></pre>\n\n<p>is not working. It displays error in terminal. pls tell me what should i do to get the token of user and use it in subsequent request?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>It saves authentication token in user table when creating new user from web app but could not register a new user from terminal or get the token for the user to authenticate using the token.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","nested-forms","simple-form"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":968,"score":1,"question_id":8415934,"title":"Rails simple_form association select with create option","body":"<p>I have a form with a belongs_to assocation, and I'd like the user to be able to either select from their addresses, or create a new one. It breaks when the form has validation errors because of conflicting information in the parameters, i.e.</p>\n\n<pre><code>\"transaction\" =&gt; { \"address_id\" = \"25\", \n    \"address_attributes\" =&gt; { \"id\" =&gt; \"25\" } } \n</code></pre>\n\n<p>I've simplified relevant files:</p>\n\n<p>Transaction.rb</p>\n\n<pre><code>class Transaction &lt; ActiveRecord::Base\n  belongs_to :address\n  accepts_nested_attributes_for :address\nend\n</code></pre>\n\n<p>Address.rb</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  has_many :transactions\nend\n</code></pre>\n\n<p>Transaction#new view</p>\n\n<pre><code>&lt;%= simple_form_for @transaction do |f| %&gt;\n\n  &lt;%= f.association :address, :collection =&gt; current_user.addresses,\n    :include_blank =&gt; \"Enter new address\",\n    :value_method =&gt; :id %&gt;\n\n  &lt;%= f.simple_fields_for :address do |address_fields| %&gt;\n    &lt;%= address_fields.input :line1 %&gt;\n    &lt;%= address_fields.input :line2 %&gt;\n    &lt;%= address_fields.input :city %&gt;\n    &lt;%= address_fields.input :state %&gt;\n    &lt;%= address_fields.input :zip, :label =&gt; \"Zip / Post Code\" %&gt;\n  &lt;% end %&gt;\n\n  &lt;%= f.submit \"Confirm\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Transaction#create controller</p>\n\n<pre><code>def create\n  trans_params = {}\n  if params[:transaction][:address_id].blank? &amp;&amp; !params[:transaction][:address_attributes].nil?\n    trans_params[:address_attributes] = params[:transaction][:address_attributes]\n  elsif !params[:transaction][:address_id].nil?\n    trans_params[:address_id] = params[:transaction][:address_id]\n  end\n\n  @transaction = Transaction.new(trans_params)\nend\n</code></pre>\n\n<p>Of course there is a chunk of code missing but I think these are the only relevant sections. The problem I'm having is, when you submit the form and there is validation errors, simple_form automatically adds <code>&lt;input id=\"transaction_address_attributes_id\" name=\"transaction[address_attributes][id]\" type=\"hidden\" value=\"25\"&gt;</code> to the end of my form, causing the parameters to clash and giving the error:</p>\n\n<pre><code>Couldn't find Address with ID=25 for Transaction with ID=\n</code></pre>\n\n<p>I imagine there is a much better way of dealing with the params in the controller. Any ideas? I have considered using javascript to remove and re-render the \"address attributes\" form but I'd rather not rely on javascript.</p>\n"},{"tags":["ruby-on-rails","windows-7","imagemagick","paperclip","image-upload"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13208311,"title":"Rails paperclip, ImageMagick img upload error - 'no file chosen'","body":"<p>Ok, so this is the second time I encounter this problem - see the previous question <a href=\"http://stackoverflow.com/questions/12132916/rails-paperclip-img-upload-error-no-file-chosen-with-rmagick-installed\">Rails paperclip img upload error: &quot;no file chosen&quot; with rmagick installed</a>.</p>\n\n<p>Since I didn't come up with u proper solution, I'm not sure what's causing it. From my research it appears that it's because I'm on Windows 7.</p>\n\n<p>I haven't made any changes to the model or form. </p>\n\n<p>But when I try to use the nested form - I simply get <strong>'no file chosen'</strong></p>\n\n<p>But after creating an Image from console:</p>\n\n<pre><code>&lt;te :image =&gt; File.open('C:/sites/thrillb/app/assets/images/ins1.jpg')\nidentify.exe: unable to open image `file': No such file or directory @ error/blo\nb.c/OpenBlob/2641.\nidentify.exe: no decode delegate for this image format `file' @ error/constitute\n.c/ReadImage/544.\nidentify.exe: unable to open image `file': No such file or directory @ error/blo\nb.c/OpenBlob/2641.\nidentify.exe: no decode delegate for this image format `file' @ error/constitute\n.c/ReadImage/544.\nidentify.exe: unable to open image `file': No such file or directory @ error/blo\nb.c/OpenBlob/2641.\nidentify.exe: no decode delegate for this image format `file' @ error/constitute\n.c/ReadImage/544.\n=&gt; #&lt;Image id: nil, image_file_name: \"ins1.jpg\", image_content_type: \"image/jpeg\n\", image_file_size: 293718, image_updated_at: \"2012-11-03 10:17:11\", trip_id: ni\nl, created_at: nil, updated_at: nil, title: nil, location_id: nil&gt;\nirb(main):002:0&gt;\n</code></pre>\n\n<p>Any Ideas?</p>\n\n<p>Thanks!</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13202929,"title":"two sided multi select that works with Rails 3","body":"<p>I need a two sided multi select box in Rails (3.2.8), just like here:</p>\n\n<p><a href=\"http://www.stevefenton.co.uk/Content/Jquery-Two-Sided-Multi-Selector/\" rel=\"nofollow\">http://www.stevefenton.co.uk/Content/Jquery-Two-Sided-Multi-Selector/</a></p>\n\n<p>However, I can't get this to work with Rails and it is so poorly documented I have to give up on that one. (It shows but the buttons don't work, even on a fresh Rails app)</p>\n\n<p>Does anyone know of a similar jquery or gem solution that DOES work with rails??</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13207988,"title":"Rails how to make dynamic modal window using twitter bootstrap","body":"<p>Hi every one I'm starting using twitter bootstrap with rails and I would like to make a modal window for each events but the modal window is the same for each component</p>\n\n<p>I've this code : </p>\n\n<pre><code>&lt;% @event.each do |event| %&gt;\n  &lt;div class=\"modal hide fade\" id=\"infos\"&gt;\n    &lt;div class=\"modal-header\"&gt; \n      &lt;a class=\"close\" data-dismiss=\"modal\"&gt;×&lt;/a&gt;\n      &lt;h3&gt;&lt;%= event.titre %&gt;&lt;/h3&gt;\n    &lt;/div&gt;\n    &lt;div class=\"modal-body\"&gt;\n      &lt;p&gt;&lt;%= event.titre %&gt;&lt;%= event.dday %&gt;&lt;%= event.lieux %&gt; &lt;%= event.commentaire%&gt;&lt;/p&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"timeline_event\" data-toggle=\"modal\" data-target=\"#infos\"&gt;\n    &lt;%= link_to (event.titre), event %&gt; &lt;br /&gt;\n    &lt;p&gt;Le &lt;%= event.dday %&gt; à &lt;%= event.lieux %&gt;&lt;/p&gt;\n   &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","algorithm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":71,"score":-1,"question_id":13208466,"title":"How to make it more faster to check if there are any same numbers between set A and B (half million numbers)","body":"<p>Hi I just wrote a code to calculate the lotteries.  I Think finally I manage the code to run, but the problem is it takes more than 100 seconds to run 5 times on scaperwiki.  Any ideas to make it faster?  That is, how to make it faster to compare if there are any same numbers exist in two sets of large numbers. </p>\n\n<p>Basically the algorithm is to pick n unique numbers from 0 to 45379620 into a hash, and anther set of unique numbers from 0 to 45379620 into a hash.   And then compare these two hashes if there are any same numbers.    So finally there are 7 hashes.\nHash A :  36450 keys stored.<br>\nHash division1: 1 key stored.\nHash divison2: 14 keys stored.\n.....\nHash division 6: 290000 keys stored.\nHash divison 7: 500000 keys stored.</p>\n\n<p>Every loop calculates Hash division1 to division 7  and then compare with Hash A.</p>\n\n<p>The result is here:</p>\n\n<pre><code>Starting run ...\n\"The possible each win: \"\n11509\n\"The possible each win: \"\n17213\n\"The possible each win: \"\n11101\n\"The possible each win: \"\n12251\n\"The possible each win: \"\n12337\nThe possible each division win money for N times, from division 1 to division 7\n[0, 0, 3829, 1765, 2436, 25256, 31125]\nThe possible total wining:\n12882.2\nFinished: 121.43 seconds elapsed\nrunfinished\n</code></pre>\n\n<p>The code is basically like this: </p>\n\n<pre><code>def hashgo(n, m)\n  hash = {}\n  i = 1\n  while i &lt;= n\n    a = Random.new.rand(0..45379620-m)\n    if !hash.has_key? (a)\n      hash[a] = i\n      i += 1\n    end\n  end\n  hash\nend \n\ndef compare(a,b)\n  c = Array.new(0)\n  a.each_key { |key| \n    if b.has_key?(key) \n      c &lt;&lt; key\n    end\n  }\n  return c.length\nend\n\n# more codes....\n\nn = 5\nwhile i &lt; n  \n  division = Array.new(0)\n  compare_result = [hashgo(1, 0), hashgo(14, 1), hashgo(252, 15), hashgo(1533, 267), hashgo(13230, 1800), hashgo(294672, 15030), hashgo(521604, 309702)]\n compare_result.each do |hash|\n   division &lt;&lt; compare(myLotto,hash)\n   #more codes\n end\n i++\nend\n</code></pre>\n\n<p>hashgo(n,m) is used to pick n numbers, it returns a hash table.  so for division 1 it's hashgo(1, 0)   division 2 is  hashgo(14, 1)  m=1, means get rid of the divison 1.   Division 3 is hashgo(252, 15)</p>\n\n<p>compare(a, b) is used to compare if there are any numbers same from two hash tables. and return the number of same numbers. </p>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":11719051,"title":"update a table which in not devise model on sign up using devise?","body":"<p>How to add value from devise registration form to another table that is not devise table</p>\n\n<p>this is sample code</p>\n\n<pre><code>&lt;div class=\"signin\"&gt;\n  &lt;h2&gt;Register&lt;/h2&gt;\n  &lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n    &lt;%= devise_error_messages! %&gt;\n\n    &lt;div&gt;&lt;%= f.label :email %&gt;&lt;br /&gt;\n    &lt;%= f.email_field :email %&gt;&lt;/div&gt;\n\n    &lt;div&gt;&lt;%= f.label :password %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password %&gt;&lt;/div&gt;\n\n    &lt;div&gt;&lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password_confirmation %&gt;&lt;/div&gt;\n\n      &lt;div&gt;&lt;%= f.label :full_name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :full_name %&gt;&lt;/div&gt;\n\n\n    &lt;div&gt;&lt;%= f.submit \"Register\" %&gt;&lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;%= render :partial =&gt; \"devise/shared/links\" %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>full name is field of profile table and i set device on user table, \nand if user enter name i want name full name store in profile table\ni dont have any idea how can i do this?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","date"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13208413,"title":"Subtracting two dates in ruby on rails","body":"<p>I'm subtracting two dates in my model in this way:-</p>\n\n<pre><code>  def total_days\n      self.to_date - self.from_date\n  end\n</code></pre>\n\n<p>My date is in <code>Mysql  Date</code> (YYYY-MM-DD)format.</p>\n\n<p>When displaying my date in view it is giving me <code>5/1</code> days. Even though 5 is correct it is appending <code>'/1'</code> to the days. How can i remove this. Is there any better way of doing it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13127189,"title":"Rails Minified (Compiled) Assets in development mode","body":"<p>How do I get my assets rendered in their minified (compiled) form in Rails development mode? </p>\n\n<p>I have about few dozens of asset files, and because they are served one after another it all takes pretty long before the page loads in development. I believe if I keep them compiled and getting served from that would speed up my page load time(I know this is not ideal when I am specifically working on assets). </p>\n\n<p>Here is my style and script tags in the layout</p>\n\n<pre><code>&lt;%= stylesheet_link_tag 'all'  %&gt;\n&lt;%= javascript_include_tag 'all' %&gt;\n</code></pre>\n\n<p>And I've also ran <code>bundle exec rake assets:precompile:nondigest</code></p>\n\n<p>But I still see the assets being rendered one after another. Please help!</p>\n"},{"tags":["ruby-on-rails","session-variables"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13128539,"title":"httpwebrequest don't send client header with self defined networkcredentials?","body":"<p>regarding to this post <a href=\"http://stackoverflow.com/questions/13066270/apache-ntlm-auth-from-c-sharp-client-do-not-work-with-self-defined-networkcreden\">Apache NTLM Auth from C# client do not work with self defined NetworkCredentials</a> I added a method to authenticate.\nI thought I am done with my work for today :) but I run into another problem.</p>\n\n<p>Code:</p>\n\n<pre><code>public static void Authenticate()\n{\n  Stream requestStream = null;\n  string loginUrl = Common.WindowAuthentication ? Common.PortalUrl + Common.IoiLoginWin : Common.PortalUrl + Common.IoiLogin;\n\n  var request = (HttpWebRequest)WebRequest.Create(loginUrl);\n  request.Method = WebRequestMethods.Http.Post;\n  request.AllowAutoRedirect = true;\n  request.CookieContainer = Common.Cookies;\n  request.Accept = @\"*/*\";\n\n  if (Common.WindowAuthentication)\n  {\n    if (Common.UserName.Length &gt; 0)\n    {\n      string[] domainuser;\n      string username;\n      string domain;\n\n      if (Common.UserName.Contains(\"@\"))\n      {\n        domainuser = Common.UserName.Split('@');\n        username = domainuser[0];\n        domain = domainuser[1];\n      }\n      else\n      {\n        domainuser = Common.UserName.Split('\\\\');\n        username = domainuser[1];\n        domain = domainuser[0];\n      }\n      var nc = new NetworkCredential(username, Common.Password, domain);\n      var cache = new CredentialCache();\n      cache.Add(request.RequestUri, \"NTLM\", nc);\n      request.Credentials = cache;\n    }\n    else\n    {\n      request.Credentials = CredentialCache.DefaultNetworkCredentials;\n    }\n  }\n  else\n  {\n    string payload = Common.ParmLogin + Common.UserName + \"&amp;\" + Common.ParmPass + Common.Password;\n    StringBuilder urlEncoded = new StringBuilder();\n    Char[] reserved = { '?', '=', '&amp;' };\n    byte[] byteBuffer;\n\n    if (payload != null)\n    {\n      int i = 0, j;\n      while (i &lt; payload.Length)\n      {\n        j = payload.IndexOfAny(reserved, i);\n        if (j == -1)\n        {\n          urlEncoded.Append(HttpUtility.UrlEncode(payload.Substring(i, payload.Length - i)));\n          break;\n        }\n        urlEncoded.Append(HttpUtility.UrlEncode(payload.Substring(i, j - i)));\n        urlEncoded.Append(payload.Substring(j, 1));\n        i = j + 1;\n      }\n      byteBuffer = Encoding.UTF8.GetBytes(urlEncoded.ToString());\n      request.ContentLength = byteBuffer.Length;\n      requestStream = request.GetRequestStream();\n      requestStream.Write(byteBuffer, 0, byteBuffer.Length);\n      requestStream.Close();\n    }\n    else\n    {\n      request.ContentLength = 0;\n    }\n    if (Common.LogCommunicatin)\n      LogCommunication(loginUrl, payload);\n  }\n\n  using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())\n  {\n    if (response.StatusCode.ToString() == \"OK\") {\n      WebHeaderCollection c = response.Headers;\n      Common.SessionCookie = Common.Cookies.GetCookies(new Uri(loginUrl))[\"_ror_session\"].Value;\n      if (Common.LogCommunicatin)\n        LogCommunication(loginUrl, \"Cookie: \" + Common.SessionCookie); \n    }\n  }\n}\n</code></pre>\n\n<p>When I use <code>CredentialCache.DefaultNetworkCredentials</code> the server (Ruby on Rails over Apache/Thin) is able to fetch Username and remote address.</p>\n\n<p>Code (part of the ruby code server side):</p>\n\n<pre><code>begin\n  cookies[:user] = { :value =&gt; user.strusername, :expires =&gt; 1.month.from_now }\n  session[:current_user_id] = user.id\n  session_record = request.env['rack.session.record']\n  session_record.update_attributes({\n    :username =&gt; user.strusername,\n    :client_ip =&gt; (request.env['HTTP_X_FORWARDED_FOR']||request.env['REMOTE_ADDR'])\n  })\nrescue =&gt; e\nend\n</code></pre>\n\n<p>But when I use own credentials the server don't get username and client_ip from the httpwebrequest.</p>\n\n<p>So what do I wrong or what do I miss ?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I inserted some ruby debug code to inspect the session and headers.\nIn fact the user and client ip are sent in browser and the httpwebrequest.\nBut for any reason the <code>session_record.update_attributes</code> don't update/save the values.</p>\n\n<p>So it is a ruby issue which I have to investigate... no c# thingy...</p>\n\n<p>Here is a RoR inspection of the header of a browser where client_ip and username are successfully updated:</p>\n\n<pre><code>{\"SERVER_SOFTWARE\"=&gt;\"thin 1.2.11 codename Bat-Shit Crazy\", \"SERVER_NAME\"=&gt;\"thorx64\", \"rack.input\"=&gt;#&lt;StringIO:0x9f4db08&gt;, \"rack.version\"=&gt;[1, 0], \"rack.errors\"=&gt;#&lt;IO:&lt;STDERR&gt;&gt;, \"rack.multithread\"=&gt;false, \"rack.multiprocess\"=&gt;false, \"rack.run_once\"=&gt;false, \"REQUEST_METHOD\"=&gt;\"GET\", \"REQUEST_PATH\"=&gt;\"/ror/login.json\", \"PATH_INFO\"=&gt;\"/login.json\", \"REQUEST_URI\"=&gt;\"/ror/login.json\", \"HTTP_VERSION\"=&gt;\"HTTP/1.1\", \"HTTP_HOST\"=&gt;\"thorx64\", \"HTTP_ACCEPT\"=&gt;\"image/jpeg, image/gif, image/pjpeg, application/x-ms-application, application/xaml+xml, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*\", \"HTTP_ACCEPT_LANGUAGE\"=&gt;\"de-DE\", \"HTTP_USER_AGENT\"=&gt;\"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET4.0C; .NET4.0E; .NET CLR 3.5.30729; .NET CLR 3.0.30729)\", \"HTTP_ACCEPT_ENCODING\"=&gt;\"gzip, deflate\", \"HTTP_AUTHORIZATION\"=&gt;\"NTLM TlRMTVNTUAADAAAAAAAAAFgAAAAAAAAAWAAAAAAAAABYAAAAAAAAAFgAAAAAAAAAWAAAAAAAAABYAAAABcKIogYBsR0AAAAPB3e6Q1YIzZ10PiKm2g/S6A==\", \"HTTP_COOKIE\"=&gt;\"user=Administrator\", \"HTTP_X_ISRW_PROXY_AUTH_USER\"=&gt;\"Administrator\", \"HTTP_MAX_FORWARDS\"=&gt;\"10\", \"HTTP_X_FORWARDED_FOR\"=&gt;\"192.168.14.21\", \"HTTP_X_FORWARDED_HOST\"=&gt;\"thorx64\", \"HTTP_X_FORWARDED_SERVER\"=&gt;\"thorx64\", \"HTTP_CONNECTION\"=&gt;\"Keep-Alive\", \"GATEWAY_INTERFACE\"=&gt;\"CGI/1.2\", \"SERVER_PORT\"=&gt;\"80\", \"QUERY_STRING\"=&gt;\"\", \"SERVER_PROTOCOL\"=&gt;\"HTTP/1.1\", \"rack.url_scheme\"=&gt;\"http\", \"SCRIPT_NAME\"=&gt;\"/ror\", \"REMOTE_ADDR\"=&gt;\"127.0.0.1\", \"async.callback\"=&gt;#&lt;Method: Thin::Connection#post_process&gt;, \"async.close\"=&gt;#&lt;EventMachine::DefaultDeferrable:0x9f4c4d0&gt;, \"action_dispatch.parameter_filter\"=&gt;[:password], \"action_dispatch.secret_token\"=&gt;\"a1ef5e037607d12742a40a0793de973a5e68605ccf087ad1baedaee6d811687b82a0671b94da2c4a9af2b481a5346585649e83d2f56f2838a4aca8eedbfc93b7\", \"action_dispatch.show_exceptions\"=&gt;true, \"action_dispatch.remote_ip\"=&gt;127.0.0.1, \"rack.session\"=&gt;{}, \"rack.session.options\"=&gt;{:path=&gt;\"/\", :domain=&gt;nil, :expire_after=&gt;nil, :secure=&gt;false, :httponly=&gt;true, :id=&gt;nil}, \"rack.request.cookie_string\"=&gt;\"user=Administrator\", \"rack.request.cookie_hash\"=&gt;{\"user\"=&gt;\"Administrator\"}, \"action_dispatch.request.path_parameters\"=&gt;{:controller=&gt;\"login\", :action=&gt;\"index\", :format=&gt;\"json\"}, \"action_controller.instance\"=&gt;#&lt;LoginController:0xb6d59a0 @action_has_layout=true, @view_context_class=nil, @_headers={\"Content-Type\"=&gt;\"text/html\"}, @_status=200, @_response=#&lt;ActionDispatch::Response:0xb6d5760 @writer=#&lt;Proc:0xb6d54f0@D:/Informer/ruby/lib/ruby/gems/1.9.1/gems/actionpack-3.0.10/lib/action_dispatch/http/response.rb:43 (lambda)&gt;, @block=nil, @length=0, @header={}, @status=200, @body=[], @cookie=[], @sending_file=false, @blank=false, @cache_control={}, @etag=nil, @request=#&lt;ActionDispatch::Request:0xb6d5778 @env={...}, @request_method=\"GET\", @filtered_parameters={\"controller\"=&gt;\"login\", \"action\"=&gt;\"index\", \"format\"=&gt;\"json\"}, @method=\"GET\", @fullpath=\"/ror/login.json\"&gt;&gt;, @_request=#&lt;ActionDispatch::Request:0xb6d5778 @env={...}, @request_method=\"GET\", @filtered_parameters={\"controller\"=&gt;\"login\", \"action\"=&gt;\"index\", \"format\"=&gt;\"json\"}, @method=\"GET\", @fullpath=\"/ror/login.json\"&gt;, @_env={...}, @lookup_context=#&lt;ActionView::LookupContext:0xb6c3d60 @details_key=nil, @details={:handlers=&gt;[:erb, :rjs, :builder, :rhtml, :rxml], :formats=&gt;[:html, :text, :js, :css, :ics, :csv, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :flv, :file, :image, :auto, :sourcefile, :sourceimage, :sourceauto, :legacy, :edit], :locale=&gt;[:de, :de]}, @skip_default_locale=false, @frozen_formats=false, @view_paths=[d:/Informer/company/latest/ror/app/views, d:/Informer/company/latest/ror/vendor/plugins/will_paginate/app/views, d:/Informer/company/latest/ror/vendor/plugins/usesguid/app/views, d:/Informer/company/latest/ror/vendor/plugins/acts_as_tree/app/views]&gt;, @_action_name=\"index\", @_response_body=nil, @_config={}, @_params={\"controller\"=&gt;\"login\", \"action\"=&gt;\"index\", \"format\"=&gt;\"json\"}, @_current_user=nil&gt;, \"action_dispatch.request.content_type\"=&gt;nil, \"action_dispatch.request.request_parameters\"=&gt;{}, \"rack.request.query_string\"=&gt;\"\", \"rack.request.query_hash\"=&gt;{}, \"action_dispatch.request.query_parameters\"=&gt;{}, \"action_dispatch.request.parameters\"=&gt;{\"controller\"=&gt;\"login\", \"action\"=&gt;\"index\", \"format\"=&gt;\"json\"}, \"action_dispatch.request.formats\"=&gt;[application/json]}\n</code></pre>\n\n<p>And here from the web request where I have client_ip and username as well but the database don't get updated:</p>\n\n<pre><code>{\"SERVER_SOFTWARE\"=&gt;\"thin 1.2.11 codename Bat-Shit Crazy\", \"SERVER_NAME\"=&gt;\"thorx64\", \"rack.input\"=&gt;#&lt;StringIO:0xa3a3778&gt;, \"rack.version\"=&gt;[1, 0], \"rack.errors\"=&gt;#&lt;IO:&lt;STDERR&gt;&gt;, \"rack.multithread\"=&gt;false, \"rack.multiprocess\"=&gt;false, \"rack.run_once\"=&gt;false, \"REQUEST_METHOD\"=&gt;\"POST\", \"REQUEST_PATH\"=&gt;\"/ror/login.json\", \"PATH_INFO\"=&gt;\"/login.json\", \"REQUEST_URI\"=&gt;\"/ror/login.json\", \"HTTP_VERSION\"=&gt;\"HTTP/1.1\", \"HTTP_HOST\"=&gt;\"thorx64\", \"HTTP_ACCEPT\"=&gt;\"*/*\", \"HTTP_X_REQUESTED_WITH\"=&gt;\"XMLHttpRequest\", \"HTTP_USER_AGENT\"=&gt;\"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET4.0C; .NET4.0E; .NET CLR 3.5.30729; .NET CLR 3.0.30729)\", \"HTTP_AUTHORIZATION\"=&gt;\"NTLM TlRMTVNTUAADAAAAGAAYAH4AAACgAaABlgAAAAwADABYAAAADAAMAGQAAAAOAA4AcAAAAAAAAAA2AgAABYKIogYBsR0AAAAPGyWqqmBHFtGQTE/QMlHT7XQAcQBzAG8AZgB0AHIAYQB1AHMAYwBoAFQASABPAFIAWAA2ADQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoZP5isSr442bUTMoUknN3QEBAAAAAAAAZCgelIW2zQH2AaAgXe6DYQAAAAACAAwAVABRAFMATwBGAFQAAQAOAFQASABPAFIAWAA2ADQABAAsAGYAcgBhAC4AZwBlAHIAbQBhAG4AeQAuAHQAcQBzAG8AZgB0AC4AbgBlAHQAAwA8AFQASABPAFIAeAA2ADQALgBmAHIAYQAuAGcAZQByAG0AYQBuAHkALgB0AHEAcwBvAGYAdAAuAG4AZQB0AAUALABmAHIAYQAuAGcAZQByAG0AYQBuAHkALgB0AHEAcwBvAGYAdAAuAG4AZQB0AAcACABkKB6UhbbNAQYABAACAAAACAAwADAAAAAAAAAAAAAAAAAwAAAgXEA1/+dnAlRife8JhCuzKyRGkcsJKXvyXzrION0KdwoAEAAAAAAAAAAAAAAAAAAAAAAACQBGAEgAVABUAFAALwBUAEgATwBSAHgANgA0AC4AZgByAGEALgBnAGUAcgBtAGEAbgB5AC4AdABxAHMAbwBmAHQALgBuAGUAdAAAAAAAAAAAAAAAAAA=\", \"HTTP_X_ISRW_PROXY_AUTH_USER\"=&gt;\"rausch\", \"HTTP_MAX_FORWARDS\"=&gt;\"10\", \"HTTP_X_FORWARDED_FOR\"=&gt;\"192.168.14.21\", \"HTTP_X_FORWARDED_HOST\"=&gt;\"thorx64\", \"HTTP_X_FORWARDED_SERVER\"=&gt;\"thorx64\", \"HTTP_CONNECTION\"=&gt;\"Keep-Alive\", \"GATEWAY_INTERFACE\"=&gt;\"CGI/1.2\", \"SERVER_PORT\"=&gt;\"80\", \"QUERY_STRING\"=&gt;\"\", \"SERVER_PROTOCOL\"=&gt;\"HTTP/1.1\", \"rack.url_scheme\"=&gt;\"http\", \"SCRIPT_NAME\"=&gt;\"/ror\", \"REMOTE_ADDR\"=&gt;\"127.0.0.1\", \"async.callback\"=&gt;#&lt;Method: Thin::Connection#post_process&gt;, \"async.close\"=&gt;#&lt;EventMachine::DefaultDeferrable:0xa3a28f0&gt;, \"action_dispatch.parameter_filter\"=&gt;[:password], \"action_dispatch.secret_token\"=&gt;\"a1ef5e037607d12742a40a0793de973a5e68605ccf087ad1baedaee6d811687b82a0671b94da2c4a9af2b481a5346585649e83d2f56f2838a4aca8eedbfc93b7\", \"action_dispatch.show_exceptions\"=&gt;true, \"action_dispatch.remote_ip\"=&gt;127.0.0.1, \"rack.session\"=&gt;{}, \"rack.session.options\"=&gt;{:path=&gt;\"/\", :domain=&gt;nil, :expire_after=&gt;nil, :secure=&gt;false, :httponly=&gt;true, :id=&gt;nil}, \"rack.request.form_input\"=&gt;#&lt;StringIO:0xa3a3778&gt;, \"rack.request.form_hash\"=&gt;{}, \"rack.request.form_vars\"=&gt;\"\", \"action_dispatch.request.path_parameters\"=&gt;{:controller=&gt;\"login\", :action=&gt;\"index\", :format=&gt;\"json\"}, \"action_controller.instance\"=&gt;#&lt;LoginController:0xb9d86a0 @action_has_layout=true, @view_context_class=nil, @_headers={\"Content-Type\"=&gt;\"text/html\"}, @_status=200, @_response=#&lt;ActionDispatch::Response:0xb9d8460 @writer=#&lt;Proc:0xb9d8388@D:/Informer/ruby/lib/ruby/gems/1.9.1/gems/actionpack-3.0.10/lib/action_dispatch/http/response.rb:43 (lambda)&gt;, @block=nil, @length=0, @header={}, @status=200, @body=[], @cookie=[], @sending_file=false, @blank=false, @cache_control={}, @etag=nil, @request=#&lt;ActionDispatch::Request:0xb9d8478 @env={...}, @request_method=\"POST\", @filtered_parameters={\"controller\"=&gt;\"login\", \"action\"=&gt;\"index\", \"format\"=&gt;\"json\"}, @method=\"POST\", @fullpath=\"/ror/login.json\"&gt;&gt;, @_request=#&lt;ActionDispatch::Request:0xb9d8478 @env={...}, @request_method=\"POST\", @filtered_parameters={\"controller\"=&gt;\"login\", \"action\"=&gt;\"index\", \"format\"=&gt;\"json\"}, @method=\"POST\", @fullpath=\"/ror/login.json\"&gt;, @_env={...}, @lookup_context=#&lt;ActionView::LookupContext:0xb9d55f8 @details_key=nil, @details={:handlers=&gt;[:erb, :rjs, :builder, :rhtml, :rxml], :formats=&gt;[:html, :text, :js, :css, :ics, :csv, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :flv, :file, :image, :auto, :sourcefile, :sourceimage, :sourceauto, :legacy, :edit], :locale=&gt;[:de, :de]}, @skip_default_locale=false, @frozen_formats=false, @view_paths=[d:/Informer/company/latest/ror/app/views, d:/Informer/company/latest/ror/vendor/plugins/will_paginate/app/views, d:/Informer/company/latest/ror/vendor/plugins/usesguid/app/views, d:/Informer/company/latest/ror/vendor/plugins/acts_as_tree/app/views]&gt;, @_action_name=\"index\", @_response_body=nil, @_config={}, @_params={\"controller\"=&gt;\"login\", \"action\"=&gt;\"index\", \"format\"=&gt;\"json\"}, @_current_user=nil&gt;, \"action_dispatch.request.request_parameters\"=&gt;{}, \"rack.request.query_string\"=&gt;\"\", \"rack.request.query_hash\"=&gt;{}, \"action_dispatch.request.query_parameters\"=&gt;{}, \"action_dispatch.request.parameters\"=&gt;{\"controller\"=&gt;\"login\", \"action\"=&gt;\"index\", \"format\"=&gt;\"json\"}, \"action_dispatch.request.formats\"=&gt;[application/json], \"rack.session.record\"=&gt;#&lt;ActiveRecord::SessionStore::Session id: nil, session_id: \"14e03319c61b707318dd50066340be95\", client_ip: nil, username: nil, data: nil, created_at: nil, updated_at: nil&gt;, \"action_dispatch.request.flash_hash\"=&gt;nil}\n</code></pre>\n"},{"tags":["ruby-on-rails","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13112587,"title":"Rails/PG::ERROR - ActiveRecord::InvalidForeignKey: PG::Error: ERROR","body":"<p>On my other computer, I try to create a driver on a unit object, and I get this:</p>\n\n<pre><code>1.9.3p0 :003 &gt; @unit.drivers.create(:drivers_number =&gt; 1, :first_name =&gt; 'a', :last_name =&gt; 'b', :driver_license =&gt; 'a', :unit_id =&gt; 1111)\n   (0.2ms)  BEGIN\n  SQL (1.6ms)  INSERT INTO \"drivers\" (\"created_at\", \"date_of_birth\", \"driver_license\", \"driver_picture\", \"drivers_number\", \"first_name\", \"last_name\", \"unit_id\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING \"id\"  [[\"created_at\", Fri, 26 Oct 2012 20:28:24 UTC +00:00], [\"date_of_birth\", nil], [\"driver_license\", \"a\"], [\"driver_picture\", nil], [\"drivers_number\", 1], [\"first_name\", \"a\"], [\"last_name\", \"b\"], [\"unit_id\", 1111], [\"updated_at\", Fri, 26 Oct 2012 20:28:24 UTC +00:00]]\n   (0.2ms)  ROLLBACK\nActiveRecord::InvalidForeignKey: PG::Error: ERROR:  insert or update on table \"drivers\" violates foreign key constraint \"drivers_driver_id_fkey\"\nDETAIL:  Key (drivers_number)=(1) is not present in table \"drivers\".\n: INSERT INTO \"drivers\" (\"created_at\", \"date_of_birth\", \"driver_license\", \"driver_picture\", \"drivers_number\", \"first_name\", \"last_name\", \"unit_id\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING \"id\"\n</code></pre>\n\n<p>Initially drivers_number was named driver_id, but I changed it, because I thought maybe it would get confused and think its some kind of self-referential relationship. So I created another migration and renamed it to drivers_number. But problem still persists.</p>\n\n<p>Now I go home and run a migration on my other computer with and it works fine. So I am not sure why it continues to throw this error.</p>\n"},{"tags":["ruby-on-rails","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13206927,"title":"Didn't understand why we use Cucumber? Give me an example where it'll be useful?","body":"<p>Can i use only Cucumber(without Rspec and Webrat) in a rails application? Why exactly we use cucumber in rails?</p>\n"},{"tags":["ruby-on-rails","security","recaptcha","spam"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13186472,"title":"Security issue: bypassing reCaptcha in Rails 3.1","body":"<p>I don't understand how they succeed to post so much spam even though I have recaptcha working (if verify_recaptcha...) Here's what I have in controller:</p>\n\n<pre><code>def create\n    @comment = Comment.new(params[:comment])\n\n    respond_to do |format|\n      if verify_recaptcha(:model =&gt; @post, :message =&gt; \"Oh! There's a problem with reCAPTCHA's input!\")\n        if @comment.save\n          #flash[:submit_notice] = 'Comment was successfully created.'\n          Notifications.comment_notification(@comment).deliver\n          format.html { redirect_to(:back) }\n        else\n          format.html { redirect_to(@comment) }\n        end\n      end\n    end\n  end\n</code></pre>\n\n<p>And here's what I see in production.log:</p>\n\n<pre><code>Started POST \"/en/comments\" for 199.15.234.180 at 2012-11-01 19:50:48 +0200\nProcessing by CommentsController#create as */*\n  Parameters: {\"utf8\"=&gt;\"&amp;#x2713;\", \"authenticity_token\"=&gt;\"yFrJyx7EPCG9d29+PEbkNOHlUpuyXIVSy5acGNOO0mU=\", \"comment\"=&gt;{\"pos.....\n</code></pre>\n\n<p>Spam HTML follows. To my understanding, \"as */*\" is not HTML, which is a \"normal\" POST request. So I'm guessing the problem is somewhere there. Tried to google for */* didn't find anything. So what the heck is that?</p>\n\n<p><strong>UPDATE: [SOLVED]</strong></p>\n\n<p>It looks like not an issue, just someone who's bored persistently posts SPAM comments and solves reCaptchas (or maybe machine learning has advanced so far?). Probably Mollom is the next thing to add there :)</p>\n"},{"tags":["ruby-on-rails","linkedin"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13019106,"title":"Pengwynn LinkedIn Gem : How to follow a company","body":"<p>I am using pengwynn linkedIn gem in my rails project. How do I follow a company given the company id.\nI have written the following code, but it is not working.</p>\n\n<pre><code>client = LinkedIn::Client.new('consumer_key', 'consumer_secret')\n\nrtoken = client.request_token.token\n\nrsecret = client.request_token.secret\n\nclient.request_token.authorize_url\n=&gt; \"https://api.linkedin.com/uas/oauth/authorize?oauth_token=&lt;generated_token&gt;\"\n\nclient.authorize_from_request(rtoken, rsecret, pin)\n\nclient.company(:id =&gt; &lt;company_id&gt;).follow\n</code></pre>\n\n<p>Any idea why it is not working or any other solution?</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","font-face","mime-types"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13204752,"title":"Chrome warning: Resource interpreted as Font but transferred with MIME type font/svg","body":"<p>I get the following warning in Chrome dev tools about a base64 encoded font which is embedded in one of the CSS files in a site I'm working on.</p>\n\n<pre><code>Resource interpreted as Font but transferred with MIME type font/svg: \"data:font/svg;charset=utf-8;base64,PD94bWwgd -- big base64 encoded string -- 2RlZnM+PC9zdmc+\"\n</code></pre>\n\n<p>In the CSS, the font is inserted like this:</p>\n\n<pre><code>@font-face {\n  font-family: 'PrintBelt';\n  src: url('data:font/svg;charset=utf-8;base64,PD94bWwgd -- big base64 encoded string -- 2RlZnM+PC9zdmc+\") format('svg'), url('data:font/ttf;charset=utf-8;base64,AAEAAAANAIAA -- other big base64 encoded string -- AAAAzLVVtw==') format('truetype');\n}\n</code></pre>\n\n<p>I've searched around and found some blog posts and SO questions which aim to explain how to fix this problem. None of them seem to deal with fonts which are embedded in the CSS however.</p>\n\n<ol>\n<li><a href=\"http://stackoverflow.com/questions/2871655/proper-mime-type-for-fonts\">Proper mime type for fonts</a></li>\n<li><a href=\"http://danhunter.co.uk/articles/3-ha-in-your-font-face\" rel=\"nofollow\">Ha! In your font-face</a></li>\n</ol>\n\n<p>What can I change in either Rails (3.2.8) or the CSS in order to silence this warning?</p>\n"},{"tags":["ruby-on-rails","query","activerecord","nested-queries"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13207082,"title":"Rails Nested Query","body":"<p>I have follow query</p>\n\n<pre><code>  notes = Note.where('notes.id IN\n  (\n    SELECT \"notes\".\"id\" FROM \"notes\" \n      WHERE \"notes\".\"circle_id\" = ?\n  )\n  OR notes.id IN \n  (\n    SELECT \"notes\".\"id\" FROM \"notes\" \n      INNER JOIN \"circles_dreams\" \n      ON \"circles_dreams\".\"dream_id\" = \"notes\".\"dream_id\" \n      WHERE \"circles_dreams\".\"circle_id\" = ? \n  )', @circle.id, @circle.id)\n</code></pre>\n\n<p>How to simplify this query? \n Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13207176,"title":"How to enable development mode or display errors in ruby on rails","body":"<p>When I browse the site I get:</p>\n\n<pre><code>We're sorry, but something went wrong.\n</code></pre>\n\n<p>as I've seen its a <code>500.html</code> file, so its some internal server error, but how can I make display those errors?</p>\n\n<p>I've tried this:</p>\n\n<p>1) putting <code>ENV['RAILS_ENV'] ||= 'development'</code>in environment.rb, but nothing happened</p>\n\n<p>2) <code>config.log_level = :any</code>, then looked at the production.log, but there is not 500 errors</p>\n\n<p>Or what I need to write in the 500.html to see errors?, or just display it no matter how.</p>\n"},{"tags":["ruby-on-rails","amazon-ec2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13207509,"title":"Ruby Gems Not Installing on Amazon EC2","body":"<p>I have an amazon ec2 server running and I want to install ruby on rails on it. But when I type  <code>sudo gem install rails</code>, it doesn't work. It keeps waiting. I waited for 30 min. trying to see what was wrong. This is what I got after typing in <code>sudo gem install rails -V</code>:</p>\n\n<pre><code>GET http://rubygems.org/latest_specs.4.8.gz\n302 Moved Temporarily\nGET http://production.s3.rubygems.org/latest_specs.4.8.gz\n304 Not Modified\nGET http://rubygems.org/specs.4.8.gz\n302 Moved Temporarily\nGET http://production.s3.rubygems.org/specs.4.8.gz\n304 Not Modified\nGET http://rubygems.org/quick/Marshal.4.8/rack-test-0.6.1.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rack-test-0.6.1.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rack-test-0.6.2.gemspec.rz\n302 Moved Temporarily\nGET http://bb-m.rubygems.org/quick/Marshal.4.8/rack-test-0.6.2.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/journey-1.0.4.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/journey-1.0.4.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/sprockets-2.1.3.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/sprockets-2.1.3.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/erubis-2.7.0.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/erubis-2.7.0.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/arel-3.0.2.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/arel-3.0.2.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/tzinfo-0.3.29.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/tzinfo-0.3.29.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/tzinfo-0.3.30.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/tzinfo-0.3.30.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/tzinfo-0.3.31.gemspec.rz\n302 Moved Temporarily\nGET http://bb-m.rubygems.org/quick/Marshal.4.8/tzinfo-0.3.31.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/tzinfo-0.3.32.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/tzinfo-0.3.32.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/tzinfo-0.3.33.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/tzinfo-0.3.33.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/tzinfo-0.3.34.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/tzinfo-0.3.34.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/mail-2.4.4.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/mail-2.4.4.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rake-0.9.2.2.gemspec.rz\n302 Moved Temporarily\nGET http://bb-m.rubygems.org/quick/Marshal.4.8/rake-0.9.2.2.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rack-ssl-1.3.2.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rack-ssl-1.3.2.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/thor-0.14.6.gemspec.rz\n302 Moved Temporarily\nGET http://bb-m.rubygems.org/quick/Marshal.4.8/thor-0.14.6.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/thor-0.15.0.gemspec.rz\n302 Moved Temporarily\nGET http://bb-m.rubygems.org/quick/Marshal.4.8/thor-0.15.0.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/thor-0.15.1.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/thor-0.15.1.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/thor-0.15.2.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/thor-0.15.2.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/thor-0.15.3.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/thor-0.15.3.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/thor-0.15.4.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/thor-0.15.4.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/thor-0.16.0.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/thor-0.16.0.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.4.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.4.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.5.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.5.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.5.1.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.5.1.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.5.2.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.5.2.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.5.3.gemspec.rz\n302 Moved Temporarily\nGET http://bb-m.rubygems.org/quick/Marshal.4.8/rdoc-3.5.3.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.6.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.6.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.6.1.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.6.1.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.7.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.7.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.8.gemspec.rz\n302 Moved Temporarily\nGET http://bb-m.rubygems.org/quick/Marshal.4.8/rdoc-3.8.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.9.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.9.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.9.1.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.9.1.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.9.2.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.9.2.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.9.3.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.9.3.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.9.4.gemspec.rz\n302 Moved Temporarily\nGET http://bb-m.rubygems.org/quick/Marshal.4.8/rdoc-3.9.4.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.10.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.10.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.11.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.11.gemspec.rz\n200 OK\nGET http://rubygems.org/quick/Marshal.4.8/rdoc-3.12.gemspec.rz\n302 Moved Temporarily\nGET http://production.cf.rubygems.org/quick/Marshal.4.8/rdoc-3.12.gemspec.rz\n200 OK\n</code></pre>\n\n<p>and it kept going. How can I install ruby on rails onto my server? Thanks!</p>\n"},{"tags":["ruby-on-rails","guard","spork"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13198381,"title":"Guard launches a console, displays comments with Time - INFO. How come?","body":"<p>I set up a new Rails app today according to the advanced setup in Michael Hartl's Rails Tutorial (<a href=\"http://youtu.be/FZ-b9oZpCZY\" rel=\"nofollow\">http://youtu.be/FZ-b9oZpCZY</a> and <a href=\"http://ruby.railstutorial.org/chapters/static-pages#sec-advanced_setup\" rel=\"nofollow\">http://ruby.railstutorial.org/chapters/static-pages#sec-advanced_setup</a>). I've done this before, but, peculiarly, the output from Guard is very different.</p>\n\n<p>Firstly, whereas before, Guard would run and sit there listening for changes, on the new project, Guard runs a console. It still sits there and runs the tests when there are changes, but I wondered if anyone knew why this would be, especially as, to my knowledge, I've set this project up exactly the same as my other projects (the Gemfiles are exactly the same).</p>\n\n<p>Secondly, all the output messages are coming out with a timestamp and INFO preceding them. Again, does anyone know why this is?</p>\n\n<p>Just to illustrate, here's the output from an old project:</p>\n\n<pre><code>$ guard\nGuard uses Growl to send notifications.\nGuard is now watching at '/Users/billmurray/rails_projects/sample_app'\nStarting Spork for RSpec\nUsing RSpec\nPreloading Rails environment\nLoading Spork.prefork block...\nSpork is ready and listening on 8989!\nSpork server for RSpec successfully started\nGuard::RSpec is running, with RSpec 2!\nRunning all specs\nRunning tests with args [\"--color\", \"--failure-exit-code\", \"2\", \"--format\", \"progress\", \"--format\", \"Guard::RSpec::Formatter::NotificationRSpec\", \"--out\", \"/dev/null\", \"--require\", \"/Users/billmurray/.rvm/gems/ruby-1.9.3-p194@rails3tutorial/gems/guard-rspec-1.2.1/lib/guard/rspec/formatters/notification_rspec.rb\", \"spec\"]...\n.........\n\nFinished in 0.66338 seconds\n9 examples, 0 failures\n\nRandomized with seed 46867\n\nDone.\n</code></pre>\n\n<p>Here's the same for the new app. Note how the console fires up at the bottom.</p>\n\n<pre><code>$ guard\n14:52:42 - INFO - Guard uses Growl to send notifications.\n14:52:42 - INFO - Guard uses TerminalTitle to send notifications.\n14:52:42 - INFO - Guard is now watching at '/Users/billmurray/rails_projects/new_app'\n14:52:42 - INFO - Starting Spork for RSpec\nUsing RSpec\nPreloading Rails environment\nLoading Spork.prefork block...\nSpork is ready and listening on 8989!\n14:52:47 - INFO - Spork server for RSpec successfully started\n\n14:52:47 - INFO - Guard::RSpec is running, with RSpec 2!\n14:52:47 - INFO - Running all specs\nRunning tests with args [\"--color\", \"--failure-exit-code\", \"2\", \"--format\", \"progress\", \"--format\", \"Guard::RSpec::Formatter::NotificationRSpec\", \"--out\", \"/dev/null\", \"--require\", \"/Users/billmurray/.rvm/gems/ruby-1.9.3-p194@rails3tutorial/gems/guard-rspec-1.2.1/lib/guard/rspec/formatters/notification_rspec.rb\", \"spec\"]...\nNo examples found.\n\n\nFinished in 0.00213 seconds\n0 examples, 0 failures\n\n\nRandomized with seed 11776\n\nDone.\n\n[1] guard(main)&gt; \n</code></pre>\n\n<p>This isn't preventing the thing from running, but I was wondering what was causing it. I should probably mention that I'm using Mac OS X Mountain Lion. Any help would be greatly appreciated. Thanks!</p>\n"},{"tags":["jquery","ruby-on-rails","ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":256,"score":5,"question_id":12730754,"title":"Raw javascript rendered on back button click","body":"<p>Our team was recently presented an initially edge-case issue in which a User would be displayed raw javascript when clicking the browser's back button from a page that had some sort of javascript rendering (be it Ajax, tabs, etc.).  To re-create, we followed the following steps:</p>\n\n<ul>\n<li>Visit the users job applications index</li>\n<li>Click a button to the manage job posting page</li>\n<li>Click on a tab (using bettertabs gem)</li>\n<li>Click the browser's back button</li>\n</ul>\n\n<p>The previous steps would display:</p>\n\n<pre><code>(function() {\n\n  $(\".job_applications\").html(\"&lt;li class=\\\"job_posting_application\\\"&gt;\\n\n    ...\n    ...\n    ...\n    ...\n  );\n\n}).call(this);\n</code></pre>\n\n<p>In some hit-or-miss cases, you wouldn't need to click on a tab prior to going back to the previous page, yet it would still render the raw javascript. At the end of the day, it seems the last rendered template is being cached, which is normal and expected on the browser's part, but leads into what I believe to be a larger problem.</p>\n\n<p>The Rails Guides state in the section on <a href=\"http://guides.rubyonrails.org/layouts_and_rendering.html\"><strong>Layouts and Rendering</strong></a>, specifically regarding MIME type of the template:</p>\n\n<blockquote>\n  <p><em>By default, Rails will serve the results of a rendering operation with the MIME content-type of text/html (or application/json if you use the :json option, or application/xml for the :xml option.).</em></p>\n</blockquote>\n\n<p>Based on the Rails defaults, our controller's index action is expected to render our <code>index.html.slim</code> template. However, when making a non-remote call to that page (e.g., directly navigating to the page in the browser) while tailing the server logs, we notice that it actually renders <code>index.js.coffee</code>. Below is our controller action, and notice we are not explicitly responding to html or js formats, as we probably should considering the overlying features in this page:</p>\n\n<pre><code>def index\n  @company_id, @division_id, @job_posting_id = params[:company_id], params[:division_id], params[:job_posting_id]\n\n  # API requests are made here to instantiate @job_posting, et al.,\n  # but are not shown for brevity\n\n  authorize! :manage, @job_posting\n\n  @survey = @job_posting.survey\n  @job_applications = @job_posting.job_applications(sort_column, sort_direction)\nend\n</code></pre>\n\n<p>Given this setup, however, <code>index.html.slim</code> <em>should</em> be rendered based on Rails defaults. When adding a <code>respond_to</code> block, it seems the caching is still in effect and the controller could care less about the presence of a <code>respond_to</code> block:</p>\n\n<pre><code>def index\n  ...\n  ...\n  respond_to do |format|\n    format.html\n    format.js\n  end\nend\n</code></pre>\n\n<p>Even when explicitly, and albeit smelly, telling each format to render a different template, it seems the <code>js.coffee</code> template takes precedence over the <code>html.slim</code> template:</p>\n\n<pre><code>def index\n  ...\n  ...\n  respond_to do |format|\n    format.html { render template: \"users/job_posting_applications/index\" }\n    format.js { render template: \"users/job_posting_applications/ajax\" }\n  end\nend\n</code></pre>\n\n<p>In the above case, directly navigating to the page in the browser (in other words, not making a remote Ajax call), the server log would render <code>ajax.js.coffee</code>, even though the Rails default is html unless otherwise specified.</p>\n\n<p>All this being said, here are some other findings:</p>\n\n<pre><code>Started GET \"/users/companies/1/divisions/18/job_postings/349421/applications\" for 127.0.0.1 at 2012-10-03 19:55:26 -0400\nProcessing by Users::JobPostingApplicationsController#index as JSON\n</code></pre>\n\n<p>(<strong><em>you can reference the entire request shown above <a href=\"http://pastie.org/4905407\">in this pastie</a></em></strong>)</p>\n\n<p>Why it's processing as JSON is beyond me, considering we are not serving any JSON on this request, and have no specifications in routing for a default format of <code>:json</code> for this route.</p>\n\n<p>Additionally, when debugging the value of <code>request.format</code> within this action, it returns <code>application/json</code>.</p>\n\n<p>Another scenario that presented is within another controller (<code>users/company_admin_metrics#index</code>) that contains only an <code>index.html.slim</code> template.  When navigating to this page, the server log shows that it rendered <code>users/company_admin_metrics/index.html.slim</code> within <code>layouts/users</code>. When I create a blank js.coffee template:</p>\n\n<pre><code>$ touch app/views/users/company_admin_metrics/index.js.coffee\n</code></pre>\n\n<p>and directly navigate to that index page, the server log shows that it rendered <code>users/company_admin_metrics/index.js.coffee</code>, which further exposes a potential issue somewhere regarding template rendering precedence.</p>\n\n<p>Has anyone encountered a similar issue that may provide a potential fix for this?</p>\n\n<h2>Our stack</h2>\n\n<p>Below is a minute list of the basic players into this particular question:</p>\n\n<ul>\n<li>Rails 3.2.6</li>\n<li>Coffee-Rails 3.2.1</li>\n<li>Bettertabs 1.2.6</li>\n</ul>\n\n<p>This request depends on requests to our job posting API through a client gem that parses JSON and returns a Ruby object, but these are not coupled with this particular app in such a way that would conflict and cause <em>this</em> app to have a content-type of <code>application/json</code> for such a request as described above.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13207058,"title":"Theoretical: method_missing","body":"<p>i just start to learn rails and i can not understand that:</p>\n\n<p>In my Post controller i do not have method show (not described), but i put in my contrller that:</p>\n\n<pre><code>  def method_missing(name, *args)\n    redirect_to posts_path\n  end\n</code></pre>\n\n<p>i think if controller not find action show - he will call method_missing and after that redirect to 'index' method\nbut rails tries render view show.html.erb </p>\n\n<p>Why method missing does not catching? how i can use method_missing </p>\n"},{"tags":["ruby-on-rails","pagination","rails-routing","kaminari"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13043825,"title":"Validate page number when using Kaminari","body":"<p>I am using Kaminari to handle pagination. I recently found out that a lot of bogus request is requesting an invalid page number, such as <code>/post/page/undefined</code>. Since I am using Solr, bad page number got passed into it and cause 500 error.</p>\n\n<p>I want to be able to validate the page number, before it gets passed to the controller. So invalid page number will cause routing error instead.</p>\n\n<p>I have asked the creator of Kaminari, and <a href=\"https://github.com/amatsuda/kaminari/issues/295#issuecomment-9139568\" rel=\"nofollow\">he gave a temporary solution</a>. However I am wondering if there are cleaner ways to do this. I also don't want to include this logic in every paginable resource, as that will be not DRY at all.</p>\n\n<p>My route example:</p>\n\n<pre><code>resources :transactions do\n  get 'page/:page', :action =&gt; :index, :on =&gt; :collection\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12891790,"title":"Will returning a nil value from a block passed to Rails.cache.fetch clear it?","body":"<p>Let's suppose I have a method like this:</p>\n\n<pre><code>  def foo\n    Rails.cache.fetch(\"cache_key\", :expires_in =&gt; 60.minutes) do\n      return_something\n    end\n  end\n</code></pre>\n\n<p><code>return_something</code> sometimes returns a <code>nil</code> value. When this happens, I don't want the <code>nil</code> value to be cached for 60 minutes. Instead, the next time I call <code>foo</code>, I want the block passed to <code>fetch</code> to be executed again.</p>\n\n<p>Is <code>Rails.cache.fetch</code> working like this by default? Or do I have to implement this functionality?</p>\n\n<h1>Update (with Answer)</h1>\n\n<p>Turns out, the answer was no, at least when using Memcached.</p>\n"},{"tags":["java","ruby-on-rails","jruby","nokogiri","jrubyonrails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13206889,"title":"XmlDomParserContext.java:94:in `<init>': java.lang.NoClassDefFoundError: Could not initialize class nokogiri.internals.NokogiriHelpers","body":"<p>I am working on a jruby project, I am getting some XML PARSING error related to Nokogiri whose console log is as shown below :</p>\n\n<pre><code>&gt; XmlDomParserContext.java:94:in `&lt;init&gt;':\n&gt; java.lang.NoClassDefFoundError: Could not initialize class\n&gt; nokogiri.internals.NokogiriHelpers\n&gt;         from XmlDocument.java:317:in `newFromData'\n&gt;         from XmlDocument.java:334:in `read_memory'\n&gt;         from XmlDocument$INVOKER$s$0$0$read_memory.gen:-1:in `call'\n&gt;         from CachingCallSite.java:70:in `call'\n&gt;         from FCallManyArgsNode.java:60:in `interpret'\n&gt;         from NewlineNode.java:105:in `interpret'\n&gt;         from BlockNode.java:71:in `interpret'\n&gt;         from IfNode.java:118:in `interpret'\n&gt;         from LocalAsgnNode.java:123:in `interpret'\n&gt;         from NewlineNode.java:105:in `interpret'\n&gt;         from BlockNode.java:71:in `interpret'\n&gt;         from ASTInterpreter.java:75:in `INTERPRET_METHOD'\n&gt;         from InterpretedMethod.java:112:in `call'\n&gt;         from DefaultMethod.java:158:in `call'\n&gt;         from CachingCallSite.java:79:in `callBlock'\n&gt;         from CachingCallSite.java:85:in `call'\n&gt;         from CallManyArgsBlockPassNode.java:57:in `interpret'\n&gt;         from NewlineNode.java:105:in `interpret'\n&gt;         from ASTInterpreter.java:75:in `INTERPRET_METHOD'\n&gt;         from InterpretedMethod.java:182:in `call'\n&gt;         from DefaultMethod.java:192:in `call'\n&gt;         from CachingCallSite.java:326:in `cacheAndCall'\n&gt;         from CachingCallSite.java:170:in `call'\n&gt;         from CallOneArgNode.java:57:in `interpret'\n&gt;         from DAsgnNode.java:110:in `interpret'\n&gt;         from NewlineNode.java:105:in `interpret'\n&gt;         from BlockNode.java:71:in `interpret'\n&gt;         from RescueNode.java:226:in `executeBody'\n&gt;         from RescueNode.java:123:in `interpretWithJavaExceptions'\n&gt;         from RescueNode.java:113:in `interpret'\n&gt;         from BeginNode.java:83:in `interpret'\n&gt;         from NewlineNode.java:105:in `interpret'\n&gt;         from BlockNode.java:71:in `interpret'\n&gt;         from ASTInterpreter.java:112:in `INTERPRET_BLOCK'\n&gt;         from Interpreted19Block.java:209:in `evalBlockBody'\n&gt;         from Interpreted19Block.java:197:in `yield'\n&gt;         from Interpreted19Block.java:128:in `call'\n&gt;         from Block.java:89:in `call'\n&gt;         from RubyProc.java:261:in `call'\n&gt;         from RubyProc.java:213:in `call'\n&gt;         from Ruby.java:2873:in `tearDown'\n&gt;         from Ruby.java:2857:in `tearDown'\n&gt;         from Main.java:267:in `internalRun'\n&gt;         from Main.java:230:in `run'\n&gt;         from Main.java:214:in `run'\n&gt;         from Main.java:194:in `main'\n</code></pre>\n\n<p>jruby version is [jruby 1.7.0.RC1 (1.9.3p203) 2012-09-25 8e849de on Java HotSpot(TM) Client VM 1.6.0_37-b06 [Windows XP-x86]] </p>\n\n<p>OS : Windows XP</p>\n\n<p>Java version :\njava version \"1.6.0_37\"\nJava(TM) SE Runtime Environment (build 1.6.0_37-b06)\nJava HotSpot(TM) Client VM (build 20.12-b01, mixed mode, sharing)</p>\n\n<p>Does anyone have any idea about this issue ?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":6,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":799,"score":4,"question_id":853662,"title":"RAILS_ENV and rails 2.3.2","body":"<p>i noted that in rails 2.3.2 there is no more option to set which rails environment you are using. So i cannot just set it anymore in environment.rb? There is any other way to set it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3019,"score":1,"question_id":7526424,"title":"How to start rails server?","body":"<p>I am developing <strong>rails 2.3.2</strong> application.</p>\n\n<p>When I type the command \"<em>rails script/server</em>\"</p>\n\n<p>I got the following output instead of server starting why?</p>\n\n<pre><code>rails script/server\nUsage:\n  rails new APP_PATH [options]\n\nOptions:\n  -J, [--skip-javascript]        # Skip JavaScript files\n      [--dev]                    # Setup the application with Gemfile pointing to your Rails checkout\n      [--edge]                   # Setup the application with Gemfile pointing to Rails repository\n  -G, [--skip-git]               # Skip Git ignores and keeps\n  -m, [--template=TEMPLATE]      # Path to an application template (can be a filesystem path or URL)\n  -b, [--builder=BUILDER]        # Path to a application builder (can be a filesystem path or URL)\n      [--old-style-hash]         # Force using old style hash (:foo =&gt; 'bar') on Ruby &gt;= 1.9\n      [--skip-gemfile]           # Don't create a Gemfile\n  -d, [--database=DATABASE]      # Preconfigure for selected database (options: mysql/oracle/postgresql/sqlite3/frontbase/ibm_db/jdbcmysql/jdbcsqlite3/jdbcpostgresql/jdbc)\n                                 # Default: sqlite3\n  -O, [--skip-active-record]     # Skip Active Record files\n      [--skip-bundle]            # Don't run bundle install\n  -T, [--skip-test-unit]         # Skip Test::Unit files\n  -S, [--skip-sprockets]         # Skip Sprockets files\n  -r, [--ruby=PATH]              # Path to the Ruby binary of your choice\n                                 # Default: /home/xichen/.rvm/rubies/ruby-1.8.7-p352/bin/ruby\n  -j, [--javascript=JAVASCRIPT]  # Preconfigure for selected JavaScript library\n                                 # Default: jquery\n\nRuntime options:\n  -q, [--quiet]    # Supress status output\n  -s, [--skip]     # Skip files that already exist\n  -f, [--force]    # Overwrite files that already exist\n  -p, [--pretend]  # Run but do not make any changes\n\nRails options:\n  -h, [--help]     # Show this help message and quit\n  -v, [--version]  # Show Rails version number and quit\n\nDescription:\n    The 'rails new' command creates a new Rails application with a default\n    directory structure and configuration at the path you specify.\n\nExample:\n    rails new ~/Code/Ruby/weblog\n\n    This generates a skeletal Rails installation in ~/Code/Ruby/weblog.\n    See the README in the newly created application to get going.\n</code></pre>\n\n<p>When I type linux command \"ls\" I got the following directories and files showing:</p>\n\n<pre><code>app  Capfile  config  criptq  db  doc  features  Gemfile  Gemfile.lock  generate  lib  log  nbproject  public  Rakefile  README  script  spec  test  tmp  vendor\n</code></pre>\n\n<p>my <strong>Gemfile</strong> is:</p>\n\n<pre><code>source \"http://rubygems.org\"\n\ngem \"rails\", \"2.3.2\"\ngem \"mysql\", \"2.8.1\"\ngem \"fastercsv\"\ngem \"will_paginate\", \"2.3.16\"\ngem \"chronic\", \"0.6.4\"\ngem \"whenever\", \"0.4.1\"\ngem \"searchlogic\", \"2.4.28\"\n\ngroup :development do\n  gem \"mongrel\", \"1.1.5\"\nend\n\ngroup :test do\n  gem \"rspec\", \"1.3.2\"\n  gem \"rspec-rails\", \"1.3.4\"\n  gem \"factory_girl\", \"1.3.3\"\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","backbone.js"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":136,"score":2,"question_id":12497897,"title":"Testing JSON API in Rails 3.2 using rspec using exact PUT/POST bodies as Backbone would send","body":"<p>I'm trying to write a set of rspec tests for a JSON API written in Rails 3.2 with Backbone as the front end. The tests I'm writing are specifically for the Rails controllers.</p>\n\n<p>Now, the application itself is working fine. When a client issues a PUT request with the body:</p>\n\n<pre><code>{\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n}\n</code></pre>\n\n<p>Everything is great. In the background Rails will take that body, then transform it into:</p>\n\n<pre><code>{\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n  \"model_name\" =&gt; { ... }\n}\n</code></pre>\n\n<p>where the hash \"model_name\" points to contains the attribute values it can automatically figure out from the input. All is well.</p>\n\n<p>When I try the same exact request from the testing environment, all is not well. If I create a hash that is exactly the same PUT body hash as above, but in rspec:</p>\n\n<pre><code>@update_json = {\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n}\nheader \"Accept\",\"application/json\"\nheader \"Content-type\",\"application/json\"\nput :update, @update_json\n</code></pre>\n\n<p>Things do not work out at all. In the controller, if I inspect the params variable I get:</p>\n\n<pre><code>{ \"model_name\" =&gt; {} }\n</code></pre>\n\n<p>If I omit the \"Content-type\" header line, I get instead @update_json, but without the Rails manipulation that creates the \"model_name\" mapping which I require in my controller.</p>\n\n<p>The only way I've gotten a successful test to run is the following:</p>\n\n<pre><code>@update_json = {\n  :format =&gt; \"json\",\n  \"id\":1,\n  \"model_name\" =&gt; {\n      \"id\":1,\n      \"name\":\"updated product set\",\n      ...\n  }\n}\nheader \"Accept\",\"application/json\"\nput :update, @update_json\n</code></pre>\n\n<p>However, this is not a real-world test since it's not testing the exact PUT body that would be sent by my backbone front-end.</p>\n\n<p>Any ideas?</p>\n\n<p>UPDATE:\nFrom looking around it <em>looks</em> like you can't actually do a real HTTP request from rspec; it's just mocked up. For example, you can't get the system to respond with a 404 since Rails throws an Exception that would normally be caught by Rails network stack and turned into a 404 but which isn't with Rspec. So the problem looks deeper than what's above...</p>\n"},{"tags":["sql","ruby-on-rails","case-insensitive"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13204957,"title":"Rails / SQL: Find attributes with same value but different capitalization","body":"<p>This may be really basic, but I can't think of how to write a SQL query that would find strings that have the same characters but different capitalization.</p>\n\n<p>The context I'm working on is a Rails 3.2 app. I have a simple Tag model with a Name attribute. I've inherited data for this model that did not store values case-insensitively, so some users input things like \"Tree\" while others input \"tree\" and now we have two tags that really should be one.</p>\n\n<p>So, I'd like to do a query to find all these pairs so that I can go about merging them.</p>\n\n<p>The only thing I can think of so far is to write a rake task that loops through them all and checks for matching values... something like:</p>\n\n<pre><code>pairs = []\nTag.all.each do |t|\n  other = Tag.where( 'name LIKE ?', t.name )\n  pairs &lt;&lt; [t, other] if other\nend\n</code></pre>\n\n<p>However, I'm not sure the above would work, or that it makes sense performance-wise. Is there a better way to write a SQL query that would find these matching pairs?</p>\n"},{"tags":["ruby-on-rails","string","activerecord","floating-point","type-conversion"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13206734,"title":"RubyOnRails: Cannot convert a string to a float in my controller","body":"<p>I'm trying to make an active record that involves location. I get the longitude from the params, and try to use the <code>Float()</code> method to convert the <code>locationLongitude</code> and <code>locationLatitude</code> from a string to a float, and I get the following error:</p>\n\n<pre><code>undefined method `call' for #&lt;Class:0x007ffead288530&gt;\n</code></pre>\n\n<p>Here are the params that the method has access to: </p>\n\n<pre><code>{\"locationName\"=&gt;\"Stanford\",\n \"locationLatitude\"=&gt;\"37.42839679991957\",\n \"locationLongitude\"=&gt;\"-122.17553785073696\"}\n</code></pre>\n\n<p>And this is the method in my controller that attempts to convert the strings into floats and make the query:</p>\n\n<pre><code>def local\n  radius = 10;\n  @sort = \"local\"\n  @locationName = params[:locationName]\n  @locationLongitude = Float(params[:locationLongitude])\n  @locationLatitude = Float(params[:locationLatitude])\n  @musings = Musing.(:longitude =&gt; (Float(@locationLongitude) - radius)..(Float(@locationLongitude) + radius))\n\n end\n</code></pre>\n\n<p>Hope you can help. I also tried doing <code>params[:locationName].to_f</code> and that also didn't work. </p>\n\n<p>Thanks, Paul.</p>\n"},{"tags":["ruby-on-rails","testing","rspec","route"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":187,"score":0,"question_id":8916945,"title":"Rails pages_controller_spec.rb test shouldn't be failing but is, error?","body":"<p>Have been following Rails Tutorial by Michael Hart\nrails version 3.0 on mac OS X 10.7</p>\n\n<p>$ rspec spec/</p>\n\n<pre><code>......FF\n\nFailures:\n\n  1) PagesController GET 'help' should be successful\n     Failure/Error: get 'help'\n     ActionController::RoutingError:\n       No route matches {:controller=&gt;\"pages\", :action=&gt;\"help\"}\n     # ./spec/controllers/pages_controller_spec.rb:45:in `block (3 levels) in &lt;top (required)&gt;'\n\n  2) PagesController GET 'help' should have the right title\n     Failure/Error: get 'help'\n     ActionController::RoutingError:\n       No route matches {:controller=&gt;\"pages\", :action=&gt;\"help\"}\n     # ./spec/controllers/pages_controller_spec.rb:49:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 0.14686 seconds\n8 examples, 2 failures\n\nFailed examples:\n\nrspec ./spec/controllers/pages_controller_spec.rb:44 # PagesController GET 'help' should be successful\nrspec ./spec/controllers/pages_controller_spec.rb:48 # PagesController GET 'help' should have the right title\n</code></pre>\n\n<p>The test looks like this:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe PagesController do\n  render_views\n\n  describe \"GET 'home'\" do\n    it \"should be successful\" do\n      get 'home'\n      response.should be_success\n    end\n\n    it \"should have the right title\" do\n      get 'home'\n      response.should have_selector(\"title\",\n      :content =&gt; \"Ruby on Rails Tutorial Sample App | Home\")\n    end\n  end\n\n  describe \"GET 'contact'\" do\n    it \"should be successful\" do\n      get 'contact'\n      response.should be_success\n    end\n    it \"should have the right title\" do\n      get 'contact'\n      response.should have_selector(\"title\",\n      :content =&gt; \"Ruby on Rails Tutorial Sample App | Contact\")\n    end\n  end\n\n  describe \"GET 'about'\" do\n    it \"should be successful\" do\n      get 'about'\n      response.should be_success\n    end\n    it \"should have the right title\" do\n      get 'about'\n      response.should have_selector(\"title\",\n      :content =&gt; \"Ruby on Rails Tutorial Sample App | About\")\n    end\n  end\n\n  describe \"GET 'help'\" do\n    it \"should be successful\" do\n      get 'help'\n      response.should be_success\n    end\n    it \"should have the right title\" do\n      get 'help'\n      response.should have_selector(\"title\",\n      :content =&gt; \"Ruby on Rails Tutorial Sample App | Help\")\n    end\n  end\nend\n</code></pre>\n\n<p>And I have in pages_controller.rb</p>\n\n<pre><code>class PagesController &lt; ApplicationController\n  def home\n    @title = \"Home\"\n  end\n\n  def contact\n    @title = \"Contact\"\n  end\n\n  def about\n    @title = \"About\"\n  end\n\n  def help\n    @title = \"Help\"\n  end\n\nend\n</code></pre>\n\n<p>And in routes.rb I have</p>\n\n<pre><code>SampleApp::Application.routes.draw do\n  get \"pages/home\"\n  get \"pages/contact\"\n  get \"pages/about\"\n  get \"pages/help\"\nend\n</code></pre>\n\n<p>And of course I also created a help.html.erb page in app/views/pages\nThe strange thing is when I run rails server and go to localhost:3000/pages/help I get the proper page with the proper title, making it appear as if the test should've passed, yet it doesn't. Additionally the contact, home, and about tests pass but when I just now added the help it doesn't for some unknown reason. This is really bugging me out, what is the simple solution I have overlooked that it driving me insane?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13205839,"title":"In Ruby on rails, how to show loading image till an action completes executing?","body":"<p>I have an application, where users will be redirected to our site from a parent website. We will be getting the user's details by SAML process. Based on the details received, if the user is new user,the user will be created. So the action sessions/consume takes some time to process.Is it possible to show a loading image or any image until the action completes? So that users will not see blank screen. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13206248,"title":"Sorting table by both column and row Rails","body":"<p>Here, I want to set up a weekly planner where I will later insert plans into.</p>\n\n<p>I have the columns sorted by the days of the week.(Monday, Tuesday...)\nNow, I want the row to be sorted by the time. </p>\n\n<p>However, with my code below. For every column, it loops through the same number of times as the number of items in my time slot.</p>\n\n<p>Would appreciate it if you could give me some guidance on how I should go about fixing it such that each timeslot only appears once throughout the whole table.</p>\n\n<p>The codes</p>\n\n<pre><code>&lt;table class=\"Time Table\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;&lt;%= \"Time\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Monday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Tuesday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Wednesday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Thursday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Friday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Saturday\" %&gt;&lt;/th&gt;\n\n &lt;/tr&gt;\n  &lt;% @time_slots.each do |time_slot| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Monday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Tuesday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Wednesday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Thursday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Friday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Saturday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["ruby-on-rails","ruby","hosting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":28,"score":-2,"question_id":13206660,"title":"how to use the files: start, restart, stop, serv. in Ruby on rails","body":"<p>What mean those files:</p>\n\n<p>start, restart, stop, serv. also file typescript</p>\n\n<p>they are in ruby on rails hosting, how to use them and for what purposes they exists?</p>\n"},{"tags":["ruby-on-rails","callback","update-attributes"],"answer_count":5,"favorite_count":13,"up_vote_count":39,"down_vote_count":0,"view_count":46697,"score":39,"question_id":2778522,"title":"Rails: update_attribute vs update_attributes","body":"<pre><code>Object.update_attribute(:only_one_field, \"Some Value\")\nObject.update_attributes(:field1 =&gt; \"value\", :field2 =&gt; \"value2\", :field3 =&gt; \"value3\")\n</code></pre>\n\n<p>Both of these will update an object without having to explicitly tell AR to update.</p>\n\n<p>Rails API says:</p>\n\n<p>for update_attribute</p>\n\n<blockquote>\n  <p>Updates a single attribute and saves the record without going through the normal validation procedure. This is especially useful for boolean flags on existing records. The regular update_attribute  method in Base  is replaced with this when the validations module is mixed in, which it is by default.</p>\n</blockquote>\n\n<p>for update_attributes</p>\n\n<blockquote>\n  <p>Updates all  the attributes  from the passed-in Hash and saves the record. If the object is invalid, the saving will fail and false will be returned. </p>\n</blockquote>\n\n<p>So if I don't want to have the object validated I should use update_attribute. What if I have this update on a before_save, will it stackoverflow?</p>\n\n<p>My question is does update_attribute also bypass the before save or just the validation.</p>\n\n<p>Also, what is the correct syntax to pass a hash to update_attributes... check out my example at the top.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13190459,"title":"Formatting JSON output using map method - Rails 3","body":"<p>I'm lacking some understanding on using the map method. </p>\n\n<p>Using json output with no mapping</p>\n\n<pre><code>format.json  { render :json =&gt; @categories }\n</code></pre>\n\n<p>gives me the following output</p>\n\n<pre><code>[{\"created_at\":\"2012-10-20T01:16:35+11:00\",\"id\":1,\"name\":\"bathroom renovations\",\"updated_at\":\"2012-10-20T01:16:35+11:00\"}]\n</code></pre>\n\n<p>using json with mapping</p>\n\n<pre><code>format.json  { render :json =&gt; @categories.map(&amp;:name) }\n</code></pre>\n\n<p>gives me this output</p>\n\n<pre><code>[\"bathroom renovations\"]\n</code></pre>\n\n<p>How can I get my output to look like</p>\n\n<pre><code>[{\"id\":\"1\",\"name\":\"bathroom renovations\"}]\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","jquery-autocomplete","acts-as-taggable-on"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13199708,"title":"acts_as_taggable_on and rails autocomplete gem - displaying tag counts","body":"<p>I am using the acts_as_taggable_on gem and the rails jquery autocomplete gem</p>\n\n<p>I know how to get the tag counts via the gem</p>\n\n<p>I know that in order to display something else other than the return search results for the autocomplete I need to do something like this</p>\n\n<pre><code>autocomplete :tag, :name, :class_name =&gt; 'ActsAsTaggableOn::Tag', :full =&gt; true\n</code></pre>\n\n<p>and adding 2 more keys which are </p>\n\n<pre><code>:extra_data , :display_value\n</code></pre>\n\n<p>the extra data will retrieve the more data in the search (not sure it is needed here)\nthe display_value will call a method from within the model which is searched with the autocomplete.</p>\n\n<p><strong>The problem:</strong></p>\n\n<p>I don't know where to put the method for the display_value which should be something like</p>\n\n<pre><code>def tags_with_counts\n \"#{tag.name} x #{tag.count}\nend\n</code></pre>\n\n<p>As I don't have a tag model file to put it in (since the acts_as_taggable_on does not generate such file.</p>\n\n<p>But even if I did have such file, from previous experiments, that method can only use data that is retrieved with the autocomplete search, and I don't have a column with tag counts.</p>\n\n<p>What do I do to solve this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":10,"favorite_count":23,"up_vote_count":51,"down_vote_count":0,"view_count":18809,"score":51,"question_id":5968131,"title":"Upgrading from Rails 3 to Rails 3.1","body":"<p>How do you upgrade from Rails 3 to Rails 3.1 beta?</p>\n"},{"tags":["ruby-on-rails","actionmailer","ruby-on-rails-2","thunderbird"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13206306,"title":"Rails 2 plain text mail showing wrong indentation/format in Thunderbird","body":"<p>I am using rails 2.3 and want to send multipart plain/html emails. The html emails gets delivered in proper format, but the text emails shows wrong format sometimes.\nThis is my notifier method:</p>\n\n<pre><code>part :content_type =&gt; 'multipart/alternative' do |copy|\n      copy.part :content_type =&gt; 'text/plain' do |plain|\n        plain.body = render( :file =&gt; \"file.text.plain.erb\",  :body =&gt; @body )\n        plain.transfer_encoding = \"base64\"\n</code></pre>\n\n<p>Expected Output:-</p>\n\n<blockquote>\n  <p>Hi user,</p>\n  \n  <p>Welcome to your shop. </p>\n  \n  <hr>\n  \n  <p>Our customer service team will be at your service right after a moment.</p>\n  \n  <p>Your plan activated is Demo.</p>\n  \n  <hr>\n  \n  <p>In case of any difficulty, feel free to contact us.</p>\n  \n  <hr>\n  \n  <p>www.exampleshop.com</p>\n</blockquote>\n\n<p>This output comes fine in gmail, yahoomail and other web mail services.</p>\n\n<p>But sometimes it comes garbled in mail clients such as Thunderbird , Outlook and Evolution in this way:-</p>\n\n<blockquote>\n  <p>Hi user,</p>\n  \n  <p>Welcome to your shop. \n   ------------------------ Our customer service team will be at your service right after a moment.</p>\n  \n  <p>Your plan activated is Demo. ---------------------------</p>\n  \n  <p>In case of any difficulty, feel free to contact us. ----------------------------------------------------- www.exampleshop.com</p>\n</blockquote>\n\n<p>I have <code>ActionMailer::Base.default_charset = \"utf-8\"</code></p>\n\n<p>Also could this be an encoding issue?</p>\n\n<p>Kindly suggest.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":818,"score":1,"question_id":5629309,"title":"Passing virtual attribute values through to form elements in Rails 3","body":"<p>I have the following in my model:</p>\n\n<blockquote>\n  <p>before_validation :update_temp</p>\n  \n  <p>attr_accessor :temp_int, :temp_dec</p>\n  \n  <p>def update_temp</p>\n  \n  <blockquote>\n    <p>self.temp = temp_int.to_f + (temp_dec.to_f / 10)</p>\n  </blockquote>\n  \n  <p>end</p>\n</blockquote>\n\n<p>And I have the following in my view:</p>\n\n<blockquote>\n  <p>&lt;%= f.select(:temp_int, [\"97\", \"98\"], { :include_blank => true })%> . </p>\n  \n  <p>&lt;%= f.select(:temp_dec, [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"], { :include_blank => true })%></p>\n</blockquote>\n\n<p>This works great for saving the temperature values. However, there's one issue. Normally on the edit screen, the select helper would have the existing values pre-selected. But using the virtual attributes this isn't happening.</p>\n\n<p>How do I make sure that the temp_int and temp_dec values get passed to the view?</p>\n"},{"tags":["ruby-on-rails","mongoid","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":108,"score":2,"question_id":12379890,"title":"is not a recognized storage provider (Mongoid, Carrierwave and S3","body":"<p>i'm using Carrierwave with mongoid support</p>\n\n<pre><code>gem \"carrierwave-mongoid\", :git =&gt; \"git://github.com/jnicklas/carrierwave-mongoid.git\", :branch =&gt; \"mongoid-3.0\",:require =&gt; 'carrierwave/mongoid'\n</code></pre>\n\n<p>I config carrierwave to use Fog storage with AWS (S3)</p>\n\n<pre><code># config/initializers/carrierwave.rb\nCarrierWave.configure do |config|\n    config.storage = :fog\n    config.root = Rails.root.join('tmp') # adding these...\n    config.cache_dir = 'carrierwave' # ...two lines\n    config.fog_credentials = {\n        :provider =&gt; 'AWS',\n        :aws_access_key_id =&gt; '',\n        :aws_secret_access_key =&gt; ''\n    },\n    config.fog_directory = 'alzheimer'\nend\n</code></pre>\n\n<p>I have a class called Picture to use with the Uploader and the uploader</p>\n\n<pre><code>class ImagenUploader &lt; CarrierWave::Uploader::Base\n    include CarrierWave::MimeTypes\n    include CarrierWave::RMagick\n    storage :fog\n    process :set_content_type\n    process :convert =&gt; 'png'\n    def filename\n        super.chomp(File.extname(super))+'.png'\n    end\n    version :thumb do\n        process :resize_to_fit =&gt; [24,24]\n    end\nend\n</code></pre>\n\n<p>And my Picture Model\n    class Picture\n         include Mongoid::Document\n         include Mongoid::Timestamps\n         include Mongoid::Paranoia\n         belongs_to :user</p>\n\n<pre><code>     field :descripcion, :type =&gt; String\n     field :titulo, :type =&gt; String\n     field :imagen, :type =&gt; String\n\n     attr_accessible :imagen, :imagen_cache, :descripcion, :titulo\n     mount_uploader :imagen, ImagenUploader\n end\n</code></pre>\n\n<p>I try to upload an image, ad i get:</p>\n\n<pre><code>ArgumentError: is not a recognized storage provider\nfrom /Users/msdark/.rvm/gems/ruby-1.9.3-p194/gems/fog-1.5.0/lib/fog/storage.rb:33:in new'\nfrom /Users/msdark/.rvm/gems/ruby-1.9.3-p194/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:106:inconnection'\n</code></pre>\n\n<p>I use rails 3.2.8\nruby 1.9.3p194\nand unicorn (4.3.1)</p>\n\n<p>The error shows up after upload when try to show this:</p>\n\n<pre><code>image_tag(picture.imagen_url)\n</code></pre>\n\n<p>Any idea?</p>\n\n<p>EDITED:</p>\n\n<p>Gemfile\n    source 'https://rubygems.org'\n    gem 'rails', '3.2.8'\n    group :assets do\n       gem 'sass-rails',   '~> 3.2.3'\n       gem 'coffee-rails', '~> 3.2.1'\n       gem 'therubyracer', :platform => :ruby\n       gem 'uglifier', '>= 1.0.3'\n       gem 'jquery-rails'\n       gem 'jquery-ui-rails'\n       gem 'less-rails-bootstrap'\n    end</p>\n\n<pre><code>gem 'unicorn'\ngem 'heroku'\ngem 'foreman'\n\ngem 'i18n'\ngem 'formtastic'\ngem \"activeadmin-mongoid\",  git: \"git://github.com/elia/activeadmin-mongoid.git\"\ngem 'mongoid'\ngem 'bson_ext'\ngem 'devise'\ngem 'devise-i18n'\ngem 'omniauth'\ngem 'omniauth-twitter'\ngem 'omniauth-facebook'\n\ngem \"carrierwave-mongoid\", :git =&gt; \"git://github.com/jnicklas/carrierwave-mongoid.git\", :branch =&gt; \"mongoid-3.0\", :require =&gt; 'carrierwave/mongoid'\ngem 'mini_magick', :git =&gt; 'git://github.com/probablycorey/mini_magick.git'\n\ngem 'recaptcha',            :require =&gt; 'recaptcha/rails'\ngem 'googlecharts'\n\ngroup :test do \ngem 'capybara'\ngem 'database_cleaner'\ngem 'mongoid-rspec'\ngem 'launchy'\ngem 'factory_girl_rails'\ngem 'mongoid-rspec'\ngem 'faker'\nend \ngem 'rspec-rails',:group =&gt;[:development,:test]\n</code></pre>\n"},{"tags":["ruby-on-rails","capistrano"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13199716,"title":"From manual pull on server to Capistrano","body":"<p>I've always deployed my apps through SSH by manually logging in and running <code>git pull origin master</code>, running migrations and pre-compiling assets.</p>\n\n<p>Now i started to get more interested in Capistrano so i gave it a try, i setup a recipe with the repository pointing to github and <code>deploy_to</code> to <code>/home/myusername/apps/greatapp</code></p>\n\n<p>The current app on the server is already hooked up with Git too so i didn't know why i had to specify the github url in the recipe again, but i ran <code>cap deploy</code> which was successful.</p>\n\n<p>The changes didn't apply, so out of curiosity i browsed to the app folder on the server and found out that Capistrano created folders: <code>shared</code>, <code>releases</code> and <code>current</code>. the latter contained the app, so now i have 2 copies one in <code>/home/myusername/apps/greatapp</code> and another in <code>/home/myusername/apps/greatapp/current</code>.</p>\n\n<ol>\n<li><p>Is this how it should be? and I have to migrate user uploads to <code>current</code> and destroy the old app?</p></li>\n<li><p>Does Capistrano pull the repo on my localhost then upload it through SSH or run <code>pull</code> on the server? in other words can someone outline how the deployment works?</p></li>\n<li><p>Does Capistrano run <code>precompile:assets</code>?</p></li>\n</ol>\n"},{"tags":["ruby-on-rails","http-status-code-404","http-status-code-500","custom-error-pages"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13200001,"title":"Rails 3.0.15 Custom 404 and 500","body":"<p>I've seen many questions about custom error views for Rails, but haven't found a solution for my problem yet!</p>\n\n<p>For 404, right now my routes.rb has a catch-all at the bottom to redirect unknown named routes e.g. \"webroot/adsfsdfasdf/\", but it fails for invalid id e.g \"webroot/people/x1df1231\" - ActiveRecord::RecordNotFound (Couldn't find Person with ID=x1df1231)</p>\n\n<p>For 500, I haven't found a solution yet.</p>\n\n<p>I can't upgrade Rails at the moment, </p>\n"},{"tags":["ruby-on-rails","ruby","search","solr","sunspot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13200501,"title":"Ruby Sunspot Keyword search with IDs","body":"<p>Simple question:</p>\n\n<p>I've got two models: <code>Show</code> and <code>Contact</code>.  What I'd like to do is search for either a <code>Show#id</code> or a <code>Contact#name</code>. So my models are set up as follows:</p>\n\n<pre><code>class Show &lt; ActiveRecord::Base\n\n  searchable do\n    text :id\n  end\nend\n\nclass Contact &lt; ActiveRecord::Base\n\n  searchable do\n    text :name\n  end\n end\n</code></pre>\n\n<p>Then I run searches as follows: </p>\n\n<pre><code>Sunspot.search(Contact, Show) do\n  keywords(MY_QUERY)\nend\n</code></pre>\n\n<p>This works great for finding Contacts by their name, but never works with the <code>Show#id</code> field.  Can anyone explain why this is?</p>\n\n<p>Joe</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","http","http-headers","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13205814,"title":"How to make a DELETE link to a rails resource?","body":"<p>If I want to make a DELETE link in rails, I write the following code (in this example case to delete a user session in Devise):</p>\n\n<pre><code>&lt;%= link_to('Logout', destroy_user_session_path, :method =&gt; :delete) %&gt;\n</code></pre>\n\n<p>That will turn into the following HTML:</p>\n\n<pre><code>&lt;a rel=\"nofollow\" data-method=\"delete\" href=\"/users/sign_out\"&gt;Logout&lt;/a&gt;\n</code></pre>\n\n<p>Works great, except I can't simply put that HTML into a static HTML page. It will simply do a GET request. I assume Rails includes some standard Javascript to turn the above link to one that actually does a DELETE request. So what's the proper way to have a link on a static HTML page to a Rails resource that does a DELETE action? Should I find and grab that Javascript Rails includes in all webpages that does this? Is there a better way?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13201522,"title":"Best way to duplicate parent and associated child records in Ruby on Rails?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6711956/activerecord-how-can-i-clone-nested-associations\">ActiveRecord: How can I clone nested associations?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a table with <code>invoices</code> which in turn can have many <code>items</code>.</p>\n\n<p>Now in my <code>invoices</code> index view I would like to place a link next to each <code>invoice</code> saying <em>Duplicate Invoice</em>.</p>\n\n<p>Without the child records this would be quite easy:</p>\n\n<pre><code>&lt;%= link_to \"Duplicate\", new_invoice_path(invoice.attributes) %&gt;\n</code></pre>\n\n<p>But how can this be done if the invoice's <code>items</code> should be duplicated as well?</p>\n\n<p>As a Rails newbie I can't get my head around this. Can all this be handled by the <code>new</code> action inside my controller?</p>\n\n<pre><code>def new\n  @invoice = current_user.invoices.build(:project_id =&gt; params[:project_id])\n  @title = \"New invoice\"\nend\n</code></pre>\n\n<p>Or do I need to create another function named e.g. <code>copy</code> inside my controller?</p>\n\n<p>What is the best practice?</p>\n\n<p>Thanks for any input...</p>\n"},{"tags":["ruby-on-rails","ruby","json","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":337,"score":3,"question_id":6640076,"title":"ActiveRecord: Produce multi-line human-friendly json","body":"<p>Using ActiveRecord::Base.to_json I do:</p>\n\n<pre><code>user = User.find_by_name 'Mika'\n\n{\"created_at\":\"2011-07-10T11:30:49+03:00\",\"id\":5,\"is_deleted\":null,\"name\":\"Mika\"}\n</code></pre>\n\n<p>Now, what I would like to have is:</p>\n\n<pre><code>{\n    \"created_at\":\"2011-07-10T11:30:49+03:00\",\n    \"id\":5,\n    \"is_deleted\":null,\n    \"name\":\"Mika\"\n}\n</code></pre>\n\n<p>Is there an option to do this?</p>\n\n<p>It would be great to have a global option, so that the behaviour be set depending on dev/live environment.</p>\n"},{"tags":["ruby-on-rails","validation","datetime","rspec","rspec-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":66,"score":5,"question_id":13138208,"title":"Testing that rails model validates date with RSpec","body":"<p>I'm a bit new to Rails and Rspec and as such I'm not sure how to test that date time validations are correct in my model.\nI've made a model Event that has start and end times and there's a few imporant conditions on these such as a start time cannot be in the past and the end time must be after the start time. </p>\n\n<p>To ensure these validations I'm using ValidatesTimeliness <a href=\"https://github.com/adzap/validates_timeliness\">https://github.com/adzap/validates_timeliness</a></p>\n\n<p>My model is as follows:</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  ...\n\n  validates_datetime :start_date,\n    :after =&gt; :now,\n    :after_message =&gt; \"Event cannot start in the past\"\n\n  validates_datetime :end_date,\n    :after =&gt; :start_date,\n    :after_message =&gt; \"End time cannot be before start time\"\nend\n</code></pre>\n\n<p>In my RSpec test I have:</p>\n\n<pre><code>describe Event do\n  let(:event) { FactoryGirl.build :event }\n  subject { event }\n\n  context \"when start_date is before the current time\" do\n    it {should_not allow_value(1.day.ago).\n        for(:start_date)}\n  end\n\n  context \"when end_date is before or on start date\" do\n    it {should_not allow_value(event.start_date - 1.day).\n        for(:end_date)}\n\n    it {should_not allow_value(event.start_date).\n        for(:end_date)}\n  end\n\n  context \"when the end_date is after the start_date\" do\n    it {should allow_value(event.start_date + 1.day).\n        for(:end_date)}\n  end\nend\n</code></pre>\n\n<p>However this doesn't really test that my start date had to be before the exact date time. \nFor example if I'd accidentally used <code>:today</code> instead of <code>:now</code> in my model, these tests would also pass.</p>\n\n<p>I read online that there used to be an RSpec matcher called <code>validate_date</code> (<a href=\"http://www.railslodge.com/plugins/1160-validates-timeliness\">http://www.railslodge.com/plugins/1160-validates-timeliness</a>) which would be exactly what I'm looking for but as far as I can tell it's been removed.</p>\n\n<p>My question is how can I improve my tests, do I need to add tests that try the smallest amount of time (i.e. a ms) to ensure the pass/fail accordingly or is there a better way to do it?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13202585,"title":"ticket booking engine rails","body":"<p>Im trying o set up an rails application that handles ticket booking system for e venue.\nDoes anybody have any suggestions about architecture, gems or general approach yhat could help? Would be grateful for suggestions.</p>\n"},{"tags":["ruby-on-rails","ruby","design","database-design","architecture"],"answer_count":3,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":664,"score":1,"question_id":5346839,"title":"Modelling indefinitely-recurring tasks in a schedule (calendar-like rails app)","body":"<p>This has been quite a stumbling block. Warning: the following is not a question, rather explanation of what I came up with. My question is — do you have a better way to do this? Is there some common technique for this that I'm not familiar with? Seems like this is a trivial problem.</p>\n\n<p>So you have Task model. You can create tasks, complete them, destroy them. Then you have recurring tasks. It's just like regular task, but it has a recurrence rule attached to it. However, tasks can recur indefinitely — you can go a year ahead in the schedule, and you should see the task show up.</p>\n\n<p>So when a user creates a recurring task, you don't want to build thousands of tasks for hundred years into the future, and save them to database, right? So I started thinking — how do you create them?</p>\n\n<p>One way would be to create them as you view your schedule. So, when the user is moving a month ahead, any recurring tasks will be created. Of course that means that you can't simply work with database records of tasks any longer. Every SELECT operation on tasks you ever do has to be in the context of a particular date range, in order to trigger recurring tasks in that date range to persist. This is a maintenance and performance burden, but doable.</p>\n\n<p>Alright, but how about the original task? Every recurrent task gets associated with the recurrence rule that created it, and every recurrence rule needs to know the original task that started the recurrence. The latter is important, because you need to clone the original task into new dates as the user browses their schedule. I guess doable too.</p>\n\n<p>But what happens if the original task is updated? It means that now as we browse the schedule, we will be creating recurring tasks cloned off of the modified task. That's undesirable. All the implicitly persisted recurring tasks should show up the way the original task looked like when recurrence was added. So we need to store a copy of the original task separately, and clone from that, in order for recurrence to work.</p>\n\n<p>However, when the user navigates the tasks in the schedule, how do we know if at a particular point a new recurrence task needs to be created? We ask recurrence rule: \"hey, should I persist a task for this day?\" and it says yes or no. If there is already a task for this recurrence for this day, we don't create one. All nice, except a user shall also be able to simply delete one of the recurring tasks that has been automatically persisted. In that case following our logic, the system will re-create the task that has been deleted. Not good. So it means we need to keep storing the task, but mark it as deleted task for this recurrence. Meh.</p>\n\n<p>As I said in the beginning, I want to know if somebody else tackled this problem and can provide architectural advice here. Does it have to be this messy? Is there anything more elegant I'm missing?</p>\n\n<p><strong>Update</strong>: Since this question is hard to answer perfectly, I will approve the most helpful insight into design/architecture, which has the best helpfulness/trade-offs ratio for this type of problem. It does not have to encompass all the details.</p>\n"},{"tags":["ruby-on-rails","railstutorial.org"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":29,"score":3,"question_id":13204965,"title":"Rspec expected link_to not finding anything","body":"<p>![enter image description here][1]I have been reading up on the RoR tutorial book by Michael Hartl and I'm stuck with 7 fails on Rspec.  I have been looking 3 hours to find the error but I just can't find it.  the errors says that I don't have a link_to Sign out(one from users pages and one from edit page), link_to change, and a bunch of have_selector errors.  Here is the rspec user_pages_spec.rb.  I am almost positive the edit.html.erb and header.html are fine, but if no one sees anything wrong with this rspec than ill post it up</p>\n\n<pre><code> describe \"edit\" do\n    let(:user) { FactoryGirl.create(:user) }\n    before do\n        sign_in user\n        visit edit_user_path(user)\n    end\n\n    describe \"page\" do\n        it { should have_selector('h1',    text: \"Update your profile\") }\n        it { should have_selector('title', text: \"Edit user\") }\n        it { should have_link('change', href: 'http://gravatar.com/emails') }\n    end\n\n    describe \"with valid information\" do\n        let(:new_name) { \"New Name\" }\n        let(:new_email) { \"new@example.com\" }\n        before do\n            fill_in \"Name\",             with: new_name\n            fill_in \"Email\",            with: new_email\n            fill_in \"Password\",         with: user.password\n            fill_in \"Confirm Password\", with: user.password\n            click_button \"Save changes\"\n        end\n\n        it { should have_selector('title', text: new_name) }\n        it { should have_selector('div.alert.alert-success') }\n        it { should have_link('Sign out', href: signout_path) }\n        specify { user.reload.name.should == new_name }\n        specify { user.reload.email.should == new_email }\n    end\n</code></pre>\n\n<p>end</p>\n\n<p>here are the errors and the rest of the files thats related to it</p>\n\n<pre><code>Failures:\n\n  1) User pages signup with valid information after saving the user\n     ←[31mFailure/Error:←[0m ←[31mit { should have_link('Sign out') }←[0m\n       ←[31mexpected link \"Sign out\" to return something←[0m\n←[36m     # ./spec/requests/user_pages_spec.rb:30:in `block (5 levels) in &lt;top (\nrequired)&gt;'←[0m\n\n  2) User pages edit page\n     ←[31mFailure/Error:←[0m ←[31mit { should have_link('change', href: 'http://\ngravatar.com/emails') }←[0m\n       ←[31mexpected link \"change\" to return something←[0m\n←[36m     # ./spec/requests/user_pages_spec.rb:134:in `block (4 levels) in &lt;top\n(required)&gt;'←[0m\n\n  3) User pages edit page\n     ←[31mFailure/Error:←[0m ←[31mit { should have_selector('title', text: \"Edit\n user\") }←[0m\n       ←[31mexpected css \"title\" with text \"Edit user\" to return something←[0m\n←[36m     # ./spec/requests/user_pages_spec.rb:133:in `block (4 levels) in &lt;top\n(required)&gt;'←[0m\n\n  4) User pages edit page\n     ←[31mFailure/Error:←[0m ←[31mit { should have_selector('h1',    text: \"Upda\nte your profile\") }←[0m\n       ←[31mexpected css \"h1\" with text \"Update your profile\" to return somethin\ng←[0m\n←[36m     # ./spec/requests/user_pages_spec.rb:132:in `block (4 levels) in &lt;top\n(required)&gt;'←[0m\n\n  5) User pages edit with valid information\n     ←[31mFailure/Error:←[0m ←[31mit { should have_selector('div.alert.alert-suc\ncess') }←[0m\n       ←[31mexpected css \"div.alert.alert-success\" to return something←[0m\n←[36m     # ./spec/requests/user_pages_spec.rb:149:in `block (4 levels) in &lt;top\n(required)&gt;'←[0m\n\n  6) User pages edit with valid information\n     ←[31mFailure/Error:←[0m ←[31mit { should have_selector('title', text: new_n\name) }←[0m\n       ←[31mexpected css \"title\" with text \"New Name\" to return something←[0m\n←[36m     # ./spec/requests/user_pages_spec.rb:148:in `block (4 levels) in &lt;top\n(required)&gt;'←[0m\n\n  7) User pages edit with valid information\n     ←[31mFailure/Error:←[0m ←[31mit { should have_link('Sign out', href: signou\nt_path) }←[0m\n       ←[31mexpected link \"Sign out\" to return something←[0m\n←[36m     # ./spec/requests/user_pages_spec.rb:150:in `block (4 levels) in &lt;top\n(required)&gt;'←[0m\n\n\n\n&lt;% provide(:title, \"Edit user\") %&gt;\n&lt;h1&gt;Update your profile&lt;/h1&gt;\n&lt;div class=\"row\"&gt;\n    &lt;div class=\"span6 offset3\"&gt;\n        &lt;%= form_for(@user) do |f| %&gt;\n            &lt;% render 'shared/error_messages' %&gt;\n\n            &lt;%= f.label :name %&gt;\n            &lt;%= f.text_field :name %&gt;\n\n            &lt;%= f.label :email %&gt;\n            &lt;%= f.text_field :email %&gt;\n\n            &lt;%= f.label :password %&gt;\n            &lt;%= f.password_field :password %&gt;\n\n            &lt;%= f.label :password_confirmation, \"Confirm Password\" %&gt;\n            &lt;%= f.password_field :password_confirmation %&gt;\n        &lt;%= f.submit \"Save changes\", class: \"btn btn-large btn-primary\" %&gt;\n        &lt;% end %&gt;\n\n        &lt;%= gravatar_for @user %&gt;\n       &lt;a href=\"http://gravatar.com/emails\"&gt;change&lt;/a&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n\n&lt;header class=\"navbar navbar-fixed-top\"&gt;\n    &lt;div class=\"navbar-inner\"&gt;\n        &lt;div class=\"container\"&gt;\n            &lt;%= link_to \"Anime Ranting\", root_path, id: \"logo\" %&gt;\n            &lt;nav&gt;\n                &lt;ul class=\"nav pull-right\"&gt;\n                    &lt;li&gt;&lt;%= link_to \"Home\", root_path %&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;%= link_to \"Help\", help_path %&gt;&lt;/li&gt;\n                    &lt;% if signed_in? %&gt;\n                        &lt;li&gt;&lt;%= link_to \"Users\", '#' %&gt;&lt;/li&gt;\n                        &lt;li id=\"fat-menu\" class=\"dropdown\"&gt;\n                            &lt;a href-\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"&gt;\n                                Account &lt;b class=\"caret\"&gt;&lt;/b&gt;\n                            &lt;/a&gt;\n                            &lt;ul class=\"dropdown-menu\"&gt;\n                                &lt;li&gt;&lt;%= link_to \"Profile\", current_user %&gt;&lt;/li&gt;\n                                &lt;li&gt;&lt;%= link_to \"Settings\", edit_user_path(current_user) %&gt;&lt;/li&gt;\n                                &lt;li class=\"divier\"&gt;&lt;/li&gt;\n                                &lt;li&gt;&lt;%= link_to \"Sign out\", signout_path, method: \"delete\" %&gt;&lt;/li&gt;\n                            &lt;/ul&gt;\n                        &lt;/li&gt;\n                    &lt;% else %&gt;\n                        &lt;li&gt;&lt;%= link_to \"Sign in\", signin_path %&gt;&lt;/li&gt;\n                    &lt;% end %&gt;\n                &lt;/ul&gt;\n            &lt;/nav&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/header&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":8263987,"title":"Different Webpage on Heroku and Local Host","body":"<p>So I have my local machine and it is configured to tell me which branch I'm working with on the terminal. It shows me working on the master branch. I then run the command <code>git push heroku master</code> and it runs through everything and it tells me that I've deployed to heroku, yet when I go and run <code>heroku open</code> it load the default rails page that says \"Ruby on Rails: Welcome Aboard\" Locally, I see the page I expect to see.</p>\n\n<p>I have removed the default index.html in the public folder and in my routes I have the following: <code>root :to =&gt; 'pages#home'</code> I've cleared my cache and reset my browser (safari) is there anything else I can do to try to make the webpage show up correctly?</p>\n"},{"tags":["ruby-on-rails","devise","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13205496,"title":"omniauth/devise facebook tutorial","body":"<p>I am reading the tutorial about integrating omniauth with devise.</p>\n\n<p>They have an example with Facebook <a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">(link here)</a></p>\n\n<p>They have the following code:</p>\n\n<pre><code>def self.find_for_facebook_oauth(auth, signed_in_resource=nil)\n  user = User.where(:provider =&gt; auth.provider, :uid =&gt; auth.uid).first\n  unless user\n    user = User.create(name:auth.extra.raw_info.name,\n                         provider:auth.provider,\n                         uid:auth.uid,\n                         email:auth.info.email,\n                         password:Devise.friendly_token[0,20]\n                         )\n  end\n  user\nend\n</code></pre>\n\n<p>And after that, they say:</p>\n\n<p>\"The method above simply tries to find an existing user by e-mail or create one with a random password otherwise. Note that this is simply an example. \nYour application must take precautions if using User.find_by_email to link an existing User with a Facebook account.\"</p>\n\n<p>I don't see how the method above is finding a user be e-mail address. It seems to me that it is only finding a user by the <code>:uid</code> for the given <code>:provider</code></p>\n\n<p>Am I missing something?</p>\n"},{"tags":["ruby-on-rails","utf-8","thin"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3255,"score":2,"question_id":4093173,"title":"Rails 3 Encoding::CompatibilityError","body":"<p>I am working on a rails app that submits a french translation via ajax and for some reason I keep getting the following error in the log:</p>\n\n<p><code>Encoding::CompatibilityError incompatible character encodings: UTF-8 and ASCII-8BIT</code></p>\n\n<p>Does anyone know how to fix this?</p>\n\n<p>FIX:This works on the WEBrick sever</p>\n\n<p>Place <code># encode: UTF-8</code> at the top of each file you want to work with different chars</p>\n\n<p>I can't get this to work on a rails server with Thin... anyone else run into this?</p>\n"},{"tags":["ruby-on-rails","capistrano","rvm-capistrano"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":13161000,"title":"Capistrano complains when trying to deploy","body":"<pre><code>$ bundle exec cap -S branch=master production deploy --dry-run\n/Users/myname/.rvm/lib/rvm/capistrano.rb:5: RVM - Capistrano integration was extracted to a separate gem, install: `gem install rvm-capistrano` and remove the `$LOAD_PATH.unshift` line, note also the 'set :rvm_type, :user' is now the default (instead of :system). (RuntimeError)\n</code></pre>\n\n<p>That's what I get. Not sure what's going on. Thoughts?</p>\n\n<p><strong>EDIT</strong> my <code>deploy.rb</code></p>\n\n<pre><code># RVM is used for ruby 1.9.2 - this is so cap can see the rvm gemset.\n$LOAD_PATH.unshift \"lib\", File.expand_path('./lib', ENV['rvm_path'])\n\nset :stages, %w(sandbox qa production)\nrequire 'capistrano/ext/multistage'\nrequire 'bundler/capistrano'\nrequire 'airbrake/capistrano'\nrequire 'chef/capistrano'\nrequire 'secure_files/capistrano'\nrequire \"rvm/capistrano\"\n\nset :rvm_ruby_string, '1.9.2'\nset :rvm_bin_path, '/usr/local/rvm/bin'\nset :user, \"root\"\nset :scm, :git\nset :repository,  \"git@github.com:Myact/fbadapter.git\"\nset :deploy_to, '/var/www/fbadapter'\nset :deploy_via, :remote_cache\nset :rails_env, Proc.new {stage}\nset :application, 'fbadapter'\nset :default_environment, Proc.new { { 'RAILS_ENV' =&gt; stage } }\nset :rake, \"bundle exec rake --trace\"\nset :foreman_bin, 'bundle exec foreman'\nset :rake, \"#{foreman_bin} run rake\"  \nset :rails, \"#{foreman_bin} run rails\"\nset :app_user, 'www-data'\n\nset :bundle_without,  [:development, :test, :ops, :darwin]\n\n# this must be set before foreman/capistrano is read\nset :foreman_roles, [:app]\nrequire \"foreman/capistrano\"\n\nafter 'multistage:ensure' do\n role_from_chef :db, 'app', :limit =&gt; 1, :primary =&gt; true # perform db operations on one of the app servers\n role_from_chef :web, 'app'\n role_from_chef :app\n role_from_chef :queue\n role_from_chef :cron\nend\n\n\nbefore 'deploy:symlink', 'deploy:assets:precompile', 'deploy:migrate'\nafter 'deploy:symlink', :set_application_permissions\n\nafter 'deploy', 'deploy:cleanup', 'campfire:deploy_stop'\nafter 'rollback', 'campfire:deploy_rollback'\n\ndesc 'Changes the permissions for the release path to be used with www-data'\ntask :set_application_permissions do\n  run \"chown -R #{app_user}:#{app_user} #{release_path}/*\"\nend\n\n# These services are monitored by monit, but interacting with them that way\n# is hugging-every-cat crazy. This means we're assuming two thin procs per\n# app server; if that changes then remember to change this too.\n\nnamespace :deploy do\n  task :stdout_logger do \n    run \"cd #{release_path} &amp;&amp; #{rails} plugin install https://github.com/ddollar/rails_log_stdout.git\"\n  end\n\n  before 'deploy:symlink', 'deploy:stdout_logger'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13205645,"title":"What's the best to include HTML tags before text produced by link_to?","body":"<p>basically I want the following output with <code>link_to</code>: </p>\n\n<pre><code>&lt;a href=\"#\"&gt;&lt;i class=\"some-class\"&gt;&lt;/i&gt;Some text&lt;/a&gt;\n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":1,"view_count":3002,"score":4,"question_id":4387439,"title":"Is \"ruby script/plugin\" a command?","body":"<p>i was following an online tutorial to create an ruby on rail application on app engine.</p>\n\n<p>there is one command, other ppl can run, but it didnt run on my ubuntu 10.10</p>\n\n<pre><code>ruby script/plugin install http://svn.avdi.org/nulldb/trunk/\n</code></pre>\n\n<p>when i try to run it, it complain ruby1.8: No such file or directory script/plugin (LoadError)</p>\n\n<p>what is wrong with my computer?</p>\n\n<p>ruby -v   ==>  1.8.7\nrails -v  ==> 2.3.10\ngem   -v  ==> 1.3.7</p>\n"},{"tags":["ruby-on-rails","elements"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13204231,"title":"Rails: Setting class and data-tag of an HTML attribute with a single rails method","body":"<p>I'm currently working on a tour interface that guides new users around my site. I have a Tour model that has many TourStops, each of which contains information about a section of the site.</p>\n\n<p>Basically, I'd like to write a function for the Tour model that -- when passed the number of a TourStop -- generates the correct class and data attribute for the HTML element it's attatched to. For example, I'd like     </p>\n\n<pre><code>&lt;%= link_to image_tag(\"new_button.png\", tour.stop_data(1), :title =&gt; 'Add new asset'), new_asset_path %&gt;\n</code></pre>\n\n<p>to call a function and return something like</p>\n\n<pre><code>def stop_data(order)\n     \" :class =&gt; '#{tour_stops.find_by_order(order).name}', \n       :data =&gt; '{:order =&gt; order}'\"\nend\n</code></pre>\n\n<p>creating a link_to tag like: </p>\n\n<pre><code>&lt;%= link_to image_tag(\"new_button.png\", :class =&gt; 'tour_stop_1', \n       :data =&gt; {:order =&gt; 1}, :title =&gt; 'Add new asset'), new_asset_path %&gt;\n</code></pre>\n\n<p>The above code doesn't work. Is something like this even possible? If not, what's a better approach I might take?</p>\n"},{"tags":["ruby-on-rails","legacy-database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13203951,"title":"Strategies for Rails development/test development with complex legacy schema","body":"<p>When developing a Rails app with a legacy schema that is in-use by an existing application, if tables have NOT NULL constraints on foreign id columns throughout the schema, in order to create/save models for tests, models need to exist for those associations, and their associations, etc. So, it isn't an easy as just creating one model at a time as you need it and testing with it.</p>\n\n<p>As far as testing goes, this seems to be a problem if you are using FactoryGirl and want to create and save model instances to return from controllers, etc. when all of the association dependencies are involved. Another option is to mock, but mocking can be a little more time consuming and it doesn't allow you to do integration testing as easily. Another is to use fixtures, but those are time consuming and brittle. Another is to pre-populate the test database with production data, but that doesn't solve the need for factories, etc./known data to expect in tests, and Rails usually expects to start with a clean DB for the test environment.</p>\n\n<p>What strategies for developing models, tests, etc. do you use when you have an existing complex schema that you are bolting a Rails app onto- not just for reading data, but also writing to the existing schema that is in use by an existing production application? (i.e. the \"rebuild the ship while at sea\" problem)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nested-forms","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13204661,"title":"RoR: Nested forms and dynamic fields","body":"<p>I am struggling with some nested forms which dynamically inserts fields. I have based my code on Ryan Bates great railscasts.  My problem though is that I need to move my \"add fields\" button outside the nested form.  This causes problems because I don't have access to some of the objects required to generate the form.</p>\n\n<p>In the code below the add/remove button is in the same location.  I can change the if statement to do this, but I cannot move the add fields button outside the f.simple_fields_for :fund_levels loop.</p>\n\n<p>Any suggestions for a clean way of doing this?</p>\n\n<p>The view</p>\n\n<pre><code>     = f.simple_fields_for :fund_levels do |fl|\n       - fl.object.id ? headerappend = fl.object.id : headerappend = \"#{i}-notset\"\n       %div{id: \"flheader-#{headerappend}\"}\n         %div\n           = link_to \"Sponsor levels\", \"#\", :class =&gt; \"show_hide\", :id =&gt; \"initiator1_fl#{i}\", :style=&gt;\"margin-bottom:2px;\", :onclick=&gt;\"return false\"\n         %div{:class =&gt; \"slidingDiv #{fund_levels_last?(i, @fund_level_count) ? \"shown\": \"hidd\" } whitebg leftadj\", :id=&gt;\"body_fl#{i}\", :style=&gt;\"width:100%;\" }\n\n           = render :partial =&gt; 'fund_level_fields', :locals =&gt; {:fl =&gt; fl, :ad =&gt; ad, :i =&gt; i, :f =&gt; f}\n           %div{:style =&gt; \"float: right; padding: 20px 20px 20px 0\"}\n             = fund_levels_last?(i, @fund_level_count) ? ( link_to_add_fields \"add new level\", f, :fund_levels, fl, i+1, ad ) : ( link_to \"remove\", accounts_ad_fund_level_path(ad, fl.object.id), {:class =&gt; 'button orange sm', :method =&gt; :delete, :remote =&gt; true, :confirm =&gt; t('q.are_you_sure')} )\n       - i += 1\n     %div#newfields\n       - # THE BUTTON SHOULD GO HERE if it is an ADD FIELDS (remove btn should stay above)\n</code></pre>\n\n<p>the application_helper file</p>\n\n<pre><code>   def link_to_add_fields(name, f, association, sublevel, counter, parent)\n\n     new_object = f.object.class.reflect_on_association(association).klass.new\n     fields = f.fields_for(association, new_object, :child_index =&gt; \"new_#{association}\") do |builder|\n       render(association.to_s.singularize + \"_fields\", :f =&gt; builder, :fl =&gt; sublevel, :i =&gt; counter, :ad =&gt; parent) #fl, i, ad\n     end\n\n     # this bit is required because of some bugs in haml\n     fields.gsub!(/\\&lt;haml\\:newline\\/\\&gt;/, '').html_safe\n\n     link_to name, '#', :id =&gt; \"#{name}|-|#{association}|-|#{fields}\", :class =&gt; \"addfields\", :onclick =&gt; \"return false\"\n   end\n</code></pre>\n"},{"tags":["ruby-on-rails","facebook","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13205394,"title":"What gem should I use to connect to facebook api from rails on heroku","body":"<p>I'm really confused, I'm trying to create a rails app on heroku that connects to facebook. The app needs to access the facebook api (maybe using the koala gem) therefore I need some user access token..</p>\n\n<p>what gems should I use to connect?\nP.S. my app on facebook is set on \"app on facebook\" and \"website with facebook login\" (what I really want is a website with facebook login AND access to facebook api...)</p>\n\n<p>any idea/clarification?</p>\n"}]}
{"total":93231,"page":12,"pagesize":100,"questions":[{"tags":["ruby-on-rails","deployment","capistrano","ubuntu-11.10"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":50,"score":0,"question_id":13173797,"title":"Trouble with rails multistage deployment on Ubuntu 11.10","body":"<p>I am trying to get a multistage deployment on my server and I am having trouble getting a staging and production configuration running. </p>\n\n<p>Server: Ubuntu 11.10 (GNU/Linux 3.0.0-19-server x86_64)</p>\n\n<p>Here is what I have done so far:</p>\n\n<ol>\n<li><p>I created a new project called form_tester on my local machine. I am using a simple database with sqlite3 locally. I wish to use mysql2 on both staging and production. </p></li>\n<li><p>Setup directories for staging and production on server.</p>\n\n<pre><code>/home/username/form_tester/staging\n/home/username/form_tester/production\n</code></pre></li>\n<li><p>Made two databases on server for staging and production. I also configured them for access by a user with the correct privileges since I am able to generate the tables in them.</p>\n\n<pre><code>ftstaging\nftproduction\n</code></pre></li>\n<li><p>Configured the config/database.yml file for both staging and production.</p>\n\n<pre><code>staging: \n  adapter: mysql2 \n  encoding: utf8 \n  reconnect: false\n  database: ftstaging\n  pool: 5 \n  username: dbuser \n  password: pass \n  host: server.com\n\nproduction: \n  adapter: mysql2 \n  encoding: utf8 \n  reconnect: false\n  database: ftproduction\n  pool: 5 \n  username: dbusr \n  password: pass \n  host: server.com\n</code></pre></li>\n<li><p>Configured the Gemfile for both staging and production.</p>\n\n<p>source 'https://rubygems.org'</p>\n\n<pre><code>gem 'rails', '3.2.8'\ngem 'jquery-rails'\ngem 'capistrano'\n\ngroup :development do\n  gem 'sqlite3'\nend\n\ngroup :staging do\n  gem 'activerecord-mysql2-adapter'\n  gem 'mysql2'\nend\n\ngroup :production do\n  gem 'activerecord-mysql2-adapter'\n  gem 'mysql2'\nend\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n</code></pre></li>\n<li><p>Ran Capify to get deployment files. Deleted everything from the deploy.rb file. Left the Capfile alone.</p></li>\n<li><p>Created deploy directory and made two files.</p>\n\n<pre><code>config/deploy/production.rb\nconfig/deploy/staging.rb\n</code></pre></li>\n<li><p>Added the following details for configuration:</p></li>\n</ol>\n\n<p><strong>For config/deploy/production.rb:</strong></p>\n\n<pre><code>    server \"server.com\", :app, :web, :db, :primary =&gt; true\n    set :deploy_to, \"/home/username/form_tester/production\"\n    set :rails_env, \"production\"\n</code></pre>\n\n<p><strong>For config/deploy/staging.rb:</strong></p>\n\n<pre><code>    server \"server.com\", :app, :web, :db, :primary =&gt; true\n    set :deploy_to, \"/home/username/form_tester/staging\"\n    set :rails_env, \"staging\"\n</code></pre>\n\n<p><strong>For config/deploy.rb:</strong></p>\n\n<pre><code>    set :stages, ['production', 'staging']\n    set :default_stage, 'staging'\n    require 'capistrano/ext/multistage'\n\n    # Set application name\n    set :application, 'form_tester'\n    set :domain, 'server.com'\n    set :user, 'username'\n\n    # Use Git source control\n    set :scm, :git\n    set :repository, \"ssh://#{user}@#{domain}/home/#{user}/git/#{application}.git\"\n    set :branch, 'master'\n    set :deploy_via, :remote_cache\n    set :scm_verbose, true\n\n    default_run_options[:pty] = true\n    set :use_sudo, false\n\n    namespace :deploy do\n      task :start do ; end\n      task :stop do ; end\n\n      desc \"Restart application\"\n      task :restart, :roles =&gt; :app, :except =&gt; { :no_release =&gt; true } do\n        run \"#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}\"\n      end\n    end\n</code></pre>\n\n<p>9.Initialized git repo on server with git --bare init and made sure I have proper access to the directory for the current username.</p>\n\n<p>10.Initialized git repo on dev machine and pushed the files to the server repo at<br>\n        ssh://username@server.com/home/username/git/form_tester.git.</p>\n\n<p>11.Begin deployment from local machine to staging on server. I run all the following commands with no errors.</p>\n\n<p><strong>To build the directory tree under /home/username/form_tester/staging</strong></p>\n\n<pre><code>    $ cap deploy:setup\n    $ cap deploy:check\n    $ cap deploy:update\n\n    *ssh'ed into my server*\n\n    $ rake schema:db:load\n    $ rake db:seed\n    $ rails console\n    &gt; app.get('/')\n    I get a '200' returned\n    &gt; exit\n</code></pre>\n\n<p><em>still ssh'ed into my server</em></p>\n\n<p>12.I made a symlink from /var/www/staging to my application public directory         </p>\n\n<pre><code>    /home/username/form_tester/staging/current/public.\n\n    $ sudo ln -s /home/username/form_tester/staging/current/public /var/www/staging\n</code></pre>\n\n<p>13.Modified the /etc/apache2/sites-available/default file to add a subURI for the staging app.</p>\n\n<pre><code>    $ sudo vi /etc/apache2/sites-available/default\n\n    …\n            RailsBaseURI /staging\n            &lt;Directory /var/www/staging&gt;\n                    Options -MultiViews\n            &lt;/Directory&gt;\n    …\n</code></pre>\n\n<p>14.At this point (locally) I run cap deploy:restart and it seems to restart the server since there is no error. (logged into the server) I also tried sudo service apache2 restart, which also restarts the server fine.</p>\n\n<p>15.At this point I pull up the url server.com/staging but don't see my app.</p>\n\n<p><strong>Other files:</strong></p>\n\n<p><em><strong>config/application.rb:</em></strong></p>\n\n<pre><code>    require File.expand_path('../boot', __FILE__)\n\n    require 'rails/all'\n\n    if defined?(Bundler)\n      Bundler.require(*Rails.groups(:assets =&gt; %w(development test)))\n    end\n\n    module FormTester\n      class Application &lt; Rails::Application\n        config.encoding = \"utf-8\"\n        config.filter_parameters += [:password]\n        config.active_support.escape_html_entities_in_json = true   \n        config.active_record.whitelist_attributes = true\n        config.assets.enabled = true\n        config.assets.version = '1.0'\n      end\n    end\n</code></pre>\n\n<p><em><strong>config/environments/staging.rb and production.rb</em></strong></p>\n\n<pre><code>    FormTester::Application.configure do\n      config.cache_classes = true\n      config.consider_all_requests_local       = false\n      config.action_controller.perform_caching = true\n      config.serve_static_assets = false\n      config.assets.compress = true\n      config.assets.compile = false\n      config.assets.digest = true\n      config.i18n.fallbacks = true\n      config.active_support.deprecation = :notify\n    end\n</code></pre>\n\n<p><em><strong>/var/log/apache2/error.log</em></strong></p>\n\n<p>There seems to be nothing ruby related showing up here except phusion passenger, but it's not an error.</p>\n\n<pre><code>    [Thu Nov 01 01:16:11 2012] [notice] caught SIGTERM, shutting down\n    PHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib/php5/20090626/gd.so' - /usr/lib/php5/20090626/gd.so: cannot open shared object file: No such file or directory in Unknown on line 0\n    PHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib/php5/20090626/mcrypt.so' - /usr/lib/php5/20090626/mcrypt.so: cannot open shared object file: No such file or directory in Unknown on line 0\n    [Thu Nov 01 01:16:12 2012] [notice] Apache/2.2.20 (Ubuntu) DAV/2 SVN/1.6.12 PHP/5.3.6-13ubuntu3.7 with Suhosin-Patch Phusion_Passenger/3.0.17 configured -- resuming normal operations\n    [Thu Nov 01 01:16:20 2012] [error] [client 68.6.38.254] File does not exist: /var/www/favicon.ico\n    [Thu Nov 01 01:16:22 2012] [error] [client 68.6.38.254] File does not exist: /var/www/favicon.ico\n    [Thu Nov 01 01:23:07 2012] [error] [client 68.6.38.254] File does not exist: /var/www/favicon.ico\n</code></pre>\n\n<p><strong>Observations:</strong></p>\n\n<ol>\n<li><p>Running rake schema:db:load appears to build the tables properly for my database but its actually building them for the development.sqlite3 file.</p></li>\n<li><p>If I open the rails console and run Rails.env, I get \"staging\" as the environment. </p></li>\n<li><p>This is most likely tied with #1, rake db:seed doesn't seem to fill my database called \"ftstaging\" in mysql on the server even though it executes. </p></li>\n<li><p>cap deploy doesn't seem to do anything different than cap deploy:update. </p></li>\n<li><p>The end result is a page at server.com/staging that says \"We're sorry, but something went wrong.\"</p></li>\n<li><p>There doesn't seem to be anything shown in my </p></li>\n<li><p>Running rake about shows that I am still in development mode.</p>\n\n<pre><code>About your application's environment\nRuby version              1.9.3 (x86_64-linux)\nRubyGems version          1.8.24\nRack version              1.4\nRails version             3.2.8\nJavaScript Runtime        Node.js (V8)\nActive Record version     3.2.8\nAction Pack version       3.2.8\nActive Resource version   3.2.8\nAction Mailer version     3.2.8\nActive Support version    3.2.8\nMiddleware                ActionDispatch::Static, Rack::Lock, #&lt;ActiveSupport::Cache::Strategy::LocalCache::Middleware:0x00000002796948&gt;, Rack::Runtime, Rack::MethodOverride, ActionDispatch::RequestId, Rails::Rack::Logger, ActionDispatch::ShowExceptions, ActionDispatch::DebugExceptions, ActionDispatch::RemoteIp, ActionDispatch::Reloader, ActionDispatch::Callbacks, ActiveRecord::ConnectionAdapters::ConnectionManagement, ActiveRecord::QueryCache, ActionDispatch::Cookies, ActionDispatch::Session::CookieStore, ActionDispatch::Flash, ActionDispatch::ParamsParser, ActionDispatch::Head, Rack::ConditionalGet, Rack::ETag, ActionDispatch::BestStandardsSupport\nApplication root          /home/username/form_tester/staging/releases/20121101080752\nEnvironment               development\nDatabase adapter          sqlite3\nDatabase schema version   20121030011807\n</code></pre></li>\n</ol>\n\n<p>I have tried the following tutorials with little luck:</p>\n\n<ul>\n<li><a href=\"https://github.com/capistrano/capistrano/wiki/2.x-Multistage-Extension\" rel=\"nofollow\">https://github.com/capistrano/capistrano/wiki/2.x-Multistage-Extension</a></li>\n<li><a href=\"http://trevmex.com/post/367574671/steps-for-setting-up-a-capistrano-multistage-deployment\" rel=\"nofollow\">http://trevmex.com/post/367574671/steps-for-setting-up-a-capistrano-multistage-deployment</a></li>\n<li><a href=\"http://cjohansen.no/en/apache/multi_staging_environment_for_rails_using_capistrano_and_mod_rails\" rel=\"nofollow\">http://cjohansen.no/en/apache/multi_staging_environment_for_rails_using_capistrano_and_mod_rails</a></li>\n<li><a href=\"http://guides.beanstalkapp.com/deployments/deploy-with-capistrano.html#prepare-project\" rel=\"nofollow\">http://guides.beanstalkapp.com/deployments/deploy-with-capistrano.html#prepare-project</a></li>\n</ul>\n\n<p><strong>Questions:</strong></p>\n\n<p>I'm sure there is someone out there that understands the deployment process in and out, what am I missing? \nWhat should I check for? \nFrom what I have shown here, what can I do differently?</p>\n\n<p>Any help is greatly appreciated at this point. I have been fighting with this issue for two days now and don't know what I'm doing wrong and don't know what else to try. I just started using rails about 3 weeks ago and most of my frustration has been due to not being able to find a clear description of the process for deployment. I hope to gain clarity on this issue and in return help others get from idea to multistage deployment easily. </p>\n\n<p>On another note, why would someone \"down vote\" this post? I'm asking a legit question with information to back it up. If it's not a good question please tell me why. Thanks</p>\n\n<hr>\n\n<p><strong>11/1/12 - UPDATE:</strong> </p>\n\n<p>I figured out how to get my app into the \"staging\" environment but it still doesn't load at server.com/staging.</p>\n\n<p>I added \"Rails.env = ActiveSupport::StringInquirer.new('staging')\" into my config/application.rb file, but I don't know why this forces the environment. Is this the correct way to do it?</p>\n\n<p>I then deployed, ssh'ed into my server as username, and ran rake db:migrate and rake db:seed. I now see my database populated.</p>\n\n<p>What else could be going on? Is there something wrong with my environments/staging.rb file?</p>\n\n<hr>\n\n<p><strong>/etc/apache2/httpd.conf</strong></p>\n\n<pre><code>ServerName server.com\n\nLoadModule passenger_module /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.17/ext/apache2/mod_passenger.so\nPassengerRoot /usr/local/rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.17\nPassengerRuby /usr/local/rvm/wrappers/ruby-1.9.3-p194/ruby\n</code></pre>\n"},{"tags":["css","ruby-on-rails","haml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13205372,"title":"haml code how to make it has some indention","body":"<p>I have the following code that displaying element like below<br></p>\n\n<pre><code>    Mytable\n1.  line1\n2.  line2\n3.  line3\n4.  line4\n</code></pre>\n\n<p>but I want it have indention, like belows</p>\n\n<pre><code>     Mytable\n   1.  line1\n   2.  line2\n   3.  line3\n   4.  line4\n</code></pre>\n\n<p>My code is at here<br></p>\n\n<pre><code>      %div{:class =&gt; 'test1'}\n        %table#tablename\n          %thead\n            %tr\n              %th.lead Mytable\n\n          %tbody              \n            %tr\n              %center\n              %td 1.line1\n            %tr\n              %td 2. line2\n            %tr \n              %td 3. line3\n            %tr\n              %td 4. line4\n</code></pre>\n"},{"tags":["ruby-on-rails","nested-forms"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13205154,"title":"Nested Model Form - Render not working","body":"<p>I'm new in rails and need some help creating a Nested form.</p>\n\n<p>I have this in teams/_form.html.erb</p>\n\n<pre><code>&lt;%= form_for @team do |f| %&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label \"Name\" %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :name, :required =&gt; true %&gt;\n&lt;/div&gt;\n\n&lt;%= f.fields_for :players do |builder| %&gt;\n    &lt;%= render :partial =&gt; 'players_field', :f =&gt; builder %&gt;\n&lt;% end %&gt;\n\n\n&lt;div class=\"actions\"&gt;\n   &lt;%= f.submit %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What I want is create a list of players in the team form. The problem is that the render don't work and players_field.html.erb don't render.</p>\n\n<pre><code>&lt;table class=\"table table-striped\"&gt;\n  &lt;thead&gt;\n  &lt;tr&gt;\n    &lt;th&gt;#&lt;/th&gt;\n    &lt;th&gt;Name&lt;/th&gt;\n    &lt;th&gt;Position&lt;/th&gt;\n  &lt;/tr&gt;\n &lt;/thead&gt;\n &lt;tbody id=\"tableRow\"&gt;\n  &lt;tr&gt;\n\n &lt;/tr&gt;\n &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>TR is added to the table with js.</p>\n\n<p>UPDATE: </p>\n\n<p>Another problem appear now :/</p>\n\n<p>This is my js:</p>\n\n<pre><code> var newRow = document.createElement('tr');\n newRow.innerHTML =  \"&lt;td&gt;\"+ counter +\"&lt;/td&gt;\"+\n                     \"&lt;%= f.text_field :name %&gt;\"+\n                     \"&lt;%= f.text_field :position %&gt;\"+;\n document.getElementById(\"tableRow\").appendChild(newRow);\n</code></pre>\n\n<p>Error: </p>\n\n<pre><code>undefined local variable or method `f' for #&lt;#&lt;Class:0x0000000288dd38&gt;:0x007f77cc1226e0&gt;\n</code></pre>\n\n<p>Why I can't add this ?</p>\n"},{"tags":["ruby-on-rails","nginx","unicorn","unix-socket","rainbows"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":135,"score":3,"question_id":13124412,"title":"104: Connection reset by peer: nginx + rainbows + over 1 mb uploads","body":"<p>I am running ThreadPool rainbows + nginx (unix socket)</p>\n\n<p>On large file uploads I am getting the following in nginx error log (nothing in the application log):</p>\n\n<pre><code>readv() failed (104: Connection reset by peer) while reading upstream\n</code></pre>\n\n<p>The browser receives response:</p>\n\n<pre><code>413 Request Entity Too Large\n</code></pre>\n\n<p>Why does this happen?</p>\n\n<ul>\n<li>\"client_max_body_size 80M;\" is set both on http and server level (just in case) in nginx</li>\n<li>nginx communicates with rainbows over a unix socket (upstream socket + location @ proxy_pass)</li>\n<li>I don't see anything in the other logs. I have checked: \n<ul>\n<li>rainbows log</li>\n<li>foreman log</li>\n<li>application log</li>\n<li>dmesg and /var/log/messages</li>\n</ul></li>\n<li>This happens when uploading a file ~> 1 MB size</li>\n</ul>\n"},{"tags":["ruby-on-rails","google","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13204474,"title":"Getting \"Error: redirect_uri_mismatch\" with google_oauth2","body":"<p>The URL's seem right (Last updated them yesterday):</p>\n\n<p><img src=\"http://i.stack.imgur.com/MtAUh.png\" alt=\"enter image description here\"></p>\n\n<p>The files too:</p>\n\n<p><strong>omniauth.rb:</strong></p>\n\n<pre><code>provider :google_oauth2, 'MY_CLIENT_ID.apps.googleusercontent.com', 'MY_CLIENT_SECRET',\n           :scope =&gt; 'https://mail.google.com/mail/feed/atom/'\n\nError: redirect_uri_mismatch\nThe redirect URI in the request: http://localhost:3000/auth/google_oauth2/callback did not match a registered redirect URI\n</code></pre>\n\n<p><strong>header.html.erb</strong></p>\n\n<pre><code>&lt;li&gt;&lt;%= link_to \"Sign in with Google\", \"auth/google_oauth2\" %&gt;&lt;/li&gt;\n</code></pre>\n\n<p><strong>routes.rb:</strong></p>\n\n<pre><code>match '/auth/:provider/callback', to: 'sessions#omniauth_create'\n</code></pre>\n\n<p>But I'm getting this:</p>\n\n<pre><code>&gt; Error: redirect_uri_mismatch The redirect URI in the request:\n&gt; http://localhost:3000/auth/google_oauth2/callback did not match a\n&gt; registered redirect URI\n</code></pre>\n\n<p>(Twitter and Facebook OmniAuth are working perfectly)</p>\n\n<p>Not sure what is the problem. Any usggestions to fix this?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I changed the URI to <code>http</code>...:</p>\n\n<p><img src=\"http://i.stack.imgur.com/EsOVF.png\" alt=\"enter image description here\"></p>\n\n<p>But still getting the same error.</p>\n"},{"tags":["ruby-on-rails","controller","arguments","argument-error"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13195737,"title":"ArgumentError in Rails","body":"<p>I want to connect two entity (project and issues) and Rails says some error message, but I don't know, what should I do. Can you help me fix it, please? Thanks a lot.</p>\n\n<p><img src=\"http://i.stack.imgur.com/aAGwH.png\" alt=\"Error screen\"></p>\n"},{"tags":["ruby-on-rails","session","ssl","controller","sorcery"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12919477,"title":"Current user not persisting across one controller action","body":"<p>I've got a Rails 3.2.8 app using Sorcery for authentication. Sorcery provides a <code>current_user</code> method, pretty standard stuff.</p>\n\n<p>My app has subscriptions, they work pretty much in the standard resourceful way. Here's the abridged version of the controller:</p>\n\n<pre><code>class SubscriptionsController &lt; ApplicationController\n  before_filter :require_login\n  force_ssl\n\n  def show\n    @subscription = SubscriptionPresenter.new( current_user )\n  end\n\n  def create\n    handler = StripeHandler.new( current_user )\n    ...\n  end\n\n  def destroy\n    handler = StripeHandler.new( current_user )\n    ...\n  end\nend\n</code></pre>\n\n<p>The <code>#show</code> action works fine, <code>current_user</code> loads. However, right now <code>#create</code> does not work, because <code>current_user</code> ends up being <code>nil</code> in that action.</p>\n\n<p>So, why is <code>current_user</code> nil when a logged in user posts to this action? My guess is something about the way sessions work over SSL, but I don't know what I'm missing here...</p>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13201270,"title":"error in ruby on rails app for email contact form","body":"<p>I followed this <a href=\"http://matharvard.ca/posts/2011/aug/22/contact-form-in-rails-3/\" rel=\"nofollow\">email form</a> tutorial for my ruby on rails app which is hosted at heroku. Every time I pull up localhost:3000/contact I get the following error:</p>\n\n<p>No route matches {:action=>\"home\", :controller=>\"contact\"}</p>\n\n<p>Here is what is in my routes.rb file:</p>\n\n<pre><code>Inspired::Application.routes.draw do\n  get \"pages/home\"\n  get \"pages/about_us\"\n  get \"pages/web_design\"\n  get \"pages/portfolio\"\n  get \"pages/contact\"\n\n  match 'contact' =&gt; 'contact#new',    :as =&gt; 'contact', :via =&gt; :get\n  match 'contact' =&gt; 'contact#create', :as =&gt; 'contact', :via =&gt; :post\n\n  root :to =&gt; 'pages#home'\nend\n</code></pre>\n\n<p>I'm unsure of where I'm going wrong. Why is the action going to home when it is supposed to go to new or create? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","nokogiri","xfdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13204964,"title":"How can I read the contents of an XFDF file in Nokogiri, enter values, and then save the output?","body":"<p>I have a set of XFDF files generated from PDF forms. What I'd like to do is populate these XFDF files (which have all empty values for the form fields) with data, and then save them to a new file. I am running a RoR app with the Nokogiri gem.</p>\n\n<p>I am new to using Nokogiri for parsing XML data and have never done this before. Can someone help me understand how to:</p>\n\n<ol>\n<li>load and parse an XFDF file's fields into a hash in ruby,</li>\n<li>populate the values of the fields with some data,</li>\n<li>save the completed data back into the XFDF file?</li>\n</ol>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13188117,"title":"send_file return value","body":"<p>Does the <code>send_file</code> method in Rails give a return value? I'd like to do one thing if the sending is successful, and another thing if the sending is <em>not</em> successful. I looked at the documentation at <a href=\"http://apidock.com/rails/ActionController/Streaming/send_file\" rel=\"nofollow\">this link</a>, but did not find anything relevant.</p>\n"},{"tags":["ruby-on-rails","deployment","capistrano","unicorn"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13204158,"title":"Unicorn_init.sh cannot find app root on capistrano cold deploy","body":"<p>I am deploying Rails app and upon running </p>\n\n<blockquote>\n  <p>cap deploy:cold</p>\n</blockquote>\n\n<p>I get the error saying</p>\n\n<pre><code>  * 2012-11-02 23:53:26 executing `deploy:migrate'\n  * executing \"cd /home/mr_deployer/apps/prjct_mngr/releases/20121102225224 &amp;&amp; bundle exec rake RAILS_ENV=production  db:migrate\"\n    servers: [\"xxxxxxxxxx\"]\n    [xxxxxxxxxx] executing command\n    command finished in 7464ms\n  * 2012-11-02 23:53:34 executing `deploy:start'\n  * executing \"/etc/init.d/unicorn_prjct_mngr start\"\n    servers: [\"xxxxxxxxxx\"]\n    [xxxxxxxxxx] executing command\n ** [out :: xxxxxxxxxx] /etc/init.d/unicorn_prjct_mngr: 33: cd: can't cd to /home/mr_deployer/apps/prjct_mngr/current;\n    command finished in 694ms\nfailed: \"rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell '1.9.3-p125@prjct_mngr' -c '/etc/init.d/unicorn_prjct_mngr start'\" on xxxxxxxxxx\n</code></pre>\n\n<p>but my app root is there! Why can't it find it? Here's part of my <strong>unicorn_init.sh file</strong> : </p>\n\n<pre><code>  1 #!/bin/sh\n  2 set -e\n  3 # Example init script, this can be used with nginx, too,\n  4 # since nginx and unicorn accept the same signals\n  5 \n  6 # Feel free to change any of the following variables for your app:\n  7 TIMEOUT=${TIMEOUT-60}\n  8 APP_ROOT=/home/mr_deployer/apps/prjct_mngr/current\n  9 PID=$APP_ROOT/tmp/pids/unicorn.pid\n 10 CMD=\"cd $APP_ROOT; bundle exec unicorn -D -E production -c $APP_ROOT/config/unicorn.rb\"\n 11 # INIT_CONF=$APP_ROOT/config/init.conf\n 12 AS_USER=mr_deployer\n 13 action=\"$1\"\n 14 set -u\n 15 \n 16 # test -f \"$INIT_CONF\" &amp;&amp; . $INIT_CONF\n 17 \n 18 old_pid=\"$PID.oldbin\"\n 19 \n 20 cd $APP_ROOT || exit 1\n 21 \n 22 sig () {\n 23   test -s \"$PID\" &amp;&amp; kill -$1 `cat $PID`\n 24 }\n 25 \n 26 oldsig () {\n 27   test -s $old_pid &amp;&amp; kill -$1 `cat $old_pid`\n 28 }\n 29 case $action in\n 30 \n 31 start)\n 32   sig 0 &amp;&amp; echo &gt;&amp;2 \"Already running\" &amp;&amp; exit 0\n 33   $CMD\n 34   ;;\n 35 \n 36 stop)\n 37   sig QUIT &amp;&amp; exit 0\n 38   echo &gt;&amp;2 \"Not running\"\n 39   ;;\n 40 \n 41 force-stop)\n 42   sig TERM &amp;&amp; exit 0\n 43   echo &gt;&amp;2 \"Not running\"\n 44   ;;\n 45 \n 46 restart|reload)\n 47   sig HUP &amp;&amp; echo reloaded OK &amp;&amp; exit 0\n 48   echo &gt;&amp;2 \"Couldn't reload, starting '$CMD' instead\"\n 49   $CMD\n 50   ;;\n 51 \n 52 upgrade)\n 53   if sig USR2 &amp;&amp; sleep 2 &amp;&amp; sig 0 &amp;&amp; oldsig QUIT\n 54   then\n 55     n=$TIMEOUT\n 56     while test -s $old_pid &amp;&amp; test $n -ge 0\n 57     do\n 58       printf '.' &amp;&amp; sleep 1 &amp;&amp; n=$(( $n - 1 ))\n 59     done\n 60     echo\n 61 \n 62     if test $n -lt 0 &amp;&amp; test -s $old_pid\n 63     then\n 64       echo &gt;&amp;2 \"$old_pid still exists after $TIMEOUT seconds\"\n 65       exit 1\n 66     fi\n 67     exit 0\n 68   fi\n 69   echo &gt;&amp;2 \"Couldn't upgrade, starting '$CMD' instead\"\n 70   $CMD\n 71   ;;\n 72 \n 73 reopen-logs)\n 74 sig USR1\n 75 ;;\n 76 \n 77 *)\n 78   echo &gt;&amp;2 \"Usage: $0 &lt;start|stop|restart|upgrade|force-stop|reopen-logs&gt;\"\n 79   exit 1\n 80   ;;\n 81 esac\n</code></pre>\n\n<h2>---------------------------------------</h2>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I ran the command it complaints about (below)</p>\n\n<blockquote>\n  <p>cd /home/mr_deployer/apps/prjct_mngr/current; bundle exec unicorn -D -E production -c /home/mr_deployer/apps/prjct_mngr/current/config/unicorn.rb</p>\n</blockquote>\n\n<p>on my VPS and it worked! <strong>It just doesnt work when I cap deploy:cold. Why is that?</strong></p>\n"},{"tags":["ruby-on-rails","logging","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13195291,"title":"Heroku - how to flush Rails logs after each request","body":"<p>I'm running a Rails 3 app on Heroku.</p>\n\n<p>This is the output of <code>heroku logs --tail --source app</code>:\n<a href=\"https://gist.github.com/4000998\" rel=\"nofollow\">https://gist.github.com/4000998</a></p>\n\n<p>The <code>Started GET \"/\"</code> lines appear in real time as HTTP requests are made.  However, the <code>Processing by Controller</code> lines get buffered and then dumped to the log all at once.</p>\n\n<p>This makes it very hard to debug issues in the app as it is difficult to match up the controller logs with the rest of the app's logs.  How do I get the buffered logs to flush after each request?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing","devise","routes"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1247,"score":6,"question_id":6659555,"title":"How to write controller tests when you override devise registration controller?","body":"<p>I wish to override the <code>Devise::RegistrationsController</code> to implement some custom functionalality. To do this, I've created a new <code>RegistrationsController</code> like so:</p>\n\n<pre><code># /app/controllers/registrations_controller.rb\nclass RegistrationsController &lt; Devise::RegistrationsController\n  def new\n    super\n  end\nend\n</code></pre>\n\n<p>and set up my routes like this:</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :registrations =&gt; \"registrations\" }\n</code></pre>\n\n<p>and tried to test it like this:</p>\n\n<pre><code>describe RegistrationsController do\n  describe \"GET 'new'\" do\n    it \"should be successful\" do\n      get :new\n      response.should be_success\n    end\n  end\nend\n</code></pre>\n\n<p>but that gives me an error:</p>\n\n<p>1) RegistrationsController GET 'new' should be successful\n     Failure/Error: get :new\n     AbstractController::ActionNotFound:\n       Could not find devise mapping for path \"/users/sign_up\".\n       Maybe you forgot to wrap your route inside the scope block? For example:</p>\n\n<pre><code>       devise_scope :user do\n         match \"/some/route\" =&gt; \"some_devise_controller\"\n       end\n # ./spec/controllers/registrations_controller_spec.rb:13:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>So what am I doing wrong?</p>\n"},{"tags":["ruby-on-rails","regex","ruby-on-rails-3","hyperlink"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13198997,"title":"Regex to Match Urls in Ruby on Rails","body":"<p>I have looked around but I haven't really found an answer that seals the deal 100% for my individual situation.</p>\n\n<p>In my Ruby app, I have a user share system where members can post 'stuff'.  Well, sometimes members post links, and I have noticed as the site grows, more and more users are complaining about there not being clickable links.</p>\n\n<p>How would I utilize regular expressions to match urls for links in posts.  Furthermore, how would I apply this in my Model?</p>\n\n<p>Thanks for you help, out of all my questions, this is a real important one for me ha!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I suppose my init post was too vague...</p>\n\n<p>I am more trying to figure out HOW to IMPLEMENT the use of regular expressions into my model  instead of which regular expression to use.</p>\n\n<p>The model is <code>class Share</code>.  And the member's post is rendered as <code>&lt;%= share.content %&gt;</code> with content being a column in my Share table as well as an accessible attribute...</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","routes"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":9641929,"title":"Rails static page routes vs :constraints => { :url => /.+/ } -- pros and cons","body":"<p>I'm creating Page admin setup. Pages may include sub pages and I have a bunch of functionality to create the trailing url strings. Anyways, just wondering what the pros and cons here is. Speed-wise or anything I didn't really consider (aside maybe a bit more/less flexibility with other route matching):</p>\n\n<p><strong>Option 1 -- Match everything to pages:</strong></p>\n\n<pre><code>get ':url' =&gt; 'pages#show', :constraints =&gt; { :url =&gt; /.+/ }\n# with @page = Page.find_by_url(\"/\"+params[:url]) in my controller\n</code></pre>\n\n<p><strong>Option 2 -- Statically map routes to pages, and reload routes after each save</strong></p>\n\n<pre><code>if Page.table_exists? # Otherwise on rake db:migrate this file will be called and throw an error\n  Page.all.each do |page|\n    match page.url, :controller =&gt; 'pages', :action =&gt; 'show', :page_id =&gt; page.id\n  end\nend\n# Then after pages save it calls MyApp::Application.reload_routes!\n</code></pre>\n\n<p>Either way may work just as well.. just curious.</p>\n"},{"tags":["ruby-on-rails","exception-handling","model","save"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":585,"score":1,"question_id":3323459,"title":"Catching a database exception in a model.save or model.save! method?","body":"<p>I have two models that when saving certain types of data, it causes the database to throw an exception. I can convert the data before saving to avoid the exception, but the conversion is expensive and the exception happens very rarely.</p>\n\n<p>So, I was wondering if it's possible to create an override of the model.save method, and catch an exception that's thrown from the database? Would that work?</p>\n\n<p>For example:</p>\n\n<pre><code>def save\n  begin\n    super\n  rescue Exception =&gt; e\n    if e.is_a? ActiveRecord::StatementInvalid\n      # Do some processing and resave\n    end\n  end\nend\n</code></pre>\n\n<p>The reason why I'd like to do this is because I've already had to repeat a big chunk of handling code between the two models that have this problem, and also because I'd like to avoid the potential issue of calling save elsewhere later, but not adding in the exception handling code.</p>\n\n<p>For instance, when writing some test code and calling save directly, the error data threw an exception.</p>\n\n<p>So, a few questions:</p>\n\n<ol>\n<li>Is it even possible to catch an exception from within a save or save! method?</li>\n<li>After fixing the data, how do I attempt to save again? Do I just call super() again?</li>\n<li>Is there a better way of handling this? </li>\n</ol>\n\n<p>Thank you very much.</p>\n"},{"tags":["ruby-on-rails","audit-trail"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":3084,"score":5,"question_id":2465153,"title":"how to build audit trails in rails app","body":"<p>I have a small rails app. I want to put audit trail in it. Basically when a new user is added. it will insert a row in <code>AuditTrailUsers</code> table with the new user_id created and logged in users' user_id.</p>\n\n<p>I am thinking about using rails callback <code>before_save</code> for this. However, I am not sure if that will work. </p>\n\n<p>Imagine I have  <code>model/Users.rb</code> and <code>model/AuditTrailUser.rb</code></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    validates_presence_of :userid, :password\n        before_save :insert_audit\n\n  def self.authenticate(userid, password)\n        user = self.find_by_userid_and_password(userid, password)       \n    user\n  end\n\n  ##implement insert_audit\n\nend\n</code></pre>\n\n<p>How can I implement <code>insert_audit</code> so that it takes in a user id (of logged in user) so that it can pass it to AuditTrailUser when calling <code>AuditTrailUser.create(...)</code>. </p>\n\n<p>If I pass in logged in user's user id...then will I have to explicitly call <code>before_save</code> every where...</p>\n\n<p>I am new to rails. </p>\n"},{"tags":["ruby-on-rails","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13203171,"title":"Rails / Paperclip - skipping image processing","body":"<p>How can I  skip post processing based on a virtual attribute?</p>\n\n<p>My virtual attribute is always nil in the before_asset_post_process callback</p>\n\n<p>Create</p>\n\n<pre><code>attachment = Attachment.create(asset: File.open(file.png), :skip_thumb =&gt; 1)\n</code></pre>\n\n<p>Attachable model</p>\n\n<pre><code>class Attachment &lt; AR::Base\n attr_accessor :skip_thumb\n\n  has_attached_file :asset, :styles =&gt; lambda  { |attachment| { :thumb =&gt;  [\"100&gt;\", 'jpg'] ,\n                                                                       :thumb_big =&gt;   [\"200&gt;\", 'jpg']\n                                                                     }\n  before_asset_post_process :proceed_or_cancel\n\n  def proceed_or_cancel\n    #self.skip_thumb is always nil\n    if (self.skip_thumb.present?)\n      return false \n    end\n  end \n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13184781,"title":"Rails session value being deleted when deleting a line_item","body":"<p>This one has me a perplexed. I'm still a newbie with Rails so it may be simple.</p>\n\n<p>The situation:</p>\n\n<ol>\n<li>I can add items to the cart, no problem. Everything works fine the current_cart method resolves to the same cart each request. </li>\n<li>But as soon as I remove a line item from the cart, it works, the line item is deleted, but the<br>\nvariable \"session[:cart_id]\" becomes null, and a new cart gets<br>\ncreated when current_cart is called the next time.</li>\n</ol>\n\n<p>I'm using Devise so I'm not sure if that has something to do with it, or maybe the line item delete method is cascade deleting the session or something like that.</p>\n\n<p>The question is, can anyone help me understand why the session variable is becoming null after calling line_item delete?</p>\n\n<p>I've created a cart application, following along with Agile web development with rails. Firstly, here's the code for application controller to retrieve the current cart:</p>\n\n<pre><code>  private\n  def current_cart \n    Checkout::Cart.find(session[:cart_id])\n  rescue ActiveRecord::RecordNotFound \n    cart = Checkout::Cart.create \n    session[:cart_id] = cart.id\n    cart\n  end\n</code></pre>\n\n<p>Now the code for my line item controller</p>\n\n<blockquote>\n  <p>class Checkout::LineItemsController &lt; ApplicationController</p>\n  \n  <p># POST /checkout/line_items   # POST /checkout/line_items.json   def\n  create</p>\n\n<pre><code>@cart = current_cart\nproduct = Catalog::Product.find(params[:product_id])\napparel_event_log.info (product.to_json)\n\n\n@checkout_line_item = @cart.line_items.find_or_initialize_by_sku_id(product.part_number)\nnew_quantity = @checkout_line_item.quantity || 0\n@checkout_line_item.quantity = new_quantity+1\n@checkout_line_item.line_item_description = product.name\n@checkout_line_item.image = product.primary_image\n\nrespond_to do |format|\n  if @checkout_line_item.save\n    format.html { redirect_to @checkout_line_item.cart, notice: 'Line item was successfully created.' }\n    format.json { render json: @checkout_line_item, status: :created, location: @checkout_line_item }\n  else\n    format.html { render action: \"new\" }\n    format.json { render json: @checkout_line_item.errors, status: :unprocessable_entity }\n  end\nend   end\n</code></pre>\n  \n  <p># DELETE /checkout/line_items/1   # DELETE\n  /checkout/line_items/1.json   def destroy\n      Checkout::LineItem.delete(params[:id])</p>\n\n<pre><code>respond_to do |format|\n  format.html { redirect_to current_cart, notice: 'Line item removed.' }\n  format.json { head :no_content }\nend   end end\n</code></pre>\n</blockquote>\n\n<p>and also the code for the line items model</p>\n\n<pre><code>class Checkout::LineItem &lt; ActiveRecord::Base\n  before_save :default_values\n\n  attr_accessible :customer_update_date, :inventory_status, :line_item_color, :line_item_description, :line_item_size, :line_item_tagline, :line_item_total, :image, :quantity, :sku_id, :style_id, :tax, :tax_code, :timestamps, :unit_price, :cart, :product\n  belongs_to :cart\n  belongs_to :product, :class_name =&gt; 'Catalog::Product'\n  has_one :image, :class_name =&gt; 'Assets::Medium'\n\n  def default_values\n     Rails.logger.debug { \"Entering default values\" }\n     self.quantity ||= 0\n   end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","validation","email"],"answer_count":10,"favorite_count":21,"up_vote_count":48,"down_vote_count":0,"view_count":17874,"score":48,"question_id":1156601,"title":"What's the state of the art in email validation for Rails?","body":"<p>What are you using to validate users' email addresses, and why?</p>\n\n<p>I had been using <a href=\"http://github.com/Empact/validates%5Femail%5Fveracity%5Fof/tree/master\" rel=\"nofollow\"><code>validates_email_veracity_of</code></a> which actually queries the MX servers. But that is full of fail for various reasons, mostly related to network traffic and reliability. </p>\n\n<p>I looked around and I couldn't find anything obvious that a lot of people are using to perform a sanity check on an email address. Is there a maintained, reasonably accurate plugin or gem for this?</p>\n\n<p>P.S.: Please don't tell me to send an email with a link to see if the email works. I'm developing a \"send to a friend\" feature, so this isn't practical.</p>\n"},{"tags":["ruby-on-rails","rspec","gem","testunit"],"answer_count":4,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":1061,"score":7,"question_id":9884033,"title":"Ruby on Rails: Switch from test_unit to rspec","body":"<p>I'm going through a tutorial that has suggested using <code>rspec</code>, but I have already gone through a lot of default rails installation.  I really don't want to have to redo the installation at all.  Anyway, when I run</p>\n\n<pre><code>$ rails g integration_test named\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>  invoke  test_unit\n  create    test/integration/named_test.rb\n</code></pre>\n\n<p>When I run <code>bundle</code>, various <code>rspec</code> gems are listed, but <code>test_unit</code> is not.  The tutorial seems to have rails invoke <code>rspec</code> instead of <code>test_unit</code> without doing anything additional. How do I get rails to use <code>rspec</code> with the integration test generator command?</p>\n"},{"tags":["ruby-on-rails","ruby","metaprogramming"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":311,"score":2,"question_id":7591370,"title":"how to eval / constantize a string to a method, then pass arguments to it","body":"<p>Given:</p>\n\n<pre><code>s = \"foo_bar_path\"\n</code></pre>\n\n<p>How can I eval or constantize s, and pass arguments to it, such as my final result would be the equivalent of:</p>\n\n<pre><code>foo_bar_path(@myvar, @foobar)\n</code></pre>\n\n<p>I was trying <code>eval(s).send</code> but that doesn't seem to work. And constantize seems to only work on Classes?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","typhoeus","hydra"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13203722,"title":"undefined method `cache_getter' for Typhoeus::Hydra","body":"<p>I don't know why I get this error. Both methods are corrects.</p>\n\n<pre><code>hydra = Typhoeus::Hydra.new\n\n             hydra.cache_getter do |request|\n                Rails.cache.read(request.cache_key) rescue nil\n             end\n             hydra.cache_setter do |request|\n               Rails.cache.write(request.cache_key,request.response, expires_in: request.cache_timeout)\n             end\n</code></pre>\n\n<p>ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-darwin11.4.2]</p>\n\n<p>Rails 3.2.8</p>\n"},{"tags":["ruby-on-rails","header","nginx","expire"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13189108,"title":"NGINX expiry headers for rails 3.2 app","body":"<p>I'm trying to add expiry headers for a 3.2 apps on nginx 1.2.4, compiled with default support for headers module.</p>\n\n<p>My rule inside the server {} block is:</p>\n\n<pre><code>location /assets/ {\n    access_log   off;\n    expires      30d;\n</code></pre>\n\n<p>}</p>\n\n<p>I tried other reg exp based on file name extension that I found online, but all seem to do not work.\nWhat am I doing wrong?</p>\n\n<p>Reponse headers is:</p>\n\n<pre><code>Accept-Ranges   bytes\nAge 0\nCache-Control   proxy-revalidate\nConnection  Keep-Alive\nContent-Type    text/css\nDate    Fri, 02 Nov 2012 03:58:45 GMT\nLast-Modified   Fri, 02 Nov 2012 01:08:09 GMT\nVia 1.1 BC5-ACLD\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","ruby","ember.js"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13203755,"title":"How do I create customization tools like on Goodsie/flavors.me?","body":"<p>Goodsie.com and flavors.me has an in-browser user-friendly design tool to allow users to customize the look and feel of the user's personal page.  How would I go about making the same tool for my website?</p>\n\n<ul>\n<li>Change text color/font/size</li>\n<li>Change layout with a single click</li>\n<li>preview the changes dynamically as the user changes the different fields.</li>\n</ul>\n\n<p>I use ruby on rails/jquery.  Someone told me I have to use Ember.js or something similar to achieve this result but I don't know how to exactly go about tackling this problem.</p>\n\n<p>Questions:</p>\n\n<ul>\n<li>What technologies/features can most easily create such a toolset?</li>\n<li>How do I save each user's different customizations? (through database fields?)</li>\n</ul>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":887,"score":1,"question_id":2190471,"title":"Rails: checking modified fields","body":"<p>First, I've generated scaffold called 'item'</p>\n\n<p>I'd like to check which fields of the item are modified. and I've tried two possible attempts, those're not work tho.</p>\n\n<p>First Attempt!</p>\n\n<pre><code>def edit\n  @item = Item.find(params[:id])\n  @item_before_update = @item.dup\nend\n\ndef update\n  @item = Item.find(params[:id])\n  # compare @item_before_update and @item here, but @item_before_update is NIL !!!\nend\n</code></pre>\n\n<p>Second Attempt!\nI looked for the way passing data from view to controller and I couldn't.\n<em>edit.html.erb</em></p>\n\n<pre><code>&lt;% @item_before_update = @item.dup %&gt; # I thought @item_before_update can be read in update method of item controller. But NO.\n&lt;% params[:item_before_update] = @item.dup %&gt; # And I also thought params[:item_before_update] can be read in update mothod of item controller. But AGAIN NO\n\n&lt;% form_for(@item) do |f| %&gt;\n# omitted\n&lt;% end %&gt;\n</code></pre>\n\n<p>Please let me know how to solve this problem :(</p>\n"},{"tags":["ruby-on-rails","ruby","console","rubymine"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13201658,"title":"Rubymine using generator from rails console","body":"<p>I am currently using Rubymine for ruby on rails development. \nAfter enjoying the console for testing purposes, I want to use the console instead of the build-in Rails Generator for creating new models and such. </p>\n\n<p>But I can't figure out how to use the rails console (Tools | Run Rails Console) for generating -lets say- a new model \"user\".</p>\n\n<pre><code>rails generate model user name:string\n</code></pre>\n\n<p>gives me </p>\n\n<blockquote>\n  <p>NameError: undefined local variable or method `string' for main:Object</p>\n</blockquote>\n\n<p>I think I'm just missing something very basic here but I couldn't come up with a solution by myself after several tries :/\nI hope you can help me out.</p>\n\n<p>Greets</p>\n"},{"tags":["ruby-on-rails","renderpartial"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13203383,"title":"Call controller and reload partials","body":"<p>I have a page that renders multiple partials, including a Flash div that takes a while to start up.  </p>\n\n<p>I have a button that I want to re-hit the controller, pull down any new data, and reload all the partials in the page except for the Flash div.</p>\n\n<p>I've looked into rjs, but it seems like you need to add another route and controller method to accomplish this.  Is there a way to keep all the logic contained in the same page?</p>\n"},{"tags":["ruby-on-rails","package"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13202915,"title":"Rails application to standalone package including gem dependencies","body":"<p>Is it possible to make a package (like a Heroku slug) of a Rails application including all the gem dependencies?</p>\n\n<p>Then copy the package to a remote server, enter its directory and execute 'bundle exec rails s', 'bundle exec sidekiq' or whatever.</p>\n"},{"tags":["ruby-on-rails","ruby","gem","bundler"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2044,"score":2,"question_id":9038350,"title":"bundle install issue with libv8 and rails","body":"<p>I'm having issues with the <code>libv8</code> gem with ruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-darwin10.8.0]. gem install libv8 works fine and I have</p>\n\n<pre><code>gem 'therubyracer'\n</code></pre>\n\n<p>in my <code>Gemfile</code> and this has a dependency on <code>libv8</code> which is installed when I do a <code>bundle install</code>:</p>\n\n<pre>\n$ bundle exec gem list\n\n*** LOCAL GEMS ***\n\nactionmailer (3.1.3)\nactionpack (3.1.3)\n...\nlibv8 (3.3.10.4 x86_64-darwin-10)\n...\n\n</pre>\n\n<p>but when I run:</p>\n\n<pre>\n$ rails s\nCould not find libv8-3.3.10.4 in any of the sources\nRun `bundle install` to install missing gems.\n</pre>\n\n<p>it can't find <code>libv8</code> - is this is a 32/64 bit issue?   If so, how do I solve it?</p>\n"},{"tags":["ruby-on-rails","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13202728,"title":"Custom route in Rails for searching by field","body":"<p>I want to add a route to Rails app, so I can search by other field than id (and still be able to search by id)</p>\n\n<pre><code>def bycode\n  @plot = Plot.find_by_code(params[:code])\n  respond_to do |format|\n    if !plot.nil?\n      format.json {render json: @plot}\n    else\n      format.json\n    end\n  end\nend\n</code></pre>\n\n<p>and in routes.rb:</p>\n\n<pre><code>resources :plots do\n  get 'bycode/:code' =&gt; 'plots#bycode'\nend\n</code></pre>\n\n<p>in $ rake routes I get: </p>\n\n<pre><code>GET    /plots/:plot_id/bycode/:code(.:format) plots#bycode\n</code></pre>\n\n<p>I just want to be able to do</p>\n\n<pre><code>http://myapp.com/plots/bycode?code=codename\n</code></pre>\n\n<p>or something similar</p>\n\n<p>What am I missing?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13167357,"title":"Rails with two sided multi select jquery plugin, weird error","body":"<p>I'm using the jquery plugin \"Two Sided Multi Select\" as per here:\n<a href=\"http://www.stevefenton.co.uk/cmsfiles/assets/File/twosidedmultiselect.html\" rel=\"nofollow\">http://www.stevefenton.co.uk/cmsfiles/assets/File/twosidedmultiselect.html</a> </p>\n\n<p>Successfully displaying a regular multi select box using regular rails helpers with this code:</p>\n\n<pre><code>&lt;%= f.select(:expertise1, Tag.all.collect {|tag| [ tag.value, tag.value ] }, {}, {multiple: true, class: \"multiselect\"}) %&gt;\n</code></pre>\n\n<p>I have the jquery.twosidedmultiselector.js  file in my javascripts folder in assets, and see it in the page source. Jquery must be loaded as using it all over the place (rails 3.2.8) and is visible in the source. (1.8.2)</p>\n\n<p>However, when I add this to javascript (within $(document).ready(function()  ):</p>\n\n<pre><code>    $(\".multiselect\").twosidedmultiselect();\n</code></pre>\n\n<p>I get this error in the javascript console, which I have absolutely no idea what it means and how to fix it:</p>\n\n<pre><code>Uncaught TypeError: Object [object Object] has no method 'twosidedmultiselect'\n</code></pre>\n\n<p>Help!! Many thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13201604,"title":"undefined local variable or method `config' for #<Bundler::Dsl:0x7fe2598d56d8>","body":"<p>I'm following the following tutorial:</p>\n\n<p><a href=\"http://railscasts.com/episodes/188-declarative-authorization?view=comments\" rel=\"nofollow\">http://railscasts.com/episodes/188-declarative-authorization?view=comments</a></p>\n\n<p>Also Had a go at following the documentation for the gem on Git:</p>\n\n<p><a href=\"https://github.com/stffn/declarative_authorization\" rel=\"nofollow\">https://github.com/stffn/declarative_authorization</a></p>\n\n<p>But had the same outcome both times which is:</p>\n\n<pre><code>mark@ubuntu:~/RoR Projects/blog$ sudo rake gems:install\nInvalid gemspec in [/var/lib/gems/1.8/specifications/tilt-1.3.3.gemspec]: invalid date format in specification: \"2011-08-25 00:00:00.000000000Z\"\nrake aborted!\nundefined local variable or method `config' for #Bundler::Dsl:0x7fe2598d56d8&gt;\n</code></pre>\n\n<p>I have followed each tutorial to the letter but keep getting the same output so I'm guessing this is a system issue at my end?</p>\n"},{"tags":["ruby-on-rails","ruby","ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13201351,"title":"Rails render javascript shows text","body":"<p>I'm not sure if this behavior is normal or not, but when I do:</p>\n\n<pre>\nrender js: \"window.location.pathname = '#{new_user_session_path}';\"\n</pre>\n\n<p>in my controller, it briefly displays the text <code>window.location.pathname = '/user/sign_in';</code> before executing the line and redirecting successfully.</p>\n\n<p>Here's the full controller action:</p>\n\n<pre>\ndef vote_down\n    if user_signed_in?\n      current_user.vote_exclusively_against(@deal = Deal.find(params[:id]))\n\n      render :partial => 'deals/partials/interaction', \n        :locals => {:deal => @deal, :votes_for => @deal.votes_for, :votes_against => @deal.votes_against}\n    else\n      render js: \"window.location.pathname = '#{new_user_session_path}';\"\n      flash[:error] = 'Please sign in to vote.'\n    end\n  end\n</pre>\n\n<p>How do I prevent this from happening and directly render that template?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","module"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13202690,"title":"Rails doesn't load my module from lib","body":"<p>I have a bunch of custom classes in my Rails 3.2 app in lib folder: i.e. extending ActiveRecord, etc. It all works fine.</p>\n\n<p>However I'm trying to add a couple of custom methods to FileUtils, i.e.</p>\n\n<pre><code>module FileUtils\n  def last_modified_file(path='.')\n     # blah ...    \n  end\nend\n</code></pre>\n\n<p>I put it in lib/file_utils.rb\nIn my application.rb I have</p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib)\n</code></pre>\n\n<p>My other custom classed are loaded but not the module.</p>\n\n<p>I read (<a href=\"http://stackoverflow.com/questions/3356742/best-way-to-load-module-class-from-lib-folder-in-rails-3\">Best way to load module/class from lib folder in Rails 3?</a> ) that I'm supposed to define a class inside module in order for Rails to pick it up and according to FileUtils.class  - it should be Object &lt; BasicObject.</p>\n\n<p>So I tried</p>\n\n<pre><code>module FileUtils\n  class Object \n    def last_modified_file(path='.')\n       # blah ...    \n    end\n  end\nend\n</code></pre>\n\n<p>But that doesn't work either.</p>\n\n<p>However when I fire up irb and just paste my code which effectivly puts my new code inside object and reinclude my module - it works fine.</p>\n\n<p>Whaat amd I missing here?</p>\n"},{"tags":["ruby-on-rails","devise","omniauth","cas"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":11215636,"title":"Is it possible to store OmniAuth Identity information in the existing User model?","body":"<p>I am currently using OmniAuth for its' CAS strategy which is the default method of authentication in my app. I want to provide an additional method of authentication with user_name and password through the OmniAuth Identity strategy. I have read in its' documentation that it is meant to be used with a separate model and not the existing model but I was wondering if it would break if I tried pointing it to the existing current model. </p>\n\n<p>The reason why I want to do it like this is that my app depends on the user filling out a registration form that populates the User model. Currently the CAS strategy just authenticates the user and signs them in if they already exist in the database and points them to users#new where they fill out their information. </p>\n\n<p>If I were to implement OmniAuth Identity I would require new users to fill out a form with their username and password first to authenticate them and then redirect them to the User model form. If I were a user this would annoy me. I know it would be a one-time thing only but I would like to avoid it if possible. Is there a good way of combining these two steps somehow?</p>\n\n<p>I know that Devise stores password info in the current User model but it is more feature heavy than I need it to be so I would prefer to stick with OmniAuth.</p>\n\n<p>Sorry if the answer is obvious I am pretty new to rails.</p>\n"},{"tags":["ruby-on-rails","routes","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13201414,"title":"Ruby on Rails : non-resourceful route working,but haml page fails","body":"<p>So I have the following code in my routes.rb file:</p>\n\n<pre><code>match \"/movies/:id/find_similar_movies\", :to =&gt; \"movies#similar\", :as =&gt; \"find_similar_movies\"\n</code></pre>\n\n<p>then in a haml page I have the following:</p>\n\n<pre><code>= link_to 'Find Movies With Same Director', find_similar_movies_path(:id=&gt;@movie.id)\n</code></pre>\n\n<p>then in my controller I have:</p>\n\n<pre><code>def similar\n    movie=Movie.find_by_id([params(:id)])\n    @movie_title=movie.title\n    @similar_movies=Movie.find_all_by_director(movie.director)\n  end\n</code></pre>\n\n<p>and in the similar.html.haml I write:</p>\n\n<pre><code>%h2 Similar movies with #{@movie_title}\n%ul\n- @similar_movies.each do |movie|\n  %li = movie\n= link_to 'Back to movie list', movies_path\n</code></pre>\n\n<p>when I press the <code>= link_to 'Find Movies With Same Director', find_similar_movies_path(:id=&gt;@movie.id)</code></p>\n\n<p>I get:</p>\n\n<p>wrong number of arguments (1 for 0)</p>\n\n<p>Rails.root: /home/ubuntu/hw4_rottenpotatoes\nApplication Trace | Framework Trace | Full Trace</p>\n\n<p>app/controllers/movies_controller.rb:10:in `similar'</p>\n\n<p>Request</p>\n\n<p>Parameters:</p>\n\n<p>{\"id\"=>\"6\"}</p>\n\n<p>What's wrong?Thanks for your time...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","omniauth","railscasts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12252657,"title":"Setting up Omniauth Identity to connect with Existing User Model","body":"<p>I was going through <a href=\"http://railscasts.com/episodes/304-omniauth-identity\" rel=\"nofollow\">this Railscast</a> to setup Omniauth Identity, but I was unclear about one part. He creates a new Model called Identity which then holds the email, name and password fields. However, I already have a user model with those fields, so can I just connect Identity to it? How would I do that?</p>\n"},{"tags":["ruby-on-rails","ruby","hash","default-value"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":66,"score":-1,"question_id":12071653,"title":"Setting default values for a hash in ruby","body":"<p>I have a nested hash like :-</p>\n\n<pre><code>profile:\n  status:                               \n     nil: 3    \n     x: 2   \n\n  priority:\n     x: 2\n     y: 2\n</code></pre>\n\n<p>Is there a way of setting the default value for status like:-</p>\n\n<pre><code>profile:\n  status:\n    default:0\n    nil: 3\n    x:2\n</code></pre>\n\n<p>I dont want solutions like these or any other method :-</p>\n\n<pre><code>h = Hash.new(\"Go Fish\")\nh.default = \"Go fish\"\n</code></pre>\n\n<p>coz I have a yml file loaded with configs hash and other mapping hashes, like the status, priority mapping above. So my script extracts the configs as well as the other hash values from these yml and use them. Now for the status and priority mapping, I need this status and priority subhash to return a value if it doesnt find any matching symbol(i.e,. if no such mapping exists) inside this hash. I can set that default value in the code using the other methods. But the whole point is I want any layman to edit this yml and be able run my script. Hence I want the default values to be set here. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13202509,"title":"Sleeping in controller","body":"<p>In my Rails controller method, which is executed when the user submits a form, there is a Ruby code <code>sleep(60)</code>, telling it to wait for a minute. One user submits the form, and while the execution is \"sleeping\", another user submits the form. Will the second user have to wait for the first user to finish, or will the execution of the controller start for the second user?</p>\n"},{"tags":["ruby-on-rails","caching","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13198799,"title":"Caching Frequently Used ActiveRecord Models","body":"<p>I'm using User model on every request to check for permission, it generate some query to fetch user basic model, its roles, its rights,... . I want to cache it (keep all users data in memory) and update this cache on every save/destroy as below. Is there any better way for caching and to apply such caching on other wanted models.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :email, :passwd\n  has_many :roles\n\n  class &lt;&lt; self; attr_accessor :users end\n\n  after_save     :reload\n  after_destroy  :reload\n\n  def self.reinit\n    @users = Hash.new\n    User.all.each {|k| @users[k.email] = UserCache.new(k.email, k.roles)}\n  end\n\n  private\n    def reload\n      User.reinit\n    end\n\n  User.reinit\n\nend\n\nclass UserCache\n  attr_accessor :email, :roles\n\n  def initialize( usr, rl)\n     @email = usr\n     @roles = rl\n  end\nend\n</code></pre>\n\n<p>These are my concerns:</p>\n\n<ol>\n<li>If using multiple server mode, how reload of cache notify to other server</li>\n<li>How will be association update and after_save relation</li>\n</ol>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","cucumber","cardinality","ordinals"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":604,"score":1,"question_id":5907084,"title":"is there an ordinal to cardinal function in ruby or rails?","body":"<p>I'm trying to find a better way in expressing my cucumbers so I am looking for an ordinal to cardinal function that converts this:</p>\n\n<pre><code>When I fill up the first passenger field\nThen I should see the passenger list update with the first passenger details\nWhen I follow \"Add Another Passenger\"\nThen I should see a second passenger field\nWhen I fill up the second passenger field\nThen I should see the passenger list update with the second passenger details\n</code></pre>\n\n<p>into something more dynamic(instead of creating separate steps for each line)</p>\n\n<p>here's a sample of my web steps</p>\n\n<pre><code>When /^I fill up the first passenger field$/ do\n  fill_in(\"booking_passengers_attributes_0_first_name\", :with =&gt; \"Blah\")\n  fill_in(\"booking_passengers_attributes_0_last_name\", :with =&gt; \"blah\")\n  select(\"5' to 6'\", :from =&gt; \"booking_passengers_attributes_0_height\")\n  select(\"100 to 150lbs\", :from =&gt; \"booking_passengers_attributes_0_weight\")\nend\n\nWhen /^I fill up the second passenger field$/ do\n  fill_in(\"booking_passengers_attributes_1_first_name\", :with =&gt; \"Wee\")\n  fill_in(\"booking_passengers_attributes_1_last_name\", :with =&gt; \"Sir\")\n  select(\"5' to 6'\", :from =&gt; \"booking_passengers_attributes_1_height\")\n  select(\"150 to 200lbs\", :from =&gt; \"booking_passengers_attributes_1_weight\")\nend\n</code></pre>\n\n<p>See that 0 and 1? I wish to convert \"first\" to a cardinal number so i can just substitute. You can also just suggest a better way to declare the cukes :)</p>\n\n<p><strong>UPDATED ANSWER</strong>\nI am in the middle of refactoring but basically I used 1st instead of first and used to_i on that.</p>\n\n<pre><code>When /^I fill up the \"([^\"]*)\" passenger field$/ do |id|\n  input_id = id.to_i - 1\n  fill_in(\"booking_passengers_attributes_#{input_id}_first_name\", :with =&gt; id)\n  fill_in(\"booking_passengers_attributes_#{input_id}_last_name\", :with =&gt; \"Passenger\")\n  select(\"5' to 6'\", :from =&gt; \"booking_passengers_attributes_#{input_id}_height\")\n  select(\"100 to 150lbs\", :from =&gt; \"booking_passengers_attributes_#{input_id}_weight\")  \nend\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13201789,"title":"Rails where on query result","body":"<p>I have a model- <code>Link</code> - that has many hits. What I'm trying to do is aggregate data on hits per hour over time from a database table - <code>hits</code> - with columns <code>year</code>, <code>month</code>, <code>day</code>, and <code>hour</code>.</p>\n\n<p>Everything is working fine, but when I run the code below, I end up with almost <strong>1,000 queries on the database</strong>, which seems quite excessive.</p>\n\n<pre><code>#before iteration\n@hits = @link.hits.group('year, month, day, hour')\n  .order('year ASC, month ASC, day ASC, hour ASC')\n  .select('year, month, day, hour, count(*) as hits')\n\n\n#inside iteration\n\n#Line breaks are included here for easy reading\nhits_per_hour =\n  @hits.where(\n    :year =&gt; t.year, \n    :month =&gt; t.month,\n    :day =&gt; t.day,\n    :hour =&gt; t.hour\n  ).map(&amp;:hits).first || 0\n</code></pre>\n\n<p>Here <code>t</code> is a <code>Time</code> object that iterates in steps of 1 hour since the first hit a link received.</p>\n\n<p>I would think that rails would store the query result instead of re-querying every time. I also haven't been able to find anything about caching the query results or anything. Am I just missing something completely, or is this really the easiest way?</p>\n\n<p>Here is a sample of what the queries look like (this is what I see in my logs in blocks of a thousand):</p>\n\n<pre><code>SELECT year, month, day, hour, count(*) as hits\nFROM `hits`\nWHERE\n  `hits`.`link_id` = 1 AND\n  `hits`.`year` = 2012 AND\n  `hits`.`month` = 11 AND\n  `hits`.`day` = 2 AND\n  `hits`.`hour` = 14\nGROUP BY year, month, day, hour\nORDER BY year ASC, month ASC, day ASC, hour ASC\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13185910,"title":"Using Rails and Remotipart: Where does the uploaded file go?","body":"<p>I am trying out the Remotipart gem for uploading files via Ajax within my Rails app. I can see that the image data is being POSTed, but how do I take convert that data into an actual image on the server?</p>\n\n<p>Seems like it should be easy, like I should be able to specify a default location where the images should be placed, but I can't find any reference that describes how to handle this.</p>\n\n<p>I've downloaded and run <a href=\"https://github.com/JangoSteve/Rails-jQuery-Demo/tree/remotipart\" rel=\"nofollow\">the test app</a> but it only returns the file name to the screen. As far as I can tell the file isn't saved anywhere.</p>\n\n<p>I'm sure I'm missing something obvious, but what?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","redirect","rspec","rspec2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13201446,"title":"Rspec redirect to testing","body":"<p>In my controller when an user creates a new post, he/she is redirected to the page that contains the newly created post. I'm wanting to create a test in rspec to cover this redirect but am having trouble with it. Specifically, I want to know what to write in the refirst_to argument. Here is the controller code below..</p>\n\n<pre><code>def create\n@micropost = Micropost.new(params[:micropost])\n respond_to do |format|\n  if @micropost.save\n    format.html {redirect_to @micropost}\n  else\n    format.html {render action: 'edit'} \n  end\nend\nend\n</code></pre>\n\n<p>Here is the rspec test...</p>\n\n<pre><code>before do\n  @params = FactoryGirl.build(:micropost)\nend\n\nit \"redirects to index\" do\n  #clearly @params.id doesn't work. its telling me instead of a redirect im getting a \n  #200\n  #response.should redirect_to(@params.id)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13201146,"title":"unable to create new route","body":"<p>I am using a controller method <code>search_same_director</code>. The link code from <code>show.html.haml</code>:</p>\n\n<pre><code>= link_to 'Find Movies With Same Director','/movies/search_same_director', :director=&gt;@movie.director\n</code></pre>\n\n<p>I have added the following line to <code>routes.rb</code></p>\n\n<pre><code>match '/movies/search_same_director'=&gt;'movies#search_same_director'\n</code></pre>\n\n<p>But the link routes the request to the show action. How can I correct this?</p>\n"},{"tags":["ruby-on-rails","redirect","routes"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13201684,"title":"Failing Redirection and How to Inspect Named Route Helpers","body":"<p>I have a singular resource and a plural controller: PeopleController and resource :person in the routes file.  In my controller create action, I have a redirect_to @person, which is supposed to redirect to the show action for the just-created person object.   In my controller test, I assert that response.should redirect_to(@person).  It seems straightforward to me, but when I run the spec, I get this error: </p>\n\n<pre><code> Failure/Error: post :create \n NoMethodError: \n   undefined method `people_url' for #&lt;PeopleController:0x00000002d7d988&gt;\n</code></pre>\n\n<p>It appears that the redirect in the create action is trying to go to an index action, which doesn't (and shouldn't) exist for a singular resource.</p>\n\n<p>The routing table is simple: </p>\n\n<pre><code>              person POST   /person(.:format)              people#create\n          new_person GET    /person/new(.:format)          people#new\n         edit_person GET    /person/edit(.:format)         people#edit\n                     GET    /person(.:format)              people#show\n                     PUT    /person(.:format)              people#update\n                     DELETE /person(.:format)              people#destroy\n</code></pre>\n\n<p>I understand why I'm getting the undefined method error: there is no people_url for a singular resource, only a person_url.  I'm confused about why the redirect_to @person is trying to invoke people_url to begin with.  Shouldn't it default to using the person_url named route, and pass the id of the newly saved person object? I can get the test to pass by using redirect_to person_path(@person), but why is this different from what redirect_to @person is supposed to return?  </p>\n\n<p>What would be the best way to inspect the constructed URLs from the named routes in helper methods?  Besides writing failing tests of course.  That I'm really good at already :-). </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sunspot","sunspot-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13201284,"title":"how to get value selected by using select_tag with options_from_collection_for_select and pass it to controller","body":"<p>I have built a form search like this:</p>\n\n<pre><code>&lt;%= form_tag({ controller: 'questions', action: 'search_topic' }, method: 'get') do %&gt;\n  &lt;%= select_tag 'search_topic', options_from_collection_for_select(current_user.get_topics, :id, :name) %&gt;\n  &lt;%= submit_tag \"Search\", name: nil, class: 'btn' %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>I want to search all questions of a topic selected from select box, i used sunspot to help for search, so now how can i pass value select from select box to controller for search, i used below code to pass a params[:search]:  </p>\n\n<pre><code>&lt;%= select_tag 'search_topic', options_from_collection_for_select(current_user.get_topics, :id, :name), params[:search] %&gt;\n</code></pre>\n\n<p>but it has error: </p>\n\n<pre><code>undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>this is my controller:</p>\n\n<pre><code>def search_topic\n  @search = Question.search do\n    with(:topic_id, params[:search])\n    paginate page: 1, per_page: 10\n  end\n\n  @questions = @search.results\n  render 'index'\nend\n</code></pre>\n\n<p>so, how can i pass value selected from select box on form to controller for search?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13200361,"title":"Rails: Locked DB? - SQLite3::BusyException:","body":"<p>I keep getting the error message:</p>\n\n<pre><code>SQLite3::BusyException: database is locked: INSERT INTO \"users\" (\"created_at\", \"email\", \"name\", \"password_digest\", \"updated_at\") VALUES (?, ?, ?, ?, ?)\n</code></pre>\n\n<p>When I'm trying to execute the code:</p>\n\n<pre><code>@user = User.new(:name =&gt; \"User1\", :email =&gt; \"email@gmail.com\", :password =&gt; \"password\", :password_confirmation =&gt; \"password\")\n@user.save\n</code></pre>\n\n<p>Is there an issue with calling save after creating the user? Do I need a timeout? If so, how do I set one up/grab a database variable.</p>\n\n<p>I don't have a clue what is going wrong here. The User variable is being created just fine as I can output the attributes of the @user variable if I remove the save function. I would just assume that I'm doing something terribly wrong. I get that I shouldn't hard code a user, but I'm doing it for testing purposes.</p>\n\n<p>What is going on here?</p>\n\n<p>EDIT:</p>\n\n<p>I have tried to <code>drop</code> my database, but it is complaining that the sqlite3 files are missing. However, when I navigate to the exact path it complains about, the files are being listed under <code>ls</code>.</p>\n\n<p>I am assuming this is my problem. What does this mean?</p>\n"},{"tags":["php","ruby-on-rails","ruby","forms","zend-form"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":10460537,"title":"Zend_Form equivalent for ruby / rails","body":"<p>Does anyone know if it there exist any Ruby or rails equivalent of zend_form? </p>\n\n<p>I'm asking because I'm porting a project that I made in PHP with zend framework over to rails. This an event registration/form builder which basically means I need to generate forms from fields in a database. Zend_Form makes creating forms programmaticly very easy with validation and the works. Now I need to make this in rails but I can't see how it can be done any other way than making it all from scratch.\nAny ideas on the matter is very much appreciated. :)</p>\n\n<p>If there's nothing like zend_form for rails/ruby is anybody interested in making it with me? I'm very new to rails and Ruby so i could very much need the help. :)</p>\n"},{"tags":["ruby-on-rails","rake","ruby-debug"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13145943,"title":"Debugging rake tasks","body":"<p>I added <code>debugger</code> and <code>require 'ruby-debug'</code> in my task to debug it.</p>\n\n<p>When I run my task from the console, it does hit the <code>debugger</code>, but doesn't let me inspect any variables. For example, if there's a line in my task :</p>\n\n<pre><code>my_var = 1 + 2\n</code></pre>\n\n<p>and I type <code>my_var</code> or <code>my_var.inspect</code>, while debugging, it says :</p>\n\n<pre><code>*** Unknown command: \"my_var\".  Try \"help\".\n</code></pre>\n\n<p>What am I missing ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","development-environment"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13201243,"title":"Initializers not called in development environment when class changes","body":"<p>I have a an initializer in my Rails 3.2 app that includes modules at startup based on a configuration file.  It looks something like this:</p>\n\n<pre><code>Array(Settings.site.authentications).map(&amp;:to_sym).each do |sym|\n  AuthAuth.class_eval do\n    include Object.const_get(sym)\n  end\nend\n\nArray(Settings.site.authorizations).map(&amp;:to_sym).each do |sym|\n  AuthAuth.class_eval do\n    include Object.const_get(sym)\n  end\nend\n\n# This exception is never raised when I start the server.  So the includes \n# appear to be working correctly.\nraise \"method not found!\" unless AuthAuth.new.respond_to? :dynamically_included_method\n</code></pre>\n\n<p><code>AuthAuth</code> is used in my <code>ApplicationController</code> in a <code>:before_filter</code> to ensure that users are authenticated and authorized.  It works fine and suites the requirement that I have a configurable way of setting authorization and authentication logic on a per-site basis.</p>\n\n<p>I've noticed, however, that when I am running the server in development mode if I make a code change to any class in the application, <code>AuthAuth</code> reverts to it's default behavior without the included modules.</p>\n\n<p>Is there an appropriate place to include this code other than an initialization file?  </p>\n\n<p>This is a relatively minor issue.  It's easy enough to restart the development server after each code change, but I'm curious. </p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12981749,"title":"How can I use JSON data to feed two different views?","body":"<p>I have rails application that has two view ports that uses the same data. I can get the data in JSON format like this:</p>\n\n<pre><code>$.read(\n    '/en/search/fetch_companies',\n    { current_location_lat: 72, current_location_lng: 10, bounding_box: 10 },\n    function (response) {\n        for (var i = 0; i &lt; response.length; i++) {\n            var markerPosition = new google.maps.LatLng(response[i].latitude, response[i].longitude);\n            var marker = new google.maps.Marker({\n                position:markerPosition,\n                map:map,\n                title:\"AJAX!\"\n                });\n        }\n    }\n);\n</code></pre>\n\n<p>This code above creates Markers on a Google Maps. The second view port is a simple table. </p>\n\n<pre><code>  &lt;% @companies.each do |company| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;address&gt;\n          &lt;strong&gt;&lt;%= company.name %&gt;&lt;/strong&gt;&lt;br&gt;\n          &lt;%= company.address %&gt;\n          &lt;br&gt;\n          &lt;%= company.city %&gt;,&lt;%= company.province %&gt;\n          &lt;br&gt;\n          &lt;%= company.postalcode %&gt;\n        &lt;/address&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;%= link_to book_appointment_path(:choose_service, :company_id =&gt; company.id), :class =&gt; \"btn btn-info btn-center-col\" do %&gt;\n          &lt;i class=\"icon-time icon-white\"&gt;&lt;/i&gt; Book Appointment\n        &lt;% end %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>For now I've been sending two requests to get the JSON data. One for the table view and one for the Map. This is not acceptable for me. The Map and the Table need to be fed the same data at once, but since Rails is resolved on the server I cannot fill the table with the JSON data.</p>\n\n<p>Do anyone knows about some a table that plays nicely with Rails, Ajax and pagination?</p>\n"},{"tags":["ruby-on-rails","capistrano","bundler"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13201212,"title":"Verify rails deployment with capistrano - rollback on failure to verify","body":"<p>We want to verify that the rails app deployed has some expected content.  If it doesn't the deploy should rollback to the previous deployment.  For example:</p>\n\n<pre><code>desc \"Verify the application has expected content.\"\ntask :verify_deploy do\n    transaction do\n        on_rollback { deploy.rollback }\n        # Query the deployed UI, first to prompt apache/passenger to reload it,\n        # then to verify that it has expected content (in the footer).\n        curl_cmd = \"curl -s #{DEPLOY_URL}\"\n        grep_cmd = \"grep -q -F 'Expected Content'\"\n        run \"#{curl_cmd} &gt; /dev/null\"    # prompt the app reload\n        run \"#{curl_cmd} | #{grep_cmd}\"  # test for expected content\n        deploy.cleanup\n    end\nend\n\nbefore \"deploy:create_symlink\", \"deploy:web:disable\"\nafter \"deploy:restart\", \"deploy:web:enable\"\nafter \"deploy:web:enable\", :verify_deploy\n</code></pre>\n\n<p>The above seems to work.  When the 'Expected Content' string is changed to anything that will not match, the <code>:verify_deploy</code> task fails and it kicks off a rollback.  For example,</p>\n\n<pre><code>  * executing \"curl -s http://www.google.com/ | grep -q -F 'abcdefghi'\"\n    servers: [\"abc.xyz.com\"]\n    [abc.xyz.com] executing command\n    command finished in 198ms\n*** [:verify_deploy] rolling back\nfailed: \"sh -c 'curl -s http://www.google.com/ | grep -q -F '\\\\''abcdefghi'\\\\'''\" on abc.xyz.com\n</code></pre>\n\n<p>The trouble is that the rollback doesn't do anything.  Why doesn't it do anything?  The capistrano deploy task seems to be run in a transaction, which is committed prior to the  <code>deploy:restart</code> task.  We can't test the application content until after the  <code>deploy:restart</code> task.  How can we rollback after the deploy transaction is already committed?</p>\n"},{"tags":["ruby-on-rails","ruby","nomethoderror"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13198892,"title":"undefined method `model_name' for NilClass:Class Rails","body":"<p>I've got problem with NoMethodError in Rails.</p>\n\n<p><img src=\"http://i.stack.imgur.com/6wiuy.png\" alt=\"Error screen\"></p>\n\n<p>MODELS:\nissue:</p>\n\n<pre><code>class Issue &lt; ActiveRecord::Base\n   attr_accessible :description, :estimate, :label, :status, :title, :project_id\n   belongs_to :project\n   validates :title, :presence =&gt; true\n   validates :estimate, :numericality =&gt; {:greater_than_or_equal_to =&gt; 0.1}\n end\n</code></pre>\n\n<p>project:</p>\n\n<pre><code> class Project &lt; ActiveRecord::Base\n   attr_accessible :description, :title\n   has_many :issues, :dependent =&gt; :destroy\n   accepts_nested_attributes_for :issues, :allow_destroy =&gt; :true\n end\n</code></pre>\n\n<p>issue controller:</p>\n\n<pre><code> class IssuesController &lt; ApplicationController\n        # GET /issues\n        # GET /issues.json\n        def index\n          @issues = Issue.all\n\n          respond_to do |format|\n            format.html # index.html.erb\n            format.json { render :json =&gt; @issues }\n          end\n        end\n\n        # GET /issues/1\n        # GET /issues/1.json\n        def show\n          @issue = Issue.find(params[:id])\n\n          respond_to do |format|\n            format.html # show.html.erb\n            format.json { render :json =&gt; @issue }\n          end\n        end\n\n        # GET /issues/new\n        # GET /issues/new.json\n        def new\n          @issue = Issue.new\n          #@issue = @project.issues.new(params[:issue])\n\n          respond_to do |format|\n            format.html # new.html.erb\n            format.json { render :json =&gt; @issue }\n          end\n        end\n\n        # GET /issues/1/edit\n        def edit\n          @issue = Issue.find(params[:id])\n        end\n\n        # POST /issues\n        # POST /issues.json\n        def create\n          @project = Project.find(params[:project_id])\n          @issue = @project.issues.create(params[:issue])\n          redirect_to project_path(@project)\n          #@issue = @project.issues.new(params[:issue])\n          #@issue = Issue.new(params[:issue])\n\n          # respond_to do |format|\n          #   if @issue.save\n          #     format.html { redirect_to @issue, :notice =&gt; 'Issue was successfully created.' }\n          #     format.json { render :json =&gt; @issue, :status =&gt; :created, :location =&gt; @issue }\n          #   else\n          #     format.html { render :action =&gt; \"new\" }\n          #     format.json { render :json =&gt; @issue.errors, :status =&gt; :unprocessable_entity }\n          #   end\n          # end\n        end\n\n        # PUT /issues/1\n        # PUT /issues/1.json\n        def update\n          @issue = Issue.find(params[:id])\n\n          respond_to do |format|\n            if @issue.update_attributes(params[:issue])\n              format.html { redirect_to @issue, :notice =&gt; 'Issue was successfully updated.' }\n              format.json { head :no_content }\n            else\n              format.html { render :action =&gt; \"edit\" }\n              format.json { render :json =&gt; @issue.errors, :status =&gt; :unprocessable_entity }\n            end\n          end\n        end\n\n        # DELETE /issues/1\n        # DELETE /issues/1.json\n        def destroy\n          @project = Project.find(params[:project_id])\n          @issue = @project.issues.find(params[:id])\n          #@issue = Issue.find(params[:id])\n          @issue.destroy\n          redirect_to project_path(@project)\n\n          # respond_to do |format|\n          #   format.html { redirect_to issues_url }\n          #   format.json { head :no_content }\n          # end\n        end\n      end\n</code></pre>\n\n<p>project controller:</p>\n\n<pre><code> class ProjectsController &lt; ApplicationController\n    # GET /projects\n    # GET /projects.json\n    def index\n      @projects = Project.all\n\n      respond_to do |format|\n        format.html # index.html.erb\n        format.json { render :json =&gt; @projects }\n      end\n    end\n\n    # GET /projects/1\n    # GET /projects/1.json\n    def show\n      @project = Project.find(params[:id])\n\n      respond_to do |format|\n        format.html # show.html.erb\n        format.json { render :json =&gt; @project }\n      end\n    end\n\n    # GET /projects/new\n    # GET /projects/new.json\n    def new\n      @project = Project.new\n\n      respond_to do |format|\n        format.html # new.html.erb\n        format.json { render :json =&gt; @project }\n      end\n    end\n\n    # GET /projects/1/edit\n    def edit\n      @project = Project.find(params[:id])\n    end\n\n    # POST /projects\n    # POST /projects.json\n    def create\n      @project = Project.new(params[:project])\n\n      respond_to do |format|\n        if @project.save\n          format.html { redirect_to @project, :notice =&gt; 'Project was successfully created.' }\n          format.json { render :json =&gt; @project, :status =&gt; :created, :location =&gt; @project }\n        else\n          format.html { render :action =&gt; \"new\" }\n          format.json { render :json =&gt; @project.errors, :status =&gt; :unprocessable_entity }\n        end\n      end\n    end\n\n    # PUT /projects/1\n    # PUT /projects/1.json\n    def update\n      @project = Project.find(params[:id])\n\n      respond_to do |format|\n        if @project.update_attributes(params[:project])\n          format.html { redirect_to @project, :notice =&gt; 'Project was successfully updated.' }\n          format.json { head :no_content }\n        else\n          format.html { render :action =&gt; \"edit\" }\n          format.json { render :json =&gt; @project.errors, :status =&gt; :unprocessable_entity }\n        end\n      end\n    end\n\n    # DELETE /projects/1\n    # DELETE /projects/1.json\n    def destroy\n      @project = Project.find(params[:id])\n      @project.destroy\n\n      respond_to do |format|\n        format.html { redirect_to projects_url }\n        format.json { head :no_content }\n      end\n    end\n  end\n</code></pre>\n\n<p>And it writes undefined method `model_name' for NilClass:Class when I want to show some project. Please, can you help me? Thanks</p>\n"},{"tags":["python","ruby-on-rails","django"],"answer_count":7,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":544,"score":3,"question_id":1783431,"title":"Python Vs Ruby On Rails : on Size","body":"<p>I am planning to do a small web application that will be distributed as a single installable. I have plans to develop this application in either Python/Django or Ruby On Rails. (I am a Java/C++ programmer, hence both these languages are new to me). </p>\n\n<p>My main concern is about the size and simplicity of final installable (say setup.exe). I want it to be small in size and also should be able to pack all required components in it. </p>\n\n<p>Which one among Python/Django and Ruby On Rails is suitable for me?  </p>\n"},{"tags":["ruby-on-rails","md5","assets","digest"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":472,"score":3,"question_id":10045892,"title":"Rails compiles assets both with and without md5 hash, why?","body":"<p>I'm relatively new to RoR and I'm curious about why Rails compiles assets both with and without md5 hash for production?</p>\n\n<p>I run <code>bundle exec rake assets:clean</code> then <code>bundle exec rake assets:precompile</code></p>\n\n<p>My production.rb file:</p>\n\n<pre><code>MyApp::Application.configure do\n\n  # Code is not reloaded between requests\n\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n\n  config.consider_all_requests_local       = false\n\n  config.action_controller.perform_caching = true\n\n  # Disable Rails's static asset server (Apache or nginx will already do this)\n\n  config.serve_static_assets = false\n\n  # Compress JavaScripts and CSS\n\n  config.assets.compress = true\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n\n  config.assets.digest = true \n\n  config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  config.assets.precompile += %w(tos.js, tos.css)\n\n  config.i18n.fallbacks = true\n\n  config.active_support.deprecation = :notify\n\nend\n</code></pre>\n\n<p>My application works with files with hashes in their names and it's the way it should be in my case :)</p>\n\n<p>So I have two questions here:</p>\n\n<p>1) Why is it happening when compiled?</p>\n\n<blockquote>\n  <p>Rails compiles assets both with and without md5 hash for production</p>\n</blockquote>\n\n<p>2) What are these files (without hashes) for?</p>\n\n<p>Maybe I don't get something, so please could someone explain.</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","process"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13182571,"title":"How would I spawn Heroku workers to divide and conquer list of keywords?","body":"<p>My Heroku Rails app maintains a large frequently-changing list of keywords.</p>\n\n<p>I want to spawn up N amount of workers that will equally divide up this list of keywords and work on them until they are restarted (I restart them every time the list of keywords changes). Once restarted, they divide up the keywords again and churn away.</p>\n\n<p><strong>For example</strong>: Let's say I have 1,000 keywords.</p>\n\n<ul>\n<li>If I spawn up 1 worker, that worker will take 1,000 keywords.</li>\n<li>If I spawn up 10 workers, each worker will take 100 keywords.</li>\n<li>If I spawn up 1,000 workers, each worker will take 1 keyword.</li>\n</ul>\n\n<p>Workers basically just open a connection with Twitter for their set of keywords and process incoming tweets that match those keywords.</p>\n\n<p><strong>Any ideas on how to set up the Procfile and delegate X keywords between N workers?</strong></p>\n\n<hr>\n\n<p>Here's a naive/pseudo manual approach just for demonstration. However, I want to be able to spawn up an arbitrary amount of workers that will automatically split the keywords amongst themselves.</p>\n\n<p>Procfile:</p>\n\n<pre><code>keywordstreamer0: bundle exec ruby keyword_streamer.rb 0\nkeywordstreamer1: bundle exec ruby keyword_streamer.rb 1\n</code></pre>\n\n<p>keyword_streamer.rb</p>\n\n<pre><code>streamer_id = ARGV.shift # 0 or 1\n\n# Split all keywords into array of two groups and take the group\n# that matches this worker id (so the two workers take different groups)\nkeywords = Keyword.all.split_into_groups_of(2)[streamer_id]\n\n# Example work loop\nTwitterStream.track(keywords).each do |incoming_tweet|\n  process(incoming_tweet)\nend\n</code></pre>\n\n<p>Then, in my app, when I need to restart my keyword workers:</p>\n\n<pre><code>[\"keywordstreamer0\", \"keywordstreamer1\"].each do |streamer|\n  restart(streamer)\nend\n</code></pre>\n\n<p>I'd like to instead be able to spawn N amount of these workers but I'm am having trouble parceling out a solution. I'd appreciate any high-level overview suggestions!</p>\n"},{"tags":["ruby-on-rails","safari","ruby-on-rails-3.2","safari-bug"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13200167,"title":"Safari 6 breaking Rails collection routes","body":"<p>I have the following code in my routes.rb file:</p>\n\n<pre><code>resources :wbs_nos, except: [:new, :create] do\n  collection { get 'wbs_tpr_filtered' }\nend\n\nresources :task_plan_requests do\n  resources :wbs_nos, only: [:new, :create]\n\n  collection do\n    get :auto_complete_for_wbs_number_wbs_number\n    get :auto_complete_for_task_plan_request_fabrication_work_order_number\n    get :auto_complete_for_task_plan_request_requestor_building\n    get :auto_complete_for_task_plan_request_requestor_name\n    get :auto_complete_for_task_plan_request_requestor_email\n  end\nend\n</code></pre>\n\n<p>In Chrome when I go to localhost:3000/wbs_nos/wbs_tpr_filtered the request is correctly sent to the was_tpr_filtered action in the WbsNosController.</p>\n\n<p>In Safari 6 it is sending me to the show action in the WbsNosController and rails gives the error: </p>\n\n<blockquote>\n  <p>Couldn't find WbsNo with id=wbs_tpr_filtered.</p>\n</blockquote>\n\n<p>I get the folling when I run rake routes:</p>\n\n<pre><code>wbs_tpr_filtered_wbs_nos GET /wbs_nos/wbs_tpr_filtered(.:format)  wbs_nos#wbs_tpr_filtered\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","polymorphic-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13200449,"title":"Enforcing a polymorphic type to have an attribute","body":"<p>I have a standard polymorphic relation set up like:</p>\n\n<pre><code>#Foo\nhas_many: bar, as: foobar\n\n#Qux\nhas_many: bar, as: foobar\n\n#Bar\nbelongs_to :foobar, polymorphic: true\n</code></pre>\n\n<p>I want to be able to enforce a model that <code>has_many: bar, as: foobar</code> to have certain attributes for example a <code>name</code>, so I can do something like:</p>\n\n<pre><code>bar.foobar.name\n</code></pre>\n\n<p>and know that it doesn't matter which model foobar is at that moment. (Since all foobars have a name attribute)</p>\n\n<p>Is there a way to do this or do I have to test for it with <code>responds_to?</code> everytime I want to use it.</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","anemone"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13178265,"title":"Rails Anemone and Postgres storing just the URL","body":"<p>I want to save the URL <code>on_pages_like</code> a certain match. Anemone is doing its thing, and records are being created that store the URLs, but:</p>\n\n<ol>\n<li>I want to use something like <code>find_or_create_by_url</code> instead of <code>create!</code>, so I'm not duplicating records each time.</li>\n<li><p>I want to save the URL. Currently the URL is being saved to the DB like:</p>\n\n<p>--- !ruby/object:URI::HTTP scheme: http user: password: host: www.a4apps.com port: 80 path: /Websites/SampleCalendar/tabid/89/Default.aspx query: opaque: registry: fragment: parser: </p></li>\n</ol>\n\n<p>I want it like:</p>\n\n<pre><code>http://www.a4apps.com//Websites/SampleCalendar/tabid/89/Default.aspx\n</code></pre>\n\n<p>The reason I'm saving to a Postgres table is I want another task to later modify that table using the URL of each record, and, I'm kind of new to this and was a little overwhelmed by the thought of adding a second DB suggested on the anemone site.</p>\n\n<p>I tried tweaking the basic code over the past few days but haven't found the solution yet. </p>\n\n<p>This is my Rake task:</p>\n\n<pre><code>namespace :db do\n  desc \"Fetch a4apps urls\"\n  task :fetch_a4apps =&gt; :environment do\n    require 'anemone'\n    Anemone.crawl(\"http://www.a4apps.com/\") do |anemone|\n      anemone.on_pages_like(/\\/SampleCalendar\\/[^?]*$/) do |page|\n        Calendarparts.create!(:url =&gt; page.url)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>My view does nothing other than to output the data onto a webpage:</p>\n\n<pre><code>&lt;% @calendar.each do |part| %&gt;\n    &lt;tr valign=\"top\"&gt;...\n             &lt;td&gt;&lt;%= part.url %&gt;&amp;nbsp;&lt;/td&gt;...\n    &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>class CalendarController &lt; ApplicationController\n  def cainventory\n    @calendar = Calendarparts.all\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","passenger"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":11145051,"title":"Rails production.log (using Passenger) being written to by multiple processes, can't be parsed","body":"<p>Here's a snippet of my production.log:</p>\n\n<pre><code>Started GET \"/product/514034/754240\" for XX.XX.202.138 at 2012-06-21 11:52:28 -0700\n\n\nStarted GET \"/product/614409/666897\" for XX.XX.228.38 at 2012-06-21 11:52:28 -0700\nProcessing by ProductsController#show as HTML\n  Parameters: {\"category_id\"=&gt;\"514034\", \"product_id\"=&gt;\"754240\"}\nProcessing by ProductsController#show as HTML\n  Parameters: {\"category_id\"=&gt;\"614409\", \"product_id\"=&gt;\"666897\"}\nLogged in 2940659 via auth cookie\nLogged in 585210 via auth cookie\n[e3e3fc56bb6bd137741b269ee397683c] [2940659] Read fragment views/global-caches/header (0.7ms)\n[e3e3fc56bb6bd137741b269ee397683c] [2940659]   Rendered shared/_email_form.html.haml (0.7ms)\n[d81bb986be5acc0277c0c9e11b414249] [585210] Read fragment views/global-caches/sharebar-message (0.7ms)\n[d81bb986be5acc0277c0c9e11b414249] [585210]   Rendered shared/_email_form.html.haml (0.7ms)\n...\n</code></pre>\n\n<p>As you can see, it's logging two concurrent sessions of two different users simultaneously to the same log file. This makes it impossible to parse my logs and determine, for example, the time it took to generate each kind of page, because the entries are not in the expected order of: </p>\n\n<pre><code>Started GET \"/URL/BLAH\" for IP at DATE\n... stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n</code></pre>\n\n<p>Instead I get an unpredictable interleaved log like this:</p>\n\n<pre><code>Started GET \"/URL/BLAH\" for IP at DATE\n\nStarted GET \"/URL/BLAH\" for IP at DATE\n... stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n...stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n</code></pre>\n\n<p>So it's impossible to match the \"completeds\" with the \"Started.\"</p>\n\n<p>What I'd like is a way to have each child process write to its own log or something. Or if it's possible a way to write the each pageview's log atomically, but that might be impossible or difficult or hurt performance.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","datatables","pjax"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13196264,"title":"Rails, pjax and DataTables","body":"<p>I've got a Rails app utilizing pjax (pjax.heroku.com/) so that my header and navbar don't ever reload. It's all fine and dandy and working, BUT in one of my views I'm using a data table (datatables.net). The data table works great when you first load up the page, but if you navigate away to another page and then come back, the table doesn't \"reinitiate\", so it doesn't work and everything looks like crap. Apparently it's because the data tables js file isn't getting loaded up again due to pjax.</p>\n\n<p>Here's what I've got:</p>\n\n<p><code>application.js</code>:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require pjax\n//= require_tree .\n</code></pre>\n\n<p>In the head of <code>application.html.erb</code> I have:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>And then wrapped the <code>&lt;%=</code> yield <code>%&gt;</code> in a div with <code>data-pjax-container</code>.</p>\n\n<p>I'm calling the data-tables js file in <code>index.html.erb</code> (hard-coded) underneath the table:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"/data-table.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Then in a separate <code>custom.js</code> file, this is what initiates the table:</p>\n\n<pre><code>$(document).pjax('a[data-pjax]');\n$('.openinside').pjax('.sidebarInner');\n</code></pre>\n\n<p>Any idea what's going on here? I think the table isn't being reinitiated, but how can I make it reinitiate when the header isn't getting loaded every time due to Pjax? I tried putting the JS link right beneath the table even and that didn't work!</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":42,"score":4,"question_id":13200065,"title":"Rubygems - where are the package downloaded?","body":"<p>When you install a new package, for example, 'gem install fb-graph', where are the files downloaded?  </p>\n"},{"tags":["ruby-on-rails","ruby","sequel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13199680,"title":"Sequel -- How To Construct This Query?","body":"<p>I have a <code>users</code> table, which has a one-to-many relationship with a <code>user_purchases</code> table via the foreign key <code>user_id</code>.  That is, each user can make many purchases (or may have none, in which case he will have no entries in the user_purchases table).</p>\n\n<p><code>user_purchases</code> has only one other field that is of interest here, which is <code>purchase_date</code>.  </p>\n\n<p>I am trying to write a Sequel ORM statement that will return a dataset with the following columns:</p>\n\n<ul>\n<li>user_id</li>\n<li>date of the users SECOND purchase, if it exists</li>\n</ul>\n\n<p>So users who have not made at least 2 purchases will not appear in this dataset.  What is the best way to write this Sequel statement?</p>\n\n<p><strong>Please note I am looking for a dataset with ALL users returned who have >= 2 purchases</strong></p>\n\n<p>Thanks!</p>\n\n<h2>EDIT FOR CLARITY</h2>\n\n<p>Here is a similar statement I wrote to get users and their first purchase date (as opposed to 2nd purchase date, which I am asking for help with in the current post):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>   DB[:users].join(:user_purchases, :user_id =&gt; :id)\n              .select{[:user_id, min(:purchase_date)]}\n              .group(:user_id)\n</code></pre>\n"},{"tags":["ruby-on-rails","mongoid","relations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":163,"score":0,"question_id":5924412,"title":"How can I expose a Mongoid embedded collection?","body":"<p>I have mongoid setup in my rails3 app, and have created 2 models.\nOne model is user, and the other model is article.</p>\n\n<p>Since I each user can create many articles, I have put </p>\n\n<pre><code>embedded_in :user\n</code></pre>\n\n<p>in model/article.rb file, and </p>\n\n<pre><code>embeds_many :articles\n</code></pre>\n\n<p>in model/user.rb file.</p>\n\n<p>Now, if I access article by 'app_url/articles/random_article_id' I get the following error.</p>\n\n<pre><code>Access to the collection for Article is not allowed since it is an embedded document, please access a collection from the root document.\n</code></pre>\n\n<p>While I want to maintain relationship, I want articles to be accessible to any people. How can I do that??</p>\n"},{"tags":["ruby-on-rails","deployment","capistrano","daemon"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":391,"score":1,"question_id":2437386,"title":"How do I rollback capistrano tasks upon failure?","body":"<p>In my Capistrano deploy.rb, I have a couple of daemons like delayed_jobs and fetcher, starting and stopping depending on where they are in the deployment process.</p>\n\n<p>This method would create problems if a deployment fails, because the daemons wouldn't be managed properly (ie. two processes spawned instead of one, or processes were shutdown without restarting itself until the next deployment).</p>\n\n<p>Is there anyway to prevent this from happening like a rollback code? How is deployment of daemons normally done over capistrano?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13198872,"title":"Unable to send email when view has links","body":"<p>I am using ruby 1.9.3p194 and Rails 3.2.3.</p>\n\n<p>I am facing problem while sending emails whose template has a link in it. I have written following code:</p>\n\n<p>invitation_mailer.rb </p>\n\n<pre><code>def event_invitation(user, event)\n  @user = user\n  @event = event\n  mail(:to =&gt; @user.email, :subject =&gt; \"Invitation to participate in #{@event.name}   event\")\nend\n</code></pre>\n\n<p>event_invitation.html.haml</p>\n\n<pre><code>Hello,\n\n%br\n%br\n\nYour friend #{@event.user.full_name} has invited you to participate in #{@event.name}   event. If you want to accept\nthis invitation, use the following link: \n\n= link_to calendar_index_url, calendar_index_url\n\n%br\n%br\n\n#{t('shared.team')}\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>def xyz\n   ...\n   InvitationMailer.event_invitation(self, event).deliver\nend\n</code></pre>\n\n<p>If I remove the link line in the view, I am able to receive emails but not with the link inside the view. But the log shows that an email has been sent.</p>\n\n<p>LOG</p>\n\n<pre><code> Sent mail to abhimanyu@gmail.com (6117ms)\n Date: Fri, 02 Nov 2012 20:59:33 +0530\n From: invitation@dev.tld\n To: abhimanyu@gmail.com\n Message-ID: &lt;5093e6dd6a275_14f733fc536034cd444087@Abhimanyus-iMac.local.mail&gt;\n Subject: Invitation to participate in new event event\n Mime-Version: 1.0\n Content-Type: text/html;\n charset=UTF-8\n Content-Transfer-Encoding: 7bit\n\n Hello,\n &lt;br&gt;\n &lt;br&gt;\n Your friend Abhimanyu Kumar has invited you to participate in new event event. If you   want to accept\n this invitation, use the following link:\n &lt;a href=\"http://localhost:3000/calendar\"&gt;http://localhost:3000/calendar&lt;/a&gt;\n &lt;br&gt;\n &lt;br&gt;\n Dev Team\n</code></pre>\n\n<p>Any help to figure out the problem would be appreciated. </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12652540,"title":"Combine Show and Edit actions in Ruby on Rails?","body":"<p>I was just wondering if anybody has ever built a Rails application without any <em>Show</em> actions.</p>\n\n<p>In my application, if a user picks, say a Project, from the list he will <em>probably</em> want to not just <em>show</em> it but also <em>edit</em> it.</p>\n\n<p>So is it good practice to <strong>not</strong> implement any show actions and instead link all records to edit forms?</p>\n\n<p>The only caveat I see is that a user might accidentally edit a project. But this could be prevented by setting a default attribute <em>disabled</em> on all form fields using jQuery. That way, a user will have to click a button \"Edit\" in order to unlock the form fields for editing.</p>\n\n<p>Does that make sense or am I completely nuts?</p>\n\n<p>Who knows, maybe this causes conflicts with Rails' RESTful architecture?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongodb","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13199613,"title":"match two or more object from differents models with mongoid","body":"<p>I have 2 model:</p>\n\n<pre><code>class User\n include Mongoid::Document\n field :email, :type =&gt; String, :null =&gt; false, :default =&gt; \"\"\n .\n .\nend\n\nclass Admin\n include Mongoid::Document\n field :email, :type =&gt; String, :null =&gt; false, :default =&gt; \"\"\n .\n .\nend\n</code></pre>\n\n<p>I want with a mongoid query find all users have a equal email in <code>Admin</code> model, something like:</p>\n\n<pre><code>User.where(:email =&gt; {exist_admin_class?})\n</code></pre>\n\n<p>This is possible? Or I have make a relationship between two model with a <code>has_one User</code> and <code>belongs_to Admin</code></p>\n\n<p>What is the best way to do this?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","unit-testing","automated-tests"],"answer_count":6,"favorite_count":6,"up_vote_count":14,"down_vote_count":0,"view_count":3889,"score":14,"question_id":274349,"title":"running single rails unit/functional test","body":"<p>As title. </p>\n\n<p>ruby test/functionals/whatevertest.rb doesn't work, that requires me to replace all <code>require 'test_helper'</code> to <code>require File.dirname(__FILE__) + '/../test_helper'</code>. For some reason most of those test templates have such issue, so I rather to see if there is a hack I could get around it.</p>\n"},{"tags":["ruby-on-rails","table","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13175178,"title":"dynamically create db table in rails","body":"<p>Thanks for your time !</p>\n\n<p>Currently I interact with specific table in database through <code>ActiveRecord</code>. I'll know the table name in advance and I'll create table by <code>rails generate model modelname column1:string ...</code>. </p>\n\n<p>But now, I get this requirement that the table name is unknown as well as how many tables there will be. </p>\n\n<p>For example : In directory <code>Projects</code>, there're many sub directories such as : <code>Projects_A</code>, <code>Project_B</code>, <code>Project_C</code> ... I need to create separate tables for each of these projects. But you don't know how many project there'll be. And I need to dynamically create these tables in my code. How to achieve that in my code? Do I use ActiveRecord to achieve that or any other methods?</p>\n\n<p>Codes like:</p>\n\n<pre><code>list = maintain_a_dir_list()\n\nDir.entries( dir ).each { |e|\n  if e is not in list\n    create_a_table_after_e_name\n  end\n}\n</code></pre>\n\n<p><strong>Here's I will explain why I want to create such tables :</strong></p>\n\n<p>The directory name and its sub folder name I methioned above is unreal. So let's told this story all over again. </p>\n\n<p>I am a load tester. I do load test for one of our company's projects. Let's say the project's name is <code>Project_A</code>. <code>Project_A</code> has many versions, like 1.0, 2.0 and so on. So in every release I'll do many rounds of load test to ensure the product's quality.</p>\n\n<p>So the relationship between project, verson and loadtest report is simple : project contains many versions. And each version contains many loadtest reports which executed in different days. </p>\n\n<p>The information in loadtest report is as following :</p>\n\n<p>transaction name | min time | average response time | max time</p>\n\n<p>transaction_01 | 1.0s | 2.0s | 3.0s </p>\n\n<p>transaction_02 | 0.5s | 1.5s | 4.0s</p>\n\n<p>...</p>\n\n<p>To store the reports information in database, I create a table named <code>transactions_table</code>. The table is like this :</p>\n\n<p>report_name | transaction_name | min | average | max </p>\n\n<p>20121001_100users_4hours | transaction_01 | 1.0 | 2.0 | 3.0</p>\n\n<p>20121001_100users_4hours | transaction_02 | 1.0 | 2.0 | 3.0</p>\n\n<p>...</p>\n\n<p>20121002_100users_2hours | transaction_01 | 1.5 | 2.1 | 2.5</p>\n\n<p>20121002_100users_2hours | transaction_02 | 1.1 | 2.1 | 2.7</p>\n\n<p>...</p>\n\n<p>...</p>\n\n<p>Then I want to get the version information involved. So I create another table named <code>reports_table</code>. The table is like this :</p>\n\n<p>version | report_name</p>\n\n<p>project_a_1.0 | 20121001_100users_4hours</p>\n\n<p>project_a_1.0 | 20121002_100users_2hours</p>\n\n<p>...</p>\n\n<p>project_a_2.0 | 20121101_50users_1hours</p>\n\n<p>project_a_2.0 | 20121102_50users_2hours</p>\n\n<p>...</p>\n\n<p>...</p>\n\n<p>And ofcourse there's more than one project in my company. There'll be <code>Project_B</code>, <code>Project_C</code> and <code>D</code>... So again comes the version table consist of the Project name and its versions.</p>\n\n<p>It's the first time I design the relationship of DB tables. So I don't know whether the way i organize table is right. </p>\n\n<p>Firstly, I simply think I can put all the transaction data--no matter which project or version it belongs--in <code>transactions_table</code>. Then I realize the report name from different projects or versions may be the same. Then it cannot seperate <code>transactions_table</code> using <code>select * from transactions_table where report_name = \"xxxx\"</code>. And the <code>transactions_table</code>'s size will increase more rapidly than the other two tables. </p>\n\n<p>So that's why I am considering to store the reports in different projects to different table.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":191,"score":1,"question_id":11725002,"title":"Rails 3: How to configure Zencoder to work with Amazon S3?","body":"<p>I'm following this tutorial to integrate Zencoder in my Rails 3 app: <a href=\"http://www.nickdesteffen.com/blog/video-encoding-with-uploadify-carrierwave-and-zencoder\" rel=\"nofollow\">http://www.nickdesteffen.com/blog/video-encoding-with-uploadify-carrierwave-and-zencoder</a></p>\n\n<p>The tutorial uses Rackspace for storage, but I'd like to adapt the code so that I can use Amazon S3 for storage instead. I replaced all the Rackspace info with my Amazon S3 info, but whenever I try to upload a video in my form, I get this HTTP error: \"There was an error with the file you tried uploading.Please verify that it is the correct type.\"</p>\n\n<p>What do I need to fix here to make this work?</p>\n\n<p><strong>carrierwave.rb</strong></p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',\n    :aws_access_key_id      =&gt; 'xxx',\n    :aws_secret_access_key  =&gt; 'xxx',\n  }\n  config.fog_directory  = 'mybucket'\n  config.fog_public     = true\n  config.fog_attributes = {'Cache-Control' =&gt; 'max-age=315576000'}\nend\n</code></pre>\n\n<p><strong>video_uploader.rb</strong></p>\n\n<pre><code>class VideoUploader &lt; CarrierWave::Uploader::Base\n  include Rails.application.routes.url_helpers\n\n  Rails.application.routes.default_url_options = ActionMailer::Base.default_url_options\n\n  after :store, :zencode\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  def extension_white_list\n    %w(mov avi mp4 mkv wmv mpg)\n  end\n\n  def filename\n    \"video.mp4\" if original_filename\n  end\n\n  private \n\n  def zencode(args)\n    zencoder_response = Zencoder::Job.create({:input =&gt; 's3://mybucket/key.mp4',\n                      :outputs =&gt; [{:label =&gt; 'vp8 for the web',\n                                    :url =&gt; 's3://mybucket/key_output.webm'}]})\n\n    zencoder_response.body[\"outputs\"].each do |output|\n      if output[\"label\"] == \"web\"\n        @model.zencoder_output_id = output[\"id\"]\n        @model.processed = false\n        @model.save(:validate =&gt; false)\n      end\n    end\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","model"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13198920,"title":"How to create a User - Group model in rails? with muliple authorization enabled","body":"<p>A user could create a \"group\", which other users could join in. Each group has its own admin and moderators so on and could do something like creating posts, inviting users, etc.</p>\n\n<p>I think \"has_many through\" should be used here, but not sure about the authorization, since the role is based on different groups. The roles set up in CanCan seem not fit into it, admin is just for one group, not the whole site.</p>\n"},{"tags":["ruby-on-rails","activerecord","mongoid"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13199266,"title":"Rails ActiveRecord Mongoid Object","body":"<p>In my user model i have</p>\n\n<pre><code>field :contact_info, :default=&gt;{}\nfield :info, :default=&gt;{}\n</code></pre>\n\n<p>How could I create a User.new with <code>contact_info.[some key]</code></p>\n\n<p><code>[some key]</code> being a key that the user would provide themselves</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","html5","file-upload","carrierwave"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":3973,"score":4,"question_id":6447278,"title":"Uploading multiple files at once to Rails app with Carrierwave (HTML5)","body":"<p>I'm close...very close...I'm able to upload single files just fine...but when i change the type of my form's <code>file_field</code> to <code>:multiple =&gt; true</code> so I can upload multiple images at once my uploaded files get wrapped in an array...and the 'magic' of 'accepts_nested_attributes_for` is lost.</p>\n\n<p><strong>Edit:</strong>\nAfter more examination I wonder if I even need to bother with <code>accepts_nested_attributes_for</code>? Perhaps I should just have a <code>file_field, :multiple =&gt; true</code> in my Gallery form (as opposed to a nested form) and then in my create action create the new gallery and then loop through each element in the <code>params[:gallery][:photos_attributes][\"0\"][:image]</code> array by hand, so to speak, calling <code>@gallery.photos.create</code> for each element. ?!?  Seems cumbersome...but it's all I can come up with.</p>\n\n<p>Hoping someone with more experience with Rails can chime in...</p>\n\n<p>Params:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\", \n\"authenticity_token\"=&gt;\"9jXvIwcllct7UyUfo6cvhEucQf2u3SY50SuaCLtFO4c=\", \n\"gallery\"=&gt;{\n  \"name\"=&gt;\"First Gallery\", \n  \"photos_attributes\"=&gt;{\"0\"=&gt;{\n    \"image\"=&gt;[\n      #&lt;ActionDispatch::Http::UploadedFile:0x00000104b78978 \n        @original_filename=\"first_test_image.jpg\", \n        @content_type=\"image/jpeg\", \n        @headers=\"Content-Disposition: form-data; name=\\\"gallery[photos_attributes][0][image][]\\\"; filename=\\\"first_test_image.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\", \n        @tempfile=#&lt;File:/var/folders/bQ/bQYZC2ukFZCvbKzEDGRtJE+++TI/-Tmp-/RackMultipart20110622-4459-vz78ee&gt;&gt;, \n      #&lt;ActionDispatch::Http::UploadedFile:0x00000104b78950 \n        @original_filename=\"second_test_image.jpg\", \n        @content_type=\"image/jpeg\", \n        @headers=\"Content-Disposition: form-data; name=\\\"gallery[photos_attributes][0][image][]\\\"; filename=\\\"second_test_image.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\", \n        @tempfile=#&lt;File:/var/folders/bQ/bQYZC2ukFZCvbKzEDGRtJE+++TI/-Tmp-/RackMultipart20110622-4459-1jzhhyg&gt;&gt;\n      ]\n    }\n  }\n}, \"commit\"=&gt;\"Save\", \"action\"=&gt;\"create\", \"controller\"=&gt;\"galleries\"}\n\n\n\n#app/models/gallery.rb \nclass Gallery &lt; ActiveRecord::Base \n  has_many :photos, :dependent =&gt; :destroy \n  accepts_nested_attributes_for :photos \nend \n\n#app/models/photo.rb \nclass Photo &lt; ActiveRecord::Base \n  belongs_to :gallery \n  mount_uploader :photo, PhotoUploader \nend \n\n#config/routes.rb\nresources :galleries do\n  resources :photo, :only =&gt; [:create, :destroy]\nend\n</code></pre>\n\n<p>GalleriesController</p>\n\n<pre><code>  def new\n    @gallery = Gallery.new\n    @gallery.photos.build\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @gallery }\n    end\n  end\n\n  ...\n\n  def create\n    @gallery = Gallery.new(params[:gallery])\n\n    respond_to do |format|\n      if @gallery.save\n        format.html { redirect_to @gallery, notice: 'Gallery was successfully created.' }\n        format.json { render json: @gallery, status: :created, location: @gallery }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @gallery.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","activerecord","authorization"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13198498,"title":"Rails permissions: different types of permissions to different models","body":"<p>I'm in the middle of rewriting some Rails 3 application logic, and I want to pick your brains about my DB modeling.</p>\n\n<p>In my app, a User can have access to a Page, Group and a Picture. This is pretty easy to do as polymorphic associations:</p>\n\n<pre><code>class Permission &lt; ActiveRecord::Base\n  belongs_to :resource, :polymorphic =&gt; true \n  belongs_to :user\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :permissions\nend\n\nclass Page &lt; ActiveRecord::Base\n  has_many :permissions, :as =&gt; :resource\nend\n\n# the same for Page and Picture\n</code></pre>\n\n<p>However, those permissions also need to have different types, for example AdminPermission, CollaboratorPermission, OwnerPermission. How would I go about doing that? I want to be able to do this:</p>\n\n<pre><code>p = Page.first\nu = User.first\nu.admin_permissions.create(:resource =&gt; p) \n\n# should return AdminPermission class, not just Permission\nper = User.first.permissions.first \n# should return Page\nper.resource\n</code></pre>\n\n<p>My question is: How can I model this? Would it be better just to make a Permission class per object, instead of doing all this in a single class? Is there a smart way of doing this? I'm not a big fan of using the role/auth plugins for Rails, as they rely on a user being a specific role. Here, the role changes with the permission. A user can be an admin of a Group, but a Collaborator on an image.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-engines"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":142,"score":1,"question_id":13183540,"title":"Using layouts from a mountable engine","body":"<p>I am looking for a solution to the following problem:</p>\n\n<p>db_core application contains only models for a small core system. The db_core application will not have any views. </p>\n\n<p>On top of the db_core application we will have an admin interface. This will be a mountable engine. The admin interface will serve assets such as javascripts, css, images, etc.</p>\n\n<p>Finally we will have additional mountable engines; eg. \"blog\", \"forum\", \"authentication\" that will be mounted on the db_core application, and all these mountable engines should have the same layout as the admin interface engine.</p>\n\n<p>I have a test up and running where the db_core application serves assets, but I have not been able to find out how to let another engine serve the assets so the db_core application can remain small and free of any assets and views.</p>\n\n<ul>\n<li>db_core\n<ul>\n<li>Engine A -> admin interface (assets)</li>\n<li>Engine B, C, D, ... -> various other engines using assets from Engine A</li>\n</ul></li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":343,"score":0,"question_id":8086638,"title":"Merging db/migration files","body":"<p>Is there a good way to merge rails db migration files into 1 file per table besides splitting <strong>schema.rb</strong> manually?</p>\n\n<p>Most of my migration file was created during development and does not represent real data changes. For historical reasons those files will be still accessible on source control system. I feel uncomfortable keeping those unnecessary files.</p>\n"},{"tags":["ruby-on-rails","api","rest","web-applications","concurrency"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13197863,"title":"Web application without SQL query for current user authentication","body":"<p>I have a web server with a lot of requests per second. In order to optimise performances on I/O with the database, the server perform currently only 2 SQL queries by HTTP query:</p>\n\n<ul>\n<li>there's one query in order to fetch the current user,</li>\n<li>there's one query in order to read or write a resource.</li>\n</ul>\n\n<p>And I'm currently wondering if it wouldn't be smart to also cache the current user's id, inside a session variable. This way, the server could perform just 1 SQL query by HTTP query.</p>\n\n<p>In order to do so, the client would have to authenticate itself on the app. Then, after an SQL query checking the username+password, the server could just save his id inside a session variable. After this, we could remove the useless SQL query.</p>\n\n<p>As this seems very simple, and useful, I'm wondering why popular Authentication plugins such as the Devise gem (for Rails or Sinatra) don't seems to work this way.</p>\n\n<p>Is they a best way to do so? What do you think about?</p>\n\n<p>Thanks for any ideas.</p>\n"},{"tags":["ruby-on-rails","tinymce","sanitization"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1070,"score":1,"question_id":5410746,"title":"How to apply classes instead of inline css style in TinyMCE","body":"<p>I'm using the the <code>advimage</code> <code>TinyMCE</code> plugin.</p>\n\n<p>When I open the advanced image dialogue, and choose to justify an image to the left, it adds <code>style=\"float:left\"</code> to the image tag.</p>\n\n<p>However, I'm removing the <code>style</code> attribute from all tags when I sanitize the output.</p>\n\n<p>Is there a way to have <code>TinyMCE</code> add classes, instead of inline css code, by default? </p>\n\n<p>For example, instead of:</p>\n\n<pre><code>style=\"float:left\"\n</code></pre>\n\n<p>I would like to have added:</p>\n\n<pre><code>class=\"float-left\"\n</code></pre>\n"},{"tags":["ruby-on-rails","rest"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":2,"view_count":325,"score":1,"question_id":13197236,"title":"Rails: Is JSON still REST?","body":"<p>I'm still very new to web development, so please bear with me if this question is really stupid.</p>\n\n<p>I'm trying to follow a REST principles, however, I really appreciate how JSON flows with Ruby and anything that is connecting externally through an API. I know that its pretty standard in REST to input parameters directly into the URL like so: myurl.com/ExampleModel/MyIDParameter and send the JSON (if there is any) to that URI, right?</p>\n\n<p>What I would like to know is: Is it against REST principles to remove the parameter from the URI (and the routing if I will never use it) and include the parameter in the JSON?</p>\n\n<p>For example, instead of calling this:</p>\n\n<pre><code>myurl.com/ExampleModel/id\n{\n    \"name\" : \"My Name\",\n    \"anotherParameter\" : \"A random string\"\n}\n</code></pre>\n\n<p>You would call this:</p>\n\n<pre><code>myurl.com/ExampleModel\n{\n    \"id\" : 512,\n    \"name\" : \"My Name\",\n    \"anotherParameter\" : \"A random string\"\n}\n</code></pre>\n"},{"tags":["ruby-on-rails","memcached","cache-control"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13198162,"title":"How does memcache and rails work at max limits?","body":"<p>I am trying to understand how memcache works when (if) you fill up the allocated memory buffer. In particular I want to understand the lifecycle of a key value pair in cache. I am talking about low level cache operations in rails where I am directly creating the key/value pairs. e.g. commands like</p>\n\n<pre><code>Rails.cache.write key, cached_data\n\nRails.cache.fetch key \n</code></pre>\n\n<p>Assume for the sake of argument I have an infinite loop that was just generating random UUIDs as keys and storing random data. What happens when the cache fills up? Do older items just get bumped off or is there some specific algorithm behind the scenes that handles this eventuality?\nI have read elsewhere \"Cache Invalidation is a Hard Problem\".</p>\n\n<p>Just trying to understand how it actually works.</p>\n\n<p>Maybe some simple code examples that illustrate the best way to create and destroy cached data? Do you have to explicitly define when entries should expire?</p>\n"},{"tags":["ruby-on-rails","cucumber","rake"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":24,"score":3,"question_id":13198300,"title":"Is it possible to send arguments to `rake cucumber` without using environment variables?","body":"<p>I see that it is possible to pass arguments to a rake task:</p>\n\n<pre><code>task :task_name, :arg_name do |t, args|\n</code></pre>\n\n<p>What I'd like to do is pass arguments into a cucumber rake task:</p>\n\n<pre><code>Cucumber::Rake::Task.new({:tags =&gt; 'db:test:prepare'}) do |t, args|\n  t.cucumber_opts = ['--tags', #args?]\nend\n</code></pre>\n\n<p>Is this sort of thing possible? This way I could do:</p>\n\n<pre><code>rake cucumber:tags['tag1', 'tag2', ...]\n</code></pre>\n\n<p>And have it run only those tags. Most sources say to use an environment variable, which I have done, but I'd prefer to just provide the arguments the \"right\" way.</p>\n"},{"tags":["mysql","ruby-on-rails","paperclip"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":93,"score":3,"question_id":12974266,"title":"firefox makes paperclip store special characters as questionmarks","body":"<p>When I upload a file called 'åäöÅÄÖ.jpg' using Firefox it stores it as 'a?a?o?A?A?O?.jpg'</p>\n\n<p>Using Google Chrome, Safari and Internet Explorerit works fine.</p>\n\n<p>When I watch the Rails console the query for inserting the file name looks ok:</p>\n\n<pre><code>BlogHeader Update (0.4ms)   UPDATE 'blog_headers' \n  SET 'large_file_name' = 'åäöÅÄÖ.jpg', \n  'updated_at' = '2012-10-19 14:13:36' WHERE 'id' = 14`\n</code></pre>\n\n<p>Obviously an encoding issue, but I can't seem to track down where along the line it breaks. Any ideas? Using Rails 2.3.11 and Paperclip 2.8.0.</p>\n\n<p><strong>Edit:</strong>\nAnother way of solving this would be to rename the filename once the file is uploaded (using a regex to remove all non a-z chars for example). I've been looking at interpolation in Paperclip, but since that applies to already uploaded files it breaks them as well.</p>\n"},{"tags":["ruby-on-rails","controller"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13197931,"title":"How to use a custom controller method?","body":"<p>I am trying to learn how to use a hyperlink in a view to access a custom controller method. I have the following code in my Controller, and I would like to access this with a <code>link_to</code> command in a View. I'm guessing there is something I need to do in the routes file to make the <code>launch_build_file</code> method work? What code should I list in the View to trigger the <code>launch_build_file</code> method?</p>\n\n<pre><code>class ReportsController &lt; ApplicationController\n\n  def index\n  end\n\n  def launch_build_file\n    Process.spawn(\"ruby #{Rails.root}/lib/build.rb\")\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13196493,"title":"How should I refactor create_unique methods in Rails 3?","body":"<p>I have following ugly create_unique method in few models ex:</p>\n\n<pre><code>  def self.create_unique(p)\n    s = Subscription.find :first, :conditions =&gt; ['user_id = ? AND app_id = ?', p[:user_id], p[:app_id]]\n    Subscription.create(p) if !s\n  end\n</code></pre>\n\n<p>And then in controllers #create actions I have</p>\n\n<pre><code>s = Subscription.create_unique({:user_id =&gt; current_user.id, :app_id =&gt; app.id})\nif s\n  raise Exceptions::NotAuthorized unless current_user == s.user\n  @app = s.app\n  s.destroy\n  flash[:notice] = 'You have been unsubscribed from '+@app.name+'.'\n  redirect_to '/'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13197359,"title":"Add association (<<) without commiting to database","body":"<p>Is it possible in Rails to add an association to an <strong>existing</strong> record without immediately commiting this change to the database?\nE.g. if I have Post has_many :tags</p>\n\n<pre><code>post.tags &lt;&lt; Tag.first\n</code></pre>\n\n<p>This will commit to database immediately. I've tried other ways instead of &lt;&lt;, but without success (what I want is to create the association when saving the parent object).\nIs it possible to get behavior like when you are adding association to a new record with build?</p>\n\n<pre><code>post.tags.build name: \"whatever\"\n</code></pre>\n\n<p>I think this is kind of inconsistent in Rails, in some cases it would be useful to have an option to do this.</p>\n\n<p>In other words I want</p>\n\n<pre><code>post.tags &lt;&lt; Tag.first # don't hit the DB here!\npost.save # hit the DB here!\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13185761,"title":"Sending downloaded files via Rails controller","body":"<p>On my Rails-based website, I'd like a user to be able to input a URL, which my server downloads using the Unix command <code>wget</code> <em>with the recursive option</em>. My server then zips those downloaded files along with some files already on the server, and sends the zip to the user by using the Rails command <code>send_file</code>.</p>\n\n<p>Now, I'm worried that the <code>send_file</code> will be executed before the <code>wget</code> and zipping finish their job. How do I make sure that sending the file occurs only after the downloading and zipping finish? Will this approach work, or should I take an another approach?</p>\n"},{"tags":["ruby-on-rails","ruby","mysql2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":695,"score":0,"question_id":6407429,"title":"Ruby on Rails mysql2 adapter problem","body":"<p>I have installed ruby and rails and my application gives me an error when I am trying to run </p>\n\n<p>rake db:migrate</p>\n\n<p>this is the result of the command rake db:migrate --trace</p>\n\n<pre><code>** Execute db:migrate\nrake aborted!\n!!! Missing the mysql2 gem. Add it to your Gemfile: gem 'mysql2'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/mysql_adapter.rb:22:in `rescue in mysql_connection'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/mysql_adapter.rb:19:in `mysql_connection'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:229:in `new_connection'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:237:in `checkout_new_connection'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:191:in `block (2 levels) in checkout'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:187:in `loop'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:187:in `block in checkout'\n/usr/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:186:in `checkout'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:94:in `connection'\n/usr/lib/ruby/gems/1.9.1/gems/ar-octopus-0.3.4/lib/octopus/proxy.rb:83:in `select_connection'\n/usr/lib/ruby/gems/1.9.1/gems/ar-octopus-0.3.4/lib/octopus/proxy.rb:177:in `send_queries_to_selected_slave'\n/usr/lib/ruby/gems/1.9.1/gems/ar-octopus-0.3.4/lib/octopus/proxy.rb:140:in `method_missing'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:454:in `get_all_versions'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:583:in `migrated'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:492:in `current_version'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:509:in `block in migrate'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:509:in `each'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:509:in `detect'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:509:in `migrate'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:433:in `up'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:415:in `migrate'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/railties/databases.rake:142:in `block (2 levels) in &lt;top (required)&gt;'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `call'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `block in execute'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `each'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `execute'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:597:in `block in invoke_with_call_chain'\n/usr/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block (2 levels) in top_level'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `each'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block in top_level'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2001:in `block in run'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:1998:in `run'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/bin/rake:31:in `&lt;top (required)&gt;'\n/usr/bin/rake:19:in `load'\n/usr/bin/rake:19:in `&lt;main&gt;'\nconfiz@confiz-desktop:~/mango_apps/rails_app_sms$ .\nbash: .: filename argument required\n.: usage: . filename [arguments]\n</code></pre>\n\n<p>I have already mentioned gem in my gemfile and already executed bundle install.</p>\n\n<p>My database.yml file already has the correct adapter i.e. adapter: mysql2</p>\n\n<p>Please help me resolve this problem.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":25,"score":3,"question_id":13196881,"title":"Capybara::ElementNotFound: for jquery ui dialog box content","body":"<p>I have my Login form into the Jquery UI Dialog popup box. When I start doing RSpec test, I got an error with </p>\n\n<pre><code>Failure/Error: fill_in \"Username\", with: \"user@example.com\"\nCapybara::ElementNotFound\ncannot fill in, no text field, text area or password field with id, name, or label 'Username' found\n</code></pre>\n\n<p>Here is my spec/request page:</p>\n\n<pre><code>describe \"create user\", :js =&gt; true do\n\n  before { visit new_enr_rds_dea_path }\n\n  let(:submit) { \"Create Dea\" }\n\n  describe \"with invalid information\" do\n    it \"should not create a user\" do\n      expect { click_button submit }.not_to change(Enr::Rds::Dea, :count)\n    end\n  end\n\n  describe \"with valid information\" do\n    before do\n      fill_in \"Username\", with: \"user@example.com\"\n      fill_in \"Password\", with: \"foobar\"\n      fill_in \"Confirm password\", with: \"foobar\"\n      fill_in \"Organisation\", with: \"foobar\"\n    end\n\n    it \"should create a user\" do\n      expect { click_link_or_button submit }.to change(Enr::Rds::Dea, :count).by()\n    end\n  end\n</code></pre>\n\n<p>Factories.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :dea_user do |user|\n    user.dea_user             \"example@in4systems.com\"\n    user.dea_pwd              \"foobar\"\n    user.dea_pwd_confirmation \"foobar\"\n    user.pro_organisation_id  \"NHER\"\n  end\nend\n</code></pre>\n\n<p>I am rendering my new and edit page to the Form partial. Both <code>New</code> and <code>edit</code> button has <code>:remote =&gt; true</code> method to open the JqueryUI dialog box. Thanks..</p>\n"},{"tags":["ruby-on-rails","routes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13196608,"title":"Rails POST getting handled by controller#home","body":"<p>I'm not sure what I'm doing wrong. I have a Projects resource:</p>\n\n<pre><code>resources :projects\n</code></pre>\n\n<p>In ProjectsController#new, I'm creating a project and rendering it in new.html.erb:</p>\n\n<pre><code>&lt;%= form_for @project do |f| %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name%&gt;&lt;br/&gt;\n  &lt;%= f.submit  %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This gets POSTed but instead of being handled by Projects#create it's being handled by the home action:</p>\n\n<pre><code>Started POST \"/projects\" for 127.0.0.1 at 2012-11-02 08:47:36 -0500\nProcessing by ProjectsController#home as HTML\n</code></pre>\n\n<p>Here are my routes:</p>\n\n<pre><code>                    /                            projects#home\n    projects        /projects(.:format)          projects#home\n             GET    /projects(.:format)          projects#index\n             POST   /projects(.:format)          projects#create\n new_project GET    /projects/new(.:format)      projects#new\nedit_project GET    /projects/:id/edit(.:format) projects#edit\n     project GET    /projects/:id(.:format)      projects#show\n             PUT    /projects/:id(.:format)      projects#update\n             DELETE /projects/:id(.:format)      projects#destroy\n</code></pre>\n\n<p>EDITED:\nI found the problem.</p>\n\n<p>This is the old routes file:</p>\n\n<pre><code>SolarMesh::Application.routes.draw do\n  match '/' =&gt; 'projects#home'\n  match '/projects' =&gt; 'projects#home'\n  resources :projects\n\nend\n</code></pre>\n\n<p>The line \"match '/projects'\" was the reason it was always being handled by home.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","mongoid","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13187416,"title":"mongoid and devise gives unsual error","body":"<p>Mongoid with devise seems to be throwing up this error for me, where ever devise is being used.</p>\n\n<pre><code>undefined method `-' for nil:NilClass\n</code></pre>\n\n<p>this is the stack trace</p>\n\n<pre><code>moped (1.2.7) lib/moped/cluster.rb:172:in `block in refresh'\nmoped (1.2.7) lib/moped/cluster.rb:179:in `each'\nmoped (1.2.7) lib/moped/cluster.rb:179:in `refresh'\nmoped (1.2.7) lib/moped/cluster.rb:132:in `nodes'\nmoped (1.2.7) lib/moped/cluster.rb:240:in `with_secondary'\nmoped (1.2.7) lib/moped/session/context.rb:104:in `with_node'\nmoped (1.2.7) lib/moped/session/context.rb:43:in `query'\nmoped (1.2.7) lib/moped/query.rb:112:in `first'\nmongoid (3.0.10) lib/mongoid/contextual/mongo.rb:201:in `first'\nmongoid (3.0.10) lib/mongoid/contextual.rb:18:in `first'\norm_adapter (0.4.0) lib/orm_adapter/adapters/mongoid.rb:22:in `get'\ndevise (2.1.2) lib/devise/models/authenticatable.rb:183:in `serialize_from_session'\ndevise (2.1.2) lib/devise/rails/warden_compat.rb:29:in `deserialize'\nwarden (1.2.1) lib/warden/session_serializer.rb:35:in `fetch'\nwarden (1.2.1) lib/warden/proxy.rb:212:in `user'\nwarden (1.2.1) lib/warden/proxy.rb:318:in `_perform_authentication'\nwarden (1.2.1) lib/warden/proxy.rb:127:in `authenticate!'\ndevise (2.1.2) lib/devise/controllers/helpers.rb:48:in `authenticate_user!'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:418:in `_run__532752988157179990__process_action__39271927218028622__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/rescue.rb:29:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'\nactionpack (3.2.8) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.2.8) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.2.8) lib/action_controller/metal.rb:203:in `dispatch'\nactionpack (3.2.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.2.8) lib/action_controller/metal.rb:246:in `block in action'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `call'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:36:in `call'\njourney (1.0.4) lib/journey/router.rb:68:in `block in call'\njourney (1.0.4) lib/journey/router.rb:56:in `each'\njourney (1.0.4) lib/journey/router.rb:56:in `call'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'\nmongoid (3.0.10) lib/rack/mongoid/middleware/identity_map.rb:34:in `call'\nwarden (1.2.1) lib/warden/manager.rb:35:in `block in call'\nwarden (1.2.1) lib/warden/manager.rb:34:in `catch'\nwarden (1.2.1) lib/warden/manager.rb:34:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.4.1) lib/rack/etag.rb:23:in `call'\nrack (1.4.1) lib/rack/conditionalget.rb:25:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'\nrack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\nrack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__4054107343433525264__call__3237741633973160553__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.8) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.8) lib/rails/engine.rb:479:in `call'\nrailties (3.2.8) lib/rails/application.rb:223:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n\n<p>The controller has a before_filter :authenticate_user! commenting this, allows the page to work.</p>\n\n<p>What might be wrong here?</p>\n\n<p>I have tried destroying all devise installs by doing</p>\n\n<pre><code>rails d devise user\nrails d devise:views\nrails d devise:install\n</code></pre>\n\n<p>and then re installing devise, it did not help. Any ideas?</p>\n"},{"tags":["ruby-on-rails","shopify"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12958504,"title":"ShopifyAPI: Product find since_id strangeness","body":"<p>there is something strange going on with the Shopify API, I cannot understand what I am doing wrong.</p>\n\n<p>I'd like to get from Shopify a list of all the products so I use the following code:</p>\n\n<pre><code>def get_all_products_from_shopify\n  limit = 250\n  all_products = Array.new\n\n  self.connect_to_store\n  products = ShopifyAPI::Product.find(:all, :params =&gt; {:limit =&gt; limit})\n\n  all_products = all_products.concat products\n  puts products.length\n  while products.length == limit do\n    since_id = products.last.id\n    products = ShopifyAPI::Product.find(:all, :params =&gt; {:limit =&gt; limit, :since_id =&gt; since_id})\n    all_products = all_products.concat products\n  end\n  ShopifyAPI::Base.site = nil\n  return all_products\nend\n</code></pre>\n\n<p>The issue is that I have 251 products on Shopify but with this method I retrieve an array of products that has a size of 277 elements.\nWhy?</p>\n\n<p>Also if I do:</p>\n\n<pre><code>products = ShopifyAPI::Product.count\n&gt; 251\n\nproducts = ShopifyAPI::Product.find(:all, :params =&gt; {:limit =&gt; limit})\nproducts.count\n&gt;250\nsince_id = products.last.id\nShopifyAPI::Product.count(since_id: since_id)\n&gt;26\n</code></pre>\n\n<p>Can anybody tell me what am I doing wrong?</p>\n\n<p>Thanks,\nAugusto</p>\n"},{"tags":["mysql","ruby-on-rails","database","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":330,"score":0,"question_id":9779998,"title":"rail servers error? (rails 3) in windows","body":"<p>I created a new project using the command:</p>\n\n<blockquote>\n  <p>rails new simple_cms -d mysql </p>\n</blockquote>\n\n<p>but when I try to launch the web server, this happens:  </p>\n\n<pre><code>C:\\Users\\johnny\\Sites\\simple_cms&gt;rails server\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in `require': 193: %1 is not a valid Win32 application.   - C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/1.9/mysql2.so (LoadError)\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2.rb:9:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2.rb:9:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:68:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:68:in `block (2 levels) in require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:66:in `each'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:66:in `block in require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:55:in `each'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:55:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler.rb:119:in `require'\n    from C:/Users/johnny/Sites/simple_cms/config/application.rb:7:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:53:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:53:in `block in &lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:50:in `tap'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n\nC:\\Users\\johnny\\Sites\\simple_cms&gt;\n</code></pre>\n\n<p>Some version info just in case:</p>\n\n<pre><code>C:\\Users\\j\\Sites\\simple_cms&gt;ruby -v\nruby 1.9.3p125 (2012-02-16) [i386-mingw32]\n\nC:\\Users\\j\\Sites\\simple_cms&gt;ruby -v\nruby 1.9.3p125 (2012-02-16) [i386-mingw32]\n\nC:\\Users\\j\\Sites\\simple_cms&gt;mysql --version\nmysql  Ver 14.14 Distrib 5.5.21, for Win64 (x86)\n</code></pre>\n\n<p>I've already searched the web looking for solutions, but none of them\nseem to work. Any help would be greatly appreciated, thank you.</p>\n"},{"tags":["ruby-on-rails","ruby","character-encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13193794,"title":"Ruby on Rails - encoding issue","body":"<p>I am running a RoR app that pulls data from some event tables which are using utf8_general_ci as collation.</p>\n\n<p>The problem is that all my pages render stuff like this:</p>\n\n<p>Atat�rk Stadi Nov 02 20:00</p>\n\n<p>So far I have tried:\n- changing the encoding within application.rb</p>\n\n<ul>\n<li><p>adding</p>\n\n<pre><code>&lt;meta charset=\"utf-8\" /&gt;\n</code></pre></li>\n<li><p>adding </p>\n\n<pre><code>content=\"text/html;charset=utf-8\"\n</code></pre></li>\n<li><p>all combinations of above tags with all possible relevant encodings that may apply to our content.</p></li>\n</ul>\n\n<p>Document type is </p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n</code></pre>\n\n<p></p>\n\n<p>I have also tried HTML5 and other variations. </p>\n\n<p>I have not yet tried the iconv solution, would prefer not having to go down that road.</p>\n\n<p>Does anyone have any idea on how to resolve this?</p>\n\n<p>Thank you!\nN.</p>\n"},{"tags":["ruby-on-rails","ruby","datetime"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":290,"score":0,"question_id":10463400,"title":"Age calculation in Ruby","body":"<p>I'm trying to write a rails application but presently the display for the date of birth is shown like the normal date format, but I wouldl love to show in views the age instead</p>\n\n<p>The method I have in controller is below and I have a column DOb in my database for date of birthL</p>\n\n<pre><code>def age\n  @user = user\n  now = Time.now.utc.to_date\n  now.year - @user.dob.year - (@user.dob.to_date.change(:year =&gt; now.year) &gt; now ? 1 : 0)\nend\n</code></pre>\n\n<p>It shows like DOB: 23/5/2011, but I would like it to be age in years instead.</p>\n\n<p>How do I also put a validator that checks if age is below 18 years?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13196599,"title":"Using a params condition to display a link_to when a user visits the show action on a specific controller","body":"<p>How does one setup a condition if 'post_controller/show' is viewed.</p>\n\n<p>I would like an 'Edit' button to display on the header navigation if the user is viewing the post, without setting up a different layout and have it just rely on the existing <code>_header.html.erb</code> for navigation.</p>\n\n<pre><code># Header navigation partial _header.html.erb\n&lt;%= link_to 'Edit post', edit_post_path(@post) %&gt;\n</code></pre>\n\n<p>I know I can take a param and set clause something like:</p>\n\n<pre><code>&lt;% if params[:id] %&gt;\n  &lt;%= link_to 'Edit post', edit_post_path(@post) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem with the above is it will cause an exception <code>undefined method 'edit_post'</code> if you visit a different route that doesn't relate to the Post model.</p>\n\n<p>If I can get away from many layouts and partials that would great but if the suggestion is that I should be using layouts and partials in this scenario then I will.</p>\n\n<p>Many thanks all.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":11,"favorite_count":11,"up_vote_count":31,"down_vote_count":0,"view_count":7998,"score":31,"question_id":819263,"title":"Get person's age in Ruby","body":"<p>I'd like to get a person's age from its birthday. <code>now - birthday / 365</code> doesn't work, because some years have 366 days. I came up with the following code:</p>\n\n<pre><code>now = Date.today\nyear = now.year - birth_date.year\n\nif (date+year.year) &gt; now\n  year = year - 1\nend\n</code></pre>\n\n<p>Is there a more Ruby'ish way to calculate age?</p>\n"},{"tags":["ruby-on-rails","nested-forms","has-one"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1751,"score":1,"question_id":5576895,"title":"Cannot get nested form with a has_one association to work","body":"<p>I have these models:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_one :city\n    accepts_nested_attributes_for :city\nend\n\nclass City &lt; ActiveRecord::Base\n    belongs_to :user\nend\n</code></pre>\n\n<p>This controller action:</p>\n\n<pre><code>   def create\n    @user = User.new(params[:user])\n\n    respond_to do |format|\n      if @user.save\n        format.html { redirect_to(@user, :notice =&gt; 'User was successfully created.') }\n        format.xml  { render :xml =&gt; @user, :status =&gt; :created, :location =&gt; @user }\n      else\n        format.html { render :action =&gt; \"new\" }\n        format.xml  { render :xml =&gt; @user.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>and this view:</p>\n\n<p>&lt;%= form_for :user,:url => users_path,:method => :post do |f| %></p>\n\n<pre><code>  &lt;%= f.fields_for :city do |b| %&gt;\n    &lt;%= b.collection_select :id,City.all,:id,:name %&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I am trying to allow the user to select a city from the list of already added cities. I am trying to present him a select. The select part it works, but the generated html code for it, looks like this:</p>\n\n<pre><code>&lt;select name=\"user[city][id]\" id=\"user_city_id\"&gt;\n   &lt;option value=\"1\"&gt;One&lt;/option&gt;\n   &lt;option value=\"2\"&gt;Two&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>Notice that it's name doesn't have <code>attribute</code> anywhere. So, when I try to save it, I get this error:</p>\n\n<pre><code>City(#37815120) expected, got ActiveSupport::HashWithIndifferentAccess(#32969916)\n</code></pre>\n\n<p>How can I fix this?</p>\n\n<p>EDIT: there is some progress, I tried to change the fields_for to this:</p>\n\n<pre><code>&lt;%= f.fields_for :city_attributes do |b| %&gt;\n    &lt;%= b.collection_select :id,City.all,:id,:name %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and now, the html seems to generate correctly. But I get this error now:</p>\n\n<pre><code>Couldn't find City with ID=1 for User with ID=\n</code></pre>\n\n<p>I have no idea what to do next.</p>\n\n<p>EDIT2: overriding the <code>city_attributes=</code> method seems to work:</p>\n\n<pre><code>def city_attributes=(attribs)\n    self.city = City.find(attribs[:id])\nend\n</code></pre>\n\n<p>I don't know if it's the way to go, but it seems good.</p>\n"}]}
{"total":93231,"page":13,"pagesize":100,"questions":[{"tags":["sql","ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13193665,"title":"Rails select rows from a table where a related table's all rows have a certain value","body":"<p>Basically I have 3 tables. Ignore the syntax. I just wanted to show the idea.</p>\n\n<pre><code>ModelA:\n    belongs_to :ModelB\n\nModelB:\n    has_many: ModelA\n    has_and_belongs_to_many :ModelC\n\nModelC\n    has_and_belongs_to_many :ModelB\n</code></pre>\n\n<p>How can I get all the rows from ModelA where all rows of ModelC have flag = 'Y'?<br>\nI've tried:  </p>\n\n<pre><code>ModelA.joins(:ModelB =&gt; :ModelC).where(\"#{ModelC.table_name}.flag = 'Y'\")\n</code></pre>\n\n<p>and dozen other ways without success. I know the code above doesn't check all the rows, but that's as far as I've got. I would prefer using ActiveRecord.</p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13195169,"title":"How to hide a form field and still have it submit all the fields?","body":"<p>I've got this rails form partial:</p>\n\n<pre><code>&lt;%= form_for @ptab, :remote =&gt; true, :html =&gt; { :class =&gt; 'form-horizontal' } do |f| %&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label :name, :class =&gt; 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.text_field :name, :class =&gt; 'text_field', :placeholder =&gt; 'Enter a name...' %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label :address, :class =&gt; 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.text_field :address, :class =&gt; 'text_field', :placeholder =&gt; 'Paste a link...' %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label :sequence, :class =&gt; 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.number_field :sequence, :class =&gt; 'number_field', :placeholder =&gt; 'Enter an order number...' %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"control-group\"&gt;\n    &lt;%= f.label :gtab_id, :class =&gt; 'control-label' %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= f.number_field :gtab_id, :class =&gt; 'number_field' %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n\n    &lt;div class=\"modal-footer\"&gt;\n                &lt;%= f.submit nil, :class =&gt; 'btn btn-primary' %&gt;\n                &lt;!-- &lt;%= link_to t('.cancel', :default =&gt; t(\"helpers.links.cancel\")), ptabs_path, :class =&gt; 'btn' %&gt; --&gt; &lt;!-- this was the original cancel button --&gt;\n                &lt;a data-dismiss=\"modal\" class=\"btn\" href=\"#\"&gt;Close&lt;/a&gt;\n     &lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>I would like to turn the field in the last .control-group into a hidden field, but I still want it to be submitted to the controller.</p>\n\n<p>What should I change this to :</p>\n\n<pre><code>&lt;div class=\"control-group\"&gt;\n        &lt;%= f.label :gtab_id, :class =&gt; 'control-label' %&gt;\n        &lt;div class=\"controls\"&gt;\n          &lt;%= f.number_field :gtab_id, :class =&gt; 'number_field' %&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p>In order for it to not show in the rendered form but still be submitted with the form?</p>\n"},{"tags":["ruby-on-rails","ruby","encoding","character-encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":261,"score":0,"question_id":7327461,"title":"Is there a solution to the character encoding problem (\"�\") for Rails 2 / Ruby 1.8.7?","body":"<p>From the <a href=\"http://weblog.rubyonrails.org/2010/8/29/rails-3-0-it-s-done\" rel=\"nofollow\">Rails 3 announcement</a> listing the major new features:</p>\n\n<blockquote>\n  <p>Say goodbye to encoding issues</p>\n  \n  <p>If you browse the Internet with any frequency, you will likely encounter the � character. This problem is extremely pervasive, and is caused by mixing and matching content with different encodings.</p>\n  \n  <p>In a system like Rails, content comes from the database, your templates, your source files, and from the user. Ruby 1.9 gives us the raw tools to eliminate these problems, and in combination with Rails 3, � should be a thing of the past in Rails applications. Never struggle with corrupted data pasted by a user from Microsoft Word again!</p>\n</blockquote>\n\n<p>I have an app where users often paste in text from MS Word and we encounter exactly this issue.</p>\n\n<p>However we're running Rails 2 and Ruby 1.8.7. There is no immediate prospect of changing this.</p>\n\n<p>I think the encoding problem usually manifests with typographer's quotes (\"curly quotes\"). Probably also things like em dashes and the elipses character.</p>\n\n<p>I'm wondering if there's routine I can run on the incoming data to overcome this problem.</p>\n\n<p>It's OK if the quotes get turned into straight quotes, elipses get turned into three periods, etc.</p>\n\n<p>It could even be a utility that runs on the system level that I could call from my app with </p>\n\n<pre><code>processed_data = `system_command #{params[:incoming_data]}`\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13184406,"title":"Can 'rake db:seed' tell you which record it is choking on?","body":"<p>When seeding data, I sometimes get an error like this:</p>\n\n<pre><code>Owner(#70279918514200) expected, got String(#70279913263500)\n</code></pre>\n\n<p>Would it be possible for Rake to tell me what record it is choking on?</p>\n\n<p>EDIT:</p>\n\n<p>This has a little more info on what I'm looking for:</p>\n\n<p>I have a flat file which indicates the data I need. This file was created from an unvalidated database that had many different spelling for things like Proctor (and|y|avec|gen) Gamble. I have been able to translate almost all of them, but there have been some that slip through the cracks and still give me trouble. Would it be possible to see from rake which line of the flat file when I run</p>\n\n<pre><code>flat_file.each_line\n</code></pre>\n\n<p>is causing trouble?</p>\n"},{"tags":["ruby-on-rails","devise","rails-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13196032,"title":"undefined method `[]' for nil:NilClass devise and rails-api","body":"<p>I generate project with rails-api. I have added and installed devise gem. After I add before_filter authenticate_user! to Products Controller. I have get following error.</p>\n\n<p><a href=\"https://gist.github.com/4001323\" rel=\"nofollow\">https://gist.github.com/4001323</a></p>\n\n<p>Someone can help? Thanks</p>\n"},{"tags":["ruby-on-rails","parameters","helpermethods"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13183612,"title":"How to Pass ActiveRecord Objects as Parameters to Helper Methods in Rails","body":"<p>Many helper methods, such as redirect_to, link_to, and url_for, can take an ActiveRecord object as a parameter instead of a hash that specifies the controller and action.  I've seen the parameter passed different ways in different documentation.  It sometimes gets passed as a symbol, sometimes as an instance variable, and sometimes as a local variable. </p>\n\n<p>I'm confused about how the different parameter styles get expanded to return urls.  I know that following REST conventions should create a url constructed of a controller and action but am unsure when Rails needs a specific parameter style to construct that url.  Please help me understand the use cases for passing the ActiveRecord object as a symbol, an instance variable, or a local variable.  Are there different requirements based on the method call?  Or are there underlying differences in url construction?  </p>\n\n<p>Here are some examples:</p>\n\n<p>From the API docs:  </p>\n\n<pre><code>link_to \"Profile\", @profile  \nredirect_to post  \n&lt;%= url_for(@workshop) %&gt;  \n&lt;%= form_for :person do |f| %&gt; (this is described as the “generic #form_for”)\n</code></pre>\n\n<p>From the Ruby on Rails Guides:  </p>\n\n<pre><code>&lt;%= link_to 'New book', new_book_path %&gt;  \nredirect_to(@book)  \nform_for(@article)  \n</code></pre>\n\n<p>From the Rails 3 Way:  </p>\n\n<pre><code>'link_to' \"Help\", help_widgets_path, :popup =&gt; 1  \nredirect_to post  \nurl_for(timesheets_path)  \nform_for offer do |f|  \n</code></pre>\n\n<p>Note: Upon further research, it seems that form_for is able to accept a local variable in the case where the calling view template passes a :locals hash as a parameter.  The keys are the locals that can be used in the partial and the values are the instance variables from the template. Is that the correct understanding?</p>\n"},{"tags":["ruby-on-rails","ubuntu","deployment","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13130918,"title":"Сapistrano: cannot access `~/releases/' : No such file or directory","body":"<p>After I did <code>bundle update</code> both on my local machine and server, I am not able to deploy anymore. The error I get is kind of permissions, as I guess, but I can't get what's happening:</p>\n\n<pre><code>cap deploy\n  * 2012-10-30 02:48:45 executing `deploy'\n  * 2012-10-30 02:48:45 executing `deploy:update'\n ** transaction: start\n  * 2012-10-30 02:48:45 executing `deploy:update_code'\n    executing locally: \"git ls-remote ssh://ubuntu@robotinthecloak.com/~/git/strana_cvetov.git HEAD\"\nubuntu@robotinthecloak.com's password: \n    command finished in 7500ms\n  * executing \"git clone -q --depth 1 ssh://ubuntu@robotinthecloak.com/~/git/strana_cvetov.git ~/rails_apps/strana_cvetov/releases/20121029224852 &amp;&amp; cd ~/rails_apps/strana_cvetov/releases/20121029224852 &amp;&amp; git checkout -q -b deploy 672780789da61c81640fe7fbd2728064d0f89db3 &amp;&amp; (echo 672780789da61c81640fe7fbd2728064d0f89db3 &gt; ~/rails_apps/strana_cvetov/releases/20121029224852/REVISION)\"\n    servers: [\"robotinthecloak.com\"]\nPassword: \n    [robotinthecloak.com] executing command\n ** [robotinthecloak.com :: out] ubuntu@robotinthecloak.com's password:\nPassword: \n ** [robotinthecloak.com :: out]\n    command finished in 2265ms\n  * 2012-10-30 02:48:56 executing `deploy:finalize_update'\n    triggering before callbacks for `deploy:finalize_update'\n  * 2012-10-30 02:48:56 executing `deploy:assets:symlink'\n  * executing \"rm -rf ~/rails_apps/strana_cvetov/releases/20121029224852/public/assets &amp;&amp;\\\\\\n        mkdir -p ~/rails_apps/strana_cvetov/releases/20121029224852/public &amp;&amp;\\\\\\n        mkdir -p ~/rails_apps/strana_cvetov/shared/assets &amp;&amp;\\\\\\n        ln -s ~/rails_apps/strana_cvetov/shared/assets ~/rails_apps/strana_cvetov/releases/20121029224852/public/assets\"\nservers: [\"robotinthecloak.com\"]\n[robotinthecloak.com] executing command\ncommand finished in 162ms\n  * executing \"chmod -R -- g+w \\\\~/rails_apps/strana_cvetov/releases/20121029224852 &amp;&amp; rm -rf -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/public/system &amp;&amp; mkdir -p -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/public/ &amp;&amp; ln -s -- ~/rails_apps/strana_cvetov/shared/system \\\\~/rails_apps/strana_cvetov/releases/20121029224852/public/system &amp;&amp; rm -rf -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/log &amp;&amp; ln -s -- ~/rails_apps/strana_cvetov/shared/log \\\\~/rails_apps/strana_cvetov/releases/20121029224852/log &amp;&amp; rm -rf -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/tmp/pids &amp;&amp; mkdir -p -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/tmp/ &amp;&amp; ln -s -- ~/rails_apps/strana_cvetov/shared/pids \\\\~/rails_apps/strana_cvetov/releases/20121029224852/tmp/pids\"\n    servers: [\"robotinthecloak.com\"]\n    [robotinthecloak.com] executing command\n ** [out :: robotinthecloak.com] chmod:\n ** [out :: robotinthecloak.com] cannot access `~/rails_apps/strana_cvetov/releases/20121029224852'\n ** [out :: robotinthecloak.com] : No such file or directory\n ** [out :: robotinthecloak.com] \n    command finished in 205ms\n*** [deploy:update_code] rolling back\n  * executing \"rm -rf ~/rails_apps/strana_cvetov/releases/20121029224852; true\"\n    servers: [\"robotinthecloak.com\"]\n    [robotinthecloak.com] executing command\n    command finished in 167ms\nfailed: \"sh -c 'chmod -R -- g+w \\\\~/rails_apps/strana_cvetov/releases/20121029224852 &amp;&amp; rm -rf -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/public/system &amp;&amp; mkdir -p -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/public/ &amp;&amp; ln -s -- ~/rails_apps/strana_cvetov/shared/system \\\\~/rails_apps/strana_cvetov/releases/20121029224852/public/system &amp;&amp; rm -rf -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/log &amp;&amp; ln -s -- ~/rails_apps/strana_cvetov/shared/log \\\\~/rails_apps/strana_cvetov/releases/20121029224852/log &amp;&amp; rm -rf -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/tmp/pids &amp;&amp; mkdir -p -- \\\\~/rails_apps/strana_cvetov/releases/20121029224852/tmp/ &amp;&amp; ln -s -- ~/rails_apps/strana_cvetov/shared/pids \\\\~/rails_apps/strana_cvetov/releases/20121029224852/tmp/pids'\" on robotinthecloak.com\n</code></pre>\n\n<p>My <code>deploy.rb</code> looks like this:</p>\n\n<pre><code># The name of the app\nset :application, \"strana_cvetov\"\n\n# The address of the remote host\nset :location, \"robotinthecloak.com\"\n\n# setup some Capistrano roles\nrole :app, location\nrole :web, location\nrole :db,  location, :primary =&gt; true\n\n# The directory on the server that will be deployed to\nset :deploy_to, \"~/rails_apps/#{application}\"\n# The type of Source Code Management system\nset :scm, :git\n# The location of the LOCAL repository relative to the current app\nset :repository,  \"ssh://ubuntu@#{location}/~/git/#{application}.git\"\n# The way in which files will be transferred from repository to remote host\nset :deploy_via, :copy\n\nset :use_sudo,            false\n#tell git to clone only the latest revision and not the whole repository\nset :git_shallow_clone,   1\nset :keep_releases,       5\n\n#options necessary to make Ubuntu’s SSH happy\nssh_options[:paranoid]    = false\ndefault_run_options[:pty] = true\n\nset :rails_env, :production\n\n# Set up SSH so it can connect to the EC2 node - assumes your SSH key is in ~/.ssh/id_rsa\nset :user, \"ubuntu\"\n\n# Passenger\nnamespace :deploy do\n  task :start do ; end\n  task :stop do ; end\n  task :restart, :roles =&gt; :app, :except =&gt; { :no_release =&gt; true } do\n    run \"#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}\"\n  end\n\n  namespace :assets do\n    task :precompile, :roles =&gt; :web, :except =&gt; { :no_release =&gt; true } do\n      run \"cd #{current_path} &amp;&amp; #{bundle exec rake} RAILS_ENV=#{rails_env} RAILS_GROUPS=assets assets:precompile --trace\"\n    end\n  end\nend\n\nafter \"deploy:create_symlink\", \"deploy:resymlink\", \"deploy:update_crontab\"\n</code></pre>\n\n<p>When I run <code>deploy:check</code> it says <code>You appear to have all necessary dependencies installed</code>.</p>\n\n<p>I searched the web, this site, tried all solutions I could find, but nothing worked.</p>\n\n<p>Other projects on that server do not deploy too with the same error, but a couple of days ago everithing worked just fine, and I touched nothing there. Can anyone plese help me to understand what's going on?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13183617,"title":"How to change the response format depending on the data sent?","body":"<p>I'm doing some controllers to render reports and here is my problem:</p>\n\n<p>The user open a page with a form which let it change the download format and the date of the report.</p>\n\n<p>The download format is set trough a select input.</p>\n\n<p>When the user press the button I want to response depending on the selected format.</p>\n\n<p>The problem is that it's specified trough the url. So trying to do something like:</p>\n\n<pre><code>case format\nwhen \"xlsx\" then format.xlsx{...}\nwhen \"html\" then format.html{...}\n...\nend\n</code></pre>\n\n<p>doesn't work because rails or the browser (I'm not sure) expects an html response.</p>\n\n<p>I've though of two options:</p>\n\n<ol>\n<li><p>Change the url of the form <code>onsubmit</code> which makes the application more dependent on javascript. Or.</p></li>\n<li><p><code>redirect_to url + \".#{params[:download_format]}\"</code></p></li>\n</ol>\n\n<p>The second way looks better to me but I need to pass the <code>:report_date</code> in the url and I can't find the way to do it.</p>\n\n<p>I've tried this:</p>\n\n<pre><code>url = my_custom_url_path\nredirect_to url + \".#{params[:download_format]}\", :date_format =&gt; params[:date_format]\n</code></pre>\n\n<p>But it's not working.</p>\n"},{"tags":["sql","ruby-on-rails","query","sum"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13189390,"title":"Rails select and sort by aggregate of has_many","body":"<p>I have a Course model which has_many reviews. My Review model has a rating field. What I would like is a query to find the top rated courses. I want to do this in the SQL in order to avoid returning all the course objects and then trying to rank and sort them.</p>\n"},{"tags":["ruby-on-rails","routes"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13195542,"title":"Get routes from database in Rails","body":"<p>How to load routes from database?\nI have table <strong>Post</strong> with column :url. There is part of the url in this column, e.g.:</p>\n\n<ul>\n<li>about</li>\n<li>progs/us</li>\n<li>progs/us/info</li>\n<li>empty</li>\n<li>etc.</li>\n</ul>\n\n<p>How to set routes for this? Result example:</p>\n\n<pre><code>http://mysite.com/progs/us for the page http://mysite/posts/2\n</code></pre>\n"},{"tags":["ruby-on-rails","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13121080,"title":"Request spec failing from Rails Tutorial from Michael Hartl","body":"<p>I have a request spec that is failing even thought it should be passing. ALL of the content the spec is looking for  appears in the source ( HTML ) of the app. These test should be passing as far as I can tell.I'm going to list in order:</p>\n\n<ul>\n<li>The test</li>\n<li>The helper helper method full_title that is used in the test</li>\n<li>The relevant view templates in haml</li>\n<li>The HTML output of the home page or root route</li>\n<li>The Rspec failures</li>\n<li>The Gemfile</li>\n<li>The layout file</li>\n</ul>\n\n<p>Here is the spec code:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"Static pages\" do\n\n  describe \"Home page\" do\n    before { visit root_path }\n\n    it { should have_selector('h1', text: 'Sample App') } \n    it { should have_selector('title', text: full_title('')) }\n    it { should_not have_selector('title', text: ' | Home') }\n  end\n\n  describe \"Help page\" do\n    before { visit help_path }\n\n    it { should have_selector('h1', text: 'Help') }\n    it { should have_selector('title', text: full_title('Help')) }\n  end\n\n  describe \"About page\" do\n    before { visit about_path }\n\n    it { should have_selector('h1', text: 'About') }\n    it { should have_selector('title', text: full_title('About Us')) }\n  end\n\n  describe \"Contact page\" do\n    before { visit contact_path }\n\n    it { should have_selector('h1', text: 'Contact') }\n    it { should have_selector('title', text: full_title('Contact')) }\n\n  end\nend\n</code></pre>\n\n<p>Here is the helper method <code>full_title</code>:</p>\n\n<pre><code>module ApplicationHelper\n  def full_title(page_title)\n    base_title = \"Ruby on Rails Tutorial Sample App\"\n    if page_title.empty?\n      base_title\n    else\n      \"#{base_title} | #{page_title}\" \n    end\n  end\nend\n</code></pre>\n\n<p>The home view or /home route:</p>\n\n<pre><code>.center.hero-unit\n  %h1\n    Welcome to the Sample App \n  %h2\n    This is the home page for the \n    %a{ href: \"http://railstutorial.org\"}Ruby on Rails Tutorial sample app\n\n  = link_to \"Sign up now!\", '#', class: \"btn btn-large btn-primary\"\n\n= link_to image_tag(\"rails.png\", alt: \"Rails\"), 'http://rubyonrails.org'\n</code></pre>\n\n<p>The about page:</p>\n\n<pre><code>- provide(:title, 'About Us')\n%body\n  %h1\n    About Us\n\n  %p\n    The \n    %a(href=\"http://railstutorial.org/\")Ruby on Rails Tutorial\n    is a project to make a book and screencasts to teach web development with\n    %a(href=\"http://rubyonrails.org/\")Ruby on Rails\n    This is the sample application for the tutorial\n</code></pre>\n\n<p>The help page:</p>\n\n<pre><code>- provide(:title, 'Help')\n%body\n  %h1\n    Help\n  %p\n    Get help on the Ruby on Rails Tutorial at the\n    %a(href=\"http://railstutorial.org/help\")Rails tutorial help page\n    To get help on this sample app, see the\n    %a(href=\"http://railstutorial.org/book\")Rails Tutorial book\n</code></pre>\n\n<p>The contact page:</p>\n\n<pre><code>- provide(:title, 'Contact')\n%h1 Contact\n%p\n  Contact ruby on Rails Tutorial about the sample app at the \n  %a{ href: \"http://railstutorial.org/contact\"}Contact page\n</code></pre>\n\n<p>The HTML for the home page:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;Ruby on Rails Tutorial Sample App&lt;/title&gt;\n    &lt;link href=\"/assets/application.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n    &lt;link href=\"/assets/custom.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n    &lt;link href=\"/assets/static_pages.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n    &lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script src=\"/assets/static_pages.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;script src=\"/assets/application.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n    &lt;meta content=\"authenticity_token\" name=\"csrf-param\" /&gt;\n    &lt;meta content=\"KLYiW09+IfyIcxG2jcCX8tt3vts7aCTzYuiYA0ks8tM=\" name=\"csrf-token\" /&gt;\n    &lt;!--[if lt IE 9]&gt;\n&lt;script src=\"http://html5shim.googlecode.com/svn/trunk/html5.js\"&gt;&lt;/script&gt;\n[![endif]--&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;header class='navbar navbar-fixed-top'&gt;\n      &lt;div class='navbar-inner'&gt;\n        &lt;div class='container'&gt;\n          &lt;a href=\"/\" id=\"logo\"&gt;sample app&lt;/a&gt;\n          &lt;nav&gt;\n            &lt;ul class='nav pull-right'&gt;\n              &lt;li&gt;&lt;a href=\"/\"&gt;Home&lt;/a&gt;&lt;/li&gt;\n              &lt;li&gt;&lt;a href=\"/help\"&gt;help&lt;/a&gt;&lt;/li&gt;\n              &lt;li&gt;&lt;a href=\"#\"&gt;Sign in&lt;/a&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n          &lt;/nav&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/header&gt;\n    &lt;div class='container'&gt;\n      &lt;div class='center hero-unit'&gt;\n        &lt;h1&gt;\n          Welcome to the Sample App\n        &lt;/h1&gt;\n        &lt;h2&gt;\n          This is the home page for the\n          &lt;a href='http://railstutorial.org'&gt;Ruby on Rails Tutorial sample app&lt;/a&gt;\n        &lt;/h2&gt;\n        &lt;a href=\"#\" class=\"btn btn-large btn-primary\"&gt;Sign up now!&lt;/a&gt;\n      &lt;/div&gt;\n      &lt;a href=\"http://rubyonrails.org\"&gt;&lt;img alt=\"Rails\" src=\"/assets/rails.png\" /&gt;&lt;/a&gt;\n      &lt;footer class='footer'&gt;\n        &lt;small&gt;\n          &lt;a href='http://railstutorial.org'&gt;Rails Tutorial by Michael Hartl&lt;/a&gt;\n        &lt;/small&gt;\n        &lt;nav&gt;\n          &lt;ul&gt;\n            &lt;li&gt;&lt;a href=\"/about\"&gt;About&lt;/a&gt;&lt;/li&gt;\n            &lt;li&gt;&lt;a href=\"/contact\"&gt;Contact&lt;/a&gt;&lt;/li&gt;\n            &lt;li&gt;\n              &lt;a href='http://railstutorial.org'&gt;News&lt;/a&gt;\n            &lt;/li&gt;\n          &lt;/ul&gt;\n        &lt;/nav&gt;\n      &lt;/footer&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The Rspec failures:</p>\n\n<pre><code>FF.FFFFFF\n\nFailures:\n\n  1) Static pages Home page \n     Failure/Error: it { should have_selector('h1', text: 'Sample App') }\n       expected css \"h1\" with text \"Sample App\" to return something\n     # ./spec/requests/static_pages_spec.rb:8:in `block (3 levels) in &lt;top (required)&gt;'\n\n  2) Static pages Home page \n     Failure/Error: it { should have_selector('title', text: full_title('')) }\n       expected css \"title\" with text \"Ruby on Rails Tutorial Sample App\" to return something\n     # ./spec/requests/static_pages_spec.rb:9:in `block (3 levels) in &lt;top (required)&gt;'\n\n  3) Static pages Help page \n     Failure/Error: it { should have_selector('h1', text: 'Help') }\n       expected css \"h1\" with text \"Help\" to return something\n     # ./spec/requests/static_pages_spec.rb:16:in `block (3 levels) in &lt;top (required)&gt;'\n\n  4) Static pages Help page \n     Failure/Error: it { should have_selector('title', text: full_title('Help')) }\n       expected css \"title\" with text \"Ruby on Rails Tutorial Sample App | Help \" to return something\n     # ./spec/requests/static_pages_spec.rb:17:in `block (3 levels) in &lt;top (required)&gt;'\n\n  5) Static pages About page \n     Failure/Error: it { should have_selector('h1', text: 'About') }\n       expected css \"h1\" with text \"About\" to return something\n     # ./spec/requests/static_pages_spec.rb:23:in `block (3 levels) in &lt;top (required)&gt;'\n\n  6) Static pages About page \n     Failure/Error: it { should have_selector('title', text: full_title('About Us')) }\n       expected css \"title\" with text \"Ruby on Rails Tutorial Sample App | About Us \" to return something\n     # ./spec/requests/static_pages_spec.rb:24:in `block (3 levels) in &lt;top (required)&gt;'\n\n  7) Static pages Contact page \n     Failure/Error: it { should have_selector('h1', text: 'Contact') }\n       expected css \"h1\" with text \"Contact\" to return something\n     # ./spec/requests/static_pages_spec.rb:30:in `block (3 levels) in &lt;top (required)&gt;'\n\n  8) Static pages Contact page \n     Failure/Error: it { should have_selector('title', text: full_title('Contact')) }\n       expected css \"title\" with text \"Ruby on Rails Tutorial Sample App | Contact \" to return something\n     # ./spec/requests/static_pages_spec.rb:31:in `block (3 levels) in &lt;top (required)&gt;'\n\nFinished in 0.34035 seconds\n9 examples, 8 failures\n\nFailed examples:\n\nrspec ./spec/requests/static_pages_spec.rb:8 # Static pages Home page \nrspec ./spec/requests/static_pages_spec.rb:9 # Static pages Home page \nrspec ./spec/requests/static_pages_spec.rb:16 # Static pages Help page \nrspec ./spec/requests/static_pages_spec.rb:17 # Static pages Help page \nrspec ./spec/requests/static_pages_spec.rb:23 # Static pages About page \nrspec ./spec/requests/static_pages_spec.rb:24 # Static pages About page \nrspec ./spec/requests/static_pages_spec.rb:30 # Static pages Contact page \nrspec ./spec/requests/static_pages_spec.rb:31 # Static pages Contact page \n</code></pre>\n\n<p>The Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\ngem 'haml-rails'\ngem 'bootstrap-sass', '2.0.0'\ngem 'capybara', '1.1.2'\n\ngroup :development, :test do\n  gem 'sqlite3' , '1.3.5'\n  gem 'rspec-rails', '2.10.0'\nend\n\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\n\n\n# Gems used only for assets and not required\n# in production environments by default.\n\ngroup :assets do\n  gem 'sass-rails',   '3.2.4'\n  gem 'coffee-rails', '3.2.2'\n  gem 'uglifier', '1.2.3'\nend\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\ngem 'jquery-rails'\n\ngroup :test do\n  gem 'capybara', '1.1.2'\nend\n\ngroup :production do\n  gem 'pg', '0.12.2'\nend\n\n\n# To use ActiveModel has_secure_password\n# gem 'bcrypt-ruby', '~&gt; 3.0.0'\n\n# To use Jbuilder templates for JSON\n# gem 'jbuilder'\n\n# Use unicorn as the app server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n# gem 'capistrano'\n\n# To use debugger\n# gem 'debugger'\n</code></pre>\n\n<p>The layout file</p>\n\n<pre><code>!!! 5\n%html\n  %head\n    %title= full_title(yield(:title))\n    = stylesheet_link_tag    \"application\", :media =&gt; \"all\" \n    = javascript_include_tag \"application\" \n    = csrf_meta_tags \n    = render 'layouts/shim'\n  %body\n    = render 'layouts/header'\n    .container\n      = yield\n      = render 'layouts/footer'\n</code></pre>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13194003,"title":"Can I use CSS assets and the public folder in the same app?","body":"<p>I have a legacy application that I'd like to migrate to use the Rails 3 asset pipeline. I have upwards of 100 stylesheets which are imported on a template by template basis using a </p>\n\n<pre><code>content_for :stylesheets\n</code></pre>\n\n<p>block.</p>\n\n<p>Compiling them all into a single stylesheet is not currently a goer as the code was written to expect only certain stylesheets on certain pages, so for example the login page imports a stylesheet which redefines <em>article form</em>. It would not be good to redefine this on all pages.</p>\n\n<p>Is there a way to migrate slowly to the assets pipeline having the app look first for a <strong>compiled asset</strong>, and then having it failover to the <strong>public/stylesheets</strong> directory?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13031774,"title":"custom actions inside rails_admin gem","body":"<p>I don't understand very good yet how it works <a href=\"https://github.com/sferik/rails_admin\" rel=\"nofollow\">rails_admin gem</a> for create a new action.</p>\n\n<p>I want create a action with name <strong>balance</strong> in rails_admin root.</p>\n\n<p>I have created a file with name <strong>rails_admin_balance.rb</strong> inside <strong>myapp/lib</strong> folder like:</p>\n\n<pre><code>require 'rails_admin/config/actions'\nrequire 'rails_admin/config/actions/base'\n\nmodule RailsAdminBalance\nend\n\nmodule RailsAdmin\n  module Config\n    module Actions\n      class Balance &lt; RailsAdmin::Config::Actions::Base\n       RailsAdmin::Config::Actions.register(self)\n        register_instance_option :object_level do\n          true\n        end\n        register_instance_option :link_icon do\n         'icon-eye-open'\n        end\n        register_instance_option :root? do\n          true\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I have created a new file on <strong>/views/rails_admin/main/balance.html.erb</strong></p>\n\n<p>inside my <code>rails_admin.rb</code> file I have</p>\n\n<pre><code>config.actions do\n dashboard                     # mandatory\n # collection actions \n index                         # mandatory\n new\n export\n history_index\n bulk_delete\n # member actions\n show\n edit\n delete\n history_show\n show_in_app\n balance \nend\n</code></pre>\n\n<p>When I try run rails server I get this error:</p>\n\n<p>Exiting</p>\n\n<pre><code>/home/ubuntu/Desktop/myapp/config/initializers/rails_admin.rb:33:in `block (2 levels) in &lt;top (required)&gt;': undefined method `balance' for RailsAdmin::Config::Actions:Module (NoMethodError)....\n</code></pre>\n\n<p>Where have I the error?</p>\n\n<p>What am I doing bad?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","testing","rake","fixtures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13195097,"title":"Changing a rake task to work on test environment","body":"<pre><code>  namespace :fixtures do\n    namespace :load do \n      task :prepare =&gt; :environment do\n        ENV['FIXTURES_PATH'] = \"spec/fixtures\"\n        ENV['RAILS_ENV'] ||= \"test\"\n        puts ENV.inspect\n        Rake::Task[\"db:fixtures:load\"].invoke\n      end\n    end\n  end\n</code></pre>\n\n<p>I have added this to a special.rake file in ./lib/tasks in order to cause the rake db:fixtures:load command to apply to fixtures in the spec/fixtures directory, and to apply to the test environment.</p>\n\n<p>It's not working. Does anyone see where I have gone wrong? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12029862,"title":"how add test data to my local sqlite in rails 3?","body":"<p>I need to add rows of test data to my sqlite.</p>\n\n<pre><code>INSERT INTO courses (`name`) VALUES\n(‘java'),\n(‘ruby').......\n</code></pre>\n\n<p>How can i do it with rails3?</p>\n\n<p>Thanks</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13194916,"title":"Act_as_taggable_on tags belonging to user","body":"<p>I am struggling to use act_as_taggable_on and rails3-jquery-autocomplete together.</p>\n\n<p>In my case tage name should belong to different users. So when a user starts typing only tag names created by the user should show up in autocomplete.</p>\n\n<p>For that I somehow have to modify act_as_taggable_on to also save the id of the user.\n(I don't care about the user creating the actual tag. But I need all the tag names the user already used)</p>\n\n<p>Until now all tag names created by all users are shown in autocomplete.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13194842,"title":"ArgumentError: invalid byte sequence in UTF-8","body":"<p>I am new to rails, I am using rails 3.2.3 in windows7. I have a project in rails when i run bundle install it was successful. And the rails server also working good. When i give localhost:3000 it throws an error like this,</p>\n\n<pre><code> ERROR ArgumentError: invalid byte sequence in UTF-8\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/win32console-1.3.2-x86-mingw32/lib/Win32/Console/ANSI.rb:163:in `sub!'\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/win32console-1.3.2-x86-mingw32/lib/Win32/Console/ANSI.rb:163:in `_PrintString'\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/win32console-1.3.2-x86-mingw32/lib/Win32/Console/ANSI.rb:146:in `block in write'\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/win32console-1.3.2-x86-mingw32/lib/Win32/Console/ANSI.rb:146:in `each'\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/win32console-1.3.2-x86-mingw32/lib/Win32/Console/ANSI.rb:146:in `write'\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/rack/log_tailer.rb:29:in `print'\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/rack/log_tailer.rb:29:in `tail!'\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/rack/log_tailer.rb:18:in `call'\n    c:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'\n    c:/Ruby193/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n    c:/Ruby193/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n    c:/Ruby193/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n\n<p>i am unable to figure out where the exact problem. I searched in google but no relevent solution. Can anyone help me.</p>\n"},{"tags":["ruby-on-rails","redmine","redmine-plugins"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13194653,"title":"rake redmine:plugins:migrate is not executing","body":"<p><code>rake redmine:plugins:migrate</code> is not executing, whenever i try to execute this command, it gives error.</p>\n\n<pre><code>rake aborted!\nDon't know how to build task 'redmine:plugins:migrate'\n</code></pre>\n"},{"tags":["ruby-on-rails","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":10593540,"title":"Paperclip not create thumbnail if original file is too small","body":"<p>I use paperclip and setup following.</p>\n\n<pre><code>has_attached_file :attached,\n      :styles =&gt; {\n        :small =&gt; [\"170x170&gt;\", :jpg], :large =&gt; [\"400x400&gt;\", :jpg]\n      }\n</code></pre>\n\n<p>I want that thumbnail is not created if original file is too small.\nExample, if original file is 250x250, \"small thumbnail\" is created(170x170),\nbut, large thumbnail is not created.</p>\n\n<p>But, above setting, both \"small\" and \"large\" is created...</p>\n\n<p>Additionally, I want to switch thumbnail setting.\nExample, \ncase1 : if original file is 250x250, both \"small\" and \"large\" thumbnail is created.\ncase2 : if original file is 250x250, only \"small\" thumbnail is created.</p>\n\n<p>I want to dynamically swith case1 and case2.</p>\n\n<p>Do you have any good ideas?</p>\n"},{"tags":["ruby-on-rails","migration"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":452,"score":3,"question_id":6827106,"title":"Generating rails model for dropped migration","body":"<p>I had a model customer, which I have generated using the following</p>\n\n<blockquote>\n  <p>rails g model Customer name:string</p>\n</blockquote>\n\n<p>After some time, I decided to rename the model to customer_type, to accomplish this we wrote an another migration </p>\n\n<blockquote>\n  <p>rails g migration RenameCutomerToCustomerType</p>\n</blockquote>\n\n<p>everything was smooth until I had the requirement to add the model named customer. When I issued the following command, I've started getting <strong>\"Another migration is already named create_customer\"</strong></p>\n\n<blockquote>\n  <p>rails g model Customer</p>\n</blockquote>\n\n<p>I think this kind of scenario is very common in CRUD based project, please suggest on how to over come this? Is this a limitation with rails?</p>\n"},{"tags":["ruby-on-rails","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13193459,"title":"Rails, use a single delayed_job instance for all applications","body":"<p>I have a server running several RoR applications. Some of them require delayed_job to handle picture resizing and other tasks. At the moment, I'm running delayed_job per each application... this results in a higher memory consumption.</p>\n\n<p>Is it possible to <strong>run a shared delayed_job instance on the server</strong>, that will be used by applications?</p>\n"},{"tags":["ruby-on-rails","mvc","migration"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13191273,"title":"Connect two entities in Rails","body":"<p>I've got two entities: Issue and Project and I need to connect them together. \nIn model/issue.rb I've got:</p>\n\n<pre><code>class Issue &lt; ActiveRecord::Base\n   attr_accessible :description, :estimate, :label, :status, :title\n   belongs_to :project\n   validates :title, :presence =&gt; true\n   validates :estimate, :numericality =&gt; {:greater_than_or_equal_to =&gt; 0.1}\nend\n</code></pre>\n\n<p>and in model/project.rb:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n   attr_accessible :description, :title\n   has_many :issues, :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>And now, I need to create issue under some (selected) project. I know project id, but I don't know it in issue controller. Can you tell me, what should I do? Do I need some new migrations or controllers? Thanks</p>\n\n<p>EDIT</p>\n\n<p>Ruby 1.8.7</p>\n\n<p>Rails 1.9.3</p>\n\n<p>Rake 0.9.2.2</p>\n\n<p>I made new migration:</p>\n\n<pre><code>def self.up\nadd_column :issues, :project_id, :integer, :null =&gt; false\nend\n</code></pre>\n\n<p>but there is no project_id column in issues table.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13193905,"title":"jQuery not working on Rails 3.2.8","body":"<p>I'm having an issue with jQuery on Rails 3.2.8. I've installed the jquery-rails gem and my application.js has the following:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require_tree .\n</code></pre>\n\n<p>views/layouts/application.html.erb has</p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>A simple Javascript test in test.js:</p>\n\n<pre><code>if (jQuery) {\nalert('Jquery is loaded')\n} else {\nalert ('Jquery is not loaded')\n}\n</code></pre>\n\n<p>gives me an alert telling me that jQuery is indeed loaded.</p>\n\n<p>However, no jQuery commands will work, even basic ones are unresponsive:</p>\n\n<pre><code>$(document).ready(function(){\n $(\"a\").click(function(event){\n alert(\"Thanks for visiting!\");\n});\n});\n</code></pre>\n\n<p>I've tried everything -- even reincluding jQuery through the Google API. Any ideas on what might be going on?</p>\n"},{"tags":["ruby-on-rails","coffeescript","erb"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":388,"score":1,"question_id":7956828,"title":"erb won't render in coffeescript file","body":"<p>I'm having trouble figuring out why our ruby code isn't rendering in coffeescript. Ultimately we're working towards plotting a series of markers stored in a Rails model in a Google Maps view. Because we had trouble with a loop, we tried to get a test variable to render in an alert; it's not working. The alert pops up, but it says only <em>Hello</em>, not <em>Hello 5</em> (or <em>Hello \"5\"</em> ?)</p>\n\n<p>This is our coffeescript file (locations.coffee.erb)</p>\n\n<pre><code>$ -&gt;\n    alert \"Hello &lt;%= @test %&gt;\"\n    latlng = new google.maps.LatLng(43.0, -107.0);\n    myOptions =\n        zoom: 5,\n        center: latlng,\n        mapTypeId: google.maps.MapTypeId.ROADMAP\n    map = new google.maps.Map(document.getElementById(\"map_canvas\"), myOptions);\n    point = new google.maps.LatLng(43.0, -107.0);\n    marker = new google.maps.Marker({\n        position: point,\n        map: map,\n        title: \"Test\",\n    });\n</code></pre>\n\n<p>@test is defined in #map, at the bottom of locations_controller.rb:</p>\n\n<pre><code>class LocationsController &lt; ApplicationController\n\n    def show\n        @traveling_party = TravelingParty.find_by_id(session[:party])\n        @location = Location.where(\"position &gt;= #{@traveling_party.position}\").order(\"position ASC\").first\n    end\n\n    def move\n        f = params[:traveling_party]\n\n        @traveling_party = TravelingParty.find(f[\"id\"])\n        @traveling_party.speed = f[\"speed\"].to_i\n        @traveling_party.ration = f[\"ration\"].to_i\n\n        @location = Location.where(\"position &gt; #{@traveling_party.position}\").order(\"position ASC\").first\n\n        @traveling_party.position += @traveling_party.speed\n        if @traveling_party.position &gt; @location.position \n            @traveling_party.position = @location.position\n        end\n\n        food_eaten = @traveling_party.ration * @traveling_party.people\n        Item.where({:trader_id =&gt; @traveling_party.id, :type =&gt; \"Food\"}).limit(food_eaten).destroy_all()\n\n        if @traveling_party.save()\n            flash[:notice] = \"Successfully updated traveling party.\"\n            redirect_to '/play/'\n        else\n            flash[:error] = \"Transaction could not be completed.\"\n            redirect_to '/play/'\n        end\n    end\n\n    def map\n        @traveling_party = TravelingParty.find_by_id(session[:party])\n        @locations = Location.all\n        @test = \"5\"\n    end\n\nend\n</code></pre>\n\n<p>What seems strange to me is that @test is rendering properly in our map.html.erb view. As expected, 5 is printed above the map:</p>\n\n<pre><code>&lt;% @locations.each do |loc| %&gt;\n\n&lt;% end %&gt;\n\n&lt;div id=\"map_canvas\"&gt;Random&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13193640,"title":"Rails undefined method for ActiveRecord::Relation error calculating cart items","body":"<p>I'm trying to calculate a total price for all the items contained within a cart. However I'm getting a <code>undefined method total_cart_price for ActiveRecord::Relation:xxx</code></p>\n\n<p><strong>Shop Cart Model (shop_cart.rb)</strong></p>\n\n<pre><code>has_many :shop_cart_items, :dependent =&gt; :destroy\n\n\n  def total_cart_price\n    shop_cart_items.to_a.sum { |item| item.total_price }\n  end\n</code></pre>\n\n<p><strong>Shop Cart Item Model (shop_cart_item.rb)</strong></p>\n\n<pre><code>attr_accessible :quantity, :shop_cart_id, :shop_product_id\n\n  belongs_to :shop_product\n  belongs_to :shop_cart\n\n\n  def total_price\n    shop_product.sell * quantity\n  end\n</code></pre>\n\n<p><strong>Basket View (shop/basket.html.erb)</strong></p>\n\n<pre><code>&lt;tbody&gt;\n    &lt;% @cart_items.each do |item| %&gt;\n        &lt;tr&gt;\n        &lt;td&gt;&lt;%= item.shop_product.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= number_to_currency(item.shop_product.sell) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= number_to_currency(item.total_price) %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;% end %&gt;\n    &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;Subtotal:&lt;/td&gt;\n    &lt;td&gt;&lt;%= number_to_currency(@cart_items.total_cart_price) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>The total price, for a single item, works fine; the error is trying to calculate a sum of all the items.</p>\n\n<p>I do not have a shop_cart controller or views as I am calling the methods from a shop#basket view - not sure if this is what is causing the problem?</p>\n\n<p>Any help much appreciated.</p>\n"},{"tags":["ruby-on-rails","redmine","redmine-plugins"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12474851,"title":"Setting Configuration in init.rb","body":"<p>I am working in rails 2. I am developing a plugin of redmine. I want to do this in init.rb file of plugin. which i am doing in development.rb of redmine. </p>\n\n<pre><code>config.to_prepare do\n  load 'user_patch.rb'\nend\n</code></pre>\n\n<p>How can i do this in plugin init.rb?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13193586,"title":"Ruby: how to get parent method that redefined in children class","body":"<p>How can i get Base's \"hello\" method from Up class in code below?</p>\n\n<pre><code>class Base\n  def hello\n    p 'hello from Base'\n  end\nend\n\nclass Up &lt; Base\n  def hello_orig\n    # how to call hello from Base class?\n  end\n\n  def hello\n    p 'hello from Up'\n  end\nend\n\nu = Up.new\nu.hello_orig # should return 'hello from Base' \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13192265,"title":"Refactoring a switched block statement for group_by in Ruby on Rails","body":"<p>How can I rewrite this code so it's completely dynamic, and I don't have to use the <code>case</code> clause to manually list all possible values of <code>@group</code>?</p>\n\n<pre><code># Grouping\n@group = params[:group] if !params[:group].blank?\ncase @group\n  when 'category_id'\n    @ideas_grouped = @ideas.group_by { |i| i.category_id }\n  when 'status_id'\n    @ideas_grouped = @ideas.group_by { |i| i.status_id }\n  when 'personal_bias'\n    @ideas_grouped = @ideas.group_by { |i| i.personal_bias }\n  when 'business_value'\n    @ideas_grouped = @ideas.group_by { |i| i.business_value }\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":29,"score":-2,"question_id":13193657,"title":"Rails - how to build PC configurator? Is there any appropriate gem?","body":"<p>My client require to his e-commerce PC configurator. In the database are stored CPUs, RAM memories, HDDs etc.</p>\n\n<p>How can I implement PC configurator according to data which are stored in the database?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","seo","blogs","tumblr"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13193593,"title":"tumblr on a rails subdirectory on heroku","body":"<p>If I use tumblr's subdomain feature with rack reverse proxy middle ware will I get the seo benefits of having a blog at site.com/blog over blog.site.com?</p>\n\n<p>Are these articles the right guide for this?</p>\n\n<p><a href=\"http://www.tumblr.com/docs/en/custom_domains\" rel=\"nofollow\">http://www.tumblr.com/docs/en/custom_domains</a></p>\n\n<p><a href=\"http://bindle.me/blog/index.php/304/rack-middleware-for-seo-fun-and-profit\" rel=\"nofollow\">http://bindle.me/blog/index.php/304/rack-middleware-for-seo-fun-and-profit</a></p>\n\n<hr>\n\n<p>Also this site will be hosted at heroku using zerigo for dns is that where I would point the cname to blog.site.com from?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","callback","rails-engines"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13193314,"title":"The customized callbacks in Rails Engine can't be triggered","body":"<p>I meet a problem after I moved some of my code into rails engine. Before, the model file order.rb and some customized callback files were put in the main app folder, like:</p>\n\n<pre><code>MyProject\n|- app\n    |- models\n    |    |- order.rb\n    |\n    |- callbacks\n         |- order_callback.rb\n</code></pre>\n\n<p>And the file contents are: </p>\n\n<pre><code># order.rb\nclass Order &lt; ActiveRecord::Base\n  include OrderCallback\nend\n\n# order_callback.rb\nmodule OrderCallback\n  extend ActiveSupport::Concern\n\n  included do\n    p '-------------- included ----------------'\n    before_create :set_default_values\n  end\n\n  def set_default_values\n    p '------------- set default values ------------'\n  end\nend\n</code></pre>\n\n<p>And I add the app/callbacks dir into the autoload_paths, everything worked fine, the two traces are both printed.</p>\n\n<p>The problem happened after I moved these code into a rails engine. I added the app/callbacks to the engine config.autoload_paths, and can see the first trace which means the callback module is included, but I can't get the second trace when I create an order.</p>\n\n<p>I tried to move the callback to be an observer, it works fine. But I don't want it to be an observer for some reason.</p>\n\n<p>Anyone knows the reason? Thanks! </p>\n"},{"tags":["ruby-on-rails","heroku","exception-notification"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13180998,"title":"Mailers sends empty content","body":"<p>Using Rails 3.1.1 and Heroku + exception_notification gem 3.0.0</p>\n\n<p>Starting yesterday I started receiving my notification_notifier emails with an empty content. The subject and all is just as it used to be but the \"message has no content\". It usually consists of log data, which page the error occurred on etc.</p>\n\n<p>I am not sure what I could have done. I could have upgraded the gem recently but I am not sure, and I am not sure which version to downgrade to in that case.</p>\n\n<p>UPDATE: It turned out that ALL emails sent from the app are delivered without content (\"tell a friend\", \"feedback to webmaster\" etc) and not only exception_notification. So this is NOT an exception_notification error.</p>\n\n<p>Has anyone else seen this? Do you know what I could have done wrong? How can I trouble shoot this?</p>\n"},{"tags":["ruby-on-rails","image","image-conversion"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":11402360,"title":"Convert Canvas to PNG on Rails, server side","body":"<p>I know there are ways to convert a canvas to a PNG image on (some) browser clients into a encoded Base64 string, but I'm searching for a way that is a) server side and b) doesn't use image magic.</p>\n\n<p>If there isn't a direct conversion library somewhere, is there some sort of \"standard\" for ruby / rails image creation and manipulation?  I found Cairo, but I'm confused on what exactly this gets me.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":208,"score":1,"question_id":11570924,"title":"Ruby on Rails: How to override the 'show' route of a resource?","body":"<p>Currently I have a route that looks like this:</p>\n\n<pre><code>resources :posts\n</code></pre>\n\n<p>I want to override the 'show' action so that I can display a url like this:</p>\n\n<pre><code>posts/:id/:slug\n</code></pre>\n\n<p>I am currently able to do this by adding a custom <code>match</code> route:</p>\n\n<pre><code>resources :posts\nmatch 'posts/:id/:slug' =&gt; 'posts#show'\n</code></pre>\n\n<p>However, when I use the <code>link_to</code> helper, it does not use my custom show route.</p>\n\n<pre><code>&lt;%= link_to 'show', post %&gt;  # renders /posts/123\n</code></pre>\n\n<p>How can I define my show route so that I can still use the <code>link_to</code> helper?</p>\n\n<p><strong>Update:</strong> As you can read in the following answers, you can override the route to the 'show' action, but it's probably more work than it's worth. It's easier to just create a custom route:</p>\n\n<pre><code># config/routes.rb\nmatch 'posts/:id/:slug' =&gt; 'posts#show', as: 'post_seo'\n\n# app/views/posts/index.html.erb\n&lt;%= link_to post.title, post_seo_path(post.id, post.slug) %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","postgresql","heroku","amazon-ec2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13160005,"title":"Connection to postgresql on EC2 from heroku","body":"<p>I have problems connecting to an external Postgresql database on EC2 from my heroku app. The problem seams to be with the permission on EC2.</p>\n\n<p>I have done the following:\n- added 098166147350/default for my security group on port 5432 (my postgresql port)\n- connect to the site using the \"Public DNS\"-address (ec2-x-x-x-x.compute-1.amazonaws.com). </p>\n\n<p>The database I try to connect to is in the EU and not US-East region as the heroku app, don't know if this makes any difference?</p>\n\n<p>Anyway if I add 0.0.0.0/0 to 5432 it does work, so I guess it got to have to be the security settings.</p>\n\n<p>Anyone have any idea what the problem could be?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13191779,"title":"Theme support with assets pipeline","body":"<p>I have following project structure:</p>\n\n<pre><code>/app\n/config\n/db\n...\n/themes\n  /default\n    /assets\n      /images\n      /stylesheets\n      /...\n    /views\n      /...\n  /theme1\n   /assets\n     /...\n   /views\n     /...\n</code></pre>\n\n<p>'default' theme should be used by default :). 'theme1' - should override any, eg logo.png or view (application.erb).</p>\n\n<p>It should work in this way: try to get asset from 'theme1' if absent - use from 'default'.</p>\n\n<p>Pretty simple with views:</p>\n\n<pre><code>self.prepend_view_path ::ActionView::FileSystemResolver.new(theme_view_path_for(name))\nself.prepend_view_path ::ActionView::FileSystemResolver.new(default_theme_path)\n</code></pre>\n\n<p>But i cant resolve it with assets.</p>\n\n<pre><code>config.assets.paths &lt;&lt; \"#{Rails.root}/themes/default/assets/stylesheets\"\nconfig.assets.paths &lt;&lt; \"#{Rails.root}/themes/default/assets/images\"\nconfig.assets.paths &lt;&lt; \"#{Rails.root}/themes/default/assets/javascript\"\n</code></pre>\n\n<p>This adds assets as usual, eg asset can be accessed with url 'assets/logo.png', but i need prefixed one - \"assets/theme1/logo.png\".\nAlso if 'theme1' doesnt override logo.png by \"assets/theme1/logo.png\" url should 'default' theme logo returned. (Similar to above with views).</p>\n\n<p>I have tried themes_for_rails - but it doesnt fit, because they override whole assets structure (own controller for serving, etc).</p>\n\n<p>Also, it would be great to have ability to hook into assets resolve,\nwhen accessing logo1.png, it should be possible to serve it with my controller and return it from database, for example.</p>\n\n<p>Thanks for any advice, i'll share with results when finish.</p>\n\n<p>Kirill Salykin</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13157135,"title":"Check whether javascript and cookies are enabled in ruby on rails?","body":"<p>I want to check whether javascript and cookies are enabled or not on page load in Ruby on Rails. So if anyone tries to open it, website should display a message that he cannot proceed further.</p>\n"},{"tags":["ruby-on-rails","slim"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13143002,"title":"form_for method using slim","body":"<p>I have looked at the documentation of slim, and I still can't figure out how to do this in slim:</p>\n\n<pre><code>&lt;%= form_for([@post, @post.comments.build]) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :commenter %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :commenter %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :body %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :body %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I try to translate the first line like this</p>\n\n<pre><code>= form_for([@post, @post.reviews.build]) do |f|\n</code></pre>\n\n<p>But I am getting a syntax error.</p>\n"},{"tags":["ruby-on-rails","performance","data-structures","volatile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12403706,"title":"Rails: A Volatile Data Structure To Store Temporary Data","body":"<p>I'm programming the backend of a mobile application and I've come across this problem, wondering whether I can use a rails tool or should I implement a new technology to my current system.</p>\n\n<p>We have our user that is able to make a request, demanding to chat anyone who is around. However our system (the backend) has to collect this data and choose one of users who agree to chat randomly. But for that I want to keep all the ones that agree to chat in a list and pick one element randomly. But I would like to implement this in a volatile way so that when someone random selected all the other candidates will be gone.</p>\n\n<p>Of course, those candidates could be easily stored in a table and later on could be deleted but I believe that there is a structure that I can use on demand and dump whenever I want. So what kind of data structure I should use to provide this efficiency?</p>\n"},{"tags":["ruby-on-rails","internationalization","yaml","yml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13178268,"title":"Translation in .yml with optional parameter","body":"<p>I want to make a translation <code>my_translation</code> with an optional parameter. For example:</p>\n\n<pre><code>&gt; I18n.t('my_translation')\n=&gt; \"This is my translation\"\n&gt; I18n.t('my_translation', parameter: 1)\n=&gt; \"This is my translation with an optional parameter which value is 1\"\n</code></pre>\n\n<p>Is this possible?</p>\n"},{"tags":["ruby-on-rails","ruby","internationalization","gem","translation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13162265,"title":"Rails-i18n would'nt load translations","body":"<p>I've added the gem \"rails-i18n\" but when I try to get the transaltion of \"date.order\". All fails, but when I write the translation in my own file app, it works ?</p>\n\n<p><strong>Update 10/31/2012</strong>\nMy gem file is :</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'rails', '3.2.8'\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\ngem 'jquery-rails'\ngem \"mysql2\", \"&gt;= 0.3.11\"\ngem \"haml\", \"&gt;= 3.1.7\"\ngem \"haml-rails\", \"&gt;= 0.3.5\", :group =&gt; :development\ngem \"hpricot\", \"&gt;= 0.8.6\", :group =&gt; :development\ngem \"ruby_parser\", \"&gt;= 2.3.1\", :group =&gt; :development\ngem \"rspec-rails\", \"&gt;= 2.11.4\", :group =&gt; [:development, :test]\ngem \"capybara\", \"&gt;= 1.1.2\", :group =&gt; :test\ngem \"email_spec\", \"&gt;= 1.2.1\", :group =&gt; :test\ngem \"factory_girl_rails\", \"&gt;= 4.1.0\", :group =&gt; [:development, :test]\ngem \"bootstrap-sass\", \"&gt;= 2.1.0.1\"\ngem \"devise\", \"&gt;= 2.1.2\"\ngem \"cancan\", \"&gt;= 1.6.8\"\ngem \"rolify\", \"&gt;= 3.2.0\"\ngem \"simple_form\", \"&gt;= 2.0.4\"\ngem \"quiet_assets\", \"&gt;= 1.0.1\", :group =&gt; :development\ngem \"therubyracer\", \"&gt;= 0.10.2\", :group =&gt; :assets, :platform =&gt; :ruby\ngem 'i18n'\ngem 'rails-i18n'\n</code></pre>\n\n<p>And my error is in a view : <a href=\"https://gist.github.com/3990266\" rel=\"nofollow\">https://gist.github.com/3990266</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","nested-resources","nested-routes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13191798,"title":"Nested resource and restricting the Routes Created :only and :except","body":"<p>Good day all,</p>\n\n<p>Can someone kindly assist me with nested resources and its best practice.</p>\n\n<p>I would like to restrict my <code>:events</code> route to only <code>:show</code> and <code>:index</code>, is this the correct way of doing it?</p>\n\n<pre><code>resources :events do\n    resources :registrations, :except =&gt; [:index]\nend\n\nresources :events, :only =&gt; [:index, :show]\n</code></pre>\n\n<p>Is this the best way or the way more Rubyist would handle such thing? I've added two lines of <code>resources :events</code> or is there a way to combine it all in 1 block?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","rspec","guard","gemfile"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13183661,"title":"Allowing either growl or terminal notifier for guard","body":"<p>Ok currently I can get either the <a href=\"https://rubygems.org/gems/growl\" rel=\"nofollow\">Growl</a> or <a href=\"https://github.com/Springest/terminal-notifier-guard\" rel=\"nofollow\">Terminal Notifier</a> to work with Guard. Whichever one I place in my <code>Gemfile</code> and run <code>bundle</code> with then works.</p>\n\n<p>I need to have some place other than the <code>Gemfile</code> to choose which one to use. I'm working on a project with multiple developers, and most use Growl. I prefer Terminal Notifier.</p>\n\n<p>I don't want to make the changes in the <code>Gemfile</code> because that's in version control.</p>\n\n<p>I can't figure out a way to move this into the <code>Guardfile</code>. Is the next best thing to just do a straight include in the Gemfile and have that be separated out where each developer can edit their <code>.extra-gems</code> file or something? That seems messy.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13191576,"title":"How to validate presence of one field in another model from one model","body":"<p>I have one model PunchingRequest and one model PunchingInformation, In PunchingInformation i have two fields, punch_in_time and punch_out_time. I want to insert record in punching requests table if and only if atleast one out of punch_in_time or punch_out_time contains a value. I have a form containing fields related to both PunchingRequest and PunchingInformation. How can I impose this validation?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hmvc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":13066048,"title":"Dissecting ruby on rails model, view, controllers and routes for a large project","body":"<p>I want to  separate model view controllers in HMVC form including routes.After reading i found that ruby on rails  does not support HMVC structure.Is there any alternative of doing it?. I also want to separate routes module wise.\nPlease suggest some best ways of doing it as keeping everything in one place is hard to manage.Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby","rmagick"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2700,"score":1,"question_id":5415243,"title":"Why am I having a problem installing rmagick","body":"<p>On Ruby 1.8.7 and rails 2.3.5 I get:</p>\n\n<pre><code>gem install rmagick\n\nERROR:  Error installing rmagick:\n\nERROR: Failed to build gem native extension.\n\n\n    /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\n    mkmf.rb can't find header files for ruby at       \n    /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n\n\nGem files will remain installed in /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1 for inspection.\n\nResults logged to /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\n\nBuilding native extensions.  This could take a while...\n\nCynicalgrinch:levelous pawel$ gem install rmagick\n\nBuilding native extensions.  This could take a while...\n\nERROR:  Error installing rmagick:\n\n    ERROR: Failed to build gem native extension.\n\n\n        /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\n\nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n\n\nGem files will remain installed in /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1 for inspection.\n\nResults logged to /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\n\n\nGem_make.out says this:\n\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","webserver","hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13190529,"title":"How do you know which domain owns the hosting?","body":"<p>For example if I have 1) host adress 2) login 3) password, I am entering by SSH on ruby on rails hosting, then how can i be sured that this hosting belongs to a specific domain? for example how  can I know if www.site.com - belongs to some specific hosting to which I have access.</p>\n\n<p>I am asking this because I have access to hosting of ruby on rails, and when i modify files, there is no changes, i've tried to use the files \"script\", \"serv\", \"restart.txt\" - by ssh:</p>\n\n<ol>\n<li><p><code>touch tmp/restart.txt</code></p></li>\n<li><p><code>./serv restart</code></p></li>\n<li><p><code>script restart</code></p></li>\n</ol>\n\n<p>nothing of the above helped...and I don't know what to do, any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13184770,"title":"Nested Model Form. Belongs_to class not displaying","body":"<p>I have a Subject Model and a Lesson Model.\nI implemented a nested model form.</p>\n\n<p>After subject creation, I led it to a page where it supposedly shows the lessons associated. However, I fail to see the lessons.</p>\n\n<p>I believe the data for lessons did not get saved properly as \nWhen I did a for example lesson.find_by_subject_id('1'), I get 'nil' in return.</p>\n\n<p>I am trying to figure out how polymorphism works on rails and would appreciate it if someone could either point out where I've gone wrong or give me some guidance on how those to pass the values for belong_to classes to be created.</p>\n\n<p>Subject Model</p>\n\n<pre><code>attr_accessible :subjectCode, :lessons_attributes\nhas_many :lessons, :dependent =&gt; :destroy\naccepts_nested_attributes_for :lessons, :reject_if =&gt; lambda { |a| a[:content].blank? }, :allow_destroy =&gt; true\n</code></pre>\n\n<p>Lesson Model</p>\n\n<pre><code>attr_accessible :lessonName, :subject, :subject_id\nbelongs_to :subject\n</code></pre>\n\n<p>Subject Controller</p>\n\n<pre><code>def new\n3.times {@subject.lessons.build}\nend\n\ndef create\n  @subject = Subject.new(params[:subject])\n  if @subject.save\n    redirect_to @subject, :notice =&gt; \"Successfully created subject.\"\n  else\n    render :action =&gt; 'new'\n  end\nend\n</code></pre>\n\n<p>Form</p>\n\n<pre><code>&lt;%= form_for @subject do |f| %&gt;\n  &lt;%= f.error_messages %&gt;\n  &lt;p&gt;\n    &lt;%= f.label :subjectCode %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :subjectCode %&gt;\n  &lt;/p&gt;\n\n  &lt;%= f.fields_for :lessons do |builder| %&gt;\n    &lt;p&gt;    \n    &lt;%= builder.label :lessonName %&gt; &lt;br/&gt;\n    &lt;%= builder.text_area :lessonName, :rows=&gt;3 %&gt;\n    &lt;/p&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;&lt;%= f.submit \"Submit\" %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Routes\n    resources :subjects do resources :lessons end</p>\n"},{"tags":["ruby-on-rails","ruby","logging","threadpool","backgroundrb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":202,"score":1,"question_id":323463,"title":"backgroundrb thread_pool.defer method logger output goes to where?","body":"<p>It seems like due to the threading issue logger.warn (thats what I tested) doesn't generate any output? my code is similar to this:</p>\n\n<pre><code>def deliver(args)\n  logger.info \"delivery start\"\n  thread_pool.defer(:deliver_deferred, args)\n  logger.info \"delivery end\"\nend\n\ndef deliver_deferred(args)\n  logger.warn \"whatsoever\"\nend\n</code></pre>\n\n<p>Any idea?</p>\n"},{"tags":["javascript","ruby-on-rails","paginate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13190792,"title":"Proper way to paginate large amount of data","body":"<p>I am working on a project in Rails 3 that requires to paginate a very large amount of data. What will be the proper way to paginate large amount of data ( e.g. forum posts ) to maximize performace? Would it be too much workload for the server if I only fetch, lets say, 10 models from a collection and fetch again when going to the next page? Or will it be better just load everything and use javascript to paginate them?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","introspection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13190724,"title":"Rails: list accepted values of \"validates :inclusion\" field","body":"<p>I have a model like this</p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  attr_accessible :kind, :question, :state\n  belongs_to :section\n  validates :question, :kind, :state, :presence =&gt; true\n  validates :question, :uniqueness =&gt; {:scope =&gt; [:section_id]}\n  validates :kind, :inclusion =&gt; {:in =&gt; %w(radio check stars)}\n  validates :state, :inclusion =&gt; {:in =&gt; %w(new active answered canceled)}\nend\n</code></pre>\n\n<p>is it posible to list all accepted values for some field ? For example get the list of %w(radio check stars) from the field \"kind\"</p>\n"},{"tags":["css","ruby-on-rails","ruby","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13189689,"title":"Creating unique id for <fieldset> when using form_for Rails Nested Model Form","body":"<p>I have a nested model form in the style of this Railscast\n<a href=\"http://railscasts.com/episodes/196-nested-model-form-revised?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/196-nested-model-form-revised?view=asciicast</a></p>\n\n<p>I need to give each  tag a unique ID.  Currently, each field generated has a unique ID and name given by a helper method that assigns a unique ID to every association record.  So that is taken cared of.  However, this form has \"fieldset\" tags which isn't assigned an ID.  I need a unique ID for each fieldset for jQuery manipulation purposes.</p>\n\n<p>Specifically, how do I do give each fieldset generated for an \"Activity\" record a unique CSS tag ID?\nPosted below is how my form is created. Thank you</p>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code>&lt;%= form_for(@trip) do |f| %&gt;\n\n&lt;%= f.fields_for :days do |builder| %&gt;\n  &lt;%= render 'day_fields', f: builder %&gt;\n&lt;% end %&gt;\n&lt;%= link_to_add_fields \"Add Day\", f, :days %&gt;\n</code></pre>\n\n<p><strong>_day_fields.html.erb partial</strong></p>\n\n<pre><code>&lt;fieldset&gt;\n  &lt;%= f.label :summary, \"Day Summary\" %&gt;&lt;br /&gt;\n  &lt;%= f.text_area :summary, :rows =&gt; 1 %&gt;&lt;br /&gt;\n    &lt;%= link_to \"remove\", '#', class: \"remove_fields\" %&gt;\n\n  &lt;%= f.fields_for :activities do |builder| %&gt;\n    &lt;%= render 'activity_fields', f: builder %&gt;\n  &lt;% end %&gt;\n  &lt;%= link_to_add_fields \"Add Activity\", f, :activities %&gt;\n&lt;/fieldset&gt;\n</code></pre>\n\n<p><strong>_activity_fields.html.erb</strong></p>\n\n<pre><code>&lt;fieldset&gt;\n  &lt;%= f.label :title, \"Activity\" %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :title, :rows =&gt; 1 %&gt;&lt;br /&gt;\n  &lt;%= f.hidden_field :_destroy %&gt;\n  &lt;%= link_to \"remove\", '#', class: \"remove_fields\" %&gt;\n&lt;/fieldset&gt;\n</code></pre>\n"},{"tags":["javascript","jquery","ruby-on-rails","fade"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13190286,"title":"How i can fade in and fade out words after 5 seconds using jquery","body":"<p>i want to display some words on my webpage after some frequency of time. e.g i have these words.</p>\n\n<pre><code>     marriage,birthday,annual dinner,school\n</code></pre>\n\n<p>And i have this line display at the top of page \"We arrange these type of events like 'marriage' \"</p>\n\n<p>after some seconds next word birthday will replace marriage and then next on and this scanario continues.</p>\n\n<p>I didn't find any best jquery plugin.</p>\n\n<p>If anyone knows please help.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","csv"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13188832,"title":"Changing Date Format on Rails CSV Import to MYSQL","body":"<p>Not sure how to change a date in my csv file when importing into MySQL that is in <strong>12/1/2011</strong>(mm/dd/yyyy) format. MySQL is in yyyy/mm/dd. </p>\n\n<p>How can I do this?</p>\n\n<p>My rake file</p>\n\n<pre><code>require 'csv'\nrequire 'date'\n\ndesc \"Import gac from csv file\"\ntask :import =&gt; [:environment] do\n  Dir.chdir(\"#{Rails.root}/lib/assets\")\n  csv_file = \"file.csv\" \n  CSV.foreach(csv_file, :headers =&gt; true) do |row|\n    Institution.create({\n      :company =&gt; row[0],\n      :solveid =&gt; row[2],\n      :phone =&gt; row[5],\n      :other =&gt; row[6],\n      :clientdate =&gt; (DateTime.strptime row[7], \"%m/%d/%Y\").strftime \"%Y/%m/%d\", \n      :cunumber =&gt; row[1],\n      :street =&gt; row[8], \n      :city =&gt; row[9], \n      :state_id =&gt; row[4], \n      :zip =&gt; row[10],\n      :source =&gt; row[11], \n      :source2 =&gt; row[12],\n      :demodate1 =&gt; (DateTime.strptime row[13], \"%m/%d/%Y\").strftime \"%Y/%m/%d\",\n      :demodate2 =&gt; (DateTime.strptime row[14], \"%m/%d/%Y\").strftime \"%Y/%m/%d\",\n      :demodate3 =&gt; (DateTime.strptime row[15], \"%m/%d/%Y\").strftime \"%Y/%m/%d\",\n      :client =&gt; row[17],\n      :prospect =&gt; row[19], \n      :alliedlead =&gt; row[16], \n      :notcontacted =&gt; row[18]\n    })\n  end\nend\n</code></pre>\n\n<p><em>This is giving me an error.</em></p>\n\n<pre><code>rake import\nrake aborted!\n/Users/dave/rails_projects/allied_contest/lib/tasks/intitutions.rake:14: syntax error, unexpected tSTRING_BEG, expecting '}'\n... row[7], \"%m/%d/%Y\").strftime \"%Y/%m/%d\", \n...                               ^\n/Users/dave/rails_projects/allied_contest/lib/tasks/intitutions.rake:14: syntax error, unexpected ',', expecting keyword_end\n...%m/%d/%Y\").strftime \"%Y/%m/%d\", \n...                               ^\n</code></pre>\n"},{"tags":["ruby-on-rails","jquery-mobile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13168581,"title":"implement mobile views for a rails app","body":"<p>I want to set it up in a way that when a mobile phone uses my website, it will be redirected to a url with 'm' subdomain, but i will be using the same controllers, but just different views. I just need a general road map of how to implement something like that.</p>\n"},{"tags":["ruby-on-rails","rubygems","rhomobile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13190188,"title":"How should I generate a Rhodes extension from a Ruby gem?","body":"<p>I know there is no direct support for Ruby gems in the Rhomobile framework. I have read their (sparse!) documentation to migrate in gem support through <a href=\"http://docs.rhomobile.com/rhodes/extensions\" rel=\"nofollow\">extensions</a>, but I cannot for the life of me figure out how exactly this should be implemented.</p>\n\n<p>Besides the document linked above being very disjointed, what I can find can't be easily translated to what I need. I am trying to bring <a href=\"https://rubygems.org/gems/devise\" rel=\"nofollow\">devise</a> into my app, but the gem structure is very hierarchical and the example given in the Rhomobile documentation suggests that a given library should be a singular <code>.rb</code> file.</p>\n\n<p>The exact example given is as follows:</p>\n\n<pre><code>Assuming your application is called “mynewapp”, create a directory \nunder app called lib (or whatever you wish to call it):\n\n$ cd mynewapp\n$ mkdir app/lib\n\n$ cp /path/to/my_lib.rb app/lib/my_lib.rb\n</code></pre>\n\n<p>Then just require <code>lib/my_lib</code> in a given file within my app. Eg:</p>\n\n<pre><code>require 'lib/my_lib'\n</code></pre>\n\n<p>To translate to the devise gem, my assumption is that I couldn't do something similar, but would instead have to flatten the directory structure out in some way before I could use it. Is that the case or am I missing something? That's <strong>a lot</strong> of re-writing code...</p>\n\n<p>Also, if anyone knows of any kind of guide to adding gems to the Rhodes framework, I would love to see it! I've looked through most of the official documentation and some non-official and nothing seems to address this at all.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13189968,"title":"Display no of listings on a page in Ruby on Rails","body":"<p>I'm working with an RoR project where I've implemented a search page which is working fine, what I'm looking to achieve is <a href=\"http://screencast.com/t/Rp7Ytncbut\" rel=\"nofollow\">the number of listings</a>.</p>\n\n<p>Actually, what I've used here is hardcoded HTML since I don't know what code or gem to use. Any suggestions how I can achieve this?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3.2","hide","show-hide"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":67,"score":-1,"question_id":13118983,"title":"jQuery hide() function not working on change event in ruby on rails","body":"<p>I am working on a complex jquery code and my hide/show function is not working.</p>\n\n<p><strong>scenario:</strong>\nWhen user selects a customer, his bills should appear and when user selects supplier , appropriate bills should appear.</p>\n\n<p>The following is the <strong>view</strong></p>\n\n<pre><code>&lt;%= simple_nested_form_for @money_receipt do |f| %&gt;\n\n&lt;div class=\"customers\"&gt;&lt;%= f.collection_select :customer_id, Customer.all, :id, :name, options ={:prompt =&gt; \"-Select a Customer\"}, :style=&gt;'width:210px;'%&gt;&lt;/div&gt;&lt;br /&gt;\n\n&lt;div class = \"suppliers\"&gt;&lt;%= f.collection_select :supplier_id, Supplier.all, :id, :name, options ={:prompt =&gt; \"-Select a Supplier\"}, :style=&gt;'width:210px;'%&gt;&lt;/div&gt;&lt;br /&gt;\n\n&lt;p&gt;&lt;%= f.link_to_add \"Add line items\", :money_receipt_line_items %&gt; &lt;/p&gt; \n</code></pre>\n\n<p><strong>Line items Partial</strong></p>\n\n<pre class=\"lang-html prettyprint-override\"><code>Customer Bill&lt;div class=\"bill\"&gt;\n&lt;%= f.collection_select :customer_bill_id, CustomerBill.all,:id,:id, {:prompt =&gt; \"Select Customer bill\"}, :style =&gt; 'width:202px;' %&gt;&lt;/div&gt;&lt;br /&gt;\n\nSupplier Bill&lt;div class=\"supplierbill\"&gt; \n&lt;%= f.collection_select :supplier_bill_id, SupplierBill.all,:id,:id, {:prompt =&gt; \"Select Supplier bill\"}, :style =&gt; 'width:202px;' %&gt;&lt;/div&gt;&lt;br /&gt;\n</code></pre>\n\n<p><strong>The jquery code.</strong></p>\n\n<pre><code>    jQuery(document).ready(function() {\n        jQuery(\".customers select\").bind(\"change\", function() {\n\n/*code*/\n                    jQuery(\".bill\").show();\n                    jQuery(\".supplierbill\").hide();\n                }\n            );\n        });\n\n        jQuery(\".suppliers select\").bind(\"change\", function() {\n/*code*/      \n              jQuery(\".supplierbill\").show();\n                    jQuery(\".bill\").hide(\"fast\");\n                }\n            );\n        });\n</code></pre>\n\n<p>Here when I select a customer, the supplier bill should be hidden but it's still being shown and it's the same case when I select a supplier, Customer is not been hidden. I need guidance with the problem.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13188895,"title":"error You need to supply at least one validation","body":"<p>my environment is ruby1.9.3+rails3.2.8+passenger.</p>\n\n<p>error: You need to supply at least one validation</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  attr_accessible :content, :title, :url, :tags_attributes, :published, :category_id\n\n  has_many :comments, :dependent =&gt; :destroy\n  has_many :tags, :dependent =&gt; :destroy\n\n  belongs_to :category\n\n  validates :content, :presence =&gt; true\n  validates :title, :presence =&gt; true\n  validates :url,   :presence =&gt; true\n  validates :tags_attributes, :presence =&gt; true\n  validates :published, :presence =&gt; true\n  validates :category_id, :presence =&gt; true\n\n  accepts_nested_attributes_for :tags, :allow_destroy =&gt; true,\n         :reject_if =&gt; proc { |attrs| attrs.all? { |k,v| v.blank? } }\n\n\n  scope :published, where(:published =&gt; true)\nend   \n</code></pre>\n\n<p>my controller is </p>\n\n<pre><code>class Admin::PostsController &lt; Admin::ApplicationController\n\n  uses_tiny_mce(:options =&gt; AppConfig.default_mce_options, :only =&gt; [:new, :edit])\n\n  def index\n    page = params[:page]\n    if page == nil\n      page = 1\n    end\nend\n</code></pre>\n\n<p>index.html.erb</p>\n\n<pre><code>&lt;h2&gt;Post list&lt;/h2&gt;\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Title&lt;/th&gt;\n    &lt;th&gt;Category&lt;/th&gt;\n    &lt;th&gt;Created&lt;/th&gt;\n    &lt;th&gt;Updated&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;% @posts.each do |post| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= post.title %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= post.category.title %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= post.created_at.localtime.to_s(:db) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= post.updated_at.localtime.to_s(:db) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Edit', edit_admin_post_path(post) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Delete',[:admin, post], :method =&gt; :delete, :confirm =&gt; 'are you sure?' %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n\n&lt;br/&gt;\n&lt;%= will_paginate @posts %&gt;\n&lt;br/&gt;\n&lt;%= link_to 'New Post', new_admin_post_path %&gt;\n</code></pre>\n\n<p>i think it has matter with rails_tiny_mce.\nbefore i rails plugin install it, validates is ok under my write.\nbut after i install rails_tiny_mce, the error is display.</p>\n\n<p>my site is <code>http://42.121.5.68/admin/posts.</code></p>\n\n<p>when i update model to </p>\n\n<pre><code>validates [:content, :title], :on =&gt; :save, :allow_blank =&gt; false,\n            :presence =&gt; true, :length =&gt; { :in =&gt; 10..200 }\n</code></pre>\n\n<p>error is Unknown validator: 'OnValidator'</p>\n"},{"tags":["ruby-on-rails","model","guid","uuid","spine.js"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":815,"score":4,"question_id":6881405,"title":"Should I use UUIDs as primary keys for Rails?","body":"<p>I want to use the <a href=\"http://maccman.github.com/spine/\" rel=\"nofollow\">Spine.js</a> client-side framework, and it generates UUIDs as IDs for models, which can then be persisted to the server. It would be easiest if I just used the client-generated UUIDs for the models, and saved them on the server.</p>\n\n<p><b>What are the drawbacks of using client-generated UUIDs as primary keys in Rails?</b></p>\n"},{"tags":["ruby-on-rails","passwords","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13188576,"title":"How to bypass password validation in the following OmniAuth login method?","body":"<p>I have some password validation for my <code>User</code> model, and a <code>create_with_omniauth</code> method to get the information from the user's Facebook account:</p>\n\n<p><strong>user.rb:</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :name, :email, :password, :password_confirmation\n\n  has_secure_password\n\n  validates :name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence:   true,\n                    format:     { with: VALID_EMAIL_REGEX },\n                    uniqueness: { case_sensitive: false }\n  validates :password, presence: true, length: { minimum: 6 }\n  validates :password_confirmation, presence: true\n\n  def self.create_with_omniauth(auth)\n    create! do |user|\n      user.provider = auth[\"provider\"]\n      user.uid = auth[\"uid\"]\n      user.name = auth[\"info\"][\"name\"]\n      user.email = auth[\"info\"][\"email\"]\n    end\n  end\nend\n</code></pre>\n\n<p>Now when I click <code>link_to \"Sign in with Facebook, \"auth/facebook\"</code> I get this error:</p>\n\n<blockquote>\n  <p>Validation failed: Password can't be blank, Password can't be blank,\n  Password is too short (minimum is 6 characters), Password confirmation\n  can't be blank</p>\n</blockquote>\n\n<p>Because of this two lines in the <code>User</code> model:</p>\n\n<pre><code> validates :password, presence: true, length: { minimum: 6 }\n validates :password_confirmation, presence: true\n</code></pre>\n\n<p>How to bypass that validation when the user is trying to log in with the OmniAuth login method?</p>\n"},{"tags":["ruby-on-rails","ruby","sqlite","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":381,"score":1,"question_id":5983699,"title":"ActiveRecord, Sqlite3, and BusyException","body":"<p>I have a rails app configured with mixed mysql and sqlite3 db connections, and to associate specific models with sqlite3, i add an \"establish_connection 'sqlite_db_config_name'\" line to each class definition. </p>\n\n<p>When I try to save any sqlite3-connected model object individually, the save is successful, but when I try to save an object that is composed of other objects (via has_many), I get a BusyException. I have a feeling it's because each object has its own connection to the db and the top-level object locks the database then calls the member objects' save methods and they can't acquire the lock. </p>\n\n<p>I'm assuming there's a way to make this work and I'm using establish_connection improperly. </p>\n\n<p>Anyone else encounter this? </p>\n\n<p>database.yml config:</p>\n\n<p>dev:</p>\n\n<pre><code>development:\n  adapter: mysql\n  database: maindb\n  username: root\n  password:\n  host: localhost\n\nsqlite:\n  adapter: sqlite3\n  database: db/db.sqlite3\n  timeout: 15000\n</code></pre>\n\n<p>model definitions:</p>\n\n<pre><code>class Foo &lt; ActiveRecord::Base\n  establish_connection 'sqlite'\n  belongs_to :bar\nend\n\nclass Bar &lt; ActiveRecord::Base\n  establish_connection 'sqlite'\n  has_many :foo  \n  def addFoo(item)\n    self.foos &lt;&lt; item\n  end\nend\n\nclass MysqlModel &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>Other:</p>\n\n<p>Ruby 1.8.7<br>\nRails 2.3.4<br>\nUbuntu 10.04</p>\n\n<h2>Update:</h2>\n\n<p>I tried using inheritance to isolate the establish_connection statement in a single class, based on the rails doc's explanation that \"This feature is implemented by keeping a connection pool in ActiveRecord::Base that is a Hash indexed by the class. If a connection is requested, the retrieve_connection method will go up the class-hierarchy until a connection is found in the connection pool.\". But for some reason rails associated the subclasses of the sqlite-connected class with the default mysql connection. So I've given up on attempting a has_many/belongs_to relationship with sqlite, and de-normalized my models.</p>\n"},{"tags":["ruby-on-rails","ruby","database","sqlite"],"answer_count":10,"favorite_count":9,"up_vote_count":18,"down_vote_count":0,"view_count":8695,"score":18,"question_id":78801,"title":"SQLite3::BusyException","body":"<p>Running a rails site right now using SQLite3.</p>\n\n<p>About once every 500 requests or so, I get a</p>\n\n<p>ActiveRecord::StatementInvalid (SQLite3::BusyException: database is locked:...</p>\n\n<p>What's the way to fix this that would be minimally invasive to my code?</p>\n\n<p>I'm using SQLLite at the moment because you can store the DB in source control which makes backing up natural and you can push changes out very quickly. However, it's obviously not really set up for concurrent access. I'll migrate over to MySQL tomorrow morning.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12507323,"title":"ruby mysql connection error","body":"<p>I am using MySQL and ruby 1.8.6. I want to connect to MySQL so for that I am using active record gem. My code is </p>\n\n<pre><code>def initialize\n\n    @db_adapter  = \"mysql2\"\n    @db_host     = \"localhost\"\n    @db_database = \"database_name\"\n    @db_user     = \"root\"\n    @db_password = \"root123\"\n    con = nil\n\nend\n\ndef database_connection\n           con = ActiveRecord::Base.establish_connection(  \n              :adapter  =&gt; $db_adapter,  \n              :host     =&gt; $db_host,  \n              :database =&gt; $db_database,\n              :user     =&gt; $db_user,\n              :password =&gt; $db_password  \n           )\n\n           return con\nend\n</code></pre>\n\n<p>but when i am tring to connect it's giving me this error</p>\n\n<pre><code>/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:76:in `establish_connection': Please install the  adapter: `gem install activerecord--adapter` (no such file to load -- active_record/connection_adapters/_adapter) (RuntimeError)\n    from /cmf/samnew/build/Controller/databaseConnection.rb:32:in `database_connection'\n    from controller.rb:23\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","ruby","osx","rake"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13025078,"title":"rake db:create giving error","body":"<p>When I run rake db:create I get following error </p>\n\n<pre><code>xyz-MacBook-Pro:ruby_project xyz$ rake db:create\nrake aborted!\ndlopen(/Users/xyz/.rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.2.7/lib/mysql2/mysql2.bundle, 9): Library not loaded: libmysqlclient.18.dylib\nReferenced from: /Users/xyz/.rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.2.7/lib/mysql2/mysql2.bundle\nReason: image not found - /Users/xyz/.rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.2.7/lib/mysql2/mysql2.bundle\n</code></pre>\n\n<p>I have mysql 5.1.66 installed in my system and my database.yml file structure is</p>\n\n<pre><code>adapter: mysql2\nencoding: utf8\nreconnect: false\ndatabase: ruby_test\npool: 5\nusername: root\npassword:\nhost: /tmp/mysql.sock\n</code></pre>\n\n<p>Below are contents of mysql folder in my system</p>\n\n<pre><code>libdbug.a           libmysqlclient_r.a\nlibheap.a           libmysqlclient_r.dylib\nlibmygcc.a          libmysqlclient_r.la\nlibmyisam.a         libmysqld.a\nlibmyisammrg.a          libmystrings.a\nlibmysqlclient.16.dylib libmysys.a\nlibmysqlclient.a        libvio.a\nlibmysqlclient.dylib    libz.a\nlibmysqlclient.la       libz.la\nlibmysqlclient_r.16.dylib   plugin\n</code></pre>\n\n<p>Can someone help me with this issue?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","generate"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":271,"score":1,"question_id":4340682,"title":"How can I generate older rails application when current version is 3.0.3","body":"<p>I have 2 different Rails Rubygems installed on my Linux OS [2.3.8 and 3.0.3] , but the current active Rails version is 3.0.3. So is it possible to generate Rails app using 2.3.8 style generator:<code>rails testapp</code> not new one: <code>rails new testapp</code> ?</p>\n"},{"tags":["ruby-on-rails","postgresql","postgresql-9.1","rails-postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":13189105,"title":"Can't run rake db:migrate a tsvector GIN index for Postgresql in Rails using Railscast sample","body":"<p>I'm following along on Ryan Bates' <a href=\"http://railscasts.com/episodes/343-full-text-search-in-postgresql\" rel=\"nofollow\">excellent tutorial</a> on using the built-in PostgresQL full-text search in Rails. I'm currently using pg_search gem un-indexed no problem but I need to improve the performance. I am using tsvector with \"english\" dictionary specified.</p>\n\n<p>I'm using PostgreSQL version 9.1.4</p>\n\n<p>Per Ryan's instructions, I have run a new migration with this code specifying two new indexes that I would like to create. Here is the schema first:</p>\n\n<pre><code>create_table \"references\", :force =&gt; true do |t|\n t.string   \"title\"\n t.string   \"type\"\n t.datetime \"created_at\",         :null =&gt; false\n t.datetime \"updated_at\",         :null =&gt; false\n t.string   \"public_url\"\n t.string   \"content_type\"\n t.integer  \"file_size\"\n t.text     \"overview\"\n t.text     \"body\"\n t.text     \"full_text\"\n t.integer  \"folder_id\"\nend\n</code></pre>\n\n<p>My migration looks like this:</p>\n\n<pre><code>    def up\n    execute \"create index references_title on references using gin(to_tsvector('english', title))\"\n    execute \"create index references_full_text on references using gin(to_tsvector('english', full_text))\"\nend\n\ndef down\n    execute \"drop index references_title\"\n    execute \"drop index references_full_text\"\nend\n</code></pre>\n\n<p>I have also gone ahead and uncommented the :sql option in application.rb</p>\n\n<pre><code>    config.active_record.schema_format = :sql\n</code></pre>\n\n<p>I continue to get the same rake aborted error:</p>\n\n<pre><code>==  AddSearchIndexesToReferences: migrating ===================================\n-- execute(\"CREATE INDEX references_title on references using gin(to_tsvector('english',    title))\")\nrake aborted!\nAn error has occurred, this and all later migrations canceled:\n\nPG::Error: ERROR:  syntax error at or near \"references\"\nLINE 1: CREATE INDEX references_title on references using gin(to_tsv...\n                                     ^\n: CREATE INDEX references_title on references using gin(to_tsvector('english', title))\n</code></pre>\n"},{"tags":["ruby-on-rails","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13187907,"title":"running cap deploy:cold command gives an error","body":"<p>So i've been trying to deploy my ruby on rails web site with the help of Capistrano and when I run <code>cap deploy:cold</code> this is what I get:</p>\n\n<pre><code>C:\\Sites\\blog&gt;cap deploy:cold\n  * ←[32m2012-11-02 00:47:49 executing `deploy:cold'←[0m\n  * ←[32m2012-11-02 00:47:49 executing `deploy:update'←[0m\n ** transaction: start\n  * ←[32m2012-11-02 00:47:49 executing `deploy:update_code'←[0m\n    ←[33mexecuting locally: \"git ls-remote git@github.com:averageAwesome/blog.gi\nt master\"←[0m\n    ←[2;37mcommand finished in 2686ms←[0m\n  * ←[33mexecuting \"git clone --depth 1 git@github.com:averageAwesome/blog.git /\nvar/chroot/home/content/39/10025539/html/blow4849/blog/releases/20121102004752 &amp;\n&amp; cd /var/chroot/home/content/39/10025539/html/blow4849/blog/releases/2012110200\n4752 &amp;&amp; git checkout -b deploy 700dd36e9e5476880fea92c48bffcfb6ff455fe8 &amp;&amp; git s\nubmodule init &amp;&amp; git submodule sync &amp;&amp; export GIT_RECURSIVE=$([ ! \\\"`git --versi\non`\\\" \\\\&lt; \\\"git version 1.6.5\\\" ] &amp;&amp; echo --recursive) &amp;&amp; git submodule update -\n-init $GIT_RECURSIVE &amp;&amp; rm -Rf  /var/chroot/home/content/39/10025539/html/blow48\n49/blog/releases/20121102004752/.git &amp;&amp; (echo 700dd36e9e5476880fea92c48bffcfb6ff\n455fe8 &gt;  /var/chroot/home/content/39/10025539/html/blow4849/blog/releases/20121\n102004752/REVISION)\"←[0m\n    servers: [\"188.121.54.128\"]\nPassword:\n    [188.121.54.128] executing command\n ** ←[35m[188.121.54.128 :: out] sh: git: command not found←[0m\n    ←[2;37mcommand finished in 164ms←[0m\n*** [←[34mdeploy:update_code←[0m] ←[34mrolling back←[0m\n  * ←[33mexecuting \"rm -rf  /var/chroot/home/content/39/10025539/html/blow4849/b\nlog/releases/20121102004752; true\"←[0m\n    servers: [\"188.121.54.128\"]\n    [188.121.54.128] executing command\n    ←[2;37mcommand finished in 131ms←[0m\nfailed: \"sh -c 'git clone --depth 1 git@github.com:averageAwesome/blog.git /var/\nchroot/home/content/39/10025539/html/blow4849/blog/releases/20121102004752 &amp;&amp; cd\n /var/chroot/home/content/39/10025539/html/blow4849/blog/releases/20121102004752\n &amp;&amp; git checkout -b deploy 700dd36e9e5476880fea92c48bffcfb6ff455fe8 &amp;&amp; git submo\ndule init &amp;&amp; git submodule sync &amp;&amp; export GIT_RECURSIVE=$([ ! \\\"`git --version`\\\n\" \\\\&lt; \\\"git version 1.6.5\\\" ] &amp;&amp; echo --recursive) &amp;&amp; git submodule update --ini\nt $GIT_RECURSIVE &amp;&amp; rm -Rf  /var/chroot/home/content/39/10025539/html/blow4849/b\nlog/releases/20121102004752/.git &amp;&amp; (echo 700dd36e9e5476880fea92c48bffcfb6ff455f\ne8 &gt;  /var/chroot/home/content/39/10025539/html/blow4849/blog/releases/201211020\n04752/REVISION)'\" on 188.121.54.128\n</code></pre>\n\n<p>Any ideas what might be going wrong??</p>\n"},{"tags":["ruby-on-rails","ruby","web"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13188178,"title":"Ruby on rails: variable number of input boxes","body":"<p>I'm working on an application where the user needs to be able to upload multiple files at once in a submission form. Ideally I'd start with, say, three file upload fields with an 'add additional files' button that dynamically adds input fields. I can do the Javascript to handle this of course, but how would I access this \"array\" of files within my controller?</p>\n\n<p>I've looked at a few canned solutions, but they're much more flashy than what I need, and I don't need ajax uploading either - just a regular old submit is fine.</p>\n\n<p>So, to summarize: what's the best way to access zero or many uploaded files in a rails application?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller","refresh"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13188055,"title":"Rails controller method execution","body":"<p>Suppose I have a Rails controller method, which is executed when the user submits a form. Now, the user submits the form, and while the method is running (and hasn't rendered the next page to the user), the user hits \"Refresh\". What is going to happen? Will the method stop running and restart, or will there be another thread to run the method once more?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13188893,"title":"form_for Update Model","body":"<p>I have the following code which I would like to update the particular object in the database. For some reason however this function will not display. Based on the log reports I am getting back nothing is wrong. Information outside of the code block is returned fine.</p>\n\n<pre><code>&lt;% form_for (@person), :url =&gt; {:controller =&gt; \"persons\", :action =&gt; \"update\" } do |f| %&gt;\n        &lt;%= f.label :name, \"Name\" %&gt;&lt;br/&gt;\n        &lt;%= f.text_field :name %&gt;\n        &lt;%= f.label :score, \"Score\" %&gt;\n        &lt;%= f.text_field :score %&gt;\n  &lt;%= f.submit(\"Update\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","heroku","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13187959,"title":"Upload Zip to S3 with Heroku, upzip and allow others access extracted files with unique link","body":"<p>I have an interesting situation where the user would upload a zip file, that file needs to be moved to S3, unzipped and made public to other users through a unique link. </p>\n\n<p>For example:</p>\n\n<p>I upload awesome.zip (lets say it contains its own mini webpage), it gets moved to S3 and unzipped and placed into 123456/. Then if I want to share my mini webpage with someone, they could go to www.mysite.com/{username}/item/123456.</p>\n\n<p>Is this possible? Can anyone give me any guidance on how to go about it? Anything would be greatly appreciated. </p>\n\n<p>Thanks, \nJoe Chin</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13188911,"title":"Occasional 422 error: client not sending session cookie?","body":"<p>A few users are getting a <code>422 ActionController::InvalidAuthenticityToken</code> error when POSTing a form.</p>\n\n<p>It happens to a minority of users some of the time. If they try their request again later, it often works.</p>\n\n<p>The authenticity token is getting sent along in every case. I'm assuming the client isn't sending the session cookie along with the POST (that would explain why the server can't verify the token). Why would this be?</p>\n\n<p>Finally, the form is submitted via javascript (<code>$('#new_user')[0].submit()</code>), would that somehow prevent the session cookie from being sent?</p>\n\n<p>Disabling the <code>verify_authenticity_token</code> before_filter is unfortunately not an option.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13155522,"title":"Error about TypeError (wrong argument type Module (expected Class)): app/controllers/player_profiles_controller.rb:1:in `<top (required)>'","body":"<p>hy guys . . im new at this . . sorry for the word that's not understandable and the easy question . . </p>\n\n<p>i'd like to ask about an error that shown below : <br>\n<b>TypeError (wrong argument type Module (expected Class)):<br>\n  app/controllers/player_profiles_controller.rb:1:in `'</b>\n<br><br></p>\n\n<p>i want to test the result by render json in soapUI.<br>\ndoes anyone know what's the problem so that the error will show up like above ?<br>\n<br>thanks before.<br><br>regards,<br><br><br>edy</p>\n"},{"tags":["ruby-on-rails","nested-forms","has-many","has-many-through","fields-for"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1726,"score":2,"question_id":4663689,"title":"Rails, using has_many through and fields_for","body":"<p>I have a little trouble getting this to work.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :events, :through =&gt; :event_users\n  has_many :event_users\n  accepts_nested_attributes_for :event_users, :allow_destroy =&gt; true, :reject_if =&gt; proc { |obj| obj.blank? }\nend\n\nclass Event &lt; ActiveRecord::Base\n  has_many :event_users\n  has_many :users, :through =&gt; :event_users\n  accepts_nested_attributes_for :users, :reject_if =&gt; lambda { |a| a[:nick].blank? }, :allow_destroy =&gt; true\nend\n\nclass EventUser &lt; ActiveRecord::Base\n  set_table_name :events_users\n  belongs_to :event\n  belongs_to :user\nend\n</code></pre>\n\n<p>Table-layout:</p>\n\n<pre><code>events_users\n  user_id\n  event_id\n  is_participating\n\nevents\n  id\n  name\n\nusers\n  id\n  name\n</code></pre>\n\n<p>This is the code for the form</p>\n\n<pre><code>&lt;%= form_for @event do |f| %&gt;\n  &lt;%= f.fields_for :users, f.object.users do |builder| %&gt;\n    &lt;%= builder.text_field :name, \"Name\" %&gt;\n    &lt;%= f.fields_for :event_users do |builder2| %&gt;\n      &lt;%= builder2.hidden_field :is_participating, :value =&gt; true %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What I'm trying to accomplish is to set the field is_participating in the events_users table, but it doesn't work!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13188573,"title":"Is there a built in way to rename an entire scaffold?","body":"<p>I'm using Rails 3.2, and have started with a scaffolding and built out from it, but have realized I need to rename the entire scaffold (Model, View, Controller, <code>db:migrate</code>, etc). Is there a built in way to do this, or should I just do it manually?</p>\n"},{"tags":["ruby-on-rails","ruby","database","activerecord"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":1038,"score":6,"question_id":3609482,"title":"ActiveRecord talk to two databases?","body":"<p>We've recently revamped a project, and are looking to bring all our old data into the new system.  The problem is that the schema is marginally different, so a straight SQL import isn't possible.  Due to some denormalization and database changes, we'll need to do some massaging of the data before it's ready for import.  I was hoping for something like this:</p>\n\n<pre><code>OldUser.all.each do |ou|\n  NewUser.create({\n    :first_name   =&gt; ou.first_name\n    :last_name    =&gt; ou.last_name\n    :login        =&gt; ou.login\n    :company_name =&gt; ou.company.name\n  })\nend\n</code></pre>\n\n<p>In the example above, OldUser is reading from the old database, and NewUser is working on the new database.  I need both sets of models (new and old) to retain their associations to properly denormalize some of that data.</p>\n\n<p>Is there any project/library that can help me do this?</p>\n"},{"tags":["ruby-on-rails","ruby","unit-testing","inclusion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13181083,"title":"Rails unit testing model validation :inclusion fails","body":"<p>Model order.rb</p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n    attr_accessible :address, :email, :name, :payment_type_id\n    belongs_to :payment_type\n\n    PAYMENT_TYPES = PaymentType.pluck(:id)\n\n    validates :name, :address, :email, :payment_type_id, :presence =&gt; true\n    validates :payment_type_id, :inclusion =&gt; {:in =&gt; PAYMENT_TYPES}\nend\n</code></pre>\n\n<p>Model payment_type.rb</p>\n\n<pre><code>class PaymentType &lt; ActiveRecord::Base\n  attr_accessible :name, :id\n\n  has_many :order\nend\n</code></pre>\n\n<p>From browser, validation works fine, if it is wrong it give an error, else go forward.\nBut problem is when I run <code>rake test:functionals</code> from terminal. Test didn't pass the validation. If I comment this line:</p>\n\n<pre><code>validates :payment_type_id, :inclusion =&gt; {:in =&gt; PAYMENT_TYPES}\n</code></pre>\n\n<p>all is ok. I don't understand why it is working in one plase, but in tests not ? ... </p>\n\n<p>Fixtures are all ok.</p>\n\n<p>Please help.</p>\n"},{"tags":["ruby-on-rails","postgresql","rails-migrations"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13170395,"title":"pg_dump: \"could not connect to server\" in Rails \"schema_format = :sql\" migration","body":"<p>In my rails app (v 3.2.8), so far, I've used migrations without a problem. </p>\n\n<p>I am using PostgreSQL 9.2 as the DB. I tweaked my <code>application.rb</code> to use sql instead of schema dumper (uncommented <code>config.active_record.schema_format = :sql</code>). </p>\n\n<p>After that, I started to get this error on migration:</p>\n\n<pre><code>    $ rake db:migrate\n\n    [ALL MIGRATION STUFF IS PRINTED HERE]\n\n    pg_dump: [archiver (db)] connection to database \"my_dev_db\" failed: could not connect to server: Connection refused\n        Is the server running on host \"localhost\" (::1) and accepting\n        TCP/IP connections on port 5432?\n    could not connect to server: Connection refused\n        Is the server running on host \"localhost\" (127.0.0.1) and accepting\n        TCP/IP connections on port 5432?\n    could not connect to server: Connection refused\n        Is the server running on host \"localhost\" (fe80::1) and accepting\n        TCP/IP connections on port 5432?\n    rake aborted!\n    Error dumping database\n\nI tried manually on the command line(logged in as the same user on my Mac)\n\n&lt;!-- language: lang-sh --&gt;\n\n    $ pg_dump my_dev_db &gt; /tmp/db.sql\n\nNo problems with that...happily dumps into `/tmp/db.sql`\n\nWhy is rails having trouble with `pg_dump`? (I am on Mac OSX Lion)\n\n===========\n\nAdding more diagnosis information\n\n===========\n\n    $tail -10 /usr/local/var/postgres9.2/pg_hba.conf \n\n    local   all             all                                     md5\n    # IPv4 local connections:\n    host    all             all             127.0.0.1/32            md5\n    # IPv6 local connections:\n    host    all             all             ::1/128                 md5\n    # Allow replication connections from localhost, by a user with the\n    # replication privilege.\n    #local   replication     rogert                                trust\n    #host    replication     rogert        127.0.0.1/32            trust\n    #host    replication     rogert        ::1/128                 trust\n\n\n    $ sudo lsof -p 62444 | awk '$5 == \"unix\" &amp;&amp; $NF ~ /\\// { print $NF }'\n    /tmp/.s.PGSQL.5432\n\n    $ ps auxw | grep post\n    postgres        1403   0.0  0.0  2435492    640 s007  S+   21Oct12   0:00.05 bash\n    root            1401   0.0  0.0  2498096    128 s007  S    21Oct12   0:00.02 su postgres\n    rogert  62517   0.0  0.0  2426700    388 s001  R+    9:21PM   0:00.00 grep post\n    rogert  62448   0.0  0.0  2481656    500   ??  Ss    8:46PM   0:00.03 postgres: wal writer process     \n    rogert  62447   0.0  0.0  2481656    752   ??  Ss    8:46PM   0:00.07 postgres: writer process     \n    rogert  62446   0.0  0.0  2481656   1040   ??  Ss    8:46PM   0:00.00 postgres: checkpointer process     \n    rogert  62444   0.0  0.1  2481656   5368 s001  S     8:46PM   0:00.02 /usr/local/Cellar/postgresql/9.2.1/bin/postgres -D /usr/local/var/postgres9.2\n\n\n    $ rake db:migrate --trace\n\n    [ALL MIGRATION STUFF IS PRINTED HERE]\n\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:393:in `block (3 levels) in &lt;top (required)&gt;'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n    /Users/rogert/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:162:in `block (2 levels) in &lt;top (required)&gt;'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n    /Users/rogert/.rvm/gems/ruby-1.9.3-p194@rails_3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n    /Users/rogert/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\n\n$sudo vi /usr/local/var/postgres9.2/postgresql.conf\n\n[search for listen address]\n\n# - Connection Settings -\n\nlisten_addresses = 'localhost'          # what IP address(es) to listen on;\n                                        # comma-separated list of addresses;\n                                        # defaults to 'localhost'; use '*' for all\n                                        # (change requires restart)\nport = 5432                             # (change requires restart)\nmax_connections = 100                   # (change requires restart)\n</code></pre>\n\n<p>Whats weird is that if I totally remove these two lines from my rails app, the migration works. So if its a problem with TCP connections and listenting, how is the migration itself working (but won't as soon as I turn these two back on again)</p>\n\n<ol>\n<li>application.rb - config.active_record.schema_format = :sql</li>\n<li>In one of my migration files - t.hstore :attributes</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","where-clause"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1029,"score":2,"question_id":6260288,"title":"How do you do a Rails 3 select IN using where clauses","body":"<p>I am using Rails 3 and I need to do a select where the primary key of the records is IN a resulting previous select.  You can do this easily using straight SQL using an IN.  Here is the obviously incorrect way I have done what I need.  What's the Rails way to do this well:</p>\n\n<pre><code>@task = Link.find(params[:id])\nclients = Client.where('task_id = ?',@task.id).select('DISTINCT(company_id)')\ncompany_list = []\nclients.each do |client|\n  company_ids &lt;&lt; client.company_id\nend\n@companies = Company.where(:id =&gt; company_ids)\n</code></pre>\n"},{"tags":["ruby-on-rails","haml","sass"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1630,"score":4,"question_id":3028033,"title":"In HAML on Ruby on Rails, how to use the :sass filter?","body":"<p>If using HAML on Ruby on Rails, then</p>\n\n<pre><code>:sass\n  #someDiv\n    border: 3px dashed orange\n</code></pre>\n\n<p>won't have any <code>&lt;style&gt;</code> tag around them.</p>\n\n<p>and then</p>\n\n<pre><code>:css\n  :sass\n    #someDiv\n      border: 3px dashed orange\n</code></pre>\n\n<p>won't kick on the <code>:sass</code> filter, but</p>\n\n<pre><code>:css\n:sass\n  #someDiv\n    border: 3px dashed orange\n</code></pre>\n\n<p>will kick on the <code>:sass</code> filter, but it is outside of the <code>&lt;style&gt;</code> tag.  So how can the <code>:sass</code> filter be used?  We can manually wrap <code>&lt;style&gt;</code> around it, but it is not common use that we want to generate css from sass but not inside <code>&lt;style&gt;</code> tag in an HAML file.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":457,"score":5,"question_id":8514946,"title":"How do I comment out ERB  in Rails?","body":"<p>I understand that commenting in rails is done with '#' but if I try to comment out ERB tags, I always run into problems</p>\n\n<pre><code> &lt;%= link_to \"Make default\", make_default_admin_state_path(state) %&gt;\n</code></pre>\n\n<p>Where would you put the '#' on this code? </p>\n\n<p>I tried to put it outside the &lt;% and it did nothing. when I put it inside, there was an error message</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13187726,"title":"Cancan authorize custom module","body":"<p>I have a custom module in my lib directory that I load in my Application controller. I started using cancan and now I am getting Access Denied error for all the actions in my custom module. I don't want cancan to check authorization on my custom module. One way to get around this is to use <code>except =&gt; [:action_name_in_my_custom_module]</code> but I have lot of actions that I use in my application at many places. I need a better solution. </p>\n"},{"tags":["ruby-on-rails","rubygems","bundler","dependency-management"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13187994,"title":"How can I resolve these Rails gem dependecies after adding rmre 0.0.4?","body":"<p>I made a new rails 3.2.8 app and added:  </p>\n\n<pre><code>gem \"rmre\", \"~&gt; 0.0.4\"\n</code></pre>\n\n<p>to this new gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\ngem 'mysql2'\n\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\n\ngem \"rmre\", \"~&gt; 0.0.4\"\n\n# To use ActiveModel has_secure_password\n# gem 'bcrypt-ruby', '~&gt; 3.0.0'\n\n# To use Jbuilder templates for JSON\n# gem 'jbuilder'\n\n# Use unicorn as the app server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n# gem 'capistrano'\n\n# To use debugger\n# gem 'debugger'\n</code></pre>\n\n<p>Running bundle install yields:</p>\n\n<pre><code>Bundler could not find compatible versions for gem \"erubis\":\n  In Gemfile:\n    rmre (~&gt; 0.0.4) ruby depends on\n      erubis (~&gt; 2.6.6) ruby\n\n    rails (= 3.2.8) ruby depends on\n      erubis (2.7.0)\n</code></pre>\n\n<p>I tried commenting out the version numbers and even removing the gems related to asset management.  Still, I can't seem to arrive at a combination of gem versions that work here.  It's the first time I've run into this sort of situation and I am not sure what else I might do to try out the rmre gem with a version of rails that is at least 3-point-something.</p>\n\n<p>Is there a clever way to search for a workable dependency resolution here?  If there is not a gem version configuration that meets the recommended dependencies, is there a least-bad approach to pursue?</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","resources"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":287,"score":3,"question_id":4439425,"title":"In Ruby on Rails, what does \"resource\" mean?","body":"<p>I see the word <code>resource</code> in many different places like: <strong>Resource Routing</strong>, <strong>Resourceful Controller</strong>, and <strong>resources: photos</strong>.</p>\n\n<p>What does <code>resource</code> actually mean?</p>\n\n<p>One more question: What does <strong>RESTful route</strong> mean?</p>\n"},{"tags":["ruby-on-rails","caching","acts-as-taggable-on"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":572,"score":2,"question_id":3946783,"title":"How to cache tags with acts_as_taggable_on?","body":"<p>I have model with tag context:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  acts_as_taggable_on :categories\nend\n</code></pre>\n\n<p>I'm trying to initialize tags caching:</p>\n\n<pre><code>class AddCachedCategoryListToProducts &lt; ActiveRecord::Migration\n  def self.up\n    add_column :products,  :cached_category_list, :string\n    Product.reset_column_information\n    products = Product.all\n    products.each { |p| p.save_cached_tag_list }\n  end\nend\n</code></pre>\n\n<p>But <code>cached_category_list</code> does not initializing. What I'm doing wrong? Does anybody can use caching with this gem (my version is 2.0.6)?</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","pg"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13186586,"title":"rails pg db migration undefined method `database_authenticatable' for Devise Users","body":"<p><code>undefined method database_authenticatable' for #&lt;ActiveRecord::ConnectionAdapters::PostgreSQLAdapter::TableDefinition:0xd715388&gt;</code></p>\n\n<p>The migration is:</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def self.up\n    create_table(:users) do |t|\n      t.database_authenticatable :null =&gt; false\n      t.recoverable\n      t.rememberable\n      t.trackable\n      t.timestamps\n    end\n    add_index :users, :email,                :unique =&gt; true\n    add_index :users, :reset_password_token, :unique =&gt; true\n  end\n  def self.down\n    drop_table :users\n  end\nend\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13187712,"title":"Simple query needs to move to a model","body":"<p>I have a simple mysql query I need to put in my admin. It shows a list of  banned customers, as well as their name, notes field, and email.  We have queries all over the place in this antiquated rails 2.3 app. Although I'm new to rails, I'm pretty sure this needs to live in the Customer model.  I know how to build the table in the view, I'm just not sure on the syntax for the model, should it be a named scope, instance, yata yat ya...any recommendations or help would be more than welcome!</p>\n\n<pre><code>SELECT first_name, last_name, notes, email_primary\nFROM customer\nWHERE banned = 1\n</code></pre>\n"},{"tags":["ruby-on-rails","testing","rspec","fixtures"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13187769,"title":"Using yml fixtures with rspec","body":"<p>Right now, I have a directory spec/fixtures which contains several xxx.yml files, where xxx is the name of a database table (not a model, i.e. plural.) </p>\n\n<p>The ugly thing I do is:</p>\n\n<pre><code>rake db:fixtures:load RAILS_ENV=test FIXTURES_PATH=spec/fixtures\n</code></pre>\n\n<p>Because some trial and error led me to realize that db:fixtures needs to be instructed to operate on the test db, and that it doesn't look in spec/fixtures by default. There must be a nicer way to go.</p>\n\n<p>(I know that fixtures are passé and that one should use factory girl or stubs, but I have some good reasons IMO.)</p>\n"},{"tags":["css","ruby-on-rails","import","stylus"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13168239,"title":"Stylus: lineno (@import?) error","body":"<p>I'm getting this error through rails. I use one file to import <code>app/index.styl</code> and through there I import the entire folder in the right order.</p>\n\n<p>The weird thing about this is that there isn't a line 2 in the <code>app.css.styl</code> file</p>\n\n<pre><code>TypeError: /Users/thejameskyle/git/coachup/app/assets/stylesheets/app.css.styl:2\n   1| @import \"app\"\n &gt; 2| \n\nCannot read property 'lineno' of undefined\n\n  (in /Users/thejameskyle/git/coachup/app/assets/stylesheets/app.css.styl)\n</code></pre>\n\n<p>I've modified this file in every way possible but there is always a random extra line unless I add an escape (<code>\\</code>) at the end of the file. Even then it's still geting this error, just on the first line.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13187076,"title":"Paginating an Array in Ruby with will_paginate","body":"<p>I have an array @level1 which looks like this :</p>\n\n<pre><code>[[3.0, 4, 2], [2.0, 48, 3], [2.1, 56, 4], ............]\n</code></pre>\n\n<p>I want to apply pagination on this array such each page displays only a few rows at once. I tried this:</p>\n\n<pre><code>@temp1 = @level1.paginate(:page =&gt; params[:page])\n</code></pre>\n\n<p>But it throws the following error: </p>\n\n<pre><code>undefined method `paginate' for [[3.0, 4, 2], [2.0, 48, 3], [2.1, 56, 4]]:Array\n</code></pre>\n\n<p>How can I perform pagination on this using will_paginate?</p>\n"},{"tags":["ruby-on-rails","before-save"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13187082,"title":"Rails: before_save variable contents","body":"<p>I'm reading a guide about Rails and I came across this line in a Model class:</p>\n\n<pre><code>before_save { |user| user.email = email.downcase }\n</code></pre>\n\n<p>This is to make sure that the email address is lowercase before it hits the database (but you already know that, because you guys and gals are smart!).</p>\n\n<p>However, why not just have this:</p>\n\n<pre><code>before_save { |user| user.email.downcase! }\n</code></pre>\n\n<p>Wouldn't that be simpler to execute, or am I missing something?</p>\n"},{"tags":["ruby-on-rails","ejabberd"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13187314,"title":"ejabberd: manage adding / removing friends","body":"<p>Serious headaches, trying to get ejabberd to integrate into an existing Rails app to support the chat part. Hope anyone wich has gone true this could share some insights on how to best approach cause currently everwhere there are issues.</p>\n\n<p>My goals:</p>\n\n<p><strong>1. Store all data in mysql database for easy backup</strong>\n for this I have setup mysql usage for ejabberd using the mysql drivers so far so good</p>\n\n<p><strong>2. Easy add and remove users from each others roster ( add and remove friend connections )</strong> for this I have setup module rest and mod_admin_extra to be able to do restfull calls to ejabberd from the rails app. The ejabberd admin module allows to add and remove users BUT ( overflow: <a href=\"http://stackoverflow.com/a/5229902/355281\">http://stackoverflow.com/a/5229902/355281</a> ) This author says its not possible to store data in mysql Mnesia is always used by mod_admin_extra</p>\n\n<p><strong>3. Temporarily add users to each others list</strong> or preferrable have some temp room to add 2 users to so they can chat as long as this group exists. No idea how to approach this</p>\n\n<p>Problems with all this</p>\n\n<ol>\n<li>Seems not all data can be stored in mysql, so data shattering Mnesia &amp; Mysql , very bad to have data in 2 places and be unable to easy backup the mysql database</li>\n<li>Have to use rest module to do stuff to the database wich is on itself fine, but how to add 2 users to each friendlist is unclear to me.</li>\n</ol>\n\n<p>Although ejabberd seems to be the most complete out of the box xmpp server I might need to look for another server that tackles above issues. This part of my project has been big headaches hope someone can clarify, provide some suggestions on how to approach.</p>\n\n<p>for example:</p>\n\n<ul>\n<li>If facebook used ejabberd how did they tackle these issues?</li>\n<li>Is there a clean rewrite of ejabberd that tackles above problems? perhaps a commercial xmpp server with decent api and ways to add/ remove users and store data in 1 central location?</li>\n</ul>\n"},{"tags":["ruby-on-rails","email","heroku","asset-pipeline","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13186975,"title":"How do you get the full image url for emails with asset pipeline and Heroku?","body":"<p>I am trying to render out HTML for emails that include images with full urls. I am using Rails 3.2 (asset pipeline) and Heroku. I don't know where my problem is.</p>\n\n<p>I added this method to my application helper:</p>\n\n<pre><code>def image_url(source)\n  \"#{root_url[0..-2]}#{image_path(source)}\"\nend\n</code></pre>\n\n<p>In email.html.erb:</p>\n\n<pre><code>&lt;img src=\"&lt;%= image_url(\"images/email/logo.gif\") %&gt;\" width=\"102\" height=\"40\"&gt;\n</code></pre>\n\n<p>But the emails result in getting something like:</p>\n\n<pre><code>http://assets/email/logo-64cb67810752117f1de94cbb1c57a146.png\n</code></pre>\n\n<p>I assumed this meant that my root_url was blank on Heroku. I have tried setting it in my production.rb file like so:</p>\n\n<pre><code>config.action_controller.default_url_options = { host: \"www.domainname.com\" }\n</code></pre>\n\n<p>But this doesn't seem to work.</p>\n\n<p>What do I need to do to correctly render images with full urls in emails?</p>\n"},{"tags":["ruby-on-rails","ruby","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13187116,"title":"rails 3 gmaps4rails to_gmaps4rails empty","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13142085/gmaps4rails-json-is-being-returned-empty\">gmaps4Rails - json is being returned empty</a>  </p>\n</blockquote>\n\n\n\n<p>I have strange problem...\nI am trying to implement google maps with gmaps4rails, but I cant get it working...<br>\nthis is my <strong>model</strong>:</p>\n\n<pre><code>  acts_as_gmappable  \n\n  def gmaps4rails_address  \n    \"#{self.adresa}, Zagreb, Hrvatska\"\n  end\n</code></pre>\n\n<p>in my <strong>controller</strong> I got</p>\n\n<pre><code>  @json=Dvorane.all.to_gmaps4rails\n</code></pre>\n\n<p>In my <strong>view</strong> I got </p>\n\n<pre><code>  &lt;%= gmaps4rails(@json) %&gt;    \n  &lt;%= @json.inspect %&gt;\n</code></pre>\n\n<p>But I got empty map, and from inspecting <code>@json</code>, I got <code>[]</code>.</p>\n\n<p>What have I done wrong?\nOf course, Dvorane is not empty, and I have data in adresa field...\nthank you</p>\n"},{"tags":["ruby-on-rails","ruby","rest","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13186628,"title":"RESTful Rails 3 routing","body":"<p>I'm new to RESTful design and confused: if I make PUT, GET or POST to a same resource, say, /weblogs/myweblog, how should I write in the route.rb, and related controller?\nDoes the following works?\nIn route.rb</p>\n\n<pre><code>match 'weblogs/myweblog/new' =&gt; 'weblogs#create_new_blog'\nmatch 'weblogs/myweblog/edit/:id' =&gt; 'weblogs#edit_blog' \n.\n.\n</code></pre>\n\n<p>In weblogs_controller.rb</p>\n\n<pre><code>def create_new_blog\n   ...\nend\n\ndef edit_blog\n  params[:id]..\n  ....\nend\n</code></pre>\n\n<p>and confused if I want to do GET/PUT/POST on the same resource, if their URL is same but only HTTP request is different, how to write different operations in the controller? </p>\n"},{"tags":["ruby-on-rails","ruby","haml"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":12104195,"title":"How to add a function in haml file?","body":"<p>I have a haml file, which has many link_to buttons. I need to check a node within that haml file so that if that node has children, I can dynamically add a new button to show its children. I am using the_sortable _tree gem, Rails 3</p>\n\n<pre><code>-# COMP\n- comp= link_to(\"\", show_comp_admin_pages_path(@my_page, :node=&gt;node),\n    :title    =&gt;  \"Show Comp\",\n    :remote   =&gt;  true,\n    :class    =&gt;  \"button show-comp\")\n-# SUB\n- sub= link_to(\"\", show_sub_admin_pages_path(@my_page, :node=&gt;node),\n    :title    =&gt;  \"Show Sub\",\n    :remote   =&gt;  true,\n    :class    =&gt;  \"button show\")\n\n\n\n    -# OUTPUT\n- if (!node.root? )\n  = preview + edit + delete+**''''here i want to add new button if child exists''''**\n</code></pre>\n\n<p>I need to add one more button if node's child exists.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":10553433,"title":"simple_format and 2+ newline(\\n)","body":"<p>I'm using rails and need to show text, having 3 or more newline characters in a row.</p>\n\n<p>I found <code>simple_format</code> method, but it works with 2,3,4,... symbols identically</p>\n\n<blockquote>\n  <p>Two or more consecutive newlines(\\n\\n) are considered as a paragraph and wrapped in &lt; p > tags. </p>\n</blockquote>\n\n<p>For example, my text is</p>\n\n<pre><code>1.9.3p0 :015 &gt; Article.last.text\n=&gt; \"1\\n\\n2\\n\\n\\n\\n33\" \n</code></pre>\n\n<p>when i do <code>&lt;%= simple_format Article.last.text.html_safe %&gt;</code> it generates me this view:</p>\n\n<pre><code>&lt;p&gt;1&lt;/p&gt;\n&lt;p&gt;2&lt;/p&gt;\n# but i need &lt;br/&gt; or smth else there\n&lt;p&gt;3&lt;/p&gt;\n</code></pre>\n\n<p>Other solutions are welcome, thanks.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":61,"score":2,"question_id":13186722,"title":"What is the difference between using .exists?, and .present? in Ruby?","body":"<p>I want to make sure I'm using them for the correct occasion and want to know of any subtleties.  They seem to function the same way, which is to check to see if a object field has been defined, when I use them via the console and there isn't a whole lot information online when I did a google search. Thanks!</p>\n"},{"tags":["javascript","ruby-on-rails","twitter-bootstrap","modal"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1448,"score":2,"question_id":10466129,"title":"How to hide Bootstrap modal from javascript?","body":"<p>I've read the posts here, the Bootstrap site, and Googled like mad - but can't find what I'm sure is an easy answer...</p>\n\n<p>I have a Bootstrap modal that I open from a link_to helper like this:</p>\n\n<pre><code>&lt;%= link_to \"New Contact\", new_contact_path, {remote: true, 'data-toggle' =&gt; 'modal', 'data-target' =&gt; \"#myModal\",  class: \"btn btn-primary\"} %&gt;\n</code></pre>\n\n<p>In my <code>ContactsController.create</code> action, I have code that creates <code>Contact</code> then passes off to <code>create.js.erb</code>. In <code>create.js.erb</code>, I have some error handling code (a mix of ruby and javascript). If everything goes well, I want to close the modal.</p>\n\n<p>This is where I'm having trouble. I can't seem to dismiss the modal when all goes well. </p>\n\n<p>I've tried <code>$('#myModal').modal('hide');</code> and this has no effect. I've also tried <code>$('#myModal').hide();</code> which causes the modal to dismiss but leaves the backdrop. </p>\n\n<p>Any guidance on how to close the modal and/or dismiss the backdrop from within <code>create.js.erb</code>?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Here's the markup for myModal:</p>\n\n<pre><code>&lt;div class=\"modal hide\" id=\"myModal\" &gt;\n  &lt;div class=\"modal-header\"&gt;\n    &lt;a class=\"close\" data-dismiss=\"modal\"&gt;×&lt;/a&gt;\n    &lt;h3&gt;Add Contact&lt;/h3&gt;\n    &lt;div id=\"errors_notification\"&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"modal-body\"&gt;\n    &lt;%= form_for :contact, url: contacts_path, remote: true do |f| %&gt;  \n      &lt;%= f.text_field :first_name, placeholder: \"first name\" %&gt;\n      &lt;%= f.text_field :last_name, placeholder: \"last name\" %&gt;\n      &lt;br&gt;\n      &lt;%= f.submit \"Save\", name: 'save', class: \"btn btn-primary\" %&gt;\n      &lt;a class=\"close btn\" data-dismiss=\"modal\"&gt;Cancel&lt;/a&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"modal-footer\"&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}]}
{"total":93231,"page":14,"pagesize":100,"questions":[{"tags":["ruby-on-rails","datetime","time"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1499,"score":3,"question_id":1983937,"title":"Rails: How do I get created_at to show the time in my current time zone?","body":"<p>Seems that when i create an object, the time is not correct. You can see by the script/console output below. Has anyone encountered anything like this, or have any debugging tips?  </p>\n\n<pre><code> &gt;&gt; Ticket.create(...)\n=&gt; #&lt;Ticket id: 7, from_email: \"foo@example.com\", ticket_collaterals: nil, to_email: \"foo2@example.com\", body: \"hello\", subject: \"testing\", status: nil, whymail_id: nil, created_at: \"2009-12-31 04:23:20\", updated_at: \"2009-12-31 04:23:20\", forms_id: nil, body_hash: nil&gt;\n&gt;&gt; Ticket.last.created_at.to_s(:long)\n=&gt; \"December 31, 2009 04:23\"\n&gt;&gt; Time.now.to_s(:long)\n=&gt; \"December 30, 2009 22:24\"\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13186142,"title":"Modifying a SQL query for use with 'will_paginate' in Ruby","body":"<p>I have the following SQL query which I use to fetch some rows from a mySQL database :</p>\n\n<pre><code>SELECT code_ver, result FROM mastertest WHERE date &gt;= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;\n</code></pre>\n\n<p>This query gives me data from the past 90 days. Now I want to display the data of 10 days at a time in my html.erb page (view). I am aware that pagination can be done using 'will_paginate' and 'kaminari' gems. But I am not sure how to query the database with certain conditions as shown above.</p>\n\n<p>Can someone help me with the code here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13186592,"title":"Rails routes and helper functions","body":"<p>I have defined the following route on my routes file:</p>\n\n<pre><code>match \"/users/:id/courses\", :to =&gt; 'users#courses'\n</code></pre>\n\n<p>Do you know what is the helper function that is generated for that route?</p>\n\n<p>I have tried this:</p>\n\n<pre><code>users_courses_path(current_user)\nuser_courses_path(current_user)\nusers_course_path(current_user)\nuser_course_path(current_user)\n</code></pre>\n\n<p>But none of those works</p>\n\n<p>Regards</p>\n"},{"tags":["mysql","sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13186281,"title":"Stripping Phone Numbers of Non-numeric Values During SQL Query in Rails","body":"<p>I have a list of new restaurants and I want to check them against a database of restaurants using the phone number. The problem with phone numbers is that they have different formatting in the database (i.e. <code>123-345-6789</code> or <code>(123)-456 8988</code>).</p>\n\n<p>So far, I have created an index for the phone so that I search through them quickly. I also stripped the phone number of the new restaurants so that they only contain numeric values (0-9).</p>\n\n<p>Now, I want to strip the databases' numbers right before I compare so that I will strictly comparing numbers.</p>\n\n<pre><code>#strip the phone of non-numeric values and spaces\nformatted_phone = SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\") \n\nRestaurant.where(contact_phone: formatted_phone).each do |r|\n  #irrelevant code here\nend\n</code></pre>\n\n<p>The problem with the above code is that contact_phone (from database) will be in its non-stripped format. My research so far has lead me to believe that I have to use something like <code>REGEXP_LIKE</code>, but I'm not quite sure how to implement this with Rails. I do NOT want to update the database - I simply want to strip the numbers for comparison while still keeping the original formatting in the DB.</p>\n\n<p>How do I strip the phone numbers, <code>contact_phone</code>, of non-numeric values from the database before I compare it with <code>formatted_phone</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","fancybox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13186480,"title":"fancybox ajax rails degrading properly","body":"<p>I have a fancybox.ajax fancybox and in the controller</p>\n\n<pre><code>respond_to do |format|\n  format.html\n  format.js\nend\n</code></pre>\n\n<p>Then I have show.html.erb and _show.html.erb and show.js.erb</p>\n\n<p>But it is taking show.html.erb and putting it in the fancybox (including my application.html layout).</p>\n\n<p>I want both because I want to direct ppl to a url to get the html, and inapp users to have a lightbox.</p>\n\n<p>thanks!</p>\n"},{"tags":["ruby-on-rails","sqlite3","rake-task"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13183242,"title":"Rake Task not inserting into database","body":"<p>I have a ruby on rails application where I need to run a rake task which will hit the twitterstream api and insert tweets from a certain location into a database. For this I created a table called uncat_tweets. My rake task looks like this</p>\n\n<pre><code>task :get_uncat_tweets =&gt; :environment do\n  TweetStream.configure do |c|\n    ...\n    ...\n  end\n\n  puts \"#{UncatTweets.count}\n\n  client = TweetStream::Client.new()\n  client.locations(coordinates) do |status|\n    puts \"#{status.text}\"\n    t = UncatTweets.new()\n    t.text = status.text\n    t.long = ...\n    t.lat = ...\n    t.time = ....\n    t.save!\n  end\n</code></pre>\n\n<p>My uncat_tweets model looks like this:</p>\n\n<pre><code>class UncatTweets &lt; ActiveRecord::Base\n  attr_accessible :lat, :long, :text, :time, :user\nend\n</code></pre>\n\n<p>When i run rake get_uncat_tweets the tweetstream works and spews out tweets. But the rake task is not pushing to the database. The line <code>puts \"#{UncatTweets.count}\"</code> returns. I went  to the rails console and tried inserting a dummy value of UncatTweets and it worked! But when I run the rake task the program proceeds without error but never pushes into the database. Whats happening here? I am unable to find a solution to this problem.\nPlease help me</p>\n"},{"tags":["ruby-on-rails","activerecord","fixtures"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13186273,"title":"Rails test data, in the database","body":"<p>This might be a basic misunderstanding on my part. I have a bunch of logic in my app which collects sets of data from several tables and combines them into memory structures. I want to write tests for that logic.</p>\n\n<p>It seems to me that fixtures, factory girl and similar tools build in-memory model instances. If I do activerecord calls, like Model.find(foo: 12) won't those apply only against records that were saved? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activeadmin"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":145,"score":3,"question_id":11598116,"title":"ActiveAdmin display default view content","body":"<p>I am working with ActiveAdmin and need to make customizations to some views and have come across a couple of scenarios I feel I am doing wrong.</p>\n\n<p>I am adding an additional table to a show view (comments on Posts). This requires me to rewrite the whole attributes table and then add my panel. Is there a way to customize views without losing the default content?</p>\n\n<p>I would also like to add a table of associated items on the show view which doesn't need to be customized is there any way to include the default tale that would normally be on the index view with default actions and paging?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","belongs-to","activeadmin"],"answer_count":3,"favorite_count":8,"up_vote_count":12,"down_vote_count":0,"view_count":2032,"score":12,"question_id":7198062,"title":"Nested form in active_admin with select or create option","body":"<p>We are using active_admin for our administration backend. </p>\n\n<p>We have a model \"App\" that :belongs_to model \"Publisher\":</p>\n\n<pre><code>class App &lt; ActiveRecord::Base\n  belongs_to :publisher\nend\n\nclass Publisher &lt; ActiveRecord::Base\n  has_many :apps\nend\n</code></pre>\n\n<p>When creating a new entry for the \"App\" model I want to have the option to either select an existing publisher or (if the publisher is not yet created) to create a new publisher in the same (nested) form (or at least without leaving the page).</p>\n\n<p>Is there a way to do this in active_admin?</p>\n\n<p>Here's what we have so far (in admin/app.rb):</p>\n\n<pre><code>form :html =&gt; { :enctype =&gt; \"multipart/form-data\" } do |f|\n  f.inputs do\n    f.input :title\n    ...\n  end\n\n  f.inputs do\n    f.semantic_fields_for :publisher do |p| # this is for has_many assocs, right?\n      p.input :name\n    end\n  end\n\n  f.buttons\nend\n</code></pre>\n\n<p>After hours of searching, I'd appreciate any hint... Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13186074,"title":"Can't mass-assign protected attributes: product, user","body":"<p>Hello I'm working in a application where you can vote for a product and from the New action of my vote view I get this error: </p>\n\n<blockquote>\n  <p>ActiveModel::MassAssignmentSecurity::Error in VotesController#create</p>\n  \n  <p>Can't mass-assign protected attributes: product, user</p>\n</blockquote>\n\n<p>I make a test on rails console and it works. So I don't know what it's going on.</p>\n\n<p>Here are the models:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  attr_accessible :title\n  has_many :votes\n  has_many :users, :through =&gt; :votes\n  has_attached_file :photo, :styles =&gt; { :medium =&gt; \"300x300\" }\n\n  before_save { |product| product.title = title.titlecase }\n\n  validates :title, presence: true, uniqueness: { case_sensitive: false }\n  validates :photo, :attachment_presence =&gt; true\n\nend\n\nclass User &lt; ActiveRecord::Base\n    has_many :votes\n    has_many :products, :through =&gt; :votes\n    def self.from_omniauth(auth)\n      where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|\n        user.provider = auth.provider\n        user.uid = auth.uid\n        user.name = auth.info.name\n        user.oauth_token = auth.credentials.token\n        user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n        user.save!\n      end\n    end\nend\n\nclass Vote &lt; ActiveRecord::Base\n  attr_accessible :product_id, :user_id\n  belongs_to :product\n  belongs_to :user\nend\n</code></pre>\n\n<p>Here is the vote controller</p>\n\n<pre><code>class VotesController &lt; ApplicationController\n  # GET /votes\n  # GET /votes.json\n  def index\n    @votes = Vote.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @votes }\n    end\n  end\n\n  # GET /votes/1\n  # GET /votes/1.json\n  def show\n    @vote = Vote.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @vote }\n    end\n  end\n\n  # GET /votes/new\n  # GET /votes/new.json\n  def new\n    @vote = Vote.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @vote }\n    end\n  end\n\n  # GET /votes/1/edit\n  def edit\n    @vote = Vote.find(params[:id])\n  end\n\n  # POST /votes\n  # POST /votes.json\n  def create\n    @vote = Vote.new(params[:vote])\n\n    respond_to do |format|\n      if @vote.save\n        format.html { redirect_to @vote, notice: 'Vote was successfully created.' }\n        format.json { render json: @vote, status: :created, location: @vote }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @vote.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /votes/1\n  # PUT /votes/1.json\n  def update\n    @vote = Vote.find(params[:id])\n\n    respond_to do |format|\n      if @vote.update_attributes(params[:vote])\n        format.html { redirect_to @vote, notice: 'Vote was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @vote.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /votes/1\n  # DELETE /votes/1.json\n  def destroy\n    @vote = Vote.find(params[:id])\n    @vote.destroy\n\n    respond_to do |format|\n      format.html { redirect_to votes_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>and here is the new vote view</p>\n\n<pre><code>&lt;%= form_for(@vote) do |f| %&gt;\n  &lt;% if @vote.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@vote.errors.count, \"error\") %&gt; prohibited this vote from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @vote.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :product %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :product %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :user %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Please I really need your help to solve this issues, it was very difficult to find a tutorial with has_many :through that include the complete MVC example, I think my problem is on the view, but I don't know.</p>\n\n<p>Thanks!</p>\n"},{"tags":["mysql","ruby-on-rails","migration","decimal"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13181230,"title":"Rails decimal migration produces integer columns","body":"<p>I'm running Rails 3.1.1 using the mysql2 gem (v0.3.11). For some reason, when adding some decimal columns to a table, it produces integer fields. It does not give me any error, and the migration shows that decimal columns are being created. Has anyone else run into this problem? Here's a line from my migration:</p>\n\n<p><code>add_column :tracks, :energy, :decimal, precision: 18</code></p>\n\n<p>I don't usually run to StackOverflow but I really don't know where to look for the problem.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13186235,"title":"Ruby on Rails: wrong number of arguments (3 for 2)","body":"<p>For some reason I am getting an error on this method when I am trying to add a record.\nThe specific error is \nwrong number of arguments (3 for 2)</p>\n\n<pre><code>    def addrecord\n        res=MultiGeocoder.geocode(params[:street], params[:city], params[:state])\n        lat, lng = res.ll.split(\",\") \n        Bathroom.create(:name =&gt;params[:name],\n                        :bathroomtype =&gt;params[:bathroomtype],\n                        :street =&gt;params[:street],\n                        :city =&gt;params[:city],\n                        :state =&gt;params[:state],\n                        :country =&gt;params[:country],\n                        :postal =&gt;params[:postal],\n                        :lat =&gt; lat,\n                        :lon =&gt; lng,\n                        :access =&gt;params[:access], \n                        :directions =&gt;params[:directions],\n                        :comment =&gt;params[:comment],\n                        :created =&gt; Time.now,\n                        :source =&gt; 'Squat',\n                        :avail =&gt;params[:avail] )\n                        respond_to do |format|\n                          format.json   { render :nothing =&gt; true }                  \n\n                        end\n\n      end\n\n    This is an example call...\n\n&gt; http:..../bathrooms/addrecord?name=Apple%20Store&amp;bathroomtype=1&amp;street=One%20Stockton%20St.&amp;city=San%20Francisco&amp;state=CA&amp;country=United%20States&amp;postal=94108&amp;access=0&amp;directions=&amp;comment=&amp;avail=0\n</code></pre>\n\n<p>This is the request parms:</p>\n\n<p>Request</p>\n\n<p>Parameters:</p>\n\n<pre><code>{\"city\"=&gt;\"San Francisco\",\n \"avail\"=&gt;\"0\",\n \"access\"=&gt;\"0\",\n \"bathroomtype\"=&gt;\"1\",\n \"comment\"=&gt;\"\",\n \"country\"=&gt;\"United States\",\n \"directions\"=&gt;\"\",\n \"name\"=&gt;\"Apple Store\",\n \"street\"=&gt;\"One Stockton St.\",\n \"postal\"=&gt;\"94108\",\n \"state\"=&gt;\"CA\"}\n</code></pre>\n\n<p>What am I missing?</p>\n\n<p>Any help appreciated.</p>\n"},{"tags":["ruby-on-rails","api"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13185923,"title":"How to Learn Ruby on Rails - other than database integration (as a blog)","body":"<p>I am trying to learn Rails. It seems like most Rails tutorials explain how to build a blog. The problem is - I'm not building a blog. I am trying to learn how to build a Rails application that consumes data from an external API, manipulates the returned data, and displays it in a Rails View (but also uses a user registration functionality like I've seen in some blog tutorials).</p>\n\n<p>Are there any tutorials or learning resources that teach Rails functionality other than building a blog? :) I would appreciate any insight on mapping out my learning process.</p>\n\n<p>Thank you!!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13107076,"title":"Rails, attribute confirmation","body":"<p>I don't like how Rails confirmation validations attach the message \"doesn't match confirmation\" to the parent attribute...</p>\n\n<pre><code>validates(:password, {confirmation: true})\n</code></pre>\n\n<p>It makes more sense from a UX standpoint that an error should be passed to the confirmation, \"does not match password\", when the two don't match.</p>\n\n<p>Adding any validations to a confirmation attribute seem to be ignored...</p>\n\n<pre><code>validates(:password_confirmation, {my_validation: true, length: {maximum: 3}})\n</code></pre>\n\n<p>**<code>length</code> validation is just for testing purposes. Note that there's no error on the Password Confirmation field in this screenshot:</p>\n\n<p><img src=\"http://i.stack.imgur.com/e7sio.png\" alt=\"form screenshot\"></p>\n\n<p>I created a custom validation, <code>better_validation</code>:</p>\n\n<pre><code>class BetterConfirmationValidator &lt; ActiveModel::EachValidator\n  def validate_each(record, attr_name, value)\n    parent_attr = attr_name.to_s\n    parent_attr['_confirmation'] = ''\n    unless value == record.send(parent_attr)\n      record.errors.add(attr_name, :better_confirmation, options.merge(:value =&gt; value))\n    end\n  end\nend\n</code></pre>\n\n<p>But it doesn't work unless I name the confirmation field something different (i.e. add an 's' on the end...<code>:password_confirmations</code>).</p>\n\n<p>Is there a way to tell Rails not to take over and let me apply validations to <code>foo_confirmation</code> attributes?</p>\n\n<p>Thanks!</p>\n\n<h2>Edit</h2>\n\n<p>Model code...</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :name, :email, :password, :password_confirmation\n  attr_accessor :password, :password_confirmation\n\n  validates :name,\n    presence: true,\n    length: { maximum: 50 }\n  validates :email,\n    presence: true,\n    format: { with: /\\A.+@[a-z\\d\\-.]+\\z/i },\n    uniqueness: true\n  validates :password,\n    length: { minimum: 6, maximum: 255 },\n    presence: { on: :create }\n  validates :password_confirmation,\n    presence: true,\n    better_confirmation: true\n.\n.\n.\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","jquery-ui","jquery-ui-autocomplete"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13168894,"title":"jQuery-UI Autocomplete Widget passing multiple params to Rails server-side datasource","body":"<p>There was a question in the comments section of the AutoComplete Railscast that was unanswered and I need help with the same issue.\n<a href=\"http://railscasts.com/episodes/102-auto-complete-association-revised?view=comments#comment_159833\" rel=\"nofollow\">http://railscasts.com/episodes/102-auto-complete-association-revised?view=comments#comment_159833</a></p>\n\n<p>I'm implementing jQuery-UI Autocomplete with the datasource coming from a Rails Controller which in turn is calling the Foursquare API. The Foursquare API requires 2 parameters (a \"query\" and a \"lat/long\" value).</p>\n\n<p>The Autocomplete widget's default param that it sends to the Rails controller is params[:term] which contains the \"query\". I need the Autocomplete Widget to pull the value from another text_field (let's call it the geocode_location field) and pass that as the \"latlong\" param.  </p>\n\n<p>So effectively, the GET request to the Rails Controller would be </p>\n\n<p>Request URL:http://localhost:3000/foursquare?ll=37.7+-122.5&amp;term=McDonalds</p>\n\n<p>and not </p>\n\n<p>Request URL: URL:http://localhost:3000/foursquare?term=McDonalds </p>\n\n<p>Below is my current coffeescript file. I need to try to pass it extraParams or some way to let it know to pass a param named :latlong.  How do I do that with Coffeescript and this type of data source?</p>\n\n<pre><code> $('[type=\"text\"][name*=\"[location]\"]').autocomplete\n    source: $('[type=\"text\"][name*=\"[location]\"]').data('autocomplete-source')\n    focus: (event, ui) -&gt;\n      event.preventDefault()\n      $(this).val ui.item.label\n    select: (event, ui) -&gt;\n      event.preventDefault()\n      $(this).val ui.item.label\n      $(this).siblings('[name*=\"[foursquare_id]\"]').val ui.item.value\n</code></pre>\n\n<p>I'm not very familiar with Coffeescript syntax but really appreciate the help here.\nThere is a similar question here but the data source for the autocomplete results is different. <a href=\"http://stackoverflow.com/questions/3803998/jquery-ui-autocomplete-with-extra-params-returned-data\">jQuery UI - Autocomplete with extra params - returned data</a></p>\n"},{"tags":["python","mysql","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":66,"score":3,"question_id":11895995,"title":"python script is not working for rails migrated Mysql table","body":"<p>I have written a Python script for parsing CSV and insert those values to a MySQL table.\nThe  parsing csv and inserting part as follows:</p>\n\n<pre><code>csv_data = csv.reader(open(file_path, \"rb\"))\ndata_list = []\ncount = 0\n##Loop for inserting data to table in baches\nfor row in csv_data:\n    data_row = []\n    data_row.append(row[0])\n    data_row.append(row[1])\n    data_row.append(row[2])\n    ##removing the fist row\n    if count == 0:\n        count += 1\n        continue\n    else:\n        data_row.insert(0,keyword_type)\n        sql_command = \"insert into \"+ table_name +\"(keyword_type,old_keyword_id,old_keyword_name,master_keyword_name) values (\\\"\" +data_row[0]+\"\\\",\" + data_row[1]+ \",\\\"\" +data_row[2]+\"\\\",\\\"\" +data_row[3]+\"\\\")\"\n        cursor.execute(sql_command)  \n</code></pre>\n\n<p>It is perfectly working if we create a table manually by using create table command in MySQL.</p>\n\n<p>But I need to integrate this in to a rails environment and insert data to a table that created using migration. But after running the program is executing successfully and not showing any error. But data is not entering in to table. This is the problem.</p>\n\n<p>Thanks\nRegards</p>\n"},{"tags":["ruby-on-rails","production-environment","thin","webrick","unicorn"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1678,"score":4,"question_id":10859671,"title":"Webrick as production server vs. Thin or Unicorn?","body":"<p>It seems like it's taken for granted that you must not use Webrick as production server, but I can't really find anywhere mentioning why. The consensus seems to be:\n\"Webrick is ok for development, but Thin or Unicorn is the choice for production, period.\"</p>\n\n<p>I did look up Thin server's homepage and it talks about requests/second but I don't really understand the graph since there's no annotation.</p>\n\n<p>Can anyone let me know why I should use Thin or Unicorn compared to Webrick? Also is there any benefit to using Webrick for development? I've been using Webrick since it comes with rails, and I think there should be a reason why it's default.</p>\n\n<p>I'm using Heroku by the way.</p>\n"},{"tags":["ruby-on-rails","slim"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13185744,"title":"Creating Table Filters","body":"<p>I have a simple table with 3 columns like so</p>\n\n<pre><code>table\n  thead\n    th Element\n    th Owner\n    th Progress\n  tbody\n    == render :partial =&gt; \"element_row\" :collection =&gt; @elements :as =&gt; table_element\n</code></pre>\n\n<p>Each element is unique, and one owner may have several elements. There are a few different types of \"progress\" e.g. <code>\"started\"</code>, <code>\"not started\"</code>, and <code>\"completed\"</code>.</p>\n\n<p>I want to create a few links that filter the table. For example, I want to create an <strong>started</strong> link where when the user clicks on the link, the table is filtered down to only show rows where <code>\"started\"</code> is displayed. Another example of a filter is by owner.</p>\n\n<p>Does anyone have any suggestions for how to do this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":441,"score":1,"question_id":5207521,"title":"Ruby/Rails Parsing Emails","body":"<p>I'm currently using the following to parse emails:</p>\n\n<pre><code>  def parse_emails(emails)\n    valid_emails, invalid_emails = [], []\n    unless emails.nil?\n      emails.split(/, ?/).each do |full_email|\n        unless full_email.blank?\n          if full_email.index(/\\&lt;.+\\&gt;/)\n            email = full_email.match(/\\&lt;.*\\&gt;/)[0].gsub(/[\\&lt;\\&gt;]/, \"\").strip\n          else\n            email = full_email.strip\n          end\n          email = email.delete(\"&lt;\").delete(\"&gt;\")\n          email_address = EmailVeracity::Address.new(email)\n          if email_address.valid?\n            valid_emails &lt;&lt; email \n          else\n            invalid_emails &lt;&lt; email\n          end\n        end\n      end                    \n    end\n    return valid_emails, invalid_emails\n  end\n</code></pre>\n\n<p>The problem I'm having is given an email like:</p>\n\n<pre><code>Bob Smith &lt;bob@smith.com&gt;\n</code></pre>\n\n<p>The code above is delete Bob Smith and only returning bob@smith.</p>\n\n<p>But what I want is an hash of FNAME, LNAME, EMAIL. Where fname and lname are optional but email is not.</p>\n\n<p>What type of ruby object would I use for that and how would I create such a record in the code above?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","arrays"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13185611,"title":"How to display an array in a rails view?","body":"<p>I am very new to Rails, but have some Ruby understanding. How can I display the values of an array in a View in Rails?</p>\n\n<p>Where should I define the array (model or controller)? Also, how can I reference the array and iterate between its members on a View?</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","loops","block"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13185304,"title":"Rails finding a value in a table","body":"<p>Is it possible to call the <em>include?</em> function on a whole table, like this?</p>\n\n<pre><code>&lt;% @user.games.each do |g|\n   @@latestround = g.rounds.order('created_at DESC').first\n%&gt;\n    &lt;% if @@latestround.submittedpictures.isFinalPicture.include?(true) %&gt;\n        &lt;p&gt;FinalPicture has been played!&lt;/p&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem i'm getting is that It only works when I put a block on submittedpictures and then loop through each record of this table. However I want to look through the whole table in one go and see if the column 'isFinalPicture' includes a value with 'false'.</p>\n\n<p>Any ideas?</p>\n\n<p>The following snippet works but its not the way i want it (I would get more lines if the round happens to have more 'true' FinalPictures)</p>\n\n<pre><code>&lt;% @@latestround.submittedpictures.each do |s| %&gt;\n    &lt;% if s.isFinalPicture == true %&gt;\n         &lt;p&gt;Final Picture has been played!&lt;/p&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13185678,"title":"Ruby on Rails: Splitting out lat and long from","body":"<p>I have this code:</p>\n\n<pre><code>include Geokit::Geocoders\nres=MultiGeocoder.geocode('100 Spear st, San Francisco, CA')\nputs res.ll \n</code></pre>\n\n<p>the result of this would be something like this:\n37.7922379,-122.3939656</p>\n\n<p>I need to be able to grab the lat and long values individually.</p>\n\n<p>So, \nlat = something\nlong = something</p>\n\n<p>I think this works?</p>\n\n<pre><code>res=MultiGeocoder.geocode(params[:street], params[:city], params[:state])\nlatLongString = res.ll\nlatLongArray = latLongString.split(',')\nlat = latLongArray[0]\nlong = latLongArray[1]  \n</code></pre>\n\n<p>I am not sure of the best Ruby code for this?</p>\n\n<p>Any help appreciated.</p>\n"},{"tags":["ruby-on-rails","devise","authorization","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13184514,"title":"How to lock users using Devise?","body":"<p>I want to add a subscription type functionality in my application for the account holder users such that after a fixed interval of time they will not be able to access their account? Note: I dont want to delete their account from the database. I've already installed <code>devise-2.1.2</code> in my application. Do any body have any idea how can it be done? I am newbie to <code>Ruby on rails</code> so it will be very helpful to me if you please explain the steps.</p>\n\n<p>Thanks  </p>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13185411,"title":"Not seeing Devise folder in Rails App after install","body":"<p>I ran the following and have the devise gem included but I don't see the devise folder anywhere so I can override the views.</p>\n\n<ul>\n<li>$rails generate devise:install </li>\n<li>$rails generate devise User  </li>\n</ul>\n\n<p>I do not see this folder: app/views/devise/  </p>\n\n<p>I'm trying to follow this tutorial (http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html) but am getting hung up on a step where it deals with devise.  </p>\n\n<p>Any help would be greatly appreciated.  </p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails","backbone.js","jasmine"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13185430,"title":"Need Help to write a jasmine spec","body":"<p>Hello I am trying to write a jasmine test for a backbone view and one of its function. I want to test the correct behavior of the function in the case a user checks a checkbox in the rendered view then submit.</p>\n\n<p>Here is the tests :</p>\n\n<pre><code>describe(\"buildCI()\", function() {\n    describe(\"with a category selection allowed's quidget model\", function() {\n        it(\"returns a CoacheeIssue model with the selected categories\", function() {\n            selection_allowed = true;\n            lcc_selection_allowed = false;\n\n            var view = new Rails3DeviseRspecCucumber.Views.CategoryPicker({\n                collection: categoriesCollection,\n                answers: answers,\n                category_ids: category_ids,\n                credentials: credentialsCollection,\n                user_hash: user_hash,\n                selection_allowed: selection_allowed,\n                lcc_selection_allowed: lcc_selection_allowed  \n            });\n            // render the view so we can manipulate its DOM elements\n            view.render();\n            elDebug = $(view.$el);\n            // Check programmatically a category checkbox\n            $(elDebug.find('input.category-checkbox#5061c6a48624da6f4100000a')[0]).prop('checked', true);\n            // call the buildCI() function and check the result\n            result = view.buildCI();\n            console.log(result);\n            expect(result.get('categories')).toContain('category one');\n            expect(result.get('categories')).not.toContain('category two');\n        })\n    })\n</code></pre>\n\n<p>Unfortunately the test fails with this message : Expected [ ] to contain 'category one'.\nI know it is not a coding error, because it is working in live, I would just like to know how to test it.</p>\n\n<p>Here is the function :</p>\n\n<pre><code>buildCI: () -&gt;\n# prepare the category_ids and categories (names) attributes\nif @selection_allowed\n  selectedCategories = []\n  for checkbox in $('input.category-checkbox')\n    checkboxEl = $(checkbox)\n    if checkbox.checked\n      selectedCategories.push(_.find(@collection.models, (model) -&gt;\n        model.id == checkboxEl.attr('id')\n        ))\n  category_names = _.map(selectedCategories, (category) -&gt; category.get('name'))\n  category_ids = _.map(selectedCategories, (category) -&gt; category.get('_id'))\nelse\n  category_names = _.map(@collection.models, (category) -&gt; category.get('name'))\n  category_ids = _.map(@collection.models, (category) -&gt; category.get('_id'))\nreturn new Rails3DeviseRspecCucumber.Models.CoacheeIssue({ \n      is_solved: false, status: 'active', solution_value_estimate: '',\n      answers: @answers, categories: category_names, category_ids: category_ids\n    })\n</code></pre>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","sql-server","windows","activerecord"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1175,"score":5,"question_id":7655312,"title":"How to use activerecord-sqlserver-adapter with TinyTDS *and* an Integrated Security connection on Windows *without* saving a password in plain text","body":"<p>I'm trying to use Rails 3.1. with the activerecord-sqlserver-adapter (3.1.1) and tiny_tds (0.4.5) on a Windows machine.  In reading about TinyTDS and it's use of FreeTDS it looks like I can use Integrated Security (aka Windows Integrated security/NTLM) by putting a domain-qualified name as the user name (e.g. DOMAIN\\userbob).  <em>But</em> the docs still want me to type my domain user's password in the database.yml file.  That's bad practice because it's insecure and doesn't take advantage of single-sign on, which is part of the point for Integrated Security.</p>\n\n<p>Can I connect without saving a password in plain text in a file?  e.g.</p>\n\n<pre><code>developement:\n    adapter: sqlserver\n    mode: dblib\n    dataserver: localhost\n    database: dev_db\n    username: DOMAIN\\userbob\n#    password: no_no_please_dont_make_me_type_it_here\n</code></pre>\n\n<p>But, even if I put a password I get the following error:</p>\n\n<pre><code>TinyTds::Error: Unable to connect: Adaptive Server is unavailable or does not exist\n    from C:/Ruby192/lib/ruby/gems/1.9.1/gems/tiny_tds-0.4.5-x86-mingw32/lib/tiny_tds/client.rb:60:in `connect'\n    from C:/Ruby192/lib/ruby/gems/1.9.1/gems/tiny_tds-0.4.5-x86-mingw32/lib/tiny_tds/client.rb:60:in `initialize'\n</code></pre>\n\n<p>I know my server is running and the current user context can connect because this works:</p>\n\n<pre><code>sqlcmd -S localhost -d dev_db -E\n</code></pre>\n\n<p>Any insights?  Is it possible?  If not, it <em>should</em> be.</p>\n"},{"tags":["ruby-on-rails","rspec","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13163885,"title":"Unexpected nil variable in RSpec","body":"<p>I have a very basic RSpec example that doesn't work. Here's the code:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"Referral-type functionality\" do\n  describe \"Affiliate system\" do\n    before { @affiliate = Affiliate.create(account_id: 1) }\n    subject { @affiliate }\n\n    describe \"URL should work\" do\n      visit @affiliate.aff_url\n    end\n\n  end\nend\n</code></pre>\n\n<p>When I run it, though, rspec gives a NoMethodError because @affiliate is nil. What am I missing?</p>\n"},{"tags":["ruby-on-rails","rack","jekyll"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13021132,"title":"Why does Jekyll create new directories with index.html files in them when I create a new post?","body":"<p>Am I missing a setting somewhere? When the site is generated, the markdown files in the _posts directory get converted to directories themselves. Each of those directories has an index.html file in it with the content.</p>\n\n<p>I would obviously just prefer for the posts to be generated without creating a new directory for each post.</p>\n"},{"tags":["ruby-on-rails","database","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13185216,"title":"Creating Rails app from PostgreSQL database","body":"<p>I'm new to Rails, and I need to create a Rails app based on a PostgreSQL database I was given(it has only tables). Is there a way I could \"import\" the database to use in Rails, so that it would create the necessary MVCs or would I have to do it by hand?\nThanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":8848672,"title":"Is it possible to update from an action/method other than the update action/method in Ruby on rails?","body":"<p>Is it possible to update from an action/method other than the update action/method?\nFor example in my users controller I already have an update method for other parts of my users account.</p>\n\n<p>I need a separate one for changing my users password. Is it possible to have something like this:</p>\n\n<pre><code>def another_method_to_update\n  user = User.authenticate(current_user.email, params[:current_password])\n  if user.update_attributes(params[:user])\n    login user\n    format.js   { render :js =&gt; \"window.location = '#{settings_account_path}'\" } \n    flash[:success] = \"Password updated\" \n  else\n    format.js   { render :form_errors }\n\n  end\nend\n</code></pre>\n\n<p>Then have my change password form know to use that method to perform the update?</p>\n\n<p>It has 3 fields:\ncurrent password\nnew password\nconfirm new password</p>\n\n<p>and I use ajax to show the form errors.</p>\n\n<p>Kind regards</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13171726,"title":"How do I test the behavior inside an ActiveRecord creation block?","body":"<p>How can I test code like this with rspec?</p>\n\n<pre><code>Foo.create! do |foo|\n  foo.description = \"thing\"\nend\n</code></pre>\n\n<p>I don't want to test of the object was created -- I want to test if the right methods were invoked with the right objects. Equivalent to testing this:</p>\n\n<pre><code>Foo.create!(description: \"thing\")\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>Foo.should_receive(:create!).with(description: \"thing\")\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","ajax","sendfile"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":204,"score":1,"question_id":11570331,"title":"Ruby On Rails: send_file through jquery/ajax request","body":"<p>I am having trouble downloading files from my rails server through ajax:</p>\n\n<p>I have a show action in my downloads controller that calls <code>send_file</code> if a parameter is passed to the show action.</p>\n\n<p>I then have a page where there is a <code>select</code> dropdown that shows a list of files that are on the server. When I select a value and click the download button, it issues an ajax request that sends a GET request which is processed by my downloads controller.</p>\n\n<p>Looking at my server logs, it seems that the ajax request is working and it says:</p>\n\n<pre><code>Started GET \"/download?file=test.txt\" for 127.0.0.1 at 2012-07-19 15:13:41 -0700\nProcessing by DownloadsController#show as HTML\n  Parameters: {\"file\"=&gt;\"test.txt\"}\nSent file /Users/Admin/Documents/rails_projects/test/public/data/test.txt (0.1ms)\nCompleted 200 OK in 0ms (ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>However nothing is actually downloaded. When I actually visit the <code>show</code> page manually, the file is actually downloaded. What am I doing wrong? </p>\n\n<p>--</p>\n\n<p>Javascript</p>\n\n<pre><code> &lt;script type=\"text/javascript\"&gt;\n    $(function() {\n      $('#button').click(function() {\n        var s = $(\"select#dropdown_select\").val();\n               $.ajax({\n                      type: 'GET',\n                      url: 'http://localhost:3000/download?file=' + s,\n                      dataType: \"HTML\"\n                      });\n      })\n    });\n  &lt;/script&gt;\n</code></pre>\n\n<p>Downloads Controller</p>\n\n<pre><code>def show\n\n    filename = params[:dl]\n\n    if(filename.nil? == false)\n\n    path = Rails.root.join('public/data', filename)\n    send_file path, :x_sendfile =&gt; true\n\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","facebook","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12500831,"title":"Adding facebook birthday information to some model in rails / devise / omniauth","body":"<p>I had problems getting the birthday information from facebook into my app.\nBiggest problem was misunderstanding the permissions page from FB:\n<a href=\"http://developers.facebook.com/docs/authentication/permissions/\" rel=\"nofollow\">http://developers.facebook.com/docs/authentication/permissions/</a></p>\n\n<p>Here the birthday is described as user_birthday. But thats not how you can grab it from the response. I found a solution which is very easy.</p>\n"},{"tags":["ruby-on-rails","session","redis"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13184928,"title":"Rails sessions with redis and no database","body":"<p>Hi I'm currently working in this application that consumes some API to retrieve and send all the information, the API manage the database and in my side (Rails app) there is no database.</p>\n\n<p>I was told to use redis to store the sessions so here I am working with redis and no databases, my models don't use ARecord nor AResource. With this in mind I'm working in a logout method but since I don't have any database I'm not sure of what is the approach I should take to handle this because the session is stored in redis and I don't know the keys of the session and also I don't know how to link that session with the user logged I have no idea of how to delete this session.</p>\n\n<p>I'm open to suggestions but it has to be a redis kind of solution, there is any authentification for rails working with redis out there?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","associations","activeadmin"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13130809,"title":"Custom Active Admin form inputs for has_and_belongs_to_many relationship","body":"<p>I have a very simple model</p>\n\n<pre><code>class Lifestyle &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_and_belongs_to_many :profiles\nend\n</code></pre>\n\n<p>that has a <code>has_and_belongs_to_many</code> relationship with <code>Profile</code></p>\n\n<pre><code>class Profile &lt; ActiveRecord::Base\n  attr_accessible ...\n\n  belongs_to :occupation\n\n  has_and_belongs_to_many :lifestyles\n  accepts_nested_attributes_for :lifestyles\nend\n</code></pre>\n\n<p>I want to use ActiveAdmin to edit the Profile object, but also assign Lifestyles to a profile. It should be similar to dealing with <code>belongs_to :occupation</code>, as this is sorted out automatically by ActiveAdmin to a dropbox with the options pre-filled with available occupations. </p>\n\n<p>I've tried to use the <code>has_many</code> form builder method, but that only got me to show a form to type in the name of the Lifestyle and on submission, it returned an error.</p>\n\n<pre><code>    f.object.lifestyles.build\n    f.has_many :lifestyles do |l|\n      l.input :name\n    end\n</code></pre>\n\n<p>Error I get:</p>\n\n<pre><code>Can't mass-assign protected attributes: lifestyles_attributes\n</code></pre>\n\n<p><strong>The perfect way for me would be to build several checkboxes</strong>, one for each Lifestyle in the DB. Selected means that the lifestyle is connected to the profile, and unselected means to delete the relation. </p>\n\n<p>I'm having great doubts that this is possible using ActiveAdmin and without having to create very complex logic to deal with this. <strong>I would really appreciate it if you'd give your opinion and advise me if I should go this way or approach it differently.</strong></p>\n"},{"tags":["ruby-on-rails","activerecord","polymorphic","through"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13184776,"title":"ActiveRecord dynamic :through source type with polymorphic association","body":"<p>I have already found some <a href=\"http://stackoverflow.com/questions/6997141/rails-has-many-through-with-polymorphic-association-will-this-work\">good discussions</a> on through polymorphic associations. But I would like to find out more elegant solution.</p>\n\n<p>I have the following ActiveRecord models.</p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  has_many :question_record_rels\n  has_many :records1, :through =&gt; :question_record_rels, \n            :source =&gt; :recordable, :source_type =&gt; \"Person1\"\n  has_many :records2, :through =&gt; :question_record_rels, \n            :source =&gt; :recordable, :source_type =&gt; \"Person2\"\n  ...\n  ...\nend\n\nclass QuestionRecordRel &lt; ActiveRecord::Base\n  belongs_to :question\n  belongs_to :recordable, :polymorphic =&gt; true\nend\n</code></pre>\n\n<p>Since I have many types of \"Person\"s, I want the polymorphic has_many to be able to dynamically fetch person records. If I have the following instead of records1 and records2, I understand this would not work.</p>\n\n<pre><code>has_many :records, :through =&gt; :question_record_rels, :source =&gt; :recordable\n</code></pre>\n\n<p>And this would be one way of getting around the issue.</p>\n\n<pre><code>def records\n  question_record_rels.map do |r| r.recordable end\nend\n</code></pre>\n\n<p>Can you think of any better way to circumvent the issue, assuming that I know which source type I want(i.e. Person2)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13182089,"title":"Rails3: How to use the asset pipeline to build static assets","body":"<p>So I started investigating the asset pipeline in Rails3 and I have a desired use case that is somewhat off the beaten path...  so I'm looking for a recipe.</p>\n\n<ul>\n<li><p>I often run webrick locally for development and then run\nPassenger+Apache for deployed instances of the app.</p></li>\n<li><p>the app is configured with a suburi path, e.g. http:// server/approot/...</p></li>\n<li><p>to make webrick paths work like deployed instances, I added <code>map '/approot' do run app</code> to <code>config.ru</code>.  Now webrick is also at http:// local:3000/approot/...</p></li>\n</ul>\n\n<h1>The Confusion</h1>\n\n<p>Given this setup, I tried to use <code>rake assets:precompile</code> and have been having a lot of configuration problems between local, deployed -- missing files, incorrect paths, 404s in firebug, etc.  Here's a smattering of solutions I've tried:</p>\n\n<ul>\n<li><p><code>config.assets.initialize_on_precompile = false</code> to <code>application.rb</code> to prevent trying to initialize the app for <code>production</code>, (we have several deployed environments and call them different names, ug.) when precompiling the assets. </p></li>\n<li><p><code>config.assets.precompile += %w( *.js *.css )</code> to <code>application.rb</code> to include things like jquery.js and ujs and rails.js that were missing.</p></li>\n<li><p><code>config.assets.prefix = \"/approot/assets\"</code> to correct a problem where the map above (in config.ru) doesn't apply to assets, so assets had to be precompiled to <code>./public/approot/assets</code>, but I'm not sure if that only works locally, i.e. if I deploy, will my asset paths be <code>http:// server/approot/approot/(js|css|...)</code>?</p></li>\n</ul>\n\n<p>When precompiling assets, the rake task switches to env <code>production</code>, but then it is unclear from the Rails3 doc whether sprockets continues to compile on the fly locally and use those dynamic assets, or whether it will serve the static precompiled assets instead?</p>\n\n<ul>\n<li>I tried putting <code>config.serve_static_assets = true</code> in <code>environments/development.rb</code>, but I'm not sure how this works with <code>config.assets.compress = false</code> and <code>config.assets.debug = true</code>.  Setting the assets.debug to false just seems to hide the GET requests in the webrick log, although I saw a post saying that \"solved the problem\" [sic].</li>\n</ul>\n\n<h1>Requirments for a Recipe</h1>\n\n<p>So I'd like a recipe that does the following:</p>\n\n<ul>\n<li><p><strong>assets are consistently and correctly served from a path</strong> <code>http://server/approot/assets/...</code> whether run in passenger or webrick (i.e. deployed or local). If this isn't possible, then I can switch my local dev environment to use Passenger+Apache as well, it's not a big deal, but I just want to know if it's possible.</p></li>\n<li><p>raw assets exist in <code>/app/assets</code> like normal Rails3, but when I precompile them, they work exactly the same way in deployed envs so that <strong>asset file references don't break</strong> (i.e. right now, there are a lot of refs looking for <code>/assets/image/...</code> when the path is clearly set up as <code>/approot/assets/image...</code>. (It's unclear from the Rails3 doc whether there are assumptions about deploying to root vs a suburi, e.g. <code>http:// server/assets/...</code> vs. <code>http:// server/approot/assets/...</code>)</p></li>\n<li><p><strong>sprockets can't be used in deployed environments</strong> (our restriction, sorry).  So this means the rails3 app has to effectively look like a static asset app.  I know this is what precompiled assets are supposed to do, but the pathing issues are preventing me from getting this working as advertised.</p></li>\n</ul>\n\n<hr>\n\n<p>TL;DR - I feel like I'm trying a lot of separate things that might work if I only knew the right combination of them.</p>\n\n<h1>References</h1>\n\n<ul>\n<li><a href=\"http://guides.rubyonrails.org/asset_pipeline.html#precompiling-assets\" rel=\"nofollow\">http://guides.rubyonrails.org/asset_pipeline.html#precompiling-assets</a></li>\n<li><a href=\"http://blog.55minutes.com/2012/02/untangling-the-rails-asset-pipeline-part-2-production/\" rel=\"nofollow\">http://blog.55minutes.com/2012/02/untangling-the-rails-asset-pipeline-part-2-production/</a></li>\n<li><a href=\"http://blog.55minutes.com/2012/02/untangling-the-rails-asset-pipeline-part-3-configuration/\" rel=\"nofollow\">http://blog.55minutes.com/2012/02/untangling-the-rails-asset-pipeline-part-3-configuration/</a></li>\n<li><a href=\"https://github.com/rails/rails/pull/3946\" rel=\"nofollow\">https://github.com/rails/rails/pull/3946</a></li>\n</ul>\n"},{"tags":["ruby-on-rails","devise","sign"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13184649,"title":"rails 3 devise sign_in avoid default on root page","body":"<p>I use devise for rails 3.2 for authentication. I've changed the default routes from devise to: </p>\n\n<pre><code>devise_scope :user do\n    get 'signin' =&gt; 'devise/sessions#new', :as =&gt; :new_user_session\n    post 'signin' =&gt; 'devise/sessions#create', :as =&gt; :user_session\n    match 'signout' =&gt; 'devise/sessions#destroy', :as =&gt; :destroy_user_session,\n          :via =&gt; Devise.mappings[:user].sign_out_via\n  end\n</code></pre>\n\n<p>Now my sign in and sign up form is on the root site. How can I avoid to access 127.0.0.1:3000/signin but grant access to only 127.0.0.1:3000\nwhen i remove it, i will get an error message like this\noMethodError in Authentication#welcome\n    Showing /Volumes/Develop/login_app/app/views/authentication/welcome.html.erb where line #6 raised:</p>\n\n<pre><code>undefined method `user_session_path' for #&lt;ActionDispatch::Routing::RoutesProxy:0x007ffb4d711a10&gt;\nExtracted source (around line #6):\n</code></pre>\n\n<p>i have sign_in und sign_up on the root site..looks like this</p>\n\n<pre><code>&lt;h1&gt;Hello&lt;/h1&gt;\n\n\n&lt;h2&gt;Sign in&lt;/h2&gt;\n\n&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; session_path(resource_name)) do |f| %&gt;\n    &lt;div&gt;&lt;%= f.label :email %&gt;&lt;br /&gt;\n      &lt;%= f.email_field :email %&gt;&lt;/div&gt;\n\n    &lt;div&gt;&lt;%= f.label :password %&gt;&lt;br /&gt;\n      &lt;%= f.password_field :password %&gt;&lt;/div&gt;\n\n    &lt;% if devise_mapping.rememberable? -%&gt;\n        &lt;div&gt;&lt;%= f.check_box :remember_me %&gt; &lt;%= f.label :remember_me %&gt;&lt;/div&gt;\n    &lt;% end -%&gt;\n\n    &lt;div&gt;&lt;%= f.submit \"Sign in\" %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;%- if devise_mapping.recoverable? &amp;&amp; controller_name != 'passwords' %&gt;\n    &lt;%= link_to \"Forgot your password?\", new_password_path(resource_name) %&gt;&lt;br /&gt;\n&lt;% end -%&gt;\n\n\n&lt;h2&gt;Sign up&lt;/h2&gt;\n\n&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n    &lt;%= devise_error_messages! %&gt;\n\n    &lt;div&gt;&lt;%= f.label :email %&gt;&lt;br /&gt;\n      &lt;%= f.email_field :email %&gt;&lt;/div&gt;\n\n    &lt;div&gt;&lt;%= f.label :password %&gt;&lt;br /&gt;\n      &lt;%= f.password_field :password %&gt;&lt;/div&gt;\n\n    &lt;div&gt;&lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\n      &lt;%= f.password_field :password_confirmation %&gt;&lt;/div&gt;\n\n    &lt;div&gt;&lt;%= f.submit \"Sign up\" %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>now somebody can come and put 127.0.0.1/signin in the url and then it will show the sign_in form, i will avoid this, because it should show on the root site...\nthe same scenario like sing_up...\nthanks</p>\n"},{"tags":["ruby-on-rails","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13136321,"title":"Filtering integer field with a range","body":"<p>By default <code>filter :foo</code> where <code>foo</code> is an integer field will produce the equality filter. Are there any built-in ways to make it act just like date filter: to draw two inputs that will work like a range?</p>\n"},{"tags":["ruby-on-rails","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13095650,"title":"ActiveAdmin (Rails) empty class attribute for custom index table rows","body":"<p>I am using ActiveAdmin to render an index table for a model.</p>\n\n<p>The config looks like this:</p>\n\n<pre><code>ActiveAdmin.register User do\n  index do\n    selectable_column\n    column :username\n    column \"Email\" do |u|\n      raw \"&lt;span title='#{u.email}'&gt;#{truncate(u.email, length: 14)}&lt;/span&gt;\"\n    end\n  end\nend\n</code></pre>\n\n<p>The rendered HTML for the \"email\" TD looks like this:</p>\n\n<pre><code>  &lt;td class=\"\"&gt;&lt;span title=\"useremail@example.com\"&gt;useremail...&lt;/span&gt;&lt;/td&gt;\n</code></pre>\n\n<p>I have tried passing class: 'foo' before the block and a few things like that but none have worked.</p>\n\n<p>All of the columns that are not being created with the block syntax are getting a class attribute equal to the field name.</p>\n\n<p>How do I set the class for the TD when using a block to render the column?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13184339,"title":"Issues with jQuery UI autocomplete when form added with Javascript","body":"<p>I can't seem to get autocomplete working with forms that I'm adding to the screen with javascript. For example, I am using my new route to render my object's form. Inside my new.js.erb in rails file I have the following:</p>\n\n<pre><code>$(\"div#container\").hide().html(\"&lt;%= escape_javascript render 'form' %&gt;\").fadeIn();\n</code></pre>\n\n<p>Once rendered, if I type into my input element:</p>\n\n<pre><code>&lt;input id=\"object_name\" name=\"object[name]\" placeholder=\"Name\" size=\"30\" type=\"text\"&gt;\n</code></pre>\n\n<p>And listen with it with javascript:</p>\n\n<pre><code>jQuery -&gt;\n  $('input#object_name').autocomplete\n    source: ['Test', 'Testing', 'Test 234']\n</code></pre>\n\n<p>I get nothing as far as autocomplete is concerned. If I copy and paste this form though and have it on the screen at load (and not added dynamically with my rails new path) it will work fine. How do I get autocomplete to listen to things that are added dynamically?</p>\n"},{"tags":["ruby-on-rails","linux","solr","sunspot"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":11564182,"title":"Reasons for setting up standalone solr server when using Sunspot in production?","body":"<p>I am trying to figure out why we shouldn't use sunspot gem by itself in production environment? </p>\n\n<p>Most people recommend setting up a standalone <strong>solr</strong> service such as <strong>jetty+solr</strong> or <strong>tomcat+solr</strong>.</p>\n\n<p>Can anybody explain what are the cons of running as an embedded service?</p>\n"},{"tags":["ruby-on-rails","imagemagick","carrierwave","rmagick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13179867,"title":"Could lack of ram cause image processing to fail?","body":"<p>I have a 512MB Rackspace box on which I'm running 3 websites written using Ruby on Rails (4500-5000 visits per month).</p>\n\n<p>I'm using Carrierwave and RMagick to resize images I upload to the sites but this has recently stopped working with a generic error (Image failed to be processed).</p>\n\n<p>I'm at a loss as to why this would suddenly fail and can only think it started when I deployed app #3. Could the amount of RAM be causing image processing to fail?</p>\n\n<p>Thanks</p>\n\n<p>Robin</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13183769,"title":"rails custom rest route with parameter","body":"<p>I have a questions controller and an associated model and a number of rest routes.  Here is how it's set up in routes.rb:</p>\n\n<pre><code>resources :questions \n</code></pre>\n\n<p>I want to add a custom route that has the format /questions/widget/ID (where ID is the id of the question for which I want to generate a widget).  I want this to be processed by the \"widget\" action in my questions controller.  I've tried a number of things such as:</p>\n\n<pre><code>resources :questions  do\n   member do\n      get 'widget/:id'\n   end\nend\n</code></pre>\n\n<p>But nothing is working.  I'm sure I'm missing something simple.  Any ideas?  Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","cookies","rspec","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13183879,"title":"RSpec request object is nil","body":"<p>I'm trying to test for cookies in my request spec:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"Cookies\"\n  it \"should set correctly\" do\n    request.cookies['foo'] = 'bar'\n  end\nend\n</code></pre>\n\n<p>But this gives me <code>undefined method 'cookies' for nil:NilClass</code>. How do I fix this?</p>\n"},{"tags":["sql","ruby-on-rails","db2","db2-luw"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13183455,"title":"Unexpected token \"LIMIT\" in DB2","body":"<p>My Rails app is connected to a remote DB2 database, and when migrating I'm stumbling into this error:</p>\n\n<pre><code>==  DropLegacyProject: migrating ========================================\nrake aborted!\nAn error has occurred, this and all later migrations canceled:\n\nRuntimeError: Failed to execute statement due to: [IBM][CLI Driver][DB2/LINUXX8664] SQL0104N  An unexpected token \"LIMIT\" was found following \"\".  Expected tokens may include:  \"FETCH FIRST &lt;n&gt; ROWS ONLY\".  SQLSTATE=42601 SQLCODE=-104: SELECT  projects.* FROM projects WHERE projects.id &lt; 17 LIMIT 1\n</code></pre>\n\n<p>How can I fix this?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","capistrano","phusion-passenger"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13183541,"title":"How to get Rails 3 to run in production mode on server w/ Passenger","body":"<p>Hi I'm running Passenger/mySQL/mongo/Rails 3.2 with a Capistrano deploy script.</p>\n\n<p>I'm trying to get my app to run in production mode on my linux server.</p>\n\n<p>In my apache config file i have the following...</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n ServerName example.com\n ServerAlias www.example.com\n DocumentRoot /srv/www/example.com/current/public\n ErrorLog /srv/www/example.com/current/log/error.log\n CustomLog /srv/www/example.com/current/log/access.log combined\n PassengerDefaultUser www-data\n  &lt;Directory /srv/www/test.example.com/current/public&gt;\n     AllowOverride all\n     Options -MultiViews\n  &lt;/Directory&gt;\n RailsEnv production\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>In my environment.rb file I have the following...</p>\n\n<pre><code>RAILS_ENV=\"production\"\nRAILS_ENV.freeze\n</code></pre>\n\n<p>In my Capistrano deploy.rb I have the following...</p>\n\n<pre><code>set :rails_env, \"production\"\n</code></pre>\n\n<p>But when I deploy via capistrano on my homepage view I have the following line...</p>\n\n<pre><code>Running in &lt;%= Rails.env %&gt; mode\n</code></pre>\n\n<p>And it outputs \"Running in development mode\" when i hit that page after deployment.</p>\n\n<p>Also it is using the development database on my server as well.  What could I be missing to get this to run in production mode?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","architecture","software-engineering","sti"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13183638,"title":"Software Engineering issue: Simple ResumeBank","body":"<p>I would like to create simple ResumeBank app.</p>\n\n<p><strong>Issue</strong>:</p>\n\n<ol>\n<li>As user I would like to add only two Resumes.</li>\n<li>Forms for this both Resumes are different with only two fields.</li>\n</ol>\n\n<p><strong>Question:</strong> </p>\n\n<ol>\n<li>Should I split that Resume model and tables to ex: PolishResume and EnglishResume, polish_remsumes and english_remsumes?</li>\n<li>Or maybe should I use <strong>STI</strong> and create PolishResume &lt; Resume and use one table.</li>\n<li>What are advantages and disadvantages of this two options? </li>\n</ol>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13183193,"title":"Choosing between two bolean methods when setting up a form","body":"<p>I've been scratching heads for hours now, trying to figure out how to do this properly. I'm building a form, and want the user to choose between two options: <code>\"Lemonade\" OR \"Pepsi\"</code>. </p>\n\n<p>I've got <code>\"Lemonade\"</code> and <code>\"Pepsi\"</code> as <strong>two booleans</strong> in my database, and looking for a way to make the second checkbox be uncheckable when the first one is, OR have a drop down menu selecting only one of them (where <code>checked = true</code>). <br>In other words, when showing a <code>\"Drink list\"</code>, I want it to say <code>Pepsi = true/Lemonade=false</code> or vice versa. I've tried using validations, but can't seem to get this working. Any good ideas? </p>\n\n<p>Hope the question was understandable. </p>\n\n<p>FYI: New to RoR. </p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13183306,"title":"Nested Model Form unknown attribute error","body":"<p>I have a model <code>Subject</code> and a nested Model <code>Lessons</code></p>\n\n<p>I am encountering the problem of unknown attribute: <code>subject_id</code></p>\n\n<p>I have tried the different solutions suggested at <a href=\"http://stackoverflow.com/questions/6838297/rails-3-nested-models-unknown-attribute-error\">Rails 3 Nested Models unknown attribute Error</a> but I am still receiving the error.</p>\n\n<p>I am pretty new to Rails and I can't seem to figure out what went wrong. I would appreciate it if someone could help me out.</p>\n\n<p>Here are my relevant files.</p>\n\n<p>Subject Model</p>\n\n<pre><code>  attr_accessible :subjectCode, :subject_id\n\n  has_many :lessons, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :lessons, :reject_if =&gt; lambda { |a| a[:content].blank?     }, :allow_destroy =&gt; true\n\nend\n</code></pre>\n\n<p>Lesson Model</p>\n\n<pre><code>  attr_accessible :lessonName\n  belongs_to :subject\n</code></pre>\n\n<p>Subject Controller</p>\n\n<pre><code>def show\n  @subject = Subject.find(params[:id])\nend\n\ndef new\n  @subject = Subject.new\n  @lesson = @subject.lessons.build\nend\n\ndef create\n  @subject = Subject.new(params[:subjectCode])\n  if @subject.save\n    redirect_to @subject, :notice =&gt; \"Successfully created subject.\"\n  else\n    render :action =&gt; 'new'\n  end\nend\n</code></pre>\n\n<p>Subject Form</p>\n\n<pre><code>&lt;%= form_for @subject do |f| %&gt;\n&lt;%= f.error_messages %&gt;\n&lt;p&gt;\n  &lt;%= f.label :subjectCode %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :subjectCode %&gt;\n&lt;/p&gt;\n&lt;%= f.fields_for :lessons, @lesson do |builder| %&gt;\n&lt;p&gt;    \n&lt;%= builder.label :lessonName %&gt; &lt;br/&gt;\n&lt;%= builder.text_area :lessonName, :rows=&gt;3 %&gt;\n&lt;/p&gt;\n&lt;% end %&gt;\n&lt;p&gt;&lt;%= f.submit \"Submit\" %&gt;&lt;/p&gt;\n</code></pre>\n\n  \n\n<p>routes.rb</p>\n\n<pre><code>resources :subjects do resources :lessons end\n</code></pre>\n"},{"tags":["ruby-on-rails","redirect","http-headers","user-authentication"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13179798,"title":"Rails: User Authentification not redirecting after correct username/password input","body":"<p>I have a rails app, for some reason my login action does not work. I put in a correct username/password in, however it does not redirect to the desired 'menu' action. It just redirects me to the login action everytime (I have set that to happen when the login is unsucessful). I state <code>unless session[:user_id]</code> . When I input the wrong password on purpose, the flash message is correct, it says \"Invalid Username/Password\", when the correct one is input, it doesn't which means it recognises it, somehow the session is not being created. Below is my code</p>\n\n<p>Application Controller</p>\n\n<pre><code>protected\ndef confirm_logged_in\n    unless session[:user_id]\n        flash[:notice] = \"Please Log In\"\n        redirect_to(:controller =&gt; 'access', :action =&gt; 'login')\n        return false\n    else\n        return true\n    end\nend\n</code></pre>\n\n<p>Access Controller (Where the magic should be happening)</p>\n\n<pre><code>Class AccessController &lt; ApplicationController\n\nlayout 'admin'\n\nbefore_filter :confirm_logged_in, :except =&gt; [:login, :attempt_login, :logout]\n\ndef index\n    menu\n    render('menu')\nend\n\ndef menu\n    #display text &amp; links\nend\n\ndef login\n    #login form\nend\n\ndef attempt_login\n    authorised_user = AdminUser.authenticate(params[:username], params[:password])\n    if authorised_user\n        flash[:notice] = \"You are now logged in\"\n        redirect_to(:action =&gt; 'menu')\n    else\n        flash[:notice] = \"Invalid username/password\"\n        redirect_to(:action =&gt; 'login')\n    end\nend\n\ndef logout\n    session[:user_id] = nil\n    session[:username] = nil\n    flash[:notice] = \"You have been logged out\"\n    redirect_to(:action =&gt; 'login')\nend\n\nend\n</code></pre>\n\n<p>AdminUser Model</p>\n\n<pre><code>require 'digest/sha1'\n\nclass AdminUser &lt; ActiveRecord::Base\n\n# because we created a migration to change the name of the users tabe to admin_users we have   to specify\n# set_table_name(\"admin_users\")\n# or we can change the class name and file name like we did\nattr_accessible :first_name, :last_name, :username, :email \nattr_accessor :password\nattr_protected :hashed_password, :salt\n\nscope :named, lambda {|first,last| where(:first_name =&gt; first, :last_name =&gt; last)}\n\nhas_and_belongs_to_many :pages\nhas_many :section_edits\nhas_many :sections, :through =&gt; :section_edits\n\nEMAIL_REGEX = /^[A-Z0-9._%+-]+@[A-Z)0-9.-]+\\.[A-Z]{2,4}$/i\n\nvalidates_presence_of :first_name\nvalidates_presence_of :last_name\nvalidates_presence_of :username\n\nvalidates_length_of :first_name, :maximum =&gt; 25\nvalidates_length_of :last_name, :maximum =&gt; 50\nvalidates_length_of :username, :within =&gt; 3..25\n\nvalidates_length_of :password, :within =&gt; 8..25, :on =&gt; :create\n\nvalidates_uniqueness_of :username\n\nvalidates :email, :presence =&gt; true, :length =&gt; {:maximum =&gt; 100}, :format =&gt; EMAIL_REGEX, :confirmation =&gt; true\n\nbefore_save :create_hashed_password\nafter_save :clear_password\n\ndef self.authenticate(username=\"\", password=\"\")\nuser = AdminUser.find_by_username(username)\nif user &amp;&amp; user.password_match?(password)\n  return user\nelse\n  return false\nend\nend\n\ndef password_match?(password=\"\")\nhashed_password == AdminUser.hash_with_salt(password,salt) \nend\n\ndef self.make_salt(username=\"\")\nDigest::SHA1.hexdigest(\"User #{username} with #{Time.now} to make salt\")\nend\n\ndef self.hash_with_salt(password=\"\", salt=\"\")\nDigest::SHA1.hexdigest(\"Put #{salt} on the #{password}\")\nend\n\nprivate\n\ndef create_hashed_password\nunless password.blank?\n  self.salt = AdminUser.make_salt(username) if salt.blank?\n  self.hashed_password = AdminUser.hash_with_salt(password,salt)\nend\nend\n\ndef clear_password\nself.password = nil\nend\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","anchor","erb","link-to"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13183412,"title":"Add anchor option in Rails link_to using array","body":"<p>I'm using an array to generate the path for my rails link_to tags and can't seem to figure out how to add an anchor option. Here are my link_to tags:</p>\n\n<pre><code>&lt;%= link_to pluralize(post.comments.count, 'comment'), [post.postable, post] %&gt;\n\n&lt;%= link_to \"Leave a comment\", [post.postable, post] %&gt;\n</code></pre>\n\n<p>Since I'm using a polymorphic association for the posts (and they are nested routes), I can't simply use the paths generated by the resources helpers in the routes.rb file.</p>\n\n<p>Previously, I was able to use the anchor option on the paths automagically generated as I was not using the polymorphic association with this model. This is what that looked like:</p>\n\n<pre><code>&lt;%= link_to pluralize(post.comments.count, 'comment'), project_post_path(@project, post, {anchor: 'comments'}) %&gt;\n\n&lt;%= link_to \"Leave a comment\", project_post_path(@project, post, {anchor: 'new-comment'}) %&gt;\n</code></pre>\n\n<p>Any tips on how to get an anchor tag back into the link_to tags when using an array to generate the url? Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","paperclip","polymorphic-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":572,"score":0,"question_id":8430955,"title":"Unknown attribute error in create method of nested form with polymorphic object","body":"<p>I'm trying to get a simple nested form working for a has_many belong_to polymorphic association. The form is rendering the fields but when it submits it giives an 'unknown attribute' error from the create method. Here is the relevant code:</p>\n\n<p>user.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :images, :as =&gt; :imageable\n  accepts_nested_attributes_for :images  \nend\n</code></pre>\n\n<p>users_controller.rb</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n  def show\n    @user = User.find(params[:id])\n  end\n\n  def new\n    @user = User.new\n    @user.images.build\n  end\n\n  def create\n    @user = User.new(params[:user])\n    if @user.save\n      redirect_to @user\n    else\n      render 'new'\n    end\n  end\nend\n</code></pre>\n\n<p>views/users/new.html.erb</p>\n\n<pre><code>&lt;%= form_for @user, :html =&gt; { :multipart =&gt; true } do |form| %&gt;\n\n    &lt;%= form.fields_for :images, @user.images do |builder| %&gt;\n        &lt;%= builder.file_field :images %&gt;\n    &lt;% end %&gt;\n\n    &lt;%= form.submit \"Create user\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>image.rb</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n  belongs_to :imageable, :polymorphic =&gt; true\n\n  has_attached_file :image_resource\nend\n</code></pre>\n\n<p>I am using the paperclip gem for the has_attached_file method in image.rb. The exact error is \"unknown attribute: images\"</p>\n"},{"tags":["ruby-on-rails","generate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13182963,"title":"Rails - generate scaffold for multi select","body":"<p>I used the following method to generate scaffold for platform list in our app.</p>\n\n<p>\"rails generate scaffold platform name:string url:string country:string\"</p>\n\n<p>I would like to still use scaffold possibility to add additional attributes, like type and gender, which should be drop downs, or preferably multi-select's.</p>\n\n<p>Is there a way to use rails generate to create such a models?</p>\n"},{"tags":["ruby-on-rails","linux","x86-64"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13183282,"title":"Ruby on rails: cannot install FFI 1.1.5 and bundler cannot continue","body":"<p>I am following the tutorial on <a href=\"http://ruby.railstutorial.org/chapters/static-pages#top\" rel=\"nofollow\">the rails tutorial</a> and am on the third chapter (static pages). When I try to do the <code>bundle install</code> immediately under listing 3.1, the command throws an error message that indicates a failed linking. A snippet of the error is shown below:</p>\n\n<pre><code>Using bundler (1.2.1)\nUsing nokogiri (1.5.5)\nInstalling ffi (1.1.5) with native extensions\nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n/usr/bin/ruby18 extconf.rb  \nchecking for ffi_call() in -lffi... yes checking for ffi_prep_closure()... yes \nchecking for ffi_raw_call()... yes \nchecking for ffi_prep_raw_closure()... yes \nchecking for rb_thread_blocking_region()... no \nchecking for ruby_native_thread_p()... no \nchecking for rb_thread_call_with_gvl()... no creating extconf.h \ncreating Makefile\n... \n... \n... \nx86_64-pc-linux-gnu-gcc -I. -I. -I/usr/lib64/ruby/1.8/x86_64-linux -I. -DRUBY_EXTCONF_H=\\\"extconf.h\\\"    -fPIC -O2 -pipe -fno-strict-aliasing  -fPIC  -I/usr/lib64/libffi-3.0.10/include    -c LastError.c x86_64-pc-linux-gnu-gcc -shared -o ffi_c.so FunctionInfo.o MemoryPointer.o MethodHandle.o Platform.o Function.o LongDouble.o StructLayout.o StructByValue.o Struct.o Variadic.o ClosurePool.o Type.o Types.o ArrayType.o DynamicLibrary.o Thread.o Call.o Buffer.o StructByReference.o AbstractMemory.o ffi.o MappedType.o Pointer.o DataConverter.o LastError.o -L. -L/usr/lib64 -Wl,-R/usr/lib64 -L.-Wl,-O1 -Wl,--as-needed -rdynamic -Wl,-export-dynamic -Wl,--no-undefined     -Wl,-R -Wl,/usr/lib64 -L/usr/lib64 -lruby18 -lffi  -lffi   -lrt -ldl -lcrypt -lm   -lc \nThread.o: In function `rbffi_thread_blocking_region': \nThread.c:(.text+0xd0): undefined reference to `pthread_create' \nThread.c:(.text+0x106): undefined reference to `pthread_join' \nThread.o: In function `cleanup_blocking_thread': Thread.c:(.text+0x239): undefined reference to `pthread_kill'\nThread.o: In function `rbffi_blocking_thread': Thread.c:(.text+0x271): undefined reference to `pthread_testcancel' collect2: ld returned 1 exit status make: *** [ffi_c.so] Error 1\n\n\nGem files will remain installed in /home/user/.gem/gems/ffi-1.1.5 for inspection. \nResults logged to /home/user/.gem/gems/ffi-1.1.5/ext/ffi_c/gem_make.out \nAn error occurred while installing ffi (1.1.5), and Bundler cannot continue. \nMake sure that `gem install ffi -v '1.1.5'` succeeds before bundling.\n</code></pre>\n\n<p>From what I can gather, this is easily solved by adding the right library for pthread (-lpthread). But my question is, where do I add this? I see a lot of questions for solving this problem on MAC OS X, but none for linux. Any help appreciated.</p>\n"},{"tags":["ruby-on-rails","linkedin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":24,"score":-2,"question_id":13182516,"title":"How do I post from a RoR app to LinkedIn group?","body":"<p>How do I use LinkedIn API, OmniAuth-LinkedIn and LinkedIn gem post feeds to my LinkedIn Group?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solr","sunspot","sunspot-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13182815,"title":"Solr Search Stripping Phone Number in Database before Comparison","body":"<p>I have a list of restaurants that I want to match with the restaurants in my database using phone number. The problem is that the numbers are formatted differently (i.e. <code>(123)123-1234</code> or <code>123 123-123</code> or other combinations).</p>\n\n<p>My current Solr search looks like this:</p>\n\n<pre><code>search = Restaurant.solr_search do\n  with(:phone, SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\"))\n  paginate page: 1, per_page: 15\nend\n</code></pre>\n\n<p><code>SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\")</code> will strip down my search query to just numbers. However, the values in my database still contain other non-numeric characters and thus, <code>search.hits</code> returns an empty array because I'm not getting any results.</p>\n\n<p>Is there a way to strip my database values (<code>:phone</code>) before Solr does a search?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","backbone.js","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":13153610,"title":"Uploading files with Rails, Paperclip, and Backbone","body":"<p>I'm learning Rails by creating a simple imageboard. I want users to be able to upload images to the server and then I will be able to serve them.</p>\n\n<p>I'm using rails-backbone and paperclip.</p>\n\n<p>Here are the related portions:</p>\n\n<p>app/models/image.rb</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n  attr_accessible :url\n  attr_accessible :data\n  has_attached_file :data, :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\nend\n</code></pre>\n\n<p>app/assets/javascripts/backbone/templates/images/submit.jst.ejs</p>\n\n<pre><code>&lt;form id=\"new-image\" name=\"image\" data-remote=\"true\" enctype=\"multipart/form-data\"&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;label for=\"data\"&gt; image:&lt;/label&gt;\n    &lt;input type=\"file\" name=\"data\" id=\"data\"&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;input type=\"submit\" value=\"Create Image\" /&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>app/controllers/images_controller.rb</p>\n\n<pre><code>def create\n  @image = Image.new(params[:image])\n  respond_to do |format|\n    if @image.save\n      format.html { redirect_to @image, notice: 'Image was successfully created.' }\n      format.json { render json: @image, status: :created, location: @image }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @image.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>I also ran this migration:</p>\n\n<pre><code>class AddAttachmentDataToImages &lt; ActiveRecord::Migration\n  def self.up\n    add_attachment :images, :data \n  end\n\n  def self.down\n    remove_attachment :images, :data\n  end\nend\n</code></pre>\n\n<p>Upon attempting to save a file named \"fruits.png\", I get this output in the console:</p>\n\n<pre><code>Started POST \"/images\" for 127.0.0.1 at 2012-10-31 00:55:07 -0700\nProcessing by ImagesController#create as JSON\n  Parameters: {\"image\"=&gt;{\"url\"=&gt;nil, \"data\"=&gt;\"C:\\\\fakepath\\\\fruits.png\"}}\nCompleted 500 Internal Server Error in 2ms\n\nPaperclip::AdapterRegistry::NoHandlerError (No handler found for \"C:\\\\fakepath\\\\fruits.png\"):\n  app/controllers/images_controller.rb:16:in `new'\n  app/controllers/images_controller.rb:16:in `create'\n</code></pre>\n\n<p>Any help would be appreciated! Thanks!</p>\n"},{"tags":["ruby-on-rails","devise","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13179953,"title":"rails 3 devise avoid access /sign_in path","body":"<p>I use devise for rails 3.2 for authentication.  I've changed the default routes from devise to:</p>\n\n<pre><code>devise_scope :user do\n    get 'signin' =&gt; 'devise/sessions#new', :as =&gt; :new_user_session\n    post 'signin' =&gt; 'devise/sessions#create', :as =&gt; :user_session\n    match 'signout' =&gt; 'devise/sessions#destroy', :as =&gt; :destroy_user_session,\n          :via =&gt; Devise.mappings[:user].sign_out_via\n  end\n</code></pre>\n\n<p>Now my sign in and sign up form is on the root site.  How can I avoid to access 127.0.0.1:3000/signin but grant access to only 127.0.0.1:3000</p>\n"},{"tags":["ruby-on-rails","elasticsearch","tire"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13173185,"title":"not_analyzed is not working as expected","body":"<p>Mapping:</p>\n\n<pre><code>include Tire::Model::Search\nmapping do\n  indexes :name, :boost =&gt; 10\n  indexes :account_id\n  indexes :company_name\n  indexes :email, :index =&gt; :not_analyzed\nend\n\ndef to_indexed_json\n  to_json( :only =&gt; [:name, :account_id, :email, :company_name], \n         )\nend\n</code></pre>\n\n<p>From the above mapping the it can be seen that the email field is set to not_analyzed (no broken tokens). I have an user with email vamsikrishna@gmail.com.</p>\n\n<p>Now when I search for vamsikrishna, the result is showing the user...I guess it is using the default analyzer. why?</p>\n\n<p>But, it should be shown only when the complete email is specified I guess (vamsikrishna@gmail.com). Why is the :not_analyzed not considered in this case? Please help.</p>\n\n<p><strong>I need only the email field to be set as not_analyzed, other fields should use standard analyzer (which is done by default).</strong></p>\n"},{"tags":["ruby-on-rails","ruby","regex","vim","vimscript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13181620,"title":"How to quick refactor to newer Ruby syntax using Vim script?","body":"<p>I would like to quick refactor current line ex:</p>\n\n<pre><code>Subscription.create(:user =&gt; @user, :app =&gt; this_app, :verified =&gt; true, :approved =&gt; true)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Subscription.create(user: @user,app: this_app, verified: true, approved: true)\n</code></pre>\n\n<p>I would like to change that syntax only in line below cursor or in selected code.</p>\n"},{"tags":["sql","ruby-on-rails","query","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1249,"score":1,"question_id":2952482,"title":"Advanced count and join in Rails","body":"<p>I am try to find the top <code>n</code> number of categories as they relate to articles, there is a habtm relationship set up between the two. This is the SQL I want to execute, but am unsure of how to do this with ActiveRecord, aside from using the <code>find_by_sql</code> method. is there any way of doing this with ActiveRecord methods:</p>\n\n<pre><code>SELECT \n  \"categories\".id, \n  \"categories\".name, \n  count(\"articles\".id) as counter \nFROM \"categories\"\nJOIN \"articles_categories\" \n  ON \"articles_categories\".category_id = \"categories\".id\nJOIN \"articles\" \n  ON \"articles\".id = \"articles_categories\".article_id\nGROUP BY \"categories\".id\nORDER BY counter DESC\nLIMIT 5;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13181597,"title":"can I use a has_many method in a class method?","body":"<p>I have a Payment Model which is polymorphic on activities</p>\n\n<pre><code>class Payment\n  belongs_to :activity, polymorphic: true\nend\n</code></pre>\n\n<p>one of the activities is referrals.</p>\n\n<pre><code>class Referral\n  has_many :payments, :as =&gt; :activity\n\n  def self.unpaid\n    where(payments.count == 0)\n  end\nend\n</code></pre>\n\n<p>I want to create a class method so I can get all of the referrals which are unpaid.  I was using this approach above, but getting a undefined_method error on payments.<br>\nReferral.first.payments.count   works fine.  </p>\n\n<p>what am I missing here?  </p>\n"},{"tags":["ruby-on-rails","ruby","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13181400,"title":".toggle! returning \"no route\" ruby","body":"<p>OK probably a newbie mistake but I hope someone can help me. Let me start off by apologizing for the nature of the example.\nMy app requires to know if a Dog is or isn't neutered and view this option in a list of dogs.</p>\n\n<p>Example...<br>\nDog1 | owner | Neutered\nDog2 | owner | Not neutered</p>\n\n<p>The view looks great and even returns the properties properly the problem is when I click on the Neutered/Not neutered link it does not toggle the field in the Database and I get a Routing Erro No route matches [POST] \"/dogs/3\". </p>\n\n<p>I have a database called Dog and it has a Boolean option :neutered \nI have in my dogs_controller.rb</p>\n\n<blockquote>\n  <p>...<br>\n      def neuter<br>\n        @dog = Dog.find(param[:id])<br>\n        @dog.toggle!(:admin)<br>\n        flash[:success] = \"Changed Dog's neutered status\"<br>\n        redirect_to dogs_url<br>\n      end<br>\n      ...</p>\n</blockquote>\n\n<p>In my routes.rb I have</p>\n\n<blockquote>\n  <p>...<br>\n      resources :dogs do<br>\n          member do<br>\n          get :watching, :watchers  (used else where in program)\n        end<br>\n      end<br>\n  ...  </p>\n</blockquote>\n\n<p>in the partial that lists the dogs I have</p>\n\n<blockquote>\n  <p>...<br>\n  &lt;%= link_to dog.name, dog %><br>\n  &lt;%= if dog.neutered? %><br>\n  &lt;%= link_to \"Neutered\", dog, method: :neuter, data: { confirm: \"This will mark the dog as neutered. Are you sure?\" } %><br>\n  &lt;% else %><br>\n  &lt;%= link_to \"Not Neutered\", dog, method: :neuter, data: { confirm: \"This will mark the dog as not neutered. Are you sure?\" } %><br>\n  ...</p>\n</blockquote>\n\n<p>So what am I missing? I'm sure it's something simple but I can't seem to find it. I've tried several other options but nothing seems to fix it.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13180920,"title":"saving on a model with has_many association","body":"<p>Here is my problem, I have three models:</p>\n\n<p>ProductModel</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :photo\n  has_many :votes\n\n  has_attached_file :photo, :styles =&gt; { :medium =&gt; \"300x300\" }\n\n  before_save { |product| product.title = title.titlecase }\n\n  validates :title, presence: true, uniqueness: { case_sensitive: false }\n  validates :photo, :attachment_presence =&gt; true\n\nend\n</code></pre>\n\n<p>UserModel</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    def self.from_omniauth(auth)\n      where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|\n        user.provider = auth.provider\n        user.uid = auth.uid\n        user.name = auth.info.name\n        user.oauth_token = auth.credentials.token\n        user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n        user.save!\n      end\n    end\nend\n</code></pre>\n\n<p>VoteModel</p>\n\n<pre><code>class Vote &lt; ActiveRecord::Base\n  belongs_to :product\n  attr_accessible :user_id\nend\n</code></pre>\n\n<p>Now I need to save on my VoteModel a record with the ProductId and the UserId. But I don't know how to do this, can anyone help me please?</p>\n\n<p>UPDATE</p>\n\n<hr>\n\n<p>here is my vote view</p>\n\n<pre><code>&lt;%= form_for @vote, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n\n    &lt;%= f.label :user_id %&gt;\n    &lt;%= f.text_field :user_id %&gt;\n\n    &lt;%= f.label :product_id %&gt;\n    &lt;%= f.text_field :product_id %&gt;\n\n    &lt;%= f.submit \"Crear Producto\" %&gt;\n&lt;% end %&gt;\n\n&lt;%= link_to 'Cancel', root_path %&gt;\n</code></pre>\n\n<p>and here is the controller </p>\n\n<pre><code>class VotesController &lt; ApplicationController\n\n    def create\n        @some_product = Product.find(params[:id])\n        some_user = current_user\n        vote = Vote.create(:user =&gt; some_user, :production =&gt; some_product)\n        save!\n    end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13181902,"title":"Prevent sql update on existing Rails model when appending to has_many relationship","body":"<p>According to the present Rails documentation, regarding the <code>&lt;&lt;</code> operator on a has_many relationship on an <strong>existing object</strong>:</p>\n\n<pre><code>collection&lt;&lt;(object, …)\n\nAdds one or more objects to the collection by setting their foreign keys\nto the collection’s primary key. \n</code></pre>\n\n<p><em><strong>(This is the interesting bit)</em></strong></p>\n\n<pre><code>Note that this operation instantly fires update sql without waiting for \nthe save or update call on the parent object.\n</code></pre>\n\n<p>I didn't realize this would happen, I was quite surprised; I could have sworn this was not the case in the past, though I admit I could be wrong. </p>\n\n<p>In either case, I haven't been able to find any additional documentation regarding this, however I wonder if there is a way to prevent this update? </p>\n\n<p>My situation is simple, I merely have an object which exists in the database, which is being prepared for an \"edit\" page. I append one or multiple related objects before the page is render. C'est tout.</p>\n\n<p><strong>Update</strong>:\nApparently the same update-scenario also occurs if you set the has_many relationship directly from an array using the <code>=</code> operator.</p>\n"},{"tags":["ruby-on-rails","rails-migrations"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":1496,"score":8,"question_id":9713015,"title":"rails 3.2 migration cannot add index to create_table in change method","body":"<p>here is my migration in rails 3.2.2:</p>\n\n<pre><code>class CreateStatistics &lt; ActiveRecord::Migration\n  def change\n    create_table :statistics do |t|\n      t.string :name\n      t.integer :item_id\n      t.integer :value\n      t.text :desc\n\n      t.timestamps\n      t.index [:name, :item_id]\n    end\n\n  end\nend\n</code></pre>\n\n<p>and here is the migrate error:</p>\n\n<pre><code>==  CreateStatistics: migrating ===============================================\n-- create_table(:statistics)\nActiveRecord::ConnectionAdapters::TableDefinition\nrake aborted!\nAn error has occurred, all later migrations canceled:\n\nundefined method `index' for #&lt;ActiveRecord::ConnectionAdapters::TableDefinition:0xbd16888&gt;\n\nTasks: TOP =&gt; db:migrate\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>what is the right way to create a index?</p>\n"},{"tags":["ruby-on-rails","ruby","solr","sunspot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1508,"score":1,"question_id":3690921,"title":"RSolr RequestError Solr Response Severe errors in solr configuration","body":"<p>I was reindexing my model when I suddenly shutdown my mac,\nWhen I try to reindex again using (Model_name).reindex in script/console I encountered an error that I haven't encountered before.</p>\n\n<pre><code>RSolr::RequestError: Solr Response: Severe_errors_in_solr_configuration__Check_your_log_files_for_more_detailed_information_on_what_may_be_wrong__If_you_want_solr_to_continue_after_configuration_errors_change____abortOnConfigurationErrorfalseabortOnConfigurationError__in_null___javalangRuntimeException_javaioIOException_read_past_EOF__at_orgapachesolrcoreSolrCoregetSearcherSolrCorejava1068__at_orgapachesolrcoreSolrCoreinitSolrCorejava579__at_orgapachesolrcoreCoreContainer$InitializerinitializeCoreContainerjava137__at_orgapachesolrservletSolrDispatchFilterinitSolrDispatchFilterjava83__at_orgmortbayjettyservletFilterHolderdoStartFilterHolderjava99__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayjettyservletServletHandlerinitializeServletHandlerjava594__at_orgmortbayjettyservletContextstartContextContextjava139__at_orgmortbayjettywebappWebAppContextstartContextWebAppContextjava1218__at_orgmortbayjettyhandlerContextHandlerdoStartContextHandlerjava500__at_orgmortbayjettywebappWebAppContextdoStartWebAppContextjava448__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayjettyhandlerHandlerCollectiondoStartHandlerCollectionjava147__at_orgmortbayjettyhandlerContextHandlerCollectiondoStartContextHandlerCollectionjava161__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayjettyhandlerHandlerCollectiondoStartHandlerCollectionjava147__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayjettyhandlerHandlerWrapperdoStartHandlerWrapperjava117__at_orgmortbayjettyServerdoStartServerjava210__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayxmlXmlConfigurationmainXmlConfigurationjava929__at_sunreflectNativeMethodAccessorImplinvoke0Native_Method__at_sun\n        from /usr/local/lib/ruby/gems/1.8/gems/rsolr-0.12.1/lib/rsolr/connection/requestable.rb:39:in `request'\n        from /usr/local/lib/ruby/gems/1.8/gems/rsolr-0.12.1/lib/rsolr/client.rb:34:in `request'\n        from /usr/local/lib/ruby/gems/1.8/gems/rsolr-0.12.1/lib/rsolr/client.rb:22:in `update'\n        from /usr/local/lib/ruby/gems/1.8/gems/rsolr-0.12.1/lib/rsolr/client.rb:76:in `delete_by_query'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/indexer.rb:55:in `remove_all'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/session.rb:173:in `remove_all'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/session.rb:173:in `each'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/session.rb:173:in `remove_all'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/session_proxy/abstract_session_proxy.rb:11:in `remove_all'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot.rb:414:in `remove_all'\n        from /Users/cecilleann/Projects/dhire2/vendor/plugins/sunspot_rails-1.1.0/lib/sunspot/rails/searchable.rb:164:in `solr_remove_all_from_index'\n        from /Users/cecilleann/Projects/dhire2/vendor/plugins/sunspot_rails-1.1.0/lib/sunspot/rails/searchable.rb:183:in `reindex'\n        from (irb):6\n</code></pre>\n\n<p>Now I haven't been able to fix the error. Please help me. I can't move one.\nThanks a lot in advance</p>\n"},{"tags":["ruby-on-rails","ruby","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13180814,"title":"Rails linking to a nested resource from outside","body":"<p>I have a (simplified) routing like:</p>\n\n<pre><code>resources :users do\n    resources :messages\nend\n\nresources :searches\n</code></pre>\n\n<p>I have a Search model/resource, following Railscasts <a href=\"http://railscasts.com/episodes/111-advanced-search-form\" rel=\"nofollow\">http://railscasts.com/episodes/111-advanced-search-form</a></p>\n\n<p>Now when my search is complete, I'd like to have a link to the actual message which is under user_message_path, but I don't have access to it under the Search resource since it's not nested within.</p>\n\n<p>Is this a problem with the way I've routed/designed it or is there a Rails way of accessing this, like a helper method? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pdfkit"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":459,"score":0,"question_id":8842284,"title":"Rails 3 and PDFKit, how can I convert an HTML file into a landscape orientation PDF?","body":"<p>I can convert HTML pages into PDF documents well. The problem is, I don't know how to convert the HTML file into a landscape orientation PDF. Is there a way to set that in the controller?</p>\n\n<p>From the controller...</p>\n\n<pre><code>def pdf_customer_shipments\n  @customer = Customer.find(params[:id])\n  @shipments = Shipment.where(\"customer_id = ? AND status = 'Open'\", @customer.id)\n  render :layout =&gt; 'pdf'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hosting","amazon-ec2","amazon-web-services"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":6011088,"title":"Setting up Amazon Webservices for Rails","body":"<p>I've been trying to set up a web server using EC2 on Amazon web services. \nUsing the <code>appstack-nginx-passenger-ree</code> AMI, I tried to set up the server.</p>\n\n<p>I put my ruby files in <code>/opt/sites</code> and I installed <em>passenger</em> and <em>apache2-dev</em> &amp; <em>apace2-mpm-fork</em>.\nI had to set up the apache config file. \nAfterwards what should I do?</p>\n\n<p>How do I set the path file of the ruby files and deploy them?\nHow can I start up the server and be able to look at it?</p>\n"},{"tags":["ruby-on-rails","heroku","amazon-s3","paperclip","dragonfly-gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13181004,"title":"speed up uploads from Dragonfly to S3","body":"<p>(Rails 3.2 on Heroku)</p>\n\n<p>For handling image uploads in Rails I switched from <a href=\"https://github.com/thoughtbot/paperclip\" rel=\"nofollow\">Paperclip</a> to <a href=\"https://github.com/markevans/dragonfly\" rel=\"nofollow\">Dragonfly</a> because I like to be able to generate thumbnails dynamically, when they are requested for the first time.</p>\n\n<p>However, it seems that uploading of attached files to S3 (using <a href=\"https://github.com/markevans/dragonfly/blob/master/lib/dragonfly/data_storage/s3data_store.rb\" rel=\"nofollow\">S3DataStore</a>) is much slower than <a href=\"https://github.com/thoughtbot/paperclip/blob/master/lib/paperclip/storage/s3.rb\" rel=\"nofollow\">with Paperclip</a></p>\n\n<p>This is how an upload looks in a NewRelic transaction trace: <img src=\"http://i.stack.imgur.com/IUHcE.png\" alt=\"trace\"></p>\n\n<p>Anyone have experience in speeding this up?</p>\n"},{"tags":["ruby-on-rails","database","activerecord","heroku","vpn"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13180305,"title":"Accessing a database on a VPN","body":"<p>My Rails 3.2 app connects to a number of external servers, one of which is an SQL Server database (I connect to it using ActiveRecord + tinytds).</p>\n\n<p>Today, the database host decided to make it necessary to be on their VPN to access the database. My connections are now failing.</p>\n\n<p>How can I connect my Rails app (or just the connection to this database) to a VPN, so that I can access this database? My app is hosted on Heroku.</p>\n"},{"tags":["ruby-on-rails","authentication","devise","token"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":125,"score":0,"question_id":10386834,"title":"Is using token authentication necessary in my case?","body":"<p>I'm building a web app that relies on a client side mvc that make ajax calls to the server with rails to get data from the database.</p>\n\n<p>I thought that, since ajax call are made to a controller that require the user to be authenticated using devise, i had to use token authenticable to authenticate ajax calls.</p>\n\n<p>But I've noticed that If the user login the normal way than since the session data is stored and sent with each ajax call it isn't necessary to use token authentication...</p>\n\n<p>is this a bad approach?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13180850,"title":"Rails has_many :through with custom attribute?","body":"<p>I currently have a model for a vehicle, which has a custom method for defining an owner attribute:</p>\n\n<pre><code>def owners\n    @owners = sales.map(&amp;:customer) + quotes.map(&amp;:customer)\n    @owners = @owners.uniq\nend\n</code></pre>\n\n<p>This method seems to work just fine, and returns an array of owners for the vehicle.</p>\n\n<p>I am having a problem, however, when I want to use the <code>owners</code> that this method generates in another model. When I do this on another model:</p>\n\n<pre><code>has_many :owners, :through =&gt; :vehicles\n</code></pre>\n\n<p>This generates the error:</p>\n\n<pre><code>ActiveRecord::HasManyThroughSourceAssociationNotFoundError: Could not find the source association(s) :owner or :owners in model Vehicle.\n</code></pre>\n\n<p>I have tried adding <code>:source => :owners</code> but I get the same error.</p>\n\n<p>I should point out that I do have <code>:owners</code> in attr_accessible.</p>\n\n<p>So, can I do a :through association when owners is defined in a custom method, rather than being a normal variable?</p>\n"},{"tags":["ruby-on-rails","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13180832,"title":"\"Missing these required gems\" on specific server, gems are installed","body":"<p>Trying to run rake db:migrate I get:</p>\n\n<pre><code>$ rake db:migrate\n(in /home/paypro/domains/paypro.nl-staging)\nlog level debug\nMissing these required gems:\n  haml  ~&gt; 3.1.4\n  htmlentities  \n  fastercsv  \n\nYou're running:\n  ruby 1.8.7.72 at /usr/bin/ruby1.8\n  rubygems 1.3.7 at /home/paypro/.gem/ruby/1.8, /usr/lib/ruby/gems/1.8\n\nRun `rake gems:install` to install the missing gems.\nrake aborted!\nno such file to load -- json\n</code></pre>\n\n<p>I have two servers en both are updated via a git repository. On one server everything works fine, on the other I get the above error.</p>\n\n<p>Whats up?</p>\n"},{"tags":["ruby-on-rails","postgresql","heroku","taps"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13178026,"title":"heroku db:pull = Taps Server Error: undefined method `database_url' for #<DbSession","body":"<pre><code>*** LOCAL GEMS ***\n\nrails (3.2.8)\nheroku (2.33.0)\nheroku-api (0.3.6)\ntaps (0.3.24)\n</code></pre>\n\n<p>Despite having worked for months up until this morning, running <code>heroku db:pull</code> now starts to pull in the schema, but eventually results in:</p>\n\n<pre><code>Schema:         23% |=========                                 | ETA:  00:02:17\nSchema:         23% |=========                                 | ETA:  00:02:15\nSchema:         24% |==========                                | ETA:  00:02:13\nSchema:         25% |==========                                | ETA:  00:02:11\nSchema:         26% |==========                                | ETA:  00:02:09\nSchema:         26% |==========                                | ETA:  00:02:08\nSchema:         27% |===========                               | ETA:  00:02:06\nSchema:         28% |===========                               | ETA:  00:02:04\nSchema:         29% |============                              | ETA:  00:02:02\nSchema:         29% |============                              | ETA:  00:02:00\nSchema:         30% |============                              | ETA:  00:02:01\nSaving session to pull_201211010614.dat..\n!!! Caught Server Exception\nHTTP CODE: 500\nTaps Server Error: undefined method `database_url' for #&lt;DbSession:0x00000002710b18&gt;\n[\"/app/lib/taps/server.rb:149:in `block in &lt;class:Server&gt;'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:865:in `call'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:865:in `block in route'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:521:in `instance_eval'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:521:in `route_eval'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:500:in `block (2 levels) in route!'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:497:in `catch'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:497:in `block in route!'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:476:in `each'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:476:in `route!'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:601:in `dispatch!'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:411:in `block in call!'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:566:in `instance_eval'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:566:in `block in invoke'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:566:in `catch'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:566:in `invoke'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:411:in `call!'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:399:in `call'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:979:in `block in call'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:1005:in `synchronize'\", \"/app/.bundle/gems/ruby/1.9.1/gems/sinatra-1.0/lib/sinatra/base.rb:979:in `call'\", \"/home/heroku_rack/lib/static_assets.rb:9:in `call'\", \"/home/heroku_rack/lib/last_access.rb:15:in `call'\", \"/app/.bundle/gems/ruby/1.9.1/gems/rack-1.2.1/lib/rack/urlmap.rb:47:in `block in call'\", \"/app/.bundle/gems/ruby/1.9.1/gems/rack-1.2.1/lib/rack/urlmap.rb:41:in `each'\", \"/app/.bundle/gems/ruby/1.9.1/gems/rack-1.2.1/lib/rack/urlmap.rb:41:in `call'\", \"/home/heroku_rack/lib/date_header.rb:14:in `call'\", \"/app/.bundle/gems/ruby/1.9.1/gems/rack-1.2.1/lib/rack/builder.rb:77:in `call'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/connection.rb:76:in `block in pre_process'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/connection.rb:74:in `catch'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/connection.rb:74:in `pre_process'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/connection.rb:57:in `process'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/connection.rb:42:in `receive_data'\", \"/app/.bundle/gems/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'\", \"/app/.bundle/gems/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/backends/base.rb:57:in `start'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/server.rb:156:in `start'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/controllers/controller.rb:80:in `start'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/runner.rb:177:in `run_command'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/lib/thin/runner.rb:143:in `run!'\", \"/app/.bundle/gems/ruby/1.9.1/gems/thin-1.2.7/bin/thin:6:in `&lt;top (required)&gt;'\", \"/app/.bundle/gems/ruby/1.9.1/bin/thin:19:in `load'\", \"/app/.bundle/gems/ruby/1.9.1/bin/thin:19:in `&lt;main&gt;'\"]\n</code></pre>\n\n<p>Anyone ever seen this before?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":11,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":1563,"score":4,"question_id":6550538,"title":"What is the best Ruby on Rails training?","body":"<p>I'm looking to jump into Ruby on Rails development and was curious if anyone has taken any of the training options below.  I have looked at several online resources which are great:</p>\n\n<p><a href=\"http://railsforzombies.org/\" rel=\"nofollow\">http://railsforzombies.org/</a></p>\n\n<p><a href=\"http://railscasts.com/\" rel=\"nofollow\">http://railscasts.com/</a></p>\n\n<p><a href=\"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book\" rel=\"nofollow\">http://ruby.railstutorial.org/ruby-on-rails-tutorial-book</a> - By Mike Hartl</p>\n\n<p>Mr. Hartl's online book and sample application is a awesome resource for newbies like myself.  I've been writing a small application on my own to learn, but I'm finding that most of the time I'm just copying something that Mr. Hartl has done, or randomly googling things without a clear cut understanding of Ruby and Rails from the ground up.</p>\n\n<p>I have located several training courses which look interesting:</p>\n\n<p>Engine Yard: Zero to Rails 3\n<a href=\"http://www.engineyard.com/ruby_on_rails_training/scheduled_classes\" rel=\"nofollow\">http://www.engineyard.com/ruby_on_rails_training/scheduled_classes</a></p>\n\n<p>Pragmatic Studio: Ruby on Rails\n<a href=\"http://pragmaticstudio.com/rails/\" rel=\"nofollow\">http://pragmaticstudio.com/rails/</a></p>\n\n<p>Marakana: Ruby and Rails Bootcamp\n<a href=\"http://marakana.com/training/ruby/ruby_on_rails.html\" rel=\"nofollow\">http://marakana.com/training/ruby/ruby_on_rails.html</a></p>\n\n<p>The training ranges anywhere from $900 to $2200.  Before I commit my hard earned cash to some intensive Rails training, I was wondering if the community had any comments on the classes above or any other ones I have missed.  Thanks!</p>\n\n<p>PS I've been a Java developer for over 10 years, so I have a solid understanding of OO principles and MVC.  Just looking for something more exciting!</p>\n"},{"tags":["ruby-on-rails","activeadmin","controllers"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13180005,"title":"Modifying BaseController in rails ActiveAdmin gem","body":"<p>I am using the ActiveAdmin gem in a rails app.  If I wanted to add a new before filter that applies to all activeadmin gems, how would I do this?  I imagine I could modify the BaseController in ActiveAdmin to achieve this, but what is the proper way to make this modification from within the rails app?  Is there a way to duplicate and overwrite the BaseController?</p>\n"},{"tags":["ruby-on-rails","ruby","random"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":53,"score":4,"question_id":13180379,"title":"Select a random number a random number of times but never the same random number twice","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/119107/how-do-i-generate-a-list-of-n-unique-random-numbers-in-ruby\">How do I generate a list of n unique random numbers in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to do:</p>\n\n<pre><code>Random.rand(0..10).times do\n  puts Random.rand(0..10)\nend\n</code></pre>\n\n<p>with the exception that if a random number has already been displayed it cannot be displayed again. How do I do this most easily?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13176037,"title":"undefined method `tripphoto_changed?' for ... Carrierwave","body":"<p>I'm trying to save an image when adding a new Trip via an association. </p>\n\n<p>tripphoto.rb has a <code>belongs_to :trip</code> </p>\n\n<p>and my trip.rb has a <code>has_many :tripphotos</code>. Furthermore the Carrierwave documentation requires a few more things like an uploader and such which I've set up correctly (It worked without the association!). </p>\n\n<p>Along with it I've got <code>mount_uploader :tripphoto, TripphotoUploader</code> in my trip.rb and <code>accepts_nested_attributes_for :tripphotos, allow_destroy: true</code> to get my form working properly as such:</p>\n\n<pre><code>    &lt;%= fields_for :tripphotos do |photo| %&gt;\n      Img &lt;%= photo.file_field :filename %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Nonetheless I get the error <code>undefined method</code>tripphoto_changed?' for #`. A quick Google has no fitting result. Any advice?</p>\n\n<p>P.S here's my Tripphoto table:</p>\n\n<pre><code>class Tripphoto &lt; ActiveRecord::Base {\n    :id =&gt; :integer,\n    :filename =&gt; :string,\n    :trip_id =&gt; :integer,\n    :created_at =&gt; :datetime,\n    :updated_at =&gt; :datetime\n}\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Edit: On request my Codes:</p>\n\n<p>Trip.rb</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :user_id, \n  :triplocations_attributes, :photo, :category_ids, \n  :start_city, :tripphotos, :img_url, :thumb_url, :images,\n  :tags_attributes\n\n  # validates :title, :length =&gt; {:minimum =&gt; 3}\n  # validates :description, :presence =&gt; true\n  # validates_associated :tags\n\n\n  has_many :triplocations, :dependent =&gt; :destroy\n  has_many :tripphotos, :dependent =&gt; :destroy\n\n  has_and_belongs_to_many :categories\n  has_and_belongs_to_many :tags\n\n\n  accepts_nested_attributes_for :triplocations, allow_destroy: true\n  accepts_nested_attributes_for :tripphotos, allow_destroy: true\n  accepts_nested_attributes_for :categories\n  accepts_nested_attributes_for :tags\n\n\n  mount_uploader :tripphoto, TripphotoUploader\nend\n</code></pre>\n\n<p>Tripphoto.rb</p>\n\n<pre><code>class Tripphoto &lt; ActiveRecord::Base\n  attr_accessible :filename, :trip_id\n  belongs_to :trip\nend\n</code></pre>\n\n<p>The complete trip form</p>\n\n<pre><code>&lt;%= form_for @trip, :html =&gt; {:multipart =&gt; true} do |a| %&gt; \n    &lt;%= a.label :title, \"Routetitel\" %&gt;\n    &lt;%= a.text_field :title %&gt;\n\n    &lt;%= a.label :description, \"Omschrijving\" %&gt;\n    &lt;%= a.text_area :description %&gt;\n\n    &lt;%= a.label :start_city, \"Stad\" %&gt;\n    &lt;%= a.text_field :start_city, :id =&gt; \"cityName\" %&gt;\n\n    &lt;% for category in Category.find(:all) %&gt;\n        &lt;div&gt;\n          &lt;%= check_box_tag \"trip[category_ids][]\", category.id, @trip.categories.include?(category) %&gt;\n          &lt;%= category.name %&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n    &lt;%= a.fields_for :tags do |f| %&gt;\n        &lt;p&gt;\n            &lt;%= f.label :title, 'Steekwoorden:' %&gt;\n            &lt;%= f.text_field :title %&gt;\n        &lt;/p&gt; \n        &lt;div id=\"inputFields\"&gt;&lt;/div&gt;\n\n    &lt;% end %&gt;\n    &lt;div style=\"background: red;\"&gt;\n        &lt;%= fields_for :tripphotos do |photo| %&gt;\n          Img &lt;%= photo.file_field :filename %&gt;\n        &lt;% end %&gt;\n    &lt;/div&gt;\n\n\n    &lt;%= a.submit 'Verstuur' %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","cucumber","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13180449,"title":"logging to console using cucumber & Ruby on Rails","body":"<p>i'm building some test scenarios and steps using cucumber and rails </p>\n\n<p>for example here's a simple code to check and uncheck checkboxes in the page i want to log what is happening like a sort of debugging : </p>\n\n<pre><code>When /^I (un)?check all ratings$/ do |uncheck|\n  page.all(\"[type='checkbox']\").each do |checkbox|\n    if !uncheck\n      check(checkbox[:id])\n      #i want Here to log which checkboxes are checked\n    else\n      uncheck(checkbox[:id])          \n    end\n  end\nend \n</code></pre>\n"},{"tags":["ruby-on-rails","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13180112,"title":"FactoryGirl definition - undefined method for association","body":"<p>I have the following</p>\n\n<p>in /app/models:</p>\n\n<pre><code>class Area &lt; ActiveRecord::Base\n   has_many :locations\nend\nclass Location &lt; ActiveRecord::Base\n   belongs_to :area\nend\n</code></pre>\n\n<p>in /app/test/factories/areas.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :area do\n    name 'Greater Chicago Area'\n    short_name 'Chicago'\n    latitude 42\n    longitude -88\n  end\n  factory :losangeles, class: Area do\n     name 'Los_Angeles Area'\n     short_name 'Los Angeles'\n     latitude 50\n     longitude 90\n  end\nend\n</code></pre>\n\n<p>in /app/test/factories/locations.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :location do\n    name \"Oak Lawn\"\n    latitude 34\n    longitude 35\n    association :area\n  end\n  factory :malibu, class: Location do\n    name \"Malibu\"\n    latitude 60\n    longitude -40\n    association :losangeles\n  end\nend\n</code></pre>\n\n<p>When I try to run this I get:</p>\n\n<pre><code>NoMethodError: undefined method `losangeles=' for #&lt;Location:0x00000102de1478&gt;\ntest/unit/venue_test.rb:10:in `block in &lt;class:VenueTest&gt;'\n</code></pre>\n\n<p>Any help appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13175425,"title":"whenever: command not found","body":"<p>I have RVM set up on my mahchine, and installed the \"whenever\" gem on my machine to run cron jobs. When I tried to execute the command:</p>\n\n<pre><code> whenever --update-crontab store\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>-bash: whenever: command not found\n</code></pre>\n\n<p>I think a path issue is there. Kindly help me out.</p>\n"},{"tags":["javascript","ios","ruby-on-rails","ios6"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13178232,"title":"Rails iOS homescreen web app - can't delete records","body":"<p>I've got a web app which works perfectly in the browser - both on the desktop and mobile.\nThe problem comes when I try to pretty it up by adding:</p>\n\n<pre><code>&lt;meta name=\"apple-mobile-web-app-capable\" content=\"yes\" /&gt;\n</code></pre>\n\n<p>This works great too - up to the point I need to delete a record in the app.</p>\n\n<p>I'm also using this great gist I found - <a href=\"https://gist.github.com/1042167\" rel=\"nofollow\">https://gist.github.com/1042167</a> to stop the app switching into mobile safari:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n    (function(document,navigator,standalone) {\n        // prevents links from apps from oppening in mobile safari\n        // this javascript must be the first script in your &lt;head&gt;\n        if ((standalone in navigator) &amp;&amp; navigator[standalone]) {\n            var curnode, location=document.location, stop=/^(a|html)$/i;\n            document.addEventListener('click', function(e) {\n                curnode=e.target;\n                while (!(stop).test(curnode.nodeName)) {\n                    curnode=curnode.parentNode;\n                }\n                // Conditions to do this only on links to your own app\n                // if you want all links, use if('href' in curnode) instead.\n                if(\n                    'href' in curnode &amp;&amp; // is a link\n                    (chref=curnode.href).replace(location.href,'').indexOf('#') &amp;&amp; // is not an anchor\n                    (   !(/^[a-z\\+\\.\\-]+:/i).test(chref) ||                       // either does not have a proper scheme (relative links)\n                        chref.indexOf(location.protocol+'//'+location.host)===0 ) // or is in the same protocol and domain\n                ) {\n                    e.preventDefault();\n                    location.href = curnode.href;\n                }\n            },false);\n        }\n    })(document,window.navigator,'standalone');\n&lt;/script&gt;\n</code></pre>\n\n<p>I'm wondering if this could be altered so data-method=\"delete\" will play nice? at the minute - when I click 'Delete' - the 'are you sure?' confirm box hangs for a second or two, before dumping me back on the same Show page, with no delete having occured...</p>\n"},{"tags":["ruby-on-rails","ruby","cookies","session-cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13131036,"title":"Secure session cookie is not set","body":"<p>I'm trying to set the session cookie secure flag to true. I added the following to my environments/production.rb</p>\n\n<pre><code>ActionController::Base.session_options[:secure] = true\n</code></pre>\n\n<p>In the production mode I don't see the set-cookie header in the server response (I'm using the Tamper Data Firefox tool to view the traffic). I tried removing all cookies, manually setting the domain including the child domain(since domain is shared among many applications, the appache server forwards the requests to the right application and thus the request is always received by the application server as if it's coming from localhost).\nI also tried to test it in development mode, I assume the server should at least set the cookie even if the request is over http but the browser won't send the cookie over http but again the server does not send the set-cookie header. The session works just fine if I don't set the secure flag. Am I missing something here?</p>\n"},{"tags":["ruby-on-rails","ruby","refactoring","dry"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13178505,"title":"How to refactor complex search logic in a Rails model","body":"<p>My search method is smelly and bloated, and I need some help refactoring it. I'm new to Ruby, and I haven't figured out how to leverage it effectively, which leads to bloated methods like this:</p>\n\n<pre><code>  # discussion.rb\n  def self.search(params)\n    # If there is a search query, use Tire gem for fulltext search\n    if params[:query].present?\n      tire.search(load: true) do\n        query { string params[:query] }\n      end\n\n    # Otherwise grab all discussions based on category and/or filter\n    else\n\n      # Grab all discussions and include the author\n      discussions = self.includes(:author)\n\n      # Filter by category if there is one specified\n      discussions = discussions.where(category: params[:category]) if params[:category]\n\n      # If params[:filter] is provided, user it\n      if params[:filter]\n        case params[:filter]\n        when 'hot'\n          discussions = discussions.open.order_by_hot\n        when 'new'\n          discussions = discussions.open.order_by_new\n        when 'top'\n          discussions = discussions.open.order_by_top\n        else\n          # If params[:filter] does not match the above three states, it's probably a status\n          discussions = discussions.order_by_new.where(status: params[:filter])\n        end\n      else\n\n        # If no filter is passed, just grab discussions by hot\n        discussions = discussions.open.order_by_hot\n      end\n    end\n  end\n\n  STATUSES   = {\n    question:   %w[answered],\n    suggestion: %w[started completed declined],\n    problem:    %w[solved]\n  }\n\n  scope :order_by_hot,  order('...') DESC, created_at DESC\")\n  scope :order_by_new,  order('created_at DESC')\n  scope :order_by_top,  order('votes_count DESC, created_at DESC')\n</code></pre>\n\n<p>This is a Discussion model that can be filtered (or not) by a category: <code>question</code>, <code>problem</code>, <code>suggestion</code>.</p>\n\n<p>All discussions or a single category can be filtered further by <code>hot</code>, <code>new</code>, <code>votes</code>, or <code>status</code>. Status is a hash in the model and it has several values depending on the category (status filter only appears if params[:category] is present).</p>\n\n<p>Complicating matters is a fulltext search feature using Tire</p>\n\n<p>But my controller looks nice and tidy:</p>\n\n<pre><code>  def index\n    @discussions = Discussion.search(params)\n  end\n</code></pre>\n\n<p>Can I dry this up/refactor it a little, maybe using meta programming or blocks? I managed to extract this out of the controller, but then ran out of ideas. I don't know Ruby well enough to take this further.</p>\n"},{"tags":["ruby-on-rails","code-organization","project-organization"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13179093,"title":"What's the best place to put all logic about generating a report in ruby on rails?","body":"<p>I have many models which I use to obtain data and generate a report.</p>\n\n<p>The report doesn't need to be stored, i.e. it's not an active record.</p>\n\n<p>But certainly there's like 80 lines of code which generate the data for the report.</p>\n\n<p>Where should I put those lines?</p>\n\n<p>They are currently in the controller but since controller should be thin, I'm not sure if that's the best place.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13178882,"title":"has_may for a vote app","body":"<p>I'm new on rails and I'm trying to make my own simple vote application. I have two models:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :photo\n  has_many :votes\n\n  has_attached_file :photo, :styles =&gt; { :medium =&gt; \"300x300\" }\n\n  before_save { |product| product.title = title.titlecase }\n\n  validates :title, presence: true, uniqueness: { case_sensitive: false }\n  validates :photo, :attachment_presence =&gt; true\n\nend\n\n\nclass Vote &lt; ActiveRecord::Base\n  belongs_to :product\n  attr_accessible :user_id\nend\n</code></pre>\n\n<p>here is the product controller</p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n\n    http_basic_authenticate_with :name =&gt; \"dhh\", :password =&gt; \"secret\", :except =&gt; [:index]\n\n    def index\n        @products = Product.all\n    end\n\n    def indexprv\n        @products = Product.all\n    end\n\n    def show\n        @product = Product.find(params[:id])\n    end\n\n    def edit\n        @product = Product.find(params[:id])\n    end\n\n    def new\n        @product = Product.new\n    end\n\n    def create\n        @product = Product.new(params[:product])\n        if @product.save\n            redirect_to @product\n        else\n            render 'new'\n        end\n    end\n\n    def update\n    @product = Product.find(params[:id])\n    if @product.update_attributes(params[:product])\n        flash[:success] = \"Producto Actualizado\"\n        redirect_to root_path\n    else\n        render 'edit'\n    end\n  end\n\n  def destroy\n    Product.find(params[:id]).destroy\n    flash[:success] = \"Producto Eliminado.\"\n    redirect_to root_path\n  end\n\nend\n</code></pre>\n\n<p>I have many questions. </p>\n\n<p>How can I show the total votes per products on my index page of products?</p>\n\n<p>How can I create a button on my index product page to add a vote for a product?</p>\n\n<p>I don't know how to do this and I couldn't find any tutorial o blog with a similar example.</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["ruby-on-rails","json","mongoid","activemodel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13179820,"title":"JSON Performance in Rails","body":"<p>I'm running a query on my index action in a Rails app, and if you look at the logs it's pretty fast:</p>\n\n<pre><code>Started GET \"/apartments?within=-74.01798248291016%2C40.746346606483826%2C-73.8943862915039%2C40.79314877043915&amp;per_page=500\" for 127.0.0.1 at 2012-11-01 16:58:21 +0200\nProcessing by ApartmentsController#index as JSON\n  Parameters: {\"within\"=&gt;\"-74.01798248291016,40.746346606483826,-73.8943862915039,40.79314877043915\", \"per_page\"=&gt;\"500\"}\nMONGODB (228ms) development['$cmd'].find({\"count\"=&gt;\"apartments\", \"query\"=&gt;{:status=&gt;\"available\", :coordinates=&gt;{\"$within\"=&gt;{\"$box\"=&gt;[[-74.01798248291016, 40.746346606483826], [-73.8943862915039, 40.79314877043915]]}}}, \"fields\"=&gt;{:neighborhood_id=&gt;0}}).limit(-1)\nMONGODB (445ms) development['apartments'].find({:status=&gt;\"available\", :coordinates=&gt;{\"$within\"=&gt;{\"$box\"=&gt;[[-74.01798248291016, 40.746346606483826], [-73.8943862915039, 40.79314877043915]]}}}, {:neighborhood_id=&gt;0}).limit(500).sort([[:qs, :desc]])\nCompleted 200 OK in 9737ms (Views: 8816.0ms)\n</code></pre>\n\n<p>If the DB query only takes 445ms, why does the JSON take almost 10 seconds to render and get sent back over the wire?</p>\n\n<p>Is there a faster way to render the <code>@apartments</code> collection to JSON?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","declarative-authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13148125,"title":"if_attribute doesn't work with multiple hash on declarative_authorization","body":"<p>I use declarative_authorization on Ruby on rails 3.1.</p>\n\n<p>A group has many albums (groupalbum), a group is create by one user (user_id in foreign key for group table).\nOnly the owner of the group can create albums.</p>\n\n<p>Here is my authorization_rules.rb :</p>\n\n<pre><code>has_permission_on [:group_albums], :to =&gt; [:create] do\n    if_attribute :group =&gt;  { :user =&gt; is_in { user.groups } }\nend\n</code></pre>\n\n<p>Here is my GroupAlbumsControler :</p>\n\n<pre><code>class GroupAlbumsController &lt; ApplicationController\n    before_filter :set_group_album_from_params, :only =&gt; :show\n    before_filter :set_group_album_new, :only =&gt; [:index, :new]\n    filter_access_to :all, :attribute_check =&gt; true\n    (...)\nend\n</code></pre>\n\n<p>But it doesn't work :</p>\n\n<pre><code>You are not allowed to access this action.\n</code></pre>\n\n<p>Even if I'm logged in with the owner of the group.</p>\n\n<p>Where is my mistake ?</p>\n"},{"tags":["ruby-on-rails","cucumber","capybara","pry"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13179825,"title":"How to use Pry with Cucumber / Capybara?","body":"<p>What should I do to use Pry for debuging my Cucumber steps? Here is an example.</p>\n\n<pre><code>When 'I download a PDF via \"$label\"' do |label|\n  old_body = page.body\n  click_link(label)\n  page.driver.instance_variable_set '@body', page.body.pdf_to_text\n  binding.pry\nend\n</code></pre>\n\n<p>When I run a single scenario with that step I get access to Pry console </p>\n\n<pre><code>[1] pry(#&lt;Cucumber::Rails::World&gt;)&gt;\n</code></pre>\n\n<p>but I can't write anything. It seems that it stops working. Any ideas?</p>\n"},{"tags":["ruby-on-rails","devise","warden"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13179136,"title":"Using Rails + Devise, how can I \"manually\" validate a session cookie?","body":"<p>I've got a Rails (3.2.5) app using Devise (2.1.2) for auth.</p>\n\n<p>Suppose I have this session cookie:</p>\n\n<pre><code>session_cookie = {\n  \"session_id\"           =&gt; \"{SESSION_ID}\",\n  \"_csrf_token\"          =&gt; \"{CSRF_TOKEN}\",\n  \"warden.user.user.key\" =&gt; [\"User\", [{USER_ID}], \"{ENCRYPTED_PASSWORD}\"]\n}\n</code></pre>\n\n<p>Is there a way I can \"manually\" validate it, i.e., ensure it's not a forgery by directly calling a method on Devise or Warden? I'm imagining something like this: <code>Devise::SomeModule.is_session_cookie_valid?(session_cookie)</code>, but in looking in the gems' code, haven't found anything that seems to do this.</p>\n\n<p>If the information in <code>session_cookie</code> isn't sufficient, what else would I need?</p>\n"},{"tags":["ruby-on-rails","ruby","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13177161,"title":"Rails - Add devise user info to post","body":"<p>I have a web app where users can sign up, via Devise, and post pictures for other people to vote on.</p>\n\n<p>I'm trying to attach the users username to the photo that they upload, but I can't for the life of me figure out how.</p>\n\n<p>I figured out how to get the devise user_id into the form through a hidden field, but the username just shows up in the database as a blank field (not <code>NULL</code>, just blank).</p>\n\n<p>How do I get the username from devise to post instead of the user_id?</p>\n\n<p>I have all of the appropriate <code>belongs_to</code> and <code>has_many</code> in the models.</p>\n\n<p><strong>The form.</strong><br>\n<code>&lt;% if current_user %&gt;<br>\n    &lt;%= simple_form_for Picture.new, :remote =&gt; true, :html =&gt; { :class =&gt; \"form-horizontal\" } do |f| %&gt;<br>\n      &lt;%= f.input :title %&gt;<br>\n      &lt;%= f.input :image, :as =&gt; :image_preview, :label =&gt; false, :input_html =&gt; {:preview_version =&gt; :thumb} %&gt;<br>\n      &lt;div class=\"control-group\"&gt;<br>\n        &lt;div class=\"controls\"&gt;<br>\n          &lt;a href=\"#\" class=\"btn\" id=\"file\"&gt;Choose a File&lt;/a&gt;<br>\n        &lt;/div&gt;<br>\n      &lt;/div&gt;<br>\n      &lt;%= f.input :desc, :as =&gt; :text, :input_html =&gt; { :cols =&gt; 20, :rows =&gt; 3 }, :label =&gt; 'Description' %&gt;<br>\n      &lt;%= f.hidden_field :user_id %&gt;<br>\n      &lt;%= f.hidden_field :username %&gt;<br>\n      &lt;div class=\"control-group\"&gt;<br>\n        &lt;div class=\"controls\"&gt;<br>\n          &lt;div class=\"btn-group\"&gt;<br>\n            &lt;%= f.submit \"Add Picture\", :class =&gt; 'btn btn-primary' %&gt;<br>\n            &lt;button class=\"btn btn-danger\" id=\"form-cancel\"&gt;Cancel&lt;/button&gt;<br>\n        &lt;/div&gt;<br>\n      &lt;/div&gt;<br>\n    &lt;% end %&gt;\n</code></p>\n\n<p><strong>pictures_controller.rb</strong><br>\n</p>\n\n<pre><code>def create  \n  #This line inserts the user_id into the database\n  @picture = current_user.pictures.create!(params[:picture])  \n  @picture.save  \n    respond_to do |format|  \n      format.html { redirect_to pictures_url, notice: 'Thanks for your picture!' }  \n      format.js  \n    end  \nend   \n</code></pre>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13178996,"title":"Handling devise registration errors","body":"<p>I've subclassed the devise RegistrationsController for creating new users and added some logic before calling the superclass's 'create' method.  So, something like:</p>\n\n<blockquote>\n  <p>class RegistrationsController &lt; Devise::RegistrationsController</p>\n  \n  <p>def create    </p>\n  \n  <p>super end</p>\n</blockquote>\n\n<p>I can tell if the superclass encountered an error by checking resource.errors.nil?.  However, I want to distinguish between different errors.  For instance, I want to do something different if the error is \"Email has already been taken\" versus some other error return.</p>\n\n<p>I can parse the string, but that seems fragile to me.  What if some future upgrade of ActiveRecord or Devise changes the string?  What if the string get's localized in some way I don't expect?</p>\n\n<p>Is anyone handling error processing in devise more gracefully than string parsing?</p>\n"},{"tags":["ruby-on-rails","rake","mongoid","airbrake","moped"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13179437,"title":"Why is Mongoid/Moped throwing Timeout::Error to Airbrake in production Rake tasks?","body":"<p>I'm having a problem on my production installation. I have several scheduled rake tasks that run successfully. However, I've been getting MANY <code>Timeout::Error: execution expired</code> emails from Airbrake.</p>\n\n<p>But, here's the weird part: the Rake tasks all complete successfully. I'm capturing the stdout/stderr in the cron command, and the errors don't appear in the logs. I've also added simple print statements to the end of the rake tasks to verify their completion.</p>\n\n<p>Anyone have any ideas on the problem or how to further troubleshoot this? Thanks!</p>\n\n<p>Here is a stacktrace from one of the emails:</p>\n\n<pre><code>[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:203\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:203\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:235\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:203\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:260\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:260\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:259\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:153\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/connection.rb:30\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/node.rb:507\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/node.rb:122\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/node.rb:527\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/node.rb:542\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/node.rb:526\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/node.rb:515\n[GEM_ROOT]/gems/newrelic_moped-0.0.3/lib/newrelic_moped/instrumentation.rb:24\n[GEM_ROOT]/gems/newrelic_rpm-3.4.2.1/lib/new_relic/agent/method_tracer.rb:242\n[GEM_ROOT]/gems/newrelic_moped-0.0.3/lib/newrelic_moped/instrumentation.rb:20\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/node.rb:70\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/node.rb:376\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/cluster.rb:112\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/cluster.rb:125\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/cluster.rb:125\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/cluster.rb:78\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/cluster.rb:147\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/session/context.rb:108\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/session/context.rb:50\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/database.rb:76\n[GEM_ROOT]/gems/moped-1.2.5/lib/moped/query.rb:36\n[GEM_ROOT]/gems/mongoid-3.0.5/lib/mongoid/contextual/mongo.rb:69\n[GEM_ROOT]/gems/mongoid-3.0.5/lib/mongoid/contextual.rb:18\n[PROJECT_ROOT]/lib/tasks/reminders.rake:7\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/task.rb:205\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/task.rb:205\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/task.rb:200\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/task.rb:200\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/task.rb:158\n/usr/lib/ruby/1.9.1/monitor.rb:211\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/task.rb:151\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/task.rb:144\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:116\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:94\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:94\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:94\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:133\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:88\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:66\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:133\n[GEM_ROOT]/gems/rake-0.9.2.2/lib/rake/application.rb:63\n[GEM_ROOT]/gems/rake-0.9.2.2/bin/rake:33\n[GEM_ROOT]/bin/rake:19\n[GEM_ROOT]/bin/rake:19\n</code></pre>\n"},{"tags":["ruby-on-rails","deployment","ruby-on-rails-3","dreamhost"],"answer_count":8,"favorite_count":8,"up_vote_count":18,"down_vote_count":1,"view_count":7043,"score":17,"question_id":2250247,"title":"Rails 3 on dreamhost?","body":"<p>I'd like to deploy a small Rails 3 app on dreamhost (just for testing purposes, nothing serious) and I am wondering if anyone has done it already... Please choose one of the following:</p>\n\n<ol>\n<li>I did it and it's super easy, here's how: ...</li>\n<li>Though I didn't try it, it should be easy, here's how: ...</li>\n<li>It's quite complicated, but this should get you started: ....</li>\n<li>NO WAI!!!1!one!1 Set it up on slicehost or another non-shared hosting or you'll die a painful death trying to force it on DH</li>\n</ol>\n\n<p>Thoughts?</p>\n"},{"tags":["ruby-on-rails","testing","subdomain"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13159818,"title":"Same rails app, different subdomain","body":"<p>Does anyone in the whole world know how to set up a rails app, then set up a subdomain that uses all of the same code, except a different database?</p>\n\n<p>The implementation will be a front-end testing suite that utilizes all of the same url routes for slow testing, and will simultaneously test front and back end.</p>\n\n<p>Do you know how to do this?  If so, answer today!</p>\n\n<p>HAPPY HALLOWEEN</p>\n"},{"tags":["ruby-on-rails","redirect","login","devise"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1801,"score":5,"question_id":6989421,"title":"After a successful DEVISE login, how to redirect user back to previous action that required login?","body":"<p>I have an ajax voting button: If a user clicks on a \"thumbs up\" image, but is not logged in, then they should see a dialog box that asks them to login first.</p>\n\n<p>To do this dialog box,I'm using jQuery and facebox bound to ajax:failure event.  Devise will raise a 401 Unauthorized if the user is not logged in.  facebox loads the remote html for the login in a pop-up dialog box that presents the DEVISE signin form.</p>\n\n<p>Everything works except after successful login, user is redirected to the homepage.  It would be more intuitive if user was redirected back to the post they were looking at so they can continue their vote.  </p>\n\n<p>Is there a best practices way of achieving this behavior?  </p>\n\n<p>Thanks.</p>\n"},{"tags":["javascript","ruby-on-rails","ajax","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13178523,"title":"Rails: Get remote page via ajax","body":"<p>I use Rails3 and I try to get remote page via ajax. (https://play.google.com/store/apps/details?id=).</p>\n\n<pre><code>$.ajax({\n      url: app_url,\n      type: 'GET',\n      data: \"id=&lt;id&gt;\",\n      crossDomain : true,\n      dataType: 'jsonp',\n      success: function ( code ) {\n        alert(\"Good.\");\n      }\n    });\n</code></pre>\n\n<p>When I run the script, the I see: \"Uncaught SyntaxError: Unexpected token &lt; \" error message.</p>\n\n<p>By the way, I tried do it as: </p>\n\n<pre><code>$.ajax({\n      url: app_url,\n      type: 'GET',\n      data: \"id=&lt;id&gt;\",\n      crossDomain : true,\n      dataType: 'jsonp',\n      success: function ( code ) {\n        alert(\"Good.\");\n      }\n    });\n</code></pre>\n\n<p>But I see \"Origin <a href=\"http://example.com:3000\" rel=\"nofollow\">http://example.com:3000</a> is not allowed by Access-Control-Allow-Origin.\" error message.</p>\n\n<p>How can I fix the error and get the page ?</p>\n\n<p>Thanks.</p>\n"}]}
{"total":93231,"page":15,"pagesize":100,"questions":[{"tags":["sql","ruby-on-rails","database-connection"],"answer_count":3,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":118,"score":9,"question_id":12469094,"title":"How to get Rails to automatically reestablish database connections after a database downtime","body":"<p>After a database downtime, Rails will first throw this error once:</p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid: NativeException:\n  org.postgresql.util.PSQLException: Connection refused. Check that the\n  hostname and port are correct and that the postmaster is accepting\n  TCP/IP connections.</p>\n</blockquote>\n\n<p>From then on, every database call with have the following error, even after the database is back up:</p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid: ActiveRecord::JDBCError: This\n  connection has been closed.</p>\n</blockquote>\n\n<p>To get the server running again, I have to restart the rails server.  This is not ideal for us, as our prod engineers would like to do maintenance on our databases without having to also bring back up all the services that depend on the database.  So, I'm wondering - is there a way to automatically get Rails to try to reestablish the database connection or a recommended way to get this behavior?</p>\n\n<p>Things I have tried:</p>\n\n<p>I have already tried setting reconnect to true in my database options, and with that, I can kill individual database connections, and rails will reestablish the connections.  However, it will not after a database outage.  I found that from a command console I could get the connection back up by calling </p>\n\n<blockquote>\n  <p>ActiveRecord::Base::establish_connection</p>\n</blockquote>\n\n<p>So maybe finding a clean place for rails to call the above command this would work?  Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby","newrelic-rpm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13178507,"title":"newrelic: add method tracers to a class hierarchy","body":"<p>I have a Rails app where I want to instrument some methods with New Relic.</p>\n\n<pre><code>class Base         # in /lib/base.rb\n  def slow_method\n  end\nend\n\nclass Sub &lt; Base   # in /lib/sub.rb\n  def slow_method\n  end\nend\n</code></pre>\n\n<p>I instrumented that like so:</p>\n\n<pre><code># in /lib/base.rb\nclass Base\n  def self.inherited(other)\n    add_method_tracer :slow_method\n  end\nend\n</code></pre>\n\n<p>This looks good, but does not work. The tracer method is added before <code>slow_method</code> itself is defined.</p>\n\n<pre><code># in config/initializers/tracers.rb\n# attempt #1\n\nDir[\"lib/**/*.rb\"].each { |f| require f } # need to require everything\n\nBase.subclasses.each do |klass|\n  klass.class_eval do\n    add_method_tracer :slow_method\n  end\nend\n</code></pre>\n\n<p>This works. But it is ugly:</p>\n\n<ol>\n<li>I don't like to explicitly require everything.</li>\n<li>I should not need to iterate over subclasses.</li>\n</ol>\n\n<p>What's a good way to instrument methods in this kind of situation?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13178412,"title":"Using and in active record query","body":"<p>Is is allowed to use AND condition in active record? FOr example</p>\n\n<pre><code>Model.where(a&gt;b AND c&gt;d).all\n</code></pre>\n"},{"tags":["ruby-on-rails","asset-pipeline","tablesorter","assets","sprockets"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12879276,"title":"Sprockets::FileNotFound when trying to include a jQuery gem","body":"<p>I'm trying to use <a href=\"https://github.com/linjunpop/jquery-tablesorter-rails\" rel=\"nofollow\">https://github.com/linjunpop/jquery-tablesorter-rails</a> to sort my tables. I'm running into issues when trying to include the CSS:</p>\n\n<pre><code> /*\n * = require jquery-tablesorter/blue\n */\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>Sprockets::FileNotFound: couldn't find file 'jquery-tablesorter/blue'\n</code></pre>\n\n<p>I do see the Gem being loaded in the config path:</p>\n\n<pre><code>1.9.3p194 :008 &gt; Rails.application.config.assets.paths.each { |x| puts x }\n.rvm/gems/ruby-1.9.3-p194/gems/jquery-tablesorter-1.0.5/vendor/assets/images\n.rvm/gems/ruby-1.9.3-p194/gems/jquery-tablesorter-1.0.5/vendor/assets/javascripts\n.rvm/gems/ruby-1.9.3-p194/gems/jquery-tablesorter-1.0.5/vendor/assets/stylesheets\n</code></pre>\n\n<p>Any idea what the issue could be?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1091,"score":2,"question_id":4934194,"title":"\"Resulttype(#-614051528) expected, got String(#-608366078)\" with Many-to-Many association","body":"<p>Currently I'm creating something like a \"sports-managing-and-results-gathering-app\" in Rails 3. In this App I need to create several exercises which itself can have multiple 'resulttypes' (heartrate, distance in km, repititions, ...). And it should be possible to arrange the resulttypes in my prefered order. So, this is a classical many-to-many relationship.</p>\n\n<p>I came up with the following migrations:</p>\n\n<pre><code>    class CreateExercises &lt; ActiveRecord::Migration\n      def self.up\n        create_table :exercises do |t|\n          t.integer :user_id\n          t.string :name\n          t.text :beschreibung\n          t.integer :resulttype_id\n          t.boolean :active, :default =&gt; true\n          t.timestamps\n        end\n      end\n      def self.down\n        drop_table :exercises\n      end\n    end\n\n    class CreateResulttypes &lt; ActiveRecord::Migration\n      def self.up\n        create_table :resulttypes do |t|\n          t.string :name\n          t.string :einheit\n          t.text :beschreibung\n\n          t.timestamps\n        end\n      end\n\n      def self.down\n        drop_table :resulttypes\n      end\n    end\n\n    class CreateExercisesResulttypesJoin &lt; ActiveRecord::Migration\n      def self.up\n        create_table :exercises_resulttypes, :id =&gt; false do |t|\n          t.integer \"exercise_id\"\n          t.integer \"resulttype_id\"\n        end\n        add_index :exercises_resulttypes, [\"exercise_id\", \"resulttype_id\"]\n      end\n\n      def self.down\n        drop_table :exercises_resulttypes\n      end\n    end\n</code></pre>\n\n<p>which works nicely with this formtastic code:</p>\n\n<pre><code>    &lt;%= semantic_form_for(@exercise) do |f| %&gt;        \n      &lt;%= f.inputs do %&gt;\n        &lt;%= f.input :name %&gt;\n        &lt;%= f.input :beschreibung %&gt;\n        &lt;%= f.input :resulttype %&gt;\n        &lt;%= f.input :active %&gt;\n      &lt;% end %&gt;\n      &lt;%= f.buttons %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>The problem is here, that with this code I can not sort the resulttypes and each exercise can have each resulttype once only.\nSo I changed the formtastic :resulttype form code to this (except the jquery code):</p>\n\n<pre><code>    &lt;div id=\"conn_ctrl\" class=\"float_left center\"&gt;\n            &lt;div class=\"float_left center\"&gt;\n                &lt;%= f.select :resulttypes, @resall.collect{|d| [d.name,d.id]}.sort, {}, { :multiple =&gt; true, :class =&gt; \"conn_select\" } %&gt;&lt;br&gt;\n            &lt;/div&gt;\n            &lt;div class=\"float_left center\"&gt;\n                &lt;%= f.select :resulttypes, '', {}, { :multiple =&gt; true, :id =&gt; \"exercise_resulttypes_save\", :class =&gt; \"conn_select\" } %&gt;&lt;br&gt;\n            &lt;/div&gt;\n            &lt;div style=\"clear: both\"&gt;&lt;/div&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"remove\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"&lt;&lt;\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"add\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"&gt;&gt;\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"up\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"Up\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"down\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"Down\" }, false) %&gt;&lt;br&gt;\n        &lt;/div&gt;\n        &lt;div style=\"clear: both\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Now I have a \"Dual Listbox\" and I can add exercises to this specific workout multiple times and order it how I like it.\nBUT, when I submit the form, I get this error and I have no idea what that means:</p>\n\n<blockquote>\n  <p>Resulttype(#-614051528) expected, got String(#-608366078)</p>\n</blockquote>\n\n<p>The submitted parameters are:</p>\n\n<pre><code>    {\"commit\"=&gt;\"Create Exercise\",\n     \"authenticity_token\"=&gt;\"v1l9zfxdxIJbdjZx6SsZ5tGuKMrlioBg+C9orSmVarA=\",\n     \"utf8\"=&gt;\"✓\",\n     \"exercise\"=&gt;{\"name\"=&gt;\"dddd\",\n     \"beschreibung\"=&gt;\"ddddd\",\n     \"resulttypes\"=&gt;[\"5\",\n     \"3\",\n     \"1\"],\n     \"active\"=&gt;\"1\"}}\n</code></pre>\n\n<p>This currently drives me crazy a little bit. I hope you know why this happens...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","concatenation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13177005,"title":"Rails and Postgreql Concatenate space","body":"<p>I have an search field for user with autocomplete, it was working but I migrated my database from mySQL to Postgresql but cannot get the concatenate working. When I type a first name or a last name is working but when my user are typing Firstname Lastname (with a space between them) it's not working anymore and cannot get it working or figure out what to do.</p>\n\n<p>That's my SQL command : </p>\n\n<pre><code> @users = User.find(:all,:conditions =&gt; ['(last_name LIKE ? OR first_name LIKE ? OR    (first_name || last_name) LIKE ? OR (last_name || first_name) LIKE ?) AND adult = ?', \"%#{params[:term]}%\", \"%#{params[:term]}%\", \"%#{params[:term]}%\", \"%#{params[:term]}%\", false])\n</code></pre>\n\n<p>My issue is here : (first_name || last_name) that will return correct value when the user type FirstNameLastName so the concat works here but when I try to add the space I cannot figure out what is wrong I tried :</p>\n\n<pre><code>(first_name ||' '|| last_name) or (first_name ||\" \"|| last_name)\n</code></pre>\n\n<p>But none of these will work I found another thread on stackoverflow but cannot get it working and I don't understand why...</p>\n\n<p>Thanks,</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","comments","posts"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":777,"score":0,"question_id":7000689,"title":"undefined method `comments' for nil:NilClass","body":"<p>I'm trying to create a way to have users comment on my posts. Currently I have All user posts showing up on my home page and then in the user profile only the current users posts. I would like to have it so that the comments appear only on the posts in the users profile. I tried to add a comment form in the user profile but I got an undefined method `comments' for nil:NilClass error. </p>\n\n<p>My comments_controller looks like </p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def create\n    @post = Post.find(params[:post])\n    @comment = @post.comments.create(params[:comment])\n    redirect_to post_path(@post)\nend\n</code></pre>\n\n<p>I have a partial (_comment_form.html.erb) that I am rendering in the user profile which looks like </p>\n\n<pre><code>&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for ([@post, @post.comments.build]) do |f| %&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :commenter %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :commenter %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :body %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :body %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n   &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My Comment model looks like </p>\n\n<pre><code>class Comment &lt; ActiveRecord::Base\n  belongs_to :post\nend\n</code></pre>\n\n<p>My Post model looks like</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n attr_accessible :content\n\n belongs_to :user\n\n validates :content, :presence =&gt; true\n validates :user_id, :presence =&gt; true\n validates :user, :presence =&gt; true\n validates :title, :presence =&gt; true\n\n has_many :comments\n\n default_scope :order =&gt; 'posts.created_at DESC'\nend\n</code></pre>\n\n<p>My User Profile Looks like show.html.erb</p>\n\n<pre><code>&lt;table class=\"profile\" summary=\"Profile information\"&gt;\n  &lt;tr&gt;\n    &lt;td class=\"main\"&gt;\n    &lt;h1&gt;\n        &lt;%= gravatar_for @user %&gt;\n        &lt;%= @user.name %&gt;\n    &lt;/h1&gt;\n    &lt;% unless @user.posts.empty? %&gt;\n        &lt;table class=\"posts\" summary=\"User posts\"&gt;\n            &lt;%= render @posts %&gt;\n            &lt;%= render 'comments/comment_form' %&gt;\n        &lt;/table&gt;    \n    &lt;% end %&gt;\n    &lt;/td&gt;\n    &lt;td class=\"sidebar round\"&gt;\n  &lt;strong&gt;Name&lt;/strong&gt; &lt;%= @user.name %&gt;&lt;br /&gt;\n  &lt;strong&gt;URL&lt;/strong&gt;  &lt;%= link_to user_path(@user), @user %&gt;&lt;br /&gt;\n  &lt;strong&gt;Tasks&lt;/strong&gt; &lt;%= @user.posts.count %&gt;\n    &lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","relational-database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13176946,"title":"How can I generate this schema with Rails?","body":"<p>I have a schema for a relational database, which I'd like to generate scaffolding for in my Ruby on Rails 3.2.8 project. I've found the documentation pretty confusing though, and my efforts so far have failed, so my question is exactly how I'd go about generating the needed scaffolding/models for the following schema:</p>\n\n<pre><code>USER\nname:string\nemail:string\n-----\nhas_many: posts\n\nTAG\nname:string\n-----\nbelongs_to_and_has_many: series\nbelongs_to_and_has_many: posts\n\nPOST\ntitle:string\nbody:text\n-----\nbelongs_to_and_has_many: tags\nbelongs_to: user\nbelongs_to: category\n\nSERIES\nname:string\nwebsite:string\n-----\nbelongs_to_and_has_many: tags\n\nCATEGORY\nname:string\n-----\nhas_many: posts\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/H93Oz.png\" alt=\"Picture of schema\"></p>\n"},{"tags":["ruby-on-rails","rspec","devise","capybara"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13174592,"title":"Capybara, RSpec and Devise: any way to make integration tests faster by circumventing slow login and setting session directly?","body":"<p>For nearly every integration test, a user has to be signed into Devise. This takes a lot of time, so I wondered whether there's a way to set up the user session without having to visit the login page, enter details, and press the login button.</p>\n\n<p>Maybe there's a helper method built into Devise that immediately signs a given user in?</p>\n\n<p>Thanks a lot for help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13174787,"title":"need to add default value in f.select field to existing ones - rails 3.2","body":"<p>With the code I have below in the select field I have all the <code>public_campaigns</code>:</p>\n\n<pre><code>&lt;%= f.select :campaign_id, @public_campaigns.map{|x| [x.name,x.id]} %&gt;\n</code></pre>\n\n<p><code>public_campaigns</code> is defined in controller with:</p>\n\n<pre><code>@public_campaigns = @logged_in_user.campaigns.order('created_at desc')\n</code></pre>\n\n<p>In the form I select the <code>campaign</code> and fill up the rest of the form and at the submit action an invitation is created with <code>campaign_id</code> taken from the <code>campaign</code> I selected in the form, it can be anything from <code>1</code> to <code>n</code></p>\n\n<p>What I need now is to have a <code>default item</code> in select field that will have the value of <code>0</code> and named <code>\"No campaign\"</code>, it means I invite someone to a campaign that I have not created yet and in invitation the <code>campaign_id</code> field will be <code>0</code>.</p>\n\n<p>Thank you for your time.</p>\n"},{"tags":["ruby-on-rails","haml","helper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13172488,"title":"capture_haml in helper not displaying parameter values","body":"<p>I'm trying to use a helper in my rails view to draw some haml lines, the fact is that it is writing the html tags, but no content in them.</p>\n\n<p>Here's my helper:</p>\n\n<pre><code>def detail_line(model, column, value)\n  capture_haml do  \n    haml_tag :div, class: 'control-group' do\n      haml_tag :label, {class: 'control-label'},\"#{model.class.human_attribute_name column}\"\n      haml_tag :div, class: 'controls' do\n        haml_tag :div, {class: 'value'}, \"#{value}\"\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>And here's the way I'm using it:</p>\n\n<pre><code>= detail_line(@order, 'number', @order.number)\n</code></pre>\n\n<p>The output is the following:</p>\n\n<pre><code>&lt;div class=\"control-group\"&gt;\n  &lt;label class=\"control-label\"&gt;&lt;/label&gt;\n  &lt;div class=\"controls\"&gt;\n     &lt;div class=\"value\"&gt;&lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>What am I missing or doing wrong?\nThank you very much in advance!</p>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":21,"score":4,"question_id":13173819,"title":"Change redirect to sign_in in Devise. I.e after \"recover pass\" form","body":"<p>I need some advise with Devise :)) I have frontpage in my app, and i included a auth form in it. It works correct, but when system wants auth from me , it drops me in /users/sign_in. (i.e. after \"pass recover\"). What should i do to make my frontpage to be default page for sign_in ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-c-extension"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1062,"score":1,"question_id":11802918,"title":"error: failed to build gem native extension when installing rails on mac mountian lion os","body":"<p>I've recently updated to Mountain Lion and reinstalled Ruby, but when I try to run a test Rails app, I get an error message that says that \"Rails is not currently installed\" on my system. I do what it says, type sudo gem install rails and get:</p>\n\n<p>cleared faster_require caches due to new gem install...\nSuccessfully installed rails-3.2.7\n1 gem installed\nInstalling ri documentation for rails-3.2.7...\nInstalling RDoc documentation for rails-3.2.7...</p>\n\n<p>but when I check to see which rails version is install, here is what I get: </p>\n\n<p>Rails is not currently installed on this system. To get the latest version, simply type:</p>\n\n<pre><code>$ sudo gem install rails\n</code></pre>\n\n<p>You can then rerun your \"rails\" command.</p>\n\n<p>I've also tried gem install rails and get:\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.</p>\n\n<pre><code>    /Users/aileen/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb\n</code></pre>\n\n<p>creating Makefile</p>\n\n<p>make\ncompiling generator.c\nmake: /usr/bin/gcc-4.2: No such file or directory\nmake: <em>*</em> [generator.o] Error 1</p>\n\n<p>Gem files will remain installed in /Users/aileen/.rvm/gems/ruby-1.9.3-p194@rails327/gems/json-1.7.4 for inspection.\nResults logged to /Users/aileen/.rvm/gems/ruby-1.9.3-p194@rails327/gems/json-1.7.4/ext/json/ext/generator/gem_make.out</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","gem","client-side"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13175919,"title":"Rails on heroku: \"cannot load such file\"","body":"<p>I keep having this error when I run rails s. It initially started when i tried pushing my app to heroku:</p>\n\n<pre><code>/var/lib/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:\n  in `require': cannot load such file -- \n  client_side_validations/formtastic (LoadError)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13175295,"title":"heroku and builder gem","body":"<p>When I push my app to heroku (cedar stack), it trow this error:</p>\n\n<pre><code>Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment\n       Some gems seem to be missing from your vendor/cache directory.\n       Could not find builder-3.0.4 in any of the sources\n</code></pre>\n\n<p>I tried:</p>\n\n<ul>\n<li>rm -rf Gemfile.lock and bundle again</li>\n<li>gem 'builder', '3.0.4' in the gemfile</li>\n<li>Repository url in the gemfile</li>\n</ul>\n\n<p>Whats wrong?</p>\n"},{"tags":["css","ruby-on-rails","link-to"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13175523,"title":"rails view link_to","body":"<p>Thanks for your time!</p>\n\n<p>I had a code :</p>\n\n<pre><code>&lt;link href=\"/stylesheets/show.css\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\"&gt;\n\n&lt;div id=\"body-container\"&gt;\n        &lt;div id=\"left-column\"&gt;\n                &lt;ul id=\"report-list\"&gt;\n                        &lt;% for report in @reports %&gt;\n                            &lt;li&gt;&lt;%= link_to( report, {:controller =&gt; 'loadreport',\n                                                      :action =&gt; 'get_report_content',\n                                                      :test_name =&gt; report} )%&gt;&lt;/li&gt;\n                        &lt;% end %&gt;\n                &lt;/ul&gt;\n        &lt;/div&gt;\n        &lt;div id=\"right-column\"&gt;\n\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The <code>link_to</code> method will generate html tags like this :</p>\n\n<pre><code>&lt;a href=\"/loadreport/get_report_content?name=Test1\"&gt;Test1&lt;/a&gt;\n</code></pre>\n\n<p>I want to make some decoration on <code>tag a</code>. So in CSS file, I got this codes :</p>\n\n<pre><code>a:link { text-decoration: none;}\n\na:hover {text-decoration-color: #adff2f;}\n</code></pre>\n\n<p>It failed to add these decorations to <code>tag a</code>. I think it because <code>tag a</code> is generated by rails <code>link_to</code> method. We don't have <code>tag a</code> ahead of time. Am I right? Then how can I achieve this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","markitup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13174858,"title":"Why the content display code html without render it?","body":"<p>I have used <a href=\"http://markitup.jaysalvat.com/\" rel=\"nofollow\">MarkiItUp</a> to build a jquery editor. Now when user type content in textarea with html code, like this:  </p>\n\n<p><code>A new &lt;strong&gt;true&lt;/strong&gt; question</code></p>\n\n<p>When record was saved, it save <code>A new &lt;strong&gt;true&lt;/strong&gt; question</code>. And when it display on page, it also display like content was saved, is <code>A new &lt;strong&gt;true&lt;/strong&gt; question</code> . But i want the content display on web like this: </p>\n\n<p>A new <strong>true</strong> question  </p>\n\n<p>How can i do that?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.1","thinking-sphinx","update-attributes","delta"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":7609325,"title":"Thinking sphinx updates delta index even when no fields are updated","body":"<p>Even when no fields specified in update attributes actually changes , thinking sphinx sets delta = 1 which results in large number of unwanted queries being fired . can we do something to let sphinx know that there was no actual update. </p>\n"},{"tags":["javascript","html","ruby-on-rails","html5","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13172936,"title":"how can I display summary of a link when posted","body":"<p>I am building a micro blog app and I would like that once a link is posted in the text area and displayed on the show page, it will be converted into a brief summary with a title, image and brief description, just like it's done on Google+ and Facebook. </p>\n\n<p>Is there a javascript or a rails gem that can handle this?</p>\n\n<p>I am using bluecloth and markdown to handle the html attributes of the  links being posted through the textarea and I would like to know how to display the summary of the link or how to expand the links posted.</p>\n"},{"tags":["ruby-on-rails","amazon-ec2","capistrano"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13172823,"title":"Rails app deployed using Rubber gem - Errors out","body":"<p>I have a Rails app running on an instance on Amazon ec2. It is being served via a load balancer.</p>\n\n<p>It was working fine the first time I deployed my app to it. Today I ran 'cap deploy' again. Ever since, I've been getting 504 Gateway Timeout errors.</p>\n\n<p>I can ssh into the instance. I've verified that my deployments are replacing the code in the instance. I also ssh'd to the instance and connected to localhost:80 using telnet. It works, but when I type in 'GET / HTTP/1.1' it returns a 200 Error</p>\n\n<p>I tried to start off by accessing my production logs. But for some reason the production log file does not exist! I checked my config.log_level in production and set it to :debug, to no avail.</p>\n\n<p>I also tried accessing the instance IP address directly, instead of going via the load balancer and still got the same error - which probably means it's not the load balancer at fault.</p>\n\n<p>I have seen a related question here - <a href=\"http://stackoverflow.com/questions/9398738/keep-getting-504-gateway-time-out-after-deploying-on-ec2-using-rubber\">Keep getting 504 Gateway Time-out after deploying on ec2 using rubber</a></p>\n\n<p>However, I was not able to make sense of the answer and I'm not sure how outdated it is. If anyone could elaborate or provide an alternate solution or just tips on how to start troubleshooting this, I'd be thankful!</p>\n\n<p><strong>UPDATE</strong>: \nI did some debugging and explored the logs at /var/log/apache2\nThat helped me fix a couple of errors. I no longer see the 504 Gateway Timeout. Instead, I see the following error:</p>\n\n<pre><code>[ pid=32526 thr=140043323348800 file=ext/apache2/Hooks.cpp:862 time=2012-11-01 02:43:06.843 ]: Unexpected error in mod_passenger: Cannot spawn application '/mnt/tpot-production/releases/20121031194109': An error occured while spawning the application.\n  Backtrace:\n     in 'virtual Passenger::SessionPtr Passenger::ApplicationPool::Client::get(const Passenger::PoolOptions&amp;)' (Client.h:742)\n     in 'Passenger::SessionPtr Hooks::getSession(const Passenger::PoolOptions&amp;)' (Hooks.cpp:294)\n     in 'int Hooks::handleRequest(request_rec*)' (Hooks.cpp:563)\n\n[Thu Nov 01 02:47:41 2012] [notice] caught SIGTERM, shutting down\n</code></pre>\n\n<p><a href=\"https://gist.github.com/3992814\" rel=\"nofollow\">https://gist.github.com/3992814</a></p>\n"},{"tags":["ruby-on-rails","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13174016,"title":"time comparision in rails for postgresql","body":"<p>I have a column name 'late' with datatype 'time without time zone'. my requirement is to read all the rows which is late more than by 1 hours. I have to query through my rails application. In table column value is like '00:31:00' but in rails it is like \n'2000-01-01 00:31:00 UTC'. can anyone please tell me how to query directly or by using ActiveRecords. thnks</p>\n"},{"tags":["ruby-on-rails","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13174272,"title":"How to add OmniAuth to an existing authorization system?","body":"<p>I just finished the <code>sample_app</code> of the <a href=\"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book\" rel=\"nofollow\">Ruby on Rails Tutorial</a>.\nI want now to add OmniAuth (Facebook).\nI'm following the <a href=\"https://github.com/intridea/omniauth\" rel=\"nofollow\">OmniAuth</a> docs, and this <a href=\"http://railscasts.com/episodes/241-simple-omniauth\" rel=\"nofollow\">Railscast</a> tutorial. I can already fetch my info from Facebook by going to:</p>\n\n<pre><code>localhost:3000/auth/facebook\n</code></pre>\n\n<p>Now I'm stuck in this part:</p>\n\n<p><strong>Docs:</strong></p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  def create\n    @user = User.find_or_create_from_auth_hash(auth_hash)\n    self.current_user = @user\n    redirect_to '/'\n  end\n\n  protected\n\n  def auth_hash\n    request.env['omniauth.auth']\n  end\nend\n</code></pre>\n\n<p><strong>Railscast:</strong></p>\n\n<pre><code>def create\n  auth = request.env[\"omniauth.auth\"]\n  user = User.find_by_provider_and_uid(auth[\"provider\"], auth[\"uid\"]) || User.create_with_omniauth(auth)\n  session[:user_id] = user.id\n  redirect_to root_url, :notice =&gt; \"Signed in!\"\nend\n</code></pre>\n\n<p>(Not sure which one to use)</p>\n\n<p>Because the Sessions controller on 'sample_app' looks like this:</p>\n\n<p><strong>sessions_controller.rb:</strong></p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n def create\n    user = User.find_by_email(params[:session][:email].downcase)\n    if user &amp;&amp; user.authenticate(params[:session][:password])\n      sign_in user\n      redirect_back_or user\n    else\n      flash.now[:error] = 'Invalid email/password combination'\n      render 'new'\n    end\n  end\n</code></pre>\n\n<p><strong>routes.rb:</strong></p>\n\n<pre><code>  match '/signup',                  to: 'users#new'\n  match '/signin',                  to: 'sessions#new'\n  match '/signout',                 to: 'sessions#destroy', via: :delete\n  match '/auth/:provider/callback', to: 'sessions#create'\n  match '/auth/failure',            to: 'sessions#failure'\n</code></pre>\n\n<p>So, I'm puzzled. What should I do so that users and sign up with both Facebook and the custom authorization system?</p>\n"},{"tags":["ruby-on-rails","ruby","validation","nested"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13174435,"title":"Rails nested with_option :if used in validation","body":"<pre><code>validate :updatable?  # First validation there is\nwith_options :if =&gt; Proc.new { |object| object.errors.empty? } do |updatable|\n    updatable.with_options :if =&gt; \"self.current_step == basic\" do |step|\n        validates .... bla-bla bla\n</code></pre>\n\n<p>So, before any validations are made, the <em>updatable</em> subroutine is called and it populates the <code>errors[:base]</code> array with appropriate errors, meaning that object is not updatable. And I wanted it to skip the rest of the validations if any errors are found in this subroutine, but abovementioned example is <strong>NOT</strong> working - it performs all the validations.</p>\n\n<p>But, if I change <code>:if =&gt; \"self.current_step == basic\"</code> to <code>:if =&gt; \"self.errors.empty? &amp;&amp; self.current_step == basic\"</code> is works like a charm. </p>\n\n<p>What I'm doing wrong ? Examples show, that nested <code>with_option</code> should work. </p>\n\n<p>Can someone help me ? Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","json","routes","jbuilder"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12858404,"title":"Rails - blank json file when using jbuilder","body":"<p>I'm trying to use jbuilder to create a json file from a list of events. It has to be in a specific format. Currently, no matter what I put in the jbuilder file, when you go to users/1/events.json, the file is blank (just {}).</p>\n\n<p>I've tried putting a respond to block in the controller, but then that just returns the list of events in the wrong format. </p>\n\n<p>I think that the routes have been done properly, because the log file says that the file myevents.json.jbuilder was rendered successfully when the url /users/1/myevents.json was requested. Plus, when the .html is requested, the myevents.html file shows up fine, with all the correct info in it.</p>\n\n<p>I'm really stumped on this one, any help would be much appreciated!!</p>\n\n<p>I'll list all relevant code in case anyone can pick something up:</p>\n\n<p>events controller:</p>\n\n<pre><code>def myevents\n    @events = current_user.events\nend\n</code></pre>\n\n<p>myevents.json.jbuilder:</p>\n\n<pre><code>Jbuilder.encode do |json|\n    json.timeline do\n        json.headline current_user.first_name\n        json.type \"default\"\n        json.text \"A Timeline\"\n        json.start_date\n        json.array!(@events) do |event|\n            json.start_date event.start_date\n            json.end_date event.end_date\n            json.headline event.headline\n            json.text event.text\n            json.asset do\n                json.media event.media\n                json.credit event.credit\n                json.caption event.caption\n            end\n        end\n    end\nend\n</code></pre>\n\n<p>environment.rb:</p>\n\n<pre><code>Jbuilder.key_format :camelize =&gt; :lower\n</code></pre>\n\n<p>routes.rb:</p>\n\n<pre><code>match 'users/:id/events' =&gt; 'events#myevents'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ckeditor","asset-pipeline","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13162384,"title":"CKeditor failing in Active Admin in production","body":"<p>I have installed the ckeditor gem, and have <a href=\"https://github.com/gregbell/active_admin/wiki/Ckeditor-integration\" rel=\"nofollow\">followed these instructions</a> to get it integrating with Active Admin in Rails 3.2.3</p>\n\n<p>Works a charm in development, but in production it fails. It seems to stutter when trying to load the config.js. </p>\n\n<p>In development, it loads fine annd has the path <code>/assets/ckeditor/config.js?t=C3HA5RM</code>\nIn production it tried and fails to load the path <code>/admin/pages/3/config.js?t=C3HA5RM</code> (page ID is arbitrary)</p>\n\n<p>The site is deployed using Capistrano, and so it theoretically exactly the same in development as it is in production. </p>\n\n<p>How could these paths be incorrect, how might I change them? Could it have something to do with the asset pipeline perhaps? </p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13161488,"title":"Is it okay to override a conflict generated during `rails new first_app`?","body":"<p><code>$ cd rails_projects</code>\n<code>$ rails new first_app</code></p>\n\n<p>I got this conflict at the bottom of the output below: <code>conflict  config/initializers/secret_token.rb</code></p>\n\n<pre><code>       exist  \n   identical  README.rdoc\n   identical  Rakefile\n   identical  config.ru\n   identical  .gitignore\n   identical  Gemfile\n       exist  app\n   identical  app/assets/images/rails.png\n   identical  app/assets/javascripts/application.js\n   identical  app/assets/stylesheets/application.css\n   identical  app/controllers/application_controller.rb\n   identical  app/helpers/application_helper.rb\n       exist  app/mailers\n       exist  app/models\n   identical  app/views/layouts/application.html.erb\n   identical  app/mailers/.gitkeep\n   identical  app/models/.gitkeep\n       exist  config\n   identical  config/routes.rb\n   identical  config/application.rb\n   identical  config/environment.rb\n       exist  config/environments\n   identical  config/environments/development.rb\n   identical  config/environments/production.rb\n   identical  config/environments/test.rb\n       exist  config/initializers\n   identical  config/initializers/backtrace_silencers.rb\n   identical  config/initializers/inflections.rb\n   identical  config/initializers/mime_types.rb\n    conflict  config/initializers/secret_token.rb\nOverwrite /Users/XXXXXX/rails_projects/first_app/config/initializers/secret_token.rb? (enter \"h\" for help) [Ynaqdh] \n</code></pre>\n\n<p>What does  <code>config/initializers/secret_token.rb</code> do? I ran this before and overrode the code and got the bundle to install, but wanted to know if there are unintended consequences.  Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","truncate","rails-console"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13173618,"title":"Truncate table(s) with rails console","body":"<p>I have this testingdatabase which, by now, is stuffed with junk. Now I've done a few Table.destroy_all commands in the rails console which deletes all records and dependencies which is awesome. However; I'd like to truncate everything so the ID's etc. start at 1 again. Is there any way in Rails 3?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13173940,"title":"Adding child to parent in rails","body":"<p>I have a user model and would like to add children to parents through a form when the parent is edited, I am using the Ancestry gem to create a hierarchy (previously asked a similar question <a href=\"http://stackoverflow.com/questions/13142785/form-for-adding-children-using-ancestry-gem\">here</a> but was maybe a bit unclear). I have tried to use virtual attributes to do give the child-to-be-added an attribute, in the user model I have added an new_child to attr_accessor. Now that the parent user is updated I would like to update the child user (adding the parent). I have tried this in the controller but get an undefined method `update_attributes!' for nil:NilClass error, any suggestions for how solve this problem?</p>\n\n<p>user_controller.rb</p>\n\n<pre><code>def update\n   User.find_by_id(@new_child).update_attributes!(parent_id: @user)\n   ...\nend\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>attr_accessible :new_child\nattr_accessor :new_child\n</code></pre>\n\n<p>edit.html.erb</p>\n\n<pre><code>&lt;%= form_for @user do |f| %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.label :new_child, \"Add child (enter child id)\" %&gt;\n  &lt;%= f.text_field :new_child %&gt;\n  &lt;%= f.submit \"Update\", class: \"btn\" %&gt;            \n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":232,"score":0,"question_id":4017492,"title":"What's the Rails Way to get the Model Class from the Controller?","body":"<p>I can do this in the controller to get the model class:</p>\n\n<pre><code>self.class.name.gsub(\"Controller\", \"\").singularize.constantize\n</code></pre>\n\n<p>But is there a built in method for this in the controller?</p>\n\n<p>Something like <code>self.model_class</code>?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","guard","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13170077,"title":"Why is guard stopping?","body":"<p>I have a rails application that I just threw guard and minitest and my gaurd file is </p>\n\n<pre><code>guard 'minitest', :cli =&gt; '--drb --format doc --color' do\n  # with Minitest::Unit\n  watch(%r|^test/(.*)\\/?test_(.*)\\.rb|)\n  watch(%r|^lib/(.*)([^/]+)\\.rb|)     { |m| \"test/#{m[1]}test_#{m[2]}.rb\" }\n  watch(%r|^test/test_helper\\.rb|)    { \"test\" }\n\n  # Rails\n  watch(%r|^app/controllers/(.*)\\.rb|) { |m| \"test/functional/#{m[1]}_test.rb\" }\n  watch(%r|^app/helpers/(.*)\\.rb|)     { |m| \"test/helpers/#{m[1]}_test.rb\" }\n  watch(%r|^app/models/(.*)\\.rb|)      { |m| \"test/unit/#{m[1]}_test.rb\" }  \nend\n</code></pre>\n\n<p>but when i run guard i get a command prompt</p>\n\n<pre><code>bundle exec guard\n22:14:12 - INFO - Guard uses TerminalTitle to send notifications.\n22:14:12 - INFO - Guard is now watching at '/Users/trace/Sites/application'\n1.9.3 (main):0 &gt; 2 + 2\n=&gt; 4\n</code></pre>\n\n<p>Why am i getting this prompt. Any ideas... here are some of the gems i am using</p>\n\n<p><strong>UPDATE...</strong></p>\n\n<p>when i run <code>all minitest</code> then the tests run...but why do i have to run that...any ideas</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","paperclip"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":225,"score":1,"question_id":10580137,"title":"How to use paperclip to upload files other than images ...like pdf,docs","body":"<p>I am using paperclip to upload resume in my applyforjobs.Its working fine,i mean i can get browse button to upload files.But when i show the view page its not showing the pdf file that i upload,instead its showing just the name of the file. I also checked that folder which gets generated by default and that folder contains the pdfs which i uploaded during create aaction,which means upload thing is working fine.but i am not able to show that pdf.</p>\n\n<hr>\n\n<p>Following is the code in my applyforjob.rb model for paperclip attachment :</p>\n\n<pre><code>has_attached_file :resume,:styles =&gt; { :small =&gt; \"150x150&gt;\" }\n</code></pre>\n\n<p>Following is the code of applyforjobs/form.html.haml for uploading file :</p>\n\n<pre><code>= f.label :resume, \"Upload resume\".html_safe\n= f.file_field :resume\n</code></pre>\n\n<p>Following is the code of applyforjobs/show.html.haml for showing file :</p>\n\n<pre><code>= image_tag @appliedusers.resume.url(:small)\n</code></pre>\n\n<p>but its not showing that pdf file.What am i supposed to write to upload and show files like pdf or docs?</p>\n"},{"tags":["ruby-on-rails","internationalization","rails-i18n"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":349,"score":4,"question_id":6683366,"title":"i18n for select boxes","body":"<p>I have a model named Role. And i am using the helper below in a form. Is there a way to change the value of name attribute to another language? </p>\n\n<pre><code>&lt;%= f.collection_select :role_id, Role.all, :id, name, {} -%&gt;\n</code></pre>\n\n<p>locales/de.yml</p>\n\n<pre><code>de:\n  role:\n   admin: \"something\"\n   editor: \"something something\"\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13168862,"title":"How to fixture data for tests that are not in DB","body":"<p>Let say I want to test my controller behavior, but it accepts JSON string via GET.</p>\n\n<p>Right now I have var in my test class @testJson, but from time to time some unexpected stuff happens to those JSONS (bad char inside i.e.). So I want to add another test case.</p>\n\n<p>But adding another var @problematicJson1 (and there could be more probably) doesn't seems like a good idea.</p>\n\n<p>What's is the best way to keep \"fixtures\" like that? Should I keep'em in files and load them? Is there some fixture feature i don't know about that could help?</p>\n"},{"tags":["ruby-on-rails","couchdb","couchrest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13170247,"title":"Update an array of object using CouchRest, Rails","body":"<p>Im trying to update a parameter in a collection of objects using Rails, CouchRest.</p>\n\n<p>This is what im doing currently,</p>\n\n<pre><code>class User\n   property :country\n   property :some_flag\nend\n\n@users = User.by_country(:key =&gt; 'country-name')\n@users.each do |user|\n  user.update_attributes({:some_flag =&gt; 'true'})\nend\n</code></pre>\n\n<p>Whenever update_attributes failed for a User object i want the entire transaction to be rolled back. How can i achieve this?</p>\n\n<p>Am Using CouchDB. Rails, CouchRest and <strong>Not</strong> using ActiveRecord.</p>\n"},{"tags":["ruby-on-rails","usps"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13173091,"title":"Usps not giving shipping service in track response","body":"<p>I am using following track request</p>\n\n<pre><code>http://production.shippingapis.com/ShippingAPITest.dll?API=TrackV2\n&amp;XML=&lt;TrackRequest USERID=\"xxxxxxxx\"&gt;\n&lt;TrackID ID=\"EJ958088694US\"&gt;&lt;/TrackID&gt;&lt;/TrackRequest&gt;\n</code></pre>\n\n<p>where i am giving Tracking number of shipment and getting the track response.\nBut i am not getting the service type in the response.</p>\n\n<p>Example:- For Tracking number <code>\"9400110200830528706282\"</code> not getting service \"First Class Mail\" in xml response.</p>\n\n<p>Usps site is showing \"First Class Mail\" as a service for the mentioned tracking number.</p>\n\n<p>Please suggest the track request for getting the shipping method.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":32,"score":-3,"question_id":13161504,"title":"undefined method issue","body":"<pre><code>    Exception NoMethodError -&gt; undefined method `[]' for nil:NilClass\n   lib/push/push_notification.rb:13:in `block in process'\n   lib/push/push_notification.rb:12:in `each'\n   lib/push/push_notification.rb:12:in `process'\n</code></pre>\n\n<p>put_notification:</p>\n\n<pre><code>#require 'enumerator'\n\nclass PushNotification\n\n  attr_reader :ios_notifications\n\n  def initialize\n    @ios_notifications = []\n  end\n\n  def process(device_options = [])\n    device_options.each do |device_option|\n      content_id = device_option[\"options\"][\"other\"][\"content_id\"] if device_option[\"options\"][\"other\"] &amp;&amp; device_option[\"options\"][\"other\"][\"content_id\"]\n\n      case device_option[\"platform\"]\n        when DeviceProfile::Platform::ANDROID\n          device = Gcm::Device.find_or_create_by_registration_id(device_option[\"push_id\"])\n\n          device_profile = DeviceProfile.find_by_android_push_id(device_option[\"push_id\"]) || DeviceProfile.new()\n\n          notification = Gcm::Notification.new\n          notification.device = device\n          notification.collapse_key = \"updates_available\"\n          notification.delay_while_idle = true\n          notification.data = {:registration_ids =&gt; [device.registration_id], :data =&gt; {:message =&gt; device_option[\"options\"][\"alert\"]}}\n          notification.data[:data][:content_id] = content_id if content_id\n          notification.save\n\n          Statistics::Alerts.create(push_notifications: 1, platform: \"android\", message:device_option[\"options\"][\"alert\"], content_id: content_id, udid: device_profile.udid )\n\n        when DeviceProfile::Platform::IOS\n          @ios_notifications &lt;&lt; APNS::Notification.new(device_option[\"push_id\"], device_option[\"options\"].symbolize_keys!)\n\n          device_profile = DeviceProfile.find_by_iphone_push_id(device_option[\"push_id\"]) || DeviceProfile.new()\n\n          Statistics::Alerts.create(push_notifications: 1, platform: \"ios\", message:device_option[\"options\"][\"alert\"], content_id: content_id, udid: device_profile.udid )\n      end\n    end\n\n    @ios_notifications.each_slice(100) do |group|\n      APNS.send_notifications(group)\n    end if !@ios_notifications.empty?\n\n    Gcm::Notification.where(sent_at: nil).joins(:device).readonly(false).find_in_batches(batch_size: 100) do |batch|\n      Gcm::Notification.send_notifications(batch)\n    end\n\n  end\n\n\nend\n</code></pre>\n\n<p>Here where params come from</p>\n\n<pre><code>def send_push_notifications\n    device_profiles = DeviceProfile.all\n    device_options = device_profiles.map { |dp| a = { :platform =&gt; dp.platform,\n      :options =&gt; { :alert =&gt; 'New Offer Available', :sound =&gt; \"default\",\n        :other =&gt; { :content_id =&gt; Content.last } } } \n\n    if dp.platform == DeviceProfile::Platform::IOS\n        a[:push_id] = dp.iphone_push_id\n    elsif dp.platform == DeviceProfile::Platform::ANDROID\n        a[:push_id] = dp.android_pish_id\n    end\n    }\n    puts device_options\n    Stalker.enqueue('dm.push', device_options)\n</code></pre>\n\n<p>Whats wronw with code?</p>\n"},{"tags":["ruby-on-rails","shell","path","capistrano","deployment"],"answer_count":7,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":3820,"score":5,"question_id":279705,"title":"Using capistrano when remote git is on a non-standard path","body":"<p>My shared host did not provide git, so I built and installed it into ~/bin.\nWhen I ran it, I got the following error on most commands, although they were successful.  </p>\n\n<blockquote>\n  <p><code>stdin: is not a tty</code></p>\n</blockquote>\n\n<p>I can solve that problem by adding:  </p>\n\n<blockquote>\n  <p><code>default_run_options[:pty] = true</code></p>\n</blockquote>\n\n<p>to my deploy.rb, but then I get this error, which blocks deployment:</p>\n\n<blockquote>\n  <p><code>sh: git: command not found</code></p>\n</blockquote>\n\n<p>How can I resolve both errors?</p>\n\n<p>I tried adding a ~/.ssh/environment file with \"PATH=$PATH:$HOME/bin\" (and changing sshd_config to use it) but it did nothing.</p>\n\n<p>It seems whatever shell is being used by capistrano is not using the ~/.bashrc or ~/.bash_profile on the remote server.</p>\n\n<p>Any ideas how to set the path on the remote machine?</p>\n\n<p>other info: I'm using OS X locally, and the shared server is linux on Site5.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13168912,"title":"How to redirect non existing routes in rails","body":"<p>I have switched from an old site with a good page rank to RubyOnRails. </p>\n\n<p>Of course all links are broken now. When a user visits my site via a google link he will get:</p>\n\n<pre><code>Routing Error\n\nNo route matches [GET] \"/SOME_WRONG/URL/WITH/PARAMETERS\"\n</code></pre>\n\n<p>What is the best way to redirect the user on error like that to my root_url?</p>\n\n<p>And where I have to put this code?</p>\n\n<pre><code>.htaccess?\napplication_controller?\napplication.rb?\nroutes.rb?\n</code></pre>\n\n<p>many many thanks in advance :-)</p>\n"},{"tags":["ruby-on-rails","ruby","pdf","itext","rjb"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":291,"score":0,"question_id":8734667,"title":"Ruby on Rails PDF Stamper / iText","body":"<p>I have done a lot of searching and cannot find a solution for getting PDF-stamper to work in my rails application. From the tutorials it appears that I write a method in the model? I wrote a simple app with two fields: nameLast and nameFirst. All I want to do is write these to a PDF I have that contains fields for user info. Two field happen to be FirstName and LastName so perfect time to use PDF-stamper right? I just want to take user data from the rails application and have then be able to push a button and generate a PDF. Here is the method I have in my model.</p>\n\n<pre><code>  def savePDF\n    pdf = PDF::Stamper.new(\"sample.pdf\") \n          pdf.text :nameFirst, \"Jason\"\n               pdf.text :nameLast, \"Yates\" \n               pdf.save_as \"my_output.pdf\"\n  end\n</code></pre>\n\n<p>That was clearly taken from a tutorial that I must not properly understand. I can actually get this working in java pretty easy, but I don't want to use jRuby. I am using rjb which is working fine. I just don't think I properly understand what needs to happen to get this working. Any help is greatly appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","rubygems","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":12966564,"title":"Can't make calls to heroku CLI from within a Rake task without the Heroku gem in the Gemfile","body":"<p>I've had an app running on Heroku for a while now and on a recent deployment saw the message that the Heroku gem was deprecated in favor of the Heroku Toolbelt.  With the toolbelt, all of my Heroku commands work fine from the command line but within a Rake task (which I have setup for deployments) I get the following errors:</p>\n\n<pre><code>$ rake deploy:staging\nEverything up-to-date\n\n/Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/gems/bundler-1.2.0/lib/bundler/rubygems_integration.rb:147:in `block in replace_gem': heroku is not part of the bundle. Add it to Gemfile. (Gem::LoadError)\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/heroku:18:in `&lt;main&gt;'\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/ruby_noexec_wrapper:14:in `eval'\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\n\n/Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/gems/bundler-1.2.0/lib/bundler/rubygems_integration.rb:147:in `block in replace_gem': heroku is not part of the bundle. Add it to Gemfile. (Gem::LoadError)\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/heroku:18:in `&lt;main&gt;'\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/ruby_noexec_wrapper:14:in `eval'\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\n</code></pre>\n\n<p>The errors being shown are from this deployment rake task:</p>\n\n<pre><code>namespace :deploy do\n\n  desc \"deploys to Production after uploading assets to S3\"\n  task :production do\n    puts `git push heroku master`\n    puts `heroku run rake db:migrate --app myapp`\n    puts `heroku restart --app myapp`\n  end\n\n  desc \"deploys to Staging after uploading assets to S3\"\n  task :staging do\n    puts `git push staging staging:master`\n    puts `heroku run rake db:migrate --app myapp-staging`\n    puts `heroku restart --app myapp-staging`\n  end\nend\n</code></pre>\n\n<p>The two heroku commands in each task are where the problem comes from.  If I execute them from the command line, they work just fine though.  I doubt it matters but I'm running OSX with RVM as well.</p>\n\n<p>Any idea how to fix this? I realize it's not a huge deal since I can just run those additional command manually or alias them, but I'd just like to know why there's a problem in the first place.</p>\n"},{"tags":["ruby-on-rails","multithreading"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13121404,"title":"Mutlithreading in Ruby on Rails","body":"<p>in my controller I have a series of nested loops</p>\n\n<pre><code>x.downto(0)\n   y.downto(0)\n      z.downto(0)\n</code></pre>\n\n<p>I would like to ask whether I can split these up in multiple threads kind like</p>\n\n<pre><code>#pragma omp parallel for\n</code></pre>\n\n<p>does in C.</p>\n\n<p>I have tried to use the</p>\n\n<pre><code>Thread.new do\n</code></pre>\n\n<p>method but it does not seem to have any effect.</p>\n\n<p>Thanx in advance.</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","api","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13172125,"title":"How can i allow iphone app to login using facebook using devise?","body":"<p>I want users to login with their facebook account through devise from iphone app. </p>\n\n<p>consider when i send the id and password as</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'asdfghjkl'}}\"\n</code></pre>\n\n<p>then it produces</p>\n\n<pre><code>{\"user\":{\"authentication_token\":\"34734t374hfjeg266272\",\"email\":\"sample@gmail.com\"}}\n</code></pre>\n\n<p>I use the authentication token for the next request as</p>\n\n<pre><code>curl -L 'localhost:3000/posts.json?auth_token=34734t374hfjeg266272'\n</code></pre>\n\n<p>and i get the values from the table as json and similarly how can i do it with facebook account in devise?</p>\n\n<p>I have omniauth used in my web app and i could login as facebook user from my web app but how could i do it for iphone app?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13123453,"title":"Javascript not picking up attribute value","body":"<p>Thanks to help here, I got a sample piece of code working When I tried to apply it to the real thing, something is not working quite.</p>\n\n<p>In my view (new.html.erb), I have the following:</p>\n\n<pre><code>&lt;%= f.hidden_field :addtl_attendee_payment, :value =&gt; Addtl_attendee_charge %&gt;\n</code></pre>\n\n<p>(Addtl_attendee_charge comes from a config file)</p>\n\n<p>and in my javascript file, I have the following:</p>\n\n<pre><code>function display_value() {\n    var a = $(\"#addtl_attendee_payment\");\n    alert(a.val());\n}\n</code></pre>\n\n<p>and in another spot in my new.html.erb, I have the following:</p>\n\n<pre><code>&lt;script&gt;&lt;%= \"display_value()\" %&gt;&lt;/script&gt;\n</code></pre>\n\n<p>When I run this, I get \"undefined\" inside the alert box. If I look at the HTML (using firefly), here's what I get:</p>\n\n<pre><code>&lt;input id=\"payment_addtl_attendee_payment\" type=\"hidden\" value=\"500\" name=\"payment[addtl_attendee_payment]\"&gt;\n</code></pre>\n\n<p>Payment is the model name. This is the same type of code that worked for the test code. Any ideas?</p>\n\n<h1>Note:</h1>\n\n<p>Note again that the model name is Payment, and although I did not add payment to the attribute name, Rails added it automatically. I did try another variation on the javascript file:</p>\n\n<pre><code>function display_value() {\n    var a = $(\"#payment_addtl_attendee_payment\");\n    alert(a.val());\n}\n</code></pre>\n\n<p>But that did not work either (getting the same message). I think that adding the payment_ is normal and is done by Rails (but I could be wrong, being a newbie)</p>\n"},{"tags":["java","ruby-on-rails","jruby","warbler"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13170317,"title":"Running Rake Tasks In WAS without JRuby","body":"<p>Related to : <a href=\"http://stackoverflow.com/questions/6210222/executing-rake-tasks-on-an-exploded-war-on-tomcat-without-jruby-being-installed\">Executing rake tasks on an exploded war on tomcat without jruby being installed</a></p>\n\n<p>I'm trying to run rake tasks in my Tomcat server that doesn't have JRuby installed.  I'm using warbler to create a war file.</p>\n\n<p>Using the answer to the linked question, I ran:</p>\n\n<pre><code>java -cp lib/jruby-core*.jar:lib/jruby-stdlib*.jar org.jruby.Main -S rake -T\n</code></pre>\n\n<p>This gets me the error:</p>\n\n<pre><code>Exception in thread \"main\" java.lang.NoClassDefFoundError: org/jruby/Main\nCaused by: java.lang.ClassNotFoundException: org.jruby.Main\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)\n</code></pre>\n\n<p><code>ls lib</code> gets me:</p>\n\n<pre><code>ems-gems-activerecord-jdbc-adapter-1.2.2-lib-arjdbc-jdbc-adapter_java.jar\ngems-gems-jdbc-sqlite3-3.7.2-lib-sqlite-jdbc-3.7.2.jar\ngems-gems-jruby-jars-1.6.8-lib-jruby-core-1.6.8.jar\ngems-gems-jruby-jars-1.6.8-lib-jruby-stdlib-1.6.8.jar\ngems-gems-jruby-rack-1.1.10-lib-jruby-rack-1.1.10.jar\ngems-gems-json-1.7.5-java-lib-json-ext-generator.jar\ngems-gems-json-1.7.5-java-lib-json-ext-parser.jar\ngems-gems-therubyrhino_jar-1.7.4-jar-rhino-1.7R4.jar\ngems-gems-warbler-1.3.6-lib-warbler_jar.jar\njruby-core-1.6.8.jar\njruby-rack-1.1.10.jar\njruby-stdlib-1.6.8.jar\nojdbc6.jar\n</code></pre>\n\n<p>Opening up the <code>jruby-core-1.6.8.jar</code> file, I can see that there is indeed a <code>org/jruby/Main.class</code> file.  </p>\n\n<p>As one can see from the file listing, there is no <code>jruby-complete</code> jar file, so I can't run the command from <a href=\"http://stackoverflow.com/a/9982556/684934\">http://stackoverflow.com/a/9982556/684934</a></p>\n\n<p>What am I doing wrong, and is there by now a better way to do this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13166373,"title":"Does using multiple databases in Rails 3 affect performance?","body":"<p>I'm currently with a client using a heroku database with a row limit and we have a big table that logs activities, so after trying some solutions I found out that I can use a different connection for a single model.</p>\n\n<p>Will it affect performance by a lot? I think I'm going to create a micro instance with postgres with just this table.</p>\n"},{"tags":["ruby-on-rails","ruby","datetime","activesupport"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":158,"score":7,"question_id":13129461,"title":"Ruby weirdness: x == y && [x, y].uniq == [x, y]","body":"<p>I have an two-element array of ActiveRecord objects, <code>slots_to_import</code>. These objects have <code>begin_at</code> columns, and thus attributes. I was trying to get objects that have unique <code>begin_at</code> values. Alas, <code>slots_to_import.uniq_by(&amp;:begin_at)</code> did not work. But the <code>begin_at</code> values are equal for the two objects:</p>\n\n<pre><code>(rdb:1) p slots_to_import.first.begin_at == slots_to_import.last.begin_at\ntrue\n(rdb:1) p slots_to_import.uniq_by(&amp;:begin_at).map(&amp;:begin_at)\n[Mon, 26 Nov 2012 19:00:00 UTC +00:00, Mon, 26 Nov 2012 19:00:00 UTC +00:00]\n(rdb:1) p [slots_to_import.first.begin_at, slots_to_import.last.begin_at].uniq\n[Mon, 26 Nov 2012 19:00:00 UTC +00:00, Mon, 26 Nov 2012 19:00:00 UTC +00:00]\n</code></pre>\n\n<p>Some more checking around:</p>\n\n<pre><code>(rdb:1) p [slots_to_import.first.begin_at.to_datetime, slots_to_import.last.begin_at.to_datetime].uniq\n[Mon, 26 Nov 2012 19:00:00 +0000]\n(rdb:1) p [slots_to_import.first.begin_at.usec, slots_to_import.last.begin_at.usec].uniq\n[0]\n(rdb:1) p [slots_to_import.first.begin_at.to_f, slots_to_import.last.begin_at.to_f].uniq\n[1353956400.0]\n(rdb:1) p [slots_to_import.first.begin_at.utc, slots_to_import.last.begin_at.utc].uniq\n[Mon, 26 Nov 2012 19:00:00 +0000]\n(rdb:1) p [slots_to_import.first.begin_at, slots_to_import.last.begin_at].uniq\n[Mon, 26 Nov 2012 19:00:00 UTC +00:00, Mon, 26 Nov 2012 19:00:00 UTC +00:00]\n</code></pre>\n\n<p>I thought perhaps that uniq was checking whether they were the same object (since they were not). But no, some noodling in my rails console showed me that it does not use an object id check:</p>\n\n<pre><code>1.8.7 :111 &gt; x = Time.zone.parse(\"Mon, 29 Oct 2012 19:29:17 UTC +00:00\")\n =&gt; Mon, 29 Oct 2012 19:29:17 UTC +00:00 \n1.8.7 :112 &gt; y = Time.zone.parse(\"Mon, 29 Oct 2012 19:29:17 UTC +00:00\")\n =&gt; Mon, 29 Oct 2012 19:29:17 UTC +00:00 \n1.8.7 :113 &gt; x == y\n =&gt; true \n1.8.7 :114 &gt; [x, y].uniq\n =&gt; [Mon, 29 Oct 2012 19:29:17 UTC +00:00] \n</code></pre>\n\n<p>I'm using Ruby 1.8.7p358 and ActiveSupport 3.2.0. BTW, I can solve my own issue by simply adding a <code>to_datetime</code>, but I'm really curious why this isn't working without a conversion.</p>\n"},{"tags":["ruby-on-rails","reporting","birt"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":430,"score":1,"question_id":2969611,"title":"BIRT Viewer with Rails App","body":"<p>Has anyone tried using BIRT for reporting on a Rails app.. I am working on a pretty big app on ROR. I was trying to get BIRT to work happily with the app. Since the BIRT Report Designer cannot be used with Rails, I decided to use BIRT Viewer alone and give the links to the reports on the page and have BIRT Viewer running on Tomcat on the same box to render the reports. This has a big problem of not being able to allow the user to create any custom reports. </p>\n\n<p>Has anybody tried anything even remotely close to this??? </p>\n\n<p>If yes do you have any tips for me on any part of this endeavor? </p>\n\n<p>Thanks in advance for all the help.</p>\n"},{"tags":["ruby-on-rails","java-ee","servlets","birt"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13171624,"title":"Including servlet/jsp of BIRT viewer in rails application","body":"<p>How do you add birt viewer into a rails application, upon clicking a link the birt viewer should be visible in the same page as on the rails application. How do you include a servlet response on to a rails application.Please do help</p>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13170907,"title":"Is there any way of using \"before_filter :authenticate_user!\" together with a boolean in the table?","body":"<p>I'm using <strong>Devise</strong>. I added a <code>admin</code> boolean column to my <code>users</code> table:</p>\n\n<pre><code>class AddAdminToUsers &lt; ActiveRecord::Migration\n  def self.up\n    add_column :users, :admin, :boolean, :default =&gt; false\n  end\n\n  def self.down\n    remove_column :users, :admin\n  end\nend\n</code></pre>\n\n<p>I want only allow admins to destroy users.\nDevise's <code>before_filter :authenticate_user!</code> works by only enabling signed in users to perform an action. Is there a way of adding something to <code>:authenticate_user</code> so that only users with <code>:admin =&gt; true</code> can perform an action (en.g. destroy action)?</p>\n"},{"tags":["ruby-on-rails","activity","social-networking"],"answer_count":11,"favorite_count":167,"up_vote_count":127,"down_vote_count":0,"view_count":19042,"score":127,"question_id":202198,"title":"What's the best manner of implementing a social activity stream?","body":"<p>I'm interested in hearing your opinions in which is the best way of implementing a social activity stream (Facebook is the most famous example). Problems/challenges involved are:</p>\n\n<ul>\n<li>Different types of activities (posting, commenting ..)</li>\n<li>Different types of objects (post, comment, photo ..)</li>\n<li>1-n users involved in different roles (\"User x replied to User y's comment on User's Z post\")</li>\n<li>Different views of the same activity item (\"you commented ..\" vs. \"your friend x commented\" vs. \"user x commented ..\" => 3 representations of a \"comment\" activity)</li>\n</ul>\n\n<p>.. and some more, especially if you take it to a high level of sophistication, as Facebook does, for example, combining several activity items into one (\"users x, y and z commented on that photo\"</p>\n\n<p>Any thoughts or pointers on patterns, papers, etc on the most flexible, efficient and powerful approaches to implementing such a system, data model, etc. would be appreciated.</p>\n\n<p>Although most of the issues are platform-agnostic, chances are I end up implementing such a system on Ruby on Rails</p>\n"},{"tags":["ruby-on-rails","ruby","timezone"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":185,"score":0,"question_id":11833435,"title":"Convert local time to UTC in Rails","body":"<p>In my MySQL database the updated_at field is being stored as UTC.  Last week a record was entered at 7pm EDT and it's updated_at value is \"2012-08-01 23:00:00\".  I'm trying to convert local time for a web client to UTC that can be compared against the updated_at field in the database.</p>\n\n<p>As an example, I'd like to convert '08/01/2012 07:00 pm' to '2012-08-01 23:00:00' (accounting for me being in EDT) but I'm missing the time zone aspect to the conversion.  '7:00 pm' is local time and could be from any time zone.  My current code:</p>\n\n<pre><code>ruby-1.9.2-head :015 &gt; from_date = DateTime.strptime('08/01/2012 07:00 pm', '%m/%d/%Y %H:%M %p')\n=&gt; Wed, 01 Aug 2012 19:00:00 +0000 \nruby-1.9.2-head :016 &gt; from_date = Time.zone.parse(from_date.to_s).utc\n=&gt; 2012-08-01 19:00:00 UTC\n</code></pre>\n\n<p>Any thoughts?</p>\n\n<p>Edit: Also, I could use \"%Z\" in my strptime call but that's assuming I have the timezone in the value, which I currently do not. I guess I could use Javascript to send that along with the date/time value.</p>\n"},{"tags":["ruby-on-rails","activerecord","arel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13170153,"title":"Get all records of a model where its association is not null and the association meets certain conditions","body":"<p>I am using Rails 3.1.0</p>\n\n<p>I have two models, A and B. \nA has_one B, but B can be null. \nB belongs_to A. \nB has a boolean field called \"visible.\"</p>\n\n<p>I want to get all A records that have a non-null B and a B with \"visible\" set to true.  </p>\n\n<p>What is a concise and efficient way of doing this query?</p>\n\n<p>What I've done so far:</p>\n\n<p>I created a scope that gets the A's with non-null B's (I think).</p>\n\n<p>scope :has_b, includes(:b).where(B.arel_table[:id].not_eq(nil))</p>\n\n<p>Is there a way to chain the visible == true condition to this scope?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":257,"score":0,"question_id":9674680,"title":"Rails PJAX not working","body":"<p>I have added the pjax javascript.</p>\n\n<p>In my view I have:</p>\n\n<pre><code>&lt;div data-pjax-container&gt;\n&lt;%= yield %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But still onclick the hole page updates. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13170314,"title":"Better Rails code for update or create clause?","body":"<p>The code smells and i'm sure i'm missing a helper to do a simple \nupdate or create query like the below snippet :</p>\n\n<pre><code>  @user_answer = current_user.user_answers.find_by_question_id(params[:a_question])\n  if @user_answer.nil?\n    @user_answer = current_user.user_answers.build({ :answer_id =&gt; params[:an_answer] , :question_id =&gt; params[:a_question] })      \n    @user_answer.save  \n  else\n    @user_answer.update_attributes(:answer_id =&gt; params[:an_answer])\n    @user_answer.save \n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","activerecord","time","timezone"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1192,"score":1,"question_id":319527,"title":"Ruby on Rails: Why do I get timezones munged when I write a time to the DB, then read it back?","body":"<p>I have config.time_zone in environment.rb set to \"UTC\", and my mySQL server returns the current time in my local time zone when I issue \"select now();\" and in utc when I ask for \"select utc_timestamp;\"</p>\n\n<p>I'm running rails 2.1.2, the mysql gem 2.7.3, activerecord gem 2.1.2, and mysql --version returns \"Ver 14.12 Distrib 5.0.27 for Win32 (ia32)\".  </p>\n\n<p>EDIT: My environment.rb is set to UTC and had been since I started the project.  A server restart would have picked up no changes.</p>\n\n<pre><code>record = Record.find(:first)\nputs Time.now\n# Tue Nov 25 17:40:48 -0800 2008\nrecord.time_column = Time.now\nrecord.save\n\nmysql&gt; select * from records;\n---------------------\n 2008-11-26 01:40:48\n\n#note that this is the same time, in UTC.\n\nrecord = Record.find(:first)\nputs record.time_column\nWed Nov 26 01:40:48 -0800 2008\n\n#NOTE that this is eight hours in advance!  \n#All I've done is store a date in the database and retrieve it again!\n</code></pre>\n\n<p>Any ideas what  causes this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller","timeout"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13170637,"title":"Rails setting timeout in controller","body":"<p>In my controller in Rails, I want to download a file into the <code>public</code> folder of the project (using the Linux system command <code>wget</code>). Then I'd like the file to stay there for an hour, before calling the command <code>rm</code> to delete it. Can I set a timeout so that the code execution pauses at some point before resuming later?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":125,"score":4,"question_id":11108942,"title":"Invalid Encoding Symbol with Classifier gem","body":"<p>Everything seemed to be working fine as I added items to my Postgres database. Without changing anything, my Rails app started failing whenever it started Madeleine anywhere in my app:</p>\n\n<pre><code>EncodingError in EventsController#update\n  invalid encoding symbol\n  app/controllers/events_controller.rb:137:in `update'\n</code></pre>\n\n<p>137 is the problem line:</p>\n\n<pre><code>135 def update\n136   @event = Event.find(params[:id])\n137   m = SnapshotMadeleine.new(\"bayes_data\")\n      ....\n    end\n</code></pre>\n\n<p>I'm able to classify things in the console, though, which is part of what's causing me confusion. In the console, this works fine:</p>\n\n<pre><code>m = SnapshotMadeleine.new(\"bayes_data\") {}\n   =&gt; #&lt;Madeleine::DefaultSnapshotMadeleine:0x000...\nm.system\n   =&gt; #&lt;Classifier::Bayes:0x000...\nm.system.classify \"test\"\n</code></pre>\n\n<p>I'm using the latest Classifier gem with Madeleine.</p>\n\n<p>I figured that something was corrupted in my snapshot that it attempted to load, so I removed it, but that didn't solve the problem. Here's my second-to-last snapshot (now the most recent one):</p>\n\n<pre><code>a = File.read('bayes_data/000000000000000000041.snapshot')\na.encoding\n   =&gt; #&lt;Encoding:UTF-8&gt;\na.valid_encoding?\n   =&gt; true\n</code></pre>\n\n<p>Not sure what's going on here. I saw some people with Ruby 1.9.3-p125 had similar problems, so I upgraded to the latest stable release, 1.9.3-p194, but that didn't help, either.</p>\n\n<p>Here's a link to the documentation for Classifier, which mentions how to use Madeleine as well: <a href=\"http://classifier.rubyforge.org/\" rel=\"nofollow\">http://classifier.rubyforge.org/</a></p>\n\n<p>I'd really appreciate any insight into what's going on here. Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","sqlite3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13170156,"title":"sqlite3_native.so: [BUG] Segmentation fault","body":"<p>I'm running into this sqlite3 issue and can't figure out why ; I browsed this forum for many hours and could not find a similar issue reported.\nI'm using ruby 1.9.3, but the error message seems to invoke ruby 1.8.7 ; I even uninstalled ruby 1.8.7 then sqlite3 and then reinstalled it but that did not solve the issue</p>\n\n<p>I'm running rails 3.2.8</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rails -v\nRails 3.2.8\n</code></pre>\n\n<p>and ruby 1.9.3</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# ruby -v\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\n</code></pre>\n\n<p>uninstalled ruby 1.8.7</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rvm uninstall 1.8.7\n/home3/user1/.rvm/src/ruby-1.8.7-p371 has already been removed.\n/home3/user1/.rvm/rubies/ruby-1.8.7-p371 has already been removed.\n</code></pre>\n\n<p>uninstalled sqlite3</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# gem uninstall sqlit3\nINFO:  gem \"sqlit3\" is not installed\nuser1@company.com [~/rails_apps/myapp]# gem uninstall sqlite3\n\nYou have requested to uninstall the gem:\n    sqlite3-1.3.6\ni18n-0.6.1 depends on [sqlite3 (&gt;= 0)]\nIf you remove this gems, one or more dependencies will not be met.\nContinue with Uninstall? [Yn]  Y\nSuccessfully uninstalled sqlite3-1.3.6\n</code></pre>\n\n<p>reinstalled sqlite3</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# gem install sqlite3 \nFetching: sqlite3-1.3.6.gem (100%)\nBuilding native extensions.  This could take a while...\nSuccessfully installed sqlite3-1.3.6\n1 gem installed\nInstalling ri documentation for sqlite3-1.3.6...\nunable to convert \"\\xC3\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for CHANGELOG.rdoc, skipping\nInstalling RDoc documentation for sqlite3-1.3.6...\nunable to convert \"\\xC3\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for CHANGELOG.rdoc, skipping\n</code></pre>\n\n<p>same error message again</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rails generate scaffold project customer:string \n/home3/user1/ruby/gems/gems/sqlite3-1.3.6/lib/sqlite3/sqlite3_native.so: [BUG] Segmentation fault\nruby 1.8.7 (2012-02-08 MBARI 8/0x6770 on patchlevel 358) [x86_64-linux], MBARI 0x6770, Ruby Enterprise Edition 2012.02\n\nAborted\nuser1@company.com [~/rails_apps/myapp]# \n</code></pre>\n\n<p>Anyone can please help?</p>\n"},{"tags":["ruby-on-rails","table"],"answer_count":6,"favorite_count":8,"up_vote_count":10,"down_vote_count":0,"view_count":7905,"score":10,"question_id":1921074,"title":"How to reset a single table in rails?","body":"<p>I want the primary key values to start from 1 again.</p>\n"},{"tags":["ruby-on-rails","rubygems"],"answer_count":2,"favorite_count":4,"up_vote_count":20,"down_vote_count":0,"view_count":2528,"score":20,"question_id":7510760,"title":"How do Formtastic and simple_form compare?","body":"<p>How do Formtastic and simple_form compare?\nWhat the benefits of each ?</p>\n"},{"tags":["ruby-on-rails","layout","pjax"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":147,"score":1,"question_id":11723714,"title":"pjax with rails","body":"<p>I am using rack-pjax gem as described in the railscasts  <a href=\"http://railscasts.com/episodes/294-playing-with-pjax?view=comments\" rel=\"nofollow\">playing with pjax</a></p>\n\n<p>But the issue i am having with my layout is, i have some dynamic generated links and page headings on top of the main 'yield' call in the application layout. Those links will be generated dynamically based the main yield. Though i am putting the dynamically loaded part in the data-pjax-container, that part is still not coming(being invisible). I guess that is because of the way pjax works, when ever a pjax request goes to the server, it will carry a 'X-PJAX' header and the server doesn't load the whole layout if it finds the X-PJAX in the headers.</p>\n\n<pre><code>%div{:id = \"content\", :data =&gt; {\"pjax-container\" =&gt; true}}\n\n  #context_menu\n    = THE DYNAMICALLY GENERATED CONTENT GOES HERE\n    .clear\n\n  #pageHeading\n    #breadcrumbs\n      = THE DYNAMICALLY GENERATED CONTENT GOES HERE\n      .clear\n\n\n    .bodytext\n      = yield   / THIS IS THE MAIN YIELD\n    .clear\n</code></pre>\n\n<p>Any suggestions to get around this please..</p>\n"},{"tags":["ruby-on-rails","sqlite","postgresql","heroku","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13170343,"title":"Heroku db:pull db:push Taps Load Error sqlite3","body":"<p>Trying to push or pull heroku's db by doing this:</p>\n\n<pre><code>heroku db:pull OR heroku db:push\n</code></pre>\n\n<p>And I got the next output</p>\n\n<pre><code>!    Taps Load Error: no such file to load -- sqlite3\n!    You may need to install or update the taps gem to use db commands.\n!    On most systems this will be:\n!    \n!    sudo gem install taps\n</code></pre>\n"},{"tags":["ruby-on-rails","activerecord","associations","has-many-through"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13170183,"title":"has_many through association with existing object / ActiveRecord","body":"<p>Given models</p>\n\n<pre><code>class Composition &lt; ActiveRecord::Base\n  attr_accessible :content\n\n  has_many :compositions_tags\n  has_many :tags, :through =&gt; :compositions_tags\n\nend\n\nclass Tag &lt; ActiveRecord::Base\n  attr_accessible :text\n\n  has_many :compositions_tags\n  has_many :compositions, :through =&gt; :compositions_tags\n\n  validates_uniqueness_of :tag, only: [:create, :update], message: \"already taken\"\nend\n\nclass CompositionsTag &lt; ActiveRecord::Base\n  belongs_to :composition\n  belongs_to :tag\nend\n</code></pre>\n\n<p>Now, for example I do</p>\n\n<pre><code>Composition.create(content: \"Hello\").tags.create(text: \"#hi\")\n</code></pre>\n\n<p>The result would be is a Composition with content \"Hello\" and a Tag with text \"#hi\" having created.</p>\n\n<p>Then I create again a Composition.</p>\n\n<pre><code>Composition.create(content: \"Goodmorning\")\n</code></pre>\n\n<p>Now what I don't know and wanted to do is associate that as well to the existing Tag with text \"#hi\".</p>\n\n<p>How do I do that in the most elegant way?</p>\n"},{"tags":["ruby-on-rails","postgresql","activerecord","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":151,"score":1,"question_id":8405793,"title":"Finding annual dates with Rails 3.1 ActiveRecord Queries","body":"<p>I am building a Rails 3.1 project in which one of my models contains a birthday attribute. I have been trying to find a query that essentially finds all users with a birthday within a certain range. The problem is that this part of the application doesn't really care about the year of birth, just the month and day. Unfortunately, Google has not been of much help on this one.</p>\n\n<p>Does anyone know how to query for all records whose birthday attribute \"has an anniversary\" within a certain date range? I hope that makes sense!</p>\n"},{"tags":["ruby-on-rails","resize","paperclip","crop"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":624,"score":1,"question_id":5800098,"title":"How to crop and then resize with Paperclip","body":"<p>I have a photo attachment which I'm saving using Paperclip. However, I'd like to process the photo first before saving by cropping it down and then resizing to the final size:\ne.g. I have a 900x900 photo, I want to first do a central crop to 500x500, and then resize the cropped photo down to a thumbnail size of 100x100.</p>\n\n<p>The purpose of this is so that the thumbnail image wouldn't simply be a scaled down version of the 900x900 since it might be too small to even make out anything in the photo. By cropping it, we reduce a huge part of photo that can be left out and still have a meaningful scaled down thumbnail.</p>\n\n<p>I know paperclip can do either crop or resize, but is there a way to combine both?</p>\n\n<p>Edit: To clarify, I'm not trying to create a cropper tool where the user can interact and crop the image. For every photo that is uploaded, I want to uniformly perform a crop followed by a resize.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":6,"favorite_count":1,"up_vote_count":9,"down_vote_count":3,"view_count":5731,"score":6,"question_id":705729,"title":"How do I create a ruby Hello world?","body":"<p>I know in PHP you have to intrepret a page like index.php, but in Ruby how does it work? I don't know what is the Ruby extension like index.php for PHP. Could you help me?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","authorization","unauthorized"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2506,"score":2,"question_id":7297183,"title":"Custom Devise 401 unauthorized response","body":"<p>I'm working on a JSON-based API for my Rails 3.1 app.  I'd like to provide a custom failure response instead of the default, which is:</p>\n\n<pre><code>{\"error\":\"You need to sign in or sign up before continuing.\"}\n</code></pre>\n\n<p>My API controller includes a before_filter call to <code>authenticate_user!</code>, which is what is rendering this JSON response.</p>\n\n<p>While searching, I came across <a href=\"http://stackoverflow.com/questions/4756922/devise-hijacking-a-401-response\">this StackOverflow question</a>, which references <a href=\"https://github.com/plataformatec/devise/wiki/How-To%3a-Provide-a-custom-failure-response-with-Warden\" rel=\"nofollow\">this Devise wiki entry</a>.  Unfortunately, the wiki entry isn't verbose enough for me to understand what it's telling me.  Specifically, I have no clue where I'm supposed to put that code such that Devise/Warden knows to render what I want returned.</p>\n\n<p>From the comments on the other SA question, it sounds like I don't need to call <code>custom_failure!</code> since I'm using a version of Devise above 1.2 (1.4.2 to be specific).  However, the wiki entry doesn't explain where the <code>render</code> call should go such that <code>authenticate_user!</code> knows to use that instead of its own render call.</p>\n\n<p>Where does this <code>render</code> call go?</p>\n\n<p><strong>Edit:</strong> I'm not just trying to change the message itself (a la the devise <code>en.yml</code> config); I'm trying to change the actual format of the response.  Specifically, I want to return this:</p>\n\n<pre><code>render :text =&gt; \"You must be logged in to do that.\", :status =&gt; :unauthorized\n</code></pre>\n"},{"tags":["ruby-on-rails","database","command-line","migrate","appfog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13153777,"title":"App Fog Rails Migrate Database","body":"<p>How am I supposed to migrate <em>Rails</em> application database in <strong>App Fog?</strong></p>\n\n<p>For example, on Heroku after the first deployment you have to run:\n</p>\n\n<pre><code>$ heroku run rake db:migrate\n</code></pre>\n\n<p>Is there a similar command or the database is deployed automatically on App Fog?</p>\n\n<p>P.S. I didn't found documentation for this. Does it configure the database automatically by generating the <code>database.yml</code> file like on Heroku?</p>\n"},{"tags":["ruby-on-rails","ruby","routing"],"answer_count":8,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1161,"score":0,"question_id":9991304,"title":"Routing Error during \"Ruby on Rails-Tutorial\"","body":"<p>It seems like some people here had this problem but I couldn't find any solution in another topic.</p>\n\n<p>I am doing Chapter 3 of the Ruby on Rails-Tutorial, working on the static pages. When I want to open them on the localhost it gives me a \"Routing Error\" in the Browser.</p>\n\n<p>My Ruby is currently on version 1.9.3.\nMy Rails is currently on version 3.2.</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li>restarting the server</li>\n<li>saving all the files again</li>\n<li>checking any issues in the static_pages_controller.rb</li>\n<li>checking any issues in the routes.rb</li>\n<li>checking any issues in the static_oages_spec.rb</li>\n</ul>\n\n<p>Also there are no bugs in the HTML code of the single static page. And I can't find any more help in the tutorial, neither in other questions here on StackOverflow.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>This is the actual error message from the browser:</p>\n\n<blockquote>\n  <p>Routing Error </p>\n  \n  <p>No route matches [GET] \"/static_pages/home\" Try running\n  rake routes for more information on available routes.</p>\n</blockquote>\n\n<p>if I go to <code>http://localhost:3000/static_pages/home</code>, to one of three static pages I have.</p>\n\n<p>This is routes.rb:</p>\n\n<pre><code>SampleApp::Application.routes.draw do\n\nget \"static_pages/home\"\n\nget \"static_pages/help\"\n\nget \"static_pages/about\"\n\nend\n</code></pre>\n\n<p>Also, I tried \"<code>rake routes</code>\" in the terminal, too. This is the result:</p>\n\n<pre><code>home_static_pages GET    /static_pages/home(.:format)  static_pages#home\n help_static_pages GET    /static_pages/help(.:format)  static_pages#help\nabout_static_pages GET    /static_pages/about(.:format) static_pages#about\n      static_pages POST   /static_pages(.:format)       static_pages#create\n  new_static_pages GET    /static_pages/new(.:format)   static_pages#new\n edit_static_pages GET    /static_pages/edit(.:format)  static_pages#edit\n                   GET    /static_pages(.:format)       static_pages#show\n                   PUT    /static_pages(.:format)       static_pages#update\n                   DELETE /static_pages(.:format)       static_pages#destroy\n</code></pre>\n\n<p>And this is the error message the server is giving me:</p>\n\n<pre><code>Started GET \"/static_pages/home.html\" for 127.0.0.1 at 2012-04-03 13:23:54 +0200\n\nActionController::RoutingError (No route matches [GET] \"/static_pages/home.html\"):\n  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'\n  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'\n  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\n  rack (1.4.1) lib/rack/runtime.rb:17:in `call'\n  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n  rack (1.4.1) lib/rack/lock.rb:15:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'\n  railties (3.2.3) lib/rails/engine.rb:479:in `call'\n  railties (3.2.3) lib/rails/application.rb:220:in `call'\n  rack (1.4.1) lib/rack/content_length.rb:14:in `call'\n  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'\n  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n  /Network/Servers/pluto.kayoom.lan/Users/benediktkrebs/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n  /Network/Servers/pluto.kayoom.lan/Users/benediktkrebs/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n  /Network/Servers/pluto.kayoom.lan/Users/benediktkrebs/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n"},{"tags":["ruby-on-rails","logging","configuration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13169610,"title":"Rails production log not honoring \"log_level\"","body":"<p>In my config/environments/production.rb I have set log_level to error</p>\n\n<pre><code>config.log_level = :error\n</code></pre>\n\n<p>but the log is very verbose with all kinds of non error messages. Can it be that this config.log_level is somewhere overwritten?</p>\n\n<p>I'm on REE/3.2.8</p>\n\n<p>Regards,</p>\n\n<p>Rutger</p>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13169296,"title":"Failed to deploy my app on heroku because i cant migrate the database","body":"<p>Am trying to deploy an app  to heroku which is working fine on my local host. Am using sqlite on my local machine. I managed to deploy but when i try to migrate the database with seed data </p>\n\n<p>i get the following errors.</p>\n\n<pre><code>C:\\Users\\WASSWA SAM\\railsapps\\UIDassignment [master +27 ~0 -0 !]&gt; heroku run rak\ne db:setup\nRunning `rake db:setup` attached to terminal...  !    autoupdate in progress\nup, run.1\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support\nfor these plugins will be removed in Rails 4.0. Move them out and bundle them i\nn your Gemfile, or fold them in to your app as lib/myplugin/* and config/initial\nizers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonr\nails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required\n)&gt; at /app/Rakefile:7)\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support\nfor these plugins will be removed in Rails 4.0. Move them out and bundle them i\nn your Gemfile, or fold them in to your app as lib/myplugin/* and config/initial\nizers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonr\nails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required\n)&gt; at /app/Rakefile:7)\nd4pj1nq6eo44fj already exists\nrake aborted!\nuninitialized constant User\n\nTasks: TOP =&gt; db:schema:load =&gt; environment\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>Any clues. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","file","download"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13169494,"title":"Creating file dynamically and downloading onto user's computer","body":"<p>I'm wondering if it's possible to do this in Rails:</p>\n\n<p>Have a link on the webpage. When the user clicks on the link, the controller generates a file dynamically (say, a text file that contains a single random number between 1 and 10), and the file is downloaded onto the user's computer. The file might be temporarily stored on the server, but it shouldn't be permanently there.</p>\n"},{"tags":["ruby-on-rails","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13168586,"title":"Test not passing: undefined method `authenticate!' for nil:NilClass?","body":"<p>I have the following failure:</p>\n\n<blockquote>\n<pre><code>Failures:\n\n  1) RelationshipsController creating a relationship with Ajax should increment the Relationship count\n     Failure/Error: xhr :post, :create, relationship: { followed_id: other_user.id }\n     NoMethodError:\n       undefined method `authenticate!' for nil:NilClass\n     # ./spec/controllers/relationships_controller_spec.rb:14:in `block (4 levels) in &lt;top (required)&gt;'\n     # ./spec/controllers/relationships_controller_spec.rb:13:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n</blockquote>\n\n<p>But it is very strange, if I visit the site, the thing works (the <code>followers</code> counter does increment if I click the <em>Follow</em> button:</p>\n\n<p><img src=\"http://i.stack.imgur.com/itUvm.png\" alt=\"enter image description here\"></p>\n\n<p>And the weirdest thing is that there isn't any authenticate! method in <strong>relationships_controller_spec.rb</strong>:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe RelationshipsController do\n\n  let(:user) { FactoryGirl.create(:user) }\n  let(:other_user) { FactoryGirl.create(:user) }\n\n  before { sign_in user }\n\n  describe \"creating a relationship with Ajax\" do\n\n    it \"should increment the Relationship count\" do\n      expect do\n        xhr :post, :create, relationship: { followed_id: other_user.id }\n      end.to change(Relationship, :count).by(1)\n    end\n\n    it \"should respond with success\" do\n      xhr :post, :create, relationship: { followed_id: other_user.id }\n      response.should be_success\n    end\n  end\n\n  describe \"destroying a relationship with Ajax\" do\n\n    before { user.follow!(other_user) }\n    let(:relationship) { user.relationships.find_by_followed_id(other_user) }\n\n    it \"should decrement the Relationship count\" do\n      expect do\n        xhr :delete, :destroy, id: relationship.id\n      end.to change(Relationship, :count).by(-1)\n    end\n\n    it \"should respond with success\" do\n      xhr :delete, :destroy, id: relationship.id\n      response.should be_success\n    end\n  end\nend\n</code></pre>\n\n<p>Neither in the controller:</p>\n\n<pre><code>class RelationshipsController &lt; ApplicationController\n  before_filter :authenticate_user!\n\n  def create\n    @user = User.find(params[:relationship][:followed_id])\n    current_user.follow!(@user)\n    respond_to do |format|\n      format.html { redirect_to @user }\n      format.js\n    end\n  end\n\n  def destroy\n    @user = Relationship.find(params[:id]).followed\n    current_user.unfollow!(@user)\n    respond_to do |format|\n      format.html { redirect_to @user }\n      format.js\n    end\n  end\nend\n</code></pre>\n\n<p>What could be the problem?</p>\n\n<p>(By the way, these test were made following the <a href=\"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book\" rel=\"nofollow\">Ruby on Rails Tutorial</a>. After that, I removed all the authentication system because I wanted to use <strong>Devise</strong>.)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unit-testing","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13167638,"title":"RSpec test if all models respond_to attribute","body":"<p>I'm trying to write an RSpec test for what seems like a relatively simple test, but it's proving pretty tricky (though I am new to RSpec).</p>\n\n<p>In simple terms, I want to test that all models in my application respond_to :owner or :owners.</p>\n\n<p>My first problem is looping through all of the models - how to do this in RSpec? I can normally loop through the models like:</p>\n\n<pre><code>ActiveRecord::Base.descendants.each { |model|\n    model.should respond_to :owner\n}\n</code></pre>\n\n<p>But not sure how to do this correctly in RSpec? I can't find much documentation about using loops within tests.</p>\n\n<p>My second question is about an \"OR\" clause - how can I achieve \"responds to owner or owners\"? Something like:</p>\n\n<pre><code>model.should respond_to :owner || :owners\n</code></pre>\n\n<p>But again I can find much documentation about using or clauses.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","imagemagick","osx-mountain-lion","rmagick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13169337,"title":"Can't install RMagick on OS X Mountain Lion","body":"<p>I've been struggling with this for a while. I'm running Mac OS 10.7 (Mountain Lion), and I'm trying to install the RMagick gem so I can use it in my Rails 3 app. I already installed imagemagick with homebrew, and that seemed to finish successfully. I also installed the XQuartz package. When I add 'rmagick' to my gemfile and run bundle install, I get this error:</p>\n\n<pre><code>Installing rmagick (2.13.1) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin/ruby extconf.rb \nchecking for Ruby version &gt;= 1.8.5... yes\nextconf.rb:128: Use RbConfig instead of obsolete and deprecated Config.\nchecking for clang... yes\nchecking for Magick-config... no\nCan't install RMagick 2.13.1. Can't find Magick-config in /Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin:/Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/bin:/Users/Andrew/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin\n\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin/ruby\n\n\nGem files will remain installed in /Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/gems/rmagick-2.13.1 for inspection.\nResults logged to /Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\nAn error occured while installing rmagick (2.13.1), and Bundler cannot continue.\nMake sure that `gem install rmagick -v '2.13.1'` succeeds before bundling.\n\nProcess finished with exit code 5\n</code></pre>\n\n<p>Any idea why this is happening?</p>\n"},{"tags":["ruby-on-rails","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13169357,"title":"the Rails Way of associating images with products?","body":"<p>I've got two models, <code>Product</code> and <code>Image</code>. <code>Product</code> has two columns: <code>name</code> and <code>description</code>.<code>Image</code> also has two columns: <code>path</code> (i.e., foobar.jpg) and <code>description</code> (for captions and <code>alt</code> info). Most images depict multiple products and there are multiple images of each product. Each product has its own page that will feature a gallery of all relevant images.</p>\n\n<p>Originally I thought the best way to solve this would be a HABTM association - but I've since read (in <em>The Rails 3 Way</em>) that those are now frowned upon in favor of the <code>has_many :through</code> association. But creating a third model seems silly here.</p>\n\n<p>Another solution I've considered is to, on each product page, search the <code>Image</code> <code>description</code> column for the <code>Product</code> <code>:name</code>. But this doesn't seem like an elegant solution.</p>\n\n<p>What's the Rails Way to solve this problem?</p>\n"},{"tags":["ruby-on-rails","api","plugins","linkedin"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13163629,"title":"LinkedIn API : How to get public url for a user","body":"<p>I am currently developing a Rails web application that requires a user to login through LinkedIn. After that I want to embed the <code>Member Profile</code> plugin in his/her profile page.</p>\n\n<p>For that to happen I need to have the public URL, without it the plugin will not work. I already have full profile permission <code>r_fullprofile</code> on LinkedIn login. But still I am not able to find the API to extract public url.</p>\n\n<p>Is there a way to get that URL?</p>\n"},{"tags":["ruby-on-rails","testing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13165406,"title":"Creating a rails testing dashboard in a non-test environment","body":"<p>I want to create an online admin dashboard which will indicate whether our most important tests are passing.  I've already written the tests, but how I could run them on demand and see what their results are in a non-test (production) environment?</p>\n\n<p>I'd like to avoid rewriting the test code if possible.</p>\n\n<p>I have 3 ideas for how to do this (not sure if they're any good):</p>\n\n<ol>\n<li>Using system calls to grep the verbose (<code>-v</code>) output of the tests</li>\n<li>Use a different test_runner that will give easier to parse ouptut via system call</li>\n<li>Somehow abstract the testing functions so that they can be used in a non-test context.  (Not sure how I would do this.. </li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13169097,"title":"Rails 3.2.8 \"NotImplementedError: method `backtrace' called on unexpected T_NODE object\" error","body":"<p>I am getting the following error:</p>\n\n<blockquote>\n  <p>NotImplementedError: method `backtrace' called on unexpected T_NODE object</p>\n</blockquote>\n\n<p>when using rails console to access one specific model, Domain, with \"Domain.new\"</p>\n\n<p>Model is defined as:</p>\n\n<pre><code>class Domain &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>Environment: </p>\n\n<ul>\n<li>Rails 3.2.8</li>\n<li>ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]</li>\n<li>Linux cb-2 3.2.0-32-generic #51-Ubuntu SMP Wed Sep 26 21:33:09 UTC\n2012 x86_64 x86_64 x86_64 GNU/Linux</li>\n</ul>\n\n<p>Full backtrace is at <a href=\"https://gist.github.com/954bcdf833c8aef4d2f9\" rel=\"nofollow\">https://gist.github.com/954bcdf833c8aef4d2f9</a>   </p>\n\n<p>There are 41 other models in the project which test without any issue  </p>\n\n<p>Would very much appreciate it you would be able to shed some light on the issue.  </p>\n\n<p>Ross</p>\n"},{"tags":["ruby-on-rails","csv","mime-types","actionview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13167188,"title":"Rendering a CSV sends a file (as if I used send_data) instead of rendering a text","body":"<p>The following code returns me a <code>people.csv</code> file instead of rendering a text. If I am not using respond_to block and simply render a text, the browser works as expected. What forces the browser to send data in a file? The mime-type is 'text/csv', as expected.</p>\n\n<pre><code># /app/controllers/people_controller.rb\nclass PeopleController &lt; ApplicationController\n  def index\n    respond_to do |format|\n      format.csv { render text: \"Hello, world\" }\n    end\n  end\nend\n</code></pre>\n\n<p><strong>Corollary</strong>: rendering xls, which is a properly registered mime-type with a template forces rendering of application.html, which looks very strange to me.</p>\n\n<pre><code># /app/controllers/people_controller.rb\nclass PeopleController &lt; ApplicationController\n  def index\n    respond_to do |format|\n      format.xls\n    end\n  end\nend\n</code></pre>\n\n<p>.</p>\n\n<pre><code># /app/views/people/index.xls.erb\n&lt;table border=\"1\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;ID&lt;/th&gt;\n    &lt;th&gt;Name&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;% @people.each do |person| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= person.id %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= person.name %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","date"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13168342,"title":"Rails: Why, and how, does adding apparently equal values to equal dates give different results in this example?","body":"<p>I see that typing <code>100.days</code> gives me [edit: <em>seems</em> to give me] a Fixnum <code>8640000</code>:</p>\n\n<pre><code>&gt; 100.days.equal?(8640000)\n =&gt; true \n</code></pre>\n\n<p>I would have thought those two values were interchangable, until I tried this:</p>\n\n<pre><code>x = Time.now.to_date\n=&gt; Wed, 31 Oct 2012 \n&gt; [x + 100.days, x + 8640000]\n=&gt; [Fri, 08 Feb 2013, Mon, 07 May 25668] \n</code></pre>\n\n<p><strong>Why, and how, does adding apparently equal values to equal dates give different results?</strong></p>\n\n<p>The above results are from the Rails console, using Rails version 3.1.3 and Ruby version 1.9.2p320.  (I know, I should upgrade to the latest version...)</p>\n"},{"tags":["ruby-on-rails","ruby","model"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13168644,"title":"NoMethodError when using .where (eager fetching)","body":"<p>I have the following model classes...</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n  attr_accessible :description, :title\n  has_many :imageTags\n  has_many :tags, :through =&gt; :imageTags\nend\n\nclass Tag &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_many :imageTags\n  has_many :images, :through =&gt; :imageTags\nend\n\nclass ImageTag &lt; ActiveRecord::Base\n  attr_accessible :position\n  belongs_to :image\n  belongs_to :tag\nend\n</code></pre>\n\n<p>And when I use <code>find</code> for getting the Tag with the id 1 </p>\n\n<pre><code>t = Tag.find(1);\n@images = t.images;\n</code></pre>\n\n<p>But when I do the same with <code>where</code>, I get a <code>NoMethodError</code>, with the description <code>undefined method 'images'</code>:</p>\n\n<pre><code>t = Tag.where(:name =&gt; \"foo\");\n@images = t.images;\n</code></pre>\n\n<p>I also tried adding <code>.includes(:images)</code> before the <code>.where</code> statement, but that doesn't work too. <strong>So, how can I get all <code>Images</code> that belong to a <code>Tag</code>?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","checkout","cart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13131037,"title":"Adding Cart items Ruby on Rails","body":"<p>I am developing a very basic shopping cart and the issue I am having is that if I add more than one of the same product to my shopping cart I am not seeing the quantity increase and am instead just seeing multiple versions of the item. </p>\n\n<p>For example I see:</p>\n\n<p>1 x green light = £15\n1 x green light = £15</p>\n\n<p>rather than seeing:</p>\n\n<p>2 x green light = £30</p>\n\n<p>How can I make it so that my shopping cart will check for multiple versions in the cart and then add them together?</p>\n\n<p>Currently I have: </p>\n\n<p>Application Controller</p>\n\n<pre><code>  def current_cart\n  if session[:cart_id]\n    @current_cart ||= Cart.find(session[:cart_id])\n  end\n  if session[:cart_id].nil?\n    @current_cart = Cart.create!\n    session[:cart_id] = @current_cart.id\n  end\n  @current_cart\n  end \n</code></pre>\n\n<p>Cart Controller</p>\n\n<pre><code>   def show\n    @cart = current_cart\n   end\n</code></pre>\n\n<p>Cart Model</p>\n\n<pre><code> has_many :items\n\n def total_price\n   items.to_a.sum(&amp;:full_price)\n end\n</code></pre>\n\n<p>Cart View</p>\n\n<pre><code> &lt;table id=\"line_items\"&gt;\n   &lt;tr&gt;\n     &lt;th&gt;Product&lt;/th&gt;\n     &lt;th&gt;Qty&lt;/th&gt;\n     &lt;th class=\"price\"&gt;Unit Price&lt;/th&gt;\n     &lt;th class=\"price\"&gt;Full Price&lt;/th&gt;\n   &lt;/tr&gt;\n\n  &lt;% for item in @cart.items %&gt;\n    &lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n       &lt;td&gt;&lt;%=h item.product.name %&gt;&lt;/td&gt;\n       &lt;td class=\"qty\"&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n       &lt;td class=\"price\"&gt;&lt;%= gbp(item.unit_price) %&gt;&lt;/td&gt;\n       &lt;td class=\"price\"&gt;&lt;%= gbp(item.full_price) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n   &lt;% end %&gt;\n &lt;tr&gt;\n\n  &lt;td class=\"total price\" colspan=\"4\"&gt;\n    Total: &lt;%= gbp(@cart.total_price) %&gt;\n  &lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;/table&gt;\n</code></pre>\n\n<p><strong>FURTHER INFORMATION</strong></p>\n\n<p>Products#Index</p>\n\n<pre><code>  &lt;%= link_to \"Add to Cart\", line_items_path(:product_id =&gt; product), :method =&gt; :post %&gt;\n</code></pre>\n\n<p>Any advice people can offer would be much appreciated. Thanks!</p>\n\n<p><strong>New Setup</strong> - Causing Error <code>Uninitialised Constant CartController</code></p>\n\n<p>Routes.rb</p>\n\n<pre><code> Checkout::Application.routes.draw do\n\n   ActiveAdmin.routes(self)\n\n   devise_for :admin_users, ActiveAdmin::Devise.config\n\n   post '/add_to_cart/:product_id' =&gt; 'cart#add_to_cart', :as =&gt; 'add_to_cart'\n\n   resources :carts\n   resources :products\n   resources :items\n\n   root :to =&gt; 'products#index'\n\n end\n</code></pre>\n\n<p>Carts Controller</p>\n\n<pre><code> class CartsController &lt; ApplicationController\n\n   def show\n     @cart = current_cart\n   end\n\n   def add_to_cart\n       current_cart.add_item(params[:product_id])\n       redirect_to carts_path(current_cart.id)\n   end\n\n end\n</code></pre>\n\n<p>Carts Model</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\nhas_many :items\n\ndef add_item(product_id)\n        item = items.where('product_id = ?', product_id).first\n    if item\n        # increase the quantity of product in cart\n        item.quantity + 1\n        save\n    else\n        # product does not exist in cart\n        product = Product.find(product_id)\n        items &lt;&lt; product\n    end\n    save\nend\n\ndef total_price\n    items.to_a.sum(&amp;:full_price)\nend\nend\n</code></pre>\n\n<p>Product#Index</p>\n\n<pre><code>&lt;table class=\"jobs\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th scope=\"col\" id=\"name\"&gt;Product Code&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Name&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Price&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Action&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n        &lt;% @product.each do |product| %&gt;\n        &lt;tr&gt;    \n            &lt;td&gt;&lt;%= product.product_code %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= gbp(product.price) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= button_to \"Add to Cart\", add_to_cart_path(:product_id =&gt; product), :method =&gt; :post %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;% end %&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","git","capistrano","bundle"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13168522,"title":"error cap deploy failed: \"rvm_path","body":"<p>I try to run cap but I have the following error does not you may be causing the error code is </p>\n\n<p>as follows</p>\n\n<pre><code>  [x.x.x.x] executing command\n ** [out :: wic] ln:\n ** [out :: wic] fallo al crear el enlace simbólico «/home/www/vhosts/wic/releases/20121031223825/public/system/system»\n ** [out :: wic] : El archivo ya existe\n ** [out :: wic] \n    command finished in 421ms\n*** [deploy:update_code] rolling back\n  * executing \"rm -rf /home/www/vhosts/wic/releases/20121031223825; true\"\n    servers: [\"wic\", \"x.x.x.x\"]\n    [wic] executing command\n    [x.x.x.x] executing command\n    command finished in 448ms\nfailed: \"rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell 'ruby-1.9.3-p194@wic' -c 'ln -s /home/www/vhosts/wic/shared/system /home/www/vhosts/wic/rele\nases/20121031223825/public/system'\" on wic\n</code></pre>\n\n<p>deploy.rb</p>\n\n<pre><code># RVM bootstrap\nrequire \"rvm/capistrano\"\n\n#set :rvm_ruby_string, \"1.9.3-p194\"\nset :rvm_ruby_string, ENV[\"GEM_HOME\"].gsub(/.*\\//,\"\")\nset :rvm_type, :user\nset :rvm_bin_path, \"$HOME/.rvm/bin\" # To fix ~/.rvm/bin/rvm-shell error in capistrano/RVM integration. \n\n# bundler bootstrap\nrequire \"bundler/capistrano\"\n</code></pre>\n"},{"tags":["ruby-on-rails","rspec"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13168575,"title":"Speeding up a test with factories with an image","body":"<p>I have an integration test that uses Paperclip and a factory with <code>Rack::Test::UploadedFile</code> to <code>(:create</code>) an image <code>20.times</code>.</p>\n\n<p>This test is extraordinarily slow. It took over 60 seconds to complete. I swapped out the image with one 30x smaller, and it only cut the test time by 20 seconds.</p>\n\n<p>How can I speed up this test and others like it?</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":282,"score":0,"question_id":11780215,"title":"form_tag with :remote => true does not update div, skips to separate page","body":"<p>I am trying to update a div based on a form submit. I am on Rails 3.1.1. I am trying to adapt someone else's <a href=\"http://jmvidal.cse.sc.edu/talks/rubyonrails/form_remote_tag.html\" rel=\"nofollow\">recipe</a>. My code in the view is something like this in <code>main.html.erb</code>:</p>\n\n<pre><code>&lt;%= javascript_include_tag :defaults %&gt;\n&lt;div id='seq_search'&gt;\n  &lt;%= form_tag(:remote =&gt; true, :update =&gt; 'seq_select', :action =&gt; 'select')  do %&gt;\n    &lt;p&gt;\n      &lt;%= search_field_tag  :query, '', :size =&gt; 45 %&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;%=submit_tag \"Submit\", :disable_wth =&gt; \"Adding ...\"%&gt;\n    &lt;/p&gt;\n   &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>The controller looks like</p>\n\n<pre><code>class SearchAjaxController &lt; ApplicationController\n  def main\n  end\n  def select\n      render :text =&gt; '&lt;li&gt; '+params[:query] + ' &lt;/li&gt;'\n  end\nend\n</code></pre>\n\n<p>However, when I enter something in the text box and press submit, instead of updating the div, it goes off to another page rendering just the output of the <code>select</code> method of the controller.</p>\n\n<p>If I look at the page source of the form, it is something like this:</p>\n\n<pre><code>&lt;div id='seq_search'&gt;\n  &lt;form accept-charset=\"UTF-8\" action=\"/search_ajax/select?remote=true&amp;amp;update=seq_select\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"wlOm4H7GvZAQoIVpjxPLqHAQLOIpJ4V5r0WYEpvCCrQ=\" /&gt;&lt;/div&gt;\n    &lt;p&gt;\n      &lt;input id=\"query\" name=\"query\" size=\"45\" type=\"search\" value=\"\" /&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input disable_wth=\"Adding ...\" name=\"commit\" type=\"submit\" value=\"Submit\" /&gt;\n    &lt;/p&gt;\n&lt;/form&gt;&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>It seems that the form is simply passing <code>remote=true&amp;amp;update=seq_select</code> as arguments to the controller's method/function. Is this what is supposed to happen?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>So I tried to add to follow Mike Campbell's sugggestion and added the following code to my view (`.html.erb') file</p>\n\n<pre><code>&lt;SCRIPT type='text/Javascript'&gt; \n$(function(){\n  $('#form-id').bind('ajax:success', function(xhr, data, status){\n    $('#seq_select').html(data);\n  });\n}\n&lt;/SCRIPT&gt;\n</code></pre>\n\n<p>and also gave an id to the form:</p>\n\n<pre><code> &lt;%= form_tag(:remote =&gt; true, :update =&gt; 'seq_select', :action =&gt; 'select', :id =&gt; 'form-id')  do %&gt;\n</code></pre>\n\n<p>Submitting the form still doesn't update the page. It simply skips to a new rendered view as before. The generated HTML reads:</p>\n\n<pre><code>&lt;SCRIPT type='text/Javascript'&gt; \n$(function(){\n  $('#form-id').bind('ajax:success', function(xhr, data, status){\n    $('#seq_select').html(data);\n  });\n}\n&lt;/SCRIPT&gt;\n\n&lt;div id='seq_search'&gt;\n  &lt;form accept-charset=\"UTF-8\" action=\"/ajax_search/select/form-id?remote=true&amp;amp;update=seq_select\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"wlOm4H7GvZAQoIVpjxPLqHAQLOIpJ4V5r0WYEpvCCrQ=\" /&gt;&lt;/div&gt;\n    &lt;p&gt;\n      &lt;label&gt; Search by identifiers, accessions, and gene names.. &lt;/label&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input id=\"query\" name=\"query\" size=\"45\" type=\"search\" value=\"\" /&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input disable_wth=\"Adding ...\" name=\"commit\" type=\"submit\" value=\"Submit\" /&gt;\n    &lt;/p&gt;\n&lt;/form&gt;&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>Update:</p>\n\n<p>It seems that the syntax for form_tag was wrong, and the first argument has to be the name of the action. I now have <code>&lt;%= form_tag( 'select', :remote =&gt; true, :id =&gt; 'form_id')  do %&gt;</code> which generates the associated HTML <code>&lt;form accept-charset=\"UTF-8\" action=\"select\" data-remote=\"true\" id=\"form_id\" method=\"post\"&gt;</code>. Which is better, but my Ajax is still not working.</p>\n"},{"tags":["ruby-on-rails","rspec"],"answer_count":4,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":2869,"score":7,"question_id":7219732,"title":"Missing host to link to! Please provide :host parameter or set default_url_options[:host]","body":"<p>I have been googling for about 90 minutes now and still don't have an answer to this.  Where do I set <code>default_url_options</code>?  I've already set it for <code>config.action_mailer.default_url_options</code> to solve this same bug elsewhere, but now I'm getting this error when trying to use a URL helper inside an RSpec spec.  I have no idea where it's expecting default_url_options to be set.</p>\n\n<pre><code> Failure/Error: listing_url(listing).should match(/\\/\\d+-\\w+$/)\n RuntimeError:\n   Missing host to link to! Please provide :host parameter or set default_url_options[:host]\n # ./spec/routing/listing_routing_spec.rb:9:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>This code has nothing to do with emails/ActionMailer, it just happens to need a URL instead of a path.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","json","bundler"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13160551,"title":"Rails render :json => [1,2,3] behaving differently in production (json root)","body":"<p>I'm seeing some weird behaviour in my Rails app. I'm running ruby 1.9.2-p290, and I have this sort of controller:</p>\n\n<pre><code>class NumbersController &lt; ApplicationController\n\n  def index\n    render :json =&gt; [1,2,3]\n  end\n\nend\n</code></pre>\n\n<p>Imagine I run the servers like this to demonstrate the problem:</p>\n\n<pre><code>$ rails s # This one runs in \"development\" on port 3000\n$ RAILS_ENV=production rails s -p 2999 # This one runs in \"production\" on port 2999\n</code></pre>\n\n<p>In development or test mode, my result would be</p>\n\n<pre><code>$ curl localhost:3000/numbers # development\n{numbers: [1,2,3]} # The root is being included in the json, as inferred from the controller name.\n$ curl localhost:2999/numbers # production\n[1,2,3] # No root in the JSON\n</code></pre>\n\n<p>I've been over the app with a fine tooth comb and there are no obvious configuration differences that look like they would affect json between development and production. Also, no lines like \"if Rails.env === 'production'\"</p>\n\n<p>I'm guessing that different gems are being required, e.g. for assets, which are changing the behaviour of render :json => ... . I've inspected the versions of the \"json\" and \"multi_json\" gems from within the running apps, and they are the same (1.7.5 and 1.3.6 respectively, and multi_json uses the same adapter.). How do I find out exactly which gems are required from <em>within</em> the app while it is running? Also, does anyone have any alternative explanations?</p>\n\n<p>EDIT: I'm running Rails 3.1.1 and the assets part of my Gemfile is:</p>\n\n<pre><code>group :assets do\n  gem \"ember-rails\"\n  gem \"jquery-rails\"\n  gem \"less\", \"2.0.7\"\n  gem \"less-rails\", \"2.0.2\"\n  gem 'uglifier'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","string"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13149461,"title":"converting boolean values to string","body":"<p>Im trying to standardize data stored in my database. In the sense that I want everything stored as strings. Whats the best way to convert all datatypes into strings in rails?</p>\n\n<p>So if I have something like this in my database:</p>\n\n<pre><code> t.funny = no #(boolean)\n</code></pre>\n\n<p>if Im converting hundreds of these to strings in a loop, whats the best way to do this?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2575,"score":0,"question_id":9574659,"title":"Rails .where vs .find","body":"<p>I've noticed that the <code>Model.where</code> method always returns an array even if there is only one result where as the <code>Model.find</code> method doesn't. Is there any reason for this? I thought <code>Model.where</code> was the preferred function since Rails 3.X. </p>\n\n<p>Should I be using <code>Model.find</code> when I expect a single result and <code>Model.where</code> when I expect more than one result?</p>\n"},{"tags":["javascript","ruby-on-rails","asset-pipeline","dry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13128833,"title":"rails asset pipeline - Garber-Irish, Administration & keeping it DRY","body":"<p>I'm using the so called <a href=\"http://stackoverflow.com/a/6892079/435817\">garber-irish technique</a> for splitting up my javascript files.</p>\n\n<p>My question is, I have a Model (Item say) and have an init function which is in app/assets/javascripts/item/item.js</p>\n\n<p>e.g. </p>\n\n<pre><code>MYAPP.items = {\n  init: function() {\n    alert(\"do something\");\n  }\n};\n</code></pre>\n\n<p>Now.. lets say I have an administration side to this app, and I don't really want to include the admin javascript in the main bulk.  So.. I have a different system_adminstration.js which requires the <em>regular</em> javascripts/item/item.js above, but <em>also</em> requires a javascripts/admin/item/item.js which would look something like:</p>\n\n<pre><code>MYAPP.items = {\n  init: function() {\n    alert(\"also do this\");\n  }\n};\n</code></pre>\n\n<p>I want to load <em>both</em> the common javascripts above, and the administation specific ones - effectively merging the two init functions and keeping things nicely dry.</p>\n\n<p>Questions:</p>\n\n<ol>\n<li>Is this a sensible approach?</li>\n<li>It it possible?</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongomapper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13167897,"title":"Show Query statements in Rails Console with mongo_mapper","body":"<p>With    </p>\n\n<pre><code>ActiveRecord::Base.logger = Logger.new(STDOUT)  \n</code></pre>\n\n<p>you can view SQL statements in Rails Console,related <a href=\"http://www.shanison.com/2012/03/05/show-sql-statements-in-rails-console/\" rel=\"nofollow\">here</a>, but that require ActiveRecord , with mongo_mapper you don't have ActiveRecord, so how view debug of querys ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","form-helpers","select-tag"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13166677,"title":"How to have a default select value that is NOT an option in drop down, using Ruby form select helper method","body":"<p>Ok so I am working on a project that was outsourced and now I get to jump in and fix everything before it gets pushed to production. I am currently trying to modify a line that creates a select form field. I read up on some of the different form helper methods to use in ruby, and over some of the available options for the method.</p>\n\n<p>My problem is I can't seem to figure out how to get a default value to be displayed inside the select element without having it show up in the drop down options. This is what the line currently looks like.</p>\n\n<pre><code>&lt;%= select :profile, :sexual_interest, SEXUAL_INTEREST_ARRAY, {:prompt =&gt; 'sexuality'}, {:class =&gt; 'selectFull'} %&gt;\n</code></pre>\n\n<p>I tried changing some of the options using :default => 'sexuality' and then tried :disabled => 'sexuality'. But I seem to only be able to remove the option entirely from the select element or have it as the first value in the drop down list and being displayed as the default value.</p>\n\n<p>If you are just having issues setting the default value of your select field using a ruby form helper, reference this post <a href=\"http://stackoverflow.com/questions/623458/rails-select-helper-default-selected-value-how\">selecting a default for option field</a></p>\n\n<p>If any one could give me some insight as to how to fix this issue I would greatly appreciate it. Any ideas would help, Thanks for reading.</p>\n\n<p>-Alan</p>\n"},{"tags":["ruby-on-rails","ajax","fancybox","gmaps4rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13104664,"title":"Gmaps4rails: map does not show through ajax with erb data feeding but does when hard coded","body":"<p>I would like to use the gmaps4rails gem to display a map of items in a fancybox.\nI followed carefully the remarks on the wiki concerning ajax call, i.e. scripts have to be included manually in the application layout, maps have to be loaded in a javascript (<a href=\"https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Using-with-UJS\" rel=\"nofollow\">see gem wiki</a>).</p>\n\n<p>But I still not succeed completely to make the map displayed in the box.</p>\n\n<p>On the other hand as I hard code coordinates in the javascript it works fine, the map is displayed in the fancybox and the markers appear.</p>\n\n<p>Let me recap.</p>\n\n<p>In my index view, I have a ajax call to the items index action:</p>\n\n<pre><code>&lt;%= link_to \"Show Map\", items_path(:format =&gt; :js, :show_map =&gt; true), :remote =&gt; true, :class =&gt; 'fancybox' %&gt;\n</code></pre>\n\n<p>In the controller, I populate the map data:</p>\n\n<pre><code>def index\n   @items=Item.all\n\n   if params[:show_map]\n       @map= @items.to_gmaps4rails\n   end \n end \n</code></pre>\n\n<p>in the index.js.erb file, I put</p>\n\n<pre><code>&lt;% if params[:show_map] %&gt;\n    var content = \"&lt;%= escape_javascript( gmaps({:last_map =&gt; false})) %&gt;\";\n    $.fancybox({\n            'content': content,\n            'padding' : 20\n        }); \n    Gmaps.map = new Gmaps4RailsGoogle();\n    Gmaps.load_map = function() {\n               Gmaps.map.initialize();\n               Gmaps.map.markers = &lt;%=  @map %&gt;; \n               Gmaps.map.create_markers();\n               Gmaps.map.adjustMapToBounds();\n               Gmaps.map.callback();\n               };  \n    Gmaps.loadMaps(); \n&lt;% else %&gt;\n // blablabla\n&lt;% end %&gt;\n</code></pre>\n\n<p>Where the markers are provided in the map object.</p>\n\n<p>This does not work and instead of my map I got in the fancybox the code itself appearing.\nSomething like:</p>\n\n<pre><code>var content = \"\\n\n\\n\n&lt;\\/div&gt;\\n&lt;\\/div&gt;\\n\"; $.fancybox({ 'content': content, 'padding' : 20 }); Gmaps.map = new Gmaps4RailsGoogle(); Gmaps.load_map = function() {Gmaps.map.initialize(); \n//Gmaps.map.markers = [{\"lat\":50.294,\"lng\":5.857},{\"lat\":50.294,\"lng\":5.857},{\"lat\":50.548,\"lng\":4.918},{\"lat\":50.384,\"lng\":3.649},{\"lat\":50.384,\"lng\":3.649},{\"lat\":50.08,\"lng\":4.5760000000000005},{\"lat\":50.054,\"lng\":5.195}]; \nGmaps.map.markers = [{\"lat\":50.8483059,\"lng\":4.351783999999999},{\"lat\":50.496,\"lng\":5.066},{\"lat\":50.11,\"lng\":5.003},{\"lat\":50.11,\"lng\":5.003},{\"lat\":50.162,\"lng\":5.871},{\"lat\":50.08,\"lng\":4.5760000000000005},{\"lat\":50.08,\"lng\":4.5760000000000005},{\"lat\":50.08,\"lng\":4.5760000000000005}];\n Gmaps.map.create_markers(); Gmaps.map.adjustMapToBounds(); Gmaps.map.callback(); }; Gmaps.loadMaps(); \n</code></pre>\n\n<p>When instead of the erb <code>&lt;%= @map %&gt;</code>, I hard code the markers, for instance:</p>\n\n<pre><code>Gmaps.map.markers = [{\"lat\":50.294,\"lng\":5.857},\"lat\":50.294,\"lng\":5.857},{\"lat\":50.548,\"lng\":4.918}];\n</code></pre>\n\n<p>It works!</p>\n\n<p>Seems like I'm missing something in the json data type conversion. But I'm not expert to find what is going wrong.</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["ruby-on-rails","jekyll","github-pages"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":10032562,"title":"Jekyll static generator in a rails format?","body":"<p>Is there a jekyll boot strap which is oriented similar to a rails project?</p>\n\n<p>I would like to take advantage of github pages but I am very accustomed to the structure of a rails project and I am curious there is an existing bootstrap which is oriented as a rails project but compatible with github pages.  </p>\n\n<p>I started building <a href=\"https://github.com/RudyIndustries/jekyll-rails\" rel=\"nofollow\">this</a> to serve this very purpose and I have even found a haml and a cofee script plugin but before I go spend a whole day configuring this to act as close to a rails project as possible, is there something alerting existing which serves this purpose?</p>\n"},{"tags":["ruby-on-rails","sorting","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":11231478,"title":"Rails : sort for specific column","body":"<p>I'm design a table on view and for example they have two columns is <code>ID</code> and <code>name</code>. I want to  when user click to <code>ID</code> column, data will be sorted by <code>ID</code> and if user click <code>name</code> column<code>data</code> will be sorted by <code>name</code>.</p>\n\n<p>My question is :</p>\n\n<p>Is there any way to put this into model (database model), so, when user click one column, its status will be saved and database will looked at this to return record according to this status.</p>\n\n<p>if not, how I put this code in view.</p>\n\n<p>Please help me.</p>\n\n<p>Thanks :)</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13165588,"title":"Rails polymorphic views and actions based on STI type","body":"<p>This seems to be a similar question, but the answer may be different two years down the line: <a href=\"http://stackoverflow.com/questions/3542928/rails-way-to-render-different-actions-views-based-on-user-type\">Rails way to render different actions &amp; views based on user type?</a></p>\n\n<p>I have an STI model that can have many types. Often, but not always, the views will be different depending on the type. Equally the controller actions may differ in logic depending on the type. I want to avoid the high maintenance cost of having to change if/elsif conditionals based on the type.</p>\n\n<p>I can think of several ways that I could write some helper functions/modules to make this easier, but wonder if any gems built for this purpose already exist.</p>\n\n<p>Your thoughts appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongomapper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13167053,"title":"rails generate migration error mongo_mapper not found","body":"<p>Follow <a href=\"http://mongomapper.com/documentation/getting-started/rails.html\" rel=\"nofollow\">Installation in Rails 3 of Mongo Mapper</a> i add to config/application.rb file :</p>\n\n<pre><code>config.generators do |g|\n  g.orm :mongo_mapper\nend\n</code></pre>\n\n<p>when <code>rails generate migration my_migration</code> i got :</p>\n\n<pre><code>error  mongo_mapper [not found]\n</code></pre>\n\n<p>but when <code>rails generate model my_model</code>, i got a fine model class with <code>include MongoMapper::Document</code> and this output :</p>\n\n<pre><code>invoke  mongo_mapper\ncreate    app/models/user.rb\ninvoke    test_unit\ncreate      test/unit/user_test.rb\ncreate      test/fixtures/users.yml\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","tdd","activesupport"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13167373,"title":"What should I do to make this rails app testable?","body":"<p>I have an up to date rails application, using rails 3.2 with mongoid 2. I was unable to start testing by typing rake. The exception thrown is (sanitized):</p>\n\n<pre><code>rake test                                                                                                                         \n/railsapp/app/models/image.rb:18:in `&lt;class:Image&gt;': undefined method `[]' for nil:NilClass (NoMethodError)\n    from /railsapp/app/models/image.rb:1:in `&lt;top (required)&gt;'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'\n    from /gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in &lt;module:Finisher&gt;'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n    from /gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n    from /gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n    from /railsapp/config/environment.rb:7:in `&lt;top (required)&gt;'\n    from /railsapp/test/test_helper.rb:2:in `require'\n    from /railsapp/test/test_helper.rb:2:in `&lt;top (required)&gt;'\n    from /railsapp/test/unit/post_test.rb:1:in `require'\n    from /railsapp/test/unit/post_test.rb:1:in `&lt;top (required)&gt;'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10:in `require'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10:in `block (2 levels) in &lt;main&gt;'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9:in `each'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9:in `block in &lt;main&gt;'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4:in `select'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4:in `&lt;main&gt;'\nErrors running test:units! #&lt;RuntimeError: Command failed with status (1): [/Users/janlimpens/.rvm/rubies/ruby-1.9.3-p...]&gt;\n</code></pre>\n\n<p>I created a gist with the files that are of interest in the context:\n<a href=\"https://gist.github.com/3989760\" rel=\"nofollow\">https://gist.github.com/3989760</a></p>\n\n<p>There is no test concerning the image model at all, there are no fixtures and the only test I have got is included into the gist, but it is not to blame, the error is thrown upon including test_helper.rb.</p>\n\n<p>What are my options?</p>\n"},{"tags":["ruby-on-rails","image","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13162187,"title":"How should I handle the rails asset pipeline for uploaded images that change the scope of their public view?","body":"<p>After reading about how rails is handling image assets, I am confused and am having trouble deciding where to keep uploaded images in my app's directory tree.  If a user has uploaded an image to my rails app, should I make the image_save_path /assets/images/ or /public/images  ?   </p>\n\n<p>My concern/question: If I want to allow users to make their images public when they choose to do so, should an uploaded image that is 'un-published' (image is served only if current_user == image.owner) be considered more protected if it resides in assets/images instead of public/images?  Equally protected?  Less protected somehow?</p>\n\n<p>Am I right to assume that the benefit of using the asset pipeline for images is simply that the file names get hashed in production mode and that's it?  Is there some implied additional or diminished security here in terms of how the resource is served?  Is this more a matter of subtle opinion or does the rails convention have something to say here?</p>\n\n<p>Thanks!</p>\n\n<p>EDIT1:\nHow would you handle uploaded content that you want to make available to the uploading user, but not discoverable to guests or other users?  Should (can?) one store uploaded content outside the tree under web_root ?</p>\n"}]}
{"total":93231,"page":16,"pagesize":100,"questions":[{"tags":["sql","ruby-on-rails","activerecord","ruby-on-rails-3.2","query-optimization"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":204,"score":8,"question_id":13039110,"title":"Why are individual SELECT queries running when an all-encompassing SELECT already ran? (Rails/ActiveRecord)","body":"<p>I have the following code (note the <code>includes</code> and the <code>.each</code>):</p>\n\n<pre><code>subscribers = []\nmailgroup.mailgroup_members.opted_to_receive_email.includes(:roster_contact, :roster_info).each { |m|\n  subscribers &lt;&lt; { :EmailAddress =&gt; m.roster_contact.member_email,\n                   :Name =&gt; m.roster_contact.member_name,\n                   :CustomFields =&gt; [ { :Key =&gt; 'gender', \n                                        :Value =&gt; m.roster_info.gender.present? ? m.roster_info.gender : 'X' \n                                    } ] \n                  } if m.roster_contact.member_email.present?\n}\nsubscribers\n</code></pre>\n\n<p>Correspondingly, I see the following in my logs (i.e. <code>select * from ROSTER_INFO ... IN (...)</code>):</p>\n\n<pre><code>SELECT `ROSTER_INFO`.* FROM `ROSTER_INFO` WHERE `ROSTER_INFO`.`ID` IN ('1450', '1000', '1111')\n</code></pre>\n\n<p>Yet immediately after that there are <code>select * from ROSTER_INFO</code> for each ID already specified in the <code>IN</code> list of the previous query:</p>\n\n<pre><code>RosterInfo Load (84.8ms)  SELECT `ROSTER_INFO`.* FROM `ROSTER_INFO` WHERE `ROSTER_INFO`.`ID` = '1450' LIMIT 1\nRosterInfo Load (59.2ms)  SELECT `ROSTER_INFO`.* FROM `ROSTER_INFO` WHERE `ROSTER_INFO`.`ID` = '1000' LIMIT 1\nRosterInfo Load (56.8ms)  SELECT `ROSTER_INFO`.* FROM `ROSTER_INFO` WHERE `ROSTER_INFO`.`ID` = '1111' LIMIT 1\n</code></pre>\n\n<p>If <code>select *</code> had already been done on <code>ROSTER_INFO</code> on all IDs of interest (<code>IN (...)</code>), why is another <code>select *</code> being done again for each of the same IDs? Doesn't <code>ActiveRecord</code> already know all the <code>ROSTER_INFO</code> columns for each ID?</p>\n\n<p>(Meanwhile, there are no individual queries for <code>ROSTER_CONTACT</code>, yet if I remove <code>:roster_contact</code> from the <code>includes</code> method, then <code>ROSTER_INFO</code> is not queried again, but <code>ROSTER_CONTACT</code> is.)</p>\n\n<hr>\n\n<p><strong>RosterInfo model (abridged)</strong></p>\n\n<pre><code>class RosterInfo &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\nend\n</code></pre>\n\n<p><strong>RosterContact model (abridged)</strong></p>\n\n<pre><code>class RosterContact &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\n\n  has_many :mailgroup_members, foreign_key: 'rosterID'\n  has_many :mailgroups, through: :mailgroup_members\n\n  has_one :roster_info, foreign_key: 'ID'     # can use this line\n  #belongs_to :roster_info, foreign_key: 'ID' # or this with no difference\n\n  def member_name                             # I added this method to this\n    roster_info.member_name                   # question only *after* having\n  end                                         # figured out the problem.\nend\n</code></pre>\n\n<p><strong>RosterWeb model (abridged)</strong></p>\n\n<pre><code>class RosterWeb &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\nend\n</code></pre>\n\n<p><strong>Mailgroup model (abridged)</strong></p>\n\n<pre><code>class Mailgroup &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\n\n  has_many :mailgroup_members, foreign_key: 'mailCatID'\n\n  has_one :mailing_list, foreign_key: :legacy_id\nend\n</code></pre>\n\n<p><strong>MailgroupMember model (abridged)</strong></p>\n\n<pre><code>class MailgroupMember &lt; ActiveRecord::Base\n  self.primary_key = 'ID'\n\n  belongs_to :mailgroup, foreign_key: 'mailCatID'\n  belongs_to :roster_contact, foreign_key: 'rosterID'\n  belongs_to :roster_info, foreign_key: 'rosterID'\n  belongs_to :roster_web, foreign_key: 'rosterID'\n\n  scope :opted_to_receive_email, joins(:roster_web).where('ROSTER_WEB.receiveEmail=?', 1)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","caching","copycopter"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13023749,"title":"Store CopyCopter Results Locally","body":"<p>Following the Railscast episode on <a href=\"http://railscasts.com/episodes/336-copycopter\" rel=\"nofollow\">copycopter</a>, so I set up my copycopter server on heroku.  Everything works great, until AWS goes down and brings down heroku.  At that moment, all my copycopter text reverted to the default text I had entered on my html pages.</p>\n\n<p>Is there a way I can store the results from a successful call to my copycopter server on my rails server so that, in case of another heroku outage, my text will still be from copycopter?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13165668,"title":"Discrepancies in function calls in ruby server and ruby console?","body":"<p>New to ruby, trying to figure out how to debug this problem - I've been working on a search method, and the search call returns correctly on the server, but not the console.</p>\n\n<pre><code>Item.where() { has_keyword \"phone\" }\n</code></pre>\n\n<p>returns [] on the server, returns a list with 15 objects on the console. What kinds of differences exist between the server and console? Where should I start looking?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13166681,"title":"Rails Edit Action with Jquery","body":"<p>I'm trying to allow admins to edit a user in the current page let's say for example an index page/action that lists all of the users. So when they click edit how can I let them edit the fields on without going to another view? I'm sure this is done with jquery I'm just not familiar with how to accomplish this. Can someone point me in the right direction, tutorial, gem, or other?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","mvc","design"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13166587,"title":"How to have different controllers/actions for one view","body":"<p>What is the best method to have one single view (I have one html page with different sections () sort of like mini pages on one page) and have different sections call different controllers and actions through that one view?\nBecause in layouts only one &lt;%= yield %> is acceptable?</p>\n"},{"tags":["ruby-on-rails","devise","authorization","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13166718,"title":"how can i restrict access for particular MountableEngine inside my rails application in routes","body":"<p>i want to grant access to /samurai (mountable engine) only for users that have admin as role:</p>\n\n<p>how can i do that?</p>\n\n<p>my routes</p>\n\n<pre><code>authenticate do\n   mount Resque::Server.new, :at =&gt; \"/resque\"\n   mount Samurai::Engine =&gt; \"/samurai\"\n\n\n\n scope \"/admin\" do\n  resources :customers, :images,:categories, :groups,:redirects, :projects, :specs, :indices,:glossaries, :invoices, :users, :products\n\n  resources :comments do\n    member do\n      post 'approve'\n      post 'moderate'\n      post 'disapprove'\n    end\n  end\nend\n</code></pre>\n\n<p>P.S = im using CanCan and Devise</p>\n"},{"tags":["ruby-on-rails","facebook","security","facebook-graph-api","facebook-javascript-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13166310,"title":"Building an API backend with Rails 3 and Facebook login","body":"<p>I've a simple application, that requires facebook signup/login built in Rails 3 that works exactly as I want it to.\nMeanwhile, I had several requests to make it behave like an API, the web app is a social media tool where people publish content to their own social networks. i'm converting the system to provide a solution for the following problem:</p>\n\n<ul>\n<li>3rd party website having their own login system</li>\n<li>They want to make a button - publish through X service - and as soon as the user presses the button he will be shown the Facebook Permissions' dialog for my own fb app, as soon as he authorizes it the content will be published</li>\n</ul>\n\n<p>So far, while the webapp was a standalone website, this was really easy to do - they would go to my webapp, login with facebook and published whatever they wanted to, however, I'm finding it hard to come up with a solution that doesn't present any security issues. Here's what I was thinking:</p>\n\n<ul>\n<li>I provide a JS SDK which:\n<ul>\n<li>the 3rd party install in their website -> a special method is associated with a button</li>\n<li>Once the button is pressed, the user is redirected to FB (sets de redirect_ui to be the current page)</li>\n<li>catches the params whenever FB redirects back (as soon as the user gives the permissions)</li>\n<li>Push the content through Facebook and so on</li>\n<li>the 3rd party provides a callback that will run as soon as the content is published (I send them the FB_ID and access token)</li>\n<li>The 3rd party can now make calls to all my API given they will send the FB_ID and access token which I sent as soon as I had the permissions</li>\n</ul></li>\n</ul>\n\n<p>Will this work ? Can I easily catch back the FB redirect ? Are there any security issues ?</p>\n\n<p>Thanks in advance,\nZe</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13166127,"title":"Virtual attribute to set published_at for a Post","body":"<p>I have a post model with a datetime field called \"published_at\". On my form I have a checkbox for an attribute named \"publish_now\" (see below). I want \"published_at\" to be set to the Time.now() when the user checks the checkbox for my virtual attribute :publish_now.</p>\n\n<pre><code>&lt;input class=\"boolean optional\" id=\"post_publish_now\" name=\"post[publish_now]\" type=\"checkbox\" value=\"1\" /&gt;\n</code></pre>\n\n<p>Here is my create and update methods in the controller:</p>\n\n<pre><code>def create\n  @post = Post.new(params[:post])\n  if current_user\n    @post.author_id == current_user.id\n  end\n\n  respond_to do |format|\n    if @post.save\n      format.html { redirect_to @post, notice: 'Post was successfully created.' }\n      format.json { render json: @post, status: :created, location: @post }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @post.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\ndef update\n  @post = Post.find(params[:id])\n\n  respond_to do |format|\n    if @post.update_attributes(params[:post])\n      format.html { redirect_to @post, notice: 'Post was successfully updated.' }\n      format.json { head :no_content }\n    else\n      format.html { render action: \"edit\" }\n      format.json { render json: @post.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>And here is my model:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  belongs_to :author, class_name: \"User\", foreign_key: \"author_id\"\n\n  attr_accessible :author_id, :content, :published_at, :title, :publish_now\n\n  validates_presence_of :content, :title\n\n  def publish_now\n    !published_at.nil?\n  end\n\n  def publish_now=(value)\n    if value == \"1\" &amp;&amp; published_at.nil?\n      published_at = Time.now()\n    end \n  end\nend\n</code></pre>\n\n<p>This is my best guess of how it should work based on the railscast on virtual attributes, but it's not saving a value for published_at. Any suggestions where the problem might be?</p>\n\n<p>UPDATE: (the form view)</p>\n\n<pre><code>&lt;%= simple_form_for(@post) do |f| %&gt;\n  &lt;%= f.input :title %&gt;\n  &lt;%= f.input :content, input_html: { cols: 100, rows: 10, class: \"\n    span5\" } %&gt;\n  &lt;% if @post.published_now == false %&gt;\n    &lt;%= f.input :publish_now, as: :boolean %&gt;\n  &lt;% end %&gt;\n  &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>UPDATE Example Log:</p>\n\n<pre><code>Started POST \"/posts\" for 127.0.0.1 at 2012-10-31 14:14:49 -0500\nProcessing by PostsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"zlZ3s18VXwEvONIkk1CZAYESAEAxPP1OKcUtiyEuZgA=\", \"post\"=&gt;{\"title\"=&gt;\"big big love a doodle\", \"content\"=&gt;\"aksdfj;skjf;kasjdf; lkj af;lk ;askdfj ;lk ;laf; ksd ;f\", \"publish_now\"=&gt;\"1\"}, \"commit\"=&gt;\"Create Post\"}\n  User Load (0.8ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 1 LIMIT 1\n   (0.2ms)  BEGIN\n  SQL (0.7ms)  INSERT INTO \"posts\" (\"author_id\", \"content\", \"created_at\", \"published_at\", \"title\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"  [[\"author_id\", nil], [\"content\", \"aksdfj;skjf;kasjdf; lkj af;lk ;askdfj ;lk ;laf; ksd ;f\"], [\"created_at\", Wed, 31 Oct 2012 14:14:49 CDT -05:00], [\"published_at\", nil], [\"title\", \"big big love a doodle\"], [\"updated_at\", Wed, 31 Oct 2012 14:14:49 CDT -05:00]]\n   (0.4ms)  COMMIT\nRedirected to http://localhost:3000/posts/5\nCompleted 302 Found in 18ms (ActiveRecord: 2.1ms)\n</code></pre>\n"},{"tags":["ruby-on-rails","deployment","capistrano"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13149566,"title":"Rails capistrano deployment cannot find rake","body":"<p>I am deploying my 1st Rails app using capistrano, unicorn, rbenv, nginx, linode, ubuntu 12.04. When I run</p>\n\n<blockquote>\n  <p>bin/cap deploy:cold</p>\n</blockquote>\n\n<p>in my app root, I get the following error back: </p>\n\n<pre><code>  * 2012-10-31 01:19:36 executing `bundle:install'\n  * executing \"cd /home/mr_deployer/apps/prjct_mngr/releases/20121031001933 &amp;&amp; bundle install --gemfile /home/mr_deployer/apps/prjct_mngr/releases/20121031001933/Gemfile --path /home/mr_deployer/apps/prjct_mngr/shared/bundle --deployment --quiet --without development test\"\n    servers: [\"xxxxxxxxxxxxx\"]\n    [xxxxxxxxxxxxx] executing command\n ** [out :: xxxxxxxxxxxxx] Could not find rake-0.9.2.2 in any of the sources\n ** [out :: xxxxxxxxxxxxx] Run `bundle install` to install missing gems.\n    command finished in 1046ms\n*** [deploy:update_code] rolling back\n  * executing \"rm -rf /home/mr_deployer/apps/prjct_mngr/releases/20121031001933; true\"\n    servers: [\"xxxxxxxxxxxxx\"]\n    [xxxxxxxxxxxxx] executing command\n    command finished in 625ms\nfailed: \"sh -c 'cd /home/mr_deployer/apps/prjct_mngr/releases/20121031001933 &amp;&amp; bundle install --gemfile /home/mr_deployer/apps/prjct_mngr/releases/20121031001933/Gemfile --path /home/mr_deployer/apps/prjct_mngr/shared/bundle --deployment --quiet --without development test'\" on xxxxxxxxxxxxx\n</code></pre>\n\n<p>I have run bundle install --path vendor/bundle on my development machine, and gem rake is installed both on dev machine and on linode vps. Why cant it find rake?</p>\n\n<p>UPDATE:</p>\n\n<p>I have tried adding path of my rake gem on linode to both my bashrc on linode and to :default_envoronment in deploy.rb file. Still getting the same error...</p>\n"},{"tags":["ruby-on-rails","currency"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":586,"score":2,"question_id":10053967,"title":"Rails - Format number as currency format in the Getter","body":"<p>I am making a simple retail commerce solution, where there are <strong>prices</strong> in a few different models. These prices contribute to a <strong>total price</strong>. Imagine paying $0.30 more for selecting a topping for your yogurt. </p>\n\n<p>When I set the <code>price</code> field to  </p>\n\n<pre><code>t.decimal   :price, precision:8, scale:2\n</code></pre>\n\n<p>The database stores <code>6.50</code> as <code>6.5</code>. I know in the standard rails way, you call <code>number_to_currency(price)</code> to get the formatted value in the Views. I need to programmatically call the <code>price</code> field as well formatted string, i.e. $6.50 a few places that are not directly part of the View. Also, my needs are simple (no currency conversion etc), I prefer to have the price formatted universally in the model without repeated calling number_to_currency in views.</p>\n\n<p>Is there a good way I can modify my getter for price such that it always returns two decimal place with a dollar sign, i.e. $6.50 when it's called? </p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Thanks everyone.</p>\n\n<p>I've elected to use Alex's approach because it seems very 'hackish' to do the includes just for formatting the number. Using his approach, I did:</p>\n\n<pre><code>  def price_change=(val)\n      write_attribute :price_change, val.to_s.gsub(/[\\$]/,'').to_d\n  end\n\n  def price_change\n    \"$%.2f\" % self[:price_change]\n  end\n</code></pre>\n\n<p>Cheers. </p>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>Caveat Emptor. Once you do this, you lose the ability to do operations to the number because it's now a string. </p>\n\n<p>Please beware if anyone is facing the same problem as me.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13161283,"title":"Rails remote form renders json in browser","body":"<p>I have a remote form for creating images. Each time the file input is changed, it submits the form.</p>\n\n<pre><code>&lt;%= form_for Image.new, remote: true, multipart: true do |f| %&gt;\n  &lt;!-- form omitted --&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The automatic submitting:</p>\n\n<pre><code>$(\"#new_image input[type=file]\").on(\"change\", function() {\n  $(\"#new_image\").submit();\n});\n</code></pre>\n\n<p>The image is created and json is rendered in the images controller just fine:</p>\n\n<pre><code>def create\n  @image = Image.new params[:image]\n  if @image.save\n    render json: @image, status: :success\n  else\n    render json: @image.errors, status: :unprocessable_entity\n  end\nend\n</code></pre>\n\n<p>The problem is then the user is redirected to the json output. How could that happen? The form is remote: true, so it shouldn't redirect right? I just want the data available for unobtrusive callbacks. </p>\n\n<p>How do I get this to work?</p>\n\n<p><strong>Edit</strong>: application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery-ui\n//= require_tree .\n</code></pre>\n"},{"tags":["ruby-on-rails","backbone.js","cucumber","capybara"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13166147,"title":"Integration Testing a Backbone.js application with Cucumber and Capybara","body":"<p>I am trying to test a Backbone application running on top of a Rails 3.2.8 one using Cucumber, capybara, capybara-webkit, selenium-webdriver, rspec and jasmine. I am using eco as template engine for the backbone template.</p>\n\n<p>My problem is when I run the scenario using the @javascript tag, wether with capybara-webkit or selenium, the page displayed doesn't contain all the model attribute datas.</p>\n\n<p>Here is the scenario :</p>\n\n<pre><code>@javascript\nScenario : first scenario\n     Given There is Model with \"name\" as name and \"What is it about ?\" as associated questions\n     When I want to fill the questionnaire\n     Then I should be on the SPA form\n     And I should see \"name\"\n     And I should see \"What is it about?\"\n</code></pre>\n\n<p>The scenario fails on the \"And I should see 'what is it about?'\" step, the page doesn't show the question, but it shows the \"name\"\nI put several debug statement in my backbone code with console.log and I can see that the model is correct with all its attributes. Moreover it is working in live without issue</p>\n\n<p>The template looks like this : 'show.jst.eco'</p>\n\n<pre><code>&lt;p class=\"text-info\"&gt;&lt;%= @model.name %&gt;&lt;/p&gt;\n\n&lt;form id=\"quidget-form\" class=\"form-vertical\"&gt;\n  &lt;% for question in @model.questions: %&gt;\n    &lt;div class=\"issue_field\"&gt;\n      &lt;label class=\"string optional control-label\"&gt;&lt;%= question.question.question_text %&gt;&lt;/label&gt;\n      &lt;div class=\"control-group text\"&gt;\n        &lt;textarea class=\"text answer\" name=\"question-&lt;%= question.question.id %&gt;\" id=\"question_&lt;%= question.question.id %&gt;\" data-question=\"&lt;%= question.question.question_text %&gt;\" rows=\"3\"&gt;\n        &lt;/textarea&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"controls\"&gt;\n    &lt;input type=\"submit\" value=\"Additional Informations\" id=\"quidget-step-one\" class=\"btn btn-success\"&gt;\n</code></pre>\n\n<p><br>\n</p>\n\n<p>The textaera is displayed but not the label above with the question text</p>\n\n<p>Any idea ? I would like to see this pass so i can test more complicated logic with more steps.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","emacs","ruby-mode"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13165811,"title":"Enabling ruby-mode for sundry Rails files","body":"<p>I am in the process of learning both RoR and Emacs, a process that I happily expect to take up the rest of my lifetime, and my basic strategy is to start with a simple set of tools and then fill up my tool chest as I go along.  </p>\n\n<p>To that end, I don't want to install Rinari or nXhtml just yet, but I would like at least basic syntax highlighting and indentation in the various Rails files.  I also don't want to use a emacs.d \"starter kit\" since another goal of mine is to understand every line of my Emacs configuration, and keep in nice and clean and free of cruft.</p>\n\n<p>Problem is that it seems that many files in rails, like Gemfile use ruby syntax, but don't use the .rb suffix, e.g., Gemfile, so I have to turn on ruby-mode for each file that I encounter.  This doesn't seem like the Emacs way.</p>\n\n<p>I was thinking that there must be a map out there of Rails files and the modes they use out there that I can easily plop into my config, but I can't seem to find it.  Does anyone have any suggestions?  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","integration-testing","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13165975,"title":"Capybara Not Finding Form Fields","body":"<p>I was trying Capybara for the first time and having trouble with it finding my form. I'm using Rspec, Capybara, Rails 3.2.8, and Twitter Bootstrap.</p>\n\n<p>In my test, I had:</p>\n\n<pre><code>before do\n  choose  \"Residential\"\n  choose  \"Storage\"\n  fill_in \"Customer Location\",  with: 30082\n  fill_in \"datepicker\",         with: 2012-12-02\n  fill_in \"Email\",              with: \"jesse@test.com\"\n  fill_in \"Phone\",              with: \"555-555-5555\"\n end\n</code></pre>\n\n<p>And was getting the error:</p>\n\n<pre><code>Failure/Error: choose  \"Residential\"\n   Capybara::ElementNotFound:\n     cannot choose field, no radio button with id, name, or label 'Residential' found\n</code></pre>\n\n<p>In my form, I had (excerpt):</p>\n\n<pre><code>    &lt;%= quote.radio_button :customer_type, \"Residential\"%&gt;\n    &lt;%= quote.label \"Residential\", class:\"radio inline\" %&gt;\n</code></pre>\n\n<p>When I fired up the server, I could see the form and Firebug showed that I had a label named \"Residential\" associated with the form element.</p>\n\n<p>After searching for the problem and finding this post: <a href=\"http://stackoverflow.com/questions/11356161/capybara-not-finding-form-elements/13165829#13165829\">Capybara not finding form elements</a> (among others), I couldn't figure out why it wasn't working.</p>\n"},{"tags":["ruby-on-rails","git","amazon-s3","rake"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13165460,"title":"Sync-ing files in Rails repo to S3","body":"<p>I am thinking of implementing a rake task that would sync certain files in my repository to S3. The catch is that I only want to update the files when they are changed in my Repo. So if file A gets modified and B stays the same, only file A will be synchronized to S3 during my next app deploy. </p>\n\n<p>What is a reliable way to determine that a file has been modified? I am thinking of using <code>git</code> to determine whether the file has been changed locally.... is there any other way to do this? Does S3 provide similar functionality to this?</p>\n"},{"tags":["ruby-on-rails","capybara"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":217,"score":0,"question_id":11356161,"title":"Capybara not finding form elements","body":"<p>It is the first time I'm trying out Capybara, and I can't seem to find why it can't find my form elements. </p>\n\n<p>Every time I try to find a form element,</p>\n\n<pre><code>When /^they submit a resolution in Markdown$/ do\n  visit \"/resolutions/new\"\n  fill_in \"title\", :with =&gt; \"Title\"\n  fill_in \"libelle\", :with =&gt; \"Some text here\\n\\nNew paragraph\"\n  click_button \"Submit\"\nend\n</code></pre>\n\n<p>it has no clue where it is,</p>\n\n<pre><code>Scenario: Submission of a resolution                 # features/resolutions.feature:5\n    Given the user is a member                       # features/step_definitions/user_steps.rb:26\n    When they submit a resolution in Markdown        # features/step_definitions/resolution_steps.rb:8\n      cannot fill in, no text field, text area or password field with id, name, or label 'title' found (Capybara::ElementNotFound)\n      (eval):2:in `fill_in'\n      ./features/step_definitions/resolution_steps.rb:10:in `/^they submit a resolution in Markdown$/'\n      features/resolutions.feature:7:in `When they submit a resolution in Markdown'\n</code></pre>\n\n<p>even though it is present on the page</p>\n\n<pre><code>&lt;%= form_for(@resolution) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :libelle %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :libelle %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit \"Submit\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and it seems to have rendered correctly.</p>\n\n<pre><code>Started GET \"/resolutions/new\" for 127.0.0.1 at 2012-07-06 00:47:24 -0400\n  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m\n  [1m[35m (0.2ms)[0m  UPDATE \"users\" SET \"last_sign_in_at\" = '2012-07-06 04:47:24.980196', \"current_sign_in_at\" = '2012-07-06 04:47:24.980196', \"last_sign_in_ip\" = '127.0.0.1', \"current_sign_in_ip\" = '127.0.0.1', \"sign_in_count\" = 1, \"updated_at\" = '2012-07-06 04:47:24.980658' WHERE \"users\".\"email\" = 'alexandre@membres.jndq.ca'\n  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m\nProcessing by ResolutionsController#new as HTML\n  Rendered resolutions/_form.html.erb (3.8ms)\n  Rendered resolutions/new.html.erb within layouts/application (4.9ms)\nCompleted 200 OK in 18ms (Views: 7.9ms | ActiveRecord: 0.2ms)\n  [1m[35m (0.2ms)[0m  rollback transaction\n  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m\n  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1\n  [1m[36mUser Exists (0.1ms)[0m  [1mSELECT 1 FROM \"users\" WHERE \"users\".\"email\" = 'normand@pq.ui' LIMIT 1[0m\n  [1m[35mSQL (0.3ms)[0m  INSERT INTO \"users\" (\"authentication_token\", \"clearance\", \"confirmation_sent_at\", \"confirmation_token\", \"confirmed_at\", \"created_at\", \"current_sign_in_at\", \"current_sign_in_ip\", \"email\", \"facebook_uid\", \"id\", \"last_sign_in_at\", \"last_sign_in_ip\", \"name\", \"parent\", \"remember_created_at\", \"sign_in_count\", \"unconfirmed_email\", \"updated_at\") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [[\"authentication_token\", nil], [\"clearance\", 9], [\"confirmation_sent_at\", nil], [\"confirmation_token\", nil], [\"confirmed_at\", nil], [\"created_at\", Fri, 06 Jul 2012 04:47:25 UTC +00:00], [\"current_sign_in_at\", nil], [\"current_sign_in_ip\", nil], [\"email\", \"normand@pq.ui\"], [\"facebook_uid\", nil], [\"id\", nil], [\"last_sign_in_at\", nil], [\"last_sign_in_ip\", nil], [\"name\", \"Normand Portequi\"], [\"parent\", nil], [\"remember_created_at\", nil], [\"sign_in_count\", 0], [\"unconfirmed_email\", nil], [\"updated_at\", Fri, 06 Jul 2012 04:47:25 UTC +00:00]]\n  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m\n</code></pre>\n\n<p>It seems something obvious, but I can't find it. I had found <a href=\"http://stackoverflow.com/questions/3642467/how-to-solve-a-capybaraelementnotfound-error\">this question</a>, but the answer was quite useless. Even after reviewing <a href=\"https://github.com/RailsApps/rails3-devise-rspec-cucumber/tree/master/features\" rel=\"nofollow\">the Devise+Cucumber example app</a>, I can't find what's wrong.</p>\n\n<p>This is killing me and my tests. Any ideas?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":300,"score":1,"question_id":9454595,"title":"How to customize Rails 3 STI column name","body":"<p>I have a class named <code>Post</code>:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>I have a class named <code>Question</code> that inheriting from <code>Post</code>:</p>\n\n<pre><code>class Question &lt; Post\nend\n</code></pre>\n\n<p>and I have a class named <code>Answer</code> that also inheriting from 'Post':</p>\n\n<pre><code>class Answer &lt; Post\nend\n</code></pre>\n\n<p>In <code>Post</code>, I have a column named <code>post_type_id</code> and its' type is <code>Integer</code>.<br>\nHow do I use STI and specific column name &amp; type to inherit from Post? <code>0</code> means <code>Question</code> and <code>1</code> means <code>Answer</code>. (0 &amp; 1 is the value of <code>post_type_id</code> in posts table)</p>\n"},{"tags":["ruby-on-rails","validation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":267,"score":1,"question_id":3183599,"title":"How do I set a Rails validation to ensure that two attributes can't have the same value?","body":"<p>I have a form on my site that lets users direct a message at other users, but I want to ensure that they can't direct a message at themselves.</p>\n\n<p>The class has attributes :username and :target_user, and I just want to set a validation that checks to make sure that these attributes can't have the same value, before anything gets saved.</p>\n\n<p>I figured it would look something like this:</p>\n\n<pre><code>validates_presence_of :user_id, :username, :target_user, :message, :tag\n\nvalidate :username != :target_user\n</code></pre>\n\n<p>But clearly don't know enough Ruby to do it correctly.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13165632,"title":"Ruby on Rails Michael Hartl Tutorial Chapter 11.34 Test Failure","body":"<p>I working with Michael Hartl's Tutorial. Currently I am at chapter 11. When I try to run test I get a bunch of failures. There are two main types of those failures. </p>\n\n<p>Type one:</p>\n\n<pre><code>   1) User pages following/followers followed users\n   Failure/Error:sign_in user_path ActionController::RoutingError:No route matches   \n   {:action=&gt;\"show\", :controller=&gt;\"users\"}\n   # ./spec/requests/user_pages_spec.rb:212:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Type two:</p>\n\n<pre><code>    4) User pages profile page follow/unfollow buttons following a user should    \n    increment the followed user count Failure/Error: click_button \"Follow\"    \n    ActionView::Template::Error: undefined local variable or method `delete' for       \n    #&lt;#&lt;Class:0x34d6760&gt;:0x432b430&gt;  \n    # ./app/views/users/_unfollow.html.erb:2:in `_app_views_users__unfollo\n    w_html_erb__638319985_35260668'\n    # ./app/views/users/_follow_form.html.erb:4:in `_app_views_users__foll\n    ow_form_html_erb__246041490_26030676'\n    # ./app/views/users/show.html.erb:16:in `_app_views_users_show_html_er\n    b__788500174_27727548'\n    # (eval):2:in `click_button'\n    # ./spec/requests/user_pages_spec.rb:92:in `block (6 levels) in &lt;top (required)&gt;'\n    # ./spec/requests/user_pages_spec.rb:91:in `block (5 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Here's the resault of the rake routes:</p>\n\n<pre><code>   following_user GET    /users/:id/following(.:format) users#following\n   followers_user GET    /users/:id/followers(.:format) users#followers\n            users GET    /users(.:format)               users#index\n                  POST   /users(.:format)               users#create\n         new_user GET    /users/new(.:format)           users#new\n        edit_user GET    /users/:id/edit(.:format)      users#edit\n             user GET    /users/:id(.:format)           users#show\n                  PUT    /users/:id(.:format)           users#update\n                  DELETE /users/:id(.:format)           users#destroy\n         sessions POST   /sessions(.:format)            sessions#create\n      new_session GET    /sessions/new(.:format)        sessions#new\n          session DELETE /sessions/:id(.:format)        sessions#destroy\n       microposts POST   /microposts(.:format)          microposts#create\n        micropost DELETE /microposts/:id(.:format)      microposts#destroy\n    relationships POST   /relationships(.:format)       relationships#create\n     relationship DELETE /relationships/:id(.:format)   relationships#destroy\n             root        /                              static_pages#home\n           signup        /signup(.:format)              user#new\n           signin        /signin(.:format)              sessions#new\n          signout DELETE /signout(.:format)             sessions#destroy\nstatic_pages_home        /static_pages/home(.:format)   static_pages#home\n             help        /help(.:format)                static_pages#help\n            about        /about(.:format)               static_pages#about\n          contact        /contact(.:format)             static_pages#contact\n</code></pre>\n\n<p>I've stucked on this problem for about a week.   Anybody got any idea? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","amazon-s3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13149240,"title":"Ruby aws-sdk - timeout error","body":"<p>I am trying to upload a file to S3 with the following simple code:</p>\n\n<pre><code>bucket.objects.create(\"sitemaps/event/#{file_name}\", open(file))\n</code></pre>\n\n<p>I get the following:</p>\n\n<p><strong>Your socket connection to the server was not read from or written to within the timeout period. Idle connections will be closed.</strong></p>\n\n<p>What could be going wrong?  Any tips will be appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13119188,"title":"require 'debugger' => LoadError. Why?","body":"<p><strong>Context</strong></p>\n\n<pre><code>ruby 1.9.2p323 (2012-05-22 revision 35755) [x86_64-darwin11.4.0]\n\nrvm 1.16.6\n\ngemsets for ruby-1.9.2-head \n   (default)\n   global\n=&gt; rails321\n</code></pre>\n\n<hr>\n\n<p><strong>Trace</strong></p>\n\n<pre><code>$ gem install 'debugger'\nBuilding native extensions.  This could take a while...\nSuccessfully installed debugger-1.2.1\n\n$ bundle show debugger\n/Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-1.2.1\n\n$ irb\n&gt; require 'debugger'\nLoadError: no such file to load -- trace_nums\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-linecache-1.1.2/lib/tracelines19.rb:3:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-linecache-1.1.2/lib/linecache19.rb:65:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-1.2.1/lib/ruby-debug-base.rb:2:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-1.2.1/lib/ruby-debug.rb:5:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-1.2.1/lib/debugger.rb:4:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n    from (irb):1\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/bin/irb:16:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hyperlink","download","link-to"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13164063,"title":"file download link in rails","body":"<p>I would like to give visitors the option to download some pdf. \nI have tried:</p>\n\n<pre><code>&lt;%= link_to \"abc\", \"/data/abc.pdf\"%&gt;\n\n&lt;%= link_to \"abc\", \"/data/abc.pdf\", :format =&gt; 'pdf' %&gt;\n</code></pre>\n\n<p>and some variations but they don't seem to work. I keep getting <code>No route matches [GET] \"/data/abc.pdf\"</code></p>\n\n<p>I have the pdf files in a folder called data, located in the assets folder.\nAny help would be appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13146839,"title":"Accessing/setting nested value with a form","body":"<p>I have 30k+ documents in my database with this structure:</p>\n\n<pre><code>{\n  ...,\n  \"hours\" : {\n    \"holiday\" : {\n      \"New Years\" : \"Call\",\n      \"Easter\" : \"Closed\",\n      \"Memorial Day\" : \"Standard\",\n      \"Independence Day\" : \"Standard\",\n      \"Labor Day\" : \"Standard\",\n      \"Thanksgiving\" : \"Closed\",\n      \"Day After Thanksgiving\" : \"Call\",\n      \"Christmas Eve\" : \"Call\",\n      \"Christmas\" : \"Closed\",\n      \"New Years Eve\" : \"Call\"\n    },\n    \"standard\" : {\n      \"mon\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"tue\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"wed\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"thu\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"fri\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"sat\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"sun\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"10:00 pm\"\n      }]\n    }\n  },\n  ...\n}\n</code></pre>\n\n<p>I am doing a complete rewrite from a php-driven site.  I have been racking my brain and absolutely cannot come up with a way to make a form field that will allow me to set business.hours[\"standard\"][\"mon\"] properly.  The site offers multiple open/close entries per day, for businesses that close for lunch, etc.  That attribute would be set to [{\"open\" : \"8:00 am\", \"close\" : \"12:00 pm},{\"open\" : \"1:00 pm\", \"close\" : \"5:00 pm}] in such a case.  I would like to offer two select boxes for each entry, one for open time and one for close time.  </p>\n\n<p>Here is my Model. including some getters/setters that I was attempting to figure out how to tie into my form...unsuccessfully.</p>\n\n<pre><code>class Business\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  field :ad, type: String\n  field :address, type: String\n  field :city, type: String\n  field :claimed, type: Boolean\n  field :coupons, type: String\n  field :created_at, type: DateTime\n  field :extra_services, type: Array\n  field :hours, type: Hash\n  field :name, type: String\n  field :organization, type: String\n  field :permanently_closed, type: Boolean, :default =&gt; false\n  field :phone, type: String\n  field :state, type: String\n  field :tags, type: Array\n  field :unit, type: String\n  field :updated_at, type: DateTime\n  field :website, type: String\n  field :zip, type: String\n\n  attr_accessible :ad, :address, :city, :claimed, :coupons, :created_at, :updated_at, :extra_services, :hours,\n                  :name, :organization, :permanently_closed, :phone, :state, :tags, :unit, :website, :zip\n\n  index({address: 1, unit: 1, city: 1, state: 1, zip: 1, organization: 1}, {unique: true, name: \"address_unique_index\"})\n\n  after_initialize do |b|\n    b.hours = Hash.new unless b.hours\n    b.hours[\"holiday_hours\"] = {\"New Years\" =&gt; \"Call\",\n                                \"Easter\" =&gt; \"Call\",\n                                \"Memorial Day\" =&gt; \"Call\",\n                                \"Independence Day\" =&gt; \"Call\",\n                                \"Labor Day\" =&gt; \"Call\",\n                                \"Thanksgiving\" =&gt; \"Call\",\n                                \"Day After Thanksgiving\" =&gt; \"Call\",\n                                \"Christmas Eve\" =&gt; \"Call\",\n                                \"Christmas\" =&gt; \"Call\",\n                                \"New Years Eve\" =&gt; \"Call\"} unless b.hours[\"holiday_hours\"]\n\n    b.hours[\"standard_hours\"] = Hash.new unless b.hours[\"standard_hours\"]\n  end\n\n  def holiday_hours\n    hours[\"holiday_hours\"] if hours[\"holiday_hours\"]\n  end\n\n  def holiday_hours=(hours)\n    self.hours[\"holiday_hours\"] = hours if hours.present?\n  end\n\n  def holiday_hours_for(holiday)\n    hours[\"holiday_hours\"][holiday.to_s] if hours[\"holiday_hours\"][holiday.to_s]\n  end\n\n  def update_holiday_hours_for(holiday, hours_text)\n    self.hours = Hash.new unless hours\n    self.hours[\"holiday_hours\"] = Hash.new unless hours[\"holiday_hours\"]\n    self.hours[\"holiday_hours\"][holiday.to_s] = hours_text.to_s\n  end\n\n  def standard_hours\n    hours[\"standard_hours\"] if hours[\"standard_hours\"]\n  end\n\n  def standard_hours_for(day)\n    hours[\"standard_hours\"][day.to_s] if hours[\"standard_hours\"][day.to_s]\n  end\nend\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","money","sanitize"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12692630,"title":"Sanitize helper causing an error in Money gem in Rails 3","body":"<p>Calling \"sanitize\" method on anything causes a missing method error in Rails 3 with Collective Idea's <a href=\"https://github.com/collectiveidea/money\" rel=\"nofollow\">Money</a> Gem</p>\n\n<pre><code>sanitize \"trololo\"\n</code></pre>\n\n<p>=></p>\n\n<pre><code>undefined method `id2name' for {:instance_writer=&gt;false}:Hash\n\ncollectiveidea-money (1.7.4) lib/support/cattr_accessor.rb:7:in `block in cattr_reader'\ncollectiveidea-money (1.7.4) lib/support/cattr_accessor.rb:5:in `each'\ncollectiveidea-money (1.7.4) lib/support/cattr_accessor.rb:5:in `cattr_reader'\ncollectiveidea-money (1.7.4) lib/support/cattr_accessor.rb:54:in `cattr_accessor'\nactionpack (3.2.8) lib/action_controller/vendor/html-scanner/html/sanitizer.rb:48:in `&lt;class:LinkSanitizer&gt;'\nactionpack (3.2.8) lib/action_controller/vendor/html-scanner/html/sanitizer.rb:47:in `&lt;module:HTML&gt;'\nactionpack (3.2.8) lib/action_controller/vendor/html-scanner/html/sanitizer.rb:5:in `&lt;top (required)&gt;'\nactionpack (3.2.8) lib/action_view/helpers/sanitize_helper.rb:174:in `white_list_sanitizer'\nactionpack (3.2.8) lib/action_view/helpers/sanitize_helper.rb:60:in `sanitize'\n</code></pre>\n\n<p>Has anyone experienced this error before? </p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13162501,"title":"dealing with form object when rendering partial via rjs","body":"<p>I have a form where based on the value selected by the user in a drop down list, the rest of the form is displayed via a partial.</p>\n\n<p><strong>Model:</strong></p>\n\n<pre><code>Book has many supplierdetails\nSupplierdetails belongs to Book\n</code></pre>\n\n<p><strong>form code</strong></p>\n\n<pre><code>&lt;% fields_for @book do |f| %&gt;\n\n\n Catalogue Number: &lt;%= f.text_field :BK_CAT_NUM %&gt;\n\n  &lt;% f.fields_for :supplierdetails do |builder| %&gt;\n   Supplier Type:\n    &lt;%= builder.select(:SUP_TYPE, \n         [['A', 'A'],\n          ['B', 'B'],\n        ],{ :prompt =&gt; \"Please select\"}       \n      ) %&gt;\n\n\n    &lt;%= observe_field(\"book_supplierdetails_attributes_0_SUP_TYPE\", \n      :url =&gt; { :controller =&gt; 'books', :action =&gt; :display_ab_details },\n      :with =&gt; \"'id='+value\") %&gt;\n\n    &lt;div id=\"div1\"&gt;  &lt;/div&gt;\n\n\n\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>controller method</strong></p>\n\n<pre><code>  def display_ab_details\n    supplier_type = params[:id]\n    if supplier_type == \"A\"\n      render :update do |page|\n        page['div1'].replace_html :partial =&gt; 'books/test_partial'\n      end\n    end\n  end\n</code></pre>\n\n<p><strong>books/_test_partial.html.erb</strong></p>\n\n<pre><code>Production Method: &lt;/label&gt; &lt;%= builder.select(:SUP_PROD_METHOD, [\n        ['prod_1', 'prod_1'],\n        ['prod_2', 'prod_2'],\n      ],{ :prompt =&gt; \"Please select\"}\n    ) %&gt;\n</code></pre>\n\n<p>The partial is not displayed and I believe it is because of the form object.</p>\n\n<p>If 'books/_test_partial.html.erb' contains plain text, it is displayed correcly.</p>\n\n<p>How do I deal with form object when rendering partial via rjs?</p>\n"},{"tags":["ruby-on-rails","git"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":71,"score":-1,"question_id":13163521,"title":"Why is Git committing everything that I have on my computer?","body":"<p>Using Michael Hartl's Ruby on Rails instructions, I typed the following into the command line:</p>\n\n<pre><code>$ git init\n$ git add .\n$ git status\n</code></pre>\n\n<p>The output I got doesn't make sense.  It looks like everything on my computer is being committed, i.e. my web browsing history. </p>\n\n<pre><code># Changes to be committed:\n#   (use \"git reset HEAD &lt;file&gt;...\" to unstage) \n#\n#   modified:   .DS_Store\n#   new file:   .Trash/.DS_Store\n#   modified:   .bash_history\n#   modified:   .gem/specs/rubygems.org%80/latest_specs.4.8\n#   new file:   .gem/specs/rubygems.org%80/quick/Marshal.4.8/treetop-1.4.12.gemspec\n#   new file:   .gem/specs/rubygems.org%80/quick/Marshal.4.8/tzinfo-0.3.34.gemspec \n#   modified:   .gem/specs/rubygems.org%80/specs.4.8\n#   modified:   Desktop/.DS_Store\n#   modified:   Library/Application Support/AddressBook/Metadata/.info\n#   modified:   Library/Application Support/AddressBook/Sources/7A5B88B6-2E8C-44D5-B3C5-96C523D66818/Metadata/.info\n#   modified:   Library/Application Support/CrashReporter/Intervals_31838DA3-3634-5B48-BAA4-074D9844D0AB.plist\n#   modified:   Library/Application Support/Dock/FD847662-EDEA-43DC-8969-18D1DD48507E.db\n#   modified:   Library/Application Support/Sublime Text 2/Settings/Auto Save Session.sublime_session\n#   modified:   Library/Application Support/Ubiquity/peer-0773FD5E-421F-A363-E209-F9D5E42A0F5F-v23/item-info.db\n#   new file:   Library/Caches/Metadata/Safari/Bookmarks/2AD8D7AF-5B59-4BF5-9C80-749756908961.webbookmark\n#   modified:   Library/Caches/Metadata/Safari/History/.tracked filenames.plist\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-282.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-283.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-284.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-285.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-286.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-287.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-288.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-289.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-290.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-291.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-292.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-293.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-294.webhistory\n#   new file:   Library/Caches/Metadata/Safari/History/Safari history item-295.webhistory\n</code></pre>\n\n<p>Before trying to commit, I had ran <code>$ rails server</code> in a different terminal and got the output below:</p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 3.2.8 application starting in development on http://0.0.0.0:3000\n=&gt; Call with -d to detach\n=&gt; Ctrl-C to shutdown server\n[2012-10-31 12:30:26] INFO  WEBrick 1.3.1\n[2012-10-31 12:30:26] INFO  ruby 1.9.3 (2012-10-12) [x86_64-darwin12.2.0]\n[2012-10-31 12:30:26] INFO  WEBrick::HTTPServer#start: pid=3773 port=3000\n\n\nStarted GET \"/assets/rails.png\" for 127.0.0.1 at 2012-10-31 12:52:53 -0400\nConnecting to database specified by database.yml\nServed asset /rails.png - 200 OK (3ms)\n</code></pre>\n\n<p>From a previous question, I know <code>$ rails server</code> will continue to run until I close the terminal window.  Please help!  Why is everything from my computer, including web history being committed to Git?</p>\n"},{"tags":["ruby-on-rails","json"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13163291,"title":"Rails: return error messages with json","body":"<p>My rails app serves as API for my android app.\nI'm wondering when the request encounters any problem, is there a way to detect which error it is on the server side and return with a specific code?</p>\n\n<p>For example, in my <code>users_controller.rb</code>, </p>\n\n<pre><code>if @user.save\n  respond_with(@user)\nelse  \n  render json: {errors: @user.errors.full_messages}\nend\n</code></pre>\n\n<p>The output looks like:</p>\n\n<pre><code>{\"errors\":[\"Username can't be blank\",\"Password is too short (minimum is 6 characters)\",\"Email has already been taken\"]}\n</code></pre>\n\n<p>How can I check whether it is because of an error of email or an error of password in the controller? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","spork","guard"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":227,"score":1,"question_id":10675295,"title":"Rails engine test/dummy with Spork, Guard, RSpec?","body":"<p>I have a Rails gem that I am testing with RSpec.\nMy gem's code is in lib/my_gem, and there is a test application that Rails generated for me when I created the gem, in the folder test/dummy. I have my specs in test/dummy/spec/models/task_spec.rb. I can run these specs fine with the rspec command.</p>\n\n<p>Now I wanted to use Spork and Guard for my testing. I followed RailsCasts <a href=\"http://railscasts.com/episodes/285-spork\" rel=\"nofollow\">http://railscasts.com/episodes/285-spork</a> to install spork in my test/dummy app. It does work but I have 2 issues:</p>\n\n<ul>\n<li>How to make spork reload my lib/my_gem/* files? I tried putting paths like ../../lib/my_gem/... in my Guardfile, but it does not watch/reload the files.</li>\n<li>For some reason, rspec is ignoring my options from spec_helper, for example the \"config.filter_run :focus => true\" line. I did properly put these into Spork.prefork. This setting is working when I run rspec manually with rspec spec/models/task_spec.rb, but it is being ignored when I use guard/spork.</li>\n</ul>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":199,"score":0,"question_id":1665830,"title":"SMS using Rails in India","body":"<p>Is it possible to send SMS in india using rails applcations?  If so, can you provide an example?</p>\n\n<p>I checked for the clickatell but I think it works only in Australia or the UK.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","refactoring"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13146445,"title":"How to refactor complex method in Rails model with Rspec?","body":"<p>I have the following complex method. I'm trying to find and implement possible improvements. Right now I moved last if statement to <code>Access</code> class.</p>\n\n<pre><code>def add_access(access)\n   if access.instance_of?(Access)\n     up = UserAccess.find(:first, :conditions =&gt; ['user_id = ? AND access_id = ?', self.id, access.id])\n     if !up &amp;&amp; company\n       users = company.users.map{|u| u.id unless u.blank?}.compact\n       num_p = UserAccess.count(:conditions =&gt; ['user_id IN (?) AND access_id = ?', users, access.id])\n       if num_p &lt; access.limit\n         UserAccess.create(:user =&gt; self, :access =&gt; access)\n       else\n         return \"You have exceeded the maximum number of alotted permissions\"\n       end\n     end\n   end\n end\n</code></pre>\n\n<p>I would like to add also specs before refactoring. I added first one. How should looks like others?</p>\n\n<pre><code>  describe \"#add_permission\" do\n    before do\n      @permission = create(:permission)\n      @user = create(:user)\n    end\n\n    it \"allow create UserPermission\" do\n      expect {\n        @user.add_permission(@permission)\n      }.to change {\n        UserPermission.count\n      }.by(1)\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","view","popup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13163064,"title":"Ruby on Rails: Alert button on submit press","body":"<p>I have a function where a user can reset their own password by entering their registered email and clicking a button. An email then gets sent to that address.</p>\n\n<pre><code>&lt;div class =\"title\"&gt;Reset your password&lt;/div&gt;\n\n\n\n&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; password_path(resource_name), :html =&gt; { :method =&gt; :post }) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n&lt;div class=\"signup\"&gt;\n  &lt;div class = \"field\"&gt;Email: \n  &lt;%= f.email_field :email, :class =&gt; \"email\" %&gt;&lt;/div&gt;\n\n&lt;/br&gt;\n\n  &lt;div&gt;&lt;%= f.submit \"Send me reset password instructions\", :class =&gt; \"button\", :confirm =&gt; \"An email to reset your password has been sent\" %&gt;&lt;/div&gt;\n&lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>I am wanting a pop up box to show up after they hit the submit button. I have a confirm pop up at the moment, but I am just wanting an alert popup, where the user only has the option to click \"OK\". Can this be done?</p>\n\n<p>I am new to rails, so please remember this when trying to help. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","carrierwave","destroy","dependent"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13162744,"title":"Stack level too deep when trying to destroy a child record","body":"<p>I'm trying to destroy a record that belongs to a parent record. However Rails won't let me do it because of a <code>stack level too deep</code> error.</p>\n\n<p>My classes (simplified) are built like this:</p>\n\n<pre><code>class Album &lt; ActiveRecord::Base\n  has_many :photos, dependent: :destroy\n  accepts_nested_attributes_for :photos, reject_if: lambda { |p| p[:image].blank? }\n\n  ...\nend\n\nclass Photo &lt; ActiveRecord::Base\n  belongs_to :album\n\n  mount_uploader :image, PhotoUploader\nend\n</code></pre>\n\n<p>When I try the following, I get the exception:</p>\n\n<pre><code>Photo.destroy(12) # where 12 is the ID of the photo I want to destroy\n# note that Photo.delete(12) works fine, but doesn't remove the image from the file system\n</code></pre>\n\n<p>I don't understand why destroying the photo would trigger this error. Maybe it's <code>carrierwave</code> with its <code>mount_uploader</code>?</p>\n\n<p><strong>EDIT 1:</strong> This has definitely something to do with <code>carrierwave</code>. In my uploader I have the following code which gets called many many times (until the stack is too deep):</p>\n\n<pre><code>def unprocessed_image_filename\n  match_data = /^original_(.+)_\\d{14}\\.\\D{3,4}$/.match(File.basename(model.image.to_s))\n\n  match_data ? match_data[1] : \"photo\"\nend\n</code></pre>\n\n<p>This is used to determine the name of the various versions.</p>\n"},{"tags":["ruby-on-rails","ruby","sorting","filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":299,"score":0,"question_id":10952449,"title":"Filtering and sorting a rails app","body":"<p>I currently have a deployed app (fortworth.herokuapp.com) that I am attempting to sort movies by titles and release dates as well as filter by ratings.</p>\n\n<p>I solved the problem of being able to filter (click the checkboxes then hit refresh - the page starts out empty). However, I also want to sort these movies. Right now when you click on 'Title' or 'Release Date' all of the movies disappear. </p>\n\n<p>In <code>movies_controller#index</code> I believe I should set up the <code>session[]</code> hash to remember the settings. My <code>link_to</code> methods for the title and release dates are as follows: </p>\n\n<pre><code>link_to title, {:sort =&gt; column}\n</code></pre>\n\n<p>How do I go about implementing the session[] hash in order to remember the movies that were selected before I sort?</p>\n"},{"tags":["ruby-on-rails","associations","has-many-through"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13162628,"title":"How to get the through instance in a has_many :through relation","body":"<p>I have a has_many :through relation models like:</p>\n\n<pre><code>#foo\nhas_many :bars, through: link\nhas_many :links\n\n#link\nbelongs_to :bar\nbelongs_to :foo\n\n#bar\nhas_many :foos, through: link\nhas_many :links\n</code></pre>\n\n<p>In a situation where I have a instance of a <code>foo</code> and a instance of a <code>bar</code> how can I get the specific <code>link</code> instance that joins the two together(if it exists)?</p>\n"},{"tags":["ruby-on-rails","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13161189,"title":"mongoid issue with _id field","body":"<p>I need the following code to run on all of my models:</p>\n\n<pre><code>def as_json(options={})\n    attrs = super(options)\n    attrs[\"id\"] = self.persisted? ? self._id : nil\n    attrs\n  end\n</code></pre>\n\n<p>when I put it like this on another file :</p>\n\n<pre><code> module Mongoid\nmodule Document\n  def as_json(options={})\n    attrs = super(options)\n    attrs[\"id\"] = self.persisted? ? self._id : nil\n    attrs\n  end\nend\nend\n</code></pre>\n\n<p>and add it to the autoload path it doesn't get there, so this is my problem now, started from this q:</p>\n\n<p>I found this post <a href=\"http://blog.joshdzielak.com/blog/2011/12/24/tame-the-mongoid-id-field-in-your-rails-and-backbone-js-app/\" rel=\"nofollow\">http://blog.joshdzielak.com/blog/2011/12/24/tame-the-mongoid-id-field-in-your-rails-and-backbone-js-app/</a> \nIts relevant to my problem, I want to apply the server side solution but my code doesnt reach this point here is my code :</p>\n\n<pre><code> if @campaign.save\n  respond_with(@campaign, status: :created, location: @campaign)\n</code></pre>\n\n<p>I need the campaign to return id field instead of _id field</p>\n\n<p>Version: 3.0.9</p>\n\n<p>response has _id:\"sdfsdfsdfsf\"</p>\n\n<p>I want response with id:\"sdfsdfsdf\"</p>\n\n<p>The format is json</p>\n"},{"tags":["ruby-on-rails","paperclip"],"answer_count":6,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":2414,"score":4,"question_id":10033425,"title":"Paperclip exception : Paperclip::AdapterRegistry::NoHandlerError","body":"<p>Using Paperclip 3.0.1 in rails 3.2.2 I got this error:</p>\n\n<pre><code>**Paperclip::AdapterRegistry::NoHandlerError** \n(No handler found for \"2009-11-29-133527.jpg\"):\n</code></pre>\n\n<p>In my model I have: </p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n    ...\n    has_many :assets \n    accepts_nested_attributes_for :assets\n end\n\n class Asset &lt; ActiveRecord::Base\n     belongs_to :product\n     has_attached_file :image,\n               :path =&gt; \":rails_root/public/system/:attachment/:id/:style/:filename\",\n               :url =&gt; \"/system/:attachment/:id/:style/:filename\", \n               :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\n  end\n</code></pre>\n\n<p>The exception is raised at:</p>\n\n<pre><code>def create\n     **@product = Product.new params[:product]**\n     ...\nend\n</code></pre>\n\n<p>with params: </p>\n\n<pre><code>{...,\n \"product\"=&gt;{\"title\"=&gt;\"wibble1\", \n             **\"assets_attributes\"=&gt;{\"0\"=&gt;{\"image\"=&gt;\"2009-11-29-133527.jpg\"}\n                                  },** \n             \"description\"=&gt;\"Who is wibble...\", \n             \"price\"=&gt;\"23.45\"\n            }, \n             \"commit\"=&gt;\"Create Product\", \n             ...}\n</code></pre>\n\n<p>Anyone know what's going on?</p>\n"},{"tags":["ruby-on-rails","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13161712,"title":"\"This account is currently not available\" when running \"cap deploy:setup\" command","body":"<p>I want to deploy Ruby on Rails web site and using Capistrano for this purpose.</p>\n\n<p>After  I had filled in the deploy.rb file and ran <code>cap deploy:setup</code> this is what I got</p>\n\n<pre><code>C:\\Sites\\blog&gt;cap deploy:setup\n  * ←[32m2012-10-31 15:39:22 executing `deploy:setup'←[0m\n  * ←[33mexecuting \"mkdir -p /var/www/blog /var/www/blog/releases /var/www/blog/\nshared /var/www/blog/shared/system /var/www/blog/shared/log /var/www/blog/shared\n/pids\"←[0m\n    servers: [\"188.121.54.128\"]\nPassword:\n    [188.121.54.128] executing command\n ** [out :: 188.121.54.128] This account is currently not available.\n    ←[2;37mcommand finished in 153ms←[0m\nfailed: \"sh -c 'mkdir -p /var/www/blog /var/www/blog/releases /var/www/blog/shar\ned /var/www/blog/shared/system /var/www/blog/shared/log /var/www/blog/shared/pid\ns'\" on 188.121.54.128\n\nC:\\Sites\\blog&gt; \n</code></pre>\n\n<p>Any suggestions on what might be going wrong?</p>\n"},{"tags":["ruby-on-rails","image","upload","carrierwave"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":3287,"score":6,"question_id":5132426,"title":"Reprocessing images of different versions in Carrierwave","body":"<p>Using Carrierwave, I created 3 versions of an avatar - an original, a small_thumb and a large_thumb using the following lines:</p>\n\n<pre><code>process :resize_to_limit =&gt; [400, 400]  \n\n   version :big_thumb do\n     process :resize_to_limit =&gt; [80, 80]\n   end\n\n   version :small_thumb do\n     process :resize_to_limit =&gt; [50, 50]\n   end\n</code></pre>\n\n<p>I added an additional method in my AvatarUploader class:</p>\n\n<pre><code>def reprocess(x,y,w,h)\n        manipulate! do |img|\n            img.crop(x.to_i, y.to_i, w.to_i, h.to_i, true) \n\n            end\nresize_to_limit(180,180)  \nend\n</code></pre>\n\n<p>which is called in my model after an update is performed:</p>\n\n<pre><code>attr_accessor :crop_x, :crop_y, :crop_w, :crop_h\nafter_update :reprocess_image, :if =&gt; :cropping?\n\ndef cropping?\n    !crop_x.blank? &amp;&amp; !crop_y.blank? &amp;&amp; !crop_w.blank? &amp;&amp; !crop_h.blank?\nend\n\nprivate\n\ndef reprocess_image\nimage.reprocess(crop_x,crop_y,crop_w,crop_h)\n\nend\n</code></pre>\n\n<p>I have managed to crop and resize the original version, but I can't seem to update the 2 thumbnails along with it.  I tried a few different techniques to no avail.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","gem","actionview"],"answer_count":4,"favorite_count":7,"up_vote_count":13,"down_vote_count":0,"view_count":2023,"score":13,"question_id":5791211,"title":"How do I extract Rails view helpers into a gem?","body":"<p>I have a set of rails view helpers that I use regularly, and would like to package them up into a gem, such that I could just put a line in my Gemfile, and have the helpers accessible from my views.</p>\n\n<p>I have created gems before using Bundler, and Jeweler, however, I'm not all all clear on how to organize the Rails view helpers in a gem, and include them into rails.</p>\n\n<p>I would appreciate any pointers, or links to up-to-date tutorials on how to do this for Rails 3</p>\n\n<p>Thanks</p>\n\n<p>Just to clarify:  The question isn't on \"how to create a gem\".  Its \"how to package view helpers in a gem, so I can use them in Rails\"</p>\n\n<p>Edit 2:\nI also agree with the poster below..  A rails engine is waay too much overkill for this kind of (hopefully simple) requirement</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13070658,"title":"First or limit in Rails scope","body":"<p>I have the following scope:</p>\n\n<pre><code>scope :user_reviews, lambda { |user| where(:user_id =&gt; user) }\n</code></pre>\n\n<p>I apply this in the controller:</p>\n\n<pre><code>def show\n  @review = @reviewable.reviews.user_reviews(current_user).first || Review.new\nend\n</code></pre>\n\n<p>The <code>first</code> is to limit to search the current user's one and only review. Now I try to write a new scope <code>user_review</code> which I tried many ways to chain the <code>user_reviews</code> scope with <code>first</code>, but just couldn't get it what. Something like this:</p>\n\n<pre><code>scope :user_reviews, lambda { |user| where(:user_id =&gt; user) }\nscope :user_review, lambda { |user| user_reviews(user).first }\n</code></pre>\n\n<p>I know the above <code>user_review</code> is wrong, but just trying to show you guys what I am trying to do.</p>\n\n<p>How should I write this properly?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","database","image","carrierwave","engine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13161791,"title":"Rails / image not being saved when Carrierwave is mounted","body":"<p>I am using the Carrierwave plugin to upload images. It works fine, but if I try to save an image from the controller using </p>\n\n<pre><code>Article.create(:image =&gt; 'sample.png')\n</code></pre>\n\n<p>It doesent save the image as long as carrierwave is mounted, if I un-mount Rails will save the image like normal.. How can I solve this ? </p>\n\n<p>Jakob</p>\n"},{"tags":["ruby-on-rails","ajax","forms","haml","rails-3-upgrade"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":4610,"score":6,"question_id":3890315,"title":"Rails 3: undefined method `remote_form_for'","body":"<p>I have a fairly simple Rails remote form in HAML in a partial under shared/users:</p>\n\n<pre><code>- remote_form_for :user, :url =&gt; { :controller =&gt; \"users\", :action =&gt; \"create\" } do |f|\n  .field\n    = f.label :name, t('name')\n    = f.text_field :name\n  .field\n    = f.label :email, t('email')\n    = f.text_field :email\n  .actions\n    = f.submit\n</code></pre>\n\n<p>No matter how much I fiddle with it, this just won't work. I alway get the following error:</p>\n\n<pre><code>undefined method `remote_form_for' for #&lt;#&lt;Class:0x1036e8e40&gt;:0x1036dfd90&gt;\n</code></pre>\n\n<p>Am I doing something stupid? It works perfectly with form_for.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13161717,"title":"Do not run ruby code in render :file","body":"<p>I'm trying to render an HTML file using <code>render :file</code> in my view, but the problem is, if this .html file contains any ruby code, it'll end up being executed and that is something I'm trying to avoid.</p>\n\n<p>Is there a way to do that?</p>\n"},{"tags":["ruby-on-rails","ruby","statemachine"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13161802,"title":"get list of final state_machine states","body":"<p>There is a method in the StateMachine library <a href=\"http://stackoverflow.com/questions/4138437/get-list-of-state-machine-states\">to get the list of states</a>:</p>\n\n<pre><code>ModelName.state_machines[:name_of_state].states.map &amp;:name\n</code></pre>\n\n<p>or </p>\n\n<pre><code>ModelName.state_machines.states.map &amp;:name\n</code></pre>\n\n<p>when the name of the attribute containing state is the default \"state\".</p>\n\n<p>However, I was wondering whether there's a way to find the final statemachine, since if you draw them with </p>\n\n<pre><code>rake state_machine:draw FILE=model.rb CLASS=ModelName\n</code></pre>\n\n<p>the final states are double-circled.\nI was not able to get it from the rake task's source at first sight.</p>\n\n<p>Getting the initial states seems to be easy:</p>\n\n<pre><code>ModelName.state_machines[:name_of_state].states.select(&amp;:initial).map(&amp;:name)\n</code></pre>\n\n<p><strong>Update</strong>:</p>\n\n<p>Oh, drats!  It is as easy as:</p>\n\n<pre><code>ModelName.state_machines[:name_of_state].states.select(&amp;:final?).map(&amp;:name)\n</code></pre>\n\n<p>Left here for future Googlers!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13161554,"title":"How to set a blank input form?","body":"<p>I want to create a form where a user is able to update his/her email and password.</p>\n\n<pre><code>&lt;%= form_for @customer do |c| %&gt;\n    &lt;%= c.label :email%&gt;\n    &lt;%= c.text_field :email%&gt;\n    &lt;%= c.label :email_confirmation %&gt;\n    &lt;%= c.text_field :email_confirmation%&gt;\n    &lt;%= c.label :password%&gt;\n    &lt;%= c.password_field :password%&gt;\n    &lt;%= c.label :password_confirmation%&gt;\n    &lt;%= c.password_field :password_confirmation%&gt;\n    &lt;%= c.submit(\"Edit profile\")%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem is that I don't want them to be filled in when just looking at it.\nSo it should have something like:</p>\n\n<pre><code>Email [blank]\nEmail confirmation [blank]\nPassword [blank]\nPassword confirmation [blank]\n</code></pre>\n\n<p>So how do I have this to be blank in stead of pre-filled in by Rails?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","jruby","testunit","minitest"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13074099,"title":"Can't run Minitest/TestUnit tests in JRuby 1.7.0","body":"<p>We just switched our small project to <strong>JRuby 1.7.0</strong> and had a similar\nexperience under <strong>1.7.0.RC2</strong>. I'm trying to simply run <code>rake test</code> (as well\nas running my tests under guard) but my test files look to be never found. I\nonly get...</p>\n\n<pre><code>Loaded Suite test,test/factories,test/unit\n\nStarted at 2012-10-25 13:28:15 -0400 w/ seed 9431.\n\nFinished in 0.004000 seconds.\n\n0 tests, 0 passed, 0 failures, 0 errors, 0 skips, 0 assertions\n</code></pre>\n\n<p>Here is my <code>test/test_helper.rb</code> file.</p>\n\n<pre><code>ENV[\"RAILS_ENV\"] = \"test\"\nrequire File.expand_path('../../config/environment', __FILE__)\nrequire 'rails/test_help'\n\nrequire 'minitest/autorun'\nrequire 'factory_girl_rails'\nrequire 'mocha'\n\nclass ActiveSupport::TestCase\n  fixtures :all\nend\n</code></pre>\n\n<p>Currently it doesn't matter what I put in my a <code>test/unit/random_test.rb</code> test\nfile. The files aren't being loaded by <code>rake</code>, so even putting invalid Ruby\nwon't result in an exception.</p>\n\n<p>Hopefully someone can point me in the right direction.</p>\n\n<p>Edit:</p>\n\n<p>The following is a trace of the <code>rake test:units</code> task being run from an app that is running tests under JRuby.</p>\n\n<pre><code>$ rake test:units --trace\nio/console not supported; tty will not be manipulated\n** Invoke test:prepare (first_time)\n** Invoke db:test:prepare (first_time)\n** Invoke db:abort_if_pending_migrations (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Invoke db:load_config (first_time)\n** Execute db:load_config\n** Execute db:abort_if_pending_migrations\n** Execute db:test:prepare\n** Invoke db:test:load (first_time)\n** Invoke db:test:purge (first_time)\n** Invoke environment \n** Invoke db:load_config \n** Execute db:test:purge\n** Execute db:test:load\n** Invoke db:test:load_schema (first_time)\n** Invoke db:test:purge \n** Execute db:test:load_schema\n** Invoke db:schema:load (first_time)\n** Invoke environment \n** Invoke db:load_config \n** Execute db:schema:load\n** Execute test:prepare\n** Execute test:units\nio/console not supported; tty will not be manipulated\nRun options: \n\n# Running tests:\n\n.\n\nFinished tests in 0.517000s, 1.9342 tests/s, 1.9342 assertions/s.\n\n1 tests, 1 assertions, 0 failures, 0 errors, 0 skips\n$ \n</code></pre>\n\n<p>For the app that's not working, I tried the same and received the following error.</p>\n\n<pre><code>rake aborted!\nDon't know how to build task 'test:units'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/task_manager.rb:49:in `[]'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:115:in `invoke_task'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'\norg/jruby/RubyArray.java:1612:in `each'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/bin/rake:33:in `(root)'\norg/jruby/RubyKernel.java:1045:in `load'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/bin/rake:1:in `(root)'\norg/jruby/RubyKernel.java:1065:in `eval'\n/Users/someone/.rvm/gems/jruby-1.7.0@rails-app/bin/ruby_noexec_wrapper:14:in `(root)'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","mocking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13160324,"title":"How to stub after_create callback save! in model?","body":"<p>I receive following error:</p>\n\n<p>Output:</p>\n\n<pre><code>1) LabelsController#create label is new creates a new label\n   Failure/Error: post :create, attributes[:label], format: :json\n   NoMethodError:\n     undefined method `save!' for nil:NilClass\n   # ./app/models/labeling.rb:17:in `update_target'\n</code></pre>\n\n<p>In Labeling model:</p>\n\n<pre><code>after_create :update_target\n\ndef update_target\n   self.target.save!\nend\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>require 'spec_helper'\ndescribe LabelsController do\n  before(:each) do\n    controller.stub(:current_user).and_return(mock_model(User))\n    stub_request(:any, \"www.example.com\").to_return(status: 200)\n  end\n  describe \"#create\" do\n    context \"label is new\" do\n      it \"creates a new label\" do\n        attributes = {\n          label: {\n            name: \"test\",\n            labeling: {\n              target_type: \"Link\", target_id: 1\n            }\n          }\n        }\n        response.status.should == 200\n        post :create, attributes[:label], format: :json\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Labeling controller:</p>\n\n<pre><code>  def create\n    label = Label.find_by_name(params[:name])\n\n    labeling = label.labelings.build do |lb|\n      lb.user_id     = current_user.id\n      lb.target_type = params[:labeling][:target_type]\n      lb.target_id   = params[:labeling][:target_id]\n    end\n\n    if labeling.save\n      render json: {\n        name: label.name,\n        id: label.id,\n        labeling: {\n          id: labeling.id\n        }\n      }\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","postgresql","activerecord","rails-postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13160664,"title":"Patch ActiveRecord/postgres_ext to return upper case UUID","body":"<p>I'm using postgres_ext with Rails/ActiveRecord to be able to store UUID as the PostreSQL UUID datatype. But in my app I'm comparing uuids and would like the UUIDs returned from the models to be in uppercase instead of lowercase.</p>\n\n<p><strong>How do I patch ActiveRecord/postgres_ext to always return uppercase string representations of the UUIDs?</strong></p>\n"},{"tags":["ruby-on-rails","deployment","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12404180,"title":"Capistrano: running cap deploy:install ROLES=role1 runs ALL tasks on role1 server","body":"<p>I have a capistrano deployment setup that simplified looks something like this:</p>\n\n<pre><code>server \"server_ip1\", :role1\nserver \"server_ip2\", :role2\n</code></pre>\n\n<p>And a pair of tasks</p>\n\n<pre><code>namespace :postgresql do\n  desc \"Install necessary ubuntu packages\"\n  task :install, roles: [:role2] do\n    run \"#{sudo} apt-get -y install postgresql libpq-dev\"\n  end\n  after \"deploy:install\", \"postgresql:install\"\nend\n\nnamespace :app_install do\n  desc \"Install necessary ubuntu packages\"\n  task :install, roles: [:role1, :role2] do\n    run \"#{sudo} apt-get -y install imagemagick\"\n  end\n  after \"deploy:install\", \"app_install:install\"\nend\n</code></pre>\n\n<p>Now the problem is if I run <code>cap deploy:install ROLES=role1</code> it correctly runs the tasks on server_ip1 BUT it runs BOTH task app_install:install AND postgresql:install</p>\n\n<p>And the funny thing is if I run <code>cap deploy:install</code> (without ROLES=role1) it does everything 'correctly'.</p>\n\n<p>Am I getting something wrong?</p>\n"},{"tags":["ruby-on-rails","autocomplete","solr","sunspot","sunspot-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12357220,"title":"autocomplete in Solr and sunspot","body":"<p>I'm building a website with RoR and I use Sunspot and the solr Search Engine. I needed to use autocomplete functionality but I couldn't.\nI knew that Solr has a new thing called <a href=\"http://wiki.apache.org/solr/Suggester\" rel=\"nofollow\">suggester</a>  but I don't know how to use this with sunspot and in a rails app.</p>\n\n<p>I found a gem called <a href=\"https://github.com/xponrails/sunspot_autocomplete\" rel=\"nofollow\">sunspot_autocomplete</a>  </p>\n\n<p>and I followed what was written, but when I try to reindex I get this error  :</p>\n\n<pre><code>rake aborted!\nRSolr::Error::Http - 400 Bad Request\nError: ERROR:unknown field 'tags_ac'\n</code></pre>\n\n<p>The model that is searchable called <code>Experience</code> and I put this block in it </p>\n\n<pre><code>searchable do\n  text :tags, :boost =&gt; 3\n  text :title, :boost =&gt; 2\n  text :tips\n  autocomplete :tags, :using =&gt; :tags\nend \n</code></pre>\n\n<p>Finally I found this blog that it sounds good but I don't understand it :(</p>\n\n<p><a href=\"http://www.binrand.com/post/3338898-autocomplete-solr-architecture-rails-3-2-solr-1-4-with-sunspot-solr-gem.html\" rel=\"nofollow\">http://www.binrand.com/post/3338898-autocomplete-solr-architecture-rails-3-2-solr-1-4-with-sunspot-solr-gem.html</a></p>\n\n<p>I need your help in putting the autocomplete functionality in my app .. Thanks A lot :)</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13160773,"title":"When use \"find_all_by\", why use :order => :title rather than :order => title","body":"<p>In view haml file I have a link, when you click, you get all the movies sorted by title or release date. \nThe code in controller is:</p>\n\n<pre><code>def index\n    sort = params[:sort] || session[:sort]\n    case sort\n    when 'title'\n      ordering,@title_header = {:order =&gt; :title}, 'hilite'\n    when 'release_date'\n      ordering,@date_header = {:order =&gt; :release_date}, 'hilite'\n    end\n   # some more codes here\n@movies = Movie.find_all_by_rating(@selected_ratings.keys, ordering)\nend\n</code></pre>\n\n<p>if I change </p>\n\n<p><code>ordering,@title_header = {:order =&gt; :title}, 'hilite'</code><br>\nto </p>\n\n<pre><code> ordering,@title_header = {:order =&gt; title}, 'hilite'\n</code></pre>\n\n<p>It gives an error: </p>\n\n<pre><code>undefined local variable or method `title' for #&lt;MoviesController:0xb29a853c&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":13158715,"title":"Rails 3.0 with \"or\" statement in each loop","body":"<p>I am trying to build a query that compares two object, and if they have the same <code>id</code> the record is not fetched. What I have is this:</p>\n\n<pre><code>@channels.each do |channel|\n  unless @guide_channels.where(:id =&gt; channel.id).exists?\n    @dropdown_channels = @dropdown_channels.where(:id =&gt; channel.id)\n  end\nend\n</code></pre>\n\n<p>This creates the query, but puts a AND between every value which isn't what I have in mind. I want the \"or\" operator. Is there a 'orwhere' function I can use or is there a better way to do this with some compare function?</p>\n"},{"tags":["ruby-on-rails","activerecord","model","rake"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":135,"score":1,"question_id":12122087,"title":"Update db/migrate after manually updating models?","body":"<p>For example i have this model:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  attr_accessible :name, :order\nend\n</code></pre>\n\n<p>Then when i did <code>rake db:migrate</code> it created this <strong>db/migrate/20120825132038_create_products.rb</strong>:</p>\n\n<pre><code>class CreateProducts &lt; ActiveRecord::Migration\n  def change\n    create_table :products do |t|\n      t.integer :order\n      t.string :name\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>But it all happend cuz i used <code>rails generate Product order:integer name:string</code></p>\n\n<p>Now after i go to Product model and changes it manually to:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  attr_accessible :name, :order, :category_id\n\n  validates :name, uniqueness: true\n  belongs_to :category\nend\n</code></pre>\n\n<p>How can i auto update the <strong>db/migrate/20120825132038_create_products.rb</strong> with the updates?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":604,"score":2,"question_id":7743059,"title":"How do i get rid of @controller is nil error in my tests","body":"<p>I keep getting</p>\n\n<pre><code> @controller is nil: make sure you set it in your test's setup method.\n</code></pre>\n\n<p>When I run my tests. Any idea what this means?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13160441,"title":"How to remove quotes in active record query","body":"<p>I am trying to retrieve records from multiple tables based on collection of ids suing the \nbelow query, it is working fine.\n<br/><br/><strong>ACTIVE RECORD QUERY:</strong></p>\n\n<blockquote>\n  <p>Song.order(\"songs.id desc\").\n            includes(:artist).includes(:album).\n            joins(\"LEFT JOIN artists ON songs.artist_id = artists.id\").\n            joins(\"LEFT JOIN albums ON songs.album_id = albums.id\").\n            where(\"(songs.id)</p>\n  \n  <blockquote>\n    <p>IN (#{song_ids*','})</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE :term OR LOWER(artists.name) LIKE :term\n  OR LOWER(albums.title) LIKE :term)\",\n            :term => \"%#{terms[index].downcase}%\")</p>\n</blockquote>\n\n<p><strong>PG QUERY OUTPUT:</strong></p>\n\n<blockquote>\n  <p>SELECT \"songs\".* FROM \"songs\" LEFT JOIN artists ON songs.artist_id =\n  artists.id LEFT JOIN albums ON songs.album_id = albums.id WHERE (</p>\n  \n  <blockquote>\n    <p>(songs.id) IN (4,5,28,37,46,48)</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE '%wo%' OR LOWER(artists.name) LIKE\n  '%wo%' OR LOWER(albums.title) LIKE '%wo%')) ORDER BY songs.id desc</p>\n</blockquote>\n\n<p>But while I was trying to modify the query as below\n<br/><br/><strong>ACTIVE RECORD QUERY:</strong></p>\n\n<blockquote>\n  <p>Song.order(\"songs.id desc\").\n            includes(:artist).includes(:album).\n            joins(\"LEFT JOIN artists ON songs.artist_id = artists.id\").\n            joins(\"LEFT JOIN albums ON songs.album_id = albums.id\").\n            where(\"(songs.id)</p>\n  \n  <blockquote>\n    <p>IN (:song_ids)</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE :term OR LOWER(artists.name) LIKE :term\n  OR LOWER(albums.title) LIKE :term)\",</p>\n</blockquote>\n\n<pre><code>      :term =&gt; \"%#{terms[index].downcase}%\",:song_ids =&gt; song_ids*',')\n</code></pre>\n\n<p><strong>PG QUERY OUTPUT:</strong></p>\n\n<blockquote>\n  <p>SELECT \"songs\".* FROM \"songs\" LEFT JOIN artists ON songs.artist_id =\n  artists.id LEFT JOIN albums ON songs.album_id = albums.id WHERE (</p>\n  \n  <blockquote>\n    <p>(songs.id) IN ('4,5,28,37,46,48')</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE '%wo%' OR LOWER(artists.name) LIKE\n  '%wo%' OR LOWER(albums.title) LIKE '%wo%')) ORDER BY songs.id desc</p>\n</blockquote>\n\n<p>Because of the single quotes the above query doesn't working.</p>\n"},{"tags":["ruby-on-rails","api","activeresource","rails-roar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13159314,"title":"Consuming REST API Rails","body":"<p>I've looked at <a href=\"http://stackoverflow.com/questions/5386232/consuming-rest-api-from-rails-application\">this</a> question but it's quite old and I feel there's now other alternatives to ARes.</p>\n\n<p>Given that many people seem to think that ActiveResource is kind of outdated and heavyweight, I've looked at <a href=\"https://github.com/filtersquad/api_smith\" rel=\"nofollow\">Api Smith</a>, <a href=\"https://github.com/remiprev/her\" rel=\"nofollow\">Her</a>, <a href=\"https://github.com/apotonick/roar\" rel=\"nofollow\">Roar</a> and of course ARes. </p>\n\n<p>Which one of these gems would be the most reliable, and future proof alternative? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","arel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":211,"score":0,"question_id":10149485,"title":"How can I build up an ActiveRecord query incrementally, line by line?","body":"<p>I'd like to piece together an ActiveRecord query using runtime data. What I have in mind is something like...</p>\n\n<pre><code>r = Person.where('last_name LIKE ?', foo)\nr.where('created_at &lt; ?', Time.now - 100.days)\nr.where( ...some other conditions... )\n</code></pre>\n\n<p>That doesn't work as intended though. To get it to work you have to chain them together all on one line...</p>\n\n<pre><code>Person.where('last_name LIKE ?', foo) \\\n  .where('created_at &lt; ?', Time.now - 100.days) \\\n  .where( ...some other conditions... )\n</code></pre>\n\n<p>I'm trying to figure out a way to spread it over separate operations on multiple lines.</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":133,"score":0,"question_id":9356240,"title":"MetaSearch Gem overrides the search method with the Tire Gem","body":"<p>I've added a fulltext searching database to my existing webapp that is built with Rails and uses the active_admin gem. The fulltext database is built on elastic search and uses the Tire gem. The active_admin gem has a dependency requirement of the metasearch gem which defines the Model.search method.</p>\n\n<p>The problem is that the metasearch gem overrides the search method for the tire search gem and I can't seem to alias the search method in the tire gem back into the model. Does anyone know how I can do this?</p>\n\n<p>-- Solution --</p>\n\n<p>Update: The solution is to setup an initializer to add the following method:</p>\n\n<pre><code>def search_for(*args,&amp;block)\n  tire.__send__(:search, *args, &amp;block)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","apache","download"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13160104,"title":"Download large files with Ruby on Rails","body":"<p>My small project for internal use is something like \"file share portal like sharerapid\", it will be use about 100 people. I have problem with downloading large files. Small files (&lt; 200 MB) are downloading fast, but largest files block my server for 2-5 minutes. Maybe problem is with RAM, I have 2 GB ram. My code to download file:</p>\n\n<pre><code>def custom_send(userfile)\n    file = userfile.attachment.file.url.to_s.split(\"?\").slice(0..-2).join(\"?\")\n    send_file \"#{Rails.root.to_s}/public#{file}\" , filename: userfile.name, x_sendfile: true\nend\n</code></pre>\n\n<p>I don't know where is problem, in develop mode on my localhost machine is OK, but problem is on public virtual server(ubuntu 12).</p>\n"},{"tags":["ruby-on-rails","amazon-web-services","html-email"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13160157,"title":"Sending HTML emails","body":"<p>I have a ruby application that I'd like to send HTML emails. In my mailer folder I have the appropriate html.erb files. In dev(localhost) and staging(on heroku) the html emails get sent fine, but when I try and send HTML emails in productions(hosted on AWS), I keep getting the text email, and not the html emails. Is there something that I'm missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","tablesorter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13146587,"title":"tablesorter-infoOnly shows the sort icons even when disabled in rails","body":"<p>I am working on a rails application and have two tbody's for a table. I disabled the table-sorter in second tbody by using tablesorter-infoOnly. But still it shows the icons associated with sorting next to the table headers eventhough sort has been disabled. . </p>\n\n<p>Is their any way to remove the sorter images in rails application or handling it in javascript to disable the icons from displaying n the second tbody??</p>\n"},{"tags":["ruby-on-rails","has-many","belongs-to","has-and-belongs-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":11067651,"title":"DRYing up my Rails belongs_to and has_many assosiations","body":"<p>I'm working on an app that works out debts and who owes what to whom etc..</p>\n\n<p>Currently it works like this:</p>\n\n<pre><code>create_table \"debts\", :force =&gt; true do |t|\n  t.string   \"amount\"\n  t.integer  \"payer_id\"\n  t.integer  \"payee_id\"\n  t.datetime \"created_at\", :null =&gt; false\n  t.datetime \"updated_at\", :null =&gt; false\nend\n\ncreate_table \"people\", :force =&gt; true do |t|\n  t.string   \"name\"\n  t.integer  \"bank\"\n  t.datetime \"created_at\", :null =&gt; false\n  t.datetime \"updated_at\", :null =&gt; false\nend\n\nclass Debt &lt; ActiveRecord::Base\n    attr_accessible :amount, :payee_id, :payer_id\n\n    belongs_to :payee, :class_name =&gt; 'Person'\n    belongs_to :payer, :class_name =&gt; 'Person'\n end\n\nclass Person &lt; ActiveRecord::Base\n    attr_accessible :amount, :payee_id, :payer_id\n\n    has_many :debts_owed, :class_name =&gt; Debt, :foreign_key =&gt; \"payee_id\"\n    has_many :debts_to_pay, :class_name =&gt; Debt, :foreign_key =&gt; \"payer_id\"\nend\n</code></pre>\n\n<p>It's working but I know there must be a simpler way of representing multiple associations to the same model? I've been reading up on has_and_belongs_to_many which looks like the right thing but I'm lost to be honest.</p>\n\n<p>Any help would be appreciated!</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","session","authentication","login","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13159829,"title":"Devise: how to disallow logging different roles from the same session, at the same time","body":"<p>I created three different roles (User, Admin, Manager) using devise's rails generator, they are stored in different tables and models...</p>\n\n<p>How can I forbid someone to to login two different roles during the same session?</p>\n"},{"tags":["ruby-on-rails","has-many","belongs-to","relationships"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13159602,"title":"Rails has_many belongs_to same form","body":"<p>So I have albums and album_tags. One album can have many album_tags so that I modified the models:</p>\n\n<pre><code>class Album &lt; ActiveRecord::Base\n  ...\n  has_many :album_tags\nend\n\nclass AlbumTag &lt; ActiveRecord::Base\n  attr_accessible :album_id, :album_tag_id, :tag_name\n  belongs_to :album\nend\n</code></pre>\n\n<p>I also added :tag_name to the attr_accessible for albums.\nBut now I need to insert those tag_name into the _form.htl.erb of th albums_views</p>\n\n<p>I did so several times with nested ressources but this time it's different and my ideas did not work out.\nIn my new-method I added</p>\n\n<pre><code>@album_tag = AlbumTag.new\n</code></pre>\n\n<p>and in my _form.html.erb it looks like this:</p>\n\n<pre><code>&lt;%= f.label :tag_name %&gt;&lt;br /&gt;\n&lt;%= f.text_field :tag_name %&gt;\n</code></pre>\n\n<p>The log says:</p>\n\n<pre><code>ActionView::Template::Error (undefined method `tag_name' for #&lt;Album:0xe7331c50&gt;):\n</code></pre>\n\n<p>So I tried to add the album_tag object above:</p>\n\n<pre><code>&lt;%= form_for([@user, @album, @album_tag]) do |f| %&gt;\n</code></pre>\n\n<p>and then I get:</p>\n\n<pre><code>ActionView::Template::Error (undefined method `user_album_album_tags_path' for #&lt;#&lt;Class:0xe755de48&gt;:0xe755b4cc&gt;):\n</code></pre>\n\n<p>So my play was to insert a form_field with values like tag1,tag2,tag3 and so on.\nAfterwards I want to pick them up, and insert them in a for each.\nBut firstly I have to get that field shown without errors.\nHow do I do that ?</p>\n\n<p>Edit: I just tried to add </p>\n\n<pre><code>accepts_nested_attributes_for :album_tags\n</code></pre>\n\n<p>into my albums_model. Without success</p>\n"},{"tags":["ruby-on-rails","plugins","redmine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":33,"score":-2,"question_id":13159654,"title":"Rails 3.2 message when i execute some instructions: \"you did not specify how you would like rails to report deprecation notices\"","body":"<p>i'm developing a plugin for redmine and when i'll execute a command to generate a controller i get the following message:</p>\n\n<p>**\nc:\\redmine>rails g redmine_plugin_controller g_build gbuild_setup\nYou did not specify how you would like Rails to report deprecation notices for y\nour production  environment, please set config.active_support.deprecation to :lo\ng, :notify or :stderr at config/environments/production .rb\nC:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_record/connect\nion_adapters/abstract/connection_specification.rb:47:in <code>resolve_hash_connection\n': database configuration does not specify adapter (ActiveRecord::AdapterNotSpec\nified)\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/connection_adapters/abstract/connection_specification.rb:41:in</code>resolve_st\nring_connection'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/connection_adapters/abstract/connection_specification.rb:25:in <code>spec'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/connection_adapters/abstract/connection_specification.rb:129:in</code>establish\n_connection'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/railtie.rb:82:in <code>block (2 levels) in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:36:in</code>instance_eval'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:36:in <code>execute_hook'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:43:in</code>block in run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:42:in <code>each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:42:in</code>run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/base.rb:721:in <code>&lt;top (required)&gt;'\n        from c:/redmine/lib/plugins/acts_as_activity_provider/init.rb:2:in</code>bloc\nk in '\n        from c:/redmine/config/initializers/00-core_plugins.rb:12:in <code>eval'\n        from c:/redmine/config/initializers/00-core_plugins.rb:12:in</code>block in &lt;\ntop (required)>'\n        from c:/redmine/config/initializers/00-core_plugins.rb:2:in <code>each'\n        from c:/redmine/config/initializers/00-core_plugins.rb:2:in</code>'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/dependencies.rb:245:in <code>load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/dependencies.rb:245:in</code>block in load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/dependencies.rb:236:in <code>load_dependency'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/dependencies.rb:245:in</code>load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n.rb:588:in <code>block (2 levels) in &lt;class:Engine&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n.rb:587:in</code>each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n.rb:587:in <code>block in &lt;class:Engine&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:30:in</code>instance_exec'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:30:in <code>run'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:55:in</code>block in run_initializers'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:54:in <code>each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:54:in</code>run_initializers'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\nation.rb:136:in <code>initialize!'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/railti\ne/configurable.rb:30:in</code>method_missing'\n        from c:/redmine/config/environment.rb:14:in <code>&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\nation.rb:103:in</code>require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\nation.rb:103:in <code>require_environment!'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman\nds.rb:25:in</code>'\n        from script/rails:6:in <code>require'\n        from script/rails:6:in</code>'</p>\n\n<p>c:\\redmine>rails g redmine_plugin_controller g_build gbuild_setup -e devlopment\nYou did not specify how you would like Rails to report deprecation notices for y\nour production  environment, please set config.active_support.deprecation to :lo\ng, :notify or :stderr at config/environments/production .rb\nC:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_record/connect\nion_adapters/abstract/connection_specification.rb:47:in <code>resolve_hash_connection\n': database configuration does not specify adapter (ActiveRecord::AdapterNotSpec\nified)\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/connection_adapters/abstract/connection_specification.rb:41:in</code>resolve_st\nring_connection'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/connection_adapters/abstract/connection_specification.rb:25:in <code>spec'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/connection_adapters/abstract/connection_specification.rb:129:in</code>establish\n_connection'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/railtie.rb:82:in <code>block (2 levels) in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:36:in</code>instance_eval'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:36:in <code>execute_hook'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:43:in</code>block in run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:42:in <code>each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/lazy_load_hooks.rb:42:in</code>run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\necord/base.rb:721:in <code>&lt;top (required)&gt;'\n        from c:/redmine/lib/plugins/acts_as_activity_provider/init.rb:2:in</code>bloc\nk in '\n        from c:/redmine/config/initializers/00-core_plugins.rb:12:in <code>eval'\n        from c:/redmine/config/initializers/00-core_plugins.rb:12:in</code>block in &lt;\ntop (required)>'\n        from c:/redmine/config/initializers/00-core_plugins.rb:2:in <code>each'\n        from c:/redmine/config/initializers/00-core_plugins.rb:2:in</code>'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/dependencies.rb:245:in <code>load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/dependencies.rb:245:in</code>block in load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/dependencies.rb:236:in <code>load_dependency'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\nsupport/dependencies.rb:245:in</code>load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n.rb:588:in <code>block (2 levels) in &lt;class:Engine&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n.rb:587:in</code>each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n.rb:587:in <code>block in &lt;class:Engine&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:30:in</code>instance_exec'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:30:in <code>run'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:55:in</code>block in run_initializers'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:54:in <code>each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\nlizable.rb:54:in</code>run_initializers'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\nation.rb:136:in <code>initialize!'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/railti\ne/configurable.rb:30:in</code>method_missing'\n        from c:/redmine/config/environment.rb:14:in <code>&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\nation.rb:103:in</code>require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\nation.rb:103:in <code>require_environment!'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman\nds.rb:25:in</code>'\n        from script/rails:6:in <code>require'\n        from script/rails:6:in</code>'</p>\n\n<p>c:\\redmine>rails g redmine_plugin_controller g_build gbuild_setup -e devlopment</p>\n\n<blockquote>\n  <blockquote>\n    <p>error.logx\n    You did not specify how you would like Rails to report deprecation notices for y\n    our production  environment, please set config.active_support.deprecation to :lo\n    g, :notify or :stderr at config/environments/production .rb\n    C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_record/connect\n    ion_adapters/abstract/connection_specification.rb:47:in <code>resolve_hash_connection\n    ': database configuration does not specify adapter (ActiveRecord::AdapterNotSpec\n    ified)\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\n    ecord/connection_adapters/abstract/connection_specification.rb:41:in</code>resolve_st\n    ring_connection'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\n    ecord/connection_adapters/abstract/connection_specification.rb:25:in <code>spec'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\n    ecord/connection_adapters/abstract/connection_specification.rb:129:in</code>establish\n    _connection'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\n    ecord/railtie.rb:82:in <code>block (2 levels) in &lt;class:Railtie&gt;'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/lazy_load_hooks.rb:36:in</code>instance_eval'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/lazy_load_hooks.rb:36:in <code>execute_hook'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/lazy_load_hooks.rb:43:in</code>block in run_load_hooks'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/lazy_load_hooks.rb:42:in <code>each'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/lazy_load_hooks.rb:42:in</code>run_load_hooks'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.2.8/lib/active_r\n    ecord/base.rb:721:in <code>&lt;top (required)&gt;'\n            from c:/redmine/lib/plugins/acts_as_activity_provider/init.rb:2:in</code>bloc\n    k in '\n            from c:/redmine/config/initializers/00-core_plugins.rb:12:in <code>eval'\n            from c:/redmine/config/initializers/00-core_plugins.rb:12:in</code>block in &lt;\n    top (required)>'\n            from c:/redmine/config/initializers/00-core_plugins.rb:2:in <code>each'\n            from c:/redmine/config/initializers/00-core_plugins.rb:2:in</code>'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/dependencies.rb:245:in <code>load'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/dependencies.rb:245:in</code>block in load'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/dependencies.rb:236:in <code>load_dependency'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_\n    support/dependencies.rb:245:in</code>load'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n    .rb:588:in <code>block (2 levels) in &lt;class:Engine&gt;'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n    .rb:587:in</code>each'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/engine\n    .rb:587:in <code>block in &lt;class:Engine&gt;'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\n    lizable.rb:30:in</code>instance_exec'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\n    lizable.rb:30:in <code>run'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\n    lizable.rb:55:in</code>block in run_initializers'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\n    lizable.rb:54:in <code>each'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia\n    lizable.rb:54:in</code>run_initializers'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\n    ation.rb:136:in <code>initialize!'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/railti\n    e/configurable.rb:30:in</code>method_missing'\n            from c:/redmine/config/environment.rb:14:in <code>&lt;top (required)&gt;'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\n    ation.rb:103:in</code>require'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic\n    ation.rb:103:in <code>require_environment!'\n            from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman\n    ds.rb:25:in</code>'\n            from script/rails:6:in <code>require'\n            from script/rails:6:in</code>'\n    **</p>\n  </blockquote>\n</blockquote>\n\n<p>What is the problem? Can anyone help me? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13159660,"title":"Updating seed.rb when production is already released","body":"<p>The best solution I have right is like doing writing it like below.</p>\n\n<h2>Before release of production</h2>\n\n<p><code>\nif Category.count == 0\n  categories = Category.create([{ name: 'business' }, { name: 'sport' })\nend\n</code></p>\n\n<h2>After</h2>\n\n<pre><code>if Category.count == 0\n  categories = Category.create([{ name: 'business' }, { name: 'sport' })\nelsif Category.count == 2\n  Category.create([{ name: 'science' }])\n  categories = Category.all\nend\n</code></pre>\n\n<p>This is kinda fail since I have to write <code>[{ name: 'hoge' }]</code> everytime I add a data.\nAnd I might miss count the <code>Category.count === COUNT</code> which is in the <code>elsif</code> block.</p>\n\n<p>Any better solution?</p>\n\n<p>I think it'll be nice if its able to add/remove some value from a certain Array to update the master data.</p>\n"},{"tags":["sql","ruby-on-rails","dbms","ruby-on-rails-2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13157923,"title":"Get values from 3 different tables based on specific condition","body":"<p>I have 3 tables in my database</p>\n\n<ol>\n<li>User (id, username, email, pwd, etc ...)</li>\n<li>Producer (id, user_id)</li>\n<li>Address (first_name, city, addressable_id, etc)</li>\n</ol>\n\n<p>Producer has link with User table(User.id = Producer.user_id) and Address table(p.id = Address.addressable_id)</p>\n\n<p>Now I want to get all the producer addresses with his username</p>\n\n<p>I am trying with following query but it is not giving the expected output</p>\n\n<pre><code>select u.login, p.id, a.city from producers p\n\njoin users u on u.id = p.user_id\n\njoin addresses a on a.addressable_id = p.id\n</code></pre>\n\n<h2>My models and relationships</h2>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :customer\n  has_one :producer\nend\n</code></pre>\n\n<p><strong>producer.rb</strong></p>\n\n<pre><code>class Producer &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :updated_by_user, :class_name =&gt; \"User\", :foreign_key =&gt; \"updated_by_user_id\"\n\n  has_one :address, :as =&gt; :addressable\n  has_many :items  \nend\n</code></pre>\n\n<p><strong>address.rb</strong></p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :addressable, :polymorphic =&gt; true\n\n  belongs_to :updated_by_user, :class_name =&gt; \"User\", :foreign_key =&gt; \"updated_by_user_id\"\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ide","aptana"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13159373,"title":"Rails with Aptana IDE : intellisense with methods","body":"<p>I'm using Aptana IDE for my Rails project.</p>\n\n<p>when I choose a method of a class. (i.e. <code>CSV.parse_line</code>), the IDE doesn't present to me the method's arguments.</p>\n\n<p>How can I fix this?</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13155332,"title":"Issue in find_each method in Rails 2.3.4","body":"<p>Here's the erroneous code snippet. </p>\n\n<pre><code>transaction do    \n    Person.having_email(some_email).find_each(:conditions =&gt; [\"people.identifier != ? OR people.identifier IS NULL\", identifier]) do |person|\n        if person.identifier?\n          raise \"Person is associated with a different identifier\"\n        else\n          duplicate_entry =  Person.find_by_identifier_and_company_id(identifier, person.company_id)\n          person.update_attribute(:identifier, identifier) if duplicate_entry.nil?\n        end\n    end\nend\n</code></pre>\n\n<p><code>having_email</code> is a named_scope defined for the Person class.</p>\n\n<p>The issue that I'm facing is that the expression that finds a possible duplicate entry always seems to be returning nil even when a valid record is present in the db. When I evaluate the same expression using the RubyMine debugger, it returns the correct object.</p>\n\n<p>On further introspection, it seems that rails is not firing any query on the duplicate_entry evaluation statement(there is no such query in the logs). On replacing the <code>find_each</code> call with a normal <code>find(:all, ...).each</code> call, things seem to work fine(The duplicate entry retrieval query is present in the logs as well).</p>\n\n<p>I haven't been able to get my head around what might be causing this. Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13120994,"title":"Migrating a Heroku Postgres Database from a Dev to Basic Plan","body":"<p>I've followed Heroku's guide on migrating my postgres database from a Dev to Basic Plan: <a href=\"https://devcenter.heroku.com/articles/migrating-from-a-dev-to-a-basic-database\" rel=\"nofollow\">https://devcenter.heroku.com/articles/migrating-from-a-dev-to-a-basic-database</a></p>\n\n<p>Everything seems to have gone well but i'm a little confused by the info below. Even though the new basic DB is showing some data, it's not showing any tables. The data size is also different. Before I remove my Dev DB, has anyone else seen the same? Can anyone explain what's happening here?</p>\n\n<pre><code>Ryans-MacBook-Pro:dashboard ryanberry$ heroku pg:info -a myapp(replaced with my app name)\n=== HEROKU_POSTGRESQL_BLUE (DATABASE_URL)\nPlan         Basic\nStatus       available\nConnections  4\nPG Version   9.1.5\nCreated      2012-10-29 10:51 UTC\nData Size    111.6 MB\nTables       0\nFork/Follow  Unavailable\n=== HEROKU_POSTGRESQL_CHARCOAL\nPlan         Dev\nStatus       available\nConnections  0\nPG Version   9.1.5\nCreated      2012-10-20 02:26 UTC\nData Size    112.4 MB\nTables       30\nRows         389702/10000 (Write access revoked)\nFork/Follow  Unavailable\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":5,"favorite_count":5,"up_vote_count":14,"down_vote_count":0,"view_count":8196,"score":14,"question_id":3876891,"title":"How do I specify \":layout => false\" in Rails' respond_with?","body":"<p>I have this setup:</p>\n\n<pre><code>class UsersController &lt; InheritedResources::Base\n  respond_to :html, :js, :xml, :json\n\n  def index\n    @users = User.all\n    respond_with(@users)\n  end\nend\n</code></pre>\n\n<p>Now I am trying to make it so, if <code>params[:format] =~ /(js|json)/</code>, <code>render :layout =&gt; false, :text =&gt; @users.to_json</code>.  How do I do that with <code>respond_with</code> or <code>respond_to</code> and inherited_resources?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":9154591,"title":"Right way to handle a predefined set of salutations in rails","body":"<p>I've just started with my first real rails app.</p>\n\n<p>I have a predefined set of salutations (\"Herr\", \"Frau, \"Herr und Frau\") for my customer model.\nThe app has to deal with an export to a csv file where \"Herr\" has to be the integer 1, \"Frau\" 2 and \"Herr und Frau\" = 3.</p>\n\n<p>Therefore I thought it would be clever to save that salutation as an integer and simply add an  salutation_readable method to my customer model like this:</p>\n\n<pre><code>def salutation_readable\n    case salutation\n    when 1\n      \"Herr\"\n    when 2\n      \"Frau\"\n    when 3\n      \"Herr und Frau\"\n    end\nend\n</code></pre>\n\n<p>to display the salutation in my views.</p>\n\n<p>In the customer form partial I added:</p>\n\n<pre><code>&lt;%= f.select(:salutation, options_for_select([['Herr', 1], ['Frau', 2], ['Herr und Frau', 3]])) %&gt;\n</code></pre>\n\n<p>Everything works as expected, except the customer edit view where the preselected value is always the first entry and not my saved one.</p>\n"},{"tags":["ruby-on-rails","api","ebay"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13159334,"title":"Get the list of ebay payment methods using api","body":"<p>My simple requirement is to get all the payment methods of ebay.\nI have list of methods but i don't want to hard code those methods in my application.\nInstead i would like to use api method which will give me the updated payment methods.\nSo, that whenever there is any updation done for payment methods in ebay then i will have to call that api method and will get updated methods.\nPlease suggest if anyone knows the same.</p>\n"},{"tags":["ruby-on-rails","ruby","amazon-s3","amazon-cloudfront","pandastream"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12879374,"title":"How to \"live stream\" video from central server to clients? In rails","body":"<p>Let's say that I have a video file on a central server and I want to stream it to my clients at a particular time. Think of this as playing a video file and then live streaming it to clients so that the clients act like cable television and cannot progress further into the file.</p>\n\n<p>I am trying to do this in Ruby on Rails which uses a service called Panda to handle the integration of rails, amazon s3 and cloudfront.</p>\n\n<p>The result is to go to a view that features a live stream, which doesn't consist of a live camera, but rather a playlist of videos stored in amazon s3.</p>\n"},{"tags":["ruby-on-rails","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12879804,"title":"uninitialized constant Gherkin::Parser::Parser (NameError)","body":"<p>I have just added Cucumber to my Rails app via the following steps:</p>\n\n<p>Adding</p>\n\n<pre><code>group :test do\n  gem 'cucumber'\nend\n</code></pre>\n\n<p>to my Gemfile.</p>\n\n<p>Running <code>bundle install</code></p>\n\n<p>Followed by <code>rails generate cucumber:install</code></p>\n\n<p>When there are no features, Cucumber seems to run as expected.</p>\n\n<p>But when I add a feature file and run <code>bundle exec cucumber</code> I get the following</p>\n\n<blockquote>\n  <p>uninitialized constant Gherkin::Parser::Parser (NameError)\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/feature_file.rb:34:in <code>parse'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/runtime/features_loader.rb:28:in</code>block in load'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/runtime/features_loader.rb:26:in <code>each'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/runtime/features_loader.rb:26:in</code>load'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/runtime/features_loader.rb:14:in <code>features'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:170:in</code>features'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:46:in <code>run!'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/cli/main.rb:43:in</code>execute!'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/lib/cucumber/cli/main.rb:20:in <code>execute'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/gems/cucumber-1.2.1/bin/cucumber:14:in</code>'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/bin/cucumber:23:in <code>load'\n  /Users/purinkle/.rvm/gems/ruby-1.9.3-p286@radfords/bin/cucumber:23:in</code>'</p>\n</blockquote>\n"},{"tags":["ruby-on-rails","redirect","apache2","virtualhost"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13158825,"title":"Apache2 vhost Domain redirecting to incorrect URL when www. added","body":"<p>I have a linux server that is running 3 rails apps. 2 sites use an ssl certificate and are deployed to a subURI of domain2, so domain2.com/app1 domain2.com/app2 etc an i have the other app which uses the domain1.net domain name. When you go to domain1.net you get to the site just fine however when you visit www.domain1.net you get redirected to <a href=\"https://domain2.eu/\" rel=\"nofollow\">https://domain2.eu/</a>.</p>\n\n<p>Does anyone know how i can stop this behaviour and redirect the www.domain1.net to domain1.net?</p>\n\n<p>apache2.conf  </p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n            Servername domain1.net\n            ServerAlias www.domain1.net\n            Documentroot /apps/domain1/public\n    &lt;Directory /apps/domain1/public&gt;\n            Options -MultiViews\n    &lt;/Directory&gt;\n    &lt;/VirtualHost&gt;\n\nNameVirtualHost *:80\n&lt;VirtualHost *:80&gt;\n       ServerName domain2.eu\n       Redirect permanent / https://domain2.eu/\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:443&gt;\n        ServerName domain2.eu\n        DocumentRoot /var/www\n        SSLEngine on\n        SSLCertificateFile /root/crt1.crt\n        SSLCertificateKeyFile /root/key.key\n        SSLCACertificateFile /root/crt.crt\n        &lt;Directory /var/www&gt;\n        Allow from all\n        &lt;/Directory&gt;\n\n\n        RailsBaseURI /wpp\n        &lt;Directory /apps/WPP/public&gt;\n        Options -MultiViews\n        &lt;/Directory&gt;\n\n        RailsBaseURI /virtualpiano\n        &lt;Directory /apps/Virtual-Piano/public&gt;\n        Options -MultiViews\n        &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13158136,"title":"Is Devise's :authenticate_user! the same as :signed_in_user?","body":"<p>This is from the <a href=\"http://ruby.railstutorial.org/\" rel=\"nofollow\">Rails Tutorial Book</a>:</p>\n\n<p><a href=\"http://ruby.railstutorial.org/\" rel=\"nofollow\">http://ruby.railstutorial.org/</a> </p>\n\n<pre><code>  before_filter :signed_in_user, only: [:create, :destroy]\n\n\n  def signed_in_user\n    unless signed_in?\n      store_location\n      redirect_to signin_url, notice: \"Please sign in.\"\n    end\n  end\n\n  def signed_in?\n    !current_user.nil?\n  end\n</code></pre>\n\n<p>So the code is letting users create and destroy posts only if they are signed in.</p>\n\n<p>I was wondering if doing this with <strong>Devise</strong> <code>before_filter :authenticate_user!, only: [:create, :destroy]</code>. Results in the same thing?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13158638,"title":"Running soffice (libreoffice or openoffice) from command line in ruby on rails","body":"<p>I have an application which I would like to use libreoffice to batch convert files to html. I have the following method:</p>\n\n<pre><code>def set_versioned_odt\n  condition = %x(soffice --invisible --convert-to html /path/to/file.odt --outdir /path/to/dir/)\n\n  if condition\n    Rails.logger.info \"This has been finished\"\n  else\n    Rails.logger.info \"This failed...\"\n  end\n</code></pre>\n\n<p>end</p>\n\n<p>When I run this method in the application. It will return a failing statement; however, if I run this command in the rails console, soffice will process correctly. Does anyone know what I am doing wrong in the rails app?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13158399,"title":"Error while starting ruby server","body":"<p>I am new to ruby. I am trying to start the ruby server using the command <code>bundle exec rails server -p 3018</code>. But I am getting the below error. I checked in the code, there is no <code>newrelic.yml</code> file.</p>\n\n<pre><code>Cannot find or read /Users/hjodiawalla/Downloads/TheGiftsProject-Plugin/config/newrelic.yml\nExiting\n/Library/Ruby/Gems/1.8/gems/activerecord-3.0.3/lib/active_record/connection_adapters/postgresql_adapter.rb:928:in 'initialize': could not connect to server: Connection refused (PG::Error)\nIs the server running on host \"localhost\" and accepting TCP/IP connections on port 5432? could not connect to server: Connection refused\nIs the server running on host \"localhost\" and accepting TCP/IP connections on port 5432? could not connect to server: Connection refused\nIs the server running on host \"localhost\" and accepting TCP/IP connections on port 5432?\n    from /Library/Ruby/Gems/1.8/gems/activerecord-3.0.3/lib/active_record/connection_adapters/postgresql_adapter.rb:928:in 'connect'\n    from /Library/Ruby/Gems/1.8/gems/activerecord-3.0.3/lib/active_record/connection_adapters/postgresql_adapter.rb:928:in 'connect'\n</code></pre>\n\n<p>How do I resolve the issue. The server was working before with the same configuration. So have I missed something here.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13150334,"title":"How do I stop caching of layout in production with Ruby on Rails?","body":"<p>I'm building a rails app allows the admin to load (and reload) an .erb template that will function as a layout. i.e. the application.html.erb</p>\n\n<p>On occasion when updating an already created template to my hosted app the changes do not take effect. If I load a differently named file to the same template this does show the changes. </p>\n\n<p>This is not an issue in DEV on my local environment but is an issue for PROD. Is there a setting that controls the caching of the layout for a page? The dynamic content is no problem but the static layout does not change unless I restart the app. Please let me know if you have any brilliant insights about this issue, or if it needs greater explanation.</p>\n"},{"tags":["ruby-on-rails","heroku","amazon-s3","dragonfly"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13158375,"title":"Heroku S3 error","body":"<p>I'm using dragonfly to upload images within my app. On local host and hosting(using EC2), the uploads are working fine, however on my staging server, which sits on heroku, I run into errors. The files seem to get save in the appropriate S3 bucket, but when it tried to save the path to the DB, the app errors out. From what i can tell, it looks like in order to save, the app checks the path, and that's where the error occurs. Any idea of how to make this work? The exact error seems to be \"No such key\" yet, I have it clearly defined in my initializer file.\nAlso notice that it claims to have saved the file in :path=>\"/2012%2F10%2F26%2F20_01_35_196_bg.png\" but isn't the S3 standard :path=>\"/2012%2F10%2F26%2F20%2F01%2F35%2F196%2Fbg.png\" -> fwd-slash as opposed to underscore?</p>\n\n<pre><code>    2012-10-31T09:22:44+00:00 app[web.1]: Expected([200, 206]) &lt;=&gt; Actual(404 Not Found)\n    2012-10-31T09:22:44+00:00 app[web.1]:   request =&gt; {:connect_timeout=&gt;60, :headers=&gt;{\"Date\"=&gt;\"Wed, 31 Oct 2012 09:22:44 +0000\", \"Authorization\"=&gt;\"AWS AKIAIFYTQUZTEMIKPFPQ:q21jAd33e2MFNfGdSvJcuZFiOng=\", \"Host\"=&gt;\"tsbstagingbucket.s3.amazonaws.com:443\"}, :instrumentor_name=&gt;\"excon\", :mock=&gt;false, :nonblock=&gt;true, :read_timeout=&gt;60, :retry_limit=&gt;4, :ssl_ca_file=&gt;\"/app/vendor/bundle/ruby/1.9.1/gems/excon-0.16.2/data/cacert.pem\", :ssl_verify_peer=&gt;true, :write_timeout=&gt;60, :host=&gt;\"tsbstagingbucket.s3.amazonaws.com\", :path=&gt;\"/2012%2F10%2F26%2F20_01_35_196_bg.png\", :port=&gt;\"443\", :query=&gt;nil, :scheme=&gt;\"https\", :expects=&gt;[200, 206], :idempotent=&gt;true, :method=&gt;\"GET\"}\n    2012-10-31T09:22:44+00:00 app[web.1]:   response =&gt; #&lt;Excon::Response:0x000000090270c0 @body=\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n&lt;Error&gt;&lt;Code&gt;NoSuchKey&lt;/Code&gt;&lt;Message&gt;The specified key does not exist.&lt;/Message&gt;&lt;Key&gt;2012/10/26/20_01_35_196_bg.png&lt;/Key&gt;&lt;RequestId&gt;63D4B7EFCB9D7C8C&lt;/RequestId&gt;&lt;HostId&gt;ULIH1uZIzl4G4BuCzHsbmtnu27V+QlxXIJWo0Q854KsMJKImp+n25G2yW5kEi1yR&lt;/HostId&gt;&lt;/Error&gt;\", @headers={\"x-amz-request-id\"=&gt;\"63D4B7EFCB9D7C8C\", \"x-amz-id-2\"=&gt;\"ULIH1uZIzl4G4BuCzHsbmtnu27V+QlxXIJWo0Q854KsMJKImp+n25G2yW5kEi1yR\", \"Content-Type\"=&gt;\"application/xml\", \"Transfer-Encoding\"=&gt;\"chunked\", \"Date\"=&gt;\"Wed, 31 Oct 2012 09:22:44 GMT\", \"Server\"=&gt;\"AmazonS3\"}, @status=404&gt; - 2012/10/26/20_01_35_196_bg.png\n</code></pre>\n\n<p>Thanks in advance for any help offered.</p>\n"},{"tags":["ruby-on-rails","ruby","xslt","gem","bundler"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":12690991,"title":"exslt features not working in ruby-xslt gem","body":"<p>I have a Rails app and use Bundler to manage gems.\nI use the ruby-xslt gem for XSLT transformations.\nThe gem is not recognizing exslt features like node-set().</p>\n\n<p>Here’s the stylesheet I’ve been testing with</p>\n\n<pre><code>&lt;xsl:stylesheet version=\"1.1\" \n        xmlns=\"http://max.gov\" \n        xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" \n        xmlns:pre=\"http://max.gov\"\n        xmlns:exslt=\"http://exslt.org/common\"&gt;\n        &lt;xsl:output method=\"xml\" version=\"1.0\" encoding=\"UTF-8\" indent=\"yes\"/&gt;\n\n        &lt;!--The fabricated xml I want to access with exslt:node-set()--&gt;\n        &lt;xsl:variable name=\"PRE\"&gt;\n                    &lt;root&gt;\n                                &lt;item/&gt;\n                                &lt;item/&gt;\n                    &lt;/root&gt;\n        &lt;/xsl:variable&gt;\n\n        &lt;xsl:template match=\"/\"&gt;\n                    &lt;results&gt;\n                                &lt;run1 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n                                            &lt;results&gt;\n                                            &lt;xsl:for-each select=\"exslt:node-set($PRE)//pre:item\"&gt;\n                                                        &lt;success position=\"{position()}\"/&gt;\n                                            &lt;/xsl:for-each&gt;\n                                            &lt;/results&gt;\n                                &lt;/run1&gt;\n                                &lt;run2 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n                                            &lt;results&gt;\n                                            &lt;xsl:for-each select=\"exslt:node-set($PRE)//pre:item\"&gt;\n                                                        &lt;success position=\"{position()}\"/&gt;\n                                            &lt;/xsl:for-each&gt;\n                                            &lt;/results&gt;\n                                &lt;/run2&gt;\n                    &lt;/results&gt;\n        &lt;/xsl:template&gt;\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>Here’s output I get when using XML::XSLT in our app:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;results xmlns=\"http://max.gov\" xmlns:pre=\"http://max.gov\" xmlns:exslt=\"http://exslt.org/common\"&gt;\n   &lt;run1 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n    &lt;results/&gt;\n  &lt;/run1&gt;\n&lt;/results&gt;\n</code></pre>\n\n<p>(Note that not only did the node-set function not work, the  element got skipped altogether.)\nThe code is basically this:</p>\n\n<pre><code>xslt = XML::XSLT.new()\nxslt.xml = @xml         # @xml string\nxslt.xsl = @record.xslt # xslt is stored in db\nresult = xslt.serve\nrender :xml =&gt; result\n</code></pre>\n\n<p>Here’s the expected output</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n    &lt;results xmlns=\"http://max.gov\" xmlns:pre=\"http://max.gov\" xmlns:exslt=\"http://exslt.org/common\"&gt;\n       &lt;run1 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n          &lt;results&gt;\n             &lt;success position=\"1\"/&gt;\n             &lt;success position=\"2\"/&gt;\n          &lt;/results&gt;\n       &lt;/run1&gt;\n       &lt;run2 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n           &lt;results&gt;\n             &lt;success position=\"1\"/&gt;\n             &lt;success position=\"2\"/&gt;\n           &lt;/results&gt;\n       &lt;/run2&gt;\n&lt;/results&gt;\n</code></pre>\n\n<p>I get this correct result when doing any of the following…</p>\n\n<p><ul>\n<li>Run xsltproc from command line</li>\n<li>Run the following in the Rails console</p>\n\n<blockquote>\n  <blockquote>\n    <p>xslt = XML::XSLT.new\n    xslt.xml = File.read('data.xml')<br>\n    xslt.xsl = File.read('test.xsl')\n    xslt.serve</li>\n    </ul></p>\n  </blockquote>\n</blockquote>\n"},{"tags":["ruby-on-rails","activerecord","model"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":12,"score":2,"question_id":13157987,"title":"Triggering dependent: :destroy with overridden destroy-method","body":"<p>In our application we've overridden the ActiveRecord destroy method so that our records do not get deleted (so the user can undelete). Like so:</p>\n\n<pre><code>def destroy\n  self.is_deleted = true\n  self.save\n  freeze\nend\n</code></pre>\n\n<p>However, this seems to have disabled the dependent destroy on our <code>has_many</code> relationships. In other words, if <code>destroy</code> is called on a parent object, the child objects of <code>has_many</code> do not get destroyed (they don't get deleted, i.e, SQL '<code>DELETE...</code>', nor is the overridden <code>destroy</code>-method called).</p>\n\n<p>How do I trigger the destruction of the child objects.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13157902,"title":"How to authenticate facebook user using devise through api?","body":"<p>I have devise for authentication and also i have added omniauth for facebook and twitter and now what i need is allow the user to login from iphone app</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'xxxxxxxx'}}\"\n</code></pre>\n\n<p>it gives out the token and user email if it is valid and incase not valid user it displays</p>\n\n<pre><code>{\"error\":\"Invalid email or password\"}\n</code></pre>\n\n<p>similarly how can i send the facebook id and password to check whether the user is valid or not?</p>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13157465,"title":"heroku run rake db:migrate failed: command not found","body":"<p>I'm a novie in heroku. When I was performing my CS169.1x homework2 (deploying an application) I ran into a problem with database filling using the following command: heroku run rake db:migrate. Here is terminal dump:</p>\n\n<pre><code>saasbook@saasbook:~/Documents/hw2_rottenpotatoes$ git pull heroku master\nFrom heroku.com:afternoon-cove-7289\n * branch            master     -&gt; FETCH_HEAD\nAlready up-to-date.\nsaasbook@saasbook:~/Documents/hw2_rottenpotatoes$ git push heroku master\nEverything up-to-date\nsaasbook@saasbook:~/Documents/hw2_rottenpotatoes$ heroku run rake db:migrate\nheroku run rake db:migrate: command not found\nsaasbook@saasbook:~/Documents/hw2_rottenpotatoes$ \n</code></pre>\n\n<p>What may be wrong? If there is error dump on heroku to check? </p>\n"},{"tags":["ruby-on-rails","testunit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13023351,"title":"assert_redirected_to usage?","body":"<p>Just starting out in using <code>Test::Unit</code> but having a problem nailing down a redirect test:</p>\n\n<pre><code>  test \"should destroy line_item\" do\n    assert_difference('LineItem.count', -1) do\n      delete :destroy, id: @line_item\n    end\n\n    assert_redirected_to controller: 'carts', action: 'show'\n  end\n</code></pre>\n\n<p>which throws the following error:</p>\n\n<pre><code>Failure: Expected response to be a redirect to &lt;http://test.host/carts/980190962&gt; but was a redirect to &lt;http://test.host/carts/980190963&gt;.\ntest_should_destroy_line_item(LineItemsControllerTest)\ntest/functional/line_items_controller_test.rb:47:in `block in &lt;class:LineItemsControllerTest&gt;'\n</code></pre>\n\n<p>The <a href=\"http://apidock.com/rails/ActionDispatch/Assertions/ResponseAssertions/assert_redirected_to\" rel=\"nofollow\">docs</a> state the following:</p>\n\n<p><strong>assert_redirected_to(options = {}, message=nil) public</strong></p>\n\n<p>Assert that the redirection options passed in match those of the redirect called in the latest action. This match can be partial, such that assert_redirected_to(:controller => \"weblog\") will also match the redirection of redirect_to(:controller => \"weblog\", :action => \"show\") and so on.</p>\n\n<p>but <code>assert_redirected_to controller: 'carts'</code> leads to an even more outright failure:</p>\n\n<pre><code>Failure: Expected response to be a redirect to &lt;http://test.host/carts&gt; but was a redirect to &lt;http://test.host/carts/980190963&gt;.\ntest_should_destroy_line_item(LineItemsControllerTest)\n</code></pre>\n\n<p>If the documentation is correct, what am I missing? If it is not, what alternatives do I have to test the redirect regardless of a matching id?</p>\n"},{"tags":["ruby-on-rails","sass","sprockets"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13155684,"title":"sass/sprockets: Generating 2 stylesheets that differ only in a few values","body":"<p>I'm working on a Rails project with quite some stylesheets written in sass. The layout is as follows right now:</p>\n\n<p>We have a manifest (application.sass) that requires a couple of other sass files:</p>\n\n<pre><code>// in application.sass:\n/*\n *= require reset\n *= require base\n *= require forms\n ...\n */\n</code></pre>\n\n<p>These other stylesheets all include a \"partial\" with some color definitions and use these extensively:</p>\n\n<pre><code>// in _colors.sass:\n$foreground: '#F00'\n$background: '#0F0'\n// ...\n\n\n// in base.sass:\n@import colors.sass\n#content\n  background-color: $background\n// ...\n\n\n// in forms.sass:\n@import colors.sass\nform\n  color: $foreground\n// ...\n</code></pre>\n\n<p>I'd now like to generate a copy of the resulting stylesheet that contains the same rules with just the color definitions swapped out (e.g. a red_application.sass that is an exact clone of application.sass with just all color definitions in _var.sass swapped out).</p>\n\n<p>I tried moving the importing of the color definitions into the manifest file like follows:</p>\n\n<pre><code>// in application.sass:\n/*\n *= require _colors.sass\n *= require reset\n *= require base\n *= require forms\n ...\n */\n\n// in red_application.sass:\n/*\n *= require _red_colors.sass\n *= require reset\n *= require base\n *= require forms\n ...\n */\n\n// in base.sass:\n// no @import\n#content\n  background-color: $background\n// ...\n\n\n// in forms.sass:\n// no @import\nform\n  color: $foreground\n// ...\n</code></pre>\n\n<p>Unfortunately, this does not work since the single stylesheets (base.sass, forms.sass) cannot be generated without the @import statement since they do not know about the variables used within them.</p>\n\n<p>How could I restructure our stylesheets to achieve my goal?</p>\n"},{"tags":["mysql","ruby-on-rails","osx","install","homebrew"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":384,"score":0,"question_id":10238393,"title":"OSX Lion Homebrew \"brew install mysql -v\" problems","body":"<p>I am working to install mysql locally using home brew and it keeps blowing up.  When I run brew doctor I do not get any errors, and the full verbose output of attempting to install mysql is <a href=\"https://gist.github.com/2424859\" rel=\"nofollow\">https://gist.github.com/2424859</a>, ending with:</p>\n\n<pre><code>MAKEFLAGS: -j4\nError: Failed executing: cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/Cellar/mysql/5.5.20 -DMYSQL_DATADIR=/usr/local/var/mysql -DINSTALL_MANDIR=/usr/local/Cellar/mysql/5.5.20/share/man -DINSTALL_DOCDIR=/usr/local/Cellar/mysql/5.5.20/share/doc/mysql -DINSTALL_INFODIR=/usr/local/Cellar/mysql/5.5.20/share/info -DINSTALL_MYSQLSHAREDIR=share/mysql -DWITH_SSL=yes -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DSYSCONFDIR=/usr/local/etc -DWITH_UNIT_TESTS=OFF -DWITH_READLINE=yes (mysql.rb:77)\nThese existing issues may help you:\n    https://github.com/mxcl/homebrew/issues/8063\n    https://github.com/mxcl/homebrew/issues/9142\n    https://github.com/mxcl/homebrew/issues/11710\n    https://github.com/mxcl/homebrew/issues/11754\nOtherwise, please report the bug:\n    https://github.com/mxcl/homebrew/wiki/reporting-bugs\n</code></pre>\n\n<p>. I am running osx lion, full xcode 4.3.2.  </p>\n\n<p>any ideas on what the primary issue is? </p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":11274125,"title":"Using rake notes with .html.erb files in Rails","body":"<p>I'm getting started with Rails (3.2.3), and have recently discovered the rake notes feature.</p>\n\n<p>This is working fine for .rb files, with comments like this:</p>\n\n<pre><code>     # TODO ...\n</code></pre>\n\n<p>According to the <a href=\"http://guides.rubyonrails.org/command_line.html#notes\" rel=\"nofollow\">documentation</a> is also works for .erb files.  I have tried using it in the .html.erb view files like this:</p>\n\n<pre><code>    &lt;!-- TODO ... --&gt;  \n</code></pre>\n\n<p>But this doesn't work.  Should it?  Any ideas on what might be going wrong?</p>\n\n<p>Appreciate your help!</p>\n"},{"tags":["ruby-on-rails","activerecord","logging","upload","blob"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13051949,"title":"How to disable ActiveRecord logging for a certain column?","body":"<p>I'm running into a problem which, in my opinion, must be a problem for most rails users but I could not find any solution for it yet.</p>\n\n<p>When, for instance, performing a file upload of a potentially large, binary file and storing it in the database, you most certainly don't want rails or ActiveRecord to log this specific field in development mode (log file, stdout). In case of a fairly big file, this causes the query execution to break and almost kills my terminal.</p>\n\n<p>Is there any reliable and non-hacky method of disabling logging for particular fields? Remember, I'm <em>not</em> talking about disabling logging for request parameters - this has been solved quite nicely.</p>\n\n<p>Thanks for any information on that!</p>\n"},{"tags":["ruby-on-rails","actionmailer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13157383,"title":"How to use 'mail' gem in rails 2.3.14 application","body":"<p>I have an rails application running on rails 2.3.14.\nI wanted to migrate to rails 3, but before that i wanted to replace TMail to mail gem, as in Rails 3 Action mailer uses mail gem.</p>\n\n<p>waht all configuration changes i need to do.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","functional-testing","assert-response"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":11451080,"title":"Why \"assert_response\" ignores the custom message in Rails?","body":"<p>In my functional test I verify the response status like that:</p>\n\n<pre><code>assert_response :error, \"My error message\"\n</code></pre>\n\n<p>However, Rails ignores my custom message and reports:</p>\n\n<blockquote>\n  <p>Expected response to be a &lt;:error>, but was &lt;201></p>\n</blockquote>\n\n<p>Any ideas why?</p>\n\n<p>I use Rails 3.2.6.</p>\n"},{"tags":["ruby-on-rails","query","syntax"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13156945,"title":"Rails query syntax","body":"<p>I'm kinda new on the Rails boat, I would like to know the difference between two types of syntax for queries</p>\n\n<p>The first one I tried is: </p>\n\n<pre><code>User.limit(8).order('created_at DESC').group('created_at').count\n</code></pre>\n\n<p>The second, which seems to be far more efficient and powerful: </p>\n\n<pre><code>User.count(:order =&gt;'DATE(created_at) DESC', :group =&gt;[\"DATE(created_at)\"], :limit =&gt; 8) \n</code></pre>\n\n<p>But I don't really understand the use case for both.\nI'm sure this is something obvious anyway... \nThanks!</p>\n"},{"tags":["html","ruby-on-rails"],"answer_count":3,"favorite_count":1,"up_vote_count":22,"down_vote_count":0,"view_count":15103,"score":22,"question_id":618948,"title":"how to add html id to rails form_tag","body":"<p>I am using Rails 2.2.2 and I would like to add an id to the html form code generated by the form_tag. </p>\n\n<pre><code>&lt;% form_tag session_path do -%&gt;      \n&lt;% end -%&gt;\n</code></pre>\n\n<p>Currently produces:</p>\n\n<pre><code>&lt;form action=\"/session\" method=\"post\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Would like it to produce:</p>\n\n<pre><code>&lt;form id=\"login_form\" action=\"/session\" method=\"post\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>The <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#M001697\" rel=\"nofollow\">api</a> isn't really any help and I've tried adding various combinations of</p>\n\n<pre><code>:html =&gt; {:id =&gt; 'login_form'}\n</code></pre>\n\n<p>with no luck. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13155510,"title":"Add DateTime offset in seconds","body":"<p>I have a DateTime in UTC, and would like add an offset which is provided in seconds</p>\n\n<pre><code>#json parsed - utc offset in seconds - turned into integer\n@utc_offset = result[\"UTCOffsetMillis\"].to_i\n#json parsed - utc date\nstart_date_string = result[\"startDate\"].split(\"-\")\nstart_date = DateTime.new(start_date_string[0].to_i, start_date_string[1].to_i,start_date_string[2].to_i)\n</code></pre>\n\n<p>How do I add this offset in seconds to start_date??</p>\n\n<p>Rails 3.2.3\nRuby 1.9.2p320</p>\n"},{"tags":["ruby-on-rails","activerecord","extend"],"answer_count":5,"favorite_count":27,"up_vote_count":30,"down_vote_count":0,"view_count":13460,"score":30,"question_id":2328984,"title":"Rails extending ActiveRecord::Base","body":"<p>I've done some reading about how to extend ActiveRecord:Base class so my models would have some special methods. What is the easy way to extend it (step by step tutorial).\nThx!</p>\n"},{"tags":["sql","ruby-on-rails","postgresql","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13155462,"title":"Fetch posts from non blocking users","body":"<p>I'm trying to fetch some posts from users that isn't blocking \"me\". Se models below:</p>\n\n<pre><code>User\n  id\n  username\n  ....\n\nPost\n  id\n  user_id\n  content\n  ...\n\nBlockings\n  blocker_id\n  blocked_id\n</code></pre>\n\n<p>I need to fetch posts from <strong>all</strong> users that isn't blocking me.</p>\n\n<p>I fetch all posts with:</p>\n\n<pre><code>@posts Post.all\n</code></pre>\n\n<p>But how do I joins this together.</p>\n\n<p>Pseudo</p>\n\n<pre><code>SELECT * FROM posts WHERE \"posts.user_id isn't blocking me\"\n</code></pre>\n\n<p>I have a helper called <code>current_user</code> that returns the current logged in user \"me\".</p>\n"},{"tags":["ruby-on-rails","ruby","hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13156150,"title":"How to execute restart.txt ruby on rails shared hosting","body":"<p>i've created restart.txt in the tmp folder, but when i upload some changes to the site, there's nothing changing, so how can i execute the restart.txt manually? or it should start automatically?</p>\n"},{"tags":["ruby-on-rails","geojson","wkt"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13155815,"title":"Render as GeoJSON (or selectively as WKT/WKB) using MIME-Types","body":"<p>I have Rails with <code>PostGIS</code>, <code>activerecord-postgis-adapter</code> and <code>rgeo-geojson</code> running.</p>\n\n<p>At the moment I can use default \"object.json\" URLs to get a JSON string with WKT/WKB format. It looks like this:</p>\n\n<pre><code>{\"description\":null,\"id\":1,\"position\":\"POINT (10.0 47.0)\"}\n</code></pre>\n\n<p>But now I want to have a custom MIME-Type, so I can call \"object.geojson\" to get GeoJSON format like this:</p>\n\n<pre><code>{\"description\":null,\"id\":1,\"position\":{\"type\":\"Point\",\"coordinates\": [10.0, 47.0]}}\n</code></pre>\n\n<p>The only way I found to set the JSON-encoder to GeoJSON was to set it globally using <code>RGeo::ActiveRecord::GeometryMixin.set_json_generator(:geojson)</code> and <code>RGeo::ActiveRecord::GeometryMixin.set_json_generator(:wkt)</code>. <strong>But I just want to set it locally, is this possible?</strong></p>\n\n<p>I already added <code>Mime::Type.register \"application/json\", :geojson, %w( text/x-json application/jsonrequest )</code> to <code>mime_types.rb</code> and it works fine: I can use this code in my controller:</p>\n\n<pre><code>respond_to do |format|\n  format.json { render json: @object }\n  format.geojson { render text: \"test\" }\nend\n</code></pre>\n\n<p>I hope someone can tell me how to render some specific object to GeoJSON without setting the global JSON renderer to <code>:geojson</code>. !?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>My objects look like this in Rails Console:</p>\n\n<p><code>#&lt;Anchor id: 1, description: nil, position: #&lt;RGeo::Geos::CAPIPointImpl:0x3fc93970aac0 \"POINT (10.0 47.0)\"&gt;&gt;</code></p>\n"},{"tags":["ruby-on-rails","ruby","join","yaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13155548,"title":"Loading yaml from file and join fails","body":"<p>I try to load a yaml file into an array but it fails with undefined method `join' for \"a b c\":String</p>\n\n<pre><code># Check certain temporarily emails\n# Throw notice not accepted use other email\nrequire 'yaml'\nbad_hostnames = YAML::load(File.read(\"#{Rails.root}/config/bad_hosts.yml\"))\nif /^(#{bad_hostnames.join(\"|\")})$/.match(host)\n  errors.add(:email, \"Please not use a disposable mailbox\")\nend\n</code></pre>\n\n<p>So i required yaml <em>before and on top of the model, controller where I load the yml in</em>:</p>\n\n<pre><code>require 'yaml'\n</code></pre>\n\n<p>Still same result, in rails console this works flawlessly, what am I missing?\nThe above code is inside my user.rb model, in console it works</p>\n\n<p>EDIT:\nbad_hosts.yml looks like (shortened) 1 provider the line</p>\n\n<pre><code>0-mail.com\n10minutemail.com\n30minutemail.com\n4warding.net\n</code></pre>\n"}]}
{"total":93231,"page":17,"pagesize":100,"questions":[{"tags":["ruby-on-rails","migration"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13155453,"title":"\":first\" migration argument not working?","body":"<p>I wanted to add a new column:</p>\n\n<pre><code>class AddNameToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :name, :string, :first =&gt; true\n  end\nend\n</code></pre>\n\n<p>I included the argument <code>:first</code> to place the column in front of all the others. But didn't seem to work:</p>\n\n<pre><code>create_table \"users\", :force =&gt; true do |t|\n    t.string   \"email\",                  :default =&gt; \"\", :null =&gt; false\n    t.string   \"encrypted_password\",     :default =&gt; \"\", :null =&gt; false\n    t.string   \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer  \"sign_in_count\",          :default =&gt; 0\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string   \"current_sign_in_ip\"\n    t.string   \"last_sign_in_ip\"\n    t.string   \"name\"\n  end\n</code></pre>\n\n<p>Am I doing something wrong?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":523,"score":4,"question_id":10355477,"title":"Is there an opposite of include? for Ruby Arrays?","body":"<p>I've got the following logic in my code:</p>\n\n<pre><code>if !@players.include?(p.name) do\n  ...\nend\n</code></pre>\n\n<p><code>@players</code> is an array.  Is there a method so I can avoid the <code>!</code>?</p>\n\n<p>Ideally, this snippet would be:</p>\n\n<pre><code>if @players.does_not_include?(p.name)  do\n  ...\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.1","admin","administrator","activeadmin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":771,"score":0,"question_id":7927111,"title":"ActiveAdmin Alternatives","body":"<p>I have been using the pretty looking <a href=\"http://activeadmin.info/\" rel=\"nofollow\">active admin</a> recently and ran in to some issues happening across my application with a performance issue and other things including the taking over of the clean and nice \"search\" keyword used by the Sunspot gem (like Model.search) which is replaced by the meta_search.</p>\n\n<p>So I am now unhappy with ActiveAdmin and would like to see if there are some nice alternatives out there that can give a good administration framework as well as give the ability to browse data, since I will be deploying on heroku and browsing the database directly there without something like active_admin is not that simple.</p>\n\n<p>Any suggestions or pointers to admin frameworks will be much appreciated</p>\n"},{"tags":["ruby-on-rails","json","caching","amazon","amazon-cloudfront"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13155260,"title":"Dynamic content from cloudfront - can I put API results (JSON) from Rails?","body":"<p>I see that cloudfront supports dynamic content.</p>\n\n<p>Could anyone guide how I could go about doing this in Rails. For instance, I have, api.test.com/popular.json which I would like to be served from cloudfront preferably, but probably update itself every few hours.</p>\n\n<p>For static assets, I have been able to do it using Rails asset_host setting. But I have not been able to find enough guides on dynamic content. Any pointers would be useful.</p>\n"},{"tags":["ruby-on-rails","facebook","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13155088,"title":"Rails with Devise and OmniAuth - how to display Facebook login page in lightbox?","body":"<p>I have a Rails app with Devise and Facebook OmniAuth. Is there some reasonable way to display FB auth dialog in the ajax lightbox? I'll also need to connect the callback somehow to the OmniAuth. </p>\n\n<p>Managed to get it working in a separate popup, but that's not exactly perfect in browsers like IE.</p>\n\n<p>Also would be nice to utilize Twitter Bootstrap modal window for the lightbox.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13028660,"title":"Rails: form for different controller","body":"<p>I'm developing a rails app with a landingpage. On the landingpage, the user can sign up for the app. For login, there is an extra view with an extra controller.</p>\n\n<p>It looks like this:</p>\n\n<pre><code>views/landinpage/index.html --&gt; sign up form\nviews/login/index.html --&gt; login form\n</code></pre>\n\n<p>but i only want to have one controller</p>\n\n<pre><code>controllers/login_controller --&gt; create new user from sign up form &amp; check login data\n</code></pre>\n\n<p>so i have to get a connection between the landingpage view and the login_controller.\nThis is my try:</p>\n\n<pre><code>&lt;%= form_for @login, :url =&gt; { :controller =&gt; \"login_controller\", :action =&gt; \"create\" }, :html =&gt; {:method =&gt; :post} do |f| %&gt;\n</code></pre>\n\n<p>but i throws a route error:</p>\n\n<pre><code>No route matches {:controller=&gt;\"login_controller\", :action=&gt;\"create\"}\n</code></pre>\n\n<p>I already defined login resources in routes.rb, but it seems that the probleme is elsewhere?</p>\n\n<pre><code>resources :logins\n</code></pre>\n\n<p>any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","integration-testing","capybara","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":250,"score":1,"question_id":9755185,"title":"Minitest integration testing: session not tearing down?","body":"<p>I recently switched a very simple rails app from rspec to minitest. I also use capybara and factory_girl.</p>\n\n<p>I have 3 separate integration test files, all of which involve logging the user in using something along the lines of:</p>\n\n<pre><code>before(:each) do\n  user = Factory(:user)\n  visit login_path\n  fill_in \"Email\", :with =&gt; user.email\n  fill_in \"Password\", :with =&gt; user.password\n  click_button \"Log in\"\nend\n</code></pre>\n\n<p>After I switched to minitest, it seems as if the sessions ceased to tear down after each test. For instance, I would test login using the above code in a test file named \"users_integration_test.rb\" and when it begins running another test file, say \"sessions_integration_test.rb\", the user is already logged in before I can log in again using the above code.</p>\n\n<p>My question is: Is this an intentional difference between rspec and minitest, and I simply need to logout the user after each test? Or did I make a mistake setting up minitest? </p>\n\n<p>I am using the same minitest_helper file as in the Minitest Railscast.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":415,"score":2,"question_id":6318834,"title":"Map objects based on index value","body":"<p>Suppose that i have 2 objects, where each one has a particular slot numbered from 1-5 (unique). Say that object1 has slot = 3 and object2 slot = 5.\nWhat is an effective way to create a hash like :</p>\n\n<pre><code>{ 1 =&gt; nil, 2 =&gt; nil, 3 =&gt; object1, 4 =&gt; nil, 5 =&gt; object2}\n</code></pre>\n\n<p>I suppose map could be used, but what's the best way ?</p>\n\n<p>EDIT : 5 is just an example, please pretend that you do not know the number of slots.</p>\n"},{"tags":["ruby-on-rails","performance","heroku","newrelic-rpm"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":124,"score":5,"question_id":12181133,"title":"Strange TTFB (time to first byte) issue","body":"<p>We're in the process of improving performance of the our rails app hosted at Heroku (rails 3.2.8 and ruby 1.9.3). During this we've come across one alarming problem for which the source seems to be extremely difficult to track. Let me quickly explain how we experience the problem and how we've tried to isolate it.</p>\n\n<p>--</p>\n\n<p>Since around June we've experienced weird lag behavior in Time to First Byte all over the site. The problems is obvious from using the site (sometimes the application doesn't respond for 10-20 seconds), and it's also present in waterfall analysis via webpagetest.org.\nWe're based in Denmark but get this result from any host.</p>\n\n<p>To confirm the problem we've performed a benchmark test where we send 300 identical requests to a simple page and measured the response time.\nIf we send 300 requests to the front page the median response time is below 1 second, which is fairly good. What scares us is that 60 requests takes more that double that time and 40 of those takes more than 4 seconds. Some requests take as much as 16 seconds.</p>\n\n<p>None of these slow requests show up in New Relic, which we use for performance monitoring. No request queuing shows up and the results are the same no matter how high we scale our web processes.\nStill, we couldn't reject that the problem was caused by application code, so we tried another experiment where we responded to the request via rack middleware.</p>\n\n<p>By placing this middleware (TestMiddleware) at the beginning of the rack stack, we returned a request before it even hit the application, ensuring that none of the following middleware or the rails app could cause the delay.</p>\n\n<pre><code>Middleware setup:\n$ heroku run rake middleware\nuse Rack::Cache\nuse ActionDispatch::Static\nuse TestMiddleware\nuse Rack::Rewrite\nuse Rack::Lock\nuse Rack::Runtime\nuse Rack::MethodOverride\nuse ActionDispatch::RequestId\nuse Rails::Rack::Logger\nuse ActionDispatch::ShowExceptions\nuse ActionDispatch::DebugExceptions\nuse ActionDispatch::RemoteIp\nuse Rack::Sendfile\nuse ActionDispatch::Callbacks\nuse ActiveRecord::ConnectionAdapters::ConnectionManagement\nuse ActiveRecord::QueryCache\nuse ActionDispatch::Cookies\nuse ActionDispatch::Session::DalliStore\nuse ActionDispatch::Flash\nuse ActionDispatch::ParamsParser\nuse ActionDispatch::Head\nuse Rack::ConditionalGet\nuse Rack::ETag\nuse ActionDispatch::BestStandardsSupport\nuse NewRelic::Rack::BrowserMonitoring\nuse Rack::RailsExceptional\nuse OmniAuth::Builder\nrun AU::Application.routes\n</code></pre>\n\n<p>We then ran the same script to document response time and got pretty much the same result. The median response time was around 130ms (obviously faster because it doesn't hit the app. But still 60 requests took more than 400ms and 25 requests took more than 1 second. Again, with some requests as slow as 16 seconds.</p>\n\n<p>One explanation could be related to slow hops on the network or DNS setup, but the results of traceroute looks perfectly OK.</p>\n\n<p>This result was confirmed from running the response script on another rails 3.2 and ruby 1.9.3 application hosted on Heroku - no weird behavior at all.</p>\n\n<p>The DNS setup follows Heroku's recommendations.</p>\n\n<p>--</p>\n\n<p>We're confused to say the least. Could there be something fishy with Heroku's routing network?\nWhy the heck are we seeing this weird behavior? How do we get rid of it? And why can't we see it in New Relic?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13154177,"title":"Rails test adding unwanted parameter to assert_redirected_to","body":"<p>I have a test in my functional test which asserts the redirect after a remove is correct:</p>\n\n<pre><code>assert_redirected_to terrain_tip_url(terrain_id: entities(:deroos))\n</code></pre>\n\n<p>This should result in testing whether the url is: <a href=\"http://test.host/terrains/:terrain_id/tips\" rel=\"nofollow\">http://test.host/terrains/:terrain_id/tips</a> and in the application that is the exact url that is generated. However, in the test case this results in the url being: <a href=\"http://test.host/terrains/:terrain_id/tips/:id\" rel=\"nofollow\">http://test.host/terrains/:terrain_id/tips/:id</a>, which results in a failing test case:</p>\n\n<pre><code>Expected response to be a redirect to &lt;http://test.host/terrains/446801721/tips/495319887&gt; but was a redirect to &lt;http://test.host/terrains/446801721/tips&gt;\n</code></pre>\n\n<p>Why does the terrain_tip_url include an id parameter that I never set? How can I prevent this from happening?</p>\n"},{"tags":["ruby-on-rails","ruby","gem"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1247,"score":1,"question_id":225637,"title":"Anyone using RailRoad diagrams generator?","body":"<p>I recently installed RailRoad gem to generate an .svg diagram of my app's models and controllers.</p>\n\n<p>The rake task keeps breaking with a similar error:</p>\n\n<pre><code>1.8/usr/lib/ruby/gems/1.8/gems/activesupport-1.4.4/lib/active_support/dependencies.rb:263:in `load_missing_constant': uninitialized constant\n</code></pre>\n\n<p>I tried the rake task on 2 seperate apps and the error keeps appearing with a different \"constant\" name.</p>\n\n<p>Anyone using it with similar problems?</p>\n"},{"tags":["ruby-on-rails","ruby","foreman"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":376,"score":0,"question_id":8587588,"title":"Restart single process with Foreman","body":"<p>I've been using foreman for a while now to scale my various ruby processes in a centralized manner, and it is working perfectly for me . </p>\n\n<p>Anyways I would like to have some feature to restart a process or even to give it more control like to kill a process and start it again, in the current implementation when I kill one process the whole process in the main foreman stop . any workaround or solution here  ?</p>\n\n<p>Thanks in advance </p>\n"},{"tags":["css","ruby-on-rails","asset-pipeline","font-face"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":13009484,"title":"How to properly add '?i#efix' to a font path in rails?","body":"<p>It is <a href=\"http://www.fontspring.com/blog/fixing-ie9-font-face-problems\" rel=\"nofollow\">recommended</a> to add <code>?#iefix</code> to the end of .eot font paths to fix yet another IE erratic behaviour :</p>\n\n<pre><code>@font-face {\n    font-family: 'MyWebFont';\n    src: url('webfont.eot'); /* IE9 Compat Modes */\n    src: url('webfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */\n         url('webfont.woff') format('woff'), /* Modern Browsers */\n         url('webfont.ttf')  format('truetype'), /* Safari, Android, iOS */\n         url('webfont.svg#svgFontName') format('svg'); /* Legacy iOS */\n    }\n</code></pre>\n\n<p><strong>Is it possible to do that using <code>asset_path</code>, but without an ugly</strong> <code>+ \"?#iefix\"</code> <strong>hack ?</strong></p>\n"},{"tags":["ruby-on-rails","scalability","passenger","thin","mongrel"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13097505,"title":"Which one of these is a better option to use alongside \"latest rails\" application? Mongrel, Thin, WEBrick and Passenger","body":"<p>I have been playing around and evaluating other options to rails' default WEBrick server and Thin was the most painless and clean thing which worked very well!!</p>\n\n<p>which one of these Mongrel, Thin, WEBrick and Passenger would you recommend and why..?\nare there any scalability perks(cluster friendly or configs which can handle some sort of scale) which come with any of these servers.. or should scalability even be a parameter while evaluating them?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","view","localization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13153775,"title":"Why I can`t use symbol in Rails 3 view Lazy Lookup?","body":"<p>I have following table in view:</p>\n\n<pre><code># views/students/index.html.haml\n%table.table\n  %thead\n    %tr\n      %th=t :first_name  # doesn`t work\n      %th=t '.last_name' # works\n  %tbody\n    - @students.each do |s|\n      %tr\n        %td=s.first_name\n        %td=s.last_name\n</code></pre>\n\n<p>This is my locales file:</p>\n\n<pre><code>pl:\n  students:\n    index:\n      first_name: \"Imię\"\n      last_name: \"Nazwisko\"\n</code></pre>\n\n<p>Is possible to use symbols instead of string '.first_name' ??</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13150485,"title":"How to specify gem version to an older version?","body":"<p>I tried to use a specific version for gem, as specified by Michael Hartl's ruby on rails tutorial. </p>\n\n<p>I typed in <code>$ gem update --system 1.8.24</code></p>\n\n<p>but i got this output:</p>\n\n<p><code>Latest version currently installed. Aborting.</code></p>\n\n<p>How do I prevent this command from aborting?  The tutorial notes that I must use the 1.8.24 version.  Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","scaffolding"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":63,"score":4,"question_id":13151960,"title":"How to edit multiple models in one form?","body":"<p>I got a task from my trainer. I want to edit two models in one form. \nFor example, we have two entities student and address. In the new student part i want to add both student details and address. How can i achieve this through scaffolding in ruby on rails?</p>\n"},{"tags":["ruby-on-rails","rails-admin"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13153375,"title":"How to disable has_many_association for rails admin?","body":"<p>I commented out the has_many , yet the same export page with has many after restart the rails server </p>\n\n<pre><code> config.model 'User' do\n\n  #   # You can copy this to a 'rails_admin do ... end' block inside your user.rb model definition\n\n  #   # Found associations:\n\n      # configure :canvases, :has_many_association \n      # configure :level, :has_many_association \n      # configure :tags, :has_many_association \n\n  #   # Found columns:\n\n      configure :id, :integer \n      configure :name, :string \n      configure :email, :string \n      configure :raw_info, :serialized \n      configure :created_at, :datetime \n      configure :updated_at, :datetime \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","linux","ruby-on-rails-3","rubygems"],"answer_count":6,"favorite_count":6,"up_vote_count":26,"down_vote_count":0,"view_count":10673,"score":26,"question_id":4922700,"title":"Ruby 1.9.2 and Rails 3 cannot open rails console","body":"<pre><code>[gkaykck@main myApplication]$ rails console\n/usr/local/lib/ruby/1.9.1/irb/completion.rb:9:in `require': no such file to load -- readline (LoadError)\n    from /usr/local/lib/ruby/1.9.1/irb/completion.rb:9:in `&lt;top (required)&gt;'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands/console.rb:3:in `require'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands/console.rb:3:in `&lt;top (required)&gt;'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands.rb:20:in `require'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands.rb:20:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have installed rails 3 on ruby 1.9.2p136, which is ok i guess. But i cannot start rails console and it gives me the error i copied. The apps worked great with ruby 1.8.7 and i never saw an error like this.</p>\n\n<p>Any ideas what it could be?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13151176,"title":"NameError: undefined local variable or method in rspec for rails 3.2.8","body":"<p>There is a method assign_user_rights which is defined in application controller in rails 3.2.8 app. In applications_controller_spec.rb, there is a test case for the method:</p>\n\n<pre><code>   it \"should assign_user_right\" do\n      .....\n      assign_user_rights\n      session[:index_all_users].should be_true\n    end\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Failure/Error: assign_user_rights\n     NameError:\n       undefined local variable or method `assign_user_rights' for #&lt;RSpec::Core::ExampleGroup::Nested_1::Nested_4:0x57550e0&gt;\n</code></pre>\n\n<p>Since assign_user_rights is defined in application controller, it should be readily visible in its spec file. However it is not the case as we see. What could be the problem with the code? Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":6,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":2353,"score":7,"question_id":180290,"title":"What are the limits of ruby on rails?","body":"<p>I have a memory of talking to people who have got so far in using Ruby on Rails and then had to abandon it when they have hit limits, or found it was ultimately too rigid.  I forget the details but it may have had to do with using more than one database.</p>\n\n<p>So what I'd like is to know is what features/requirements fall outside of Ruby on Rails, or at least requires such contortions that it is better to use another more flexible framework, even though you may have to lose some elegance or write extra boilerplate code.  </p>\n"},{"tags":["ruby-on-rails","jquery-ajax"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13121850,"title":"Ruby on Rails will paginate with ajax","body":"<p>I have used will_paginate in my rails application but i come across a situation where i need to use to will_paginate inside a block where the page should not reload when i click the pagination number, could anyone help me saying how to integrate will_paginate with ajax to avoid page reloading......?</p>\n"},{"tags":["mysql","ruby-on-rails","aptana3","ubuntu-12.04"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":11625216,"title":"Aptana with mysql for RoR","body":"<p>I have mysql installed in my Ubuntu system, And I have Aptana for RoR, how to integrate mysql with aptana fro my RoR application. Is their any plugin or something which I have to do, or what can I do..</p>\n"},{"tags":["ruby-on-rails","curl","rubygems","curb","feedzirra"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13010444,"title":"Setting up Curb in windows","body":"<p>I'm trying to use <a href=\"https://github.com/pauldix/feedzirra\" rel=\"nofollow\">feedzirra</a> with Rails 3 On Windows 7, but have been having real issues getting Curl and Curb installed.  I found this question <a href=\"http://stackoverflow.com/questions/1511865/install-ruby-curb-gem-in-windows-xp\">Install Ruby Curb gem in windows XP</a> which enabled me to get the gem installed successfully, but now when I try and start my rails server I get the following error:</p>\n\n<pre><code>C:/Ruby193/lib/ruby/gems/1.9.1/gems/curb-0.8.1/lib/curb.rb:1:in `require': 193: %1 is not a valid Win32 application.   - C:/Ruby193/lib/ruby/gems/1.9.1/gems/curb-0.8.1/lib/curb_core.so (LoadError)\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/curb-0.8.1/lib/curb.rb:1:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/feedzirra-0.0.24/lib/feedzirra.rb:4:in `require'\n    ...\n</code></pre>\n\n<p>the file curb_core.so does exist, but windows doesn't know how to open it and says it's not a valid Win32 application.  Any ideas how I can get this to work? Or does anyone know of any other good RSS readers for rails, that don't use Curb?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13152592,"title":"Is there a way to force a \"before_destroy\" callback to be trigered first?","body":"<p>I have a model which specifies a before destroy callback. Something like:</p>\n\n<pre><code>Class User &lt; ActiveRecord::Base\n  before_destroy :do_destroy\n  acts_as_destroyable\n\n  private\n  def do_destroy\n    puts \"A\"\n  end\nend\n\nmodule ActsAsDestroyable\n  def self.included(base)\n    base.send(:extend, ActsMethods)\n  end\n\n  module ActsMethods\n    def acts_as_destroyable(options = {})\n      self.send(:include, InstanceMethods)\n    end\n\n    module InstanceMethods\n      def do_something\n        puts \"A0\"\n      end\n\n      def self.included(base)\n        base.before_destroy :do_something\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Now since the Destroyable module works with Users's assosiacions it needs to have its \"do_domething\" method executed before the \"do_destroy\" callback. Any ideas how can I move it up the callback queue?</p>\n"},{"tags":["ruby-on-rails","rspec"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13152452,"title":"Rspec configuration - disable request spec behaviour","body":"<p>I have an 'spec/acceptance' folder with the specs that should load the full stack.</p>\n\n<p>I want to use the 'spec/integration' folder for specs that test interaction between models, but I don't want to load the full stack in those tests.</p>\n\n<p>But rspec automatically runs tests in this folder as 'request' specs, loading the full stack. How can I disable this for this particular folder?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":172,"score":0,"question_id":12263762,"title":"how to convert doc, docx files to pdf in ruby/rails","body":"<p>I'm working on a web app in rails that uses document files, that I need to convert it to pdf in a place in the project! I wanna a ruby or javascript convert doc, docx, and plain text as well to pdf file.</p>\n\n<p>My search get me to a lot of pdf generators gems like <a href=\"https://github.com/prawnpdf/prawn\" rel=\"nofollow\">prawn</a>, <a href=\"http://railscasts.com/episodes/220-pdfkit\" rel=\"nofollow\">pdfkit</a>. they are generating pdf from templates (html and css or from a code!).</p>\n\n<p>If not, is there any api or a documentations to read doc/docx formats so that I can write the converter myself !?</p>\n"},{"tags":["ruby-on-rails","ruby","validation","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13137729,"title":"Ruby on Rails - Validating columns of a CSV file by calling validation methods with the inject method","body":"<p>Here is the RoR code which I want to use to validate columns in a csv file.\nBut the values from the \"rowdata\" array is not passed to the validation methods. Any help is greatly appreciated.</p>\n\n<pre><code>#Ruby on Rails code\ndef validate_rows\n    count_row=0\n    #@passed_file is a csv file which is read from a submitted html form.\n    @parsed_file=CSV::Reader.parse(params[:dump][:csvfile])\n    @parsed_file.each  do |row|\n        # Array of columns to be validated\n        validate_cols = [:admission_no, :class_roll_no]\n        rowdata={'admission_no'=&gt;row[0],'class_roll_no'=&gt;row[1]}\n\n\n        #validate colums by sending value from the array (rowdata)  to a method injected\n        #by the following code. However value from rowdata array is not passed\n        #to the method.\n        if count_row &gt;=1\n            valid = validate_cols.inject(true){|valid_sum, col|\n                valid_sum &amp;&amp; send(\"validate_#{col}\", rowdata[col])\n            }\n            #if validation fails return row number.\n            if not (valid)\n                return count_row\n            end\n        end\n        count_row=count_row+1\n    end \n    #if validation suceeds return 0\n    return 0\nend\n\n#The following methods are called by the inject funnction (valid)\ndef validate_admission_no(passed_value)\n    if(passed_value)\n        return true\n        else\n        return false\n    end\nend\n\ndef validate_class_roll_no(passed_value)\n    if(passed_value)\n        return true\n        else\n        return false\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13151598,"title":"Track the details of a repository or a application folder using Rails","body":"<p>Is there a way to get/track the details of a repository or a application folder in Rails.\nI mean that getting the list of --</p>\n\n<ul>\n<li>No of files</li>\n<li>No of classes</li>\n<li>No of folders</li>\n<li>No of tables in a database schema etc.</li>\n</ul>\n\n<p>I need the details of the folder given.</p>\n\n<p>Thank You</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13133441,"title":"Testing Creation Variable Assignments in Rspec","body":"<p>I'm creating a rspec test to see if the instance variable in the create method retains the data built. However, my test doesn't work since I'm returned with this error...</p>\n\n<pre><code>Failure/Error: assigns[:micropost]should eq(@post)\nexpected: #&lt;Micropost id: 1, content: \"Hello there\", user_id: 1&gt;\ngot: #&lt;Micropost id: 2, content: \"Hello there\", user_id: 1&gt;\n</code></pre>\n\n<p>My rspec test is</p>\n\n<pre><code>describe ::MicropostsController do\n\nbefore :each do\n  @post = FactoryGirl.create(:micropost)\nend\n\nit \"tests the instance variable in create method\" do\n    post :create, micropost: FactoryGirl.attributes_for(:micropost)\n    assigns(:micropost).should eq(@post)\nend\n</code></pre>\n\n<p>My FactoryGirl file is</p>\n\n<pre><code>FactoryGirl.define do\n\n factory :micropost do\n\n  content \"Hello there Bob!\"\n  user_id \"1\"\n  #even if I got rid of the double quotations around 1, the stringify key error still \n  #pops up\n\n end\n\nend\n</code></pre>\n\n<p>Here is the micropost controller create action code...</p>\n\n<pre><code>def create\n\n@micropost = Micropost.new(params[:micropost])\n\n respond_to do |format|\n\n  if @micropost.save\n\n    format.html { redirect_to @micropost, notice: 'Micropost was successfully create.' \n    }\n\n  else\n\n    format.html { render action: \"new\" }\n\n  end\n\n end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","internet-explorer"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13152035,"title":"Avoid download popup in Internet Explorer when loading file with new format in Rails","body":"<p>In my rails app, I've defined a new format called 'extension'. My extension format is responsible for rendering views for an external web browser extension that I've developed. So I can call</p>\n\n<p>/messages/new.extension</p>\n\n<p>and have code specific to my web browser extension rendered.</p>\n\n<p>This strategy works great until IE comes into play. On any IE version before 9, the browser doesn't know what to do with .extension files, and so IE defaults to a download popup like so:</p>\n\n<p><img src=\"http://i.stack.imgur.com/flP6b.jpg\" alt=\"enter image description here\"></p>\n\n<p>Any thoughts on how avoid this download popup? Is there maybe another format I can use instead?</p>\n"},{"tags":["css","ruby-on-rails","image","api","httparty"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13150777,"title":"Undefined Method in HTTParty class","body":"<p>I'm somewhat new to rails and every time I think I'm getting it I hit a wall. </p>\n\n<p>I'm using <code>HTTParty</code> and this <a href=\"http://snapito.com/paid-api.jsp\" rel=\"nofollow\">API</a>. I am just trying to get a response to show up in my index view to get the lowest level of the api working. </p>\n\n<p>It worked for me in the console but not when I tested it in the API. I'm getting an </p>\n\n<pre><code>undefined method `picture' for Snapshots:Class\n</code></pre>\n\n<p>error for my index view. </p>\n\n<p>Here is the HTTParty class</p>\n\n<pre><code>class Snapshots\n  include HTTParty\n\n  def initialize\n    @sitename = \"google.com\"\n  end\n\n  def picture\n    response = HTTParty.get(\"http://api.snapito.com/web/516e011353b62078731712566b01e143f56adf0b/full/diditmatter.herokuapp.com/lists\")\n\n    if respone.success?\n      response\n    end\n  end\nend\n</code></pre>\n\n<p>Here is my lists controller</p>\n\n<pre><code>def index\n    @it_works = Snapshots.picture\n\n    respond_with(@lists = List.all)\nend\n</code></pre>\n\n<p>And here is list view </p>\n\n<pre><code>&lt;%= @it_works %&gt;\n\n\n&lt;h1 class=\"page-header\"&gt;Projects at a glance&lt;/h1&gt; \n&lt;div class=\"span12 offset2\"&gt; \n &lt;% @lists.each do |list| %&gt; \n  &lt;div class=\"well row span4\"&gt;\n    &lt;div class=\"span3\"&gt;\n    &lt;/div&gt;  \n    &lt;div class=\"span4\"&gt;  \n</code></pre>\n\n<p>What do I seem to be overlooking here?</p>\n\n<p>EDIT</p>\n\n<p>@Benjamin fix worked, but I've come across a problem I'm not sure is related to rails. I'm not sure is I should open another question. But since the context is here and I'm not really even sure how to search this, I have to follow up here. </p>\n\n<p>That instance variable is returning the attached screen shot. Is this related to how I'm calling it from the API I linked to in the first paragraph? </p>\n\n<p><img src=\"http://i.stack.imgur.com/t91UT.png\" alt=\"enter image description here\">I've never seen this so not to sure where to look or how to approach. </p>\n"},{"tags":["ruby-on-rails","ftp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13151722,"title":"How to update files Ruby on rails in ftp server","body":"<p>In the hosting ftp server I see two folders 1)shared, 2) releases, i've tried to upload some changes to the site, but it not worked, i've tried it to all the releases version that there I have, also the folder shared - but there is not folder app, i don't know how can i implement some changes to the site??</p>\n\n<p>maybe i'am doing something wrong...any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby","xcode","rake","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":91,"score":-1,"question_id":13150693,"title":"\"Could not find Rake\" - Fresh Ruby on Rails install on OS X 10.8","body":"<pre>\nTrying to install RoR on OS X 10.8.  New to both Mac and RoR!\n\nFollowing directions here: \nhttp://www.justinball.com/2012/10/22/install-rvm-on-mac-osx-mountain-lion/\n\nInstalled XCode, Command Line Tools, XQuartz, Homebrew, gcc, latest RVM, executed \n\"rvm pkg install openssl\", and finally \"rvm install 1.9.3\"\n\nThere were some error messages along the way, which I will provide in a moment. \nHowever, the install seems successful based on the following:\n\n$ type rvm | head -n1\nrvm is a function\n$ rails -v\nRails 3.2.8\nruby --version\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin12.2.0]\n\nErrors/warnings during install included:\nWarning: Could not tap homebrew/dupes/vim over mxcl/master/vim\nThere has been an error fetching the ruby interpreter. Halting the installation.\n\nCreated a new directory named \"agile\", changed to the directory and executed: \n\"rails new demo\"\nGot \"`mkdir': Permission denied\" in the first line of the output\n\nThen tried \"sudo rails new demo\"\nGot \"Could not find Rake\" in the first line of the output\n\n(Full output provided at the end of this post.)\n\nTried various things to see if there was something wrong with rake, rails, ruby, or rvm, but all seems to come back normal.\n\nMichaels-MacBook-Pro:agile mh$ rake --version\nrake, version 0.9.2.2\nMichaels-MacBook-Pro:agile mh$ whereis rake\n/usr/bin/rake\nMichaels-MacBook-Pro:agile mh$ which rake\n/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin/rake\nMichaels-MacBook-Pro:agile mh$ which gem\n/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/gem\nMichaels-MacBook-Pro:agile mh$ rvm info\n\nruby-1.9.3-p286:\n\n  system:\n    uname:       \"Darwin Michaels-MacBook-Pro.local 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64\"\n    system:      \"downloads\"\n    bash:        \"/bin/bash => GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin12)\"\n    zsh:         \"/bin/zsh => zsh 4.3.11 (i386-apple-darwin12.0)\"\n\n  rvm:\n    version:      \"rvm 1.16.17 () by Wayne E. Seguin , Michal Papis  [https://rvm.io/]\"\n    updated:      \"7 hours 52 minutes 30 seconds ago\"\n\n  ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.9.3p286\"\n    date:         \"2012-10-12\"\n    platform:     \"x86_64-darwin12.2.0\"\n    patchlevel:   \"2012-10-12 revision 37165\"\n    full_version: \"ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin12.2.0]\"\n\n  homes:\n    gem:          \"/Users/mh/.rvm/gems/ruby-1.9.3-p286\"\n    ruby:         \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286\"\n\n  binaries:\n    ruby:         \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\"\n    irb:          \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/irb\"\n    gem:          \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/gem\"\n    rake:         \"/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin/rake\"\n\n  environment:\n    PATH:         \"/Users/mh/.rvm/gems/ruby-1.9.3-p286/bin:/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin:/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin:/Users/mh/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/git/bin\"\n    GEM_HOME:     \"/Users/mh/.rvm/gems/ruby-1.9.3-p286\"\n    GEM_PATH:     \"/Users/mh/.rvm/gems/ruby-1.9.3-p286:/Users/mh/.rvm/gems/ruby-1.9.3-p286@global\"\n    MY_RUBY_HOME: \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286\"\n    IRBRC:        \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286/.irbrc\"\n    RUBYOPT:      \"\"\n    gemset:       \"\"\n\n\nMichaels-MacBook-Pro:agile mh$ type rvm | head -n1\nrvm is a function\n\n\n\n\n===================================================================\nMichaels-MacBook-Pro:agile mh$ rails new demo\n      create  \n/Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir': Permission denied - /Users/mh/agile/demo (Errno::EACCES)\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:247:in `fu_mkdir'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:221:in `block (2 levels) in mkdir_p'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:219:in `reverse_each'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:219:in `block in mkdir_p'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:205:in `each'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:205:in `mkdir_p'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:51:in `block in invoke!'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:133:in `call'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:133:in `invoke_with_conflict_check'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:50:in `invoke!'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions.rb:95:in `action'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:15:in `empty_directory'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/generators/app_base.rb:103:in `create_root'\n    from (eval):1:in `create_root'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/task.rb:27:in `run'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:120:in `invoke_task'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `block in invoke_all'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `each'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `map'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `invoke_all'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/group.rb:238:in `dispatch'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/base.rb:425:in `start'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/commands/application.rb:38:in `'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/cli.rb:15:in `'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/bin/rails:7:in `'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:19:in `load'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:19:in `'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `eval'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `'\nMichaels-MacBook-Pro:agile mh$ sudo rails new demo\n/Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find rake (>= 0.8.7) amongst [actionmailer-3.2.8, actionpack-3.2.8, activemodel-3.2.8, activerecord-3.2.8, activeresource-3.2.8, activesupport-3.2.8, arel-3.0.2, builder-3.0.4, erubis-2.7.0, hike-1.2.1, i18n-0.6.1, journey-1.0.4, json-1.7.5, mail-2.4.4, mime-types-1.19, multi_json-1.3.6, polyglot-0.3.3, rack-1.4.1, rack-cache-1.2, rack-ssl-1.3.2, rack-test-0.6.2, rails-3.2.8, railties-3.2.8, rdoc-3.12, sprockets-2.1.3, thor-0.16.0, tilt-1.3.3, treetop-1.4.12, tzinfo-0.3.34] (Gem::LoadError)\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:777:in `block in activate_dependencies'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:766:in `each'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:766:in `activate_dependencies'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:750:in `activate'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems.rb:1232:in `gem'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:18:in `'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `eval'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `'\n</pre>\n"},{"tags":["ruby-on-rails","ruby","rake","rake-task"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13112703,"title":"syntax error when running rake task","body":"<p>I am new to ruby and rails, so I am still attempting to get a handle on the syntax and structure of ruby.  I am following <a href=\"http://dwradcliffe.com/2011/12/29/import-csv.html\" rel=\"nofollow\">a tutorial</a> to import a csv file using a task and rake. I keep getting a syntax error though. I am not sure what I am missing, I do not see any difference between the example and my code.</p>\n\n<pre><code>require 'csv'\n\n    desc \"Import Voters from CSV File\"\n\n    task :import =&gt; [:environment] do\n\n      file =\"db/my.csv\"\n\n      CSV.foreach(file, :headers =&gt; true) do |row|\n        Voter.create{\n          :last_name =&gt; row[0]\n        }  \n\n      end\n\n\n\n\n\n\n(See full trace by running task with --trace)\nErics-MacBook-Air:cloudvoters ecumbee$ rake db:import --trace\nrake aborted!\n/Users/ecumbee/Desktop/cloudvoters/lib/tasks/import.rake:11: syntax error, unexpected tASSOC, expecting '}'\n      :last_name =&gt; row[0], \n                   ^\n/Users/ecumbee/Desktop/cloudvoters/lib/tasks/import.rake:12: syntax error, unexpected '}', expecting '='\n    }  \n     ^\n</code></pre>\n"},{"tags":["ruby-on-rails","model"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13151309,"title":"trouble with my class","body":"<p>Can you please help me with the following problem? This I know is basic, but I seem to be missing something very basic. When i ask SectionEdit.new things seem to go wrong though I am pointing to the correct class name. Thanks for your help.</p>\n\n<p>here is the error i get.</p>\n\n<pre><code>$ edit = SectionEdit.new\nNameError: undefined local variable or method `class_name' for #&lt;Class:0x103675008&gt;\n    from /Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/dynamic_matchers.rb:50:in `method_missing'\n    from /Users/seydoukonate/Sites/simple_cms/app/models/section_edit.rb:3\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:469:in `load'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:469:in `load_file'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:639:in `new_constants_in'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:468:in `load_file'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:353:in `require_or_load'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:502:in `load_missing_constant'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:192:in `const_missing'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:190:in `each'\n    from /Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:190:in `const_missing'\n    from (irb):14\n</code></pre>\n\n<p><strong>I have defined my model 'page' as below</strong> </p>\n\n<pre><code>class SectionEdit &lt; ActiveRecord::Base\n  attr_accessible :admin_user_id, :section_id, :summary\n  belongs_to :editor, class_name =&gt; \"AdminUser\", :foreign_key =&gt; 'admin_user_id'\n  belongs_to :section\nend\n</code></pre>\n\n<p><strong>Admin user</strong></p>\n\n<pre><code>class AdminUser &lt; ActiveRecord::Base\n   attr_accessible :first_name, :last_name, :email, :username\n\n  has_and_belongs_to_many :pages\n  has_many :section_edits\n\n  scope :named, lambda{|first,last| where(:first_name =&gt; first,:last_name =&gt; last)}\nend\n</code></pre>\n\n<p><strong>Section</strong></p>\n\n<pre><code>class Section &lt; ActiveRecord::Base\n  attr_accessible :name, :position, :visible, :content_type, :content\n  belongs_to :page\n  has_many :section_edits\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3.2","asset-pipeline"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13151147,"title":"Adding path to asset pipeline, add js file to manifest, wrong path generated by javascript_include_tag","body":"<p>So we use git submodules to link external javascript/css dependencies to our project and place them in /vendor/externals. In order to use these within Rails, I've added them to the asset pipeline in application.rb like this:</p>\n\n<pre><code>config.assets.paths &lt;&lt;  Rails.root.join(\"vendor\",\"externals\",\"pushpop\")\n</code></pre>\n\n<p>For the sake of this example, lets say that the pushpop folder contains two files, pushpop.js and pushpop.css. I include these in the application manifests</p>\n\n<p>Javascript:</p>\n\n<pre><code>//= require pushpop\n</code></pre>\n\n<p>And stylesheets</p>\n\n<pre><code>*= require pushpop\n</code></pre>\n\n<p>In development, I'm expecting &lt;%= javascript_include_tag \"application\" %> and &lt;%= stylesheet_link_tag \"application\", :media => \"all\" %> to create </p>\n\n<pre><code>&lt;script src=\"http://localhost:3000/assets/pushpop.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;link href=\"http://localhost:3000/assets/pushpop.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\"&gt;\n</code></pre>\n\n<p>However, these tags are creating:</p>\n\n<pre><code>&lt;script src=\"http://localhost:3000/assets/pushpop/pushpop.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;link href=\"http://localhost:3000/assets/pushpop/pushpop.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\"&gt;\n</code></pre>\n\n<p>Now whats totally awesome is that if I manually hit <code>http://localhost:3000/assets/pushpop.js</code> in the browser, all is well with the world.</p>\n\n<p>Are my expectations off here, or am I doing something wrong?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13150983,"title":"Rails what is the difference between content_for and yield?","body":"<p>For example:  <code>content_for(:stuff)</code> vs <code>yield :stuff</code></p>\n\n<p>I know they are implemented slightly differently, but is there any real functionality difference?</p>\n\n<p>Is there a generally accepted best practice?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":1047,"score":8,"question_id":1711547,"title":"How to check if a param is true or false?","body":"<p>This is really racking my brain, but maybe I'm trying to hard.</p>\n\n<p>I'm passing a param via a URL (example.com?debug=true)</p>\n\n<p>So I basically want to say:</p>\n\n<pre><code>if params[:debug] == true\n do xyz\nelse\n do abc\nend\n</code></pre>\n\n<p>But for whatever reason that if statement just isn't doing like it seems like it should.</p>\n\n<p>Is there a better way to do that if/else statement based on a param being true or false?</p>\n\n<p>The debug param will either have a value of true, no value, or a value of false (as far as the URL goes).</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13147616,"title":"Migrate legacy database users to Devise","body":"<p>We have an old PHP app in MySQL that we're currently rewriting in Rails and PostgreSQL.\nI'm looking for a way to migrate users one-by-one when they first sign in to the new system, so that we migrate only active users.</p>\n\n<p>Is there a hook in <strong>Devise</strong> that I can use to catch a failed login towards the new database and check if the user exists in the old MySQL database and migrate the user if found.</p>\n\n<p>BTW, the Rails app can access both databases and the migration code is already in place that accepts old <code>username</code> as input.</p>\n\n<p>Or should I just simply make a separate _migration_assistant_ page that accepts old logins and initiates the migration?</p>\n\n<p>PS. any user can possibly have thousands of database records to migrate so it can take a bit of time, but we already make use of PosgreSQL's <code>COPY FROM</code> to speed it up (about a few secs per account).</p>\n\n<p><strong>EDIT:</strong>\nThere are currently about <strong>5000</strong> users and we expect roughly <strong>1000</strong> of them to return to the new site.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13150569,"title":"Do rails MVC naming convention work with words which plural form is \"-ies\" (e.g. replies)?","body":"<p>I was thinking of creating a model called <code>Reply</code>. I was wondering if Rails knows that its plural form is <code>replies</code> and not <code>replys</code>?</p>\n"},{"tags":["html","ruby-on-rails","css","google-chrome","web"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":9680,"score":6,"question_id":7466404,"title":"Chrome user agent stylesheet overwriting my site style","body":"<p>I have the following CSS that styles the link on one of my pages:</p>\n\n<pre><code>a:link, a:visited, a:active {\n    color: white;\n    text-decoration: none;\n    font-weight: bold;\n}\n</code></pre>\n\n<p>However, when I load it, they appear blue in Chrome and white in Firefox. The Chrome dev tools reveal that my style supposedly overwrites the user agent stylesheet:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FlIjd.jpg\" alt=\"enter image description here\"></p>\n\n<p>Why is it not showing correctly? I tried setting the charset at the top of my stylesheet:</p>\n\n<pre><code>@charset \"UTF-8\";\n\nhtml, body {\n    width: 100%;\n    height: 100%;\n    margin: 0;\n    font: 11px \"Lucida Grande\", Arial, Sans-serif;\n}\n\na:link, a:visited, a:active {\n    color: white;\n    text-decoration: none;\n    font-weight: bold;\n}\n\ninput[type=email], input[type=password] {\n    display: block;\n    -moz-border-radius: 4px;\n    -webkit-border-radius: 4px;\n    border: 1px solid #ACE;\n    font-size: 13px;\n    margin: 0 0 5px;\n    padding: 5px;\n    width: 203px;\n}\n</code></pre>\n\n<p>But it didn't help. My stylesheet is linked in the head with:</p>\n\n<pre><code>&lt;link href=\"/assets/global.css?body=1\" media=\"screen\" rel=\"stylesheet\"\ntype=\"text/css\"&gt;\n</code></pre>\n\n<p>And the html code for the links:</p>\n\n<pre><code>&lt;a href=\"/users/sign_in\"&gt;Sign in&lt;/a&gt;\n&lt;a href=\"/users/password/new\"&gt;Forgot your password?&lt;/a&gt;\n&lt;a href=\"/users/auth/facebook\"&gt;Sign in with Facebook&lt;/a&gt;\n</code></pre>\n\n<p>This is what they look like in Chrome (13.0.782) - incorrect:</p>\n\n<p><img src=\"http://i.stack.imgur.com/qlHa0.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is what they look like in Firefox - correct:</p>\n\n<p><img src=\"http://i.stack.imgur.com/23yyC.jpg\" alt=\"enter image description here\"></p>\n\n<p>It looks like the user agent stylesheet is overwriting my style. Why?</p>\n"},{"tags":["ruby-on-rails","sqlite","postgresql","sqlite3","heroku"],"answer_count":2,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":1010,"score":9,"question_id":8795086,"title":"Rails 3.1. Heroku PGError: operator does not exist: character varying = integer","body":"<p>Having a little trouble fixing an error.</p>\n\n<p>All works great on local machine.\nOn PG, heroku is the error.</p>\n\n<p>Here are the logs :</p>\n\n<pre><code>  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m ActionView::Template::Error (PGEr\n  ror: ERROR:  operator does not exist: character varying = integer\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m LINE 1: ...T \"reviews\".* FROM \"re\n  views\"  WHERE \"reviews\".\"trip_id\" = 32\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m : SELECT \"reviews\".* FROM \"review\n  s\"  WHERE \"reviews\".\"trip_id\" = 32):\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m     31:   &lt;div style='display:non\n  e'&gt;\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m     33:      &lt;% for review in @tr\n  ip.reviews %&gt;\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m     34:\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m     32:    &lt;div id=\"inline\"&gt;\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m HINT:  No operator matches the gi\n  ven name and argument type(s). You might need to add explicit type casts.\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m   app/controllers/trips_controlle\n  r.rb:21:in `show'\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m cache: [GET /trips/32] miss\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m     36:     &lt;li&gt; &lt;%= review.conte\n  nt %&gt; &lt;/li&gt;\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m     35:     &lt;ul&gt;\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m   app/views/trips/show.html.erb:3\n  3:in `_app_views_trips_show_html_erb__3301405670044045300_69859019468960'\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m Completed 500 Internal Server Err\n  or in 86ms\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m   Parameters: {\"id\"=&gt;\"32\"}\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m   Processing by TripsController#s\n  how as HTML\n  ←[32m2012-01-09T19:52:24+00:00 app[web.1]:←[0m Rendered trips/show.html.erb with\n  in layouts/application (81.8ms)\n</code></pre>\n\n<p>Not really sure where exactly, the error occurs and how to fix it.</p>\n\n<p>reviews.rb</p>\n\n<pre><code> class Review &lt; ActiveRecord::Base\n  belongs_to :trip\n end\n\n class Trip &lt; ActiveRecord::Base\n  has_many :reviews, :dependent =&gt; :destroy\n  attr_accessible, :reviews_attributes\n\n  accepts_nested_attributes_for :reviews, :reject_if =&gt; lambda { |a| a[:name].blank? }, :allow_destroy =&gt; true\n end \n</code></pre>\n\n<p>show.html.rb</p>\n\n<pre><code> &lt;%= link_to \"Read Reviews\", '#inline',  :id =&gt; 'various1', :class =&gt; 'review' %&gt;  \n\n &lt;div style='display:none'&gt;  \n   &lt;div id=\"inline\"&gt;\n      &lt;% for review in @trip.reviews %&gt;  \n       &lt;ul&gt;\n         &lt;li&gt; &lt;%= review.content %&gt; &lt;/li&gt;\n         &lt;li&gt; &lt;i&gt; &lt;%= review.name %&gt; &lt;/i&gt; &lt;/li&gt;\n       &lt;/ul&gt;\n     &lt;% end %&gt;  \n  &lt;/div&gt; \n &lt;/div&gt;\n</code></pre>\n\n<p>The thing that confuses me is that I have two other practically the same models, but they work well.</p>\n\n<p>Thanks! </p>\n"},{"tags":["ruby-on-rails","activerecord","serialization","hash","foursquare"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13150004,"title":"Foursquare Location Hash Store as a Rails Model Attribute / Column","body":"<p>I'm calling the Foursquare API using the Foursquare2 Ruby wrapper <a href=\"https://github.com/mattmueller/foursquare2\" rel=\"nofollow\">https://github.com/mattmueller/foursquare2</a></p>\n\n<p>If I initialize the client in Rails Console with: </p>\n\n<pre><code>client = Foursquare2::Client.new(:client_id =&gt;'CLIENT_ID', :client_secret =&gt; 'CLIENT_SECRET')\n</code></pre>\n\n<p>then I make a call to the Foursquare API by the location_id (using 5104 for example).</p>\n\n<pre><code>restaurant = client.venue(5104)\n</code></pre>\n\n<p>this returns a giant Ruby Hashie::Mash. So if I only want the location Hash then I do</p>\n\n<pre><code>restaurant.location\n</code></pre>\n\n<p>which gives me this \"location hash\"</p>\n\n<pre><code>#&lt;Hashie::Mash address=\"4 Clinton St.\" cc=\"US\" city=\"New York\" country=\"United States\" crossStreet=\"at E Houston St.\" lat=40.721294 lng=-73.983994 postalCode=\"10002\" state=\"NY\"&gt; \n</code></pre>\n\n<p>now if I do <code>restaurant.location.address</code>\nthis returns <code>=&gt; \"4 Clinton St.\"</code></p>\n\n<p>So now, exiting Rails Console and entering a Rails App. My question - As an after_save method call in my Rails \"Restaurant\" Model, I am saving this \"location hash\" in my model in the \"foursquare_location\" column as a :text field.</p>\n\n<p>In my \"Restaurant\" view template to show the Restaurant address details, how can I write my template so that I can call @restaurant.foursquare_location.address so that it accesses the address key to return the address value? </p>\n\n<p>I'm not sure if I can just directly save the Foursquare API response directly to my SQLite3 Database in a :text column and have it maintain its hash structure.</p>\n\n<p>I really appreciate the help here.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13150432,"title":"Converting a variable with a UTC time to a Seconds integer (Ruby)","body":"<p>I have a variable that has a UTC time tied with it,  example:</p>\n\n<pre><code>   offer_ends_at =&gt; Sun, 25 Nov 2012 07:59:59 UTC +00:00,\n</code></pre>\n\n<p>My goal is to create a new variable, and convert the Time to a seconds integer.   I tried with some methods like  </p>\n\n<pre><code>   seconds = offer_ends_at.to_time.to_i \n</code></pre>\n\n<p>I end up getting a epoc time.  I'm after an actual integer that contains the amount of seconds left until the date happens. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","postgresql","datetime"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13150387,"title":"Why are the timestamps all delayed with Rails and Postgres?","body":"<p>I'm using the following to display the time at which a musing entry was created: </p>\n\n<pre><code>&lt;%= l musing.created_at, :format =&gt; \"%d/%m/%y at %I:%M %p\" %&gt;\n</code></pre>\n\n<p>And the time is delayed by 5 hours, for example if I generate a musing at \"2012-10-30 19:21:35 -0700\", this is the time displayed:</p>\n\n<pre><code>31/10/12 at 02:21 am  by me@benigeri.com\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","attributes","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13150272,"title":"Meaning for attributes_for in FactoryGirl and Rspec Testing","body":"<p>Looking through a tutorial on controller testing the author gives an example of an rspec test testing a controller action. My question is, why did they use the method <code>attributes_for</code> over <code>build</code>? There is no clear explanation why <code>attributes_for</code> is used besides that it returns a hash of values.</p>\n\n<pre><code>it \"redirects to the home page upon save\" do\n  post :create, contact: Factory.attributes_for(:contact)\n  response.should redirect_to root_url\nend\n</code></pre>\n\n<p>The tutorial link is found here: <a href=\"http://everydayrails.com/2012/04/07/testing-series-rspec-controllers.html\" rel=\"nofollow\">http://everydayrails.com/2012/04/07/testing-series-rspec-controllers.html</a> The example is found at the beginning topic section <code>Controller testing basics</code></p>\n"},{"tags":["ruby-on-rails","paperclip","cancan"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13004731,"title":"CanCan 2.0 + Paperclip expiring_url","body":"<p>I set some files using Paperclip <code>expiring_url</code>. Those are working fine. </p>\n\n<p>I try using CanCan 2.0 to allow <code>expiring_url</code> only to signed members using the following code</p>\n\n<pre><code># /app/models/ability.rb\nclass Ability\n  include CanCan::Ability\n\n  def initialize(user)\n    user ||= User.new  # guest user\n    can :read, :movies\n    cannot :read, :movies, :expiring_url\n\n    if user.persisted?\n      can :read, :movies, :expiring_url\n    end\n\n  end\nend\n</code></pre>\n\n<p>My <code>MoviesController.rb</code> has <code>load_and_authorize_resource</code> still all users are being able to download the movie. </p>\n\n<p><code>expiring_url</code> is not an attribute of <code>Movie</code> and I can see that is the reason why is not working. I'm not sure how can specify the paperclip expiring_url object associated to this in order to make it work. </p>\n\n<p>Any idea how to do this?</p>\n"},{"tags":["ruby-on-rails","json","foreign-keys","has-many","belongs-to"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13149536,"title":"How to get a single object with only the foreign keys using \"render json\"","body":"<p>I'm building a backend using Rails 3.2.8 and I have a huge object graph with lots of dependencies etc.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>A belongs_to B (and of course B has_many A)\nB belongs_to C\nC belongs_to D\netc...\n</code></pre>\n\n<p>If I now open the URL \"http://0.0.0.0:3000/ds.json\", I'll get the whole object graph.</p>\n\n<pre><code>[{\"id\":1,\"c\":{\n    \"id\":1,\"b\":{\n        \"id\":1,\"a\":{\n            \"id\":1\n        }\n    }\n}]\n</code></pre>\n\n<p>(I have a custom database where the foreign keys are with out the \"_id\" suffix).</p>\n\n<p>Instead I'd like to just get the id of \"C\" if I open \"ds.json\":</p>\n\n<pre><code>[{\"id\":1,\"c\":1}]\n</code></pre>\n\n<p>Is this possible?</p>\n\n<p><strong>EDIT:</strong>\nMy Models look like this (and I think that's the problem, but I can't change the database scheme):</p>\n\n<pre><code>class Location &lt; ActiveRecord::Base\n  self.table_name = 'location'\n  self.primary_key = 'id'\n\n  belongs_to :map, foreign_key: :map\nend\n\n\n\nclass Map &lt; ActiveRecord::Base\n  self.table_name = 'map'\n  self.primary_key = 'id'\n\n  has_many :locations, foreign_key: :map\nend\n</code></pre>\n\n<p>The problem seems to be that rails just sees \"map\" inside the \"location\" and just grabs the whole object, because \"map\" is the name of the object AND the id-column inside the location-table...</p>\n\n<p>How can I tell Rails the difference between object and id-column ?!</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":18,"score":2,"question_id":13137001,"title":"id_element not update on rails3-jquery-autocomplete","body":"<p>It's work fine if I not add option delimiter\" => ','</p>\n\n<p>but 'id_element' not update if I added delimiter\" => ',' option</p>\n\n<pre><code>&lt;%= hidden_field_tag \"to_provider_ids\" %&gt;\n&lt;%= autocomplete_field_tag 'to', '', autocomplete_provider_source_agency_name_users_path, \"data-delimiter\" =&gt; ',',, :id_element =&gt; '#to_provider_ids' %&gt;\n</code></pre>\n\n<p>please help me solved this problem. thanks</p>\n"},{"tags":["ruby-on-rails","methods","system","call"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13149640,"title":"System call from method (ruby on rails)","body":"<p>I need make system call from method of Ruby of Rails , but I want it to stay on the same page.\nRight now for some reason it does not execute , but shows :</p>\n\n<pre><code>Routing Error\n\nNo route matches [POST] \"/devices/22918\"\nTry running rake routes for more information on available routes.\n</code></pre>\n\n<p>This is the button:</p>\n\n<pre><code>&lt;%= link_to image_tag(\"/images/glossy_green_button.png\"), device , :method =&gt; :turnon, :confirm =&gt; \"Are you sure?\" %&gt;\n</code></pre>\n\n<p>This is method:</p>\n\n<pre><code>def turnon\n@device = Device.find(params[:id])\nresult = `/perl/toggle.pl @device.infodot on`\nend\n</code></pre>\n\n<p>please let me know what I am doing wrong, </p>\n\n<p>thank you</p>\n\n<p>D</p>\n"},{"tags":["javascript","ruby-on-rails","ajax","data-binding","ember.js"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13137722,"title":"Rails: Not ember, not JS responses, but something in-between","body":"<p>I am developing a standard rails application, and so far I haven't used any AJAX, just good ol' HTML. My plan is to iteratively add \"remote\" links and all that kind of stuff and support for JS responses, because I know that generating JS server side is very very evil, but I find it to be very handy as well, easy, fast and it makes the application snappy enough and i18n comes out-of-the-box.</p>\n\n<p>Using a pure JSON approach would be lighter, but needs lots of client-side coding.</p>\n\n<p>Now imagine that in this application users have a mailbox, and since the idea is that they will be able to do most or even all of the actions without reloading the page, the mailbox counter will never change unless they refresh the page manually.</p>\n\n<p>So, here comes the question: Which is the best way to handle this?</p>\n\n<ol>\n<li><p>I thought about using Ember (for data binding), and sharing views with rails, via some sort of handlebars implementation for ruby. That would be quite awesome, but not very transparent for the developer (me). Although I guess that I only need to write handlebars views that will be used by ember, the rest can still be written in their original format, no?</p></li>\n<li><p>Another option might be to use some sort of event system (EventSource maybe?), and just go with handy the JS views approach, and listen to those events. I guess those should be JSON objects, and the client must be coded to be able to handle them. This seems a bit cumbersome, and I need a solution for heroku (faye?), which is where my app is hosted. Any hints?</p></li>\n</ol>\n\n<p>I think that the ember approach is the more robust one, but seems to be quite complex as well, and I don't want to repeat myself server and client side.</p>\n\n<p>Any help will be appreciated.</p>\n\n<p>Cheers.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I have seen this: <a href=\"http://layervault.tumblr.com/post/30932219739/rails-in-realtime\" rel=\"nofollow\">http://layervault.tumblr.com/post/30932219739/rails-in-realtime</a>, which is more or less the option #2.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13149789,"title":"In Ruby On Rails, how can I remove views related to a specific controller","body":"<p>For example, I created this post_controller earlier in the project but I decide to destroy it later.</p>\n\n<p>Then I use </p>\n\n<pre><code>rails destroy controller post_controller\n</code></pre>\n\n<p>to remove the controller. But I also want to remove the views that attach to this controller.\nIn this case, they are the erb files in the app/views/post folder. How can I remove those erb files?</p>\n"},{"tags":["ruby-on-rails","ajax","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13149952,"title":"Omniauth authorization call with Ajax","body":"<p>I have omniauth working fine in my Rails 3 app when using it as a link:</p>\n\n<pre><code>link_to(\"Connect Twitter\", \"/auth/twitter\", :id =&gt; \"connect-to-twitter\")\n</code></pre>\n\n<p>Now I want to call '/auth/twitter' through ajax. However, nothing is returned after the request phase. Here is the last log entry:</p>\n\n<pre><code>Started GET \"/auth/twitter\" for 127.0.0.1 at 2012-10-30 17:53:02 -0700\n(twitter) Request phase initiated.\n</code></pre>\n\n<p>Here is my ajax code (in Coffeescript):</p>\n\n<pre><code>$(\"#connect-to-twitter\").live(\"click\", -&gt;\n  alert('get twitter')\n  $.get('/auth/twitter', (data) -&gt;\n    alert(data)\n  )\n  return false\n)\n</code></pre>\n\n<p>(I know this question has been asked before here, but I haven't seen any real answer to it.)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","checkout"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13143334,"title":"Basket IF arguments ROR","body":"<p>I am developing a rails app that includes a checkout basket and am in need of some basic help. </p>\n\n<p>I am struggling to integrate the logical arguments needed for some product pricing. What I would like to do is lower the price of the product if there are five or more products added to the cart. </p>\n\n<p>I currently have models and controllers for products, line_items, carts and orders with the typical associations.</p>\n\n<p>I am sure there is a simple <code>if and elseif</code> statement that I can define in a method but I would be interested to know how others else would go about implementing this as best practice? </p>\n\n<p>Thanks in advance for your help! Elle</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13147972,"title":"Pagination in Ruby when results fetched in a mySQL query","body":"<p>I fetch some rows in my Rails controller using the following query:</p>\n\n<pre><code>@main = connection.execute(\"SELECT code_ver, result FROM mastertest WHERE code_ver NOT LIKE '%DevBld%' AND date &gt;= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;\")\n</code></pre>\n\n<p>Now in my index.html.erb (View) I display these rows in form of a table.</p>\n\n<p>But I want to have next and previous buttons in my html page such that It should display only a few rows at a time. Lets assume a week's data at a time. </p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13149893,"title":"Typed $ rails server and output looks like it is stuck","body":"<p>I am doing Michael Hartl's Ruby and Rails Tutorial and am just getting started on my first app. I Typed <code>$ rails server</code> into the command line and got the following output:</p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 3.2.8 application starting in development on http://0.0.0.0:3000\n=&gt; Call with -d to detach\n=&gt; Ctrl-C to shutdown server\n[2012-10-30 20:56:51] INFO  WEBrick 1.3.1\n[2012-10-30 20:56:51] INFO  ruby 1.9.3 (2012-10-12) [x86_64-darwin12.2.0]\n[2012-10-30 20:56:51] INFO  WEBrick::HTTPServer#start: pid=2205 port=3000\n\n\nStarted GET \"/assets/rails.png\" for 127.0.0.1 at 2012-10-30 20:57:56 -0400\nConnecting to database specified by database.yml\nServed asset /rails.png - 200 OK (3ms)\n</code></pre>\n\n<p>It looks like this is still running and is stuck. The next step in the tutorial asks to add the new rails project to Git (after you've set up Git) via <code>$ git add</code>.  Should I do this in a new terminal window while the <code>$ rails server</code> still runs?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","css3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13149609,"title":"Rails bootstrap css not loading in correct order","body":"<p>I don't get this at all, and I am completely stumped.  I have bootstrap, a default css file, and then individual page css files.  My css file looks like this:</p>\n\n<pre><code>// Place all the styles related to the Hotel controller here.\n// They will automatically be included in application.css.\n// You can use Sass (SCSS) here: http://sass-lang.com/\n//*= require_self\n//*= require jquery.ui.all\n//*= require bootstrap_and_overrides.css.scss\n//*= require defaults.css.scss\n//*= require_tree ./hotels\n</code></pre>\n\n<p>This is how it is loading:</p>\n\n<pre><code>    &lt;link href=\"/assets/hotels.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n\n&lt;link href=\"/assets/jquery.ui.core.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.theme.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.accordion.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.autocomplete.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.button.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.datepicker.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.dialog.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.progressbar.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.resizable.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.selectable.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.slider.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.tabs.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.base.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jquery.ui.all.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/bootstrap_and_overrides.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/defaults.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/hotels/add_fonts.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n\n&lt;link href=\"/assets/hotels/carousel.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/hotels/carousel_side_text.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/hotels/directions.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/hotels/fileuploader.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/hotels/gmaps4rails.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/hotels/index.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/hotels/specials.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n</code></pre>\n\n<p>But when I inspect an element in firebug, it is:</p>\n\n<p>[A bunch of stuff from Bootstrap]</p>\n\n<p>[CSS from my default file ]  &lt;----  Being overwritten by bootstrap stuff</p>\n\n<p>[A bunch of stuff from Bootstrap]</p>\n\n<p>So I don't get it.  My defaults are being loaded after the bootstrap, but they are being overwritten by bootstrap.  I don't see how this is possible.  </p>\n\n<p>EDITED TO ADD:</p>\n\n<p>This is a span7 div that I am trying to get rid of the left margin on.  Unfortunately, as you can see my overwrite is in the middle of that block.  the margin-left: 0px; is being overwritten.</p>\n\n<pre><code>.row-fluid .span7 {\n    width: 57.265%;\n}\nbootst...?body=1 (line 6396)\n.row-fluid [class*=\"span\"] {\n    -moz-box-sizing: border-box;\n    display: block;\n    float: left;\n    margin-left: 2.5641%;\n    min-height: 30px;\n    width: 100%;\n}\nbootst...?body=1 (line 6290)\n.row-fluid .span7 {\n    width: 57.4468%;\n}\nbootst...?body=1 (line 469)\n.row-fluid [class*=\"span\"] {\n    -moz-box-sizing: border-box;\n    display: block;\n    float: left;\n    margin-left: 2.12766%;\n    min-height: 30px;\n    width: 100%;\n}\nbootst...?body=1 (line 363)\n.text-line-buttons {\n    float: left;\n    margin-left: 0;\n    text-align: left;\n}\n**defaul...?body=1 (line 224)\n.span7 {\n    width: 670px;\n}**\nbootst...?body=1 (line 6185)\n[class*=\"span\"] {\n    float: left;\n    margin-left: 30px;\n}\nbootst...?body=1 (line 6141)\n.span7 {\n    width: 540px;\n}\nbootst...?body=1 (line 258)\n[class*=\"span\"] {\n    float: left;\n    margin-left: 20px;\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13147430,"title":"Rails button_to not passing id in params hash","body":"<p>I'm trying to call a method when a button is clicked to go and fetch a tweet using the Twitter gem, and store that in my database.</p>\n\n<p>I have a model called Sponsor (which includes a column storing a twitter user name), and a model called Sponsortweet:</p>\n\n<p>models/sponsor.rb:</p>\n\n<pre><code>class Sponsor &lt; ActiveRecord::Base                                                      \n  attr_accessible :facebook, :name, :twitter                                         \n  has_many :sponsortweets, dependent: :destroy                                          \n                                                                                          validates :name, presence: true, uniqueness: { case_sensitive: false }                \n  VALID_TWITTER_REGEX = /\\A^([a-zA-Z](_?[a-zA-Z0-9]+)*_?|_([a-zA-Z0-9]+_?)*)$/          \n  validates :twitter, format: { with: VALID_TWITTER_REGEX },                            \n                      uniqueness: { case_sensitive: false }                             \n\n\n  def create_tweet                                                                      \n    tweet = Twitter.user_timeline(self.twitter).first                                   \n    self.sponsortweets.create!(content: tweet.text,                                     \n                               tweet_id: tweet.id,                                      \n                               tweet_created_at: tweet.created_at,                      \n                               profile_image_url: tweet.user.profile_image_url,         \n                               from_user: tweet.from_user,)                             \n  end                                                                                   \nend\n</code></pre>\n\n<p>models/sponsortweet.rb:</p>\n\n<pre><code>class Sponsortweet &lt; ActiveRecord::Base\n  attr_accessible :content, :from_user, :profile_image_url, :tweet_created_at, :tweet_id\n    belongs_to :sponsor\n    validates :content, presence: true\n    validates :sponsor_id, presence: true\n\n    default_scope order: 'sponsortweets.created_at DESC'\nend\n</code></pre>\n\n<p>In controllers/sponsors_controller.rb:</p>\n\n<pre><code>def tweet\n        @sponsor = Sponsor.find_by_id(params[:id])\n        @sponsor.create_tweet\n    end\n</code></pre>\n\n<p>Relevant line in my routes.rb:</p>\n\n<p><code>match 'tweet', to: 'sponsors#tweet', via: :post</code></p>\n\n<p>In my view (views/sponsors/show.html.haml):</p>\n\n<p><code>= button_to :tweet, tweet_path</code></p>\n\n<p>With this code, I get the following error when clicking on the button:\n<code>undefined method</code>create_tweet' for nil:NilClass`</p>\n\n<p>If I change to use find (instead of find_by_id), the error is:\n<code>Couldn't find Sponsor without an ID</code></p>\n\n<p>...which makes me think that an ID isn't being passed, since as far as I know, using find raises an error, whereas find_by_id returns nil.</p>\n\n<p>What should I change to cause an ID to be passed?</p>\n"},{"tags":["ruby-on-rails","heroku","cdn","precompile"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13149758,"title":"put /assets in .slugignore for Heroku deployments with asset_sync (S3/CDN)","body":"<p>I am not sure if there is an existing way to do this but with asset_sync the idea is that assets are served from S3 or some CDN(e.g. cloudfront) thus not needing to be part of the application slug. Is it possible to have /assets in .slugignore on Heroku and still get asset:precompile and asset_sync to work?\nIf I just put /assets in .slugignore, they are not compiled with the digest and references to assets are without the fingerprint and thus don't work.</p>\n"},{"tags":["ruby-on-rails","ruby","string","integer"],"answer_count":6,"favorite_count":0,"up_vote_count":11,"down_vote_count":0,"view_count":5530,"score":11,"question_id":5661466,"title":"Test if string is a number in Ruby on Rails","body":"<p>I have this in my application controller</p>\n\n<pre><code>def is_number?(object)\n  true if Float(object) rescue false\nend\n</code></pre>\n\n<p>and the following test in my controller</p>\n\n<pre><code>if mystring.is_number?\n\nend\n</code></pre>\n\n<p>It's throwing an undefined method error. I'm guessing I've defined is_number in the wrong place...?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems","gem"],"answer_count":5,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":11254,"score":10,"question_id":1954015,"title":"Installed Rails but the rails command says it's not installed","body":"<p>I'm using Ubuntu 9.10 Karmic Koala and Ruby 1.9.1.</p>\n\n<p>I installed Rails using <code>sudo gem install rails</code>, which installed all the libraries for me.</p>\n\n<p>When I type <code>rails</code> in the terminal it says.</p>\n\n<p>The program 'rails' is currently not installed.  You can install it by typing:\nsudo apt-get install rails\nrails: command not found</p>\n\n<p>I can find rake, which is under rake1.9.1, but Rails is nowhere to be found, can someone point me in the right direction?</p>\n\n<p>Edit: path to ruby isn't the problem, the problem is where is rails? how do I execute it? rails just doesn't work, where does the exectuable lives?</p>\n"},{"tags":["ruby-on-rails","ruby","rvm","zsh"],"answer_count":6,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":5275,"score":15,"question_id":7788946,"title":"Rails keeps telling me that it's not currently installed","body":"<p>I use <code>rvm</code> to manage different rubies and their gemsets. My shell is zsh with oh-my-zsh configured with basic settings. Enabled oh-my-zsh plugins are ruby, rails, osx, and git. Here's the command I used to install ruby-1.8.7 and rails-3.0.7.</p>\n\n<pre><code>rvm install 1.8.7\nrvm use 1.8.7\ngem install rails -v=3.0.7\n</code></pre>\n\n<p>and then I typed <code>rails</code> and got:</p>\n\n<pre><code>Rails is not currently installed on this system. To get the latest version, simply type:\n\n    $ sudo gem install rails\n\nYou can then rerun your \"rails\" command.\n</code></pre>\n\n<p>I've tried more thorough installs also, Like reinstall <code>rubygems</code> after switching to ruby-1.8.7, or create a completely new gemset, but with no luck.</p>\n\n<p>Here's the rvm info:</p>\n\n<pre><code>ruby-1.8.7-p352@rails:\n\n  system:\n    uname:       \"Darwin yicai.local 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:32:41 PDT 2011; root:xnu-1504.15.3~1/RELEASE_X86_64 x86_64\"\n    bash:        \"/bin/bash =&gt; GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin10.0)\"\n    zsh:         \"/bin/zsh =&gt; zsh 4.3.9 (i386-apple-darwin10.0)\"\n\n  rvm:\n    version:      \"rvm 1.8.6 by Wayne E. Seguin (wayneeseguin@gmail.com) [https://rvm.beginrescueend.com/]\"\n\n  ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.8.7\"\n    date:         \"2011-06-30\"\n    platform:     \"i686-darwin10.8.0\"\n    patchlevel:   \"2011-06-30 patchlevel 352\"\n    full_version: \"ruby 1.8.7 (2011-06-30 patchlevel 352) [i686-darwin10.8.0]\"\n\n  homes:\n    gem:          \"/Users/nil/.rvm/gems/ruby-1.8.7-p352@rails\"\n    ruby:         \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352\"\n\n  binaries:\n    ruby:         \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352/bin/ruby\"\n    irb:          \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352/bin/irb\"\n    gem:          \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352/bin/gem\"\n    rake:         \"/Users/nil/.rvm/bin/rake\"\n\n  environment:\n    PATH:         \"/Users/nil/.rvm/gems/ruby-1.8.7-p352@rails/bin:/Users/nil/.rvm/gems/ruby-1.8.7-p352@global/bin:/Users/nil/.rvm/rubies/ruby-1.8.7-p352/bin:/Users/nil/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/usr/local/sbin\"\n    GEM_HOME:     \"/Users/nil/.rvm/gems/ruby-1.8.7-p352@rails\"\n    GEM_PATH:     \"/Users/nil/.rvm/gems/ruby-1.8.7-p352@rails:/Users/nil/.rvm/gems/ruby-1.8.7-p352@global\"\n    MY_RUBY_HOME: \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352\"\n    IRBRC:        \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352/.irbrc\"\n    RUBYOPT:      \"\"\n    gemset:       \"rails\"\n</code></pre>\n\n<p>and the gem version is 1.8.10, the latest.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13149141,"title":"Ruby on rails tests keep giving me errors","body":"<p>I am making a simple social network with Ruby on Rails. I wanted to add a restriction of certain characters for the profile name when signing up. So, in my User.rb file, I have the following:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me,\n                  :first_name, :last_name, :profile_name\n  # attr_accessible :title, :body\n\n  validates :first_name, presence: true\n  validates :last_name, presence: true\n\n  validates :profile_name, presence: true,\n                           uniqueness: true,\n                           format: {\n                             with: /^[a-zA-Z0-9_-]+$/,\n                             message: \"must be formatted correctly.\"\n                           }\n  has_many :statuses\n\n  def full_name\n    first_name + \" \" + last_name\n  end\nend\n</code></pre>\n\n<p>I set up a test to validate that it works, and this is what the test is:</p>\n\n<pre><code>test \"user can have a correctly formatted profile name\" do\nuser = User.new(first_name: '******', last_name: '****', email: '********@gmail.com')\nuser.password = user.password_confirmation = '**********'\nuser.profile_name = '******'\nassert user.valid?\n</code></pre>\n\n<p>end</p>\n\n<p>When I run the test, I keep getting the error saying that something is wrong with my <code>assert user.valid?</code> line. So I am thinking I messed up some syntax in my <code>with: /^[a-zA-Z0-9_-]+$/</code>.</p>\n\n<p>The error I am getting is <code>1) Failure:\ntest_user_can_have_a_correctly_formatted_profile_name(UserTest) [test/unit/user_test.rb:40]:</code></p>\n\n<p>But on line 40, it has this piece of code <code>assert user.valid?</code></p>\n\n<p>Any help is appreciated :)</p>\n"},{"tags":["ruby-on-rails","cucumber","capybara","selenium-webdriver"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13057324,"title":"How can I skip the login in cucumber scenarios to make test fasters?","body":"<p>I have a rails-app and I'm trying making my cucumber/capybara/selenium-webdriver tests faster. Most of my scenarios look like:</p>\n\n<pre><code>@javascript\nFeature: Writing reports\n  In order .....\n\n  Background:\n  Given I am logged in\n\n  Scenario: Scenario 1\n    ...........\n  Scenario: Scenario 2\n    ...........\n</code></pre>\n\n<p>Most of the time is spent in \"Given I am logged in\" where I go to the sign-up-page to create an user and log in. The authentication is implemented using Devise.</p>\n\n<p><strong>How can I make that I don't have to do the log-in in the test environment at all?</strong></p>\n\n<p><strong>Are there other best practises to get around the tedious log-in-step?</strong> (And only keep the log-in for those scenarios that test the log-in/sign-up specifically)</p>\n"},{"tags":["ruby-on-rails","redis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13149202,"title":"how to set a dynamic hash key (hash data type) in Redis & Rails?","body":"<p>Trying to set a hash data type, that contains a dynamic key name.   I have a attribute for example called \"event_id\" which contains an integer.   I'd like that to be apart of the hash key name.  </p>\n\n<pre><code>         self.attributes.each do |field, value|\n          $redis.hset(event_id, field, value)\n          end\n         end\n</code></pre>\n\n<p>With the current code above,  the key in redis is looking like </p>\n\n<pre><code>        32434\n</code></pre>\n\n<p>The goal is that I can add some text in front of that key,  so that ideally the key would look like </p>\n\n<pre><code>        this:is:the:event_id:32434\n</code></pre>\n\n<p>I can't fiqure out the syntax in the key args without breaking the syntax.  Thanks</p>\n"},{"tags":["ruby-on-rails","rspec","ruby-on-rails-3.2","capybara"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":13116947,"title":"Rails 3.2.8 and rspec, link_to current path, params hash not properly converted","body":"<p>I recently upgraded by current app to Rails 3.2.8 and can't get a few tests to pass.  I made a helper method that merges certain hashes with the params hash and creates a link to the current page.  I used technique I saw on: <a href=\"http://stackoverflow.com/questions/5535908/link-to-the-current-page-plus-merged-with-a-param\">link_to the current page plus/merged with a param</a>.</p>\n\n<p>Here is a stripped down version:</p>\n\n<pre><code>def simple_link\n  link_to \"Page\", params.merge(:c =&gt; nil)\nend\n</code></pre>\n\n<p>Then I would test it with something like: </p>\n\n<pre><code>describe \"simple_link\" do\n  it { simple_link.should == \"&lt;a href=\\\"/assets\\\"&gt;Page&lt;/a&gt;\" }\nend\n</code></pre>\n\n<p>Which was passing in 3.2.6.</p>\n\n<p>However, now I receive the rspec error <code>No route matches {:c=&gt;nil}</code>.  Either Rails, rspec, or capybara is thinking the hash is the route.  If I add a proper route like: <code>users_path</code>, then url_for seems to pick up the hash.  Testing on a browser, everything works fine, no errors.  Am I doing something wrong, was something changed in 3.2.8 or is this a bug?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13149257,"title":"Ruby on Rails: polymorphic association with has_one/belongs_to","body":"<p>In my app I setup the M-N relation between the Item and Property models by using a join model PropertyValuations. Now, in the relation between an item and a property there will exist a value. However, I want that value to be stored a different table (NumericValue, TextualValue, etc).\nIs a polymorphic association a good approach for this?</p>\n\n<p>The idea would be to have something like this:</p>\n\n<pre><code>class PropertyValuation &lt; ActiveRecord::Base\n  attr_accessible :valuable\n  attr_accessor :valuable\n\n  belongs_to :property\n  belongs_to :item\n  belongs_to :valuable, :polymorphic =&gt; true  \nend\n\nclass NumericValue &lt; ActiveRecord::Base\n  attr_accessible :value # plus several other fields\n  has_one :property_valuation, :as =&gt; :valuable  \nend\n\nclass TextualValue &lt; ActiveRecord::Base\n  attr_accessible :value  \n  has_one :property_valuation, :as =&gt; :valuable\nend\n</code></pre>\n\n<p>However, this way I can only associate a value to a property_valuation record if I create the value first (where I was expecting to do something like <code>property_valuation.valuable = NumericValue.new(:value =&gt; 12345)</code>), and to obtain the value I can't use <code>property_valuation.valuable</code>, as it will return nil (even if valuable_id and valuable_type on property_valuation table are filled).\nWhat can I improve in my code to make everything work as expected? My migrations look like this:</p>\n\n<pre><code>class CreatePropertyValuations &lt; ActiveRecord::Migration\n  def change\n    create_table :property_valuations do |t|\n      t.references :item\n      t.references :property\n      t.references :valuable, :polymorphic =&gt; true\n\n      t.timestamps\n    end\n    add_index :property_valuations, :item_id\n    add_index :property_valuations, :property_id\n    add_index :property_valuations, :valuable_id\n  end\nend\n\nclass CreateNumericValues &lt; ActiveRecord::Migration\n  def change\n    create_table :numeric_values do |t|\n      t.decimal :value\n      t.references :property_valuation\n\n      t.timestamps\n    end\n  end\nend\n\n\nclass CreateTextualValues &lt; ActiveRecord::Migration\n  def change\n    create_table :textual_values do |t|\n      t.text :value\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["javascript","ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13148888,"title":"How to get the current time as 13-digit integer in Ruby?","body":"<p>I have this jQuery function that returns the current time as a <strong>13-digit</strong> integer:</p>\n\n<pre><code>time = new Date().getTime();\n</code></pre>\n\n<p>Is there a way to do the same in Ruby?</p>\n\n<p>Right now, I am using Ruby's <code>Time.now.to_i</code> which works great but returns a <strong>10-digit</strong> integer.</p>\n\n<p>How can I get it to display <strong>13</strong> integers as in jQuery?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1722,"score":2,"question_id":1519413,"title":"Extend model in plugin with \"has_many\" using a module","body":"<p>I have a some code in an engine style plugin which includes some models. In my app I want to extend one of these models. I have managed to add both instance and class methods to the model in question by including a module from within an initializer. </p>\n\n<p>However I cannot seem to add associations, callbacks etc. I get a 'method not found' error.</p>\n\n<p>/libs/qwerty/core.rb</p>\n\n<pre><code>module Qwerty\n  module Core\n    module Extensions\n\n      module User\n        # Instance Methods Go Here \n\n        # Class Methods\n        module ClassMethods\n          has_many  :hits, :uniq =&gt; true # no method found\n\n          before_validation_on_create :generate_code # no method found\n\n          def something # works!\n            \"something\"\n          end\n        end\n\n        def self.included(base)\n          base.extend(ClassMethods)\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>/initializers/qwerty.rb</p>\n\n<pre><code>require 'qwerty/core/user'\n\nUser.send :include, Qwerty::Core::Extensions::User\n</code></pre>\n"},{"tags":["ruby-on-rails","jquery-selectors","jquery-ui-autocomplete","nested-forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13133275,"title":"jQuery selecting multiple form fields in a Rails one to many nested model form","body":"<p>I'm sorry that this question is somewhat complicated. Hopefully someone has the patience to read this.</p>\n\n<p>I have a nested model form much like the one from this Railscast:\n<a href=\"http://railscasts.com/episodes/196-nested-model-form-revised\" rel=\"nofollow\">http://railscasts.com/episodes/196-nested-model-form-revised</a></p>\n\n<p>My model is very similar to the nested form field in the Railscast.\nThere is a survey with many questions which has many answers.</p>\n\n<p>I am applying a jQuery-UI \"Autocomplete\" element to make all of the answer form fields an autocomplete element.  However, because it is a nested form field, there are many answer fields in my document.  This wouldn't be a problem typically but I need to apply this solution in displaying the label but submitting the ID of the autocomplete selection.\n<a href=\"http://stackoverflow.com/questions/7642855/autocomplete-applying-value-not-label-to-textbox\">Autocomplete applying value not label to textbox</a></p>\n\n<p>What happens when I employ the solution in the link above, is that the label gets applied to every single \"Answer Form Field\" in my document rather than just the one that I want. Because I'm using nested forms and I have to apply autocomplete logic to every single \"Answer Form Fields,\" I have to select them by this selector '[type=\"text\"][name*=\"[answer]\"]' which isn't very specific but its as specific as I can be.</p>\n\n<p>I'm racking my brain to figure out how I can use a jQuery selector to select a specific answer field rather than all of the answer fields.  </p>\n\n<p>Thank you in advanced for any help at all.</p>\n"},{"tags":["ruby-on-rails","ruby","controller","models"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13148793,"title":"Use models for specific actions on Rails?","body":"<p>I'm pretty new on RoR, and I having a hard time to figure out when to use a controller or something else, like a model for specific situations that implies business logic.</p>\n\n<p>Figure that I have a Post model that have a method to share it on Twitter, like this one:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  def send_to_twitter!\n    Twitter.update(\"#{self.title} #{self.url}\")\n  end\nend\n</code></pre>\n\n<p>And then, somewhere I have this:</p>\n\n<pre><code>Post.find(9).send_to_twitter!\n</code></pre>\n\n<p>I'm not supposed to do this, since I have business logic on a model and theoretically it's not allowed (from what I know). But it's the simplest way to do this kind of tasks.</p>\n\n<p>My question is, is this the right way to do it? <strong>Is there any better way?</strong>\nThanks!</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13129194,"title":"Ruby include check and iteration","body":"<p>I have an array:</p>\n\n<pre><code>art_groups_arr = []\n</code></pre>\n\n<p>I'm getting it from:</p>\n\n<pre><code>art_groups_arr &lt;&lt; a.art_name (in loop)\n</code></pre>\n\n<p>When I try to check for inclusion, I get <code>can't convert Array into String</code></p>\n\n<p>I tried:</p>\n\n<pre><code>n2.art_group.include?(art_groups_arr.map { |e| e})\n</code></pre>\n\n<p>In my view my array looks like:</p>\n\n<pre><code>[\"Амортизатор\", \"Защитный колпак / пыльник, амортизатор\"]\n</code></pre>\n\n<p>How can I correctly loop and check <code>include?</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","class","variables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":13148587,"title":"How to create variables in class methods in ruby?","body":"<p>I'm working on a project and I came up with a problem. I have the following code:</p>\n\n<pre><code>text.lines.map(&amp;:chomp) do |line|\n  @@movies ||= []\n  @@movies &lt;&lt; Movie.new(line)\nend\nCollection.new(@@songs)\n</code></pre>\n\n<p>I was wondering if there is a way to make this code more Ruby-like? I want to pass a list to the new method of the collection class. The implementation details (I'm parsing a text in a specific format from a file) are irrelevant. My question is regarding the class variable and whether or not should I use it (I'll have more than one collection with different texts to parse).\nThank you.</p>\n"},{"tags":["ruby-on-rails","nginx","mongrel","x-sendfile"],"answer_count":1,"favorite_count":8,"up_vote_count":10,"down_vote_count":0,"view_count":4626,"score":10,"question_id":954470,"title":"Serving Large Files Through Nginx via Rails 2.3 Using x-sendfile","body":"<p>Let's say I have a Rails 2.3.2 application fronted by nginx and served by mongrel in which I need to serve a large static file through Rails (to control access to it). I want the Rails app to delegate the transfer of the file to nginx, to avoid blocking the mongrel instance.</p>\n\n<p>The available information seems contradictory and incomplete. <a href=\"http://www.therailsway.com/2009/2/22/file-downloads-done-right\" rel=\"nofollow\">This post</a> shows how to do it with Apache, and hints that it can also be done with ngninx - but no examples. <a href=\"http://john.guen.in/past/2007/4/17/send%5Ffiles%5Ffaster%5Fwith%5Fxsendfile/\" rel=\"nofollow\">This post</a> and <a href=\"http://spongetech.wordpress.com/2007/11/13/the-complete-nginx-solution-to-sending-flowers-and-files-with-rails/\" rel=\"nofollow\">this post</a> show how to do it using the a plugin that apparently Rails 2.3 makes uncessary. <a href=\"https://rails.lighthouseapp.com/projects/8994/tickets/2718-add-nginx-support-for-x%5Fsendfile-option-in-file-streaming\" rel=\"nofollow\">This post</a> suggests that maybe there isn't support for x-sendfile with nginx after all.</p>\n\n<p>I'd rather not muck around with plugins for things Rails can now do by itself.</p>\n\n<p>Has anybody gotten x-sendfile-like behavior to work using no plugins and Rails 2.3/nginx/mongrel? If not, what's the best documentation for getting it to work with a plugin (and/or monkeypatch) and Rails 2.3/nginx/mongrel?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":449,"score":2,"question_id":10970973,"title":"mongoid, how to merge result with map/reduce","body":"<p>I try to use out reduce but I do not know how to call output .\nExample: </p>\n\n<pre><code>@results = Article.collection.map_reduce(map, reduce, :out =&gt; 'test')\n\n@results.find()\n =&gt; &lt;Mongo::Cursor:0x2c276c4 namespace='myapp_development.test' @selector={} @cursor_id=&gt; \n</code></pre>\n\n<p>When I try : </p>\n\n<pre><code>@results1 = Article.collection.map_reduce(map, reduce, :out =&gt;{reduce: 'test'}\n</code></pre>\n\n<p>Expected result is duplicate @results. But I run @results1.find().to_a I see it equal with @results</p>\n\n<p>And how can I call result by namespace in rubyrails using mongoid ??</p>\n"},{"tags":["ruby-on-rails","solr","sunspot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13148407,"title":"Solr cannot reindex due to strange query being produced","body":"<p>I am writing a rails applications that utilize solr for full text search</p>\n\n<p>In development mode, I used the sunpost solr gem which is really handy. I used the sqlite3 database in development and everything went smooth.</p>\n\n<p>Now is the time to move to production server and I installed the solr-tomcat package and moved to my production database which is Mysql. I moved the conf files of solr from my application folder to /usr/share/solr/conf</p>\n\n<p>Suddenly, I cannot reindex, and solr returned this  </p>\n\n<pre><code>rake RAILS_ENV=production sunspot:solr:reindex\n[#                                 ] [  50/7312] [  0.68%] [00:00] [00:41] [ 175.82/s]rake aborted!\nMysql::Error: Unknown column 'barangs.' in 'where clause': SELECT  `barangs`.* FROM `barangs`  WHERE (`barangs`.`` &gt;= 0) ORDER BY `barangs`.`` ASC LIMIT 50\n</code></pre>\n\n<p>Intrigued, I tried to reindex with the development database, all is well and can be reindexed. This behavior left me baffled </p>\n\n<p>Any help will be appreciated</p>\n"},{"tags":["ruby-on-rails","mongodb","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13147947,"title":"Rails server traffic blocked by heavy writing to MongoDB","body":"<p>I'm executing a script from the rails console; the script crawls a MySQL database, creating ~.5 million MongoDB documents.</p>\n\n<p>I've noticed that when running <code>rails server</code> while the script is running, any request's response must wait on thousands of lines of output from MOPED, e.g.:</p>\n\n<pre><code>MOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={\"_id\"=&gt;\"509043ec2c5f64685b62c5b3\", \"questions._id\"=&gt;\"509043ec2c5f64685b62c5b5\"} update={\"$set\"=&gt;{\"questions.1.response\"=&gt;{\"_id\"=&gt;\"509043ec2c5f64685b62c5bd\", \"data\"=&gt;{\"datepicker\"=&gt;\"10/21/2011\", \"response\"=&gt;1319216400}, \"comment\"=&gt;nil}}} flags=[] (0.0000ms)\nMOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={\"_id\"=&gt;\"509043ec2c5f64685b62c5b3\", \"questions._id\"=&gt;\"509043ec2c5f64685b62c5b6\"} update={\"$set\"=&gt;{\"questions.2.response\"=&gt;{\"_id\"=&gt;\"509043ec2c5f64685b62c5be\", \"data\"=&gt;{\"response\"=&gt;\"Morning\"}, \"comment\"=&gt;nil}}} flags=[] (0.0000ms)\nMOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={\"_id\"=&gt;\"509043ec2c5f64685b62c5b3\", \"questions._id\"=&gt;\"509043ec2c5f64685b62c5b7\"} update={\"$set\"=&gt;{\"questions.3.response\"=&gt;{\"_id\"=&gt;\"509043ec2c5f64685b62c5bf\", \"data\"=&gt;{\"0\"=&gt;\"yes\", \"1\"=&gt;\"no\", \"2\"=&gt;\"no\", \"3\"=&gt;\"no\"}, \"comment\"=&gt;\"\"}}} flags=[] (0.0000ms)\nMOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={\"_id\"=&gt;\"509043ec2c5f64685b62c5b3\", \"questions._id\"=&gt;\"509043ec2c5f64685b62c5b8\"} update={\"$set\"=&gt;{\"questions.4.response\"=&gt;{\"_id\"=&gt;\"509043ec2c5f64685b62c5c0\", \"data\"=&gt;{\"response\"=&gt;\"outdoor\"}, \"comment\"=&gt;\"\"}}} flags=[] (0.0000ms)\nMOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={\"_id\"=&gt;\"509043ec2c5f64685b62c5b3\", \"questions._id\"=&gt;\"509043ec2c5f64685b62c5b9\"} update={\"$set\"=&gt;{\"questions.5.response\"=&gt;{\"_id\"=&gt;\"509043ec2c5f64685b62c5c1\", \"data\"=&gt;{\"response\"=&gt;\"5\"}, \"comment\"=&gt;nil}}} flags=[] (0.0000ms)\nMOPED: 127.0.0.1:27017 UPDATE       database=survey_app_development collection=mongo_surveys selector={\"_id\"=&gt;\"509043ec2c5f64685b62c5b3\", \"questions._id\"=&gt;\"509043ec2c5f64685b62c5ba\"} update={\"$set\"=&gt;{\"questions.6.response\"=&gt;{\"_id\"=&gt;\"509043ec2c5f64685b62c5c2\", \"data\"=&gt;{\"response\"=&gt;\"attest\"}, \"comment\"=&gt;nil}}} flags=[] (1.0002ms)\n</code></pre>\n\n<p>If I let the script execute long enough (with rails server running), any http request results in:</p>\n\n<pre><code>[2012-10-30 16:24:44] ERROR Java heap space\n[2012-10-30 16:25:12] ERROR Java heap space\n[2012-10-30 16:26:11] ERROR Java heap space\n</code></pre>\n\n<p>So, my question is: Is there a setting to prevent this behavior?  Also, should I expect the server traffic to be impeded when writing to MongoDB?</p>\n\n<p>I am using <em>Mongoid</em>, <em>Rails 3.2</em>, and <em>JRuby 1.7.0</em>, <em>MongoDB 2.2.0</em></p>\n"},{"tags":["ruby-on-rails","capistrano","unicorn","octopus"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13148456,"title":"Unicorn does not sever database connections properly after new deploy","body":"<p>I am currently having a problem with database connections after a Capistrano deploy. On the database server it seems like unicorn does not sever the previous connections and it just keeps adding on top of the old ones. I am doing a preload true, and I also have octopus gem installed as well if that matters. I am not too sure who is to blame for this. I have pasted my unicorn config for the part that matters. Any help is appreciated! </p>\n\n<pre><code>before_fork do |server, worker|\n  if defined?(ActiveRecord::Base)\n    ActiveRecord::Base.connection.disconnect!\n  end\n  old_pid = \"/tmp/unicorn.my_app_name.pid.oldbin\"\n  if File.exists?(old_pid) &amp;&amp; server.pid != old_pid\n    begin\n      Process.kill(\"QUIT\", File.read(old_pid).to_i)\n    rescue Errno::ENOENT, Errno::ESRCH\n    end\n  end\nend\n\nafter_fork do |server, worker|\n\n  ActiveRecord::Base.connection_proxy.instance_variable_get(:@shards).each {|k,v| v.clear_reloadable_connections! }\n  if defined?(ActiveRecord::Base)\n    ActiveRecord::Base.establish_connection\n  end\n\n  if Process.ppid &gt; 1 # Not the daemon\n  child_pid = server.config[:pid].sub(\".pid\", \".#{worker.nr}.pid\")\n  File.open(child_pid, \"wb\") {|f| f &lt;&lt; Process.pid }\n  end\nend\n</code></pre>\n\n<p><img src=\"http://i.imgur.com/HVkkM.png\" alt=\"1\"> \"ps aux\"</p>\n"},{"tags":["ruby-on-rails","gmaps4rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13142085,"title":"gmaps4Rails - json is being returned empty","body":"<p>I installed gmaps4rails in my application.</p>\n\n<p>The view related stuff seems to be working, since the an empty google maps shows up. So I am thinking that I installed it correctly.</p>\n\n<p>I followed the quick start on the github page:</p>\n\n<p>My controller:</p>\n\n<pre><code>def map\n    @businesses = Business.all\n    @json = @businesses.to_gmaps4rails\n\n    respond_to do |format|\n      format.html\n      format.json {render json:@businesses}\n    end\n  end\n</code></pre>\n\n<p>My view:</p>\n\n<pre><code>=gmaps4rails(@json)\n=@json\n</code></pre>\n\n<p>I print <code>@json</code> and realized that the value is empty i.e. <code>[]</code></p>\n\n<p>My business.rb model:</p>\n\n<pre><code>class Business &lt; ActiveRecord::Base\n  belongs_to :city\n  belongs_to :category\n  has_many :reviews\n\n  attr_accessible :address, :description, :name, :phone, :urbanization, :url, :city_id\n\n  include FriendlyId\n  friendly_id :name, :use =&gt; :slugged\n\n  acts_as_gmappable\n\n  def gmaps4rails_address\n    # \"#{self.address}, #{self.urbanization}, #{self.city.name}\"\n    \"619 Johnson Street, Kingston, ON\"\n  end\nend\n</code></pre>\n\n<p>I hard coded the address for testing...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3006,"score":0,"question_id":7340448,"title":"Devise & omniauth Facebook authentication in Rails 3.1","body":"<p>I've followed <a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">this guide</a> for getting Devise Facebook authentication to work and I've now come to a point where I can't understand and I would like some help.</p>\n\n<p>I get the Sign in with Facebook link but clicking on it I get the following error, telling me there's something wrong with the routes</p>\n\n<blockquote>\n  <p>Unknown action</p>\n  \n  <p>Could not find devise mapping for path \"/users/auth/facebook\". Maybe you forgot to wrap your route inside the scope block? For example: devise_scope :user do match \"/some/route\" => \"some_devise_controller\" end</p>\n</blockquote>\n\n<p>Here is my routes file</p>\n\n<pre><code>  devise_for :users, :controllers =&gt; { :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" }\n  get '/users/auth/:provider' =&gt; 'users/omniauth_callbacks#passthru'\n  root :to =&gt; 'home#index'\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Solved that issue by changing the routes to</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" } do\n  get '/users/auth/:provider' =&gt; 'users/omniauth_callbacks#passthru'\nend\nroot :to =&gt; 'home#index'\n</code></pre>\n\n<p>Now I got the next error getting the Facebook auth to work but when coming back from the \"Allow app screen\" ruby throws...</p>\n\n<blockquote>\n  <p>undefined method `closed?' for nil:NilClass</p>\n  \n  <p>activesupport (3.1.0.rc8) lib/active_support/whiny_nil.rb:48:in <code>method_missing'\n  /opt/local/lib/ruby/1.8/net/http.rb:1060:in</code>request'\n  faraday (0.6.1) lib/faraday/adapter/net_http.rb:51:in <code>call'\n  faraday (0.6.1) lib/faraday/request/url_encoded.rb:14:in</code>call'\n  faraday (0.6.1) lib/faraday/request.rb:88:in <code>run'\n  faraday (0.6.1) lib/faraday/request.rb:28:in</code>run'\n  faraday (0.6.1) lib/faraday/connection.rb:170:in <code>run_request'\n  oauth2 (0.4.1) lib/oauth2/client.rb:63:in</code>request'</p>\n  \n  <p>...</p>\n</blockquote>\n\n<p>This is using Rails 3.1.0rc8 and ruby 1.9.2</p>\n"},{"tags":["ruby-on-rails","rspec","rake"],"answer_count":5,"favorite_count":5,"up_vote_count":8,"down_vote_count":0,"view_count":1985,"score":8,"question_id":9523931,"title":"Rake db:test:prepare in Rails 3 app fails with file not found","body":"<p>I'm not sure why this is happening all of a sudden. I'd like to know how to resolve, please, if anyone else has run into this before or has ideas on where to look. Using bundle exec does not fix, has the same behavior.</p>\n\n<p>rake version 0.9.2.2\nrails version 3.2.1\nrspec version 2.8.0</p>\n\n<pre><code>rake db:test:prepare --trace\n** Invoke db:test:prepare (first_time)\n** Invoke db:abort_if_pending_migrations (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Execute db:abort_if_pending_migrations\n** Execute db:test:prepare\n** Invoke db:test:load (first_time)\n** Invoke db:test:purge (first_time)\n** Invoke environment \n** Execute db:test:purge\n** Execute db:test:load\n** Invoke db:test:load_schema (first_time)\n** Invoke db:test:purge \n** Execute db:test:load_schema\n** Invoke db:schema:load (first_time)\n** Invoke environment \n** Execute db:schema:load\n/Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:167:in `block in     non_options': file not found: db:test:prepare (ArgumentError)\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:146:in `map!'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:146:in `non_options'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:207:in `non_options'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:52:in `process_args'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/minitest/unit.rb:891:in `_run'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/minitest/unit.rb:884:in `run'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:21:in `run'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:326:in `block (2 levels) in autorun'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:27:in `run_once'\nfrom /Users/ivan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/test/unit.rb:325:in `block in autorun'\n</code></pre>\n\n<p>and here's my rake -T</p>\n\n<pre><code>     → rake -T\n     rake about                             # List versions of all Rails frameworks and          the environment\n     rake assets:clean                      # Remove compiled assets\n     rake assets:precompile                 # Compile all the assets named in          config.assets.precompile\n     rake bourbon:install[sass_path]        # Move files to the Rails assets directory.\n     rake clean                             # Remove any temporary products.\n     rake clobber                           # Remove any generated file.\n     rake cucumber                          # Alias for cucumber:ok\n     rake cucumber:all                      # Run all features\n     rake cucumber:ok                       # Run features that should pass\n     rake cucumber:rerun                    # Record failing features and run only them if any exist\n     rake cucumber:wip                      # Run features that are being worked on\n     rake db:create                         # Create the database from config/database.yml for the current Rails.env (use db:crea...\n     rake db:database_dump                  # Dump the current database to a MySQL file\n     rake db:drop                           # Drops the database for the current Rails.env (use db:drop:all to drop all databases)\n     rake db:fixtures:load                  # Load fixtures into the current environment's database.\n     rake db:migrate                        # Migrate the database (options: VERSION=x, VERBOSE=false).\n     rake db:migrate:projects               # Migrates Projects\n     rake db:migrate:status                 # Display status of migrations\n     rake db:rollback                       # Rolls the schema back to the previous version (specify steps w/ STEP=n).\n     rake db:schema:dump                    # Create a db/schema.rb file that can be portably used against any DB supported by AR\n     rake db:schema:load                    # Load a schema.rb file into the database\n     rake db:seed                           # Load the seed data from db/seeds.rb\n     rake db:setup                          # Create the database, load the schema, and initialize with the seed data (use db:res...\n     rake db:structure:dump                 # Dump the database structure to db/structure.sql. Specify another file with DB_STRUC...\n     rake db:version                        # Retrieves the current schema version number\n     rake doc:app                           # Generate docs for the app -- also available doc:rails, doc:guides, doc:plugins (opt...\n     rake log:clear                         # Truncates all *.log files in log/ to zero bytes\n     rake middleware                        # Prints out your Rack middleware stack\n     rake notes                             # Enumerate all annotations (use notes:optimize, :fixme, :todo for focus)\n     rake notes:custom                      # Enumerate a custom annotation, specify with ANNOTATION=CUSTOM\n     rake paperclip:clean                   # Cleans out invalid attachments.\n     rake paperclip:refresh                 # Refreshes both metadata and thumbnails.\n     rake paperclip:refresh:metadata        # Regenerates content_type/size metadata for a given CLASS (and optional ATTACHMENT).\n     rake paperclip:refresh:missing_styles  # Regenerates missing thumbnail styles for all classes using Paperclip.\n     rake paperclip:refresh:thumbnails      # Regenerates thumbnails for a given CLASS (and optional ATTACHMENT and STYLES splitt...\n     rake rails:template                    # Applies the template supplied by LOCATION=(/path/to/template) or URL\n     rake rails:update                      # Update configs and some other initially generated files (or use just update:configs...\n     rake routes                            # Print out all defined routes in match order, with names.\n     rake secret                            # Generate a cryptographically secure secret key (this is typically used to generate ...\n     rake simplecov                         # Run tests for simplecov\n     rake spec                              # Run all specs in spec directory (excluding plugin specs)\n     rake spec:controllers                  # Run the code examples in spec/controllers\n     rake spec:helpers                      # Run the code examples in spec/helpers\n     rake spec:lib                          # Run the code examples in spec/lib\n     rake spec:mailers                      # Run the code examples in spec/mailers\n     rake spec:models                       # Run the code examples in spec/models\n     rake spec:rcov                         # Run all specs with rcov\n     rake spec:requests                     # Run the code examples in spec/requests\n     rake spec:routing                      # Run the code examples in spec/routing\n     rake spec:views                        # Run the code examples in spec/views\n     rake stats                             # Report code statistics (KLOCs, etc) from the application\n     rake test                              # Runs test:units, test:functionals, test:integration together (also available: test:...\n     rake test:recent                       # Run tests for {:recent=&gt;\"test:prepare\"} / Test recent changes\n     rake test:single                       # Run tests for {:single=&gt;\"test:prepare\"}\n     rake test:uncommitted                  # Run tests for {:uncommitted=&gt;\"test:prepare\"} / Test changes since last checkin (onl...\n     rake time:zones:all                    # Displays all time zones, also available: time:zones:us, time:zones:local -- filter ...\n     rake tmp:clear                         # Clear session, cache, and socket files from tmp/ (narrow w/ tmp:sessions:clear, tmp...\n     rake tmp:create                        # Creates tmp directories for sessions, cache, sockets, and pids\n     Run options: \n\n     # Running tests:\n</code></pre>\n\n<p>Finished tests in 0.000395s, 0.0000 tests/s, 0.0000 assertions/s.</p>\n\n<p>0 tests, 0 assertions, 0 failures, 0 errors, 0 skips</p>\n"},{"tags":["ruby-on-rails","select-tag"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13147720,"title":"How to preselect dropdown given info from database to select_tag?","body":"<p>I have this line and after it is submitted as a form, C7000 or C3000 gets stored as a string. For the edit page, I cannot get the stored value to be the preloaded option on the dropdown instead of \"Select One\". What am I doing wrong?</p>\n\n<p><code>= select_tag :enclosure_model, \"&lt;option&gt;Select One&lt;/option&gt;&lt;option&gt;C7000&lt;/option&gt;&lt;option&gt;C3000&lt;/option&gt;\".html_safe, :disabled =&gt; false</code></p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","user-interface"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13147846,"title":"Rails sign up, edit more thorough than new","body":"<p>I'd like to make it easy for users to sign up for my rails app (only 2 fields, username and password), but when they edit their information, I'd like to give them the opportunity to store much more data.  I don't want to ask them everything up front as I don't want to dissuade account creation.</p>\n\n<p>What's the rails way of doing this correctly (and best UI way)?  Should I... </p>\n\n<ul>\n<li>Initialize all except username + password with null values, or default values, and display those as incentive to replace with accurate information?  (Seems wrong.)</li>\n<li>Have a nested model, \"Profile,\" belonging to \"User\" that I ask them to fill out after signing up?  What do I display for the Profile for the User before they do that?  (This seems to bring me back to the \"seems wrong\" of (1) above.</li>\n<li>Some sort of wizard thing and force them to answer all my questions before displaying anything?</li>\n<li>Create a basically empty profile that displays nothing, but has in-line editing when they do update the null information?  (Is the data actually null before that, or something else?)  If so, does the form get embedded in the User#show controller then?  How?</li>\n</ul>\n\n<p>Also, if I want my form to be sleek and AJAXy, is that a consideration that changes anything?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mobile","view-helpers"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13147837,"title":"Conditional inclusion of rails view helper file?","body":"<p>I'm developing a mobile version of my site and want to separate out the mobile view helpers from my non-mobile view helpers.</p>\n\n<p>I know I could simply namespace them and include the helper file, or prefix every method with mobile_, but that's simply silly.  What I want to do is something like this:</p>\n\n<pre><code>helper :desktop, unless: is_mobile_device?\nhelper :mobile, if: is_mobile_device?\n</code></pre>\n\n<p>but can't seem to find a way to do this.  This way I can have a <code>def title</code> method in both but they are handled differently depending on mobile or not, for example.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13147657,"title":"Rails joker has_one username, dancer has_one username","body":"<p>In my rails app, I have a username model that is polymorphically attached to 2 models joker and dancer.</p>\n\n<p>When creating a Joker, form sends a string that is the username for Joker. How should I go about setting this up so that rails does not throw an error when receiving a string instead of an AR object, for username?</p>\n\n<p>Here is the code I have now.</p>\n\n<pre><code>class Joker &lt; ActiveRecord::Base\n  attr_accessible :username\n\n  has_one :username\nend\n</code></pre>\n\n<p>and in create of Jokers_controller</p>\n\n<pre><code>@joker = Joker.new(params[:joker])\n</code></pre>\n\n<p>Rails throws this error:</p>\n\n<pre><code>Username(#19110) expected, got String(#9130)\n</code></pre>\n\n<p>So this is the form field</p>\n\n<pre><code>= form_for @joker do |f|\n  - if @joker.errors.any?\n    #error_explanation\n      h2 = \"#{pluralize(@joker.errors.count, \"error\")} prohibited this joker from being saved:\"\n      ul\n        - @joker.errors.full_messages.each do |message|\n          li = message\n\n\n  = f.text_field :username\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13144624,"title":"Use Rails’ form_for but set custom classes, attributes on <form> element?","body":"<p><code>form_for</code> seems to ignore any 'extra' attributes like a <code>data-foo</code> attribute or <code>class</code> passed as <code>options</code> in its second argument.</p>\n\n<pre><code>= form_for @user, {:url =&gt; 'foo', :class =&gt; 'x', 'data-bar' =&gt; 'baz' } do |f|\n  # ...\n</code></pre>\n\n<p>The output is a <code>&lt;form&gt;</code> tag with no <code>x</code> class or <code>data-bar</code> attribute.</p>\n\n<p>What’s the fix?</p>\n\n<p>Or, how can I grab a <code>FormBuilder</code> instance without using <code>form_for</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","actionview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13147000,"title":"Get actual object Rails","body":"<p>I have two forms in my new view, one is for the product and the other is for fotos. \nWhen I upload the fotos with a select.file field, these are created by Ajax call by a file create.js.erb then when I fill the others fields to the product I've another button to create it. So I have two forms and one way to create each one.</p>\n\n<p>The problem is the ID, the solution that I've found was to create an object before the user enter to the new view, so I have this code:</p>\n\n<p>Product's controller:</p>\n\n<pre><code>def new\n      @product = current_user.products.create\nend\n</code></pre>\n\n<p>It creates an object nil, now I can create my Foto to that object, like this:</p>\n\n<p>Painting's controller:</p>\n\n<pre><code>def create\n   @product = Product.last\n   @painting = @product.paintings.create(params[:painting])\nend\n</code></pre>\n\n<p>The problem is the line \"@product = Product.last\", I know that it isn't the right solution, because when I try the edit action, and when I try to create new objects it goes to the last product and not to the actual edit product.</p>\n\n<p>How can I find that current product at my new action???</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["ruby-on-rails","redis","resque","beanstalkd"],"answer_count":3,"favorite_count":16,"up_vote_count":19,"down_vote_count":0,"view_count":5708,"score":19,"question_id":4808351,"title":"delayed_jobs vs resque vs beanstalkd?","body":"<p>Here is my needs: </p>\n\n<ul>\n<li>Enqueue_in(10.hours, ... ) (DJ syntax is perfect.)</li>\n<li>Multiply workers, concurrently. (Resque or beanstalkd are good for this, but not DJ)</li>\n<li>Must handle push and pop of 100 jobs a second. (I will need to run a test to make sure, but I think DJ can't handle this many jobs)</li>\n</ul>\n\n<p>Resque and beanstalkd don't do the enqueue_in. </p>\n\n<p>There is a plugin (resque_scheduler) that does it, but I'm not sure of how stable it is.</p>\n\n<p>Our enviroment is on amazon, and they rolled out the beanstalkd for free for who has amazon instances, that is a plus for us, but I'm still not sure what is the best option here.</p>\n\n<p>We run rails 2.3 but we are bringing it to speed to rails 3.0.3 soon.</p>\n\n<p>But what is my best choice here? \nAm I missing another gem that does this job better?</p>\n\n<p>I feel my only option that actually works now is the resque_scheduler.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13120837,"title":"Order by two things in two different styles","body":"<p>Theoretically what I want is this:<br>\n<code>:order =&gt; \"column1 ASC, column2 DESC\"</code></p>\n\n<p>But column1 is actually not a column in my case but an aggregated value:<br>\n<code>:order =&gt; relations.count</code></p>\n\n<p>How can I order by two columns when one of those is actually an aggregated value?</p>\n\n<p>Btw: Counter-Cache is not an option (because it is outdated when I need it)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13147403,"title":"Accessing HTML tags in a RUBY Controller","body":"<p>I have the following code in my HTML.erb</p>\n\n<pre><code>&lt;form&gt;\n   &lt;input id=\"do\" type=\"hidden\" value=\"0\" /&gt;\n   &lt;button type=\"submit\" value=\"Next\"&gt;SUBTRACT&lt;/button&gt;\n&lt;/form&gt;\n&lt;form&gt;\n  &lt;input id=\"do\" type=\"hidden\" value=\"1\" /&gt;\n  &lt;button type=\"submit\" value=\"Next\" &gt;ADD&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Now When I click the any of the 2 buttons, I want to check the value of the input id=\"do\" inside my Ruby Controller. What would the syntax look like ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":21,"score":4,"question_id":13147277,"title":"Rails: path of file","body":"<p>I have inside <code>app</code> a directory called <code>csv</code> and inside this dir I have a file called <code>names.csv</code>\nI want to use <code>File.read(path:string)</code> function to read the file.<br>\nwhat is the relative path to the file?  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13135647,"title":"How to specify a controller and action in form to create new resources","body":"<p>I have QuestionsController and TrueFalseQuestionsController. I built a form to create question true/false, this is my form:</p>\n\n<pre><code>&lt;%= simple_form_for @question, defaults: { error: false } do |question_form| %&gt;\n  &lt;fieldset&gt;\n    &lt;legend&gt;Question&lt;/legend&gt;\n    &lt;%= render 'shared/error_messages', object: question_form.object %&gt;\n    &lt;%= question_form.input :content, input_html: { rows: 3, class: 'span6' } %&gt;\n    &lt;%= question_form.input :mark, input_html: { class: 'span1' } %&gt;\n    &lt;%= question_form.association :topic %&gt;\n\n    &lt;%= question_form.simple_fields_for :answers do |answer_form| %&gt;    \n      &lt;%= answer_form.input :correct,\n            collection: [[true, 'True'], [false, 'False']],\n            as: :radio_buttons,\n            label: 'Answer',\n            value_method: :first,\n            label_method: :last,\n            item_wrapper_class: 'inline' %&gt;\n    &lt;% end %&gt;\n  &lt;/fieldset&gt;\n\n    &lt;%= question_form.button :submit, class: 'new_resource' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Now when I submit the form, it uses create action in QuestionsController, so how can I specify form to use create action in TrueFalseQuestionsController?</p>\n"},{"tags":["ruby-on-rails","pdf","adobe-reader"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":9823574,"title":"Adobe PDF Reader keeps opening previously read document","body":"<p>We have a rails application that serves up PDFs to users via send_file</p>\n\n<p>We are getting complaints that when the user opens multiple PDFs in a given day, when they click on our link, adobe opens the PDF they read last time.  </p>\n\n<p>We have looked at our logs / audits and everything appears that the correct data was sent to the user's browser.  </p>\n\n<p>We are unable to reproduce this problem, and we are only getting 1 or 2 out of thousands of users that are running into this issue.</p>\n\n<p>The only workaround right now is for the user to close all instances of Firefox.</p>\n\n<p>Anyone ever seen anything like this before?</p>\n"},{"tags":["ruby-on-rails","select-tag"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":2085,"score":3,"question_id":4007615,"title":"Setting option value as array index in a select with rails","body":"<p>I want to create a select tag using rails <code>collection_select</code> or <code>options_for_select</code> with the items of an array which are not model based. The value of the option should be the array index of each item. </p>\n\n<p>Example: desired output for <code>['first', 'second', 'third']</code>:</p>\n\n<pre><code>&lt;select id=\"obj_test\" name=\"obj[test]\"&gt;\n    &lt;option value=\"0\"&gt;first&lt;/option&gt; \n    &lt;option value=\"1\"&gt;second&lt;/option&gt; \n    &lt;option value=\"2\"&gt;third&lt;/option&gt; \n&lt;/select&gt; \n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","google-maps-api-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13146897,"title":"google map in rails app randomly clears?","body":"<p>My team and I are having an issue with a google map object in our rails app. </p>\n\n<p>Bascially, we have a database. one of the tables has 9 rows in it, each with location attributes. When the page with the google map on it loads, it querys the database, grabs all the location attributes for those 9 rows into an array, loops through and sets markers on the map at all 9 locations, then sets a marker where the user currently is, then puts a 500M radius around said user. This all works beautifully (I'm rather impressed as I've never done anything like this before). However, we made a page accessible by mobile devices such as an ipad. My team members worked all that out, it works good. </p>\n\n<p>We are now running into a weird issue. When I navigate to the page.mobile on my laptop to view the mobile page in my browser, AND if I connect and navigate there on my ipad, what it does is it loads the map, all the markers, the users marker, the radius, then stop for a second, then clears all markers and the radius and reloads the map at coords 0,0 (middle of the ocean). I can't figure out why it does that? Theres no excecuting script after the map loads.. the function that populates the map and all that is the last javascript function that I have excecuting. No errors come up in the console, nothing happens in the rails server after the map loads, the last thing to load is assets/beachflag.png (for the users location), the map also still works fine, just that all the markers and things are gone.</p>\n\n<p>The desktop version seems to work fine also.</p>\n\n<p>Has anyone else seen a similar issue? I need help... This is messedddd up!</p>\n\n<p>p.s. if it matters im using the latest versions of rails and ruby</p>\n"},{"tags":["ruby-on-rails","ruby","parsing","partials"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13142076,"title":"ruby rails print specific elements from multiple partial files residing in a direcotry","body":"<p>I have a directory filled with partials.  I'm looking to list ONLY the first h1 tags in each partial.  The methods to accomplish this task could probably be modified to grab other elements as well.</p>\n\n<p>Right now I use ruby to open each file, print out the first few characters, close file, and repeat.  My ruby file parsing skills are limiting me.  Here's the code I have at the moment:</p>\n\n<pre><code>    &lt;% Dir[\"app/views/partials/show/*.html.erb\"].each do |f1| %&gt;\n        &lt;% aFile = File.open(f1, \"r\") %&gt;\n        &lt;% if aFile %&gt;\n            &lt;% content = aFile.sysread(20) %&gt;\n            &lt;p&gt;&lt;%= content %&gt;&lt;/p&gt;\n        &lt;% else %&gt;\n            &lt;%= \"Unable to open file!\" %&gt;\n        &lt;% end %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I also think I'm opening the entire partial in memory?  Wondering If I can just read up until I find my h1 tag then close file and move on?  Again I'm only reading first 20 characters because I haven't yet grasped a way to search for the first h1 tag.</p>\n\n<p>I'll make edits as I work through the open, parse, piece... I appreciate any guidance and direction you can offer. Thanks!</p>\n\n<p><strong>EDIT:</strong>\nBased on comments below there may be a far better way to accomplish my task.  So I'm providing some additional background to get direction on other solutions.</p>\n\n<p>This is for a slide show based on partials in a directory.  The slide show is controlled with a navigation element  which I would like to populate by the h1 tags in the partials.  I'm not going to manually enter these things every time a change is made!  I want the end user to simply drag and drop partials into a directory (with a certain name convention and h1 tag description for navigation) and let the slide show do everything else.</p>\n\n<p>I could impose a class on the h1 tag \"forNavigation\" and on the content \"sliderContent\" and then use jquery to create a post load <code>&lt;ul&gt;</code> but that doesn't seem right.  Plus they'll all be part of the same rendered div.</p>\n\n<p>I guess I'm not clear why reading the first 50 characters of a partial, copying whats in the h1 tags, and putting it in a  isn't the most elegant solution?</p>\n\n<p>Like I said, above does everything needed except copy and print whats between the first h1 tag... With an xml parser or some regexp it'll be done.  I'm just no good with parsing files.</p>\n\n<p>Please let me know other methods to approach this.  Right now I still think it's best to parse the partial (with or without rendering) and put what I need where I want it as needed.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":132,"score":6,"question_id":13008922,"title":"Testing Response cookie with Rspec v.1","body":"<p>When I login to my app the server sends me back cookies(credentials and some app's cookie):</p>\n\n<pre><code>Response sent 170 bytes of Cookie data:\n Set-Cookie: user_credentials=val; path=/; HttpOnly; Secure\n\nResponse sent 554 bytes of Cookie data:\n Set-Cookie: _app_session=otherVal; path=/; HttpOnly; Secure\n</code></pre>\n\n<p>...and then redirects to the home page;</p>\n\n<p>Cookies include some flags: e.g. <code>httpOnly</code>, <code>Secure</code>, etc.</p>\n\n<p>How can I test whether cookies do include those flags with Rspec?</p>\n\n<p>At least where can I find those cookies?</p>\n\n<pre><code>it \"should generate cookies with proper flags\" do    \n    params = Factory.attributes_for(:user,\n      :username =&gt; \"uname\",\n      :password =&gt; \"upass\"\n    )\n    # login\n    post 'create', params\n\n    response.should redirect_to home_url # =&gt; pass\n\n    puts \"response cookie = #{response.cookies.inspect}\" # =&gt; {} // no cookies in response, why?\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","module","forem"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13146303,"title":"Ruby - How to access module's methods?","body":"<p>I'm installing a forum using the Forem gem. There's an option that allows avatar personalization, since it's possible to login with Facebook. You just specify your method in the User model and that's it.</p>\n\n<pre><code># Forem initializer\nForem.avatar_user_method = 'forem_avatar'\n\n# User model\ndef forem_avatar\n  unless self.user_pic.empty?\n    self.user_pic\n  end\nend\n</code></pre>\n\n<p>But I want a fallback on Gravatar for normal, non-facebook accounts. <a href=\"https://github.com/radar/forem/blob/master/app/helpers/forem/posts_helper.rb\" rel=\"nofollow\">I've found the method on Forem</a> and in theory, I need to call the <code>avatar_url</code> method:</p>\n\n<pre><code># User model\ndef forem_avatar\n  unless self.user_pic.empty?\n    self.user_pic\n  else\n    Forem::PostsHelper.avatar_url self.email\n  end\nend\n</code></pre>\n\n<p>However, Forem isn't an instance, but a module and I can't call it nor create a new instance. The easy way is to copy the lines of that method, but that's not the point. Is there a way to do it?</p>\n\n<p>Thanks</p>\n\n<h1>Update</h1>\n\n<p>Both answers are correct, but when I call the method either way, there's this <code>undefined local variable or method 'request'</code> error, which is the last line of the original <code>avatar_url</code>.   </p>\n\n<p>Is there a way  to globalize that object like in PHP? Do I have to manually pass it that argument?</p>\n"},{"tags":["ruby-on-rails","ruby","map","gsub"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":39,"score":1,"question_id":13146774,"title":"Add plus before first symbol in word in string and * after last","body":"<p>I have such string:</p>\n\n<pre><code>Тормозные диски\n</code></pre>\n\n<p>How can i transform it into </p>\n\n<pre><code>+Тормозн* +дис*\n</code></pre>\n\n<p>Now with help of SO i use gsub, but some people say that it could be done via map. But how? \nNote: main trouble is that i have cyrillic symbols... </p>\n\n<p>now:</p>\n\n<pre><code>art_group_search = art_group.gsub(/\\b(\\w+?)\\w{0,2}\\b/, '+\\1*').mb_chars.upcase.to_s\n</code></pre>\n"}]}
{"total":93231,"page":18,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13140604,"title":"Association won't save inside of before_validation","body":"<p>I'm trying to use the before_validation callback to adjust the number of child objects for a record, but for some reason, its not working the way I expect. </p>\n\n<p>LineItem class:</p>\n\n<pre><code> before_validation :adjust_enrollment_count\n\n def adjust_enrollment_count\n    if enrollments.size &lt; quantity \n      (enrollments.size+1..quantity).each do |li|\n        self.enrollments.build(variant: self.variant)\n      end\n      #self.save\n    elsif enrollments.size &gt; quantity\n      enrollments.delete_if do |e| \n        enrollments.size &gt; quantity\n      end\n    end\n  end\n</code></pre>\n\n<p>What happens is that it creates the correct number of Enrollment objects as children to the LineItem, but the Variant gets set to nil (even though the LineItem has a variant defined).</p>\n\n<p>Things I've tried:</p>\n\n<ul>\n<li>Explicitly saving the line_item or the enrollment </li>\n<li>\"pry\"ing into the callback and running the code manually (this actually worked the way\nI expected!)     </li>\n<li>Verifying that \"self\" referred to the LineItem and not the closure</li>\n</ul>\n\n<p>Is there something about the callback lifecycle that I'm missing? Is there a better way to adjust the number of Enrollment objects as the quantity changes on the LineItem?</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","heroku"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":100,"score":7,"question_id":13145988,"title":"Will UUID as primary key in PostgreSQL give bad index performance?","body":"<p>I have created an app in Rails on Heroku using a PostgreSQL database.</p>\n\n<p>It has a couple of tables designed to be able to sync with mobile devices where data can be created on different places. Therefor I have a uuid field that is a string storing a GUID in addition to an auto increment primary key. The uuid is the one that is communicated between the server and the clients.</p>\n\n<p>I realised after implementing the sync engine on the server side that this leads to performance issues when needing to map between uuid&lt;->id all the time (when writing objects, I need to query for the uuid to get the id before saving and the opposite when sending back data).</p>\n\n<p>I'm now thinking about switching to only using UUID as primary key making the writing and reading much simpler and faster.</p>\n\n<p>I've read that UUID as primary key can sometimes give bad index performance (index fragmentation) when using clustered primary key index. Does PostgreSQL suffer from this problem or is it OK to use UUID as primary key?</p>\n\n<p>I already have a UUID column today so storage wise it will be better because I drop the regular id column.</p>\n"},{"tags":["html","ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13146035,"title":"Changing value of Ruby Variable in Html.erb","body":"<p>I have the following code in my controller: </p>\n\n<pre><code>class TestController &lt; ApplicationController\n\n@@a = 1\n\ndef index\n    @temp = connection.execute(\"select test_id from mastertest limit #{@@a}, 5;\")\nend\n</code></pre>\n\n<p>And I have the following code in my View(Html.erb) File:</p>\n\n<pre><code>&lt;button type=\"submit\" value=\"Next\" form=\"submit_form\"&gt;NEXT&lt;/button&gt;\n&lt;form id=\"submit_form\"&gt;\n&lt;% @@a = @@a + 1 %&gt;\n    &lt;table&gt;\n      &lt;% @temp.each do |row| %&gt;\n        &lt;tr&gt;&lt;td&gt;&lt;%= row[0] %&gt;&lt;/td&gt;&lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/table&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>So basically I am trying to change the value of the class variable @@a on clicking the Next button. But it does not change the value of @@aa. Can someone help me how to do that.</p>\n"},{"tags":["ruby-on-rails","ruby","autocomplete","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13146095,"title":"Mongoid fill out referenced ids","body":"<p>I'm building an autocomplete feature for my rails app. The input form makes an ajax call on keypress which then calls this search method in rails</p>\n\n<pre><code>def search\n    search = Regexp.new(params[:name])\n    @users = User.where(:name=&gt;search)\n\n    render :json =&gt; @users\n  end\n</code></pre>\n\n<p>All works fine... However, the user has a bunch of fields that are foreign keys to other collections.</p>\n\n<p>For example, one of these fields is for rolify. <code>role_ids</code> which looks like <code>\"role_ids\" : [ObjectId(\"508eee5afa0d00b818000001\"), ObjectId(\"508eee92fa0d00b818000002\")]</code> which each map to something like <code>administrator</code> or <code>moderator</code></p>\n\n<p>What I want to do is replace these ids with the actual document from the roles collection. I know I can just manually fill it out, but I was hoping that there would be some way with Mongoid to automatically populate.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13146138,"title":"conception issue with a has_many association","body":"<p>There is something wrong with my associations.<br>\nI want that many VideoPost can refer to the same VideoInformation.\nI then thought that the foreign key should be in VideoPost so I started with the 2 models you can see below.\nBut I can't access to @video_post.video_information (which seems to make sense since there is no association in VideoPost)<br>\nHow should I do ? I'm a little confuse here</p>\n\n<p>Thanks for any help !</p>\n\n<p>My VideoPost model :  </p>\n\n<pre><code># Table name: video_posts\n#\n#  id                   :integer          not null, primary key\n#  user_id              :integer\n#  video_information_id :integer\n#  created_at           :datetime         not null\n#  updated_at           :datetime         not null\nclass VideoPost &lt; ActiveRecord::Base\n  belongs_to :user\n\n  attr_accessible :video_information_id\nend\n</code></pre>\n\n<p>My VideoInformation model :  </p>\n\n<pre><code># Table name: video_informations\n#\n#  id              :integer          not null, primary key\n#  title           :string(255)\n#  description     :text\n#  keywords        :text\n#  duration        :integer\n#  video_url       :string(255)\n#  thumbnail_small :string(255)\n#  thumbnail_large :string(255)\n#  created_at      :datetime         not null\n#  updated_at      :datetime         not null\nclass VideoInformation &lt; ActiveRecord::Base\n  has_many :video_posts\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","tablesorter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13145896,"title":"Hover effect disable in jquery tablesorter gem rails","body":"<p>I am using jquery table-sorter gem for my rails application. In rails, I just add the path to js and css necessary to files. How do I add changes to css files since I got only the path of CSS and js in the application.</p>\n\n<p>I am using a check box to select rows and sometimes it takes hover effect on the table as if the row has been checked. How to disable this effect??</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13145696,"title":"Ruby on Rails : add a new route","body":"<p>I'm new with RoR so this is a newbie question:<br>\nif I have a controller <code>users_controller.rb</code> and I add a method <code>foo</code>, shouldn't it create this route?  </p>\n\n<blockquote>\n  <p><a href=\"http://www.localhost:3000/users/foo\" rel=\"nofollow\">http://www.localhost:3000/users/foo</a></p>\n</blockquote>\n\n<p>because when I did that, I got this error:  </p>\n\n<blockquote>\n  <p>Couldn't find User with id=foo</p>\n</blockquote>\n\n<p>I of course added a view <code>foo.html.erb</code></p>\n\n<p><strong>EDIT:</strong><br>\nI added to <code>routes.rb</code> this code but I get the same error:</p>\n\n<pre><code>resources :users do\n    get \"signup\"\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rexml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":11,"score":2,"question_id":13145888,"title":"Getting the XML ID using REXML","body":"<p>I have an XML response as included below. How can I obtain the  element?</p>\n\n<p>In rails I have:</p>\n\n<pre><code>xml = REXML::Document.new(contacts_as_xml)\nRails.logger.info xml[1].attributes[\"id\"] \n</code></pre>\n\n<p>Which is not returning 'user@company.com'</p>\n\n<p>Thanks</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;\n&lt;feed xmlns=\"http://www.w3.org/2005/Atom\" xmlns:openSearch=\"http://a9.com/-/spec/opensearch/1.1/\" xmlns:gContact=\"http://schemas.google.com/contact/2008\" xmlns:batch=\"http://schemas.google.com/gdata/batch\" xmlns:gd=\"http://schemas.google.com/g/2005\" gd:etag=\"W/&amp;quot;Ck8BQ38yfyt7I2A9WhNSFk8.&amp;quot;\"&gt;\n    &lt;id&gt;user@company.com&lt;/id&gt;\n    &lt;updated&gt;2012-10-30T18:14:12.197Z&lt;/updated&gt;\n    &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n    &lt;title&gt;Users's Contacts&lt;/title&gt;\n    &lt;link rel=\"alternate\" type=\"text/html\" href=\"http://www.google.com/\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#feed\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#post\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#batch\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/batch\" /&gt;\n    &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full?max-results=10000\" /&gt;\n    &lt;author&gt;\n        &lt;name&gt;User Howdy&lt;/name&gt;\n        &lt;email&gt;user@company.com&lt;/email&gt;\n    &lt;/author&gt;\n    &lt;generator version=\"1.0\" uri=\"http://www.google.com/m8/feeds\"&gt;Contacts&lt;/generator&gt;\n    &lt;openSearch:totalResults&gt;2&lt;/openSearch:totalResults&gt;\n    &lt;openSearch:startIndex&gt;1&lt;/openSearch:startIndex&gt;\n    &lt;openSearch:itemsPerPage&gt;10000&lt;/openSearch:itemsPerPage&gt;\n    &lt;entry gd:etag=\"&amp;quot;QXc5eDVSLit7I2A9WhdSFk8PTgU.&amp;quot;\"&gt;\n        &lt;id&gt;http://www.google.com/m8/feeds/contacts/myuser%40mysite.com/base/970a99881a51f3&lt;/id&gt;\n        &lt;updated&gt;2011-07-25T20:31:50.920Z&lt;/updated&gt;\n        &lt;app:edited xmlns:app=\"http://www.w3.org/2007/app\"&gt;2011-07-25T20:31:50.920Z&lt;/app:edited&gt;\n        &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n        &lt;title&gt;Jon Paris&lt;/title&gt;\n        &lt;link rel=\"http://schemas.google.com/contacts/2008/rel#photo\" type=\"image/*\" href=\"https://www.google.com/m8/feeds/photos/media/myuser%40mysite.com/970a99881a51f3\" /&gt;\n        &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/970a99881a51f3\" /&gt;\n        &lt;link rel=\"edit\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/970a99881a51f3\" /&gt;\n        &lt;gd:name&gt;\n            &lt;gd:fullName&gt;Jon Adams&lt;/gd:fullName&gt;\n            &lt;gd:givenName&gt;Jon&lt;/gd:givenName&gt;\n            &lt;gd:familyName&gt;Adams&lt;/gd:familyName&gt;\n        &lt;/gd:name&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#other\" address=\"jon@adams.com\" primary=\"true\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#home\" address=\"jon@adams.com\" /&gt;\n    &lt;/entry&gt;\n    &lt;entry gd:etag=\"&amp;quot;R3YzcTFbKit7I2A9WhJbE00ORQY.&amp;quot;\"&gt;\n        &lt;id&gt;http://www.google.com/m8/feeds/contacts/myuser%40mysite.com/base/1229b5e8eeef3e3&lt;/id&gt;\n        &lt;updated&gt;2012-09-22T08:57:06.889Z&lt;/updated&gt;\n        &lt;app:edited xmlns:app=\"http://www.w3.org/2007/app\"&gt;2012-09-22T08:57:06.889Z&lt;/app:edited&gt;\n        &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;link rel=\"http://schemas.google.com/contacts/2008/rel#photo\" type=\"image/*\" href=\"https://www.google.com/m8/feeds/photos/media/myuser%40mysite.com/1229b5e8eeef3e3\" gd:etag=\"&amp;quot;UQZOJlcjWit7I2BmGBdVTzBfL2E2GGI5Myk.&amp;quot;\" /&gt;\n        &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/1229b5e8eeef3e3\" /&gt;\n        &lt;link rel=\"edit\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/1229b5e8eeef3e3\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#other\" address=\"person@site.com\" primary=\"true\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#home\" address=\"person@gmail.com\" /&gt;\n    &lt;/entry&gt;\n&lt;/feed&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","mvc","model"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13144601,"title":"Where should I place a \"notify user\" method in a Rails app (or any MVC app)?","body":"<p>I have heard several views on MVC structure in a web application. Some people believe the model should be very small, and only contain ActiveRecord (or some other ORM) and small things like <code>validates</code> and <code>belongs_to</code>, so model's are only a couple lines long.</p>\n\n<p>I personally think the model can play a larger role in apps. For example, I need to notify a user frequently throughout my app. The notifications can trigger from multiple controllers. They all send a notification to a user based on his or her notification settings, which is an object accessible through the user model.</p>\n\n<p>I would like to make something like:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  #validations, relationships, etc\n\n  def notify(event)\n    notif = Notification.new\n    notif.type = event.type\n    notif.to = self.id\n    # etc\n\n    if notif.save\n      # send the notification based on the settings\n    end\n  end\nend\n</code></pre>\n\n<p>This would make it possible from any controller to use <code>@user.notify</code> to deliver messages to a user. This makes things really clean, but I realize there is some logic in my model. Not to mention the model makes another model.</p>\n\n<p>Another approach I wouldn't mind is creating the notification and sending it through that object. So controllers could do <code>Notification.new(:to =&gt; @user.id, ...)</code> and then deliver the message via a <code>Notification.send</code>. This would also put some logic in the Notification object so it knows how to send itself. In fact, I might like this approach better than creating the notification object through the User model.</p>\n\n<p>I don't mind these small bits of logic in the Model to make things convenient when sending messages from multiple controllers. Is this the best way to go about it? I suppose a more purist method is to include a NotificationHelper module in each controller that sends notifications?</p>\n\n<p>edit: I've been reading a bit about \"domain logic\" in models. It seems like this is encouraged, and I suppose the <code>notify</code> or <code>send</code> methods are considered domain logic. Can any developer experienced in MVC comment on this?</p>\n"},{"tags":["ruby-on-rails","ruby","load","require"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13146025,"title":"Ruby `require` doesn't find my file in rails lib","body":"<p>I'm trying to load a file from my rails 'lib' dir, but I get the error:</p>\n\n<pre><code>LoadError: cannot load such file -- lib/ss.rb\n</code></pre>\n\n<p>This is odd because in the console:</p>\n\n<pre><code>File::exist? 'lib/ss.rb' # =&gt; true\nload 'lib/ss.rb' # =&gt; true\nrequire 'lib/ss.rb' # =&gt; LoadError\n</code></pre>\n\n<p>What's more, this file should be auto-loading on start because in my application.rb file, I uncommented the line:</p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib)\n</code></pre>\n\n<p>Can anyone give me insight?</p>\n"},{"tags":["ruby-on-rails","heroku","console"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13145656,"title":"How to destroy all records for a table including :dependent records in other tables","body":"<p>What is the best way to do this on Heroku? through the console? I do have 'dependent: :destroy' set for all the dependent tables.</p>\n"},{"tags":["ruby-on-rails","ruby","undefined","runtime-error"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13145611,"title":"Rails/Ruby NoMethodError: undefined method `order' for #<Array:0x718c278>","body":"<p>I want to execute the following:</p>\n\n<p>case 1:</p>\n\n<pre><code>x = Group.all[0].people\nx.class\n=&gt; Array\nx.order\n</code></pre>\n\n<p>fine.\n:)</p>\n\n<p>case 2:</p>\n\n<pre><code>y = Person.all\ny.class\n=&gt; Array\ny.order\n=&gt; NoMethodError: undefined method `order' for #&lt;Array:0x718c278&gt;\n</code></pre>\n\n<p>:(</p>\n\n<p>Both x and y contain the same type of item -  bunch of Person models.\nWhy can't ruby order the array?</p>\n\n<p>Thanks in Advance</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-masonry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":317,"score":0,"question_id":10345508,"title":"Jquery masonry having trouble getting multiple columns","body":"<p>I'm using the Jquery masonry plugin to structure a page so that it has 2 columns.</p>\n\n<p>I am not sure that the plugin is working...it only shows 1 column, and if I alter the column width in the Jquery code, nothing happens.</p>\n\n<p>Code is below - grateful for any advice!</p>\n\n<p>Thanks,</p>\n\n<p>Faisal</p>\n\n<pre><code>script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery.js\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery.masonry.min.js\"&gt;&lt;/script&gt;\n\n&lt;style&gt;\n.item {\n width: 480px;\n .....\n }\n\n&lt;/style&gt;\n&lt;div id=\"container\"&gt;\n &lt;div class=\"item\"&gt;\n ......\n &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;script&gt;\n$(function(){\n    var $container = $('#container');\n    $container.imagesLoaded(function(){\n      $container.masonry({\n        itemSelector : '.tile',\n        columnWidth : 100\n      });\n    });\n\n$container.infinitescroll({\n      navSelector  : '.flickr_pagination',    // selector for the paged navigation \n      nextSelector : 'a.next_page',  // selector for the NEXT link (to page 2)\n      itemSelector : '.tile',     // selector for all items you'll retrieve\n      loading: {\n          finishedMsg: 'No more pages to load.',\n          img: 'http://i.imgur.com/6RMhx.gif'\n        }\n      },\n      // trigger Masonry as a callback\n      function( newElements ) {\n        // hide new items while they are loading\n        var $newElems = $( newElements ).css({ opacity: 0 });\n        // ensure that images load before adding to masonry layout\n        $newElems.imagesLoaded(function(){\n          // show elems now they're ready\n          $newElems.animate({ opacity: 1 });\n          $container.masonry( 'appended', $newElems, true ); \n        });\n      }\n    );\n});\n&lt;/script&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13144560,"title":"Is \"resource\" a reserved Ruby/Rails word?","body":"<p>I tried to create a \"Resource\" class, but when I access the index page I get the \"stack level too deep\" error.</p>\n\n<p>I know that it indicates that the application is in a loop, so is \"resources\" a reserved word, even though it doesn't appear in the reserved words list, or has it something to do with the \"resources :resources\" in the routes file?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","capybara","will-paginate","railstutorial.org"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":610,"score":0,"question_id":10762896,"title":"Testing views with will_paginate Gem using Capybara/Rspec","body":"<p>Doing Michael Hartl's Rails Tutorial, on <a href=\"http://ruby.railstutorial.org/chapters/user-microposts#sec%3amicropost_exercises\" rel=\"nofollow\">chapter 10, section 5, exercise 2</a>. I am - very simply - trying to write tests to ensure that a pagination div appears on a couple pages using the will_paginate gem (this seems to be Hartl's preferred method of testing whether pagination works), but when I add the following code..</p>\n\n<pre><code>subject { page }\n.\n.\n.\nit { should have_selector('div.pagination') }\n</code></pre>\n\n<p>..it returns..</p>\n\n<pre><code>  1) UserPages profile page \n     Failure/Error: it { should have_selector('div.pagination') }\n       expected css \"div.pagination\" to return something\n</code></pre>\n\n<p>This is especially odd because in this particular _spec file, this same Rspec code is passing in some tests and failing in others (I'll highlight this below). Also the <code>pagination</code> div is present in the source code in my browser, and of course it's working fine.</p>\n\n<p>Because it fails in some places and not others, I got to assuming that this is somehow a \"scope\"- or assignment-type issue related to <code>will_paginate</code> - you see, for the failed tests, the content being paginated is actually part of a \"Microposts\" controller, but the pages/views being tested are handled by the \"Users\" controller. For the passing tests, the view and controller are both \"Users\".</p>\n\n<p>Could that be the problem? It's also possible that my FactoryGirl setup/invocation is broken and not triggering the pagination code in test for some reason. I'm a Rails n00b - and actually totally new to programming - so thanks ya'll. :)</p>\n\n<p>(also, p.s., how do I make my code colorful and pretty on SO?)</p>\n\n<p><strong>/spec/requests/user_pages_spec.rb</strong>\n</p>\n\n<pre><code>require 'spec_helper' # Omitted from below - I don't think this is relevant.\n\ndescribe \"UserPages\" do\n\n  subject { page }\n\n  describe \"index\" do # This is the block where it is PASSING..\n\n    let(:user) { FactoryGirl.create(:user) } # I'll include my /spec/factories.rb file below\n\n    before(:all)  { 30.times { FactoryGirl.create(:user) } }\n    after(:all)   { User.delete_all } # I'll omit my /app/models/user.rb file - I don't think it's relevant to the problem\n\n    before do\n      valid_signin user # References /spec/support/utilities.rb to sign in as a valid user, but I will omit this since this is part of the working tests\n      visit users_path # This is /app/views/users/index.html.erb - this is where SUCCESSFUL pagination testing occurs\n    end\n\n    describe \"pagination\" do\n\n      it { should have_selector('div.pagination') } #PASS!! As I would expect\n  .\n  .\n  .\n  end\n\n  describe \"profile page\" do\n    let(:user) { FactoryGirl.create(:user) }\n    let!(:m1) { FactoryGirl.create(:micropost, user: user, content: \"Awesome\")} # Used for other tests\n    let!(:m2) { FactoryGirl.create(:micropost, user: user, content: \"Sauce\") } # Used for other tests\n\n    before(:all)  { 30.times { FactoryGirl.create(:micropost) } } # Is this constructed properly? Perhaps the posts are not created, and that's why the failure to render the paginate code in test.\n    after(:all)   { user.microposts.delete_all } # I have tested with and without this line of code - it fails both ways.\n\n    before { visit user_path(user) } # /app/views/users/show.html.erb\n\n    it { should have_selector('div.pagination') } # FAIL!!! This is the line in question that generates the error above.\n    .\n   .\n  .\n .\nend\n</code></pre>\n\n<p><strong>/app/views/users/index.html.erb</strong> (pagination working on site, test working also)</p>\n\n<pre><code>&lt;%= provide(:title, 'All users') %&gt;\n&lt;h1&gt;All users&lt;/h1&gt;\n\n&lt;%= will_paginate %&gt;\n\n&lt;ul class=\"users\"&gt;\n  &lt;%= render @users %&gt;\n&lt;/ul&gt;\n\n&lt;%= will_paginate %&gt;\n</code></pre>\n\n<p><strong>/app/views/users/show.html.erb</strong> (pagination working on site, test failing)</p>\n\n<pre><code>&lt;% provide(:title, @user.name) %&gt;\n&lt;div class=\"row\"&gt;\n.\n.\n.\n  &lt;div class=\"span8\"&gt;\n    &lt;% if @user.microposts.any? %&gt;\n      &lt;h3&gt;Microposts (&lt;%= @user.microposts.count %&gt;)&lt;/h3&gt;\n      &lt;ol class=\"microposts\"&gt;\n        &lt;%= render @microposts %&gt;\n      &lt;/ol&gt;\n      &lt;%= will_paginate @microposts %&gt; # Here is where I declare that pagination should occur on @microposts, NOT @users\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>/spec/requests/factories.rb</strong></p>\n\n<pre><code>FactoryGirl.define do\n  factory :user do\n    sequence(:name)   { |n| \"Person #{n}\" }\n    sequence(:email)  { |n| \"person_#{n}@example.com\" }\n    password  \"secret\"\n    password_confirmation \"secret\"\n\n    factory :admin do\n      admin true\n    end\n  end\n\n  factory :micropost do\n    content \"Lorem ipsum\"\n    user\n  end\nend\n</code></pre>\n\n<p><strong>/Gemfile</strong></p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.3'\ngem 'pg', '0.12.2'\ngem 'bootstrap-sass', '2.0.0'\ngem 'bcrypt-ruby', '3.0.1'\ngem 'faker', '1.0.1'\ngem 'will_paginate', '3.0.3'\ngem 'bootstrap-will_paginate', '0.0.6'\n\ngroup :development do\n    gem 'guard-rspec', '0.5.5'\n    gem 'annotate', '~&gt; 2.4.1.beta'\nend\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '3.2.4'\n  gem 'coffee-rails', '3.2.2'\n  gem 'uglifier', '1.2.3'\nend\n\ngem 'jquery-rails', '2.0.0'\n\ngroup :test, :development do\n  gem 'rspec-rails', '2.9.0'\nend\n\ngroup :test do\n    gem 'capybara', '1.1.2'\n    gem 'rb-fsevent', '0.4.3.1', :require =&gt; false\n    gem 'growl', '1.0.3'\n    gem 'guard-spork', '0.3.2'\n    gem 'spork', '0.9.0'\n    gem 'factory_girl_rails', '1.4.0'\nend\n</code></pre>\n\n<p><strong>edit: found <a href=\"http://mislav.uniqpath.com/rails/will_paginate-view-testing/\" rel=\"nofollow\">this article related to will_paginate and view testing</a>, but don't understand it honestly (probably due to the syntax).. could it be somehow related?</strong> </p>\n"},{"tags":["jquery","ruby-on-rails","forms"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":270,"score":5,"question_id":13008196,"title":"asynchronous call with ajaxSubmit - jquery.form","body":"<p>I have a form with certain action. When the form is submitted I send an ajax call that calls this action. In the otherhand, I am sending another ajax call to update the progress. I have done it as follows:</p>\n\n<pre><code>    $(\"form\").submit(function() {               \n      function callBack()\n      {\n            if( (this.readyState == 4) &amp;&amp; (this.status == 200) )\n            {\n              console.log(this.responseText);\n            }\n      }\n\n      function updateProgress (){\n        asyncReq('/get_progress?progress='+progress, callBack);\n      }\n\n      function asyncReq(url, functionCallBack)\n      {\n            var request; //request must be a local var to avoid race condition\n            try\n            {   //for modern browsers\n              request = new XMLHttpRequest;\n            }\n            catch (err)\n            {// legacy IE\n              request = new ActiveXObject(\"Microsoft.XMLHTTP\");\n            }\n            request.onreadystatechange = callBack;\n            request.open(\"GET\", url, true);\n            request.send();\n      };\n      var progress = $(\"#progress\").val();\n      asyncReq('/get_progress?progress='+progress, callBack);\n      setTimeout(updateProgress, 2000);\n      $(this).ajaxSubmit({async: true});\n      return false;\n   });\n</code></pre>\n\n<p>I have 2 asynchronous javascript calls here, one for submitting the form and one for updating the progress. When I print out the <code>responseText</code> in <code>callBack</code>, I can only see 0.0 and 1.0. That is one before the <code>ajaxSubmit()</code> is called and after it is finished. I would like to get all the value of the progress in the middle as well. As far as I understand, the 2nd ajax call for <code>asyncReq</code> is called only after the <code>ajaxSubmit</code> is finished. Can anyone give me any idea about how I make the another complete ajax call before the <code>ajaxSubmit()</code> is complete?</p>\n\n<p><strong>Note:</strong> </p>\n\n<p>The form consists of file field and <code>ajaxSubmit</code> unzips, processes the file and updates the progress table after each file is processed. The <code>get_progress</code> method extracts the progress value of that table. I am using <a href=\"http://jquery.malsup.com/form/\" rel=\"nofollow\">jquery.form.js</a> for submitting the form by ajax call.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.1","respond-to","respond-with"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13145075,"title":"respond_to causes undefined method `to_sym' for [:json, :html]:Array","body":"<p>In Rails 3.2.8 in Ruby 1.9.3p194 when passing an array to <code>respond_to</code> in an included block of an ActiveSupport::Concern that is included on demand in the class definition by calling an <code>acts_as_...</code> method in module included in a gem results in a:</p>\n\n<pre><code>respond_to causes undefined method `to_sym' for [:json, :html]:Array\n</code></pre>\n\n<p>and on the next request, I get:</p>\n\n<pre><code>RuntimeError (In order to use respond_with, first you need to declare the formats your controller responds to in the class level):\n  actionpack (3.2.8) lib/action_controller/metal/mime_responds.rb:234:in `respond_with'\n</code></pre>\n\n<p>In the module code, it is just doing the equivalent of:</p>\n\n<pre><code>formats = [:json, :html]\nrespond_to formats\n</code></pre>\n\n<p>Where formats is configured elsewhere so it can be applied to all controllers that specify <code>acts_as_...</code>. </p>\n\n<p>I know it works when I do this in a class definition:</p>\n\n<pre><code>respond_to :json, :html\n</code></pre>\n\n<p>So, how can I call respond_to with a variable that is an array of formats?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","coffeescript","stripe-payments"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13131632,"title":"How to track down the cause of an error in coffescript and Stripe?","body":"<p>I'm using Stripe in my Rails 3 application to do creditcard payments. I'm roughly following the <a href=\"http://railscasts.com/episodes/288-billing-with-stripe\" rel=\"nofollow\">railscast on Stripe integration</a> though my app is doing just a single charge for now and not subscription billing like Ryan shows.</p>\n\n<p>The problem is, I can't get the <code>processCard()</code> function to fire. I'll be the first to admit I'm not a javascript guru (or any kind of guru for that matter). It doesn't give a javascript error, it instead submits the form to rails (without any credit card details) and fails since <code>stripe_card_token</code> is nil. I've placed some <code>alert()</code> dialogs spaced throughout for some very crude debugging to see where the hangup is. My model name is <code>Payment</code> which is really the only deviation so far from Ryan's code apart from the temporary alert() dialogs.</p>\n\n<p>So my question is twofold: How can I reliably track down what's causing the problem? and Where did I go wrong?</p>\n\n<p>Here's the Javascript:</p>\n\n<pre><code>jQuery -&gt;\n  Stripe.setPublishableKey($('meta[name=\"stripe-key\"]').attr('content'))\n  payment.setupForm()\n\npayment =\n  setupForm: -&gt;\n    $('#new_payment').submit -&gt;\n      $('input[type=submit]').attr('disabled', true)\n      alert(\"before processCard\")\n      payment.processCard()\n      alert(\"after processCard\")\n      false\n      # else\n      #   true\n\n  processCard: -&gt;\n    alert(\"processCard start\")\n    card =\n      number: $('#credit_card_number').val()\n      cvc: $('#cvc').val()\n      expMonth: $('#card_month').val()\n      expYear: $('#card_year').val()\n    alert(\"card values are set\")\n    Stripe.createToken(card, payment.handleStripeResponse)\n    alert(\"After createToken\")\n\n  handleStripeResponse: (status, response) -&gt;\n    if status == 200\n      alert(response.id)\n      # $('#payment_stripe_card_token').val(response.id)\n      # $('#new_payment')[0].submit()\n    else\n      alert(response.error.message)\n      # $('#stripe_error').text(response.error.message)\n      # $('input[type=submit]').attr('disabled', false)\n</code></pre>\n\n<p>And the associated view:</p>\n\n<pre><code>&lt;%= simple_form_for @payment, :html =&gt; { :class =&gt; 'form-horizontal'} do |f| %&gt;\n&lt;fieldset&gt;\n  &lt;legend&gt;Pay via Credit Card&lt;/legend&gt;\n\n    &lt;%= f.input :stripe_card_token, :as =&gt; :hidden, :id =&gt; 'stripe_card_token' %&gt;\n\n    &lt;div class=\"well well-small\"&gt;\n      &lt;%= current_user.full_name %&gt;&lt;br /&gt;\n      &lt;%= current_user.email %&gt;&lt;br /&gt;\n      This is the name we have on file for you. If it's not correct, please &lt;%= link_to \"change it now\", edit_user_registration_path(current_user) %&gt;\n    &lt;/div&gt;\n\n&lt;div id=\"stripe_error\"&gt;\n  &lt;noscript&gt;JavaScript is not enabled and is required for this form. First enable it in your web browser settings.&lt;/noscript&gt;\n&lt;/div&gt;\n\n&lt;div id=\"credit-card\"&gt;\n  &lt;div class=\"control-group string required\"&gt;\n    &lt;%= label_tag :credit_card_number, \"Card Number\", :class =&gt; \"control-label string required\" %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= text_field_tag :credit_card_number, nil, :class =&gt; \"string required\", :name =&gt; nil %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"control-group string required\"&gt;\n    &lt;%= label_tag :cvc, \"Security code (CVC)\", :class =&gt; \"control-label string required\" %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= text_field_tag :cvc, nil, :class =&gt; \"string required\", :name =&gt; nil %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"control-group date required\"&gt;\n    &lt;%= label_tag :card_month, \"Expiration Date\", :class =&gt; \"control-label date required\"%&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= select_month nil, {add_month_numbers: true}, {name: nil, id: \"card_month\", :class =&gt; \"date required span2\"} %&gt;\n      &lt;%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+25}, {name: nil, id: \"card_year\", :class =&gt; \"date required span2\"} %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n    &lt;h4&gt;Your unpaid courses&lt;/h4&gt;\n    &lt;% @unpaid_subs.each do |sub| %&gt;\n      &lt;%= sub.course.name %&gt;&amp;nbsp;|&amp;nbsp;&lt;%= sub.course.credits %&gt;&lt;br /&gt;\n    &lt;% end %&gt;\n\n&lt;div class=\"form-actions\"&gt;\n&lt;%= f.submit nil, :class=&gt;\"btn btn-primary\" %&gt;\n&lt;%= link_to \"Cancel\", courses_path, :class=&gt;\"btn\" %&gt;\n&lt;/div&gt;\n&lt;/fieldset&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Related Question(No accepted answer): <a href=\"http://stackoverflow.com/questions/11314013\">What is wrong with my CoffeScript in Stripe?</a></p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12643385,"title":"How to make jQuery remember state in a Rails app?","body":"<p>I'd be very grateful for a code snippet showing off jQuery functionality remembering state, e.g. .slideToggle(). </p>\n\n<p>I've read about local storage, session storage, ajax among others - what technique is preferred 2012 and how could an implementation look like in Ruby in Rails 3.2?</p>\n"},{"tags":["ruby-on-rails","ruby","tag-cloud","word-cloud"],"answer_count":2,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":1222,"score":4,"question_id":5492651,"title":"Word cloud generator for Rails","body":"<p>Is there a Ruby/Rails library that I can generate word clouds (output should be an image file) like in <a href=\"http://wordle.net\" rel=\"nofollow\">Wordle.net</a>?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":49,"score":-3,"question_id":13143992,"title":"`gsub` for sentence","body":"<p>I have a string:</p>\n\n<pre><code>Тормозные диски\n</code></pre>\n\n<p>and with <code>gsub</code>, I must get:</p>\n\n<pre><code>+ТОРМОЗН* +ДИС*\n</code></pre>\n\n<p>I need to:</p>\n\n<ul>\n<li>Convert to uppercase (could do with <code>upcase</code>)</li>\n<li>At the beginning of a word,  add <code>+</code></li>\n<li>For every word, slice the last two symbols</li>\n<li>At the last position, add <code>*</code></li>\n</ul>\n\n<p>It is hard for me to code all that are listed above. Help me, please.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","database-design","activerecord","controller"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12961706,"title":"How do I access information from multiple associated models in the Controller in an effiecient manner?","body":"<p>First, some background.</p>\n\n<p>My application models are like so:</p>\n\n<pre><code>  User has_many :subscriptions; has_many :courses, :through =&gt; :subscriptions\nSubscription belongs_to :course, :user\n  Course has_many :subscriptions; has_many :users, :through =&gt; :subscriptions\n</code></pre>\n\n<p>Subscription is a join table used to store information such as state (:active, :inactive, :failed, :passed, :unpaid) as well as serve as a connector to all the information that comes with taking a course (such as the Grade model(not yet added), the Payment model(work in progress), etc).</p>\n\n<p>I want to add the Payment model to store a history of payments on a subscription. Each payment can be for one or more subscriptions. So far, I've tried a <code>Payment has_many :subscriptions</code>, but <strong>I'm having trouble with the controller logic</strong> and I'm thinking maybe there's a better way to associate the models for \"a Payment from a User on a Subscription to a Course.\"</p>\n\n<p>Technically speaking, in a payment show action, I would need information from each of these models (course.name, user_id of user who paid, payment.amount, all of which are connected to a Subscription) and in a Payment.create action, I'd need to set the state of the subscription (that I can do).</p>\n\n<p>If this is a logical/efficient way to associate the various models, how do I access the needed information(some information from each model course, user, payment, and subscription) in the Payment show action with minimal database calls? I'm using <code>Rails 3.2/Ruby 1.9</code> and would like to stick with ActiveRecord/ARel instead of straight sql statements. I'm open to \"you're doing it wrong\" answers as well. If changing the associations will make it more efficient to access the tables from the controller, I'm open to that as well.</p>\n"},{"tags":["ruby-on-rails","ruby","include"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":67,"score":1,"question_id":13134894,"title":"Detecting similar strings in Ruby.","body":"<p>In my db, there are entries eg. <code>Тормозной диск</code>, <code>Диски тормозные LPR</code> etc. in <code>art_groups_arr</code> array. I would like to find all the entries similar to <code>Тормозной диск</code>, such as <code>Диски тормозные LPR</code></p>\n\n<p>This code:\n</p>\n\n<pre><code>art_groups_arr.each do |artgrarr|\n  if n2.art_group.include?(artgrarr)\n    non_original &lt;&lt; n2\n  end\nend\n</code></pre>\n\n<p>does not find them, obviously. How can I find those similar strings?</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","youtube"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":184,"score":0,"question_id":13130145,"title":"Sharing my page with youtube videos on facebook doesn't show thumbnail","body":"<p>I have a blog on my app and on this blog I usually put some youtube videos and when I share the links of these pages on Facebook there's no thumbnail. Is there a way to do this? </p>\n\n<p>I have tried to put meta-data with open graph protocol, with the youtube link but no luck.</p>\n\n<p>Is this possible?</p>\n\n<p><strong>EDITED</strong></p>\n\n<p>In my app I was including the OG video tag like this:</p>\n\n<pre><code>%meta{ :property =&gt; \"og:title\" , :content =&gt; \"#{post.title}\" }\n%meta{ :property =&gt; \"og:type\" , :content =&gt; \"article\" }\n%meta{ :property =&gt; \"og:url\" , :content =&gt; \"#{post_url(post.slug).sub('https:', 'http:')}\" }\n-if post.video_thumbnail &amp;&amp; post.video_thumbnail != \"\"\n  %meta{ :property =&gt; \"og:video\" , :content =&gt; \"http://www.youtube.com/watch?v=#{post.video_thumbnail}\"}\n</code></pre>\n\n<p>I found the answer on this question: <a href=\"http://stackoverflow.com/questions/2068344/how-to-get-thumbnail-of-youtube-video-link-using-youtube-api\">How to get thumbnail of YouTube video link using YouTube API?</a></p>\n\n<p>Youtube API lets you get images from the video if used this URL: </p>\n\n<pre><code>http://img.youtube.com/vi/&lt;insert-youtube-video-id-here&gt;/0.jpg\n</code></pre>\n\n<p>So I included that link as my OG image tag like this:</p>\n\n<pre><code>%meta{ :property =&gt; \"og:image\" , :content =&gt; \"http://img.youtube.com/vi/#{post.video_thumbnail}/0.jpg\" }\n</code></pre>\n\n<p>And it work perfectly.</p>\n"},{"tags":["ruby-on-rails","paypal","e-commerce","spree","donations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13143517,"title":"rails ecommerce donation center","body":"<p>I am trying to create a donation centre of sorts in Rails for a non-profit, using PayPal, and am wondering if I should start from scratch or use an existing eCommerce gem/platform. </p>\n\n<p>I want to: \n- list various \"products\", or donation types that a user can select, customize and pay for\n- be able to send/serve downloadable files to a donor, depending on their donation type \n- keep track of donors, donations and various custom bits of data the user enters\n- add hooks to add donors to mailing lists, push donation notifications to social media, etc. </p>\n\n<p>Basically, I want something that looks like a store and supports digital products, but processes donations instead of sales through PayPal.</p>\n\n<p>Does anyone have experience using Spree (or something similar) to accept donations? I can't seem to find evidence that this works without a lot of hacking.</p>\n\n<p>Thanks! </p>\n"},{"tags":["ruby-on-rails","rspec","oauth-2.0"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":442,"score":0,"question_id":9808519,"title":"Test OAuth2 request in rspec test with oauth-plugin gem","body":"<p>I use the latest oauth-plugin with Rails 3.1. I want to test my <strong>OAuth2</strong> API controllers with rspec tests. After trying a bunch of things to authorize my request I simply want to stub the <strong>oauthenticate</strong> filter to get rid of any authentication issues. But I still get a <em>401 Unauthorized</em> . Why??</p>\n\n<p>users_controller.rb:</p>\n\n<pre><code>class UsersController\n  oauthenticate\n\n  def update\n    &lt;do something&gt;\n  end\nend\n</code></pre>\n\n<p>users_controller_spec.rb:</p>\n\n<pre><code>describe UsersController do\n  describe \"POST 'update'\" do\n\n      before :each do\n        controller.stub!(:oauthenticate).and_return true\n      end\n\n      it \"should be a successful request\" do\n        post :update,  { \"user_id\" =&gt; \"some id\" }\n        response.should be_ok\n     end\nend\n</code></pre>\n\n<p>Expected ActionController::TestResponse to have a response code of 200, but got 401.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/5268672/rspec-testing-for-oauth-provider\">Rspec testing for oauth provider</a> doesn't help. With cucumber test everything works fine when setting a valid access token <em>Authorization header</em>.</p>\n"},{"tags":["javascript","jquery","ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13144396,"title":"Load options list once and render it to multiple select boxes on client side?","body":"<p>In my Rails 3.2 app, I have something similar to an album page which shows many photos. Under each of the photos is a select box where the user can choose from a number of options, formatted something like this:</p>\n\n<pre><code>&lt;select id=\"photo_1\"&gt;\n  &lt;option value=value_1&gt;Name of Value 1&lt;/option&gt;\n  ...\n  &lt;option value=value_n&gt;Name of Value N&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>The problem is, the list of values is very long (100s of possibilities), but exactly the same for each photo. Since each Album could possibly have dozens of photos, it seems inefficient to have the server send the full list each time a photo is loaded to the page. Is there a more efficient way to do this such as, for example, loading</p>\n\n<pre><code>  &lt;option value=value_1&gt;Name of Value 1&lt;/option&gt;\n  ...\n  &lt;option value=value_n&gt;Name of Value N&lt;/option&gt;\n</code></pre>\n\n<p>just once to the Album page when it is generated (perhaps as a hidden field), and then using jQuery/javascript to populate it into the photo's unique  tags on the client side, when the photo is loaded to the page? (NOTE: Photos load dynamically, so some may load after the initial load of the Album page, as the user uploads them.)</p>\n"},{"tags":["ruby-on-rails","github"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":30,"score":-1,"question_id":13111822,"title":"Ruby on Rails installation problems (basic?) Unable to connect to localhost:3000, and ssh key not generated properly for GitHub","body":"<p>I am almost a complete beginner to programming, having studied one book on HTML and CSS, and having watched a foundations of programming course on lynda.com. I have decided to learn Ruby on Rails using the Ruby on Rails Tutorial book (http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec-up_and_running).</p>\n\n<p>As per the instructions in the boook I have navigated to the Engine Yard RoR installer at <a href=\"http://railsinstaller.org/\" rel=\"nofollow\">http://railsinstaller.org/</a>, downloaded the .exe, and have followed their step-by-step installation instructions at <a href=\"http://railsinstaller.org/windows\" rel=\"nofollow\">http://railsinstaller.org/windows</a></p>\n\n<p>I have run into a couple of problems. The first time I followed the instructions was a bit of  a mess, as I opened and closed the command line several times, using the windows command line, a BASH command line, and perhaps a third one on separate occasions. Unsurprisingly the process wasn't successful. I then uninstalled all the relevant programs and decided to begin again. The second attempt has been more successful but I've still run into a few problems, and I feel like I need to get them sorted before I proceed any further. I have outlined the narrative of my installation attempt below. I believe that I have a problem with GitHub especially and hope that one of you may be able to point out where I have gone wrong. I have run many Google searches but all of the discussion online is far too advanced for me to follow. I'm sorry to write such a huge amount of text but if you open the link to the step-by-step instructions the narrative should be very easy to follow.</p>\n\n<ul>\n<li><p>As per Step 4 in the Engine Yard step-by-step instructions, I entered 'rails s' and then attempted to open 'localhost:3000' in my browser, but the browser couldn't connect to the server. When I followed the instructions the first time I was able to connect, although when I again tried to connect later in the process (during my first run-through) I couldn't. I tried with both Firefox and Chrome. Is not being able to connect here a big problem? Can I ignore it?</p></li>\n<li><p>During Step 5 I am asked to 'restart my Command Line Prompt'. Does that mean, to enter 'rails s'?</p></li>\n<li><p>In step 8 I am asked to 'edit the welcome index.html which can be found under app/views/welcome/index.html.erb'. However, there is no file path 'app/views/welcome/index.html.erb'. There are 'home/index.html.erb' and posts/index.html.erb, and of those two it is the 'home' path that contains a welcome message, and therefore I assume that it is the correct one to edit? Anyway, I edited it and proceeded. I'm asked to attempt to connect to 'localhost:3000' at this stage, but again the browser wouldn't connect.</p></li>\n<li><p>In the same Step 8 I'm asked to 'remove the file at /public/index.html by right clicking on it in Sublime Text'. Firstly, I use Notepad++ and would prefer not to switch, so perhaps somebody could explain how to carry out this action using Notepad++? Am I just to delete that entire file, or simple clear its contents perhaps? Also, there are several 'public' folders in the rails files that I downloaded, but none of them have an 'index' folder within. </p></li>\n<li><p>As per Step 9, I set up a GitHub account and created a repository there. Now, I enter 'git init' as per the instructions and am returned:</p></li>\n</ul>\n\n<p>'chcp' is not recognised as an internal or external conmmand, operable program or batch file.\nInitialised empty Git repository in C:/Sites/railsinstaller_demo/.git/\n'chcp' is not recognised as an internal or external conmmand, operable program or batch file.</p>\n\n<p>Is the above an error message?</p>\n\n<ul>\n<li>I then enter 'git add .' as per the instructions in Step 9 and am returned:</li>\n</ul>\n\n<p>'chcp' is not recognised as an internal or external conmmand, operable program or batch file.\n'chcp' is not recognised as an internal or external conmmand, operable program or batch file.</p>\n\n<p>Is the above an error?</p>\n\n<ul>\n<li><p>I then enter 'git commit -m \"first commit\"' and to my untrained eyes what I'm returned looks legit.</p></li>\n<li><p>I then enter 'git remote add origin git@github.com:accountname/railsinstaller_demo.git' and am returned:</p></li>\n</ul>\n\n<p>'chcp' is not recognised as an internal or external conmmand, operable program or batch file.\n'chcp' is not recognised as an internal or external conmmand, operable program or batch file.</p>\n\n<p>Error?</p>\n\n<ul>\n<li>I next enter 'publickey' and am returned:</li>\n</ul>\n\n<p>public ssh key has been copied to your clipboard</p>\n\n<p>However, when I got to my GitHub account to enter the key it is not there on my clipboard. Why could that be? I assume this will be a big problem in the future and will prevent me from using GitHub? The Ruby on Rails Tutorial book necessitates that I use GitHub while learning.</p>\n\n<ul>\n<li>Finally, I enter 'git push origin master' and am returned:</li>\n</ul>\n\n<p>'chcp' is not recognised as an internal or external conmmand, operable program or batch file.\nPermission denied (publickey)\nfatal:The remote end hung up unexpectedly\n'chcp' is not recognised as an internal or external conmmand, operable program or batch file.</p>\n\n<p>I assume that the above is an error message and is due to the ssh key problem that I mentioned? </p>\n"},{"tags":["jquery","ruby-on-rails","jquery-ui"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13144595,"title":"After order a HTML with JQuery UI Drag and Drop, save ordered table to DB using Rails","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7282973/rearrangeable-ordered-list-with-ruby-on-rails\">Rearrangeable ordered list with Ruby on Rails</a>  </p>\n</blockquote>\n\n\n\n<p>I'm doing a form with fields like name, email, phone, address, city, state, etc.</p>\n\n<p>Each field had a table in db (<strong>postgresql</strong> or <strong>sqlite</strong>).</p>\n\n<p>I will use <em>state</em> field as an example:</p>\n\n<p>In db I had table states with columns: position, name and acronym</p>\n\n<p>In my View I had a HTML table with name and acronym, ordered by position (when page loads). I can order my table using select box (order by name or acronym) or using drag and drop.</p>\n\n<p>How could I save my \"new table\" to db when i click <em>Save</em> button?</p>\n\n<p>I'm using <strong>Rails 3.2.8</strong>, <strong>SQLite 3.7.14</strong> for testing and <strong>PostgreSQL 9.1.5</strong> for development</p>\n\n<p>Tks!</p>\n"},{"tags":["ruby-on-rails","console","rails-console"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13144372,"title":"undefined method `y` for main: Object in rails console","body":"<p>I always used the 'y' method to get my results cleaned up a bit in my rails console. However it doesn't seem to work anymore.</p>\n\n<p>I have results to be found, and I can view the result, but just not in a clean manner. This is my rails console:</p>\n\n<pre><code>Loading development environment (Rails 3.2.6)\n1.9.3-p286 :001 &gt; y Trip.all\n  Trip Load (0.1ms)  SELECT \"trips\".* FROM \"trips\" \nNoMethodError: undefined method `y' for main:Object\n    from (irb):1\n    from /home/timen/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.6/lib/rails/commands/console.rb:47:in `start'\n    from /home/timen/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.6/lib/rails/commands/console.rb:8:in `start'\n    from /home/timen/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.6/lib/rails/commands.rb:41:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n1.9.3-p286 :002 &gt;\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","httprequest","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13139886,"title":"How to retrieve flashvars of a GET request content?","body":"<p>I want to add custom button to rails_admin new/edit page of specific model.</p>\n\n<p>This button should parse the content of a get request to a custom URL.</p>\n\n<p>The current problem I found using JQuery approach like this:</p>\n\n<pre><code>$('#your_button_id').click(function () {\n  $.get('your_url', function(data) {\n    //$('.result').html(data); - sample\n    //Do whatever you want\n    alert('Load was performed.');\n  });\n});\n</code></pre>\n\n<p>Is that it don't load the flashvars attribute.</p>\n\n<p>I was wondering if there is any other alternative to retrieve the whole content with the flashvars included.</p>\n"},{"tags":["mysql","ruby-on-rails","activerecord","rails-migrations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":137,"score":1,"question_id":11644804,"title":"Rails creating schema_migrations - Mysql2::Error: Specified key was too long","body":"<p>I am using Rails 3.2.6 and Mysql 6.0.9 (but I have exactly the same error on MySQL 5.2.25)</p>\n\n<p>When I create new database (<code>rake db:create</code>) and then when I try to load the schema (<code>rake schema:load</code>) I get this error:</p>\n\n<pre><code>Mysql2::Error: Specified key was too long; max key length is 767 bytes: CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`)\n</code></pre>\n\n<p>After hours and hours of research I found these solutions:</p>\n\n<h2>1. Change MySQL variable innodb_large_prefix to true (or ON)</h2>\n\n<p>This didn't work. I tried it on my Linux server, my Mac and even on Windows - it just doesn't work.</p>\n\n<h2>2. Monkeypatch ActiveRecord::SchemaMigration.create_table</h2>\n\n<p>I do not need the <code>version</code> column to be 255 long (when it is UTF-8, then it takes 4*255 = 1020 bytes and exceeds the MySQL limit of 767 byte for keys). I do not need it to be UTF-8 either, but all other tables in the DB are UTF-8 and I have set utf8_czech_ci to be the default collation.</p>\n\n<p>The method that actually creates the schema_migrations table looks like this:</p>\n\n<pre><code>def self.create_table\n  unless connection.table_exists?(table_name)\n    connection.create_table(table_name, :id =&gt; false) do |t|\n      t.column :version, :string, :null =&gt; false\n    end\n    connection.add_index table_name, :version, :unique =&gt; true, :name =&gt; index_name\n  end\nend\n</code></pre>\n\n<p>You can read the whole file on <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/schema_migration.rb\" rel=\"nofollow\">Github rails/rails</a></p>\n\n<p>So I tried to add <code>:limit =&gt; 100</code> to the <code>t.column</code> statement, but I did not succeed with this solution either. The problem is that I cannot make this patch load when the originial is already in place. In other words - my patch loads <em>before</em> ActiveRecord::SchemaMigration so it is overwritten.</p>\n\n<p>When I put this in <code>config/initializers/patches/schema_migration.rb</code>:</p>\n\n<pre><code>require 'active_record/scoping/default'\nrequire 'active_record/scoping/named'\nrequire 'active_record/base'\n\nmodule ActiveRecord\n  class SchemaMigration &lt; ActiveRecord::Base\n    def self.create_table\n      unless connection.table_exists?(table_name)\n        connection.create_table(table_name, :id =&gt; false) do |t|\n          t.column :version, :string, :null =&gt; false, :limit =&gt; 100\n        end\n        connection.add_index table_name, :version, :unique =&gt; true, :name =&gt; index_name\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>It is successfully loaded, but the it is overwritten when the original ActiveRecord::SchemaMigration is loaded.</p>\n\n<p>I tried to mess up with ActiveSupport.on_load(:active_record) but that doesn't seem to work either.</p>\n\n<p><strong>Is there a way to load this file after the originial ActiveRecord::SchemaMigration is in place and make this patch work?</strong></p>\n\n<p>Do you have any suggestions? I can clarify any part of this question, if it makes no sense to you. Just ask me. I've been stuck with this for too long.</p>\n"},{"tags":["ruby-on-rails","apache","ssl"],"answer_count":6,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":10432,"score":7,"question_id":28599,"title":"How do I support SSL Client Certificate authentication?","body":"<p>I want to do what myopenid does -- once you've logged, you can click a button that generates you an SSL certificate; the browser then downloads this certificate and stores it.  When you later go back to yourid.myopenid.com, your browser can use its stored certificate for authentication so you don't ever need a password.</p>\n\n<p>So my questions is what is required to get this working?  How do I generate certificates?  How do I validate them once they're presented back to me?</p>\n\n<p>My stack is Rails on Apache using Passenger, but I'm not too particular.</p>\n"},{"tags":["ruby-on-rails","ruby","redis","resque"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":239,"score":7,"question_id":13059549,"title":"How to lock Resque jobs to one server","body":"<p>I have a \"cluster\" of Resque servers in my infrastructure. They all have the same exact job priorities etc. I automagically scale the number of Resque servers up and down based on how many pending jobs there are and available resources on the servers to handle said jobs. I always have a minimum of two Resque servers up. </p>\n\n<p>My issue is that when I do a quick, one off job, sometimes both the servers process that job. This is bad.</p>\n\n<p>I've tried adding a lock to my job with something like the following:</p>\n\n<pre><code>require 'resque-lock-timeout'\n\nclass ExampleJob\n  extend Resque::Plugins::LockTimeout\n\n  def self.perform\n   # some code\n  end\nend\n</code></pre>\n\n<p>This plugin works for longer running jobs. However for these super tiny one off jobs, processing happens right away. The Resque servers both do not see the lock set by its sister server, both set a lock, process the job, unlock, and are done.</p>\n\n<p>I'm not entirely sure what to do at this point or what solutions there are except for having one dedicated server handle this type of job. That would be a serious pain to configure and scale. I really want both the servers to be able to handle it, but once one of them grabs it from the queue, ensure the other does not run it.</p>\n\n<p>Can anyone suggest some viable solution(s)?</p>\n"},{"tags":["ruby-on-rails","activerecord","data-modeling","relationship","has-many-through"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":742,"score":5,"question_id":7031129,"title":"Saving join attributes through a has_many :through with :conditions","body":"<p>I have an Artist model that looks like this:</p>\n\n<pre><code># app/models/artist.rb\nclass Artist &lt; ActiveRecord::Base\n  # Relationships\n  has_many  :releases\n  has_many  :songs, :through =&gt; :releases\n  has_many  :featured_songs,  :through =&gt; :releases,\n                              :class_name =&gt; \"Song\",\n                              :source =&gt; :song,\n                              :conditions =&gt; { 'releases.featured', true }                         \n\nend\n</code></pre>\n\n<p>Retrieving the featured_songs works perfectly.  The issue here is I'm unable to add a new featured_song to an artist because for some reason the 'featured' attribute is set to 'nil'.</p>\n\n<p>This is what I'm attempting:</p>\n\n<pre><code>ruby-1.9.2-p180 :004 &gt; a = Artist.first\nruby-1.9.2-p180 :005 &gt; a.featured_songs.create(:title =&gt; \"Title\", :user =&gt; User.first)\n</code></pre>\n\n<p>The actual result of that is:</p>\n\n<pre><code>ruby-1.9.2-p180 :004 &gt; a = Artist.first\nruby-1.9.2-p180 :005 &gt; a.featured_songs.create(:title =&gt; \"Title\", :user =&gt; User.first)\n  User Load (0.9ms)  SELECT `users`.* FROM `users` LIMIT 1\n  SQL (1.0ms)  BEGIN\n  SQL (5.5ms)  INSERT INTO `songs` (`created_at`, `title`, `updated_at`, `user_id`) VALUES (?, ?, ?, ?)  [[\"created_at\", Thu, 11 Aug 2011 18:30:34 UTC +00:00], [\"title\", \"Title\"], [\"updated_at\", Thu, 11 Aug 2011 18:30:34 UTC +00:00], [\"user_id\", 1]]\n  SQL (1.2ms)  INSERT INTO `releases` (`album_id`, `artist_id`, `created_at`, `featured`, `song_id`, `updated_at`) VALUES (?, ?, ?, ?, ?, ?)  [[\"album_id\", nil], [\"artist_id\", 1], [\"created_at\", Thu, 11 Aug 2011 18:30:34 UTC +00:00], [\"featured\", nil], [\"song_id\", 6], [\"updated_at\", Thu, 11 Aug 2011 18:30:34 UTC +00:00]]\n   (0.1ms)  COMMIT\n</code></pre>\n\n<p>Notice the:  <code>[\"featured\", nil]</code></p>\n\n<p>Any idea what i'm doing wrong?  How can i properly set attributes on my join without accessing it directly?</p>\n\n<p>thank you!</p>\n\n<p>EDIT: \nTo make my issue more clear:</p>\n\n<ul>\n<li><p>From an instance of artist i am unable to create new featured songs through the <code>featured_songs</code> relationship</p></li>\n<li><p>Saves appear to be setting all of the song attributes EXCEPT for (the most important one) <code>featured</code></p></li>\n<li><p>The <code>featured</code> attribute is being set to <code>nil</code> for some reason and this is the real issue here.</p></li>\n</ul>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13143931,"title":"Devise: Ability to pass parameters to the registrations#sign_up action","body":"<p>Once in a while we send customized registration links to our leads. The link contains parameters than can be used to pre-fill the registration form.</p>\n\n<pre><code>http://www.example.com/users/sign_up?user[company_name]=Foo&amp;user[region]=NA\n</code></pre>\n\n<p>Our registration form has fields for accepting company name and region. Which can be pre-filled based on the registration link.</p>\n\n<p>This should work in practice, but it doesn't due to how the <code>registrations#new</code> action is implemented. The <a href=\"https://github.com/plataformatec/devise/blob/master/app/controllers/devise/registrations_controller.rb#L6\" rel=\"nofollow\">new</a> action calls the  <code>build_resource</code> method with an empty hash.</p>\n\n<pre><code>def new\n  resource = build_resource({})\n  respond_with resource\nend\n</code></pre>\n\n<p>The <a href=\"https://github.com/plataformatec/devise/blob/master/app/controllers/devise/registrations_controller.rb#L85\" rel=\"nofollow\">build_resource</a> method ignores the <code>resource_params</code> when the input is non nil.</p>\n\n<pre><code>def build_resource(hash=nil)\n  hash ||= resource_params || {}\n  self.resource = resource_class.new_with_session(hash, session)\nend  \n</code></pre>\n\n<p>I had to over-ride the the <code>new</code> action in my registrations controller to overcome this issue. I don't like my solution as it is brittle.</p>\n\n<pre><code>def new\n  resource = build_resource\n  respond_with resource\nend\n</code></pre>\n\n<p>Is there a reason why the <code>new</code> action is invoked with an empty hash? Can it be invoked with out empty hash(like in the <code>create</code> action)?</p>\n"},{"tags":["ruby-on-rails","apache2","passenger"],"answer_count":5,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":5486,"score":3,"question_id":1082166,"title":"Exception Errno::EPIPE in Passenger RequestHandler (Broken pipe)","body":"<p>Upgraded to Rails 2.3.2 and Passenger 2.2.4 on Ubuntu hardy slice at\nslicehost with Apache2</p>\n\n<p>I'm getting this same above discussed error in my Apache error.log of\nsystem /var/logs/apache2/</p>\n\n<pre>\n[ pid=4249 file=ext/apache2/Hooks.cpp:638 time=2009-07-04\n11:47:32.752 ]:\n  No data received from the backend application (process 4383) within\n45000 msec. Either the backend application is frozen, or your TimeOut\nvalue of 45 seconds is too low. Please check whether your application\nis frozen, or increase the value of the TimeOut configuration\ndirective.\n*** Exception Errno::EPIPE in Passenger RequestHandler (Broken pipe)\n(process 4391):\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/rack/request_handler.rb:93:in `write'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/rack/request_handler.rb:93:in `process_request'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_request_handler.rb:206:in `main_loop'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/railz/application_spawner.rb:376:in\n`start_request_handler'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/railz/application_spawner.rb:334:in\n`handle_spawn_application'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/utils.rb:182:in `safe_fork'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/railz/application_spawner.rb:332:in\n`handle_spawn_application'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server.rb:351:in `__send__'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server.rb:351:in `main_loop'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server.rb:195:in `start_synchronously'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server.rb:162:in `start'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/railz/application_spawner.rb:213:in `start'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/spawn_manager.rb:261:in `spawn_rails_application'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server_collection.rb:126:in `lookup_or_add'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/spawn_manager.rb:255:in `spawn_rails_application'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server_collection.rb:80:in `synchronize'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server_collection.rb:79:in `synchronize'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/spawn_manager.rb:254:in `spawn_rails_application'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/spawn_manager.rb:153:in `spawn_application'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/spawn_manager.rb:286:in `handle_spawn_application'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server.rb:351:in `__send__'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server.rb:351:in `main_loop'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/lib/\nphusion_passenger/abstract_server.rb:195:in `start_synchronously'\n        from /usr/lib/ruby/gems/1.8/gems/passenger-2.2.4/bin/passenger-spawn-\nserver:61\n*** Exception Errno::EPIPE in Passenger RequestHandler (Broken pipe)\n(process 4383):\n</pre>\n\n<p>and these too.</p>\n\n<pre>\npid=4362 file=ext/apache2/Hooks.cpp:638 time=2009-07-04\n11:55:19.251 ]:\n  No data received from the backend application (process 4383) within\n45000 msec. Either the backend application is frozen, or your TimeOut\nvalue of 45 seconds is too low. Please check whether your application\nis frozen, or increase the value of the TimeOut configuration\ndirective.\n[ pid=4298 file=ext/apache2/Hooks.cpp:638 time=2009-07-04\n11:55:19.255 ]:\n  No data received from the backend application (process 4252) within\n45000 msec. Either the backend application is frozen, or your TimeOut\nvalue of 45 seconds is too low. Please check whether your application\nis frozen, or increase the value of the TimeOut configuration\ndirective.\n[Sat Jul 04 11:55:19 2009] [error] [client 86.96.226.13] Premature end\nof script headers: 41, referer: http://domain.com/\n[ pid=4373 file=ext/apache2/Hooks.cpp:638 time=2009-07-04\n11:55:19.559 ]:\n</pre>\n\n<p>Its getting me mad and on the browser, sometimes its show and when\nrefreshed, Application Error 500 shows up in frequent basis.\nany directions?? </p>\n"},{"tags":["ruby-on-rails","actionview","actionviewhelper"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13140386,"title":"Rails form view with a send button","body":"<p>I have a form generated by scaffold in my _form.html.erb</p>\n\n<pre><code>&lt;%= form_for @survey do |f| %&gt;\n\n  &lt;%= f.label :name %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.submit \"Send\", class: \"btn btn-red span3\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>my submit input produces:</p>\n\n<pre><code>&lt;input class=\"btn btn-red span3\" name=\"commit\" type=\"submit\" value=\"Send\"&gt;\n</code></pre>\n\n<p>I want to produce a button instead a input. Like this:</p>\n\n<pre><code>&lt;button class=\"btn btn-red span3\" name=\"commit\" type=\"submit\"&gt;Send&lt;/button&gt;\n</code></pre>\n\n<p>Any tip?</p>\n"},{"tags":["ruby-on-rails","admin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":24,"score":-2,"question_id":13143069,"title":"Rails create admin controller and view in other directory and with own style","body":"<p>I need to do own administration logic, with it's controllers, view etc... ActiveAdmin and so over are not good for me. But how can i do this in other directory (for example controllers/admin/). How to write then <code>rails g</code> command? (view must be in folder admin too). Also how to connect twitter bootstrap only for admin controllers?</p>\n"},{"tags":["ruby-on-rails","nginx","passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13143611,"title":"Catching REMOTE_USER in passenger standalone application","body":"<p>I have nginx + passenger running 2 applications in rails 3.2</p>\n\n<p>I'm running passenger standalone with other application in rails 2.3</p>\n\n<p>How can i pass REMOTE_USER value from nginx to the aplication running passenger standalone?</p>\n\n<pre><code> nginx.conf\n ...\n server {\n  listen 80;\n  server_name app_location;\n  root app_location/public;\n  passenger_set_cgi_param REMOTE_USER $remote_user;\n\n  location / {\n     proxy_pass http://127.0.0.1:8084;\n     proxy_set_header Host $host;\n  }\n }\n ...\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13143395,"title":"How do I remove a set of cached items in Rails without knowing the exact key?","body":"<p>I have the following issue:</p>\n\n<p>I have an index controller for Products, and the index controller can have a endless combination of query strings, ie.</p>\n\n<pre><code>/products?category=5&amp;color=6\n</code></pre>\n\n<p>Now, it's easy enough to store all of these by using the params as key:</p>\n\n<pre><code>caches_action :index, :cache_path =&gt; Proc.new { |c| c.params }\n</code></pre>\n\n<p>The problem comes in when you need to clear all of the index caches when a product gets added, removed or changed. As far as I know, you need to know the key to expire the cached object. You can't do something like the following in the sweeper:</p>\n\n<pre><code>def after_update(product)\n   expire_action(product, :all)\nend\n</code></pre>\n\n<p>I've looked into cache tagging a bit, but cannot get the Gems I looked at the do what I need, or actually get them to work at all. Them gems I looked at are <a href=\"https://github.com/twinturbo/cashier\" rel=\"nofollow\">Cashier</a> and <a href=\"https://github.com/take-five/rails-cache-tags\" rel=\"nofollow\">Rails-Cache-Tags</a>. I tried doing the following with Cashier:</p>\n\n<pre><code>caches_action :index, :cache_path =&gt; Proc.new { |c| c.params }, :tag =&gt; \"products\"\n</code></pre>\n\n<p>and in the sweeper file use:</p>\n\n<pre><code>Cashier.expire \"products\"\n</code></pre>\n\n<p>but when trying anything with Cashier it gives the following error:</p>\n\n<pre><code>uninitialized class variable @@adapter in Cashier\n</code></pre>\n\n<p>Using rails-cache-tags I've tried doing the following:</p>\n\n<pre><code>caches_action :index, :cache_path =&gt; Proc.new { |c| c.params }, :tags =&gt; %w(products)\n</code></pre>\n\n<p>and then using the following in the sweeper file:</p>\n\n<pre><code>cache.delete_tag \"products\"\n</code></pre>\n\n<p>But that didn't work - it didn't clear the cache. What is the correct way of doing what I'm trying to do?</p>\n"},{"tags":["ruby-on-rails","activerecord","relationship","rails-models"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":8611338,"title":"Model has_many AND has_many :through in one?","body":"<p>I have a set of categories, belonging to a category set.\nThese categories can themselves have a mix of categories (self-referential) and also questions. \nThe models and their relationships are defined &amp; visualized as follows:</p>\n\n<pre><code>class CategorySet &lt; ActiveRecord::Base\n  has_many :categories\nend\n\nclass Category &lt; ActiveRecord::Base\n  belongs_to :category_set\n\n  belongs_to :parent_category, :class_name =&gt; \"Category\"\n  has_many :categories, :class_name =&gt; \"Category\", :foreign_key =&gt; \"parent_category_id\", dependent: :destroy\n\n  has_many :questions, dependent: :destroy\nend\n\nclass Question &lt; ActiveRecord::Base\n  belongs_to :category\nend\n\nAbbrev to CS, C and Q:\n\nCS\n  |- C\n     |- Q\n     |\n     |- C\n     |\n     |- C\n     |  |- Q\n     |\n     |- C\n        |- Q\n        |- Q\n</code></pre>\n\n<p>I would like to be able to ask CategorySet.find(1).questions and return all questions in the tree regardless of position. The only ways I can think of use lots of function-based requests and will probably be overkill on sql statements (see below for an example).</p>\n\n<p>Calling <strong>CategorySet.find(1).categories</strong> finds only the direct descendant categories of the category set. Also, <strong>Category.find(id).questions</strong> returns only the questions for that category.</p>\n\n<p>I have tried overwriting the <em>.questions</em> method on categories, but that doesn't seem very rails relationship-esque and there must be a better way of doing this? Alo it means I can't do the CategorySet.includes(:questions).all style syntax which greatly reduces the load on the database server</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":188,"score":1,"question_id":11460667,"title":"Rails - Changing association doesn't mark object as dirty","body":"<p><strong>Edit</strong>: Clarifications added</p>\n\n<p>Given the following two classes</p>\n\n<pre><code>class Foo &lt; ActiveRecord::Base\n  belongs_to :bar\nend\n\nclass Bar &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>When I change a bar on a foo, I would like a way to see that the foo instance has changed:</p>\n\n<pre><code>foo = Foo.find(x)\nfoo.bar      # returns #&lt;Bar id:1&gt;\nfoo.bar = Bar.new\nfoo.changed? # returns false\nfoo.changes  # returns an empty hash\n</code></pre>\n\n<p>I don't want to set bar_id as dirty (because it hasn't changed)  It would be nice to have the following:</p>\n\n<pre><code>foo.changed? # returns true\nfoo.changes  # returns {:bar =&gt; [#&lt;Bar id: 1&gt;, nil]}\n</code></pre>\n\n<p>Is there a clever way to hack this into Rails?  Is there a reason this is not part of Rails?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","osx"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12468459,"title":"I want to change my OS X ruby version to 1.9 without using RVM","body":"<p>yeah, you heard me right! I want to nix RVM for the time being and just run off of a system-level installation of Ruby 1.9.3</p>\n\n<p>In other words, I want to just upgrade the old 1.8.7 version of ruby that came with my Mountain Lion installation to 1.9.3.</p>\n\n<p>How would i do this?</p>\n"},{"tags":["ruby-on-rails","arrays","object","param"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13142884,"title":"Get first row from rails param","body":"<p>I've got an object/param that I'm saving into my database. But while I do that I'd like to get the first row in that object to do some Javascript things with. So what I'm receiving in my view from the Javascript object(Which is being send by an AJAX request) if i do this: </p>\n\n<pre><code>&lt;% @markers.each do |marker| %&gt;\n  &lt;%= marker%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Is this record:</p>\n\n<pre><code>[\"triplocations_attributes\", {\"0\"=&gt;{\"latlng\"=&gt;\"53.20192541983673, 5.535024029052693\", \"title\"=&gt;\"first\", \"description\"=&gt;\"first\"}, \"1\"=&gt;{\"latlng\"=&gt;\"53.18896756239149, 5.536568981445271\", \"title\"=&gt;\"2nd\", \"description\"=&gt;\"2nd\"}}]\n</code></pre>\n\n<p>Now, what I would like is to get the latlng from the first(0) row. Can anyone tell me how?</p>\n\n<p>What I've tried so far didn't work:</p>\n\n<pre><code>&lt;%= marker.triplocations_attributes %&gt;\n&lt;%= marker[0].title %&gt;\n&lt;%= marker.title %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13139739,"title":"Keeping rake jobs:work running","body":"<p>I'm using delayed_job to run jobs, with new jobs being added every minute by a cronjob.</p>\n\n<p>Currently I have an issue where the rake jobs:work task, currently started with 'nohup rake jobs:work &amp;' manually, is randomly exiting.</p>\n\n<p>While God seems to be a solution to some people, the extra memory overhead is rather annoying and I'd prefer a simpler solution that can be restarted by the deployment script (Capistrano).</p>\n\n<p>Is there some bash/Ruby magic to make this happen, or am I destined to run a monitoring service on my server with some horrid hacks to allow the unprivelaged account the site deploys to the ability to restart it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13142980,"title":"How to group radio button in form created by simple_form?","body":"<p>My Answer model have 2 column, <code>content</code> is text and <code>correct</code> is boolean. My form to create answer here:  </p>\n\n<pre><code>&lt;legend&gt;Answer&lt;/legend&gt;\n&lt;%= question_form.simple_fields_for :answers do |answer_form| %&gt;\n\n  &lt;%= answer_form.input :content, input_html: { rows: 1, class: 'span6' } %&gt;\n  &lt;%= answer_form.input :correct, as: :radio_buttons %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Form is rendered like this:  </p>\n\n<p><img src=\"http://s8.postimage.org/yabhzkr79/answer_fields.png\" alt=\"answer form\"></p>\n\n<p>But i want, with one text content, will have only one radio, to set that content is correct. It means with above image, i would like radio buttons don't have <code>No</code> choice, and only one in two radio buttons is checked, like if content 'True' have radio button checked, content 'False' will have radio button is not checked. How can i do that with simple form?</p>\n"},{"tags":["ruby-on-rails","heroku","upload","http-error"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":453,"score":1,"question_id":11534894,"title":"How to Upload Large Files on Heroku (Particularly Videos)","body":"<p>I'm using heroku to host a web application with the primary focus of hosting videos. The videos are hosted through vimeo pro, and I'm using the <a href=\"https://github.com/matthooks/vimeo\" rel=\"nofollow\">vimeo gem by matthooks</a> to help handle the upload process. <strong>Upload works for small files, but not for larger ones</strong> (~50mb, for example).</p>\n\n<p>A look at heroku logs shows that I am getting http error 413, which stands for \"Request Entity Too Large.\" I believe this might have to do with a limit that heroku places on file uploads (greater than 30mb, <a href=\"http://stackoverflow.com/questions/8032232/enforce-file-upload-size-on-heroku\">according to this webpage</a>). The problem though is that any information I can find on the subject seems to be outdated and conflicting (like this page that <a href=\"https://groups.google.com/forum/?fromgroups#!topic/heroku/6zdLfFfjHfs\" rel=\"nofollow\">claims there is no size limit</a>). I also couldn't find anything on heroku's site about this.</p>\n\n<p>I've searched google and found a few somewhat relevant pages (<a href=\"https://groups.google.com/forum/?fromgroups#!topic/carrierwave/QpAQMUAo9NY\" rel=\"nofollow\">one</a> and <a href=\"http://comments.gmane.org/gmane.comp.lang.ruby.rails.heroku/3517\" rel=\"nofollow\">two</a>), but no solutions that worked for me. Most of the pages I found deal with uploading large files to amazon s3, which is different from what I'm trying to do.</p>\n\n<p>Here's the relevant output of the logs: </p>\n\n<pre><code>2012-07-18T05:13:31+00:00 heroku[nginx]: 152.3.68.6 - - [18/Jul/2012:05:13:31 +0000]\n  \"POST /videos HTTP/1.1\" 413 192 \"http://neoteach.com/components/19\" \"Mozilla/5.0 \n  (Macintosh; Intel Mac OS X 10.7; rv:13.0) Gecko/20100101 Firefox/13.0.1\" neoteach.com\n</code></pre>\n\n<p><strong>There are no other errors in the logs.</strong> This is the only output that appears when I try to upload a video that is too large. Which means that this is not a timeout error or a problem with exceeding the allotted memory per dyno.</p>\n\n<p>Does heroku really place a limit on upload sizes? If so, is there any way to change this limit? Note that the files themselves are not being stored on heroku's servers at all, they are merely being passed on to vimeo's servers.</p>\n\n<p>If the problem is not limit on upload sizes, does anyone have an idea of what else might be going wrong?</p>\n\n<p>Much thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13142785,"title":"Form for adding children using ancestry gem","body":"<p>I have a user model in Rails and I am trying to use the Ancestry gem to add children to users. I would like to be able to enter one/several user ids (children) into a form and then assign them to be children to a user. I currently have a form for updating the name of the user in a view, but being new to Rails I am struggling to figure out the form should look like for making @user parent of user_ids (the children) entered a form. How can one do this?</p>\n\n<p>edit.html.erb</p>\n\n<pre><code>…\n&lt;%= form_for @user do |f| %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.submit \"Update\", class: \"btn\" %&gt;            \n&lt;% end %&gt;\n…\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","erb"],"answer_count":2,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":131,"score":16,"question_id":13142326,"title":"What does <%== %> do in rails erb?","body":"<p>I saw this recently, thought it was interesting.  But I don't really understand what it does?</p>\n\n<p>Ex.  I have a rails app and I want to bootstrap some json, so that I don't have to make a second request.  Normally I would write something like this.</p>\n\n<p><code>&lt;%= raw @model.to_json %&gt;</code>\nor\n<code>&lt;%= @model.to_json.html_safe %&gt;</code></p>\n\n<p>I have to send the message <code>raw</code> or <code>html_safe</code> or the json will be html escaped and thus not parsed correctly.  However, this seems to work too.</p>\n\n<p><code>&lt;%== @model.to_json %&gt;</code></p>\n\n<p>But I can't find any documentation.</p>\n\n<p>Does anyone know what this does exactly?  i.e.  Is it the exact same as calling <code>html_safe</code> or <code>raw</code>?  Or is there more to it?</p>\n"},{"tags":["ruby-on-rails","ruby","beanstalkd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13142448,"title":"Beanstalkd server not running its jobs","body":"<p>I'm trying to start beanstalk server, and made 1 job to test it, but instead i got nothing.\nHere is my code:</p>\n\n<pre><code>require 'stalker'\ninclude Stalker\n\n\njob 'test.job' do\n  somefile = File.new(\"somefile\")\n\nend\n</code></pre>\n\n<p>Im using stalker gem to connect ruby and beanstalkd. Any ideas what am i doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13140509,"title":"How can I open a link(button) in a separate tab?","body":"<p>I have a button that opens a link in a same window, but I need to open it in a separate tab by doing some scripting. I am working in Ruby and here is my code:  </p>\n\n<pre><code>Given /^User clicks on the New User Link$/ do\n    page.driver.browser.switch_to.window (page.driver.browser.window_handles.last)\n    find(:xpath, \"//*[@id='slideshow']/div[1]/div/a/img, \").click\nend\n</code></pre>\n\n<p>This code won't work for me. Please let me know if you see anything wrong in this code. </p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13142183,"title":"Selecting Areas for Sales Reps","body":"<p>I have an application that is for sales reps. \nI'm trying to pull different institutions information based on 2 things</p>\n\n<ol>\n<li>If they are a client</li>\n<li>If they are in the state that the user (sales rep) is over.</li>\n</ol>\n\n<p>So I want to show all the institutions that are clients in the current_user (sales reps) area. How can I do that? </p>\n\n<p>Since I haven't done this before and I'm newer to rails I'm not sure how to do this.</p>\n\n<p>Here are my models (I've shortened the code):</p>\n\n<p><strong>User(Sales Rep)</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :states, :through =&gt; :rep_areas\n  has_many :institutions, :through =&gt; :company_reps\n  has_many :rep_areas\n  has_many :company_reps\nend\n</code></pre>\n\n<p><strong>States</strong></p>\n\n<pre><code>class State &lt; ActiveRecord::Base\n  has_many :users, :through =&gt; :rep_areas\n  has_many :rep_areas\n  has_many :institutions\n\n  attr_accessible :code, :name\nend\n</code></pre>\n\n<p><strong>Institutions</strong></p>\n\n<pre><code>class Institution &lt; ActiveRecord::Base\n  attr_accessible :company, :phone, :clientdate, :street, :city, :state_id, :zip, :source, :source2, :demodate1, :demodate2, :demodate3, :client, :prospect, :notcontacted\n  belongs_to :state\n  has_many :users, :through =&gt; :company_reps\n  has_many :company_reps\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","session","cookies"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":795,"score":1,"question_id":2594676,"title":"Rails session cookie not getting set","body":"<p>I have a rails app that is a CMS that uses dynamic subdomains for each site.  For some reason when I deployed to production the session cookie is not getting set.  I'm thinking this is leading to the \"Invalid Authenticity Token\" errors that are being thrown everywhere.  </p>\n\n<p>I have my production.rb setup so that I can share sessions across subdomains.  What could be going wrong that the cookie isn't being set at all?</p>\n\n<pre><code>#production.rb\nconfig.action_controller.session[:domain] = '.domain.com'\n\n\n#environment.rb\nconfig.action_controller.session = {\n   :session_key =&gt; '_app_session',\n   :secret      =&gt; '.... nums and chars .....'\n }\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13139269,"title":"Rails - Find model under specific category","body":"<p>I have a <code>Business</code> model that :belongs_to <code>Category</code></p>\n\n<p>A sample hierarchy for categories:</p>\n\n<ul>\n<li>root\n<ul>\n<li>Restaurants\n<ul>\n<li>Sushi</li>\n<li>Pizza</li>\n<li>Chinese</li>\n<li>French</li>\n<li>Italian</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>I am using <code>acts_as_tree</code> for <code>Category</code> hierarchy.</p>\n\n<p>How can I find all <code>Businesses</code> under the Restaurants category?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13112959,"title":"NoMethodError undefined method 'merge' when running RSpec integration test","body":"<p>I am following <b>Micheal Hartl's Ruby on rails tutorial 2.3 Edition</b> and I have followed the steps for the integration tests correctly. in <b>/sample_app/spec/integration</b> I have a file named <b>layout_links_spec.rb</b> which looks like this.</p>\n\n<pre><code>require 'spec_helper'\ndescribe \"Layout links\" do\n it \"should have a Home page at '/'\" do\n  get '/'\n   response.should render_template('pages/home')\n  end\n end\n</code></pre>\n\n<p>When i do </p>\n\n<pre><code>$ spec spec/\n</code></pre>\n\n<p>I am getting the following error</p>\n\n<pre><code>1)\nNoMethodError in 'Layout links should have a Home page at '/''\nundefined method `merge' for nil:NilClass\n /home/rails_projects/sample_app/spec/integration/layout_links_spec.rb:4:\n\nFinished in 0.060225 seconds\n\n1 example, 1 failure\n</code></pre>\n\n<p>Please help me with this error</p>\n"},{"tags":["ruby-on-rails","devise","actionmailer"],"answer_count":3,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":2062,"score":1,"question_id":5933969,"title":"Getting Devise 1.3.4 to send emails with Gmail in development","body":"<p>I'm trying to setup devise 1.3.4 to send emails via gmail while in development mode. I should mention that I'm using Rails 3.0.4 and Ruby 1.9.2p136.</p>\n\n<p>I've tried the following in config/environments/development.rb:</p>\n\n<pre><code>config.action_mailer.raise_delivery_errors = true\nconfig.action_mailer.perform_deliveries = true\n\nconfig.action_mailer.default_url_options = { :host =&gt; 'mydomain.com' }\n\nActionMailer::Base.smtp_settings = {  \n  :address              =&gt; \"smtp.gmail.com\",  \n  :port                 =&gt; 587,  \n  :domain               =&gt; \"mydomain.com\",  \n  :user_name            =&gt; \"info\",  \n  :password             =&gt; \"secret\",  \n  :authentication       =&gt; \"plain\",  \n  :enable_starttls_auto =&gt; true  \n}  \n</code></pre>\n\n<p>And in config/initializers/devise.rb I changed</p>\n\n<pre><code> config.mailer_sender = \"please-change-me-at-config-initializers-devise@example.com\"\n</code></pre>\n\n<p>To</p>\n\n<pre><code> config.mailer_sender = \"info@mydomain.com\"\n</code></pre>\n\n<p>Then I tried</p>\n\n<p><a href=\"http://yekmer.posterous.com/devise-gmail-smtp-configuration\" rel=\"nofollow\">http://yekmer.posterous.com/devise-gmail-smtp-configuration</a></p>\n\n<p>It's still not working.</p>\n\n<p>Is there a wiki page on how to get the mailer working? I see the email in my log and it looks great! The links work, etc ... I just want to see them in my email account.</p>\n\n<hr>\n\n<p>Edit</p>\n\n<p>I found the answer -\nI used <a href=\"http://yekmer.posterous.com/devise-gmail-smtp-configuration\" rel=\"nofollow\">http://yekmer.posterous.com/devise-gmail-smtp-configuration</a> - I had been putting that code in config/intializers/devise.rb when I should have been putting it in config/environments/development.rb.</p>\n"},{"tags":["ruby-on-rails","authentication","authlogic"],"answer_count":3,"favorite_count":1,"up_vote_count":11,"down_vote_count":0,"view_count":3052,"score":11,"question_id":1918506,"title":"Using custom authlogic error messages","body":"<p>I am using the authlogic gem for user validation on one of my sites. All is going well, but I am wondering if it's possible to change the error message that gets returned when the user types in an invalid email address.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","activerecord","migration"],"answer_count":2,"favorite_count":22,"up_vote_count":85,"down_vote_count":0,"view_count":20087,"score":85,"question_id":471416,"title":"How do you write a migration to rename an ActiveRecord model and its table in Rails?","body":"<p>I'm terrible at naming and realize that there are a better set of names for my models in my Rails app.  Is there a way to use a migration to rename a model and its table?</p>\n"},{"tags":["javascript","ruby-on-rails","coffeescript","spine.js"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13140026,"title":"Inter-Controller Communication in Spine.js","body":"<p>Is it possible to have two controllers within the same Spine.js: Apartments and Map. Is there a way to call get the Map do do something when an Apartment is selected?</p>\n\n<pre><code># Apartments\nclass Show extends Spine.Controller\n  events:\n    'click [data-type=edit]': 'edit'\n    'click [data-type=back]': 'back'\n\n  constructor: -&gt;\n    super\n    @active (params) -&gt;\n      @change(params.id)\n\n  change: (id) -&gt;\n    @item = Apartment.find(id)\n    @render()\n\n  render: -&gt;\n    @html @view('apartments/show')(@item)\n    # also update the map here.\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13121602,"title":"Correct rails place for no-db data fetching code","body":"<p>I'm looking for the \"rails\" design pattern for code that fetches data from other websites.</p>\n\n<p>I have a rails controller in my app that fetches data not from the database, but from external API's or scraped from the web.</p>\n\n<p>Where's the \"rails\" place to put this code.</p>\n\n<p>For quick implementation, I just stuck it in a model, but the model doesn't interact with the database - or support standard model functionality - so that feels wrong, but my understanding of rails and ruby isn't yet solid enough to know where it should go.</p>\n\n<p>The way the code works roughly is\ncontroller calls model.fetchData args\nthe model uses HTTParty or similar to make the call\nprocesses data\npasses it back to the controller</p>\n\n<p>Any advice?</p>\n"},{"tags":["ruby-on-rails","rest","resources","uri"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13141513,"title":"Designing a restful URI for ternary relationships","body":"<p>I'm working on a Rails project which is going to expose a set of resources through URIs. The problem I have is as follows:</p>\n\n<p>Consider these models, Student, Note, and Lesson. Each Lesson can have many notes which is posted by Students. In Active Record's literature:</p>\n\n<pre><code>class Lesson &lt; ActiveRecord::Base\n  has_many :notes\nend\n\nclass Student &lt; ActiveRecord::Base\n  has_many :notes\nend\n\nclass Note &lt; ActiveRecord::Base\n  belongs_to :lesson\n  belongs_to :user\nend\n</code></pre>\n\n<p>Now I want to know the URI design and resource design to support following scenario:</p>\n\n<blockquote>\n  <p>retrieve list of all notes which is posted by student with id 5 on\n  lesson with id 4.</p>\n</blockquote>\n\n<p>Please note that if I define resources in routes.rb like this:</p>\n\n<pre><code>resources :lessons do\n  resources :notes\nend\n\nresources :students do\n  resources :notes\nend\n</code></pre>\n\n<p>then I can access notes through \"/lessons/4/notes/\" and \"/students/5/notes\" but what about the query I explained earlier?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","migration"],"answer_count":4,"favorite_count":8,"up_vote_count":47,"down_vote_count":0,"view_count":34131,"score":47,"question_id":2799774,"title":"Rails migration for change column","body":"<p>We have <code>script/generate migration add_fieldname_to_tablename fieldname:datatype</code> syntax for adding new columns to a model.</p>\n\n<p>On the same line, do we have a script/generate for changing the datatype of a column? Or should I write sql directly into my vanilla migration?</p>\n\n<p>I want to change a column from datetime to date.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13137826,"title":"How to add a method for active record?","body":"<p>I would want to use my method getScheduleFixed() on a Active Record Istance</p>\n\n<pre><code>ps = ProgramSchedule.all\nps.getScheduleFixed\n</code></pre>\n\n<p>the important fact is how to access to \"ps\" array (active record) on my method declaration</p>\n\n<pre><code>class ProgramSchedule &lt; ActiveRecord::Base\n\n  def getScheduleFixed\n\n    array = (HERE ARRAY RETURNED BY ACTIVE RECORD)\n\n    # some stuff...\n\n    return array\n\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","deployment","twitter-bootstrap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13141477,"title":"Rails 3 Production Bootstrap Asset Problems","body":"<p>I have deployed my site which uses Twitter Bootstrap heavily and am having a problem with the difference between local and production, If you have a look at the images below you will see that not only the background from the navbar has gone but also that the padding on some of the other elements has also gone screwy.</p>\n\n<p>Additionally you can see that the Icons also have a black shadow on them.</p>\n\n<p><img src=\"http://i.stack.imgur.com/x9Ws1.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/MgwLv.png\" alt=\"enter image description here\"></p>\n\n<p>My production.rb is as follows:-</p>\n\n<pre><code>    Build::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Disable Rails's static asset server (Apache or nginx will already do this)\n  config.serve_static_assets = false\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  # config.force_ssl = true\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Use a different cache store in production\n  # config.cache_store = :mem_cache_store\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  # config.assets.precompile += %w( search.js )\n\n  # Disable delivery errors, bad email addresses will be ignored\n  # config.action_mailer.raise_delivery_errors = false\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\nend\n</code></pre>\n\n<p>I have also run the following from ssh to try and fix it:-</p>\n\n<pre><code>RAILS_ENV=production rake assets:precompile\n</code></pre>\n\n<p>Any help would be appreciated as I am pulling my hair out here.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","auto-increment","infinite-scroll"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13124364,"title":"Endless / Infinite Scroll Counter Column","body":"<p>I currently have a working table that is sorted by several select boxes. I recently implemented endless/infinite scrolling by following this tutorial: <a href=\"http://railscasts.com/episodes/114-endless-page-revised?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/114-endless-page-revised?view=asciicast</a></p>\n\n<p>The tutorial worked after a couple of changes, but I have one problem. I am using a counter for the first column, but the problem is that every time it loads the next page, the counter resets to 1. I am currently displaying 50 records at the start and 50 more each time the user scrolls down to the bottom. I would like the next records to be 51...52...53...etc. Then the next time you scroll to the bottom, start at 101 then 102...103...104...etc.</p>\n\n<p>To get the partial I followed this tutorial which also told me how to make the counter column:\n<a href=\"http://xianese.blogspot.com/2008/06/render-collection.html\" rel=\"nofollow\">http://xianese.blogspot.com/2008/06/render-collection.html</a></p>\n\n<p>Here is my code:</p>\n\n<p><strong>articles.js.coffee</strong></p>\n\n<pre><code>jQuery -&gt;\n   if $('.pagination').length\n      $('#articles_table').scroll -&gt;\n              url = $('.pagination .next_page').attr('href')          \n              if url &amp;&amp;  $('#articles_table')[0].scrollHeight -    \n              $('#articles_table').scrollTop() &lt; 700                  \n                      $('.pagination').text('Fetching more users...')\n                      $.getScript(url)\n$('#articles_table').scroll()\n</code></pre>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;table class=\"table table-striped table-bordered span8 table-condensed\"     \n id=\"articles_table\" &gt;\n&lt;thead class=\"header\"&gt;\n  &lt;tr&gt;\n      &lt;th&gt;ID&lt;/th&gt;\n      &lt;th&gt;Title&lt;/th&gt;\n      &lt;th&gt;Description&lt;/th&gt;\n      &lt;th&gt;Created_At&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;%= render @articles %&gt;\n\n&lt;/tbody&gt;\n</code></pre>\n\n<p><strong>index.js.erb</strong></p>\n\n<pre><code>$('#articles_table').append('&lt;%= j render(@articles) %&gt;');\n&lt;% if @articles.next_page %&gt;\n$('.pagination').replaceWith('&lt;%= j will_paginate(@articles) %&gt;');\n&lt;% else %&gt;\n$('.pagination').remove();\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>_article.html.erb</strong></p>\n\n<pre><code>&lt;tr&gt;\n      &lt;td&gt; &lt;%= article_counter +1 %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Title %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Description %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Created_At %&gt; &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13141011,"title":"Add default value to an already created column","body":"<p>I am building an Rails 3.2.6 app and I need to add a default value to a column on an already created table called tasks. How can I do this with a migration?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","loops","partial"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13032946,"title":"rails ruby iterate through partials in directory","body":"<p>To those helping.. Thanks.  Still no solution but getting closer.  The errors i think are because my \"file\" evaluates to \"app/views/main/show/_partial.html.erb\".  and render adds it's own relative path.  So I guess i need to list the file names.. maybe a dir.foreach or dir.glob type command.. i'll keep digging.  THANKS!</p>\n\n<p>I have a directory full of partials I would like to call in a page.  So I wrote a loop but it yields errors. </p>\n\n<pre><code>&lt;% Dir[\"app/views/main/show/*\"].each do |file| %&gt;\n  &lt;%= render #{file} %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I replace the render line with a simple <p>file</p> it lists the file names so i know the loop and Dir location work.  The problem I THINK is that render is looking for a string.  So I've tried all sorts of things from searching google and here like the #{file}, creating a variable first, raw,...etc.</p>\n\n<p>also I think render may be looking in a different directory relative the Dir.  I'll try out some stuff there to.  </p>\n\n<p>How should I be handling this?  I'm up for switching from Dir to Dir.foreach or any other strategy that makes sense.</p>\n\n<p>Thanks.</p>\n\n<p><strong>EDIT</strong>: Here's the solution I've implemented (directory path changed from above):</p>\n\n<pre><code>&lt;% Dir[\"app/views/partials/show/*.html.erb\"].each do |file| %&gt;\n&lt;p&gt; &lt;%= render 'partials/show/' + File.basename(file,'.html.erb').slice!(1..-1) %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","rest","activeresource"],"answer_count":1,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":477,"score":9,"question_id":10791549,"title":"Is ActiveResource fundamentally flawed?","body":"<p>Several developers from different teams have independently told me that ActiveResource was a flawed idea. The most common criticism I hear is that it was a mistake to design it to have an ActiveRecord-like interface. I also hear complaints about the way errors are handled - or swallowed. One developer actually created his own gem to provide the same functionality as ActiveResource (a framework for models based on RESTful resources).</p>\n\n<p>I am new to ActiveResource, but when I look at the code and experiment and see how it works, I struggle to see where the resistance is coming from. It seems to based in clean, solid concepts. I've even heard it's too heavy! But in my examination, I find it light and fast.</p>\n\n<p>So with all this controversy about ActiveResource, I turned to the Web for answers. Surely, there must be stacks of blog posts about why ActiveResource should be canned in favor of X. After all, I can sure find posts about whether DataMapper is superior to ActiveRecord. So I've searched and I've searched and ... nothing. Not a single thing. I can't find a single page on the Internet making any criticism of ActiveResource (aside from blanket criticism of REST). I can't even find a proposed alternative. It has the support of the Rails core team and it seems to be the de facto standard in the community.</p>\n\n<p><strong>Bottom line:</strong></p>\n\n<p>Is there a controversy about ActiveResource? And if so, what is the nature of the debate? Are there alternatives?</p>\n"},{"tags":["ruby-on-rails","ruby","testing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13140883,"title":"How to run a test suite inside the Rails environment","body":"<p>I'm working the <a href=\"https://rubygems.org/gems/finance\" rel=\"nofollow\">Finance</a> gem, and I am having an issue where some of the code fails when run inside Ruby on Rails.</p>\n\n<p>I would like to test for this by running the existing test suite inside the Rails environment, however, I'm not sure how to go about this.  I'm looking for something to the effect of</p>\n\n<pre><code>run_all_tests\ninside_rails do\n  run_all_tests_again\nend\n</code></pre>\n\n<p>inside my <code>Rakefile</code>, or wherever is most appropriate.</p>\n\n<p>I haven't been able to find much on Google; any assistance would be much appreciated!</p>\n"},{"tags":["ruby-on-rails","permissions","assets","tmp"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13140567,"title":"Permissions on /tmp/cache/assets on RAIL app","body":"<p>I have a permissions problem.\nUsing wickedpdf on my rails app to print, it produces tmp assets files into the dir <code>/tmp/cache/assets</code>.\nThe files that it writes, like this one <code>sprockets%2F2c9f9e326ac1c7cd3f07a1a3c9051874</code> have <code>owner=\"nobody\"</code> and <code>permissions=\"rw--------\"</code> so the asset wickedpdf gives an error while printing.</p>\n\n<p>It's possible to correct this with a simple <code>chmod -R 777 /tmp</code> but i can't do this everytime the asset produces a new subdirectory into <code>/tmp</code> with no permissions.\nIt's possible to set tmp dir and its subdirectories and files with all permissions for ever, also for new files that my assets will produce in future?</p>\n"},{"tags":["ruby-on-rails","ruby","api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12262458,"title":"How to get all factual monetize deals wit ruby driver","body":"<p>I tried to get all deals for a city in the US from the Factual monetize API by the help of the ruby driver </p>\n\n<pre><code>query = factual.monetize.filters(\"place_locality\" =&gt; \"San Francisco\") \n</code></pre>\n\n<p>Is there a limit of 20 results? How is it possible to get more deals? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","views","content-for"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13140596,"title":"How to skip the content_for tag content for some pages in rails?","body":"<p>I have a layout in which i'm using the content_for tag to render some partials(for sidebar). But on several pages I don't need this sidebar. So the question is: How can I tell rails not to render anything for some pages?</p>\n\n<p>I've tried to do it the following way without any result:</p>\n\n<pre><code>&lt;% content_for :sidebar do %&gt;\n  &lt;%= render nothing: true %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Just got an error</p>\n\n<pre><code>You invoked render but did not give any of :partial, :template, :inline, :file or :text option.\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":28,"score":5,"question_id":13137036,"title":"rails ActiveRecord::Observer in plugin","body":"<p>I want to add an Observer for Issues to an existing rails application.</p>\n\n<p>I created a plugin, and under plugin's <code>app/model</code> i saved the <code>custom_observer.rb</code></p>\n\n<p>It works when I add <code>:custom_observer</code> to <code>config.active_record.observers</code> in <code>config/application.rb</code></p>\n\n<p>I tried something like </p>\n\n<pre><code>RedmineApp::Application.configure do\n    config.after_initialize do\n             config.active_record.observers &lt;&lt; :custom_observer\n    end\nend\n</code></pre>\n\n<p>in the plugin's init.rb but that doesn't work.</p>\n\n<p>What is a better way to do that?\nthanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave","formtastic"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13139597,"title":"Rails 3 file upload with Carrierwave and Formtastic","body":"<p>I have a Product with many Photos. The relationship is this way:</p>\n\n<p>product.rb</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  has_many :photos, :dependent =&gt; :destroy\n  attr_accessible :translations_attributes, :active, :category_id, :photos\n  accepts_nested_attributes_for :translations, :photos\n</code></pre>\n\n<p>photo.rb</p>\n\n<pre><code>class Photo &lt; ActiveRecord::Base\n  attr_accessible :photo, :product_id\n  belongs_to :attachable\n  mount_uploader :photo, PhotoUploader\n</code></pre>\n\n<p>and the form looks like this:</p>\n\n<pre><code>form(:html =&gt; { :multipart =&gt; true }) do |f|\nf.inputs \"Details\" do\n  f.input :active\n  f.input :category, :include_blank =&gt; false\nend\n\nf.inputs \"Photos\" do\n    f.input :photos, :as =&gt; :file\nend\n\nf.buttons\n</code></pre>\n\n<p>end</p>\n\n<p>The problem is that I get this error when creating/updating the product with a file attached:</p>\n\n<pre><code>undefined method `each' for #&lt;ActionDispatch::Http::UploadedFile:0x007f93c8549828&gt;\n</code></pre>\n\n<p>I found a question with the same error <a href=\"http://stackoverflow.com/questions/10955501/rails-3-polymorphic-association-with-carrierwave-and-simple-form\">here</a>, but even trying their solution still have the same problem.</p>\n\n<p>I'm using Friendly_Id, ActiveAdmin, Globalize3, maybe it could have some relationship with them, this is my first project with Rails and right now I don't know what could be...</p>\n"},{"tags":["javascript","ruby-on-rails","google-maps","gmaps4rails","sidebar"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13140521,"title":"Gmaps4rails sidebar disappears when dynamically updating map","body":"<p>I'm using a slider to dynamically update the Gmaps4rails google map, however whenever I move the slider and the markers get updated by the replaceMarkers function the sidebar disappears and the only way I can get a list of markers to load again is by refreshing the page.  Does anyone know any way to fix this issue?</p>\n"},{"tags":["ruby-on-rails","query","activerecord","count","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":633,"score":1,"question_id":4465591,"title":"ActiveRecord Grouping/Count Query Help Needed","body":"<p>I am using Rails 3.</p>\n\n<p>Suppose I have the following archetypical models:  Blog, Post, Comment, Category.  Blog has_many posts, Post has_many comments and belongs_to category.</p>\n\n<p>I want to know how many posts are in each category but only counting those that have comments.</p>\n\n<p>If I do the following:</p>\n\n<pre><code>blog.posts.group(\"category_id\").count\n</code></pre>\n\n<p>--This gives me an OrderedHash which is close to what I need but of course the problem is the count values include posts that have no comments.</p>\n\n<p>If I do:</p>\n\n<pre><code>blog.posts.group(\"category_id\").joins(\"comments\").count\n</code></pre>\n\n<p>--this gives me the number of comments that are in posts of that category (it does the same thing if I put the join before the grouping).</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["html","css","ruby-on-rails","background-image","img"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13138593,"title":"Loading CSS background images before normal images?","body":"<p>I have a ruby on rails web app, and in some views i have many heavy images( <code>&lt;img&gt;</code> ) to render .The <code>&lt;img&gt;</code> are generated in a Helper.</p>\n\n<p>The problem is that the css is loaded first, then the js, then the heavy images , and then finally the css refereneced background images.</p>\n\n<p>It takes quite a while for all of the heavy images to load, which therefore holds the whole site up. </p>\n\n<p>I want to load first the css background images then load the other images, as they obviously hold visual structure of the page.</p>\n\n<p>rails version: 2.3.8</p>\n\n<p>EDIT: \nThank you guys, I apologize for not having shared the code earlier.</p>\n\n<p>I have two models : Categories and Images, each Category has many images.\nIn the view i have a list of categories, which is generated by a helper :</p>\n\n<p><pre> \ncategories.each do |cat|\n    html &lt;&lt; <code>\"&lt;a href='##{cat.id}' class='mapcat' &gt;#{cat.libelle}&lt;/a&gt;\"</code>\nend\n</pre></p>\n\n<p>and when I click on the category the images are displayed</p>\n\n<p><pre>\n categories_images.each do |i|\n    html &lt;&lt; <code>\"&lt;div id='#{i.id}' class='#{css}'&gt;&lt;img src='/images_moi/categories/#{cat.libelle}/#{i.path_file_name}' /&gt;\"</code>\n  end\n</pre>  </p>\n\n<p>I have css background image associated to the list of category\nThe problem is that the images (<code>&lt;img&gt;</code>) is displayed before the css background images of the list of categories.</p>\n"},{"tags":["ruby-on-rails","google-maps","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13140289,"title":"gmap4 rails clustering options","body":"<p>Can anyone please help me out in using these options of gmap4Rails</p>\n\n<pre><code>      opt_anchor, opt_textColor, opt_textSize\n</code></pre>\n\n<p>tried to use it but it didnot worked</p>\n\n<blockquote>\n  <p></p>\n\n<pre><code>    Gmaps.map.customClusterer = function() {\n      var url = \"http://path/X\";\n      return [{\n        opt_anchor: [4, 0],\n        opt_textColor: '#ff00ff',\n        opt_textSize: 10,\n        url: url + '12.png',\n        height: 12,\n        width: 12,\n       },\n       {\n         url: url + '16.png', \n         height: 16,\n         width: 16,\n       },\n       {\n         url: url + '24.png',\n         height: 24,\n         width: 24,\n       }];\n     }\n\n  &lt;/script&gt;\n</code></pre>\n</blockquote>\n\n<p>basically i don't want to show the text coming while clustering. If anyone has an idea kindly help</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","ruby","helpers","activeadmin"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1116,"score":3,"question_id":8673112,"title":"Rails 3. How to add a helper that ActiveAdmin will use?","body":"<p>I'm creating a helper to be used by Formtastic but I get the <code>undefined local variable or method</code> error. I don't know where to put it so it can work.</p>\n\n<p>I already tried in the application_helper.rb and in app/helpers/active_admin/view_helpers.rb</p>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13140260,"title":"A file called -e in my Rails app root directory","body":"<p>Right in my root path (where the <code>Gemfile</code> is) I have a file called <code>-e</code> which is empty. I wonder if this is something created by Rails or plugin? Or just a file I created by accident?</p>\n\n<p><code>Gemfile:</code></p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\ngem 'bootstrap-sass', '2.0.4'\ngem 'bcrypt-ruby', '3.0.1'\ngem 'faker', '1.0.1'\ngem 'will_paginate', '3.0.3'\ngem 'bootstrap-will_paginate', '0.0.6'\n\ngroup :development, :test do\n  gem 'sqlite3', '1.3.5'\n  gem 'rspec-rails', '2.11.0'\nend\n\ngem 'annotate', '2.5.0', group: :development\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '3.2.5'\n  gem 'coffee-rails', '3.2.2'\n  gem 'uglifier', '1.2.3'\nend\n\ngem 'jquery-rails', '2.0.2'\n\ngroup :test do\n  gem 'capybara', '1.1.2'\n  gem 'factory_girl_rails', '4.1.0'\nend\n\ngroup :production do\n  gem 'pg', '0.12.2'\nend\n</code></pre>\n\n<p>(I hope is not the later, or I will feel very stupid).</p>\n"},{"tags":["ruby-on-rails","devise","functional-testing","fixtures"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":2090,"score":4,"question_id":4577737,"title":"Functional testing with Rails and Devise. What to put in my fixtures?","body":"<p>Hi I'm wanting to do some functional testing of my Rails 3 app that uses Devise and CanCan.</p>\n\n<p>In my User model I have the users age, I want to test that a user can only visit a certain page if they are:</p>\n\n<ol>\n<li>Logged in</li>\n<li>Over 35</li>\n</ol>\n\n<p>I have seen in the Devise document that I can use: *sign_in* and I have put it in my tests and it appears to work - the test doesn't error because I have:</p>\n\n<pre><code>include Devise::TestHelpers\n</code></pre>\n\n<p>in my *test_helper.rb*</p>\n\n<p>When I take it out my test does error because *sign_in* is not defined. So it is not a helper problem.</p>\n\n<p>When I run the test and check to see if <em>span#loggedin</em> has one occurrence the test fails because there is 0 occurrences. <em>span#loggedin</em> only appears *if user_signed_in?*</p>\n\n<p>What do I need to put in my fixtures or tests to create a test user who is also a fully signed up user (confirmed etc)?</p>\n\n<p>View Code:</p>\n\n<pre><code>&lt;% if user_signed_in? %&gt;\n     &lt;span id=\"loggedin\"&gt;User is signed in&lt;/span&gt;\n     User age is &lt;span id=\"age\"&gt;&lt;%= current_user.age.to_s %&gt;&lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Test Code:</p>\n\n<pre><code>test \"should get index\" do\n    sign_in :one\n    get :index\n    assert_response :success\n    assert_select 'span#loggedin', :count =&gt; 1\nend\n</code></pre>\n\n<p>Fixture:</p>\n\n<pre><code>one:\n email: jez@example.com\n age: 36\n</code></pre>\n\n<p>It works okay in development when I manually login but I'm hoping to automate it all - the point of testing really!!</p>\n"},{"tags":["ruby-on-rails","elasticsearch","tire"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13138752,"title":"Exclude indexed data in search results - elasticsearch (tire)","body":"<p>I'm trying to use elasticsearch via tire gem for a multi-tenant app. The app has many accounts with each account having many users.</p>\n\n<p>Now I would like to index the User based on account id.</p>\n\n<p>User Model:</p>\n\n<pre><code>  include Tire::Model::Search\n  mapping do\n    indexes :name, :boost =&gt; 10\n    indexes :account_id\n    indexes :company_name\n    indexes :description\n  end\n\n  def to_indexed_json\n    to_json( :only =&gt; [:name, :account_id, :description, :company_name], \n           )\n  end\n</code></pre>\n\n<p>Search Query:</p>\n\n<pre><code>  User.tire.search do\n    query do\n      filtered do\n        query { string 'vamsikrishna' }\n        filter :term, :account_id =&gt; 1\n      end\n    end\n  end\n</code></pre>\n\n<p>The filter works fine and the results are displayed only for the filtered account id (1). But, when I search for a query string 1:</p>\n\n<pre><code>  User.tire.search do\n    query do\n      filtered do\n        query { string '1' }\n        filter :term, :account_id =&gt; 1\n      end\n    end\n  end\n</code></pre>\n\n<p>Lets say there is an user named 1. In that case, the results are getting displayed for all the users with account id 1 and the user too. This is because I added account_id in the to_indexed_json. Now, how can I display only the user with name 1? (All users <strong>should not</strong> be available in the hits. Only the user with name 1 should be displayed)</p>\n\n<p><strong>When there are no users with 1 as name or company name or description, I just don't want any results to be displayed. But, in my case as I explained I would get all the users in the account id 1.</strong></p>\n"},{"tags":["ruby-on-rails","ruby","regex"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13139157,"title":"regular expression for numerated table of content","body":"<p>I have template like this:</p>\n\n<pre><code>&lt;h1&gt;asd&lt;/h1&gt;\n...\n&lt;h1&gt;asd&lt;/h1&gt;\n...\n    &lt;h2&gt;asd&lt;/h2&gt;\n    ...\n    &lt;h2&gt;asd&lt;/h2&gt;\n    ...\n</code></pre>\n\n<p>How to convert it to</p>\n\n<pre><code>&lt;h1&gt;1. asd&lt;/h1&gt;\n...\n&lt;h1&gt;2. asd&lt;/h1&gt;\n...\n    &lt;h2&gt;2.1. asd&lt;/h2&gt;\n    ...\n    &lt;h2&gt;2.2. asd&lt;/h2&gt;\n    ...\n</code></pre>\n\n<p>with regular expressions in ruby 1.8.7 ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.2","tzinfo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":12393580,"title":"An error occurred while installing tzinfo (0.3.33), and Bundler cannot continue","body":"<p>Hello i am running bundle install and receiving the following error message. I am using the rails installer kit @ <a href=\"http://railsinstaller.org/\" rel=\"nofollow\">http://railsinstaller.org/</a></p>\n\n<p>Errno::EINVAL: Invalid argument - C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.\n1/cache/tzinfo-0.3.33.gem\nAn error occurred while installing tzinfo (0.3.33), and Bundler cannot continue.</p>\n\n<p>Make sure that <code>gem install tzinfo -v '0.3.33'</code> succeeds before bundling.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing","rspec","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13129583,"title":"Rspec testing instance variables with user creation","body":"<p>I'm testing to make sure that a created user is assigned to my instance variable <code>@user</code>. I understand what get means, but I'm not sure what to write for the test. I'm returning with an argument error for a bad URI or URL. What's wrong with my test and how do I fix it?</p>\n\n<pre><code>it \"checks @user variable assignment for creation\" do\n\n    p = FactoryGirl.create(:user)\n    get :users\n    # I'm confused on what this line above means/does. What does the hash :users refer \n    #to\n    assigns[:user].should == [p]\n\nend\n</code></pre>\n\n<p>The <code>expected URI object or string error</code> refers to <code>get :users</code> and the error is as follows</p>\n\n<pre><code>Failure/Error get :users\nArgumentError:\n  bad argument: (expected URI object or URI string)\n</code></pre>\n"},{"tags":["ruby-on-rails","ssl","rubygems","gem","bundler"],"answer_count":7,"favorite_count":12,"up_vote_count":33,"down_vote_count":0,"view_count":6627,"score":33,"question_id":10246023,"title":"bundle install fails with SSL certificate verification error","body":"<p>When I run <code>bundle install</code> for my Rails 3 project on Centos 5.5 it fails with an error:</p>\n\n<pre><code>Gem::RemoteFetcher::FetchError: SSL_connect returned=1 errno=0 state=SSLv3 \nread server certificate B: certificate verify failed \n(https://bb-m.rubygems.org/gems/multi_json-1.3.2.gem)\nAn error occured while installing multi_json (1.3.2), and Bundler cannot continue.\nMake sure that `gem install multi_json -v '1.3.2'` succeeds before bundling.\n</code></pre>\n\n<p>When I try to install the gem manually (by <code>gem install multi_json -v '1.3.2'</code>) it works. The same problem occurs with several other gems. I use RVM (1.12.3), ruby 1.9.2, bundler 1.1.3. </p>\n\n<p>How to fix it?</p>\n"},{"tags":["ruby-on-rails","gem","openssl","rvm","bundler"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":2187,"score":2,"question_id":10329892,"title":"\"bundle install\" causes Gem::RemoteFetcher::FetchError on each gem","body":"<p>When calling</p>\n\n<pre><code>rails new project\n</code></pre>\n\n<p>The process progresses until I hit bundle install. At that point:</p>\n\n<pre><code>identical  vendor/plugins/.gitkeep\n         run  bundle install\nFetching gem metadata from https://rubygems.org/.........\n\nGem::RemoteFetcher::FetchError: SSL_connect returned=1 errno=0 state=unknown state: sslv3 alert handshake failure (https://d2chzxaqi4y7f8.cloudfront.net/gems/rake-0.9.2.2.gem)\nAn error occured while installing rake (0.9.2.2), and Bundler cannot continue.\nMake sure that `gem install rake -v '0.9.2.2'` succeeds before bundling.\n</code></pre>\n\n<p>I can install the gem manually with gem install and launch rails new again, and the error repeats for the next gem. I end up installing manually every single gem.</p>\n\n<p>I use rvm 1.13.0 single user.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","naming-conventions","rspec2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13128662,"title":"File name convention in rspec file","body":"<p>I noticed in the Ruby on Rails Tutorial by Hartl that he uses rails generate to create the rspec file. For example, </p>\n\n<pre><code>rails generate integration_test static_pages\n</code></pre>\n\n<p>creates the file <code>static_pages_spec.rb</code>. My question is, is there a naming convention for the name of the file? </p>\n\n<p>Also, is there a naming convention for the text between <code>describe</code> and <code>do</code>? I'm aware that writing something like <code>/people/new</code> will set up the render automatically when testing a view so all I need to do is write <code>render</code>, but what other naming conventions exist out there in rspec?</p>\n"},{"tags":["ruby-on-rails","ruby","rake"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13139253,"title":"nohup rake jobs:work exit with Mysql::Error:","body":"<p>I am getting following error.  With this error the rake exit. </p>\n\n<p>rake aborted!</p>\n\n<p>Mysql::Error: MySQL server has gone away: UPDATE <code>delayed_jobs</code> SET locked_by = null, locked_at = null WHERE (locked_by = 'host:domainname.com pid:2923')</p>\n\n<p>How can I keep the rake jobs:work running or to restart it if it exit.  I found a posting <a href=\"http://stackoverflow.com/questions/1128824/keeping-a-rake-job-running\">Keeping a rake job running</a> but the link in the answer is not working.  Can somebody post the solution? </p>\n\n<p>I have multiple rails application on my VPS for which I want to have  rake jobs:work  running.  How can I do that?</p>\n"},{"tags":["ruby-on-rails","shopify"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13138455,"title":"Rails omniauth-shopify-oauth2: \"[API] Invalid API key or access token (unrecognized login or wrong password)\" from console","body":"<p>I set up shopify auth (omniauth-shopify-oauth2 gem) for my rails 3.2.6 app.</p>\n\n<p>It works fine when routed from a web page (to the following controller#action)</p>\n\n<pre><code>class ShopifyController &lt; ApplicationController\n  ...\n  def login\n    redirect_to \"/auth/shopify?shop=#{current_retailer.primary_host_name}\"\n  end\n</code></pre>\n\n<p>It redirects me to shop login and, once I am logged in, redirects back to success callback. All good (see SERVER LOG SUCCESS below).</p>\n\n<p>But when I try to do pretty much the same from the rails console:</p>\n\n<pre><code>irb(main):001:0&gt; RestClient.get 'http://localhost:3000/auth/shopify?shop=vinehillposters.myshopify.com'\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>RestClient::Unauthorized: 401 Unauthorized: &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;hash&gt;\n  &lt;errors&gt;[API] Invalid API key or access token (unrecognized login or wrong password)&lt;/errors&gt;\n&lt;/hash&gt;\n</code></pre>\n\n<p>see SERVER LOG FAIL below</p>\n\n<p><br></p>\n\n<p><strong>SERVER LOG SUCCESS:</strong></p>\n\n<pre><code>Processing by ShopifyController#login as HTML\n... AR stuff snipped ...\nRedirected to http://localhost:3000/auth/shopify?shop=vinehillposters.myshopify.com\nCompleted 302 Found in 93ms (ActiveRecord: 1.6ms)\n(shopify) Setup endpoint detected, running now.\n(shopify) Request phase initiated.\n\"https://vinehillposters.myshopify.com/admin/oauth/authorize?response_type=code&amp;client_id=44dd9799fbc268c36ef609f0c2386b8c&amp;redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fauth%2Fshopify%2Fcallba\nck&amp;scope=read_orders\"\n\nStarted GET \"/auth/shopify?shop=vinehillposters.myshopify.com\" for 127.0.0.1 at 2012-10-30 11:24:21 +0000\n(shopify) Setup endpoint detected, running now.\n(shopify) Callback phase initiated.\n\nStarted GET \"/auth/shopify/callback?code=c8c6696ed347e37324d2d62ec203457b&amp;shop=vinehillposters.myshopify.com&amp;timestamp=1351596261&amp;signature=e6324b041d6a6ed1e07719a8909d70f7\" for 127.0.0.1 at \n2012-10-30 11:24:21 +0000\nProcessing by ShopifyController#auth_callback as HTML\n...\n</code></pre>\n\n<p><br>\n<strong>SERVER LOG FAILURE:</strong></p>\n\n<pre><code>(shopify) Setup endpoint detected, running now.\n(shopify) Request phase initiated.\n\"https://vinehillposters.myshopify.com/admin/oauth/authorize?response_type=code&amp;client_id=44dd9799fbc268c36ef609f0c2386b8c&amp;redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fauth%2Fshopify%2Fcallback&amp;scope=read_orders\"\n\n\nStarted GET \"/auth/shopify?shop=vinehillposters.myshopify.com\" for 127.0.0.1 at 2012-10-30 11:24:54 +0000\n</code></pre>\n\n<p>You may have noticed that I print out the request_phase url right before it gets redirected to shopify (after <code>(shopify) Request phase initiated.</code>). It is the same in both cases. Except in one case it returns success and in another it is 401.</p>\n\n<p>So, what am I doing wrong?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","date"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13138702,"title":"Ruby on rails implode and explode functions to change date format","body":"<p>How do we explode a string on '-' and again implode it on '-' in ruby on rails.My problem is that i want to convert a date in <code>\"MM-DD-YYYY\"</code> format to <code>'YYYY-MM-DD'</code> coming  from a form and save it to mysql database.As MySQL will only accept <code>'YYYY-MM-DD'</code> format.</p>\n"},{"tags":["ruby-on-rails","formtastic"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":401,"score":1,"question_id":10319797,"title":"formtastic select, one entry selected as default","body":"<p>I have an input which I render :as => :select. I would like one option to be selected as default. How would I go about that?</p>\n\n<p>Thanks,\nHendrik</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","relationship"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13138038,"title":"retrive object id from relation in rails3","body":"<p>i have a model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n  has_many :meetings, :dependent =&gt; :destroy do \n    def find_foreign\n      Meeting.where(\"user_id &lt;&gt; ?\", id)\n    end\n  end\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me\n  # attr_accessible :title, :body\n\nend\n</code></pre>\n\n<p>and when i am trying to get user's foreign meetings like that</p>\n\n<pre><code>some_user.meetings.find_foreign\n</code></pre>\n\n<p>i get an error</p>\n\n<pre><code>NoMethodError (undefined method `id' for []:ActiveRecord::Relation):\n</code></pre>\n\n<p>because self in find_foreign is an Array. How to retrive the User.id from this method ?</p>\n"},{"tags":["ruby-on-rails","session","cookies","https"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13138926,"title":"How do I switch to secure cookie for session once user logs in in rails 3.2","body":"<p>Is there a way to use cookies on HTTP, but once user logs limit cookie to HTTPS?</p>\n\n<pre><code>MyApp::Application.config.session_store :cookie_store, :key =&gt; '_myapp_session',\n                                                       :secure =&gt; Rails.env.production?\n</code></pre>\n\n<p>does not help, because it totally limits an app to cookies transmitted on HTTPS.</p>\n\n<p>I guess there should be a way to change session cookie to secure in ApplicationController.</p>\n"},{"tags":["ruby-on-rails","facebook-graph-api","koala"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1029,"score":4,"question_id":7126974,"title":"Facebook Graph API Linebreak","body":"<p>I know there are a slew of questions about this already--but I'd like to add linebreaks to Facebook wall posts that are being posted via the Graph API. I've seen a variety of answers suggesting using <code>&lt;center&gt;&lt;/center&gt;</code>, but that doesn't work for me--it just prints '<code>&lt;center&gt;&lt;/center&gt;</code>' in the post.</p>\n\n<p>To be specific, I'm using Ruby and the Koala gem. I am attempting to post to a user's <em>page</em>. If I post as a link and try the center hack in the description of the post, it works as expected--but not in the message, where I actually need it.</p>\n\n<p>UPDATE: I've submitted a patch to the Koala gem that allows a :no_encoding option to be set. If/when this patch is accepted, it will allow for linebreaks if that options is set to true. For now, folks with this issue can grab my fork of the gem: <a href=\"https://github.com/ideaoforder/koala\" rel=\"nofollow\">https://github.com/ideaoforder/koala</a></p>\n\n<p>For those who are curious, the issue was with Faraday. The request method was set to :url_encode which sends the params as url-encoded form data. The params have to be sent as regular data, not form data (like using the -d flag instead of the -f flag in cURL). We accomplish this by sending data as part of the query string instead of encoded params.</p>\n"},{"tags":["ruby-on-rails","ruby","lambda","closures","proc"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13137304,"title":"How to combine procs to filter a list in ruby?","body":"<p>I am trying to implement a filter-by-criteria approach in a little project of mine. I have a Filter class, in which i have filters for name, year, genre. For example:</p>\n\n<pre><code>Filter.new.name(\"The Shawshank Redemption\")\nFilter.new.year(\"1994\")\nFilter.new.genre(\"drama\")\n</code></pre>\n\n<p>I also have a list of movies, each being an object that has methods name, year and genre. I want to be able to do the following (MoviesContainer is just a class that has a @movies list):</p>\n\n<pre><code>MoviesContainer.filter Filter.new.name(\"The Godfather\") &amp; Filter.new.year(\"1972\") | Filter.year(\"1974\")\n</code></pre>\n\n<p>I can easily overload the |, &amp; and ! operators in my Filter class, but I don't know how to combine the filter object so that they become just one object which I can pass to filter.\nI'm gladly accepting any ideas. :)</p>\n\n<p>My best idea so far is to create a proc for every Filter.new and then combine them in the &amp;,| and ! methods, but I don't know how. I'm thinking something like this could work, however, it doesn't :D</p>\n\n<pre><code>proc { |movie| proc { |movie| movie.name == \"The Godfather\" } &amp;&amp; proc { |movie| movie.year== \"1972\" }\n</code></pre>\n\n<p>and then call this with every of the @movies items.\nCan you please help me with the combining procs thing, or perhaps propose a better solution. Thank you.</p>\n"},{"tags":["ruby-on-rails","ruby","plugins","paperclip"],"answer_count":5,"favorite_count":8,"up_vote_count":16,"down_vote_count":0,"view_count":8827,"score":16,"question_id":296952,"title":"Rails Plugin: Paperclip Question","body":"<p>How can I prevent the image tag that calls the associated image from displaying if no image is associated with the record?</p>\n\n<pre><code>&lt;%= image_tag @agent.avatar.url %&gt;\n</code></pre>\n\n<p>...gives me the text \"Missing\" if there is no image associated with that agent.  I want to test to see there is an image available first, then render the above tag if the test returns true.</p>\n\n<p>Better yet, is there anyway for me to specify a default image if no image is specifically provided?</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","mailer"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":202,"score":3,"question_id":7161219,"title":"How to save mail and send it later","body":"<p>I want to save the mail sent on certain days (eg.sunday) in database and then send them on next day.\nI want to know if it is possible.</p>\n\n<p>And how to save the mail object into database.</p>\n"},{"tags":["ruby-on-rails","ruby","internationalization","rails-i18n"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":46,"score":4,"question_id":13127529,"title":"How to configure Ruby on Rails app to use Buddhist calendar?","body":"<p>In Buddhist Era calendar it's already 2555 year. What is the easiest way to make Date.current show 2555 instead of 2012?</p>\n\n<p>UPDATE</p>\n\n<p>I've found solution for this particular task. It can be easily implemented with just standard rails i18n.</p>\n\n<p>cat config/locales/th.rb</p>\n\n<pre><code>{\n  th: {\n    date: {\n      formats: {\n        default: lambda { |date, _| \"%d.%m.#{date.year + 543}\" }\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>and then just use I18n.l method:</p>\n\n<pre><code>ruby-1.9.3-p194 :032 &gt; I18n.l(Date.current)\n =&gt; \"30.10.2555\"\n</code></pre>\n"}]}
{"total":93231,"page":19,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby"],"answer_count":10,"favorite_count":15,"up_vote_count":31,"down_vote_count":0,"view_count":22024,"score":31,"question_id":453762,"title":"NoMethodError when trying to invoke helper method from Rails controller","body":"<p>I'm getting a <code>NoMethodError</code> when trying to access a method defined in one of my helper modules from one of my controller classes. My Rails application uses the <code>helper</code> class method with the <code>:all</code> symbol as shown below:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  helper :all\n  .\n  .\nend\n</code></pre>\n\n<p>My understanding is that this should make all of my controller classes automatically include all of the helper modules within the app/helpers directory, therefore mixing in all of the methods into the controllers. Is this correct?</p>\n\n<p>If I explicitly <code>include</code> the helper module within the controller then everything works correctly.</p>\n"},{"tags":["ruby-on-rails","debugging","ruby-on-rails-3.2","foreman"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":405,"score":3,"question_id":9558576,"title":"How to debug a rails (3.2) app started by foreman?","body":"<p>I am trying to use foreman to start my rails app. Unfortunately I have difficulties connecting my IDE for debugging. </p>\n\n<p>I read <a href=\"https://github.com/ddollar/foreman/issues/58\" rel=\"nofollow\">here</a> about using</p>\n\n<pre><code>Debugger.wait_connection = true\nDebugger.start_remote\n</code></pre>\n\n<p>to start a remote debugging session, but that does not really work out.</p>\n\n<p><strong>Question:</strong>\nIs there a way to debug a rails (3.2) app started by foreman? If so, what is the approach?</p>\n"},{"tags":["ruby-on-rails","database","facebook","database-design","notifications"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":131,"score":1,"question_id":12596440,"title":"Notifications ala Facebook (database implementation)","body":"<p>I am wondering how Facebook implements their notifications system as I'm looking to do something similar.</p>\n\n<ul>\n<li>FooBar commented on your status</li>\n<li>Red1, Green2 and Blue3  commented on your photo</li>\n<li>MegaMan and 5 others commented on your event</li>\n</ul>\n\n<p>I can't have multiple notifications written into a single record, as eventually I will have actions associated with each notification. Also, in the view I'd like notifications to be rendered as expandable lists when a certain number of them exist for a single subject.</p>\n\n<ul>\n<li>FooBar commented on your status (actions)</li>\n<li>Red1, Green2 and Pink5  commented on your photo [+]</li>\n<li>MegaMan and 3 others commented on your event [-]\n<ul>\n<li>MegaMan commented on your event (actions)</li>\n<li>ProtoMan commented on your event (actions)</li>\n<li>Bass commented on your event (actions)</li>\n<li>DrWilly commented on your event (actions)</li>\n</ul></li>\n</ul>\n\n<p>Cheers!</p>\n\n<p><strong>PS</strong> I am using postgres and rails BTW.</p>\n"},{"tags":["ruby-on-rails","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13138054,"title":"gmap4rails clustering options","body":"<p>Can anyone please tell me a place from where i can read about all the gmap4rails clustering options and how to edit all the default settings . i tried to google but it was of no success</p>\n\n<p>the only link with some what of description is this by apneadiving.\n    <a href=\"https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Markers\" rel=\"nofollow\">https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Markers</a></p>\n\n<p>but still it does'nt have the full details like if i want to disable the text of clustering how to do it and its styling option and all. Please help me</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13116243,"title":"error undefined method `remote_function' (how to make Ajax calls with Rails 3 using remote_function)","body":"<p>I found that this function (remote_function) was part of the Prototype helper which was removed from the framework with Rails 3.1 and how to change on ajax?</p>\n\n<pre><code>      country\n      %select#country{:name =&gt; \"country\", :onchange =&gt; remote_function(:update =&gt; 'region_city', :url =&gt; { :action =&gt; :get_regions_cities_for_country}, :with =&gt; 'Form.Element.serialize(this)')}\n        = options_for_select( Country.find(:all).map {|u| [u.name,u.id]})\n      %div{:id =&gt; \"region_city\"}\n        region\n        %select#region{:name =&gt; \"region\", :onchange =&gt; remote_function(:update =&gt; 'city', :url =&gt; { :action =&gt; :get_cities}, :with =&gt; 'Form.Element.serialize(this)')}\n          = options_for_select(Country.find(:first).regions.find(:all).map {|u| [u.name,u.id]})\n        city\n        #{select_tag(:city, options_for_select( Country.find(:first).regions.find(:first).cities.find(:all).map {|u| [u.name,u.id]} ))}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord","schema"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12879184,"title":"generate activerecord schema from an existing table","body":"<p>Does anyone know of a way to do this?</p>\n\n<p>I have an existing table that I created with sql and I would like to create a schema from it that would reproduce the table (minus the data)</p>\n"},{"tags":["jquery","ruby-on-rails","ajax","unobtrusive-javascript"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":353,"score":0,"question_id":850804,"title":"Update two different parts of the page using unobtrusive JS (in Rails w/jQuery)","body":"<p>When the user clicks a sorting link on my blog, I want to use AJAX to both pull in new posts and update the sorting link section. This would be easy using RJS, but I want to keep my JS unobtrusive and respond to AJAX requests with only data (and no code).</p>\n\n<p>Here's what I'm doing now:</p>\n\n<pre><code>  $('a.order_by').livequery('click', function() {\n    $.get(this.href, null, function(data) {\n      // The server returns a blob of HTML with a div#posts\n      // and a div#sorting\n      $(\"#posts\").partial_html(data, \"#posts\");\n      $(\"#sorting\").partial_html(data, \"#sorting\");\n    });\n    return false;\n  });\n</code></pre>\n\n<p>and here's the <code>partial_html()</code> function:</p>\n\n<pre><code>// Stolen from the jQuery source for $.load()\njQuery.fn.partial_html = function(data, selector) {\n    $(this).html($(\"&lt;div/&gt;\").append(data.replace(/&lt;script(.|\\s)*?\\/script&gt;/g, \"\")).find(selector));\n}\n</code></pre>\n\n<p>Obviously this is a bit disgusting -- what's the right way to do this? (It would be super-easy to use two <code>$.load()</code>'s, but that would require a superfluous HTTP request).</p>\n"},{"tags":["ruby-on-rails","excel","rubygems","spreadsheet"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13137613,"title":"Iterate over all cells from a column Spreadsheet Gem","body":"<p>I need to put a certain string value in all the cells from a column.How can I iterate over all values? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13137590,"title":"nested attributes with fields_for and jquery","body":"<p>I have created a project where in a single page a project along with its task should be created. for this i have used nested attributes,field_for. Iam facing a issue right now. While creating a project team members are first added to the project. While creating task, these added users should be only displayed under task. As Iam using a single view page I am not able to get the selected members for the multiple tasks..</p>\n\n<p>Kindly help me...</p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":135,"score":2,"question_id":3521388,"title":"DRYing up repeating routes for several models","body":"<p>I have some models like News and Downloads which have_many comments :as => :commentable. Comment belongs_to :commentable and is :polymorphic. Like the comments, there are subscriptions. So my routes look like this:</p>\n\n<pre><code>resources :news do\n  resources :comments do\n    post :like, :on =&gt; :member\n    delete :like, :on =&gt; :member\n  end\n  resources :subscriptions\n  ...\nend\n\nresources :downloads do\n  resources :comments do\n    post :like, :on =&gt; :member\n    delete :like, :on =&gt; :member\n  end\n  resources :subscriptions\n  ...\nend\n\n...\n</code></pre>\n\n<p>Is there a way to DRY this up? I tried defining</p>\n\n<pre><code>def comment_resources\n  resources :comments do\n    # ...\n  end\n  resources :subscriptions\nend\n</code></pre>\n\n<p>at then top of routes.rb and then calling comment_resources but it seems dirty to me because it isn't namespaced / in a class correctly.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":773,"score":3,"question_id":9551986,"title":"uninitialized constant AWS::S3::Base","body":"<p>I have this code which is in lib folder. This code works outside of rails, but when it's called from the rails controller I get the uninitialized constant AWS::S3::Base error</p>\n\n<pre><code>require 'rubygems'\nrequire 'aws/s3'\n\nmodule S3Util\n\n  def self.upload_file(local_file)\n    mime_type = \"application/octet-stream\"\n    bucket = \"test\"\n\n    AWS::S3::Base.establish_connection!(\n      :access_key_id     =&gt; '*****',\n      :secret_access_key =&gt; '****'\n    )\n\n    base_name = File.basename(local_file)\n\n    puts \"**** Uploading #{local_file} as '#{base_name}' to '#{bucket}'\"\n\n    AWS::S3::S3Object.store(\n      base_name,\n      File.open(local_file),\n      bucket,\n      :content_type =&gt; mime_type\n    )\n\n    puts \"***** Uploaded!\"\n\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","queue","resque","jobs"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12268008,"title":"How to find and kill a running Resque job on Rails?","body":"<p>I am using <a href=\"https://github.com/defunkt/resque\" rel=\"nofollow\">Resque</a> to process some background jobs on a Rails application.</p>\n\n<p>The thing is that clients can cancel this jobs, so:</p>\n\n<ul>\n<li><p>If the job is still on the queue: dequeue it</p>\n\n<pre><code>Resque.dequeue(GitHub::Jobs::UpdateNetworkGraph, 'repo:135325')\n</code></pre></li>\n<li><p>If the job has finished: do nothing</p></li>\n<li><p>If the job is running: ???</p></li>\n</ul>\n\n<p>Is there a way to programmatically find the job and in case it is running tell it to stop immediatly? My main concern is to be sure that I kill the desired job, not the current one being processed as it could be a different one form the moment I ask if it is running until the moment I kill it.</p>\n"},{"tags":["php","ruby-on-rails","ruby","apache","phusion-passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13090988,"title":"Running Rails applications with Passenger alongside PHP applications","body":"<p>I'm setting a server where I will need to run Ruby On Rails 3 applications along with some PHP websites.\nThe server is a CentOS 5.8 machine running Apache 2.4.3. \nThe server is for testing and PRE-production, so performance is not an issue.</p>\n\n<p>I'm using Phusion Passenger for the Rails apps, and I've created a bunch of virtual-hosts (with associated folders and DB accounts).\nThen, I'm planning to use other v-hosts for PHP.</p>\n\n<p>Is it possible? How should I proceed?</p>\n\n<p>Thank you very much  </p>\n\n<hr>\n\n<p>details:<br>\nhttpd.conf:  </p>\n\n<pre><code>LoadModule passenger_module /app/auser/.rvm/gems/ruby-1.9.3-p286/gems/passenger-3.0.17/ext/apache2/mod_passenger.so  \nPassengerRoot /app/auser/.rvm/gems/ruby-1.9.3-p286/gems/passenger-3.0.17  \nPassengerRuby /app/auser/.rvm/wrappers/ruby-1.9.3-p286/ruby  \n</code></pre>\n\n<p>(...)  </p>\n\n<pre><code>##\n## Virtual hosts\nInclude conf/extra/httpd-vhosts-phpmyadmin.conf\nInclude conf/extra/httpd-vhosts-rails01.conf\nInclude conf/extra/httpd-vhosts-rails02.conf\nInclude conf/extra/httpd-vhosts-php01.conf\nInclude conf/extra/httpd-vhosts-php02.conf\n....\n</code></pre>\n\n<hr>\n\n<p>Passenger-managed v-hosts will be like:<br>\nInclude conf/extra/httpd-vhosts-rails01.conf  </p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n   ServerName rails01.lcl\n   DocumentRoot \"/app/auser/apps/rails01/public\"\n   &lt;Directory \"/app/auser/apps/rails01/public\"&gt;\n      AllowOverride all\n      Options -MultiViews\n   &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>PHP-based v-hosts will be like:\nInclude conf/extra/httpd-vhosts-php01.conf  </p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName php01.lcl\n    DocumentRoot \"/app/auser/apps/php01/public\"\n    &lt;Directory \"/app/auser/apps/php01/public\"&gt;\n        Options FollowSymLinks MultiViews\n        AllowOverride None\n        Order allow,deny\n        Allow from all\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","postgresql"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13135422,"title":"Lots of \"COMMIT;\" in the PostgreSQL log of slow queries","body":"<p>I am trying to optimize the <em>PostgreSQL</em> 9.1 database for a Rails app I am developing. In <em>postgresql.conf</em> I have set</p>\n\n<pre><code>log_min_duration_statement = 200\n</code></pre>\n\n<p>I then use <em>PgBadger</em> to analyze the log file. The statement which, by far, takes up most of the time is:</p>\n\n<pre><code>COMMIT;\n</code></pre>\n\n<p>I get no more information than this and I am very confused as to what statement this is. Does anyone know what I can do to get more detailed information about the COMMIT queries? All other queries show the variables used in the statement, SELECT, UPDATE etc. But not the COMMIT queries. </p>\n"},{"tags":["java","ruby-on-rails","ruby","java-ee"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13127944,"title":"How to make a Ruby program work with a Java program?","body":"<p>This is not a question as such, but more like a list of things I would like to know about how to make a Ruby program work with a Java program. </p>\n\n<p>Here's the thing: We have two teams. One works on Java and implements their code and module in Java. We do the same in Ruby. We are supposed to have a set of common interfaces and use some code of theirs in our Ruby program and they are to use some of our Ruby code in their Java program. </p>\n\n<p>What are some of the things to keep in mind while connecting these two modules to give one common module? I guess this would be more like a guide or a set of guidelines than a straight answer. So please, have some patience and not report or close this question. Thank you!</p>\n\n<p><strong>Update:</strong> </p>\n\n<p>Yes, we are to use RESTful services. I do not want any sort of coding help. All I want is your contribution which you might have from your experience with coding modules in two different languages and interconnecting them with a common interface. </p>\n\n<p>That's pretty much all I would like to know. While this is indeed a class project of mine, I thought it would be better if there were guidelines somewhere so it could help other people as well. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13131340,"title":"Using paginate while fetching results by a SQL query in ruby","body":"<p>I have the following query in my Rails Controller:</p>\n\n<pre><code>SELECT CODE_VER FROM MASTERTEST WHERE DATE&gt;= DATE_SUB(CURDATE(), INTERVAL 90 DAY) ORDER BY DATE DESC;\n</code></pre>\n\n<p>This query returns me results from the last 90 days. I display all these results in a table right now. </p>\n\n<p>I want to show only rows from 7 days at a time in some kind of pagination. I have tried will_paginate and kaminari and also paginate_by_sql. But I haven't been successful using any of them so far.</p>\n\n<p>Can someone show me the exact syntax incase of my query?</p>\n"},{"tags":["javascript","html","ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":77,"score":0,"question_id":13134285,"title":"Javascript didn't run","body":"<p>I created a page to show news and add some javascript, it worked normally. But when\nI add some Vietnamese contents to my page, the javascript didn't work any more. How to fix this?\n Ok, Here is my html</p>\n\n<pre><code>.row\n  .span7.offset2\n    .box-model-news\n      .row  \n        .span3\n          %h5\n            = @news[0].title\n      .row.hot_news\n        - 3.times do |i|\n          .span2\n            - if @news.length &gt; i+1  \n              .fixed-box\n                = image_tag @news[i+1].asset.url(:small)\n              %h6\n                = link_to @news[i+1].title, \"#\"\n  .span3\n    .box-model-news\n      - rest_news = @news[4..@news.length-1]\n      - if rest_news\n        - rest_news.each do |rn|\n          = link_to rn.title,\"#\"\n</code></pre>\n\n<p>And the javascript: </p>\n\n<pre><code>= javascript_tag do\n  :erb\n    alert(\"hi\");\n</code></pre>\n\n<p>@news[0].title : the title contains some Vietnamese words</p>\n\n<p>html code </p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n&lt;div class=\"span7 offset2\"&gt;\n&lt;div class=\"box-model-news\"&gt;\n&lt;div class=\"row\"&gt;\n&lt;div class=\"newest-news\"&gt;\n&lt;div class=\"span3\"&gt;\n&lt;img alt=\"375649_373983335965607_104188519611758_1224852_274911402_n\" src=\"/system/bbook_news/assets/000/000/011/medium/375649_373983335965607_104188519611758_1224852_274911402_n.jpg?1351583899\"&gt;\n&lt;/div&gt;\n&lt;div class=\"span3\"&gt;\n&lt;h5&gt;\n&lt;a href=\"#\"&gt;Vietnamese word: Xin Chào mọi người&lt;/a&gt;\n&lt;/h5&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"row hot_news\"&gt;\n&lt;div class=\"span2\"&gt;\n&lt;div class=\"fixed-box\"&gt;\n&lt;img alt=\"301806_293504937402115_112083275544283_698768_1122549180_n\" src=\"/system/bbook_news/assets/000/000/012/small/301806_293504937402115_112083275544283_698768_1122549180_n.jpg?1351584751\"&gt;\n&lt;/div&gt;\n&lt;h6&gt;\n&lt;a href=\"#\"&gt;Không chạy được &lt;/a&gt;\n&lt;/h6&gt;\n&lt;/div&gt;\n&lt;div class=\"span2\"&gt;\n&lt;div class=\"fixed-box\"&gt;\n&lt;img alt=\"380269_296696787082930_112083275544283_706587_1195153490_n\" src=\"/system/bbook_news/assets/000/000/013/small/380269_296696787082930_112083275544283_706587_1195153490_n.jpg?1351584787\"&gt;\n&lt;/div&gt;\n&lt;h6&gt;\n&lt;a href=\"#\"&gt;fala&lt;/a&gt;\n&lt;/h6&gt;\n&lt;/div&gt;\n&lt;div class=\"span2\"&gt;\n&lt;div class=\"fixed-box\"&gt;\n&lt;img alt=\"402580_344754638902723_100001045697946_1105971_1493945266_n\" src=\"/system/bbook_news/assets/000/000/014/small/402580_344754638902723_100001045697946_1105971_1493945266_n.jpg?1351584806\"&gt;\n&lt;/div&gt;\n&lt;h6&gt;\n&lt;a href=\"#\"&gt;yeah~!&lt;/a&gt;\n&lt;/h6&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"span3\"&gt;\n&lt;div class=\"box-model-news more-news\"&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;a href=\"#\"&gt;21212121&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\"#\"&gt;So?&lt;/a&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The javascript code is same as above alert(\"hi\")</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","usps"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":711,"score":0,"question_id":7163280,"title":"How to use the shipping gem in ruby on rails 3 for USPS API?","body":"<p>I've found the <code>shipping</code> gem for ruby here <a href=\"http://shipping.rubyforge.org/\" rel=\"nofollow\">http://shipping.rubyforge.org/</a> searching on google for some information on integrating  <code>USPS</code> API on a Ruby on rails application but when I install the gem and add it to my <code>Gemfile</code> as i run the <code>bundle install</code> whenever a try to run my application or a rake taks i get the following error:</p>\n\n<pre><code>/Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `require': /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping/ups.rb:109: syntax error, unexpected ':', expecting keyword_then or ';' or '\\n' (SyntaxError)\n/Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping/ups.rb:437: syntax error, unexpected keyword_end, expecting $end\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `block in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:225:in `block in load_dependency'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:596:in `new_constants_in'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:225:in `load_dependency'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping.rb:47:in `&lt;top (required)&gt;'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:68:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:68:in `block (2 levels) in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:66:in `each'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:66:in `block in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:55:in `each'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:55:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler.rb:120:in `require'\n    from /Users/myusername/railsapps/dbh4/config/application.rb:7:in `&lt;top (required)&gt;'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.7/lib/rails/commands.rb:15:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.7/lib/rails/commands.rb:15:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have removed now the gem from my <code>Gemfile</code> and my application is up and running but, I don't even know if this gem works for <code>Rails 3</code> or even if this gem works for <code>USPS</code> API.</p>\n\n<p>Any help on this? I need to integrate USPS Web Tools with my Ruby on Rails 3 Application.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","view","habtm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12899777,"title":"Replicate Rails Admin HABTM with 2 selects","body":"<p>I'd like to replicate this form element in my rails app, I have a model that I'm categorizing with multiple categories and I would like to do with via 2 select boxes but I have no idea how to accomplish it I have tried it with different thing but can't seem to get it. Anyone have an idea of how to accomplish this funcionality or a tutorial?</p>\n\n<p>Here is the form I'm talking about. Specifically the one for teams/fans. Keep in my that my associations are correct it's just the view that overwhelms me.</p>\n\n<p><a href=\"http://rails-admin-tb.herokuapp.com/admin/team/new\" rel=\"nofollow\">http://rails-admin-tb.herokuapp.com/admin/team/new</a></p>\n"},{"tags":["ruby-on-rails","xml","api","usps"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":362,"score":1,"question_id":5938446,"title":"USPS API + Rails: How to get started?","body":"<p>I'm working on a web store for my company. Right now we do most of our transactions through eBay, but we are wanting to build our own web store so as to avoid having to pay eBay's fees.</p>\n\n<p>I've registered with USPS for API access and I've downloaded the technical documentation, but I'm a little lost. I'm fairly new to Rails, and I have no idea how to send the data to the USPS server.</p>\n\n<p>So, where do I start?</p>\n\n<p>EDIT: The API that I am going to be using most is the Shipping Calculator API.</p>\n"},{"tags":["ruby-on-rails","ruby","testing","shoulda","backtrace"],"answer_count":3,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":321,"score":7,"question_id":4214219,"title":"Is shoulda destroying my backtraces?","body":"<p>I have a test more or less like this:</p>\n\n<pre><code>class FormDefinitionTest &lt; ActiveSupport::TestCase\n  context \"a form_definition\" do\n    setup do\n      @definition = SeedData.form_definition\n      # ...\n</code></pre>\n\n<p>I've purposely added a </p>\n\n<pre><code>raise \"blah\"\n</code></pre>\n\n<p>somewhere down the road and I get this error:</p>\n\n<pre><code>RuntimeError: blah\ntest/unit/form_definition_test.rb:79:in `__bind_1290079321_362430'\n</code></pre>\n\n<p>when I should be getting something along:</p>\n\n<pre><code>/Users/pupeno/projectx/db/seed/sheet_definitions.rb:17:in `sheet_definition': blah (RuntimeError)\n    from /Users/pupeno/projectx/db/seed/form_definitions.rb:4:in `form_definition'\n    from /Users/pupeno/projectx/test/unit/form_definition_test.rb:79\n</code></pre>\n\n<p>Any ideas what is sanitizing/destroying my backtraces? My suspicious is shoulda because the when the exception happens inside a setup or should is whet it happens.</p>\n\n<p>This is a Rails 3 project, in case that's important.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13135033,"title":"Return all locales for selected field","body":"<p>Say I have a model Book</p>\n\n<pre><code>class Book\n  include Mongoid::Document\n  field :name, localize: true\n  # ... much more fields\nend\n</code></pre>\n\n<p>Now I want to query for only name only, but for all locales. Book.only(:name) seems to return the current locale, and while I could do Book.only(:name, :\"name.ar\"), it requires that I manually add all locales I have. </p>\n\n<p>Is there a way to tell Mongoid I want all locales of selected field?</p>\n"},{"tags":["ruby-on-rails","fastcgi","centos","lighttpd"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2995,"score":1,"question_id":564202,"title":"LigHTTPD + RoR: \"spawning fcgi failed\"","body":"<p>I'm trying to set up Ruby on Rails on lighttpd. The operating system is CentOS, though it may be notable that this is a Xen-based VPS.</p>\n\n<p>The problem occurs something like this:</p>\n\n<pre><code>bash-3.2# /etc/rc.d/init.d/lighttpd start\nStarting lighttpd:                                         [  OK  ]\nbash-3.2# /etc/rc.d/init.d/lighttpd status\nlighttpd dead but pid file exists\n</code></pre>\n\n<p>The error log reports...  </p>\n\n<pre>\n    2009-02-19 01:36:02: (log.c.97) server started  \n    2009-02-19 01:36:02: (mod_fastcgi.c.1051) the fastcgi-backend /var/www/rails/ToD  \n    o/public/dispatch.fastcgi failed to start:   \n    2009-02-19 01:36:02: (mod_fastcgi.c.1055) child exited with status 2 /var/www/ra  \n    ils/ToDo/public/dispatch.fastcgi   \n    2009-02-19 01:36:02: (mod_fastcgi.c.1058) If you're trying to run PHP as a FastC  \n    GI backend, make sure you're using the FastCGI-enabled version.  \n    You can find out if it is the right one by executing 'php -v' and it should disp  \n    lay '(cgi-fcgi)' in the output, NOT '(cgi)' NOR '(cli)'.  \n    For more information, check http://trac.lighttpd.net/trac/wiki/Docs%3AModFastCGI  \n    #preparing-php-as-a-fastcgi-programIf this is PHP on Gentoo, add 'fastcgi' to th  \n    e USE flags.   \n    2009-02-19 01:36:02: (mod_fastcgi.c.1365) [ERROR]: spawning fcgi failed.   \n    2009-02-19 01:36:02: (server.c.897) Configuration of plugins failed. Going down.  \n</pre>\n\n<p>mod_fastcgi is enabled.</p>\n\n<p>As far as I can tell, the relevant configuration in the Lighttpd file is </p>\n\n<pre>\n    fastcgi.server =  (\".fcgi\" => ( \"rails\" =>\n      ( \"min-procs\" => 1,\n        \"max-procs\" => 2,\n        \"socket\" => \"/tmp/lighttpd-fcgi.socket\",\n        \"bin-path\" => \"/var/www/rails/ToDo/public/dispatch.fastcgi\"\n      )\n    ))\n</pre>\n\n<p>dispatch.fastcgi is set to executable.</p>\n\n<p>I'm not really sure what's going on.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13135053,"title":"Customise carrierwave validation messages","body":"<p>carrierwave is giving me this validation error:</p>\n\n<blockquote>\n  <p>Image You are not allowed to upload \"pages\" files, allowed types: jpg,\n  jpeg, gif, png</p>\n</blockquote>\n\n<p>any idea how to remove the \"image\" attribute bit from the beginning? it doesn't read very well.</p>\n"},{"tags":["ruby-on-rails","rake","mailnotifier"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13133248,"title":"Send output from rake to email","body":"<p>Rails 3.1.1 and Heroku</p>\n\n<p>I am running a few Rake-commands every night on my app that is hosted at Heroku. The rake commands produces some <code>puts</code> rows that I would like to read in the morning to see how the updates performed by rake was performed. </p>\n\n<p>Preferably, I would like this info emailed to me and this seems like it should not be too difficult, but what do I need to do?</p>\n\n<p>The rake_notifier gem does not seem to be the solution, since I want the output even when the rake is successful (rake_notifier seems to only send info when the rake crashes).</p>\n\n<p>Update: I do not know ruby well enough so I have probably missed out on very simple solutions. The problems is just as much to \"gather\" that data. Emailing it to me is the next step in the problem chain. Right now I am only checking my logs and they are flooded with tons of other data.</p>\n"},{"tags":["ruby-on-rails","activerecord","time","timezone"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":11746980,"title":"ActiveRecord Group by statement not converting to Time.zone","body":"<p>I use the query below to give me a count of checkins broken down by day.</p>\n\n<pre><code>Checkin.select(\"date(created_at) as calendar_day, count(*) as total_checkins\").where(\"user_id = ? AND created_at &gt; ?\", user.id, 28.days.ago).group(\"date(created_at)\").order(\"date(created_at)\")\n</code></pre>\n\n<p>Example output:</p>\n\n<p><img src=\"http://i.stack.imgur.com/NCuvL.png\" alt=\"example output\"></p>\n\n<p>The issue I'm facing is that this query is in UTC and does not convert to the Time.zone (PST) I have set in my application.rb file under config.time_zone. In the example above the last two checkins should be under \"2012-07-30\".</p>\n\n<p>I know that with other queries this conversion works fine. For example with:</p>\n\n<pre><code>Checkin.last.created_at # Returns in PST\n</code></pre>\n\n<p>So it must be something about the complexity of the query above. I'm guessing it might be the select statement. How could I write the above to account for the configured timezone?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13123141,"title":"Giving specific id to FormTagHelper in rails","body":"<p>i've a form written in a <strong>HAML</strong> file  like this </p>\n\n<pre><code>= form_tag \"ratings_form\", movies_path, :method =&gt; :get do\n  Include: \n  - @all_ratings.each do |rating|\n    = rating \n    = check_box_tag \"ratings[#{rating}]\", 'yes', @ratings.keys.include?(rating)\n  = submit_tag 'Refresh'\n</code></pre>\n\n<p>and i want to give each of the <strong>Form</strong> and the <strong>Submit button</strong> a specific <strong>id</strong> </p>\n\n<p>i've checked the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html\" rel=\"nofollow\">documentation</a> and found that the parameters given to </p>\n\n<p><strong>form_tag</strong> or <strong>submit_tag</strong>  doesn't contain id .</p>\n\n<hr>\n\n<p>the correct answer is adding  :id => \"id_u_want\" to any tag and obviously it will work\nit worked when i did </p>\n\n<pre><code>= form_tag movies_path, :id =&gt; \"ratings_form\" , :method =&gt; :get do\n  Include: \n  - @all_ratings.each do |rating|\n    = rating \n    = check_box_tag \"ratings[#{rating}]\", 'yes', @selected_ratings.keys.include?(rating)\n  = submit_tag 'Refresh' , :id =&gt; \"ratings_submit\"\n</code></pre>\n"},{"tags":["ruby-on-rails","ajax","twitter-bootstrap","modal"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":636,"score":0,"question_id":11010947,"title":"Changing Devise for Bootstrap modal","body":"<p>I found this link <a href=\"http://stackoverflow.com/questions/10318949/link-to-another-page-using-twitter-bootstrap-jquery-modal-in-rails\">Link to another page using Twitter Bootstrap jquery modal in rails</a> and here is completely what I need - registration and others using Bootstrap modal and Devise. \n<p> I made that steps, but it doesn't popup, but redirects me to another page and shows not proper page.\n<p> It behaves really strange, it opens NOT MINE form.\n<p>_new.html.erb</p>\n\n<pre><code>&lt;div class=\"modal hide fade in\" id=\"sign_up\"&gt;\n\n&lt;%= form_for resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name),do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n....\n &lt;% end %&gt;     \n</code></pre>\n\n<p></p>\n\n<p>Create new.js.erb:</p>\n\n<pre><code>      $(\"#main\").before(\"&lt;%= escape_javascript(render \"new\", :formats =&gt; [:html]) %&gt;\");\n      $(\"#sign_up\").modal();\n</code></pre>\n\n<p>and link_to :</p>\n\n<pre><code>       &lt;%= link_to \"Sign up\", new_user_registration_path, :remote =&gt; true %&gt;\n</code></pre>\n\n<p>and in application.html.erb:</p>\n\n<pre><code>    &lt;%= stylesheet_link_tag    \"application\", media: \"all\" %&gt;\n   &lt;%= javascript_include_tag 'http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js' %&gt;\n    &lt;%= csrf_meta_tags %&gt;\n</code></pre>\n\n<p><b> EDITED.</b>\n     In my logs: \n            Processing by Devise::RegistrationsController#new as JS\n           Rendered devise/registrations/new.js.erb (15.6ms)\n           Completed 500 Internal Server Error in 31ms</p>\n\n<pre><code>      ActionView::Template::Error (Missing partial devise/new with {:locale=&gt;[:en], :f\n       ormats=&gt;[:js, :html], :handlers=&gt;[:erb, :builder, :coffee, :rabl]}. Searched in:\n\n     * \"D:/print_it_green/app/views\"\n    * \"C:/Ruby192/lib/ruby/gems/1.9.1/gems/devise-2.1.0/app/views\"\n       ):\n        1: $(\"#sign_up\").before(\"&lt;%= escape_javascript(render \"devise/new\", :formats\n       =&gt; [:html]) %&gt;\");\n         2: $(\"#sign_up\").modal();\n      app/views/devise/registrations/new.js.erb:1:in `_app_views_devise_registration\n       s_new_js_erb___312569811_25856784'\n</code></pre>\n\n<p>Where is problem ? </p>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13134246,"title":"Nested array in URL params","body":"<p>Hi I would like to make the following work:</p>\n\n<pre><code>http://localhost:3000/reviews/new?ticket[]=token[]=109u11\n</code></pre>\n\n<p>It can be thought of as meaning <code>params[:ticket][:token] = 109u11</code></p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","database","activerecord","schema"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13134191,"title":"How to generate database schema graph for one application using ActiveRecord?","body":"<p>I want to generate graphs to describe the relations within a application using ActiveRecord, is there some gem to accomplish that?</p>\n\n<p>such as this one\n<img src=\"https://upload.wikimedia.org/wikipedia/commons/3/36/Mediawiki_database_Schema.svg\" alt=\"database graph\"></p>\n"},{"tags":["ruby-on-rails","ruby","pg"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13133334,"title":"How to install \"pg\" gem for rails 3 on ubuntu \"can not build native extensions\"","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6040583/unable-to-install-pg-gem-on-ubuntu-cant-find-the-libpq-fe-h-header\">Unable to install pg gem on ubuntu - Can’t find the &#39;libpq-fe.h header</a>  </p>\n</blockquote>\n\n\n\n<p>Whenever I try to install the pg gem for my Rails project, it gives me <code>Error \"failed to build native extensions\"</code>.</p>\n\n<p>I already used a couple of tricks but failed.</p>\n"},{"tags":["ruby-on-rails","webrick"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":13126781,"title":"Rails production mode: SSL received a record that exceeded the maximum permissible length","body":"<p>Hi I'm not sure if this is supposed to happen, but when I do a <code>RAILS_ENV=production rails server</code> in my terminal and then try to run localhost:3000 it gives me an error:</p>\n\n<pre><code>Secure Connection Failed\n\nAn error occurred during a connection to localhost:3000.\n\nSSL received a record that exceeded the maximum permissible length.\n\n(Error code: ssl_error_rx_record_too_long)\n</code></pre>\n\n<p>I read somewhere that it might be because my url is <code>https://localhost:3000/</code> instead of <code>http://localhost:3000/</code> with the \"S\" after http? but I can't change it since it keeps going to https automatically.</p>\n\n<p>Is this normal? The reason I'm trying to run it in production is because I am getting errors when I try to deploy my app into heroku ( question asked here: <a href=\"http://stackoverflow.com/questions/13126497/rails-heroku-actionviewtemplateerror\">Rails + Heroku : ActionView::Template::Error</a> ) so I thought it would help me debug.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13121894,"title":"How do I avoid chains of method calls like @invoice.customer.address.street etc?","body":"<p>I have some models and have views code that look like the following</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :customer\nend\n\nclass Customer &lt; ActiveRecord::Base\n  has_one :address\n  has_many :invoices\nend\n\nclass Invoice &lt; ActiveRecord::Base\n  belongs_to :customer\nend\n</code></pre>\n\n<p>This code shows a simple invoice structure, with a customer who has a single address.\nThe view code to display the address lines for the invoice would be as follows:</p>\n\n<pre><code>&lt;%= @invoice.customer.name %&gt;\n&lt;%= @invoice.customer.address.street %&gt;\n&lt;%= @invoice.customer.address.city %&gt;,\n&lt;%= @invoice.customer.address.state %&gt;\n&lt;%= @invoice.customer.address.zip_code %&gt;\n</code></pre>\n\n<p>above view code is not ideal. For proper encapsulation, the\ninvoice should not reach across the customer object to the street attribute of the\naddress object. Because if, for example, in the future your application were to change\nso that a customer has both a billing address and a shipping address, every place in\nyour code that reached across these objects to retrieve the street would break and\nwould need to change. How can I avoid this problem ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":13109872,"title":"why i lost radio button created by simple form when submit an form with error?","body":"<p>I have a form like this:  </p>\n\n<p><img src=\"http://s7.postimage.org/djw3k1hsr/new_question.png\" alt=\"new question\"></p>\n\n<p>When i submit form without any content, it shows errors:</p>\n\n<p><img src=\"http://s18.postimage.org/gkaqgv3qh/error_new_question.png\" alt=\"error new question\"></p>\n\n<p>The radio button is lost !</p>\n\n<p>This is in my form view:  </p>\n\n<pre><code>&lt;%= simple_form_for @question, defaults: { error: false } do |q| %&gt;\n\n  &lt;legend&gt;Question&lt;/legend&gt;\n  &lt;%= render \"shared/error_messages\", object: q.object %&gt;\n\n  &lt;%= q.input :content, input_html: { rows: 3, class: 'span6' } %&gt;\n  &lt;%= q.input :mark, input_html: { class: 'span1' } %&gt;\n  &lt;%= q.association :topic %&gt;\n  &lt;%= q.association :question_type %&gt;\n\n  &lt;%= q.simple_fields_for :answers do |a| %&gt;\n    &lt;%= a.input :correct, collection: [[true, 'True'], [false, 'False']],\n                                                            as: :radio_buttons,\n                                                            label: 'Answer',\n                                                            value_method: :first,\n                                                            label_method: :last,\n                                                            item_wrapper_class: 'inline'\n                                                            %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;  \n</code></pre>\n\n<p>What's i missed or wrong? I used <code>render 'new'</code> in my create action of Question controller when @question.save is false. This is my question controller:</p>\n\n<pre><code>class QuestionsController &lt; ApplicationController\n  def new\n    @question = Question.new\n    @question.answers.build\n  end\n\n  def create\n    @question = Question.new(content: params[:question][:content])\n    @question.mark = params[:question][:mark]\n    @question.topic_id = params[:question][:topic_id]\n    @question.question_type_id = params[:question][:question_type_id]\n    @question.user_id = current_user.id\n\n    if @question.save\n      if params[:question][:answers_attributes]['0'][:correct] == 'true'\n        answer = @question.answers.build(content: 'True')\n        answer.correct = true\n      else\n        answer = @question.answers.build(content: 'False')\n      end\n      if @question.save\n        flash[:success] = \"Successfully created new question.\"\n        redirect_to root_url\n      else\n        render 'new'\n      end\n    else\n      render 'new'\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","query","controller","production"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":13130195,"title":"Rails - query works in view and controller in development, but only in view in production","body":"<p>I'm new to rails, so my question may have a simple answer. I am using rails 3.2.3. I have the following code to perform a search on my database:</p>\n\n<p><code>@search_results = User.search(\"test search\")</code></p>\n\n<p>Where <code>search</code> is defined in my model. This code works perfectly for me when <code>@search_results = Data.search(\"test search\")</code> is in either the view or controller in my development environment. In production, it works in the view, but not in the controller. I don't know why. Looking at my production log, there is a big difference in the SQL for the view and the controller:</p>\n\n<p>When query is from a view in production, this is what I see in the log:</p>\n\n<pre><code>SELECT 'users'.* FROM 'users' WHERE (concat(field1, ' ', field2, ' ', field3) LIKE '%test%' AND concat(field1, ' ', field2, ' ', field3) LIKE '%search%'\n</code></pre>\n\n<p>That is exactly what I want. However, when query is from controller, the SQL turns into this:</p>\n\n<pre><code>SELECT 'users'.* FROM 'users' WHERE (field1 LIKE '%test search%' OR field2 LIKE '%test search%' OR field3 LIKE '%test search%')\n</code></pre>\n\n<p>I don't understand what my controller in the production environment is doing to create this change.</p>\n\n<p>EDIT-Here is the <code>search</code> method:</p>\n\n<pre><code>def self.search(search)\n  if search\n    search_length = search.split.length\n     find(:all, :conditions =&gt; [([\"concat(field1, ' ', field2, ' ', field3) LIKE ?\"] *        search_length).join(' AND ')] + search.split.map { |name| \"%#{name}%\" }) \n  else\n    find(:all)\n  end\nend\n</code></pre>\n\n<p>I am using MySQL on both production and development.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":6,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1870,"score":4,"question_id":4696040,"title":"Escaping values in Rails (similar to mysql_real_escape_string())","body":"<p>I know about prepared statements, but if I'm using raw SQL, does ActiveRecord have a way to manually escape values?</p>\n\n<p>Something like this would be nice:</p>\n\n<pre><code>self.escape(\"O'Malley\") # O\\'Malley\n</code></pre>\n"},{"tags":["ruby-on-rails","railstutorial.org"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":9690818,"title":"Rails Tutorial 10.2 - 6: \"NoMethodError in Users#edit\"","body":"<p>I've been walking through the Hartl tutorial for the first time and have been getting an error on Chapter 10 editing/updating users.  Following along, I >>should&lt;&lt; be able to at least view the user edit page, but keep getting the below error.  Have gone through everything a few times but can't seem to find the origin of my problem.  Note that this is my first time doing anything programming related so go slow with me.</p>\n\n<p>Error</p>\n\n<blockquote>\n  <p>undefined method `model_name' for NilClass:Class</p>\n</blockquote>\n\n<p>Line being called out in error, from my user edit view </p>\n\n<p><code>&lt;%= form_for(@user) do |f| %&gt;</code></p>\n\n<p>Edit method from Users controller</p>\n\n<pre><code>    def edit\n      @user = User.find(params[:id])\n      @title = \"Edit user\"\n    end\n</code></pre>\n\n<p>A similar block of code is used in my user new view with no issues, and am at a loss why this would be returning nil and have tried with both new and existing users .  Thanks!</p>\n"},{"tags":["ruby-on-rails","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":12726764,"title":"Precompile / preload cached fragments in Rails","body":"<p>Using Rails 3.1.1 and Herkou</p>\n\n<p>I have 1.000 products in my app. They all have a very slow controller which is effectively solved by fragment caching. Although the data doesn't change very often, it still needs to expire (which I do by sweeping) periodically, in my case once a week.</p>\n\n<p>Now, after sweeping the cached views I don't want my users to create the new fragments by trying to access the products one after another (takes about 6-8 secs at the first load, 2-3 sec for the cached load). I assume I can do that with some sort of script that will load each Product Page one by one and thus make the server create those fragments.</p>\n\n<p>I can imagine this can be handled in three ways:</p>\n\n<ol>\n<li><p>Run a script on my local machine that will try to access each url with some sort of get-command - Downside: Not very pretty and will affect visitor stats in a way I would not prefer.</p></li>\n<li><p>Run the same type script on the server after the sweeper, that will load each Product. How can I do that, in that case?</p></li>\n<li><p>Using a smart Rails command to do this automatically. Is there such an elegant command?</p></li>\n</ol>\n"},{"tags":["ruby-on-rails","caching","memcached","fragment-caching"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12727995,"title":"Assets miss in Rails (also using fragment caching). No memcache","body":"<p>Using Rails 3.1.1 on Heroku, running with two web dynos.</p>\n\n<p>I am NOT using memcache at the moment. I am <a href=\"http://stackoverflow.com/questions/12724876/cache-only-the-main-content-in-rails\">using fragment caching successfully</a>.</p>\n\n<p>I am getting a lot of cache miss (and very, very few fresh) in my logs. It should be noted that facebox-2 (that actually gets a \"cache fresh\" is <strong>outside</strong> the cached fragment. </p>\n\n<p>As you can see, the misses are not follow by a \"store\" so as far as I understand, they are not actually being cached:</p>\n\n<pre><code>cache: [GET /assets/facebox2-e2da8b69b260f5c7f70e22a7b3e6bb26.css] fresh\ncache: [GET /assets/application-282064ad715b6798765bdeb777974e9b.js] miss\ncache: [GET /assets/seasons/fall_top_background2.png] miss\ncache: [GET /assets/tell-a-friend-afd54b062dd0d649f6595b96bf7450a2.png] miss\ncache: [GET /assets/banners/annons-884c9fbe7f6805249247ef02438fca08.jpg] miss\ncache: [GET /assets/admarker-c709fa0ac510720b8ffb56e3a63a8bb3.jpg] miss\ncache: [GET /assets/gifts/skolett-b97b0e5b262df6e15b95470f06917758.jpg] miss\ncache: [GET /assets/closelabel.png] miss\ncache: [GET /assets/loading.gif] miss\n</code></pre>\n\n<p><strong>Production.rb</strong></p>\n\n<pre><code>  config.serve_static_assets = true\n  config.action_controller.perform_caching = true\n</code></pre>\n\n<p>I run <code>rake assets:precompile</code> in production mode successfully locally and upload it to Heroku successfully as well.</p>\n\n<p>I think my issue is very closely related to <a href=\"http://stackoverflow.com/questions/9256815/cache-miss-with-rails-3-2-and-page-caching-in-development-anyone-else\">this question</a> although I am running it in Production mode (shouldn't be any difference, right?).</p>\n\n<p>I have experimented a little bit with Memcached but I am still a beginner on how to use it. </p>\n\n<p>My personal belief is that I am trying to fetch cached images from within a cache which messes up the verification. For example, in my fragmented cache I am looking for </p>\n\n<p><code>banners/annons-884c9fbe7f6805249247ef02438fca08.jpg</code> </p>\n\n<p>whereas it might be cached with another \"code\" like </p>\n\n<pre><code>banners/annons-121b1b12b12b1b1b11b1b.jpg\n</code></pre>\n\n<p>Is this correct?</p>\n\n<p>To my questions:</p>\n\n<ol>\n<li><p>Do I have the same issue as with <a href=\"http://stackoverflow.com/questions/9256815/cache-miss-with-rails-3-2-and-page-caching-in-development-anyone-else\">this question</a>? Is it that I am caching within a cache, so to speak?</p></li>\n<li><p>Is Memcached and Rake::Cache the way to handle this? If so, I'd prefer my fragmented html-pages to be stored as files and not in the memcache (they are 1.000 x 3 Mb). How can I do that?</p></li>\n<li><p>Is it correct that fragment_caching does not actually create those files on Heroku, because apps don't have write permission?</p></li>\n<li><p>Is this likely to affect the performance on my app (it is quite slow)?</p></li>\n<li><p>In short, what would be an easy way of fixing this?</p></li>\n</ol>\n"},{"tags":["ruby-on-rails","json","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13032555,"title":"RSpec API service passing array","body":"<p>I make couple of test which checks my API Services. In one test i pass two parameters to api/v1/pages/1 and it works OK; Here's code</p>\n\n<blockquote>\n  <blockquote>\n    <p>put \"api/v1/pages/#{@page.id}\", { \"title\" => \"new title\",\n    \"description\" => \"new description\"}    last_response.status.should eql(200)</p>\n  </blockquote>\n</blockquote>\n\n<p>Now i'm having problems with passing array of objects to service. I was trying something but unsuccessfully.</p>\n\n<pre><code> @index = build(:index) //factory girl\n @contact = build(:contact)\n put \"api/v1/pages/1/menu\" ,[ //need to pass @index and @contact, and/or @index.name, @contact.name]\n</code></pre>\n"},{"tags":["ruby-on-rails","methods"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":13132402,"title":"Destroy method does not work, instead show method implements (Rails)","body":"<p>I need to make a button to destroy object.\nInstead of destroy it shows fields</p>\n\n<p>inex.html.erb</p>\n\n<pre><code>&lt;%= link_to image_tag(\"/images/glossy_green_button.png\"), device , { :html =&gt; { :method =&gt;  :delete}, :controller =&gt; :devices, :action =&gt; 'destroy',:id =&gt; device.id, :onclick =&gt; 'return confirm(\\'Are you sure?\\');' }, :method =&gt; :turnon %&gt;\n</code></pre>\n\n<p>devices_controller.rb</p>\n\n<pre><code>def destroy\n @device = Device.find(params[:id])\n @device.destroy\n\n  respond_to do |format|\n   format.html { render action: \"destroy\" }\n   format.json { head :no_content }\n  end\n end\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>device GET    /devices/:id(.:format)      devices#show\n       PUT    /devices/:id(.:format)      devices#update\n       DELETE /devices/:id(.:format)      devices#destroy\n</code></pre>\n\n<p>Appreciate any ideas what I got wrong.\nThank you\nD</p>\n\n<p>UPDATED: </p>\n\n<pre><code>&lt;%= button_to \"Delete\", device ,  :method =&gt; :delete %&gt;\n</code></pre>\n\n<p>this works fine</p>\n"},{"tags":["ruby-on-rails","ruby","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13130913,"title":"HAML loop through has_and_belongs_to_many objects instead of ids","body":"<pre><code>class Team\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  field :name,              :type =&gt; String, :default =&gt; \"My New Team\"\n  validates_presence_of :name\n  has_and_belongs_to_many :users\n\nend\n</code></pre>\n\n<p>In my show.haml for Team, I'm trying:</p>\n\n<pre><code> - @team[:users].each do |user|\n        %tr\n          %td= link_to user.name, user\n          %td= user.email\n</code></pre>\n\n<p>But the problem is that Mongo is storing the users reference as user_ids. So</p>\n\n<ul>\n<li>@team[:user_ids].each do |user|</li>\n</ul>\n\n<p>But now I'll have to execute a query for each user... Before I do so I just wanted to know if there is another way to loop through the users? I was thinking of putting a variable in the controller called @user_objects but not sure how to generate that without looping through all the user_ids and doing a find() call.</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":4,"favorite_count":6,"up_vote_count":15,"down_vote_count":0,"view_count":5533,"score":15,"question_id":1262546,"title":"Copy model instances in Rails","body":"<p>I have a model <code>Foo</code> with attributes <code>id, name, location</code>.\nI have an instance of <code>Foo</code>:</p>\n\n<pre><code>f1 = Foo.new\nf1.name = \"Bar\"\nf1.location = \"Foo York\"\nf1.save\n</code></pre>\n\n<p>I would like to copy <code>f1</code> and from that copy, create another instance of the <code>Foo</code> model, but I don't want <code>f1.id</code> to carry over to <code>f2.id</code> (I don't want to explicitly assign that, I want the db to handle it, as it should).</p>\n\n<p>Is there a simple way to do this, other than manually copying each attribute? Any built in functions or would writing one be the best route?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13087254,"title":"show child checkboxes under parent checkboxes in view page rails","body":"<blockquote>\n  <p>I am showing check boxes in view page and data will come from the database. Here is my code and the problem is that while looping if the same parent name came it shows same parent checkboxes two times. </p>\n</blockquote>\n\n<pre><code>&lt;% @permission.each do |f| %&gt;\n        &lt;% if @controller_code != f.controller_code %&gt;\n            &lt;% @controller_code = f.controller_code %&gt;\n            &lt;%= check_box_tag \"cntrl_#{f.controller_code}\", f.controller_code, false,  :class =&gt; \"Par_#{f.controller_code}\", :id =&gt; \"Par_#{f.controller_code}\" %&gt; &lt;%= f.controller_name %&gt;\n            &lt;br/&gt;\n            &lt;% @permission.each do |f| %&gt;\n                &lt;% if @controller_code == f.controller_code %&gt;\n                    &amp;nbsp;  &amp;nbsp;&lt;%= check_box_tag \"action_#{f.controller_code}_#{f.action_code}\",f.action_code, false,  :class =&gt; \"Child_#{f.controller_code}\", :id =&gt; \"Child_#{f.controller_code}_#{f.action_code}\" %&gt; &lt;%= f.action_name %&gt;\n                    &lt;br/&gt;\n                &lt;% end %&gt;\n            &lt;% end %&gt;   \n        &lt;% end %&gt;\n</code></pre>\n\n<blockquote>\n  <p>I have also tried this way but its not working properly..</p>\n</blockquote>\n\n<pre><code>&lt;% @permission.each do |f| %&gt;   \n            &lt;% if @controller_code != f.controller_code %&gt;\n            &lt;% @controller_code = f.controller_code %&gt;\n                &lt;%= check_box_tag \"cntrl_#{f.controller_code}\", f.controller_code, false,  :class =&gt; \"Par_#{f.controller_code}\", :id =&gt; \"Par_#{f.controller_code}\" %&gt; &lt;%= f.controller_name %&gt;\n             &lt;br/&gt;\n            &lt;% end %&gt;\n            &amp;nbsp;  &amp;nbsp;&lt;%= check_box_tag \"action_#{f.controller_code}_#{f.action_code}\",f.action_code, false,  :class =&gt; \"Child_#{f.controller_code}\", :id =&gt; \"Child_#{f.controller_code}_#{f.action_code}\" %&gt; &lt;%= f.action_name %&gt;\n            &lt;br/&gt;        \n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":426,"score":1,"question_id":9201406,"title":"ruby on rails mac x os lion run server LoadError","body":"<p>When I type the rails server on terminal, I got the following error. \nI don't know how to fix it. Is any one can give me a help?\nAnd I also need a ruby on rails mac os x Lion installation tutorial.</p>\n\n<pre>\n:simple_cms benhuayang$ rails server\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/mysql2-0.3.11/lib/mysql2.rb:9:in `require':\ndlopen(/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle, 9): Library not loaded: libmysqlclient.18.dylib (LoadError)  \nReferenced from:\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle\nReason: image not found -\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle   from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/mysql2-0.3.11/lib/mysql2.rb:9:in `&lt;top (required)&gt;'    from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:68:in `require'     from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:68:in `block (2 levels) in require'     from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:66:in `each'    from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:66:in `block in require'    from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:55:in `each'    from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.0.21/lib/bundler/runtime.rb:55:in `require'     from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.0.21/lib/bundler.rb:122:in `require'    from\n/Users/benhuayang/Sites/simple_cms/config/application.rb:7:in `&lt;top (required)&gt;' from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.1/lib/rails/commands.rb:53:in `require'     from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.1/lib/rails/commands.rb:53:in `block in '   from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.1/lib/rails/commands.rb:50:in `tap'     from\n/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.1/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'  from\nscript/rails:6:in `require'     from\nscript/rails:6:in `&lt;main&gt;'\n</pre>\n\n<p>this is path for mysql </p>\n\n<pre><code>/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0/bin:/Users/benhuayang/.rvm/gems/ruby-1.9.3-p0@global/bin:/Users/benhuayang/.rvm/rubies/ruby-1.9.3-p0/bin:/Users/benhuayang/.rvm/bin:/opt/local/bin:/opt/local/sbin:/usr/local/mysql/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13132745,"title":"Rails: Functional test redirects after namespacing controllers","body":"<p>I made separate controllers and views for models that needed a user view and an admin view. After this I started running 'rake test' and had errors for redirect assertions that were going to the original controller when I generated the scaffold instead of the new Admin namespaced controller. I was able to fix all the redirects except the ones where there was no explicit path stated, but instead just a local variable.</p>\n\n<p>For example:</p>\n\n<p>redirect_to product_path vs redirect_to @product</p>\n\n<p>I can't figure out how the local variable is finding its redirect URL. Can anyone explain this to me? I tried renaming the functional test file to coincide with the new admin controller and that opened up a whole can of worms.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13092509,"title":"Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory","body":"<p>I am trying to execute rake db:create command. I get following error</p>\n\n<p>Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory.</p>\n\n<pre><code>Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory.\nCould not open library 'libcurl.so': libcurl.so: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>Can anyone help me with this issue?</p>\n"},{"tags":["ruby-on-rails","ruby","rvm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":100,"score":2,"question_id":13131794,"title":"Ruby On Rails libyaml","body":"<p>I'm running rails version 3.2.8 and ruby version 1.9.3-p286 on Linux</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rails -v\nRails 3.2.8\nuser1@company.com [~/rails_apps/myapp]# ruby -v\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\nuser1@company.com [~/rails_apps/myapp]#\n</code></pre>\n\n<p>I can generate a migration but I cannot run it. I keep getting the following error message</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rake db:migrate\n/home3/user1/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/yaml.rb:56:in `&lt;top (required)&gt;':\nIt seems your ruby installation is missing psych (for YAML output).\nTo eliminate this warning, please install libyaml and reinstall your ruby.\n/home3/user1/ruby/gems/gems/json-1.7.5/lib/json/common.rb:67: [BUG] unknown type 0x22 (0xc given)\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\n&lt;snip&gt;\n</code></pre>\n\n<p>then a lot of debug info\n    </p>\n\n<pre><code>[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAborted\nuser1@company.com [~/rails_apps/myapp]#\n</code></pre>\n\n<p>I installed libyaml</p>\n\n<pre><code>rvm pkg install libyaml\n</code></pre>\n\n<p>then reinstalled ruby</p>\n\n<pre><code>rvm reinstall ruby-1.9.3-p286\n</code></pre>\n\n<p>but that did not help.</p>\n\n<p>Any other ideas why I keep getting this error message?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","validation","model"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13105264,"title":"How do I create a validation that checks if at least one of multiple booleans is true?","body":"<p>I have a Rails 3.2 app that manages tasks.  Here tasks are being assigned to users.  The task model has multiple user variables that are booleans.  How would I add a validation to say that at least one user is set to true?</p>\n\n<p>Original:</p>\n\n<pre><code>class Task &lt; ActiveRecord::Base\n  attr_accessible :title, :user1, :user2, :user3, :user4:\n  validates :title, :presence =&gt; true\n  validates :is_assigned\n\n\n  def is_assigned\n    if #AT_LEAST_ONE_USER_IS_TRUE\n      errors.add(\"The task must be assigned to at least one user.\")\n    end\n  end\n\nend\n</code></pre>\n\n<p>Edited:</p>\n\n<pre><code>class Task &lt; ActiveRecord::Base\n  attr_accessible :title, :user1, :user2, user3, :user4\n\n  validates :title, :presence =&gt; true\n  validate :is_assigned\n\n  def is_assigned\n    unless @user1 || @user2 || @user3 || @user4\n      errors.add(:user1, \"The task must be assigned to at least one user.\")\n    end\n  end\n\nend\n</code></pre>\n\n<p>I'm getting closer I think but this does not work.  The error seems to always appear.</p>\n\n<p>Also it looks like errors.add requires another variable.  How do I give it all users instead of just user1?  </p>\n"},{"tags":["ruby-on-rails","ruby","rake"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13132226,"title":"rake task aborts on unknown attribute","body":"<p>I am running a rake task that imports data from a CSV file into my rails application.</p>\n\n<p>It succesfully imports 546 models, but then it aborts, giving the following error:</p>\n\n<pre><code>rake aborted!\nunknown attribute: \n</code></pre>\n\n<p>The csv row hash that is causing this seems fine:</p>\n\n<pre><code>{\"name\"=&gt;\"Thai \", \"address\"=&gt;\"Av. Principal de Prados del Este. C.C. Galerias Local PB-08\", \"urbanization\"=&gt;\"Prados del Este\", \"phone\"=&gt;\"02129762607\"}\n</code></pre>\n\n<p>Other hashes that were succesfully saved:</p>\n\n<pre><code>{\"name\"=&gt;\"La Propia\", \"address\"=&gt;\"Calle Los Liberales con Av. Los Samanes\", \"urbanization\"=&gt;\"El Paraiso\", \"phone\"=&gt;\"02124841571\"}\n\n{\"name\"=&gt;\"Del Canalito Natural\", \"address\"=&gt;\"Avenida Principal de Los Ruices, entre Avenida Rómulo Gallegos y Avenida Francisco de Miranda\", \"urbanization\"=&gt;\"Los Ruices\", \"phone\"=&gt;\"02122374702\"}\n</code></pre>\n\n<p>I am not entirely sure what is going on. Here is a full trace of the error:</p>\n\n<pre><code>/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/attribute_assignment.rb:88:in `block in assign_attributes'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/attribute_assignment.rb:78:in `each'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/attribute_assignment.rb:78:in `assign_attributes'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/base.rb:498:in `initialize'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/persistence.rb:44:in `new'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/persistence.rb:44:in `create'\n/Users/alexbrand/Desktop/papaya/lib/tasks/csv.rake:13:in `block (3 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1792:in `each'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1208:in `block in foreach'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1354:in `open'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1207:in `foreach'\n/Users/alexbrand/Desktop/papaya/lib/tasks/csv.rake:6:in `block (2 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/bin/rake:33:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `load'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `&lt;main&gt;'\n/usr/local/rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `eval'\n/usr/local/rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\nTasks: TOP =&gt; csv:import\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":3,"favorite_count":6,"up_vote_count":6,"down_vote_count":0,"view_count":1418,"score":6,"question_id":1253426,"title":"What is the difference between build and new on Rails?","body":"<p>Can anyone tell me what is the difference between build and new command on Rails?</p>\n"},{"tags":["ruby-on-rails","paperclip","jruby"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":113,"score":1,"question_id":12387405,"title":"Paperclip with JRuby","body":"<p>Recently I was adapting my rails app to run on JRuby.\nOne of problems that i've encountered was with Paperclip.\nPaperclip uses Cocaine to run command line tools like ImageMagick and it uses Process.spawn, which results in:</p>\n\n<pre>\nErrno::ECHILD: No child processes - No child processes\n                 waitpid at org/jruby/RubyProcess.java:512\n                 waitpid at org/jruby/RubyProcess.java:497\n                 waitpid at /home/cthulhu/.rvm/gems/jruby-1.6.7.2/gems/cocaine-0.3.0/lib/cocaine/command_line/runners/process_runner.rb:21\n                    call at /home/cthulhu/.rvm/gems/jruby-1.6.7.2/gems/cocaine-0.3.0/lib/cocaine/command_line/runners/process_runner.rb:9\n                 execute at /home/cthulhu/.rvm/gems/jruby-1.6.7.2/gems/cocaine-0.3.0/lib/cocaine/command_line.rb:77\n                     run at /home/cthulhu/.rvm/gems/jruby-1.6.7.2/gems/cocaine-0.3.0/lib/cocaine/command_line.rb:55\n                     run at /home/cthulhu/.rvm/gems/jruby-1.6.7.2/gems/paperclip-3.2.0/lib/paperclip/helpers.rb:29\n</pre>\n\n<p>Is there any way to make Paperclip work smoothly with JRuby? I'm running my app on linux only, so i don't mind using linux native tools like ImageMagick.</p>\n\n<p>Rails 3.2.8, JRuby 1.6.7.2</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13131930,"title":"Ruby on Rails: Updating data problems","body":"<p>Okay so I'm just trying to write some simple code that updates a record given an ID. This is what it looks like.</p>\n\n<pre><code>def updaterecord\n    bathroom = Bathroom.find(params[:key])\n    bathroom.name= params[:name],\n    #bathroom.bathroomtype = params[:bathroomtype],\n    bathroom.street = params[:street]\n    #bathroom.city = params[:city],\n    #bathroom.state = params[:state],\n    #bathroom.country = params[:country],\n    #bathroom.postal = params[:postal],\n    #bathroom.access = params[:access],\n    #bathroom.directions = params[:directions],\n    #bathroom.comment = params[:commment],\n    #bathroom.avail = params[:avail]\n    bathroom.save\n  end \n</code></pre>\n\n<p>The problem is that although I am trying to update each individual attribute they are all getting concatenated to the name field. For example, this code above sets the name field to the name plus the address. I don't know why?</p>\n\n<p>This is what the console looks like if I try to query after doing the update.</p>\n\n<pre><code>  Bathroom Load (0.2ms)  SELECT \"bathrooms\".* FROM \"bathrooms\" WHERE \"bathrooms\".\"ID\" = ? LIMIT 1  [[\"ID\", 4017]]\n=&gt; #&lt;Bathroom ID: 4017, name: \"--- \\n- ttyt\\n- 113 some\\n\", bathroomtype: \"0\", street: \"113 some\", city: \"Portland\", state: \"OR\", country: \"United States\", postal: \"97217\", lat: #&lt;BigDecimal:1109f2890,'0.4558056E2',12(12)&gt;, lon: #&lt;BigDecimal:1109f27c8,'-0.122677857E3',12(16)&gt;, access: \"0\", directions: \"\", comment: nil, created: \"2012-06-08 17:19:03.420329\", modifed: \"\", avail: \"1\", slug: \"\", source: \"Squat\"&gt;\n</code></pre>\n\n<p>And this is what the post values look like:</p>\n\n<pre><code>post values = key=4017&amp;name=www&amp;bathroomtype=0&amp;street=7540 N Interstate Ave&amp;city=Portland&amp;state=OR&amp;country=United States&amp;postal=97217&amp;access=0&amp;directions=&amp;comment=&lt;null&gt;&amp;avail=1\n</code></pre>\n\n<p>Why can't I get each field to update individually? Sorry I'm confused as to what is going on? </p>\n"},{"tags":["ruby-on-rails","generate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13127740,"title":"rails generate script for adding new pages?","body":"<p>Creating a new page (within an existing controller) in rails is an easy 3 step process; any way of automating this?  Creating a generate script that does the following maybe:</p>\n\n<ol>\n<li><p>add method to controller:</p>\n\n<p>def newPage\nend</p></li>\n<li><p>add route(s)</p>\n\n<p>get 'controller/newPage'\nmatch 'url' => 'controller#newPage'</p></li>\n<li><p>Create newPage.html.erb in the appropriate directory</p></li>\n</ol>\n\n<p>I'd much rather automate this with a command like: rails g controller:add newPage</p>\n\n<p>I'm not really sure where to start.  Anyone?</p>\n"},{"tags":["ruby-on-rails","ruby","single-table-inheritance"],"answer_count":6,"favorite_count":13,"up_vote_count":31,"down_vote_count":0,"view_count":3270,"score":31,"question_id":4507149,"title":"Best practices to handle routes for STI subclasses in rails","body":"<p>My Rails views and controllers are littered with <code>redirect_to</code>, <code>link_to</code>, and <code>form_for</code> method calls. Sometimes <code>link_to</code> and <code>redirect_to</code> are explicit in the paths they're linking (e.g. <code>link_to 'New Person', new_person_path</code>), but many times the paths are implicit (e.g. <code>link_to 'Show', person</code>). </p>\n\n<p>I add some single table inheritance (STI) to my model (say <code>Employee &lt; Person</code>), and all of these methods break for an instance of the subclass (say <code>Employee</code>); when rails executes <code>link_to @person</code>, it errors with <code>undefined method employee_path' for #&lt;#&lt;Class:0x000001022bcd40&gt;:0x0000010226d038&gt;</code>. Rails is looking for a route defined by the class name of the object, which is employee. These employee routes are not defined, and there is no employee controller so the actions aren't defined either.</p>\n\n<p>This question has been asked before:</p>\n\n<ol>\n<li>At <a href=\"http://stackoverflow.com/questions/1773367/link-to-issue-with-inherited-active-record-class\">StackOverflow</a>, the answer is to edit every instance of link_to etc in your entire codebase, and state the path explicitly</li>\n<li>On <a href=\"http://stackoverflow.com/questions/702728/get-route-for-base-class-of-sti-class-in-rails\">StackOverflow</a> again, two people suggest using <code>routes.rb</code> to map the subclass resources to the parent class (<code>map.resources :employees, :controller =&gt; 'people'</code>). The top answer in that same SO question suggests type-casting every instance object in the codebase using <code>.becomes</code></li>\n<li>Yet another one at <a href=\"http://stackoverflow.com/questions/4432858/broken-rails-routes-after-implementing-single-table-inheritance\">StackOverflow</a>, the top answer is way in the Do Repeat Yourself camp, and suggests creating duplicate scaffolding for every subclass.</li>\n<li><a href=\"http://stackoverflow.com/questions/943300/single-table-inheritance-routing\">Here's</a> the same question again at SO, where the top answer seems to just be wrong (Rails magic Just Works!)</li>\n<li>Elsewhere on the web, I found <a href=\"http://strugglingwithruby.blogspot.com/2008/10/single-table-inheritance.html\">this blog post</a> where F2Andy recommends editing in the path everywhere in the code.</li>\n<li>On the blog post <a href=\"http://blog.lrdesign.com/2009/03/single-table-inheritance-and-restful-routes/\">Single Table Inheritance and RESTful Routes</a> at Logical Reality Design, it is recommended to map the resources for the subclass to the superclass controller, as in SO answer number 2 above.</li>\n<li>Alex Reisner has a post <a href=\"http://code.alexreisner.com/articles/single-table-inheritance-in-rails.html\">Single Table Inheritance in Rails</a>, in which he advocates against mapping the resources of the child classes to the parent class in <code>routes.rb</code>, since that only catches routing breakages from <code>link_to</code> and <code>redirect_to</code>, but not from <code>form_for</code>. So he recommends instead adding a method to the parent class to get the subclasses to lie about their class. Sounds good, but his method gave me the error <code>undefined local variable or method `child' for #</code>.</li>\n</ol>\n\n<p>So the answer that seems most elegant and has the most consensus (but it's not all <em>that</em> elegant, nor <em>that</em> much consensus), is the add the resources to your <code>routes.rb</code>. Except this doesn't work for <code>form_for</code>. I need some clarity! To distill the choices above, my options are</p>\n\n<ol>\n<li>map the resources of the subclass to the controller of the superclass in <code>routes.rb</code> (and hope I don't need to call form_for on any subclasses)</li>\n<li>Override rails internal methods to make the classes lie to each other</li>\n<li>Edit every instance in the code where the path to an object's action is invoked implicitly or explicitly, either changing the path or type-casting the object.</li>\n</ol>\n\n<p>With all these conflicting answers, I need a ruling. It seems to me like there is no good answer. Is this a failing in rails' design? If so, is it a bug that may get fixed? Or if not, then I'm hoping someone can set me straight on this, walk me through the pros and cons of each option (or explain why that's not an option), and which one is the right answer, and why. Or is there a right answer that I'm not finding on the web?</p>\n"},{"tags":["ruby-on-rails","lua","webserver","pow"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":235,"score":1,"question_id":6246998,"title":"POW like server for Lua web development (super simple / no config)?","body":"<p>Is there is simple <strong><a href=\"http://pow.cx/\" rel=\"nofollow\">POW</a></strong> like web development environment for <strong><a href=\"http://lua.org\" rel=\"nofollow\">Lua</a></strong>?</p>\n\n<p>The idea being, with a single command (no configuration) - you have a self contained web development environment for Lua up and running in seconds.</p>\n\n<p><em>(In case you're not aware, Pow is a Ruby on Rails environment that quickly allows you to begin web development in a self contain directory)</em></p>\n"},{"tags":["ruby-on-rails","actionmailer"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":597,"score":3,"question_id":3997148,"title":"Set ActionMailer to use \"foo.fr.erb\" when I18n.locale is set to :en","body":"<p>I have this code:</p>\n\n<pre><code>class Mailer &lt; ActionMailer::Base\n\n  def foo\n    recipients \"bar@example.com\"\n    from       \"foo@example.com\"\n    subject    \"Foo\"\n    body       :var =&gt; \"value\"\n  end\n\nend\n</code></pre>\n\n<p>With two views in <code>app/views/mailer</code>:</p>\n\n<ul>\n<li><code>foo.en.erb</code></li>\n<li><code>foo.fr.erb</code></li>\n</ul>\n\n<p>When I use <code>Mailer.deliver_foo</code>, the view used to build the email is <code>foo.en.erb</code> since <code>I18n.locale</code> is set to <code>:en</code>. Is there a way to bypass that and use <code>foo.fr.erb</code>, other than temporarly setting the locale to <code>:fr</code>, sending the email and then reverting back to <code>:en</code>.</p>\n\n<p>Thank you!</p>\n"},{"tags":["ruby-on-rails","unicorn"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":115,"score":1,"question_id":12974826,"title":"How to detect and prevent spawning failing Unicorn workers","body":"<p><strong>Situation:</strong> I am using Rails + Unicorn, deploying with Capistrano. Sometimes Rails app fails to start in production mode (though it is not the real production, but a staging env). This usually happens due to errors in deploy scripts or configuration (thus usually not detectable by tests). When this happens, unicorn master process kills the worker that failed and spawns a new one, which also fails and so on and so forth. During all that time unicorn consumes lots of CPU and pollutes logs with the same message.</p>\n\n<p><strong>Manual way (not good):</strong> Go to your home page to see if it works. Look at the <code>htop</code>. Tail the logs. Kill unicorn manually. <em>Cons:</em> easy to forget. Logs are polluted, CPU is loaded while you are reacting.</p>\n\n<p><strong>Another solution:</strong> Use unicorn's <code>preload_app true</code>. This will cause master process to fail fast. <em>Cons:</em> higher memory consumption in happy scenario.</p>\n\n<p><strong>Best practice:</strong> - ???</p>\n\n<p>Is there any way to cleverly detect that unicorn master uselessly tries to spawn failing children and stop it?</p>\n"},{"tags":["ruby-on-rails","crontab","whenever"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13131627,"title":"rails whenever cron overlapping jobs","body":"<p>I have a cronjob setup to run a task every 5 minutes. But sometimes the task takes > 5 minutes to run during which another copy of that task is run by cron. Is there a way in whenever or crontab we can make it to wait for the other job to finish before running another copy?</p>\n"},{"tags":["ruby-on-rails","linux","bash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13130836,"title":"Ruby On rails : need to run /bin/bash before any rails command","body":"<p>every time I log into the server, I cannot run any rails command until I run /bin/bash ; see below</p>\n\n<pre><code>Last login: Mon Oct 29 16:28:07 2012 from natint3.company.com\nuser1@company.com [~]# rails -v\n/usr/lib64/ruby/site_ruby/1.8/rubygems.rb:926:in `report_activate_error': Could not find RubyGem rails (&gt;= 0) (Gem::LoadError)\n    from /usr/lib64/ruby/site_ruby/1.8/rubygems.rb:244:in `activate_dep'\n    from /usr/lib64/ruby/site_ruby/1.8/rubygems.rb:236:in `activate'\n    from /usr/lib64/ruby/site_ruby/1.8/rubygems.rb:1307:in `gem'\n    from /usr/bin/rails:18\nuser1@company.com [~]# rvm info\n\nruby-1.9.3-p194:\n\nsystem:\nuname:       \"Linux box726.bluehost.com 2.6.32-20120131.55.1.bh6.x86_64 #1 SMP Tue Jan 31 15:43:27 EST 2012 x86_64 x86_64 x86_64 GNU/Linux\"\nsystem:      \"unknown/libc-2.12/x86_64\"\nbash:        \"/ramdisk/bin/bash =&gt; GNU bash, version 4.1.2(1)-release (x86_64-redhat-linux-gnu)\"\nzsh:         \"/usr/bin/zsh =&gt; zsh 4.3.10 (x86_64-redhat-linux-gnu)\"\n\nrvm:\nversion:      \"rvm 1.16.17 (stable) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\"\nupdated:      \"4 hours 10 minutes 5 seconds ago\"\n\nruby:\ninterpreter:  \"ruby\"\nversion:      \"1.9.3p194\"\ndate:         \"2012-04-20\"\nplatform:     \"x86_64-linux\"\npatchlevel:   \"2012-04-20 revision 35410\"\nfull_version: \"ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]\"\n\nhomes:\ngem:          \"/home3/user1/.rvm/gems/ruby-1.9.3-p194\"\nruby:         \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194\"\n\nbinaries:\nruby:         \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\"\nirb:          \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin/irb\"\ngem:          \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin/gem\"\nrake:         \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin/rake\"\n\nenvironment:\nPATH:         \"/home3/user1/.rvm/gems/ruby-1.9.3-p194/bin:/home3/user1/.rvm/gems/ruby-1.9.3-p194@global/bin:/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin:/home3/user1/.rvm/bin:/usr/local/jdk/bin:/home3/user1/perl5/bin:/usr/lib64/qt-3.3/bin:/ramdisk/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11R6/bin:/home3/user1//ruby/gems/bin:/home3/user1//ruby/gems:/home3/user1/bin\"\nGEM_HOME:     \"/home3/user1/.rvm/gems/ruby-1.9.3-p194\"\nGEM_PATH:     \"/home3/user1/.rvm/gems/ruby-1.9.3-p194:/home3/user1/.rvm/gems/ruby-1.9.3-p194@global\"\nMY_RUBY_HOME: \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194\"\nIRBRC:        \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/.irbrc\"\nRUBYOPT:      \"\"\ngemset:       \"\"\n\n\nuser1@company.com [~]#\n</code></pre>\n\n<p>and after I run /bin/bash, I have a different behavior</p>\n\n<pre><code>user1@company.com [~]# /bin/bash\nuser1@company.com [~]# rails -v\nRails 3.2.8\nuser1@company.com [~]# rvm info\n\nRVM is not a function, selecting rubies with 'rvm use ...' will not work.\n\nYou need to change your terminal emulator preferences to allow login shell.\nSometimes it is required to use `/bin/bash --login` as the command.\nPlease visit https://rvm.io/integration/gnome-terminal/ for a example.\n\n\nsystem:\n\nsystem:\nuname:       \"Linux box726.bluehost.com 2.6.32-20120131.55.1.bh6.x86_64 #1 SMP Tue Jan 31 15:43:27 EST 2012 x86_64 x86_64 x86_64 GNU/Linux\"\nsystem:      \"unknown/libc-2.12/x86_64\"\nbash:        \"/ramdisk/bin/bash =&gt; GNU bash, version 4.1.2(1)-release (x86_64-redhat-linux-gnu)\"\nzsh:         \"/usr/bin/zsh =&gt; zsh 4.3.10 (x86_64-redhat-linux-gnu)\"\n\nrvm:\nversion:      \"rvm 1.16.17 (stable) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\"\nupdated:      \"4 hours 11 minutes 9 seconds ago\"\n\nhomes:\ngem:          \"/home3/user1//ruby/gems\"\nruby:         \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194\"\n\nbinaries:\nruby:         \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\"\nirb:          \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin/irb\"\ngem:          \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin/gem\"\nrake:         \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin/rake\"\n\nenvironment:\nPATH:         \"/usr/local/jdk/bin:/home3/user1/.rvm/gems/ruby-1.9.3-p194/bin:/home3/user1/.rvm/gems/ruby-1.9.3-p194@global/bin:/home3/user1/.rvm/rubies/ruby-1.9.3-p194/bin:/home3/user1/.rvm/bin:/home3/user1/perl5/bin:/usr/lib64/qt-3.3/bin:/ramdisk/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11R6/bin:/home3/user1//ruby/gems/bin:/home3/user1//ruby/gems:/home3/user1/bin\"\nGEM_HOME:     \"/home3/user1//ruby/gems\"\nGEM_PATH:     \"/home3/user1//ruby/gems:/usr/lib64/ruby/gems/1.8\"\nMY_RUBY_HOME: \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194\"\nIRBRC:        \"/home3/user1/.rvm/rubies/ruby-1.9.3-p194/.irbrc\"\nRUBYOPT:      \"\"\ngemset:       \"\"\n\n\nuser1@company.com [~]#\n</code></pre>\n\n<p>Anyone has an idea what's going on and how can I fix this issue?</p>\n\n<p>Thanks</p>\n\n<p>EDIT1</p>\n\n<p>Here are my .bashrc and .bash_profile file contents</p>\n\n<pre><code>user1@company.com [~]# cat ~/.bashrc\n# .bashrc\n\n# User specific aliases and functions\n\n# Source global definitions\nif [ -f /etc/bashrc ]; then\n    . /etc/bashrc\nfi\n\n    export HPATH=/home3/user1/\n    export GEM_HOME=$HPATH/ruby/gems\n    export GEM_PATH=$GEM_HOME:/usr/lib64/ruby/gems/1.8\n    export GEM_CACHE=$GEM_HOME/cache\n    export PATH=$PATH:$HPATH/ruby/gems/bin\n    export PATH=$PATH:$HPATH/ruby/gems  \n\nPATH=$PATH:/home3/user1/.rvm/bin # Add RVM to PATH for scripting\n\nPATH=$PATH:$HOME/.rvm/bin # Add RVM to PATH for scripting\nuser1@company.com [~]# cat ~/.bash_profile \n# .bash_profile\n\n# Get the aliases and functions\nif [ -f ~/.bashrc ]; then\n    . ~/.bashrc\nfi\n\n# User specific environment and startup programs\n\nPATH=$PATH:$HOME/bin\n\nexport PATH\nunset USERNAME\n\n\n[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\" # Load RVM into a shell session *as a function*\nuser1@company.com [~]#\n</code></pre>\n"},{"tags":["ruby-on-rails","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13129683,"title":"Encoding image data as UTF-8 string with gzip compression","body":"<p>I am trying to store image data from a file into a PostgreSQL database as a base64 string that is compressed by gzip to save space. I am using the following code to encode the image:</p>\n\n<pre><code>@file = File.open(\"#{Rails.root.to_s}/public/\" &lt;&lt; @ad_object.image_url).read\n@base64 = Base64.encode64(@file)\n@compressed = ActiveSupport::Gzip.compress(@base64)\n@compressed.force_encoding('UTF-8')\n@ad_object.imageData = @compressed\n</code></pre>\n\n<p>When I try to save the object, I get the following error:</p>\n\n<pre><code>ActiveRecord::StatementInvalid (PG::Error: ERROR:  invalid byte sequence for encoding \"UTF8\": 0x8b\n</code></pre>\n\n<p>In the rails console, any gzip compression is outputting the data as ASCII 8-BIT encoding. I have tried to set my internal and external encodings to UTF-8 but the results have not changed. How can I get this compressed data into a UTF-8 string?</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","delayed-job"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":256,"score":3,"question_id":10438100,"title":"Long running delayed_job jobs stay locked after a restart on Heroku","body":"<p>When a Heroku worker is restarted (either on command or as the result of a deploy), Heroku sends <code>SIGTERM</code> to the worker process. In the case of <code>delayed_job</code>, the <code>SIGTERM</code> <a href=\"https://github.com/collectiveidea/delayed_job/blob/master/lib/delayed/worker.rb#L125\" rel=\"nofollow\">signal is caught</a> and then the worker stops executing after the current job (if any) has stopped. </p>\n\n<p>If the worker takes to long to finish, then Heroku will send <code>SIGKILL</code>. In the case of <code>delayed_job</code>, this leaves a locked job in the database that won't get picked up by another worker.</p>\n\n<p>I'd like to ensure that jobs eventually finish (unless there's an error). Given that, what's the best way to approach this? </p>\n\n<p>I see two options. But I'd like to get other input:</p>\n\n<ol>\n<li>Modify <code>delayed_job</code> to stop working on the current job (and release the lock) when it receives a <code>SIGTERM</code>.</li>\n<li>Figure out a (programmatic) way to detect orphaned locked jobs and then unlock them.</li>\n</ol>\n\n<p>Any thoughts?</p>\n"},{"tags":["ruby-on-rails","ruby","operators","equals-operator"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":8,"view_count":59,"score":-7,"question_id":13131451,"title":"Is ||= a valid ruby operator? If so what is it supposed to do?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/995593/what-does-or-equals-mean-in-ruby\">What does ||= (or equals) mean in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>I am working on a RoR project that someone else in another country built. I have a fairly decent grasp of the rails framework, having built several small apps. I came across this line in the code because I found it weird that they were using @logged_in_user and logged_in_user intermittently through the views.</p>\n\n<p>Knowing that instance variables are how to pass variables from controllers to views I was a little confused why in some parts they called the var without the @ symbol. Then I grepped the project to find that they had defined a method with that name, in the application_controller.</p>\n\n<pre><code>def logged_in_user\n    @logged_in_user ||= (session[:user_id] ? User.find(session[:user_id]) : nil)\nend\n</code></pre>\n\n<p>I get that the part on the right of the equals sign is a ternary operator that checks if there is a user_id for the session if there is it returns the user object, if not it returns nil.</p>\n\n<p>What I don't understand is what the ||= is supposed to mean, or be doing. I have never seen an 'or' operator before an equals sign and I couldn't find any ruby references to it when I searched online. If anyone could give me some insight as to what the purpose of this is, and if it is necessary, I would greatly appreciate it. </p>\n\n<p>Thanks for reading.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid","eager-loading"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12807228,"title":"Correctly eager loading empty array being ignored","body":"<p>I have a many-to-one relationship <code>images</code> on my <code>vehicle</code> model. I have set up a query similar to <code>Vehicle.includes(:images).find(ids)</code> Several, correctly, have an empty array loaded since these <code>vehicles</code> have no images. However, it goes back to the Mongo server, trying to find out if there are any images. The identity map is enabled and all that jazz. Eager loading seems to work for non-empty arrays.</p>\n\n<p>How would I signal to Mongoid that the empty array is correct and not to try and load them again?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13127206,"title":"Ensuring at least one item in an array exists in another","body":"<p>I have the following models:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n    has_and_belongs_to_many :countries\nend\n\nclass User &lt; ActiveRecord::Base \n    has_many :entitlements\n    has_many :countries, :through =&gt; :entitlements\nend\n</code></pre>\n\n<p>Posts on the Post index page must have at least one country that is the same as one of the Users' countries.</p>\n\n<p>I have tried various scopes in my models and lengthy controller code but I can't figure out how to check what should be a simple relationship: whether at least one item in Post.countries exists in User.countries.</p>\n\n<p>Any help greatly received.</p>\n\n<p><strong>UPDATED:</strong></p>\n\n<p>Ok, so I've got the following in my controller:</p>\n\n<pre><code>  def index\n    @user = current_user\n    @user.countries.each do |user_country|  \n       @user_country_posts += Country.find(user_country.id).posts\n    end\n    @posts = @user_country_posts\n  end\n</code></pre>\n\n<p>Which is iterating through the user.countries and finding each post for those countries. But when I run it I get:</p>\n\n<pre><code>NoMethodError: undefined method `+' for nil:NilClass\n</code></pre>\n\n<p>Any ideas what I'm doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":962,"score":3,"question_id":6009062,"title":"Remove test::unit","body":"<p>I forgot to create my application with the -T argument and now it's installed with test::unit. How do I remove test::unit and stop it from creating tests for each controller / model generated, after I have already created the application? Thank you</p>\n"},{"tags":["ruby-on-rails","ajax","will-paginate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13116438,"title":"Rails: Will_paginate does not work properly after AJAX call","body":"<p>Sorry about the repetition, I could not find the answers to my questions after a lot of searches. The will_paginate does not work after the <code>Ajax</code> call. </p>\n\n<ol>\n<li>After delete action, It does not display the pages numbers at all (it simply returns  all results).</li>\n<li>After search action, the page number does not update, it shows more pages than what should actually be there.</li>\n</ol>\n\n<p>Here is the controller code. </p>\n\n<pre><code>class CitiesController &lt; ApplicationController\n\n def index\n     @cities = City.get_cities(params[:city_name],params[:city_population]).paginate(:page =&gt; params[:page])\n  respond_to do |format|\n    format.html \n    format.js\n  end\n\n end\n\n def create\n      @city = City.new(params[:city])\n\n  if @city.save\n       flash[:success] = \"City information saved successfully\"\n\n       redirect_to cities_path\n    else\n        render 'index'\n    end\n end\n\n\ndef new\n    @city = City.new\nend\n\n\n def destroy\n   @city = City.find(params[:id]).destroy\n   @city.destroy\n   @cities = City.all\n   respond_to do |format|\n      format.html {redirect_to cities_path}\n      format.js\n    end\n  end\n\n end\n</code></pre>\n\n<p>Here is the index view:</p>\n\n<pre><code> &lt;div class=\"row\"&gt;\n&lt;h1&gt;Search Cities or &lt;%= link_to \"Create New City\", new_city_path %&gt;&lt;/h1&gt;\n&lt;h3&gt;99 random city information are generated in the database &lt;/h2&gt;\n&lt;h3&gt;Simply type any letter or city population between 0 and 10 to filter out&lt;/h3&gt;\n&lt;%= form_tag \"/cities/index\", method: :get, remote: true do %&gt;\n  &lt;%= label_tag(:q, \"City Name:\") %&gt;\n  &lt;%= text_field_tag 'city_name' %&gt;\n  &lt;%= label_tag(:q, \"City Population greater than, in units of 1 million:\") %&gt;\n  &lt;%= text_field_tag 'city_population' %&gt;\n  &lt;label&gt;&lt;/label&gt;\n  &lt;%= button_tag(\"Search\", :class =&gt; \"btn\") %&gt;\n&lt;% end %&gt;\n&lt;% flash.each do |key, value| %&gt;\n   &lt;div class=\"alert alert-&lt;%= key %&gt;\"&gt;&lt;%= value %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n\n\n&lt;div id='table' class=\"table table-striped\"&gt;\n    &lt;%= render 'table' %&gt; \n&lt;/div&gt;\n\n\n&lt;%=will_paginate @cities %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p>Here is the partial view of the table:</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n&lt;h1&gt;Enter City descriptions or &lt;%= link_to \"Search Cities\", cities_path %&gt;&lt;/h1&gt;\n&lt;%= form_for @city, html: {multipart: true} do |f| %&gt;\n\n&lt;%= f.label :city_name %&gt;\n&lt;%= f.text_field :city_name %&gt;\n\n&lt;%= f.label :city_description %&gt;\n&lt;%= f.text_field :city_description %&gt;\n\n&lt;%= f.label :city_population_in_units_of_millions %&gt; \n&lt;%= f.text_field :city_population %&gt;\n&lt;label&gt;&lt;/label&gt;\n\n&lt;%= f.file_field :image%&gt;\n\n&lt;label&gt;&lt;/label&gt;\n&lt;%= f.submit \"Create new City\", :class =&gt; \"btn\"%&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n\nFinally two js.erb codes associated with index and delete actions:\n\nindex.js.erb:\n\n$('#table').html('&lt;%= escape_javascript(render('table')) %&gt;');\n\ndestroy.js.erb:\n\n$('#table').html('&lt;%= escape_javascript(render('table')) %&gt;');\n</code></pre>\n"},{"tags":["ruby-on-rails","backbone.js","coffeescript","railscasts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13130719,"title":"backbonejs and rails 3.2","body":"<p>I just watched the backbone.js railscasts and Im not getting the error alert when the name is not present but do get an error on the server side.</p>\n\n<p>im using rails 3.2.8 and backbone-on-rails 0.9.2.3</p>\n\n<p>In the network console it does state that theres an error with the api/entries, and in the response theres the errors key, but still no alert when I click add with nothing on the form.</p>\n\n<p>This is my code... please help me figure out what could be wrong!</p>\n\n<pre><code>class Raffler.Views.EntriesIndex extends Backbone.View\n\n  template: JST['entries/index']\n\n  events:\n    'submit #new_entry': 'createEntry'\n    'click #draw': 'drawWinner'\n\n  initialize: -&gt;\n    @collection.on('reset', @render)\n    @collection.on('add', @appendEntry)\n\n  render: =&gt;\n    $(@el).html(@template())\n    @collection.each(@appendEntry)\n    this\n\n  appendEntry: (entry) =&gt;\n    view = new Raffler.Views.Entry(model: entry)\n    @$('#entries').append(view.render().el)\n\n  drawWinner: (event) -&gt;\n    event.preventDefault()\n    @collection.drawWinner()\n\n  createEntry: (event) -&gt;\n    event.preventDefault()\n    attributes = name: $('#new_entry_name').val()\n    @collection.create attributes,\n      wait: true\n      success: -&gt; $('#new_entry')[0].reset()\n      error: @handleError\n\n    handleError: (entry, response) -&gt;\n      if response.status == 422\n        errors = $.parseJSON(response.responseText).errors\n        for attribute, messages of errors\n          alert \"#{attribute} #{message}\" for message in messages\n</code></pre>\n\n<p>Thank you!</p>\n"},{"tags":["ruby-on-rails","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":10079563,"title":"get original url during signin","body":"<p>When a user who isn't signed in hits a url, devise will forward them to the sign-in page, after which it will forward the user on to their original page.  How can I access this information (the original route/action) in the sign-in view?  I'd like to show the gui differently depending on where the user is going.</p>\n"},{"tags":["ruby-on-rails","amazon-web-services","fog","dragonfly-gem"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13094804,"title":"Strange Timestamp issues using aws s3 with rails","body":"<p>I am using Dragonfly (https://github.com/markevans/dragonfly) for some image manipulation on a project and that uses fog as a data storage engine. I recently started getting weird Amazon errors on requests. The main errors are </p>\n\n<pre><code>AWS authentication requires a valid Date or x-amz-date header\n</code></pre>\n\n<p>and </p>\n\n<pre><code>The difference between the request time and the current time is too large.\n</code></pre>\n\n<p>This works fine on all my other machines, just on one development machine. Its running Mac OSX with Ruby 1.9 and Rails 3.0.10, the timestamps is fine on the machine. The header seems to be coming in as epoch time for some reason...</p>\n\n<p>Full errors:</p>\n\n<pre><code>Excon::Errors::Forbidden (Expected(200) &lt;=&gt; Actual(403 Forbidden)\n  request =&gt; {:connect_timeout=&gt;60, \n  :headers=&gt;{\"Date\"=&gt;\"Wed, 31 Dec 1969 23:59:59 +0000\", \"Authorization\"=&gt;\"AWS AUTHKEY\", \"Host\"=&gt;\"my-development.s3.amazonaws.com:443\"}, :instrumentor_name=&gt;\"excon\", :mock=&gt;false, :nonblock=&gt;true, :read_timeout=&gt;60, :retry_limit=&gt;4, :ssl_ca_file=&gt;\"/Users/temp/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.16.2/data/cacert.pem\", :ssl_verify_peer=&gt;true, :write_timeout=&gt;60, :host=&gt;\"my-development.s3.amazonaws.com\", :path=&gt;\"/\", :port=&gt;\"443\", :query=&gt;{}, :scheme=&gt;\"https\", :expects=&gt;200, :idempotent=&gt;true, :method=&gt;\"GET\", :response_block=&gt;#&lt;Proc:0x007fe4c3cc51f0@/Users/temp/.rvm/gems/ruby-1.9.2-p180/gems/fog-1.5.0/lib/fog/core/connection.rb:16 (lambda)&gt;}\n  response =&gt; #&lt;Excon::Response:0x007fe4c3c77a18 @body=\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n&lt;Error&gt;&lt;Code&gt;AccessDenied&lt;/Code&gt;&lt;Message&gt;AWS authentication requires a valid Date or x-amz-date header&lt;/Message&gt;&lt;RequestId&gt;AF3S5E9BAA514F1&lt;/RequestId&gt;&lt;HostId&gt;SOMETHING&lt;/HostId&gt;&lt;/Error&gt;\", @headers={\"x-amz-request-id\"=&gt;\"AF3S5E9BAA514F1\", \"x-amz-id-2\"=&gt;\"SOMETHING\", \"Content-Type\"=&gt;\"application/xml\", \"Transfer-Encoding\"=&gt;\"chunked\", \"Date\"=&gt;\"Thu, 25 Oct 2012 19:03:39 GMT\", \"Server\"=&gt;\"AmazonS3\"}, @status=403&gt;):\n\n\nERROR Excon::Errors::Forbidden: Expected([200, 206]) &lt;=&gt; Actual(403 Forbidden)   request =&gt; {:connect_timeout=&gt;60, \n:headers=&gt;{\"Date\"=&gt;\"Thu, 01 Jan 1970 00:00:01 +0000\", \"Authorization\"=&gt;\"AWS AUTHKEY\", \"Host\"=&gt;\"my-development.s3.amazonaws.com:443\"}, :instrumentor_name=&gt;\"excon\", :mock=&gt;false, :nonblock=&gt;true, :read_timeout=&gt;60, :retry_limit=&gt;4, :ssl_ca_file=&gt;\"/Users/temp/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.16.2/data/cacert.pem\", :ssl_verify_peer=&gt;true, :write_timeout=&gt;60, :host=&gt;\"my-development.s3.amazonaws.com\", :path=&gt;\"/2012%2F10%2F18%2F19%2F32%2F28%2F836%2Fdragonfly20121018_47202_2lm4t0\", :port=&gt;\"443\", :query=&gt;nil, :scheme=&gt;\"https\", :expects=&gt;[200, 206], :idempotent=&gt;true, :method=&gt;\"GET\"}   response =&gt;\n#&lt;Excon::Response:0x007fd11e048ea8 @body=\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n&lt;Error&gt;&lt;Code&gt;RequestTimeTooSkewed&lt;/Code&gt;&lt;Message&gt;The difference between the request time and the current time is too large.&lt;/Message&gt;&lt;MaxAllowedSkewMilliseconds&gt;900000&lt;/MaxAllowedSkewMilliseconds&gt;&lt;RequestId&gt;85D12B885D8B4DBE&lt;/RequestId&gt;&lt;HostId&gt;&lt;/HostId&gt;&lt;RequestTime&gt;Thu, 01 Jan 1970 00:00:01\n+0000&lt;/RequestTime&gt;&lt;ServerTime&gt;2012-10-26T21:19:18Z&lt;/ServerTime&gt;&lt;/Error&gt;\", @headers={\"x-amz-request-id\"=&gt;\"85D12B885D8B4DBE\", \"x-amz-id-2\"=&gt;\"SOMETHING\", \"Content-Type\"=&gt;\"application/xml\", \"Transfer-Encoding\"=&gt;\"chunked\", \"Date\"=&gt;\"Fri, 26 Oct 2012 21:19:16 GMT\", \"Server\"=&gt;\"AmazonS3\"}, @status=403&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13129455,"title":"Rails: Where to start? <Big City Without a Roadmap>","body":"<p>So, I'm still a young developer, but I am trying to endeavour into Rails and server side development. Up until now, I have only ever worked on native application programming (iOS, OSX, JAVA (.jar), etc.).</p>\n\n<p>I jumped into a few Ruby tutorials and then Rails tutorials. I found it straightforward to go through the Ruby tutorials as Ruby has an awesome syntax, but when I jumped into the Rails tutorials, most of it assumed having knowledge about HTML (I have a basic understanding, but not much that I can credit) and other web components. It felt overwhelming, however I was fine to go through just understanding the rails part of the tutorial.</p>\n\n<p>All this being said, I don't know what to do to continue learning rails from here on out. I feel like I'm in a huge city without a good roadmap, so I am trying to ask the pedestrians/cityfolk (you guys!) what I should be doing now.</p>\n\n<p>I would love to be able to just write up rails applications without having to build a website along with it (just simple API calls for some of my applications even). However, everything about this is foreign to me and I would just like to know where I need to go from here.</p>\n\n<p>If this isn't the right place to ask a question like this, I'm sorry! Hopefully someone can direct me to an appropriate site, if thats the case.</p>\n\n<p>Any help or suggestions would be greatly appreciated!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have provided an answer myself that I believe to be a solid solution to my own problem. If people could let me know the validity and worthiness of my answer, it would be greatly appreciated. I would like to accept the best possible answer to help any beginner web developers looking to learn Rails, like myself.</p>\n"},{"tags":["ruby-on-rails","sms","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1622,"score":1,"question_id":4652755,"title":"send free sms from rails app","body":"<p>How can i send free sms to US numbers from a rails app. </p>\n\n<p>Is <a href=\"https://github.com/brendanlim/sms-fu\" rel=\"nofollow\">sms_fu</a> working with rails 3?</p>\n\n<p>Its not working for me :--\nAfter installing the gem.</p>\n\n<p>Steps:-\nSpecified this in my environment file</p>\n\n<pre><code> 1. sms_fu = SMSFu::Client.configure(:delivery =&gt; :action_mailer)\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>2.sms_fu.deliver(\"5558675309\",\"at&amp;t\",\"message\") is not working\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","osx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13129536,"title":"Cannot install rails on mac","body":"<p>I've been trying to install rails on my macbook, and have been having so much difficulty!\nI installed RVM, and when I run \"gem install rails,\" I get this message: </p>\n\n<pre><code>gem install rails\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.\n\n    /Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/bin/ruby extconf.rb\ncreating Makefile\n\nmake\n/usr/bin/gcc-4.2 -I. -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1/x86_64-darwin11.4.0 -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1/ruby/backward -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1 -I. -DJSON_GENERATOR -I/Users/mpapis/.rvm/usr/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common -I/opt/sm/pkg/active/include -fno-common -pipe -O3 -Wall -O0 -ggdb  -o generator.o -c generator.c\n/usr/bin/gcc-4.2 -dynamic -bundle -o generator.bundle generator.o -L. -L/Users/mpapis/.rvm/rubies/ruby-1.9.2-p320/lib -L/Users/mpapis/.rvm/usr/lib -L. -L/opt/sm/pkg/active/lib -L/usr/local/lib -Wl,-undefined,dynamic_lookup -Wl,-multiply_defined,suppress -Wl,-flat_namespace  -lruby.1.9.1  -lpthread -ldl -lobjc \nld: warning: directory not found for option '-L/Users/mpapis/.rvm/rubies/ruby-1.9.2-p320/lib'\nld: warning: directory not found for option '-L/Users/mpapis/.rvm/usr/lib'\nld: warning: directory not found for option '-L/opt/sm/pkg/active/lib'\nld: library not found for -lruby.1.9.1\ncollect2: ld returned 1 exit status\nmake: *** [generator.bundle] Error 1\n</code></pre>\n\n<p>I've tried googling solutions, but haven't found anything. Does anyone have ideas? Thanks!</p>\n"},{"tags":["ruby-on-rails","caching","redis"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":9471684,"title":"handling redis maxmemory situations with rails when using rails caching","body":"<p>When redis hits a 'maxmemory' condition, it will let the client do a read, but not a write. </p>\n\n<p>This results in a fatal error of course... is there any way to make Rails handle a cache read OR write error, so if something bad happens to the cache (availability, read, write, etc), it will continue to run as if if caching was set to \"off\"?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13129951,"title":"How can I access rails methods in a ruby script?","body":"<p>I have a ruby script in my rails app in the script directory. How can I access the <code>in_time_zone</code> method in the script?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":4,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":1997,"score":7,"question_id":3796119,"title":"Ruby on Rails Net::HTTP use_ssl throws 'undefined method'","body":"<p>Here's my code:</p>\n\n<pre><code>sock = Net::HTTP.new(url.host, url.port)\nsock.use_ssl = true\nresponse = sock.start {|http| http.request(req)}\n</code></pre>\n\n<p>here's the error:</p>\n\n<pre><code>undefined method `use_ssl=' for #&lt;Net::HTTP www.paypal.com:443 open=false&gt;\n</code></pre>\n\n<p>google is getting me nothing!</p>\n\n<p>thanks.</p>\n"},{"tags":["ruby-on-rails","clone","sequel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13129513,"title":"Clone Sequel Model","body":"<p>I have a Model representing a Pricing Table with lots of entries and i want to offer the possibility to create a new Pricing with values from an existing entry. </p>\n\n<p>Does anyone know how to do this, then Sequel is in use?</p>\n\n<p>I tried dup and clone but in both cases the id is still there from the existing Model and thus will update the existing entry.</p>\n\n<p>If i try to set the id by hand i get following error:</p>\n\n<pre><code>Sequel::InvalidValue: nil/NULL is not allowed for the id column\n</code></pre>\n\n<p>So i need a to find a Way to create a Model which is new but has prefilled values without having them to set in the code by hand. </p>\n\n<p>Any ideas? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","encoding","chardet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13129852,"title":"How do i encode files for rails 3?","body":"<p>I've been working on outlook imports (linked in exports to outlook format) but I'm having  troubles with encoding. The outlook format CSV i get from exporting my linkedin contacts are not in UTF-8 so letters like ñ are causing an exception in the mongoid_search gem when str.to_s.mb_chars.normalize is being called. I've deduced that this is because when a string is returned by mb_chars (when ruby 1.9 is used as per the docs: <a href=\"http://apidock.com/rails/String/mb_chars\" rel=\"nofollow\">http://apidock.com/rails/String/mb_chars</a> just below first code example). I guess this is a bug in the gem but regardless i am advised to sanitize the data no matter. My implementation(s) thus far:</p>\n\n<p>File Picker using their new community supported gem to upload csv. I tried three encoding detectors ( and transcoders):</p>\n\n<p>ruby port of a python lib chardet - basically sucked, had python code leftover that prevented it from even running in my app</p>\n\n<p>rchardet19 gem - detected iso-8859 with .8/1 confidence. I then tried to transcode with Iconv. Crashed on \"illegal characters\" at a ñ</p>\n\n<p>a gem Charlock_Holmes (https://github.com/brianmario/charlock_holmes). This detected windows-1252 with 33/100 confidence (i assume thats what is actually is and rchardet got iso-8859 because this ones based of that). This gem uses ICU and has a maintained branch \"bundle-icu\" which supposedly allows it to work on heroku. When i try to transcode using charlock, i get a U_FILE_ACCESS_ERROR. It is a icu error code meaning \"could not open file\" </p>\n\n<p>Anybody know what to do here?</p>\n"},{"tags":["ruby-on-rails","rspec","tdd","rubymine","guard"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":535,"score":5,"question_id":11996124,"title":"Is it impossible to use Guard with RubyMine?","body":"<p>For some inexplicable reason, RubyMine autosaves every change you make and so every key stroke will trigger Guard to run your tests!  And the most ridiculous thing is that there's apparently no way to disable this autosaving \"feature\".  I'm just wondering, RubyMine seems to be a very popular editor among Rails developers and Guard seems to be an indispensable tool used to automate testing.  Since Guard is impossible to use reasonably with RubyMine, how do people deal with automating their tests with RubyMine? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13124575,"title":"How to maintain an order on child records when using Rails' accepts_nested_attributes_for feature?","body":"<p>I am using Rails' nifty <code>accepts_nested_attributes_for</code> for creating <code>invoices</code> and their <code>items</code>. <code>Items</code> can be added dynamically to an <code>invoice</code> with jQuery.</p>\n\n<pre><code>class Invoice &lt; ActiveRecord::Base\n  attr_accessible :project_id, :number, :date, :recipient, :items_attributes\n  accepts_nested_attributes_for :items\nend\n</code></pre>\n\n<p>This works fine. Except for the <strong>order</strong> in which Rails saves the <code>items</code>.</p>\n\n<p>For example when I create an <code>invoice</code> with these 5 <code>items</code>...</p>\n\n<pre><code>A\nB\nC\nD\nE\n</code></pre>\n\n<p>... everything works fine. But when I then hit <code>Create</code> to save the invoice plus items to the database, the order is completely randomised, for example like this:</p>\n\n<pre><code>D\nA\nC\nE\nB\n</code></pre>\n\n<p>A peek into my database and the <code>created_at</code> column of my <code>items</code> table revealed that Rails (or SQLite?) seemingly saves the <code>items</code> in a random order and not in the order in which I (as a user) added them to the <code>invoice</code>.</p>\n\n<p>Is this normal behaviour and if so how can I maintain a proper ordering on the <code>items</code> that I add to my <code>invoice</code>?</p>\n\n<p>Thanks for any help...</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13129752,"title":"How can I allow multiple Date formats in Ruby on Rails for csv file import?","body":"<p>I have a birthday column in my csv that should allow user to input <strong>multiple date formats</strong> and then the file be imported via web page. At the moment the column is only set to one type of format; <code>:birthday =&gt; (Date.strptime(row[2], \"%mm/%dd/%YY\") rescue nil),</code>.\nIs it possible to have multiple date formats?\nThanks!</p>\n"},{"tags":["mysql","ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13129548,"title":"Counting Date Columns in Rails","body":"<p>I'm getting stuck on how to count a date. I have 3 different columns: \ndemodate1, demodate2, demodate3</p>\n\n<p>If demodate1 exists I want to count it as 1, if demodate 2 exists, I want to count it as 1, if demodate3 exists I want to count it as 1. If more than 1 of those exist I want to add them all together.</p>\n\n<p>How can I do this?</p>\n\n<p>Here's my try at the code:</p>\n\n<pre><code>      def demosheld\n        if demodate1.present? or demodate2.present? or demodate3.present?\n          demodate1.count + demodate2.count + demodate3.count\n        end   \n      end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","declarative-authorization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13113094,"title":"Why the :attribute_check in Declarative_Authorization don't found ID's","body":"<p>I have a problem since many days with Declarative_Authorization on Ruby on Rails 3.1.\nI add this on the top of each controller :</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n    # Verifies that the user is connected and/or authorized to access the methods\n    filter_access_to :all, :attribute_check =&gt; true\n\n    (...)\nend\n</code></pre>\n\n<p>It allows me to have this on my <code>authorization_rules.rb</code>:</p>\n\n<pre><code>has_permission_on [:albums], :to =&gt; [:adding] do\n    if_attribute :group =&gt; { :user =&gt; is { user } }\nend\n</code></pre>\n\n<p>But when I add <code>:attribute_check =&gt; true</code> I get this error :</p>\n\n<pre><code>Couldn't find {Model} without an ID\n</code></pre>\n\n<p>I'm totally lost, I was starting with this gem.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13129507,"title":"Wrapping minitest test blocks","body":"<p>I'm using minitest with rails 3.2. I want to define my own \"test\" function that does some special stuff, then proceeds as normal.</p>\n\n<p>Normally, you define tests like this:</p>\n\n<pre><code>class MyControllertest &lt; ActionController::TestCase                        \n  test \"should note have defined x\" do\n    assert(!(defined? x))\n    get :index\n    assert_response :success\n  end\nend\n</code></pre>\n\n<p>I would like to be able to do the following</p>\n\n<pre><code>class MyControllerTest &lt; ActionController::TestCase                        \n  special_test \"should define X\" do\n    assert(defined? x)\n    get :index\n    assert_response :success\n  end\nend\n</code></pre>\n\n<p>So, I tried the following in a test helper that I include</p>\n\n<pre><code>class ActiveSupport::TestCase    \n  def self.special_test(name)                                                                                                                                                    \n    self.test(name) do                                                                                                                                                           \n      x=1\n      yield                                                                                                                                                                     \n    end                                                                                                                                                                            \n  end    \nend                                                                                                                                                \n</code></pre>\n\n<p>But, I get </p>\n\n<pre><code>undefined method `get' for MyControllerTest:Class\n</code></pre>\n\n<p>Can someone help teach me a little about metaprogramming / how to go about this?  </p>\n\n<p><a href=\"https://github.com/seattlerb/minitest\" rel=\"nofollow\">https://github.com/seattlerb/minitest</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paperclip","production-environment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":1340,"score":-1,"question_id":6904797,"title":"Paperclip in production mode","body":"<p>I am successfully running my Ruby on Rails 3.0.9 application in production mode on a <a href=\"http://www.linode.com/\" rel=\"nofollow\">Linode</a> VPS. The only problem that I have is related to the Paperclip gem: it works in development mode on my local machine (this has Mac Os, Snow Leopard) but it doesn't work on the remote machine in production mode (this has Ubuntu 10.04 LTS).</p>\n\n<p>I made some research on the net and I tried to solve that problem following <a href=\"http://stackoverflow.com/questions/1635840/probem-with-paperclip-accepting-jpg-and-png-on-production\">this solution</a>:</p>\n\n<blockquote>\n  <p>On your production server, try running:</p>\n  \n  <p>which identify</p>\n  \n  <p>...</p>\n  \n  <p>If it returns something like \"/usr/bin/identify\", then you'll want to\n  set the Paperclip options in your production.rb environment file to:</p>\n  \n  <p>Paperclip.options[:command_path] = \"/usr/bin\"</p>\n</blockquote>\n\n<p>Since I get the <code>/usr/bin/identify</code>, in my environment files I have the following scenario:</p>\n\n<pre><code># `config/environments/development.rb`\nPaperclip.options[:command_path] = \"/usr/local/bin\"\n\n# `config/environments/production.rb`\nPaperclip.options[:command_path] = \"/usr/bin\"\n</code></pre>\n\n<p>Anyway in production mode Paperclip doesn't work. In development it works.</p>\n\n<p><strong>How can I solve the problem?</strong></p>\n\n<hr>\n\n<p>Following are some output:</p>\n\n<pre><code>&gt;&gt; $ &lt;project_name&gt; bundle show paperclip\n=&gt; /usr/local/lib/ruby/gems/1.9.1/gems/paperclip-2.3.16\n</code></pre>\n"},{"tags":["ruby-on-rails","has-many","self-join","nomethoderror"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13128529,"title":"Rails associations with self joining class","body":"<p>I doing a rails project where I'm using a self joining one-to-many setup.</p>\n\n<p>I have a class called User, which has many customers.\nEach customer has many order lists, like this:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :customers, class_name: 'User', foreign_key: 'owner_id'\n  belongs_to :owner, class_name: 'User'\n  has_many :order_lists, dependent: :destroy\n</code></pre>\n\n<p>Now when I opened my rails console. I tried to do this:</p>\n\n<pre><code>user.customers.order_lists\n</code></pre>\n\n<p>I got this:</p>\n\n<pre><code>NoMethodError: undefined method `order_lists'\n</code></pre>\n\n<p>While when I try to do this:</p>\n\n<pre><code>user.customers.first.order_lists\n</code></pre>\n\n<p>I do receive the order lists of that customer.\nBut how could I recieve all the orderlists of all my customers?</p>\n\n<p>Anybody an idea?</p>\n"},{"tags":["css","ruby-on-rails","ruby","api","twitter"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":61,"score":0,"question_id":13099615,"title":"Custom Twitter Feed From My Twitter Using Ruby On Rails twitter gem","body":"<p>Okay, I've decided to use the twitter gem.\nThe problem is I havent a clue how to go about using it because im new to ruby/rails. \nAll I require is to display a list of the last 5 tweets from my own twitter account, with the times they were posted. \nI honestly do not know where to begin.</p>\n"},{"tags":["javascript","ruby-on-rails","json"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13109333,"title":"How can I associate error messages to the 'error' key in json response","body":"<p>I am trying to show the errors that can occur by uploading a file (file name, size).\nI am using <a href=\"https://github.com/tors/jquery-fileupload-rails-paperclip-example\" rel=\"nofollow\">an adapted version of Jquery Fiel Upload for Ruby on Rails</a></p>\n\n<p>I need to have my error messages (validations)  associated to the 'error' key in my json response.</p>\n\n<p>I guess I have to change the javascript to make it work.</p>\n\n<p>json:</p>\n\n<pre><code>render json: {error: @upload.errors.full_messages}, status: :unprocessable_entity\n</code></pre>\n\n<p>validations:</p>\n\n<pre><code> validates_uniqueness_of :upload_file_name, :message =&gt; \"File with this name is already in the database\"\n\n validates :upload_file_size,  :inclusion  =&gt; {:in =&gt;10.megabytes..20.megabytes}, :message =&gt;\"Too big or too small\"\n</code></pre>\n\n<p>Javascript I use to upload the files:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" charset=\"utf-8\"&gt;\n      $(function () {\n          // Initialize the jQuery File Upload widget:\n          $('#fileupload').fileupload();\n          // \n          // Load existing files:\n          $.getJSON($('#fileupload').prop('action'), function (files) {\n            var fu = $('#fileupload').data('fileupload'), \n              template;\n            fu._adjustMaxNumberOfFiles(-files.length);\n            console.log(files);\n            template = fu._renderDownload(files)\n              .appendTo($('#fileupload .files'));\n            // Force reflow:\n            fu._reflow = fu._transition &amp;&amp; template.length &amp;&amp;\n              template[0].offsetWidth;\n            template.addClass('in');\n            $('#loading').remove();\n          });\n\n      });\n    &lt;/script&gt;\n</code></pre>\n\n<p>I have tried as well those things:\n<code>json: =&gt; [{:error=&gt; @upload.errors.full_messages }] }</code> \nusing this shows only the validation message but I need the status: as well </p>\n"},{"tags":["ruby-on-rails","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13128664,"title":"JSON vs RubyValidations. How to define an error?","body":"<p>I try to catch a validation message with a <code>$.parseJSON(xhr.responseText).errors</code> but an allert message hows me \"undefined\"  and I dont understand why.</p>\n\n<p>hier are my validations:</p>\n\n<pre><code>validates :upload_file_name,  :presence   =&gt; true,\n                                :format     =&gt;{:with =&gt; %r{\\.(jpg)$}i,:message =&gt;\"It should be a pdf File\"}\n\n  validates_uniqueness_of :upload_file_name, :message =&gt; \"blabla\"\n\n  validates :upload_file_size,  :inclusion  =&gt; {:in =&gt;1.megabytes..20.megabytes,:message=&gt;\"bla\"}\n</code></pre>\n\n<p>json:</p>\n\n<pre><code>format.json{ render json: {error: @upload.errors.full_messages}, :status =&gt;422}\n</code></pre>\n\n<p>and javascript for that:</p>\n\n<pre><code> $('#fileupload').fileupload({       \n\n\n        error: function(xhr){\n          var errors = $.parseJSON(xhr.responseText).errors\n          alert(errors)         \n        }\n              });\n</code></pre>\n"},{"tags":["jquery","html","css","ruby-on-rails","design"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":36,"score":0,"question_id":13128094,"title":"Change element contents depending on current database record in Ruby on Rails","body":"<p>Please refer to the image below to have an idea of the look.</p>\n\n<p>I have a database in ruby on rails named sauces.</p>\n\n<p>The fields in the sauces table are as follows:</p>\n\n<ul>\n<li>id</li>\n<li>name</li>\n<li>description</li>\n<li>picture</li>\n</ul>\n\n<p>This is my css:</p>\n\n<pre><code>#container{width:950px;height:800px;}\n#title{this_is:irrelevant;}\n#sauce_picture{bla bla}\n#sauce_name{bla bla}\n#sauce_splatter{background-image:url(\"someimage.png\")}\n</code></pre>\n\n<p>HTML</p>\n\n<pre><code>&lt;html&gt;\n &lt;body&gt;\n  &lt;div id=\"container&gt;\n   &lt;div id=\"title&gt;&lt;h1&gt;SAUCES&lt;/h1&gt;&lt;/div&gt;\n   &lt;div id=\"sauce_picture&gt;&lt;img src=\"somepic.png/&gt;&lt;/div&gt;\n   &lt;div id=\"sauce_name&gt;&lt;h2&gt;Sauce 1&lt;/h2&gt;&lt;/div&gt;\n   &lt;div id=\"sauce_splatter&gt;\n     &lt;p&gt;Sauce Description Goes Here&lt;/p&gt; \n   &lt;/div&gt;\n  &lt;/div&gt;\n &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Okay, the rails database table has 6 records with each field present. What I want to achieve is that say the page is loaded. I want the record to be at record number one, where the contents of<code>&lt;img src=\"somepic.png/&gt;</code> , <code>&lt;h2&gt;Sauce 1&lt;/h2&gt;</code> , <code>&lt;p&gt;Sauce Description Goes Here&lt;/p&gt;</code> are all retrieved from the database table because the count starts at one. </p>\n\n<p>I do not know how to make it so that when the right arrow is pressed the id becomes two and the contents of the above change to what is present in record number 2 (id=2).</p>\n\n<p>Lastly how would I do it so that, if the id=1 (i.e. first record, the left arrow becomes disabled as a link, and when the last record is present the right arrow becomes disabled. \nThis would be achieved by changing the elements using JQuery, but how can I use Rails and Jquery together.</p>\n\n<p>This way I wouldn't have to change any code if I add a new sauce in the database table in the future, after all thats the whole point of MCV.</p>\n\n<p>Thanks</p>\n\n<p><img src=\"http://i.stack.imgur.com/SJcDz.png\" alt=\"The image\"> </p>\n"},{"tags":["ruby-on-rails","active-model-serializers"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13125214,"title":"Active Model Serializers belongs_to","body":"<p>I've got two models:</p>\n\n<pre><code>class Subject &lt; ActiveRecord::Base\n  has_many :user_combinations\n  has_ancestry\nend\n\nclass UserCombination &lt; ActiveRecord::Base\n  belongs_to :stage\n  belongs_to :subject\n  belongs_to :user\nend\n</code></pre>\n\n<p>And two serializers:</p>\n\n<pre><code>class UserCombinationSerializer &lt; ActiveModel::Serializer\n      attributes :id\n      belongs_to :stage\n      belongs_to :subject\nend\n\nclass SubjectSerializer &lt; ActiveModel::Serializer\n  attributes :id, :name, :description, :subjects\n\n  def include_subjects?\n    object.is_root?\n  end\n\n  def subjects\n    object.subtree\n  end\nend\n</code></pre>\n\n<p>When a <code>UserCombination</code> is serialized, I want to embed the whole subtree of subjects.</p>\n\n<p>When I try to use this setup I get this error:</p>\n\n<pre><code>undefined method `belongs_to' for UserCombinationSerializer:Class\n</code></pre>\n\n<p>I tried changing the <code>UserCombinationSerializer</code> to this:</p>\n\n<pre><code>class UserCombinationSerializer &lt; ActiveModel::Serializer\n  attributes :id, :subject, :stage\nend\n</code></pre>\n\n<p>In this case I get no errors, but the <code>subject</code> is serialized in the wrong way - not using the <code>SubjectSerializer</code>.</p>\n\n<p>My questions: </p>\n\n<ol>\n<li>Shouldn't I be able to use a belongs_to relation in the serializer?</li>\n<li>If not - how can I get the wanted behaviour - embedding the subject tree using the SubjectSerializer?</li>\n</ol>\n"},{"tags":["ruby-on-rails","twitter","omniauth"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":244,"score":0,"question_id":11066938,"title":"Omniauth / Rails Issue - Can't start server","body":"<p>I'm trying to follow along with Railscasts #235 (Omniauth in a rails app).</p>\n\n<p>Having some trouble with the Omniauth gem in Rails (v3.2). When I install the gem in my Gemfile, and specify the following in omniauth.rb (in config/initializers/):</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :twitter, '...', '...'\nend\n</code></pre>\n\n<p>I can't seem to start my server - I get the following error:</p>\n\n<pre><code>/Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/omniauth-1.1.0/lib/omniauth/builder.rb:38:in `rescue in provider': Could not find matching strategy for :twitter. You may need to install an additional gem (such as omniauth-twitter). (LoadError)\n</code></pre>\n\n<p>I could include the omniauth-twitter gem (the server starts with that), but I don't know why this wouldn't work without it. <strong>When I forked the repo for the railscast, everything worked fine</strong>, so not sure why this is happening. I thought it was because I have the omniauth-twitter gem installed (although not being used in the bundle), and I uninstalled it but that didn't work.</p>\n\n<p>Full Gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.2'\ngem 'omniauth'\ngem 'jquery-rails'\ngem 'bootstrap-sass'\ngem 'bcrypt-ruby'\ngem 'redcarpet'\n\ngroup :development, :test do\n  gem 'pg', '0.12.2'\n  gem 'rspec-rails', '2.9.0'\n  gem 'annotate'\nend\n\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngroup :test do\n  gem 'capybara', '1.1.2'\n  gem 'factory_girl_rails', '1.4.0'\nend\n\ngroup :production do\n  gem 'pg', '0.12.2'\nend\n</code></pre>\n\n<p>Full stack trace below:</p>\n\n<pre><code>/Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/omniauth-1.1.0/lib/omniauth/builder.rb:38:in `rescue in provider': Could not find matching strategy for :twitter. You may need to install an additional gem (such as omniauth-twitter). (LoadError)\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/omniauth-1.1.0/lib/omniauth/builder.rb:35:in `provider'\n    from /Users/tarunsachdeva/Development/rails/workbench/config/initializers/omniauth.rb:2:in `block in &lt;top (required)&gt;'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/omniauth-1.1.0/lib/omniauth/builder.rb:7:in `initialize'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/actionpack-3.2.2/lib/action_dispatch/middleware/stack.rb:43:in `new'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/actionpack-3.2.2/lib/action_dispatch/middleware/stack.rb:43:in `build'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/actionpack-3.2.2/lib/action_dispatch/middleware/stack.rb:113:in `block in build'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/actionpack-3.2.2/lib/action_dispatch/middleware/stack.rb:113:in `each'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/actionpack-3.2.2/lib/action_dispatch/middleware/stack.rb:113:in `inject'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/actionpack-3.2.2/lib/action_dispatch/middleware/stack.rb:113:in `build'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/engine.rb:470:in `app'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/application/finisher.rb:31:in `block in &lt;module:Finisher&gt;'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/initializable.rb:30:in `instance_exec'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/initializable.rb:30:in `run'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/initializable.rb:54:in `each'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/initializable.rb:54:in `run_initializers'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/application.rb:136:in `initialize!'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/railtie/configurable.rb:30:in `method_missing'\n    from /Users/tarunsachdeva/Development/rails/workbench/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /Users/tarunsachdeva/Development/rails/workbench/config.ru:4:in `require'\n    from /Users/tarunsachdeva/Development/rails/workbench/config.ru:4:in `block in &lt;main&gt;'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n    from /Users/tarunsachdeva/Development/rails/workbench/config.ru:1:in `new'\n    from /Users/tarunsachdeva/Development/rails/workbench/config.ru:1:in `&lt;main&gt;'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/commands/server.rb:46:in `app'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/commands/server.rb:70:in `start'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/commands.rb:50:in `tap'\n    from /Users/tarunsachdeva/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.2/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Any and all help is appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby","optimization","benchmarking","production-environment"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13128431,"title":"Is it a good idea to use a gcdata patched version of Ruby in a Production environment?","body":"<p>I see that in order to take full advantage of Rails' benchmarking abilities, e.g., memory profiling, one needs <a href=\"http://guides.rubyonrails.org/performance_testing.html#installing-gc-patched-mri\" rel=\"nofollow\">a patched version of ruby</a> <em>(also on <a href=\"http://robots.thoughtbot.com/post/12241426497/how-to-quick-rails-benchmarking\" rel=\"nofollow\">quick benchmarking</a>, <a href=\"http://www.synbioz.com/blog/2012/03/28/optimize_ruby_code\" rel=\"nofollow\">ruby optimization</a> etc.)</em>:</p>\n\n<pre><code>rvm install 1.9.2-p180 --patch gcdata\n</code></pre>\n\n<p>is it a good idea to use a <code>gcdata</code> patched version of Ruby in a <strong>Production</strong> environment?</p>\n"},{"tags":["ruby-on-rails","ruby","security","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12984148,"title":"Trying to force ssl, getting \"This webpage has a redirect loop\"","body":"<p>I'm trying to force all urls generated by my controller to be \"https\" and redirecting to https otherwise. I tried the method explained in <a href=\"http://lucastej.blogspot.com/2008/01/ruby-on-rails-how-to-set-urlfor.html\" rel=\"nofollow\">this blog</a> and the one suggested by Olly <a href=\"http://stackoverflow.com/questions/1662262/rails-redirect-with-https\">here</a>\nand I'm getting this error if I try to access my application:</p>\n\n<blockquote>\n  <p><strong>This webpage has a redirect loop</strong></p>\n  \n  <p>The webpage at https://'example.com' has resulted in too many redirects. Clearing\n  your cookies for this site or allowing third-party cookies may fix the problem.\n  If not, it is possibly a server configuration issue and not a problem with\n  your computer.</p>\n</blockquote>\n\n<p>Clearing the cookie doesn't help. Why is it going into a loop? I made sure to run the code under condition that request.ssl is false. I'm using Rails 2.3.10. \nSo here is what I tried, in my application controller I added:</p>\n\n<pre><code>     url_for unless (Rails.env.test? || Rails.env.development?) \n     def default_url_options(options) \n    { :only_path =&gt; false, :protocol =&gt; 'https' } unless (Rails.env.test? ||  Rails.env.development?) \n    end\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>def redirect_to_https\n  redirect_to :protocol =&gt; \"https://\" unless (request.ssl? || Rails.env.test? || Rails.env.development? || local_request?)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","facebook","facebooker","facebook-friends"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1140,"score":2,"question_id":3210622,"title":"facebook friends-of-friends","body":"<p>Quick question. How can I get the Facebook ids of the current logged in user’s second degree friends or friends-of-friends?</p>\n\n<p>Sample sites that do the same behavior are the ff:</p>\n\n<ul>\n<li>vark.com</li>\n<li>thread.com</li>\n</ul>\n"},{"tags":["ruby-on-rails","heroku","web-hosting","cloud-hosting","engineyard"],"answer_count":5,"favorite_count":25,"up_vote_count":44,"down_vote_count":0,"view_count":15196,"score":44,"question_id":2197197,"title":"Heroku vs EngineYard: which one is more worth the money?","body":"<p>I looked this up on Google, but wanted more opinions before I committed to either service.  Has anyone had experience with either (or maybe both) services?  Are there any advantages or disadvantages that stood out about either one?  Particular areas of interest are:</p>\n\n<ol>\n<li>Security</li>\n<li>Stability</li>\n<li>Scalability.</li>\n<li>Price</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby","routing"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":4380,"score":4,"question_id":5292775,"title":"Rails Devise routing error - \"No route matches\" (controller=>\"devise/sessions\")","body":"<p><strong>Edit 2: Looks like a quick temp fix for me was to add a forward slash \"/\" in front of the controller name in my link_to_unless_current and current_page methods from my view.\ne.g.</strong> </p>\n\n<pre><code>&lt;% active = current_page?(:controller =&gt; '/sites', :action =&gt; action) ? 'active' : '' %&gt;\n      &lt;li class=\"&lt;%= active %&gt;\"&gt;&lt;%= link_to_unless_current(anchor, { :controller =&gt; '/sites', :action =&gt; action }) %&gt;&lt;/li&gt;\n</code></pre>\n\n<p><strong>Here is more info on the problem I encountered in case anyone else runs into the same thing. <a href=\"https://github.com/plataformatec/devise/issues/471\" rel=\"nofollow\">https://github.com/plataformatec/devise/issues/471</a></strong></p>\n\n<p>============================================================</p>\n\n<p>My devise path broke when I made my navigation (_header.html.erb) dynamic.  I'm hoping this is a simple fix, but really lost atm.  Every page on my site works, except when I go to /admin and then I get the routing error below:</p>\n\n<p>Here's the exact error I receive:</p>\n\n<pre><code>Started GET \"/admin\" for 75.13.95.55 at 2011-03-13 15:40:49 -0500\n  Processing by AdminController#index as HTML\nCompleted   in 2ms\n\n\nStarted GET \"/users/sign_in\" for 75.13.95.55 at 2011-03-13 15:40:51 -0500\n  Processing by Devise::SessionsController#new as HTML\nRendered /usr/local/rvm/gems/ruby-1.9.2-p0/gems/devise-1.1.5/app/views/devise/shared/_links.erb (1.9ms)\nRendered layouts/_header.html.erb (37.0ms)\nRendered /usr/local/rvm/gems/ruby-1.9.2-p0/gems/devise-1.1.5/app/views/devise/sessions/new.html.erb within layouts/application (57.5ms)\nCompleted   in 91ms\n\nActionView::Template::Error (No route matches {:action=&gt;\"coupons\", :controller=&gt;\"devise/sessions\"}):\n    7: &lt;div id=\"navcontainer\"&gt;\n    8:   &lt;ul id=\"navlist\"&gt;\n    9:     &lt;% nav.each do |anchor, action| %&gt;\n    10:       &lt;% active = current_page?(:action =&gt; action) ? 'active' : '' %&gt;\n    11:       &lt;li class=\"&lt;%= active %&gt;\"&gt;&lt;%= link_to_unless_current(anchor, { :action =&gt; action }) %&gt;&lt;/li&gt;\n    12:     &lt;% end -%&gt;\n    13:   &lt;/ul&gt;\n  app/views/layouts/_header.html.erb:10:in `block in _app_views_layouts__header_html_erb__482084855_91994390_872614734'\n  app/views/layouts/_header.html.erb:9:in `each'\n  app/views/layouts/_header.html.erb:9:in `_app_views_layouts__header_html_erb__482084855_91994390_872614734'\n  app/views/layouts/application.html.erb:17:in `_app_views_layouts_application_html_erb___293959382_92160660__194406143'\n</code></pre>\n\n<p>Here is the <code>config/routes.rb</code> file:</p>\n\n<pre><code>  devise_for :users\n\n  match '/info' =&gt; 'sites#info', :as =&gt; :info\n  match \"/reviews\" =&gt; 'sites#reviews', :as =&gt; :reviews\n\n  resources :admin do\n    collection do\n      put 'moderate'\n      get 'approved'\n    end\n  end\n\n  root :to =&gt; 'sites#coupons'\n</code></pre>\n\n<p>Here's the <code>app/views/layouts/_header.html.erb</code> file:</p>\n\n<pre><code>&lt;% nav = { 'Coupons' =&gt; 'coupons', 'Reviews' =&gt; 'reviews', 'Info' =&gt; 'info' } %&gt;\n\n&lt;div id=\"navcontainer\"&gt;\n  &lt;ul id=\"navlist\"&gt;\n    &lt;% nav.each do |anchor, action| %&gt;\n      &lt;% active = current_page?(:action =&gt; action) ? 'active' : '' %&gt;\n      &lt;li class=\"&lt;%= active %&gt;\"&gt;&lt;%= link_to_unless_current(anchor, { :action =&gt; action }) %&gt;&lt;/li&gt;\n    &lt;% end -%&gt;\n</code></pre>\n\n<p>And here's the output of <code>rake routes</code>:</p>\n\n<pre><code>      new_user_session GET    /users/sign_in(.:format)           {:action=&gt;\"new\", :controller=&gt;\"devise/sessions\"}\n          user_session POST   /users/sign_in(.:format)           {:action=&gt;\"create\", :controller=&gt;\"devise/sessions\"}\n  destroy_user_session GET    /users/sign_out(.:format)          {:action=&gt;\"destroy\", :controller=&gt;\"devise/sessions\"}\n                  info        /info(.:format)                    {:controller=&gt;\"sites\", :action=&gt;\"info\"}\n               reviews        /reviews(.:format)                 {:controller=&gt;\"sites\", :action=&gt;\"reviews\"}\nmoderate_admin_index PUT    /admin/moderate(.:format)        {:action=&gt;\"moderate\", :controller=&gt;\"admin\"}\napproved_admin_index GET    /admin/approved(.:format)        {:action=&gt;\"approved\", :controller=&gt;\"admin\"}\n         admin_index GET    /admin(.:format)                 {:action=&gt;\"index\", :controller=&gt;\"admin\"}\n                       POST   /admin(.:format)                 {:action=&gt;\"create\", :controller=&gt;\"admin\"}\n           new_admin GET    /admin/new(.:format)             {:action=&gt;\"new\", :controller=&gt;\"admin\"}\n          edit_admin GET    /admin/:id/edit(.:format)        {:action=&gt;\"edit\", :controller=&gt;\"admin\"}\n               admin GET    /admin/:id(.:format)             {:action=&gt;\"show\", :controller=&gt;\"admin\"}\n                       PUT    /admin/:id(.:format)             {:action=&gt;\"update\", :controller=&gt;\"admin\"}\n                       DELETE /admin/:id(.:format)             {:action=&gt;\"destroy\", :controller=&gt;\"admin\"}\n                  root        /(.:format)                        {:controller=&gt;\"sites\", :action=&gt;\"coupons\"}\n</code></pre>\n\n<p>Thanks for looking!</p>\n\n<p>Edit 1:\nWhen I tried the suggestion from @Dogbert, it didn't seem to make a difference unfortunately:</p>\n\n<pre><code>No route matches {:controller=&gt;\"devise/sites\", :action=&gt;\"coupons\"}\nExtracted source (around line #9):\n\n6: &lt;div id=\"navcontainer\"&gt;\n7:   &lt;ul id=\"navlist\"&gt;\n8:     &lt;% nav.each do |anchor, action| %&gt;\n9:       &lt;% active = current_page?(:controller =&gt; 'sites', :action =&gt; action) ? 'active' : '' %&gt;\n10:       &lt;li class=\"&lt;%= active %&gt;\"&gt;&lt;%= link_to_unless_current(anchor, { :controller =&gt; 'sites', :action =&gt; action }) %&gt;&lt;/li&gt;\n11:     &lt;% end -%&gt;\n12:   &lt;/ul&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ssl","heroku","github"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13127837,"title":"SSL, Github, and Heroku -- is pushing secure?","body":"<p>I just bought an SSL certificate for my Heroku-deployed app. Following <a href=\"https://devcenter.heroku.com/articles/ssl-certificate\" rel=\"nofollow\">their instructions</a>, I downloaded the certificate and private key, saved them in server.crt and server.key files (with some RapidSSL CA deal thrown in there), and am now planning on pushing and deploying. The worry is, my github repo is public, and I feel like it's a bad idea to push my \"private\" keys and certificates to a public site. Sort of defeats the purpose of the SSL, right?</p>\n\n<p>But how else do I get it to work without publishing this info? I'm new to SSL and coding, and I just very much do not want to throw away the security I just spent good money on because I don't understand how this all works. </p>\n\n<p>Sorry if this question wasn't very code-y. Just didn't know where better to ask.</p>\n\n<p>EDIT -- I'm looking at Heroku docs right now that say to add a Heroku SSL Add-On, and then just type </p>\n\n<pre><code>heroku certs:add server.crt server.key\n</code></pre>\n\n<p>to get heroku to pick up on the files and use the SSL Certificate. But that doesn't change the problem that I have two files in my PUBLIC repo with PRIVATE security info. Do I just add them to .gitignore or something?</p>\n"},{"tags":["ruby-on-rails","elasticsearch","tire"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13071672,"title":"Building the right search request with gem Tire and ElasticSearch","body":"<p>I am trying to implement simple search request for my Flower Store, but as I am new to Tire and ElasticSearch, I cannot get how to do it.</p>\n\n<p>I have searchable model <code>Product</code>, and habtm models <code>Category</code>, <code>Colour</code>, <code>Flower</code>. What I want is checkboxes for each association, producing request similiar to this:</p>\n\n<pre><code>http://example.com/search?q=some%20query&amp;category_names[]=bouquet&amp;category_names[]=marriage&amp;colour_names[]=red&amp;colour_names[]=yellow&amp;colour_names[]=white&amp;flower_names[]=rose&amp;flower_names[]=tulip&amp;price_min=100&amp;price_max=1000\n</code></pre>\n\n<p>But I need to show only those products, which:</p>\n\n<pre><code>a) prestent in any of the requested categories (OR);\nb) have all of the requested colours (AND);\nc) have all of the requested flowers (AND);\nd) enter the price range between price_min and price_max.\n</code></pre>\n\n<p>The <code>q</code> parameter is to search any text, entered to the text field, in the names of associations (let's say, <code>red roses bouquet</code>), and show it with the upper criteria too.</p>\n\n<p>For now I have only</p>\n\n<pre><code>class Product\n  include Mongoid::Document\n\n  include Tire::Model::Search\n  include Tire::Model::Callbacks\n\n  has_and_belongs_to_many :categories\n  has_and_belongs_to_many :colours\n  has_and_belongs_to_many :flowers\n\n  def self.search(params)\n    tire.search(load: true, page: params[:page], per_page: 8) do |search|\n      search.query  { string params[:query] } if params[:query].present?\n    end\n  end\n\n  def to_indexed_json\n    self.to_json(methods: [:category_names, :colour_names])\n  end\n\n  def category_names\n    self.categories.collect { |c| c.name }\n  end\n\n  def colour_names\n    self.colours.collect { |c| c.name }\n  end\nend\n</code></pre>\n\n<p>and do not know how to configure it. I read about <code>filters</code> and <code>facets</code>, but because English is not my native I cannot uderstand what is what and how to use them.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":5,"favorite_count":9,"up_vote_count":8,"down_vote_count":0,"view_count":2162,"score":8,"question_id":2410639,"title":"Best way to create random DateTime in Rails","body":"<p>What is the best way to generate a random DateTime in Ruby/Rails? Trying to create a nice seeds.rb file. Going to use it like so:</p>\n\n<pre><code> Foo.create(name: Faker::Lorem.words, description: Faker::Lorem.sentence, start_date: Random.date)\n</code></pre>\n"}]}
{"total":93231,"page":20,"pagesize":100,"questions":[{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","facebook-graph-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13127849,"title":"Rails3 unable to connect to facebook graph","body":"<p>im trying to connect to facebook graph to send a notification to user upon friend request</p>\n\n<p>open(URI.encode(\"https://graph.facebook.com/#{@user.uid}/notifications?access_token=#{ENV['FACEBOOK_KEY']}|#{ENV['FACEBOOK_SECRET']}&amp;template=You have a friend request&amp;href=\"))</p>\n\n<p>returns OpenURI::HTTPError (400 Bad Request) which is bad. Please do note that all other variables are declared properly.</p>\n\n<p>If i edit the url to open(URI.encode(\"https://graph.facebook.com/#{@user.uid}/\")), it works!!!</p>\n\n<p>i'm suspecting that they encode the | which cost the problem, but if i just do a open(\"\") it returns invalid url.</p>\n\n<p>please help, tqvm</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","refactoring"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13127582,"title":"Rails Refactoring: Custom Method & Heavy View","body":"<p>My code current works just fine, but I can tell that it could be done better.  So I figured I would ask for some input.</p>\n\n<p>For a given expense, the user can submit, or un-submit.  This creates a record in the expense_approvals table, and sets the approval_status to 1 or 0.</p>\n\n<p>The complexity comes when someone un-submits an expense, and then later resubmits it, since the record already exists, I had to put in the logic to handle it, and a very ugly view to go with it.</p>\n\n<p>My gut tells me there are things I can do in the model, and/or controller to make this much cleaner.</p>\n\n<p>So my model looks like this:</p>\n\n<pre><code>class Expense &lt; ActiveRecord::Base\n  attr_accessible :amount, :expense_date, :description\n\n  has_one :expense_approval\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>class ExpenseApproval &lt; ActiveRecord::Base\n  attr_accessible :approval_date, :approval_status, :approver_id, :expense_id\n\n  belongs_to :expense, foreign_key: :expense_id\n\n  validates_uniqueness_of :expense_id\nend\n</code></pre>\n\n<p>and the controller</p>\n\n<pre><code>def submit_expense\n  @expense_list = Expense.all  \n  expense = Expense.find(params[:id])\n\n  if expense.expense_approval\n    approval = ExpenseApproval.find(expense.expense_approval.id)\n    approval.approval_status = 1\n  else\n    approval = ExpenseApproval.new(approval_status: \"1\", expense_id: expense.id)\n  end\n\n  if approval.save\n    #flash[:success] = \"You have added an submission.\"\n    redirect_to expense_approvals_path\n  else\n    flash[:error] = \"Error\"    \n    redirect_to expense_approvals_path\n  end\nend\n\ndef un_submit_expense\n  @expense_list = Expense.all  \n  @expense = ExpenseApproval.find(params[:id])\n  @expense.approval_status = 0\n\n  if @expense.save\n    #flash[:success] = \"You have un submitted.\"\n    redirect_to expense_approvals_path\n  else\n    flash[:error] = \"Unsubmit Error\"    \n    redirect_to expense_approvals_path\n  end\nend\n</code></pre>\n\n<p>and view</p>\n\n<pre><code> &lt;% if expense_item.expense_approval %&gt;\n              &lt;%#=expense_item.expense_approval.approval_status%&gt;\n\n              &lt;% if expense_item.expense_approval.approval_status == 1 %&gt;\n                        &lt;%= link_to raw('&lt;i class=\"icon-arrow-down icon-white\"&gt; &lt;/i&gt;'), \n                              un_submit_expense_path(expense_item.expense_approval[:id]),\n                              class: \"btn btn-mini btn-warning\", \n                              :confirm =&gt; \"Are you sure you want to un submit this expense?\" %&gt;\n              &lt;% end %&gt;\n\n              &lt;% if expense_item.expense_approval.approval_status == 0 %&gt;\n                        &lt;%= link_to raw('&lt;i class=\"icon-arrow-up icon-white\"&gt; &lt;/i&gt;'), \n                              submit_expense_path(expense_item[:id]),\n                              class: \"btn btn-mini btn-info\", \n                              :confirm =&gt; \"Are you sure you want to submit this expense?\" %&gt;\n              &lt;% end %&gt;\n\n            &lt;% else %&gt;\n\n             &lt;%= link_to raw('&lt;i class=\"icon-arrow-up icon-white\"&gt; &lt;/i&gt;'), \n                              submit_expense_path(expense_item[:id]),\n                              class: \"btn btn-mini btn-info\", \n                              :confirm =&gt; \"Are you sure you want to submit this expense?\" %&gt;\n\n            &lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","modal"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":13104919,"title":"Twitter bootstrap modal loads wrong remote data","body":"<p>I'm using Twitter Bootstrap modal featurs and loading data from remote locations. I'm providing the remote url for a set of thumbnails with the hope that once the thumbnail is clicked, the appropriate data (a large version of the image) is displayed. I'm using the html declarative style to define the remote urls and all the features of the modal. </p>\n\n<p>What I find is that Twitter bootstrap modal loads first remote url then does not display subsequent remote data, (although a request to the proper url is made in Chrome) but displays first loaded data always. How do I get it to show the proper data?</p>\n\n<p>View:</p>\n\n<pre><code>#gallery-navigation\n  %ul\n    - @profile.background_images.each do |image|\n      %li\n        = link_to image_tag(image.background_image.url(:thumb)), remote_image_path(image.id), :role =&gt; \"button\", :data =&gt; {:toggle =&gt; \"modal\", :target =&gt; \"#image-modal\", :remote =&gt; remote_image_path(image.id)}\n\n/ Modal\n#image-modal.modal.hide.fade(role=\"dialog\" aria-hidden=\"true\" data-backdrop=\"true\")\n  .modal-body\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>  def remote_image\n    @image = current_user.profile.background_images.find(params[:image_id])\n    respond_to do |format|\n      format.html {\n        render :partial =&gt; \"remote_image\", :locals =&gt; { :image =&gt; @image }\n      }\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","business","billing","dynamic-websites"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13127587,"title":"Billing for Ruby on Rails project?","body":"<p>I am a seasoned consultant but am just about to launch my first billable web app built on Ruby on Rails for a client. I would be interested to know how much (or how many hours) other RoR developers would charge for such a site. I spent much time learning, testing and having fun so I don't plan on charging for all the time i spent. i just wanted to get a ballpark figure of how much it might cost my client to get the site i built if they used another firm. below is an outline of the site which i hope gives an idea about the work involved. i should note that i don't want/need a primer on consulting/billing as i've been doing this for years. just wanting to get some ballpark figures from other experienced RoR programmers about how much time they may charge for. thanks!</p>\n\n<p>The website allows about 30 employees to log in and create/edit calendar events for themselves. And allows admins to see schedule and manage users:</p>\n\n<ul>\n<li>Built using Ruby/Rails (1.9/3.2.8)</li>\n<li>Twitter Bootstrap theme sitewide</li>\n<li>Devise for authentication, CanCan and Rolify for authorization</li>\n<li>TinyTDS gem used to connect site with their private Microsoft SQL Server</li>\n<li>about 4 Controllers/resources used (i.e. User, Event, Calendar and Schedule pages)</li>\n<li>Rspec/Capybara/FactoryGirl for testing--full Unit testing, approx 70% Controller testing and about 80% request/integration testing (I'm still finishing up request tests).</li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unit-testing","tdd","dry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13124410,"title":"Rails: Repeating unit test - DRY?","body":"<p>Is there any standard practice to DRY-out the repeating unit test cases in rails. For e.g. I have many models with the \"name\" attribute, I want to do same kind of unit tests for each model. I vaguely see that i need to create modules are reuse? Is that possible/correct?</p>\n\n<p>Any pointers/practice to creating DRY unit test? </p>\n\n<p><strong>Example code:</strong> I want to do same kind of testing for many other models with the same named attribute.</p>\n\n<pre><code>require 'test_helper'\n\n\n# Factory class\nclass UserFactory\n\n  # Creates a valid template user\n  def self.create\n    user = User.new do |u|\n      u.name = \"Test User #{rand}\"\n      u.notes = \"test notes\"\n    end\n    user\n  end\n\nend\n\nclass UserTest &lt; ActiveSupport::TestCase\n  # ------------\n  # Init\n  # ------------\n\n  def setup\n    @valid_usr = UserFactory.create\n  end\n\n  def teardown\n    @valid_usr.destroy if @valid_usr.persisted?\n    @valid_usr = nil\n  end\n\n\n  # ------------\n  # Name\n  # ------------\n\n  test \"should not have a dummy user object\" do\n    user = User.new\n    assert !user.save\n  end\n\n  test \"unique user name must be saved\" do\n    assert UserFactory.create.save!, \"First entry must be saved\"\n\n    user = UserFactory.create\n    user.name = \"Different name\"\n    assert user.save!, \"Unique user must be saved\"\n    user.destroy\n  end\n\n  test \"non unique user names must not be saved\" do\n    user1 = UserFactory.create\n    user2 = UserFactory.create\n    user1.name = \"Same User name\"\n    user2.name = \"Same User name\"\n\n    assert user1.save!, \"First entry must be saved\"\n    assert !user2.save, \"Duplicate name should not be saved\"\n\n    user1.destroy\n    user2.destroy\n  end\n\n  test \"should not have user without a valid name\" do\n    # Invalid name\n    @valid_usr.name = \" \"\n    assert !@valid_usr.save\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13124024,"title":"How to get a nested child record to know stuff about its parent during instantiation in Ruby on Rails?","body":"<p>I have a form for creating a new <code>invoice</code> with many <code>items</code>. </p>\n\n<pre><code>class Invoice &lt; ActiveRecord::Base\n  attr_accessible :project_id, :number, :date, :recipient, :items_attributes\n  accepts_nested_attributes_for :items\nend\n</code></pre>\n\n<p>Now when I instantiate a new <code>invoice</code> and a set of containing <code>items</code>, I want these <code>items</code> to <em>know</em> something about the <code>invoice</code> they belong to even before they are saved, so I can do something like this in my <code>Item</code> model:</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\n  belongs_to :invoice\n  after_initialize :set_hourly_rate\n\n  private \n\n    def set_hourly_rate\n      if new_record?\n        self.price ||= invoice.project.hourly_rate\n      end\n    end   \n\nend\n</code></pre>\n\n<p>Right now, my code fails because the child (<code>item</code>) doesn't know anything about its parent (<code>invoice</code>) during instantiation. Only after saving the <code>invoice</code> (and thus its nested <code>items</code>), it all works out. But I want to set a default value on each new item even <strong>before</strong> it gets saved.</p>\n\n<p>How can this be done?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json","backbone.js"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13126798,"title":"Handling nested JSON in Rails without accepts_nested_attributes_for","body":"<p>I am building a Rails application to provide a JSON API to a Backbone.js frontend.</p>\n\n<p>We have a number of cases where we provide data similar to <code>label: { id: 1, name: \"My Label\" }</code>. When this is used in a select box within a form (to specify an association) we currently need to specify <code>label_id: 1</code> in posted data. We'd like the API to be more symmetrical and support the nested <code>label: { id: 1 }</code> form if possible.</p>\n\n<p>So far, I (not surprisingly) get a <code>ActiveRecord::AssociationTypeMismatch</code> error as Rails is expecting a <code>Label</code> object and receives a <code>ActiveSupport::HashWithIndifferentAccess</code> instead. I understand we can use <code>accepts_nested_attributes_for</code> if we want to support nested modification of the labels, but in this case I only want to use the nested form to specify the correct label for the association.</p>\n\n<p>Is there a good way to do this in Rails (3.2.8) that doesn't involve modifying the params hash before passing it off to the model? If not, any recommendations for the best way to robustly transform the params as they come in?</p>\n\n<p>Here's the current code I use to flatten out the params in case it is of help:</p>\n\n<pre><code>def flatten_params(hash)\n  hash.reduce({}) do |memo, (key, value)|\n    if value.class == ActiveSupport::HashWithIndifferentAccess\n      memo[(key.to_s + '_id').to_sym] = value['id']\n    else\n      memo[key] = value\n    end\n    memo\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","plugins","code-generation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13127203,"title":"Who is responsible of generating the .idea files in Rails?","body":"<p>When I'm looking on my Rails application folder i can find a <strong>.idea</strong> folder, it includes: </p>\n\n<ul>\n<li>.generators</li>\n<li>.rakeTasks</li>\n</ul>\n\n<p>And more... When i open <strong>.generators</strong> for example, i see the following:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Settings&gt;&lt;!--This file was automatically generated by Ruby plugin.\nYou are allowed to: \n1. Reorder generators\n2. Remove generators\n3. Add installed generators\nTo add new installed generators automatically delete this file and reload the project.\n--&gt;&lt;GeneratorsGroup&gt;&lt;Generator name=\"active_record:migration\" /&gt;&lt;Generator name=\"active_record:model\" /&gt;&lt;Generator name=\"active_record:observer\" /&gt;&lt;Generator name=\"active_record:session_migration\" /&gt;&lt;Generator name=\"controller\" /&gt;&lt;Generator name=\"erb:controller\" /&gt;&lt;Generator name=\"erb:mailer\" /&gt;&lt;Generator name=\"erb:scaffold\" /&gt;&lt;Generator name=\"generator\" /&gt;&lt;Generator name=\"helper\" /&gt;&lt;Generator name=\"integration_test\" /&gt;&lt;Generator name=\"mailer\" /&gt;&lt;Generator name=\"metal\" /&gt;&lt;Generator name=\"migration\" /&gt;&lt;Generator name=\"model\" /&gt;&lt;Generator name=\"model_subclass\" /&gt;&lt;Generator name=\"observer\" /&gt;&lt;Generator name=\"performance_test\" /&gt;&lt;Generator name=\"plugin\" /&gt;&lt;Generator name=\"resource\" /&gt;&lt;Generator name=\"scaffold\" /&gt;&lt;Generator name=\"scaffold_controller\" /&gt;&lt;Generator name=\"session_migration\" /&gt;&lt;Generator name=\"stylesheets\" /&gt;&lt;Generator name=\"test_unit:controller\" /&gt;&lt;Generator name=\"test_unit:helper\" /&gt;&lt;Generator name=\"test_unit:integration\" /&gt;&lt;Generator name=\"test_unit:mailer\" /&gt;&lt;Generator name=\"test_unit:model\" /&gt;&lt;Generator name=\"test_unit:observer\" /&gt;&lt;Generator name=\"test_unit:performance\" /&gt;&lt;Generator name=\"test_unit:plugin\" /&gt;&lt;Generator name=\"test_unit:scaffold\" /&gt;&lt;/GeneratorsGroup&gt;&lt;/Settings&gt;\n</code></pre>\n\n<p>As you can see: \"<strong>This file was automatically generated by Ruby plugin.</strong>\"</p>\n\n<p>So who is responsible of generating those files ? </p>\n\n<p>and how can i call it ? </p>\n\n<p>the IDE need to take care of it ?</p>\n"},{"tags":["ruby-on-rails","forms","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":543,"score":1,"question_id":5436267,"title":"How to submit a form to custom url with a different HTTP method?","body":"<p>I'm using simple_form gem to build my forms, and I'd like to submit a form to \"/messages/delete_all\" with the DELETE method. How can I do that with simple_form?</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>=simple_form_for :messages, :url=&gt;{:action=&gt;\"delete_all\"} do |f|    \n   =f.button :submit, \"Delete\"\n</code></pre>\n\n<p>This doesn't seem to work, though. It submits to \"/messages/delete_all\" with POST.</p>\n"},{"tags":["ruby-on-rails"],"answer_count":3,"favorite_count":26,"up_vote_count":23,"down_vote_count":1,"view_count":3614,"score":22,"question_id":2168442,"title":"Many-to-many relationship with the same model in rails?","body":"<p>How can I make a many-to-many relationship with the same model in rails?</p>\n\n<p>For example, each post is connected to many posts.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13126753,"title":"Rails, construct url for arbitrary controller,action and zero or more params","body":"<p>here is my current workflow:</p>\n\n<pre><code>c = get_some_controller # =&gt; \"fruits\" or nil\na = get_some_action # =&gt; \"list\"\np = get_some_params # =&gt; { :type =&gt; :orange, :price =&gt; 10 }\n\nurl = url_for(:controller =&gt; c, :action =&gt; a) # no option for params ??\n</code></pre>\n\n<p>So, here is my question, <code>url_for</code> seem does not have any option to pass params.</p>\n\n<p>I guess this use case is pretty common, but rails for some reason not support it or i missed something ?</p>\n"},{"tags":["ruby-on-rails","getjson"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13127017,"title":"How to handle an error (alert) in a getJSON","body":"<p>I am trying to show the errors that can occur by validation a file (file extension, size).\nI am using <a href=\"https://github.com/tors/jquery-fileupload-rails-paperclip-example\" rel=\"nofollow\">an adapted version of Jquery Fiel Upload for Ruby on Rails</a></p>\n\n<p>I need to validate a file (ending of a file,  size of the file) before uploading and as nobody has an idea <a href=\"http://stackoverflow.com/questions/13109333/how-can-i-associate-error-messages-to-the-error-key-in-json-response\">how to do it with JSON</a>.\nI need to show in form of alert my error message from a validations in controller.\nI want to ask if somebody knows how to change a getJSON to catch the validation messages.</p>\n\n<p>Javascript:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" charset=\"utf-8\"&gt;\n          $(function () {\n              // Initialize the jQuery File Upload widget:\n              $('#fileupload').fileupload();\n              // \n              // Load existing files:\n              $.getJSON($('#fileupload').prop('action'), function (files) {\n                var fu = $('#fileupload').data('fileupload'), \n                  template;\n                fu._adjustMaxNumberOfFiles(-files.length);\n                console.log(files);\n                template = fu._renderDownload(files)\n                  .appendTo($('#fileupload .files'));\n                // Force reflow:\n                fu._reflow = fu._transition &amp;&amp; template.length &amp;&amp;\n                  template[0].offsetWidth;\n                template.addClass('in');\n                $('#loading').remove();\n              });\n\n          });\n    &lt;/script&gt;\n</code></pre>\n\n<p>validations:</p>\n\n<pre><code> validates_uniqueness_of :upload_file_name, :message =&gt; \"File with this name is already in the database\"\n\n validates :upload_file_size,  :inclusion  =&gt; {:in =&gt;10.megabytes..20.megabytes}, :message =&gt;\"Too big or too small\"\n</code></pre>\n\n<p>Many thanks in advanced</p>\n"},{"tags":["ruby-on-rails","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13112741,"title":"Deeply nested form containing a nested form","body":"<p>I saw the railscast on using deeply nested forms to make a survey:<br>\n<a href=\"http://railscasts.com/episodes/196-nested-model-form-revised?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/196-nested-model-form-revised?view=asciicast</a></p>\n\n<p>How would you construct something similar in Rails to actually /take/ the survey, instead of just construct it for display in text?  How would you make a deeply nested form containing a survey form the user fills out?</p>\n"},{"tags":["ruby-on-rails","twitter-bootstrap","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13121860,"title":"Rails Form in Bootstrap Modal","body":"<p>I'm trying to put a rails form in a bootstrap modal dialog.  I'd like to use the modal-footer to hold the cancel/submit buttons, but this doesn't seem to work inside the form tag.</p>\n\n<pre><code>&lt;div class=\"modal-body\"&gt;\n  &lt;%= simple_form_for [@state, @search] do |f| %&gt;\n     &lt;!-- long form here --&gt;\n     &lt;div class=\"modal-footer\"&gt;\n       &lt;button class=\"btn\" data-dismiss=\"modal\" aria-hidden=\"true\"&gt;Cancel&lt;/button&gt;\n       &lt;%= f.button :submit, :class =&gt; 'btn btn-primary' %&gt;\n     &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13126497,"title":"Rails + Heroku : ActionView::Template::Error","body":"<p>I'm having trouble deploying my rails app to heroku. I just fixed an error <a href=\"http://stackoverflow.com/questions/13041271/rails-heroku-were-sorry-but-something-went-wrong\">Rails + Heroku : We&#39;re sorry, but something went wrong</a> but I guess there were more. Can anyone help guide me on how to debug it? I am stuck because heroku doesn't tell me what line the error occurs. Sorry for the bother.</p>\n\n<p>Here's all my code if you want to take a look.\n<a href=\"https://github.com/EdmundMai/pholderbeta\" rel=\"nofollow\">https://github.com/EdmundMai/pholderbeta</a></p>\n\n<p>Let me know if you want me to paste anything.</p>\n\n<p>Heroku Logs:</p>\n\n<pre><code>2012-10-29T16:43:41+00:00 app[web.1]: Completed 500 Internal Server Error in 328ms\n2012-10-29T16:43:41+00:00 app[web.1]: \n2012-10-29T16:43:41+00:00 app[web.1]: LINE 4:              WHERE a.attrelid = '\"users\"'::regclass\n2012-10-29T16:43:41+00:00 app[web.1]: ActionView::Template::Error (PG::Error: ERROR:  relation \"users\" does not exist\n2012-10-29T16:43:41+00:00 app[web.1]:                                         ^\n2012-10-29T16:43:41+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n2012-10-29T16:43:41+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d\n2012-10-29T16:43:41+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull\n2012-10-29T16:43:41+00:00 app[web.1]:              WHERE a.attrelid = '\"users\"'::regclass\n2012-10-29T16:43:41+00:00 app[web.1]:                AND a.attnum &gt; 0 AND NOT a.attisdropped\n2012-10-29T16:43:41+00:00 app[web.1]:              ORDER BY a.attnum\n2012-10-29T16:43:41+00:00 app[web.1]: ):\n2012-10-29T16:43:41+00:00 app[web.1]:     1: \n2012-10-29T16:43:41+00:00 app[web.1]:     2:        &lt;nav class=\"clearfix\"&gt;\n2012-10-29T16:43:41+00:00 app[web.1]:     3:            &lt;% if !signed_in? %&gt;\n2012-10-29T16:43:41+00:00 app[web.1]:     4:                &lt;%= link_to \"home\", root_url %&gt;\n2012-10-29T16:43:41+00:00 app[web.1]:     5:            &lt;% else %&gt;\n2012-10-29T16:43:41+00:00 app[web.1]:     6:                &lt;%= link_to \"my profile\", current_user %&gt;\n2012-10-29T16:43:41+00:00 app[web.1]:   app/helpers/sessions_helper.rb:26:in `current_user'\n2012-10-29T16:43:41+00:00 app[web.1]:   app/helpers/sessions_helper.rb:13:in `signed_in?'\n2012-10-29T16:43:41+00:00 app[web.1]:   app/views/layouts/_header.html.erb:3:in `_app_views_layouts__header_html_erb__4262906123720065777_48014220'\n2012-10-29T16:43:41+00:00 app[web.1]: \n2012-10-29T16:43:41+00:00 app[web.1]:   app/views/layouts/application.html.erb:13:in `_app_views_layouts_application_html_erb__2281927286696150034_48418280'\n2012-10-29T16:43:41+00:00 app[web.1]: \n2012-10-29T16:43:41+00:00 heroku[router]: GET pacific-ravine-3563.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=11ms status=200 bytes=1150\n2012-10-29T16:46:26+00:00 heroku[slugc]: Slug compilation started\n2012-10-29T16:46:53+00:00 heroku[web.1]: State changed from up to starting\n2012-10-29T16:46:53+00:00 heroku[slugc]: Slug compilation finished\n2012-10-29T16:46:56+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 30276`\n2012-10-29T16:46:57+00:00 heroku[web.1]: Stopping all processes with SIGTERM\n2012-10-29T16:46:58+00:00 app[web.1]: [2012-10-29 16:46:58] ERROR SignalException: SIGTERM\n2012-10-29T16:46:58+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'\n2012-10-29T16:47:04+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /app/config/environment.rb:5)\n2012-10-29T16:47:04+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /app/config/environment.rb:5)\n2012-10-29T16:47:08+00:00 heroku[web.1]: Error R12 (Exit timeout) -&gt; At least one process failed to exit within 10 seconds of SIGTERM\n2012-10-29T16:47:08+00:00 heroku[web.1]: Stopping remaining processes with SIGKILL\n2012-10-29T16:47:08+00:00 app[web.1]: =&gt; Booting WEBrick\n2012-10-29T16:47:08+00:00 app[web.1]: =&gt; Rails 3.2.8 application starting in production on http://0.0.0.0:30276\n2012-10-29T16:47:08+00:00 app[web.1]: =&gt; Call with -d to detach\n2012-10-29T16:47:08+00:00 app[web.1]: =&gt; Ctrl-C to shutdown server\n2012-10-29T16:47:08+00:00 app[web.1]: Connecting to database specified by DATABASE_URL\n2012-10-29T16:47:09+00:00 app[web.1]: [2012-10-29 16:47:09] INFO  WEBrick 1.3.1\n2012-10-29T16:47:09+00:00 app[web.1]: [2012-10-29 16:47:09] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]\n2012-10-29T16:47:09+00:00 app[web.1]: [2012-10-29 16:47:09] INFO  WEBrick::HTTPServer#start: pid=2 port=30276\n2012-10-29T16:47:10+00:00 heroku[web.1]: Process exited with status 137\n2012-10-29T16:47:10+00:00 heroku[web.1]: State changed from starting to up\n2012-10-29T16:47:46+00:00 app[web.1]: Started GET \"/\" for 66.108.172.226 at 2012-10-29 16:47:46 +0000\n2012-10-29T16:47:46+00:00 app[web.1]: \n2012-10-29T16:47:46+00:00 app[web.1]: \n2012-10-29T16:47:46+00:00 app[web.1]: Processing by HomeController#index as HTML\n2012-10-29T16:47:46+00:00 app[web.1]:   Rendered home/index.html.erb within layouts/application (12.3ms)\n2012-10-29T16:47:46+00:00 app[web.1]: ActionView::Template::Error (PG::Error: ERROR:  relation \"users\" does not exist\n2012-10-29T16:47:46+00:00 app[web.1]:                                         ^\n2012-10-29T16:47:46+00:00 app[web.1]:              WHERE a.attrelid = '\"users\"'::regclass\n2012-10-29T16:47:46+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d\n2012-10-29T16:47:46+00:00 app[web.1]:                AND a.attnum &gt; 0 AND NOT a.attisdropped\n2012-10-29T16:47:46+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n2012-10-29T16:47:46+00:00 app[web.1]:   Rendered layouts/_header.html.erb (59.5ms)\n2012-10-29T16:47:46+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull\n2012-10-29T16:47:46+00:00 app[web.1]: \n2012-10-29T16:47:46+00:00 app[web.1]: Completed 500 Internal Server Error in 144ms\n2012-10-29T16:47:46+00:00 app[web.1]: LINE 4:              WHERE a.attrelid = '\"users\"'::regclass\n2012-10-29T16:47:46+00:00 app[web.1]:              ORDER BY a.attnum\n2012-10-29T16:47:46+00:00 app[web.1]:     1: \n2012-10-29T16:47:46+00:00 app[web.1]:     2:        &lt;nav class=\"clearfix\"&gt;\n2012-10-29T16:47:46+00:00 app[web.1]:     3:            &lt;% if !signed_in? %&gt;\n2012-10-29T16:47:46+00:00 app[web.1]:     4:                &lt;%= link_to \"home\", root_url %&gt;\n2012-10-29T16:47:46+00:00 app[web.1]: ):\n2012-10-29T16:47:46+00:00 app[web.1]:     6:                &lt;%= link_to \"my profile\", current_user %&gt;\n2012-10-29T16:47:46+00:00 app[web.1]:     5:            &lt;% else %&gt;\n2012-10-29T16:47:46+00:00 app[web.1]:   app/helpers/sessions_helper.rb:26:in `current_user'\n2012-10-29T16:47:46+00:00 app[web.1]: \n2012-10-29T16:47:46+00:00 app[web.1]:   app/helpers/sessions_helper.rb:13:in `signed_in?'\n2012-10-29T16:47:46+00:00 app[web.1]:   app/views/layouts/_header.html.erb:3:in `_app_views_layouts__header_html_erb__1629561108313014440_42800200'\n2012-10-29T16:47:46+00:00 app[web.1]:   app/views/layouts/application.html.erb:13:in `_app_views_layouts_application_html_erb__2023541485350786357_43765980'\n2012-10-29T16:47:46+00:00 app[web.1]: \n2012-10-29T16:47:46+00:00 heroku[router]: GET pacific-ravine-3563.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=1ms service=12ms status=200 bytes=1150\n2012-10-29T17:04:22+00:00 heroku[slugc]: Slug compilation started\n2012-10-29T17:04:41+00:00 heroku[slugc]: Slug compilation finished\n2012-10-29T17:04:41+00:00 heroku[web.1]: State changed from up to starting\n2012-10-29T17:04:43+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 38347`\n2012-10-29T17:04:44+00:00 heroku[web.1]: Stopping all processes with SIGTERM\n2012-10-29T17:04:44+00:00 app[web.1]: [2012-10-29 17:04:44] ERROR SignalException: SIGTERM\n2012-10-29T17:04:44+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'\n2012-10-29T17:04:50+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /app/config/environment.rb:5)\n2012-10-29T17:04:50+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /app/config/environment.rb:5)\n2012-10-29T17:04:50+00:00 heroku[web.1]: Stopping all processes with SIGTERM\n2012-10-29T17:04:51+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'\n2012-10-29T17:04:51+00:00 app[web.1]: [2012-10-29 17:04:51] ERROR SignalException: SIGTERM\n2012-10-29T17:04:55+00:00 app[web.1]: =&gt; Booting WEBrick\n2012-10-29T17:04:55+00:00 app[web.1]: =&gt; Rails 3.2.8 application starting in production on http://0.0.0.0:38347\n2012-10-29T17:04:55+00:00 app[web.1]: =&gt; Call with -d to detach\n2012-10-29T17:04:55+00:00 app[web.1]: =&gt; Ctrl-C to shutdown server\n2012-10-29T17:04:55+00:00 app[web.1]: Connecting to database specified by DATABASE_URL\n2012-10-29T17:04:55+00:00 heroku[web.1]: Error R12 (Exit timeout) -&gt; At least one process failed to exit within 10 seconds of SIGTERM\n2012-10-29T17:04:55+00:00 heroku[web.1]: Stopping remaining processes with SIGKILL\n2012-10-29T17:04:55+00:00 app[web.1]: [2012-10-29 17:04:55] INFO  WEBrick 1.3.1\n2012-10-29T17:04:55+00:00 app[web.1]: [2012-10-29 17:04:55] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]\n2012-10-29T17:04:55+00:00 app[web.1]: [2012-10-29 17:04:55] INFO  WEBrick::HTTPServer#start: pid=2 port=38347\n2012-10-29T17:04:56+00:00 heroku[web.1]: State changed from starting to up\n2012-10-29T17:04:57+00:00 heroku[web.1]: Process exited with status 137\n</code></pre>\n\n<p>schema</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121024185036) do\n\ncreate_table \"albums\", :force =&gt; true do |t|\n  t.string   \"name\"\n  t.datetime \"created_at\",  :null =&gt; false\n  t.datetime \"updated_at\",  :null =&gt; false\n  t.string   \"description\"\n  t.string   \"status\"\nend\n\ncreate_table \"friendships\", :force =&gt; true do |t|\n  t.integer  \"user_id\"\n  t.integer  \"friend_id\"\n  t.datetime \"created_at\", :null =&gt; false\n  t.datetime \"updated_at\", :null =&gt; false\n  t.string   \"status\"\nend\n\ncreate_table \"ownerships\", :id =&gt; false, :force =&gt; true do |t|\n  t.integer \"album_id\"\n  t.integer \"user_id\"\n  t.string  \"status\"\nend\n\ncreate_table \"photos\", :force =&gt; true do |t|\n  t.string   \"avatar_file_name\"\n  t.string   \"avatar_content_type\"\n  t.integer  \"avatar_file_size\"\n  t.datetime \"avatar_updated_at\"\n  t.datetime \"created_at\",          :null =&gt; false\n  t.datetime \"updated_at\",          :null =&gt; false\n  t.integer  \"album_id\"\nend\n\ncreate_table \"users\", :force =&gt; true do |t|\n  t.string   \"name\"\n  t.string   \"email\"\n  t.datetime \"created_at\",              :null =&gt; false\n  t.datetime \"updated_at\",              :null =&gt; false\n  t.string   \"password_digest\"\n  t.string   \"remember_token\"\n  t.string   \"profilepic_file_name\"\n  t.string   \"profilepic_content_type\"\n  t.integer  \"profilepic_file_size\"\n  t.datetime \"profilepic_updated_at\"\n  t.string   \"password_reset_token\"\nend\n\nadd_index \"users\", [\"remember_token\"], :name =&gt; \"index_users_on_remember_token\"\n</code></pre>\n\n<p>end</p>\n\n<p>heroku and local db:version</p>\n\n<pre><code>Edmunds-MacBook-Pro:pholder edmundmai$ heroku run rake db:version\nRunning `rake db:version` attached to terminal... up, run.1\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /app/Rakefile:7)\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /app/Rakefile:7)\nConnecting to database specified by DATABASE_URL\nCurrent version: 20120929230317\nEdmunds-MacBook-Pro:pholder edmundmai$ rake db:version\nCurrent version: 20121024185036\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13124717,"title":"\"Rails way\" to apply javascript to link","body":"<p>I have some plain HTML that provides some functionality when a link is clicked. I want to clean this up so that it is handled in a way that conforms to Ruby/Rails coding style. I tried messing with <code>link_to</code> helpers but couldn't figure out a clean way to handle this situation.</p>\n\n<pre><code>&lt;p&gt;...or &lt;a id=\"set_current_location\" href=\"#\"&gt;Use Current Location&lt;/a&gt;&lt;/p&gt;\n\n&lt;script&gt;\n$(function(){\n    $('#set_current_location').on('click', function(e){\n        e.preventDefault();\n        navigator.geolocation.getCurrentPosition(function(position) {\n            $.ajax({\n              type: 'POST',\n              url: '&lt;%= set_location_path %&gt;',\n              data: {\n                latitude: position.coords.latitude,\n                longitude: position.coords.longitude\n              },\n              async: false\n            });\n        })\n    });\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>Update: I've actually moved the javascript into a coffeescript file, so that's not really my question. I'm really just wondering if this looks like a rails-like way to approach this problem.</p>\n"},{"tags":["ruby-on-rails","facebook","tabs","koala"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13126351,"title":"Koala - Create tab in facebook (rails)","body":"<p>I want to create tabs on FB.</p>\n\n<p>I have this code:</p>\n\n<pre><code>@graph = Koala::Facebook::API.new(Client.find(session[:id_client]).oauth_token)\n@graph.put_connections(\"4154829881847172/tabs\",\"POST\", {:access_token =&gt; \"AAABwdtYjsyoBAMcg558a4FYnZBkZBUiPKmcWWssssWoNZC2yjqE43ghoR9uTiFIhT3ErkQYx45RrrPeOD0ZCvFgnmRIUh9lqRUw5KIlWwxtRW3GvbIEUWp0yB2\", :app_id =&gt; '1236553701115690'})\n</code></pre>\n\n<p>But I have a problem</p>\n\n<p>-> OAuthException: (#210) Subject must be a page.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13123197,"title":"Rails: each in random order","body":"<p>This is my code:</p>\n\n<pre><code>    &lt;% question.answers.each do |answer| %&gt;\n\n\n      &lt;li&gt;&lt;%= answer.content %&gt;&lt;/li&gt;\n\n\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I want to order the answer objects randomly. What would be the most efficient way to do so considering the amount of possible answers is less than say 10?</p>\n"},{"tags":["jquery","ruby-on-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":10922737,"title":"Why is my form being processed as an HTML request instead of JS?","body":"<p>I am developing on Rails 3.0.3 and using jQuery. Here is my javascipt include tag:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js\", \"rails.js\" %&gt;\n</code></pre>\n\n<p>I want to send a JS request on change of a dropdown and wrote the following code to do so. This form does not get processed as JS, but is getting processed as an HTML request instead:</p>\n\n<pre><code>&lt;% form_tag(aggregatedata_path, :method=&gt;'post', :id =&gt; \"dd-container\", :remote =&gt; true ) do %&gt;\n    &lt;%= select_tag( \n        :group, \n        options_for_select(groups_list, @group), \n        {\n            :id =&gt; \"dd\", \n            :onchange =&gt; \"this.form.submit();\"\n        } ) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I read a similar post on SO that suggested the problem was the js library, but unless there's no other way, I'd rather avoid changing that at this point lest a million other things break. I have another form that gets processed as a JS request just fine. Here it is:</p>\n\n<pre><code>&lt;% form_tag(poweroutput_path, :method=&gt;'post', :id =&gt; \"date-form\", :remote =&gt; true ) do %&gt;\n    &lt;%= text_field_tag(\n        'dt', nil,\n        {  \n            :id =&gt; 'date-field',\n            :class =&gt; 'dateformat-d-dt-m-dt-Y',\n            :value =&gt; Time.now.getlocal.strftime(\"%d.%m.%Y\")             \n        }) %&gt;\n    &lt;%= submit_tag \" \", :id =&gt; \"go-button\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The only obvious difference I see is that the first one uses <code>:onchange =&gt; \"this.form.submit();\"</code> while the second does not. Is there something in that function that overrides my earlier <code>:remote =&gt; true</code>?</p>\n"},{"tags":["ruby-on-rails","facebook-graph-api","amazon-s3","carrierwave","fog"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13125093,"title":"Downloading Image to tmp folder from S3","body":"<p>I'm using carrierwave + fog to work with S3. I'm saving images there, then I need to grab one of this image and post it to fb... So what I need to do is to download the image to the server, I couldn't find a way of doing this with carrierwave... And I don't know how to do it because to post the image to fb I need to call a POST to their api with a FILE... It would be great to post using the url of the S3 server...</p>\n\n<p>Any idea on how I can do this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","rack","middleware"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":184,"score":3,"question_id":7112604,"title":"Building middleware that grabs the IP","body":"<p>I'm trying to write my firsts rack middleware. And need help. I want middleware that find the requestor's IP and if it is in the allowed list of IP continues the request, otherwise it aborts.</p>\n\n<p>The tricky part is I need this to work on heroku where you can't use request.ip: <a href=\"http://developerhemal.tumblr.com/post/3958107290/client-ip-addresses-on-heroku\" rel=\"nofollow\">http://developerhemal.tumblr.com/post/3958107290/client-ip-addresses-on-heroku</a></p>\n\n<p>So I have the following:</p>\n\n<pre><code>class RestrictIP\n  def initialize(app, message = \"Hello\")\n    @app = app\n    @message = message\n  end\n\n  def call(env)\n    dup._call(env)\n    @ip = env['HTTP_X_REAL_IP'] ||= env['REMOTE_ADDR']\n  end\n\n  def each(&amp;block)\n    block.call(\"&lt;!-- #{@ip} --&gt;\\n\")\n    @response.each(&amp;block)\n  end\nend\n</code></pre>\n\n<p>This errors with:</p>\n\n<pre><code>NoMethodError (You have a nil object when you didn't expect it!\nYou might have expected an instance of Array.\nThe error occurred while evaluating nil.[]=):\n</code></pre>\n\n<p>For my first itteration I just want to make sure I can grab and put the requestor's IP on the html doc. </p>\n\n<p>Any rack middleware experts out there? Thanks</p>\n"},{"tags":["html","ruby-on-rails","ruby","recaptcha"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":53,"score":-3,"question_id":13126211,"title":"How do I find the Recaptcha ID?","body":"<p>I've been stuck on something for the past day. I'm building a RoR bot, and part of it involves signing up for an email account with mail.com. I've automated all the filling out of the form, apart from the captcha (Recaptcha). </p>\n\n<p>I'll be using the deathbycaptcha Ruby gem. However, in order to have the captcha solved, I'll need to get either its ID or its URL. While this shows up when I \"enable form details\" with the Firefox Web Developer toolbar, it doesn't seem to be in the source. How can I find it out? I'm using Watir.</p>\n\n<p>Thanks!</p>\n\n<p>Joe</p>\n\n<p><a href=\"http://service.mail.com/registration.html\" rel=\"nofollow\">http://service.mail.com/registration.html</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13123268,"title":"How to render different partial for different type of an object belongs to other object in controller","body":"<p>I'm built app which allow users create questions are type: True/False, Single and Multiple Choice. So, I have created some models:</p>\n\n<pre><code>class QuestionType &lt; ActiveRecord::Base\n  attr_accessible :name, :shorcut\nend\n\nclass Question &lt; ActiveRecord::Base\n  attr_accessible :content, :mark, :topic_id, :question_type_id, :answers_attributes\n  belongs_to :topic\n  belongs_to :user\n  belongs_to :question_type\n  has_many :answers, dependent: :destroy\n  accepts_nested_attributes_for :answers\nend\n\nclass Answer &lt; ActiveRecord::Base\n  attr_accessible :content, :question_id, :correct\n\n  belongs_to :question\nend\n</code></pre>\n\n<p>Now i would to build an index page of questions, have 3 link to add question for 3 type of question, when users click a link, they will go to page to create question and page will have appropriate form for type of that question. In Question controller, i want to store question type id to save to question.<br>\nI think the addresses like this:</p>\n\n<p><a href=\"http://example.com/questions/index\" rel=\"nofollow\">http://example.com/questions/index</a> : Index page will have 3 link to create question.</p>\n\n<p><a href=\"http://example.com/question_types/1/questions/new\" rel=\"nofollow\">http://example.com/question_types/1/questions/new</a>: Will render partial form for True/False question</p>\n\n<p><a href=\"http://example.com/question_types/2/questions/new\" rel=\"nofollow\">http://example.com/question_types/2/questions/new</a>: Will render partial form for Single choice question</p>\n\n<p><a href=\"http://example.com/question_types/1/questions/new\" rel=\"nofollow\">http://example.com/question_types/1/questions/new</a>: Will render partial form for Multiple choice question</p>\n\n<p>I think i have to put nested resources in my routes with question type and question model to have above type of link, but i don't know how to build view and separate like above. please help me or give me an idea, better way to do it :(</p>\n"},{"tags":["ruby-on-rails","postgresql","heroku","sqlite3","taps"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":13111127,"title":"heroku db:push error with toolbelt","body":"<p>Is there a way to download Heroku toolbelt with ruby 1.9.3 ?\nNow It automatically installs 1.9.2 from the homepage - <a href=\"https://toolbelt.heroku.com/\" rel=\"nofollow\">https://toolbelt.heroku.com/</a>.</p>\n\n<p>Can't do db:push to Heroku, because of this.</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>I found it here - <a href=\"http://assets.heroku.com/heroku-toolbelt/heroku-toolbelt-2.25.1.exe\" rel=\"nofollow\">http://assets.heroku.com/heroku-toolbelt/heroku-toolbelt-2.25.1.exe</a></p>\n"},{"tags":["javascript","ruby-on-rails","paperclip"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":13126056,"title":"ruby on rails:multiple upload and view","body":"<p>I am currently using paperclip to upload a single photo. When the user goes to the show view, it shows the photo and the info related to it. Now I want to update it to accept multiple photos so that all of the photos are shown on the show view. What do I need to use? (JavaScript and update paper-clip to take multiple uploads?) Or is there something else? </p>\n\n<p>I have read <a href=\"http://sleekd.com/general/adding-multiple-images-to-a-rails-model-with-paperclip/\" rel=\"nofollow\">http://sleekd.com/general/adding-multiple-images-to-a-rails-model-with-paperclip/</a></p>\n"},{"tags":["ruby-on-rails","ruby","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":144,"score":1,"question_id":8235899,"title":"How does rake migrate actually work","body":"<p>I've just really started with Ruby and Rails, and one of the things that I find myself really enjoying is the conventions it makes you use.</p>\n\n<p>I want to mimic that behavior in my own non-Ruby projects. </p>\n\n<p>My question is how does it actually work? I know I can look through the Rails code, but I'm not that far enough in my understanding to know what's going on in it.</p>\n\n<p>I know that it takes a baseline script and then runs update schema changes against it. But how does it know what version it's on? How would I mimic that in another framework / database?</p>\n"},{"tags":["ruby-on-rails","datamapper","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13124728,"title":"RangeError Exception: offset 25 and limit 25 are outside allowed range Pagination Kaminari","body":"<p>I am trying to paginate some items from my database however I am getting this error when I try to go onto page two of my pagination:</p>\n\n<pre><code>RangeError Exception: offset 25 and limit 25 are outside allowed range\n</code></pre>\n\n<p>This is the code in my controller that sets up the pagination:</p>\n\n<pre><code>@activities = (current_user.followed_users.activities(:order =&gt; [:created_at.desc]) + current_user.followed_centers.activities(:order =&gt; [:created_at.desc])).all(:limit =&gt; 40)\n\nunless (params[:page].nil?)\n  @page = params[:page].to_i\nend\n\nunless (@page.nil?)\n  @activities = Kaminari.paginate_array(@activities).page(@page).per(10)\nelse\n  @activities = Kaminari.paginate_array(@activities).page(0).per(10)\nend\n</code></pre>\n\n<p>I limit the amount of objects returned in my query to 40, then try to paginate the result set however I am getting a range error. I am not sure what the problem is here. If I take the limit off my initial query this works fine.</p>\n\n<p>This is the output in the terminal:</p>\n\n<pre><code>RangeError (offset 25 and limit 25 are outside allowed range):\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core/query.rb:1298:in `get_relative_position'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core/query.rb:592:in `slice!'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core/query.rb:567:in `slice'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core/collection.rb:1414:in `sliced_query'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core/collection.rb:396:in `[]'\n  app/controllers/users_controller.rb:64:in `stream'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core.rb:263:in `block in repository'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core/repository.rb:114:in `scope'\n  lib/ct_gems/dm-core-1.2.0/lib/dm-core.rb:263:in `repository'\n</code></pre>\n\n<p>Can anyone help please?</p>\n"},{"tags":["ruby-on-rails","amazon-dynamodb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":436,"score":0,"question_id":9460412,"title":"Is that possible to create db migration for dynamo db in ruby on rails","body":"<p>I am using rails 3 and for dynamo db using 'aws-sdk' gem . And I have some doubt in db migration.</p>\n\n<p>1) Is that possible to create db migration for dynamo db in ruby on rails?</p>\n\n<p>2) If so how to write? Because of the dynamo db has no table field name only key value pairs, we need to create only table and primary key?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","internationalization","ruby-on-rails-3.1"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":1742,"score":7,"question_id":8829725,"title":"I18n: How to check if a translation key/value pairs is missing?","body":"<p>I am using Ruby on Rails 3.1.0 and the <a href=\"https://github.com/svenfuchs/i18n\">I18n gem</a>. I (am implementing a plugin and) I would like to check <em>at runtime</em> if the I18n is missing a translation key/value pairs and, if so, to use a custom string. That is, I have:</p>\n\n<pre><code>validates :link_url,\n  :format     =&gt; {\n    :with =&gt; REGEX,\n    :message  =&gt; I18n.t(\n      'custom_invalid_format',\n      :scope =&gt; 'activerecord.errors.messages'\n  )\n}\n</code></pre>\n\n<p>If in the <code>.yml</code> file there is not the following code</p>\n\n<pre><code>activerecord:\n  errors:\n    messages:\n      custom_invalid_format: This is the test error message 1\n</code></pre>\n\n<p>I would like to use the <code>This is the test error message 2</code>. <strong>Is it possible? If so, how can I make that?</strong></p>\n\n<p><em>BTW</em>: For performance reasons, is it advisable to check <em>at runtime</em> if the translation key/value pairs is present?</p>\n"},{"tags":["ruby-on-rails","ubuntu-12.04","pg"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13120588,"title":"error installing gem pg version 0.12.2 on Ubuntu 12.04","body":"<p>im running on Ubuntu 12.04 and i'm trying to install the pg gem v '0.12.2' on Ruby 1.9.3p194 / Rails 3.2.3. I have installed libpq-dev and build-essential but i still get the same error:</p>\n\n<pre><code>ERROR:  While executing gem ... (Gem::FilePermissionError)\n    You don't have write permissions into the /var/lib/gems/1.9.1 directory.\nfernando@ubuntu:/media/fernando/OS/Rails/oops_booking$ sudo gem install pg -v '0.12.2'\nBuilding native extensions.  This could take a while...\nERROR:  Error installing pg:\n    ERROR: Failed to build gem native extension.\n\n        /usr/bin/ruby1.9.1 extconf.rb\nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nchecking for libpq-fe.h... yes\nchecking for libpq/libpq-fs.h... yes\nchecking for PQconnectdb() in -lpq... yes\nchecking for PQconnectionUsedPassword()... yes\nchecking for PQisthreadsafe()... yes\nchecking for PQprepare()... yes\nchecking for PQexecParams()... yes\nchecking for PQescapeString()... yes\nchecking for PQescapeStringConn()... yes\nchecking for PQgetCancel()... yes\nchecking for lo_create()... yes\nchecking for pg_encoding_to_char()... yes\nchecking for PQsetClientEncoding()... yes\nchecking for rb_encdb_alias()... yes\nchecking for rb_enc_alias()... no\nchecking for struct pgNotify.extra in libpq-fe.h... yes0\nchecking for unistd.h... yes\nchecking for ruby/st.h... yes\ncreating extconf.h\ncreating Makefile\n\nmake\ncompiling compat.c\ncompiling pg.c\npg.c: In function ‘pgconn_wait_for_notify’:\npg.c:2117:3: warning: ‘rb_thread_select’ is deprecated (declared at /usr/include/ruby-1.9.1/ruby/intern.h:379) [-Wdeprecated-declarations]\npg.c: In function ‘pgconn_block’:\npg.c:2592:3: error: format not a string literal and no format arguments [-Werror=format-security]\npg.c:2598:3: warning: ‘rb_thread_select’ is deprecated (declared at /usr/include/ruby-1.9.1/ruby/intern.h:379) [-Wdeprecated-declarations]\npg.c:2607:4: error: format not a string literal and no format arguments [-Werror=format-security]\npg.c: In function ‘pgconn_locreate’:\npg.c:2866:11: warning: variable ‘lo_oid’ set but not used [-Wunused-but-set-variable]\npg.c: In function ‘find_or_create_johab’:\npg.c:3947:3: warning: implicit declaration of function ‘rb_encdb_alias’ [-Wimplicit-function-declaration]\ncc1: some warnings being treated as errors\nmake: *** [pg.o] Error 1\n</code></pre>\n\n<p>i did install succesfully the newest version of pg gem but i really need to work with the version 0.12.2</p>\n\n<p>thanks in advance</p>\n"},{"tags":["ruby-on-rails","plsql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":9636147,"title":"Select record after plsql insertion","body":"<p>How do I select a record which has been previously created with a \"plsql\" procedure? I am using the \"ruby-plsql\" gem.</p>\n\n<pre><code>// This procedure will add a record to a table\nplsql.package(parameter);\n</code></pre>\n\n<p>Once the record has been added, I will select it.</p>\n\n<p>When I do this I get the following error:</p>\n\n<pre><code>ActiveRecord::RecordNotFound (Couldn't find [Controller] with [WHERE clause])\n</code></pre>\n\n<p>I have already tried without success to force the commit like this:</p>\n\n<pre><code>plsql.commit() or plsql.connection.autocommit = true\n</code></pre>\n\n<p>Can somebody help me?</p>\n\n<p>Thank you very much in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","thinking-sphinx"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13069907,"title":"Zip code based search","body":"<p>I have an app where shop owners can enter 10 zip codes in which they can provide services. Currently these zip codes are stored in single table column. Now what is the best and efficient way to do search based on this? Should I store all zip codes(all US zip codes) in a table and establish <code>many to many</code> relationship or do text search based on the current field using thinking sphinx?</p>\n"},{"tags":["ruby-on-rails"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":567,"score":0,"question_id":9063751,"title":"What flash message types are available in Rails?","body":"<p>So far I've got:</p>\n\n<ul>\n<li>:notice</li>\n<li>:alert</li>\n<li>:error</li>\n</ul>\n\n<p>but is there definitive list, that can be used in place, such as in <code>redirect_to path, :error =&gt; \"Oh no!\"</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","rails-admin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13125359,"title":"Including rails_admin configuration as a mixin","body":"<p>I'm not sure why this is not working for me, but I would like to have the configuration of each model that is under the scope of rails_admin to be a mixin that I include into a model.  This gives me the benefit of a separation of concern, while avoiding having to restart the server each time I make a change which would be an issue with just using the rails_admin.rb file.</p>\n\n<p>So I have a model, app/models/section.rb</p>\n\n<pre><code>class Section\n  include SectionAdmin\n</code></pre>\n\n<p>And in models/section_admin.rb (I put it here to get it working before moving it into lib) I have:</p>\n\n<pre><code>module SectionAdmin\n  rails_admin do \n    ...\n</code></pre>\n\n<p>But I get the error: </p>\n\n<pre><code>undefined method `rails_admin' for main:Object\n</code></pre>\n\n<p>Which is confusing to me, since as a mixin I thought it wasn't evaluated until it was included.  It's also confusing because even when I include 'require \"rails_admin\"' in the module I still get the error.  Any ideas? </p>\n"},{"tags":["ruby-on-rails","ruby","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13124839,"title":"Or-ing relationships in rails","body":"<p>I have a number of many to many relationships between two tables with conditionals representing different roles.</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n  ...\n  has_many :course_mentors, :conditions =&gt; { :type_str =&gt; \"mentor\" }, :class_name =&gt; CourseUser\n  has_many :mentors, :through =&gt; :course_mentors, :source =&gt; :user\n\n  has_many :course_enrollees, :conditions =&gt; { :type_str =&gt; \"enrollee\" }, :class_name =&gt; CourseUser\n  has_many :enrollees, :through =&gt; :course_enrollees, :source =&gt; :user\n  ...\nend\n</code></pre>\n\n<p>To retrieve the contents of one of the associations on its own I can simply do @course.enrollees, @course.mentors etc. However sometimes it would be convenient to be able to get both enrollees and mentors together.</p>\n\n<p>I have many different associations which makes it impractical to create additional associations for each combination of single associations. One can always do</p>\n\n<pre><code>(@course.enrollees + @course.mentors).sort\n</code></pre>\n\n<p>however this results in two requests to the database and possibly duplicate entries.</p>\n\n<p>I have also investigated the <code>merge</code> function on associations, however this just returns an empty relation.</p>\n\n<p>What is the best rails like way of doing this?</p>\n"},{"tags":["ruby-on-rails","ajax","error-handling"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13090480,"title":".js.erb file available to all other views?","body":"<p>So, in my rails app I ajaxified the error messages on one of my pages. the process was (so everyone understands) first, in my 'edit' <code>link_to</code> I added <code>:remote =&gt; true</code> at the end of it thus having it send an ajax request. I then added the line <code>format.js</code> in my <code>respond_to do |format|</code> block. Then, I made an edit.js.erb file with the following line of code <code>$('#error').html(\"&lt;%= flash[:error] %&gt;\");</code>  which basically finds the error div in the current page and replaces the html in that div with the error flash message. This is cool right? No more annoying page refreshes in the event of an error.</p>\n\n<p>Question is, I want to do this for all my edit and destroy pages, but how without making an edit.js.erb and destroy.js.erb file for each view folder? seems pretty simple, and maybe im just missing an obvious answer because I'm exhausted, but I can't figure it out... so... help?????</p>\n\n<p>EDIT!</p>\n\n<p>this is my edit controller</p>\n\n<pre><code>def edit\nuser = User.find(session[:id])\n@table = Table.find(params[:id])\n\n\n\nif user.id != @table.created_by\n\n  flash[:error] = \"ERROR\"\n  respond_to do |format|\n    format.js {render :template =&gt; 'shared/show_error'}\n    format.html\n  end\nelse\n  flash[:error] = \"\"\n  respond_to do |format|\n    format.js {render :template =&gt; 'table/edit', :formats =&gt; :html}\n    format.html\n  end\n\nend\nend\n</code></pre>\n\n<p>Problem now is, it works fine for showing the errors but if there are no errors it doesnt action render the edit page... In the server window it shows it did, but it doesnt actually show on the screen... Any ideas?</p>\n"},{"tags":["ruby-on-rails","cookies","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13124633,"title":"rspec: testing cookie options","body":"<p>I'd like to test if my Rails controller sets a valid options (in this case <code>path</code>) for cookie. How could I do it with RSpec?</p>\n\n<p>My code:</p>\n\n<pre><code>#Controller\ndef action\n  #(...)\n  cookies[:name] = { value:cookie_data,\n                     path: cookie_path }\n  #(...)\nend\n\n#spec \nit \"sets cookie path\" do\n  get 'action'\n  #I'd like do to something like that\n  response.cookies['name'].path.should == '/some/path' \nend\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13122579,"title":"Am I handling the architecture of my Rails site correct?","body":"<p>this is a rather subjective question. I am looking for expert opinion because this is the first time I'm architecting an enterprise rails application.</p>\n\n<p>I decided to make my site completely AJAX based and I'm not using Rails AJAX helpers at all. Reason being: I'm new to web development and I like to know what's happening behind the code I'm writing.</p>\n\n<p>Also, this is a fairly large dashboard based analytics application and I'm absolutely not using any erb tags. All data comes and goes using AJAX.</p>\n\n<p>So, whenever I need any data, I write a rails route like this</p>\n\n<pre><code>match \"people/all\" =&gt; \"people#all\"\n\nrespond_to do |format|\n    format.json { all json is rendered here }\nend\n</code></pre>\n\n<p>Same goes for POST calls.</p>\n\n<p>Am I doing it right? </p>\n\n<p>The next thing I'm going to do is to add CSRF token security ( if it doesn't match, controller will send no AJAX back )</p>\n\n<p>I'm also driving an API for mobile apps off this project but the API is protected with keys.</p>\n\n<p>I know maybe something like ember or a micro framework could have been a better choice but I chose rails because my application is going to have loads of features so I stuck with rails instead of diving into another framework.</p>\n\n<p>So,</p>\n\n<ol>\n<li><p>Is it in some way bad to make rails views without erb tags and do everything with AJAX?</p></li>\n<li><p>Is my app going to be vulnerable in any way?</p></li>\n</ol>\n\n<p>thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13124460,"title":"Ruby on Rails has_many_through with validation and logic to ensure only one record in the join table which is updated as required","body":"<p>I have the Course model which has a number of has many through associations with the User model with join table CourseUser. The join table has an attribute type_str which specifies which role the user takes on. I have added validation to ensure that only one record is present in the join table for each course, user pair. The problem is ensuring that this record is updated if it is already present, rather than adding a new one which of course makes validation fail.</p>\n\n<p>User class:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n...\n  has_many :courses_enrolled_on, :through =&gt; :course_enrollees, :source =&gt; :course, :conditions =&gt; { :course_users =&gt; { :type_str =&gt; \"enrollee\" } }\n\n  has_many :course_users\n  has_many :courses, :through =&gt; :course_users, :source =&gt; :course, :readonly =&gt; true \nend\n</code></pre>\n\n<p>Course class</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n\n  has_many :course_enrollees, :conditions =&gt; { :type_str =&gt; \"enrollee\" }, :class_name =&gt; CourseUser\n  has_many :enrollees, :through =&gt; :course_enrollees, :source =&gt; :user\n\n  has_many :course_users\n  has_many :users, :through =&gt; :course_users, :source =&gt; :user, :readonly =&gt; true\nend\n</code></pre>\n\n<p>Course class:</p>\n\n<pre><code>class CourseUser &lt; ActiveRecord::Base\n  belongs_to :course\n  belongs_to :user\n\n   validates_uniqueness_of :course_id, :scope =&gt; :user_id\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","devise","passwords"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13124264,"title":"Ruby on Rails: Devise - Not updating password change","body":"<p>I have an app that allows users to enter projects into a database, where they can search for them later. Each user has their own login, which will be given out by a system admin. When the user logs in for the first time, I want the usual homepage to show a \"Change your password\" view, so that the user has to change their password before using the app.</p>\n\n<p>I have set up a <code>pass_change</code> boolean column in the User table, which is <code>false</code> when a new user is created.</p>\n\n<p>At the moment, when the user logs in for the first time, they are brought to the change password view, but when I test this function, the password doesn't change and the view stays the same after I submit the new password, and the <code>pass_change</code> for that user doesn't change to <code>true</code>.</p>\n\n<p><strong>Index view:</strong></p>\n\n<pre><code>&lt;html&gt;\n&lt;% if current_user.pass_changed == true %&gt;  \n    &lt;%= stylesheet_link_tag  \"index\"%&gt;\n    &lt;body&gt;\n    &lt;div id = \"section1\"&gt;\n    &lt;div class = \"h1\"&gt;Database Search&lt;/div&gt;&lt;%= current_user.pass_changed %&gt;\n    &lt;div class = \"h3\"&gt;What would you like to do?&lt;/div&gt;\n    &lt;div class=\"new_project_button\"&gt;\n       &lt;%= button_to \"Create New Project\", new_project_path, :class =&gt; \"button\", :method =&gt; \"get\" %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"search_button\"&gt;\n        &lt;%= button_to \"      Search      \", search_path, :class =&gt; \"button\", :method =&gt; \"get\" %&gt;\n    &lt;/div&gt;\n    &lt;/div&gt; \n    &lt;/body&gt;  \n&lt;%else%&gt;\n    &lt;%= form_for(current_user, :as =&gt; :user, :url =&gt; password_path(current_user), :html =&gt; { :method =&gt; :put }) do |f| %&gt;\n        &lt;%= devise_error_messages! %&gt;\n        &lt;div class = \"signin\"&gt;\n        &lt;div class = \"field\"&gt;New Password: &lt;%= f.password_field :password, :class =&gt; \"password\" %&gt;\n        &lt;/div&gt;\n        &lt;div class = \"field\"&gt;Confirm: &lt;%= f.password_field :password_confirmation, :class =&gt; \"password\" %&gt;\n        &lt;/div&gt;\n\n        &lt;%= f.hidden_field :pass_changed, :value =&gt; true %&gt;\n        &lt;div class = \"signup_button\"&gt;&lt;%= f.submit \"Change my password\", :class =&gt; \"button\" %&gt;\n        &lt;/div&gt;\n\n        &lt;/div&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n&lt;/html&gt; \n</code></pre>\n\n<p>Here are my logs when I try to change the password:</p>\n\n<pre><code>Started PUT \"/users/password\" for 127.0.0.1 at 2012-10-29 14:15:05 +0000\nProcessing by Devise::PasswordsController#update as HTML\n  Parameters: {\"utf8\"=&gt;\"Ô£ô\", \"authenticity_token\"=&gt;\"eBU5jvN6C+JSIZNmsEaxUyydrvPRjtGZeWLxlQzFJKI=\", \"user\"=&gt;{\"password\"=\n&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\", \"pass_changed\"=&gt;\"true\"}, \"commit\"=&gt;\"Change my password\"}\n  ←[1m←[35mUser Load (0.0ms)←[0m  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 7 LIMIT 1\nRedirected to http://localhost:3000/\nFilter chain halted as :require_no_authentication rendered or redirected\nCompleted 302 Found in 0ms (ActiveRecord: 0.0ms)\n\n\nStarted GET \"/\" for 127.0.0.1 at 2012-10-29 14:15:05 +0000\nProcessing by ProjectsController#index as HTML\n  ←[1m←[36mUser Load (0.0ms)←[0m  ←[1mSELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 7 LIMIT 1←[0m\n  ←[1m←[35mProject Load (0.0ms)←[0m  SELECT \"projects\".* FROM \"projects\"\n  Rendered projects/index.html.erb within layouts/application (0.0ms)\nCompleted 200 OK in 16ms (Views: 15.6ms | ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>and in my user model I have added:</p>\n\n<pre><code>after_update :update_pass_changed\n\ndef update_pass_changed\n  self.pass_changed = true\n  self.save\nend\n</code></pre>\n\n<p>Can anyone see what I might be doing wrong? I am using the devise gem to handle authentication. Any help at all would be much appreciated. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":108,"score":2,"question_id":9967879,"title":"rails 3.1 - simple_captcha doesn't generate image","body":"<p>I am trying to use simple_captcha on my application but it doesn't seem to produce an image on my dev machine. 1.8.7, rails 3.1 here. If I attempt to visit the image URL i get an error \"cannot generate tempfile `'\".</p>\n\n<p>Any ideas? I 'd like some help since I don't want to use recaptcha. thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13065741,"title":"Rails app for multiple domains","body":"<p>I need to create a service with the same five sites and one that will unite them, but everyone has to live on a separate domain. Maybe somehow run one instance Rails app redirect users depending on the domain? Or is it better to start on a new Rails app per instance?</p>\n"},{"tags":["ruby-on-rails","heroku","web","migration","production"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13122108,"title":"Error command : heroku run rake db:migrate","body":"<p>I have a simply app with rails 3.2.8 and MySQL in development, when I try to use this command > heroku run rake db:migrate I have this error : \n  <strong>PG::Error: ERROR:  column \"name\" of relation \"users\" already exists\n  : ALTER TABLE \"users\" ADD COLUMN \"name\" character varying(255)</strong></p>\n\n<p>here is my schema.rb</p>\n\n<p><a href=\"http://pastie.org/5132185\" rel=\"nofollow\">http://pastie.org/5132185</a></p>\n\n<p>I don't know how to do, to fix this error.</p>\n"},{"tags":["ruby-on-rails","image","upload","carrierwave"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13124324,"title":"Solutions for selecting and attaching images to models?","body":"<p>I'm trying to be lazy and would rather find an existing gem, plugin, etc. instead of writing my own implementation. The use case seems to me general enough that there may be something out there, but I can't find anything.</p>\n\n<p>We're using Ruby on Rails and carrierwave to have users upload images that attach to so-called activities (which need to be curated several times a day). It turns out that users often (re-)use the same images for different activities. Instead of making the users upload the same image again all the time, I want to present them with a small gallery of images, and let them pick one to be used (or let them upload if they really want to, of course).</p>\n\n<p>Is there something out there that would help me ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","table","will-paginate","infinite-scroll"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13001593,"title":"Rails Endless Page / Infinite Scroll","body":"<p>I asked this same question yesterday, but I do not think I was clear enough with what I wanted. I am using twitter bootstrap and will_paginate, and I have a table on which I would like to implement infinite scrolling. That table is a fixed length and already scrolls. I recently followed the revised version of Railscasts Episode #114, but it does not work for me. When I scroll to the bottom of the table, it says fetching more articles, but it does not actually fetch more articles. Here is my code:</p>\n\n<p><strong>Articles.js.coffee:</strong></p>\n\n<pre><code>    jQuery -&gt;\n  if $('.pagination').length\n          $(articles).scroll -&gt;\n                  url = $('.pagination .next_page').attr('href')\n                  if url &amp;&amp;  $(articles).scrollTop() &gt; $(document).height() -             \n                  $(articles).height() + 585\n                      $('.pagination').text('Fetching more players...')\n                      $.getScript(url)\n    $(articles).scroll()\n</code></pre>\n\n<p><strong>Index.js.erb:</strong></p>\n\n<pre><code>$('#articles').append('&lt;%= j render(@articles) %&gt;');\n&lt;% if @articles.next_page %&gt;\n$('.pagination').replaceWith('&lt;%= j will_paginate(@articles) %&gt;');\n&lt;% else %&gt;\n$('.pagination').remove();\n&lt;% end %&gt;\n</code></pre>\n\n<p>My controller and table are both called Articles. I do not know if it is not working because it is a table versus a whole page. </p>\n\n<p>Please let me know if I need to post any more files.\nAny help would be appreciated</p>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["ruby-on-rails","session","cookies"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13124026,"title":"Session cookies and subdomains","body":"<p>This is not the usual \"how do I use the same session across multiple subdomains\" question.</p>\n\n<p>In fact, I want to do the opposite. I want to have a central domain where people can sign up for a service (foo.com) and then they later authenticate on a subdomain that's assigned to them (bar.foo.com). But I don't want someone signed in there to be signed in on other subdomains (such as baz.foo.com).</p>\n\n<p>Now, my understanding is that this should be accomplished in a cookie session store by setting the <code>domain</code> key in the cookie to the full domain name <em>without</em> a leading <code>.</code>, since a cookie for <code>domain: .foo.com</code> would apply to subdomains as well.</p>\n\n<p>So the app I work on <em>used</em> to have cross-subdomain sessions, so we had a class in <code>lib</code> that looked like this.</p>\n\n<pre><code>class OurCookieStore &lt; ActionDispath::Session::CookieStore\n\n  def set_cookie(request, options)\n    domain = Rails.application.config.domain\n    options[:domain] = \".#{domain.name}\"\n    super(request, options)\n  end\nend\n</code></pre>\n\n<p>(Don't worry about where the domain name comes from - there's some custom middleware in there, and it's not the problem.)</p>\n\n<p>If you're curious, the <code>super</code> method looks like this (I'm using <code>Rails 3.0.11</code>):</p>\n\n<pre><code>def set_cookie(request, options)\n  request.cookie_jar.signed[@key] = options\nend\n</code></pre>\n\n<p>So I thought the change would be as simple as removing the leading <code>.</code> I made just that edit to this method. Afterward, the <code>set_cookie</code> method was doing its job as expected. Exploration in the debugger confirmed that it was being set by the custom cookie store with a <code>domain</code> key of <code>'lvh.me'</code>, without a leading <code>.</code>.</p>\n\n<p>However, when I inspect my cookie in my browser (tested with both Chrome and Firefox), it looks like this:</p>\n\n<pre><code>Domain: .lvh.me\n</code></pre>\n\n<p>and I cannot get the sessions to work as expected! (Yes, I've cleared the cookies many many times; I'm not just inspecting an old cookie.)</p>\n\n<p>From what I've read, that leading dot should not be there unless it's added by something. And as far as I can tell nothing in Rails or in the app I'm working on should be adding it. Why is it showing up, and how can I get rid of it? </p>\n"},{"tags":["ruby-on-rails","certificate","ca"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13028355,"title":"Sign new certificates in Rails application","body":"<p>I have a Rails application with a public REST API which authenticates API clients using SSL client certificates.</p>\n\n<p>I would like the app to act as a simple CA.\nAdmin users should be able to visit a page on the site and request a new certificate. The application should generate a new SSL cert, signed with the application's private key, and return it in some form to the admin user.</p>\n\n<p>The admin user will then install this cert in client apps. These apps will then be able to use the new cert to access the REST API.</p>\n\n<p>What is the easiest way of implementing this? The only way I know of generating and signing new certs is with the <code>openssl</code> command line, after configuring <code>openssl</code> as a CA on the server (e.g. <a href=\"http://it.toolbox.com/blogs/securitymonkey/howto-securing-a-website-with-client-ssl-certificates-11500\" rel=\"nofollow\">like this</a>). Do I need to do that, and communicate with <code>openssl</code> using backticks inside Rails? That seems fiddly and fragile.</p>\n\n<p>How should I return the cert to admins? I could just pass them out the cert as a text file to download. I have seen CA web interfaces which allow users to request a cert from a browser, and then install the cert directly into the browser. The admins would then have to export the cert to pass it to the client scripts.</p>\n\n<p>I don't suppose there is any kind of \"<code>acts_as_CA</code>\" gem for Rails?</p>\n\n<p>[Note that I already know how to authenticate client requests against my private key. This question specifically relates to issuing new certs.]</p>\n"},{"tags":["ruby-on-rails","ruby","database","ruby-on-rails-3","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":65,"score":5,"question_id":13122791,"title":"Rails: Validation in model vs migration","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2367281/ruby-on-rails-is-it-better-to-validate-in-the-model-or-the-database\">Ruby on Rails: Is it better to validate in the model or the database?</a>  </p>\n</blockquote>\n\n\n\n<p>I see that it's possible to add same constraint/validation in both Rails model and migration. But which one is the best approach? Is it a good practice to validate both at model and database level (and why)? or they same in rails? </p>\n\n<p>For e.g.  We can do same validation  for name in both model and migration</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  validates :name, :uniqueness =&gt; true, :presense =&gt; true\nend\n\nclass CreateUser &lt; ActiveRecord::Migration\n  def change\n    create_table :users do |t|\n      t.string :name, :unique =&gt; true, :null =&gt; false\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","hyperlink"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2536,"score":2,"question_id":2121281,"title":"Creating Link with Ruby on Rails","body":"<p>Obviously, I am new to this. </p>\n\n<p>I need to make a link using rails to something within the model. The code I have is this. It is probably not even the correct syntax:</p>\n\n<pre><code>&lt;li id=\"nav_home\"&gt;&lt;%= link_to 'SOMETHING', {:controller =&gt; 'inventories', :action =&gt; 'home'} %&gt;&lt;/li&gt;\n</code></pre>\n\n<p>This code defaults to creating a text link, but I want the link element to link. Ideally it would output as so:</p>\n\n<pre><code>&lt;li&gt;&lt;a href=\"goes-to-something\"&gt;&lt;/a&gt;&lt;/li&gt;\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13123130,"title":"Rails + Read json from remote site","body":"<p>I was wondering if it is possible with rails to read in the json content of an external Joomla website?</p>\n\n<p>Would I need to use Nokogiri to complete such a task?</p>\n"},{"tags":["ruby-on-rails","internationalization","translation","spree"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13123406,"title":"Gem Spree_i18n throws error on server startup: can not load translations","body":"<p><strong>Gemfile:</strong></p>\n\n<pre><code>gem 'spree', '1.2.0' #:git =&gt; 'git://github.com/spree/spree.git'\ngem 'spree_auth_devise', :git =&gt; 'git://github.com/spree/spree_auth_devise'\n# original repository not compatible at the moment, use fork\n# gem 'spree_i18n', :git =&gt; 'git://github.com/spree/spree_i18n.git'\ngem 'spree_i18n', :git =&gt; 'git://github.com/kares/spree_i18n.git'\n</code></pre>\n\n<p><strong>Application.rb:</strong></p>\n\n<pre><code>config.i18n.default_locale = :de\n</code></pre>\n\n<p><strong>Spree.rb:</strong> (initilizer)</p>\n\n<pre><code>Spree.config do |config|\n  ...\n  config.default_locale = \"de\"\nend\n</code></pre>\n\n<p><strong>What else:</strong></p>\n\n<ul>\n<li>i have copied all possible language yml files to app/config/locale</li>\n<li>i have run \"<code>rake spree_i18n:update_default</code>\"</li>\n<li>i have run \"<code>rake spree_i18n:sync</code>\"</li>\n</ul>\n\n<p><strong>Error:</strong> </p>\n\n<pre><code>$ rails s\n=&gt; Booting WEBrick\n=&gt; Rails 3.2.8 application starting in development on http://0.0.0.0:3000\n=&gt; Call with -d to detach\n=&gt; Ctrl-C to shutdown server Exiting c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n/backend/base.rb:158:in ` load_file': can not load translations from c:/Ruby193/lib/ruby/gems/1.9.1/bundle r/gems/spree_i18n-d0ce127166d0/config/locales/cs-CZ.yml, expected it to return a  hash, but does not (I18n::InvalidLocaleData)\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n/backend/bas e.rb:15:in `block in load_translations'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n/backend/bas e.rb:15:in `each'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n/backend/bas e.rb:15:in `load_translations'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n/backend/sim ple.rb:57:in `init_translations'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n/backend/sim ple.rb:71:in `lookup'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n/backend/bas e.rb:26:in `translate'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n.rb:156:in ` block in translate'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n.rb:152:in ` catch'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/i18n-0.6.1/lib/i18n.rb:152:in ` translate'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/devise-2.0.4/lib/devise/rails.r b:99:in `block (2 levels) in &lt;class:Engine&gt;'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_ support/lazy_load_hooks.rb:34:in `call'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_ support/lazy_load_hooks.rb:34:in `execute_hook'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_ support/lazy_load_hooks.rb:43:in `block in run_load_hooks'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_ support/lazy_load_hooks.rb:42:in `each'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_ support/lazy_load_hooks.rb:42:in `run_load_hooks'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic ation/finisher.rb:59:in `block in &lt;module:Finisher&gt;'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia lizable.rb:30:in `instance_exec'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia lizable.rb:30:in `run'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia lizable.rb:55:in `block in run_initializers'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia lizable.rb:54:in `each'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/initia lizable.rb:54:in `run_initializers'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/applic ation.rb:136:in `initialize!'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/railti e/configurable.rb:30:in `method_missing'\n        from c:/RoRDev/dip/config/environment.rb:5:in `&lt;top (required)&gt;'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/polyglot-0.3.3/lib/polyglot.rb: 63:in `require'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/polyglot-0.3.3/lib/polyglot.rb: 63:in `require'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_ support/dependencies.rb:251:in `block in require'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_ support/dependencies.rb:236:in `load_dependency'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.8/lib/active_ support/dependencies.rb:251:in `require'\n        from c:/RoRDev/dip/config.ru:4:in `block in &lt;main&gt;'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb: 51:in `instance_eval'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb: 51:in `initialize'\n        from c:/RoRDev/dip/config.ru:1:in `new'\n        from c:/RoRDev/dip/config.ru:1:in `&lt;main&gt;'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb: 40:in `eval'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb: 40:in `parse_file'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:2 00:in `app'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman ds/server.rb:46:in `app'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:3 01:in `wrapped_app'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:2 52:in `start'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman ds/server.rb:70:in `start'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman ds.rb:55:in `block in &lt;top (required)&gt;'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman ds.rb:50:in `tap'\n        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman ds.rb:50:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>Questions:</strong></p>\n\n<ul>\n<li>Why he is looking for the cs-CZ.yml?</li>\n<li>Why he cant load the translations? The cs-CZ.yml file exists under app/config/locale</li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13123451,"title":"Two-tiered models and controllers in Rails","body":"<p>New to Rails and having a hard time envisioning how to proceed with a project.  I would like to create a simple page where users:</p>\n\n<p>a) select a \"project\", sends to project page\nb) from project page, can repeatedly query an API and get results</p>\n\n<p>As I'm still wrapping my head around scaffolding and creating models and controllers, I'm wondering if the following makes sense:</p>\n\n<pre><code>rails generate Project person:string\nrails generate API_call title:string response:text\n</code></pre>\n\n<p>I suppose my question is then, how do I link entries in the API_call table to specific projects?  Is this the \"references\" option?</p>\n\n<p>many thanks in advance... </p>\n"},{"tags":["ruby-on-rails","rest","routing","subdomain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":343,"score":0,"question_id":5689190,"title":"Rails 3 mapping sub resources to root with subdomains","body":"<p>I've got a model for sites that looks like: </p>\n\n<pre><code>class Site &lt; ActiveRecord::Base\n  has_one :resource_1\n  has_one :resource_2\n  has_one :resource_3\n  has_many :resource_4\nend\n</code></pre>\n\n<p>I've got subdomains set up following the method outlined in <a href=\"http://asciicasts.com/episodes/221-subdomains-in-rails-3\" rel=\"nofollow\">http://asciicasts.com/episodes/221-subdomains-in-rails-3</a>. So that if I visit <a href=\"http://subdomain.myapp.com\" rel=\"nofollow\">http://subdomain.myapp.com</a> it finds the site by name (assuming subdomain is the site's name) and displays the page normally at /sites/:id/resource_1.</p>\n\n<p>I can still access all the other sub-resources of site from there, but I get a url that looks like <a href=\"http://subdomain.myapp.com/sites/:id/resource_name/:resource_id\" rel=\"nofollow\">http://subdomain.myapp.com/sites/:id/resource_name/:resource_id</a> and I'd like to be able to set up routes that look like <a href=\"http://subdomain.myapp.com/resource_name/:resource_id\" rel=\"nofollow\">http://subdomain.myapp.com/resource_name/:resource_id</a>.</p>\n\n<p>I'm sure the proper terminology is just escaping it, but not really having the language to describe it concisely has made googling for a solution unfruitful. Any and all replies are appreciated!</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":57,"score":4,"question_id":12463751,"title":"Is it possible to access a child object from the errors on an active record parent?","body":"<p>Given the relationship expressed below:</p>\n\n<pre><code>class Parent &lt; ActiveRecord::Base\n  has_many :children, :dependent =&gt; :destroy\n\n  accepts_nested_attributes_for :child\nend\n\nclass Child &lt; ActiveRecord::Base\n  belongs_to :parent\n\n  validates :name, :presence =&gt; true\nend\n</code></pre>\n\n<p>Let's assume we have a parent object with multiple children, one or more of which have errors that cause parent.valid? to return false.</p>\n\n<pre><code>parent = Parent.new\nparent.build_child(:name =&gt; \"steve\")\nparent.build_child()\nparent.valid?\n</code></pre>\n\n<p>Is there a way to access the child element that caused the errors when looking at the parent.errors object?</p>\n"},{"tags":["ruby-on-rails","ruby","devise","passwords"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13121356,"title":"Ruby on Rails: Devise - password change on first login","body":"<p>I have an app that allows users to enter projects into a database, where they can search for them later. Each user has their own login, which will be given out by a system admin. When the user logs in for the first time, I want the usual homepage to show a \"Change your password\" view, so that the user has to change their password before using the app.</p>\n\n<p>I have set up a <code>pass_change</code> boolean column in the User table, which is <code>false</code> when a new user is created.</p>\n\n<p>At the moment, when the user logs in for the first time, they are brought to the change password view, but when I test this function, the password doesn't change and the view stays the same after I submit the new password, and the <code>pass_change</code> for that user doesn't change to <code>true</code>.</p>\n\n<p><strong>Index view:</strong></p>\n\n<pre><code>&lt;html&gt;\n&lt;% if current_user.pass_changed == true %&gt;\n\n  &lt;%= stylesheet_link_tag    \"index\"%&gt;\n&lt;body&gt;\n\n&lt;div id = \"section1\"&gt;\n&lt;div class = \"h1\"&gt;Database Search&lt;/div&gt;\n\n    &lt;div class = \"h3\"&gt;What would you like to do?&lt;/div&gt;\n\n\n\n&lt;div class=\"new_project_button\"&gt;\n&lt;%= button_to \"Create New Project\", new_project_path, :class =&gt; \"button\", :method =&gt; \"get\" %&gt;\n&lt;/div&gt;\n&lt;div class=\"search_button\"&gt;\n&lt;%= button_to \"      Search      \", search_path, :class =&gt; \"button\", :method =&gt; \"get\" %&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n\n\n&lt;/body&gt;\n\n&lt;%else%&gt;\n\n\n&lt;div class =\"title\"&gt;Change your password&lt;/div&gt;&lt;%= current_user.pass_changed %&gt;\n\n\n&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; password_path(resource_name), :html =&gt; { :method =&gt; :put }) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n&lt;div class = \"signin\"&gt;\n\n\n&lt;div class = \"field\"&gt;New Password: \n  &lt;%= f.password_field :password, :class =&gt; \"password\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class = \"field\"&gt;Confirm: \n  &lt;%= f.password_field :password_confirmation, :class =&gt; \"password\" %&gt;\n  &lt;/div&gt;\n\n                        &lt;%= f.hidden_field :pass_changed, :value =&gt; true %&gt;\n  &lt;div class = \"signup_button\"&gt;&lt;%= f.submit \"Change my password\", :class =&gt; \"button\" %&gt;\n  &lt;/div&gt;\n\n&lt;/div&gt;\n&lt;% end %&gt;\n&lt;% end %&gt;\n\n\n&lt;/html&gt; \n</code></pre>\n\n<p><strong>Application helper:</strong></p>\n\n<pre><code>module ApplicationHelper\n\n    def resource_name\n    :user\n  end\n\n  def resource\n    @resource ||= User.new\n  end\n\n  def devise_mapping\n    @devise_mapping ||= Devise.mappings[:user]\n  end\nend\n</code></pre>\n\n<p>Can anyone see what I might be doing wrong? I am using the devise gem to handle authentication. Any help at all would be much appreciated. Thanks in advance.</p>\n\n<p>Update:</p>\n\n<p>Here are my logs when I try to change the password:</p>\n\n<pre><code>Started PUT \"/users/password\" for 127.0.0.1 at 2012-10-29 14:15:05 +0000\nProcessing by Devise::PasswordsController#update as HTML\n  Parameters: {\"utf8\"=&gt;\"Ô£ô\", \"authenticity_token\"=&gt;\"eBU5jvN6C+JSIZNmsEaxUyydrvPRjtGZeWLxlQzFJKI=\", \"user\"=&gt;{\"password\"=\n&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\", \"pass_changed\"=&gt;\"true\"}, \"commit\"=&gt;\"Change my password\"}\n  ←[1m←[35mUser Load (0.0ms)←[0m  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 7 LIMIT 1\nRedirected to http://localhost:3000/\nFilter chain halted as :require_no_authentication rendered or redirected\nCompleted 302 Found in 0ms (ActiveRecord: 0.0ms)\n\n\nStarted GET \"/\" for 127.0.0.1 at 2012-10-29 14:15:05 +0000\nProcessing by ProjectsController#index as HTML\n  ←[1m←[36mUser Load (0.0ms)←[0m  ←[1mSELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = 7 LIMIT 1←[0m\n  ←[1m←[35mProject Load (0.0ms)←[0m  SELECT \"projects\".* FROM \"projects\"\n  Rendered projects/index.html.erb within layouts/application (0.0ms)\nCompleted 200 OK in 16ms (Views: 15.6ms | ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>My index view now looks like this:</p>\n\n<pre><code>&lt;html&gt;\n&lt;% if current_user.pass_changed == true %&gt;\n\n  &lt;%= stylesheet_link_tag    \"index\"%&gt;\n&lt;body&gt;\n\n&lt;div id = \"section1\"&gt;\n&lt;div class = \"h1\"&gt;Database Search&lt;/div&gt;&lt;%= current_user.pass_changed %&gt;\n\n    &lt;div class = \"h3\"&gt;What would you like to do?&lt;/div&gt;\n\n\n\n&lt;div class=\"new_project_button\"&gt;\n&lt;%= button_to \"Create New Project\", new_project_path, :class =&gt; \"button\", :method =&gt; \"get\" %&gt;\n&lt;/div&gt;\n&lt;div class=\"search_button\"&gt;\n&lt;%= button_to \"      Search      \", search_path, :class =&gt; \"button\", :method =&gt; \"get\" %&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n\n\n&lt;/body&gt;\n\n&lt;%else%&gt;\n\n&lt;%= form_for(current_user, :as =&gt; :user, :url =&gt; password_path(current_user), :html =&gt; { :method =&gt; :put }) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n&lt;div class = \"signin\"&gt;\n\n\n&lt;div class = \"field\"&gt;New Password: \n  &lt;%= f.password_field :password, :class =&gt; \"password\" %&gt;\n  &lt;/div&gt;\n\n  &lt;div class = \"field\"&gt;Confirm: \n  &lt;%= f.password_field :password_confirmation, :class =&gt; \"password\" %&gt;\n  &lt;/div&gt;\n\n                        &lt;%= f.hidden_field :pass_changed, :value =&gt; true %&gt;\n  &lt;div class = \"signup_button\"&gt;&lt;%= f.submit \"Change my password\", :class =&gt; \"button\" %&gt;\n  &lt;/div&gt;\n\n&lt;/div&gt;\n&lt;% end %&gt;\n&lt;% end %&gt;\n\n\n&lt;/html&gt; \n</code></pre>\n\n<p>and in my user model I added have:</p>\n\n<pre><code>after_update :update_pass_changed\n\ndef update_pass_changed\n  self.pass_changed = true\n  self.save\nend\n</code></pre>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13122991,"title":"on duplicate key wierd issue","body":"<p>I'm using sql query in my project, with next code:</p>\n\n<pre><code>ActiveRecord::Base.connection.execute \"insert into open_offer_counters (offer_id, udid, open_counter) values #{opened_events.join(\", \")} on duplicate key update open_counter = open_counter + 1\"\n</code></pre>\n\n<p>I've added </p>\n\n<pre><code>add_index :open_offer_counters, :offer_id, :unique =&gt; true\nadd_index :open_offer_counters, :udid,  :unique =&gt; true\n</code></pre>\n\n<p>into one of migrations. But when i'm trying to add some record with only 1 duplicate key, that doesnt works, but instead update key happens. Basically this code works if only 2 keys(offer_id and udid) are different. If any of them match other one, AR updates my open_counter. How do i make update open_counter if only 2 keys matched(offer_id and udid)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solaris","phusion-passenger","unicorn"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13123115,"title":"How can i install Unicorn with Apache on Solaris OS in rails 3 application?","body":"<p>I am using,</p>\n\n<pre><code>ruby 1.9.2p180 \nRails 3.0.5 \nPhusion Passenger version 3.0.13\n</code></pre>\n\n<p>I have problem with Phusion passenger it frequently shut down in production enviornment.</p>\n\n<p>So i want to shift my app with <code>Apache + Unicorn combination.</code></p>\n\n<p>So can somebody please help me.</p>\n\n<p>I am premium member of <code>Joyent(Cloud support) with Solaris OS.</code></p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","heroku","exception-notification"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":171,"score":5,"question_id":13042201,"title":"exception_notification gem raises ActionView::Template::Error (code converter not found (UTF-8 to UTF-16)) only on Heroku production mode","body":"<p>I create rails app deployed on Heroku.\nalso, <code>exception_notification</code> gem enabled.</p>\n\n<p>when it is on development setup ActionMailer to Gmail,\neverything is fine and sends a notification from Gmail address.</p>\n\n<p>but when it comes to production environment on Heroku,\nI get following error when server trying to send a email.</p>\n\n<p><code>ActionView::Template::Error (code converter not found (UTF-8 to UTF-16))</code></p>\n\n<p>Could anyone tell me what's happening here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email","dynamic-content","html-safe"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13117805,"title":"How to render html from a text column field in database?","body":"<p>I have an column in database as <strong>welcome_emil</strong> of type <strong>TEXT</strong>.</p>\n\n<p>I have saved the following code content saved in column as :</p>\n\n<pre><code>Thanks for Joining in!     \\r\\n\\r\\nYou can loginor refer your friends using your %referral_link%.\"\n</code></pre>\n\n<p>When i try to render this code into my email that is sent to the user. Complete content goes fine but </p>\n\n<pre><code>  \\r\\n\\r\\n\n</code></pre>\n\n<p>this is omitted and all text appear inline.</p>\n\n<p>Here is the code that i use</p>\n\n<pre><code>  &lt;%= p  @company.welcome_email.gsub('%referral_link%',@recipient.referral_link).html_safe %&gt; \n</code></pre>\n\n<p>Here is the screenshot how it looks like in email</p>\n\n<p><img src=\"http://i.stack.imgur.com/oTHlq.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails","parameters","routes"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13073969,"title":"Downsides of using static segments (pretty urls)","body":"<p>I'm playing around with the idea of using pretty urls (<a href=\"http://guides.rubyonrails.org/routing.html#static-segments\" rel=\"nofollow\">static segments</a>) to pass params to my controller.</p>\n\n<p><a href=\"http://example.com/miami/33131\" rel=\"nofollow\">http://example.com/miami/33131</a></p>\n\n<pre><code>match ':city/:zip', :to =&gt; 'events/#index'\n</code></pre>\n\n<p>It's working well so far but I'm trying to think of the downsides of doing this instead of the typical query string-type urls. </p>\n\n<p>What are your thoughts about this?</p>\n\n<p>Thanks,\nFrancis</p>\n"},{"tags":["ruby-on-rails","jruby","migration","activerecord-jdbc"],"answer_count":6,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":4767,"score":7,"question_id":383058,"title":"Rails Schema creation problem","body":"<p>I am using Jruby and rails 2.2.2.  My problem is I have a migration that is not being correctly written to the database schema.</p>\n\n<p>Here is my migration:  </p>\n\n<pre><code>class CreateNotes &lt; ActiveRecord::Migration\n  def self.up\n    create_table(:notes, :options =&gt; 'ENGINE=MyISAM') do |t|\n      t.string :title\n      t.text :body\n\n      t.timestamps\n    end\n\n    execute \"alter table notes ADD FULLTEXT(title, body)\"\n\nend\n</code></pre>\n\n<p>Here is what it produces on in schema.rb</p>\n\n<pre><code>create_table \"notes\", :force =&gt; true do |t|\n  t.string   \"title\"\n  t.text     \"body\"\n  t.datetime \"created_at\"\n  t.datetime \"updated_at\"\nend\n\nadd_index \"notes\", [\"title\", \"body\"], :name =&gt; \"title\"\n</code></pre>\n\n<p>I have two question:</p>\n\n<ul>\n<li>How do I get <code>'ENGINE=MyISAM'</code> into the schema?</li>\n<li>Why did my execute statement become <code>add_index \"notes\", [\"title\", \"body\"], :name =&gt; \"title\"</code>? and how do I force migrations to leave it as an execute statement?</li>\n</ul>\n\n<p>Thanks to Christian Lescuyer for the answer.  However, when I tried this nothing changed.  I uncommented the config.active_record... line but, my schema has not changed.  I have tried this in jruby and on ruby 1.8.6 with rails 2.2.2 and edge rails and there is not changes in the schema.  Can anybody tell me what I am doing wrong?</p>\n"},{"tags":["ruby-on-rails","environment-variables","public","api-key","sensitive-data"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":969,"score":6,"question_id":6113042,"title":"Where to store sensitive data in public rails app?","body":"<p>My personal rails project uses a few API's for which I store the API keys/secrets in config/environments/production.yml and development.yml as global variables. I now want to push this project to github for others to use, but I don't want them to have those bits of sensitive data. I also don't want this file in .gitignore because it's required for the app to run. I've considered putting them in the DB somewhere, but am hoping to find a better solution.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd","bdd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13121205,"title":"Simplifying and correct RSpec controller tests","body":"<p>I have a few RSpec controller tests.  Some work, some don't, and I'm trying to figure out how on Earth to fix them up and make them more efficient</p>\n\n<p>Ideally, I would like to see if I can get each spec into the following form</p>\n\n<pre><code>subject { ... }\n  it { ... }\n  it { ... }\n  it { ... }\n</code></pre>\n\n<p>Note that for all of my controller specs I've written macros for the actual controller actions.  The macros are all tested and all work, and the names make it fairly obvious what they do.</p>\n\n<p>My \"Create\" test:</p>\n\n<pre><code>formats ||= [\"html\", \"js\"]\nformats.each do |format|\n  context \"valid attributes\" do\n    subject { do_post_create( :customer, valid_attributes, format ) }\n      its(:response_code) { should eq(302)}\n      it { should redirect_to admin_customer_path(Customer.find_by_id(???))}\n      it { expect { subject }.to change(Customer, :count).by(1) }\n  end\n\n  context \"invalid attributes\" do\n    subject { do_post_create( :customer, invalid_attributes, format ) }\n      its(:response_code) { should eq(200)}\n      it { should render_template :new }\n      it { expect { subject }.to_not change(Customer, :count).by(1) }\n  end\nend\n</code></pre>\n\n<p>In that spec, I've been trying to figure out some way to get the ID of the newly created object from the post statement.  I've tried \"Customer.last\", but that doesn't seem to work.  Any thoughts?</p>\n\n<p>My \"Update\" spec:</p>\n\n<pre><code>formats ||= [\"html\", \"js\"]\nformats.each do |format|\n  context \"valid attributes\" do\n    let(:object) { FactoryGirl.create(:customer) }\n    subject { do_put_update( class_to_symbol(model), object.id, attributes, format ) }\n      its(:response_code) { should eq(302)}\n\n    it \"does alter #{model}\" do\n      do_put_update( class_to_symbol(model), object.id, attributes, format )\n      assigns(:customer).should eq(object)\n      flash[:notice].should =~ /Success/\n      object.reload\n      attributes.each do |key, value|\n        object.send(key.to_s).should eq(value)\n      end\n    end\n  end\n  context \"invalid attributes\" do\n    let(:object) { FactoryGirl.create(\"customer\") }\n    let(:invalid_attributes) { {:username =&gt; \"!\"} }\n    subject { do_put_update( class_to_symbol(model), object.id, invalid_attributes, format ) }\n      its(:response_code) { should eq(200)}\n\n    it \"does not alter #{model}\" do\n      do_put_update( class_to_symbol(model), object.id, invalid_attributes, format )\n      assigns(:customer).should eq(object)\n      flash[:notice].should =~ /Fail/\n      object.reload\n      attributes.each do |key, value|\n        object.send(key.to_s).should_not eq(value)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In the Update test, I would like to try to express the second block in a more concise way, ideally in a way that I can use the same \"subject\" statement for all of the tests.  Is that possible?</p>\n"},{"tags":["ruby-on-rails","ruby","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13122258,"title":"Capistrano sudo password prompt","body":"<p>I have a problem with capistrano and sudo prompt password. When I run <code>cap deploy</code> it asks me for sudo password but I type it and hit enter but it seems that it is still waiting for more input. How can I tell that I'm finished typing?</p>\n"},{"tags":["ruby-on-rails","inheritance","nested","nested-forms","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13122261,"title":"Rails Nested Forms and Model Inheritance","body":"<p>I'm new to rails and I'm trying to understand if it is possible to use nested model forms (as in Railscasts #196-197) and model inheritance together. </p>\n\n<p>I'm developing an app to create questionnaire similar to <a href=\"https://docs.google.com/spreadsheet/newform?usp=apps_start&amp;hl=en\" rel=\"nofollow\">Google Form</a>.</p>\n\n<p>I have the model Questionnaire with the title and a set of Questions. \nSo Question is a nested model of Questionnaire (to have the possibility to add and remove question while creating the questionnaire).</p>\n\n<p>But as in Google Form there are several types of question depending on the several type of answer (text field, checkbox, radiobox and so on). \nSo I was thinking to create several models for the questions (Question_text, Question_checkbox, ...) all subclasses of Question. But I'm not sure this is the correct way to handle this situation and how to implement it. </p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13121976,"title":"No route matches [POST] \"/student_tests/upload.1\"","body":"<p>But I wanted it to match [POST] \"/student_tests/1/upload\" </p>\n\n<p>IN The routes.rb  i have  added </p>\n\n<pre><code>resources :student_tests do\n    member do\n      post 'upload'\n    end\nend\n</code></pre>\n\n<p>In the students_test_controller i have added</p>\n\n<pre><code>def upload\n    render :upload\nend\n</code></pre>\n\n<p>In the index page of student_test</p>\n\n<pre><code>&lt;%= link_to \"| Upload Scaled Scores\", upload_student_test_path(test), method: :edit%&gt;\n</code></pre>\n\n<p>where test is an object of student_test</p>\n\n<p>By using Rack routes</p>\n\n<pre><code>upload_student_test POST  /student_tests/:id/upload(.:format)   student_tests#upload\n</code></pre>\n\n<p>What mistake have i made that its searching for \"/student_tests/upload.1\" i want it to look for  \"/student_tests/1/upload\" (here 1 is the id of student test)</p>\n"},{"tags":["ruby-on-rails","forms"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":996,"score":0,"question_id":4011685,"title":"How to create password and confirmation when using form_for?","body":"<p>I am using form_for, but I'm not sure how to create the password and password confirmation using the helpers?</p>\n\n<p>I have so far:</p>\n\n<pre><code>&lt;%= form_for :user, @user, ....   do |f| %&gt;\n\n&lt;%= f.text_field :user_name, :class ....  %&gt;\n\npassword??\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Also, when posting to the /user/create action, how to do I prevent certain fields in the model from being initialized when using:</p>\n\n<pre><code>@user = User.new(params[:user])\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":18,"score":2,"question_id":13121793,"title":"how to paginate combined with anchor id","body":"<p>I'm very new to Ruby on Rails and learning while trying to fix some bugs on my company website. I'm trying to paginate a collection of records combined with a particular anchor, i.e. when user clicks on the next/previous page, the pagination happens and user lands on a particular section of the page. This is how my code looks at the moment:</p>\n\n<h2>view</h2>\n\n<pre><code>&lt;%= page_navigation_links @student_logs, :page %&gt;&lt;/p&gt;\n</code></pre>\n\n<h2>controller:</h2>\n\n<pre><code>@student_logs.paginate(:page =&gt; params[:page], :per_page =&gt; 10)\n</code></pre>\n\n<h2>application_helper</h2>\n\n<pre><code>def page_navigation_links(pages, param_name=:page)\n\n  will_paginate(pages, :class =&gt; 'pagination', :inner_window =&gt; 2, :outer_window =&gt; 0, :renderer =&gt; BootstrapHelper::LinkRenderer, :previous_label =&gt; '&amp;larr;'.html_safe, :next_label =&gt; '&amp;rarr;'.html_safe, :param_name =&gt; param_name)\n\nend\n</code></pre>\n\n<p>This works fine for my pagination, but I need to fit a reference to an 'anchor id' into this code, like Student Logs, so that when user navigates to a different page the browser navigates the user to the heading with id: \"student_logs\".</p>\n\n<p>I can't figure out how to do this. Can anyone help?</p>\n"},{"tags":["ruby-on-rails","heroku","gem","taps","heroku-toolbelt"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":162,"score":3,"question_id":13001166,"title":"Installing Heroku Toolbelt has broken Taps","body":"<p>I've been hapilly using the Heroku and Taps gems for a while now, regularly doing a <code>heroku db:push</code> to push my database up to production. </p>\n\n<p>This morning I noticed a message that the Heroku gem was deprecated, having been superseded by the Heroku Toolbelt. So I uninstalled the gems and installed the Heroku Toolbelt.</p>\n\n<p>The next time I went to push my database I got the following error:</p>\n\n<pre><code>!    Taps Load Error: cannot load such file -- taps/operation\n!    You may need to install or update the taps gem to use db commands.\n!    On most systems this will be:\n!    \n!    sudo gem install taps\n</code></pre>\n\n<p>Both Heroku and Taps are correctly installed, but in frustration I've tried following the instructions ('install or update the taps gem to use db commands') without success. The (re)install goes fine but I still get the above error when I try and push the database. Can anyone suggest a fix? I'm using rbenv.</p>\n"},{"tags":["ruby-on-rails","meta-search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13115998,"title":"Rails MetaSearch can't use or statement to combine 2 condition","body":"<p>Currently I'm using metasearch gem and I can't figure out how to add 2 conditions for one element in the search form.</p>\n\n<p>Here is my code</p>\n\n<pre><code>f.select :market_product_status_equals, {}.tap { |h| \n  MarketProduct.status.each { |key,value| \n    h[key]= value\n  } \n}, :include_blank =&gt; true\n</code></pre>\n\n<p>I wanted to have <code>market_product_status_equals</code> or <code>:market_product_status_is_null</code></p>\n\n<p>I tried doing this</p>\n\n<pre><code>f.select :market_product_status_equals_or_is_null, {}.tap { |h| \n  MarketProduct.status.each{ |key,value| \n    h[key]= value\n  } \n}, :include_blank =&gt; true\n</code></pre>\n\n<p>But it doesn't work</p>\n\n<p>Thanks so much in advance.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":93,"score":2,"question_id":12168399,"title":"Ruby on rails : rake aborted bad file descriptor","body":"<p>I have searched around, but I have not been able to find a answer that works.</p>\n\n<p>I am completely new at this, so when you answer, then explain like I am a child... Or explain like I am a piece of broccoli. If you want me to install something, tell me what to write.</p>\n\n<p>Well, I am trying to follow this <a href=\"http://guides.fatfreecrm.com/Setup-Microsoft-Windows.html\" rel=\"nofollow\">http://guides.fatfreecrm.com/Setup-Microsoft-Windows.html</a> and I have come to a spot where I am supposed to write \n    <code>rake db:create RAILS_ENV=production</code>\nand all I got was this: (I have done the \"gem install mysql2\" , I have installed rake as in the tutorial and have not seen any issues)</p>\n\n<pre><code>C:\\RailsInstaller\\fat_free_crm&gt;rake db:create RAILS_ENV=production --trace   \n\n** Invoke db:create (first_time)\n** Invoke db:load_config (first_time)\n** Invoke rails_env (first_time)\n** Execute rails_env\n** Execute db:load_config\n** Execute db:create rake aborted! Bad file descriptor \nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/mysql2-0.2.6-x86-mingw32/li\nb/active_record/connection_adapters/mysql2_adapter.rb:312:in `query'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/mysql2-0.2.6-x86-mingw32/li\nb/active_record/connection_adapters/mysql2_adapter.rb:312:in `execute'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/mysql2-0.2.6-x86-mingw32/li\nb/active_record/connection_adapters/mysql2_adapter.rb:629:in\n`configure_connecti on'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/mysql2-0.2.6-x86-mingw32/li\nb/active_record/connection_adapters/mysql2_adapter.rb:169:in\n`initialize'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/mysql2-0.2.6-x86-mingw32/li\nb/active_record/connection_adapters/mysql2_adapter.rb:16:in `new'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/mysql2-0.2.6-x86-mingw32/li\nb/active_record/connection_adapters/mysql2_adapter.rb:16:in\n`mysql2_connection'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:309:in\n`new_connection '\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:319:in\n`checkout_new_c onnection'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:241:in\n`block (2 level s) in checkout'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:236:in\n`loop'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:236:in\n`block in check out'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/monitor.rb:211:in\n`mon_synchronize'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:233:in\n`checkout'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:96:in `block\nin connec tion'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/monitor.rb:211:in\n`mon_synchronize'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:95:in\n`connection'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_pool.rb:404:in\n`retrieve_conne ction'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_specification.rb:170:in\n`retri eve_connection'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/connection_adapters/abstract/connection_specification.rb:144:in\n`conne ction'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/railties/databases.rake:83:in `rescue in create_database'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/railties/databases.rake:51:in `create_database'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/railties/databases.rake:40:in `block (3 levels) in &lt;top\n(required)&gt;'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/railties/databases.rake:40:in `each'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/activerecord-3.2.7/lib/acti\nve_record/railties/databases.rake:40:in `block (2 levels) in &lt;top\n(required)&gt;'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.\nrb:205:in `call'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.\nrb:205:in `block in execute'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.\nrb:200:in `each'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.\nrb:200:in `execute'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.\nrb:158:in `block in invoke_with_call_chain'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/monitor.rb:211:in\n`mon_synchronize'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.\nrb:151:in `invoke_with_call_chain'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.\nrb:144:in `invoke'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:116:in `invoke_task'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:94:in `block (2 levels) in top_level'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:94:in `each'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:94:in `block in top_level'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:133:in `standard_exception_handling'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:88:in `top_level'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:66:in `block in run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:133:in `standard_exception_handling'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/appli\ncation.rb:63:in `run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/bin/rake:33:in\n`&lt;top (required)&gt;' C:/RailsInstaller/Ruby1.9.3/bin/rake:23:in `load'\nC:/RailsInstaller/Ruby1.9.3/bin/rake:23:in `&lt;main&gt;' Tasks: TOP =&gt;\ndb:create\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","osx","rvm"],"answer_count":6,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":6887,"score":8,"question_id":8813889,"title":"RVM ruby installation errors - Mac","body":"<p>I have tried to install each of the following three versions of Ruby via RVM, each with their own set of errors. I'm more concerned with getting the last one working so I'll focus on that.</p>\n\n<pre><code>rvm install 1.8.7\nrvm install 1.9.2\nrvm install 1.9.3\n</code></pre>\n\n<p><strong>rvm install 1.9.3 (bash output)</strong></p>\n\n<pre><code>14:10:41: ~/.rvm/config $ \nrvm install 1.9.3\nFetching yaml-0.1.4.tar.gz to /Users/dionnesaunders/.rvm/archives\nExtracting yaml-0.1.4.tar.gz to /Users/dionnesaunders/.rvm/src\nERROR: Error running 'tar mzxf /Users/dionnesaunders/.rvm/archives/yaml-0.1.4.tar.gz -C  /Users/dionnesaunders/.rvm/src ', please read /Users/dionnesaunders/.rvm/log/ruby-1.9.3-p0/yaml/extract.log\nConfiguring yaml in /Users/dionnesaunders/.rvm/src/yaml-0.1.4.\nERROR: Error running ' ./configure --prefix=\"/Users/dionnesaunders/.rvm/usr\"  ', please read /Users/dionnesaunders/.rvm/log/ruby-1.9.3-p0/yaml/configure.log\nCompiling yaml in /Users/dionnesaunders/.rvm/src/yaml-0.1.4.\nERROR: Error running 'make ', please read /Users/dionnesaunders/.rvm/log/ruby-1.9.3-p0/yaml/make.log\nDatabase file /Users/dionnesaunders/.rvm/config/packages does not exist.    \n/Users/dionnesaunders/.rvm/scripts/functions/build: line 19: /usr/bin/gcc-4.2: No such file or directory\nInstalling Ruby from source to: /Users/dionnesaunders/.rvm/rubies/ruby-1.9.3-p0, this may take a while depending on your cpu(s)...   \nruby-1.9.3-p0 - #fetching \nruby-1.9.3-p0 - #extracted to /Users/dionnesaunders/.rvm/src/ruby-1.9.3-p0 (already extracted)\nruby-1.9.3-p0 - #configuring \nERROR: Error running ' ./configure --prefix=/Users/dionnesaunders/.rvm/rubies/ruby-1.9.3-p0 --enable-shared --disable-install-doc --with-libyaml --with-opt-dir=/Users/dionnesaunders/.rvm/usr ', please read /Users/dionnesaunders/.rvm/log/ruby-1.9.3-p0/configure.log\nERROR: There has been an error while running configure. Halting the installation.\n14:20:14: ~/.rvm/config $ \n</code></pre>\n\n<p><strong>configure.log output</strong></p>\n\n<pre><code>14:20:14: ~/.rvm/config $ \ncat ~/.rvm/log/ruby-1.9.3-p0/configure.log \n[2012-01-11 14:20:12]  ./configure --prefix=/Users/dionnesaunders/.rvm/rubies/ruby-    1.9.3-p0 --enable-shared --disable-install-doc --with-libyaml --with-opt-    dir=/Users/dionnesaunders/.rvm/usr \nconfigure: WARNING: unrecognized options: --with-libyaml\nchecking build system type... i386-apple-darwin11.2.0\nchecking host system type... i386-apple-darwin11.2.0\nchecking target system type... i386-apple-darwin11.2.0\nchecking whether the C compiler works... no\nconfigure: error: in `/Users/dionnesaunders/.rvm/src/ruby-1.9.3-p0':\nconfigure: error: C compiler cannot create executables\n\nSee `config.log' \n\nfor more details\n14:27:45: ~/.rvm/config $ \n</code></pre>\n\n<p><strong>make.log output</strong></p>\n\n<pre><code>cat ~/.rvm/log/ruby-1.9.3-p0/yaml/make.log\n[2012-01-11 14:20:12] make \nmake: *** No targets specified and no makefile found.  Stop.\n</code></pre>\n\n<p><strong>Specs and short summary of steps I have taken</strong>\nMacBook Air\n13-inch, Mid 2011\nSoftware  Mac OS X Lion 10.7.2 (11C74)</p>\n\n<ul>\n<li>Installed RVM</li>\n<li>Tried to install ruby via rvm</li>\n<li>Figured there may be an xcode / gcc compiler problem, so installed xcode from app store</li>\n<li>Tried again to install ruby via rvm, failed</li>\n<li>Tried to reinstall xcode incase the installation didn't complete properly</li>\n<li>Exported GCC to path as suggested by someone who experienced a similar problem</li>\n<li>Tried again to install ruby via rvm, failed</li>\n</ul>\n\n<p>If anyone has any suggestions I'd be grateful.</p>\n\n<p>Thanks guys.</p>\n\n<p>*<em>edit: *</em></p>\n\n<p><strong>GCC -v</strong></p>\n\n<pre><code>15:15:32: ~ $ \n  gcc -v\nUsing built-in specs.\nTarget: i686-apple-darwin11\nConfigured with: /private/var/tmp/llvmgcc42/llvmgcc42-2336.1~22/src/configure --disable-checking --enable-werror --prefix=/Developer/usr/llvm-gcc-4.2 --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-prefix=llvm- --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin11 --enable-llvm=/private/var/tmp/llvmgcc42/llvmgcc42-2336.1~22/dst-llvmCore/Developer/usr/local --program-prefix=i686-apple-darwin11- --host=x86_64-apple-darwin11 --target=i686-apple-darwin11 --with-gxx-include-dir=/usr/include/c++/4.2.1\nThread model: posix\ngcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.1.00)\n15:15:51: ~ $ \n</code></pre>\n\n<p><strong>extract.log output</strong></p>\n\n<pre><code>15:15:25: ~ $ \n  cat ~/.rvm/log/ruby-1.9.3-p0/yaml/extract.log\n[2012-01-11 15:14:56] tar mzxf /Users/dionnesaunders/.rvm/archives/yaml-0.1.4.tar.gz -C /Users/dionnesaunders/.rvm/src \nyaml-0.1.4/tests/example-reformatter-alt.c: Can't unlink already-existing object\nyaml-0.1.4/tests/example-deconstructor.c: Can't unlink already-existing object\nyaml-0.1.4/tests/test-reader.c: Can't unlink already-existing object\nyaml-0.1.4/tests/Makefile.am: Can't unlink already-existing object\nyaml-0.1.4/tests/test-version.c: Can't unlink already-existing object\nyaml-0.1.4/tests/run-dumper.c: Can't unlink already-existing object\nyaml-0.1.4/tests/run-emitter.c: Can't unlink already-existing object\nyaml-0.1.4/tests/run-parser.c: Can't unlink already-existing object\nyaml-0.1.4/tests/run-scanner.c: Can't unlink already-existing object\nyaml-0.1.4/tests/run-loader.c: Can't unlink already-existing object\nyaml-0.1.4/tests/Makefile.in: Can't unlink already-existing object\nyaml-0.1.4/tests/example-reformatter.c: Can't unlink already-existing object\nyaml-0.1.4/tests/example-deconstructor-alt.c: Can't unlink already-existing object\nyaml-0.1.4/config.h.in: Can't unlink already-existing object\nyaml-0.1.4/aclocal.m4: Can't unlink already-existing object\nyaml-0.1.4/Makefile.am: Can't unlink already-existing object\nyaml-0.1.4/configure: Can't unlink already-existing object\nyaml-0.1.4/yaml-0.1.pc.in: Can't unlink already-existing object\nyaml-0.1.4/LICENSE: Can't unlink already-existing object\nyaml-0.1.4/README: Can't unlink already-existing object\nyaml-0.1.4/include/Makefile.am: Can't unlink already-existing object\nyaml-0.1.4/include/yaml.h: Can't unlink already-existing object\nyaml-0.1.4/include/Makefile.in: Can't unlink already-existing object\nyaml-0.1.4/Makefile.in: Can't unlink already-existing object\nyaml-0.1.4/configure.ac: Can't unlink already-existing object\nyaml-0.1.4/config/ltmain.sh: Can't unlink already-existing object\nyaml-0.1.4/config/config.sub: Can't unlink already-existing object\nyaml-0.1.4/config/missing: Can't unlink already-existing object\nyaml-0.1.4/config/config.guess: Can't unlink already-existing object\nyaml-0.1.4/config/install-sh: Can't unlink already-existing object\nyaml-0.1.4/config/depcomp: Can't unlink already-existing object\nyaml-0.1.4/doc/doxygen.cfg: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x6c.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x74.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/doxygen.css: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x69.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x6f.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__event__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/files.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/tab_h.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x74.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x72.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__tokens.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x64.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__emitter.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/bc_s.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x77.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x6b.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__parser__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x62.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x76.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x66.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x72.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/index.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x63.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__mark__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__alias__data__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/closed.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__version.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x75.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/annotated.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x64.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__document__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/modules.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x65.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x6d.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x6d.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/tabs.css: Can't unlink already-existing object\nyaml-0.1.4/doc/html/globals_enum.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x71.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x63.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__tag__directive__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/classes.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x77.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x68.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x6b.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x71.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/doxygen.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/open.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x70.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/yaml_8h.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__node__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x75.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x68.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/tab_a.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x73.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/nav_f.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x73.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/tab_s.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/globals_eval.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x69.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__token__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x65.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x62.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__nodes.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__emitter__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__export.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x6e.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__parser.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/globals_type.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x6f.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x76.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/globals_defs.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/globals.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__node__pair__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x6e.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__events.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x66.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_0x6c.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/globals_func.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/tab_b.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/nav_h.png: Can't unlink already-existing object\nyaml-0.1.4/doc/html/functions_vars_0x70.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__basic.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__simple__key__s.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/group__styles.html: Can't unlink already-existing object\nyaml-0.1.4/doc/html/structyaml__version__directive__s.html: Can't unlink already-existing object\nyaml-0.1.4/src/parser.c: Can't unlink already-existing object\nyaml-0.1.4/src/reader.c: Can't unlink already-existing object\nyaml-0.1.4/src/Makefile.am: Can't unlink already-existing object\nyaml-0.1.4/src/emitter.c: Can't unlink already-existing object\nyaml-0.1.4/src/writer.c: Can't unlink already-existing object\nyaml-0.1.4/src/api.c: Can't unlink already-existing object\nyaml-0.1.4/src/dumper.c: Can't unlink already-existing object\nyaml-0.1.4/src/Makefile.in: Can't unlink already-existing object\nyaml-0.1.4/src/yaml_private.h: Can't unlink already-existing object\nyaml-0.1.4/src/scanner.c: Can't unlink already-existing object\nyaml-0.1.4/src/loader.c: Can't unlink already-existing object\nyaml-0.1.4/win32/Makefile.am: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/example_deconstructor_alt.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/run_scanner.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/example_reformatter_alt.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/test_reader.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/example_deconstructor.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/run_dumper.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/libyaml.sln: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/run_parser.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/yaml.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/test_version.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/run_emitter.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/example_reformatter.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/run_loader.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2003/yamldll.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/run_emitter.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/run_dumper.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/example_deconstructor_alt.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/yaml.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/run_parser.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/example_deconstructor.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/example_reformatter_alt.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/run_scanner.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/run_loader.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/test_reader.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/libyaml.dsw: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/example_reformatter.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/yamldll.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/vc6/test_version.dsp: Can't unlink already-existing object\nyaml-0.1.4/win32/Makefile.in: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/example_deconstructor_alt.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/run_scanner.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/example_reformatter_alt.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/test_reader.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/example_deconstructor.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/run_dumper.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/libyaml.sln: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/run_parser.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/yaml.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/test_version.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/run_emitter.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/example_reformatter.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/run_loader.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/vs2008/yamldll.vcproj: Can't unlink already-existing object\nyaml-0.1.4/win32/config.h: Can't unlink already-existing object\ntar: Error exit delayed from previous errors.\n</code></pre>\n"},{"tags":["ruby-on-rails"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":190,"score":0,"question_id":13116199,"title":"Model mocks automatically have access to all existing methods of the model","body":"<p>Do Model mocks automatically have access to all existing methods of the model in rspec? I guess not just to confirm. Thanks.</p>\n"},{"tags":["ruby-on-rails","error-handling"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13120024,"title":"Declaring handler and handling errors with a similar approach to after_save","body":"<p>I'm looking to record errors from a handful of objects into a db table, let's say \"errs\".</p>\n\n<p>Ideally I'd like to declare it so as it can be added to the object definition ins a similar manner to \"validate\" or \"attr_accessible\". For example:</p>\n\n<pre><code>def SomeObject\n\n    validate: :someMember\n\n    on_error: :someCallback\n\n    def someMethod\n\n    end\nend\n</code></pre>\n\n<p>Where would I begin implementing something of this nature or alternatively is there a commonly accepted method for doing this type of thing?</p>\n\n<p>To expand a bit:</p>\n\n<p>Say I parse a file whose contents define an ActiveRecord extension (ActiveRecord::MyClass) and one of the following errors occur.</p>\n\n<pre><code>1. Type mismatch: self.someMember is STRING, expected BOOLEAN.\n2. File badly formatted. Some line isn't formatted as expected.\n3. Validation failed (ActiveRecord)\n</code></pre>\n\n<p>On these errors I'd like to record these using the directive type syntax that is found (typically) at the top of an object definition. </p>\n"},{"tags":["ruby-on-rails","ruby","exception","exception-handling","error-handling"],"answer_count":6,"favorite_count":29,"up_vote_count":24,"down_vote_count":0,"view_count":14614,"score":24,"question_id":2191632,"title":"Begin, Rescue and Ensure in Ruby","body":"<p>I've recently started programming in Ruby, and I am looking at exception handling.</p>\n\n<p>I was wondering if ensure was the Ruby equivalent of finally in C#. So if I have the following:</p>\n\n<pre><code>file = File.open(\"myFile.txt\", \"w\")\n\nbegin\nfile &lt;&lt; \"#{content} \\n\"\nrescue\n#handle the error here\nensure\nfile.close unless file.nil?\nend\n</code></pre>\n\n<p>or should I do this?</p>\n\n<pre><code>#store the file\nfile = File.open(\"myFile.txt\", \"w\")\n\nbegin\nfile &lt;&lt; \"#{content} \\n\"\nfile.close\nrescue\n#handle the error here\nensure\nfile.close unless file.nil?\nend\n</code></pre>\n\n<p>What I am basically asking is, does ensure get called no matter what, even if an exception isn't raised?</p>\n"},{"tags":["ruby-on-rails","logging","unicorn","bluepill"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13121355,"title":"Unable to log on stdout using unicorn+bluepill","body":"<p>I am trying to have the rails server log on standard output. Here are the requisite files:\napp_server.pill</p>\n\n<pre><code>require 'logger'\nrequire File.join(File.dirname(__FILE__), \"load_bluepill_config.rb\")\n\napp_server_config = BLUEPILL_CONFIG[:app_server]\napp_name = app_server_config[:app_name]\npwd = File.absolute_path(File.join(File.dirname(__FILE__), '../../'))  \nuid = BLUEPILL_CONFIG[:uid]\ngid = BLUEPILL_CONFIG[:gid]\nrails_env = BLUEPILL_CONFIG[:rails_env]\nlog_file = File.absolute_path(File.join(pwd, app_server_config[:log_file]))\n\nBluepill.application(app_name, :foreground =&gt; true) do |app|\napp.uid = uid\napp.gid = gid\n\napp.process(\"unicorn\") do |process|\n  process.uid = uid\n  process.gid = gid\n  process.working_dir = pwd\n  process.stdout = process.stderr = log_file\n  pid_file = File.join(pwd, 'tmp', 'pids', 'unicorn.pid')\n  process.pid_file = pid_file\n\n  process.start_command = \"unicorn -c config/unicorn.rb\"\n  process.stop_command = \"kill -QUIT {{PID}}\"\n  process.restart_command = \"kill -USR2 {{PID}}\"\n  process.start_grace_time = 60.seconds\n  process.stop_grace_time = 5.seconds\n  process.restart_grace_time = 50.seconds\n\n  process.monitor_children do |child_process|\n  child_process.stop_command = \"kill -QUIT {{PID}}\"                  -\n  child_process.checks :mem_usage, :every =&gt; 10.seconds, :below =&gt; 165.megabytes,     :times =&gt; [2,2],  :fires =&gt; :stop\n end\nend\nend\n</code></pre>\n\n<p>config/unicorn.rb</p>\n\n<pre><code>rails_env = ENV['RAILS_ENV'] || 'development'\nworker_processes ['production','staging'].include?(rails_env) ? 2 : 1\n\nAPP_DIR = File.expand_path('../..', __FILE__)\nworking_directory APP_DIR # available in 0.94.0+\n\nunless ['production', 'staging'].include?(rails_env)\n  listen 3000, :tcp_nopush =&gt; true\nend\n\ntimeout 30\n\npid File.join(APP_DIR, '/tmp/pids/unicorn.pid')\n\npreload_app true\n\nGC.respond_to?(:copy_on_write_friendly=) and\n GC.copy_on_write_friendly = true\n\nbefore_fork do |server, worker|\n  old_pid = \"#{server.config[:pid]}.oldbin\"\n  if old_pid != server.pid\n  begin\n   sig = (worker.nr + 1) &gt;= server.worker_processes ? :QUIT : :TTOU\n   Process.kill(sig, File.read(old_pid).to_i)\n  rescue Errno::ENOENT, Errno::ESRCH\n  end\nend\n\nsleep 1\nend\n</code></pre>\n\n<p>rails: application.rb\n     ..</p>\n\n<pre><code>config.logger = ActiveSupport::TaggedLogging.new(Logger.new(STDOUT)) if defined?(ActiveSupport::TaggedLogging)\nconfig.logger.level = Logger.const_get(([ENV['LOG_LEVEL'].to_s.upcase, \"INFO\"] &amp; %w[DEBUG INFO WARN ERROR FATAL UNKNOWN]).compact.first)\n..\n</code></pre>\n\n<p>to execute bluepill, I run from the project directory:</p>\n\n<pre><code>bundle exec bluepill load config/bluepill/app_server.pill --no-privileged\n</code></pre>\n\n<p>Ideally the logs generated by rails server should be piped to stdout,  but the logs shows only the mem_usage of the worker process and any [GET, POST] requests that have been made to the server. Any insights on why I am getting this problem?</p>\n"},{"tags":["ruby-on-rails","forms","associations","haml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13120754,"title":"Why aren't my \"has_many :through\" checkboxes updating my third model?","body":"<p>I have 3x models:</p>\n\n<pre><code>class Heuristic &lt; ActiveRecord::Base\n  has_many :footnotes\n  has_many :references, :through =&gt; :footnotes\nend\n\nclass Reference &lt; ActiveRecord::Base\n  has_many :footnotes\n  has_many :heuristics, :through =&gt; :footnotes\nend\n\nclass Footnote &lt; ActiveRecord::Base\n  belongs_to :reference\n  belongs_to :heuristic\nend\n</code></pre>\n\n<p>A join table:</p>\n\n<pre><code>class CreateFootnotes &lt; ActiveRecord::Migration\n  def change\n    create_table :footnotes do |t|\n      t.integer :heuristic_id\n      t.integer :reference_id\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>A form called from the new reference view:</p>\n\n<pre><code>= form_for @reference do |f|\n  .field\n    = hidden_field_tag \"reference[heuristic_ids][]\", nil\n    - @heuristics.each do |heuristic|\n      = label_tag dom_id(heuristic), heuristic.description\n      = check_box_tag \"reference[heuristic_ids][]\", heuristic.id, @reference.heuristics.include?(heuristic), id: dom_id(heuristic)\n  .actions\n    = f.submit 'Save'\n</code></pre>\n\n<p>A references controller:</p>\n\n<pre><code>  def new\n    @reference = Reference.new\n    @heuristics = Heuristic.all\n    respond_to do |format|\n      format.html # new.html.erb\n    end\n  end\n\n  def create\n    @reference = Reference.new(params[:reference])\n    respond_to do |format|\n      if @reference.save\n        format.html { redirect_to references_path, notice: 'Reference was successfully created.' }\n      else\n        format.html { render action: \"new\" }\n      end\n    end\n  end\n</code></pre>\n\n<p>When you go to the new reference view, select a heuristic and click Save, I expect this to associate the selected heuristic with the reference, but when you drop into rails console you can see that it has not:</p>\n\n<pre><code>ref = Reference.last\n  Reference Load (0.9ms)  SELECT \"references\".* FROM \"references\" ORDER BY \"references\".\"id\" DESC LIMIT 1\n+----+-----+----------+---------+-----------+-------------+\n| id |  created_at              | updated_at              |\n+----+-----+----------+---------+-----------+-------------+\n| 2  |  2012-10-29 11:21:24 UTC | 2012-10-29 11:21:24 UTC |\n+----+-----+----------+---------+-----------+-------------+\n1 row in set\n1.9.2p318 :002 &gt; ref.heuristics\n  Heuristic Load (1.0ms)  SELECT \"heuristics\".* FROM \"heuristics\" INNER JOIN \"footnotes\" ON \"heuristics\".\"id\" = \"footnotes\".\"heuristic_id\" WHERE \"footnotes\".\"reference_id\" = 2\n =&gt; [] \n1.9.2p318 :003 &gt; Footnote.all\n  Footnote Load (0.4ms)  SELECT \"footnotes\".* FROM \"footnotes\" \n =&gt; [] \n1.9.2p318 :004 &gt; \n</code></pre>\n\n<p>Why is this?</p>\n\n<p>Thanks,</p>\n\n<p>Steven.</p>\n\n<p>BTW, I expected the <code>reference[heuristic_ids][]</code> to dynamically generate the name of each checkbox, but instead the name of each checkbox is the same: <code>reference[heuristic_ids][]</code>.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","heroku","https"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":134,"score":1,"question_id":12387645,"title":"'EOFError: end of file reached' on HEROKU while posting UTF-8 via SSL","body":"<p>I've got strange bug on heroku. To reproduce it I have to make big (over few KB) HTTPS POST with any UTF-8 characters in request body. Here is an example:</p>\n\n<pre><code>require \"net/https\"\nrequire \"uri\"\n\n#Accutally I've ecountered this bug while posting to another server\nurl = URI.parse(\"https://api.heroku.com/myapps\")\n\n#It's Ukrainian 'oiced velar plosive G' letter\npayload = \"ґ\"*10000\nrequest = Net::HTTP::Post.new(url.path)\nrequest.body = payload\nhttp = Net::HTTP.new(url.host, url.port)\nhttp.use_ssl = true\nhttp.read_timeout = 500\nhttp.start {|http| http.request request }\n</code></pre>\n\n<p>Running such script on local machine's irb gives me:</p>\n\n<pre><code>#&lt;Net::HTTPUnauthorized 401 Unauthorized readbody=true&gt; \n</code></pre>\n\n<p>...which is expected, but on heroku cedar, runing it on 'heroku console' ... in about 60sec I get:</p>\n\n<pre><code>EOFError: end of file reached\n    from /usr/local/lib/ruby/1.9.1/openssl/buffering.rb:145:in `sysread_nonblock'\n    from /usr/local/lib/ruby/1.9.1/openssl/buffering.rb:145:in `read_nonblock'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:135:in `rbuf_fill'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:116:in `readuntil'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:126:in `readline'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:2219:in `read_status_line'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:2208:in `read_new'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:1191:in `transport_request'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:1177:in `request'\n    from (irb):32:in `block in irb_binding'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:627:in `start'\n    from (irb):32\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands/console.rb:47:in `start'\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands/console.rb:8:in `start'\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands.rb:41:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>What should I do with it?</p>\n"},{"tags":["mysql","ruby-on-rails","database"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2648,"score":3,"question_id":4195255,"title":"Problems connecting to remote MySQL host with Rails","body":"<p>I wanted to connect to a remote MySQL host (with <code>rake db:create</code>), but Rails always considers it to be local.\nDatabase.yml which uses the following config:</p>\n\n<pre><code>defaults: &amp;defaults\n  encoding: unicode\n  adapter: mysql\n  username: &lt;username&gt;\n  password: *************\n  port: 3306\n  host: &lt;remote ip address&gt;\n\ndevelopment:\n  &lt;&lt;: *defaults\n  database: &lt;db name&gt;\ntest: &amp;test\n  &lt;&lt;: *defaults\n  database: &lt;db name&gt;\nproduction:\n  &lt;&lt;: *defaults\n  database: &lt;db name&gt;\n</code></pre>\n\n<p>And always get this error when trying anything on the database:</p>\n\n<pre><code>ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2)\n</code></pre>\n\n<p>The config works as long as I use the local database (i.e. without the host/port part).\nConnecting to the remote MySQL server works fine with the given details.</p>\n\n<p>Any ideas on what is going wrong ?</p>\n\n<p><strong>Edit</strong>:\nThe problem only occurs with <code>rake:db:create</code>, other tasks work - The error message was really badly misleading.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13116761,"title":"Setting references to a table through scaffolding in rubyonrails","body":"<p>I am now doing a project on ruby on rails. I created a entity named product and i want to set a many to many relation to other entity named category.</p>\n\n<pre><code>script/generate scaffold product prd_name:string category:references \n</code></pre>\n\n<p>By doing this code only one to one mapping is possible.How can i set many to many without hard coding?</p>\n"},{"tags":["mysql","sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13120729,"title":"On duplicate key update issue","body":"<p>I'm trying to update field on duplicate key, but it just adds new records instead of updating.</p>\n\n<p>Here is what i'm trying to do </p>\n\n<pre><code>ActiveRecord::Base.connection.execute \"insert into open_offer_counters (offer_id, udid, open_counter) values #{opened_events.join(\", \")} on duplicate key update open_counter = open_counter + 1\"\n</code></pre>\n\n<p>In my migration I pointed on 2 unique fields </p>\n\n<pre><code>create_table :open_offer_counters do |t|\n    t.integer :offer_id,            :unique =&gt; true\n    t.string  :udid,                :unique =&gt; true\n    t.integer :open_counter\n  t.timestamps\nend\n</code></pre>\n\n<p>Any ideas whats wrong with code?</p>\n"},{"tags":["ruby-on-rails","ruby","csv"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":237,"score":0,"question_id":8309363,"title":"CSV Validation columns","body":"<p>I have code to check if a CSV file is correct. I would like to write idiomatic code to check if the columns are correct. I don't want to write in block check if we have got first line check columns.</p>\n\n<pre><code>CSV.foreach(@csv) { |person|\n  first_name, last_name, person_id, email, title, phone, mobile, department, address, city = person[0..9]\n  zip_code, state, country, manager_id =person[10..13]\n  @managers &lt;&lt; manager_id\n  @persons &lt;&lt; person_id\n\n  validate = false unless validate_email(email)\n  validate = false unless validate_first_name(first_name)\n  validate = false unless validate_last_name(last_name)\n  validate = false unless validate_person_id(person_id)\n}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13116440,"title":"devise forgot password function not working when creating own user controller?","body":"<p>I use devise for authentication and i have created a user controller and specified as shown below in my routes which lets me to create users,edit and delete users,</p>\n\n<pre><code>devise_for :users do\nresources :users, :only =&gt; [:index, :new, :create, :edit, :update, :destroy]\nend\n</code></pre>\n\n<p>but i cannot able to make the forgot password functionality work using this but in case i  specify as</p>\n\n<pre><code>devise_for :users\n</code></pre>\n\n<p>then i can able to use the forgot password function that comes with devise and i could not able to create , edit or delete when i specify like this. So how can i make both to work ? \nplease help me</p>\n"},{"tags":["ruby-on-rails","logging"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":921,"score":3,"question_id":2060455,"title":"What's a good logging replacement for rails?","body":"<p>So, I've been looking into logging in my Rails app and I'm discovering, thanks to posts like <a href=\"http://stackoverflow.com/questions/462651/rails-logger-format-string-configuration\">this</a>, that the default Rails logging format is terrible and there isn't an easy way to change it. Can anyone recommend a simple replacement for the default logger?</p>\n\n<p><strong>Bonus question:</strong> Is there a stated reason for <em>why</em> it's so hard to change the default format in BufferedLogger?</p>\n"},{"tags":["ruby-on-rails","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13119568,"title":"rails activerecord multiple query","body":"<p>Thanks for your time !</p>\n\n<p>It's a simple question but I've searched for some time and still cannot get the function suit me.</p>\n\n<p>I get a table named *lr_transaction_tables* in DB and a <code>class LrTransactionsTable &lt; ActiveRecord::Base</code> with it.</p>\n\n<p>I can <code>@entry_ary = LrTransactionsTable.find(:all)</code> to fetch the whole table and present it in the view by :</p>\n\n<pre><code>&lt;table id=\"trans-war-table\"&gt;\n  &lt;% @entry_ary.each do |item| %&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= item.ltname %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= item.name %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>But how do I get the data <code>where the data under ltname column is \"specific word\"</code> instead of all of it.</p>\n\n<p>I've tried <code>@entry_ary = LrTransactionsTable.find_by_ltname( \"specific word\" )</code>, but it give me the error that <code>undefined method</code>each' for nil:NilClass`</p>\n\n<p><code>ltname</code> and <code>name</code> is the column name in the table.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","fork","file-descriptor"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":44,"score":5,"question_id":13089875,"title":"Fork, Ruby, ActiveRecord and File Descriptors on Fork","body":"<p>I understand that when we fork a process the child process inherits a copy of the parents open file descriptors and offsets. According to the man pages this refers to the same file descriptors used by the parent. Based on that theory in the following program</p>\n\n<pre>\n<code>\nputs \"Process #{Process.pid}\"\n\nfile = File.open('sample', 'w')\n\nforked_pid = fork do\n    sleep(10)\n    puts \"Writing to file now...\"\n    file.puts(\"Hello World. #{Time.now}\")       \nend\n\n\n\n\nfile.puts(\"Welcome to winter of my discontent #{Time.now}\")\nfile.close\nfile = nil\n</code>\n</pre>\n\n<p><b> Question 1: </b>\nShouldn't the forked process which is sleeping for 10 seconds lose its file descriptor and not be able to write to the file as the parent process completes and closes the file and exits.\n<br/>\n<b> Question 2: </b>But for whatever reason if this works then how does ActiveRecord lose its connection in this scenario. It only works if I set <code>:reconnect =&gt; true</code> on ActiveRecord connect can it actually connect, which means its losing connection.</p>\n\n<pre>\n<code>\nrequire \"rubygems\"\nrequire \"redis\"\nrequire 'active_record'\nrequire 'mysql2'\n\nconnection = ActiveRecord::Base.establish_connection({\n    :adapter =&gt 'mysql2',\n    :username =&gt 'root_user',\n    :password =&gt 'Pi',\n    :host =&gt 'localhost',\n    :database => 'list_development', \n    :socket =&gt '/var/lib/mysql/mysql.sock'\n\n    })\n\nclass User &lt ActiveRecord::Base   \nend\n\nu = User.first\n\nputs u.inspect\n\nfork do\n    sleep 3\n    puts \"*\" * 50\n    puts User.first.inspect\n    puts \"*\" * 50\n\nend\n\nputs User.first.inspect\n</code>\n</pre>\n\n<p>However, the same is not true with Redis (v2.4.8) which does not lose connection on a fork, again. Does the it try to reconnect internally on a fork? </p>\n\n<p>If thats the case then why isn't the write file program not throwing an error.</p>\n\n<p>Could somebody explain whats going on here. Thanks</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","autocomplete"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13119460,"title":"pre populating token input field by attribute when selecting field by class","body":"<p>Im using the famous token-inputs plugin for autocomplete like Ryan bates does it in the reailscasts episode 258. Its working fine and when I assign the tokenInput using an id its not a problem to prepopulate the tokenInput because I have an uniqe identifier that I can use like this:</p>\n\n<pre><code>$(\"#id\").tokenInput(\"/source.json\", {\n  crossDomain: false,\n  prePopulate: $(\"#id\").data('pre')\n});\n</code></pre>\n\n<p>The pre attribute contains an array of hashes that include the id and the name of the data that should be prepopulated and that works. But when I try to use this when I select the element by a class:</p>\n\n<pre><code>$(\".class\").tokenInput(\"/source.json\", {\n  crossDomain:false,\n  prePopulate: $(this).data('pre')\n});\n</code></pre>\n\n<p>Its not wirking. Using <code>$(this)</code> I hoped to fetch the object that is selected by <code>.class</code> but obviously that doesnt work. How can I \"communicate\" with the object that is selected by the class selector?</p>\n"},{"tags":["javascript","ruby-on-rails","forms","haml"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13061752,"title":"Toggle a set of inputs on a form in Rails","body":"<p>I have a form in a Rails application with an invite code and a block of credit card information.  I'd like to be able to toggle between the two on the same page.  Either the user provides an invite code <strong>or</strong> they input credit card information.  It would be nice if a one or the other could be hidden when inactive (but not necessary).  Here's the relevant bits of the form:</p>\n\n<pre><code>  %hr\n\n  %fieldset\n    .control-group\n      = label_tag :invite_code, nil, :class =&gt; \"control-label\"\n\n      .controls\n        = text_field_tag :invite_code\n\n    .control-group\n      .controls\n        = f.hidden_field :stripe_token\n        = f.hidden_field :last_4_digits\n\n    - if @user.last_4_digits\n      .control-group\n        = label_tag :card, nil, :class =&gt; \"control-label\"\n        .controls\n          Using card ending with #{@user.last_4_digits}\n          = link_to \"(change)\", \"#\"\n\n  %hr\n\n  %fieldset\n    %noscript\n      %p\n        This form requires Javascript to use\n\n    .control-group#credit-card{ :style =&gt; @user.last_4_digits ? \"display:none\" : \"display:block\" }\n      #credit-card-errors{:style =&gt; \"display:none\"}\n        #stripe-error-message.alert-message.block-message.error\n\n      .control-group\n        = label_tag :credit_card_number, nil, :class =&gt; \"control-label\"\n        .controls= text_field_tag :credit_card_number, params[:credit_card_number], :class =&gt; \"field\", :disabled =&gt; true \n\n      .control-group\n        = label_tag :cvv, \"Security code (CVV)\", :class =&gt; \"control-label\"\n        .controls= text_field_tag :cvv, params[:cvv], :class =&gt; \"small\", :disabled =&gt; true \n\n      .control-group\n        = label_tag :expiry_date, nil, :class =&gt; \"control-label\"\n        .controls= date_select \"\", :expiry_date, {:discard_day =&gt; true, :order =&gt; [:month, :year], :use_month_numbers =&gt; true, :start_year =&gt; Date.today.year, :end_year =&gt; Date.today.year + 25, :disabled =&gt; true}, {:class =&gt; \"input-small\"}\n\n      /empty\n      %p\n        Subscriptions will be billed $12 annually.\n\n  %fieldset.form-submit\n    = submit_tag 'Sign up', :class =&gt; 'btn btn-large btn-primary'\n</code></pre>\n\n<p>What is the sanest way to go about doing this?</p>\n"},{"tags":["ruby-on-rails","forms","routing","routes"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13113685,"title":"Submit a form to a Rails route with a dynamic segment","body":"<p>I have a route that looks like</p>\n\n<pre><code>match 'solar_systems/:planet_num/:moon_num' =&gt; 'solar_system#moon', :as =&gt; :moon\n</code></pre>\n\n<p>I'd like to have a form with a select box for planet number and moon number and have it submit to this route. However I cannot use <code>moon_path</code> because it will have an error if the dynamic parameters are not included in it like this <code>moon_path(4, 1)</code>. Is what I want even possible? If so, what do I give to the form tag for the route?</p>\n"},{"tags":["ruby-on-rails","validation","option"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13118934,"title":"rails validations - passing values to options","body":"<p>My last question <a href=\"http://stackoverflow.com/questions/13112897/rails-begginer-validations\">rails begginer- validations</a> was closed as too localised, so I'll try to be more generic.</p>\n\n<p>Is it possible to pass value from current record (or from session) to validation option?</p>\n\n<p>This works:</p>\n\n<pre><code>validates :name, :length =&gt; { :minimum =&gt; 2 }\n</code></pre>\n\n<p>But, if I have field \"minlength\" in my model, and want to validate length of the \"name\" against the value in \"minlength\" field - how can I do that?</p>\n\n<p>Those examples don't work.</p>\n\n<pre><code>validates :name, :length =&gt; { :minimum =&gt; self.minlength }\nvalidates :name, :length =&gt; { :minimum =&gt; :minlength }\nvalidates :name, :length =&gt; { :minimum =&gt; session_variable_with_minlength_value }\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","database","postgresql","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":11679313,"title":"Converting Rails ActiveRecord GROUP query from MySQL to PostgreSQL","body":"<p>I have a ActiveRecord query I’ve been working with (history <a href=\"http://stackoverflow.com/questions/11406221/how-to-adjust-activerecord-or-straight-sql-query-to-include-zero-count-records\">here</a>) that works great in MySQL, but now I need to convert my database to PostgreSQL and I'm getting an error. Here is the query:</p>\n\n<pre><code>class Shoe &lt; ActiveRecord::Base\n  has_many :purchases\n\n  def self.available_shoes\n    #show all shoes that have been purchased less than num_in_stock\n    num_in_stock = 3\n    Shoe.includes(:purchases)\n        .group(\"purchases.shoe_id\")\n        .having(\"COUNT(purchases.shoe_id) &lt; ?\", num_in_stock)\n  end\nend\n</code></pre>\n\n<p>Simply switching the gems and adapters to postgres is not enough: I now get the following error:</p>\n\n<blockquote>\n  <p>ActionView::Template::Error (PG::Error: ERROR:  column \"shoes.id\" must appear in the GROUP BY clause or be used in an aggregate function\n  LINE 1: SELECT \"shoes\".\"id\" AS t0_r0, \"shoes\".\"created_at\" AS ...</p>\n</blockquote>\n\n<p>I tried changing</p>\n\n<pre><code>.group(\"purchases.shoe_id\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>.group(\"purchases.shoe_id, shoes.id, purchases.id\")\n</code></pre>\n\n<p>and while this got rid of the error, it also changed the sql and broke some of my tests. </p>\n\n<p>I have read many stackoverflow questions regarding this error but I was unable to find a solution. What do I need to change in my ActiveRecord query to make this work in postgres?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","http","ruby-on-rails-3","plugins"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":528,"score":1,"question_id":5079302,"title":"Typhoeus::Request.new(...) doesn't work, but Typhoeus::Request.get(...) does!","body":"<p>I am using Ruby on Rails 3. I just installed Typhoeus and I am tryng to make a HTTP request like this</p>\n\n<pre><code>  require 'typhoeus'\n\n  ....\n  request = Typhoeus::Request.new(\"http://google.com\",\n              :method        =&gt; :get,\n              :params        =&gt; {\n                :email       =&gt; \"test@test.com\",\n                :password    =&gt; \"test\"\n              }\n            )\n\n  resp = request.response\n</code></pre>\n\n<p>but I have a problem: debug of <code>resp</code> is always blank and this happens also if I don't use options (method, params, ...).</p>\n\n<p>However, if I use the following code, it will work:</p>\n\n<pre><code>   resp = Typhoeus::Request.get(\"http://google.com?email=test@test.com&amp;password=test\")\n</code></pre>\n\n<p>and I will get values for <code>resp</code>.</p>\n\n<p><strong>What can be the problem?</strong></p>\n\n<hr>\n\n<p>What I use</p>\n\n<ul>\n<li><p>Mac OS with \"Snow Leopard\" v 1.1.6</p></li>\n<li><p>MacPorts - The version 7.21.2 of libcurl was already installed from this software</p></li>\n<li><p>RVM (Ruby Version Manager)</p></li>\n</ul>\n\n<hr>\n\n<p>P.S.: if you need more info, let me know.</p>\n\n<hr>\n\n<p>In the <a href=\"https://github.com/dbalatero/typhoeus\" rel=\"nofollow\">official documentation</a> there are some (overwrited) alerts for Mac Os users related to the installation. </p>\n\n<p>Terminal outputs:</p>\n\n<pre><code>$ which ruby\n/Users/&lt;my_user_name&gt;/.rvm/rubies/ruby-1.9.2-p136/bin/ruby\n\n$ which curl\n/opt/local/bin/curl\n</code></pre>\n"},{"tags":["ruby-on-rails","textmate","bundler"],"answer_count":2,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":1807,"score":4,"question_id":2159905,"title":"How to tell to TextMate ignore my Katz's Bundler folder in \"Go to File\"?","body":"<p>I use Katz's Bundler to manage gem dependencies.</p>\n\n<p>Who know, how to tell to TextMate ignore my \"vendor/bundler_gems\" folder in \"Go to File\"?</p>\n\n<p><a href=\"http://grab.by/238s\" rel=\"nofollow\">Image demonstrate my little problem</a>.</p>\n\n<p>You can see, what I want to find my application.sass, instead \"Go to File\" find lots of trash from bundler folder.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13118652,"title":"undefined method `stringify_keys' for \"create\":String in ruby on rails again","body":"<p>I am getting an error</p>\n\n<pre><code>Started POST \"/actions\" for 127.0.0.1 at 2012-10-29 15:04:01 +0600\nProcessing by ActionsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"lfHYF3EQn1/lMReK3alX3NsGa4wSMejC/0fEeoAFYUY=\", \"commit\"=&gt;\"Create Action\"}\nCompleted 500 Internal Server Error in 1ms\n\nNoMethodError (undefined method `stringify_keys' for \"create\":String):\n  app/controllers/actions_controller.rb:43:in `new'\n  app/controllers/actions_controller.rb:43:in `create'\n</code></pre>\n\n<p>This code is totally generated by Rails, and i do not understand why it doesnt work</p>\n\n<p>Here is model</p>\n\n<pre><code>class Action &lt; ActiveRecord::Base\n  attr_accessible :name, :user_id\nend\n</code></pre>\n\n<p>Here is controller part</p>\n\n<pre><code># GET /actions/new\n# GET /actions/new.json\ndef new\n  @action = Action.new\n\n  respond_to do |format|\n    format.html # new.html.erb\n    format.json { render json: @action }\n  end\nend\n\ndef create\n  @action = Action.new(params[:action]) # here we get an error !\n\n  respond_to do |format|\n    if @action.save\n      format.html { redirect_to @action, notice: 'Action was successfully created.' }\n      format.json { render json: @action, status: :created, location: @action }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @action.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>And here is the form code</p>\n\n<pre><code>&lt;%= form_for(@action) do |f| %&gt;\n  &lt;% if @action.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@action.errors.count, \"error\") %&gt; prohibited this action from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @action.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user_id %&gt;&lt;br /&gt;\n    &lt;%= f.number_field :user_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When i press post, firebug shows this request parameters </p>\n\n<pre><code>utf8:✓\nauthenticity_token:lfHYF3EQn1/lMReK3alX3NsGa4wSMejC/0fEeoAFYUY=\naction[name]:sdf\naction[user_id]:23\ncommit:Create Action\n</code></pre>\n\n<p>if i understand correctly this must work and rails must turn action[name] and action[user_id] into hash table and place it into parameters[:action], then Action.new get this hash table as parameter. What is wrong ?</p>\n"},{"tags":["ruby-on-rails","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13069752,"title":"How can I make my mailer deliver a message to an address containing umlauts under Rails 3?","body":"<p>This is my mailer:</p>\n\n<pre><code>class MyUserMailer &lt; ActionMailer::Base\n  default from: \"me@mail.com\",\n          :content_transfer_encoding =&gt; \"7bit\"\n  def build_email(user)\n    mail(:to =&gt; user.email,:subject =&gt; \"Welcome\")\n  end\nend\n</code></pre>\n\n<p>I'm testing with an address containing umlauts: <code>äardvark@mail.com</code>, but I keep receiving the following error, when I try to deliver the email:</p>\n\n<pre><code>'to' parameter is not a valid address. please check documentation\n</code></pre>\n\n<p>Documentation says that the mailer will use UTF-8 to encode all the fields. How can I make this work?</p>\n\n<p>EDIT: I'm using Rails 3.2.5</p>\n"},{"tags":["ruby-on-rails","jruby","war"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13115409,"title":"Jruby Rails standalone war file ClassNotFoundException","body":"<p>I am experienced ROR developer, but new to JRuby.\nI am trying to create Rails application in Jruby and then making an executable WAR file using Warbler.</p>\n\n<pre><code>$warble executable war\n</code></pre>\n\n<p>It created a WAR file but when I tried to run it by</p>\n\n<pre><code>$java -jar myapp.war\n</code></pre>\n\n<p>It just throw up this error.</p>\n\n<pre><code>error: java.lang.ClassNotFoundException: winstone.Launcher\n</code></pre>\n\n<p>My on Ubuntu with RVM using JRuby 1.6.8, am I missing anything?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","get","form-for","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13118467,"title":"dealing with complex GET params in rails","body":"<p>I'm trying to pass params via GET to a form using ransack, it would normally work fine except that the params[:q] is causing a problem when I try to merge it.</p>\n\n<p>controller (using <a href=\"https://github.com/ernie/ransack\" rel=\"nofollow\">ransack</a>)</p>\n\n<pre><code>  def index\n    @search = Record.ransack(params[:q])\n    @records = @search.result.page(params[:page])\n  end\n</code></pre>\n\n<p>view</p>\n\n<pre><code>&lt;ul&gt;\n  &lt;% Genre.all.each do |genre| %&gt;\n    &lt;% category_count = @search.result.joins(:genre).where(\"genres.id = ?\", genre.id).size %&gt;\n    &lt;% unless category_count == 0 %&gt;\n        &lt;li&gt;\n            &lt;%= link_to genre.name, params.merge(:\"q[genre_name_eq]\" =&gt; genre.name) %&gt; (&lt;%= category_count %&gt;)\n        &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>But I keep getting duplication:</p>\n\n<pre><code>q[genre_name_eq]=Rockabilly&amp;q[genre_name_eq]=Rockabilly\n</code></pre>\n\n<p>Without the q[] it manages the params correctly, overwriting the previous one.</p>\n\n<p>Also tried <code>params[:q].merge(:genre_name_eq)</code> which causes the problem when there is no q[] and it also just doesn't work, giving me <code>genre_name_eq=</code> and no q[]</p>\n\n<p>How else can I handle the q[] so that it replaces the value instead of duplicating it several times?</p>\n"},{"tags":["ruby-on-rails","latency"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13115893,"title":"Rails application access is very slow","body":"<p>We are trying to access a Rails application running on a Ubuntu machine from a Windows machine and the time it takes to load the application is extremely slow. The ping operation from the Windows machine to the Ubuntu machine comes back in &lt; 1ms. How do I debug this issue?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","custom-routes"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":2750,"score":9,"question_id":4271023,"title":"Rails3 Routes - Passing parameter to a member route","body":"<p>I would like to pass an extra parameter to a member route of a resource</p>\n\n<p>something like:</p>\n\n<pre><code>resources :events do\n  member do\n    get 'register/:participant_type_id'\n  end\nend\n</code></pre>\n\n<p>I could only accomplish it using a static match statement</p>\n\n<p>Looking around the internet I saw that this might be possible in Rails 3.0.2. I'm using 3.0.1 and it certanlly is not.</p>\n\n<p>Am I doing something wrong? or is it really not possible?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails","ruby","installation","guide"],"answer_count":6,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":4577,"score":3,"question_id":4506330,"title":"Installing Ruby on Rails in Fresh Ubuntu 10.10 System","body":"<p>There are a lot of tutorials on how to install Ruby on Rails in Ubuntu 10.10. But even following the steps, there are still errors and dependencies that will encountered in order to successfully install RoR. The system varies on the developer's setup. To make it uniform, installation must be on a fresh Ubuntu 10.10 system. Is there a step-by-step guide on how to install RoR on a Fresh Ubuntu 10.10 machine? Like the first thing I need to do after starting the terminal.</p>\n"}]}
