{"count":24003,"tag":"linq","questions":[{"tags":["c#","linq","collections","lambda"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13275694,"title":"How to build this LINQ expression?","body":"<p>I have a class that looks like this: </p>\n\n<pre><code>class UserProfile { public int Id; public int? ParentId; public string Name; public string Role; }\n</code></pre>\n\n<p>Each UserProfile is a user or an admin. Each user may be a child of a single admin, whose Id is stored in the user's ParentId. Below is an example:</p>\n\n<pre><code>IEnumerable&lt;UserProfile&gt; users = new List&lt;UserProfile&gt;{\n        new UserProfile(){Id = 1, ParentId = null,  Name = \"Admin1\", Role = \"Admin\" },\n        new UserProfile(){Id = 2, ParentId = 1,  Name = \"User2\", Role = \"Admin\" },\n        new UserProfile(){Id = 3, ParentId = 1,  Name = \"User3\", Role = \"Admin\" },\n        new UserProfile(){Id = 3, ParentId = null,  Name = \"Admin2\", Role = \"Admin\" },\n        new UserProfile(){Id = 4, ParentId = 3,  Name = \"User4\", Role = \"Admin\" },\n        new UserProfile(){Id = 5, ParentId = null,  Name = \"User5\", Role = \"Admin\" },\n        new UserProfile(){Id = 6, ParentId = 3,  Name = \"User6\", Role = \"Admin\" },\n    };  \n</code></pre>\n\n<p>I need to rearrange this list or create another list, so that it will be in specific order:\nAll admins and their users:</p>\n\n<ul>\n<li><strong>Admin1</strong> (full details)   </li>\n<li>User2 (full details)</li>\n<li>User3 (full details)  </li>\n<li>User5 (full details) </li>\n<li><strong>Admin2</strong> (full details)   </li>\n<li>User4 (full details)</li>\n<li>User6 (full details)</li>\n</ul>\n\n<p>I tried to separate them first, but I don't know how to merge them in the desired order.</p>\n\n<pre><code>var adminsOnly = users.Where(p =&gt; p.Role.Equals(\"Admin\")).OrderBy(p =&gt; p.Id);\nvar usersOnly = users.Where(p =&gt; p.Role.Equals(\"User\")).OrderBy(p =&gt; p.Id);\n</code></pre>\n\n<p>Thanks a lot.</p>\n\n<p><strong>Note: There can be Users without Admins, and Admins without Users.</strong></p>\n"},{"tags":["c#",".net","xml","linq","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13280719,"title":"How do I read all XML nodes of a specific name and put them into an array (or list)?","body":"<p>I have an XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ticket&gt;\n    &lt;comments type=\"array\"&gt;\n         &lt;comment&gt; \n               &lt;attachments type=\"array\"&gt;\n                     &lt;attachment&gt;\n                          &lt;url&gt;I NEED WHATEVER IS IN HERE&lt;/url&gt;\n                     &lt;/attachment&gt;\n               &lt;/attachments&gt;\n         &lt;/comment&gt;\n         &lt;comment&gt;\n               &lt;attachments type=\"array\"&gt;\n                     &lt;attachment&gt;\n                          &lt;url&gt;I NEED WHATEVER IS IN HERE&lt;/url&gt;\n                     &lt;/attachment&gt;\n               &lt;/attachments&gt;\n         &lt;comment&gt;\n     &lt;/comments&gt;\n&lt;/ticket&gt;\n</code></pre>\n\n<p>How would I go about getting whatever is inside the URL tag and add it to a <code>&lt;List&gt;</code>? I'm using C#.</p>\n"},{"tags":["wpf","linq","c#-4.0",".net-4.0","observablecollection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13279133,"title":"What more LINQ operators/methods can I use to optimize my C# Collections based code?","body":"<p><strong>Is there a way (using <code>LINQ</code> possibly) I can optimize the below code</strong>. What this code does is adds, removes and updates the items in the variable <code>myFirstCollection</code> by comparing the items in variable <code>mySecondCollection</code>. Can somehow I use more LINQ methods/queries or other LINQ operators so that the <code>myFirstCollection</code> variable is compared and updated as quickly as possible. </p>\n\n<p><strong>To add to my requirement, my <code>ObservableCollection</code> variable <code>myfirstCollection</code> is bound to the <code>WPF Grid</code> so that the additions, deletions and, updates are reflected in grid immediately with data binding.</strong></p>\n\n<pre><code>private void UpdateFirstCollection(ObservableCollection&lt;MyDTO&gt; myFirstCollection, IEnumerable&lt;MyDTO&gt; mySecondCollection)\n{\n//Code to add items to First Collection, how to optimize this block?\n    foreach (var item in mySecondCollection.ToList())\n    {\n        if (!myFirstCollection.Contains(item))\n        {\n            myFirstCollection.Add(item);\n        }\n        else\n        {\n//Code to update items from First Collection, how to optimize this block?\n            var itemToUpdate = myFirstCollection.FirstOrDefault(dto =&gt; dto.ID == item.ID);\n            if (itemToUpdate != null)\n            {\n                itemToUpdate = item;\n            }\n        }\n    }\n\n//Code to remove items from First Collection, how to optimize this block?\n    var copy = new ObservableCollection&lt;myDTO&gt;(myFirstCollection);\n    foreach (var item in copy.ToList())\n    {\n        if (!mySecondCollection.Contains(item))\n        {\n            myFirstCollection.Remove(item);\n        }\n    }\n}\n</code></pre>\n\n<p>Any help to <em>Refactor</em> / <em>Improve</em> the above code based on any articles/links is highly appreciated.</p>\n"},{"tags":["asp.net-mvc","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13280624,"title":"How to write if condition inside where clause in linq","body":"<p>I want to write  if condition inside where clause. because if first name or last name is null I don't wani to add it in where  clause . other wise I want to add it.</p>\n\n<p>so I write </p>\n\n<pre><code>var query1 = from opv in _opvRepository.Table\n                         join o in _orderRepository.Table on opv.OrderId equals o.Id\n                         join gr in _graduandRepository.Table on opv.graduand_id equals gr.graduand_id\n                         join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                         join p in _productRepository.Table on pv.ProductId equals p.Id\n                         where (opv.ceremony_id == ceremony_id) &amp;&amp; \n                         (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                         (!p.Deleted) &amp;&amp;\n                         (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)      \n                       //  group opv by opv.OrderId into g\n                         select new\n                         {\n                             opvTable = opv,\n                             grTable = gr,\n\n                         };\n\n\n// This is not working. I have problem in here. How to add this??\n             if (!String.IsNullOrEmpty(Fname))\n                 query1 = query1.Where(grTable = &gt; grTable.first_name == Fname);\n\n\n\n\n            var result = query1.ToList().Select(x =&gt;\n            {\n                return new HireItemReportLine()\n                {\n                    OrderId = x.opvTable.OrderId,\n                    OrderDate=x.opvTable.Order.CreatedOnUtc,\n                    Amount= x.opvTable.Order.OrderSubtotalExclTax,\n                    PaymentMethod = x.opvTable.Order.PaymentMethodSystemName,\n                    paidDate = x.opvTable.Order.CreatedOnUtc,\n\n                    Fname = x.grTable.first_name,\n                    MName = x.grTable.middle_name,\n                    LName = x.grTable.last_name,\n\n\n\n                };\n            }).ToList();\n</code></pre>\n\n<p>What is the wrong with my cording??</p>\n"},{"tags":["linq"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12334822,"title":"LINQ Lambda Order in writing the query","body":"<p>I have the following query:</p>\n\n<pre><code>      var query = db.Prog\n       .Where (a =&gt; a.Prog != \"00000\" &amp;&amp; a.fn != \"Koll\")\n       .Select(a =&gt; new  {a.Prog, a.MEfn})\n       .OrderByDescending(a =&gt; a.MEfn)\n</code></pre>\n\n<p>The query works fine but wondering if there are general rules on the order in which you write a Lambda linq query. Meaning, .Where comes before .Select, etc.</p>\n\n<p>Can somebody enlighten me on the order in which LINQ needs to be written or best practices.</p>\n"},{"tags":["c#","asp.net-mvc","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":19,"score":-5,"question_id":13279844,"title":"How to do group by and join table in linq?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13279499/how-to-join-and-group-by-with-linq\">How to join and group by with linq?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to join table and  and group by in linq.\nSo I write </p>\n\n<pre><code>   var query1 = from opv in _opvRepository.Table\n                         join o in _orderRepository.Table on opv.OrderId equals o.Id\n                         join gr in _graduandRepository.Table on opv.graduand_id equals gr.graduand_id\n                         join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                         join p in _productRepository.Table on pv.ProductId equals p.Id\n                         where (opv.ceremony_id == ceremony_id) &amp;&amp;\n                         (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                         (!p.Deleted) &amp;&amp;\n                         (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)\n                          group opv by opv.OrderId into g\n                          select new\n                          {\n                              TotalAmount = g.Sum(x =&gt; x.PriceExclTax),\n                               table2Val = gr\n\n                          };   \n\n\n            var result = query1.ToList().Select(x =&gt;\n            {\n                return new HireItemReportLine()\n                {\n                    Fname = x.table2Val.first_name,\n                  MName = x.table2Val.middle_name,\n                  LName = x.table2Val.last_name,\n                };\n            }).ToList();\n</code></pre>\n\n<p>I want to select the <code>gr</code> table data, <code>opv</code> table data and <code>o</code> table data.</p>\n\n<p>But there is error and it says</p>\n\n<pre><code>The name 'gr' does not exist in the current context\n</code></pre>\n\n<p>How to solve it??</p>\n"},{"tags":["c#","linq","entity-framework-4","entity-framework-5"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13274597,"title":"Entity Framework 5 upgrade from 4","body":"<p>I'm having an issue with the Where clause in a search, in my original version EF4 I could add a Where clause with  2 parameters, the where clause (string predicate) and a ObjectParameter list such as</p>\n\n<pre><code>var query = context.entities.Where(WhereClause.ToString(), Params.ToArray());\n</code></pre>\n\n<p>since my upgrade to EF5 I don't seem to have that option am I missing something?</p>\n\n<p>This was originally used to build dynamic where clause such as \"it.entity_id = @entity_id\" then holding the variable value in the ObjectParameter.</p>\n\n<p>I'm hoping I don't have to rewrite all the searches that have been built out this way, so any assistance would be greatly appreciated.</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","linq","mongodb","query-optimization","mongodb-csharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13254784,"title":"Is there an \"Explain Query\" for MongoDB Linq?","body":"<p>Is there a way to run <code>.explain()</code> or equivalent on Linq queries? I would want to know </p>\n\n<ul>\n<li>The text of the actual JSON query</li>\n<li>The output of <code>.explain()</code> (indexes used, etc)</li>\n<li>It would also be nice to have the execution time of the query </li>\n</ul>\n"},{"tags":["asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13279389,"title":"Compiler Error Message: CS1502","body":"<p>For the below linq query I added </p>\n\n<pre><code>w = document.tblTransmittalls.Select(dx =&gt; dx.tblFiles)\n</code></pre>\n\n<p>Field and also for the below function I added \"theDocument.w\" argument but i have error and it shows me:</p>\n\n<pre><code>IEnumerable&lt;System.Data.Linq.EntitySet&lt;tblFile&gt;&gt;\n</code></pre>\n\n<p>While I like to be like other arguments: <code>IEnumerable&lt;tblFile&gt; w</code>\nI do not know what happened.</p>\n\n<blockquote>\n  <p>Compiler Error Message: CS1502</p>\n</blockquote>\n\n<p>Before adding \"theDocument.w\" argument to my function I had not error.</p>\n\n<pre><code>private void DisplayDocument()\n{\n    var documents =\n      from document in _DataContext.tblDocuments\n      where document.DocId == _DocID\n      select new\n      {\n          DocId = document.DocId,\n          Title = document.TITLE,\n          DocNo = document.DocumentNo,\n          Originator = document.Originator,\n          Type = document.Document_Type,\n          Unit = document.Unit,\n          MaterialCode = document.EQ_IN_Identify_Material_Code,\n          Transmittals = document.tblTransmittalls.Select(dt =&gt; dt.tbltransmittalNo),\n          x = document.tblTransmittalls.Select(dp =&gt; dp.tblDocTranstoCons.tblTranstoCon),\n          //Authors = book.BookAuthors.Select(bookAuthor =&gt; bookAuthor.AuthorObject),\n          y = document.tblTransmittalls,\n          z = document.tblTransmittalls.Select(dp =&gt; dp.tblDocTranstoCons),\n          w = document.tblTransmittalls.Select(dx =&gt; dx.tblFiles)\n      }\n\nDisplayTransmittals(theDocument.Transmittals, theDocument.x, theDocument.DocId, theDocument.y, theDocument.z, theDocument.w);\n\n\nprivate void DisplayTransmittals(IEnumerable&lt;tbltransmittalNo&gt; transmittals, IEnumerable&lt;tblTranstoCon&gt; x, int d,\n    IEnumerable&lt;tblTransmittall&gt; y, IEnumerable&lt;tblDocTranstoCon&gt; z, IEnumerable&lt;tblFile&gt; w)\n{\n    Transmittallistfortest transmittalList = (Transmittallistfortest)DetailsView1.FindControl(\"Transmittallistfortest1\");\n    GridView g3 = transmittalList.FindControl(\"GridViewTtransmittals\") as GridView;\n    transmittalList.Transmittals = transmittals;\n    transmittalList.Doc = d;\n    transmittalList.Transmittaltocons = x;\n    transmittalList.DocTranstoCons = z;\n    transmittalList.tblTransmittall = y;\n    transmittalList.Efiles = w;\n    transmittalList.DataBind();\n\n}\n</code></pre>\n"},{"tags":["c#",".net","linq","extension-methods"],"answer_count":1,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":45,"score":5,"question_id":13279215,"title":"Wrap a Linq query in a try/catch block using a method declaration","body":"<p>So here is what I would like to be able to do.</p>\n\n<pre><code>var a = Item.CatchLog().Where(x=&gt;x.Property==\"value\").Take(10);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = Item.CatchLog().FirstOrDefault(x=&gt;x.Property==\"value\");\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = Item.CatchLog().Any(x=&gt;x.Property==\"value\");\n</code></pre>\n\n<p>Essentially, I would like is for <code>CatchLog()</code> to basically wrap the execution of the query in a try catch, and <code>Debug.WriteLine()</code> the <code>Exception</code> and then <code>throw</code> it. </p>\n\n<p>Any ideas on how I could implement something like this?</p>\n"},{"tags":["c#","linq","entity-framework","casting"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":113,"score":4,"question_id":13276806,"title":"Converting from IEnumerable<IEnumerable<string>> to ICollection<T>","body":"<p>I'm trying to convert an <code>IEnumerable&lt;IEnumerable&lt;string&gt;&gt;</code> to <code>ICollection&lt;Character&gt;</code> but struggling to figure out the right way to do it since the structure of one object is different than the structure of the other.</p>\n\n<p>The reason for conversion is to take a json deserialization and insert that into a database via Entity Framework. The json data isn't normalized and doesn't match the exact structure of the database. In the database I have a <code>movie</code> and a <code>person</code> that have a many-to-many relationship. The bridge table between them is <code>characters</code>. But the json just has a movie object with an array of people objects and each person with an array of the characters they play (<code>IEnumerable&lt;IEnumerable&lt;string&gt;&gt;</code>).</p>\n\n<p>Basically, I need to convert each movie's people and their characters to each movie's character and its respective person.</p>\n\n<pre><code>var movie = dataContractMovies.Select(m =&gt; new Movie {\n    Title = m.Title,\n    // not sure how to convert each Person and their characters\n    Characters = // Need to take each Person and their Characters in m.Cast and cast to a new Character and a new Person for which the Character belongs to\n});\n</code></pre>\n\n<p><strong>Convert From</strong></p>\n\n<pre><code>public class MovieDataContract {\n    [DataMember(Name = \"title\")]\n    public string Title { get; set; }\n\n    [DataMember(Name = \"abridged_cast\")]\n    public virtual IEnumerable&lt;Person&gt; Cast { get; set; }\n}\n\n[DataContract]\npublic class Person {\n    [DataMember(Name = \"name\")]\n    public string Name { get; set; }\n\n    [DataMember(Name = \"characters\")]\n    public IEnumerable&lt;string&gt; Characters { get; set; }\n} \n</code></pre>\n\n<p><strong>Convert To</strong></p>\n\n<pre><code>public partial class Movie {\n    public string Title { get; set; }\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n\n    public Movie() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n}\n\npublic partial class Character {\n    public string Name { get; set; }\n    public virtual Movie Movie { get; set; }\n    public virtual Person Person { get; set; }\n}\n\npublic partial class Person {\n    public string Name { get; set; }\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n\n    public Person() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13279000,"title":"Convert lambda expression to linq query","body":"<p>Is there any way to convert this lambda expression in linq query?</p>\n\n<pre><code>function List&lt;ViewModel&gt; CreateViewModels(List&lt;Model&gt; models)\n{\n   return models.Select(x =&gt;\n   {\n      var viewModel = new ViewModel();\n\n      this.UpdateViewModel(x, viewModel);\n\n      return viewModel;\n   }).ToList();\n}\n</code></pre>\n\n<p>Where 'UpdateViewModel' is a function that transfer the values from the Model object to the ViewModel object.</p>\n\n<p>Ok, this code is clean but I'm wondering to know if there is the equivalent with a linq query.</p>\n"},{"tags":["c#","linq","visual-studio-lightswitch"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13017288,"title":"Lightswitch, adding filter to query that relies on unsaved changes","body":"<p>I'm using Lightswitch and I'm trying to populate a dropdown list by filtering the query to the a list of items that have not been selected already.</p>\n\n<p>The code I wrote works, but it is only using the data that has been \"saved\".  I'd like to filter out things that have been added, but not necessarily saved.</p>\n\n<pre><code>partial void NotAssignedToEventEmployee_PreprocessQuery(int? SelectedEventId, ref IQueryable&lt;EmployeeItem&gt; query)\n{\n    query = from a in query\n            where a.AssignmentsAsEmployeeCollection.All(y =&gt; y.EventSetItem.Id != (int)SelectedEventId)\n            select a;\n}\n</code></pre>\n"},{"tags":["c#",".net","xml","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13278778,"title":"How to use XElement.Parse and then find the value of a specific element?","body":"<p>I've got some XML that is returned from a REST call that looks like this:</p>\n\n<pre><code>&lt;ArrayOfProperty xmlns=\\\"http://schemas.microsoft.com/HPCS2008R2/common\\\" xmlns:i=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;Id&lt;/Name&gt;\n    &lt;Value&gt;17&lt;/Value&gt;\n  &lt;/Property&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;StartTime&lt;/Name&gt;\n    &lt;Value&gt;11/7/2012 9:13:50 PM&lt;/Value&gt;\n  &lt;/Property&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;State&lt;/Name&gt;\n    &lt;Value&gt;Failed&lt;/Value&gt;\n  &lt;/Property&gt;\n</code></pre>\n\n<p>I'm using the RestSharp API to assist in executing the API calls and trying to use the linq-to-xml XElement.Parse to parse the results.  I'm not sure how to get the value of the state such that from within this document I want to do something like :</p>\n\n<p><code>XElement.Parse(XMLstring).Elements???</code> to get the text \"Failed\" from the set of elements that contains the element State but I want the text \"Failed\" from the <code>&lt;Value&gt;Failed&lt;/Value&gt;</code> element.  That value element can have multiple values but I always want the value that is associated with the state.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["linq","asp.net-mvc-3","razor"],"answer_count":3,"favorite_count":8,"up_vote_count":13,"down_vote_count":0,"view_count":39086,"score":13,"question_id":5070762,"title":"MVC3 Razor @Html.DropDownListFor","body":"<p>I could use some help implementing @Html.DropDownListFor. My objective is to filter the list of Products by Category.</p>\n\n<p>This code will display a list box:</p>\n\n<pre><code>@model IEnumerable&lt;Sample.Models.Product&gt;\n@{\n    List&lt;Sample.Models.Category&gt; list = ViewBag.Categories;\n    var items = new SelectList(list, \"CategoryID\", \"CategoryName\");\n\n}\n@Html.DropDownList(\"CategoryID\", items)\n</code></pre>\n\n<p>But I'm having trouble getting <code>@Html.DropDownListFor</code> to work:</p>\n\n<pre><code>@model IEnumerable&lt;Sample.Models.Product&gt;\n@{\n    List&lt;Sample.Models.Category&gt; list = ViewBag.Categories;\n    var items = new SelectList(list, \"CategoryID\", \"CategoryName\");\n\n}\n@Html.DropDownListFor(???, @items)\n</code></pre>\n\n<p>I could use some help constructing the Linq portion of <code>@Html.DropDownListFor</code>.\nHere is the model:</p>\n\n<pre><code>public class Product\n{\n    public int ProductID { get; set; }\n    public string ProductName { get; set; }\n    public int CategoryID { get; set; }\n    public string QuantityPerUnit { get; set; }\n    public Decimal? UnitPrice { get; set; }\n    public short UnitsInStock { get; set; }\n\n    public virtual Category Category { get; set; }\n}\n\npublic class Category\n{\n    public int CategoryID { get; set; }\n    public string CategoryName { get; set; }\n\n    public virtual ICollection&lt;Product&gt; Products { get; set; }\n\n}\n</code></pre>\n"},{"tags":["asp.net-mvc","linq","entity-framework","tsql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13278891,"title":"Complex SQL to LINQ to populate Grid (Count items year by month) (MVC, EF Code First)","body":"<p>I have a grid that I want to fill with the following:</p>\n\n<p>It is tracking tickets that have been open each month for the last year. The grid is filtered by priority so I have a something like this:</p>\n\n<pre><code>| Mon | Critical | High | Tot |\n| Jan |    5     |  2   |  7  |\n| Feb |    2     |  3   |  5  |\n</code></pre>\n\n<p>This is my SQL statement:</p>\n\n<pre><code>SELECT\n    MONTH(CreateDate),\n    DATENAME(MONTH,m.CreateDate) AS 'Month',\n    SUM(CASE WHEN (m.PriorityId = 1) THEN 1 ELSE 0 END) AS 'Critical',\n    SUM(CASE WHEN (m.PriorityId = 2) THEN 1 ELSE 0 END) AS 'High',\n    SUM(CASE WHEN (m.PriorityId = 3) THEN 1 ELSE 0 END) AS 'Normal',\n    SUM(CASE WHEN (m.PriorityId = 4) THEN 1 ELSE 0 END) AS 'Low',\n    SUM(CASE WHEN (m.PriorityId = 5) THEN 1 ELSE 0 END) AS 'Not Ready',\n    Count(m.Id) AS Total\nFROM\n    tblMaintenanceTicket m\nINNER JOIN\n    tblPriority p\nON\n    p.Id = m.PriorityId\nWHERE\n    StatusId = 1\n    AND YEAR(CreateDate) = year(getdate())\nGROUP BY \n    MONTH(CreateDate),\n    DATENAME(MONTH,m.CreateDate)\nORDER BY\n    MONTH(CreateDate)\n</code></pre>\n\n<p>I am looking to convert this in VB LINQ but I am not sure this is the best method. I am also thinking calling a stored procedure, but I want to stay out of the DB really. I am using MVC 3 with the repository pattern, so calling my code is something like this output for JSON:</p>\n\n<pre><code>Dim tickets = ticketRepo.GetAll().Include(Function(p) p.Priority).ToArray()\n</code></pre>\n\n<p>Any assistance?</p>\n"},{"tags":["c#","sql","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13276024,"title":"Complex LINQ to SQL Query with dates","body":"<p>I'm building a query with LINQ to SQL in my C# project, but I have some problems with it...</p>\n\n<p>What I want to do, is select the 4 lasts days that are like today (For example, a Friday), so if we're on Friday 28, I want to query for: Friday 21, 14, 7... The last four Fridays but NOT today.</p>\n\n<p>This is easy, I've done that but here's the complex part, I want to <strong>not</strong> query the exceptions I set, for example End of month, which are from 28th to 1st day of each month, so let's say i want to query this (october, fridays):</p>\n\n<p>Today is Friday 26, I want to query:</p>\n\n<p>19, 12, 5 and September 28th (the fourth friday from now), but as I said, 28th is end of month, so i need to return September 21th which is the last friday and it is not end of month... I have the same issues with holidays, but I think if I can handle end of months, I can do with them...</p>\n\n<p>i hope I've explained good for you to understand what I want... Here's my query, which is working but can't handle exceptions. (the field b.day is the Id for each days, 8 means end of month, and 7 holiday)</p>\n\n<pre><code>var values =\n    from b in dc.MyTable\n    where // This means end of month\n    b.day != 8\n\n    // This triggers to query last 4 days\n    &amp;&amp; b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-28)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-21)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-14)\n    || b.date == Convert.ToDateTime(last.ToString(\"dd/MM/yyy\")).AddDays(-7)\n    orderby b.id descending\n    group b.valor by b.hora_id into hg\n    orderby hg.Key descending\n\n    select new\n    {\n        Key = hg.Key,\n        Max avg = System.Convert.ToInt32(hg.Average() + ((hg.Average() * intOkMas) / 100)),\n        Min avg = System.Convert.ToInt32(hg.Average() - ((hg.Average() * intOkMenos) / 100))\n    };\n</code></pre>\n"},{"tags":["c#","arrays","linq","multidimensional"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13278194,"title":"LINQ and Array.Copy","body":"<p>I have the following:</p>\n\n<pre><code>var list = new List&lt;double[]&gt;();\nlist.Add(new double[] { 300, 12, 22 });\nlist.Add(new double[] { 310, 13, 23 });\nlist.Add(new double[] { 320, 14, 24 });\nlist.Add(new double[] { 330, 15, 25 });\n</code></pre>\n\n<p>I would like to get from this a multidimensional array containing the first 2 columns:</p>\n\n<pre><code>double[,] a = { {300,12}, {310,13}, {320,14}, {330,15}}\n</code></pre>\n\n<p>Can I do this using linq? And how?</p>\n"},{"tags":["linq","entity-framework","logging","linq-to-entities","ef-code-first"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13278294,"title":"EF Tracing Provider, Tracking Calling Method or Entity","body":"<p>I've gotten the EFTracingProvider to work with my code first application, but when logging, my application tries to log the calling class.  Since my context is always where the EFTracing Provider resides, that is what's getting stored in the calling class, even though the actual attempt to reference the entity happened in another class.</p>\n\n<p>Is there anyway to either track where the actual call happened, or to track which entity or DBSet in the context was trying to be accessed, which then caused the Tracing to fire?</p>\n"},{"tags":["asp.net","linq","asp.net-mvc-3","group","cfoutput"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":469,"score":0,"question_id":9202430,"title":"LINQ to SQL grouping and passing onto a view","body":"<p>I am new to Asp.Net, MVC3, Linq, and everything else related to it. I'm very used to PHP and ColdFusion so pardon my ignorance! Essentially what I am trying to do is re-create the situation in ColdFusion where I can perform the equivalent of a cfoutput's group attribute. I'm so used to just calling a stored procedure and then doing</p>\n\n<p><code>&lt;cfoutput group=\"id\"&gt;</code></p>\n\n<p>and then another inner cfoutput for any columns that have non-distinct data. Works like a charm! Not so much in Asp.Net.</p>\n\n<p>I would like to stay with using my stored procedure, which is returning a join from two tables with a one-to-many relationship. For example's sake let's say I have 3 columns: a full name, a title, and a graduation year. The graduation year is the column from the joined table, so my result from the stored procedure looks like this:</p>\n\n<p>Jim   Professor    2005<br>\nJim   Professor    2008<br>\nJim   Professor    2011</p>\n\n<p>I am sending this to the View. I am assuming it's the View's job to then group the data based on one of the columns (probably the full name). I want to output an HTML table with 3 columns and in this situation I would have ONE row:</p>\n\n<p>Jim   Professor   2005, 2008, 2011</p>\n\n<p>I have googled tons of examples that use this thing called a group key. This does not seem to help me because I'm not interested in just outputting one value \"Jim\" (or whatever the grouped value is), I need both \"Jim\" and \"Professor\" values to be output for each row. My thinking is I would need 2 foreach loops, the outer loop displaying the fullname and title and the inner loop going through all possible matches for the graduation years. I cannot seem to get the graduation years in a group, especially with this IGrouping syntax. The key can only store one value and I need every value on that row, I only really need one or two values to be iterated over. Should I try and create a custom view model after I perform a secondary linq grouping and then send that to a strongly typed view?</p>\n\n<p><strong>EDIT:</strong>\nOk, I have code that works but it seems very inefficient as I basically have to re-define all of the columns/values that I have from my stored procedure. It almost makes me want to forget stored procedures and just use LINQ for everything. It seems what I was asking for is a kind of \"group on multiple columns\" and <a href=\"http://stackoverflow.com/questions/5231845/c-sharp-linq-group-by-on-multiple-columns\">link</a> helped immensely.</p>\n\n<pre><code>var records = db.getRecords();\nvar groups = from r in records\n    group r by new\n    {\n       r.id\n    }\n    into row\n    select new ListVM()\n    {\n       id = row.Key.id,\n       fullname = row.Select(x =&gt; x.fullname).First(),\n       title = row.Select(x =&gt; x.title).First(),\n       degrees = row.Select(x =&gt; x.degree_name).ToList(),\n       majors = row.Select(x =&gt; x.major_name).ToList()\n    };\nreturn View(groups);\n</code></pre>\n\n<p>I of course had to create a ViewModel for this to work. In my view then I can use for loops to iterate over the degrees and majors lists. Is this the best way to do this? I just generally need more than just the group key to display my entire row of information, and only want to iterate over lists once or twice in a 20 column row, as opposed to only displaying the group key once and iterating over everything in most examples I see.</p>\n"},{"tags":["c#",".net","xml","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13260131,"title":"How to parse XML header and nested sections using LINQ","body":"<pre><code>XElement documentRoot = XElement.Parse(@\"&lt;OrdersReport Date='2012-08-01'&gt;\n                &lt;SettingHeader&gt;\n                  &lt;SettingId&gt;1&lt;/SettingId&gt;\n                &lt;/SettingHeader&gt;\n                  &lt;Client&gt;\n                    &lt;ClientId&gt;1&lt;/ClientId&gt;\n                    &lt;Orders&gt;\n                      &lt;Order&gt;\n                        &lt;OrderNumber&gt;1&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;123 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;MyCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AZ&lt;/ShipState&gt;\n                      &lt;/Order&gt;\n                      &lt;Order&gt;\n                        &lt;OrderNumber&gt;2&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;111 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;OtherCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AL&lt;/ShipState&gt;\n                      &lt;/Order&gt;\n                      &lt;OrderCancelled&gt;\n                        &lt;OrderNumber&gt;3&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;222 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;CancelledCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AL&lt;/ShipState&gt;\n                      &lt;/OrderCancelled&gt;\n                    &lt;/Orders&gt;\n                    &lt;Returns&gt;\n                      &lt;Amount&gt;\n                        &lt;OrderId&gt;2&lt;/OrderId&gt;\n                        &lt;OrderId&gt;3&lt;/OrderId&gt;\n                        &lt;OrderId&gt;21&lt;/OrderId&gt;       \n                      &lt;/Amount&gt;\n                    &lt;/Returns&gt;\n                  &lt;/Client&gt;\n                  &lt;Client&gt;\n                    &lt;ClientId&gt;2&lt;/ClientId&gt;    \n                  &lt;/Client&gt;\n                &lt;/OrdersReport&gt;\");\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>        var orders = documentRoot.Descendants(\"Order\")\n                       .Concat(documentRoot.Descendants(\"OrderCancelled\"))\n                       .Select(x =&gt; new\n                       {\n                           OrderNumber = (int)x.Element(\"OrderNumber\"),\n                           ShipAddress = (string)x.Element(\"ShipAddress\"),\n                           ShipCity = (string)x.Element(\"ShipCity\"),\n                           ShipState = (string)x.Element(\"ShipState\")\n                       });\n\n        foreach (var o in orders)\n        {\n            Console.WriteLine(o.OrderNumber + \" \" + o.ShipAddress + \" \" \n                + o.ShipCity);\n        }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 123 Main St. MyCity\n2 111 Main St. OtherCity\n3 222 Main St. CancelledCity\n3 222 Main St. CancelledCity\n</code></pre>\n\n<p>How do I append <em>ClientId</em> and <em>SettingId</em> like the below output?</p>\n\n<p>Target output:</p>\n\n<pre><code>1 123 Main St. MyCity ClientId 1 SettingId 1\n2 111 Main St. OtherCity ClientId 1 SettingId 1\n...\n</code></pre>\n"},{"tags":["c#",".net","linq","linq-to-entities"],"answer_count":6,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":666,"score":4,"question_id":1689199,"title":"C# - code against a property using the property name as a string","body":"<p>What's the simplest way to code against a property in C# when I have the property name as a string?  For example, I want to allow the user to order some search results by a property of their choice (using LINQ).  They will choose the \"order by\" property in the UI - as a string value of course.  Is there a way to use that string directly as a property of the linq query, without having to use conditional logic (if/else, switch) to map the strings to properties.  Reflection?</p>\n\n<p>Logically, this is what I'd like to do:</p>\n\n<pre><code>query = query.OrderBy(x =&gt; x.\"ProductId\");\n</code></pre>\n\n<p>Update:\nI did not originally specify that I'm using Linq to Entities - it appears that reflection (at least the GetProperty, GetValue approach) does not translate to L2E.</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13267721,"title":"LINQ Query - Only get Order and MAX Date from Child Collection","body":"<p>I'm trying to get a list that displays 2 values in a label from a parent and child (1-*) entity collection model.  </p>\n\n<p>I have 3 entities:</p>\n\n<ol>\n<li>[<strong>Customer</strong>]: CustomerId, Name, Address, ...  </li>\n<li>[<strong>Order</strong>]: OrderId, OrderDate, EmployeeId, Total, ... </li>\n<li>[<strong>OrderStatus</strong>]: OrderStatusId, StatusLevel, StatusDate, ...</li>\n</ol>\n\n<p>A <strong>Customer</strong> can have MANY <strong>Order</strong>, which in turn an Order can have MANY <strong>OrderStatus</strong>, i.e. \n[<strong>Customer</strong>] 1--* [<strong>Order</strong>] 1--* [<strong>OrderStatus</strong>]</p>\n\n<p>Given a CustomerId, I want to get all of the Orders (just OrderId) and the LATEST (MAX?) OrderStatus.StatusDate for that Order.</p>\n\n<p>I've tried a couple of attempts, but can seem to get the results I want.</p>\n\n<pre><code>private IQueryable&lt;Customer&gt; GetOrderData(string customerId)\n{\n     var ordersWithLatestStatusDate = Context.Customers\n\n     // Note: I am not sure if I should add the .Expand() extension methods here for the other two entity collections since I want these queries to be as performant as possible and since I am projecting below (only need to display 2 fields for each record in the IQueryable&lt;T&gt;, but thinking I should now after some contemplation.\n\n     .Where(x =&gt; x.CustomerId == SelectedCustomer.CustomerId)\n     .Select(x =&gt; new Custom \n     {\n         CustomerId = x.CustomerId,\n         ...\n         // I would like to project my Child and GrandChild Collections, i.e. Orders and OrderStatuses here but don't know how to do that. I learned that by projecting, one does not need to \"Include/Expand\" these extension methods.  \n     });\n     return ordersWithLatestStatusDate ;\n}\n</code></pre>\n\n<p>---- UPDATE 1 ----</p>\n\n<p>After the great solution from User: <a href=\"http://stackoverflow.com/users/470005/lazyberezovsky\">lazyberezovsky</a>, I tried the following:</p>\n\n<pre><code>var query = Context.Customers\n            .Where(c =&gt; c.CustomerId == SelectedCustomer.CustomerId)\n            .Select(o =&gt; new Customer \n            { \n                Name = c.Name, \n                LatestOrderDate = o.OrderStatus.Max(s =&gt; s.StatusDate) \n            });\n</code></pre>\n\n<p>In my hastiness from my initial posting, I didn't paste everything in correctly since it was mostly from memory and didn't have the exact code for reference at the time.  My method is a strongly-typed IQueryabled where I need it to return a collection of items of type T due to a constraint within a rigid API that I have to go through that has an IQueryable query as one of its parameters. I am aware I can add other entities/attributes by either using the extension methods .Expand() and/or .Select().  One will notice that my latest UPDATED query above has an added \"new Customer\" within the .Select() where it was once anonymous.  I'm positive that is why the query failed b/c it couldn't be turn into a valid Uri due to LatestOrderDate not being a property of Customer at the Server level.  FYI, upon seeing the first answer below, I had added that property to my client-side Customer class with simple { get; set; }.  So given this, can I somehow still have a Customer collection with the only bringing back those 2 fields from 2 different entities?  The solution below looked so promising and ingenious!</p>\n\n<p>---- END UPDATE 1 ----</p>\n\n<p>FYI, the technologies I'm using are OData (WCF), Silverlight, C#.</p>\n\n<p>Any tips/links will be appreciated.</p>\n"},{"tags":["c#",".net","asp.net-mvc-3","linq","entity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13276745,"title":"Creating Navigation Property without foreign key?","body":"<p>I am trying to create a navigation property for my data model using an existing database.  The data has a shared key (like a foreign key) however it is not specified that way in the database.  Here is what it looks like:</p>\n\n<pre><code> [Table(\"Alpha\")]\n    public class Alpha\n    {\n        public int AlphaID { get; set; }\n\n        public int AlphaGroupID { get; set; }\n\n        public int? ParentAlphaID { get; set; }\n\n        public int? CodeID { get; set; }\n\n        public int? BracketCodeID { get; set; }\n\n        public string Title { get; set; }\n    }\n\n\n\n\n\n[Table(\"AlphaGroup\")]\n    public class AlphaGroup\n    {\n        [Column(\"AlphaGroupID\")]\n        public int AlphaGroupID { get; set; }\n\n        public string Title { get; set; }\n\n        public string TitleAddon { get; set; }\n\n    }\n</code></pre>\n\n<p>AlphaGroupID needs to be a navigation property to AlphaGroupID but is not a foreign key.  Is there a way to accomplish this?</p>\n"},{"tags":["c#","linq","collections"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":216,"score":1,"question_id":6228129,"title":"Linq Get Collection of collocated equal objects","body":"<p>The following code shows what I want to do:</p>\n\n<pre><code>public static IEnumerable&lt;IEnumerable&lt;T&gt;&gt; DoIt&lt;T&gt;(this IEnumerable&lt;T&gt; that)\n{\n    if (that == null)\n        throw new ArgumentNullException();\n\n    if (that.Count() &gt; 1)\n    {\n        var result = new Collection&lt;IEnumerable&lt;T&gt;&gt;();\n        var collection = new Collection&lt;T&gt;();\n\n        collection.Add(that.ElementAt(0));\n        for (int i = 1; i &lt; that.Count(); ++i)\n        {\n            if (!that.ElementAt(i).Equals(that.ElementAt(i - 1)))\n            {\n                result.Add(collection);\n                collection = new Collection&lt;T&gt;();\n            }\n\n            collection.Add(that.ElementAt(i));\n        }\n\n        result.Add(collection);\n        return result;\n    }\n\n    return new Collection&lt;IEnumerable&lt;T&gt;&gt;() { that };\n}\n</code></pre>\n\n<p>I'm only using custom implementations like that one, if there is no appropriate implementation already existing. Is there any way to do the same with the standard framework?</p>\n"},{"tags":["c#","asp.net-mvc-3","linq","entity-framework","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13273012,"title":"How to combine two model list to one model","body":"<p>Please see code below :</p>\n\n<pre><code>public class NewsFilterModel\n{\n    public CtArticleDetail ArticleDetail { get; set; }\n\n    public PcPage Page { get; set; }\n}\n\npublic IEnumerable&lt;NewsFilterModel&gt; GetNewsFilterModelByTagNames(string tagNames, int status)\n{\n     var resultArticle = db.CtArticleDetail.Where(m =&gt; m.tagNames == tagNames);\n     var resultPage  = db.PcPage.Where(m =&gt; m.tagNames == tagNames);\n}\n</code></pre>\n\n<p>Can anyone please advice what the best way to combine two model to one model which is NewsFilterModel ?</p>\n\n<p>What I am trying to achieve is:</p>\n\n<p>NewsFilterModelList</p>\n\n<pre><code>1.Article1\n2.Page1\n3.Article2\n4.Page2\n5.Article3\n6.Page3\n</code></pre>\n\n<p>I've ended this like below: </p>\n\n<pre><code>foreach (var item in pageResult)\n            {\n                resultList.Add(new NewsFilterModel { ArticleDetail = null, Page = item, Date = item.UpdatedOn.ToDateTime() });\n            }\n\n            foreach (var item in tempArticleList)\n            {\n                resultList.Add(new NewsFilterModel { ArticleDetail = item, Page = null, Date = item.LiveDate.ToDateTime() });\n            }\n\n            return resultList.AsEnumerable();\n</code></pre>\n\n<p>Anyone has better idea, please advice.</p>\n"},{"tags":["linq","entity-framework","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13273325,"title":"linq orderby first item in collection","body":"<p>How do you do OrderBy on a collection within an entity?</p>\n\n<p>For example, this sorts Customers by Name (string)</p>\n\n<pre><code>entities.Customers.OrderBy(c =&gt; c.Name) ...\n</code></pre>\n\n<p>If Customer had an Orders property that was a collection of Order entities and for some reason you wanted to sort Customers on that (lets say by order date), can you do that?</p>\n\n<pre><code>entities.Customers.OrderBy(c =&gt; c.Orders.?)\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13273887,"title":"LINQ query to group records by month within a period","body":"<p>I am looking for some help on adapting the following LINQ query to return all dates within the next 6 months, even those where no records fall within the given month.</p>\n\n<pre><code>var maxDate = DateTime.Now.AddMonths(6);\n\nvar orders = (from ord in db.Items\n\nwhere (ord.Expiry &gt;= DateTime.Now &amp;&amp; ord.Expiry &lt;= maxDate)\n\ngroup ord by new\n    {\n        ord.Expiry.Value.Year,\n        ord.Expiry.Value.Month\n    }\ninto g\nselect new ExpiriesOwnedModel\n    {\n        Month = g.Select(n =&gt; n.Expiry.Value.Month).First(),\n        Quantity = g.Count()\n    }).ToList();\n</code></pre>\n\n<p>I'd really appreciate any assistance or pointers on how best to implement this.</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":78,"score":7,"question_id":13271880,"title":"Partial ungrouping list of duplicate values","body":"<p>I know how to group data using LINQ, and I know how to split it into separate items, but I have no idea how to only partially ungroup it.  </p>\n\n<p>I have a set of data which looks something like this: </p>\n\n<pre><code>var data = new Dictionary&lt;Header, Detail&gt;()\n{\n    { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part1\", \"Part2\" } } }\n};\n</code></pre>\n\n<p>In order to process this correctly, I need every instance of a duplicate part to be a separate entry in the dictionary (although it doesn't matter if it remains a dictionary - <code>IEnumerable&lt;KeyValuePair&lt;Header, Detail&gt;&gt;</code> is perfectly acceptable).  However, I don't want to split up the <code>Parts</code> list entirely - having different parts in the list is fine.</p>\n\n<p>Specifically, I want the end data to look like this:</p>\n\n<pre><code>{\n  { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n  { new Header(), new Detail { Parts = new List&lt;string&gt; { \"Part1\" } } },\n}\n</code></pre>\n\n<p>For a more complex example:</p>\n\n<pre><code>var data = new Dictionary&lt;Header, Detail&gt;()\n{\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part1\", \"Part2\" } } },\n\n    { new Header(2), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\", \"Part2\", \"Part2\", \"Part3\", \"Part3\"} } }\n};\n\nvar desiredOutput = new List&lt;KeyValuePair&lt;Header, Detail&gt;&gt;()\n{\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n    { new Header(1), new Detail { Parts = new List&lt;string&gt; { \"Part1\" } } },\n\n    { new Header(2), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\" } } },\n\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part1\", \"Part2\", \"Part 3\" } } },\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part2\", \"Part3\" } } },\n    { new Header(3), new Detail { Parts = new List&lt;string&gt; { \"Part2\" } } }\n};\n</code></pre>\n\n<p>Any advice? </p>\n"},{"tags":["c#","linq","syntax","forex"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":55,"score":1,"question_id":13250328,"title":"LINQ to object Open High Low Close (OHLC)","body":"<p>I would like to achieve same results from code sample below by using syntax LINQ query to object.\nPlease, help me guys.</p>\n\n<pre><code>public static List&lt;OHLC&gt; OHLC(List&lt;FileRaw&gt; fileRawsList, TimeSpan timeSpan, DateTime beginDate, DateTime endOfLoopDate)\n    {\n\n        List&lt;OHLC&gt; ohlcList = new List&lt;OHLC&gt;();\n\n        for (DateTime i = beginDate; i &lt; endOfLoopDate; )\n        {\n            DateTime iLow = i;\n            DateTime iMax = i.Add(timeSpan);\n            OHLC ohlcRaw = new OHLC()\n                {\n                    Open = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().First(),\n                    High = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Max(),\n                    Low = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Min(),\n                    Close = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Bid).DefaultIfEmpty().Last(),\n                    Time = fileRawsList.Where(p =&gt; p.Time &gt;= iLow).Where(p =&gt; p.Time &lt;= iMax).Select(p =&gt; p.Time).DefaultIfEmpty(iLow).First()\n                };\n\n            i = i.Add(timeSpan);\n            ohlcList.Add(ohlcRaw);\n        }\n        return ohlcList;\n    }\n</code></pre>\n\n<p>it produce</p>\n\n<pre><code>Open: 1.229570, High: 1.233580, Low: 1.221730, Close: 1.224630, Date: 01/08/2012 00:00:02\nOpen: 1.224620, High: 1.240460, Low: 1.213320, Close: 1.217490, Date: 02/08/2012 00:00:03\nOpen: 1.217530, High: 1.239160, Low: 1.217230, Close: 1.238650, Date: 03/08/2012 00:00:02\nOpen: 0,        High: 0,        Low: 0,        Close: 0,        Date: 04/08/2012 00:00:02\nOpen: 1.239720, High: 1.239830, Low: 1.239180, Close: 1.239460, Date: 05/08/2012 17:00:03\n</code></pre>\n"},{"tags":["vb.net","linq","list"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13273997,"title":"List(of String) or Array or ArrayList","body":"<p>Hopefully a simple question to most post experience programmers. </p>\n\n<p>What is the datatype that lets me do this??</p>\n\n<pre><code>Dim lstOfStrings as *IDK*\nDim String1 = \"some value\"\nDim String2 = \"some value\"\nDim String3 = \"some value\"\nDim String4 = \"some value\"\n\n\nlstOfStrings.add(String1, String2, String3, String4)\n</code></pre>\n\n<p>I would call access these in a different function something like this</p>\n\n<pre><code>Dim s1 = lstOfStrings(0)\nDim s2 = lstOfStrings(1) \nDim s3 = lstOfStrings(2) \nDim s4 = lstOfStrings(3)\n</code></pre>\n\n<p>if I use List(of String)\nI am only able to .add one thing to the list, and in my function I want to be able to store several values. I hope there is a simple way to do this.</p>\n\n<pre><code>Private Function getWriteBits() As List(Of String)\n\n\n    Dim temp1 As String\n    Dim temp2 As Boolean\n    Dim temp3 As Boolean\n\n\n    'Pallet Destination Unique\n    Dim temp4 As Boolean\n    Dim temp5 As Boolean\n    Dim temp6 As Boolean\n\n    Dim inputs() As String = {temp1, temp2, temp3, temp4, temp5, temp6}\n\n    Dim lstWriteBits() As List(Of String) = New List(Of String)(inputs)\n\n\n    Return lstWriteBits\nEnd Function\n</code></pre>\n"},{"tags":["c#",".net","linq","extension-methods","ienumerable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":67,"score":0,"question_id":13270063,"title":"Is there any built-in .NET Framework alternative for my extension method?","body":"<p>I got this nice method which I use in many cases.</p>\n\n<pre><code>internal static IEnumerable&lt;TResult&gt; RoundTrip&lt;TSource, TResult&gt;\n (this IEnumerable&lt;TSource&gt; e, Func&lt;TSource, TSource, TResult&gt; currentNextAction)\n{\n    using (IEnumerator&lt;TSource&gt; enumer = e.GetEnumerator())\n    {\n        if (!enumer.MoveNext())\n            yield break;\n\n        bool flag = true;\n        TSource first = enumer.Current;\n\n        do\n        {\n            TSource current = enumer.Current;\n            TSource next = (flag = enumer.MoveNext()) ? enumer.Current : first;\n            yield return currentNextAction(current, next);\n        } while (flag);\n    }\n}\n</code></pre>\n\n<p>I have looked <a href=\"http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx\" rel=\"nofollow\">MSDN</a> for some built-in alternatives, but could not find them. Is there any?</p>\n\n<p>And, is there anything I could improve in this code?</p>\n\n<p><strong>EDIT</strong>: New code for non-enumeratorable method.</p>\n\n<pre><code>internal static IEnumerable&lt;TResult&gt; RoundTrip&lt;TSource, TResult&gt;\n (this IEnumerable&lt;TSource&gt; e, Func&lt;TSource, TSource, TResult&gt; currentNextAction)\n{\n    bool flag = false;\n    TSource first = default(TSource);\n    TSource previous = default(TSource);\n\n    foreach (TSource item in e)\n    {\n        if (!flag)\n        {\n            flag = true;\n            first = previous = item;\n            continue;\n        }\n\n        yield return currentNextAction(item, previous);\n        previous = item;\n    }\n\n    if (flag)\n        yield return currentNextAction(previous, first);\n    else\n        yield break;\n}\n</code></pre>\n\n<p>(I like the first one by the way)</p>\n"},{"tags":["vb.net","linq","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13272721,"title":"LinQ - Left Join Two DataTables","body":"<p>I am wondering if anyone can help me.\nI am new to LINQ and still trying to understand how it fits together.</p>\n\n<p>I have a simple left join query in SQL, returning all transactions that are on table 1 that do not exist in table 2.  Both tables are identical in structure.</p>\n\n<pre><code>SELECT Table1.*\nFROM Table1 LEFT JOIN Table2 ON Table1.DealReference = Table2.DealReference\nWHERE (((Table2.DealReference) Is Null));\n</code></pre>\n\n<p>Can someone please guide me, how to achieve the same in LinQ.</p>\n\n<p>I am using the following DataTables:</p>\n\n<pre><code>    Dim currentDataTable = _DataTable1.AsEnumerable\n    Dim previousDataTable = _DataTable2.AsEnumerable\n</code></pre>\n\n<p>I am looking to have the results output back into a datatable.</p>\n\n<p>Thanks</p>\n\n<p>BM</p>\n"},{"tags":["visual-studio-2010","linq","debugging","linq-to-objects"],"answer_count":3,"favorite_count":2,"up_vote_count":10,"down_vote_count":1,"view_count":4537,"score":9,"question_id":2458563,"title":"Need to debug LINQ simple queries in Visual Studio 2010","body":"<p>I often get in a position when I need to know why my LINQ doesnt work as intended...\nI use object collections and extensions. </p>\n\n<p>I dont want spend more than couple of minutes on it. LINQ supposed to make developer's life easier not harder.</p>\n\n<p>I hoped VS 2010 will have it fixed but I now use RC and it still doesnt let me type LINQ and check what is going on... Says as before \"Expression cannot contain lambda expressions\"...</p>\n\n<p>Is there some add-on for Visual Studio so I can <strong>quickly</strong> and effectively run ad-hoc queries and find out what is going on and where I am wrong?</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":111,"score":3,"question_id":13270662,"title":"How to make AND operator in C# linq?","body":"<pre><code>IEnumerable&lt;WireUsrTgInfo&gt; lstWireData = \n    (from var in lstWireUsrTgInfo\n     where var.bWireData == true &amp;&amp; var.bWireData == false --&gt; This is not working\n     select var).AsEnumerable&lt;WireUsrTgInfo&gt;();\n</code></pre>\n\n<p>How to do this ... </p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":65,"score":1,"question_id":13270938,"title":"how to write this LINQ query of 3 tables?","body":"<ul>\n<li><p>Table1 CAR (CARID, CarModelID ,CARuniqueinfo1, CARUniqueinfo2): contians all cars have been entered to the warehouse.</p></li>\n<li><p>Table2 CarModel (CarModelID ,Modelinfo1 ,Modelinfo2 ) </p></li>\n<li><p>Table3 Sale (SaleID, CarID, clientID, EmpID) </p></li>\n</ul>\n\n<p>What is the Linq Query that returns :</p>\n\n<p>number of sold cars only for ModelID=101</p>\n\n<pre><code>DataClassesDataContext db = new DataClassesDataContext(); \n</code></pre>\n"},{"tags":["vb.net","linq","linq-expressions"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13251556,"title":"How do I determine the type of a class in a function definition?","body":"<p>I'm not really sure how to ask this question, but basically I want to know how to specify a class type generically such that I can type and paste code around.</p>\n\n<p>For example I have the following code:</p>\n\n<pre><code>Public Class CustInfo\n    Implements INotifyPropertyChanged\n\n    Public Event PropertyChanged(sender As Object, e As System.ComponentModel.PropertyChangedEventArgs) Implements System.ComponentModel.INotifyPropertyChanged.PropertyChanged\n\n    Protected Sub NotifyPropertyChanged(ByVal Name As String)\n        RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(Name))\n    End Sub\n\n    Protected Sub NotifyPropertyChanged()\n        Dim myStackFrame As New StackFrame(1)\n        Dim myChangingPropertyName As String = myStackFrame.GetMethod.Name.Split(\"_\")(1)\n        NotifyPropertyChanged(myChangingPropertyName)\n    End Sub\n\n    Protected Sub NotifyPropertyChanged(Of TResult)(propertyExpr As Expression(Of Func(Of CustInfo, TResult)))\n        NotifyPropertyChanged(Me.GetPropertySymbol(propertyExpr))\n    End Sub\n</code></pre>\n\n<p>The idea is to have the last <code>Sub</code> be generic, that is to say, not specifically have to specify CustInfo in it's definition. This way I can literally copy this code to any other class and it will work unmodified.</p>\n\n<p>I've tried creating a property that returns the type of the class and using that, which predictably failed. I tried using TypeOf, Me, even 'this' on a long shot and nothing worked. It seems there has to be a way for the compiler to know this based on this error message which I get when I change the last sub to:</p>\n\n<pre><code>Protected Sub NotifyPropertyChanged(Of TResult)(propertyExpr As Expression(Of Func(Of TResult)))\n    NotifyPropertyChanged(Me.GetPropertySymbol(propertyExpr))\nEnd Sub\n</code></pre>\n\n<p><code>Data type(s) of the type parameter(s) in extension method 'Public Function GetPropertySymbol(Of TResult)(expr As System.Linq.Expressions.Expression(Of System.Func(Of CustInfo, TResult))) As String' defined in 'CustClasses.Extensions' cannot be inferred from these arguments. Specifying the data type(s) explicitly might correct this error.\n</code></p>\n\n<p>The extension method being referred to is:</p>\n\n<pre><code>&lt;Extension()&gt;\nPublic Function GetPropertySymbol(Of T, TResult)(obj As T, expr As Expression(Of Func(Of T, TResult))) As String\n    Return DirectCast(expr.Body, MemberExpression).Member.Name\nEnd Function\n</code></pre>\n\n<p>So, as you can see the compiler correctly inferred what is going on, but still couldn't work with it. The only type that seems unknown is TResult, but that type should be easily inferred based on the other information in the extension method that is known.</p>\n\n<p>It may be impossible to generically specify a class type in the procedure definition, in which case I'll modify the code every time I use it, but I'd rather not and learn something new in the process.</p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1190,"score":6,"question_id":7809745,"title":"Linq code to select one item","body":"<p>I find myself writing a lot of code like this to select one item that matches </p>\n\n<pre><code>var item = (from x in Items where x.Id == 123 select x).First();\n</code></pre>\n\n<p>Is there a cleaner way of doing it or is this as concise as I'm going to get?</p>\n\n<p>EDIT: Should have said \"Cleaner way using linq syntax\". I was already aware of the lambda syntax and it's starting to look like this is actually the only way. I did get some useful info though, so thanks to everyone who replied.</p>\n"},{"tags":["c#","linq","entity-framework","c#-4.0","linq-to-sql"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13269559,"title":"How to Group By multiple records according some criteria","body":"<p>please consider this scenario:</p>\n\n<p>I have data like this :</p>\n\n<pre><code> Id          Group            Value\n -----------------------------------\n 1            1                100\n 2            1                120\n 3            1                100\n 4            2                90\n 5            2                105\n 6            3                300\n 7            4                123\n 8            4                110\n 9            5                100\n 10           5                110\n</code></pre>\n\n<p>I want to do <code>GroupBy</code> on this data as <code>1,2,3</code> place in one group and <code>4,5</code> place in another group. How I can do this with <code>LINQ</code>?</p>\n\n<p>thanks</p>\n\n<hr>\n\n<p><strong>Edit 1)</strong></p>\n\n<p>I want to place <code>1,2,3</code> in one group and <code>4,5</code> in another group and perform <code>Count</code> aggregation on them and I get <strong>6</strong> for first group and <strong>4</strong> for secnd group</p>\n"},{"tags":["linq","like","entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":13270512,"title":"use \"Like\" Expression, LINQ to Entitie","body":"<p>I spent long time trying to fix this but I'm not getting anywhere, so i help someone helps me.\nI have a search form where I wish to use the Like % operator in the textbox. It should be simple, but since it's Linq2Entities I had some problems to fix it. </p>\n\n<p>Here is a snippet of my code:</p>\n\n<pre><code> var data = mg.DatabaseTable.Where(m =&gt; m.UserName.StartsWith(TextBoxUserID.Text) &amp;&amp;\n                                                        **m.Content.Like(%TextBoxBarcode.Text&amp;)** &amp;&amp;\n                                                        m.Action.StartsWith(DropDownListStatus.Text) &amp;&amp;\n                                                        m.Site.Contains(TextBoxSite.Text));\n</code></pre>\n\n<p>I would like it to be possible to use \"%%\" in the m.Content(textbox) or however it's made.</p>\n\n<p>I'am aware the use of StartsWith, EndWith and Contains. I would like to make it possible to choose how to query the search by using \"like %\"</p>\n\n<p>Regards</p>\n"},{"tags":["c#","asp.net","linq","orm","informix"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":345,"score":2,"question_id":9043819,"title":"Confusion about selecting the suitable ORM?","body":"<p>I use <code>asp.net with informix</code> database.</p>\n\n<p>I use a set of written classes to handle the connections, the CRUD operations, transactions, etc....</p>\n\n<p>Now, I feel these classes are not the best choice, less performance,take a lot of time and have many drawbacks.</p>\n\n<hr>\n\n<p>I want to use an <code>ORM</code>, but I don't know how to choose the one which suits my web applications<code>(asp.net,Informix)</code>.</p>\n\n<p>Please help to select the convenient <code>ORM</code>.</p>\n\n<p>I'm confused among nhibernate , Entity framework , LinQ To SQl , and the open Access (Telerik Component)</p>\n\n<p>Note : i will use Visual studio 2012 so i want the recent comparison. </p>\n"},{"tags":["c#","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270546,"title":"How to query a XML with namespaces in the name?","body":"<p>I'm working with a XML like this:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;ListOfLore&gt;\n      &lt;q1:Lore xmlns:q1=\"http://www.rold.com/Data.xsd\"&gt;                \n        &lt;q1:LoreNumber&gt;15642&lt;/q1:LoreNumber&gt;        \n      &lt;/q1:Lore&gt;\n      &lt;q1:Lore xmlns:q1=\"http://www.rold.com/Data.xsd\"&gt;\n        &lt;q1:LoreNumber&gt;15644&lt;/q1:LoreNumber&gt;        \n      &lt;/q1:Lore&gt;\n&lt;/ListOfLore&gt;\n</code></pre>\n\n<p>I'm doing this and I'm getting nothing</p>\n\n<pre><code>var lores = (from ListOfLore in pjs.Descendants(\"ListOfLore\")\n                              from Lore in ListOfLore.Descendants()\n                              where Lore.Name.LocalName == (\"Lore\") \n                              select Lore);\n</code></pre>\n\n<p>I want to get all of <code>Lore</code> items from the <code>ListOfLore</code></p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":88,"score":0,"question_id":12941028,"title":"Group by multiple values and break down to weekly periods","body":"<p>I'm still learning LINQ and have a task where I need to group Booking objects by four properties and then by weekly intervals depending on the input timerange. </p>\n\n<pre><code>public class Booking\n{\n    public string Group { get; set; }\n    public BookingType Type { get; set; }\n    public BookingStatus Status { get; set; }\n    public decimal Price { get; set; }\n    public bool Notification { get; set; }\n    public DateTime Date { get; set; }\n}\n</code></pre>\n\n<p>Let's say we have the following Bookings:</p>\n\n<pre><code>        IList&lt;Booking&gt; Bookings = new List&lt;Booking&gt;\n        {\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 150, Date = new DateTime(2012,06,01)},\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 100, Date = new DateTime(2012,06,02)},\n            new Booking{Group = \"Group1\", Type = BookingType.Online, Status = BookingStatus.New, Price = 200, Date = new DateTime(2012,06,03)},\n\n            new Booking{Group = \"Group2\", Type = BookingType.Phone, Status = BookingStatus.Accepted, Price = 80, Date = new DateTime(2012,06,10)},\n            new Booking{Group = \"Group2\", Type = BookingType.Phone, Status = BookingStatus.Accepted, Price = 110, Date = new DateTime(2012,06,12)},\n\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Accepted, Price = 225, Date = new DateTime(2012,06,20)},\n\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Invoiced, Price = 300, Date = new DateTime(2012,06,21)},\n            new Booking{Group = \"Group3\", Type = BookingType.Store, Status = BookingStatus.Invoiced, Price = 140, Date = new DateTime(2012,06,22)},\n        };\n</code></pre>\n\n<p>That would result in the following lines on the final printout:</p>\n\n<pre><code>                                        Week 22     Week 23     Week 24     Week 25     Week 26\n                                        May28-Jun3  Jun4-10     Jun11-17    Jun18-24    Jun25-Jul1\n            Group   Type    Status      Cnt. Price  Cnt. Price  Cnt. Price  Cnt. Price  Cnt. Price\n            ----------------------------------------------------------------------------------------------\n            Group1  Online  New         3   450     0   0       0   0       0   0       0   0\n            Group2  Phone   Accepted    0   0       1   80      1   110     0   0       0   0\n            Group3  Store   Accepted    0   0       0   0       0   0       1   225     0   0       \n            Group3  Store   Invoiced    0   0       0   0       0   0       2   440     0   0           \n</code></pre>\n\n<p>I have created 2 additional classes to represent a line with the possibility to include any number of weeks:</p>\n\n<pre><code> public class GroupedLine\n{\n    public string Group { get; set; }\n    public BookingType Type { get; set; }\n    public BookingStatus Status { get; set; }\n    public List&lt;WeeklyStat&gt; WeeklyStats { get; set; } \n}\n\npublic class WeeklyStat\n{\n    public DateTime WeekStart { get; set; }\n    public decimal Sum { get; set; }\n    public int Count { get; set; }\n}\n</code></pre>\n\n<p>If I have the following time period:</p>\n\n<pre><code>        var DateFrom = new DateTime(2012, 05, 28);\n        var DateTo = new DateTime(2012, 7, 01);\n</code></pre>\n\n<p>Firstly, I need to identify what weeks are necessary in the statistics: in this case week 22-26. </p>\n\n<p>For that I have the following code: </p>\n\n<pre><code>        var DateFrom = new DateTime(2012, 05, 28);\n        var DateTo = new DateTime(2012, 7, 01);\n\n        var firstWeek = GetFirstDateOfWeek(DateFrom, DayOfWeek.Monday);\n        IList&lt;DateTime&gt; weeks = new List&lt;DateTime&gt; { firstWeek };\n\n        while(weeks.OrderByDescending(w =&gt; w).FirstOrDefault().AddDays(7) &lt;= DateTo)\n        {\n            weeks.Add(weeks.OrderByDescending(w =&gt; w).FirstOrDefault().AddDays(7));\n        }\n</code></pre>\n\n<p>And now, I'd need some LINQ magic to do the grouping both by the 4 properties and the aggregation (count of bookings and sum of prices) for the weeks.</p>\n\n<p>I can attach code sample of the LINQ I got so far tomorrow, as I don't have access to it now.\nSorry for the long post, hope it's clear what I mean.</p>\n\n<p>Edit: 2012-11-07\nI have to modify the question a bit, so that the grouped weeks only include those weeks, that actually have data. \nUpdated example output:</p>\n\n<pre><code>                                        May28-Jun3  Jun4-10     Jun18-24    \n            Group   Type    Status      Cnt. Price  Cnt. Price  Cnt. Price  \n            ---------------------------------------------------------------\n            Group1  Online  New         3   450     0   0       0   0       \n            Group2  Phone   Accepted    0   0       1   80      0   0       \n            Group3  Store   Accepted    0   0       0   0       1   225             \n            Group3  Store   Invoiced    0   0       0   0       2   440         \n</code></pre>\n\n<p>In this case there were no Bookings in period Jun 11-17 and Jun25-Jul1 so they are omitted from the results.</p>\n"},{"tags":["c#","linq","ienumerable"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13269183,"title":"Search between Two IEnumerable - LINQ","body":"<p>Hi can you guys help me with this, I have try several things.\nI need to search between two IEnumerables, here is the code.</p>\n\n<pre><code>IEnumerable&lt;Project&gt; Projects = new[] { new Project {id = \"1\", lan = \"test1\"},  new Project {id = \"2\", lan = \"test1\"}}\n\nIEnumerable&lt;string&gt; lan = new [] { \"test1\", \"test2\"};\nIEnumerable&lt;string&gt; indexFiltered = ?;\n</code></pre>\n\n<p>I need to do a linq query that return the Project.id thats have any Project.lan in lan.</p>\n\n<p>Any idea?</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13257709,"title":"Comparing collections and counting duplicates using LINQ and C#","body":"<p>I have two similar objects in my system.</p>\n\n<ul>\n<li>LeadImportViewModel</li>\n<li>LeadGridViewModel</li>\n</ul>\n\n<p>I need to populate the <code>QtyDuplicates</code> field in my <code>LeadImportViewModel</code> collection, which should show the quantity of corresponding records in the LeadGridViewModel collection where the  <code>CompanyNameStripped</code> value is identical.</p>\n\n<pre><code>public class LeadImportViewModel\n{\n    public int Id { get; set; }\n    public string CompanyName { get; set; }\n    public string CompanyNameStripped { get; set; }\n    public int QtyDuplicates{ get; set; }\n}\n\npublic class LeadGridViewModel\n{\n    public int LeadId { get; set; }\n    public string CompanyName { get; set; }\n    public string CompanyNameStripped { get; set; }\n}\n</code></pre>\n\n<p>The collection is created as follows:</p>\n\n<pre><code>var coll = (from t1 in db.Leads_Staging\n                    select new LeadImportViewModel\n                        {\n                            Id = t1.Id,\n                            CompanyName = t1.CompanyName,\n                            CompanyNameStripped = t1.CompanyNameStripped,\n\n                        });\n</code></pre>\n\n<p>What would be the most efficient way to do this using LINQ/C#?</p>\n"},{"tags":["c#","asp.net","linq","linq-to-sql"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13266681,"title":"Is it possible to return IQueryable<SomeClass> to a IQueryable<T> method?","body":"<p>In QueryableEntities method below,\n<code>IEnumerable&lt;Competition&gt;.AsQueryable()</code> will return <code>IQueryable&lt;Competition&gt;</code> which am not able to return because it is expecting <code>IQueryable&lt;T&gt;</code></p>\n\n<p>I can write only one method to return <code>IQueryable&lt;Competition&gt;</code> and <code>IQueryable&lt;Submission&gt;</code> </p>\n\n<p>If anyone knows how to do it please let me know, thanks</p>\n\n<pre><code>public partial class WinBoutsDataContext&lt;T&gt; : System.Data.Linq.DataContext where T : class\n{\n    public IQueryable&lt;T&gt; QueryableEntities\n    {\n        get\n        {\n            if (typeof(T).Equals(typeof(Model.Competition)))\n            {\n                return this.ConvertToCompetitionList(\n                      this.GetTable&lt;Storage.Competition&gt;()).AsQueryable();\n            }\n             else if(typeof(T).Equals(typeof(Model.Submission)))\n            {\n                return this.ConvertToSubmissionList(\n                       this.GetTable&lt;Storage.CompetitionEntry&gt;()).AsQueryable();\n            }\n        }\n    }\n\n    public DataAccess.Model.Competition ConvertToCompetition(DataAccess.Storage.Competition comp)\n    {\n\n        DataAccess.Model.Competition modelComp = new DataAccess.Model.Competition \n        { \n            CompetitionID = comp.CompetitionID, \n            Active = comp.Active, \n            CompetitionStatusID = \n            comp.CompetitionStatusID, \n            Duration = comp.Duration, \n            EndDate = comp.EndDate, \n            Entrants = comp.Entrants, \n            Featured = comp.Featured, \n            Image = comp.Image, \n            IsOvertime = comp.IsOvertime, \n            MaxEntrants = comp.MaxEntrants, \n            Notes = comp.Notes, \n            OvertimeDuration = comp.OvertimeDuration, \n            OvertimeEnd = comp.OvertimeEnd, \n            OvertimeStart = comp.OvertimeStart, \n            ParentCompetitionID = comp.ParentCompetitionID, \n            Prize = comp.Prize, StartDate = comp.StartDate, \n            SuggestedBy = comp.SuggestedBy, \n            Summary = comp.Summary, \n            Title = comp.Title \n        };\n\n        return modelComp;\n    }\n\n    public IEnumerable&lt;DataAccess.Model.Competition&gt; ConvertToCompetitionList(IEnumerable&lt;DataAccess.Storage.Competition&gt; compList)\n    {\n        List&lt;DataAccess.Model.Competition&gt; compModelList = new List&lt;DataAccess.Model.Competition&gt;();\n\n        foreach (DataAccess.Storage.Competition comp in compList)\n        {\n            compModelList.Add(ConvertToCompetition(comp));\n        }\n\n        return compModelList;\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13267087,"title":"How to join and select table data in mvc C#?","body":"<p>In my project I have services.\nSo in side the service I want to join tables and want to select more than one table data.</p>\n\n<p>So I write this cording.</p>\n\n<pre><code>var query1 = from opv in _opvRepository.Table\n                         join o in _orderRepository.Table on opv.OrderId equals o.Id\n                         join g in _graduandRepository.Table on opv.graduand_id equals g.graduand_id\n                         join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id\n                         join p in _productRepository.Table on pv.ProductId equals p.Id\n                         where (opv.ceremony_id == ceremony_id) &amp;&amp;\n                         (!o.Deleted) &amp;&amp; (opv.IsHireItem == true)  &amp;&amp;\n                         (!p.Deleted) &amp;&amp;\n                         (!pv.Deleted) &amp;&amp; (opv.ceremony_id == ceremony_id)\n                         select opv,g;\n</code></pre>\n\n<p>But there is error and I can't select <code>opv and g.</code> if I write   <code>select opv;</code>it is ok. but i want to select both table.\nHow can i do it??</p>\n"},{"tags":["c#","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13266580,"title":"Complex Linq c# query","body":"<p>I tried this in LinqPad</p>\n\n<p>I have the following data and linq query which should return only 1 record and 2 images but returns 2 records and 4 images. </p>\n\n<p>I know i have something wrong but don't know what. I am looking for the users details + car details + images fro user: 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 </p>\n\n<p>It has something to do with the bids as when I delete one of he bids for user (0b3c2ba5-1538-4557-a6c0-7de701fd83e7 ) i then get 1 record and 2 images</p>\n\n<p><strong>TABLES<br>\n------</strong> </p>\n\n<h2>TABLE bids</h2>\n\n<pre><code>id      cardid  bidamount   dateplaced          usedid  \n\n43  83  625 2012-11-05 16:12:51.600 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n44  86  575 2012-11-05 16:15:02.257 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n45  83  650 2012-11-05 16:15:07.283 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n46  86  600 2012-11-05 17:45:04.140 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n47  86  625 2012-11-05 17:45:08.867 a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc  \n49  83  750 2012-11-07 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7  \n52  83  850 2012-11-08 13:40:37.590 0b3c2ba5-1538-4557-a6c0-7de701fd83e7 \n</code></pre>\n\n<h2>TABLE userdetails</h2>\n\n<pre><code>userid                                  city    state  \n0b3c2ba5-1538-4557-a6c0-7de701fd83e7    Sydney  NSW  \n</code></pre>\n\n<h2>TABLE cars</h2>\n\n<pre><code>id  name     descr   listingOption priceStarting priceReserve  \n83  Valiant  Old Car     2              1000         1500  \n86  Volvo    Safe Car    3              3000         4500 \n</code></pre>\n\n<h2>TABLE auction_images</h2>\n\n<pre><code>id         image                                              belongs_to  \n71  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  83  \n72  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   83  \n75  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/alpaca.JPG  86  \n76  images/a5d383e0-0c2c-44cf-9da1-0ce364b1dbdc/a_bag.jpg   86  \n</code></pre>\n\n<p><strong>QUERY\n-----</strong></p>\n\n<pre><code> var query = (from c in cars\n                         from ud in users_details\n                         from bd in bids\n                         orderby c.listingOption descending\n                         where a.userID == ud.userid\n                        &amp;&amp; c.id == bd.carID\n                        &amp;&amp; c.enabled == true\n                        &amp;&amp; bd.userID == new Guid(\"0b3c2ba5-1538-4557-a6c0-7de701fd83e7\")\n                         let images = from ai in auction_images\n                                      where ai.belongs_to == c.id\n                                      select ai\n\n                         let bid = (from b in bids\n                                    orderby b.id descending\n                                    where b.carID == c.id\n                                    select b.bidamount).FirstOrDefault()\n                         select\n                         new\n                         {\n                             images,\n                             bidamount = (bid != null ? bid : 0),\n                             ud.city,\n                             ud.state,\n                             c.name,\n                             c.descr,\n                             c.id,\n                             c.listingOption,\n                             c.priceStarting,\n                             c.priceReserve,\n                             bd.userID\n                         }\n                         );\n\nquery.Distinct().Dump();\n</code></pre>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":43,"score":0,"question_id":13266841,"title":"C# LINQ to XML: number of elements, that have two same attributes?","body":"<p>I have something like this:</p>\n\n<pre><code>&lt;Books&gt;\n    &lt;Book&gt;\n        &lt;Number&gt;\n        &lt;Title&gt;\n        &lt;Author&gt;\n        &lt;NumberOfCopies&gt;\n    &lt;/Book&gt;\n&lt;/Books&gt;\n</code></pre>\n\n<p>The <code>NumberOfCopies</code> element means how many same copies the library has of the same book. (Same books=same author, same title). The <code>Number</code> element is different for each book, it is for storing them in the library.</p>\n\n<p>When I add a new book, I would like to find out how many copies the library has.(int number) How to do this?</p>\n\n<pre><code>XDocument doc = XDocument.Load(\"books.xml\");\nvar q = from x in doc.Descendants(\"Books\")\n        where x.Element(\"Author\").Value == newBook.Author\n              &amp;&amp; x.Element(\"Title\").Value == newBook.Title\n        select x;\n\nint number = (int)q;\n</code></pre>\n\n<p>This doesn't work. What am I doing wrong?</p>\n"},{"tags":["sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":13266346,"title":"unable to convert SQL query to Linq","body":"<p>Please help me try and convert this join query. I am trying to convert the following SQL query into a LINQ query, but can not get it working. Can any one help me solve this?  </p>\n\n<pre><code>SELECT T1.BoCode, case when T2.qty is null then 0 else T2.qty end \nFROM  \n    (SELECT bocode from TABLE1) as T1\nleft join\n    (SELECT cBoCode, sum(qty) as qty    FROM TABLE2 where ncampnurn in \n        (select nurn FROM TABLE3 INNER JOIN TABLE4 ON TABLE3.CampaignCode = \n         TABLE4.CampaignCode  \n         where TABLE3.Month = 'Sep12' and TABLE4.ReportGroup = 'testgroup' )\n    GROUP BY cBoCode) as T2 \nON T1.BoCode = T2.cBoCode\norder by T1.BoCode\n</code></pre>\n\n<p>I have only been able to do the middle bit and then get stuck on whether I need to use <code>Contains</code> or <code>Any</code>.</p>\n\n<pre><code>from t3 in table3\njoin t4 in table4 on t3.CampaignCode equals t4.CampaignCode\nwhere t3.Month == \"Sep12\" &amp;&amp; t4.ReportGroup == \"testgroup\"\nselect t3.Nurn \n</code></pre>\n"},{"tags":["c#","linq","odata","infragistics","ignite-ui"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":503,"score":2,"question_id":8711709,"title":"Mapping $filter from oData parameter to linq Where","body":"<p>I've got (what I think is a odata format) url like this:</p>\n\n<pre><code>http://localhost:2282/SSE.Web/History.cshtml?GetData=true&amp;itemId=AKE-00129&amp;pid=1&amp;%24filter=indexof(ItemType%2C%27Attri%27)+ge+0&amp;%24skip=0&amp;%24top=50&amp;%24inlinecount=allpages&amp;_=1325589443808\n</code></pre>\n\n<p>what is interesting here is the $filter parameter. It has the format \"indexof(ItemType,'Attri') ge 0\"</p>\n\n<p>The source is an grid (iggrid from infragistics) that is filtering on the ItemType column with text 'Attri'</p>\n\n<p>My question is: Mapping the top and skip parameters was trivial, but how to do the filter. Do I need to parse it and build my own linq, or are there some other ways?</p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>        var skip = int.Parse(Request[\"$Skip\"]);\n    var top = int.Parse(Request[\"$top\"]);\n    var filter = Request([\"$filter\"]);\n\n    var db = Database.Open(\"SSEConnectionString\");\n\n    var entries = db.Query(\"select * from eHistory order by timestamp desc\")\n    Json.Write(new { results = entries.Where(????).Skip(skip).Take(top), totalRecCount = entries.Count() }, Response.Output);\n</code></pre>\n\n<p>Thanks for any help!</p>\n\n<p>Larsi</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13265209,"title":"Executing SQL Function Using Linq","body":"<p>I have created a function in MSSQL 2005 and I want to run this function using linq. My function has 2 parameters. The definition is seen below:</p>\n\n<pre><code>USE [MobileGateway]\nGO\n/****** Object:  UserDefinedFunction [dbo].[Fn_GetNoLocationAddress]    Script Date: 11/07/2012 08:27:58 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nALTER FUNCTION [dbo].[Fn_GetNoLocationAddress] \n(   \n    -- Add the parameters for the function here\n    @Site nvarchar(255),\n    @ReceivedDate int\n)\nRETURNS @noLocationAddress TABLE (\n\nRequestID int NOT NULL,\nBarcode varchar(50) NOT NULL,\nAdrID int NOT NULL,\nName varchar(50) NOT NULL,\nStreet varchar(50) NOT NULL,\nHouseNo varchar(4) NOT NULL,\nPostal varchar(8) NOT NULL,\nCity varchar(50) NOT NULL,\nCountry varchar(50) NOT NULL,\nLatitude varchar(50) NOT NULL,\nLongitude varchar(50) NOT NULL,\nReveivedDate datetime NOT NULL\n)\nAS \nBEGIN\n    -- Add the SELECT statement with parameter references here\nINSERT INTO @noLocationAddress \nSELECT     TOP (100) PERCENT Request1.RequestID, TrackIT.dbo.Sending.Barcode, TrackIT.dbo.Address_View.AdrID, TrackIT.dbo.Address_View.Name, \n                      TrackIT.dbo.Address_View.Street, TrackIT.dbo.Address_View.HouseNo, TrackIT.dbo.Address_View.Postal, TrackIT.dbo.Address_View.City, \n                      TrackIT.dbo.Address_View.Country, Request1.Latitude, Request1.Longitude, Request1.ReceivedDate\nFROM         (SELECT DISTINCT RequestID, LTRIM([Content]) AS Barcode, Latitude, Longitude, ReceivedDate\n                       FROM          dbo.RequestWithLocation\n                       WHERE      (Site LIKE @Site) AND ([Content] &lt;&gt; '') AND (AddressID = '0') AND (ReceivedDate &gt; DATEADD(day, -@ReceivedDate, GETDATE()))) AS Request1 INNER JOIN\n                      TrackIT.dbo.Sending ON Request1.Barcode = TrackIT.dbo.Sending.Barcode INNER JOIN\n                      TrackIT.dbo.Address_View ON TrackIT.dbo.Sending.DeliveryAdrID = TrackIT.dbo.Address_View.AdrID\n\nORDER BY TrackIT.dbo.Address_View.AdrID\n\nRETURN\n\nEND\n</code></pre>\n\n<p>As you can see I have 2 parameters and I'm returning a table with the information. But I need to use linq for executing the this function.\nCan anyone help? thanks</p>\n"},{"tags":["c#","asp.net","linq","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13261444,"title":"Appending LINQ to exist datasource/gridview in C#","body":"<p>I have the following in my .aspx page:</p>\n\n<pre><code>&lt;asp:GridView ID=\"Table1\" runat=\"server\" AutoGenerateColumns=\"False\"    BorderColor=\"Black\" OnRowCreated=\"Table1_RowCreated\" OnRowDataBound=\"Table1_RowDataBound\" CellPadding=\"3\" CellSpacing=\"0\" DataSourceID=\"Table1DataSrc\" DataKeyNames=\"Field1\"&gt;\n&lt;Columns&gt;\n&lt;asp:BoundField DataField=\"Field1\" HeaderText=\"Field1\" SortExpression=\"Field1\"&gt;\n     &lt;ItemStyle HorizontalAlign=\"Left\" Font-Size=\"8\" Wrap=\"false\" /&gt;\n     &lt;HeaderStyle CssClass=\"header\" Font-Size=\"8\" /&gt;\n &lt;/asp:BoundField&gt;\n &lt;/Columns&gt;\n &lt;/asp:GridView&gt;\n</code></pre>\n\n<p>Where the gridview has a DataSource that loads a few fields. In my C# code behind, I have the following function which runs a LINQ query to process a stored procedure (on a different server than my other datasource) </p>\n\n<pre><code>    private void RenderTables()\n    {\n        SqlDataAdapter adapter = new SqlDataAdapter();\n        DataTable dt = new DataTable();\n\n        using (SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[\"MyConnectionString\"].ConnectionString))\n        {\n            conn.Open();\n            SqlCommand cmd = new SqlCommand(\"sp_special\", conn);\n            cmd.CommandType = System.Data.CommandType.StoredProcedure;\n            cmd.Parameters.AddWithValue(\"@AmIY\", \"Y\");\n            adapter.SelectCommand = cmd;\n            adapter.Fill(dt);\n            adapter.Dispose();\n            conn.Close();\n        }\n        var enumvar = dt.AsEnumerable();\n        var query = from x in enumvar\n                    orderby x.Field&lt;string&gt;(3)\n                    select new \n                    { \n                        Field3 = x.Field&lt;string&gt;(3),\n                        Field4 = x.Field&lt;int&gt;(4),\n                    };\n        //I do some data manipulation using LINQ, but omitted here\n        //do something with query.....\n    }\n</code></pre>\n\n<p>How would I add new columns Field3 and Field4 to my Gridview and bind these new records? I do not want to store anything in temp tables on either servers</p>\n"},{"tags":["c#","sql-server","linq","linq-to-sql","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":52,"score":-2,"question_id":13262409,"title":"Why not get the desired output from stored procedure","body":"<p>To fulfill one of my requirements I need to pass a SQL query as a parameter to a stored procedure.</p>\n\n<p>My stored procedure syntax is:</p>\n\n<pre><code>create PROCEDURE spSelect \n    @Query VARCHAR(500)\nAS \n    EXEC( @Query)  \n    return  \n</code></pre>\n\n<p>To execute that stored procedure, I use this C# code:</p>\n\n<pre><code>DataContex db=new DataContex();\n    String sSQL = \" SELECT OrderID,ShipName FROM dbo.Orders\";\n    var result = db.spSelect(sSQL);\n</code></pre>\n\n<p>After execution, the <code>result</code> is <code>0</code>.</p>\n\n<p>Need help to understand what happen, why not I get desired output</p>\n\n<p>If have any query please ask, thanks in advance</p>\n"},{"tags":["c#","asp.net",".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":11502803,"title":"Gridview not showing records?","body":"<p>I just attached linq data to gridview it is not showing row ?<br></p>\n\n<blockquote>\n<pre><code>    DataDataContext db = new DataDataContext();\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n            BindData();\n    }\n\n    private void BindData()\n    {\n\n        var source = from n in db.Names\n                     select n;\n\n        gridSample.DataSource = source.ToList&lt;Name&gt;();\n        gridSample.DataBind();'\n    }\n\n\n\n\n    &lt;asp:UpdatePanel ID=\"panelGrid\" runat=\"server\"&gt;\n                        &lt;ContentTemplate&gt;\n                            &lt;asp:GridView runat=\"server\" ID=\"gridSample\" AutoGenerateColumns=\"false\"&gt;\n                                &lt;Columns&gt;\n                                    &lt;asp:TemplateField HeaderText=\"First Name\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtFirstName\" runat=\"server\" Text='&lt;%Bind(\"FirstName\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblFirstName\" Text='&lt;%Eval(\"FirstName\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                                    &lt;asp:TemplateField HeaderText=\"Last Name\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtLastName\" runat=\"server\" Text='&lt;%Bind(\"LastName\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblLastName\" Text='&lt;%Eval(\"LastName\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                                    &lt;asp:TemplateField HeaderText=\"Date of Birth\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtDOB\" runat=\"server\" Text='&lt;%Bind(\"DOB\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblDOB\" Text='&lt;%Eval(\"DOB\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                             &lt;/Columns&gt;\n                   &lt;/asp:GridView&gt;\n           &lt;/ContentTemplate&gt;\n       &lt;/asp:UpdatePanel&gt;\n</code></pre>\n</blockquote>\n"},{"tags":["c#","linq","sorting","paging"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13263216,"title":"Entity IQueryable with page, search and sort","body":"<p>I'm sure this has been answered before, but can't seem to find it.</p>\n\n<p>I'm looking for a simple download (or tutorial) for building an IQueryable that can be sorted, paged and searched.</p>\n\n<p>e.g.</p>\n\n<pre><code>IQueryable&lt;T&gt; myThings , params[] searchKeyValuePairs, params[] orderKeyValuePairs, int pageSize, int pageNumber\n</code></pre>\n\n<p>Or something similar.  Guessing it will be using Dynamic Linq.</p>\n\n<p>My requirement is for a number of MVC3 views for broadly similar data.  BA specified about 20 views of each of 10 data types...but MOST of these views are simply \"All Today\" and \"Sorted by Cost\" type views.</p>\n\n<p>Data is from SQL or Oracle through EF4.</p>\n"},{"tags":["sql","linq","predicatebuilder"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":35,"score":5,"question_id":13261700,"title":"need help in using predicate builder","body":"<p>I need to know about using predicatebuilder. On almost every example of how to use it, they show the code as follows</p>\n\n<pre><code>    var predicate = PredicateBuilder.True&lt;employee&gt;();\n\n    if(!string.IsNullOrEmpty(txtAddress.Text))\n        predicate = predicate.And(e1 =&gt; e1.Address.Contains(txtAddress.Text));\n    if (!string.IsNullOrEmpty(txtEmpId.Text))\n        predicate = predicate.And(e1 =&gt; e1.Id == Convert.ToInt32(txtEmpId.Text));\n    if (!string.IsNullOrEmpty(txtDesc.Text))\n        predicate = predicate.And(e1 =&gt; e1.Desc.Contains(txtDesc.Text));\n    if (!string.IsNullOrEmpty(txtName.Text))\n        predicate = predicate.And(e1 =&gt; e1.Name.Contains(txtName.Text));\n\n    EmployeeDataContext edb= new EmployeeDataContext();\n    var emp = edb.Employees.Where(predicate);\n    grdEmployee.DataSource = emp.ToList();\n    grdEmployee.DataBind();\n</code></pre>\n\n<p>What is that employee object, the one between the greater than and less than brackets? I have racked my brains on that one. I am using linq to sql entities and I get compile errors when I try this myself. I think the errors are something like, cannot cast from a linq table to . . . I am a beginner. Please forgive me for asking what may be an obvious thing. Thank you.</p>\n\n<p>ed Cohen</p>\n"},{"tags":["c#",".net","linq","collections"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":13261060,"title":"Condition in the LINQ","body":"<p>I have collection (list) of strings and I want to write LINQ lambda expression in C#.\nIf I have only one element in the List, return only that element, but if I have more than one element, return me all other elements except that one which is equals to \"Blue\").\nThanks for your help.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13260315,"title":"LINQ query for the following","body":"<p>Could someone help formulate a LINQ query for the following problem.\nI have the following list of Key-Value number sets (mind that Duplicate Keys are allowed). There are thousands of such sets.</p>\n\n<pre><code>{4,3}, {4,1}, {4,8}, {4,9}, {2,3}, {4,9}, {3,1} , {3,4}\n</code></pre>\n\n<p>What data structure would suit me best.\nAlso, I want to group the above list of key-pairs, and OrderByDescending() so that i can extract the highest Key-Value pair of a Key-group.</p>\n\n<p>For example in the above case, expected output:</p>\n\n<pre><code>{4,9}, {4,9}, {4, 8}, {4, 3}, {4, 1}, {2, 3}, {3, 4}, {3, 1}\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","divide-by-zero"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":204,"score":0,"question_id":10243382,"title":"How to prevent division by zero?","body":"<pre><code>ads = ads.Where(x =&gt; (x.Amount - x.Price) / (x.Amount / 100) &gt;= filter.Persent);\n</code></pre>\n\n<p>if x.Amount == 0 I have error \"Divide by zero error encountered.\"</p>\n\n<p>like me in this request is to avoid?</p>\n\n<p><strong>update:</strong></p>\n\n<p>this helped, but I do not like the decision:</p>\n\n<pre><code>ads = ads.Where(x =&gt; (x.Amount - x.Price) / ((x.Amount / 100)==0?0.1:(x.Amount / 100)) &gt;= filter.Persent);\n</code></pre>\n\n<p>there is another way?</p>\n"},{"tags":["sql-server","asp.net-mvc","linq","entity-framework","sql-server-2008-r2"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":175,"score":1,"question_id":12928463,"title":"Sometimes get Timeout expired exception with Linq to EF and after a restart of server, it works fine","body":"<p>I have hosted my website at rackspace cloud server.</p>\n\n<p>Sometimes I get the below exception while fetching records from database. The strange thing is that everything works fine for a few days after a restart and also I get this exception in only a few places and not everywhere.</p>\n\n<pre><code>Exception: Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.\n\nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.\n\nException Details: System.Data.SqlClient.SqlException: Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.\n\nStack Trace:\n\n\n[SqlException (0x80131904): Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.]\n   System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) +404\n   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +412\n   System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +1363\n   System.Data.SqlClient.SqlDataReader.ConsumeMetaData() +59\n   System.Data.SqlClient.SqlDataReader.get_MetaData() +118\n   System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) +6387937\n   System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) +6389506\n   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) +538\n   System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) +28\n   System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) +256\n   System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior) +19\n   System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior) +553\n\n[EntityCommandExecutionException: An error occurred while executing the command definition. See the inner exception for details.]\n   DataAccessLayer.dbCustomer.CompanyCustomerByLocationId(String sortExpression, Boolean asc, String nameSearchString, Int32 startRowIndex, Int32 maximumRows, Int32&amp; TotalRecord, Int64 companyId) in D:\\Dotnet Projects\\FutureZoom\\FutureZoom\\DataAccessLayer\\dbCustomer.cs:508\n   BusinessLogic.Customer.CompanyCustomerByLocationId(String sortExpression, Boolean asc, String nameSearchString, Int32 startRowIndex, Int32 maximumRows, Int64 CompanyId) in D:\\Dotnet Projects\\FutureZoom\\FutureZoom\\BusinessLogic\\Customer.cs:431\n   FutureZoom.Areas.Admin.Controllers.CompanyController.CustomerPaging(Int32 StartIndex, Int32 PageSize, String SortExp, Boolean Asc, String SearchExp, String Where) in D:\\Dotnet Projects\\FutureZoom\\FutureZoom\\FutureZoom\\Areas\\Admin\\Controllers\\CompanyController.cs:552\n   lambda_method(Closure , ControllerBase , Object[] ) +362\n   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +248\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +39\n   System.Web.Mvc.&lt;&gt;c__DisplayClass15.&lt;InvokeActionMethodWithFilters&gt;b__12() +125\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +640\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +312\n   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +691\n   System.Web.Mvc.Controller.ExecuteCore() +162\n   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +305\n   System.Web.Mvc.&lt;&gt;c__DisplayClassb.&lt;BeginProcessRequest&gt;b__5() +62\n   System.Web.Mvc.Async.&lt;&gt;c__DisplayClass1.&lt;MakeVoidDelegate&gt;b__0() +20\n   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +469\n   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +375\n</code></pre>\n\n<p>My Linq query is mentioned below</p>\n\n<pre><code>query = context.Customers.Include(\"Company\").Include(\"Company.EmailCampaignerStatus\")\n                                           .OrderBy(m =&gt; m.EmailCampaignerStatus.FirstOrDefault().CreatedOn)                                           \n                                           .Where(m =&gt; m.FirstName.StartsWith(name) || m.LastName.StartsWith(name) || m.Email.StartsWith(name) || (m.FirstName + \" \" + m.LastName).StartsWith(name))\n                                           .Where(m =&gt; m.CompanyId == companyId)\n                                           .Where(m =&gt; m.CompanyLocationId == locationId)\n                                           .Skip(startRowIndex == 0 ? startRowIndex : startRowIndex - 1)\n                                           .Take(maximumRows)\n                                           .ToList();\n</code></pre>\n\n<p>Execution time for this query is not even 1 second on my local machine and also the same at server side after a restart but the execution time increases day by day and it fails to execute after few days (sometime fails and sometimes gives result).</p>\n\n<p>I observed that it took 31.05sec and fails and it take 51.09 sec and fails. Sometimes it takes more than 2 mins and gives result.</p>\n\n<p>I talked with rackspace people but they were unable to trace the actual cause for the same.</p>\n\n<p>Edit 1: I have seen below queries in SQL Profiler against my paging query</p>\n\n<pre><code>SELECT \n[Project3].[Id1] AS [Id], \n[Project3].[C1] AS [C1], \n[Project3].[Id] AS [Id1], \n[Project3].[CompanyId] AS [CompanyId], \n[Project3].[CompanyLocationId] AS [CompanyLocationId], \n[Project3].[FirstName] AS [FirstName], \n[Project3].[LastName] AS [LastName], \n[Project3].[Email] AS [Email], \n[Project3].[Address1] AS [Address1], \n[Project3].[Address2] AS [Address2], \n[Project3].[City] AS [City], \n[Project3].[State] AS [State], \n[Project3].[Country] AS [Country], \n[Project3].[Zip] AS [Zip], \n[Project3].[Phone] AS [Phone], \n[Project3].[SaleDate] AS [SaleDate], \n[Project3].[Notes] AS [Notes], \n[Project3].[Cost] AS [Cost], \n[Project3].[CreatedOn] AS [CreatedOn], \n[Project3].[ModifiedOn] AS [ModifiedOn], \n[Project3].[PrimaryReviewSiteId] AS [PrimaryReviewSiteId], \n[Project3].[Id2] AS [Id2], \n[Project3].[SubscriptionTypeId] AS [SubscriptionTypeId], \n[Project3].[PlanFeeAmount] AS [PlanFeeAmount], \n[Project3].[LoginId] AS [LoginId], \n[Project3].[IndustryTypeId] AS [IndustryTypeId], \n[Project3].[CompanyName] AS [CompanyName], \n[Project3].[NumberOfLocations] AS [NumberOfLocations], \n[Project3].[LogoImageName] AS [LogoImageName], \n[Project3].[WebsiteUrl] AS [WebsiteUrl], \n[Project3].[blsActive] AS [blsActive], \n[Project3].[Pending] AS [Pending], \n[Project3].[ExpiryDate] AS [ExpiryDate], \n[Project3].[C2] AS [C2], \n[Project3].[Id3] AS [Id3], \n[Project3].[UploadTicketId] AS [UploadTicketId], \n[Project3].[UploadStatus] AS [UploadStatus], \n[Project3].[CompanyId1] AS [CompanyId1], \n[Project3].[CompanyLocationId1] AS [CompanyLocationId1], \n[Project3].[CustomerId] AS [CustomerId], \n[Project3].[CreatedOn2] AS [CreatedOn1]\nFROM ( SELECT \n    [Limit2].[Id] AS [Id], \n    [Limit2].[CompanyId] AS [CompanyId], \n    [Limit2].[CompanyLocationId] AS [CompanyLocationId], \n    [Limit2].[FirstName] AS [FirstName], \n    [Limit2].[LastName] AS [LastName], \n    [Limit2].[Email] AS [Email], \n    [Limit2].[Address1] AS [Address1], \n    [Limit2].[Address2] AS [Address2], \n    [Limit2].[City] AS [City], \n    [Limit2].[State] AS [State], \n    [Limit2].[Country] AS [Country], \n    [Limit2].[Zip] AS [Zip], \n    [Limit2].[Phone] AS [Phone], \n    [Limit2].[SaleDate] AS [SaleDate], \n    [Limit2].[Notes] AS [Notes], \n    [Limit2].[Cost] AS [Cost], \n    [Limit2].[CreatedOn] AS [CreatedOn], \n    [Limit2].[ModifiedOn] AS [ModifiedOn], \n    [Limit2].[PrimaryReviewSiteId] AS [PrimaryReviewSiteId], \n    [Limit2].[Id1] AS [Id1], \n    [Limit2].[CreatedOn1] AS [CreatedOn1], \n    [Limit2].[Id2] AS [Id2], \n    [Limit2].[SubscriptionTypeId] AS [SubscriptionTypeId], \n    [Limit2].[PlanFeeAmount] AS [PlanFeeAmount], \n    [Limit2].[LoginId] AS [LoginId], \n    [Limit2].[IndustryTypeId] AS [IndustryTypeId], \n    [Limit2].[CompanyName] AS [CompanyName], \n    [Limit2].[NumberOfLocations] AS [NumberOfLocations], \n    [Limit2].[WebsiteUrl] AS [WebsiteUrl], \n    [Limit2].[blsActive] AS [blsActive], \n    [Limit2].[Pending] AS [Pending], \n    [Limit2].[ExpiryDate] AS [ExpiryDate], \n    [Limit2].[LogoImageName] AS [LogoImageName], \n    [Limit2].[C1] AS [C1], \n    [Extent4].[Id] AS [Id3], \n    [Extent4].[UploadTicketId] AS [UploadTicketId], \n    [Extent4].[UploadStatus] AS [UploadStatus], \n    [Extent4].[CompanyId] AS [CompanyId1], \n    [Extent4].[CompanyLocationId] AS [CompanyLocationId1], \n    [Extent4].[CustomerId] AS [CustomerId], \n    [Extent4].[CreatedOn] AS [CreatedOn2], \n    CASE WHEN ([Extent4].[Id] IS NULL) THEN CAST(NULL AS int) ELSE 1 END AS [C2]\n    FROM   (SELECT TOP (20) [Project2].[Id] AS [Id], [Project2].[CompanyId] AS [CompanyId], [Project2].[CompanyLocationId] AS [CompanyLocationId], [Project2].[FirstName] AS [FirstName], [Project2].[LastName] AS [LastName], [Project2].[Email] AS [Email], [Project2].[Address1] AS [Address1], [Project2].[Address2] AS [Address2], [Project2].[City] AS [City], [Project2].[State] AS [State], [Project2].[Country] AS [Country], [Project2].[Zip] AS [Zip], [Project2].[Phone] AS [Phone], [Project2].[SaleDate] AS [SaleDate], [Project2].[Notes] AS [Notes], [Project2].[Cost] AS [Cost], [Project2].[CreatedOn] AS [CreatedOn], [Project2].[ModifiedOn] AS [ModifiedOn], [Project2].[PrimaryReviewSiteId] AS [PrimaryReviewSiteId], [Project2].[Id1] AS [Id1], [Project2].[CreatedOn1] AS [CreatedOn1], [Project2].[Id2] AS [Id2], [Project2].[SubscriptionTypeId] AS [SubscriptionTypeId], [Project2].[PlanFeeAmount] AS [PlanFeeAmount], [Project2].[LoginId] AS [LoginId], [Project2].[IndustryTypeId] AS [IndustryTypeId], [Project2].[CompanyName] AS [CompanyName], [Project2].[NumberOfLocations] AS [NumberOfLocations], [Project2].[WebsiteUrl] AS [WebsiteUrl], [Project2].[blsActive] AS [blsActive], [Project2].[Pending] AS [Pending], [Project2].[ExpiryDate] AS [ExpiryDate], [Project2].[LogoImageName] AS [LogoImageName], [Project2].[C1] AS [C1]\n        FROM ( SELECT [Project2].[Id] AS [Id], [Project2].[CompanyId] AS [CompanyId], [Project2].[CompanyLocationId] AS [CompanyLocationId], [Project2].[FirstName] AS [FirstName], [Project2].[LastName] AS [LastName], [Project2].[Email] AS [Email], [Project2].[Address1] AS [Address1], [Project2].[Address2] AS [Address2], [Project2].[City] AS [City], [Project2].[State] AS [State], [Project2].[Country] AS [Country], [Project2].[Zip] AS [Zip], [Project2].[Phone] AS [Phone], [Project2].[SaleDate] AS [SaleDate], [Project2].[Notes] AS [Notes], [Project2].[Cost] AS [Cost], [Project2].[CreatedOn] AS [CreatedOn], [Project2].[ModifiedOn] AS [ModifiedOn], [Project2].[PrimaryReviewSiteId] AS [PrimaryReviewSiteId], [Project2].[Id1] AS [Id1], [Project2].[CreatedOn1] AS [CreatedOn1], [Project2].[Id2] AS [Id2], [Project2].[SubscriptionTypeId] AS [SubscriptionTypeId], [Project2].[PlanFeeAmount] AS [PlanFeeAmount], [Project2].[LoginId] AS [LoginId], [Project2].[IndustryTypeId] AS [IndustryTypeId], [Project2].[CompanyName] AS [CompanyName], [Project2].[NumberOfLocations] AS [NumberOfLocations], [Project2].[WebsiteUrl] AS [WebsiteUrl], [Project2].[blsActive] AS [blsActive], [Project2].[Pending] AS [Pending], [Project2].[ExpiryDate] AS [ExpiryDate], [Project2].[LogoImageName] AS [LogoImageName], [Project2].[C1] AS [C1], row_number() OVER (ORDER BY [Project2].[CreatedOn1] ASC) AS [row_number]\n            FROM ( SELECT \n                [Filter1].[Id] AS [Id], \n                [Filter1].[CompanyId] AS [CompanyId], \n                [Filter1].[CompanyLocationId] AS [CompanyLocationId], \n                [Filter1].[FirstName] AS [FirstName], \n                [Filter1].[LastName] AS [LastName], \n                [Filter1].[Email] AS [Email], \n                [Filter1].[Address1] AS [Address1], \n                [Filter1].[Address2] AS [Address2], \n                [Filter1].[City] AS [City], \n                [Filter1].[State] AS [State], \n                [Filter1].[Country] AS [Country], \n                [Filter1].[Zip] AS [Zip], \n                [Filter1].[Phone] AS [Phone], \n                [Filter1].[SaleDate] AS [SaleDate], \n                [Filter1].[Notes] AS [Notes], \n                [Filter1].[Cost] AS [Cost], \n                [Filter1].[CreatedOn] AS [CreatedOn], \n                [Filter1].[ModifiedOn] AS [ModifiedOn], \n                [Filter1].[PrimaryReviewSiteId] AS [PrimaryReviewSiteId], \n                [Limit1].[Id] AS [Id1], \n                [Limit1].[CreatedOn] AS [CreatedOn1], \n                [Extent3].[Id] AS [Id2], \n                [Extent3].[SubscriptionTypeId] AS [SubscriptionTypeId], \n                [Extent3].[PlanFeeAmount] AS [PlanFeeAmount], \n                [Extent3].[LoginId] AS [LoginId], \n                [Extent3].[IndustryTypeId] AS [IndustryTypeId], \n                [Extent3].[CompanyName] AS [CompanyName], \n                [Extent3].[NumberOfLocations] AS [NumberOfLocations], \n                [Extent3].[WebsiteUrl] AS [WebsiteUrl], \n                [Extent3].[blsActive] AS [blsActive], \n                [Extent3].[Pending] AS [Pending], \n                [Extent3].[ExpiryDate] AS [ExpiryDate], \n                [Extent3].[LogoImageName] AS [LogoImageName], \n                1 AS [C1]\n                FROM    (SELECT [Extent1].[Id] AS [Id], [Extent1].[CompanyId] AS [CompanyId], [Extent1].[CompanyLocationId] AS [CompanyLocationId], [Extent1].[FirstName] AS [FirstName], [Extent1].[LastName] AS [LastName], [Extent1].[Email] AS [Email], [Extent1].[Address1] AS [Address1], [Extent1].[Address2] AS [Address2], [Extent1].[City] AS [City], [Extent1].[State] AS [State], [Extent1].[Country] AS [Country], [Extent1].[Zip] AS [Zip], [Extent1].[Phone] AS [Phone], [Extent1].[SaleDate] AS [SaleDate], [Extent1].[Notes] AS [Notes], [Extent1].[Cost] AS [Cost], [Extent1].[CreatedOn] AS [CreatedOn], [Extent1].[ModifiedOn] AS [ModifiedOn], [Extent1].[PrimaryReviewSiteId] AS [PrimaryReviewSiteId]\n                    FROM [dbo].[Customer] AS [Extent1]\n                    WHERE (([Extent1].[FirstName] LIKE @p__linq__0 ESCAPE N'~') OR ([Extent1].[LastName] LIKE @p__linq__1 ESCAPE N'~') OR ([Extent1].[Email] LIKE @p__linq__2 ESCAPE N'~') OR ([Extent1].[FirstName] + N' ' + [Extent1].[LastName] LIKE @p__linq__3 ESCAPE N'~')) AND ([Extent1].[CompanyId] = @p__linq__4) AND ([Extent1].[CompanyLocationId] = @p__linq__5) ) AS [Filter1]\n                OUTER APPLY  (SELECT TOP (1) \n                    [Extent2].[Id] AS [Id], \n                    [Extent2].[CreatedOn] AS [CreatedOn]\n                    FROM [dbo].[EmailCampaignerStatus] AS [Extent2]\n                    WHERE [Filter1].[Id] = [Extent2].[CustomerId] ) AS [Limit1]\n                LEFT OUTER JOIN [dbo].[Company] AS [Extent3] ON [Filter1].[CompanyId] = [Extent3].[Id]\n            )  AS [Project2]\n        )  AS [Project2]\n        WHERE [Project2].[row_number] &gt; 0\n        ORDER BY [Project2].[CreatedOn1] ASC ) AS [Limit2]\n    LEFT OUTER JOIN [dbo].[EmailCampaignerStatus] AS [Extent4] ON [Limit2].[CompanyId] = [Extent4].[CompanyId]\n)  AS [Project3]\nORDER BY [Project3].[CreatedOn1] ASC, [Project3].[Id1] ASC, [Project3].[Id] ASC, [Project3].[Id2] ASC, [Project3].[C2] ASC\n\nSELECT \n[GroupBy1].[A1] AS [C1]\nFROM ( SELECT \n    COUNT(1) AS [A1]\n    FROM [dbo].[Customer] AS [Extent1]\n    WHERE (([Extent1].[FirstName] LIKE @p__linq__0 ESCAPE N'~') OR ([Extent1].[LastName] LIKE @p__linq__1 ESCAPE N'~') OR ([Extent1].[Email] LIKE @p__linq__2 ESCAPE N'~') OR ([Extent1].[FirstName] + N' ' + [Extent1].[LastName] LIKE @p__linq__3 ESCAPE N'~')) AND ([Extent1].[CompanyId] = @p__linq__4) AND ([Extent1].[CompanyLocationId] = @p__linq__5)\n)  AS [GroupBy1]\n\n\nSELECT \nCASE WHEN ( EXISTS (SELECT \n    1 AS [C1]\n    FROM [dbo].[CompanyReviewSites] AS [Extent1]\n    WHERE [Extent1].[CompanyLocationId] = @p__linq__0\n)) THEN cast(1 as bit) WHEN ( NOT EXISTS (SELECT \n    1 AS [C1]\n    FROM [dbo].[CompanyReviewSites] AS [Extent2]\n    WHERE [Extent2].[CompanyLocationId] = @p__linq__0\n)) THEN cast(0 as bit) END AS [C1]\nFROM  ( SELECT 1 AS X ) AS [SingleRowTable1]\n\nSELECT \n1 AS [C1], \n[Extent1].[Id] AS [Id], \n[Extent1].[RiviewSiteId] AS [RiviewSiteId], \n[Extent1].[URL] AS [URL], \n[Extent1].[CompanyId] AS [CompanyId], \n[Extent1].[CompanyLocationId] AS [CompanyLocationId], \n[Extent2].[Id] AS [Id1], \n[Extent2].[ReviewSiteName] AS [ReviewSiteName], \n[Extent2].[ImageName] AS [ImageName]\nFROM  [dbo].[CompanyReviewSites] AS [Extent1]\nINNER JOIN [dbo].[ReviewSites] AS [Extent2] ON [Extent1].[RiviewSiteId] = [Extent2].[Id]\nWHERE [Extent1].[CompanyLocationId] = @p__linq__0\n</code></pre>\n"},{"tags":["c#","linq","entity-framework","type-conversion","entity-framework-5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13259608,"title":"Cannot convert source type 'void' to target type 'ICollection<Character>'","body":"<p>I have a <code>DataContract</code> class that I'm trying to convert to another class, <code>Movie</code> but for the property <code>Movie.Characters</code> I'm getting the error...</p>\n\n<blockquote>\n  <p>Cannot convert source type '<code>void</code>' to target type '<code>ICollection&lt;Character&gt;</code>'</p>\n</blockquote>\n\n<p>How can I create a new <code>Movie</code> so the <code>Character</code> property is set properly mapped to each <code>Person</code> and <code>Movie</code>?</p>\n\n<pre><code>var movies = dataContract.Movies.Select(m =&gt; new Movie {\n    Id = m.Id,\n    Title = m.Title,\n    Characters = m.AbridgedCast.ToList().ForEach(p =&gt; new Person { Name = p.Name, \n        RottenTomatoesId = p.Id, \n        Characters = p.Characters.ToList().ForEach(c =&gt; new Character { Name = c })})\n});\n</code></pre>\n\n<p><strong>MoviesDataContract.cs</strong></p>\n\n<pre><code>public class MoviesDataContract {\n    [DataMember(Name = \"total\")]\n    public int Total { get; set; }\n\n    [DataMember(Name = \"movies\")]\n    public IEnumerable&lt;Movie&gt; Movies { get; set; }\n\n    #region Internal Classes\n\n    [DataContract]\n    public class Movie {\n        [DataMember(Name = \"id\")]\n        public int Id { get; set; }\n\n        [DataMember(Name = \"title\")]\n        public string Title { get; set; }\n\n        [DataMember(Name = \"abridged_cast\")]\n        public virtual IEnumerable&lt;Person&gt; AbridgedCast { get; set; }\n    }\n\n    [DataContract]\n    public class Person {\n        [DataMember(Name = \"name\")]\n        public string Name { get; set; }\n\n        [DataMember(Name = \"id\")]\n        public int Id { get; set; }\n\n        [DataMember(Name = \"characters\")]\n        public IEnumerable&lt;string&gt; Characters { get; set; }\n    }\n\n    #endregion  \n}\n</code></pre>\n\n<p><strong>Movies.cs</strong></p>\n\n<pre><code>public partial class Movie {\n    public Movie() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n\n    public int Id { get; set; }\n    public string Title { get; set; }\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n}\n\npublic partial class Character {\n    public System.Guid Id { get; set; }\n    public int MovieId { get; set; }\n    public System.Guid PersonId { get; set; }\n    public string Name { get; set; }\n\n    public virtual Movie Movie { get; set; }\n    public virtual Person Person { get; set; }\n}\n\npublic partial class Person {\n    public Person() {\n        this.Characters = new HashSet&lt;Character&gt;();\n    }\n\n    public System.Guid Id { get; set; }\n    public string Name { get; set; }\n    public int RottenTomatoesId { get; set; }\n\n    public virtual ICollection&lt;Character&gt; Characters { get; set; }\n}\n</code></pre>\n"},{"tags":["vb.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13258669,"title":"Create Dictionary(of Dictionary) using Grouping in Linq (Part 2)","body":"<p>I asked a question almost identical to this a few days ago via <a href=\"http://stackoverflow.com/questions/13198355/create-dictionaryof-dictionary-using-grouping-in-linq\">this thread</a> and got awesome replies - The biggest lesson for me (aside from the answer itself) was to create a custom object for my holding data. \nSo, having now done that, can I ask you experts to please show me the most efficient Linq statement to satisfy my requirements?</p>\n\n<p>My Scenario is as follows:</p>\n\n<p>Suppose I have the following holding class:</p>\n\n<pre><code>Public Class Class_Info\n    Public Property Teacher As String\n    Public Property Name As String\n    Public Property Sex As String\nEnd Class\n</code></pre>\n\n<p>Then, suppose I have the following in another module:</p>\n\n<pre><code>Dim X as new list(of Class_Info)\n</code></pre>\n\n<p>With the following elements in the list:</p>\n\n<pre><code>Element.Teacher:     Element.Sex:        Element.Name:\nTeacher 1            Male                Whatever Name 1\nTeacher 2            Female              Whatever Name 2 \nTeacher 1            Female              Whatever Name 3\nTeacher 1            Female              Whatever Name 4\nTeacher 2            Male                Whatever Name 5\nTeacher 3            Male                Whatever Name 6\nTeacher 3            Female              Whatever Name 7\nTeacher 1            Male                Whatever Name 8\nTeacher 1            Female              Whatever Name 9\nTeacher 2            Male                Whatever Name 10\n</code></pre>\n\n<p>Now, suppose I want to create the following structure with the following values:</p>\n\n<pre><code>Dim dictTeacherSexName as New Dictionary(Of String, Dictionary(Of String, List(of String)))\n\nDict1_Key:        Dict1_Value / Dict2_Key:         Dict2_Value:\nTeacher 1         Male                             Whatever Name 1\n                                                   Whatever Name 8\n                  Female                           Whatever Name 3\n                                                   Whatever Name 4\n                                                   Whatever Name 9\nTeacher 2 ...\n</code></pre>\n\n<p>How could I create that via Linq in the most efficient way?</p>\n\n<p>Thanks!!!</p>\n"},{"tags":["c#","linq","entity-framework","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13234447,"title":"Datetime check in Linq where statement","body":"<p>Please see the code below:</p>\n\n<pre><code>var pcPageList = db.PcPages\n        .Where(m =&gt; \n            m.Quarter == exactQuarter &amp;&amp; \n            m.Url == pageUrl &amp;&amp; \n            m.UpdatedOn.ToDateTime().Date.ToString(\"dd/MMM\").ToLower() == \"02/nov\")\n        .OrderBy(m =&gt; m.UpdatedOn)\n        .FirstOrDefault();\n</code></pre>\n\n<p>When I run this above, the application throws error says: \"ToDateTime\" is not implemented yet. Anyone please can advice ?</p>\n"},{"tags":["c#","mysql","linq","entity-framework","entity-framework-5"],"answer_count":5,"favorite_count":3,"up_vote_count":5,"down_vote_count":1,"view_count":109,"score":4,"question_id":13257760,"title":"Why does Entity Framework SQL generation create a nested query?","body":"<p>Why does Entity Framework SQL generation create a nested query?</p>\n\n<p>I have this code</p>\n\n<pre><code>    var db = new Context();\n    var result = db.Network.Where(x =&gt; x.ServerID == serverId)\n        .OrderBy(x=&gt; x.StartTime)\n        .Take(limit);\n</code></pre>\n\n<p>Which will be transleted into this! (Note the dubble select statement)</p>\n\n<pre><code>SELECT\n`Project1`.`Id`, \n`Project1`.`ServerID`, \n`Project1`.`EventId`, \n`Project1`.`StartTime`\nFROM (SELECT\n`Extent1`.`Id`, \n`Extent1`.`ServerID`, \n`Extent1`.`EventId`, \n`Extent1`.`StartTime`\nFROM `Networkes` AS `Extent1`\n WHERE `Extent1`.`ServerID` = @p__linq__0) AS `Project1`\n ORDER BY \n`Project1`.`StartTime` DESC LIMIT 5\n</code></pre>\n\n<p>How could I change it into one <code>select</code> statement?\nI'm using MySQL and Entity Framework with code first</p>\n\n<h1>Update</h1>\n\n<p>I have the same result whatever type I use as parameter to the <code>OrderBy()</code> method.</p>\n\n<h1>Update 2 with some timeing</h1>\n\n<pre><code>Total Time (hh:mm:ss.ms)    05:34:13.000\nAverage Time (hh:mm:ss.ms)  25:42.000\nMax Time (hh:mm:ss.ms)  51:54.000\nCount   13\nFirst Seen  Nov 6, 12 19:48:19\nLast Seen   Nov 6, 12 20:40:22\n</code></pre>\n\n<p>Raw query:</p>\n\n<pre><code>SELECT `Project?`.`Id`, `Project?`.`ServerID`, `Project?`.`EventId`, `Project?`.`StartTime` FROM (SELECT `Extent?`.`Id`, `Extent?`.`ServerID`, `Extent?`.`EventId`, `Extent?`.`StartTime`, FROM `Network` AS `Extent?` WHERE `Extent?`.`ServerID` = ?) AS `Project?` ORDER BY `Project?`.`Starttime` DESC LIMIT ?\n</code></pre>\n\n<p>I use a program to take snapshots from the current process in MySQL.</p>\n\n<p>It's other querys that could be executed at the same time. But when I change it to just one SELECT statement, it NEVER goes over one second. Maybe I have something else that's going on, I'm asking couse I'm not so into DBs...</p>\n\n<h1>Update 3 The explain statement</h1>\n\n<p>The entity framework generated</p>\n\n<pre><code>'1', 'PRIMARY', '&lt;derived2&gt;', 'ALL', NULL, NULL, NULL, NULL, '46', 'Using filesort'\n'2', 'DERIVED', 'Extent?', 'ref', 'serveridneventid,serverid', 'serveridneventid', '109', '', '45', 'Using where'\n</code></pre>\n\n<p>One liner</p>\n\n<pre><code>'1', 'SIMPLE', 'network', 'ref', 'serveridneventid,serverid', 'serveridneventid', '109', 'const', '45', 'Using where; Using filesort'\n</code></pre>\n\n<p>This is from my QA enviroment, so the timeing I pasted above is not realted to this row count explain statements. I think that there is about 500,000 records that match one server id.</p>\n"},{"tags":[".net","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":6212038,"title":"\"Member AutoSync Failure\" using TPT, view and instead of insert trigger","body":"<p>Trying to use Linq2SQL with class inheritance using TPT pattern like this http://blogs.msdn.com/sbajaj/archive/2008/04/02/tpt-with-linq-to-sql.aspx</p>\n\n<p>Sample application works fine. Here is my code:</p>\n\n<p>Tables and views:</p>\n\n<p>&nbsp;</p>\n\n\n<pre>CREATE TABLE [dbo].[social_event](\n    [Id] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY,\n    [Creator] [uniqueidentifier] NOT NULL FOREIGN KEY REFERENCES [dbo].[aspnet_Users](UserId),\n    [EventDate] [datetime] NOT NULL)\nGO\n\nCREATE TABLE [dbo].[social_addfriendevent](\n    [ID] [int] NOT NULL PRIMARY KEY FOREIGN KEY REFERENCES [dbo].[social_event](Id),\n    [Friend] [uniqueidentifier] NOT NULL FOREIGN KEY REFERENCES [dbo].[aspnet_Users](UserId),\n    [Added] [bit] NOT NULL DEFAULT((0)))\nGO\n\nCREATE VIEW [dbo].[event]\nAS\nSELECT t0.Id, t0.Creator, t0.EventDate, t1.Friend, t1.Added, 'AddFriendEvent' AS EventType\nFROM  dbo.social_event AS t0 INNER JOIN\n   dbo.social_addfriendevent AS t1 ON t0.Id = t1.Id\nGO\n</pre>\n\n\n<p>&nbsp;</p>\n\n<p>&nbsp;My \"Instead of insert\" trigger:</p>\n\n<p>&nbsp;</p>\n\n\n<pre>CREATE TRIGGER [dbo].[trigger_update_event] ON [dbo].[event] INSTEAD OF INSERT\nAS\n    DECLARE @rc AS INT;\n    SET @rc = @@ROWCOUNT;\n    IF @rc = 0 RETURN;\n\n    DECLARE @Id AS INT\n    DECLARE @EventType AS NVARCHAR(50)\n    DECLARE @Creator AS uniqueidentifier\n    DECLARE @EventDate AS datetime\n    DECLARE @Friend AS uniqueidentifier\n    DECLARE @Added AS bit \n\n    IF @rc = 1\n        BEGIN\n            SELECT @Id=Id,\n   @EventType=EventType,\n                 @Creator=Creator,\n                 @EventDate = getdate(),\n                 @Friend=Friend,\n                 @Added=Added\n            FROM INSERTED\n\n            INSERT INTO dbo.social_event VALUES(@Creator, @EventDate)\n            SELECT @Id = SCOPE_IDENTITY()\n            IF @EventType = 'AddFriendEvent'\n                INSERT INTO dbo.social_addfriendevent VALUES(@Id, @Friend, @Added)                            \n        END\n    ELSE\n        BEGIN\n            DECLARE cursor_inserted CURSOR FAST_FORWARD FOR\n                SELECT EventType,\n                     Creator,\n                     EventDate,\n                     Friend,\n                     Added\n                FROM INSERTED\n            OPEN cursor_inserted;\n\n            FETCH NEXT FROM cursor_inserted INTO @EventType,\n                                             @Creator,\n                                             @EventDate,\n                                             @Friend,\n                                             @Added;\n            WHILE @@FETCH_STATUS = 0\n            BEGIN\n                INSERT INTO dbo.social_event VALUES(@Creator, @EventDate)\n                SELECT @Id = SCOPE_IDENTITY()                \n                IF @EventType = 'AddFriendEvent'\n                INSERT INTO dbo.social_addfriendevent VALUES(@Id, @Friend, @Added)\n            END\n            CLOSE cursor_inserted;\n            DEALLOCATE cursor_inserted;\n        END\n</pre>\n\n\n<p>&nbsp;</p>\n\n<p>My data classes with mappings:</p>\n\n<p>&nbsp;</p>\n\n\n<pre>[InheritanceMapping(Code = \"AddFriendEvent\", Type = typeof(AddFriendEvent), IsDefault = true)]\n [Table(Name = \"dbo.event\")]\n public abstract class Event\n {\n private static int s_id;\n\n public Event()\n {\n  this.Id = --Event.s_id;\n }\n\n public Event(string eventType)\n  : this()\n {\n  EventType = eventType;\n }\n\n [Column(IsPrimaryKey = true)]\n public int Id;\n\n [Column(Name = \"Creator\")]\n public Guid CreatorId;\n\n [Column(Name = \"EventDate\", DbType = \"datetime\")] \n public DateTime Date;\n\n [Column(IsDiscriminator = true, Name = \"EventType\")]\n public string EventType;\n }\n\n public class AddFriendEvent : Event\n {\n [Column(Name = \"Added\", CanBeNull = false)]\n public bool Added;\n\n [Column(Name = \"Friend\", CanBeNull = false)]\n public Guid Friend;\n\n public AddFriendEvent()\n  : base(\"AddFriendEvent\")\n {\n }\n }\n</pre>\n\n\n<p>&nbsp;</p>\n\n<p>When I try to create new \"AddFriendEvent\" and save it to database like here:</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n\n<pre>DataContext dc = new DataContext(connectionString);\n   Table&lt;Event&gt; allEvents = dc.GetTable&lt;Event&gt;();\n   AddFriendEvent ev = new AddFriendEvent()\n   {\n    Added = true,\n    CreatorId = Guid.Parse(\"379959D-58FE-4A57-BB02-559E3E855B8F\"),\n    Date = DateTime.Now,\n    Friend = Guid.Parse(\"379959D-58FE-4A57-BB02-559E3E855B8F\")\n   };\n   allEvents.InsertOnSubmit(ev);\n   dc.SubmitChanges();\n</pre>\n\n\n<p>&nbsp;</p>\n\n<p>I got&nbsp;<strong>\"Member AutoSync Failure\"</strong>. What's wrong?</p>\n\n<p><br /></p>\n"},{"tags":["sql-server","linq","spaces"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":334,"score":1,"question_id":1879422,"title":"LINQ puts unwanted trailing spaces on strings","body":"<p>I have a very annoying problem with LINQ and MS SQL Server.</p>\n\n<p>Im currently making some software in WPF C# and use LINQ to generate classes from the data in the database.</p>\n\n<p>However, when i update a nvarchar or varchar field in the DB from my program, LINQ adds trailing spaces to the string!</p>\n\n<p>I have a field in a table defined like this:</p>\n\n<pre><code>ProductName = NVARCHAR(10)\n</code></pre>\n\n<p>So if i do this:</p>\n\n<pre><code>Product.Name = \"Bike\";\nProduct.Name = Product.Name.Trim();\nrepository.Add(Product);   // Runs an .InsertOnSubmit\nrepository.Save();         // Runs a .SubmitChanges\n</code></pre>\n\n<p>then the resulting data in the DB is \"Bike[SPACE][SPACE][SPACE][SPACE][SPACE][SPACE]\" where [SPACE] is just a space (can't write multiple spaces in this text here).</p>\n\n<p>Why does it do this, and how do i make it stop adding those annoying trailing spaces?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","linq","clr"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13242762,"title":"Can I use LINQ to get all components of a certain type?","body":"<p>I'm fairly new to <code>C#</code> and got a bit of a problem that I'm sure has a good solution using LINQ.</p>\n\n<p><strong>Background:</strong>\nThere's a project I've inherited that uses CrystalReports, the reports themselves all have viewer-forms [containing components/controls] associated with them in a uniform way (I'm fairly sure they were machine generated), one of these is a component descended from <code>ReportClass</code> which contains a database property. The database property is the <strong>only</strong> thing that differentiates a method (<code>Log_On_Database</code>) that appears in all of these classes. What I would like to do is create a common base class that searches the form for <code>ReportClass</code> and uses that to populate its local database variable w/ the value from the property so I can implement <code>Log_On_Database</code> in a single location.</p>\n\n<p><strong>Question:</strong>\nHow does one use LINQ to get all of the <code>components</code> (not [just] controls) belonging to a form and recursively for those that <em>are</em> controls (and thus can have their own)? </p>\n\n<p><strong>NOTE:</strong> Getting the result in a <code>List</code> would be great, as I could then test for a length of 0 (something went horribly wrong), 1 (expected), or more (and then I could do what I need to on those odd cases) -- even if this is all generated code, I don't trust it to <em>not</em> have been modified in horrendously painful ways.</p>\n"},{"tags":["c#","linq","dictionary","key","key-value"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13255426,"title":"C# .net 3.5+ Dictionary<string, string> key/value pair displaying value as default choice  MVC select list","body":"<p>Im trying to figure out any way to retrieve certain elements of a particular class instance for use within a drop-down list that Im attempting to perform some maintenance on. The goal is to select and assign all Contacts to a key/value pair string array (Contacts being a related entity of Company, specifically, a 1:n relationship - 1 company has multiple contacts) then selecting the first contacts first and last name attributes out of the sequence where the Boolean class attribute, Primary, is set to True.  </p>\n\n<pre><code>public class Company \n{\n    public string Name { get; set; }\n    public virtual ICollection&lt;Contact&gt; Contacts { get; set; }\n}\n\npublic class Contact\n{\n        public string FirstName { get; set; }\n        public string LastName { get; set; }\n        public bool IsPrimary { get; set; }\n}\n</code></pre>\n\n<p>The following code:  </p>\n\n<pre><code>private Company CreateViewModel(Company company)\n{\n    var contacts = _contactService.CompanyContacts(company);\n\n}\n\npublic Dictionary&lt;string, string&gt; CompanyContacts(Company company)\n            {\n                    var results = new Dictionary&lt;string, string&gt;();\n\n                    foreach (var contact in company.Contacts)\n                    {\n                            var key = string.Format(\"{0} {1}|{2}\", contact.FirstName, contact.LastName, contact.IsPrimary());\n\n                            var val = string.Format(\"{0} {1}|{2}\", contact.FirstName, contact.LastName, contact.IsPrimary());\n\n                            if (results.ContainsKey(key)) continue;\n\n                            results.Add(key, val);\n                    }\n\n                    return results;\n            }\n\n    public void InitContactList(Dictionary&lt;string, string&gt; contacts)\n    {\n\n        var firstOrDefault = contacts\n            .Where(x =&gt; x.Key.Contains(\"true\"))\n            .Select(x =&gt; x.Value)\n            .FirstOrDefault();\n\n        var selectedContact = contacts.FirstOrDefault().Value;\n\n            if (firstOrDefault != null)\n            {\n                var selectedContact =  firstOrDefault;\n\n                ContactList = new SelectList(contacts, \"Key\", \"Value\")\n                .SelectByText(selectedContact.ToString()).ToList();\n            }\n\n            ContactList = new SelectList(contacts, \"Key\", \"Value\")\n                .SelectByText(selectedContact.ToString()).ToList();\n    }\n</code></pre>\n\n<p>doesn't display the first 'is primary' contact by default in the select-list though. I would like the first isPrimary=1 contact to be the first selection in the picklist. Im pretty sure the firstOrDefault variable in the InitContactList needs to have the key do something other than .contains(true) Any help would be appreciated.\nThank you in advance.</p>\n"},{"tags":["c#",".net","xml","linq","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13253395,"title":"Altering NHibernate config file using c# linq","body":"<p>let us consider the following web.config file </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    &lt;section name=\"hibernate-configuration\" type=\"NHibernate.Cfg.ConfigurationSectionHandler, NHibernate\"/&gt;\n  &lt;/configSections&gt;\n  &lt;hibernate-configuration xmlns=\"urn:nhibernate-configuration-2.2\"&gt;\n    &lt;session-factory&gt;\n      &lt;property name='proxyfactory.factory_class'&gt;NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle\n      &lt;/property&gt;\n      &lt;property name=\"connection.provider\"&gt;\n       NHibernate.Connection.DriverConnectionProvider\n      &lt;/property&gt;\n\n     &lt;property name=\"connection.connection_string\"&gt;\n         Server=myServerAddress;Port=1234;Database=myDataBase;Uid=myUsername;Pwd=myPassword;\n      &lt;/property&gt;\n      &lt;property name=\"dialect\"&gt;\n        NHibernate.Dialect.MySQLDialect\n      &lt;/property&gt;\n      &lt;property name=\"show_sql\"&gt;\n        false\n      &lt;/property&gt;\n      &lt;property name=\"hbm2ddl.keywords\"&gt;none&lt;/property&gt;\n    &lt;/session-factory&gt;\n  &lt;/hibernate-configuration&gt;\n   &lt;startup&gt;\n  &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;&lt;/startup&gt;\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;qualifyAssembly partialName=\"MySql.Data\" fullName=\"MySql.Data, Version=5.1.7.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d\" /&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n\n<p>My query is to change the value in the <strong></strong> tag</p>\n\n<p><strong>old value:</strong></p>\n\n<pre><code>&lt;property name=\"connection.provider\"&gt;\n       NHibernate.Connection.DriverConnectionProvider\n      &lt;/property&gt;\n</code></pre>\n\n<p><strong>new value</strong></p>\n\n<pre><code>&lt;property name=\"connection.provider\"&gt;\n      Sample.DriverConnectionProvider\n      &lt;/property&gt;\n</code></pre>\n\n<p>For that I used:</p>\n\n<pre><code> XDocument doc = XDocument.Load(\"path to webconfig\");\n\n var xElems = from x in doc.Descendants()\n            where x.Name.LocalName == \"property name=\\\"connection.provider\\\"\"\n                  select x;\n\n                foreach (var xElem in xElems)\n                {\n                    Console.WriteLine(xElem.Attribute(\"name\"));\n                }\n</code></pre>\n\n<p>But while I view the document I get the view in xdoc as:</p>\n\n<pre><code>//&lt;property name=\"connection.provider\" xmlns=\"urn:nhibernate-configuration-2.2\"&gt;\n</code></pre>\n\n<p>How can I solve this issue?</p>\n"},{"tags":["linq","entity-framework","linq-to-sql","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13255894,"title":"LINQ getting distinct records based on an item value","body":"<p>I have following LINQ query</p>\n\n<pre><code> var unallocatedOrders = (from orderLine in context.OrderLineItemDboes\n     where (orderLine.Status == unallocated || orderLine.Status == null)\n         &amp;&amp; orderLine.orderline.order.order_status_fk == verified\n     group orderLine\n         by new { orderLine.orderline.ol_id,orderLine.orderline.order.order_id }\n         into g\n     select new { OrderLineId = g.Key.ol_id, Count = g.Count(), OrderId = g.Key.order_id })\n .ToList();\n</code></pre>\n\n<p>Above query giving me results in the following way</p>\n\n<pre><code>Order1 ol1 2\norder1 ol2 3\norder1 ol3 1\norder2 ol1 1\norder2 ol2 2\norder3 ol1 4\norder3 ol2 3\norder3 ol3 2\n</code></pre>\n\n<p>I need to iterate through the above list based on order ids and need to fetch corresponding lines and quantity. \nI need to get this line id and quantity to a Dictionary.\nCan somebody suggest how can I get it done.</p>\n\n<p>Thanks</p>\n"},{"tags":["sql-server","linq"],"answer_count":6,"favorite_count":8,"up_vote_count":16,"down_vote_count":0,"view_count":10479,"score":16,"question_id":1722741,"title":"Defining a one-to-one relationship in SQL Server","body":"<p>I need to define a one-to-one relationship, and can't seem to find the proper way of doing it in SQL Server.</p>\n\n<p>Why a one-to-one relationship you ask? </p>\n\n<p>I am using WCF as a DAL (Linq) and I have a table containing a BLOB column. The BLOB hardly ever changes and it would be a waste of bandwidth to transfer it across every time a query is made.</p>\n\n<p>I had a look at <a href=\"http://sqlserver-tips.blogspot.com/2006/10/implementing-one-to-one-relationship.html\" rel=\"nofollow\">this solution</a>, and though it seems like a great idea, I can just see Linq having a little hissy fit when trying to implement this approach.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["asp.net-mvc","linq","linq-to-sql"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":7699,"score":3,"question_id":2515303,"title":"Delete all records from a database using LINQ to SQL","body":"<p>I am using MVC. How do I delete all records from the database using LINQ to SQL? A code example would be greatly appreciated.</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":68,"score":4,"question_id":13255398,"title":"LINQ Query baby-steps","body":"<p>I have the following code. It runs fine.</p>\n\n<p>In the place I have marked I'd like to write a query (I assume with <code>LINQ</code>) which extracts the <code>CompanyName</code> <code>where</code> the <code>MainKey == 3028</code></p>\n\n<p>I suspect this is trivial but I'm new to <code>LINQ</code> and I've looked up some basic <code>LINQ</code> info on <a href=\"http://msdn.microsoft.com/en-us/library/bb397927.aspx\" rel=\"nofollow\">MSDN</a> and can't seem to get it to work. </p>\n\n<pre><code>namespace EntityFrameworkExperiment {\nclass Program {\n\n    static void Main(string[] args) {\n        var models = SelectTop100Models(\"SELECT top 100 * FROM WHData.dbo.vw_DimCasino\");\n        Console.Write(\"hello world\");\n\n        //&lt;&lt;&lt;&lt;&lt;&lt;&lt;linq query to pull out companyname when MainKey == 3028\n\n        Console.Read();\n    }\n\n    static IEnumerable&lt;MyModel&gt; SelectTop100Models(string myCommandText) {\n        var connectionString = ConfigurationManager.ConnectionStrings[\"XXX\"].ConnectionString;\n        using(var conn = new SqlConnection(connectionString))\n        using(var cmd = conn.CreateCommand()) {\n            conn.Open();\n            cmd.CommandText = myCommandText;\n            using(var reader = cmd.ExecuteReader()) {\n                while(reader.Read()) {\n                    yield return new MyModel {\n\n                        MainKey = reader.GetInt32(reader.GetOrdinal(\"MainKey\")),\n                        ServerId  = reader.GetInt32(reader.GetOrdinal(\"ServerId\")),\n                        CompanyId = reader.GetInt32(reader.GetOrdinal(\"CompanyId\")),\n                        CompanyName = reader.GetString(reader.GetOrdinal(\"CompanyName\")),\n\n\n                    };\n                }\n            }\n        }\n    }\n}\n\npublic class MyModel {\n\n    public int MainKey { get; set; }\n    public int ServerId { get; set; }\n    public int CompanyId { get; set; }\n    public string CompanyName { get; set; }\n\n}\n</code></pre>\n\n<p>}</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":86,"score":2,"question_id":12463808,"title":"Grouping and Summing a List in C#","body":"<p>I have a list in C# e.g.</p>\n\n<pre><code>A,1\nB,2\nC,3\nA,4\nB,5\n</code></pre>\n\n<p>I want to return the result in a list as:</p>\n\n<pre><code>A,5\nB,7\nC,3\n</code></pre>\n\n<p>So grouping by the first column and summing the second. </p>\n\n<p>How do I do this? Happy to use LINQ. Declaration and code so far as follows:</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        List&lt;MyList&gt; list = new List&lt;MyList&gt;();\n\n        list.Add(new MyList() { Letter = \"A\", Value = 1 });\n        list.Add(new MyList() { Letter = \"B\", Value = 2 });\n        etc... \n    }\n}\n\nclass MyList\n{\n    public string Letter { get; set; }\n    public long Value { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","winforms","linq","recursion"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":13227170,"title":"Recursive Lookup of generic List C# using LINQ","body":"<p>I have generic list of a custom class which has 2 properties. These properties store the raltionship between on form and another form. The list is structured as a hierachical list (parent / child ) relationship. What I want to be able to do is get a list of all forms based on a parent form reference which will be passed to a function. I am thinking the best way to go about this is with a LINQ query using a recursive approach. I am sure someone can point me in the right direction</p>\n\n<p>This is the class used in the list </p>\n\n<pre><code>class FormStack    {\n\n    #region Declares\n\n    private Form _form;\n    private Form _parent;\n\n    #endregion\n\n    #region Constructor\n\n    static FormStack()\n    {\n    }\n\n    #endregion\n\n    public Form Form\n    {\n        get { return _form; }\n        set { _form = value; }\n    }\n\n    public Form Parent\n    {\n        get { return _parent; }\n        set { _parent = value; }\n    }\n\n}\n</code></pre>\n\n<p>So I would like to be able to Call a method and pass a form reference to the function and get all the children form related to this parent.</p>\n\n<p>This is some of the code I have been stumbling with</p>\n\n<pre><code>// create a lookup list\nvar list = formStack.ToLookup( p =&gt; object.ReferenceEquals( p.Parent, parent ) );\n\n// create a function\nFunc&lt;IEnumerable&lt;Form&gt;, IEnumerable&lt;Form&gt;&gt; recurse = null;\nrecurse = qs =&gt;\n{\n    return\n        qs\n            .Concat(\n                from q in qs\n                from q2 in recurse( list[] )\n                select q2 );\n};\n\n// filter the list\nvar children = recurse( list[parent] ).ToList();\n</code></pre>\n\n<p>I have a winform application which has standard CRUD functionality. Lets say there is a list of customers and each customer can have multiple address and each one of these addresses have multiple buildings, the way I have structured the forms is there is a list of customers, from this list you can open a detail form for a particular customer. This form has the details of the customer and all the addresses in a list. This list allows the user to now selected an address in the list and open the address details form which has a list of buildings and so on.... My problem is I want to close the customer detail and all the related forms for this customer. My idea was to keep of the relationship between the forms, but maybe I there is a better way???</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13253671,"title":"Reading XML dynamically using LINQ","body":"<pre><code>Document miXML = new XDocument(\n\n            new XElement(\"Alumnos\",\n                                new XElement(\"Alumno\",\n                                    new XAttribute(\"NoControl\", \"05231104\"),\n                                    new XElement(\"Nombre\", \"Edison Garca\")),\n\n\n                                 new XElement(\"Alumno\",\n                                    new XAttribute(\"NoControl\", \"05231106\"),\n                                    new XElement(\"Nombre\", \"Abraham Gomez Garca\"),\n                                    new XElement(\"Semestre\", \"9\")),\n\n                                new XElement(\"Alumno\",\n                                    new XAttribute(\"NoControl\", \"05231108\"),\n                                    new XElement(\"Nombre\", \"Alejandre Carvajal\"),\n                                    new XElement(\"Semestre\", \"7\")),\n\n                                new XElement(\"Alumno\",\n                                    new XAttribute(\"NoControl\", \"06231110\"),\n                                    new XElement(\"Nombre\", \"Luis Armando\"),\n                                    new XElement(\"Semestre\", \"10\"))\n                   )\n            );\n\n\n        StringReader sr = new StringReader(miXML.ToString());\n        var testlinq = XElement.Load(sr).Elements();\n\n        foreach(var abc in testlinq){\n\n        var test2 = from p in abc.Descendants(\"Nombre\") select p;\n        var test3 = from p in abc.Descendants(\"Semestre\") select p;\n        }\n</code></pre>\n\n<p>This is the XML that is created.\n<img src=\"http://i.stack.imgur.com/SeC6R.png\" alt=\"XML created\"></p>\n\n<p>I want a list of dictionary \nList consists of {\"Nombre\",\"Edison Garcia\"} , {{\"Nombre\", \"Abraham Gomez Garca\"} , {\"semestre\",\"9\"}}</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Problems i am facing :\n1)if there is no semsetre i am not able to skip it. It creates IEnumerable.\n2)Getting the node and value dynamically instaed of hardcoding . Eg : \n   var test2 = from p in abc.Descendants(\"Nombre\") select p;</p>\n"},{"tags":[".net","vb.net","linq","visual-studio-2008",".net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13254064,"title":"first issue with first linq","body":"<p>I'm using vs2008 framework 3.5 and i'm looking about linq for first time, following these <a href=\"http://msdn.microsoft.com/it-it/library/bb385164(v=vs.90).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/it-it/library/bb385164(v=vs.90).aspx</a></p>\n\n<p>Creating data source like this <a href=\"http://msdn.microsoft.com/it-it/library/bb385204(VS.90).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/it-it/library/bb385204(VS.90).aspx</a></p>\n\n<p>But i can't import/use linq.  Making a consoleApplication System.Core.dll reference and imports System.Linq should be automatic right?!</p>\n\n<p>writing in main:</p>\n\n<pre><code>Dim students = GetStudents()\n'Dim students As List(Of Student) = GetStudents() 'the same thing with this one\nDim studentQuery = From currentStudent In students _\n                   Where currentStudent.Rank &lt;= 10 _\n                   Select currejt\n</code></pre>\n\n<p>The IDE doesn't like students in the query and says:</p>\n\n<pre><code>Error   1   Expression of type 'System.Collections.Generic.IEnumerable(Of ConsoleApplication1.Module1.Student)' \nis not queryable. Make sure you are not missing an assembly reference and/or namespace \nimport for the LINQ provider. ConsoleApplication1 \n</code></pre>\n\n<p>where i'm wrong!?</p>\n\n<p>If i try 'Imports System.Linq' it says </p>\n\n<blockquote>\n  <p>Warning   1   Namespace or type specified in the Imports 'System.Linq'\n  doesn't contain any public member or cannot be found. Make sure the\n  namespace or the type is defined and contains at least one public\n  member. Make sure the imported element name doesn't use any aliases.</p>\n</blockquote>\n"},{"tags":["asp.net-mvc","linq","entity-framework","ef-code-first"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13248860,"title":"Querying an auto-generated EF junction table","body":"<p>I have two models, Benefit and SchemeName</p>\n\n<p>Benefit - </p>\n\n<pre><code>[Key]\npublic int BenefitID { get; set; }\npublic string BenefitName { get; set; }\npublic string BenefitDescription { get; set; }\npublic virtual ICollection&lt;SchemeName&gt; SchemeNames { get; set; }\n</code></pre>\n\n<p>SchemeName</p>\n\n<pre><code>[Key]\npublic int SchemeNameID { get; set; }\npublic string Name { get; set; }\npublic virtual ICollection&lt;Benefit&gt; Benefits { get; set; }\n</code></pre>\n\n<p>This has created three tables in the database Benefits, SchemeNames and a joining table called SchemeNameBenefits.</p>\n\n<p>I am trying to populate a droplownlist that contains only the SchemeNames associated with a certain Benefit but am not sure how I can do this, can I reference the join table in my code?</p>\n\n<p>I started with the following (which returns all SchemeNames)</p>\n\n<pre><code>private void PopulatePensionSchemeName(object selectedPensionSchemeName = null)\n        {\n            var schemeNameQuery = from d in db.SchemeNames\n                                  orderby d.SchemeNameID\n                                  select d;\n\n            ViewBag.PensionSchemeNameID = new SelectList(schemeNameQuery, \"SchemeNameID\", \"Name\", selectedPensionSchemeName);\n        }\n</code></pre>\n\n<p>But I'm not sure how I can add this clause. Any pointers?</p>\n"},{"tags":["c#","performance","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13253561,"title":"Improving performance of LINQ query with IEqualityComparer","body":"<p>I'm using <code>IEqualityComparer</code> to match \"near duplicates\" in a database using LINQ to Entities.</p>\n\n<p>With a record set of around 40,000, this query is taking around 15 seconds to complete and I wondered if there were any structural changes that could be made to the code below.</p>\n\n<p><strong>My public method</strong></p>\n\n<pre><code>public List&lt;LeadGridViewModel&gt; AllHighlightingDuplicates(int company)\n        {\n\n            var results = AllLeads(company)\n                  .GroupBy(c =&gt; c, new CompanyNameIgnoringSpaces())\n                  .Select(g =&gt; new LeadGridViewModel\n                  {\n                      LeadId = g.First().LeadId,\n                      Qty = g.Count(),\n                      CompanyName = g.Key.CompanyName\n                  }).OrderByDescending(x =&gt; x.Qty).ToList();\n\n            return results;\n\n        }\n</code></pre>\n\n<p><strong>Private method to grab the leads</strong></p>\n\n<pre><code>private char[] delimiters = new[] { ' ', '-', '*', '&amp;', '!' };\nprivate IEnumerable&lt;LeadGridViewModel&gt; AllLeads(int company)\n        {\n            var items = (from t1 in db.Leads\n                          where\n                              t1.Company_ID == company\n                          select new LeadGridViewModel\n                          {\n                              LeadId = t1.Lead_ID,\n                              CompanyName = t1.Company_Name,\n                          }).ToList();\n\n\n            foreach (var x in items)\n                x.CompanyNameStripped = string.Join(\"\", (x.CompanyName ?? String.Empty).Split(delimiters));\n\n            return items;\n        }\n</code></pre>\n\n<p><strong>My IEqualityComparer</strong></p>\n\n<pre><code> public class CompanyNameIgnoringSpaces : IEqualityComparer&lt;LeadGridViewModel&gt;\n    {\n        public bool Equals(LeadGridViewModel x, LeadGridViewModel y)\n        {\n            var delimiters = new[] {' ', '-', '*', '&amp;', '!'};\n            return delimiters.Aggregate(x.CompanyName ?? String.Empty, (c1, c2) =&gt; c1.Replace(c2, '\\0')) \n                == delimiters.Aggregate(y.CompanyName ?? String.Empty, (c1, c2) =&gt; c1.Replace(c2, '\\0'));\n        }\n\n        public int GetHashCode(LeadGridViewModel obj)\n        {\n            var delimiters = new[] {' ', '-', '*', '&amp;', '!'};\n            return delimiters.Aggregate(obj.CompanyName ?? String.Empty, (c1, c2) =&gt; c1.Replace(c2, '\\0')).GetHashCode();\n        }\n    }\n</code></pre>\n"},{"tags":["c#",".net","linq","linq-to-sql","inner-join"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13226996,"title":"Linq to Sql Inner Join","body":"<p>I am writing a linq to sql statement using the join. By searching I reached the the link below : \n<a href=\"http://stackoverflow.com/questions/37324/what-is-the-syntax-for-an-inner-join-in-linq-to-sql\">What is the syntax for an inner join in linq to sql?</a>\nin this question the answer is like : </p>\n\n<pre><code>var dealercontacts = from contact in DealerContact\n                     join dealer in Dealer on contact.DealerId equals dealer.ID\n                     select contact;\n</code></pre>\n\n<p>in this statement, inner join is used on single comparison statement i.e. <code>on contact.DealerId equals dealer.ID</code> But when I tried to do <code>on contact.DealerId equals dealer.ID &amp;&amp; contact.Branch equals dealer.Branch</code>, It does not accept the second comparison statement.\nPlease guide me how can I have this?</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13250929,"title":"Union/Merge 2 lists of different type and return a list of one type with LINQ","body":"<p>I have an IEnumerable of type String with Default values and a fix order.\nI have a List of type Module with values in a random order.\nI want to have ONE list of unique objects of type Module.\nWhat I get with the below code is:\nONE list of unique objects of type String.</p>\n\n<p>Someone knows a trick around this?</p>\n\n<pre><code>static void Main(string[] args) {    \n\n            List&lt;Module&gt; moduleList = new List&lt;Module&gt;() {\n                     new Module{ ModuleId = 1, ModuleType = \"world\"},\n                     new Module{ ModuleId = 2, ModuleType = \"wayne\"},\n                     new Module{ ModuleId = 3, ModuleType = \"hallo\"},\n                     new Module{ ModuleId = 4, ModuleType = \"tes\"},\n                     new Module{ ModuleId = 5, ModuleType = \"mi\"},\n                     new Module{ ModuleId = 6, ModuleType = \"haha\"},\n                     new Module{ ModuleId = 7, ModuleType = \"pipi\"},\n                     new Module{ ModuleId = 8, ModuleType = \"bla\"}, \n            };\n\n            // This result is fine that the list is unified and the predefined values order is not changed: bla, tes, mi \n            // BUT I need to return a query with Module objects\n            var query = GetDefaultValues().Union(moduleList.Select(t =&gt; t.ModuleType));\n\n        }\n\n        private static IEnumerable&lt;string&gt; GetDefaultValues() {\n            yield return \"bla\";\n            yield return \"tes\";\n            yield return \"mi\";\n        }\n</code></pre>\n\n<p>Do a new Module() in every lambda and copy the values is NO option for me.</p>\n\n<p>UPDATE:</p>\n\n<p>Desired output:</p>\n\n<p>a list of Modules:</p>\n\n<pre><code>new Module{ ModuleId = 8, ModuleType = \"bla\"},\nnew Module{ ModuleId = 4, ModuleType = \"tes\"},\nnew Module{ ModuleId = 5, ModuleType = \"mi\"},\n\nnew Module{ ModuleId = 1, ModuleType = \"world\"},\nnew Module{ ModuleId = 2, ModuleType = \"wayne\"},\nnew Module{ ModuleId = 3, ModuleType = \"hallo\"},\nnew Module{ ModuleId = 6, ModuleType = \"haha\"},\nnew Module{ ModuleId = 7, ModuleType = \"pipi\"},\n</code></pre>\n"},{"tags":["c#","linq","tsql","linq-to-entities"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13250550,"title":"Linq to Entity Join and Group By","body":"<p>I am new to Linq to Entity and here is my test scenario:</p>\n\n<ul>\n<li>There are Users</li>\n<li>Users have Photo Albums. An album belongs to only one User</li>\n<li>Albums have Photos. A Photo belongs to only one Album</li>\n<li>Photos have Tags. A Tag may belong to many Photos</li>\n</ul>\n\n<p><img src=\"http://i.stack.imgur.com/pdgTy.png\" alt=\"Db Tables\"></p>\n\n<p>I want to write a method which displays Count and Name of Tags used in Albums of a particular User using Linq.</p>\n\n<p>Here is the method that I wrote and it works fine</p>\n\n<pre><code>    public static void TestStatistics(int userId)\n    {\n        // select AlbumTitle, TagName, TagCount where UserId = userId\n        var results = from photo in dbSet.PhotoSet\n                      join album in dbSet.AlbumSet on photo.AlbumId equals album.Id into albumSet\n                      from alb in albumSet\n                      where alb.UserId == userId\n                      join photoTag in dbSet.PhotoTagSet on photo.Id equals photoTag.PhotoId into photoTagSet\n                      from pt in photoTagSet\n                      join tag in dbSet.TagSet on pt.TagId equals tag.Id\n                      group new { alb, tag } by new { alb.Title, tag.Name }\n                          into resultSet\n                          orderby resultSet.Key.Name\n                          select new\n                          {\n                              AlbumTitle = resultSet.Key.Title,\n                              TagName = resultSet.Key.Name,\n                              TagCount = resultSet.Count()\n                          };\n\n        foreach (var item in results)\n        {\n            Console.WriteLine(item.AlbumTitle + \"\\t\" + item.TagName + \"\\t\" + item.TagCount);\n        }\n    }\n</code></pre>\n\n<p>And this is the standart T-SQL query which does the same</p>\n\n<pre><code>SELECT  a.Title AS AlbumTitle, t.Name AS TagName , COUNT(t.Name) AS TagCount\nFROM    TblPhoto p, TblAlbum a, TblTag t, TblPhotoTag pt\nWHERE   p.Id = pt.PhotoId AND t.Id = pt.TagId AND p.AlbumId = a.Id AND a.UserId = 1\nGROUP BY a.Title, t.Name \nORDER BY t.Name\n</code></pre>\n\n<p>It is pretty obvious that standard T-SQL query is much simpler than the Linq query.\nI know Linq does not supposed to be simpler than T-SQL but this complexity difference makes me think that I am doing something terribly wrong. Besides the SQL query generated by Linq is extremly complex.</p>\n\n<p>Is there any way to make the Linq query simpler?</p>\n\n<h2>UPDATE 1:</h2>\n\n<p>I made it a little simpler without using joins but using a approach like used in T-SQL. Actually it is now as simple as T-SQL. Still no navigation properties and no relations on db.</p>\n\n<pre><code>var results = from photo in dbSet.PhotoSet\n              from album in dbSet.AlbumSet\n              from photoTag in dbSet.PhotoTagSet\n              from tag in dbSet.TagSet\n              where photo.AlbumId == album.Id &amp;&amp; photo.Id == photoTag.PhotoId &amp;&amp;\n                    tag.Id == photoTag.TagId &amp;&amp; album.UserId == userId\n              group new { album, tag } by new { album.Title, tag.Name } into resultSet\n              orderby resultSet.Key.Name\n              select new {\n                  AlbumTitle = resultSet.Key.Title,\n                  TagName = resultSet.Key.Name,\n                  TagCount = resultSet.Count()\n              };\n</code></pre>\n"},{"tags":[".net","linq","views"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13251170,"title":"Linq on Table View","body":"<p>I have following type </p>\n\n<pre><code>  public class TransactionDetails\n  { \n        public int TransID {get; set;}\n        public List&lt;string&gt; OrderID { get; set; }\n  }\n</code></pre>\n\n<p>what should be the Linq query on the following table View (say Trans_View) to fill this TransactionDetails custome type with follwing data from view. </p>\n\n<p>View record in following row format:</p>\n\n<pre><code>         TransID     OrderID      \n            1           ABC\n            1           DEF\n            1           IJK\n            2           XYZ\n            2           PQR\n</code></pre>\n"},{"tags":["c#","linq","query","tolist"],"answer_count":4,"favorite_count":2,"up_vote_count":13,"down_vote_count":0,"view_count":200,"score":13,"question_id":13250561,"title":"Does foreach execute the query only once?","body":"<p>I have a list of items and a LINQ query over them. Now, with LINQ's deferred execution, would a subsequent foreach loop execute the query only once or for each turn in the loop?</p>\n\n<p>Given this example (Taken from <a href=\"http://msdn.microsoft.com/en-us/library/bb397906.aspx\">Introduction to LINQ Queries (C#), on MSDN</a>)</p>\n\n<pre><code>    // The Three Parts of a LINQ Query: \n    //  1. Data source. \n    int[] numbers = new int[7] { 0, 1, 2, 3, 4, 5, 6 };\n\n    // 2. Query creation. \n    // numQuery is an IEnumerable&lt;int&gt; \n    var numQuery =\n        from num in numbers\n        where (num % 2) == 0\n        select num;\n\n    // 3. Query execution. \n    foreach (int num in numQuery)\n    {\n        Console.Write(\"{0,1} \", num);\n    }\n</code></pre>\n\n<p>Or, in other words, <strong>would there be any difference if I had</strong>:</p>\n\n<pre><code>    foreach (int num in numQuery.ToList())\n</code></pre>\n\n<p>And, would it matter, if the underlying data is not in an array, but in a Database?</p>\n"},{"tags":["c#","linq","linq-to-sql","pagination"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13249947,"title":"Getting Paged Data Using LINQ","body":"<p>I am implementing paging using LINQ, and i was thinking about the performance issues that i could encounter. Lets say i have a page size of 10 and i have 100 records in a table.\nIf i were to use the following </p>\n\n<pre><code>var myList = _dataContext.Person.Skip(PageNumber * PageSize).Take(10);\n</code></pre>\n\n<p>it will get me the data i want. now if i were to take this scenario, and apply it to 1,000,000 records. will this affect the performance? Would it be much more worth using an sql stored procedure, performance wise?</p>\n"},{"tags":["c#","sql","sql-server","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":88,"score":3,"question_id":13249220,"title":"Using text SQL with LINQ","body":"<p>I'm currently having issues with using LINQ to SQL for my project. This is because most of the lengthy SQL queries (or <em>views</em>, rather) are hard-coded into C#, and what we've been doing all along is to use <code>context.Database.SqlQuery&lt;ClassName&gt;(sql, sqlParams)</code>.</p>\n\n<p>It's been generally very effective, but right now we need something more dynamic. We need to plug in stuff like <code>.Where(x =&gt; x.Name.Contains(\"Anonymous\")).Take(20)</code> or something else along the lines. However, plugging in directly to the previously mentioned line of code would result in the following:</p>\n\n<p><code>context.Database.SqlQuery&lt;ClassName&gt;(sql, sqlParams).Where(x =&gt; x.Name.Contains(\"Anonymous\")).Take(20);</code></p>\n\n<p>While it actually works and pulls the top 20 records where the name contains \"Anonymous\", the performance is pretty bad. What it does behind the scenes is to take all the records from that table and then finally filtering them after having loaded them to memory.</p>\n\n<p>I would then like to ask, is there any way to translate the text SQL to LINQ, or translate the LINQ to SQL, such that I can execute both my text SQL and LINQ in one single statement. If you don't actually have a solution, I'd gladly appreciate suggestions too...!</p>\n\n<p><strong>EDIT:</strong> I've considered using Expression Trees, but I'm not sure how they can actually fit into the picture. Also, I've considered using database views. But there are so many views (quite a number per table) it would definitely be a hassle to port everything over to MS SQL and then rewriting all the querying logic.</p>\n"},{"tags":["c#",".net","linq","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":93,"score":3,"question_id":13249515,"title":"Linq: Getting missing records","body":"<p>So heres my case i got 2 tables one with Languages one with Resources and what i want to do is to find all Resources that is missing on each language...</p>\n\n<p>The default language i wanna go after is languageId = 1</p>\n\n<p><strong>Table \"Resources\"</strong></p>\n\n<pre><code>Id    Key    Value    LanguageId\n1     k1     test     1\n2     k1     test     2\n3     k1     test     3\n</code></pre>\n\n<p><strong>Table \"Languages\"</strong></p>\n\n<pre><code>Id   \n1\n2\n3\n4\n5\n6\n7\n</code></pre>\n\n<p>language contains about 10 rows of languages.</p>\n\n<p>Now what i wanna do is to take out those resources that dosent exists \n<strong>(ex results)</strong></p>\n\n<pre><code>Key   Value   LanguageId\nk1    test    1\nk1    test    2\nk1    test    3\nk1    null    4\nk1    null    5\nk1    null    6\nk1    null    7\n</code></pre>\n\n<p>Any suggestions how to solve this problem, ive tried with GroupJoin And SelectMany but no good results.</p>\n"},{"tags":["c#",".net","linq","generics","lambda"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13249206,"title":"Check property type at runtime and give the same type to Generic lamda expression parameter T","body":"<p>I have some code snippet given as below:</p>\n\n<p>Want to resolve this conditation by checking the type at runtime.</p>\n\n<pre><code>PropertyInfo pi = type.GetProperty(\"propertyName\");\n\nvar expression = new Object(); // this give me error after expression runs!\n\n    // Want to resolve this conditation by checking the type at runtime.\n    if (pi.PropertyType == typeof(DateTime))\n            {\n               // Want to pass the generic type parameter which has a same type created at runtime by identifying the property type.\n                expression = BuildExpression&lt;T, DateTime&gt;(data, group.Member);\n            }\n\nprivate Func&lt;T, V&gt; BuildExpression&lt;T, V&gt;(IEnumerable&lt;T&gt; items, string propertyName)\n    {\n      Type type = typeof(T);\n      PropertyInfo pi = type.GetProperty(propertyName);\n      Type PropertyType = pi.DeclaringType;\n      var parameter = Expression.Parameter(typeof(T), propertyName);\n      var cast = Expression.TypeAs(parameter, pi.DeclaringType);\n      var getterBody = Expression.Property(cast, pi);\n      var exp = Expression.Lambda&lt;Func&lt;T, V&gt;&gt;(getterBody, parameter);\n      return exp.Compile();\n    }\n</code></pre>\n\n<p><strong>Problem:</strong>\nI have to write condition on type  I have to check the type of property by reflection and then have to build the expression.</p>\n\n<p><strong>What I want:</strong>\nI want to check the runtime time the Type of property and want to build runtime Generic paramter of that type which is same as a property type.</p>\n\n<p>Basically I want to remove the <code>If</code> condition <em>on type checking</em> and What I want is, the code should <code>automatically detect the property type</code> and pass the same type in <code>Generic parameter argument</code>, so that I don't have to check with all the types with <code>If</code> condition. Like for <code>string, decimal, double etc..</code></p>\n\n<p>Could you please do let me know that resolution as I want to check the <code>property</code> type at runtime and want to create <code>Generic parameter type</code> with the <em>same type as property has</em>.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","xml","linq","linq-to-xml"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13227217,"title":"Linq to XML not getting all nodes","body":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;OrdersReport Date=\"2012-08-01\"&gt;\n&lt;Returns&gt;\n      &lt;Amount&gt;\n        &lt;OrderId&gt;2&lt;/OrderId&gt;\n        &lt;OrderId&gt;3&lt;/OrderId&gt;\n        &lt;OrderId&gt;21&lt;/OrderId&gt;\n        &lt;OrderId&gt;23&lt;/OrderId&gt;\n      &lt;/Amount&gt;\n    &lt;/Returns&gt;\n&lt;/OrdersReport&gt;\n</code></pre>\n\n<p>This is the code I am trying to get OrderId:</p>\n\n<pre><code> var amount = doc.Descendants(\"Amount\")                         \n  .Select(y =&gt; new\n  {\n   OrderId = (int)y.Element(\"OrderId\")\n   });\nforeach (var r in amount)\n  {\n   Console.WriteLine(r.OrderId);\n  }\n\n Console.Read();\n</code></pre>\n\n<p>My output is:</p>\n\n<pre><code>2\n2\n</code></pre>\n"},{"tags":["linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":8163395,"title":"Date comparision","body":"<p>In linq, i write a query for date, which is between and in sql, in this case i am not getting dtata, when user enter same date in from date and to date the data is not displaying where as data is there for that particualr date in database.\nThis is my linq query.</p>\n\n<pre><code>    var result =  from MaterialStatus in materialRequistionEntities.Tbl_MatReq_NewItemReq_M\n                             join CurrentStatus in materialRequistionEntities.Tbl_StatusMaster_M on\n                             MaterialStatus.ReqCurStatus equals CurrentStatus.StatusId\n                             join Employee in materialRequistionEntities.Tbl_Emp_Master_M\n                              on MaterialStatus.Indentor equals Employee.EmpId\n                              where (MaterialStatus.CreatedOn &gt;= dt.Date &amp;&amp; MaterialStatus.CreatedOn &lt;= dt1.Date)\n                              select *****************\n</code></pre>\n"},{"tags":["c#",".net","linq","entity-framework","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13248360,"title":"Retrieving Data from database within the last 7 days using linq","body":"<p>I have a <code>view</code> with data and I need to retrieve data only from the last 7 days. I know there is a function for this if I was using sql query. but I'm using Linq. </p>\n\n<p>here is my code:</p>\n\n<pre><code>                try\n                {\n                var query = (from bwl in mg.BarcodeWithLocation\n                             select new\n                             {\n                                 RequestID = bwl.RequestID,\n                                 Barcode = bwl.Barcode,\n                                 adrid = bwl.AdrID,\n                                 name = bwl.Name,\n                                 street = bwl.Street,\n                                 houseno = bwl.HouseNo,\n                                 postal = bwl.Postal,\n                                 city = bwl.City,\n                                 country = bwl.Country,\n                                 latitudetxt = bwl.Latitude == \"\" ? \"Location Unknown\" : \"View Map Location\",\n                                 latitude = bwl.Latitude,\n                                 longitude = bwl.Longitude,\n                                 date = bwl.ReceivedDate\n                             });\n\n                this.Grid.DataSource = query;\n                this.Grid.DataBind();\n                }\n                catch (Exception exception)\n                {\n                      Console.WriteLine(\"ERROR in GetNoLocationScan() method. Error Message : \" + exception.Message);\n                }\n</code></pre>\n\n<p>can anyone tell me how I do this in Linq ?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13247001,"title":"Better code for avoiding one dictionary - Case Sensitivity Issue","body":"<p>I have following method to fill a dictionary with values from a data reader.  There can be case mismatches between the data-reader fields and properties passed to the method. In the following method I  am converting the properties to lowercase first to address this issue. This causes two dictionaries. Is there a better way to achieve this with one dictionary?</p>\n\n<pre><code>private Dictionary&lt;string, object&gt; FillDictionaryWithReaderValues(List&lt;string&gt; propertiesOfAllEntities, IDataReader reader)\n{\n   Dictionary&lt;string, object&gt; lowerCaseDictionary = new Dictionary&lt;string, object&gt;();\n   Dictionary&lt;string, object&gt; propertyResultList = new Dictionary&lt;string, object&gt;();\n\n   foreach (var item in propertiesOfAllEntities)\n   {\n      lowerCaseDictionary.Add(item.ToLower(), null);\n   }\n\n   for (int i = 0; i &lt; reader.FieldCount; i++)\n   {\n      lowerCaseDictionary[reader.GetName(i).ToLower()] = reader[i];\n   }\n\n   foreach (var item in propertiesOfAllEntities)\n   {\n      propertyResultList.Add(item, lowerCaseDictionary[item.ToLower()]);\n   }\n\n   return propertyResultList;\n}\n</code></pre>\n"},{"tags":["visual-studio-2010","linq","windows-phone-7","json.net","tombstone"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13241197,"title":"Error 'Newtonsoft.Json.Linq.JToken' cannot be serialized using TombstoneHelper","body":"<p>I ran into an issue where a certain page of my app would not restore from tombstoning.  Attempting to reach the app would just result in being put back at the home screen.</p>\n\n<p>Three lines were logged to the console during debugging:</p>\n\n<ul>\n<li>A first chance exception of type <code>System.Runtime.Serialization.InvalidDataContractException</code> occurred in <code>System.Runtime.Serialization.dll</code></li>\n<li>A first chance exception of type <code>System.Reflection.TargetInvocationException</code> occurred in <code>mscorlib.dll</code></li>\n<li>A first chance exception of type <code>System.Runtime.Serialization.InvalidDataContractException</code> occurred in <code>System.Runtime.Serialization.dll</code></li>\n</ul>\n\n<p>Then, I inspected <code>e.ExceptionObject.Message.ToString()</code> and saw this error:</p>\n\n<p><code>\"Type 'Newtonsoft.Json.Linq.JToken' cannot be serialized. Consider marking it with the DataContractAttribute attribute, and marking all of its members you want serialized with the DataMemberAttribute attribute.\"</code></p>\n\n<p>I'm using some <code>JObjects</code> and <code>JTokens</code> in the cs code for that page.  I'm particularly setting the binding values in a listbox to the values from those <code>JObjects</code>:</p>\n\n<pre><code>&lt;ListBox x:Name=\"list\" Height=\"600\" HorizontalContentAlignment=\"Stretch\"&gt;\n    &lt;!--SelectionChanged=\"list_SelectionChanged\"--&gt;\n    &lt;ListBox.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;StackPanel Orientation=\"Vertical\"&gt;\n                &lt;TextBlock Text=\"{Binding hline}\" FontSize=\"{StaticResource PhoneFontSizeMedium}\" TextWrapping=\"Wrap\" Width=\"474\" /&gt;\n                &lt;TextBlock Text=\"{Binding body}\" Margin=\"0,0,0,36\"  FontSize=\"{StaticResource PhoneFontSizeNormal}\" TextWrapping=\"Wrap\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ListBox.ItemTemplate&gt;\n&lt;/ListBox&gt;\n</code></pre>\n\n<p>Then in code:</p>\n\n<pre><code>var deserialized = Newtonsoft.Json.JsonConvert.DeserializeObject&lt;List&lt;Mydata&gt;&gt;(messagearray.ToString().Replace(\"&lt;br/&gt;\", \"\\n\"));\n\nlist.ItemsSource = deserialized;\n</code></pre>\n\n<p>For tombstoning, I'm just doing this:</p>\n\n<pre><code>protected override void OnNavigatingFrom(NavigatingCancelEventArgs e)\n{\n    this.SaveState(e);  // &lt;- first line\n}\n\nprotected override void OnNavigatedTo(NavigationEventArgs e)\n{\n    this.RestoreState();  // &lt;- second line\n}\n</code></pre>\n\n<p>Is there something I should be doing differently in order to be able to tombstone and survive?</p>\n"},{"tags":["c#","linq","json","deserialization","newtonsoft"],"answer_count":3,"favorite_count":12,"up_vote_count":26,"down_vote_count":0,"view_count":32695,"score":26,"question_id":4749639,"title":"deserializing JSON to .net object using NewtonSoft (or linq to json maybe?)","body":"<p>I know there a few posts about Newtonsoft so hopefully this isn't exactly a repeat...I'm trying to convert JSON data returned by Kazaa's API into a nice object of some kind</p>\n\n<pre><code>WebClient client = new WebClient();\nStream stream = client.OpenRead(\"http://api.kazaa.com/api/v1/search.json?q=muse&amp;type=Album\");\nStreamReader reader = new StreamReader(stream);\n\nList&lt;string&gt; list = Newtonsoft.Json.JsonConvert.DeserializeObject&lt;List&lt;string&gt;&gt;(reader.Read().ToString());\n\nforeach (string item in list)\n{\n    Console.WriteLine(item);\n}\n\n//Console.WriteLine(reader.ReadLine());\nstream.Close();\n</code></pre>\n\n<p>that JsonConvert line is just the most recent one I was trying...I'm not quite getting it and was hoping to eliminate some footwork by asking you guys.  I was originally trying to convert it into a Dictionary or something...and actually, I just need to snag a couple values in there so judging by the documentation, maybe Newtonsoft's Linq to JSON might be a better choice?  Thoughts/Links?</p>\n\n<p>Here is an example of the JSON return data:</p>\n\n<pre><code>{\n  \"page\": 1,\n  \"total_pages\": 8,\n  \"total_entries\": 74,\n  \"q\": \"muse\",\n  \"albums\": [\n    {\n      \"name\": \"Muse\",\n      \"permalink\": \"Muse\",\n      \"cover_image_url\": \"http://image.kazaa.com/images/69/01672812 1569/Yaron_Herman_Trio/Muse/Yaron_Herman_Trio-Muse_1.jpg\",\n      \"id\": 93098,\n      \"artist_nam e\": \"Yaron Herman Trio\"\n    },\n    {\n      \"name\": \"Muse\",\n      \"permalink\": \"Muse\",\n      \"cover_image_url\": \"htt p://image.kazaa.com/images/54/888880301154/Candy_Lo/Muse/Candy_Lo-Muse_1.jpg\",\n      \"i d\": 102702,\n      \"artist_name\": \"\\u76e7\\u5de7\\u97f3\"\n    },\n    {\n      \"name\": \"Absolution\",\n      \"permalink\": \" Absolution\",\n      \"cover_image_url\": \"http://image.kazaa.com/images/65/093624873365/Mus e/Absolution/Muse-Absolution_1.jpg\",\n      \"id\": 48896,\n      \"artist_name\": \"Muse\"\n    },\n    {\n      \"name\": \"Ab solution\",\n      \"permalink\": \"Absolution-2\",\n      \"cover_image_url\": \"http://image.kazaa.com/i mages/20/825646911820/Muse/Absolution/Muse-Absolution_1.jpg\",\n      \"id\": 118573,\n      \"artist _name\": \"Muse\"\n    },\n    {\n      \"name\": \"Black Holes And Revelations\",\n      \"permalink\": \"Black-Holes-An d-Revelations\",\n      \"cover_image_url\": \"http://image.kazaa.com/images/66/093624428466/ Muse/Black_Holes_And_Revelations/Muse-Black_Holes_And_Revelations_1.jpg\",\n      \"id\": 48813,\n      \"artist_name\": \"Muse\"\n    },\n    {\n      \"name\": \"Black Holes And Revelations\",\n      \"permalink\": \"Bla ck-Holes-And-Revelations-2\",\n      \"cover_image_url\": \"http://image.kazaa.com/images/86/ 825646911486/Muse/Black_Holes_And_Revelations/Muse-Black_Holes_And_Revelations_1 .jpg\",\n      \"id\": 118543,\n      \"artist_name\": \"Muse\"\n    },\n    {\n      \"name\": \"Origin Of Symmetry\",\n      \"permalink\": \"Origin-Of-Symmetry\",\n      \"cover_image_url\": \"http://image.kazaa.com/images/29/825646 912629/Muse/Origin_Of_Symmetry/Muse-Origin_Of_Symmetry_1.jpg\",\n      \"id\": 120491,\n      \"artis t_name\": \"Muse\"\n    },\n    {\n      \"name\": \"Showbiz\",\n      \"permalink\": \"Showbiz\",\n      \"cover_image_url\": \"http: //image.kazaa.com/images/68/825646182268/Muse/Showbiz/Muse-Showbiz_1.jpg\",\n      \"id\": 60444,\n      \"artist_name\": \"Muse\"\n    },\n    {\n      \"name\": \"Showbiz\",\n      \"permalink\": \"Showbiz-2\",\n      \"cover_imag e_url\": \"http://image.kazaa.com/images/50/825646912650/Muse/Showbiz/Muse-Showbiz_ 1.jpg\",\n      \"id\": 118545,\n      \"artist_name\": \"Muse\"\n    },\n    {\n      \"name\": \"The Resistance\",\n      \"permalink\": \"T he-Resistance\",\n      \"cover_image_url\": \"http://image.kazaa.com/images/36/825646864836/ Muse/The_Resistance/Muse-The_Resistance_1.jpg\",\n      \"id\": 121171,\n      \"artist_name\": \"Muse\"\n    }\n  ],\n  \"per_page\": 10\n}\n</code></pre>\n\n<p>--------------- Additional Info</p>\n\n<p>Did some more reading and found Newtonsoft's Linq to JSON is exactly what I wanted...using WebClient, Stream, StreamReader, and Newtonsoft..I can hit Kazaa for JSON data, extract a URL, download the file, and do it all in like 7 lines of code!  Love it</p>\n\n<pre><code>WebClient client = new WebClient();\nStream stream = client.OpenRead(\"http://api.kazaa.com/api/v1/search.json?q=muse&amp;type=Album\");\nStreamReader reader = new StreamReader(stream);\n\nNewtonsoft.Json.Linq.JObject jObject = Newtonsoft.Json.Linq.JObject.Parse(reader.ReadLine());\n\n// instead of WriteLine, 2 or 3 lines of code here using WebClient to download the file\nConsole.WriteLine((string)jObject[\"albums\"][0][\"cover_image_url\"]);\nstream.Close();\n</code></pre>\n"},{"tags":["c#","jquery","asp.net","sql-server","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":38,"score":-7,"question_id":13246476,"title":"How to generate Dynamic Checkboxes & data tables in Jquery mobile using LINQ?","body":"<p>my task is </p>\n\n<p>1) when our page loads, automatically should generate a check box list using data in SQL server tabled data.<br>\n 2) user will select some options from those checkbox list and clicks on submit button.</p>\n\n<p>3) then we have to display a table dynamically which gives details of those selected    names/options.</p>\n\n<p>for example we have student table.. on page load we will display the checkboxes of student names from table column. when we select some of those students names and click on ''get marks'' button second page should display a \"DATA TABLE\"  with name &amp; marks columns..</p>\n\n<p>this is all concept should work using</p>\n\n<p>1) c#</p>\n\n<p>2) LINQ</p>\n\n<p>3) Jquery Mobile</p>\n\n<p>4) Data Tables</p>\n\n<p>5) SQL Server (inbuilded in VS)</p>\n\n<p>6) Visual Studio 2012</p>\n\n<p>even i dnt knw what is .net.. and what are the operations to be done.. iam started learning just now.. but iam very confused..\nbut i want to just create a jquery mobile application..\nplease help me.. (if possible please provide me code because even i am not able to follow examples now.)</p>\n\n<p>ThnQ for helping me.</p>\n"},{"tags":["c#","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12932932,"title":"sort of the flow order","body":"<p>return test.ToList();</p>\n\n<p>sort of the flow order</p>\n"},{"tags":["c#","asp.net",".net","linq"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13211348,"title":"InsertOnSubmit - NullReferenceException","body":"<p>I have 2 models.</p>\n\n<p>AccountEntity</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Table(Name = \"Account\")]\n    public class AccountEntity\n    {\n        [Column(IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]\n        public int id { get; set; }\n        [Column(CanBeNull = false, Name = \"email\")]\n        public string email { get; set; }\n        [Column(CanBeNull = false, Name = \"pwd\")]\n        public string pwd { get; set; }\n        [Column(CanBeNull = false, Name = \"row_guid\")]\n        public Guid guid { get; set; }\n\n        private EntitySet&lt;DetailsEntity&gt; details_id { get; set; }\n        [Association(Storage = \"details_id\", OtherKey = \"id\", ThisKey = \"id\")]\n        public ICollection&lt;DetailsEntity&gt; detailsCollection { get; set; }\n    }\n</code></pre>\n\n<p>DetailsEntity</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Table(Name = \"Details\")]\n\n    public class DetailsEntity\n    {\n    public DetailsEntity(AccountEntity a) {\n        this.Account = a;\n    }\n\n    [Column(IsPrimaryKey = true, IsDbGenerated = true, DbType = \"int\")]\n    public int id { get; set; }\n\n    private EntityRef&lt;AccountEntity&gt; _account = new EntityRef&lt;AccountEntity&gt;();\n    [Association(IsForeignKey = true, Storage = \"_account\", ThisKey = \"id\")]\n    public AccountEntity Account { get; set; }\n}\n</code></pre>\n\n<p>Main</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code> using (Database db = new Database())\n {\n     AccountEntity a = new AccountEntity();\n     a.email = \"hahaha\";\n     a.pwd = \"13212312\";\n     a.guid = Guid.NewGuid();\n     db.Account.InsertOnSubmit(a);\n     db.SubmitChanges();\n }\n</code></pre>\n\n<p>that has relationhip AccountEntity &lt;- DetailsEntity (1-n)</p>\n\n<p>when I'm trying to insert a record an exception is thrown(NullReferenceException)</p>\n\n<p>cause: by EntitySet null</p>\n\n<p>please help me make it insert</p>\n\n<hr>\n\n<p>I have found problem at</p>\n\n<p>private EntitySet details_id { get; set; } this is properties </p>\n\n<p>this must be new instance if has no ref</p>\n\n<p>private EntitySet details_id = new EntitySet();</p>\n"},{"tags":["c#","linq","c#-4.0","linq-to-sql","asp.net-mvc-4"],"answer_count":3,"favorite_count":1,"up_vote_count":14,"down_vote_count":0,"view_count":1163,"score":14,"question_id":12404592,"title":"display it into the \"Table1\" table","body":"<p>Here are the methods mentioned above:</p>\n\n<pre><code>public IList&lt;tst&gt; testUsers()\n{\n    IList&lt;tst&gt; testUsers = _test.GetAll().ToList();\n    return test(test);\n}\n</code></pre>\n"},{"tags":["c#",".net","performance","linq"],"answer_count":5,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":229,"score":7,"question_id":8595258,"title":"Why the order of LINQ to objects methods counts","body":"<p>I read <a href=\"http://stackoverflow.com/questions/7499384/does-the-order-of-linq-functions-matter\">this</a> question's answers that explain the order of the LINQ to objects methods makes a difference. My question is why?</p>\n\n<p>If I write a LINQ to SQL query, it doesn't matter the order of the LINQ methods-<code>projections</code> for example:</p>\n\n<pre><code>session.Query&lt;Person&gt;().OrderBy(x =&gt; x.Id)\n                       .Where(x =&gt; x.Name == \"gdoron\")\n                       .ToList();\n</code></pre>\n\n<p>The expression tree will be transformed to a rational SQL like this:</p>\n\n<pre><code>  SELECT   * \n  FROM     Persons\n  WHERE    Name = 'gdoron'\n  ORDER BY Id; \n</code></pre>\n\n<p>When I Run the query, SQL query will built according to the expression tree no matter how weird the order of the methods.<br>\nWhy it doesn't work the same with <code>LINQ to objects</code>?<br>\nwhen I enumerate an <em>IQueryable</em> all the projections can be placed in a rational order(e.g. Order By after Where) just like the Data Base optimizer does.</p>\n"},{"tags":["c#","linq","list"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":13241352,"title":"Convert loop to LINQ","body":"<p>A list of Equity Analytics (stocks) objects doing a calculation for daily returns.\nWas thinking there must be a pairwise solution to do this:</p>\n\n<pre><code>for(int i = 0; i &lt; sdata.Count; i++){\n    sdata[i].DailyReturn = (i &gt; 0) ? (sdata[i-1].AdjClose/sdata[i].AdjClose) - 1\n                                   : 0.0;\n}\n</code></pre>\n"},{"tags":["c#","sql","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13244052,"title":"Linq query using only year part of datetime","body":"<p>One of the column in my sqlserver table is datetime. In the where clause I have query just by the year (not month and date). I have to do it in LINQ using C#. Please let me know how could do it.</p>\n\n<p>For example if the following are the values in the table</p>\n\n<p>02/12/2010\n07/14/2011\n11/15/2012</p>\n\n<p>and if I query by '2011', only the middle row should be fetched.</p>\n\n<p>Thanks</p>\n"},{"tags":["linq","linq-to-sql","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":32,"score":-1,"question_id":13243218,"title":"IF statements inside linq query clause","body":"<p>I have written a LINQ query clause,But a error raise up.Can anyone help me out.Thanks in advance:</p>\n\n<pre><code>list = (from cr in dt.AsEnumerable()\nselect new Cards\n{\n   MemberNumber = cr.Field&lt;string&gt;(\"MemberNumber\"),\n   if( cr.Field&lt;int&gt;(\"CardState\")==0)\n   {\n          CardState =\"aaa\";\n   }\n   if( cr.Field&lt;int&gt;(\"CardState\")==1)\n   {\n     CardState =\"bbb\";\n   }\n   if( cr.Field&lt;int&gt;(\"CardState\")==2)\n   {\n      CardState =\"ccc\";\n   }\n  if( cr.Field&lt;int&gt;(\"CardState\")==3)\n  {\n     CardState =\"ddd\";\n  }\n  if( cr.Field&lt;int&gt;(\"CardState\")==4)\n  {\n    CardState =\"eee\";\n   }\n  }).ToList&lt;Cards&gt;();\n</code></pre>\n"},{"tags":["c#","linq","lambda","linq-to-objects"],"answer_count":4,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":1270,"score":10,"question_id":1466689,"title":"LINQ identity function?","body":"<p>Just a little niggle about LINQ syntax. I'm flattening an <code>IEnumerable&lt;IEnumerable&lt;T&gt;&gt;</code> with <code>SelectMany(x =&gt; x)</code>.</p>\n\n<p>My problem is with the lambda expression <code>x =&gt; x</code>. It looks a bit ugly. Is there some static 'identity function' object that I can use instead of <code>x =&gt; x</code>? Something like <code>SelectMany(IdentityFunction)</code>?</p>\n"},{"tags":["linq","entity-framework","linq-to-entities"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":146,"score":0,"question_id":9234265,"title":"LINQ to compare item in one list to any item in another","body":"<p>i wonder if someone could help me... Is there a LINQ query that will return a bool if any item from one IList&lt;> is contained int another IList&lt;>. These IList&lt;>'s are object and i need to compare one a single property of the object, the \"Name\" property in this case?</p>\n\n<p>Is there a LINQ query that can do this? If so could someone show me the correct implementation?</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":31,"score":1,"question_id":13241934,"title":"linq to entities cannot convert type Icollection to type List","body":"<p>I'm using Entity Framework.\nI have the following entities:</p>\n\n<pre><code>public class Articolo\n{\n    ..\n    public virtual ICollection&lt;Fornitore&gt; Fornitori { get; set; }\n}\n\npublic class Fornitore\n{\n  ...\n   public virtual ICollection&lt;Articoli&gt; Articoli { get; set; }    }\n</code></pre>\n\n<p>the following code:</p>\n\n<pre><code>List&lt;Fornitore&gt; result = new List&lt;Fornitore&gt;();\nvar r = zefiroContext.Articoli.Where(p =&gt; p.Id == IdArticolo).Select(p =&gt; p.Fornitori).ToList();\nresult = r;\n</code></pre>\n\n<p>gives a compiler error:</p>\n\n<blockquote>\n  <p>Cannot implicitly convert type 'System.Collections.Generic.List &lt;\n  System.Collections.Generic.ICollection &lt; prova2.Model.Fornitore>>' to\n  'System.Collections.Generic.List &lt; prova2.Model.Fornitore>'</p>\n</blockquote>\n\n<p>how can I get my <code>List &lt; Fornitore &gt;</code> ?</p>\n"},{"tags":["c#",".net","linq","linq-to-sql","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13087823,"title":"Attach newly created element in LINQ for deleting","body":"<p>I have a grid and dataset object connected with it.\nAnd datalayer working with LINQ. So I need to delete elements that was deleted in grid from LINQ data source.</p>\n\n<p>I have a method that convert my DataRow item to LINQ item. For example:</p>\n\n<pre><code>DataRow forDelete = ...;\nLinqItem itemForDelete = ConvertFromDataRow(forDelete);\ndataContext.DeleteOnSubmit(itemForDelete);\n</code></pre>\n\n<p>this code throw an exception, that imposible to delete item who is not attached to table.\nBut if I change it to</p>\n\n<pre><code>DataRow forDelete = ...;\nLinqItem itemForDelete = ConvertFromDataRow(forDelete);\ndataContext.Attach(itemForDelete)\ndataContext.DeleteOnSubmit(itemForDelete);\n</code></pre>\n\n<p>than it will throw exception that it's impossible to attach item, which already exist.</p>\n\n<p><strong>Question will be how to attach an item properly in that case. That should solve the problem.</strong></p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13238758,"title":"Add a where clause specific to an included Entity","body":"<p>My data model has a number of tables with a common parent. I am using Entity Framework and have a navigation property from the child object back to the parent, and not the other way. The reason for this is there will be 100's of children of this common parent. The where criteria for every report will be the same, as an example:</p>\n\n<pre><code> crudEngine.Read&lt;ChildEntity&gt;()\n   .Include(parameters =&gt; parameters.ParentEntity)\n   .Where(parameter =&gt; parameter.ParentEntity.LastUser.Contains(searchText) ||\n         (isInt &amp;&amp; SqlFunctions.DatePart(\"year\", parameter.ParentEntity.CreationDate) == intSearchText) ||\n         (isInt &amp;&amp; SqlFunctions.DatePart(\"month\", parameter.ParentEntity.CreationDate) == intSearchText) ||\n         (isInt &amp;&amp; SqlFunctions.DatePart(\"day\", parameter.ParentEntity.CreationDate) == intSearchText) ||\n         (isDate &amp;&amp; SqlFunctions.DateAdd(\"dy\", SqlFunctions.DateDiff(\"dy\", \"1900-01-01\", parameter.ParentEntity.CreationDate), \"1900-01-01\") == dateSearchText) ||\n         (isInt &amp;&amp; SqlFunctions.DatePart(\"year\", parameter.ParentEntity.LastModifiedDate) == intSearchText) ||\n         (isInt &amp;&amp; SqlFunctions.DatePart(\"month\", parameter.ParentEntity.LastModifiedDate) == intSearchText) ||\n         (isInt &amp;&amp; SqlFunctions.DatePart(\"day\", parameter.ParentEntity.LastModifiedDate) == intSearchText) ||\n         (isDate &amp;&amp; SqlFunctions.DateAdd(\"dy\", SqlFunctions.DateDiff(\"dy\", \"1900-01-01\", parameter.ParentEntity.LastModifiedDate), \"1900-01-01\") == dateSearchText) ||\n          parameter.ParentEntity.CreationUser.Contains(searchText) ||\n          parameter.ParentEntity.Description.Contains(searchText)...\n</code></pre>\n\n<p>This same criteria will be used for every child entity that references <code>ParentEntity</code>. If possible, I would like to somehow separate this where section into its own function like this:</p>\n\n<pre><code>private Predicate&lt;ParentEntity&gt; GetParentWhere(string searchText)\n    {\n        int intSearchText;\n        bool isInt = int.TryParse(searchText, out intSearchText);\n\n        DateTime dateSearchText;\n        bool isDate = DateTime.TryParse(searchText, out dateSearchText);\n\n        SubmissionStatus submissionStatus;\n        bool isStatus = Enum.TryParse(searchText, true, out submissionStatus);\n\n        return parent =&gt;                \n               (isInt &amp;&amp; SqlFunctions.DatePart(\"year\", parent.CreationDate) == intSearchText) ||\n               (isInt &amp;&amp; SqlFunctions.DatePart(\"month\", parent.CreationDate) == intSearchText) ||\n               (isInt &amp;&amp; SqlFunctions.DatePart(\"day\", parent.CreationDate) == intSearchText) ||\n               (isDate &amp;&amp; SqlFunctions.DateAdd(\"dy\", SqlFunctions.DateDiff(\"dy\", \"1900-01-01\", parent.CreationDate), \"1900-01-01\") == dateSearchText) ||\n               (isInt &amp;&amp; SqlFunctions.DatePart(\"year\", parent.LastModifiedDate) == intSearchText) ||\n               (isInt &amp;&amp; SqlFunctions.DatePart(\"month\", parent.LastModifiedDate) == intSearchText) ||\n               (isInt &amp;&amp; SqlFunctions.DatePart(\"day\", parent.LastModifiedDate) == intSearchText) ||\n               (isDate &amp;&amp; SqlFunctions.DateAdd(\"dy\", SqlFunctions.DateDiff(\"dy\", \"1900-01-01\", parent.LastModifiedDate), \"1900-01-01\") == dateSearchText) ||\n               parent.CreationUser.Contains(searchText) ||\n               parent.Description.Contains(searchText) ||\n               parent.LastUser.Contains(searchText) ||\n               (isStatus &amp;&amp; parent.Status == (int) submissionStatus);\n\n    }\n</code></pre>\n\n<p>Then call this from my code, something like this:</p>\n\n<pre><code>        return crudEngine.Read&lt;ChildEntity&gt;().Include(parameters =&gt; parameters.ParentEntity)\n                         .Where(GetParentWhere(searchText));\n</code></pre>\n\n<p>This doesn't work however because the Where expression is typed with the child type, not the parent. Any thoughts on how to accomplish this? </p>\n\n<p>Thanks!</p>\n"},{"tags":["linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13230022,"title":"Linq Index in Include","body":"<p>I write program in Linq To EF4\nI have in DataBase  \"Items\" Table that it FK to \"Company\" Table.<br>\nThere are also \"Address\" Table that it FK to \"Company\" Table &amp; to \"City\" Table.<br>\nI want to return Item include the he address &amp; City.<br>\nBut I canot write so:</p>\n\n<pre><code>var items = context.Items.Include(\"Company.Address[0].City\").ToList();\n</code></pre>\n\n<p>because the Include not get \"[ ]\"</p>\n"},{"tags":["c#",".net","linq","linq-to-objects"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13169951,"title":"Extension to choose which extension to use in Linq","body":"<p>Is it possible to choose which function to apply in Linq?<br>\nExample of what I now have:  </p>\n\n<pre><code>List&lt;int&gt; list = new List&lt;int&gt;();\nbool bDescend = false;\nvar listOrdered = bDescend ? list.OrderByDescending(it =&gt; it) : \n                             list.OrderBy(it =&gt; it);\n</code></pre>\n\n<p>You see that I choose which function to apply depending on bDescend value - so there is actually two Linq queries, not one.<br>\nIs it possible to avoid it by putting condition inside one query?\nMaybe something like  </p>\n\n<pre><code>list.ChooseFunction(bDescend ? OrderBy : OrderByDescending)...\n</code></pre>\n\n<p>Real code is more compliated and if such trick possible it would make code much more readable.<br>Looks like kind of metaprogramming..</p>\n"},{"tags":["c#",".net","linq","entity-framework","dynamic"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13233461,"title":"Dynamic conditions in Linq-to-Entities query","body":"<p>I'm trying to convert some old code that directly builds SQL queries to Entity Framework, and came across a problem that many seem to have (judging from the large number of questions surround that topic): how to express dynamic where conditions in linq.</p>\n\n<p>How could I express the following code with a linq query:</p>\n\n<pre><code>    switch (status) {\n        case \"0\":\n            sqlwhere = \" WHERE status &lt; 0 \";\n            break;\n        case \"-1\":\n            sqlwhere = \" WHERE status = -1 \";\n            break;\n        case \"-100\":\n            sqlwhere = \" WHERE status = -100 \";\n            break;\n        case \"1\":\n        default:\n            sqlwhere = \" WHERE status &gt;= 0 \";\n            break;\n    }\n\n    if (strsearch != \"\")\n        sqlwhere += \" AND desc LIKE '%\" + strsearch + \"%' \";\n\n    string sqlc = \"SELECT top 10 * FROM c \" + sqlwhere + \" order by date desc\";\n</code></pre>\n\n<p>I've read about <code>PredicateBuilder</code> and the dynamic Linq extensions in other posts, but I think that a simple case like could be solvable without external libraries.</p>\n\n<p>Using .net 4.5, EF 5.0, C#, can this be done in a \"dynamic\" way without building the complete linq statement for each single case?</p>\n"},{"tags":["sql","asp.net-mvc","linq","telerik"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13239333,"title":"Telerik MVC grid - sorting pre-sorted data on a per-page basis","body":"<p>I have a Telerik grid with paging enabled, at 100 items per page.  I want to sort only these 100 items, per page.</p>\n\n<p>This is my controller, it's returning pre-sorted data:</p>\n\n<pre><code>var listInflows = (from inf in db.CI_INFLOWS\n                                   orderby inf.InvoiceDt descending\n                                   select new InflowsGetModel\n                                   {\n                                     [omitted for brevity]\n</code></pre>\n\n<p>These is my Telerik settings:</p>\n\n<pre><code>.Sortable(sorting =&gt; sorting.OrderBy(so =&gt; so.Add(a =&gt; a.InvoiceDt).Ascending()))\n.Pageable(paging =&gt; paging.PageSize(100)\n                          .Style(GridPagerStyles.NextPreviousAndNumeric)\n                          .Position(GridPagerPosition.Top)\n         )\n</code></pre>\n\n<p>Here, I am telling the db to sort the data.  Then I want the 100-per-page displayed items to sort in the reverse order.  It's not behaving as expected.</p>\n"},{"tags":["linq","count","group-by","nested","having"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13238087,"title":"Linq to SQL Nested Select Group by Having count","body":"<p>I need convert query from sql to linq \nCreate Table History</p>\n\n<pre><code>CREATE TABLE [dbo].[History](\n    [HistoryID] [int] IDENTITY(1,1) NOT NULL,\n    [AuctionID] [int] NOT NULL,\n    [UserName] [nvarchar](128) NULL,\n    [Time] [datetime] NOT NULL,\n    [Price] [decimal](18, 2) NOT NULL,\n)\n</code></pre>\n\n<p>Query</p>\n\n<pre><code>select [UserName],[Price] from [History] \nwhere [Price] in \n    (SELECT [Price] FROM [History]  \n    where ID=28 GROUP BY [Price]\n    HAVING COUNT(*)=1) \n        Order by [Price]\n</code></pre>\n"},{"tags":["sql-server","asp.net-mvc","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13238522,"title":"SQL/Linq coding for a search feature in MVC app - best practice","body":"<p>I have a section of an ASP MVC app I building that displays an info sheet regarding a person, then there is a button which will allow the user to search the database, to see if this person is already in the database before saving the record.  If the record exists, then the feature needs to overwrite certain fields in the DB, kind of a 'search and merge/update'.  </p>\n\n<p>I am pretty sure this will go beyond my LINQ skills, so I am thinking of doing a stored proc, but I wanted to poll the masses to see what the accepted best practice is for something like this.</p>\n\n<p>Thank you for reading, and for your opinion.</p>\n"},{"tags":["linq","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13238361,"title":"Linq Cannot implicitity Convert DateTime,Double","body":"<p>I get the following:</p>\n\n<p>Cannot implicitly convert type <code>System.Collections.Generic.Dictionary&lt;System.DateTime?,double?&gt;</code> to <code>System.Collections.Generic.Dictionary&lt;System.DateTime,double&gt;</code> </p>\n\n<p>When I try to use a stored procedure within Entity Framework </p>\n\n<p>Here is the code that I have:</p>\n\n<pre><code>    private Dictionary&lt;DateTime, double&gt; GetData(string columnName)\n    {\n        return db.SysReading(columnName, Convert.ToString(LocId)).\n            ToDictionary( a =&gt; a.DateCollected, a =&gt; a.ElementReading);\n\n    }\n</code></pre>\n\n<p>I am using a call to a Stored Procedure called SysReading. When I convert it to a dictionary, the return type is nullable which I do not want. </p>\n"},{"tags":["c#","linq","iequalitycomparer"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13233747,"title":"Using IEqualityComparer to find records","body":"<p>I'm using the following IEqualityComparer to strip special characters from a company name before comparison as follows:</p>\n\n<pre><code> public class CompanyNameIgnoringSpaces : IEqualityComparer&lt;LeadGridViewModel&gt;\n    {\n        public bool Equals(LeadGridViewModel x, LeadGridViewModel y)\n        {\n            var delimiters = new[] {' ', '-', '*', '&amp;', '!'};\n            return delimiters.Aggregate(x.CompanyName ?? String.Empty, (c1, c2) =&gt; c1.Replace(c2, '\\0')) \n                == delimiters.Aggregate(y.CompanyName ?? String.Empty, (c1, c2) =&gt; c1.Replace(c2, '\\0'));\n        }\n\n        public int GetHashCode(LeadGridViewModel obj)\n        {\n            var delimiters = new[] {' ', '-', '*', '&amp;', '!'};\n            return delimiters.Aggregate(obj.CompanyName ?? String.Empty, (c1, c2) =&gt; c1.Replace(c2, '\\0')).GetHashCode();\n        }\n    }\n</code></pre>\n\n<p>In order to call this when running a query, I use the following:</p>\n\n<pre><code>var results = result\n                  .GroupBy(c =&gt; c, new CompanyNameIgnoringSpaces())\n                  .Select(g =&gt; new LeadGridViewModel\n                  {\n                      LeadId = g.First().LeadId,\n                      Qty = g.Count(),\n                      CompanyName = g.Key.CompanyName,\n                  }).OrderByDescending(x =&gt; x.Qty).ThenBy(x =&gt; x.CompanyName).ToList();\n</code></pre>\n\n<p>How would I use this comparer in a LINQ query in order to find all records which match the input string (company name)?</p>\n\n<p>For example:</p>\n\n<pre><code> public List&lt;LeadGridViewModel&gt; AllByName(string name, int company)\n        {\n\n            var result = (from t1 in db.Leads\n                          where\n                              t1.Company_ID == company &amp;&amp; t1.Company_Name == name...\n</code></pre>\n\n<p>So instead of using t1.Company_Name == name, I'd like to use use the equality comparer for this to include the special character replacement.</p>\n"},{"tags":["linq","generics","reflection","predicate","predicatebuilder"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13237382,"title":"Comparing against child property in generic/dynamic linq predicate with reflection","body":"<p>I am having to generically build a comparative predicate for an Entity Framework Linq query.  I'm using reflection and am able to build a single level Lambda expression without any trouble.  However where I am starting to get stuck is I have an Entity that has a relationship</p>\n\n<pre><code>public class Parent {\n    public virtual Child child { get; set; }\n    .... Other Stuff...\n}\n\npublic class Child {\n    public int property { get; set; }\n    public virtual Parent parent { get; set; }\n    .... Other Stuff.....\n}\n</code></pre>\n\n<p>How can I can I pass in \"Child.property\" into Reflection to be able to create a lambda expression comparing and come up with a lambda expression similar to item => item.Child.property == value?</p>\n"},{"tags":["c#",".net","sql","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13236919,"title":"Querying highest value by keys from database","body":"<p>With the following table:</p>\n\n<pre><code>+-------------+-----------+---------+\n|  Parent_ID  |  Item_ID  |  Count  |\n+-------------+-----------+---------+\n|      1      |     1     |    1    |\n|      1      |     1     |    5    |\n|      1      |     1     |    4    |\n|      1      |     2     |    7    |\n|      1      |     2     |    2    |\n|      2      |     1     |    2    |\n|      2      |     1     |    3    |\n|      2      |     2     |    2    |\n|      2      |     2     |    4    |\n+-------------+-----------+---------+\n</code></pre>\n\n<p>I would like to get the highest available count for given <code>Parent_ID</code> and <code>Item_ID</code>, like the following:</p>\n\n<pre><code>+-------------+-----------+---------+\n|  Parent_ID  |  Item_ID  |  Count  |\n+-------------+-----------+---------+\n|      1      |     1     |    5    |\n|      1      |     2     |    7    |\n|      2      |     1     |    3    |\n|      2      |     2     |    4    |\n+-------------+-----------+---------+\n</code></pre>\n\n<p><strong>How would I go about doing this using LINQ/SQL in C#?</strong> For example, I would like the highest item counts for parent id 1.  This would be something like:</p>\n\n<pre><code>int parentId = 1;\nvar counts = from c in database.Items where parentId == c.parentId \n//this gets all counts from items for parent id 1, but I am just looking\n//for the highest count per item for parent id 1\n</code></pre>\n"},{"tags":["c#","linq","entity-framework","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":186,"score":4,"question_id":1975556,"title":"Linq - OrderBy the minimum value of two columns using lambda expressions?","body":"<p>I have an entity set that contains two DateTime properties. I want to order the set by the minimum value of the two properties. How can I do this with a lambda expression.</p>\n"},{"tags":[".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13233520,"title":"SubmitChanges() immediately followed by a stored procedure","body":"<p>When I'm executing a stored procedure after a <code>SubmitChanges()</code>, the stored procedure is executed before the <code>SubmitChanges()</code> is completed.</p>\n\n<p>The function is supposed to migrate data from another server (so there are a lot of inserts going on). First, I call a stored procedure that disables the triggers on the given tables, then I do the inserts, then I enable the triggers again.</p>\n\n<p>The code looks like:</p>\n\n<pre><code>dc.DisableTriggers();    //Stored procedure (works fine)\n//... Procedure to insert all the data in the DataContext\ndc.MyClass.InsertOnSubmit(myClass);\n//...\ndc.SubmitChanges();      //All the data is inserted into tables.\ndc.EnableTriggers();     //Stored procedure (triggers are enabled before the end of all inserts)).\n</code></pre>\n\n<p><br />\nStored procedure:<br /></p>\n\n<pre><code>//DisableTriggers\nDisable trigger [triggerName] on tableName;    //Disabling on 5 tables\n\n//EnableTriggers\nEnable trigger [triggerName] on tableName;     //same tables as DisableTriggers\n</code></pre>\n\n<p><br />\nIf I put a breakpoint after <code>SubmitChanges()</code> and wait a second before restarting, everything works fine.</p>\n\n<p>If I set a timer after <code>SubmitChanges()</code>, triggers are enabled before the end of all inserts.</p>\n\n<p>I did some testing and if I bind the <code>SubmitChanges()</code> on a button and the <code>dc.EnableTriggers()</code> on another button, everything works fine.</p>\n\n<p>Unfortunately, I would need it to be all automated.</p>\n\n<p>I am using C# .net 4.0.</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":51,"score":3,"question_id":13232256,"title":"Linq GroupBy and Lookup<TKey, TElement>.Item","body":"<p>I'm using LINQ in C@ </p>\n\n<p>This code result in <code>dates</code> of type <code>Lookup&lt;TKey, TElement&gt;</code></p>\n\n<pre><code>   var dates = timetableEvents.GroupBy(x =&gt; x.DateTimeStart);\n</code></pre>\n\n<p>I need instead just a list of DateTimeStart (of type DateTime).</p>\n\n<p>How should I change my LINQ expressions? I do not know where to start!</p>\n"},{"tags":["c#",".net","linq","include"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13233924,"title":"How to include sorted navigation properties with Entity Framework","body":"<p>I have an entity <code>A</code> with a collection of <code>B</code> inside. I load them with a <code>_entity.A.Include(a =&gt; a.B)</code></p>\n\n<p>Now I want to have the B's into A sorted by a custom OrderBy. I tried <code>_entity.A.Include(a =&gt; a.B.OrderBy(o =&gt; o.Version)</code> but I get a :</p>\n\n<blockquote>\n  <p>The Include path expression must refer to a navigation property defined on the type. Use dotted paths for reference navigation properties and the Select operator for collection navigation properties.</p>\n</blockquote>\n\n<p>Any ideas on how to accomplish this?</p>\n\n<p>Thanks.</p>\n\n<p>Version is an integer.</p>\n"},{"tags":["c#","linq","duplicates"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13231917,"title":"Detecting \"near duplicates\" using a LINQ/C# query","body":"<p>I'm using the following queries to detect duplicates in a database.</p>\n\n<p>Using a LINQ join doesn't work very well because Company X may also be listed as CompanyX, therefore I'd like to amend this to detect \"near duplicates\".</p>\n\n<pre><code>var results = result\n                .GroupBy(c =&gt; new {c.CompanyName})\n                .Select(g =&gt; new CompanyGridViewModel\n                    {\n                        LeadId = g.First().LeadId,\n                        Qty = g.Count(),\n                        CompanyName = g.Key.CompanyName,\n                    }).ToList();\n</code></pre>\n\n<p>Could anybody suggest a way in which I have better control over the comparison? Perhaps via an IEqualityComparer (although I'm not exactly sure how that would work in this situation)</p>\n\n<p><strong>My main goals are:</strong></p>\n\n<ol>\n<li>To list the first record with a subset of all duplicates (or \"near duplicates\")</li>\n<li>To have some flexibility over the fields and text comparisons I use for my duplicates.</li>\n</ol>\n"},{"tags":[".net","sql","linq"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":155,"score":5,"question_id":5226928,"title":"Is it possible to see the SQL query of a LINQ command?","body":"<p>It would help me understand LINQ a little bit better that's all.</p>\n\n<p>I tried using the SQL Profiler but I'm not sure how I can get it to show the actual SQL commands.</p>\n"},{"tags":["c#","linq","asp.net-mvc-4",".net-4.5","entity-framework-5"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13232235,"title":"DbGeometry makevalid?","body":"<p>I'm new to this. I don't know how to use the SqlSpatialFunction MakeValid.\nI have a DbGeometry wich is a polygon. This polygon is not valid and i want's to \nmake it valid. </p>\n\n<p>Can anyone explain how to use the MakeValid method ?</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.data.objects.sqlclient.sqlspatialfunctions.makevalid.aspx\" rel=\"nofollow\">MSDN</a></p>\n\n<p>Thank you ! :D</p>\n"},{"tags":[".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13229048,"title":"Cross Type LINQ","body":"<p>I have the following code</p>\n\n<pre><code>    [Microsoft.VisualStudio.TestTools.UnitTesting.TestMethod]\n    public void TestEnumOfMaybe()\n    {\n        List&lt;Maybe&lt;int&gt;&gt; l = new List&lt;Maybe&lt;int&gt;&gt;();\n        l.Add(1.ToMaybe());\n        l.Add(Maybe.None&lt;int&gt;());\n        l.Add(3.ToMaybe());\n\n        var y = from x in l\n                from y in x\n                select y;\n\n    }\n</code></pre>\n\n<p>My Maybe type accepts all the Select and SelectMany methods to make it Linq compatible and I have tests to prove it so. However I can't seem to figure out a way to do cross type LINQ composition as in the above test case. The error I get is</p>\n\n<pre><code>expression of type 'FunctionalExtensions.Maybe&lt;int&gt;' is not allowed in\na subsequent from clause in a query expression with source type\n'System.Collections.Generic.List&lt;FunctionalExtensions.Maybe&lt;int&gt;&gt;'.  \n\nType inference failed in the call to 'SelectMany'.\nFunctionalExtensions*\n</code></pre>\n\n<p>Is there a way to combine the two LINQ types or am I out of luck here? The complete Maybe.cs implementation is at</p>\n\n<p><a href=\"https://gist.github.com/4016243\" rel=\"nofollow\">https://gist.github.com/4016243</a></p>\n"},{"tags":["c#","linq",".net-3.5","lambda"],"answer_count":4,"favorite_count":6,"up_vote_count":14,"down_vote_count":0,"view_count":16336,"score":14,"question_id":1183403,"title":"How to get distinct instance from a list by Lambda or LINQ","body":"<p>I have a class like this:</p>\n\n<pre><code>class MyClass&lt;T&gt; {\n    public string value1 { get; set; }\n    public T objT { get; set; }\n}\n</code></pre>\n\n<p>and a list of this class. I would like to use .net 3.5 lambda or linq to get a list of MyClass by distinct value1. I guess this is possible and much simpler than the way in .net 2.0 to cache a list like this:</p>\n\n<pre><code>List&lt;MyClass&lt;T&gt;&gt; list; \n...\nList&lt;MyClass&lt;T&gt;&gt; listDistinct = new List&lt;MyClass&lt;T&gt;&gt;();\nforeach (MyClass&lt;T&gt; instance in list)\n{\n    // some code to check if listDistinct does contain obj with intance.Value1\n    // then listDistinct.Add(instance);\n}\n</code></pre>\n\n<p>What is the lambda or LINQ way to do it?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13231500,"title":"LINQ query optimization: specifically, does position of let clauses matter?","body":"<p>I'm interested in the compilation and optimization LINQ expressions and whether or not I need to carefull consider the order of let and where clauses in my expression.</p>\n\n<p>Here is example:</p>\n\n<pre><code>var query = \n    from record in Database.Table\n    let recordName = record.GetName()\n    let notUsed = UselessData()\n    let stuff = DoSomethingIntensiveWith(record)\n    where recordName == \"foobar\"\n    select stuff;\n\nforeach (string item in query) {\n    Console.WriteLine(\"item =&gt; '{0}'\", item);\n}\n</code></pre>\n\n<p>Questions/assumptions:</p>\n\n<ul>\n<li><code>record.GetName()</code> must be resolved in order to execute the <code>where</code>\nclause.</li>\n<li><code>notUsed</code> is never used in the expression, so will <code>UselessData()</code> get called\nat all?</li>\n<li><code>stuff</code> is only needed if <code>recordName</code> equals \"foobar\". Will\n<code>DoSomethingIntensiveWith()</code> be executed for every record or just records\nwhere <code>recordName</code> equals \"foobar\"?</li>\n</ul>\n\n<p>If I want to ensure <code>DoSomethingIntensiveWith()</code> is only called when \n<code>recordName</code> equals \"foobar\", do I need to position the <code>let</code> caluse after the\n<code>where</code> clause, as follows:</p>\n\n<pre><code>var query = \n    from record in Database.Table\n    let recordName = record.GetName()\n    let notUsed = UselessData()\n    where recordName == \"foobar\"\n    let stuff = DoSomethingIntensiveWith(record)\n    select stuff;\n\nforeach (string item in query) {\n    Console.WriteLine(\"item =&gt; '{0}'\", item);\n}\n</code></pre>\n\n<p>In the meantime, I'm going to play with some real code and the debugger. I'll\nreport back what I find.</p>\n"},{"tags":["c#","linq","duplicates"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":64,"score":5,"question_id":13230835,"title":"Detecting duplicate records, selecting only first and counting with LINQ/C#","body":"<p>I am looking for a little help with designing a query using C#/LINQ to meet the following requirements:</p>\n\n<p><strong>I have a list of companies:-</strong></p>\n\n<pre><code>Id  Name                Email       Address\n\n1   Company A         a@a.com       abc\n\n2   Company B         b@b.com       abc\n\n3   Company C         c@c.com       abc\n\n4   Company D         d@d.com       abc\n\n5   Company A         a@a.com       abc\n</code></pre>\n\n<p>My goal is to detect duplicate items based on two fields, in this example 'name' and 'email'.</p>\n\n<p>Desired output is a list of customers shown below:</p>\n\n<ol>\n<li>Duplicate customers shuold only be shown once </li>\n<li>The quantity of similar records should be shown.</li>\n</ol>\n\n<p><strong>Desired duplicate list:-</strong></p>\n\n<pre><code>Id  Qty Name        Email       Address\n\n1   2   Company A       a@a.com     abc (Id/details of first)\n\n2   1   Company B       b@b.com     abc\n\n3   1   Company C       c@c.com     abc\n\n4   1   Company D       d@d.com     abc\n</code></pre>\n"},{"tags":["c#","windows","linq","registry"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13200070,"title":"Using LINQ to construct Dictionary for easily accessing registry keys for installed programs","body":"<p>The <code>SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall</code> key of the Windows registry consists of a subset of keys, one for each installed program. The key names for each program are helpfully named an apparently random string, making locating the registry key for a given program simple and easy (not!). The <code>DisplayName</code> value of the registry key contains the name of the program. I'd like to construct a dictionary (<code>Dictionary&lt;string, RegistryKey&gt;</code>) using LINQ that, for each registry key, maps the <code>DisplayName</code> value to the registry key itself. Any suggestions on how to do this?</p>\n\n<p>In the meantime I'm going read up on <a href=\"http://msdn.microsoft.com/en-us/library/bb384065%28v=vs.100%29.aspx\" rel=\"nofollow\">LINQ</a> and see if I can figure out the solution - it's the first time I've really considered using LINQ. I post my question here as I thought this might be a moderately common task and so others might benefit.</p>\n\n<p>Tip: <code>Microsoft.Win32.Registry</code> is the class to use to access the Windows registry.</p>\n"},{"tags":["c#","linq"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13230468,"title":"Linq select object from list depending on objects attribute","body":"<p>I have a list of objects </p>\n\n<pre><code>class Answer\n{\n   bool correct;\n}\n\nList&lt;Answer&gt; Answers = new List&lt;Answer&gt;();\n</code></pre>\n\n<p>Is there a way in linq for me to select an object depending on its attribute?</p>\n\n<p>So far I have</p>\n\n<pre><code>Answer answer = Answers.Single(a =&gt; a == a.Correct);\n</code></pre>\n\n<p>But it does not work</p>\n"},{"tags":["c#","mysql","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":60,"score":-1,"question_id":13230268,"title":"How can I use Sum() in Linq?","body":"<p>How do I convert this statement into LINQ?</p>\n\n<pre><code>SELECT Sum(Balance) FROM account WHERE name='stocks' AND userid=290;\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":52,"score":-7,"question_id":13229840,"title":"How to convert this T-Sql to linq","body":"<p>i write this tsql Query </p>\n\n<pre><code>((SELECT Id,[Mesc]\n      ,[Line]\n      ,[Unit]\n      ,[Discription]\n      ,[InvQty]\n      ,[LastDateNil]\n      ,[StCode]\n      ,[PlanCode]\n      ,[MIN]\n      ,[MAX]\n      ,[LastDateConsum]\n      ,[PbsNo]\n      ,[PbsDate]\n      ,[PbsQty]\n      ,[PbsQtyRec]\n      ,[DateDelay]\n      ,[TypeRequest]\n      ,[HeaderId]\n  FROM [MyMaterialDB].[dbo].[Report2]\n  WHERE headerid IN(SELECT HeaderId FROM [MyMaterialDB].[dbo].[Report2] WHERE line='I'))\n\n  Order by Mesc,Line,unit\n</code></pre>\n\n<p>i want convert this to linq, but i'm biginet in linq, please help me. thanks all.</p>\n"},{"tags":["c#","linq","substring"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13228668,"title":"LINQ to get sub-array","body":"<p>I have a <code>byte[]</code> and I want to extract a portion of the array and convert it to a string.  I want to use LINQ and to do it in one line.  This was the best I could find, but it fails me.</p>\n\n<pre><code>String id = new String(payload.Skip(60).Take(92-60+1).ToString());\n</code></pre>\n\n<p>to extract payload[60] to payload[92] and convert it to a string.  Is there a better way?  And I'm getting some errors with this syntax still..</p>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":13,"favorite_count":191,"up_vote_count":183,"down_vote_count":0,"view_count":101616,"score":183,"question_id":41244,"title":"Dynamic LINQ OrderBy","body":"<p>I found an example in the <a href=\"http://msdn2.microsoft.com/en-us/bb330936.aspx\" rel=\"nofollow\">VS2008 Examples</a> for Dynamic LINQ that allows you to use a sql-like string (e.g. OrderBy(\"Name, Age DESC\")) for ordering. Unfortunately, the method included only works on IQueryable&lt;T&gt;. Is there any way to get this functionality on IEnumerable&lt;T&gt;?</p>\n"},{"tags":["c#","linq","dictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13228077,"title":"how to use linq to get dictionary object's variable","body":"<p>I have an object </p>\n\n<pre><code>class foo {\n  public int bar;\n  public string s;\n}\n</code></pre>\n\n<p>that is in a dictionary</p>\n\n<pre><code>Dictionary&lt;String, foo&gt; mm = new Dictionary&lt;String, foo&gt;();\n</code></pre>\n\n<p>And I want to implmeent a method using LINQ to get all <code>values</code> of the dictonary and return a list of all the \"bar\" variables.  I figure this should be easy using linq, but i've not managed to fina relevant example. </p>\n\n<pre><code>public int[] getList() {\n  return mm.Values.bar &lt;- something like that but with linq\n}\n</code></pre>\n"},{"tags":["c#",".net","linq","sorting","collections"],"answer_count":3,"favorite_count":1,"up_vote_count":13,"down_vote_count":0,"view_count":312,"score":13,"question_id":13181498,"title":"Why is OrderBy which returns IOrderedEnumerable<T> much faster than Sort?","body":"<p>This is a follow up of this excellent question <a href=\"http://stackoverflow.com/questions/1832684/c-sharp-sort-and-orderby-comparison\">C# Sort and OrderBy comparison</a>. I will use the same example: </p>\n\n<pre><code>List&lt;Person&gt; persons = new List&lt;Person&gt;();\npersons.Add(new Person(\"P005\", \"Janson\"));\npersons.Add(new Person(\"P002\", \"Aravind\"));\npersons.Add(new Person(\"P007\", \"Kazhal\"));\n</code></pre>\n\n<p>The methods in contention are:</p>\n\n<pre><code>persons.Sort((p1, p2) =&gt; string.Compare(p1.Name, p2.Name, true));\n//and\npersons.OrderBy(n =&gt; n.Name);\n</code></pre>\n\n<p>Let me start by saying that I understand there isn't any significant performance difference to worry about. But I would love to know why does <code>OrderBy</code> perform so much better than <code>Sort</code>. I'm using the answer posted by @phoog in the original question.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    IEnumerable&lt;Person&gt; people;\n\n    BenchMark(persons =&gt; persons.Sort((p1, p2) =&gt; string.Compare(p1.Name, p2.Name, true)));\n\n    BenchMark(persons =&gt; people = persons.OrderBy(n =&gt; n.Name));\n}\n\nprivate static Random randomSeed = new Random();\npublic static string RandomString(int size, bool lowerCase)\n{\n    var sb = new StringBuilder(size);\n    int start = (lowerCase) ? 97 : 65;\n    for (int i = 0; i &lt; size; i++)\n    {\n        sb.Append((char)(26 * randomSeed.NextDouble() + start));\n    }\n    return sb.ToString();\n}\n\nprivate static void BenchMark(Action&lt;List&lt;Person&gt;&gt; action)\n{\n    List&lt;Person&gt; persons = new List&lt;Person&gt;();\n    for (int i = 0; i &lt; 10000; i++)\n    {\n        persons.Add(new Person(\"P\" + i.ToString(), RandomString(5, true)));\n    }\n    List&lt;Person&gt; unsortedPersons = new List&lt;Person&gt;(persons);\n\n    Stopwatch watch = new Stopwatch();\n    for (int i = 0; i &lt; 100; i++)\n    {\n        watch.Start();\n\n        action(persons);\n\n        watch.Stop();\n        persons.Clear();\n        persons.AddRange(unsortedPersons);\n    }\n\n    MessageBox.Show(watch.Elapsed.TotalMilliseconds.ToString());\n}\n</code></pre>\n\n<p><strong>Result:</strong> </p>\n\n<pre><code>Sort() =&gt; 3500 ~ 5000 ms\nOrderBy() =&gt; 0.2 ~ 1.5 ms\n</code></pre>\n\n<p>Though differences were profound even with smaller lists I tested initially, it became more and more glaring once the size of the collection went up. May be I'm missing something key to understanding .NET collections, but my thinking is since <code>Sort</code> acts on an existing <code>List&lt;T&gt;</code>, it should have lesser overhead (if every any) in processing when compared to <code>OrderBy</code> which acts on the same <code>List&lt;T&gt;</code> (in our case <code>persons</code>) but have to return another collection <a href=\"http://msdn.microsoft.com/en-us/library/bb534852.aspx\" rel=\"nofollow\"><code>IOrderedEnumerable&lt;T&gt;</code></a>. But still <code>OrderBy</code> performs far far better. <code>List&lt;T&gt;</code> might have certain overhead compared to <code>IEnumerable&lt;T&gt;</code> type, but <code>Sort</code> anyway acts on the existing list! Furthermore, I'm little amused to see a <code>Linq</code> method working faster than existing .NET method. </p>\n\n<p>All the answers in the original question compare <code>Sort</code> against <code>OrderBy.ToList</code> which I believe will have some overhead and therefore performs more or less equally. </p>\n\n<p>What could be the implementation differences?</p>\n\n<hr>\n\n<p><strong>Edit:</strong> Ok I learned something new. Here is how I confirmed about deferred execution.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    BenchMark(persons =&gt;\n    {\n        persons.Sort((p1, p2) =&gt; string.Compare(p1.Name, p2.Name, true));\n        foreach (var item in persons)\n        {\n            break;\n        }\n    });\n\n    BenchMark(persons =&gt;\n    {\n        IEnumerable&lt;Person&gt; people = persons.OrderBy(n =&gt; n.Name);\n        foreach (var item in people)\n        {\n            break;\n        }\n    });\n}\n</code></pre>\n\n<p><code>Sort</code> ran in 4000 - 5000ms while <code>OrderBy</code> ran just above 5000ms. So indeed my conclusion was wrong. Both of them performed on equal terms once I started to enumerate the collections. I prefer the syntax of <code>OrderBy</code> anyday :)</p>\n\n<p><strong>Edit 2:</strong> I just found that this is exact duplicate of <a href=\"http://stackoverflow.com/questions/10299464/why-is-array-sort-so-slow-compared-to-linq?lq=1\">this one</a>. But here is a <a href=\"http://stackoverflow.com/questions/10110013/order-of-linq-extension-methods-does-not-affect-performance\">more interesting question about deferred execution in general</a> though not about ordering altogether. </p>\n"},{"tags":["c#","linq","sorting","benchmarking"],"answer_count":4,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":1954,"score":9,"question_id":3334080,"title":"Why is List<>.OrderBy LINQ faster than IComparable+List<>.Sort in Debug mode?","body":"<p>I was interested in whether it would be faster to sort my classes using LINQ, or by implementing the IComparable interface and List.Sort. I was quite surprised when the LINQ code was faster.</p>\n\n<p>To do the test, I made a very simple class with the not-so-apt name of TestSort, implementing IComparable.</p>\n\n<pre><code>class TestSort: IComparable&lt;TestSort&gt;  {\n    private int age;\n    private string givenName;\n\n    public int Age {\n        get {\n            return age;\n        }\n        set {\n            age = value;\n        }\n    }\n\n    public string GivenName {\n        get {\n            return givenName;\n        }\n        set {\n            givenName = value;\n        }\n    }\n\n    public TestSort(int age, string name) {\n        this.age = age;\n        this.givenName = name;\n    }\n\n    public int CompareTo(TestSort other) {\n        return this.age.CompareTo(other.age);\n    }\n}\n</code></pre>\n\n<p>Then a simple program to sort it many times - the sort was much more expensive than copying the list, so the effect of that can be ignored.</p>\n\n<pre><code>class Program {\n    static void Main(string[] args) {\n        // Create the test data\n        string name = \"Mr. Bob\";\n\n        Random r = new Random();\n        var ts2 = new List&lt;TestSort&gt;();\n\n        for (int i = 0; i &lt; 100; i++) {\n            ts2.Add(new TestSort(r.Next(), name));\n        }\n\n        DateTime start, end;\n\n        // Test List&lt;&gt;.Sort\n        start = DateTime.Now;\n        for (int i = 0; i &lt; 100000; i++) {\n            var l = ts2.ToList();\n            l.Sort();\n        }\n        end = DateTime.Now;\n\n        Console.WriteLine(\"IComparable&lt;T&gt;: \");\n        Console.WriteLine((end - start).TotalMilliseconds);\n\n\n        // Test Linq OrderBy\n        start = DateTime.Now;\n        for (int i = 0; i &lt; 100000; i++) {\n            var l = ts2.ToList();\n            l = l.OrderBy(item =&gt; item.Age).ToList();\n        }\n        end = DateTime.Now;\n\n        Console.WriteLine(\"\\nLINQ: \");\n        Console.WriteLine((end - start).TotalMilliseconds);\n\n        Console.WriteLine(\"Finished.\");\n        Console.ReadKey();\n    }\n}\n</code></pre>\n\n<p>I was quite surprised to receive the following output:</p>\n\n<pre><code>IComparable&lt;T&gt;:\n2965.1696\n\nLINQ:\n2181.1248\n</code></pre>\n\n<p>Sometimes LINQ would go below 2000, and sometimes IComparable would go about 3000.</p>\n\n<p>When I tested it with a normal <code>List&lt;Int&gt;</code> the <code>List.Sort</code> was 1/4 the speed of LINQ, which remained at about 2000.</p>\n\n<p>So why is LINQ only about 66% the speed of the normal sort for my class? Am I doing something wrong with my implementation of IComparable?</p>\n\n<p><strong>Update:</strong>\nI just thought to try doing it in release mode, and yes, the results were different:</p>\n\n<pre><code>IComparable&lt;T&gt;:\n1593.0911\n\nLinq:\n1958.1119\n</code></pre>\n\n<p>But I am still very interested to know why IComparable is slower in debug mode.</p>\n"},{"tags":["linq","entity"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13225158,"title":"How to get conditional Include children entity and his related entity","body":"<p>The following code work for me:</p>\n\n<pre><code>var query0 = DB.Plan\n    .Include(\"UserCreate\")\n    .Include(\"UserUpdate\")\n    .Include(\"PlanTemplate\")\n    .Select(p =&gt; new\n            {\n                plan = p,\n                planItems = p.PlanItems.Where(pi =&gt; pi.IsCommited == true &amp;&amp; pi.IsLocked ==    false)\n            });\nvar query2 = query0.AsEnumerable().Where(m =&gt; m.planItems.Count() &gt; 0).Select(m =&gt; m.plan);\n</code></pre>\n\n<p>But the planItems related to another entities that I wanted,the following code do not work for me:</p>\n\n<pre><code>var query0 = DB.WorkEffortPlan\n.Include(\"UserCreate\")\n.Include(\"UserUpdate\")\n.Include(\"PlanTemplate\")\n.Select(p =&gt; new\n{\n    plan=p,\n    planItems = DB.PlanItem\n    .Include(\"UserResponsiblePerson\")\n    .Include(\"TemplateItem\")\n    .Include(\"ItemState\")\n    .Where(pi =&gt; pi.PlanID == p.PlanID &amp;&amp; pi.IsCommited == true &amp;&amp; pi.IsLocked == false)\n});\nvar query2 = query0.AsEnumerable().Where(m =&gt; m.planItems.Count() &gt; 0).Select(m =&gt; m.plan);\n</code></pre>\n\n<p>The vs compiler is run OK,but when exec this code,I get the NullReferenceException in query0.</p>\n\n<p>Is there any linq solution to get filtering children entity and his related entity?</p>\n"},{"tags":["c#","visual-studio-2010","linq","extraction","web-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13223708,"title":"Extraction Event","body":"<p>So I have the following code:</p>\n\n<pre><code>    public override void Extract(object sender, ExtractionEventArgs e)\n    {\n            if (e.Response.HtmlDocument != null)\n            {\n\n                var myParam = e.Request.QueryStringParameters.Where(parameter =&gt; parameter.Name == QueryName).Select(parameter =&gt; parameter.Value).Distinct();\n\n                myParam.\n\n                // add the extracted value to the web performance test context\n                e.WebTest.Context.Add(this.ContextParameterName, myParam.ToString());\n                e.Success = true;\n                return;\n\n            }\n\n\n        // If the extraction fails, set the error text that the user sees\n        e.Success = false;\n        e.Message = String.Format(CultureInfo.CurrentCulture, \"Not Found: {0}\", QueryName);\n    }\n</code></pre>\n\n<p>It's returning:</p>\n\n<pre><code>System.Linq.Enumerable+&lt;DistinctItem&gt;d_81`1[system.string]\n</code></pre>\n\n<p>I am expecting something along the lines of:</p>\n\n<pre><code>0152-1231-1231-123d\n</code></pre>\n\n<p>My question is how do I extract the querystring's actual value from <code>extractioneventargs</code>.  They say it's possible, but I have no idea.</p>\n"},{"tags":["c#","sql","linq","wildcard"],"answer_count":8,"favorite_count":6,"up_vote_count":9,"down_vote_count":0,"view_count":10005,"score":9,"question_id":1040380,"title":"Wildcard search for LINQ","body":"<p>I would like to know if it is possible to do a wildcard search using LINQ.</p>\n\n<p>I see LINQ has Contains, StartsWith, EndsWith, etc.</p>\n\n<p>What if I want something like %Test if%it work%, how do I do it?</p>\n\n<p>Regards</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":67,"score":0,"question_id":13219220,"title":"Complex Linq Query with casts","body":"<p>I have this SQL query and i need to write it in Linq :</p>\n\n<pre><code>select cast(year(changedate) as varchar) + '-' + cast(month(changedate) as varchar) as N'', \n        count(*) as N'',\n        (select count(*) from t_talmid where year(CreationDate) = year(changedate) and month(CreationDate)=month(changedate)) as N'',\n         cast(count(*) as int)*100  /  cast( (select count(*) from t_talmid where year(CreationDate) = year(changedate) and month(CreationDate)=month(changedate)) as int)   N' '\n\n from T_TalmidStatusHistory h\n    join T_talmid t on h.talmidid = t.talmidid \n    where t.talmidStatusID=16 and h.[statusid] != 16\n        and h.id =\n            (\n                select max(id) from T_TalmidStatusHistory \n                    where T_TalmidStatusHistory.talmidid=h.talmidid  and T_TalmidStatusHistory.[statusid] &lt;&gt; 16\n            )\n\n    group by year(changedate), month(changedate)\n    order by year(changedate) desc , month(changedate) desc \n</code></pre>\n\n<p>So far, I got this (it's the middle query) :</p>\n\n<pre><code>from r in db.T_TalmidStatusHistories\n                      join t in db.T_Talmids on r.TalmidID equals t.TalmidID\n                      where t.TalmidStatusID == 16 &amp;&amp; r.StatusID != 16 &amp;&amp; r.id == (db.T_TalmidStatusHistories\n                      .Where(m=&gt; (m.TalmidID  == r.TalmidID) &amp;&amp; (m.StatusID != 16))\n                      .OrderByDescending(tp =&gt; tp.id).FirstOrDefault().id)\n                      group r by r.ChangeDate into ga\n                      select new { date = ga.Key,amount = ga.Count() }).ToList();\n</code></pre>\n\n<p>My date is in the format of <code>dd-mm-yyyy</code>\nReally need help with this.</p>\n"},{"tags":["c#","sql","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":73,"score":0,"question_id":13218012,"title":"Linq query fails if the data is too big","body":"<p>I have the following linq query</p>\n\n<pre><code>var result=from cases in db.Cases\n           join cc in db.CaseConsents on cases.CaseID equals cc.CaseID into cc_join\n           from cc in cc_join.DefaultIfEmpty()\n           where cc.ConsentTypeID == null &amp;&amp; cc.MidwireEyeBankID == 1\n           &amp;&amp; !((from casedeterminations in db.CaseDeterminations\n           where casedeterminations.DeterminationTypeID == 5\n           select new { casedeterminations.CaseID })).Distinct().Contains(new { cases.CaseID })\n           &amp;&amp; !(from casedeterminations2 in db.CaseDeterminations\n           where\n               (new int[] { 3, 4 }).Contains(casedeterminations2.DeterminationID)\n           select new\n           {\n               casedeterminations2.CaseID\n               }).Distinct().Contains(new { cases.CaseID })\n           select cc;\n</code></pre>\n\n<p>If this part of the query returns more than <code>50000</code> records then the whole query returns no result </p>\n\n<pre><code>(from casedeterminations2 in db.CaseDeterminations\nwhere\n(new int[] { 3, 4 }).Contains(casedeterminations2.DeterminationID)\nselect new\n{\n    casedeterminations2.CaseID\n}).Distinct().Contains(new { cases.CaseID })\n</code></pre>\n\n<p>this is the SQL version of this Linq query</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select * from Cases\nleft outer join CaseConsent CC on CC.CaseID = Cases.CaseID \nwhere\nCases.CaseID NOT IN \n(SELECT distinct CaseID  FROM    CASEDETERMINATIONS WHERE   DETERMINATIONTYPEID = 5 )\nAND CC.ConsenttypeID IS NULL\nAND Cases.CaseID NOT IN \n( SELECT    CaseID FROM      CaseDeterminations WHERE     DeterminationID IN ( 3, 4 ) )\nAND Cases.MidwireEyeBankID = 1\n</code></pre>\n"},{"tags":["c#","winforms","linq","data-binding","charts"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":41,"score":-1,"question_id":13216367,"title":"How to bind data to a chart in LINQ?","body":"<p>I am trying to create a bar chart by using LINQ. and I want to name the X and Y axis dyna But I don't know how to do that. if some one can please </p>\n"},{"tags":["linq","aggregate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13216623,"title":"Order reversed in Aggregate LINQ query","body":"<p>I think the result should contain [1,1,2,2,3,3] but it contains [3,3,2,2,1,1]. Why is the list being reversed?</p>\n\n<pre><code>var sequence = new int[] { 1, 2, 3 };\nvar result = sequence.Aggregate(\n            Enumerable.Empty&lt;int&gt;(),\n            (acc, s) =&gt; Enumerable.Repeat(s, 2).Concat(acc));\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","monodroid","linq-to-objects"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":57,"score":-1,"question_id":13204131,"title":"Looking for a LINQ way to speed up a sort","body":"<p>I'm looking for a very quick way to sort a list using LINQ. Okay, that's not that hard, but here is the scenario (and some code)</p>\n\n<pre><code>public static List&lt;Info&gt; Distributer (List&lt;MInfo&gt; fromInfo)\n{\n    Dictionary&lt;string, CInfo&gt; toReturn = new Dictionary&lt;string, CInfo&gt; ();\n    for (int i = 0; i &lt; fromInfo.Count; i++) {\n        MInfo first = fromInfo [i];\n        Dictionary&lt;T, MInfo&gt; cMess = new Dictionary&lt;T, MInfo&gt; ();\n        cMess [first.Mess.MID] = fromInfo [i];\n        for (int j = i; j &lt; fromInfo.Count; j++) {\n            MInfo second = fromInfo [j];\n            if (first.Mess.MID != second.Mess.MID &amp;&amp; first.IsWith (second)) {\n                cMess [second.Mess.MID] = second;\n            }\n        }\n</code></pre>\n\n<p>IsWith returns true or false</p>\n\n<p>Effectively, this takes the List, takes the first item from fromInfo, and puts into cMess. It then iterates through the list, tests the condition and if it successed, passes it into the cMess.</p>\n\n<p>Now, for a really small list, this is probably not going to be too bad, but for a very large list, this isn't going to be too good.</p>\n\n<p>I've tried to recode this using Linq, but it's not really happening for me. Can this be written using Linq? The thing that stumped me was the iterations. Any help here would be appreciated.</p>\n\n<p>Paul</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13212680,"title":"Reusable LINQ query except for where clause","body":"<p>I've got a collection of movies which have various properties (title, release year, rating, etc) that I need to search for using a LINQ query as follows:</p>\n\n<pre><code>public BindingList&lt;Movie&gt; SearchByTitle(string title)\n{\n    var matches = from movies in movieCollection\n                  where movies.Title == title\n                  select movies;\n    // do some other stuff with the matches\n}\n</code></pre>\n\n<p>But I don't want a separate method to search for each property since the only thing that changes between searches is the <code>where</code> section. For example <code>where movies.Rating == rating</code> or <code>where movies.ReleaseYear == releaseYear</code>. How do I make the search method reusable for all different kinds of searches by passing in some sort of <code>Expression</code> or <code>Func</code> as the <code>where</code> section?</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13210817,"title":"Get attribute value from a tag Linq to XML","body":"<p>I'm using Linq to get some xml values, but this time I want to get the content of \"href\" attribute from  tag, which is like this: </p>\n\n<pre><code>&lt;link rel=\"alternate\" type=\"text/html\" href=\"Value I want to retrieve\"/&gt;\n&lt;link rel=\"alternate\" type=\"text/html\" href=\"Another Value want to retrieve\"/&gt;\n</code></pre>\n\n<p>any clues how to do that?</p>\n\n<p>I am able to get values of tags</p>\n\n<pre><code>&lt;title&gt;1st title&lt;/title&gt;\n&lt;title&gt;2nd title&lt;/title&gt;\n</code></pre>\n\n<p>this way:</p>\n\n<pre><code>IEnumerable&lt;XElement&gt; item = document.Descendants(xmlns + \"title\");\n// to print use: item.ElementAt&lt;XElement&gt;(0).Value;\n</code></pre>\n\n<p>But I failed to retrieve a value from the <code>href</code> attribute, any help is appreciated.</p>\n"},{"tags":["linq","dynamic","casting","anonymous-types","anonymous"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13195646,"title":"Use Linq.Dynamic or Expressions to create an new anonymous object","body":"<p>I've the following code:</p>\n\n<pre><code>public class C\n{\n  public string Field {get; set;}\n  public string Data {get; set;}\n}\n\nvar x = new C { Field = \"F\", Data = \"Data 1\" };\nvar y = new C { Field = \"G\", Data = \"Data 2\" };\n</code></pre>\n\n<p>And I want to cast this to an anonymous object like:</p>\n\n<pre><code>var x_a = new { F = \"Data 1\" };\nvar y_a = new { G = \"Data 2\" };\n</code></pre>\n\n<p>Note that the property name (F or G) is the content, so this can change dynamically. I'm currently using the System.Linq.Dynamic 'Select' method for this:</p>\n\n<pre><code>public static object CastToAnonymous(this C source)\n{\n  var objects = new List&lt;C&gt;(new [] {source}).AsQueryable().Select(\"new (Data as \" + source.Field + \")\") as IEnumerable&lt;object&gt;;\n  return objects.First();\n}\n</code></pre>\n\n<p><br/>I'm wondering if there is an easier way to achieve this?</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13209295,"title":"About data transfer one object to array through LINQ","body":"<pre><code>class A\n{\n   public string[] X {get;set;}\n   public string[] Y {get;set;}\n}\n\nclass B\n{\n  public string X {get;set;}\n  public string Y {get;set;}\n}\n</code></pre>\n\n<p>transfer data of A's object to B's array with Linq? suppose Object of A have 10-10 size X and Y and I want to transfer into B array <code>(B[] b = new B[10])</code></p>\n\n<pre><code>A a = new A();\n//put 10 items in both x and y\nB[] b = new B[10];\n//here I want to get a's data to b\n</code></pre>\n"},{"tags":["c#","linq","linq-to-objects","ordering","lambda-functions"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13207727,"title":"order by in lambda expressions","body":"<p>I'm trying to sort the data in lambda expression in the following case.</p>\n\n<pre><code>if (Directory.Exists(Server.MapPath(System.Configuration.ConfigurationManager.AppSettings[\"ErrorLogPath\"].ToString())))\n{\n    string path = Server.MapPath(System.Configuration.ConfigurationManager.AppSettings[\"ErrorLogPath\"].ToString());\n    // a.Select(p =&gt; Path.GetFileNameWithoutExtension(p));\n    var a = Directory.GetFiles(path);\n    if (a != null)\n    {\n        Session[\"gvData\"] = a.ToList();\n        BindDataToGrid();\n    }\n}\n</code></pre>\n\n<p>In <code>var</code> <code>a</code> i get list of complete path of files like </p>\n\n<pre><code>c:\\\\logfiles\\\\01022012.txt. \n</code></pre>\n\n<p>How can I get <code>var</code> <code>a</code> sorted on basis of <code>01022012</code>\nI tried  </p>\n\n<pre><code>var a = Directory.GetFiles(path).OrderBy(p=&gt;Path.GetFileNameWithoutExtension(p));\n</code></pre>\n\n<p>but not working. Is there any thing am I doing wrong?</p>\n\n<p>Getting result as </p>\n\n<pre><code>\"C:\\\\LogFiles\\\\01112012.txt\" \n\"C:\\\\LogFiles\\\\08102012.txt\" \n\"C:\\\\LogFiles\\\\14092012.txt\" \n\"C:\\\\LogFiles\\\\15102012.txt\" \n\"C:\\\\LogFiles\\\\17102012.txt\" \n\"C:\\\\LogFiles\\\\19092012.txt\" \n</code></pre>\n\n<p>Expected is </p>\n\n<pre><code>\"C:\\\\LogFiles\\\\14092012.txt\" \n\"C:\\\\LogFiles\\\\19092012.txt\" \n\"C:\\\\LogFiles\\\\08102012.txt\" \n\"C:\\\\LogFiles\\\\15102012.txt\" \n\"C:\\\\LogFiles\\\\17102012.txt\" \n\"C:\\\\LogFiles\\\\01112012.txt\" \n</code></pre>\n"},{"tags":[".net","vb.net","linq","system.reactive"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":60,"score":4,"question_id":13196159,"title":"LINQ with RX Extensions","body":"<p>I was under the impression that the LINQ query language worked for IObservable as it does for IEnumerable with the ReactiveExtensions. I have the following code</p>\n\n<pre><code>Public Sub Foo(source As IObservable(Of Tuple(Of Integer, Integer)))\n  Dim filtered = source.Where(Function(x) x.Item1 &gt; 10).Select(Function(x) x.Item1 + x.Item2)\n  Dim filtered2 = From x In source Where x.Item1 &gt; 10 Select x.Item1 + x.Item2\nEnd Sub\n\nPublic Sub Bar(source As IEnumerable(Of Tuple(Of Integer, Integer)))\n  Dim filtered = source.Where(Function(x) x.Item1 &gt; 10).Select(Function(x) x.Item1 + x.Item2)\n  Dim filtered2 = From x In source Where x.Item1 &gt; 10 Select x.Item1 + x.Item2\nEnd Sub\n</code></pre>\n\n<p>The code for the IEnumerable version is OK. However for the LINQ version of Foo ( second line )\nI get a late binding disallowed error on</p>\n\n<pre><code>x.Item1\n</code></pre>\n\n<p>When I hover over <strong>x</strong> the Intellisense says it is of type object instead of\ntype tuple. However the object query version of the same operation ( first line )\ncompiles ok. I've imported</p>\n\n<pre><code>Imports system.reactive.linq\n</code></pre>\n\n<p>Am I missing another reference?</p>\n"},{"tags":["asp.net-mvc","linq","sorting","jqgrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":516,"score":0,"question_id":10361567,"title":"Jqgrid Sorting not working","body":"<p>i created a jqgrid with this follwoing code and i succeeded creating jqgrid without sorting . so i modified the code , but it doesn't sort the data and showing the following error, </p>\n\n<pre><code>'firstName' could not be resolved in the current scope or context. Make sure that all referenced variables are in scope, that required schemas are loaded, and that namespaces are referenced correctly. Near simple identifier, line 6, column 1.\n</code></pre>\n\n<h2> Controlller</h2>\n\n<pre><code>public ActionResult GridData(string sidx, string sord, int page, int rows)\n    {\n        int pageIndex = Convert.ToInt32(page) - 1;\n        int pageSize = rows;\n        int totalRecords = db.customers.Count();\n        int totalPages = (int)Math.Ceiling((float)totalRecords / (float)pageSize);\n\n        var _Customers = db.customers.OrderBy(sidx + \" \" + sord).Skip(pageIndex * pageSize).Take(pageSize).ToArray();\n\n        var jsonData = new\n        {\n            total = (int)Math.Ceiling((float)totalRecords / (float)rows),\n            page = page,\n            records = totalRecords,\n            rows = (from r in _Customers.AsEnumerable()\n                    select new\n                    {\n\n                        id = r.id,\n                        cell = new[] { \"&lt;input type='radio' style='cursor:pointer' class='view_Account'  name='selectedCall'  id='\" + r.id + \"' value='\" + r.id + \"' /&gt;\", r.firstName, r.lastName }\n                    }\n                   ).ToArray()\n        };\n        return Json(jsonData, JsonRequestBehavior.AllowGet);\n\n    }\n</code></pre>\n\n<h2>View</h2>\n\n<pre><code>$(\"#list\").jqGrid({\n        url: '/Customer/GridData/',\n        datatype: 'json',\n        colNames: ['', 'FirstName', 'LastName'],\n        colModel: [\n        { name: 'ssss', width: 20, search: false },\n                    { name: 'firstName', sortable: true, sorttype: \"text\", searchoptions: { sopt: ['eq', 'ne'] }, width: 180 },\n                    { name: 'lastName', sortable: true, sorttype: \"text\", width: 183 }\n\n                ],\n        rowNum: 100,\n        width: '200px',\n        height: '100px',\n        sortname: 'firstName',\n        sortorder: \"asc\",\n        pager: jQuery('#pager')\n    });\n</code></pre>\n"},{"tags":["asp.net-mvc","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13205035,"title":"Passing query data from controller to view","body":"<p>I have been stuck on this problem for too long and would love some help. </p>\n\n<p>On a view people can select two items from two radiobutton lists which returns via a FormMethod.Get to the Index event in HomeController. </p>\n\n<p>These 2 values, 'parts and 'use' are queried to return a result and its passed back to the view via a viewbag. However the viewbag returns a line like { Item = Kona, Price = 400.0000, Quantity = 2 } in the view.</p>\n\n<p>Whereas I want to return each item such as item.Item, Item.Price so I can use them individually. </p>\n\n<p>I have tried everything I can find to no avail. \nAnonymous classes items also throw red errors </p>\n\n<p>View </p>\n\n<pre><code>foreach(var item in ViewBag.getstock)\n{ //Show it and then make a new line with the &lt;BR/&gt;\n    @item &lt; br / &gt;\n    //{ Item = Kona, Price = 400.0000, Quantity = 2 } \n}\n</code></pre>\n\n<p>HomeController</p>\n\n<pre><code> public ActionResult Index()\n {\n     //this returns the entire query string\n     ViewBag.querystring = Request.QueryString;\n\n     //if any keys are in the url from the view\n     if (Request.QueryString.HasKeys())\n     {\n         //extract them out so that you can use them\n         //key = the name such as Part or Use it goes Key &amp; Value this is passed to a Viewbag\n         //get(o) is getting the value at place 0, the first value in the url\n\n         ViewBag.querystringvalue0 = Request.QueryString.Get(0);\n         ViewBag.querystringvalue1 = Request.QueryString.Get(1);\n     }\n\n     //if there is any query string\n     if (Request.QueryString.HasKeys())\n     {\n         //pass the data to a couple of variables,\n         var parts = Request.QueryString.Get(0);\n         var use = Request.QueryString.Get(1);\n\n         //put them in a new query and return the results\n         ViewBag.getstock = from p in Bikeshopdb.Stocks\n         where p.PartName == parts &amp;&amp; (p.Road == use || p.Mtn == use || p.Hybrid == use) select new\n         {\n             p.Item, p.Price, p.Quantity\n         };\n\n     }\n     return View(Bikeshopdb.Stocks.ToList());\n</code></pre>\n"},{"tags":["c#","xml","linq","linq-to-xml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13203975,"title":"How to parse deeply nested using LINQ to XML","body":"<p>How do I parse the following XML using LINQ?<br>\nI need to insert into a database table <em>OrderNumber, ShipAddress, ShipCity, ShipState</em> for each <strong>Order</strong> &amp; <strong>OrderCancelled</strong>.<br>\nThen in a separate table I need to insert <em>OrderId</em> from the <strong>Returns/Amount</strong> section.</p>\n\n<pre><code>&lt;!-- language: lang-xml --&gt;\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;OrdersReport Date=\"2012-08-01\"&gt;\n&lt;Client&gt;\n&lt;ClientId&gt;1&lt;/ClientId&gt;\n  &lt;Orders&gt;\n    &lt;Order&gt;\n      &lt;OrderNumber&gt;1&lt;/OrderNumber&gt;\n      &lt;ShipAddress&gt;123 Main St.&lt;/ShipAddress&gt;\n      &lt;ShipCity&gt;MyCity&lt;/ShipCity&gt;\n      &lt;ShipState&gt;AZ&lt;/ShipState&gt;\n    &lt;/Order&gt;\n    &lt;Order&gt;\n      &lt;OrderNumber&gt;2&lt;/OrderNumber&gt;\n      &lt;ShipAddress&gt;111 Main St.&lt;/ShipAddress&gt;\n      &lt;ShipCity&gt;OtherCity&lt;/ShipCity&gt;\n      &lt;ShipState&gt;AL&lt;/ShipState&gt;\n    &lt;/Order&gt;\n    &lt;OrderCancelled&gt;\n      &lt;OrderNumber&gt;3&lt;/OrderNumber&gt;\n      &lt;ShipAddress&gt;111 Main St.&lt;/ShipAddress&gt;\n      &lt;ShipCity&gt;OtherCity&lt;/ShipCity&gt;\n      &lt;ShipState&gt;AL&lt;/ShipState&gt;\n    &lt;/OrderCancelled&gt;\n  &lt;/Orders&gt;  \n  &lt;Returns&gt;\n    &lt;Amount&gt;\n      &lt;OrderId&gt;2&lt;/OrderId&gt;\n      &lt;OrderId&gt;3&lt;/OrderId&gt;\n    &lt;/Amount&gt;\n  &lt;/Returns&gt; \n&lt;/Client&gt;\n&lt;Client&gt;\n&lt;ClientId&gt;2&lt;/ClientId&gt;\n&lt;!-- Same Tree structure as Client 1 --&gt;\n&lt;/Client&gt;\n&lt;/OrdersReport&gt;\n</code></pre>\n\n<p>Based on the responses I got, I have updated the question.</p>\n\n<pre><code>var doc = XDocument.Load(rootFolder + \"Generic.xml\");\n    var query = doc.Descendants(\"Order\")\n                   .Concat(doc.Descendants(\"OrderCancelled\"))\n                   .Select(x =&gt; new\n                   {\n                       OrderNumber = (int)x.Element(\"OrderNumber\"),\n                       ShipAddress = (string)x.Element(\"ShipAddress\"),\n                       ShipCity = (string)x.Element(\"ShipCity\"),\n                       ShipState = (string)x.Element(\"ShipState\")\n                   });           \n\n    var amount = doc.Descendants(\"Amount\")                         \n                  .Select(y =&gt; new\n                  {\n                      OrderId = (int)y.Element(\"OrderId\")\n                  });\n\n    foreach (var o in query)\n    {\n        Console.WriteLine(o.OrderNumber + o.ShipAddress + o.ShipCity);\n    }\n    foreach (var r in amount)\n    {\n        Console.WriteLine(r.OrderId);\n    }\n</code></pre>\n\n<p>The amount enumeration is only giving me the first OrderId, what am I doing incorrectly?</p>\n"},{"tags":[".net","linq","c#-4.0","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13203766,"title":"Get N max numbers and their corresponding position(index) from a 2D array double[,] using lambda expression","body":"<p>This is a question similar to [ <a href=\"http://stackoverflow.com/questions/9062155/get-n-max-numbers-from-a-listint-using-lambda-expression\">Get N max numbers from a List&lt;int&gt; using lambda expression</a> ]  </p>\n\n<p>But I want to learn if I want to keep the index of those N max numbers, how should I write it using lambda expression.  </p>\n\n<p>Example) <code>List&lt;int&gt; numbers = new List&lt;int&gt; { 12, 5, -8, 4, 7, 28, 3, 22 };</code></p>\n\n<p>How can we get 4 maximum numbers by lambda: <code>{28, 22, 12, 7}</code> plus indexes <code>{ 5, 7, 0, 4}</code></p>\n\n<p>as <a href=\"http://stackoverflow.com/users/787016/kirill-polishchuk\">kirill</a> suggested: <code>var result = numbers.OrderByDescending(n =&gt; n).Take(4);</code> but how can I get the <strong>index of those N max numbers</strong>? and it is a double[,] 2D array ( Not a list )</p>\n"},{"tags":["c#","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13203562,"title":"CASE in WHERE clause equivalent","body":"<p>Consider the following SQL query:</p>\n\n<pre><code>SELECT\n   *\nFROM \n   Orders\nWHERE\n   (AdjShipDate IS NOT NULL OR EstShipDate IS NOT NULL)\n    AND\n    CASE \n        WHEN AdjShipDate IS NOT NULL THEN AdjShipDate\n        WHEN AdjShipDate IS NULL AND EstShipDate IS NOT NULL THEN EstShipDate\n    END\n    BETWEEN '2011-07-01' AND '2011-07-30'\n</code></pre>\n\n<p>The case's WHEN expressions depend on a value (AdjShipDate) from the table that I'm trying to query.  How would I write a similar query in Linq to SQL?</p>\n"},{"tags":["vb.net","linq","lambda","lambda-functions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13202068,"title":"Lambda OrderBy method","body":"<p>I have a graphing class to detect circular dependencies in some business logic I am writing. My graphing class builds nodes that knows the relationship to other nodes.</p>\n\n<p>I have nodeList as List(of Objects) each having a List(of String)</p>\n\n<p>I was thinking that the below line of code would yield the correct sorting. I thought wrong.</p>\n\n<pre><code>nodeList.OrderByDescending(Function(x) x.Count)\n</code></pre>\n\n<p>I want to reorder my nodeList in descending order by the List(of String).Count.</p>\n\n<pre><code>my List(of Object)\n(0) | Count = 3\n(1) | Count = 5\n(2) | Count = 2\n\nMy desired output List(of Object)\n(0) | Count = 5\n(1) | Count = 3\n(2) | Count = 2\n</code></pre>\n"},{"tags":["c#","linq","lambda"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13171737,"title":"Conversion of Linq expressions from business to domain types?","body":"<p>I am trying to figure out how to convert a Linq Expression between two types: One in my Business Repository and its related one in the Domain Repository.  Both types have the same data properties that will be used in the queries.  In my business layer, I have the following method that will perform a query based on a business entity:</p>\n\n<p>BUSINESS REPOSITORY: Domain entities converted to business entities</p>\n\n<pre><code>public IQueryable&lt;CustomerVendorProduct&gt; Query(Expression&lt;Func&lt;CustomerVendorProduct,bool&gt;&gt; filterInBusinessRepo)\n</code></pre>\n\n<p>So, a consumer could do something like the following:</p>\n\n<pre><code>var list = BusinessRepository.Query(c =&gt; c.CustomerId == 77);\n</code></pre>\n\n<p>They would get a list of CustomerVendorProduct business objects with CustomerId == 77.</p>\n\n<p>Within the Query() method of the Business Repository, I need to invoke the following method in the Domain Repository.  It will retrieve the raw, encrypted domain entities from the database.  Note that its query requires the entity type used in the Domain Repository.  It is related to our business entity, but simply is involved in CRUD operations.</p>\n\n<p>DOMAIN REPOSITORY: Raw, encrypted entities from the database</p>\n\n<pre><code>public IQueryable&lt;CustomerVendorProductEntity&gt; Query(Expression&lt;Func&lt;CustomerVendorProductEntity, bool&gt;&gt; filter)\n</code></pre>\n\n<p>So, the Query() method in the Business Repository would do something like the following:</p>\n\n<pre><code>var domainList = DomainRepository.Query(filterInBusinessRepo);\n</code></pre>\n\n<p>The result would be a list of CustomerVendorProductEntity objects.  The business repository then translates them into CustomerVendorBusiness entities and returns them to the caller.</p>\n\n<p>So, my question is how can I convert the Linq Expression from the Business Repository Entity Type: CustomerVendorProduct to the Domain Repository Entity Type: CustomerVendorProductEntity?  I think that I must create a conversion method... Something like the following... But, I am lost as to how to effect the conversion.  I would really appreciate your help:</p>\n\n<pre><code>    // Convert the Linq Expression from our Business Layer to our Domain Layer.\n    private Expression&lt;Func&lt;CustomerVendorProductEntity, bool&gt;&gt; CVPToCVPE(Expression&lt;Func&lt;CustomerVendorProduct, bool&gt;&gt; filter)\n    {\n        var parms = System.Linq.Expressions.Expression.Parameter(typeof(CustomerVendorProductEntity), \"destination\");\n\n        var result = System.Linq.Expressions.Expression.Lambda&lt;Func&lt;CustomerVendorProductEntity, bool&gt;&gt;(filter, parms);\n\n        return result;\n    } \n</code></pre>\n\n<p>Thank you for your time and suggestions!\nMike</p>\n\n<p>11/02/2012: Wow, no replies?  I would have thought that a lot of other developers have encountered this issue, especially within an MVC application...  Still hoping for help...</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":72,"score":1,"question_id":13201045,"title":"Linq and work with Datetime?","body":"<p>I need to do this : </p>\n\n<pre><code>context.Ads.Where(c =&gt; c.PublishedDate.HasValue &amp;&amp;\n        c.EndDate.HasValue &amp;&amp;\n        c.EndDate.Value.AddTicks(c.PublishedDate.Value.Ticks) &gt; currentTime &amp;&amp;\n        c.AdStatusMail.Where(b =&gt; b.StatusKey != (int)AdStatusMailKey.EndedRemainder &amp;&amp; b.StatusKey != (int)AdStatusMailKey.MiddleRemainder).Count() &lt; 1)\n        .ToList();\n</code></pre>\n\n<p>The problem is that AddTicks cant be used in Linq. I have looked at the EntityFunctions but cant see how to use it to do what I need? </p>\n"},{"tags":["c#","asp.net-mvc","linq","linq-to-entities"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13200658,"title":"LINQ to Entities - How to return a single string value from entity","body":"<p>I am working in asp mvc 3 app.  I have a model/entity called History.  I have a linq query that returns one value.  Depending on what I do, I either get a \"Object not set to an instance\" error in the controller when the method is called, or I get a \"cannot implicitly convert from string to type Models.History.\"  So I am looking for assistance in resolving, do I just need to cast it or something?</p>\n\n<p>Here is the method that gives the 'object not set' error:</p>\n\n<pre><code>public string GetPastAbuseData(int Id)\n{\n\n  var query = (from h in _DB.History\n              where h.ApplicantId.Equals(Id)\n              select h.AbuseComment).FirstOrDefault();\n\n  return query.ToString();\n }\n</code></pre>\n\n<p>Controller:\n     vm.HistoryModel.AbuseComment = repo.GetPastAbuseData(Id);</p>\n\n<p>And if I change the method type from string to History I get the 'cannot convert' error:</p>\n\n<pre><code>public History GetPastAbuseData(int Id)\n{\n    return (from h in _DB.History\n            where h.ApplicantId.Equals(Id)\n            select h.AbuseComment).SingleOrDefault();\n}\n</code></pre>\n\n<p>Thank you for your time.</p>\n"},{"tags":["c#","linq","exception-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13177499,"title":"Best exception handling approaches in Linq:","body":"<p>Can someone suggest the best exception handling mechanism in LINQ?\nSuppose I have the following  function:</p>\n\n<pre><code>public List&lt;test_dataRange&gt; GetDataRange()\n{\n    testDataContext = new ParentDataContext(conn);\n    List&lt; test_dataRange &gt; dataRange = (from pp in testDataContext. test_dataRanges\n                                                    select pp).ToList();\n\n    return dataRange;\n}\n</code></pre>\n\n<p>What are the best exception handling mechanisms in LINQ that can be applied here?\nAlso What are the best exception handling mechanisms for those functions with Transaction,\nFor eg:</p>\n\n<pre><code> public void UpdateQAProperty(Data_QAProperty qaProperty)\n        {\n            parentDataContext = new ParentDataContext(conn);\n            DbTransaction dbTransaction = null;\n            parentDataContext.Connection.Open();\n            dbTransaction = masterDataContext.Connection.BeginTransaction();\n            parentDataContext.Transaction = dbTransaction;\n            var property = (from y in parentDataContext. QAProperties\n                            where y.Id == qaProperty.Id\n                            select y).FirstOrDefault();\n            property.Height = qaProperty.Height;\n            property.Caption = qaProperty.Caption;\n            property.Width = qaProperty.Width;\n            property.Length= qaProperty.Length;\n\n            parentDataContext.SubmitChanges();\n            dbTransaction.Commit();\n\n        }\n</code></pre>\n"},{"tags":["c#","linq","entity-framework","entity-framework-5"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13200430,"title":"Cannot query property named \"group\" on EF object","body":"<p>I have an EF entity object <code>sysSettings</code> class that has a few properties. <code>group</code> and <code>name</code> is among these properties.</p>\n\n<p><code>quer</code> in the code below is an <code>IQueryable&lt;sysSettings&gt;</code> object.</p>\n\n<p>When trying to write the following query, I'm having difficulty with the second where clause.</p>\n\n<pre><code>var query = from setting in quer\n    where (setting.name.Equals(\"Url\") &amp;&amp; setting.group.Equals(\"system\"))\nselect setting;\n</code></pre>\n\n<p>It seems that when I have a property on an Entity object called <code>group</code> I cannot access that property from within the LINQ query.</p>\n\n<p>I think this might be because <code>group</code> may be a reserved/contextual work/action in LINQ.</p>\n\n<p>Changing the property name of the Entity is unfortunately not an option.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13188172,"title":"How do I perform inline branching within a LINQ query assignment?","body":"<p>I have the following snippet from my LINQ statement, and it works fine but I was wondering if there is a more clever way. I don't want to manually \"new\" up a dummy object if the Fee collection is empty. (Fees is a collection of Fee objects.  You can call it Foo if that makes the question more generic.)</p>\n\n<p>My goal is simple: If <code>Fees</code> is empty, assign a default value of zero to <code>FeeValue</code> instead. What are some alternative ways to achieve this?  Thanks.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>from w in Widgets\nselect new {\n  FeeValue = w.Fees.DefaultIfEmpty(new Fee()).First().Value, // Value is a Double\n    ...\n</code></pre>\n"},{"tags":["c#","winforms","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13199791,"title":"Multiple fields from LINQ to Text Box","body":"<p>how can I pass value from selected field (LINQ) to textbox in winforms?</p>\n\n<p>If single fields, I just do like this</p>\n\n<pre><code>   var result = from row in dtValueBranch.AsEnumerable()\n                         where row.Field&lt;int&gt;(\"branchID\") == idBranch\n                         select row.Field&lt;string&gt;(\"branchName\");\n\n        StringBuilder sb = new StringBuilder();\n\n        foreach (string s in result)\n        {\n            sb.Append(s + Environment.NewLine);\n        }\n\n        tbBranch.Text = sb.ToString();\n</code></pre>\n\n<p>So this is the code LINQ to many fields</p>\n\n<pre><code>    var result = from row in dtValueBranch.AsEnumerable()\n                 where row.Field&lt;int&gt;(\"branchID\") == idBranch\n                 select new\n                 {\n                      BranchName = row[\"branchName\"].ToString(),\n                      branchTel = row[\"branchTel1\"].ToString(),\n                      // And many more fields\n\n                 };\n</code></pre>\n\n<p>How can I to implement each fields to each textbox?</p>\n"},{"tags":["c#",".net","vb.net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":84,"score":0,"question_id":13198355,"title":"Create Dictionary(of Dictionary) using Grouping in Linq","body":"<p>I know I could do this with loops (as a matter of fact, I currently am, but I am trying to learn / imporve my Linq skills and i also hope it will provide a more efficent solution. So, here's my scenario:</p>\n\n<p>Say I have the following 3 lists (I'm just making up a similar example, so forgive it's stupidity):</p>\n\n<pre><code>Dim lstTeachers as New List(of string)\nDim lstStudentsSex as New List(of string)\nDim lstStudentName as New List(of string)\n</code></pre>\n\n<p>And they are, for example, as follows:</p>\n\n<pre><code>lstTeachers:     lstStudentsSex:     lstStudentName:\nTeacher 1        Male                Whatever Name 1\nTeacher 2        Female              Whatever Name 2 \nTeacher 1        Female              Whatever Name 3\nTeacher 1        Female              Whatever Name 4\nTeacher 2        Male                Whatever Name 5\nTeacher 3        Male                Whatever Name 6\nTeacher 3        Female              Whatever Name 7\nTeacher 1        Male                Whatever Name 8\nTeacher 1        Female              Whatever Name 9\nTeacher 2        Male                Whatever Name 10\n</code></pre>\n\n<p>Where each entry in each list matches the other entries with the same index - Basically like a datatable, just stored in separate lists.</p>\n\n<p>Now, suppose I want to create the following structure with the following values:</p>\n\n<pre><code>Dim dictTeacherSexName as New Dictionary(Of String, Dictionary(Of String, List(of String)))\n\nDict1_Key:        Dict1_Value / Dict2_Key:         Dict2_Value:\nTeacher 1         Male                             Whatever Name 1\n                                                   Whatever Name 8\n                  Female                           Whatever Name 3\n                                                   Whatever Name 4\n                                                   Whatever Name 9\nTeacher 2 ...\n</code></pre>\n\n<p>... I hope this explains what I'm looking to accomplish.</p>\n\n<p>Now, again, I know this may be a stupid idea, but I'm also asking it because I want to improve my Linq skills - especially Group By and multiple Selects which still catches me, so please help.</p>\n\n<p>Thanks so much!</p>\n"},{"tags":["c#","linq","refactoring"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":77,"score":4,"question_id":13198107,"title":"How to check if a string is doesn't equal all of these?","body":"<p>Trying to rewrite this using LINQ:</p>\n\n<pre><code>if (mode != \"A\" &amp;&amp; mode != \"B\" &amp;&amp; mode != \"C\" &amp;&amp; mode != \"D\" &amp;&amp; mode != \"E\" &amp;&amp; mode != \"F\" &amp;&amp; mode != \"G\")\n{\n   continue;\n}\n</code></pre>\n\n<p>What would be the most clear and concise way to refactor this? I could have sworn I'd seen a post like this before but I cannot find it at the moment.</p>\n"},{"tags":["c#","linq","set","hashcode"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13194221,"title":"Implementing GetHashCode for IEqualityComparer<T> with conditional equality","body":"<p>I'm wondering if anyone as any suggestions for this problem.</p>\n\n<p>I'm using intersect and except (Linq) with a custom IEqualityComparer in order to query the set differences and set intersections of two sequences of ISyncableUsers. </p>\n\n<pre><code>public interface ISyncableUser\n{\n    string Guid { get; }\n    string UserPrincipalName { get; }\n}\n</code></pre>\n\n<p>The logic behind whether two ISyncableUsers are equal is conditional. The conditions center around whether either of the two properties, Guid and UserPrincipalName, have values. The best way to explain this logic is with code. Below is my implementation of the Equals method of my customer IEqualityComparer.</p>\n\n<pre><code>public bool Equals(ISyncableUser userA, ISyncableUser userB)\n{\n    if (userA == null &amp;&amp; userB == null)\n    {\n        return true;\n    }\n\n    if (userA == null)\n    {\n        return false;\n    }\n\n    if (userB == null)\n    {\n        return false;\n    }\n\n    if ((!string.IsNullOrWhiteSpace(userA.Guid) &amp;&amp; !string.IsNullOrWhiteSpace(userB.Guid)) &amp;&amp;\n        userA.Guid == userB.Guid)\n    {\n        return true;\n    }\n\n    if (UsersHaveUpn(userA, userB))\n    {\n        if (userB.UserPrincipalName.Equals(userA.UserPrincipalName, StringComparison.InvariantCultureIgnoreCase))\n        {\n            return true;\n        }\n    }\n    return false;\n}\n\nprivate bool UsersHaveUpn(ISyncableUser userA, ISyncableUser userB)\n{\n    return !string.IsNullOrWhiteSpace(userA.UserPrincipalName)\n            &amp;&amp; !string.IsNullOrWhiteSpace(userB.UserPrincipalName);\n}\n</code></pre>\n\n<p>The problem I'm having, is with implementing GetHashCode so that the above conditional equality, represented above, is respected. The only way I've been able to get the intersect and except calls to work as expected is to simple always return the same value from GetHashCode(), forcing a call to Equals. </p>\n\n<pre><code> public int GetHashCode(ISyncableUser obj)\n {\n     return 0;\n }\n</code></pre>\n\n<p>This works but the performance penalty is huge, as expected. (I've tested this with non-conditional equality. With two sets containing 50000 objects, a proper hashcode implementation allows execution of intercept and except in about 40ms. A hashcode implementation that always returns 0 takes approximately 144000ms (yes, 2.4 minutes!))</p>\n\n<p>So, how would I go about implementing a GetHashCode() in the scenario above? </p>\n\n<p>Any thoughts would be more than welcome!</p>\n"},{"tags":["c#","asp.net","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13194650,"title":"Filter with EntityDatasource in ASP.NET webforms","body":"<p>I have two Classes (given via Entity Framework) which are in a many to many relationship:</p>\n\n<pre><code>Corporation which has the member Tags\n\nTag which has the member name\n</code></pre>\n\n<p>The EntityDataSource gives me the ObjectQuery which i want to filter in a given tagname but i don't know how.  I want to get all corporations, which have a tag with the name \"myname\". I don't know how to do the linq query</p>\n\n<p>When i query the entities i unfortunately don't get an Objectquery.</p>\n\n<pre><code>protected void EntityDataSource1_QueryCreated(object sender, QueryCreatedEventArgs e)\n{\n    // first try\n    var corps = e.Query.Cast&lt;Corporation&gt;(); \n    // of course doesn't work, because oyu can't access a member (name) of a collection (Tags) \n    // i don't know the right linq expression for this\n    e.Query = from c in corps where c.Tags.Name.Contains(\"myname\") select c; \n\n    // second try\n    var tags = from t in entities.Tags where t.Name.Contains(\"myname\") select t;\n    var filteredcorporations = from c in tags select c.Corporations;\n    // does not work because it is not a ObjectQuery&lt;Corporation&gt;\n    e.query = filteredcorporations; \n}\n</code></pre>\n\n<p>My EntityDataSource:</p>\n\n<pre><code>&lt;asp:EntityDataSource ID=\"EntityDataSource1\" runat=\"server\" ConnectionString=\"name=eodbEntities\" DefaultContainerName=\"eodbEntities\" EnableFlattening=\"False\" EntitySetName=\"Corporations\" OnQueryCreated=\"EntityDataSource1_QueryCreated\"&gt;\n&lt;/asp:EntityDataSource&gt;\n</code></pre>\n"},{"tags":["c#","linq","filter","sortedlist"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":993,"score":2,"question_id":5416201,"title":"C# Linq SortedList Filtering into SortedList","body":"<p>I have got some code in which I am doing some weirdness to get information out of a SortedList and back into another SortedList. I do my where clause, then have to individually put all the KeyValuePairs back into a new SortedList.</p>\n\n<p>This <em>can't</em> be the most efficient, or indeed the recommended, way of doing this, but I can't seem to find a better way.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>SortedList&lt;DateTime, CalendarDay&gt; most_days = \n                                new SortedList&lt;DateTime, CalendarDay&gt;();\nList&lt;KeyValuePair&lt;DateTime, CalendarDay&gt;&gt; days = this.all_days.Where (\n                                  n =&gt; n.Value.IsRequested || n.Value.IsApproved\n                                  ).ToList();\nforeach (KeyValuePair&lt;DateTime, CalendarDay&gt; kvp in days)\n    most_days.Add(kvp.Key, kvp.Value);\n</code></pre>\n\n<p>Any ideas on how I can clean this up (less is more, as they say)?</p>\n\n<p>Thanks,</p>\n\n<p>Jonathan</p>\n"},{"tags":["c#","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13195908,"title":"LINQ to XML node selection doesn't work as expected","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2338512/understanding-linq-to-xml-descendants-return-no-results\">Understanding Linq To Xml - Descendants return no results</a>  </p>\n</blockquote>\n\n\n\n<p>So I've been looking at the Microsoft example:</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/bb387061.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/bb387061.aspx</a></p>\n\n<p>There, they do like this:</p>\n\n<pre><code>IEnumerable&lt;string&gt; partNos =\nfrom item in purchaseOrder.Descendants(\"Item\")\nselect (string) item.Attribute(\"PartNumber\");\n</code></pre>\n\n<p>They use \"Descendants\" to address an item in purchaseOrder which is actually 3 levels deep.</p>\n\n<p>Now, when I try to do the same thing with my XML, I get nothing.</p>\n\n<p>My XML:</p>\n\n<pre><code>&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n     xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n&lt;name&gt;Roulette&lt;/name&gt;\n\n&lt;modules&gt;\n    &lt;module&gt;application&lt;/module&gt;\n    &lt;module&gt;test&lt;/module&gt;\n&lt;/modules&gt;\n</code></pre>\n\n<p></p>\n\n<p>My code:</p>\n\n<pre><code>XDocument mainPOM = XDocument.Load(above_xml);\nList&lt;string&gt; pomLocations = (from loc in mainPOM.Descendants(\"module\") select (string)loc.Name.LocalName).ToList();\nConsole.WriteLine(pomLocations.Count);\n</code></pre>\n\n<p>Unfortunately, pomLocations has a length of 0 :(.</p>\n\n<p>Can somebody please tell me where exactly am I messing up?</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13194898,"title":"LINQ operator to split List of doubles to multiple list of double based on generic delimiter","body":"<p>I have a <code>List</code> double values in which some of the elements are NaN. I want to convert this list\ninto multiple list of doubles using NaN as delimiter.\nExample:</p>\n\n<pre><code>List&lt;double&gt; values =  new List&lt;double&gt;        \n   { 1.2, 2.2, 3.2, Double.NaN, 2.2, 2.3, Double.NaN, 4.1, 4.2, 4.3 }; \nList&lt;List&lt;double&gt;&gt; result = values.SomeLinqOperator....\n</code></pre>\n"},{"tags":["linq","authentication","asp.net-mvc-4","asp.net-web-api"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13193784,"title":"Linq2Rest authentication Asp.net WebApi","body":"<p>I'm working with Asp.net WebApi that has forms authorization. I've succeeded in creating POST request to the contoller, that is secured with [Authorize] attribute by using HttpClient that first goes to authorization controller, which stores cookie to it and client uses it for the other request. For the GET requests I'd want to use <a href=\"http://nuget.org/packages/Linq2Rest\" rel=\"nofollow\" title=\"Linq2Rest\">Linq2Rest</a> library, which uses JsonRestClient, but I don't see how can I use it for authorization. I'm very surprised that I couldn't find any question or discussion on that topic. Is the modifying of the sources of this library the only one way to solve this problem? </p>\n\n<p>Update:\n   I use just usual forms authorizasion.\n    This is how GET method looks like</p>\n\n<pre><code>    [Authorize]\n    [Queryable]\n    public IQueryable&lt;Invoice&gt; GetInvoices()\n    {\n        return repository.GetInvoices();\n    }\n</code></pre>\n"},{"tags":["vb.net","linq","datatable","html-agility-pack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13190598,"title":"LINQ and HTML Agility Pack filling the parsed HTML table data into a datatable","body":"<p>I am using the following query to parse html table data.</p>\n\n<pre><code>Dim q = From table In htmldoc.DocumentNode.SelectNodes(\"//table[@class='Seller']\").Cast(Of HtmlNode)()\n                    From row In table.SelectNodes(\"tr\").Cast(Of HtmlNode)()\n                    From header In row.SelectNodes(\"th\").Cast(Of HtmlNode)()\n                    From cell In row.SelectNodes(\"td\").Cast(Of HtmlNode)()\n               Select New With {Key .Table = table.Id, Key .CellText = cell.InnerText, Key .headerText = header.InnerText}\n</code></pre>\n\n<p>How can i use for each loops how can to fill this into a datatable?</p>\n\n<p>I would create columns first using the header data then use a nested for each loop to fill the cell data in the table, but i am not sure how to, also any suggested changes on the above LINQ query?</p>\n\n<p><strong>Note</strong>: The html page contains only one table always.</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13188493,"title":"Creating count based upon counts of Group By Statement in LINQ / lambda","body":"<p>What I want to do is group a huge bunch of records together by <code>Employer</code>. Then, I want to return an integer variable which will have a count of only those groups with at least <code>30</code> records. </p>\n\n<p>I.E. I have <code>100</code> subscribers at <code>Employer A</code>, <code>20</code> at <code>Employer B</code>, and <code>30</code> at <code>Employer C</code>.</p>\n\n<p>I group the records together and come up with</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Employer A - 100\nEmployer B - 20\nEmployer C - 30\n</code></pre>\n\n<p>I want to return the Scalar Variable of <code>2</code>. </p>\n\n<p>Here is what I currently have:</p>\n\n<pre><code>var Step1 =\n    (from y in recordsActivstJoin\n     where y.q.Market.Contains(market) &amp;&amp; y.x.ActivistCodeID.Equals(activismCode)\n     select new {y}).ToList();\n\n            //this groups my previous query\nvar Step2 = (from z in Step1 group z by z.y.q.Employer into f select new {f}).ToList();\n</code></pre>\n\n<p>When I watch the locals I can see that it does in fact group down from Step 1 where there are 34 rows to 17 in step 2. Now, I want narrow to only those where the group is >=30 .</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["c#",".net","performance","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":185,"score":2,"question_id":13166443,"title":"How to delete every 2nd character in a string?","body":"<p>How to delete every 2nd character in a string?</p>\n\n<p>For example:</p>\n\n<pre><code>3030313535333635  -&gt; 00155365\n3030303336313435  -&gt; 00036145\n3032323437353530  -&gt; 02247550\n</code></pre>\n\n<p>The strings are always 16-characters long and the result is always 8 characters long - and the character that is being removed is always a '3' - Don't ask why however - I did not dream up this crazy source data.</p>\n"},{"tags":["linq","ienumerable","iqueryable",".net-3.0"],"answer_count":6,"favorite_count":16,"up_vote_count":46,"down_vote_count":0,"view_count":7383,"score":46,"question_id":2433306,"title":"What's the difference between IQueryable and IEnumerable","body":"<p>I'm confused as to the difference.  Being fairly new to .Net, I know I can query <code>IEnumerables</code> using the Linq extensions.  So what is this <code>IQueryable</code> and how does it differ?</p>\n"},{"tags":["c#","database","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13191517,"title":"Accessing properties of second table via element of first table","body":"<p>I have two tables which are in a relationship. They are called tblX and tblY.</p>\n\n<pre><code>var x = (from v in db.tblX select v).First();\n</code></pre>\n\n<p>Now x has these properties:</p>\n\n<pre><code>x.name\nx.id\nx.tblY\n</code></pre>\n\n<p>tblY has these properties: idY, nameY.</p>\n\n<p>After I use the linq statement above, I can get to idY without making a join. I can access x.tblY.idY and x.tblY.nameY. Is it ok if I access them like this? Is it a good programming practise?</p>\n"},{"tags":["c#","database","linq","entity-framework","types"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13191320,"title":"The property 'x' on 'tblX' could not be set to a 'null' value. You must set this property to a non-null value of type 'Int16'","body":"<pre><code>List&lt;tblX&gt; messages = (from x in db.tblX where x.msg_id == id_id \n                           || x.name == firstName  select x).ToList();\n</code></pre>\n\n<p>I get the error: </p>\n\n<blockquote>\n  <p>The property 'x' on 'tblX' could not be set to a 'null' value. You must set this property to a non-null value of type 'Int16'.</p>\n</blockquote>\n\n<p>I have a property msg_blocked in db, which is nullable and integer. I know that I need to make a conversion, but I don't use it or need it anywhere in my linq.</p>\n"},{"tags":["c#","linq","linq-to-sql"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1589,"score":1,"question_id":1075770,"title":"How to return query results from method that uses LINQ to SQL","body":"<p>Here is the code I'm working with, I'm still a bit new to LINQ, so this is a work in progress.  Specifically, I'd like to get my results from this query (about 7 columns of strings, ints, and datetime), and return them to the method that called the method containing this LINQ to SQL query.  A simple code example would be super helpful.</p>\n\n<pre><code>using (ormDataContext context = new ormDataContext(connStr))\n{\n    var electionInfo = from t1 in context.elections\n               join t2 in context.election_status\n               on t1.statusID equals t2.statusID\n               select new { t1, t2 };\n}\n</code></pre>\n\n<p>(In this case, my query is returning all the contents of 2 tables, election and election_status.)</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":13190356,"title":"Using like in LINQ","body":"<p>I have a problem in my project. I have table for saving category and I have a <code>listview</code> for viewing that category names and I have a text box above of the <code>listview</code>. When I type an alphabet in the <code>textbox</code>, I want to see the corresponding category name in the list view using LINQ query and for that I'm using this code:</p>\n\n<pre><code> DataTable dt = (from c in Common.dc.TblBrands\n                    where SqlMethods.Like(c.BrandName, txtSearch.Text+\"%\")\n                    orderby c.BrandName\n                    select c).getDataTable();\n</code></pre>\n\n<p>I can see the names correctly but I want to see the brand name when I input the brand id in the <code>textbox</code>. What query can I use to achieve this?</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13177967,"title":"Lambda expression - Where column is equal to list items","body":"<p>I am stuck on this issue on which I need some help.<br>\nI have a general result having different columns including <strong>id</strong> column. I also have a <code>List</code> which has a set of <em>id</em>'s. I want to get result where <code>List</code> item(id) matches the <strong>Id</strong> column value.<br>\nI tried doing this in a loop :  </p>\n\n<pre><code>foreach(int Uid in idList)\n{\n    queryResults = queryResults.Where(security =&gt; security.id== Uid);\n}  \n</code></pre>\n\n<p>But this gives me single record in <strong>queryResults</strong> which is for the last <strong>Uid</strong> in List.<br>\nWhat I want is, records for all <strong>Uid</strong>'s in List should be there in <strong>queryResults</strong>.  </p>\n\n<p>Please let me know if my query is not clear.  </p>\n"},{"tags":["c#","asp.net","linq","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":13189295,"title":"LINQ query to select best sellers","body":"<p>Could a smart guy help me write a LINQ query to get the best selling products, where I have these 2 tables/classes in the <a href=\"http://msdn.microsoft.com/en-us/data/ef.aspx\" rel=\"nofollow\">Entity Framework</a> model:</p>\n\n<pre><code>Orders (OrderedItems)\nOrderedItem (Product, Qty)\n</code></pre>\n\n<p>eg. (this obviously doesn't work)</p>\n\n<pre><code>Orders.OrderByDescending(o =&gt; Sum(o.OrderedItems.Qty))\n      .Select(o =&gt; o.OrderedItems.Product)\n</code></pre>\n"},{"tags":["asp.net","linq","web-services","query"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13177023,"title":"Selected value from dropdownlist has to be tablename from linq query","body":"<p>I have a problem with my linq query. I want a search field (textbox) with a dropdownlist next to it. When i set the dropdownlist on \"ProductID\" he has to search only in the table \"ProductID\", And when i put it on \"Productinformation\", he has to search in the table \"productinformation\", i hope somebody understand this?</p>\n\n<p>So what i want is the following query:</p>\n\n<pre><code>    var textboxvalue = TextBox1.Text;\n            var dropdownsearch = DropDownList1.SelectedValue;    \n\nvar Metadata = from m in db.Metadatas\n                               join mm in db.Multimedias\n                               on m.multimediaID equals mm.multimediaID\n                               where (m. {{{Here i want the dropdownsearch}}} .ToString().Contains(textboxvalue) ||\n                                      mm. {{{Here i want the dropdownsearch}}} .ToString().Contains(textboxvalue))\n\n\n                               select new\n                               {\n                                   mm.ProductID,\n                                   mm.filename,\n                                   mm.filetype,\n                                   mm.filesize\n                               };\n</code></pre>\n\n<p>So, how can i get the selected value from the dropdownlist, as a table in the query? Normally you would put m.ProductID into the query, but i want the Selected value in it, something like <code>m.(Dropdownlist1.Selectedvalue)</code>... or <code>m.dropdownsearch</code>..\nIs that possible? And how?</p>\n\n<p>Thanks :)</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13188457,"title":"Inserting elements into a child node, based on a condition","body":"<p>I have the following XML</p>\n\n<pre><code>XElement xe = \n   new XElement(\"Schedule\",\n      new XElement(\"Team\",\n         new XElement(\"Name\", \"SomeName\"),\n         new XElement(\"Dates\"),\n            new XElement(\"Game\",\n               new XElement(\"Bench\"),\n               new XElement(\"Date\")\n            )\n      )\n  );\n</code></pre>\n\n<p>Eventually i'll want to add to the Bench and Date field.</p>\n\n<p>I've tried something like:</p>\n\n<pre><code>foreach(Name name in names)\n{\n    doc.Element(\"Schedule\").Element(\"Team\").Element(\"Dates\")\n       .Elements()\n       .FirstOrDefault(item =&gt; (string)item.Parent.Element(\"Name\") == name.TeamName)\n       .Add(\n          new XElement(\"Game\",\n             new XElement(\"Bench\", \"SomeBench\"),\n             new XElement(\"Date\", SomeDate.ToShortDateString())\n           )\n        );\n}\n</code></pre>\n\n<p>I get an Object not set to an instance of an object error.</p>\n\n<p>Any help would be great</p>\n\n<p>EDIT: Forgot to mention that the insertions would happen with a loop</p>\n\n<p>My End result would end up something like:</p>\n\n<pre><code>&lt;Schedule&gt;\n   &lt;Team&gt;\n      &lt;Name&gt;SomeName&lt;/Name&gt;\n       &lt;Dates&gt;\n         &lt;Bench&gt;SomeBench&lt;/Bench&gt;\n         &lt;Date&gt;12/10/2012&lt;/Date&gt;\n       &lt;/Dates&gt;\n   &lt;/Team&gt;\n   &lt;Team&gt;\n      &lt;Name&gt;SomeName2&lt;/Name&gt;\n       &lt;Dates&gt;\n         &lt;Bench&gt;SomeBench2&lt;/Bench&gt;\n         &lt;Date&gt;12/13/2012&lt;/Date&gt;\n       &lt;/Dates&gt;\n   &lt;/Team&gt;\n   &lt;Team&gt;\n      &lt;Name&gt;SomeName3&lt;/Name&gt;\n       &lt;Dates&gt;\n         &lt;Bench&gt;SomeBench3&lt;/Bench&gt;\n         &lt;Date&gt;12/16/2012&lt;/Date&gt;\n       &lt;/Dates&gt;\n   &lt;/Team&gt;\n&lt;/Schedule&gt;\n</code></pre>\n"},{"tags":["vb.net","linq","linq-to-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13188182,"title":"Object filtering in linq using Vb.net","body":"<p>I have a collection class named Person and have properties name, age, height. I need to filter the values in this collection where the age &lt; 30 and return it as object or the person type object. Please give me the linq query. I google-d and tried, but not working.</p>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":1283,"score":1,"question_id":9335015,"title":"Find() vs. Where().FirstorDefault()","body":"<p>I often see people using Where.FirstOrDefault() to do a search and grab the first element. Why not just use Find(). Is there an advantage to the other? I couldn't tell a difference...</p>\n\n<pre><code>namespace LinqFindVsWhere\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            List&lt;string&gt; list = new List&lt;string&gt;();\n            list.AddRange(new string[]\n            {\n                \"item1\",\n                \"item2\",\n                \"item3\",\n                \"item4\"\n            });\n\n            string item2 = list.Find(x =&gt; x == \"item2\");\n            Console.WriteLine(item2 == null ? \"not found\" : \"found\");\n            string item3 = list.Where(x =&gt; x == \"item3\").FirstOrDefault();\n            Console.WriteLine(item3 == null ? \"not found\" : \"found\");\n            Console.ReadKey();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","syntax"],"answer_count":4,"favorite_count":7,"up_vote_count":19,"down_vote_count":0,"view_count":10117,"score":19,"question_id":1938204,"title":"LINQ, Where() vs FindAll()","body":"<p>Can someone explain how the LINQ functions Where(..) and FindAll(..) differ? They both seem to do the same thing...</p>\n"},{"tags":["c#","sql","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13185818,"title":"Using LINQ, How do I return objects from a GroupBy clause?","body":"<p>Thanks for looking!</p>\n\n<h1>Background</h1>\n\n<p>Within my C# code, I am calling a stored procedure from a MSSQL database that returns a history of orders that a user has made.  I use the Entity Framework for this.  Here is the code:</p>\n\n<pre><code>var db = new CustomerEntities();\nreturn db.GetOrderHistoryByUserId(id);\n</code></pre>\n\n<p>The output of this stored procedure is a list of orders with multiple records having the same <code>OrderNumber</code> because there may have been multiple products in a given order.  So I modified my code to look like this:</p>\n\n<pre><code>var db = new CustomerEntities();\nreturn db.GetOrderHistoryByUserId(id).GroupBy(p =&gt; p.OrderNumber);\n</code></pre>\n\n<p>I was hoping to now have a list of <code>Order</code> objects with nested <code>Product</code> objects, but instead this code essentially produced the same response as before.</p>\n\n<p>Ultimately, I just want to convert this query into a JSON response that looks something like this:</p>\n\n<pre><code>Orders : [\n{\nOrderNumber : 1,\nOrderTotal: $500,\nProducts: [\n  {ProductSku : 11111, ProductPrice: $200},\n  {ProductSku : 22222, ProductPrice: $300}\n]\n}\n]\n</code></pre>\n\n<p>I am using MVC 4 to aid in producing the JSON output, so I am already clear on that part, I just need to know how to consume the results of the stored procedure in a manner that produces an array of objects with the desired structure.</p>\n\n<h1>Question</h1>\n\n<p>Is there a way of producing this desired object structure with the original LINQ call to the stored procedure, or am I going to need to iterate the results of the stored procedure and construct a new object?</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["linq","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13185842,"title":"System.Data.Linq not loaded in MVC .NET 4.5","body":"<p>I have an ASP.NET MVC4 Web Application project in .NET 4.5 (VS 2012). It is in VB.\nIt fails loading System.Data.Linq namespace (with all classes and sub-namespaces). \nProject has a reference set to System.Data.Linq.dll.</p>\n\n<p>Any ideas where is the problem? </p>\n\n<p>When I try to add Linq2Sql classes, I get such warning:</p>\n\n<pre><code>Namespace or type specified in the Imports 'System.Data.Linq' doesn't contain \nany public member or cannot be found. Make sure the namespace or the type is \ndefined and contains at least one public member. Make sure the imported element \nname doesn't use any aliases.   \n</code></pre>\n\n<p>and such errors:</p>\n\n<pre><code>System.Data.Linq.DataContext\n</code></pre>\n\n<p>But this is just a beginning: if I try to use anything from System.Data.Linq namespace I get an error, for example if I try to use System.Data.Linq.Mapping.DatabaseAttribute, I get such error:</p>\n\n<pre><code>Type 'System.Data.Linq.Mapping.DatabaseAttribute' is not defined.\n</code></pre>\n"},{"tags":["linq","entity-framework","sql-server-ce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13169788,"title":"DateTime logic in LINQ for SQL Server CE","body":"<p>My object 'Job' has <code>LastTimeFinishedRunning</code> which is <code>DateTime</code> and <code>RunIntervalMinutes</code> which is an <code>int</code>. I need to add them together and compare against current time.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Job jobToRun = ctx.Jobs.Where\n(job =&gt; DateTime.Now &gt; Job.LastTimeFinishedRunning.Add(TimeSpan.FromMinutes(job.RunIntervalMinutes))).FirstOrDefault();\n</code></pre>\n\n<p>Well, the <code>.Add()</code> doesn't work of course....</p>\n\n<p>neither works this:</p>\n\n<pre><code>DateTime.Now &gt; EntityFunctions.AddMinutes(job.LastTimeFinishedRunning, job.RunIntervalMinutes)\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>DateTime.Now &gt; System.Data.Objects.SqlClient.SqlFunctions.DateAdd(\"minute\", job.RunIntervalMinutes, job.LastTimeFinishedRunning)\n</code></pre>\n\n<p>...because it's SQL Server CE provider</p>\n\n<p>Any suggestions? Thx.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I guess my only option here is to store ticks in <code>LastTimeFinishedRunning</code> by switching it from <code>DateTime</code> to <code>long</code> in DB. So the code would look something like this:</p>\n\n<pre><code>long ticks = DateTime.Now.Ticks;\nJob jobToRun = ctx.Jobs.Where\n(job =&gt; ticks &gt; Job.LastTimeFinishedRunning + job.RunIntervalMinutes * 1000 * 10000).FirstOrDefault();\n</code></pre>\n"},{"tags":["c#","linq","unit-testing","moq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13185385,"title":"How to debug this or possible causes? System.NullReferenceException was unhandled by user code on Moq.Verify","body":"<p>I have something like this in my unit test</p>\n\n<pre><code>public class MyTestClass()\n{\n      private Mock&lt;IAccountRepo&gt; accountRepo;\n       private AdminService adminService;\n\n      [Setup]\n      public void Setup()\n      {\n        accountRepo = fixture.Freeze&lt;Mock&lt;IAccountRepo&gt;&gt;();\n        adminService = fixture.CreateAnonymous&lt;AdminService&gt;();\n      }\n\n      [Test]\n      public Test()\n      {\n          accountRepo.Setup(x =&gt; x.Insert(It.IsAny&lt;IUnitOfWork&gt;(), It.IsAny&lt;MyDomainObject&gt;()));\n\n            adminService.ApplyAdminFee(1, 1, today);\n\n            accountRepo.Verify(x =&gt; x.Insert(It.IsAny&lt;IUnitOfWork&gt;(), It.Is&lt;MyDomainObject&gt;(a =&gt; a.Id == 1)));\n      }\n}\n</code></pre>\n\n<p>I get this error.</p>\n\n<pre><code>System.NullReferenceException was unhandled by user code\n  Message=Object reference not set to an instance of an object.\n  Source=Anonymously Hosted DynamicMethods Assembly\n  StackTrace:\n       at lambda_method(Closure , MyDomainObject )\n       at Moq.It.&lt;&gt;c__DisplayClass2`1.&lt;Is&gt;b__1(TValue value)\n       at Moq.Match`1.Matches(Object value)\n       at Moq.Matcher.Matches(Object value)\n       at Moq.MethodCall.Matches(IInvocation call)\n       at Moq.Mock.&lt;&gt;c__DisplayClassc.&lt;VerifyCalls&gt;b__b(IInvocation i)\n       at System.Linq.Enumerable.WhereListIterator`1.MoveNext()\n       at System.Linq.Enumerable.Count[TSource](IEnumerable`1 source)\n       at Moq.Mock.VerifyCalls(Interceptor targetInterceptor, MethodCall expected, Expression expression, Times times)\n       at Moq.Mock.Verify[T](Mock mock, Expression`1 expression, Times times, String failMessage)\n       at Moq.Mock`1.Verify(Expression`1 expression, Times times)\n       at Test() in 383\n  InnerException: \n</code></pre>\n\n<p>I am not sure why.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I think I know what is happening. in my method I have 3 calls to the insert method(the insert method takes in an object).</p>\n\n<p>So I have like</p>\n\n<pre><code>accountRepo.Insert(MyDomainObject);\naccountRepo.Insert(MyOtherDomainObject);\naccountRepo.Insert(MyOtherOtherDomainObject);\n</code></pre>\n\n<p>So maybe those 2 other inserts are overriding it? how can I get around this?</p>\n"},{"tags":["visual-studio-2010","linq","sql-server-2008"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":12,"score":-1,"question_id":13184343,"title":"Weekly Performance Chart - ASP.NET","body":"<p>I'm trying to make a bar chart and using LINQ but I don't have any idea how to get weekly performance percent.</p>\n\n<p>I have a database that keeps daily goals and every mission has its own score(0-10) and start date, finish date also connected with UserID. I have to make a bar chart that displays user, week and week's performance rate (%). But I have no clue how to calculate \"that week's rating\" and bind it to chart. </p>\n\n<p>Any suggestions?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13183566,"title":"use Linq to process groups of items in a list","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3773403/linq-partition-list-into-lists-of-8-members\">LINQ Partition List into Lists of 8 members</a><br>\n  <a href=\"http://stackoverflow.com/questions/12389203/how-do-i-chunk-an-enumerable\">how do I chunk an enumerable?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a list of many items, and a Method that works well on shorter lists of those same items.</p>\n\n<p>Can I use LINQ to pull off N elements from the big list, and pass them into the Method, N at a time?  I'm sure there is an elegant way to to this without having to make an \"int i=0;\" variable.</p>\n\n<p>Let me be clear, I know that foo.Take(10) will get me 10 items off the list.  But I need to keep processing the next set of 10, then the next set of 10 and so on.  The pseudo code should be something like:</p>\n\n<pre><code>var shortList = BigList.NiceMethod(10);\nforeach (shorty in shortlist)\n{\n  Method(shorty);\n}\n</code></pre>\n\n<p>This is probably some Group call.</p>\n"},{"tags":["linq","lambda","iqueryable"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13182754,"title":"How can I change my method to achive the following?","body":"<p>I have this method that is supposed to search collection of Employees by names.\nI pass the array of last names I want to find, and the method returns Employees with these names. Simple.</p>\n\n<pre><code>    public IQueryable&lt;Employee&gt; GetEmployees(IEnumerable&lt;string&gt; lastNames)\n    {\n        var query = Employees.Where(e =&gt; lastNames.Contains(e.LastName));\n        return query;\n    }\n</code></pre>\n\n<p>Now I need to change the method so that I can pass array of <strong>partial</strong> lastnames, and get all Employees whose last names match the partial last names.</p>\n\n<pre><code>    public IQueryable&lt;Employee&gt; GetEmployees(IEnumerable&lt;string&gt; partialLastNames)\n    {\n        // the code above will not work\n    }\n</code></pre>\n\n<p>So that If I have employees with these names: \nSigourney Weaver, Amanada Beaver, John Smith, Jane Matheson </p>\n\n<p>And I pass partialLastName arary [\"aver\", \"math\"], it will return me  a query that will match: Sigourney Weaver, Amanada Beaver and Jane Matheson</p>\n\n<p>How can I do that ?</p>\n\n<p>Thanks.</p>\n"},{"tags":["sql","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13178298,"title":"linq group by multipe aggregates","body":"<p>Im new to Linq and Im sure that I have gone about this in a convoluted manner.  Im trying to do something like this SQL in Linq:</p>\n\n<p><code>\nSELECT DISTINCT<br/>\n&nbsp;&nbsp; count(vendor) as vendorCount, <br/>\n&nbsp;&nbsp; reqDate, <br/>\n&nbsp;&nbsp; status, <br>\n&nbsp;&nbsp; openDate, <br>\n&nbsp;&nbsp; item, <br>\n&nbsp;&nbsp; poDate, <br>\n&nbsp;&nbsp; count(responseDate) as responseCount <br>\nFROM <br>\n&nbsp;&nbsp; myTable<br>\nGROUP BY <br>\n&nbsp;&nbsp; reqDate, status, openDate, item, poDate<br>\nHAVING<br>\n&nbsp;&nbsp; reqDate > openDate\n</code></p>\n\n<p>Here is what I have so far.\n<code></p>\n\n<pre><code>        var groupQuery = (from table in dt.AsEnumerable()\n                         group table by new\n                         {                                 \n                             vendor = table[\"vendor\"], reqdate = table.Field&lt;DateTime&gt;(\"ReqDate\"), status = table[\"status\"],\n                             open = table[\"openDate\"],  \n                             item = table[\"item\"), \n                             podate = table.Field&lt;DateTime&gt;(\"PODate\"), responsedate =  table.Field&lt;DateTime&gt;(\"responseDate\"), \n                         }\n                             into groupedTable\n                             where Having(groupedTable.Key.reqdate, groupedTable.Key.openDate) == 1\n                             select new\n                             {\n                                 x = groupedTable.Key,  \n                                 y = groupedTable.Count()\n                             }).Distinct();\n\n\n\n        foreach (var req in groupQuery)\n        {\n            Console.WriteLine(\"cols: {0} count: {1} \",\n                req.x, req.y);\n        }\n</code></pre>\n\n<p></code></p>\n\n<p>The Having() is a function that takes two datetime parameters and returns a 1 if the reqDate is greater than the openDate.  It compiles and runs, but it obviously does not give me the results I want.  Is this possible using Linq?  I want to push this data to an excel spreadsheet so Im hoping to create a datatable from this linq query.  Would I be better off just creating a dataview from my datatable and not mess with Linq?</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13179802,"title":"convert linq to lambda with multiple joins","body":"<p>I'm trying to convert this linq query to lambda</p>\n\n<pre><code> var query = (from a in context.Table_A\n                         join u in context.Table_B  on a.scored equals u.userid\n                         join u2 in context.Table_B on a.scorer equals u2.userid\n                         from cs in a.Table_C //(Table_A is related to Table_C)\n                         where (a.date&gt;= startdate &amp;&amp; a.date &lt; enddate)\n                         select new MSViewModel\n                         {\n                             scored= u.User.name,\n                             scorer= u2.User.name,\n                             subject_name = cs.Subject.name,\n                             score = cs.score,\n                             categoryid = cs.id,\n                         })\n                            .AsEnumerable()\n                            .GroupBy(t =&gt; t.scored)\n                            .ToList();\n</code></pre>\n\n<p>so far this is what i have. I'm kinda lost what to do next.</p>\n\n<pre><code> var tobi = db.Table_A.Join(db.Table_B,a=&gt;a.scored,u=&gt;u.userid,\n                    (a,u) =&gt; new {scored=u.User.name });\n                    db.Table_A.Join(db.Table_B,a1=&gt;a1.scorer,u2=&gt;u2.userid, \n                    (a,u2)=&gt; new {scorer= u2.User.name});\n</code></pre>\n"},{"tags":["linq","entity-framework"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2799,"score":2,"question_id":2356992,"title":"date difference with linq","body":"<p>With this code:</p>\n\n<pre><code> i.SpesaAlloggio = db.TDP_NotaSpeseSezB.Sum(p =&gt; p.Costo / (((DateTime)p.DayEnd)\n                    .Subtract((DateTime)p.DayStart).Days + 1));\n</code></pre>\n\n<p>I receive this error:</p>\n\n<pre><code>LINQ to Entities does not recognize the method \n'System.TimeSpan Subtract(System.DateTime)' method, and this method cannot be \ntranslated into a store expression.\n</code></pre>\n\n<p>How can I do this?</p>\n"},{"tags":["c#","linq","exception","exception-handling"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13179200,"title":"Is there any way to catch predicate in LINQ that caused exception?","body":"<p>\nSay I have some statements like:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>List&lt;string&gt; list = new List&lt;string&gt; {\"1\", \"1\", \"2\", \"3\", \"4\"};\ntry\n{\n    Class1 c = new Class1\n        {\n            s1 = list.Single(s =&gt; s == \"1\"),\n            s2 = list.Single(s =&gt; s == \"2\"),\n            s3 = list.Single(s =&gt; s == \"3\"),\n            s4 = list.Single(s =&gt; s == \"4\")\n        };\n}\ncatch (InvalidOperationException ex)\n{\n    Console.WriteLine(ex.Message);\n}\n</code></pre>\n\n<p>And I definitely will go to the <code>catch</code> block with an error \"The input sequence contains more than one element\" at this line:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>s1 = list.Single(s =&gt; s == \"1\")\n</code></pre>\n\n<p>So, I just curious, it there any way to display error predicate in <code>catch</code> block? This will be very useful to fix the bugs, if we'll see something like \"There was a duplicate element \"1\" in sequence.\" or even full predicate in string format. Can I somehow view this information and display or log it?</p>\n"},{"tags":["vb.net","linq","outer-join"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13162323,"title":"Multiple columns in Linq left outer join","body":"<p>Could somebody help me complete this linq left outer join query so that the second column of the right table (tempData) is contained in the result set even though it may be null?</p>\n\n<pre><code>sortedData = From cs In mbCustomSort\n             Order By cs(0)\n             Group Join entry In tempData On cs(joinColumn) Equals entry(0) Into Group\n             From last In Group.DefaultIfEmpty _\n             Select New With {.groupField = cs(joinColumn)}\n</code></pre>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13176743,"title":"Filtering List based on a nested list using LINQ","body":"<p>Let's say we have a List of Projects and this list contains another list of Users.</p>\n\n<p>How can I construct a LINQ query that let's say get me all the projects of a specific user based on his UserID?</p>\n\n<p>Thanks.</p>\n"},{"tags":["linq","fluent-nhibernate","linq-to-nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13171394,"title":"Linq: select property collection","body":"<p>I have two classes:</p>\n\n<pre><code>public class Person\n{\n   public int Id{get;set;}\n   public string Name{get;set;}\n   public List&lt;Order&gt; Orders{get;set;}\n}\npublic class Order\n{\n   public int Id{get;set;}\n   public string Data{get;set;}\n   public decimal Sum{get;set;}\n}\n</code></pre>\n\n<p>I use Nhibernate Linq. If I want to get total sum of orders filtering by Persan.Name I do this:</p>\n\n<pre><code>var result = (from person in personRepository.Query\n             from order in person.Orders\n             where person.Name.Contains(\"off\")\n             select order).Sum(order =&gt; order.Sum);\n</code></pre>\n\n<p>How can I do the same using fluent syntax?</p>\n"},{"tags":[".net","vb.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13174834,"title":"Is filtering on a for each noticeably more performant than if clauses within the loop","body":"<p>I am working on a code base with a lot of <code>ForEach... If's</code>. I was planning to convert them to filtered for each's but I wanted to know is the speed improvement worth the time. I know all of these things are relative but if the filtered for each is magnitudes faster in general it would make sense to change.</p>\n\n<pre><code> For Each egg In chicken.Where(Function(x) x.Tasty = True)\n      ' Do Stuff\n Next\n\n For Each egg In chicken\n      If x.Tasty = True Then\n           ' Do Stuff\n      End If\n Next\n</code></pre>\n"},{"tags":["c#","string","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13174387,"title":"Query string using LINQ","body":"<p>For parsing SDP information from an RTSP, currently I use default c# string functions (like loop the string line by line) and foreach/switch methods. Default SDP information comes from a device in this form:</p>\n\n<pre><code>v=0\no=mhandley 2890844526 2890842807 IN IP4 126.16.64.4\ns=SDP Seminar\ni=A Seminar on the session description protocol\nu=http://www.cs.ucl.ac.uk/staff/M.Handley/sdp.03.ps\ne=mjh@isi.edu (Mark Handley)\nc=IN IP4 224.2.17.12/127\nt=2873397496 2873404696\na=recvonly\nm=audio 3456 RTP/AVP 0\nm=video 2232 RTP/AVP 31\nm=whiteboard 32416 UDP WB\na=orient:portrait\n</code></pre>\n\n<p>Im wondering is this string is query-able using LINQ or something instead of foreaching each line, switching the first character and then storing the rest as a value, because this method is very sensitive to malfunction and error (like when 2 attributes/params are on 1 line or the first character isn't accidentally the right one (e.g. with a space before)). Before I begin to cover every damn exception than can occur, I'm wondering if there's a technique to query a string for values/keys using LINQ.</p>\n"},{"tags":["c#","asp.net","linq","linq-to-sql","conflict"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2607,"score":2,"question_id":8851482,"title":"Linq row not found or changed","body":"<pre><code>Error Message: Row not found or changed.\nStack Trace:\nat System.Data.Linq.ChangeProcessor.SubmitChanges(ConflictMode failureMode) \nat System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode) \n</code></pre>\n\n<p>This occurs seemingly randomly.  I get emailed these errors, and the URL reported always seems to work for me and should be functioning for everyone else as well.</p>\n\n<p>I can fix this error by:</p>\n\n<ul>\n<li>Going to my <code>dbml</code> layout</li>\n<li>Selecting every field in the table causing conflicts</li>\n<li>Right click and set the property <code>Update Check</code> to <code>Never</code></li>\n</ul>\n\n<p>This seems to prevent these types of errors being thrown.</p>\n\n<p>However, this is laborious to remember to keep doing whenever I make a chance to the <code>dmbl</code>, add new tables, etc.  Is there a better way to solve this problem?  I'm getting maybe 50-100 of these a day which is bad for my visitors.</p>\n"},{"tags":["linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13172134,"title":"Linq to xml select new PurchaseOrder","body":"<p>I'm trying to get my head arround \"Linq to xml\" so let me jump right to it. I have this xml :</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;PurchaseOrders&gt;\n  &lt;PurchaseOrder PurchaseOrderNumber=\"99503\" OrderDate=\"1999-10-20\"&gt;\n    &lt;Address Type=\"Shipping\"&gt;\n      &lt;Name&gt;Ellen Adams&lt;/Name&gt;\n      &lt;Street&gt;123 Maple Street&lt;/Street&gt;\n      &lt;City&gt;Mill Valley&lt;/City&gt;\n      &lt;State&gt;CA&lt;/State&gt;\n      &lt;Zip&gt;10999&lt;/Zip&gt;\n      &lt;Country&gt;USA&lt;/Country&gt;\n    &lt;/Address&gt;\n    &lt;Address Type=\"Billing\"&gt;\n      &lt;Name&gt;Tai Yee&lt;/Name&gt;\n      &lt;Street&gt;8 Oak Avenue&lt;/Street&gt;\n      &lt;City&gt;Old Town&lt;/City&gt;\n      &lt;State&gt;PA&lt;/State&gt;\n      &lt;Zip&gt;95819&lt;/Zip&gt;\n      &lt;Country&gt;USA&lt;/Country&gt;\n    &lt;/Address&gt;\n    &lt;DeliveryNotes&gt;Please leave packages in shed by driveway.&lt;/DeliveryNotes&gt;\n    &lt;Items&gt;\n      &lt;Item PartNumber=\"872-AA\"&gt;\n        &lt;ProductName&gt;Lawnmower&lt;/ProductName&gt;\n        &lt;Quantity&gt;1&lt;/Quantity&gt;\n        &lt;USPrice&gt;148.95&lt;/USPrice&gt;\n        &lt;Comment&gt;Confirm this is electric&lt;/Comment&gt;\n      &lt;/Item&gt;\n      &lt;Item PartNumber=\"926-AA\"&gt;\n        &lt;ProductName&gt;Baby Monitor&lt;/ProductName&gt;\n        &lt;Quantity&gt;2&lt;/Quantity&gt;\n        &lt;USPrice&gt;39.98&lt;/USPrice&gt;\n        &lt;ShipDate&gt;1999-05-21&lt;/ShipDate&gt;\n      &lt;/Item&gt;\n    &lt;/Items&gt;\n  &lt;/PurchaseOrder&gt;\n&lt;/PurchaseOrders&gt;\n</code></pre>\n\n<p>And then I created som simple objects :</p>\n\n<pre><code>public class PurchaseOrder\n{\n    public string PurchaseOrderNumber { get; set; }\n    public string OrderDate { get; set; }\n    public Address BillingAddress { get; set; }\n    public Address ShippingAddress { get; set; }\n    public string DeliveryNotes { get; set; }\n    public List&lt;Item&gt; Items { get; set; }\n}\n\npublic class Address\n{\n    public string Type { get; set; }\n    public string Name  { get; set; }\n    public string Street { get; set; }\n    public string City { get; set; }\n    public string State { get; set; }\n    public string Zip { get; set; }\n    public string Country { get; set; }\n}\n\npublic class Item\n{\n    public string PartNumber { get; set; }\n    public string ProductName { get; set; }\n    public string Quantity { get; set; }\n    public string USPrice { get; set; }\n    public string Comment { get; set; }\n}\n</code></pre>\n\n<p>Then i go ahead an make my linq :</p>\n\n<pre><code>    var orders = (from order in XDocument.Load(Server.MapPath(\"/App_Data/Order.xml\")).Descendants(\"PurchaseOrder\")\nselect new PurchaseOrder\n{\n    PurchaseOrderNumber = order.Attribute(\"PurchaseOrderNumber\").Value,\n    OrderDate = order.Attribute(\"OrderDate\").Value,\n    BillingAddress = new Address\n    {\n        City = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Billing\").Single().Element(\"City\").Value,\n        Country = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Billing\").Single().Element(\"Country\").Value,\n        Name = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Billing\").Single().Element(\"Name\").Value,\n        State = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Billing\").Single().Element(\"State\").Value,\n        Street = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Billing\").Single().Element(\"Street\").Value,\n        Type = \"Billing\",\n        Zip = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Billing\").Single().Element(\"Zip\").Value\n    },\n    ShippingAddress = new Address\n    {\n        City = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Shipping\").Single().Element(\"City\").Value,\n        Country = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Shipping\").Single().Element(\"Country\").Value,\n        Name = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Shipping\").Single().Element(\"Name\").Value,\n        State = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Shipping\").Single().Element(\"State\").Value,\n        Street = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Shipping\").Single().Element(\"Street\").Value,\n        Type = \"Shipping\",\n        Zip = order.Descendants(\"Address\").Where(a =&gt; a.Attribute(\"Type\").Value == \"Shipping\").Single().Element(\"Zip\").Value\n    },\n    DeliveryNotes = order.Element(\"DeliveryNotes\").Value,\n    Items = null\n});\n</code></pre>\n\n<p>First of, why does the \"order.Element(\"DeliveryNotes\").Value\" not exists in the output xml and throws \"Object reference not set to an instance of an object\" ?</p>\n\n<p>Second, how do I get the \"Type\" (which is an Attribute) for the address?</p>\n\n<p>Third, how do I make the list of items this one \"Items = null\" so that I have a fully functional object to work with ?</p>\n\n<p>And finally if the rest of the linq needs som tuning then go ahead and guid me in the right direction ;o)</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13168156,"title":"how to execute custom function for each item later using linq deferred execution?","body":"<p>I have a:</p>\n\n<pre><code>public Dictionary&lt;string,BaseModel&gt; data  { get; set; }\n</code></pre>\n\n<p>and I would like to achieve the equivalent of this code which I have working now, only using Linq deferred execution.</p>\n\n<pre><code>foreach (KeyValuePair&lt;string, BaseModel&gt; item in data)\n{\n   T model = (T)item.Value; //each item needs to be cast to T, T inherits from BaseModel\n   model.Init(this, personId); //Init is a function I wrote I want to call on each item\n   l.Add(model); //currently I am adding each item to a list, but IEnumerable&lt;T&gt; can work\n}\n</code></pre>\n\n<p>I started writing code like:</p>\n\n<pre><code>IEnumerable&lt;T&gt; l = Cache[type].Data.Cast&lt;T&gt;()\n                                   .Select(item =&gt; item);\n</code></pre>\n\n<p>but I can't figure out how to call the Init function (each model has one, they all inherit from BaseModel) on every item. I have been reading about predicate delegates and the like but can't find an example of how to do something like (pseduocode):</p>\n\n<pre><code>IEnumerable&lt;T&gt; l = Cache[type].Data.Cast&lt;T&gt;()\n                                   .Select(item =&gt; item)\n                                   .RunMeOnEachItemLater(InitWrapperDelegate);\n</code></pre>\n\n<p>In case you are wondering what this is for, I have an MVC project and I am implementing a model data cache. </p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13172666,"title":"Invalid attempt to read when no data is present error","body":"<p>This is my code:</p>\n\n<pre><code>var products = (from x in db.tblExample select x).ToList();\n</code></pre>\n\n<p>and I get \"Invalid attempt to read when no data is present\" error.\nThe table exists and has data in it. This query:</p>\n\n<pre><code>SELECT *\nFROM [myDatabase].[dbo].[tblExample]\n</code></pre>\n\n<p>works fine in Microsoft SQL server. How to resolve this?</p>\n"},{"tags":["sql","vb.net","linq","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13169314,"title":"Combining two tables into one","body":"<p>I need to merge two data schema into one. I have Schema1 and Schema2. I need to join these two into Schema3. Furthermore, I have a Select statement which queries a data set but I can't figure out how to use the select statement on the data set containing both tables (both Schema1 and Schema2) and combine them into the new table schema3 which is a table in the same data set comprised of both table's fields. </p>\n\n<p>Example</p>\n\n<p><strong>Schema 1</strong> \nID, \nFood, \nBook,\nRice, \nCave</p>\n\n<p><strong>Schema 2</strong>\nID ,\nCarpet, \nStrings,\nRun </p>\n\n<p><strong>Schema 3</strong> \nID,\nFood, \nBook, \nRice,\nCave,\nCarpet,\nStrings,\nRun </p>\n\n<p>Fill the Schema3 Table with this command</p>\n\n<p>Sql Command:</p>\n\n<pre><code>Select * Schema1 [except ID] and all fields from Schema2 [exceptID] Inner Join \nSchema2 ON Schema1.ID = Schema2.ID\nWhere ID = {dynamically defined variable 'X'}\n</code></pre>\n\n<p>Please excuse the lack of proper syntax. The main issue here again is querying a dataset with the select statement and filling up a table with the results. Im not exactly connecting to my DB because I already filled a dataset locally. </p>\n\n<p>------Edit ------\nI really just need a way to create an array of data rows from a query of two tables.</p>\n"},{"tags":["linq","entity-framework","enums"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13153646,"title":"Using Enums inside EF queries","body":"<p>I have following query (EF5, .NET4.5):</p>\n\n<pre><code>from p in repository\nselect new Person() {\n    Name = p.Name, \n    Birthday = p.Birthday,\n    MyEnumValue = MyEnum.Value1\n};\n</code></pre>\n\n<p>where <em>MyEnumValue</em> is <strong>enum</strong> defined like:</p>\n\n<pre><code>public enum MyEnum : byte\n{\n    Value1 = 1,\n    Value2 = 2\n}\n</code></pre>\n\n<p>At runtime this code causing the exception:</p>\n\n<p><em>The specified cast from a materialized 'System.Byte' type to the 'MyApp.Domain.Models.MyEnum' type is not valid.</em></p>\n\n<p>But if I change enum definition to</p>\n\n<pre><code>public enum MyEnum { ... }\n</code></pre>\n\n<p>all works fine.</p>\n\n<p>Is it possible to fix exception don't change MyEnum to int? (and without additional byte property :) )</p>\n"},{"tags":["c#","linq","entity-framework","linq-to-entities"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":818,"score":3,"question_id":5500657,"title":"problem with navigation properties in entity framework","body":"<p>When I execute this query I can navigate in <code>TypeP</code> property:</p>\n\n<pre><code>var items = from item in context.ProductosBodegas.Include(\"Product.TypeP\")\n            select item;\n</code></pre>\n\n<p>But when I execute this query the <code>TypeP</code> Property is <code>null</code>:</p>\n\n<pre><code>var items = from item in context.ProductosBodegas.Include(\"Product.TypeP\")\n            select item.Product;\n</code></pre>\n\n<p>Why is this?</p>\n"},{"tags":["linq","ilist"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13167824,"title":"IList query modify one object based on another IList object - such as distinct in sql","body":"<p>I'm trying to write something that will distinct-ify a list, and if multiples are found set properties within the distinct list.  Such as a counter on how many instances of something occurs, and maybe the last date of the occurrence.\nThis is what I have so far.</p>\n\n<pre><code>foreach(DataObject srcObj in ilSource){\n    if (ilDest.All(x =&gt; x.Property1 != srcObj.Property1 || x.srcObj != srcObj.Property2))\n        ilDest.Add(srcObj);\n    else\n        DataObject newObject = ilDest.SingleOrDefault(x =&gt; x.Property1 == srcObj.Property1 &amp;&amp; x.Property2 == srcObj.Property2);\n        newObject.Propert3++;\n        newObject.Property4 = srcObj.Property5;\n}\n</code></pre>\n\n<p>The newObject properties are not retained, once the next iteration happens because the object is not setting back within the collection.  Without Linq I would just iterate manually through the collection, grab the object and make the changes and move on to the next, because I have a true copy of the object.</p>\n\n<p>Thanks in advance for any help you can contribute</p>\n"},{"tags":["c#","linq","table","join","multi-level"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13157436,"title":"C# Linq Joining tables with multi-level","body":"<p>I am trying to query the 3rd level table ef_staff table 3 times to get 3 diff staff objects for each row. How to translate this in LINQ? </p>\n\n<pre><code>SELECT a.a_appraisalid, a.a_year, c.s_staffName, c2.s_staffName, c3.s_staffName\nFROM   ef_appraisal a, idp_application b, ef_staff c, ef_staff c2, ef_staff c3\nWHERE  a.a_appraisalid = b.a_appraisalid AND\n       a.a_staffid = c.s_staffid AND\n       a.a_appraisedby = c2.s_staffid AND\n       a.a_reviewedby = c3.s_staffid\n</code></pre>\n\n<p>I have been trying many ways but there is still an error 'Type Inference Failed' in the 2nd &amp; 3rd joining of Staff. What am I missing here?</p>\n\n<pre><code>from application in applications\n\njoin appraisal in pmsEntities.ef_appraisal on application.a_appraisalid equals appraisal.a_appraisalid\n\njoin staff in pmsEntities.ef_staff on appraisal.a_staffid equals staff.s_staffid\n\njoin appraiser in pmsEntities.ef_staff on staff.s_appraisedby equals appraiser.s_staffid into ap\n\nfrom appraiser in ap.DefaultIfEmpty() \n\njoin reviewer in pmsEntities.ef_staff on staff.s_reviewedby equals reviewer.s_staffid into rv\n\nfrom reviewer in rv.DefaultIfEmpty() \n\njoin company in pmsEntities.ef_company on appraisal.a_companyid equals company.c_companyid into jc\n\nfrom company in jc.DefaultIfEmpty()\n\nselect appraisal, staff.staffName, appraiser.staffName, reviewer.staffName, company.compName\n</code></pre>\n\n<p>Many Thanks! </p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1485,"score":5,"question_id":4703046,"title":"sum of timespans in c#","body":"<p>I have a collection of objects that include a timespan variable:</p>\n\n<pre><code>MyObject\n{ \n    TimeSpan TheDuration { get; set; }\n}\n</code></pre>\n\n<p>I want to use linq to sum those times.\nOf course, (from r in MyCollection select r.TheDuration).Sum(); doesn't work!</p>\n\n<p>I'm thinking of changing the datatype of TheDuration to an int and then summing it and converting the sum to a TimeSpan. That'll be messy because each TheDuration in my collection is used in as a timespan somewhere else.</p>\n\n<p>Any suggestion on this summation?</p>\n"},{"tags":["c#","linq","odata"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13166379,"title":"OData Linq to Query String","body":"<p>I'm using Web API with OData Query support (nighties) and while I'm aware that the WCF library gives you the ability to query WCF RIA Service URLs what I'm looking for is a lightweight way of generating Odata Query strings sort of like LinqPad does but more generically.</p>\n\n<p>For instance if we know that a service returns a specific type of say \"ProductDTO\", I want to be able to do something like this:</p>\n\n<pre><code>(from p in ODataSource&lt;ProductDTO&gt;\n where p.Name == \"hi\"\n select new {p.Model, Name}).ToODataQuery();\n</code></pre>\n\n<p>Which would return the appropriate $filter and $select commands as a string that can be appended to the URL.</p>\n\n<p>Anyone know of any library that can do something like this?</p>\n"},{"tags":["sql","linq","query"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1467,"score":5,"question_id":6190620,"title":"how to convert linq query to sql","body":"<p>Just trying to get the sql that is generated by a linq query.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13165769,"title":"Take a range of values from collection","body":"<p>Given a list such as this...</p>\n\n<pre><code>string[] fields = new[]\n{\n     \"Value1\", \n     \"TableStart:Value2\", \n     \"Value3\", \n     \"Value4\", \n     \"TableEnd:Value2\", \n     \"Value5\", \n     \"Value6\"\n};\n</code></pre>\n\n<p>Is there a way I can retrieve all information between the \"TableStart\" and \"TableEnd\" statements without writing a loop?  I thought Linq might have some way of achieving this but I could not come up with one.</p>\n\n<p>In the example above I would expect a list containing \"Value3\" and \"Value4\".</p>\n"},{"tags":["linq","selectmany"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":2000,"score":5,"question_id":4283866,"title":"Different ways of using SelectMany()","body":"<p>i'd like to know how to use <code>SelectMany()</code> . it seems to take so many arguments and from my own resreach i noticed that <code>selectmany</code> might be the 'father' of all other select operations. </p>\n"},{"tags":["c#","linq","dynamic","filtering"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13163956,"title":"Filter IQueryable<dynamic> given user input","body":"<p>Is there a way to do something like this:</p>\n\n<pre><code>//Create Connection.\nNMBSReportViewer.Models.SchoolEntities db = new NMBSReportViewer.Models.SchoolEntities();\n\n//Get the Data Using the Report's Stored QueryString.\nString QueryString = report.Query; //\"SELECT VALUE c FROM SchoolEntities.Courses AS c WHERE c.Credits &gt; 0\";\nIQueryable&lt;dynamic&gt; data = db.CreateQuery&lt;dynamic&gt;(QueryString);\n\n//Given String FieldName, String Operator, &amp; String Value, from user, Filter the Above dataset.\ndata.Where(c =&gt; c.'FieldName' 'Operator' 'Value');\n</code></pre>\n\n<p>I'm assuming there's nothing like I have above, but is there a way to achieve the same end result?\nI am going to have Dropdownlists of the Fields and operators for the user and then they will input a value they want in a textbox for the three values, so the FieldName is should always be a viable field in the set.</p>\n\n<p>Is there a way in LINQ to do such a thing? \nIf there isn't a way to do that...\nIs there a way to create an IQueryable with a static type of \"SchoolEntities.Course\" given just the string?</p>\n"},{"tags":["c#","asp.net","linq","session","linq-to-entities"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":81,"score":6,"question_id":12561058,"title":"ASP.NET Session and LINQ","body":"<p><strong>Hi guys!\nI have a question regarding a project Im working on at the moment.\nI have this line of code:</strong></p>\n\n<pre><code> var query = from user in dwe.UsersTable\n                        where user.LoginName.Equals(usernameBox.Text) &amp;&amp; user.Password.Equals(pwBox.Text)\n                        select user;\n\n        if (query.Count() == 1)\n        {\n            Session[\"User\"] = usernameBox.Text;                     \n            Response.Redirect(\"Edit.aspx\");\n        }\n        else\n        {\n            LabelError.Text = \"Error try again\";\n        }\n    }\n</code></pre>\n\n<p>In my \"UsersTable\" i have a coulmn named \"UserID\". <strong>I want to</strong> send the \"userID\" as a session to the redirected page (Edit.aspx) the userID must equal the result of comparression between Username and password.</p>\n\n<p>Cheers :-)</p>\n"},{"tags":["c#","linq","dictionary"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":57,"score":3,"question_id":13164317,"title":"Linq strange behviour with dictionaries","body":"<p>I have come across through a strange behaviour of Linq : with two linq expressions that might seem identical I have different results! If I loop once I get the same result, but above it finds nothing.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>        Dictionary&lt;String, String&gt; mainDico = new Dictionary&lt;String, String&gt;();\n        mainDico.Add(\"key1\", \"value1\");\n        mainDico.Add(\"key2\", \"value2\");\n\n        List&lt;Dictionary&lt;String, String&gt;&gt; ls = new List&lt;Dictionary&lt;String, String&gt;&gt;();\n\n        Dictionary&lt;String, String&gt; fistDico = new Dictionary&lt;String, String&gt;();\n        fistDico.Add(\"key1\", \"value1\");\n        fistDico.Add(\"key2\", \"value2\");\n\n        Dictionary&lt;String, String&gt; secondDico = new Dictionary&lt;String, String&gt;();\n        secondDico.Add(\"key1\", \"other\");\n        secondDico.Add(\"key2\", \"other\");\n\n        ls.Add(fistDico);\n        ls.Add(secondDico);\n\n\n        IEnumerable&lt;Dictionary&lt;String, String&gt;&gt; failQuery = from p in ls\n                                                            select p;\n\n        IEnumerable&lt;Dictionary&lt;String, String&gt;&gt; successfulQuery = from p in ls\n                                                            select p;\n\n        String[] items = new String[] { \"key1\",\"key2\" }; // with one element it works\n\n        foreach (var item in items)\n        {\n            String temp = mainDico[item];\n            failQuery = failQuery.Where(p =&gt; p[item] == temp);\n            successfulQuery = successfulQuery.Where(p =&gt; p[item] == mainDico[item]);\n        }\n\n        Console.WriteLine(successfulQuery.SingleOrDefault() != null);//True\n        Console.WriteLine(failQuery.SingleOrDefault() != null);//False\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":13162830,"title":"Forgiving/Fuzzy search with LINQ","body":"<p>I'm attempting to implement a search against a DB that I inherited. The requirement states that the user must be able to search for an object by name. Unfortunately, an object could have multiple names associated with it. For example:</p>\n\n<blockquote>\n<pre><code>ID    Name\n1     John and Jane Doe\n2     Foo McFoo\n3     Boo McBoo\n</code></pre>\n</blockquote>\n\n<p>It's easy enough to implement a search when a single name exists in each record:</p>\n\n<pre><code>var objects =  from x in db.Foo\n               where x.Name.Contains(\"Foo McFoo\")\n               select x;\n</code></pre>\n\n<p>However, when multiple names exist, that approach does not work.</p>\n\n<p><strong>Question:</strong> Is it possible to write a search method that would return record one (John and Jane Doe) when someone uses the search terms <code>John Doe</code> or <code>Jane Doe</code>?</p>\n"},{"tags":["vb.net","linq","stored-procedures"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13163450,"title":"Stored Procedures using LINQ with VB.Net","body":"<p>Newby here and I cant understand why the data isnt staying in the table.</p>\n\n<p>The Stored Procedure:</p>\n\n<pre><code>ALTER PROCEDURE dbo.AccountAdd\n\n        @AccountName nvarchar(50)\n       ,@Address1 nvarchar(50)\n       ,@Address2 nvarchar(50)\n       ,@Address3 nvarchar(50)\n       ,@Town nvarchar(50)\n       ,@County nvarchar(50)\n       ,@Postcode nvarchar(10)\n       ,@Phone1 nvarchar(50)\n       ,@Phone2 nvarchar(50)\n       ,@Phone3 nvarchar(50)\n       ,@Email1 nvarchar(50)\n       ,@Email2 nvarchar(50)\n       ,@ContactName nvarchar(50)\n       ,@Position nvarchar(50)\n       ,@AccountType nvarchar(50)\n       AS\nINSERT INTO [dbo].[Accounts]\n       ([AccountName]\n       ,[Address1]\n       ,[Address2]\n       ,[Address3]\n       ,[Town]\n       ,[County]\n       ,[Postcode]\n       ,[Phone1]\n       ,[Phone2]\n       ,[Phone3]\n       ,[Email1]\n       ,[Email2]\n       ,[ContactName]\n       ,[Position]\n       ,[AccountType])\n VALUES\n       (@AccountName\n       ,@Address1\n       ,@Address2\n       ,@Address3\n       ,@Town\n       ,@County\n       ,@Postcode\n       ,@Phone1\n       ,@Phone2\n       ,@Phone3\n       ,@Email1\n       ,@Email2\n       ,@ContactName\n       ,@Position\n       ,@AccountType)\n RETURN @@IDENTITY\n</code></pre>\n\n<p>The VB Code:</p>\n\n<pre><code>Dim db As New DBClassesDataContext\n\n\nPrivate Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click\n    db.Connection.Open()\n    Dim q = db.AccountAdd(\"Mark Cooney\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\", \"vv\")\n\n\n    db.Connection.Close()\n    Label1.Text = q\nEnd Sub\n</code></pre>\n\n<p>So when I click button1, q equals a new id but the data isnt there!!</p>\n\n<p>What am I missing please? Sorry I'm trying to understand LINQ</p>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13162060,"title":"Linq c# use between on time span","body":"<p>I have two field in data base named \"StartTime\" and \"EndTime\"</p>\n\n<p>I have saved a record as </p>\n\n<pre>\nStartTime           EndTime\n05:00:00.0000000    06:00:00.0000000\n</pre>\n\n<p>I want to display an error message if another record is inserted at the same or between 05:00:00.0000000 to 06:00:00.0000000 </p>\n\n<p>This means no matter what the start and end times are it should not occur between 05 to 06.</p>\n\n<pre>\n04 to 06 - Show error\n04:30 to 06 - Show error\n05:00 to 07 - Show error\n</pre>\n\n<p>How I achieve this using linq?</p>\n\n<p>This is my current attempt, which does not generate the proper results:</p>\n\n<pre><code>string _timepicker_start = collection[\"timepicker_start\"];\nstring _timepicker_end = collection[\"timepicker_end\"];\nTimeSpan _end = new TimeSpan(Convert.ToInt16(_timepicker_end.Split(':')[0])\n    ,  Convert.ToInt16(_timepicker_end.Split(':')[1]), 00);\nTimeSpan _start = new TimeSpan(Convert.ToInt16(_timepicker_start.Split(':')[0])\n    , Convert.ToInt16(_timepicker_start.Split(':')[1]), 00);\n\nvar _schedule = _db.Classes\n                 .Where(c =&gt; c.StartTime &lt;= _start &amp;&amp; c.EndTime &gt;= _end)\n                .FirstOrDefault(); \n\nif (_schedule != null)\n{\n    // Show message already have record.. \n}\n</code></pre>\n\n<p>It does not work properly please suggest me.</p>\n"},{"tags":["linq","query","exception","table","datacontext"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":909,"score":1,"question_id":4414523,"title":"LINQ Exception: \"Queries with local collections are not supported.\" but not using a local collection","body":"<p>Using the AdventureWorks database's Products table as the example, I have created a DBML and extended the properties of the DataContext to include a new property:</p>\n\n<pre>\npartial class AdventureWorksDataContext\n{\n  public IQueryable&lt;Product&gt; FinishedProducts\n  {\n    get { return Products.Where(p => p.FinishedGoodsFlag); }\n  }\n}\n</pre>\n\n<p>The Products property is part of the generated DataContext and all I've done is add a Where from the Table&lt;Product&gt; so it returns an IQueryable.</p>\n\n<p>Now, the problem comes in when trying to query it like this (dumb example but one that should show the problem):</p>\n\n<p><code>var queryFinishedProducts = datacontext.FinishedProducts.Where(fp =&gt; fp.ProductID == datacontext.FinishedProducts.Max(p =&gt; p.ProductID));</code></p>\n\n<p>Iterating this query results in \"Queries with local collections are not supported\" exception. I don't understand why it would throw that error when there are no local collections being used. If I run it against the normal Products table (which is a <code>Table&lt;Product&gt;</code>):</p>\n\n<p><code>var queryProducts = datacontext.FinishedProducts.Where(fp =&gt; fp.ProductID == datacontext.Products.Max(p =&gt; p.ProductID));</code></p>\n\n<p>...it works fine. The only difference is that I added a Where to the <code>Table&lt;Product&gt;</code> and returned it as an <code>IQueryable&lt;Product&gt;</code>.</p>\n\n<p>Anyone have any ideas? TIA</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13162057,"title":"Retrieving ids from a LINQ query result","body":"<p>I am working with a library that performs an operation (I think with LINQ) in a function and returns a collection of objects like this:</p>\n\n<pre><code>System.Collections.Generic.IEnumerable&lt;ColorInformation&gt;\n</code></pre>\n\n<p>this \"ColorInformation\" is a class that looks like this:</p>\n\n<pre><code>public class ColorInformation\n{\n    private readonly System.Drawing.Color color;\n    private readonly string rowTitle;\n    private readonly System.Collections.Generic.List&lt;int&gt; ids;\n\n    public ColorInformation(System.Drawing.Color color, string rowTitle,\n        System.Collections.Generic.List&lt;int&gt; ids)\n    {\n        this.color = color;\n        this.rowTitle = rowTitle;\n        this.ids = ids;\n    }\n\n    public string RowTitle\n    {\n        get { return rowTitle; }\n    }\n\n    public System.Drawing.Color Color\n    {\n        get { return color; }\n    }\n\n    public System.Collections.Generic.List&lt;int&gt; Ids\n    {\n        get { return ids; }\n    }\n}\n</code></pre>\n\n<p>I am interested in retrieving ALL the ids of ALL the objects in the collection returned. I have tried this:</p>\n\n<pre><code>var myids = from ids in theCollectionReturned select ids.Ids;\n</code></pre>\n\n<p>That gives me a Collection of Lists with the ids. What I actually want is just one list with ALL the integer ids in it. So, there has to be a cast or some conversion somewhere and I am not sure how to do that. Any help, tips, readings, code, examples would be appreciated.\nThanks!</p>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13161496,"title":"linq joint type inference failed to call 'join' error","body":"<p>i have 3 tables User, TeamMember and Assessment all three have the user_id column, User is linked to TeamMember by userid and TeamMember and Assessment are linked with user_id(TeamMember) &amp; rater,rated(Assessment) </p>\n\n<p>Im trying to join in with this</p>\n\n<pre><code>          from a in db.Assessments\n                         join u in db.Team_Members on a.rated equals u.user_id\n                         join u2 in db.Team_Members on a.rater equals u2.user_id\n</code></pre>\n\n<p>It's throwing this error</p>\n\n<blockquote>\n  <p>The type of one of the expressions in the join clause is incorrect. \n  Type inference failed in the call to 'Join'.</p>\n</blockquote>\n\n<p>Any idea what going on?</p>\n"},{"tags":["c#","linq","join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13158925,"title":"join empty DataTables, show anyhow the Headers of the columns","body":"<p>I have a question about Linq join. I always had many DataTables and join them, worked great. But now if those Tables are empty, so Header of this columns is not able to see either. How can i do that, if those Tables are empty,  they show anyhow those headers.</p>\n\n<p>Table 1:</p>\n\n<pre><code>Name  LastName ...\n</code></pre>\n\n<p>Table 2:</p>\n\n<pre><code>Name Comment ...\n</code></pre>\n\n<p>Result: </p>\n\n<pre><code>Name LastName Comment ...\n</code></pre>\n\n<p>My Code would be:</p>\n\n<pre><code>var res = from tb1 in Table1.AsEnumerable()\n          join tb2 in Table2.AsEnumerable()\n          on tb1.Field&lt;String&gt;(\"Name) equals tb2.Filed&lt;String&gt;(\"Name\")\n          Select new {\n          Name = tb1.Field&lt;String&gt;(\"Name\"),\n          LastName= tb1.Field&lt;String&gt;(\"LastName\"),\n          Comment= tb2.Field&lt;String&gt;(\"Comment\"),\n</code></pre>\n\n<p>But it doesn't show the headers of res. What did i do here wrong?\n              }</p>\n"},{"tags":["asp.net","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13160943,"title":"gridview row deleting","body":"<p>I have a grid view like below markup and it has a linqdatasource according to the below code. Now I like to add a column with delete command to the grid view, so I like to know how should be the code for grid view row deleting?</p>\n\n<pre><code>&lt;asp:GridView ID=\"GridViewTransToConForm\" runat=\"server\" AutoGenerateColumns=\"False\" DataSourceID=\"LinqDataSource1\" \n &gt;\n\n\n\n      &lt;Columns&gt;\n\n          &lt;asp:hyperlinkfield DataNavigateUrlFields=\"DocId\" \n  DataNavigateUrlFormatString=\"~/Documentfortest.aspx?DocId={0}\" DataTextField=\"DocNo\" \n  HeaderText=\"DocNo\" /&gt;\n          &lt;asp:BoundField DataField=\"title\" HeaderText=\"Title\" /&gt;\n          &lt;asp:BoundField DataField=\"rev\" HeaderText=\"Rev\" /&gt;\n          &lt;asp:BoundField DataField=\"status\" HeaderText=\"Status\" /&gt;\n\n      &lt;/Columns&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>protected void LinqDataSource1_Selecting(object sender, LinqDataSourceSelectEventArgs e)\n{\n    _DataContext = new EDMSDataContext();\n     e.Result =\n     from transmittal in _DataContext.tblTransmittalls\n     from transmittaltocon in _DataContext.tblDocTranstoCons\n      from document in _DataContext.tblDocuments\n     where (transmittal.DocID==transmittaltocon.Docid)&amp;&amp;(transmittal.TransId==transmittaltocon.Transid)\n     &amp;&amp; (document.DocId == transmittal.DocID) &amp;&amp; (transmittaltocon.TransmitToConid == _TransmitToConid)\n\n    orderby document.DocumentNo\n     select new\n     {\n     DocNo = document.DocumentNo,\n     Title = document.TITLE,\n     Rev = transmittal.REV,\n     Status = transmittal.PurposeofIssue,\n     DocId=document.DocId\n\n    };\n</code></pre>\n"},{"tags":["c#",".net","linq","list"],"answer_count":16,"favorite_count":13,"up_vote_count":61,"down_vote_count":0,"view_count":38090,"score":61,"question_id":41319,"title":"Checking if a list is empty with LINQ","body":"<p>What's the \"best\" (taking both speed and readability into account) way to determine if a list is empty? Even if the list is of type <code>IEnumerable&lt;T&gt;</code> and doesn't have a Count property.</p>\n\n<p>Right now I'm tossing up between this:</p>\n\n<pre><code>if (myList.Count() == 0) { ... }\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>if (!myList.Any()) { ... }\n</code></pre>\n\n<p>My guess is that the second option is faster, since it'll come back with a result as soon as it sees the first item, whereas the second option (for an IEnumerable) will need to visit every item to return the count.</p>\n\n<p>That being said, does the second option look as readable to you? Which would you prefer? Or can you think of a better way to test for an empty list?</p>\n\n<p><strong>Edit</strong> @lassevk's response seems to be the most logical, coupled with a bit of runtime checking to use a cached count if possible, like this:</p>\n\n<pre><code>public static bool IsEmpty&lt;T&gt;(this IEnumerable&lt;T&gt; list)\n{\n    if (list is ICollection&lt;T&gt;) return ((ICollection&lt;T&gt;)list).Count == 0;\n\n    return !list.Any();\n}\n</code></pre>\n"},{"tags":["asp.net-mvc","linq","many-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":100,"score":2,"question_id":4665886,"title":"Linq Many-to-Many relationship","body":"<p>I have 3 tables in my db. AdminGroup, AdminSection and joining these two AdminAccess.\nAdminGroup => AdminGroupId, AdminId\nAdminSection => AdminSectionId, Code, Desc\nAdminAccess => AdminSectionId, AdminGroupId</p>\n\n<p>I need to get a list of all Codes available given AdminId.\nThis is what I have so far:</p>\n\n<pre><code>this.AdminGroupRepository.List().Where(x =&gt; x.Admin.Any(y =&gt; y.AdminId == loginEntity.AdminId))\n</code></pre>\n\n<p>But this gives me a list of AdminGroups and I simply need a List of Codes.</p>\n\n<p><img src=\"http://i.stack.imgur.com/UuslZ.png\" alt=\"alt text\"></p>\n"},{"tags":["c#","xml","linq","list","treeview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13157353,"title":"C#/LINQ/Objects/Lists: How to populate a TreeView the good way?","body":"<p>I'm trying to display a bunch of information in a TreeView. For Example:</p>\n\n<pre><code>Continent 1\n    Country 1\n        City 1\n        City 2\n        City 3\n    Country 2\n        City 1\n        City 2\n    Country 3\nContinent 2\n    Country 1\n        City 1\n        City 2\nContinent 3\n</code></pre>\n\n<p>This information is stored in classes/objects via lists. So an object/class of type Continent includes a list with several objects/classes of type Country (of course also some methods, properties etc.). All data was populated via LINQ out of an XML file.</p>\n\n<p>Now, I could take the list with all continents inside - and foreach it. Inside this foreach, I foreach the list with all countries. And then I foreach...\nThe easy way, but this results in really nasty code, I think (my nodes go way deeper than 3 levels...)</p>\n\n<p>So is there an easy way to accomplish this? Maybe with LINQ? e.g.</p>\n\n<pre><code>TreeView.Nodes =\n    List[Countries].All.Where(Country.Name = Node.Text).Add(\n        (List[Cities].All.Where(City.Name = Node.Text).Add(\n            List[People].All.Where(Person.Name = Note.Text)));\n</code></pre>\n\n<p>I know, just rubbish code, but this way it would look way more beautiful than with all those nested foreachs.</p>\n\n<p>I hope you can help.</p>\n"},{"tags":["asp.net-mvc","linq","entity-framework",".net-3.5"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":671,"score":2,"question_id":4645166,"title":"LINQ parent child relation","body":"<p>I'm working on the BLOG functionality in MVC. I need to be able to create 'blog comments'. So each comment may have a parent comment etc.</p>\n\n<p>Given table \"Comments\":\nCommentId -> int -> identity autoincrement\nPostId -> int\nParentId -> int\nComment -> string</p>\n\n<p><img src=\"http://i.stack.imgur.com/nxi2T.png\" alt=\"alt text\">       </p>\n\n<p>Is there a way to get a list of comments for a given article ordered by CreateDate and ParentId?</p>\n\n<p>Or maybe there is a better table design you may suggest. What is the best design when inserting Post comments like this?</p>\n\n<p>I'm using Entity framework.</p>\n\n<p>thanks</p>\n"},{"tags":["c#","linq","join","concat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13156626,"title":"Join 2 DataTables with many columns","body":"<p>I have a question, want to join 2 tables with same column. Table 1 has Name, LastName Columns and many other columns, Table 2 has Name, Comment and many other Columns. I want to join them with Name column and as Result should be Name, LastName, Comment and other Columns. I tried with outer left Linq but don't know how to write select new because don't know how many other columns i have.  </p>\n\n<p>My Table 1:</p>\n\n<pre><code>Name1   LastName ...\nNiki   Row      ...\nHube   Slang    ...\nKoke   Mi       ... \n...    ...      ...\n...    ...      ...\n</code></pre>\n\n<p>Table 2:</p>\n\n<pre><code>Name  Comment   ...\nKoke   \"Hello\"  ...\nNiki   \"Hi\"     ...\n</code></pre>\n\n<p>Result should be:</p>\n\n<pre><code>Name   LastName   Comment ...\nNiki    Row        \"Hi\"   ...\nHube    Sland             ...\nKoke    Mi         \"Hello\"...\n...     ...               ...\n</code></pre>\n\n<p>So i tried to concat the rows with each others. But it said that the array from table1 is longer than array from table 2. Is there another way to join it?</p>\n\n<pre><code>        foreach (DataRow tbE in Table1.Rows)\n        {\n            foreach (DataRow opT in Table2.Rows)\n            {\n                if (tbE[\"Name\"].ToString() == opT[\"Name\"].ToString())\n                {\n                    var row = Result.NewRow();\n                    row.ItemArray = tbE.ItemArray\n                                       .Concat(opT.ItemArray).ToArray();\n\n                    Result.Rows.Add(row);\n                }\n                else\n                    Result.ImportRow(tbE);\n\n            }\n        } \n        Result.Columns.Remove(Name); \n</code></pre>\n"},{"tags":["c#","asp.net",".net","linq","dsl"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":70,"score":-2,"question_id":13156078,"title":"DSLs included as part of the .NET Framework","body":"<p>What are examples of standard DSL constructs which are included as part of the .NET Framework?</p>\n\n<p>Definition of a DSL according to <a href=\"http://en.wikipedia.org/wiki/Domain-specific_language\" rel=\"nofollow\">Wikipedia</a>:</p>\n\n<blockquote>\n  <p>In software development and domain engineering, a <strong>domain-specific language</strong> (DSL) is a programming language or specification language dedicated to a particular problem domain, a particular problem  representation technique, and/or a particular solution technique.</p>\n</blockquote>\n\n<p><strong>What I have so far:</strong></p>\n\n<ul>\n<li>LINQ query expressions</li>\n<li>XPath expressions</li>\n<li>Regular expressions</li>\n<li>Date, time and currency formatting - the String.Format() method</li>\n</ul>\n\n<p>EDIT:  Clarification on LINQ</p>\n"},{"tags":["linq","entity-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13156693,"title":"Linq Left outer Join with all columns select and bind to Gridview","body":"<p>I am trying to bind grid view with Linq Left outer join (I want to select all columns from \"prdct in context.Products\")My Query is</p>\n\n<pre><code>     gridProducts.DataSource = (from prdct in context.Products\n                                      join comp in context.ProductCompanies\n                                      on prdct.productCompany equals comp.prdctCompId into firstJoin\n                                      from fj in firstJoin.DefaultIfEmpty()\n\n                                      join cat in context.ProductCategories on prdct.productCategory equals cat.prdctCatId\n                                      into finalresult\n                                      from fr in finalresult.DefaultIfEmpty()\n                                      select new\n                                      {\n                                          prd = prdct,\n                                          fj.prdctCompName,\n                                          fr.prdctCatName\n\n                                      }).ToList();\n\n\n            gridProducts.DataBind();\n</code></pre>\n\n<p>I have checked the SQL generated by query it is showing records in SQL server but it throws error in my application while binding to gridveiw. Error is :</p>\n\n<pre><code>   The data source for GridView with id 'grdD' did not have any properties or attributes from which to generate columns.  Ensure that your data source has content.\n</code></pre>\n"},{"tags":["sql","performance","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13155738,"title":"SQL vs LINQ performance","body":"<p>We currently have a self-made entity framework that relies on a DB-indipendent ORM.</p>\n\n<p>I have to build a software that batch-loads metadata in the DB for about 150 excel template (with info on cell position, cell type, formatting and more).</p>\n\n<p>I can operate</p>\n\n<ul>\n<li><p>via SQL batch (faster but less interactive)</p></li>\n<li><p>via building objects in memory, processing them with LINQ queries for various integrity checks, and then committing modifications to the DB</p></li>\n</ul>\n\n<p>I know that SQL is absolutely faster, but I would know... <strong>how much is it faster?</strong></p>\n\n<p>In detail, how much is a SQL query faster then a LINQ query <em>(assuming that all needed data has been already loaded in memory by ORM)</em> ?</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13150019,"title":"Adding conditions in dynamic linq","body":"<p>I want to write a dynamic linq query that checks for 'where' condition based on two time frames, startTime and errorTime. \nThe present code is here,</p>\n\n<pre><code>IQueryable&lt;LogFormat&gt; errorLines = null;\nif (!string.IsNullOrEmpty(errorStartTime) &amp;&amp; !string.IsNullOrEmpty(errorTime))\n{\n    var sTime = DateTime.Parse(errorStartTime);\n    var eTime = DateTime.Parse(errorTime);\n    errorLines = from errorLine in File\n                 where\n                     (errorLine.DateTime &gt;= sTime &amp;&amp; errorLine.DateTime &lt;= eTime) &amp;&amp;\n                     (\n                     errorLine.Level == \"ERR\"\n                     || errorLine.Level == \"WARN\"\n                     )\n                 select errorLine;\n}\nelse if (!string.IsNullOrEmpty(errorStartTime))\n{\n    var sTime = DateTime.Parse(errorStartTime);\n    errorLines = from errorLine in File\n                 where\n                     errorLine.DateTime &gt;= sTime\n                     &amp;&amp;\n                     (\n                     errorLine.Level == \"ERR\"\n                     || errorLine.Level == \"WARN\"\n\n                     )\n                 select errorLine;\n\n}\nelse if (!string.IsNullOrEmpty(errorTime))\n{\n    var eTime = DateTime.Parse(errorTime);\n\n    errorLines = from errorLine in File\n                 where\n                     errorLine.DateTime &lt;= eTime\n                     &amp;&amp;\n                     (\n                     errorLine.Level == \"ERR\"\n                     || errorLine.Level == \"WARN\"\n                   )\n                 select errorLine;\n\n}\nelse\n{   \n    errorLines = from errorLine in File\n                 where\n                     errorLine.Level == \"ERR\"\n                     || errorLine.Level == \"WARN\"\n\n\n                 select errorLine;\n\n}\n</code></pre>\n\n<p>Can I know how to have just one query so that I can send start time and errortime dynamically to get the results?</p>\n"},{"tags":["c#","linq","resources"],"answer_count":3,"favorite_count":0,"up_vote_count":27,"down_vote_count":2,"view_count":389,"score":25,"question_id":10849643,"title":"Using IDisposable object in method that returns IEnumerable<T>","body":"<p>Imagine you have a method that internally uses an IDisposable object (for example a streamreader), and yield returns items as they are read from the file. Like this:</p>\n\n<pre><code>public IEnumerable&lt;YourObject&gt; Read(string filename)\n{\n    using(var filestream = new FileStream(filename, FileMode.Open))\n    {\n        using(var reader = new StreamReader(filestream))\n        {\n            string line;\n\n            while((line = reader.ReadLine()) != null)\n            {\n                yield return new YourObject(line);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Will the <code>reader</code> and the <code>filestream</code> be disposed when I use LINQ-methods that doesn't iterate the complete collection?</p>\n\n<pre><code>YourOjbect firstLine = Read(\"myfile.txt\").First();\n</code></pre>\n"},{"tags":["c#","linq","crystal-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13154424,"title":"C# how to populate a crystal report using LINQ","body":"<p>I am tring to populate a crystal report using LINQ.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>var results = (from supp in dbdata.Suppliers select supp).ToList();\ncr1.Load(@\"CrystalReport1.rpt\");\ncr1.SetDataSource(results);\ncrystalReportViewer1.ReportSource = cr1;\n</code></pre>\n\n<p>When I run the application it generates an error:</p>\n\n<blockquote>\n  <p>DataSet does not support System.Nullable&lt;>.</p>\n</blockquote>\n\n<p>How do I fix this?</p>\n"},{"tags":["c#","linq","datatable","ienumerable"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":66,"score":0,"question_id":13153310,"title":"C# how to convert IEnumerable anonymous lists into data table","body":"<p>Many solutions are available that convert lists to <code>DataTable</code> that use reflection, and that would work for converting anonymous types. However, it there are <em>lots</em> of lists of anonymous types, then performance can be an issue.</p>\n\n<p>Is this the only way to create a <code>DataTable</code> from a list? Are there faster ways of doing this?</p>\n"},{"tags":["c#","arrays","algorithm","linq"],"answer_count":8,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":158,"score":5,"question_id":13109301,"title":"How to return arrays with the biggest elements in C#?","body":"<p>I have multiple int arrays:</p>\n\n<pre><code>1) [1 , 202,4  ,55]\n2) [40, 7]\n3) [2 , 48 ,5]\n4) [40, 8  ,90]\n</code></pre>\n\n<p>I need to get the array that has the biggest numbers in all positions. In my case that would be array #4. Explanation:</p>\n\n<ul>\n<li>arrays #2, #4 have the biggest number in 1st position, so after the first iteration these 2 arrays will be returned ([40, 7] and [40, 8  ,90])</li>\n<li>now after comparing 2nd position of the returned array from previous iteration we will get array #4 because 8 > 7</li>\n<li>and so on...</li>\n</ul>\n\n<p>Can you suggest an efficient algorithm for this? Doing with Linq will be preferable.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>There is no limitation for the length, but as soon as some number in any position is greater, so this array is the biggest.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13150312,"title":"Linq query with where conditions (x && x) || (x & x)","body":"<pre><code>char[] delimiter = new char[] {' '};\n\nstring[] names = name.Trim().Split(delimiter, StringSplitOptions.RemoveEmptyEntries);\n\nemployees = (List&lt;CMSUser&gt;)employees.Where(\n                    e =&gt; \n                       (e.FirstName.Contains(names[0]) &amp;&amp; e.LastName.Contains(names[1])) ||\n                       (e.LastName.Contains(name[0]) &amp;&amp; e.FirstName.Contains(name[1]))\n                     )\n</code></pre>\n\n<p>Above, I am trying to use Linq lambda to query employees List. I need to split the search term entered in input box for space character and use it to pull from employees list matching (FirstName &amp;&amp; LastName) OR (LastName &amp;&amp; FirstName) containing those two search words separated by space.</p>\n\n<p>I don't know what I am doing wrong in query condition. It is returning all employees in list rather than giving those matching condition.</p>\n"},{"tags":[".net","linq","entity-framework","many-to-many","expression-trees"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":13102342,"title":"Build a nested lambda Expression Tree for an Entity Framework Many to Many relationship?","body":"<p>I am trying to build an Entity Framework 4 Many to Many relationship filter, this is for a Dynamic Data project.  I know that I need to build an Expression Tree at run time, and I am familiar with doing this for something like a simple where expression like this:</p>\n\n<pre><code>private MethodCallExpression BuiltMethodCall(IQueryable _query, Type _ObjType, string _ColumnToSearch, string _SearchValue)\n{\nConstantExpression value = Expression.Constant(_SearchValue);\nParameterExpression _parameter = Expression.Parameter(_ObjType, \"value\");\nMemberExpression _property = Expression.Property(_parameter, _ColumnToSearch);\nBinaryExpression comparison = Expression.Equal(_property, value);\nLambdaExpression lambda = Expression.Lambda(comparison, _parameter);\n\n//Ex: Customers.Select(c =&gt; c).Where(value =&gt; (value.City == \"Seattle\"))\nMethodCallExpression _where = Expression.Call(typeof(Queryable), \"Where\", new Type[] { _query.ElementType }, new Expression[] {\n    _query.Expression,\n    Expression.Quote(lambda)\n});\nreturn _where;\n\n}\n</code></pre>\n\n<p>Just for simplicity, these examples use the Northwind database where there is a many to many join of (Customers &lt;- CustomerCustomerDemo -> CustomerDemographics). What I am having trouble with is building the expression tree when there is a nested lambda like in the expression below, where I am retrieving all customers who have a specific customer demographic.</p>\n\n<pre><code>string custDemogID = \"3\";\n\n//Get customers who have a particular demog\ndynamic cust = context.Customers.Where(c =&gt; c.CustomerDemographics.Any(cd =&gt; cd.CustomerTypeID == custDemogID));\n</code></pre>\n\n<p>How do I build the Expression tree having a \"where\" call, that includes the nested lambda for the \"Any\"?  Any help is appreciated, even if it is pseudo code on how to do it.  There is not much out the on this, I am desperate, please help!</p>\n"},{"tags":[".net","linq","entity-framework-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13147341,"title":"Linq to Entities DefaultIfEmpty","body":"<p>I'm using EF 4 to PostgreSQL using a 3rd party ADO.NET provider.  In my data source, I have no item lines that match items based on this join condition.  For this reason I expect query 1 to fail based on a null reference exception.  However, it completes and gives me value type defaults for each of the properties on il. item_display_name is a string so ilName is set to null.  ilStartDate is set to DateTime's default.  x.il.item_id and x.il.item_line_no are both 0. </p>\n\n<pre><code>var query1 =\n                    _db.items\n                      .GroupJoin(_db.item_line.Where(x =&gt; x.start_date == selectedStartDate), x =&gt; x.item_id, il =&gt; il.item_id, (x, ilgroup) =&gt; new { x, ilgroup })\n                      .SelectMany(x =&gt; x.ilgroup.DefaultIfEmpty(), (x, il) =&gt; new { x.x, il })\n                      .Select(x =&gt;\n                          new\n                              {\n                                    itemId = x.x.item_id,\n                                    ilName = x.il.item_display_name,\n                                    ilStartDate = x.il.start_date,\n                                    ilItemId = x.il.item_id,\n                                    orderLine = x.il.item_line_no});\n</code></pre>\n\n<p>However, if I force execution by calling ToArray on my results before the Select, I then get my null reference exception.</p>\n\n<pre><code>var query2 =\n                _db.items\n                    .GroupJoin(_db.item_line.Where(x =&gt; x.start_date == selectedStartDate), x =&gt; x.item_id, il =&gt; il.item_id, (x, ilgroup) =&gt; new {x, ilgroup})\n                    .SelectMany(x =&gt; x.ilgroup.DefaultIfEmpty(), (x, il) =&gt; new {x.x, il}).ToArray()\n                    .Select(x =&gt;\n                            new\n                                {\n                                    itemId = x.x.item_id,\n                                    ilName = x.il.item_display_name,\n                                    ilStartDate = x.il.start_date,\n                                    ilItemId = x.il.item_id,\n                                    orderLine = x.il.item_line_no});\n</code></pre>\n\n<p>To my understanding, DefaultIfEmpty should return the default for that type.  My type is clearly a reference type, so why won't query 1 fail?</p>\n"},{"tags":["c#","linq","datatable"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13139366,"title":"c# linq query on data table to select all minimum values with duplicates","body":"<p>I've a data table like:</p>\n\n<pre><code>ChNo     ChData\n1         0.1\n1         0.2\n2         0.0\n1         0.1\n2         0.2\n1         0.1\n1         0.1\n2         0.0\n</code></pre>\n\n<p>For minimum values based on chNO's i written query like</p>\n\n<pre><code>var minLPData = from minData in loadProfileData.AsEnumerable()\n                                orderby minData[\"ChNo\"]\n                                group minData by minData[\"ChNo\"] into g                                \n                                select new\n                                {\n                                    ChNo = g.Key,\n                                    ChData = g.CopyToDataTable().Compute(\"Min(ChData)\", string.Empty)\n                                };\n</code></pre>\n\n<p>But result i'm getting like</p>\n\n<pre><code>ChNo     ChData\n1         0.0\n2         0.0\n</code></pre>\n\n<p>I want all minimums based on ChNo including duplicates</p>\n\n<pre><code>ChNo     ChData\n1         0.1\n1         0.1\n1         0.1\n1         0.1\n2         0.0\n2         0.0\n</code></pre>\n\n<p>What change make me to get target table.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13146857,"title":"Execute LINQ with or without where clause","body":"<p>In my example i want to get promotion elements for a promo code name that is provided if name is not provided then take all available promotions.</p>\n\n<pre><code>var result = from row in promoCodes.AsEnumerable() \n             where  (\n                 !String.IsNullOrEmpty(fieldTitle) &amp;&amp; \n                 !String.IsNullOrEmpty(filterValue) &amp;&amp; \n                 row[fieldTitle].Equals(filterValue)\n             ) || true\n             select new PromoCodeInfoContainer\n             {\n                 BannerLink = row[\"BannerLink\"] as string\n                 ....\n             };\n</code></pre>\n\n<p>I tried to follow SQL technique where if no conditions provided then OR will be whatever that doesn't impact selection (|| true). In linq this didn't work, it always returns all entries regardless of \"fieldTitle\" and \"filterValue\" are not empty. Can anybody suggest a right way to do it?</p>\n"},{"tags":["asp.net-mvc-3","linq","kendo-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":13107063,"title":"linq orderby not sorted asc not working","body":"<p>I have the following information return in the grid, but it would not order the record first order by firstname then family name. Please let me know how i can achieve this. I am currently using MVC4 and kendoui grid</p>\n\n<pre><code>public ActionResult Index()\n    {\n        return View();\n    }\n\npublic ActionResult GetSession([DataSourceRequest] DataSourceRequest request)\n{\n    Response.Cache.SetCacheability(HttpCacheability.NoCache);\n    return Json(GetAllSessionList().ToDataSourceResult(request),         JsonRequestBehavior.AllowGet);\n} \n private static IEnumerable&lt;ListsViewModel&gt; GetAllSessionList()\n    {\n        var context = new HEntities();\n\n        return context.vwSessionListConfigs\n            .OrderBy(x =&gt; x.FirstName).ThenBy(x =&gt; x.FamilyName)\n            .Select(session =&gt; new ListsViewModel\n            {\n                ConsumerID = session.ConsID,\n                ConsumerHCID = session.ConsHCL,\n                ConsumerHRN = session.ConsHRK,\n                ConsumerFirstName = session.FirstName,\n                ConsumerFamilyName = session.GivenName,\n                ConsumerGender = session.Gender,\n            });\n    }\n</code></pre>\n\n<p><strong>View:</strong></p>\n\n<pre><code>@(Html.Kendo().Grid&lt;Web_App.ViewModel.ListsViewModel&gt;()\n\n    .Name(\"SessionList\")\n    .HtmlAttributes(new { @Style = \"align:center; font-size:10px;\" })\n    .Columns(columns =&gt;\n    {\n        columns.Bound(p =&gt; p.ConsID).Visible(false);\n        columns.Bound(p =&gt; p.ConsHCL).Width(80);\n        columns.Bound(p =&gt; p.ConsHRK).Width(50);\n        columns.Bound(p =&gt; p.FirstName).Width(80);\n        columns.Bound(p =&gt; p.GivenName).Width(80);\n        columns.Bound(p =&gt; p.ConsumerAlias).Width(45);\n        columns.Bound(p =&gt; p.Gender).Width(30);\n\n        columns.Command(commands =&gt; commands.Edit()).Width(175);      \n    })\n    .Editable(editable =&gt; editable.Mode(GridEditMode.InLine))\n    .Pageable()\n    .Selectable(s =&gt; s.Mode(Kendo.Mvc.UI.GridSelectionMode.Single))\n    .Scrollable()\n    .DataSource(dataSource =&gt; dataSource\n        .Ajax()\n        .PageSize(10)\n        .ServerOperation(true)\n        .Model(model =&gt; model.Id(p =&gt; p.ConsID))\n        .Read(read =&gt; read.Action(\"GetSession\", \"Manage\").Type(HttpVerbs.Get))\n        .Update(\"Edit\", \"Manage\")         \n    )\n    .Events(events =&gt; events\n                            .Change(\"change\"))\n\n\n\n)\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":23,"score":0,"question_id":13145477,"title":"query a view with a list of data","body":"<p>How can I query a view with data in a list?</p>\n\n<p>For eg: Below, I have variable \"data\" where I store all the id's from a view to a list. I want to query a second view \"vwStatus\" such that it returns all the rows which has status displayed in the list(data)</p>\n\n<p>Something like:</p>\n\n<pre><code>public ActionResult Index(string id)\n{\n    var data = (from p in db.vwdb.Where(p =&gt; p.ID == id)\n                 group p by p.status into g select g.Key).ToList();\n\n    ViewData.Model = db.vwStatus.Where(p =&gt; p.Status == data);           \n\n    return View();\n}\n</code></pre>\n\n<p>Hope I made it clear.</p>\n"},{"tags":["c#","linq","entity-framework","linq-to-entities","entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13144622,"title":"Linq query syntax to method syntax when using multiple joins to introduce dynamic restrictions","body":"<p>I'm trying to translate a linq query using query keywords to the method syntax.\nMy ultimate goal is to be able to apply additonnal restrictions at runtime each time you see a <strong>Where</strong> clause in the query. I have a total of 14 different parameters to be applied. Some are mutually exclusive, other are inclusive.</p>\n\n<p>Here is the starting query :</p>\n\n<pre><code>query = from p in context.Person\nwhere p.Firstname.ToUpper().StartsWith(firstName.ToUpper())\njoin v in context.Visit on p.Id equals v.PersonId\nwhere !v.AccessionNumber.StartsWith(RISConst.PM_PREFIX)\njoin f in context.Finding on v.Id equals f.VisitId\njoin c in context.Consultation on f.Id equals c.FindingId\nwhere c.StudyId.ToUpper().CompareTo(studyId.ToUpper()) == 0\nselect v;\n</code></pre>\n\n<p>Using Jon Skeet's <a href=\"http://msmvps.com/blogs/jon_skeet/archive/2011/01/28/reimplementing-linq-to-objects-part-41-how-query-expressions-work.aspx\" rel=\"nofollow\">excellent blog post</a> I have been able to go that far :</p>\n\n<pre><code>query = context.Person.Where(p =&gt; p.Firstname.ToUpper().StartsWith(firstName.ToUpper()))\n.Join(context.Visit, p =&gt; p.Id, v =&gt; v.Id, (p, v) =&gt; new { p, v })\n.Where(z =&gt; z.v.AccessionNumber.StartsWith(RISConst.PM_PREFIX))\n.Select(z =&gt; z.v)\n.Join(context.Finding, v =&gt; v.Id, f =&gt; f.VisitId, (v, f) =&gt; new { v, f })\n.Select(t =&gt; t.f)\n.Join(context.Consultation, f =&gt; f.Id, c =&gt; c.FindingId, (f, c) =&gt; new { f, c })\n.Where( u =&gt; u.c.StudyId.ToUpper().CompareTo(studyId.ToUpper()) == 0)\n.Select(????);\n</code></pre>\n\n<p>Now I'm stuck because I need to return Visits. How can I do that ?</p>\n\n<p>Any Help appreciated.</p>\n"},{"tags":["c#",".net","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13129135,"title":"LINQ to SQL query Multiply two columns and calculate SUM","body":"<p>Here's the SQL query</p>\n\n<pre><code>Select sum(f.Acres*m.credit1), sum(f.Acres*m.credit2), sum(f.Acres*m.credit3)\nfrom first f join model m on f.Id = m.fID\nwhere m.year == 2012\n</code></pre>\n\n<p>How to write this above SQL in LINQ?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13143922,"title":"linq compare column data between two dates","body":"<p>I need to compare the scores of a user between last week and two weeks ago. </p>\n\n<p>i have a table like so\nScores</p>\n\n<pre><code>user   score  subject       date        \n 2      10     math       21/10/2012\n 2       5     science    23/10/2012\n 2       5     math       16/10/2012\n 2       9     science    15/12/2012\n</code></pre>\n\n<p>I need to produce a query that shows last week's score and whether it is an increase or decrease from 2 weeks ago's score</p>\n\n<pre><code>user   score    subject     date         increase/decrease\n 2       10      math     21/10/2012       +5\n 2       10      science  23/10/2012       -4\n</code></pre>\n\n<p>The date column doesn't need to be included in the query\nI already have the code to get week range from last week to two weeks ago. I'm having trouble comparing the two dates however.</p>\n\n<pre><code>DateTime date = DateTime.Now;\nDateTime startOneWeekAgo = date.AddDays(-7).Date.AddDays(-(int)date.DayOfWeek),\n         endOneWeekAgo = startOneWeekAgo.AddDays(7);\n\nDateTime startTwoWeeksAgo = startOneWeekAgo.AddDays(-7),\n         endTwoWeeksAgo = endOneWeekAgo.AddDays(-7);\n</code></pre>\n\n<blockquote>\n  <p>from s in Scores where s.scoredate >= startOneWeekAgo &amp;&amp; s.scoredate &lt;\n  endOneWeekAgo</p>\n</blockquote>\n\n<p>this results in. This is what I have so far. Help would be appreciated.</p>\n\n<pre><code>user score subject\n2     10    math\n2     5     science\n</code></pre>\n"},{"tags":["c#",".net","linq","api","umbraco"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13144017,"title":"Trying to OrderBy Date on list returned in C# (Umbraco 4.8.1)","body":"<p>I'm trying to pull the latest 5 articles from the news section and then sort them by the article date.</p>\n\n<p>I've managed to get the 5 articles and display them ok, but the OrderBy is not working as expected. I need to sort them by a property on the node called \"NewsDate\" which is a date picker.</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n    {\n        var currentNode = Node.GetCurrent();\n        var nodeTypeAlias = currentNode.NodeTypeAlias;\n\n        if (nodeTypeAlias == \"NewsMasterPage\")\n        {\n            var nodes = FindChildren(currentNode, t =&gt; t.NodeTypeAlias.Equals(\"NewsArticle\"));\n            var nodesOutput = nodes.OrderBy(n =&gt; n.GetProperty(\"NewsDate\"));\n\n            newsRepeater.DataSource = nodesOutput;\n            newsRepeater.DataBind();\n        }\n\n    }\n\n    private static List&lt;Node&gt; FindChildren(Node currentNode, Func&lt;Node, bool&gt; predicate)\n    {\n        List&lt;Node&gt; result = new List&lt;Node&gt;();\n\n        var nodes = currentNode\n            .Children\n            .OfType&lt;Node&gt;()\n            .Where(predicate).Take(4);\n        if (nodes.Count() != 0)\n            result.AddRange(nodes);\n\n        foreach (var child in currentNode.Children.OfType&lt;Node&gt;())\n        {\n            nodes = FindChildren(child, predicate);\n            if (nodes.Count() != 0)\n                result.AddRange(nodes);\n        }\n        return result;\n    }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13143757,"title":"how can i get distinct when I have more than 2 columns?","body":"<p>In my entity I have 4 columns A,B,C,D if i want all the columns with distinct D on it how can I do it with <code>Linq</code>?\nFor example:</p>\n\n<pre><code>Col A =1  Col B=2  Col C=3  Col D=4\nCol A =1  Col B=2  Col C=9  Col D=4\n</code></pre>\n\n<p>now when i do distinct on Col D i want to display either one of the record not both.\nIs there a way to do it in <code>Linq</code> I do not want to use looping statements to do this.</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":6,"view_count":132,"score":-2,"question_id":11015986,"title":"LINQ where with variable","body":"<p>I have the following statement:</p>\n\n<pre><code>var itemsFromList = from item in ListItems where item.Countries != null select item;\n</code></pre>\n\n<p>So I can return all the values that are present in countries (some are empty).\nin the same list I have other columns for instance cities and I have to change it to:</p>\n\n<pre><code>var itemsFromList = from item in ListItems where item.cities != null select item;\n</code></pre>\n\n<p>Is there a way to use the same statement to return either the cities or countries that are not empty by using a variable a bit like this:</p>\n\n<pre><code>var itemsFromList = from item in ListItems where item.variable != null select item;\n</code></pre>\n"},{"tags":["c#","linq","sharepoint","sharepoint2010","treeview"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":793,"score":4,"question_id":11832212,"title":"Programmatically creating a treeview in sharepoint based on a column","body":"<p>I have to develop a web part for SharePoint that reads a list and creates a tree view.</p>\n\n<p>The tree view has to be organized as follows:\nThe root (or roots) is to be created by a choice field which represents a category, for instance <strong>Drinks</strong>,\nthe child nodes are the name of the rows that contain that category, the tree view has to be created programmatically. </p>\n\n<pre><code>List:\nTitle(string)       Category(Choice)\nCoke            Drinks\nBeer            Drinks\nFish            Food\nChips           Food\n\nWould produce this:\nDrinks\n    Coke\n    Beer\nFood\n    Fish\n    Chips\n</code></pre>\n\n<p>code I have so far</p>\n\n<pre><code>  TreeView treeView;\n    TreeNode rootNode;\n    TreeNode childNode;\n\n\n    protected override void RenderContents(System.Web.UI.HtmlTextWriter writer)\n    {\n        // render the control\n        base.RenderContents(writer);\n    }\n\n    protected override void CreateChildControls()\n    {\n        List&lt;TreeNode&gt; items = new List&lt;TreeNode&gt;();\n\n        base.CreateChildControls();\n\n        // get the current site\n        using (SPSite Site = new SPSite(SPContext.Current.Site.Url + \"/UberWiki\"))\n        {\n            using (SPWeb currentWeb = Site.OpenWeb())\n            {\n\n                // set the tree view properties\n\n\n\n                SPList list = currentWeb.Lists[\"Pages\"];\n\n                SPFieldChoice field = (SPFieldChoice)list.Fields[\"Categories\"];\n\n                foreach (string str in field.Choices)\n                {\n                    treeView = new System.Web.UI.WebControls.TreeView();\n                    rootNode = new System.Web.UI.WebControls.TreeNode(str);\n                    treeView.Nodes.Add(rootNode);\n\n                    foreach (SPListItem rows in list.Items)\n                    {\n                        childNode = new System.Web.UI.WebControls.TreeNode(rows.Title);\n                        treeView.Nodes.Add(childNode);\n                    }\n                }\n            }\n            this.Controls.Add(treeView);\n            base.CreateChildControls();\n        }\n    }\n</code></pre>\n"},{"tags":["c#","linq","list"],"answer_count":5,"favorite_count":2,"up_vote_count":20,"down_vote_count":0,"view_count":4690,"score":20,"question_id":1590723,"title":"Flatten List in LINQ","body":"<p>I got a linq query who returns a <code>IEnumarable&lt;List&lt;int&gt;&gt;</code> but i need to return, only <code>List&lt;int&gt;</code> so i want to merge all my record in my <code>IEnumerable&lt;List&lt;int&gt;&gt;</code> to only one array.</p>\n\n<p>Example :</p>\n\n<pre><code>IEnumerable&lt;List&lt;int&gt;&gt; iList = from number in (from no in Method() select no) select number;\n</code></pre>\n\n<p>I want to take all my result <code>IEnumerable&lt;List&lt;int&gt;&gt;</code> to only one <code>List&lt;int&gt;</code></p>\n\n<p>Hence, from source arrays: \n[1,2,3,4] and [5,6,7]</p>\n\n<p>I want only one array \n[1,2,3,4,5,6,7]</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","entity-framework","repository","repository-pattern"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13143268,"title":"How to include complex entity fields in a projected entity framework object?","body":"<p>I often use the <code>System.Data.Entity.DbExtensions</code> <code>Include()</code> method to cause complex entity fields to be included in query results from my repositories.  However, when I project my entities into new classes, I seem to lose this \"concretization\" of included complex entity fields.  For example, say I wanted to return an <code>Event</code> object from my repo, and be able to access the complex entity field <code>Assessment</code>:</p>\n\n<pre><code>public class EventRepository {\n...\n    public IList&lt;Event&gt; GetEvents() {\n        using (var context = new MyDatabaseContext()) {\n            return context.Events\n                .Include(evnt =&gt; evnt.ActualAssessment)\n                .ToList();\n        }\n    }\n...\n}\n</code></pre>\n\n<p>I can then run the following code without a hitch because of the <code>Include</code> I used above:</p>\n\n<pre><code>var repoEvents = new EventRepository();\nvar events = repoEvents.GetEvents();\nConsole.WriteLine(events[0].ActualAssessment.AssessmentDate.ToString());\n</code></pre>\n\n<p>But say I now want to project the <code>Event</code>s into a wrapper object <code>ExtendedEvent</code> with some extra info, like this:</p>\n\n<pre><code>public class EventRepository {\n...\n    public IList&lt;ExtendedEvent&gt; GetExtendedEvents() {\n        using (var context = new MyDatabaseContext()) {\n            return context.Events\n                .Include(evnt =&gt; evnt.ActualAssessment)\n                .Select(evnt =&gt; new {\n                    TheEvent = evnt,\n                    SomeExtraData = 123\n                })\n                .ToList()\n                .Select(evntInfo =&gt; {\n                    return new ExtendedEvent {\n                        TheEvent = evntInfo.TheEvent,\n                        SomeExtraData = evntInfo.SomeExtraData\n                    };\n                })\n                .ToList();\n        }\n    }\n...\n}\n</code></pre>\n\n<p>I now try and run this code:</p>\n\n<pre><code>var repoEvents = new EventRepository();\nvar extendedEvents = repoEvents.GetExtendedEvents();\nConsole.WriteLine(extendedEvents[0].TheEvent.ActualAssessment.AssessmentDate.ToString());\n</code></pre>\n\n<p>This gives me the error \"The ObjectContext instance has been disposed and can no longer be used for operations that require a connection.\" - so <code>ActualAssessment</code> has not been eager-loaded despite my use of <code>Include</code>, apparently because I projected it into a new wrapper object.  How can I cause <code>ActualAssessment</code> to be included?</p>\n"},{"tags":["c#","database","linq","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13138243,"title":"Entity Framework: Linq query finds entries by original data but returns reference to changed entry","body":"<p>I just spent some days now to find a bug caused by some strange behavior of the Entity Framework (version 4.4.0.0). For an explanation I wrote a small test program. At the end you'll find some questions I have about that.</p>\n\n<h2>Declaration</h2>\n\n<p>Here we have a class \"Test\" which represents our test dataset. It only has an ID (primary key) and a \"value\" property. In our TestContext we implement a DbSet Tests, which shall handle our \"Test\" objects as a database table.</p>\n\n<pre><code>public class Test\n{\n    public int ID { get; set; }\n    public int value { get; set; }\n}\n\npublic class TestContext : DbContext\n{\n    public DbSet&lt;Test&gt; Tests { get; set; }\n}\n</code></pre>\n\n<h2>Initialization</h2>\n\n<p>Now, we remove any (if existent) entries from our \"Tests\" table and add our one and only \"Test\" object. It has ID=1 (primary key) and value=10.</p>\n\n<pre><code>// Create a new DBContext...\nTestContext db = new TestContext();\n\n// Remove all entries...\nforeach (Test t in db.Tests) db.Tests.Remove(t);\ndb.SaveChanges();\n\n// Add one test entry...\ndb.Tests.Add(new Test { ID = 1, value = 10 });\ndb.SaveChanges();\n</code></pre>\n\n<h2>Tests</h2>\n\n<p>Finally, we run some tests. We select our entry by it's original value (=10) and we change the \"value\" of our entry to 4711. BUT, we do not call db.SaveChanges(); !!!</p>\n\n<pre><code>// Find our entry by it's value (=10)\nvar result = from r in db.Tests\n             where r.value == 10\n             select r;\nTest t2 = result.FirstOrDefault();\n\n// change its value from 10 to 4711...\nt2.value = 4711;\n</code></pre>\n\n<p>Now, we try to find the (old) entry by the original value (=10) and do some tests on the results of that.</p>\n\n<pre><code>// now we try to select it via its old value (==10)\nvar result2 = from r in db.Tests\n             where r.value == 10\n             select r;\n\n// Did we get it?\nif (result2.FirstOrDefault() != null &amp;&amp; result2.FirstOrDefault().value == 4711)\n{\n    Console.WriteLine(\"We found the changed entry by it's old value...\");\n}\n</code></pre>\n\n<p>When running the program we'll actually see \"We found the changed entry by it's old value...\". That means we have run a query for r.value == 10, found something... This would be acceptable. BUT, get receive the already changed object (not fulfilling value == 10)!!!</p>\n\n<p><strong>Note:</strong> You'll get an empty result set for \"where r.value == 4711\".</p>\n\n<p>In some further testing, we find out, that the Entity Framework always hands out a reference to the same object. If we change the value in one reference, it's changed in the other one too. Well, that's ok... but one should know it happens.</p>\n\n<pre><code>Test t3 = result2.FirstOrDefault();    \nt3.value = 42;\nif (t2.value == 42)\n{\n    Console.WriteLine(\"Seems as if we have a reference to the same object...\");\n}\n</code></pre>\n\n<h2>Summary</h2>\n\n<p>When running a LINQ query on the same Database Context (without calling SaveChanges()) we will receive references to the same object, if it has the same primary key. The strange thing is: Even, if we change an object we will find it (only!) by it's old values. But we will receive a reference to the already changed object. This means that the restrictions in our query (value == 10) is not guaranteed for any entries that we changed since our last call of SaveChanges().</p>\n\n<h2>Questions</h2>\n\n<p>Of course, I'll probably have to live with some effects here. But I, would like to avoid to \"SaveChanges()\" after every little change. Especially, because I would like to use it for transaction handling... to be able to revert some changes, if something goes wrong.</p>\n\n<p>I would be glad, if anyone could answer me one or even both of the following questions:</p>\n\n<ol>\n<li><p>Is there a possibility to change the behavior of entity framework to work as if I would communicate with a normal database during a transaction? If so... how to do it?</p></li>\n<li><p>Where is a good resource for answering \"How to use the context of entity framework?\" which answers questions like \"What can I rely on?\" and \"How to choose the scope of my DBContext object\"?</p></li>\n</ol>\n\n<h2>EDIT #1</h2>\n\n<p>Richard just explained how to access the original (unchanged) database values. While this is valuable and helpful I've got the urge to clarify the goal ... </p>\n\n<p>Let's have a look at what happens when using SQL. We setup a table \"Tests\":</p>\n\n<pre><code>CREATE TABLE Tests (ID INT, value INT, PRIMARY KEY(ID));\nINSERT INTO Tests (ID, value) VALUES (1,10);\n</code></pre>\n\n<p>Then we have a transaction, that first looks for entities whose values are 10. After this, we update the value of these entries and look again for those entries. In SQL we already work on the updated version, so we will not find any results for our second query. After all we do a \"rollback\", so the value of our entry should be 10 again...</p>\n\n<pre><code>START TRANSACTION;\n\nSELECT ID, value FROM Tests WHERE value=10; {1 result}\nUPDATE Tests SET value=4711 WHERE ID=1; {our update}\n\nSELECT ID, value FROM Tests WHERE value=10; {no result, as value is now 4711}\n\nROLLBACK; { just for testing transactions... }\n</code></pre>\n\n<p>I would like to have exactly this behavior for the Entity Framework (EF), where db.SaveChanges(); is equivalent to \"COMMIT\", where all LINQ queries are equivalent to \"SELECT\" statements and every write access to an entity is just like an \"UPDATE\". I don't care about when the EF does actually calls the UPDATE statement, but it should behave the same way as using a SQL Database the direct way... Of course, if \"SaveChanges()\" is called and returning successfully it should be guaranteed that all data was persisted correctly.</p>\n\n<p>Note: Yes, I could call db.SaveChanges() before every query, but then I would loose the possibility for a \"Rollback\".</p>\n\n<p>Regards,</p>\n\n<p>Stefan</p>\n"},{"tags":["c#","linq","task-parallel-library","plinq"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":13131957,"title":"PLINQ query giving overflow exception","body":"<p>I'm running a PLINQ query as follows:</p>\n\n<pre><code>ParallelQuery&lt;string&gt; winningCombos = from n in nextComboMaker.GetNextCombo()\n                                              .AsParallel().WithCancellation(_cancelSource.Token)\n                                              where ComboWasAWinner(n) \n                                              select n;\n\nConcurrentBag&lt;string&gt; wins = new ConcurrentBag&lt;string&gt;();\n\nforeach (var winningCombo in winningCombos)\n{\n        wins.Add(winningCombo);\n        if (wins.Count == _maxWinsAllowed)\n            break;\n}\n</code></pre>\n\n<p>The GetNextCombo method is just returning the next combination of letters and numbers, with possibilities up to the billions/trillions.</p>\n\n<p>Now this is throwing the exception when I choose a range of combinations greater than the allowed size of an Int32, it always throws when the counter of combos it's run is 2147483584.</p>\n\n<p>I've made sure it's nothing in the GetNextCombo by creating a fake combo to return every time (doing a yield return \"234gf24fa23...\" etc.)</p>\n\n<p>The exception is being thrown by LINQ:</p>\n\n<pre><code>System.AggregateException was unhandled by user code\n  Message=One or more errors occurred.\n  Source=System.Core\n  StackTrace:\n       at System.Linq.Parallel.QueryTaskGroupState.QueryEnd(Boolean userInitiatedDispose)\n       at System.Linq.Parallel.MergeExecutor`1.Execute[TKey](PartitionedStream`2 partitions, Boolean ignoreOutput, ParallelMergeOptions options, TaskScheduler taskScheduler, Boolean isOrdered, CancellationState cancellationState, Int32 queryId)\n       at System.Linq.Parallel.PartitionedStreamMerger`1.Receive[TKey](PartitionedStream`2 partitionedStream)\n       at System.Linq.Parallel.ForAllOperator`1.WrapPartitionedStream[TKey](PartitionedStream`2 inputStream, IPartitionedStreamRecipient`1 recipient, Boolean preferStriping, QuerySettings settings)\n       at System.Linq.Parallel.UnaryQueryOperator`2.UnaryQueryOperatorResults.ChildResultsRecipient.Receive[TKey](PartitionedStream`2 inputStream)\n       at System.Linq.Parallel.WhereQueryOperator`1.WrapPartitionedStream[TKey](PartitionedStream`2 inputStream, IPartitionedStreamRecipient`1 recipient, Boolean preferStriping, QuerySettings settings)\n       at System.Linq.Parallel.UnaryQueryOperator`2.UnaryQueryOperatorResults.ChildResultsRecipient.Receive[TKey](PartitionedStream`2 inputStream)\n       at System.Linq.Parallel.ScanQueryOperator`1.ScanEnumerableQueryOperatorResults.GivePartitionedStream(IPartitionedStreamRecipient`1 recipient)\n       at System.Linq.Parallel.UnaryQueryOperator`2.UnaryQueryOperatorResults.GivePartitionedStream(IPartitionedStreamRecipient`1 recipient)\n       at System.Linq.Parallel.UnaryQueryOperator`2.UnaryQueryOperatorResults.GivePartitionedStream(IPartitionedStreamRecipient`1 recipient)\n       at System.Linq.Parallel.QueryOperator`1.GetOpenedEnumerator(Nullable`1 mergeOptions, Boolean suppressOrder, Boolean forEffect, QuerySettings querySettings)\n       at System.Linq.Parallel.ForAllOperator`1.RunSynchronously()\n       at StockWiz.Library.PLINQArrayProcessor.DoProcessing() in C:\\Users\\dad\\Documents\\BitBucket\\stockwiz_clone\\stockwiz\\StockWiz.Library\\PLINQArrayProcessor.cs:line 50\n       at System.Threading.Tasks.Task.Execute()\n  InnerException: System.OverflowException\n       Message=Arithmetic operation resulted in an overflow.\n       Source=System.Core\n       StackTrace:\n            at System.Linq.Parallel.PartitionedDataSource`1.ContiguousChunkLazyEnumerator.MoveNext(T&amp; currentElement, Int32&amp; currentKey)\n            at System.Linq.Parallel.WhereQueryOperator`1.WhereQueryOperatorEnumerator`1.MoveNext(TInputOutput&amp; currentElement, TKey&amp; currentKey)\n            at System.Linq.Parallel.ForAllOperator`1.ForAllEnumerator`1.MoveNext(TInput&amp; currentElement, Int32&amp; currentKey)\n            at System.Linq.Parallel.ForAllSpoolingTask`2.SpoolingWork()\n            at System.Linq.Parallel.SpoolingTaskBase.Work()\n            at System.Linq.Parallel.QueryTask.BaseWork(Object unused)\n            at System.Threading.Tasks.Task.Execute()\n       InnerException: \n</code></pre>\n\n<p>I'm wondering if there's anything I can do to change this query to not overflow, any order in which I do things, etc.  Maybe not have the linq query do a where and select, although I've tried this:</p>\n\n<pre><code> var query = nextComboMaker.GetNextCombo().AsParallel();\n\n query.ForAll(x =&gt; if(ComboWasAWinner(x) wins.Add(x) );\n</code></pre>\n\n<p>still the same overflow.</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13141862,"title":"Joining multiple tables using Entity Framework","body":"<p>i am trying to join 3 tables using EF but it throws an error saying </p>\n\n<pre><code>consider swaping conditions on either side of equals\n</code></pre>\n\n<p>can some one pls help</p>\n\n<pre><code> var billdata = from billtotal in context.billTotals\n                                   join billcard in context.billClubcards\n                                       on billtotal.OrderID equals billcard.OrderID\n\n                                   join billtender in context.billTenders\n                                       on billtender.OrderID equals billtotal.OrderID\n\n\n                                   select billtotal;\n</code></pre>\n"},{"tags":["c#","linq","linq-to-entities"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13124304,"title":"Using IN on a list of objects","body":"<p>I'm trying to use LINQ on a list inside an object. I'll try to explain:</p>\n\n<p>I've got an object called \"Comment\".\nIn the comment object I have a list of \"User\" objects, where each user object has an \"ID\" field.</p>\n\n<p>such as </p>\n\n<pre><code>Public class Comment {\nList&lt;User&gt; users;\n...\n}\n</code></pre>\n\n<p>Then, I get a list of user ids (let's call it UsersList, such as UsersList is a List&lt; int > object) and would like to get all comments where all users in the UsersList are in the \"users\" list of that comment.</p>\n\n<p>So if <code>UsersList = {1,2}</code> I would like to get all comments where the user with an id of 1 and the user with an id of 2 will be present in the \"users\" list.</p>\n\n<p>How can this be achieved?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13138845,"title":"Loop through array in linq query","body":"<p>Hi all I have a query using Linq that returns a set of records, one of which is the country id, I also have an array of desired countries. Is there a way of either looping through the countries array and seeing if the id is in the results, i want to do something like this</p>\n\n<pre><code>results = from r in results \nwhere\n//jump to my c# array\nfor(int x = 0;x &lt; array.count; x++)\n{\nr.countryId.ToString().Contains(array[x]) \n}\nselect r\n</code></pre>\n\n<p>thanks</p>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13141318,"title":"Turn 2 linq expressions into","body":"<p>Is there anyway to change the following 2 linq expressions into 1?</p>\n\n<pre><code>var criticalCategories =\n    _commonDao.GetAllByExpression&lt;CategoryItem&gt;(\n        x =&gt; x.Category.Uid == gridAnswer.ActivityCategory.Uid &amp;&amp; x.Critical);\n\nif(criticalCategories.Any())\n{\n    criticalWeight = criticalCategories.Min(x =&gt; x.Weight);\n}\n</code></pre>\n"},{"tags":["c#","linq","date","kendo-ui","datetime-format"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13140987,"title":"convert time interval and format it as hour and minute \"hh:mm\"","body":"<p>possible duplicate:\n<a href=\"http://stackoverflow.com/questions/13057928/convert-timespan-totalmilliseconds-to-datetime-and-format-it-as-hourminute\">Convert TimeSpan.TotalMilliseconds to datetime and format it as hour:minute</a>\n[edited]</p>\n\n<p>also</p>\n\n<pre><code>  var responseList = RecievedMessages.AsEnumerable().Select(u =&gt; new ResponseViewModel\n            {\n                Sent = u.Message.DateSent,\n                Reply = u.Message.DateSent,\n\n                ResponseTime = (u.Message.DateSent - u.Message.DateSent).TotalMilliseconds\n            });\n</code></pre>\n\n<p>also in my view/index </p>\n\n<pre><code>            {  \n               field: \"ResponseTime\",\n                width: 110,\n                title: 'Response Time'\n            }\n</code></pre>\n\n<p>In case you are curious, this snippet using kendo ui grid.</p>\n\n<p>[updated]</p>\n\n<p>I changed the model as </p>\n\n<pre><code>  public DateTime? Sent { get; set; }\n    public DateTime? Reply { get; set; }\n    public int ResponseTime { get; set; }\n</code></pre>\n\n<p>and in linq I change</p>\n\n<pre><code>  var responseList = RecievedMessages.AsEnumerable().Select(u =&gt; new ResponseViewModel\n                {\n                    Sent = u.Message.DateSent,\n                    Reply = u.Message.DateReply,\n\n                    ResponseTime = (u.Message.DateSent - u.Message.DateReply).Days\n                });\n</code></pre>\n\n<p>which give me the time different between the two datatime is 10 days, but i want to calculate the hour and minute during the time interval,(for example if datesent is 09/02/2011 2:00 pm , and dateReply is 09/02/2011 4:30 pm , then the response time should be 2:30 ) still havent figure this out, anyone has idea, either format it in linq or do it over the view page?</p>\n"},{"tags":["c#","sql","database","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13133274,"title":"linq to sql relationship","body":"<p>I want to return a dataset with some relations, the query is OK but I get the ID instead of the real value from the other table... This is the query</p>\n\n<pre><code>        var thr=\n            from u in dc.thresholds\n            select u;\n</code></pre>\n\n<p>This returns something like this:</p>\n\n<pre><code>id: 1\nname: some name\ntype_id: 1\nowner_id: 1\n</code></pre>\n\n<p>I want to get type_id and owner_id with the values of theese tables, so it can be something like:</p>\n\n<pre><code>id: 1\nname: some name\ntype_id: Danger\nowner_id: John Smith\n</code></pre>\n\n<p>I hope some of you could give me some advices, I'm starting with LINQ to SQL and I'm a bit lost...</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","linq","date","kendo-ui","datetime-format"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13057928,"title":"Convert TimeSpan.TotalMilliseconds to datetime and format it as hour:minute","body":"<p>I kinda confuse about the date time conversion</p>\n\n<p>in my model i have defined</p>\n\n<pre><code>    public DateTime? Sent { get; set; }\n    public DateTime? Reply { get; set; }\n    public double ResponseTime { get; set; }\n</code></pre>\n\n<p>in linq part i am using </p>\n\n<pre><code>ResponseTime = (u.Reply - u.sent).TotalMilliseconds\n</code></pre>\n\n<p>which is not formated and displayed like this <code>979809803</code></p>\n\n<p>I want to know how do i convert it to datetime format, and eventually will display the format as hour:minute, for instance 2:45 between the date sent and date reply.</p>\n"},{"tags":["linq","linq-to-sql","contains"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2549,"score":4,"question_id":961912,"title":"Stack overflow in LINQ to SQL and the Contains keyword","body":"<p>I have an Extension method which is supposed to filter a Queryable object (IQueryable) based upon a collection of Ids....</p>\n\n<p>Note that IQueryable is sourced from my database via a LinqToSql request</p>\n\n<pre><code> public static IQueryable&lt;NewsItemSummary&gt; WithID(this IQueryable&lt;NewsItemSummary&gt; qry, IQueryable&lt;Guid&gt; Ids)\n    {\n        return from newsItemSummary in qry\n               where Ids.Contains(newsItemSummary.ID)\n               select newsItemSummary;\n    }\n</code></pre>\n\n<p>If <strong>Ids</strong> are created from an array or list and passed in as a queryable list, it DOESNT work</p>\n\n<p>For example...</p>\n\n<pre><code> GetNewsItemSummary().WithID(ids.AsQueryable&lt;Guid&gt;())\n</code></pre>\n\n<p>If <strong>Ids</strong> is composed form a LinqToSql request, it DOES work!! </p>\n\n<p>This is known issue:\n<a href=\"http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=355026\" rel=\"nofollow\">http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=355026</a></p>\n\n<p>My Ids collection cannot come from a LinqToSql request...</p>\n\n<p>Note, if I change the function so that it consumes and IList rather than an IQueryable....</p>\n\n<pre><code> public static IQueryable&lt;NewsItemSummary&gt; WithID(this IQueryable&lt;NewsItemSummary&gt; qry, IList&lt;Guid&gt; Ids)\n    {\n        return from newsItemSummary in qry\n               where Ids.Contains(newsItemSummary.ID)\n               select newsItemSummary;\n    }\n</code></pre>\n\n<p>I now get the following exception:</p>\n\n<pre><code>Method 'Boolean Contains(System.Guid)' has no supported translation to SQL.\n</code></pre>\n\n<p>So... all I want to do is filter my collection of news based upon a list or array of Guids.... Ideas???</p>\n"},{"tags":["c#","linq","debugging"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13139908,"title":"C# LINQ Debugging through an IEnumerable extension method","body":"<p>I am trying to step through the following IEnumerable extension method that I called DumpIt. The debugger will not step through it. How can I get the debugger to step into this extension method?  </p>\n\n<p>My unit test:  </p>\n\n<pre><code>[Test]\n        public void TestDumpIt()\n        {\n            var words =\n                new string[] {\"   KOOKABURRA\", \"Frogmouth\", \"kingfisher   \", \"loon\", \"merganser\"};\n\n            var result = words\n                .DumpIt(d =&gt; \"original: \" + d)\n                .Select(word =&gt; word.Trim())\n                .DumpIt(d =&gt; \"trimmed: \" + d)\n                .Select(word =&gt; word.ToLower())\n                .DumpIt(d =&gt; \"lower cased: \" + d)\n                .Where(word =&gt; word.StartsWith(\"k\"))\n                .DumpIt(d =&gt; \"starts with k: \" + d)\n                .OrderBy(word =&gt; word)\n                .DumpIt(d =&gt; \"orderd: \" + d);\n        }\n</code></pre>\n\n<p>The extension method:  </p>\n\n<pre><code>public static IEnumerable&lt;T&gt; DumpIt&lt;T&gt;(this IEnumerable&lt;T&gt; input,\n    Func&lt;T, string&gt; toString\n    )\n{\n    foreach (var item in input)\n    {\n        Output.ActivePane.Activate();\n        Output.ActivePane.OutputString(\n            ShowWhiteSpace ? '[' + toString(item) + ']' : toString(item));\n\n        yield return item;\n    }\n}\n</code></pre>\n\n<p>Thanks for any help!</p>\n"},{"tags":["c#","linq","expression-trees"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12847119,"title":"Build SQL Where query from delegate","body":"<p>I'm working on a little helper for adding, editing and removing objects from a database, the add method is working right now and given an object of type t, it checks the properties, the values, and generates a SQL Query to insert the data into a table (it assumes the table name is the type from the object, but can also be set manually)</p>\n\n<p>What I want to do now is a method</p>\n\n<pre><code>public bool Update&lt;T&gt;(T obj, Func&lt;T, bool&gt; predicate)\n</code></pre>\n\n<p>So given an T <strong>obj</strong>, and a lambda function <strong>predicate</strong>, if predicate is</p>\n\n<pre><code>(o =&gt; o.Id = 1)\n</code></pre>\n\n<p>I want to generate</p>\n\n<pre><code>WHERE Id = 1\n</code></pre>\n\n<p>I've seen some similar questions, and I think <a href=\"http://blogs.msdn.com/b/charlie/archive/2008/01/31/expression-tree-basics.aspx\" rel=\"nofollow\">expression trees</a> might be a good starting point, but all I've seen is how to manually create an expression, not how to create an expression from a delegate.</p>\n\n<p>Is there a way to generate that SQL from the delegate?</p>\n\n<p>EDIT: I finally could do what I wanted, and I made a little post about that <a href=\"http://gosukiwi.blogspot.com.ar/2012/10/converting-c-anonymous-functions-to-sql.html\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["c#","xml","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13138773,"title":"Load list with linq to xml","body":"<p>I'm trying to load a list from xml. each node has few nodes. I know it's possible to do it in a foreach loop like in the picture below, but i would like to avoid using a loop.</p>\n\n<p>this is what I don't want, but without the loop:\n<img src=\"http://i.stack.imgur.com/7c4Ox.png\" alt=\"enter image description here\"></p>\n\n<p>I saw this examle, but it's only for one node \"id\". \n<a href=\"http://stackoverflow.com/questions/956749/how-can-i-transform-xml-into-a-liststring-or-string\">How can I transform XML into a List&lt;string&gt; or String[]?</a></p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","javascript","asp.net-mvc","linq","jquery-ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13129475,"title":"date format not correct when pulling from database using linq query","body":"<p>I want to pull a date from db and display it in a telerik ddl. I am able to pull the date and display it, but cant get the formatting to work. The date is display like this:</p>\n\n<pre><code>/Date(13496724000000)/\n</code></pre>\n\n<p>Here is my Controller action to pull the date from db:</p>\n\n<pre><code>    [HttpPost]\n    public ActionResult Date(int id)\n    {\n        var dates = (from p in db.vwdb.Where(u =&gt; u.Id == id)\n                           group p by p.Date into g\n                    select g.Key).ToList();\n\n        return Json(new { data = Convert.ToDateTime(weeks.Min())});\n    }\n</code></pre>\n\n<p>Here is my jquery to display it in ddl:</p>\n\n<pre><code>function populateDate() {\n    var link = '/Users/Date';\n    var dataSource = [];\n    $.ajax({\n        type: 'POST',\n        url: link,\n        data: { id: id },\n        dataType: 'json',\n        success: function (result) {\n                var dateOf = result.data;\n                dataSource.push({ Text: dateOf , Value: dateOf });\n            $(\"#Date\").data(\"tDropDownList\").dataBind(dataSource);\n        },\n        error: function (result) {\n            alert(result.message);\n        }\n    });\n};\n</code></pre>\n\n<p>I want to display the date in this format: \"MM/DD/YYYY\" \ninstead of  \"/Date(13496724000000)/\"</p>\n\n<p>Any help is much appreciated.</p>\n"},{"tags":["c#","linq","dynamic","entity-framework-5"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13137062,"title":"How to search entities by multiple arbitrary values?","body":"<p>I have a <code>customer</code> entity whose records I want to be able to search by multiple arbitrary attributes.</p>\n\n<p>E.g.:</p>\n\n<pre><code>Dictionary&lt;string, string&gt; searchList = new Dictionary&lt;string, string&gt;();\nsearchList.Add(\"LastName\", \"Foo\");\nsearchList.Add(\"FirstName\", \"Bar\");\n</code></pre>\n\n<p>I could of course write something along these lines:</p>\n\n<pre><code>foreach (KeyValuePair&lt;string, string&gt; kv in searchList)\n{\n    switch (kv.Key)\n    {\n       case \"FirstName\" :\n          List&lt;Customer&gt; someResultPart = this._dbSet.Where(customer =&gt; customer.FirstName == kv.Value).ToList();\n       break;\n       case \"LastName\" :\n          // etc.\n    }\n}\n\n// Do intersection of all result parts ...\n</code></pre>\n\n<p>Aside from the fact that querying <code>n</code> times and intersecting later on is obviously fugly, I would much rather not have that <code>switch</code> statement in there (since it would force me to change it every single time anything in the <code>Customer</code> class changes.</p>\n\n<p>Is there any way to:</p>\n\n<ul>\n<li>\"dynamically\" build the query based on the <code>searchList</code> dictionary, thereby eliminating the need for the <code>switch</code> construct?</li>\n<li>\"concatenate\" the various conditions into a single db query?</li>\n</ul>\n"},{"tags":["c#","linq","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13134575,"title":"C# Data table how to concat two tables rows vertically using linq","body":"<p>How to concat rows vertically from two tables using linq, i already written a query for that but it adding next to first row hence i'm getting columns count double but i want to concat by next row.</p>\n\n<pre><code>var dd4 = from tbl in dataTb.AsEnumerable()\n                      join dpi in rawDataTable.AsEnumerable() on tbl[\"Account_No\"] equals dpi[\"Account_No\"]\n                      select tbl.ItemArray.Concat(dpi.ItemArray).ToArray();\n</code></pre>\n\n<p>It giving me structure like</p>\n\n<p>col1 col2 col3.... col24 but my table having only 12 columns so it adding next to it but how can i add after 12 column end then new row should be start.</p>\n\n<p>dataTb table data:</p>\n\n<pre><code>chNo Chunit  val1  val2  val3 val4\n 1    kwh    2010  2011  2012 2009\n 2    kvarh  2012  2011  2008 2009\n</code></pre>\n\n<p>rawDataTable data:</p>\n\n<pre><code>chNo Chunit  val1  val2  val3 val4\n 1    kw     2.2   2.1   2.1  2.0\n 2    kvar   1.2   1.1   1.1  1.0\n</code></pre>\n\n<p>It's adding like this:</p>\n\n<pre><code>1    kwh    2010  2011  2012 2009  1    kw     2.2   2.1   2.1  2.0\n1    kwh    2010  2011  2012 2009  2    kvar   1.2   1.1   1.1  1.0\n2    kvarh  2012  2011  2008 2009  1    kw     2.2   2.1   2.1  2.0\n2    kvarh  2012  2011  2008 2009  2    kvar   1.2   1.1   1.1  1.0\n</code></pre>\n\n<p>but i want like this:</p>\n\n<pre><code>1    kwh    2010  2011  2012 2009\n1    kw     2.2   2.1   2.1  2.0\n2    kvar   1.2   1.1   1.1  1.0\n2    kvarh  2012  2011  2008 2009\n1    kw     2.2   2.1   2.1  2.0\n2    kvar   1.2   1.1   1.1  1.0\n</code></pre>\n\n<p>currently 'm getting: but want like above (For Yograj)</p>\n\n<pre><code>1    kwh    2010  2011  2012 2009\n2    kvarh  2012  2011  2008 2009\n1    kw     2.2   2.1   2.1  2.0\n2    kvar   1.2   1.1   1.1  1.0\n1    kw     2.2   2.1   2.1  2.0\n2    kvar   1.2   1.1   1.1  1.0\n</code></pre>\n\n<p>Thanks,\n@nag.</p>\n"},{"tags":["c#","linq"],"answer_count":14,"favorite_count":52,"up_vote_count":95,"down_vote_count":2,"view_count":12967,"score":93,"question_id":214500,"title":"Which LINQ syntax do you prefer? Fluent or Query Expression","body":"<p>LINQ is one of the greatest improvements to .NET since generics and it saves me tons of time, and lines of code.  However, the fluent syntax seems to come much more natural to me than the query expression syntax.</p>\n\n<pre><code>var title = entries.Where(e =&gt; e.Approved)\n    .OrderBy(e =&gt; e.Rating).Select(e =&gt; e.Title)\n    .FirstOrDefault();\n\nvar query = (from e in entries\n             where e.Approved\n             orderby e.Rating\n             select e.Title).FirstOrDefault();\n</code></pre>\n\n<p>Which do you prefer and if you write standards for your company, do you enforce one over the other?</p>\n"},{"tags":["c#","linq","linq-to-xml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13133581,"title":"Linq to XML parsing","body":"<p>I have an xml as shown below.</p>\n\n<p>I need to write a method that takes a string input (IsAuthorFilterNeeded or IsTitleFilterNeeded) and returns the book code values under that node.</p>\n\n<p>Suppose if parameter is IsAuthorFilterNeeded it should return 5,6,7,8</p>\n\n<p>I tried to write a Linq2XML query to retrieve this, but I am not happy with the code as it is not readable and has many hardcoded strings.Here is my linq2xml query.</p>\n\n<pre><code>public IList&lt;string&gt; GetBookCodes(string filterOption)\n{\n    IList&lt;string&gt; requiredValues = null;\n\n    foreach (var node in _xml.Descendants(\"BookOptions\"))\n    {\n        if (node.Parent.Attribute(\"Name\").Value == \"ScienceBooks\")\n        {\n            var requiredNode = node.Elements(\"Property\").Attributes(\"Value\").First(x =&gt; x.Parent.FirstAttribute.Value == filterOption);\n            requiredValues = requiredNode.Parent.Descendants(\"BookCode\").Attributes(\"Value\").ToArray().Select(x =&gt; x.Value).ToList();\n\n            break;\n        }\n    }\n    return requiredValues;\n}\n</code></pre>\n\n<p>Is there any other way to achieve this result with simpler code .</p>\n\n<pre><code>&lt;LibraryRack Id=\"3\" Name=\"ScienceBooks\"&gt;\n      &lt;Books&gt;\n        &lt;Book Id =\"1\" Name=\"Book1\"&gt;&lt;/Book&gt;\n        &lt;Book Id =\"2\" Name=\"Book2\"&gt;&lt;/Book &gt;\n        &lt;Book Id =\"3\" Name=\"Book3\"&gt;&lt;/Book&gt;\n      &lt;/Books&gt;\n      &lt;BookOptions&gt;\n        &lt;Property Name=\"IsAuthorFilterNeeded\" Value =\"1\"&gt;\n          &lt;BookCode Value=\"5\" /&gt;\n          &lt;BookCode Value=\"6\" /&gt;\n          &lt;BookCode Value=\"7\" /&gt;\n          &lt;BookCode Value=\"8\" /&gt;\n        &lt;/Property&gt;\n        &lt;Property Name=\"IsTitleFilterNeeded\" Value =\"0\"&gt;\n          &lt;BookCode Value=\"2\"/&gt;\n          &lt;BookCode Value=\"3\"/&gt;\n          &lt;BookCode Value=\"4\"/&gt;\n          &lt;BookCode Value=\"7\"/&gt;\n          &lt;BookCode Value=\"129\"/&gt;\n        &lt;/Property&gt;\n       &lt;/BookOptions&gt; \n\n    &lt;/LibraryRack&gt;\n</code></pre>\n"},{"tags":["linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13131095,"title":"Find last record in nested list using linq","body":"<p>I have a nested xml something like this. </p>\n\n<pre><code> &lt; H&gt;\n\n   &lt; FP &gt;\n       &lt; Name=\"FP1\"/&gt;\n\n       &lt; R &gt;\n       &lt; Name = \"R1\"/&gt; \n\n            &lt; O&gt;\n            &lt; Name=\"O1\"/&gt;\n            &lt; /O&gt;\n            &lt; O&gt;\n                &lt; Name=\"O2\"/&gt;\n            &lt; /O&gt;\n     &lt; /R&gt;       \n     &lt; R&gt;\n     &lt; Name = \"R2\"/&gt;\n         &lt; O&gt;\n    &lt; Name=\"O4\"/&gt;\n          &lt; /O&gt;\n     &lt; /R&gt;\n&lt; /FP&gt;\n\n&lt; FP&gt;\n    &lt; Name=\"FP2\" /&gt;\n\n    &lt; R&gt;\n          &lt; Name = \"R3\"/&gt;\n\n          &lt; O&gt;\n             &lt; Name=\"O5\"/&gt;\n          &lt; /O&gt;\n          &lt; O&gt;\n             &lt; Name=\"O6\"/&gt;\n          &lt; /O&gt;\n    &lt; /R&gt;\n&lt; /FP&gt;\n\n   &lt; R&gt; \n       &lt; Name=\"R4\"/&gt;\n       &lt; O&gt;\n    &lt; Name=\"O7\"/&gt;\n   &lt; /O&gt;\n        &lt; O&gt;\n            &lt; Name=\"O8\"/&gt;\n        &lt; /O&gt;\n     &lt; /R&gt;\n &lt; R&gt;\n     &lt; Name=\"R5\"/&gt;\n     &lt; O &gt;\n          &lt; Name=\"O9\"/&gt;\n     &lt; /O&gt;\n  &lt; /R&gt;\n\n&lt; /H&gt;\n</code></pre>\n\n<p>I am using deserialization to read this xml. </p>\n\n<p>Here is my deserialization class: </p>\n\n<pre><code>[XmlRoot(\"H\")]\npublic class ReplyH\n{\n    [XmlElement(\"FP\")]\n    public List&lt;ReplyFP&gt; FPs;\n\n    [XmlElement(\"R\")]\n    public List&lt;ReplyR&gt; Rs;\n\n}\n\npublic class ReplyFP\n{\n    [XmlElement(\"Name\")]\n    public string Name;\n\n    [XmlElement(\"R\")]\n    public List&lt;ReplyR&gt; Rs = new List&lt;ReplyR&gt;();\n}\n\n\npublic class ReplyR\n{\n    [XmlElement(\"Name\")]\n    public string Name;\n\n    [XmlElement(\"O\")]\n    public List&lt;ReplyO&gt; Os = new List&lt;ReplyO&gt;();\n}\n\n\npublic class ReplyO\n{\n    [XmlElement(\"Name\")]\n    public string Name;\n}\n</code></pre>\n\n<p>I need to iterate over the O tags.</p>\n\n<p>something like foreach(var O in H.FP.R.O) and foreach(var O in H.R.O)</p>\n\n<p>1). I need to find the last <code>&lt;O&gt;</code> tag in  which in the above sample is \n&lt; O> &lt; Name = \"O9\" /> &lt; /O><code>.\n2). I also need to get the parent</code>R<code>Name and</code>FP<code>Name if exists for a particular</code>O`</p>\n\n<p>How can I get this using linq / lambda expression?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","datatable"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":113,"score":-1,"question_id":13117489,"title":"C# linq query on data table to convert rows to columns","body":"<p>I've one data table 'dataSet' like</p>\n\n<pre><code>ChUnit   ChNo   Value1    value2   Date1    Date2\nkw        1      2.3       2.2     2010      2011\nkvar      2      1.0       0.9     2012      2011\n</code></pre>\n\n<p>second data table 'peakData' like</p>\n\n<pre><code>ChUnit     ChNo   RateA   RateB  Total \nKwh         1      3.2      0     3.2\nKvarh       2      3.6      0     3.2\n</code></pre>\n\n<p>Below is the target table that i want after merging first and second table and it'll loop if Rate A,B.. not equals to zero</p>\n\n<pre><code>ChNo   ChUnit    val1    val2\n---------------------------------------  \n-1       Kwh     2010    2011\n 1       kw      2.3      2.2\n 2       kvar    1.0      0.9\n-2       Kvarh   2012    2011\n 1       kw      2.3      2.2\n 2       kvar    1.0      0.9\n</code></pre>\n\n<p>i tried like this but can't able to figured it out how to put values in val1 and val2 from below linq query?</p>\n\n<pre><code>var demandData = (from tbl in dataSet.AsEnumerable() \n                 join dmdTbl in peakData.AsEnumerable() on tbl[\"ChNo\"] equals dmdTbl[\"ChNo\"]                            \n                 select new\n                 {\n                    ChNo = tbl[\"Channel_No\"],\n                    ChUnit = dmdTbl[\"Channel_Unit\"],\n                    val1=dmdTbl[\"val1\"],\n                    val2=dmdTbl[\"val2\"]\n                 });\n</code></pre>\n\n<p>Here from above linq i'm getting results like:</p>\n\n<pre><code>    ChNo   ChUnit    val1    val2\n    ---------------------------------------  \n     1       kw      2.3      2.2\n     2       kvar    1.0      0.9\n     1       kw      2.3      2.2\n     2       kvar    1.0      0.9\n</code></pre>\n\n<p>But i want like this</p>\n\n<pre><code>    ChNo   ChUnit    val1    val2\n    ---------------------------------------  \n    -1       Kwh     2010    2011\n     1       kw      2.3      2.2\n     2       kvar    1.0      0.9\n    -2       Kvarh   2012    2011\n     1       kw      2.3      2.2\n     2       kvar    1.0      0.9\n</code></pre>\n\n<p>How can i get target table as above any one please give me any idea.</p>\n\n<p>Thanks,\n@nag</p>\n"},{"tags":["c#","asp.net","linq","linq-to-sql","webforms"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":136,"score":0,"question_id":11361041,"title":"Filtering results in ASP.NET Web Forms","body":"<p>I'm trying to walk through a tutorial on web forms, and my attempts to filter search results isn't working quite right:</p>\n\n<p>The contents of the asp page look like this:</p>\n\n<pre><code>&lt;form id=\"form1\" runat=\"server\"&gt;\n\n&lt;asp:TextBox ID=\"TextBox1\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n&lt;asp:Button ID=\"button1\" runat=\"server\" onclick=\"button1_Click\" Text=\"Submit\" /&gt;\n&lt;asp:GridView ID=\"GridView1\" AllowPaging=\"true\" PageSize=\"8\" AutoGenerateColumns=\"false\" runat=\"server\"\nOnPageIndexChanging=\"GridView1_PageIndexChanging\"&gt;\n\n   &lt;Columns&gt;\n      &lt;asp:BoundField HeaderText=\"Qual ID\" DataField=\"ID\" /&gt;\n      &lt;asp:BoundField HeaderText=\"Client Name\" DataField=\"Client_Name\" /&gt;\n      &lt;asp:BoundField HeaderText=\"Project\" DataField=\"Project_Name\" /&gt;\n      &lt;asp:BoundField HeaderText=\"Uploaded By\" DataField=\"Uploaded_By\" /&gt;\n   &lt;/Columns&gt;\n\n&lt;/asp:GridView&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>And the code behind file:</p>\n\n<pre><code>public partial class Sample1 : System.Web.UI.Page\n{\nprotected void Page_Load(object sender, EventArgs e)\n{\n\n    SourceDataContext db = new SourceDataContext();\n\n    GridView1.DataSource = from q in db.Cust\n                           orderby q.ID\n                           select q;\n    GridView1.DataBind();\n}\n\nprotected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)\n{\n    GridView1.PageIndex = e.NewPageIndex;\n\n    GridView1.DataBind();\n}\nprotected void button1_Click(object sender, EventArgs e)\n{\n    string client = TextBox1.Text;\n\n    SourceDataContext db = new SourceDataContext();\n\n    GridView1.DataSource = from q in db.Cust\n                           where q.Client_Name == client\n                           orderby q.ID\n                           select q;\n    GridView1.DataBind();\n\n}\n}\n</code></pre>\n\n<p>The filtering works, although it the paging stops working. Any suggestions appreciated.</p>\n\n<p>Thanks.</p>\n"},{"tags":["linq","nhibernate","join","fetch"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13085849,"title":"NHibernate Fetch / ThenFetch for joined siblings","body":"<p>I have the following (simplified) hierarchy of entities:</p>\n\n<pre><code>RootClass\n-&gt;DescriptorClass\n-&gt;SomeChild-&gt;DescriptorClass\n           -&gt;SomeGrandChild\n</code></pre>\n\n<p>I would like to fetch everything in a single query, if possible.</p>\n\n<p>Currently I have the following:</p>\n\n<pre><code>Session.Query&lt;RootClass&gt;().Where(/*some expressions here*/)\n                    .Fetch(v =&gt; v.DescriptorClass)\n                    .Fetch(v =&gt; v.SomeChild).ThenFetch(v =&gt; v.SomeGrandChild)\n                    .Fetch(v =&gt; v.SomeChild).ThenFetch(v =&gt; v.DescriptorClass);\n</code></pre>\n\n<p>it works fine but it creates an SQL query with two joins on SomeChild. Obviously, I have to get rid of that second Fetch(v => v.SomeChild) but I cannot find how to do it. \nI tried:</p>\n\n<pre><code>Session.Query&lt;RootClass&gt;().Where(/*some expressions here*/)\n                    .Fetch(v =&gt; v.DescriptorClass)\n                    .Fetch(v =&gt; v.SomeChild).ThenFetch(v =&gt; v.SomeGrandChild)\n                    .ThenFetch(v =&gt; v.DescriptorClass); //&lt;- wrong, tries to find DescriptorClass on SomeGranchild\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Session.Query&lt;RootClass&gt;().Where(/*some expressions here*/)\n                    .Fetch(v =&gt; v.DescriptorClass)\n                    .Fetch(v =&gt; v.SomeChild).ThenFetch(v =&gt; v.SomeGrandChild)\n                    .Fetch(v =&gt; v.DescriptorClass); //&lt;- wrong, loads the same DescriptorClass of RootClass, not on SomeChild\n</code></pre>\n\n<p>How do I tell NHibernate to create a single join on SomeChild and then fetch SomeGrandChild and DescriptorClass of SomeChild?</p>\n"},{"tags":["linq","datatable","using"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2487,"score":1,"question_id":4814645,"title":"Update one DataTable from other","body":"<p>create table employee<br>\n(<br>\nid int,<br>\nname varchar(10),<br>\ndept_id int,<br>\ndept_name varchar(10)<br>\n);<br>\n<br>\ninsert into employee values(1,'ABC1', 1,'');<br>\ninsert into employee values(2,'ABC2', 2,'');<br>\ninsert into employee values(3,'ABC3', 1,'');<br>\ninsert into employee values(4,'ABC4', 2,'');<br>\ninsert into employee values(5,'ABC5', 1,'');<br>\n<br>\ncreate table dept<br>\n(<br>\ndept_id int,<br>\ndept_name varchar(10)<br>\n);<br>\n<br>\ninsert into dept values(1,'XYZ1');<br>\ninsert into dept values(2,'XYZ2');<br>\n<br>\n<strong>UPDATE e<br>\nSET e.dept_name = d.dept_name<br>\nFROM employee AS e<br>\nJOIN dept AS d<br>\nON e.dept_id = d.dept_id</strong><br>\n<br>\nI want to convert above query(in bold letters) to LINQ query. Please help<br></p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":6,"view_count":63,"score":-5,"question_id":13114698,"title":"ienumerable update in foreach loop","body":"<p>I have a code like this. </p>\n\n<pre><code>IEnumerable&lt;string&gt; imagesFileNames = FindImages(imagesFolder);\n\n foreach(string imageFileName in imagesFileNames)\n\n            {\n                //my code\n                //IEnumerable&lt;string&gt; imagesFilesNames = FindImages(imagesFolder);\n                // it doesn't work!!  \n            }\n</code></pre>\n\n<p>Can i update the IENumerable collection in foreach loop? </p>\n"},{"tags":["c#","linq","application","windows-8","store"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13104972,"title":"Windows 8 Store App and Linq","body":"<p>The snippet below is from a Windows 8 store app in c# and xaml.\nI have put this code together from variou samples on the web so this may not be the neatest way of doing this. Most of it is from the Grid template supplied in VS2012 and I have hooked up my web api as the source of the data</p>\n\n<p>Please explain the following</p>\n\n<p>When i call the Get method all works fine and i get data back into the xaml view\nWhen i uncomment the Take(10) in the same method i get no data back.</p>\n\n<p>It seems any attempt to put an extension method of a LINQ variety just stops the data being returned and also gives no indication why, it complies fine!</p>\n\n<p>Any help appreciated</p>\n\n<p>Thanks \nMark</p>\n\n<pre><code>public class TeamDataSource\n{\n    private static TeamDataSource _sampleDataSource = new TeamDataSource();\n\n    private ObservableCollection&lt;TeamDataItem&gt; _items = new ObservableCollection&lt;TeamDataItem&gt;();\n    public ObservableCollection&lt;TeamDataItem&gt; Items\n    {\n        get { return this._items; }\n    }\n\n    public TeamDataSource()\n    {\n        this.Initialize();\n    }\n\n    public static IEnumerable&lt;TeamDataItem&gt; Get()\n    {\n        var thisdata = _sampleDataSource.Items;\n        return thisdata;//.Take(10);\n    }\n\n    private async void Initialize()\n    {\n        using (var client = new DataServiceClient())\n        {\n            List&lt;TeamDataItem&gt; list = await client.Download&lt;List&lt;TeamDataItem&gt;&gt;(\"/teams\");\n\n            foreach (var i in list.OrderByDescending(t =&gt; t.Points).ThenByDescending(t =&gt; t.GoalDiff))\n            {\n                TeamDataItem team = i;\n                _items.Add(team);\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13130213,"title":"How do I return a dictionary from a grouping operation with the grouping factor as the key?","body":"<p>The code below creates a list of strings.  The grouping factor is the StoreID (Item1).  What I want is a dictionary with the grouping factor (i.e. StoreID) as the key and the string as the value.  The input file is just a text file that contains 3 columns: StoreID, Quantity, and something else (which I can't remember) but these values are just concatenated together for each line for a store to make a comma and bar separated string.</p>\n\n<pre><code>var query = skuStoreStockLevel.GroupBy(x =&gt; x.Item1)\n                .Select(g =&gt; g.Aggregate(new StringBuilder(),\n                                         (sb, x) =&gt; sb.AppendFormat(\"{0}{1},{2},{3}\", \"|\", x.Item1, x.Item2, x.Item3),\n                                         (sb) =&gt; sb.ToString()));\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":13130094,"title":"Convert Datatable to Object with Linq and Group by","body":"<p>I try to convert datatable into JSON with special format</p>\n\n<p>Data in DataTable is as follow </p>\n\n<pre><code>col1 col2 col3 col4\n---------------------\n A    B    c    D1\n A    B    c    D2\n A    B    c    D3\n</code></pre>\n\n<p>Try to convert it to a object array like</p>\n\n<pre><code>class obj {\n var col1;\n var col2;\n var col3;\n list&lt;string&gt; col4;\n}\n</code></pre>\n\n<p>I try to use linq, but kinda get stuck.</p>\n\n<pre><code> var result = from row in dt.AsEnumerable()\n                         group row by new\n                         {\n                             c1 = row[\"col1\"],\n                             c2 = row[\"col2\"],\n                             c3 = row[\"col3\"]\n                         }\n                             into section\n                             select new\n                                 {\n                                     item = section.Key\n\n                                 };\n</code></pre>\n"},{"tags":["c#","xml","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":67,"score":-1,"question_id":13129048,"title":"c# linq Xdocument","body":"<p>I call a wcf service like this:</p>\n\n<pre><code>XDocument xdoc = null;\nxdoc = XDocument.Load(\"http:\\\\www.mydomain.com\\service\\helloservice\");\n</code></pre>\n\n<p>I receive a xml snippet from WCF like the below:</p>\n\n<pre><code>&lt;ArrayOfstring&gt;&lt;string&gt;hello&lt;/string&gt;&lt;string&gt;world&lt;/string&gt;&lt;string&gt;!&lt;/string&gt;&lt;/ArrayOfstring&gt;\n</code></pre>\n\n<p>I am trying to get the content within the  elements</p>\n\n<p>my code is like this but I never get anything back:</p>\n\n<pre><code>  var i = (from n in xdoc.Descendants(\"string\")\n                 select new { text =  n.Value});\n</code></pre>\n\n<p>when I do xdoc.DescendantNodes() I get:</p>\n\n<pre><code>[0] \"&lt;ArrayOfstring xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n  &lt;string&gt;HELLO&lt;/string&gt;\n&lt;/ArrayOfstring&gt;\"\n\n[1] \"&lt;string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\"&gt;HELLO&lt;/string&gt;\"\n\n[2] \"Hello\"\n</code></pre>\n\n<p>I am pretty new to this, I can't figure out why linq won't return results...Which Xdocument feature should I use? Some pointer would be appreciated. Thanks. </p>\n"},{"tags":["c#","asp.net","linq","function"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":13105518,"title":"How can I call a local function inside a LINQ query?","body":"<p>I tried:</p>\n\n<pre><code> var doctorPractise = from d in db.DoctorsPrivateClinics\n                                     where  GetDistance(db, d)&lt;1.0\n                                     select d;\n</code></pre>\n\n<p>But this doesn't work, GetDistance is a local function, I didn't get an exeption but it didn't seem to work, any ideas?\nThank you</p>\n\n<p>The GetDistance is:</p>\n\n<pre><code> private double GetDistance(DBClassesDataContext db, DoctorsPrivateClinic docPra)\n    {\n        double distance=-1;\n        double longitude;\n        double latitude;\n\n        var city = from c in db.Cities\n                   where c.Code == Convert.ToInt32(Request.QueryString[\"Area\"])\n                   select c;\n\n\n        foreach (var cit in city)//it will be just one row that will be found but I don't know how to express it without foreach\n        {\n            Calculations.GetLongitudeLatitudeGoogle getLongLat = new Calculations.GetLongitudeLatitudeGoogle();\n            getLongLat.GetLongitudeLatitude(\"\", cit.Name, \"\", out longitude, out latitude);\n            distance = CalcualateDistance(Convert.ToDouble(docPra.PrivateClinic.Latitude), Convert.ToDouble(docPra.PrivateClinic.Longtitude), latitude, longitude);\n        }\n        return distance;\n    }\n</code></pre>\n\n<p>What I want to achieve is to calculate the distance between a specific point on the map (cit.Name) and the location of a private clinic. The longitude and latitude of the specific point on the map is been retrieved from Googlemaps. In my query I specify that this distance must be less than 1 Km</p>\n"},{"tags":["c#","linq","generics"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":13125752,"title":"C#: Overload LINQ generic methods with different type parameters","body":"<p>I'm writing a collection of LINQ 2 SQL extension methods. Right now, I have a bunch of duplicate methods, one working on an IEnumerable collection and the other on an IQueryable collection. For example</p>\n\n<pre><code>public static IQueryable&lt;X&gt; LimitVisible(this IQueryable&lt;X&gt; items) {\n    return items.Where(x =&gt; !x.Hidden &amp;&amp; !x.Parent.Hidden);\n}\n\npublic static IEnumerable&lt;X&gt; LimitVisible(this IEnumerable&lt;X&gt; items) {\n    return items.Where(x =&gt; !x.Hidden &amp;&amp; !x.Parent.Hidden);\n}\n</code></pre>\n\n<p>I think I need this duplication because I want to be able to retain the IQueryable behavior in some cases, so that execution is deferred to the database. <strong>Is this a correct assumption or would a single IEnumerable method (plus casting the output to IQueryable) work?</strong> If I do need both, I don't like the duplication, so I want to combine the two using the generic method</p>\n\n<pre><code>public static T LimitVisible&lt;T&gt;(this T items) where T : IEnumerable&lt;X&gt; {\n    return (T)items.Where(x =&gt; !x.Hidden &amp;&amp; !x.Parent.Hidden);\n}\n</code></pre>\n\n<p>This works except that I have other types than X (say Y and Z) that I also want to write LimitVisible functions for. But I can't write</p>\n\n<pre><code>public static T LimitVisible&lt;T&gt;(this T items) where T : IEnumerable&lt;Y&gt; {\n    return (T)items.Where(y =&gt; !y.Hidden &amp;&amp; !y.Parent.Hidden);\n}\n</code></pre>\n\n<p>because you can overload based on generics. I could put these methods in different classes, but that doesn't seem like the right solution.</p>\n\n<p>Any suggestions? Maybe I'm making incorrect assumptions and there's no need for an IQueryable specific version in the first place.</p>\n\n<p><strong>Edit: Another Option</strong></p>\n\n<p>Here's another pattern I've used in the past to avoid duplication</p>\n\n<pre><code>private static readonly Expression&lt;Func&lt;X, bool&gt;&gt; F = x =&gt; !x.Hidden &amp;&amp; !x.Parent.Hidden;\n\npublic static IEnumerable&lt;X&gt; LimitVisible(this IEnumerable&lt;X&gt; e) {\n    return e.Select(W.Compile());\n}\n\npublic static IQueryable&lt;X&gt; LimitVisible(this IQueryable&lt;X&gt; q) {\n    return q.Select(W);\n}\n</code></pre>\n\n<p>Are there any dangers with this?</p>\n"},{"tags":["c#","asp.net","linq","object","relation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13126450,"title":"object mapping/relation in ORM","body":"<p>I have an object as below, which I populate from database, then to get the relationship for other object I just use clnt.cl.tolist() this will get me everything related to client in cl table :</p>\n\n<pre><code>Client clnt = Manager.Get_ByID(Id);\nList&lt;Cl&gt; lstCl = clnt.Cl.ToList();\n</code></pre>\n\n<p>now if I have a list as first object how do i do this:</p>\n\n<pre><code>List&lt;Client&gt; clnt = Manager.Get_ListByClientID(Id);\nList&lt;Cl&gt; lstCl = ???\n</code></pre>\n\n<p><strong>ALSO ::</strong></p>\n\n<p>on second list how do I select just one record using linq??</p>\n"},{"tags":["c#","xml","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":13125942,"title":"Convert string (System.String) to type","body":"<p>I am trying to create a generic XML to object converter. In other words, the following is my XML</p>\n\n<pre><code>&lt;setting&gt;\n   &lt;name&gt;testing&lt;/name&gt; \n   &lt;type&gt;System.String&lt;/type&gt;\n   &lt;defaultObj&gt;TTTT&lt;/defaultObj&gt;\n&lt;/setting&gt;\n</code></pre>\n\n<p>the type field holds the type of the object its loading back in. This is just the object structure I serailized in. Regardless, I am having an issue converting</p>\n\n<pre><code>System.String\n</code></pre>\n\n<p>into an actual type variable. So for instance, in order to convert I have the following code:</p>\n\n<pre><code>foreach (XNode node in document.Element(root).Nodes())\n{\n   T variable = new T(); //where T : new()\n\n   foreach (FieldInfo field in fields)\n   {\n      field.SetValue(variable, Convert.ChangeType(((XElement)node).Element(field.Name).Value, field.FieldType));\n   }\n\n   retainedList.Add(variable);\n}\n</code></pre>\n\n<p>which obtains objects back in a generic way. The algorithm works perfectly until it comes across the Type field. I get a:</p>\n\n<pre><code>Invalid cast from 'System.String' to 'System.Type'.\n</code></pre>\n\n<p>run time error. From what I can tell it is having an issue directly converting a type identifier (string) directly into a type. I am not sure how to get around this issue, atleast when it comes to keeping things generic and clean. Any ideas? I am sorry if the issue is a bit vague, if you don't quite understand I will try to clarify further. Any help is greatly appreciated!</p>\n"},{"tags":["c#",".net","sql","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13114878,"title":"Running total based on each record in a LINQ query for MVC ASP.net","body":"<p>I'm running into two issues: </p>\n\n<p>I tried assigning a ROW_NUMBER to my SQL view and do a running sum based on the row number (and therefore get the sums based on each record), but the resulting performance hit was quite noticeable.</p>\n\n<p>I know how to do this in T-SQL for dates: </p>\n\n<p><img src=\"http://i50.tinypic.com/15rgs3c.gif\" alt=\"enter image description here\"></p>\n\n<p>The <code>RunningTotal</code> column in this SQL statement is exactly what I need (itemized sums).  </p>\n\n<p><img src=\"http://i49.tinypic.com/6j2j4x.gif\" alt=\"enter image description here\"></p>\n\n<p>But it takes very long to execute.</p>\n\n<p><b>UPDATE 2</b> <br />Here is how I created my second view.<br /></p>\n\n<pre><code>CREATE VIEW [dbo].[vCI_UNIONALL_ROW] AS\nSELECT ROW_NUMBER() OVER(ORDER BY EffChkDt DESC) AS [Row]\n    ,*\nFROM vCI_UNIONALL\nGO\n</code></pre>\n\n<p>My model:</p>\n\n<pre><code>public class UnionAllModel\n{\n    public int? InvoiceNumber { get; set; }\n    [DataType(DataType.Currency)]\n    public Decimal? Amount { get; set; }\n    [DataType(DataType.DateTime)]\n    public DateTime? EffChkDt { get; set; }\n    [omitted for clarity]\n}\n</code></pre>\n\n<p>Here's my LINQ query so far:</p>\n\n<pre><code>using (var db = new PLOGITENS01Entities())\n{\n    var rvUnionAll = (from u in db.vCI_UNIONALL\n                      orderby u.EffChkDt ascending\n                      select new UnionAllModel()\n                      {\n                          InvoiceNumber = u.InvoiceNumber,\n                          Date = u.Date,\n                          AccountNumber = u.AccountNumber,\n                          ClientName = u.ClientName,\n                          Amount = u.Amount,\n                          InAmount = u.InAmount,\n                          OutAmount = u.OutAmount,\n                          ClientRiskAdjs = u.ClientRiskAdjs,\n                          SpecificAdjs = u.SpecificAdjs,\n                          EffChkDt = u.EffChkDt,\n                          PayStatus = u.PayStatus,\n                          Type = u.Type\n                      })\n                     .ToList();\n\n    return View(new GridModel(rvUnionAll));\n}\n</code></pre>\n"},{"tags":["c#","linq","c#-4.0","reflection","linq-to-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13125689,"title":"Order properties of object by value of customAttribute","body":"<p>What I'm trying to do is wirte linq expression which allows me to order my <code>List&lt;PropertyInfo&gt;</code> of some object by Custom attribute for example:</p>\n\n<pre><code>public class SampleClass{\n\n   [CustomAttribute(\"MyAttrib1\",1)]\n   public string Name{ get; set; }\n   [CustomAttribute(\"MyAttrib2\",1)]\n   public string Desc{get;set;}\n   [CustomAttribute(\"MyAttrib1\",2)]\n   public int Price{get;set;}\n}\n</code></pre>\n\n<p>CustomAttribute.cs:</p>\n\n<pre><code>public class CustomAttribute: Attribute{\n    public string AttribName{get;set;}\n    public int Index{get;set;}\n    public CustomAttribute(string attribName,int index)\n    {\n        AttribName = attribName;\n        Index = index;\n    }\n}\n</code></pre>\n\n<p>so far I was able to get all properties from my class named SampleClass:</p>\n\n<pre><code>List&lt;PropertyInfo&gt; propertiesList = new List&lt;PropertyInfo&gt;((IEnumerable&lt;PropertyInfo&gt;)typeof(SampleClass).GetProperties());\n</code></pre>\n\n<p>my tryed so far to sort this <code>propertiesList</code> (which btw doesn't work) :</p>\n\n<pre><code>var sortedPropertys = propertiesList\n            .OrderByDescending(\n                (x, y) =&gt; ((CustomAttribute) Attribute.GetCustomAttribute((PropertyInfo) x, typeof (CustomAttribute))).AttribName \n                .CompareTo((((CustomAttribute) Attribute.GetCustomAttribute((PropertyInfo) y, typeof (CustomAttribute))).AttribName ))\n            ).OrderByDescending(\n                (x,y)=&gt;((CustomAttribute) Attribute.GetCustomAttribute((PropertyInfo) x, typeof (CustomAttribute))).Index\n                .CompareTo((((CustomAttribute) Attribute.GetCustomAttribute((PropertyInfo) y, typeof (CustomAttribute))).Index)))\n                .Select(x=&gt;x);\n</code></pre>\n\n<p><strong>Output List should be (I'll tell it only with PropertyInfo.Name):</strong></p>\n\n<pre><code>property name: Name,Price,Desc\n</code></pre>\n\n<p>My question is: <strong>Is it possible to do that? And If yes how can I do this properly?</strong></p>\n\n<p>If you have some question pls ask (I'll do my best to answer every uncertainties). I hope description of problem is enough.</p>\n\n<p>Thanks for advance:)</p>\n"},{"tags":["linq","entity-framework","linq-expressions","soft-delete","expressionvisitor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12760933,"title":"ExpressionVisitor soft delete","body":"<p>We're having some issues implementing soft delete functionality with entity framework. The idea is to use a repository which is aware of the EF context. On the level of the repository we implemented a plugin system, these plugins get executed whenever an action is done on the repository. For example when we call <code>Repository.GetQuery&lt;Relation&gt;()</code> the plugins get executed. One of the plugins is a <code>LogicalDeletePlugin</code>, this plugin should add a <code>Where(x =&gt; x.IsDeleted)</code> statement to each table which is in the select. The idea was to implement this <code>IsDeleted</code> plugin using an <code>ExpressionVisitor</code> which visits the linq expression and finds all the \"table\" select statements and add the <code>IsDeleted</code> condition.</p>\n\n<p>To clarify the question/problem I'll explain the issue using some code examples. </p>\n\n<pre><code>void Main()\n{\nvar options = new ReadonlyRepositoryOptions() { ConnectionStringDelegate = () =&gt; Connection.ConnectionString };\nusing (var context = new ReadonlyObjectContextRepository&lt;PFishEntities&gt;(options))\n{\nvar query = context.GetQuery&lt;Relation&gt;()\n.Select(x =&gt; new {\nTest = x.Bonus,\nTestWorks = x.Bonus.Where(y =&gt; y.bonID == 100)\n});\n\nquery.InterceptWith(new TestVisitor()).ToList();\n}\n}\n\npublic class TestVisitor : ExpressionVisitor {\nprivate ParameterExpression Parameter { get; set; }\n\nprotected override Expression VisitBinary(BinaryExpression node) {\n\"VisitBinary\".Dump();\nExpression left = this.Visit(node.Left);\nExpression right = this.Visit(node.Right);\n\nvar newParams = new[] { Parameter };\nvar condition = (LambdaExpression)new LogicalDeletePlugin().QueryConditionals.First().Conditional;\nvar paramMap = condition.Parameters.Select((original, i) =&gt; new { original, replacement = newParams[i] }).ToDictionary(p =&gt; p.original, p =&gt; p.replacement);\n\nvar fixedBody = ParameterRebinder.ReplaceParameters(paramMap, condition.Body);\nreturn Expression.MakeBinary(ExpressionType.AndAlso, node, fixedBody, node.IsLiftedToNull, node.Method);\n    }\n\nprotected override Expression VisitParameter(ParameterExpression expr)\n{\nParameter = expr;\nreturn base.VisitParameter(expr);\n}\n}\nvoid Main()\n{\n    var options = new ReadonlyRepositoryOptions() { ConnectionStringDelegate = () =&gt; Connection.ConnectionString };\n    using (var context = new ReadonlyObjectContextRepository&lt;PFishEntities&gt;(options))\n    {\n        var query = context.GetQuery&lt;Relation&gt;()\n        .Select(x =&gt; new {\n            Test = x.Bonus,\n            TestWorks = x.Bonus.Where(y =&gt; y.bonID == 100)\n        });\n\n        query.InterceptWith(new TestVisitor()).ToList();\n    }\n}\n\npublic class TestVisitor : ExpressionVisitor {\n    private ParameterExpression Parameter { get; set; }\n\n    protected override Expression VisitBinary(BinaryExpression node) {\n        \"VisitBinary\".Dump();\n        Expression left = this.Visit(node.Left);\n        Expression right = this.Visit(node.Right);\n\n        var newParams = new[] { Parameter };\n        var condition = (LambdaExpression)new LogicalDeletePlugin().QueryConditionals.First().Conditional;\n        var paramMap = condition.Parameters.Select((original, i) =&gt; new { original, replacement = newParams[i] }).ToDictionary(p =&gt; p.original, p =&gt; p.replacement);\n        var fixedBody = ParameterRebinder.ReplaceParameters(paramMap, condition.Body);\n        return Expression.MakeBinary(ExpressionType.AndAlso, node, fixedBody, node.IsLiftedToNull, node.Method);\n    }\n\n    protected override Expression VisitParameter(ParameterExpression expr)\n    {\n        Parameter = expr;\n        return base.VisitParameter(expr);\n    }\n}\n</code></pre>\n\n<p>The above c# code will result in the following SQL code :</p>\n\n<pre><code>SELECT \n[UnionAll1].[relID] AS [C1], \n[UnionAll1].[C2] AS [C2], \n[UnionAll1].[C1] AS [C3], \n[UnionAll1].[bonID] AS [C4], \n[UnionAll1].[bonCUSTOMERID] AS [C5], \n[UnionAll1].[bonRELATIONARTICLEBONUSID] AS [C6], \n[UnionAll1].[bonINVOICEID] AS [C7], \n[UnionAll1].[bonSALEROWID] AS [C8], \n[UnionAll1].[bonVALUE] AS [C9], \n[UnionAll1].[bonPERCENTAGE] AS [C10], \n[UnionAll1].[bonMANUAL] AS [C11], \n[UnionAll1].[bonPAID] AS [C12], \n[UnionAll1].[IsDeleted] AS [C13], \n[UnionAll1].[InternalReference] AS [C14], \n[UnionAll1].[ConcurrencyToken] AS [C15], \n[UnionAll1].[Created] AS [C16], \n[UnionAll1].[CreatedBy] AS [C17], \n[UnionAll1].[Updated] AS [C18], \n[UnionAll1].[UpdatedBy] AS [C19], \n[UnionAll1].[DisplayMember] AS [C20], \n[UnionAll1].[ValueMember] AS [C21], \n[UnionAll1].[SearchField] AS [C22], \n[UnionAll1].[CreateDate] AS [C23], \n[UnionAll1].[C3] AS [C24], \n[UnionAll1].[C4] AS [C25], \n[UnionAll1].[C5] AS [C26], \n[UnionAll1].[C6] AS [C27], \n[UnionAll1].[C7] AS [C28], \n[UnionAll1].[C8] AS [C29], \n[UnionAll1].[C9] AS [C30], \n[UnionAll1].[C10] AS [C31], \n[UnionAll1].[C11] AS [C32], \n[UnionAll1].[C12] AS [C33], \n[UnionAll1].[C13] AS [C34], \n[UnionAll1].[C14] AS [C35], \n[UnionAll1].[C15] AS [C36], \n[UnionAll1].[C16] AS [C37], \n[UnionAll1].[C17] AS [C38], \n[UnionAll1].[C18] AS [C39], \n[UnionAll1].[C19] AS [C40], \n[UnionAll1].[C20] AS [C41], \n[UnionAll1].[C21] AS [C42], \n[UnionAll1].[C22] AS [C43]\nFROM  (SELECT \n    CASE WHEN ([Extent2].[bonID] IS NULL) THEN CAST(NULL AS int) ELSE 1 END AS [C1], \n    [Extent1].[relID] AS [relID], \n    1 AS [C2], \n    [Extent2].[bonID] AS [bonID], \n    [Extent2].[bonCUSTOMERID] AS [bonCUSTOMERID], \n    [Extent2].[bonRELATIONARTICLEBONUSID] AS [bonRELATIONARTICLEBONUSID], \n    [Extent2].[bonINVOICEID] AS [bonINVOICEID], \n    [Extent2].[bonSALEROWID] AS [bonSALEROWID], \n    [Extent2].[bonVALUE] AS [bonVALUE], \n    [Extent2].[bonPERCENTAGE] AS [bonPERCENTAGE], \n    [Extent2].[bonMANUAL] AS [bonMANUAL], \n    [Extent2].[bonPAID] AS [bonPAID], \n    [Extent2].[IsDeleted] AS [IsDeleted], \n    [Extent2].[InternalReference] AS [InternalReference], \n    [Extent2].[ConcurrencyToken] AS [ConcurrencyToken], \n    [Extent2].[Created] AS [Created], \n    [Extent2].[CreatedBy] AS [CreatedBy], \n    [Extent2].[Updated] AS [Updated], \n    [Extent2].[UpdatedBy] AS [UpdatedBy], \n    [Extent2].[DisplayMember] AS [DisplayMember], \n    [Extent2].[ValueMember] AS [ValueMember], \n    [Extent2].[SearchField] AS [SearchField], \n    [Extent2].[CreateDate] AS [CreateDate], \n    CAST(NULL AS bigint) AS [C3], \n    CAST(NULL AS bigint) AS [C4], \n    CAST(NULL AS bigint) AS [C5], \n    CAST(NULL AS bigint) AS [C6], \n    CAST(NULL AS bigint) AS [C7], \n    CAST(NULL AS decimal(20,4)) AS [C8], \n    CAST(NULL AS decimal(20,4)) AS [C9], \n    CAST(NULL AS bit) AS [C10], \n    CAST(NULL AS decimal(20,4)) AS [C11], \n    CAST(NULL AS bit) AS [C12], \n    CAST(NULL AS varchar(1)) AS [C13], \n    CAST(NULL AS varbinary(1)) AS [C14], \n    CAST(NULL AS datetimeoffset) AS [C15], \n    CAST(NULL AS varchar(1)) AS [C16], \n    CAST(NULL AS datetimeoffset) AS [C17], \n    CAST(NULL AS varchar(1)) AS [C18], \n    CAST(NULL AS varchar(1)) AS [C19], \n    CAST(NULL AS varchar(1)) AS [C20], \n    CAST(NULL AS varchar(1)) AS [C21], \n    CAST(NULL AS datetime2) AS [C22]\n    FROM  [dbo].[Relation] AS [Extent1]\n    LEFT OUTER JOIN [dbo].[Bonus] AS [Extent2] ON [Extent1].[relID] = [Extent2].[bonCUSTOMERID]\nUNION ALL\n    SELECT \n    2 AS [C1], \n    [Extent3].[relID] AS [relID], \n    2 AS [C2], \n    CAST(NULL AS bigint) AS [C3], \n    CAST(NULL AS bigint) AS [C4], \n    CAST(NULL AS bigint) AS [C5], \n    CAST(NULL AS bigint) AS [C6], \n    CAST(NULL AS bigint) AS [C7], \n    CAST(NULL AS decimal(20,4)) AS [C8], \n    CAST(NULL AS decimal(20,4)) AS [C9], \n    CAST(NULL AS bit) AS [C10], \n    CAST(NULL AS decimal(20,4)) AS [C11], \n    CAST(NULL AS bit) AS [C12], \n    CAST(NULL AS varchar(1)) AS [C13], \n    CAST(NULL AS varbinary(1)) AS [C14], \n    CAST(NULL AS datetimeoffset) AS [C15], \n    CAST(NULL AS varchar(1)) AS [C16], \n    CAST(NULL AS datetimeoffset) AS [C17], \n    CAST(NULL AS varchar(1)) AS [C18], \n    CAST(NULL AS varchar(1)) AS [C19], \n    CAST(NULL AS varchar(1)) AS [C20], \n    CAST(NULL AS varchar(1)) AS [C21], \n    CAST(NULL AS datetime2) AS [C22], \n    [Extent4].[bonID] AS [bonID], \n    [Extent4].[bonCUSTOMERID] AS [bonCUSTOMERID], \n    [Extent4].[bonRELATIONARTICLEBONUSID] AS [bonRELATIONARTICLEBONUSID], \n    [Extent4].[bonINVOICEID] AS [bonINVOICEID], \n    [Extent4].[bonSALEROWID] AS [bonSALEROWID], \n    [Extent4].[bonVALUE] AS [bonVALUE], \n    [Extent4].[bonPERCENTAGE] AS [bonPERCENTAGE], \n    [Extent4].[bonMANUAL] AS [bonMANUAL], \n    [Extent4].[bonPAID] AS [bonPAID], \n    [Extent4].[IsDeleted] AS [IsDeleted], \n    [Extent4].[InternalReference] AS [InternalReference], \n    [Extent4].[ConcurrencyToken] AS [ConcurrencyToken], \n    [Extent4].[Created] AS [Created], \n    [Extent4].[CreatedBy] AS [CreatedBy], \n    [Extent4].[Updated] AS [Updated], \n    [Extent4].[UpdatedBy] AS [UpdatedBy], \n    [Extent4].[DisplayMember] AS [DisplayMember], \n    [Extent4].[ValueMember] AS [ValueMember], \n    [Extent4].[SearchField] AS [SearchField], \n    [Extent4].[CreateDate] AS [CreateDate]\n    FROM  [dbo].[Relation] AS [Extent3]\n    INNER JOIN [dbo].[Bonus] AS [Extent4] ON ([Extent3].[relID] = [Extent4].[bonCUSTOMERID]) AND (100 = [Extent4].[bonID]) AND ([Extent4].[IsDeleted] &lt;&gt; cast(1 as bit))) AS [UnionAll1]\nORDER BY [UnionAll1].[relID] ASC, [UnionAll1].[C1] ASC\n</code></pre>\n\n<p>As you can see in the resulting SQL query the <code>IsDeleted</code> statements gets added to the <code>TestWorks = x.Bonus.Where(y =&gt; !y.IsDeleted)</code> \"select\" code. That's what the <code>TestVisitor</code> is currently doing. But the question is now how we can also implement this on the other selects, the <code>x =&gt; !x.IsDeleted</code> doesn't get added on the <code>Test = x.Bonus</code> part.</p>\n\n<p>Is the ExpressionVisitor the correct approach to get this done or should I go with another solution? All help is appreciated! If the explanation wasn't clear enough just let me know and I'll try to give some additional info!</p>\n\n<p>Edit:</p>\n\n<pre><code>protected override Expression VisitMember(MemberExpression node)\n    {\n        var test = typeof(bool);\n        if (node.Type != test &amp;&amp; node.Type != typeof(string))\n        {\n            var type = typeof(ArticleVat);\n            var condition = (LambdaExpression)Condition;\n            var newParams = new[] { Expression.Parameter(type, \"x\") };\n            var paramMap = condition.Parameters.Select((original, i) =&gt; new { original, replacement = newParams[i] }).ToDictionary(p =&gt; p.original, p =&gt; p.replacement);\n            var fixedBody = ParameterRebinder.ReplaceParameters(paramMap, condition.Body);\n            condition = Expression.Lambda(fixedBody, newParams);\n            var whereM = whereMethod.MakeGenericMethod(new [] { type });\n            var expr = Expression.Property(node.Expression, \"ArticleVat\");\n            var whereExpr = Expression.Call(whereM, expr, condition);\n//          whereExpr.Dump();\nnode.Dump();\n//          return Expression.MakeMemberAccess(whereExpr, node.Expression.Type.GetMember(node.Member.Name).Single());\n//           return Expression.MakeMemberAccess(\n//                whereExpr,\n//                node.Expression.Type.GetMember(node.Member.Name).Single());\n        }\n\n        return base.VisitMember(node);\n    }\n</code></pre>\n\n<p>The above is what I've added to the ExpressionVisitor. Now when I uncomment the return Expression.MamkeMemberaccess code an exception is thrown because it doesn't expect a MemberExpression or something.</p>\n"},{"tags":["linq","fluent-nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13124056,"title":"A fetch request must be a simple member access expression; '[100002]' is a SubQueryExpression instead","body":"<p>I get the following error:\n\"A fetch request must be a simple member access expression; '[100002]' is a SubQueryExpression instead. Parameter name: relatedObjectSelector\"</p>\n\n<p>Below is my query:</p>\n\n<pre><code>var query =\n    session.Query&lt;Customer().Where(cus =&gt; cus.CustomerId == customerId)\n    .Fetch(c =&gt; c.CustomerType) // Parent CustomerType\n    .Fetch(c =&gt; c.CustomerOrders) // Child Collection of orders\n    .ThenFetch(co =&gt; co.Select(it =&gt; it.Item)).ToList(); // A parent of CustomerOrder\n</code></pre>\n\n<p>If I take the 'ThenFetch' out then I do not get that error. However, I do need to retrieve the Item object.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","asp.net-mvc","linq","deferred-execution"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":101,"score":7,"question_id":13115008,"title":"Does LINQ deferred execution occur when rendering the view, or earlier?","body":"<p>Given a very basic LINQ that is returned to a MVC view, at what exact point does the deferred execution fire?</p>\n\n<p>In the controller:</p>\n\n<pre><code>public ActionResult Index()\n{\n    var model = _fooService.GetAll();\n    return View(model);\n}\n</code></pre>\n\n<p>In the model:</p>\n\n<pre><code>@foreach (var item in Model) {    \n    &lt;tr&gt;\n        &lt;td&gt;@item.Bar&lt;/td&gt;\n   &lt;/tr&gt;\n}\n</code></pre>\n\n<p>The query is not executed when we call <code>_fooService.GetAll()</code> of course, but is deferred to some later point - but at which exact point is it executed?</p>\n\n<ul>\n<li>The <code>return View(model);</code> statement in the controller (doesn't look like it)?</li>\n<li>The <code>@foreach (var item in Model)</code> line in the view?</li>\n<li>The first time the <code>@item.Bar</code> line in the view is hit?</li>\n<li>Something else that occurs in between <code>return View(model);</code> and the view being rendered?</li>\n</ul>\n"},{"tags":[".net","vb.net","linq","lambda-functions","linq-expressions"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13122052,"title":"Making expressions from lambda functions that are not for comparison","body":"<p>I'm currently building a UI that builds up queries and I would like to be able to store other expressions in the form of a lambda function (as it makes it easy to add them with intellisense etc).  However, I can't find any way of getting eg. a lambda that performs a member access to be converted to an expression that I can then insert into an expression tree.  </p>\n\n<p>nb. it isn't just member accesses that I need</p>\n\n<p>ie. I am trying to fill in the body of the following function</p>\n\n<pre><code>Function GetExpression(Of ParamType, ReturnType) _\n    (f As Func(Of ParamType, ReturnType)) As Expression\n</code></pre>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13121915,"title":"Creating a set of couples made of two rows in Linq","body":"<p>From the results of the SQL Server stored procedure 'sp_help' we get a DataSet containing a couple of tables. Seven if i am correct. One of them contains information about the constraints. Each foreign keys is documented by two consecutive rows in that table. The first row contains the constraint type, it's name and other details. It's followed by an empty row except for one column, 'constaint_keys' that contains the column names references of the constraint.</p>\n\n<p>Other constraint types are described in one single row.</p>\n\n<p>Any idea on how to \"flatten\" this information, using Linq, in a way that we can be sure that any couple made of two rows is really made of rows {n, n + 1}</p>\n\n<p>Thank you for your help! </p>\n"},{"tags":["c#","asp.net","linq","sql-server-2008"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13122935,"title":"Filling a Dictionary with large amount of LinqToSql objects fills up memory (IIS7 - W3WP.EXE)","body":"<p>I have a LinqToSQL query that reads large amount of data for a specific ID from a Table called \"Clients\" which contains about 20 rows of data about the client.</p>\n\n<pre><code>  var allClients = from client in context.Clients\n                         where client.ID == ID\n                         select client;\n\n\n  Dictionary&lt;string, Client&gt; existingEmailMap = new Dictionary&lt;string, Client&gt;();\n  Dictionary&lt;string, Client&gt; existingCellphoneMap = new Dictionary&lt;string, Client&gt;();\n\n foreach (Client client in allClients)\n        {\n            if (client.Email != null &amp;&amp; !existingEmailMap.ContainsKey(client.Email.Trim().ToUpper()))\n                existingEmailMap.Add(client.Email.Trim().ToUpper(), client);\n\n\n            if (client.Cellphone != null &amp;&amp; !existingCellphoneMap.ContainsKey(client.Cellphone.Trim().ToUpper()))\n                existingCellphoneMap.Add(client.Cellphone.Trim().ToUpper(), client);\n        }\n</code></pre>\n\n<p>As you can see I loop for each \"Client\" in allClients and check if Email and CellPhone exist, if one of them does exist i place them inside a Dictionary - This action fills IIS memory and if i have 100,000 clients it could take a lot of time and totally fill IIS memory to the maximum the computer can handle.\nI need this Dictionary so i can do some other checks on the clients before doing any update or insert.</p>\n\n<p>I know that Client object contains many other information other than the Client Info which might fill up memory.</p>\n\n<p>Any way to resolve this issue?</p>\n"},{"tags":["c#","linq","list","mono","accumulate"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13123041,"title":"Mono and Linq Aggregate method. Error trying to add items to a new list","body":"<p>Why this code doesn't work?</p>\n\n<pre><code>public static IList&lt;float&gt; CreateModifiedList(IList&lt;float&gt; list)\n{\n    IList&lt;float&gt; modifiedList= list.Aggregate(new List&lt;float&gt; (), (l, item) =&gt;l.Add(++item));\n\n    return modifiedList;\n}\n</code></pre>\n\n<p>When I try to compile it using Mono I get the following error:</p>\n\n<blockquote>\n  <p>error CS0029: Cannot implicitly convert type <code>void' to\n  </code>System.Collections.Generic.List'</p>\n</blockquote>\n"},{"tags":["c#","linq","collections"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13121953,"title":"Creating a collection of a particular property of all the elements of a collection without iterating the elements of that collection","body":"<p>I have a treenode collection as <code>IEnumerable&lt;treenode&gt;</code> nodes. Is there any method to create a collection of <code>treenode.guid</code> directly from nodes without iterating all the elements?</p>\n\n<p>E.g.:</p>\n\n<pre><code>guidcollection nodeguids = nodes.somemethod();\n</code></pre>\n"},{"tags":["vb.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13121350,"title":"Use Linq to select distinct on a single column then databind repeater VB.net","body":"<p>This works:</p>\n\n<pre><code>    Dim cmdSelect As Data.SqlClient.SqlCommand\n    Dim dtr As Data.SqlClient.SqlDataReader\n    Dim strSelect As String\n    strSelect = \"SELECT DISTINCT DVIRDate FROM dbo.tblDVIR \" _\n        &amp; \"WHERE (DVIRDate &gt; DATEADD(day, - 30, { fn NOW() }))\"\n    cmdSelect = New Data.SqlClient.SqlCommand(strSelect, ConDB)\n    ConDB.Open()\n    dtr = cmdSelect.ExecuteReader()\n    'Bind to Repeater\n    Repeater1.DataSource = dtr\n    Repeater1.DataBind()\n    dtr.Close()\n    ConDB.Close()\n\n   &lt;asp:Repeater ID=\"Repeater1\" runat=\"server\" &gt;\n   &lt;ItemTemplate&gt;  \n   &lt;%# DataBinder.Eval(Container.DataItem, \"DvirDate\")%&gt;\n   &lt;br /&gt;\n   &lt;/ItemTemplate&gt;\n   &lt;/asp:Repeater&gt;\n</code></pre>\n\n<p>But this does not:</p>\n\n<pre><code>    Dim db As New DataContext\n    Dim sel = From a In db.tblDVIRs _\n              Where a.DVIRDate &gt; DateAdd(DateInterval.Day, -30, Now()) _\n              Select a.DVIRDate _\n              Distinct\n\n    Repeater1.DataSource = sel\n    Repeater1.DataBind()\n</code></pre>\n\n<p>I get an HttpException, \"DataBinding: 'System.DateTime' does not contain a property with the name 'DvirDate'.\"</p>\n\n<p>Interesting enough, when i bind to a gridview with autogenerated columns = true, it works and the column is named \"Item\"</p>\n\n<p>Am I just not using the right expression in the <code>databinder.eval</code> or doing something else wrong? this should be easy in Linq, I've tried everything I can think of in the <code>databinder.eval()</code>, I must be missing something.</p>\n"},{"tags":["linq","json.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13118580,"title":"JSON.NET Argument Exception when creating JSON with LINQ","body":"<p>I'm using JSON.NET Linq to JSON, when I execute the below I get the following argument exception:</p>\n\n<blockquote>\n  <p>Can not add Newtonsoft.Json.Linq.JValue to Newtonsoft.Json.Linq.JObject</p>\n</blockquote>\n\n<p>What's wrong with the code</p>\n\n<pre><code>string content = new JObject(\n            new JObject(\"auth\",\n                        new JProperty(\"user\", \"anemail@gmail.com\"),\n                        new JProperty(\"secret\", \"somepassword\")\n                ),\n            new JObject(\"config\",\n                        new JProperty(\"template\", \"1\")\n                ),\n            new JObject(\"data\",\n                        new JProperty(\"email\", \"body\")\n                )\n            ).ToString();\n</code></pre>\n"},{"tags":["c#","mysql","linq","entity-framework","formatexception"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13120426,"title":"Why is there an input string exception for a query without where clause?","body":"<p>Using ASP.NET MVC 2, Entity Framework, MySQL, VS2010 Ultimate. I have researched long but running out of clue for general Input Exception hit from my code. Although I have removed all the where clause:</p>\n\n<pre><code>var record = (from staff in pmsEntities.ef_staff                          \n                           select staff\n                           ).FirstOrDefault();\n</code></pre>\n\n<blockquote>\n  <p>[FormatException: Input string was not in a correct format.]    </p>\n\n<pre><code>System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer&amp; number, NumberFormatInfo info, Boolean parseDecimal) +9594283    \nSystem.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info) +119    \nSystem.String.System.IConvertible.ToInt32(IFormatProvider provider) +46    \nSystem.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider) +385   \nMySql.Data.Entity.EFMySqlDataReader.ChangeType(Object sourceValue, Type targetType) +566    \nMySql.Data.Entity.EFMySqlDataReader.GetValue(Int32 ordinal) +231    \nSystem.Data.Common.Internal.Materialization.ErrorHandlingValueReader`1.GetValue(DbDataReader reader, Int32 ordinal) +215    \nSystem.Data.Common.Internal.Materialization.Shaper.GetPropertyValueWithErrorHandling(Int32 ordinal, String propertyName, String typeName) +68    \nlambda_method(Closure , Shaper ) +1088    \nSystem.Data.Common.Internal.Materialization.Shaper.HandleEntityAppendOnly(Func`2 constructEntityDelegate, EntityKey entityKey, EntitySet entitySet) +218    \nlambda_method(Closure , Shaper ) +291    \nSystem.Data.Common.Internal.Materialization.Coordinator`1.ReadNextElement(Shaper shaper) +170    \nSystem.Data.Common.Internal.Materialization.SimpleEnumerator.MoveNext()  +84    \nSystem.Linq.Enumerable.FirstOrDefault(IEnumerable`1 source) +4187840    \nSystem.Data.Objects.ELinq.ObjectQueryProvider.&lt;GetElementFunction&gt;b__1(IEnumerable`1 sequence) +41    \nSystem.Data.Objects.ELinq.ObjectQueryProvider.ExecuteSingle(IEnumerable`1 query, Expression queryRoot) +59    \nSystem.Data.Objects.ELinq.ObjectQueryProvider.System.Linq.IQueryProvider.Execute(Expression expression) +150    \nSystem.Linq.Queryable.FirstOrDefault(IQueryable`1 source) +265    \nIDP.Models.Login.IsValid(String _username, String _pwd, Int32 _type) in C:\\Users\\george\\Desktop\\Um\\idp\\nur\\IDP\\IDP\\Models\\Login.cs:36\n</code></pre>\n</blockquote>\n"},{"tags":["c#","linq","dynamic"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13119264,"title":"Dynamic LINQ querying of an ExpandoObject?","body":"<p>Is there any way to use the LINQ dynamic query library (System.Linq.Dynamic) to evaluate a condition based on the properties of an ExpandoObject? The following code throws an exception on the \"<code>var e...</code>\" line, saying \"No property or field 'Weight' exists in type ExpandoObject\":-</p>\n\n<pre><code>const string TestCondition = \"MyStateBag.Foo &gt;= 50 &amp;&amp; MyStateBag.Bar &gt;= 100\";\n\ndynamic myStateBag = new ExpandoObject();\nmyStateBag.Foo = 70;\nmyStateBag.Bar = 100;\n\nvar p = Expression.Parameter(typeof(ExpandoObject), \"MyStateBag\");\nvar e = DynamicExpression.ParseLambda(new[] { p }, null, TestCondition);\nvar result = e.Compile().DynamicInvoke(myStateBag);\nAssert.IsTrue(result);\n</code></pre>\n\n<p>The alternative would be to implement the \"statebag\" as a dictionary, but this will result in a slightly more verbose condition string, e.g. <code>MyStateBag[\"Foo\"] &gt;= 50 &amp;&amp; MyStateBag[\"Bar\"] &gt;= 100</code>. As this is going to be used as the basis of a user scripting environment, I would prefer the simpler ExpandoObject syntax if it's possible to achieve.</p>\n"},{"tags":["vb.net","linq","linq-to-sql","lambda"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13084948,"title":"Linq Group by With Sum Not returning results","body":"<p>I am currently trying to arrive at something like the following</p>\n\n<pre><code>Dim bf = (From th In Me.DBDataContext.TranHeads\n             Where (th.THCurrency &gt;= \"\" AndAlso th.THCurrency &lt;= \"ZZZ\") AndAlso\n                   (th.THCSCode &gt;= \"\" AndAlso th.THCSCode &lt;= \"ZZZZZZ\") AndAlso\n                   th.THDate &lt; New Date(2008, 1, 1)\n              Group By th.THCSCode, th.THCurrency Into Sum(th.THBalOutst)).ToList\n\nDim bf2 = From bfe In bf\n              Select New With {.ClientSupplier = \n                                If( DBDataContext.FindClient(bfe.THCSCode) IsNot Nothing,                                                                 \n                                    DBDataContext.FindClient(bfe.THCSCode).ToRepObj,\n                                    DBDataContext.FindSupplier(bfe.THCSCode).ToRepObj)}\n</code></pre>\n\n<p>The first variable is returning a list normally with 2 values and a sum of a value\nBut then the second list is saying no children available which is not possible as there definitely should be something.</p>\n\n<p>Can someone please point out as how I can do this properly. I have also tried multiple other ways if necessary i will append them although I think it would prove no point.</p>\n\n<p>I have also tried this using lambda and the code is like below</p>\n\n<pre><code>Me.DBDataContext.TranHeads.Where(Function(w) (w.THCurrency &gt;= \"\" AndAlso w.THCurrency &lt;= \"ZZZ\") AndAlso\n                                                           (w.THCSCode &gt;= \"\" AndAlso w.THCSCode &lt;= \"ZZZZZZ\") AndAlso\n                                                            w.THDate &lt; New Date(2008, 1, 1) AndAlso w.THLedger = strLedger).\n                                               GroupBy(Function(g) New With {Key g.Client, Key g.Currency}).\n                                               Select(Function(group) New roTranHead With {.ClientSupplier = group.Key.Client.ToRepObj}).ToList\n</code></pre>\n\n<p>When I try to group with Supplier and Client  an empty list is returned.</p>\n"},{"tags":["c#","database","linq","sorting","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13119263,"title":"Copying sorted values from one datatable to another Efficiency?","body":"<p>I am using the following code :</p>\n\n<pre><code>        EmpInfoDS = new DataSet();\n\n        con.Open(); // My connection name\n\n        string sqlRecords = \"Select * FROM tbl_EmpInfo\";\n        EmpInfoDA = new OleDbDataAdapter(sqlRecords, con);\n        EmpInfoDA.Fill(EmpInfoDS, \"EmpInfo\");\n\n            var sortedRows = (from myRow in EmpInfoDS.Tables[\"EmpInfo\"].AsEnumerable()\n                             orderby myRow[\"EmpID\"] ascending\n                             select myRow).ToArray();\n\n            EmpInfoDS.Tables.Remove(\"EmpInfo\");\n            DataTable EmpInfo = sortedRows.CopyToDataTable();\n            EmpInfo.TableName = \"EmpInfo\";\n            EmpInfoDS.Tables.Add(EmpInfo); \n\n        con.Close();\n</code></pre>\n\n<p>to sort the values in a datatable. Then removing that datatable and filling the sorted rows into a datatable with the same name.\nCan anyone tell me how much efficient this process is. ie. Performance drawbacks ???</p>\n\n<p>If there's a better way to accomplish this; Please tell me.</p>\n\n<p>Any help will be much appreciated. :)</p>\n"},{"tags":["c#","sql","linq","quotes"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":13118379,"title":"auto SQL field's quotation marks by type in c#","body":"<p>Suppose that I want to create an SQL SELECT statement dynamically with reflection on primary key. I search in the table for primary keys and then, I make the statement.</p>\n\n<p>Problem is, I don't know the type of fields that compose the primary key before getting them. So, if it's a string or date, I must add quotation marks but not if it's an int.</p>\n\n<p>Atm, I am doing like that :</p>\n\n<pre><code>var type = field.GetType().Name;\nif (type.ToLower().StartsWith(\"string\") || type.ToLower().StartsWith(\"date\"))\n{\n    field = \"\\\"\" + field + \"\\\"\";\n} else if (type.ToLower().StartsWith(\"char\"))\n{\n    field = \"\\'\" + field + \"\\'\";\n}\n</code></pre>\n\n<p>With this code, I can handle some SQL types but there are a lot more.</p>\n\n<p>My problem is that it's combined with LinQ. I got a DataContext object and a generic type table from the context. And context.ExecuteQuery only allows parameters to be passed has values. I also tried with Dynamic LinQ but I got the same problem</p>\n\n<p>Does anyone know a better solution?</p>\n"},{"tags":["c#","asp.net-mvc","linq","nhibernate","linq-to-nhibernate"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2466,"score":2,"question_id":2007038,"title":"LINQ-NHibernate - Selecting only a few fields (including a Collection) for a complex object","body":"<p>I'm using Fluent NHibernate in one of my projects (and ASP.NET MVC application), with LINQ to query to data (using the LINQ to NHibernate libraries).</p>\n\n<p>The objet names are changed to protect the innocent.</p>\n\n<p>Let's say I have the following classes Foo, Bar, Baz, and their appropriate tables in the database (MySQL).</p>\n\n<p>Foo has a many-to-many relationship with both Bar (table \"FooBar\") and Baz (table \"FooBaz\"), defined in the Fluent mappings. As such, the class interface is defined as follows:</p>\n\n<pre><code>public class Foo {\n    public virtual int id { get; set; }\n    public virtual string name { get; set; }\n    public virtual string email { get; set; }\n    public virtual IList&lt;Bar&gt; bars { get; set; }\n    public virtual IList&lt;Baz&gt; bazes { get; set; }\n}\n</code></pre>\n\n<p>This is a pretty standard class. We can see that a Foo object will have a list of bars and bazes.</p>\n\n<p>The problem comes when trying to do a LINQ query.</p>\n\n<p>If I do a simple query like this, it works fine (the where clause is unimportant) :</p>\n\n<pre><code>var foos = from foo in session.Linq&lt;Foo&gt;()\n           where email.equals(\"foo@bar.com\")\n           select foo;\n\nIList&lt;Foo&gt; listFoos = foos.ToList();\n</code></pre>\n\n<p>This will return a list of Foos, with all the fields populated (id, name, email, bars, bazes). log4net shows that NHibernate performs separate queries for the collections.</p>\n\n<p>The problem arises when I want to load only some fields. For example, I might want to load only the bars in the query, but not the bazes.</p>\n\n<p>This query compiles, but produces an error at runtime:</p>\n\n<pre><code>var foos = from foo in session.Linq&lt;Foo&gt;()\n           where email.equals(\"foo@bar.com\")\n           select new Foo() \n           {\n               id = foo.id,\n               name = foo.name,\n               email = foo.email,\n               bars = foo.bars\n           };\n\nIList&lt;Foo&gt; listFoos = foos.ToList();\n</code></pre>\n\n<p>The error I get is something along the lines of an array index out of bounds exception. The stack trace shows some methods names relating the collection handling on LINQ-NHibernate's side, but nothing else. The query reported by log4net shows no sign of a query on bars, which means than an error was caught before it had the time to perform the query to select the bars.</p>\n\n<p>Did anyone else had this kind of problem before? How did you solve it? I don't want to have to select all the objects everytime I open a web page in my application!</p>\n\n<p>Thank you!</p>\n\n<p><strong>Edit: here is the stacktrace, as requested.</strong></p>\n\n<pre><code>System.IndexOutOfRangeException: L'index se trouve en dehors des limites du tableau. (read: \"Index is out of bounds for the array.\")\n\n[IndexOutOfRangeException: L'index se trouve en dehors des limites du tableau.]\n   NHibernate.Transform.TypeSafeConstructorMemberInitResultTransformer.InvokeMemberInitExpression(MemberInitExpression expression, Object[] args, Int32&amp; argumentCount) +404\n   NHibernate.Transform.TypeSafeConstructorMemberInitResultTransformer.TransformTuple(Object[] tuple, String[] aliases) +150\n\n[QueryException: could not instantiate: Foo]\n   NHibernate.Transform.TypeSafeConstructorMemberInitResultTransformer.TransformTuple(Object[] tuple, String[] aliases) +265\n   NHibernate.Loader.Criteria.CriteriaLoader.GetResultColumnOrRow(Object[] row, IResultTransformer resultTransformer, IDataReader rs, ISessionImplementor session) +171\n   NHibernate.Loader.Loader.GetRowFromResultSet(IDataReader resultSet, ISessionImplementor session, QueryParameters queryParameters, LockMode[] lockModeArray, EntityKey optionalObjectKey, IList hydratedObjects, EntityKey[] keys, Boolean returnProxies) +330\n   NHibernate.Loader.Loader.DoQuery(ISessionImplementor session, QueryParameters queryParameters, Boolean returnProxies) +704\n   NHibernate.Loader.Loader.DoQueryAndInitializeNonLazyCollections(ISessionImplementor session, QueryParameters queryParameters, Boolean returnProxies) +70\n   NHibernate.Loader.Loader.DoList(ISessionImplementor session, QueryParameters queryParameters) +111\n   NHibernate.Loader.Loader.ListIgnoreQueryCache(ISessionImplementor session, QueryParameters queryParameters) +18\n   NHibernate.Loader.Loader.List(ISessionImplementor session, QueryParameters queryParameters, ISet`1 querySpaces, IType[] resultTypes) +79\n   NHibernate.Impl.SessionImpl.List(CriteriaImpl criteria, IList results) +407\n   NHibernate.Impl.CriteriaImpl.List(IList results) +41\n   NHibernate.Impl.CriteriaImpl.List() +35\n   NHibernate.Linq.&lt;GetEnumerator&gt;d__0.MoveNext() +71\n   System.Collections.Generic.List`1..ctor(IEnumerable`1 collection) +7665172\n   System.Linq.Enumerable.ToList(IEnumerable`1 source) +61\n   FooRepository.List(Int32 count) in C:\\...\\FooRepository.cs:38\n   FooController.List() in C:\\...\\FooController.cs:30\n   lambda_method(ExecutionScope , ControllerBase , Object[] ) +39\n   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +17\n   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +178\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +24\n   System.Web.Mvc.&lt;&gt;c__DisplayClassa.&lt;InvokeActionMethodWithFilters&gt;b__7() +52\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +254\n   System.Web.Mvc.&lt;&gt;c__DisplayClassc.&lt;InvokeActionMethodWithFilters&gt;b__9() +19\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +192\n   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +399\n   System.Web.Mvc.Controller.ExecuteCore() +126\n   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +27\n   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +7\n   System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext) +151\n   System.Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext) +57\n   System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext) +7\n   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +181\n   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +75\n</code></pre>\n"},{"tags":["c#","linq","dictionary"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":13118013,"title":"C# Dictionary Map","body":"<p>I have a dictionary:</p>\n\n<pre><code>   Dictionary&lt;ICD_Map2, string&gt; maps = new Dictionary&lt;ICD_Map2, string&gt;();\n\n    public class ICD_Map2\n    {\n        public string call_type {get; set; }\n        public string destination{get; set;} \n\n    }\n\nmaps.Add(new ICD_Map2() {call_type = \"Mobile SMS\", destination = \"Australia\"},\"Local Text\");\nmaps.Add(new ICD_Map2() {call_type = \"Mobile SMS\", destination = \"International\"},\"International Text\");\n</code></pre>\n\n<p>So what I want is, when I pass two variables:</p>\n\n<blockquote>\n  <p>Case 1 variable1 = \"Mobile SMS\" &amp;&amp; variable2 = \"Australia\" I want a function to return \"Local Text\" </p>\n  \n  <p>Case 2 \"International Text\" depending on my input variables matching ICD_Map2 definition \"Mobile SMS\" and \"International\".` </p>\n</blockquote>\n\n<p>How do I construct this mapping function to return the First of the set from a set ofresults (if there are more than one)? This is a very simplified example, I have over 100 mappings.</p>\n"},{"tags":["c#","linq","unity3d"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2668,"score":1,"question_id":3921058,"title":"Operation is not valid due to the current state of the object - Linq on List","body":"<p>This error is being thrown when running a Linq query over a List.</p>\n\n<p>I am using Unity3D 3.0 with C# (Unity3D uses Mono 2.6). Unity3D, as far as I know, is single-threaded. It works by attaching \"scripts\" (c# .cs files) that inherit a baseclass, to a \"GameObject\". Also, Unity controls instantiation and serialization of scripts so you can't use constructors.</p>\n\n<p>I have a RoadNetwork script that holds a reference to RoadNodes and RoadCurves, both of which locate RoadNetwork via a singleton and register/deregister themselves. I've put \"mini-factories\" in RoadNode and RoadCurve that do the hard work of hooking themselves up to a gameobject.</p>\n\n<p>RoadNode first checks with RoadNetwork to make sure there isnt already a node at that same position, by doing this:</p>\n\n<pre><code>public static RoadNode2 New(float x, float y, float z)\n{\n    //First try to find an existing one\n    var rn = RoadNetwork.Instance.GetNodeAtPosition(new Vector3(x, y, z))\n             ?? UnityReferenceHelper.GetNewGameObjectFor&lt;RoadNode2&gt;(\n                 \"RoadNode_\" + (RoadNetwork.Instance.Nodes.Count + 1).ToString(\"D3\"),\n                 RoadNetwork.Instance.transform.FindChild(\"Nodes\"));\n\n    rn.Position = new Vector3(x, y, z);\n\n    rn.gameObject.active = true;\n\n    return rn;\n}\n</code></pre>\n\n<p>Where the appropriate method in RoadNetwork is:</p>\n\n<pre><code>public RoadNode2 GetNodeAtPosition(Vector3 position)\n{\n    var tempList = new List&lt;RoadNode2&gt;();\n\n    return tempList.Single(x =&gt; x.Position == position);\n}\n</code></pre>\n\n<p>tempList was an attempt at narrowing down the problem but I get precisely the same error. It should be \"Nodes.Single(...\", but I doubt it matters. I get the same error if I call the Linq query directly in the New() method.</p>\n\n<p>So yes, this Exception throws and points me to that tempList.Single() line. What would the reason be?</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":52,"score":-1,"question_id":13116400,"title":"Accessing C# Dictionary and return value","body":"<p>I have a dictionary:</p>\n\n<pre><code>Dictionary&lt;ICD_Map2, string&gt; maps = new Dictionary&lt;ICD_Map2, string&gt;();\n</code></pre>\n\n<p>I add to the dictionary via button click:</p>\n\n<pre><code>private void button2_Click(object sender, EventArgs e)\n{\n    maps.Clear();\n    // Load mapping file.\n    var reader = new StreamReader(File.OpenRead(@\"Call_Details_Map.csv\"));\n    while (!reader.EndOfStream)\n    {\n        var line = reader.ReadLine();\n        var values = line.Split(',');\n\n        maps.Add(new ICD_Map2(values[0].Replace(\"\\\"\",\"\"), values[1].Replace(\"\\\"\",\"\")), values[2].Replace(\"\\\"\",\"\"));\n    }\n}\n</code></pre>\n\n<p>I want to use LINQ and map my keys to the \"string\" in maps.</p>\n\n<p>How do I do it?</p>\n\n<pre><code>var File001 = from line in File.ReadLines(ICD_process)\n              let l = line.Split(',')\n              where l[0] != \"\\\"Statement Date\\\"\"\n              select new\n              {\n                  CallType = maps.ToLookup(p =&gt; l[5], p =&gt; l[3]),\n                  Calls = l[11] == \"\\\"\\\"\" ? \"0\" : (maps.ToLookup(p =&gt; l[5], p =&gt; l[3]) == \"Mobile Data\" || maps.ToLookup(p =&gt; l[5], p =&gt; l[3]) == \"Mobile SMS\") ? \"0\" : l[11].Replace(\"\\\"\",\"\").ToString())\n              };\n</code></pre>\n\n<p>I am getting error in Calls variable in File001 Linq method</p>\n"},{"tags":["c#",".net","linq","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":366,"score":0,"question_id":11791652,"title":"Copying data from var to DataTable after LINQ query","body":"<p>I am using LINQ query to filter data from a datatable and placing the data in to another datatable. For this I am using foreach statement to copy values from var to datatable. The datatable will be containing a very huge no. of rows so can you suggest me a way in which I can do the copying in a single go?</p>\n\n<pre><code>            var drdatedisp = from row in dtfullreport.AsEnumerable()\n                             group row by row.Field&lt;string&gt;(\"Order_Date\") into g\n                             select new\n                             {\n                                 Order_Date = g.Key,\n                                 totalQnty = g.Sum(a =&gt; a.Field&lt;int&gt;(\"Item_Quantity\")),\n                                 totalTax = g.Sum(a =&gt; float.Parse(a.Field&lt;decimal&gt;(\"TAXAMT\").ToString())),\n                                 totalAmt = g.Sum(a =&gt; float.Parse(a.Field&lt;decimal&gt;(\"VALAMT\").ToString()))\n                             };\n            DataTable dtdatedisp = new DataTable();\n            dtdatedisp.Columns.Add(\"Order_Date\");\n            dtdatedisp.Columns.Add(\"Item_Quantity\");\n            dtdatedisp.Columns.Add(\"TAXAMT\");\n            dtdatedisp.Columns.Add(\"VALAMT\");\n            dtdatedisp.Rows.Clear();\n            foreach (var g in drdatedisp)\n            {\n                DataRow newRow1 = dtdatedisp.NewRow();\n                newRow1[0] = g.Order_Date;\n                newRow1[1] = g.totalQnty;\n                newRow1[2] = String.Format(\"{0:0.00}\", g.totalTax);\n                newRow1[3] = String.Format(\"{0:0.00}\", g.totalAmt);\n                dtdatedisp.Rows.Add(newRow1);\n            }\n        }\n</code></pre>\n\n<p>please see that there will be very less no of iterations....</p>\n\n<p>is there any way ?? Can you Help me ??</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13116346,"title":"error \"Sequence contains no elements\"","body":"<p>i have used below linq query code but it returns \"Sequence contains no elements\" , i am sure there is one item that should be return.</p>\n\n<p>the code is like below:</p>\n\n<pre><code>tblDocTranstoCon doctranstocon =_DataContext.tblDocTranstoCons\n                       .Single(dtcon =&gt; (dtcon.Docid == _DocID)\n                                     &amp;&amp; (dtcon.Transid==e.TransmittoconID)\n                                     &amp;&amp; (dtcon.Transid==e.TransID));\n</code></pre>\n"},{"tags":["linq","datagridview","datagridviewrow"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13111824,"title":"Get index of first row that matches with a pattern","body":"<p>I have a datagridview with some columns and rows. One of the columns is string type (<code>DataGridViewTextBoxColumn</code>). I would like to iterate over all the rows of this <code>DataGridViewTextBoxColumn</code> to find the index (row index) of the first element that matches with a specific string so I do:</p>\n\n<pre><code>int rowIndex = this.dataGridView1.Rows\n    .Cast&lt;DataGridViewRow&gt;()\n    .ToArray()\n    .First(row =&gt; row.Cells[this.colDesired.Index].Value == stringToSearch)\n    .Index;  \n</code></pre>\n\n<p>but an error is raised.</p>\n\n<p>I want to use Linq and lambdas.</p>\n"},{"tags":["sql-server","linq","stored-procedures"],"answer_count":11,"favorite_count":5,"up_vote_count":4,"down_vote_count":0,"view_count":10660,"score":4,"question_id":752064,"title":"Performance Difference between LINQ and Stored Procedures","body":"<h3>Related</h3>\n\n<blockquote>\n  <p><a href=\"http://stackoverflow.com/questions/14530/linq-to-sql-vs-stored-procedures\">LINQ-to-SQL vs stored procedures?</a></p>\n</blockquote>\n\n<p>I have heard a lot of talk back and forth about the advantages of stored procedures being pre compiled. But what are the actual performance difference between LINQ and Stored procedures on Selects, Inserts, Updates, Deletes? Has anyone run any tests at all to see if there is any major difference. I'm also curious if a greater number of transactions makes a difference.</p>\n\n<p>My guess is that LINQ statements get cached after the first transaction and performance is probably going to be nearly identical. Thoughts?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13115208,"title":"Check if xml values are contained within a list","body":"<p>I have: </p>\n\n<pre><code>var results = response.Xml.Descendants(\"M\").Where(foo =&gt; foo.Value.Contains(\"john\"));\n</code></pre>\n\n<p>How do I change this to be:</p>\n\n<pre><code>List&lt;string&gt; ValidUsers = new List&lt;string&gt;();\nValidUsers.Add(\"John\");\nValidUsers.Add(\"Smurf\");\nvar results = response.Xml.Descendants(\"M\")\n    .Where(foo =&gt; foo.Value.Contains(ValidUsers));\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13114664,"title":"LINQ: bad conversion from LINQ to sql query","body":"<p>I am getting some problem with the conversion of linq query to sql query. The source of the problem is when i am using IBPUNO field what is a string type in the edmx file and nchar in sql server)</p>\n\n<pre><code>var query = (from c in ContextM3.MPLINE where c.IBSUNO == supplier.M3Code.Trim() &amp;&amp;       orderNumbers.Contains(c.IBPUNO)\n</code></pre>\n\n<p>The conversion of the \"where\" clause from linq query to sql servr is something like:</p>\n\n<pre><code>...WHERE ([Extent1].[IBSUNO] = (LTRIM(RTRIM(@p__linq__0)))) AND ([Extent1].[IBPUNO] IN (N''177828'',N''7115912'))',N'@p__linq__0 nvarchar(4000)',@p__linq__0=N'8100033   '\n</code></pre>\n\n<p>If I execute this sql query in the ssms I got no rows but if i change the sql query to</p>\n\n<pre><code>WHERE ([Extent1].[IBSUNO] = (LTRIM(RTRIM(@p__linq__0)))) AND ([Extent1].[IBPUNO] IN (177828,7115912))',N'@p__linq__0 nvarchar(4000)',@p__linq__0=N'8100033   '\n</code></pre>\n\n<p>then woks fine and it retrieve the rows what i want (the change what i did is translate\nthe values N''177828'' TO only 177828 so my question how i can say to Net do this change??</p>\n\n<pre><code>[Extent1].[IBPUNO] IN (N''177828'',N''7115912'))\n</code></pre>\n\n<p>TO\n    [Extent1].[IBPUNO] IN (177828,7115912))</p>\n"},{"tags":["c#","linq","query","table","reference"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13114418,"title":"Including a junction table in a LINQ Query?","body":"<p>I'm having difficulty writing a LINQ query. Here is my scenario:</p>\n\n<p>Three database tables:<br />\n<strong>InterviewRequests</strong><br/>\n<strong>Contacts</strong><br />\n<strong>InterviewRequestContacts</strong> (a junction table containing <strong>ID</strong>, <strong>InterviewRequestID</strong>, <strong>ContactID</strong>)</p>\n\n<p>My goal is to have a table of <strong>InterviewRequests</strong>, and to display the <strong>Contact</strong> for each InterviewRequest. So I will need to fetch all InterviewRequests, and for each InterviewRequest the associated Contact using the <strong>InterviewRequestContacts</strong> junction table.</p>\n\n<p>How can I do this using LINQ? I've tried various methods but couldn't get it to work.</p>\n\n<p>EDIT: I'm using EntityFramework 5.0 and generated an .edmx ADO.NET Entity Data Model.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13113005,"title":"What is an efficient way of iterating through a list according to its distinct values?","body":"<pre><code>string sStoreStockFeed = \"\";\nstring sSeparator = \"\";\n\nvar distinctStoreIDList = skuStoreStockLevels.Select(x =&gt; x.Item1).Distinct();\n\n    foreach (var storeID in distinctStoreIDList)\n    {\n        foreach (var item in skuStoreStockLevels)\n        {\n            if (item.Item1 == storeID)\n            {\n               // add this one to a job for this store\n                       sStoreStockFeed += sSeparator + item.Item1.ToString() + \",\" + item.Item2.ToString() + \",\" + item.Item3.ToString();\n                       sSeparator = \"|\";\n            }\n        }\n      // some code to process the string before moving on\n      sStoreStockFeed = \"\";\n      sSeparator = \"\";\n    }\n</code></pre>\n\n<p>In the above code snippet skuStoreStockLevels just happens to be a List of type Tuple and Item1 is the StoreID.  having got a distinct list it then iterates through the (non-distinct) list to get every applicable item.  The inefficiency is that the (big) inner list is iterated throuh repeatedly for each distinct item (StoreID).</p>\n"},{"tags":["asp.net-mvc","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13105745,"title":"linq nested group by","body":"<p>I have a table Assessment, which contains {rated,rater,assessment_id} another table is Category_Scores which contains {score, assessment_id}. I am attempting to group this by rated group by raters, group by scores. Currently I have this LINQ query</p>\n\n<pre><code>        var query = (from a in db.Assessments\n                     join u in db.Users on a.rated equals u.user_id\n                     join u2 in db.Users on a.rater equals u2.user_id\n                     join tm in db.Team_Members on u.user_id equals tm.user_id\n                     join t in db.Teams on tm.team_id equals t.team_id\n                     join c in db.Category_Scores on a.assessment_id equals c.assessment_id\n                     join cat in db.Categories on c.category_id equals cat.category_id\n\n                     group new KyubiViewModel\n                     {\n                         rated = u.firstName + \" \" + u.lastName,\n                         rater = u2.firstName + \" \" + u2.lastName,\n                         score = c.score,\n                         category_name = cat.name,\n                         categoryid = c.category_id,\n\n                     }\n                     by new { rated = u.firstName + \" \" + u.lastName,rater = u2.firstName + \" \" + u2.lastName }).ToList();\n</code></pre>\n\n<p>This results in </p>\n\n<pre><code>  { rated = John Will, rater = Jess James}\n   10 [Math]\n   10 [Science]\n\n  { rated = John Will, rater = Mike Rand}\n   7 [Math]\n   7 [Science]\n</code></pre>\n\n<p>I want it to look like</p>\n\n<pre><code> { rated = John Will }\n     rater:        Math      Science\n     Jess James     10         10\n     Mike Rand      7          7\n\n { rated = Jess James }\n     rater:        Math      Science\n     John Will      9          9\n     Mike Rand      7          7\n</code></pre>\n\n<p>Here's my View </p>\n\n<pre><code>     &lt;table&gt;\n@foreach (var group in Model)\n{\n &lt;tr&gt;\n &lt;td&gt;@group.Key &lt;/td&gt;\n &lt;/tr&gt;\n    foreach (var m in group)\n    {\n\n      &lt;tr&gt;\n      &lt;td&gt;@m.score - [@m.category_name]&lt;/td&gt;\n &lt;/tr&gt;\n\n     }\n}\n\n&lt;/table&gt;\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n\n<p>With ChaseMedallion's help i was able to have this in my view </p>\n\n<pre><code> { rated = John Will }\n         rater:        \n         Jess James     10[Math]    \n         Jess James     10[Science]    \n         Mike Rand      7[Math]          \n         Mike Rand      7[Science]\n</code></pre>\n\n<p>I wish to have it this way if possible</p>\n\n<pre><code> { rated = John Will }\n     rater:        Math      Science\n     Jess James     10         10\n     Mike Rand      7          7\n</code></pre>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13107985,"title":"Sql to linq convention","body":"<p>i have a problem to build my linq query and i need you help , the following code is what i have got so far\n, it does has some errors as expected, so, this is my sql query :</p>\n\n<p>*im new to linq and did searched over google.</p>\n\n<pre><code>select CAST(h.changedate as date) as 'RegDate' ,count (cast(h.changedate as date)) as 'Amount' from T_TalmidStatusHistory h\n    join T_talmid t on h.talmidid = t.talmidid \n    where t.talmidStatusID=16 and h.[statusid] != 16\n        and h.id =\n            (\n                select max(id) from T_TalmidStatusHistory \n                    where T_TalmidStatusHistory.talmidid=h.talmidid  and T_TalmidStatusHistory.[statusid] != 16\n            )\n    group by CAST(h.changedate as date)\n</code></pre>\n\n<p>and this is what i have right now in linq:</p>\n\n<pre><code>    var res = from r in db.T_TalmidStatusHistories\n              from m in db.T_TalmidStatusHistories\n   join t in db.T_Talmids  on r.TalmidID equals t.TalmidID\n   where  t.TalmidStatusID == 16 &amp;&amp; r.StatusID != 16\n    &amp;&amp; r.id == from l in db.T_TalmidStatusHistories\n        where m.TalmidID  == r.TalmidID &amp;&amp; m.StatusID != 16\n        select new{db.T_TalmidStatusHistories.OrderByDescending(tp =&gt; tp.id).FirstOrDefault().id }\n        group h by h.changedate as date\n   select new { h.changedate as date, count (cast(h.changedate as date))};\n</code></pre>\n\n<p>Edit:\ni'm expecting to get the number of students that sign up on each date,</p>\n\n<p>my error is :\nOperator '==' cannot be applied to operands of type 'int' and 'System.Linq.IQueryable'\nat line : r.id == from l in db.T_TalmidStatusHistories</p>\n\n<p>ty.</p>\n"},{"tags":["c#","database","linq","ado.net","datatable"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13108800,"title":"How do I fill the \"var\" from a LINQ query into the same datatable?","body":"<p>I am fairly new to LINQ and am trying to apply this query on a datatable called \"EmpInfo\" to sort it.</p>\n\n<pre><code>var sortedRows = (from myRow in EmpInfoDS.Tables[\"EmpInfo\"].AsEnumerable()\n                 orderby myRow[\"EmpID\"] ascending\n                 select myRow).ToArray();\n</code></pre>\n\n<p>This works. The next thing I am trying to do is to copy the results into the SAME datatable.</p>\n\n<pre><code>EmpInfoDS.Tables[\"EmpInfo\"].Clear();\nEmpInfoDS.Tables[\"EmpInfo\"] = sortedRows.CopyToDataTable();\n</code></pre>\n\n<p>The second line throws the following error:</p>\n\n<blockquote>\n  <p>\"Property or indexer 'System.Data.DataTableCollection.this[string]'\n  cannot be assigned to -- it is read only\"</p>\n</blockquote>\n\n<p>Please some one tell me how to deal with this. And if there is another way please tell me.</p>\n"},{"tags":["c#","linq","list","intersect","except"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13108583,"title":"Combine two lists of entities with a condition","body":"<p>Say I have a class defined as </p>\n\n<pre><code>class Object\n{\n    public int ID { get;set; }\n    public string Property { get; set; }\n\n    public override bool Equals(object obj)\n    {\n        Object Item = obj as Object;\n        return Item.ID == this.ID;\n    }\n\n    public override int GetHashCode()\n    {\n        int hash = 13;\n        hash = (hash * 7) + ID.GetHashCode();\n        return hash;       \n    }\n}\n</code></pre>\n\n<p>And two lists, defined like so:</p>\n\n<pre><code>List&lt;Object&gt; List1;\nList&lt;Object&gt; List2;\n</code></pre>\n\n<p>These two lists contain objects where <code>ID</code> fields could be the same, but <code>Property</code> fields may or may not. I want to have a result of all objects contained in <code>List1</code> together with all objects contained in <code>List2, with the condition that</code>Property<code>field must be set to</code>\"1\"<code>if it is set to</code>\"1\"` in any of those lists. The result must contain distinct values (distinct IDs).</p>\n\n<p>For example, if we have 2 lists like this:</p>\n\n<pre><code>List1 \n-----  \nID = 0, Property = \"1\"\nID = 1, Property = \"\"\nID = 2, Property = \"1\"\nID = 3, Property = \"\"\n\nList2\n-----\nID = 1, Property = \"1\"\nID = 2, Property = \"\"\nID = 3, Property = \"\"\n</code></pre>\n\n<p>I need a result to look like this:</p>\n\n<pre><code>Result\n-------\nID = 0, Property = \"1\"\nID = 1, Property = \"1\"\nID = 2, Property = \"1\"\nID = 3, Property = \"\" \n</code></pre>\n\n<p>Currently it works like this:</p>\n\n<pre><code>var Result = List1.Except(List2).Concat(List2.Except(List1));\nvar Intersection = List1.Intersect(List2).ToList();\nIntersection.ForEach(x =&gt; {\n    x.Property = List1.Single(y =&gt; y.ID == x.ID).Property == \"1\" ? \"1\" : List2.Single(y =&gt; y.ID == x.ID).Property == \"1\" ? \"1\" : \"\";\n});\n\nResult = Result.Concat(Intersection);\n</code></pre>\n\n<p>...but ForEach is very slow. Can someone suggest a faster way?</p>\n"},{"tags":["c#",".net","facebook","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13108558,"title":"Facebook friends with LINQ","body":"<p>I am building a linq-to-sql web application and I've encountered a problem.\nI am trying to use the user's friends list fetched in real time from facebook, and then joining them against SQL tables.</p>\n\n<p>For that I am usually using .Contains(friends) where friends are the User IDs.\nthe problem is that LINQ will not be able to use .contains(friends) when friends are more than 2100 values and I am getting an exception.</p>\n\n<p>So my question is - what is the best practice for reading on the fly the user's friends and joining that with my SQL tables?</p>\n\n<p>Thanks y'all!</p>\n"},{"tags":["database","linq","query","entity-framework","linq-to-sql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13108228,"title":"Loading the last related record instantly for multiple parent records using Entity framework","body":"<p>Does anyone know a good approach using Entity Framework for the problem described below?</p>\n\n<p>I am trying for our next release to come up with a performant way to show the placed orders for the logged on customer.\nOf course paging is always a good technique to use when a lot of data is available I would like to see an answer without any paging techniques.</p>\n\n<p>Here's the story: a customer places an order which gets an orderstatus = PENDING. Depending on some strategy we move that order up the chain in order to get it APPROVED.\nEvery change of status is logged so we can see a trace for statusses and maybe even an extra line of comment per status which can provide some extra valuable information to whoever sees this order in an interface.</p>\n\n<p>So an Order is linked to a Customer. One order can have multiple orderstatusses stored in OrderStatusHistory.</p>\n\n<p>In my testscenario I am using a customer which has 100+ Orders each with about 5 records in the OrderStatusHistory-table.\nI would for now like to see all orders in one page not using paging where for each Order I show the last relevant Status and the extra comment (if there is any for this last status; both fields coming from OrderStatusHistory; the record with the highest Id for the given OrderId).</p>\n\n<p>There are multiple scenarios I have tried, but I would like to see any potential other solutions or comments on the things I have already tried.</p>\n\n<ul>\n<li>Trying to do Include() when getting Orders but this still results in multiple queries launched on the database. Each order triggers an extra query to the database to get all orderstatusses in the history table. So all statusses are queried here instead of just returning the last relevant one, plus 100 extra queries are launched for 100 orders. You can imagine the problem when there are 100000+ orders in the database.</li>\n<li>Having 2 computed columns on the database: LastStatus, LastStatusInformation and a regular Linq-Query which gets those columns which are available through the Entity-model.\nThe problem with this approach is the fact that those computed columns are determined using a scalar function which can not be changed without removing the formula from the computed column, etc...</li>\n</ul>\n\n<p>In the end I am very familiar with SQL and Stored procedures, but since the rest of the data-layer uses Entity Framework I would like to stick to it as long as possible, even though I have my doubts about performance.\nUsing the SQL approach I would write something like this:</p>\n\n<pre><code>WITH cte (RN, OrderId, [Status], Information)\nAS\n(\nSELECT ROW_NUMBER() OVER (PARTITION BY OrderId ORDER BY Id DESC), OrderId,    [Status], Information\nFROM OrderStatus\n)\nSELECT o.Id, cte.[Status], cte.Information AS StatusInformation, o.* FROM [Order] o\nINNER JOIN cte ON o.Id = cte.OrderId AND cte.RN = 1\nWHERE CustomerId = @CustomerId\nORDER BY 1 DESC;\n</code></pre>\n\n<p>which returns all orders for the customer with the statusinformation provided by the Common Table Expression.</p>\n\n<p>Does anyone know a good approach using Entity Framework?</p>\n"},{"tags":[".net","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":273,"score":1,"question_id":1325316,"title":"LinQ XML mapping to a generic type","body":"<p>Im trying to use an external XML file to map the output from a stored procedure into an instance of a class. The problem is that my class is of a generic type:</p>\n\n<pre><code>public class MyValue&lt;T&gt;\n{\n  public T Value\n  {\n    get;\n    set;\n  }\n}\n</code></pre>\n\n<p>Searching through a lot of blogs an articles I've managed to get this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;Database Name=\"\" xmlns=\"http://schemas.microsoft.com/linqtosql/mapping/2007\"&gt;\n    &lt;Table Name=\"MyValue\" Member=\"MyNamespace.MyValue`1\" &gt;\n    \t&lt;Type Name=\"MyNamespace.MyValue`1\"&gt;\n    \t\t&lt;Column Name=\"Category\" Member=\"Value\" DbType=\"VarChar(100)\" /&gt;\n    \t&lt;/Type&gt;\n    &lt;/Table&gt;\n    &lt;Function Method=\"GetResourceCategories\" Name=\"myprefix_GetResourceCategories\" &gt;\n    \t&lt;ElementType Name=\"MyNamespace.MyValue`1\"/&gt;\n    &lt;/Function&gt;\n&lt;/Database&gt;\n</code></pre>\n\n<p>The <strong>MyNamespace.MyValue`1</strong> trick works fine, and the class is recognized. I expect four rows from the stored procedure, and I'm getting four MyValue&lt;string&gt; instances, but the big problem is that the property Value for the all four instances is null. The property is not getting mapped and I don't really get why. Maybe worth noting that the property Value is generic, and that when the mapping is done using attributes it works perfect.</p>\n\n<p>Anyone have a clue?</p>\n\n<p>BTW the method GetResourceCategories:</p>\n\n<pre><code>public ISingleResult&lt;MyValue&lt;string&gt;&gt; GetResourceCategories()\n{\n  IExecuteResult result = this.ExecuteMethodCall(\n    this,\n    (MethodInfo)MethodInfo.GetCurrentMethod());\n\n  return (ISingleResult&lt;MyValue&lt;string&gt;&gt;)result.ReturnValue;\n}\n</code></pre>\n"},{"tags":["c#","winforms","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13080734,"title":"How to generate a Pivot Datagridview in WinForms and EntityFramework","body":"<p>I want to generate a Pivot Datagridview in WinForms and EntityFramework, starting from theses Entities:</p>\n\n<pre><code>public class Return\n{\n    public Return()\n    {\n        this.ReturnQty = new List&lt;ReturnQty&gt;();\n    }\n\n    public int Id { get; set; }\n    public Nullable&lt;System.DateTime&gt; Date { get; set; }\n    public Nullable&lt;int&gt; ReturnReason { get; set; }\n    public Nullable&lt;System.DateTime&gt; Belastungsdatum { get; set; }\n    public virtual ICollection&lt;ReturnQty&gt; ReturnQty  { get; set; }\n}\n\npublic class ReturnQty\n{\n    public int ID { get; set; }\n    public int Return_ID { get; set; }\n    public string ItemNo { get; set; }\n    public Nullable&lt;decimal&gt; Qty { get; set; }\n    public virtual Return Return { get; set; }\n}\n</code></pre>\n\n<p>The Pivot Dataviewgrid should look like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/C1BtW.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is what I have now:</p>\n\n<pre><code>public static class ReturnReasons\n{\n\n    public static string a { get { return \"Grund nicht erfasst\"; } }\n    public static string a1 { get { return \"Artikel mangelhaft\"; } }\n    public static string a2 { get { return \"Bestellirrtum Kunde\"; } }\n    public static string a3 { get { return \"Doppelbestellung Kunde\"; } }\n    public static string a4 { get { return \"AV Kunde\"; } }\n    public static string a5 { get { return \"Kundenadresse falsch\"; } }\n    public static string a6 { get { return \"Kunde nicht erreichbar\"; } }\n    public static string a7 { get { return \"Kundenstorno\"; } }\n    public static string a8 { get { return \"Nichtgefallen\"; } }\n    public static string a9 { get { return \"Transportschaden UPS/DHL/GLS\"; } }\n    public static string a10 { get { return \"Transportschaden Spedition\"; } }\n    public static string a11 { get { return \"Transportschaden verdeckt\"; } }\n    public static string a12 { get { return \"Kommissionierungsfehler\"; } }\n    public static string a13 { get { return \"Fehler Auftragserfasung\"; } }\n    public static string a14 { get { return \"Lieferverzgerung\"; } }\n    public static string a15 { get { return \"Warenrcksendung lt. Vereinbarung\"; } }\n    public static string a16 { get { return \"ohne Grund/sonstiges\"; } }\n}\n\n        public class RetourenPivot\n    {\n        public string Item{ get; set; }\n        public IEnumerable&lt;int?&gt; ReturnReason{ get; set; }\n        public IEnumerable&lt;decimal?&gt; Qty{ get; set; }\n    }\n\n        private void DG_databind()\n    {\n        var query = _data.RepositoryRetouren.GetAll&lt;ReturnQty&gt;();\n        // A Linq to EF which creates a List of concreate class called RetourenPivot.\n        var queryResults = (from iso in query\n                            orderby iso.ItemNo ascending\n                            group iso by iso.ItemNo into isoGroup\n                            select new RetourenPivot()\n                            {\n                                Item = isoGroup.Key,\n                                ReturnReason = isoGroup.Select(y =&gt; y.Return.ReturnReason),\n                                Qty = isoGroup.Select(v =&gt; v.Qty)\n                            }).ToList();\n\n\n        // Call a function to create a dynamically created data table with the needed columns\n\n        // Create a DataTable as a DataSource for the grid\n        DataTable dt = new DataTable();\n        // Create the DataColumns for the data table\n        DataColumn dc = new DataColumn(\"Artikel\", typeof(string));\n        dt.Columns.Add(dc);\n\n        // Get a list of Distinct Reasons\n        var ReasonLabel = (from yList in queryResults.Select(Reason =&gt; Reason.ReturnReason)\n                           from Reason in yList\n                           select Reason.ToString()).Distinct().ToList();\n\n        // Create the DataColumns for the table\n        ReasonLabel.ForEach(delegate(string Reason)\n        {\n            var reasonTexts = typeof(ReturnReasons).GetProperties().Where(p =&gt; p.Name == \"a\" + Reason).ToList()[0].GetValue(null, null).ToString();\n            dc = new DataColumn(reasonTexts, typeof(string));\n            dt.Columns.Add(dc);\n        });\n\n        // Populate the rowa of the DataTable\n        foreach (RetourenPivot rec in queryResults)\n        {\n            // The first two columns of the row always has a ISO Code and Description\n            DataRow dr = dt.NewRow();\n            dr[0] = rec.Item;\n\n            // For each record\n            var Reason = rec.ReturnReason.ToList();\n            var Qty = rec.Qty.ToList();\n\n            // Because each row may have different reasons I am indexing\n            // the with the string name\n            for (int i = 0; i &lt; Qty.Count; i++)\n            {\n                var reasonTexts = typeof(ReturnReasons).GetProperties().Where(p =&gt; p.Name == \"a\" + Reason[i].ToString()).ToList()[0].GetValue(null, null).ToString();\n                dr[reasonTexts] = Qty[i].Value;\n            }\n\n            // Add the DataRow to the DataTable\n            dt.Rows.Add(dr);\n        }\n\n        // Bind the DataTable to the DataGridView\n        dataGridViewSummary1.ColumnHeadersHeightSizeMode = DataGridViewColumnHeadersHeightSizeMode.EnableResizing;\n        dataGridViewSummary1.ColumnHeadersHeight = 200;\n\n        //Connect Grid with DataSource\n        //this.dataGridViewSummary1.AutoGenerateColumns = true;\n        this.dataGridViewSummary1.DataSource = dt;\n    }\n</code></pre>\n\n<p>The problem is, that each RetourenPivot in queryResults might have several quantities with the same ReturnReason and I dont know how to sum them up.\nE.g. now it looks like</p>\n\n<p>Item 123\nReturnReason {0, 0, 0, 0, 1, 16}\nQty {1, 1, 2, 1, 5, 1}</p>\n\n<p>What means, that for the reason 0 there are 4 quantities. It should look like</p>\n\n<p>Item 123\nReturnReason { 0, 1, 16}\nQty {5, 5, 1}</p>\n"},{"tags":["c#","linq","list"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13106052,"title":"LINQ: A better way to grouping a list of objects by multiple properties in to a list of lists?","body":"<p>I have a list of objects as such:</p>\n\n<pre><code>var cmps = new List&lt;Campaign&gt;()\n{\n    new Campaign(){ PersonId = 1, Id = 1, Name = \"Name\"},\n    new Campaign(){ PersonId = 2, Id = 1, Name = \"Name\"},\n    new Campaign(){ PersonId = 3, Id = 1, Name = \"Name1\"},                \n    new Campaign(){ PersonId = 4, Id = 2, Name = \"Name1\"},                \n    new Campaign(){ PersonId = 5, Id = 2, Name = \"Name1\"},\n    new Campaign(){ PersonId = 6, Id = 3, Name = \"Name\"},\n};\n</code></pre>\n\n<p>I want to group them into a list of lists by the multiple properties, in this example by <code>Id</code> and <code>Name</code>.</p>\n\n<p>This would split the original list into the following (where the number represents <code>PersonId</code>):</p>\n\n<p>{[1, 2], [3], [4, 5], [6]}</p>\n\n<p>I have solved this by writing the following code:</p>\n\n<pre><code>List&lt;List&lt;Campaign&gt;&gt; groups = cmps.GroupBy(c =&gt; new { c.Id, c.Name })\n                                  .Select(c =&gt; c.Key)\n                                  .ToList()\n                                  .Select(v =&gt; cmps.Where(c =&gt; c.Id == v.Id &amp;&amp; c.Name == v.Name).ToList())\n                                  .ToList();\n</code></pre>\n\n<p>This solution seems to be working fine, but out of curiosity, is there a nicer/better way to do this? </p>\n"},{"tags":["linq","nhibernate","fluent","any"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":462,"score":0,"question_id":7442876,"title":"fluent nhibernate: querying Many-to-many entity with equivalent of the 'any' keyword","body":"<p>I have a mant-to-many relationship modeled in the database (with a bridge table) between Student and Professor (_students_selected) , in my entites i have modeled it as a many-to-many relationship i.e. a Professor has many Students.</p>\n\n<pre><code>HasManyToMany(x =&gt; x.Students)\n   .Table(\"_students_selected\").ChildKeyColumn(\"student_key\").ParentKeyColumn(\"professor_key\");\n\npublic class Professor    \n{\n        private IList&lt;Students&gt; _students;\n        public virtual Student Students\n        {\n            get { return _students; }\n            set { _students = value; }\n        }\n}\n</code></pre>\n\n<p>I am unable to query over the professors students, i have tried the following however nhibernate does not recognise Any to filter through the list. Whats the equivalent to any?</p>\n\n<pre><code>_unitOfWork.Session.QueryOver&lt;Professor&gt;()\n   .Where(x =&gt; x.Students.Any(i =&gt; i.Id.IsIn(childStudentList))).List();\n</code></pre>\n"},{"tags":["c#","sql-server","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13099329,"title":"Filling Drop down list based on name","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13090398/avoid-duplicate-names-in-a-dataset\">Avoid duplicate names in a dataset</a>  </p>\n</blockquote>\n\n\n\n<p>I am fetching data from a table and binding to a label and Drop down in a gridview but i want to filter the duplicate names from the table and assign the corresponding dates to the DDL how can do this? or else is there any other alternative?</p>\n\n<p>How to bind the DDL based on label name??</p>\n\n<p><img src=\"http://i.stack.imgur.com/kExj4.png\" alt=\"enter image description here\"></p>\n"},{"tags":["linq","linq-to-sql"],"answer_count":13,"favorite_count":12,"up_vote_count":62,"down_vote_count":0,"view_count":41161,"score":62,"question_id":341264,"title":"LINQ: Max or Default?","body":"<p>What is the best way to get the Max value from a LINQ query that may return no rows? If I just do</p>\n\n<pre><code>Dim x = (From y In context.MyTable _\n         Where y.MyField = value _\n         Select y.MyCounter).Max\n</code></pre>\n\n<p>I get an error when the query returns no rows. I could do</p>\n\n<pre><code>Dim x = (From y In context.MyTable _\n         Where y.MyField = value _\n         Select y.MyCounter _\n         Order By MyCounter Descending).FirstOrDefault\n</code></pre>\n\n<p>but that feels a little obtuse for such a simple request. Am I missing a better way to do it?</p>\n\n<p>UPDATE: Here's the back story: I'm trying to retrieve the next eligibility counter from a child table (legacy system, don't get me started...). The first eligibility row for each patient is always 1, the second is 2, etc. (obviously this is not the primary key of the child table). So, I'm selecting the max existing counter value for a patient, and then adding 1 to it to create a new row. When there are no existing child values, I need the query to return 0 (so adding 1 will give me a counter value of 1). Note that I don't want to rely on the raw count of child rows, in case the legacy app introduces gaps in the counter values (possible). My bad for trying to make the question too generic.</p>\n"},{"tags":["c#","linq","datatable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":79,"score":0,"question_id":13102673,"title":"How to filter DataTable with LINQ","body":"<p>I have <code>DataTable</code> which brings me following data from database.</p>\n\n<ul>\n<li><code>Name</code></li>\n<li><code>Address</code></li>\n<li><code>CountryID</code></li>\n</ul>\n\n<p>I want to filter the dataon my side by LINQ: I have a checkbox list which has countries with IDs 1, 2, 3, 4. I want to get only results of the countries that are checked. e.g. 1, 2, 4 as CountryID by LINQ. And I want to bind that to grid view.</p>\n\n<p>I am using the following code:</p>\n\n<pre><code>foreach (ListItem cBox in chkGodownlst.Items)\n{ \n    if (cBox.Selected)\n    {\n        var a = dt.AsEnumerable()\n                  .Where(r =&gt; r.Field&lt;int&gt;(\"CountryID\") == Convert.ToInt32(cBox.Value));\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13102143,"title":"Alternative to Linq Average method in C#","body":"<p>I would like to know an alternative way to write this code without using a Linq Method Average(). </p>\n\n<pre><code>   double[] array1 = { 1, 2, 3, 5, 0 };\n        double average1 = array1.Average();\n        Console.WriteLine(average1);\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","linq","mvc","many-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13100062,"title":"LINQ Intersect Query for Many to Many relationship using .NET4 MVC4 Code First","body":"<p>In .NET4 MVC 4 using Code First I have two classes that form a many to many relationship.\nHow can I write a simple LINQ query to find all Games that have at least one or more genres from a given list of genres? (i.e. Retreive all games that are of the Strategy and/or Sandbox genre)</p>\n\n<pre><code>public class Game\n{\n    public int ID { get; set; }\n    public virtual ICollection&lt;Genre&gt; Genres { get; set; }\n}\n\npublic class Genre\n{\n    public int ID { get; set; }\n    public virtual ICollection&lt;Game&gt; Games { get; set; }\n}\n</code></pre>\n\n<p>Please note that I am using Code First so I have no access to the abstracted join table GenreGames.</p>\n\n<p>I have tried the following to find a game that contains at least one genre ID from the array gid:</p>\n\n<pre><code>var gid = new int[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\nvar result = from g in unitOfWork.GameRepository.dbSet\n             where (\n                 from gen in unitOfWork.GenreRepository.dbSet\n                 where gid.Contains(gen.ID)\n                 select gen.ID\n             ).Any()\n             select g;\n</code></pre>\n\n<p>When retrieving the results</p>\n\n<pre><code>List&lt;Game&gt; similiarGames = result.ToList&lt;Game&gt;();\n</code></pre>\n\n<p>the following error comes up. </p>\n\n<blockquote>\n  <p>Unable to create a constant value of type 'GratifyGaming.Domain.Models.Genre'. Only primitive types or enumeration types are supported in this context.</p>\n</blockquote>\n\n<p>How can I get the results I want using only primitive or enumeration types? Is there a workaround?</p>\n"},{"tags":["ajax","json","linq","asp.net-mvc-4","kendo-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13090371,"title":"The specified type member is not supported in LINQ to Entities. using JSON, KendoUI, AJAX","body":"<p>Hi everyone thanks for the time to help me out.</p>\n\n<p>I'm testing KendoUI and I'm try to binding a Grid using AJAX but i get the error</p>\n\n<pre><code>The specified type member 'getFullName' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported.\n</code></pre>\n\n<p>My Models looks like this</p>\n\n<p><strong>Proyectos Model</strong></p>\n\n<pre><code>public class Proyecto\n{\n\n    [Required]\n    [Key]\n    [Display(Name = \"Num. Proyecto\")]\n    public virtual String ProyectoID { get; set; }\n\n    [Required]\n    [Display(Name = \"ID Usuario\")]\n    public virtual int UserID { get; set; }\n\n    [Required]\n    [DisplayFormat(DataFormatString = \"{0:d}\", ApplyFormatInEditMode = true)]\n    [Display(Name = \"Fecha De Inicio\")]\n    public virtual DateTime FechaInicio { get; set; }\n\n    [Required]\n    [DisplayFormat(DataFormatString = \"{0:d}\", ApplyFormatInEditMode = true)]\n    [Display(Name = \"Fecha de Fin\")]\n    public virtual DateTime FechaFin { get; set; }\n\n    [Display(Name = \"Descripcion\")]\n    public virtual String Descripcion { get; set; }\n\n    [Required]\n    [Display(Name = \"Status\")]\n    public virtual int StatusID { get; set; }\n\n\n    public virtual ICollection&lt;Comentario&gt; Comentarios { get; set; }\n    public virtual ICollection&lt;Abono&gt; Abonos{ get; set; }\n    public virtual ICollection&lt;Cargo&gt; Cargos{ get; set; }\n    public virtual ICollection&lt;Status&gt; Status { get; set; }\n    public virtual Usuario Usuario { get; set; }\n\n}\n</code></pre>\n\n<p><strong>Usuario Model</strong></p>\n\n<pre><code>    public class Usuario\n{\n    [Required]\n    [Key]\n    [Display(Name = \"Id\")]\n    public virtual int UserID { get; set; }\n\n    [Required]\n    [Display(Name = \"Usuario\")]\n    public virtual String UserName { get; set; }\n\n    [Required]\n    [Display(Name = \"Password\")]\n    public virtual String Password{ get; set; }\n\n    [Required]\n    [Display(Name = \"Nombre\")]\n    public virtual String Nombre { get; set; }\n\n    [Display(Name = \"Apellidos\")]\n    public virtual String Apellidos{ get; set; }\n\n    [Display(Name = \"Email\")]\n    public virtual String Email { get; set; }\n\n    [Required]\n    [Display(Name = \"Nivel\")]\n    public virtual int Nivel { get; set; }\n\n    public virtual ICollection&lt;Proyecto&gt; Proyectos { get; set; }\n    public virtual ICollection&lt;Comentario&gt; Comentarios { get; set; }\n\n    [Display (Name=\"Responsable\")]\n    public virtual string getFullName\n    {\n        get {\n            return Nombre + \" \" + Apellidos;\n        }\n\n    }\n\n}\n</code></pre>\n\n<p>In the Proyecto Controller i have this method (where the error happens)</p>\n\n<pre><code> public ActionResult Proyectos_Read([DataSourceRequest]DataSourceRequest request)\n    {\n        db.Configuration.ProxyCreationEnabled = false;\n        var proyectos = from e in db.Proyectos.Include(c =&gt; c.Usuario) select e;\n\n\n        DataSourceResult result = proyectos.ToDataSourceResult(request, o =&gt; new\n        {\n            ProyectoID = o.ProyectoID,\n            OCCliente = o.OCCliente,\n            FullName = o.Usuario.getFullName,\n            Descripcion = o.Descripcion\n        });\n\n\n\n        return Json(result, JsonRequestBehavior.AllowGet);\n    }\n</code></pre>\n\n<p>and finally this is my View</p>\n\n<pre><code>  @(Html.Kendo().Grid&lt;NTSMvc.Models.Proyecto&gt;()\n                         .Name(\"Grid\")\n                         .Columns(columns =&gt;\n                             {\n                                 columns.Bound(p =&gt; p.ProyectoID).Filterable(true).Groupable(true);\n                                 columns.Bound(p =&gt; p.OCCliente);\n                                 columns.Bound(p =&gt; p.Usuario.getFullName);\n                                 columns.Bound(p =&gt; p.Descripcion);\n                             })\n                             .DataSource( datasource =&gt; datasource\n                                 .Ajax()\n                                 .Read(read =&gt; read.Action(\"Proyectos_Read\",\"Proyectos\"))\n                                 .PageSize(5)\n                             )\n                             .Filterable() \n                             .Groupable()                               \n                             .Pageable()                                   \n                     )            \n</code></pre>\n\n<p>How i need to change my linq query or my model to get the full name in the grid</p>\n\n<p>Thanks again for the time.</p>\n\n<p>Regards</p>\n"},{"tags":["asp.net-mvc","linq","asp.net-web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13100337,"title":"How to return only particular fields to list using LINQ lamda expressions","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8973529/retrieve-an-object-from-entityframework-without-one-field\">Retrieve an object from entityframework without ONE field</a>  </p>\n</blockquote>\n\n\n\n<p>I am working on asp.net mvc. currently i am using EF 4.1 code first model. Here i have list of records(43). My class is like,</p>\n\n<pre><code>public class MyTable\n{\npublic string field1{get; set;}\npublic string field2{get; set;}\n.\n.\n.\npublic string field20{get; set;}\n} \n</code></pre>\n\n<p>and i am returning them as a list like List. But i dont want the field20 to return. so how could i skip particular field in my list. I have used like,</p>\n\n<pre><code>(from m in context.MyTable select new{m.field1,m.field2,...,m.field19}).ToList(); \n</code></pre>\n\n<p>Its working very fine. but i want same result using lamda expression syntax like</p>\n\n<pre><code>context.MyTable.Skip() or any etc.\n</code></pre>\n\n<p>How to return only particular fields to list.please guide me.</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13099230,"title":"Using ternary operation without else in linq?","body":"<p>I need to know how do i use ternary operator without else. In the example I need to check 2 criterias <code>(cityId != null) &amp;&amp; (cityId != 0)</code>. I cannot use normal if conditions. So if it doesn't happen i want to list all titles. I don't want to show else condition is <code>x.ProvinceId == 15</code></p>\n\n<pre><code>public JsonResult mt(int? cityId)\n        {\n            var getCities = locationRepository.Get(null).Where(x =&gt; ( (cityId != null) &amp;&amp; (cityId != 0) ? x.ProvinceId == cityId : x.ProvinceId == 15  )).Select(x=&gt;x.Title);\n\n            return Json(new { items = getCities }, JsonRequestBehavior.AllowGet);\n        }\n</code></pre>\n"},{"tags":["vb.net","linq","group-by","sum","ienumerable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13098889,"title":"LINQ Group by and Sum syntax","body":"<p>i have the following vb.net LINQ Query</p>\n\n<pre><code>Dim q = From row In dx.AsEnumerable\n                Group row By G = New With {.Cat = row.Field(Of Integer)(\"catalogid\")}.Cat,\n                                 New With {.Backorder = row.Field(Of Integer)(\"backorder\")}.Backorder Into pg = Group\n                Select New With\n                       {\n                           .Cat = pg.Cat,\n                           .Backorder = pg.Sum(Function(x) x.Backorder)\n                       }\n</code></pre>\n\n<p>i have this datatable called dx</p>\n\n<pre><code>catalogid      backorder\n1              5\n1              10\n2              1\n2              5\n</code></pre>\n\n<p>i want to <code>Sum</code> <code>backorder</code> column where <code>catalogid</code> is the same so the result is the following</p>\n\n<pre><code>catalogid      backorder\n1              15\n2              6\n</code></pre>\n\n<p>in the Select new with part, what is wrong?</p>\n"},{"tags":["c#","linq","mongodb","lambda","mongodb-csharp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13078809,"title":"InvalidCastException: ConstantExpression to LambdaExpression in MongoDB Driver","body":"<p>How can I wrap this into a reusable expression that I can use elsewhere in my code?</p>\n\n<pre><code>nv =&gt; nv.a == nv2.a\n</code></pre>\n\n<p>I've tried doing this, but seems to return a <code>ConstantExpression</code> rather than a <code>LambdaExpression</code>.</p>\n\n<pre><code>public Func&lt;EntityName, bool&gt; compareExpression()\n{\n    return nv =&gt; nv.a == this.a;\n}\n</code></pre>\n\n<p>I don't mind exactly how I do this, as long as I can have a LambdaExpression that I can use in more than one place in the code. The DB driver will be reading the expression and converting it.</p>\n\n<p><strong>More Detail</strong></p>\n\n<p>Given this;</p>\n\n<pre><code>db.p.insert(\n  {\n    arrayNest: [\n      { a:1, b:10 },\n      { a:2, b:20 },\n      { a:3, b:30 },\n      { a:4, b:40 },\n]\n  }\n);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class NV {\n    int a;\n    int b;\n    public Func&lt;EntityName, bool&gt; compareExpression()\n    {\n        return nv =&gt; nv.a == this.a;\n    }\n}\nclass P {\n     NV[] arrayNest;\n}\n</code></pre>\n\n<p>And a methods;</p>\n\n<pre><code>    public virtual void Delete(Expression&lt;Func&lt;T, bool&gt;&gt; criteria)\n    {\n        this.Collection.Remove(Query&lt;T&gt;.Where(criteria));\n    }\n\n    var nv2 = new NV();\n    Delete(p =&gt; p.arrayNest.Any(nv =&gt; nv.a == nv2.a)); // Works fine\n</code></pre>\n\n<p>However, when I use the lambda from function that returns an expression;</p>\n\n<pre><code>    Delete(p =&gt; p.arrayNest.Any(nv =&gt; nv2.compareExpression())); // FAILS\n</code></pre>\n\n<p>I get a </p>\n\n<pre><code> System.InvalidCastException: Unable to cast object of type 'System.Linq.Expressions.ConstantExpression' to type 'System.Linq.Expressions.LambdaExpression'.\n\n Result StackTrace: \n  at MongoDB.Driver.Linq.PredicateTranslator.BuildAnyQuery(MethodCallExpression methodCallExpression)  \n</code></pre>\n\n<p>I see that <code>MongoDB.Driver.Linq.PredicateTranslator</code> assumes that every expression is a <code>(LambdaExpression)</code>.</p>\n\n<p>So is this a driver issue, or am I doing something else wrong? \nWhat's wierd is I don't understand why it's evaluating to a ConstantExpression at all.</p>\n"},{"tags":["c#","asp.net-mvc","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13098262,"title":"Using Find() with inheritance in entity frameowrk","body":"<p>I am trying to find a User entity in my \"Domain Entity\" DB Set.\nThe User entity is derived from a base type called Domain Entity.</p>\n\n<p>I want to use the following to find a user according to his ID</p>\n\n<pre><code>User userToDelte = db.DomainEntities.OfType&lt;User&gt;().Find(UserID);\n</code></pre>\n\n<p>But I get a compiler error :</p>\n\n<blockquote>\n  <p>'System.Linq.IQueryable' does not\n  contain a definition for 'Find' and no extension method 'Find'\n  accepting a first argument of type...</p>\n</blockquote>\n\n<p>Why can't I use <code>Find()</code> after I have used <code>OfType&lt;User&gt;()</code> ?</p>\n\n<p>P.S\nIt is important for me to get a strongly typed User entity because it has a navigation propertiy that include all of it's details in a separate table called \"UserDetails\" along with the user name and password.</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13098232,"title":"Taking Dictionary output from Linq statement","body":"<p>This is my entity collection.</p>\n\n<pre><code>Dictionary&lt;string, List&lt;Dictionary&lt;string, string&gt;&gt;&gt; EntityCollection = new Dictionary&lt;string, List&lt;Dictionary&lt;string, string&gt;&gt;&gt;();\n</code></pre>\n\n<p>When I receive value in <code>EntityCollection</code>, I want to filter it.</p>\n\n<pre><code>var filtered = from entity in EntityCollection\n                       where entity.Key == entityId\n                       select entity.Value;\n</code></pre>\n\n<p>Now I want only <code>entity.value</code>.\nSo I created a variable:</p>\n\n<pre><code>List&lt;Dictionary&lt;string, string&gt;&gt; entityDetails = new List&lt;Dictionary&lt;string, string&gt;&gt;();\n</code></pre>\n\n<p>How can I cast <code>filtered</code> to <code>entityDetails</code>?</p>\n\n<p>I tried with <code>filtered.ToList&lt;Dictionary&lt;string, string&gt;&gt;</code>, but no success.</p>\n"},{"tags":["c#","linq","linq-to-sql","lambda","expressions"],"answer_count":4,"favorite_count":14,"up_vote_count":15,"down_vote_count":0,"view_count":13086,"score":15,"question_id":567963,"title":"LINQ Expression to return Property value?","body":"<p>I'm trying to create a generic function to help me select thousands of records using LINQ to SQL from a local list.  SQL Server (2005 at least) limits queries to 2100 parameters and I'd like to select more records than that.</p>\n\n<p>Here would be a good example usage:</p>\n\n<pre><code>var some_product_numbers = new int[] { 1,2,3 ... 9999 };\n\nProducts.SelectByParameterList(some_product_numbers, p =&gt; p.ProductNumber);\n</code></pre>\n\n<p>Here is my (non-working) implementation:</p>\n\n<pre><code>public static IEnumerable&lt;T&gt; SelectByParameterList&lt;T, PropertyType&gt;(Table&lt;T&gt; items, \n\nIEnumerable&lt;PropertyType&gt; parameterList, Expression&lt;Func&lt;T, PropertyType&gt;&gt; property) where T : class\n{\n    var groups = parameterList\n    \t.Select((Parameter, index) =&gt;\n    \t\tnew\n    \t\t{\n    \t\t\tGroupID = index / 2000, //2000 parameters per request\n    \t\t\tParameter\n    \t\t}\n    \t)\n    \t.GroupBy(x =&gt; x.GroupID)\n    \t.AsEnumerable();\n\n    var results = groups\n    .Select(g =&gt; new { Group = g, Parameters = g.Select(x =&gt; x.Parameter) } )\n    .SelectMany(g =&gt; \n    \t/* THIS PART FAILS MISERABLY */\n    \titems.Where(item =&gt; g.Parameters.Contains(property.Compile()(item)))\n    );\n\n    return results;\n}\n</code></pre>\n\n<p>I have seen plenty of examples of building predicates using expressions.  In this case I only want to execute the delegate to return the value of the current ProductNumber.  Or rather, I want to translate this into the SQL query (it works fine in non-generic form).</p>\n\n<p>I know that compiling the Expression just takes me back to square one (passing in the delegate as Func) but I'm unsure of how to pass a parameter to an \"uncompiled\" expression.</p>\n\n<p>Thanks for your help!</p>\n\n<p><strong>** EDIT:</strong> Let me clarify further:</p>\n\n<p>Here is a working example of what I want to generalize:</p>\n\n<pre><code>var local_refill_ids = Refills.Select(r =&gt; r.Id).Take(20).ToArray();\n\nvar groups = local_refill_ids\n\t.Select((Parameter, index) =&gt;\n\t\tnew\n\t\t{\n\t\t\tGroupID = index / 5, //5 parameters per request\n\t\t\tParameter\n\t\t}\n\t)\n\t.GroupBy(x =&gt; x.GroupID)\n\t.AsEnumerable();\n\nvar results = groups\n.Select(g =&gt; new { Group = g, Parameters = g.Select(x =&gt; x.Parameter) } )\n.SelectMany(g =&gt; \n\tRefills.Where(r =&gt; g.Parameters.Contains(r.Id))\n)\n.ToArray()\n;\n</code></pre>\n\n<p>Results in this SQL code:</p>\n\n<pre><code>SELECT [t0].[Id], ... [t0].[Version]\nFROM [Refill] AS [t0]\nWHERE [t0].[Id] IN (@p0, @p1, @p2, @p3, @p4)\n\n... That query 4 more times (20 / 5 = 4)\n</code></pre>\n"},{"tags":["c#","linq","datetime","linq-to-entities","datetime-comparison"],"answer_count":10,"favorite_count":1,"up_vote_count":16,"down_vote_count":0,"view_count":38310,"score":16,"question_id":1088212,"title":"How do I perform Date Comparison in EF query?","body":"<p>Please help.\nI am trying to figure out how to use DATE or DATETIME for comparison in a linq query.</p>\n\n<p>Example:\nIf I wanted all Employee names for those who started before today, I would do something like this in SQL:</p>\n\n<pre><code>SELECT EmployeeNameColumn\nFROM EmployeeTable\nWHERE StartDateColumn.Date &lt;= GETDATE() //Today\n</code></pre>\n\n<p>But what about linq?</p>\n\n<pre><code>DateTime startDT = //Today\n\nvar EmployeeName =  \nfrom e in db.employee\nwhere e.StartDateColumn &lt;= startDT \n</code></pre>\n\n<p>The above WHERE doesn't work: </p>\n\n<blockquote>\n  <p>Exception Details: System.NotSupportedException: The specified type member 'Date' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported.</p>\n</blockquote>\n"},{"tags":["sql","asp.net-mvc","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13096058,"title":"Joining two tables in linq method syntax, MVC EntityFramework","body":"<p>I'm working with two tables: CI_CLIENTRISK (SCD type 2)... and QB_INVOICES_HEADER (<a href=\"http://i47.tinypic.com/x42c69.png\" rel=\"nofollow\">edmx screenshot</a>).</p>\n\n<p>They can be joined via ClientID.  I want to essentially replicate this query:</p>\n\n<pre><code>SELECT a.ClientID,\n    MAX(b.InvoiceDt) AS MaxInvoiceDt\n    (omitted for brevity)\nFROM CI_CLIENTRISKADJS a\nINNER JOIN QB_INVOICES_HEADER b\nON a.ClientID = b.ClientID\nWHERE a.IsActive = 1\nGROUP BY a.ClientID\nORDER BY MaxInvoiceDt DESC\n</code></pre>\n\n<p>Here's what I have so far.  It's not returning any records.</p>\n\n<pre><code>using (var db = new PLOGITENS01Entities())\n        {\n        var rvClientRiskAdjs = db.CI_CLIENTRISKADJS\n            .Take(50)\n            .Join(db.QB_INVOICES_HEADER,\n                a =&gt; a.ClientID,\n                b =&gt; b.ClientID,\n                (a, b) =&gt; new { Risk = a, Invoices = b })\n            .Where(a =&gt; a.Risk.IsActive == 1)\n            .OrderByDescending(o =&gt; o.Invoices.InvoiceDt)\n            .Select(c =&gt; new ClientRiskModel()\n            {\n                ClientRiskId = c.Risk.ClientRiskID,\n                ClientName = c.Risk.CI_CLIENTLIST.ClientName,\n                ClientId = c.Risk.ClientID,\n                ClientRiskAdjs = c.Risk.ClientRiskAdjs,\n                RecordValidStartDt = c.Risk.RecordValidStartDt,\n                RecordValidEnddt = c.Risk.RecordValidEnddt,\n                IsActive = c.Risk.IsActive\n            })\n            .ToList();\n\n        return View(new GridModel(rvClientRiskAdjs));\n        }\n</code></pre>\n"},{"tags":["c#","linq","asp.net-mvc-2","generics","expressions"],"answer_count":5,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":4156,"score":9,"question_id":4969321,"title":"The type arguments cannot be inferred from the usage. Try specifying the type arguments explicitly","body":"<p>Could someone please clarify something for me. In my asp.net mvc 2 app, I've got a BaseViewModel class which includes the following method: </p>\n\n<pre><code>public virtual IDictionary&lt;string, object&gt; GetHtmlAttributes&lt;TModel, TProperty&gt;(Expression&lt;Func&lt;TModel, TProperty&gt;&gt; propertyExpression)\n{\n    return new Dictionary&lt;string, object&gt;();\n}\n</code></pre>\n\n<p>The idea being that each child viewmodel can override this method and provide a suitable set of html attributes, based on some logic, to be rendered in the view:</p>\n\n<pre><code>&lt;%: Html.TextBoxFor(model =&gt; model.MyProperty, Model.GetHtmlAttributes(model =&gt; model.MyProperty)) %&gt;\n</code></pre>\n\n<p>However when used as in the line above, I get a compilation error when I hit the view:</p>\n\n<blockquote>\n  <p>The type arguments for method '<code>...BaseViewModel.GetHtmlAttributes&lt;TModel,TProperty&gt; Expression&lt;System.Func&lt;TModel,TProperty&gt;)</code>' cannot be inferred from the usage. Try specifying the type arguments explicitly.</p>\n</blockquote>\n\n<p>I have to do the following:</p>\n\n<pre><code>&lt;%: Html.TextBoxFor(model =&gt; model.MyProperty, Model.GetHtmlAttributes&lt;ChildModel, string&gt;(model =&gt; model.MyProperty)) %&gt;\n</code></pre>\n\n<p>I'm just looking for some clarity as to how it tries to infer the type, it has no problem doing so in the HtmlHelper/TextBoxFor extension method? </p>\n\n<p>Is it because HtmlHelper in the view will automatically be for the same type as is specified in the ViewUserControl at the top of the page, whereas my code can be for any type inheriting from BaseViewModel? Is is possible to write this in such a way that it can infer my model/property types?</p>\n\n<p>Thanks for any light shed on the matter :)</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13095299,"title":"How can I check the type of an object against a list of types?","body":"<p>Given a collection </p>\n\n<pre><code>IEnumerable&lt;Type&gt; supportedTypes\n</code></pre>\n\n<p>What's the best way to check whether a given object is one of those types (or a derived type)?</p>\n\n<p>My first instinct was to do something like:</p>\n\n<pre><code>// object target is a parameter passed to the method in which I'm doing this.\nif (supportedTypes.Count( supportedType =&gt; target is supportedType ) &gt; 0)\n{\n    // Yay my object is of a supported type!!!\n}\n</code></pre>\n\n<p>..but that doesn't seem to be working.  Can I not use the \"is\" keyword in a lambda expression like this?</p>\n"},{"tags":["linq","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13094677,"title":"The type arguments cannot be inferred from the query","body":"<p>my linq query works, I tested in the linqpad, got result back. the error happened at the last step, when I try to use EntityVM ViewModel.  I dont really understand what this error message means. can someone please explain that to me, and show me how to fix it. thank you.</p>\n\n<p><strong>Error Message: \"the type arguments cannot be inferred from the query\"</strong></p>\n\n<pre><code>        var entityVersions = EntityVersionRepository.Get().Where(x =&gt; x.Entity.ClientId == clientId);\n\n\n        var groups = from ev in entityVersions\n                     group ev by ev.EntityId\n                         into g\n                         select g.OrderByDescending(x =&gt; x.TaxYear).FirstOrDefault();\n\n        var result = from g in groups\n                     select (en =&gt; new EntityVM\n                                       {\n                                           Name = en.EntityName,\n                                           Id = en.EntityId  \n                                       });\n</code></pre>\n"},{"tags":["c#",".net","performance","linq"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":131,"score":0,"question_id":13087328,"title":"Are there some disadvantages in using a lot of LINQ to Objects statements?","body":"<p>I come from Java programming and switching to C# programming I discovered the extreme powerful of LINQ.</p>\n\n<p>In my recent implementation I noticed that I use it (expecially LINQ to Objects) very often in my code to avoid <code>foreach</code> loops, to search elements in lists and for similar tasks.</p>\n\n<p>Now I'm wondering if there is some performance disadvantage in massively use Linq to Objects...</p>\n"},{"tags":["vb.net","linq","dbnull"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13094369,"title":"LINQ vb.net Not IsDBNull","body":"<p>I have the following query that is supposed to filter out null values in the given groupfield but unfortunately returns an empty object when the source dataset contains null values in that field:</p>\n\n<pre><code>Dim SelectQuery = From q1 In loadedData.data.AsEnumerable\n                  Order By q1(aGroupField)\n                  Where Not IsDBNull(q1(aGroupField)) \n                        AndAlso q1(aGroupField) &lt;&gt; \"\"\n                  Select New With {.groupField = q1(aGroupField)}\n</code></pre>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":677,"score":1,"question_id":1536925,"title":"Usinq Linq to select items that is in a semi-comma separated string?","body":"<p>I have a string with semi-comma separated names:</p>\n\n<pre><code>string names = \"Jane;Harry\";\n</code></pre>\n\n<p>I also have a list of customer objects:</p>\n\n<pre><code>public class Customer\n{\n  public string FirstName { get; set; }\n  public string LastName { get; set; }\n}\n\nList&lt;Customer&gt; customers = new List&lt;Customer&gt;();\ncustomers.Add(new Customer(){FirstName=\"John\", LastName=\"Doe\"});\ncustomers.Add(new Customer(){FirstName=\"Jane\", LastName=\"Doe\"});\ncustomers.Add(new Customer(){FirstName=\"Harry\", LastName=\"Potter\"});\n\nvar query = from c in customers\n            select c;\n</code></pre>\n\n<p>How do I create a query that returns only those customers that has a first name that is in the semi-comma separated list?</p>\n\n<p>Something like the T-SQL <code>SELECT FistName FROM customer WHERE FirstName IN (list)</code>\n(sort of)</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":72,"score":-1,"question_id":13093533,"title":"LINQ Group by error: \"does not contain a definition for 'GroupBy'\"","body":"<p>I have a List that I need to group by. In the list I add this object:</p>\n\n<pre><code>private class MyObject {\n\n        private System.Drawing.Color color;\n        private string title;            \n\n        public MyObject(System.Drawing.Color color, string title)\n        {\n            this.color = color;\n            this.title = title;\n        }\n\n        public string Title\n        {\n            get { return title; }\n            set { title = value; }\n        }\n\n        public System.Drawing.Color Color\n        {\n            get { return color; }\n            set { color = value; }\n        }\n\n}\n</code></pre>\n\n<p>I create my List as:</p>\n\n<pre><code>System.Collections.Generic.List&lt;MyObject&gt; mList = new       System.Collections.Generic.List&lt;MyObject &gt;();\n</code></pre>\n\n<p>Then I try to group the content:</p>\n\n<pre><code>var groupedList = mList.GroupBy(c =&gt; new {c.Title} ).ToList();\n</code></pre>\n\n<p>And that is when I get the error. Any ideas? How can I do this?\nThanks!</p>\n"},{"tags":["c#",".net","linq","lambda","lambda-functions"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":106,"score":5,"question_id":13043663,"title":"Get Value and Count of that value using LINQ or lambda expression","body":"<p>A list of data object in the below format  </p>\n\n<pre><code>Col1  Col2  Col3\n\nB     45    36    \nB     12    69   \nA     46    76    \nC     89    09    \nB     451   37   \nD     435   46   \nA     450   50   \nD     98    43   \nB     358   39\nA     987   89\n</code></pre>\n\n<p>Need to get result set like following format ( 'A' occurred 3 times ,'B' occurred 4 times etc.) </p>\n\n<pre><code>Value  Count\n\nA      3   \nB      4  \nC      1    \nD      2\n</code></pre>\n\n<p>How to get result set like above using LINQ or lambda expressions?</p>\n"},{"tags":["c#","asp.net-mvc","linq","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13092098,"title":"Translate SQL query to LINQ (subqueries)","body":"<p>Hi have a site where users can vote on images.\nThe votes are stored in table Votes where I store the Id of the submission (FK_id)</p>\n\n<p><br />\nThe tables are:</p>\n\n<p><strong>Table Submissions</strong><br />\nId (uniqueidentifier)<br />\nName (varchar(50))<br />\nImage (varchar(50))<br /></p>\n\n<p><strong>Table Votes</strong><br />\nId (int)<br />\nFk_id (foreign key to Submissions.Id)<br /></p>\n\n<p>I'm new to linq so I don't know how to translate this:</p>\n\n<pre><code>SELECT *, \n    isnull((SELECT count(*) \n    FROM Votes\n    WHERE Fk_id = S.Id      \n    GROUP BY Fk_id),0) as Votes \nFROM Submissions S\n</code></pre>\n\n<p>I wanted something like this:</p>\n\n<pre><code>List&lt;Model&gt; = (from p in ????\n               select new Model\n               {\n                   Name = p.Name,\n                   Image = p.Image,\n                   Votes = p.Votes               \n               }).ToList();\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["linq"],"answer_count":2,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":2665,"score":8,"question_id":1938409,"title":"LINQ: How to convert the nested hierarchical object to flatten object","body":"<p>How to convert the nested hierarchical object to flatten objects by using LINQ? I know that we can easily use foreach loop to achieve that. But I'm wondering if there is a way to write it in LINQ.</p>\n\n<pre><code>class Person{\n   public int ID {get;set}\n   public string Name {get;set}\n   public List&lt;Person&gt; Children {get;}\n}\n</code></pre>\n\n<p><strong>Data :</strong></p>\n\n<pre><code>ID   : 1\n\nName : Jack\n\nChildren\n\n2 | Rose \n\n3 | Paul\n</code></pre>\n\n<p>I like to convert this data into flatten format like below. </p>\n\n<pre><code>1 | Jack \n\n2 | Rose \n\n3 | Paul\n</code></pre>\n\n<p>How can we do it with Linq?</p>\n"},{"tags":["sql-server","visual-studio","visual-studio-2008","linq","types"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1782,"score":1,"question_id":188242,"title":"Data Types supported in visual studio 2008","body":"<p>I just downloaded and installed the latest Adventure Works database from <a href=\"http://www.codeplex.com/MSFTDBProdSamples/Release/ProjectReleases.aspx?ReleaseId=16040\" rel=\"nofollow\">http://www.codeplex.com/MSFTDBProdSamples/Release/ProjectReleases.aspx?ReleaseId=16040</a> to do some more playing around with LINQ and found that there are some data types that are not natively supported within Visual Studio 2008. I get the \"One or more selected items contain a data type that is not supported by the designer.\" error message. </p>\n\n<p>I found that the spatial data type is the issue in this case. </p>\n\n<p>My questions are:</p>\n\n<ul>\n<li>What other data types are not\ninherently supported by Visual\nStudio that is in SQL Serve 2008?</li>\n<li>Why are these types not supported?</li>\n</ul>\n\n<p>The second question is I guess the most puzzling to me. I can understand why not all data types would be supported from MySQL, Oracle, Postgre SQL and so forth. I would think that the SQLServer development group, might give a heads up to the Visual Studio development group, you know yell down the hall or something. </p>\n"},{"tags":["c#","linq","list"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":4020,"score":3,"question_id":3738639,"title":"Sorting a List<int>","body":"<p>Using C# what is the best way to sort a List numerically?\nmy list has items 5,7,3 and I would like them sorted 3,5,7.  I know some longer ways, but I would imagine linq has a quicker way?</p>\n\n<p>sorry this was end of day, my mind is else where it worked, didn't see it change the first time:(</p>\n"},{"tags":["c#","linq","list","foreach","count"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13090229,"title":"finding the count in two lists","body":"<p>I have two lists which I am getting from database as follow:</p>\n\n<pre><code>List&lt;myobject1&gt; frstList = ClientManager.Get_FirstList( PostCode.Text, PhoneNumber.Text);\n                List&lt;myobject2&gt; secondList = new List&lt;myobject2&gt;;\n\n                foreach (var c in frstList )\n                {\n                    secondList.Add( ClaimManager.GetSecondList(c.ID));\n                }\n</code></pre>\n\n<p>now my list will contain data like so:</p>\n\n<pre><code>frstList: id = 1, id = 2\nsecondList: id=1 parentid = 1, id=2 parentid=1 and id = 3 parentid = 2\n</code></pre>\n\n<p>I want to count these individually and return the one that has most counts? in above example it should return id=1 from frsList and id1 and id2 from secondList...</p>\n\n<p>tried this but not working </p>\n\n<pre><code>var numbers = (from c in frstList where c.Parent.ID == secondList.Select(cl=&gt; cl.ID) select c).Count();\n</code></pre>\n\n<p>can someone please help me either in linq or normal foreach to do this?</p>\n\n<p>Thanks </p>\n"},{"tags":["c#","sql-server","wpf","linq","view"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13089863,"title":"Is SQL View faster than Table while using Linq?","body":"<p>My WPF application has a lookup screen for selecting customers. The customer table contain nearly 10,000 records. Its very slow when loading and filtering records using my Linq query(I am not doing any ordering of records). Is there a way to increase speed? Heard about using indexed views. Can someone please give some ideas?</p>\n\n<pre><code>lstCustomerData = dbContext.customers.Where(c =&gt; c.Status == \"Activated\").ToList();\n            dgCustomers.ItemsSource = lstCustomerData;\n</code></pre>\n\n<p>filtering:</p>\n\n<pre><code> string searchKey = TxtCustName.Text.Trim();\n\n            var list = (from c in lstCustomerData\n                        where (c.LastName == null ? \"\" : c.LastName.ToUpper()).Contains(searchKey.ToUpper())\n                        select c).ToList();\n            if (list != null)\n                dgCustomers.ItemsSource = list;\n</code></pre>\n"},{"tags":["c#","linq","exception","ado.net"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":113,"score":2,"question_id":12537127,"title":"Unable to cast object of type 'System.Data.Objects.ObjectQuery`1 [Manager.Data.Channel]' to type 'Manager.Data.Channel'","body":"<p>In a Win7 app, I am trying to update several fields in an ADO.NET database table called \"Channel\", with an EntitySetMapping Name of \"Channels\", using EntityClient in the EF to access SqlServerCe 3.5 (IPManager_DBEntities).</p>\n\n<p>With the VS 2010 IDE, the code compiles fine and Intellisense has no complaints.  The format of the Channel datatable is referenced at the bottom as the various fields in a row (selected by Channel \"Number\") need to be updated with information passed to it from code which is not shown for the sake of simplicity.  Nothing I have Googled during the past several days has solved my Type Casting dilemma. Using LINQ, I get this RunTime Exception: </p>\n\n<blockquote>\n  <p>\"Unable to cast object of type 'System.Data.Objects.ObjectQuery`1 [Manager.Data.Channel]' to type 'Manager.Data.Channel'\".</p>\n</blockquote>\n\n<pre><code>    // Update channel status with information parsed from the data packet.\n    using (IPManager_DBEntities context = new IPManager_DBEntities())\n    {\n        Channel thisChannelRow = (Channel)(from CE\n                                             in context.Channels\n                                          where CE. Number == int.Parse(IDLine[2])\n                                         select CE);\n\n        // Throwing exception after setting up this query:\n        //   \"Unable to cast object of type 'System.Data.Objects.ObjectQuery`1\n        //   [Manager.Data.Channel]' to type 'Manager.Data.Channel'\"\n        //  During debug sessions, \"thisChannelRow\" is null as a result.\n\n        MessageBox.Show(\"thisChannelRow. Channel = \" + thisChannelRow.Number );\n\n            ThisChannel.StatusID = int.Parse(IDLine[5]);\n            ThisChannel.Cycle = int.Parse(IDLine[4]);\n            ThisChannel.Modified = DateTime.Now;\n            context.SaveChanges();\n     }\n</code></pre>\n\n<p>I hope someone has a solution to help me through this predicament.</p>\n"},{"tags":["asp.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13086989,"title":"SQL data context with inner join","body":"<p>Sorry this may be blatantly obvious but I have spent all morning trying to get this working.</p>\n\n<p>I am using ASP.net and have a data context as you can see below. What I want to do is add an inner join and use the company name as the search parameter rather than the deal description but for the life of me I cannot do this.</p>\n\n<p>What I am trying to ultimately achieve is this:</p>\n\n<pre><code>SELECT *\nFROM Deals\nINNER JOIN Companies\nON Deals.CompanyID=Companies.CompanyID\n</code></pre>\n\n<p>Can someone please help me by rewriting the below to get the same results?</p>\n\n<pre><code>MobileVocherDataContext db = new MobileVocherDataContext();\n\nList&lt;Deal&gt; dealresult= db.Deals.Where(c=&gt;c.DealDescription.ToLower().Contains(keyword.ToLower()) &amp;&amp; c.ExpiredDate.Date&gt;=DateTime.Now.Date &amp;&amp; c.Status==true).Skip(_skip).Take(_count).ToList();\nList&lt;CustomSearchresult&gt; result = new List&lt;CustomSearchresult&gt; ();\n</code></pre>\n"},{"tags":["asp.net","sql","database","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13086360,"title":"DropDownList value into Linq query where clause","body":"<p>I am facing following problem. I want a search field with a DropDowList next to it, where user can pick an item for which he wants to search. I have to make it with this LINQ code not just a SQL query.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>var Metadata = from m in db.Metadatas\n    join mm in db.Multimedias\n    on m.multimediaID equals mm.multimediaID\n    where (m.   { Here would i have the selected value from the dropdownlist. } .ToString().Contains(textboxvalue) ||\n           mm.  { Here would i have the selected value from the dropdownlist. } .ToString().Contains(textboxvalue))\n           &amp;&amp; mm.filetype.ToString().Contains(radiobuttonvalue)\n</code></pre>\n\n<p>I want to put something like: \"Dropdownlist.selectedvalue\" into the area { Here would i have the selected value from the dropdownlist. }</p>\n\n<p>I hope you guys understand my idea and problem.</p>\n"},{"tags":["c#","linq","linq-to-sql"],"answer_count":5,"favorite_count":6,"up_vote_count":8,"down_vote_count":0,"view_count":3739,"score":8,"question_id":191690,"title":"Strange LINQ Exception (Index out of bounds)","body":"<p>I have a table, we'll call <code>Users</code>. This table has a single primary key defined in SQL Server - an autoincrement <code>int ID</code>.</p>\n\n<p>Sometimes, my LINQ queries against this table fail with an <code>\"Index was outside the range\"</code> error - even the most simplest of queries. The query itself doesn't use any indexers.</p>\n\n<p>For example:  </p>\n\n<pre><code>User = Users.Take(1);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>IEnumerable&lt;Users&gt; = Users.ToList();\n</code></pre>\n\n<p>Both of the queries threw the same error. Using the debugger Visualizer to look at the generated query - I copy and paste the query in SQL and it works fine. I also click \"execute\" on the visualizer and it works fine. But executing the code by itself throws this error. I don't implement any of the partial methods on the class, so nothing is happening there. If I restart my debugger, the problem goes away, only to rear it's head again randomly a few hours later. More critically, I see this bug in my error logs from the app running in production.  </p>\n\n<p>I do a ton of LINQ in my app, against a dozen or so different entities in my database, but I only see this problem on queries related to a specific entity in my table. Some googling has suggested that this problem might be related to an incorrect relationship specified between my model and another entity, but I don't have <em>any</em> relationships with this object.  It seems to be working 95% of the time, it's just the other 5% that fail.</p>\n\n<p>I have completely deleted the object from the designer, and re-added it from a \"refreshed\" server browser, and that did not fix the problem.</p>\n\n<p>Any ideas what's going on here?</p>\n\n<p>Here's the full error message and stack trace:</p>\n\n<blockquote>\n  <p>Index was out of range. Must be non-negative and less than the size of\n  the collection. Parameter name: index at\n  System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query,\n  QueryInfo queryInfo, IObjectReaderFactory factory, Object[]\n  parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object\n  lastResult) at\n  System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query,\n  QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[]\n  userArguments, ICompiledSubQuery[] subQueries) at\n  System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression\n  query) at\n  System.Data.Linq.Table<code>1.System.Linq.IQueryProvider.Execute[TResult](Expression\n  expression) at\n  System.Linq.Queryable.FirstOrDefault[TSource](IQueryable</code>1 source,\n  Expression`1 predicate) at MyProject.FindUserByType(String typeId)</p>\n</blockquote>\n\n<p>EDIT: As requested, below is a copy of the table schema.</p>\n\n<pre><code>CREATE TABLE [dbo].[Container](\n[ID] [int] IDENTITY(1,1) NOT NULL,\n[MarketCode] [varchar](max) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,\n[Description] [varchar](max) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,\n[Capacity] [int] NOT NULL,\n[Volume] [float] NOT NULL\n CONSTRAINT [PK_Container] PRIMARY KEY CLUSTERED \n(\n[ID] ASC\n)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]\n) ON [PRIMARY]\n</code></pre>\n\n<p>EDIT: The stack trace shows <code>FirstOrDefault</code>, but I duplicated the error using both <code>Take()</code> and <code>ToList()</code>.  The stack trace is identical between all of these, simply interchangnig <code>FirstOrDefault/Take/ToList</code>.  The move down the stack to <code>SqlProvider.Execute</code> is in fact identical.  </p>\n"},{"tags":["c#","xml","linq","c#-4.0","datatable"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13088364,"title":"Linq to Datatable and Linq to XML","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13072927/create-an-xml-from-a-datatable\">Create an XML from a DataTable</a>  </p>\n</blockquote>\n\n\n\n<p>How to create an XML from DataTable using LINQ . I don't have enough experience with LINQ .</p>\n\n<p>Any good tutorials that i can follow.</p>\n\n<p>Convert the below datatable to xml using LINQ. Ignore errors in rows as its test data. I have previously asked this question on stackoverflow. Got one good solution of iterating over datarows and columns. But it would be better if i do it using LINQ. </p>\n\n<p><img src=\"http://i.stack.imgur.com/mXXAO.png\" alt=\"DataTable\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/jAHfI.png\" alt=\"XML\"></p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":183,"score":8,"question_id":13083952,"title":"Combine similar character in string in C#","body":"<p>I have a list of lists that contain integers (this list can be any length and can contain any number of integers:</p>\n\n<pre><code>{{1,2}, {3,4}, {2,4}, {9,10}, {9,12,13,14}}\n</code></pre>\n\n<p>What I want to do next is combine the lists where any integer matches any integer from any other list, in this case:</p>\n\n<pre><code>   result = {{1,2,3,4}, {9,10,12,13,14}}\n</code></pre>\n\n<p>I have tried many different approaches but am stuck for an elegant solution.</p>\n"},{"tags":["c#","linq","entity-framework","c#-3.0"],"answer_count":12,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":12048,"score":2,"question_id":2066084,"title":"\"IN\" Operator in Linq","body":"<p>I am trying to convert an old raw Sql query in Linq with Entity Framework here.</p>\n\n<p>It was using the IN operator with a collection of items. The query was something like that: </p>\n\n<pre><code>SELECT Members.Name\nFROM Members\nWHERE Members.ID IN ( SELECT DISTINCT ManufacturerID FROM Products WHERE Active = 1)\nORDER BY Members.Name ASC\n</code></pre>\n\n<p>Since the return of the subquery is not a single string but a collection of strings I can't use the <code>String.Contains()</code> method.</p>\n\n<p>I thought about doing something like : </p>\n\n<pre><code>var activeProducts = (\nfrom products in db.ProductSet\nwhere product.Active == true\nselect product.ManufacturerID);\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>var activeMembers = (\nfrom member in db.ContactSet\nwhere member.ID.ToString().Contains(activeProducts));\n</code></pre>\n\n<p>but it stops at the contains saying it has invalid arguments ... I can't select activeProducts.ManufacturerID because obviously the proprety is not there since it returns an IQueryable...</p>\n\n<p>Bottom line what I'm trying to do here is to return a list of members who have at least one active product.</p>\n\n<p>Any hint ?</p>\n\n<p>[edit]</p>\n\n<p>Here's the full query code ... I tried with the contains on the second expression, Linq didn't seem to like it : </p>\n\n<p><code>Server Error in '/' Application.\nLINQ to Entities does not recognize the method 'Boolean Contains[String](System.Linq.IQueryable``1[System.String], System.String)' method, and this method cannot be translated into a store expression.</code></p>\n\n<pre><code>    var activeProduct =(from product in Master.DataContext.ProductSet\n                        where product.Active == true\n                           &amp;&amp; product.ShowOnWebSite == true\n                           &amp;&amp; product.AvailableDate &lt;= DateTime.Today\n                           &amp;&amp; ( product.DiscontinuationDate == null || product.DiscontinuationDate &gt;= DateTime.Today )\n                        select product.ManufacturerID.ToString() );\n\n    var activeArtists = from artist in Master.DataContext.ContactSet\n                        where activeProduct.Contains(artist.ID.ToString())\n                        select artist;\n\n    NumberOfArtists = activeArtists.Count();\n\n    artistsRepeater.DataSource = activeArtists;\n    artistsRepeater.DataBind();\n</code></pre>\n\n<p>[More details]\nManufacturerID is a nullable GUID apparently...</p>\n\n<p>For some reason the ContactSet class do not contain any reference to the products I guess I will have to do a join query, no clues here.</p>\n"},{"tags":["sql","linq"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13084762,"title":"Group by true or false in several groups","body":"<p>I have the following class:</p>\n\n<ul>\n<li>Id int</li>\n<li>Active bool</li>\n<li>DateTime datetime</li>\n<li>Approved bool</li>\n</ul>\n\n<p>I have the list of that class similar to this:</p>\n\n<ul>\n<li><strong>Id</strong> 1  <strong>Active</strong> true  <strong>Approved</strong> true</li>\n<li><strong>Id</strong> 2  <strong>Active</strong> true  <strong>Approved</strong> true</li>\n<li><strong>Id</strong> 3  <strong>Active</strong> true  <strong>Approved</strong> true</li>\n<li><strong>Id</strong> 4  <strong>Active</strong> true  <strong>Approved</strong> false</li>\n<li><strong>Id</strong> 5  <strong>Active</strong> true  <strong>Approved</strong> false</li>\n<li><strong>Id</strong> 6  <strong>Active</strong> true  <strong>Approved</strong> false</li>\n<li><strong>Id</strong> 7  <strong>Active</strong> true  <strong>Approved</strong> true</li>\n<li><strong>Id</strong> 8  <strong>Active</strong> true  <strong>Approved</strong> true</li>\n<li><strong>Id</strong> 9  <strong>Active</strong> true  <strong>Approved</strong> false</li>\n</ul>\n\n<p>I want to get items from list group by <strong>Approved</strong> but i want grouped objects to be in this order:</p>\n\n<ul>\n<li><strong>True</strong> all objects till first false.</li>\n<li><strong>False</strong> all objects till next true.</li>\n<li><strong>True</strong> all objects till next false.</li>\n<li><strong>False</strong> all objects till next true.</li>\n</ul>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13086066,"title":"silverlight RadWindow load times","body":"<p>I have a History entity that has a relationship with another entity named Customer and the date that customer was accessed. If I fetch all the history entities I get multiple of the Customer entities but I only need the most recently added instance of that customer.</p>\n\n<p>I am using linq statements and returning the result in an IEnumerable.</p>\n\n<p>How can I achieve this?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","linq","reflection","attributes"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13083657,"title":"Linq Select by PK?","body":"<p>Is it possible to perform a LinQ select by PK dynamically ?</p>\n\n<p>Something like that :</p>\n\n<pre><code>public T FindByPK(IEnumerable&lt;T&gt; table, T itemToFind)\n{\n\n}\n</code></pre>\n\n<p>T is a mapping from table (LinQ to SQL autogenerated).</p>\n\n<p>I tryed using reflection but I don't know how to get the attribute \"IsPrimaryKey\" and then perform the LinQ because sometimes the PK contains more than one column.</p>\n\n<p><strong>EDIT after Answer by chridam</strong></p>\n\n<p>So, I can now do a GetByPK but it assumes that the PK is only one column...</p>\n\n<pre><code>public static class DataContextHelpers\n{\n    public static T GetByPk&lt;T&gt;(this DataContext context, object pk) where T : class {\n        var table = context.GetTable&lt;T&gt;();\n        var mapping = context.Mapping.GetTable(typeof(T));\n        var pkfield = mapping.RowType.DataMembers.SingleOrDefault(d =&gt; d.IsPrimaryKey);\n        if (pkfield == null)\n            throw new Exception(String.Format(\"Table {0} does not contain a Primary Key field\", mapping.TableName));\n        var param = Expression.Parameter(typeof(T), \"e\");\n        var predicate = Expression.Lambda&lt;Func&lt;T, bool&gt;&gt;(Expression.Equal(Expression.Property(param, pkfield.Name), Expression.Constant(pk)), param);\n        return table.SingleOrDefault(predicate);\n    }\n}\n</code></pre>\n\n<p>I changed the code like this to be able to get all columns of the primary keys and also, the object pk has to be a row of the table (because I don't know what are the pk columns)</p>\n\n<pre><code>public static T GetByPk&lt;T&gt;(this DataContext context, T row) where T : class\n        {\n            var table = context.GetTable&lt;T&gt;();\n            var mapping = context.Mapping.GetTable(typeof(T));\n\n            var pkfield = mapping.RowType.DataMembers.Where(d =&gt; d.IsPrimaryKey);\n            if (!pkfield.Any())\n                throw new Exception(String.Format(\"Table {0} does not contain a Primary Key field\", mapping.TableName));\n            var param = Expression.Parameter(typeof(T), \"e\");\n            var predicate = Expression.Lambda&lt;Func&lt;T, bool&gt;&gt;(Expression.Equal(Expression.Property(param, pkfield??), Expression.Property(param, row??)), param);\n            return table.SingleOrDefault(predicate);\n        }\n</code></pre>\n\n<p>So, I am stuck at Expression.Property who need only one property and not a group of many.</p>\n"},{"tags":["c#","linq","sharepoint","linq-to-xml"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":97,"score":3,"question_id":13068621,"title":"Foreach Iteration Null","body":"<p>I am using LINQ to filter the XmlNode returned from Sharepoint WSS3's <code>listService.GetListItems()</code> method.</p>\n\n<p>This is the XML it returns:\n<a href=\"http://pastebin.com/mqHcserY\" rel=\"nofollow\">http://pastebin.com/mqHcserY</a></p>\n\n<p>I observed that the last row is different to the others, it does not contain the following attributes.</p>\n\n<pre><code>ows_ContentType\nows_LinkFilenameNoMenu\nows_LinkFilename\nows_BaseName \nows__EditMenuTableStart\n</code></pre>\n\n<p>So bearing this in mind I filter the results with LINQ:</p>\n\n<pre><code>XmlNode items = listService.GetListItems(listName, string.Empty, query, viewFields, string.Empty, queryOptions, g.ToString());\n\n// Namespace for z: prefix\nXNamespace xns = \"#RowsetSchema\";\n\nXElement root;\nusing (XmlReader xr = new XmlNodeReader(items)) { root = XElement.Load(xr); }\n\n// This query returns XElements that are Folder types\nIEnumerable&lt;XElement&gt; result = from child in root.Descendants(xns + \"row\")\n                               where child.Attribute(\"ows_ContentType\").Value != null &amp;&amp; child.Attribute(\"ows_ContentType\").Value == \"Folder\"\n                               select child;\n\nforeach (XElement xml in result)\n{\n    //Exception when attempts to loop final XElement\n}\n</code></pre>\n\n<p>However when I iterate through the results I get a <code>NullReferenceException</code>. In a Foreach loop it will happily iterate through every object until it gets to the last one, then it will throw an exception.</p>\n\n<p>This last object is the one that differs from the other rows (I know this through process of elimination, I saw every other row get looped past) and should have been filtered out of my results as it does not have the \"ows_ContentType\" attribute.</p>\n\n<p>I changed my LINQ to <code>where child.Attribute(\"ows_ContentType\").Value != null &amp;&amp; child.Attribute(\"ows_ContentType\").Value == \"Folder\"</code> in attempt to filter anything that would contain a null value but I have the same results.\nI have looked at a few <a href=\"http://code.msdn.microsoft.com/LINQ-Restriction-Operators-b15d29ca#WhereSimple3\" rel=\"nofollow\">samples</a> and I appear to have the correct syntax.</p>\n\n<p>Could someone please explain what is causing this last XElement to return null?\nI really don't understand why it would add a null instance to the <code>&lt;IEnumerable&lt;XElement&gt; result</code> collection. </p>\n"},{"tags":["vb.net","linq","null","dbnull"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2270,"score":4,"question_id":2402927,"title":"Filtering DBNull With LINQ","body":"<p>Why does the following query raise the error below for a row with a <code>NULL</code> value for barrel when I explicitly filter out those rows in the <code>Where</code> clause?</p>\n\n<pre><code>Dim query = From row As dbDataSet.conformalRow In dbDataSet.Tables(\"conformal\") _\n            Where Not IsDBNull(row.Cal) AndAlso tiCal_drop.Text = row.Cal _\n            AndAlso Not IsDBNull(row.Tran) AndAlso tiTrans_drop.Text = row.Tran _\n            AndAlso Not IsDBNull(row.barrel) _\n            Select row.barrel\nIf query.Count() &gt; 0 Then tiBarrel_txt.Text = query(0)\n</code></pre>\n\n<p><code>Run-time exception thrown : System.Data.StrongTypingException - The value for column 'barrel' in table 'conformal' is DBNull.</code> </p>\n\n<p>How should my query / condition be rewritten to work as I intended?</p>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":13074664,"title":"How to return distinct elements from my C# collection?","body":"<p>I have a <em>MongoDB</em> database where I store all pictures and when I retrieve them I have stored some doubles, which ain't so good, but anyway I want to show only distinct elements. </p>\n\n<pre><code> @foreach (Foto f in fotos.Distinct(new IEqualityComparer&lt;Foto&gt; { )\n</code></pre>\n\n<p>But the Foto class has one property called smallurl and I want to show only distinct elements by this property. So how to write a custom <strong>IEqualityComparer</strong>. </p>\n"},{"tags":["c#","linq","caching","serialization","dynamic"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13083680,"title":"Options In-memory queries against cached objects in .Net applications","body":"<p>I've developed a system that connects to external DBs and allows users to generate reports from these systems. Because I have no knowledge of the structure of these systems all my data sets are untyped which means I'm currently using DataTable's to store them.</p>\n\n<p>In order to provide speedy analysis I use the Dyanmic Linq library to perform linq qeuries over the datasets, I cache the datasets using Microsoft AppFabric.  I also use protobuf-net (datatable extension) to serialize the size of the DataTable before adding to the cache.  </p>\n\n<p>To execute a query I first need to read the object from the cache, then de-serialize and finally execute the Dynamic Linq query.  </p>\n\n<p>I was wondering if anybody can recommend any alternative approaches? I think the limiting factor in my solution is having to rely on DataTables so for example I can't use any of the linq querying capabilities of protobuf-net.  I also have to take the DataTable in and out of cache and de-serialize each time before performing the query.</p>\n"},{"tags":["linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":133,"score":0,"question_id":7740193,"title":"LINQ Query result makes no sense","body":"<p>I am running a simple LINQ query that connects to a view and returns all of the data with the id that I send in.</p>\n\n<p>My simple query is:</p>\n\n<pre><code> var data = db.ViewDataAlls.Where(x =&gt; x.guidRequirementId == guidRequirementId);\n</code></pre>\n\n<p>if I run this query in the database:</p>\n\n<pre><code>select * from viewDataAll where guidrequiremendid = '{Guid Id Sent In Here}'\n</code></pre>\n\n<p>I get 2 rows back, however the LINQ query is returning 2 rows, but the rows are a duplicate of the first row, not 2 unique rows.</p>\n\n<p>Any ideas?</p>\n\n<p>EDIT: if I run this LINQ Query:</p>\n\n<pre><code>List&lt;string&gt; nums = db.ViewDataAlls\n                      .Where(x =&gt; x.guidRequirementId == guidRequirementId)\n                      .Select(x=&gt;x.strNumber).ToList();\n</code></pre>\n\n<p>I get the individual row numbers, but if I just try to pull the entire row I get a duplicate of the first row multiple times...</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":102,"score":2,"question_id":13082913,"title":"Select every second element from array using lambda","body":"<p>C# 4.0. How can the following be done using lambda expressions?</p>\n\n<pre><code>int[] a = new int[8] { 0, 1, 2, 3, 4, 5, 6, 7 };\n// Now fetch every second element so that we get { 0, 2, 4, 6 }\n</code></pre>\n"},{"tags":["c#","xml","linq","query"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13065532,"title":"LINQ XML- Read XML data","body":"<p>I am having trouble with LINQ query for XML and can't solve</p>\n\n<p>I am trying to extract the  element values</p>\n\n<p>Here is the XML</p>\n\n<pre><code>&lt;response&gt;\n  &lt;make&gt;DODGE&lt;/make&gt;\n  &lt;make&gt;CHRYSLER&lt;/make&gt;\n  &lt;make&gt;JEEP&lt;/make&gt;\n  &lt;make&gt;RAM&lt;/make&gt;\n  .......etc\n&lt;/response&gt;\n</code></pre>\n\n<p>Here is the code I have so far...</p>\n\n<pre><code>        XElement parsedXml3 = XElement.Parse(xml3);\n        var query2 = from m in parsedXml3.Descendants(\"response\")\n                     select m.Elements(\"make\").Select(e =&gt; e.Value);\n        List&lt;string&gt; ls = new List&lt;string&gt;();\n        foreach (var o in query2)\n        {\n            ls = o.ToList();\n        }\n        ls.Sort();\n</code></pre>\n\n<p>Thanks for your help - extended explanations would be great </p>\n"},{"tags":["linq","c#-4.0","mongodb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13082537,"title":"MongoDb c# driver LINQ vs Native query","body":"<p>Which of these queries is better performance wise one uses linq and the other uses a native querying mehanism</p>\n\n<pre><code>LINQ\n\nvar query =\ncollection.AsQueryable&lt;Employee&gt;()\n.Where(e =&gt; e.FirstName == \"John\")\n.Select(e =&gt; e); \n\n\nNATIVE\n\nvar query= Query&lt;Employee&gt;.EQ(e =&gt; e.FirstName, \"John\");\nvar emp = collection.FindOne(query);\n</code></pre>\n\n<p>I am assuming that the native querying mechanism in mongoDb would be better since, as far as I understand, it filters out the result in the database where as linq first gets all the items in the collection and then filters for the result.When should I consider using LINQ over native querying mechanism?</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13082111,"title":"On what conditon the data gets loaded from DC","body":"<p>In my application data is getting loaded from DC based one a perticular condition, but we dont no how its getting loaded.\nIf i add one more condition, the data is loading but while submitt the mismatched condtion data is getting deleted from the db.\nHow to check where the data is coming from Dc to local DB in linq?. any flag we need to make true?</p>\n"},{"tags":["linq","entity-framework","linq-to-entities","entity"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13080190,"title":"Entity Frameworks: How to decrypt a field prior to OrderBy","body":"<p>I have an IQueryable list of Customer entities (EntityFrameworks).  I need to do an orderby on this IQueryable list but the issue is that the field that I want to use for ordering is encrypted in the database.  Is there any way that I can decrypt this field prior to ordering?  Can I write some kind of Linq extension for OrderBy.  Since there could be thousands of Customers, I don't want to materialize the list just so it can be sorted...</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13081770,"title":"Lookup from CSV","body":"<p>I have a CSV file in this format:</p>\n\n<pre><code>\"Call Type\",\"Charge Type\",\"Map to\"\n\"51\",\"\",\"Mobile SMS\"\n\"52\",\"\",\"Mobile SMS\"\n\"DD\",\"Local Calls\",\"Local Calls\"\n\"DD\",\"National Calls\",\"National Calls\"\n</code></pre>\n\n<p>First two columns are the \"source information\" that my C# will insert, and the last column is what it will return.</p>\n\n<p>Currently what I am doing is a switch statement hardcoded in c#.</p>\n\n<pre><code>var File001 = from line in File.ReadLines(bill_file)\n                                      let l = line.Split(',')\n                                      select new\n                                      { CallType = ICD_map(l[5],l[3])}\n</code></pre>\n\n<p>where</p>\n\n<pre><code>l[5] = \"51\";\nl[3] = \"\";\n\n\n\n private static string ICD_map(string call_type_description, string call_category,)\n        {\n              case \"51\":\n              case \"52\":\n                  return \"Mobile SMS\";\n               default:\n                    return \"Unknown\";\n}\n</code></pre>\n\n<p>I want this to be an expandable list thus my new method is to load the mapping table from a csv file. Can you suggest any improvements to this method to make my definition library expandable (hoping CSV file okay for this purpose, it is only 100 lines long so far, so not concerned about memory management).</p>\n\n<p>What I have tried so far is:</p>\n\n<pre><code>    class ICD_Map2\n    {\n        private string call_type;\n        private string charge_type;\n        private string map_to;\n\n        // Default constructor\n        public ICD_Map2() {\n            call_type = \"Unknown\";\n            charge_type = \"Unknown\";\n            map_to = \"Unknown\";\n        }\n\n        // Constructor \n        public ICD_Map2(string call_type, string charge_type, string map_to)\n        {\n            this.call_type = call_type;\n            this.charge_type = charge_type;\n            this.map_to = map_to;\n        }\n\n    }\n\n    List&lt;ICD_Map2&gt;maps = new List&lt;ICD_Map2&gt;();\n\n\n\nprivate void button2_Click(object sender, EventArgs e)\n        {\n            // Start new thread to create BillSummary.csv\n            button1.Enabled = false;\n\n            maps.Clear();\n            //load mapping file\n            var reader = new StreamReader(File.OpenRead(@\"Itemised_Call_Details_Map.csv\"));\n            while (!reader.EndOfStream)\n            {\n                var line = reader.ReadLine();\n                var values = line.Split(',');\n\n                maps.Add(new ICD_Map2(values[0].Replace(\"\\\"\",\"\"), values[1].Replace(\"\\\"\",\"\"), values[2].Replace(\"\\\"\",\"\")));\n                textBox2.AppendText(Environment.NewLine + \" Mapping: \" + values[0].Replace(\"\\\"\", \"\") + \" to \" + values[1].Replace(\"\\\"\", \"\"));\n            }\n</code></pre>\n\n<p>I have loaded the CSV file to my program but I am unable to do the lookup from LINQ. Can you tell me the next process.</p>\n\n<p>Open to any other method.</p>\n\n<p>Thanks for your time.</p>\n"},{"tags":["c#","xml","linq","datatable","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":13072927,"title":"Create an XML from a DataTable","body":"<p><img src=\"http://i.stack.imgur.com/yKZpv.png\" alt=\"DataTable In C# of following format\"></p>\n\n<p>Using C# : I want to convert this table into XML. <strong>Please ignore the mistakes in row names</strong>. This is test data. I have given sample of two columns converted to xml and the corresponding rows as attributes . But i actually want for all columns. This is a Datatable.</p>\n\n<pre><code> &lt;ListDataCollateralDials&gt;\n                                &lt;DataCollateralDials Type=\"Conv\"&gt;\n                                    &lt;Multiplier&gt;1&lt;/Multiplier&gt;\n                                    &lt;Seasoning&gt;1&lt;/Seasoning&gt;\n                                    &lt;Lockin&gt;1&lt;/Lockin&gt;\n                                    &lt;Multiplier&gt;1&lt;/Multiplier&gt;\n                                    &lt;ElbowShift&gt;0&lt;/ElbowShift&gt;\n                                    &lt;Steepness&gt;1&lt;/Steepness&gt;\n                                    &lt;Burnout&gt;1&lt;/Burnout&gt;\n                                    &lt;Adjustment &gt;1&lt;/Adjustment&gt;\n                                    &lt;Effect&gt;1&lt;/Effect&gt;\n                                    &lt;Decay&gt;1&lt;/Decay&gt;\n                                    &lt;Outs&gt;1&lt;/Outs&gt;\n                                    &lt;Base&gt;700&lt;/Base&gt;\n                                    &lt;Slope&gt;1&lt;/Slope&gt;\n                                    &lt;Base&gt;80&lt;/Base&gt;\n                                    &lt;Slope2&gt;1&lt;/Slope2&gt;\n                                    &lt;Base2&gt;200&lt;/Base2&gt;\n                                    &lt;Slope3&gt;1&lt;/Slope3&gt;\n                                    &lt;Height&gt;0&lt;/Height&gt;\n                                    &lt;Length&gt;0&lt;/Length&gt;\n                                    &lt;Height2&gt;0&lt;/Height2&gt;\n                                    &lt;Length2&gt;0&lt;/Length2&gt;\n                                    &lt;Elbow&gt;0&lt;/Elbow&gt;\n                                                 &lt;Multiplier2&gt;1&lt;/Multiplier2&gt;\n                                    &lt;Multiplier3&gt;1&lt;/Multiplier3&gt;\n\n                                &lt;/DataCollateralDials&gt;\n&lt;DataCollateralDials Type=\"Conv\"&gt;\n                                &lt;Multiplier&gt;1&lt;/Multiplier&gt;\n                                &lt;Seasoning&gt;1&lt;/Seasoning&gt;\n                                &lt;Lockin&gt;1&lt;/Lockin&gt;\n                                &lt;Multiplier&gt;1&lt;/Multiplier&gt;\n                                &lt;ElbowShift&gt;0&lt;/ElbowShift&gt;\n                                &lt;Steepness&gt;1&lt;/Steepness&gt;\n                                &lt;Burnout&gt;1&lt;/Burnout&gt;\n                                &lt;Adjustment &gt;1&lt;/Adjustment&gt;\n                                &lt;Effect&gt;1&lt;/Effect&gt;\n                                &lt;Decay&gt;1&lt;/Decay&gt;\n                                &lt;Outs&gt;1&lt;/Outs&gt;\n                                &lt;Base&gt;700&lt;/Base&gt;\n                                &lt;Slope&gt;1&lt;/Slope&gt;\n                                &lt;Base&gt;80&lt;/Base&gt;\n                                &lt;Slope2&gt;1&lt;/Slope2&gt;\n                                &lt;Base2&gt;200&lt;/Base2&gt;\n                                &lt;Slope3&gt;1&lt;/Slope3&gt;\n                                &lt;Height&gt;0&lt;/Height&gt;\n                                &lt;Length&gt;0&lt;/Length&gt;\n                                &lt;Height2&gt;0&lt;/Height2&gt;\n                                &lt;Length2&gt;0&lt;/Length2&gt;\n                                &lt;Elbow&gt;0&lt;/Elbow&gt;\n                                &lt;Multiplier2&gt;1&lt;/Multiplier2&gt;\n                                &lt;Multiplier3&gt;1&lt;/Multiplier3&gt;\n\n                            &lt;/DataCollateralDials&gt;\n&lt;/ListDataCollateralDials&gt;\n</code></pre>\n"},{"tags":["c#","sql","linq","linq-to-sql","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13024829,"title":"How to remove entity from local copy without removing from Linq DB","body":"<p>I have a problem in Linq. I am getting all the contents a in table when I query. But I don't want to load certain rows which are marked with some special key <code>Y</code>.</p>\n\n<p>So, for this, I'm iterating and removing from my local copy those which are having special key <code>Y</code>.</p>\n\n<p>Later on, when I submit changes, I get an error: </p>\n\n<p><code>\"An attempt was made to remove a relationship between a priceTable and a dataTable. However, one of the relationship's foreign keys (P.Id) cannot be set to null.\"</code></p>\n\n<p>Why is it so? How can I alter the contents of a particular entity set without touching some of the rows?</p>\n\n<p>I want the rows that are marked as <code>Y</code> not to be returned from the DB. I don't want use them in my c# at runtime.</p>\n"},{"tags":["c#","linq","entity-framework","linq-to-entities","linq-expressions"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":80,"score":4,"question_id":13056943,"title":"EF orderby / thenby combo extension method","body":"<p>I want to be able to apply combo <code>firstby / thenby</code> sorting as follows:</p>\n\n<pre><code>allOrders().sort(s =&gt; s.ProductName, s =&gt; s.OrderDate)\n</code></pre>\n\n<p>So using <a href=\"http://stackoverflow.com/a/5376637/1711500\">this post as inspiration</a>, I wrote this extension method, which compiles fine:</p>\n\n<pre><code>public static IQueryable&lt;T&gt; sort&lt;T&gt;(this IQueryable&lt;T&gt; entities, params \n  Expression&lt;Func&lt;T, object&gt;&gt;[] predicates) where T : class \n{\n  var sorted = entities.OrderBy(predicates[0]);\n  for (int i = 1; i &lt; predicates.Length; i++)\n    sorted = sorted.ThenBy(predicates[i]);\n\n  return sorted;\n}\n</code></pre>\n\n<p>And I also tried this succint version, which also compiles:</p>\n\n<pre><code>public static IQueryable&lt;T&gt; sort&lt;T&gt;(this IQueryable&lt;T&gt; entities, params \n  Expression&lt;Func&lt;T, object&gt;&gt;[] predicates) where T : class\n{\n  return predicates.Skip(1).Aggregate(\n    entities.OrderBy(predicates[0]),\n    (aggregate, currentPredicate) =&gt; aggregate.ThenBy(currentPredicate));\n}\n</code></pre>\n\n<p>However if I try sort by a <code>DateTime</code>, I get this exception:  </p>\n\n<blockquote>\n  <p><em>Unable to cast the type 'System.DateTime' to type 'System.Object'. LINQ to Entities only supports casting EDM primitive or enumeration types.</em></p>\n</blockquote>\n\n<p>What am I doing wrong? I am using EF5.</p>\n"},{"tags":["c#","sql","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13080969,"title":"How to assign one object to another in Linq c# without making new","body":"<p>I'm facing an issue in assigning one object to another in Linq to SQL. In this example:</p>\n\n<pre><code>Func&lt;result, result&gt; make = q =&gt; new result\n{\n    Id = q.Id,\n    lName = q.lName,\n    GroupId = q.GroupId,\n    Age = (from tags in q.age where tags.Del == null &amp;&amp; tags.lId == q.Id select age).ToEntitySet(),\n\n};\n\np = (from q in dc.results\n        where q.Id == Id.Value\n        select make(q)).First();\n</code></pre>\n\n<p>I am making new and assigning the object, but I don't want to do this, it will cause problem in insertion. I want to assign without making a new object, how is this possible?</p>\n"},{"tags":["c#","asp.net","sql","sql-server","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":115,"score":0,"question_id":13080744,"title":"Unable to cast object of type 'System.Double' to type 'System.String'.","body":"<p>I am importing excel data into sql table at the same time i want to show the duplicate rows among excel sheet and sql table in a grid view the following is my attempt:</p>\n\n<pre><code>  protected void Button1_Click(object sender, EventArgs e)\n{\n    string strFileType = System.IO.Path.GetExtension(FileUpload1.FileName).ToString().ToLower();\n    string strFileName = FileUpload1.PostedFile.FileName.ToString();\n\n    FileUpload1.SaveAs(Server.MapPath(\"~/Import/\" + strFileName + strFileType));\n    string strNewPath = Server.MapPath(\"~/Import/\" + strFileName + strFileType);\n\n\n\n\n\n\n        string excelConnectionString = String.Format(@\"Provider=Microsoft.Jet.OLEDB.4.0;\" + \"Data Source=\"+strNewPath +\"; Extended Properties=Excel 8.0;\");\n\n    //string excelConnectionString = String.Format(@\"Provider=Microsoft.Jet.OLEDB.4.0;\" + \"Data Source=C:\\\\myFolder\\\\Book1.xls;\" + \"Extended Properties=Excel 8.0;\"); \n\n\n        // Create Connection to Excel Workbook\n        using (OleDbConnection connection = new OleDbConnection(excelConnectionString))\n        {\n            connection.Open();\n            OleDbCommand command = new OleDbCommand(\"Select ID,Data FROM [Sheet1$]\", connection);\n            OleDbCommand command1 = new OleDbCommand(\"select count(*) from [Sheet1$]\", connection);\n\n            //Sql Server Table DataTable\n            DataTable dt4 = new DataTable();\n            SqlCommand cmd4 = new SqlCommand(\"select id,data from ExcelTable\", con);\n            try\n            {\n                SqlDataAdapter da4 = new SqlDataAdapter(cmd4);\n                da4.Fill(dt4);//sql table datatable\n            }\n            catch { }\n\n\n            //excelsheet datatable\n            DataTable oltlb = new DataTable();\n            OleDbCommand olcmd = new OleDbCommand(\"select id,data from [Sheet1$]\", connection);\n            try\n            {\n                OleDbDataAdapter olda = new OleDbDataAdapter(olcmd);\n                olda.Fill(oltlb); //excel table datatable\n            }\n            catch { }\n\n            var matched = (from table1 in dt4.AsEnumerable()\n                           join table2 in oltlb.AsEnumerable() on\n                         table1.Field&lt;int&gt;(\"ID\") equals Convert.ToInt32(table2.Field&lt;string&gt;(\"ID\"))\n                           where table1.Field&lt;string&gt;(\"Data\") == table2.Field&lt;string&gt;(\"Data\")\n                           select table1);\n            DataTable dthi5 = new DataTable();\n            dthi5 = matched.CopyToDataTable();\n\n            GridView1.DataSource = dthi5;\n            GridView1.DataBind();\n            GridView1.DataSource = matched.ToList();\n</code></pre>\n\n<p>Id is int(allow nulls), data(nvarchar) in sql server database</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":70,"score":5,"question_id":13079218,"title":"How to implement Linq OrderBy method?","body":"<p>I am trying to understand more about linq, for example, if I want to implement a Select I will implement like this</p>\n\n<pre><code>        public static IEnumerable&lt;TResult&gt; Select&lt;TSource, TResult&gt;(IEnumerable&lt;TSource&gt; source, Func&lt;TSource, TResult&gt; selector)\n        {\n            foreach (var item in source)\n            {\n                yield return selector(item);\n            }\n        }\n</code></pre>\n\n<p>where like this</p>\n\n<pre><code>        public static IEnumerable&lt;TSource&gt; Where&lt;TSource&gt;(IEnumerable&lt;TSource&gt; source, Func&lt;TSource, bool&gt; predicate)\n        {\n            foreach (var item in source)\n            {\n                if (predicate(item))\n                    yield return item;\n            }\n        }\n</code></pre>\n\n<p>How about OrderBy?</p>\n"},{"tags":["c#","linq","entity-framework","generic-list"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":101,"score":6,"question_id":13062462,"title":"Proper way to construct linq queries to achieve fastest performance?","body":"<p>Similar question have been asked here but none fits to my need.<br>\nI made test cases to see which is faster. But I feel my linq code is still slow. How do I construct the linq code for faster performance?  </p>\n\n<p>Others said using double <code>.Tolist()</code> can cause slower operation, when I test it, it shows that it is faster than any other tests.</p>\n\n<p>Test:  </p>\n\n<pre><code>Preparation\n---------------------------------------------------------------\nreturn Properties of UserInfo(userinf, true){\n    UserID = userinf.UserID;\n    FirstName = userinf.user.FirstName;\n    MiddleName = userinf.user.MiddleName;\n    LastName = userinf.user.LastName;\n    LoginID = userinf.user.LoginID;\n    Birthday = userinf.Birthday;\n}\n\nskip = 0;\ntake = 100;\n\ntotal table records = 304;\n\nLinq to Entity Framework \n</code></pre>\n\n<p>Fiddler: v2.4.0.0  </p>\n\n<pre><code>https://127.0.0.1/..../RetrieveUserInfo?skip=0&amp;take=100\n{\n    \"client\":{\n        \"SessionID\":\"5433ab64-7e0d-444f-b886-a901ea9a0601\"\n    },\n    \"session\":{\n        \"SessionID\":\"35b75daa-25ad-45a4-9f99-0e69ec3b66a4\"\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>//Test 1\n//1) 00:00:15.3068755 -- Attempt1\n//2) 00:00:13.8207905 -- Attempt2\n//3) 00:00:16.2489294 -- Attempt3\n\nvar list = (from usr in dbase.userinfoes\n            select usr).OrderBy(i =&gt; i.UserID).Skip(skip).Take(take).ToList();\n\nuserlist = (from i in list\n            select new UserInfo(i, true)).ToList();\n\n\n///Test 2\n//1) 00:00:15.3908803\n//2) 00:00:14.8818512\n//3) 00:00:19.4761140\n\nvar list = (from usr in dbase.userinfoes.AsEnumerable().OrderBy(i =&gt; i.UserID).Skip(skip).Take(take).ToList()\n            select new UserInfo(usr, true)).ToList();\n\n\n//Test 3\n//1) 00:00:30.1937270\n//2) 00:00:24.1003784\n//3) 00:00:28.8806519\n\nvar list = dbase.userinfoes.OrderBy(i =&gt; i.UserID).Skip(skip).Take(take).ToList();\nuserlist = (from i in list select new UserInfo(i, true)).ToList();\n\n\n//Test 4\n//1) 00:00:57.2652754\n//2) 00:00:54.4051118\n//3) 00:00:55.3251644\n\nvar list = (from usr in dbase.userinfoes\n            select usr).ToList();\n\nuserlist = (from i in list\n            select new UserInfo(i, true)).OrderBy(i =&gt; i.UserID).Skip(skip).Take(take).ToList();\n\n\n//Test 5\n//1) 00:01:06.8378229\n//2) 00:01:01.2845053\n//3) 00:00:55.0721499\n\nvar list = from usr in dbase.userinfoes\n           select usr;\n\nuserlist = (from i in list.AsEnumerable()\n            select new UserInfo(i, true)).OrderBy(i =&gt; i.UserID).Skip(skip).Take(take).ToList();\n\n\n// Test 6\n// VERY LONG. It tooks all records first and construct UserInfo one by one before doing the skip and take\n\nvar list = (from usr in dbase.userinfoes.AsEnumerable()\n            select new UserInfo(usr, true)).OrderBy(i =&gt; i.UserID).Skip(skip).Take(take).ToList();\n\n\n//Test 7\n// VERY LONG. It tooks all records first and construct UserInfo one by one before doing the skip and take\n\nvar list = from usr in dbase.userinfoes.AsEnumerable()\n           select new UserInfo(usr);\n</code></pre>\n\n<p>Proper code for faster search. Thanks to <code>casperOne</code> for pointing out that <strong>the ordering, skip and take are all performed on the server</strong> is more faster. </p>\n\n<p>Here is the final code:  </p>\n\n<pre><code>var list = (from usr in dbase.userinfoes\n                .OrderBy(i =&gt; i.UserID)\n                .Skip(skip)\n                .Take(take)\n                .AsEnumerable()\n            select new UserInfo(usr, true)).ToList();   \n\n1) 00:00:10.9210513\n2) 00:00:10.8270973\n3) 00:00:10.8250151\n</code></pre>\n\n<p>Thanks to <code>Richard Neil Ilagan</code> for the final code.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13079441,"title":"Searching Error in Linq when checking for nulls","body":"<p>Hi I have some code like this:</p>\n\n<pre><code>    var organisations = Uow.Query&lt;Organisation&gt;().\nWhere(x =&gt; x.PersonOrganisationRoles.Any(por =&gt; por.Person.FirstName != null &amp;&amp; phr.Person.FirstName.ToLower().\nContains(searchFragmentLower)));\n</code></pre>\n\n<p>So there is a bridging table between Organisation Person and Role. This query is trying to find orgs that have people with a FirstName containing the string.</p>\n\n<p>The problem is when I run it I get:</p>\n\n<blockquote>\n  <p>Cannot use Person[FirstName &lt;> NULL] as part of a logical expression in an Any or All expression</p>\n</blockquote>\n\n<p>How can I check for <code>Null</code>?</p>\n"},{"tags":["c#",".net","linq","duplicate-removal"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13077511,"title":"Remove duplicate items from structure/List, keep best one","body":"<p>I have a classic remove duplicate items from list/nestedlist problem.  However, due to the specific rules that I'm trying to follow, the solution is not straight-forward.  I've written a sample application that works as desired.  But it seems clunky.  I am looking for more elegance, and if possible more efficiency.  Maybe LINQ/extension methods could help. Any suggestions?</p>\n\n<hr>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        var sellers = new List&lt;Seller&gt;()\n        {\n            new Seller()\n            {\n                Id = 1,\n                Products = new List&lt;Product&gt;()\n                {\n                    new Product() { Sku = \"Alpha\", Price = 5.0, Shipping = 2.0 },\n                    new Product() { Sku = \"Beta\", Price = 5.0, Shipping = 2.0 }, // more expensive sku within same seller\n                    new Product() { Sku = \"Beta\", Price = 4.0, Shipping = 2.0 },\n                    new Product() { Sku = \"Gamma\", Price = 8.0, Shipping = 2.0 }\n                }\n            },\n            new Seller()\n            {\n                Id = 2,\n                Products = new List&lt;Product&gt;()\n                {\n                    new Product() { Sku = \"Alpha\", Price = 5.0, Shipping = 1.0 },\n                    new Product() { Sku = \"Beta\", Price = 5.0, Shipping = 1.0 },\n                    new Product() { Sku = \"Gamma\", Price = 8.0, Shipping = 2.0 }\n                }\n            }\n        };\n\n        // Eliminate duplicate Products amongst all sellers that have matching \"Sku\".\n        // Rules: \n        // Keep the Product with the lowest price. \n        // If price is equal, keep the product with lower shipping.\n        // If shipping is also equal, then keep the product with lowest seller Id.\n        // If at the end of all comparisons, a seller ends up with no products, then remove that seller.\n\n        // In this example, I expect to have (not necessarily in this order):\n        // 1.{Beta, 4.0, 2.0} // Fred.Beta has a lower price than Bob.Beta\n        // 1.{Gamma, 8.0, 2.0} // Fred.Gamma is an identical deal to Bob, but Fred is first in the list\n        // 2.{Alpha, 5.0, 1.0} // Bob.Alpha has a lower shipping cost than Fred.Alpha\n\n        var newSellers = new List&lt;Seller&gt;();\n\n        foreach (var seller in sellers)\n        {\n            foreach (var product in seller.Products)\n            {\n                // TODO: Possible performance improvement? Check for existing seller &amp; product in newSellers before calling any code below.\n                var bestSeller = seller;\n                var bestProduct = product;\n                FindBestSellerAndProduct(sellers, ref bestSeller, ref bestProduct);\n                AddIfNotExists(newSellers, bestSeller, bestProduct);\n            }\n        }\n\n        newSellers.Sort((x, y) =&gt; x.Id.CompareTo(y.Id)); // Ensures the list is sorted by seller id... do I really care?\n    }\n\n    private static void FindBestSellerAndProduct(IList&lt;Seller&gt; sellers, ref Seller seller, ref Product product)\n    {\n        string sku = product.Sku;\n\n        foreach (var s in sellers)\n        {\n            foreach (var p in s.Products.Where(x =&gt; x.Sku == sku))\n            {\n                if ((product.Price &gt; p.Price) ||\n                    (product.Price == p.Price &amp;&amp; product.Shipping &gt; p.Shipping) ||\n                    (product.Price == p.Price &amp;&amp; product.Shipping == p.Shipping &amp;&amp; seller.Id &gt; s.Id))\n                {\n                    seller = s;\n                    product = p;\n                }\n            }\n        }\n    }\n\n    private static void AddIfNotExists(IList&lt;Seller&gt; sellers, Seller seller, Product product)\n    {\n        var newSeller = sellers.SingleOrDefault(x =&gt; x.Id == seller.Id);\n        if (newSeller == null)\n        {\n            // Add input seller and product if seller doesn't already exist in our list.\n            newSeller = new Seller() { Id = seller.Id, Products = new List&lt;Product&gt;() };\n            newSeller.Products.Add(product);\n            sellers.Add(newSeller);\n        }\n        else\n        {\n            var newProduct = newSeller.Products.Find(x =&gt; x.Sku == product.Sku);\n            if (newProduct == null)\n            {\n                // Add input product if it doesn't already exist in our list\n                newSeller.Products.Add(product);\n            }\n        }\n    }\n\n}\n\n// I cannot modify the below classes.\npublic sealed class Seller\n{\n    public int Id;\n    public List&lt;Product&gt; Products;\n}\n\npublic sealed class Product\n{\n    public string Sku;\n    public double Price;\n    public double Shipping;\n}\n</code></pre>\n"},{"tags":["c#","performance","linq","list","iqueryable"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":81,"score":5,"question_id":13078208,"title":"List queries 20 times faster than IQueryable?","body":"<p>Here is a test that i have setup this evening. It was made to prove something different, but the outcome was not quite as i expected. </p>\n\n<p>I'm running a test with 10000 random queries on an IQueryable and while testing i found out that if i do the same on a List, my test is 20 times faster.</p>\n\n<p>See below. My CarBrandManager.GetList originally returns an IQueryable, but now i first issue a ToList(), and then it's way faster. </p>\n\n<p>Can anyone tell me something about why i see this big difference? </p>\n\n<pre><code>var sw = new Stopwatch();\nsw.Start();\n\nint queries = 10000;\n\n//IQueryable&lt;Model.CarBrand&gt; carBrands = CarBrandManager.GetList(context);\nList&lt;Model.CarBrand&gt; carBrands = CarBrandManager.GetList(context).ToList();\n\nRandom random = new Random();\nint randomChar = 65;\n\nfor (int i = 0; i &lt; queries; i++)\n{\n    randomChar = random.Next(65, 90);\n    Model.CarBrand carBrand = carBrands.Where(x =&gt; x.Name.StartsWith(((char)randomChar).ToString())).FirstOrDefault();\n}\n\nsw.Stop();\nlblStopWatch.Text = String.Format(\"Queries: {0} Elapsed ticks: {1}\", queries, sw.ElapsedTicks);\n</code></pre>\n"},{"tags":["c#","asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":60,"score":0,"question_id":13077007,"title":"Removing and adding search filters with Linq","body":"<p>I have a search field that uses a Drop down list to Filter search results by division. </p>\n\n<p>I finally got it working great but now I want to make an ALL option to negate this. The drop down values are equal to an int.   I am still learning so the only way I can bend my mind around this would be a if else statement in the where query.  When i did that i saw a lot of red. </p>\n\n<p>There are 5 options on the Drop down list. The values are 1 through 5. 5 = all.  I want to basically stop searching by division or eliminate the <code>t0.DivisionID == DDLInt &amp;&amp;</code></p>\n\n<pre><code>string DDL = DDLAddDivision.SelectedValue;\nint DDLInt;\nif (int.TryParse(DDL, out DDLInt))\n{\n    int searchID;\n    if (!int.TryParse(txtSearch.Text.Trim(), out searchID))\n        searchID = -1;  // set to an invalid ID\n\n\n    ItemContext db = new ItemContext();\n    var q = (from t0 in db.Item\n             join t1 in db.Categories on t0.CategoryID equals t1.CategoryID\n             join t2 in db.Divisions on t0.DivisionID equals t2.DivisionID\n\n             where\n\n\n              t0.DivisionID == DDLInt &amp;&amp;\n\n                 //Contains\n\n            (\n             t0.ItemName.Contains(txtSearch.Text.Trim()) ||\n             t0.Email.Contains(txtSearch.Text.Trim()) ||\n             t0.Description.Contains(txtSearch.Text.Trim()) ||\n             t0.Phone.Contains(txtSearch.Text.Trim()) ||\n             t0.ItemID.Equals(searchID)\n             )\n             group t0 by new\n             {\n                 t0.ItemID,\n                 t0.ItemName,\n                 t0.Description,\n                 t0.Phone,\n                 t0.Email,\n                 t0.DivisionID,\n                 t0.CategoryID,\n                 t1.CategoryName,\n                 t2.DivisionName\n\n\n             } into i\n\n             select new\n             {\n                 i.Key.ItemID,\n                 i.Key.ItemName,\n                 i.Key.Description,\n                 i.Key.Email,\n                 i.Key.Phone,\n                 i.Key.CategoryName,\n                 i.Key.DivisionName,\n                 i.Key.CategoryID,\n                 i.Key.DivisionID\n\n             });\n\n    if (q.Any() == false)\n    {\n        ResultsLabelId.Visible = true;\n    }\n    else\n    {\n        ResultsLabelId.Visible = false;\n    }\n\n    //bind and return\n    lv.DataSource = q.ToList();\n    lv.DataBind();\n</code></pre>\n\n<p>Thank you for any and all help!</p>\n"},{"tags":["c#","xml","linq","namespaces"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2794,"score":6,"question_id":4985974,"title":"XElement namespaces (How to?)","body":"<p>How to create xml document with node prefix like:</p>\n\n<pre><code>&lt;sphinx:docset&gt;\n  &lt;sphinx:schema&gt;\n    &lt;sphinx:field name=\"subject\"/&gt;\n    &lt;sphinx:field name=\"content\"/&gt;\n    &lt;sphinx:attr name=\"published\" type=\"timestamp\"/&gt;\n &lt;/sphinx:schema&gt;\n</code></pre>\n\n<p></p>\n\n<p>When I try to run something like <code>new XElement(\"sphinx:docset\")</code> i getting exception </p>\n\n<blockquote>\n  <p>Unhandled Exception: System.Xml.XmlException: The ':' character, hexadecimal val\n  ue 0x3A, cannot be included in a name.\n     at System.Xml.XmlConvert.VerifyNCName(String name, ExceptionType exceptionTyp\n  e)\n     at System.Xml.Linq.XName..ctor(XNamespace ns, String localName)\n     at System.Xml.Linq.XNamespace.GetName(String localName)\n     at System.Xml.Linq.XName.Get(String expandedName)</p>\n</blockquote>\n\n<p>Thank you for help!;)</p>\n"},{"tags":["c#","sql-server","linq","entity-framework","date"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13076094,"title":"How to query a date range from a varchar column using LINQ","body":"<p>I have inherited a large SQL Server database that has a certain table that has a certain date column that is a varchar(8) datatype in the <strong>yyyyMMdd</strong> date string format. Why it isn't a datetime datatype or something similar is beyond me. (maybe to save space? Legacy db ported to SQL Server long ago?)</p>\n\n<p>Withouting getting too flustered over the date wanna-be field, grabbing rows using a single date from this column is pretty straight forward using the Entity Framework (DBContext w/LINQ) as shown below:</p>\n\n<pre><code>var rows = cxt.TableOfRandomDateColumn.Where(x =&gt; x.Date == myDateStr).ToList();\n</code></pre>\n\n<p>That's about as easy as it gets. However, what if I wanted to grab a range of dates from this column? What would be the best way to go about doing something like that?</p>\n"},{"tags":["asp.net-mvc","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13074786,"title":"pass a linq query with group by to view [errors out]","body":"<p>I got this in the controller </p>\n\n<pre><code>var tobi = (from a in db.Assessments\njoin u in db.Users on a.rated equals u.user_id\njoin tm in db.Team_Members on u.user_id equals tm.user_id\njoin t in db.Teams on tm.team_id equals t.team_id\nwhere (tm.end_date == null || tm.end_date &gt; DateTime.Today)\ngroup new TobiViewModel\n{\n    teamname = t.name,\n    assessed_due = a.assessed_due,\n    assessment_id = a.assessment_id,\n    rater = a.rater,\n    rated = a.rated\n}\nby new { t.name, a.rated }).ToList();\n\nreturn View(tobi);\n</code></pre>\n\n<p>But then it doesn't accept it in the view?</p>\n\n<blockquote>\n  <p>The model item passed into the dictionary is of type\n  'System.Collections.Generic.List<code>1[System.Linq.IGrouping</code>2[&lt;>f__AnonymousType10<code>2[System.String,System.String],Kyubu.ViewModels.TobiViewModel]]',\n  but this dictionary requires a model item of type\n  'System.Collections.Generic.IEnumerable</code>1[Kyubu.ViewModels.TobiViewModel]'.</p>\n</blockquote>\n\n<p>how should i pass this in the view. Any help would be appreciated\nThe type in the view is</p>\n\n<pre><code>@model IEnumerable&lt;Kyubu.ViewModels.TobiViewModel&gt;\n</code></pre>\n"},{"tags":["c#",".net","vb.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":70,"score":-1,"question_id":13075218,"title":"Comparing two lists(of Integer) for equality","body":"<p>I know this very similar question has been asked before quite a few times such as in <a href=\"http://stackoverflow.com/questions/50098/comparing-two-collections-for-equality\">Comparing two collections for equality</a>, but I'm trying to use the solutions I'm reading there and something is not working... This HAS to be a stupid mistake I'm making... Please help!!</p>\n\n<p>Ok, so, here's my scenario, suppose I have the following 3 lists created in code:</p>\n\n<pre><code>Dim lst1 as new list(of integer)\nDim lst2 as new list(of integer)\nDim lst3 as new list(of integer)\n</code></pre>\n\n<p>And then, within the code I end up with, say, the following values in the lists:</p>\n\n<pre><code>lst1:    lst2:    lst3:\n1        1        2\n2        2        3\n3        3        4\n4        4        5\n</code></pre>\n\n<p>So, obviously, lst1 &amp; lst2 are equal and lst1 &amp; lst3 are not, but what code can I write into my if statement to verify this?</p>\n\n<p>I've tried:</p>\n\n<pre><code>lst1.SequenceEqual(lstXX)\n</code></pre>\n\n<p>And that returns <strong>True</strong> for both lst2 and lst3\nI've tried:</p>\n\n<pre><code>lst1.Equals(lstXX)\n</code></pre>\n\n<p>And that returns <strong>False</strong> for both lst2 and lst3</p>\n\n<p>Now, I know I could do it with code comparing count and lst1.Except(lstXX), but I'm wondering more so what I'm doing wrong here and even more importantly, what is the most efficient method to do this??</p>\n\n<p>Thanks!!!</p>\n"},{"tags":["vb.net","linq","methods","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13074408,"title":"VB.NET Lambda Does Not Call Method","body":"<p>I'm currently writing a wrapper object for a series of database result sets.  In so doing, I've noticed a problem when querying with <em>LINQ</em> and <em>Lambda</em> expressions.  Specifically, calling a method within the lambda seems to always make the result set empty and never actually fires the method I'm attempting to filter with.  Here's the code:</p>\n\n<pre><code>' Query and filter container results \nPublic Function [Filter](pFilter As IFilter(Of T)) As System.Linq.IQueryable(Of T)\n    ' THIS YIELDS AN EMPTY SET EVEN WHEN pFilter.Test(o) ALWAYS RETURNS TRUE\n    Dim lResult As System.Linq.IQueryable(Of T) = mTable.Where(Function(o As T) pFilter.Test(o))\n\n    Return lResult\nEnd Function\n</code></pre>\n\n<p>pFilter implements IFilter with this signature:</p>\n\n<pre><code>Public Interface IFilter(Of T)\n    Function Test(ByVal pObject As T) As Boolean\nEnd Interface\n</code></pre>\n\n<p>I've break pointed <code>pFilter.Test(o)</code> and found it is never actually called.  Oddly enough, if I replace <code>pFilter.Test(o)</code> with True, I receive the entire table of records as expected.  Also, I receive no compile time or run time errors in any case.</p>\n\n<p>I'm pretty new to <em>Lambdas</em> and <em>LINQ</em> so fully recognize I may not understand the limits of what I am attempting to accomplish.  Any help is greatly appreciated!</p>\n\n<p>SOLUTION:\nI've marked a solution already as the author got me on the right track.  The true nature of this problem stems from my attempting to force a .NET function into something LINQ could turn into an SQL statement (which is impossible).  To solve this, I've changed my IFilter to return System.Linq.Expressions.Expression(Of Func(Of T, Boolean)) for the Test method.  Now I can create strongly-typed filters which return predicates and pass them directly to Where() without the use of a lambda expression.  I'm also using <em>LinqKit</em> to make this work more easily for those who may be accomplishing similar tasks.  Thanks again for your help!</p>\n"},{"tags":["c#","linq","parsing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13075034,"title":"linq statement to select the first of n elements where there are multiple sequences","body":"<p>I'm trying to parse through some log-style information and I've created an <code>IEnumerable&lt;Log&gt;</code>. I'm pulling out all kinds of information, but I'm having a bit of trouble with one particular query.</p>\n\n<p>The Log class looks roughly like this: </p>\n\n<pre><code>public class Log \n{\n    public DateTime Time;\n    public string ProcessName;\n    public string Message;\n}\n</code></pre>\n\n<p>Processes kick off other processes that log to the same file, and I'm trying to re-create the tree structure of process execution. The problem is that there is no messages strictly indicating when a process started (though inspection shows that there will always be something logged before another process is started)... but there is on where it ended (message == \"ended ...\") <em>and</em> a process can execute more than once.</p>\n\n<p>So the log could look like:</p>\n\n<pre><code>9:30:00 AM P1 Arbitrary MSG\n9:30:00 AM P2 Arbitrary MSG\n9:30:00 AM P2 Ended\n9:30:00 AM P3 Arbitrary MSG\n9:30:00 AM P4 Arbitrary MSG\n9:30:00 AM P4 Ended\n9:30:00 AM P3 Ended\n9:30:00 AM P1 Ended\n10:30:00 AM P1 Arbitrary MSG\n10:40:00 AM P5 Ended\n10:40:00 AM P1 Ended\n</code></pre>\n\n<p>(note: times are chosen arbitrarily, but can execute quickly enough such that we don't see an increase in time in the log)</p>\n\n<p>... and the execution tree would look like this:</p>\n\n<ul>\n<li>P1\n<ul>\n<li>P2</li>\n<li>P3\n<ul>\n<li>P4</li>\n</ul></li>\n</ul></li>\n<li>P1\n<ul>\n<li>P5</li>\n</ul></li>\n</ul>\n\n<p>I'm working on an imperative solution that stacks which was the last process entered, but I'd like to see what a query would look like.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":75,"score":1,"question_id":13073713,"title":"Get a sublist using LINQ and select items depending on the timestamp","body":"<p>I have a list of:</p>\n\n<pre><code>class test\n{\n    name,\n    timestamp\n}\n</code></pre>\n\n<p>and I'd like to get all the last (newest) tests that have the same name. Many tests have same timestamp.</p>\n\n<p>Eg:</p>\n\n<pre><code>name1, 2012-10-25 3:00PM\nname1, 2012-10-25 3:00PM\nname2, 2012-10-25 3:05PM\nname2, 2012-10-25 3:05PM\nname1, 2012-10-25 3:10PM\nname1, 2012-10-25 3:10PM\nname2, 2012-10-25 3:15PM\nname2, 2012-10-25 3:15PM\n</code></pre>\n\n<p>I only need to get the last tests for each name:</p>\n\n<pre><code>name1, 2012-10-25 3:10PM\nname1, 2012-10-25 3:10PM\nname2, 2012-10-25 3:15PM\nname2, 2012-10-25 3:15PM\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":6,"up_vote_count":13,"down_vote_count":0,"view_count":8970,"score":13,"question_id":1381564,"title":"C# linq sort - quick way of instantiating IComparer","body":"<p>When using linq and you have </p>\n\n<pre><code>c.Sort()\n</code></pre>\n\n<p>Is there any good inline way of defining a <code>Comparison</code> and/or <code>IComparer</code> class without actually having to create a separate class?</p>\n"},{"tags":["c#",".net","xml","linq","linq-to-xml"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13073260,"title":"Extracting data from a complex XML with LINQ","body":"<p>My goal is to save the data contained in the ValueReference node, TimeInstant attribute, and timePosition node into variables. I am able to get the value of the valueReference node (the un-commented section works), but not the other two. \nAny help would be greatly appreciated.</p>\n\n<p>Here is the code that I am working on:</p>\n\n<pre><code>public void LinqToXml()\n{\n    XNamespace sosNamespace = XNamespace.Get(\"http://www.opengis.net/sos/2.0\");\n    XNamespace fesNamespace = XNamespace.Get(\"http://www.opengis.net/fes/2.0\");\n    XNamespace gmlNamespace = XNamespace.Get(\"http://www.opengis.net/gml/2.0\");\n    var root = XElement.Load(@\"C:\\Working Directory\\OGCSOS.Service\\OGCSOS.Service\\Resources\\GetObservation_TemporalFilter.xml\");\n    var a = (from level in root.Descendants(sosNamespace + \"temporalFilter\")\n             select new\n             {\n                 valueReference = (string)level.Descendants(fesNamespace + \"After\")\n                                               .Elements(fesNamespace + \"ValueReference\")\n                                               .First(),\n                 /*timeInstant = (string)level.Descendants(fesNamespace + \"After\")\n                                               .Elements(gmlNamespace + \"TimeInstant\")\n                                               .Attributes(gmlNamespace + \"id\")\n                                               .First()*/\n                 /*timePosition = (string)level.Descendants(fesNamespace + \"After\")\n                                             .Elements(gmlNamespace + \"TimeInstant\")\n                                             .First()*/\n             }).ToList();\n</code></pre>\n\n<p>And here is the XML I am trying to read: </p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;sos:GetObservation xmlns=\"http://www.opengis.net/sos/2.0\" service=\"SOS\" version=\"2.0.0\" \n                    xmlns:sos=\"http://www.opengis.net/sos/2.0\" xmlns:fes=\"http://www.opengis.net/fes/2.0\" \n                    xmlns:gml=\"http://www.opengis.net/gml/3.2\" xmlns:swe=\"http://www.opengis.net/swe/2.0\" \n                    xmlns:swes=\"http://www.opengis.net/swes/2.0\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.opengis.net/sos/2.0\nhttp://schemas.opengis.net/sos/2.0/sos.xsd\"&gt;\n\n    &lt;!--identifier of an offering--&gt;\n    &lt;offering&gt;HG.Logger@DJK001&lt;/offering&gt;\n\n    &lt;!--identifier of an observed property--&gt;\n    &lt;observedProperty&gt;HG&lt;/observedProperty&gt;\n\n    &lt;!--optional temporal filter restricting the results which shall be returned--&gt;\n    &lt;temporalFilter&gt;\n        &lt;fes:After&gt;\n            &lt;fes:ValueReference&gt;phenomenonTime&lt;/fes:ValueReference&gt;\n            &lt;gml:TimeInstant gml:id=\"startPosition\"&gt;\n                &lt;gml:timePosition&gt;2008-03-01T17:44:15.000+00:00&lt;/gml:timePosition&gt;\n            &lt;/gml:TimeInstant&gt;\n        &lt;/fes:After&gt;\n    &lt;/temporalFilter&gt;\n\n    &lt;featureOfInterest&gt;DJK001&lt;/featureOfInterest&gt;\n\n&lt;/sos:GetObservation&gt;\n</code></pre>\n"},{"tags":["c#","asp.net","sql-server","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13072770,"title":"Query on two DataTable to find duplicate rows","body":"<p>I have an excel sheet which i am uploading to sqlserver table using sqlbulkcopy, i have applied an index on database table so that duplicate entries are ignored but i also want to display the duplicate entries which were ignored in a grid view.</p>\n\n<pre><code>  protected void Button1_Click(object sender, EventArgs e)\n{\n    string strFileType = System.IO.Path.GetExtension(FileUpload1.FileName).ToString().ToLower();\n    string strFileName = FileUpload1.PostedFile.FileName.ToString();\n\n    FileUpload1.SaveAs(Server.MapPath(\"~/Import/\" + strFileName + strFileType));\n    string strNewPath = Server.MapPath(\"~/Import/\" + strFileName + strFileType);\n\n\n\n\n\n\n        string excelConnectionString = String.Format(@\"Provider=Microsoft.Jet.OLEDB.4.0;\" + \"Data Source=\"+strNewPath +\"; Extended Properties=Excel 8.0;\");\n\n    //string excelConnectionString = String.Format(@\"Provider=Microsoft.Jet.OLEDB.4.0;\" + \"Data Source=C:\\\\myFolder\\\\Book1.xls;\" + \"Extended Properties=Excel 8.0;\"); \n\n\n        // Create Connection to Excel Workbook\n        using (OleDbConnection connection = new OleDbConnection(excelConnectionString))\n        {\n            connection.Open();\n            OleDbCommand command = new OleDbCommand(\"Select ID,Data FROM [Sheet1$]\", connection);\n            OleDbCommand command1 = new OleDbCommand(\"select count(*) from [Sheet1$]\",connection);\n\n            //Sql Server Table DataTable\n            DataTable dt4=new DataTable();\n            SqlCommand cmd4 = new SqlCommand(\"select id,data from ExcelTable\", con);\n            try \n                { \n                    SqlDataAdapter da4 = new SqlDataAdapter(cmd4); \n                    da4.Fill(dt4);//sql table datatable\n                 }\n                catch { }\n\n\n            //excelsheet datatable\n            DataTable oltlb = new DataTable();\n          OleDbCommand olcmd = new OleDbCommand(\"select id,data from [Sheet1$]\", connection);\n          try\n          {\n              OleDbDataAdapter olda = new OleDbDataAdapter(olcmd);\n              olda.Fill(oltlb); //excel table datatable\n          }\n          catch { }\n\n    var matched = (from table1 in dt4.AsEnumerable()\n                         join table2 in oltlb.AsEnumerable() on\n                       table1.Field&lt;int&gt;(\"ID\") equals table2.Field&lt;int&gt;(\"ID\")\n                         where table1.Field&lt;string&gt;(\"Data\") == table2.Field&lt;string&gt;(\"Data\")\n                         select table1);\n          DataTable dthi5 = new DataTable();\n          dthi5 = matched.CopyToDataTable();\n\n          GridView1.DataSource = dthi5;\n          GridView1.DataBind();\n            GridView1.DataSource = matched.ToList();\n</code></pre>\n\n<p>ERROR:\nSpecified cast is not valid.\ntable1.Field(\"ID\") equals table2.Field(\"ID\")</p>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":51,"score":-1,"question_id":13053834,"title":"Some confusion with conversion of FROM clauses into a call to SelectMany","body":"<p>Two subsequent <em>FROM</em> clauses get translated into a call to <code>SelectMany</code>. </p>\n\n<p>a) </p>\n\n<pre><code>var query = from c_1 in collection_1\n            from c_2  in collection_2 \n            from c_3 in collection_3\n            select ...\n</code></pre>\n\n<p>Correct me if I'm wrong, but I think query expression gets translated into a code semantically equivalent to: </p>\n\n<pre><code>collection_1.SelectMany(c_1 =&gt; c_1.collection_2.\n               SelectMany(c_2 =&gt; c_2.collection_3.\n                     Select(c_3 =&gt;  ... )));\n</code></pre>\n\n<p>Is <code>from c_3 in collection</code>  always \"<em>bound</em>\" to <code>c_2</code> range variable? With the term \"<em>bound</em>\" I'm asking whether the entire <code>collection_3</code> gets enumerated for each <code>c_2</code> element?</p>\n\n<p>b) Assuming I'm correct under <strong><em>a)</em></strong>, is <code>c_3</code> always \"<em>bound</em>\" to range variable defined closest to it? </p>\n\n<p>c) If answer to <strong><em>b)</em></strong> is true, then <code>c_3</code> is bound to <code>c_2</code> even in the following example:</p>\n\n<pre><code>var query = from c_1 in collection_1\n            from c_2  in collection_2 \n            where ...\n            from c_3 in collection_3\n</code></pre>\n\n<p>d) Is in next query <code>c_3</code> bound to <code>a</code> ( ie for each <code>a</code> the entire <code>groupAandB</code> will be enumerated ):</p>\n\n<pre><code>var query_1 =  from a in groupA\n               join b in groupB on a equals b\n                  into groupAandB\n               from c_3 in groupAandB\n               select c_3;\n</code></pre>\n\n<p>e) Here I'm assuming that answer to <strong><em>d)</em></strong> is that <code>c_3</code> is indeed bound to <code>a</code>. But when looking at the code into which <code>query_1</code> is translated at compile time, we could instead argue that <code>c_3</code> is actually bound to anonymous type <code>a_1</code> ( ie <code>new { a, groupAandB = os }</code> )?! </p>\n\n<pre><code>groupA.GroupJoin(groupB, a =&gt; a, b =&gt; b, (a, os) =&gt; new { a, groupAandB = os } ).\n             SelectMany(a_1 =&gt; a_1.groupAandB );\n</code></pre>\n\n<p>f) Keeping in my mind into what <code>query_1</code> gets translated, couldn't we argue that any assumptions I made under <strong><em>d)</em></strong> are perhaps conceptually correct, but technically wrong, since at compile time there isn't any <code>c_3</code> variable, or perhaps there is <code>c_3</code> defined somewhere under the hood, but it is actually bound to an <em>anonymous type</em> and not to <code>a</code>? </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>1)</p>\n\n<blockquote>\n  <p>with Join, the \"second\" collection can't depend on which value you're\n  currently \"looking at\" from the first collection,</p>\n</blockquote>\n\n<p>a) I assume you essentially mean that we can't join <code>customers</code> to a collection ( ie <code>c.Orders</code> ) returned by current value of <code>c</code> :</p>\n\n<pre><code>var query1 = from c in customers\n             join o in c.Orders on c.CustomerId equals o.OrderID // this won't work\n             select new { c.Name, o.OrderID, o.OrderDate };\n</code></pre>\n\n<p>b) Btw, why is such a join not allowed ( I'm assuming it would be technically feasible to make such a join ) or perhaps why it doesn't make sense?</p>\n\n<p>2)</p>\n\n<blockquote>\n  <p>\"The C# specification gives the explicit transformation involved\"</p>\n</blockquote>\n\n<p>Could you elaborate what you mean by <em>\"explicit transformation involved\"</em> and how it relates to <strong><em>e)</em></strong> and <strong><em>f)</em></strong> questions? </p>\n\n<p>thank you</p>\n"},{"tags":["asp.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13065373,"title":"How can get a result of a linq stored procedure into a label which is scalar","body":"<p>I have created an aspx page and i am passing name to a textbox which has to display a message saying that the <code>user</code> exists in the database. For this i took a linq and wrote a stored procedure in it(<code>Select username from logintest where username=@name</code>). </p>\n\n<p>I want the output of a stored procedure into a label.</p>\n\n<p>Can anyone help me to solve this?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#",".net","linq","vb.net-to-c#"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":208,"score":0,"question_id":1430432,"title":"Translate this VB.NET LINQ statement to C#, having trouble","body":"<pre><code>If Not IsPostBack Then\n    Dim q = From f In System.Drawing.FontFamily.Families _\n            Select f.Name\n    ListBox1.DataSource = q\n    ListBox1.DataBind()\nEnd If\n</code></pre>\n\n<p>I'm new to <a href=\"http://en.wikipedia.org/wiki/Language_Integrated_Query\" rel=\"nofollow\">LINQ</a>, and I'm following a <a href=\"http://en.wikipedia.org/wiki/Visual_Basic_.NET\" rel=\"nofollow\">VB.NET</a> tutorial, so I don't know LINQ in C#. How can this be translated to C#?</p>\n"},{"tags":["linq","compilation","crm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12694658,"title":"How do you compile LINQ queries against CRM 2011?","body":"<p>How do you compile LINQ queries against CRM 2011?</p>\n\n<p>I'm connecting to CRM 2011 using the Microsoft.Xrm.Client.dll and use a Microsoft.Xrm.Client.CrmOrganizationServiceContext _SvcContext which is generated from a connectionstring in the app.config file. I have the following LINQ query which works great:</p>\n\n<pre><code>var vdiConfigDataSet = \n   (from SvrToPubProfSet in _SvcContext.vdi_publicationprofile_vdi_serverSet\n    join PubProfSet in _SvcContext.vdi_publicationprofileSet\n    on SvrToPubProfSet.vdi_publicationprofileid equals PubProfSet.Id\n    join SvrSet in _SvcContext.vdi_serverSet\n    on SvrToPubProfSet.vdi_serverid equals SvrSet.Id\n    where SvrSet.vdi_address == System.Environment.MachineName // This will ignore case\n\n    select new\n      {\n        // Data from Server record\n        RootPath = SvrSet.vdi_rootpath, // This is the same for all Publication Profiles\n        SvrAddr = SvrSet.vdi_address,\n\n        // Data from N:N relationship record(s) vdi_publicationprofile_vdi_serverSet\n        SvrId = SvrToPubProfSet.vdi_serverid,\n        PubProfId = SvrToPubProfSet.vdi_publicationprofileid,\n\n        // Data from Publication Profile record(s)\n        PubProfName = PubProfSet.vdi_name,\n        RelativePath = PubProfSet.vdi_relativepath,\n        ReportRelativePath = PubProfSet.vdi_reportrelativepath,\n        ReportFilenameSeed = PubProfSet.vdi_reportfilenameseed,\n        SubSystemType = PubProfSet.vdi_subsystemtype,\n        ModifiedOn = PubProfSet.ModifiedOn\n      }).ToList();\n</code></pre>\n\n<p>This is quite a large query which gets executed repeatedly. I want to compile it down. I have tried the following:</p>\n\n<pre><code>public static readonly Func&lt;DataContext, Object&gt; s_compiledQuery =\n  CompiledQuery.Compile&lt;DataContext, Object&gt;\n  (ctx  =&gt;\n  (from SvrToPubProfSet in ctx.GetTable&lt;vdi_publicationprofile_vdi_server&gt;()\n   join PubProfSet in ctx.GetTable&lt;vdi_publicationprofile&gt;()\n   on SvrToPubProfSet.vdi_publicationprofileid equals PubProfSet.Id\n   join SvrSet in ctx.GetTable&lt;vdi_server&gt;()\n   on SvrToPubProfSet.vdi_serverid equals SvrSet.Id\n   where SvrSet.vdi_address == System.Environment.MachineName // This will ignore case\n\n   select new\n   {\n     // Data from Server record\n     RootPath = SvrSet.vdi_rootpath, // This is the same for all Publication Profiles\n     SvrAddr = SvrSet.vdi_address,\n\n     // Data from N:N relationship record(s) vdi_publicationprofile_vdi_serverSet\n     SvrId = SvrToPubProfSet.vdi_serverid,\n     PubProfId = SvrToPubProfSet.vdi_publicationprofileid,\n\n     // Data from Publication Profile record(s)\n     PubProfName = PubProfSet.vdi_name,\n     RelativePath = PubProfSet.vdi_relativepath,\n     ReportRelativePath = PubProfSet.vdi_reportrelativepath,\n     ReportFilenameSeed = PubProfSet.vdi_reportfilenameseed,\n     SubSystemType = PubProfSet.vdi_subsystemtype,\n     ModifiedOn = PubProfSet.ModifiedOn\n   }).ToList());\n...\n\nvar vdiConfigDataSet2 = s_compiledQuery(_SvcContext); //ERROR _SvcContext is not DataContext type\n</code></pre>\n\n<p>but I need a <code>DataContext</code> type object and I don't know how to get that from the <code>Microsoft.Xrm.Client.CrmOrganizationServiceContext</code> type object.</p>\n\n<p>Anyone have any ideas how to get the <code>DataContext</code> or perhaps a more elegant solution on compiling LINQ queries for CRM 2011?</p>\n"},{"tags":["c#","linq","linq-to-sql","iqueryable"],"answer_count":4,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":82,"score":9,"question_id":13071622,"title":"Is there an api or extension to translate IQueryable<T> lambda expressions to SQL strings?","body":"<p>I was reading an article on <a href=\"http://weblogs.asp.net/dixin/archive/2010/05/12/understanding-linq-to-sql-10-implementing-linq-to-sql-provider.aspx\">Linq to Sql</a> and came across this:</p>\n\n<pre><code>IQueryProvider provider = new QueryProvider(database.GetCommand, database.ExecuteQuery);\nIQueryable&lt;Product&gt; source = new Queryable&lt;Product&gt;(provider, database.GetTable&lt;Product&gt;());\nIQueryable&lt;string&gt; results = source.Where(product =&gt; product.CategoryID == 2)\n                                   .OrderBy(product =&gt; product.ProductName)\n                                   .Select(product =&gt; product.ProductName)\n                                   .Skip(5)\n                                   .Take(10);\n</code></pre>\n\n<p>The author then translated the results in plain sql:</p>\n\n<pre><code>exec sp_executesql N'SELECT [t1].[ProductName]\nFROM (\nSELECT ROW_NUMBER() OVER (ORDER BY [t0].[ProductName]) AS [ROW_NUMBER], [t0].[ProductName]\nFROM [dbo].[Products] AS [t0]\nWHERE [t0].[CategoryID] &gt; @p0\n) AS [t1]\nWHERE [t1].[ROW_NUMBER] BETWEEN @p1 + 1 AND @p1 + @p2\nORDER BY [t1].[ROW_NUMBER]',N'@p0 int,@p1 int,@p2 int',@p0=2,@p1=5,@p2=10\n</code></pre>\n\n<p>And I thought to myself, \"holy cow! wouldn't it be great if there was an extension to IQueryable that would generate these strings for you when debugging?\"</p>\n\n<p>Anyone ever heard of anything like this, and if so, could you point me in the right direction?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":5,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13071786,"title":"Linq to Entitites query cannot convert Int to String","body":"<p>I am making a search index. I got it working pretty good but I cannot incorporate ItemID (item numbers) in my search because i am having trouble converting the String in the TextBox.Text to a int in order for it to be a comparable type. </p>\n\n<pre><code>var q = (from t0 in db.Item\n         join t1 in db.Categories on t0.CategoryID equals t1.CategoryID\n         join t2 in db.Divisions on t0.DivisionID equals t2.DivisionID\n         where t0.DivisionID == DDLInt &amp;&amp;\n         //Contains\n         (t0.ItemName.Contains(txtSearch.Text.Trim()) ||\n         t0.Email.Contains(txtSearch.Text.Trim()) ||\n         t0.Description.Contains(txtSearch.Text.Trim()) ||\n         t0.Phone.Contains(txtSearch.Text.Trim()) ||\n         t0.ItemID.Equals(txtSearch.Text.Trim())) \n               // ^ This is the line where  \n               //   it breaks because it is not a comparable type\n         group t0 by new\n         {\n</code></pre>\n\n<p>I am not sure how to convert or parse it and still have the search work properly. </p>\n"},{"tags":["visual-studio-2010","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13071240,"title":"This linq query is going out of index after the Visual studio update","body":"<pre><code>var temp = this.ObjectContext.ActiveDepViews\n    .Where(p =&gt; p.id== id)\n    .Join(this.ObjectContext.Departments.Where(p =&gt; p.ida == ida),\n        p =&gt; p.Id, q =&gt; q.Id,\n        (p, q) =&gt; new { ActiveDepViews = p})\n    .Select(p =&gt; p.ActiveDepViews)\n    .OrderBy(p =&gt; p.Name)\n    .ToList();\n</code></pre>\n\n<p>This query was working up until I updated Visual Studio. Now it's giving me an index out of bound error. </p>\n\n<p>I checked the data and it's all there &mdash; it doesn't make any sense.</p>\n\n<p>Can anyone tell me how to revert my update on Visual Studio 2010?</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":63,"score":2,"question_id":13053280,"title":"Populate a C# class from a dataset with multiple linked tables using linq lambda","body":"<p>I'm trying to populate a list (<code>lstContractor</code>) of a C# class (<code>contractor</code>), containing fields and lists, from a <code>DataSet</code> returned from SQL. The <code>DataSet</code> returns multiple tables, linked by an id.</p>\n\n<p>I've managed to get it all working except 1 field, which is the only field I need from the table it is in.  When I'm trying to select it using LINQ, I'm getting <code>System.Data.EnumerableRowCollection</code>1[System.String]` instead of the contents of the field.</p>\n\n<p>My Code looks like this:</p>\n\n<pre><code>    lstContractor = dsContractor.Tables[0].AsEnumerable().Select(contractor =&gt; new Contractor\n    {\n        intContractorId = contractor.Field&lt;int&gt;(\"ID\"),\n        strFirstName = contractor.Field&lt;string&gt;(\"FirstName\"),\n        strLastName = contractor.Field&lt;string&gt;(\"LastName\"),\n        strProfile = dsContractor.Tables[7].AsEnumerable().Where(profile =&gt; profile.Field&lt;int&gt;(\"ContractorId\") == contractor.Field&lt;int&gt;(\"Id\")).\n            Select(profile =&gt; profile.Field&lt;string&gt;(\"ContractorProfile\")).ToString(),\n        // populate addresses\n        Address = dsContractor.Tables[6].AsEnumerable().Where(address =&gt; address.Field&lt;int&gt;(\"ContractorId\") == contractor.Field&lt;int&gt;(\"Id\")).\n                Select(address =&gt; new Address\n                {\n                    intId = address.Field&lt;int&gt;(\"ContractorId\"),\n                    strAddressLine1 = address.Field&lt;string&gt;(\"AddressLine1\"),\n                    strAddressLine2 = address.Field&lt;string&gt;(\"AddressLine2\"),\n                    strAddressLine3 = address.Field&lt;string&gt;(\"AddressLine3\"),\n                    strAddressLine4 = address.Field&lt;string&gt;(\"AddressLine4\"),\n                    strAddressLine5 = address.Field&lt;string&gt;(\"AddressLine5\"),\n                    strPostCode = address.Field&lt;string&gt;(\"PostCode\")\n                }).ToList&lt;Address&gt;(),\n\n        // populate industries\n        Industry = dsContractor.Tables[1].AsEnumerable().Where(Industry =&gt; Industry.Field&lt;int&gt;(\"ContractorId\") == contractor.Field&lt;int&gt;(\"Id\")).\n            Select(target =&gt; new Industry\n            {\n                intId = target.Field&lt;int&gt;(\"ContractorId\"),\n                strIndustryName = target.Field&lt;string&gt;(\"IndustryName\")\n            }).ToList&lt;Industry&gt;(),\n\n        // populate key skills\n        KeySkill = dsContractor.Tables[2].AsEnumerable().Where(KeySkill =&gt; KeySkill.Field&lt;int&gt;(\"ContractorId\") == contractor.Field&lt;int&gt;(\"Id\")).\n            Select(target =&gt; new KeySkill\n            {\n                intId = target.Field&lt;int&gt;(\"ContractorId\"),\n                strKeySkillName = target.Field&lt;string&gt;(\"KeySkillName\")\n            }).ToList&lt;KeySkill&gt;(),\n\n        // populate email addresses\n        EmailAddress = dsContractor.Tables[3].AsEnumerable().Where(EmailAddress =&gt; EmailAddress.Field&lt;int&gt;(\"ContractorId\") == contractor.Field&lt;int&gt;(\"Id\")).\n            Select(target =&gt; new EmailAddress\n            {\n                intId = target.Field&lt;int&gt;(\"ContractorId\"),\n                strEmailAddress = target.Field&lt;string&gt;(\"EmailAddress\"),\n                strEmailType = target.Field&lt;string&gt;(\"EmailType\")\n            }).ToList&lt;EmailAddress&gt;(),\n\n        // populate phone numbers\n        PhoneNumber = dsContractor.Tables[4].AsEnumerable().Where(PhoneNumber =&gt; PhoneNumber.Field&lt;int&gt;(\"ContractorId\") == contractor.Field&lt;int&gt;(\"Id\")).\n            Select(target =&gt; new PhoneNumber\n            {\n                intId = target.Field&lt;int&gt;(\"ContractorId\"),\n                strPhoneNumberType = target.Field&lt;string&gt;(\"PhoneType\"),\n                strPhoneNumber = target.Field&lt;string&gt;(\"PhoneNumber\")\n            }).ToList&lt;PhoneNumber&gt;(),\n\n        Geography = dsContractor.Tables[5].AsEnumerable().Where(PhoneNumber =&gt; PhoneNumber.Field&lt;int&gt;(\"ContractorId\") == contractor.Field&lt;int&gt;(\"Id\")).\n                Select(target =&gt; new Geography\n                {\n                    intId = target.Field&lt;int&gt;(\"ContractorId\"),\n                    strGeography = target.Field&lt;string&gt;(\"GeographyName\")\n                }).ToList&lt;Geography&gt;(),\n\n\n    }).ToList&lt;Contractor&gt;();\n</code></pre>\n\n<p>the class looks like this:</p>\n\n<pre><code>    public int intContractorId;\npublic string strFirstName;\npublic string strMiddleName;\npublic string strLastName;\npublic string strDescription; \npublic DateTime dtDOB;\npublic string strGender;\npublic string strProfile;\npublic int intIsFullTime;\npublic int intWorkMonday;\npublic int intWorkTuesday;\npublic int intWorkWednesday;\npublic int intWorkThursday;\npublic int intWorkFriday;\npublic int intWorkSaturday;\npublic int intWorkSunday;\npublic DateTime dtAvailableFrom;\npublic int intActive;\npublic decimal dcSubscrptionCost;\npublic DateTime dtRenewalDate;\npublic List&lt;Address&gt; Address;\npublic List&lt;EmailAddress&gt; EmailAddress;\npublic List&lt;PhoneNumber&gt; PhoneNumber;\npublic List&lt;KeySkill&gt; KeySkill;\npublic List&lt;Geography&gt; Geography;\npublic List&lt;Industry&gt; Industry;\npublic List&lt;SubIndustry&gt; SubIndustry;\n</code></pre>\n\n<p>The field in question is <code>strProfile</code>, but I can't for the life of me figure out why I'm getting the contents that I am, instead of the string the the field contains.</p>\n\n<p>I've checked in debug mode, and the correct data is in the <code>DataSet</code>.</p>\n\n<p>Please let me know if I've missed anything.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":93,"score":0,"question_id":13039783,"title":"How do you convert IEnumerable<int> to an Int32","body":"<p>I've got a linq query that will return 1 result which will be an integer. I want to assign this to an Int32 variable to be used later, however I get an error that reads, \"int does not contain a definition for RatingNumber and no extension method RatingNumber acepting a first argument of type int could be found (are you missing a using directive or an assembly reference?)</p>\n\n<p>this is the code that calls the query</p>\n\n<pre><code>IEnumerable&lt;int&gt; newRatingNumber = getNewRecipeNumbers.newRatingNum();\n\n        foreach (var a in newRatingNumber)\n        {\n            ratingNumber = a.RatingNum;\n        }\n</code></pre>\n\n<p>and this is the query:</p>\n\n<pre><code> public IEnumerable&lt;int&gt; newRatingNum()\n    {\n        ratingTableAdapter.Fill(recipeDataSet.Rating);\n        var newRatingNum = (from a in recipeDataSet.Rating\n                            where a.UserRating == 0 &amp;&amp;\n                            a.FamilyRating == 0 &amp;&amp;\n                            a.HealthRating == 0 &amp;&amp;\n                            a.EaseOfCooking == 0 &amp;&amp;\n                            a.CookingTime == 0\n                            select a.RatingNum);\n        return newRatingNum;\n    }\n</code></pre>\n\n<p>I tried using Convert.ToInt32 to cast the result to an int, this got rid of compiling errors, this however created an InvalidCastException. Anyone have any ideas?</p>\n\n<p>Thanks for the help</p>\n\n<p>Craig</p>\n"},{"tags":["c#","linq","dynamic-linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13046211,"title":"Dynamic Linq Datetime where","body":"<p>im using dynamic linq in order to build a query  and im having an issue with <strong>DateTime</strong></p>\n\n<ul>\n<li><p>queryResults- contain a list of result from a previous  query .</p></li>\n<li><p>sr.FromDate- a DateTime parameter </p></li>\n</ul>\n\n<p>what im trying to do is to get the all the result that greater and equal to the sr.FromDate parameter </p>\n\n<pre><code>var z = queryResults\n            .Where(\"Min(Datetime) &gt;= @0\", sr.FromDate)\n            .ToDictionary(g =&gt; g.FirstOrDefault().ServiceInstanceId, g =&gt; g.ToList());\n</code></pre>\n\n<p>exeption:</p>\n\n<pre><code>ParseError  ,    '.' or '(' expected\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>just to Clarify we im using dynamic linq   <strong>SR</strong> object contains string int and date parameters \nif the values of the parameters isnt null im building a query</p>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>i figure out my privus problem  but now i have another problem , im using this in order to build the query</p>\n\n<pre><code>  private static string GetQueryTemplet(string criteria)\n    {\n\n        switch (criteria)\n        {\n\n            case \"FromDate\":\n                return \" Min(Track.Datetime) &gt;= {0} \";\n            case \"ToDate\":\n                return \" Max(Track.Datetime) &lt;=  {0} \";\n\n             default:\n                return \"\";\n        }\n</code></pre>\n\n<p>than im passing the data to  </p>\n\n<pre><code> var z = queryResolts\n             .Where(query)\n            .ToDictionary(g =&gt; g.Key, g =&gt; g.Select(h =&gt; h.Track));\n</code></pre>\n\n<p>for some reason im getting this exception </p>\n\n<pre><code>Operator '&gt;=' incompatible with operand types 'DateTime' and 'Int32'\n</code></pre>\n\n<p>i tried to parse it in many ways but nothing work ... </p>\n\n<p>thanks \nmiki</p>\n"},{"tags":["linq","entity-framework-4","foreach"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13069813,"title":"Update object in foreach loop","body":"<p>I am using EF4/LINQ for the first time and have run into an issue.  I am looping thru the results of a LINQ query using a foreach loop as follows:</p>\n\n<pre><code>   private static void OnTimedEvent(object source, ElapsedEventArgs e) \n   {\n      CallOutcomeSubmission los = new CallOutcomeSubmission();      \n      client = connectToService();\n\n      try\n      {\n         using (var context = new CallOutcomeContext())\n         {\n            // List of available actions\n            private static string ACTION_CALL_ATTEMPT = \"Call Attempt\";\n            DateTime oneDayAgo = DateTime.Now.AddHours(-24);\n            var query = from co in context.T_MMCallOutcome\n                        join ca in context.T_Call on co.CallID equals ca.CallID\n                        join lv in context.T_LeadVendorEmailHeader on co.LeadVendorEmailID equals lv.LeadVendorEmailID\n                        where co.EnteredOn &gt; oneDayAgo &amp;&amp; co.MMLeadActionID == null\n                        select new\n                        {\n                            co.CallOutcomeID,\n                            co.CallID,\n                            co.LeadVendorEmailID,\n                            MMLeadID = lv.email_text,\n                            ca.OutcomeID,\n                            lv.FranchiseNumber,\n                            co.MMLeadActionID,\n                            co.LeadAction\n                        };\n\n            // if any results found for query\n            if (query.Any())\n            {\n               foreach (var call in query.ToList())\n               {\n                  // if the franchise exists \n                  if (client.FranchiseExists(int.Parse(call.FranchiseNumber)))\n                  {\n                     switch (call.OutcomeID)\n                     {\n                        case 39:    // Not Answered\n                           call.LeadAction = ACTION_CALL_ATTEMPT;  \n                           break;\n                        case 43:    // Remove from Call List\n                           break;\n                        default:    // If the OutcomeID is not identified in the case statement\n                           break;\n                     }  // switch\n\n                  }\n                  else\n                  {\n                     los.eventLog.WriteEntry(\"CallOutcomeSubmission.OnTimedEvent: No franchise found with franchise ID \" + call.FranchiseNumber);\n                  }\n\n                  // Save any changes currently on context\n                  context.SaveChanges();\n\n               }  // foreach\n\n            }\n\n            // if no results found from query write system log stating such\n            else \n            {\n               los.eventLog.WriteEntry(\"CallOutcomeSubmission.OnTimedEvent: No new entries found\");\n            }\n         }  // using\n\n         client.Close();\n      }\n      catch (System.TimeoutException exception)\n      {\n         los.eventLog.WriteEntry(\"CallOutcomeSubmission.OnTimedEvent:\" + exception.ToString());\n                    client.Abort();\n      }\n      catch (System.ServiceModel.CommunicationException exception)\n      {\n         los.eventLog.WriteEntry(\"CallOutcomeSubmission.OnTimedEvent:\" + exception.ToString());\n                    client.Abort();\n      }\n    }\n</code></pre>\n\n<p>When I try to do the assignment:</p>\n\n<pre><code>call.LeadAction = ACTION_CALL_ATTEMPT; \n</code></pre>\n\n<p>I get a build error of </p>\n\n<pre><code>Property or indexer 'AnonymousType#2.LeadAction' cannot be assigned to -- it is read only   \n</code></pre>\n\n<p>I can't seem to find anything on this specific error doing a Google search and am not sure what I am doing wrong.  Is it because the original query contains a join?  </p>\n\n<p>How can I do the assignment of call.LeadAction within the foreach loop?</p>\n\n<p>I would also like to know if there are design issue withe way I have written the query or performed any of the operations since this is my first foray into EF/LINQ.</p>\n"},{"tags":["linq","entity-framework-4",".net-4.5"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13055481,"title":"LINQ: Drill down to value in query results","body":"<p>I am using LINQ for the first time and have the following query:</p>\n\n<pre><code>var query = from c in context.Call\n            join d in context.CallData on c.CallID = d.CallID\n            where c.CallID == 123\n            select new {\n               c.CallID,\n               c.CallResult,\n               d.FieldID,\n               d.FieldValue\n            };\n</code></pre>\n\n<p>This returns data similar to the following</p>\n\n<pre><code>c.CallID    c.CallResult   d.FieldID    d.FieldValue\n  123         Sale           345          John\n  123         Sale           346          Doe\n  123         Sale           347          888-222-3333\n</code></pre>\n\n<p>How can drill down to the row containing d.FieldID = 346 to get the value of d.FieldValue (346 being the LastName field)?  I would like to use this value as the new value of a local variable:</p>\n\n<pre><code>// I know this doesn't work, just showing what I would like to accomplish\nstring LastName = query.Select(a =&gt; a.FieldID = 346).FieldValue;\n</code></pre>\n\n<p>Conversely, how can I change the value of c.CallResult once I have these results?  Since it is a join, can I simply change one row of data or do I have to do a separate query?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13068251,"title":"Using a type in linq","body":"<p>I have a large number of classes.\nFrom this list I get a specified type</p>\n\n<pre><code>Type aType = Type.GetType(...);\n</code></pre>\n\n<p>Now I want to use this type in a linq statement like:</p>\n\n<pre><code>var aResult = from obj in scope.Extent&lt;aType&gt;() select obj;\n</code></pre>\n\n<p>This does not seem to be possible, as Extent does not accept Type.</p>\n\n<p>Is there any way now (with .net 4.5) to call the statement?</p>\n\n<p>All I want to do is to say use Type as class. Don't invoke the class, only get with linq all objects of this type from a scope.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":53,"score":0,"question_id":13066367,"title":"Access each element in a list inside a where clause","body":"<p>I have a customer List and a string List where each string is like \"blah;huhu\";</p>\n\n<p>I want to get all customers whose name is in the last part of the splitted \"blah;huhu\"</p>\n\n<p>like <code>c.Name == \"huhu\"</code>.</p>\n\n<p>Thats my pseudo code:</p>\n\n<p>String ID = 1000;</p>\n\n<pre><code>var query = customerListWithIdAndName.Where(\n    c =&gt; c.Name == stringListWith2SemicolonSeparatedStrings.Split().Last()\n);\n</code></pre>\n\n<p>What would be the correct code that I can make a comparison on EACH splitted value?</p>\n\n<p>UPDATE:</p>\n\n<p>I want for every returned customer to assign a value: String ID = 1000; Thus every customer returned must have the id 1000.</p>\n"},{"tags":["c#","linq","query","linq-to-entities"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13064614,"title":"LINQ query... How to perform?","body":"<p>Say I got next sequence:</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n</code></pre>\n\n<p>I need make next thing with Linq:</p>\n\n<pre><code>1,2;\n2,3;\n3,4;\n4,5;\n...\n9,10;\n</code></pre>\n\n<p>Can't get it.</p>\n"},{"tags":["sql","linq","orm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13049327,"title":"Linq to sql - get value from db function and not directly from the db field (while mapping properties)","body":"<p>When you map a table to an object, every property created corresponds to one db column.\nI want to execute a db function on a column before it gets mapped to the property, so the property gets the value returned by the db function, and not the column</p>\n\n<p>I was trying to achieve that by Expression property of ColumnAttribute (as in the example below), so instead of <code>BirthDate</code> the <strong><code>usrFn_UTCToLocalTime(BirthDate)</code></strong> is returned\nbut it does not seem to be working and still gets pure value of the column.</p>\n\n<pre><code>[global::System.Data.Linq.Mapping.ColumnAttribute(Storage = \"_BirthDate\", DbType = \"DateTime\", UpdateCheck = UpdateCheck.Never, Expression = \"dbo.usrFn_UTCToLocalTime(BirthDate)\")]\n    public System.Nullable&lt;System.DateTime&gt; BirthDate\n    {\n        get\n        {\n            return this._BirthDate;\n        }\n    }\n</code></pre>\n\n<p>I have also modified the DBML XML as in:\n<a href=\"http://stackoverflow.com/questions/201636/linq-to-sql-how-to-have-property-not-from-table-but-from-db\">other post on stackoverflow</a>\nbut also without result.</p>\n\n<p>Is that possible by using LINQ or do I have to overwrite a getter which costs roundtrip to the server?</p>\n"},{"tags":["linq","datatable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13066108,"title":"Convert multiple rows into single in datatable","body":"<p>I have a DataTable in C# with two columns</p>\n\n<pre><code>State    Region\nA        1\nA        2\nB        3\nB        4\n</code></pre>\n\n<p>What I want to achieve is</p>\n\n<pre><code>State    Region\nA        1,2\nB        3,4\n</code></pre>\n\n<p>Is this possible in C# with a single LINQ query?</p>\n\n<p>I am not good in LINQ and also don't want to loop through table to achieve that.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":13066107,"title":"C# Full text search with Linq","body":"<p>I would like to do a full text search in my win forms application.</p>\n\n<pre><code>public static IEnumerable&lt;DataRow&gt; GetPartDataForFullTextSearch(string text1)\n{\n    using (cEntity context = new cEntity())\n    {\n        var query = (\n            from i in context.tblparts\n            join s in context.tblpartstatus on i.partstatus\n            equals s.id\n            join l in context.tblwarehouse on i.partId\n            equals l.partId\n            join p in context.tblwarehouseplace on l.warehouseId\n            equals p.WhId\n            orderby i.partID\n            select new Part\n            {\n                PartNumber = i.partID,\n                PartName = i.partName,\n                OldPartNo = i.partIdOld,\n                Comment = i.comment,\n                Hbv = (long)i.HBVNr,\n                Status = (int)i.partstatus,\n                Building = p.building,\n                Room = p.room,\n                Shelf = p.shelf,\n                CaseOfPart = p.case\n            }).Distinct() as IEnumerable&lt;DataRow&gt;;\n\n        var results = \n            from matchingItem in query\n            where Regex.IsMatch(matchingItem.Field&lt;string&gt;(\"partName\"), text1)\n            select matchingItem;\n\n        var list = results.ToList();\n\n        return list;\n    }\n}\n</code></pre>\n\n<p>But I don't receive a result => ArgumentNullException</p>\n\n<p>That's how I want to receive the results</p>\n\n<pre><code>      private void tbOverviewFullSearch_TextChanged(object sender, EventArgs e)\n{\n    dgPartOverview.DataSource = \n        DatabaseQueries.D_PartManagement\n            .GetPartDataForFullTextSearch(tbOverviewFullSearch.Text);\n}\n</code></pre>\n\n<p>What's wrong?\nAnd is it possible to filter more than one field?</p>\n"},{"tags":["vb.net","linq","sum"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":5987,"score":3,"question_id":1785403,"title":"VB.NET LINQ Query: Getting The Sum of All Values For A Specific Structure Member","body":"<p>In VB.NET, let's assume I have the following Structure:</p>\n\n<pre><code>Public Structure Product\n    Public ItemNo As Int32\n    Public Description As String\n    Public Cost As Decimal\nEnd Structure\n</code></pre>\n\n<p>... and a Generic List of the Products:</p>\n\n<pre><code>Dim ProductsList As New List(Of Product)\n\nDim product1 As New Product\n\nWith product1\n    .ItemNo = 100\n    .Description = \"Standard Widget\"\n    .Cost = 10D\nEnd With\n\nProductsList.Add(product1)\n\nDim product2 As New Product\n\nWith product2\n    .ItemNo = 101\n    .Description = \"Standard Cog\"\n    .Cost = 10.95D\nEnd With\n\nProductsList.Add(product2)\n\nDim product3 As New Product\n\nWith product3\n    .ItemNo = 101\n    .Description = \"Industrial Strenght Sprocket\"\n    .Cost = 99.95D\nEnd With\n\nProductsList.Add(product3)\n</code></pre>\n\n<p>How would I define a LINQ Query to Sum all of the Product.Cost values in the List?  In other words, what would be the LINQ \nQuery in VB.NET to return the value 120.90, which reflects the sum of all three Product Cost values in a single LINQ Query?</p>\n"},{"tags":["c#","linq","entity-framework","linq-to-sql"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":392,"score":4,"question_id":8713879,"title":"LINQ many-to-many intersection","body":"<p>I'm trying to query <code>Posts</code> based on a list of <code>Tags</code>:</p>\n\n<pre><code>public class Post\n{\n  public int? Id {get;set;}\n  public string Name {get;set;}\n  public virtual ICollection&lt;Tag&gt; Tags {get;set;}\n}\npublic class Tag\n{\n  public int? Id {get;set;}\n  public string Name {get;set;}\n  public vritual ICollection&lt;Post&gt; Posts {get;set;}\n}\n</code></pre>\n\n<p>Now I want to return posts based a list of tags:\n<code>IList&lt;Tag&gt; searchTags = ParseTagsFromSearchString(\"tag1,tag2,tag3\"); // this function checks the tags in the database, so all the primary keys are available in the list</code></p>\n\n<p>When a post contains one or more tags that also exists in <code>searchTags</code> it should be included in the result. I have tried the following:</p>\n\n<pre><code>var q = from s in Context.Registrations\n                    where s.Tags.Intersect(tagList)\n                    select s;\n</code></pre>\n\n<p>Error: <code>Cannot implicitly convert type 'System.Collections.Generic.IEnumerable&lt;Models.Tag&gt;' to 'bool'</code></p>\n\n<pre><code>var q = from s in Context.Registrations\n                    where s.Tags.Any(t =&gt; tagList.Any(t2 =&gt; t.Id.Value == t2.Id.Value))\n                    select s;\n</code></pre>\n\n<p>Runtime error: <code>NotSupportedException: Unable to create a constant value of type 'Models.Tag'. Only primitive types ('such as Int32, String, and Guid') are supported in this context.</code>\nAny ideas?</p>\n\n<p>-- update Jan. 4:\nThe answers point to the right solution, but in my code I still have the NotSupportedException. Is it possible the nullable integer causes this since it is not a primitive type?</p>\n"},{"tags":["c#","asp.net","sql-server","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":55,"score":-1,"question_id":13065065,"title":"Can GridView be filled with var?","body":"<p>I am trying to display duplicate rows between an excel sheet and a sql server datatable in a GridView\nthis is me code:</p>\n\n<pre><code> var matched =( from table1 in dt4.AsEnumerable()\n                      join table2 in oltlb.AsEnumerable() on\n                    table1.Field&lt;int&gt;(\"ID\") equals table2.Field&lt;int&gt;(\"ID\")\n                      where table1.Field&lt;string&gt;(\"Data\") == table2.Field&lt;string&gt;(\"Data\")\n                      select table1);\n          DataTable dthi5 = new DataTable();\n          dthi5 = matched.CopyToDataTable();\n</code></pre>\n\n<p>can i display the values of var in a GridView?</p>\n"},{"tags":["performance","linq","select","for-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13064224,"title":"Performance for vs. select","body":"<p>I read in Bill Wagners Book \"Effective C#\" that one should favor more declarative <em>select</em> statements over traditional loops (<em>for</em>). </p>\n\n<p>For example:</p>\n\n<pre><code> int[] foo = new int[1000];\n for (int i = 0; i &lt; foo.Length; i++)\n     foo[i] = i * i;\n</code></pre>\n\n<p>is traditional imperative code, whereas this would be declarative Linq code:</p>\n\n<pre><code> int[] foo2 = (from i in Enumerable.Range(0, 1000)\n               select i * i).ToArray();\n</code></pre>\n\n<p>Being an old-fashioned programmer, I prefer the first version. </p>\n\n<p>The question is how about performance? I suppose the first version is also faster.</p>\n"},{"tags":["c#","xml","linq","gpx"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":942,"score":2,"question_id":6480517,"title":"Create XML doc by LINQ, add xmlns,xmlns:xsi to it","body":"<p>I try to create an GPX XML document by LINQ to XML.</p>\n\n<p>Everything works great, except adding xmlns, xmlns:xsi attributes to the doc. By trying it different way I get different exceptions.</p>\n\n<p>My code:</p>\n\n<pre><code>XDocument xDoc = new XDocument(\nnew XDeclaration(\"1.0\", \"UTF-8\", \"no\"),\nnew XElement(\"gpx\",\nnew XAttribute(\"creator\", \"XML tester\"),\nnew XAttribute(\"version\",\"1.1\"),\nnew XElement(\"wpt\",\nnew XAttribute(\"lat\",\"7.0\"),\nnew XAttribute(\"lon\",\"19.0\"),\nnew XElement(\"name\",\"test\"),\nnew XElement(\"sym\",\"Car\"))\n));\n</code></pre>\n\n<p>The output should also contain this:</p>\n\n<pre><code>xmlns=\"http://www.topografix.com/GPX/1/1\" \nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\"\n</code></pre>\n\n<p>How can I add it by Linq to XML? I tried several ways but it does not work, exceptions during compile time.</p>\n"},{"tags":["c#","sql","linq","query","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13062518,"title":"How to convert IEnumerable to EntitySet","body":"<p>I have got way to convert <code>IEnumerable</code> to <code>EntitySet</code>. But I'm facing some issue in calling the function.</p>\n\n<p>My class is a sealed public class, so I have added extension method in separate static class within the same namespace.</p>\n\n<pre><code> public static class Conversion\n    {\n        public static EntitySet&lt;T&gt; ToEntitySet&lt;T&gt;(this IEnumerable&lt;T&gt; source) where T : class\n        {\n            var es = new EntitySet&lt;T&gt;();\n            es.AddRange(source);\n            return es;\n        }\n    }\n</code></pre>\n\n<p>My query is in sealed class, how can i call this method from my query. Here is my sql query</p>\n\n<pre><code>var p1 = (from v in dc.ptable\n                          where v.PtableId == ps.input.Id.Value\n                          select new DBModel\n               {\n\n                   MEntetyset = (v.Menteties.Where(t =&gt; t.Delf == null))\n\n               });\n</code></pre>\n\n<p>Kindly help. thanks in advance</p>\n"},{"tags":["c#","linq","datatable","group-by","sum"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":13062875,"title":"Find duplicate and merge record into single datatable c#","body":"<p>I am able to find the duplicates out of DataTable rows. Like following:</p>\n\n<pre><code>var groups = table.AsEnumerable()\n        .GroupBy(r =&gt; new\n        {\n            c1 = r.Field&lt;String&gt;(\"Version\"),\n        });\n        var tblDuplicates = groups\n            .Where(grp =&gt; grp.Count() &gt; 1)\n            .SelectMany(grp =&gt; grp)\n            .CopyToDataTable();\n</code></pre>\n\n<p>Now, I want to merge all the duplicate records in to single and sum it's Value column value.</p>\n\n<p>Pretty much like following:</p>\n\n<p>DataTable with Duplicates:</p>\n\n<pre><code>Version   Value  \n1  2\n\n2  2\n\n2  1\n\n1  3\n\n2  1\n\n3  2 \n</code></pre>\n\n<p>DataTable with no duplicates and Value summed.:</p>\n\n<pre><code>Version   Value  \n1  5\n\n2  4\n\n3  2 \n</code></pre>\n\n<p>I am aware about this link which does this with the help of reflection. \n<a href=\"http://forums.asp.net/t/1570562.aspx/1\" rel=\"nofollow\">http://forums.asp.net/t/1570562.aspx/1</a></p>\n\n<p>Anyother way to do it?</p>\n\n<p>Edit:\nHowever, if I have more than two columns, like five columns and I still want to do the sum on Value column and also need other columns data in resulatant summed datatable. How to do it? Here I get the Version and Value in my result DataTable. I want other columns with values also. Like following:</p>\n\n<p>Version col1 col2   Value  </p>\n\n<pre><code>1  A A 2\n\n2  B B 2\n\n2  B B 1\n\n1  A A 3\n\n2  B B 1\n\n3  C C 2 \n</code></pre>\n"},{"tags":["c#","asp.net","linq","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13061943,"title":".dbml .cs File throws Object reference not set to an instance of an object","body":"<p>I have a listview bound to a LinqDataSource</p>\n\n<p>I have steped thorugh the code and it gets to this section of the .dbml file of the xx.designer.cs</p>\n\n<pre><code>public System.Data.Linq.Table&lt;qtxt_Competition&gt; qtxt_Competitions     \n{\n get{     \n     return this.GetTable&lt;qtxt_Competition&gt;();    \n }     \n}\n</code></pre>\n\n<p>and once it passes the return it throws this error</p>\n\n<blockquote>\n  <p>at\n  System.Web.UI.WebControls.QueryableDataSourceView.OriginalValueMatches(Object\n  originalValue, Object value)   at\n  System.Web.UI.WebControls.QueryableDataSourceView.GetOriginalValues(IDictionary\n  keys)   at\n  System.Web.UI.WebControls.QueryableDataSourceView.BuildUpdateObjects(IDictionary\n  keys, IDictionary values, IDictionary oldValues, IDictionary`2\n  validationErrors)   at\n  System.Web.UI.WebControls.QueryableDataSourceView.ExecuteUpdate(IDictionary\n  keys, IDictionary values, IDictionary oldValues)   at\n  System.Web.UI.WebControls.ContextDataSourceView.ExecuteUpdate(IDictionary\n  keys, IDictionary values, IDictionary oldValues)   at\n  System.Web.UI.WebControls.LinqDataSourceView.ExecuteUpdate(IDictionary\n  keys, IDictionary values, IDictionary oldValues)   at\n  System.Web.UI.DataSourceView.Update(IDictionary keys, IDictionary\n  values, IDictionary oldValues, DataSourceViewOperationCallback\n  callback)   at\n  System.Web.UI.WebControls.ListView.HandleUpdate(ListViewItem item,\n  Int32 itemIndex, Boolean causesValidation)   at\n  System.Web.UI.WebControls.ListView.HandleEvent(EventArgs e, Boolean\n  causesValidation, String validationGroup)   at\n  System.Web.UI.WebControls.ListView.OnBubbleEvent(Object source,\n  EventArgs e)   at System.Web.UI.Control.RaiseBubbleEvent(Object\n  source, EventArgs args)   at\n  System.Web.UI.WebControls.ListViewDataItem.OnBubbleEvent(Object\n  source, EventArgs e)   at\n  System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) \n  at System.Web.UI.WebControls.LinkButton.OnCommand(CommandEventArgs e) \n  at System.Web.UI.WebControls.LinkButton.RaisePostBackEvent(String\n  eventArgument)   at\n  System.Web.UI.WebControls.LinkButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String\n  eventArgument)   at\n  System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler\n  sourceControl, String eventArgument)   at\n  System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)<br>\n  at System.Web.UI.Page.ProcessRequestMain(Boolean\n  includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)</p>\n</blockquote>\n\n<p>Ok the strange thing is that for some records it will update fine but for other it keeps throwing this error</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","asp.net-mvc","linq","iqueryable"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":236,"score":1,"question_id":5227435,"title":"Is it possible to hide IQueryable from controllers yet still allow for pagination and sorting?","body":"<p><strong>Background</strong></p>\n\n<p>I am working on a web application using a unit of work / repository pattern. I opted to have a service layer which interacts with the repositories. The repositories return <em>IQueryable</em> to the service layer and the service layer returns <em>List</em> to the controllers.</p>\n\n<p>I decided on not returning <em>IQueryable</em> to the controller to make sure that queries would be reused and placed in the proper layer - the service layer. Also because web services may be required later on.</p>\n\n<p><strong>Question</strong></p>\n\n<p>What is the best way to allow for pagination and sorting at the controller level without exposing <em>IQueryable</em> at the controller level?</p>\n\n<p>One option is to add parameters to all service functions which may return multiple entities but this doesn't seem ideal. Alternatively I could still page on the returned Lists but this would cause a lot of unnecessary data access.</p>\n\n<p><strong>Edit to clarify</strong></p>\n\n<p>My repository has a function like:</p>\n\n<pre><code>public IQueryable&lt;T&gt; GetAll()\n{\n    return objectSet;\n}\n</code></pre>\n\n<p>My service has a function like:</p>\n\n<pre><code>public List&lt;Person&gt; GetAllPeople()\n{\n    return repository.GetAll().ToList()\n}\n</code></pre>\n\n<p>I'm happy having the repository returning <em>IQueryable</em> to the service as this allows the service to have functions like: GetPersonByName, GetPersonByEmail etc</p>\n\n<p>But i'm looking for an alternative to just giving the <em>GetAllPeople</em> function above parameters of 'PageNumber' and 'PageSize'.</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":13060201,"title":"List<T>Get Chunk Number being executed","body":"<p>I am breaking a list into chunks and processing it as below:</p>\n\n<pre><code>foreach (var partialist in breaklistinchunks(chunksize))\n{\n  try\n   {\n       do something\n  }\ncatch\n{\nprint error\n}\n\n}\n\n\n\npublic static class IEnumerableExtensions\n    {\n        public static IEnumerable&lt;List&lt;T&gt;&gt; BreakListinChunks&lt;T&gt;(this IEnumerable&lt;T&gt; sourceList, int chunkSize)\n        {\n            List&lt;T&gt; chunkReturn = new List&lt;T&gt;(chunkSize);\n            foreach (var item in sourceList)\n            {\n                chunkReturn.Add(item);\n                if (chunkReturn.Count == chunkSize)\n                {\n                    yield return chunkReturn;\n                    chunkReturn = new List&lt;T&gt;(chunkSize);\n                }\n            }\n            if (chunkReturn.Any())\n            {\n                yield return chunkReturn;\n            }\n        }\n    }\n</code></pre>\n\n<p>If there is an error, I wish to run the chunk again. Is it possible to find the particular chunk number where we received the error and run that again ?\nThe batches have to be executed in sequential order .So if batch#2 generates an error, then I need to be able to run 2 again, if it fails again. I just need to get out of the loop for good .</p>\n"},{"tags":["c#","linq","rest"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":281,"score":3,"question_id":10614551,"title":"Is there a Linq to REST library for C#","body":"<p>I have an Linq Expression and I want to convert it to a querystring for REST, i.e.</p>\n\n<pre><code>public IQueryable&lt;Organisation&gt; Organisations;\n\n...\nvar organisations = Organisations.Where(x =&gt; x.Name == \"Bob\");\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>http://restservice.com/Organisations?$filter=Name eq \"Bob\"\n</code></pre>\n"},{"tags":["javascript","html","asp.net-mvc","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13057374,"title":"group a table list by a column name (sample included)","body":"<p>i have a table that i need to group into divs</p>\n\n<pre><code>rated | rater | team | score | subject\njohn    mike     TA     10      math\njohn    mike     TA     10      PE\njohn    jane     TA     9       math\njohn    jane     TA     9       PE\nkim     lee      TB     5       math\nkim     min      TB     2       math\n</code></pre>\n\n<p>i need it to look like</p>\n\n<pre><code> TA\n    john\n     RATER    MATH  PE         \n     mike      10   10\n     jane      9     9\n TB\n   kim\n    RATER     MATH  PE\n    lee        5\n    min        2\n</code></pre>\n\n<p>In my view I'm just iterating these values from a LINQ with a </p>\n\n<pre><code>@foreach (var item in Model) \n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["c#","multithreading","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":41,"score":-1,"question_id":13057963,"title":"Run Linq query on new thread","body":"<p>After following the MSDN guide to create a new thread to update a UI control I'm getting a strange error. I had this same query run in the load method and it worked just fine, now running in the new thread I get the right number of results, but instead of getting the names of the fields I just get DataSet written 16 time in my comboBox. Can anyone help me with this?</p>\n\n<pre><code>private void Form1_Load(object sender, EventArgs e)\n    {\n        recipeListComboBox.Items.Clear();\n        Thread QueryThread = new Thread(new ThreadStart(updateRecipeList));\n        QueryThread.Start();\n    }\n\n private void updateRecipeList()\n    {\n\n        IEnumerable&lt;string&gt; list = recipeList.getList();\n\n        foreach (string a in list)\n            UpdateRecipeComboBox(a);\n    }\n\n private void UpdateRecipeComboBox(string text)\n    {\n        if (this.recipeListComboBox.InvokeRequired)\n        {\n            UpdateRecipeComboBoxCallBack d = new UpdateRecipeComboBoxCallBack(UpdateRecipeComboBox);\n            Invoke(d, new object[] { text });\n        }\n\n        else\n        {\n            this.recipeListComboBox.Items.Add(Text);\n        }\n    }\n\n    delegate void UpdateRecipeComboBoxCallBack(string text);\n</code></pre>\n\n<p>before I put this on a new thread it looked like this:</p>\n\n<pre><code>private void Form1_Load(object sender, EventArgs e)\n{\n     recipeListComboBox.Items.Clear();\n     IEnumerable&lt;string&gt; list = recipeList.getList();\n\n     foreach (string a in list)\n          recipeComboBox.Items.Add(a);\n</code></pre>\n\n<p>this would retrun a list of 16 different recipies in the database, now I just get dataSet printed 16 times.</p>\n\n<p>Thanks for any help!!</p>\n\n<p>Craig</p>\n"},{"tags":["c#","linq","lambda","refactoring"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":13057209,"title":"How I can improve the code using lambda expressions?","body":"<p>Can some one help me? I'm not very strong with lambda expressions.  </p>\n\n<pre><code>protected void Process1(List&lt;SomeClass&gt; mylist)\n{\n    foreach (var item in mylist)\n    {\n        if (!SomeClass.Validate(item)) \n        { \n            continue; \n        } \n        DoStuff(item); \n        DoMore(item); \n        DoEven(item);\n    }\n}\n\nprotected void Process2(List&lt;SomeClass&gt; mylist)\n{\n    foreach (var item in mylist)\n    { \n        if (!SomeClass.Validate(item) || item.Value == 0)\n        {\n            continue;\n        }\n        DoStuff(item);\n        DoMore(item);\n        DoEven(item); \n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","grouping"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":60,"score":-1,"question_id":13056760,"title":"Mutually exclusive group by in Linq","body":"<p>I want to catch duplicates mutually exclusively, that is, I need to show that both the first and the third items are duplicates, and that the first and the fourth items are duplicates.</p>\n\n<pre><code>public class Foo\n{\n    public String Name { get; set; }\n    public String SName { get; set; }\n}\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        var list = new List&lt;Foo&gt;();\n        list.Add(new Foo { Name = \"a\", SName = \"d\" });\n        list.Add(new Foo { Name = \"b\", SName = \"e\" });\n        list.Add(new Foo { Name = \"c\", SName = \"a\" });\n        list.Add(new Foo { Name = \"a\", SName = \"f\" });\n\n        // only groups by 1 name\n        var duplicates = list.GroupBy(i =&gt; i.Name).Where(g =&gt; g.Count() &gt; 1).Select(g =&gt; g.Key);\n    }\n}\n</code></pre>\n\n<p>I know this can be done trivially with foreach, I want to learn.</p>\n"},{"tags":["linq","linq-to-sql"],"answer_count":7,"favorite_count":2,"up_vote_count":25,"down_vote_count":0,"view_count":8463,"score":25,"question_id":259219,"title":"How can I reject all changes in a Linq to SQL's DataContext?","body":"<p>On Linq to SQL's DataContext I am able to call SubmitChanges() to submit all changes.</p>\n\n<p>What I want is to somehow reject all changes in the datacontext and rollback all changes (preferable without going to the database).</p>\n\n<p>Is this possible?</p>\n"},{"tags":["asp.net-mvc","linq","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2406,"score":4,"question_id":1674041,"title":"Access nested properties with dynamic lambda using Linq.Expression","body":"<p>Let's assume that I have two classes:</p>\n\n<pre><code>class person\n{\n    int ID\n    string name\n    Address address\n}\nclass address\n{\n    int ID\n    string street\n    string country\n}\n</code></pre>\n\n<p>These classes are more or less given, they are mapped via nHibernate to be honest :)</p>\n\n<p>In a grid (<a href=\"http://www.datatables.net\" rel=\"nofollow\">datatables.net</a> as base) I would like to have a type-independent sorting.</p>\n\n<p>Therefore I created a lambda expression:</p>\n\n<pre><code>  var param = Expression.Parameter(typeof(T), typeof(T).Name);\n  var sortExpression = Expression.Lambda&lt;Func&lt;T, object&gt;&gt;\n                              (Expression.Convert(Expression.Property(param, \"Property to sort\"), typeof(object)), param);\n</code></pre>\n\n<p>If I pass Person as Type T and replace the \"Property to sort\" with \"name\" it works fine (creates a correct lambda). If the Property to sort is \"address.street\" it won't work, throw me the following error:</p>\n\n<pre><code>Property 'address.street' is not defined for type 'person'\n</code></pre>\n\n<p>I see only one solution so far, but not clear enough... I would try to split the string which contains the Property-Name (split by .) </p>\n\n<p>Can anyone give a better solution? I need to add the sortExpression to an IQueryable object <code>query.OrderBy(sortExpression)</code>.</p>\n\n<p>Not sure if my title is clear, please go ahead and correct it.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":64,"score":2,"question_id":13056324,"title":"C# LINQ get objects with field value that do not match a string array blacklist","body":"<p>I have the following code:</p>\n\n<pre><code>public class MyObject {\n  public string Name { get; set; }\n\n  public MyObject(string name) {\n    Name = name;\n  }  \n}\n\n// caller method somewhere\npublic void myMethod() {\n  List&lt;MyObject&gt; myObjects = new List&lt;MyObject&gt;();\n  myObjects.Add(new MyObject(\"Jim\"));\n  myObjects.Add(new MyObject(\"David\"));\n  myObjects.Add(new MyObject(\"Richard\"));\n  myObjects.Add(new MyObject(\"Steve\"));\n\n  string[] namesToExclude = new string[] { \"Jim\", \"Steve\" };\n  List&lt;string&gt; strings = myObjects.Select(m =&gt; m.Name).Except(namesToExclude).ToList();\n  // replace the above line to result in List&lt;MyObject&gt; with 2 items (David, Richard)\n}\n</code></pre>\n\n<p>I'd like to get this last line working so I can get back the list as a <code>List&lt;MyObject&gt;</code> rather than as a <code>List&lt;string&gt;</code>.</p>\n"},{"tags":["c#",".net","xml","winforms","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":61,"score":1,"question_id":13055665,"title":"Parse Malformed XML With Linq","body":"<p>i am trying to parse some xml that i beleve to be malformed using Linq in .net 3.5 , i need to get the data out of the xml and insert the data into variables, i have been using XmlDocument to parse the xml, any examples or assistance is greatly appreciated</p>\n\n<p>XML -- </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;centovacast version=\"2.2.4\" host=\"my.domain.com\"&gt;\n&lt;response type=\"success\"&gt;\n&lt;message&gt;Complete&lt;/message&gt;\n&lt;data&gt;&lt;row&gt;\n&lt;field name=\"mount\"&gt;/stream&lt;/field&gt;\n&lt;field name=\"listenercount\"&gt;0&lt;/field&gt;\n&lt;field name=\"genre\"&gt;Unspecified&lt;/field&gt;\n&lt;field name=\"url\"&gt;http://&lt;/field&gt;\n&lt;field name=\"title\"&gt;&lt;/field&gt;\n&lt;field name=\"currentsong\"&gt;Placebo - One Of A Kind&lt;/field&gt;\n&lt;field name=\"bitrate\"&gt;128&lt;/field&gt;\n&lt;field name=\"sourceconnected\"&gt;1&lt;/field&gt;\n&lt;field name=\"serverstate\"&gt;1&lt;/field&gt;\n&lt;field name=\"sourcestate\"&gt;1&lt;/field&gt;\n&lt;field name=\"reseller\"&gt;0&lt;/field&gt;\n&lt;field name=\"ipaddress\"&gt;&lt;/field&gt;\n&lt;field name=\"port\"&gt;13282&lt;/field&gt;\n&lt;field name=\"proxy\"&gt;0&lt;/field&gt;\n&lt;field name=\"servertype\"&gt;ShoutCast&lt;/field&gt;\n&lt;field name=\"sourcetype\"&gt;icescc&lt;/field&gt;\n&lt;/row&gt;&lt;row&gt;&lt;field&gt;&lt;/field&gt;&lt;/row&gt;&lt;/data&gt;&lt;/response&gt;&lt;/centovacast&gt;\n</code></pre>\n\n<hr>\n\n<p>another problem is that sometimes the \"currentsong\" value may contain special characters, such as ! , % , ^ &amp; etc and i know that can sometimes cause issues with xml.</p>\n\n<p>-- Code i'm trying to use to parse the XML</p>\n\n<pre><code>        XElement xml = XElement.Parse(data);\n\n        var query = from p in xml.Elements(\"name\")\n                    select p;\n\n        foreach (var record in query)\n        {\n            MessageBox.Show(String.Format(\"Info: {0} {1}\",\n                                                record.Element(\"url\"),\n                                                record.Element(\"title\")));\n        }\n</code></pre>\n"},{"tags":["c#",".net","vb.net","linq"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":141,"score":2,"question_id":13055391,"title":"Get indexes of all matching values from list using Linq","body":"<p>Hey Linq experts out there,</p>\n\n<p>I just asked a very similar question and know the solution is probably SUPER easy, but still find myself not being able to wrap my head around how to do this fairly simple task in the most efficient manner using linq.</p>\n\n<p>My basic scenario is that I have a list of values, for example, say:</p>\n\n<pre><code>Lst1:\na\na\nb\nb\nc\nb\na\nc\na\n</code></pre>\n\n<p>And I want to create a new list that will hold all the indexes from Lst1 where, say, the value = \"a\".\nSo, in this example, we would have:</p>\n\n<pre><code>LstIndexes:\n0\n1\n6\n8\n</code></pre>\n\n<p>Now, I know I can do this with Loops (which I would rather avoid in favor of Linq) and I even figured out how to do this with Linq in the following way:</p>\n\n<pre><code>LstIndexes= Lst1.Select(Function(item As String, index As Integer) index) _\n                .Where(Function(index As Integer) Lst1(index) = \"a\").ToList\n</code></pre>\n\n<p>My challenge with this is that it iterates over the list twice and is therefore inefficient.</p>\n\n<p>How can I get my result in the most efficient way using Linq?</p>\n\n<p>Thanks!!!!</p>\n"},{"tags":["c#","linq","geolocation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":63,"score":-2,"question_id":13056044,"title":"Find locations within 50m by Current User Latitude and Longitude","body":"<p>Ok i have MsSql server database and my table have fields which presentes Latitude and Longitude but i dont have Distance field. I am getting this Longitude and Latitude Degrees over GPS if its important to know. And i have mobile web site which uses html5 navigator to find user Latitude and Longitude. I just wanna find locations within 50meters or more locations by user current longitude and latitude. I guess i read all of the stackoverflow suggestions but there is no usable <strong>LINQ</strong> codes for it. I am using <strong>Asp.Net</strong> and <strong>LINQ</strong>. </p>\n\n<p><a href=\"http://janmatuschek.de/LatitudeLongitudeBoundingCoordinates\" rel=\"nofollow\">janmatuschek</a> so many thanks for his code. its very useful. but its java code. I Googled a lil bit and convert java class to c#. But i need a lil bit of help converting sql query to linq query. query is below. Just anyone tell me how can i search within 50 mt with this sql query?</p>\n\n<p><img src=\"http://i.stack.imgur.com/qVg4Q.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","linq","generics"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":13054281,"title":"List<T>.ForEach with index","body":"<p>I'm trying to find the LINQ equivalent of the following code:</p>\n\n<pre><code>NameValueCollection nvc = new NameValueCollection();\n\nList&lt;BusinessLogic.Donation&gt; donations = new List&lt;BusinessLogic.Donation&gt;();\ndonations.Add(new BusinessLogic.Donation(0, \"\", \"\", \"\");\ndonations.Add(new BusinessLogic.Donation(0, \"\", \"\", \"\");\ndonations.Add(new BusinessLogic.Donation(0, \"\", \"\", \"\");\n\nfor(var i = 0; i &lt; donations.Count(); i++)\n{\n    // NOTE: item_number_ + i - I need to be able to do this\n    nvc.Add(\"item_number_\" + i, donations[i].AccountName);\n}\n</code></pre>\n\n<p>I was hoping I could use something like:</p>\n\n<pre><code>NameValueCollection nvc = new NameValueCollection();\n\nList&lt;BusinessLogic.Donation&gt; donations = new List&lt;BusinessLogic.Donation&gt;();\ndonations.Add(new BusinessLogic.Donation(0, \"\", \"\", \"\");\ndonations.Add(new BusinessLogic.Donation(0, \"\", \"\", \"\");\ndonations.Add(new BusinessLogic.Donation(0, \"\", \"\", \"\");\n\ndonations.ForEach(x =&gt; nvc.Add(\"item_name_\" + ??, x.AccountName);\n</code></pre>\n\n<p>But I've not found a way to determine which iteration the loop is on. Any help would be appreciated!</p>\n"},{"tags":["c#","xml","linq","linq-to-xml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":46,"score":-1,"question_id":13053029,"title":"I have issues with this XML and I want to extract ea_source name","body":"<p>I want to extract the value of <code>ea_sourceName</code> and <code>ea_targetName</code> when the value of <code>ea_type</code> is <code>Aggregation</code>.</p>\n\n<pre><code> &lt;UML:Association xmi.id=\"EAID_018EEEB3_9A6B_4102_85C8_3A78261E9AA4\" visibility=\"public\" isRoot=\"false\" isLeaf=\"false\" isAbstract=\"false\"&gt;\n &lt;UML:ModelElement.taggedValue&gt;\n  &lt;UML:TaggedValue tag=\"style\" value=\"3\" /&gt; \n  &lt;UML:TaggedValue tag=\"ea_type\" value=\"Aggregation\" /&gt; \n  &lt;UML:TaggedValue tag=\"direction\" value=\"Source -&gt; Destination\" /&gt; \n  &lt;UML:TaggedValue tag=\"linemode\" value=\"3\" /&gt; \n  &lt;UML:TaggedValue tag=\"linecolor\" value=\"-1\" /&gt; \n  &lt;UML:TaggedValue tag=\"linewidth\" value=\"0\" /&gt; \n  &lt;UML:TaggedValue tag=\"seqno\" value=\"0\" /&gt; \n  &lt;UML:TaggedValue tag=\"headStyle\" value=\"0\" /&gt; \n  &lt;UML:TaggedValue tag=\"lineStyle\" value=\"0\" /&gt; \n  &lt;UML:TaggedValue tag=\"ea_localid\" value=\"8\" /&gt; \n  &lt;UML:TaggedValue tag=\"ea_sourceName\" value=\"Course\" /&gt; \n  &lt;UML:TaggedValue tag=\"ea_targetName\" value=\"Sem_Progarm\" /&gt; \n  &lt;UML:TaggedValue tag=\"ea_sourceType\" value=\"Class\" /&gt; \n  &lt;UML:TaggedValue tag=\"ea_targetType\" value=\"Class\" /&gt; \n  &lt;UML:TaggedValue tag=\"ea_sourceID\" value=\"18\" /&gt; \n  &lt;UML:TaggedValue tag=\"ea_targetID\" value=\"19\" /&gt; \n  &lt;UML:TaggedValue tag=\"virtualInheritance\" value=\"0\" /&gt; \n  &lt;/UML:ModelElement.taggedValue&gt;\n</code></pre>\n\n<p>I have tried this code, but it does not return anything. What I want is a list that contains the values of <code>ea_sourceName</code> like <code>Course</code> and so on</p>\n\n<pre><code>static XNamespace ns2;\nns2 = @\"omg.org/UML1.3\";\nXDoucument MyXmiFile = XDocument.Load(path);\n string Relation = \"Association\";\n var q = from p in this.MyXmiFile.Descendants(ns2 + Relation)\n         select p;\n\n var m = from p in q.Descendants(ns2 + \"TaggedValue\")\n         where p.Attribute(\"tag\").Value == \"ea_type\" &amp;&amp; p.Attribute(\"value\").Value == \"Aggregation\"\n         select p;\n\nvar s = from p in m\n        let P1 = p.Attribute(\"tag\").Value\n        where P1 == \"ea_sourceName\"\n        select p.Attribute(\"value\").Value;\n\nList&lt;string&gt; Result = new List&lt;string&gt;(s.ToList());\n</code></pre>\n"},{"tags":["c#","linq","ado.net","linq-to-entities"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13041664,"title":"How to to access ObjectContext objects while updating entities generated by ADO.NET","body":"<p>first I am very new to ADO.NET, LINQ and those data access technologies. As far as I understand for what I readed and found on internet LINQ2SQL evolved to LINQ to entities which evolved to ADO.NET. Maybe I am wrong with those concepts so let me know.</p>\n\n<p>Now to the question. I am developing a system in VS2010 (.NET 4.0) with ADO.NET to manage a school. The solution is dividedn in 3 layers: Presentation Layer (only GUI), Bussiness Layer (all process are done here) and Data Layer (only querys and database access).</p>\n\n<p>The database has a table People to store data for persons (students, teachers, administrative, etc.) with a field for Nationality which stores a reference to the Countries table with all the existing countries by now.</p>\n\n<p>In my first approach, I created a singleton class called ConnectionManager which stores the connection string and a reference to the database model (The code generated by the ADO.NET  Entity Data Model designer), an object which inherits from ObjectContext called SystemEntities.</p>\n\n<p>At this point everything woked fine, however I wondered about the following scenario: A user is editing a person information when a lient arrives and request an bill for her payment; then the user switches to a bill form, fills the data and saves before print. During this process a call to SystemEntities.SaveChanges is made so all changes are saved to the database, then the unfinished changes made to the editeded person are saved, but this is an undesired behavior.</p>\n\n<p>Then I readed that I must not have a singleton which keeps the connection to the database open. Every ObjectContext mus be disposed after fetching the data, therefore a code like this shoud be used.</p>\n\n<p>To fetch all people</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static T[] QueryAll&lt;T&gt;() where T : Person\n{\n    using (SystemEntities context = ConnectionManager.Instance.GetContext())\n    {\n        return context.People\n            .OfType&lt;T&gt;()\n            .Include(\"Emails\")\n            .Include(\"Phones\")\n            .OrderBy(affiliate =&gt; affiliate.LastName + \" \" + affiliate.FirstName)\n            .ToArray();\n    }\n}\n</code></pre>\n\n<p>To fetch a country</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static Country GetByID(string id)\n{\n    using (SystemEntities context = ConnectionManager.Instance.GetContext())\n    {\n        return context.Countries.FirstOrDefault(country =&gt; country.CountryID == id);\n    }\n}\n</code></pre>\n\n<p>Now, when I tried to edit a Person, to be specific to change a person's country, an exception is rised:</p>\n\n<pre><code>The relationship between the two objects cannot be defined\nbecause they are attached to different ObjectContext objects.\n</code></pre>\n\n<p>This is done via the following code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public Person Person\n{\n    get { ... }\n    set\n    {\n        this.person = value;\n        ...\n        this.cmbNationality.DataBindings.Add(\"SelectedItem\", person, \"Nationality\");\n        this.cmdAddressCountry.DataBindings.Add(\"SelectedItem\", person, \"Country\");\n        ...\n    }\n}\n\nprivate void form_Load(object sender, EventArgs e)\n{\n    Country[] countries = Country.QueryAll();\n    Country mexico = Country.GetByA2(\"MX\");\n    this.cmbNationality.DataSource = countries;\n    this.cmdAddressCountry.DataSource = countries;\n    this.cmbNationality.SelectedItem = mexico;\n    this.cmdAddressCountry.SelectedItem = mexico;\n}\n</code></pre>\n\n<p>So when you change the item in the cmbNationality and cmdAddressCountry combo boxes, the exception is thrown. Notice that is only a change, no save has been performed.</p>\n\n<p>As far as I understand, this is produced because the Person and Country objects are fetched from the database from different SystemEntities (ObjectContext) objects.</p>\n\n<p>And there is the problem and question. How can I solve that if I can not use a singleton and all contexts must be disposed after use? Of course I can create several methods to avoid this problem to make updates by hand or not using data bindings but, what is the point of ADO.NET if you must do updates at hand?</p>\n\n<p>Maybe is a stupid or trivial (or may be i just didn't know how to search the answer) question but I was not able to find the answer.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","linq","entity-framework","linq-expressions"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13048608,"title":"Using a params array of linq Expressions","body":"<p>In EF, when you want to include a navigation property in the result of a query, you use <code>Include()</code>. Since some queries require calling this more than once, I tried to create a generic wrapper around this concept:</p>\n\n<pre><code>public IQueryable&lt;T&gt; FindAll&lt;P&gt;(params Expression&lt;Func&lt;T, P&gt;&gt;[] predicates) where P : class {\n  var entities = AllEntities();\n  foreach (var p in predicates) entities = entities.Include(p);\n  return entities;\n}\n</code></pre>\n\n<p>And call it as such:</p>\n\n<pre><code>var customers = FindAll(q =&gt; q.Orders, q =&gt; q.Invoices, q =&gt; q.Contacts);\n</code></pre>\n\n<p>Questions:  </p>\n\n<ol>\n<li>The function compiles, but when I call it: \"The type arguments for method cannot be inferred from the usage. Try specifying the type arguments explicitly.\" What am I doing wrong?  </li>\n<li>If I get it to work, can I call <code>Include()</code> the first time: <code>var customers = FindAll(q =&gt; q.Orders, q =&gt; q.Invoices);</code> and then again later in a separate step: <code>customers = customers.Include(p =&gt; p.Invoices);</code> or will that result in poor performance such that I should do the includes in one go?</li>\n</ol>\n\n<p><strong>EDIT:</strong><br>\nJonSkeet's answer is correct, of course, and yet <a href=\"http://stackoverflow.com/a/5376637/1711500\">there is this solution</a> which seems to do what I want. Not sure why it works however. Is it because of the <code>Aggregate()</code> function?</p>\n"},{"tags":["c#",".net","vb.net","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13053763,"title":"Return items in one list based upon their matching index in another using Linq","body":"<p>I know I could very easily accomplish this using loops, but I'm looking for the most efficient solution for my question.</p>\n\n<p>Suppose I have 2 lists(of string):</p>\n\n<pre><code>Dim lst1 as new list(of string)\nDim lst2 as new list(of string)\n</code></pre>\n\n<p>And both have the same number of elements, for example:</p>\n\n<pre><code>Lst1:    Lst2:\na        abc1\na        abc2\nb        abc3\na        abc4\nb        abc5\nc        abc6\na        abc7\nc        abc8\n</code></pre>\n\n<p>Now, I'm looking to get, for example, all the elements from lst2 for which the corresponding elements in Lst1 = \"a\"</p>\n\n<p>So my final result will be:</p>\n\n<pre><code>Lst3 = Items from Lst2 where corresponding Items in Lst1 = \"a\"\nLst3 = {abc1, abc2, abc4, abc7}\n</code></pre>\n\n<p>Again, I know this would be SUPER easy to do with loops, but I'm wondering how to do this via Linq.</p>\n\n<p>Thanks!!!</p>\n"},{"tags":["linq","foreach"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2421,"score":3,"question_id":841361,"title":"how do you execute a function on a List of objects using LINQ","body":"<p>I want to execute a function on all the objects within a List of objects using LINQ. I know i saw something similar on SO before but after several failed search attempts, i am posting this question</p>\n"},{"tags":["linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13053493,"title":"how to find non null or string.empty columns using linq?","body":"<p>here's my code. it works</p>\n\n<pre><code>var someField = \"abc\";\n\nvar list = Entities.Where(x=&gt;SomeField).FirstOrDefault();\n</code></pre>\n\n<p>here's the problem, someField can also be null or string.empty. If someField is null or string.empty, I will select everything where  SomeField is null or string.empty.</p>\n\n<pre><code>var list = Entities.Where(x=&gt;SomeField  == null || SomeField == string.empty).FirstOrDefault();\n</code></pre>\n\n<p>right now, I have an if else statement to check if someField has value,then decided which query to use.</p>\n\n<p>I need to combine the 2 queries into one. because if there are fields we need to check, then this if else statemetn will get very long.</p>\n"},{"tags":["c#","asp.net-mvc","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":13045999,"title":"most efficient way to query a collection - c#","body":"<p>I'm searching through a generic list (or IQueryable) which contains 3 columns.  I'm trying to find the value of the 3 column, based on 1 and 2, but the search is really slow.  For a single search, the speed isn't noticeable, but I'm performing this search on a loop, and for 700 iterations, it takes a combined time of over 2 minutes, which isn't any use.  Columns 1 and 2 are <code>int</code> and column 3 is a <code>double</code>.  Here is the linq I'm using:</p>\n\n<pre><code>public static Distance FindByStartAndEnd(int start, int end, IQueryable&lt;Distance&gt; distanceList)\n{\n    Distance item = distanceList.Where(h =&gt; h.Start == start &amp;&amp; h.End == end).FirstOrDefault();\n    return item ;\n}\n</code></pre>\n\n<p>There could be up do 60,000 entries in the IQueryable list.  I know that is quite a lot, but I didn't think it would pose any problem for searching.</p>\n\n<p>So my question is, is there a better way to search through a collection when needing to match 2 columns to get value of a third? I guess I need all 700 searches to be almost instant, but it takes about 300ms for each which soon mounts up.</p>\n\n<p><strong>UPDATE - Final Solution #######################</strong></p>\n\n<p>I've now created a dictionary using <code>Tuple</code> with <code>start</code> and <code>end</code> as the key.  I think this could be the right solution.</p>\n\n<pre><code>var dictionary = new Dictionary&lt;Tuple&lt;int, int&gt;, double&gt;();\n\nvar key = new Tuple&lt;int, int&gt;(Convert.ToInt32(reader[0]), Convert.ToInt32(reader[1]));\nvar value = Convert.ToDouble(reader[2]);\n\nif (value &lt;= distance)\n{\n    dictionary.Add(key, value);\n}\nvar key = new Tuple&lt;int, int&gt;(5, 20);\n</code></pre>\n\n<p>Works fine - much faster</p>\n"},{"tags":["sql-server","linq","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13053321,"title":"Convert sql query with multiple inner joins to LINQ","body":"<p>I have this query which I retrieve from 6 tables which gets the dates, rated, rater, classname, scores, subject. </p>\n\n<pre><code>SELECT r.date, u1.username as rated, u2.username as rater, c.name as classname, s.ratings, sbj.name\nFROM Ratings r\n INNER JOIN Users u1 ON u1.userid = r.rated \n INNER JOIN Users u2 ON u2.userid = r.rater \n INNER JOIN ClassMembers cm ON u1.userid  = cm.userid\n INNER JOIN Class c ON cm.teamid = c.teamid\n INNER JOIN Scores s ON s.ratingsid = r.ratingsid \n INNER JOIN Subjects sbj ON sbj.subjectid = s.subjectid\n</code></pre>\n\n<p>this results in</p>\n\n<pre><code>date         | rated | rater | teamname | score |  subject\n10/12/2012    john     mike     teamA      9        Math\n10/09/2012    john     mike     teamA      9        Science\n10/09/2012    john     abra     teamA      5        Math\n10/09/2012    john     abra     teamA      5        Science\n</code></pre>\n\n<p>I have to convert this query to a LINQ expression.\nI'm having a hard time converting my sql query into LINQ. Any help would be appreciated.</p>\n"},{"tags":["linq","nhibernate","linq-to-nhibernate"],"answer_count":3,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":3676,"score":10,"question_id":1689653,"title":"NHibernate.Linq LIKE","body":"<p>How can I produce this query using NHibernate.Linq?</p>\n\n<pre><code>WHERE this_.Name LIKE @p0; @p0 = 'test'  // Notice NO % wild card\n</code></pre>\n\n<p>Note, this is not Linq To Sql or Entity Framework. This is NHibernate.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Here is the desired query using ICriteria:</p>\n\n<pre><code>criteria.Add(Expression.Like(\"Name\", \"test\"));\nreturn criteria.List&lt;Theater&gt;();\n</code></pre>\n"},{"tags":["c#",".net","linq",".net-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13034214,"title":"Find entities from list of entities","body":"<p>I have a list of entities like below. </p>\n\n<pre><code>Entity1 { Id=1, From=01/01/2011, To=31/01/2011, Status=true }\nEntity2 { Id=1, From=01/02/2011, To=28/02/2011, Status=false}\nEntity2 { Id=2, From=01/02/2011, To=28/02/2011, Status=false}\nEntity3 { Id=3, From=01/01/2011, To=31/01/2011, Status=true }\nEntity4 { Id=4, From=01/01/2011, To=31/01/2011, Status=true }\nEntity5 { Id=1, From=01/03/2011, To=31/03/2011, Status=false}\nEntity6 { Id=4, From=31/03/2011, To=10/04/2011, Status=false}\n</code></pre>\n\n<p>I want to find the entities which have the oldest from date and latest last date. ( entities covering whole from date and to date)</p>\n\n<p><strong>Basically I need to get the entities which have distinct from and to dates. Also the starting entity should have the oldest From date and final entity should have the latest To date</strong></p>\n\n<p>In this case the expected result is entities starting from <strong><em>01/01/2011</em></strong> to <strong><em>10/04/2011</em></strong>. </p>\n\n<p><strong>Update</strong></p>\n\n<pre><code>Entity 1 has the oldest from date : 01/01/2011\nEntiry 2 which falls under : 01/01/2011 and 10/04/2011\nEntity 3 which falls under 01/01/2011 and 10/04/2011(but entity 1 has same from and to date as Entity3 so entity 3 not a valid)\nEntity 4 which falls under 01/01/2011 and 10/04/2011(but entity 1 has same from and to date as Entity4 so entity 4 not a valid)\nEntity 5 which falls under : 01/01/2011 and 10/04/2011\nEntity 6 has the most recent To date : 10/04/2011\nSo Valid entries are Entity1, Entity2, Entity5, Entity6\n</code></pre>\n\n<p>I tried something like this</p>\n\n<pre><code>var dates = (EntityList.GroupBy(offer =&gt; offer.id)\n             .Select(group =&gt;\n                 new { offerid = group.Key,\n                       offers = group.OrderBy(o =&gt; o.From)\n                       })\n             .OrderBy(g =&gt; g.offers.First().From) \n        . FirstOrDefault\n ().offers.First();  \n</code></pre>\n\n<p>But I think it should do without grouping, but I am not quite sure </p>\n\n<p>Any help is appreciate </p>\n\n<p>Thanks</p>\n"},{"tags":["linq"],"answer_count":9,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":674,"score":2,"question_id":4726047,"title":"Dynamically Sorting with LINQ","body":"<p>I have a collection of CLR objects. The class definition for the object has three properties: FirstName, LastName, BirthDate.</p>\n\n<p>I have a string that reflects the name of the property the collection should be sorted by. In addition, I have a sorting direction. How do I dynamically apply this sorting information to my collection? Please note that sorting could be multi-layer, so for instance I could sort by LastName, and then by FirstName.</p>\n\n<p>Currently, I'm trying the following without any luck:</p>\n\n<pre><code>var results = myCollection.OrderBy(sortProperty);\n</code></pre>\n\n<p>However, I'm getting a message that says:</p>\n\n<p><em>... does not contain a defintion for 'OrderBy'  and the best extension method overload ... has some invalid arguments.</em></p>\n"},{"tags":["linq","nullreferenceexception","defaultifempty"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13052065,"title":"LINQ NullReferenceException on DefaultIfEmpty","body":"<p>I'm looking for a solution to the problem of having the DefaultIfEmpty() extension method not picking up null values when used in a LINQ outer join.</p>\n\n<p>Code as follows:</p>\n\n<pre><code>            var SummaryLossesWithNets = (from g in SummaryLosses\n                                     join n in nets\n                                     on g.Year equals n.Year into grouping\n                                     from x in grouping.DefaultIfEmpty()\n                                     select new\n                                         {\n                                             Year = g.Year,\n                                             OEPGR = g.OccuranceLoss,\n                                             AEPGR = g.AggregateLoss,\n                                             OEPNET = ((x.OEPRecovery == null) ? 0 : x.OEPRecovery),\n                                             AEPNET = ((x.AEPRecovery == null) ? 0 : x.AEPRecovery),\n                                         });\n</code></pre>\n\n<p>In the List SummaryLosses there are many years worth of data I wish to join to the table 'nets' which contains a sub-portion of the years. The exception is thrown on x being a null value, I am assuming because the years in SummaryLosses not matched by years in nets creates null valeus in the grouping list.</p>\n\n<p>How should one go about checking for the null value here? As you can see I've attempted to check for null on the properties of x, but since x is null this doesn't work.</p>\n\n<p>Kind regards\nRichard</p>\n"},{"tags":["linq","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13051005,"title":"Convert datepart to LINQ from T-SQL","body":"<p>I'm trying to get the date range from last week and 2 weeks ago from Sunday to Saturday\nso today is 10/24/2012, date range is : 10/21/2012 - 10/27/2012</p>\n\n<p>I'm trying to get last week's date range which is: 10/14/2012 - 10/20/2012<br>\nAlso the 2 weeks ago's date range which is: 10/07/2012 - 10/13/2012</p>\n\n<p>I have the right SQL query which is</p>\n\n<pre><code>DECLARE @TodayDayOfWeek INT\nDECLARE @EndOfPrevWeek DateTime\nDECLARE @StartOfPrevWeek DateTime\nDECLARE @EndOf2WeeksAgo DateTime\nDECLARE @Start2WeeksAgo DateTime\n\n\nSET @TodayDayOfWeek = datepart(dw, GetDate())\n--get the last day of the previous week (last Sunday)\nSET @EndOfPrevWeek = DATEADD(dd, -@TodayDayOfWeek, GetDate())\n--get the first day of the previous week (the Monday before last)\nSET @StartOfPrevWeek = DATEADD(dd, -(@TodayDayOfWeek+6), GetDate())\nSET @EndOf2WeeksAgo = DATEADD(dd, -(@TodayDayOfWeek+7), GetDate())\nSET @Start2WeeksAgo = DATEADD(dd, -(@TodayDayOfWeek+13), GetDate())\n\nSelect  @StartOfPrevWeek as [Last week start date], @EndOfPrevWeek as [Last Week start date],\n@Start2WeeksAgo as [2 Weeks Ago Start], @EndOf2WeeksAgo as [2 Weeks Ago End]    \n</code></pre>\n\n<p>This results in</p>\n\n<pre><code>[Last week start date] [Last week start date]  [2 Weeks Ago Start] [2 Weeks Ago End] \n10/14/2012             10/20/2012              10/07/2012          10/13/2012\n</code></pre>\n\n<p>how to i convert this to Linq? I have a date column and need to display dates between these 2 date ranges like</p>\n\n<pre><code>last week date   2 weeks ago\n10/15/2012        10/08/2012\n10/18/2012        10/11/2012\n</code></pre>\n"},{"tags":["linq","c#-4.0","lambda","ef-code-first"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13051330,"title":"Lambda Expression for Many to Many realtionship in C# EF 5 Code First","body":"<p>I'm using EF 5 Code First and VS 2012.\nI have  classes for Articles and Tags. Each Article will have atleast one Tag associated.\nPlease see the classes below.</p>\n\n<pre><code>public class Article\n{\n    public int ArticleId { get; set; }\n    public virtual ICollection&lt;ArticleTag&gt; Tags { get; set; }\n}\npublic class Tag\n{\n    public int TagId { get; set; }\n    public string TagName { get; set; }\n}\n\npublic class ArticleTag\n{\n    public int ArticleId { get; set; }\n    public int TagId { get; set; }\n\n    // navigation property\n    public virtual Article Article { get; set; }\n    public virtual Tag Tag { get; set; }\n}\n</code></pre>\n\n<p>Below is the code I tried. <strong>requestTags</strong> contains the list of TadgIds. <strong>repBase</strong> is db context. But below code is returing all Articles.</p>\n\n<pre><code>var idList = requestTags.tags.Select(t =&gt; t.id).ToList();\n var result= repBase.GetAll&lt;Article&gt;().Select(tg =&gt; tg.Tags.Where(tk =&gt; idList.Contains(tk.TagId))).ToList();\n</code></pre>\n\n<p>Please hlep me to get list of articles for a given list of TagIds. </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["linq","nhibernate","hql","linq-to-nhibernate","iquery"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13041693,"title":"Converting NHibernate results to different types","body":"<p>I have the following HQL query, which more-or-less works the way I want.  When I call the <code>List()</code> method, an <code>ArrayList</code> of objects are returned.  Each item in the list is an <code>object[]</code> which contains a <code>double</code> representing the weight and then the <code>ShippingRate</code></p>\n\n<p>I would like to end up with a strongly type list of <code>IList&lt;ShippingRate&gt;</code>.  I am relatively new to NHibernate, so I am curious about what the preferred ways of soloving this are.</p>\n\n<ol>\n<li>Is there a way to get what I want without changing the original query? </li>\n<li>Would a ResultTransformer do what I need?</li>\n<li>Is it more appropriate to handle a scenario like this on the mapping side of things?</li>\n</ol>\n\n<p>Also, is there a simpler way of wiring the query either with Linq or HQL that will give me the typed list I want without having to do any conversions after the fact?</p>\n\n<p><strong>Working Query</strong></p>\n\n<pre><code>string hql= @\"select min(s.Weight), s from\n                                ShippingRate s\n                               where s.ShippingZoneId=:zoneId\n                                   AND  s.Weight&gt;=:weight\n                               group by s.ShippingMethod.ShippingMethodId\";\n\n\nvar result = Session.CreateQuery(hql).SetParameter(\"zoneId\",zoneId).SetParameter(\"weight\", weight);\n</code></pre>\n\n<p><strong>Query Result</strong></p>\n\n<pre><code>-       (object[])result[0] {object[2]} object[]\n\n        [0] 13  object {int}\n-       [1] {ShippingRate}  object {ShippingRate}\n        Price   3   decimal\n+       ShippingMethod  {ShippingMethod}    \n        ShippingRateId  1   uint\n        ShippingZoneId  1   int\n        Weight  13  int\n</code></pre>\n\n<p><strong>Possible Solution</strong></p>\n\n<p>Here is what I have devised to get me what I need, using Linq.  It seems though that there has to be a better way of doing this.</p>\n\n<pre><code>  List&lt;ShippingRate&gt; rates = (from object[] item in result select (ShippingRate) item[1]).ToList(); \n</code></pre>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13049866,"title":"Linq Include just one object from a one to many relation","body":"<p>I have two tables with a one to many relation.</p>\n\n<p>One Order has many Products.</p>\n\n<p>I want to take a list of Orders with the free Product in each (one per order).</p>\n\n<p>I've tried something like this:</p>\n\n<pre><code>this.ObjectContext.ORDERS.Include(\"PRODUCTS\").Where(e=&gt;e.PRODUCTS.price == 0).OrderBy(e =&gt; e.Order);\n</code></pre>\n\n<p>But this is not working.</p>\n\n<p>Is there any other approach??</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["json","linq","mvc","autocomplete"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13051272,"title":"MVC autocomplete how do I get my list of items into an object to return to Json","body":"<p>I am returning a List from the database. I need to return an Object for the Json method.\nAny Ideas. I am new to linq and MVC. </p>\n\n<pre><code>public ActionResult Autocomplete(string term)\n        {\n            var names = itemsRepository.GetListItemNames(term);\n              ///linq code to get my name object out\n            return Json(names, JsonRequestBehavior.AllowGet);\n        }\n</code></pre>\n"},{"tags":["linq","c#-4.0","lambda","entity-framework-4.1"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":52,"score":-2,"question_id":13050032,"title":"Lambda Expression for Many to Many in C#","body":"<p>I'm using EF 5 Code First and VS 2012.\nI have  classes for Articles and Tags. Each Article will have atleast one Tag associated.\nPlease see the classes below.</p>\n\n<pre><code>public class Article\n{\n    public int ArticleId { get; set; }\n    public virtual ICollection&lt;ArticleTag&gt; Tags { get; set; }\n}\npublic class Tag\n{\n    public int TagId { get; set; }\n    public string TagName { get; set; }\n}\n\npublic class ArticleTag\n{\n    public int ArticleId { get; set; }\n    public int TagId { get; set; }\n\n    // navigation property\n    public virtual Article Article { get; set; }\n    public virtual Tag Tag { get; set; }\n}\n</code></pre>\n\n<p>Below is the code I tried. <strong>requestTags</strong> contains the list of TadgIds. <strong>repBase</strong> is db context. But below code is returing inconsistent results.</p>\n\n<pre><code>var idList = requestTags.tags.Select(t =&gt; t.id).ToList();\n var result= repBase.GetAll&lt;Article&gt;().Select(tg =&gt; tg.Tags.Where(tk =&gt; idList.Contains(tk.TagId))).ToList();\n</code></pre>\n\n<p>Please hlep me to get list of articles for a given list of TagIds. </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","linq","date","where","dayofweek"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":442,"score":4,"question_id":1034952,"title":"Select current week using LINQ","body":"<p>How do I write the <code>where</code> statement that select records with <code>Date</code> field between <code>Sunday</code> to <code>Saturday</code> of a given date.</p>\n\n<pre><code>Data Fields: Id, Name, Date\n</code></pre>\n"},{"tags":["c#","xml","linq","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":95,"score":1,"question_id":13001511,"title":"How to select child nodes at unknown child element location using LINQ","body":"<p>My XML file consists of a structure that resembles something like the following:</p>\n\n<pre><code>&lt;root&gt;\n    &lt;Manager name=\"1\"&gt;\n        &lt;Manager name=\"2\"&gt;\n            &lt;Employee name=\"3\"&gt;\n        &lt;/Manager&gt;\n        &lt;Manager name=\"abe\"&gt;\n        &lt;/Manager&gt;\n        &lt;Employee name=\"4\"&gt;\n        &lt;Employee name=\"5\"&gt;\n    &lt;/Manager&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>The XML feeds a treeview, and depending on where in the treeview a user clicks, I either want to retrieve the Employee clicked on (which is easy, as I can use <code>treeview.SelectedNode</code>), or otherwise in case the click was on the root node, or a manager node, the first employee under the manager. </p>\n\n<p>I.e. </p>\n\n<ul>\n<li>Clicking on <code>root</code> should show details of <code>Employee 4</code> (the first Employee record  is directly under <code>Manager 1</code> directly under <code>root</code>). </li>\n<li>Clicking on <code>Manager 1</code> also should show <code>Employee 4</code>. </li>\n<li>Clicking <code>Manager 2</code> should show <code>Employee 3</code>. </li>\n<li>Clicking <code>Manager Abe</code> yields no results. </li>\n<li><code>Employee 5</code> only shows when there is a click directly on that employee. </li>\n</ul>\n\n<p>It could also be possible that <code>Manager 1</code> does not have any direct employees under him. In that case, clicking on root should yield the first Employee under the first manager with employees. So if we assume <code>Employee 4</code> and <code>Employee 5</code> were not under <code>Manager 1</code>, clicking on root would yield <code>Employee 3</code>.</p>\n\n<p>I tried using some different variants of <code>Element</code>, <code>Elements</code>, <code>Descendant</code> and <code>Descendants</code>, and am a bit stuck. </p>\n\n<p>I suppose that I could write scenarios for every individual combination (I.e. <code>rootClicked</code>, <code>managerClicked</code> and <code>employeeClicked</code>), which is what I did originally, but I'm looking for something that will hopefully be easier to maintain, code-wise. </p>\n\n<p>I had good hopes that using root.Element(\"Employee\") would help, but that threw a <code>Could not find an implementation of the query pattern for source type 'System.Xml.Linq.XEelement'.  'select' not found</code> error. </p>\n\n<p>Would anyone be able to supply me with that little nudge I need to solve my issue?</p>\n"},{"tags":["c#","linq","join","datatable"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":171,"score":4,"question_id":13029390,"title":"DataTable Linq join many columns","body":"<p>I have a trouble with Linq Join. I want to join 2 tables, which they have same structure with n-columns. My problem is i don't know the names of those columns, so how can i rewrite those in select new?</p>\n\n<p>Table 1: Here I have some parameters in ID, Name and LastName. Comment, Attribute and the rest are null</p>\n\n<pre><code> ID    Name   LastName  Comment   Attribute ...     \n                         \"what\"   \"ABC\"     ...\n                         \"hello\"  \"SDE\"     ...\n 3     lola               \n 1              de           \n 4     miki      \n ...   ...      ...      ...  \n</code></pre>\n\n<p>Table 2: Here is the same like Table 1 but it has some parameters in Comment, Attribute and the Rest.        </p>\n\n<pre><code> ID    Name   LastName  Comment   Attribute ...\n                        \"what\"   \"ABC\"     ...\n                        \"hello\"  \"SDE\"     ...\n 1              de       \"hi\"     \n 4     miki                      \"OKK\"\n 3     lola             \"yo\"     \"LL\"\n</code></pre>\n\n<p>Result: I would like to have joined Table like this</p>\n\n<pre><code> ID    Name   LastName  Comment   Attribute ...\n                        \"what\"   \"ABC\"     ...\n                        \"hello\"  \"SDE\"     ...\n 3     lola               \"yo\"    \"LL\" \n 1               de        \"hi\"   \n 4     miki                       \"OKK\"\n ...   ...      ...      ...       ...     ...\n</code></pre>\n\n<p>My Code would be:</p>\n\n<pre><code>var Result= from tb1 in table1.AsEnumerable()\n            join tb2 in tabl2.AsEnumerable()\n            on new\n            {                \n             Name = tb1.Field&lt;String&gt;(\"Name\"),\n             LastName = tb1.Field&lt;String&gt;(\"LastName\"),\n             } equals new\n            {\n             Name=tb2.Field&lt;String&gt;(\"Name\"),\n             LastName=tb2.Field&lt;String&gt;(\"LastName\"),\n             }\n            into grp1\n            from tb3 in grp1.DefaultIfEmpty()\n            select new\n    {\n     ID = tb1.Field&lt;String&gt;(\"ID\"),\n     Name = tb1.Field&lt;String&gt;(\"Name\") ,\n     LastName = tb1.Field&lt;String&gt;(\"LastName\"),\n     Comment = tb3!= null ? tb3.Field&lt;String&gt;(\"Comment\") : null,\n     Attribute= tb3!= null ? tb3.Field&lt;String&gt;(\"Attribute\") : null,\n     ...\n     // Here should be next Columns Name but don't know how to put there\n\n     };\n</code></pre>\n\n<hr>\n\n<p>I tried with this code but my compiler just hanged out, dont know why</p>\n\n<pre><code>        for (int i = 2; i &lt; table1.Rows.Count; i++)\n        {\n            foreach (DataRow dr in table2.Rows)\n            {\n                if ((table1.Rows[i][\"Name\"].ToString() == dr[\"Name\"].ToString())&amp;&amp;table1.Rows[i][\"LastName\"].ToString() == dr[\"LastName\"].ToString())\n                {\n                    table1.Rows.RemoveAt(i);\n                    table1.ImportRow(dr);\n\n                }\n            }\n        }\n        dataGridView1.DataSource = table1;\n</code></pre>\n"},{"tags":[".net","xml","linq","unit-testing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":350,"score":1,"question_id":7318157,"title":"Best way to compare XElement objects","body":"<p>in a unit test I'm comparing an XElement object with the one I expect. The method I use is to invoke .ToString() on the XElement object and compare it witha hard-codeds string value. This method turned out to be quite uncomfortable since I always have to pay attention on the formattin in the string.</p>\n\n<p>I checked out the XElement.DeepEquals() method but for any reason it doesn't help.</p>\n\n<p>Does anyone has an idea what is the best method I should use?</p>\n\n<p>Thanx in advance,\nllasarov</p>\n"},{"tags":["c#","asp.net","database","linq","linq-to-sql"],"answer_count":6,"favorite_count":3,"up_vote_count":15,"down_vote_count":0,"view_count":11209,"score":15,"question_id":4221,"title":"LinqDataSource - Can you limit the amount of records returned?","body":"<p>I'd like to use a <code>LinqDataSource</code> control on a page and limit the amount of records returned.  I know if I use code behind I could do something like this:</p>\n\n<pre><code>IEnumerable&lt;int&gt; values = Enumerable.Range(0, 10);\nIEnumerable&lt;int&gt; take3 = values.Take(3);\n</code></pre>\n\n<p>Does anyone know if something like this is possible with a <code>LinqDataSource</code> control?</p>\n\n<p><strong>[Update]</strong></p>\n\n<p>I'm going to use the <code>LinqDataSource</code> with the <code>ListView</code> control, <em>not</em> a GridView or Repeater.  The <code>LinqDataSource</code> wizard does not provide the ability to limit the number of records return.  The Advanced options only allow you to enabled deletes, inserts, and updates.</p>\n"},{"tags":["sql","asp.net-mvc-3","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":223,"score":1,"question_id":11596699,"title":"Convert SQL to LINQ in MVC3 with Ninject","body":"<p>I'm using MVC3 and still learning LINQ.  I'm having some trouble trying to convert a query to LINQ to Entities.  I want to return an employee object.</p>\n\n<pre><code>SELECT E.EmployeeID, E.FirstName, E.LastName, MAX(EO.EmployeeOperationDate) AS \"Last Operation\"\nFROM Employees E \nINNER JOIN EmployeeStatus ES ON E.EmployeeID = ES.EmployeeID\nINNER JOIN EmployeeOperations EO ON ES.EmployeeStatusID = EO.EmployeeStatusID\nINNER JOIN Teams T ON T.TeamID = ES.TeamID\nWHERE T.TeamName = 'MyTeam'\nGROUP BY E.EmployeeID, E.FirstName, E.LastName\nORDER BY E.FirstName, E.LastName\n</code></pre>\n\n<p>What I have is a few tables, but I need to get only the newest status based on the EmployeeOpertionDate.  This seems to work fine in SQL.  I'm also using Ninject and set my query to return Ienumerable.  I played around with the group by option but it then returns IGroupable.  Any guidance on converting and returning the property object type would be appreciated. </p>\n\n<p>Edit:  I started writing this out in LINQ but I'm not sure how to properly return the correct type or cast this.</p>\n\n<pre><code>public IQueryable&lt;Employee&gt; GetEmployeesByTeam(int teamID)\n    {\n\n        var q = from E in context.Employees\n                join ES in context.EmployeeStatuses on E.EmployeeID equals ES.EmployeeID\n                join EO in context.EmployeeOperations on ES.EmployeeStatusID equals EO.EmployeeStatusID\n                join T in context.Teams on ES.TeamID equals T.TeamID\n                where T.TeamName == \"MyTeam\"\n                group E by E.EmployeeID into G\n                select G;\n        return q;\n    }\n</code></pre>\n\n<p>Edit2:</p>\n\n<p>This seems to work for me</p>\n\n<pre><code>public IQueryable&lt;Employee&gt; GetEmployeesByTeam(int teamID)\n    {\n\n        var q = from E in context.Employees\n                join ES in context.EmployeeStatuses on E.EmployeeID equals ES.EmployeeID\n                join EO in context.EmployeeOperations.OrderByDescending(eo =&gt; eo.EmployeeOperationDate) on ES.EmployeeStatusID equals EO.EmployeeStatusID\n                join T in context.Teams on ES.TeamID equals T.TeamID\n                where T.TeamID == teamID\n                group E by E.EmployeeID into G\n                select G.FirstOrDefault();\n        return q;\n    }\n</code></pre>\n"},{"tags":["c#","linq","lambda","one-to-many"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13045165,"title":"lambda expression for one to many relationship","body":"<p>I am sure this is stupid question, but I looked for an answer and couldn't find one.</p>\n\n<p>I have tables </p>\n\n<ol>\n<li>Customers contain three columns: userId, name and orderId.</li>\n<li>Orders contain three columns: orderId, userId, price.</li>\n</ol>\n\n<p>The relationship between the tables are ONE customers TO MANY orders.</p>\n\n<p>I want to sum the orders price for certain user.\nIt should look something like this:</p>\n\n<pre><code>double totalPrice = currentUser.Orders.Sum(x=&gt;x.price);\n</code></pre>\n\n<p>This doesn't work. What is the right way to do this? Thanks.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":5,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":8422,"score":9,"question_id":2381049,"title":"Intersect LINQ query","body":"<p>If I have an IEnumerable where ClassA exposes an ID property of type long.\nIs it possible to use a Linq query to get all instances of ClassA with ID belonging to a second IEnumerable?</p>\n\n<p>In other words, can this be done?</p>\n\n<pre><code>IEnumerable&lt;ClassA&gt; = original.Intersect(idsToFind....)?\n</code></pre>\n\n<p>where original is an <code>IEnumerable&lt;ClassA&gt;</code> and idsToFind is <code>IEnumerable&lt;long&gt;</code>.</p>\n"},{"tags":[".net","linq","datasource"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13046924,"title":"Which interface implement to use an Array of (MyType) as a DataSource?","body":"<p>I have a LINQ query like the following:</p>\n\n<pre><code>    allRecords = (From metaset In section.sets\n                  From metacell In metaset.cells\n                  Let attrib = metacell.attrib\n                  Order By attrib.attrib_name\n                  Select Attribute = attrib.attrib_name,\n                         Type = attrib.attrib_name,\n                         Col = metacell.column,\n                         Row = metacell.row\n                     ).ToArray()\n</code></pre>\n\n<p>It return an <code>&lt;anonymous type&gt;</code> array.<br/>And when I write <code>myDataGridView.DataSource = allRecords</code>, the grid correctly fills.\n<br/><br/></p>\n\n<p>But, if I modify the query to return an array of <code>CellDetail</code> objects, instead of <code>&lt;anonymous type&gt;</code>:</p>\n\n<pre><code>    allRecords = (From metaset In section.sets\n                  From metacell In metaset.cells\n                  Let attrib = metacell.attrib\n                  Order By attrib.attrib_name\n                  Select New CellDetail With {\n                         .Attribute = attrib.attrib_name,\n                         .Type = attrib.attrib_name,\n                         .Col = metacell.column,\n                         .Row = metacell.row\n                     ).ToArray()\n</code></pre>\n\n<p>where <code>CellDetail</code> is so defined:</p>\n\n<pre><code>Public Class CellDetail\n\n    Public Attribute As String\n    Public Type As String\n    Public Col As Int32\n    Public Row As Int32\n\nEnd Class\n</code></pre>\n\n<p>The DataGridView doesn't find compatible data and doesn't show nothing!</p>\n\n<p>Is there a .Net interface I should implement to make <code>CellDetail</code> class compatible with the DataSource of a DataGridView?</p>\n"},{"tags":["c#","linq","dynamic",".net-4.0","lambda"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":440,"score":0,"question_id":8978619,"title":"query a list of dynamic objects for a FirstOrDefault","body":"<p>The following code will return an Enumerable of dynamic objects.</p>\n\n<pre><code>protected override dynamic Get(int id)\n{ \n    Func&lt;dynamic, bool&gt; check = x =&gt; x.ID == id;\n    return  Enumerable.Where&lt;dynamic&gt;(this.Get(), check);\n}\n</code></pre>\n\n<p>How do I select the <strong>FirstOrDefault</strong> so it is a single object not an Enumerable?</p>\n\n<p>Similar to <a href=\"http://stackoverflow.com/questions/8828105/query-a-list-of-dynamic-objects\">this answer</a> but just want SingleOrDefault. </p>\n"},{"tags":["c#",".net","linq","ienumerable"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":73,"score":0,"question_id":13045675,"title":"Concatenate enumerable and a number in Linq","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4189563/what-is-the-best-wayto-add-single-element-to-an-ienumerable-collection\">What is the best wayto add single element to an IEnumerable collection?</a>  </p>\n</blockquote>\n\n\n\n<p>Let's say I want to concantenate Enumerable.Repeat(100, 100) and the number 3, what is the nicest way to do this?</p>\n\n<p>Of course I can do\n<code>Enumerable.Repeat(100, 100).Concat(Enumerable.Repeat(3,1))</code>, but it doesn't look very expressive...</p>\n"},{"tags":["c#","linq","compiler-errors","ienumerable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13045470,"title":"Could not find an implementation of the query pattern on IEnumerable<T>","body":"<p>\nI've got an <code>IEnumerable&lt;T&gt;</code> as a parameter of a method, where <code>T</code> is a struct type:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing ...\n\npublic static class Foo\n{\n    internal struct CellDiff\n    {\n        public int RefX;\n        public int RefY;\n        public object OldValue;\n        public object NewValue;\n    }\n\n    private static void ItemChanged(IEnumerable&lt;CellDiff&gt; diffs, int cellX, int cellY)\n    {\n        var change = from CellDiff diff in diffs\n                     where diff.RefX == cellX &amp;&amp; diff.RefY == cellY\n                     select diff;\n\n        ...\n    }\n}\n</code></pre>\n\n<p>This results in the following error:</p>\n\n<blockquote>\n  <p>(parameter) <code>IEnumerable&lt;CellDiff&gt; diffs</code></p>\n  \n  <p>Error:<br />\n  Could not find an implementation of the query pattern for source type '<code>CellDiff</code>'. '<code>Where</code>' not found.</p>\n</blockquote>\n\n<p>I've also tried doing <code>diffs.AsQueryable()</code>, to no avail.</p>\n\n<p>I usually have no problem doing LINQ queries on <code>IEnumerable&lt;T&gt;</code>. I'm a bit lost as to what's happening here.</p>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13045078,"title":"How do I change this sql query to linq to sql?","body":"<p>I wrote the query and I want convert it to linq query</p>\n\n<pre><code>SELECT     dbo.tblSaman.fldSamanId, dbo.tblFaaliatSaman.FldFaaliatId\nFROM         dbo.tblSaman LEFT OUTER JOIN\n                  dbo.tblFaaliatSaman ON dbo.tblSaman.fldSamanId = dbo.tblFaaliatSaman.fldSamanId\nWHERE     (dbo.tblFaaliatSaman.FldFaaliatId IN (3, 4))\n</code></pre>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13045303,"title":"linq function to handle : both fields equal or both null or empty","body":"<p>Hi I have a linq query where I compare an object with all other entity stored in my database. Firstname and lastname are mandatory fields so I don't have to check for null. But in the case of street I have to do these checks. </p>\n\n<p>I want to match if both fields are null or empty strings or that they are the same. The below linq query is working fine. </p>\n\n<p>But I was wandering isn't there any way to make it more readable. For example with a custom function like <strong>Bool FieldsAreEqualOrBothNullOrEmpty(r.street, request.street)</strong> </p>\n\n<p>Can't figure how to do that and if it's possible. </p>\n\n<pre><code>var same = \n   from r in db.Requests\n   where r.firstName.ToLower() == request.firstName.ToLower()\n      &amp;&amp; r.lastName.ToLower() == request.lastName.ToLower()\n\n      //Seems long to just compare two fields\n      &amp;&amp; ( string.IsNullOrEmpty(r.street) &amp;&amp; string.IsNullOrEmpty(request.street) ) \n         || r.street.ToLower() == request.street.ToLower()\n\n      select r;\nreturn same;\n</code></pre>\n"},{"tags":["linq","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12976414,"title":"Entity Framework/ Linq - groupby and having clause","body":"<p>Given the query below</p>\n\n<pre><code>       public TrainingListViewModel(List&lt;int&gt; employeeIdList)\n        {\n            this.EmployeeOtherLeaveItemList =\n                CacheObjects.AllEmployeeOtherLeaves\n                .Where(x =&gt; x.OtherLeaveDate &gt;= Utility.GetToday() &amp;&amp;\n                    x.CancelDate.HasValue == false &amp;&amp;\n                    x.OtherLeaveId == Constants.TrainingId)\n                .OrderBy(x =&gt; x.OtherLeaveDate)\n                .Select(x =&gt; new EmployeeOtherLeaveItem\n                {\n                    EmployeeOtherLeave = x,\n                    SelectedFlag = false\n                }).ToList();\n        }\n</code></pre>\n\n<p>I want to put in the employeeIdList into the query.\nI want to retrieve all of the x.OtherLeaveDate values where the same x.OtherLeaveDate exists for each join where x.EmployeeId = (int employeeId in employeeIdList)</p>\n\n<p>For example if there are EmployeeIds 1, 2, 3 in employeeIdList and in the CacheObjects.AllEmployeeOtherLeaves collection there is a date 1/1/2001 for all 3 employees, then retreive that date.</p>\n"},{"tags":["linq","dynamic-linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2626,"score":2,"question_id":2025878,"title":"How to do the following in Dynamic Linq using System.Linq.Dynamic namespace","body":"<p>I just want to know how to do the following in Dynamic Linq using System.Linq.Dynamic namespace</p>\n\n<pre><code>var query2 = db.Customers.Select(\n                    cust =&gt; new Customer\n                    {\n                        FirstName = cust.FirstName,\n                        LastName = cust.LastName\n                        Tags=\"sampleTag,Tag\"\n                    }\n                ).ToList&lt;Customer&gt;();\n</code></pre>\n\n<p>I was able to make it in dynamic but I can't include <em>Tags</em>, here:</p>\n\n<pre><code>var query1 = db.Customers.Select&lt;Customer&gt;(\"new (FirstName, LastName)\");\n</code></pre>\n\n<p>Or if there are other suggestions, they are very much welcome. :)</p>\n\n<hr>\n\n<pre><code>**Below is the code --&gt; the System.Linq.Dynamic namespace:**\n\n//Copyright (C) Microsoft Corporation.  All rights reserved.\n//http://stackoverflow.com/questions/1465700/system-linq-dynamic-select-new-into-a-listt-or-any-other-enumerable\n\n\nusing System;\nusing System.Collections.Generic;\nusing System.Text;\nusing System.Linq;\nusing System.Linq.Expressions;\nusing System.Reflection;\nusing System.Reflection.Emit;\nusing System.Threading;\n\nnamespace System.Linq.Dynamic\n{\n    public static class DynamicQueryable\n    {\n        public static IQueryable&lt;T&gt; Where&lt;T&gt;(this IQueryable&lt;T&gt; source, string predicate, params object[] values)\n        {\n            return (IQueryable&lt;T&gt;)Where((IQueryable)source, predicate, values);\n        }\n\n        public static IQueryable Where(this IQueryable source, string predicate, params object[] values)\n        {\n            if (source == null) throw new ArgumentNullException(\"source\");\n            if (predicate == null) throw new ArgumentNullException(\"predicate\");\n            LambdaExpression lambda = DynamicExpression.ParseLambda(source.ElementType, typeof(bool), predicate, values);\n            return source.Provider.CreateQuery(\n                Expression.Call(\n                    typeof(Queryable), \"Where\",\n                    new Type[] { source.ElementType },\n                    source.Expression, Expression.Quote(lambda)));\n        }\n\n        public static IQueryable&lt;TResult&gt; Select&lt;TResult&gt;(this IQueryable source, string selector, params object[] values)\n        {\n            if (source == null) throw new ArgumentNullException(\"source\");\n            if (selector == null) throw new ArgumentNullException(\"selector\");\n            LambdaExpression lambda = DynamicExpression.ParseLambda(source.ElementType, typeof(TResult), selector, values);\n            return source.Provider.CreateQuery&lt;TResult&gt;(\n                Expression.Call(\n                    typeof(Queryable), \"Select\",\n                    new Type[] { source.ElementType, typeof(TResult) },\n                    source.Expression, Expression.Quote(lambda)));\n        }\n\n        public static IQueryable&lt;T&gt; OrderBy&lt;T&gt;(this IQueryable&lt;T&gt; source, string ordering, params object[] values)\n        {\n            return (IQueryable&lt;T&gt;)OrderBy((IQueryable)source, ordering, values);\n        }\n\n        public static IQueryable OrderBy(this IQueryable source, string ordering, params object[] values)\n        {\n            if (source == null) throw new ArgumentNullException(\"source\");\n            if (ordering == null) throw new ArgumentNullException(\"ordering\");\n            ParameterExpression[] parameters = new ParameterExpression[] {\n                Expression.Parameter(source.ElementType, \"\") };\n            ExpressionParser parser = new ExpressionParser(parameters, ordering, values);\n            IEnumerable&lt;DynamicOrdering&gt; orderings = parser.ParseOrdering();\n            Expression queryExpr = source.Expression;\n            string methodAsc = \"OrderBy\";\n            string methodDesc = \"OrderByDescending\";\n            foreach (DynamicOrdering o in orderings)\n            {\n                queryExpr = Expression.Call(\n                    typeof(Queryable), o.Ascending ? methodAsc : methodDesc,\n                    new Type[] { source.ElementType, o.Selector.Type },\n                    queryExpr, Expression.Quote(Expression.Lambda(o.Selector, parameters)));\n                methodAsc = \"ThenBy\";\n                methodDesc = \"ThenByDescending\";\n            }\n            return source.Provider.CreateQuery(queryExpr);\n        }\n\n        public static IQueryable Take(this IQueryable source, int count)\n        {\n            if (source == null) throw new ArgumentNullException(\"source\");\n            return source.Provider.CreateQuery(\n                Expression.Call(\n                    typeof(Queryable), \"Take\",\n                    new Type[] { source.ElementType },\n                    source.Expression, Expression.Constant(count)));\n        }\n\n        public static IQueryable Skip(this IQueryable source, int count)\n        {\n            if (source == null) throw new ArgumentNullException(\"source\");\n            return source.Provider.CreateQuery(\n                Expression.Call(\n                    typeof(Queryable), \"Skip\",\n                    new Type[] { source.ElementType },\n                    source.Expression, Expression.Constant(count)));\n        }\n\n        public static IQueryable GroupBy(this IQueryable source, string keySelector, string elementSelector, params object[] values)\n        {\n            if (source == null) throw new ArgumentNullException(\"source\");\n            if (keySelector == null) throw new ArgumentNullException(\"keySelector\");\n            if (elementSelector == null) throw new ArgumentNullException(\"elementSelector\");\n            LambdaExpression keyLambda = DynamicExpression.ParseLambda(source.ElementType, null, keySelector, values);\n            LambdaExpression elementLambda = DynamicExpression.ParseLambda(source.ElementType, null, elementSelector, values);\n            return source.Provider.CreateQuery(\n                Expression.Call(\n                    typeof(Queryable), \"GroupBy\",\n                    new Type[] { source.ElementType, keyLambda.Body.Type, elementLambda.Body.Type },\n                    source.Expression, Expression.Quote(keyLambda), Expression.Quote(elementLambda)));\n        }\n\n        public static bool Any(this IQueryable source)\n        {\n            if (source == null) throw new ArgumentNullException(\"source\");\n            return (bool)source.Provider.Execute(\n                Expression.Call(\n                    typeof(Queryable), \"Any\",\n                    new Type[] { source.ElementType }, source.Expression));\n        }\n\n        public static int Count(this IQueryable source)\n        {\n            if (source == null) throw new ArgumentNullException(\"source\");\n            return (int)source.Provider.Execute(\n                Expression.Call(\n                    typeof(Queryable), \"Count\",\n                    new Type[] { source.ElementType }, source.Expression));\n        }\n    }\n\n    public abstract class DynamicClass\n    {\n        public override string ToString()\n        {\n            PropertyInfo[] props = this.GetType().GetProperties(BindingFlags.Instance | BindingFlags.Public);\n            StringBuilder sb = new StringBuilder();\n            sb.Append(\"{\");\n            for (int i = 0; i &lt; props.Length; i++)\n            {\n                if (i &gt; 0) sb.Append(\", \");\n                sb.Append(props[i].Name);\n                sb.Append(\"=\");\n                sb.Append(props[i].GetValue(this, null));\n            }\n            sb.Append(\"}\");\n            return sb.ToString();\n        }\n    }\n\n    public class DynamicProperty\n    {\n        string name;\n        Type type;\n\n        public DynamicProperty(string name, Type type)\n        {\n            if (name == null) throw new ArgumentNullException(\"name\");\n            if (type == null) throw new ArgumentNullException(\"type\");\n            this.name = name;\n            this.type = type;\n        }\n\n        public string Name\n        {\n            get { return name; }\n        }\n\n        public Type Type\n        {\n            get { return type; }\n        }\n    }\n\n    public static class DynamicExpression\n    {\n        public static Expression Parse(Type resultType, string expression, params object[] values)\n        {\n            ExpressionParser parser = new ExpressionParser(null, expression, values);\n            return parser.Parse(resultType);\n        }\n\n        public static LambdaExpression ParseLambda(Type itType, Type resultType, string expression, params object[] values)\n        {\n            return ParseLambda(new ParameterExpression[] { Expression.Parameter(itType, \"\") }, resultType, expression, values);\n        }\n\n        public static LambdaExpression ParseLambda(ParameterExpression[] parameters, Type resultType, string expression, params object[] values)\n        {\n            ExpressionParser parser = new ExpressionParser(parameters, expression, values);\n            return Expression.Lambda(parser.Parse(resultType), parameters);\n        }\n\n        public static Expression&lt;Func&lt;T, S&gt;&gt; ParseLambda&lt;T, S&gt;(string expression, params object[] values)\n        {\n            return (Expression&lt;Func&lt;T, S&gt;&gt;)ParseLambda(typeof(T), typeof(S), expression, values);\n        }\n\n        public static Type CreateClass(params DynamicProperty[] properties)\n        {\n            return ClassFactory.Instance.GetDynamicClass(properties);\n        }\n\n        public static Type CreateClass(IEnumerable&lt;DynamicProperty&gt; properties)\n        {\n            return ClassFactory.Instance.GetDynamicClass(properties);\n        }\n    }\n\n    internal class DynamicOrdering\n    {\n        public Expression Selector;\n        public bool Ascending;\n    }\n\n    internal class Signature : IEquatable&lt;Signature&gt;\n    {\n        public DynamicProperty[] properties;\n        public int hashCode;\n\n        public Signature(IEnumerable&lt;DynamicProperty&gt; properties)\n        {\n            this.properties = properties.ToArray();\n            hashCode = 0;\n            foreach (DynamicProperty p in properties)\n            {\n                hashCode ^= p.Name.GetHashCode() ^ p.Type.GetHashCode();\n            }\n        }\n\n        public override int GetHashCode()\n        {\n            return hashCode;\n        }\n\n        public override bool Equals(object obj)\n        {\n            return obj is Signature ? Equals((Signature)obj) : false;\n        }\n\n        public bool Equals(Signature other)\n        {\n            if (properties.Length != other.properties.Length) return false;\n            for (int i = 0; i &lt; properties.Length; i++)\n            {\n                if (properties[i].Name != other.properties[i].Name ||\n                    properties[i].Type != other.properties[i].Type) return false;\n            }\n            return true;\n        }\n    }\n\n    internal class ClassFactory\n    {\n        public static readonly ClassFactory Instance = new ClassFactory();\n\n        static ClassFactory() { }  // Trigger lazy initialization of static fields\n\n        ModuleBuilder module;\n        Dictionary&lt;Signature, Type&gt; classes;\n        int classCount;\n        ReaderWriterLock rwLock;\n\n        private ClassFactory()\n        {\n            AssemblyName name = new AssemblyName(\"DynamicClasses\");\n            AssemblyBuilder assembly = AppDomain.CurrentDomain.DefineDynamicAssembly(name, AssemblyBuilderAccess.Run);\n#if ENABLE_LINQ_PARTIAL_TRUST\n            new ReflectionPermission(PermissionState.Unrestricted).Assert();\n#endif\n            try\n            {\n                module = assembly.DefineDynamicModule(\"Module\");\n            }\n            finally\n            {\n#if ENABLE_LINQ_PARTIAL_TRUST\n                PermissionSet.RevertAssert();\n#endif\n            }\n            classes = new Dictionary&lt;Signature, Type&gt;();\n            rwLock = new ReaderWriterLock();\n        }\n\n        public Type GetDynamicClass(IEnumerable&lt;DynamicProperty&gt; properties)\n        {\n            rwLock.AcquireReaderLock(Timeout.Infinite);\n            try\n            {\n                Signature signature = new Signature(properties);\n                Type type;\n                if (!classes.TryGetValue(signature, out type))\n                {\n                    type = CreateDynamicClass(signature.properties);\n                    classes.Add(signature, type);\n                }\n                return type;\n            }\n            finally\n            {\n                rwLock.ReleaseReaderLock();\n            }\n        }\n\n        Type CreateDynamicClass(DynamicProperty[] properties)\n        {\n            LockCookie cookie = rwLock.UpgradeToWriterLock(Timeout.Infinite);\n            try\n            {\n                string typeName = \"DynamicClass\" + (classCount + 1);\n#if ENABLE_LINQ_PARTIAL_TRUST\n                new ReflectionPermission(PermissionState.Unrestricted).Assert();\n#endif\n                try\n                {\n                    TypeBuilder tb = this.module.DefineType(typeName, TypeAttributes.Class |\n                        TypeAttributes.Public, typeof(DynamicClass));\n                    FieldInfo[] fields = GenerateProperties(tb, properties);\n                    GenerateEquals(tb, fields);\n                    GenerateGetHashCode(tb, fields);\n                    Type result = tb.CreateType();\n                    classCount++;\n                    return result;\n                }\n                finally\n                {\n#if ENABLE_LINQ_PARTIAL_TRUST\n                    PermissionSet.RevertAssert();\n#endif\n                }\n            }\n            finally\n            {\n                rwLock.DowngradeFromWriterLock(ref cookie);\n            }\n        }\n\n        FieldInfo[] GenerateProperties(TypeBuilder tb, DynamicProperty[] properties)\n        {\n            FieldInfo[] fields = new FieldBuilder[properties.Length];\n            for (int i = 0; i &lt; properties.Length; i++)\n            {\n                DynamicProperty dp = properties[i];\n                FieldBuilder fb = tb.DefineField(\"_\" + dp.Name, dp.Type, FieldAttributes.Private);\n                PropertyBuilder pb = tb.DefineProperty(dp.Name, PropertyAttributes.HasDefault, dp.Type, null);\n                MethodBuilder mbGet = tb.DefineMethod(\"get_\" + dp.Name,\n                    MethodAttributes.Public | MethodAttributes.SpecialName | MethodAttributes.HideBySig,\n                    dp.Type, Type.EmptyTypes);\n                ILGenerator genGet = mbGet.GetILGenerator();\n                genGet.Emit(OpCodes.Ldarg_0);\n                genGet.Emit(OpCodes.Ldfld, fb);\n                genGet.Emit(OpCodes.Ret);\n                MethodBuilder mbSet = tb.DefineMethod(\"set_\" + dp.Name,\n                    MethodAttributes.Public | MethodAttributes.SpecialName | MethodAttributes.HideBySig,\n                    null, new Type[] { dp.Type });\n                ILGenerator genSet = mbSet.GetILGenerator();\n                genSet.Emit(OpCodes.Ldarg_0);\n                genSet.Emit(OpCodes.Ldarg_1);\n                genSet.Emit(OpCodes.Stfld, fb);\n                genSet.Emit(OpCodes.Ret);\n                pb.SetGetMethod(mbGet);\n                pb.SetSetMethod(mbSet);\n                fields[i] = fb;\n            }\n            return fields;\n        }\n\n        void GenerateEquals(TypeBuilder tb, FieldInfo[] fields)\n        {\n            MethodBuilder mb = tb.DefineMethod(\"Equals\",\n                MethodAttributes.Public | MethodAttributes.ReuseSlot |\n                MethodAttributes.Virtual | MethodAttributes.HideBySig,\n                typeof(bool), new Type[] { typeof(object) });\n            ILGenerator gen = mb.GetILGenerator();\n            LocalBuilder other = gen.DeclareLocal(tb);\n            Label next = gen.DefineLabel();\n            gen.Emit(OpCodes.Ldarg_1);\n            gen.Emit(OpCodes.Isinst, tb);\n            gen.Emit(OpCodes.Stloc, other);\n            gen.Emit(OpCodes.Ldloc, other);\n            gen.Emit(OpCodes.Brtrue_S, next);\n            gen.Emit(OpCodes.Ldc_I4_0);\n            gen.Emit(OpCodes.Ret);\n            gen.MarkLabel(next);\n            foreach (FieldInfo field in fields)\n            {\n                Type ft = field.FieldType;\n                Type ct = typeof(EqualityComparer&lt;&gt;).MakeGenericType(ft);\n                next = gen.DefineLabel();\n                gen.EmitCall(OpCodes.Call, ct.GetMethod(\"get_Default\"), null);\n                gen.Emit(OpCodes.Ldarg_0);\n                gen.Emit(OpCodes.Ldfld, field);\n                gen.Emit(OpCodes.Ldloc, other);\n                gen.Emit(OpCodes.Ldfld, field);\n                gen.EmitCall(OpCodes.Callvirt, ct.GetMethod(\"Equals\", new Type[] { ft, ft }), null);\n                gen.Emit(OpCodes.Brtrue_S, next);\n                gen.Emit(OpCodes.Ldc_I4_0);\n                gen.Emit(OpCodes.Ret);\n                gen.MarkLabel(next);\n            }\n            gen.Emit(OpCodes.Ldc_I4_1);\n            gen.Emit(OpCodes.Ret);\n        }\n\n        void GenerateGetHashCode(TypeBuilder tb, FieldInfo[] fields)\n        {\n            MethodBuilder mb = tb.DefineMethod(\"GetHashCode\",\n                MethodAttributes.Public | MethodAttributes.ReuseSlot |\n                MethodAttributes.Virtual | MethodAttributes.HideBySig,\n                typeof(int), Type.EmptyTypes);\n            ILGenerator gen = mb.GetILGenerator();\n            gen.Emit(OpCodes.Ldc_I4_0);\n            foreach (FieldInfo field in fields)\n            {\n                Type ft = field.FieldType;\n                Type ct = typeof(EqualityComparer&lt;&gt;).MakeGenericType(ft);\n                gen.EmitCall(OpCodes.Call, ct.GetMethod(\"get_Default\"), null);\n                gen.Emit(OpCodes.Ldarg_0);\n                gen.Emit(OpCodes.Ldfld, field);\n                gen.EmitCall(OpCodes.Callvirt, ct.GetMethod(\"GetHashCode\", new Type[] { ft }), null);\n                gen.Emit(OpCodes.Xor);\n            }\n            gen.Emit(OpCodes.Ret);\n        }\n    }\n\n    public sealed class ParseException : Exception\n    {\n        int position;\n\n        public ParseException(string message, int position)\n            : base(message)\n        {\n            this.position = position;\n        }\n\n        public int Position\n        {\n            get { return position; }\n        }\n\n        public override string ToString()\n        {\n            return string.Format(Res.ParseExceptionFormat, Message, position);\n        }\n    }\n\n    internal class ExpressionParser\n    {\n        struct Token\n        {\n            public TokenId id;\n            public string text;\n            public int pos;\n        }\n\n        enum TokenId\n        {\n            Unknown,\n            End,\n            Identifier,\n            StringLiteral,\n            IntegerLiteral,\n            RealLiteral,\n            Exclamation,\n            Percent,\n            Amphersand,\n            OpenParen,\n            CloseParen,\n            Asterisk,\n            Plus,\n            Comma,\n            Minus,\n            Dot,\n            Slash,\n            Colon,\n            LessThan,\n            Equal,\n            GreaterThan,\n            Question,\n            OpenBracket,\n            CloseBracket,\n            Bar,\n            ExclamationEqual,\n            DoubleAmphersand,\n            LessThanEqual,\n            LessGreater,\n            DoubleEqual,\n            GreaterThanEqual,\n            DoubleBar\n        }\n\n        interface ILogicalSignatures\n        {\n            void F(bool x, bool y);\n            void F(bool? x, bool? y);\n        }\n\n        interface IArithmeticSignatures\n        {\n            void F(int x, int y);\n            void F(uint x, uint y);\n            void F(long x, long y);\n            void F(ulong x, ulong y);\n            void F(float x, float y);\n            void F(double x, double y);\n            void F(decimal x, decimal y);\n            void F(int? x, int? y);\n            void F(uint? x, uint? y);\n            void F(long? x, long? y);\n            void F(ulong? x, ulong? y);\n            void F(float? x, float? y);\n            void F(double? x, double? y);\n            void F(decimal? x, decimal? y);\n        }\n\n        interface IRelationalSignatures : IArithmeticSignatures\n        {\n            void F(string x, string y);\n            void F(char x, char y);\n            void F(DateTime x, DateTime y);\n            void F(TimeSpan x, TimeSpan y);\n            void F(char? x, char? y);\n            void F(DateTime? x, DateTime? y);\n            void F(TimeSpan? x, TimeSpan? y);\n        }\n\n        interface IEqualitySignatures : IRelationalSignatures\n        {\n            void F(bool x, bool y);\n            void F(bool? x, bool? y);\n        }\n\n        interface IAddSignatures : IArithmeticSignatures\n        {\n            void F(DateTime x, TimeSpan y);\n            void F(TimeSpan x, TimeSpan y);\n            void F(DateTime? x, TimeSpan? y);\n            void F(TimeSpan? x, TimeSpan? y);\n        }\n\n        interface ISubtractSignatures : IAddSignatures\n        {\n            void F(DateTime x, DateTime y);\n            void F(DateTime? x, DateTime? y);\n        }\n\n        interface INegationSignatures\n        {\n            void F(int x);\n            void F(long x);\n            void F(float x);\n            void F(double x);\n            void F(decimal x);\n            void F(int? x);\n            void F(long? x);\n            void F(float? x);\n            void F(double? x);\n            void F(decimal? x);\n        }\n\n        interface INotSignatures\n        {\n            void F(bool x);\n            void F(bool? x);\n        }\n\n        interface IEnumerableSignatures\n        {\n            void Where(bool predicate);\n            void Any();\n            void Any(bool predicate);\n            void All(bool predicate);\n            void Count();\n            void Count(bool predicate);\n            void Min(object selector);\n            void Max(object selector);\n            void Sum(int selector);\n            void Sum(int? selector);\n            void Sum(long selector);\n            void Sum(long? selector);\n            void Sum(float selector);\n            void Sum(float? selector);\n            void Sum(double selector);\n            void Sum(double? selector);\n            void Sum(decimal selector);\n            void Sum(decimal? selector);\n            void Average(int selector);\n            void Average(int? selector);\n            void Average(long selector);\n            void Average(long? selector);\n            void Average(float selector);\n            void Average(float? selector);\n            void Average(double selector);\n            void Average(double? selector);\n            void Average(decimal selector);\n            void Average(decimal? selector);\n        }\n\n        static readonly Type[] predefinedTypes = {\n            typeof(Object),\n            typeof(Boolean),\n            typeof(Char),\n            typeof(String),\n            typeof(SByte),\n            typeof(Byte),\n            typeof(Int16),\n            typeof(UInt16),\n            typeof(Int32),\n            typeof(UInt32),\n            typeof(Int64),\n            typeof(UInt64),\n            typeof(Single),\n            typeof(Double),\n            typeof(Decimal),\n            typeof(DateTime),\n            typeof(TimeSpan),\n            typeof(Guid),\n            typeof(Math),\n            typeof(Convert)\n        };\n\n        static readonly Expression trueLiteral = Expression.Constant(true);\n        static readonly Expression falseLiteral = Expression.Constant(false);\n        static readonly Expression nullLiteral = Expression.Constant(null);\n\n        static readonly string keywordIt = \"it\";\n        static readonly string keywordIif = \"iif\";\n        static readonly string keywordNew = \"new\";\n\n        static Dictionary&lt;string, object&gt; keywords;\n\n        Dictionary&lt;string, object&gt; symbols;\n        IDictionary&lt;string, object&gt; externals;\n        Dictionary&lt;Expression, string&gt; literals;\n        ParameterExpression it;\n        string text;\n        int textPos;\n        int textLen;\n        char ch;\n        Token token;\n\n        public ExpressionParser(ParameterExpression[] parameters, string expression, object[] values)\n        {\n            if (expression == null) throw new ArgumentNullException(\"expression\");\n            if (keywords == null) keywords = CreateKeywords();\n            symbols = new Dictionary&lt;string, object&gt;(StringComparer.OrdinalIgnoreCase);\n            literals = new Dictionary&lt;Expression, string&gt;();\n            if (parameters != null) ProcessParameters(parameters);\n            if (values != null) ProcessValues(values);\n            text = expression;\n            textLen = text.Length;\n            SetTextPos(0);\n            NextToken();\n        }\n\n        void ProcessParameters(ParameterExpression[] parameters)\n        {\n            foreach (ParameterExpression pe in parameters)\n                if (!String.IsNullOrEmpty(pe.Name))\n                    AddSymbol(pe.Name, pe);\n            if (parameters.Length == 1 &amp;&amp; String.IsNullOrEmpty(parameters[0].Name))\n                it = parameters[0];\n        }\n\n        void ProcessValues(object[] values)\n        {\n            for (int i = 0; i &lt; values.Length; i++)\n            {\n                object value = values[i];\n                if (i == values.Length - 1 &amp;&amp; value is IDictionary&lt;string, object&gt;)\n                {\n                    externals = (IDictionary&lt;string, object&gt;)value;\n                }\n                else\n                {\n                    AddSymbol(\"@\" + i.ToString(System.Globalization.CultureInfo.InvariantCulture), value);\n                }\n            }\n        }\n\n        void AddSymbol(string name, object value)\n        {\n            if (symbols.ContainsKey(name))\n                throw ParseError(Res.DuplicateIdentifier, name);\n            symbols.Add(name, value);\n        }\n\n        private Type newResultType;\n        public Expression Parse(Type resultType)\n        {\n            newResultType = resultType;\n            int exprPos = token.pos;\n            Expression expr = ParseExpression();\n            if (resultType != null)\n                if ((expr = PromoteExpression(expr, resultType, true)) == null)\n                    throw ParseError(exprPos, Res.ExpressionTypeMismatch, GetTypeName(resultType));\n            ValidateToken(TokenId.End, Res.SyntaxError);\n            return expr;\n        }\n\n#pragma warning disable 0219\n        public IEnumerable&lt;DynamicOrdering&gt; ParseOrdering()\n        {\n            List&lt;DynamicOrdering&gt; orderings = new List&lt;DynamicOrdering&gt;();\n            while (true)\n            {\n                Expression expr = ParseExpression();\n                bool ascending = true;\n                if (TokenIdentifierIs(\"asc\") || TokenIdentifierIs(\"ascending\"))\n</code></pre>\n"},{"tags":["c#","linq","lambda"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":13023308,"title":"Convert sql select to LINQ","body":"<p>I have the following SQL query:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT      Devices.*\n        ,   DevicesActivityData.* \nFROM        Devices\nINNER JOIN  DevicesActivityData \n        ON  Devices.ID = DevicesActivityData.DeviceID\nWHERE       DevicesActivityData.DeviceDateTime IN (\n                SELECT    MAX(DevicesActivityData.DeviceDateTime) AS MaxDate\n                FROM      DevicesActivityData                                \n                GROUP BY  DevicesActivityData.DeviceID\n            )\n</code></pre>\n\n<p>And I need to complete my code : </p>\n\n<pre><code>var Q = db.Devices.Join(\n            db.DevicesActivityDatas, \n            d =&gt; d.ID, \n            a =&gt; a.DeviceID,\n            (d, a) =&gt; new { d.ID,d.DeviceName,a.DeviceDateTime }\n        );\n</code></pre>\n\n<p>I have Problem in last part select max</p>\n\n<p>How can I Add this part to my query.... </p>\n\n<pre><code>[where DevicesActivityData.DeviceDateTime in ( select max(DevicesActivityData.DeviceDateTime) as MaxDate from DevicesActivityData group by DevicesActivityData.DeviceID )]\n</code></pre>\n"},{"tags":["c#","asp.net","linq"],"answer_count":7,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":2636,"score":2,"question_id":4599989,"title":"How Dynamic library (System.Linq.Dynamic) support LIKE Operator?","body":"<p>Can any body tell meh how can I manage LIKE operator using microsoft Dynamic Expression API?</p>\n\n<p>I need to add more than one Like Expression in my dynamic <em>where query</em></p>\n\n<pre><code>/*\nvar query =\ndb.Customers.\nWhere(\"CityName Like @0 or CityName Like @1\", \"London\", \"USA\")\n*/\nvar query =\ndb.Customers.\nWhere(\"CityName Like @0 or CityName Like @1%\", \"London\", \"USA\")\n</code></pre>\n\n<p>thanks heaps</p>\n"},{"tags":["c#","linq","hash","aggregate-functions","hashset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13039165,"title":"Hashet union with preserving values from combined items","body":"<p>I am looking for efficient way to combine multiple hashsets (based on object key) while preserving non key values (such as Version below). </p>\n\n<pre><code>class MyObject {\n    public string Key {get; set;}\n    public long Version {get; set;}\n    override GetHashCode() { *key* }\n    override Equals(...) { *key* }\n}\n</code></pre>\n\n<p>in the and, i need to combine hash sets into a master list, but also all Versions. </p>\n\n<p>I can make the union of 3 sets in this way:</p>\n\n<pre><code>for (var o in List1.Union(List2).Union(List3))\n    Console.WriteLine(\"{0} : {1}\", o.Key, o.Version)\n</code></pre>\n\n<p>this only shows the versions from one of the lists (List1, or whatever list contains the item). </p>\n\n<p>I need to compile these into a result with all versions..</p>\n\n<p>Something i <strong>wish</strong> i could do like this: </p>\n\n<pre><code>for (var o in List1.Union(List2).Union(List3).Select((a,b,c) =&gt; new DiffObj(){Key=a.Key,VersionA=a.Version,VersionB=b.Version,VersionC=c.Version}))\n    Console.WriteLine(\"{0} : {1},{2},{3}\", o.Key, o.VrsionA, o.VersionB, VersionC);\n</code></pre>\n\n<p>is that possible with hashsets? </p>\n\n<p><strong>update</strong></p>\n\n<p>it is important to keep track which list had which version (in the final result). </p>\n"},{"tags":["c#","linq","entity-framework","data-structures","expression"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":86,"score":3,"question_id":13036583,"title":"Why is it better to use data structure in Entity Framework","body":"<p><a href=\"http://geekswithblogs.net/Martinez/archive/2009/06/29/understanding-expression-trees.aspx\" rel=\"nofollow\">http://geekswithblogs.net/Martinez/archive/2009/06/29/understanding-expression-trees.aspx</a></p>\n\n<p>By reading this article that expline what are Expression trees and what they are used for I have some question thats the article those not answer me clearly.</p>\n\n<p><strong>A.</strong> What is the difference between Data Structure and 'compiled piece of code'. \n * I know that data structure is Array,List,.. But this is not the answer I am looking for.</p>\n\n<p><strong>B.</strong> Why is it better to use data structure in Entity Framework than 'compiled piece of code' in terms of efficiency.</p>\n"},{"tags":["c#","asp.net-mvc","linq","razor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13033444,"title":"Having an issue with selecting and displaying distinct values in a drop down list","body":"<p>I am attempting to represent the size of an item. We have multiple suppliers and the table we use to store the values of sizes and suppliers means that we have several sizes that equal the same value, but different supplier.</p>\n\n<p>I need to populate the following drop down list, but can't have duplicates of say for example S, M or L:</p>\n\n<pre><code>@Html.DropDownListFor(\n    m =&gt; m.RejectLog.SupplierTypeId, \n    new SelectList(Model.SupplierTypes, \"ID\", \"Size\", \n                   Model.RejectLog.SupplierTypeId), \n    new { \n        @size = Model.SupplierTypes.Count,\n        @class = \"reject-select\",\n        @id = \"Size\",\n        @name = \"Size\"\n    }\n)\n</code></pre>\n\n<p>I have tried adding <code>.Distinct()</code> nearly every place I could. I'm at a loss.</p>\n"},{"tags":["c#","performance","linq"],"answer_count":7,"favorite_count":8,"up_vote_count":68,"down_vote_count":0,"view_count":1253,"score":68,"question_id":7499384,"title":"Does the order of LINQ functions matter?","body":"<p>Basically, as the question states... does the order of LINQ functions matter in terms of <b>performance</b>? Obviously the results would have to be identical still...</p>\n\n<p>Example:</p>\n\n<pre><code>myCollection.OrderBy(item =&gt; item.CreatedDate).Where(item =&gt; item.Code &gt; 3);\nmyCollection.Where(item =&gt; item.Code &gt; 3).OrderBy(item =&gt; item.CreatedDate);\n</code></pre>\n\n<p>Both return me the same results, but are in a different LINQ order. I realize that reordering some items will result in different results, and I'm not concerned about those. What my main concern is in knowing if, in getting the same results, ordering can impact performance. And, not just on the 2 LINQ calls I made (OrderBy, Where), but on any LINQ calls.</p>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":76,"score":-4,"question_id":13036426,"title":"What is the difference between a LINQ subquery and a nested FROM statement","body":"<p>1) Subquery is a query within a query and as such must start with a FROM clause and end with SELECT or GROUP BY clause. But I'm puzzled why don't we also consider as a subquery those nested statements that only have a FROM clause ( thus they don't end with SELECT or GROUP BY ).  </p>\n\n<p>The behavior of <code>from c_2  in collection_2</code> is very similar to the behaviour of a subquery, since it enumerates the entire <code>collection_2</code> for every <code>c_1</code> element. Since their behaviours are remarkably similar, why aren't statements such as <code>from c_2  in collection_2</code> also considered as subqueries ( you could argue that a subquery returns a result, but same argument could also be said of <code>from c_2  in collection_2</code>, since it does get converted into a call to <code>SelectMany</code> )? </p>\n\n<pre><code>    var query = from c_1  in collection_1\n                from c_2  in collection_2 \n                select ...\n</code></pre>\n\n<p>thank you</p>\n"},{"tags":["c#",".net","linq","list"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":99,"score":2,"question_id":13031750,"title":"Find sum of List where property == true?","body":"<p>In my C# code, I have a list of type <code>CustomClass</code>. This class contains a boolean property <code>trueOrFalse</code>.</p>\n\n<p>I have a <code>List&lt;CustomClass&gt;</code>. I wish to create an integer using this List which holds the number of objects in the list which have a <code>trueOrFalse</code> value of <code>True</code>.</p>\n\n<p>What is the best way to do this ? I assume there is a clever way to use Linq to accomplish this, rather than having to iterate over every object ?</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["c#",".net","linq","list"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13035614,"title":"Return only values contained in list C#","body":"<p>I have a <code>List&lt;int&gt; ListOfIDs</code> containing some numbers which are IDs.</p>\n\n<p>I have a <code>List&lt;CustomClass&gt; ListOfObjects</code> containing some objects, which properties reflecting their IDs.</p>\n\n<p>I've searched high and low for a Linq query that will allow me to return from my List a sublist of only those objects which have an ID that is contained within the List.</p>\n\n<p>My attempt does not compile and I cannot seem to correct the syntax : </p>\n\n<pre><code>List&lt;CustomClass&gt; SubList = ListOfObjects.Where(ListOfIDs.Contains(p =&gt; p.ID))\n</code></pre>\n\n<p>Thanks very much.</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":13035580,"title":"Many to many query in LINQ","body":"<p>I have 4 tables:</p>\n\n<blockquote>\n  <p>Address - AddressID, City, Address, ZipCode</p>\n  \n  <p>OBAddress - OBID, AddressID</p>\n  \n  <p>OB -  OBID</p>\n  \n  <p>States - StateID, StateAbbreviation</p>\n</blockquote>\n\n<p>How do I join the three tables which are in a many to many relationship?  I tried:</p>\n\n<pre><code>var recordsPhysicalAddress = ( from a in db.Addresses\n    join oba in db.obAddresses on a.AddressID equals oba.AddressID\n    join ob in db.obAddresses on oba.obID equals passedinID\n    join s in db.States on a.StateID equals s.StateID\n    where oba.obID == ob.obID\n    &amp;&amp; a.AddressTypeID == '5' //5 is records physical address\n    select new\n    {\n        a.Address1, \n        a.City, \n        a.StateID,\n        s.StateAbbreviation,\n        a.ZipCode\n    }).FirstOrDefault();\n</code></pre>\n"},{"tags":["linq","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12995488,"title":"Adding Sum per row in PIVOT using LINQ","body":"<p>I have following function that converts normal DataTable to Pivot Table.</p>\n\n<p>But I have 1 more requirement, it should also show Value column i.e sum of all the Pivot column cell.</p>\n\n<pre><code>e.g. : ORDER | SUM | PLANDATE\n         1      50    10-Oct-2012\n         1      10    10-Oct-2012\n         2      15    12-Oct-2012\n</code></pre>\n\n<p>After PIVOT it should be like </p>\n\n<pre><code>ORDER | SUM | 10-Oct-2012 | 12-Oct-2012\n  1      60     50            10\n  2      15                   15\n</code></pre>\n\n<p>my pivot function is : </p>\n\n<pre><code>DataTable Pivot(DataTable dt, DataColumn pivotColumn, DataColumn pivotValue) {\n    // find primary key columns \n    //(i.e. everything but pivot column and pivot value)\n    DataTable temp = dt.Copy();\n    temp.Columns.Remove( pivotColumn.ColumnName );\n    temp.Columns.Remove( pivotValue.ColumnName );\n    string[] pkColumnNames = temp.Columns.Cast&lt;DataColumn&gt;()\n        .Select( c =&gt; c.ColumnName )\n        .ToArray();\n\n    // prep results table\n    DataTable result = temp.DefaultView.ToTable(true, pkColumnNames).Copy();\n    result.PrimaryKey = result.Columns.Cast&lt;DataColumn&gt;().ToArray();\n    dt.AsEnumerable()\n        .Select(r =&gt; r[pivotColumn.ColumnName].ToString())\n        .Distinct().ToList()\n        .ForEach (c =&gt; result.Columns.Add(c, pivotColumn.DataType));\n\n    // load it\n    foreach( DataRow row in dt.Rows ) {\n        // find row to update\n        DataRow aggRow = result.Rows.Find(\n            pkColumnNames\n                .Select( c =&gt; row[c] )\n                .ToArray() );\n        // the aggregate used here is LATEST \n        // adjust the next line if you want (SUM, MAX, etc...)\n        aggRow[row[pivotColumn.ColumnName].ToString()] = row[pivotValue.ColumnName];\n    }\n\n    return result;\n}\n</code></pre>\n\n<p>Thanks &amp; any help will be appriciated...</p>\n\n<pre><code>Sample Data :\n OrderStatus    Qty     Dated\n    New 100 10-Oct-2012\n    New 150 10-Oct-2012\n    New 100 10-Oct-2012\n    Conf    200 12-Oct-2012\n    New 100 12-Oct-2012\n    Reconf  300 12-Oct-2012\n    New 200 15-Oct-2012\n    New 200 15-Oct-2012\n    Reconf  100 18-Oct-2012\n    New 150 18-Oct-2012\n    Conf    150 18-Oct-2012\n    New 100 20-Oct-2012\n    Reconf  500 20-Oct-2012\n    New 100 30-Oct-2012\n    New 700 30-Oct-2012\n    New 100 30-Oct-2012\n    Conf    100 10-Oct-2012\n</code></pre>\n"},{"tags":["asp.net-mvc-3","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13017991,"title":"MVC 3 controller GroupBy View error","body":"<p>Im creating an MVC 3 view from a controller. My model \"MyList\", contains a large number of records. When I create my model using the following linq statement:</p>\n\n<pre><code>var model = _db.MyList.GroupBy(r =&gt; r.myKey);\n</code></pre>\n\n<p>I'm getting the error: \"The model item passed into the dictionary is of type 'System.Collections.GenericlList' 1... but this dictionary requires a model item of type 'System.Collections.Generic.IEnumerable' ...</p>\n\n<p>In the view I have the following code in the first line:</p>\n\n<pre><code>@model IEnumerable&lt;MyApp.Models.MyList&gt;\n</code></pre>\n\n<p>I tried returning</p>\n\n<pre><code>return View(model.ToList());\n</code></pre>\n\n<p>from the controller, but no joy. What am I missing?</p>\n"},{"tags":["java","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13034608,"title":"Is there a tool that can convert C# Linq statements to java?","body":"<p>I know that Java has no LINQ equivalent, but is there a tool (preferably free) that can make suggestions on how to convert a C# LINQ statement to Java statements?</p>\n\n<p>The purpose of this question isn't to find <em>alternatives</em> to LINQ, but rather to find a tool that can make <em>suggestions</em> on how to convert a LINQ statement to Java. </p>\n\n<p>Discussion of alternatives has been hashed to death on SO and SO does not need another question related to alternatives. However in my research I was unable to locate any mention of a tool that can ease the transition of LINQ to Java. </p>\n"},{"tags":["c#","linq","list","duplicates"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13033272,"title":"How to find duplicate items based on multiple values using LINQ?","body":"<p>Suppose I have the following class:</p>\n\n<pre><code>public class Test{\n    public string Length { get; set; }\n    public string Width { get; set; }\n    public string Height { get; set; }\n    public int Count { get; set; }\n    public string Label { get; set; }\n}\n</code></pre>\n\n<p>And I would like to find items that have the same value for length and label and counting how many there are for each. So far my code looks like:</p>\n\n<pre><code>var dups = testlist.GroupBy(i =&gt; new { i.Length, i.Label })\n                   .Where(g =&gt; g.Count() &gt;= 1)\n                   .Select(g =&gt; new { Length = g.Key.Length, Label = g.Key.Label, \n                                      Count = g.Count() });\n</code></pre>\n\n<p>But the problem is, the objects in var no longer have the width or height property (they don't exist in g.Key). Is there anyway to find duplicates based on two properties while saving other properties in the result?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":108,"score":2,"question_id":13031513,"title":"why ToList() doesnt work in linq?","body":"<p>i am having a issue while sorting data with more than a field</p>\n\n<p>here is sample code i have used :</p>\n\n<pre><code> var Item = from itm in DB.Items\nselect new Item\n{\n};\nreturn Item.ToList().OrderBy(e =&gt; e.ExpiryDate).ToList();\n</code></pre>\n\n<p>above code does'nt show any error but also doesn sort with expirydate field :(</p>\n\n<p>if i use like this</p>\n\n<pre><code>return Item.OrderBy(e =&gt; e.ExpiryDate).ToList();\n</code></pre>\n\n<p>this gives a error that sql doesnt contain translation for orderby</p>\n\n<p>any help </p>\n\n<p>thanks in advance</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13018978,"title":"binding linq query result to gridview","body":"<p>I am finding it difficult to bind the linq query results to a gridview control on my asp.net page.  In the main Linq Query, i am getting all the users from one table which meets the criteria of a column that checks for \"Form Completed\" - </p>\n\n<pre><code>using (COLA_AccreditationEntities4 eFactory = new COLA_AccreditationEntities4())\n{\n    var evaluations = eFactory.Symposium_Evaluation.Where(a =&gt; \n            (!a.Completed.HasValue || \n              a.Completed.Value == 0) &amp;&amp; a.Active &amp;&amp; a.UserID &gt;= 2063).ToList();\n</code></pre>\n\n<p>Then inside the code i am doing a foreach loop to get all the userid from the other table that matches the userid in the previous table - </p>\n\n<pre><code>foreach (var eval in evaluations)\n{\n    var user = eFactory.SYMPOSIUM_Users.Where(a =&gt; a.UserID == eval.UserID.Value \n                         &amp;&amp; a.Active.Value &amp;&amp; a.UserRole == 1).FirstOrDefault();\n\n    if (user != null &amp;&amp; !users.Contains(user.UserID))\n    {\n        string name = user.FirstName + \" \" + user.LastName;\n        string email = user.Email;\n    }\n}\n</code></pre>\n\n<p>All i wanted to do is to show the user.firstname + user.lastname + user.email on the screen.  I used gridview control to bind this, but not getting desired results.</p>\n\n<p>Any thoughts on how to achieve this ?</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":90,"score":-2,"question_id":13028375,"title":"How to get one row from 1st table and others from 2nd table","body":"<p>I am having a little issue regarding a query where I want to show records from 2 tables. I need to show one row from first table and many rows from 2nd table (which relates on first table.id)</p>\n\n<p>like Table 1</p>\n\n<pre><code>name | id\n----------\nShop | 1\nShop | 2\n</code></pre>\n\n<p>table 2 </p>\n\n<pre><code>name | id  | shopid\nitem | 1   |\nitem | 2   |\nitem | 3   |\n</code></pre>\n\n<p>I want to retrieve single row from table 1 and the relevant ones from table 2.</p>\n\n<p>I have a object of items which contains properties for both tables but I need to show single record from table 1 (I have tried with join, and with some other way but getting more values from table 1 (1st records has info and other are empty)).</p>\n\n<p>here is sample code</p>\n\n<pre><code>public class ItemsInfo\n{\n    public Shopname { get; set;}\n    public item { get; set; }\n}\n\npublic List&lt;ItemsInfo&gt; ShopItems(int ShopId)\n{\n    var items = from i in db.items\n                join s in db.shops on i.shopid equals s.id\n                where s.id == ShopId\n                select new ItemsInfo\n                           {\n                               shopname = s.name,\n                           items = i.name\n                           }\n    return items.Tolist();\n}\n</code></pre>\n\n<p>I want result as </p>\n\n<pre><code>Shopname : abcd\nitems    : item 1\nitems    : item 2\nitems    : item 3\n</code></pre>\n"},{"tags":["c#","linq","string","comparison","distinct"],"answer_count":4,"favorite_count":5,"up_vote_count":21,"down_vote_count":0,"view_count":12613,"score":21,"question_id":283063,"title":"LINQ Distinct operator, ignore case?","body":"<p>Given the following simple example:</p>\n\n<pre><code>    List&lt;string&gt; list = new List&lt;string&gt;() { \"One\", \"Two\", \"Three\", \"three\", \"Four\", \"Five\" };\n\n    CaseInsensitiveComparer ignoreCaseComparer = new CaseInsensitiveComparer();\n\n    var distinctList = list.Distinct(ignoreCaseComparer as IEqualityComparer&lt;string&gt;).ToList();\n</code></pre>\n\n<p>It appears the CaseInsensitiveComparer is not actually being used to do a case-insensitive comparison.  </p>\n\n<p>In other words <strong>distinctList</strong>  contains the same number of items as <strong>list</strong>.   Instead I would expect, for example, \"Three\" and \"three\" be considered equal.</p>\n\n<p>Am I missing something or is this an issue with the Distinct operator?</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13030960,"title":"multiply join in dynamic linq","body":"<p>im trying to join those tables i have to use dynamic linq,\n   it`s working fine if  the <strong>.Join(dbcontext.Providers)</strong> has and returning data \nwhen i dont have data on the  <strong>.Join(dbcontext.Providers)</strong> the all <strong>queryResolts</strong> returnig 0 results</p>\n\n<p>how can i get data even if one of the join returning 0 results</p>\n\n<pre><code>var queryResolts = dbcontext.Tracks\n            // Add Services\n            .Join(dbcontext.Services,\n                track =&gt; track.ServiceId,\n                service =&gt; service.ServiceId,\n                (track, service) =&gt; new { Track = track, Service = service })\n            // Add ServiceInterfaces\n            .Join(dbcontext.ServiceInterfaces,\n                ts =&gt; ts.Track.ServiceInterfaceId,\n                serviceInterface =&gt; serviceInterface.ServiceInterfaceId,\n                (ts, serviceInterface) =&gt; new { Track = ts.Track, Service = ts.Service, ServiceInterfaces = serviceInterface })\n            // Add Providers\n            .Join(dbcontext.Providers,\n                tss =&gt; tss.Track.ProviderId,\n                provider =&gt; provider.ProviderId,\n                (tss, provider) =&gt; new { Track = tss.Track, Service = tss.Service, ServiceInterfaces = tss.ServiceInterfaces, Providers = provider })\n            .Where(\"ServiceInterfaces.ServiceInterfaceName == @0\", \"PublishPolicyInterface2\")\n            .Select(y =&gt; y.Track) \n\n            ;\n</code></pre>\n\n<p>thanks</p>\n\n<p>miki</p>\n"},{"tags":["linq","query","sql-server-2005","entity-framework-4"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":396,"score":2,"question_id":10431578,"title":"Linq query giving Invalid column name \"xyz\" error","body":"<p>I am using this LINQ query</p>\n\n<pre><code>var db = new XYZ();\nvar product = (from cp in db.CatalogProducts\n               where cp.ProductID == productId\n               select cp).FirstOrDefault();\n</code></pre>\n\n<p>Running this query gives me an error </p>\n\n<blockquote>\n  <p>Invalid column name 'Cracker Cruncher'.<br>\n  Invalid column name 'crushing torque'.<br>\n  Invalid column name 'Slicing velocity'.</p>\n</blockquote>\n\n<p>Can any one help me in this matter?</p>\n\n<p>Gautam</p>\n"},{"tags":["c#","linq","linq-to-sql","linq-query-syntax"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":148,"score":4,"question_id":13026948,"title":"Linq-to-SQL, pass Expression<Func<T, T>> to select method in query syntax","body":"<p>Suppose, we have next code:</p>\n\n<pre><code>public class Dto\n{\n  public int Id;\n  public string Name;\n}    \n\n...\n\nusing (var db = new NorthwindDataContext())\n{\n  var q = from boss in db.Employees\n          from grunt in db.Employees.Where(p =&gt; p.ReportsTo == boss.EmployeeID).DefaultIfEmpty()\n          select new Dto { Id = boss.EmployeeID, Name = grunt.FirstName };\n}\n</code></pre>\n\n<p>I want to extract selector as Expression and store it in another place. In method syntax it will look like this:</p>\n\n<pre><code>Expression&lt;Func&lt;Employee, Employee, Dto&gt;&gt; selector = (boss, grunt) =&gt; new Dto\n{\n  Id = boss.EmployeeID, Name = grunt.FirstName\n};\n\nusing (var db = new NorthwindDataContext())\n{\n  var q = db.Employees.SelectMany(boss =&gt; db.Employees.Where(p =&gt; p.ReportsTo == boss.EmployeeID).DefaultIfEmpty(), selector);\n}\n</code></pre>\n\n<p>Is it possible to convert this LinqToSql method chain to query syntax keeping Expression variable in-place?</p>\n\n<p><strong>UPD:</strong></p>\n\n<p>To clarify my question, I'm using DefaultIfEmpty for left join, it's a short form of equal query:</p>\n\n<pre><code>using (var db = new NorthwindDataContext())\n{\n  var q = from boss in db.Employees\n          join stub in db.Employees on boss.EmployeeID equals stub.ReportsTo into stubi\n          from grunt in stubi.DefaultIfEmpty()\n          select new Dto { Id = boss.EmployeeID, Name = grunt.FirstName };\n}\n</code></pre>\n\n<p>which works normally, because it compiles using inline Expression. It assigns <code>null</code> to Name field when there is no corresponding <code>grunt</code>. But if rewrite this query with call to external mapper method, it will be compiled to method call, which will get nullable <code>grunt</code> argument and will lead to NullReferenceException:</p>\n\n<pre><code>public static Dto GetDto(Employee boss, Employee grunt)\n{\n  return new Dto\n    {\n      Id = boss.EmployeeID,\n      Name = grunt.FirstName\n    };\n}\n\nusing (var db = new NorthwindDataContext())\n{\n  var q = from boss in db.Employees\n          join stub in db.Employees on boss.EmployeeID equals stub.ReportsTo into stubi\n          from grunt in stubi.DefaultIfEmpty()\n          select GetDto(boss, grunt);\n}\n</code></pre>\n\n<p>Sure, I can add null-check into mapper method, but what I'm trying to achieve in my DAL is extract selectors into mapper classes and possibly omit null-checks there.</p>\n"},{"tags":["linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13029663,"title":"Getting a result from an object using LINQ after doing an internal operations?","body":"<p>I have a list of objects with the following properties: \nRoomName, Date, StartTime, EndTime.</p>\n\n<p>I want to get a result of total hours for each Roomname, this is calulated as EndTime-StartTime.</p>\n\n<p>If i have a list as:</p>\n\n<pre><code>room1 12/2/2012 11.0 12.0\nroom1 12/2/2012 13.0 15.0\nroom2 12/3/2012 11.0 12.0\n</code></pre>\n\n<p>When i send room1 to LINQ query i want the answer as (12.0-11.0)+(15.0-13.0) which is 3.\nHow can I do this using a LINQ expression?</p>\n"},{"tags":["c#",".net","xml","linq","filtering"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":13029640,"title":"C#: Filtering a list according to information in xml","body":"<p>I have a list of Model objects and an xml containing information according to which the list should be filtered. I need a filter method that takes the list and xml and returns the filtered list. I need it to be generic so it can handle a list of i.e. ProductModel or a list of CustomerModel. The xml can have <code>&lt;descriptor&gt;</code> elements or <code>&lt;composite&gt;</code> elements as shown below. The <code>FilterCompositionLogicalOperator</code> attribute indicates whether it's logical <code>AND</code> or logical <code>OR</code> operation. <code>FilterOperator</code> represents an Enum for eksample <code>IsEqualTo = 0</code> <code>IsLessThan=1</code> etc.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;advanced FilterCompositionLogicalOperator=\"1\"&gt;\n  &lt;descriptor IsCaseSensitive=\"false\" Member=\"SalesPrice\" MemberType=\"System.Decimal\" FilterOperator=\"5\"&gt;800&lt;/descriptor&gt;\n  &lt;descriptor IsCaseSensitive=\"false\" Member=\"CostPrice\" MemberType=\"System.Decimal\" FilterOperator=\"5\"&gt;300&lt;/descriptor&gt;\n  &lt;composite FilterCompositionLogicalOperator=\"0\"&gt;\n    &lt;descriptor IsCaseSensitive=\"false\" Member=\"CostPrice\" MemberType=\"System.Decimal\" FilterOperator=\"5\"&gt;150&lt;/descriptor&gt;\n    &lt;descriptor IsCaseSensitive=\"false\" Member=\"ProductId\" MemberType=\"System.String\" FilterOperator=\"0\"&gt;400&lt;/descriptor&gt;\n  &lt;/composite&gt;\n&lt;/advanced&gt;\n</code></pre>\n\n<p>I have tried something like this:</p>\n\n<pre><code>    public List&lt;IAdvancedFilterable&gt; HandleXML(XElement xml, IEnumerable&lt;IAdvancedFilterable&gt; filterableList)\n    {\n      foreach (XElement element in xml.Elements())\n      {\n        // if composite, I call the method recursively giving it the composite element and list\n        // else I read all the attributes of the &lt;descriptor&gt; element. decide the type of the elementValue\n        // and then I call helper method 'Filter'\n\n        filtered = Filter(compareOpr, colNameAtt.Value, elementValue, list);\n\n        // Which filters the list according to this &lt;descriptor&gt; element using LINQ.\n      }\n\n      return filtered;\n    }\n</code></pre>\n\n<p>How to handle the OR situation. AND is easy - you just filter according to each <code>&lt;descriptor&gt;</code> and it will be good without any further consideration.</p>\n\n<p>The Filter helper method switches on <code>FilterOperator</code> and does for example:</p>\n\n<pre><code>    case FilterOperator.IsLessThan:\n                if (elementValue.IsInt())\n                    return list.Where(d =&gt; Convert.ToInt32(d.Source.GetColumnValue(columnName)) &lt; Convert.ToInt32(elementValue));\n\n                if (elementValue.IsDecimal())\n                    return list.Where(d =&gt; Convert.ToDecimal(d.Source.GetColumnValue(columnName)) &lt; Convert.ToDecimal(elementValue));\n                break;\n</code></pre>\n\n<p>My model objects have a method <code>GetColumnValue(columnName)</code> that takes a columnName and returns its value.</p>\n\n<p>Any idea how to achieve this effectively? Is LINQ Performant in this situation? Are there better alternatives in order to gain better performance?</p>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13022064,"title":"Combine similar LINQ queries","body":"<p>I have a csv file with the format</p>\n\n<p>LeftChoice, RightChoice, Left || Right </p>\n\n<p>Where LeftChoice and RightChoice are  non-unique text strings, and Left || Right is the string that was picked.  </p>\n\n<p>What I want to do is get an List that contains for each element:\nString, Chosen Count, Non Chosen Count.  </p>\n\n<p>Currently I have the following:</p>\n\n<pre><code> var result = from line in file\n                     let values = line.Split(',')\n                     select new { Choice1 = values[0], Choice2 = values[1],  Result =  values[2].Equals(\"left\")};\n\n\n        var leftTrue = from dataSet in result\n                 where dataSet.Result\n                 group dataSet.Choice1 by dataSet.Choice1 into C1\n                 select new { Value = C1.Key, Count = C1.Count() };\n\n\n        var leftFalse = from dataSet in result\n                       where !dataSet.Result\n                       group dataSet.Choice1 by dataSet.Choice1 into C1\n                       select new { Value = C1.Key, Count = C1.Count() };\n\n        var rightTrue = from dataSet in result\n                       where !dataSet.Result\n                       group dataSet.Choice2 by dataSet.Choice2 into C2\n                       select new { Value = C2.Key, Count = C2.Count() };\n\n\n        var rightFalse = from dataSet in result\n                        where dataSet.Result\n                        group dataSet.Choice2 by dataSet.Choice2 into C2\n                        select new { Value = C2.Key, Count = C2.Count() };\n</code></pre>\n\n<p>example input</p>\n\n<pre><code> Fred,Cole,left\n Jill,Dave,right\n Pat,Fred,right\n Pat,Pat,left\n</code></pre>\n\n<p>example output:\nwould give</p>\n\n<pre><code>Name Chosen NotChosen\nFred   2        0\nCole   0        1\nJill   0        1\nDave   1        0\nPat    1        2\n</code></pre>\n"},{"tags":["linq","c#-4.0","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13028185,"title":"Building a query (LINQ) with a sub-query","body":"<p>For simplicity sake lets assume I have the following two classes:</p>\n\n<pre><code>public class ComplexClass\n{\n    public List&lt;SubClass&gt; SubClasses { get; set; }\n    public string Name { get; set; }\n}\n\npublic class SubClass\n{\n    public string Name { get; set; }\n}\n</code></pre>\n\n<p>I have a <code>List&lt;ComplexClass&gt;</code> and I need to build a query based on some parameters.</p>\n\n<p>It's an easy task if all I need to do is use the <code>Name</code> property of <code>ComplexClass</code>. Here's an example:</p>\n\n<pre><code>    static IQueryable&lt;ComplexClass&gt; GetQuery(string someParameter, string someOtherParameter)\n    {\n        var query = list.AsQueryable();\n        if (!String.IsNullOrEmpty(someParameter))\n            query = query.Where(c =&gt; c.Name.StartsWith(someParameter));\n        if (!String.IsNullOrEmpty(someOtherParameter))\n            query = query.Where(c =&gt; c.Name.EndsWith(someOtherParameter));\n        return query;\n    }\n</code></pre>\n\n<p>Based on the parameters I have I can add more query elements. Of course the above example is simple, but the actual problem contains more parameters, and that number can grow.</p>\n\n<p>Things aren't as simple if I want to find those <code>ComplexClass</code> instances which have <code>SubClass</code> instances which meet criteria based on parameters:</p>\n\n<pre><code>    static IQueryable&lt;ComplexClass&gt; GetSubQuery(string someParameter, string someOtherParameter)\n    {\n        var query = list.AsQueryable();\n        if (!String.IsNullOrEmpty(someParameter))\n            if (!String.IsNullOrEmpty(someOtherParameter))\n                return query.Where(c =&gt; c.SubClasses.Where(sc =&gt; sc.Name.StartsWith(someParameter) &amp;&amp; sc.Name.EndsWith(someOtherParameter)).Any());\n            else\n                return query.Where(c =&gt; c.SubClasses.Where(sc =&gt; sc.Name.StartsWith(someParameter)).Any());\n        else\n            if (!String.IsNullOrEmpty(someOtherParameter))\n                return query.Where(c =&gt; c.SubClasses.Where(sc =&gt; sc.Name.EndsWith(someOtherParameter)).Any());\n            else\n                return null;\n    }\n</code></pre>\n\n<p>I can no longer just add bits of the query based on each parameter, I now need to write the whole query in one go, and this means I need to check every combination of parameters, which is hardly ideal.</p>\n\n<p>I suspect the key is to build an <code>Expression</code> class and create a lambda expression from that, but I'm not sure how to tackle the problem.</p>\n\n<p>Any suggestions? :)</p>\n\n<p>EDIT:</p>\n\n<p>My initial idea was this:</p>\n\n<pre><code>    static IQueryable&lt;ComplexClass&gt; GetSubQuery(string someParameter, string someOtherParameter)\n    {\n        var query = list.AsQueryable();\n        query = query.Where(c =&gt;\n        {\n            var subQuery = c.SubClasses.AsQueryable();\n            if (!String.IsNullOrEmpty(someParameter))\n                subQuery = subQuery.Where(sc =&gt; sc.Name.StartsWith(someParameter));\n            if (!String.IsNullOrEmpty(someOtherParameter))\n                subQuery = subQuery.Where(sc =&gt; sc.Name.EndsWith(someOtherParameter));\n            return subQuery.Any();\n        });\n        return query;\n    }\n</code></pre>\n\n<p>This works in my small console test application as it's using LINQ to Objects. Unfortunately, I need to use Entity Framework and LINQ to Entities, which causes an implementation similar to the one above to throw a <code>A lambda expression with a statement body cannot be converted to an expression tree</code> error message.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13025687,"title":"how to get records from database with multi parameters linq","body":"<p>i have a query which gets records from the database, \ni need to pass ids in parameters to call this function,\nlike Myfunction(1, 2, 3)</p>\n\n<p>i want to get the results which matching with this ids, </p>\n\n<p>like</p>\n\n<pre><code>public List&lt;Items&gt; GetItems(int[] ids)\n{\nvar a = from Items in db.item \nwhere items.id == ids[]\nselect new Items\n{\n\n}\n    return a.ToList();\n}\n</code></pre>\n\n<p>there is confusion on where clause ( how to get records regarding provided its)</p>\n\n<p>i tried this with looping the ids but could not get any success</p>\n\n<p>Thanks in Advance</p>\n"},{"tags":["c#","linq","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13024326,"title":"C# linq query data table take method","body":"<p>I'm not able to call take method from below linq query</p>\n\n<pre><code>var data = from tb in table.AsEnumerable()\n           join ch in channelTable.AsEnumerable() on syskey equals (DateTime)ch[\"syskey\"]\n           orderby Convert.ToDouble(tb[(string.Format(\"Channel{0}_data\",Convert.ToInt32(ch[\"Channel_No\"])))]) descending                       \n           select new\n           {\n               Channel_No = ch[\"Channel_No\"],\n               Channel_data = tb[string.Format(\"Channel{0}_data\", Convert.ToInt32(ch[\"Channel_No\"]))],\n           };\n</code></pre>\n\n<p>How can I add Take(5) from above linq query?</p>\n"},{"tags":["java","linq","equivalent"],"answer_count":21,"favorite_count":40,"up_vote_count":170,"down_vote_count":0,"view_count":44609,"score":170,"question_id":1217228,"title":"What is the Java equivalent for LINQ?","body":"<p>What is Java equivalent for LINQ?</p>\n"},{"tags":["c#",".net","linq","generic-list"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":872,"score":0,"question_id":9221896,"title":"Generic method to compare/filter two lists using expressions/lamda","body":"<p>I want to compare two lists, based on a filter expression; not sure how to construct the lamda expression for the generic method; Please refer to the code below; or is there an easier way via an intersect in LINQ?</p>\n\n<p>any help would be greatly appreciated.</p>\n\n<pre><code>namespace ConsoleApplication1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Data d1 = new Data {Id = 1, Name = \"One\"};\n            Data d2 = new Data { Id = 2, Name = \"Two\" };\n            Data d3 = new Data { Id = 3, Name = \"Three\" };\n\n            Data d4 = new Data { Id = 1, Name = \"One\" };\n            Data d5 = new Data { Id = 2, Name = \"Two\" };\n            Data d6 = new Data { Id = 4, Name = \"Four\" };\n\n            List&lt;Data&gt; original = new List&lt;Data&gt; {d1, d2, d3};\n            List&lt;Data&gt; filterItems = new List&lt;Data&gt; {d4, d5, d6};\n\n            List&lt;Data&gt; result = original.FilterDataList(filterItems);\n\n            //How to call this method?\n            List&lt;Data&gt; genericCall = original.FilterList&lt;Data&gt;(filterItems, data =&gt; data.Id ?????????????)\n        }\n    }\n\n    public class Data\n    {\n        public long Id;\n        public string Name;\n    }\n\n    public static class Extensions\n    {\n        public static List&lt;Data&gt; FilterDataList(this List&lt;Data&gt; sourceList, List&lt;Data&gt; filterOutItems)\n        {\n            return sourceList.Where(p =&gt; filterOutItems.All(l =&gt; l.Id != p.Id)).ToList();\n        }\n\n        public static List&lt;T&gt; FilterList&lt;T&gt;(this List&lt;T&gt; sourceList, List&lt;T&gt; filterOutItems, Func&lt;T, bool&gt; filterExpression)\n        {\n            return sourceList.Where(p =&gt; filterOutItems.All(filterExpression)).ToList();\n        }\n    }\n}\n</code></pre>\n"},{"tags":["linq","linq-to-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":50,"score":1,"question_id":13018026,"title":"Which query expression would be equivalent to the following LINQ query?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13017642/can-these-two-linq-queries-be-used-interchangeably\">Can these two LINQ queries be used interchangeably?</a>  </p>\n</blockquote>\n\n\n\n<pre><code>var query =  from c_1 in collection_1\n             select c_1.collection_2 into c_2\n             select c_2.collection_3 into c_3\n             select c_3;\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>  var query = collection_1\n            .Select(c_1 =&gt; c_1.collection_2)\n            .Select(c_2 =&gt; c_2.collection_3)\n            .Select(c_3 =&gt; c_3);\n</code></pre>\n\n<p>a) But which query expression would be equivalent to the following LINQ query:</p>\n\n<pre><code>var query = collection_1\n            .Select(c_1 =&gt; c_1.collection_2\n            .Select(c_2 =&gt; c_2.collection_3.Select(c_3 =&gt; new { c_1, c_2, c_3 } )));\n</code></pre>\n\n<p>thank you</p>\n"},{"tags":["c#","linq","delegates","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13015330,"title":"How to create a delegate to a target with variable number of arguments","body":"<p>Let's assume there is a method which takes a variable number of arguments:</p>\n\n<pre><code>void Target( params object[] args );\n</code></pre>\n\n<p>To attach this to an action with a concrete parameter list we can create a lambda expression:</p>\n\n<pre><code>Action&lt;int, int&gt; someAction += (a, b) =&gt; Target(a, b);\n</code></pre>\n\n<p>Is there a possibility to create this lambda expression dynamically to be able to attach the handler to any type of event? Something like:</p>\n\n<pre><code>someAction += CreateDelegate( typeof(someAction), Target );\n</code></pre>\n\n<p>I tried to use <code>Delegate.CreateDelegate</code> but it expects the target to provide a method with the concrete list of arguments. I have the feeling it should be possible with <code>Expression.Lambda</code> but for now I didn't have any success. Do you have an Idea?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Renamed event to action and handler to target.</p>\n"},{"tags":["linq","linq-to-sql","linq-to-entities","dynamics-crm-2011"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12979250,"title":"Left Outer join LINQ query with four entities in CRM 2011 and with multiple where clauses","body":"<p>I have a situation in Microsoft Dynamics CRM 2011\nHere I have a set of Accounts which has Permits and permits ae related to permitCounty and permitCounty is related to County</p>\n\n<p>I would like to get get an output like this query.</p>\n\n<p>But it is not proper</p>\n\n<pre><code>strSearch=\"Some text\";\n\nvar lstItems = (from county in x.De_countySet\n                join permitcounty in x.de_permitcountySet on county.De_countyId equals permitcounty.de_CountyId.Id\n                join permit in x.de_permitSet on permitcounty.de_PermitId.Id equals permit.de_permitId\n                join account in x.AccountSet on permit.de_AccountId.Id equals account.AccountId into outer\n\n                where permit.de_Type.Equals(\"Type1\") &amp;&amp; permit.statuscode.Equals(\"Active\")                // Permit Type as Type1 and Status as Active\n                where account.De_LegalName.Contains(strSearch) || account.Name.Contains(strSearch)        // Search in Legal Name and Account full name\n                where county.de_CountyName.Contains(strSearch)                                            // Search in County Name\n\n                orderby county.de_CountyName\n                from account in outer.DefaultIfEmpty()\n                select new clsTemp\n                {\n                    Name = account.Name,\n                    De_LegalName = account.De_LegalName,\n                    Address1_Line1 = account.Address1_Line1,\n                    Address1_City = account.Address1_City,\n                    Address1_PostalCode = account.Address1_PostalCode,\n\n                    de_CountyName = county.de_CountyName              \n                 }).ToList();\n</code></pre>\n\n<p>Any help is appreciated.</p>\n\n<p>Vinu</p>\n"},{"tags":["linq","entity-framework","design-patterns"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12999789,"title":"Entity Framework, LINQ and patterns","body":"<p>I've started using EF and LINQ in a project and I'm trying to decide on the best approach/pattern to use. Until now I've been using a custom persistence framework that was based on DataSets and XML configuration. Basically it was a VS Custom Tool that would read the XML configuration file and the DataSets and would generate Object Oriented classes with all the necessary properties/associations/methods. This auto-generated classes then were used from the UI and I had the flexibility to expose only what the UI would need.</p>\n\n<p>Now with EF and LINQ, I'm not comfortable with the idea that the UI can use directly the auto-generated classes and all the LINQ stuff. It seems that this approach would have a very tight integration between UI and the database.</p>\n\n<p>So I'm looking for some pattern that would \"hide\" all the EF and LINQ goodies and basically limit what the UI can do. Is there any standard way to do this?</p>\n"},{"tags":["c#","linq","tsql","recursion"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13020838,"title":"How to know if the user has permission on a parent node of a tree?","body":"<p>I have a tree like representation of a company, it is stored in the database as the following table:</p>\n\n<pre><code>  ID       ParentID     Name\n ==================================\n   1        NULL        Company\n   2        1           Division one\n   3        1           Division two\n   4        1           Division three\n   5        2           Department 1.1\n   6        3           Department 2.1\n   7        3           Department 2.2\n   8        3           Department 2.3\n   9        4           Department 3.1\n  10        NULL        Company 2\n</code></pre>\n\n<p>Now, when I give permission to a user, I need to assign him for a group from the above table, if I assign him for a group he will automatically have permission on the child groups. I can easily check this if it's about one group. But for example if I give the user permission on (division 2) and then the user is making some transaction on (department 2.2) I need to find a way that automatically permits the transction because the user is already permitted on a parent group. I can only think of recursive method where I check the targeted group and if user has no permission on it and it has a parent group then I recall the same method to authenticate its parent and so on until I find a group which the user is permitted for or reach the root group and not authenticate the user. Remember the child can have another child within it and so on.</p>\n\n<p>Is there a way to do this in a better way? Either with Linq or plain old T-SQL?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":52,"score":3,"question_id":13016227,"title":"how to group by letter and put in same letter size","body":"<p>I've got a LINQ query to group elements by the first letter of the word</p>\n\n<pre><code>var res = from sign in all\n          group sign by sign.first_letter into grp\n          select grp;\n</code></pre>\n\n<p>But when I have <code>apple</code> and <code>August</code>, I'll get two groups. Group <code>a</code> and group <code>A</code>. How to put them in the same group ?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":105,"score":4,"question_id":13015812,"title":"c# Merging 3 collection list into one list","body":"<p>I have 3 collection list as below. </p>\n\n<pre><code>public static List&lt;Thing&gt; English = new List&lt;Thing&gt;\n{\n    new Thing {ID = 1, Stuff = \"one\"},\n    new Thing {ID = 2, Stuff = \"two\"},\n    new Thing {ID = 3, Stuff = \"three\"}\n};\n\npublic static List&lt;Thing&gt; Spanish = new List&lt;Thing&gt;\n{\n    new Thing {ID = 1, Stuff = \"uno\"},\n    new Thing {ID = 2, Stuff = \"dos\"},\n    new Thing {ID = 3, Stuff = \"tres\"},\n    new Thing {ID = 4, Stuff = \"cuatro\"}\n};\n\npublic static List&lt;Thing&gt; German = new List&lt;Thing&gt;\n{\n    new Thing {ID = 1, Stuff = \"eins\"},\n    new Thing {ID = 2, Stuff = \"zwei\"},\n    new Thing {ID = 3, Stuff = \"drei\"}\n};\n</code></pre>\n\n<p>During runtime, the length of the list may vary. For eg, German may take 5 values, english with 2 and spanish with one. </p>\n\n<p>I need to find which list has the max value and need to get the output in the below format.</p>\n\n<pre><code>      Id English  German  Spanish\n       1  one      eins    uno\n       2  two      zwei    dos\n       3  three    drei    tres\n       4                   cuatro\n</code></pre>\n\n<p>Can you please help me to solve this. </p>\n"},{"tags":["c#","sql","linq","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13019618,"title":"Converting SQL statement using SUM() to Linq/Entity Framework","body":"<p>I'm trying to figure out how to convert the following SQL statement to Entity Framework using Linq:</p>\n\n<pre><code>SELECT SUM(Column1) AS Correct\n     , SUM(Column2) AS Incorrect\n     , UserName\nFROM   Stats \nWHERE (StatType = 0)\nGROUP BY UserName\nORDER BY UserName \n</code></pre>\n\n<p>For the purposes of this question, all the column types in the DB are type INT, and there are multiple rows of data per user. I basically want 3 columns in my output, with the total of correct &amp; incorrect selections for each user.</p>\n\n<p>It seems like such a simple SQL statement but whatever I try in something like LinqPad, I always get errors. I must be missing something relatively simple. As soon as I start add a \".Sum\" clause I get compilation errors etc.</p>\n\n<pre><code>Stats.Where(s =&gt; s.StatType == 0)\n     .GroupBy(s =&gt; s.UserName)\n     .Select(x =&gt; new {  Correct = x.Column1\n                       , Incorrect = x.Column2\n                       , User=x.UserName})\n     .ToList()\n</code></pre>\n"},{"tags":["c#","sql","linq","entity-framework","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":130,"score":0,"question_id":13012545,"title":"How to execute nested query in Linq","body":"<p>I have a LINQ class of this format in C#:</p>\n\n<pre><code>class Vehicle\n{\n  int _VehicleID\n  int _ModelID\n\n  EntetySet&lt;Cars&gt; _AllCars\n  EntetySet&lt;Bus&gt; _AllBus\n  EntetyRef&lt;Driver&gt; _Person\n}\n</code></pre>\n\n<p><strong>Cars table</strong></p>\n\n<pre><code>CarsID | Manufacturer | Type\n1000   | Honda        | Diesel\n1001   | Mitsubishi   | Petrol\n1002   | Maruti       | Diesel\n</code></pre>\n\n<p><strong>Bus table</strong></p>\n\n<pre><code>BusID | Manufacturer | Type\n2000  | Volvo        | Diesel\n2001  | TATA         | Petrol\n2002  | layland      | Petrol\n</code></pre>\n\n<p>From the UI, I will get a Vehicle ID as a parameter. Based on that, all the cars, Bus and its associated tables will get copied to a variable. That is:</p>\n\n<pre><code>Vehicle v1 = new Vehicle();\nv1 = dc.vehicle.where(v =&gt; v.vehicleID == param.vehicleID).findfirst();\n</code></pre>\n\n<p>My <code>v1</code> has all the table and its contents which satisfies the above condition. </p>\n\n<p>Now, I want to filter some more based on the table content present in table cars and bus; i.e based on type of vehicle petrol or diesel.</p>\n\n<p>If I want to copy all the petrol cars and Buses using a query statement in a single line, please tell me the way.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#","linq","dynamic","reflection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13018076,"title":"General Linq Data Method","body":"<p>I would like to create general method that gets data from Linq based on given parameters such as: table , field1 and field2.</p>\n\n<p>one method that will be used instead of these 2 specific ones for example:</p>\n\n<pre><code>public void DistributeCB(ComboBox cb)\n    {\n        BooksDBDataContext db = new BooksDBDataContext();\n        Type T = db.GetType();\n\n        //Authors table\n        var data =db.Authors.Select(author =&gt; new\n        {\n            Id = author.AuthorId, //field 1\n            Value = author.AuthorName //field 2\n        });\n        cb.ValueMember = \"Id\";\n        cb.DisplayMember = \"Value\";\n        cb.DataSource = data;\n    }\n\n    public void DistributeCB2(ComboBox cb)\n    {\n        BooksDBDataContext db = new BooksDBDataContext();\n\n        //Publishers table\n        var data = db.Publishers.Select(publisher =&gt; new\n        {\n            Id = publisher.PublishingId, //field 1\n            Value = publisher.PublishingName //field 2\n        });\n        cb.ValueMember = \"Id\";\n        cb.DisplayMember = \"Value\";\n        cb.DataSource = data;\n    }\n</code></pre>\n"},{"tags":["c#","linq","linq-to-objects"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":118,"score":4,"question_id":13017642,"title":"Can these two LINQ queries be used interchangeably?","body":"<p>a) Would the following two queries produce the same results: </p>\n\n<pre><code>  var query1 = collection_1\n            .SelectMany(c_1 =&gt; c_1.collection_2)\n            .SelectMany(c_2 =&gt; c_2.collection_3)\n            .Select(c_3 =&gt; c_3);\n\n  var query2 = collection_1\n            .SelectMany(c_1 =&gt; c_1.collection_2\n            .SelectMany(c_2 =&gt; c_2.collection_3.Select(c_3 =&gt; c_3)));\n</code></pre>\n\n<p>b) I assume the two queries can't always be used interchangeably? For example, if we wanted the output elements to also contain values of <code>c_1</code> and <code>c_2</code>, then we only achieve this with <code>query2</code>, but not with <code>query1</code>:</p>\n\n<pre><code>  var query2 = collection_1\n            .SelectMany(c_1 =&gt; c_1.collection_2\n            .SelectMany(c_2 =&gt; c_2.collection_3.Select(c_3 =&gt; new { c_1, c_2, c_3 } )));\n</code></pre>\n\n<p>?</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","linq","tuples","anonymous-types"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":103,"score":3,"question_id":13015520,"title":"C# workaround for tuple with names","body":"<p>I want immutable anonymous types with named members that can be passed around, compared and recognized -- a merging of Tuples and anonymous types. <a href=\"http://stackoverflow.com/questions/8200077/is-there-a-way-to-give-meaningful-names-for-tuple-items\"><strong>This doesn't exist</strong></a>, and I realize that. </p>\n\n<p>So the question is: <strong>What is a good idiomatic substitute for this using C#4 or 5?</strong> </p>\n\n<p>The use case is fluid LINQ data processing from heterogeneous data sources. In a word, ETL in C#. I do some pretty complex analysis and data comes from multiple platforms and sources. It's not an option to \"just put it all on the same platform and use Entity Framework\". I want to able to fluidly pass around what are essentially arbitrary <em>records</em> -- immutable named sets of read only properties.</p>\n\n<p>The only thing I can come up with short of creating a custom immutable POCO for every single otherwise-anonymous type is to use attributes to add compiled annotations to methods which return <code>Tuple</code>s. Certainly it wouldn't be hard to write a code-generator for spitting out the immutable POCOs, but I hate how that clutters up the object model of a project. Using <code>dynamic</code> completely erases all the performance and design-time usefulness of static typing, especially if composing further queries from the results of other methods, so I don't consider it a viable solution. </p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// My idea: Adding a attribute to methods to at least record the names\n// of the \"columns\" of a Tuple at a method level\npublic class NamedTupleAttribute : Attribute {\n    public string[] Names { get; private set; }\n    public NamedTupleAttribute(string[] Names) { this.Names = Names; }\n}\n\n// Using NamedTuple attribute to note meaning of members of Tuple\n[NamedTuple(new[] { \"StoreNumber\", \"Gross\", \"Cost\", \"Tax\" })]\npublic IEnumerable&lt;Tuple&lt;int, decimal, decimal, decimal&gt;&gt; GetSales { ... }\n</code></pre>\n\n<hr>\n\n<p>What I want (Imaginary MSDN documentaion for C# 6):</p>\n\n<h3>duck (C# reference)</h3>\n\n<p>The <strong>duck</strong> keyword allows anonymous types to be used in all the statically-typed features of C#. Like normal anonymous types, the compiler will treat anonymous types with the same number, names, and types of properties as having the     same type. However, the duck keyword also allows these types to be used in member declarations and as type parameters for generic types. </p>\n\n<h3>1. duck type instances</h3>\n\n<p>Like anonymous types, instances of duck type objects can only be created using an object initializer\nwithout a type name. The syntax is the same as for a normal anonymous type except that the keyword \n<strong>duck</strong> is added after the <strong>new</strong> operator:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var record = new duck { StoreNumber=1204,\n                        Transaction=410, \n                        Date=new DateTime(2012, 12, 13), \n                        Gross=135.12m, \n                        Cost=97.80m,\n                        Tax=12.11m };\n</code></pre>\n\n<h3>2. duck type references</h3>\n\n<p>Duck types can be referenced using a duck type literal, a duck type alias, or implicitly when the return type of a property or method can be inferred.</p>\n\n<strong>2.1 duck type literals</strong>\n\n<p>A duck type can be expressed with a type literal, which can be used in the place of any type reference. Duck type literals consist of the keyword <strong>duck</strong> followed by a list of name - type identifier pairs just as in a parameter list of a method, except enclosed in curly braces:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// A duck type literal:\nduck { int StoreNumber, int Transaction, DateTime Date, decimal Gross, decimal Cost, decimal Tax }\n\n// In a member declaration:\npublic duck { int StoreNumber, int Transaction, DateTime Date, \n              decimal Gross, decimal Cost, decimal Tax } GetTransaction(...) { ... }\n\n// As a type parameter:\nvar transactions = new List&lt;duck { int StoreNumber, int Transaction, DateTime Date, \n                                   decimal Gross, decimal Cost, decimal Tax }&gt;();\n</code></pre>\n\n<strong>2.2 duck type aliases</strong>\n\n<p>You can assign an alias to a duck type with a using directive immediately after the namespace using directives in a C# code file or namespace. The alias may then be used in the place of any type reference.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// Namespace directives:\nusing System;\nusing Odbc = System.Data.Odbc;\n\n// duck type aliases:\nusing TransTotal = duck { int StoreNumber, int Transaction, DateTime Date, \n                           decimal Gross, decimal Cost, decimal Tax };\n\n// Member declaration:\npublic TransTotal GetTransaction(...) { ... }\n\n// As a type parameter:\nvar transactions = new List&lt;TransTotal&gt;();\n</code></pre>\n\n<strong>2.3 Inferred duck types</strong>\n\n<p>If the return type of a property or method can be inferred, the body of a duck type literal may be omitted in a member declaration:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// Long form:\npublic duck { int StoreNumber, int Transaction, DateTime Date, \n              decimal Gross, decimal Cost, decimal Tax } GetDummyTransaction() {\n    return new duck { ... };\n}\n\n// Short form:\npublic duck GetDummyTransaction() {\n    return new duck { ... };\n}\n\n// Short form as a type parameter:\npublic IEnumerabe&lt;duck&gt; GetTransactions(...) {\n    return \n        from record in someProvider.GetDetails(...)\n        where ((DateTime)record[\"Date\"]).Date == someDate\n        group record by new {\n            StoreNumber = (int)record[\"Number\"],\n            Transaction = (int)record[\"TransNum\"],\n            Date = (DateTime)record[\"Date\"]\n        } into transTotal\n        select new duck {\n            transTotal.Key.StoreNumber,\n            transTotal.Key.Transaction,\n            transTotal.Key.Date,\n            Gross = transTotal.Sum(x =&gt; (decimal)x[\"Gross\"]),\n            Cost = transTotal.Sum(x =&gt; (decimal)x[\"Cost\"]),\n            Tax = transTotal.Sum(x =&gt; (decimal)x[\"Tax\"]),\n        };\n}\n</code></pre>\n"},{"tags":["c#","linq","data-structures","igrouping"],"answer_count":3,"favorite_count":0,"up_vote_count":21,"down_vote_count":0,"view_count":4005,"score":21,"question_id":4804477,"title":"Get \"Value\" property in IGrouping (Linq)","body":"<p>I have a data structure like</p>\n\n<pre><code>public DespatchGroup(DateTime despatchDate, List&lt;Products&gt; products);\n</code></pre>\n\n<p>And I am trying to do...</p>\n\n<pre><code>var list = new List&lt;DespatchGroup&gt;();\n\nforeach (var group in dc.GetDespatchedProducts().GroupBy(i =&gt; i.DespatchDate))\n{\n    // group.Values is not correct... how do I write this?\n    list.Add(new DespatchGroup(group.Key, group.Values);\n}\n</code></pre>\n\n<p>I'm obviously not understanding <code>IGrouping</code> as I can't see how to actually get to the data records within the group!</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13017945,"title":"LINQ datarow string to array and then into to string list","body":"<p>I have some code that will loop over <code>DataRow</code>s and will split a pipe delimited column in the <code>DataRow</code> into an array, and then into a <code>List&lt;string&gt;</code>.</p>\n\n<p>Is there a better way to do this using LINQ? I've tried but got nowhere!</p>\n\n<pre><code>List&lt;string&gt; allSizes = new List&lt;string&gt;();\n\nforeach (DataRow resultRow in results.Rows)\n{\n    if (resultRow[\"Sizes\"] != DBNull.Value)\n    {\n        string[] sizes = resultRow[\"Sizes\"].ToString().Split('|');\n        foreach (string size in sizes)\n        {\n            if (!allSizes.Contains(size))\n            {\n                allSizes.Add(size);\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","plinq"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":116,"score":4,"question_id":12993749,"title":"Refactor LINQ ForEach to return IEnumerable<T>","body":"<p>I am creating an array with the following <code>CreateArray</code> static method:</p>\n\n<pre><code>public static int[] CreateArray(int size)\n{\n    var ret = new int[size];\n    ret[0] = 0;\n    ret[1] = 1;\n\n    Parallel.ForEach(Enumerable.Range(2, size - 2), i =&gt;\n    {\n        ret[i] = Func(i).Count();\n    });\n\n    return ret;\n}\n</code></pre>\n\n<p>Where Func looks like:</p>\n\n<pre><code>public static IEnumerable&lt;int&gt; Func(int i)\n{\n    ...\n}\n</code></pre>\n\n<p>Is it possible to refactor the <code>CreateArray</code> method in something like:</p>\n\n<pre><code>public static int[] CreateArray(int size)\n{\n    var tableFromIndex2 = ...\n    return new[] { 0, 1 }\n        .Concat(tableFromIndex2)\n        .ToArray();\n}\n</code></pre>\n"},{"tags":["c#","asp.net-mvc","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12982763,"title":"Linq left not in right table","body":"<p>I'm not much of a LINQ programmer so this is baffling me somewhat. I have two tables: first a Schedule with a StartDate and an EndDate, plus ID; secondly, a ScheduleInstance table with an InstanceDate and a ScheduleID. For every day between Schedule.StartDate and Schedule.EndDate inclusive I need to create a ScheduleInstance row - however, only 24 hours ahead. As schedules are created and deleted within the 24 hour look-ahead, I have to spawn a checker every n minutes to check whether the ScheduleInstance for the ScheduleID exists within that 24 hour window.</p>\n\n<p>Models:</p>\n\n<pre><code>public class Schedule\n{\n    public int ID { get; set; }\n    public DateTime StartDate { get; set; }\n    public DateTime EndDate { get; set; }\n}\npublic class ScheduleInstance\n{\n    public int ID { get; set; }\n    public int ScheduleID { get; set; }\n    public DateTime InstanceDate { get; set; }\n}\n</code></pre>\n\n<p>The start of the LINQ:</p>\n\n<pre><code>var skeds = from sked in context.Schedules\n            join instance in context.ScheduleInstances\n                on sked.ID equals instance.ScheduleID\n            where ((sked.StartDate &lt;= DateTime.Now) &amp;&amp; (sked.EndDate &gt;= DateTime.Now))\n            select sked.ID;\n</code></pre>\n\n<p>(obviously wrong)</p>\n\n<p>To summarise, I need to get a list of Schedule.ID where a ScheduleInstance does NOT exist for ScheduleInstance.InstanceDate within the next 24 hours.</p>\n\n<p>Many thanks for any help.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<pre><code>        DateTime tomorrow = DateTime.Now.AddDays(1);\n        var skeds = from sked in context.Schedules\n                    join instance in context.ScheduleInstances\n                         on sked.ID equals instance.ScheduleID into g\n                    where (sked.StartDate &lt;= tomorrow) &amp;&amp;\n                          (sked.EndDate &gt;= tomorrow) &amp;&amp;\n                           !g.Any()\n                    select sked;\n</code></pre>\n\n<p>This now works in that an instance is created (in subsequent code that's not relevant here) if one doesn't exist for tomorrow. If I set StartDate to Now+2mins then after 2 minutes that Schedule gets created - perfect. However, if I advance the clock 24 hours, I should be getting a whole bunch of new instances. To reiterate, if a Schedule start date is now and the end date is 30 days later, then I should end up with 31 instances, with each new instance created 24 hours in advance.</p>\n"},{"tags":["linq","entity-framework","linq-to-entities","iqueryable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13016811,"title":"IQueryable Where integer property expression usage?","body":"<p>So I have a query I'm constructing using Entity Framework, LINQ. Depending on the search parameter, and the type of the parameter being searched. </p>\n\n<p>I have created a function like this:</p>\n\n<pre><code>public static IQueryable&lt;T&gt; WhereInt&lt;T&gt;(this IQueryable&lt;T&gt; query, string propertyName, string contains)\n        {\n            var parameter = Expression.Parameter(typeof(T), \"type\");\n            var propertyExpression = Expression.Property(parameter, propertyName);\n\n            MethodInfo method = typeof(string).GetMethod(\"First\");\n            var someValue = Expression.Constant(contains, typeof(string));\n            var containsExpression = Expression.Call(propertyExpression, method, someValue);\n\n            return query.Where(Expression.Lambda&lt;Func&lt;T, bool&gt;&gt;(containsExpression, parameter));\n\n        }\n</code></pre>\n\n<p>Used as such:</p>\n\n<pre><code>WhereInt(DCs, searchfield, search);\n</code></pre>\n\n<p><code>searchfield</code> could be userid, username, integer or string, and ideally I want to do:</p>\n\n<pre><code>searchfield.value == search.toInt32()\n</code></pre>\n\n<p>sort of feature.</p>\n\n<p>I want to also make <code>DateTime</code> types searchable too. Maybe I'll make a <code>WhereDateTime</code> for that.</p>\n\n<p>I get an error on <code>var containsExpression = Expression.Call(propertyExpression, method, someValue);</code></p>\n\n<p>This works fine with strings, but fails with the error:</p>\n\n<pre><code>Value cannot be null.\nParameter name: method\n</code></pre>\n"},{"tags":["c#","database","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13016463,"title":"error 26 cannot connect to database","body":"<p>I took an old software made by someone else, which need to connect to a database with the .mdf extension.</p>\n\n<p>But when I run the software, I have an <code>error 26</code>. I have obviously checked Google and it seems the the main problem is the firewall. But if I disable it the problem doesn't dissapear.</p>\n\n<p>Here is the code for connect the database : </p>\n\n<pre><code>DataClasses1DataContext db = new DataClasses1DataContext(Environment.CurrentDirectory + \"\\\\bddgestionvin.mdf\");\n</code></pre>\n\n<p>I've noticed, when I try to connect the database with the datacontext class it fail too with the same <code>error 26</code>. (see attached screenshot below)</p>\n\n<p>The string connection used by this class is : </p>\n\n<pre><code>Data Source=.\\SQLEXPRESS;AttachDbFilename=|DataDirectory|\\bddgestionvin.mdf;Integrated Security=True;Connect `Timeout=30;User Instance=True`\n</code></pre>\n\n<p>I know I'm a little vague but I never did that kind of stuff (connect to a .mdf database) And the code is not mine, feel free the ask further explanation / code. Any help is welcome !</p>\n\n<p>P.S The error message is </p>\n\n<blockquote>\n  <p>SqlException was unhandled A network-related or instance-specific\n  error occurred while establishing a connection to SQL Server. The\n  server was not found or was not accessible. Verify that the instance\n  name is correct and that SQL Server is configured to allow remote\n  connections. (provider: SQL Network Interfaces, error: 26 - Error\n  Locating Server/Instance Specified)</p>\n</blockquote>\n\n<p><img src=\"http://i.stack.imgur.com/jyCQS.png\" alt=\"enter image description here\"></p>\n\n<p>(Sorry for the french software)</p>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13016877,"title":"LINQ How to Average an internal list","body":"<p>What is the LINQ syntax for the Average need below.  Both Select and SelectMany fail me.\nI can Max() and Sum() my internal list, but Average() wont compile.</p>\n\n<p>The JSON version of the simple list looks like</p>\n\n<pre><code>[{\"Week\":6, \"Matches\":[{\"Game\":189},{\"Game\":149},{\"Game\":132}]} ....\n\nvar hiGame = games.Max(g =&gt; g.Matches.Max(m =&gt; m.Game)); // ok\nvar hiSeries = games.Max(g =&gt; g.Matches.Sum(m =&gt; m.Game)); // ok\nvar ave = games.Average(g =&gt; g.Matches.SelectMany(m =&gt; m.Game)); // no go\n</code></pre>\n\n<p>The type arguments for method 'System.Linq.Enumerable.SelectMany(System.Collections.Generic.IEnumerable, System.Func>)' cannot be inferred from the usage. Try specifying the type arguments explicitly.</p>\n"},{"tags":["c#",".net","linq","file","linq-to-xml"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13016054,"title":"Querying a XML FIle and creating a text file","body":"<p>I have a XML file :TableList.xml</p>\n\n<pre><code>&lt;TableList&gt;  \n&lt;Table&gt;  \n&lt;TableName&gt;TableA&lt;/TableName&gt;  \n&lt;Columns&gt;ColumnA1,ColumnA2,ColumnA3,ColumnA4&lt;/Columns&gt;  \n&lt;/Table&gt;  \n&lt;Table&gt;  \n&lt;TableName&gt;TableB&lt;/TableName&gt;  \n&lt;Columns&gt;ColumnB1,ColumnB2,ColumnB3,ColumnB4&lt;/Columns&gt;  \n&lt;/Table&gt;  \n&lt;/TableList&gt;  \n</code></pre>\n\n<p>I want query this file using Linq-to-XML and for each of the values I want derive the following format </p>\n\n<pre><code>The table - TableA - has columns - ColumnA1,ColumnA2,ColumnA3,ColumnA4.\n\nThe table - TableB - has columns - ColumnB1,ColumnB2,ColumnB3,ColumnB4.\n</code></pre>\n\n<p>and have it created as a single text file - <code>TableDoc.txt</code> -at the end.</p>\n\n<p>How can this be dome with brevity using Linq-to-XML?</p>\n"},{"tags":["linq","entity-framework","include"],"answer_count":3,"favorite_count":5,"up_vote_count":14,"down_vote_count":0,"view_count":16582,"score":14,"question_id":3356541,"title":"Entity framework linq query Include() multiple children entities","body":"<p>This may be a really elementry question but whats a nice way to include multiple children entities when writing a query that spans THREE levels (or more)?</p>\n\n<p>i.e. I have 4 tables: <code>Company</code>, <code>Employee</code>, <code>Employee_Car</code> and <code>Employee_Country</code></p>\n\n<p>Company has a 1:m relationship with Employee.</p>\n\n<p>Employee has a 1:m relationship with both Employee_Car and Employee_Country.</p>\n\n<p>If i want to write a query that returns the data from all 4 the tables, I am currently writing:</p>\n\n<pre><code>Company company = context.Companies\n                         .Include(\"Employee.Employee_Car\")\n                         .Include(\"Employee.Employee_Country\")\n                         .FirstOrDefault(c =&gt; c.Id == companyID);\n</code></pre>\n\n<p>There has to be a more elegant way! This is long winded and generates horrendous SQL</p>\n\n<p>I am using EF4 with VS 2010</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#",".net","performance","linq","optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":98,"score":0,"question_id":13014357,"title":"Optimizing A LINQ To Objects Query","body":"<p>I'm trying to optimize the below LINQ query to improve it's speed performance.  The number of objects it's searching against could be in the tens of thousands.</p>\n\n<pre><code>var lQuery = from o in oEvents\nwhere (o.oSalesEvent != null &amp;&amp; o.oSalesEvent.OccurDate &lt; oCalcMgr.OccurDate &amp;&amp; (\n                (oCalcMgr.InclTransTypes == Definitions.TransactionTypes.SalesAll) ?\n                   (o.oSalesEvent.EventStateID == ApprovedID || o.oSalesEvent.EventStateID == PendingID) : \n                   o.oSalesEvent.EventStateID == ApprovedID)) &amp;&amp;\n      ((oCalcMgr.InclTransTypes == Definitions.TransactionTypes.SalesAll) ? \n                (o.oSalesMan.oEmployment.EventStateID == ApprovedID || o.oSalesMan.oEmployment.EventStateID == PendingID) : \n                 o.oSalesMan.oEmployment.EventStateID == ApprovedID)\nselect new { SaleAmount = o.SaleAmount.GetValueOrDefault(), CompanyID = o.oSalesEvent.CompanyID };\n</code></pre>\n\n<p>The query basically says, give me the sales amounts and company ids from all sale events that occurred prior to a certain date.  The sale event's status and the salesman's employment status should either always be \"approved\" or they can be also \"pending\" if specified.</p>\n\n<p>As you can see there's a date comparison and a couple of integer comparisons.  Which integer comparison used is based on whether or not a property matches a certain Enum value.</p>\n\n<p>I have some ideas of my own on ways to go about the optimization, but I want to hear others thoughts, who might have more insight into how LINQ would translate this query behind the scenes.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","linq","linq-to-objects","dynamic-linq"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":779,"score":1,"question_id":3461538,"title":"Linq.Dyanmic GroupJoin implementation","body":"<p>I am working on creating an Extension Method in the Linq.Dynamic project for GroupJoin. But, for some reason it will not run. The signatures seem to match.</p>\n\n<pre><code>public static IQueryable GroupJoin(this IQueryable outer, IEnumerable inner, string outerSelector, string innerSelector, string resultsSelector, params object[] values)\n{\n    if (inner == null) throw new ArgumentNullException(\"inner\");\n    if (outerSelector == null) throw new ArgumentNullException(\"outerSelector\");\n    if (innerSelector == null) throw new ArgumentNullException(\"innerSelector\");\n    if (resultsSelector == null) throw new ArgumentNullException(\"resultsSelctor\");\n\n    LambdaExpression outerSelectorLambda = DynamicExpression.ParseLambda(outer.ElementType, null, outerSelector, values);\n    Type enumType = GetList(inner.AsQueryable().ElementType).GetType();\n\n    LambdaExpression innerSelectorLambda = DynamicExpression.ParseLambda(inner.AsQueryable().ElementType, null, innerSelector, values);\n\n    ParameterExpression[] parameters = new ParameterExpression[] { \n    Expression.Parameter(outer.ElementType, \"outer\"), Expression.Parameter(enumType, \"inner\") };\n    LambdaExpression resultsSelectorLambda = DynamicExpression.ParseLambda(parameters, null, resultsSelector, values);        \n\n    return outer.Provider.CreateQuery(\n        Expression.Call(\n            typeof(Queryable), \"GroupJoin\",\n            new Type[] { outer.ElementType, inner.AsQueryable().ElementType, outerSelectorLambda.Body.Type, resultsSelectorLambda.Body.Type },\n            outer.Expression, inner.AsQueryable().Expression, Expression.Quote(outerSelectorLambda), Expression.Quote(innerSelectorLambda), Expression.Quote(resultsSelectorLambda)));\n}\n\npublic static IEnumerable GetList(System.Type type)\n{\n    return (IEnumerable)Activator.CreateInstance(typeof(List&lt;&gt;).MakeGenericType(type));\n}\n</code></pre>\n\n<p>This code gives me the following error: </p>\n\n<blockquote>\n  <p>No generic method 'GroupJoin' on type 'System.Linq.Queryable' is compatible with the supplied type arguments and arguments. No type arguments should be provided if the method is non-generic.</p>\n</blockquote>\n\n<p>In looking at the results of each piece they seem to match:\nWriting the follwing GroupJoin:</p>\n\n<pre><code>man.Contacts.GroupJoin(man.ContactAddresses, param_0 =&gt; param_0.ContactId, param_0 =&gt; param_0.ContactId, \n                (outer, inner) =&gt; new { ContactId = outer.ContactId, FirstName = outer.FirstName, LastName = outer.LastName, MI = outer.MiddleInitial, ContactAddresses = inner });\n</code></pre>\n\n<p>I get the debug of:</p>\n\n<pre><code>.Call System.Linq.Queryable.GroupJoin(\n.Constant&lt;IdeaBlade.EntityModel.EntityQueryProxy`1[LOC.AMP.Data.DomainModel.Contact]&gt;(IdeaBlade.EntityModel.EntityQueryProxy`1[LOC.AMP.Data.DomainModel.Contact]),    .Constant&lt;IdeaBlade.EntityModel.EntityQueryProxy`1[LOC.AMP.Data.DomainModel.ContactAddress]&gt;(IdeaBlade.EntityModel.EntityQueryProxy`1[LOC.AMP.Data.DomainModel.ContactAddress]),\n'(.Lambda #Lambda1&lt;System.Func`2[LOC.AMP.Data.DomainModel.Contact,System.Int64]&gt;),\n'(.Lambda #Lambda2&lt;System.Func`2[LOC.AMP.Data.DomainModel.ContactAddress,System.Int64]&gt;),\n'(.Lambda #Lambda3&lt;System.Func`3[LOC.AMP.Data.DomainModel.Contact,System.Collections.Generic.IEnumerable`1[LOC.AMP.Data.DomainModel.ContactAddress],    &lt;&gt;f__AnonymousType0`5[System.Int64,System.String,System.String,System.String,System.Collections.Generic.IEnumerable`1[LOC.AMP.Data.DomainModel.ContactAddress]]]&gt;))\n.Lambda #Lambda1&lt;System.Func`2[LOC.AMP.Data.DomainModel.Contact,System.Int64]&gt;(LOC.AMP.Data.DomainModel.Contact $param_0)\n{\n    $param_0.ContactId\n}    \n.Lambda #Lambda2&lt;System.Func`2[LOC.AMP.Data.DomainModel.ContactAddress,System.Int64]&gt;(LOC.AMP.Data.DomainModel.ContactAddress $param_0)\n{\n    $param_0.ContactId\n}    \n.Lambda \n    #Lambda3&lt;System.Func`3\n    [\n        LOC.AMP.Data.DomainModel.Contact, System.Collections.Generic.IEnumerable`1[LOC.AMP.Data.DomainModel.ContactAddress],\n        &lt;&gt;f__AnonymousType0`5\n        [\n            System.Int64,System.String,System.String,System.String, System.Collections.Generic.IEnumerable`1\n            [\n                LOC.AMP.Data.DomainModel.ContactAddress\n            ]\n        ]\n    ]&gt;\n    (LOC.AMP.Data.DomainModel.Contact $outer, System.Collections.Generic.IEnumerable`1\n        [LOC.AMP.Data.DomainModel.ContactAddress] $inner) \n\n    {\n    .New &lt;&gt;f__AnonymousType0`5[System.Int64,System.String,System.String,System.String,System.Collections.Generic.IEnumerable`1[LOC.AMP.Data.DomainModel.ContactAddress]](\n        $outer.ContactId,\n        $outer.FirstName,\n        $outer.LastName,\n        $outer.MiddleInitial,\n        $inner)\n}\n</code></pre>\n\n<p>With the following GroupJoin:</p>\n\n<pre><code>man.Contacts.GroupJoin(man.ContactAddresses, \"ContactId\", \"ContactId\", \"new (outer.ContactId as ContactId, outer.FirstName as FirstName, outer.LastName as LastName, outer.MiddleInitial as MI, inner as ContactAddresses)\");\n</code></pre>\n\n<p>Then looking at the debug:</p>\n\n<pre><code>.Call GroupJoin (\n{value(IdeaBlade.EntityModel.EntityQueryProxy'1[LOC.AMP.Data.DomainModel.Contact])},    {value(IdeaBlade.EntityModel.EntityQueryProxy'1[LOC.AMP.Data.DomainModel.ContactAddress])},\n'(.Lambda #Lambda1&lt;System.Func'2[LOC.AMP.Data.DomainModel.Contact,System.Int64]&gt;),\n'(.Lambda #Lambda1&lt;System.Func'2[LOC.AMP.Data.DomainModel.ContactAddress,System.Int64]&gt;),\n'(.Lambda #Lambda1&lt;System.Func'3[LOC.AMP.Data.DomainModel.Contact,System.Collections.Generic.List`1[LOC.AMP.Data.DomainModel.ContactAddress],DynamicClass1]&gt;)\n\n//ContactId\n.Lambda #Lambda1&lt;System.Func'2[LOC.AMP.Data.DomainModel.Contact,System.Int64]&gt;(LOC.AMP.Data.DomainModel.Contact $var1) \n{\n    $var1.ContactId\n}\n\n//CA.ContactId\n.Lambda #Lambda1&lt;System.Func'2[LOC.AMP.Data.DomainModel.ContactAddress,System.Int64]&gt;(LOC.AMP.Data.DomainModel.ContactAddress $var1)\n{\n    $var1.ContactId\n}\n//Dynamic Result\n.Lambda #Lambda1&lt;System.Func`3[LOC.AMP.Data.DomainModel.Contact,System.Collections.Generic.List`1[LOC.AMP.Data.DomainModel.ContactAddress],DynamicClass1]&gt;(\n    LOC.AMP.Data.DomainModel.Contact $outer,\n    System.Collections.Generic.List`1[LOC.AMP.Data.DomainModel.ContactAddress] $inner)\n    {\n    .New DynamicClass1(){\n        ContactId = $outer.ContactId,\n        FirstName = $outer.FirstName,\n        LastName = $outer.LastName,\n        MI = $outer.MiddleInitial,\n        ContactAddresses = $inner\n    }\n}\n</code></pre>\n\n<p>The only thing different is <code>List&lt;T&gt;</code> compared to IEnumerable. But <code>List&lt;T&gt;</code> is IEnumerable.\nThe error reads like the signature is wrong. I just can't figure it out.</p>\n\n<p>Any incite would be great.</p>\n"},{"tags":["c#","linq","nhibernate","fluent-nhibernate"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":13006002,"title":"Query on encrypted values using LINQ","body":"<p>I have a user class that has username which I need to save in the DB encrypted</p>\n\n<pre><code>public abstract class User\n{\n    public virtual int Id { get; protected set; }\n    public virtual string Username\n    {\n        get\n        {\n            return _encryptionProvider.Decrypt(SecuredUsername);\n        }\n        protected set\n        {\n            SecuredUsername = _encryptionProvider.Encrypt(value);\n        }\n    }\n    [Obsolete(\"Use the 'Username' property -- this property is only to be used by NHibernate\")]\n    protected virtual string SecuredUsername { get; set; }\n}\n</code></pre>\n\n<p>I mapped the User entity as below:</p>\n\n<pre><code>public class UserMapping : ClassMap&lt;User&gt;\n{\n    public UserBaseMapping()\n    {\n        Id(user =&gt; user.Id).GeneratedBy.HiLo(\"100\");\n        Map(Reveal.Member&lt;UserBase&gt;(\"SecuredUsername\")).Unique();\n    }\n}\n</code></pre>\n\n<p>It worked fine until I had to write some LINQ statement.</p>\n\n<pre><code>User user = _session.QueryOver&lt;User&gt;().Where(x =&gt; x.Username == \"Hamza\").SingleOrDefault();\n</code></pre>\n\n<p>The problem here is that when LINQ translates above statement to SQL it becomes something like this:\nSelect * from [dbo].[User] Where Username like 'Hamza'</p>\n\n<p>And as you might noticed there is no column called username in the table but securedusername and it contains the encrypted value\nCan anyone please help me solving this issue, I need to be able to query using LINQ.</p>\n"},{"tags":["linq","datatables"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":1149,"score":-1,"question_id":8939516,"title":"How to find duplicate record using Linq from DataTable","body":"<p>Here is if my DataTable</p>\n\n<pre><code>DataTable dt = new DataTable();\ndt.Rows.Add(2,Test1,Sample1);\ndt.Rows.Add(2,Test2,Sample2);\ndt.Rows.Add(4,Test3,Sample3);\ndt.Rows.Add(4,Test4,Sample4);\ndt.Rows.Add(2,Test5,Sample5);\n</code></pre>\n\n<p>I want to display message Duplicate record exist for class 4\nit is possbile by using two loops by comparing, but i want an optimized code that will return me the duplicate record and i will display a message. The code may be using Linq if any body know please share..?</p>\n"},{"tags":["c#","linq","datatable","index","criteria"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":12930840,"title":"How to select rows from DataTable based on Index / Row Number?","body":"<p>I have a <code>DataTable</code>. I want to select the rows based on the <code>Index</code>/<code>Row Number</code> of the rows in <code>DataTable</code>. </p>\n\n<p>Suppose below is the <code>DataTable</code>:</p>\n\n<pre><code>----------------    ---------------\n| ID   | Name  |    | Index/RowNo |\n----------------    ---------------\n| A001 | John  |    |      1      |\n| A002 | Foo   |    |      2      |\n| A003 | Rambo |    |      3      |\n| A004 | Andy  |    |      4      |\n| ...  | ...   |    |      5      |\n----------------    ---------------\n</code></pre>\n\n<p>Now, i want to select the Rows from above shown <code>DataTable</code> using criteria say for example <code>Index &gt; 2</code>, In that case First entry at Index 1, <code>A001 | John</code>, will not become part of the resultant <code>DataTable</code>. How can i do it efficiently?</p>\n\n<p>Moreover, i want to have my result both in the form of <code>DataTable</code> and <code>Linq</code> query outcome.</p>\n\n<p>I am trying to do something like this:</p>\n\n<pre><code>var result = dt.Select(\"RowNum &gt; 1\", \"\");\n</code></pre>\n\n<p>OR </p>\n\n<pre><code>var result = from row in dt.AsEnumerable()\n             where RowNum &gt; 1\n             select row;\n</code></pre>\n"},{"tags":["c#","linq","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":95,"score":-4,"question_id":11938254,"title":"Can't use 'contains' in LINQ","body":"<pre><code>string last = url.Substring(url.LastIndexOf('/') + 1);\nvar provisionedSiteRequestRep = provisioningRequestRepository.SelectFirst(new WhereSpecification&lt;ProvisioningRequest&gt;(result =&gt; result.SiteUrl.Contains(last.ToString())));\n</code></pre>\n\n<p>Some time i am getting the null values of last.tosting() so i am getting exception for this code how to resolve this?</p>\n"},{"tags":["sql","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":45,"score":-3,"question_id":13005807,"title":"Linq - SQL query conversion","body":"<p>Can some one help me to convert this query to linq? I dont know how to use union and then sum in linq.</p>\n\n<pre><code>SELECT Patientname, SUM(A)AS Trec\n  FROM (SELECT Pm.Patientname, COUNT(*)AS A\n          FROM Facilitycheckinholdorder Fcho\n              INNER JOIN Medordertype Mot ON Fcho.Orderseq = Mot.Orderseq\n              JOIN Patientmaster Pm ON Mot.Patientseq = Pm.Patientseq\n                   AND Fcho.Filleddate BETWEEN '2011-09-01 00:00:00:000' AND '2012-10-16 00:00:00:000'\n                   AND Mot.Facilityid = 139\n         GROUP BY Pm.Patientname\n       UNION ALL\n       SELECT Pm.Patientname, COUNT(*)AS A\n         FROM Rxqdeliveryholdorder Rdho\n              INNER JOIN Medordertype Mot ON Rdho.Orderseq = Mot.Orderseq\n              JOIN Patientmaster Pm ON Mot.Patientseq = Pm.Patientseq\n                   AND Rdho.Filleddate BETWEEN '2011-09-01 00:00:00:000' AND '2012-10-16 00:00:00:000'\n                   AND Mot.Facilityid = 139\n         GROUP BY Pm.Patientname\n      ) AS Trec\n  GROUP BY Patientname;\n</code></pre>\n"},{"tags":["c#",".net","sql-server","linq","sqldatareader"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":13011808,"title":"Does LINQ load all items from SQL Server into memory or chunks only?","body":"<p>I am wondering hoq the LINQ and SqlDataProvider manages to itearate through a  WHOLE table.</p>\n\n<p><strong>For the example below,</strong></p>\n\n<ul>\n<li><p>Are the whole foo items LOADED into the MEMORY at ONCE and CLR\niterates through the foo items in the memory?</p></li>\n<li><p>Or the foo items are loaded from SQL Server in chunks?</p></li>\n<li><p>Or they are LOADED from the SQL SERVER into the MEMORT only ONE foo\nat a time?</p></li>\n<li><p>Or ?</p></li>\n</ul>\n\n<p>&nbsp;</p>\n\n<pre><code>using (var context = new FooEntities())\n{\n    var allItems = from foo in context.Foos\n                   select foo;      \n\n    // Are all foos LOADED into the MEMORY at once?\n    // Or they come from SQL SERVER in chunks?\n    foreach (f in foos)\n        Console.WriteLine(f.ID);\n}\n</code></pre>\n"},{"tags":["asp.net","linq","silverlight-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12815278,"title":"Error in Silverlight project in ASP.NET with LINQ","body":"<p>I want to make a simple Silverlight application in ASP.NET and LINQ. I have two talbe </p>\n\n<blockquote>\n  <p>Student :[student_id,student_name,address, phone,country_id] Country\n  :[country_id,country_name]</p>\n</blockquote>\n\n<p>Thiw tow table is join by country_id. \nI have inluced a LINQ Data Class in my project. \nI have included a Silverlight-Enabled-WCF-Serfice. In this service I have made tow method and there code is like</p>\n\n<pre><code>[OperationContract]\n        public List&lt;Country&gt; LoadCountry()\n        {\n            var result = from coun in oLINQDataClassesDataContext.Countries\n                         select coun;\n            return result.ToList();\n        }\n\n        [OperationContract]\n        public IList&lt;Student&gt; LoadStudent()\n        {\n\n            var result = from std in oLINQDataClassesDataContext.Students\n                         select std;        \n            return result.ToList();\n        }\n</code></pre>\n\n<p>Then I add a service reference of that WCF service. Then I include a DataGrid in my silverlight .xml file.</p>\n\n<p>Now I want to show all the students in that DataGrid. For this I have written the following code</p>\n\n<p>WCFServiceReference.WCFServiceClient oWCFServiceClient = new WCFServiceReference.WCFServiceClient();</p>\n\n<pre><code>    public Home()\n    {\n        InitializeComponent();\n        oWCFServiceClient.LoadStudentCompleted += new EventHandler&lt;WCFServiceReference.LoadStudentCompletedEventArgs&gt;(oWCFServiceClient_LoadStudentCompleted);\n        oWCFServiceClient.LoadStudentAsync();\n\n    }\n\n    void oWCFServiceClient_LoadStudentCompleted(object sender, WCFServiceReference.LoadStudentCompletedEventArgs e)\n    {\n        dataGrid1.ItemsSource = e.Result;\n    }\n</code></pre>\n\n<p>Then I build the whole project and found no error. If I run the project then I found an error and it is--</p>\n\n<blockquote>\n  <p>An exception occurred during the operation, making the result invalid.\n  Check InnerException for exception details.    at\n  System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary()\n  at\n  Silverlight.WCFServiceReference.LoadStudentCompletedEventArgs.get_Result()\n  at Silverlight.Home.oWCFServiceClient_LoadStudentCompleted(Object\n  sender, LoadStudentCompletedEventArgse)    at\n  Silverlight.WCFServiceReference.WCFServiceClient.OnLoadStudentCompleted(Object\n  state)</p>\n</blockquote>\n\n<p>If I remove county table form the LINQ class and remove LoadCountry() method form the service  and call LoadStudent()  method form silverlight form then it runs accurately and all the data is displayed in my DataGrid. </p>\n\n<p>If I remove student table form the LINQ class and remove LoadStudent() method form the service  then LoadCountry() method runs accurately.  Both methods are not work if the present same time in LINQ &amp; WCF Service .</p>\n\n<p>NB: Both tables has data. If I run a SQL join query then it returns data</p>\n\n<p>I cant understand what the problem is.</p>\n\n<p>Is there anyone to help me regarding this problem?</p>\n\n<p>Thanks in advance.\nRashed</p>\n"},{"tags":["c#","linq","entity"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":11522214,"title":"C# Entity LINQ returns wrong and duplicate values","body":"<p>I use the following code :</p>\n\n<pre><code>List&lt;vw_GetIMeasurements&gt; Imeasurements = context.vw_GetIMeasurements.Where(f =&gt; f.MEMBERID == userID).Distinct().ToList();\n</code></pre>\n\n<p>This returns a list with 12 Values like it should but these values are always the same(even though they aren't in the DB.(Even if they were distinct should solve this)</p>\n\n<p><img src=\"http://i.stack.imgur.com/PgGH0.png\" alt=\"Visual of the issue\"></p>\n\n<p>DB :</p>\n\n<p><img src=\"http://i.stack.imgur.com/ZJY6N.png\" alt=\"Database Image\"></p>\n\n<p>The raw value that is returned is also wrong.\nWhat would be the cause of this issue and how can I resolve it?</p>\n"},{"tags":["asp.net","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13010365,"title":"asp.net linq .contains \"string\"","body":"<p>I have a field in a dataset and im querying using Linq my code is </p>\n\n<pre><code> var countriesQry = from a in countTbl.AsEnumerable()\n                               where a[\"CountryId\"].ToString().Contains(countryId)\n                               orderby a[\"CountryId\"]\n</code></pre>\n\n<p>my problem is that in the \"CountryId\" field there can be a countryid of 1,22,13 (its a varchar field) so something can be a few countries. as you can guess its returning 1 and 13 if the \"Countryid\" = 1 can anyone tell how I can correct it</p>\n\n<p>thanks </p>\n"},{"tags":["c#","asp.net",".net","linq","sorting"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3014,"score":1,"question_id":979724,"title":"ASP.net gridview datasource null when sorting","body":"<p>Here we are again with the next problem in sorting.</p>\n\n<p>this is a follow up question to <a href=\"http://stackoverflow.com/questions/975712/asp-net-gridview-sorting-with-linq-result\">this question</a></p>\n\n<p>I have now made a type to contain the data I need.\nhowever, when I try to fetch the data FROM the gridview it returns null, which means I can't sort anything that is not there in the first place...</p>\n\n<p>any ideas why this returns null ...</p>\n\n<pre><code>IEnumerable&lt;JointServerData&gt; data = gvServers.DataSource;\nvar sorted = data;\nswitch (p)\n   {\n       case \"domain\":\n            sorted = data.OrderBy(o =&gt; o.DomainName);\n            break;\n       default:\n            break;\n    }\ngvServers.DataSource = sorted;\ngvServers.DataBind();\n</code></pre>\n\n<p>above is what I'm trying to do ...</p>\n"},{"tags":["c#","linq","string-concatenation"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13006411,"title":"Concatenate a constant string to each item in a List<string> using LINQ","body":"<p>I am using C# and .Net 4.0. </p>\n\n<p>I have a <code>List&lt;string&gt;</code> with some values, say x1, x2, x3. To each of the value in the <code>List&lt;string&gt;</code>, I need to concatenate a constant value, say \"y\" and get back the <code>List&lt;string&gt;</code> as x1y, x2y and x3y. </p>\n\n<p>Is there a Linq way to do this?</p>\n"},{"tags":["c#","asp.net","sql","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":110,"score":1,"question_id":13007056,"title":"LINQ Query to retrieve items","body":"<p>So I am using EF, I have the following entities:</p>\n\n<ul>\n<li><code>Website</code></li>\n<li><code>Sector</code></li>\n<li><code>Product</code></li>\n<li><code>Attribute</code></li>\n<li><code>AttributeTag</code></li>\n</ul>\n\n<p>The relationships are as follow:</p>\n\n<p><img src=\"http://i.stack.imgur.com/wvyAs.png\" alt=\"enter image description here\"></p>\n\n<p>I need to retrieve something that is not directly linked to the table. Such as products which needs a <code>Sector</code> object in order to retrieve only the specific <code>Products</code> using something such as <code>sector.Products</code>.</p>\n\n<p>But what if I need to retrieve all <code>Products</code> under a given <code>Website</code> instead of it's parent <code>Sector</code> ?</p>\n\n<p>In my specific situation, my questions are:\n1) How can I retrieve all the products given a specific <code>website_id</code> - (Disregarding the sector)\n2) How can I retrieve all the products that have a specific <code>tag_id</code> + <code>website_id</code>. (Also retrieve it's corresponding <code>Attribute</code>)</p>\n\n<p>Help is appreciated. Thanks!</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":13006600,"title":"Group by two properties as one in Linq","body":"<p>I have the following class</p>\n\n<pre><code>public class Booking\n{\n    public string Group { get; set; }\n    public BookingType Type { get; set; }\n    public BookingStatus Status { get; set; }\n    public InvoiceFreq { get; set; }\n    public InvoiceLevel { get; set; }\n}\n</code></pre>\n\n<p>That I'd need to group them by all properties in Linq so that the last two properties form one new field in the grouped result. \nLike this:</p>\n\n<pre><code>        Group   Type    Status      InvoiceType          \n        -------------------------------------------\n        Group1  Online  New         Daily-Single\n        Group2  Phone   Accepted    Daily-Single\n        Group3  Store   Accepted    Weekly-Single\n        Group3  Store   Accepted    Weekly-Bulk\n</code></pre>\n\n<p>Here the InvoiceFreq will be Daily / Weekly and the InvoiceLevel = Single or Bulk.</p>\n\n<p>The query I have so far is this:</p>\n\n<pre><code>        var query = from b in Bookings\n                        group b by new\n                        {\n                            b.Group, \n                            b.Type, \n                            b.Status,\n                            b.InvoicingFrequency,\n                            b.InvoicingLevel\n                        } into bookingGroup\n                        select new BookingSummaryLine()\n                        {\n                            Group = bookingGroup.Key.UserGroup,\n                            Type = bookingGroup.Key.UserGroup,\n                            Status = bookingGroup.Key.FinancialStatus,\n                            InvType = String.Format({0}-{1},bookingGroup.Key.InvoicingFrequency, bookingGroup.Key.InvoicingLevel\n                        }; \n</code></pre>\n\n<p>This of course does not give the desired result as the two properties are in the anonymous type separately.</p>\n\n<p>Is there any way to achieve this in Linq?</p>\n"},{"tags":["c#","asp.net","sql","linq","entity-framework"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":66,"score":-4,"question_id":13006952,"title":"LINQ Query to retrieve items","body":"<p>So I am using EF, I have the following entities:</p>\n\n<ul>\n<li><code>Website</code></li>\n<li><code>Sector</code></li>\n<li><code>Product</code></li>\n<li><code>Attribute</code></li>\n<li><code>AttributeTag</code></li>\n</ul>\n\n<p>The relationships are as follow:</p>\n\n<p><img src=\"http://i.stack.imgur.com/wvyAs.png\" alt=\"enter image description here\"></p>\n\n<p>The questions are:</p>\n\n<ol>\n<li>How can I retrieve all the products given a specific <code>website_id</code> - (Disregarding the sector)</li>\n<li>How can I retrieve all the products that have a specific <code>tag_id</code> + <code>website_id</code>. (Also retrieve it's corresponding <code>Attribute</code>)</li>\n</ol>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13004506,"title":"What's wrong with such a Linq query","body":"<p>I have two tables:</p>\n\n<pre><code>Team: teamId, teamName\nPlayer: playerId, teamId, playerName\n</code></pre>\n\n<p>I want to get the teamName through playerName. I wrote two querys, one of them doesn't work.</p>\n\n<pre><code>var query = from t in dc.Teams \n            where t.teamId == ((from p in dc.Players \n                                where p.playerName == \"kobe\" \n                                select p.teamId).SingleOrDefault()) \n            select t.teamName;  //Doesn't work\n\nvar query = from t in dc.Teams \n            join p in dc.Players \n                on t.teamId equals p.teamId \n            where p.playerName == \"kobe\" \n            select t.teamName;  //Works\n</code></pre>\n\n<p>Anyone can tell me why the first query couldn't work?</p>\n"},{"tags":["c#","xml","linq","query"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13004201,"title":"LINQ XML Subquery - Need Assistance","body":"<p>My current LINQ query and example XML are below. What I'd like to do is select the primary image urls from the  as well as the other attributes such as trim, body, make, model, etc.</p>\n\n<p>What is the best way to do this?</p>\n\n<pre><code>&lt;response&gt;\n&lt;objects&gt;\n    &lt;object&gt;\n        &lt;trim&gt;LT&lt;/trim&gt;\n        &lt;body&gt;4dr Car&lt;/body&gt;\n        &lt;warranty_miles /&gt;\n        &lt;color&gt;WHITE&lt;/color&gt;\n        &lt;selling_price&gt;0.00&lt;/selling_price&gt;\n        &lt;vin&gt;1g1jc5sh3c4198042&lt;/vin&gt;\n        &lt;has_service_contract &gt;False&lt;/has_service_contract&gt;\n        &lt;year&gt;2012&lt;/year&gt;\n        &lt;alt_id&gt;&lt;/alt_id&gt;\n        &lt;stock_num&gt;1205362&lt;/stock_num&gt;\n        &lt;has_warranty&gt;False&lt;/has_warranty&gt;\n        &lt;warranty_month /&gt;\n        &lt;make&gt;CHEVROLET&lt;/make&gt;\n        &lt;date_manufactured /&gt;\n        &lt;interior_color&gt;Dark Pewter/Dark Titanium&lt;/interior_color&gt;\n        &lt;date_updated&gt;2012-10-17&lt;/date_updated&gt;\n        &lt;date_dealer_created&gt;2012-06-06&lt;/date_dealer_created&gt;\n        &lt;certification_warranty /&gt;\n        &lt;status/&gt;\n        &lt;vevo&gt;&lt;/vevo&gt;\n        &lt;image_urls&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/1764e186eabe4ae892f6230107b862cf.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/3eeb7050770849e8937191d09453d936.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/7f6c1f172f7b4944ac2d165c0dfbcb09.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/82d242ba07bb4bb9a7c8514ea1aadae7.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/93e3cac89d0f4872b86acd9c2d94695a.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/edec4ffe9b2349ffabea9dcb25a78d1e.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/f2c1dbb15fec4cf6a62b7842db22763a.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n            &lt;object&gt;\n                &lt;url&gt;http://content.homenetiol.com/1593/69025/640x480/fa7341e250654533a9de2a756d4274eb.jpg&lt;/url&gt;\n                &lt;resource_uri&gt;&lt;/resource_uri&gt;\n            &lt;/object&gt;\n          &lt;/image_urls&gt;\n       &lt;/object&gt;\n   &lt;/objects&gt;\n &lt;/response&gt;\n</code></pre>\n\n<p>Here is what I have so far</p>\n\n<pre><code>        var users = from m in main2.Elements(\"object\")\n                    select new Inventory \n                    {\n                        Make = (string)m.Element(\"make\"),\n                        Year = (string)m.Element(\"year\"),\n                        Model = (string)m.Element(\"model\"),\n                    };\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13004170,"title":"Linq ObservableCollection return no result","body":"<p>I am using linq to search product in ObservableCollection, but it does not return any result, for example I have a product name \"stack\", but when I search \"s\", it return no result:  </p>\n\n<pre><code>private ObservableCollection&lt;Product&gt; _ProductList = new ObservableCollection&lt;Product&gt;();\n\npublic ObservableCollection&lt;Product&gt; ProductList \n { get { return _ProductList; } set { _ProductList = value; } }\n</code></pre>\n\n<p>I have a textbox, when user type, linq will search product name in the ObservableCollection:</p>\n\n<pre><code>private void productSearch_KeyUp(object sender, KeyEventArgs e)\n{\n      // Search text\n      string productSearchText = productSearch.Text.Trim(); \n\n      // Search product, return no result\n      var search = ProductList.Where(s =&gt; s.Name.StartsWith(ProductSearchText));\n\n      search.ToList().ForEach(ProductList.Add);\n}\n</code></pre>\n\n<hr>\n\n<p>Edited:</p>\n\n<p>I notice it is because of letter case problem. I needs to be in uppercase, if the product name is in uppercase, how can I search regarding of letter case?</p>\n"},{"tags":["c#","wcf","linq","linq-to-sql"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12999338,"title":"\"Value Cannot Be Null\" when using LINQ to SQL to Group By and Sum results from a WCF Service request","body":"<p>I'm trying to use LINQ to SQL to sum a row in a a resultset returned from a WCF service. I'm able to use LINQ for basic selects, for order by, for filtering, etc.  So far so good.</p>\n\n<p>But when I try to Group By / Sum, I get an error message \"Value Cannot Be Null\" when trying to Take(5) from the query below.  (<code>results</code> is non-null and has 1000+s of items, but the <code>query</code> is null when we try to return it:) </p>\n\n<p><strong>EDIT:</strong> I've removed the invalid cast as mentioned in the answer below, instead selecting the aggregate results into a custom class written to order.  Now the page runs without error -- but the group by / sum doesn't work.... I just get the top five highest values in the results, not summed by group.    Why?</p>\n\n<pre><code>var query = (from h in results\n            group h by h.Order into hh                     \n            select new TopOrders()\n            {\n                Order = hh.Key,\n                Total= hh.Sum(r =&gt; r.Price)\n            }).OrderByDescending(i =&gt; i.Total);\n\nreturn query.Take(5).ToList();\n</code></pre>\n\n<p>Only possible wrinkle I can point to is that Order is itself a collection (OrderID, OrderName, etc.) and so I've tried grouping explicitly on hh.Key.Order.OrderID and so forth, to no effect.</p>\n\n<p>Anything I'm missing from what you can see?   Thanks.</p>\n"},{"tags":["c#","sql","linq","union","concat"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13003905,"title":"Trying to emulate a SQL IN statement on a series of SQL LIKE statements using LINQ","body":"<p>I'm trying to emulate a SQL IN statement on a series of SQL LIKE statements using LINQ (C#).\nI start off with a <code>IQueryable&lt;user&gt;</code> object named Query which has not yet been 'filtered'.\nI'm just starting to post onto Stack Overflow so please be patient with me :)... </p>\n\n<pre><code>ObjectQuery&lt;user&gt; Context = this.Context.users;\nIQueryable&lt;user&gt; Query = (IQueryable&lt;user&gt;)Context;\n// create a BLANK clone of the FULL list (Query)\nvar QueryFinal = Query.Where(i =&gt; i.ID == 0);\nforeach (String Item in userFilter.Name.Contains)\n{\n    // based on the FULL list (Query) return all records that apply to this item &amp; then append results to the final list\n    QueryFinal = QueryFinal.Concat(Query.Where(i =&gt; i.Name.Contains(Item)));\n}\nreturn QueryFinal.ToList();\n</code></pre>\n\n<p>I thought that on each iteration, the result set being returned on the Query.Where statement would be appended to the QueryFinal list, which it does, but for some reason, on each subsequent iteration, it appears to overwrite all the previous records which are supposed to be 'stored for safe-keeping' in the final list. I've have also tried using .Union but still not the results I was hoping for. All it seems to return is the last result set, not all of the appended result sets together. Anyone spot what I'm doing wrong?</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13003820,"title":"How to retrieve the value of an element within an element in XML","body":"<p>I have the following XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;Project&gt;\n&lt;Site Address=\"0\" Connect=\"COM1,9600\"&gt;\n&lt;/Site&gt;\n&lt;/Project&gt;\n</code></pre>\n\n<p>I am trying to get the value of 'Connect'</p>\n\n<p>I have this code:</p>\n\n<pre><code>var doc = XDocument.Load(xml);\nvar q = from x in doc.Root.Elements()\n        where x.Name.LocalName == \"Connect\"\n        select x;\nClientTB.Text = q.FirstOrDefault().ToString();\n</code></pre>\n\n<p>But when I run this I get the error Object reference not set to an instance of an object.</p>\n\n<p>If I change the where statement to:</p>\n\n<pre><code>        where x.Name.LocalName == \"Site\"\n</code></pre>\n\n<p>Then my text contains <code>&lt;Site Address=\"0\" Connect=\"COM1,9600\"&gt;&lt;/Site&gt;</code></p>\n\n<p>What do I need to do to get the value of Connect?</p>\n"},{"tags":["c#","winforms","linq","xtragrid","ultrawingrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13001041,"title":"How to Implement Parent-Child DataRelation on XtraGrid or UltraWinGrid with LINQ","body":"<p>I'm using LINQtoSQL to bring data for a <em>DevExpress XtraGrid</em> or a <em>Infragistics UltraWinGrid</em> and show a parent row with a [<strong>+</strong>] sign so that I could click and see the details (similar to a 2 level tree). I've been sucessful before using a DataRelation for my DataSource, an then binding it just did it automatically. How can I achieve this using LINQ querys?</p>\n\n<p>example i've used in VB.NET for DataTables in a ADO.NET DataSource:</p>\n\n<pre><code>Dim rel As DataRelation = New DataRelation(\"Allocation\", dsAllocation.Tables(\"tblParent\").Columns(\"AllocKey\"), dsAllocation.Tables(\"tblChild\").Columns(\"AllocKey\"), True)\n</code></pre>\n\n<p>This link is the best info I have reasearched, but looking for a more dynamic way of doing it.\n<a href=\"http://documentation.devexpress.com/#WindowsForms/CustomDocument5495\" rel=\"nofollow\">http://documentation.devexpress.com/#WindowsForms/CustomDocument5495</a></p>\n\n<p>Thank you.</p>\n"},{"tags":["c++","linq","unix"],"answer_count":11,"favorite_count":10,"up_vote_count":30,"down_vote_count":0,"view_count":7935,"score":30,"question_id":232222,"title":"Is there a LINQ library for C++?","body":"<p>Are there any Platform agnostic (not CLI) movements to get LINQ going for C++ in some fashion? </p>\n\n<p>I mean a great part of server frameworks around the world run on flavors of UNIX and having access to LINQ for C++ on UNIX would probably make lots of people happy!</p>\n"},{"tags":["c#","xml","linq","xdocument"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12999833,"title":"Get List of Styles","body":"<p>I'm trying to get a List of Styles in the following xml file using xdoc and LINQ.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;kml&gt;\n  &lt;Document&gt;\n    &lt;Style id=\"style62\"&gt;\n      &lt;IconStyle&gt;\n        &lt;Icon&gt;\n          &lt;href&gt;http://maps.gstatic.com/mapfiles/ms2/micons/yellow-dot.png&lt;/href&gt;\n        &lt;/Icon&gt;\n      &lt;/IconStyle&gt;\n    &lt;/Style&gt;\n  &lt;/Document&gt;\n&lt;/kml&gt;\n</code></pre>\n\n<p>I cannot get my syntax right in order to get the ID=\"style62\" AND also the value within href in the same LINQ select, can anyone help?</p>\n\n<pre><code>var styles = xdoc.Descendants(ns + \"Style\")\n                .Select(s =&gt; new\n                {\n                    //HELP!?!\n                    //E.G\n                    //\n                    //id = s.something  (style62)\n                    //href = s.something (url)\n                }).ToList();\n</code></pre>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":37,"score":-2,"question_id":13000095,"title":"orderby in linq only when column is not null using lambda","body":"<p>Please let me know how can I can use orderby in linq only when a particular column is not <code>null</code> using lambda expression:</p>\n\n<pre><code>var list=  // result returned from sql stored proc \n\nlist.orderby(s=&gt;s.empid!=null).select(p=&gt;p) //something like this \n</code></pre>\n\n<p>Is it possible to include a condition to perform orderby on the list?</p>\n"},{"tags":["linq","entity-framework","ef-code-first"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12999457,"title":"How can I retrieve a composite class in EF Code First, having specified a relation on multi tier app?","body":"<p>I have an interesting problem :\nI created a class called, let's say, \"Container\" wich has a member of type \"Contained\"\nIt would look like:</p>\n\n<p><code>public class Container\n    {\n       public Contained cnt{ get; set; }\n    }\n</code></p>\n\n<p>The model contains both tables, and my DB looks like:\nContainers(PK:id FK:Contained_ContainedId)\nContained(PK:ContainedId)</p>\n\n<p>EF Code first correcty maps this atribute as a foreign key in the Contined table.\nThe problem comes when I want to retrieve these objects using LINQ:</p>\n\n<p><code>Container Con=(from Object in PersistentManager.Containers.OfType&lt;Container&gt; select Object).SingleOrDefault();</code></p>\n\n<p>This way (or either casting an anonymous type), I get a Container. The problem is, the reference to the Contained object is allways null. I think this is made on purpose for the sake of performance, but, this time, I need it to recover the full object.\nIntellitrace shows it's not even joining tables, so i guess something else should be specified\nAny ideas?</p>\n\n<p>Allrigth, thanks to Basic, I have solved the issue using the include clause.\nI think there SHOULD be a way to use lazy loading on context closed environment (multi tier patterns allways recomend disposing these objects)</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12999878,"title":"linq union of two lists","body":"<p>I have an object model that contains a list of longs. I want to get the combined list of longs of two different instances. When I write this:</p>\n\n<pre><code>var MyCombinedList = TheObject1.ListOfLongs.Union(TheObject2.ListOfLongs);\n</code></pre>\n\n<p>I get an empty list. Note that sometimes <code>TheObject2</code> can have an empty list.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks.</p>\n"},{"tags":["linq","entity-framework"],"answer_count":1,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":6246,"score":12,"question_id":6919709,"title":"Only initializers, entity members, and entity navigation properties are supported","body":"<p>I'm getting this exception :</p>\n\n<p>The specified type member 'Paid' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported.</p>\n\n<pre><code>    public ActionResult Index()\n    {\n        var debts = storeDB.Orders\n            .Where(o =&gt; o.Paid == false)\n            .OrderByDescending(o =&gt; o.DateCreated);\n\n        return View(debts);\n    }\n</code></pre>\n\n<p>My Model class</p>\n\n<pre><code>public partial class Order\n{\n    public bool Paid {\n        get {\n            return TotalPaid &gt;= Total;\n        }\n    }\n\n    public decimal TotalPaid {\n        get {\n            return Payments.Sum(p =&gt; p.Amount);\n        }\n    }\n</code></pre>\n\n<p>Payments is a Related table containing the field amount, The query works if I remove the Where clause showing correct information about the payments, any clue what's wrong with the code?</p>\n\n<p><strong>Solved like the answer suggested with :</strong></p>\n\n<pre><code>    public ActionResult Index()\n    {\n        var debts = storeDB.Orders\n            .OrderByDescending(o =&gt; o.DateCreated)\n            .ToList()\n            .Where(o =&gt; o.Paid == false);\n\n        return View(debts);\n    }\n</code></pre>\n"},{"tags":["linq","entity-framework","entity-framework-4.1","entity-relationship"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12991571,"title":"Linq doubts with DB context","body":"<p>Hi I have a question that is braking my mind for some days.\nI have my SQL server Database and my C# application.\nIn the DB I have differemt tables, let me show you a simple ex\nTables:\nPerson\nRelationship\nCity</p>\n\n<p>Business Rules:\nThe person are from a City, so the person has IdCity\nA person has a relationship with other person, and about that relationship you need to save the starting date.</p>\n\n<p>In other projects I already did something like that, but in this proyect this is not working for me.</p>\n\n<p>When I retrieved with LinQ the information about the person, the city is not coming, and an error appears when I try \"person.city.description\", for ex.\nI try using Include(\"City\") in the linq query, but it didn't work. Besides that, I don't know how to manage the circular reference to the person to person relationship.</p>\n\n<p>One important thing, that I think that can be the problem, is that I rename all the tables from the DataModel, for example, the table in database is called Prd_City, so I change the Name and the Entity Set Name for City in c# project. So in the included I have to use the real table name, in other case the query fail, but if I use the real name nothing happens.</p>\n\n<pre><code>using (var context = new MyContext())\n{\n   List&lt;Person&gt; oPeople = (from p in context.Person.Include(\"Prd_City\")\n                           select p).ToList();\n   return oPeople ;\n}\n</code></pre>\n\n<p>Any help will be welcome.\nThanks!</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12999233,"title":"Query about Linq to Sql ordering","body":"<p>I am trying to figure out a better way of ordering the results of my sql query.</p>\n\n<p>So far I have</p>\n\n<pre><code>List&lt;ArticlePost&gt; articlePosts = new List&lt;ArticlePost&gt;();\n        IQueryable&lt;ArticlePost&gt; query = from ArticlePost in ArticlePostTable select ArticlePost;\n        foreach (ArticlePost ArticlePost in query)\n            articlePosts.Add(ArticlePost);\n        articlePosts = articlePosts.OrderByDescending(ArticlePost =&gt; ArticlePost.atclID).ToList();\n</code></pre>\n\n<p>Is this a good way of sorting my list using linq or is there any way i can improve on it?</p>\n"},{"tags":["sql","sql-server","linq","linq-to-entities"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":61,"score":0,"question_id":12978414,"title":"How to write to DB using Linq","body":"<p>I have a Database with a Table named <code>Fruits</code>. In the table I have 3 columns: <code>Name</code>, <code>Date</code>, <code>Remove</code>.</p>\n\n<p>Now i have inserted 3 rows, with a value like</p>\n\n<pre><code>Apple----20/10/12----N\nMango----21/12/12----Y\nBanana--- 15/07/12----N\nGrapes----18/12/12----Y\n</code></pre>\n\n<p>I want to delete the 2 rows which is marked as 'Y. </p>\n\n<p>This I want to achive using Linq in c# code. Initally I am establishing a connection to the DB using a connection string. I will get the device context DC, and with this I will copy all the rows.</p>\n\n<p>Now I will enumerate the rows marked as <code>N</code> and I will call remove.</p>\n\n<p>Once I do remov, I will do: <code>dc.deleteonSubmit&lt;tableName&gt;(var).</code></p>\n\n<p>After this, I should call <code>dc.submittsavechages();</code> or what to make DB look like:</p>\n\n<pre><code>Mango----21/12/12----Y\nGrapes----18/12/12----Y\n</code></pre>\n\n<p>If I query in sql query analyzer i should get above result. How to do this in LINQ?</p>\n"},{"tags":["vb.net","linq","datatable"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12997908,"title":"What is logically wrong about this VB.NET code","body":"<p>I have this simple VB.NET function:</p>\n\n<pre><code>Dim endval = Convert.ToInt16(googleXMLdocument...&lt;s:currentItemCount&gt;.Value) - 1\nFor counter = 0 To endval\n  Dim seller = googleXMLdocument...&lt;s:name&gt;(counter).Value\n  Dim containsValue = ToBeIgnored.AsEnumerable().Any(Function(r) r.Field(Of String)(\"Ignore\") = seller) \n  If containsValue Then\n    Continue For\n  End If\n  row = GoogleResults.NewRow()\n  GoogleResults.Rows.Add(row)\n  GoogleResults.Rows(counter)(\"Seller\") = seller 'sometimes this line throws an exception there is no row at position x\nNext\n</code></pre>\n\n<p>In the last line I sometimes get an exception <code>there is no row at position x</code>. What could cause this?</p>\n"},{"tags":["linq","openxml","openxml-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12992392,"title":"LINQ queries against Open XML","body":"<p>I have ID of WorksheetPart object obtained earlier from:</p>\n\n<pre><code>var id = document.WorkbookPart.GetIdOfPart(worksheetPart);\n</code></pre>\n\n<p>Now I'm trying to get object back by using LINQ. However, I'm unable to find ID property of the mentioned object:</p>\n\n<pre><code>var worksheetPart = document.WorkbookPart.WorksheetParts.Where(x =&gt; x.??? == id).First();\n</code></pre>\n\n<p>What property can I use instead of ??? placeholder?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12997525,"title":"LINQ Query or query to table in C# with grouping and totalling","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6970070/linq-lambda-group-by-with-sum\">LINQ Lambda Group By with Sum</a>  </p>\n</blockquote>\n\n\n\n<p>LINQ Query or query to table in C# required.</p>\n\n<p>i have a dynamically created DATA Table :</p>\n\n<pre><code>            COLUMN:  City    Deposittype  DepositAmount                  \n            ROWS :  city1     new          100\n                    city1     new          200\n                    city2     old          200\n                    city2     old          100\n                    city2     new          200\n                     city3    new          100\n</code></pre>\n\n<p>Want to Group by city, calc sum of depositamount for specified Deposittype.</p>\n\n<p>Example, for condition depositType= new</p>\n\n<p>i want a row like</p>\n\n<pre><code>           city1 city2 city3\n            300   200   100\n</code></pre>\n\n<p>I want sum of DepositAmounts Grouped by City with specific Deposit type. i.e Result row should have city1 city2 city3 as column names, under which sum of 'Depositamounts' for a specified loan type say Deposittype = new.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":12996972,"title":"sorting collection linq query by parameter","body":"<p>There is a List, SomeObject has property TargetObject. \nI need is to create a List where SomeObjects have following TargetObject.</p>\n\n<p>SO_1 (TO_1) | SO_2 (TO_2) | SO_3 (TO_3) | SO_4 (TO_1) | SO_5 (TO_1) | SO_6 (TO_1) | SO_7 (TO_1) | SO_8 (TO_2) | SO_9 (TO_2) | SO_10 (TO_4)</p>\n\n<p>must be turned into</p>\n\n<p>SO_1 (TO_1) | SO_2 (TO_2) | SO_3 (TO_3) | SO_10 (TO_4) | SO_4 (TO_1) | SO_8 (TO_2) | SO_6 (TO_1) | SO_9 (TO_2) | SO_7 (TO_1) | SO_5 (TO_1)</p>\n\n<p>At the end i want to run Parallel.ForEach(List) with MaxDegreeOfParallelism = 5, so each loop of 5 items will never have same TargetObject at the same time.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","sql","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12990960,"title":"Restoring virtual member in SqlQuery<>()","body":"<p>In order to enhance the request time of a page with a lot of data, I am trying to use Context.Database.SqlQuery method, instead of using LINQ</p>\n\n<pre><code>Context.Database.SqlQuery&lt;Inschrijving&gt;(\"select * from dbo.inschrijving join dbo.duif on dbo.duif.duifid = dbo.inschrijving.duifid  where vluchtid = {0} and duivenmelker_duivenmelkerid = {1}\",vluchtId, duivenmelker.DuivenmelkerId);\n</code></pre>\n\n<p>This works, but in my class i use virtual members. These are null with the sqlquery method.</p>\n\n<p>I have tried other types of joins, at the moment I am using a method to restore the virtual object with the id.</p>\n\n<p>snippet of the class with virtual object:</p>\n\n<pre><code>[Key,ForeignKey(\"Duif\"), Column(Order = 0)]\npublic int DuifId { get; set; }\npublic virtual Duif Duif { get; set; }\n</code></pre>\n\n<p>How could I restore the virtual members in the object (in a better way)?</p>\n\n<p>Is there a way to do this all at once in the sqlquery?</p>\n"},{"tags":["asp.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12947410,"title":"where clause in linq query","body":"<p>in the below code <code>transmittalno.TransID</code> always has value but <code>doctranstocon.Transid</code> sometimes has value and sometimes does not, so when <code>doctranstocon.Transid</code> has value I have no problem but when there is not any value, when compare in the where clause like :<code>transmittalno.TransID == doctranstocon.Transid</code>. \nIt returns error \" <strong>Object reference not set to an instance of an object.</strong>\" </p>\n\n<pre><code>TranstoCons = from doctranstocon in _DocTranstoCons where \n              ( transmittalno.TransID == doctranstocon.Transid  ) \n              select doctranstocon.tblTranstoCon\n</code></pre>\n\n<p>I like TranstoCons returns null when there is not any value for \" doctranstocon.Transid  \"</p>\n\n<p>How I can handle this error in the below linq query:</p>\n\n<pre><code>var query = from transmittalno in _Transmittals\n            Select new TransmittaltoConPresentationModel \n            { \n              TransID = transmittalno.TransID, \n              Transmittal = transmittalno.TRANSMITTAL, \n              TranstoCons = from doctranstocon in _DocTranstoCons where \n                            ( transmittalno.TransID == doctranstocon.Transid  ) \n                            select doctranstocon.tblTranstoCon \n             };\n</code></pre>\n"},{"tags":["c#","asp.net","linq","gridview","rowdatabound"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12658953,"title":"Hide GridView Column using linq","body":"<p>I am trying to hide my gridview columns on RowDataBound event. At the moment, I am doing :</p>\n\n<pre><code>e.Row.Cells[4].Visible = false;\n</code></pre>\n\n<p>The problem with this approach is that whenever I change the order of the column in grid veiw, I also have to change the index here. </p>\n\n<p>Also, there is another approach : </p>\n\n<pre><code>foreach (TableCell col in e.Row.Cells)\n        {\n            if (col.Text == \"Name\")\n            {\n                col.Visible = false;\n            }\n        }\n</code></pre>\n\n<p>I was told by someone that it is possible using the LINQ.</p>\n\n<p>Something like:</p>\n\n<pre><code>((TableCell)e.Row.Cells.Cast&lt;TableCell&gt;()\n             .Where(c =&gt; c.Text == \"name\")).Visible = false;\n</code></pre>\n\n<p>So far, I am unable to do so. Can someone tell me what I am doing wrong here?</p>\n"},{"tags":["c#",".net","linq","mono","iterator"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12926313,"title":"Why cannot use iterator block with IOrderedEnumerable","body":"<p>I wrote this:</p>\n\n<pre><code>using System;using System.Linq;\nstatic class MyExtensions\n{\n    public static IEnumerable&lt;T&gt; Inspect&lt;T&gt; (this IEnumerable&lt;T&gt; source)\n    {\n        Console.WriteLine (\"In Inspect\");\n        //return source;    //Works, but does nothing\n        foreach(T item in source){\n            Console.WriteLine(item);\n            yield return item;\n        }\n    }\n}\n</code></pre>\n\n<p>Then went to test it with this:</p>\n\n<pre><code>var collection = Enumerable.Range(-5, 11)\n    .Select(x =&gt; new { Original = x, Square = x * x })\n    .Inspect()\n    .OrderBy(x =&gt; x.Square)\n    //.Inspect()\n    .ThenBy(x =&gt; x.Original)\n    ;\nforeach (var element in collection)\n{\nConsole.WriteLine(element);\n}\n</code></pre>\n\n<p>The first use of <code>Inspect()</code> works fine. The second one, commented out, won't compile. The return of <code>OrderBy</code> is <code>IOrderedEnumerable</code>. I'd have thought <code>IOrderedEnumerable</code> <em>is-a</em> <code>IEnumerable</code> but, rolling with the punches, I tried:</p>\n\n<pre><code>public static IOrderedEnumerable&lt;T&gt; Inspect&lt;T&gt; (this IOrderedEnumerable&lt;T&gt; source)\n{\n    Console.WriteLine (\"In Inspect (ordered)\");\n    foreach(T item in source){\n        Console.WriteLine(item);\n        yield return item;\n    }\n}\n</code></pre>\n\n<p>But this won't compile either. I get told I cannot have an iterator block because System.Linq.IOrderedEnumberable is not an iterator interface type.</p>\n\n<p>What am I missing? I cannot see why people wouldn't want to iterate over an ordered collection the same way they do with the raw collection.</p>\n\n<p>(Using Mono 2.10.8.1, which is effectively C# 4.0, and MonoDevelop 2.8.6.3)</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>As joshgo kindly pointed out, I can take an input parameter of <code>IOrderedEnumerable</code>, it does indeed act <em>as-a</em> <code>IEnumerable</code>. But to iterate I must return <code>IEnumerable</code>, and my original error was caused by <code>ThenBy</code>, which insists on being given <code>IOrderedEnumerable</code>. Very reasonable too. But is there a way to satisfy <code>ThenBy</code> here?</p>\n\n<p><strong>UPDATE2:</strong></p>\n\n<p>After playing with the code in both answers (both of which were very helpful), I finally understood why I can't use yield with an IOrderedEnumerable return: there is no point, because the values have to be fully available in order to do the sort. So instead of a loop with yield in it, I may as well use a loop to print out all items, then just return source once at the end.</p>\n"},{"tags":["c#",".net","linq","nhibernate","linq-to-sql"],"answer_count":6,"favorite_count":7,"up_vote_count":12,"down_vote_count":1,"view_count":4178,"score":11,"question_id":53417,"title":"NHibernate or LINQ to SQL","body":"<p>If starting a new project what would you use for your ORM NHibernate or LINQ and why.  What are the pros and cons of each.</p>\n\n<p>edit: LINQ to SQL not just LINQ (thanks @Jon Limjap)</p>\n"},{"tags":["c#","vb.net","linq"],"answer_count":3,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":131,"score":9,"question_id":12988474,"title":"Why C# LINQ expressions must end with Select or Group By Clause where as no such restriction in VB.Net","body":"<p>As my title is self explanatory, I know how to rectify it but why is it so in the first place?</p>\n\n<p><strong>Scenario</strong></p>\n\n<p>I wrote a VB.Net Code</p>\n\n<pre><code>Dim list As List(Of String) = New List(Of String)\n\n//Code to populate list\n\nDim wherelinq As IEnumerable(Of String) = From s In list Where s.StartsWith(\"A\")\n</code></pre>\n\n<p>This works fine and gives no error</p>\n\n<p>but the same logic in C# fails</p>\n\n<pre><code>List&lt;string&gt; list = new List&lt;string&gt;();\n\n//Code to populate list\n\nIEnumerable&lt;string&gt; wherelinq = from s in list where s.StartsWith(\"A\");\n</code></pre>\n\n<p>This gives error </p>\n\n<p><img src=\"http://i.stack.imgur.com/UkRqD.jpg\" alt=\"enter image description here\"></p>\n\n<p>Why this restriction in C#? Anything specific that I am missing?</p>\n"},{"tags":["linq","c#-4.0","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":12992033,"title":"Cannot compile my project with LINQ syntax","body":"<p>I have been using Entity Framework and now wanted to query with LINQ code. I assumed that my code would just compile if i copied it almost verbatim from my reference book \"Entity Framework 4 In Action\".</p>\n\n<p>here is my code:</p>\n\n<pre><code>from a in db.addresses\nwhere a.accountId == 1\nSelect o;\n</code></pre>\n\n<p>unexpectedly, intellisense did not accept any of my code. So I did a little research and added projects references, web.config assembly reference and using reference to LINQ</p>\n\n<pre><code>using System.Data.Linq;\n</code></pre>\n\n<p>and have edited web.config to include </p>\n\n<pre><code>&lt;assemblies&gt;\n&lt;add assembly=\"System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"/&gt;\n</code></pre>\n\n<p>Even Still, Intellisense and the compiled do not accept the keyword \"in\" or db.addresses (db is the context and elsewhere in my file i have no problem making calls like:</p>\n\n<pre><code>users currentUser = db.users.Single(m =&gt; m.email == User.Identity.Name);\n</code></pre>\n\n<p>so the problem is NOT my db context either. I've searched stack, asp.net, and googled \"LINQ syntax not compiling\" but can't find any further clue.</p>\n\n<p>here are my compiler errors:</p>\n\n<blockquote>\n  <p>Error 14 ; expected  147 20 AdamsStore</p>\n  \n  <p>Error 15 ; expected  147 23 AdamsStore</p>\n  \n  <p>Error 16 ; expected  148 23 AdamsStore</p>\n  \n  <p>Error 17 ; expected  148 39 AdamsStore</p>\n  \n  <p>Error 13 Invalid expression term 'in'  147 20 AdamsStore</p>\n  \n  <p>Error 8 Only assignment, call, increment, decrement, and new object expressions can be used as a statement  147 18 AdamsStore</p>\n  \n  <p>Error 10 Only assignment, call, increment, decrement, and new object expressions can be used as a statement  148 23 AdamsStore</p>\n  \n  <p>Error 7 The type or namespace name 'from' could not be found (are you missing a using directive or an assembly reference?)  147 13 AdamsStore</p>\n  \n  <p>Error 11 The type or namespace name 'select' could not be found (are you missing a using directive or an assembly reference?)  149 21 AdamsStore</p>\n</blockquote>\n"},{"tags":["c#","asp.net","linq","c#-4.0","entity-framework-4"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":8268,"score":1,"question_id":5869033,"title":"How to bind gridview using linq/Entity Framework?","body":"<p>I need to bind <code>GridView</code>, I am using this code:</p>\n\n<pre><code>  ProductDBEntities db = new ProductPDBEntities();\n\n    var pro = from u in db.Products where u.PID == 1 select u;\n\n    if (pro != null)\n    {\n        GridView1.DataSource = pro;\n        GridView1.DataBind();\n    }\n</code></pre>\n\n<p>and getting this error. </p>\n\n<blockquote>\n  <p>System.InvalidOperationException:\n  Sequence contains more than one\n  element</p>\n</blockquote>\n\n<p>Can somebody please tell me what am I doin wrong?</p>\n"},{"tags":["c#","linq","entity-framework","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12990489,"title":".net linq entity framework groupby","body":"<p>I have a db table with columns like\nDaysInTrade, PercentGain</p>\n\n<p>i want a sum of PercentGain grouped by DaysInTrade</p>\n\n<p>so:</p>\n\n<pre><code>DaysInTrade,PercentGain\n1, 5\n1,6\n2,4\n</code></pre>\n\n<p>Would give me:</p>\n\n<pre><code>DaysInTrade, Sum\n1, 11\n2,4\n</code></pre>\n\n<p>I was not able to get intellisense working in the \"select new\" part unless I used something like Sum or Select.  the DIT column below shows up blank no matter if I do ts.DaysInTrade, or gts.DaysInTrade</p>\n\n<pre><code>        var partialQuery = (from ts in context.TradeSnapshots\n                            group ts by ts.DaysInTrade\n                            into gts\n                            select\n                            new\n                                {\n                                    profit = gts.Sum(s =&gt; s.PercentGain),\n                                    DIT = gts.Select(ts=&gt;ts.DaysInTrade)\n                                });\n        dataGridViewTradeSnapshots.DataSource = partialQuery.ToList(); \n</code></pre>\n"},{"tags":["vb.net","linq","select","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12989010,"title":"VB.NET Datatable.Select expression","body":"<p>is it possible to use filter expression to select some columns?\nsomething like <code>select a,b,c from table</code> in sql</p>\n\n<p>here is what i am trying to do</p>\n\n<pre><code> Dim rows() As DataRow = bookedorders.Select(\"a,b,c\")   'select columns a b c only, i know its wrong\n        Dim zzz As DataTable = rows.CopyToDataTable\n</code></pre>\n\n<p>so is it possible to use the Datatable.Select to select columns and the use a condition like sql <code>WHERE a=1</code></p>\n\n<p>my linq try was</p>\n\n<pre><code>Dim q = From r In bookedorders.AsEnumerable Select r.Field(Of Integer)(\"a\") And r.Field(Of String)(\"b\") And r.Field(Of String)(\"c\") And r.Field(Of Integer)(\"d\")\n        For Each m In q\n            zzz.Rows.Add(m)\n        Next\n</code></pre>\n\n<p>which doesnt seem to work, it says that the number of items in array is longer than the datatable!</p>\n"},{"tags":["c#","linq","list"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12988209,"title":"List.Except is not working","body":"<p>I try to subtract 2 lists like below code, <code>assignUsers</code> has got 3 records and <code>assignedUsers</code> has got 2 rows. After <code>Except</code> method I still get 3 rows, although I should get 1 record because 2 rows in <code>assignedUsers</code> is similar to <code>assignUsers</code> </p>\n\n<pre><code> var users = accountApp.GetUsersByAccountId(context.GetUserData().AccountId);\n List&lt;AssignUserViewModel&gt; assignUsers = Mapper.Map&lt;List&lt;AssignUserViewModel&gt;&gt;(users).ToList();\n var mailUsers = mailApp.GetMailAssignedByMailId(id).Select(m =&gt; new { m.UserId, m.User.Name }).ToList();\n List&lt;AssignUserViewModel&gt; assignedUsers = mailUsers.Select(Mapper.DynamicMap&lt;AssignUserViewModel&gt;).ToList();\n assignUsers = assignUsers.Except(assignedUsers).ToList();\n</code></pre>\n"},{"tags":["c#","linq","exception","networking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12987589,"title":"Odd System.Net.NetworkInformation.NetworkInformationException","body":"<p>The following expression is occasionally throwing the below exception:</p>\n\n<pre><code>NetworkInterface[] interfacesToUse = (from outer in NetworkInterface.GetAllNetworkInterfaces()\n                                                  select outer).ToArray();\n\nIPv4InterfaceStatistics[] stats = (from current in interfacesToUse select current.GetIPv4Statistics()).ToArray();\n</code></pre>\n\n<blockquote>\n  <p>Base Exception Type:\n  System.Net.NetworkInformation.NetworkInformationException\n  (0x80004005): The system cannot find the file specified    at\n  System.Net.NetworkInformation.SystemIPv4InterfaceStatistics.GetIfEntry(Int64\n  index)    at\n  System.Net.NetworkInformation.SystemNetworkInterface.GetIPv4Statistics()\n  at System.Linq.Enumerable.WhereSelectArrayIterator<code>2.MoveNext()    at\n  System.Linq.Buffer</code>1..ctor(IEnumerable<code>1 source)    at\n  System.Linq.Enumerable.ToArray[TSource](IEnumerable</code>1 source)</p>\n  \n  <p>Stack Trace:    at\n  System.Net.NetworkInformation.SystemIPv4InterfaceStatistics.GetIfEntry(Int64\n  index)    at\n  System.Net.NetworkInformation.SystemNetworkInterface.GetIPv4Statistics()\n  at System.Linq.Enumerable.WhereSelectArrayIterator<code>2.MoveNext()    at\n  System.Linq.Buffer</code>1..ctor(IEnumerable<code>1 source)    at\n  System.Linq.Enumerable.ToArray[TSource](IEnumerable</code>1 source)</p>\n</blockquote>\n\n<p>I have been unable to locate any documentation that may provide some insight into this error.</p>\n"},{"tags":["c#",".net","sql","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12987671,"title":"Textbox is disabled after adding text dynamically in codebehind","body":"<p>Can't quite work out what is happening but The background is that I am dynamically adding table rows in a web page and some of the cells hold controls such as dropdowns etc.  One of the columns pulls a size into it. </p>\n\n<p>However the column I am having issues with is the next column which takes the text from teh previous dropdown and shows the appropriate price. On doing htis however the textbox which is being created appears to turn into a label as I cannot select or adjust the text that has been put in there.</p>\n\n<pre><code> var gotPrice =(from a in getPrice.Sizes\n                     where a.Size1 == Size.SelectedValue\n                     select a).First();\n\n         TextBox Price = new TextBox();\n            Price.Width = 100;\n            PriceField.Controls.Add(Price);\n            PriceField.Text = gotPrice.RackRate.ToString();\n</code></pre>\n\n<p>I have tried then calling .Enabled but still the text box is not editable.</p>\n\n<p>any help appreciated.</p>\n"},{"tags":["linq","sql-server-2008","auto-increment"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12980555,"title":"Auto increment in SQL Server while using linq","body":"<p>I want to update three fields/columns in my database table. One of them is primary key  \"id\", I made it autoincrement using visual studio's set column properties:</p>\n\n<pre><code>Identity Specification: Yes\n(Is Identity)         : Yes\nIdentity Seed         :  1\nIdentity Increment    :  1\n</code></pre>\n\n<p>Everything going ok, but after checking for 2 times that every thing is going fine I emptied the contents of the table so that the columns can be newly populated. But first row autoincrement column got the value 3. I deleted the row and tried again but It became 4 after row was updated. I don't know what is happening. My linq code has nothing to do with it I suppose, because its just insertion.</p>\n\n<p>Code behind linq:</p>\n\n<pre><code>//DLCountryies - .dbml filename\n// tblcountry - tablename\n// CountryName and CountryCode are Column names\n//txtCountryName - textbox\n\nusing (DLCountryiesDataContext countries = new DLCountryiesDataContext()) \n{                                                                         \n            tblcountry country = new tblcountry\n            {\n                CountryName = txtCountryName.Text.Trim(),\n                CountryCode = txtCountryCode.Text.Trim()\n            };\n\n            countries.tblcountries.InsertOnSubmit(country);\n            countries.SubmitChanges();\n} \n</code></pre>\n"},{"tags":["c#","linq","refactoring"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":117,"score":1,"question_id":12244208,"title":"Spliting up long linq queries for improved maintainability","body":"<p>I have a bunch of these Tasks that are all based on LINQ queries. I am looking for good way to refactor them and make them easier to read and allow me to change the queries depending on language/region etc.</p>\n\n<pre><code>var mailTaskOne = CreateTask(() =&gt; myService.Mail.Where(p =&gt; p.ProjectName == \"Delta\"\n    &amp;&amp; (p.MailLang== (int)MailLanguage.EU || p.MailLang == (int)MailLanguage.RU)\n    &amp;&amp; (p.DateEntered &gt;= startDate &amp;&amp; p.DateEntered &lt;= endDate)\n    &amp;&amp; p.MailPriority == (int)MailPriority.High).Count());\n</code></pre>\n\n<p>One of the ways I thought would be convenient would be to split the query up into something like this.</p>\n\n<pre><code>var results = myService.Mail.Where(x =&gt; x.ProjectName == \"Delta\");\nresults = results.Where(p =&gt; p.MailLang== (int)MailLanguage.EU);\nresults = results.Where(p =&gt; p.DateModified &gt;= startDate &amp;&amp; p.DateModified &lt;= endDate);\n</code></pre>\n\n<p>This would allow me to do this without having to repeat the whole query for each region.</p>\n\n<pre><code>if (MailLanguage == \"English\")\n    results = results.Where(p =&gt; p.MailLang== (int)MailLanguage.EU);\nelse\n    results = results.Where(p =&gt; p.MailLang== (int)MailLanguage.RU);\n</code></pre>\n\n<p>Is there anyone that knows a better solution for this? I end up having huge functions as I need to do maybe 20 of these queries depending on the requirements; such as Region, Project name etc.</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Due to some limitations I did not know of with the back-end (web service/api) I could unfortunately not use some of the awesome answers mentioned in this question.</p>\n\n<p>For example this does not get translated properly, but in no ways because the answer incorrect, simply does not work with the API I am working against -- possibly because it is poorly implemented. </p>\n\n<pre><code>public bool IsValid(Type x)\n{\n    return (x.a == b) &amp;&amp; (x.c ==d) &amp;&amp; (x.d == e);\n}\n</code></pre>\n\n<p>Anyway, anyone looking for similar solutions all of these are valid answers, but in the end I ended up going with something similar to the solution snurre provided.</p>\n\n<hr>\n\n<p><strong>Edit2:</strong></p>\n\n<p>I think I managed to find a way to generate these LINQ queries dynamically - it looks promising at least.\n<a href=\"http://tomasp.net/articles/dynamic-linq-queries.aspx\" rel=\"nofollow\">http://tomasp.net/articles/dynamic-linq-queries.aspx</a></p>\n\n<hr>\n\n<p><strong>Edit3:</strong></p>\n\n<p>I updated my answer with the final solution I came up with for this.</p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":1,"up_vote_count":13,"down_vote_count":0,"view_count":646,"score":13,"question_id":6059643,"title":"Efficient Linq Enumerable's 'Count() == 1' test","body":"<p>Similar to this <a href=\"http://stackoverflow.com/questions/4958492/sql-making-count-1-efficient\">question</a> but rephrased for Linq:</p>\n\n<p>You can use <code>Enumerable&lt;T&gt;.Any()</code> to test if the enumerable contains data.  But what's the efficient way to test if the enumerable contains a single value (i.e. <code>Enumerable&lt;T&gt;.Count() == 1</code>) or greater than a single value (i.e. <code>Enumerable&lt;T&gt;.Count() &gt; 1</code>) without using an expensive count operation?</p>\n"},{"tags":["c#","linq","lambda","expression"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12986776,"title":"Change some value inside the List<T>","body":"<p>I have some list (where T is a custom class, and class has some properties).\nI would like to know how to change one or more values inide of it by using Lambda Expressions, so the result will be the same as the foreach loop bellow:</p>\n\n<p><em>NOTE: list contains multiple items inside (multiple rows)</em></p>\n\n<pre><code>        foreach (MyClass mc in list)  \n        {\n            if (mc.Name == \"height\")\n                mc.Value = 30;\n        }\n</code></pre>\n\n<p>And this the the linq query (using Lambda expressions), but its not the same as the upper foreach loop, it only returns 1 item (one row) from the list!</p>\n\n<p>What I want is, that it returns all the items (all rows) and ONLY chnages the appropriate one (the items specified in the WHERE extention method(s).</p>\n\n<pre><code>list = list.Where(w =&gt; w.Name == \"height\").Select(s =&gt; { s.Value = 30; return s; }).ToList();\n</code></pre>\n\n<p>NOTE: these 2 example are not the same! I repeat, the linq only returns 1 item (one row), and this is something I dont want, I need all items from the list as well (like foreach loop, it only do changes, but it does not remove any item).</p>\n"},{"tags":["c#","linq","recursion"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12986952,"title":"Linq Query / Child / Grandchild / GrandGrandChild Recursive Query","body":"<p>I have a database with 3 tables;</p>\n\n<p>Users, Groups &amp; Areas</p>\n\n<p>A User can only be in one Group. \nA Group has many Areas. \nA Group can be a child of another Group.</p>\n\n<p>I need a query that will get all Areas for a User, based on their Group and any child Groups of their Group!</p>\n\n<p>So, for example, a User is in Group 1.</p>\n\n<p>Group 1 has 2 Areas (Area 1, Area 2). Group 1 has a child (Group 2). Group 2 has 1 Area (Area 3). Group 3 (no link or child of Group 1) has 2 Areas (Area 4, Area 5)</p>\n\n<p>I need a linq query that will return Area 1,2,3 for this User (ignoring 4 and 5 as they have no right to see this).</p>\n\n<p>I have no control how deep this structure can go, an admin user can create a Group 4 as a child of Group 1 (or Group 2) for example, and I need to see all it's Areas as well....</p>\n\n<p>Can someone help me out with a query that will support an unknown level of groups!</p>\n"},{"tags":["linq","entity-framework-4","linq-to-entities","sql-server-2008-r2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12984235,"title":"Crazy data being returned by EF4 - wrong data & even wrong columns","body":"<p>I have a core set of code that I have been using for ages to create websites with and it uses EF4 and hooks through to SQL Server 2008 R2 ...   all has been working fine on mostly low level sites until yesterday when a site started to bomb all over the place.  When we traced the errors we found that data returned from Linq to entities was just bizarre ? </p>\n\n<p>We have seen,  different rows returning the same data,   repeated reports of wrong data types,  the Id column got returned instead of the value from the column we were querying.and when we check to see if a count tells us we have rows for a loop ...the count says 1 row found, then when we loop we get a null reference.</p>\n\n<p>Does Anybody know what's happening here ?   It's freaking me out.</p>\n"},{"tags":[".net","linq","data-binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12971506,"title":"VB.net databinding linq","body":"<p>can someone explain why databinding to textbox2 works but not for textbox1?</p>\n\n<p>Using a BindingSource as Datasource, but using the query directly does also not work.</p>\n\n<pre><code>Private Class DTO1\n        Public Property id As Integer        \n        Public Property value As Nullable(Of Integer)\n        Public Property value2 As String\n    End Class\n\n    Private Sub Button4_Click(sender As System.Object, e As System.EventArgs) Handles Button4.Click\n        Dim lst As New List(Of DTO1)\n        Dim a As New DTO1\n        a.id = 1\n        Dim o As Object = 1\n        a.value = o\n        lst.Add(a)\n\n        a = New DTO1\n        a.id = 2\n        a.value = Nothing\n        lst.Add(a)\n\n        bs.DataSource = (From p In lst Select p).ToList\n        grd.DataSource = bs\n        TextBox1.DataBindings.Add(\"text\", grd.DataSource, \"value\")\n        TextBox2.DataBindings.Add(\"text\", grd.DataSource, \"value2\")\n    End Sub\n</code></pre>\n\n<p>every time i move out from textbox1 the initial value is displayed againe.\n_tia\nrene</p>\n\n<p>edit: got this working. when using nullable values you have to pass in some more parameters ...</p>\n\n<pre><code>Me.DataBindings.Add(pr_PropertyName, pr_Datasource, pr_Datamember, True, DataSourceUpdateMode.OnValidation, Nothing)\n</code></pre>\n\n<p>did the trick</p>\n"},{"tags":["c#","linq","concatenation"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":12981986,"title":"Concatenating IEnumerable<KeyValuePair<string,string>> values into string using Linq","body":"<p>Given <code>IEnumerable&lt;KeyValuePair&lt;string,string&gt;&gt;</code>, I'm trying to use linq to concatenate the values into one string. </p>\n\n<p>My Attempt:</p>\n\n<pre><code>string path = attributes.Aggregate((current, next) =&gt; \"@\" + current.Key + \"=\" + current.Value + \" and @\" + next.Key + \"=\" + next.Value);\n</code></pre>\n\n<p>This produces the error:</p>\n\n<blockquote>\n  <p>Cannot convert expression type '<code>string</code>' to return type '<code>KeyValuePair&lt;string,string&gt;</code>'</p>\n</blockquote>\n\n<p>Is there a more effiecient way to do this in linq?</p>\n\n<p>The full method...</p>\n\n<pre><code>public IEnumerable&lt;XmlNode&gt; GetNodes(IEnumerable&lt;KeyValuePair&lt;string,string&gt;&gt; attributes) {\n    StateInfoXmlDocument stateInfoXmlDocument = new StateInfoXmlDocument();\n    string path = attributes.Aggregate((current, next) =&gt; \"@\" + current.Key + \"=\" + current.Value + \" and @\" + next.Key + \"=\" + next.Value);\n    string schoolTypeXmlPath = string.Format(SCHOOL_TYPE_XML_PATH, path);\n\n    return stateInfoXmlDocument.SelectNodes(schoolTypeXmlPath).Cast&lt;XmlNode&gt;().Distinct();\n}\n</code></pre>\n"},{"tags":["wpf","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12979344,"title":"Retrieving entity records before savingchanges","body":"<p>I just have not been able to find an answer to this anywhere and I'm hoping someone can help me.  I'm a newbie on WPF and Entity Framework, so probably doing this all wrong.</p>\n\n<p>I've got a situation where I'm creating new records and adding them to an Entity collection.  I do not want to perform a SaveChanges() on it yet to allow the user to finish everything they want to do and then do a final Save before leaving the form.  My problem is that after the records have been added to the Entity collection, I can not retrieve them back out for display 'until' they have had the SaveChanges() ran on the entity.</p>\n\n<p>This is basically a Master-Child display using two DataGrids but the Master grid source is a List&lt;> being built since one of the fields in the table needs to be converted to a more user friendly display.  And this is all coming from one table where I'm just grouping the data based on 3 of the fields (as the Master) and then displaying the child grid as the details of that grouping.</p>\n\n<p>This action is a 'Copy' action where I'm taking an existing DataGrid display of data and letting the user copy the data to a 'new' master group.  I'm using the following to create this new group of records.</p>\n\n<pre><code>            RateGroupRow rgr = new RateGroupRow();\n            rgr.StaffRole = rg.SelectedStaffRole;\n            rgr.Department = rg.SelectedDepartment;\n            rgr.PlanYear = rg.SelectedPlanYear;\n            _rateGroupQuery.Add(rgr);\n\n            foreach (var item in dgRateValues.Items)\n            {\n                if (item.GetType() == typeof(CommissionRate))\n                {\n                    CommissionRate cr = (CommissionRate)item;\n                    CommissionRate newcr = new CommissionRate();\n                    newcr.StaffRole = Common.StaffTextToStaffType(rgr.StaffRole);\n                    newcr.Department = rgr.Department;\n                    newcr.PlanYear = rgr.PlanYear;\n                    newcr.Low = cr.Low;\n                    newcr.High = cr.High;\n                    newcr.Rate = cr.Rate;\n                    Common.CommissionsEntities.CommissionRates.AddObject(newcr);\n                }\n            }\n            //TODO:  Don't want to do this SaveChanges here but for now that's the only way I can get these new records to be displayed in the data selection.\n            //Common.CommissionsEntities.SaveChanges();\n\n            dgRateGroups.ItemsSource = null;\n            dgRateGroups.ItemsSource = _rateGroupQuery;\n            dgRateGroups.SelectedIndex = dgRateGroups.Items.Count - 2;\n</code></pre>\n\n<p>After the Master record has been added to the _rateGroupQuery, the DataGrid (dgRateGroups) selects that row in which the SelectionChanged queries for the data to populate the details DataGrid as:</p>\n\n<pre><code>    dgRateValues.ItemsSource = null;\n    _CurrentSelectedStaffRole = rateGroupRow.StaffRole;\n    _CurrentSelectedDepartment = rateGroupRow.Department;\n    _CurrentSelectedPlanYear = rateGroupRow.PlanYear;\n    string StaffNameType = Common.StaffTextToStaffType(_CurrentSelectedStaffRole);\n\n    var CommissionRatesItems =\n        from cr in Common.CommissionsEntities.CommissionRates\n        where cr.StaffRole == StaffNameType &amp;&amp;\n              cr.Department == _CurrentSelectedDepartment &amp;&amp;\n              cr.PlanYear == _CurrentSelectedPlanYear\n        orderby cr.Low\n        select cr;\n    ObjectQuery&lt;CommissionRate&gt; CommissionRatesQuery = CommissionRatesItems as ObjectQuery&lt;CommissionRate&gt;;\n    dgRateValues.ItemsSource = CommissionRatesQuery.Execute(MergeOption.AppendOnly);\n</code></pre>\n\n<p>I get no records back from this select.  If I do the 'SaveChanges()' call after adding the records, then everything works fine.</p>\n\n<p>So is there a way to retrieve these newly added records prior to them being committed (SaveChanges) back to the database?</p>\n\n<p>Thank you,\nMike</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12983018,"title":"How do you set a type to an IEnumerable<> if the results will have many types?","body":"<p>Question I'm trying something new here with a program I made earlier. In the first program I was able to drag and drop table adapters and use the generic \"var\" to store query results. Now I'm trying to create a new program that has some separation of code. For example in the first program I had all of the code written in the form.cs file, this time I'd like to create a class to run the queries and return them to the calling class, however, how do you store a query result that contains many types? You cant return a var variable, it must be more specific. I get an error on the select line that reads: \"Cannot implicitly convert type'System.Collections.Generic.IEnumerable' to 'System.Collections.Generic.IEnumerable;. An explicit conversion exists(are you missing a cast?)</p>\n\n<p>Can some one help me? What is the cast? The first method (public IEnumerable getList()) works as expected its the second method, (public IEnumerable getRecipeInfo(string recipeName)) where I get the error. Here's my code so far.</p>\n\n<pre><code>namespace recipeDataBase\n{\n    class Query\n    {\n        recipiesNewDataSet recipeDataSet = new recipiesNewDataSet();\n        recipiesNewDataSetTableAdapters.RecipeTableAdapter recipeTableAdapter = new recipiesNewDataSetTableAdapters.RecipeTableAdapter();\n        recipiesNewDataSetTableAdapters.RecipeIngredientTableAdapter ingredientTableAdapter = new recipiesNewDataSetTableAdapters.RecipeIngredientTableAdapter();\n        recipiesNewDataSetTableAdapters.RatingTableAdapter ratingTableAdapter = new recipiesNewDataSetTableAdapters.RatingTableAdapter();\n\n        public  Query()\n        {\n\n        }\n\n        public IEnumerable&lt;string&gt; getList()\n        {\n            recipeTableAdapter.Fill(recipeDataSet.Recipe);\n\n            IEnumerable&lt;string&gt; recipeList = (from a in recipeDataSet.Recipe\n                                              select a.RecipeName);\n            return recipeList;\n        }\n\n        public IEnumerable&lt;string&gt; getRecipeInfo(string recipeName)\n        {\n            recipeTableAdapter.Fill(recipeDataSet.Recipe);\n            ratingTableAdapter.Fill(recipeDataSet.Rating);\n            ingredientTableAdapter.Fill(recipeDataSet.RecipeIngredient);\n            IEnumerable&lt;string&gt; recipeInfo = (from a in recipeDataSet.Recipe\n                                              from b in recipeDataSet.Rating\n                                              from c in recipeDataSet.RecipeIngredient\n                                              where a.RecipeName == recipeName &amp;&amp;\n                                              a.RecipeNum == c.RecipeNum &amp;&amp;\n                                              a.RatingNum == b.RatingNum\n                                              select new { a.RecipeName, a.Nationality, a.Event, a.Source, b.FamilyRating, c.Ingredient });\n            return recipeInfo;\n        }\n\n    }\n}\n</code></pre>\n\n<p>Thanks in advance for any help!!</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":90,"score":0,"question_id":12982588,"title":"How can I use LINQ and C# to find the oldest date from 3 different files?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5200877/how-to-select-min-and-max-date-values-in-linq-query\">How to Select Min and Max date values in Linq Query</a>  </p>\n</blockquote>\n\n\n\n<p>I'll start by saying my experience with LINQ is very limited. I have been using nested if statements to find the oldest file of 3, and it works just fine. But I'm trying to expand my use of newer technology. A lot of what I read about LINQ gets way over my head pretty fast. Especially when they start using lambda's. So I can get the 3 files dates but how can I grab the oldest among them using LINQ? Or is it even possible? I have the psudo code below. </p>\n\n<pre><code>        DateTime file1 = File.GetLastWriteTime(@\"c:\\test1.txt\");\n        DateTime file2 = File.GetLastWriteTime(@\"c:\\test2.txt\");\n        DateTime file3 = File.GetLastWriteTime(@\"c:\\test3.txt\");\n\n        DateTime[] dates = { file1, file2, file3 };\n\n        var date = from d in dates\n                   where d is oldest date\n                   select d;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","asp.net","linq","sorting","gridview"],"answer_count":4,"favorite_count":0,"up_vote_count":16,"down_vote_count":0,"view_count":17612,"score":16,"question_id":1661292,"title":"The data source does not support server-side data paging","body":"<p>I have a GridView on my screen and need it to allow paging.</p>\n\n<p>Markup:</p>\n\n<pre><code>&lt;asp:GridView ID=\"GridView1\" runat=\"server\" AllowPaging=\"True\" \n  AutoGenerateColumns=\"False\" DataSourceID=\"ObjectDataSource1\"&gt;\n  &lt;Columns&gt;\n    &lt;asp:BoundField DataField=\"appID\" HeaderText=\"appID\" SortExpression=\"appID\" /&gt;\n  &lt;/Columns&gt;\n&lt;/asp:GridView&gt;\n\n&lt;asp:ObjectDataSource ID=\"ObjectDataSource1\" runat=\"server\" \n  SelectMethod=\"GetBookingId\" \n  TypeName=\"AppointmentRepository\"&gt;\n  &lt;SelectParameters&gt;\n    &lt;asp:Parameter Name=\"maximumRows\" Type=\"Int32\" /&gt;\n    &lt;asp:Parameter Name=\"startRowIndex\" Type=\"Int32\" /&gt;\n  &lt;/SelectParameters&gt;\n&lt;/asp:ObjectDataSource&gt;\n</code></pre>\n\n<p>Code-behind:</p>\n\n<pre><code>ObjectDataSource1.SelectParameters[\"maximumRows\"].DefaultValue = \"10\";\nObjectDataSource1.SelectParameters[\"startRowIndex\"].DefaultValue = \"0\";\n</code></pre>\n\n<p>LINQ query:</p>\n\n<pre><code>public IQueryable&lt;tblAppointment&gt; GetBookingId(int maximumRows, int startRowIndex)\n{\n    var result = (from a in dc.tblAppointments\n                  select a).Skip(startRowIndex).Take(maximumRows);\n}\n</code></pre>\n\n<p>However I receive this error: The data source does not support server-side data paging. </p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks in advanced for any help.</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3","linq","entity"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12981979,"title":"Creating HiddenFor IEnumerable<String> in View","body":"<p>I have a Property that is an IEnumerable</p>\n\n<pre><code>public IEnumerable&lt;string&gt; ChangesOthersResult { get; set; }\n</code></pre>\n\n<p>I need to collect all values from ChangesOthersResult and post from a view back to the controller.  How can I loop through the Ienumerable and create hidden fields that will bind back to the ViewModel in the controller?</p>\n\n<pre><code>foreach(var item in Model.ChangesOthersResult)\n   {\n       @Html.HiddenFor(x =&gt; x.ChangesOthersResult);\n   }\n</code></pre>\n\n<p>Is giving me the Raw SQL statement as text.  </p>\n"},{"tags":["vb.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":12981843,"title":"Inline LINQ Comments in VB.NET","body":"<p>Is there some way to insert inline code comments in LINQ in VB.NET?</p>\n\n<p>Please see line 2 in the below as an example of where an inline comment would be desirable</p>\n\n<pre><code>Dim Jobs = (From X In DB.Jobs_Select(SearchStr, RequiresFilter)\n    Where X.JobStatusID &lt; 2   -- **** INSERT INLINE COMMENT HERE  ****\n    Order By\n        X.JobPriorityID Descending,\n        If(X.TargetDate, Date.MaxValue),\n        X.NeedsLit Descending,\n        X.HasOldArtRequests Descending,\n        X.HasOldLicRequests Descending\n    )\n</code></pre>\n\n<p>This is trivial in SQL code and frankly, very useful as SP's become complex. It would be nice to be able to perform the same cross-developer communication in LINQ to SQL. </p>\n\n<h1>Update</h1>\n\n<p>Here is a test condition for you.</p>\n\n<pre><code> Dim L As New List(Of KeyValuePair(Of Integer, Integer))\n\n Dim a = (From X In L\n            Where X.Key &gt; 5 'test comment\n            Order By X.Value)\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":112,"score":6,"question_id":12980121,"title":"Casting String as DateTime in LINQ","body":"<p>I have a table with a following format.</p>\n\n<pre><code>PID     ID       Label        Value\n------------------------------------------\n1       1        First Name    Jenna\n1       2        DOB           10/12/1980\n</code></pre>\n\n<p>I need to retrieve all PIDs where First name starting with J and Month of DOB is 10.</p>\n\n<p>in my code, I retrieve these in DataTable in C# and then tried to use LINQ to retrieve the results I want. This is just an example. These Labels could be anything user defines. </p>\n\n<p>using LINQ I am able to retrieve all PIDs where First Name start with J, but every time I tried to Cast Value for DOB I get cast not valid error. I cannot change the column type in the database since Value could contain any type of information.</p>\n\n<p>Here's a piece of my code.  I am new to LINQ, and still trying to figure out around it.</p>\n\n<pre><code>var resultQuery = from r in query.AsEnumerable()\nwhere (r.Field&lt;string&gt;(\"Label\") == Label  &amp;&amp;\nr.Field&lt;DateTime&gt;(\"Value\").Month == 10)\nselect r.Field&lt;int&gt;(\"PID\");\n</code></pre>\n"},{"tags":["mysql","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":12690775,"title":"Why EF generating a sub-query for a simle query?","body":"<p>There is a simple Linq to EF:</p>\n\n<pre><code>var query = from p in _db.Posts\n            where p.BlogtId == blogId\n            select p;\n</code></pre>\n\n<p>It generates SQL in this form:</p>\n\n<pre><code>SELECT\n`Extent1`.`PostId`, \n`Extent1`.`BlogId`, \n...\nFROM `Posts` AS `Extent1`\n WHERE `Extent1`.`BlogId` = @p__linq__0\n</code></pre>\n\n<p>But when I add a order by to this query </p>\n\n<pre><code>var query = from p in _db.Posts\n            where p.BlogId == blogId\n            orderby p.PublishDate\n            select p;\n</code></pre>\n\n<p>It generates this query </p>\n\n<pre><code>SELECT\n`Project1`.`PostId`, \n`Project1`.`BlogId`, \n...\nFROM (SELECT\n`Extent1`.`PostId`, \n`Extent1`.`BlogId`, \n...\nFROM `Posts` AS `Extent1`\n WHERE `Extent1`.`BlogId` = @p__linq__0) AS `Project1`\n ORDER BY \n`Project1`.`PublishDate` ASC\n</code></pre>\n\n<p>Why this generate a sub-query?There is a performance problem for this query in MySQL. MySQL is trying to execute the inner query which pulls back all the records in the database and then tries to sort theme.</p>\n\n<p>I need a solution to generate below sql by linq</p>\n\n<pre><code>SELECT\n`Extent1`.`PostId`, \n...\nFROM `Posts` AS `Extent1`\n WHERE `Extent1`.`BlogId` = @p__linq__0\n ORDER BY \n`Extent1`.`PublishDate` ASC\n</code></pre>\n"},{"tags":["sql","linq"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":1,"view_count":110,"score":3,"question_id":12891262,"title":"Case Query in LINQ equivalent to sql query","body":"<p>I have a dataset that contains caller, callee fiels and i need some LINQ query to operate on this dataset equivalent to this sql query</p>\n\n<pre><code>SELECT CASE\n     WHEN caller &lt; callee THEN callee\n     ELSE caller\n   END      AS caller1,\n   CASE\n     WHEN caller &lt; callee THEN caller\n     ELSE callee\n   END      AS caller2,\n   Count(*) AS [Count]\n    FROM   YourTable\n   GROUP  BY CASE\n        WHEN caller &lt; callee THEN callee\n        ELSE caller\n      END,\n      CASE\n        WHEN caller &lt; callee THEN caller\n        ELSE callee\n      END \n</code></pre>\n"},{"tags":["c#","asp.net",".net","sql","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12970281,"title":"Retrieving indexed Ids from an indexed column in database is slow","body":"<p>I have to select all the rows from a database table containing a defined (long)sessionId where the sessionId row is indexed. But it is slow, and since the code to access it is really simple, I'm wondering where the problem is. Here is the code of the three layers:</p>\n\n<pre><code>var localPath = BusinessClient.Instance.Tracker.GetSpecifiedMilestonesInSessionObjects(milestonesInSession.SessionId).ToList();\n</code></pre>\n\n<hr>\n\n<pre><code>public IQueryable&lt;MilestonesInSession&gt; GetSpecifiedMilestonesInSessionObjects(long sessionId)\n{\n    var query = from m in _milestonesInSessionRepository.GetAll()\n                where m.SessionId == sessionId\n                select m;\n\n    return query;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>public IQueryable&lt;Model.Tracker.MilestonesInSession&gt; GetAll()\n{\n    var query = from milestoneSession in _dataContext.Repository&lt;Linq.TrackerMilestonesInSession&gt;()\n                select new Model.Tracker.MilestonesInSession\n                           {\n                               MilestoneId = milestoneSession.MilestoneId,\n                               CreatedDate = milestoneSession.CreatedDate,\n                               SessionId = milestoneSession.SessionId,\n                               ProductId = milestoneSession.ProductId,\n                               TrackerId = milestoneSession.TrackerId,\n                               StatusId = milestoneSession.StatusId,\n                               BankId = milestoneSession.BankId\n                           };\n    return query;\n}\n</code></pre>\n\n<p>Here attached the screenshot of the performance using ANTS:</p>\n\n<p>Presentation Layer \n<img src=\"http://i.stack.imgur.com/iB6a8.png\" alt=\"enter image description here\"></p>\n\n<p>Business Layer\n<img src=\"http://i.stack.imgur.com/CQ1Jz.png\" alt=\"enter image description here\"></p>\n\n<p>Data Access Layer\n<img src=\"http://i.stack.imgur.com/MgsQG.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","linq","linq-to-sql"],"answer_count":3,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":95,"score":5,"question_id":12976118,"title":"Performing a Parent then Child sort in Linq","body":"<p>The intention is to sort the list by the parent, and then the child (there will only be one child).</p>\n\n<pre><code>Example Set:\nID  ParentId Type   Unit\n1   NULL    Energy  kJ\n2   1       Cal\n3   NULL    Protein g\n4   NULL    Fat, total  g\n5   4       Saturated   g\n6   NULL    Carbohydrate    g\n7   6       Sugars  g\n8   NULL    Dietary fibre   g\n10  NULL    Sodium  mg\n11  NULL    Potassium   mg\n</code></pre>\n\n<p>So for example, if I sort by Type (alphabetical order) it would come up </p>\n\n<ol>\n<li>Carbohydrate</li>\n<li>Sugars (parent = 1.)</li>\n<li>Dietary fibre</li>\n<li>Energy</li>\n<li>Cal (parent = 4.)</li>\n<li>Fat, total</li>\n<li>Saturated (parent = 6.)</li>\n</ol>\n"},{"tags":["c#","linq","entity-framework","reflection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":12958278,"title":"How do I find out if an enum value is used at Runtime?","body":"<p>We are using a quasi dynamic method to create enums from sql lookup tables using t4 templates.  The template generates an enum for every table that conforms to the lookup patter.  Several of these enums are not being used in code, but any could be.</p>\n\n<p>This has been fine and dandy, but now we have been asked to create a lookup management interface so that users can add new values, edit descriptions, etc.</p>\n\n<p>They don't want to modify any items that are currently being used in code as an enum value, so is there a simple (or not so simple) way to query our assemblies to find out if an enum value is used?</p>\n\n<p>We have a lot of code similar to this made-up example:</p>\n\n<pre><code>public Role GetAdminRole\n{\n  using (myContext ctx = new myContext()\n  {\n    return ctx.Roles.Where(i=&gt; i.RoleId == (int)RoleEnum.Admin).SingleOrDefault();;\n  }\n}\n</code></pre>\n\n<p>Is there a way to use the Type.FindMembers() and build a filter that can query the internals of a method?</p>\n\n<p>I've looked at the <code>System.Reflection.Emit</code> namespace, which seemed promising based on the EnumBuilder class, but couldn't figure out how to hook up a builder to an existing assembly.  The <code>System.Diagnostics.CodeAnalysis</code> namespace sounds interesting, but it only contains two attributes (for suppressing warnings and excluding code from coverage).</p>\n\n<p>EDIT:  While poking through ILSpy I discovered that I knew, but didn't put together, that enum values in methods get converted to their integer value when used in the above manner when compiled.</p>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":12977375,"title":"No Join in Linq","body":"<p>I have two tables that I have joined in a query like this</p>\n\n<pre><code>IQueryable&lt;Auction&gt; closed =\n                (from a in CurrentDataSource.Auctions\n                 join p in CurrentDataSource.Payments\n                     on a.Id equals p.AuctionId\n                 where &lt;some condition&gt;\n                 select a);\n</code></pre>\n\n<p>What I want really is to say give me all auctions where there <strong>IS NO</strong> join with the Payments table or some condition is true.  I can do this with T-SQL but not sure how to do it with Linq.  Can you help?</p>\n"},{"tags":["linq","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12933947,"title":"left join without explicit relationship in nhibernate 3.3.1.4000","body":"<p>I have these two simplified entities:</p>\n\n<pre><code>public class Measurement : Entity\n{\n    public virtual float DisplayValue { get; set; }\n    private DateTime _timeStamp;\n    public virtual DateTime TimeStamp\n    {\n        get { return _timeStamp; }\n        set { _timeStamp = value.ToUniversalTime(); }\n    }\n}\n\npublic class TimeStamp : Entity\n{\n    public virtual DateTime TimeStampEntry { get; set; }\n}\n</code></pre>\n\n<p>And I am using this (my)sql code to determine missing values over a range:</p>\n\n<pre><code>SET time_zone='+0:00';  \nselect \n    a.TimeStampEntry,\n    b.DisplayValue\nfrom timestamps as a \nleft outer join  \n(\n    select\n        TimeStamp,\n        DisplayValue\n    from measurements \n) as b on a.TimeStampEntry = b.TimeStamp\nwhere a.TimeStampEntry&gt;='2010-01-01 00:00:00' and a.TimeStampEntry&lt;'2010-01-31 23:59:59' and b.DisplayValue is null\norder by a.TimeStampEntry asc\n</code></pre>\n\n<p>I am just wondering how I could achieve this in Nhibernate 3.x, preferably in Linq.</p>\n\n<p>BTW, I have not tried anything serious as the relationship between the datetime fields is not defined in fluent nhibernate. Not sure whether I have to define this to be able to use ICriteria, Linq, HQL or whatever. Any feedback would be very much appreciated. Thanks.</p>\n\n<p>PS: </p>\n\n<p>I have made a start with this (not working code):</p>\n\n<pre><code>var x = (from ts in NHibernateSession.Current.Query&lt;TimeStamp&gt;()\n                         join m in NHibernateSession.Current.Query&lt;Measurement&gt;()\n                         on ts.TimeStampEntry equals m.TimeStamp into ps\n                         from m in ps.DefaultIfEmpty()\n                         select new { m.TimeStamp }).ToList();\n</code></pre>\n\n<p>PPS:</p>\n\n<p>stacktrace:</p>\n\n<pre><code>at NHibernate.Linq.Visitors.QueryModelVisitor.VisitGroupJoinClause(GroupJoinClause groupJoinClause, QueryModel queryModel, Int32 index)\n   at Remotion.Linq.Clauses.GroupJoinClause.Accept(IQueryModelVisitor visitor, QueryModel queryModel, Int32 index)\n   at Remotion.Linq.QueryModelVisitorBase.VisitBodyClauses(ObservableCollection`1 bodyClauses, QueryModel queryModel)\n   at Remotion.Linq.QueryModelVisitorBase.VisitQueryModel(QueryModel queryModel)\n   at NHibernate.Linq.Visitors.QueryModelVisitor.Visit()\n   at NHibernate.Linq.Visitors.QueryModelVisitor.GenerateHqlQuery(QueryModel queryModel, VisitorParameters parameters, Boolean root)\n   at NHibernate.Linq.NhLinqExpression.Translate(ISessionFactoryImplementor sessionFactory)\n   at NHibernate.Hql.Ast.ANTLR.ASTQueryTranslatorFactory.CreateQueryTranslators(String queryIdentifier, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 filters, ISessionFactoryImplementor factory)\n   at NHibernate.Engine.Query.HQLExpressionQueryPlan.CreateTranslators(String expressionStr, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 enabledFilters, ISessionFactoryImplementor factory)\n   at NHibernate.Engine.Query.HQLExpressionQueryPlan..ctor(String expressionStr, IQueryExpression queryExpression, String collectionRole, Boolean shallow, IDictionary`2 enabledFilters, ISessionFactoryImplementor factory)\n   at NHibernate.Engine.Query.HQLExpressionQueryPlan..ctor(String expressionStr, IQueryExpression queryExpression, Boolean shallow, IDictionary`2 enabledFilters, ISessionFactoryImplementor factory)\n   at NHibernate.Engine.Query.QueryPlanCache.GetHQLQueryPlan(IQueryExpression queryExpression, Boolean shallow, IDictionary`2 enabledFilters)\n   at NHibernate.Impl.AbstractSessionImpl.GetHQLQueryPlan(IQueryExpression queryExpression, Boolean shallow)\n   at NHibernate.Impl.AbstractSessionImpl.CreateQuery(IQueryExpression queryExpression)\n   at NHibernate.Linq.DefaultQueryProvider.PrepareQuery(Expression expression, IQuery&amp; query, NhLinqExpression&amp; nhQuery)\n   at NHibernate.Linq.DefaultQueryProvider.Execute(Expression expression)\n   at NHibernate.Linq.DefaultQueryProvider.Execute[TResult](Expression expression)\n   at Remotion.Linq.QueryableBase`1.GetEnumerator()\n   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)\n   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)\n</code></pre>\n"},{"tags":["asp.net-mvc-3","linq","linq-to-entities","entity-framework-4.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12952590,"title":"Linq To Entities Exclude Related Data","body":"<p>I am building an ASP.Net MVC 3 Web application which uses Entity Framework 4.1. I also use the Unit of Work pattern with a Generic Repository. I have two Entities in my Model, <strong>Shift</strong> and <strong>ShiftDate</strong>. Please see the diagram below for their structure. The idea is, a <strong>Shift</strong> can have 1 or many <strong>ShiftDates</strong>, and a <strong>ShiftDate</strong> can belong to only one <strong>Shift</strong>.</p>\n\n<p><img src=\"http://i.stack.imgur.com/GwYce.png\" alt=\"enter image description here\"></p>\n\n<p>I wish to create a query which will return a List of all <strong>Shifts</strong> like so</p>\n\n<pre><code>public IList&lt;Shift&gt; GetShifts(int id)\n{\n   return _UoW.Shifts.Get(s =&gt; s.organisationID == id).OrderBy(s =&gt; s.startDate).ToList();\n}\n</code></pre>\n\n<p>Then in my Razor View, I wish to use a foreach loop and list the details of each Shift. One of these details is the total number of <strong>ShiftDates</strong> each <strong>Shift</strong> has. To do this I will do something like</p>\n\n<pre><code>foreach(var shiftDate in Model.Shifts)\n{\n    @Html.DisplayFor(modelItem =&gt; item.ShiftDates.Count)\n}\n</code></pre>\n\n<p>This works fine, however, I want the count to exclude <strong>ShiftDates</strong> whose shiftDateStatusID is set to 442. To do this I tried amending my Linq Query to this</p>\n\n<pre><code>return _UoW.Shifts.Get(s =&gt; s.organisationID == id &amp;&amp; s.ShiftDates.Any(sd =&gt; sd.shiftDateStatusID != 442))\n.OrderBy(s =&gt; s.startDate).ToList();\n</code></pre>\n\n<p>However, this still pulls back ShiftDates who have a shiftDateStatusID of 442.</p>\n\n<p>Hopefully this makes sense.</p>\n\n<p>Any feedback would be greatly appreciated.</p>\n\n<p>Thanks.</p>\n"},{"tags":["linq","linq-to-sql","search","full-text-search","fulltext"],"answer_count":8,"favorite_count":8,"up_vote_count":10,"down_vote_count":0,"view_count":11156,"score":10,"question_id":565617,"title":"Full Text Search in Linq","body":"<p>There's no full text search built into Linq and there don't seem to be many posts on the subject so I had a play around and came up with this method for my utlity class:</p>\n\n<pre><code>public static IEnumerable&lt;TSource&gt; GenericFullTextSearch&lt;TSource&gt;(string text, MyDataContext context)\n{\n    //Find LINQ Table attribute\n    object[] info = typeof(TSource).GetCustomAttributes(typeof(System.Data.Linq.Mapping.TableAttribute), true);\n    //Get table name\n    String table = (info[0] as System.Data.Linq.Mapping.TableAttribute).Name;\n    //Full text search on that table\n    return context.ExecuteQuery&lt;TSource&gt;(String.Concat(\"SELECT * FROM \", table, \" WHERE CONTAINS(*, {0})\"), text);\n}\n</code></pre>\n\n<p>And added this wrapper to each partial Linq class where there is a full text index</p>\n\n<pre><code>public static IEnumerable&lt;Pet&gt; FullTextSearch(string text, MyDataContext context)\n{\n    return (LinqUtilities.GenericFullTextSearch&lt;Pet&gt;(text, context) as IEnumerable&lt;Pet&gt;);\n}\n</code></pre>\n\n<p>So now I can do full text searches with neat stuff like</p>\n\n<pre><code>var Pets = Pet.FullTextSearch(helloimatextbox.Text, MyDataContext).Skip(10).Take(10);\n</code></pre>\n\n<p>I'm assuming only a very basic search is necessary at present. Can anyone improve on this? Is it possible to implement as an extension method and avoid the wrapper?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":4168,"score":5,"question_id":277634,"title":"Linq query to return a flatened list of parent child","body":"<p>still new to the world of linq, and i need some help flatening a list of parents that have children, into a single list of ParentChild's.</p>\n\n<p>Just like this:</p>\n\n<pre><code>class Program\n{\n    static void Main()\n    {\n        List&lt;Parent&gt; parents = new List&lt;Parent&gt;();\n\n        parents.Add(new Parent { Name = \"Parent1\", Children = new List&lt;Child&gt; { new Child { Name = \"Child1\" }, new Child { Name = \"Child2\" } } });\n        parents.Add(new Parent { Name = \"Parent2\", Children = new List&lt;Child&gt; { new Child { Name = \"Child3\" }, new Child { Name = \"Child4\" } } });\n\n        // linq query to return List&lt;ParentChild&gt; parentChildList;\n        // ParentName = Parent1, ChildName = Child1\n        // ParentName = Parent1, ChildName = Child2\n        // ParentName = Parent2, ChildName = Child3\n        // ParentName = Parent2, ChildName = Child4\n    }\n\n    internal class ParentChild\n    {\n        public string ParentName { get; set; }\n        public string ChildName { get; set; }\n    }\n\n    internal class Parent\n    {\n        public string Name { get; set; }\n        public List&lt;Child&gt; Children { get; set; }\n    }\n\n    internal class Child\n    {\n        public string Name { get; set; }\n    }\n}\n</code></pre>\n\n<p>Many thanks,\nChris</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":12975982,"title":"LINQ contains query custom ordering","body":"<p>I have a LINQ query that gets me all results where the code is contained within a list. This works fine, however I need to keep the order as per the list of codes. So when the EnumerableRowCollection is returned, the rows are in the same order as tehy were in the List.</p>\n\n<p>Here's my current code:</p>\n\n<pre><code>if (productcodes != \"\")\n{\n    string[] pcodes = productcodes.Split('|');\n\n    // Get most recently viewed first\n    Array.Reverse(pcodes);\n\n    List&lt;int&gt; prodCodes = new List&lt;int&gt;();\n\n    foreach (string pc in pcodes)\n    {\n        if (pc != \"\")\n        {\n            prodCodes.Add(Convert.ToInt32(pc));\n        }\n    }\n\n    results = results.Where(d =&gt; d[\"ProductCode\"] != DBNull.Value &amp;&amp; (int)d[\"ID\"] &gt; 0 &amp;&amp; prodCodes.Contains((int)d[\"ProductCode\"])).Select(d =&gt; d);\n}\n</code></pre>\n\n<p>So I need the EnumerableRowCollection results to be ordered the same as they are in List prodCodes rather than it's own random order.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12975306,"title":"Remove item from list using linq","body":"<p>How to remove item from list using linq ?.</p>\n\n<p>I have a list of items and each item it self having a list of other items now I want to chaeck if other items contains any items of passed list so main item should be remove.\nPlease check code for more clarity. </p>\n\n<pre><code>public Class BaseItems\n{\n    public int ID { get; set; }\n    public List&lt;IAppointment&gt; Appointmerts { get; set; }\n}\n\nPublic DeleteApp(List&lt;IAppointment&gt; appointmentsToCheck)\n{\n   List&lt;BaseItems&gt; _lstBase ; // is having list of appointments\n\n   //now I want to remove all items from _lstBase  which _lstBase.Appointmerts contains \n   any item of appointmentsToCheck (appointmentsToCheck item and BaseItems.Appointmerts \n   item is having a same reference)\n\n   //_lstBase.RemoveAll(a =&gt; a.Appointmerts.Contains( //any item from appointmentsToCheck));\n\n}\n</code></pre>\n"},{"tags":["linq","entity-framework","linq-to-entities"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12974312,"title":"Entity Framework model.edmx and many to many relationships","body":"<p>In the database I have 3 tables, User, Group and a lookup table UserGroup which contains UserID and GroupId.</p>\n\n<p>I create a model.edmx and this allows me to:\nvar users = context.User\nvar groups = context.Group\nbut does not create an object for context.UserGroup.</p>\n\n<p>what is the syntax for getting all the users in a group, and all the groups that a user belongs to?</p>\n\n<pre><code>var results = from groups in db.Groups.Where(t =&gt; t.Users(u =&gt; u.UserID ==1))\nselect groups;\n</code></pre>\n"},{"tags":["php","linq"],"answer_count":4,"favorite_count":2,"up_vote_count":7,"down_vote_count":1,"view_count":1023,"score":6,"question_id":5792388,"title":"Is there something in php equivalent to LinQ in C#?","body":"<p>Is there something in php equivalent to LinQ in C#?</p>\n"},{"tags":["c#","asp.net-mvc-3","linq","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":12973649,"title":"Autocomplete field in a form ? []","body":"<p>I work with c# MVC3 &amp; razor, Entity Framework and Linq.</p>\n\n<p>I have a form, with two field, the first one <strong>Client ID</strong>  and the second one <strong>Store Name</strong>.\nI would like, when the user enter the ID, then my StoreName field fill automatically... The data would come from a database where this two data are stored.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12974381,"title":"how to combine two data source into one?","body":"<p>i have records in two tables, and 1 object,\ni want to retrieve data from both tables into 1 gridview, (both tables have same fields) i can not have joins because i need to show all rows</p>\n\n<p>here is my code:</p>\n\n<pre><code>var query = from all in DB.Movies\n            where all.IsActive\n            select new MoviesObject\n            {\n                PhotoId = all.PhotoId,\n                Title = all.Title,\n                Description = all.ShortDescription\n            };\nvar querytwo = from all in DB.movieslisttwo\n               where all.IsActive\n               select new MoviesObject\n               {\n                   PhotoId = all.PhotoId,\n                   Title = all.Title,\n                   Description = all.ShortDescription\n               ;\nreturn query.ToList();\n</code></pre>\n"},{"tags":["c#","linq","entity-framework","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12972938,"title":"Update child page's column in Linq","body":"<p>Please see the following code:</p>\n\n<pre><code>public void UpdateChildPagesReWrittenUrl(int parentPageId)\n    {\n        var childPageList = db.PcPages.Where(m =&gt; m.ParentID == parentPageId);\n\n        if (childPageList.Count() &gt; 0)\n        {\n            foreach (var item in childPageList)\n            {\n                db.ExecuteNonQuery(string.Format(\"UPDATE pcPage SET Url = {0}/{1} WHERE PageID = {2}\",\n                    GetRootUrl(item.ParentID),\n                    hnUrlHelper.UrlSafe(item.PageName), item.PageID));\n                db.SaveChanges();\n            }\n        }\n\n    }\n</code></pre>\n\n<p>I trying to update all the child pages url when a parent page updates the page name itself. This code I thought it working. but not.  Anyone can advise better in better way  please ?</p>\n"},{"tags":["sql","asp.net-mvc","linq","data","orchardcms"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":756,"score":0,"question_id":7810751,"title":"Orchard CMS. how to Query the Orchard Database?","body":"<p>I need to Query existing Tables inside my Orchard database. These tables are coming from an existing ecommerce website. So my question is: How do I query tables that contain data inside my Orchard database and have the data displayed on the Admin/Editor side. And finally on the front end/user side when the page is published? i have All the Models, Drivers, Handlers and Views created. I'm just stumped on where to Query the DB.</p>\n\n<p>Thanks</p>\n\n<p>Oceantrain</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12972839,"title":"Sorting an array by name alphabetically","body":"<p>I currently have an array of <code>\"Brand Products\"</code> that I am trying to sort into alphabetical order based on their <code>name</code> after they are obtained from the database, the list is currently populated using this:</p>\n\n<pre><code>    protected override object[] GetCollection()\n    {\n        Brand brand = ItemLocator.LocateItem(this.Parent, typeof(Brand)) as Brand;\n\n        ICriteria criteria = CoreHttpModule.Session.CreateCriteria(typeof(Product));\n        criteria.Add(NHibernate.Expression.Expression.Eq(\"Brand\", brand));\n        criteria.Add(NHibernate.Expression.Expression.Eq(\"IsVisibleOnWebsite\", true));\n\n        IList&lt;Product&gt; productList = criteria.List&lt;Product&gt;();\n\n        IList&lt;Product&gt; filteredLroductList = new List&lt;Product&gt;();\n\n        for (int i = 0; i &lt; productList.Count; i++)\n        {\n            if (productList[i].Parent != null)\n            {\n                filteredLroductList.Add(productList[i]);\n            }\n        }\n\n        object[] filteredProductListArray = new object[filteredLroductList.Count];\n\n        for (int i = 0; i &lt; filteredLroductList.Count; i++)\n        {\n            filteredProductListArray.SetValue(filteredLroductList[i], i);\n        }\n\n             return filteredProductListArray;\n    }\n</code></pre>\n"},{"tags":["c#",".net","performance","linq"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":155,"score":5,"question_id":12819792,"title":"LINQ query is slow","body":"<p>During application profiling I found that function checking for pattern match is very slow. It is written using LINQ. Simple replacement of this LINQ expression with loop makes really huge difference. What is it? Is LINQ really such a bad thing and works so slow or I misunderstand something?</p>\n\n<pre><code>private static bool PatternMatch1(byte[] buffer, int position, string pattern)\n{\n    int i = 0;\n\n    foreach (char c in pattern)\n    {\n        if (buffer[position + i++] != c)\n        {\n            return false;\n        }\n    }\n\n    return true;\n}    \n</code></pre>\n\n<p>version 2 with LINQ (suggested by Resharper)</p>\n\n<pre><code>private static bool PatternMatch2(byte[] buffer, int position, string pattern)\n{\n    int i = 0;\n    return pattern.All(c =&gt; buffer[position + i++] == c);\n}\n</code></pre>\n\n<p>version 3 with LINQ</p>\n\n<pre><code>private static bool PatternMatch3(byte[] buffer, int position, string pattern)\n{\n    return !pattern.Where((t, i) =&gt; buffer[position + i] != t).Any();\n}\n</code></pre>\n\n<p>version 4 using lambda</p>\n\n<pre><code>private static bool PatternMatch4(byte[] buffer, int position, string pattern, Func&lt;char, byte, bool&gt; predicate)\n{\n    int i = 0;\n\n    foreach (char c in pattern)\n    {\n        if (predicate(c, buffer[position + i++]))\n        {\n            return false;\n        }\n    }\n\n    return true;\n}\n</code></pre>\n\n<p>and here is the usage with large buffer</p>\n\n<pre><code>const int SIZE = 1024 * 1024 * 50;\n\nbyte[] buffer = new byte[SIZE];\n\nfor (int i = 0; i &lt; SIZE - 3; ++i)\n{\n    if (PatternMatch1(buffer, i, \"xxx\"))\n    {\n        Console.WriteLine(i);\n    }\n}\n</code></pre>\n\n<p>Calling <code>PatternMatch2</code> or <code>PatternMatch3</code> is phenomenally slow. It takes about 8 seconds for <code>PatternMatch3</code> and about 4 seconds for <code>PatternMatch2</code>, while calling <code>PatternMatch1</code> takes about 0.6. As far as I understand it is the same code and I see no difference. Any ideas?</p>\n"},{"tags":["c#","linq","sorting","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12971628,"title":"OrderBy named index","body":"<p>I have a DataGridView that holds data returned from a stored procedure on a database. The columns are different for each return value, so do not have strongly-typed names. I'm currently struggling to order these, as the numeric columns are being ordered as strings, eg. 1 -> 10 -> 11 -> 15 -> 2 -> 25 -> 3, and not by value. I've confirmed that the ValueType of the column is being set correctly. I have tried this:</p>\n\n<pre><code>var sortedRows = from row in _rowArray\n                             orderby columnIndex\n                             select row;\n                _rowArray = sortedRows.ToArray();\n</code></pre>\n\n<p>where _rowArray is an array of DataRows, and is the DataSource of the DataGridView, and columnIndex is an integer variable specifying which column in _rowArray the user wants to order by. While debugging, I can see that the sortedRows holds the same sequence as _rowArray in the same order, immediately following the LINQ statement. I have also tried:</p>\n\n<pre><code>_rowArray = _rowArray.OrderBy(r =&gt; r[columnIndex]).ToArray();\n</code></pre>\n\n<p>and have tried creating a DataView (view) and done this:</p>\n\n<pre><code>view.Sort = m_data.Tables[0].Columns[columnIndex].ColumnName + \" ASC\";        \n</code></pre>\n\n<p>...but that hasn't worked. Anyone offer any insight?</p>\n"},{"tags":[".net","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12972295,"title":"FirstOrDefault: Default value other than null","body":"<p>As I understand it, in Linq the method <code>FirstOrDefault()</code> can return a <code>Default</code> value of something other than null.  What I haven't worked out is what kind of things other than null can be returned by this (and similar) method when there are no items in the query result.  Is there any particular way that this can be set up so that if there is no value for a particular query some predefined value is returned as the default value?</p>\n"},{"tags":["c#","winforms","linq","ilist"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":988,"score":6,"question_id":3844463,"title":"How Do I Sort IList<Class>?","body":"<p>There's no <code>Sort()</code> function for <code>IList</code>. Can someoene help me with this?\nI want to sort my own IList.</p>\n\n<p>Suppose this is my IList:</p>\n\n<pre><code>public class MyObject() \n{\n public int number { get; set; }\n public string marker { get; set; }\n}\n</code></pre>\n\n<p>How do I sort myobj using the marker string?</p>\n\n<pre><code>public void SortObject()\n{\n IList&lt;MyObject&gt; myobj = new List&lt;MyObject&gt;();\n}\n</code></pre>\n"},{"tags":["linq","selectmany"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12970924,"title":"How do I return all of the child objects - I can't get SelectMany to work","body":"<p>I have a class</p>\n\n<pre><code>    public class Foo\n    {\n       public IList&lt;Foo&gt; Items { get; set; }\n    }\n\n    public class FooList\n    {\n       public IList&lt;Foo&gt; Items { get; set; }\n    }\n</code></pre>\n\n<p>I want to be able to get all of the Foo objects in one list, instead of a hierarchy.</p>\n\n<p>I have tried</p>\n\n<pre><code>    IEnumerable&lt;Foo&gt; result = Items.SelectMany(f =&gt;  f.Items);\n</code></pre>\n\n<p>but this just gets me the items in that specific object - it doesn't get all the items in all of the child objects.</p>\n\n<p>I also tried</p>\n\n<pre><code>    IEnumerable&lt;Foo&gt; result = Items.SelectMany(t =&gt; t)\n</code></pre>\n\n<p>But I get the error: </p>\n\n<blockquote>\n  <p>The type arguments for method 'System.Linq.Enumerable.SelectMany(System.Collections.Generic.IEnumerable, System.Func>)' cannot be inferred from the usage. Try specifying the type arguments explicitly.</p>\n</blockquote>\n"},{"tags":["c#","linq","linq-to-entities","repository-pattern"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12969987,"title":"What is the recommended practice for sharing similar linq to entities expression logic in different repositories","body":"<p>When using the repository pattern , sometimes you have the same logic that appears in different repositories.In the example below <strong>GetTempEmployees()</strong> in EmployeeRepository and <strong>GetCompaniesWithTemps</strong>() in CompanyRepository\nhave the same expressions </p>\n\n<pre><code>e.IsTemp &amp;&amp; e.IsDeleted == false\n</code></pre>\n\n<p>My question is what is the recommended practice for minimizing this duplication of expression logic.</p>\n\n<p>eg.</p>\n\n<pre><code>public class Employee\n{\n    public int EmployeeId { get; set; }\n    public bool IsTemp { get; set; }\n    public bool IsDeleted { get; set; }\n}\n\npublic class Company\n{\n    public int CompanyId { get; set; }\n    public bool IsDeleted { get; set; }\n    public virtual ICollection&lt;Employee&gt; Employees { get; set; } \n\n}\n\npublic class TestContext : DbContext\n{\n    public TestContext()\n    {\n    }\n    public DbSet&lt;Employee&gt; Employee { get; set; }\n    public DbSet&lt;Company&gt; Company { get; set; }\n}\n\n\npublic class EmployeeRepository\n{\n    private readonly TestContext _context;\n    EmployeeRepository(TestContext context)\n    {\n        _context = context;\n    }\n\n    public ICollection&lt;Employee&gt; GetTempEmployees()\n    {\n        return _context.Employee.Where(e =&gt; e.IsTemp &amp;&amp; e.IsDeleted==false).ToList();\n    }\n}\n\npublic class CompanyRepository\n{\n    private readonly TestContext _context;\n    CompanyRepository(TestContext context)\n    {\n        _context = context;\n    }\n\n    public ICollection&lt;Company&gt; GetCompaniesWithTemps()\n    {\n        return _context.Company.Where(c =&gt; c.Employees.Any(e =&gt; e.IsTemp &amp;&amp; e.IsDeleted == false)).ToList();\n    }\n}\n</code></pre>\n"},{"tags":["xml","linq","linq-to-xml"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1567,"score":4,"question_id":457970,"title":"Keep HTML tags in XML using LINQ to XML","body":"<p>I have an xml file from which I am extracting html using LINQ to XML.  This is a sample of the file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;tips&gt;\n    &lt;tip id=\"0\"&gt;\n\tThis is the first tip.\n&lt;/tip&gt;\n&lt;tip id=\"1\"&gt;\n\tUse &lt;b&gt;Windows Live Writer&lt;/b&gt; or &lt;b&gt;Microsoft Word 2007&lt;/b&gt; to create and publish content.\n&lt;/tip&gt;\n&lt;tip id=\"2\"&gt;\n\tEnter a &lt;b&gt;url&lt;/b&gt; into the box to automatically screenshot and index useful webpages.\n&lt;/tip&gt;\n&lt;tip id=\"3\"&gt;\n\tInvite your &lt;b&gt;colleagues&lt;/b&gt; to the site by entering their email addresses.  You can then share the content with them!\n&lt;/tip&gt;\n&lt;/tips&gt;\n</code></pre>\n\n<p>I am using the following query to extract a 'tip' from the file:</p>\n\n<pre><code>Tip tip = (from t in tipsXml.Descendants(\"tip\")\n\t\t\t\t   where t.Attribute(\"id\").Value == nextTipId.ToString()\n\t\t\t\t   select new Tip()\n\t\t\t\t   {\n\t\t\t\t     TipText= t.Value,\n\t\t\t\t\t TipId = nextTipId\n\t\t\t\t   }).First();\n</code></pre>\n\n<p>The problem I have is that the Html elements are being stripped out.  I was hoping for something like InnerHtml to use instead of Value, but that doesn't seem to be there.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks all in advance,</p>\n\n<p>Dave</p>\n"},{"tags":["asp.net","linq","web-services","extjs4.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":12820108,"title":"Extjs + Asp.Net LINQ + webservice","body":"<p>I am working with ExtJs 4.1.and <strong>I want to develop basic gridpanel application in extjs which display data from linq through WebService</strong> I am not using asp.net MVC. so how can i display??</p>\n\n<p>I tried to find solution from following code but didn't find success.</p>\n\n<p><strong>grid.js</strong></p>\n\n<pre><code>Ext.application({\n    launch: function() {\n        // Model definition and remote store (used Ext examples data)\n        Ext.define('ForumThread', {\n            extend: 'Ext.data.Model',\n            fields: ['countryId', 'countryName'],\n            idProperty: 'countryId'\n        });\n\n         var store = Ext.create('Ext.data.Store', {\n        pageSize: 20,\n        model: 'ForumThread',\n        autoLoad: true,\n        proxy: {\n            type: 'ajax',\n            url: '../reports/test.asmx/display',\n            dataType: \"json\",\n            contentType: \"application/json; charset=utf-8\",\n             //url: '/grid.json',\n            reader: {                \n                type: 'json',\n                method: \"GET\",\n                totalProperty: 'totalCount'\n            }\n        }\n    });\n\n        // Define grid that will automatically restore its selection after store reload\n        Ext.define('PersistantSelectionGridPanel', {\n            extend: 'Ext.grid.Panel',\n\n        });\n\n        // Create instance of previously defined persistant selection grid panel\n        var grid = Ext.create('PersistantSelectionGridPanel', {\n            autoscroll: true,\n            height: 300,\n            renderTo: Ext.getBody(),\n            //region: 'center',\n            store: store,\n            multiSelect: true, // Delete this if you only need single row selection\n            stateful: true,\n            forceFit: true,\n            loadMask: false,\n            viewConfig: {\n                stripeRows: true\n            },\n            columns:[{\n                id: 'countryId',\n                text: \"countryId\",\n                dataIndex: 'countryId',\n                flex: 1,\n                sortable: false\n            },{\n                text: \"countryName\",\n                dataIndex: 'countryName',\n                width: 70,\n                align: 'right',\n                sortable: true\n            } ]\n        });\n    }\n});\n</code></pre>\n\n<p><strong>test.asmx</strong></p>\n\n<pre><code>[WebMethod]\n        [ScriptMethod(ResponseFormat = ResponseFormat.Json , UseHttpGet = true, XmlSerializeString = false)]\n    public string display()\n    {\n        country obj = new country();\n        //return obj.SelectAll();\n        JavaScriptSerializer serializer = new JavaScriptSerializer();\n        return serializer.Serialize(obj.SelectAll());\n    }\n</code></pre>\n\n<p><strong>but i am getting following error in firebug</strong>\n<img src=\"http://i.stack.imgur.com/hKRuc.png\" alt=\"enter image description here\"></p>\n"},{"tags":["asp.net","linq","dynamic"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":90,"score":0,"question_id":12952399,"title":"how to get sum of anonymous field in dynamic linq query","body":"<p>to show sum of field in footer row of gridview i want to get sum from my dynamic list, InTopSuppliersView() is in separate assembly DAL while gridview is inside presentation layer.</p>\n\n<p>Code in DAL:</p>\n\n<pre><code>public static dynamic InTopSuppliersView()\n{\n\n    var _pd = from pd in InTopSuppliers()\n                join pm in PdnmasterDALC.InTopSuppliers() on pd.Pdnmasterid equals pm.Pdnmasterid\n                select new\n                {\n                    RefNo = pm.PDNRefNo,\n                    Date = pm.Date\n                    Quantity = pd.QuantityApprovedUOM,\n                    Rate = pd.Rate,\n                    Amount = pd.Amount\n                };\n\n    return _pd;\n}\n</code></pre>\n\n<p>Code on form:</p>\n\n<pre><code>var tmp = InTopSuppliersView();\ngvPDNDetail.DataSource = tmp;\ngvPDNDetail.DataBind();\n\ngvPDNDetail.FooterRow.Cells[3].Text = tmp.SUM(o =&gt; o.Quantity).ToString();\n</code></pre>\n\n<p>i want to get sum of fields Quantity and Amount created dynamically in query</p>\n\n<p><img src=\"http://i.stack.imgur.com/LDmjZ.png\" alt=\"enter image description here\"></p>\n"},{"tags":["asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12967672,"title":"error \"A data item was not found in the container\" in the nested grid view","body":"<p>In the main gridview <code>\"GridViewTtransmittals\"</code> I have the nested gridview with the name <code>\"GridViewTranstoCon\"</code>.When \"GridViewTranstoCon\" has data, I have no problem, but when there is not any data for that it returns error <code>\"A data item was not found in the container\",</code> I like it to return null value or have it invisible.\nThe code is like below:</p>\n\n<pre><code>protected void GridViewTtransmittals_RowDataBound(object sender, GridViewRowEventArgs e)\n{\n    if (e.Row.DataItem == null)\n        return;\n    TransmittaltoConPresentationModel transmittaltoCon = (TransmittaltoConPresentationModel)e.Row.DataItem;\n    GridView g2 = (GridView)e.Row.FindControl(\"GridViewTranstoCon\");\n\n    if (transmittaltoCon.TranstoCons != null)\n    {\n        g2.DataSource = transmittaltoCon.TranstoCons;\n        g2.DataBind();\n    }\n}\n</code></pre>\n\n<p>The code for data source of main gridview  \"GridViewTtransmittals\" comes of below code:</p>\n\n<pre><code>private void DisplayTransmittals()\n{\n    if (_Transmittals.Any())\n    {\n        var query = from transmittalno in _Transmittals\n\n        select new TransmittaltoConPresentationModel { TransID = transmittalno.TransID,\n                   Transmittal = transmittalno.TRANSMITTAL, TranstoCons = from doctranstocon in _DocTranstoCons \n                   where doctranstocon == null || transmittalno.TransID == doctranstocon.Transid\n                   select doctranstocon != null ? doctranstocon.tblTranstoCon : null};\n\n        GridViewTtransmittals.DataSource = query;\n    }\n    else\n    {\n        GridViewTtransmittals.DataSource = null;\n    }\n    GridViewTtransmittals.DataBind();\n}\n</code></pre>\n"},{"tags":["c#","xml","linq","join","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":64,"score":1,"question_id":12966548,"title":"LINQ to XML join issue","body":"<p>I'm having real trouble with a join that I am trying to perform on two separate XML files.</p>\n\n<p>I have two classes that describe each object that I extract from the XML files, they are </p>\n\n<pre><code>public class XMLCustomers\n{\n    public String CustomerID { get; set; }\n    public String ContactName { get; set; }\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>public class XMLOrders\n{\n    public String OrderID { get; set; }\n    public String CustomerID { get; set; }\n    public String OrderDate { get; set; }\n    public String ShippedDate { get; set; }\n    public String Freight { get; set; }\n    public String ShipName { get; set; }\n    public String ShipCity { get; set; }\n    public String ShipCountry { get; set; }\n}\n</code></pre>\n\n<p>And my last class stores the join that I perform on the two sets of data.</p>\n\n<pre><code>public class PostXMLJoinOrder\n{\n    public String OrderID { get; set;}\n    public String ContactName { get; set;}\n    public String OrderDate { get; set;}\n    public String ShippedDate { get; set;}\n    public String Freight { get; set;}\n    public String ShipName { get; set;}\n    public String ShipCity { get; set;}\n    public String ShipCountry { get; set;}\n}\n</code></pre>\n\n<p>Finally these are my two methods that load the information from the XML files and the third method performs a join and stores the information in a IEnumerable</p>\n\n<pre><code>        public IEnumerable&lt;XMLCustomers&gt; LoadXMLCustomers() {\n        var custs = from x in XElement.Load(System.Web.HttpContext.Current.Server.MapPath(@\"~\\App_Data\\XCustomers.xml\")).Elements()\n                    select new XMLCustomers\n                    {\n                        ContactName = x.Attribute(\"ContactName\").Value,\n                        CustomerID = x.Attribute(\"CustomerID\").Value\n\n                    };\n        int size = custs.Count();\n        return custs;\n    }\n\n    public IEnumerable&lt;XMLOrders&gt; LoadXMLOrders() {\n        var ords = from x in XElement.Load(System.Web.HttpContext.Current.Server.MapPath(@\"~\\App_Data\\XOrders.xml\")).Elements()\n                    select new XMLOrders\n                    {\n\n                        OrderID = x.Attribute(\"ContactName\").Value,\n                        CustomerID = x.Attribute(\"CustomerID\").Value,\n                        OrderDate = x.Attribute(\"OrderDate\").Value,\n                        ShippedDate = x.Attribute(\"ShippedDate\").Value,\n                        Freight = x.Attribute(\"Freight\").Value,\n                        ShipName = x.Attribute(\"ShipName\").Value,\n                        ShipCity = x.Attribute(\"ShipCity\").Value,\n                        ShipCountry = x.Attribute(\"ShipCountry\").Value\n                    };\n        int size = ords.Count();\n        return ords;\n\n    }\n\n\n    public IEnumerable&lt;PostXMLJoinOrder&gt; LoadPostXMLJoinOrders() {\n        var joinQuery = from customer in LoadXMLCustomers()\n                        from orders in LoadXMLOrders()\n                        where customer.CustomerID == orders.CustomerID\n                        select new PostXMLJoinOrder\n                        {\n\n                            OrderID = orders.OrderID,\n                            ContactName = customer.ContactName,\n                            OrderDate = orders.OrderDate,\n                            ShippedDate = orders.ShippedDate,\n                            Freight = orders.Freight,\n                            ShipName = orders.ShipName,\n                            ShipCity = orders.ShipCity,\n                            ShipCountry = orders.ShipCountry\n\n                        };\n        return joinQuery;\n\n\n    }\n</code></pre>\n\n<p>I have tested the amount of items returned from my LINQ and it continues to be 0;\nI have double checked everything being loaded in from the files but I cant seem to get my head around at which point its going wrong.</p>\n\n<p>Edit:\nits a loading issue. the XML files are definitely stored under the correct App_Data folder. But when the individial LoadXMLCustomers() is running Im getting a NullReferenceException at the part where the lINQ statement selects and creates the new Loaded Customer object.</p>\n\n<p><strong>I have already made sure the build for the XML documents are content and copyToOutputDirectory is set to if newer</strong></p>\n\n<p>this is the Exception &amp; Also the var value is null so its definitely not loading for some reason:\n<img src=\"http://i.stack.imgur.com/akgHM.png\" alt=\"Exception Screenshot\"></p>\n\n<p>SOLVED: The lesson I learnt here is that you need to pay close attention to your XML and data. If some of your XML data has empty values, then you need to account by making sure the select statement can handle it.</p>\n\n<p>Above I had the code </p>\n\n<pre><code>                    select new XMLOrders\n                {\n\n                    OrderID = x.Attribute(\"ContactName\").Value,\n                    CustomerID = x.Attribute(\"CustomerID\").Value,\n                    OrderDate = x.Attribute(\"OrderDate\").Value,\n                    ShippedDate = x.Attribute(\"ShippedDate\").Value,\n                    Freight = x.Attribute(\"Freight\").Value,\n                    ShipName = x.Attribute(\"ShipName\").Value,\n                    ShipCity = x.Attribute(\"ShipCity\").Value,\n                    ShipCountry = x.Attribute(\"ShipCountry\").Value\n                };\n</code></pre>\n\n<p>Which really should have included casts to string values so if there is empty data is \"\" not throwing a null exception.\nSecondly I should have been getting the Element values not the Attribute values.</p>\n\n<pre><code>                    select new XMLOrders\n                    {\n\n                        OrderID = (string)x.Element(\"OrderID\").Value,\n                        CustomerID = (string)x.Element(\"CustomerID\").Value,\n                        OrderDate = (string)x.Element(\"OrderDate\").Value,\n                        ShippedDate = (string)x.Element(\"ShippedDate\").Value,\n                        Freight = (string)x.Element(\"Freight\").Value,\n                        ShipName = (string)x.Element(\"ShipName\").Value,\n                        ShipCity = (string)x.Element(\"ShipCity\").Value,\n                        ShipCountry = (string)x.Element(\"ShipCountry\").Value\n                    };\n</code></pre>\n"},{"tags":["c#","xml","linq","select","where"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12964922,"title":"How to add a where clause inside select query","body":"<pre><code>&lt;PersVeh id=\"V0001\" LocationRef=\"L0001\" RatedDriverRef=\"D0001\"&gt;\n  &lt;Manufacturer&gt;FORD&lt;/Manufacturer&gt; \n  &lt;Model&gt;TAURUS SE&lt;/Model&gt; \n  &lt;ModelYear&gt;2007&lt;/ModelYear&gt; \n  &lt;VehBodyTypeCd&gt;PP&lt;/VehBodyTypeCd&gt; \n  &lt;POLKRestraintDeviceCd&gt;E&lt;/POLKRestraintDeviceCd&gt; \n  &lt;EstimatedAnnualDistance&gt;\n    &lt;NumUnits&gt;011200&lt;/NumUnits&gt; \n  &lt;/EstimatedAnnualDistance&gt;\n  &lt;VehIdentificationNumber&gt;1FAFP53U37A160207&lt;/VehIdentificationNumber&gt; \n  &lt;VehSymbolCd&gt;12&lt;/VehSymbolCd&gt; \n  &lt;VehRateGroupInfo&gt;\n    &lt;RateGroup&gt;16&lt;/RateGroup&gt; \n    &lt;CoverageCd&gt;COMP&lt;/CoverageCd&gt; \n  &lt;/VehRateGroupInfo&gt;\n  &lt;VehRateGroupInfo&gt;\n    &lt;RateGroup&gt;21&lt;/RateGroup&gt; \n    &lt;CoverageCd&gt;COLL&lt;/CoverageCd&gt; \n  &lt;/VehRateGroupInfo&gt;\n</code></pre>\n\n<p>I'm brand new to Linq and I'm hoping that someone can help me with what may or may not be a simple problem.</p>\n\n<p>For the above xml sample I'm using the following code:</p>\n\n<pre><code>var result = from item in doc.Descendants(n + \"PersVeh\")\n        where item.Attribute(\"id\").Value == \"V0001\"\n        select new\n            {\n                RatedDriverRef = (string)item.Attribute(\"RatedDriverRef\"),\n                LocationRef = (string)item.Attribute(\"LocationRef\"),\n                ModelYear = (string)item.Element(n + \"ModelYear\") ?? \"9999\",\n                VehBodyTypeCd = (string)item.Element(n + \"VehBodyTypeCd\") ?? \"XX\",\n                POLKRestraintDeviceCd = (string)item.Element(n + \"POLKRestraintDeviceCd\") ?? \"0\",\n                EstimatedAnnualDistance = (string)item.Element(n + \"EstimatedAnnualDistance\").Element(n + \"NumUnits\") ?? \"999999\",\n                VehIdentificationNumber = (string)item.Element(n + \"VehIdentificationNumber\") ?? \"VIN not found\",\n                VehSymbolCd = (string)item.Element(n + \"VehSymbolCd\") ?? \"00\"\n            };\n</code></pre>\n\n<p>The problem I'm having is with the <strong>VehRateGroupInfo</strong> nodes. I need to extract the <strong>RateGroup</strong> number based on the <strong>CoverageCd</strong>.</p>\n\n<p>In other words, something like this:</p>\n\n<pre><code>CompSymbol = item.Element(n + \"VehRateGroupInfo\").Element(n + \"RateGroup\").Value\n             where item.Element(n + \"VehRateGroupInfo\").Element(n + \"CoverageCd\").Value == \"COMP\"\n</code></pre>\n\n<p>Is it possible to do this within the select or do I need a separate query?</p>\n"},{"tags":["c#","asp.net-mvc","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12966932,"title":"Getting vote counts for a Post using Linq","body":"<p>Here's my database schema:</p>\n\n<pre><code>create table Post\n(\n    PostId int primary key identity,\n    ImageUrl nvarchar(1024) not null,\n    [Description] nvarchar(256) not null,\n    UserId int foreign key references [User](UserId),\n    DateOfPost datetime not null,\n    Score int\n)\n\ncreate table Vote\n(\n    VoteId int primary key identity,\n    UserId int foreign key references [User](UserId),\n    PostId int foreign key references Post(PostId),\n    VoteDirection bit not null,\n    DateOfVote datetime not null\n)\n</code></pre>\n\n<p>Basically, I want to order the Posts by <code>[VoteDirection == true] - [VoteDirection == false]</code>. So it 20 people votes \"true\", and 5 vote \"false\", the temporary score used for ordering would be 15.</p>\n\n<p>Is there also a way to select a range of date using the DateOfVote parameter?</p>\n\n<p>Here's what I've tried:</p>\n\n<pre><code>    // www.foo.com/top/today\n    public ActionResult Today()\n    {\n        var posts = postRepository.FindAllPosts().Where(x =&gt; x.DateOfPost == DateTime.Today)\n                                                 .OrderByDescending(x =&gt; x.Votes.Where(c =&gt; c.VoteDirection == true) - x.Votes.Where(c =&gt; c.VoteDirection == false));\n        return View(posts);\n    }\n</code></pre>\n\n<p>I'm getting the error:</p>\n\n<blockquote>\n  <p>Error 2   Operator '-' cannot be applied to operands of type\n  'System.Collections.Generic.IEnumerable'\n  and\n  'System.Collections.Generic.IEnumerable'</p>\n</blockquote>\n\n<p>Which is understandable, they're both collections not actual integers. But it should illustrate what I'm trying to do. Any suggestions?</p>\n"},{"tags":["c#",".net","linq","textbox","distinct"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12965155,"title":"Remove duplciates from a textbox with .Distinct();","body":"<p>i have let's say this richtextbox</p>\n\n<pre><code>teddyinwonderland\nKristinaAlex33\nMariamPetkova\nVladislavMladenov\nOdanessy\ntvatieigrata\nVaninaDimova\nLillyRadevaa\ndisbalanced\nAdriyanMinchev\nvampirelove\nblqblqlq\njakitoo\nAdriyanMinchev\nLillyRadevaa\nToshkoPulov\nMaqGeorgieva\nkatiiig\nNataliaNikolova393\nMila1305\npyfpafpyfpaf\nGabriiellaDobreWa\ngaliinkaa\npaffwinchester06\nAlexFlip\niskocetegi\nAdriyanMinchev\nLillyRadevaa\nToshkoPulov\nMaqGeorgieva\nkatiiig\nNataliaNikolova393\nMila1305\npyfpafpyfpaf\nGabriiellaDobreWa\ngaliinkaa\npaffwinchester06\nAlexFlip\niskocetegi\nAdriyanMinchev\nLillyRadevaa\nToshkoPulov\nMaqGeorgieva\nkatiiig\nNataliaNikolova393\nMila1305\npyfpafpyfpaf\nGabriiellaDobreWa\ngaliinkaa\npaffwinchester06\nAlexFlip\niskocetegi\nAchyyWee\nsimeonov91\nDavidWilla\nteddyinwonderland\nkatiiig\nVladislavMladenov\nAtanasVirishapkov\nyeahhx\nMartinaPetrowa855\nGizemYasinAlaca\nIOANAAAAA\nyonii9\nOdanessy\nAchyyWee\nsimeonov91\nDavidWilla\nteddyinwonderland\nkatiiig\nVladislavMladenov\nAtanasVirishapkov\nyeahhx\nMartinaPetrowa855\nGizemYasinAlaca\nIOANAAAAA\nyonii9\nOdanessy\nAchyyWee\nsimeonov91\nDavidWilla\nteddyinwonderland\nkatiiig\nVladislavMladenov\nAtanasVirishapkov\nyeahhx\nMartinaPetrowa855\nGizemYasinAlaca\nIOANAAAAA\nyonii9\nOdanessy\nAchyyWee\nsimeonov91\nDavidWilla\nteddyinwonderland\nkatiiig\nVladislavMladenov\nAtanasVirishapkov\nyeahhx\nMartinaPetrowa855\nGizemYasinAlaca\nIOANAAAAA\nyonii9\nOdanessy\n</code></pre>\n\n<p>I want to remove the duplicates but i can not figure out how.</p>\n\n<p>I tried with</p>\n\n<pre><code>var asd = richtextbox1.Text.Distinct().ToList()/ToArray();\nforeach (string s in asd)\n{\n    richtextbox1.text = richtextbox1.text + s;\n}\n</code></pre>\n\n<p>Tried some other pointless things but nothing helped, from this one i am getting some weird results.</p>\n"},{"tags":["c#","sql","database","linq","skip-take"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":12468219,"title":"Read huge table with LINQ to SQL: Running out of memory vs slow paging","body":"<p>I have a huge table which I need to read through on a certain order and compute some aggregate statistics. The table already has a clustered index for the correct order so getting the records themselves is pretty fast. I'm trying to use LINQ to SQL to simplify the code that I need to write. The problem is that I don't want to load all the objects into memory, since the DataContext seems to keep them around -- yet trying to page them results in horrible performance problems.</p>\n\n<p>Here's the breakdown. Original attempt was this:</p>\n\n<pre><code>var logs = \n    (from record in dataContext.someTable \n     where [index is appropriate]\n     select record);\n\nforeach( linqEntity l in logs )\n{\n    // Do stuff with data from l\n}\n</code></pre>\n\n<p>This is pretty fast, and streams at a good rate, but the problem is that the memory use of the application keeps going up never stops. My guess is that the LINQ to SQL entities are being kept around in memory and not being disposed properly. So after reading <a href=\"http://stackoverflow.com/questions/2727591/out-of-memory-when-creating-a-lot-of-objects-c-sharp\">Out of memory when creating a lot of objects C#</a> , I tried the following approach. This seems to be the common <code>Skip</code>/<code>Take</code> paradigm that many people use, with the added feature of saving memory.</p>\n\n<p>Note that <code>_conn</code> is created beforehand, and a temporary data context is created for each query, resulting in the associated entities being garbage collected.</p>\n\n<pre><code>int skipAmount = 0;\nbool finished = false;\n\nwhile (!finished)\n{\n    // Trick to allow for automatic garbage collection while iterating through the DB\n    using (var tempDataContext = new MyDataContext(_conn) {CommandTimeout = 600})\n    {               \n        var query =\n            (from record in tempDataContext.someTable\n             where [index is appropriate]\n             select record);\n\n        List&lt;workerLog&gt; logs = query.Skip(skipAmount).Take(BatchSize).ToList();\n        if (logs.Count == 0)\n        {\n            finished = true;\n            continue;\n        }\n\n        foreach( linqEntity l in logs )\n        {\n            // Do stuff with data from l\n        }\n\n        skipAmount += logs.Count;\n    }\n}\n</code></pre>\n\n<p>Now I have the desired behavior that memory usage doesn't increase at all as I am streaming through the data. Yet, I have a far worse problem: each <code>Skip</code> is causing the data to load more and more slowly as the underlying query seems to actually cause the server to go through all the data for all previous pages. While running the query each page takes longer and longer to load, and I can tell that this is turning into a quadratic operation. This problem has appeared in the following posts:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/5261717/linq-skip-problem\">LINQ Skip() Problem</a></li>\n<li><a href=\"http://stackoverflow.com/questions/8202907/linq2sql-select-orders-and-skip-take\">LINQ2SQL select orders and skip/take</a></li>\n</ul>\n\n<p>I can't seem to find a way to do this with LINQ that allows me to have limited memory use by paging data, and yet still have each page load in constant time. Is there a way to do this properly? <strong>My hunch is that there might be some way to tell the DataContext to explicitly forget about the object in the first approach above, but I can't find out how to do that.</strong></p>\n"},{"tags":["c#","linq","expression-trees"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":99,"score":3,"question_id":12957567,"title":"Filter a hierarchical list using linq","body":"<p>Here is my model for Product</p>\n\n<pre><code>public class Product\n{\n    public string Name{ get; set; }\n\n    public int ProductNumber{ get; set; }\n\n    public List&lt;Product&gt; ProductList { get; set; }\n}\n\n//// below is the structure of the list\nIList&lt;Product&gt; rootList = new List&lt;Product&gt;\n            {\n                new Product \n                { \n                    ProductNumber = 1, Name = \"A\", \n                    ProductList = new List&lt;Product&gt; { new Product { ProductNumber = 2, Name = \"A1\", \n                        ProductList = new List&lt;Product&gt; { new Product { ProductNumber = 3, Name = \"A2\", ProductList = new List&lt;Product&gt;()} }}  \n                    }\n                },\n\n                new Product \n                { \n                    ProductNumber = 4, Name = \"B\", \n                    ProductList = new List&lt;Product&gt; { new Product { ProductNumber = 5, Name = \"B1\", \n                        ProductList = new List&lt;Product&gt; { new Product { ProductNumber = 6, Name = \"B2\", ProductList = new List&lt;Product&gt;()} }}  \n                    }\n                },\n\n                 new Product \n                { \n                    ProductNumber = 7, Name = \"C\", \n                    ProductList = new List&lt;Product&gt; { new Product { ProductNumber = 8, Name = \"C1\", \n                        ProductList = new List&lt;Product&gt; { new Product { ProductNumber = 9, Name = \"C2\", ProductList = new List&lt;Product&gt;()} }}  \n                    }\n                }\n            };\n</code></pre>\n\n<p>I need to filter the above list which contain the ProductNumber less than 5, ie. the output is expected to be a list of Product which has product numbers less than 5. </p>\n\n<p>is there any extensions available? Please help.</p>\n\n<p>Here my expected result </p>\n\n<pre><code>            Product \n            { \n                ProductNumber : 1, \n                Name : \"A\", \n                ProductList : { { \n                          ProductNumber : 2, \n                          Name : \"A1\", \n                          ProductList :{ { \n                                  ProductNumber = 3, \n                                  Name : \"A2\", \n                                  ProductList : null} }}  \n                }\n            },\n\n            Product \n            { \n                ProductNumber : 4, \n                Name : \"B\"\n                ProductList : null\n            } \n</code></pre>\n"},{"tags":["c#","linq","linq-to-sql","lambda","linq-to-entities"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12954288,"title":"Adding additional information to a list from a linq-to-entities query","body":"<p>I am trying to find a more efficient way to add additional information to a list from a query. For example, if I have a list of objects with the ObjectID and StringA set, I would like to query the database based on ObjectID to retrieve StringB and StringC:</p>\n\n<pre><code>public class SomeObject {\n    public int ObjectID { get; set; }\n    public string StringA { get; set; }\n    public string StringB { get; set; }\n    public string StringC { get; set; }\n}\n\npublic void AddInformationToSomeObjects(List&lt;SomeObject&gt; someObjects)\n{\n    var listOfIDs = someObjects.Select(so =&gt; so.ObjectID).ToList();\n    var informationToAdd = db.Table.Where(t =&gt; listOfIDs.Contains(t.ObjectID)).Select(t =&gt; new { ObjectID = t.ObjectID, StringB = t.StringB, StringC = t.StringC }).ToList();\n\n    foreach (var someObject in someObjects)\n    {\n        var information = informationToAdd.Where(i =&gt; i.ObjectID == someObject.ObjectID).FirstOrDefault();\n        someObject.StringB = information.StringB;\n        someObject.StringC = information.StringC;\n    }\n}\n</code></pre>\n\n<p>Is there any way to combine the query and the assignment into one statement?</p>\n"},{"tags":[".net","linq","extension-methods","mergesort"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12816535,"title":"LINQ merge sort for multiple sources","body":"<p>I have several \"data sources\", each of which provides ordered timestamped data. I'd like to flatten it into a single ordered stream (like merge sort). <a href=\"http://stackoverflow.com/a/7718337/1488067\">This answer</a> describes how to do it for two enumerables, but I am not sure how to generalize it.</p>\n\n<p>Data sources are <strong>huge</strong>, so I cannot do it in memory, it has to be streamed.</p>\n\n<p>To explain it with an example, I have something like this:</p>\n\n<pre><code>interface IDataSource\n{\n    IEnumerable&lt;DateTime&gt; GetOrderedRecords();\n}\n</code></pre>\n\n<p>I would like to be able to have an extension method like this:</p>\n\n<pre><code>// get all sources\nIEnumerable&lt;IDataSource&gt; dataSources = GetAllSources();\n\n// merge sort\nIEnumerable&lt;DateTime&gt; flattened = dataSources\n    .MergeSort(s =&gt; s.GetOrderedRecords());\n</code></pre>\n\n<p><strong>[Edit]</strong></p>\n\n<p>The reason I can't load everything eagerly and then sort it is because I am loading data from multiple databases and exporting it into a different one. Each <code>IDataSource</code> is basically Linq-to-NHibernate under the hood, and I have millions of data rows to return.</p>\n\n<p>So what I need is something like:</p>\n\n<ol>\n<li>From all available sources, load the next timestamp.</li>\n<li>Store it to disk and \"forget it\".</li>\n</ol>\n\n<p>Data sources are already sorted, which makes the \"merge sort\" approach feasible.</p>\n"},{"tags":["linq","entity-framework","lambda","listbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12959373,"title":"Error getting items from Entity Framework using Lambda query","body":"<p>I have a listbox that I am trying to populate with the result of a SQL Server query via a Entity Framework linq/lambda query. I am feeding the query with a value from a combobox.  I keep getting lot of errors like the following:  Unable to create a constant value of type 'System.Object'. Only primitive types ('such as Int32, String, and Guid') are supported in this context.</p>\n\n<p>Any suggestions on how to fix this?  I just want two fields to populate in a grid</p>\n\n<pre><code>       var pAt = ent.Patterns.Where(p =&gt; p.Case_Id == (cbCase.SelectedItem as Case).Case_Id).Select(x =&gt; new  Pattern{  PatternID = x.PatternID, Pattern1 = x.Pattern1 });\n\n        listBox1.DataSource = pAt;\n        listBox1.ValueMember = \"PatternID\";\n        listBox1.DisplayMember = \"Pattern1\";\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":1,"up_vote_count":15,"down_vote_count":0,"view_count":9627,"score":15,"question_id":1764970,"title":"Linq used to find index of value","body":"<p>Can linq somehow be used to find the index of a value in an array?</p>\n\n<p>For instance, this loop locates the key index within an array.</p>\n\n<pre><code>for (int i = 0; i &lt; words.Length; i++)\n{\n    if (words[i].IsKey)\n    {\n        keyIndex = i;\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","linq","c#-3.0"],"answer_count":5,"favorite_count":4,"up_vote_count":32,"down_vote_count":0,"view_count":20418,"score":32,"question_id":2471588,"title":"How to get index using LINQ?","body":"<p>Given a datasource like that:</p>\n\n<pre><code>var c = new Car[]\n{\n  new Car{ Color=\"Blue\", Price=28000},\n  new Car{ Color=\"Red\", Price=54000},\n  new Car{ Color=\"Pink\", Price=9999},\n  // ..\n};\n</code></pre>\n\n<p>How can I find the <strong>index</strong> of the first car satisfying a certain condition with LINQ?</p>\n\n<p>EDIT:</p>\n\n<p>I could think of something like this but it looks horrible:</p>\n\n<pre><code>int firstItem = someItems.Select((item, index) =&gt; new    \n{    \n    ItemName = item.Color,    \n    Position = index    \n}).Where(i =&gt; i.ItemName == \"purple\")    \n  .First()    \n  .Position;\n</code></pre>\n\n<p>Will it be the best to solve this with a plain old loop?</p>\n"},{"tags":["linq","object","reference"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12957355,"title":"LINQ Object Referance not set","body":"<p>I am getting an \"Object Reference not set to an instance of an object\" error when searching for an item (on Guid) that is selected from a datagrid. I have checked that the item does return the Guid correctly (by writing it to a label on the page), however in my linq query (i assume) i am comparing incorrectly.</p>\n\n<p>ctx is the domaindatasource, I know the element im trying to remove exists.</p>\n\n<pre><code>      private void medItemRemove_Click(object sender, RoutedEventArgs e)\n    {\n\n            MedicineInventory M = (MedicineInventory)medicineInventoryDataGrid.SelectedItem;\n            Guid Mid = M.MedicineInventoryId;\n            MedicineInventory toRemove = new MedicineInventory();\n            toRemove = (from a in ctx.MedicineInventories where (a.MedicineInventoryId == Mid) select a).Single();\n            ctx.MedicineInventories.Remove(toRemove);\n            ctx.SubmitChanges();\n\n        }\n</code></pre>\n"},{"tags":["linq","selectmany"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12958442,"title":"LINQ Extension method .SelectMany() written in another form","body":"<p>How to write this LINQ expression in another .SelectMany() form ?</p>\n\n<pre><code>var result = \n                    from a in numbersA\n                    where a &lt; 3\n                    from b in numbersB\n                    where b &lt; 5\n                    select new { a, b };\n</code></pre>\n\n<p>?</p>\n\n<p><code>var result = numbersA.Where(x =&gt; x &lt; 3).Select</code>.. ?</p>\n"},{"tags":["c#","linq","dynamics-crm-2011"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":12956563,"title":"CRM 2011 linq and saved query","body":"<p>Is it possible to use CRM 2011 View (savedquery) with linq? I mean can I do something like this:</p>\n\n<pre><code>IEnumerable&lt;Opportunity&gt; GetOpportunites(CrmOrganizationServiceContext context, string viewName, Guid customerId)\n{\n    var view = context.CreateQuery&lt;SavedQuery&gt;().FirstOrDefault(q =&gt; q.Name == viewName);\n    if(view!=null)\n       return from Opportunity op in view\n           where op.CustomerId.Id == customerId\n           select op;\n           return new List&lt;Opportunity&gt;();\n}\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12956523,"title":"Ordering and concatenating two lists of different types","body":"<p>I have two very similar tables in my database (tblCar and tblPlane).\nThey have the same columns, only tblCar's start with car_, and tblPlane's start with pl_.\nIe car_id, pl_id etc.</p>\n\n<p>I get the rows from the tables and concatenate them:</p>\n\n<pre><code>var cars = (from x in db.tblCar select x).ToList();\nvar planes = (from x in db.tblPlane select x).ToList();\nvar result = cars.Cast&lt;object&gt;().Concat(planes.Cast&lt;object&gt;());\n</code></pre>\n\n<p>And it works fine.</p>\n\n<p>But, both tables have a column for date of update: cat_update and pl_update. Its type is DateTime and I need to order the result list by this column, newest first.</p>\n\n<p>How to make the ordering when the properties have different names?</p>\n"},{"tags":["linq","entity-framework","linq-to-entities"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12956890,"title":"Linq Sentece Time out","body":"<p>I have a big one problem on linq, i have one sentence to fill one telerikRadGrid, is this: </p>\n\n<pre><code>    var coleccion = (from tab in tabReclamo\n                     join tabI in tabIntermediario on tab.IdIntermediario equals tabI.Id\n                     join tabR in tabReclamoEstatus on tab.IdReclamosEstatus equals tabR.IdReclamosEstatus\n                     join tabP in tabProveedor on tab.IdProveedor equals tabP.Id\n                     join tabS in tabServicio on tab.CodigoServicio equals tabS.CodigoServicio\n                     join tabA in tabAfiliado on tab.IdAfiliado equals tabA.Id\n                     join tabCert in tabCertificado on tabA.IdCertificado equals tabCert.Id\n                     join tabPo in tabPoliza on tabCert.IdPoliza equals tabPo.Id into x\n                     from y in x.DefaultIfEmpty()\n                     select new ReclamoDTO\n                     {\n                     Id = tab.Id,\n                     ReclamoId = tab.ReclamoId\n\n                     });\n\n                Conteo = coleccionconteo;\n                return UtilidadesDTO&lt;ReclamoDTO&gt;.EncriptarId(coleccion);\n            }\ncoleccion.count(); //count All registers on BD\ncoleccion.Skip((pagina - 1) * registros).Take(registros); // make pagination\n</code></pre>\n\n<p>the problem is that the firs sentence give me timeout becouse the BBDD have around 3KK of register, all joins made are necesary, how i can make pagination and count the total on one sentence??? or i need make one sentence that count, and another whit make the pagination. i try make the sentence linq whit skip and take but i dont know the real total of reg on BBDD.</p>\n\n<p>thanks.</p>\n\n<p>Sorry for my English</p>\n"},{"tags":["c#","linq","find"],"answer_count":7,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":96,"score":4,"question_id":12954976,"title":"How to find similar objects in a collection","body":"<p>I want to find similar objects in a collection depending on a <strong>Method I implement</strong>   </p>\n\n<p>for example this sample class:</p>\n\n<pre><code>class myObj\n{\n    public int Data1 { get; set; }\n\n    public int Data2 { get; set; }\n\n    public int Data3 { get; set; }        \n}\n</code></pre>\n\n<p>then implement <strong>Similar</strong> method in the class:</p>\n\n<pre><code>public bool Similar(myObj obj)\n{\n    if (obj.Data1 == this.Data1 &amp;&amp; obj.Data2 == this.Data2)\n        return true;\n    return false;\n}\n</code></pre>\n\n<p>now I have this collection:</p>\n\n<pre><code>List&lt;myObj&gt; items = new List&lt;myObj&gt;();\n// none similar\nitems.Add(new myObj() { Data1 = 1, Data2 = 2, Data3 = 4 });\nitems.Add(new myObj() { Data1 = 2, Data2 = 3, Data3 = 18 });\nitems.Add(new myObj() { Data1 = 3, Data2 = 4, Data3 = 75 });\nitems.Add(new myObj() { Data1 = 4, Data2 = 2, Data3 = 3 });\n//similar\nitems.Add(new myObj() { Data1 = 5, Data2 = 26, Data3 = 97 });\nitems.Add(new myObj() { Data1 = 5, Data2 = 26, Data3 = 37 });\nitems.Add(new myObj() { Data1 = 10, Data2 = 45, Data3 = 47 });\nitems.Add(new myObj() { Data1 = 10, Data2 = 45, Data3 = 19 });\n</code></pre>\n\n<p>to get the similar objects I did this:</p>\n\n<pre><code>private static List&lt;myObj&gt; GetSimilars(List&lt;myObj&gt; items)\n{\n    List&lt;myObj&gt; similars = new List&lt;myObj&gt;();\n    while (items.Count &gt; 0)\n    {\n        var q = (from c in items\n                 where c.Similar(items[0])\n                 select c).ToList();\n\n        if (q.Count &gt; 1)\n        {\n            similars.AddRange(q);\n            foreach (var obj in q)\n                items.Remove(obj);\n        }\n        else\n            items.Remove(items[0]);\n    }    \n    return similars;\n}\n</code></pre>\n\n<p>is there a beeter way to do that.</p>\n"},{"tags":["linq","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":12951530,"title":"How do i find interfaces that are anyhow related to the class?","body":"<p>I have an issue, i need to list all the interfaces that are anyhow related to the class? \nFor ex:</p>\n\n<pre><code>class Test : interface1\n{\n    public int var1;\n\n    classA obj1;\n    classB obj2;\n    classC obj3;\n}\n\nclass classA: interface2\n{\n    testclass obj;\n}\n\nclass classB: interface3\n{\n}\n\nclass classC: interface4\n{\n}\n\nclass testclass: testinterface\n{ \n   myinterface objInterface;\n}\ninterface myinterface{}\n</code></pre>\n\n<p>My question is how do I list all the interfaces of class Test (it should return all the interfaces anyhow related to the class ex:. interface1, interface2 etc.,).</p>\n\n<p>Anyone help me please?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#","asp.net-mvc","linq","datagrid","export-to-excel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12942871,"title":"export to excel give me checkbox instead of string","body":"<p>so I am doing the datasource export to excel, but i open the file i saw the column has checkbox instead of value true or false. how do i fixed this, indeed, i want to put a sting \"active\" or \"inactive\" depends on the value. how can i do that?</p>\n\n<p>also i want to have string format for the phone number as well</p>\n\n<p>and the code i have for model</p>\n\n<pre><code>  public string MobileNumber { get; set; }\n  public bool? IsActive { get; set; }\n</code></pre>\n\n<p>how do i change in order for me to have the way that i want it ?</p>\n"},{"tags":["c#","linq","programming-fundamentals"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12951411,"title":"Replace value in DataColumn","body":"<p>How to replace column value when looping rows?</p>\n\n<p>My DataTable has two columns, I want to replace the value of the first column on every row.\nI'm unable to get or set column value. So far I only manege to access DefaultValue and ColumnName etc. </p>\n\n<p>Even if creating new DataColumn(), I'm not able to set its value.</p>\n\n<p>Feels like I'm missing some fundamental stuff here...</p>\n\n<pre><code>        foreach (var row in dataTable.Rows)\n        {\n            foreach (DataColumn column in dataTable.Columns)\n            {\n                // column Unable to get or set value\n            }\n\n        }\n</code></pre>\n\n<p>Running .NET Framework 3.5, should I use linq?</p>\n"},{"tags":["c#","linq","entity-framework","distinct"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":957,"score":2,"question_id":8536129,"title":"Distinct in Entity framework","body":"<p>I have a List of objects that some of them have the same Ids, so I would like to remove those elements that are duplicated. </p>\n\n<p>I tried with something like this:</p>\n\n<pre><code>List&lt;post&gt; posts = postsFromDatabase.Distinct().ToList();\n</code></pre>\n\n<p>But it doesn't work!</p>\n\n<p>So I wrote this method in order to avoid the duplicates:</p>\n\n<pre><code>public List&lt;Post&gt; PostWithOutDuplicates(List&lt;Post&gt; posts)\n    {\n        List&lt;Post&gt; postWithOutInclude = new List&lt;Post&gt;();\n        var noDupes = posts.Select(x =&gt; x.Id).Distinct();\n        if (noDupes.Count() &lt; posts.Count)\n        {\n            foreach (int idPost in noDupes)\n            {\n                postWithOutInclude.Add(posts.Where(x =&gt; x.Id == idPost).First());\n            }\n            return postWithOutInclude;\n        }\n        else\n        {\n            return posts;\n        }\n    }\n</code></pre>\n\n<p>Any ideas of how to improve the performance??</p>\n\n<p>Thanx in advance.</p>\n"},{"tags":["c#","html","linq","xpath","html-agility-pack"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1583,"score":1,"question_id":10513529,"title":"Getting data from HTML table into a datatable","body":"<p>Ok so I need to query a live website to get data from a table, put this HTML table into a DataTable and then use this data. I have so far managed to use Html Agility Pack and XPath to get to each row in the table I need but I know there must be a way to parse it into a DataTable. (C#) The code I am currently using is:</p>\n\n<pre><code>string htmlCode = \"\";\nusing (WebClient client = new WebClient())\n{\nhtmlCode = client.DownloadString(\"http://www.website.com\");\n}\nHtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();\n\ndoc.LoadHtml(htmlCode);\n\n//My attempt at LINQ to solve the issue (not sure where to go from here)\nvar myTable = doc.DocumentNode\n.Descendants(\"table\")\n.Where(t =&gt;t.Attributes[\"summary\"].Value == \"Table One\")\n.FirstOrDefault();\n\n//Finds all the odd rows (which are the ones I actually need but would prefer a\n//DataTable containing all the rows!\nforeach (HtmlNode cell in doc.DocumentNode.SelectNodes(\"//tr[@class='odd']/td\"))\n{\nstring test = cell.InnerText;\n//Have not gone further than this yet!\n}\n</code></pre>\n\n<p>The HTML table on the website I am querying looks like this: </p>\n\n<pre><code>&lt;table summary=\"Table One\"&gt;\n&lt;tbody&gt;\n&lt;tr class=\"odd\"&gt;\n&lt;td&gt;Some Text&lt;/td&gt;\n&lt;td&gt;Some Value&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr class=\"even\"&gt;\n&lt;td&gt;Some Text1&lt;/td&gt;\n&lt;td&gt;Some Value1&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr class=\"odd\"&gt;\n&lt;td&gt;Some Text2&lt;/td&gt;\n&lt;td&gt;Some Value2&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr class=\"even\"&gt;\n&lt;td&gt;Some Text3&lt;/td&gt;\n&lt;td&gt;Some Value3&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr class=\"odd\"&gt;\n&lt;td&gt;Some Text4&lt;/td&gt;\n&lt;td&gt;Some Value4&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I'm not sure whether it is better/easier to use LINQ + HAP or XPath + HAP to get the desired result, I tried both with limited success as you can probably see. This is the first time I have ever made a program to query a website or even interact with a website in any way so I am very unsure at the moment! Thanks for any help in advance :)</p>\n"},{"tags":["linq","left-join"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12948894,"title":"Linq and sub left outer join","body":"<p>how can i write something like this</p>\n\n<pre><code>From p In DB.Tab1s\n    Group Join gf In DB.Tab2s On p.PSDF_PGF_PK Equals gf.PGF_PK Into gf1 = Group From g In gf1.DefaultIfEmpty()\n    Group Join gff In DB.Tab3s On gff.PFL_PK Equals **gf1.PGF_PFL_PK** Into ggff = Group From gff In ggff.defaultifempty()\n</code></pre>\n\n<p>For the second join (gff.PFL_PK Equals gf1.PGF_PFL_PK) VB tells me that PGF_PFL_PK is not a member of gf1 but it is of type IEnumerable(of Tab2, which does include that field</p>\n\n<p>Edit: Solved ... sorry was a type error ...</p>\n"},{"tags":["c#","linq","datatables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12948843,"title":"Get the Columns of an Inner Join LINQ query","body":"<p>I am trying to inner join 2 DataTables on 2 DataColumns using Linq, I can get the rows using Linq how ever I cannot get the columns. I have commented out what I tried to do to get the columns, shown below.</p>\n\n<p><strong>The reason for doing this.</strong></p>\n\n<p>I am planning on making 3 methods, LEFT JOIN, FULL JOIN and INNER JOIN that will return a DataTable, I am trying to make it as generic as possible, I am not show if the below is a good way or not, I need to do this to be as Optimized as possible.</p>\n\n<pre><code>     public static DataTable InnerJoin\n     (DataTable dt1, DataTable dt2,DataColumn Parent,DataColumn Child)\n     {\n          DataTable result = new DataTable();\n\n\n          var query =\n              from d in dt1.AsEnumerable()\n              join c in dt2.AsEnumerable() on d[Parent] equals c[Child]\n              select new { d, c };\n         /*\n         var columns  = from d in dt1.Columns.Cast&lt;DataColumn&gt;()\n                        from c in dt2.Columns.Cast&lt;DataColumn&gt;()\n                          select new{c,d}\n          foreach (var column in columns)\n          {\n              result.Columns.Add(column);\n          }\n          **/\n\n          foreach (var row in query)\n          {\n              result.Rows.Add(row);\n          }\n\n         return result;\n     }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12947839,"title":"finding duplicates for two columns entries in datatable using LINQ","body":"<p>I have a datatable dt which has supplierId and SubsystemId as 2 of its columns  .\nI want to find if there is any duplicate entries for the combination of these two column values .</p>\n\n<p>I am a starter to Linq . How can I do this ?</p>\n"},{"tags":["c#","linq","if-statement","conditional"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":66,"score":-2,"question_id":12948665,"title":"C# LINQ, expressing non-emptiness of resulting enumerables","body":"<p>I want to do something like this:</p>\n\n<pre><code>references\n.Where(r=&gt;r.Matches.Any(m=&gt;m.IsTPMatch) &amp;&amp; TPClassifier.IsTP(r,detection,s)).\n.OrderBy(r=&gt; new Match(r,detection).Pascal)\n.First()\n.Matches\n.First(m=&gt;m.IsTPMatch)\n.Link(detection);\n</code></pre>\n\n<p>Where Link modifies my detection.</p>\n\n<p>First of all, I get \"Only Assignment, call, increment, decrement and new object expressions can be used as a statement\", which I don't really understand, but given that I manage to get around that, I also need to add a check for non-emptiness after my Where clause, since I will otherwise get an error when doing \"First()\", I can't do FirstOrDefault (I think).</p>\n\n<p>If my query is translated into common language it would be something like</p>\n\n<pre><code>take a subset\nsort it\ntake the first\ntake a part of that\ntake the first\nand do a function call on it.\n</code></pre>\n\n<p>What I would like is:</p>\n\n<pre><code>take a subset\nif there is at least one element\nsort it\n...\n</code></pre>\n\n<p>Matches can be assumed to have elements. </p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["linq","dapper"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12916091,"title":"Project dynamic Dapper results excluding some properties","body":"<p>Given a dynamic Dapper query such as:</p>\n\n<pre><code>var results = connection.Query&lt;dynamic&gt;(\"SELECT ....\");\n</code></pre>\n\n<p>I want to remove a couple of the returned columns/properties from the results. The trick is I want to do this without knowing/caring the names of the properties I want to keep, otherwise I would simply project the results into a new anonymous type.</p>\n\n<p>I attempted to loop through the results and cast each to an <code>IDictionary&lt;string, object&gt;</code> so that I could simply remove the key/value pair holding the data. Unfortunately, for whatever reason, the underlying internal FastExpando object doesn't implement the Remove method. <a href=\"https://github.com/SamSaffron/dapper-dot-net/blob/master/Dapper/SqlMapper.cs#L1303\" rel=\"nofollow\">The source code for FastExpando</a> shows:</p>\n\n<pre><code>bool IDictionary&lt;string, object&gt;.Remove(string key)\n{\n    throw new NotImplementedException();\n}\n</code></pre>\n\n<p>How can I implement this? To be clear I basically want:</p>\n\n<pre><code>var filteredResults = from r in results\n                      select new { // All properties except a couple of well-known ones }\n</code></pre>\n"},{"tags":["linq",".net-3.5"],"answer_count":5,"favorite_count":3,"up_vote_count":23,"down_vote_count":1,"view_count":1081,"score":22,"question_id":66,"title":"Paging a collection with LINQ","body":"<p>How do you page through a collection in LINQ given that you have a <code>startIndex</code> and a <code>count</code>?</p>\n"},{"tags":["linq","lambda","left-join"],"answer_count":4,"favorite_count":1,"up_vote_count":9,"down_vote_count":1,"view_count":4534,"score":8,"question_id":848640,"title":"Left join using LINQ","body":"<p>Could someone give me an example of how to perform a left join operation using LINQ/lambda expressions?</p>\n"},{"tags":["c#","asp.net-mvc","linq","sql-server-2008","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12929610,"title":"How to reset the identity column in C#?","body":"<p>I need to reset my identity field parametrically in MVC.net. I am using Linq and Entity Framework.</p>\n\n<p><strong>Reason:</strong> I am inserting thousands of records in my table by importing. I am importing records again after some period of time, so my id field value increasing so much </p>\n\n<p>For ex. In 100000000 so my field data type is Big int but it is not sufficient for my this value. So I need to reset my identity field. </p>\n"},{"tags":["c#","wpf","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":12919288,"title":"ICommand binding causing UI memory leak in WPF application","body":"<p>I'm building a WPF app that connects to a SQL Server database using LINQ to SQL.</p>\n\n<p>The main window of the app contains a <code>ListView</code> containing a series of detail views.\nThe <code>ItemSource</code> of the <code>ListView</code> is bound to a collection of detail view model objects exposed as a property on the root view model. \nEach detail view model object composes several <code>ICommand</code> properties as well as a property exposing a detail model object, which in turn exposes the various data fields shown in the UI. </p>\n\n<p>Analysis with the ANTS memory profiler shows that the objects being leaked are those contained in the detail model object, and some UI classes to which they are bound.\nInstances of these objects from previous refreshes are not being garbage collected. </p>\n\n<p>ANTS has a tool that allows the user to trace chains of reference to identify why unwanted memory is being retained.  When I use it, I find that all of the chains that show up have an <code>ICommand</code> in them. Accordingly, I've removed the offending <code>ICommand</code>, and found that \nthe memory leak disappears.</p>\n\n<p>Unfortunately, I need the <code>ICommand</code> to implement some important functionality. What is really confusing me is how it has a reference to the detail model object in the first place- they are two completely separate instance variables in the detail view model object.</p>\n\n<p>Here is the constructor of the detail view model object (The reference to the RootViewModel is used for callbacks in some of the methods connected to the ICommands. I originally suspected that this might be causing a circular chain of references that might be the cause of the problem, but removing it doesn't seem to have any effect.)</p>\n\n<pre><code>public CarDataViewModel(CarData carDataItem, RootViewModel parentViewModel)\n    {\n\n        _parentViewModel = parentViewModel;\n        CarDataModel = carDataItem;\n        CompetingCheckboxStatus = CarDataModel.CurrentCar.Competing;\n        AcknowledgeAlarm = new ParameterlessCommand(AcknowledgeAlarmClicked);\n        Acknowledge = new ParameterlessCommand(AcknowledgeClicked);\n        ShowReport = new ParameterlessCommand(ShowReportClicked);\n        Cancel = new ParameterlessCommand(CancelClicked);\n    }\n</code></pre>\n\n<p>Here's the xaml where the bindings are set up - AcknowledgeAlarm is the ICommand, CarDataModel is the detail model object:</p>\n\n<pre><code>&lt;ListView x:Name=\"itemGridView\"Grid.Row=\"1\"ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\" ItemsSource=\"{Binding CarDataViewModels}\" IsSynchronizedWithCurrentItem=\"True\" Margin=\"0,0,0,0\"&gt;\n        &lt;ListView.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;/DataTemplate.Resources&gt;\n                &lt;Button Command=\"{Binding AcknowledgeAlarm}\"&gt;\n                    &lt;Border DataContext=\"{Binding CarDataModel}\" BorderBrush=\"{StaticResource GrayFadeBrush}\" Background=\"White\" BorderThickness=\"5\"&gt;\n                        &lt;Grid&gt; . . .\n</code></pre>\n"},{"tags":["database","vb.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12943432,"title":"Display database information in listbox","body":"<p>I am trying to figure out how to display certain data from an access database based on the button click. For example, if I clicked the Stock button then it would display the items from the database where the item is out of stock. I am able to open the connection and display query information but it is a long LINQ query that I am not sure where it came from. Any suggestions on how to display the database information? i.e. customer information, stock items, etc...</p>\n\n<pre><code>Option Strict On\n\nImports System.Data.OleDb\n\nPublic Class frmMicroland\n\nDim con As New OleDbConnection\n\nPrivate Sub btnStockItems_Click(sender As System.Object, e As System.EventArgs) Handles btnStockItems.Click\n\n    Dim query1 = From anyOrder In MICROLANDDataSet.Orders\n                Join itsStockItem In MICROLANDDataSet.Inventory\n                On anyOrder.itemID Equals itsStockItem.itemID\n                Let orderQuantity = anyOrder.quantity\n                Select itsStockItem.quantity, itsStockItem.description, anyOrder.itemID\n                Order By quantity, itemID\n\n\n    ''Test connection to make sure it opens first\n    Try\n        con = New OleDb.OleDbConnection(\"provider= microsoft.ace.oledb.12.0;Data Source = C:\\Users\\HPG62-220US\\Documents\\Visual Studio 2010\\Projects\\Asignment 9\\Asignment 9\\bin\\Debug\\MICROLAND.accdb; Persist Security Info=False;\")\n        Try\n            Call con.Open()\n        Catch ex As Exception\n            MessageBox.Show(\"Could not connect\")\n        End Try\n\n        If con.State = ConnectionState.Open Then\n            MessageBox.Show(\"Connection is open\")\n        End If\n    Catch ex As Exception\n    End Try\n\n    lstOutput.Items.Add(\"Here are the items that are out of\")\n    lstOutput.Items.Add(\"inventory or must be reordered.\")\n    lstOutput.Items.Add(\"\")\n    lstOutput.Items.Add(\"The numbers shown give the\")\n    lstOutput.Items.Add(\"minimum reorder quantity required.\")\n    lstOutput.Items.Add(\"\")\n    lstOutput.Items.Add(query1)\n    con.Close()\nEnd Sub\n\nPrivate Sub btnTodaysOrders_Click(sender As System.Object, e As System.EventArgs) Handles btnTodaysOrders.Click\n\nEnd Sub\nEnd Class\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12941931,"title":"Can't insert into database using linq","body":"<p>I'm trying to insert a group of people into a database table. I can select from the database without problems but when I try to enter I get</p>\n\n<pre><code>Cannot add an entity with a key that is already in use\n</code></pre>\n\n<p>I know what this means but why is it happening. I have increment on the tables id. Here's my code.</p>\n\n<pre><code>    public static List&lt;Person&gt; GetPeople(DataContext db)\n        {\n            List&lt;Person&gt; people = new List&lt;Person&gt;();            \n            Table&lt;Person&gt; People = db.GetTable&lt;Person&gt;();\n\n            for (int i = 0; i &lt; 5; i++)\n            {\n                Person pers = new Person();\n                pers.PersFirstName = \"Wesley \" + i;                \n                //pers.PersId is the primary key that I want to auto-increment and not have to set it here\n                people.Add(pers);            \n            }\n            People.InsertAllOnSubmit(people);\n            People.Context.SubmitChanges();\n\n            IQueryable&lt;Person&gt; query =\n            from person in People\n            select person;\n\n\n            return people;\n        }\n</code></pre>\n\n<p>The problem happens at the line </p>\n\n<pre><code>People.InsertAllOnSubmit(people);\n</code></pre>\n\n<p>Is there some special way i have to set up auto-increment with Linq?</p>\n"},{"tags":["c#","linq","debugging","visualizer"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":140,"score":2,"question_id":12941433,"title":"LINQ to SQL debug visualizer for VS 2012?","body":"<p>I'm looking for the Linq to SQL debug visualizer for VS 2012.</p>\n\n<p>I found out that you needed to import <code>Microsoft.VisualStudio.DebuggerVisualizers.dll</code> in<br>\nC:\\Program Files (x86)\\Microsoft Visual Studio 11.0\\Common7\\Packages\\Debugger\\Visualizer</p>\n\n<p>But I only found these 4 dll's:<br>\n- Microsoft.VisualStudio.Debugger.DataSetVisualizer.dll<br>\n- Microsoft.VisualStudio.Debugger.WpfTreeVisualizer.dll<br>\n- Microsoft.VisualStudio.Diagnostics.Common<br>\n- Microsoft.VisualStudio.Tools.Office.Debugger</p>\n\n<p>None of the above are working. </p>\n"},{"tags":["c#","linq","sorting","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12941757,"title":"Using Linq lambdas, how can I get the first item in a two-key-sorted list?","body":"<p>I know this is simple, but my mind is playing tricks on me right now.  If we have a flat list of objects with the properties GroupSortIndex and ItemSortIndex (within the group) and we want to find the first item in the list, what's the Linq/lambda for that?</p>\n\n<p>About all I can think of is (meta, not literal code...)</p>\n\n<pre><code>var soughtItem = Source.OrderBy(ItemSortIndex).OrderBy(GroupSortIndex).ToList()[0]\n</code></pre>\n\n<p>...but that just looks so wrong to me for some reason.</p>\n"},{"tags":["linq","generics"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12942238,"title":"Change snippet into a Generic Linq Method","body":"<p>I use the following snippet of code to get the either the min or max Primary Key from a table via EF:</p>\n\n<pre><code>using (var myContext = new My_Entities())\n{\n   int pknum = 0;\n\n   if (Config.Application.UseNegativePK)\n   {\n      pknum = (from pknums in myContext.TableName select pknums.TabNum).Min();\n   }\n   else\n   {\n      pknum = (from pknums in myContext.TableName select pknums.TabNum).Max();\n   }                                }\n}\n</code></pre>\n\n<p>Since I use this use this snippet quite often in my project I want to convert it into a method so I tried the following</p>\n\n<pre><code>private Int32 GetNextPK&lt;T&gt;(T entity)\n{\n   using (var contextIAPro = new IAPro_Entities())\n   {\n      contextIAPro.Database.Connection.ConnectionString = Config.Databases.TargetDBValues.ConnectionString;\n\n      Int32 pknum = 0;\n\n      if (Config.Application.UseNegativePK)\n      {\n         pknum = (from pknums in (System.Data.Entity.DbSet&lt;T&gt;)entity select pknums.PK).Min();\n      }\n      else\n      {\n         pknum = (from pknums in (System.Data.Entity.DbSet&lt;T&gt;)entity select pknums.PK).Max();\n       }\n          return pknum;\n       }\n}\n</code></pre>\n\n<p>I am receiving an error in the two when I try to Cast the entity variable into a System.Data.Entity.DbSet, what am I doing wrong?</p>\n\n<p>FYI, each table's primary key is unique to each table, I have created a new property in each table's class called PK which only has a getter that will return the primary key for that particular table.</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":12941794,"title":"LINQ Query with Aggregates and Group By","body":"<p>i have the following SQL query...</p>\n\n<pre><code>    select  seaMake AS Make,\n        seaModel AS Model,\n        COUNT(*) AS [Count],\n        MIN(seaPrice) AS [From],\n        MIN(seaCapId) AS [CapId]\nfrom tblSearch \nwhere seaPrice &gt;= 2000\nand seaPrice &lt;= 7000\ngroup by seaMake, seaModel\norder by seaMake, seaModel\n</code></pre>\n\n<p>Im trying to write this as a LINQ to Entities Query, but im having problems. This is what i have so far but i cannot access the make and model values from the var S</p>\n\n<pre><code>var tester = from s in db.tblSearches\n             where s.seaPrice &gt;= 2000\n             &amp;&amp; s.seaPrice &lt;= 7000\n             orderby s.seaMake\n             group s by s.seaMake into g\n             select new\n             {\n                 make = g.seaMake,\n                 model = s.seaModel,\n                 count = g.Max(x =&gt; x.seaMake),\n                 PriceFrom = g.Min(s.seaPrice)\n              };\n</code></pre>\n\n<p>Where am i going wrong ?</p>\n"},{"tags":["c#","asp.net-mvc","asp.net-mvc-3","linq","entity"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12941901,"title":"Selecting several objects based on array of IDs","body":"<p>I have an array of ProgramIDs and would like to create a number of Select statements dynamically depending on how many ProgramIds there are.</p>\n\n<p>For example:</p>\n\n<pre><code>  var surveyProgramVar = surveyProgramRepository.Find().Where(x =&gt; x.ProgramId == resultsviewmodel.ProgramIds.FirstOrDefault());\n</code></pre>\n\n<p>This is an example of the select statement working with a single ProgramId.FirstOrDefault().  How do I create a list/array of SurveyProgramVars and select for each ProgramIds in the array?</p>\n"},{"tags":["linq","c#-4.0","lambda","parallel-processing","parallel-extensions"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":12941514,"title":"Are lambda faster than linq queries?","body":"<p>Iam playing with lambda, linq and parallel and one question arrives.</p>\n\n<p>Is lambda faster than linq queries?</p>\n\n<p>O write some test code (<a href=\"https://github.com/Ewerton/LinqAndLambdaPerformanceTest/blob/master/Program.cs\" rel=\"nofollow\">Fork it in GitHub</a>) and the lambda method seems faster. It is true or i am missing something?</p>\n"},{"tags":["c#","linq","dry"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12941620,"title":"Creating an abstraction for two similar methods which have linq methods","body":"<p>I have two methods which are very close, and want to create one method that I can call to keep my code DRY</p>\n\n<pre><code>public IEnumerable&lt;HighScoreViewModel&gt; GetNightlyHighScores()\n{\n    lock (_Key)\n    {\n        //return GetHighScores(x =&gt; x.NightlyHighScore);\n\n        return _allPlayers\n            .OrderByDescending(x =&gt; x.NightlyHighScore)\n            .Take(8)\n            .Select(x=&gt; new HighScoreViewModel\n            {\n                Points = x.NightlyHighScore,\n                PointsText = \"FG: \" + x.NightlyHighScore,\n                ImageUrl = x.Facebook.SmallImageUrl,\n                DisplayName = x.DisplayName,\n            }).ToList();\n    }\n}\n\npublic IEnumerable&lt;HighScoreViewModel&gt; GetBestHighScores()\n{\n    lock (_Key)\n    {\n        //return GetHighScores(x =&gt; x.BestHighScore);\n\n        return _allPlayers\n            .OrderByDescending(x =&gt; x.BestHighScore)\n            .Take(8)\n            .Select(x =&gt; new HighScoreViewModel\n            {\n                Points = x.BestHighScore,\n                PointsText = \"FG: \" + x.BestHighScore,\n                ImageUrl = x.Facebook.SmallImageUrl,\n                DisplayName = x.DisplayName,\n            }).ToList();\n    }\n}\n</code></pre>\n\n<p>I'm close to something, but can't figure out the bits marked \"magic\"</p>\n\n<pre><code>public IEnumerable&lt;HighScoreViewModel&gt; GetHighScores&lt;TKey&gt;(Func&lt;Player, TKey&gt; highscore)\n{\n    return _allPlayers\n        .OrderByDescending(highscore)\n        .Take(8)\n        .Select(x =&gt; new HighScoreViewModel\n        {\n            // Magic?\n            //Points = x.BestHighScore,\n            PointsText = \"FG: \" + x.BestHighScore,\n            //ImageUrl = x.Facebook.SmallImageUrl,\n            DisplayName = x.DisplayName,\n        }).ToList();\n}\n</code></pre>\n"},{"tags":["c#","linq","entity-framework","tsql","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":11474469,"title":"How do I get a lambda query that is like this tsql query?","body":"<p>Having a T-SQL query:</p>\n\n<pre><code>select [ProductNumber] ,max([ProductRevNumber])\nfrom Products  \ngroup by [ProductNumber]\n</code></pre>\n\n<p>Attempted LINQ query:</p>\n\n<pre><code>ProductsDBContext.Products.GroupBy(x =&gt; x.ProductRevNumber)\n                          .Select(group =&gt; ProductNumber, \n                                           ProductRevNumber = group.Max(x =&gt; x.ProductRevNumber));\n</code></pre>\n\n<p>The lambda query doesn't work.</p>\n"},{"tags":["c#","linq","visual-studio","data-binding","entity"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":12939228,"title":"Can not bind distinct to drop down control","body":"<p>My application is showing this error below: </p>\n\n<p><strong>Data binding directly to a store query (DbSet, DbQuery, DbSqlQuery) is not supported</strong></p>\n\n<p>Due to the fact that I am trying to bind my drop down control to this LINQ statement. \nCheck below for my code;</p>\n\n<pre><code> using (AdventureWorksEntities dw = new AdventureWorksEntities())\n        {\n            ddlCon.DataSource = (from em in dw.Employees\n                       select new { em.Title, em.EmployeeID }).Distinct().OrderBy(name =&gt; name);\n            ;\n\n\n            ddlCon.DataTextField = \"Title\";\n            ddlCon.DataValueField = \"EmployeeID\";\n            ddlCon.DataBind();\n        }\n</code></pre>\n\n<p>NB: Please explain well in your answers why this error and the solution to it. </p>\n"},{"tags":["linq","text"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12938958,"title":"Use linq to query blocks of text?","body":"<p>I have a text file that contains some data in a \"block\" format:</p>\n\n<pre><code>source : source location\nfilename : somefile.txt\nvendor : somevendor\nversion : xx.xx.xxx\n\nsource : source location2\nfilename : somefile2.txt\nvendor : somevendor2\nversion : yy.yy.yyy\n</code></pre>\n\n<p>can I use Linq to query this data and if so how would you go about it?  I have used linq to query lines of data from text file many times, but never a \"block\" of data as above. Thanks for the input.</p>\n"},{"tags":["linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12938222,"title":"Linq and foreign key Lookup tables with integer keys","body":"<p>I have a database where the tables are:</p>\n\n<pre><code>Table1:\nTable1Id int\n\nTable2:\nTable2Id int\nForeignKeyToTable1 int\n\nLookupTable:\nTable2Id\nTable3Id\n\nTable3:\nTable3Id int\nTable3Field varchar\n</code></pre>\n\n<p>I want to:</p>\n\n<pre><code>select table1.* from table1\ninner join table2 on table1.Table1Id = ForeignKeyToTable1 \ninner join LookupTable on LookupTable.Table2Id = table2.Table2Id \ninner join Table3 on table3.Table3Id = LookupTable.Table3Id\nwhere table3.Table3Field ='qwerty'\n</code></pre>\n\n<p>How can this be achieved in Linq?</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":118,"score":2,"question_id":12903732,"title":"Slow speed when using nested loops when comparing large data sets","body":"<p>I'm retrieving two lists of datasets using Linq to entities. They're both in the same Database, but I need to get one table converted into my Tasks Table because it's integrated into my Calendar. Not worth going into extreme detail here I'm sure but I would love to speed up the process of matching id's and Creating new Task objects. This is a Once and done snippet so even at a slow speed I can simply leave the program running overnight. However, for future reference I'd like some suggestions on increasing the efficiency.</p>\n\n<pre><code>var accounts = data.Accounts.ToList().OrderBy(a =&gt; a.ID);\nIncidents[] Incidents = data.Incidents.ToArray();\n\n        for (int i=0;i&lt;Incidents.Length;i++)\n        {\n            foreach (var a in accounts)\n            {\n                if (a.Acct_CID == Incidents[i].CustomerID)\n                {\n                    Tasks t = new Tasks();\n                    t.creator_id = a.ID;\n                    t.start_date = Incidents[i].DateOpened;\n                    t.end_date = Incidents[i].DateCLosed;\n                    t.product_code = Incidents[i].ProductCode;\n                    t.install_type = Incidents[i].InstallType;\n                    t.os = Incidents[i].OSType;\n                    t.details = Incidents[i].Description;\n                    t.solution = Incidents[i].Solution;\n                    t.creator_name = Incidents[i].TechID;\n                    t.category = Incidents[i].Title;\n                    t.text = \"Ticket for\" + \" \" + Incidents[i].Name;\n                    if (t.end_date == DateTime.MinValue || t.end_date == null)\n                        t.status_id = 6;\n                    else t.status_id = 7;\n                    data.Tasks.Add(t);\n                    break;\n                }\n            }\n        }\n        data.SaveChanges();\n</code></pre>\n"},{"tags":["c#",".net","linq",".net-3.5"],"answer_count":10,"favorite_count":64,"up_vote_count":236,"down_vote_count":1,"view_count":181631,"score":235,"question_id":10855,"title":"LINQ query on a DataTable","body":"<p>I'm trying to perform a LINQ query on a DataTable object and bizarrely I am finding that performing such queries on DataTables is not straightforward. For example:</p>\n\n<pre><code>var results = from myRow in myDataTable\nwhere results.Field(\"RowNo\") == 1\nselect results;\n</code></pre>\n\n<p>This is not allowed. Any ideas how to get something like this working? I'm amazed that LINQ queries are not allowed on DataTables!</p>\n"},{"tags":["c#","linq","visual-studio","data-binding","entity"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12938371,"title":"Data binding directly to a store query (DbSet, DbQuery, DbSqlQuery) is not supported","body":"<p>Am coding on <strong>visual studio 2012</strong> and using <strong>Entity Model</strong> as my Data layer. However, my drop down control with the Linq statement tend to throw an unhandled exception when the page tries to load (stated title above). Here is my code below;</p>\n\n<pre><code>using (AdventureWorksEntities dw = new AdventureWorksEntities())\n        {\n            ddlCon.DataSource = (from em in dw.Employees\n                                 select new { em.Title, em.EmployeeID });\n\n            ddlCon.DataTextField = \"Title\";\n            ddlCon.DataValueField = \"EmployeeID\";\n            ddlCon.DataBind();\n            ddlCon.Items.Insert(0, new ListItem(\"--Select--\", \"--Select--\"));\n        }\n</code></pre>\n\n<ol>\n<li>I want to know why that error occurred</li>\n<li>What should be the proper way to bind to a control when using LINQ?</li>\n</ol>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12934290,"title":"entity framework linq include and grouping","body":"<p>I'm trying  to  to do include and group in in one sentence </p>\n\n<pre><code>var instanceIdList = context.\n    Tracks.\n    Include(\"Services\").\n    GroupBy(x =&gt; x.ServiceId).\n    Take(top);\n</code></pre>\n\n<p>but when I check the result at debug I cant see any of the include values </p>\n\n<p>I tried to do in another way </p>\n\n<pre><code>var objectContext = ((IObjectContextAdapter)context).ObjectContext;\nvar set = objectContext.CreateObjectSet&lt;Track&gt;();\nvar instanceIdList = set.Include(\"Services\").GroupBy(x =&gt; x.ServiceId);\n</code></pre>\n\n<p>this is the classes :\n <em>Track</em></p>\n\n<pre><code>  public partial class Track\n{\n    public long Id { get; set; }\n    public System.Guid ServiceId { get; set; }\n    public Nullable&lt;System.Guid&gt; ServiceInterfaceId { get; set; }\n    public Nullable&lt;System.Guid&gt; ProviderId { get; set; }\n    public System.Guid ServiceInstanceId { get; set; }\n    public System.Guid ActivityParentId { get; set; }\n    public System.Guid ActivityInstanceId { get; set; }\n    public int ActivityType { get; set; }\n    public int ServiceRole { get; set; }\n    public int TrackOrder { get; set; }\n    public System.DateTime Datetime { get; set; }\n    public Nullable&lt;System.Guid&gt; MessageId { get; set; }\n    public int Status { get; set; }\n    public Nullable&lt;int&gt; ESBErrorCode { get; set; }\n    public Nullable&lt;int&gt; ESBTecnicalErrorCode { get; set; }\n    public string ErrorDescription { get; set; }\n    public string PortName { get; set; }\n    public string MachineName { get; set; }\n    public string ConsumerId { get; set; }\n    public string ExternalId { get; set; }\n    public string ConsumerMachineName { get; set; }\n    public int ServiceBehavior { get; set; }\n\n    public virtual Message Message { get; set; }\n}\n</code></pre>\n\n<p><em>Service</em></p>\n\n<pre><code>      public partial class Service\n      {\n        public Service()\n        {\n        this.Providers = new HashSet&lt;Provider&gt;();\n        this.ServiceInterfaces = new HashSet&lt;ServiceInterface&gt;();\n            }\n\n    public System.Guid ServiceId { get; set; }\n    public string ServiceName { get; set; }\n    public string ServiceNumber { get; set; }\n    public Nullable&lt;System.Guid&gt; ModelSchemaId { get; set; }\n\n    public virtual ICollection&lt;Provider&gt; Providers { get; set; }\n    public virtual ICollection&lt;ServiceInterface&gt; ServiceInterfaces { get; set; }\n}\n</code></pre>\n\n<p>but the result is the same</p>\n\n<p>thanks </p>\n\n<p>miki</p>\n"},{"tags":["asp.net-mvc","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12929048,"title":"Get random and specific items from database","body":"<p>This is how it should go. Table will show six values total, out of that three must be specific ones, and other three random ones, they can't match of course. Meaning that,\nif I create two separate instances of <code>Currencies</code> model (which is in question), and from one single out three specific ones I need, and use other instance for getting random three, I would have to exclude those 3 specifics from the second instance. Example.</p>\n\n<pre><code>//instance\nDateTime today = DateTime.Now.Date;\nvar currencies = db.Currencies.Where(c =&gt; c.DateCreated.Equals(today));\n\n//first get three separate\ncurrency1 = currencies.Where(c =&gt; c.Sign.Equals(\"EUR\"));\ncurrency2 = currencies.Where(c =&gt; c.Sign.Equals(\"USD\"));\ncurrency3 = currencies.Where(c =&gt; c.Sign.Equals(\"AUD\"));\n\n//second get three randoms\nvar currencies = db.Currencies.Where(c =&gt; c.DateCreated.Equals(today)).OrderBy(d =&gt; db.GetNewID()).Take(3);\n</code></pre>\n\n<p>Now, there should be a way (I think) to alter the currencies at 2nd get to use <code>.Except</code> but I'm not sure how to make an exception of three values. How to do this?</p>\n"},{"tags":["c#","linq","windows-8","linq-to-objects"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":372,"score":4,"question_id":11119722,"title":"LINQ string contains another string case insensitive","body":"<p>I'm working in a C# Windows 8 Metro app and I'm trying to filter an <code>ObservableCollection&lt;T&gt;</code> using LINQ where a property contains some string, and I need that it will be case insensitive.</p>\n\n<pre><code> var searchResults = from _rest in App.ViewModel.Restaurants\n                     where  _rest.Name.IndexOf(queryText,\n                                 StringComparison.CurrentCultureIgnoreCase) &gt;= 0\n                     select _rest;\n</code></pre>\n\n<p>I work around</p>\n\n<ul>\n<li><code>Using string1.Contains(string2).ToUpper()</code> in both strings.</li>\n<li><code>Using string1.Contains(string2).ToLower()</code> in both strings.</li>\n<li><code>Using string1.IndexOf(string2, StringComparison.CurrentCultureIgnoreCase) &gt;= 0</code>.</li>\n<li><code>Using string1.IndexOf(string2, StringComparison.OrdinalIgnoreCase) &gt;= 0</code>.</li>\n<li><code>Using String.Compare(string1, string2, StringComparison.CurrentCultureIgnoreCase)</code>.</li>\n</ul>\n\n<p>But no one of this methods works for me in a case insensitive way, works ok if I write the name correctly.</p>\n\n<p>Has someone have the same issue in Windows 8??</p>\n\n<p>Thanks in advance for any help provided.</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12936503,"title":"Iterating through LinQ to Entities results","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12916080/the-entity-or-complex-type-cannot-be-constructed-in-a-linq-to-entities-query\">The entity or complex type   cannot be constructed in a LINQ to Entities query</a>  </p>\n</blockquote>\n\n\n\n<p>I asked this question the other day, and actually did not find any answers that worked %100 I'm trying to compare two tables (Incidents and Accounts) and assign Incidents with Matching Customer Id's to Tasks.</p>\n\n<pre><code>   var tasks = (from i in data.Incidents\n                     join a in data.Accounts on i.CustomerID equals a.Acct_CID\n                     select new\n                     {\n                         creator_id = a.ID,\n                         start_date = i.DateOpened,\n                         end_date = i.DateCLosed,\n                         product_code = i.ProductCode,\n                         install_type = i.InstallType,\n                         os = i.OSType,\n                         details = i.Description,\n                         solution = i.Solution,\n                         creator_name = i.TechID,\n                         category = i.Title,\n                         text = \"Ticket for\" + \" \" + i.Name,\n                         status_id = 7\n                     }).ToArray().Select(x =&gt; new Tasks\n                     {\n                         creator_id = x.creator_id,\n                         start_date = x.start_date,\n                         end_date = x.end_date,\n                         product_code = x.product_code,\n                         os = x.os,\n                         details = x.details,\n                         solution = x.solution,\n                         creator_name = x.creator_name,\n                         category = x.category,\n                         text = x.text,\n                         status_id = x.status_id\n                     });\n\n   foreach (var item in tasks)\n   {\n     data.Tasks.Add(item);\n   }\n</code></pre>\n\n<p>Here is the Tasks Class</p>\n\n<pre><code> public class Tasks\n      {\n    [Key]\n    public int id { get; set; }\n    public string text { get; set; }\n   // [CheckDateAtribute]\n   [Display(Name=\"Start Date/Time\")]\n    [DataType(DataType.DateTime)]\n    public DateTime start_date { get; set; }\n    [DataType(DataType.DateTime)]\n    [Display(Name = \"End Date/Time\")]\n    public DateTime end_date { get; set; }\n    [Display(Name=\"Details\")]\n    [Required]\n    public string details { get; set; }\n    public int owner_id { get; set; }\n    public int creator_id { get; set; }\n    public int status_id { get; set; }\n    public string reply { get; set; }\n    public string creator_name { get; set; }\n    public string category { get; set; }\n    public string solution { get; set; }\n    public string os { get; set; }\n    public string install_type { get; set; }\n    public string product_code { get; set; }\n}\n</code></pre>\n\n<p>The Incidents Class</p>\n\n<pre><code>   public class Incidents\n{\n    [Key]\n    public int IncidentID { get; set; }\n    public string CustomerID { get; set; }\n    public string ProductCode { get; set; }\n    public string TechID { get; set; }\n    public DateTime DateOpened { get; set; }\n    public DateTime DateCLosed { get; set; }\n    public string Title { get; set; }\n    public string Description { get; set; }\n    public string Solution { get; set; }\n    public string Name { get; set; }\n    public string OSType{ get; set; }\n    public string InstallType { get; set; }\n    public string AddOnSoftware { get; set; }\n    public string ScreenShare { get; set; }\n}\n</code></pre>\n\n<p>ANOTHER EDIT: getting a timeout exception now</p>\n"},{"tags":["asp.net-mvc","linq","ef-code-first"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12937302,"title":"Retrieving related data using linq","body":"<p>I have an MVC app using EF code first. I add a user to the system and enter pension details, part of this is a dropdown linked to a model called PensionBenefitLevel. This is the model - </p>\n\n<pre><code>[Key]\npublic int PensionBenefitLevelID { get; set; }\npublic string DisplayText { get; set; }\npublic int EmployeePercentage { get; set; }\npublic int EmployerPercentage { get; set; }\n\npublic virtual ICollection&lt;Pension&gt; Pension { get; set; }\n</code></pre>\n\n<p>When registered I have the PensionBenefitLevelID that came from the dropdown, but in my controller I was to peform a calculation using the EmployerPercentage value that is related to that ID. Can anyone point me in the correct direction?</p>\n\n<p>Do I need to create a variable in the controller and use a linq query to get that value back? I've not been able to find any examples of something similar so if you could point me to one that would be great too.</p>\n"},{"tags":["c#",".net","linq","lambda","datatable"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12937232,"title":"Lambdas does not recognize fields of DataTables","body":"<p>I've do this many times in another solutions. But in one of them, It doesn't work. Don't know why.</p>\n\n<p>I want to use <code>Where()</code> in some dataTable. So, I do, for example</p>\n\n<pre><code>int someId;\nDatasetName.DatatableName.AsEnumerable().Where(x =&gt; x.id == someId);\n</code></pre>\n\n<p>But in this project, it doesn't recognize the lambda <code>x =&gt; x.id == someId</code> </p>\n\n<p>Why is that? I can't use them. The intelissense, afther the <code>(</code> in the <code>Where</code> recognize that needs to receive a <code>Func</code>, and when I do <code>x =&gt; x.</code> it doesn't recognize the fields of the DataTable. Why I cant do <code>x.id</code> ? I know I can use <code>Field&lt;&gt;()</code> (I think that was the name), but I have used the expressions directly a lot of times and I consider them more readables. And in the other solutions does work this.</p>\n\n<p>I have added references of </p>\n\n<pre><code>using System.Linq;    \nusing System.Data.Linq;\nusing System.Linq.Expressions;\n</code></pre>\n\n<p>It doesn't compile, and does not recognize any fields of the Datatable.\nThe project is set for <code>.Net Framework 3.5</code>.</p>\n\n<p>Any help will be appreciated</p>\n"},{"tags":["c#","linq","aggregate"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":69,"score":6,"question_id":12936501,"title":"Linq Select and Aggregate within a single iteration","body":"<p>Is there a way to do this with linq without enumerating the <code>fooCollection</code> twice?</p>\n\n<pre><code>var fooCollection = // get foo\nvar selectedIds = new List&lt;int&gt;();\nvar aggregateContent = String.Empty;\n\nforeach (var f in foo)\n{\n    selectedIds.Add(foo.Id);\n    aggregateContent += foo.Content\n}\n\nvar results = new FooResults\n{\n    Content = aggregateContent,\n    SelectedIds = selectedIds\n};\n\nreturn results;\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":88,"score":-1,"question_id":12856266,"title":"OrderBy a date field with linq and return ToList()","body":"<p>i am gettting a list of records from table, its working fine, but when i use orderby its showing a error if i use this code like this its working fine :</p>\n\n<pre><code>var Item = from itm in DB.Items\norderby itm.ExpiryDate ascending\nselect new Item\n{\n\n};\nreturn Item.ToList();\n</code></pre>\n\n<p>above is working fine, but i have a condition so thats why i need to use the following which is giving a error</p>\n\n<pre><code>var Item = from itm in DB.Items\nselect new Item\n{\n</code></pre>\n\n<p>};</p>\n\n<pre><code>if (Order == \"NearExpire\")\n{\nreturn Item.OrderBy(e=&gt;e.ExpiryDate).ToList();\n}\nelse\n{\nreturn Item.ToList();\n}\n</code></pre>\n\n<p>Here is Solution</p>\n\n<pre><code>var Item = (from itm in DB.Items\nselect new Item\n{\n\n}).ToList();\n\nif (Order == \"NearExpire\")\n{\nreturn Item.OrderBy(e=&gt;e.ExpiryDate).ToList();\n}\nelse\n{\nreturn Item.ToList();\n}\n</code></pre>\n"},{"tags":["vb.net","winforms","linq","vb.net-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12936574,"title":"What is wrong with this LINQ code?","body":"<p>First, I have function to flatten all controls on a <code>Control</code>:</p>\n\n<pre><code>Protected Function GetAllControls(Optional ownerControl As Control = Nothing) As IEnumerable(Of Control)\n\n    Dim ret = New List(Of Control)()\n    For Each child As Control In If(ownerControl, Me).Controls\n        ret.AddRange(GetAllControls(child))\n    Next\n    ret.Add(ownerControl)\n    Return ret\n\nEnd Function\n</code></pre>\n\n<p>Then, I want to hide certain buttons on a control using this code:</p>\n\n<pre><code>Dim buttons = GetAllControls().Where(Function(c) c.Name.StartsWith(\"subButton\"))\nFor Each ctrl As Control In buttons\n    ctrl.Visible = False\n    Debug.WriteLine(\"Hid button \" &amp; ctrl.Name)\nNext\n</code></pre>\n\n<p>Yet, after four buttons - the correct count - have been hidden, I get a <code>NullReferenceException</code>, with VS2012 highlighting the lambda expression. </p>\n\n<p>What could possibly cause this?</p>\n"},{"tags":["c#","linq","datatable","group"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":182,"score":1,"question_id":12916110,"title":"DataTable group the result in one row","body":"<p>I have a DataTable and want to group Name, LastName and Comment. The rest should be in the same row.\nIn my Code firstly i make ID's values as header and then organize the Attribute values to each ID. What I want here is to group the the same Name, Lastname and Comment with their ID values.\nMy first Table looks like that:</p>\n\n<pre><code>ID   Name   Lastmame    Comment    Attribute\n1    kiki   ha          hello      FF        \n3    lola   mi          hi         AA\n2    ka     xe          what       UU\n2    kiki   ha          hello      SS\n</code></pre>\n\n<p>After i use my code:</p>\n\n<pre><code>     Name   Lastname    Comment   1    3    2\n     kiki   ha           hello    FF\n     lola   mi           hi            AA\n     ka     xe           what              UU \n     kiki   ha           hello             SS\n</code></pre>\n\n<p>what i want to have is:</p>\n\n<pre><code>     Name   Lastname    Comment   1    3    2\n     kiki    ha           hello   FF        SS\n     lola    mi            hi          AA\n     ka      xe           what              UU   \n</code></pre>\n\n<p>My Code:</p>\n\n<pre><code>    DataTable table1 = new DataTable(\"Kunde\"); \n    table1.Columns.Add(\"Comment\", typeof(String)); \n    table1.Columns.Add(\"Name\", typeof(String)); \n    table1.Columns.Add(\"Lastname\", typeof(String)); \n\n    DataTable comment = new DataTable(\"Comment\");\n    comment.Columns.Add(\"ID\", typeof(String)); \n    comment.Columns.Add(\"Comment\", typeof(String)); \n    comment.Columns.Add(\"Attribute\", typeof(String)); \n\n    DataSet ds = new DataSet(\"DataSet\"); \n    ds.Tables.Add(table1); \n    ds.Tables.Add(comment); \n\n    object[] o1 = { \"hello\", \"kiki\", \"ha\" }; \n    object[] o2 = { \"hi\", \"lola\", \"mi\" }; \n    object[] o3 = { \"what\", \"ka\", \"xe\" };  \n    object[] c1 = { 1, \"hello\", \"FF\" }; \n    object[] c2 = { 3, \"hi\", \"AA\" };\n    object[] c3 = { 2, \"what\", \"UU\" };\n    object[] c4 = { 2, \"hello\", \"SS\" }; \n\n    table1.Rows.Add(o1); \n    table1.Rows.Add(o2); \n    table1.Rows.Add(o3); \n    comment.Rows.Add(c1); \n    comment.Rows.Add(c2);\n    comment.Rows.Add(c3);\n    comment.Rows.Add(c4);\n\n    var results = from tb1 in comment.AsEnumerable() \n                  join tb2 in table1.AsEnumerable() \n                  on tb1.Field&lt;string&gt;(\"Comment\") equals tb2.Field&lt;string&gt;(\"Comment\") \n                  select new \n                      { \n                          ID = tb1.Field&lt;String&gt;(\"ID\"),\n                          Name = tb2.Field&lt;String&gt;(\"Name\"),\n                          Lastname = tb2.Field&lt;String&gt;(\"Lastname\"),\n                          Comment = tb1.Field&lt;String&gt;(\"Comment\"),\n                          Attribute = tb1.Field&lt;String&gt;(\"Attribute\"),\n\n                      };\n    DataTable result = LINQToDataTable(results);\n    var products = result.AsEnumerable()\n                        .GroupBy(c =&gt; c[\"ID\"])\n                        .Where(g =&gt; !(g.Key is DBNull))\n                        .Select(g =&gt; (string)g.Key)\n                        .ToList();\n    var newtable = result.Copy();\n    products.ForEach(p =&gt; newtable.Columns.Add(p, typeof(string)));\n\n    foreach (var row in newtable.AsEnumerable())\n    {\n        if (!(row[\"ID\"] is DBNull)) row[(string)row[\"ID\"]] = row[\"Attribute\"];\n    }\n    newtable.Columns.Remove(\"ID\");\n    newtable.Columns.Remove(\"Attribute\");\n\n    var result11 = from t1 in newtable.AsEnumerable()\n                   group t1 by new { Name = t1.Field&lt;String&gt;(\"Name\"), LastName = t1.Field&lt;String&gt;(\"LastName\"), Comment = t1.Field&lt;String&gt;(\"Comment\"), } into grp\n                 select new\n                 {\n                     Name = grp.Key.Name,\n                     LastName = grp.Key.LastName,\n                     Comment = grp.Key.Comment,\n                     //Something here\n                 };\n</code></pre>\n\n<p>using System.Reflection;</p>\n\n<pre><code>    public DataTable LINQToDataTable&lt;T&gt;(IEnumerable&lt;T&gt; varlist)\n    {\n        DataTable dtReturn = new DataTable();\n\n        // column names \n        PropertyInfo[] oProps = null;\n\n        if (varlist == null) return dtReturn;\n\n        foreach (T rec in varlist)\n        {\n            if (oProps == null)\n            {\n                oProps = ((Type)rec.GetType()).GetProperties();\n                foreach (PropertyInfo pi in oProps)\n                {\n                    Type colType = pi.PropertyType;\n\n                    if ((colType.IsGenericType) &amp;&amp; (colType.GetGenericTypeDefinition()\n                    == typeof(Nullable&lt;&gt;)))\n                    {\n                        colType = colType.GetGenericArguments()[0];\n                    }\n\n                    dtReturn.Columns.Add(new DataColumn(pi.Name, colType));\n                }\n            }\n\n            DataRow dr = dtReturn.NewRow();\n\n            foreach (PropertyInfo pi in oProps)\n            {\n                dr[pi.Name] = pi.GetValue(rec, null) == null ? DBNull.Value : pi.GetValue\n                (rec, null);\n            }\n\n            dtReturn.Rows.Add(dr);\n        }\n        return dtReturn;\n    }\n</code></pre>\n"},{"tags":["sql","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":71,"score":1,"question_id":12928332,"title":"GETDATE() in LINQ","body":"<p>What is the alternate for <code>GETDATE()</code> in LINQ? </p>\n\n<p>I got some workaround from the following post:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/200617/how-do-i-use-sqls-getdate-and-dateadd-in-a-linq-to-sql-expression\"><strong>How do I use SQL's GETDATE() and DATEADD() in a Linq to SQL expression?</strong></a></li>\n</ul>\n\n<p>Is there any <strong><em>better</em></strong> approach? In which, there is no need to an <code>ExecuteQuery</code> or a separate function call?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":537,"score":2,"question_id":10862491,"title":"Unable to create a constant value - only primitive types","body":"<p>Two simple querys -  the exception occurs in </p>\n\n<pre><code>    matchings.Any(u =&gt; product.ProductId == u.ProductId)\n</code></pre>\n\n<p>What is wrong?If I write \"true\" instead it all is good.</p>\n\n<pre><code>    var matchings = (from match in db.matchings \n                   where match.StoreId == StoreId \n                   select match).ToList();\n\n    var names = (from product in db.Products\n          where matchings.Any(u =&gt; product.ProductId == u.ProductId)\n          select product).ToList();\n</code></pre>\n"},{"tags":["c#","linq","entity-framework-4","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12932286,"title":"Linq (EF) where clause with string comma seperated","body":"<p>I have C# Lambda linq query as follow:</p>\n\n<pre><code>public IQueryable&lt;CtArticleDetail&gt; GetArticleDetailsByTagNames(string tagNames)\n{\n    return db.CtArticleTags.Where(m =&gt; tagNames.Contains(m.CtTag.Name) \n                                       &amp;&amp; m.CtArticleDetail.ExpirationDate &gt; DateTime.Now\n                                       &amp;&amp; m.CtArticleDetail.ArticleStatusId == (int)ArticleStatus.Published)\n                           .Select(m =&gt; m.CtArticleDetail).OrderBy(x =&gt; x.LiveDate).Distinct();\n}\n</code></pre>\n\n<p>This returns slightly wrong data list because of \"Contains\".   The parameter actually comes this format:  EG ( \"AterSale,GeneralSale\").  The result list contains other sale type articles.EG (\"Sale\" or \"ImportedSale\").  </p>\n\n<p>The reuslt list should be exact list as parameter passed. Can anyone pls advice ?</p>\n\n<pre><code>var mustContain = new[] {\"A\", \"B\");\n\nvar foos = new  List&lt;Foo&gt;(){\n     new Foo1 {Tags = \"A\"},\n     new Foo1 {Tags = \"B\"},\n     new Foo2 {Tags = \"A\"},\n     new Foo2 {Tags = \"C\"}\n};   \n</code></pre>\n\n<p>I just need Foo1 if mustcontain is  A,B</p>\n"},{"tags":["javascript","linq","jquery-ui","css3","asp.net-web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12934569,"title":"How to bind Menus and submenus apply css using Jquery?","body":"<p>i have data in sting values in html format how to apply css and jquery styles </p>\n\n<pre><code> public class Menus\n      {\n        public List&lt;Menus&gt; GetALL { get; set; }  \n            public int menuId { get; set; }\n            public string menuName { get; set; }\n            public string menuURL { get; set; }\n            public int parentId { get; set; }\n       }    \n    public class MenuModel\n    {\n        public MenuItemsEntities objEntities = new MenuItemsEntities();\n\n        public string GetMenu()\n        {\n            //Get MainMenu Menus       \n            Menus menuobj = new Menus();            \n            var objmenu = from menus in objEntities.MenuItems\n                          where menus.ParentId == 0\n                          select menus;\n\n            string strMenuBuild = string.Empty;\n            strMenuBuild += \"&lt;ul&gt;\";\n            foreach (var i in objmenu)\n            {\n                menuobj.menuName = i.ItemName;\n                menuobj.menuId = i.MenuItemsID;\n                menuobj.menuURL = i.URL;\n                if (i.ParentId == 0)\n                {                  \n                    //GetSubMenu();\n                    strMenuBuild = strMenuBuild + \"&lt;li&gt;&lt;a href='\" + menuobj.menuURL + \"'&gt;\" + menuobj.menuName + \"&lt;/a&gt;&lt;ul&gt;\";\n                    strMenuBuild += GetSubMenu(Convert.ToInt32(menuobj.menuId)) + \"&lt;/ul&gt;&lt;/li&gt;\";\n                    //strMenuBuild  += \"&lt;/ul&gt;&lt;/li&gt;\";\n                }\n            }\n            strMenuBuild += \"&lt;/ul&gt;\";\n            return strMenuBuild;\n        }\n        public string GetSubMenu(int submenuid)\n        {\n            string strSubBuild = string.Empty;\n            Menus menuobj = new Menus();    \n            var submenu=   from menus in objEntities.MenuItems\n                          where menus.ParentId == submenuid\n                          select menus;           \n            if (submenu.Count() &gt; 0)\n            {\n                foreach (var sbmnu in submenu)                \n                {\n                    menuobj.menuURL = sbmnu.URL;\n                    menuobj.menuName = sbmnu.ItemName;\n                    menuobj.menuId = sbmnu.MenuItemsID;\n\n                    strSubBuild = strSubBuild + \"&lt;li &gt;&lt;a href='\" + menuobj.menuURL + \"'&gt;\" + menuobj.menuName + \"&lt;/a&gt;\";\n\n                    var submneu1 = from menus in objEntities.MenuItems\n                                   where menus.ParentId == menuobj.menuId \n                                   select menus;\n\n                    if (submneu1.Count() &gt; 0)\n                    {\n                        strSubBuild += \"&lt;ul&gt;\";\n                        strSubBuild += GetSubMenu(Convert.ToInt32(menuobj.menuId));\n                        strSubBuild += \"&lt;/ul&gt;\";  \n                    }\n                    strSubBuild += \"&lt;/li&gt;\";\n                }               \n            }\n            return strSubBuild;\n        }\n    }  \n</code></pre>\n\n<p>I have return to String In Html formate like that</p>\n\n<hr>\n\n<p><ul>\n        <li>Menu's Apperals<ul>\n            <li>Shirts</li>\n            <li>T Shirts<ul>\n                <li>H3SubMenu1</li>\n            </ul>\n            </li>\n            <li>Jeans<ul>\n                <li>P1Submenu1</li>\n                <li>P2SubMenu2</li>\n            </ul>\n            </li>\n            <li>Trousers</li>\n            <li>SportsWear</li>\n        </ul>\n        </li>\n        <li>Women'sMenu' Apperals<ul>\n            <li>Sarees</li>\n            <li>Dress</li>\n            <li>Trousers</li>\n        </ul>\n        </li>\n        <li>Mobiles<ul>\n            <li>MobilePhones</li>\n            <li>Tablets</li>\n            <li>Memorycards</li>\n            <li>Bluetooths</li>\n        </ul>\n        </li>\n        <li>Jewellerry<ul>\n            <li>Earrings</li>\n            <li>Rings</li>\n            <li>Chains</li>\n            <li>KidsJwellery</li>\n        </ul>\n        </li>\n    </ul>  </p>\n\n<p>But am bind the Menus and submenus .i want appy the css and jquery.how to apply Css and jquery i dont know .can any one help me please..</p>\n"},{"tags":["c#","sql","performance","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":12933794,"title":"Linq to SQL one to many relationships","body":"<p>Last couple of days i was struggling with a linq querys performance: </p>\n\n<pre><code>LinqConnectionDataContext context = new LinqConnectionDataContext();\nSystem.Data.Linq.DataLoadOptions options = new System.Data.Linq.DataLoadOptions();\noptions.LoadWith&lt;Question&gt;(x =&gt; x.Answers);\noptions.LoadWith&lt;Question&gt;(x =&gt; x.QuestionVotes);\noptions.LoadWith&lt;Answer&gt;(x =&gt; x.AnswerVotes);\ncontext.LoadOptions = options;\nvar query =( from c in context.Questions\n            where c.UidUser == userGuid\n            &amp;&amp; c.Answers.Any() == true\n            select new\n            {\n                c.Uid,\n                c.Content,\n                c.UidUser,\n                QuestionVote = from qv in c.QuestionVotes where qv.UidQuestion == c.Uid &amp;&amp; qv.UidUser == userGuid select new {qv.UidQuestion, qv.UidUser },\n                Answer = from d in c.Answers\n                         where d.UidQuestion == c.Uid\n                         select new\n                         {\n                             d.Uid,\n                             d.UidUser,\n                             d.Conetent,\n                             AnswerVote = from av in d.AnswerVotes where av.UidAnswer == d.Uid &amp;&amp; av.UidUser == userGuid select new { av.UidAnswer, av.UidUser }\n                         }\n            }).ToList();\n</code></pre>\n\n<p>Query have to run through 5000 rows, and it takes up to 1 minute. How can i improve performance of this query? </p>\n\n<p><strong>Update:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/O61M5.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":107,"score":5,"question_id":12859536,"title":"simple select query in linq","body":"<p>Lets say I have a student table and I want to display the student with ID 1.</p>\n\n<pre><code>SELECT *\nFROM STUDENT ST\nWHERE ST.ID = 1\n</code></pre>\n\n<p>This is how I achive this in Linq.</p>\n\n<pre><code>StudentQuery = from r in oStudentDataTable.AsEnumerable()\n                                     where (r.Field&lt;int&gt;(\"ID\") == 1)\n                                     select r;\n            oStudentDataTable = StudentQuery.CopyToDataTable();\n</code></pre>\n\n<p>but what if I want to display the students with these ids 1,2,3,4,5..</p>\n\n<pre><code>SELECT *\nFROM STUDENT ST\nWHERE ST.ID IN (1,2,3,4,5)\n</code></pre>\n\n<p>How can I achieve this in Linq?</p>\n"},{"tags":["linq","generic-list"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12924105,"title":"Creating a generic list of type T base of a a list of type","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/234008/is-it-impossible-to-use-generics-dynamically\">Is it impossible to use Generics dynamically?</a>  </p>\n</blockquote>\n\n\n\n<p>Does anyone know if it is possible to create a a generic list of type T base of a list containing the type?  Here is my example:</p>\n\n<pre><code>    static void Main(string[] args)\n    {\n        List&lt;Type&gt; childElement = new List&lt;Type&gt;() { typeof(string), typeof(int), typeof(bool) };\n\n        childElement.ForEach(item =&gt; \n        {\n            Foo&lt;foo&gt;();\n        });\n    }\n\n    public static void Foo&lt;T&gt;()\n    {\n        List&lt;T&gt; foo = new List&lt;T&gt;();\n\n    }\n</code></pre>\n\n<p>Its not liking:</p>\n\n<pre><code> Foo&lt;foo&gt;();\n</code></pre>\n\n<p>Error\nError   1   The type or namespace name 'foo' could not be found (are you missing a using directive or an assembly reference?)   C:\\Users\\foo\\Documents\\Visual Studio 2012\\Projects\\ConsoleApplication2\\ConsoleApplication2\\Program.cs   17  21  ConsoleApplication2</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":1,"view_count":393,"score":2,"question_id":12778560,"title":"Dynamic LINQ OrderBy + Method Count","body":"<p>I'm displaying a table of objects <strong>Company</strong> in a webpage and I am using a Dynamic Linq OrderBy to sort them on each property.\nI'm using this code <a href=\"http://stackoverflow.com/a/233505/265122\">http://stackoverflow.com/a/233505/265122</a></p>\n\n<pre><code>public static IOrderedQueryable&lt;T&gt; OrderBy&lt;T&gt;(this IQueryable&lt;T&gt; source, string property)\n{\n    return ApplyOrder&lt;T&gt;(source, property, \"OrderBy\");\n}\npublic static IOrderedQueryable&lt;T&gt; OrderByDescending&lt;T&gt;(this IQueryable&lt;T&gt; source, string property)\n{\n    return ApplyOrder&lt;T&gt;(source, property, \"OrderByDescending\");\n}\npublic static IOrderedQueryable&lt;T&gt; ThenBy&lt;T&gt;(this IOrderedQueryable&lt;T&gt; source, string property)\n{\n    return ApplyOrder&lt;T&gt;(source, property, \"ThenBy\");\n}\npublic static IOrderedQueryable&lt;T&gt; ThenByDescending&lt;T&gt;(this IOrderedQueryable&lt;T&gt; source, string property)\n{\n    return ApplyOrder&lt;T&gt;(source, property, \"ThenByDescending\");\n}\nstatic IOrderedQueryable&lt;T&gt; ApplyOrder&lt;T&gt;(IQueryable&lt;T&gt; source, string property, string methodName) {\n    string[] props = property.Split('.');\n    Type type = typeof(T);\n    ParameterExpression arg = Expression.Parameter(type, \"x\");\n    Expression expr = arg;\n    foreach(string prop in props) {\n        // use reflection (not ComponentModel) to mirror LINQ\n        PropertyInfo pi = type.GetProperty(prop);\n        expr = Expression.Property(expr, pi);\n        type = pi.PropertyType;\n    }\n    Type delegateType = typeof(Func&lt;,&gt;).MakeGenericType(typeof(T), type);\n    LambdaExpression lambda = Expression.Lambda(delegateType, expr, arg);\n\n    object result = typeof(Queryable).GetMethods().Single(\n            method =&gt; method.Name == methodName\n                    &amp;&amp; method.IsGenericMethodDefinition\n                    &amp;&amp; method.GetGenericArguments().Length == 2\n                    &amp;&amp; method.GetParameters().Length == 2)\n            .MakeGenericMethod(typeof(T), type)\n            .Invoke(null, new object[] {source, lambda});\n    return (IOrderedQueryable&lt;T&gt;)result;\n}\n</code></pre>\n\n<p>It's great but I would also like to sort the companies on the number of employees.</p>\n\n<p>Like this : <strong>query.OrderBy(\"Employees.Count\")</strong></p>\n\n<p>I tried to call to the Count method dynamically without any success so far.</p>\n\n<p>I modified the code like this :</p>\n\n<pre><code>foreach(string prop in props)\n{\n    if (prop == \"Count\")\n    {\n        var countMethod = (typeof(Enumerable)).GetMethods().First(m =&gt; m.Name == \"Count\").MakeGenericMethod(type);\n        expr = Expression.Call(countMethod, expr);\n        break;\n    }\n\n    // Use reflection (not ComponentModel) to mirror LINQ.\n    PropertyInfo pi = type.GetProperty(prop);\n    expr = Expression.Property(expr, pi);\n    type = pi.PropertyType;\n}\n</code></pre>\n\n<p>But I have an exception on the <code>expr = Expression.Call(countMethod, expr);</code></p>\n\n<p>The exception is:</p>\n\n<pre><code>ArgumentException\nExpression of type 'System.Collections.Generic.ICollection`1[Employee]'\ncannot be used for parameter of type\n'System.Collections.Generic.IEnumerable`1[System.Collections.Generic.ICollection`1\n[Employee]]' of method 'Int32 Count[ICollection`1]\nSystem.Collections.Generic.IEnumerable`1[System.Collections.Generic.ICollection`1\nEmployee]])'\n</code></pre>\n\n<p>Any idea on how to achieve that?</p>\n"},{"tags":["c#","linq","var"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":117,"score":4,"question_id":12929999,"title":"how to get values from var-source with linq","body":"<p>I have a Dictionary:</p>\n\n<pre><code>Dictionary&lt;int, Type&gt; AllDrillTypes = new Dictionary&lt;int, Type&gt;()\n{\n  {13,typeof(TCHEMISTRY)},\n  {14,typeof(TDRILLSPAN)}\n};\n</code></pre>\n\n<p>where TCHEMISTRY and TDRILLSPAN are classes. Then I want to get rows from one of this classes like this: </p>\n\n<pre><code>Type T = AllDrillTypes[13];\nvar LC = Activator.CreateInstance( typeof(List&lt;&gt;).MakeGenericType( T ) );\nMethodInfo M = T.GetMethod(\"FindAll\", BindingFlags.Public | BindingFlags.Static, null, new Type[] { }, null);    \nLC = M.Invoke(null, new object[] { });\n</code></pre>\n\n<p>All this code works correctly. After that I need to get some rows like this:</p>\n\n<pre><code>var LingLC = from obj in LC where obj.RunID == 1001 select obj;\n</code></pre>\n\n<p>But this line causes error:</p>\n\n<blockquote>\n  <p>\"Could not find an implementation of the query pattern for source type\n  'object'. 'Where' not found.\"</p>\n</blockquote>\n\n<p>What's wrong with this code line?</p>\n"},{"tags":["c#","linq","programming-languages"],"answer_count":6,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":171,"score":2,"question_id":4086069,"title":"language feature vs framework feature","body":"<p>I was wondering where do you draw the line between a programming language feature and a platform feature.</p>\n\n<p>For instance, is Linq a C# language feature or a .NET feature. Does the programming language work like a specification for the platform?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12931007,"title":"order linq query by descending","body":"<p>I cannot work out how to get the following query to be distinct by <code>LatLong</code> (using the most recent entry):</p>\n\n<pre><code>var query = from ent in db.Entrants\n            select new { \n                  ent.idx, \n                  ent.LatLong, \n                  ent.Tip, \n                  ent.FirstName, \n                  ent.City, \n                  ent.Fragrance };\n</code></pre>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["c#","asp.net","linq","c#-4.0","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12911155,"title":"How to frame Linq Query for this condition","body":"<p>My Table fileds and values:</p>\n\n<p><strong>IdFavorite</strong>: 1,2,3,4,5</p>\n\n<p><strong>FavoriteName</strong>: Fav1, Fav2, Fav3, Fav4, Fav5</p>\n\n<p><strong>UserId</strong>: 1, 3, 3, 4, 3</p>\n\n<p><strong>PublicFavorite</strong>: 0, 1, 0, 1, 0</p>\n\n<p>As of now I used following Linq query to get the list of <strong>Favorite Names</strong> basd on the <strong>User ID</strong></p>\n\n<pre><code>public IList&lt;ReportFavorite&gt; GetReportFavorites(int userId)\n{\n    return _reportFavoriteRepository.GetMany(x =&gt; x.UserId == userId).ToList();\n}\n</code></pre>\n\n<p>Now, the condition is as above <strong>plus</strong>, I need to get all the <strong>Favorite Names</strong> that has <strong>PublicFavorite</strong> is 1. I need the Linq query according to this condition. Thanks.</p>\n\n<p>For eg: If My <strong>User Id</strong> is 3, then I should get the <strong>Favorite Names</strong> as <strong>Fav2</strong>, <strong>Fav3</strong>, <strong>Fav5</strong> and also <strong>Fav4</strong>(since <strong>PublicFavorite</strong> is 1)</p>\n"},{"tags":["linq","entity-framework","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":35,"score":-2,"question_id":12927915,"title":"Using Linq Retrieveing the data to SelectListItem","body":"<p>I have class studentList</p>\n\n<pre><code> public class studentList\n    {\n    public static IEnumerable&lt;SelectListItem&gt; GetStudents(int? ID)\n            {\n//code is required here\n    return ;\n            }\n        }\n</code></pre>\n\n<p>Iam getting ID into this method and now, I require all other IDs from the table, excluding the passed parameter ID using linq.</p>\n\n<p>I have Student table which contains Two fieds StudentID and StudentName,\nNow I require IDs and Names of the students in the above pattern..\nCould any one help me... </p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":36,"score":-2,"question_id":12913651,"title":"how to write a linq query which make s.th. like where id != List<id>","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/183791/how-would-you-do-a-not-in-query-with-linq\">How would you do a not in query with Linq?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a question about a LINQ query, I have a <code>List&lt;int&gt; foo;</code> and now I need to check something like:</p>\n\n<pre><code>var output = select a from db.User where a.id not in foo select a;\n</code></pre>\n\n<p>how can i realize this: <strong>a.id not in foo</strong> ?</p>\n"},{"tags":["c#","linq","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12925921,"title":"convert multi level for loop into linq or lambda expression","body":"<p>I already posted related question as follows: </p>\n\n<p><a href=\"http://stackoverflow.com/questions/12923220/replace-3-levels-of-nested-for-loops-by-efficient-code-possibly-linq\">replace 3 levels of nested for loops by efficient code possibly linq</a></p>\n\n<p>But since I am not good with Linq or Lambda expression.. I am not sure how to further expand on it.</p>\n\n<p>I have a slightly different 3 level nested for loop that I don't know how to transfer it into Linq or Lambda expression.. I have been tasked at work to come up with more efficient replacement code for the following in linq or lambda expression .. Please help. thanks..</p>\n\n<pre><code>public static void CompareEntities(\n    out EntityCollection&lt;StringResourceEntity&gt; entitiesDifference,\n    EntityCollection&lt;StringResourceEntity&gt; entitiesLargerSet,\n    EntityCollection&lt;StringResourceEntity&gt; entitiesSmallerSet)\n{\n    var diff = new EntityCollection&lt;StringResourceEntity&gt;();\n    string defaultCulture = LocalizationConfiguration.DefaultCulture;\n\n    foreach (StringResourceEntity entityLargerSet in entitiesLargerSet)\n    {\n        bool entityMatch = false;\n        foreach (StringResourceEntity entitySmallerSet in entitiesSmallerSet)\n        {\n            if (entityLargerSet.Key.Equals(entitySmallerSet.Key))\n            {\n                foreach (var stringResValSmall in entitySmallerSet.StringResourceValues)\n                {\n                    if (stringResValSmall.Culture.Equals(defaultCulture) &amp;&amp;\n                        stringResValSmall.Value.Length &gt; 0)\n                    {\n                        entityMatch = true;\n                    }\n                }\n            }\n        }\n\n        if (entityMatch == false)\n        {\n            diff.Add(entityLargerSet);\n        }\n    }\n\n    entitiesDifference = diff;\n}\n</code></pre>\n"},{"tags":["linq","lambda","anonymous-types","iequalitycomparer"],"answer_count":4,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":3540,"score":11,"question_id":1071609,"title":"IEqualityComparer for anonymous type","body":"<p>I have this</p>\n\n<pre><code> var n = ItemList.Select(s =&gt; new { s.Vchr, s.Id, s.Ctr, s.Vendor, s.Description, s.Invoice }).ToList();\n n.AddRange(OtherList.Select(s =&gt; new { s.Vchr, s.Id, s.Ctr, s.Vendor, s.Description, s.Invoice }).ToList(););\n</code></pre>\n\n<p>I would like to do this if it where allowed</p>\n\n<pre><code>n = n.Distinct((x, y) =&gt; x.Vchr == y.Vchr)).ToList();\n</code></pre>\n\n<p>I tried using the generic <a href=\"http://csharpfeeds.com/post/10941/LINQ%5FYour%5FCollections%5Fwith%5FIEqualityComparer%5Fand%5FLambda%5FExpressions.aspx\">LambdaComparer</a> but since im using anonymous types there is no type associate it with.</p>\n\n<p>\"Help me Obi Wan Kenobi, you're my only hope\"</p>\n"},{"tags":["javascript","linq","json","reactive-extensions-js"],"answer_count":7,"favorite_count":10,"up_vote_count":33,"down_vote_count":0,"view_count":5226,"score":33,"question_id":2478038,"title":"What is the leading LINQ for JavaScript library?","body":"<p>I'm looking for a JavaScript library that will allow me to query complex JSON objects using a LINQ-like syntax.  A quick search found a couple of promising options that look they might offer what I need:</p>\n\n<p><a href=\"http://jslinq.codeplex.com/\" rel=\"nofollow\">LINQ to JavaScript</a> and <a href=\"http://hugoware.net/Projects/jLinq\" rel=\"nofollow\">jLinq</a></p>\n\n<ul>\n<li>Does any one have any experience\nusing them?</li>\n<li>What are some pros and cons?</li>\n<li>Is the performance comparable?</li>\n<li>Does the function-passing syntax of\nLINQ to JavaScript offer any hidden benefits\n(I personally find the syntax of\njLinq more appealing on first\nglance)?</li>\n<li>What have you found lacking\nin either project?</li>\n<li>Did you ever try contacting the authors?  How responsive were they?</li>\n<li>What project is more widely used?  </li>\n</ul>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Just saw this today: <a href=\"http://jslinq.codeplex.com/\" rel=\"nofollow\">jsinq</a>.</p>\n\n<p>I think it will be the first one to get a thorough try-out.</p>\n"},{"tags":["c#","asp.net","linq","entity-framework"],"answer_count":6,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":355,"score":2,"question_id":12767721,"title":"LINQ Query matching two lists of items","body":"<p>my issue is that I have an attribute as 'attribute' coming in from entity framework.\nSo I retrieve this object which has a list of attribute tags, they are accessible via <code>attribute.AttributeTags</code>. Now I have a <code>asp:TextBox</code> where users can edit, remove and add new tags (comma separated). (On page load I am adding the attribute tags to this <code>TextBox</code>)</p>\n\n<p>After a postback on the page I am returning the user input and splitting it into an array of strings and storing it in a variable called <code>AttributeTags</code>.</p>\n\n<p>Now, I would like to add new tags that are not contained in the original <code>attributes</code> list coming from EF and would like to <code>remove</code> the ones that are contained in <code>attributes</code> but not found in the user input string array <code>AttributeTags</code>.</p>\n\n<p>I am doing something like this:</p>\n\n<pre><code>        BusinessObjects.Attribute attribute = db.Attributes.FirstOrDefault(a =&gt; a.attribute_id == AttributeID);\n        string[] AttributeTags = txtAttributeTags.Text.Split(new string[] { \",\" }, StringSplitOptions.RemoveEmptyEntries);\n        foreach (var item in AttributeTags)\n        {\n            if (!attribute.AttributeTags.Any(t =&gt; t.value == item))\n            {\n                AttributeTag tag = new AttributeTag { value = item, timestamp = DateTime.Now };\n                attribute.AttributeTags.Add(tag);\n            }\n            else\n            {\n                AttributeTag tag = attribute.AttributeTags.FirstOrDefault(t =&gt; t.value == item);\n            }\n        }\n</code></pre>\n\n<p>But I'm sort of stuck here since i'm fairly new to LINQ and EF.</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":12924398,"title":"Does Select() on a List lose track of the size of the collection?","body":"<p>In the following code, is the <code>Select()</code> method smart enough to keep the size of the list somewhere internally for the <code>ToArray()</code> method to be cheap?</p>\n\n<pre><code>List&lt;Thing&gt; bigList = someBigList;\nvar bigArray = bigList.Select(t =&gt; t.SomeField).ToArray();\n</code></pre>\n"},{"tags":["mysql","vb.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":178,"score":0,"question_id":9901770,"title":"using linq with mysql database in vb.net","body":"<p>how to use linq with mysql database in vb.net,I have searched on google but did not find clear tutorial on this?</p>\n\n<p>thanks</p>\n"},{"tags":["c#","linq","where-clause","fluent"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12923713,"title":"Unexpected Result LINQ Where Clause","body":"<p>I have a method that limits the items in a list via LINQ. The list contains items with two boolean properties: bool_a and bool_b. The list contains items where bool_a is true and bool_b is false as well as items where both are false. </p>\n\n<p>My expectation is that once I have limited the list only records where bool_a is false will remain while all items where both bool_a and bool_b are false will be removed. However, I'm finding that all items are being removed. It's as though the AND operator is behaving like an OR. </p>\n\n<p>An example follows. What am I not seeing?</p>\n\n<pre><code>var records = GetRecords();\nvar count_where_a_before = records .Where(x =&gt; x.bool_a); // 100 items\nvar count_where_ab_before = records .Where(x =&gt; x.bool_a &amp;&amp; x.bool_b); // 10 items\nrecords = records.Where(x =&gt; !x.bool_a &amp;&amp; !x.bool_b);\nvar count_where_a_after = records .Where(x =&gt; x.bool_a); // 0 items\n</code></pre>\n\n<p>As you can see from the above, I've been using counts before and after the where clause to evaluate the list. </p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":93,"score":-1,"question_id":12923220,"title":"replace 3 levels of nested for loops by efficient code possibly linq","body":"<p>Is there a way of replacing following 3 levels of nested for-loops into more efficient or cleaner code? Would linq be able to make it more efficient and easy to read?</p>\n\n<p>Please help. Thanks</p>\n\n<pre><code>bool myMatch = false;\n\nforeach (MyEntityClass entitySmallerSet in entitiesSmallerSet)\n{\n    if (entityLargerSet.Key.Equals(entitySmallerSet.Key))\n    {\n        foreach (var stringResValLarge in entityLargerSet.StringResourceValues)\n        {\n            foreach (var stringResValSmall in entitySmallerSet.StringResourceValues)\n            {\n                if (stringResValSmall.Culture.Equals(stringResValLarge.Culture)\n                    &amp;&amp; stringResValSmall.Value.Equals(stringResValLarge.Value))\n                {\n                    myMatch = true;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["asp.net-mvc","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12919590,"title":"How to solve \"Specified cast is not valid\" error when using linq query with multiple joins?","body":"<p>I'm having an issue where I'm trying to construct a Linq query in my repository that contains multiple joins from different tables in a database and then return this as an object for my controller to display. The error that I'm getting is: \"Specified cast is not valid.\"</p>\n\n<p>The problem part seems to be when I try to pass the object from my query and I'm not really sure how to solve this. (I'm still relatively new to web development and trying to learn the basics).</p>\n\n<p>Below is the code in my repository:</p>\n\n<pre><code>public ListingModel GetListing(int listingId)\n{\n        var query = from listing in listingsTable\n                    where listing.ListingID == listingId\n\n                    join feature\n                    in featuresTable on listing.ListingID equals feature.ListingID into features\n                    from f in features.DefaultIfEmpty()\n\n                    join avail\n                    in availabilityTable on listing.ListingID equals avail.ListingID into availability\n                    from a in availability.DefaultIfEmpty()\n\n                    join image\n                    in imageTable on listing.ListingID equals image.ListingID into images\n                    from i in images.DefaultIfEmpty()\n\n                    select new ListingModel\n                    {\n                        Listing = listing,\n                        Features = features,\n                        Availability = availability,\n                        Images = images\n                    };\n\n        return query.FirstOrDefault();\n}\n</code></pre>\n\n<p>If it's needed, here's the ListingModel class:</p>\n\n<pre><code>public class ListingModel\n{\n    public Listing Listing { get; set; }\n    public IEnumerable&lt;Feature&gt; Features { get; set; }\n    public IEnumerable&lt;Availability&gt; Availability { get; set; }\n    public IEnumerable&lt;Image&gt; Images { get; set; }\n}\n</code></pre>\n\n<p>When I try the query in LinqPad it works fine and returns the data exactly how I'd want it, so it seems to be erroring when I try to pass the object back. I've tried a few things with this and every time I seem to be getting the same error; I'm having real difficulty pinpointing what's causing it. Thanks in advance for any help given.</p>\n"},{"tags":["c#","linq","entity-framework","resharper"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":12923497,"title":"Using Queryable instead of Extension Method","body":"<p>ReSharper has proposed me to make the following changes:</p>\n\n<p>From:</p>\n\n<pre><code>foreach (var item in db.Proposta.GroupBy(x =&gt; x.StatusProposta.Nome))\n{\n    ...\n}\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>foreach (var item in Queryable.GroupBy(db.Proposta, x =&gt; x.StatusProposta.Nome))\n{\n    ...\n}\n</code></pre>\n\n<p>The message is: <strong>Invoke method 'GroupBy' as static method</strong></p>\n\n<p>I'm using <strong>Entity Framework</strong> and <strong>db</strong> is my context.</p>\n\n<p>I wonder what advantages may I get or problems I can avoid with such a change.</p>\n"},{"tags":["linq","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12906412,"title":"LINQ query (or lambda expression) to return records that match a list","body":"<p>I have a list of strings (converted from Guid) that contains the ID's of items I want to pull from my table.\nThen, in my LINQ query, I am trying to figure out how to do an in clause to pull records that are in that list.\nHere is the LINQ</p>\n\n<pre><code>var RegionRequests = (from r in db.course_requests\n                      where PendingIdList.Contains(r.request_state.ToString())\n                      select r).ToList();\n</code></pre>\n\n<p>It builds, but I get a run error: \"System.NotSupportedException: LINQ to Entities does not recognize the method 'System.String ToString()' method, and this method cannot be translated into a store expression\".\nI would prefer to compare guid to guid, but that gets me nowhere.\nCan this be converted to a lambda expression? If that is best, how?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":12921524,"title":"How to fill a property of an object from another list using LINQ","body":"<p>I have 2 lists of objects.  One has values, the other has names and values.  I want to look up the values in the other list and write the result to pref.Name.  I know I can do this with a foreach, but I assume there's a good way to do it in LINQ.  Ideas?</p>\n\n<pre><code>public class Preference\n    {\n        public string Category { get; set; }\n        public string Name { get; set; }\n        public string ItemValue { get; set; }\n        public int SortOrder { get; set; }\n    }\n\npublic class SAPReadOnlyItem\n    {\n        public string Category { get; set; }\n        public string Name { get; set; }\n        public string ItemValue { get; set; }\n    }\n\n    List&lt;Preference&gt; preferences = getExistingUserPreferences(UserID, ddlCategory.SelectedValue); //this list is just keys\n    List&lt;SAPReadOnlyItem&gt; sapReadOnlyItems = getSAPReadOnlyItems(ddlCategory.SelectedValue); //this list is names and keys\n\n    //i want to look up the name from sapReadOnly using the ID from preferences and write it into preferences[n].Name\n\n    //this works, but I want to write it into preferences[n].Name\n    var foobar = (from sap in sapReadOnlyItems\n                  join pref in preferences \n                  on sap.ItemValue equals pref.ItemValue\n                  select new { asdf = sap.Name }).FirstOrDefault(); //instead of \"select new\" I want to write it into preferences[n].Name\n</code></pre>\n"},{"tags":["vb.net","linq","datatable","group-by","dataset"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":12901569,"title":"Group by a column then Add each group to datatable then into a dataset","body":"<p>what would be the best approach to such thing?</p>\n\n<p>so here is my Datatable</p>\n\n<pre><code>\n Product Name   Product Price  Product Group \n\n Skirt Red                 99              1 \n Jeans Blue                49              2 \n Jeans Black               49              2 \n Skirt Blue                99              1 \n T-shirt White             20              3 \n T-shirt Green             20              3 \n Jeans Grey                49              2 \n\n</code></pre>\n\n<p>i will group this datatable by the product group column using LINQ to produce the following groups</p>\n\n<pre><code>Group #1\n    \n     Product Name   Product Price  \n    \n     Skirt Red                 99              \n     Skirt Blue                99              \n    \n\nGroup #2\n        \n         Product Name   Product Price  \n        \n         Jeans Blue                49              \n         Jeans Black               49  \n         Jeans Grey                49 \n        \nGroup #3\n        \n         Product Name   Product Price  \n        \n         T-Shirt White             20              \n         T-Shirt Green             20  \n        \n</code></pre>\n\n<p>now the questions are </p>\n\n<ol>\n<li>how do i group by the Product group column using LINQ (Done)</li>\n<li>how do i remove the Product group column from the resulted group?</li>\n<li>how do i add each group to a seperate datatable and then add all \ntables to single dataset?(Done)</li>\n<li>suppose there were columns that i dont want to show in the resulted\ngroup, how can i hide them?</li>\n</ol>\n\n<p>here is what I've tried so far</p>\n\n<pre><code>    Dim ds As New DataSet\n    Dim query = From r In bookedorders Group By key = r.Field(Of Integer)(\"productgroup\") Into Group\n    For Each grp In query\n        Dim x As New DataTable\n        x = grp.Group.CopyToDataTable()\n        ds.Tables.Add(x)\n    Next\n</code></pre>\n\n<p>now this is working except i am not sure how to select specific columns, like i don't want to show all columns in the resulted datatables</p>\n"},{"tags":["vb.net","linq","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12917364,"title":"EF4 / LINQ: Retrieving two child-nodes in one query","body":"<p>here is my little issue: I have an EF4, code-first project based on the following data-structure. </p>\n\n<p>Say, as entities I have a house, having multiples rooms, each with multiple windows. That's pretty linear. But the window holds a collection of materials as well as a collection of colors. I now want to load the house, the depending rooms, depending windows, depending color <strong>and</strong> material.</p>\n\n<p>I use the following code to load all houses, with either their depending </p>\n\n<ul>\n<li>room -> window -> material or</li>\n<li>room -> window -> color by using the following code:</li>\n</ul>\n\n<p><code><pre>// house -> room -> window -> material\nqueryableHouses.Include(Of Room)(Function(u) CType(u.Rooms.Select(Function(v) v.Windows.Select(Function(w) w.Materials)), Room))\n// house -> room -> window -> color\nqueryableHouses.Include(Of Room)(Function(u) CType(u.Rooms.Select(Function(v) v.Windows.Select(Function(w) w.Colors)), Room))</pre></code></p>\n\n<p>How can I get a single result-set containing material AND color? </p>\n\n<p>Thank you very much in advance!</p>\n"},{"tags":[".net","linq","entity-framework",".net-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12921415,"title":"Decompiling Linq queries from .net assembly","body":"<p>I have to decompile an assembly that contains some linq-to-sql code (about 30 methods). I have tried many decompilers like dotpeek, Telerik's just decompile, RedGate's .NET reflactor (evaluation) but all of them decompile linq queries in form of dynamic linq. Is there a free reflactor that can extract original linq queries from .NET assembly?</p>\n\n<p>Regards</p>\n"},{"tags":["c#","linq",".net-3.5","sorting","generic-list"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2784,"score":1,"question_id":3062373,"title":"How can i sort Generic list with Linq?","body":"<p>How can i sort  myScriptCellsCount.MyCellsCharactersCount (list int type) in linq</p>\n\n<pre><code>    public class MyExcelSheetsCells\n    {\n        public List&#60;int&#62; MyCellsCharactersCount { get; set; }\n\n        public MyExcelSheetsCells()\n        {\n            MyCellsCharactersCount = new List&#60;int&#62;();\n        }\n\n    }</code></pre>\n\n<pre><code>   void ArrangedDataList(DataTable dTable)\n        {\n            DAL.MyExcelSheets myexcelSheet = new DAL.MyExcelSheets();\n            myScriptCellsCount = new TestExceltoSql.DAL.MyExcelSheetsCells();\n\n            foreach (DataColumn col in dTable.Columns)\n                myexcelSheet.MyColumnNames.Add(col.ColumnName.ToString());\n            foreach(DataColumn dc in dTable.Columns)\n            foreach (DataRow  dr in dTable.Rows)\n                myScriptCellsCount.MyCellsCharactersCount.Add(dr[dc].ToString().Length);\n          //How can i sort desc\n            //myScriptCellsCount.MyCellsCharactersCount = from list in myScriptCellsCount.MyCellsCharactersCount\n            //                                            orderby list.CompareTo( descending\n            //                                            select list;\n            CreatSqlTable(myexcelSheet.MyColumnNames, dTable.TableName, myScriptCellsCount.MyCellsCharactersCount[0].ToString());\n            myscript.WriteScript(myscript.SqlScripts);\n        }</code></pre>\n"},{"tags":["c#","linq","lambda"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3438,"score":3,"question_id":1407243,"title":"Problem with Generic Linq OrderBy function","body":"<p>I saw the following function in a posting which allows one to order data using a generic expression:</p>\n\n<pre><code>public static IOrderedQueryable&lt;T&gt; OrderBy&lt;T, TKey&gt;(\n  this IQueryable&lt;T&gt; source, Expression&lt;Func&lt;T, TKey&gt;&gt; func, bool isDescending) {\n  return isDescending ? source.OrderByDescending(func) : source.OrderBy(func);\n}\n</code></pre>\n\n<p>When I try to use this function I get an error saying \"The type or namespace name \"TKey' could not be found (are you missing a using directive or an assembly reference?)\".  I'm doing something dumb here but I can't figure it out.</p>\n\n<p>Edit:</p>\n\n<p>After doing a bit more research, I think my problem is in building the Expression that I pass into it.  Is it possible to build an expression that can contain different types?  Let's say my dataset has a string, an int, and a bool and I want to use the generic function above to sort by any of the items.  How do I do this?</p>\n\n<p>I have this working now:</p>\n\n<pre><code>if (IsString)\n{\n   Expression&lt;Func&lt;T, string&gt;&gt; expString = ...;\n   // call orderBy with expString\n}\nelse if (IsInt)\n{\n   Expression&lt;Func&lt;T, int&gt;&gt; expInt;\n   // call orderBy w/ expInt\n}\n:\n</code></pre>\n\n<p>I want something like:</p>\n\n<pre><code>Expression&lt;Func&lt;T, {something generic!}&gt;&gt; exp;\nif (IsString)\n    exp = ...;\nelse if (IsInt)\n    exp = ...;\n:\n// call orderBy with exp\n</code></pre>\n"},{"tags":["c#",".net","linq","entity-framework","expression-trees"],"answer_count":5,"favorite_count":16,"up_vote_count":20,"down_vote_count":0,"view_count":20317,"score":20,"question_id":307512,"title":"How do I apply OrderBy on an IQueryable using a string column name within a generic extension method?","body":"<pre><code>public static IQueryable&lt;TResult&gt; ApplySortFilter&lt;T, TResult&gt;(this IQueryable&lt;T&gt; query, string columnName)\n  where T : EntityObject\n{\n  var param = Expression.Parameter(typeof(T), \"o\");\n  var body = Expression.PropertyOrField(param,columnName);\n\n  var sortExpression = Expression.Lambda(body, param);\n  return query.OrderBy(sortExpression);\n}\n</code></pre>\n\n<p>Because the type for OrderBy is not inferred from sortExpression I need to specify it something like this at run time:</p>\n\n<pre><code>var sortExpression = Expression.Lambda&lt;T, TSortColumn&gt;(body, param);\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>return query.OrderBy&lt;T, TSortColumn&gt;(sortExpression);\n</code></pre>\n\n<p>I don't think this is possible however as TSortColumn can only be determined during runtime.</p>\n\n<p>Is there a way around this?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12919504,"title":"Linq dynamically adding where conditions","body":"<p>I have a gridview which has drop down boxes in each header for filtering. Each filter is loaded with the distinct values from its column when loaded. At run time, I add \"ALL\" to allow the user to select all from that field. I am trying to build the linq statement dynamically to ignore the field if the drop down box is set to \"ALL\". Is this possible? I want to see if I can do this in one single statement. The example below only shows 2 dropdown boxes, but my actually case has up to 5. </p>\n\n<p>If I choose to use if then statements, I end up with spaghetti code.</p>\n\n<pre><code>DropDownList drpOwners = this.grdOtherQuotes.HeaderRow.FindControl(\"drpOwners\") as DropDownList;                     \nDropDownList drpCompanyName = this.grdOtherQuotes.HeaderRow.FindControl(\"drpCompanyName\") as DropDownList;\n\nvar filteredList = (from x in allQuotes\n                          where (drpOwners.SelectedValue != ALL) ? x.SalesRepFullName == drpOwners.SelectedValue:true                                    \n                                &amp;&amp; drpCompanyName.SelectedValue != ALL ? x.CompanyName == drpCompanyName.SelectedValue: true\n                          select x);\n</code></pre>\n"},{"tags":["asp.net","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12919250,"title":"Insert & Delete values in many to many relation table","body":"<p>I want to insert values to many to many relation table \nI'm using entity framework &amp; linq. and I want to build up the Insert query (.net Framework 4)</p>\n\n<p>following are the tables</p>\n\n<p>Menus -\n    menu_id,\n    menu_name,\n    menu_desc</p>\n\n<p>Cater  - cater_id,\n           cater_name, \n           enable_ind</p>\n\n<p>Relation table\nMenu_Cater -    menu_id,\n                    cater_id</p>\n\n<p>I have tried with couple of cases seems not working, \nif there is a SIMPLE way of implementing this insert &amp; delete</p>\n"},{"tags":["c#","linq","reflection","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12915864,"title":"Copy Properties of one object to another object","body":"<p>Relate to : <a href=\"http://stackoverflow.com/questions/12881866/set-properties-that-not-null-using-linq-and-reflection/12881949#12881949\">Set Properties that not null using linq and reflection</a></p>\n\n<p>Hi experts</p>\n\n<p>I change the code in above link:</p>\n\n<pre><code>public static void MyCopy&lt;T&gt;(this T src, T dest)\n{\n    var notNullProps = typeof(T).GetProperties()\n                                .Where(x =&gt; x.GetValue(src, null) != null);\n\n    foreach (var p in notNullProps)\n    {\n        p.SetValue(dest, p.GetValue(src, null),null);\n    }\n} \n</code></pre>\n\n<p>and I wrote this code to copy peroperties:</p>\n\n<pre><code>NorthwindModel1.Order ord1 = new NorthwindModel1.Order() {CustomerID=\"Nima\",Freight=1.33m,ShipCity=\"Agha\" };\nNorthwindModel1.Order ord2 = new NorthwindModel1.Order() ;\n\nord1.MyCopy(ord2);\n</code></pre>\n\n<p>but I got this error:</p>\n\n<blockquote>\n  <p>The EntityReference has already been initialized. InitializeRelatedReference should only be used to initialize a new EntityReference during deserialization of an entity object. </p>\n</blockquote>\n\n<p>please help me to solve this problem</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":109,"score":3,"question_id":12912873,"title":"How can I use LINQ to calculate the longest streak?","body":"<p>Currently, this is just something I am curious about, I don't have any code I am working on but I am wondering how this could be achieved...</p>\n\n<p>Lets say for example that I have an application that tracks the results of all the football teams in the world. What I want to be able to do is to identify the longest \"win\" streak for any given team.</p>\n\n<p>I imagine I would most likely have some sort of data table like so:</p>\n\n<ul>\n<li>MatchDate datetime</li>\n<li>TeamA string</li>\n<li>TeamB string</li>\n<li>TeamAGoals int</li>\n<li>TeamBGoals int</li>\n</ul>\n\n<p>So what I would want to do for example is find the longest win streak where <code>TeamA = \"My Team\"</code> and obviously this would mean <code>TeamAGoals</code> must be greater than <code>TeamBGoals</code>.</p>\n\n<p>As I have said, this is all just for example. It may be better for a different DB design for something like this. But the root question is how to calculate the longest streak/run of matching results.</p>\n"},{"tags":["asp.net","sql","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":98,"score":1,"question_id":12918128,"title":"Connect to SQL server using Linq, asp.net","body":"<p>I`m creating a website using asp.net, and I need to use a local SQL server (using Microsoft SQL server). And I have created database and tables in it using the MS SQL Server Management Studio.</p>\n\n<p>Now I successfully connect to the database and do some simple add/query using the following commands:</p>\n\n<pre><code>string connectionString = \"data source=ABCD\\\\SQLEXPRESS;initial catalog=PMD;Trusted_Connection=yes;\";\n\nstring sqlQuery = \"INSERT INTO PMD (username, userID, userAddress)\";\nsqlQuery +=               \" VALUES (@user,    id,     add)\";\nSqlConnection dataConnection = new SqlConnection(connectionString);\nSqlCommand dataCommand = new SqlCommand(sqlQuery, dataConnection);\n\ndataCommand.Parameters.AddWithValue(\"user\", USER.Value);\ndataCommand.Parameters.AddWithValue(\"id\", ID.Value);\ndataCommand.Parameters.AddWithValue(\"add\", ADDRESS.Text);\n\ndataConnection.Open();\ndataCommand.ExecuteNonQuery();\ndataConnection.Close();\n</code></pre>\n\n<p>The command above can add one column to the table, with values stated.\nThe query is done in a similar way. Compared with Linq, this is not very concise.</p>\n\n<p>So I was wondering how can I change the code so I can use Linq.</p>\n\n<p>The biggest question for me now is how to connect to the base. I already know all the syntax of Linq.</p>\n\n<pre><code>eg: var query=from c in db.username where c.Contain(Micheal) select c (or maybe db.PMD.username)\n</code></pre>\n\n<p>How can I get the db to link with ABCD/SQLEXPRESS, table PMD?</p>\n"},{"tags":["c#","xml","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12816102,"title":"Xml updating with linq not working when quering","body":"<p>I have problem i'm trying to update a specific part of the XML with the linq query but it doesn't work. So i an xml file:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;DesignConfiguration&gt;\n  &lt;Design name=\"CSF_Packages\"&gt;\n    &lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;\n    &lt;DestinationFolder&gt;C:\\Documents and Settings\\xxx&lt;/DestinationFolder&gt;\n    &lt;CopyLookups&gt;True&lt;/CopyLookups&gt;\n    &lt;CopyImages&gt;False&lt;/CopyImages&gt;\n    &lt;ImageSourceFolder&gt;None&lt;/ImageSourceFolder&gt;\n    &lt;ImageDesinationFolder&gt;None&lt;/ImageDesinationFolder&gt;\n  &lt;/Design&gt;\n&lt;/DesignConfiguration&gt;\n</code></pre>\n\n<p>I want to select the part where the part where there is <code>Design name=\"somethning\"</code> and get the descendants and then update the descendants value that means this part:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;\n    &lt;DestinationFolder&gt;C:\\Documents and Settings\\xxx&lt;/DestinationFolder&gt;\n    &lt;CopyLookups&gt;True&lt;/CopyLookups&gt;\n    &lt;CopyImages&gt;False&lt;/CopyImages&gt;\n    &lt;ImageSourceFolder&gt;None&lt;/ImageSourceFolder&gt;\n    &lt;ImageDesinationFolder&gt;None&lt;/ImageDesinationFolder&gt;\n</code></pre>\n\n<p>I have this code: </p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>        XDocument configXml = XDocument.Load(configXMLFileName);\n\n        var updateData = configXml.Descendants(\"DesignConfiguration\").Elements().Where(el =&gt; el.Name == \"Design\" &amp;&amp;\n            el.Attribute(\"name\").Value.Equals(\"CSF_Packages\")).FirstOrDefault();\n\n        configXml.Save(configXMLFileName);\n</code></pre>\n\n<p>I'm getting the null data in the <code>updateData</code> varibale. When I'm trying the Descendat's function through QuickWatch it also returns a null value. When I'm checking the configXML variable it has data that is my whole xml. What am I doing wrong? </p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":77,"score":-1,"question_id":12916501,"title":"How Can I replace my second and third index of array with last index of array _c# Linq?","body":"<p>Actually I have a list like</p>\n\n<pre><code>oldList= ['First','Second','Third',.....'Seventh'];\n</code></pre>\n\n<p>newArray should be like that</p>\n\n<pre><code>newArray=['First',.........'Seventh','Second','Third']\n</code></pre>\n\n<p>so How can I provide ordering like that with linq c#? </p>\n\n<p>I mean my first element should be kept at old place. but I have to skip second and third elements to end of the list</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12916460,"title":"Pass a value to an OrderBy or OrderByDescending statement in Linq?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/41244/dynamic-linq-orderby\">Dynamic LINQ OrderBy</a>  </p>\n</blockquote>\n\n\n\n<p>How can I pass a value to an OrderBy or OrderByDescending statement in Linq? I am trying to get the property name dynamically:</p>\n\n<pre><code>x.GetType().GetProperty(sortField)\n</code></pre>\n\n<p>Which doesnt seem to work. Any Ideas?</p>\n\n<pre><code>private void DynamicSort(ref List&lt;Quote&gt; myQuotes, String sortField, String direction)\n{         \n        if(direction == \"ASC\"){\n            this.grdViewDrafts.DataSource = myQuotes.OrderBy(x =&gt;  x.GetType().GetProperty(sortField)).ToList();\n        }else{\n            this.grdViewDrafts.DataSource = myQuotes.OrderByDescending(x =&gt; x.GetType().GetProperty(sortField)).ToList();\n        }\n\n}\n</code></pre>\n\n<p>Solution: </p>\n\n<pre><code>this.grdViewDrafts.DataSource =  myQuotes.OrderBy(x =&gt; x.GetType().GetProperty(sortField).GetValue(x, null)).ToList(); \n</code></pre>\n"},{"tags":["c#","xml","linq","string"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":410,"score":0,"question_id":5624872,"title":"how to parse this Xml type string","body":"<p>Can some one guide me how to parse this Xml type string ?</p>\n\n<pre><code>&lt;data&gt;\n  &lt;LastUpdate&gt;&lt;/LastUpdate&gt;\n  &lt;AC1&gt;12&lt;/AC1&gt;\n  &lt;AC2&gt;13&lt;/AC2&gt;\n  &lt;AC3&gt;14&lt;/AC3&gt;\n  &lt;Moter&gt;&lt;/Moter&gt;\n  &lt;Fan1&gt;&lt;/Fan1&gt;\n  &lt;Fan2&gt;&lt;/Fan2&gt;\n  &lt;TubeLight1&gt;&lt;/TubeLight1&gt;\n  &lt;TubeLight2&gt;&lt;/TubeLight2&gt;\n  &lt;Moter&gt;&lt;/Moter&gt;\n  &lt;CloseAll&gt;&lt;/CloseAll&gt;\n&lt;/data&gt;\n</code></pre>\n\n<p>I need to get all result in String or List or dictionary like\nAC1=12 , AC2=13 and so on</p>\n\n<p>Thnaks in advance</p>\n"},{"tags":["vb.net","linq","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":12904484,"title":"Using .ToString inside a LINQ query select statement","body":"<p>I have the following LINQ to entities query <em>(using odp.net)</em>:</p>\n\n<pre>\nDim query = from Elemento in X.VIEW\n            where Elemento.code = \"10\"\n            Select New With {Elemento.code, .Time = Elemento.Time.ToString(\"HH:mm\")}\nquery.ToList()\n</pre>\n\n<p>And the code throws an exception on the <code>ToList()</code> method:</p>\n\n<p><code>LINQ to Entities does not recognize the method 'System.String ToString()'</code></p>\n\n<p>I've read all over SO about this but haven't found an easy workaround.</p>\n\n<hr>\n\n<p>Lazyberezovsky has the right answer, I couldn't get it to work before because I was doing this:</p>\n\n<pre>\nDim query = (from Elemento in X.VIEW\n            where Elemento.code = \"10\"\n            Select New With {Elemento.code, Elemento.Time}).ToList\nDim query2 = from elemento in query\n        Select New With {elemento.code, TIME = elemento.Time.ToString(\"HH:mm\")}\n\nDim result = query2.ToList()\n</pre>\n\n<p>But this doesn't work, apparently you have to do it in a single step.</p>\n"},{"tags":["c#","linq","datatable","group"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12914261,"title":"DataTable group the result","body":"<p>I want to group in Datatable by Name, LastName and the rest should be in same row. Can someone help me with it?</p>\n\n<p>My DataTable:            </p>\n\n<pre><code> Name   LastName    1    3    2\n kiki    ha         FF\n lola    mi             AA\n ka      xe                   UU\n kiki    ha                   SS\n</code></pre>\n\n<p>I want to have DataTable group by Name:</p>\n\n<pre><code>Name   LastName   1    3     2\nkiki    ha        FF         SS \nlola    mi             AA \nka      xe                   UU\n</code></pre>\n\n<p>My new code:</p>\n\n<pre><code>    var result11 = from t1 in newtable.AsEnumerable()\n                   group t1 by new { Name = t1.Field&lt;String&gt;(\"Name\"), LastName = t1.Field&lt;String&gt;(\"LastName\") } into grp\n                 select new\n                 {\n                     Name = grp.Key.Name,\n                     LastName = grp.Key.LastName,\n\n                     //Something must be there     \n                 };\n</code></pre>\n"},{"tags":["c#",".net","xml","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12915507,"title":"Linq to xml for loop terminating early and unexpectedly","body":"<p>My linq to xml foreach loop is terminating early and unexpectedly. No exception raised. What's going on?</p>\n\n<hr>\n\n<pre><code>var doc = XDocument.Parse(\"&lt;a&gt;&lt;b&gt;one&lt;/b&gt;&lt;b&gt;two&lt;/b&gt;&lt;/a&gt;\");\n\nforeach(var element in doc.Root.Elements(\"b\"))\n{\n element.ReplaceWith(XElement.Parse(\"&lt;c&gt;fixed&lt;/c&gt;\"));\n}\n\ndoc.Dump();\n</code></pre>\n\n<p>Gives me</p>\n\n<pre><code>&lt;a&gt;\n  &lt;c&gt;fixed&lt;/c&gt;\n  &lt;b&gt;two&lt;/b&gt;\n&lt;/a&gt;\n</code></pre>\n\n<p>When I expected</p>\n\n<pre><code>&lt;a&gt;\n  &lt;c&gt;fixed&lt;/c&gt;\n  &lt;c&gt;fixed&lt;/c&gt;\n&lt;/a&gt;\n</code></pre>\n"},{"tags":["c#","xml","linq","distinct","iequalitycomparer"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":291,"score":2,"question_id":7798229,"title":"IEqualityComparer with Linq to XML and Distinct() is not executed in code?","body":"<p>It doesnt matter what I write in the Equals method. The GetHashCode is always fired, but I do not know whose GetHashCode to return?</p>\n\n<p>When the GetHashCode method is called then variable x has the following data:</p>\n\n<p>In the first unitName elementName is the value \"This is the value I want to compare\" ...</p>\n\n<pre><code>&lt;unit&gt;\n  &lt;unitName&gt;This is the value I want to compare&lt;/unitName&gt;\n  &lt;units&gt;\n    &lt;unit&gt;\n      &lt;unitName&gt;xxx&lt;/unitName&gt;      \n      &lt;units&gt;\n        &lt;unit&gt;\n          &lt;unitName&gt;cccc&lt;/unitName&gt;\n          &lt;test&gt;33&lt;/test&gt;\n          &lt;test&gt;44&lt;/test&gt;                   \n        &lt;/unit&gt;\n      &lt;/units&gt;          \n        &lt;/unit&gt;\n    &lt;/units&gt;        \n&lt;/unit&gt;\n</code></pre>\n\n\n\n<pre><code>IEnumerable&lt;XElement&gt; tempMemberList = doc.Elements(\"dep\").Descendants(\"customers\").Distinct(new XElementComparer());\n\npublic class XElementComparer : IEqualityComparer&lt;XElement&gt; {\n    public bool Equals(XElement x, XElement y) {\n\n        return x.Value == y.Value;\n    }\n\n    public int GetHashCode(XElement x) {\n        return x.GetHashCode();\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":12840428,"title":"MVC Entity Framework Count","body":"<p>I would like to build a result like: <strong>CategoryID || Count(Searches) || CategoryName</strong> based on two Entity Framework based classes:</p>\n\n<pre><code>public class Category\n{\n    // Primary properties\n    public int Id { get; set; }\n    public string Name { get; set; }\n    public string SearchPreviewControllerAction { get; set; }\n}\n\npublic class Search\n{\n    // Primary properties\n    public int Id { get; set; }\n    public string SearchTitle { get; set; }\n    public string SearchStandard { get; set; }\n    public int CategoryId { get; set; }\n\n    // Navigation properties\n    public virtual Category Category { get; set; }\n}\n</code></pre>\n\n<p>I already made a SearchPreview method that returns the Searches based on a search like \"Aston Martin\" that will find in all categories with the words \"Aston Martin\".</p>\n\n<p>The challenge now is to build a method that returns, after the Search of the keywords \"Aston Martin\", in which categories there are those keywords including the count, like \"Auto: 2 | Seeling point: 3 | Shop: 2\"</p>\n\n<p>I am trying to avoid a query for each category to count the number of Searches entry, and I would like to find a <em>GroupBy</em> solution, that takes the SearchPreview method already executed and extract the <em>GroupBy</em> Categories that it contains.</p>\n\n<p>I am using the ViewModel <code>SearchPreviewListCategoriesViewModel</code> to map from the models using Automapper:</p>\n\n<pre><code>public class SearchPreviewListCategoriesViewModel\n{\n    public int CategoryID { get; set; }\n    public string Name { get; set; }\n    public string SearchPreviewControllerAction { get; set; }\n    public int SearchCount { get; set; }\n}\n</code></pre>\n\n<p>Hope somoeone can help me on this.</p>\n\n<p>Thank you.</p>\n\n<p>Regards,</p>\n\n<p>Patrick.</p>\n"},{"tags":["c#","xml","linq","xmlwriter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12914155,"title":"Save XDocument element by element to avoid memory exceptions","body":"<p>How to modify my class in order to build large <code>XML</code> files? I try to use <code>XmlTextWriter</code>, but I don't know how to use it with <code>XDocument</code>. I'd like to write each <code>newElement</code>, then dispose it (in order to free RAM). Is there any possibility to do that? I know that I can use <code>XmlTextWriter</code> built-in methods to do this, but I don't want to resign from using <code>LINQ</code>...</p>\n\n<p>Here's my class: <a href=\"http://pastebin.com/p6VfpBFg\" rel=\"nofollow\">http://pastebin.com/p6VfpBFg</a></p>\n"},{"tags":["json","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12912999,"title":"Use Linq to get the last array from a Json response","body":"<p>I have a Json response which contains multiple arrays from which I need to get the last array. I want to select ExpenseDescriptions and return just this to the ajax call using Linq. ExpenseDescription is always the last array returned. The structure of my response is as follows:</p>\n\n<pre><code>{\n\"Data\": {\n    \"Items\": [\n        {\n            \"Result\": {\n                \"Id\": \"Some Data\"\n            }\n        },\n        {\n            \"Result\": {\n                \"Id\": \"Some More Data\"\n            }\n        },\n        {\n            \"Result\": {\n                \"ExpenseDescriptions\": [\n                    {\n                        \"Code\": \"TRH8\",\n                        \"Description\": \"Some Description\",\n                        \"UnitCost\": 0,\n                        \"MaxThreshold\": 0,\n                        \"MinThreshold\": 0\n                    },\n                    {\n                        \"Code\": \"VVFT3\",\n                        \"Description\": \"Some Description\",\n                        \"UnitCost\": 0,\n                        \"MaxThreshold\": 0,\n                        \"MinThreshold\": 0\n                    }\n                ]\n            }\n        }\n    ]\n}\n}\n</code></pre>\n\n<p>I can use linq to do some basic clauses but can't figure out or find a way that lets me do the above. Any help in doing this with Linq would be appreciated.</p>\n"},{"tags":["c#","database","linq","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12903622,"title":"NHibernate linq extensions order child objects collection","body":"<p>I'm trying to query my db with NH Linq extensions and here is where I am stuck:</p>\n\n<p>I have a <code>Customer</code> object and it has a property of type <code>Order</code>, and <code>Order</code> has an <code>ICollection&lt;Orderline&gt;</code> collection, and lastly <code>Orderline</code> object has a property of type <code>int</code> called '<code>price</code>'. What I want to do is, given a customerId, I should get all customer information(Order and Orderline) and  the collection of <code>Orderline</code> objects should be ordered by <code>Orderline's</code> price property. I've left out all other details for clarity.</p>\n\n<p>Note: In this case the relation between <code>Customer</code> and <code>Order</code> is <code>1 to 1</code>. A customer can have only 1 order, an <code>Order</code> may contain many <code>Orderlines</code> as you may infer from the collection type.</p>\n\n<p>Many thanks for any help...</p>\n"},{"tags":["c#","asp.net","xml","linq","grouping"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12909799,"title":"Grouping of Xml Elements using Linq","body":"<p>I am having following xml.What i need to do is,i want to <code>group</code> rows in each table using  their <code>locid</code> using linq.</p>\n\n<pre><code>&lt;taxdata schema=\"3\" nextrowid=\"812\" timesaved=\"0\" calcmode=\"1\" calcneeded=\"0\"&gt;\n  &lt;table name=\"aatbl_entity\" id=\"1\" ver=\"102\" ddtime=\"11-10-2012 17:57:08\" locs=\"\" /&gt; \n  &lt;table name=\"aatbl_entityactivity\" id=\"2\" ver=\"102\" ddtime=\"11-10-2012 17:57:08\" locs=\"\" key0=\"2\"&gt;\n        &lt;row name=\"\" locid=\"100\" rows=\"71\" rowid=\"71\" Ks0=\"1\"&gt; &lt;/row&gt;\n        &lt;row name=\"\" locid=\"48\" rows=\"52\" rowid=\"52\" Ks0=\"8\"&gt; &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6148\" rows=\"216\" rowid=\"216\" Ks0=\"16\"&gt; &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6148\" rows=\"217\" rowid=\"217\" Ks0=\"17\"&gt; &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6148\" rows=\"218\" rowid=\"218\" Ks0=\"18\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6154\" rows=\"219\" rowid=\"219\" Ks0=\"19\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6154\" rows=\"220\" rowid=\"220\" Ks0=\"20\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6154\" rows=\"221\" rowid=\"221\" Ks0=\"21\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6154\" rows=\"222\" rowid=\"222\" Ks0=\"22\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6154\" rows=\"223\" rowid=\"223\" Ks0=\"23\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6209\" rows=\"224\" rowid=\"224\" Ks0=\"24\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6127\" rows=\"233\" rowid=\"233\" Ks0=\"32\"&gt;   &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6127\" rows=\"234\" rowid=\"234\" Ks0=\"33\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6127\" rows=\"235\" rowid=\"235\" Ks0=\"34\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"36\" rows=\"236\" rowid=\"236\" Ks0=\"35\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"36\" rows=\"244\" rowid=\"244\" Ks0=\"43\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"111\" rows=\"266\" rowid=\"266\" Ks0=\"51\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"111\" rows=\"752\" rowid=\"752\" Ks0=\"59\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6192\" rows=\"361\" rowid=\"361\" Ks0=\"55\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"10\" rows=\"810\" rowid=\"810\" Ks0=\"60\"&gt; &lt;/row&gt;\n        &lt;row name=\"\" locid=\"10\" rows=\"811\" rowid=\"811\" Ks0=\"61\"&gt; &lt;/row&gt;\n        &lt;row name=\"\" locid=\"10\" rows=\"812\" rowid=\"812\" Ks0=\"62\"&gt;  &lt;/row&gt;\n  &lt;/table&gt; \n &lt;table name=\"aatbl_entityactivitydetail\" id=\"13\" ver=\"102\" ddtime=\"11-10-2012 17:57:09\" locs=\"\" key0=\"2\" key1=\"5\"&gt;\n        &lt;row name=\"\" locid=\"6327\" rows=\"90\" rowid=\"90\" Ks0=\"1\" Ks1=\"1\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6327\" rows=\"104\" rowid=\"104\" Ks0=\"1\" Ks1=\"2\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6327\" rows=\"118\" rowid=\"118\" Ks0=\"1\" Ks1=\"3\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6327\" rows=\"133\" rowid=\"133\" Ks0=\"1\" Ks1=\"4\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6327\" rows=\"522\" rowid=\"522\" Ks0=\"3\" Ks1=\"1\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6327\" rows=\"529\" rowid=\"529\" Ks0=\"3\" Ks1=\"2\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6327\" rows=\"536\" rowid=\"536\" Ks0=\"3\" Ks1=\"3\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"6327\" rows=\"543\" rowid=\"543\" Ks0=\"3\" Ks1=\"4\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"101\" rows=\"177\" rowid=\"177\" Ks0=\"1\" Ks1=\"5\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"101\" rows=\"563\" rowid=\"563\" Ks0=\"3\" Ks1=\"5\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"105\" rows=\"185\" rowid=\"185\" Ks0=\"1\" Ks1=\"6\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"105\" rows=\"564\" rowid=\"564\" Ks0=\"3\" Ks1=\"6\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"106\" rows=\"186\" rowid=\"186\" Ks0=\"1\" Ks1=\"7\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"106\" rows=\"565\" rowid=\"565\" Ks0=\"3\" Ks1=\"7\"&gt;  &lt;/row&gt;\n        &lt;row name=\"\" locid=\"106\" rows=\"2\" rowid=\"2\" Ks0=\"3\" Ks1=\"7\"&gt; &lt;/row&gt;\n  &lt;/table&gt;\n  &lt;table name=\"aatbl_entityactivityasset\" id=\"14\" ver=\"102\" ddtime=\"11-10-2012 17:57:09\" locs=\"\" key0=\"2\" key1=\"9\" \n&lt;/taxdata&gt;\n</code></pre>\n\n<p>I tried following bur it didn't work,</p>\n\n<pre><code>const string filePath = @\"D:\\XJH\\11-10-2012_17_57_08.xml\";\n\nXDocument doc = XDocument.Load(filePath);\n\nvar tableIds =\n    doc\n        .Descendants(\"table\")\n        .Select(table =&gt; new { id = table.Attributes(\"id\").ToString() });\n\nforeach (var id in tableIds)\n{\n   var rowgroups =doc.Descendants(\"table\")\n                     .Elements()\n                     .Where(row =&gt; row.Ancestors()\n                            .Attributes(\"id\").ToString() == id.ToString())\n                     .GroupBy(row =&gt; new { ids = row.Attributes(\"locid\") })\n                     .Select(row =&gt; row);\n}\n</code></pre>\n\n<p>I don't know whether this approach for grouping is correct or not,please help....</p>\n"},{"tags":["c#","linq","yaml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12911410,"title":"LINQ building array with multiple values per select","body":"<p>I have been trying to build a YAML Node with the yamlserializer library. But I am having difficulty constructing a LINQ statement.</p>\n\n<p>I have a list of \"Category\" objects, lets call it \"Cats\", the Category class has both an Id and a Name that need to be represented in the following way as Yaml Mappings.\nCats[0].Id : Cats[0]Name\nCats[1].Id : Cats[1].Name\n...</p>\n\n<p>For those that haven't worked with the library.\nthe class YamlMapping has a constructor that takes an array of YamlNode objects.\nYamlNode is an abstract class from which all types of nodes including YamlMapping inherit.</p>\n\n<pre><code>new YamlMapping\n(\n    \"Categories\", new YamlMapping (\n    (from cat in blacklist.Categories.List select\n    (YamlNode)cat.Id AND (YamlNode)cat.Name).ToArray());\n)\n</code></pre>\n\n<p>The above obviously does not work, and I was wondering if there is any way to achieve the desired result.\nIt would be possible to construct the arrays before hand but was wondering if there is a more LINQish (?) way of achieving the same effect.</p>\n\n<p>In other words the array build would have to be something like this.</p>\n\n<pre><code>YamlNode[] arr;\narr[0] = Cats[0].Id\narr[1] = Cats[0].Name;\narr[2] = Cats[1].Id;\narr[3] = Cats[1].Name;\n......\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":11268652,"title":"DataPager not working with my datasource","body":"<p>I can't seem to get my datapager to work. Ive been searching for answers and it seems the error I am getting \"ListView with id 'searchResults' must have a data source that either implements ICollection or can perform data source paging if AllowPaging is true.\" is quite common, and usually the answer is to put ToArray() on the DataSource. However I am not sure how to put array on my link statement. Can someone please advise.</p>\n\n<pre><code>     searchResults.DataSource = from r in response.Results\n        select new\n        {\n            Title = r[SearchContentProperty.Title],\n            Summary = r[SearchContentProperty.HighlightedSummary]\n        };\n\n    searchResults.DataBind(); \n</code></pre>\n"},{"tags":["c#","linq","lambda"],"answer_count":3,"favorite_count":9,"up_vote_count":10,"down_vote_count":0,"view_count":17152,"score":10,"question_id":956743,"title":"Howto create a System.Linq.Expressions.Expression for Like","body":"<p>I created a filterable BindingList from this source: <a href=\"http://www.nablasoft.com/alkampfer/index.php/2008/11/22/extend-bindinglist-with-filter-functionality/\" rel=\"nofollow\">http://www.nablasoft.com/alkampfer/index.php/2008/11/22/extend-bindinglist-with-filter-functionality/</a></p>\n\n<p>It works great (</p>\n\n<p>list.Filter(\"Customer == 'Name'\");</p>\n\n<p>does what it should.\nIn the internals works a parser, that converts the expression \"==\" or \"!=\" into \"System.Linq.Expressions.Expression\", in this case (==) :</p>\n\n<p>System.Linq.Expressions.Expression.Equal</p>\n\n<p>Unfortunatly System.Linq.Expressions.Expression does not contain a like operator.\nBut I am to much beginner with linq and I don't know how to solve this.</p>\n\n<p>The initial code looks like this:</p>\n\n<pre><code>\tprivate static Dictionary&lt;String, Func&lt;Expression, Expression, Expression&gt;&gt; \n\t\tbinaryOpFactory = new Dictionary&lt;String, Func&lt;Expression, Expression, Expression&gt;&gt; ();\n\n      static Init() {\n\n\t\tbinaryOpFactory.Add(\"==\", Expression.Equal);\n\t\tbinaryOpFactory.Add(\"&gt;\", Expression.GreaterThan);\n\t\tbinaryOpFactory.Add(\"&lt;\", Expression.LessThan);\n\t\tbinaryOpFactory.Add(\"&gt;=\", Expression.GreaterThanOrEqual);\n\t\tbinaryOpFactory.Add(\"&lt;=\", Expression.LessThanOrEqual);\n\t\tbinaryOpFactory.Add(\"!=\", Expression.NotEqual);\n\t\tbinaryOpFactory.Add(\"&amp;&amp;\", Expression.And);\n\t\tbinaryOpFactory.Add(\"||\", Expression.Or);\n\n      }\n</code></pre>\n\n<p>Now I created an expression, that will do what I want:</p>\n\n<pre><code>    private static System.Linq.Expressions.Expression&lt;Func&lt;String, String, bool&gt;&gt;\n            Like_Lambda = (item, search) =&gt; item.ToLower().Contains(search.ToLower());\n    private static Func&lt;String, String, bool&gt; Like = Like_Lambda.Compile();\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>    Console.WriteLine(like(\"McDonalds\", \"donAld\")); // true\n    Console.WriteLine(like(\"McDonalds\", \"King\"));   // false\n</code></pre>\n\n<p>But the binaryOpFactory requires this</p>\n\n<pre><code>    Func&lt;Expression, Expression, Expression&gt;\n</code></pre>\n\n<p>The predefined expressions seem to be exactly that:</p>\n\n<pre><code>    System.Linq.Expressions.Expression.Or;\n</code></pre>\n\n<p>Can anyone tell me howto convert my expression?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12910392,"title":"LINQ: Finding maximal element (not maximal value)","body":"<p>Assume you have a list of edges with given length (as double). Now you want to find the edge with maximal length. Is there an easy way to do this in LINQ?</p>\n\n<p>Of course, I can first compute the maximal value with Max and then do comparison, but firstly, this would be a two computations and secondly comparing doubles for equality is a bad thing.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["c#","linq","nhibernate","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12861940,"title":"NHibernate LINQ query Specified method is not supported error","body":"<p>I am new to NHibernate and while exploring it I got into trouble with the following query which gives me a \"Specified method is not supported.\" error, any ideas why? </p>\n\n<pre><code>var merchantSite = session.Query&lt;MerchantSite&gt;().FirstOrDefault(x =&gt; x.Site.Id == SiteId);\nvar customers = session.Query&lt;Customer&gt;().Where(x =&gt; x.Transaction.Any&lt;Transaction&gt;(y =&gt; merchantSite.Transaction.Any&lt;Transaction&gt;(c =&gt; c.Id == y.Id))).ToList();\n</code></pre>\n\n<p>Both MerchantSite and Transaction have a list of objects of type Transaction.</p>\n\n<p>There must be someone out there who has been in the similar situation, please share with us your experience, what should we do in this situation?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["linq","linq-to-xml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":470,"score":1,"question_id":2475143,"title":"Dealing with a null datetime element within xml using linq","body":"<p>HI</p>\n\n<p>I have an example document that looks like</p>\n\n<pre><code>&lt;ItemEntry&gt;\n&lt;PurchaseDate&gt;2010-03-18T20:36:32.81108+13:00&lt;/PurchaseDate&gt;\n&lt;StoreGUID&gt;0a0324ad-5f99-486a-a2d0-870bc6991e9f&lt;/StoreGUID&gt;\n&lt;ExpiryDate /&gt;\n&lt;CardID&gt;111111&lt;/CardID&gt;\n&lt;PurchaseAmount&gt;0&lt;/PurchaseAmount&gt;\n&lt;RedeemedAmount /&gt;\n&lt;EntryType&gt;1&lt;/EntryType&gt;\n&lt;RedeemedDate /&gt;\n&lt;SalesAssistantID&gt;0&lt;/SalesAssistantID&gt;\n&lt;/ItemEntry&gt;\n</code></pre>\n\n<p>As you can see there are couple of elements ExpiryDate and RedeemedDate are are empty.</p>\n\n<pre><code>  var q = from c in xml.Elements(\"ItemEntry\")\n                    select new mdDetail {\n                        PurchaseDate = (DateTime)c.Element(\"PurchaseDate\"),\n                        StoreGUID = (Guid)c.Element(\"StoreGUID\"),\n                        ExpiryDate = (DateTime?)c.Element(\"ExpiryDate\")??DateTime.MinValue,\n                        CardID = (int)c.Element(\"CardID\"),\n                        PurchaseAmount = (double)c.Element(\"PurchaseAmount\"),\n                         RedeemedAmount = (double?)c.Element(\"RedeemedAmount\"),\n                        EntryType = (int)c.Element(\"EntryType\"),\n                        RedeemedDate = (DateTime?)c.Element(\"RedeemedDate\") ??DateTime.MinValue,\n                        SalesAssistantID = (int)c.Element(\"SalesAssistantID\"),\n\n\n\n                    }                      \n                    ;\n            foreach (var item in q)\n            {\n\n            }\n</code></pre>\n\n<p>I am not sure how to deal with the null element value, \nI have tried ??DateTime.MinValue and ??null however both give me a \"\nString was not recognized as a valid DateTime.\" error.</p>\n\n<p>Any suggestions?</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","linq","linq-to-entities","ef-code-first"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12886510,"title":"Returning from a DbSet 3 tables without the error \"cannot be inferred from the query\"","body":"<p>I have 3 classes. WorkoutSession, WorkoutSessionExercise and Exercise.</p>\n\n<p>I would like to return the WorkoutSession <strong>with</strong> its list of WorkoutSession <strong>with</strong> the Exercise related. WorkoutSession has many WorkoutSessionExercise, and these one has only a single 1 to 1 relationship with Exercise.</p>\n\n<pre><code>             var query = from workoutSession in DatabaseContext.SetOwnable&lt;WorkoutSession&gt;()\n             from workoutSessionExercises in workoutSession.WorkoutSessionExercises\n             from exerciseInfo in workoutSessionExercises.Exercise\n             where workoutSession.Id == id\n             select workoutSession;\n</code></pre>\n\n<p>The last FROM has the error : The type argument cannot be inferred from the query.</p>\n\n<p>How can I load this three level deep objects with Linq To Entity?</p>\n"},{"tags":["linq","linq-to-sql","f#"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":108,"score":2,"question_id":12906550,"title":"How to put the U in F# Type Provider CRUD?","body":"<p>Easy-to-follow examples of CRD (Create, Read, Delete) appear in MSDN <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx\" rel=\"nofollow\">here</a></p>\n\n<p>There is a nice <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx#BKMK_MyDBCreateScript\" rel=\"nofollow\">link on the page to a script</a> to make a test database, and I did so, and easily got all the examples working for CRD.</p>\n\n<p>There are even handy sub-headers on the page for CRD:</p>\n\n<p>(Create rows) <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx#BKMK_UpdateDB\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/hh361033.aspx#BKMK_UpdateDB</a></p>\n\n<p>(Read rows) <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx#BKMK_QueryData\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/hh361033.aspx#BKMK_QueryData</a></p>\n\n<p>(Delete rows) <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx#BKMK_DeleteRows\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/hh361033.aspx#BKMK_DeleteRows</a></p>\n\n<p>The one called BKMK_UpdateDB doesn't do the U in CRUD. Its name says Update, but it really does the C in CRUD.</p>\n\n<p>If I missed <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx\" rel=\"nofollow\">where on this page</a> the U in CRUD is shown, just shoot me now and quit reading...</p>\n\n<p>Could one of the guru's here please provide a little help?</p>\n\n<p>To lighten the junk-work-load for the guru's: Below is the code pretty much as it appears on <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx\" rel=\"nofollow\">the MSDN web page</a>.</p>\n\n<p>Just run the test-database-create .sql <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx#BKMK_MyDBCreateScript\" rel=\"nofollow\">script referred to</a> on the web page, edit the SqlDataConnection string in the code below for your server and database-name, it should run fine.</p>\n\n<p>Note that the only change I made to the query is to get just one row to update. Now exactly one row is returned. Seems more important to see the simple case of one row changed. At least that before showing multiple-changes-at-once.</p>\n\n<p>Can a guru please change the last 4 lines into the recommended F#-Type-Provider way to make a change to the data returned by the query, and write that changed row out to the database?</p>\n\n<p>For example, change row.TestData1 from 10 to 11 and write it to the db.</p>\n\n<p>Summing up: The <a href=\"http://msdn.microsoft.com/en-us/library/hh361033.aspx\" rel=\"nofollow\">MSDN page</a> makes it easy for us F#-Type-Provider newbies to do the CRD in CRUD.</p>\n\n<p>Can a guru please fill us newbies in on the right/easy F#-Type-Provider way to do the U in CRUD?</p>\n\n<p>Many thanks!</p>\n\n<pre><code>#r \"System.Data.dll\"\n#r \"FSharp.Data.TypeProviders.dll\"\n#r \"System.Data.Linq.dll\"\nopen System\nopen System.Data\nopen System.Data.Linq\nopen Microsoft.FSharp.Data.TypeProviders\nopen Microsoft.FSharp.Linq\n\ntype dbSchema = SqlDataConnection&lt;\"Data Source= --yourServer\\yourInstance--;Initial Catalog= --YourTestDatabaseFromTheScript--;Integrated Security=SSPI;\"&gt;\nlet db = dbSchema.GetDataContext()\nlet table1 = db.Table1\n\nquery { for row in db.Table1 do\n        where (row.TestData1 &lt;= 10)\n        select row } \n    |&gt; Seq.iter (fun row -&gt; printfn \"%d %s\" row.TestData1 row.Name)\n</code></pre>\n"},{"tags":["c#","linq","linq-to-sql","ienumerable"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":102,"score":2,"question_id":12894015,"title":"Selecting IEnumerable from JOIN results in a complex Linq-to-SQL query","body":"<p>I've got a query that looks like this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var orderLines = from Order order in _orders\n                 join OrderItem orderItem in dbc.OrderItems\n                     on order.OrderId equals orderItem.OrderId\n                 join Product product in dbc.Products\n                     on orderItem.ProductId equals product.ProductId\n                 join OrderItemQuantity oiq in dbc.OrderItemQuantities\n                     on orderItem.OrderItemId equals oiq.OrderItemId\n                     into orderItemQuantities\n                 join ActivityQuantity aq in dbc.ActivityQuantities\n                     on orderItem.OrderItemId equals aq.OrderItemId\n                     into activityQuantities\n                 orderby\n                     order.OrderId ascending,\n                     orderItem.OrderLineNumber ascending\n                 select new {\n                     Order = order,\n                     Item = orderItem,\n                     Product = product,\n                     // I'd like to get these child items as IEnumerables or similar\n                     ItemQuantities = orderItemQuantities,\n                     ActivityQuantities = activityQuantities\n                 };\n</code></pre>\n\n<p>This compiles fine, but results in the <code>orderItemQuantities</code> and <code>activityQuantities</code> parts being missing from the query, so I get a single select/join/join for order/items/products, and separate individual selects on OIQ/AQ for each entry:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT (...) FROM [ORDERS] AS t0\nINNER JOIN [ORDER_ITEMS] AS t1 ON t0.ORDER_ID = t1.ORDER_ID\nINNER JOIN [PRODUCTS] AS t2 ON t1.PRODUCT_ID = t2.PRODUCT_ID\nORDER BY (...)\n</code></pre>\n\n<p>Then, for each of those rows, it performs these queries:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT (...) FROM [ACTIVITY_QUANTITY] as t0\nWHERE t0.ORDER_ITEM_ID = @p0\n\nSELECT (...) FROM [ORDER_ITEM_QUANTITY] as t0\nWHERE t0.ORDER_ITEM_ID = @p0\n</code></pre>\n\n<p>Since I've got tens of thousands of rows, this results in a ridiculous number of queries.</p>\n\n<p>Is there a way to coalesce the <code>OrderItemQuantity</code> and <code>ActivityQuantity</code> entries for the <code>OrderItem</code> into an <code>IEnumerable</code> (or similar) in a way that makes them easily accessible from the anonymous type used in the select?</p>\n"},{"tags":["c#","linq","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12182215,"title":"I'm not geting the right results from a stored procedure","body":"<p>I have this strored procedure that I use to get the sum of Amount from 3 tables.</p>\n\n<p>The problem is that I'm using Linq to Sql and when I put this procedure on my .dbml file, it has a \nISingleResult(GetSurplusDataForConsolidationReportResult) and I can't get the sums I want.</p>\n\n<p>I'm receiving an empty ReceivablesSurplus list.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>ALTER PROCEDURE [dbo].[GetSurplusDataForConsolidationReport]\n    @ID INT\nAS\nBEGIN\n    -- SET NOCOUNT ON added to prevent extra result sets from\n    -- interfering with SELECT statements.\n    SET NOCOUNT ON;\n\n          SELECT    SUM(RB.[Amount])\n    FROM    [DBO].[ReceivablesSurplus] RB\n    WHERE   RB.[Cycle] = @ID\n\n    SELECT  SUM(DL.[Amount])\n    FROM    [DBO].[DilutionsSurplus] DL\n    WHERE   DL.[Cycle] = @ID\n\n    SELECT  SUM(AC.[Amount])\n    FROM    [DBO].[AccountablesSurplus] AC\n    WHERE   AC.[Cycle] = @ID\nEND\n</code></pre>\n\n<p>this is my .dbml code</p>\n\n<pre><code>[global::System.Data.Linq.Mapping.FunctionAttribute(Name=\"dbo.GetSurplusDataForConsolidationReport\")]\n        public ISingleResult&lt;GetSurplusDataForConsolidationReportResult&gt; GetSurplusDataForConsolidationReport([global::System.Data.Linq.Mapping.ParameterAttribute(Name=\"ID\", DbType=\"Int\")] System.Nullable&lt;int&gt; iD)\n        {\n            IExecuteResult result = this.ExecuteMethodCall(this, ((MethodInfo)(MethodInfo.GetCurrentMethod())), iD);\n            return ((ISingleResult&lt;GetSurplusDataForConsolidationReportResult&gt;)(result.ReturnValue));\n        }\n</code></pre>\n"},{"tags":["asp.net","linq","entity-framework","entity"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":101,"score":2,"question_id":12901377,"title":"EntityFunction.TruncateTime not working in my query","body":"<p>I am using Linq to entityframework to query some infomration. I am trying to use entityfunction.truncatetime and it doesnt seem to work as expected. here is my sample query</p>\n\n<pre><code>From d In Request\nWhere d.Requestor= \"XXXX\" And d.ProcessedFlag = \"N\"\nSelect d.RequestID, RequestReason = d.RequestReason.ItemValue, RequestType =  d.RequestType.ItemValue, RequestedDate = EntityFunctions.TruncateTime(d.RequestedMoveDate)\n</code></pre>\n\n<p>The requesteddate doesnt seem to truncate the time part and I am still getting the both Date and time.</p>\n\n<p>Am I missing something here?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1060,"score":2,"question_id":2854462,"title":"How to make linq master detail query for 0..n relationship?","body":"<p>Given a classic DB structure of Orders has zero or more OrderLines and OrderLine has exactly one Product, how do I write a LINQ query to express this?</p>\n\n<p>The output would be</p>\n\n<pre><code>OrderNumber - OrderLine - Product Name\nOrder-1       null        null // (this order has no lines)\nOrder-2       1           Red widget\n</code></pre>\n\n<p>I tried this query but is not getting the orders with no lines</p>\n\n<pre><code>var model = (from po in Orders\n             from line in po.OrderLines\n                select new\n                {\n                    OrderNumber = po.Id,\n                    OrderLine = line.LineNumber,\n                    ProductName = line.Product.ProductDescription,\n                }\n             )\n</code></pre>\n"},{"tags":["c#",".net","linq","entity-framework-4","linq-to-entities"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":103,"score":5,"question_id":12903138,"title":"Is it possible to call named method within a call to Where?","body":"<p>I am trying to understand some performance implication of Linq from this free ebook by RedGate\n<a href=\"ftp://support.red-gate.com/ebooks/under-the-hood-of-net-memory-management-part1.pdf\" rel=\"nofollow\">ftp://support.red-gate.com/ebooks/under-the-hood-of-net-memory-management-part1.pdf</a></p>\n\n<p>On page 157-158 in this book, they created following example.</p>\n\n<pre><code>Order[] pastDueAccounts = null;  \nDateTimedueDate = DateTime.Today.AddDays(-7);  \nusing(varcontext = new Context())    \n{  \n    pastDueAccounts = context.Accounts.Where(account =&gt; account.DueDate &lt; dueDate).ToArray();  \n} \n</code></pre>\n\n<p>They then re-factored part of lamda expression into following function.</p>\n\n<pre><code>public bool PastDueAccount(Account account)  \n{  \n    return account.DueDate &lt; DateTime.Today.AddDays(-7);  \n} \n</code></pre>\n\n<p>Finally they used this function as follows.</p>\n\n<pre><code>Order[] pastDueAccounts = null;  \nusing(varcontext = new Context())  \n{  \n    pastDueAccounts = context.Accounts.Where(account =&gt; PastDueAccount(account)).ToArray();  \n} \n</code></pre>\n\n<p>Based on what I researched so far, its not possible to run this linq query as LINQ will not be able  recognize the method and cannot be translate into a store expression. I wonder if this example is wrong and simply not possible to run or if I am just having hard time getting my heard around on how to simulate this problem?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":97,"score":-3,"question_id":12899537,"title":"linq .Any with list","body":"<p>I have a table that looks like this:</p>\n\n<pre><code>UserID | FruitID\n  4    |    34\n  4    |   4355\n  4    |   652\n  5    |   5677\n  5    |    562\n  4    |    562\n</code></pre>\n\n<p>For now, I'm passing a UserID and a FruitID like this:</p>\n\n<pre><code>var IsAuthorized = MyDC.FruitTable\n                       .Any(f =&gt; f.UserID == TheUserID &amp;&amp; \n                                 f.FruitID == TheFruitID);\n</code></pre>\n\n<p>This returns a boolean. Now I want to write the same thing for a list of FruitID: I pass in a UserID and a several FruitIDs and I want a boolean that says <code>\"ALL the FruitIDs have a UserID == to the TheUserID\"</code>. <em>Note that if a list contains just one element that doesn't match FruitID == f.FruitID &amp;&amp; f.UserID == UserID then the return should be false for the entire list.</em></p>\n\n<p>How do I rewrite my query to take in a list of FruitIDs.</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":4750,"score":6,"question_id":1707854,"title":"Parse string to C# lambda Func","body":"<p>Is there a way to convert string representation of lambda to a lambda Func?</p>\n\n<pre><code>Func&lt;Product, bool&gt; func = Parse&lt;Product, bool&gt;(\"product =&gt; product.Name.Length &gt; 0\");\n</code></pre>\n\n<p>I tried Dynamic LINQ but it doesn't work as expected - for example it doesn't expect lambda syntax =>.</p>\n\n<p>Summary of answers:</p>\n\n<ul>\n<li>writing my own C# compiler - very funny</li>\n<li>firing up external compiler (like csc.exe) - very slow</li>\n<li>using DLINQ - as I said I don't see how it can parse <strong>lambda</strong> expressions</li>\n</ul>\n\n<p>Why do I need this: because there's no way to pass lambdas to custom attributes like</p>\n\n<pre><code>[Secure(role =&gt; role.CanDoThis &amp;&amp; role.AllowedCount &gt; 5)]\n</code></pre>\n\n<p>So as a workaround I'd like to pass lambda as string: \"role => role.CanDoThis &amp;&amp; role.AllowedCount > 5\". But seems like I'll have to use DLINQ like this: \"CanDoThis &amp;&amp; AllowedCount > 5\" - since that's the syntax it understands. But my question was about true lambdas, I've already used DLINQ at the time of asking.</p>\n"},{"tags":["vb.net","linq","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12902335,"title":"vb.net Linq select from enumareable","body":"<p>I have the following LINQ query which will group by a column and add each group to a datatable in a dataset:</p>\n\n<pre><code>Dim ds As New DataSet\nDim query = From r In bookedorders Group By key = r.Field(Of Integer)(\"productgroup\") Into Group\nFor Each grp In query\n    Dim x As New DataTable\n    x = grp.Group.CopyToDataTable()\n    ds.Tables.Add(x)\nNext\n</code></pre>\n\n<p>How can I select specific columns from table <code>bookedorders</code> in this query before adding them to the DataTable?\nI have 18 columns and I just want to show 4 in the resulted <code>DataTable</code>.</p>\n"},{"tags":["c#","linq","windows-phone"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":93,"score":2,"question_id":12901225,"title":"Sum and GroupBy","body":"<p>I have a table with the following fields:</p>\n\n<pre><code>public int S_ID       \npublic DateTime S_Date            \npublic string S_Month        \npublic string S_Overtime    \npublic string S_WorkingTime\n</code></pre>\n\n<p>I would like to <code>(Orderby S_Date)</code>, <code>(GroupBy S_Month)</code>, <code>(SUM S_Overtime)</code>, <code>(SUM S_Workingtime)</code> and then I'm using Binding to display it in a ListBox.</p>\n\n<p>The code below works, but it doesn't SUM neither Overtime nor Workingtime   </p>\n\n<pre><code>var manader = (from c in db.nys\n               orderby c.S_Date ascending\n               select c).GroupBy(g =&gt; g.S_Month).Select(x =&gt; x.FirstOrDefault());\nlistBox.ItemsSource = manader;\n</code></pre>\n"},{"tags":["linq","sharepoint"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1442,"score":2,"question_id":657095,"title":"Using linq with Sharepoint and disposing of objects","body":"<p>How do i dispose reference to the subWeb in the following query?</p>\n\n<pre><code>using (SPSite spSite = Utility.GetElevatedSite(_rootUrl))\n{\n    from SPWeb web in spSite.AllWebs\n    where web.ServerRelativeUrl.ToLower() == path\n    from SPWeb subWeb in web.Webs                            \n    select subWeb\n}\n</code></pre>\n\n<p>Do i even need to worry about disposing the subWeb if iam already wraped the spSite in the Using statement?</p>\n\n<p>Edit:</p>\n\n<p>Is it a good idea too call garbage collection in this scenario?</p>\n"},{"tags":["linq","entity-framework","iqueryable","lambda-functions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12901060,"title":"SelectMany on an IQueryable ignores conditions?","body":"<p>I'm trying to use SelectMany to evaluate a first query with conditions, based on those results execute another query.  I've been told that SelectMany should be able to do this.  The problem I'm having is the SelectMany seems to ignore the conditions in the first lambda expression.  My problem may be with the first expression but I'm not really sure.  Any ideas what I'm doing wrong.  </p>\n\n<p>First</p>\n\n<pre><code>  //get source based on user and active flag\n  var query = _sourceRepository.GetTable().Where(s =&gt; s.ActionItemStates.Any(ais =&gt; ais.UserId == user.Id &amp;&amp; ais.IsActive == active));  \n</code></pre>\n\n<p>Second - ignores conditions in first</p>\n\n<pre><code>var queryActionItems = query.SelectMany(x =&gt; x.ActionItemStates).OrderBy(x =&gt; x.ActionItem.SortOrder);\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/R9ICL.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#","linq","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":58,"score":1,"question_id":12900186,"title":"How can a LINQ join select only the first record?","body":"<p>I wish to select only the <strong>first record</strong> from the '<code>CustomerSubOwners</code>' table in join query below and wondered what was the best way to achieve this in LINQ.</p>\n\n<pre><code>var result= (from t1 in db.Cases\n                    from t2\n                        in db.CustomerSubOwners\n                        .Where(o =&gt; t1.CustomerId == o.CustomerId &amp;&amp; o.Expiry &gt;= DateTime.Now)\n                        .DefaultIfEmpty()\n                        select t1);\n</code></pre>\n"},{"tags":["vb.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12898816,"title":"CopyToDataTable(Of DataRow) shows syntax error","body":"<p>Im trying to convert the output of a LINQ query to a datatable, I have the following code but it shows a syntax error in the <code>(Of DataRow)</code> part:</p>\n\n<pre>\nDim X As New Entities\nDim query As IEnumerable(Of DataRow) = From cajero In X.CAJERO.AsEnumerable\n                                       Select cajero\nDim bla = query.CopyToDataTable(Of DataRow)()\n</pre>\n\n<p>I'm using this question as a guide:\n<a href=\"http://stackoverflow.com/questions/16/filling-a-dataset-or-datatable-from-a-linq-query-result-set\">Filling a DataSet or DataTable from a LINQ query result set</a></p>\n\n<p>If i use </p>\n\n<pre>\nquery.CopyToDataTable()  \n'instead of the overload \nquery.CopyToDataTable(Of DataRow)  \n</pre>\n\n<p>it throws an invalidCastException.</p>\n\n<p>I'm looking for an easy way to accomplish this task, and this seemed to be the easiest one, without too much code and having to implement any \"shredder\" methods or such, but if that's the only way, then please point me in the right direction.</p>\n\n<p>This is the error that throws(I localized it to english, its a bit different in spanish):</p>\n\n<p>Cannot convert object of type WhereSelectEnumerableIterator to object of type IEnumerable System.Data.DataRow</p>\n\n<hr>\n\n<p>I have tried the following:</p>\n\n<p>Declare an extension method that would create the datatable like this:</p>\n\n<pre>\n _\nPublic Function myToDataTable(Of T)(source As IEnumerable(Of T)) As DataTable\n    Dim properties As PropertyInfo() = GetType(T).GetProperties()\n\n    Dim output As New DataTable()\n\n    For Each prop In properties\n        output.Columns.Add(prop.Name, prop.PropertyType)\n    Next\n\n    For Each item In source\n        Dim row As DataRow = output.NewRow()\n\n        For Each prop In properties\n            row(prop.Name) = prop.GetValue(item, Nothing)\n        Next\n\n        output.Rows.Add(row)\n    Next\n\n    Return output\nEnd Function\n</pre>\n\n<p>But it always throws an exception while adding the columns to the datatable:</p>\n\n<pre><code>DataSet does not support System.Nullable\n</code></pre>\n\n<p>I also changed the linq query to this:</p>\n\n<pre>\nDim query = From cajero In X.CAJERO\n           Select cajero\n\nDim bla = query.myToDataTable\n</pre>\n\n<hr>\n\n<p>Following Jon's suggestion I found this question:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/701223/net-convert-generic-collection-to-datatable\">.NET - Convert Generic Collection to DataTable</a></p>\n\n<p>Which just gave me the last bit of code I needed:</p>\n\n<pre>\noutput.Columns.Add(prop.Name, If(Nullable.GetUnderlyingType(prop.PropertyType), prop.PropertyType))\n\n</pre>\n\n<p>and </p>\n\n<pre>\nrow(prop.Name) = If(prop.GetValue(item, Nothing), DBNull.Value)\n\n</pre>\n"},{"tags":["c#","linq","refactoring"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":12898673,"title":"Refactoring two methods down to one","body":"<p>I have two methods that almost do the same thing. They get a <code>List&lt;XmlNode&gt;</code> based on state OR state and schoolType and then return a distinct, ordered <code>IEnumerable&lt;KeyValuePair&lt;string,string&gt;&gt;</code>. I know they can be refactored but I'm struggling to determine what type the parameter should be for the linq statement in the return of the method (<em>the last line of each method</em>).</p>\n\n<p>I thank you for your help in advance.</p>\n\n<pre><code>private IEnumerable&lt;KeyValuePair&lt;string, string&gt;&gt; getAreaDropDownDataSource() {\n    StateInfoXmlDocument stateInfoXmlDocument = new StateInfoXmlDocument();\n    string schoolTypeXmlPath = string.Format(STATE_AND_SCHOOL_TYPE_XML_PATH, StateOfInterest, ConnectionsLearningSchoolType);\n    var schoolNodes = new List&lt;XmlNode&gt;(stateInfoXmlDocument.SelectNodes(schoolTypeXmlPath).Cast&lt;XmlNode&gt;());\n    return schoolNodes.Select(x =&gt; new KeyValuePair&lt;string, string&gt;(x.Attributes[\"idLocation\"].Value, x.Value)).OrderBy(x =&gt; x.Key).Distinct();\n}\n\nprivate IEnumerable&lt;KeyValuePair&lt;string, string&gt;&gt; getStateOfInterestDropDownDataSource() {\n    StateInfoXmlDocument stateInfoXmlDocument = new StateInfoXmlDocument();\n    string schoolTypeXmlPath = string.Format(SCHOOL_TYPE_XML_PATH, ConnectionsLearningSchoolType);\n    var schoolNodes = new List&lt;XmlNode&gt;(stateInfoXmlDocument.SelectNodes(schoolTypeXmlPath).Cast&lt;XmlNode&gt;());\n    return schoolNodes.Select(x =&gt; new KeyValuePair&lt;string, string&gt;(x.Attributes[\"stateCode\"].Value, x.Attributes[\"stateName\"].Value)).OrderBy(x =&gt; x.Key).Distinct();\n}\n</code></pre>\n"},{"tags":["xml","linq","subquery"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12866827,"title":"XML with Linq with where","body":"<p>I need to find the SectionIndex with the attribute nodeName=\"Industries\" and then get the Attributes (id and nodeName) for each Textpage element in that SectionIndex</p>\n\n<pre><code>   &lt;SectionIndex nodeName=\"Industries\"&gt;\n       &lt;Textpage id=\"1\" nodeName=\"Aerospace\"&lt;/Textpage&gt;\n       &lt;Textpage id=\"2\" nodeName=\"Construction\"&lt;/Textpage&gt;\n       &lt;Textpage id=\"3\" nodeName=\"Engineering\"&lt;/Textpage&gt;\n    &lt;/SectionIndex&gt;\n    &lt;SectionIndex nodeName=\"Greetings\"&gt;\n       &lt;Textpage id=\"1\" nodeName=\"Hello\"&lt;/Textpage&gt;\n       &lt;Textpage id=\"2\" nodeName=\"GoodBye\"&lt;/Textpage&gt;\n       &lt;Textpage id=\"3\" nodeName=\"Later\"&lt;/Textpage&gt;\n    &lt;/SectionIndex&gt;\n</code></pre>\n\n<p>My query looks like</p>\n\n<pre><code>    var queryServices = from s in xmldoc.Root.Descendants(\"SectionIndex\")\n                            where s.Attribute(\"nodeName\").Value == \"Industries\"                                    \n                            select new\n                            {\n                                ServicesKey = s.Element(\"umbTextpage\").Attribute(\"id\").Value ?? \"\",\n                                NodeName = s.Element(\"umbTextpage\").Attribute(\"nodeName\").Value ?? \"\"\n                            };\n</code></pre>\n\n<p>It only returns Aerospace.  Any tips would be great.</p>\n"},{"tags":["c#","xml","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":12895647,"title":"How to update a collection of xml Elements?","body":"<p>I'm a liitle bit green to the saving reeding xml and linq in c#. This is my code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>    public static void EditConfiguration (DesignConfiguration design)\n    {\n        XDocument configXml = XDocument.Load(configXMLFileName);\n        var updateData = configXml.Root.Elements(\"Design\").Where(element =&gt; (String)element.Attribute(\"name\") == design.DesignName).FirstOrDefault();\n\n        if (updateData != null)\n        {\n            var myElements = updateData.Elements();  //All the elements under th Design node \n            configXml.Save(configXMLFileName);    \n       }            \n    }\n</code></pre>\n\n<p>In the myElements variable there are such elements:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;\n&lt;DestinationFolder&gt;C:\\Inetpub&lt;/DestinationFolder&gt;\n&lt;CopyLookups&gt;True&lt;/CopyLookups&gt;\n&lt;CopyImages&gt;False&lt;/CopyImages&gt;\n&lt;ImageSourceFolder&gt;None&lt;/ImageSourceFolder&gt;\n&lt;ImageDesinationFolder&gt;None&lt;/ImageDesinationFolder&gt;\n</code></pre>\n\n<p>I want to update each of this elements with the value from the design configuration object. This wouldn't be so hard if i had one value in the object but there are values like so: </p>\n\n<p>design.SourceFolder\ndesign.DesitnationFolder </p>\n\n<p>etc (just like the elements). The object provides new values for above elements. It's obvious to me that I should use the foreach loop but the result when I'm using it is not the one I want...</p>\n\n<p>This is my foreach loop: </p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>            foreach (var item in myElements )\n            {\n                item.SetElementValue(\"SourceFolder\", design.SourceFolder);\n            }\n</code></pre>\n\n<p>In the loop there is only one element for the presentation needs, but I wanted to put more of them in the loop. And this is what I get: </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;SourceFolder&gt;C:\\CSF_Packages&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/SourceFolder&gt;\n&lt;DestinationFolder&gt;None&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/DestinationFolder&gt;\n&lt;CopyLookups&gt;True&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/CopyLookups&gt;\n&lt;CopyImages&gt;False&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/CopyImages&gt;\n&lt;ImageSourceFolder&gt;C:\\Inetpub&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/ImageSourceFolder&gt;\n&lt;ImageDesinationFolder&gt;None&lt;SourceFolder&gt;C:\\CSF_Packages&lt;/SourceFolder&gt;&lt;/ImageDesinationFolder&gt;\n</code></pre>\n\n<p>I would like to have: </p>\n\n<pre><code>&lt;SourceFolder&gt;new_value_from the DesignConfiguration object from the SourceFolder property&lt;/SourceFolder&gt;\n&lt;DestinationFolder&gt;new_value_from the DesignConfiguration object from the Desitnation Folder property&lt;/DestinationFolder&gt;\n&lt;CopyLookups&gt;new_value_from the DesignConfiguration object from the CopyLookups property&lt;/CopyLookups&gt;\n</code></pre>\n\n<p>and so on...\nplease help a noobie in the stress :) Thank you very much. </p>\n"},{"tags":["c#",".net","xml","linq","xelement"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12898263,"title":"Read text content from XElement","body":"<p>In .NET, how do I read the text content from an <a href=\"http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.aspx\" rel=\"nofollow\">XElement</a>?</p>\n\n<p>For example, from the XElement</p>\n\n<pre><code>XElement.Parse(\"&lt;tag&gt;Alice &amp;amp; Bob&lt;other&gt;cat&lt;/other&gt;&lt;/tag&gt;\")\n</code></pre>\n\n<p>I would like the string 'Alice &amp; Bob'</p>\n\n<hr>\n\n<p>I tried <code>element.Value</code> but that returns 'Alice &amp; Bobcat' :(</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":12881750,"title":"Aggregate data from two tables using single linq query","body":"<p>I am quite new to LINQ and not aware of its full features yet.</p>\n\n<p>I have two tables like below</p>\n\n<pre><code>Links\n----------------------\nLinkId \nLinkTitle \nDateAdded\n\n\nArticles\n----------------------\nArticleId\nArticleTitle\nDateAdded\n</code></pre>\n\n<p>I am trying to create resultset using a single linq query that will output the data like below</p>\n\n<pre><code>Year\nMonth\nNoOfLinksAdded\nNoOfArticleAdded\n</code></pre>\n\n<p>Any help would be highly appreciated. </p>\n\n<p>Update:\nThats what I did so far</p>\n\n<pre><code>var grouped = from p in Links \n              group p by new { month = p.DateAdded.Month,year= p.DateAdded.Year } into d \n              select new { Month = d.Key.month, Year= d.Key.year, NoOfLinksAdded = d.Count() };\n</code></pre>\n"},{"tags":["linq","sum"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":548,"score":2,"question_id":676290,"title":"How do i get the Sum in this Linq query?","body":"<p>i have a table that has zero to many children. just like how this site has a <code>QUESTION</code> which can have zero to many <code>VOTES</code> (either Up == 1 or Down == 0).</p>\n\n<p>I need to get <em>all questions that have the most up votes</em>. Eg. all the questions, ordered by Sum(Vote) descending.</p>\n\n<p>I'm not sure how to do it in linq.</p>\n\n<p>So i would have an EntitySet called Questions and another EntitySet called Votes.</p>\n\n<p>I was trying to do group by and let and order by and nothing compiles :(</p>\n\n<p>Could anyone have any suggestions, please?</p>\n"},{"tags":["c#","linq","distinct"],"answer_count":4,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":2890,"score":5,"question_id":2537823,"title":"Distinct by property of class by linq","body":"<p>I have a collection:</p>\n\n<pre><code>List&lt;Car&gt; cars=new List&lt;Car&gt;\n</code></pre>\n\n<p>Cars are uniquely identified by CarCode.</p>\n\n<p>I have three cars in the collection, and two with identical CarCodes.</p>\n\n<p>How can I use LINQ  to convert this collection to Cars with unique CarCodes?</p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1602,"score":0,"question_id":2283336,"title":"'orderby' in linq using a string array c#","body":"<p>Say I have a method definition as such:</p>\n\n<pre><code>public CustomerOrderData[] GetCustomerOrderData(string[] CustomerIDs)\n{\n var query = (from a in db.Customer\n              join b in db.Order on a.CustomerID equals v.CustomerID\n              orderby CustomerIDs\n              select new CustomerOrderData()\n              {\n                //populate props here\n              }).ToArray();\n}\n</code></pre>\n\n<p>My CustomerIDs in input param could be {\"1\",\"3\",\"400\",\"200\"}</p>\n\n<p>I want my return array to be ordered in the above fashion. Is there an easy way to achive this?</p>\n\n<p>My solution was to put it into a Dictionary and then create a new array while looping through my CustomerIDs collection.</p>\n\n<p>CustomerOrderData does have a property named CustomerID</p>\n"},{"tags":["vb.net","linq","sum"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":88,"score":2,"question_id":12884491,"title":"LINQ sum some column when 2 other column values are the same","body":"<p>i've the following table</p>\n\n<pre><code>+-------+--------+----------+\n| catid |  name  | quantity |\n+-------+--------+----------+\n|     1 | table  |       10 |\n|     2 | chair  |        5 |\n|     2 | chair  |       10 |\n|     1 | table  |       10 |\n|     2 | chair  |       15 |\n|     3 | pencil |       20 |\n+-------+--------+----------+\n</code></pre>\n\n<p>using LINQ i want to sum the quanitiy for the rows that have the same name  catid and save this to the same datatable</p>\n\n<p>so the result would be this table</p>\n\n<pre><code>+-------+--------+----------+\n| catid |  name  | quantity |\n+-------+--------+----------+\n|     1 | table  |       20 |\n|     2 | chair  |       30 |\n|     3 | pencil |       20 |\n+-------+--------+----------+\n</code></pre>\n"},{"tags":["c#",".net","linq"],"answer_count":5,"favorite_count":5,"up_vote_count":20,"down_vote_count":1,"view_count":456,"score":19,"question_id":12885590,"title":"Dude, where's my object? or, Why does Linq not return my object?","body":"<p>Once I have the results of my Linq query, I am not always happy. There could be a result that I was expecting to be there but wasn't. For example, my client was expecting that a customer was in a customer list, but it wasn't. It is my client saying \"Dude, where's my customer?\", not me. I am the Dude, and to remain a dude, I have to give my client the reason.</p>\n\n<p><strong>Is there a simple way to take a given object instance and a Linq query and determine which expressions within the query excluded that instance?</strong></p>\n\n<p><strong>Edit</strong> Ok, here is a better example</p>\n\n<p>Output should be something along the lines:</p>\n\n<blockquote>\n  <p>Your Customer was excluded for 2 reasons:</p>\n  \n  <p>Customer FirstName is Carl but it should be Daniel</p>\n  \n  <p>Customer Age is 18 but it should be > 20</p>\n</blockquote>\n\n<pre><code>    public class Customer\n    {\n        public string FirstName { get; set; }\n        public int Age { get; set; }\n    }\n\n    [Test]\n    public void Dude_wheres_my_object_test1()\n    {\n        var daniel = new Customer { FirstName = \"Daniel\", Age = 41 };\n        var carl =  new Customer {  FirstName = \"Carl\", Age= 18 };\n        var Customers = new List&lt;Customer&gt;() { daniel, carl };\n\n        // AsQueryable() to convert IEnumerable&lt;T&gt; to IQueryable&lt;T&gt; in \n        //the case of LinqtoObjects - only needed for this test, not \n        //production code where queies written for LinqToSql etc normally \n        //return IQueryable&lt;T&gt;\n        var query = from c in Customers.AsQueryable()\n                    where c.Age &gt; 20\n                    where c.FirstName == \"Daniel\"\n                    select c;\n        //query would return Daniel as you'd expect, but not executed here.\n\n        //However I want to explain why Carl was not in the results\n\n        string[] r = DudeWheresMyObject(query, carl);\n        Assert.AreEqual(\"Age is 18 but it should be &gt; 20\", r[0]);\n        Assert.AreEqual(\"FirstName is Carl but it should be Daniel\", r[1]);\n\n\n        //Should even work for a Customer who is not \n        //in the original Customers collection...\n        var ficticiousCustomer = new Customer { FirstName = \"Other\", Age = 19};\n        string[] r2= DudeWheresMyObject(query, \n                                         ficticiousCustomer);\n        Assert.AreEqual(\"Age is 19 but it should be &gt; 20\", r2[0]);\n        Assert.AreEqual(\"FirstName is Other but it should be Daniel\", r2[1]);\n    }\n\n    public string[] DudeWheresMyObject&lt;T&gt;(IQueryable&lt;T&gt; query, T instance)\n    {\n        //Do something here with the query.Expression and the instance\n\n    }\n</code></pre>\n\n<p>First of all, before I attempt to write some fancy Fluent framework, <strong>Has anyone done this already?</strong></p>\n\n<p>So far, I have considered navigating the expression tree and executing each branch against an IQueryable that only contains my object. Now I don't have a great deal of experience using raw expression trees, so I would like those who have to suggest any pitfalls or even explain whether this is a dead end and why.</p>\n\n<p>I am anxious that anything that results from this should:</p>\n\n<ul>\n<li>Be Reusable - Should be applicable to any object compared against a Linq query returning objects of the same class.</li>\n<li>Not affect the performance of the original query (this should just be standard Linq).</li>\n<li>Should be Linq-implementation agnostic.</li>\n<li>If there are multiple property values set on the missing instance that excluded it from the results, then all of those reasons should be reported.</li>\n</ul>\n\n<p><strong>Edit</strong>\nI am not suggesting that I keep executing LinqToSql against the database multiple times with different permutations of the query and comparing the results. Rather, I am looking for a way to take a single instance and compare it to the expression tree (without executing the query directly again)</p>\n\n<p>Also, I would like an indication of whether others might find this useful. If so, I would consider starting an open source project to solve it.</p>\n"},{"tags":["c#","linq","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":12890442,"title":"C# linq grouping with same name","body":"<p>I've a data table like</p>\n\n<pre><code>Date      status       recno\n---------------------------------\n2012      DST;Par        1\n------------------------------------\n2012      DST            2\n--------------------------------\n2012      DST            3\n--------------------------------------------\n2012      DST;Ts         4\n-----------------------------------\n</code></pre>\n\n<p>Currently I have written a query like this:</p>\n\n<pre><code>var data = from b in table.AsEnumerable()\n           where b.DateInterval&gt;=fromDate &amp;&amp; b.DateInterval&lt;=toDate\n           group b by b.Channel1_status into g                       \n           select new\n           {\n               AccountNo=accountNumber,\n               Status = statusLabels[g.Key].ToString(),\n               StatusCount = g.Count(),\n           };\n</code></pre>\n\n<p>However, it's returning me results these results:</p>\n\n<pre><code>Result: DST-2 \n        DST;par-1 and DST;Ts-1\n\nExpected: DST-4  DST;par-1 and DST;Ts-1\n</code></pre>\n\n<p>Please explain to me what I'm doing wrong and how to get the expected results.</p>\n"},{"tags":["c#","linq","list","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12887469,"title":"How can I add list parameters to a LINQ query?","body":"<p>I have two parameters passed to the method and I need to attach them to the final query list.</p>\n\n<p>(1st parameter) </p>\n\n<pre><code>string[] Price= new string[5];\nPrice= new string[] { \"50\", \"25\", \"35\" };\n</code></pre>\n\n<p>(2nd parameter)</p>\n\n<pre><code>List&lt;string&gt; DiscountPrice= new List&lt;string&gt;();\nDiscountPrice.Add (\"10\"); \nDiscountPrice.Add (\"5\");\nDiscountPrice.Add (\"3\");\n\n\nvar list= (from d in context.List\n           where ....\n           select new MyNewList\n           {\n                 Name = d.Name,                    \n                 Country = d.Country,\n                 **Price = ??** //how do I attach the parameters one by one? In the order they were saved?\n                 **DiscountPrice** = ?? \n\n           }).ToList&lt;MyNewList&gt;();\n</code></pre>\n"},{"tags":["vb.net","linq","dynamic","group-by"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":12871558,"title":"Linq Dynamic Group By","body":"<p>Hi i need dynamic linq queries which has group by in vb.net.</p>\n\n<p>My queries are as following.</p>\n\n<p>In first query i need to group by two columns, but in second i need to group by just one column. It depens on how user wants to see the report.</p>\n\n<p>How can i produce these queries on runtime according to the user choices?</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Dim query = From r In dtString.AsEnumerable\n        Group r By Key0 = r.Field(Of String)(\"country\"),\n                   Key1 = r.Field(Of String)(\"region\") Into Group\n        Select Key0, Key1,\n               DebitTotal = Group.Sum(Function(r) r.Field(Of Decimal)(\"debit\")),\n               CreditTotal = Group.Sum(Function(r) r.Field(Of Decimal)(\"credit\"))\n\n\nDim query = From r In dtString.AsEnumerable\n        Group r By Key0 = r.Field(Of String)(\"country\") Into Group\n        Select Key0\n               DebitTotal = Group.Sum(Function(r) r.Field(Of Decimal)(\"debit\")),\n               CreditTotal = Group.Sum(Function(r) r.Field(Of Decimal)(\"credit\"))\n</code></pre>\n"},{"tags":["linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12887644,"title":"Linq, How to do groupBy?","body":"<p>project table:</p>\n\n<p>Id, DeptId, Year, Name, Level</p>\n\n<pre><code>Id = 1, DeptId = 1, Year = 2000, Name = \"ABC\", Level = 1\nId = 2, DeptId = 1, Year = 2001, Name = \"ABC1\", Level = 1\nId = 3, DeptId = 1, Year = 2002, Name = \"ABC2\", Level = 1\n\nId = 4, DeptId = 2, Year = 2000, Name = \"ABC3\", Level = 1\nId = 5, DeptId = 2, Year = 2002, Name = \"ABC4\", Level = 1\n\nId = 6, DeptId = 3, Year = 2000, Name = \"ABC5\", Level = 1\nId = 7, DeptId = 3, Year = 2001, Name = \"ABC6\", Level = 1\nId = 8, DeptId = 3, Year = 2002, Name = \"ABC7\", Level = 1\n</code></pre>\n\n<p>I have a project table.  I need to get the project for each dept for 2001.  for DeptId = 2, it has no project for 2001, I need to show previous year project which is 2000.</p>\n\n<p>my linq should return following result back.</p>\n\n<pre><code>Id = 2, DeptId = 1, Year = 2001, Name = \"ABC1\", Level = 1\nId = 4, DeptId = 2, Year = 2000, Name = \"ABC3\", Level = 1\nId = 7, DeptId = 3, Year = 2001, Name = \"ABC6\", Level = 1\n</code></pre>\n\n<p>I was thinking about using groupby, group the DeptId, but not sure how to write this query.</p>\n\n<p>Update:</p>\n\n<p>This is what I tried.</p>\n\n<p>var projects = project.Where(x=>x.Year == 2001)</p>\n\n<p>but this will not return result for DeptId = 2, that's why I am thinking about using groupby, but clueless how to write it. </p>\n"},{"tags":["c#","linq","linq-to-sql"],"answer_count":5,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":7762,"score":6,"question_id":282791,"title":"?: Operator in LINQ Query","body":"<ul>\n<li><p>How do I utilize a ?: operator in the SELECT clause of a LINQ query?  If this can't be done, how can I emulate one?  The goal is to get a CASE block in my select clause. As you might suspect, I'm getting an error: <em>Invalid anonymous type member declarator. Anonymous type members must be declared with a member assignment, simple name or member access.</em></p></li>\n<li><p>Is this the proper way, or a sufficient way, to say \"from a inner join i on a.ipid=i.id inner join u on i.uid=u.id\"?  If not, please provide one.  Thanks.</p>\n\n<pre><code>var query =\n\tfrom a in db.tblActivities\n\tfrom i in db.tblIPs\n\tfrom u in db.tblUsers \n\tselect new {\n\t\tu.UserName == null\n\t\t\t? i.Address\n\t\t\t: u.UserName,\n\t\ta.Request,\n\t\ta.DateTime };\n</code></pre></li>\n</ul>\n"},{"tags":["c#",".net","linq","delegates","lambda"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12887145,"title":"Why do Linq lambdas not require a `return` statement, but mine do?","body":"<p>I'm using lambdas quite a bit in a library. One thing that really irks me is I can't seem to get rid of the return statement and I have have quite a bit of boiler-plate type code around them. </p>\n\n<p>This is how it works so far:</p>\n\n<pre><code>public delegate IBarelyView HandlerInvoker(IDictionary&lt;string, string&gt; route, IDictionary&lt;string, string&gt; form);\npublic void MyFunc(string foo, HandlerInvoker invoker) { }\n</code></pre>\n\n<p>This is the code I have worker to use MyFunc:</p>\n\n<pre><code>MyFunc(\"foobar\", (x, y) =&gt; { return new Xyz();});\n</code></pre>\n\n<p>Now I know this isn't too bad. However, I'd really like to be able to use the Linq type syntax. For instance, it's easy enough to do</p>\n\n<pre><code>ObjectList.Where(x=&gt;x.Foo==\"bar\");\n</code></pre>\n\n<p>As you can see, positives for the Linq syntax is no <code>return</code> statement, no parentheses around the \"arguments\", and no curly braces. </p>\n\n<p>Why can't I have this kind of syntax in my lambdas? If I remove the return statement I get an error about not all code paths returning a value. </p>\n"},{"tags":["linq","c#-4.0","console-application"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12874945,"title":"C# console App compare records to database","body":"<p>I am parsing a flat file which is working line by line and inserting into the database but I want to add an additional step, actually additional 2 steps.</p>\n\n<p>First I only want records for recalls for specific car manufacturers which I have a database table called AutoMake that has a list of all the makes I want to include. I need to compare the record to that table to ensure that it is a record of one of the makes that I want to include. </p>\n\n<p>Then I need to do a second check to make sure the record is not already in my database.\nThis is a console App and I am using Entity for this. So here is my code I am driving myself crazy trying to write and rewrite this to include the checks but im just not getting it. </p>\n\n<p>Oh and not that it really matters because if someone can get me in the right direction I can move from there but <code>tokens[2]</code> is the <code>MAKETXT</code> and <code>RCL_CMPT_ID</code> is <code>tokens[23]</code> and <code>RCL_CMPT_ID</code> can be used to verify if a record is already in the database since it is a unique value</p>\n\n<pre><code>    public static void ParseTSV(string location)\n    {\n        Console.WriteLine(\"Parsing.....\");\n\n        using (var reader = new StreamReader(location))\n        {\n            var lines = reader.ReadToEnd().Split(new char[] { '\\n' });\n\n            if (lines.Length &gt; 0)\n            {\n               foreach (string line in lines)\n               {\n                  if (string.IsNullOrWhiteSpace(line))\n                  {\n                    continue;\n                  }\n                  var tokens = line.Trim().Split(new char[] { '\\t' });\n\n                  var recalls = new Recalls();\n\n                  recalls.RECORD_ID = tokens[0];\n                  recalls.CAMPNO = tokens[1];\n                  recalls.MAKETXT = tokens[2];\n                  recalls.MODELTXT = tokens[3];\n                  recalls.YEARTXT = tokens[4];\n                  recalls.MFGCAMPNO = tokens[5];\n                  recalls.COMPNAME = tokens[6];\n                  recalls.MFGNAME = tokens[7];\n                  recalls.BGMAN = tokens[8];\n                  recalls.ENDMAN = tokens[9];\n                  recalls.RCLTYPECD = tokens[10];\n                  recalls.POTAFF = tokens[11];\n                  recalls.ODATE = tokens[12];\n                  recalls.INFLUENCED_BY = tokens[13];\n                  recalls.MFGTXT = tokens[14];\n                  recalls.RCDATE = tokens[15];\n                  recalls.DATEA = tokens[16];\n                  recalls.RPNO = tokens[17];\n                  recalls.FMVSS = tokens[18];\n                  recalls.DESC_DEFECT = tokens[19];\n                  recalls.CONEQUENCE_DEFECT = tokens[20];\n                  recalls.CORRECTIVE_ACTION = tokens[21];\n                  recalls.NOTES = tokens[22];\n                  recalls.RCL_CMPT_ID = tokens[23];\n\n\n                  string connectionString = GetConnectionString();\n                  using (SqlConnection connection = new SqlConnection(connectionString))\n                  {\n                      SqlCommand cmdIns = new SqlCommand(GetInsertSqlCust(recalls), connection);\n                      connection.Open();\n                      cmdIns.ExecuteNonQuery();\n                      connection.Close();\n                      cmdIns.Dispose();\n                      cmdIns = null;\n                  }\n              }\n          }\n      }\n  }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":96,"score":-3,"question_id":12883454,"title":"how to use linq to sort out nested data","body":"<p>I have a table for categories like this:</p>\n\n<pre><code>id parentid Title     \n1  0        Parent1   \n2  1        Child1        \n3  0        Parent2\n4  3        Child2\n5  1        anotherChild1\n6  3        anotherChild2\n</code></pre>\n\n<p>How can I sort it in this order:</p>\n\n<pre><code>Parent1\n  child1\n  anotherchild1\nParent2\n  child2\n  anotherchild2\n</code></pre>\n\n<p>and save the order into another field called sorted index?</p>\n"},{"tags":["c#",".net","linq","lambda","lambda-functions"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":411,"score":3,"question_id":6794555,"title":"How to force my lambda expressions to evaluate early? Fix lambda expression weirdness?","body":"<p>I have written the following C# code:</p>\n\n<pre><code>_locationsByRegion = new Dictionary&lt;string, IEnumerable&lt;string&gt;&gt;();\nforeach (string regionId in regionIds)\n{\n    IEnumerable&lt;string&gt; locationIds = Locations\n        .Where(location =&gt; location.regionId.ToUpper() == regionId.ToUpper())\n        .Select(location =&gt; location.LocationId); //If I cast to an array here, it works.\n    _locationsByRegion.Add(regionId, LocationIdsIds);\n}\n</code></pre>\n\n<p>This code is meant to create a a dictionary with my \"region ids\" as keys and lists of \"location ids\" as values.</p>\n\n<p>However, what actually happens is that I get a dictionary with the \"region ids\" as keys, but the value for each key is identical: it is the list of locations for the last region id in regionIds!</p>\n\n<p>It looks like this is a product of how lambda expressions are evaluated.  I can get the correct result by casting the list of location ids to an array, but this feels like a kludge.</p>\n\n<p>What is a good practice for handling this situation?</p>\n"},{"tags":["c#","linq","datatable"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":103,"score":2,"question_id":12883790,"title":"Comparing two datatables through Linq","body":"<p>Hi I'm trying to compare two <code>datatable</code> through Linq. But I get this exception:</p>\n\n<blockquote>\n  <p>Specific cast is invalid</p>\n</blockquote>\n\n<p>Please help me as I am new to Linq. This is the code I'm using:</p>\n\n<pre><code>var matched1 = from table1 in dtAvailableStores.AsEnumerable()\n               join table2 in dtControlStores.AsEnumerable() \n               on table1.Field&lt;int&gt;(\"STORE_NBR\") \n               equals table2.Field&lt;int&gt;(\"STORE_NBR\")\n               select table1;\n</code></pre>\n\n<p>Here <code>STORE_NBR</code> is a string value.</p>\n"},{"tags":["c#","linq",".net-3.5"],"answer_count":4,"favorite_count":2,"up_vote_count":19,"down_vote_count":0,"view_count":9027,"score":19,"question_id":59,"title":"How do I get a distinct, ordered list of names from a DataTable using LINQ?","body":"<p>Let's say I have a <code>DataTable</code> with a <code>Name</code> column. I want to have a collection of the unique names ordered alphabetically. The following query ignores the order by clause.</p>\n\n<pre><code>var names = (from DataRow dr in dataTable.Rows\n             orderby (string)dr[\"Name\"]\n             select (string)dr[\"Name\"]).Distinct();\n</code></pre>\n\n<p>Why does the <code>orderby</code> not get enforced?</p>\n"},{"tags":["c#","linq","web-services",".net-3.5"],"answer_count":5,"favorite_count":7,"up_vote_count":26,"down_vote_count":1,"view_count":32064,"score":25,"question_id":16,"title":"Filling a DataSet or DataTable from a LINQ query result set","body":"<p>How do you expose a <strong>LINQ</strong> query as an <strong>ASMX</strong> web service? Usually, from the business tier, I can return a typed <code>DataSet</code> or <code>DataTable</code> which can be serialized for transport over <strong>ASMX</strong>.</p>\n\n<p>How can I do the same for a <strong>LINQ</strong> query? Is there a way to populate a typed <code>DataSet</code> or <code>DataTable</code> via a <strong>LINQ</strong> query?: </p>\n\n<pre><code>public static MyDataTable CallMySproc()    \n{    \n    string conn = ...;\n\n    MyDatabaseDataContext db = new MyDatabaseDataContext(conn);    \n    MyDataTable dt = new MyDataTable();\n\n    // execute a sproc via LINQ\n    var query = from dr in db.MySproc().AsEnumerable\n    select dr;\n\n    // copy LINQ query resultset into a DataTable -this does not work !    \n    dt = query.CopyToDataTable();\n\n    return dt;\n}\n</code></pre>\n\n<p>How can I get the resultset of a <strong>LINQ</strong> query into a <code>DataSet</code> or <code>DataTable</code>? Alternatively, is the <strong>LINQ</strong> query serializeable so that I can expose it as an <strong>ASMX</strong> web service?</p>\n"},{"tags":["c#","linq","entity-framework","c#-4.0","reflection"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12881866,"title":"Set Properties that not null using linq and reflection","body":"<p>I have a <code>Update</code> method like this:</p>\n\n<pre><code>public void Update(MyClass item, System.Linq.Expressions.Expression&lt;Func&lt;MyClass, bool&gt;&gt; exp)\n</code></pre>\n\n<p>and I update status field like this:</p>\n\n<pre><code>MyClass  u = ent.MyClass.Where(exp).FirstOrDefault();\nif (u == null)\n{\n    throw new Exception(\"No Record Found\");\n}\nelse\n{\n    u.Status=item.Status;              &lt;-------\n    ent.SaveChanges();\n}\n</code></pre>\n\n<p>ok ,the problem is I want to use this update method for various updates for example user may want to update <code>status,Name</code> or <code>Tel,fax,Address,name</code> and ...</p>\n\n<p>I want to check I property isn't null it assign to similar property of selected object(in line that show with arrow). How I can to this automatically ? I don't want wtite like this:</p>\n\n<pre><code>if(item.Status != null)\n{\n     u.Status = item.Status;\n}\nif(item.Name != null)\n{\n     u.Name = item.Name;\n}\n,....\n</code></pre>\n\n<p>thanks</p>\n"},{"tags":["c#","linq","find"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":9,"view_count":82,"score":-9,"question_id":12349591,"title":"find LINQ queries in C# files","body":"<p>I need to find out LINQ queries while parsing C# files (with Irony Codeparser), because the parser does not support LINQ and therefore I have to exclude or modify such files, where LINQ occurs. It would be no problem to go through the files with a StreamReader before parsing them or write modified copies of such files in the cache. Do you have any suggestions or solutions for this problem?</p>\n\n<p>Greetz</p>\n"},{"tags":["c#","database","linq","windows-phone-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12789884,"title":"C# windows phone 7 in a Database: Each user to have specific data tables?","body":"<p>I'm at my first windows phone 7 app that uses databases. I've created a database that has 4 Tables:</p>\n\n<pre><code>namespace database\n{\npublic class AccountDataContext : DataContext\n{\n    public AccountDataContext(string connectionString)\n        : base(connectionString)\n    {\n    }\n    public Table&lt;Account&gt; Accounts\n    {\n        get\n        {\n            return this.GetTable&lt;Account&gt;();\n        }\n    }\n\n    public Table&lt;user&gt; users\n    {\n        get\n        {\n            return this.GetTable&lt;user&gt;();\n        }\n    }\n\n    public Table&lt;link&gt; links\n    {\n        get\n        {\n            return this.GetTable&lt;link&gt;();\n        }\n    }\n    public Table&lt;player&gt; players\n    {\n        get\n        {\n            return this.GetTable&lt;player&gt;();\n        }\n    }\n}\n} \n</code></pre>\n\n<p>and i made a login page where you can login or register a new user...</p>\n\n<p>The 'problem' is that every user that registers and logs in can see the same data .</p>\n\n<p>I want to know how to split(or something) the database so that the tables: Account, link and player would be specific to every user that is added in the \"user\" table. Or should i make a new database for every new user that registers?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":98,"score":3,"question_id":12708226,"title":"Group by a distinct list of integers","body":"<pre><code>MyObject()\n{\n     String dept;\n     List&lt;int&gt; id;\n     Object obj;\n}\n</code></pre>\n\n<p>Using <code>LINQ</code>, how can I return a list of the above objects organized as follows:</p>\n\n<p>Group all of the obj objects by [ department and EQUAL id list ].  The list being considered equal if it contains the same numbers, not necessarily the same order(a set).</p>\n"},{"tags":["c#","linq","sorting","sql-order-by"],"answer_count":4,"favorite_count":2,"up_vote_count":1,"down_vote_count":1,"view_count":92,"score":0,"question_id":12874947,"title":"Sorting range of list using LINQ","body":"<p>I was wondering if it is possible to do ranged sort using LINQ, for example i have list of numbers:</p>\n\n<p>List&lt; int > numbers = new List&lt; int ></p>\n\n<ul>\n<li>1</li>\n<li>2</li>\n<li>3</li>\n<li>15   &lt;-- sort</li>\n<li>11   &lt;-- sort</li>\n<li>13   &lt;-- sort</li>\n<li>10   &lt;-- sort</li>\n<li>6</li>\n<li>7</li>\n<li>etc.</li>\n</ul>\n\n<p>Simply using numbers.Skip(3).Take(4).OrderBy(blabla) will work, but it will return a new list containing only those 4 numbers. Is is somehow possible to force LINQ to work on itself without returning a new \"partial\" list or to recieve complete one with sorted part?\nThanks for any answer!</p>\n"},{"tags":["linq","biztalk","streaminsight"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12858958,"title":"StreamInsight 2.1 adapter to observer","body":"<p>I've been trying to implement the following adapter to connect StreamInsight with BizTalk:\n<a href=\"http://seroter.wordpress.com/2010/07/09/sending-streaminsight-events-to-biztalk-through-new-web-soaprest-adapter/#comment-11635\" rel=\"nofollow\">http://seroter.wordpress.com/2010/07/09/sending-streaminsight-events-to-biztalk-through-new-web-soaprest-adapter/#comment-11635</a></p>\n\n<p>At the end he does the following to bind the query to the adapter:</p>\n\n<pre><code>var allQuery = callTypeThreshold.ToQuery(\n                     myApp,\n                     \"Threshold Events\",\n                     string.Empty,\n                     typeof(WebOutputFactory),\n                     webAdapterBizTalkConfig,\n                     EventShape.Point,\n                     StreamEventOrder.FullyOrdered);\n</code></pre>\n\n<p>Now, if I'm not mistaken this doesn't work anymore in StreamInsight 2.1 and I have no clue how to do this. Can anybody help me with this?\nThanks in advance!</p>\n"},{"tags":[".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12875895,"title":"Using linq to set multiple elements","body":"<p>I'm trying to change all cells in a table that has a StyleID of \"foo\" to \"bar\".  I'm using the following expression to get all the cells in a table who has a StyleID=\"foo\".  I verified my narrowing function works by doing the following</p>\n\n<pre><code>Dim count As Integer = \n   &lt;Table&gt;...&lt;Row&gt;...&lt;Cell&gt;.Where(Function(c) c.@ss:StyleID = \"foo\").Count\n</code></pre>\n\n<p>when I run this, it returns the correct number of cells for the dataset.</p>\n\n<p>However, when I execute the following code, nothing happens.</p>\n\n<pre><code>&lt;Table&gt;...&lt;Row&gt;...&lt;Cell&gt;\n    .Where(Function(c) c.@ss:StyleID = \"foo\").@ss:StyleID = \"bar\"\n</code></pre>\n\n<p>Any ideas as to what I'm doing wrong?</p>\n"},{"tags":["linq","any","sql-variant"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12874807,"title":"linq with Any and sql_variants","body":"<p>i have a problem with sql_variants</p>\n\n<p>i have 2 tables and a DTO</p>\n\n<pre><code>'struct A_Table1\n' id (int)(not null)\n' wert (sql_variant)(not null)\n\n'struct A_Table2\n' id (int)(not null)\n' wert (sql_variant)(not null)\n\nPrivate Class DTO\n    Public Property id As Integer\n    Public Property wert As Object\nEnd Class\n</code></pre>\n\n<p>I like to select everything from tbale 1 and if there is a value entered for the id of table 1 in table2 i like to get the value from there.\nThis works great with strings (or at least one of the 'wert' columns beeing a string. But if both 'wert' columns are sql_variants, i do get nasty outputs: </p>\n\n<pre><code>System.Collections.Generic.List`1[System.Object]\n</code></pre>\n\n<p>as text inside the grid where i display the stuff.</p>\n\n<p>Here is some sample code</p>\n\n<pre><code>Private Sub Button2_Click_1(sender As System.Object, e As System.EventArgs) Handles Button2.Click\n        Dim q = (From p In db.A_Table1s Select New DTO With {\n                 .id = p.id,\n                 .wert = If(db.A_Table2s.Any(Function(f) f.id = p.id And Not f.wert Is Nothing),\n                            (From v In db.A_Table2s Where v.id = p.id Select v.wert).FirstOrDefault,\n                            p.wert)\n        })\n\n        bs3.DataSource = q\n        grd.DataSource = bs3\nEnd Sub\n\nAnd the generated SQL\n\nSELECT [t0].[id], \n    (CASE \n        WHEN EXISTS(\n            SELECT NULL AS [EMPTY]\n            FROM [dbo].[A_Table2] AS [t1]\n            WHERE [t1].[id] = [t0].[id]\n            ) THEN 1\n        ELSE 0\n     END) AS [value], [t0].[wert]\nFROM [dbo].[A_Table1] AS [t0]\n</code></pre>\n\n<p>That \"AS [value]\" looks \"strange\"</p>\n\n<p>Can someone tell me why this query won't work with sql_variants?</p>\n\n<p>thank you</p>\n\n<p>_rene</p>\n\n<p>Oh what i just realized:\nLinq is doing 2 additional querys (for every entry that is poresent in the second table:</p>\n\n<pre><code>SELECT TOP (1) [t0].[wert]\nFROM [dbo].[A_Table2] AS [t0]\nWHERE [t0].[id] = @x1\n-- @x1: Input Int (Size = -1; Prec = 0; Scale = 0) [1]\n-- Context: SqlProvider(Sql2008) Model: AttributedMetaModel Build: 4.0.30319.1\n\nSELECT TOP (1) [t0].[wert]\nFROM [dbo].[A_Table2] AS [t0]\nWHERE [t0].[id] = @x1\n-- @x1: Input Int (Size = -1; Prec = 0; Scale = 0) [3]\n-- Context: SqlProvider(Sql2008) Model: AttributedMetaModel Build: 4.0.30319.1\n</code></pre>\n\n<p>And it seems like both values are merged to the returning DTO as a list of Objects</p>\n\n<p>Edit:\nOk i got this working but not with .Any but left outer join</p>\n\n<pre><code>Dim q = (From p In db.A_Table1s\n             Group Join v In db.A_Table2s On p.id Equals v.id Into Group From v In Group.DefaultIfEmpty() Select New DTO With\n            {.id = p.id, .wert = If(v.wert Is Nothing, p.wert, v.wert)})\n</code></pre>\n\n<p>However it would be very great to know, why the .Any \"solution\" does not work</p>\n"},{"tags":["sql","asp.net-mvc","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":160,"score":0,"question_id":12873662,"title":"Insert Record into Table Join with LINQ-SQL ASP.NET MVC","body":"<p>Hi i would know how insert data into MsSQL DB using ASP.NET MVC.</p>\n\n<p>I'm using (DBML) Entity with SQL-LINQ</p>\n\n<p>I have 3 tables where 2 of them join with the first one</p>\n\n<p>Table</p>\n\n<p><strong>User</strong></p>\n\n<p>id, name , surname , email</p>\n\n<p><strong>Car</strong></p>\n\n<p>id , id_User , model ,year</p>\n\n<p><strong>Work</strong></p>\n\n<p>id , id_User , location </p>\n\n<p>I use this code to add a data into SQL </p>\n\n<pre><code>DataUserDataContext data = new DataUserDataContext(); \nUser u = new User();\nu.Name= \"John\";\nu.Surname= \"Lock\";\nu.email = \"someemail@email.com\" \ndata.Users.InsertOnSubmit(u);\np.SubmitChanges();  \n</code></pre>\n\n<p>Now My question is : </p>\n\n<p>How could insert a new record considering that i should fill Car and Work table too?</p>\n\n<p>Use the code before and take the ID (if i wasnt wrong there is a way to get the last entity)</p>\n\n<p>Use this id to insert record into Car and Work Table</p>\n\n<p>Is there a way to do this in a unique step?</p>\n"},{"tags":["c#","xml","linq","null","xelement"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":12874027,"title":"XML LINQ query returns nothing","body":"<p>I'm trying to parse an xml file using LINQ, but as I understand the query returns null. (It's WP7)\nHere's the code:</p>\n\n<pre><code>       var resultQuery = from q in XElement.Parse(result).Elements(\"Question\")\n                          select new Question\n                          {\n                              QuestionId = q.Attribute(\"id\").Value,\n                              Type = q.Element(\"Question\").Attribute(\"type\").Value,\n                              Subject = q.Element(\"Subject\").Value,\n                              Content = q.Element(\"Content\").Value,\n                              Date = q.Element(\"Date\").Value,\n                              Timestamp = q.Element(\"Timestamp\").Value,\n                              Link = q.Element(\"Link\").Value,\n                              CategoryId = q.Element(\"Category\").Attribute(\"id\").Value,\n                              UserId = q.Element(\"UserId\").Value,\n                              UserNick = q.Element(\"UserNick\").Value,\n                              UserPhotoURL = q.Element(\"UserPhotoURL\").Value,\n                              NumAnswers = q.Element(\"NumAnswers\").Value,\n                              NumComments = q.Element(\"NumComments\").Value,\n                          };\n</code></pre>\n\n<p>\"result\" is the xml string, just like this one.\n<a href=\"http://i48.tinypic.com/1ex5s.jpg\" rel=\"nofollow\">http://i48.tinypic.com/1ex5s.jpg</a> (couldn't post properly formatted text so here's a pic : P )</p>\n\n<p>Error:\n<a href=\"http://i48.tinypic.com/2uyk2ok.jpg\" rel=\"nofollow\">http://i48.tinypic.com/2uyk2ok.jpg</a></p>\n\n<p>Sorry, if I haven't explained it properly and if this has already been asked (tried searching but didn't help). </p>\n"},{"tags":["linq","windows-phone-7","table"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":12873966,"title":"Exceeding 8060 bytes when writing an object to a table - Windows Phone 7.5","body":"<p>I have this communicat when I'm trying add new object to my local database:</p>\n\n<blockquote>\n  <p>The table definition or the row size exceeds the maximum row size of 8060 bytes.</p>\n</blockquote>\n\n<p>My table has the following structure:</p>\n\n<pre><code>[Table]\npublic class SomeClass\n{\n    [Column(IsPrimaryKey = true, IsDbGenerated = true, CanBeNull = false, AutoSync = AutoSync.OnInsert)]\n    public int Id { get; set; }\n    [Column]\n    public string String1 { get; set; }\n    [Column]\n    public string String2 { get; set; }\n    [Column]\n    public string String3 { get; set; }\n    [Column]\n    public string String4 { get; set; }\n}\n</code></pre>\n\n<p>3 of these strings (String2, String3, String4) will contain the 2000-3000 characters.\nWhen I am trying to write smaller data (between 1000 to 1500 characters) everything works.</p>\n\n<p>How can I fix this?</p>\n\n<p>Thanks for your response!</p>\n"},{"tags":["c#","linq","query","data"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":12873855,"title":"C# Groupby Linq and foreach","body":"<p>I need a more efficient way of producing multiple files from my data group.\nIm using a <code>List&lt;MyObject&gt;</code> type and my object has some public properties in which I need to group the data by.</p>\n\n<p>I have heard of <em>Linq</em> and it sounds like something I could use. However Im not sure how to go about it.</p>\n\n<p>I need to produce a text file for each STATE, so grouping all the <code>MyObjects</code> (people) by state, then running a <code>foreach</code> look on them to build the TEXT file.</p>\n\n<pre><code>void Main()\n{\n\n    List&lt;MyObject&gt;   lst = new List&lt;MyObject&gt;();\n    lst.Add(new MyObject{ name = \"bill\", state = \"nsw\", url = \"microsoft.com\"});\n    lst.Add(new MyObject{ name = \"ted\",  state = \"vic\", url = \"apple.com\"});\n    lst.Add(new MyObject{ name = \"jesse\", state = \"nsw\", url = \"google.com\"});\n    lst.Add(new MyObject{ name = \"james\", state = \"qld\", url = \"toshiba.com\"});\n\n    string builder = \"\";\n    foreach (MyObject item in myObjects)  {\n\n        builder += item.name + \"\\r\\n\";\n        builder += item.url + \"\\r\\n\" + \"\\r\\n\\r\\n\";\n\n    }\n\nand out to the `StreamWriter` will be the filenames by state. \n</code></pre>\n\n<p>In total for the above data I need 3 files;</p>\n\n<pre><code>-nsw.txt\n-vic.txt\n-qld.txt\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":96,"score":0,"question_id":12867821,"title":"Optimize Code into 'return' line?","body":"<p>Is there a way to tighten this up so that there is only 1 line in the body?</p>\n\n<pre><code>private int _ProjectGuidToId (Guid guid)\n{\n    ProjectEntity res = _dbt.ProjectEntity\n                            .Where(r =&gt; r.ProjectGUID == guid.ToString())\n                            .First();\n    return res.Id;\n}\n</code></pre>\n\n<p>In other words, how do I return 1 value (Id) from 1 row from the database using LINQ in one line of code?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","xml","linq","kml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12871997,"title":"Getting sub elements using LINQ and XML in C#","body":"<p>I'm just starting off using linq queries within c#, and i'm struggling to get all the data i need.</p>\n\n<p>Basically i'm using the google earth kml file as my xml file.</p>\n\n<p>The structure looks like this.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;kml xmlns=\"http://earth.google.com/kml/2.2\"&gt;\n &lt;Document&gt;\n  &lt;Placemark&gt;\n    &lt;name&gt;XXX&lt;/name&gt;\n    &lt;description&gt;XXX&lt;/description&gt;\n    &lt;styleUrl&gt;XXX&lt;/styleUrl&gt;\n    &lt;Point&gt;\n       &lt;coordinates&gt;XXX&lt;/coordinates&gt;\n    &lt;/Point&gt;\n  &lt;/Placemark&gt;\n &lt;/Document&gt;\n&lt;/kml&gt;\n</code></pre>\n\n<p>With my code as it is, i can get the first level of elements, (name, description, styleurl), but can't get my syntax right in order to get the coordinates element within Point. Can anyone point me in the right direction? The line i'm struggling with is Coord = p.Element(ns + \"Point\").Element(ns + \"coordinates\").Value, what should this be?</p>\n\n<pre><code>XNamespace ns = \"http://earth.google.com/kml/2.2\";\n\nvar placemarks = xdoc.Descendants(ns + \"Placemark\")\n                     .Select(p =&gt; new\n                          {\n                               Name = p.Element(ns + \"name\").Value,\n                               Desc = p.Element(ns + \"description\").Value,\n                               Coord = p.Element(ns + \"Point\")\n                                        .Element(ns + \"coordinates\").Value  \n                          }).ToList();\n</code></pre>\n"},{"tags":["c#","linq","datacontext"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12871666,"title":"Linq and DataContext","body":"<p>Would it be ok to have only one DataContext per app and share that through an singleton?</p>\n\n<p>I ask this because i would like to have the DataContext in every form but i realized that, if i change some enity in one DataContext, i have ro refresh it, if used before.</p>\n\n<p>eg form1:</p>\n\n<pre><code>db = GetContext()\nitem=(from p in db.Table where p.id=1 select p)\n</code></pre>\n\n<p>on another form</p>\n\n<pre><code>db = GetContext()\nitem=(from p in db.Table where p.id=1 select p)\nitem.value=\"test\"\n</code></pre>\n\n<p>back on the original form i have to do</p>\n\n<pre><code>db.Refresh(RefreshMode.OverwriteCurrentValues, item)\n</code></pre>\n\n<p>even if i do a new </p>\n\n<pre><code>item=(from p in db.Table where p.id=1 select p)\n</code></pre>\n\n<p>(without the refresh) the value will not be updated</p>\n\n<p>Is DataContext threadsafe? </p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12870758,"title":"Comparing Complex Collections using Linq","body":"<p>May be my problem is common. I have seen it here <a href=\"http://stackoverflow.com/questions/3407356/comparing-two-collections\">Comparing Two collections</a>. But I want to compare two complex collections.</p>\n\n<pre><code>public class Project\n{\n    public Int32 ProjectID { get; set; }\n    public String ProjectName { get; set; }\n    public String ProjectCode { get; set; }\n}\npublic class Unit\n{\n    public Int32 UnitID { get; set; }\n    public Int32 ProjectID { get; set; }\n    public String UnitName { get; set; }\n    public String UnitCode { get; set; }\n}\n</code></pre>\n\n<p>Here Project and Unit have a Common field called <code>ProjectID</code>.And I have a Collection of Project and Unit. Corresponding to each project in the project collection, there is a unit in the unit collection. And some of the units in the unit collection is not belonging to any project in the project collection. I want to Filter out those units. How can I do that using Linq.</p>\n"},{"tags":["linq","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":12866685,"title":"Dynamic PIVOT using C# Linq","body":"<p>I am trying to use following code to create the PIVOT but its not working.</p>\n\n<p>It's giving me compile time error. I don't know linq so unable to use it.</p>\n\n<p>Please help :</p>\n\n<pre><code>   DataTable Pivot(DataTable dt, DataColumn pivotColumn, DataColumn pivotValue) {\n    // find primary key columns \n    //(i.e. everything but pivot column and pivot value)\n    DataTable temp = dt.Copy();\n    temp.Columns.Remove( pivotColumn.ColumnName );\n    temp.Columns.Remove( pivotValue.ColumnName );\n    string[] pkColumnNames = temp.Columns.Cast(&lt;DataColumn&gt;)\n        .Select( c =&gt; c.ColumnName )\n        .ToArray();\n\n    // prep results table\n    DataTable result = temp.DefaultView.ToTable(true, pkColumnNames).Copy();\n    result.PrimaryKey = result.Columns.Cast(&lt;DataColumn&gt;).ToArray();\n    dt.AsEnumerable()\n        .Select(r =&gt;; r[pivotColumn.ColumnName].ToString())\n        .Distinct().ToList()\n        .ForEach (c =&gt; result.Columns.Add(c, pivotColumn.DataType));\n\n    // load it\n    foreach( DataRow row in dt.Rows ) {\n        // find row to update\n        DataRow aggRow = result.Rows.Find(\n            pkColumnNames\n                .Select( c =&gt; row[c] )\n                .ToArray() );\n        // the aggregate used here is LATEST \n        // adjust the next line if you want (SUM, MAX, etc...)\n        aggRow[row[pivotColumn.ColumnName].ToString()] = row[pivotValue.ColumnName];\n    }\n\n    return result;\n}\n</code></pre>\n\n<p>Code from : <a href=\"http://michaeljswart.com/2011/06/forget-about-pivot/\" rel=\"nofollow\">http://michaeljswart.com/2011/06/forget-about-pivot/</a></p>\n\n<p>Moreover it tried to use following code, it works well except for it is not giving total sum for Value Column</p>\n\n<pre><code>public DataTable GetInversedDataTable(DataTable table, string columnX, string columnY, string columnZ, string nullValue, bool sumValues)\n        {\n            //Create a DataTable to Return\n            DataTable returnTable = new DataTable();\n\n            DataTable tempTable = table.Clone();\n\n            if (string.IsNullOrEmpty(columnX))\n            {\n                columnX = table.Columns[0].ColumnName;\n            }\n\n            tempTable.Columns.Remove(columnX);\n\n\n            //Add a Column at the beginning of the table\n            //returnTable.Columns.Add(columnY);\n\n            returnTable = tempTable.Clone();\n\n            //Read all DISTINCT values from columnX Column in the provided DataTale\n            List&lt;string&gt; columnXValues = new List&lt;string&gt;();\n\n\n            foreach (DataRow dr in table.Rows)\n            {\n                string columnXTemp = dr[columnX].ToString();\n                if (!columnXValues.Contains(columnXTemp))\n                {\n                    //Read each row value, if it's different from others provided, add to the list of values and creates a new Column with its value.\n                    columnXValues.Add(columnXTemp);\n                    returnTable.Columns.Add(columnXTemp);\n                }\n            }\n\n            //Verify if Y and Z Axis columns re provided\n            if (!string.IsNullOrEmpty(columnY) &amp;&amp; !string.IsNullOrEmpty(columnZ))\n            {\n                //Read DISTINCT Values for Y Axis Column\n                List&lt;string&gt; columnYValues = new List&lt;string&gt;();\n\n                foreach (DataRow dr in table.Rows)\n                {\n                    if (!columnYValues.Contains(dr[columnY].ToString()))\n                    {\n                        columnYValues.Add(dr[columnY].ToString());\n                    }\n                }\n\n                //Loop all Column Y Distinct Value\n                foreach (string columnYValue in columnYValues)\n                {\n                    //Creates a new Row\n                    DataRow drReturn = returnTable.NewRow();\n                    drReturn[0] = columnYValue;\n                    //foreach column Y value, The rows are selected distincted\n                    DataRow[] rows = table.Select((columnY + \"='\") + columnYValue + \"'\");\n\n                    //Read each row to fill the DataTable\n                    foreach (DataRow dr in rows)\n                    {\n                        string rowColumnTitle = dr[columnX].ToString();\n\n                        //Read each column to fill the DataTable\n                        foreach (DataColumn dc in returnTable.Columns)\n                        {\n                            if (dc.ColumnName == rowColumnTitle)\n                            {\n                                //If Sum of Values is True it try to perform a Sum\n                                //If sum is not possible due to value types, the value displayed is the last one read\n                                if (sumValues)\n                                {\n                                    try\n                                    {\n                                        drReturn[rowColumnTitle] = Convert.ToDecimal(drReturn[rowColumnTitle]) + Convert.ToDecimal(dr[columnZ]);\n                                    }\n                                    catch\n                                    {\n                                        drReturn[rowColumnTitle] = dr[columnZ];\n                                    }\n                                }\n                                else\n                                {\n                                    drReturn[rowColumnTitle] = dr[columnZ];\n\n                                }\n                            }\n                        }\n                    }\n\n                    returnTable.Rows.Add(drReturn);\n\n                }\n            }\n            else\n            {\n                throw new Exception(\"The columns to perform inversion are not provided\");\n            }\n\n            //if a nullValue is provided, fill the datable with it\n            if (!string.IsNullOrEmpty(nullValue))\n            {\n                foreach (DataRow dr in returnTable.Rows)\n                {\n                    foreach (DataColumn dc in returnTable.Columns)\n                    {\n                        if (string.IsNullOrEmpty(dr[dc.ColumnName].ToString()))\n                        {\n                            dr[dc.ColumnName] = nullValue;\n                        }\n                    }\n                }\n            }\n\n            return returnTable;\n        }\n\nGetInversedDataTable(dtNormal, \"Dated\", \"OrderStatus\", \"Qty\", \" \", true);\n</code></pre>\n\n<p>Please help :)</p>\n"},{"tags":["linq","select","group-by"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":3502583,"title":"Getting rows from one table and latest 1 row from an associated table, in LINQ","body":"<p>This question is similar to this one:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/1704821/linq-to-sql-groupby-and-max-to-get-the-object-with-latest-date\">LINQ to SQL: GroupBy() and Max() to get the object with latest date</a></p>\n\n<p>But I have a table which I want to return a lot of rows from. It's primary key is used as a foreign key in a second table. For each row returned from the first row, I also want to return (in the same result set) the latest (in this case, ordered by a datetime field) 1 row.</p>\n\n<p>How would this be constructed in LINQ using C#?</p>\n\n<p>The best I have is:</p>\n\n<pre><code>    var instances = from i in ContextDB.Instances\n                    join p in ContextDB.Points on i.InstanceID equals p.InstanceID\n                    where categoryIDs.Contains(j.CategoryID)\n                    group p by p.InstanceID into latestPoint\n                    select new latestPoint.OrderBy(i =&gt; i.Instance.Title).FirstOrDefault();\n</code></pre>\n\n<p>But this is clearly wrong.  Although I think I'm understanding <code>group</code> correctly I don't think I'm understanding <code>into</code> correctly.</p>\n\n<p>[EDIT] To avoid confusion, I think this question can be summed up as \"How to do rows from one table along with the latest 1 row for each from another table?\"</p>\n"},{"tags":["c#","xml","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12867521,"title":"Finding an element with XDocument returning zero results","body":"<p>I have a web service method that parses an SVG string to remove certain elements and then return it back.</p>\n\n<p>Here is part of the SVG string:</p>\n\n<pre><code>&lt;g id=\"wrapper\"&gt;\n    &lt;g id=\"inner\"&gt;\n        &lt;title&gt;Layer 1&lt;/title&gt;\n...etc\n</code></pre>\n\n<p>This is the code:</p>\n\n<pre><code>XDocument x2 = XDocument.Parse(svgString);\n\nvar inner = (from el in x2.Root.Elements(\"g\")\n    where (string)el.Attribute(\"id\") == \"inner\"\n    select el);\n\ninner.Remove();\n\nreturn x2.ToString();\n</code></pre>\n\n<p>Firstly, why is the <code>Count</code> of <code>inner</code> 0?</p>\n\n<p>Secondly, is this the correct way to \"remove\" the element or do I need to save the <code>XDocument</code> somehow before returning it?</p>\n\n<p><strong>edit:</strong> here is the full SVG string:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"[]&gt;\n&lt;svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    x=\"0px\" y=\"0px\" width=\"374.173px\" height=\"524.409px\" viewbox=\"0 0 374.173 524.409\"\n    enable-background=\"new 0 0 374.173 524.409\" xml:space=\"preserve\"&gt;\n\n&lt;g id=\"wrapper\"&gt;\n&lt;g id=\"inner\"&gt;\n&lt;title&gt;Layer 1&lt;/title&gt;\n    &lt;defs&gt;\n        &lt;rect id=\"SVGID_1_\" x=\"16.086\" y=\"98.896\" width=\"344.903\" height=\"413.334\" /&gt;\n    &lt;/defs&gt;\n    &lt;clipPath id=\"SVGID_2_\"&gt;\n        &lt;use xlink:href=\"#SVGID_1_\" overflow=\"visible\" /&gt;\n    &lt;/clipPath&gt;\n    &lt;g clip-path=\"url(#SVGID_2_)\"&gt;\n        &lt;defs&gt;\n            &lt;rect id=\"SVGID_3_\" x=\"-8.96\" y=\"53.896\" width=\"382.524\" height=\"473.956\" /&gt;\n        &lt;/defs&gt;\n        &lt;clipPath id=\"SVGID_4_\"&gt;\n            &lt;use xlink:href=\"#SVGID_3_\" overflow=\"visible\" /&gt;\n        &lt;/clipPath&gt;\n        &lt;g transform=\"matrix(1 0 0 1 3.341429e-007 -1.529841e-006)\" clip-path=\"url(#SVGID_4_)\"&gt;\n\n                &lt;image overflow=\"visible\" width=\"367\" height=\"445\" id=\"img11\" xlink:href=\"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEARQBFAAD/7AARRHVja3kAAQAEAAAAHgAA/+4AIUFkb2JlAGTAAAAAAQMA EAMCAwYAAAlpAAAVEAAANsH/2wCEABALCwsMCxAMDBAXDw0PFxsUEBAUGx8XFxcXFx8eFxoaGhoX Hh4jJSclIx4vLzMzLy9AQEBAQEBAQEBAQEBAQEABEQ8PERMRFRISF...........\"&gt;\n            &lt;/image&gt;\n        &lt;/g&gt;\n    &lt;/g&gt;\n&lt;/g&gt;\n&lt;/g&gt;\n\n&lt;g&gt;\n     &lt;title&gt;Layer 2&lt;/title&gt;\n     &lt;text transform=\"matrix(1 0 0 1 61.3745 48.5068)\"&gt;&lt;tspan x=\"0\" y=\"0\" fill=\"#9FA1A4\" font-family=\"'Noteworthy-Bold'\" font-size=\"24\"&gt;testing 123&lt;/tspan&gt;&lt;/text&gt;\n     &lt;/g&gt;\n\n&lt;/svg&gt;\n</code></pre>\n"},{"tags":["linq","insert","null","datacontext","insertonsubmit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12868311,"title":"Linq DataContext InsertOnSubmit statement Inserts only NULL values in the table","body":"<p>Please help!!!</p>\n\n<p>I have this simple piece of code, I don't have a clue why is not doing what is supposed to do which is insert the data contained in the class, I have not idea what am I doing wrong, cause the insert statement produces only NULL values in the table.</p>\n\n<p>This is the code:</p>\n\n<pre><code>    public void InsertData()\n    {\n        using (CTM dc = new CTM(conn))\n        {\n            //Table&lt;ValidCCGpn&gt; validCCGpn = dc.GetTable&lt;ValidCCGpn&gt;();\n\n            for (int i = 0; i &lt; 10; i++)\n            {\n                dc.ValidCCGpn.InsertOnSubmit(\n                    new ValidCCGpn\n                        {\n                            Period = 201209,\n                            GPN = \"gpn\" + i.ToString(),\n                            CC_GPN = \"cc_gpn\" + i.ToString()\n                        });\n            }\n            dc.SubmitChanges();\n        }\n\n    }\n</code></pre>\n\n<p>And this is my DataContext and the and table:</p>\n\n<pre><code>public partial class CTM : DataContext\n{\n    public CTM(string conn) : base(conn) { }\n\n    public Table&lt;ValidCCGpn&gt; ValidCCGpn;\n}\n\n\n[Table(Name = \"CAT.ValidCCGpn\")]\npublic class ValidCCGpn\n{\n    [Column(IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]\n    public int Id { get; set; }\n\n    public int Period { get; set; }\n    public string GPN { get; set; }\n    public string CC_GPN { get; set; }\n\n}\n</code></pre>\n\n<p>This is the sql script to create the table:</p>\n\n<pre><code>    CREATE TABLE [CAT].[ValidCCGpn](\n    [Id] [int] IDENTITY(1,1) NOT NULL,\n    [Period] [int] NULL,\n    [GPN] [varchar](50) NULL,\n    [CC_GPN] [varchar](50) NULL,\n CONSTRAINT [PK_ValidCCGpn] PRIMARY KEY CLUSTERED \n(\n    [Id] ASC\n)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]\n) ON [PRIMARY]\n</code></pre>\n\n<p>And this is the result I get in the table:</p>\n\n<pre><code>Id  Period  GPN CC_GPN\n1   NULL    NULL    NULL\n2   NULL    NULL    NULL\n3   NULL    NULL    NULL\n4   NULL    NULL    NULL\n5   NULL    NULL    NULL\n6   NULL    NULL    NULL\n7   NULL    NULL    NULL\n8   NULL    NULL    NULL\n9   NULL    NULL    NULL\n10  NULL    NULL    NULL\n</code></pre>\n"},{"tags":["vb.net","linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12866503,"title":"Implicit creation of XElement parents within an XDocument on update of an XElement (leaf node) value","body":"<p>I want to be able to have the effect of updating an element within an XML document regardless of whether the parent nodes of the leaf exist or not... my first (brute force) attempt was to optimistically walk backwards through the document to determine how many of the leaf parents already existed (adding any parents that might be missing).</p>\n\n<pre><code>Set(ByVal Value As Integer)\n    Dim Element As XElement = (Configurations.&lt;reportControl&gt;.&lt;pageLength&gt;)(0)\n\n    If Not IsNothing(Element) Then\n        Element.Value = Value.ToString\n        Return\n    End If\n\n    Element = (Configurations.&lt;reportControl&gt;)(0)\n\n    If Not IsNothing(Element) Then\n        Element.Add(New XElement(\"pageLength\", Value.ToString))\n        Return\n    End If\n\n    Element = (Configurations)(0)\n\n    If Not IsNothing(Element) Then\n        Element.Add(New XElement(\"reportControl\", New XElement(\"pageLength\", Value.ToString)))\n        Return\n    End If\nEnd Set\n</code></pre>\n\n<p>Note that I'm treating the elements and attributes within an XDocument as VB properties.</p>\n"},{"tags":["linq","sharepoint2010","linq-to-entities"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12865745,"title":"LINQ Sharepoint SubmitChanges null exception","body":"<p>I have 3 lists(with content type) linked in the following way: </p>\n\n<hr>\n\n<p>Data many to one with Projects  | Projects has EntitySet[Data] and Data has EntityRef[Project]</p>\n\n<hr>\n\n<p>ActionPlan many to one with Projects | Projects has EntitySet[ActionPlan] and ActionPlan has EntityRef[Project]</p>\n\n<hr>\n\n<p>Data many to many with ActionPlan| both have EntitySet to eachother</p>\n\n<hr>\n\n<p>I have 1 object data source that on the select method returns either Project.EntitySet[actionPlan] or Data.EntitySet[actionplan].</p>\n\n<p>DataContext is saved in Session and also the current Project and current Data.</p>\n\n<hr>\n\n<p>I have a listview with the above data source and it is used to let user edit ActionPlan. \nWhen I try to call DataContext.SubmitChanges() i get null reference and also if I try to get the List Items from either list trough DataContext.ListName i also get null reference.</p>\n\n<hr>\n\n<p>From my testing if my object data source select method only returns the same entity set and i dont return the other one everything works fine. Exemple I comment the part that returns Data.ActionPlan and just let it return Project.ActionPlan.</p>\n\n<p>Here is the stacktrace:</p>\n\n<pre><code>   at Microsoft.SharePoint.Library.SPRequest.GetFieldsSchemaXml(String bstrUrl, String bstrListName, ISP2DSafeArrayWriter p2DWKProps, ISP1DSafeArrayWriter p1DFullXML)\n   at Microsoft.SharePoint.SPFieldCollection.EnsureFieldsSafeArray(Boolean bGetFullXML)\n   at Microsoft.SharePoint.SPFieldCollection.Undirty()\n   at Microsoft.SharePoint.SPBaseCollection.GetEnumerator()\n   at Microsoft.SharePoint.Linq.SPQueryable.&lt;AsEnumerable&gt;d__0`1.MoveNext()\n   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()\n   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)\n   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)\n   at Microsoft.SharePoint.Linq.Provider.SPServerDataList.get_Fields()\n   at Microsoft.SharePoint.Linq.EntityTracker.ValidateMapping()\n   at Microsoft.SharePoint.Linq.EntityTracker.SubmitChanges(ConflictMode failureMode, Boolean systemUpdate)\n   at Microsoft.SharePoint.Linq.DataContext.SubmitChanges(ConflictMode failureMode, Boolean systemUpdate)\n   mycode calls datacontext.SubmitChanges()\n   at System.Web.UI.WebControls.Button.OnClick(EventArgs e)\n   at System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument)\n   at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)\n   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)\n</code></pre>\n"},{"tags":["c#",".net","linq","odata","predicate"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":249,"score":4,"question_id":11431061,"title":"Parse a string to predicate","body":"<p>I'm trying to work out a solution, where at runtime a procedure would parse a \"string\" and return a predicate. so far what I've found is <a href=\"http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx\" rel=\"nofollow\">DynamicLinq</a> class (sample) that does the job.</p>\n\n<p>I'm wondering - is it possible to use OData lib to the same ? \nPass in the \"odata\" structure string (\"?color='red'&amp;param=foo\"), and get a Linq predicate ? </p>\n"},{"tags":["c#","sql","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":134,"score":4,"question_id":12861228,"title":"select where all values present in List<int>","body":"<p>I have a column that has comma separated IDs, I get this into a List in LINQ.</p>\n\n<p>What I need to do is only return DataRows where all values within this list are present in another, I've got it working if any are present but I need all.</p>\n\n<p>Code below:</p>\n\n<pre><code>results = \nresults.Where(\n    d =&gt; d[\"FilterIDs\"] != null &amp;&amp; // Check the row has FilterIds\n    !filterValues.Except(\n        d[\"FilterIDs\"].ToString().Split(',').ToList(). // Tokenise the string\n        Where(s =&gt; !String.IsNullOrEmpty(s)).ToList(). // Filter out bad tokens\n        ConvertAll&lt;int&gt;(s =&gt; Convert.ToInt32(s)) // Convert all the tokens to ints\n        ).Any());\n            }\n</code></pre>\n\n<p>So, for example, I have a row that has the 1,2,3,4 in it's column 'FilterIDs'</p>\n\n<p>I then have 1,2,3,4,5,6,7 in my List 'filterValues' - in this instance, this row would be returned.</p>\n\n<p>Another row has 1,8,9 - only 1 matches so this wouldn't be returned.</p>\n\n<p>I've been going round in circles and have lost the will with this so any help is greatly appreciated.</p>\n"},{"tags":[".net","linq","entity-framework","aggregate-functions","expression-trees"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12862843,"title":"Query that uses the Aggregate extension method against DbContext","body":"<p>I had a <code>MockDataStore</code> that returns a <code>List&lt;Task&gt;</code>. Then I would use the <code>Aggregate</code> extension method to query that list. So I was doing a LINQ-to-Objects query which does the job quiet nicely. Now that I've replaced my mock data store with a class that inherits the <code>DbContext</code> class, the same query does not work anymore because I cannot use a lambda expression that has a body since it cannot be converted to an expression tree. So is there a way to get around it and still have the aggregation done in SQL and avoid having to do it in-memory? Below is my code:</p>\n\n<pre><code>        //List&lt;Task&gt; tasks = MockDataStore.GetData()\n        //    .Aggregate(new List&lt;Task&gt;(), (accumulator, treaty) =&gt; { accumulator.AddRange(treaty.Tasks); return accumulator; })\n        //    .Where(x =&gt; x.AssignedTo.Equals(companyId) &amp;&amp; x.StatusId == statusId).ToList();\n\n        using (SCGREDbContext context = new SCGREDbContext())\n        {\n            List&lt;Task&gt; tasks = context.Treaties.Aggregate(new List&lt;Task&gt;(), (accumulator, treaty) =&gt; { accumulator.AddRange(treaty.Tasks); return accumulator; })\n                                .Where(x =&gt; x.AssignedTo.Equals(companyId) &amp;&amp; x.StatusId == statusId).ToList();\n            return tasks;\n        }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":12325563,"title":"c# - the concise way to initialize an array of reference type object","body":"<p>I wonder if there is better way to initialize an array of reference type object, like this. </p>\n\n<pre><code>Queue&lt;int&gt;[] queues = new Queue&lt;int&gt;[10];\nfor (int i = 0; i &lt; queues.Length; i++)\n    queues[i] = new Queue&lt;int&gt;();\n</code></pre>\n\n<p>I tried Enumerable.Repeat, but all elements in the array refer to same instance,</p>\n\n<pre><code>Queue&lt;int&gt;[] queues = Enumerable.Repeat(new Queue&lt;int&gt;(), 10).ToArray();\n</code></pre>\n\n<p>I also tried Array.ForEach, but it doesn't work without ref keyword:</p>\n\n<pre><code>Queue&lt;int&gt;[] queues = Array.ForEach(queues, queue =&gt; queue = new Queue&lt;int&gt;());\n</code></pre>\n\n<p>any other idea?</p>\n"},{"tags":["c#",".net","linq","entity-framework","linq-to-entities"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12863171,"title":"An entity object cannot be referenced by multiple instances of IEntityChangeTracker","body":"<p>I'm having a problem with updating object entities in EF. I'm using VS 2010 and .NET 4</p>\n\n<pre><code>    private void Update(InstallerEntity editObj)\n    {\n        using (var eo = DataManager.CreateNewEntitiesContext())\n        {\n            eo.Attach(editObj);\n            eo.ApplyPropertyChanges(\"InstallerEntity \", editObj);\n            eo.SaveChanges();\n\n\n        }\n    }\n</code></pre>\n"},{"tags":["xml","linq","subquery"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":12862931,"title":"XML with subquerys using LINQ","body":"<p>I am using XML.Linq to search through an XML file.</p>\n\n<pre><code>    &lt;Location id=\"1284\" parentID=\"1333\" level=\"4\" writerID=\"0\" creatorID=\"3\" nodeType=\"1266\" template=\"1272\" sortOrder=\"0\" createDate=\"2012-04-09T09:41:33\" updateDate=\"2012-08-16T11:43:11\" nodeName=\"Princeton Junction\" urlName=\"princeton-junction\" writerName=\"Web\" creatorName=\"My Name\" path=\"-1,1092,1258,1333,1284\" isDoc=\"\"&gt;\n      &lt;solutionsOfferedIndustries&gt;1109,1172,1290,1293,1295,1296,1298,1300,1302&lt;/solutionsOfferedIndustries&gt;\n      &lt;umbracoUrlAlias&gt;\n      &lt;/umbracoUrlAlias&gt;\n      &lt;uHidesy&gt;&lt;![CDATA[{\"document\":{\"id\":1284,\"documentType\":\"Location\",\"tabs\":[{\"name\":\"Address &amp; Contact Info\",\"index\":0,\"properties\":[{\"name\":\"Map Position\\u003cbr\\u003e\",\"index\":0,\"status\":\"show\"},{\"name\":\"Location Name\",\"index\":0,\"status\":\"hide\"},{\"name\":\"Office Type\\u003cbr\\u003e\",\"index\":0,\"status\":\"show\"},{\"name\":\"State (if in USA)\",\"index\":0,\"status\":\"show\"},{\"name\":\"Street Address\\u003cbr\\u003e\",\"index\":0,\"status\":\"show\"},{\"name\":\"Street Address (Line 2)\",\"index\":0,\"status\":\"show\"},{\"name\":\"City\\u003cbr\\u003e\",\"index\":0,\"status\":\"show\"},{\"name\":\"ZIP Code/Postal Code\\u003cbr\\u003e\",\"index\":0,\"status\":\"show\"},{\"name\":\"Country\",\"index\":0,\"status\":\"show\"},{\"name\":\"Location Phone Number\",\"index\":0,\"status\":\"show\"},{\"name\":\"Location Fax Number\",\"index\":0,\"status\":\"show\"}],\"status\":\"show\"},{\"name\":\"Building Photo\",\"index\":1,\"properties\":[{\"name\":\"Upload Image\\u003cbr\\u003e\",\"index\":1,\"status\":\"show\"},{\"name\":\"-Property-name-not-displayed-\",\"index\":1,\"status\":\"show\"}],\"status\":\"show\"},{\"name\":\"Solutions Offered\",\"index\":2,\"properties\":[{\"name\":\"Solutions Offered - Industries\",\"index\":2,\"status\":\"show\"}],\"status\":\"show\"},{\"name\":\"Miscellaneous\",\"index\":3,\"properties\":[{\"name\":\"Custom Page URL\\u003cbr\\u003e\",\"index\":3,\"status\":\"hide\"},{\"name\":\"Divisions\\u003cbr\\u003e\",\"index\":3,\"status\":\"show\"},{\"name\":\"General Manager\",\"index\":3,\"status\":\"show\"},{\"name\":\"Notes\\u003cbr\\u003e\",\"index\":3,\"status\":\"hide\"}],\"status\":\"show\"},{\"name\":\"Tab &amp; Property Visibility\",\"index\":4,\"properties\":[{\"name\":\"uHidesy\\u003cbr\\u003e\",\"index\":4,\"status\":\"show\"}],\"status\":\"hide\"},{\"name\":\"Properties\",\"index\":5,\"properties\":[{\"name\":\"Name\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Created by\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Created\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Id\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Document Type\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Template\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Publication Status\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Last edited\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Publish at\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Remove at\",\"index\":5,\"status\":\"hide\"},{\"name\":\"Link to document\",\"index\":5,\"status\":\"show\"}],\"status\":\"show\"}],\"applyToAll\":true,\"applyToAdmin\":false,\"savedDate\":\"16/08/2012 15:01:35\"}}]]&gt;&lt;/uHidesy&gt;\n      &lt;umbracoFile&gt;/media/5153/front_of_building.jpg&lt;/umbracoFile&gt;\n      &lt;coordinates&gt;&lt;![CDATA[40.297833,-74.64424600000001,13]]&gt;&lt;/coordinates&gt;\n      &lt;imageCrop&gt;\n        &lt;crops date=\"10/05/2012 10:33:52\"&gt;\n          &lt;crop name=\"Location Photo\" x=\"287\" y=\"0\" x2=\"1785\" y2=\"1498\" url=\"/media/5153/front_of_building_Location Photo.jpg\" /&gt;\n        &lt;/crops&gt;\n      &lt;/imageCrop&gt;\n      &lt;locationName&gt;Princeton Junction&lt;/locationName&gt;\n      &lt;officeType&gt;Corporate Headquarters&lt;/officeType&gt;\n      &lt;state&gt;&lt;![CDATA[NJ - New Jersey]]&gt;&lt;/state&gt;\n      &lt;streetAddress&gt;123 My Road&lt;/streetAddress&gt;\n      &lt;streetAddress2&gt;\n      &lt;/streetAddress2&gt;\n      &lt;city&gt;Princeton Junction&lt;/city&gt;\n      &lt;zipCode&gt;08550&lt;/zipCode&gt;\n      &lt;country&gt;United States&lt;/country&gt;\n      &lt;divisions&gt;&lt;![CDATA[Services,Products &amp; Systems]]&gt;&lt;/divisions&gt;\n      &lt;locationPhoneNumber&gt;123-456-7890&lt;/locationPhoneNumber&gt;\n      &lt;locationFaxNumber&gt;123-456-7891&lt;/locationFaxNumber&gt;\n      &lt;generalManager&gt;\n      &lt;/generalManager&gt;\n      &lt;notes&gt;&lt;![CDATA[Blah:\n          -Blah1\n          -Blah2\n          -Blah3]]&gt;&lt;/notes&gt;\n    &lt;/Location&gt;\n</code></pre>\n\n<p>I am using the following code to get everything I need but I also need to get the attribute url of Location\\imageCrop\\crops\\crop.</p>\n\n<pre><code>    var query = from c in xmldoc.Root.Descendants(\"Location\")\n                    select c.Attribute(\"id\").ToString().Replace(\"\\\"\", \"\").Replace(\"id=\", \"\") + \"\\t\"\n                            + c.Element(\"locationName\").Value + \"\\t\"\n                            + c.Element(\"streetAddress\").Value + \"\\t\"\n                            + c.Element(\"streetAddress2\").Value + \"\\t\"\n                            + c.Element(\"city\").Value + \"\\t\"\n                            + c.Element(\"state\").Value + \"\\t\"\n                            + c.Element(\"zipCode\").Value + \"\\t\"\n                            + c.Element(\"country\").Value + \"\\t\"\n                            + c.Element(\"locationPhoneNumber\").Value + \"\\t\"\n                            + c.Element(\"locationFaxNumber\").Value+ \"\\t\"\n                            + c.Attribute(\"urlName\").ToString().Replace(\"\\\"\", \"\").Replace(\"urlName=\", \"\");\n</code></pre>\n\n<p>How do I add that subquery to this query?</p>\n"},{"tags":["linq","methods","dictionary","where"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12676224,"title":"Linq overloading where clause to exclude a specific type","body":"<p>I am implementing an extension method that returns <code>TKey</code> with <code>IDictionary&lt;TKey, TValue&gt;</code> as an argument. If <code>TValue</code> is <code>double</code>, the method is likely to return a <code>TKey</code> with the highest value. Otherwise, it will randomly return a <code>TKey</code>.</p>\n\n<pre><code>    public static TKey Sample&lt;TKey&gt;(this IDictionary&lt;TKey, double&gt; probabilityTable, Random r)\n    {\n        probabilityTable.Normalize();\n\n        var roll = r.NextDouble();\n        var temp = 0.0;\n        foreach (var key in probabilityTable.Keys)\n        {\n            temp += probabilityTable[key];\n            if (roll &lt;= temp)\n                return key;\n        }\n\n        return default(TKey);\n    }\n\n    public static TKey Sample&lt;TKey, TValue&gt;(this IDictionary&lt;TKey, TValue&gt; dictionary, Random r)\n    {\n        return dictionary.Skip(r.Next(dictionary.Count)).FirstOrDefault().Key;\n    }\n\n    public static IDictionary&lt;TKey, double&gt; Normalize&lt;TKey&gt;(this IDictionary&lt;TKey, double&gt; probabilityTable)\n    {\n        if (probabilityTable.Any(x =&gt; x.Value &lt; 0))\n            throw new ArgumentOutOfRangeException(\"probabilityTable\", \"Probability is expected to be positive.\");\n\n        var sum = probabilityTable.Sum(x =&gt; x.Value);\n\n        if (Math.Abs(sum - 1) &gt; 1e-8)\n            return probabilityTable.ToDictionary(x =&gt; x.Key, x =&gt; x.Value / sum);\n\n        if (Math.Abs(sum) &lt; 1e-8)\n            return probabilityTable.ToDictionary(x =&gt; x.Key, x =&gt; 1.0 / probabilityTable.Count);\n\n        return probabilityTable;\n    }\n</code></pre>\n\n<p>The problem is that <code>Sample&lt;TKey, TValue&gt;</code> is always called even with <code>double</code> of <code>TValue</code>. Any way that I can specify the type <code>TValue</code> exclude double with where clause? i.e. <code>where TValue: !double</code></p>\n\n<p>The code that calls the extension function is below:</p>\n\n<pre><code>        var r = new Random();\n        var pt = new Dictionary&lt;char, double&gt; {{'A', 0.1}, {'B', 0.2}, {'C', 0.7}};\n        var ct = new Dictionary&lt;char, char&gt; {{'A', 'D'}, {'B','E'}, {'C', 'F'}};\n        Console.WriteLine(pt.Sample(r)); // expected to return 'C' mostly but uniformly returns key\n        Console.WriteLine(ct.Sample(r));\n</code></pre>\n"},{"tags":["c#","linq","iqueryable"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12715827,"title":"How to get original collection from an IQueryable<T>","body":"<p>Consider the following:</p>\n\n<pre><code>T[] itemArray = // initialized values\nIQueryable&lt;T&gt; itemQuery = itemArray.AsQueryable().Where(*/some query*/).Skip(5).Etc() ...\n</code></pre>\n\n<p>Is it possible to get the underlying collection or dataset (in this case <code>itemArray</code>) from <code>itemQuery</code>?  It seems to me that if when the query expression is evaluated, it must be evaluated against the original collection and therefore that collection must be stored in or referenced by the IQueryable.</p>\n\n<p>How can this be done?</p>\n\n<p>NOTE:<br>\nThis is part of a larger project with the MongoDB linq driver (from 10gen) where we are trying to extract the original MongoCollection from an IQueryable that is based on the mongo collection.  Although we are using IQueryable&lt;> specifically with respect to MongoDB, the answer to this question should be inherent to IQueryable&lt;> and therefore independent of the MongoDB drivers.</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12847298,"title":"Splitting an IEnumerable into two","body":"<p>I'd like to split a list into two lists, one which can be handled directly, and the other being the remainder, which will be passed down a chain to other handlers.</p>\n\n<p>Input:</p>\n\n<ul>\n<li>One list of items</li>\n<li>a filtering method to determine which list to include the item in.</li>\n</ul>\n\n<p>Output:</p>\n\n<ul>\n<li>a \"true\" list</li>\n<li>a \"false\" list</li>\n</ul>\n\n<p>Does this already exist? Perhaps a Linq method that I'm not thinking of at the moment? Otherwise, does anyone have a good C# example?</p>\n"},{"tags":["c#","linq","query"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12835851,"title":"Find closest location with longitude and latitude using linq c#","body":"<p>i am working on a application where i need to get nearby location, \nmy web service will receive 2 parametrs (decimal longitude, decimal latitude )</p>\n\n<p>i have a table where the locations are saved in database with longitude and latitude fields,</p>\n\n<p>i want to retrieve the nearest locations.</p>\n\n<p>can anyone help ?</p>\n\n<p>Thanks</p>\n\n<p>here is my code</p>\n\n<pre><code> var locations = from l in locations\n\n     select l\n</code></pre>\n\n<p>Here are further details about this :\ni have a 2 fields (decimal(18, 2) null) 1 latitude, 2 longitude inside a database table,</p>\n\n<p>and i have a method </p>\n\n<pre><code>public List&lt;Locations&gt;  GetLocation(decimal? Long, decimal? lat) \n{\nvar Loc = from l in Locations\n  //// now here is how to get nearest location ? how to query?\n  //// i have also tried Math.Abs(l.Lat - lat) its giving error about nullable decimal always hence i have seted decimal to nullable or converted to nullable\n //// also i have tried where (l.lat - Lat) * (l.lon - Long)  this is also giving error about can not convert decimal to bool\nreturn Loc.ToList();\n}\n</code></pre>\n"},{"tags":["string","linq","list"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":12852943,"title":"What is wrong in this LINQ Query, getting compile error","body":"<p>I have a list <code>AllIDs</code>:</p>\n\n<pre><code>List&lt;IAddress&gt; AllIDs = new List&lt;IAddress&gt;();\n</code></pre>\n\n<p>I want to do <code>substring</code> operation on a member field <code>AddressId</code> based on a character \"_\".</p>\n\n<p>I am using below LINQ query but getting compilation error:</p>\n\n<pre><code>AllIDs= AllIDs.Where(s =&gt; s.AddressId.Length &gt;= s.AddressId.IndexOf(\"_\"))\n    .Select(s =&gt; s.AddressId.Substring(s.AddressId.IndexOf(\"_\")))\n    .ToList();\n</code></pre>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Cannot implicitly convert type 'System.Collections.Generic.List&lt;string>' to 'System.Collections.Generic.List&lt;MyCompany.Common.Users.IAddress>'</p>\n</blockquote>\n"},{"tags":["asp.net-mvc-3","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12859022,"title":"selecting distinct value in linq mvc3","body":"<p>i am binding the below data to a drop down but am not able to get disctinct value. Please help. Find the code snippet below</p>\n\n<pre><code>var SalesOrgTypes = (from s in tblSales\n                         orderby s.SalesOrg ascending\n                         select new DropDownItem\n                         {\n                             Value = s.SalesOrg,\n                             Text = s.SalesOrg + \" - \" + s.SalesOrgDesc\n                         }).Distinct();\n</code></pre>\n"},{"tags":["linq","c#-4.0","generics"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12857523,"title":"Problems in adding collection to list with list.Add","body":"<pre><code> private List&lt;T&gt; ParsePolicyDetails&lt;T&gt;(List&lt;HouseHoldview&gt; lsthousehold)\n    {\n        List&lt;T&gt; lstPolicyInfo = new List&lt;T&gt;();\n\n        var checkInHouseHold = from c in lsthousehold\n                               where c.PolicyDetail.Any(p =&gt; p.LineOfBusiness.Trim().ToUpper() == \"A\" &amp;&amp; p.PolicySourceSystem.ToUpper().Trim() != \"PLCS\"\n                                   &amp;&amp; p.PolicySourceSystem.ToUpper().Trim() != \"APS\"\n                                   &amp;&amp; p.PolicySourceSystem.ToUpper().Trim() != \"FOREMOST\")\n                               select c.PolicyDetail;\n\n        foreach (var policies in checkInHouseHold)\n        {\n            var chek=policies.Where(p =&gt; p.LineOfBusiness.Trim().ToUpper() == \"A\" &amp;&amp; p.PolicySourceSystem.ToUpper().Trim() != \"PLCS\"\n                                     &amp;&amp; p.PolicySourceSystem.ToUpper().Trim() != \"APS\"\n                                     &amp;&amp; p.PolicySourceSystem.ToUpper().Trim() != \"FOREMOST\" &amp;&amp; p.LineOfBusiness.ToUpper().Trim() == \"A\");\n            lstPolicyInfo.Add(chek);\n        }\n        return lstPolicyInfo;\n    }\n</code></pre>\n\n<p>Looks like very simple code but giving error. As chek is not of type T how to handle this</p>\n\n<p>Error is The best overloaded method match for 'System.Collections.Generic.List.Add()</p>\n"},{"tags":["c#","linq","list","compare","dto"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12852982,"title":"Original List vs Edited List of objects; How to locate the edited items with linq?","body":"<p>I have an OrderDto class that implements the IEquatable interface.  I have a list of Orders that are retrieved from the database as OrderDto objects.  This list is edited by the end user... Adding new objects; Deleting existing objects; Editing existing objects.  I need to determine the following:</p>\n\n<ol>\n<li>New objects in the list;  </li>\n<li>Deleted objects in the list;  </li>\n<li>Edited objects in the list;</li>\n</ol>\n\n<p>I have commented the following code to discuss these three goals.  The first two are trivial, but the third item in my list is very vexing!  I cannot seem to create it using linq.  I hope that you can give me a nudge in the correct direction.  Please see the following code for details.</p>\n\n<p>Thank you for your help!\nMike</p>\n\n<pre><code>// Get the original list of OrderDtos before the user did anything.\nvar entityOrders = Mapper.Map&lt;IList&lt;OrderEntity&gt;, IList&lt;OrderDto&gt;&gt;(entity.Orders.ToList());  \n\n// dto.Orders is a parameter that is being used in this code.  It is the list of OrderDto\n// objects that the user has modified: Insert, edit, delete.\n\n// Works properly to locate items that were deleted.          \nvar deletedOrders = entityOrders.Except(dto.Orders);\n\n// Works properly to locate items that were added.\nvar addedOrders = dto.Orders.Except(entityOrders);\n\n// Determine the list of order objects less new orders in the list.\n// The user has already deleted objects, so we don't have to worry\n// about them.  This list will contain only items that MAY have \n// been edited.\nvar potentialChanges = dto.Orders.Except(addedOrders);\n\n// ARGGG!  I cannot seem to get this one to work properly!  As you can see in the \n// definition of the OrderDto, it implements the IEquatable interface.  So, it \n// should be very easy to determine which items in the dto.Orders list have been\n// edited as opposed to the original version in the entityOrders list.  What I \n// would like to have is a list of all the OrderDto objects in the dto.Orders list\n// that have been modified.  Since OrderDto implements IEquatable, we should be able\n// to compare OrderDto objects directly, but I have not been able get it to work.\n// Please helP! :)\nvar changedOrders =\n   from dtoOrder in potentialChanges\n   let entityOrder = entityOrders.First(x =&gt; x.OrderId == dtoOrder.OrderId)\n   where entityOrder != null &amp;&amp; !dtoOrder.Equals(entityOrder)\n   select dtoOrder;\n</code></pre>\n\n<p>Here is the definition of the OrderDto class...</p>\n\n<pre><code>public class OrderDto : IEquatable&lt;OrderDto&gt;\n{\n    public long OrderId { get; set; }\n    public string DisplayAs { get; set; }\n\n    #region IEquatable\n    public override int GetHashCode()\n    {\n        // Populate with all fields so\n        // we can detect when an entity\n        // has been edited.\n        return \n        (\n            (int) OrderId ^ \n            DisplayAs.GetHashCode()\n        );\n\n    }\n\n    public override bool Equals(object other)\n    {\n        return this.Equals(other as OrderDto);\n    }\n\n    public bool Equals(OrderDto other)\n    {\n        // Populate with all fields so\n        // we can detect when an entity\n        // has been edited.\n        return \n        (\n            other != null &amp;&amp;\n            other.OrderId == this.OrderId &amp;&amp;\n            other.DisplayAs == this.DisplayAs \n        );\n    } \n\n    #endregion\n}\n</code></pre>\n"},{"tags":["linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12855046,"title":"How to cast to a generic list from the lamda expression result","body":"<p>I have a class structure like below.</p>\n\n<pre><code>ObservableCollection&lt;Group&gt; deviceCollection = new ObservableCollection&lt;Group&gt;();\npublic class Group \n{ \n    public string Name { get; set; }       \n    public List&lt;TargetSelectionStructure&gt; TargetCollection { get; set; }\n}\npublic class TargetSelectionStructure\n{\n    public string ItemId { get; set; }\n    public string Name { get; set; }\n    public bool IsGroup { get; set; }\n}\n</code></pre>\n\n<p>From the observable collection object deviceCollection. I need to get the collection which matches with IsGroup property as false. so i have written like</p>\n\n<pre><code>var currentStruct = deviceCollection.Where(d =&gt; d.TargetCollection.Any(t =&gt; t.IsGroup == false));\n</code></pre>\n\n<p>Now the currentStruct should contain the collection basically <code>List&lt;TargetSelectionStructure&gt;</code>. I am unable to cast the currentStruct to the type of <code>List&lt;TargetSelectionStructure&gt;</code>.<br>\nhow can i solve this?</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12853857,"title":"Linq query error in C#","body":"<p>I have a Logs table created in Windows Azure (WADLogsTable). I need to get a specific column of a given time period. Below is the Linq query I used. Here \"Logs\" means my own created DTO class. There is no error when building. But when running it gives an error (doesn't show much details).</p>\n\n<pre><code>List&lt;Logs&gt; promotionInfo =null;\n\npromotionInfo = (from e in serviceContext.CreateQuery&lt;Logs&gt;(\"WADLogsTable\")\n                         where e.Timestamp &gt; startDate &amp;&amp; e.Timestamp &lt; endDate\n                         select new Logs { Pid= e.Pid }).ToList();\n</code></pre>\n\n<p>Please show me where is my fault.</p>\n"},{"tags":["asp.net","linq"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12852655,"title":"How to remove an Item from a list?","body":"<p>I have this model:</p>\n\n<pre><code>public class StationData\n{\n    public int StationID{ get; set; }\n    public List&lt;int&gt; FileID { get; set; }\n}\n</code></pre>\n\n<p>In my main page, I call a method that will return an object of type \"StationData\".</p>\n\n<p>Now, what I want is to remove an item from the \"List\" where FileID = value;</p>\n\n<p>Is that possible?</p>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":95,"score":0,"question_id":12853219,"title":"Existence of a number","body":"<p>Given an integer array</p>\n\n<pre><code>[1,2,3,4,1]\n</code></pre>\n\n<p>What is the easiest way to know where there exist a 1 (maybe linq)?</p>\n"},{"tags":["asp.net-mvc","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":12836202,"title":"Date part of DATETIME in LINQ","body":"<pre><code>(from sms in db.sms\n                where sms.NeedModeration == true &amp;&amp; sms.ReplyStatus == \"test\" &amp;&amp; **sms.date.Value == date**\n                select new \n                 {\n                     SMSID = sms.SmsID,\n                     Body = sms.body,\n                     Date=sms.date,\n                     ReplyStatus = sms.ReplyStatus\n                 }).AsEnumerable().Select(x=&gt;new VMSMS{\n                     SMSID=x.SMSID,\n                     Body=x.Body,\n                     Date= x.Date.Value,\n                     ReplyStatus = x.ReplyStatus\n                 })\n</code></pre>\n\n<p>Given code works properly but in where part i want to match the date part only of type DATETIME like</p>\n\n<pre><code> sms.date.Value.Date == date.Date\n</code></pre>\n\n<p>but it doesn't works properly it shows me the following error</p>\n\n<pre><code>The specified type member 'Date' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported.\n</code></pre>\n\n<p>So can you please tell me how can i <strong>extract Date part from DateTime</strong> type <strong>in LINQ</strong>?</p>\n\n<p>Here is sms ViewModel code....</p>\n\n<pre><code>public class VMSMS\n{\n    public long SMSID { get; set; }\n    public string SMS { get; set; }\n    public int? SPOID { get; set; }\n    public string Body { get; set; }\n    public string EmployeeName { get; set; }\n    [IgnoreDataMember]\n    public DateTime Date { get; set; }        \n    public bool? IsRead { get; set; }\n    public string DoctorCode { get; set; }\n    public string ReplyStatus { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","arrays","linq","loops","collections"],"answer_count":8,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":149,"score":0,"question_id":12798974,"title":"Assign LINQ Query result to Custom Collection and convert List<T> to T[]","body":"<p>It's a simple question but i don't really know how to do it efficiently. Is there any way to efficiently convert list of values to array e.g <code>List&lt;int&gt;</code> to <code>int[]</code> OR <code>List&lt;CustomObj&gt;</code> to <code>CustomObj[]</code> directly without using loops preferably by using Linq?</p>\n\n<p>In addition, I have a <code>GenericCollection&lt;T&gt;</code>, how can i convert the Linq query to <code>GenericCollection&lt;T&gt;</code> directly without looping e.g.</p>\n\n<pre><code>GenericCollection&lt;T&gt; result = SomeGenericCollection.Select(o =&gt; o).ToList&lt;GenericCollection&lt;T&gt;&gt;();\n</code></pre>\n"},{"tags":["asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12850826,"title":"How to get a data from list of list in LINQ?","body":"<p>I have these models:</p>\n\n<pre><code>public class StationData\n{\n    public List&lt;StationToStationModel&gt; Distances { get; set; }\n    public List&lt;int&gt; SortestPath { get; set; }\n}\n\npublic class StationToStationModel\n{\n    public int FromStation { get; set; }\n    public int ToStation { get; set; }\n    public int Distance { get; set; }\n}\n</code></pre>\n\n<p>In my main page, I call a method that will return an object of type \"StationData\".</p>\n\n<p>Now, what I want is to get the \"ToStation\" value where \"Distance\" is the smallest distance value in the given list of StationToStationModel.  How to do that?</p>\n\n<p>Thanks</p>\n\n<p>RJ</p>\n"},{"tags":["c#","linq","tsql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":12849697,"title":"How do I translate this SQL to LINQ","body":"<p>I'm trying to convert the following SQL into Linq but getting confused when I try to apply the min.  Basically I have a table which contains Beams and their allowed loads.  I then query the database and Find the smallest beam by type, which has the required strength.  The following t-SQL</p>\n\n<pre><code>select\n    sed.SEDetailID\nfrom\n    dbo.StructuralElementDetail sed\n    inner join (select StructuralElementID, min(Ix) as MinIX from dbo.StructuralElementDetail where Ix &gt;= @iRequired group by StructuralElementID) o\n        on sed.StructuralElementID = o.StructuralElementID\n            and sed.Ix = o.MinIX\norder by\n    StructuralElementID,\n    Sequence;\n</code></pre>\n\n<p>returns the smallest beam by type where they have the required strength.</p>\n\n<p>I already have the beams loaded into a Dictionary keyed by their IDs, so thought I should be able to query that object rather than make another call to the database.</p>\n\n<p>My dictionary is </p>\n\n<pre><code>Dictionary&lt;int, Beam&gt;;\n</code></pre>\n\n<p>I'm trying something like this but getting confused how I get just the smallest beam by each Type.</p>\n\n<pre><code>            var Beams = db.Values.Where(specificBeam =&gt; specificBeam.Ix &gt;= iRequired)\n                .GroupBy(specificBeam =&gt; specificBeam.ElementType)\n                    .Select(sb =&gt; new { sb.Key, MinIActual = sb.Min(specificBeam =&gt; specificBeam.Ix) });\n</code></pre>\n\n<p>Any pointers?  Can I nest a First combined with</p>\n"},{"tags":["c#","linq","reflection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12848673,"title":"Type casting, a runtime alternative to Cast<T>?","body":"<p>I have an <code>IList&lt;object&gt;</code> where every single object is an instance of a type <code>T</code> (which I don't know at compile-time).</p>\n\n<p>I need an <code>IList&lt;T&gt;</code> out of this. I can't use Cast since I don't know the type at compile time, and there isn't a Cast(Type) overload I could use.</p>\n\n<p>This is what I currently have in place:</p>\n\n<pre><code>private object Map(IList&lt;ApiCallContext&gt; bulk)\n{\n    // god-awful way to build a IEnumerable&lt;modelType&gt; list out of Enumerable&lt;object&gt; where object is modelType.\n    // quoting lead: \"think whatever you do it will be ugly\"\n    Type modelType = model.Method.ModelType;\n\n    if (bulk.Count &gt; 0)\n    {\n        modelType = bulk.First().Parameters.GetType();\n    }\n    Type listType = typeof(List&lt;&gt;).MakeGenericType(modelType);\n    object list = Activator.CreateInstance(listType);\n    foreach (object value in bulk.Select(r =&gt; r.Parameters))\n    {\n        ((IList)list).Add(value);\n    }\n    return list;\n}\n</code></pre>\n\n<p>What I'm thinking about is maybe I could create a new <code>LooseList</code> class that implements <code>IList</code> and just works around the casting, seems better than what I currently have but it still sounds way too clunky.</p>\n"},{"tags":["c#","linq","dictionary","linq-to-objects"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12849656,"title":"How to create this Linq function?","body":"<p>I've got an object like this:</p>\n\n<pre><code>Tuple&lt;Question, Levels[]&gt;\n\n// question, { easy, medium, hard }\n</code></pre>\n\n<p><code>Levels</code> is an enum with four options: Easy, Medium, Hard and Expert.</p>\n\n<p>And I want that for each enum which contains the tuple, LINQ function deliver a <code>Dictionary&lt;Question, Levels&gt;</code>. For example</p>\n\n<p>If my tuple has three levels, the dictionary should have three values,</p>\n\n<pre><code>// question, Easy\n// question, Medium\n// question, Hard\n</code></pre>\n"},{"tags":["c#","linq","query"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":82,"score":1,"question_id":12841168,"title":"Multiple linq joins but different operators","body":"<p>How would I express the following in LINQ?</p>\n\n<pre><code>select * from table_1 t1\njoin table_2 t2 on t1.col1 = t2.col1 and t1.col2 &lt;= t2.col2\n</code></pre>\n\n<p>Here's what I've tried, but I'm not getting the desired results. I'm trying to join\nthe 2 tables but since <code>table_1</code> quantity is not greater or equal than what's in <code>table_2</code> quantity for <code>WidgetA</code>\nI wouldn't expect there to be any records in the results (in xList ).</p>\n\n<pre><code>    List&lt;anObj&gt; table_1 = new List&lt;anObj&gt;();\n    table_1.Add(new anObj() { Product = \"WidgetA\", Quantity = 0 });\n    table_1.Add(new anObj() { Product = \"WidgetB\", Quantity = 3 });\n\n    List&lt;anObj&gt; table_2 = new List&lt;anObj&gt;();\n    table_2.Add(new anObj() { Product = \"WidgetA\", Quantity = 1 });\n    table_2.Add(new anObj() { Product = \"WidgetB\", Quantity = 1 });\n\n    var xList =\n    from t1 in table_1\n    join t2 in table_2\n        on t1.Product equals t2.Product\n    where t1.Quantity &gt;= t2.Quantity\n    select new\n    {\n        t1,\n        t2\n    };\n\n    if (xList.Any())\n        Console.WriteLine(\"Found\");\n    else\n        Console.WriteLine(\"None\"); //I'm looking for this result.           \n</code></pre>\n"},{"tags":["c#","linq","microsoft-metro"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12847636,"title":"LINQ group by one field and sort by another","body":"<p>I'm trying to create a grouped ListView for a Windows 8 Metro style app. Linq is a bit new to me. I understand the basics and I'm familiar with mySQL but I'm struggling with the syntax of this one. </p>\n\n<p>I have a class that contains (amongst other things) a string \"Date\" and an int \"epochTime\". The date string is a representation of the epochTime but in the format \"April, 23rd 2012\" for example - ignoring the hour of the event.</p>\n\n<p>So I want to group by the date string and sort the groups and the contents of the groups by the epoch time. The closest I've come so far is this</p>\n\n<pre><code>var result =\n                from fixture in items\n                group fixture by new { fixture.Date, fixture.epochTime } into g\n                orderby g.Key.epochTime\n                select g;\n</code></pre>\n\n<p>But this groups on date and epochTime so I get events that are on the same day but a different time in groups of their own. Can anyone point me in the right direction?</p>\n\n<p>Thanks is advance</p>\n"},{"tags":["c#","linq","linq-to-sql","entity"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":12846448,"title":"LINQ ExecuteQuery","body":"<p>I want to use ExecuteQuery() to get IEnumerable of type Entities.UserLevel. Following code works well. </p>\n\n<pre><code>using (CDataContext context = data.GetDataContext())\n{\n   string q = \"SELECT *FROM UserLevel\";\n   IEnumerable&lt;Entities.UserLevel&gt; res = context.ExecuteQuery&lt;Entities.UserLevel&gt;(q);\n}\n\n\npublic class UserLevel\n{\n   public int userID { get; set; }\n   public int levID { get; set; }\n}\n</code></pre>\n\n<p>But the problem is that I must use property names in UserLevel class same as in database, otherwise I do not get values. I wonder is there any way to get values irrespective of class/property name? For example, I want to use following UserLevel class instead of above:</p>\n\n<pre><code>public class UserLevel\n{\n   public int UserIdentity { get; set; }\n   public int LevelIdentity { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","linq","entity-framework-4","properties","linq-to-entities"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12844779,"title":"Search on all fields of an entity","body":"<p>I'm trying to implement an \"omnibox\"-type search over a customer database where a single query should attempt to match any properties of a customer.</p>\n\n<p>Here's some sample data to illustrate what I'm trying to achieve:</p>\n\n<pre><code>FirstName  | LastName  | PhoneNumber | ZipCode | ...\n--------------------------------------------------\nMary       | Jane      | 12345       | 98765   | ...\nJane       | Fonda     | 54321       | 66666   | ...\nBilly      | Kid       | 23455       | 12345   | ...\n</code></pre>\n\n<ul>\n<li>If the query was <code>\"Jane\"</code>, I'd expect row #1 to be returned as well as row #2.</li>\n<li>A query for <code>12345</code> would yield rows #1 and #3.</li>\n</ul>\n\n<p>Right now, my code looks pretty much like this:</p>\n\n<pre><code>IEnumerable&lt;Customer&gt; searchResult = context.Customer.Where(\n    c =&gt; c.FirstName == query ||\n    c =&gt; c.LastName == query ||\n    c =&gt; c.PhoneNumber == query ||\n    c =&gt; c.ZipCode == query ||\n    // and so forth. Fugly, huh?\n);\n</code></pre>\n\n<p>This obviously works. It smells like really bad practice to me, though, since any change in the Entity (removal of properties, introduction of new properties) would break stuff.</p>\n\n<p>So: is there some LINQ-foo that will search across all properties of whatever Entity I throw at it?</p>\n"},{"tags":["c#","linq","for-loop","iteration"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":104,"score":3,"question_id":12832483,"title":"Is there another way to take N at a time than a for loop?","body":"<p>Is there a more elegant way to implement going 5 items at a time than a for loop like this?</p>\n\n<pre><code>var q = Campaign_stats.OrderByDescending(c=&gt;c.Leads).Select(c=&gt;c.PID).Take(23);\nvar count = q.Count();\nfor (int i = 0; i &lt; (count/5)+1; i++)\n{\n   q.Skip(i*5).Take(5).Dump();\n}\n</code></pre>\n"},{"tags":["c#","linq","linq-to-sql","sql-order-by"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1186,"score":1,"question_id":4275878,"title":"LINQ: How to dynamically use an ORDER BY in linq but only if a variable is not string.empty or null","body":"<p>I am using LINQ2Sql and its working pretty well but depending on the value of a variable of type string in c# I need to ORder By or \"NOT\" order by.</p>\n\n<p>If its NOT null or empty then I want to order by on the contents of the string variable. If its empty or null then don't include order by.</p>\n\n<p>If for a dynamic paging procedure i have set up for a gridview and enabled Column sorting.. i basically pass in the value of the column that was clicked which in fact is the name of the column in the db</p>\n\n<p>Is this possible?</p>\n"},{"tags":["sql-server","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":12841396,"title":"Query Slow in Linq, Fast in LinqPad, SQL Management Studio and SQL Profiler","body":"<p>I have this linq query i'm using and it's taking 50 seconds to run when i am running it my asp.net application, however the same query executes in 500ms in LinqPad and Sql Management Studio. </p>\n\n<p>I even took the query from the SQL Profiler and ran it again in SQL Management Studio and it takes around 500ms. What overhead Linq could be doing, that an extra 49s??  </p>\n\n<p>Below is the code for reference, thanks for your help.</p>\n\n<pre><code>                var rCampaign = (from a in db.AdCreative\n                                 join h in db.AdHit on a.ID equals h.AdID into gh\n                                 join l in db.AdGroup_Location on a.AdGroupID equals l.AdGroupID into gj\n                                 from subloc in gj.DefaultIfEmpty()\n                                 from subhits in gh.DefaultIfEmpty()\n                                 where a.AdGroup.AdHost.Select(q =&gt; q.ID).Contains(rPlatform.ID) &amp;&amp;\n                                       a.AdGroup.AdPublisher.Select(q =&gt; q.ID).Contains(rPublisher.ID) &amp;&amp;\n                                       a.AdDimensionID == AdSize &amp;&amp;\n                                       a.AdGroup.Campaign.Starts &lt;= rNow &amp;&amp;\n                                       a.AdGroup.Campaign.Ends &gt;= rNow &amp;&amp;\n                                       subhits.HitType == 1 &amp;&amp;\n                                       (subloc == null || subloc.LocationID == rLocationID)\n                                 select new {\n                                     ID = a.ID,\n                                     Name = a.Name,\n                                     Spent = (subhits.AdDimension != null) ? ((double)subhits.AdDimension.Credit / 1000) : 0,\n                                     CampaignID = a.AdGroup.Campaign.ID,\n                                     CampaignName = a.AdGroup.Campaign.Name,\n                                     CampaignBudget = a.AdGroup.Campaign.DailyBudget\n                                 }).GroupBy(adgroup =&gt; adgroup.ID)\n                                   .Select(adgroup =&gt; new {\n                                       ID = adgroup.Key,\n                                       Name = adgroup.FirstOrDefault().Name,\n                                       Spent = adgroup.Sum(q =&gt; q.Spent),\n                                       CampaignID = adgroup.FirstOrDefault().CampaignID,\n                                       CampaignName = adgroup.FirstOrDefault().CampaignName,\n                                       CampaignBudget = adgroup.FirstOrDefault().CampaignBudget,\n                                   })\n                                  .GroupBy(q =&gt; q.CampaignID)\n                                  .Select(campaigngroup =&gt; new {\n                                      CampaignID = campaigngroup.Key,\n                                      DailyBudget = campaigngroup.FirstOrDefault().CampaignBudget,\n                                      Consumed = campaigngroup.Sum(q =&gt; q.Spent),\n                                      RemainningCredit = campaigngroup.FirstOrDefault().CampaignBudget - campaigngroup.Sum(q =&gt; q.Spent),\n                                      Ads = campaigngroup.Select(ag =&gt; new {\n                                          ID = ag.ID,\n                                          Name = ag.Name,\n                                          Spent = ag.Spent\n                                      }).OrderBy(q =&gt; q.Spent)\n                                  })\n                                  .Where(q =&gt; q.Consumed &lt;= q.DailyBudget).OrderByDescending(q =&gt; q.RemainningCredit).First();\n</code></pre>\n"},{"tags":["c#","linq","entity-framework-4"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":768,"score":1,"question_id":6333097,"title":"Linq query with multiple objects in parent child relationship","body":"<p>I have a schema like this</p>\n\n<p>Package -> Lists -> Users</p>\n\n<p>All 'one to many' down the line...</p>\n\n<p>So I want to run a query where I get all packages that a userID matches in users.</p>\n\n<pre><code>var pck = (from pk in context.Package\n             where pk.Lists[here's my problem]\n</code></pre>\n\n<p>I would assume the navigation properties here would be: <code>pk.Lists. *Users.UserId* == MyUserId</code>, however I'm not seeing the navigation properties at the Lists level. </p>\n\n<p>I haven't gotten to more complex EF queries like this yet. I've looked around the web but haven't found anything to make it click. I turn to you stack. Somebody help me see the light!</p>\n\n<p>EDIT: Thanks again stack, I will do my best to pay it forward!\nAlso, all of these answers enlightened me to the power of ef4!</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12838150,"title":"C# Linq one call to DB get multiple lists","body":"<p>Got this:</p>\n\n<pre><code>var ApprovalRoleRefList = db.ApprovalRoles.Select(x =&gt; x.ApprovalRoleName);\nvar CostDivisionRefList = db.CostDivisions.Select(x =&gt; x.CostDivisionName);\n</code></pre>\n\n<p>If I want this in one call to DB with linq, how would I do it?</p>\n\n<p>This isn't what I want:</p>\n\n<pre><code>var lists = (from ar in db.ApprovalRoles select ar.ApprovalRoleName).Concat (\nfrom cd in db.CostDivisions select cd.CostDivisionName);\n</code></pre>\n\n<p>In the project I got 3 more lists but is it \"bad performance\" to have 1 call or 5?\nI know that this part won't be used that much but it's fun to optimize it.</p>\n"},{"tags":["c#","linq","list"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12841365,"title":"AND Condition using LINQ","body":"<p>I have a List of Customers:</p>\n\n<pre><code>List&lt;customer&gt; customerList;\n</code></pre>\n\n<p>I wants to get just the customers that have Country=\"India\" and Status=\"A\".</p>\n\n<p>I tried this:</p>\n\n<pre><code>List&lt;customer&gt; customerList=customerList.Where(p=&gt;p.Country.Equals(\"India\") &amp;&amp; p.Status.Equals(\"A\")).ToList();\n</code></pre>\n\n<p>and </p>\n\n<pre><code>List&lt;customer&gt; customerList=customerList.Where(p=&gt;p.Country.Equals(\"India\")).Where(p=&gt;p.Status.Equals(\"A\")).ToList();\n</code></pre>\n\n<p>But neither returned anything.</p>\n\n<p>If I divide the condition like the below example then the records are being fetched correctly.</p>\n\n<pre><code>List&lt;customer&gt; customerList=customerList.Where(p=&gt;p.Country.Equals(\"India\")).ToList();\ncustomerList=customerList.Where(p=&gt;p.Status.Equals(\"A\")).ToList();\n</code></pre>\n\n<p>I wants to know how to filter the objects using an AND Condition in a single query.</p>\n\n<p>Could anyone tell, Is there any good way rather than calling where condtion.</p>\n"},{"tags":["c#","xml","linq","linq-to-xml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":53,"score":0,"question_id":12841265,"title":"LINQ to XML: Project to a List<string>","body":"<p>Using LINQ to XML, how can I project the following XML data into a <code>List&lt;string&gt;</code> with the values \"Test1\", \"Test2\" and \"Test3\".</p>\n\n<pre><code>&lt;objectlist&gt;\n    &lt;object code=\"Test1\" /&gt;\n    &lt;object code=\"Test2\" /&gt;\n    &lt;object code=\"Test3\" /&gt;\n&lt;/objectlist&gt;\n</code></pre>\n\n<p>I have the XML available in a string:</p>\n\n<pre><code>XDocument xlist = XDocument.Parse(xmlData);\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","linq-to-xml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12840647,"title":"Get max attribute value from XML using LINQ","body":"<p>I have the following <code>XML</code> file. I want to get <code>Max(\"NR\")</code> using <code>LINQ</code>. Could anyone help me to do this? I know how to do this for nodes, but attributes made me confused... :S</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;SMPyramid LayerName=\"qwe\" LayerPath=\"D:\\#PYRAMID\\qwe\" Extension=\".png\" Meters=\"100000\" RasterSize=\"4000\"&gt;\n  &lt;Level NR=\"0\" RasterXSize=\"512\" RasterYSize=\"512\" LastTileXSize=\"416\" LastTileYSize=\"416\" MinX=\"400000\" MaxX=\"500000\" MinY=\"1200000\" MaxY=\"1300000\" ScaleFactor=\"25\" TilesCountX=\"8\" TilesCountY=\"8\" /&gt;\n  &lt;Level NR=\"1\" RasterXSize=\"512\" RasterYSize=\"512\" LastTileXSize=\"323\" LastTileYSize=\"323\" MinX=\"400000\" MaxX=\"499980.9024\" MinY=\"1200019.0976\" MaxY=\"1300000\" ScaleFactor=\"34.679466666666663\" TilesCountX=\"6\" TilesCountY=\"6\" /&gt;\n  &lt;Level NR=\"2\" RasterXSize=\"512\" RasterYSize=\"512\" LastTileXSize=\"414\" LastTileYSize=\"414\" MinX=\"400000\" MaxX=\"499738.14613333333\" MinY=\"1200261.8538666666\" MaxY=\"1300000\" ScaleFactor=\"69.358933333333326\" TilesCountX=\"3\" TilesCountY=\"3\" /&gt;\n  &lt;Level NR=\"3\" RasterXSize=\"512\" RasterYSize=\"512\" LastTileXSize=\"206\" LastTileYSize=\"206\" MinX=\"400000\" MaxX=\"499599.42826666665\" MinY=\"1200400.5717333332\" MaxY=\"1300000\" ScaleFactor=\"138.71786666666665\" TilesCountX=\"2\" TilesCountY=\"2\" /&gt;\n  &lt;Level NR=\"4\" RasterXSize=\"358\" RasterYSize=\"358\" LastTileXSize=\"358\" LastTileYSize=\"358\" MinX=\"400000\" MaxX=\"499321.99253333331\" MinY=\"1200678.0074666666\" MaxY=\"1300000\" ScaleFactor=\"277.4357333333333\" TilesCountX=\"1\" TilesCountY=\"1\" /&gt;\n&lt;/SMPyramid&gt;\n</code></pre>\n"},{"tags":["c#","xml","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":74,"score":-4,"question_id":12840767,"title":"How to write select query using Linq to XML?","body":"<p>In my XDocument variable, I have XML like this </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;&lt;bases&gt;&lt;base id=\"1\" type=\"1\"/&gt;&lt;base id=\"2\" type=\"2\"/&gt;&lt;base id=\"3\" type=\"1\"/&gt;&lt;/bases&gt;\n</code></pre>\n\n<p>How should I write a query to select all bases? </p>\n"},{"tags":["visual-studio-2010","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":101,"score":2,"question_id":12833494,"title":"linq query for update more than one record","body":"<p>I have a table named <code>industries</code>. In this my fields are </p>\n\n<ul>\n<li><code>workfor_id</code>, </li>\n<li><code>workfor_usr_id</code>, </li>\n<li><code>workfor_industry_id</code>.</li>\n</ul>\n\n<p>With the same values of <code>workfor_id</code>, I have different <code>workfor_industry_id</code>'s.</p>\n\n<pre><code>foreach (var k in us){ \n    var ind = dbContext.industries.Where(i =&gt; i.workfor_id == \n        k.id).Select(i =&gt; i).FirstOrDefault(); \n    string ind2 = k.industry; \n    var industryParts =   ind2.Split(','); \n    var o = (industryParts.Length); \n    for (c = 0; c &lt; o; c++){  \n    ind.workfor_id = Convert.ToInt16(k.id); \n    ind.workfor_industry_id = Convert.ToInt16(k.industryid); }\n     }\n</code></pre>\n\n<p>To update workfor_industry_id field I have implemented inner loop inside the foreach loop to get the values of workfor_industry_id's.here same record is over loading with  different workfor_industry_id's.</p>\n\n<p>can you tell me how to implement this.</p>\n"},{"tags":["c#","linq","c#-4.0"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12838506,"title":"Using Linq how I have to add list items","body":"<pre><code>IEnumerable&lt;ReportFavorite&gt; list = reportService.GetReportFavorites(userId);\nddlReportFavorite.Items.Add()\n</code></pre>\n\n<p>I don't know how to add the lists to the dropdown using Linq. Thanks.</p>\n"},{"tags":["linq","linq-to-sql","group-by","grouping","inner-join"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12817966,"title":"Linq query for count outside join","body":"<p>I have two tables \n<code>PatientEncounterDemo</code> and <code>PatientMaster</code></p>\n\n<p><code>PatientEncounterDemo</code>:</p>\n\n<pre><code>PateientID(F.K int),\nDoctorId( F.K int),\nProcedureName\n\n\n\nPatientMaster:\n\nPatientId(P.K identity)\nPatientFirstName(varchar(50)),\nPatientLastName(varchar(50)),\nPatientDOB\n</code></pre>\n\n<p>I need to extract PatientName(patientFirstName_+patientLastName),patientDOB,and Count of procedures assigned to a paticular patient(a patient can have many procedures assigned to it)</p>\n\n<p>I have wrote SQL query for that result as:</p>\n\n<pre><code>//This puts the join inside count-\n\nselect distinct  PatientFirstName+ ' ' + PatientLastName as PatientName,PatientDOB,COUNT(ProcedureName) as [Proc Count] from\n(\nselect distinct  p.PatientFirstName,p.PatientLastName,p.PatientDOB,e.ProcedureName\nfrom PatientMaster p,PatientEncounterDemo e \nwhere p.PatientId=e.PatientId and e.DoctorId=1\n)as mytable group by PatientFirstName,PatientLastName,PatientDOB\n</code></pre>\n\n<p>But,I am struggling to do that through linq query.Please suggest some way..!!</p>\n"},{"tags":["c#","asp.net","linq","entity-framework","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12838209,"title":"Get newest Post of each forum","body":"<p>So I am working on a self made forum (ASP.net MVC4) and I am currently displaying all the forums, in the controller I do this easy query:</p>\n\n<pre><code>return View(db.Forums.ToList());\n</code></pre>\n\n<p>But now I want to be able to also include the top post. (a Forum entity has a collection of Post, Post has a Date, I want to order by that and then do a take(1)).</p>\n\n<p>I try something like:</p>\n\n<pre><code>return View(db.Forums.Include(z=&gt;z.Posts.OrderBy(x=&gt;x.Date).Take(1)).ToList());\n</code></pre>\n\n<p>Then I get  the error:</p>\n\n<blockquote>\n  <p>The Include path expression must refer to a navigation property\n  defined on the type. Use dotted paths for reference navigation\n  properties and the Select operator for collection navigation\n  properties. Parameter name: path</p>\n</blockquote>\n\n<p>PS: here is the current view</p>\n\n<pre><code>@model IEnumerable&lt;MyProject.Data.Forum&gt;\n\n@{\n    ViewBag.Title = \"Forum Index\";\n}\n\n&lt;h2&gt;Forums&lt;/h2&gt;\n\n&lt;table class=\"Forum\"&gt;\n    &lt;tbody&gt;\n    &lt;tr&gt;Main forums&lt;/tr&gt;\n    @foreach (var item in Model)\n    {\n        &lt;tr class=\"ForumItem\"&gt;\n            &lt;td&gt;&lt;a href=\"Index?id=@item.Id\"&gt;X&lt;/a&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;p&gt;&lt;a href=\"Index?id=@item.Id\"&gt;@item.Name&lt;/a&gt;&lt;/p&gt;&lt;span&gt;@item.Description&lt;/span&gt;&lt;/td&gt;\n            &lt;td&gt;@item.PostCount&lt;/td&gt;\n            @foreach(var post in item.Posts)\n            {\n                &lt;td&gt;@post.Title&lt;/td&gt;\n            }\n        &lt;/tr&gt;\n    }\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Anyone knows a solution for this? </p>\n"},{"tags":["linq","linq-to-sql","entity-framework","linq-to-entities"],"answer_count":3,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":7175,"score":8,"question_id":5352545,"title":"What is difference between .edmx and .dbml file in linq?","body":"<p>What is difference between .edmx and .dbml file in linq?In VS 2008 which datasource is best choice where edmx or dbml?Any problem will arise using edmx file in VS 2008?Can i use edmx in VS-2008? </p>\n"},{"tags":["asp.net-mvc","linq","entity-relationship"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12822607,"title":"How do I relate a relational key from one model to many others? DTO? View model? or list? ASP.net","body":"<p>Currently the user can add a single ingredient to a recipe, but that relational key is then bound to that one recipe, changing it to a new recipe, removes the old link.</p>\n\n<p>I am looking for a method so a single version of each ingredient exists, but any recipe can contain it</p>\n"},{"tags":["c#","linq","dictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":73,"score":-2,"question_id":12838156,"title":"Query dictionary with linq","body":"<p>I have a dictionary that gets built which is below</p>\n\n<pre><code>Dictionary&lt;string, string&gt; GTNMobilelist = new Dictionary&lt;string, string&gt;();\nGTNMobilelist = LoadMobileNumbers();\n</code></pre>\n\n<p>i then need to query the Dictionary to check if a mobile number that has been enetered in to a textbox exists within the dictionary \"Hope that makes sense\" :-/</p>\n\n<p>this is what i have </p>\n\n<pre><code>foreach (GridViewRow HandSetRow in grdvHandSets.Rows)\n{\n   TextBox txtmobileNumber = (TextBox)HandSetRow.FindControl(\"txtmobilenumber\");\n\n   //I need the linq statement here if the mobile number doesnt exists i need to\n   //throw an error saying mobile number doesnt exist within the dictionary\n   //iv been looking at linq statements for the past hour and im confused :(\n}\n</code></pre>\n\n<p>Can any one help me on a quick solution for this? </p>\n"},{"tags":["c#","sql","linq","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12826378,"title":"Left Join using Linq with condition","body":"<p>I am trying to create a left join with a condition in my C# code. I can write it in SQL Server, but I am having problems writing it as a lambda expression. Here is a rough part of my SQL Code:</p>\n\n<pre><code>Select x.RequestId, aud.DepartmentId\nFrom Requests x\nLeft Join UserDepartment ud on x.AssignedToTeam = ud.DepartmentId and ud.User = 'Joe'\n</code></pre>\n\n<p>I know how to write the Left Join but am unfamiliar with how or if it is possible to add the condition.</p>\n"},{"tags":["asp.net","visual-studio-2008","linq","entity-framework","c#-3.0"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":893,"score":0,"question_id":2593262,"title":"Error: FormatException was unhandled by user code in Linq how to solve?","body":"<p><img src=\"http://i43.tinypic.com/5l8op0.jpg\" alt=\"alt text\"></p>\n\n<p>Look please below this codes throw me : FormatException was unhandled by user code</p>\n\n<p>Codes: </p>\n\n<pre><code> satis.KDV = Decimal.Parse((from o in genSatisctx.Urun where o.ID == UrunID select o.Kdv).ToString());</code></pre>\n\n<p>How can i rewrite linq query?</p>\n"},{"tags":["c#","linq","image","mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":255,"score":0,"question_id":10933439,"title":"Insert signature data into SQL Server in MVC 2 C#","body":"<p>I have working code that uses signature pad data to create and save a signature bmp image to a file location. My question is: how can I modify this code to insert the image into a SQL Server 2008 image field?</p>\n\n<p>The following from my Controller obtains signature data from a signature tablet and creates a bmp image and saves it to a file location.</p>\n\n<pre><code>        [PrincipalPermission(SecurityAction.Demand, Authenticated = true)]\n    public ActionResult SaveSignature2(IPrincipal principal) {\n        int userId = ((ScoutIdentity)principal.Identity).UserId.Value;\n        //Put user code to initialize the page here\n        SIGPLUSLib.SigPlus sigObj = new SIGPLUSLib.SigPlus();\n        sigObj.InitSigPlus();\n        sigObj.AutoKeyStart();\n\n        string visitorname = Request.Form[\"visitorname\"];\n        visitorname = visitorname.Replace(\" \", \"\"); //combines the first name with last name with no spaces\n        visitorname = visitorname.Trim();\n        string thevrvIDstr = Request.Form[\"vrvID\"];\n        int thevrvID = Convert.ToInt32(thevrvIDstr);\n\n        //use the same data to decrypt signature\n        sigObj.AutoKeyData = Request.Form[\"SigText\"];\n\n        sigObj.AutoKeyFinish();\n        sigObj.SigCompressionMode = 1;\n        sigObj.EncryptionMode = 2;\n\n        //Now, get sigstring from client\n        //Sigstring can be stored in a database if \n        //a biometric signature is desired rather than an image\n        sigObj.SigString = Request.Form[\"hidden\"];\n\n        if (sigObj.NumberOfTabletPoints() &gt; 0) {\n            sigObj.ImageFileFormat = 0;\n            sigObj.ImageXSize = 500;\n            sigObj.ImageYSize = 150;\n            sigObj.ImagePenWidth = 8;\n            sigObj.SetAntiAliasParameters(1, 600, 700);\n            sigObj.JustifyX = 5;\n            sigObj.JustifyY = 5;\n            sigObj.JustifyMode = 5;\n            long size;\n            byte[] byteValue;\n            sigObj.BitMapBufferWrite();\n            size = sigObj.BitMapBufferSize();\n            byteValue = new byte[size];\n            byteValue = (byte[])sigObj.GetBitmapBufferBytes();\n            sigObj.BitMapBufferClose();\n            System.IO.MemoryStream ms = new System.IO.MemoryStream(byteValue);\n            System.Drawing.Image img = System.Drawing.Image.FromStream(ms);\n            String path;\n            path = System.AppDomain.CurrentDomain.BaseDirectory;\n            path = path + \"/uploadFiles/Signatures/\"+thevrvIDstr+\".bmp\";\n            img.Save(path, System.Drawing.Imaging.ImageFormat.Bmp);\n\n\n\n           ViewData[\"Result\"] = (\"Image saved successfully to \" + path);\n        }\n        else {\n            ViewData[\"Result\"] = \"signature has not been returned successfully!\";\n        }\n\n\n        ViewData[\"Result\"] = sigObj.SigString;\n        //return RedirectToAction(\"vrSignIn\");\n        return View();\n    }\n</code></pre>\n\n<p>I also have code elsewhere in my controller that gets an uploaded file and inserts it into the database. This code works OK.</p>\n\n<pre><code> [AcceptVerbs(HttpVerbs.Post)]\n    public ActionResult UploadTempFiles(string id, string u)\n    {\n        //this method temporarily stores files \n        string userIdString = Cryptographer.DecryptSymmetric(\"RijndaelManaged\", SecurityImpl.UrlToBase64(u));\n        int userId = Convert.ToInt32(userIdString);\n\n        if (Request.Files.Count &gt; 0)\n        {\n            for (int i = 0; i &lt; Request.Files.Count; i++)\n            {\n                HttpPostedFileBase file = Request.Files[i];\n                int contentlength = file.ContentLength;\n                byte[] b = new byte[contentlength];\n                Stream s;\n                s = file.InputStream;\n                s.Read(b, 0, contentlength);\n                VisitRequest.AddVisitorSignature(userId, b);\n            }\n        }\n\n        return View(\"UploadFiles\");\n    }\n</code></pre>\n\n<p>I'm thinking that I can use some part of the second code to interrupt the image creation process in the first code and insert the image into the database INSTEAD of saving the image to a file location. I don't know how to do that.</p>\n"},{"tags":["c#","linq","search","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":11027668,"title":"Linq Date comparison with same day","body":"<p>I have this query:</p>\n\n<pre><code>var q = from p in DB.treatments\n    where p.start &gt;= start &amp;&amp; p.end &lt;= end\n    select p;\n</code></pre>\n\n<p>And in the database the end says 06/14/2012 12:00 a.m. which supposedly includes the whole 14 of june just before it turns 15 of june.</p>\n\n<p>So if i send the end parameter with 06/14/2012 04:00 p.m. it doesnt return anything, only if it were 06/15/2012 but I want it to search the whole day the 14, not 15.</p>\n\n<p>So i want to search the whole day of the 14, and the datetime returns this 06/14/2012 12:00 a.m. when selecting the 14.</p>\n\n<p>How do I do it?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":223,"score":7,"question_id":7380182,"title":"Having some trouble understanding Linq's INTO keyword","body":"<p>1) </p>\n\n<blockquote>\n  <p>into keyword creates temporary identifier for storing results of join,\n  group or select clauses.</p>\n</blockquote>\n\n<p>I assume <code>into</code> keyword can only be used as part of <em>group</em>, <em>join</em> or select clauses?</p>\n\n<p>2) </p>\n\n<p>a) I've read that when <code>into</code> is used as a part of <em>group</em> or <em>select</em> clauses, it splices the query in two halves and because of that range variables declared in first half of the query ALWAYS go out of scope in the second half of the query. Correct?</p>\n\n<p>b) But when <code>into</code> is used as part of the <em>join</em> clause, rangle variables NEVER go out of the scope within the query ( unless query also contains <code>group...into</code> or <code>select...into</code> ). I assume this is due to <code>into</code> not splicing the query in two halves when used with <em>join</em> clause? </p>\n\n<p>c) \nA query expression consists of a <em>from</em> clause followed by optional query body ( <em>from,where,let</em> clauses ) and must end with either <em>select</em> of <em>group</em> clause. </p>\n\n<p>d) If <code>into</code> indeed splices query into two halves, is in the following example <em>group</em> clause part of the body:</p>\n\n<pre><code>        var result = from c1 in a1\n                     group c1 by c1.name into GroupResult\n                     select ...\n</code></pre>\n\n<p>thank you</p>\n\n<p><br></p>\n\n<p><strong>Reply to Ufuk:</strong></p>\n\n<p>a)</p>\n\n<blockquote>\n  <p>After a group by you get a sequence of like this\n  IEnumerable></p>\n</blockquote>\n\n<p>Doesn't a  <code>GroupBy</code> operator return a result of type <code>IEnumerable&lt;IGrouping&lt;Key,Foo&gt;&gt;</code> and not <code>IEnumerable&lt;Key,IEnumerable&lt;Foo&gt;&gt;</code></p>\n\n<p>b) Couldn't we arguee that <code>group...by...into</code> or <code>join...into</code> do splice the query in a sense that first half of the query at least conceptually must run before the second half of the query can run?</p>\n\n<p><strong>Reply to Robotsushi:</strong></p>\n\n<p>the more I'm thinking about it, the more I get the feeling that my question is pretty pointless since it has no practical value what so ever. Still...</p>\n\n<blockquote>\n  <p>When you say it gets split. Do you mean the scope of the variables\n  gets split or the sql query generated gets split</p>\n</blockquote>\n\n<p>Here is the quote:</p>\n\n<blockquote>\n  <p>In many cases the range variables on one side of this divide cannot be\n  mixed with the range variables on the other side. The into keyword\n  that is part of this group-by  clause is used to link or splice the\n  two halves of this query. As such, it marks the boundary in the midst\n  of the query over which range variables typically cannot climb. The\n  range variables above the into keyword go out of scope in the last\n  part of this query.</p>\n</blockquote>\n\n<p>My question is whether both halves are still considered a single query and as such the entire query still consists of just three parts. If that is the case, then in my code example ( under d) ) group clause is part of the body. But if both halves are considered two queries, then each of the two queries will consist of three parts</p>\n\n<p><br></p>\n\n<p><strong>2. reply to Robotsushi:</strong></p>\n\n<blockquote>\n  <p>This chunk of your query is evaluated as one data pull.</p>\n</blockquote>\n\n<p>I'm not familiar with the term \"data pull\", so I'm going to guess that what you were trying to say is that first half of the query executes/evaluates as a unit, and then second half of the query takes the results from the first half and uses the results in its execution/evaluation? In other words, conceptually we have two queries? </p>\n"},{"tags":[".net","linq","nhibernate","orm","fluent-nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12802725,"title":"NHibernate LinqProvider / IQueryable: Is FirstOrDefault() supported inside a Where clause?","body":"<p>Given two classes that resemble</p>\n\n<pre><code>public class Blog\n{\n    public virtual int BlogId { get; set; }\n    public virtual IList&lt;Comment&gt; Comments { get; set; }\n}\n\npublic class Comment\n{\n    public virtual int CommentId { get; set; }\n    public virtual Blog Blog { get; set; }\n    public string Title { get; set; }\n}\n</code></pre>\n\n<p>I have a hard time using the following statement:</p>\n\n<pre><code>session.Query&lt;Blog&gt;.Where(b =&gt; b.Comments.FirstOrDefault().Title.Contains(\"my title\")));\n</code></pre>\n\n<p>The error thrown is:</p>\n\n<blockquote>\n  <p>Antlr.Runtime.NoViableAltException</p>\n</blockquote>\n\n<p>Using .Any() works:</p>\n\n<pre><code>session.Query&lt;Blog&gt;.Where(b =&gt; b.Comments.Any(c =&gt; c.Title.Contains(\"my title\")));\n</code></pre>\n\n<p>However, this is not what I want. In reality, this isn't about Blogs and Comments, but about versioned entities. In the mapping of their parent entity, I order their collection by their version number. I need to be able to access the first entry in order to get the latest version.</p>\n"},{"tags":["linq","c#-4.0","linq-to-sql","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":12804296,"title":"Get X records from complex LINQ query","body":"<p>How can I get 10 records from complex LINQ query?\nI tried to put <code>.Skip(X).Take(10)</code>, but it doesn't work, depending on where I'm trying to take 10 it returns the full set of objects or nothing.</p>\n\n<p>Setting <code>.Skip(X).Take(10)</code> at the end of the query doesn't what I'm looking for because of slow performance.</p>\n\n<p>This is my query:</p>\n\n<pre><code>List&lt;ReportReturn&gt; report =  \n    from var1 in context.Table1\n    join var2 in context.Table2\n        on var1.AccountID equals var2.AccountID\n    join var3 in context.Table3\n        on var1.AccountID equals var3.AccountID into all\n    where \n        var1.SubAccountID == intSubAccountID &amp;&amp; \n        // ...... and more conditions\n\n    let actual = var1.Total.GetValueOrDefault(0)\n    let Unique = var2.CountUnique \n    let Total = var2.Count\n\n    // ........ and more helper values\n\n    orderby var1.Date descending\n\n    from final in all.DefaultIfEmpty()\n    select new ReportReturn {\n        // ........................some property assigments\n    };\n</code></pre>\n"},{"tags":["c#","sql-server","visual-studio-2010","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":145,"score":3,"question_id":12818127,"title":"linq to entity sqlFunction.string convert return varchar and not nvarchar","body":"<p>I have to write linq to sql server between two tables,the related fields are in a different types. one is string(nvarchar)  and the other is int.</p>\n\n<p><strong>here is my linq:</strong></p>\n\n<pre><code>from je in a\njoin vP in b\non je.BaseRef  equals SqlFunctions.StringConvert((decimal) vP.DocEntry)\n</code></pre>\n\n<p><strong>the result of the linq in sql was:</strong></p>\n\n<pre><code>SELECT \n[Extent1].[Account] AS [Account]\nFROM  [dbo].[a] AS [Extent1]\nJOIN [dbo].[b] AS [Extent2] ON ([Extent1].[BaseRef] = (STR( CAST( [Extent2].[DocEntry] AS float)))) OR (([Extent1].[BaseRef] IS NULL) AND (STR( CAST( [Extent2].[DocEntry] AS float)) IS NULL))\n</code></pre>\n\n<p>that query return null because sql can not compare varchar and nvarchar.\nlinq to entity translate <code>sqlfunction.stringFormat</code> to <code>str('')</code> and not to <code>convert(nvarchar,'')</code>.\nhow can I convert to nvarchar?</p>\n"},{"tags":["c#","linq","datatable","duplicates"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":116,"score":2,"question_id":12821636,"title":"how to replace duplicates in datatable, C#","body":"<p>I have Datatable 1:-----------------------------should be like that:</p>\n\n<pre><code>ID   Name  Lastname             ID     Name   Lastname\n-------------------             -----------------------\n1  |  koki  ha                  1   |   koki     ha\n-------------------                 | ----------------- //merge Rows[0][0]          \n1  |  lola  mi                      |   lola     mi     //with Rows[1][0] if the same\n-------------------             -----------------------                      \n2  |  ka    xe                  2       ka      xe\n</code></pre>\n\n<p>how to replace \"1\" with \"\" or empty if is already exist? I spend for this for 2 hours but can't find the solution. I tried with linq but dont find the key to do it right, maybe distinct or group?</p>\n\n<pre><code>DataTable table = new DataTable(\"table\");\ntable.Columns.Add(\"ID\", typeof(Int32));\ntable.Columns.Add(\"Name\", typeof(String)); \ntable.Columns.Add(\"Lastname\", typeof(String));\n\nobject[] o1 = { 1, \"Kiki\", \"ha\"};\n        object[] o2 = { 1,\"lola\",\"mi\"};\n        object[] o4 = { 2, \"ka\", \"xe\" };\ntable.Rows.Add(o1);\n        table.Rows.Add(o2);\n        table.Rows.Add(o4);\ndataGridView2.DataSource = table;\n</code></pre>\n"},{"tags":["linq","query","streaminsight"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12819642,"title":"StreamInsight complex query with filter on HoppingWindow","body":"<p>I'm trying out StreamInsight and I came across a problem with a query I need.</p>\n\n<p>I'm trying to throw a warning if there are several changes in my measured values (of up to 20% change) in the last 30 minutes.</p>\n\n<p>This is the query I came up with for now but it isn't working and it's not even correct I think.</p>\n\n<p>Apparently I can't filter on a window...?</p>\n\n<pre><code>var deviationQuery = from s in wcfStream\n                     group s by s.SensorId into grouped\n                     from window in grouped.HoppingWindow(TimeSpan.FromMinutes(30),TimeSpan.FromMinutes(1))\n                     where window.StdDev(e =&gt; e.Value) &gt; measurableValue * 1.2\n                     select new OutputEvent\n                     {\n                         Error = \"Deviation\"\n                     };\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","linq","exception","sqlclient","wcf-service"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3343,"score":2,"question_id":6922879,"title":"Exception: type initializer for 'system.data.sqlclient.sqlconnection'?","body":"<p>I couldn't figure out what is the problem for this exception. </p>\n\n<pre><code>The type initializer for 'system.data.sqlclient.sqlconnection' threw an exception\n</code></pre>\n\n<p>First attempt: I was using the WCF Service to make some small application. It works just fine and I can use the LINQ properly. After 2 or 3 days. Maybe after I close Visual studio and load the project again. The exception appear.</p>\n\n<p>The 2nd attempt also the same. I create another project and it work just fine until I do something else (I do not change any code) </p>\n\n<p>SQL Server working fine and I can connect through SQL Management Studio without problem.</p>\n\n<p>A click at Debug error lead me to the connection string from linq file.</p>\n\n<p>What could be the problem? I tried to search but couldn't find the answer to resolve this.</p>\n\n<p>Thank you</p>\n"},{"tags":["c#","xml","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12830714,"title":"How to search entire XML file for keyword?","body":"<p>Im learning C# and one of the things I am trying to do is read in an XML file and search it. </p>\n\n<p>I have found a few examples where I can search specific nodes (if its a name or ISBN for example) for specific key words. </p>\n\n<p>What I was looking to do was to search the entire XML file in order to find all possible matches of a keyword. </p>\n\n<p>I know LIST allows a \"contains\" to find keywords, is there a similar function for searching an XML file?</p>\n\n<p>Im using the generic books.xml file that is included when visual studio is installed. </p>\n"},{"tags":["vb.net","linq","linq-to-sql","aggregate-functions","aggregate"],"answer_count":2,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":165,"score":11,"question_id":12264751,"title":"Is Aggregate fatally flawed because each into clause is executed separately?","body":"<p><em>Is VB.NET's <code>Aggregate</code> query fatally flawed when used as the first (outer) clause of a Linq expression with multiple <code>Into</code> clauses because each <code>Into</code> clause is executed separately?</em></p>\n\n<p>The \"obvious\" answer to <a href=\"http://stackoverflow.com/q/4672239/256431\"><code>SELECT MIN(ZoneMin), MAX(ZoneMin) FROM Plant</code> in LINQ to SQL</a> is</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim limits = Aggregate p In Plants Select p.ZoneMin Into Min(), Max()\n</code></pre>\n\n<p>However, this answer actually retrieves each of <code>Min</code> and <code>Max</code> (and if you include other aggregate functions like <code>Count</code> and <code>Average</code>) in <em>separate</em> SQL queries.  This can be easily seen in LINQPad.</p>\n\n<p>Is there a transaction (or something else making these queries atomic) not shown by LINQPad, or is this a race condition waiting to happen? (And so you have to do the tricks shown in the answer to the above question to force a single query that returns multiple aggregates.)</p>\n\n<p>In summary, is there a LINQ-to-SQL query using <code>Aggregate</code> that returns multiple aggregate functions in a single (or at least \"atomic\") query?</p>\n\n<p><sub>\n(I also say \"obvious\" because the obvious answer to me, <code>Aggregate p In Plants Into Min(p.ZoneMin), Max(p.ZoneMin)</code>, actually retrieves the whole table twice, even when optimised, and then uses the Linq-to-Entities <code>Min</code> and <code>Max</code> to obtain the result :-( )</sub></p>\n\n<p><sub>I thought <code>Aggregate</code> wasn't VB-specific, but it looks like C# does not have this query expression, so I've changed the <a href=\"/questions/tagged/.net\" class=\"post-tag\" title=\"show questions tagged '.net'\" rel=\"tag\">.net</a> to <a href=\"/questions/tagged/vb.net\" class=\"post-tag\" title=\"show questions tagged 'vb.net'\" rel=\"tag\">vb.net</a>.</sub></p>\n"},{"tags":["linq","entity-framework","dbset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12831122,"title":"Entity Framework dbset most efficient way of deleting","body":"<p>I have the following and looking for a more  efficient way of deleting vs looping through the records and then deleting each one at a time (note using Dbset):</p>\n\n<pre><code>     var wcd = dbContext.ProgramDetails.Where(p =&gt; p.Id == Id);\n\n     foreach (var wc in wcd.ToList())\n     {\n        dbContext.ProgramDetails.Remove(wc);\n     }\n\n     dbContext.SaveChanges();\n</code></pre>\n\n<p>Also say if we have 1 record that is as following:</p>\n\n<pre><code>    var pg = dbContext.Program.Where(p =&gt; p.Id == Id &amp;&amp; Name == FName);\n</code></pre>\n\n<p>What is the best way of deleting this one record? </p>\n\n<p>tried the following but gave an error: </p>\n\n<pre><code>    var pg = dbContext.Program.Where(p =&gt; p.Id == Id &amp;&amp; Name == FName);\n    dbContext.Program.Remove(wc);\n</code></pre>\n\n<p>Then I resorted to doing a foreach for deleting just one record as I have shown above that is not the most efficient for just 1 record.</p>\n"},{"tags":["c#","linq","linq-to-sql","azure","windows-azure-storage"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1427,"score":1,"question_id":1619029,"title":"Creating a dynamic LINQ statement without having an Entity Type Property","body":"<p>I'm trying to create a Linq statement that queries both columns that exist on my entity as properties and those that don't but exist as columns in the database for the entity.</p>\n\n<p>For example, I have a collection of Book entities. Each Book has an ID and Title property and a matching column in the database. But, lets say the table for Book also contains a column field for <strong>Author</strong> and my Book entity doesn't have this.</p>\n\n<p>A normal query involving the ID and the Title might look like this:</p>\n\n<pre><code>Books.Where(b=&gt;b.ID == 123 &amp;&amp; b.Title == \"Title\")\n</code></pre>\n\n<p>But, I want to also dynamically add the equivalent of \" <strong>AND Author = 'Name'</strong> \" to the above query as well. The Author property doesn't exist on the Book object.</p>\n\n<p>The extra fields and the values they should contain will actually be available in a Dictionary. So I will need to dynamically add multiple <strong>AND [FieldName] = '[Value]'</strong> conditions to the query.</p>\n\n<p>It might help explain why I would need this to know that I'm using Azure Table Storage and I have overridden the serialize that turns a Book entity into the XML stored in Azure.</p>\n\n<p><strong><em>Edit -</em></strong></p>\n\n<p>I've tried using the Dynamic Linq library but it does not work.</p>\n\n<pre><code>Books.Where(b=&gt;b.ID == 123 &amp;&amp; b.Title == \"Title\").Where(\"Author = @0\", \"SomeName\").ToList();\n</code></pre>\n\n<p>Throws:\nSystem.Linq.Dynamic.ParseException: No property or field 'Author' exists in type 'Book'.</p>\n\n<p>Also,</p>\n\n<p>I know using <strong>Books.AddQueryOption(\"$filter\",\"Author eq 'SomeName'\")</strong> works when used by itself. But I have no idea how to use AddQueryOption along with an existing Where statement.</p>\n"},{"tags":["c#","linq","string","contains"],"answer_count":16,"favorite_count":6,"up_vote_count":42,"down_vote_count":0,"view_count":117571,"score":42,"question_id":194930,"title":"How do I use LINQ Contains(string[]) instead of Contains(string)","body":"<p>I got one big question.</p>\n\n<p>I got a linq query to put it simply looks like this:</p>\n\n<pre><code>from xx in table\nwhere xx.uid.ToString().Contains(string[])\nselect xx\n</code></pre>\n\n<p>The values of the <code>string[]</code> array would be numbers like (1,45,20,10,etc...)</p>\n\n<p>the Default for <code>.Contains</code> is <code>.Contains(string)</code>.</p>\n\n<p>I need it to do this instead:  <code>.Contains(string[])</code>...</p>\n\n<p><strong>EDIT :</strong> One user suggested writing an extension class for <code>string[]</code>.  I would like to learn how, but any one willing to point me in the right direction?</p>\n\n<p><strong>EDIT :</strong> The uid would also be a number. That's why it is converted to a string.</p>\n\n<p>Help anyone?</p>\n"},{"tags":["xml","vb.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12716844,"title":"LINQ to XML Axis properties returning an attribute when selecting an element using a different attribute","body":"<p>Code block four (below) is giving me an error that I am at a loss with regard to fixing...</p>\n\n<p>Here's the XML Schema that I'm using:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?&gt;\n\n&lt;!DOCTYPE ctqcfg SYSTEM \"cache.dtd\"&gt;\n\n&lt;cache version=\"1.0\"&gt;\n    &lt;configuration name=\"Test\"&gt;\n        &lt;cacheControl&gt;\n            &lt;cache name=\"Customer\" mode=\"off\"/&gt;\n            &lt;cache name=\"Vendor\" mode=\"off\"/&gt;\n            &lt;cache name=\"Agency\" mode=\"off\"/&gt;\n            &lt;cache name=\"Partner\" mode=\"off\"/&gt;\n        &lt;/cacheControl&gt;\n    &lt;/configuration&gt;\n\n    &lt;configuration name=\"Production\"&gt;\n        &lt;cacheControl&gt;\n            &lt;cache name=\"Customer\" mode=\"preload\"/&gt;\n            &lt;cache name=\"Vendor\" mode=\"dynamic\"/&gt;\n            &lt;cache name=\"Agency\" mode=\"dynamic\"/&gt;\n            &lt;cache name=\"Partner\" mode=\"dynamic\"/&gt;\n        &lt;/cacheControl&gt;\n    &lt;/configuration&gt;\n&lt;/cache&gt;\n</code></pre>\n\n<p>The XML file is loaded </p>\n\n<pre><code>Private XElement As XElement = Nothing\n\nPublic Sub Load()\n    XElement = XElement.Load(ConfigurationResource)\nEnd Sub\n</code></pre>\n\n<p>When the user selects a configuration to edit, a reference to the root of the selected configuration element is held</p>\n\n<pre><code>Private ConfigurationRoot As System.Collections.Generic.IEnumerable(Of System.Xml.Linq.XElement)\n\nPrivate ConfigurationName_ As String\n\nPublic Property ConfigurationName() As String\n    Get\n        Return ConfigurationName_\n    End Get\n    Set(ByVal Value As String)\n        ConfigurationName_ = Value\n        ConfigurationRoot = From Configuration In XElement.&lt;configuration&gt; Where Configuration.@name = Value\n    End Set\nEnd Property\n</code></pre>\n\n<p>Trying to retrieve the cache mode that corresponds to the cache name (in this case Customer)</p>\n\n<pre><code>Public Property CustomerCache() As String\n    Get\n        Try\n            Return From Cache In ConfigurationRoot.&lt;cacheControl&gt;.&lt;cache&gt; Where Cache.@name = \"Customer\" Select Cache.@mode\n        Catch Exception As Exception\n            Return Nothing\n        End Try\n    End Get\n    Set(ByVal Value As String)\n        'ToDo\n    End Set\nEnd Property\n</code></pre>\n\n<p>I'm getting the following error</p>\n\n<pre><code>System.InvalidCastException was caught\nMessage=Unable to cast object of type 'WhereSelectEnumerableIterator`2[System.Xml.Linq.XElement,System.String]' to type 'System.String'.\n</code></pre>\n\n<p>This is my first day working with LINQ and I seem to have a basic misunderstanding regarding how to access the attribute - it seems that the query is returning a collection and I know that there is only ever one possible value that can be found...</p>\n"},{"tags":["c#","linq","report"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1302,"score":0,"question_id":4949205,"title":"How do i use linq as datasource for a Microsoft report","body":"<pre><code>var exams = (from appointment in appointments select new {coursecode = (appointment.Tag as exam).ID}).ToList();\n\nrpt.LocalReport.DataSources.Add(new ReportDataSource(\"dsExam\". exams.AsEnumerable()));\nrpt.ProcessingMode = ProcessingMode.Local;\nrpt.RefreshReport();\n</code></pre>\n\n<p>Each appointment object contains an exam object.\nI would like to use the results of the linq query as the datasource of my report. However only the first row in IEnumerable exams is shown in the report even though it contains 81 rows. How can i fix this. </p>\n"},{"tags":["asp.net","linq","execution","deferred"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12827265,"title":"Linq deferred execution in asp.net","body":"<p>My dbml contains a master table \"M\" and a detail table \"D1\". </p>\n\n<p>My aspx page consists of a TextBox to show M data and a grid to populate with D1 data. I want the grid to populate when a button is clicked to save loading time (D1 contains a lot of rows). </p>\n\n<p>Question 1: Is the following code the correct way to do it?</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n{\n    MyDataContext context = new MyDataContext();\n    M m = context.Ms.Single(n =&gt; n.id == id);    // id is somehow provided\n\n    TextBox1.Text = m.field1;\n}\n\nprotected void Button1_Click(object sender, EventArgs e)\n{\n    MyDataContext context = new MyDataContext();\n    M m = context.Ms.Single(n =&gt; n.id == id);   // id is somehow provided\n\n    Grid1.DataSource = m.D1s;\n    Grid1.DataBind();\n}\n</code></pre>\n\n<p>Question 2: Since I can access m.D1s in Page_Load does this mean the detail data is already fetched from the database anyway or does deferred execution apply? </p>\n"},{"tags":["c#","ajax","linq","mvc","dynamic"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3379,"score":3,"question_id":1389850,"title":"System.Linq.Dynamic and DateTime","body":"<p>I am using System.Linq.Dynamic to do custom where clauses from an ajax call in .Net MVC 1.0.</p>\n\n<p>It works fine for strings, int etc but not for DateTime, I get the exception cannot compare String to DateTime.  The very simple test code is</p>\n\n<p>items = items.Where(string.Format(@\" {0} > {1}{2}{1} \", searchField, delimiter, searchString));</p>\n\n<p>Where searchField will be for example start_date and the data type is DateTime, delimiter is \" (tried with nothing as well) and searchString will be 01-Jan-2009 (tried with 01/01/2009 as well) and items is an IQueryable from LinqToSql.</p>\n\n<p>Is there a way of specifying the data type in a dynamic where, or is there a better approach.  It is currently already using some reflection to work out what type of delimiter is required.</p>\n"},{"tags":["sql","sql-server","linq"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":103,"score":3,"question_id":12821310,"title":"Better Linq GroupBy","body":"<p>We are working on an advertising platform and writing the one big query thats responsible for serving ads, there is a few criteria to serve an ad to consumer, one of thos criteria is the Campaign Daily Budget, so what we are doing is we are grouping by Individual Ads to get the impressions and the consumed cost and then we group by Campaign, resulting in the following query:</p>\n\n<pre><code>  (from a in AdCreative\n       join h in AdHit on a.ID equals h.AdID into gh\n       join l in AdGroup_Location on a.AdGroupID equals l.AdGroupID into gj\n       from subloc in gj.DefaultIfEmpty()\n       from subhits in gh.DefaultIfEmpty()\n       where a.AdDimensionID == 7 &amp;&amp; \n             (subloc == null || subloc.LocationID == 23)\n       select new {\n           ID = a.ID,\n           Name = a.Name,\n           Spent = (subhits.AdDimension != null) ? ((double)subhits.AdDimension.Credit / 1000 ) : 0,\n           CampaignID = a.AdGroup.Campaign.ID,\n           CampaignName = a.AdGroup.Campaign.Name,\n           CampaignBudget = a.AdGroup.Campaign.DailyBudget\n\n       })\n    .GroupBy(adgroup =&gt; adgroup.ID)\n    .Select(adgroup =&gt; new {\n        ID = adgroup.Key,\n        Name = adgroup.FirstOrDefault().Name,\n        Spent = adgroup.Sum(q =&gt;  q.Spent),\n        CampaignID = adgroup.FirstOrDefault().CampaignID,\n        CampaignName = adgroup.FirstOrDefault().CampaignName,\n        CampaignBudget = adgroup.FirstOrDefault().CampaignBudget,\n    })\n    .GroupBy(q =&gt; q.CampaignID)\n    .Select(campaigngroup =&gt; new {\n      CampaignID = campaigngroup.Key,\n      DailyBudget = campaigngroup.FirstOrDefault().CampaignBudget,\n      Spent = campaigngroup.Sum(q =&gt; q.Spent),\n      Ads = campaigngroup.GroupBy(q =&gt; q.ID).Select(adgroup =&gt; new {\n        ID = adgroup.Key,\n        Name  = adgroup.FirstOrDefault().Name,\n        Spent = adgroup.FirstOrDefault().Spent\n    })\n    })\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/Wjxav.png\" alt=\"Results\"></p>\n\n<p>It works fine as you see in the results in the screenshots, however when I inspected the generate SQL query I got <a href=\"https://gist.github.com/3865826\" rel=\"nofollow\"><strong><em>402</em></strong> lines of SQL code</a>. How could that be? is there something I could do to enhance the code </p>\n"},{"tags":["linq","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12827287,"title":"Entity Framework 4 DeleteObject not showing","body":"<p>I have the following linq:</p>\n\n<pre><code>     var wcd = dbContext.Programs.Where(p =&gt; p.Id == Id).ToList();\n     dbContext.DeleteObject(wcd); \n     SaveChanges();\n</code></pre>\n\n<p>I get a message saying that I do not have a definition for DeleteObject in my Model.\nI can though do SaveChanges(),etc.</p>\n\n<p>I tried the following:</p>\n\n<pre><code>        var wcd = dbContext.Programs.Where(p =&gt; p.Id == Id).ToList();\n        dbContext.Programs.Remove(wcd);   \n</code></pre>\n\n<p>but I get the following\n  The best overloaded method match for 'System.Data.Entity.DbSet\n .Remove  has some invalid arguments     </p>\n"},{"tags":["c#","mysql","linq","entity-framework-4.1","eager-loading"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":351,"score":4,"question_id":11676513,"title":"How can I use Entity Framework on an object graph past a depth of 2?","body":"<p><strong>Situation</strong></p>\n\n<p>When using an <code>.Include</code> chain inside of my repository, I noticed that I was getting strange results - mostly that the values queried that were being returned were from the wrong fields (name would end up in description for example - but in the database all the values are correct, they only show up wrong after the query). I changed the names so the relationships are more obvious, but the structure is the same. I keep getting the wrong values for the associated CrewMember and their relative Rank and Clearance. It seems if there is a field name which is the same in CrewMember as Rank, then the value of that field in Rank becomes what the value was in CrewMember. For example, if Rank had a description, and so did CrewMember, then the description of Rank for the CrewMember would be the CrewMember's description.</p>\n\n<p>Entity Framework fails to make well formed queries past a depth of 2 when there are similar fields defined.</p>\n\n<p><strong>Definitions</strong></p>\n\n<p>This is a class definition which models a database table. I am using C# ASP.NET MVC 3 with the Entity Framework 4.1.</p>\n\n<pre><code>public class Harbor\n{\n public int HarborId { get; set; }\n public virtual ICollection&lt;Ship&gt; Ships { get; set; }\n public string Description { get; set; }\n}\n\npublic class Ship\n{\n public int ShipId { get; set; }\n public int HarborId { get; set; }\n public virtual Harbor Harbor { get; set; }\n public virtual ICollection&lt;CrewMember&gt; CrewMembers { get; set; }\n public string Description { get; set; }\n} \n\npublic class CrewMember\n{\n public int CrewMemberId { get; set; }\n public int ShipId { get; set; }\n public virtual Ship Ship { get; set; }\n public int RankId { get; set; }\n public virtual Rank Rank { get; set; }\n public int ClearanceId { get; set; }\n public virtual Clearance Clearance { get; set; }\n public string Description { get; set; }\n}\n\npublic class Rank\n{\n public int RankId { get; set; }\n public virtual ICollection&lt;CrewMember&gt; CrewMembers { get; set; }\n public string Description { get; set; }\n}\n\npublic class Clearance\n{\n public int ClearanceId { get; set; }\n public virtual ICollection&lt;CrewMember&gt; CrewMembers { get; set; }\n public string Description { get; set; }\n}\n</code></pre>\n\n<p><strong>Query</strong></p>\n\n<p>This is the code which queries the database and has the query and .Include calls.</p>\n\n<pre><code>DbSet&lt;Harbor&gt; dbSet = context.Set&lt;Harbor&gt;();\nIQueryable&lt;Harbor&gt; query = dbSet;\nquery = query.Include(entity =&gt; entity.Ships);\nquery = query.Include(entity =&gt; entity.Ships.Select(s =&gt; s.CrewMembers));\nquery = query.Include(entity =&gt; entity.Ships.Select(s =&gt; s.CrewMembers.Select(cm =&gt; cm.Rank)));\nquery = query.Include(entity =&gt; entity.Ships.Select(s =&gt; s.CrewMembers.Select(cm =&gt; cm.Clearance)));\n</code></pre>\n\n<p>Are these <code>.Include</code> calls well formed? Did I miss something?</p>\n\n<p>This is rather complex, so if you have any questions please let me know in comments and I will try to clarify anything I may have left out.</p>\n\n<p><strong>How can I use Entity Framework to get a well formed query on an object graph past a depth of 2?</strong></p>\n\n<p><strong>Edits</strong></p>\n\n<p>Here is the generated query:</p>\n\n<pre><code>{SELECT\n[Project1].[HarborId], \n[Project1].[Description], \n[Project1].[C2] AS [C1], \n[Project1].[ShipId], \n[Project1].[HarborId1], \n[Project1].[Description1], \n[Project1].[C1] AS [C2], \n[Project1].[CrewMemberId], \n[Project1].[ShipId1], \n[Project1].[ClearanceId], \n[Project1].[RankId], \n[Project1].[Description2], \n[Project1].[RankId1], \n[Project1].[Description3], \n[Project1].[ClearanceId1], \n[Project1].[Description4], \nFROM (SELECT\n[Extent1].[HarborId], \n[Extent1].[Description], \n[Join3].[ShipId], \n[Join3].[HarborId] AS [HarborId1], \n[Join3].[Description]AS [Description1], \n[Join3].[CrewMemberId], \n[Join3].[ShipId]AS [ShipId1], \n[Join3].[ClearanceId], \n[Join3].[RankId], \n[Join3].[Description] AS [Description2], \n[Join3].[RankId] AS [RankId1], \n[Join3].[Description] AS [Description3], \n[Join3].[ClearanceId] AS [ClearanceId1], \n[Join3].[Description] AS [Description4], \nCASE WHEN ([Join3].[ShipId] IS  NULL) THEN (NULL)  WHEN ([Join3].[CrewMemberId] IS  NULL) THEN (NULL)  ELSE (1) END AS [C1], \nCASE WHEN ([Join3].[ShipId] IS  NULL) THEN (NULL)  ELSE (1) END AS [C2]\nFROM [Harbor] AS [Extent1] LEFT OUTER JOIN (SELECT\n[Extent2].[ShipId], \n[Extent2].[HarborId], \n[Extent2].[Description], \n[Join2].[CrewMemberId], \n[Join2].[ShipId] AS [ShipID1], \n[Join2].[ClearanceId], \n[Join2].[RankId], \n[Join2].[Description] AS [DESCRIPTION1], \n[Join2].[RankID1], \n[Join2].[DESCRIPTION1] AS [DESCRIPTION11], \n[Join2].[ClearanceID1], \n[Join2].[DESCRIPTION2], \nFROM [Ship] AS [Extent2] LEFT OUTER JOIN (SELECT\n[Extent3].[CrewMemberId], \n[Extent3].[ShipId], \n[Extent3].[ClearanceId], \n[Extent3].[RankId], \n[Extent3].[Description], \n[Extent4].[RankId] AS [RankID1], \n[Extent4].[Description] AS [DESCRIPTION1], \n[Extent5].[ClearanceId] AS [ClearanceID1], \n[Extent5].[Description] AS [DESCRIPTION2], \nFROM [CrewMember] AS [Extent3] INNER JOIN [Rank] AS [Extent4] ON [Extent3].[RankId] = [Extent4].[RankId] LEFT OUTER JOIN [Clearance] AS [Extent5] ON [Extent3].[ClearanceId] = [Extent5].[ClearanceId]) AS [Join2] ON [Extent2].[ShipId] = [Join2].[ShipId]) AS [Join3] ON [Extent1].[HarborId] = [Join3].[HarborId]\n WHERE [Extent1].[HarborId] = @p__linq__0) AS [Project1]\n ORDER BY \n[Project1].[HarborId] ASC, \n[Project1].[C2] ASC, \n[Project1].[ShipId] ASC, \n[Project1].[C1] ASC}\n</code></pre>\n\n<p><strong>Clarification</strong></p>\n\n<p>Using include on 1-1 relationships poses no problem when \"drilling down\" in this fashion it seems. However, the issue seems to arise when there are 1-many relations as part of the drilling. The drilling is necessary in order to eager load.</p>\n\n<p>The first projection, <code>entity =&gt; entity.Ships.Select(s =&gt; s.CrewMembers</code>, will return a list of CrewMembers which are related to each ship. This properly returns the graph where a harbor contains a list of ships, each with a list of crew members.</p>\n\n<p>However, the second projection <code>CrewMembers.Select(cm =&gt; cm.Rank</code>, does not in fact return the proper piece of the graph. Fields begin to be mixed, and any fields sharing the same name will default for whatever reason to the parent field. This results in inconsistent results and more importantly bad data. The fact that no errors are thrown makes it worse, as this can only be determined through runtime inspection.</p>\n\n<p>If there were a way to somehow get a strongly typed single response (as opposed to a list) from the first projection, perhaps the second would not be necessary. As it is now, I believe that the issue lies in the first projection returning a list. When the second projection attempts to project based on that list instead of from a single object, the logical error is introduced.</p>\n\n<p>If, instead of CrewMembers being an ICollection, it was only one CrewMember, then this nested projection will in fact return the correct data. However, that is a simplified version of this problem and unfortunately it is what almost all testing seems to have been done on from the various blogs, tutorials, posts, articles, and documents which I reviewed trying to solve this issue.</p>\n"},{"tags":["c#","sql","linq","query","list"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12826886,"title":"c# linq not equals variation","body":"<p>I have a linq query w/ entity frameworks that works and gets the needed information, but now i am having trouble doing the opposite. </p>\n\n<p>Currently it gets all the data that is needed using the joins to link tables but i need to to get some data that is not match some of the joins.</p>\n\n<p>I know you can only use \"equals\" om linq, but i need info that is not equals\ni.e. join ec in c.IsoNe on ap.idLook not equals ec.idAll</p>\n\n<p>Below is the working code, but not how i need it now. any help would be appreciated...</p>\n\n<pre><code>var test = (from bil in bilats\n                join ap in c.Allegro on bil.idAll equals ap.idAll\n                join ec in c.IsoNe on ap.idLook equals ec.idAll\n                join cb in c.Comp on ap.idCompBuy equals cb.idComp\n                join cs in c.Com on ap.idCompSell equals cs.idComp\n                join iby in c.IsoNe on cb.idComp equals iby.idComp\n                join iss in c.IsoNe on cs.idComp equals isl.idComp\n             orderby bil.HBegin ascending\n             where bil.HBegin &gt;= ec.DateTStart\n             where bil.HBegin &lt; ec.DateTEnd\n             select new\n             {\n                 Cont = ec.ContractID,\n                 ContType = ap.idScheduleType,\n                 Sel = isel.ISONE1,\n                 Buy = ibel.ISONE,\n                 HBegin = bil.HBegin,\n              }).ToList();\n</code></pre>\n"},{"tags":["c#","vb.net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":130,"score":0,"question_id":12822483,"title":"Translate C# Linq to VB","body":"<p>I could use some help converting this C# line of code to VB. I am very new to Linq and am having trouble with the syntax...</p>\n\n<pre><code>var rows = GridView1.Rows.Cast&lt;GridViewRow&gt;().Where(a =&gt; a != row).ToList();\n</code></pre>\n\n<p>I have tried a number of online conversion tools and none of them have gotten it right either.</p>\n\n<p>UPDATE:\nHere is the full code block....</p>\n\n<pre><code>protected void MoveGridViewRows(object sender, EventArgs e)  {      \n    Button btnUp = (Button)sender;      \n    GridViewRow row = (GridViewRow)btnUp.NamingContainer;      \n    // Get all items except the one selected      \n    var rows = GridView1.Rows.Cast&lt;GridViewRow&gt;().Where(a =&gt; a != row).ToList();      \n    switch (btnUp.CommandName)      \n    {          \n         case \"Up\":              \n         //If First Item, insert at end (rotating positions)              \n              if (row.RowIndex.Equals(0))\n                  rows.Add(row);              \n              else                 \n                  rows.Insert(row.RowIndex - 1, row);              \n                  break;          \n         case \"Down\":              \n         //If Last Item, insert at beginning (rotating positions)              \n              if (row.RowIndex.Equals(GridView1.Rows.Count - 1))                  \n                  rows.Insert(0, row);              \n              else                 \n                  rows.Insert(row.RowIndex + 1, row);              \n                  break;      \n         }      \n         GridView1.DataSource = rows.Select(a =&gt; new     \n         {          \n              FirstName = ((TextBox)a.FindControl(\"txtFirstName\")).Text,          \n              LastName = ((TextBox)a.FindControl(\"txtLastName\")).Text,      \n         }).ToList();      \n         GridView1.DataBind();  \n} \n</code></pre>\n\n<p>The specific error in VS on compile is....</p>\n\n<p>Error   11  Overload resolution failed because no accessible 'Where' can be called with these arguments:\n    Extension method 'Public Function Where(predicate As System.Func(Of System.Web.UI.WebControls.GridViewRow, Integer, Boolean)) As System.Collections.Generic.IEnumerable(Of System.Web.UI.WebControls.GridViewRow)' defined in 'System.Linq.Enumerable': Nested function does not have the same signature as delegate 'System.Func(Of System.Web.UI.WebControls.GridViewRow, Integer, Boolean)'.\n    Extension method 'Public Function Where(predicate As System.Func(Of System.Web.UI.WebControls.GridViewRow, Boolean)) As System.Collections.Generic.IEnumerable(Of System.Web.UI.WebControls.GridViewRow)' defined in 'System.Linq.Enumerable': Operator '&lt;>' is not defined for types 'System.Web.UI.WebControls.GridViewRow' and 'System.Web.UI.WebControls.GridViewRow'.  </p>\n\n<p>Also...</p>\n\n<p>Error   12  Name 'a' is not declared.   C:\\Users\\Documents\\Visual Studio 2008\\WebSites\\vv_home\\roeMgr.aspx.vb  51  46  C:\\</p>\n\n<p>HERE is the VB code thus far.....</p>\n\n<pre><code>    Protected Sub MoveGridViewRows(ByVal sender As Object, ByVal e As EventArgs)\n\n\n    Dim btnUp As Button = DirectCast(sender, Button)\n    Dim row As GridViewRow = DirectCast(btnUp.NamingContainer, GridViewRow)\n    ' Get all items except the one selected      \n    Dim rows = GridView1.Rows.Cast(Of GridViewRow)().Where(Function(a) a IsNot row).ToList()\n\n\n    Select Case btnUp.CommandName\n        Case \"Up\"\n            'If First Item, insert at end (rotating positions)              \n            If row.RowIndex.Equals(0) Then\n                rows.Add(row)\n            Else\n                rows.Insert(row.RowIndex - 1, row)\n            End If\n            Exit Select\n        Case \"Down\"\n            'If Last Item, insert at beginning (rotating positions)              \n            If row.RowIndex.Equals(GridView1.Rows.Count - 1) Then\n                rows.Insert(0, row)\n            Else\n                rows.Insert(row.RowIndex + 1, row)\n            End If\n            Exit Select\n    End Select\n    GridView1.DataSource = rows.[Select](a &gt;= New With { _\n     .FirstName = DirectCast(a.FindControl(\"txtFirstName\"), TextBox).Text, _\n     .LastName = DirectCast(a.FindControl(\"txtLastName\"), TextBox).Text _\n    }).ToList()\n    GridView1.DataBind()\n\n\nEnd Sub\n</code></pre>\n\n<p>thanks,</p>\n"},{"tags":["c#","sql","performance","linq","query-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12826725,"title":"Query optimization challenge - Is it possible to tweak this linq query","body":"<p>I am in to a perf excercise and I am wondering if there is any chance to improve this, just by the way I query for this info rather than attempting to do any DB schema or data changes.</p>\n\n<p>The below <strong>query takes around 200 ms to execute</strong>. I know I am ambitious but the challenge is is there a way to bring down. I am ready to employ ADO.NET or use a SP or use sql query but cannot do any data change. Also, <strong>the EmpTable has around 20 million rows</strong>.\nIt selects 1 record matching the paramid.</p>\n\n<p>Any one think this is still possible to optimize further ?</p>\n\n<pre><code>Log.Time()\n            using (MyDataContext db = MyDataContext.GetContext())\n            {\n                db.ObjectTrackingEnabled = false;\n                var _Query = from t in db.EmpTable\n                             where t.id == paramId\n                             select t;\n\n                 if (!_Query.Any())\n                    return null;\n            }\n            Log.Time()  -- 200 ms approx\n</code></pre>\n"},{"tags":["c#",".net","linq","parsing","expression-trees"],"answer_count":5,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":7538,"score":3,"question_id":714799,"title":"Is there an easy way to parse a (lambda expression) string into an Action delegate?","body":"<p>I have a method that alters an \"Account\" object based on the action delegate passed into it:</p>\n\n<pre><code>public static void AlterAccount(string AccountID, Action&lt;Account&gt; AccountAction) {\n  Account someAccount = accountRepository.GetAccount(AccountID);\n  AccountAction.Invoke(someAccount);\n  someAccount.Save();\n}\n</code></pre>\n\n<p>This works as intended...</p>\n\n<pre><code>AlterAccount(\"Account1234\", a =&gt; a.Enabled = false);\n</code></pre>\n\n<p>...but now what I'd like to try and do is have a method like this:</p>\n\n<pre><code>public static void AlterAccount(string AccountID, string AccountActionText) {\n  Account someAccount = accountRepository.GetAccount(AccountID);\n  Action&lt;Account&gt; AccountAction = MagicLibrary.ConvertMagically&lt;Action&lt;Account&gt;&gt;(AccountActionText);\n  AccountAction.Invoke(someAccount);\n  someAccount.Save();\n}\n</code></pre>\n\n<p>It can then be used like:</p>\n\n<pre><code>AlterAccount(\"Account1234\", \"a =&gt; a.Enabled = false\");\n</code></pre>\n\n<p>to disable account \"Account1234\".</p>\n\n<p>I've had a look at the <a href=\"http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx\" rel=\"nofollow\">linq dynamic query library</a>, which seems to do more or less what I want but for Func type delegates, and my knowledge of Expression trees etc isn't quite good enough to work out how to achieve what I want.  </p>\n\n<p>Is there an easy way to do what I want, or do I need to learn expressions properly and write a load of code?</p>\n\n<p>(The reason I want to do this is to allow an easy way of bulk updating account objects from a powershell script where the user can specify a lambda expression to perform the changes.)</p>\n"},{"tags":["vb.net","linq","gridview"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":127,"score":1,"question_id":12826668,"title":"Iterating through gridview with LINQ to create datasource","body":"<p>I have been working on a sample snippet of code to allow moving a row up or down in a gridview. My problem is I do not fully understand the LINQ being used to rebind the datasource to the gridview, new to LINQ.</p>\n\n<p>I was able to re-write the LINQ that actually queries the DataContext for the initial binding.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load\n\n    Dim db As New DataClassesDataContext\n\n    Dim shipment = From tblShipments In db.tblShipments Where tblShipments.driverKeyID = 5 Select tblShipments\n\n    If Not IsPostBack Then\n        GridView1.DataSource = shipment\n        GridView1.DataBind()\n    End If\nEnd Sub\n</code></pre>\n\n<p>This is the Sub that moves the row:</p>\n\n<pre><code>Protected Sub MoveGridViewRows(ByVal sender As Object, ByVal e As EventArgs)\n    Dim btnUp As Button = DirectCast(sender, Button)\n    Dim row As GridViewRow = DirectCast(btnUp.NamingContainer, GridViewRow)\n    ' Get all items except the one selected      \n\n    Dim rows = GridView1.Rows.Cast(Of GridViewRow)().Where(Function(a) a IsNot row).ToList()\n\n    Select Case btnUp.CommandName\n        Case \"Up\"\n            'If First Item, insert at end (rotating positions)              \n            If row.RowIndex.Equals(0) Then\n                rows.Add(row)\n            Else\n                rows.Insert(row.RowIndex - 1, row)\n            End If\n            Exit Select\n        Case \"Down\"\n            'If Last Item, insert at beginning (rotating positions)              \n            If row.RowIndex.Equals(GridView1.Rows.Count - 1) Then\n                rows.Insert(0, row)\n            Else\n                rows.Insert(row.RowIndex + 1, row)\n            End If\n            Exit Select\n    End Select\n    GridView1.DataSource = rows.[Select](Function(a) New With { _\n     .FirstName = DirectCast(a.FindControl(\"txtFirstName\"), TextBox).Text, _\n     .LastName = DirectCast(a.FindControl(\"txtLastName\"), TextBox).Text _\n    }).ToList()\n\n    GridView1.DataBind()\nEnd Sub\n</code></pre>\n\n<p>My issue is on this line of code, which is from the original sample:</p>\n\n<pre><code>GridView1.DataSource = rows.[Select](Function(a) New With { \n     .FirstName = DirectCast(a.FindControl(\"txtFirstName\"), TextBox).Text, \n     .LastName = DirectCast(a.FindControl(\"txtLastName\"), TextBox).Text \n    }).ToList()\n</code></pre>\n\n<p>I have many columns in my Gridview and they may change, is there some way to iterate through them to rebuild the datasource? I'd like to not have to literaly code each field.</p>\n\n<p>Thank you,</p>\n"},{"tags":["c#",".net","linq","entity-framework","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12825195,"title":"EF LINQ many to one filter/where","body":"<p>I'm getting an exception when the <code>GetProducts()</code> method is called below.  I'm essentially trying to filter down my list of Products by what is available in the specified Country.  There is a one to many relationship setup between a Product and a Country.</p>\n\n<pre><code>    public static List&lt;Product&gt; GetProducts(Country country)\n    {\n        Context db = new Context();\n        return db.Products.Where(m =&gt; m.Countries.Contains(country)).ToList&lt;Product&gt;();\n    }\n</code></pre>\n\n<blockquote>\n  <p>Unable to create a constant value of type\n  'DataModels.Country'. Only primitive types or\n  enumeration types are supported in this context.</p>\n</blockquote>\n\n<p>If I'm not going about this the right way, what is the best way to filter Products by the single selected Country?</p>\n"},{"tags":["c#","linq","entity-framework","lambda","linq-to-entities"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":109,"score":1,"question_id":12822446,"title":"Breaking LINQ to Entities into multiple parts","body":"<p>I had the following code</p>\n\n<pre><code>query = query.Where(device =&gt; GetDeviceDistanceFromGeocode(geocode, device) &lt;= distanceMetres);\n\nprivate static double GetDeviceDistanceFromGeocode(Geocode geocode, Device device)\n{\n    return Math.Pow(\n        Math.Pow(device.Address.Geocode.Easting - geocode.Easting, 2) +\n        Math.Pow(device.Address.Geocode.Northing - geocode.Northing, 2)\n        , 0.5);\n}\n</code></pre>\n\n<p>However it throws an exception because linq cannot recognise my function forcing me into doing the whole query expression in one go.</p>\n\n<pre><code>Exception[LINQ to Entities does not recognize the method \n'Double DistanceOfDeviceFromGeocode(Geocode, Device)' method, \nand this method cannot be translated into a store expression.] \n</code></pre>\n\n<p>Is it possible to break a query expression out into multiple parts like i'm trying to do here?  It's not very readable when the query is so big.</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>Here's the full query as asked for in the comments.</p>\n\n<pre><code>return query.Where(device =&gt; \n            Math.Pow(\n                Math.Pow(device.Address.Geocode.Easting - geocode.Easting, 2) + \n                Math.Pow(device.Address.Geocode.Northing - geocode.Northing, 2)\n                , 0.5) \n                &lt;= distanceMetres);\n</code></pre>\n\n<p>Basically I don't think this is very readable so would like to break it down into multiple parts but from the links supplied it doesn't seem possible.</p>\n\n<p>In c++ I could have broken some of it out into a macro but unfortunately this isn't a feature of c#.</p>\n\n<hr>\n\n<p>Following suggestions I've updated the code to this which works quite nicely and improves the readability of the code a lot!</p>\n\n<pre><code>    return query.Where( DevicesWithinDistanceFromGeocode(distanceMetres, geocode) );\n}\n\npublic Expression&lt;Func&lt;Device, bool&gt;&gt; DevicesWithinDistanceFromGeocode(double distance, Geocode geocode)\n{\n    return device =&gt; (  SqlFunctions.SquareRoot(\n                            SqlFunctions.Square((double)(device.Address.Geocode.Easting - geocode.Easting)) +\n                            SqlFunctions.Square((double)(device.Address.Geocode.Northing - geocode.Northing))\n                        ) &lt;= distance );\n}\n</code></pre>\n"},{"tags":["c#","linq","mocking"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12822013,"title":"How to mock a 3rd party web service LINQ data provider?","body":"<p>What is involved in mocking a LINQ web service data provider, which is made by a 3rd party, and is effectively a black box to me? Here is typical usage of that black box: (modified to protect the innocent, aka an NDA) </p>\n\n<pre><code>var conn = new RemoteServer (username,password);\nvar result = from row in conn.GetSomeData()\n    where row.this == \"Hello\" &amp;&amp; row.that != \"World\"\n    select new { row.this, row.that, row.theOther };\n</code></pre>\n\n<p>I so far know <code>result</code> is <code>IEnumerable&lt;T&gt;</code>.\nAnother usage example:</p>\n\n<pre><code>string something=\"xxx\";\nvar result = from row in conn.SubscribeAsync()\n    where row.this == something\n    select new MyObject(something) { row.that, row.theOther };\n</code></pre>\n\n<p>(This will keep pushing data, perhaps a few items each second, and I'll be wanting to mock carefully timed sequences.)</p>\n\n<p>I suppose my real question is, will it be as simple as:</p>\n\n<pre><code> class MockRemoteServer\n {\n     IEnumerable GetSomeData()\n     {\n          return new[]\n          {\n              new {this=\"1\",that=\"2\",theOther=\"special\"},\n              new {this=\"hello\",that=\"world\",theOther=\"something\"}\n          }\n     }\n }\n</code></pre>\n\n<p>Or do I need to implement a full-on LINQ data provider myself?\nIf so, any book or article recommendations on this? (My LINQ knowledge is currently based on a cover-to-cover read of Jon Skeet's C# In Depth, and not much else...)</p>\n"},{"tags":["asp.net","linq","list"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12822222,"title":"OrderBy specific elements in List","body":"<p>My scenario is: I have a class called <code>MenuBO</code> using linq, it has a function called <code>SelectAll()</code> that returns a list of the object <code>menu</code> to use as a <code>DataSource</code> for a <code>DropDownList</code>. Before returning it I need to insert in the list a new item to serve as a default value for the <code>DropDownList</code></p>\n\n<p>Here's what I tried so far:</p>\n\n<pre><code>public List&lt;menu&gt; SelectAll()\n{\n    using (var db = new SeloQual_AdminEntities(conn))\n    {\n        menu vmenu = new menu();\n        vmenu.cod_menu = 0;\n        vmenu.cod_menu_pai = null;\n        vmenu.des_menu = \"Select...\";\n        var query = from p in db.menu orderby p.des_menu select p;\n        var test = query.ToList();\n        test.Add(vmenu);\n        return test.OrderBy(x =&gt; x.cod_menu).ToList();\n    }\n}\n</code></pre>\n\n<p>The <code>OrderBy(x =&gt; x.cod_menu)</code> does it job, the <code>vmenu</code> item appears on top like I want, but I need that the other items to be ordered by <code>des_menu</code>. I tried something like</p>\n\n<pre><code>return teste.OrderBy(x =&gt; x.cod_menu).ThenBy(y =&gt; y.des_menu).ToList();\n</code></pre>\n\n<p>But didn't work of course, so I some need help to order only the elements after the first one</p>\n"},{"tags":["vb.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":71,"score":3,"question_id":12821390,"title":"LINQ - Group by Year and Month","body":"<p>I'm trying to write a linq query to group data from a datatable by year\\month.</p>\n\n<p>I've managed to group by one or the other but not both...</p>\n\n<pre><code>       Dim q = From p As DataRow In DTCalls.Rows _\n                Group By Year = p(\"DATE\").Year _\n                Into CALLS = Count(p(\"CALL_ID\")) _\n                Select Year, CALLS\n</code></pre>\n\n<p>How do I group\\order by year THEN month within the same query?</p>\n\n<p>Source data:</p>\n\n<pre><code>DATE                    CALL_ID\n2012-05-01 23:52:44   6587\n2012-02-03 09:17:41   6562\n2012-05-01 06:32:41   6565\n2012-02-03 12:47:41   6565\n2011-05-31 08:37:41   6511\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>DATE       COUNT\n2011-05      1\n2012-02      2\n2012-05      2\n</code></pre>\n"},{"tags":["json","linq"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12819437,"title":"Linq to Json using Like Clause","body":"<p>I've got an MVC 3 web app and am returning a JSON object which I would like to use Linq against to limit the result returned to the client jquery.</p>\n\n<p>The Json response takes the following structure:</p>\n\n<pre><code>{\n  \"Data\": {\n\"Items\": [\n  {\n    \"Result\": {\n      \"Id\": \"e2ba4912-c387-4f54-b55e-06742a6858db\",\n      \"Name\": \"SomeOtherSetting\",\n      \"Value\": \"500\",\n      \"Archived\": false\n     },\n    \"Result\": {\n      \"Id\": \"17c27584-cea8-42c2-b6c4-0b30625ac3ce\",\n      \"Name\": \"Setting2\",\n      \"Value\": \"600\",\n      \"Archived\": false\n    },\n    \"Result\": {\n      \"Id\": \"17c27584-cea8-42c2-b6c4-0b30625ac3ce\",\n      \"Name\": \"Setting3\",\n      \"Value\": \"700\",\n      \"Archived\": false\n    }\n   }]\n}\n}\n</code></pre>\n\n<p>....</p>\n\n<p>I need to return or grab just the json items that have a Name like 'Setting' for example. In the example, this would return just the 2 Json nodes.</p>\n\n<p>My Linq is very limited and what I have is: Settings is where the Json response is stored.</p>\n\n<pre><code>NewtonSoft.Json.Linq.JObject data = NewtonSoft.Json.Linq.JObject.Parse(Settings);\n\nvar result = from p in data[\"Data\"][\"Items\"].Children()\n    where (p[\"Result\"][\"Name\"].Contains(\"Expenses.Help.Tip\"))\n     select new { Name = (string)p[\"Result\"][\"Name\"], Value = (string)p[\"Result\"][\"Value\"] };\n</code></pre>\n\n<p>When I run this I get nothing in my result. Can anyone help and tell me what I'm doing wrong?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","visual-studio-2010","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":12820882,"title":"Hiding the Constructors of LINQ to SQL DataContext","body":"<p>I am using the LINQ to SQL Classes <em>(<strong>DataContext</strong>)</em> to connect to my DB. I have three databases with identical schema: <code>Development</code>, <code>Staging</code> and <code>Live</code>. I have realized that if they have an identical schema, I can connect to them using the same DataContext  by only changing the connection string that I pass in to the DataContext constructor. I have declared an interface so that all calls to the creation of the DataContext go through it: </p>\n\n<pre><code>public interface IDataContextCreator\n    {\n        MyDataContext CreateDataContext();\n    }\n</code></pre>\n\n<p>Now I can have concerete implementations of this interface to connect to the <code>Development</code>, <code>Staging</code> or <code>Live</code> DBs. </p>\n\n<p>I would now like to <strong><em>hide my DataContext constructor</em></strong> to force all calls to the creation of the <strong>DataContext</strong> go through the above interface. If I change the accessibility of the <strong>DataContext</strong> to <code>internal</code>, I cannot use it in other projects in the solution. I would ideally like to keep the class accessibility modifier as <code>public</code> but change the constructors to be <code>internal</code>. Is there any way to do this in the automatically generated classes? Is there any other solution to this problem? </p>\n\n<p>Thank you. </p>\n\n<p><strong>Edit:</strong> \nJon you are right the constructors should be made <code>internal</code>. I have these in my <strong>Data Layer</strong>, and I do not want classes in other projects/layers to get to these constructors. They however should be only able create the <strong>DataContext</strong> using the interface and then use the created <strong>DataContext</strong> - since it would be public on the class level.</p>\n"},{"tags":["c#","asp.net","xml","linq","kml"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":104,"score":3,"question_id":12820775,"title":"Generating a kml file on the fly using C# and Linq","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2874422/how-to-set-the-default-xml-namespace-for-an-xdocument\">How to set the default XML namespace for an XDocument</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to write a piece of code in Asp.net C#, in order to create a KML file on-the-fly and store it in a specific path.\nThe code gives an error when i want to add the xmlns=\"http://earth.google.com/kml/2.2\" attribute of kml tag (see below). I tried replacing xmlns with another word like \"id\" and it works just fine. Does it have something to do with the word \"xmlns\" ??! pretty strange for me. </p>\n\n<p>Please provide me a solution if you understand what the problem is... Thanks!</p>\n\n<p>My code:</p>\n\n<pre><code>XDocument doc = new XDocument(\n        new XDeclaration(\"1.0\", \"utf-8\", \"\"),\n        new XComment(\"This is comment by me\"),\n        new XElement(\"kml\", new XAttribute(\"xmlns\", \"http://earth.google.com/kml/2.2\"),\n        new XElement(\"Document\",\n        new XElement(\"Name\", \"something\"), new XElement(\"Placemark\",\n        new XAttribute(\"id\", \"1\"),\n        new XElement(\"title\", \"something\"),\n        new XElement(\"description\", \"something\"),\n        new XElement(\"LookAt\",\n        new XElement(\"Longitude\", \"49.69\"),\n        new XElement(\"Latitude\", \"32.345\")), new XElement(\"Point\", new XElement(\"Coordinates\", \"49.69,32.345,0\"))))));\n        doc.Save(Server.MapPath(@\"~\\App_Data\\markers.xml\"));\n</code></pre>\n\n<p>The runtime error it gives:</p>\n\n<blockquote>\n  <p>The prefix '' cannot be redefined from '' to\n  'http://earth.google.com/kml/2.2' within the same start element tag. \n  Description: An unhandled exception occurred during the execution of\n  the current web request. Please review the stack trace for more\n  information about the error and where it originated in the code. </p>\n  \n  <p>Exception Details: System.Xml.XmlException: The prefix '' cannot be\n  redefined from '' to 'http://earth.google.com/kml/2.2' within the same\n  start element tag.</p>\n</blockquote>\n\n<p>The kml file i would LIKE to create:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!--This is comment by me--&gt;\n&lt;kml xmlns=\"http://earth.google.com/kml/2.2\"&gt;\n  &lt;Document&gt;\n    &lt;Name&gt;something&lt;/Name&gt;\n    &lt;Placemark id=\"1\"&gt;\n      &lt;title&gt;something&lt;/title&gt;\n      &lt;description&gt;something&lt;/description&gt;\n      &lt;LookAt&gt;\n        &lt;Longitude&gt;49.69&lt;/Longitude&gt;\n        &lt;Latitude&gt;32.345&lt;/Latitude&gt;\n      &lt;/LookAt&gt;\n      &lt;Point&gt;\n        &lt;Coordinates&gt;49.69,32.345,0&lt;/Coordinates&gt;\n      &lt;/Point&gt;\n    &lt;/Placemark&gt;\n  &lt;/Document&gt;\n&lt;/kml&gt;\n</code></pre>\n"},{"tags":["c#","winforms","linq","linq-to-sql","datagridview"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":2215,"score":6,"question_id":2647172,"title":"Fill WinForms DataGridView From Anonymous Linq Query","body":"<p>// From my form</p>\n\n<pre><code>BindingSource bs = new BindingSource();\n\nprivate void fillStudentGrid()\n{\n     bs.DataSource = Admin.GetStudents();\n     dgViewStudents.DataSource = bs;\n}\n</code></pre>\n\n<p>// From the Admin class</p>\n\n<pre><code>public static List&lt;Student&gt; GetStudents()\n\n{\n    DojoDBDataContext conn = new DojoDBDataContext();\n\n    var query =\n        (from s in conn.Students\n         select new Student\n         {\n             ID = s.ID,\n             FirstName = s.FirstName,\n             LastName = s.LastName,\n             Belt = s.Belt\n         }).ToList();\n\n    return query;\n}\n</code></pre>\n\n<p>I'm trying to fill a datagridview control in Winforms, and I only want a few of the values. The code compiles, but throws a runtime error:</p>\n\n<p><em>Explicit construction of entity type 'DojoManagement.Student' in query is not allowed.</em></p>\n\n<p>Is there a way to get it working in this manner?</p>\n"},{"tags":["c#","linq","entity-framework","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":85,"score":6,"question_id":12232708,"title":"What's the most efficient way to get only the final row of a SQL table using EF4?","body":"<p>I'm looking to retrieve the last row of a table by the table's ID column. What I am currently using works:</p>\n\n<pre><code>var x = db.MyTable.OrderByDescending(d =&gt; d.ID).FirstOrDefault();\n</code></pre>\n\n<p>Is there any way to get the same result with more efficient speed?</p>\n"},{"tags":["c#",".net","linq","exception-handling"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1025,"score":6,"question_id":8325707,"title":"LINQ lambda - convert int to string","body":"<p>i'm trying to compare a int with a string in the join method of linq lambda, like this:</p>\n\n<pre><code>database.booking.Join(database.address,\n                      book =&gt; book.bookno,\n                      afh =&gt; afh.addressid.ToString(),\n                       (book, afh) =&gt; new { booking = book, add = afh })\n                .Where(book =&gt; book.address.name == \"test\");\n</code></pre>\n\n<p>but i'm getting an error on the ToString():</p>\n\n<blockquote>\n  <p>System.NotSupportedException: LINQ to Entities does not recognize the method 'Int32 ToInt32(System.String)' method, and this method cannot be translated into a store expression.</p>\n</blockquote>\n\n<p>How do i solve this?</p>\n"},{"tags":["c#","linq","generics","data-structures","iqueryable"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":601,"score":2,"question_id":2330397,"title":"Hashset vs. IQueryable","body":"<p>Recently I was working on implementing a small snippet that caches my results and the way I was doing it was using a Dictionary as follows:</p>\n\n<pre><code> private Dictionary&lt;ID, IQueryable&lt;Results&gt;&gt; _simpleCache;\n</code></pre>\n\n<p>The idea was to search for all the results that have the id specified by 'ID' and if the Dictionary contains the key == id, we simply search through the values present in the IQueryable instead of making a database trip.</p>\n\n<p>I was going over this piece of logic this morning and I was thinking about replacing the IQueryable with HashSet as follows:</p>\n\n<pre><code>private Dictionary&lt;ID, HashSet&lt;Results&gt;&gt; _simpleCache;\n</code></pre>\n\n<p>Is making this change advisable?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":420,"score":1,"question_id":9436737,"title":"Dynamic LINQ - Unable to convert between GUID and string","body":"<p>I am dynamically building a LINQ statement. The LINQ statement that I'm building is used purely for the WHERE clause.</p>\n\n<pre><code>string[] values = GetPropertyValues(); \nstring propertyName = GetPropertyName();\n\nstring clause = string.Empty;\nif (values.Length &gt; 0)\n  clause = propertyName + \"==\\\"\" + values[0] + \"\\\"\";\n</code></pre>\n\n<p>From what I can tell, my LINQ query looks correct. But when it gets executed, I receive an error that says:</p>\n\n<p><em>Operator '==' incompatible with operand types 'Guid?' and 'String'</em></p>\n\n<p>How do I remedy this problem?</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#","sql","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":94,"score":-1,"question_id":12818177,"title":"Convert SQL text to Linq command","body":"<p>I have a textbox where the user will enter some SQL:</p>\n\n<p>for example: <code>SELECT * FROM Customers;</code></p>\n\n<p>I know the LINQ will look something like this:</p>\n\n<pre><code> var query = \n from c in Customers.AsEnumerable()\n select c;\n</code></pre>\n\n<p>The problem I am having is that the user is going to enter a string, so I need\nto convert this string into a LINQ command:</p>\n\n<p>for eg.</p>\n\n<p>How will I convert \"<code>FROM</code>\"  to from --> a text to a command.</p>\n\n<p>In other words I will want something like:</p>\n\n<pre><code> var query = \n toCommand(\"from\") c in Customers.AsEnumerable()\n toCommand(\"select\") c;\n</code></pre>\n\n<p><strong>Forgot to mention that Customers is stored in a DataTable.</strong></p>\n\n<p>Thanks in Advance.</p>\n"},{"tags":["c#","performance","linq","linq-to-sql"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12802221,"title":"Improving performance of condtitional query inside LINQ enumerator","body":"<p>I've got some code that looks like this, using .NET 3.5 (customer requirement):</p>\n\n<pre><code>void Process (ActionState state)\n{\n    var orderItemQuery = from OrderItem item in order.OrderItems\n                           orderby item.OrderLineNumber ascending\n                           select item;\n\n    foreach (OrderItem item in orderItemQuery)\n    {\n        ActionData actionData;\n        switch (state)\n        {\n            case ActionState.Prepare:\n                actionData = (\n                    from ActionData ad in db.ActionDataTable\n                      where ad.ObjectId == item.ProductId\n                      select ad\n                ).First();\n\n            case ActionState.QualityCheck:\n                actionData = (\n                    from ActionData ad in db.ActionDataTable\n                      where ad.ObjectId == item.OrderItemId\n                      select ad\n                ).First();\n\n            default:\n                throw new InvalidOperationException();\n        }\n\n        // ...\n    }\n}\n</code></pre>\n\n<p>Essentially the results of the first query are iterated through, and a particular foreign key is used to fetch an <code>ActionData</code> record from the database, based upon the current <code>ActionState</code>. In reality there's a bit more nesting and a few checks here and there, but it's essentially the same.</p>\n\n<p>This initially worked great for test databases, but a customer just sent me a copy of their live data and it's hideously slow. It takes around 15 minutes to run the entire batch, including some other processing. After running the code through a performance tester, I discovered that the slowest part of the entire process was the <code>.First()</code> call on each of the cases.</p>\n\n<p>If this were plain SQL, I'd compile a stored procedure outside of the loop based on the value of <code>state</code>, and use that. Since I can't do that, what's the alternative? How can I speed this up?</p>\n"},{"tags":["c#","linq","linq-to-entities","linq-query-syntax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12816985,"title":"Filtering Linq Query Correctly","body":"<p>I have this query that retrieves sales from a bunch of shops, and returns them as a list. On my report request screen, the user can filter by a number of ids - ShopOwnerId, ShopRegionId, ShopTypeCode, etc. </p>\n\n<p>My query is structured to get all sales between selected dates, then filter down depending on the choices. This is obviously highly inefficient. :</p>\n\n<pre><code>private List&lt;Sales&gt; GetFilteredListOfSales(Request reportreq)\n{\n    ModelContainer ctn = new ModelContainer();\n    List&lt;ShopSale&gt; shopsSales = new List&lt;shopsale&gt;();\n\n    // If no filters are selected\n    //\n    if (reportreq.RegionalId == null &amp;&amp; reportreq.OwnerId == null &amp;&amp; reportreq.ShopTypeCode == null)\n    {\n        shopsSales = (from sale in ctn.ShopSales\n                    where sale.DateSold &gt;= reportreq.FromDate &amp;&amp; sale.DateSold &lt;= reportreq.ToDate\n                    select sale).ToList();\n    }\n\n\n    // If the regional ID has a value...\n    // \n    if (reportreq.RegionalId.HasValue)\n    {\n        shopsSales = (from sale in ctn.ShopSales\n                  where sale.Shop.Owner.RegionalId == reportreq.RegionalId\n                    &amp;&amp; sale.DateSold &gt;= reportreq.FromDate &amp;&amp; sale.DateSold &lt;= reportreq.ToDate\n                  select sale).ToList();\n    }\n\n    // If the owner ID has a value...\n    // \n    if (reportreq.OwnerId.HasValue)\n    {\n        shopsSales = (from sale in ctn.ShopSales\n                  where sale.Shop.OwnerId == reportreq.OwnerId\n                    &amp;&amp; sale.DateSold &gt;= reportreq.FromDate &amp;&amp; sale.DateSold &lt;= reportreq.ToDate\n                  select sale).ToList();\n    }\n\n    if (!string.IsNullOrEmpty(reportreq.ShopTypeCode))\n    {\n        shopsSales = (from sale in ctn.ShopSales\n                  where sale.Shop.ShopTypeCode.ToUpper().Contains(reportreq.ShopTypeCode.ToUpper())\n                    &amp;&amp; sale.DateSold &gt;= reportreq.FromDate &amp;&amp; sale.DateSold &lt;= reportreq.ToDate\n                  select sale).ToList();\n    }\n\n\n\n    return shopsSales;\n}\n</code></pre>\n\n<p>You can see, that this method, queries the sales table between certain dates only if no filters have been selected. </p>\n\n<p>What I'm stuck on is, the user could select more than one filter - e.g. they might select a regionId, and a ShopTypeCode, so I don't want to query ctn.ShopSales for each if filter, because if more than one is selcted, it will wipe out the previously retrieved values. </p>\n\n<p>Does anyone have any advice as to how to get around this issue? If more info is needed just ask!</p>\n\n<p>Thanks</p>\n"},{"tags":[".net","linq","delegates"],"answer_count":12,"favorite_count":42,"up_vote_count":68,"down_vote_count":1,"view_count":19941,"score":67,"question_id":98033,"title":"Wrap a delegate in an IEqualityComparer","body":"<p>Several Linq.Enumerable functions take an <code>IEqualityComparer&lt;T&gt;</code>. Is there a convenient wrapper class that adapts a <code>delegate(T,T)=&gt;bool</code> to implement <code>IEqualityComparer&lt;T&gt;</code>? It's easy enough to write one (if your ignore problems with defining a correct hashcode), but I'd like to know if there is an out-of-the-box solution.</p>\n\n<p>Specifically, I want to do set operations on <code>Dictionary</code>s, using only the Keys to define membership (while retaining the values according to different rules).</p>\n"},{"tags":["linq","join","grid","lookup-tables"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12816444,"title":"using lookuptables in LINQ-filled datagrid","body":"<p>what i try to implement:</p>\n\n<ul>\n<li>Have a grid filled with with LINQ2SQL from table A_Table1</li>\n<li>Have one column in the grid displaying a Combo with looup values from a tabel A_Table2</li>\n<li>Save the primary key of the lookup value in table A_Table1</li>\n</ul>\n\n<p>I use the C1FlexGrid and C1Combo and bindingsources to bind the data.\nI could get this running without trouble till i wanted to show the related value of the lookup selection \ninside the grid and not the PK of the lookup value.</p>\n\n<p>To overcome this i bind the data of the grid to a DTO and do manualy set the data in A_Table1.\nI do have one aditional column in the grid (DTO) where i do show the selection of the value(string) \nand on change of the combo i do update the underlying DTO of the grid with the PK fron the lookup table. \nthe PK field of the lookupvalue is hidden inside the grid.</p>\n\n<p>My questions: \n- Is there some better way to do this?\n- I would love to remove the DTO from the LINQ query but i don't know if its possible to join \"extra columns\" \ninto the result. And even if this would be possible, i don't know if it is possible to get the current A_Table1\nobject in the SelectedValueChanged event of the combo in order to set the PK of the lookup value.\nCould this be realized somehow?</p>\n\n<p>code so far: ...</p>\n\n<pre><code>Public Class Form1\n\n    Private db As New MESDBDataContext\n    Private bs As New BindingSource\n    Private bsCbo As New BindingSource\n\n    'struct A_Table1\n    ' pk_t1 (int)(not null)\n    ' pk_t2 (int)(null)\n\n    'struct A_Table2\n    ' pk_t2 (int)(not null)\n    ' value_t2 (varchar)(not null)\n\n\n    Public Class ValueDTO\n        Private m_id As Integer\n        Public Property id() As Integer\n            Get\n                Return m_id\n            End Get\n            Set(value As Integer)\n                m_id = value\n            End Set\n        End Property\n\n        Private m_lookup_id As Nullable(Of Integer)\n        Public Property lookup_id() As Nullable(Of Integer)\n            Get\n                Return m_lookup_id\n            End Get\n            Set(value As Nullable(Of Integer))\n                m_lookup_id = value\n            End Set\n        End Property\n\n        Private m_lookup_dispValue As String\n        Public Property lookup_dispValue() As String\n            Get\n                Return m_lookup_dispValue\n            End Get\n            Set(value As String)\n                m_lookup_dispValue = value\n            End Set\n        End Property\n\n    End Class\n\n    Private Sub bntFill_Click(sender As System.Object, eg As System.EventArgs) Handles bntFill.Click\n        grd.ShowButtons = C1.Win.C1FlexGrid.ShowButtonsEnum.Always\n\n        bs.DataSource = (From p In db.A_Table1s From e In\n            db.A_Table2s.Where(Function(v) v.pk_t2 = p.pk_t2).DefaultIfEmpty() Select New ValueDTO With\n            {.id = p.pk_t1, .lookup_id = p.pk_t2, .lookup_dispValue = If(p.pk_t2 Is Nothing, Nothing, e.value_t2)})\n\n        grd.DataSource = bs    \n        grd.Cols(\"lookup_dispValue\").Editor = C1Combo1\n    End Sub\n\n    Private Sub C1Combo1_BeforeOpen(sender As System.Object, e As System.ComponentModel.CancelEventArgs) Handles C1Combo1.BeforeOpen\n        If grd.Row Mod 2 = 0 Then\n            bsCbo.DataSource = (From p In db.A_Table2s Where p.pk_t2 &lt; 3 Select p)\n        Else\n            bsCbo.DataSource = (From p In db.A_Table2s Where p.pk_t2 &gt;= 3 Select p)\n        End If\n\n        C1Combo1.DataSource = bsCbo\n        C1Combo1.ValueMember = \"value_t2\"\n        C1Combo1.DisplayMember = \"value_t2\"\n    End Sub\n\n    Private Sub C1Combo1_SelectedValueChanged(sender As System.Object, e As System.EventArgs) Handles C1Combo1.SelectedValueChanged\n        Dim cur As ValueDTO = bs.Current\n        Dim curCbo As A_Table2 = bsCbo.Current\n\n        cur.lookup_id = curCbo.pk_t2\n        cur.lookup_dispValue = curCbo.value_t2        \n    End Sub\n\n    Private Sub btnShow_Click(sender As System.Object, e As System.EventArgs) Handles btnShow.Click\n        Dim cur As ValueDTO = bs.Current\n        Debug.Print(\"id:\" &amp; cur.id &amp; \" / lookup_pk:\" &amp; cur.lookup_id &amp; \" / lookup_dispValue\" &amp; cur.lookup_dispValue)\n    End Sub\n\nEnd Class\n</code></pre>\n\n<p>_tia rene</p>\n"},{"tags":["linq","attributes","index","ravendb"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12796438,"title":"How to select attribute in RavenDB Index in Json-Linq?","body":"<p>In RavenDB my document (ID = 1234) is</p>\n\n<pre><code>   \"datacontainer\": {\n      \"data\": [\n        {\n          \"@idx\": \"1\",\n          \"@idy\": \"a\",\n          \"value\": {\n            \"#text\": \"test 2010\"\n          }\n        },\n        {\n          \"@idx\": \"2\",\n          \"@idy\": \"b\",\n          \"value\": {\n            \"#text\": \"test 2011\"\n          }\n        },\n        {\n          \"@idx\": \"3\",\n          \"@idy\": \"c\",\n          \"value\": {\n            \"#text\": \"test 2012\"\n          }\n        }\n      ]\n   }\n</code></pre>\n\n<p>I want to create an Index, where I choose my favourite values (for example <code>idx = \"2\"</code> and <code>idy = \"b\"</code>) and the output will be:</p>\n\n<pre><code>(ID, value_text) = (1234, \"test 2011\")\n</code></pre>\n\n<p>Now I can select a single element and check its value in Linq:</p>\n\n<pre><code>where p.datacontainer.data[0][\"@idx\"] == \"2\" &amp;&amp; p.datacontainer.data[0][\"@idy\"] == \"b\"\n</code></pre>\n\n<p>How can I search the right element in my list?</p>\n"},{"tags":["linq","lucene.net","ravendb"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12298468,"title":"Search by substring with spacebar in RavenDB","body":"<p>I'm using such query</p>\n\n<pre><code>var query = \"*\" + QueryParser.Escape(input) + \"*\";\nsession.Query&lt;User, UsersByEmailAndName&gt;().Where(x =&gt; x.Email.In(query) || x.DisplayName.In(query));\n</code></pre>\n\n<p>My index is simple</p>\n\n<pre><code>public UsersByEmailAndName()\n{\n    Map = users =&gt; from user in users\n                   select new\n                          {\n                              user.Email,\n                              user.DisplayName,\n                          };            \n}\n</code></pre>\n\n<p><a href=\"http://ravendb.net/docs/client-api/querying/static-indexes/configuring-index-options\" rel=\"nofollow\">here</a> I've read that:</p>\n\n<blockquote>\n  <p>\"By default, RavenDB uses a custom analyzer called\n  LowerCaseKeywordAnalyzer for all content. (...) The default values for\n  each field are FieldStorage.No in Stores and FieldIndexing.Default in\n  Indexes.\"</p>\n</blockquote>\n\n<p>The index contains fields: </p>\n\n<p><strong>DisplayName</strong> - <code>\"jarek waliszko\"</code> and <strong>Email</strong> - <code>\"my_email@domain.com\"</code></p>\n\n<p>If the <code>query</code> is for example: <code>*_email@*</code> or <code>*ali*</code> the result is fine. But while I use spacebar inside: <code>*ek wa*</code>, nothing is returned. Why, and how to fix this ?</p>\n\n<p>Btw: I'm using RavenDB - Build #960</p>\n"},{"tags":["c#","linq","list"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":84,"score":-1,"question_id":12813327,"title":"How to Union the List<T> using LINQ?","body":"<p>I am having a two List instances namely OldCustomers, NewCustomers.</p>\n\n<pre><code>List&lt;Customer&gt; OldCustomers;\n\nList&lt;Customer&gt; NewCustomers;\n</code></pre>\n\n<p>I just want the Union of both Oldcustomers, NewCustomers. That is if the CustomerID 100 is present in the OldCustomerList and also in the NewCustomer List then the Customer Details in the OldCustomer List has to be Removed and the NewCustomer List has to be placed in the Resulting List as like below.</p>\n\n<pre><code>List&lt;Customer&gt; NewCustomers;\n    Union\nList&lt;Customer&gt; OldCustomers;\n</code></pre>\n\n<p>how do i Do that in LINQ? </p>\n\n<p>Thanks in Advance,</p>\n"},{"tags":["c#","asp.net","visual-studio-2010","linq","datatable"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":12812507,"title":"Compare and delete datatable row using C#:","body":"<p>I have two tables such as DTTable1 and  DTTable2. It has the following records.</p>\n\n<p>DTTable1:</p>\n\n<pre><code>    ItemID     Specification    Amount\n   ---------  ---------------  ---------\n      1             A             10\n      1             B             20\n      1             C             30\n</code></pre>\n\n<p>DTTable1:</p>\n\n<pre><code>    ItemID     Specification    Amount\n   ---------  ---------------  ---------\n      1             A             10\n      1             B             20\n      1             C             30\n      2             A             10\n      2             B             20\n      3             A             10\n      3             B             20\n</code></pre>\n\n<p>Here I want to compare these two tables. If DTTable1 records present in DTTable2(consider only ItemID) then remove the corresponding rows which has the ItemID same as DTTable1.</p>\n\n<p>I have tried foreach and forloop. \nUsing ForEach:</p>\n\n<pre><code>   foreach (DataRow DR in DTTable2.Rows)\n   {\n      if (DR[\"ItemID\"].ToString() == DTTable1.Rows[0][\"ItemID\"].ToString())\n      {\n           DTTable2.Rows.Remove(DR);                            \n      }\n   }\n   DTTable2.AcceptChanges();\n</code></pre>\n\n<p>It showed the error,\n       \"Collection was modified; enumeration operation might not execute\". So I used For Loop, It also not given the desired result.</p>\n\n<p>Using For Loop:</p>\n\n<pre><code>   for (int i = 0; i &lt; DTTable2.Rows.Count; i++)\n   {\n       if (DTTable2.Rows[i][\"ItemID\"].ToString() == DTTable1.Rows[0][\"ItemID\"].ToString())\n       {\n           DTTable2.Rows.RemoveAt(i);\n       }\n   }\n   DTTable2.AcceptChanges();\n</code></pre>\n\n<p>But sometimes, the second row doesn't remove from the table. I get the final DataTable as</p>\n\n<pre><code>    ItemID     Specification    Amount\n   ---------  ---------------  ---------\n      1             B             20\n      2             A             10\n      2             B             20\n      3             A             10\n      3             B             20\n</code></pre>\n\n<p>How to solve this? What is the simplest method to do this?</p>\n"},{"tags":["sql","linq","linqpad"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12810907,"title":"Using sqlfunctions in linqpad","body":"<p>My LinqPad is treating SqlFunctions as an unrecognized class. The intellisense is underlining the class.</p>\n\n<p>How can I call the library in my linqpad query?</p>\n"},{"tags":["c#","sql","linq"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":251,"score":6,"question_id":12805075,"title":"Linq To SQL Select Dynamic Columns","body":"<p>Is it possible to dynamically limit the number of columns returned from a LINQ to SQL query?</p>\n\n<p>I have a database SQL View with over 50 columns. My app has a domain object with over 50 properties, one for each column. In my winforms project I bind a list of domain objects to a grid. By default only a few of the columns are visible however the user can turn on/off any of the columns.</p>\n\n<p>Users are complaining the grid takes too long to load. I captured the LINQ generated SQL query then executed it within SQL Server Management Studio and verified its slow. If I alter the SQL statement, removing all the invisible columns, it runs almost instantly. There is a direct correlation between performance and the number of columns in the query.</p>\n\n<p>I'm wondering if its possible to dynamically alter the number of columns returned from the LINQ generated SQL query? For example, here is what my code currently looks like:</p>\n\n<pre><code>public List&lt;Entity&gt; GetEntities()\n{\n    using (var context = new CensusEntities())\n    {\n        return (from e in context.Entities\n            select e).ToList();\n    }\n}\n</code></pre>\n\n<p>The context.Entities object was generated from a SQL View that contains over 50 columns so when the above executes it generates SQL like \"SELECT Col1, Col2, Col3, ... Col50 FROM Entity INNER JOIN...\". I would like to change the method signature to look like this:</p>\n\n<pre><code>public List&lt;Entity&gt; GetEntities(string[] visibleColumns)\n{\n    using (var context = new CensusEntities())\n    {\n        return (from e in context.Entities\n            select e).ToList();\n    }\n}\n</code></pre>\n\n<p>I'm not sure how to alter the body of this method to change the generated SQL statement to only return the column values I care about, all others can be NULL.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":125,"score":5,"question_id":12803107,"title":"get common elements in lists in C#","body":"<p>I have two sorted lists as below:</p>\n\n<pre><code>var list1 = new List&lt;int&gt;() { 1, 1, 1, 2, 3 };\nvar list2 = new List&lt;int&gt;() { 1, 1, 2, 2, 4 };\n</code></pre>\n\n<p>I want the output to be: <code>{1, 1, 2}</code></p>\n\n<p>How to do this in C#?\nIs there a way using Linq?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12804207,"title":"Optimize linq statement","body":"<p>I have the linq statement below. How can I solve this without the loop. It is a tag system and I only want those exercises that have the tags with the ids in \"myints\"</p>\n\n<pre><code>int[] myints = {1,2};\n  foreach (int tagid_temp in myints)\n  {\n    ExerciseByTagId = \n        (from exercise in context.ExerciseSet\n         where context.ItemsTagsSet\n               .Where(a =&gt; a.TagsId == tagid_temp)\n               .Select(a =&gt; a.ExerciseId).Contains(exercise.Id)\n      select exercise);\n  }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":101,"score":2,"question_id":12771010,"title":"IEnumerable with Prev/Next","body":"<p>Just looking for some confirmation on this. I need to capture the previous and next IDs for my list. Is there a better way?</p>\n\n<pre><code>var questionArray = dc.Question\n    .Where(i =&gt; !i.IsDeleted)\n    .OrderBy(i =&gt; i.SortOrder)\n    .Select(i =&gt; new\n    {\n        i.QuestionID,\n        i.Name,\n    })\n    .ToArray();\n\nvar questionList = questionArray\n    .Select((item, index) =&gt; new\n    {\n        item.QuestionID,\n        PrevID = index &gt; 0 ? questionArray[index - 1].QuestionID : (int?)null,\n        NextID = index &lt; questionArray.Length - 1 ? questionArray[index + 1].QuestionID : (int?)null,\n        item.Name,\n    })\n    .ToList();\n</code></pre>\n"},{"tags":["asp.net","vb.net","linq","linq-to-sql","anonymous-types"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":6467,"score":1,"question_id":633908,"title":"Linq returning list of anonymous types","body":"<p>Caan somone advise the best approach to what i'm trying to acheive (linq to sql, returning list of data to show in a grid/list etc etc)... Its complaining about anonymous type conversion, and from what i'm reading, thats not elegant way of doing it.</p>\n\n<pre><code>  Public Function GetHistory(ByVal historyId As Integer) As List(Of ?????????)\n    Using dc As New myDataContext(Application.GetConnection)\n      Return (From t In dc.ActionTypes, a In t.MyTable Where a.HistoryID = historyId Select a.ActionOn, a.ActionBy, t.Description, a.ImpactedItem, a.ActionDescription).ToList\n    End Using\n  End Function\n</code></pre>\n"},{"tags":["linq"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2190,"score":3,"question_id":4841084,"title":"linq select a random row","body":"<p>I have a table called Quotes in linq-to-sql that contains 2 columns: author and quote. How do you select both columns of a random row?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12805467,"title":"C# SqlMethods Like Not Working","body":"<p>I'm brand new to using Linq and can't get the SqlMethods.Like function work.</p>\n\n<p>Here's my simplified example:</p>\n\n<pre><code>        List&lt;string&gt; mylist = new List&lt;string&gt;();\n        mylist.Add(\"100\");\n        mylist.Add(\"101\");\n        mylist.Add(\"102\");\n        mylist.Add(\"103\");\n        mylist.Add(\"104\");\n        mylist.Add(\"105\");\n        mylist.Add(\"106\");\n        mylist.Add(\"107\");\n\n        var filtered = mylist.Where(x =&gt; SqlMethods.Like(x, \"10%\"));\n        foreach (var record in filtered)\n        {\n            textBox1.Text += record + \"\\n\";\n        }\n</code></pre>\n\n<p>My variable called filtered comes back empty. What am I missing?</p>\n\n<p>If I use x.Equals(\"100\") I get results back.</p>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":12805287,"title":"Is it possible to use OfType in a linq where?","body":"<p>I have a table called source that has multiple derived tables such as account, etc. I have a second table that has a navigation property to that table called Source.  </p>\n\n<p>What I'd like to do is filter the results of ActionItemState by the type of the Source then filter based on a property of that inherited table. </p>\n\n<p>Here is an example of what I'm trying to do.  I get \". LINQ to Entities only supports casting EDM primitive or enumeration types\" when I try the code below.  Does anyone know of a way to use OfType or something similar?</p>\n\n<pre><code> query = from a in _actionItemRepository.GetTable()\n         where a.ActionItemStates.Any(ais =&gt; ais.Source is AccountSource &amp;&amp; ((AccountSource)ais.Source).AccountId == id)\n         select a;\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/lpnCp.png\" alt=\"enter image description here\"></p>\n"},{"tags":["asp.net","asp.net-mvc-3","linq","dynamic-data"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":130,"score":0,"question_id":12471478,"title":"Dynamic Data asp.net Foreign key relationship in DropdownList, how to customise?","body":"<p>I'm working on <code>Asp.Net Dynamic Data project with linq to sql</code>. </p>\n\n<p>I've created a database that has <code>one to one relationship</code> between two tables specified using a foreign key.</p>\n\n<p>i.e. I have a table <code>Employee</code> and table <code>Department</code></p>\n\n<pre><code>Employee table\nempid empname address departmentId \n\nDepartment table\ndepartmentId departmentname\n</code></pre>\n\n<p>now <code>Student</code> table takes an <code>departmentId</code> as a <code>foreign key</code></p>\n\n<p>when I navigated to <code>/Insert.aspx</code> that it would display the a list of <code>department_name</code> in a dropdown list. </p>\n\n<p>It does this - but it shows all the <code>department_name</code> into dropdownlist</p>\n\n<blockquote>\n  <p>How and where I could write linq query so that i can customize those department_name values</p>\n</blockquote>\n\n<p>If suppose I want to only populate <code>computers</code> as a department_name in that dropdownlist\nhow could I achieve this ?</p>\n\n<p>Code:\nIn FieldTemplate folder <code>ForeignKey_Edit.ascx.cs</code></p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n    {\n        if (DropDownList1.Items.Count == 0)\n        {\n            if (Mode == DataBoundControlMode.Insert || !Column.IsRequired)\n            {\n                DropDownList1.Items.Add(new ListItem(\"[Not Set]\", \"\"));\n            }\n            PopulateListControl(DropDownList1);\n        }\n\n        SetUpValidator(RequiredFieldValidator1);\n        SetUpValidator(DynamicValidator1);\n    }\n</code></pre>\n\n<p>data dynamics is populating dropdownlist internally.</p>\n\n<p>here before or after this statement <code>PopulateListControl(DropDownList1);</code></p>\n\n<p>what should I code so that i can populate only specific value..?</p>\n"},{"tags":[".net","vb.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12804092,"title":"Creating Linq Expressions using generic function","body":"<p>I have a class (entity) like the following:</p>\n\n<pre><code>Public Class Product\n\n    Property ID As Integer\n    Property Name As String\n    Property IssueDate As Date\n    Property ExpireDate As Date\n    Property NextCheckDate As Date\n\nEnd Class\n</code></pre>\n\n<p>I am using Entity Framework 5 and I want to query my database using some predicates in the <em>where</em> clause. In order to create a predicate for dates I want to use a function like the following:</p>\n\n<pre><code>Function GetDateIssuePredicate(fromDate As Date?, toDate As Date?) As Expression(Of Func(Of Product, Boolean))\n\n    Dim predicate As Expressions.Expression(Of Func(Of Product, Boolean))\n\n    If fromDate.hasValue AndAlso toDate.hasValue Then\n        predicate = (Function(p) p.IssueDate &gt;= fromDate.Value AndAlso p.IssueDate&lt;= toDate.Value)\n    ElseIf fromDate.hasValue Then\n        predicate = (Function(p) p.IssueDate &gt;= fromDate.Value)\n    ElseIf toDate.hasValue Then\n        predicate = (Function(p) p.IssueDate&lt;= toDate.Value)\n    End If\n\n    Return predicate\n\nEnd Function\n</code></pre>\n\n<p>This function works for the specific entity field <strong>IssueDate</strong>. I want to avoid creating more functions doing exactly the same thing just for different entity fields (i.e.<strong>ExpireDate</strong>, <strong>NextCheckDate</strong>). Is there any way to achieve this?</p>\n"},{"tags":["c#","linq","linq-to-sql","transactions","linked-server"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12802539,"title":"Linq-to-SQL transaction breaking linked server query","body":"<p>I have a simple application that uses Linq-to-SQL to retrieve and update data.</p>\n\n<p>On my <code>DataContext</code> I have a procedure called <code>GET_DATA</code> that reads data from a non-SQL Server data source using a linked server. I use the data read to update a few tables on SQL Server.</p>\n\n<p>The process of updating the data on SQL Server is done (summarizing) like this:</p>\n\n<pre><code>var db = new MyDBDataContext()\ndb.ExecuteCommand(\"Update table1 set field={0} where field={1}\", value1, value2);\n</code></pre>\n\n<p>It works perfectly fine.</p>\n\n<p>Now, the problem: a new requirement came to update 2 tables instead of one so I decided to add some transaction control:</p>\n\n<pre><code>using (var db = new MyDBDataContext())\nusing (var tran = new TransactionScope())\n{\n    try\n    {\n        db.ExecuteCommand(\"Update table1 set field={0} where field={1}\", value1, value2);\n        db.ExecuteCommand(\"Update table3 set field={0} where field={1}\", value1, value2);\n\n        tran.Complete();\n    }\n    catch (Exception e)\n    {\n        tran.Dispose();\n    }\n}\n</code></pre>\n\n<p>Once again it works fine, but after I update the data (regardless if the process fails or succeeds), if I try to run the search procedure, I get this error:</p>\n\n<blockquote>\n  <p>The operation could not be performed because OLE DB provider \\\"OraOLEDB.Oracle\\\" for linked server \\\"LINKED_SERVER_NAME\\\" was unable to begin a distributed transaction.\"}</p>\n</blockquote>\n\n<p>The only way I can make it work again is if I right click on the ASP.Net development Server and close it. It seems that it is keeping something open, but I checked the <code>dm_tran_session_transactions</code> DMV and I don't see any transactions open (I can see it if I debug into the method, but once the method is completed, no transaction is open)</p>\n\n<p>FYI: the <code>dbcontext</code> objects are different form the select to the update and I also tried to add <code>db.SubmitChanges()</code> but it didn't work either.</p>\n\n<p>Any advise would be helpful thanks</p>\n\n<p>EDIT:\nThe search procedure does not have transaction control inside it and it is called by a simple LINQ Statment:</p>\n\n<pre><code>var result = (from r in context.GET_DATA(parameter)\n                          select new Object{\n                             .....\n                           }\n              );\nreturn result.ToList();\n</code></pre>\n"},{"tags":["linq","filter","count","where"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":12804137,"title":"Linq query with count filter of a column","body":"<p>I try to create some linq query like following.</p>\n\n<p>I have a table with resource planning items. There is a column weekID and a column deployedPlanning. I would like to check if the count of deployedPlanning in each week is not higher than 40 hours. I need to add some extra where filters on the linq query below but I dont know how :( Can someone tell me how I can add these where filter on the current linq query below?</p>\n\n<pre><code>var resourcePlanning = new ResourcePlanningManager().Repository.Find(\n                rp =&gt; rp.EmployeeID == employeeRosterPeriod.EmployeeID &amp;&amp;\n                      rp.PlanDate &gt;= employeeRosterPeriod.DateFrom &amp;&amp;\n                      rp.PlanDate &lt;= employeeRosterPeriod.DateTo).FirstOrDefault();\n            if (resourcePlanning != null)\n            {\n               // throw excetoption. There are more than 40 hours planned in 1 or more weeks in this range!\n            }\n</code></pre>\n\n<p>for example in week 40 there are in total 24 DeployedPlanned hours. This is not higher than 40 so its OK.</p>\n\n<p><a href=\"http://imageshack.us/photo/my-images/513/tableresourceplanning.png/\" rel=\"nofollow\">http://imageshack.us/photo/my-images/513/tableresourceplanning.png/</a></p>\n"},{"tags":["linq","datagridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12801478,"title":"linq and datagridview","body":"<p>why does the following show only the length of the fields inside the grid and not the data?\n(column header in grid is also length)</p>\n\n<pre><code>dim q as IQueryable = (from p in DB.Table select p.field1)\n</code></pre>\n\n<p>while this shows both columns and tha data</p>\n\n<pre><code>dim q as IQueryable = (from p in DB.Table select p.field1, p.field2)\n</code></pre>\n\n<p>both fields are strings</p>\n\n<p>thanks in advance</p>\n"},{"tags":["mysql","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12750624,"title":"Entity Framwork Linq query returning incorrect value for mysql database","body":"<p>I have a Query:</p>\n\n<pre><code>    var cams = (from c in db.cameras\n                        join s in db.camera_sites on c.camera_site_id equals s.id\n                        join o in db.servers on s.server_id equals o.id\n                        where (c.enabled == \"yes\"\n                        &amp;&amp; s.enabled == \"yes\"\n                        &amp;&amp; o.enabled == \"yes\" \n                        &amp;&amp; o.type == \"hosted\"\n                        &amp;&amp; o.server_method == \"webservices\"\n                        &amp;&amp; c.account_id == accountId)\n                        select new EventCamera_Named { Camera = c, SiteName = s.name, ServerName = o.name }).ToList();\n</code></pre>\n\n<p>The problem is the SiteName that is selected is the same as Camera.name</p>\n\n<p>The sql that is generated is:</p>\n\n<pre><code>    SELECT\n    `Filter1`.`id`, \n    `Filter1`.`account_id`, \n    `Filter1`.`camera_site_id`, \n    `Filter1`.`enabled`, \n    `Filter1`.`name`, \n    ...,\n    `Filter1`.`name` AS `name1`, \n    `Extent3`.`name` AS `name2`\n\n    FROM (SELECT\n    `Extent1`.`id`, \n    `Extent1`.`account_id`, \n    `Extent1`.`camera_site_id`, \n    `Extent1`.`enabled`, \n    `Extent1`.`name`, \n    ..., \n    `Extent2`.`id` AS `id1`, \n    `Extent2`.`account_id` AS `account_id1`, \n    `Extent2`.`server_id`, \n    ...\n    FROM `cameras` AS `Extent1` INNER JOIN `camera_sites` AS `Extent2` ON `Extent1`.`camera_site_id` = `Extent2`.`id`\n    WHERE ('yes' = `Extent1`.`enabled`) AND ('yes' = `Extent2`.`enabled`)) AS `Filter1` INNER JOIN `servers` AS `Extent3` ON `Filter1`.`server_id` = `Extent3`.`id`\n    WHERE ((('yes' = `Extent3`.`enabled`) AND ('hosted' = `Extent3`.`type`)) AND ('webservices' = `Extent3`.`server_method`)) AND (`Filter1`.`account_id` = 39884476)\n</code></pre>\n\n<p>How can I rewrite my query return the correct values and what is causing it to get confused?</p>\n"},{"tags":[".net","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12796700,"title":"Select required include tables in Entity Framework","body":"<p>I am working with EF on a normalised database.</p>\n\n<p>For my Offers entity I have the following table structure:</p>\n\n<h2>Offers</h2>\n\n<p>plus either:</p>\n\n<h2>PostType</h2>\n\n<p>Offers_SitePost or Offers_CommunityPost</p>\n\n<p>plus either:</p>\n\n<h2>OfferType</h2>\n\n<p>Offers_VoucherCode or Offers_Deal or Offers_Sale</p>\n\n<p>So a complete offer will be made up of a definite entry in Offers plus an entry in one of the PostType tables and an entry in one of the OfferType tables.</p>\n\n<p>I know from the offers table, which of the other tables should contain data. I'm using properties like IsSitePost to do this.</p>\n\n<p>I'm trying to work out the best way of getting just the necessary data, for both a single offer and a list of offers. Obviously I can include all tables but I doubt this will work out to be the most efficient.</p>\n\n<p>Here's the code I'm working on for a single offer:</p>\n\n<pre><code>    public static Offer GetById2(int ID)\n    {\n        ID.ThrowDefault(\"ID\");\n\n        var r = new CrudRepo&lt;Offer&gt;(Local.Items.Uow.Context);\n\n        var offer = r.Find(o =&gt; o.OfferId == ID);\n\n        // if is site post Include(\"SiteOffers\")\n        // else is community post Include(\"CommunityOffers\") etc\n\n        return offer.SingleOrDefault();\n    }\n</code></pre>\n\n<p>Can anyone offer advice as to the best way of achieving this?</p>\n"},{"tags":["c#","linq","list","ado.net","generic-list"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":55,"score":-1,"question_id":12788026,"title":"Implement list of objects to be deleted in database","body":"<p>I have a form with few tabs, and in each tab an grid control. When user select a row to be deleted i want to remove it from the grid, and if the object exist in the database remove it too, but not permanent - only if and when user clicks save on form.</p>\n\n<p>For now, if object doesn't exist in db i remove it from the list, and if objects exist in db i delete it from db and remove it from the list. But, if user clicks Cancel button he expects row/s not to be deleted from database.</p>\n\n<p>I have two possible solutions on my mind: 1) - remove object from list, and if objects exist in db add it to the list of objects to be deleted 2) - implement another list, getter will return only objects with state != ToBeDeleted (performance?)</p>\n\n<p>Note: i'm not using ORM tool, working with my own ado.net based data access framework.</p>\n"},{"tags":["linq","c#-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12794862,"title":"linq return wrong result","body":"<p>I create linq query where display result from 2 table. Where table 1 is main table and table 2 is child table below are the linq query</p>\n\n<pre><code>var data = from k in main.v_promo_countries\n           where k.cd == cd //passing parameter\n           select new\n           {\n              promoid = k.id,\n              des = k.destination,\n              o_des = k.origin_country,\n              c_f = k.conn_flg,\n              price = from pro in main.tbl_promotion_pricings\n                      where pro.promotion_id == k.id\n                      select new\n                      {\n                         mid = k.id,\n                         id = pro.promotion_id, \n                         currency = pro.currency_cd,\n                         amount = pro.amount\n                       }\n           };\n</code></pre>\n\n<p>the result return with main table id not same as child id. \nWhats wrong?</p>\n\n<p>sample result on json format</p>\n\n<pre><code>  \"promoid\": \"D096F78B-6931-4525-8578-6B23A9564EDF\",\n  \"des\": \"KUL\",\n  \"o_des\": \"np\",\n  \"c_f\": \"N\",\n  \"price\": [\n    {\n      \"mid\": \"D096F78B-6931-4525-8578-6B23A9564EDF\",\n      \"id\": \"D096F78B-6931-4525-8578-6B23A9564EDF\",\n      \"currency\": \"P-AU$\",\n      \"amount\": -1.0000\n    },\n    {\n      \"mid\": \"D096F78B-6931-4525-8578-6B23A9564EDF\",\n      \"id\": \"D096F78B-6931-4525-8578-6B23A9564EDF\",\n      \"currency\": \"P-RM\",\n      \"amount\": -1.0000\n    },\n    {\n      \"mid\": \"CB7734E7-07D0-4E2A-908F-6C8D6EBD8B95\",\n      \"id\": \"CB7734E7-07D0-4E2A-908F-6C8D6EBD8B95\",\n      \"currency\": \"AU$\",\n      \"amount\": 82.0000\n    },\n    {\n      \"mid\": \"C9377266-8DCD-4DB4-8FCE-CA1632935DC5\",\n      \"id\": \"C9377266-8DCD-4DB4-8FCE-CA1632935DC5\",\n      \"currency\": \"USD\",\n      \"amount\": 55.0000\n    }]\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12800846,"title":"Nested parent child lists where order by doesn't work","body":"<p>I have the following code:</p>\n\n<pre><code>public class Navigation\n{\n    public Navigation()\n    {\n        SubNavigation = new List&lt;Navigation&gt;();\n    }\n\n    public int Order { get; set; }\n    public string Text { get; set; }\n    public string RouteName { get; set; }\n    public IList&lt;Navigation&gt; SubNavigation { get; set; }\n}\n</code></pre>\n\n<p>I then have:</p>\n\n<pre><code>IList&lt;Navigation&gt; list = new List&lt;Navigation&gt;(); \n</code></pre>\n\n<p>I populate the list with some data. Not all items have a sub navigation. Currently the navigation only goes one level deep.</p>\n\n<p>Now I would like to sort both the navigation and the sub-navigation for each item by order. I have tried all kinds of approaches but no matter what I tried I could not get the sub-navigation to sort without re-creating the object. The below code works:</p>\n\n<pre><code>IList&lt;Navigation&gt; result = list.OrderBy(l =&gt; l.Order)\n                               .Select(n =&gt; new Navigation\n                               {\n                                   Order = n.Order,\n                                   Text = n.Text,\n                                   RouteName = n.RouteName,\n                                   SubNavigation = n.SubNavigation.OrderBy(s =&gt; s.Order).ToList()\n                               }).ToList();\n</code></pre>\n\n<p>I am not in love with this approach and my question is if there is any cleaner/better way of doing this using LINQ and the method syntax?</p>\n"},{"tags":["linq","entity-framework",".net-3.5","linq-to-entities"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":11871,"score":5,"question_id":690248,"title":"Updating your edmx to reflect changes made in your db (.net linq-to-entities)","body":"<ul>\n<li>So I have my edmx made.  </li>\n<li>Then I change my database a little bit, changing a column to from being a NOT NULL to allowing NULL.</li>\n<li>I go into my edmx, right click and choose \"Update Model from Database\"</li>\n</ul>\n\n<p>Now I go into my program and it hasnt actually updated... I can't put a null in the column.  What do I have to do to update the edmx properly?  Thank you.</p>\n"},{"tags":[".net","database","linq","object"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":4773227,"title":".NET Object Database of Specific Features","body":"<p>Anybody knows of a .NET object database that has the following:</p>\n\n<ol>\n<li>embedded thread-safe\ntransactional ACID operations\n(read/write/delete)</li>\n<li>full LINQ support (and better PLINQ\nas well)</li>\n<li>transparent lazy fetching of referenced\nobjects (no need to inherent or implement anything)</li>\n<li>indexing, advanced strings and collections/generics\nbuilt-in support</li>\n<li>clean/modern API actively developed</li>\n</ol>\n"},{"tags":["linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12799079,"title":"Using LINQ with wildcard characters without using SqlMethods","body":"<p>I need to match certain string with wildcards, pretty much like with SQL LIKE. While there are similar questions on this topic, I am using Unity3D and while its Mono.NET library has LINQ, it doesn't have SqlMethods.</p>\n\n<p>I would need to a way to emulate all the wild card characters. So <code>'*MSB'</code> should be able to match EastMSB, WestMSB, and <code>DB0?-??</code> should match 'DB01-11', 'DB01-07' and etc. </p>\n"},{"tags":["c#",".net","arrays","linq","list"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":3201,"score":4,"question_id":629178,"title":"Conversion from List<T> to array T[]","body":"<p>Is there a short way of converting a strongly typed <code>List&lt;T&gt;</code> to an Array of the same type, e.g.: <code>List&lt;MyClass&gt;</code> to <code>MyClass[]</code>?</p>\n\n<p>By short i mean one method call, or at least shorter than:</p>\n\n<pre><code>MyClass[] myArray = new MyClass[list.Count];\nint i = 0;\nforeach (MyClass myClass in list)\n{\n    myArray[i] = myClass;\n}\n</code></pre>\n"},{"tags":["c#","linq","asp.net-mvc-4"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":78,"score":-2,"question_id":12421429,"title":"Upcasting an IEnumerable<object> in controller?","body":"<p>I'm using a repository for my models like this</p>\n\n<pre><code>public IEnumerable&lt;object&gt; GetDetailList(int userId, int page, int rp, string sortname, string sortorder, ref int num, ref int numpg)\n{\n    var details = (from access in context.erp_sec_companyaccesses\n                   join company in context.erp_maint_companies on Convert.ToInt32(access.company_id) equals company.company_id\n                   where access.user_id == userId\n                   select new\n                   {\n                       pkey = access.company_access_id,\n                       company_access_id = access.company_access_id,\n                       company_code = company.company_code,\n                       company_name = company.company_name,\n                       company_id = company.company_id\n                   });\n\n    num = details.Count();\n    numpg = (int)Math.Ceiling((float)(num / rp));\n\n    details = details.OrderBy(sortname+\" \"+sortorder).Skip(page * rp).Take(rp);\n\n    return details;\n}\n</code></pre>\n\n<p>But I'm struggling to upcast the <code>IEnumerable&lt;object&gt;</code> returned to the controller. Is there any alternative than this ?</p>\n\n<p>Update : I give up up-casting, I'll send a typed object instead of anonymous, thanks everybody</p>\n"},{"tags":["c#","linq"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":1,"view_count":49,"score":0,"question_id":12798439,"title":"Dynamic LINQ OrderBy with dynamic call of methods","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12778560/dynamic-linq-orderby-method-count\">Dynamic LINQ OrderBy + Method Count</a>  </p>\n</blockquote>\n\n\n\n<p>I'm displaying a table of objects <strong>Company</strong> in a webpage and I am using a Dynamic Linq OrderBy to sort them on each property.\nI'm using this code <a href=\"http://stackoverflow.com/a/233505/265122\">http://stackoverflow.com/a/233505/265122</a></p>\n\n<pre><code>public static IOrderedQueryable&lt;T&gt; OrderBy&lt;T&gt;(this IQueryable&lt;T&gt; source, string property)\n{\n    return ApplyOrder&lt;T&gt;(source, property, \"OrderBy\");\n}\npublic static IOrderedQueryable&lt;T&gt; OrderByDescending&lt;T&gt;(this IQueryable&lt;T&gt; source, string property)\n{\n    return ApplyOrder&lt;T&gt;(source, property, \"OrderByDescending\");\n}\npublic static IOrderedQueryable&lt;T&gt; ThenBy&lt;T&gt;(this IOrderedQueryable&lt;T&gt; source, string property)\n{\n    return ApplyOrder&lt;T&gt;(source, property, \"ThenBy\");\n}\npublic static IOrderedQueryable&lt;T&gt; ThenByDescending&lt;T&gt;(this IOrderedQueryable&lt;T&gt; source, string property)\n{\n    return ApplyOrder&lt;T&gt;(source, property, \"ThenByDescending\");\n}\nstatic IOrderedQueryable&lt;T&gt; ApplyOrder&lt;T&gt;(IQueryable&lt;T&gt; source, string property, string methodName) {\n    string[] props = property.Split('.');\n    Type type = typeof(T);\n    ParameterExpression arg = Expression.Parameter(type, \"x\");\n    Expression expr = arg;\n    foreach(string prop in props) {\n        // use reflection (not ComponentModel) to mirror LINQ\n        PropertyInfo pi = type.GetProperty(prop);\n        expr = Expression.Property(expr, pi);\n        type = pi.PropertyType;\n    }\n    Type delegateType = typeof(Func&lt;,&gt;).MakeGenericType(typeof(T), type);\n    LambdaExpression lambda = Expression.Lambda(delegateType, expr, arg);\n\n    object result = typeof(Queryable).GetMethods().Single(\n            method =&gt; method.Name == methodName\n                    &amp;&amp; method.IsGenericMethodDefinition\n                    &amp;&amp; method.GetGenericArguments().Length == 2\n                    &amp;&amp; method.GetParameters().Length == 2)\n            .MakeGenericMethod(typeof(T), type)\n            .Invoke(null, new object[] {source, lambda});\n    return (IOrderedQueryable&lt;T&gt;)result;\n}\n</code></pre>\n\n<p>It's great but I would also like to sort the companies on the number of employees.</p>\n\n<p>Like this : <strong>query.OrderBy(\"Employees.Count\")</strong></p>\n\n<p>I tried to call to the Count method dynamically without any success so far.</p>\n\n<p>I modified the code like this :</p>\n\n<pre><code>foreach(string prop in props)\n{\n    if (prop == \"Count\")\n    {\n        var countMethod = (typeof(Enumerable)).GetMethods().First(m =&gt; m.Name == \"Count\").MakeGenericMethod(type);\n        expr = Expression.Call(countMethod, expr);\n        break;\n    }\n\n    // Use reflection (not ComponentModel) to mirror LINQ.\n    PropertyInfo pi = type.GetProperty(prop);\n    expr = Expression.Property(expr, pi);\n    type = pi.PropertyType;\n}\n</code></pre>\n\n<p>But I have an exception on the <code>expr = Expression.Call(countMethod, expr);</code></p>\n\n<p>The exception is:</p>\n\n<pre><code>ArgumentException\nExpression of type 'System.Collections.Generic.ICollection`1[Employee]'\ncannot be used for parameter of type\n'System.Collections.Generic.IEnumerable`1[System.Collections.Generic.ICollection`1\n[Employee]]' of method 'Int32 Count[ICollection`1]\nSystem.Collections.Generic.IEnumerable`1[System.Collections.Generic.ICollection`1\nEmployee]])'\n</code></pre>\n\n<p>Any idea on how to achieve that?</p>\n"},{"tags":["c#","xml","linq","c#-4.0"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":124,"score":1,"question_id":12795803,"title":"Null reference exception in Linq","body":"<p>I am .net beginner. I have gone through many sites before asking here. I am getting error -- \"Object reference not set to an instance of an object.\"  .This error comes usually when there are null values in any control but in my case Every control has some text in them, then why this error coming?  here is my <a href=\"http://ideone.com/OnpgJ\" rel=\"nofollow\">xml file</a></p>\n\n<pre><code>cmbProduct        --&gt; combobox \ntxtNewBrand       --&gt; textBox\ntxtUpdateQuantity --&gt; textBox\ntxtUpdatePrice    --&gt; textBox\n</code></pre>\n\n<p>I tried the below code:</p>\n\n<p><strong>onButtonClick</strong>    </p>\n\n<pre><code>XElement doc = XElement.Load(@\"..\\..\\stock.xml\");\nvar newElement = new XElement(\"items\",\n                               new XElement(\"productname\", cmbProduct.Text),\n                               new XElement(\"brandname\", txtNewBrand.Text),\n                               new XElement(\"quantity\", txtUpdateQuantity.Text),\n                               new XElement(\"price\", txtUpdatePrice.Text));\n /*ERROR*/      doc.Element(\"stock\").Add(newElement);\n                doc.Save(xpath);\n                MessageBox.Show(\"updated successfully\");\n</code></pre>\n\n<p>EDIT : </p>\n\n<p><em>Instead of using</em> </p>\n\n<pre><code>XElement doc = XElement.Load(@\"..\\..\\stock.xml\");\n</code></pre>\n\n<p>i used </p>\n\n<pre><code>var doc = XDocument.Load(@\"..\\..\\stock.xml\");\n</code></pre>\n\n<p>and the problem solved. why so?</p>\n"},{"tags":["c#","linq","list"],"answer_count":3,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":217,"score":7,"question_id":12795882,"title":"Quickest way to compare two List<>","body":"<p>What is the quickest (and least resource intensive) to compare two massive (>50.000 items) and as a result have two lists like the ones below:</p>\n\n<ol>\n<li>items that show up in the first list but not in the second</li>\n<li>items that show up in the second list but not in the first</li>\n</ol>\n\n<p>Currently I'm working with the List or IReadOnlyCollection and solve this issue in a linq query:</p>\n\n<pre><code>var list1 = list.Where(i =&gt; !list2.Contains(i)).ToList();\nvar list2 = list2.Where(i =&gt; !list.Contains(i)).ToList();\n</code></pre>\n\n<p>But this doesn't perform as good as i would like.\nAny idea of making this quicker and less resource intensive as i need to process a lot of lists?</p>\n"},{"tags":["asp.net-mvc-3","linq","list"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12795989,"title":"How to show a particular post for the logged in user in a simple blog site?","body":"<p>The scenario is, I have simple Post table with just title &amp; story. after posting a new post I want to show the post using my view page.I have write the method to display the post as follows: </p>\n\n<pre><code>  \\\\Post is the class name &amp; item is the obj to bind it from the view form.\npublic List&lt;Post&gt; ViewPost(Post item)\n    {\n        using(var context=new TourBlogEntities1())\n        {\n            var post= from s in context.Posts\n                      where s.PostID=item.PostID //showing error here.\n                      select s;\n\n            return post.ToList&lt;Post&gt;();\n        }\n    }\n</code></pre>\n\n<p>I'm getting an error saying 'can't convert the lambada expression to type string because its not a delegate type'.</p>\n\n<p>Whats need to be done? some more information would also be helpfull, like I have a field name userid in post table, which I want to fill automatically by using the logging info. How can I do that?  Thanks.</p>\n"},{"tags":["linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":104,"score":1,"question_id":12788425,"title":"Cannot implicitly convert type 'System.Linq.IQueryable to System.Data.Entity.DbSet","body":"<p>I am getting the followng error:</p>\n\n<p>Cannot implicitly convert type 'System.Linq.IQueryable' to 'System.Data.Entity.DbSet'. An explicit conversion exists (are you missing a cast?)     </p>\n\n<p>I have the following code:</p>\n\n<pre><code>        var reports = dbContext.Product;\n\n        if (searchField == \"StoreNum\")\n        {\n            int storeNum;\n            int? stnum = int.TryParse(searchString, out storeNum) ? storeNum : (int?)null;\n\n           reports = dbContext.Product\n                     .Where(w =&gt; w.StoreNum == stnum); // error occurs here when I try to build\n\n        }\n</code></pre>\n\n<p>Cannot understand why I am getting this message.</p>\n"},{"tags":["c#","linq","default","nullable"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":523,"score":3,"question_id":5088682,"title":"Howto change what Default(T) returns in C#","body":"<p>I would like to change how Default(T) behaves for certain classes. So instead of returning null for my reference types I would like to return a Null object.</p>\n\n<p>Kind of like</p>\n\n<pre><code>kids.Clear();\nvar kid = kids.Where(k =&gt; k.Age &lt; 10).SingleOrDefault(); \n\nif (kid is NullKid)\n{\n  Console.Out.WriteLine(\"Jippeie\");\n}\n</code></pre>\n\n<p>Anyone know if this is at all possible?</p>\n"},{"tags":["xml","linq","xpath"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":3068053,"title":"What's wrong with this XPath?","body":"<p>I have this XML:</p>\n\n<pre><code>&lt;rootCategories&gt;\n    &lt;category id=\"1\"&gt;\n        &lt;category id=\"2\"&gt;\n            &lt;category id=\"3\"&gt;\n                &lt;category id=\"4\" /&gt;\n                &lt;category id=\"5\" /&gt;\n                &lt;category id=\"6\" /&gt;\n            &lt;/category&gt;\n            &lt;category id=\"7\" /&gt;\n        &lt;/category&gt;\n    &lt;/category&gt;\n&lt;/rootCategories&gt;\n</code></pre>\n\n<p>And I have this LINQ statement:</p>\n\n<pre><code>int count = doc.XPathSelectElements(\"//category\").Elements().Count();\n</code></pre>\n\n<p>What I want is all of the \"category\" elements, basicaly, flattened into an array I can then foreach over.</p>\n\n<p>The problem is that the count value returned (and, if that is knocked off, the array returned) shows that the top-most category elements are not being returned. In this case I'm getting 6 \"category\" elements returned, not 7.</p>\n\n<p>I was using the XPath learnt from [this page](\n<a href=\"http://www.developer.com/xml/article.php/10929_3383961_1/NET-and-XML-XPath-Queries.htm\" rel=\"nofollow\">http://www.developer.com/xml/article.php/10929_3383961_1/NET-and-XML-XPath-Queries.htm</a>).</p>\n\n<p>Could someone tell me why and how to fix this please?  Is it something wrong in the XPath query?</p>\n"},{"tags":["xml","linq","mvc","sorting"],"answer_count":1,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":3346,"score":5,"question_id":2208844,"title":"How to sort XML in LINQ C# by an attribute value? Also MVC","body":"<p>(Using the latest MVC 2 RC 2) I'm trying to sort some XML in LINQ (C#) by an element's attribute's value...</p>\n\n<pre><code>var sites = from s in xDoc.Element(\"sites\").Elements(\"site\")\norderby s.Attribute(\"name\")\nselect s;\n</code></pre>\n\n<p>But when I pass this to my View I get the exception:</p>\n\n<pre><code>Exception Details: System.ArgumentException: At least one object must implement IComparable.\nSource Error: \nLine 37:                &lt;/th&gt;\nLine 38:            &lt;/tr&gt;\nLine 39:            &lt;% foreach (var item in Model)\nLine 40:               { %&gt;\nLine 41:            &lt;tr&gt;\n</code></pre>\n\n<p>Can someone tell me how to sort XML using LINQ and have it render properly?</p>\n"},{"tags":["c#","linq","select","checkboxlist"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1355,"score":1,"question_id":3501412,"title":"Dynamically adding select fields using LINQ lambda","body":"<p>Lets say we have an expression:</p>\n\n<pre><code>var prices = from p in PriceDB.Prices\n             where p.TypeID == 12\n             orderby p.PriceType.Title\n             select p;\n</code></pre>\n\n<p>Is it possible to modify the select list?</p>\n\n<p>I imagine it looking something like this:</p>\n\n<pre><code>var newPriceList = prices.Select( p =&gt; p.ExchangeRate );\n</code></pre>\n\n<p>This may be an odd request, but in my code (which is too long and complex to post here) I want to conditionally add fields to be output depending on a CheckBoxList.</p>\n\n<p>I assume, of course, that I'm trying to go about this the wrong way...</p>\n"},{"tags":["c#","xml","linq","attributes","element"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":367,"score":1,"question_id":2454390,"title":"How to add attributes to an element using LINQ, C#?","body":"<p>I have an XElement object which has a number of attributes and I simply want to add another attribute to the element.</p>\n\n<p>How do I do this?</p>\n"},{"tags":[".net","linq","expression","expression-trees","linq-expressions"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":240,"score":0,"question_id":2264050,"title":"WhereNot linq expression","body":"<p>I am trying to create an extension \"WhereNot\"</p>\n\n<p>So I can use:</p>\n\n<pre><code>Dim x = \"Hello world \"\nDim y = x.Split.WhereNot(AddressOf String.IsNullOrEmpty)\n</code></pre>\n\n<p>Note that my aim here is to learn linq expressions; not solve my issue.</p>\n\n<p>I craated this function:</p>\n\n<pre><code> &lt;Extension()&gt; _\n Public Function WhereNot(Of TElement)(ByVal source As IQueryable(Of TElement), ByVal selector As Expression(Of Func(Of TElement, Boolean))) As IQueryable(Of TElement)\n  Return source.Where(GetWhereNotExpression(selector))\n End Function\n</code></pre>\n\n<p>I don't know how to switch the boolean flag, will the function Negate do it?</p>\n\n<p>answers in both vb.net and C# are welcommed</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12788965,"title":"Conditional Operator (?:) without return value","body":"<p>First off, I'm just starting to mess around with LINQ, and I don't really understand it.</p>\n\n<p>Anyways, what I'm trying to do is add to a List with LINQ and the .Where statement.</p>\n\n<p>This is what I've tried:</p>\n\n<pre><code>List&lt;object&gt; FirstList = new List&lt;object&gt;();\nList&lt;object&gt; SecondList = new List&lt;object&gt;();\nListener.Clients.Where(x =&gt; (x.Value.Authenticated) ? FirstList.Add(x.Value.UserID) : SecondList.Add(x.Value.UserID));\n</code></pre>\n\n<p>Listener is a socket wrapper class, and Clients is an array of a class, Client.</p>\n\n<p>In that Client class there are a few values that I need, and I want to check if that client is authenticated (logged in), and if it is, add it to the first list, and if it's not, add it to the second list, however it seems that the ?: operator must have a return value, but adding to a list does not return anything.</p>\n\n<p>I hope I explained that good; I'm not the best with words.</p>\n"},{"tags":["sql","sql-server","linq","linq-to-sql","left-join"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12747476,"title":"Extra subquery generated on left join","body":"<p>I wrote a method to perform a left join in LINQ, using the standard <code>GroupJoin</code>/<code>SelectMany</code>/<code>DefaultIfEmpty</code> approach:</p>\n\n<pre><code>public static IQueryable&lt;TResult&gt; LeftJoin&lt;TLeft, TRight, TKey, TResult&gt;(\n    this IQueryable&lt;TLeft&gt; left,\n    IEnumerable&lt;TRight&gt; right,\n    Expression&lt;Func&lt;TLeft, TKey&gt;&gt; leftKeySelector,\n    Expression&lt;Func&lt;TRight, TKey&gt;&gt; rightKeySelector,\n    Expression&lt;Func&lt;TLeft, TRight, TResult&gt;&gt; resultSelector)\n{\n    var paramL = Expression.Parameter(typeof(TLeft), \"l\");\n    var paramR = Expression.Parameter(typeof(TRight), \"r\");\n    var paramRs = Expression.Parameter(typeof(IEnumerable&lt;TRight&gt;), \"rs\");\n\n    var expr = Expression.Lambda&lt;Func&lt;TLeft, IEnumerable&lt;TRight&gt;, IEnumerable&lt;TResult&gt;&gt;&gt;(\n       Expression.Call(\n           typeof(Enumerable),\n           \"Select\",\n           new [] { typeof(TRight), typeof(TResult) },\n           Expression.Call(typeof(Enumerable), \"DefaultIfEmpty\", new[] { typeof(TRight) }, paramRs),\n           Expression.Lambda&lt;Func&lt;TRight, TResult&gt;&gt;(\n               Expression.Invoke(resultSelector, paramL, paramR),\n               paramR)),\n       paramL,\n       paramRs\n   );\n\n    return left\n        .GroupJoin(\n            right,\n            leftKeySelector,\n            rightKeySelector,\n            expr)\n        .SelectMany(x =&gt; x);\n}\n</code></pre>\n\n<p>I tested it thus:</p>\n\n<pre><code>var q = myDB.PurchaseOrderHeaders\n    .LeftJoin(\n        myDB.PurchaseOrderLines,\n        po =&gt; po.PurchaseOrderGUID,\n        line =&gt; line.PurchaseOrderGUID,\n        (po, line) =&gt; new { PO = po, Line = line }\n    );\n\nvar e = q.AsEnumerable();\n</code></pre>\n\n<p>I expected SQL like this:</p>\n\n<pre><code>SELECT [t0].[PurchaseOrderGUID], ..., [t1].[PurchaseOrderLineGUID], ...\nFROM [dbo].[PurchaseOrderHeader] AS [t0]\nLEFT OUTER JOIN [dbo].[PurchaseOrderLine] AS [t1]\n    ON [t0].[PurchaseOrderGUID] = [t1].[PurchaseOrderGUID]\n</code></pre>\n\n<p>But got this:</p>\n\n<pre><code>SELECT [t0].[PurchaseOrderGUID], ..., [t2].[test], [t2].[PurchaseOrderLineGUID], ...\nFROM [dbo].[PurchaseOrderHeader] AS [t0]\nLEFT OUTER JOIN (\n    SELECT 1 AS [test], [t1].[PurchaseOrderLineGUID], ...\n    FROM [dbo].[PurchaseOrderLine] AS [t1]\n    ) AS [t2] ON [t0].[PurchaseOrderGUID] = [t2].[PurchaseOrderGUID]\n</code></pre>\n\n<p>The difference is the subquery with <code>SELECT 1 as [test]</code>. Why is it generating this? Is it likely to have any significant effect on performance? If so, can I modify the query to eliminate it?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":1588050,"title":"What is the way to apply extension methods?","body":"<p>When attempting to solve the problem</p>\n\n<blockquote>\n  <p>How many seven-element subsets (not repeatable) are there in a set of nine elements ?</p>\n</blockquote>\n\n<p>I tried </p>\n\n<pre><code>IEnumerable&lt;string&gt; NineSet =new string[] {\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\"};\n\nvar SevenSet = \nfrom first in NineSet\nfrom second in NineSet\nwhere first.CompareTo(second)&lt; 0 &amp;&amp; first.Count() + second.Count()==7\nselect new { first, second };\n</code></pre>\n\n<p>What is the problem that prevents me from attempting to use <code>first.Count()</code> and <code>second.Count()</code>?  I did not check whether it is the best solution for the problem.</p>\n"},{"tags":["c#","xml","linq","entity-framework","import"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12788207,"title":"Reading in XML/KML files using C#","body":"<p>I'm trying to import the kml xml Google earth file into an application, but i can't seem to get the xDocument syntax right in order to do what i want, i'm wondering if anyone could suggest a way to read in the kml xml file.</p>\n\n<p>I understand the basics of xml import but can't get anything working with xDocument and Linq, ideally i'd like to get each Placemark as an object and add them to my Entity Framework driven db. Any suggestions as to how i should do this would be great, as i'm just starting out with Linq and could do with some pointers. The xml is laid out as below</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;kml xmlns=\"http://earth.google.com/kml/2.2\"&gt;\n  &lt;Document&gt;\n    &lt;Placemark&gt;\n      &lt;name&gt;XXX&lt;/name&gt;\n      &lt;description&gt;XXX&lt;/description&gt;\n      &lt;styleUrl&gt;XXX&lt;/styleUrl&gt;\n      &lt;Point&gt;\n         &lt;coordinates&gt;XXX&lt;/coordinates&gt;\n      &lt;/Point&gt;\n    &lt;/Placemark&gt;\n    &lt;Placemark&gt;\n      &lt;name&gt;XXX&lt;/name&gt;\n      &lt;description&gt;XXX&lt;/description&gt;\n      &lt;styleUrl&gt;XXX&lt;/styleUrl&gt;\n      &lt;Point&gt;\n         &lt;coordinates&gt;XXX&lt;/coordinates&gt;\n      &lt;/Point&gt;\n    &lt;/Placemark&gt;\n  &lt;/Document&gt;\n&lt;/kml&gt;\n</code></pre>\n"},{"tags":["linq","entity-framework","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12773989,"title":"\"An object with the same key already exists in the ObjectStateManager\" on Entity.Attach","body":"<p>I am using Entity Framework Code first my classes are</p>\n\n<pre><code>[Serializable]\n    public class Emp\n    {\n        public int EmpId { get; set; }\n        public byte TitleId { get; set; }\n        [MaxLength(50)]\n        public string FirstName { get; set; }\n        [MaxLength(50)]\n        public string Surname { get; set; }\n        public byte Type { get; set; }\n\n        public List&lt;PracticeEmp&gt; PracticeEmps { get; set; }\n    }\n\n[Serializable]\n    public class PracticeEmp\n    {\n        public int PracticeStaffId { get; set; }\n        public int PracticeId { get; set; }\n        public int EmpId { get; set; }\n        public DateTime? StartDate { get; set; }\n        public DateTime? EndDate { get; set; }\n\n        public Emp Emp { get; set; }\n    }\n</code></pre>\n\n<p>when I am trying to insert data into PracticeEmps table for a staff which already exists I use the following code</p>\n\n<pre><code>Db.Current.Emps.Attach(practiceEmp.Emp);\nDb.Current.PracticeEmps.Add(practiceEmp);\n</code></pre>\n\n<p>This code segment returns an error on attach method \"An object with the same key already exists in the ObjectStateManager. The ObjectStateManager cannot track multiple objects with the same key.\"</p>\n\n<p>any Ideas...</p>\n"},{"tags":["xml","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12786673,"title":"C# Create xml from Scratch","body":"<p>I know this is probably an easy question, but im having trouble just creating an xml file that will only create its root\n        \n        </p>\n\n<p>i Have the following code but it doesnt work</p>\n\n<pre><code>        XDocument products = new XDocument(\n    new XDeclaration(\"1.0\", \"utf-8\", \"\"),\n      new XElement(\"Users\",\n\n      )\n    );\n        products.Save(\"hello.xml\");\n</code></pre>\n"},{"tags":["c#","linq","generics","optimization"],"answer_count":7,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":89,"score":3,"question_id":12738182,"title":"Generic List Performance Optimization","body":"<p>I am trying to optimize generic lists arithmetic operation. I have 3 lists of nullable double as defined below.</p>\n\n<pre><code>List&lt;double?&gt; list1 = new List&lt;double?&gt;();\nList&lt;double?&gt; list2 = new List&lt;double?&gt;();\nList&lt;double?&gt; listResult = new List&lt;double?&gt;();\n\nint recordCount = list1.Count &gt; list2.Count ? list2.Count : list1.Count;\n\nfor (int index = 0; index &lt; recordCount; index++)\n{\n      double? result = list1[index] + list2[index];\n      listResult.Add(result);\n}\n</code></pre>\n\n<p>Is there any way to make this operation to run faster if I have huge lists?</p>\n\n<p>Thanks for your input.</p>\n"},{"tags":["c#","linq","entity-framework-4.1"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":12786298,"title":"I have loaded Excel files into .NET using LINQ, now how to bulk insert data into DB (oracle) tables?","body":"<pre><code>var ex = new ExcelQueryFactory(@\"c:\\test.xls\");\nvar data = from c in ex.Worksheet&lt;testClass&gt;(\"Sheet 1\")\n           select c;\n</code></pre>\n\n<p>I have added a data connection to Oracle Database.\nIs there a straight forward way to bulk insert this data?</p>\n\n<p>P.S. \nI am a beginner in .NET 4 learning, have gone through other links talking about bulk insert but somehow cannot connect.\nThis is a windows form, where I read excel files on click of a button.</p>\n"},{"tags":["vb.net","linq","system.data"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":114,"score":2,"question_id":12659518,"title":"How can i copy data table records of different field name based on mapping list evaluating condition on source data table?","body":"<p>I have a Source Data table of type System.Data.DataTable from which i have to generate Destination Data Table of mapped column(Consider same SqlDBType for mapped columns.)</p>\n\n<p>I have a list of MappingInfo class in which each Source Datatable Column mapped with New Column Name which will be in destination data table.</p>\n\n<pre><code>Public Class MappingInfo\n\n    Public Property SourceFieldName As String\n    Public Property DestinationFieldName As String\n\nEnd Class\n</code></pre>\n\n<p>I have to evaluate a condition in source datatable to allow row data copy in destination table.</p>\n\n<p>I did this using following code snippet:</p>\n\n<pre><code>''Prepare destination table.\n\nFor Each oMapping In oMappingInfo  \n\n            DestinationDataTable.Columns.Add( _\n                New DataColumn(oMapping.DestinationFieldName))\n        Next\n\n        For Each oRow In SourceDataTable.Rows   ''Copy data.\n            If oRow(\"IsActive\") Then\n                oDataRow = DestinationDataTable.NewRow\n                For Each oMapping In oMappingInfo\n                    oDataRow(oMapping.DestinationFieldName) = _\n                        oRow(oMapping.SourceFieldName)\n                Next\n                DestinationDataTable.Rows.Add(oDataRow)\n            End If\n        Next\n</code></pre>\n\n<p>The main drawback is that here i have minimum 40k records in source datatable and data is not possible to fetch from database as all changes with data committed only when user save his work. The generated destination table is been assigned as data source to grid control  and to report for preview. </p>\n\n<p>How can i achieve this efficiently using Linq or do anyone please suggest me best way to achieve this requirement.</p>\n"},{"tags":["json","asp.net-mvc-3","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12785598,"title":"string linq to entities error - json","body":"<p>I am trying to map various markers on google map with a info window. It is all working fine till I try to pass a string through the controller.</p>\n\n<p>I get the error below:</p>\n\n<blockquote>\n  <p>\"LINQ to Entities does not recognize the method 'System.String GetMainPhoto(Int32)' method, and this method cannot be translated into a store expression.\"</p>\n</blockquote>\n\n<p>I have read this is mainly caused because ToString method or some other methods are not valid to use. But, I am not really sure how to correct this error in this case.</p>\n\n<p>Basically, I have a db - PropertyPhoto that holds the filename of the pictures. GetMainPhoto basically looks up all the rows and returns the main pic file name.</p>\n\n<pre><code>public string GetMainPhoto(int id)\n        {\n            return db.PropertyPhotos.Single(p =&gt; p.PropertyId == id &amp;&amp; p.MainPic == true).PhotoLocation;\n\n        }\n</code></pre>\n\n<p>Controller is as follows:</p>\n\n<pre><code>public ActionResult Map()\n        {\n            if (Request.IsAjaxRequest())\n            {\n                var properties = websiteRepository.FindAllProperties();\n\n                var jsonProperties = from property in properties\n                                     select new JsonProperty\n                                     {\n                                         PropertyId = property.PropertyId,\n                                         NoOfBedroom = property.NoOfBedrooms,\n                                         Price = property.Price,\n                                         Address1 = property.PropertyAddress.Address1,\n                                         MainPicSrc = websiteRepository.GetMainPhoto(property.PropertyId),\n                                         Latitude = property.PropertyAddress.Latitude,\n                                         Longitude = property.PropertyAddress.Longitude\n                                     };\n\n                return Json(jsonProperties.ToList(), JsonRequestBehavior.AllowGet);\n            }\n            else \n            {\n                return View();\n            }\n        }\n</code></pre>\n"},{"tags":["c#","linq","dictionary"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":109,"score":2,"question_id":12781542,"title":"Union Dictionaries","body":"<p>I have two <code>Dictionary&lt;Person,Boolean&gt;</code>.\ndict a contains :</p>\n\n<pre><code>Person A -&gt; false\nPerson B -&gt; true,\nPerson C -&gt; false;\n</code></pre>\n\n<p>dict b contains :</p>\n\n<pre><code>Person A -&gt; true;\nPerson D -&gt; false;\n</code></pre>\n\n<p>I want to have an result, which contains all Persons one time, and set Boolean to ture, if a person contains a true in one of both lists.</p>\n\n<p>How can i solve this with <code>dict.Union()</code> ?</p>\n\n<p>Thanks Kooki</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":144,"score":1,"question_id":1692706,"title":"Rewriting code using LINQ","body":"<p>Here is a simplified version of the code I use.  I need to rewrite it using LINQ.</p>\n\n<pre><code>class Program\n{\n    // Here is the ugly stuff\n    static void DoStuff(int[] uidArray)\n    {\n        int chunkCount = (int)Math.Ceiling(uidArray.Length / 10d);\n\n        for (int i = 0; i &lt; chunkCount; i++)\n        {\n            // calculating the remaining uids.\n            // this is super ugly imho, but I couldnt come up with anything better...\n            int remaining = (i == chunkCount - 1) ? uidArray.Length - i * 10 : 10;\n\n            int[] currentChunks = uidArray.Skip(i * 10).Take(remaining).ToArray();\n            string[] data = GetDataForUids(currentChunks);\n\n            foreach (string item in data)\n            {\n                Console.WriteLine(item);\n            }\n        }\n    }\n\n    // Call DoStuff()\n    static void Main(string[] args)\n    {\n        DoStuff(Enumerable.Range(1, 21).ToArray());\n        Console.ReadLine();\n    }\n\n    // This method does is not my concern\n    static string[] GetDataForUids(int[] uidArray)\n    {\n        var ret = new List&lt;string&gt;();\n\n        foreach (int uid in uidArray)\n        {\n            ret.Add(\"item \" + uid);\n        }\n\n        return ret.ToArray();\n    }\n}\n</code></pre>\n\n<p>What the \"real\" implementation does: </p>\n\n<ul>\n<li>taking an <code>int[]</code> of uids</li>\n<li>dividing them in smaller arrays, with at most 10 uids per part</li>\n<li>in a for loop taking part by part</li>\n<li>for each part call <code>GetDataForUids</code> which uses the database in order to fetch the data by uid</li>\n<li>process the returned data in a <code>foreach</code> loop</li>\n</ul>\n\n<p>Because of the various \"outer\" variables like <code>chunkCount</code> I can't imagine how this thing can be written in a better way using LINQ. Is it still possible?</p>\n"},{"tags":[".net","linq","grouping","linq-to-objects"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2836,"score":0,"question_id":2551086,"title":"LinQ to objects GroupBy() by object and Sum() by amount","body":"<p>I have pretty simple case which I started solving using foreach(), but then I thought I could do It using Linq</p>\n\n<p>Basically I have IList that contains PaymentTransaction objects and there are 2 properties Dealer and Amount</p>\n\n<p>I want to GroupBy() by Dealer and Sum() bv amount.</p>\n\n<p>I tried to accomplish this using following code, but unfortunately it does not work</p>\n\n<pre><code>var test = paymentTransactionDao.GetAll().GroupBy(x =&gt; x.Dealer).Sum(x =&gt; x.Amount);\n</code></pre>\n\n<p>Want exactly I'm doing wrong here?</p>\n\n<p>I'm sorry if this question is too simple.</p>\n\n<p>Thank You</p>\n"},{"tags":["c#","xml","linq","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12783525,"title":"add data to existing xml file using linq","body":"<p>I am a .net beginner. I need to add some data to xml file</p>\n\n<p>the xml file is:</p>\n\n<pre><code>&lt;stock&gt;    --- 1st level  /* i dont want to create this because this exists */ \n  &lt;items&gt;  --  2nd level\n    &lt;productname&gt;Toothpaste&lt;/productname&gt;\n    &lt;brandname&gt;Colgate&lt;/brandname&gt;\n    &lt;quantity&gt;12&lt;/quantity&gt;\n    &lt;price&gt;10&lt;/price&gt;\n  &lt;/items&gt;\n  &lt;items&gt;\n    &lt;productname&gt;Toothpaste&lt;/productname&gt;\n    &lt;brandname&gt;Pepsodent&lt;/brandname&gt;\n    &lt;quantity&gt;20&lt;/quantity&gt;\n    &lt;price&gt;12&lt;/price&gt;\n  &lt;/items&gt;\n&lt;/stock&gt;\n</code></pre>\n\n<p>I need to add </p>\n\n<pre><code>productname --&gt; Toothpaste\nbrandname   --&gt; CloseUp\nquantity    --&gt; 16\nprice       --&gt; 15\n</code></pre>\n\n<p>to their respective tags. The problem I am facing now is that I need to go two levels deep to write to their respective tags, which i dont know how to do.</p>\n\n<p>I tried the below code: (<em>not working</em>)</p>\n\n<pre><code>XDocument doc = new XDocument(      \n                  new XElement(\"stock\",  /* how to go inside existing \"stock\"? */\n                     new XElement(\"items\", \n                          new XElement(\"productname\", \"Toothpaste\"),\n                          new XElement(\"brandname\", \"CloseUp\"),\n                          new XElement(\"quantity\",\"16\"),\n                          new XElement(\"price\",\"15\"))));\n</code></pre>\n\n<p>There must be some other way to achieve this which I dont know.\n<br>Answers not related to linq are also welcome. but more preference to linq because I have implemented full linq in my project.</p>\n\n<p>Please Help\n<br>Thanks in Advance.</p>\n"},{"tags":["database","linq","if-statement"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":42,"score":-1,"question_id":12780941,"title":"Saving data in a database using linq and \"if\" clause","body":"<p>I got a problem when i debug this:</p>\n\n<pre><code>          if (a.City == AddCity.Text &amp;&amp; a.Postal == TextBoxAddPostal.Text &amp;&amp; a.Country  == DropDownListAddCount.SelectedItem.Text &amp;&amp; a.Name == AddName.Text &amp;&amp; a.HouseNo == AddHouse.Text)\n                {\n                    AddError.Text = \"eksist in database!\";\n                }\n                else\n                {\n                    tt.Address.AddObject(a);\n                    tt.SaveChanges();\n                    AddError.Text = \"Saved!\";\n                    {\n\n                    }\n                }\n</code></pre>\n\n<p>What im trying to do is, if this address exist in the database then it must add it in the table. if it does not exist then add it to the table.\nI can edit my answer and put the whole code</p>\n\n<p>Cheers :-)</p>\n"},{"tags":["c#","linq","inotifycollectionchanged"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":12780741,"title":"INotifyCollectionChanged's NewItems - cannot use OfType<T> to get data","body":"<p>I am attempting to get some custom objects from the <code>CollectionChanged</code> event of a collection which implements <code>INotifyCollectionChanged</code>.</p>\n\n<pre><code>MyControl_MyCollectionChanged(object sender, NotifyCollectionChangedEventArgs e)\n{\n  if(e.Action == NotifyCollectionChangedAction.Add)\n  {\n    lock(e.NewItems.SyncRoot)\n    {\n      var myItems = e.NewItems.OfType&lt;MyType&gt;();\n\n      if(myItems.Any())\n      {\n        //do stuff\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>The problem I am facing is that <code>myItems</code> always says \"Enumeration yielded no results\".</p>\n\n<p>Expanding on debug <code>e.NewItems.SyncRoot</code> shows the following:</p>\n\n<pre><code>e.NewItems.SyncRoot | {object[1]}\n|-[0] | {System.Linq.Enumerable.WhereSelectListIterator&lt;MyType, IMyInterface&gt;}\n| |-base ...\n| |-Non-public members\n| |-Results View | Expanding the Results View...\n|   |-[0] | MyType\n</code></pre>\n\n<p>So clearly the data is there. What is the method for retrieving this data?</p>\n"},{"tags":["c#","linq","lambda","expressions","linq-expressions"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12779971,"title":"How to combine result of multiple Linq Expressions into one Expression?","body":"<p>I have a list of Linq Expressions <code>List&lt;Expression&gt;</code> where each expression type (the type the expression would return) is either <code>Item</code> or <code>Item[]</code>.</p>\n\n<p>I'm trying to write some code that would take mentioned collection as an input parameter and produce a Linq Expression that would return one list (or array) of items (<code>Item[]</code>).</p>\n\n<p>Here is an abstract example:</p>\n\n<pre><code>public static string[] GetStrings()\n{\n    return new[]\n        {\n            \"first\",\n            \"second\",\n            \"third\"\n        };\n}\n\npublic static string GetString()\n{\n    return \"single1\";\n}\n\nprivate void SOExample()\n{\n    var expressions = new List&lt;Expression&gt;\n    {\n        Expression.Call(GetType().GetMethod(\"GetString\")),\n        Expression.Call(GetType().GetMethod(\"GetStrings\")), \n        Expression.Call(GetType().GetMethod(\"GetString\")),\n        Expression.Call(GetType().GetMethod(\"GetStrings\"))\n    };\n\n    // some magic code here\n    var combined = SomeMagicHere(expressions);\n}\n\n\nprivate Expression SomeMagicHere(List&lt;Expression&gt; expressions)\n{\n    foreach (var expression in expressions)\n    {\n        if (expression.Type.IsArray)\n        {\n            // Use array's elements\n        } \n        else\n        {\n            // Use expression\n        }\n    }\n</code></pre>\n\n<p>What I'm trying to make is to produce one Expression that would return a list of <code>Item</code> (strings in my example) from provided list.</p>\n"},{"tags":["c#","asp.net-mvc","linq","mvc"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12777284,"title":"Specified type member\"Status\" not supported in LINQ to Entities","body":"<p>I have a class called SmsContent</p>\n\n<pre><code>public class SmsContent\n    {        \n        public int Id { get; set; }           \n        public string Description { get; set; }\n        public string Content { get; set; }            \n\n        public SmsContentStatus Status { get; set; }\n        public ActivityId ActivityId { get; set; }       \n    }\n</code></pre>\n\n<p>And I have an enum type SmsContentStatus </p>\n\n<pre><code>public enum SmsContentStatus\n    {\n        Active = 0,\n        Partial,\n        Inactive,\n        Deleted\n    }\n</code></pre>\n\n<p>I'm trying to use this in my Controller</p>\n\n<pre><code>public ActionResult Index()\n    {\n        var db = new IvrDbContext();\n        var status = SmsContentStatus.Partial;\n\n        var content = db.SmsContents.Where(p =&gt; p.Status == status).FirstOrDefault();\n        if (content != null)\n        {\n            return View(content);\n        }\n        else\n        {\n            return View();\n        }\n    }\n</code></pre>\n\n<p>and then use it in my view</p>\n\n<pre><code>@model IEnumerable&lt;Sample.Models.SmsContent&gt;\n&lt;script type=\"text/javascript\"&gt;\n    var model = @Html.Raw(Json.Encode(Model));\n    for (var m in model) {\n                console.log(m.Content);\n            }\n&lt;/script&gt;\n</code></pre>\n\n<p>but I'm getting the error\n \"The specified type member 'Status' is not supported in LINQ to Entities.\nOnly initializers, entity members, and entity navigation properties are supported.\"</p>\n\n<p>Any help gratefully received!</p>\n"},{"tags":["asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":133,"score":0,"question_id":12759913,"title":"nested grid view","body":"<p>I like to use 1 nested grid view for showing the result like below, column 1 &amp; column 2 are for main gridview and column 3 is for nested gridview.</p>\n\n<p>Main gridview , nested gridview are control of  an user control.</p>\n\n<p>I like my result was like below:</p>\n\n<pre><code>TransId Transmittal TranstoCon\n 1        TT-0001    TT-CON-0005\n                     TT-CON-0100\n</code></pre>\n\n<hr>\n\n<pre><code> 2       TT-0009        TT-CON-3000\n</code></pre>\n\n<p>but after running , my grid view shows like below (Duplicate records):</p>\n\n<pre><code>TransId         Transmittal             TranstoCon\n 1               TT-0001                 TT-CON-0005\n                                         TT-CON-0100\n                                         TT-CON-3000\n\n 1               TT-0001                 TT-CON-0005\n                                         TT-CON-0100\n                                         TT-CON-3000\n\n 1               TT-0001                 TT-CON-0005\n                                         TT-CON-0100\n                                         TT-CON-3000\n\n\n\n\n 2               TT-0009                 TT-CON-0005\n                                         TT-CON-0100\n\n                                         TT-CON-3000\n</code></pre>\n\n<p>Please help what is the problem .How I can solve it.</p>\n\n<p>The code of user control is like below:</p>\n\n<pre><code>public partial class Transmittallistfortest : System.Web.UI.UserControl\n{\n\nclass TransmittaltoConPresentationModel\n{\n    public int TransID { get; set; }\n    public String Transmittal { get; set; }\n    public IEnumerable&lt;tblTranstoCon&gt; TranstoCons { get; set; }\n}\n\npublic class tbltransmittalNoEventArgs : EventArgs\n{\n    public int TransmittalId { get; set; }\n}\n\npublic event EventHandler&lt;tbltransmittalNoEventArgs&gt; DeleteTransmittal;\n\nprivate IEnumerable&lt;tbltransmittalNo&gt; _Transmittals;\n\npublic IEnumerable&lt;tbltransmittalNo&gt; Transmittals\n{\n    set { _Transmittals = value; }\n}\n\nprivate IEnumerable&lt;tblTranstoCon&gt; _Transmittaltocons;\n\npublic IEnumerable&lt;tblTranstoCon&gt; Transmittaltocons\n{\n    set { _Transmittaltocons = value; }\n}\n\nprivate IEnumerable&lt;tblDocTranstoCon&gt; _DocTranstoCons;\n\npublic IEnumerable&lt;tblDocTranstoCon&gt; DocTranstoCons\n{\n    set { _DocTranstoCons = value; }\n}\n\npublic IEnumerable&lt;tblTransmittall&gt; tblTransmittall\n{\n    set;\n    private get;\n}\npublic int Doc\n{\n    set;\n    private get;\n}\n\nprotected void Page_Load(object sender, EventArgs e)\n{\n\n}\n\npublic override void DataBind()\n{\n    base.DataBind();\n    if (_Transmittals != null)\n    {\n        DisplayTransmittals();\n    }\n\n\n}\n\nprivate void DisplayTransmittals()\n{\n    if (_Transmittals != null)\n    {\n       var query = from transmittalno in _Transmittals\n                   from Transmittal in tblTransmittall\n               from doctranstocon in _DocTranstoCons\n               from transtocon in _Transmittaltocons\n               where ((transmittalno.TransID == Transmittal.TransId) &amp;&amp; Transmittal.TransId == doctranstocon.Transid) &amp;&amp; (Transmittal.DocID == doctranstocon.Docid) &amp;&amp; (doctranstocon.TransmitToConid == transtocon.TRANSMITtoConId))\n               select new TransmittaltoConPresentationModel { \n                 TransID = transmittalno.TransID, Transmittal = \n                 transmittalno.TRANSMITTAL.ToString(), \n                 TranstoCons = from x in _Transmittaltocons\n                                   select x\n               };\n               GridViewTtransmittals.DataSource = query;\n    }\n    else\n    {\n       GridViewTtransmittals.DataSource = null;\n    }\n       GridViewTtransmittals.DataBind();\n}\n\n\nprotected void GridViewTtransmittals_RowDataBound(object sender, GridViewRowEventArgs e)\n{\n    if (e.Row.DataItem == null)\n        return;\n    TransmittaltoConPresentationModel transmittaltoCon = (TransmittaltoConPresentationModel)e.Row.DataItem;\n\n\n    GridView g2 = (GridView)e.Row.FindControl(\"GridViewTranstoCon\");\n\n    g2.DataSource = transmittaltoCon.TranstoCons;\n\n    g2.DataBind();\n}\n</code></pre>\n\n<p>markup of user control that contain parent gridview and nested gridview is like below:</p>\n\n<pre><code> &lt;%@ Control Language=\"C#\" AutoEventWireup=\"true\" CodeFile=\"Transmittallistfortest.ascx.cs\" Inherits=\"Transmittallistfortest\" %&gt;\n        &lt;asp:GridView ID=\"GridViewTtransmittals\" runat=\"server\" AutoGenerateColumns=\"False\" \n          BorderStyle=\"None\" ShowHeader=\"False\" Width=\"100%\" DataKeyNames=\"TransID\"  onrowdatabound=\"GridViewTtransmittals_RowDataBound\"\n        onrowdeleting=\"GridViewTtransmittals_RowDeleting\"&gt;\n          &lt;columns&gt;\n            &lt;asp:hyperlinkfield DataNavigateUrlFields=\"TransId\" \n              DataNavigateUrlFormatString=\"~/Copy of Transmittal.aspx?TransId={0}\" DataTextField=\"TRANSMITTAL\" \n              HeaderText=\"Transmittal\" /&gt;\n            &lt;asp:CommandField ButtonType=\"Button\" ShowDeleteButton=\"true\" /&gt;\n\n&lt;asp:TemplateField HeaderText = \"TRANSMITtoCon\"&gt;\n&lt;ItemTemplate&gt;\n\n                 &lt;asp:GridView ID=\"GridViewTranstoCon\" runat=\"server\" AutoGenerateColumns=\"False\" CellPadding=\"4\"\n                    ForeColor=\"#000000\" GridLines=\"Both\"&gt;\n             &lt;AlternatingRowStyle BackColor=\"Yellow\" /&gt;\n                    &lt;Columns&gt;\n                      &lt;asp:BoundField DataField=\"TRANSMITtoCon\" HeaderText= \"TRANSMITtoCon\" &gt;\n                       &lt;ItemStyle Width = \"20%\" /&gt;\n                      &lt;/asp:BoundField&gt;\n\n                     &lt;/Columns&gt;\n                     &lt;EditRowStyle BackColor=\"#7C6F57\" /&gt;\n         &lt;FooterStyle BackColor=\"#1C5E55\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n        &lt;HeaderStyle BackColor=\"Red\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n        &lt;PagerStyle BackColor=\"#666666\" ForeColor=\"White\" HorizontalAlign=\"Center\" /&gt;\n        &lt;RowStyle BackColor=\"#E3EAEB\" /&gt;\n        &lt;SelectedRowStyle BackColor=\"#C5BBAF\" Font-Bold=\"True\" ForeColor=\"#333333\" /&gt;\n                    &lt;/asp:GridView&gt;\n                &lt;/ItemTemplate&gt;\n            &lt;/asp:TemplateField&gt;\n             &lt;/columns&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["asp.net-mvc-3","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12777021,"title":"How to solve this in LINQ query?","body":"<p>I was working on MVC3 project. I need help writting Linq expression. My model is something like this.</p>\n\n<p><strong>Model Class</strong></p>\n\n<pre><code>    public int Id { get; set; }\n    public int DetCount { get; set; }\n</code></pre>\n\n<p>I need to do something like this,</p>\n\n<pre><code>DetCount = (from sel in db.PoDetails where sel.PoId == Id select sel).Count();  // Id is current model Id.\n</code></pre>\n\n<p>Based on the parent table Id, i need to get the child table records count.</p>\n\n<p><strong>Example</strong></p>\n\n<p>Parent Table</p>\n\n<pre><code> Id                  Name\n\n  1                   XYZ\n  2                   ABC\n</code></pre>\n\n<p>Child Table</p>\n\n<pre><code>Id         P_Id\n\n 1          1\n 2          1\n 3          2\n\n\nDetCount = (from sel in db.child where sel.P_Id == Id select sel).Count(); // if Id= 1\n</code></pre>\n\n<p><strong>Result</strong></p>\n\n<pre><code>DetCount = 2;\n</code></pre>\n\n<p>I have written the code something like this.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>model = ...\nselect new porders\n                     {\n                         Id = p.Id,  //This Id is passed to next statement for DetCount.\n                         DetCount = (from sel in db.PoDetails where sel.PoId == Id select sel).Count();    // I need to pass value from another linq query.\n                      }\n</code></pre>\n\n<p>Please help me for this.</p>\n\n<p>Thanks,</p>\n"},{"tags":["c#","xml","linq","c#-4.0","updates"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12776612,"title":"update xml using linq in c#","body":"<p>I am a .net beginner. </p>\n\n<p>I am trying to update my <a href=\"http://ideone.com/OnpgJ\" rel=\"nofollow\"><strong>xml file</strong></a> using linq. </p>\n\n<p>I got stuck at the very first point of it i.e i cant grab the value from xml file using linq.</p>\n\n<p>These are the controls I am using in my code:</p>\n\n<pre><code>cbBrandName -- combobox\ncbProduct   -- combobox\ntxtQuantity -- TextBox\n</code></pre>\n\n<p>I am trying the below code: </p>\n\n<pre><code>XElement doc = XElement.Load(@\"..\\..\\stock.xml\");\nstring quantity = doc.Descendants(\"quantity\")\n                  .Select(y =&gt; y.Element(\"quantity\").Value.Equals(txtQuantity.Text))\n/*red scribbles to 'Element' in 'where'*/ \n                  .Where(x =&gt; x.Element(\"productname\").Value.Equals(cbProduct.Text) &amp;&amp;\n                  x.Element(\"brandname\").Value.Equals(cbBrandName.Text)).ToString();\nMessageBox.Show(quantity.ToString());\n</code></pre>\n\n<p>here I am trying to store the \"quantity\" value in <code>quantity</code> string so that i can manipulate it later and then again update to my xml file. </p>\n\n<p>when I make <code>.select</code> as comment it isn't showing any errors but when i run it, instead of text it is showing some <code>system.linq.Enumerable + .....</code> in the MessageBox.</p>\n\n<p>EDIT:</p>\n\n<p><img src=\"http://i.stack.imgur.com/XzCSM.png\" alt=\"enter image description here\"></p>\n\n<p>when i give <code>.toString()</code> at the end it. It is showing error -- \"Object reference not set to an instance of an object.\" when i run it.</p>\n\n<p>Please help\n<br>Thanks in Advance.</p>\n"},{"tags":["asp.net","linq","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12769730,"title":".Contains with a list as variable","body":"<p>I am trying to parse a comma delimited text box as a list and then check if a string has any of the strings in the list.  </p>\n\n<p>For instance:\ntxtLastName: smit txtFirstName: joh,jon,j.  </p>\n\n<p>I need to search a database that has a field combined_name that includes smith and joh or jon or j. in it.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>            var fullName = txtSearchBox0.Text.Trim();\n        List&lt;string&gt; firstName = new List&lt;string&gt;(txtSearchBox1.Text.Split(',').Select(x =&gt; Convert.ToString(x)).ToList());\n\n\n        var rows = (from c in db.GetTable&lt;defendants_ALL&gt;()\n                    where c.combined_name.Contains(fullName) &amp;&amp; c.combined_name.Contains(firstName)\n                    select c).ToList();\n</code></pre>\n\n<p>This does not work with firstName being a list but it does if it is var like the last name.  Is it possible to use .Contains with the list variable or is there another way I need to do this??</p>\n"},{"tags":["asp.net","linq","stackoverflow.com"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12777312,"title":"How to query data according to date and time in LINQ","body":"<p>I am working on a service layer implementation in asp mvc with LINQ. For example there are Users , Posts and Votes something like Stackoverflow. Each user have a reputation gained from upvotes and downvotes. </p>\n\n<p>This vote table has following attributes: id , postTypeId, voteTypeId, creationDate , VoterId</p>\n\n<p>This Post table has following attribute : id, userId ....</p>\n\n<p>and User table includes : id</p>\n\n<p>for each upvote 2 marks are given , for each downvote 1 mark is reduced</p>\n\n<p><strong>I need how to write a query with Linq how to query , to show reputation change: \nreputation per Date , time and date, whether it's a upvote or downvote and related post</strong> </p>\n\n<p>these are the attributes I am going to use,</p>\n\n<pre><code>var jointable = from vote in _dataContext.Votes\n    join post in _dataContext.Posts on vote.PostId equals post.Id\n    where vote.VoterId== id\n    select new\n    {  \n        vote.Id,\n        vote.CreationDate,\n        vote.PostId,\n        vote.VoteTypeId,\n        post.PostTypeId,\n        post.Title,\n        post.IsAnonymous \n    };    \n</code></pre>\n\n<p>After this can somebody help me to query those attributes to return them as an object??</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":6794098,"title":"linq update issue","body":"<p>I have a xml document that has a record set like this.</p>\n\n<pre><code>&lt;document&gt;\n  &lt;row&gt;\n    &lt;Pub_Code&gt;OHB-A0011&lt;/Pub_Code&gt;\n    &lt;Sec&gt;16&lt;/Sec&gt;\n    &lt;Pags&gt;20&lt;/Pags&gt;\n    &lt;Copies&gt;1,000&lt;/Copies&gt;\n    &lt;Binding&gt;Saddle Stitch&lt;/Binding&gt;\n    &lt;Tab&gt;No tabs&lt;/Tab&gt;\n    &lt;Qty&gt;0&lt;/Qty&gt;\n    &lt;Cover&gt;Self Cover&lt;/Cover&gt;\n    &lt;Tpgs&gt;0&lt;/Tpgs&gt;        \n  &lt;/row&gt;\n&lt;/document&gt;\n</code></pre>\n\n<p>I have a linq query wrtten this way:</p>\n\n<pre><code>string xml_path = @\"D:\\Server-Apps\\BooksData.xml\"; \nXElement root = XElement.Load(xml_path);\n\nvar selected = from myBooks in root.Elements(\"row\") where myBooks.Element(\"Pub_Code\").Value == \"OHB-A0011\" select myBooks;\n\n foreach (var d in selected)\n          {\n              Console.WriteLine(\"Pub_Code: {0}\", d.Element(\"Pub_Code\").Value);\n              Console.WriteLine(\"Cover: {0}\", d.Element(\"Cover\").Value);\n               d.SetElementValue(\"Tpgs\", \"test\");\n\n          }\n</code></pre>\n\n<p>I can read the value find but when I uses d.SetElementValue(\"Tpgs\", \"test\"); nothing gets update.\nthe tag is already in the xml file .</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12771647,"title":"List Intersect and Concat","body":"<p>I wrote some expression to Intersect and Concat two lists TestListA &amp; TestListB as below:</p>\n\n<pre><code>var c= TestListA.Intersect(TestListB)\n                .Concat(ListA.Where(a =&gt; \n                    ListB.Any(b =&gt; b.EndsWith(\"999\") \n                                &amp;&amp; b.StartsWith(a.Substring(0, a.Length - 3)))));\n</code></pre>\n\n<p>I want to know how loop and other conditions looks like behind the scene and if I will write all this with the help of foreach then performance will degrade?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12775125,"title":"Find out how many iterations done by linq","body":"<p>I want to know how many iteratons were done by LINQ. so i wrote a simple query</p>\n\n<pre><code>string xx = \"The quick brown fox jumps over the lazy dog\";\n\nchar search = 'f';\n\nint j = 0;\n\nvar result = xx.Select((b, i) =&gt; \n{\n    j++;\n    return b.Equals(search) ? i : -1;\n})\n.Where(i =&gt; \n{\n    j++;\n    return i != -1;\n});\n\nMessageBox.Show(j.ToString());\n</code></pre>\n\n<p>I thought that <code>j</code> would contain the number of iterations done but surprisingly it remains 0. Why is it so? and secondly how to find out how many iteratons were done by LINQ.</p>\n"},{"tags":["c#","xml","linq","datagridview","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12742972,"title":"Specific elements from XML string to a datagridview or datatable (C#)","body":"<p>I've only just recently begun working with XML strings. What I'm doing now is using a webservice to pull records from a database. It returns the following output:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-16\"?&gt;\n&lt;Records count=\"2\"&gt;\n    &lt;Metadata&gt;\n        &lt;FieldDefinitions&gt;\n          &lt;FieldDefinition id=\"13597\" name=\"Statement\" alias=\"Statement\" /&gt;\n          &lt;FieldDefinition id=\"13598\" name=\"Response\" alias=\"Response\" /&gt;\n        &lt;/FieldDefinitions&gt;\n    &lt;/Metadata&gt;\n    &lt;Record contentId=\"154321\" moduleId=\"409\"&gt;\n        &lt;Field id=\"13597\" type=\"1\"&gt;&amp;lt;p&amp;gt;This is a database record&amp;lt;/p&amp;gt;&lt;/Field&gt;\n        &lt;Field id=\"13598\" type=\"1\"&gt;&amp;lt;p&amp;gt;This is a record&amp;lt;/p&amp;gt;&lt;/Field&gt;\n    &lt;/Record&gt;\n    &lt;Record contentId=\"154755\" moduleId=\"409\"&gt;\n        &lt;Field id=\"13597\" type=\"1\"&gt;&amp;lt;p&amp;gt;This is another database record&amp;lt;/p&amp;gt;&lt;/Field&gt;\n        &lt;Field id=\"13598\" type=\"1\"&gt;&amp;lt;p&amp;gt;And another corresponding record&amp;lt;/p&amp;gt;&lt;/Field&gt;\n    &lt;/Record&gt;\n&lt;/Records&gt;\n</code></pre>\n\n<p>What I'm trying to achieve is a datatable/datagridview that will be displayed to the user. Which would be something like this:</p>\n\n<pre><code>|    Statement    |    Response    |\n|This is a datab..| This is a corr.|\n|This is another..| And another....|\n</code></pre>\n\n<p>I've tried the following code:</p>\n\n<pre><code>    private void WriteDataGrid(string xml)\n    {\n        DataSet ds = new DataSet();\n        XmlTextReader reader = new XmlTextReader(xml, XmlNodeType.Document, null);\n        ds.ReadXml(reader);\n        dataGridView1.DataSource = ds;\n        dataGridView1.DataMember = \"Field\";\n    }\n</code></pre>\n\n<p>However it only managed to obtain this:</p>\n\n<pre><code>|    id | type  | Field_Text       |\n|13597  | 1     | This is a...     |\n|13598  | 1     | This is a corr...|\n|13597  | 1     | This is anoth... |\n|13598  | 1     | And anothe...    |\n</code></pre>\n\n<p>I plan to use the field id's from the xml to create unique columns, then set the values of the rows based on the enclosed values. But I'm unsure of how I should go about doing this. Could anyone help? Or is there a better way for me to achieve what I'm looking to do?</p>\n\n<p>I'm aware it'd be much easier if the Elements were unique, but I'm unable to alter the webservices' output in any way. </p>\n\n<p>Any help would be much appreciated. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I just realized I neglected to add that the XML string would contain HTML tags and markups \n(specifically <em>&lt; p > &lt; / p ></em>)\n(<em>&amp;lt &amp;gt &amp;amp</em> etc.) in the field texts. Does anyone have any suggestions on how I could remove/escape/decode these before writing them to the datatable? </p>\n"},{"tags":["linq","linq-to-sql","entity-framework-4","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12774437,"title":"General questions on .NET Entity Framework 4","body":"<p>I've got a few questions in regards to the EF 4.0 which I hope someone can help me with.</p>\n\n<p>A little bit of background first: I used a tool from visualstudiogallery.com to reverse engineer my database into classes. All appears to be fine in regards to the classes, object mapping, etc... In my dbcontext class, it generated a property for each table which is fine. Now this part of the code is held in one project and it's being called by an MVC 4 application. I'll eventually turn this into a full service layer to deal with separation of concern but for now a direct link will do the trick.</p>\n\n<p>Anyway, back to my EF questions:</p>\n\n<ol>\n<li><p>I'm confused as to what EF does here when accessing a propery in the dbcontext class which matches the table name? Does it actually return all the rows every time? Seems insane if it does</p></li>\n<li><p>I tried creating a function rather than a property in the dbcontext class where I wanted to provide a parameter and return only rows matching the parameter but when I add a class and try to make a \"LINQ\" call within it, I get the following error:</p></li>\n</ol>\n\n<p>Could not find an implementation of the query pattern for source type 'System.Data.Entity.DbSet .... 'Select' not found.  Are you missing a reference to 'System.Core.dll' or a using directive for 'System.Linq'?</p>\n\n<p>Any ideas why this is happening?</p>\n\n<ol>\n<li>I assume this is more a link question, but assume we have a users table (userid), a horse table (horseid) and then one table where horses are associated to users (horseid, userid).</li>\n</ol>\n\n<p>If I created a function, assuming 2 is resolved, which is called GetMyHorses and I pass the userId as a parameter, how do I use Linq to provide what I would normally get via a simple join query in stored procedure and return all horses associated with the user provided via the parameter.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","linq","entity-framework","entity-framework-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12774316,"title":"Linq to Entity Where built by looping over data","body":"<p>I have a search box and I have broken the data into words. I now need compare each of these words with several fields in the database. Here is the code I have:</p>\n\n<pre><code>List&lt;string&gt; searchValues = searchString.Split(delimiters, StringSplitOptions.RemoveEmptyEntries).ToList();\n\nusing (DatabaseEntities context = new DatabaseEntities())\n{\n    IQueryable&lt;DatabaseType&gt; returnValue =\n    context.DatabaseType.Where(y =&gt;\n        y.Field1.Contains(searchValues[0]) ||\n        y.Field1.Contains(searchValues[0]));\n\n    searchValues.Skip(1).ToList().ForEach(x =&gt;\n    {\n        returnValue = returnValue.Where(y =&gt;\n            y.Field1.Contains(x) ||\n            y.Field2.Contains(x));\n    });\n\n    return returnValue.ToList();\n</code></pre>\n\n<p>My goal is to build the full query before actually loading the items into memory. However, when I try to run this I get the following error:</p>\n\n<pre><code>System.NotSupportedException: LINQ to Entities does not recognize the method &amp;#39;System.String get_Item(Int32)&amp;#39; method, and this method cannot be translated into a store expression.\n</code></pre>\n\n<p>I had thought this type of error meant that the operations I am attempting do not work in the conversion to SQL, but I'm fairly sure I have used Contains as LIKE statements before. Also, all of the information in the database are nvarchars, so those equate to strings in my Entity. Does any one have any idea what the problem is? Is using an IQueryable the best way to do this? I would prefer to lazy load all of these, if possible.</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12772489,"title":"Types in Union or Concat cannot be constructed with hierarchy","body":"<p>I am trying to run a query very similar to the following:</p>\n\n<pre><code>(from bs in DataContext.TblBookShelf\njoin b in DataContext.Book on bs.BookID equals b.BookID\nwhere bs.BookShelfID == bookShelfID \nselect new BookItem\n{\n        Categories = String.Join(\"&lt;br/&gt;\", b.BookCategories.Select(x =&gt; x.Name).DefaultIfEmpty().ToArray()),\n    Name = b.Name,\nISBN = b.ISBN,\nBookType = \"Shelf\"\n}).Union(from bs in DataContext.TblBookShelf\njoin bi in DataContext.TblBookInventory on bs.BookID equals bi.BookID\n    select new BookItem\n    {\n          Categories = String.Join(\"&lt;br/&gt;\", bi.BookCategories.Select(x =&gt; x.Name).DefaultIfEmpty().ToArray()),\n          Name = bi.Name,\n      ISBN = bi.ISBN,\n      BookType = \"Inventory\"\n});\n</code></pre>\n\n<p>I am receiving \"Types in Union or Concat cannot be constructed with hierarchy\" after the statement executes, I need to to be able to get a list of categories to display with each book.  If anyone could shed some light on a possible solution, it would be greatly appreciated.</p>\n"},{"tags":["c#","asp.net","sql","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12771483,"title":"How to query large table and list object","body":"<p>I have a large table 1.2 million or so rows that I need to query using. Contains on the same field. There is a field combined_name that needs to be queried using a list. I am trying to do it with just one field for now to check performance and that is reflected in the code. The way I have it written takes far too long.  Is there a way where I don't have to load the table into memory?</p>\n\n<pre><code>JDataClassDataContext db = new JDataClassDataContext();\nvar fullName = txtSearchBox0.Text.Trim();\nList&lt;string&gt; firstName = new List&lt;string&gt;(txtSearchBox1.Text.Split(',').Select(x =&gt; Convert.ToString(x)).ToList());\n\nvar rows = (from c in db.defendants_ALLs.AsEnumerable()\n      where c.combined_name.Contains(fullName)\n          &amp;&amp; firstName.Any(n =&gt; c.combined_name.Contains(n))\n      select c).ToList();     \n\ndlSearch.DataSource = rows;\ndlSearch.DataBind();\n</code></pre>\n"},{"tags":["c#","asp.net","database","linq","modeling"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12770977,"title":"MVC4 Query Two tables linked by a third table","body":"<p>Simplified Example for simplicities sake.</p>\n\n<p>I am building a calculator for an online store, however product prices are as a percentage of a calculated base price.</p>\n\n<p>As such, I have 3 Tables...</p>\n\n<pre><code>Types\n    TypeId    int\n    Name          string\n\nProducts\n    ProductId    int\n    TypeId   int (fk)\n    Name         string\n    Rate         decimal(5, 3)\n\nBasePrices\n    BasePriceId  int\n    TypeId   int (fk)\n    Price    decimal(5,3)\n</code></pre>\n\n<p>Now, I wish to display a list of products and their calculated prices within a view. Furthermore, I wish to be able to ask the user how many of the item which they wish to order e.g. by having an input text box next to each product item.</p>\n\n<p>The Unit price will be calculated as follows (in kind of pseudo code):</p>\n\n<pre><code>(BasePrice.Price where Type = \"Fruit\") * Product.Rate\n</code></pre>\n\n<p>My problem is that The BasePrices table connects to the Products Table via the Types Table. I am very new to ASP.NET, and and MVC and Linq, and I am not really sure how I should be modelling / querying this.</p>\n\n<p>In MySql, I would normally just run the following query to pull off a list of products and their current prices...</p>\n\n<pre><code>SELECT P.Name as Product, T.Name as Type, P.Rate * B.Price\nFROM BasePrice as B, Products as P, Types as T\nWHERE \n    T.Type = \"Fruit\" AND\n    T.Type = B.Type\n</code></pre>\n\n<p>The above would work in mySQL despite there not being a SPECIFIC link between the Product and BasePrice Tables.</p>\n\n<p>In my Products Model, should I include a BasePrices navigation property? How would I do this, if there is no direct link between the two? e.g. there is no BasePriceId within the ProductsModel for business logic related reasons.</p>\n\n<p>Excuse dodgy syntax, but this is kind of how I think I should be doing it within c# controller.</p>\n\n<pre><code>public ActionResult Index() {\n\nApplicationDB db = new ApplicationDB();\n\nvar products = db.Products.Include(b =&gt; b.BaseRates).Include(t =&gt; t.Types).\n    Where(t =&gt; t.Type == \"Fruit\");\n\n    // This is where I get stuck...\n\n}\n</code></pre>\n\n<p>Alternatively, should I be creating a new Calculator.cs file within the model which does all the math for me, then use the controller to query the calculator.cs model? any idea how I should be doing this?</p>\n\n<p>Any guidance would be much appreciated.</p>\n"},{"tags":["linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12770372,"title":"ON INSERT after database index error An attempt has been made to Attach or Add a","body":"<p>I have code like this in my insert function</p>\n\n<pre><code>try\n{\n\n  Datacontext = new DataContext(\"....\")\n  ctx.InsertOnSubmit(myClass);\n  ctx.SubmitChanges();\n}\ncatch\n{\n\n}\n</code></pre>\n\n<p>in my table i want to insert into, there is a unique index for <code>name</code> column, for example. When i try to inert i get a database error to change the name property. I catch the exception and show a user friendly message to user. So user changes the name and tries again. When the code runs again i get the error </p>\n\n<p>An attempt has been made to Attach or Add an entity that is not new, perhaps having been loaded from another DataContext</p>\n\n<p>I dont have the same record in database and i can't insert it\nAnybody knows the solution?</p>\n\n<p>I Tried the Detach() Method and wrote it to every class.</p>\n\n<p>I write my class like</p>\n\n<pre><code>[Table]\n    public class SikSorulanSoru \n    {\n\n    public SikSorulanSoru()\n    {\n\n    }\n\n    [Column(AutoSync = AutoSync.OnInsert, DbType = \"Int NOT NULL IDENTITY\", IsPrimaryKey = true, IsDbGenerated = true)]\n    public long ObjectId\n    {\n        get;\n        set;\n    }\n\n\n    [Column(DbType = \"DateTime NOT NULL\")]\n    public DateTime OlusturulmaTarihi\n    {\n        get;\n        set;\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>I learnt that to write a detach() i must inherit \nINotifyPropertyChanging, INotifyPropertyChanged  interfaces. I inherited these code </p>\n\n<pre><code>  public void Detach()\n        {\n            this.PropertyChanged = null;\n            this.PropertyChanging = null;\n        }\n        private static PropertyChangingEventArgs emptyChangingEventArgs = new PropertyChangingEventArgs(String.Empty);\n\n    public event PropertyChangingEventHandler PropertyChanging;\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    protected virtual void SendPropertyChanging()\n    {\n        if ((this.PropertyChanging != null))\n        {\n            this.PropertyChanging(this, emptyChangingEventArgs);\n        }\n    }\n\n    protected virtual void SendPropertyChanged(String propertyName)\n    {\n        if ((this.PropertyChanged != null))\n        {\n            this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n        }\n    }\n</code></pre>\n\n<p>But this time i can't update the records because <code>SendPropertyChanged</code> is always null</p>\n"},{"tags":["c#","xml","linq","c#-4.0","combobox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":12768492,"title":"and operator in Linq and select distinct values using linq","body":"<p>I am new to .net. I have a form in which there are two comboboxes <code>cbProduct</code> and <code>cbBrandName</code> and also a label <code>lblPrice</code>. </p>\n\n<p>I am trying to implement the below code but it is showing blue scribbles to <code>&amp;&amp;</code>. \n(Error: <em>operator '&amp;&amp;' cannot be applied to operands of type 'lambda expression' and 'lambda expression'</em>)</p>\n\n<p>I tried the below code: (<em>not working</em>)</p>\n\n<pre><code>lblPrice.Text = string.Empty;\n        lblPrice.Text = doc.Descendants(\"items\"\n            ).Where((x =&gt; x.Element(\"productname\"\n                ).Value.Equals(cbProduct.SelectedItem.ToString())) &amp;&amp; /*blue scribbles to '&amp;&amp;'*/\n                (y =&gt; y.Element(\"brandname\").Value.Equals(cbBrandName.SelectedItem.ToString()\n                ))).Select(k =&gt; k.Element(\"price\"\n                    ).Value).ToString();\n</code></pre>\n\n<p>My other question is that i want to make the selected values of <code>cbProduct</code> as distinct. The below code takes all the values instead of distinct values:</p>\n\n<pre><code>cbProduct.Items.AddRange(doc.Descendants(\"items\"\n            ).Select(x =&gt; x.Element(\"productname\").Value\n            ).ToArray&lt;string&gt;());//adds all products           \n        cbProduct.SelectedIndex = 0;\n</code></pre>\n\n<p>giving any one answer is ok</p>\n\n<p>Please assist me\n<br>Thanks in advance</p>\n"},{"tags":["linq","linq-to-sql","iqueryable"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12768267,"title":"Linq2SQL and IQueryable","body":"<p>Still new to LINQ2SQL so please forgive my ignorance ...</p>\n\n<p>I have one user component which includes one Textbox and one button. The component is used as a generic ListOfValue Filter.\nThe component has one function to set a IQueryable which is passed to a form that is opened when the user clicks a button on the control. \nThe form consists of a grid (c1flexgrid) which is filled with the data from the IQueryable. There is a bindingsource on the form that gets the IQueryable as datasource.\nThe user can select inside the grid and after he selected an entry the dialog is closed and the selected row (or better the selected LINQ2SQL object from the row) is passed back to the control.\nOn this control i want to show one specific field out of that selected object. The name of that field is passed in to the user control as string.</p>\n\n<p>My problem is, i don't know how to get that field data from an \"generic\" LINQ2SQL object.\nIn debugger i can see, that the selected object is of a specific enity type (corresponding to the query)</p>\n\n<p>Probably somthing similar to \n<a href=\"http://stackoverflow.com/questions/301809/workarounds-for-nameof-operator-in-c-typesafe-databinding\">workarounds for nameof() operator in C#: typesafe databinding</a>\nbut just the opposit way :)</p>\n\n<p>Any help would be very welcome</p>\n"},{"tags":["linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":10028621,"title":"linq average count syntax","body":"<p>I have a table of listings (pk = Id).\nThe table has a FK to a practicticeprofile by PracticeProfileId\n(i.e 1 Practice profile has many listings)</p>\n\n<p>i wouls like to return the AVERAGE number of listings per practice profile</p>\n\n<pre><code>int count;\ncount = (from l in myentity.Listings\n        group l by l.PracticeProfileId into g\n        select g.Count()).Average();\n</code></pre>\n\n<p>I think i am successfully grouping the listings by practiceprofile, but I am not sure on how to get the total average # of listings</p>\n\n<p>thanks</p>\n"},{"tags":[".net","vb.net","linq","entity-framework-4","repository"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12758147,"title":"group by with repository and entity framework","body":"<p>i have this entity framework code:</p>\n\n<pre><code>repository.GetObjectQuery(Of COUNL1)().\n     Where(Function(a) a.CDATE &gt;= '2012/01/01' And \n           a.CDATE &lt;= '2012/12/01' And \n           COID = 88 ).\n     GroupBy(Function(m) m.CDATE).\n     Select(Function(n) New PointXY With {\n        .Y = n.Sum(Function(k) k.TOTALVH), \n        .X = n.First().CDATE}).\n     ToList()\n</code></pre>\n\n<p>this error accoured:</p>\n\n<pre><code>Only parameterless constructors and initializers are supported in LINQ to Entities.\n</code></pre>\n\n<p>description:\ni want group by CDATE and sum of TOTALVH and put it in PointXY Class Like this</p>\n\n<pre><code>PointXY {.Y = Sum(TOTALVH), .X = CDATE})\n</code></pre>\n\n<p>sql Query :</p>\n\n<pre><code>SELECT        SUM(TOTALVH) AS EXPR1, CDATE\nFROM            COUNL1\nWHERE        (CDATE &gt;= '2012/01/01') AND (CDATE &lt;= '2012/12/01') AND   (COID  = 88)\nGROUP BY CDATE \n</code></pre>\n\n<p>please help me,thanks all.</p>\n"},{"tags":["asp.net-mvc-3","linq","controller","html.dropdownlist"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12760979,"title":"Search and Filter in MVC3 Razor I am using Linq, is there a better way to do this","body":"<p>Heres my Code and it works fine. I just dont like all the If else,  what If I keep adding field to filter, its going to get messy.  Ps: I am not using EF and cannot on this. Thanks.</p>\n\n<p>CONTROLLER CODE</p>\n\n<pre><code>var books = from b in bookRepository.GetDogs() select b;    \nif (!String.IsNullOrEmpty(searchString))\n{\n\n    if (!String.IsNullOrWhiteSpace(searchString) &amp;&amp; searchGender != String.Empty &amp;&amp; searchHand != String.Empty)\n    {\n        books = books.Where(b =&gt; b.Name.ToUpper().Contains(searchString.ToUpper())\n                                 &amp;&amp; b.Gender == searchGender &amp;&amp; b.Handedness == searchHand);\n    }\n    else if (!String.IsNullOrWhiteSpace(searchGender) &amp;&amp; searchString == String.Empty &amp;&amp; searchHand == String.Empty)\n    {\n        books = books.Where(b =&gt; b.Gender == searchGender);\n    }\n    else if (String.IsNullOrWhiteSpace(searchGender) &amp;&amp; searchString != String.Empty &amp;&amp; searchHand == String.Empty)\n    {\n        books = books.Where(b =&gt; b.Name.ToUpper().Contains(searchString.ToUpper()));\n    }\n}\n\nreturn View(books);\n</code></pre>\n\n<p>HERES MY VIEW</p>\n\n<pre><code>&lt;p&gt;Find by Name : @Html.TextBox(\"searchString\", ViewBag.CurrentFilter as string)\n\n\n@Html.DropDownList(\"searchGender\", new SelectList(ViewBag.BookNames), \"-- Select All --\")\n@Html.DropDownList(\"searchHand\", new SelectList(ViewBag.HandNames), \"---Select All--\")\n</code></pre>\n"},{"tags":["linq","properties","associations","dynamic-data","dbml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12754813,"title":"Changing association reference in DBML, dynamic data webform","body":"<p>I have a dynamic data webform that has one dimension table referenced by two fact tables.</p>\n\n<p>The associations between the fact tables and the dimension table work. However, <code>factTable1</code> needs a different property than <code>factTable2</code>. How can I change the property referenced by the association? It seems that just the first property is referenced. </p>\n\n<pre><code>fact1++++++ dim       ++++++   fact2\n--\n{key1} &lt;--- {PK, Prop1, Prop2} ---&gt; {key2}\n</code></pre>\n\n<p>So, when I want the association of fact1 and dim to return Prop1 and the association of fact2 and dim to return Prop2. How can I change which property is returned?</p>\n"},{"tags":["c#","asp.net-mvc","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12760104,"title":"Get last several values from model","body":"<p>I'm listing articles from <code>Article</code> model. </p>\n\n<p>To get all of them I naturally use</p>\n\n<pre><code>var articles = db.Articles;\n</code></pre>\n\n<p>To get only last one:</p>\n\n<pre><code>var lastArticle = db.Articles.Last();\n</code></pre>\n\n<p>But now should I get, let's say, last four?</p>\n\n<p>Article model:</p>\n\n<pre><code>ID\nName\nDateCreated\nImage\nContent\n</code></pre>\n"},{"tags":["linq","entity-framework-4","asp.net-mvc-4","web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12757949,"title":"How can i write a linq query for multiple tables in entity model MVC4?","body":"<p>I have these tables in my entity model</p>\n\n<p><code>dbo.Options</code></p>\n\n<pre><code>[OptionsId] [OptionName]\n    1        Color\n    2        Size\n    3        Fit\n</code></pre>\n\n<p><code>dbo.ProductAttributes</code>:</p>\n\n<pre><code>[ProdcutAttributeId]   [SKU]       [OptionId]   [Value]\n     3001              Shirt_1001    1            Grey\n     3002              Shirt_1001    2              S \n     3003              Shirt_1001    3           Regular\n     3004              Shirt_1002    1            Black\n     3005              Shirt_1002    2             M\n     3006              Shirt_1002    3            Slim\n</code></pre>\n\n<p><code>dbo.Products</code>:</p>\n\n<pre><code>[ProductId  [ProductName]   [ProductDescription]    [Stock] [ImageURL]  [ProductType]\n</code></pre>\n\n<p><code>dbo.ProductSKU</code>:</p>\n\n<pre><code>   ID      SKU       ProductId  Price   ImageURL\n   2001    Shirt_1001   1001    12  C:\\Users\\Administrator\\Desktop\\Images\\LongSleeveShirt.jpg\n   2002    Shirt_1002   1001    13  C:\\Users\\Administrator\\Desktop\\Images\\LongSleeveShirtBlack.jpg\n   2003    Shirt_1003   1001    12  C:\\Users\\Administrator\\Desktop\\Images\\LongSleeveShirtkhaki.jpg\n   2004    Shirt_1004   1001    13  C:\\Users\\Administrator\\Desktop\\Images\\LongSleeveShirtOrange.jpg\n   2005    Tshirt_1001  1002    13  C:\\Users\\Administrator\\Desktop\\Images\\PlainWhiteT.jpg\n   2006    Tshirt_1002  1002    12  C:\\Users\\Administrator\\Desktop\\Images\\PrintedTBlue.jpg\n   2007    Tshirt_1003  1002    13  C:\\Users\\Administrator\\Desktop\\Images\\PrintedTWhite.jpg\n   2008    Tshirt_1004  1002    12  C:\\Users\\Administrator\\Desktop\\Images\\LongSleeveBlackT.jpg\n</code></pre>\n\n<p>So these are the table I have in my entity model, now I want to write a linq query where I will pass the <code>productID</code> as parameter and I should get the <code>productid,productname,productdescription</code> of the <code>productid</code> passed as a parameter, and every <code>Sku</code> that product has each option the sku has and <code>imageURl</code> of the SKU. </p>\n\n<p>How can I write a linq query for this?</p>\n\n<p>this is how my model looks</p>\n\n<pre><code>                 public class ProductItems\n                  {\n                   public long ProductID { get; set; }\n                   public string ProductName { get; set; }\n                   public string ProductDescription { get; set; }\n                   public string ImageURL { get; set; }\n                   public string SKU { get; set; }\n                   public long OptionID { get; set; }\n                   public string optionName { get; set; }\n                   public string Value{ get; set; }\n                   public ProductItems()\n                    {\n                     if (SKUs == null )\n                      SKUs = new List&lt;productSKU&gt;();\n                     }\n                   public List&lt;productSKU&gt; SKUs { get; set; }     \n                   public List&lt;options&gt; oPTIONS { get; set; }\n                   }\n\n                 public class productSKU\n                   {\n                  public productSKU()\n                  {\n                  if (oPTIONS == null)                          \n                      oPTIONS = new List&lt;options&gt;();\n                    }\n                     public string productsku { get; set;}\n                    public string SKUImageURL { get; set;}\n                    public List&lt;options&gt; oPTIONS { get; set; }\n                    }\n\n                 public class options\n                    {\n                     public long OptionID { get; set; }\n                     public string OptionName { get; set;}\n                     public string OptionValue { get; set;}\n                    }\n</code></pre>\n\n<p>Now I want to bind <code>prodcuname,description</code> and <code>prodid</code> to <code>ProductItems</code> class and every sku details should be bound to <code>ProductSku</code> class and each <code>SKuOption</code> should be bound to options class </p>\n\n<p>I should get these columns at last <code>[ProductID ],[ProductName ],[ProductDescription ],[SKU],[OptionId],[OptionName],[Value],[ImageURL]</code> at last what I need is <code>ProductName,Description</code> every SKU of the product,every option value and name of the product</p>\n\n<p>this is waht i am trying to do but i am confused how to bind this to my model</p>\n\n<pre><code>                    var produ = from PS in products.ProductSKUs\n                    join PA in products.ProductAttributes on PS.SKU equals PA.SKU\n                    join p in products.Products on PS.ProductId equals p.ProductId\n                    join o in products.Options on PA.OptionId equals o.OptionsId\n                    where PS.ProductId==ID\n                    select new ProductItems()\n                          {\n                              ProductID=p.ProductId,\n                              ProductName=p.ProductName,\n                              ProductDescription = p.ProductDescription,\n</code></pre>\n\n<p>i am stuck here what to do next from here can any one help me here or provide me soltuion will be much gratefull</p>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12759366,"title":"Sort records in database or in memory C# Linq","body":"<p>Hi I have a database with categories and subcategories stored in my Category table. Categories have a ProjectId, Id, ParentId, SortCode, Description, Each subcategory can have orderlines. Orderline contains Id, CategoryId, ProjectId, Code, Description</p>\n\n<pre><code>00 Cat A\n   00 Subcat 1\n      00 - orderline 1\n</code></pre>\n\n<p>Categories and orderlines are large tables with about 1.000.000 records.\nNow I use a Join and do a sort on the parentId, code, Description to build the tree I want.\nIs it handy to use JOIN by great tables? </p>\n\n<p>Is it useful to sort them in memory by using LINQ?</p>\n"},{"tags":["vb.net","linq","split","linq-to-objects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12759348,"title":"Linq: Splitting each element in List(of String) and Select the required value","body":"<p>I wanted to parse the below response and select the values. I dont want to select the last line. Can anyone help me how to select the values using LINQ?</p>\n\n<p>\"John:55</p>\n\n<p>Kim:77</p>\n\n<p>Kevin:23</p>\n\n<p>[TimeGenerated: 15/12/2011 12:03:45][ResponseTime : 123.45ms]\"</p>\n\n<pre><code>Dim Response as String\n\nDim values as System.Collections.Generic.List(of String)(Response.split(vbcrlf))\n\nDim dbs as New List(of Double)\n\ndbs = from i in values\n      Select i.split(\":\")(1)\n</code></pre>\n"},{"tags":["linq","linq-to-sql","linq-to-xml","linq-to-objects"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12387620,"title":"How can i get Mulitiple subnode values using Linq to xml?","body":"<p>I got the Webservice Reponse in xml.</p>\n\n<pre><code>&lt;Items&gt;\n  &lt;Item&gt;\n    &lt;SmallImage&gt;\n      &lt;Url&gt;http://xxx&lt;url&gt;\n      &lt;height&gt;&lt;/height&gt;\n      &lt;weight&gt;&lt;/weight&gt;\n    &lt;/SmallImage&gt;\n    &lt;LargeImage&gt;\n      &lt;Url&gt;http://xxx&lt;url&gt;\n      &lt;height&gt;&lt;/height&gt;\n      &lt;weight&gt;&lt;/weight&gt;\n    &lt;/LargeImage&gt;\n    &lt;ItemAttributes&gt;\n      &lt;Binding&gt;Apparel&lt;/Binding&gt;\n      &lt;Brand&gt;Calvin Klein Jeans&lt;/Brand&gt;\n      &lt;Department&gt;mens&lt;/Department&gt;\n      &lt;Title&gt;Calvin Klein Jeans Men's Rusted Antique Skinny Jean&lt;/Title&gt;\n    &lt;/ItemAttributes&gt;\n    &lt;SimilarProducts&gt;\n       &lt;SimilarProduct&gt;\n         &lt;ASIN&gt;B0018QK10E&lt;/ASIN&gt;\n         &lt;Title&gt;New Balance Men's M574 Sneaker&lt;/Title&gt;\n       &lt;/SimilarProduct&gt;\n    &lt;/SimilarProducts&gt;\n  &lt;/Item&gt;\n&lt;/Items&gt;\n</code></pre>\n\n<p>Here, All i need to show the Title.\n   Items->Item->ItemAttributes->Title</p>\n\n<p>I tried like this.</p>\n\n<pre><code>           #region Product Title\n        var Title = xd.Descendants(ns + \"Item\").Select(b =&gt; new\n        {\n            PTitle = b.Element(ns + \"ItemAttributes\").Element(ns + \"Title\").Value\n        }).ToList();\n        #endregion \n</code></pre>\n\n<p>But It returns Object null. Please Let me know you need more information.\n   Thanks in advance.</p>\n"},{"tags":["linq","linq-to-sql","linq-to-xml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12422177,"title":"Replace string.empty and Show \"Null\" using linq to xml?","body":"<p>I need to show null or zero, instead of showing string empty.</p>\n\n<p>Xml Response:</p>\n\n<pre><code>&lt;Items&gt;\n   &lt;Item&gt;\n     &lt;ASIN&gt;111&lt;/ASIN&gt;\n      &lt;ItemAttributes&gt;\n       &lt;Title&gt;xxx&lt;/Title&gt;\n      &lt;ListPrice&gt;\n        &lt;Currency&gt;USD&lt;/Currency&gt;\n         &lt;FormattedPrice&gt;45.25&lt;/FormattedPrice&gt;\n        &lt;/ListPrice&gt;\n        &lt;/ItemAttributes&gt;\n        &lt;Variation&gt;\n        &lt;Item&gt;\n         &lt;ItemAttributes&gt;\n            &lt;Title&gt;yes&lt;/Title&gt;\n          &lt;/ItemAttributes&gt;\n        &lt;/Item&gt;\n        &lt;/Variation&gt;\n     &lt;/Item&gt;\n   &lt;Item&gt;\n     &lt;ASIN&gt;222&lt;/ASIN&gt;\n      &lt;ItemAttributes&gt;\n       &lt;Title&gt;yyy&lt;/Title&gt;\n       &lt;/ItemAttributes&gt;\n         &lt;Variation&gt;\n        &lt;Item&gt;\n         &lt;ItemAttributes&gt;\n            &lt;Title&gt;No&lt;/Title&gt;\n          &lt;/ItemAttributes&gt;\n        &lt;/Item&gt;\n        &lt;/Variation&gt;\n    &lt;/Item&gt;\n   &lt;Items&gt;\n</code></pre>\n\n<p>Here is my code.,</p>\n\n<pre><code>var Price1 = xd.Descendants(ns + \"ListPrice\").Select(c =&gt; new\n{\n    PPrice = (c.Element(ns + \"FormattedPrice\") != null) ? \n             c.Element(ns + \"FormattedPrice\").Value : **string.Empty**\n}).ToList();\n</code></pre>\n\n<p>How to replace String.Empty with Value like \"Null\" or 0. Thanks in advance.\n From Xml response if the \"FormattedPrice\" is not available for Item Two, It Should \n show or null in the list. </p>\n"},{"tags":[".net","vb.net","linq","crystal-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12725409,"title":"Using Linq and Crystal Reports with .Net Objects","body":"<p>I am trying to use crystal reports again with Linq but I am having problems. I have read a diverse amount of forums and articles on how this should be done but I am not sure what I could be doing wrong.</p>\n\n<p><strong>1st Method Tried</strong></p>\n\n<pre><code>Dim DBDataContext = GetDataConnection()\n\nDim cryRpt As IBS_DAL.cryLocationTransfer = New IBS_DAL.cryLocationTransfer()\ncryRpt.Load(cryRpt.FileName)\n\nDim testDS = From stl In DBDataContext.STranLines\n             Where stl.STLStkRef &gt;= \"000000000330\" AndAlso\n                   stl.STLStkRef &lt;= \"000000000337\" AndAlso\n                   (stl.STLTranCode = \"LI\" Or stl.STLTranCode = \"LO\")\n             Select stl.ToRepObj\n\ncryRpt.SetDataSource(testDS.ToList)\n\nCrystalReportViewer1.ReportSource = cryRpt\n</code></pre>\n\n<p>ToRepObj is currently setting to a class which I made so that it will use a object which doesn't have null value.</p>\n\n<p>But when the report loads it is asking for a password which makes absolutely no sense as I am feeding it the data.The server name is the .net object which I had previously set in the report.</p>\n\n<p>I really need to find a solution as I was previously using Microsoft Reporting but found some areas that are lacking and thus decided that it would be best to use Crystal but have never used it with Linq.</p>\n\n<p><strong>2nd Method Tried</strong></p>\n\n<p>I have also tried another way which I have seen on this <a href=\"http://stackoverflow.com/a/3861892/696406\">website</a> but for some reason it is giving me a blank report.The .Net Object are linked on stkcode in crystal report.</p>\n\n<pre><code>Dim testDS = (From stl In DBDataContext.STranLines\n                 Where stl.STLStkRef &gt;= \"000000000330\" AndAlso \n                       stl.STLStkRef &lt;= \"000000000337\" AndAlso\n                       (stl.STLTranCode = \"LI\" Or stl.STLTranCode = \"LO\")\n                 Select stl)\nDim ds1 = (From stl As STranLine In testDS\n           Select stl.ToRepObj).ToList\nDim ds2 = (From stl As STranLine In testDS\n           Select stl.Stock.ToRepObj).ToList\n\nDim cryrpt2 As ReportDocument = New IBS_DAL.CrystalReport1()\n\ncryrpt2.Database().Tables(\"IBS_DAL_roSTranLine\").SetDataSource(ds1)\ncryrpt2.Database().Tables(\"IBS_DAL_roStock\").SetDataSource(ds2)\n\nCrystalReportViewer1.ReportSource = cryrpt2\n</code></pre>\n"},{"tags":["vb.net","linq",".net-2.0","linqbridge"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12757758,"title":"Is it possible to use LinqBridge on datatable in VB.NET 9 on .NET 2.0","body":"<p>I was trying to find some example of using LinqBridge on datatable with VB9 and couldn't find any. Is it even possible. Can someone provide me an example. I just want to perform basic selects with grouping.</p>\n"},{"tags":["sql","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":1803005,"title":"How do I do this with LINQ?","body":"<p>I'm not entirely sure if I'm trying to do something a little too complex for this but what I essentially want to do is turn this:</p>\n\n<pre><code>declare @callid int\nset @callid = 57\ndeclare @update nvarchar(max)\ndeclare update_cursor cursor for\nselect UpdateIdentity from [Helpdesk_HR].[dbo].[hdEvents] \nwhere CallID = @callid group by UpdateIdentity order by UpdateIdentity \nopen update_cursor \n\nfetch next from update_cursor\ninto @update\n\nwhile @@FETCH_STATUS = 0\nbegin\n\n  select * \n  from [Helpdesk_HR].[dbo].[hdEvents]\n  where UpdateIdentity = @update\n\n  fetch next from update_cursor\n  into @update\nend\nclose update_cursor\ndeallocate update_cursor\n</code></pre>\n\n<p>into the LINQ equivalent. Can anyone tell me if this is even possible with LINQ? if so how?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["asp.net-mvc","linq","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12756675,"title":"linq qury for joining three tables","body":"<p>I have three tables table1(main table),table2,table3.</p>\n\n<pre><code>table1 contains table1Id,table2 and table3 contains table2Id,table2RoleId,table3Id,table3RoleId.\n</code></pre>\n\n<p>Also the same value of table1Id,more than one record in table2Id and table3Id but the table2RoleId's and table3RoleId's are different.</p>\n\n<p>I want to join table1 with table2 and table3 to display like\nTable2RoleId and Table3RoleId has to display according to the Table1Id </p>\n\n<p>How can i achieve this?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","xml-parsing","linq-to-xml","xdocument"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12685173,"title":"Looping through Xml data to output result","body":"<pre><code>var runnerElement = xDox.Descendants(\"User\")\n      .SingleOrDefault(u =&gt; u.Element(\"Name\").Value == \"David\");\n\nif (runnerElement != null)\n{\n    var result = runnerElement.Descendants(\"Runners\")\n      .Select(a =&gt; new\n        {\n\n            Date = DateTime.Parse(a.Element(\"Date\").Value),\n            MyLength = int.Parse(a.Element(\"Length\").Value)\n            City = a.Element(\"City\").Value,\n        })\n      .Where(a =&gt; a.Date &gt;= DateTime.Parse(\"3/29/2012\")\n                &amp;&amp; a.Date &lt;= DateTime.Parse(\"8/29/2012\"))\n\n      .GroupBy(a =&gt; a.City)\n      .Select(g =&gt; new {City = g.Key, Avg = g.Average(x =&gt; x.MyLength)});\n}\n</code></pre>\n\n<p>How would you loop through this data so it can give me an output something like this</p>\n\n<pre><code>User:David\nDate:3/29/2012 to 8/29/2012\nAverage Distance in Paris : //Data\nAverage Distance in Madrid: //Data\n</code></pre>\n\n<p>I try to clarified my code a little bit more..</p>\n"},{"tags":["linq","entity-framework","generics","linq-to-sql","expression-trees"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":121,"score":3,"question_id":12755022,"title":"Generic expression for where clause - \"The LINQ expression node type 'Invoke' is not supported in LINQ to Entities.\"","body":"<p>I am trying to write a really generic way to load EF entities in batches, using the Contains method to generate a SQL IN statement.  I've got it working if I pass the entire expression in, but when I try to build the expression dynamically, I am getting a \"The LINQ expression node type 'Invoke' is not supported in LINQ to Entities.\"  So I know this means that EF thinks I'm calling an arbitrary method and it can't translate it into SQL, but I can't figure out how to get it to understand the underlying expression.</p>\n\n<p>So If I do something like this (just showing the relevant snippets):</p>\n\n<p>Function declaration:</p>\n\n<pre><code>public static List&lt;T&gt; Load&lt;T&gt;(IQueryable&lt;T&gt; entityQuery, int[] entityIds, Func&lt;T, int&gt; entityKey, int batchSize = 500, Func&lt;T, bool&gt; postFilter = null) where T : EntityObject\n{\n    var retList = new List&lt;T&gt;();\n\n    // Append a where clause to the query passed in, that will use a Contains expression, which generates a SQL IN statement.  So our SQL looks something like\n    // WHERE [ItemTypeId] IN (1921,1920,1922)\n    // See http://rogeralsing.com/2009/05/21/entity-framework-4-where-entity-id-in-array/ for details\n    Func&lt;int[], Expression&lt;Func&lt;T, bool&gt;&gt;&gt; containsExpression = (entityArray =&gt; (expr =&gt; entityArray.Contains(entityKey(expr))));\n\n    // Build a new query with the current batch of IDs to retrieve and add it to the list we are returning\n    newQuery = entityQuery.Where&lt;T&gt;(containsExpression(entityIds));\n    retList.AddRange(newQuery.ToList());\n\n    return retList;\n} \n</code></pre>\n\n<p>Call function:</p>\n\n<pre><code>var entities = BatchEntity.Load&lt;ItemType&gt;(from eItemType in dal.Context.InstanceContainer.ItemTypes\nselect eItemType\n, itemTypeData\n, (ek =&gt; ek.ItemTypeId)\n);\n</code></pre>\n\n<p>I get \"The LINQ expression node type 'Invoke' is not supported in LINQ to Entities.\"</p>\n\n<p>But if I change it to be this:</p>\n\n<p>Function declaration:</p>\n\n<pre><code>public static List&lt;T&gt; Load&lt;T&gt;(IQueryable&lt;T&gt; entityQuery, int[] entityIds, Func&lt;int[], Expression&lt;Func&lt;T, bool&gt;&gt;&gt; containsExpression, int batchSize = 500, Func&lt;T, bool&gt; postFilter = null) where T : EntityObject\n{\n    var retList = new List&lt;T&gt;();\n\n    // Build a new query with the current batch of IDs to retrieve and add it to the list we are returning\n    newQuery = entityQuery.Where&lt;T&gt;(containsExpression(entityIds));\n    retList.AddRange(newQuery.ToList());\n\n    return retList;\n} \n</code></pre>\n\n<p>Call function:</p>\n\n<pre><code>var entities = BatchEntity.Load&lt;ItemType&gt;(from eItemType in dal.Context.InstanceContainer.ItemTypes\nselect eItemType\n, itemTypeData\n, (entityArray =&gt; (ek =&gt; entityArray.Contains(ek.ItemTypeId)))\n);\n</code></pre>\n\n<p>It works fine.  Is there any way I can make EF understand the more generic version?</p>\n"},{"tags":["c#","linq","type-inference","code-readability"],"answer_count":5,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":331,"score":6,"question_id":4559257,"title":"How can I implement NotOfType<T> in LINQ that has a nice calling syntax?","body":"<p>I'm trying to come up with an implementation for <code>NotOfType</code>, which has a readable call syntax. <code>NotOfType</code> should be the complement to <code>OfType&lt;T&gt;</code> and would consequently yield all elements that are <em>not</em> of type <code>T</code></p>\n\n<p>My goal was to implement a method which would be called just like <code>OfType&lt;T&gt;</code>, like in the last line of this snippet:</p>\n\n<pre><code>public abstract class Animal {}\npublic class Monkey : Animal {}\npublic class Giraffe : Animal {}\npublic class Lion : Animal {}\n\nvar monkey = new Monkey();\nvar giraffe = new Giraffe();\nvar lion = new Lion();\n\nIEnumerable&lt;Animal&gt; animals = new Animal[] { monkey, giraffe, lion };\n\nIEnumerable&lt;Animal&gt; fewerAnimals = animals.NotOfType&lt;Giraffe&gt;();\n</code></pre>\n\n<p>However, I can not come up with an implementation that supports that specific calling syntax.</p>\n\n<p>This is what I've tried so far:</p>\n\n<pre><code>public static class EnumerableExtensions\n{\n    public static IEnumerable&lt;T&gt; NotOfType&lt;T&gt;(this IEnumerable&lt;T&gt; sequence, Type type)\n    {\n        return sequence.Where(x =&gt; x.GetType() != type);\n    }\n\n    public static IEnumerable&lt;T&gt; NotOfType&lt;T, TExclude&gt;(this IEnumerable&lt;T&gt; sequence)\n    {\n        return sequence.Where(x =&gt; !(x is TExclude));\n    }\n}\n</code></pre>\n\n<p>Calling these methods would look like this:</p>\n\n<pre><code>// Animal is inferred\nIEnumerable&lt;Animal&gt; fewerAnimals = animals.NotOfType(typeof(Giraffe));\n</code></pre>\n\n<p>and</p>\n\n<pre><code>// Not all types could be inferred, so I have to state all types explicitly\nIEnumerable&lt;Animal&gt; fewerAnimals = animals.NotOfType&lt;Animal, Giraffe&gt;();\n</code></pre>\n\n<p>I think that there are major drawbacks with the style of both of these calls. The first one suffers from a redundant \"of type/type of\" construct, and the second one just doesn't make sense (do I want a list of animals that are neither Animals nor Giraffes?).</p>\n\n<p>So, is there a way to accomplish what I want? If not, could it be possible in future versions of the language? (I'm thinking that maybe one day we will have named type arguments, or that we only need to explicitly supply type arguments that can't be inferred?)</p>\n\n<p>Or am I just being silly?</p>\n"},{"tags":["c#","visual-studio-2010","linq","xml-parsing"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":53,"score":4,"question_id":12754354,"title":"Parsing of XML string (with namespace) using LINQ","body":"<p><strong>My Input</strong></p>\n\n<pre><code>&lt;A xmlns=\"http://abc.com\"&gt; \n    &lt;B&gt;\"b\"&lt;/B&gt;\n    &lt;C&gt;\"c\"&lt;/C&gt;\n    &lt;/A&gt;\n</code></pre>\n\n<p><strong>My Code</strong></p>\n\n<pre><code>XNamespace ns = XNamespace.Get(\"http://abc.com\");\n\nvar query= from node in doc.Descendants(ns+ \"A\") \n           select new\n            (\n                        B = (string)node.Element(ns+\"B\"),\n                            C = (string)node.Element(ns+ \"C\")\n             );\n</code></pre>\n\n<p><strong>My Question</strong></p>\n\n<p>Do I have to add <code>ns</code> every time  I am doing <code>node.Element()</code>? or is there any other way?</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":67,"score":5,"question_id":12753762,"title":"Linq syntax for OrderBy with custom Comparer<T>","body":"<p>There are two formats for any given Linq expression with a custom sort comparer:</p>\n\n<p>Format 1</p>\n\n<pre><code>var query =\n    source\n    .Select(x =&gt; new { x.someProperty, x.otherProperty } )\n    .OrderBy(x =&gt; x, new myComparer());\n</code></pre>\n\n<p>Format 2</p>\n\n<pre><code>var query =\n    from x in source\n    orderby x // comparer expression goes here?\n    select new { x.someProperty, x.otherProperty };\n</code></pre>\n\n<p><strong>Question:</strong><br>\nWhat is the syntax for the order-by expression in the second format?</p>\n\n<p><strong>Not the question:</strong><br>\nHow to use a custom comparer as shown in the first format.</p>\n\n<p><strong>Bonus credit:</strong><br>\nAre there actual, formal names for the two Linq formats listed above?</p>\n"},{"tags":["asp.net","linq","listview"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12735330,"title":"LINQ - listview - 2 levels of data in one table","body":"<p>I have been trying to solve this problem and I can't seem to figure it out. I'm not sure if it's because of my db design and LINQ, but I'm hoping for some direction here.</p>\n\n<p>My db table:</p>\n\n<pre><code>IdNameParentId \n1 Data1null \n2 Data2null \n3 Data3null \n4 Data41 \n5 Data51 \n6 Data62 \n7 Data72 \n</code></pre>\n\n<p>Basically Data1 and Data2 are the top levels that I want to use for headings and their children will be related based on their ParentID.</p>\n\n<p>I am trying to use a listview to present the data like the following:</p>\n\n<pre><code>Data1\n-----\n   Data4\n   Data5\n\nData2\n-----\n   Data6\n   Data7\n</code></pre>\n\n<p>I am trying to use a combination of LINQ and listview to accomplish this.</p>\n\n<p>The following is the code for the linq query:</p>\n\n<pre><code>var query = from data in mydb.datatable\nwhere data.ParentId == null\nselect data;\n</code></pre>\n\n<p>But this only gives the heading level... and unfortunately listview only takes in 1 datasource.</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":66,"score":-3,"question_id":12753616,"title":"Working with List","body":"<p>I have two list : (Note: List's Items are combination of \"NAME\" &amp; \"ID\" )</p>\n\n<pre><code>List&lt;string&gt; ListA = new List() {\"SAM001\",\"SAM002\",\"SAM003\",\"PIT001\",\"PIT002\",\"PIT004\",\"ROSE001\",\"ROSE002\",\"JASE001\" };\n//so on\n\nList&lt;string&gt; ListB = new List() {\"SAM001\",\"SAM003\",\"PIT000\",\"ROSE002\",\"JASE001\",\"INDI000\"};` \n//so on...\n</code></pre>\n\n<p>Now Based on these two list i want to create two new list suppose listCommon &amp; listUncommon.</p>\n\n<p>listCommon will contain all matched items of ListA &amp; ListB.</p>\n\n<p>listUnCommon will contain all remaining items of ListA</p>\n\n<p><strong>Now My condition is if Any item in ListB has NAME + 000 then all the items of ListA starting with that Name should add in my listCommon.</strong></p>\n\n<p>Example 1 : if ListB item is PIT000 and ListA item are PIT001,PIT002,PIT003,ABC001\nthen listCommon = PIT001,PIT002,PIT003 because ListB has PIT with 000 so condition true all ListA 'PIT' items added in listcommon</p>\n\n<p>So as above list and my condition i want my final list below</p>\n\n<pre><code>List&lt;string&gt; listCommon = new List() {\"SAM001\",\"SAM003\", \"PIT001\",\"PIT002\",\"PIT004\",\"ROSE002\", \"JASE001\" };\nList&lt;string&gt; listUncommon = new List() {\"SAM002\", \"ROSE001\"};\n</code></pre>\n\n<p>Please suggest..i just spend my couple of minutes in loops but not getting actual result as i mentioned :(</p>\n"},{"tags":["c#","linq","join","lambda","one-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12339132,"title":"LINQ using Join on a long and long[] typed properties (one to many variation)","body":"<p>I am trying to find a better way to write an effective JOIN using LINQ and Lambda expressions, hopefully using a Join, to work with the following types:</p>\n\n<pre><code>public class Patent\n{\n    public string Title { get; set; }\n    public string YearOfPublication { get; set; }\n    public long[] InventorIds { get; set; }\n}\n\npublic class Inventor\n{\n    public long Id { get; set; }\n    public string Name { get; set; }\n}\n</code></pre>\n\n<p>The subsequent data is being created as such:</p>\n\n<pre><code>public static class PatentData\n{\n    public static readonly Inventor[] Inventors = new Inventor[]\n    {\n        new Inventor(){\n            Name=\"Benjamin Franklin\", Id=1 },\n        new Inventor(){\n            Name=\"Orville Wright\", Id=2},\n        new Inventor(){\n            Name=\"Wilbur Wright\", Id=3}\n    };\n    public static readonly Patent[] Patents = new Patent[]\n    {\n        new Patent(){\n            Title=\"Bifocals\", YearOfPublication=\"1784\",\n            InventorIds=new long[] {1}},\n        new Patent(){\n            Title=\"Flying machine\", YearOfPublication=\"1903\",\n            InventorIds=new long[] {2,3}}\n    };\n}\n</code></pre>\n\n<p>To iterate through all the inventors for a particular patent, I am using the following code below.</p>\n\n<pre><code>IEnumerable&lt;Patent&gt; patents = PatentData.Patents;\nIEnumerable&lt;Inventor&gt; inventors = PatentData.Inventors;\n\nforeach(Patent p in patents)\n{\n    var iall = inventors.Where(i =&gt; p.InventorIds.Contains(i.Id));\n    foreach (Inventor i in iall)\n    {\n        Debug.WriteLine(p.Title + \": \" + i.Id);\n    }\n}\n</code></pre>\n\n<p>Although the code above works fine, I would really like to use a LINQ Join statement. The problem, obviously, is that the LINQ Join statement will grumble about the different types (long and long[]) which are primary and foreign keys respectively.</p>\n\n<p>The code that I would have preferred to use of which I can't seem to get working, is follows:</p>\n\n<pre><code>Patent [] patents = PatentData.Patents;\nInventor [] inventors = PatentData.Inventors;\n\nvar result = patents.Join(inventors, patent =&gt; patent.InventorIds, inventor =&gt; inventor.Id, (patent, inventor) =&gt; new\n{\n    patent.Title,\n    inventor.Name\n});\n</code></pre>\n\n<p>This is failing, quite rightly, with the following error:</p>\n\n<p><em>error CS0411: The type arguments for method 'System.Linq.Enumerable.Join(System.Collections.Generic.IEnumerable, System.Collections.Generic.IEnumerable, System.Func, System.Func, System.Func)' cannot be inferred from the usage. Try specifying the type arguments explicitly.</em></p>\n\n<p>So, my question is:</p>\n\n<p>How can I repair the code that has the error to work with the Join statement when used in conjunction with the two types; Patent and Inventor - without modifying the types at all? Is it even possible?</p>\n\n<p>I appreciate that I can change the types so that they are better structured, but humour me for a moment.</p>\n"},{"tags":[".net","linq","entity-framework","exception","visual-studio-2012"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":259,"score":9,"question_id":12489749,"title":"Linq to EF Join throws \"Index was out of range\" after upgrade from VS2010 to VS2012","body":"<p>After upgrading from Visual Studio 2010 to 2012 code started throwing \"ArgumentOutOfRangeException - Index was out of range. Must be non-negative and less than the size of the collection.Parameter name: index\" on Linq queries using Joins.</p>\n\n<p>The following simple example made in LINQPad (using an EF data model) gives me the ArgumentOutOfRangeException:</p>\n\n<pre><code>void Main()\n{\n    var iq1 = Customers.Select(ap =&gt; ap.ID);\n    var iq2 = iq1.Join(Customers.Select(ap =&gt; ap.ID),\n                    a =&gt; a,\n                    b =&gt; b,\n                    (a, b) =&gt; new { a });\n\n    iq2.Dump(); \n}\n</code></pre>\n\n<p>Changing the previous example to return an anonymous object containing both sides of the join doesn't give the ArgumentOutOfRangeException and gives results as expected:</p>\n\n<pre><code>void Main()\n{\n    var iq1 = ActionPlans.Select(ap =&gt; ap.ID);\n    var iq2 = iq1.Join(ActionPlans.Select(ap =&gt; ap.ID),\n                    a =&gt; a,\n                    b =&gt; b,\n                    (a, b) =&gt; new { a, b });\n\n    iq2.Dump(); \n}\n</code></pre>\n\n<p>Ok, so for some reason I had to return both sides of the join, but then I tried the following example using a dummy value instead, that also executed without a problem:</p>\n\n<pre><code>void Main()\n{\n    var iq1 = ActionPlans.Select(ap =&gt; ap.ID);\n    var iq2 = iq1.Join(ActionPlans.Select(ap =&gt; ap.ID),\n                    a =&gt; a,\n                    b =&gt; b,\n                    (a, b) =&gt; new { a, x = 1 });\n\n    iq2.Dump(); \n} \n</code></pre>\n\n<p>Taking the first example and adding a ToList() to the first query also makes it execute without a problem:</p>\n\n<pre><code>void Main()\n{\n    var iq1 = ActionPlans.Select(ap =&gt; ap.ID).ToList();\n    var iq2 = iq1.Join(ActionPlans.Select(ap =&gt; ap.ID),\n                    a =&gt; a,\n                    b =&gt; b,\n                    (a, b) =&gt; new { a });\n\n    iq2.Dump(); \n}\n</code></pre>\n\n<p><strong>Important:</strong> Trying the first query on a workstation without the Visual Studio 2012 upgrade works fine!</p>\n\n<p>Can anyone confirm/explain this new \"feature\"? :-)</p>\n"},{"tags":["linq","entity-framework","c#-4.0","caching","enterprise-library"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":181,"score":1,"question_id":12600710,"title":"Entity Framework - System.IndexOutOfRangeException","body":"<p>I'm using entity framework 4.1 which queries a SQL Server 2008 database. Unfortunately every often we get the exception below:</p>\n\n<pre><code>&lt;ExceptionType&gt;System.IndexOutOfRangeException, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&lt;/ExceptionType&gt;\n  &lt;Message&gt;Index was outside the bounds of the array.&lt;/Message&gt;\n\n\n\nat System.Data.SqlClient.SqlDataReader.ReadColumnHeader(Int32 i)\n   at System.Data.SqlClient.SqlDataReader.IsDBNull(Int32 i)\n   at System.Data.Common.Internal.Materialization.Shaper.ErrorHandlingValueReader`1.GetValue(DbDataReader reader, Int32 ordinal)\n   at System.Data.Common.Internal.Materialization.Shaper.GetPropertyValueWithErrorHandling[TProperty](Int32 ordinal, String propertyName, String typeName)\n   at lambda_method(Closure , Shaper )\n   at System.Data.Common.Internal.Materialization.Shaper.HandleEntityAppendOnly[TEntity](Func`2 constructEntityDelegate, EntityKey entityKey, EntitySet entitySet)\n   at lambda_method(Closure , Shaper )\n   at System.Data.Common.Internal.Materialization.Coordinator`1.ReadNextElement(Shaper shaper)\n   at System.Data.Common.Internal.Materialization.Shaper`1.SimpleEnumerator.MoveNext()\n   at System.Linq.Enumerable.First[TSource](IEnumerable`1 source)\n   at System.Linq.Queryable.First[TSource](IQueryable`1 source)\n   at OnlineSelfService.Business.ContentServiceBusiness.GetPageContent(Int32 pageId)&lt;/StackTrace&gt;\n</code></pre>\n\n<p>The actual sample code:</p>\n\n<pre><code>//Caller\n  public EmployeeEntity GetEmployeeDetail(int employeeID)\n    {\n         IQueryable&lt;Employee&gt; result=null;\n         if (myCaching.Contains(\"Employee\"))\n            {\n                result = (IQueryable&lt;Employee&gt;)myCaching[\"Employee\"];\n            }\n            else\n            {\n                result = dataAccess.GetEmployeeDetail();\n                myCaching.AddToCache(\"Employee\", result); //Expire in 2min\n            }\n\n            IQueryable&lt;Employee&gt; entityResult = from entity in result\n                                                         where entity.employeeId == employeeID\n                                                         select entity;\n       if (entityResult.Count&lt;Employee&gt;() &gt; 0)\n                return entityResult.First&lt;Employee&gt;();\n            return new EmployeeEntity();\n   }\n</code></pre>\n\n<p>}</p>\n\n<pre><code>//DAL\npublic IQueryable&lt;Employee&gt; GetEmployeeDetail()\n{\n    DatabaseEntities ent = new DatabaseEntities(this._connectionString);\n    IQueryable&lt;Employee&gt; result = from employee in ent.EmployeeEntity\n                                           select employee;\n\n    return result;\n}\n</code></pre>\n\n<p><strong>UPDATE**</strong>\nUpdated my code with caching.</p>\n\n<p>I googled to find and answer but could not find a definitive answer the root cause. Could some who have faced this issue share a resolution.</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#","asp.net-mvc","linq"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12752273,"title":"Why is it deleting from other variable while I am Removing from different variable in C#.net?","body":"<p>I have the below code.\nI am removing the data in <strong>RecoveryRecords</strong> variable based on the below conditions if it is not in the ValidClaimControl Numbers.</p>\n\n<p>After executing the line at <strong>RecoveryRecords.Remove(s)</strong>, it is removing from <strong>records</strong> variable also. I actually need the data from <strong>records</strong> variable. </p>\n\n<p>I am wondering how i can retain data in <strong>records</strong> variable?</p>\n\n<pre><code>List&lt;List&lt;Field&gt;&gt; records = new List&lt;List&lt;Field&gt;&gt;();\nList&lt;List&lt;Field&gt;&gt; RecoveryRecords = new List&lt;List&lt;Field&gt;&gt;();\n\n//Some Logic here to populate records variable\n\nRecoveryRecords = records;\nList&lt;string&gt; validClaimControlNo = new List&lt;string&gt;();\n\n//Some Logic here to populate validClaimControlNo variable\n\nforeach (List&lt;Field&gt; s in RecoveryRecords.ToList())\n{\n    foreach (Field f in s)\n    {\n        if (!(validClaimControlNo.Contains(f.Value)))\n          RecoveryRecords.Remove(s);\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","entity-framework-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12724882,"title":"Query doesnt produce the expected result","body":"<pre><code>using (Entities PlatfrmName = new Entities())\n{\n    foreach (string selectedProject in SplitSelectedprojects)\n    {\n        var platformId = from platformID in PlatfrmName.AppProjects84\n                         where platformID.ProjectName == selectedProject\n                         select platformID.PlatformId;\n\n                        var platformName = from platfrmName in PlatfrmName.AppPlatforms84\n                                           where platfrmName.PlatformId.ToString() == platformId.ToString()\n                                           select platfrmName.PlatformName;\n                        //Get the projects based on the platforms\n                        if (platformName.ToString() == \"Base\")\n                            BASE += selectedProject + \",\";\n                        if (platformName.ToString() == \"Windows\")\n                            WINDOWS += selectedProject + \",\";\n                        if (platformName.ToString() == \"Web\")\n                            WEB += selectedProject + \",\";\n                        if (platformName.ToString() == \"Wpf\")\n                            WPF += selectedProject + \",\";\n                        if (platformName.ToString() == \"Silverlight\")\n                            SILVERLIGHT += selectedProject + \",\";\n                        if (platformName.ToString() == \"Mvc\")\n                            MVC += selectedProject + \",\";\n    }\n}\n</code></pre>\n\n<p>I expect the result as <code>platformName == Base</code>, then that project should be added to the BASE variable. When the control comes to the  <code>if (platformName.ToString() == \"Base\")</code>, I hover the cursor to that, it shows nothing. can anyone help me out this.</p>\n"},{"tags":["c#","asp.net","linq","entity-framework","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12740135,"title":"Convert Sql Pivot table query to linq in EF4","body":"<p>I have been doing one task from last three days. I try to convert one sql query into linq which is based on \"Convert Columns into Rows\" called Pivot table.</p>\n\n<p><strong>My SQL Query is as under.</strong></p>\n\n<pre><code>SELECT project_name\n,SUNDAY\n,MONDAY\n,TUESDAY\n,WEDNESDAY\n,THRUSDAY\n,FRIDAY\n,SATURDAY\nFROM\n(\n    SELECT project_name\n    ,personnel_name\n    ,DATENAME(dw, report_date) AS day_name\n    ,SUM(hours) AS HOURS\n    FROM [TimeSheet]\n\n    INNER JOIN [ProjectMaster] \n    ON [TimeSheet].[project_id] = [ProjectMaster].[project_id]\n\n    INNER JOIN [Personnel] \n    ON [TimeSheet].[personnel_id] = [Personnel].[personnel_id]\n    WHERE report_date BETWEEN getdate() - 7 AND getdate()\n    GROUP BY project_name, personnel_name, DATENAME(dw, report_date)\n) sourceQuery PIVOT (SUM(hours) \n FOR day_name IN \n (SUNDAY,MONDAY,TUESDAY,WEDNESDAY,THRUSDAY,FRIDAY,SATURDAY)) AS pvt\n</code></pre>\n\n<p><strong>What I do so far convert it into linq is below!!!</strong></p>\n\n<pre><code>var before = DateTime.Now.AddDays(-7);\nDateTime firstSunday = new DateTime(1753, 1, 7); \n\nvar DayWiseTS = from TSList in objWPFEntities.Timesheets.Include(\"ProjectMaster\").Include(\"Personnel\")\nwhere (TSList.report_date &gt;= before &amp;&amp; TSList.report_date &lt;= System.DateTime.Now)\nselect new { TSList.ProjectMaster.project_name, TSList.Personnel.personnel_name, TSList.report_date, TSList.hours } into sourceQuery\ngroup sourceQuery by new { sourceQuery.project_name, sourceQuery.personnel_name, sourceQuery.report_date, sourceQuery.hours } into pvt\nselect new \n{ \nprojectname = pvt.Key.project_name,\nSunday = (EntityFunctions.DiffDays(firstSunday, pvt.Key.report_date.Value) % 7 == 0 ? pvt.Sum(g =&gt; g.hours) : 0),\nMonday = (EntityFunctions.DiffDays(firstSunday, pvt.Key.report_date.Value) % 7 == 1 ? pvt.Sum(g =&gt; g.hours) : 0),\nTuesday = (EntityFunctions.DiffDays(firstSunday, pvt.Key.report_date.Value) % 7 == 2 ? pvt.Sum(g =&gt; g.hours) : 0),\nWednesday = (EntityFunctions.DiffDays(firstSunday, pvt.Key.report_date.Value) % 7 == 3 ? pvt.Sum(g =&gt; g.hours) : 0),\nThrusday = (EntityFunctions.DiffDays(firstSunday, pvt.Key.report_date.Value) % 7 == 4 ? pvt.Sum(g =&gt; g.hours) : 0),\nFriday = (EntityFunctions.DiffDays(firstSunday, pvt.Key.report_date.Value) % 7 == 5 ? pvt.Sum(g =&gt; g.hours) : 0),\nSaturday = (EntityFunctions.DiffDays(firstSunday, pvt.Key.report_date.Value) % 7 == 6 ? pvt.Sum(g =&gt; g.hours) : 0)\n};\n</code></pre>\n\n<p>I got result in both query but in sql, I got perfect result as I required, but in linq, I haven't get required data as sql.</p>\n\n<p><strong>sql result ::</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/diEXD.png\" alt=\"enter image description here\"></p>\n\n<p><strong>Linq result ::</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/iIon7.png\" alt=\"enter image description here\"></p>\n\n<p>I think, in my linq query, I failed to do group by on hours!!</p>\n\n<p>can any one help me on this??</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12749430,"title":"Linq`s Intersect does not call GetHashCode","body":"<pre><code>var resultList = list1.Intersect&lt;XElement&gt;(list2, new XElementComparer());\n</code></pre>\n\n<p>Why is the GetHashCode method of my XElementComparer never called?</p>\n\n<p>When I check the content of the resultList I see: </p>\n\n<pre><code>System.Exeception object to set to an instance of an object\n</code></pre>\n\n<p>Both my lists have XElements. What do I wrong?</p>\n"},{"tags":["linq","nhibernate","fluent-nhibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12745428,"title":"Fluent NHibernate filter child collection with Linq","body":"<p>I am trying to retrieve a root aggregate and its children, applying a date filter on child collection.</p>\n\n<pre><code>CREATE TABLE Shop\n(\n    Id int\n)\n\nCREATE TABLE Order\n(\n    ShopId int,\n    OrderDate datetime\n)\n</code></pre>\n\n<p>Naturally, child object doesn't have a ShopId property to avoid bi-directional reference:</p>\n\n<pre><code>class Shop\n{\n    int Id { get; set; }\n    List&lt;Order&gt; { get; set; }\n}\n\nclass Order\n{\n    DateTime OrderDate { get; set; }\n}\n</code></pre>\n\n<p>And FNHB mappings looks like this:</p>\n\n<pre><code>public ShopMap()\n{\n    this.Table(\"SHOP\");\n    this.Id(x =&gt; x.Id).Column(\"ID\");\n    this.HasMany(x =&gt; x.Orders).Table(\"ORDER\").KeyColumn(\"SHOP_ID\");\n}\n\npublic OrderMap()\n{\n    this.Table(\"ORDER\");\n    this.Map(x =&gt; x.OrderDate);\n}\n</code></pre>\n\n<p><strong>I'm trying to retrieve a given Shop with its Orders placed between certain dates</strong>, given parameters <code>shopId, fromDate, toDate</code>, I've tried this but it throws exception:</p>\n\n<pre><code>Session.Query&lt;Shop&gt;().Where(shop =&gt; shop.Id == shopId)\n.FetchMany(\n    shop =&gt; shop.Orders.Where(\n        order =&gt; order .OrderDate &gt;= fromDate &amp;&amp; order.OrderDate &lt;= toDate));\n</code></pre>\n\n<p>Can this be achieved without a use of Magic Strings (NHb criteria, HQL etc.), preferebly with a simple Linq query?</p>\n"},{"tags":["c++","linq","functional-programming","iterator"],"answer_count":6,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":1803,"score":7,"question_id":1565406,"title":"C++ LINQ-like iterator operations","body":"<p>Having been tainted by Linq, I'm reluctant to give it up.  However, for some things I just need to use C++.</p>\n\n<p>The real strength of linq as a linq-consumer (i.e. to me) lies not in expression trees (which are complex to manipulate), but  the ease with which I can mix and match various functions.  Do the equivalents of <code>.Where</code>, <code>.Select</code> and <code>.SelectMany</code>,  <code>.Skip</code> and <code>.Take</code> and <code>.Concat</code> exist for C++-style iterators?</p>\n\n<p>These would be extremely handy for all sorts of common code I write.</p>\n\n<p>I don't care about LINQ-specifics, the key issue here is to be able to express algorithms at a higher level, not for C++ code to look like C# 3.0.  I'd like to be able to express \"the result is formed by the concatenation first n elements of each sequence\" and then reuse such an expression wherever a new sequence is required - without needed to manually (and greedily) instantiate intermediates.</p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12749019,"title":"linq calculated value with group by","body":"<p>Having a little trouble constructing a linq statement (C#, query syntax but I could handle method sytax). It needs to support grouping as well as a exposing a calculated property. I have a handle on each individually but can't get them to seem to work together. Any help would be appreciated.</p>\n\n<p><strong>Data</strong>  </p>\n\n<pre><code>GrpField          Qty      Price\n-------------     ---      -----\nRED                1        10\nRED                2        10\nRED                1        50\nBLUE               2        30\nBLUE               2        50\n</code></pre>\n\n<p>Output needs to be sum of Total Price (Qty * Price) for each group</p>\n\n<p><strong>Desired Result</strong></p>\n\n<pre><code>RED    80\nBLUE  160\n</code></pre>\n\n<p>This gets me the Total Price line</p>\n\n<pre><code>from x in origdata\nlet linetotal = x.qty * x.price\nselect new { x.grpfield, x.qty, x.price, linetotal } \n</code></pre>\n\n<p>But I am unable to group by the new anonymous type since you can't run aggregates like sum on anonymous types. If I run the group first, I can't figure out how to work the linetotal into the mix BEFORE the aggregate sum.</p>\n"},{"tags":["c#","asp.net","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":12748641,"title":"Inserting Related Records into Database via Entity Framework","body":"<p>I'm curious if there is a clean way to do this</p>\n\n<pre><code>Product product = new Product();\nproduct.CreateDateTime = DateTime.Now;\nproduct.Description = productCreateModel.Product.Description;\nproduct.ManufacturerId = productCreateModel.Manufacturer;\nproduct.MetaDescription = productCreateModel.Product.MetaDescription;\nproduct.MetaTitle = productCreateModel.Product.MetaTitle;\nproduct.Name = productCreateModel.Product.Name;\nproduct.Status = ProductStatuses.Active;\nproduct.URL = productCreateModel.Product.URL;\n\nif (productCreateModel.ProductImage1.ContentLength &gt; 0)\n    {\n        BinaryReader binaryReader = new BinaryReader(productCreateModel.ProductImage1.InputStream);\n                product.ProductImages.Add(new ProductImage()\n                {\n                    CreateDateTime = DateTime.Now,\n                    Image = binaryReader.ReadBytes(productCreateModel.ProductImage1.ContentLength),\n                    PrimaryImage = true\n                });\n    }\ndb.Products.Add(product);\ndb.SaveChanges();\n</code></pre>\n\n<p>The problem i'm running into is that the product.ProductImages is null - I'd love to be able to do it this way INSTEAD of doing multiple db.TableName.Add/db.SaveChanges because if I understand it correctly EF creates a transaction so that if anything fails you won't have phantom product records inserted with no product images - if that makes sense?</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":93,"score":3,"question_id":12739467,"title":"nested LINQ query, error message","body":"<p>I am currently trying to do a nested query in linq, but I am receiving an error message:</p>\n\n<pre><code>var subcatquery = from categories in mydb.Categories\n                  where categories.ParentId == null\n                  select new\n                  {\n                      category = categories.Name,\n                      subcat = (from sub in mydb.Categories\n                                where sub.ParentId == sub.Id\n                                select new\n                                {\n                                    subcatItem = sub.Name,\n                                    subcatId = sub.Id\n                                 })\n                    };\n</code></pre>\n\n<p>Results View =<code>The type '&lt;&gt;f__AnonymousType0&lt;subcatItem,subcatId&gt;' exists in both 'myapplication.dll' and 'System.Web.dll'</code></p>\n\n<p>I can't underestand why.. if I remove the sub query and put it on it's own... it's perfectly fine.</p>\n\n<p>the <code>subcat</code> type is a <code>collection&lt;&gt;</code>, is this where the problem is?</p>\n\n<pre><code>    class categoryGroup \n    {\n        public string category;\n        public Collection&lt;subcategoryGroup&gt; subcat;\n\n    }\n    class subcategoryGroup\n    {\n        public string subcatItem;\n        public int subcatId;\n\n    }\n</code></pre>\n"},{"tags":["c#","linq","c#-4.0","pdf","c#-3.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12747533,"title":"How to get the number of pages inside each pdf document inside a directory","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/320281/determine-number-of-pages-in-a-pdf-file-using-c-sharp-net-2-0\">Determine Number of Pages in a PDF File using C# (.NET 2.0)</a>  </p>\n</blockquote>\n\n\n\n<p>I used the following code to get the count of number of pdf files in a directory.</p>\n\n<pre><code>    var extensions = new HashSet&lt;string&gt;(StringComparer.OrdinalIgnoreCase) \n    {\n        \".pdf\", \n    };\n    var baseDir = BatchFolderPath;\n    var pdfFilesCount = Directory.EnumerateFiles(baseDir)\n                                 .Count(filename =&gt;\n                                        extensions.Contains(Path.GetExtension(filename)));\n</code></pre>\n\n<p>I don't know how to get the number of pages inside each pdf document inside a directory. Please help. Thanks.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":92,"score":4,"question_id":12744980,"title":"How can I use Linq to create an IEnumerable based on line breaks in a string?","body":"<p>I have some C# code in a string that looks like this:</p>\n\n<pre><code>content = 'var expData = \n                        details.Select(x =&gt; x.Explanation.TextWithHtml).ToList();\nvar score = resData.SequenceEqual(ansData);\nvar explanation = \"\";';\n</code></pre>\n\n<p>How can I make it so the code is converted to the following using LINQ?</p>\n\n<pre><code>&lt;td&gt;01&lt;/td&gt;&lt;td&gt;var expData = \n                  details.Select(x =&gt; x.Explanation.TextWithHtml ).ToList();&lt;/td&gt;\n&lt;td&gt;02&lt;/td&gt;&lt;td&gt;var score = resData.SequenceEqual(ansData);&lt;/td&gt;\n&lt;td&gt;03&lt;/td&gt;&lt;td&gt;var explanation = \"\";&lt;/td&gt;\n</code></pre>\n"},{"tags":["linq","select","subselect"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12744735,"title":"Get only one value from the table using LINQ","body":"<p>I have a Customer Table and a Address Table (customer_id,                                                 address_forename, address_surname, address_street, address_city, address_zip,\naddress_storedtime) where customer_id as a foreign key.</p>\n\n<p>One customer can have several address.</p>\n\n<p>Now I am trying to get only the last entered address using LINQ as bellow which should allow me put the address in a string and return that:\nCODE:    </p>\n\n<pre><code>var customerAddress = (from c in myDB.address\n                       where (c.customer_id == customerId)\n                       select new\n                       {\n                           c.customer_id,\n                           c.address_forename,\n                           c.address_surname,\n                           c.address_street,\n                           c.address_city,\n                           c.address_zip,\n                           c.address_storedtime\n                       }).GroupBy(g =&gt; new\n                       {\n                           Customer = .customer_id,\n                           Address = g.address_forename + \" \" + g.address_surname + \" \" + g.address_street + \" \" +        g.address_city + \" \" + g.address_zip \n                       }).Select(g =&gt; new\n                       {\n                           g.Key.Customer,\n                           g.Key.Address,   \n                           StoredTime = g.Max(x =&gt; x.address_storedtime)\n                       }).Disinct();/*First();*/\n\nstring result = \"\";\n\nforeach (var ad in customerAddress)\n{\n    if (ad.Address != null)\n    {\n        result = ad.Address;\n    }\n    break;\n}\n\nreturn result;\n</code></pre>\n\n<p>I am getting same address string for different addresses in DB for the Customer whereas I am trying to get only one.</p>\n"},{"tags":["linq","entity"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":12746594,"title":"Linq to Entities how to update record in one database access","body":"<p>I want to update many records in a 10 million record database. Examples here suggest that updates can be done like this: </p>\n\n<pre><code>Customer c = (from x in dataBase.Customers\n             where x.Name == \"Test\"\n             selext x).First();\nc.Name = \"New Name\";\ndataBase.SaveChanges();\n</code></pre>\n\n<p>but this looks like two trips to the database.  One to get the record and the other to save the record.  If I updated a thousand records in one call, I think this would have to pull 1,000 records from the database to my WCF server, make the change, then push the 1,000 records back over the LAN to the database server.  </p>\n\n<p>In the old days, \"Update Customers set Name = 'Test' where Year &lt; 1960 \" would be one instruction over the LAN and the work is done at the database server.  </p>\n\n<p>Is there something like this in Linq to Entities? </p>\n\n<p>*BTW:  This is a simple example of what I'm trying to achieve, I actually have hundreds of commands to issue and I don't want 2*hundreds of trips to the database, nor do I see the need to bring all the data from the database to WCF just to change it and send it back!*</p>\n"},{"tags":["c#","linq","asp.net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12730294,"title":"Dataview.RowFilter - how to get specific result set","body":"<p>I have a DataTable containing two columns, both of which is a list of ID's, with a many-many relationship:</p>\n\n<pre>\n  ResourceID    AttributeID\n  ----------    -----------\n  1             1\n  1             2\n  1             3\n  2             1\n  2             3\n  3             3\n</pre>\n\n<p>etc...</p>\n\n<p>Given a list of AttributeID's, I want to obtain a list of ResourceID's that have <strong>ALL</strong> the supplied AttributeID's.</p>\n\n<p>I initially thought to do this:</p>\n\n<pre><code>    string[] attributes = \"....\";\n    dv.RowFilter = \"AttributeID in (\" + String.Join(\",\", attributes) + \")\";\n\n    return dv.ToTable(true, \"ResourceID\").AsEnumerable().Select(x =&gt; (int)x[0]).ToList();\n</code></pre>\n\n<p>but that gives me a list that have <strong>ANY</strong> of the supplied AttributeID's.</p>\n\n<p>My list of attributes is currently a string array, but that can be changed if necessary.  My result set is currently returned as a List of ResourceID's, but that's negotiable too.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#","xml","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12745729,"title":"How do I retrieve values from an XML that (I think) doesn't have standard formatting?","body":"<p>I can't seem to find an article with this same problem.</p>\n\n<p>I have an XML file like this:</p>\n\n<pre><code>&lt;user id=\"\" name=\"\" termsofuse=\"http://boardgamegeek.com/xmlapi/termsofuse\"&gt;\n&lt;firstname value=\"\" /&gt; \n&lt;lastname value=\"\" /&gt; \n&lt;avatarlink value=\"N/A\" /&gt; \n&lt;yearregistered value=\"\" /&gt; \n&lt;lastlogin value=\"2012-10-04\" /&gt; \n&lt;stateorprovince value=\"\" /&gt; \n&lt;country value=\"\" /&gt; \n&lt;webaddress value=\"\" /&gt; \n&lt;xboxaccount value=\"\" /&gt; \n&lt;wiiaccount value=\"\" /&gt; \n&lt;psnaccount value=\"\" /&gt; \n&lt;battlenetaccount value=\"\" /&gt; \n&lt;steamaccount value=\"\" /&gt; \n&lt;traderating value=\"363\" /&gt; \n&lt;/user&gt;\n</code></pre>\n\n<p>And I am using the following code to extract the data:</p>\n\n<pre><code>static string QueryTheData(XDocument doc)\n{\n  var data = from item in doc.Descendants(\"user\")\n             select new\n             {\n               avatarlink = item.Element(\"avatarlink\").Value,\n               lastlogin = item.Element(\"lastlogin\").Value,\n             };\n  var t = \"\";\n  foreach (var p in data)\n    t += p.ToString();\n  return t;\n}\n</code></pre>\n\n<p>But my values returned are null. I'm wondering if it's because the XML file begins:</p>\n\n<pre><code>&lt;user id=\"\" name=\"\" termsofuse=\"http://boardgamegeek.com/xmlapi/termsofuse\"&gt;\n</code></pre>\n\n<p>Whereas in all the examples I have found the XML begins like this:</p>\n\n<pre><code>&lt;user&gt; ... etc\n</code></pre>\n\n<p>How can I read these values in this format?</p>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":518,"score":1,"question_id":2026449,"title":"Linq: join the results in a IEnumerable<string > to a single string","body":"<p>how do i join the results in a IEnumerable to a single string?\nthe IEnumerable contains 20 single letters, and  i want it to combine it to a single string.</p>\n\n<p>And out of curiousity: how would i join it with a separator, for example if the IEnumerable contains the strings a b c d e how can i join it to a,b,c,d,e?</p>\n\n<p>Michel</p>\n"},{"tags":["c#","asp.net","string","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12743595,"title":"converting SQL double in String","body":"<p>I am getting a problem when fetching double value from using linq and converting it into string. My code is:-</p>\n\n<pre><code> public List&lt;ShowDataOnClient&gt; GetCardListToShow()\n    {\n        try\n        {\n            List&lt;ShowDataOnClient&gt; CardList = new List&lt;ShowDataOnClient&gt;();\n            using (ProgressCardLINQDataContext c = new ProgressCardLINQDataContext())\n            {\n                CardList = (from card in c.GetTable&lt;T_PROGRESSCARD&gt;()\n                            where card.RecordStatus.Equals(RecordStatus.Active)\n                            select new ShowDataOnClient\n                            {\n                                Student=(from student in c.T_STUDENTs\n                                         where student.Id.Equals(card.StudentId)\n                                         select student.Name).Single().ToString(),\n                                Test=(from test in c.T_TESTs\n                                      where test.Id.Equals(card.TestId)\n                                      select test.Name).Single().ToString(),\n                                MaxMarks = (from test in c.T_TESTs\n                                            where test.Id.Equals(card.TestId)\n                                            select test.MaxMarks).Single().ToString(),\n                                MarksObtain=card.MarksObtain.ToString(),\n                                Percentage=card.Percentage.ToString()\n\n                            }).ToList&lt;ShowDataOnClient&gt;();\n            }\n            return CardList;\n        }\n        catch\n        {\n            return new List&lt;ShowDataOnClient&gt;();\n        }\n    }\n</code></pre>\n\n<p>I have tried this also:-</p>\n\n<pre><code> Percentage=Math.Truncate(card.Percentage).ToString()\n</code></pre>\n\n<p>and when i pass \"N2\" in ToString it gives exception \"Method 'System.String ToString(System.String)' has no supported translation to SQL.\"</p>\n\n<p>and the value i got after conversion is like this:- 5.200000000000000e+001</p>\n\n<p>is there anybody to help me..</p>\n"},{"tags":["c#","asp.net","linq","var"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":158,"score":2,"question_id":12740724,"title":"Return var from function","body":"<p>I am getting values from different tables i var type and I want to return them. What should be the return type of the function:-</p>\n\n<pre><code>  public void getlist()\n    {\n        try\n        {\n            using (ShowDataToClientDataContext c = new ShowDataToClientDataContext())\n            {\n               var recList = (from record in c.GetTable&lt;T_RECORDSHOW&gt;()\n                              where record.RecordStatus.Equals(RecordStatus.Active)\n                              select new\n                              {\n                                  Student = (from stu in c.T_STUDENTSHOWs\n                                             where stu.Id.Equals(record.StudentId)\n                                             select stu.Name).Single().ToString(),\n                                  Trade = (from t in c.T_TRADESHOWs\n                                           where t.Id.Equals(record.TradeId)\n                                           select t.Name).Single().ToString(),\n                                  SessionId = (from s in c.T_SESSIONSHOWs\n                                               where s.Id.Equals(record.SessionId)\n                                               select s.Name).Single().ToString(),\n                                  Month = record.Month.ToString(),\n                                  Attendance = record.Attendance.ToString(),\n\n                              }).ToList();\n               return recList;\n            }\n\n        }\n        catch\n        {\n\n        }\n    }\n</code></pre>\n\n<p>anybody there to help me?</p>\n"},{"tags":["c#","linq","transactions","sql-server-ce"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":12742241,"title":"Transaction and TransactionScope isolation","body":"<p>I have to add to my database a lot of information. Adding this information takes about 5&ndash;7 minutes. And I need to add transaction.</p>\n\n<p>I tried this:</p>\n\n<pre><code>try { \n    db.Connection.Open();\n    db.Transaction = db.Connection.BeginTransaction(); \n    UpdateTable1();\n    UpdateBigTable2();\n    ...\n    db.Transaction.Commit(); \n} catch {\n    db.Transaction.Rollback();  \n}\n</code></pre>\n\n<p>But when my database is updating, I cannot read or do anything with my DB.</p>\n\n<p>I tried to set <code>IsolationLevel</code>, but any of it didn't help.</p>\n\n<p>I tried this:</p>\n\n<pre><code>using (var ts = new TransactionScope()) {\n    UpdateTable1();\n    ts.Complete();\n}\n</code></pre>\n\n<p>But program crashes after 2&ndash;3 minutes.</p>\n\n<p>This solution didn't help too:</p>\n\n<pre><code>var transactionOptions = new TransactionOptions();\ntransactionOptions.IsolationLevel = System.Transactions.IsolationLevel.Serializable;\ntransactionOptions.Timeout = TimeSpan.MaxValue;\nusing (var ts = new TransactionScope(TransactionScopeOption.Required, transactionOptions))\n{\n    ...\n}\n</code></pre>\n\n<p>I have get access to my database, when it's updating, if I set <code>TransactionScopeOption.Suppress</code>\nBut in this case Transaction doesn't work.</p>\n\n<p>Can you help me?</p>\n\n<p>Sorry for my English. =)</p>\n"},{"tags":["linq","linq-to-xml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":10617994,"title":"Getting data from xml by attribute vlaue","body":"<p>I have a file with the following content (myfile.xml). I have to get all content coming under (including product node) a product with <code>id=1</code>.</p>\n\n<pre><code>&lt;products&gt;  \n  &lt;product id=\"1\"&gt;\n       &lt;category&gt;q&lt;/category&gt;  \n  &lt;/product&gt;    \n  &lt;product id=\"2\"&gt;      \n       &lt;category&gt;w&lt;/category&gt;    \n  &lt;/product&gt;   \n  &lt;product id=\"3\"&gt;       \n  &lt;category&gt;e&lt;/category&gt;   \n &lt;/product&gt;\n&lt;/products&gt;`\n</code></pre>\n\n<p>i.e. the result should be :</p>\n\n<pre><code> &lt;product id=\"1\"&gt; \n      &lt;category&gt;q&lt;/category&gt;\n  &lt;/product&gt; \n</code></pre>\n\n<p>How can I do this?</p>\n"},{"tags":["c#",".net","multithreading","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":51,"score":7,"question_id":12739448,"title":"Meaning of the underscore in WaitCallback","body":"<pre><code>ThreadPool.QueueUserWorkItem(new WaitCallback((_) =&gt; { MyMethod(param1, Param2); }), null);\n</code></pre>\n\n<p>Could you please explain the meaning of underscore (_) in the WaitCallBack constructor?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":44,"score":3,"question_id":12738814,"title":"LiNQ has different results","body":"<p>I have this class called <code>Variables</code> which has multiple members and one of it is called <code>Name</code> which is a string. Supposed I have a <code>List&lt;Variables&gt;</code>. This has <code>Names</code>of <code>X</code>, <code>Y</code>, <code>Y</code>, <code>Z</code>.</p>\n\n<pre><code>string variableName = 'Y';\n\nint _totalCount = (from p in variableList\n                    where p.Name == variableName\n                    select p.Name).Count();\n\nint _totalCount2 = variableList.Select(x =&gt; x.Name == variableName).Count();\n</code></pre>\n\n<p>Question: Why is <code>_totalCount</code> returns <code>2</code> (<em>which is what I want</em>) while <code>_totalCount2</code> returns <code>4</code>?</p>\n"},{"tags":["asp.net","asp.net-mvc","asp.net-mvc-3","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12735272,"title":"asp.net mvc Linq exclude values from other table","body":"<p>I have an exhibition scenario.</p>\n\n<p>How do I exclude a list of available Stands below, from the drop down list I would show in the Exhibitor view.</p>\n\n<p>In Sql I would:</p>\n\n<pre><code>Select StandID, Description from Stand \nWhere StandID not in (Select StandID from Exhibitor)\n</code></pre>\n\n<p>Exhibitors register - and select the stand they want from a dropdown list (StandID/Stand) as per the model below:</p>\n\n<pre><code> public class Exhibitor\n{\n    public int ExhibitorID { get; set; }\n    public string CompanyName { get; set; }\n    public string ContactName { get; set; }\n    public int StandID { get; set; }\n    public virtual Stand Stand { get; set; }\n }\n</code></pre>\n\n<p>The Stand Model is as follows:</p>\n\n<pre><code>  public class Stand\n{\n    public int StandID { get; set; }\n    public string Description { get; set; }\n    public bool Booked { get; set; }\n}\n</code></pre>\n\n<p>I can get a list of Stands as follows:</p>\n\n<pre><code>var stands = db.Stands.ToList().Where(s =&gt; s.Booked==false)\n          .Select(s =&gt; new SelectListItem\n          {\n              Value = s.StandID.ToString(),\n              Text = s.StandNumber + \": \" + s.Description + \": \" + s.Size + \": \" + s.Rate.ToString()\n          });\n</code></pre>\n\n<p>But how do I exclude the (Select StandID from Exhibitor) from the stands list?</p>\n\n<p>I tried:</p>\n\n<pre><code>var booked = db.Exhibitors.Select(s =&gt; new { s.StandID }).ToList();\n</code></pre>\n\n<p>then using:</p>\n\n<pre><code>var stands = db.Stands.ToList().Where(s =&gt; s.Booked==false)\n          .Except(booked)\n          .Select(s =&gt; new SelectListItem\n          {\n              Value = s.StandID.ToString(),\n              Text = s.StandNumber + \": \" + s.Description + \": \" + s.Size + \": \" + s.Rate.ToString()\n          });\n</code></pre>\n\n<p>But that didn't work.</p>\n\n<blockquote>\n  <p><strong>UPDATE</strong></p>\n</blockquote>\n\n<p>This appears to work - but I'm no expert, so would appreciate any advise on if it;s the best practice way or not?</p>\n\n<pre><code>var stands = db.Stands.ToList().Where(s =&gt; !db.Exhibitors\n.Any(bk =&gt; bk.StandID == s.StandID) &amp;&amp; s.Booked == false)\n          .Select(s =&gt; new SelectListItem\n          {\n              Value = s.StandID.ToString(),\n              Text = s.StandNumber + \": \" + s.Description + \": \" + s.Size + \": \" + s.Rate.ToString()\n          });\n</code></pre>\n\n<p>Thanks for any help?</p>\n\n<p>Mark</p>\n"},{"tags":["c#",".net","linq","json","linq-to-entities"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":351,"score":0,"question_id":7432265,"title":"LINQ to JSON: how to get the right format?","body":"<p>im trying to convert my result from a linq query to json\nusing <a href=\"http://james.newtonking.com/projects/json/help/LINQtoJSON.html\" rel=\"nofollow\">json.net</a></p>\n\n<p>here is what i did:</p>\n\n<pre><code>JObject o = JObject.FromObject(new\n{\n    UserID = from u in model.USER\n             select new\n             {\n                 UserID = u.UserID\n             }\n});\n</code></pre>\n\n<p>here is what i get:</p>\n\n<pre><code>JSON\n  id=1\n  result={\"UserID\":[{\"UserID\":121},\"UserID\":121},{\"UserID\":122},{\"UserID\":123},{\"UserID\":124}]}\n</code></pre>\n\n<p>here is what i need:</p>\n\n<pre><code>JSON\n  id=1\n  result={[{UserID:'121'},{UserID:'121'},{UserID:'122'},{UserID:'123'},{UserID:'124'}]}  \n</code></pre>\n\n<p>how do i get this done? thank you </p>\n"},{"tags":["asp.net-mvc","linq","razor"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12734208,"title":"ASP.NET MVC multi-level menu from database","body":"<p>I have a table called Categories and it contains the following fields:\nId | Name | ParentId //parent id actually is a self reference </p>\n\n<p>so from the _Layout.cshtml am calling the partial view called MainMenu.cshtml</p>\n\n<p>_Layout.cshtml</p>\n\n<pre><code>    @Html.Partial(\"MainMenu\")\n</code></pre>\n\n<p>How can I can send the model to the mainmenu, i know there is an overload of partial, where i can send a model as well.  am trying to solve the problem in an elegant way that doesn't break the MVC architecture.</p>\n"},{"tags":["linq","entity-framework","linq-to-entities","expression-trees"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12732532,"title":"Binding DefaultExpression to property in Linq-to-Entities query","body":"<p>I have a class that helps project entities to POCOs by emitting Linq expressions that can be used with an IQueryable.  Here is an expression I'm having some trouble with:</p>\n\n<pre><code>result = Expression.Bind(dProperty,\n                         Expression.Coalesce(Expression.Property(parameterExpression, sProperty),\n                                             Expression.Default(dType)));  \n</code></pre>\n\n<p>In this statement, <code>dProperty</code> is a <code>PropertyInfo</code> representing the destination property in the binding, <code>dType</code> is the <code>Type</code> of that property, <code>parameterExpression</code> is another Linq expression representing the parameter of type <code>TEntity</code>, and <code>sProperty</code> is a <code>PropertyInfo</code> object representing the source property.</p>\n\n<p>This builds, but at runtime when the Entity Framework expression visitor implementation works its way through the tree, it sees this and throws a \"not supported\" exception (below).  What seems to be the meaning is that the DefaultExpression I'm using as the right side of the coalescence operator expression isn't supported in EF.  I tried searching quite a bit for documentation or discussions that addressed this and couldn't find anything (of course, it's hard to do a very good search on a word like 'default').  Anyway, is it true that the C# 'default' operator is not supported in Linq-to-Entities?  If it is true, then how do I do what I'm trying to do, which is to assign a property from a <code>Nullable</code> whose generic argument type is the same as the destination property?</p>\n\n<p>In other words, the linq expression would look like this if you wrote it as a lambda:</p>\n\n<pre><code>(/*long*/dest, /*long?*/src) =&gt; dest = src ?? default(long)\n</code></pre>\n\n<p>Here's the exception.</p>\n\n<pre><code>System.NotSupportedException: Unknown LINQ expression of type 'Default'.\n   at System.Linq.Expressions.EntityExpressionVisitor.Visit(Expression exp)\n   at System.Data.Objects.ELinq.Funcletizer.&lt;&gt;c__DisplayClass5.&lt;Nominate&gt;b__4(Expression exp, Func`2 baseVisit)\n   at System.Linq.Expressions.EntityExpressionVisitor.BasicExpressionVisitor.Visit(Expression exp)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitBinary(BinaryExpression b)\n   at System.Data.Objects.ELinq.Funcletizer.&lt;&gt;c__DisplayClass5.&lt;Nominate&gt;b__4(Expression exp, Func`2 baseVisit)\n   at System.Linq.Expressions.EntityExpressionVisitor.BasicExpressionVisitor.Visit(Expression exp)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitMemberAssignment(MemberAssignment assignment)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitBinding(MemberBinding binding)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitBindingList(ReadOnlyCollection`1 original)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitMemberInit(MemberInitExpression init)\n   at System.Data.Objects.ELinq.Funcletizer.&lt;&gt;c__DisplayClass5.&lt;Nominate&gt;b__4(Expression exp, Func`2 baseVisit)\n   at System.Linq.Expressions.EntityExpressionVisitor.BasicExpressionVisitor.Visit(Expression exp)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitExpressionList(ReadOnlyCollection`1 original)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitInvocation(InvocationExpression iv)\n   at System.Data.Objects.ELinq.Funcletizer.&lt;&gt;c__DisplayClass5.&lt;Nominate&gt;b__4(Expression exp, Func`2 baseVisit)\n   at System.Linq.Expressions.EntityExpressionVisitor.BasicExpressionVisitor.Visit(Expression exp)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitLambda(LambdaExpression lambda)\n   at System.Data.Objects.ELinq.Funcletizer.&lt;&gt;c__DisplayClass5.&lt;Nominate&gt;b__4(Expression exp, Func`2 baseVisit)\n   at System.Linq.Expressions.EntityExpressionVisitor.BasicExpressionVisitor.Visit(Expression exp)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitUnary(UnaryExpression u)\n   at System.Data.Objects.ELinq.Funcletizer.&lt;&gt;c__DisplayClass5.&lt;Nominate&gt;b__4(Expression exp, Func`2 baseVisit)\n   at System.Linq.Expressions.EntityExpressionVisitor.BasicExpressionVisitor.Visit(Expression exp)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitExpressionList(ReadOnlyCollection`1 original)\n   at System.Linq.Expressions.EntityExpressionVisitor.VisitMethodCall(MethodCallExpression m)\n   at System.Data.Objects.ELinq.Funcletizer.&lt;&gt;c__DisplayClass5.&lt;Nominate&gt;b__4(Expression exp, Func`2 baseVisit)\n   at System.Linq.Expressions.EntityExpressionVisitor.BasicExpressionVisitor.Visit(Expression exp)\n   at System.Data.Objects.ELinq.Funcletizer.Nominate(Expression expression, Func`2 localCriterion)\n   at System.Data.Objects.ELinq.Funcletizer.Funcletize(Expression expression, Func`1&amp; recompileRequired)\n   at System.Data.Objects.ELinq.ExpressionConverter..ctor(Funcletizer funcletizer, Expression expression)\n   at System.Data.Objects.ELinq.ELinqQueryState.CreateExpressionConverter()\n   at System.Data.Objects.ELinq.ELinqQueryState.GetExecutionPlan(Nullable`1 forMergeOption)\n   at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)\n   at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable&lt;T&gt;.GetEnumerator()\n   at System.Linq.Enumerable.&lt;SelectManyIterator&gt;d__14`2.MoveNext()\n   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()\n   at System.Linq.Enumerable.&lt;TakeIterator&gt;d__3a`1.MoveNext()\n   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()\n   at System.Collections.Generic.List`1.InsertRange(Int32 index, IEnumerable`1 collection)\n   at MyClass...\n</code></pre>\n"},{"tags":["asp.net","asp.net-mvc-3","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12719026,"title":"Aggregating data with query for ASP MVC 3 controller","body":"<p>I have three tables:</p>\n\n<blockquote>\n  <p>PackageName: PackageNameID,PackageName </p>\n  \n  <p>Food: FoodID,Food</p>\n  \n  <p>PackageContent: PackageContentID, PackageNameID, FoodID, Qty</p>\n</blockquote>\n\n<p>What I'm trying to do is display something like this:</p>\n\n<blockquote>\n  <ul>\n  <li><p>PackageName (Food=Qty, Food=Qty) Edit | Details | Delete</p></li>\n  <li><p>A (Onions=4,Peppers=3)   Edit | Details | Delete</p></li>\n  <li>B (Rolls=2,Onions=2) Edit | Details | Delete</li>\n  </ul>\n</blockquote>\n\n<p>Here is my view model:</p>\n\n<pre><code>public class PackageViewModel\n{\n  public int ID { set;get;}\n  public string Name { set;get;}\n  public List&lt;FoodItem&gt; FoodItems { set;get;}\n  public PackageViewModel()\n  {\n     FoodItems=new List&lt;FoodItem&gt;();\n  }\n}\npublic class FoodItem\n{\n  public string FoodName { set;get;}\n  public int Quantity { set;get;}\n}\n</code></pre>\n\n<p>Here is my view:</p>\n\n<pre><code>@model List&lt;PackageViewModel&gt;\n\n@foreach(var item in Model)\n{\n  &lt;tr&gt;\n   &lt;td&gt;@item.Name&lt;/td&gt;\n   &lt;td&gt;\n       foreach(var food in item.FoodItems)\n       {\n         @food.FoodName - @food.Quantity\n       }\n   &lt;/td&gt;\n   &lt;td&gt;\n      @Html.ActionLink(\"Edit\",\"Edit\",new {@id=item.ID})\n   &lt;/td&gt;\n  &lt;/tr&gt;\n}\n</code></pre>\n\n<p>This is the query I am using in my controller:</p>\n\n<pre><code>List&lt; PackageViewModel &gt; listVM=new List&lt; PackageViewModel &gt;();\n\nlistVM =\n\n        from pn in db.PackageNames\n        from pc in db.PackageContents\n            .Where(p =&gt; p.PackageNameID == pn.PackageNameID).DefaultIfEmpty()\n        from f in db.Foods\n            .Where(f =&gt; f.FoodID == pc.FoodID).DefaultIfEmpty()\n        select new PackageViewModel { PackageNameID = pc.PackageNameID, PackageName = pn.PackageName, FoodItems = f.Food.ToList() };\n\n    return View(listVM);  \n</code></pre>\n\n<p>But, I get the following error: \n<strong>Cannot implicitly convert type 'System.Collections.Generic.List' to 'System.Collections.Generic.List'</strong></p>\n\n<p>Further, the select line isn't right anyway....I need to assign both the name of the food (\"Food\" from the \"Food\" table) and the quantity of this food item (\"Qty\" from the \"PackageContent\" table) to the \"FoodItems\" list in the model. How do I do this?</p>\n\n<p>Thanks very much!!</p>\n"},{"tags":["c#","asp.net","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":103,"score":-1,"question_id":12734821,"title":"Compare List<String[]> With Multiple Conditions","body":"<p>I have two <code>List&lt;String[]&gt;</code>'s (string array lists), and I'd like to match the contents with each other with some condition so final result will return true of false.</p>\n\n<pre><code>List&lt;string&gt; TestA= {\"A001\",\"A002\",\"A003\",\"B001\",\"B001\",\"C003\",\"D000\",\"E001\"};\n\nList&lt;string&gt; TestB= {\"A001\",\"A002\",\"A003\",\"B999\",\"C003\"};\n</code></pre>\n\n<p>i would like to write a function for below condition.</p>\n\n<ol>\n<li>if All the items of TestA match with TestB (In TestA same item can be multiple times [ex. B001]) ==> return true</li>\n<li>if TestB conatins any item having digit 999 [Ex B999] then no need to loop for items start with B in testA (this set bool true) and loop of TestA start from C003 [in this case i think we need to remove all Items of B from ListA if ListB conats B999].\nContinue..\nso loop run for TestA item C003. this matched with item in TestB again set true\nNow for D000 not match item in ListB now finally bool set to false and break.</li>\n</ol>\n"},{"tags":["c#","xml","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12730759,"title":"XML continuously updating values","body":"<p>I'm trying to get a program to continuously write data to an XML node in a file but I'm not sure how to implement it. The XML file is a Google Earth kml file that needs coordinates in order to draw a path:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;kml xmlns=\"http://www.opengis.net/kml/2.2\"&gt;\n  &lt;Document&gt;\n    &lt;Style&gt;\n      &lt;LineStyle&gt;\n        &lt;color&gt;7f00ffff&lt;/color&gt;\n        &lt;width&gt;4&lt;/width&gt;\n      &lt;/LineStyle&gt;\n    &lt;/Style&gt;\n    &lt;Placemark&gt;\n      &lt;LineString&gt;\n        &lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;\n        &lt;coordinates&gt;0,0,0&lt;/coordinates&gt;\n      &lt;/LineString&gt;\n    &lt;/Placemark&gt;\n  &lt;/Document&gt;\n&lt;/kml&gt;\n</code></pre>\n\n<p>I only need to modify the coordinates node and add subsequent lines. This would be accomplished using a timer to write a new set of coordinates every second. This will probably have hundreds of lines: </p>\n\n<pre><code>&lt;coordinates&gt; \n      -112.2550785337791,36.07954952145647,2357\n      -112.2549277039738,36.08117083492122,2357\n      -112.2552505069063,36.08260761307279,2357\n      -112.2564540158376,36.08395660588506,2357\n      -112.2580238976449,36.08511401044813,2357\n      -112.2595218489022,36.08584355239394,2357\n\n(...etc)\n\n&lt;/coordinates&gt;\n</code></pre>\n\n<p>I'm not quite understanding how to go about accessing just the coordinates node and write value after value. I've tried something like this but it's not working:</p>\n\n<pre><code>  XmlDocument dataFile = new XmlDocument();\n  dataFile.Load(\"gpsData.kml\");\n\n  XmlNode node = dataFile.SelectSingleNode(\"kml/Document/Placemark/LineString/coordinates\");\n\n  node.InnerText (?) &lt;- how do I append new text instead of replacing the whole thing?\n</code></pre>\n"},{"tags":["python","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12734839,"title":"linq-like sum function in python","body":"<p>I started programming in python after a time I was programming in c#, and in c# I used quite often did things like the following: </p>\n\n<pre><code>list.sum(x =&gt; x * 2);\n</code></pre>\n\n<p>where <code>list</code> contains some kind of a number. <br>\nis there any thing like this in python? for example i want to do this:</p>\n\n<pre><code>&gt;&gt; arr = range(1,10)\n&gt;&gt; linq_like_sum(lambda x :  x**2 , arr)\n</code></pre>\n\n<p>and get the sum of squares of arr.   </p>\n"},{"tags":["c#","linq","grouping"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12734189,"title":"LINQ grouping doesn't give me correct result","body":"<p>I was trying to group Detail's date and time id, along with case's worker.\nWhen I check the cases, I found that the cases' date and time was not grouping correctly. They have the same time but the date are different.</p>\n\n<p>I thought this grouping should group same worker, same date and same time. What's wrong? how do I fix it?</p>\n\n<pre><code>from p in CASEs\njoin a in CASEDetails on p.CASE_ID equals a.CASE_ID\ngroup p.CASE_ID by new { a.APT_DATE,a.TIME_ID,  p.WORKER } into g\nwhere g.Distinct().Count() &gt; 1\norderby g.Key.APT_DATE, g.Key.TIME_ID\nselect new\n{\n    g.Key.APT_DATE,\n    g.Key.TIME_ID,\n    g.Key.WORKER,\n    ID = from i in g select i\n}\n</code></pre>\n"},{"tags":[".net","linq","string"],"answer_count":9,"favorite_count":6,"up_vote_count":34,"down_vote_count":2,"view_count":16258,"score":32,"question_id":122670,"title":"What is the LINQ way to implode/join a string array?","body":"<p>I have the following string array:</p>\n\n<pre><code>var sa = new string[] {\"yabba\",\"dabba\",\"doo\"};\n</code></pre>\n\n<p>I can convert it to \"yabba, dabba, doo\" it using string.Join() but what is the super-cool LINQ way of doing it?  The Join extension method seems promising but for a novice like me very confusing.</p>\n"},{"tags":["c#","asp.net","sql","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12733506,"title":"How to save multiple linq queries from a loop in a single variable?","body":"<p>I thought its possible to save multiple linq queries from a loop in a single variable ?</p>\n\n<pre><code>public ActionResult Index()\n    {\n        string ActiveUserId = (string)Session[\"ActiveUserGuid\"];\n        Guid MyGuid = new Guid(ActiveUserId);\n\n        var queryRoots = from r in db.Roots\n                         where r.UserId == MyGuid\n                         select r.TaskId;\n\n//Here is the questionable Part\n        foreach (var i in queryRoots)\n        {             \n            var queryAllTasks = from t in db.Tasks\n                                join b in db.Trees on t.TaskId equals b.ChildId\n                                where b.TaskId == i\n                                select t;\n            tasksForView.Add(queryAllTasks); &lt;---????? obviously doesnt work\n        };\n\n        return View(queryAllTasks);\n    }\n\npublic class Root\n{\n    public int RootId { get; set; }\n\n    public Guid UserId { get; set; }\n    public User User { get; set; }  //navigation Property\n\n    public int TaskId { get; set; } // composite key\n    public int ChildId { get; set; }\n    public Tree Tree { get; set; } //navigation Property\n}\n\npublic class Tree\n{\n    public int TaskId { get; set; }\n    public int ChildId { get; set; }\n    public int Length { get; set; } //Path length\n\n    public virtual ICollection&lt;Root&gt; Roots { get; set; }\n\n}\n</code></pre>\n\n<p>In case you are wondering what its supposed to do. I want to query several subtrees from a hierarchical transitiv closure table and return them to a view.</p>\n\n<p>I know my code is not close to working and I just tried very simple solutions!\nI guess a different way to do the query would get rid of the problem all together</p>\n"},{"tags":["c#","linq","entity-framework-4","equals"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2513,"score":2,"question_id":5080727,"title":"String.Equals() not working as intended","body":"<p>I am using LINQ to search through one of my Entity Framework tables and find a \"group\" based on the name. The name is a string and appears to be Unicode (says it is in the edmx). I have a method GetGroup() and I pass in a name to search for. Debugging through the code, I already have a group named \"Test\" in my database. Once I pass in a group named \"TEST\" I expect it to return the \"Test\" which was already in the database. It for some reason, does not find the \"Test\" and thinks \"TEST\" doesn't exist. Here is my query, I cannot see why it does not work. Please help.</p>\n\n<p>\"name\" is the passed in the group name. My .Equals seems to only work if the gr.Name and name are the exact same. If one character is capital in one of the two strings, then the .Equals doesn't work. \n*I have tried to use InvariantCultureIgnoreCase, and that did not seem to help.\n*In case someone asks, the MyLeagueId and LeagueId will always match, the database is setup so there can be a group in a different league id. I do not think this is the problem.</p>\n\n<pre><code>Group g = (from gr in this.DatabaseConnection.Groups\n           where gr.Name.Equals(name, StringComparison.OrdinalIgnoreCase) &amp;&amp;\n           gr.LeagueId == this.MyLeagueId\n           select gr).FirstOrDefault();\n</code></pre>\n"},{"tags":["c#","linq","asynchronous","task",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12721585,"title":"How can I invoke several clients' async methods and aggregate the results into one task generically?","body":"<p>The following code is intended to reduce redundant code by allowing you to generically invoke the same selector on a set of \"getters\" (data retrieval clients) and have all of the results combined. The final result set is awaitable, allowing the system to not block while waiting for all of the selectors to complete.</p>\n\n<pre><code>public async Task&lt;T&gt; GetBulkAsync&lt;T&gt;(Func&lt;IGetter, Task&lt;T&gt;&gt; selector) where T : IEnumerable&lt;T&gt;\n{\n    Task&lt;T&gt;[] tasks = new Task&lt;T&gt;[this.getters.Count];\n    for (int i = 0; i &lt; this.getters.Count; i++)\n    {\n        tasks[i] = selector(this.getters[i]);\n    }\n\n    T[] results = await Task.WhenAll(tasks);\n\n    return results.SelectMany&lt;T, T&gt;(r =&gt; r);\n}\n</code></pre>\n\n<p>However, a problem comes up in my design here. There is one case where I simply want to use a selector that retrieves a single <code>IData</code> and then there's times where a selector will retrieve an <code>IEnumerable&lt;IData&gt;</code> or maybe a <code>List&lt;IData&gt;</code> or something entirely different.</p>\n\n<p>I have thought about using reflection to handle special cases with generic collections, but that's messy and requires additional work for every type of collection I want to handle.</p>\n\n<p>The main reason I care about <code>IEnumerable&lt;IData&gt;</code> (or really, <code>IEnumerable&lt;T&gt;</code>) is because I want to use Linq's SelectMany in order to flatten out all of the results in the big result set. If each selector is coming back with an <code>IEnumerable&lt;T&gt;</code>, it needs to be reduced into one <code>IEnumerable&lt;T&gt;</code>, not an <code>IEnumerable&lt;IEnumerable&lt;T&gt;&gt;</code>.</p>\n\n<p>Is there a good approach to solving this issue other than writing several different generic methods with constraints on collection types and without using reflection?</p>\n"},{"tags":["sql","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":12732277,"title":"JOIN and LEFT JOIN equivalent in LINQ with Method Syntax","body":"<p>I am converting a SQL query to LINQ that creates a left join with 1-to-1 mapping, and it has to be in Method Syntax. I have been pulling off my hair trying to accomplish this to no veil. I can do it in Lambda Syntax. Below is the example query I am trying to run. They are not actual code. Would someone point out what I am doing wrong?</p>\n\n<p>SQL:</p>\n\n<pre><code>SELECT item.*, item_status.*\nFROM item\nLEFT JOIN item_status \n    ON item.ID = item_status.itemID\n    AND item_status.FLAGGED = true\nWHERE item.published_date &gt; \"2008-06-19\"\n</code></pre>\n\n<p>LINQ:</p>\n\n<pre><code>var linq_query = (\n    from selected_item in item\n    join selected_item_status in item_status\n        on selected_item.ID equals item_status.itemID into joined\n    from item_status in joined.DefaultIfEmpty()\n    where item_status.FLAGGED = true\n    select new {selected_item, selected_item_status}).ToList();\n</code></pre>\n"},{"tags":["c#",".net","linq","list","dictionary"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":154,"score":1,"question_id":12470901,"title":"Get Unique values from List<Dictionary<string, string>>","body":"<p>I have <code>List&lt;Dictionary&lt;string, string&gt;&gt;</code> object with some datas in it. </p>\n\n<pre><code>/* Values in the list will be like\n   [0] - \n         aaa - aaaValue1   (Key, Value)\n         bbb - bbbValue1\n         ccc - cccValue1\n         ddd - dddValue1 \n   [1] - \n         aaa - aaaValue2   (Key, Value)\n         bbb - bbbValue2\n         ccc - cccValue2\n         ddd - dddValue2 \n\n    and so on */\n</code></pre>\n\n<p>I want to get the distinct values( <code>List&lt;string&gt;</code> ) in the dictionary where the key is equal to \"ccc\" and the value of the key \"bbb\" is equal to \"bbbValue1\".</p>\n\n<p><strong>Expected Result:</strong></p>\n\n<p>Return a string list contains the dictionary value where key is equal to \"ccc\" and the value of the key \"bbb\" is equal to \"bbbValue1\" in the <code>List&lt;Dictionary&lt;string, string&gt;&gt;</code>.</p>\n"},{"tags":["c#","linq","query","weighted-average"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1953,"score":2,"question_id":2714639,"title":"Weighted Average with LINQ","body":"<p>My goal is to get a weighted average from one table, based on another tables primary key.</p>\n\n<p>Example Data:</p>\n\n<p>Table1</p>\n\n<pre><code>Key     WEIGHTED_AVERAGE\n\n0200    0\n</code></pre>\n\n<p>Table2</p>\n\n<pre><code>ForeignKey    LENGTH    PCR\n0200          105       52\n0200          105       60\n0200          105       54\n0200          105       -1\n0200          47        55\n</code></pre>\n\n<p>I need to get a weighted average based on the length of a segment and I need to ignore values of -1. I know how to do this in SQL, but my goal is to do this in LINQ. It looks something like this in SQL:</p>\n\n<pre><code>SELECT Sum(t2.PCR*t2.LENGTH)/Sum(t2.LENGTH) AS WEIGHTED_AVERAGE\nFROM Table1 t1, Table2 t2\nWHERE t2.PCR &lt;&gt; -1\nAND t2.ForeinKey = t1.Key;\n</code></pre>\n\n<p>I am still pretty new to LINQ, and having a hard time figuring out how I would translate this.  The result weighted average should come out to roughly 55.3. Thank you.</p>\n"},{"tags":["c#","xml","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12732999,"title":"How can I read a entire XML node when a specific one has a specific value","body":"<p>How can I do a <code>foreach</code> where I can read just the <code>XML</code> tag <code>Equipe</code> where has the <code>&lt;DesFilialnet&gt;</code> equals <code>Rest</code> </p>\n\n<p>This is an example:</p>\n\n<pre><code>&lt;Equipe&gt;\n    &lt;CPFUsuario&gt;5546&lt;/CPFUsuario&gt;\n    &lt;CodUsuario&gt;6536&lt;/CodUsuario&gt;\n    &lt;ApelidoUsuario&gt;PARREIRA.MG&lt;/ApelidoUsuario&gt;\n    &lt;NomeCompletoUsuario&gt;JORGE&lt;/NomeCompletoUsuario&gt;\n    &lt;CodAgenciaLopesnet&gt;15513&lt;/CodAgenciaLopesnet&gt;\n    &lt;DesAgenciaLopesnet&gt;MINAS GERAIS LTDA.&lt;/DesAgenciaLopesnet&gt;\n    &lt;DesFilialnet&gt;Rest&lt;/DesFilialLopesnet&gt;\n    &lt;CodEquipe&gt;584309&lt;/CodEquipe&gt;\n    &lt;CodEquipeNovo&gt;597951&lt;/CodEquipeNovo&gt;\n    &lt;DesEquipe&gt;CARLOSMG&lt;/DesEquipe&gt;\n    &lt;CodEquipeSecundaria /&gt;\n    &lt;CodEquipeSecundariaNovo /&gt;\n    &lt;DesEquipeSecundaria /&gt;\n    &lt;CodFilialSiebelPronto&gt;&lt;/CodFilialSiebelPronto&gt;\n    &lt;GrupoAcesso&gt;1&lt;/GrupoAcesso&gt;\n&lt;/Equipe&gt;\n</code></pre>\n\n<p>I have a lot of <code>Equipe</code> tag, but the <code>&lt;DesFilialnet&gt;</code> change, and I want just the <code>&lt;Equipe&gt;</code> where <code>&lt;DesFilialnet&gt;</code> is Rest.</p>\n\n<p>Follow how I'm doing</p>\n\n<pre><code>    public void leXmlCors(string file)\n    {\n        XmlReader rdr = XmlReader.Create(file);\n        XDocument doc2 = XDocument.Load(rdr);\n\n        foreach (var equipes in doc2.Root.Descendants(\"Equipe\"))\n        {\n            foreach (var element in equipes.Descendants())\n            {\n                 // This will read all &lt;Equipe&gt; tag, but I don't want all &lt;Equipe&gt; tag\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#","linq","algorithm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12732665,"title":"Explanation of this LINQ code which generates permutations","body":"<p>Can someone explain to me how this code works which generates permutations?</p>\n\n<p>I see that it's using recursive list building but I can't quite get my brain around the exact mechanics.</p>\n\n<pre><code>public static IEnumerable&lt;IEnumerable&lt;T&gt;&gt; Permute&lt;T&gt;(this IEnumerable&lt;T&gt; list)\n{\n    if (list.Count() == 1)\n        return new List&lt;IEnumerable&lt;T&gt;&gt; { list };\n    return list\n        .Select((a, i1) =&gt; \n                    Permute(list.Where((b, i2) =&gt; i2 != i1))\n                   .Select(b =&gt; (new List&lt;T&gt; { a }).Union(b)))\n        .SelectMany(c =&gt; c);\n}\n</code></pre>\n"},{"tags":["c#",".net","sql-server","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12731769,"title":"LINQ to SQL timeout on one server and not other","body":"<p>I'm using LINQ to SQL to access a stored procedure.  This works fine on my local sql server.  But once I point to a different server within the internal network, I get a timeout.  In SQL Profiler, I can see the query that is sent to the problem server.  This should mean the query is hitting the server and executing right?</p>\n\n<p>I can run the LINQ output directly on the problem server without issue.  Is this probably not a code issue and instead some problem with the sql server server configuration?  What should I check to troubleshoot it?</p>\n"},{"tags":["linq","list","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":12732387,"title":"pass list values in where condition in linq for filtering the data in datatble","body":"<p>I have a requirement that i am having one string[] array (which is having the id values which is , separated values) and dt as datatable.</p>\n\n<p>dt is having the columns called Id, empname, designation.</p>\n\n<p>now i want to filter the data from the datatable where id not in (string[] values) using linq query.</p>\n\n<p>for ex: </p>\n\n<pre><code>string[] ids= [2,4,6];\n\ndt=  id      empname     designation\n    ----     -------     ------------\n     1       robert       trainer\n     2       thomas       HRA\n     3       John         JE\n     4       kapil        SE\n     5       sachin       SSE\n     6       Rahul        Manager\n</code></pre>\n\n<p>now i want a linq query which return my dt as:</p>\n\n<pre><code> id      empname     designation\n----     -------     ------------\n 1       robert       trainer \n 3       John         JE\n 5       sachin       SSE\n</code></pre>\n"},{"tags":["asp.net-mvc","linq","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12730491,"title":"LINQ and Nhibernate: create an Expression using a model property","body":"<p>I am getting started with LINQ and NHibernate, can you help me get oriented please:</p>\n\n<p>I need to pass a lambda statement to nhibernate .QueryOver() which is conditional based on a property on my model:</p>\n\n<pre><code>if (model.PropertyA != String.Empty) {\n    var searchResults = nhibSession.QueryOver&lt;type&gt;(x =&gt; \n                                             x.propA == model.PropertyA)\n                                   .List();\n}\n</code></pre>\n\n<p>Is there a better way to do this using a C# Expression instead of a lambda statement?  How do I create an Expression using model.PropertyA?  Do I use Expression.Property() or Expression.Field()?  </p>\n\n<p>thanks</p>\n"},{"tags":["c#","linq","entity-framework","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12732083,"title":"how to make a second level include of objects","body":"<p>I have structure like this</p>\n\n<pre><code>class Lesson {\n    List&lt;Sign&gt; signs { get; set; }\n}\n\nclass Sign {\n    List&lt;Media&gt; media { get; set;}\n}\n\nclass Media {\n\n}\n</code></pre>\n\n<p>Now I'm using this LINQ to get all lessons</p>\n\n<pre><code>var items = (from lesson in this.db.Lesson.Include(\"Sign\")\n                     where lesson.module_id == param\n                     select lesson);\n</code></pre>\n\n<p>It works fine but signs list has ampty media list. I mean that attribute <code>media</code> in each object <code>Sign</code> equals null. What do I need to do to include media objects for each Sign ? Whole data is kept in database</p>\n"},{"tags":["linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":12731317,"title":"differences in LINQ queries","body":"<p>Can someone explain why, when a query should be returning one string item only like in the example below;</p>\n\n<pre><code>From c in context.Products Where c.Id=prodId Select c.Name\n</code></pre>\n\n<p>Why cant that be done like so;</p>\n\n<pre><code>Dim prodDeleted as String = (From c in context.Products Where c.Id=prodId Select c.Name).ToString()\n</code></pre>\n\n<p>bvecause it returns this  (System.Data.Objects.ObjectQuery`1[System.String]) , instead of the product name</p>\n\n<p>versus having to do it like so;</p>\n\n<pre><code> Dim prodDeleted = (From c In ctx.products\n                               Where c.Id = prodId\n                               Select c).FirstOrDefault()\n\n Dim deletedprodname As String = prodDeleted.Name.ToString()\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":6,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":99,"score":3,"question_id":12656582,"title":"LINQ query to find if items in a list are contained in another list","body":"<p>I have the following code:</p>\n\n<pre><code>List&lt;string&gt; test1 = new List&lt;string&gt; { \"@bob.com\", \"@tom.com\" };\nList&lt;string&gt; test2 = new List&lt;string&gt; { \"joe@bob.com\", \"test@sam.com\" };\n</code></pre>\n\n<p>I need to remove anyone in test2 that has @bob.com or @tom.com.</p>\n\n<p>What I have tried is this:</p>\n\n<pre><code>bool bContained1 = test1.Contains(test2);\nbool bContained2 = test2.Contains(test1);\n</code></pre>\n\n<p><code>bContained1 = false</code> but <code>bContained2 = true</code>. I would prefer not to loop through each list but instead use a Linq query to retrieve the data. bContained1 is the same condition for the Linq query that I have created below:</p>\n\n<pre><code>List&lt;string&gt; test3 = test1.Where(w =&gt; !test2.Contains(w)).ToList();\n</code></pre>\n\n<p><strong>The query above works on an exact match but not partial matches.</strong></p>\n\n<p>I have looked at other queries but I can find a close comparison to this with Linq. Any ideas or anywhere you can point me to would be a great help.</p>\n"},{"tags":["c#","linq","entity-framework","elmah"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":128,"score":1,"question_id":12730095,"title":"Another System.InvalidOperationException: Sequence contains no elements (using .Any())","body":"<p>Getting the exception on this line:</p>\n\n<pre><code>public bool isEngageOn()\n    {\nline 149  -&gt; return chatUserRepository.Table.Where(c =&gt; c.TrackingOn).Any();\n    }\n</code></pre>\n\n<p><code>TrackingOn</code> is of type boolean.</p>\n\n<p><strong>.Any()</strong> is suppose to \"Determine weather a sequence contains any elements\", so why the exception \"System.InvalidOperationException Sequence contains no elements\" caught on Elmah?</p>\n\n<p>Error:</p>\n\n<pre><code>System.InvalidOperationException: Sequence contains no elements\n at System.Linq.Enumerable.Single[TSource](IEnumerable`1 source)\n at System.Linq.Queryable.Any[TSource](IQueryable`1 source)\n at sf2015.Models.DomainModels.Services.ChatServices.isEngageOn() in C:\\....\\ChatServices.cs:line 149\n</code></pre>\n\n<p>p.s.: Can't reproduce the error but it shows up on <a href=\"https://code.google.com/p/elmah/\" rel=\"nofollow\">Elmah</a> error logs sometimes.</p>\n\n<p>Below is some of the code for the repository</p>\n\n<pre><code>public virtual IQueryable&lt;T&gt; Table\n    {\n        get\n        {\n            return this.Entities;\n        }\n    }\n\n    private DbSet&lt;T&gt; Entities\n    {\n        get\n        {\n            if (_entities == null)\n                _entities = Context.Set&lt;T&gt;();\n            return _entities;\n        }\n    }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":88,"score":3,"question_id":12719425,"title":"LINQ Grouping by Sum Value","body":"<p>Say I have a class like so:</p>\n\n<pre><code>public class Work\n{\n    public string Name;\n    public double Time;\n\n    public Work(string name, double time)\n    {\n        Name = name;\n        Time = time;\n    }\n }\n</code></pre>\n\n<p>And I have a <code>List&lt;Work&gt;</code> with about 20 values that are all filled in:</p>\n\n<pre><code>List&lt;Work&gt; workToDo = new List&lt;Work&gt;();\n// Populate workToDo\n</code></pre>\n\n<p>Is there any possible way that I can group <code>workToDo</code> into segments where each segments sum of Time is a particular value? Say <code>workToDo</code> has values like so:</p>\n\n<pre><code>Name | Time\nA    | 3.50\nB    | 2.75\nC    | 4.25\nD    | 2.50\nE    | 5.25\nF    | 3.75\n</code></pre>\n\n<p>If I want the sum of times to be 7, each segment or <code>List&lt;Work&gt;</code> should have a bunch of values where the sum of all the Times is 7 or close to it. Is this even remotely possible or is it just a stupid question/idea? I am using this code to separate <code>workToDo</code> into segments of 4:</p>\n\n<pre><code>var query = workToDo.Select(x =&gt; x.Time)\n        .Select((x, i) =&gt; new { Index = i, Value = x})\n        .GroupBy(y =&gt; y.Index / 4)\n        .ToList();\n</code></pre>\n\n<p>But I am not sure how to do it based on the Times.</p>\n"},{"tags":["linq","dynamics-crm"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":88,"score":2,"question_id":12712060,"title":"LINQ to CRM or just LINQ to SQL/Entity","body":"<p>I've used LINQ on the fetched entities from CRM Dynamics but despite the original source of the data, it was still only operating via LINQ to data structure. Now, I've got a hint that there exists possibility to use LINQ to query the DB in Dynamics directly, which was surprising but (under assumption that it works out) fantastic.</p>\n\n<p>So, I've checked the SDK and samples and as far I've could see, there is some kind of LINQ to CRM thing going on there. Since I have hard time believing that Microsoft has spent so much development hours on such a specialized product, I'm suspecting that it's in fact LINQ to SQL/Entity run under the CRM (Dynamics is powered by MS SQL Server, isn't it?) and I'd like someone to either deny or confirm it.</p>\n\n<p>For instance I've seen those two articles: <a href=\"http://msdn.microsoft.com/en-us/library/gg509017.aspx\" rel=\"nofollow\">document #1</a> and <a href=\"http://msdn.microsoft.com/en-us/library/gg334504.aspx\" rel=\"nofollow\">document #2</a>.</p>\n\n<p>EDIT:</p>\n\n<p>My question is, hence, if there is a true LINQ-to-CRM or if we're dealing with LINQ-to-SQL (or something similar) run under the real of CRM Dynamics.</p>\n"},{"tags":["c#","arrays","linq","contains"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":12726876,"title":"Using LINQ how can I check for an instance of a number in one array, in another array?","body":"<p>I have a list of <code>MyItem</code> objects called <code>myItems</code> like this:</p>\n\n<pre><code>public class MyItem{\n    public int[] category_ids;\n    public string name;\n}\n\nList&lt;MyItem&gt; myItems;\n</code></pre>\n\n<p>I want to filter down the list of objects with a list of selected categories so that the filtered list contains ANY of the filter category ids:</p>\n\n<pre><code>int[] filter = { 1, 5, 6, 9 };\n</code></pre>\n\n<p>How would I do that using LINQ in one line? (if its even possible, I cant wrap my head around it!)\nI imagine something along the lines of:</p>\n\n<pre><code>IEnumerable&lt;MyItem&gt; filtered = myItems.Where(item =&gt; item.category_ids.Contains(xxx));\n</code></pre>\n"},{"tags":["c#","linq","distinct","linq-to-nhibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12726166,"title":"How use Distinct in linq & linq to NHibernate by some columns","body":"<p>I have a Address class.</p>\n\n<pre><code>public class Address : RootEntityBase\n{\n    virtual public string Province { set; get; }\n    virtual public string City { set; get; }        \n    virtual public string PostalCode { set; get; }\n}\n</code></pre>\n\n<p>By this default values:</p>\n\n<pre><code>var myList = new List&lt;Address&gt;\n             {\n               new Address {Province = \"P1\", City = \"C1\", PostalCode = \"A\"},\n               new Address {Province = \"P1\", City = \"C1\", PostalCode = \"B\"},\n               new Address {Province = \"P1\", City = \"C1\", PostalCode = \"C\"},\n\n               new Address {Province = \"P1\", City = \"C2\", PostalCode = \"D\"},\n               new Address {Province = \"P1\", City = \"C2\", PostalCode = \"E\"},\n\n               new Address {Province = \"P2\", City = \"C3\", PostalCode = \"F\"},\n               new Address {Province = \"P2\", City = \"C3\", PostalCode = \"G\"},\n               new Address {Province = \"P2\", City = \"C3\", PostalCode = \"H\"},\n\n               new Address {Province = \"P2\", City = \"C4\", PostalCode = \"I\"}\n             };\n</code></pre>\n\n<p>I need to extraction distinct of this myList by two columns : Province &amp; City</p>\n\n<p>Namely similar to <code>myExpertResult</code> :</p>\n\n<pre><code>var myExpertResult = new List&lt;Address&gt;\n                        {\n                           new Address {Province = \"P1\", City = \"C1\"},\n                           new Address {Province = \"P1\", City = \"C2\"},\n                           new Address {Province = \"P2\", City = \"C3\"},\n                           new Address {Province = \"P2\", City = \"C4\"}\n                        }; \n</code></pre>\n\n<p>So I use this code :</p>\n\n<pre><code>var list = myList.Select(x =&gt; new Address {City = x.City, Province = x.Province}).Distinct().ToList();\n</code></pre>\n\n<p>but my result is not valid because count of result is 9 namely all addresses.</p>\n\n<p>Quivalent query in SQL is : <code>select distinct Province , City from tblAddress</code></p>\n\n<p>also I tested this query by linq to NHibernate. </p>\n\n<pre><code>var q = SessionInstance.Query&lt;Address&gt;();\n        .Select(x =&gt; new Address { Province = x.Province, City = x.City }).Distinct().ToList();\n</code></pre>\n\n<p>But it is not support this query. Message of exception is : <code>Expression type 'NhDistinctExpression' is not supported by this SelectClauseVisitor.</code></p>\n\n<p>How can I do it?</p>\n"},{"tags":["c#","asp.net-mvc","linq","entity-framework","asp.net-mvc-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12726480,"title":"NullReferenceException when trying to add in one-to-many relation","body":"<p><code>Item</code> can contain multiple <code>Sizes</code>. When I try to add new size to my item it throws <code>NullReference</code> error. Same thing happens when I try to add images to my item.</p>\n\n<blockquote>\n  <p>Object reference not set to an instance of an object.</p>\n</blockquote>\n\n<h2>Code</h2>\n\n<pre><code>var size = new Size(){\n    BasePrice = currentBasePrice, // not null, checked in debugger\n    DiscountPrice = currentDiscountPrice // not null, checked in debugger\n};\n\n// item is not null, checked in debugger\nitem.Sizes.Add(size); // nothing here is null, however it throws null reference error here\n</code></pre>\n\n<h2>Item Model</h2>\n\n<pre><code>public class Item\n{\n    public int ID { get; set; }\n    public int CategoryID { get; set; }\n    virtual public Category Category { get; set; }\n    virtual public ICollection&lt;Size&gt; Sizes { get; set; }\n    virtual public ICollection&lt;Image&gt; Images { get; set; }\n}\n</code></pre>\n\n<h2>Size Model</h2>\n\n<pre><code>public class Size\n{\n    public int ID { get; set; }\n    public int ItemID { get; set; }\n    virtual public Item Item { get; set; } // tried to delete this, did not help\n    public decimal BasePrice { get; set; }\n    public decimal? DiscountPrice { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":19,"down_vote_count":0,"view_count":49187,"score":19,"question_id":499578,"title":"C# LINQ Query - Group By","body":"<p>I'm having a hard time understanding how I can form a LINQ query to do the following:</p>\n\n<p>I have a table CallLogs and I want to get back a single result which represents the call that has the longest duration.</p>\n\n<p>The row looks like this:</p>\n\n<p>[ID] [RemoteParty] [Duration]</p>\n\n<p>There can be multiple rows for the same RemoteParty, each which represents a call of a particular duration. I'm wanting to know which RemoteParty has the longest total duration.</p>\n\n<p>Using LINQ, I got this far:</p>\n\n<pre><code>var callStats = (from c in database.CallLogs\n                 group c by c.RemoteParty into d\n                 select new\n                 {\n                      RemoteParty = d.Key,\n                      TotalDuration = d.Sum(x =&gt; x.Duration)\n                 });\n</code></pre>\n\n<p>So now I have a grouped result with the total duration for each RemoteParty but I need the maximum single result. </p>\n\n<blockquote>\n  <p>[DistinctRemoteParty1] [Duration]</p>\n  \n  <p>[DistinctRemoteParty2] [Duration]</p>\n  \n  <p>[DistinctRemotePartyN] [Duration]</p>\n</blockquote>\n\n<p>How can I modify the query to achieve this?</p>\n"},{"tags":["c#","linq","linq-to-sql","todictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":245,"score":0,"question_id":7671708,"title":"Linq-to-SQL ToDictionary","body":"<p>I have the following LINQ query:</p>\n\n<pre><code>var allocations = \n    from ta in dc.TransactionAllocations\n    where ta.Allocated == false\n    group ta by new { ta.ReceiptReference, ta.Customer } into tag\n    select new\n    {\n        Customer = tag.Key.Customer,\n        ReceiptReference = tag.Key.ReceiptReference,\n        Invoices = tag.ToDictionary(a =&gt; new AllocationDictionaryKey()\n            {\n                ID = a.ID, \n                InvoiceReference = a.InvoiceReference \n            }, \n            a =&gt; a.Amount)\n    }\n</code></pre>\n\n<p>But when I try to execute this, the ToDictionary call fails as it's not a supported LINQ-to-SQL operator. The only way around this I have seen is to call ToDictionary at the end of the query, but I only want one property of my anonymous type to be a dictionary!</p>\n\n<p>Any ideas on how to go about doing this? </p>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12724435,"title":"Linq select subquery","body":"<p>As the title states, I'm trying to perform a select subquery in Linq-To-SQL. Here's my situation:</p>\n\n<p>I have a database view which returns the following fields:</p>\n\n<ul>\n<li>SourceId</li>\n<li>LicenseId</li>\n<li>LicenseName</li>\n<li>CharacteristicId</li>\n<li>CharacteristicName</li>\n</ul>\n\n<p>Now I want to be able to store this in a model of mine which has the following properties</p>\n\n<ul>\n<li>Id</li>\n<li>Name</li>\n<li>Characteristics (this is List which has Id, Name and Icon => Icon is byte[])</li>\n</ul>\n\n<p>Here's the query I wrote which doesn't work:</p>\n\n<pre><code>var licensesWithCharacteristics =\n                _vwAllLicensesWithAttributesAndSourceIdRepository.GetAll()\n                .Where(x =&gt; x.SourceID == sourceId)\n                .Select(a =&gt; new LicenseWithCharacteristicsModel()\n                {\n                    LicenseId = a.LicenseId,\n                    LicenseName = a.LicenseName\n                        ,CharacteristicList = _vwAllLicensesWithAttributesAndSourceIdRepository.GetAll()\n                     .Where(x =&gt; x.LicenseId == a.LicenseId)\n                     .Select(c =&gt; new CharacteristicModel { Id = c.CharacteristicID, Name = c.CharacteristicName, Icon = c.Icon })\n                     .Distinct().ToList()\n                })\n                .Distinct().ToList();\n</code></pre>\n\n<p>How would you solve this? I'm trying to do this in one query to keep my performance up, but I'm kind of stuck.</p>\n"},{"tags":["c#","mysql","linq"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":3,"view_count":97,"score":-2,"question_id":12722641,"title":"How can I convert my query from MySQL to LINQ?","body":"<p>How can I convert this query from MySQL to LINQ?</p>\n\n<pre><code>SELECT SUM(IF(x&gt;0, c*(x/100),20.00)) AS x1 \nFROM tablename \nWHERE uid=\"some value\" AND name='some value';\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":12723156,"title":"Find a set number of values from collection","body":"<p>I have some code that filters through a collection of sorted objects according to a filter value. For instance, I want to find the objects where <code>Name==\"searchquery\"</code>. Then I want to take the top X values from that collection. </p>\n\n<p>My questions:</p>\n\n<ul>\n<li><p>My collection is a <code>List&lt;T&gt;</code>. Does this collection guarantee the sort order?</p></li>\n<li><p>If so, is there a built-in way to find the the top X objects that satisfy the condition? I'm looking for something like </p>\n\n<pre><code>collection.FindAll(o=&gt;o.Name==\"searchquery\",100);\n</code></pre>\n\n<p>That would give me the top 100 objects that satisfy the condition. The reason is performance, once I've found my 100 objects, I don't want to keep checking the entire collection.</p></li>\n<li><p>If i write:</p>\n\n<pre><code>collection.FindAll(o=&gt;o.Name==\"searchquery\").Take(100);\n</code></pre>\n\n<p>will the runtime be intelligent enough to stop checking once it hits 100?</p></li>\n</ul>\n\n<p>I can of course implement this myself, but if there is a built-in way (like a LInQ method) I'd prefer to use it.</p>\n"},{"tags":["linq","join","filter","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":12723074,"title":"Using linq and lambda to filter two collections","body":"<p>I need to filter a query by two collections.</p>\n\n<p>I have a list of IDs which i need to filter a linq query with</p>\n\n<p>The collection looks like this</p>\n\n<pre><code>&lt;table1_id, table2_id&gt;\n</code></pre>\n\n<p>and the contect looks like this</p>\n\n<pre><code>idList = &lt;1,10&gt;,&lt;2,12&gt;\n</code></pre>\n\n<p>The query looks like this</p>\n\n<pre><code>Dim l = (From t1 In Table1\nJoin t2 In Table2 ON t1.table1_id Equals t2.table2_id\nWhere idList.Contains(idList.table1_id) and idlist.Contains(idList.table2_id))\n</code></pre>\n\n<p>Problem is that this works like a cross join so I get all the combinations.</p>\n\n<p>How can make the two collection filter like this query</p>\n\n<pre><code>Select * from\ntable1 t1 Inner join table2 t2 on t1.ID = t2.ID\nwhere t1.ID in (1,2)\nand t2.ID in (10, 12)\n</code></pre>\n\n<p>Here is the real example from my code:</p>\n\n<p>SQL Query:</p>\n\n<pre><code>    Select * from\ndbo.v_MARKET_BUSINESS_ROLES mbs\nInner join dbo.SAP_COMPONENT brs\n on mbs.BUSINESS_ROLE_ID = brs.BUSINESS_ROLE_ID\nand mbs.erd in ('1','2')\nand brs.ID in (10,12)\nwhere \nbrs.market_id = 1\n</code></pre>\n\n<p>Code:</p>\n\n<p>Select roles have 2 id's 1 and 2 so Im only collecting the selected roles from a list</p>\n\n<pre><code>Dim businessRolesIDs = (From olc In ctx.organization_level_constraint\n                                          Where selectedOrgLevels.Contains(olc.organization_level_id) _\n                                                            AndAlso olc.market_id = marketId _\n                                          AndAlso selectedRoles.Contains(olc.business_role_id)\n                                          Select olc.business_role_id, olc.sap_component_id).Distinct.ToList\n\n\nhere I try to filter by the collection returned above\n\nDim marketBusinessRolesCollection = (From m In ctx.GetMarketBusinessRolesFromView(marketId) _\n                                                    Join bs In ctx.business_role_sap_component On m.C_BUSINESS_ROLE_ID Equals bs.business_role_id _\n                                                    Where (From item In businessRolesIDs Select item.business_role_id).Contains(m.C_BUSINESS_ROLE_ID)  _\n                                                    And (From item2 In businessRolesIDs Select item2.sap_component_id).Contains(bs.sap_component_id)  _\n                                                    And bs.market_id = marketId _\n                                                    Select New BusinessRole With _\n                                                      { \n                                                         .BusinessRoleId = m.ERD\n                                                      }).Distinct.ToList\n</code></pre>\n"},{"tags":["linq","enums"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12723455,"title":"Filter Enums based on List in LINQ","body":"<p>I Have a Enum</p>\n\n<pre><code>public enum ProcessStatus: byte\n{\n    NotStarted = 0,\n    PreCheckStarted= 1,\n    PreCheckCompleted= 2,\n    Processing= 3,\n    Failed= 4,\n    Completed= 5,\n    Closed= 6\n}\n</code></pre>\n\n<p>in Table we have entries like 0,3,5,6</p>\n\n<p>we need list of Enums based on some criteria and criteria is List which contains 0,1,2</p>\n\n<p>i am able to get all Enums as List Like</p>\n\n<pre><code> Enum.GetValues(typeof(ProcessStatus)).OfType&lt;ProcessStatus&gt;()\n</code></pre>\n\n<p>and have </p>\n\n<pre><code>List&lt;byte&gt; processListIDs \n</code></pre>\n\n<p>which contains IDs</p>\n\n<p>i want </p>\n\n<pre><code> IEnumerable&lt;ProcessStatus&gt; filtered based on ids in processListIDs using LINQ.\n</code></pre>\n\n<p>Thanks in Advance</p>\n"},{"tags":["c#",".net","linq","silverlight"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12723321,"title":"LINQ Select and concatenate results from hierarchical model","body":"<p>I have the below model which represents a two level menu hierarchy and what I need to do is select one ID from the <code>SubMenuItems</code> sub collection then concatenate the results from its and its parent records <code>TextToDisplay</code> properties.</p>\n\n<p>The question I have is how to return a single parent item and a single sub item then access the <code>TextToDisplay</code> property?</p>\n\n<p>The object that I want to query is an <code>ObserableCollection</code></p>\n\n<pre><code>public ObservableCollection&lt;MenuModel&gt; MenuItems { get; set; }\n</code></pre>\n\n<p><strong>Model</strong></p>\n\n<pre><code>public class MenuModel\n{\n    public int ID { get; set; }\n    public string TextToDisplay { get; set; }\n    public string ImageSource { get; set; }\n    public ObservableCollection&lt;MenuModel&gt; SubMenuItems { get; set; }\n}\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":122,"score":3,"question_id":12723289,"title":"LINQ DataTable Select Distinct Rows","body":"<p>I am trying to get the distinct row with sum of each duplicate rows</p>\n\n<pre><code>DataTable newItems = new DataTable();\n\nnewItems.Columns.Add(\"Qty\");\nnewItems.Columns.Add(\"BarcodeNumber\");\nnewItems.Columns.Add(\"DisplayName\");\nnewItems.Columns.Add(\"UnitPrice\");\nnewItems.Columns.Add(\"TotalPrice\");\n\nnewItems.Rows.Add(1, \"URT29384\", \"Wallet\", 88.8, 88.8);\nnewItems.Rows.Add(1, \"URT29233\", \"Mouse\", 4.44, 4.44);\nnewItems.Rows.Add(1, \"URT29756\", \"Flash Drive\", 1.47, 1.47);\nnewItems.Rows.Add(1, \"URT29323\", \"Spoon\", 99.95, 99.95);\nnewItems.Rows.Add(1, \"URT29384\", \"Wallet\", 88.8, 88.8);\nnewItems.Rows.Add(1, \"URT29384\", \"Wallet\", 88.8, 88.8);\n</code></pre>\n\n<p>i want the result to be </p>\n\n<pre><code> 3 URT29384  Wallet       266.4     266.4\n 1 URT29233  Mouse          4.44      4.44\n 1 URT29756  Flash Drive    1.47      1.47\n 1 URT29323  Spoon         99.95     99.95\n</code></pre>\n\n<p>is this possible using LINQ? a little help here.. TYIA</p>\n"},{"tags":["c#","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12722186,"title":"how to use groupby in mvc?","body":"<p>This is my query .</p>\n\n<pre><code> var query = from sbw in _sbwRepository.Table\n                            orderby sbw.CountryId, sbw.StateProvinceId, sbw.Zip, sbw.ShippingMethodId, sbw.From                           \n                            select sbw;\n</code></pre>\n\n<p>How to groupby \"sbw.CountryId\" ?</p>\n"},{"tags":["c#",".net","vb.net","linq","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":115,"score":2,"question_id":10673559,"title":"Linq To SQL InsertAllOnSubmit and DeleteAllOnSubmit","body":"<p>Can I revert deleted objects from <code>DeleteAllOnSubmit()</code> by calling <code>InsertAllOnSubmit()</code> again,\nor the opposite?</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":4276,"score":9,"question_id":34913,"title":"C# Linq Grouping","body":"<p>I'm experimenting with Linq and am having trouble figuring out grouping  I've gone through several tutorials but for some reason can't figure this out.</p>\n\n<p>As an example, say I have a table (SiteStats) with multiple website IDs that stores a count of how many visitors by type have accessed each site in total and for the past 30 days.</p>\n\n<p>SiteID.........VisitorType.........Last30........Total<br>\n.......1.......................1................10.........100<br>\n.......1.......................2................40.........140<br>\n.......2.......................1................20.........180</p>\n\n<p>etc.</p>\n\n<p>In SQL, I can easily get the counts for SiteID 1 with the following:</p>\n\n<p>SELECT SiteID,<br>\nSUM(Last30) AS Last30Sum<br>\nFROM Sites<br>\nWHERE SiteID = 1<br>\nGROUP BY SiteID</p>\n\n<p>and should get a row like</p>\n\n<p>SiteID.........Last30Total<br>\n.......1......................50</p>\n\n<p>However I'm not sure how to get this result using Linq.  I've tried</p>\n\n<pre><code>var statsRecord = from ss in db.SiteStats  \n    where ss.SiteId == siteId  \n    group ss by ss.SiteId into ss  \n    select ss;\n</code></pre>\n\n<p>but I'm not able to get back the total with something like</p>\n\n<p>statsRecord.Last30</p>\n\n<p>Can someone please let me know where I'm going wrong?  Any help is appreciated.</p>\n"},{"tags":["c#","asp.net","linq","dynamics-crm-2011"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12717736,"title":"How to programmatically reference the current entity in a ASP.NET page (MS CRM 2011)","body":"<p>We are building a aspx page sidebar navigation menu (MS CRM 2011 Customer Portal) that needs to get a reference to the current entity that called the page.</p>\n\n<p>Initially we thought we could use a CRM Property and bind it to a parameter in a LinqDatasource:</p>\n\n<pre><code>crm:Property DataSourceID=\"CurrentEntity\" PropertyName=\"adx_name\" runat=\"server\"\n\n(The current entity would be an adx_webpage)\n</code></pre>\n\n<p>then do something like this:</p>\n\n<pre><code>asp:LinqDataSource ID=\"individpagecontent\" ContextTypeName=\"Xrm.XrmServiceContext\"\n                TableName=\"new_programmeSet\"\n                Where=\"new_name == @ADX_NAME PARAMETER FROM ABOVE\"\n</code></pre>\n\n<p>but this failed with a syntax error... Has anyone done something similar and able to provide a guiding hand?</p>\n\n<p>Thank you, much appreciated.</p>\n"},{"tags":["c#","linq","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":12717954,"title":"Return a List<int> from List<T> with an integer property?","body":"<p>The end result is I want to use <code>.Where(t =&gt; someIntList.Contains(t.ID)).ToList()</code>. I'm struggling to create <code>someIntList</code>.</p>\n\n<p>What I have so far: <code>List&lt;Person&gt; people = people.Where(p =&gt; p.isActive).ToList()</code>. How do I return just a <code>List&lt;int&gt;</code> of the <code>p.ID</code> property?</p>\n\n<p>Or is there another way to do Contains (without writing a Comparer class as I already have one used for another purpose.</p>\n"},{"tags":[".net","linq","linq-to-sql"],"answer_count":2,"favorite_count":6,"up_vote_count":7,"down_vote_count":0,"view_count":3697,"score":7,"question_id":550826,"title":"Translate LINQ to sql statement","body":"<p>I want to translate LINQ expression tree to SQL statement and I don't want to write my own code for this.</p>\n\n<p>Example:</p>\n\n<pre><code>var query = from c in Customers\nwhere c.Country == \"UK\" &amp;&amp;\n      c.City == \"London\"\nselect c);\n</code></pre>\n\n<p>To </p>\n\n<pre><code>SELECT ... FROM Customers AS c WHERE c.Country = \"UK\" AND c.City = \"London\"\n</code></pre>\n\n<p>I know <code>DataContext.Log</code>, but I want to use:</p>\n\n<pre><code>query.ToSqlStatementString()\n</code></pre>\n"},{"tags":["c#","xml","linq"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12706566,"title":"Search Xml file with Linq, get nodes that match to subnodes","body":"<p>I have a Xml file with the following structure:</p>\n\n<pre><code>&lt;Packages&gt;\n    &lt;Package&gt;\n        &lt;Name&gt;Package1&lt;/Name&gt;\n        &lt;Dependencies&gt;\n            &lt;Dependency&gt;Package2 &lt;/Dependency&gt;\n        &lt;/Dependencies&gt;\n    &lt;/Package&gt;\n    &lt;Package&gt;\n        &lt;Name&gt;Package2&lt;/Name&gt;\n        &lt;Dependencies&gt;\n            &lt;Dependency&gt;Package3&lt;/Dependency&gt;\n        &lt;/Dependencies&gt;\n    &lt;/Package&gt;\n    &lt;Package&gt;\n        &lt;Name&gt;Package3&lt;/Name&gt;\n        &lt;Dependencies /&gt;\n    &lt;/Package&gt;\n&lt;/Packages&gt;\n</code></pre>\n\n<p>I want to parse the Xml file, and print out the dependency \"flow\".</p>\n\n<p>For example:</p>\n\n<pre><code>Package1 -&gt; \n  Package2 -&gt;\n    Package3\nPackage2 -&gt;\n  Package3\nPackage3\n</code></pre>\n\n<p>The purpose is to create a \"sequence\" that will install applications, the commands should be stored in a Xml file. A package could have dependencies.</p>\n\n<p>Can I use Linq to solve this problem?</p>\n\n<p>I don't need a complete solution, just a hint in right direction.</p>\n"},{"tags":["c#","asp.net-mvc","linq","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12715663,"title":"Linq to Entity Select, Exclude 1st result row?","body":"<p>I have a Linq to Entity Select statement that is currently returning all rows from the database.  Since the 1st row of data contains header information, is it possible to exclude the first row from the result set?</p>\n\n<pre><code>var surveyProgramType = surveyProgramTypeRepository\n                        .Find()\n                        .OrderBy(x =&gt; x.ProgramType);\n</code></pre>\n"},{"tags":["c#","linq","linq-to-xml","xelement"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12715738,"title":"Querying xml child elements with prefixed namespace using LINQ to XML","body":"<p>So I have some XML that generally looks like this</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;wd:Data xmlns:wd=\"urn:com.foo.bar/GetResult\"&gt;\n    &lt;wd:Result&gt;\n        &lt;wd:field1&gt;lorem&lt;/wd:field1&gt;\n        &lt;wd:field2&gt;ipsum&lt;/wd:field2&gt;\n        &lt;wd:field3&gt;dolor&lt;/wd:field3&gt;\n        &lt;wd:field4&gt;sit&lt;/wd:field4&gt;\n    &lt;/wd:Result&gt;\n&lt;/wd:Data&gt;\n</code></pre>\n\n<p>The namespace is prefixed with \"wd\"</p>\n\n<p>I'd like to be able to take each of the elements within <code>&lt;wd:Result&gt;...&lt;/wd:Result&gt;</code> and create a new <code>KeyValuePair&lt;string, string&gt;</code> where the key is the element name and the value is the value of the element like so:</p>\n\n<p>{\"field1\", \"lorem\"}\n{\"field2\", \"ipsum\"}\n{\"field3\", \"dolor\"}\n{\"field4\", \"sit\"}</p>\n\n<p>My struggle is with the namespace prefix. I am very much a novice with LINQ but I have always been able to get something like this to work with code like this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var data = XElement.Parse(theXml); \nXNamespace ns = \"urn:com.foo.bar/GetResults\"; \nvar result = data.Elements(ns + \"Result\")\n                 .Select(x =&gt; new KeyValuePair&lt;string, string&gt;(x.Name.LocalName, x.Value))\n                 .ToList();\n</code></pre>\n\n<p>How should I query this data to to produce the desired result?</p>\n\n<p>I'm not married to LINQ so whatever the community feels is best will be fine with me. </p>\n"},{"tags":["linq","entity-framework"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":12710936,"title":"Deep LINQ projections, how?","body":"<p>Let's say I have a model created with EF 4.0</p>\n\n<ul>\n<li><p>User</p>\n\n<ul>\n<li><p>Roles</p>\n\n<ul>\n<li>Permissions</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>Each entity has a DeleteDate property.</p>\n\n<p>I want to get a specific user (with Name =...) and have the tree filled with items where DeletedDate == null..</p>\n\n<p>This must be done with anonymous type projection as result, but I don't know how to accomplish this with a hierachy deeper than 2..</p>\n\n<p>This is what I already have:</p>\n\n<pre><code>    public MyProjection MyCall(string givenName)\n    {\n      var result = from s in context.Users\n                   where (s.Name == givenName &amp;&amp;\n                                    s.DeletedDate == null)\n                             select new\n                             {\n                                 s,\n                                 roles = from r in s.Roles\n                                         where r.DeletedDate == null\n                                         select r\n                             };\n\n      var outcome = result.FirstOrDefault();\n\n      if (outcome != null)\n      {\n         var myProjection = new MyProjection()\n         {\n             User = outcome.s,\n             Roles = outcome.roles\n         };\n\n         return myProjection;\n       }\n\n    return null;\n   }\n</code></pre>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":74,"score":4,"question_id":12712192,"title":"Ordering within groups using LINQ","body":"<p>Given the following data:</p>\n\n<pre><code>List&lt;Country&gt; countries = new List&lt;Country&gt;();\n\ncountries.Add(new Country{ Name = \"USA\",     population=500000,  Year=2012 });\ncountries.Add(new Country{ Name = \"USA\",     population=300000,  Year=2002 });\ncountries.Add(new Country{ Name = \"USA\",     population=250000,  Year=1992 });\ncountries.Add(new Country{ Name = \"USA\",     population=20000,   Year=1982 });\n\ncountries.Add(new Country{ Name = \"India\",   population=1500000, Year=2012 });\ncountries.Add(new Country{ Name = \"India\",   population=1000000, Year=2002 });\ncountries.Add(new Country{ Name = \"India\",   population=50000,   Year=1982 });\ncountries.Add(new Country{ Name = \"India\",   population=80000,   Year=1992 });\n\ncountries.Add(new Country{ Name = \"Germany\", population=100000,  Year=2012 });\ncountries.Add(new Country{ Name = \"Germany\", population=400000,  Year=2002 });\ncountries.Add(new Country{ Name = \"Germany\", population=60000,   Year=1992 });\ncountries.Add(new Country{ Name = \"Germany\", population=4000,    Year=1982 });\n\ncountries.Add(new Country{ Name = \"UK\",      population=450000,  Year=2002 });\ncountries.Add(new Country{ Name = \"UK\",      population=50000,   Year=1992 });\ncountries.Add(new Country{ Name = \"UK\",      population=3000,    Year=1982 });  \n</code></pre>\n\n<p>I want to order the countries by the largest population for a given year, but then display all the years for that country before moving on to the next country.</p>\n\n<p>E.g.</p>\n\n<ol>\n<li><p>2012 - the population order would be India, USA, UK, Germany. So I would like the data to be ordered by all India data,  all USA data, all UK data and then Germany.</p></li>\n<li><p>2002 - the population order would be India, USA, Germany and then UK. UK is last because it has no 2002 data.</p></li>\n</ol>\n\n<p>I want to achieve this using LINQ, although I've used LINQ in the past I'm struggling to get my head around this. Any help would be much appreciated.</p>\n"},{"tags":["c#","sql","sql-server","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":85,"score":-1,"question_id":12715729,"title":"Querying using NULL on varchar column","body":"<p>How do I pass null as a value to a string (varchar) column from linq to sql? I'm trying to query the table where some rows have NULL for a column (say, Col_A) and others have \"NotNull\" (string) as value. </p>\n\n<pre><code>string s = null;\n\nvar query = (from r in context.Table1\n            where r.Col_A == s\n            select r).ToList();\n</code></pre>\n\n<p>This returns 0 rows. But if I set s to \"NotNull\", I get the rows back as expected.</p>\n\n<p>Any pointers will be helpful.</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12715877,"title":"convert linq query syntax to method synatx having Contains in where","body":"<p>I want to convert this query syntax to method syntax, silly but confused</p>\n\n<pre><code>List&lt;int&gt; x = new List&lt;int&gt;();\n// code to fill list\nfrom ug in DataContext.UserGroups\nwhere (\n    from f in x\n    select f    \n).Contains(ug.ID)\nselect ug;\n</code></pre>\n"},{"tags":["c#",".net","string","linq"],"answer_count":5,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":165,"score":6,"question_id":12714288,"title":"Join a string[] Without Using string.Join","body":"<p>This question is for academic purposes only.</p>\n\n<p>Let's assume I have the following code ...</p>\n\n<pre><code>var split = line.Split(new[] { ',' }, System.StringSplitOptions.RemoveEmptyEntries);\nvar elem = new XElement(\"shop\");\nelem.SetAttributeValue(\"name\", split.Take(split.Length - 1));  &lt;=====\nelem.SetAttributeValue(\"tin\", split.Last());\n</code></pre>\n\n<p>And I would like the line with the arrow to produce the same result as this ...</p>\n\n<pre><code>string.Join(string.Empty, split.Take(split.Length - 1));\n</code></pre>\n\n<p>... without using <code>string.Join</code>.</p>\n\n<p>Is that possible? I can't seem to find a LINQ statement to do it ... hopefully y'all already know!</p>\n"},{"tags":[".net","sql-server","linq","ado.net","entity-framework-4"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":2804,"score":6,"question_id":3595511,"title":"Entity Framework 4: Eager Loading (Include) with filters using Self Tracking Entities","body":"<p>I have a solution where I have created self tracking entities using the RTM templates. I have split the entities and context between 2 projects so that I can reuse the type definitions as I plan to run client/server via WCF.</p>\n\n<p>One of my service methods is required to return a graph of \"Product\" objects with child objects of \"ProductSku\" and these in turn have child objects of \"ProductPrice\". The selection criteria will be on the \"Name\" property of the \"Product\" object, and the \"FinancialPeriodID\" property of the \"ProductPriceObject\". For now, I am not including the name in the search, but I am having problems bringing back the graph.</p>\n\n<p>If I simply perform the following query (note, this syntax is taken from LinqPad rather than the actual application code)...</p>\n\n<pre><code>from product in Products.Include(\"Skus.PriceHistory\")\nselect product\n</code></pre>\n\n<p>... then I am able to retrieve the full object graph for the items that I require, of course at this point there is no filter.</p>\n\n<p>If instead, I introduce the filter as follows...</p>\n\n<pre><code>from product in Products.Include(\"Skus.PriceHistory\")\njoin sku in ProductSkus on product.ID equals sku.ProductID\njoin price in ProductPrices on sku.ID equals price.ProductSkuID\nwhere price.FinancialPeriodID == 244\nselect product\n</code></pre>\n\n<p>... what I am expecting to get back is the \"Product\" objects, the child \"ProductSku\" objects (which are in the \"Skus\" collection of the \"Product\") and their \"ProductPrice\" objects (which are in the \"PriceHistory\" collection of the \"ProductSku\") - but I only get back the \"Product\" objects, the \"Skus\" collection is empty.</p>\n\n<p>I have also tried coding the query as ...</p>\n\n<pre><code>from product in Products.Include(\"Skus.PriceHistory\")\nfrom sku in product.Skus\nfrom price in sku.PriceHistory\nwhere price.FinancialPeriodID == 244\nselect product\n</code></pre>\n\n<p>... but this makes no difference either.</p>\n\n<p>Clearly, I must be doing something wrong. Can anybody shed any light on what that something is as I have been at this for some hours now going around in circles!</p>\n"},{"tags":["c#","linq"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":12713325,"title":"Search on binary field with LINQ","body":"<p>I've a table that includes a binary field (says \"bin\") which contains 14 bytes data. I want to do a search on this field as below:</p>\n\n<pre><code>from row in db.users where row.bin.SequenceEqual(data) select row\n</code></pre>\n\n<p>the type of \"data\" variable is byte[].\nbut when I run \"q.Count()\", I encounter the following error:</p>\n\n<pre>\nLINQ to Entities does not recognize the method 'Boolean SequenceEqual[Byte]\n(System.Collections.Generic.IEnumerable`1[System.Byte], \nSystem.Collections.Generic.IEnumerable`1[System.Byte])' method, \nand this method cannot be translated into a store expression.\n</pre>\n\n<p>How can I retrieve the count of matches binary data?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","linq","group-by","iequalitycomparer"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12703186,"title":"LINQ GroupBy on multiple ref-type fields; Custom EqualityComparer","body":"<p>So I've looked through about 20 examples on this on SO and elsewhere, but haven't found one which covers what I'm trying to do. This - <a href=\"http://stackoverflow.com/questions/188120/can-i-specify-my-explicit-type-comparator-inline\">Can I specify my explicit type comparator inline?</a> - looks like what I need, but doesn't go far enough (or I don't understand how to take it further).</p>\n\n<ul>\n<li>I have a List of LoadData, the LoadData object has fields of both reference and value types</li>\n<li>Need to group on a mixture of ref and value fields, project the output to an anonymous type</li>\n<li><p>Need (I think) to provide a custom IEqualityComparer to specify how to compare the GroupBy fields, but they are an anonymous type</p>\n\n<pre><code>private class LoadData\n{\n    public PeriodEndDto PeriodEnd { get; set; }\n    public ComponentDto Component { get; set; }\n    public string GroupCode { get; set; }\n    public string PortfolioCode { get; set; }\n}\n</code></pre></li>\n</ul>\n\n<p>The best GroupBy query I have going so far:</p>\n\n<pre><code>var distinctLoads = list.GroupBy(\n    dl =&gt; new { PeriodEnd = dl.PeriodEnd, \n                Component = dl.Component, \n                GroupCode = dl.GroupCode },\n    (key, data) =&gt; new {PeriodEnd = key.PeriodEnd, \n                Component = key.Component, \n                GroupCode = key.GroupCode, \n                PortfolioList = data.Select(d=&gt;d.PortfolioCode)\n                                    .Aggregate((g1, g2) =&gt; g1 + \",\" + g2)},\n    null);\n</code></pre>\n\n<p>This groups, but there are still duplicates.</p>\n\n<ol>\n<li>How can I specify custom code to compare the GroupBy fields?  For example, the Components could be compared by Component.Code.</li>\n</ol>\n"},{"tags":["c#","linq","list","collections","count"],"answer_count":8,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":413,"score":8,"question_id":7969354,"title":"Count property vs Count() method?","body":"<p>Working with a collection I have the two ways of getting the count of objects; Count (the property) and Count() the method. Anyone know what key differences are? I might be wrong, but I always use the Count property in any conditional statements because I'm assuming the Count() method performs some sort of query against the collection where as Count must have already been assigned prior to me 'getting.' But that's a guess - I don't know if performance will be affected if I'm wrong.</p>\n\n<p>Thanks,</p>\n\n<p>Dan</p>\n\n<p>EDIT: Out of curiosity then, will Count() throw an exception if the collection is null? Because I'm pretty sure the Count property simply returns 0.</p>\n"},{"tags":["c#","asp.net","asp.net-mvc","linq","entity-framework"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":12710757,"title":"How can I run this function inside LINQ query","body":"<p>I have function that will generate breadcrumbs format for my category e.g. <code>Root-&gt;Children</code>. It works because when I use it in my view it does work and doing its job. However I cannot cast it inside LINQ query.</p>\n\n<p>Can someone explain how can I cast this particular function inside LINQ query? I've tried getting data and then setting it in <code>foreach</code> loop but it said that property is read only.</p>\n\n<p>Function is <code>Infrastructure.CategoryHelpers.Breadcrumbs({id})</code> it will return <code>string</code>.</p>\n\n<h2>Calling function</h2>\n\n<pre><code>public dynamic List()\n{\n    var categories = _db.Categories.Select(x =&gt; new {\n        ID = x.ID,\n        Breadcrumbs = Infrastructure.CategoryHelpers.Breadcrumbs(x.ID, -1, \"\"), // this method cannot be translated into a store expression\n        Name = x.Name,\n        ItemCount = x.Items.Count\n    });\n\n    foreach (var c in categories)\n    {\n        // c.Breadcrumbs = Infrastructure.CategoryHelpers.Breadcrumbs(c.ID); // Value is read only\n    }\n\n    return Json(categories, JsonRequestBehavior.AllowGet);\n}\n</code></pre>\n\n<h2>Error</h2>\n\n<blockquote>\n  <p>LINQ to Entities does not recognize the method 'System.String\n  Breadcrumbs(Int32, Int32, System.String)' method, and this method\n  cannot be translated into a store expression.</p>\n</blockquote>\n"},{"tags":["asp.net-mvc-3","linq","linq-to-sql","objectdisposedexception"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12711405,"title":"ObjectDisposedException after returning from LINQ to SQL query","body":"<p>I am using MVC3 with .NET 4.0 and when my create form is invoked I get an ObjectDisposedException saying that the object has been disposed. The exception ocurrs on this MVC3 page statement:</p>\n\n<pre><code>@Html.DropDownListFor(model =&gt; model.Country, GeneralActivity.GetCountriesMVC(\"NL\"))\n</code></pre>\n\n<p>And the invoked method is like this:</p>\n\n<pre><code>IEnumerable&lt;SelectListItem&gt; GetCountriesMVC(string preselectCountryCode)\n{\n   ... some error checking code omited for simplicity ...\n   IEnumerable&lt;SelectListItem&gt; qlist;\n   using (Data.MyDataContext ctx = new Data.MyDataContext()) {\n      qlist = from p in ctx.Countries select new SelectListItem {\n          Text = p.CountryName,\n          Value = p.CountryCodeId,\n          Selected = (p.CountryCodeId == preselectCountryCode)\n      };\n   }\n   return qlist;\n}\n</code></pre>\n\n<p>During debug I execute up to the return statement and then it leaves and brings me to the invoking @Html statement on the MVC page and the exception is thrown.</p>\n\n<p>The qlist instance is declared outside the USING statement and initialized by the LINQ query so I don't see why it says the object has been disposed.</p>\n"},{"tags":["linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12486191,"title":"complex EF graph linq join","body":"<p><img src=\"http://i.stack.imgur.com/Ai0Qc.png\" alt=\"entity model\"></p>\n\n<p>So, that's my model .. nice and complex.</p>\n\n<p><strong>I'm looking to get Areas by a UserID.</strong> If I were doing this in SQL, I would do a bunch of joins all the way up to the Users table. How would you do this in LINQ query syntax or method chaining?</p>\n\n<p>I can do this pretty straightforward from the other way around, but then I have to do a lot of extra work to flatten the resulting graph and it also requires pulling back all the entities in between.</p>\n\n<p>If I can optionally include AreasPermissions &amp; Permissions, that would be gravy .. but at this point I wouldn't mind an additional query to fetch those.</p>\n\n<p>Another option I was floating was using a function import to a sproc and map that to an Area .. but when I start needing to include other entities it makes that option less elegant. I'm also trying to avoid using sprocs <em>just to use sprocs</em> because it's always a slippery slope with folks .. 'use a sproc for one thing' tends to mold into 'don't use EF (table access) for anything'. </p>\n\n<pre><code>var userByID = new Func&lt;User, bool&gt;(x =&gt; x.UserId.Equals(userID, StringComparison.InvariantCultureIgnoreCase));\nvar user = this._context.Users\n    .Include(\"TeamsUsers.Team.TeamsRoles.Role.RolesAreasPermissions.AreaPermission.Area\")\n    .Include(\"TeamsUsers.Team.TeamsRoles.Role.RolesAreasPermissions.AreaPermission.Permission\")\n    .Single(userByID);\n</code></pre>\n"},{"tags":["linq","entity-framework-4","linq-to-entities","asp.net-membership","entity-relationship"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":129,"score":2,"question_id":12488003,"title":"Linq To Entities - Get User Info With All Roles","body":"<p>I am new to Linq and am testing it out with a new MVC site.  I am still working my way through the syntax and capabilities, and I have run into a problem that I have not been able to solve.  Any assistance would be appreciated.</p>\n\n<p><strong>Situation:</strong></p>\n\n<p>1 - I have an SQL database setup to use the default ASPNET Membership Provider.  Standard naming conventions remain (aspnet_Users, aspnet_Roles, aspnet_UsersInRoleetc.)</p>\n\n<p>2 - I have an added table called Users which provides extended user info. FK is the aspnet_User UserId (one to one).</p>\n\n<p>3 - I have an added table called Customers which provides customer (ordering) info.  FK is the UserId from the Users table (one to one).</p>\n\n<p>4 - I have added a tabled called CustomerAddress which provides customer address info.  FK is the CustomerId from the Customers table (one to many).</p>\n\n<p>5 - I have set up a model to handle the presentation of this information to the admin</p>\n\n<p><strong>Issues:</strong></p>\n\n<p>1 - I would like to include with this presentation model a list of all roles available within the application and whether the user is currently assigned to that role.</p>\n\n<p>2 - I would like to include with this presentation model a list of all addresses associated with the user </p>\n\n<p>3 - I cannot figure out how to get this information back to my presentation model using a Linq query</p>\n\n<p>Here is my Presentation Model (note that I currently have a property for the Roles but I haven't been able to figure out how to get this information.  AND...I'm not sure what the type should be?</p>\n\n<pre><code>namespace Lambuth.PresentationModels.ManageUsers\n{\npublic class UserDetail\n{\n[Editable(false)]\n[Key, ScaffoldColumn(false)]\n[Display(Name=\"User ID\")]\npublic Guid UserId { get; set; }\n\n[Required]\n[Editable(false)]\n[StringLength(16)]\n[Display(Name=\"User Name\")]\npublic string UserName { get; set; }\n\n[Editable(false)]\n[ScaffoldColumn(false)]\n[StringLength(16)]\n[Display(Name = \"Lowered User Name\")]\npublic string LoweredUserName { get; set; }\n\n[Required]\n[Editable(false)]\n[StringLength(256)]\n[Display(Name = \"Email\")]\npublic string Email { get; set; }\n\n[Editable(false)]\n[ScaffoldColumn(false)]\n[StringLength(256)]\n[Display(Name = \"Lowered Email\")]\npublic string LoweredEmail { get; set; }\n\n[Editable(false)]\n[StringLength(16)]\n[Display(Name = \"Site Alias\")]\npublic string SiteAlias { get; set; }\n\n[Required]\n[Editable(false)]\n[Display(Name = \"Is Approved\")]\npublic bool IsApproved { get; set; }\n\n[Required]\n[Editable(false)]\n[Display(Name = \"Is Locked Out\")]\npublic bool IsLockedOut { get; set; }\n\n[Editable(false)]\n[Display(Name = \"Join Date\")]\npublic DateTime JoinDate { get; set; }\n\n[Editable(false)]\n[Display(Name = \"Full Name\")]\npublic string FullName\n{\n  get\n  {\n    AccountInfoHelpers help = new AccountInfoHelpers();\n    return help.GetFullName(this.Salutation, this.FirstName, this.LastName);\n  }\n  set {/*no implmentation*/}\n}\n\n[Editable(false)]\n[StringLength(20)]\n[Display(Name = \"Salutation\")]\npublic string Salutation { get; set; }\n\n[Editable(false)]\n[StringLength(50)]\n[Display(Name = \"First Name\")]\npublic string FirstName { get; set; }\n\n[Editable(false)]\n[StringLength(50)]\n[Display(Name = \"Last Name\")]\npublic string LastName { get; set; }\n\n[Editable(false)]\n[Display(Name = \"Last Login Date\")]\npublic DateTime LastLoginDate { get; set; }\n\n[Editable(false)]\n[Display(Name = \"Assigned Roles\")]\npublic virtual ICollection&lt;UserRole&gt; AssignedRoles { get; set; }\n</code></pre>\n\n<p>}\n}</p>\n\n<p>And here is the Linq query I currently have:</p>\n\n<pre><code>using (LambuthEntities context = new LambuthEntities())\n  {\n    var user = (from u in context.aspnet_Users\n                join p in context.aspnet_Membership on u.UserId equals p.UserId\n                join ux in context.Users on u.UserId equals ux.user_id\n                join c in context.Customers on ux.user_id equals c.user_id\n                where (ux.user_id == userId)  //userId passed in as param\n\n                select new UserDetail\n                {\n                  UserId = ux.user_id,\n                  UserName = u.UserName,\n                  SiteAlias = ux.site_alias,\n                  Email = p.Email,\n                  Salutation = c.salutation,\n                  FirstName = c.first_name,\n                  LastName = c.last_name,\n                  LastLoginDate = p.LastLoginDate,\n                  IsApproved = p.IsApproved,\n                  IsLockedOut = p.IsLockedOut\n                }).Single();\n\n    return user;\n  }\n</code></pre>\n\n<p>Am I on the right track here?  Any advice would be appreciated.</p>\n\n<p>Thank You.</p>\n"},{"tags":["wcf","linq","entity-framework","linq-to-entities","ria"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12710701,"title":"LINQPAD Queries not working when running","body":"<p>We are building a wcf ria services application (linq to entity framework)</p>\n\n<p>We used LinqPad to build our linq queries, and they do work inside linqpad, however when running the project they do not work, as if the current user (who is logged in) doesn't exist.</p>\n\n<p>Can anyone help us out?</p>\n\n<pre><code>String userName = WebContext.Current.User.Name;\n\nIEnumerable&lt;aspnet_Users&gt; userList = ctx.aspnet_Users\n              .Where(p =&gt; p.UserName == userName);\nif (userList.Count() &gt; 0)\n{                   \n    aspnet_Users user = userList.First();\n</code></pre>\n"},{"tags":["c#","performance","linq","search","icollection"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":138,"score":3,"question_id":12673830,"title":"For LINQ Performance Gurus- Searching through non-generic ICollection","body":"<p>I need to search through a collection of \"Item\" objects that contain a time property. I have a fast solution in place but its very messy (will post if nothing better comes up). Below are my attempts at performing the search myself using LINQ and whatnot.</p>\n\n<p>In my particular case, I <em>know</em> the items are ordered low to high based on time. When I iterate through them, it's 9/12, 9/13, 9/14. I'd like to find a solution that's fast even if this isn't ordered, but not important right now.</p>\n\n<pre><code>//ICollection c = GetCollection(); //25,000+ items\nDateTime TIME = DateTime.Now.AddDays(-1);\n\nEventLog scan = new EventLog(\"Application\", \"Server\", \"N/A\");\nEventLogCollection c = scan.Entries;\nConsole.WriteLine(logs.Count); // All entries already in list here\n\n// 64 sec - SLOW\nList&lt;Item&gt; l1 = new List&lt;Item&gt;();\nforeach (Item i in c) { \n  if (i.time &gt; TIME) { \n    l1.Add(i); }\n}\n\n// 93 sec - SLOWER\nvar l2 = c.Cast&lt;Item&gt;().AsParallel().Select(n =&gt; n.time &gt; TIME);\nvar i = l2.Count();\n\n// 98 sec - EVEN SLOWER!\nList&lt;Item&gt; l3 = new List&lt;Item&gt;();\nParallel.ForEach(c.Cast&lt;Item&gt;(), n =&gt; {\n    if (n.time &gt; TIME) {\n        l3.add(n);\n    }\n});\n</code></pre>\n\n<p>My current solution is do a BinarySearch for the start and end times and loop through the ICollection based on those indexes. It's very fast (1-2 sec) but very messy. I don't <em>need</em> a different solution but thought I'd toss this out to you performance experts.</p>\n\n<p><strong>Is there a faster, elegant to way to search the ICollection?</strong> BTW I have no control over the collection I'm given and can't change it's structure. .NET 4.0</p>\n\n<p>And no, I can't use System.Diagnostics.Eventing.Reader because I'm stuck with Windows XP</p>\n"},{"tags":["c#","linq","datagrid","observablecollection"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1053,"score":3,"question_id":4689257,"title":"LINQ query to Observable collection","body":"<p>I've got an observable collection that contains multiple DocumentEntry objects that each have a language property. I present this in a DataGrid so that the documents can be updated, but that became too many entries, so I've added a combobox with language names and now I need to present only the documents of that language.</p>\n\n<p>The collection of documents is an ObservableCollection, but when I say</p>\n\n<pre><code>myDataGrid.DataContext = (from d in documents where d.language == selectedLanguage select d);\n</code></pre>\n\n<p>the result of the LINQ query is not an observable collection. Do I filter this the right way at all? How can I best filter an ObservableCollection in my datagrid, in this case by language?</p>\n\n<p>Cheers</p>\n\n<p>Nik</p>\n"},{"tags":[".net","linq","namevaluecollection"],"answer_count":5,"favorite_count":10,"up_vote_count":23,"down_vote_count":0,"view_count":8804,"score":23,"question_id":391023,"title":"Make NameValueCollection accessible to LINQ Query","body":"<p>How to make <code>NameValueCollection</code> accessible to LINQ query operator such as where, join, groupby?</p>\n\n<p>I tried the below:</p>\n\n<pre><code>private NameValueCollection RequestFields()\n{\n    NameValueCollection nvc = new NameValueCollection()\n                                  {\n                                      {\"emailOption: blah Blah\", \"true\"},\n                                      {\"emailOption: blah Blah2\", \"false\"},\n                                      {\"nothing\", \"false\"},\n                                      {\"nothinger\", \"true\"}\n                                  };\n    return nvc;\n\n}\n\npublic void GetSelectedEmail()\n{\n    NameValueCollection nvc = RequestFields();\n    IQueryable queryable = nvc.AsQueryable();\n}\n</code></pre>\n\n<p>But I got an <em>ArgumentException</em> telling me that the <strong>soucre is not IEnumerable&lt;></strong>. </p>\n"},{"tags":["c#","sql","linq","entity-framework","lambda-functions"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":11995228,"title":"How to write an linq statement to get the last of a group of records","body":"<p>I have 2 SQL statements that basically do the same thing, that is, retrieve the last record from a table based on a datetime field for a group of records.  I am using the data-first Entity Framework model.  How would I write either of these SQL statements using LINQ Lambda functions?</p>\n\n<p>ie,</p>\n\n<pre><code>var u = db.AccessCodeUsage.Where(...).GroupBy(...)\n</code></pre>\n\n<p>rather than </p>\n\n<pre><code>var u = from a in db.AccessCodeUsage\n        where ...\n        group by ...\n</code></pre>\n\n<p>SQL Statements:</p>\n\n<pre><code>SELECT  *\nFROM    AccessCodeUsage a  \nWHERE   NOT EXISTS (SELECT  1 \n                    FROM    AccessCodeUsage \n                    WHERE   LocationId = a.LocationId\n                    AND     Timestamp &gt; a.Timestamp)\n\nSELECT    a.*\nFROM    AccessCodeUsage a\nWHERE   a.Timestamp = \n        (SELECT MAX(Timestamp)\n        FROM    AccessCodeUsage\n        WHERE   a.LocationId = LocationId\n        AND     a.AccessCode = AccessCode\n        GROUP   By LocationId, AccessCode)\n</code></pre>\n"},{"tags":["c#","linq","intersection","set-intersection"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":48,"score":0,"question_id":12707763,"title":"Get indexes for intersection","body":"<p>I have a problem. I'm finding an intersection using the code below:</p>\n\n<pre><code>Envelope[][] extents = new Envelope[tilesCountX][tilesCountY];\n\n// some code here to set \"extents\" values\n\nvar intersectedTiles =\n    extents\n    .SelectMany(es =&gt; es)\n    .Where(e =&gt; EnvIntersects(e, bounds))\n    .ToList();\n\nprivate static bool EnvIntersects(Envelope e1, Envelope e2)\n{\n    return e1.MinX &gt;= e2.MinX &amp;&amp; e1.MaxX &lt;= e2.MaxX &amp;&amp; e1.MinY &gt;= e2.MinY &amp;&amp; e1.MaxY &lt;= e2.MaxY;\n}\n</code></pre>\n\n<p>It works but I want to get the indexes of intersected extents.</p>\n\n<p><strong>e.g.</strong><br />\nIf <code>extents[2][7]</code> is an intersected element, I want to get <code>2</code> and <code>7</code>.</p>\n\n<p>Is it possible by modifying my code?</p>\n\n<p><strong>[edit]</strong></p>\n\n<p><code>bounds</code> is an <code>Envelope</code> that has <code>MinX</code>, <code>MinY</code>, <code>MaxX</code> and <code>MaxY</code> properties inside.</p>\n\n<pre><code>Envelope bounds = new Envelope();\nbounds.MinX = some_value_1;\nbounds.MaxX = some_value_2;\nbounds.MinY = some_value_3;\nbounds.MaxY = some_value_4;\n</code></pre>\n"},{"tags":["c#","vb.net","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12707712,"title":"Convert C# linq code to VB. [ Edited ]","body":"<p>I want to port some of my EntityFramework C# code into VB.NET. I'm trying different online code convertor but they can't solve this problem for me.</p>\n\n<p>I have these two functions.</p>\n\n<pre><code>public List&lt;T&gt; Find&lt;T&gt;(Func&lt;T, bool&gt; predicate) where T : class\n    {\n        var objectSet = db.CreateObjectSet&lt;T&gt;();\n        return objectSet.Where&lt;T&gt;(predicate).ToList();\n    }\n\n    public void Delete&lt;T&gt;(Func&lt;T, bool&gt; predicate) where T : class\n    {\n        var objectSet = db.CreateObjectSet&lt;T&gt;();\n        IEnumerable&lt;T&gt; records = from x in objectSet.Where&lt;T&gt;(predicate) select x;\n\n        foreach (T record in records)\n        {\n            objectSet.DeleteObject(record);\n        }\n    }\n</code></pre>\n\n<p>Now convertors tell me this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function Find(Of T As Class)(predicate As Func(Of T, Boolean)) As List(Of T)\n    Dim objectSet = db.CreateObjectSet(Of T)()\n    Return objectSet.Where(Of T)(predicate).ToList()\nEnd Function\n\nPublic Sub Delete(Of T As Class)(predicate As Func(Of T, Boolean))\n    Dim objectSet = db.CreateObjectSet(Of T)()\n    Dim records As IEnumerable(Of T) = From x In objectSet.Where(Of T)(predicate) Select x\n\n    For Each record As T In records\n        objectSet.DeleteObject(record)\n    Next\nEnd Sub\n</code></pre>\n\n<p>But I get two errors, both for <code>objectSet.Where&lt;T&gt;(predicate)</code> which is:</p>\n\n<blockquote>\n  <p>Overload resolution failed because no accessible 'Where' accepts this number of type arguments.</p>\n</blockquote>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":433,"score":2,"question_id":9137655,"title":"outer join linq","body":"<p>I'm new in linq to object and have a question about the <code>from</code> clause whene used in two context:</p>\n\n<p>1) to perform a cross join like the query bellow</p>\n\n<pre><code>  var q1 = from person in people\n      from job in jobs\n      select new {person, job}\n</code></pre>\n\n<p>2) to perfom an outer join</p>\n\n<pre><code>  var q2 = from person in people\n     join pet in pets on person equals pet.Owner into gj\n     from subpet in gj\n     select new { OwnerName = person.FirstName, PetName = subpet.Name };\n</code></pre>\n\n<p>is the second from clause acts as a cross join or it is evaluted depending on the context? because\nq1 will produce people.Count * jobs.Count element\nbut q2 will produce only people.Count</p>\n"},{"tags":["vb.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12624180,"title":"How to debug Linq - Join method never reaches ResultSelector","body":"<p>OK, what I am trying to do is fetch two datasets from their respective databases and join them using a Linq query, formed by the Join extension method. The Linq query did work before, but after some refactoring (in other parts of the code) it does not anymore. I really fail to see the difference.  </p>\n\n<p>I have expanded the KeySelectors and the ResultSelector to be able to put breakpoints in them. The two enumerables (localSeq and remoteSeq) work fine, they got the right number of elements etc. The elements of both sequences are formatted as Object().  The KeySelectors (implemented by the function CompositeJoinKeySelector) also seems to work. What this function is supposed to do is select the right fields from every element, so that the .Join method knows how to check for equality. It seems to be this step (check for equality) that fails.</p>\n\n<p>When I step through the code, the linq query loops through both the datasets and executes the KeySelector. This seems to return the intended values.  Afterwards, however, it does not break in the ResultSelector.  It seems to me that this means it never got to process the result, because he did not find matching \"rows\".  This is quite weird, because I stepped through the execution and both KeySelectors return a two-dimensional Object array and matching entries certainly exist.</p>\n\n<p>Is there any way to see this (presumably) nested loops process and see where the equality comparison fails?</p>\n\n<pre><code>            Dim LocalSeq As IEnumerable(Of Object()) = From locRow As Object() In LocalArray\n        Dim RemoteSeq As IEnumerable(Of Object()) = From remRow As Object() In RemoteArray\n\n        Dim joinSeq As IEnumerable(Of Object()) = LocalSeq.Join(Of Object(), Object, Object())(RemoteSeq, _\n                                                                                               Function(locRow As Object())\n                                                                                                   Dim locRes As Object() = CompositeJoinKeySelector(locRow, LocalKeyList)\n                                                                                                   Return locRes\n                                                                                               End Function, _\n                                                                                               Function(remRow As Object())\n                                                                                                   Dim remRes As Object() = CompositeJoinKeySelector(remRow, RemoteKeyList)\n                                                                                                   Return remRes\n                                                                                               End Function, _\n                                                                                               Function(locRow As Object(), remRow As Object())\n                                                                                                   Dim joinRes As Object() = JoinRowArrays(locRow, remRow, FinalJoinSelectColumnList)\n                                                                                                   Return joinRes\n                                                                                               End Function)\n\n        Return joinSeq.ToArray()\n</code></pre>\n"},{"tags":["linq","linq-to-entities"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12706160,"title":"LINQ to Entities does not recognize the method 'Char get_Chars(Int32)' method, and this method cannot be translated into a store expression","body":"<p>I would like to select only the records that have the field \"1\" from the string <code>eventTriggers</code> (that looks something like this : \"00100010\" )</p>\n\n<p>I've tried and succesfully done so with more than 1 calls .. but i doubt its efficient. Basically I would want something like this ... but apprently LINQ does not support this.<br>\n(<code>LINQ to Entities does not recognize the method 'Char get_Chars(Int32)' method, and this method cannot be translated into a store expression.</code>)</p>\n\n<pre><code>     using (var service = new dB.Business.Service.BaseBusinessService&lt;memo&gt;())\n   {\n      List&lt;memo&gt; result = service.Repository.GetQuery().Where(p =&gt; p.ID == ID &amp;&amp; p.eventTriggers[index] == '1').ToList();\n   }\n</code></pre>\n\n<p>Any hints towards the correct solution ? Thank you ! </p>\n"},{"tags":["c#","sql","linq","split"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12706716,"title":"Split information from a database-column to Text and Numbers","body":"<p>Im retriving data from a database displayed on a dropdownlist. The dropdown display the streetname along with the number of the house. An example from my data is: <strong>\"Streetname 44\"</strong>. Now when the data isretrived and displayed on the dropdown, I want to save the data into another table in the database, but this time i want the <strong>\"Streetname\"</strong> to be on the \"street-column\" and the <strong>\"44\"</strong> stored in the \"number-column\".\nIm using LINQ to store my data and so far I have this:</p>\n\n<pre><code>         using (DB_Entities tt = new DB_Entities())\n        {\n            Address va = new Address();\n            va.Street = ListItemStreet.SelectedItem; // I only want the Strings from the itemlist\n            va.HouseNo = ListItemStreet.SelectedItem; // I only want the number from the itemlist\n\n            tt.ValidateAddress.AddObject(va);\n            tt.SaveChanges();\n\n            if (tt != null)\n            {\n                AddError.Text = \"Saved!\";\n            }\n            else\n            {\n                AddError.Text = \"Error\";\n            }\n    }\n</code></pre>\n\n<p><strong>EDIT:</strong> It's not a textbox but a Itemlist were the street is retrieved</p>\n"},{"tags":["linq","dynamic-linq"],"answer_count":3,"favorite_count":12,"up_vote_count":12,"down_vote_count":0,"view_count":14565,"score":12,"question_id":1465700,"title":"System.LINQ.Dynamic: Select(\" new (...)\") into a List<T> (or any other enumerable collection of <T>)","body":"<p>Say I have a DataTable with four columns, Company (string), Fund (string), State (string), Value(double):</p>\n\n<pre><code>    table1.Rows.Add(\"Company 1\",\"Fund 1\",\"NY\",100));\n    table1.Rows.Add(\"Company 2\",\"Fund 1\",\"CA\",200));\n    table1.Rows.Add(\"Company 3\",\"Fund 1\",\"FL\",300));\n    table1.Rows.Add(\"Company 4\",\"Fund 2\",\"CA\",400));\n    table1.Rows.Add(\"Company 5\",\"Fund 1\",\"NY\",500));\n    table1.Rows.Add(\"Company 6\",\"Fund 2\",\"CA\",600));\n    table1.Rows.Add(\"Company 7\",\"Fund 3\",\"FL\",700));\n</code></pre>\n\n<p>I want to use System.LINQ.Dynamic to build a dynamic query which groups on either Company, Fund, or State, and then selects my group by criteria as the first column, and sum(value):</p>\n\n<pre><code>string groupbyvalue=\"Fund\";\nvar q1= table1.AsEnumerable().AsQueryable\n              .groupby(groupbyvalue,\"it\")\n              .Select(\"new (\"+groupbyvalue+\" as Group, Sum(Value) as TotalValue)\");\n</code></pre>\n\n<p>In the above query, the selected groupbyvalue (Group) will always be a string, and the sum will always be a double, so I want to be able to cast into something like a List, where Result is an object with properties Group (string) and TotalValue (double).</p>\n\n<p>I'm having a lot of trouble with this, can anyone shed some light?</p>\n"},{"tags":[".net","vb.net","linq","provider"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":117,"score":2,"question_id":12194855,"title":"Implementing string comparer in custom Linq Provider in VB","body":"<p>I'm attempting to follow <a href=\"http://blogs.msdn.com/b/mattwar/archive/2008/11/18/linq-links.aspx\" rel=\"nofollow\">this series of articles</a>. I'm between parts 2 and 3 but am having some issues.</p>\n\n<p>I'm writing the code in VB.Net which has thrown a couple of quirks.</p>\n\n<p>Specifically, when visiting the expression tree, string comparisons aren't working as expected.</p>\n\n<p>This method in the QueryProvider (<a href=\"http://blogs.msdn.com/b/mattwar/archive/2007/07/31/linq-building-an-iqueryable-provider-part-ii.aspx\" rel=\"nofollow\">Part 2</a>)</p>\n\n<pre><code>Protected Overrides Function VisitMethodCall(m As MethodCallExpression) As Expression\n    If m.Method.DeclaringType = GetType(Queryable) AndAlso m.Method.Name = \"Where\" Then\n        sb.Append(\"SELECT * FROM (\")\n        Me.Visit(m.Arguments(0))\n        sb.Append(\") AS T WHERE \")\n        Dim lambda As LambdaExpression = DirectCast(StripQuotes(m.Arguments(1)), LambdaExpression)\n        Me.Visit(lambda.Body)\n        Return m\n    End If\n    Throw New NotSupportedException(String.Format(\"The method '{0}' is not supported\", m.Method.Name))\nEnd Function\n</code></pre>\n\n<p>Is throwing a NotImplementedException for String comparisons</p>\n\n<p><code>m.Method.DeclaringType</code> is of type <code>Microsoft.VisualBasic.CompilerServices.Operators</code> and  <code>m.Method.Name</code> is <code>CompareString</code>. It looks like the string equality is handled slightly differently by VB and isn't being picked up in the correct way.</p>\n\n<p>I'm using a <code>Query.Where(function(x) x.Content_Type &lt;&gt; \"\")</code> to test.</p>\n\n<p>Specifically, if I debug the calls to <code>VisitBinary(b As BinaryExpression)</code> (Also <a href=\"http://blogs.msdn.com/b/mattwar/archive/2007/07/31/linq-building-an-iqueryable-provider-part-ii.aspx\" rel=\"nofollow\">Part 2</a>), <code>b</code> is <code>{(CompareString(x.Content_Type, \"\", False) != 0)}</code></p>\n\n<p>This then attempts to visit <code>b.Left</code> (<code>CompareString(x.Content_Type, \"\", False)</code>) which is where we fall through the hole in <code>VisitMethodCall</code>.</p>\n\n<p>If I just expand the If in VisitMethodCall to be</p>\n\n<pre><code>    If (\n            m.Method.DeclaringType = GetType(Queryable) AndAlso\n            m.Method.Name = \"Where\"\n        ) Or (\n            m.Method.DeclaringType = GetType(Microsoft.VisualBasic.CompilerServices.Operators) AndAlso\n            m.Method.Name = \"CompareString\") Then\n</code></pre>\n\n<p>It throws an InvalidCastException on the trying to convert the <code>StripQuotes(m.Arguments(1))</code> to <code>LambdaExpression</code> (says it's a <code>ConstantExpression</code>)</p>\n\n<p>What do I need to do to handle string comparisons correctly from VB?</p>\n"},{"tags":["c#","xml","linq","null-coalescing-operator"],"answer_count":6,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":191,"score":7,"question_id":12689955,"title":"C# ?? null coalescing operator LINQ","body":"<p>I am trying to prevent having NULL values when I parse an XML file to a custom object using LINQ.</p>\n\n<p>I found a great solution for this on <a href=\"http://weblogs.asp.net/scottgu/archive/2007/09/20/the-new-c-null-coalescing-operator-and-using-it-with-linq.aspx\" rel=\"nofollow\">Scott Gu's blog</a>, but for some reason it does not work for integers with me. I think I have used the same syntax but it seems I am missing something. Oh and for some reason it works when the node is not empty.</p>\n\n<p>Below is an extract of my code.</p>\n\n<pre><code>List&lt;GrantAgresso&gt; lsResult = (from g in xml.Element(\"root\").Elements(\"Elementname\")\n        select new GrantAgresso()\n        {\n             Year = (int?)g.Element(\"yearnode\") ?? 0,\n             Subdomain = (string)g.Element(\"domainnode\") ?? \"\"\n        }).ToList();\n</code></pre>\n\n<p>The errormessage is: </p>\n\n<blockquote>\n  <p>Input string was not in a correct format.</p>\n</blockquote>\n\n<p>If anyone has a clue as to what I'm doing wrong, please help :)</p>\n\n<p>Edit: piece of XML (strange names but it's not by choice)</p>\n\n<pre><code>&lt;Agresso&gt;\n  &lt;AgressoQE&gt;\n    &lt;r3dim_value&gt;2012&lt;/r3dim_value&gt;\n    &lt;r0r0r0dim_value&gt;L5&lt;/r0r0r0dim_value&gt;\n    &lt;r7_x0023_province_x0023_69_x0023_V005&gt;0&lt;/r7_x0023_province_x0023_69_x0023_V005&gt;\n    &lt;r7_x0023_postal_code_x0023_68_x0023_V004 /&gt;\n    &lt;r7_x0023_country_x0023_67_x0023_V003&gt;1004&lt;/r7_x0023_country_x0023_67_x0023_V003&gt;\n    &lt;r7_x0023_communitydistrict_x0023_70_x0023_V006&gt;0&lt;/r7_x0023_communitydistrict_x0023_70_x0023_V006&gt;\n  &lt;/AgressoQE&gt;\n&lt;/Agresso&gt;\n</code></pre>\n"},{"tags":["c#","linq","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12700528,"title":"List Grouping - Lambda or Linq","body":"<p>I have a reporting software I have been working with a list of reports. On one of our interfaces it is possible to display multiple time periods. Each report has a timeframe of 1 day and for each time period we grab out a report for each day and add them to a list of reports. This has caused a lot of messy code with working out numbers and I am attempting to refactor this.</p>\n\n<p>I am having issues with a lambda expression or linq query. I would like to group all the reports into a single report. In this single report I would like all the people to be merged with their projects and cases worked on.</p>\n\n<pre><code>class TimeReport : Report // Report handles basic stuff like time generated, start/end //date ect.\n{\n     public  List&lt;ReportPersonRow&gt; results;\n     // more methods below for handling other report details\n}\n\nclass ReportPersonRow\n{\n    public long PersonId {get;set;}\n    public string PersonName {get;set;}\n    public List&lt;ReportProjectRow&gt; Projects {get;set;}\n\n    // more methods below for handling other details\n}\n\nclass ReportProjectRow\n{\n    public long ProjectId{get;set;}\n    public string ProjectName{get;set;}\n    public List&lt;ReportProjectCaseRow&gt; Projects {get;set;}\n\n    // more methods below for handling other details\n}\n\nclass ReportProjectCaseRow\n{\n    public long CaseId{get;set;}\n    public string CaseName{get;set;}\n    public string HoursLogged{get;set;}\n\n    // more methods below for handling other details\n}\n</code></pre>\n\n<p>I Originally started with and various others of even attempting to get anywhere and I'm lost in what direction to go or if I should even be doing it like this.</p>\n\n<pre><code> var flatList = Model.Reports.SelectMany(x =&gt; x.Results).GroupBy(x =&gt; x.PersonId);\n</code></pre>\n\n<p>An example of what the data currently looks like and what I would like to achieve is below.</p>\n\n<p>report<br/>\n-person<br/>\n--project<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n-person<br/>\n--project<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/></p>\n\n<p>report<br/>\n-person<br/>\n--project<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n-person<br/>\n--project<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/></p>\n\n<p>And the end result would be (all previous reports merged into 1)</p>\n\n<p>report<br/>\n-person<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n-person<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n--project<br/>\n---case<br/>\n---case<br/>\n---case<br/>\n---case<br/></p>\n"},{"tags":["c#","linq"],"answer_count":3,"favorite_count":11,"up_vote_count":23,"down_vote_count":0,"view_count":20553,"score":23,"question_id":454601,"title":"How to Count Duplicates in List with LINQ","body":"<p>I have a list of items</p>\n\n<ul>\n<li>John ID</li>\n<li>Matt ID</li>\n<li>John ID</li>\n<li>Scott ID</li>\n<li>Matt ID</li>\n<li>John ID</li>\n<li>Lucas ID</li>\n</ul>\n\n<p>I want to shove them back into a list like so which also means I want to sort by the highest number of duplicates.</p>\n\n<ul>\n<li>John ID 3</li>\n<li>Matt ID 2</li>\n<li>Scott ID 1</li>\n<li>Lucas ID 1</li>\n</ul>\n\n<p>Let me know how I can do this with LINQ and C#.</p>\n\n<p>Thanks All</p>\n\n<p><strong>EDIT 2 Showing Code:</strong></p>\n\n<pre><code>    List&lt;game&gt; inventory = new List&lt;game&gt;();\n    drinkingforDataContext db = new drinkingforDataContext();\n    foreach (string item in tbTitle.Text.Split(' '))\n    {\n\n        List&lt;game&gt; getItems = (from dfg in db.drinkingfor_Games\n                               where dfg.game_Name.Contains(tbTitle.Text)\n                               select new game\n                               {\n                                   gameName = dfg.game_Name,\n                                   gameID = Boomers.Utilities.Guids.Encoder.EncodeURLs(dfg.uid)\n                               }).ToList&lt;game&gt;();\n\n        for (int i = 0; i &lt; getItems.Count(); i++)\n        {\n            inventory.Add(getItems[i]);\n        }\n    }\n\n    var items = (from xx in inventory\n                 group xx by xx into g\n                 let count = g.Count()\n                 orderby count descending\n                 select new\n                    {\n                        Count = count,\n                        gameName = g.Key.gameName,\n                        gameID = g.Key.gameID\n                    });\n\n    lvRelatedGames.DataSource = items;\n    lvRelatedGames.DataBind();\n</code></pre>\n\n<p>This query displays these results:</p>\n\n<ul>\n<li>1 hello world times</li>\n<li>1 hello world times</li>\n<li>1 Hello World.</li>\n<li>1 hello world times</li>\n<li>1 hello world times</li>\n<li>1 hello world times</li>\n<li>1 Hello World.</li>\n<li>1 hello world times</li>\n</ul>\n\n<p>It gives me the count and name, but it doesn't give me the ID of the game....</p>\n\n<p>It should display:</p>\n\n<ul>\n<li>6 hello world times   234234</li>\n<li>2 Hello World.  23432432</li>\n</ul>\n"},{"tags":["c#","mysql","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12388347,"title":"how to use LINQ to SQL with mySQL","body":"<p>How to use LINQ to SQL with mySQL.</p>\n\n<p>I am having one project with C# (version 2010) and Linq to SQl. Database is SQl</p>\n\n<p>Need Solution for,</p>\n\n<p>I need to migrate the project to Linq to mysql and C# version 2010</p>\n\n<p>And also need to migrate existing sql database to mysql database</p>\n\n<p>(I Downloaded DBLinq but dont know how to use it in project)</p>\n"},{"tags":["c#","xml","linq","linq-to-xml"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12689461,"title":"Problems with looping","body":"<p>Hi there I'm trying to parse an XML file into a list of contacts, but having problems:</p>\n\n<pre><code>    public List&lt;ContactModel&gt; GetContacts()\n    {\n\n        var doc = XDocument.Load(HttpContext.Current\n                                            .Server\n                                            .MapPath(@\"..\\App_Data\\Contacts.xml\"));\n\n        var result = from items in doc.Descendants(\"Directory\")\n                     select new ContactModel()\n                                {\n                                    Id = items.Attribute(\"ID\").Value,\n                                    FirstName = items.Attribute(\"FirstName\").Value,\n                                    LastName = items.Attribute(\"LastName\").Value,\n                                    Telephone = items.Attribute(\"Telephone\").Value,\n                                    Email = items.Attribute(\"Email\").Value,\n                                    Room = items.Attribute(\"Room\").Value,\n                                    Building = items.Attribute(\"Building\").Value,\n                                    Location = items.Attribute(\"Location\").Value\n                                };\n\n        List&lt;ContactModel&gt; contactList = new List&lt;ContactModel&gt;();\n        foreach (var item in result)\n        {\n            contactList.Add(item);\n        }\n\n        return contactList;\n    }\n</code></pre>\n\n<p>I get a null exception when it's trying to loop, what am I doing wrong?</p>\n\n<p>This is my XML</p>\n\n<pre><code>&lt;?xml version=\"1.0\" standalone=\"yes\"?&gt;\n&lt;ContactDirectory&gt;\n  &lt;Directory&gt;\n    &lt;ID&gt;1&lt;/ID&gt;\n    &lt;FirstName&gt;Peter&lt;/FirstName&gt;\n    &lt;LastName&gt;Sutt&lt;/LastName&gt;\n    &lt;Telephone&gt;777888&lt;/Telephone&gt;\n    &lt;Email&gt;pett@gmail.com&lt;/Email&gt;\n    &lt;Room&gt;3.44&lt;/Room&gt;\n    &lt;Building&gt;Westside&lt;/Building&gt;\n    &lt;Location&gt;Leeds&lt;/Location&gt;\n  &lt;/Directory&gt;\n  &lt;Directory&gt;\n    &lt;ID&gt;2&lt;/ID&gt;\n    &lt;FirstName&gt;Fred&lt;/FirstName&gt;\n    &lt;LastName&gt;West&lt;/LastName&gt;\n    &lt;Telephone&gt;1234&lt;/Telephone&gt;\n    &lt;Email&gt;fred@west.com&lt;/Email&gt;\n    &lt;Room&gt;1.23&lt;/Room&gt;\n    &lt;Building&gt;Cromwell St&lt;/Building&gt;\n    &lt;Location&gt;Gloster&lt;/Location&gt;\n  &lt;/Directory&gt;\n  &lt;Directory&gt;\n&lt;/ContactDirectory&gt;\n</code></pre>\n"},{"tags":["c#","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12698748,"title":"Linq error when returning a List inside a List","body":"<p>I have a class defined as follows:</p>\n\n<pre><code>public class SearchResult\n{\n    public Customer Customer { get; set; }\n    public Receipt Receipt { get; set; }\n    public IEnumerable&lt;ReceiptDetail&gt; ReceiptDetail { get; set; }\n}\n</code></pre>\n\n<p>In my Linq query i would like to return a single SearchResult record but have problems in returning the List of ReceiptDetail. If i do:</p>\n\n<pre><code> var list=(from cust in dbContext.Customers \n     join rec in dbContext.Receipts on cust.IdCustomer equals rec.IdCustomer\n     join recdet in dbContext.ReceiptDetails on rec.IdReceipt equals recdet.IdReceipt\n     select new SearchResult\n     {\n          Customer=cust,\n          Receipt=rec,\n          ReceiptDetail = (from  r1 in recdet select r1).ToList() // COMPILER ERROR HERE\n     }).ToList();\n</code></pre>\n\n<p>I get the \"Could not find an implementation of the query pattern for source type ReceiptDetail   'Select' not found\".</p>\n\n<p>What am i doing wrong?</p>\n"},{"tags":["c#",".net","linq","generics",".net-3.5"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":11606570,"title":"How to add list created from template to list received as interface property?","body":"<p>I have an interface say <code>public interface IofMine{}</code> and code like this:</p>\n\n<pre><code>interface IItems\n{\n    List&lt;IofMine&gt; MyList;\n}\n\npublic class Items: IItems{\n    private List&lt;IofMine&gt; _myList;\n    public List&lt;IofMine&gt; MyList\n        {\n            get{return _myList;}\n            set{_myList = value;}\n        }\n}\n\npublic class ofMine : IofMine\n{}\n\n...\n</code></pre>\n\n<p>Some where in say main I call this functions add1 and add2 tat look like this:</p>\n\n<pre><code>...\npublic static void add1&lt;T&gt;(Items items) where T : IofMine, new()\n{\n    var temp = items.MyList;\n    var toAdd = new List&lt;T&gt;();\n    temp.AddRange(toAdd); // here it talls me :  Error Argument 1: cannot convert from 'System.Collections.Generic.List&lt;T&gt;' to 'System.Collections.Generic.IEnumerable&lt;IofMine&gt;'\n}\n\npublic static void add2&lt;T&gt;(Items items) where T : IofMine, new()\n{\n    var toAdd = new List&lt;T&gt;();\n    toAdd.AddRange(items.MyList); // here it talls me :  Error Argument 1: cannot convert from 'System.Collections.Generic.List&lt;IofMine&gt;' to 'System.Collections.Generic.IEnumerable&lt;T&gt;'\n}\n</code></pre>\n\n<p>So I wonder how to make list from interface be expandable with list from generic template that my function received and vice versa?</p>\n"},{"tags":["linq","dynamic","casting","dapper"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":12696914,"title":"Why does using Linq's .Select() return IEnumerable<dynamic> even though the type is clearly defined?","body":"<p>I'm using Dapper to return dynamic objects and sometimes mapping them manually.  Everything's working fine, but I was wondering what the laws of casting were and why the following examples hold true.</p>\n\n<p>(for these examples I used 'StringBuilder' as my known type, though it is usually something like 'Product')</p>\n\n<p>Example1: Why does this return an <code>IEnumerable&lt;dynamic&gt;</code> even though 'makeStringBuilder' clearly returns a <code>StringBuilder</code> object?</p>\n\n<p>Example2: Why does this build, but 'Example1' wouldn't if it was <code>IEnumerable&lt;StringBuilder&gt;</code>?</p>\n\n<p>Example3: Same question as Example2?</p>\n\n<pre><code>private void test()\n    {\n        List&lt;dynamic&gt; dynamicObjects = {Some list of dynamic objects};\n\n        IEnumerable&lt;dynamic&gt; example1 = dynamicObjects.Select(s =&gt; makeStringBuilder(s));\n\n        IEnumerable&lt;StringBuilder&gt; example2 = dynamicObjects.Select(s =&gt; (StringBuilder)makeStringBuilder(s));\n\n        IEnumerable&lt;StringBuilder&gt; example3 = dynamicObjects.Select(s =&gt; makeStringBuilder(s)).Cast&lt;StringBuilder&gt;();\n\n    }\n\n    private StringBuilder makeStringBuilder(dynamic s)\n    {\n        return new StringBuilder(s);\n    }\n</code></pre>\n\n<p>With the above examples, is there a recommended way of handling this? and does casting like this hurt performance?  Thanks!</p>\n"},{"tags":["linq","rest","wcf-data-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12695921,"title":"How do I add a simple count to a WCF Data Service","body":"<p>I have a simple WCF Data Service set up. I went with a Linq-to-SQL solution. </p>\n\n<pre><code>public class MyDataService : DataService&lt;SomeDataContext&gt;\n{\n        public static void InitializeService(DataServiceConfiguration config)\n        {\n            config.SetEntitySetAccessRule(\"*\", EntitySetRights.AllRead);\n            config.SetEntitySetPageSize(\"*\", 20);\n            config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;\n        }\n</code></pre>\n\n<p>Since I'm using Linq, I had to do add partial classes for the keys</p>\n\n<pre><code>[DataServiceKey(\"MessageId\")]\npublic partial class Message\n{\n}\n\n[DataServiceKey(\"UserId\")]\npublic partial class User\n{\n}\n</code></pre>\n\n<p>...</p>\n\n<p>So I want to add a primitive method to get special users who have sent a message. Since <a href=\"http://msdn.microsoft.com/en-us/library/ee622463%28v=vs.103%29.aspx\" rel=\"nofollow\">Linq aggregate operators, such as count, are not supported</a>, I figured a decent workaround would be to create a read-only resource endpoint for the count.So I added a method</p>\n\n<pre><code>   [WebGet]\n    public int NumSpecialUsers()\n    {\n        var context = new SomeDataContext();\n        int numUsers =\n            context.Messages\n            .Where(x =&gt; x.special == true &amp;&amp; x.UserId != null)\n            .Select(x =&gt; x.UserId)\n            .Distinct()\n            .Count();\n\n        return numUsers;\n    }\n</code></pre>\n\n<p>and added the necessary configuration to <code>InitializeService()</code></p>\n\n<pre><code>    config.SetServiceOperationAccessRule(\"NumUsers\", ServiceOperationRights.AllRead);\n</code></pre>\n\n<p>I can successfully call the method via localhost:1234/MyDataService.svc/NumSpecialUsers , however there's no discovery for this method in localhost:1234/MyDataService.svc. \nThis doesn't seem right. By not showing up in localhost:1234/MyDataService.svc , that would violate REST, because it would mean an undiscoverable endpoint. Which also means that when you use Visual Studio to create an OData Linq proxy, it doesn't show the method there, either. </p>\n\n<p>I'm neither a REST | OData | WCF Data Services expert, so if anyone has thoughts about this, I'd love to hear them. I am just beginning my adventure into OData and WCF Data Services and I would like to take a good approach to things. Many Thanks.</p>\n"},{"tags":["c#",".net","linq","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12696276,"title":"Are different IQueryable objects combined?","body":"<p>I have a little program that needs to do some calculation on a data range. The range maybe contain about half a millon of records. I just looked to my db and saw that a <code>group by</code> was executed.</p>\n\n<p>I thought that the result was executed on the first line, and later I just worked with data in RAM. But now I think that the query builder combine the expression.</p>\n\n<pre><code>var Test = db.Test.Where(x =&gt; x &gt; Date.Now.AddDays(-7));\nvar Test2 = (from p in Test \n             group p by p.CustomerId into g \n             select new { UniqueCount = g.Count() } ); \n</code></pre>\n\n<p>In my real world app I got more subqueries that is based on the range selected by the first query. I think I just added a big overhead to let the DB make different selects.</p>\n\n<p>Now I bascilly just call <code>.ToList()</code> after the first expression.</p>\n\n<p>So my question is am I right about that the query builder combine different IQueryable when it builds the expression tree?</p>\n"},{"tags":["linq","linq-to-entities","dynamic-linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12692927,"title":"How do I merge objects back together after a SelectMany in System.Linq.Dynamic or maybe different solution all together?","body":"<p>I'm trying to select out a couple of fields in a collection inside of collection. Roles->Users (name and ID)  I was able to get flattened data using select many, but now I need to merge it back to a collection objects so my json is formatted correctly.  I would like to do this in dynamic linq if possible otherwise I will might have to manually merge the objects back together.  Any help would be great.</p>\n\n<p>User->User_Roles->Roles  (many to many relationship with User_Role as the join table)</p>\n\n<pre><code>q = query.SelectMany(\"USER_ROLES\",\"new (inner as myUSER,outer as myROLE) \").SelectD(\"new (myROLE.ID as ROLE_ID, new( myROLE.NAME, myUSER.USER.FIRSTNAME,myUSER.USER.ID)as user)\")\n</code></pre>\n\n<p>The results look like this:</p>\n\n<pre><code> Role A-&gt; User A\n Role A-&gt; User B    ..notice the repeat of \"Role A\" \n Role A-&gt; User C\n</code></pre>\n\n<p>it should be </p>\n\n<pre><code>     Role A -&gt; User A\n             + User B\n             + User C\n</code></pre>\n"},{"tags":["c#","arrays","linq","lambda"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12696096,"title":"Multi-delimited string to list of objects using linq and lambdas","body":"<h2>Overview</h2>\n\n<p>I have a string delimited by commas, representing objects, and spaces, representing properties of those objects: </p>\n\n<pre><code>string sOrderBy = \"Column1 ASC, Column2 DESC\";\n</code></pre>\n\n<p>I need to convert it to a <code>List&lt;OrderByColumn&gt;</code> where <code>OrderByColumn</code> is:</p>\n\n<pre><code>public class OrderByColumn\n{\n    public string ColumnName { get; set; }\n    public bool IsAscending { get; set; }\n}\n</code></pre>\n\n<h2>Problem</h2>\n\n<pre><code>sOrderBy.Split(',').Select(x =&gt; new OrderByColumn()\n{\n    ColumnName = x.Trim().Split(' ')[0].Trim(),\n    IsAscending = x.Trim().Split(' ')[1].Trim() == \"ASC\" ? true : false\n}).ToList&lt;OrderByColumn&gt;();\n</code></pre>\n\n<p>The above code works, but there's some redundancy in calling <code>x.Trim().Split(' ')</code> more than once. (Also, I'm aware the code currently assumes that the 0 &amp; 1 array values are there).</p>\n\n<p>Is there a way to remove this redundancy? Somehow pass the result of <code>x.Trim().Split(' ')</code> to an anonymous function and then return an <code>OrderByColumn</code> object from there? </p>\n\n<p>I know I could solve this issue using two for/foreach loops, but linq and lambdas are so cool! :-) </p>\n"},{"tags":["asp.net","database","vb.net","linq","dynamic-queries"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12693701,"title":"Search for multiple keywords using LINQ vb","body":"<p>I have some existing code that I need to modify to search more than one keyword. (I am new to all this by the way)</p>\n\n<pre><code>Dim topics As IQueryable(Of Global.Platform.Core.Data.Topic) = _\n               From t In _db.Topics\n               Where t.IsActive = True And t.TopicTitle.Contains(criteria) And t.ForumID = 0 And Not t.TopicTitle.Contains(\"default\") And t.Member.IsActive = True And t.IsActive = True\n               Order By t.DateCreated Descending\n               Select t\n               Take (take_x)\nReturn topics\n</code></pre>\n\n<p>How would i go about changing this so if I entered criteria \"cat hair\" it would do an OR search. so <code>...t.TopicTitle.Contains(\"cat\") OR t.TopicTitle.Contains(\"hair\") ...</code>.\nOf course it would need to be dynamic.</p>\n\n<p>I tried this but could not get it to work.</p>\n\n<pre><code>Dim criteriaArr As Array = criteria.Split(\" \")\n            Dim new_criteria As String = \" t.TopicTitle.Contains(\" + criteriaArr(0) + \")\"\n            If criteriaArr.Length &gt; 1 Then\n                For Each item As String In criteriaArr\n                    new_criteria += \" Or t.TopicTitle.Contains(\" + item + \")\"\n                Next\n            End If\n</code></pre>\n\n<p>The idea was to split the spaces and keep appending to the where clause. I know in SQL this might have worked, but how would I go about in this scenario?</p>\n"},{"tags":["c#","asp.net","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12685565,"title":"Linq to SQL get updated record in transaction","body":"<p>I am new to Linq to Sql. I got a scenario. I have two tables. MasterTable and DetailTable table. What I am trying to do is :</p>\n\n<p>Inserting new rows in the DetailTable and on base of DetailTable rows I am trying to Update Master in One transaction.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>DBContext context = new DBContext();\ncontext.Connection.Open();\ncontext.Transaction = context.Connection.BeginTransaction();\n\nDetailTable detail = new DetailTable();\n\ndetail.Amount = 100;\n\nvar detailTable = context.GetTable&lt;DetailTable&gt;();\n                // pass in the object with insert on submit\n                // and then submit changes\ndetailTable.InsertOnSubmit(detail);\n\nvar result = (from Total in context.MasterTable\nselect Total).Sum();\n\ndecimal total = (decimal)result; // This total is not the latest.\n\n// UpdateMaster.....\n// ................\n\ncontext.SubmitChanges();\ncontext.Transaction.Commit();\n</code></pre>\n\n<p>Now the problem, I am facing is that I am not getting the latest Sum from MasterTable. Like after inserting new row of amount 100, say I should get 600 but I am getting 500 (Sum rows as if I have not inserted new row). \nPlease let me know if this is possible using Linq to Sql if it is then how or I am trying to achieve something which is not possible.</p>\n"},{"tags":["c#","linq","ssis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12685661,"title":"Performing LINQ on full collection of rows in SSIS?","body":"<p>Well, as the title says. I'd like to use a script component destination, and then utilize LINQ to select which rows to process for output.</p>\n\n<p>For a bit more background, I have this ugly merged thing with a one-to-many relationship. The rows look sort of like:</p>\n\n<pre><code>[ID] [Title]   [OneToManyDataID]\n1    Item one   2\n1    Item one   4\n1    Item one   3\n3    Item two   1\n3    Item two   5\n</code></pre>\n\n<p>We'll call the objects [Item], which has the ID and Title columns and [OneToMany]</p>\n\n<p>I was hoping I could throw the entire thing to a script component destination, and then use LINQ to do something like group by the item and only take the data from the highest OneToMany object. Sort of like:</p>\n\n<pre><code>foreach(var item  in Data.GroupBy(d=&gt;d.Item).Select(d=&gt; new {Item = d.Key})){\n     //Then pick out the highest OneToMany ID for that row to use with it.\n}\n</code></pre>\n\n<p>I realize there are probably better LINQ queries to accomplish this, but the point is, the script component in SSIS seems to only allow working with it on a per-row basis, with the predefined ProcessInputRow-method. Where I'd like to determine exactly which rows are processed and what properties are passed to that method.</p>\n\n<p>How would I go about doing this?</p>\n"},{"tags":["c#","linq","entity-framework","dynamic-linq"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":65,"score":0,"question_id":12694444,"title":"Dynamic LINQ nested selects","body":"<p>I'm trying to come up with a Dynamic LINQ query that will let me select properties from nested  entity collections. I want to get a list of roles with some associated user information for each role. I will, of course, actually be returning role information, but I left that out of this example because it is trivial.</p>\n\n<p>This LINQ query gives me the information I need:</p>\n\n<pre><code>ROLES.Select(r =&gt; new { ID = r.ID, USER_ROLES = r.USER_ROLES.Select(ur =&gt; new { ID = ur.ID, USER = new { ID = ur.USER.ID, USERNAME = ur.USER.USERNAME } } ) })\n</code></pre>\n\n<p>The results will be serialized to JSON and should contain:</p>\n\n<pre><code>[\n  {ID: 1, USER_ROLES: [\n    {ID: 100, USER: {ID: 3, USERNAME: 'code0100fun'} }\n  ] },\n  {ID: 2, USER_ROLES: [\n    {ID: 100, USER: {ID: 3, USERNAME: 'code0100fun'} },\n    {ID: 101, USER: {ID: 4, USERNAME: 'somedude'   } }\n  ] }\n]\n</code></pre>\n\n<p>What would the Dynamic LINQ (System.Linq.Dynamic) query for this look like?</p>\n"},{"tags":["c#","linq","codesmith","plinqo"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12692897,"title":"how to filter linq expression for use with CodeSmith bulk update","body":"<p>I'm using CodeSmith Plinqo's bulk update functionality with the following wrapper code:</p>\n\n<pre><code>public int Update&lt;TEntity&gt;(Expression&lt;Func&lt;TEntity, bool&gt;&gt; filter, \n    Expression&lt;Func&lt;TEntity, TEntity&gt;&gt; evaluator) where TEntity : class\n{\n    var tbl = _dataContext.GetTable&lt;TEntity&gt;();\n    return tbl.Update(filter, evaluator);\n}\n</code></pre>\n\n<p>Example Usage:</p>\n\n<pre><code>DCCore.Update&lt;Code&gt;(filter =&gt; _results.UpdatedCodes.Select(\n    x =&gt; x.CodeID).Contains(filter.CodeID),\n    u =&gt; new Code {\n        CodeStatusID = EpcEvent.CodeStatusID.Value\n    });\n</code></pre>\n\n<p>This works great except when the \"filter\" contains more than 2100 elements, then we get the sql server error: \"The incoming tabular data stream (TDS) remote procedure call (RPC) protocol stream is incorrect. Too many parameters were provided in this RPC request. The maximum is 2100.\"</p>\n\n<p>What I'd like to do is enhance my Update wrapper so that it breaks the \"filter\" expression into 2000 item chunks.  Something like this pseudo code:</p>\n\n<pre><code>public int Update&lt;TEntity&gt;(Expression&lt;Func&lt;TEntity, bool&gt;&gt; filter, \n    Expression&lt;Func&lt;TEntity, TEntity&gt;&gt; evaluator) where TEntity : class\n{\n    var tbl = _dataContext.GetTable&lt;TEntity&gt;();\n    var index = 0;\n    const int chunk = 2000;\n    var filterCount = filter.Count();\n    while (index * chunk &lt; filterCount)\n    {\n        var smallFilter = filter.Skip(index*chunk).Take(chunk);\n        tbl.Update(smallFilter, evaluator);\n        index++;\n    }\n    return filterCount;\n}\n</code></pre>\n"},{"tags":["c#","asp.net","asp.net-mvc","linq","linq-to-sql"],"answer_count":6,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":1435,"score":5,"question_id":1309235,"title":"ASP.NET MVC + LINQ exception","body":"<p>I've got a ASP.NET MVC application that works great for 99.9% of the time. Once in a blue moon though things go really wrong and I was wondering if anybody could shed some light on what might go wrong here. </p>\n\n<p>The web application is using Linq2SQL and blows up in a controller after the following set of instructions:</p>\n\n<pre><code>const int pageSize = 5;\nvar allHeadings = artRepository.FindAllVisibleHeadings();\nvar paginatedHeadings = new PaginatedList&lt;Article&gt;(allHeadings, id ?? 0, pageSize);\n</code></pre>\n\n<p>allHeadings contains just an IQueryable list of all visible headings for articles, whereas PaginatedList takes care of taking an appropriate chunk out of this very long list. It's as follows:</p>\n\n<pre><code>public PaginatedList(IQueryable&lt;T&gt; source, int pageIndex, int pageSize)\n{\n    PageIndex = pageIndex;\n    PageSize = pageSize;\n    TotalCount = source.Count();\n    TotalPages = (int)Math.Ceiling(TotalCount / (double)PageSize);\n\n    this.AddRange(source.Skip(PageIndex * PageSize).Take(PageSize));\n}\n</code></pre>\n\n<p>It blows up on the <strong>source.Count()</strong> line so when it's counting all the visible articles in the db. Funny thing though is that when I reload the page multiple times I'm getting 2 different kinds of exceptions:</p>\n\n<p>THE FIRST: Sequence contains more than one element</p>\n\n<pre><code>at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)\nat System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)\nat System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)\nat System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute[S](Expression expression)\nat System.Linq.Queryable.Count[TSource](IQueryable`1 source)\nat KoscierzynaInfo.Helpers.PaginatedList`1..ctor(IQueryable`1 source, Int32 pageIndex, Int32 pageSize) in C:\\Users\\mr\\Documents\\Visual Studio 2008\\Projects\\KoscierzynaInfo\\KoscierzynaInfo\\Helpers\\PaginatedList.cs:line 20\nat KoscierzynaInfo.Controllers.HomeController.Index(Nullable`1 id) in C:\\Users\\mr\\Documents\\Visual Studio 2008\\Projects\\KoscierzynaInfo\\KoscierzynaInfo\\Controllers\\HomeController.cs:line 63\nat lambda_method(ExecutionScope , ControllerBase , Object[] )\nat System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)\nat System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)\nat System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\nat System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClassa.&lt;InvokeActionMethodWithFilters&gt;b__7()\nat System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)\nat System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClassa.&lt;&gt;c__DisplayClassc.&lt;InvokeActionMethodWithFilters&gt;b__9()\nat System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\nat System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)\nat System.Web.Mvc.Controller.ExecuteCore()\nat System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext)\nat System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext)\nat System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext)\nat System.Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext)\nat System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext)\nat System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()\nat System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously)\n</code></pre>\n\n<p>AND THE SECOND TYPE: Index was outside of the bounds of the array</p>\n\n<pre><code>at System.Data.SqlClient.SqlDataReader.ReadColumnHeader(Int32 i)\nat System.Data.SqlClient.SqlDataReader.IsDBNull(Int32 i)\nat Read_Article(ObjectMaterializer`1 )\nat System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReader`2.MoveNext()\nat System.Collections.Generic.List`1.InsertRange(Int32 index, IEnumerable`1 collection)\nat KoscierzynaInfo.Helpers.PaginatedList`1..ctor(IQueryable`1 source, Int32 pageIndex, Int32 pageSize) in C:\\Users\\mr\\Documents\\Visual Studio 2008\\Projects\\KoscierzynaInfo\\KoscierzynaInfo\\Helpers\\PaginatedList.cs:line 20\nat KoscierzynaInfo.Controllers.HomeController.Index(Nullable`1 id) in C:\\Users\\mr\\Documents\\Visual Studio 2008\\Projects\\KoscierzynaInfo\\KoscierzynaInfo\\Controllers\\HomeController.cs:line 63\nat lambda_method(ExecutionScope , ControllerBase , Object[] )\nat System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)\nat System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)\nat System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\nat System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClassa.&lt;InvokeActionMethodWithFilters&gt;b__7()\nat System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)\nat System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClassa.&lt;&gt;c__DisplayClassc.&lt;InvokeActionMethodWithFilters&gt;b__9()\nat System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\nat System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)\nat System.Web.Mvc.Controller.ExecuteCore()\nat System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext)\nat System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext)\nat System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext)\nat System.Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext)\nat System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext)\nat System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()\nat System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously)\n</code></pre>\n\n<p>The only way I came up with to fix this problem was restarting IIS or recycling the pool. Did this issue happen to any of you before? Where does it come from?! And is there any remedy for that? </p>\n\n<p>I moved the application from IIS7 + SQL Server 2005 to another server with IIS6 + SQLServer 2008 hoping that it would solve the problem, but unfortunately it happened again today, which leads me to believe that this issue is not really system/db dependent.</p>\n"},{"tags":["sql","linq","entity-framework","entity-framework-4"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":12692640,"title":"Getting SQL string from LINQ to EF query","body":"<p>What is the most efficient way to get the sql query from EF? I need this so I can run the query analysis and find its execution plan.</p>\n\n<p>I know I can hook profiler to SQL server, but this step is a pain and a tremendous hit on productivity, almost enough to give up ORM altogether.</p>\n\n<p>Is there a better, more efficient way to optimize EF queries? </p>\n"},{"tags":["linq","search","entity-framework-4"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":37,"score":2,"question_id":12691512,"title":"Prioritizing fields when matching multiple fields with linq","body":"<p>I have a database with fields like firstname lastname street and searchfield. Anything that match the search field will be in my search subset here is the linq logic : </p>\n\n<pre><code>if (!String.IsNullOrEmpty(searchString))\n{\n  folders = folders.Where(p =&gt; p.SearchField.ToLower().Contains(searchString.ToLower()));\n}\n</code></pre>\n\n<p>I can order it by name or firstname or whatever. </p>\n\n<p>Now I would like to present the results so it prioritize the name field in relation to my search term. </p>\n\n<p>For example if i look for Schmid i want to show first the people with the LastName that match Schmid then the firstname then the street ...etc</p>\n\n<p>Any idea ?</p>\n"},{"tags":["c#","arrays","linq","collections"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12691848,"title":"using LINQ to extract sections out of a string array into a new collection","body":"<p>I have a string array in this format (each line is a slot in the array):</p>\n\n<p>IT1<br>\nPID<br>\nRef<br>\nRef<br>\nREF<br>\nIT1<br>\nPID<br>\nREF<br>\nIT1<br>\nPID<br>\nRef<br>\nREF<br>\n...  </p>\n\n<p>I want to extract each IT1 through the last REF into a new array using LINQ. The new result would be an <code>IEnumerable&lt;IEnumerable&lt;string&gt;&gt;</code>. </p>\n\n<p>Using the above string slot array example, the new IEnumerable collection should have 3 <code>IEnumerable&lt;string&gt;</code> in it.</p>\n\n<p>For example:</p>\n\n<p>class 1<br>\nIT1<br>\nPID<br>\nRef<br>\nRef<br>\nREF<br>\nend class 1  </p>\n\n<p>class 2<br>\nIT1<br>\nPID<br>\nREF<br>\nend class 2  </p>\n\n<p>class 3<br>\nIT1<br>\nPID<br>\nRef<br>\nREF<br>\nend class 3<br>\n...  </p>\n\n<p>Notice some sections of the array have 1 REF, some 2 REF and some 3 REF.</p>\n\n<p>How can I use LINQ to extract each section from IT1 through the last REF into a new collection of <code>IEnumerable&lt;IEnumerable&lt;string&gt;&gt;</code>?</p>\n\n<p>Psudo code...</p>\n\n<pre><code>var result = arrayData.Select(s =&gt; s.StartsWith(\"IT1\")\n.GroupBy(...)\n.Select(result =&gt; new {IT1 through last ref goes here})\n.ToArray();\n</code></pre>\n\n<p>Thanks all for the help!</p>\n"},{"tags":["linq","entity-framework","entity-framework-4","linq-to-entities","dynamic-linq"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12642187,"title":"System.Linq.Dynamic to select a collection inside of a collection from Entity Framework IQueryable","body":"<p>I have an EF model with the relationship User->Roles. It's a one to many relationship in our database. I would like to select the ID from role's record and the name from the user's records.\nWhat I have come up with works for one-to-one relationships. I'm not sure how to generate the a list inside of dynamic linq.  Maybe a <code>SelectMany</code>?</p>\n\n<p>User table: Users</p>\n\n<p>Join Table: User_Role</p>\n\n<p>Role Table: Roles</p>\n\n<pre><code> //does not select inside a collection of USER_ROLES\n q= query.Select(\" new ( ID, (new (USER_ROLES.ID as ID) as USER)\")\n\n //not valid\n //q = query.Select(\" new ( ID, (new List&lt;Object&gt; (USER_ROLES.ID as ID) as USER)\")   something I figure this would give me a list of User_Role's ID\n\n //not valid\n //q = query.Select(\" new ( ID, (new List&lt;Object&gt; (USER_ROLES.ROLE.ID as ID) as USER)\")       something I figure this would give me a list of Role's ID\n</code></pre>\n\n<hr>\n\n<p>Update I'm getting closer.  I used a selectmany, but the results are duplicated</p>\n\n<pre><code>q = query.SelectMany(\"USER_ROLES\",\"new (inner as myUSER,outer as myROLE) \").SelectD(\"new (myROLE.ID as ROLE_ID, new( myROLE.NAME, myUSER.USER.FIRSTNAME,myUSER.USER.ID)as user)\")\n</code></pre>\n\n<p>The results look like this:</p>\n\n<pre><code> Role-&gt;User_Role A-&gt; User A\n       User_Role A-&gt; User B    ..notice the repeat of \"User_Role A\" \n       User_Role A-&gt; User C\n</code></pre>\n\n<p>it should be </p>\n\n<pre><code>     Role-&gt;User Role a -&gt; User A\n                         + User B\n                         + User C\n</code></pre>\n"},{"tags":["linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12691746,"title":"linq need to get count of columns that have values","body":"<p>I have the following sample columns</p>\n\n<pre><code>ID  Comment    Analyzer  Incubator    Deanalyzer\n--  -------    -------   ---------    ----------\n23  Need Fast  5.6                    8.7\n</code></pre>\n\n<p>What I need is to show the results is the ID, Comments, then a count of \nhow many columns had values. So in this case count would be 2 as only Analyzer and Deanalyzer have values. This is what I have so far:</p>\n\n<pre><code>    var result = from tb in db.Reports\n    where tb.Id == 23\n    select new { ID = tb.ID, \n                 Comments = tb.Comments,\n                 Count = .. \n\n                } \n</code></pre>\n"},{"tags":["c#","asp.net","linq","collections","dictionary"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12691694,"title":"what is a better choice to hold a range when being queried by linq","body":"<p>I need to save a set of ranges of integers so then I can query them using linq like below :</p>\n\n<pre><code>int param = 10;\nvar matched = from item in items \n           where param &gt;= item.min &amp;&amp; param &lt;= item.max;\n</code></pre>\n\n<p>a <code>list of Tuples</code> or a <code>Dictionary</code> or <code>list of KeyValuePairs</code> or ... . which one is a better choice ? ( I don't want to create a custom class of mine ).</p>\n"},{"tags":["asp.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12687889,"title":"Comparing data from 2 tables and display the result on a dropdownlist using LINQ","body":"<p>I have the 2 following tables: <strong>Country</strong> and <strong>Postal</strong>\nI retrive all the countries in a DropDownAddCountry and i wan't by doing that to display all the postals belonging to the country in another dropdown (DropDownAddPostals).\nThe country table have a coulmn <strong>CountryID</strong> and postal also have a coulm <strong>CountryID</strong>. So i wan't the result to be based on match between CountryID and CountryID (from both tables):</p>\n\n<p>My code look like this now (and it's not correct):</p>\n\n<pre><code>using (DB_Entities tt = new DB_Entities())\n{\n    var sql = from q1 in tt.Country\n    join q2 in tt.Postal on q1.CountryID equals q2.CountryID\n    select new { q2.Postal1 };\n    if(sql != null)\n    {\n        DropDownAddPostal= sql.Postal1;\n    }\n}\n</code></pre>\n\n<p>Cheers</p>\n"},{"tags":["sql","vb.net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":48,"score":-2,"question_id":12379414,"title":"having count linq in VB","body":"<p>I have a SQL query which returns repeating fields to keep track of operations.</p>\n\n<pre><code>SELECT contratosfianzas.adquisicion_contrato, count(*) as no_ope \nFrom contratosfianzas \nGROUP BY contratosfianzas.adquisicion_contrato \nHAVING count(*) &gt; 1\n</code></pre>\n\n<p>I tried with the examples shown here but I always return 1.</p>\n\n<p>Could you please help me.</p>\n\n<p>In advance thank you very much</p>\n"},{"tags":["c#","linq","left-join","group"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12675758,"title":"C# linq group the result","body":"<p>I have some problems and dont know what to do, can someone helps me pleassee?\nI have a tables like that:</p>\n\n<pre><code>ID   Name   Produkt    Comment   aa    bb\n1    Mike   AA         YY        x\n1    Mike   AA         YY              x\n</code></pre>\n\n<p>I want to group with linq the result like to have Mike but just in one line</p>\n\n<pre><code>1   Mike   AA          YY        x     x\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>var results = from t1 in table.AsEnumerable()\n                      join tb2 in table2.AsEnumerable()\n                      on t1.Field&lt;string&gt;(\"Name\") equals tb2.Field&lt;string&gt;(\"Name\") into prodGroup\n                      from table4 in prodGroup.DefaultIfEmpty()\n\n                      select new\n                      {\n                          ID = t1.Field&lt;Int32?&gt;(\"ID\"),\n                          Name = t1.Field&lt;String&gt;(\"Name\"),\n                          Produkt = t1.Field&lt;String&gt;(\"Produkt\"),\n                          Attribute = t1.Field&lt;String&gt;(\"Attribute\"),\n                          Comment = table4 != null ? table4.Field&lt;String&gt;(\"Comment\") : null,\n\n                      };\nforeach (var r in results)\n        {\n            var productIndex = result.Columns.IndexOf(r.Attribute);\n            var vals = new List&lt;object&gt;() { r.ID, r.Name, r.Produkt, r.Comment };\n            for (int i = 4; i &lt; result.Columns.Count; i++)\n            {\n                if (i == productIndex)\n                {\n                    vals.Add(true);\n\n                }\n                else\n                {\n                    vals.Add(false);\n                }\n            }\n            result.LoadDataRow(vals.ToArray(), true);\n        }\n</code></pre>\n\n<p>Thank you guys for your help.</p>\n"}]}
