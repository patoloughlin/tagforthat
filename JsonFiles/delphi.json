{"count":17540,"tag":"delphi","questions":[{"tags":["delphi","delphi-xe","chm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13279485,"title":"Delphi HtmlHelpAPI- How to direct a CHM file to open to different sections","body":"<p>I am able to open a CHM file by passing a ShortInteger and casting it as a Word for the dwData parameter.  </p>\n\n<pre><code>function HtmlHelpW(hwndCaller : HWND; pszFile: PWideChar; uCommand : Integer;\n         dwData : DWORD) : HWND; stdcall; external 'hhctrl.ocx' name 'HtmlHelpW';\n</code></pre>\n\n<p>As I pass different ShortIntegers I am able to initialize the help file at different sections.\nHowever I can't figure out how the values are mapped.  There are some sections in the chm file that I want to be able to map to but the short Integer associated with them is not documented in the program or is not mapped.</p>\n"},{"tags":["delphi","registry","data-type-conversion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13280536,"title":"Why is RegSetValueEx only adding half a string?","body":"<p>Note: I am using Delphi XE2</p>\n\n<p>I am trying to add a registry key. Here is my current code:</p>\n\n<pre><code>function AddRegKey(Key:HKEY;Keyname,Value:String):Boolean;\nvar\n  phkResult:HKEY;\nbegin\n  if RegOpenKeyEx(Key, PWideChar('SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run'), 0, KEY_SET_VALUE, phkResult) = ERROR_SUCCESS then\n    begin\n      Result := (RegSetValueEx(phkResult, PWideChar(KeyName), 0, REG_SZ, PWideChar(Value), Length(Value)) = ERROR_SUCCESS);\n      RegCloseKey(phkResult);\n    end\n  else Result:=False;\nend;\n\nbegin\n    If AddRegKey(HKEY_CURRENT_USER,'TestTest','123456789') Then\n        MessageBox(0,'Success','Test',0);\nend.\n</code></pre>\n\n<p>Which is resulting in the following:</p>\n\n<p><img src=\"http://i.stack.imgur.com/sItGq.png\" alt=\"enter image description here\"></p>\n\n<p>It is only adding the first four characters</p>\n\n<p>But when I change the \"Value\" parameter to:</p>\n\n<pre><code>123456789123456789\n</code></pre>\n\n<p>It then adds:</p>\n\n<pre><code>123456789\n</code></pre>\n\n<p>So it seems as if it is only adding half of the given value for some reason. How do I go about solving this?</p>\n\n<p>Am I passing the wrong data type for the *lpData parameter in RegSetValueEx?</p>\n"},{"tags":["delphi","typedef","address","variadic-functions"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1533,"score":2,"question_id":2149901,"title":"Call variadic C function by its memory address in Delphi","body":"<p>I have a function in C++ that I call with its memory address using <code>typedef</code>, and I want to do the same thing in Delphi.</p>\n\n<pre><code>typedef void (*function_t)(char *format, ...);\n\nfunction_t Function;\n\nFunction = (function_t)0x00477123;\n</code></pre>\n\n<p>And then, I call it with: <code>Function(\"string\", etc);</code></p>\n\n<p>I tried to do this in Delphi, but got no results.</p>\n\n<p>Is there any way to do this without using \"asm\" in Delphi?</p>\n\n<p>If so, please give me an example code.</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","delphi-5","fastreport"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13280284,"title":"EOF Error Delphi fast report 4","body":"<p>Help!!!\nWhen I'm calling a pre created report that is a simple ADOQuery from Delphi and in the pre -created report I don't set the number of rows in the master data band I get an EOF error (EOF OR BOF is true or current record has been deleted). And then the report loads just fine. However if i set the number of for less than or equal to the row count of the master data then I don't get that error. Is it required to know the number of master records when firing an ado query in a report called from delphi? here is the code i am using to call the report:</p>\n\n<pre><code>...\n\nvar Connection1 : tfrxAdoDatabase; //connection variable\n    Query1 : tfrxADOQuery;\n ...\n\n\n\nwith tfrxReport.create(self) do\n  try\n      //Load Report\n      LoadFromFile(ReportName);\n      //load connection properties\n      Connection1 := FindObject('Connection1') as tfrxAdoDatabase;\n      //define connection username and password\n      Connection1.setlogin('sysdba','BLAHBLAH');\n      // prepare and show report\n      if Preparereport then\n      ShowPreparedReport;\n    finally\n      end;\n</code></pre>\n\n<p>I'm brand new using fast reports(this week is the first time i've used it. Im really struggling so any help would be greatly appreciated)</p>\n"},{"tags":["delphi","assembly","shellcode"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":99,"score":3,"question_id":13275948,"title":"ASM to Shellcode - 1 Line - Usage in Delphi","body":"<p>I want to be able to convert a single line of ASM into shellcode. I.E:</p>\n\n<pre><code>CALL EBX\n</code></pre>\n\n<p>How do I go about doing this, and also being able to properly convert this shellcode so that I can store it in a variable in a delphi application. I.E:</p>\n\n<pre><code>var ShellCodeArray:  array[0..3] of Byte = ($55,$8B,$EC,$81);\n</code></pre>\n"},{"tags":["delphi","authentication","delphi-xe2","indy","indy10"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13268594,"title":"TidCookieManager & Redirects","body":"<p>I get cookie from InternetGetCookieEx on DownloadComplete WebBrwoser. When trying to login to hotmail it get's through but then get's redirected. Even though Gmail works.\nI am trying to figure out a universal solution to transfer Authenication from WebBrowser to IdCookieManager for Web Parsing.</p>\n\n<p><strong>Cookies aswell as redirects are enabled on IdHTPP.</strong></p>\n\n<blockquote>\n  <p>Cookies must be allowed Your browser is currently set to block\n  cookies. Your browser must allow cookies before you can use Windows\n  Live ID.</p>\n</blockquote>\n\n<pre><code>    function GetCookie(host: string): string;\n    const\n      INTERNET_COOKIE_HTTPONLY = 8192;\n    var\n      hModule: THandle;\n      lp: Pointer;\n      InternetGetCookieEx: function(lpszUrl, lpszCookieName, lpszCookieData\n        : PAnsiChar; var lpdwSize: DWORD; dwFlags: DWORD; lpReserved: pointer)\n        : BOOL; stdCall;\n      CookieSize: DWORD;\n      CookieData: PAnsiChar;\n    begin\n      LoadLibrary('wininet.dll');\n      hModule := GetModuleHandle('wininet.dll');\n      if hModule &lt;&gt; 0 then\n      begin\n        @InternetGetCookieEx := GetProcAddress(hModule, 'InternetGetCookieExA');\n        if @InternetGetCookieEx &lt;&gt; nil then\n        begin\n          CookieSize := 1024;\n          Cookiedata := AllocMem(CookieSize);\n          if InternetGetCookieEx(PAnsiChar(AnsiString(host)), nil, Cookiedata, CookieSize, INTERNET_COOKIE_HTTPONLY, nil) then\n          result:=cookiedata;\n          FreeMem(Cookiedata);\n        end;\n      end;\n    end;\n\nprocedure EmbeddedWB1DocumentComplete(ASender: TObject; const pDisp: IDispatch;\n  var URL: OleVariant);\nvar\n  document: IHTMLDocument2;\n  cookies: TStringList;\n  uri: TIdURI;\nbegin\n  document := EmbeddedWB1.Document as IHTMLDocument2;\n  cookies := TStringList.Create;\n  try \n    cookies.Delimiter:=';';\n    //cookies.DelimitedText:=GetCookie(document.url);\n    cookies.DelimitedText:=document.cookie;\n    uri := TIdURI.Create(document.url);\n    try\n      IdCookieManager1.AddServerCookies(cookies,uri);\n      EmbeddedWB1.LoadFromString(http.Get(document.url));\n    finally\n      uri.Free;\n    end;\n  finally\n    cookies.Free;\n  end;\n</code></pre>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":153,"score":0,"question_id":13270081,"title":"How to create a function which accepts variable number of variable arguments?","body":"<p>It is possible to create a function which accepts variable number of arguments:</p>\n\n<pre><code>function f(const x: array of const): String;\n</code></pre>\n\n<p>and use it this way:</p>\n\n<pre><code>f([1,3,4, \"hello\"]);\n</code></pre>\n\n<p>It is also possible to define an argument as \"changeable\":</p>\n\n<pre><code>function g(var x: Byte): String;\n\nvar B: Byte;\ng(B);\n</code></pre>\n\n<p>But is it possible to define a function which can take any number of arguments of whatver type and change all of their values?\nI know I can do this using pointers but then I don't know the type of the parameter passed so it is quite unsafe to mess with them.</p>\n\n<hr>\n\n<p>I just want to create a function which can return variable number of variables of many different types, not just of 1 type or just 1 variable. And I don't want to write zillions of lines to use the function- it should just be the function itself, no SetLength() before the function call or anything. So here is the best thing I made so far:</p>\n\n<pre><code>type TVarArr = Array of Variant;\n     PVarArr = ^TVarArr;\nProcedure f(a: PVarArr);\nvar\n i:Integer;\nbegin\n  SetLength(A^, 4);\n  a^[0] := 46;\nend;\n\nar: TVarArr;\nbegin\nf(@ar);\ncaption := IntToStr(ar[0]);\n</code></pre>\n"},{"tags":["delphi","listview","colors","brush"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13276910,"title":"Why do I get white column separators on my custom-drawn listview?","body":"<p>Basically, I have the following Delphi 2007 code (CustomDrawItem):</p>\n\n<pre><code>procedure TForm1.ListViewCustomDrawItem(Sender: TCustomListView;\n  Item: TListItem; State: TCustomDrawState; var DefaultDraw: Boolean);\nbegin\n if (Item.SubItems[0] = '...') then\n  ListView.Canvas.Brush.Color := clSkyBlue;\nend;\n</code></pre>\n\n<p>On my Windows XP, everything works perfectly:</p>\n\n<p><img src=\"http://image.noelshack.com/fichiers/2012/45/1352315740-image4.png\" alt=\"On Windows XP\"></p>\n\n<p>But on Windows 7, here's what I have:</p>\n\n<p><img src=\"http://image.noelshack.com/fichiers/2012/45/1352316957-image5.png\" alt=\"On Windows 7\"></p>\n\n<p>Now, of course, I'd like to know what's the right code to fill these vertical white stripes. But also, I'd like to know <em>why</em> is this happening. Does it come from Delphi? Windows 7? My code?</p>\n"},{"tags":["delphi","dll","openssl","indy","indy10"],"answer_count":3,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":120,"score":10,"question_id":13269169,"title":"How to use a dll outside of the system path","body":"<p>I made an application that uses the openssl dlls (<code>libeay32.dll</code> and <code>ssleay32.dll</code>).\nIt is indy using them, I don't call the dlls directly.</p>\n\n<p>The simplest workaround i found to avoid an installer (i just delpoy an exe and i am ok with this approach) is to:</p>\n\n<ol>\n<li>put the dlls as resources of the exe</li>\n<li>on program start I extract them in the exe folder</li>\n<li>the exe uses them</li>\n</ol>\n\n<p>This is perfect but I would like to improve the approach by extracting the dlls in a temp folder and not on the exe folder (that in many cases is the desktop).</p>\n\n<p>The problem is that I don't know how to force the application to use the dlls in the temp folder, because now the behaviour is:\nif dlls are not in current directory try to search in the directories defined in the system path.</p>\n\n<p>Who knows a solution to force indy to use the dlls in my temp path? (like \"temporarly registering the dlls\")</p>\n"},{"tags":["delphi","generics","search"],"answer_count":5,"favorite_count":2,"up_vote_count":6,"down_vote_count":3,"view_count":666,"score":3,"question_id":8051327,"title":"How can I search a generic TList for a record with a certain field value?","body":"<p>Everything about generic <code>TList</code>. I have this structure:</p>\n\n<pre><code>Type\n  TExtract = record\n    Wheel: string;\n    Extract: array [1..5] of Byte;\n  end;\n\n  TExtractList = TList&lt;TExtract&gt;\n\n  TEstr = record\n    Date: TDate;\n    Extract: TExtractList;\n  end;\n\n  TEstrList = TList&lt;TEstr&gt;;\n</code></pre>\n\n<p>The main list is <code>TExtrList</code> and in this list I have all dates and for date all wheel with that date. I want to search if a date exists or not. If not exist I add in sublist <code>TExtractList</code> of Extract from <code>TEstr</code> the info. When I search from <code>TExtrList</code> Delphi asks me about <code>TEstr</code> type. I need to search for <code>Date</code> only. So how can I search for single field in a generic <code>TList</code>?</p>\n\n<p>PS: I have deleted last post because here I have tried to explain better.</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":60,"score":-1,"question_id":13264340,"title":"How to make TCP/IP connection in Delphi XE2? Which components to use?","body":"<p>I have to develop a simple application in Delphi XE2. This application will connect to a service running on a server with IP Address(say xxx.xxx.xxx.xxx) with some Port No (say xxxx) using TCP/IP protocol and will get reply from the service running on the server.</p>\n\n<p>I have created two textboxes: txtRequestMsg, txtReplyMsg and a button called Connect.</p>\n\n<p>I don't know which components to use. Infact, I am unable to start the project. Please provide me some sample code in delphi xe2 with tcp / ip protocol showing how to make connection and get a response back so I know it's alive. I am not asking to do an ICMP PING, but a TCP connection.</p>\n"},{"tags":["excel","delphi","automation","save","file-format"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":89,"score":-3,"question_id":13234756,"title":"Different save solutions for .xls and .xlsx aren't working","body":"<p>I have to programm a 'templategenerator' for excelfiles and the saveroutine isn´t working for me.</p>\n\n<p>If I use the following code:</p>\n\n<pre><code>procedure SaveAsXlsFormat(sFileName:string);\nbegin\n  ExcelApp.Application.DisplayAlerts := False;\n  ExcelApp.ActiveWorkbook.SaveAs(sFileName); //Error\n  ExcelApp.Application.DisplayAlerts := True;\nend; \n</code></pre>\n\n<p>I can only save '.xlsx' Workbooks. '.xls' Workbooks (to support clients with Office2003) can't be saved. </p>\n\n<p>If I try to alter the code into the following, neither the '.xls' nor the '.xlsx' can be saved, but after the description from <a href=\"http://www.rondebruin.nl/saveas.htm\" rel=\"nofollow\">http://www.rondebruin.nl/saveas.htm</a> it should at least save the '.xls' Workbooks.</p>\n\n<pre><code>procedure SaveAsXlsFormat(sFileName:string);\nbegin\n  ExcelApp.Application.DisplayAlerts := False;\n  ExcelApp.ActiveWorkbook.SaveAs(Filename := sFileName, FileFormat := 56); //Error\n  ExcelApp.Application.DisplayAlerts := True;\nend;\n</code></pre>\n\n<ul>\n<li>sFileName structure> C:\\template.xls or C:\\template.xlsx</li>\n<li>ExcelApp.Application.DisplayAlerts := False > always override the existing file;</li>\n</ul>\n\n<p>Thanks in advance!</p>\n\n<p>Solution:</p>\n\n<p>Delphi 5 played a prank on me again. </p>\n\n<p>My whole SaveRoutine for those, who have a similar problem:</p>\n\n<pre><code>procedure SaveAsXlFormat(sFileName:string);     //RH\n\nbegin\n\n  {\n  Wert = Konstantenname in Excel (Beschreibung)\n  ------------------------------------------------------------------------------\n  50   = xlExcel12 (Excel Binary Workbook 2007+ mit oder ohne Makros, xlsb)\n  51   = xlOpenXMLWorkbook (ohne Makros Excel 2007+, xlsx)\n  52   = xlOpenXMLWorkbookMacroEnabled (mit oder ohne Makros Excel 2007+, xlsm)\n  56   = xlExcel8 (97-2003 Format in Excel 2007-2010, xls)\n  ------------------------------------------------------------------------------\n  }\n\n  //Warnungen von Excel: aus (Überschreibendialog)\n  ExcelApp.Application.DisplayAlerts := False;\n\n  try\n  begin\n    case ermittleDateiendung(sFileName) of\n      1 : if (StrToInt(Copy(ExcelApp.version,1,2)) &gt; 11) then ExcelApp.ActiveWorkbook.SaveAs(sFileName, 50);\n      2 : if (StrToInt(Copy(ExcelApp.version,1,2)) &gt; 11) then ExcelApp.ActiveWorkbook.SaveAs(sFileName, 51);\n      3 : if (StrToInt(Copy(ExcelApp.version,1,2)) &gt; 11) then ExcelApp.ActiveWorkbook.SaveAs(sFileName, 52);\n      4 : if (StrToInt(Copy(ExcelApp.version,1,2)) &gt; 11) then ExcelApp.ActiveWorkbook.SaveAs(sFileName, 56) else ExcelApp.ActiveWorkbook.SaveAs(sFileName, xlNormal);\n    end;\n  end;\n  except\n    ExcelApp.ActiveWorkbook.SaveAs(sFileName);\n  end;\n\n  //Warnungen von Excel: an (Überschreibendialog)\n  ExcelApp.Application.DisplayAlerts := True;\n\nend;\n\nfunction ermittleDateiendung(sFilename: string) : Integer;\nbegin\n\n  result := 0;\n\n  if (ExtractFileExt(sFileName)) = '.xlsb' then\n    result := 1;\n\n  if (ExtractFileExt(sFileName)) = '.xlsx' then\n    result := 2;\n\n  if (ExtractFileExt(sFileName)) = '.xlsm' then\n    result := 3;\n\n  if (ExtractFileExt(sFileName)) = '.xls' then\n    result := 4;\n\nend;\n</code></pre>\n"},{"tags":["delphi","console","indy"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":875,"score":0,"question_id":8176926,"title":"Delphi 7, how to send a post (idhttp) request in a console application?","body":"<p>I used TStringList and something that looks like:</p>\n\n<pre><code>geo: TStringList;\nresponse: TStringStream;\n  begin\n  http:=tidhttp.Create(nil);\n  try\n    { TODO -oUser -cConsole Main : Insert code here }\n    geo:=TStringList.Create;\n    response:=TStringStream.Create('');\n    geo.Add('name=stas');\n    geo.Add('pass=431');\n    s:=http.Get('http://test.me');\n    writeln(http.ResponseText);\n    writeln(s);\n    s:=http.Post('http://test.me',geo,response);\n</code></pre>\n\n<p>but something is wrong.  For example when I run it it's alerting with the error <code>[[DCC Error] consoleHttp.dpr(29): E2010 Incompatible types: 'string' and 'procedure, untyped pointer or untyped parameter']</code> in <code>s:=http.Post('http://test.me',geo,response)</code>.  What did I do wrong?</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":13270083,"title":"Delphi - E2033 Types of actual and formal var parameters must be identical","body":"<p>Im new to Delphi, trying to make debug on a project which is implemented years ago. My ide is Delphi 2010 and the code with error;</p>\n\n<pre><code>function DrawTextExW(hDC: HDC; lpString: PWideChar; nCount: Integer; var lpRect:\nTRect; uFormat: UINT; dtp: PDRAWTEXTPARAMS): Integer;\n\nconst\n   MAX_STATIC_BUFFER = 8192;\nconst\n   STATIC_BUFFER_LEN: integer = 8192;\nconst\n   DT_PREFIXONLY = $00200000;\n\nvar\n...\n  tm: TTextMetricA;\n...\n\nbegin\n  ...\n\n  GetTextMetrics(hDC, tm);    //Error Line\n  if (uFormat and DT_EXTERNALLEADING) = DT_EXTERNALLEADING then\n    lh := tm.tmHeight + tm.tmExternalLeading\n  else\n    lh := tm.tmHeight;\n\n  ...\nend\n</code></pre>\n\n<p>Getting \"[DCC Error] ElVCLUtils.pas(3555): E2033 Types of actual and formal var parameters must be identical\" error in that line. What is wrong with this code?</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":13209011,"title":"How can I create a component with custom alignment procedure?","body":"<p>I want to create a component but I am not satisfied with the way Align works so I want to create my own property to reposition the component in a completely different way.\nBut I am not sure where to hook in with it- where should it be called?</p>\n"},{"tags":["delphi","sockets","winsock"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13261486,"title":"Sending a Dynamic array (Inside a record) through Socket?","body":"<p>i'm trying to transfer a record from server to client, directly using .SendBuf().</p>\n\n<p>however, this record has a member which is a dynamic array, and i have read somewhere (here in SOF) that when sending records, the members must be STATIC (fixed-length), but the problem is... i cannot determine how many arguments i would send (in the future).</p>\n\n<p>how can i solve this problem ?</p>\n\n<pre><code>procedure TServerClass.SendBufToSocket(const vmName: TVMNames; const vmArgs: Array of TValue);\nvar\n  // this record is sent to client\n  // vmName = method to be called [in]\n  // vmArgs = Argument for the method [in, optional]\n  BufRec: packed record\n    vmName: array[0..49] of char;\n    vmArgs: Array of TValue;\n  end;\n\n  s: string;\n  i: integer;\nbegin\n  // convert enum method name to string\n  s:= GetEnumName(TypeInfo(TVMNames), Integer(vmName));\n\n  // copy method name to record\n  lstrcpy(BufRec.vmName, pChar(s));\n\n  // copy arg array to record\n  SetLength(BufRec.vmArgs, length(vmArgs));\n\n  for i:=0 to high(vmArgs)\n    do BufRec.vmArgs[i] := vmArgs[i];\n\n  // send record\n  ServerSocket.Socket.Connections[idxSocket].SendBuf(PByte(@BufRec)^, SizeOf(BufRec));\nend;\n</code></pre>\n\n<p>I found out from where i've read it, here:\n<a href=\"http://stackoverflow.com/questions/8945267/receivebuf-from-tcustomwinsocket-wont-work-with-dynamic-arrays-for-the-buffer\">ReceiveBuf from TCustomWinSocket won&#39;t work with dynamic arrays for the buffer</a></p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":892,"score":2,"question_id":4401105,"title":"How to enhance the default memo control in Delphi with the ability to underline text","body":"<p>I'm trying to build a simple script editor with the ability to show errors. I've searched the web for a component that can show/underline the errors for me, but i couldn't found one. So i've decided to build one myself based on the memo control that's included in Delphi.</p>\n\n<p>I was planning to add the following function to the memo control:</p>\n\n<p><code>function Underline(startline, startchar, endline, endchar : integer);</code></p>\n\n<p>Being the first time for me to enhance a visual control like this i'm asking if someone could broadly outline for me how to do this. No need to go into specific details :)</p>\n\n<p>ps: I don't want to use a richedit control.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13269430,"title":"EArgumentOutOfRangeException though nothing has changed the TList","body":"<p>I have another question about <code>TList</code> in Delphi...\nI'm getting an EArgumentOutOfRangeException when accessing a TList, just the same way I've done before, after printing a different TList to console.</p>\n\n<p>copy&amp;pasted the original code below - did not change a single line</p>\n\n<pre><code>Writeln('c: '+inttostr(closed.Capacity)+' |l. 281');\n  for i := 0 to open.Capacity-1 do\n  begin\n    Writeln('open: ' + open[i].startpunkt + open[i].endpunkt +\n      IntToStr(open[i].kantenbewertung));\n  end;\n  Writeln('c: '+inttostr(closed.Capacity));\n  Writeln('closed.capacity: '+inttostr(closed.Capacity));\n  for i := 0 to closed.Capacity-1 do begin\n  Writeln('closed: ' + closed[i].startpunkt + closed[i].endpunkt +\n      IntToStr(closed[i].kantenbewertung));\n  end;\n</code></pre>\n\n<p>The <code>Writeln('c: '+inttostr(closed.Capacity)+' |l. 281');</code> is clearly printed to console, the <code>for i := 0 to open.Capacity-1 do begin</code>-loop as well.</p>\n\n<p>Console output is: \nc: 2 |l. 281\nopen: AC3\nopen: BC4\nopen: CD6\n- and then there is the error msg</p>\n\n<p>Is supposed to be part of a implementation of Dijkstra's alg. if this helps.</p>\n\n<p>Does anyone spot a mistake I haven't? Or is this some weird special case?</p>\n"},{"tags":["delphi","winapi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13157412,"title":"How do I convert a relative PIDL into an absolute PIDL?","body":"<p>I want to use <code>SHGetFileInfo</code>  to get windows control panel icon,I use Shell to get windows control panel \nCode:</p>\n\n<pre><code>var\n  psfDeskTop: IShellFolder;\n  psfWork: IShellFolder;\n\n  pidworkDir: PITEMIDLIST;\n  pidChild: PITEMIDLIST;\n\n  pEnumList: IEnumIDList;\n  celtFetched: ULONG;\n  //chEaten, dwAttributes: ULONG;\n  FileInfo: SHFILEINFOW;\n\n  //conGUID: string;\n  StrRetName: TStrRet;\n  Name: PChar;\n\nbegin\n\n  SHGetDesktopFolder(psfDeskTop);\n  SHGetSpecialFolderLocation(0, CSIDL_CONTROLS, pidworkDir);\n  psfDeskTop.BindToObject(pidworkDir, nil, IID_IShellFolder, psfWork);\n  psfWork.EnumObjects(0, SHCONTF_NONFOLDERS or SHCONTF_FOLDERS or SHCONTF_INCLUDEHIDDEN, pEnumList);\n\n  while pEnumList.Next(1, pidChild, celtFetched) = 0 do\n  begin\n\n    //here I want to use SHGetFileInfo to get file icon\n    //but , SHGetFileInfo need a absolute PIDL,IEnumIDList enumerates relative PIDL\n\n  end  \n\nend;\n</code></pre>\n\n<p>I found a function called <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/bb773321%28v=vs.85%29.aspx\" rel=\"nofollow\">ILCombine</a> in MSDN to do that , but I can't found in Delphi , I wonder if possible to combine pidworkDir and pidChild to get a absolute PIDL in Delphi?</p>\n\n<p>Or is there any other way to get a file's icon?   </p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":72,"score":-2,"question_id":13232954,"title":"Is there a way to call Uniface-created forms from Delphi?","body":"<p>We would like to call Uniface form from Delphi 2010.</p>\n\n<p>Is that possible?</p>\n"},{"tags":["delphi","delphi-7","sleep","repeat"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":392,"score":4,"question_id":9656017,"title":"Strange behaviour of function Sleep() used in repeat until in Delphi","body":"<p>I have function which is reaction on button click. When I click on the button it should start repeat and write values form an array and show them in labels on main form. Problem is with function sleep - there is some bug or something, cause when I click on the button it waits quite a long time and then it finaly start the action but very quickly. Let's look at my code. Thx for advices. </p>\n\n<pre><code>procedure TForm1.ButtonMereniClick(Sender: TObject);\nvar\n  iterator: Integer;\nbegin      \n  iterator := 1;\n  repeat       \n    //write some values stored int arrays to labels on form\n    LabelTeplota.Caption:='Teplota: '+FloatToStr(poleTeplota[iterator]);\n    LabelVlhkost.Caption:='Vlhkost: '+FloatToStr(poleVlhkost[iterator]);\n    LabelTlak.Caption:='Atmosférický tlak: '+FloatToStr(poleTlak[iterator]);\n    LabelRychlost.Caption:='Rychlost větru: '+FloatToStr(poleRychlost[iterator]);\n    LabelRychlost.Caption:='Rychlost větru: '+FloatToStr(poleRychlost[iterator]);\n    LabelIterator.Caption:='iterator: '+IntToStr(iterator);\n    Sleep(500);//should be 5000 \n    Inc(iterator);\n  until iterator = 20;\nend;\n</code></pre>\n"},{"tags":["delphi","dbx","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13267606,"title":"DBX error in Delphi XE3, when connecting to a SQL Server database","body":"<p>When I try to connect to a MS SQL Server database using DBX an error pops up saying that the driver is not properly installed, or missing. I tried with ADO driver and it worked like charm, but the thing is that I need DBX driver to work because I want to modify an app that has been developed with DBX technology.</p>\n\n<p>I reinstalled Delphi XE3, and also asked a friend of mine to test it and the error is the same. Does somebody has any ideea on how to solve it ?</p>\n\n<p>The exactly message was this: </p>\n\n<blockquote>\n  <p>Borland.Data.TDBXError: DBX Error:  Driver could not be properly\n  initialized.  Client library may be missing, not installed properly,\n  of the wrong version, or the driver may be missing from the system\n  path.</p>\n</blockquote>\n\n<p>I must mention that I tried it on a local instance of MSSQL Server 2012 and on a remote MSSQL Server 2008 instance. My OS win8 x64;</p>\n\n<p>Best regards,</p>\n"},{"tags":["delphi","networking","network-shares"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":70,"score":-1,"question_id":13264910,"title":"List all shares on a network device","body":"<p>I need to get a list of all shares on a network device including the hidden ones.\nI write a network device since it may be a NAS, a Windows server or a Linux server</p>\n\n<p>I have seen some samples and have tried some of them, but not one that gives me the list I need.\nMost of them only list the devices and not the shares.</p>\n"},{"tags":["delphi","sockets","delphi-2010","tcp","internet"],"answer_count":7,"favorite_count":1,"up_vote_count":5,"down_vote_count":1,"view_count":816,"score":4,"question_id":4521475,"title":"Suggestions on writing a TCP IP messaging system (Client/Server) using Delphi 2010","body":"<p>I would like to write a messaging system using TCP IP  in Delphi 2010. I would like to hear what my best options are for using the standard delphi 2010 components/indy components for doing this.</p>\n\n<p>I would like to write a server which does the listening and forwarding of messages to all machines on the network running a client.</p>\n\n<p>1.) a.) clients can send a message to server to be forwarded to all other clients\n    b.) clients listen for messages from other senders (via server) and displays messages.</p>\n\n<p>2.) a.) Server can send a message to all clients\n    b.) Server forwards any messages from clients to all other clients</p>\n\n<p>thanks for any suggestions</p>\n\n<p>NOTE: I am not writing a instant messaging or chat program. This is merely a system where users can send alerts/messages to other users - they can not reply to each other! NO commercial, shareware, etc links - please! I would like to hear about how you would go about writing this type of system and what approachs you would take, and possibly the TCP IP messaging architecture you would use. Whether it be straight Winows API, Indy components, etc, etc.</p>\n"},{"tags":["delphi","oauth","indy10"],"answer_count":0,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":24,"score":4,"question_id":13267642,"title":"Accessing Ubuntu One API results in \"401 UNAUTHORIZED\" or \"400 BAD REQUEST\"","body":"<p>I am using Delphi XE2 with Indy 10 to access the Ubuntu One API. So far so good. I was able to get the OAuth Token from the Cloud as <a href=\"https://one.ubuntu.com/developer/account_admin/auth/otherplatforms\" rel=\"nofollow\">described</a>. Now I want to start using the API (like <a href=\"https://one.ubuntu.com/developer/account_admin/auth/index\" rel=\"nofollow\">described</a>):</p>\n\n<pre><code>function TUbuntuOneApi.DoRequest(const URL: String): String;\nvar\n  RequestParams: TStringList;\n  HeaderIndex: Integer;\nconst\n  OAuthAuthorisationHeader = 'OAuth realm=\"\", oauth_version=\"%s\", oauth_nonce=\"%s\", oauth_timestamp=\"%s\", oauth_consumer_key=\"%s\", oauth_token=\"%s\", oauth_signature_method=\"%s\", oauth_signature=\"%s\"';\n\nbegin\n  RequestParams := SignOAuthRequestParams(URL, fOAuthAppToken, fOAuthAccessToken);\n\n{  OAuth realm=\"\", oauth_version=\"1.0\",\n  oauth_nonce=\"$nonce\", oauth_timestamp=\"$timestamp\",\n  oauth_consumer_key=\"$consumer_key\", oauth_token=\"$token\",\n  oauth_signature_method=\"PLAINTEXT\",\n  oauth_signature=\"$consumer_secret%26$token_secret\"\n  }\n\n  HeaderIndex := IdHTTP.Request.CustomHeaders.IndexOfName('Authorization');\n  if HeaderIndex &gt;= 0 then\n  begin\n    IdHTTP.Request.CustomHeaders.Delete(HeaderIndex);\n  end;\n\n  // Solving: http://stackoverflow.com/questions/7323036/twitter-could-not-authenticate-with-oauth-401-error\n  IdHTTP.Request.CustomHeaders.FoldLines := false;\n\n  IdHTTP.Request.CustomHeaders.AddValue('Authorization', Format(OAuthAuthorisationHeader, [\n      TIdURI.URLDecode(RequestParams.Values['oauth_version']),\n      TIdURI.URLDecode(RequestParams.Values['oauth_nonce']),\n      TIdURI.URLDecode(RequestParams.Values['oauth_timestamp']),\n      TIdURI.URLDecode(RequestParams.Values['oauth_consumer_key']),\n      TIdURI.URLDecode(RequestParams.Values['oauth_token']),\n      TIdURI.URLDecode(RequestParams.Values['oauth_signature_method']),\n      TIdURI.URLDecode(RequestParams.Values['oauth_signature'])\n    ]));\n\n  // Execute\n  Result := IdHTTP.Get(URL);\n  RequestParams.Free;\nend;\n\nfunction TUbuntuOneApi.Test: String;\nbegin\n  //Result := DoRequest('https://one.ubuntu.com/api/file_storage/v1');\n  Result := DoRequest('https://one.ubuntu.com/api/account/');\nend;\n</code></pre>\n\n<p>Calling <a href=\"https://one.ubuntu.com/api/file_storage/v1\" rel=\"nofollow\">https://one.ubuntu.com/api/file_storage/v1</a> results in \"401 UNAUTHORIZED\". Calling <a href=\"https://one.ubuntu.com/api/account/\" rel=\"nofollow\">https://one.ubuntu.com/api/account/</a> results in \"400 BAD REQUEST\". The OAuth Library is from <a href=\"http://oauthdelphi.svn.sourceforge.net/viewvc/oauthdelphi/\" rel=\"nofollow\">SourceForge</a> and works with Dropbox (Dropbox accepts the OAuth-Params if they are in the Query-String). The Tokens are correct and valid. What am I doing wrong?</p>\n\n<p>BTW:</p>\n\n<pre><code>function SignOAuthRequestParams(const URL: String; OAuthAppToken, OAuthAccessToken: TOAuthToken): TStringList;\nvar\n  Consumer: TOAuthConsumer;\n  ARequest: TOAuthRequest;\n  Response: String;\n  HMAC: TOAuthSignatureMethod;\nbegin\n  HMAC := TOAuthSignatureMethod_PLAINTEXT.Create;\n  // Consumer erzeugen\n  Consumer := TOAuthConsumer.Create(OAuthAppToken.Key, OAuthAppToken.Secret);\n\n  // Request erzeugen\n  ARequest := TOAuthRequest.Create(URL);\n  ARequest := ARequest.FromConsumerAndToken(Consumer, OAuthAccessToken, URL);\n  ARequest.Sign_Request(HMAC, Consumer, OAuthAccessToken);\n\n  Result := TStringList.Create;\n  Result.AddStrings(ARequest.Parameters);\n\n  ARequest.Free;\n  Consumer.Free;\n  HMAC.Free;\nend;\n</code></pre>\n"},{"tags":["delphi","popupmenu"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13266721,"title":"How to repaint a Tpopmenu in Delphi?","body":"<p>I need to change the text of a <code>TMenuItem</code> in Delphi 7, when the popup menu is <strong>already</strong> popped up.</p>\n\n<p>My popup menu has </p>\n\n<pre><code>OwnerDraw := true;\n</code></pre>\n\n<p>I'd like to use:</p>\n\n<pre><code>popupmenu.repaint();\n</code></pre>\n\n<p>or</p>\n\n<pre><code>popupmenu.refresh();\n</code></pre>\n\n<p>but they do not exist. How can I do it?</p>\n"},{"tags":["delphi","ms-access","delphi-7","ado"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13259290,"title":"Delphi 7 app using MSAccess database blocks access by MSaccess","body":"<p>I have an old Delphi 7 application that I fixed up a bit. It uses an Access database. There are about 150 users who all open the application remotely and access the database in parallel. Before I started fixing things (heh), this worked nicely (apart from bugs in the Delphi application), even if the database was occasionally a bit slow.</p>\n\n<p>Now that I added a few features and two new tables I suddenly have really weird problems.</p>\n\n<ol>\n<li>MSAccess can access the Database (2010 version). This means: Double-clicking the file will open MSAccess and open the database file.</li>\n<li>The Delphi 7 app can access the database.</li>\n<li>Two or more instances of the Delphi app can share the database provided I change the original ConnectionString Mode from \"ReadWrite\" to \"Share Deny None\" (entire connection string below).</li>\n<li>Once an instance of the Delphi app is running, the database file <strong>cannot</strong> be opened any more by double-clicking it. (Nothing happens when I do this). However, I can open MSAccess and open the Database file from within it. That will work.</li>\n</ol>\n\n<p>Connection String:</p>\n\n<pre><code>Provider=Microsoft.Jet.OLEDB.4.0;\nUser ID=Admin;Data Source=DBPath;\nMode=Share Deny None;\nExtended Properties=\"\";\nPersist Security Info=False;\nJet OLEDB:System database=\"\";\nJet OLEDB:Registry Path=\"\";\nJet OLEDB:Database Password=****;\nJet OLEDB:Engine Type=5;\nJet OLEDB:Database Locking Mode=1;\nJet OLEDB:Global Partial Bulk Ops=2;\nJet OLEDB:Global Bulk Transactions=1;\nJet OLEDB:New Database Password=\"\";\nJet OLEDB:Create System Database=False;\nJet OLEDB:Encrypt Database=False;\nJet OLEDB:Don`t Copy Locale on Compact=False;\nJet OLEDB:Compact Without Replica Repair=False;\nJet OLEDB:SFP=False\n</code></pre>\n\n<p>I still need to look at all the suggestions made by Renaud Bompuis about the security settings for the shares, but I'll have to unearth an Admin for this so it may take a while.</p>\n"},{"tags":["delphi","winapi","delphi-2009"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13264626,"title":"Handle of TComponent instance","body":"<p>I have an instance of <code>TComponent</code> class and need to interact with the respective control via WinAPI calls.</p>\n\n<p>In order to do this, I need a handle of the control represented by <code>TComponent</code> instance.</p>\n\n<p>How can I get that handle from <code>TComponent</code>?</p>\n"},{"tags":["delphi"],"answer_count":7,"favorite_count":3,"up_vote_count":23,"down_vote_count":0,"view_count":10749,"score":23,"question_id":776302,"title":"Standard URL encode function?","body":"<p>Is there a Delphi equivalent of this .net's method:</p>\n\n<pre>Url.UrlEncode()</pre>\n"},{"tags":["delphi","integer","groupbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":13241982,"title":"Using integer as if subject","body":"<p>Trying to have some main template to change visibility of groupboxes based on the number in main editbox.\n<code>EditDay</code> is the edit box, where only numbers are in it </p>\n\n<pre><code>day:=DayOfTheYear(Now); \nEditDay.Text:=day;\n</code></pre>\n\n<p>so it's basicaly the day of the year.\nAnyway, I need a groupbox (with a few memos) for everyday of the year. Since this is a file with records, which another program will read off for everyday different infos, I need that file writer first, so I can even make one. That's what this one is\nSince I'm doing a record file, there has to be all boxes firstly filled up before I'll write to a file, so I need to have Groupboxes to be visible one at a time, each one for a day I specify in a main <code>TEdit</code>.\nRight now I'm stuck with setting the visibility of the groupboxes; The code below gives me Access violation error.</p>\n\n<p><code>x</code> is the number specified in <code>TEdit</code> named <code>EditDay</code>. I wanted to make an <code>y</code> every other day but the day in EditDay box so all but <code>x</code>;</p>\n\n<pre><code>x : Integer;     \ny : Integer;\n\nprocedure TWriteForm.DayCheckTimer(Sender: TObject);\nbegin\n  x:=StrToInt(EditDay.Text);\n  y:=Not x;\n  (FindComponent('GroupBox'+IntToStr(x)) as TGroupBox).Visible := True;\n  (FindComponent('GroupBox'+IntToStr(y)) as TGroupBox).Visible := False;\n</code></pre>\n\n<p>Tried to set y:=[1..365] and not x;   [1..365] - x; and several others, but none of them worked.</p>\n\n<p>Where am I wrong? .. Any help will be appreciated. :))</p>\n\n<p>[I'm kinda beginner, yes..]</p>\n"},{"tags":["delphi","udp","c++builder","indy10"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13259070,"title":"How to receive broadcast packets with Indy10 TIdUDPClient?","body":"<p>I'm connecting to a system that sends UDP packets, both as responses (sent to a specific IP address) and as broadcasts (dest 255.255.255.255, according to WireShark)</p>\n\n<p>I can receive the 'direct' packets correctly, but I can't work out how to get the broadcast ones. I assume I need a second TIdUDPClient with different bindings, but I haven't been able to get it working. </p>\n\n<pre><code>TIdUDPClient *reader(new TIdUDPClient(NULL));\nTIdUDPClient *broadcastReader(new TIdUDPClient(NULL));\n\nreader-&gt;Port = 2000;\nreader-&gt;Host = \"192.168.0.1\";\nreader-&gt;Connect();\n\nbroadcastReader-&gt;Port = 2000;\n// broadcastReader-&gt;Host = \"0.0.0.0\"; // This doesn't work, but is here as an example\nbroadcastReader-&gt;BroadcastEnabled = true;\nbroadcastReader-&gt;Connect();\n</code></pre>\n\n<p>I then have other near-identical threads calling <code>reader/broadcastReader-&gt;ReceiveBuffer()</code>. The <code>reader</code> one works fine, but <code>broadcastReader-&gt;receiveBuffer()</code> never returns...</p>\n\n<p>Apologies for C++ code and a Delphi tag ;-)</p>\n"},{"tags":["delphi","rtti"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":103,"score":0,"question_id":13252701,"title":"Virtual Method Table","body":"<p>I'm using this block:</p>\n\n<pre><code>procedure ExecMethod(Target: TClass; const MethodName: string; const Args: array of TValue);\nvar\n  LContext: TRttiContext;\n  LType: TRttiType;\n  LMethod: TRttiMethod;\nbegin\n  LType := LContext.GetType(Target);\n  for LMethod in LType.GetMethods do\n    if (LMethod.Parent = LType) and (LMethod.Name = MethodName) then begin\n      LMethod.Invoke(Target.Create, Args);\n      break;\n    end;\nend;\n</code></pre>\n\n<p>like this:</p>\n\n<pre><code>ExecMethod(TFuncClass, 'Test1', []);\nExecMethod(TFuncClass, 'Test2', ['hey']);\nExecMethod(TFuncClass, 'Test3', [100]);\n</code></pre>\n\n<p>on this class:</p>\n\n<pre><code>  TFuncClass = class(TObject)\n    published\n      procedure Test1;\n      procedure Test2(const str: string);\n      procedure Test3(i: integer);\n      // there's more, each one with different prototype\n  end;\n\nvar\n  FuncClass: TFuncClass;\n</code></pre>\n\n<p>but then, i keep getting access violations... or invalid cast pointer class (or whatever)..</p>\n"},{"tags":["delphi"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":13259073,"title":"Trim URL to Root","body":"<p>How can this be done in Delphi? For example..</p>\n\n<p>URL = <a href=\"https://mail.google.com/mail/u/0/?tab=wm#inbox\" rel=\"nofollow\">https://mail.google.com/mail/u/0/?tab=wm#inbox</a></p>\n\n<p>Trimed URL = <a href=\"https://mail.google.com/\" rel=\"nofollow\">https://mail.google.com/</a></p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","size","jpg","reduce"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":112,"score":1,"question_id":13259190,"title":"How to reduce the size of JPG file?","body":"<p>Few days ago I asked this question and got the answer:\n<a href=\"http://stackoverflow.com/questions/13238076/how-to-add-a-picture-frame-and-insert-the-text-in-the-image\">How to add a picture frame and insert the text in the image?</a>    </p>\n\n<p>Now, when I save content from TPanel (1x shape, 1x TImage, 2x TLabel) as JPG file,<br>\nsize of that JPG file is increased from 20kb, wich is size of picture in TImage, to 620kb.</p>\n\n<p>Dimensions are almost same. Original JPG file 320x320, new JPG picture 361x440.</p>\n\n<p>So, how to reduce that size?</p>\n\n<p>This is answer for first question, from @iPath, so that is how new JPG file is created:</p>\n\n<pre><code>procedure TForm1.SavePanelAsImage;\nvar\n img: TBitmap;\nbegin\n img := TBitmap.Create;\n try\n  img.Width := fpPanel.Width;\n  img.Height := fpPanel.Height;\n  fpPanel.PaintTo(img.Canvas, 0, 0);\n  img.SaveToFile(fpFileName);\n finally\n  img.Free;\nend;\nend;\n</code></pre>\n"},{"tags":["delphi","debugging"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":605,"score":2,"question_id":9856072,"title":"Delphi XE2 Run with debugging very slow","body":"<p>Have just migrated my major project from D2010 to XE2 (Update 4). the project is around 100,000 lines of code, and 150+ forms all created automatically and lots of static data allocation (big arrays etc).  In D2010 when I hit F9 it compiles and is on the main screen in 5 seconds flat, in XE2 it compiles instantly but then takes about 40-50 seconds for the main screen to appear, also screen refreshing etc is painfully slow it feels like I'm on an RDP connection. I can live with it (just) but how do I get back my old debugging performance.</p>\n\n<p>Note this does not affect the release version or running without debugging so please no answers telling me to optimise my app or create the forms at runtime as it runs like lightning outside the IDE, I'm hoping its just a checkbox I've missed somewhere.</p>\n\n<p>tks guys (and gals)</p>\n"},{"tags":["delphi","delphi-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":13256070,"title":"Why do I get E2356 Property accessor must be an instance field or method","body":"<p>When compiling this unit:</p>\n\n<pre><code>unit Test;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs;\n\ntype\n  TForm1 = class(TForm)\n  private\n    class var StartDate, EndDate: TDateTime;   // Line 12\n    fTest: TNotifyEvent;\n  public\n    property OnTest: TNotifyEvent read fTest;  // Line 15.\n  end;\n\nimplementation\n\n{$R *.dfm}\n\nend.\n</code></pre>\n\n<p>I get the following compiler error:</p>\n\n<blockquote>\n  <p>[DCC Error] Test.pas(15): E2356 Property accessor must be an instance field or method</p>\n</blockquote>\n\n<p>But if I comment out line 12 it compiles fine. Can someone explain why? I need the dates as class variables to store a date interval.</p>\n"},{"tags":["delphi","guid","delphi-xe3","msbuild-projectreference"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13249877,"title":"How to employ DPROJ <ProjectGUID> within Delphi code?","body":"<p>I want to use a GUID to uniquely identify my Application and to get at this value from within the code. I see that there is a GUID that would be ideal in the DPROJ:</p>\n\n<pre><code>&lt;Project xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\"&gt;\n    &lt;PropertyGroup&gt;\n        &lt;ProjectGuid&gt;{D4DB842C-FB4C-481B-8952-77DA04E37102}&lt;/ProjectGuid&gt;\n</code></pre>\n\n<p>Does this get into the exe anywhere, eg as a resource? If not, what is the neatest way of linking in this GUID value into my exe file and reading it in code. The above GUID resides in a dedicated text file and is pasted into the DPROJ with my <a href=\"http://delphi-divining.blogspot.co.uk/2012/10/dprojmaker-tool-to-create-delphi.html#!/2012/10/dprojmaker-tool-to-create-delphi.html\" rel=\"nofollow\">DprojMaker tool</a>, so I can INCLUDE it in anything you might suggest.\nThanks</p>\n"},{"tags":["delphi","video","directshow"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13256985,"title":"ISampleGrabber/ISampleGrabberCB Exmaple","body":"<p>I am looking for a good Delphi example for the ISampleGrabber and ISampleGrabberCB interfaces' in the DirectShow9 library in Delphi.</p>\n\n<p>Basically I want some event to fire when ever a new frame is rendered, I am sure this is the correct interface to use but I just cant seem to get it to fire the callback event.</p>\n"},{"tags":["delphi","datetimepicker"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":13252791,"title":"How do I disable TDateTimePicker dates beyond a certain time?","body":"<p>How do I disable TDateTimePicker from allowing selecting dates beyond the system date &amp; time? E.g., if my system date is 06 Nov 2012, I should not be able to select dates beyond 06 Nov 2012.</p>\n\n<p>Furthermore, can we do something for selecting dates only within a particular range?</p>\n"},{"tags":["python","delphi","python4delphi"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13239083,"title":"Is there a way to debug a python script using the python4delphi components?","body":"<p>I want to add scripting capabilities to my application and I just came across python4delphi <a href=\"http://code.google.com/p/python4delphi/\" rel=\"nofollow\">http://code.google.com/p/python4delphi/</a>, which seems to be stable. \nAt first sight it looks very easy to use on the developers side, but I couldn't find a way to debug a script. Would be great if I could embed the IDLE IDE in my application, I just have no idea how to do it. </p>\n\n<p>Is there a easy way to add debugging capabilities with python4delphi? Should I use other script engines like pascalScript (seems to have been discontinued)?</p>\n\n<p>Edit: After having a look at PySctipt and pdb I realized that what I am looking is more like a visual editor with embedded debugging and the capability to read python4delphi custom modules (the ones where I export my delphi objects. Being a python noob I have no idea how p4d does this). I am probably asking too much, but would be great to find an implementation of that and not having to code it all from scratch.</p>\n"},{"tags":["delphi","firebird","datasnap","multi-tier","delphi-xe3"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":244,"score":3,"question_id":13211613,"title":"Is DataSnap Optimized for responding to more than 1k users at the same time?","body":"<p>We want to start a big multi-tier application. The server side application must respond to more than 1000 users at the same time. We want to create server application by 64 bit compiler and client side with 32 bit. In this case we don't know DataSnap can respond to all client without any problem or not? \nIn this case The Server computer is very powerful (multi-processor and more than 16GB of RAM) and DataBase Management system is FireBird 2.5.</p>\n"},{"tags":["delphi","chromium","delphi-xe3","tchromium"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13253192,"title":"download a page into memory using chromium embedded","body":"<p>I have an application with DCEF (Chromium Embedded).</p>\n\n<p>During a browser session I want to download a specific page into memory, without displaying it in Chromium (the page to download is an xml file which I want to encrypt before writing it to disk).</p>\n\n<p>The current page in Chromium should remain the same during this download.</p>\n\n<p>Using crm.Browser.MainFrame.LoadUrl and crm.onBeforeDownload like so:</p>\n\n<pre><code>procedure TMainForm.crmBeforeDownload(Sender: TObject;\n  const browser: ICefBrowser; const downloadItem: ICefDownloadItem;\n  const suggestedName: ustring; const callback: ICefBeforeDownloadCallback);\nbegin\n  callback.Cont(ExtractFilePath(ParamStr(0)) + 'myfile.xml', False);\nend;\n</code></pre>\n\n<p>.. the file is written to disk.</p>\n\n<p>Is there a way to get it in memory?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":83,"score":8,"question_id":13252169,"title":"How do I sort a generic list using a custom comparer?","body":"<p>I'm kinda a Delphi-newbie and I don't get how the Sort method of a TList of Records is called in order to sort the records by ascending integer value.\nI have a record like the following:</p>\n\n<pre><code> type\n   TMyRecord = record\n     str1: string;\n     str2: string;\n     intVal: integer;\n   end;\n</code></pre>\n\n<p>And a generic list of such records:</p>\n\n<pre><code>TListMyRecord = TList&lt;TMyRecord&gt;;\n</code></pre>\n\n<p>Have tried to find a code-example in the help files and found this one:</p>\n\n<pre><code>MyList.Sort(@CompareNames);\n</code></pre>\n\n<p>Which I can't use, since it uses classes. So I tried to write my own compare function with a little different parameters:</p>\n\n<pre><code>function CompareIntVal(i1, i2: TMyRecord): Integer;\nbegin\n  Result := i1.intVal - i2.intVal;\nend;\n</code></pre>\n\n<p>But the compiler always throws a 'not enough parameters' - error when I call it with <code>open.Sort(CompareIntVal);</code>, which seems obvious; so I tried to stay closer to the help file: </p>\n\n<pre><code>function SortKB(Item1, Item2: Pointer): Integer;\nbegin\n  Result:=PMyRecord(Item1)^.intVal - PMyRecord(Item2)^.intVal;\nend;\n</code></pre>\n\n<p>with PMyRecord as <code>PMyRecord = ^TMyRecord;</code></p>\n\n<p>I have tried different ways of calling a function, always getting some error...</p>\n\n<p>Any help appreciated!\nThanks in advance :)\np1.e</p>\n"},{"tags":["delphi","scrolling","windows-controls"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1216,"score":4,"question_id":3302389,"title":"Synchronized Scrolling Components Delphi","body":"<p>I am trying to synchronize the scrolling of two TDBGrid components in a VCL Forms application, I am having difficulties intercepting the WndProc of each grid component without some stack issues. I have tried sending WM_VSCROLL messages under scrolling events but this still results in the incorrect operation. It needs to work for clicking the scrollbar, as well as highlighting a cell, or an up or down mouse button. The whole idea is to have two grids next to each other displaying a sort of matching dialog.</p>\n\n<p><em><strong>Tried</em></strong></p>\n\n<pre><code>SendMessage( gridX.Handle, WM_VSCROLL, SB_LINEDOWN, 0 );\n</code></pre>\n\n<p><em><strong>Also</em></strong></p>\n\n<pre><code>procedure TForm1.GridXCustomWndProc( var Msg: TMessage );\nbegin\nMsg.Result := CallWindowProc( POldWndProc, gridX.Handle, Msg.Msg, Msg.wParam, Msg.lParam );\n\n   if ( Msg.Msg = WM_VSCROLL ) then \n   begin\n      gridY.SetActiveRow( gridX.GetActiveRow );\n      gridY.Perform( Msg.Msg, Msg.wParam, Msg.lParam );\n      SetScrollPos( gridY.Handle, SB_VERT, HIWORD( Msg.wParam ), True );\n   end;\nend;\n</code></pre>\n\n<p><em><strong>And</em></strong></p>\n\n<pre><code>procedure TForm1.GridxCustomWndProc( var Msg: TMessage );\nbegin\n   if ( Msg.Msg = WM_VSCROLL ) then \n   begin\n      gridY.SetActiveRow( gridX.GetActiveRow );\n      gridY.Perform( Msg.Msg, Msg.wParam, Msg.lParam );\n      SetScrollPos( gridY.Handle, SB_VERT, HIWORD( Msg.wParam ), True );\n   end;\n   inherited WndProc( Msg );\nend;\n</code></pre>\n\n<p>The First is only a temporary solution, the second results in invalid memory reads, and the third results in a stack overflow. So none of these solutions seems to work for me. I'd love some input on how to accomplish this task! Thanks in advance.</p>\n\n<h1>UPDATE: Solution</h1>\n\n<pre><code>  private\n    [...]\n    GridXWndProc, GridXSaveWndProc: Pointer;\n    GridYWndProc, GridYSaveWndProc: Pointer;\n    procedure GridXCustomWndProc( var Msg: TMessage );\n    procedure GridYCustomWndProc( var Msg: TMessage );\n\nprocedure TForm1.FormCreate(Sender: TObject);\nbegin\n  GridXWndProc := classes.MakeObjectInstance( GridXCustomWndProc );\n  GridXSaveWndProc := Pointer( GetWindowLong( GridX.Handle, GWL_WNDPROC ) );\n  SetWindowLong( GridX.Handle, GWL_WNDPROC, LongInt( GridXWndProc ) );\n\n  GridYWndProc := classes.MakeObjectInstance( GridYCustomWndProc );\n  GridYSaveWndProc := Pointer( GetWindowLong( GridY.Handle, GWL_WNDPROC ) );\n  SetWindowLong( GridY.Handle, GWL_WNDPROC, LongInt( GridYWndProc ) );\nend;\n\nprocedure TForm1.GridXCustomWndProc( var Msg: TMessage );\nbegin\n   Msg.Result := CallWindowProc( GridXSaveWndProc, GridX.Handle, Msg.Msg, Msg.WParam, Msg.LParam );\n   case Msg.Msg of\n      WM_KEYDOWN:\n      begin\n         case TWMKey( Msg ).CharCode of VK_UP, VK_DOWN, VK_PRIOR, VK_NEXT:\n            GridY.Perform( Msg.Msg, Msg.WParam, Msg.LParam );\n         end;\n      end;\n      WM_VSCROLL:\n         GridY.Perform( Msg.Msg, Msg.WParam, Msg.LParam );\n      WM_HSCROLL:\n         GridY.Perform( Msg.Msg, Msg.WParam, Msg.LParam );\n      WM_MOUSEWHEEL:\n      begin\n         ActiveControl := GridY;\n         GridY.Perform( Msg.Msg, Msg.WParam, Msg.LParam );\n      end;\n      WM_DESTROY:\n      begin\n         SetWindowLong( GridX.Handle, GWL_WNDPROC, Longint( GridXSaveWndProc ) );\n         Classes.FreeObjectInstance( GridXWndProc );\n      end;\n  end;\nend;\n\nprocedure TForm1.GridXMouseDown( Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Integer );\nbegin\n   GridY.SetActiveRow( GridX.GetActiveRow );\nend;\n\nprocedure TForm1.GridYCustomWndProc( var Msg: TMessage );\nbegin\n   Msg.Result := CallWindowProc( GridYSaveWndProc, GridY.Handle, Msg.Msg, Msg.WParam, Msg.LParam );\n   case Msg.Msg of\n      WM_KEYDOWN:\n      begin\n         case TWMKey( Msg ).CharCode of VK_UP, VK_DOWN, VK_PRIOR, VK_NEXT:\n            GridX.Perform( Msg.Msg, Msg.WParam, Msg.LParam );\n         end;\n      end;\n      WM_VSCROLL:\n         GridX.Perform( Msg.Msg, Msg.WParam, Msg.LParam );\n      WM_HSCROLL:\n         GridX.Perform( Msg.Msg, Msg.WParam, Msg.LParam );\n      WM_MOUSEWHEEL:\n      begin\n         ActiveControl := GridX;\n         GridX.Perform( Msg.Msg, Msg.WParam, Msg.LParam );\n      end;\n      WM_DESTROY:\n      begin\n         SetWindowLong( GridY.Handle, GWL_WNDPROC, Longint( GridYSaveWndProc ) );\n         Classes.FreeObjectInstance( GridYWndProc );\n      end;\n   end;\nend;\n\nprocedure TForm1.GridYMouseDown( Sender: TObject; Button: TMouseButton; Shift: TShiftState; X, Y: Integer );\nbegin\n   GridX.SetActiveRow( GridY.GetActiveRow );\nend;\n</code></pre>\n\n<p>Thanks to - Sertac Akyuz for the solution. When integrated into a VCL forms application using grids, they will mimmic each other in scrolling, and highlighting the selected record.</p>\n"},{"tags":["sql-server","delphi","firemonkey","livebindings","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":218,"score":0,"question_id":12305384,"title":"Delphi XE 3 LiveBindings AutoInc SQL Server","body":"<p>I have a Delphi XE3 Firemonkey app with LiveBindings to a SQL Server. I can connect and see all the data on a grid. I have a field (\"id\") which is an \"identity field\" on SQL (more commonly known as an AutoInc).</p>\n\n<p>When I try to add a record I get \"Field 'id' must have a value.\"</p>\n\n<p>In the past, the fix for this has been to turn off the required field boolean. (With DBISAM, for example, you make the field in the database itself not required and the DB engine fills it in when it gets there, but you can't make an identity field not required in MSSQL.) </p>\n\n<p>I've turned off the requirement for the TField itself, but that has no effect.</p>\n"},{"tags":["delphi","ide","delphi-xe2","code-completion"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":140,"score":4,"question_id":13249079,"title":"Delphi how to remove Code Completion totally?","body":"<p>My IDE hangs for minutes since I work on a big project every time I press \".\" or do CTRL+SPACE.</p>\n\n<p>If I am lucky I hit the ESC key on time, if not I must wait 1 minute while banging my head against the table.</p>\n\n<p>I want to totally disable it, how to do?</p>\n"},{"tags":["delphi","xmpp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13246716,"title":"xmpp how to Get Current Connection jid name","body":"<p>I have two questions about the XMPP protocol:</p>\n\n<p>1) how can I request <strong>Name</strong> for my current JID (My Connected Account) as registered first time by requesting <strong>IQ command</strong> ?</p>\n\n<p>2) How can I change <strong>nickname</strong> for one of my roster accounts(JIDS) ?</p>\n"},{"tags":["sql-server","delphi","ado","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":159,"score":2,"question_id":11562865,"title":"Why does TClientDataSet get the wrong type for WideText fields?","body":"<p>I'm working with a service with Delphi XE and I receive a ClientDataset from a client. When I check the type of a field that is ftWideText, the system detects that the field is ftBlob. To understand the reason, I have saved the ClientDataset to a file and I get XML with an error with the definition of this field. I get:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;FIELD attrname=\"TEXTTEST\" fieldtype=\"bin.hex\" SUBTYPE=\"\" SUBTYPE=\"WideText\" /&gt;\n</code></pre>\n\n<p>The attribute SUBTYPE appears twice when the correct is:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;FIELD attrname=\"TEXTTEST\" fieldtype=\"bin.hex\" SUBTYPE=\"WideText\" /&gt;\n</code></pre>\n\n<p>This problem only appears over a server; the others work OK. I don't know where the problem is, if it's Delphi, ADO, SQL Server.</p>\n\n<p>If I change the Web service to another computer using the same database, all works OK. I think that it is an ADO problem with the components installed on the computer.</p>\n\n<p><strong>Update:</strong> I have the same problem with Windows 2003 Server computers. Two computers with MDAC 2.8 SP2 (ODBC components version 3.526) and both fails. I installed Microsoft SQLServer 2008 R2 to one of the computers and the problem is fixed. I need to know what is installed or reinstalled with SqlServer2008 to fix the problem. Apparently is related with ADO but now I have two machines with the same version of ADO and only one fails.</p>\n"},{"tags":["delphi","pointers","procedure","var"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":13244835,"title":"Passing a tmemorystream as a var","body":"<p>When I try to pass tmemorystream as a var or pointer to a procedure it comes back corrupted.  What is the proper way to do this?</p>\n\n<p>For example:</p>\n\n<pre><code>function tform1.downloadmemupdate(url, desc: string; var data: tmemorystream; var msg: string): boolean;\nbegin\n  filelabel.Caption:=desc;\n  downloadmemthread:=tdownloadmemthread.create(url);\n  dlcancelbtn.Enabled:=true;\n  downloadmemthread.dlstart;\n  waitforsingleobject(downloadmemthread.Handle, INFINITE);\n\n  downloadmemthread.data.SaveToStream(data); //corrupted\n  downloadmemthread.data.SaveToFile('data.zip');  //works\n\n  dlcancelbtn.Enabled:=false;\n  result:=not (downloadmemthread.canceled and downloadmemthread.success);\n  dlcanceled:=downloadmemthread.canceled;\n  msg:=downloadmemthread.msg;\n  downloadthread.Free;\nend;\n</code></pre>\n"},{"tags":["delphi","localization","delphi-7"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":110,"score":3,"question_id":11017354,"title":"Configures locale not being considered","body":"<p>My software relies in the windows locale configuration to work properly.</p>\n\n<p>My customers have always the pt-br locale setted up and it works fine that way.</p>\n\n<p>In one user´s windows there is the pt-br locale setted properly but somehow my software gets all the us configurations. (. as decimal sepparator, $ as currency symbol and so on).</p>\n\n<p>Is there any way for me to force the locale globally in my software?</p>\n"},{"tags":["c#","delphi","dll","unmanaged","freeze"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":175,"score":5,"question_id":13182913,"title":"C# application with unmanaged DLL freezes whole system","body":"<p>I'm currently writing a software in Visual Studio 2012 for communication with RFID-cards.\nI got a DLL written in Delphi to handle the communication with the card reader.</p>\n\n<p>The problem is: My software is running fine on machines, that have VS2012 installed. On other systems it freezes itself or the whole system.\nI tried it on Win XP / 7 / 8 with x32 and x64 configuration.\nI'm using .NET 4.0.</p>\n\n<p>After connecting to the reader, the software starts a backgroundWorker, which polls (at 200ms rate) the reader with a command to inventory cards in the readers RF-field. The crash usally happens ca. 10 to 20 seconds after the reader connect. Here is the code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[DllImport(\"tempConnect.dll\", CallingConvention = CallingConvention.StdCall)]\n private static extern int inventory(int maxlen, [In] ref int count, \n                                         IntPtr UIDs, UInt32 HFOffTime);\n</code></pre>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public String getCardID()\n    {\n        if (isConnectet())\n        {\n            IntPtr UIDs = IntPtr.Zero;\n            int len = 2 * 8;\n            Byte[] zero = new Byte[len];\n            UIDs = Marshal.AllocHGlobal(len);\n            Thread.Sleep(50);\n            Marshal.Copy(zero, 0, UIDs, len);\n            int count = 0;\n            int erg;\n            String ret;\n            try\n            {\n                erg = inventory(len, ref count, UIDs, 50);\n            }\n            catch (ExternalException) // this doesn't catch anything (iI have set &lt;legacyCorruptedStateExceptionsPolicy enabled=\"true\"/&gt;)\n            {\n                return \"\\0\";\n            }\n            finally\n            {\n                ret = Marshal.PtrToStringAnsi(UIDs, len);\n                IntPtr rslt = LocalFree(UIDs);\n                GC.Collect();\n            }\n            if (erg == 0)\n                return ret;\n            else\n                return zero.ToString();\n        }\n        else\n            return \"\\0\";\n    }\n</code></pre>\n\n<p>The DLL is written in Delphi, the code DLL command is:</p>\n\n<pre><code>function inventory (maxlen: Integer; var count: Integer; \n                  UIDs: PByteArray; HFOffTime: Cardinal = 50): Integer; STDCALL;\n</code></pre>\n\n<p>I think there may be a memory leak somewhere, but I have no idea how to find it...</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>I added some ideas (explicit GC.Collect(), try-catch-finally) to my code above, but it still doesnt work.</p>\n\n<p>Here is the code, that calls getCardID():</p>\n\n<p>The action, that runs every 200ms:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>if (!bgw_inventory.IsBusy)\n   bgw_inventory.RunWorkerAsync();\n</code></pre>\n\n<p>Async backgroundWorker does:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>private void bgw_inventory_DoWork(object sender, DoWorkEventArgs e)\n    {\n            if (bgw_inventory.CancellationPending)\n        {\n            e.Cancel = true;\n            return;\n        }\n        else\n        {\n            String UID = reader.getCardID();\n            if (bgw_inventory.CancellationPending)\n            {\n                e.Cancel = true;\n                return;\n            }\n            if (UID.Length == 16 &amp;&amp; UID.IndexOf(\"\\0\") == -1)\n            {\n                setCardId(UID);\n                if (!allCards.ContainsKey(UID))\n                {\n                    allCards.Add(UID, new Card(UID));\n                }\n                if (readCardActive || deActivateCardActive || activateCardActive)\n                {\n                    if (lastActionCard != UID)\n                        actionCard = UID;\n                    else\n                        setWorkingStatus(\"OK\", Color.FromArgb(203, 218, 138));\n                }\n            }\n            else\n            {\n                setCardId(\"none\");\n                if (readCardActive || deActivateCardActive || activateCardActive)\n                    setWorkingStatus(\"waiting for next card\", Color.Yellow);\n            }\n        }\n   }\n</code></pre>\n\n<hr>\n\n<p>EDIT</p>\n\n<p>Till now I have made some little reworks (updates above) at the code. Now only the App. crashes with 0xC00000FD (Stack overflow) at \"tempConnect.dll\". <strong>This does not happen on Systems with VS2012 installed or if I use the DLL with native Delphi!</strong>\nDo anyone have any other ideas ?</p>\n\n<hr>\n\n<p>EDIT</p>\n\n<p>Now I made the DLL logging it's stacksize and found something weird:\nIf it's called and polled from my C# Programm, the stacksize is changing continuously up and down.\nIf i do the same from a natural Deplhi Program the stacksize is constant!\nSo I'll do further investigations, but I have no really idea, what I have to search for...</p>\n"},{"tags":["delphi","osx-lion","firemonkey"],"answer_count":1,"favorite_count":2,"up_vote_count":29,"down_vote_count":0,"view_count":312,"score":29,"question_id":10897996,"title":"Gethomepath not working on iOS 5 / OSxLion","body":"<p>Whenever I use the Gethomepath function of Delphi I keep getting Shell Script Invocation Error.</p>\n\n<p>Was this function replaced by a newer one? </p>\n"},{"tags":["delphi","charts"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13245915,"title":"Create Dynamically series of TDBChart in delphi: Data not changing","body":"<p>I have used following code to create Dynamically series of TDBChart. I used MS-Access and TADOQuery component. CODE on BUTTON Click Event.</p>\n\n<pre><code>var\nqryData: TADOQuery;\nintCnt: integer;\nstrlstField: TStringList;\n\nbegin\nstrlstField := TStringList.Create();\nqryData := TADOQuery.Create(nil);\nqryData.ConnectionString := 'Provider=Microsoft.Jet.OLEDB.4.0; Data Source=' + ExtractFilePath(Application.ExeName) + 'data.mdb';\nqryData.SQL.Add('SELECT dept_name,2005 as [2005],2006 as [2006],2007 as [2007],'+\n               '2008 as [2008],2009 as [2009],2010 as [2010], 2011 as [2211] FROM SALES');\nqryData.Active := True;\n\nDBChart1.Title.Text.Clear;\nDBChart1.Title.Text.Add('Department Wise Sales Report');\nDBChart1.Title.Font.Size := 14;\nDBChart1.LeftAxis.Title.Font.Size := 12;   \nDBChart1.LeftAxis.Title.Caption := 'Sales in Rs.';\nDBChart1.BottomAxis.Title.Font.Size := 12;\nDBChart1.BottomAxis.Title.Caption := 'Department Name';\n\n//Charting Series\n   //To Remove Old Series\nfor intCnt := DBChart1.SeriesCount -1 downto 0 do\n   DBChart1.Series[intCnt].Free;\n   //To Add New Series\nfor intCnt := 1 to qryData.FieldCount - 1 do begin\n   strlstField.Add(qryData.FieldList[intCnt].FieldName);\n   DBChart1.AddSeries(TBarSeries.Create(nil));\nend;\n   //To set source for Series\nfor intCnt:= 0 to DBChart1.SeriesCount -1 do begin\n   with  DBChart1 do begin\n      Series[intCnt].Clear;\n      Series[intCnt].Title := strlstField[intCnt];\n      Series[intCnt].ParentChart := DBChart1;\n      Series[intCnt].DataSource := qryData;\n      Series[intCnt].XLabelsSource := 'dept_name';\n      Series[intCnt].YValues.ValueSource := strlstField[intCnt];\n   end;\nend;\n</code></pre>\n\n<p>PROBLEM: When i change data in DATABASE and Re-run the application chart remain same. No reflection done in chart series. Had any mistake in Above Code?\n<img src=\"http://i.stack.imgur.com/VqDaS.jpg\" alt=\"enter image description here\"></p>\n\n<p>Another Problem is that in the picture, series are at 2000 value, but i have add all value above 20,000 in the DATABASE.</p>\n"},{"tags":["delphi","dll","delphi-2010","libcurl","static-linking"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":783,"score":0,"question_id":4988355,"title":"Using Curl in Delphi without the DLL","body":"<p>I have a Delphi program in which I need to use Curl, but I do not want to redistribute the curl DLL with it (and I don't want to add the DLL as a resource and write it to a file at runtime and do it that way). With the Curlpas library, you have to use the DLL. Is there any way to use Curl with Delphi in the same way you can do it in C++, with the static library?</p>\n"},{"tags":["delphi","boolean","type-conversion","delphi-xe2"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":160,"score":3,"question_id":13242819,"title":"Is there an easier way to do boolean conversions?","body":"<p>I have used this scenario many times in nearly all my projects, when I'm doing some sort of data conversion, when it comes to booleans, I kinda get a little lost when it comes to making it simple. This statement below sticks out like a sore thumb all over my code:</p>\n\n<pre><code>if BoolVal then\n  StrVal:= 'True'\nelse\n  StrVal:= 'False';\n</code></pre>\n\n<p>I'm wondering if there's an easier way to perform this evaluation? Perhaps some use of the <code>Case</code> statement I don't know about? My actual implementation is more complex than just <code>StrVal</code> but it does consist of returning two different values depending on whether it's True or False. For example, here's some real code...</p>\n\n<pre><code>if fsBold in Can.Font.Style then\n  ConvertTo(AddSomeOtherText + 'True')\nelse\n  ConvertTo(AddSomeOtherText + 'False');\n</code></pre>\n\n<p>That's just to emphasize on how simple I'm hoping. I'm wondering if I can do something along the lines of this:</p>\n\n<pre><code>ConvertTo(AddSomeOtherText + BoolToStrCase((fsBold in Can.Font.Style), 'True', 'False'));\n</code></pre>\n\n<p>I'm sure that's not a real command, but I'm looking for that type of simplicity in one single line.</p>\n"},{"tags":["osx","delphi","auto-update","firemonkey"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":13102253,"title":"Web update application with Firemonkey on MacOS","body":"<p>I'm making a Firemonkey application for both Windows and MacOS, and now I'm working on making it able to check online for updates and download the update. I have got it to work on Windows, by renaming the running .exe file, download the new one and then run the downloaded .exe, works as it should.</p>\n\n<p>Now my problem is MacOS, I don't have much experience with MacOS, so I don't really have any idea how I should do this :/<br>\nAnd even less idea as I store somedata files inside the 'program.app' folder.</p>\n\n<p>So I'd really appreciate some help or ideas on how I should try to solve this problem?</p>\n"},{"tags":["delphi","delphi-2010","indy10"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2539,"score":0,"question_id":2908597,"title":"IdHttp Post Method Delphi 2010","body":"<p>Like others before me, I'm having troubles using the IdHttp(Indy 10.5.5) component in Delphi 2010. The code works fine in Delphi 7:</p>\n\n<pre><code>var\nXMLString : AnsiString;\nlService  : AnsiString;\n\nResponseStream: TMemoryStream;\nInputStringList : TStringList;\nbegin\n  ResponseStream := TMemoryStream.Create;\n  InputStringList := TStringList.Create;\n\n  XMLString :='&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt; '+\n          '&lt;!DOCTYPE pnet_imessage_send PUBLIC \"-//PeopleNet//pnet_imessage_send\"   \"http://open.peoplenetonline.com/dtd/pnet_imessage_send.dtd\"&gt; '+\n          '&lt;pnet_imessage_send&gt; '+\n          '   &lt;cid&gt;username&lt;/cid&gt; '+\n          '   &lt;pw&gt;password&lt;/pw&gt; '+\n          '   &lt;vehicle_number&gt;tr01&lt;/vehicle_number&gt; '+\n          '   &lt;deliver&gt;now&lt;/deliver&gt; '+\n          '   &lt;action&gt; '+\n          '     &lt;action_type&gt;reply_with_freeform&lt;/action_type&gt; '+\n          '     &lt;urgent_reply&gt;yes&lt;/urgent_reply&gt; '+\n          '   &lt;/action&gt; '+\n          '   &lt;freeform_message&gt;Test Message Version 2&lt;/freeform_message&gt; '+\n          '&lt;/pnet_imessage_send&gt; ';\n  lService := 'imessage_send';\n\n  InputStringList.Values['service'] := lService;\n  InputStringList.Values['xml'] := XMLString;\n\n  try\n    IdHttp1.Request.Accept := '*/*';\n    IdHttp1.Request.ContentType := 'text/XML';\n    IdHTTP1.Post('http://open.peoplenetonline.com/scripts/open.dll', InputStringList, ResponseStream);\n    ...\n  finally\n    ResponseStream.Free;\n    InputStringList.Free;\n   end;\n</code></pre>\n\n<p>The only differences so far between this and the D7 code is that I've changed the String types to AnsiString, and added the HTTP Request properties. </p>\n\n<p>The response I get back from the server is 'XML failed to parse. Whitespace expected at Line:1 Position: 19', I'm assuming the XML got garbled up somewhere in the process, but I can't figure our where I'm going wrong.</p>\n\n<p>Any ideas? </p>\n"},{"tags":["osx","delphi","delphi-xe2","firemonkey"],"answer_count":13,"favorite_count":2,"up_vote_count":17,"down_vote_count":1,"view_count":8439,"score":16,"question_id":7271317,"title":"Delphi XE2 Firemonkey sample app not running on a MAC","body":"<p>I am trying to run a sample Firemonkey app on a Mac, but I am getting this message in the mac:</p>\n\n<pre><code>dyld: Library not loaded: @rpath/libcgunwind.1.0.dylib\n  Referenced from: /Users/nobre/Applications/Embarcadero/PAServer/scratch-dir/rafael_colucci-Nobre/Project37.app/Contents/MacOS/Project37\n  Reason: image not found\ndyld: Library not loaded: @rpath/libcgunwind.1.0.dylib\n  Referenced from: /Users/nobre/Applications/Embarcadero/PAServer/scratch-dir/rafael_colucci-Nobre/Project37.app/Contents/MacOS/Project37\n  Reason: image not found\ndyld: Library not loaded: @rpath/libcgunwind.1.0.dylib\n  Referenced from: /Users/nobre/Applications/Embarcadero/PAServer/scratch-dir/rafael_colucci-Nobre/Project37.app/Contents/MacOS/Project37\n  Reason: image not found\n</code></pre>\n\n<p>I used this tutorial to add a OSX platform:</p>\n\n<p><a href=\"http://robstechcorner.blogspot.com/2011/08/new-mac-and-rad-studio-xe2.html\" rel=\"nofollow\">New Mac and Rad Studio XE2</a></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>More info about the error:</p>\n\n<pre><code>Process:         Teste2 [34270]\nPath:            /Users/User/Applications/Embarcadero/PAServer/scratch-dir/rafael_colucci-VM/Teste2.app/Contents/MacOS/Teste2\nIdentifier:      Teste2\nVersion:         ??? (???)\nCode Type:       X86 (Native)\nParent Process:  launchd [94]\n\nDate/Time:       2011-09-01 19:36:26.246 +0100\nOS Version:      Mac OS X 10.6.8 (10K540)\nReport Version:  6\n\nInterval Since Last Report:          3908 sec\nCrashes Since Last Report:           4\nPer-App Crashes Since Last Report:   4\nAnonymous UUID:                      58C242CA-C324-4A23-86ED-96D93C7C1A84\n\nException Type:  EXC_BREAKPOINT (SIGTRAP)\nException Codes: 0x0000000000000002, 0x0000000000000000\nCrashed Thread:  0\n\nDyld Error Message:\n  Library not loaded: @rpath/libcgunwind.1.0.dylib\n  Referenced from: /Users/User/Applications/Embarcadero/PAServer/scratch-dir/rafael_colucci-VM/Teste2.app/Contents/MacOS/Teste2\n  Reason: image not found\n\nBinary Images:\n0x8fe00000 - 0x8fe4163b  dyld 132.1 (???) &lt;4CDE4F04-0DD6-224E-ACE5-3C06E169A801&gt; /usr/lib/dyld\n\nModel: VMware Virtual Platform, BootROM 6.00, 1 processor, 30 GHz, 1 GB, SMC 1.30f3\nGraphics: VMware SVGA II, VMware SVGA II, PCI, 16 MB\nNetwork Service: Ethernet, Ethernet, en0\nParallel ATA Device: VMware Virtual IDE CDROM Drive\nSCSI Device: SCSI Target Device @ 0\nUSB Device: VMware Virtual USB Hub, 0x0e0f  (VMWare, Inc.), 0x0002, 0x00200000 / 3\nUSB Device: VMware Virtual USB Keyboard, 0x05ac  (Apple Inc.), 0x020b, 0x00210000 / 4\nUSB Device: VMware Virtual USB Mouse, 0x0e0f  (VMWare, Inc.), 0x0003, 0x00100000 / 2\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Some screenshots:</p>\n\n<p><img src=\"http://i.stack.imgur.com/kNtRz.jpg\" alt=\"App config\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/Fcoa8.png\" alt=\"PaServer running\"></p>\n"},{"tags":["delphi","winapi","shortcut"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":13228527,"title":"I open a shortcut when shortcut don't exist , why not show this dialog?","body":"<p>I use <code>ShellExecute</code> to open a shortcut </p>\n\n<p>Code :</p>\n\n<pre><code>ShellExecute(Handle, 'open', 'C:\\Users\\hi2012\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\xxx.gif.lnk', nil, nil, SW_SHOWNORMAL)\n</code></pre>\n\n<p>if <strong>xxx.gif</strong> exist that code can open it , if not it don't give anything. </p>\n\n<p>but , when I open it with windows explorer it will show this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/Artq2.png\" alt=\"enter image description here\"></p>\n\n<p>I want when I use code to open a not nonexistent shortcut it also can show that , what can I do ?</p>\n\n<p>is this a wrong way to use <code>ShellExecute</code> to open a shortcut ?</p>\n"},{"tags":["delphi","ide","components","embed","design-time"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13241392,"title":"Is it possible to connect a property to an embedded component","body":"<p>I'd like to write a complex component that embeds other components. But I am not sure if I'll be able to connect to those components via object inspector.</p>\n\n<p>To clarify, imagine a component that holds a list of <code>TDataSources</code>. These DataSource components are owned by this component and not visible on the form.</p>\n\n<p>Now I'd like to connect a <code>TDataset</code> to one of these Datasources, is that possible, will these Datasources show up in the property editor combo of Dataset ?</p>\n"},{"tags":["delphi","download","file-download","delphi-2010","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13233648,"title":"(Indy) TIdHTTP EIdSocketError Socket Error # 0 exceptions when downloading files","body":"<p>I have this delphi code that basically <strong>download</strong> files from a secure server (using Indy build 10.5.8 r4743 if I'm not mistaken):</p>\n\n<p><strong>The problem is:</strong> I'm getting random \"Socket Error # 0\" exceptions that I couldn't get fix or even understand:</p>\n\n<p><code>Project MyProject.exe raised exception class EIdSocketError with message 'Socket Error # 0</code></p>\n\n<p><a href=\"http://dug.im/04607\" rel=\"nofollow\">Stack is here</a>, pascal code is:</p>\n\n<pre><code>IdHTTP            := TIdHTTP.Create(nil);\nTheSSL            := TIdSSLIOHandlerSocketOpenSSL.Create(nil);\nTheCompressor     := TIdCompressorZLib.Create(nil);\nTheCookieManager  := TIdCookieManager.Create(IdHTTP);\n\ntry SetupWebComponents(IdHTTP, TheSSL, TheCompressor, TheCookieManager); except end;\n\nTheCookieManager.OnNewCookie := MainForm.SyncNewCookie;\n\n// Go!\nStream            := TMemoryStream.Create;\ntry\n   IsError        := False;\n   try\n      with IdHTTP do\n      begin\n           OnWork                := MainForm.IdHTTPWork_Download;\n           try\n              try\n                 IsNewFile       := (Not FileExists(LocalFile));\n                 if IsNewFile then\n                    TheFile      := TFileStream.Create(LocalFile, fmCreate)\n                 else\n                     // File already exist, resume download\n                     TheFile     := TFileStream.Create(LocalFile, fmOpenReadWrite);\n\n                 DoExit          := False;\n\n                 // Use [ Request.Referer ] it to pass VersionGUID to Work event (to record download progress in db)\n                 Request.Referer := VersionGUID;\n                 repeat\n                       // Get resume byte\n                       if IsNewFile then\n                       begin\n                            ResumeByte := 0;\n                            IsNewFile  := False;\n                       end\n                       else\n                           ResumeByte  := GetResumeByteFromDB();\n\n                       if FileExists(LocalFile) then\n                       begin\n                            // File already exist, resume download\n                            DoExit     := (ResumeByte &gt;= TheFileSize);\n                            TheFile.Seek(ResumeByte, soFromBeginning);\n                       end;\n\n                       // Save ResumeByte, it will be used to record download progress in db &amp; eventually use it to resume downloads)\n                       IdHTTP.Tag      := ResumeByte;\n\n                       Request.Range := IntToStr(ResumeByte) + '-';\n\n                       Get(TheURL, TheFile);\n                       IsError         := (Not (ResponseCode in [200, 206])) OR (Pos('login', URL.Document) &lt;&gt; 0);\n\n                       // Break if there's any error (to allow retrying later in a clean fashion)\n                       if IsError then\n                          Break;\n                 until DoExit;\n\n                 Disconnect;\n              except\n                    if (ResponseCode = 404) then\n                    begin\n                         // File doesn't exist, get out\n                         Result        := False;\n                         Exit;\n                    end;\n              end;    // try/except\n           finally\n                  FreeAndNil(TheFile);\n           end;    // try/finally\n      end;    // with\n   except\n         IsError  := True;\n   end;    // try/except\nfinally\n       Stream.Free;\nend;\n</code></pre>\n\n<p>I <a href=\"http://stackoverflow.com/questions/10326810/random-indy-responsecode-1-eidsocketerror-socket-error-0-exceptions\">posted a similar question some time ago</a>, but that was regarding <strong>upload, not download</strong>. The code was fixed since then with the kind help of SO members, and the same code (used to deal with cookies, re-login, etc...) is being used now so I assume the problem is really in the download procedure shown above</p>\n\n<p><strong>Can someone please take a look at this tell me what I'm doing wrong?</strong></p>\n"},{"tags":["delphi","ms-access","paradox"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":797,"score":2,"question_id":4738195,"title":"Convert Paradox to MDB","body":"<p>I need to access an database in DB (paradox) files. I'm in a project that will be used Delphi and Access (i know it's very old but the customer want this) and the old project use paradox database.</p>\n\n<p>I would like to know, if is there any program to convert Paradox (DB Files) to MDB (to be accessed by ms access) ?</p>\n"},{"tags":["delphi","delphi-xe2","dead-code"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":131,"score":-2,"question_id":13240627,"title":"How do I remove dead code from an EXE file?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7398580/reduce-exe-file\">Reduce exe file</a>  </p>\n</blockquote>\n\n\n\n<p>What are some tools that, given an EXE file, remove all unused code and make a new EXE file with code really used by the application? I think that something like that should exist. Just for curiosity; but I think that it can be really good as tools for producing a smaller EXE file without unused code.</p>\n\n<p>P.S.: Delphi produces standalone EXE files that contain code of all object used in an application, but not all elements of this object are really used. This makes big files. \nI remember the first version of Pascal that include only code really used and did not insert unused code, and EXE files were smaller.</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":74,"score":0,"question_id":13235897,"title":"Transfer Authentication from Webbrowser to Indy CookieManager","body":"<p>How do you put the cookie from the Webbrowser to an Indy CookieManager for Http Request.</p>\n\n<p>I get the cookies after i login in to a website like this..</p>\n\n<pre><code>procedure TForm1.WebBrowser1DownloadComplete(Sender: TObject);\nvar\ndocument: IHTMLDocument2;\ncookies:tstringlist;\nbegin\ncookies:=tstringlist.Create;\ndocument := WebBrowser1.Document as IHTMLDocument2;\ncookies.Add(document.cookie);\ncookies.savetofile('test.txt');\nend;\n</code></pre>\n\n<p><strong>HttpOnly Cookie Method.</strong></p>\n\n<pre><code>function GetCookie(host: PAnsiChar): PAnsiChar;\nconst\n  INTERNET_COOKIE_HTTPONLY = 8192;\nvar\n  hModule: THandle;\n  lp: Pointer;\n  InternetGetCookieEx: function(lpszUrl, lpszCookieName, lpszCookieData\n    : PAnsiChar; var lpdwSize: DWORD; dwFlags: DWORD; lpReserved: pointer)\n    : BOOL; stdCall;\n  CookieSize: DWORD;\n  CookieData: PAnsiChar;\nbegin\n  LoadLibrary('wininet.dll');\n  hModule := GetModuleHandle('wininet.dll');\n  if hModule &lt;&gt; 0 then\n  begin\n    @InternetGetCookieEx := GetProcAddress(hModule, 'InternetGetCookieExA');\n    if @InternetGetCookieEx &lt;&gt; nil then\n    begin\n      CookieSize := 1024;\n      Cookiedata := AllocMem(CookieSize);\n      if InternetGetCookieEx(host, nil, Cookiedata, CookieSize, INTERNET_COOKIE_HTTPONLY, nil) then\n      result:=cookiedata;\n      FreeMem(Cookiedata);\n    end;\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-7"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":6,"view_count":179,"score":-4,"question_id":13220990,"title":"Send a picture over the internet in Delphi 7","body":"<p><strong>The Idea</strong></p>\n\n<p>Me and a friend want to to play a joke on another friend and make a delphi application that takes screen shots of our friends screen and then send it to my computer. </p>\n\n<p><strong>The Question</strong></p>\n\n<p>The problem is that me and my friend have no idea how to send the image to my computer. Any idea how?</p>\n\n<p><strong>I have tried what GolezTrol said</strong></p>\n\n<p>This is the code for that (starts at line 27)</p>\n\n<pre><code> procedure TForm1.Button1Click(Sender: TObject);\n var\n   Params:  TIMultipartFormDataStream;\n   Response1: TStringStream;\n begin\n  try\n    Params := TIMultipartFormDataStream.create;\n    Response1 := TStringStream.Create;\n    try\n      Params.AddFile('file', 'C:\\temp\\YourTempImageName.jpg', 'image/jpg');\n      IdHTTP1.Post('http://localhost/uploadimage.php', Params, Response1);\n    finally\n      Params.Free;\n      Response1.Free;\n    end;\nend;\n</code></pre>\n\n<p>(I'm busy trying to make it work.) </p>\n\n<p><strong>Extra Information</strong>\nAfter reconsidering I don't really see the funny side anymore. By the way I was not going to steel my friends identity. After telling him what we wanted to do he challenged us to try (He bet we couldn't do it). </p>\n"},{"tags":["image","delphi","text","frame","picture"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":86,"score":5,"question_id":13238076,"title":"How to add a picture frame and insert the text in the image?","body":"<p>This is what I need: Program for quicker making fun posters for facebook page. \nPosters have text, picture and frame (white line and black background).\nIn this case, I want to insert logo on poster (png image).</p>\n\n<p>Depending on picture size, dimensions of frame (who in this case consits of two shapes) must automaticly be resized for picture.</p>\n\n<p><img src=\"http://i.stack.imgur.com/AKfu7.jpg\" alt=\"enter image description here\"></p>\n\n<p>How to save poster from that image from link (2 shape components, 2 image components, 2 labels) as picture?</p>\n\n<p>How to accomplish this? What to use, where to begin?</p>\n\n<p>I hope that this question will not be removed.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":107,"score":1,"question_id":13236645,"title":"Archive for Byte, Byte to String without delay Delphi","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13233776/convert-array-of-shortint-to-string-delphi\">Convert Array of ShortInt to String, Delphi</a>  </p>\n</blockquote>\n\n\n\n<p>I would like to turn a file into a string, this string should contain the numbers corresponding to the file in bytes.</p>\n\n<p>I did in a way but it was very slow, using an array of FOR and ShortInt ...</p>\n\n<p>Example:</p>\n\n<p>have any file on my computer, my goal would be to transform it into Bytes, Bytes that these should be between -127 .. 128, it would have with something like this:</p>\n\n<pre><code>A[0] = 120\nA[1] = -35\nA[2] = 40\n</code></pre>\n\n<p>Ate here OK, but I need it in a concatenated string and a ',' between them, thus:</p>\n\n<pre><code>'120,-35,40'\n</code></pre>\n\n<p>I did it with a 'FOR', but it was very slow, if you have another alternative.</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":621,"score":6,"question_id":6077258,"title":"Theres a UIntToStr in delphi to let you display UINT64 values, but where is StrToUInt to allow user to input 64 bit unsigned values?","body":"<p>I want to convert a large 64 bit value from decimal or hex string to 64 bit UINT64 data type.  There is a UIntToStr to help converting the UINT64 to string, but no way to convert a 64 bit integer to a unsigned value, as a string. That means integer values greater than 2**63 can not be represented in decimal or hex, using the RTL.   This is normally not a big deal, but it can happen that a user needs to input a value, as an unsigned integer, which must be stored into the registry as a 64 bit unsigned integer value.</p>\n\n<pre><code>procedure HandleLargeHexValue;\n\nvar\n x:UINT64;\nbegin\n\n  x := $FFFFFFFFFFFFFFFE;\n\n  try\n  x := StrToInt('$FFFFFFFFFFFFFFFF'); // range error.\n  except\n    x := $FFFFFFFFFFFFFFFD;\n  end;\n\n  Caption := UintToStr(x);\n\nend;\n</code></pre>\n\n<p><strong>Update</strong> Val('$FFFFFFFFFFFFFFFF') works but not Val('9223372036854775899').  As Roeland points out below in Quality Central 108740: System.Val has problems with big UInt64 values.\nI have accepted my own answer as it works with all decimal values up to maximum 64 bit UINT.</p>\n"},{"tags":["multithreading","delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13237325,"title":"Invalid handle error in thread","body":"<p>I keep getting \"Thread error: The handle is invalid (6)\" when I attempt to use this thread but I can't see the problem.  Please help if you can, thanks!</p>\n\n<p>stackoverlow is complaining that I didn't explain this enough.  So, I created a thread class which compiles without any errors but when I invoke it with execute it seems to run ok but throws this error in the destructor.</p>\n\n<pre><code>  tdownloadthread = class(tthread)\n    private\n      furl,\n      ffilename,\n      fmsg: string;\n      fdl: tidhttp;\n      readings,bpstotal,avgbps: int64;\n      fpercent: word;\n      fsuccess,fcanceled: boolean;\n      start: tdatetime;\n      fspeed,fremaining: string;\n    public\n      constructor create(url,filename: string);\n      destructor destroy; override;\n      procedure execute; override;\n      procedure DlWork(ASender: TObject; AWorkMode: TWorkMode; AWorkCount: Int64);\n      procedure cancel;\n\n      property success: boolean read fsuccess;\n      property canceled: boolean read fcanceled;\n      property speed: string read fspeed;\n      property percent: word read fpercent;\n      property remaining: string read fremaining;\n      property msg: string read fmsg;\n  end;\n\n\nconstructor tdownloadthread.create(url,filename: string);\nbegin\n  fsuccess:=false;\n  fcanceled:=false;\n\n  fdl:=tidhttp.Create(nil);\n  fdl.OnWork:=dlwork;\n  fdl.HandleRedirects:=true;\n\n  furl:=url;\n  ffilename:=filename;\n\n  freeonterminate:=false;\nend;\n\ndestructor tdownloadthread.Destroy;\nbegin\n  fdl.Free;\nend;\n\nprocedure tdownloadthread.cancel;\nbegin\n  fdl.Disconnect;\n  fcanceled:=true;\nend;\n\nprocedure tdownloadthread.DlWork(ASender: TObject; AWorkMode: TWorkMode; AWorkCount: Int64);\nvar\n  Http: TIdHTTP;\n  ContentLength: Int64;\n  i,h,m,esec,sec,rsec,bps: Integer;\n  f: tdatetime;\nbegin\n  Http := TIdHTTP(ASender);\n  ContentLength := Http.Response.ContentLength;\n\n  if (Pos('chunked', LowerCase(Http.Response.ResponseText)) = 0) and\n     (ContentLength &gt; 0) then\n  begin\n    fpercent := trunc(100*(AWorkCount / ContentLength));\n\n    esec := secondsbetween(now, start);\n\n    if (avgbps &gt; 0) then\n     begin\n       i:=contentlength div avgbps;\n       f:=incsecond(now, i);\n       rsec:=secondsbetween(now, f);\n\n       sec:=rsec - esec;\n\n       h:=sec div 3600;\n       m:=sec div 60 - H * 60;\n       sec:=sec - (H * 3600 + M * 60) ;\n    end;\n\n    if (esec &gt; 0) then\n      bps:=(aworkcount div esec)\n       else\n      bps:=0;\n\n    inc(readings);\n    inc(bpstotal, bps);\n    avgbps:=bpstotal div readings;\n\n    if (avgbps / 1024 &lt; 1024) then\n      fspeed:=format('%2f KB/s', [avgbps / 1024])\n       else\n      fspeed:=format('%2f MB/s', [(avgbps div 1024) / 1024]);\n\n    fremaining:=format('%s m %s s', [zero(m), zero(secno)]);\n  end;\nend;\n\nprocedure tdownloadthread.Execute;\nvar fn,cd: string;\n    data: tmemorystream;\nbegin\n  try\n    start:=now;\n\n    data:=tmemorystream.Create;\n\n    fdl.Get(furl, data);\n    cd:=fdl.Response.ContentDisposition;\n    if (pos('filename=', cd) &gt; 0) then\n      fn:=extractfilepath(paramstr(0))+copy(cd, pos('=', cd)+1, length(cd))\n         else\n      fn:=ffilename;\n    data.SaveToFile(fn);\n    ffilename:=fn;\n    fsuccess:=true;\n\n    data.Free;\n  except\n    on e: exception do\n      begin\n        fsuccess:=false;\n        fmsg:=e.Message;\n      end;\n  end;\nend;\n\nprocedure testdownload;\nvar downloadthread: tdownloadthread;\nbegin\n  downloadthread:=tdownloadthread.create('http://www.someurl.com/filename.old',extractfilepath(paramstr(0))+'filename.new');\n  downloadthread.Execute;\n  if downloadthread.canceled then showmessage('canceled');\n  if downloadthread.success then showmessage('success');\n  if not downloadthread.success then showmessage('error: '+downloadthread.msg);\n  downloadthread.Free;\nend;\n</code></pre>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":99,"score":1,"question_id":13233776,"title":"Convert Array of ShortInt to String, Delphi","body":"<p>I'm doing the way I learned, that is:\nwith a FOR and taking the Index array one by one, but it is leaving too slow, would otherwise convert it to a String? that leaves quicker?</p>\n\n<p>In my case it would be a Dynamic Array of ShortInt.</p>\n\n<p>For example, given this input:</p>\n\n<pre><code>[0,20,-15]\n</code></pre>\n\n<p>I would like the following output:</p>\n\n<pre><code>0,20,-15\n</code></pre>\n"},{"tags":["windows","delphi","winapi"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":293,"score":5,"question_id":9224693,"title":"How can I display the \"open with\" dialog for an unregistered file extension?","body":"<p>I want to let the user select an association (open with) for an currently unregistered file extension.</p>\n\n<p>Currently I'm telling the API to open the file by using <code>ShellExecute</code> and it returns an <code>ERROR_NO_ASSOCIATION</code> error code.</p>\n\n<p>Is there a way to tell the API that it should let the user select a new association?</p>\n"},{"tags":["delphi","delphi-2009","named-pipes"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":141,"score":0,"question_id":13179036,"title":"Sending text over a named pipe crashes Delphi application","body":"<p>I have a Delphi application, which sends piece of text to a named pipe via call</p>\n\n<pre><code>SendMessageToNamedPipe(hPipe, CurMsg);\n</code></pre>\n\n<p>It works fine for some messages, but sending other texts leads to a crash of the application.</p>\n\n<p>The only difference between normal and \"crashing\" messages I'm aware of is that the crashing messages contain lots of Cyrillic characters.</p>\n\n<p>How should I encode them in order for the aforementioned call to be executed properly?</p>\n\n<p><strong>Update 1</strong>: Here's the implementation of <code>SendMessageToNamedPipe</code>.</p>\n\n<pre><code>procedure SendMessageToNamedPipe(hPipe:THandle; msg:string);\n  const\n    OUT_BUF_SIZE = 100;\n  var\n    dwWrite : DWORD;\n    lpNumberOfBytesWritten : LongBool;\n    utf8String : RawByteString;\n    sendBuf: array[0..OUT_BUF_SIZE] of WideChar;\n  begin\n    utf8String := UTF8Encode(msg);\n\n    sendBuf[0] := #0;\n    lstrcatw(sendBuf, PChar(msg));\n\n    lpNumberOfBytesWritten := WriteFile(hPipe, sendBuf, OUT_BUF_SIZE, dwWrite, NIL);\n\n    if not lpNumberOfBytesWritten then\n    begin\n      OutputDebugString(PChar('Sending error: ' + SysErrorMessage(GetLastError)));\n    end\n    else\n    begin\n      OutputDebugString(PChar('Message sent, dwWrite: ' + IntToStr(dwWrite)));\n    end;\n  end;\n</code></pre>\n\n<p><strong>Update 2</strong>: Version of the function, which seems to work.</p>\n\n<pre><code>procedure SendMessageToNamedPipe(hPipe:THandle; msg:string);\nconst\n    OUT_BUF_SIZE = 200;\nvar\n  dwWrite : DWORD;\n  Success : LongBool;\n  msgToSend : PChar;\n  utf8String : RawByteString;\n  sendBuf: array[0..OUT_BUF_SIZE-1] of WideChar;\n  AnsiCharString : PAnsiChar;\nbegin\n    OutputDebugString(PChar('SendMessageToNamedPipe.Length(msg): ' +     IntToStr(Length(msg))));\n    OutputDebugString(PChar('Sending message: ' + msg));\n\n    utf8String := UTF8Encode(msg);\n\n    sendBuf[0] := #0;\n    lstrcatw(sendBuf, PChar(msg));\n\n    Success := WriteFile(hPipe, sendBuf, Length(sendbuf), dwWrite, NIL);\n\n    if not Success then\n    begin\n      OutputDebugString(PChar('Sending error: ' + SysErrorMessage(GetLastError)));\n    end\n    else\n    begin\n      OutputDebugString(PChar('Message sent, dwWrite: ' + IntToStr(dwWrite)));\n    end;\nend;\n</code></pre>\n"},{"tags":["performance","delphi","report","fastreport"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13231372,"title":"Can I use two types of barcode on Fast Report?","body":"<p>I'm want develop a system to print barcode using fastreport, but, I want print Code128B for numbers &lt; 13 and EAN13 for numbers = 13.</p>\n\n<p>How I can use two (2) types of barcode in my report? I using a databand.</p>\n\n<p>Thanks!</p>\n\n<ul>\n<li>I using Delphi and Fast Report 4.9</li>\n</ul>\n"},{"tags":["delphi","treeview","scrollbar","synchronized"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":214,"score":5,"question_id":10525367,"title":"How to synchronize the scrolling of 2 TTreeviews?","body":"<p>I have <strong>2 TTreeviews</strong>. Both of them have the same number of items.\nI'd like to be able to <strong>synchronize</strong> their <strong>scrollbars</strong>... If I move one of them, the other moves also...</p>\n\n<p>For the horizontal, it works as I expect...\nFor the vertical, it works if I use the arrows of the scrollbar, but it doesn't if I <strong>drag the thumb</strong> or if I use the <strong>mouse wheel</strong>...</p>\n\n<p>Here is a sample I've written to illustrate my issue:</p>\n\n<pre><code>unit main;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms, Dialogs, ComCtrls, StrUtils;\n\ntype\n  TForm1 = class(TForm)\n    tv1: TTreeView;\n    tv2: TTreeView;\n    procedure FormCreate(Sender: TObject);\n    procedure FormDestroy(Sender: TObject);\n  private\n    { Private declarations }\n    originalTv1WindowProc : TWndMethod;\n    originalTv2WindowProc : TWndMethod;\n    procedure Tv1WindowProc (var Msg : TMessage);\n    procedure Tv2WindowProc (var Msg : TMessage);\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm1.FormCreate(Sender: TObject);\nvar\n  i: Integer;\nbegin\n  for i := 0 to 10 do\n  begin\n    tv1.Items.AddChild(nil, DupeString('A', 20) + IntToStr(i));\n    tv2.Items.AddChild(nil, DupeString('B', 20) + IntToStr(i));\n  end;\n\n  originalTv1WindowProc := tv1.WindowProc;\n  tv1.WindowProc        := Tv1WindowProc;\n  originalTv2WindowProc := tv2.WindowProc;\n  tv2.WindowProc        := Tv2WindowProc;\nend;\n\nprocedure TForm1.FormDestroy(Sender: TObject);\nbegin\n  tv1.WindowProc := originalTv1WindowProc;\n  tv2.WindowProc := originalTv2WindowProc;\n\n  originalTv1WindowProc := nil;\n  originalTv2WindowProc := nil;\nend;\n\nprocedure TForm1.Tv1WindowProc(var Msg: TMessage);\nbegin\n  originalTv1WindowProc(Msg);\n  if ((Msg.Msg = WM_VSCROLL)\n   or (Msg.Msg = WM_HSCROLL)\n   or (Msg.msg = WM_Mousewheel)) then\n  begin\n//    tv2.Perform(Msg.Msg, Msg.wparam, Msg.lparam);\n    originalTv2WindowProc(Msg);\n  end;\nend;\n\nprocedure TForm1.Tv2WindowProc(var Msg: TMessage);\nbegin\n  originalTv2WindowProc(Msg);\n  if ((Msg.Msg = WM_VSCROLL)\n   or (Msg.Msg = WM_HSCROLL)\n   or (Msg.msg = WM_Mousewheel)) then\n  begin\n//    tv1.Perform(Msg.Msg, Msg.wparam, Msg.lparam);\n    originalTv1WindowProc(Msg);\n  end;\nend;\n\nend.\n</code></pre>\n\n<p>The DFM:</p>\n\n<pre><code>object Form1: TForm1\n  Left = 0\n  Top = 0\n  Caption = 'Form1'\n  ClientHeight = 113\n  ClientWidth = 274\n  Color = clBtnFace\n  Font.Charset = DEFAULT_CHARSET\n  Font.Color = clWindowText\n  Font.Height = -11\n  Font.Name = 'Tahoma'\n  Font.Style = []\n  OldCreateOrder = False\n  OnCreate = FormCreate\n  OnDestroy = FormDestroy\n  PixelsPerInch = 96\n  TextHeight = 13\n  object tv1: TTreeView\n    Left = 8\n    Top = 8\n    Width = 121\n    Height = 97\n    Indent = 19\n    TabOrder = 0\n  end\n  object tv2: TTreeView\n    Left = 144\n    Top = 8\n    Width = 121\n    Height = 97\n    Indent = 19\n    TabOrder = 1\n  end\nend\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/sWfBS.jpg\" alt=\"enter image description here\"></p>\n\n<p>I also tried creating a subclass from TTreeview, but without success (same behavior)...\nI tried with a TMemo, and it works as expected...</p>\n\n<p>What did I miss?</p>\n\n<p>Cheers,</p>\n\n<p>W.</p>\n"},{"tags":["delphi","winapi"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":139,"score":4,"question_id":13226510,"title":"How popup \"Connect To\" dialog?","body":"<p><img src=\"http://i.stack.imgur.com/68BiW.png\" alt=\"enter image description here\"></p>\n\n<p>how to popup this form use delphi ?\nis <code>ShellExecuteEx</code> or <code>ShellExecute</code>  can do this?</p>\n"},{"tags":["delphi","delphi-5"],"answer_count":1,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":102,"score":6,"question_id":13220112,"title":"TFlowPanel alike in D5","body":"<p>I am looking for an implementation of <code>TFlowPanel</code> (or similar) that will work with D5.<br>\n  Basically I need the <code>TFlowPanel</code> to work inside a <code>TScrollBox</code> (with Vertical scroll bar), so the controls will wrap based on the Width of that <code>TScrollBox</code>.</p>\n\n<p>The images basically show what I need:</p>\n\n<p><img src=\"http://i.stack.imgur.com/EA3se.png\" alt=\"enter image description here\"></p>\n\n<p>After resizing the controls are automatically repositioned: </p>\n\n<p><img src=\"http://i.stack.imgur.com/gBUJx.png\" alt=\"enter image description here\"></p>\n\n<p>With Vertical scroll bar:</p>\n\n<p><img src=\"http://i.stack.imgur.com/0IYUs.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi","64bit","controlpanel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":13173607,"title":"How to get a windows control panel in x64 system?","body":"<p>I use Shell to get control panel </p>\n\n<p>Code :</p>\n\n<pre><code>var\n  psfDeskTop: IShellFolder;\n  psfControl: IShellFolder;\n\n  pidControl: PITEMIDLIST;\n  pidChild: PITEMIDLIST;\n  pidAbsolute: PItemIdList;\n\n  pEnumList: IEnumIDList;\n  celtFetched: ULONG;\n\n  FileInfo: SHFILEINFOW;\n\nbegin\n\n  OleCheck(SHGetDesktopFolder(psfDeskTop));\n  OleCheck(SHGetSpecialFolderLocation(0, CSIDL_CONTROLS, pidControl));\n  OleCheck(psfDeskTop.BindToObject(pidControl, nil, IID_IShellFolder, psfControl));\n  OleCheck(psfControl.EnumObjects(0, SHCONTF_NONFOLDERS or SHCONTF_INCLUDEHIDDEN or SHCONTF_FOLDERS, pEnumList));\n\n  while pEnumList.Next(1, pidChild, celtFetched) = 0 do\n  begin\n\n    pidAbsolute := ILCombine(pidControl, pidChild);\n    SHGetFileInfo(LPCTSTR(pidAbsolute), 0, FileInfo, SizeOf(FileInfo), SHGFI_PIDL\n      or SHGFI_DISPLAYNAME);\n    Memo1.Add(FileInfo.szDisplayName);\n\n  end;\n\nend;\n</code></pre>\n\n<p>it only can get control panels in 32-bit like :  BDE Administrator (32 bit) , Flash Player (32 bit), \nand my operating system is x64 , I wonder how to get all (32bit &amp; 64bit) control panel ?</p>\n"},{"tags":["c#","delphi","pinvoke"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13223629,"title":"How do I write DllGetClassObject as a C# delegate?","body":"<p>There is a dll method exported written in delphi:\nDllGetClassObject: function(const CLSID, IID: TGUID; var Obj): HResult; stdcall;</p>\n\n<p>I need to write equivalent method in c# as a delegate. How should it looks like?</p>\n"},{"tags":["mysql","delphi","zeos"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13227812,"title":"List values from store procedure function","body":"<p>I'm new to Delphi, but im a old PHP and MySQL programmer.</p>\n\n<p>I have a system that needs to be used on a desktop too, so I've created some stored procedures to list the queries from the database. The store procedures just select and join tables to show it. </p>\n\n<p>I'm using the zeos component in delphi 7.  It shows my tables in the db grid well, but i need to show the result from my store procedure. I've tried to use the zstoredproc but it returns the error <code>PROCEDURE xxxxx cant return a result set in the given context</code>.</p>\n\n<p>Please help me; I just want to show the data from the stored procedure in to a grid or combobox.</p>\n"},{"tags":["delphi","windows-8","app-store"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":13223612,"title":"Delphi XE2 / XE3 & Windows 8 Tablets / Phones","body":"<p>Is it possible to develop apps for Windows 8 tablets and phones using Delphi XE2 or XE3? I think XE3 ust supports UI. I am not sure if we can create apps for Win8 tablets using Delphi. I have read somewhere we need to use Prism XE3 with Visual Studio. I don't want to purchase / upgrade to XE3 just because of this. I believe we can develop even using XE2 but not sure.</p>\n\n<p>Also, does anyone know if Microsoft accepts apps to appstore which are written in Delphi?</p>\n\n<p>Thanks.</p>\n\n<p>-K</p>\n"},{"tags":["delphi","validation","tclientdataset","tfield"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":13170446,"title":"OnValidate for a TClientDataSet","body":"<p>I'm trying to write an OnValidate event on a field on a TClientDataSet, something along the lines of</p>\n\n<pre><code>procedure TForm8.ClientDataSet1MyFieldValidate(Sender: TField);\nbegin\n  if Sender.AsFloat &gt; 30 then\n     raise Exception.Create('Too Much!!!');\nend;\n</code></pre>\n\n<p>But Sender.AsFloat is always 0 - how do I do field level validation (I realize in this instance I could use constraints or set Min/Max values)</p>\n"},{"tags":["delphi","jcl","delphi-xe3","jvcl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":13222344,"title":"Proper way to install JVCL 3.47 on XE3","body":"<p>I am trying to install JVCL 3.47 on a Delphi XE3 instance but I failed twice; I know that first I must install JCL; When I run Install.bat located in the jcl folder I get this error: \"Windows cannot find '..\\bin\\JediInstaller.exe' ...; </p>\n\n<p>I looked into bin folder but indeed JediInstaller.exe is not there; So I have opened  the project JediInstaller located in \"..\\JVCL347CompleteJCL241-Build4571\\jcl\\jcl\\install\" and compiled it and then I started JediInstaller and installed JCL; Afer I tried to install JVCL again with opening the installer project and compiling it but again it returned an error that JCL is not installed and I don't know way because I have it installed; </p>\n\n<p>When I installed JVCL 3.45 on Delphi Xe2, Win 7 it worked by opening install.bat, but now on Win8 , Delphi XE3 it doesn't work... Please somebody advise me how to install properly JVCL(I need to modify a project built with XE2 and Jvcl by the day after tomorrow);</p>\n\n<p>Thanks in advance,</p>\n"},{"tags":["delphi","printing","delphi-xe","rave-reports","print-preview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":192,"score":0,"question_id":11016858,"title":"How to display preview with Rave Report 9.0?","body":"<p>I apologize if you find other similar questions, but I am just frustrated. I've looked all over the Internet and StackOverflow for answer and simply didn't find one solution that really worked. However, I did come close.</p>\n\n<p>I already linked my database and created dataview. Then, I was able to execute the report for preview right from the Rave Report Designer (everything looks great). Now, I need to be able do the same thing from my Delphi Program. I need to display or open the preview for my report when a user clicks on a button.</p>\n\n<p>Initially, I only had TRvProject and TRvDataSetConnection on my form but after spending nearly 2 hours trying to implement others suggestion, I have now TRvProject, TRvSystem, TRvRenderView, TRvRenderPrinter and TRvNDRWriter. Needless to say I am confused at this point.</p>\n\n<p>I can call up <code>RvSystem1.Execute;</code> It pops up with a preview window, but there is nothing in it - totally blank.</p>\n\n<p>Although Rave Report Designer View is easy to use, the same can't be said of using it with your Delphi program.</p>\n\n<p>Any input or help will be greatly appreciated.</p>\n"},{"tags":["delphi","wmi","hdd"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":1,"view_count":171,"score":5,"question_id":13215713,"title":"Get Real HDD Serial Number with Delphi","body":"<p>I am trying to make delphi program Server And Client so To Secure my App and To Make Sure all user are under control i should give them a unique Key that can't be change to not lose them Handle, So i think it should be HDD Serial Number + Bios SN , but i remember that Bios Can Be Change When remove motherboard Battery so it will not be work . \nso my choose now is HDD Real serial number i am try this code below to get it but it didn'r work </p>\n\n<pre><code>    unit Unit2;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, StdCtrls,WbemScripting_TLB,ActiveX;\n\ntype\n  TForm4 = class(TForm)\n    Button1: TButton;\n    procedure Button1Click(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form4: TForm4;\n\nimplementation\n\n{$R *.dfm}\n\nfunction GetWMIstring (wmiHost, wmiClass, wmiProperty : string):string;\nvar  // These are all needed for the WMI querying process\n  Locator:  ISWbemLocator;\n  Services: ISWbemServices;\n  SObject:  ISWbemObject;\n  ObjSet:   ISWbemObjectSet;\n  SProp:    ISWbemProperty;\n  Enum:     IEnumVariant;\n  Value:    Cardinal;\n  TempObj:  OleVariant;\n  SN: string;\nbegin\n  try\n  Locator := CoSWbemLocator.Create;  // Create the Location object\n  // Connect to the WMI service, with the root\\cimv2 namespace\n   Services :=  Locator.ConnectServer(wmiHost, 'root\\cimv2', '', '', '','', 0, nil);\n  ObjSet := Services.ExecQuery('SELECT * FROM '+wmiClass, 'WQL',\n    wbemFlagReturnImmediately and wbemFlagForwardOnly , nil);\n  Enum :=  (ObjSet._NewEnum) as IEnumVariant;\n  while (Enum.Next(1, TempObj, Value) = S_OK) do\n  begin\n    SObject := IUnknown(tempObj) as ISWBemObject;\n    SProp := SObject.Properties_.Item(wmiProperty, 0);\n    if VarIsNull(SProp.Get_Value) then\n      result := ''\n    else\n    begin\n      SN := SProp.Get_Value;\n      result :=  SN;\n    end;\n  end;\n  except // Trap any exceptions (Not having WMI installed will cause one!)\n   on exception do\n    result := '';\n   end;\nend;\n\nprocedure TForm4.Button1Click(Sender: TObject);\nvar\nx:string;\nY:string;\n\nbegin\n\n\n    X:=GetWMIstring('','Win32_BIOS','SerialNumber');\n    Y:=GetWMIstring('','Win32_DiskDrive\"','SerialNumber')     ;\n\n    ShowMessage(x+';'+y);\nend;\n\nend.\n</code></pre>\n\n<p>*<strong><em>so please can any one correct my Code or Give me another idea \nBest regard's</em>*</strong> </p>\n"},{"tags":["image","delphi","graphics","delphi-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":144,"score":3,"question_id":13210197,"title":"Fake, animated web 2.0-like tooltip in Delphi","body":"<h2>Initial Explanation</h2>\n\n<p>There are certain key areas in my delphi application that I need to highlight. I decided that standard tooltips won't cut it, and dialog boxes are too annoying to be of helpful.</p>\n\n<p>Web 2.0 tooltips (like <a href=\"http://jqueryfordesigners.com/demo/coda-bubble.html\" rel=\"nofollow\">this Coda-style bubble example</a>) are less intrusive &amp; much better for my specific need.</p>\n\n<h2>My attempt to solve the problem</h2>\n\n<p>Initially I custom designed a tooltip image, put it in a DevExpress' TdxImage component (which is basically a TImage with transparent PNG support) along with a label and used them as a custom tooltip but...</p>\n\n<p><strong>My problem is</strong> How can I animate as in normal/web tooltips? I tried AnimateWindow(). It worked, but <strong>text didn't appear</strong> at all (text isn't drawn, only the image is shown)</p>\n\n<pre><code>// Prepare tooltip text\ncxTooltipLabel.Caption := 'Translated or dynamic tooltip text';\ncxTooltipLabel.Visible := True;\ncxTooltipLabel.BringToFront;\n\n// Load custom tooltip image\ncxImage.Picture.LoadFromFile(ExePath + 'data\\tooltip.png');\n\n// Show tooltip!\nAnimateWindowProc(cxImage.Handle, 250, AW_CENTER OR AW_ACTIVATE);\n</code></pre>\n\n<p>It's important to note that image is a <strong>transparent PNG</strong>, I'm willing to use any solution other than AnimateWindowProc() as long as it's <strong>not heavy</strong> and give me <strong>smooth animation as in the <a href=\"http://uhleeka.com/demo/bubbletip/\" rel=\"nofollow\">Coda tooltips</a></strong></p>\n\n<p>Any idea guys?</p>\n"},{"tags":["algorithm","delphi","sets"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1598,"score":1,"question_id":832203,"title":"How to get the highest value from a Delphi set?","body":"<p>Is there any way to extract the highest (or lowest) value in a set?  For example, if I have the following \"set of byte\":</p>\n\n<pre><code>[0, 1, 2, 4, 5, 28, 199]\n</code></pre>\n\n<p>is there any function I could run on that and get back 199 as the result?</p>\n\n<p>EDIT: There's an obvious brute-force solution involving a for..in loop.  If possible, I'd like to find a better way than that.</p>\n"},{"tags":["delphi","ide","delphi-xe2"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":591,"score":2,"question_id":8941092,"title":"Delphi XE2 : F12 switching between unit and form intolerably slow","body":"<p>This one has been annoying me for a long time and having switched directly from D2007 to XE2 a few months back I can't vouch for when this may have started, but on D2007 I didn't have the issue.</p>\n\n<p>The larger a unit grows, the slower it becomes to use F12 to switch between unit and form when code changes have been made. Even if you undock the form designer (back to D7 format), just clicking back into the form when code has been changed causes the BDS.exe to max out on CPU for a long time. In my case, on my largest form (30,000 lines) this can be over a minute. I'm not sure what checking is going on when reactivating the form, but if the IDE has been \"told\" that all is uptodate, then the switch is instantaneuos. My workaround is therefore to Ctrl+F9 to compile the form before reactivating the form. The time taken to compile is only a few seconds. I can then switch instantly to the form without issue. Compare that to the minute or more wait I endure if I don't compile before switching...  </p>\n\n<p>So, what are the possibilities, apart from reducing the unit size ?!</p>\n"},{"tags":["delphi","popupmenu","control-panel"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":177,"score":0,"question_id":13045179,"title":"How do I get a list of control-panel items and then execute one?","body":"<p>1. How can I get a list of control panels, including their names and icons, so I can create a menu like the one the Start menu shows?</p>\n\n<p><a href=\"http://i.stack.imgur.com/qVikF.png\" rel=\"nofollow\"><img src=\"http://i.stack.imgur.com/YNqmc.png\" alt=\"control panel fly-out from the Start menu\"></a></p>\n\n<p>2. When I click an entry, how do I execute the corresponding control panel?</p>\n\n<p>By the way, what controls are used to do this kind of PopupMenu? But it has right click event.</p>\n\n<p>update :</p>\n\n<p>I use PItemIDList to get a Folder:</p>\n\n<pre><code>var:\nPIDL, TempPIDL: PItemIDList;\nPath: array[0..MAX_PATH] of Char;\nFI: SHFILEINFOW;\nbegin\nSHGetSpecialFolderLocation(0, CSIDL_FAVORITES, PIDL);\nSHGetPathFromIDList(PIDL , Path);\nMemo1.Lines.Add(Path);\nSHGetFileInfo(LPCTSTR(PIDL), 0, FI, SizeOf(FI), SHGFI_PIDL or SHGFI_DISPLAYNAME or SHGFI_ICON);\nMemo1.Lines.Add(FI.szDisplayName);\nImage1.Picture.Icon.Handle := FI.hIcon;\n</code></pre>\n\n<p>it display normal , but when I change CSIDL_FAVORITE to CSIDL_CONTROLS , I always get error .\nthis is a wrong way to get controls panel items ?\nI also use another method by use CPL\ncopy from <a href=\"http://delphi.about.com/library/weekly/aa062403b.htm\" rel=\"nofollow\">here</a><br>\nBut it can not display complete Items.</p>\n"},{"tags":["delphi","sync","google-calendar","ical"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":535,"score":1,"question_id":9701952,"title":"How to perform auto synchronization between Google Calendar and an iCal file","body":"<p>I use DevExpress Express Scheduler, that since the latest major release has the possibility to export/import to/from a <a href=\"http://en.wikipedia.org/wiki/Calendar_%28application%29#Features\" rel=\"nofollow\">iCal</a> file.</p>\n\n<p>Anyway, now that the iCal file is ready, I would like to automatically synchronise with <a href=\"http://en.wikipedia.org/wiki/Google_Calendar\" rel=\"nofollow\">Google Calendar</a>.</p>\n\n<p>Manually of course I can go to Google Calendar and choose \"Import from file\" or \"Export to file\". But how do I achieve that programmatically?</p>\n\n<p>My needs are:</p>\n\n<ol>\n<li>Login to Google account</li>\n<li>Choose a specific calendar (knowing its name, or retrieve a list of calendars and choose one)</li>\n<li>Perform import from a file or export to a file</li>\n</ol>\n\n<p>How can I do it?</p>\n"},{"tags":["string","delphi","memory","stream"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":441,"score":-2,"question_id":10462508,"title":"Convert a \"TMemoryStream\" to \"String\" and vice-versa","body":"<p>I'm downloading a file from the web using IdHttp, like this:</p>\n\n<pre><code>var\n MS: TMemoryStream;\n\nprocedure Test1;\nvar\n Http: TIdHTTP;\nbegin\nHttp := TIdHTTP.Create(nil);\n  try\n    MS := TMemoryStream.Create;\n    try\n      Http.Get('http://www.test.com/test.exe', MS);\n    finally\n      MS.Free;\n    end;\n  finally\n    Http.Free;\n  end;\nend;\n</code></pre>\n\n<p>Consequently, the downloaded file/stream (don't know how to pronounce it) will be in <code>MS.Memory</code>.</p>\n\n<p>Well, I want to get or convert the <code>MS.Memory</code> to a string, and vice-versa.</p>\n\n<p>I've tried the functions posted by Rob Kennedy in this question: <a href=\"http://stackoverflow.com/questions/732666/converting-tmemorystream-to-string-in-delphi-2009\">Converting TMemoryStream to String in Delphi 2009</a></p>\n\n<p>But I just got the string: \"<strong><code>MZP</code></strong>\"</p>\n\n<p>Can anyone help-me?</p>\n"},{"tags":["delphi","winapi","delphi-xe2","ribbon"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":13217347,"title":"Restrict window movement to parent window area","body":"<p>I'm working on a delphi program using the TRibbon and launching separate exe files.\nOnce I have executed the external application (with CreateProcessA() ) I set its parent as the form with the ribbon:</p>\n\n<pre><code>wHandle := FindWindow('MainRibbonForm');\nWinapi.Windows.SetParent(wHandle,self.Handle);\n</code></pre>\n\n<p>All considered, this works alright, but the problem is that the application forms can be moved over the TRibbon in the main form. I was thinking about restricting the form's movement within the main application but how can I take into account the ribbon?</p>\n"},{"tags":["delphi","filter","tclientdataset"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":13212806,"title":"filtering record in client dataset where the record is false","body":"<p>the sI have a clientdataset boolean field named \"<em>Controled</em>\".</p>\n\n<p>I want to filter not controled records.</p>\n\n<p>In Delphi XE (VCL) I was using these code and it was working:</p>\n\n<pre><code>ClientDataSet1.Filter := 'Controled = 0';  \nClientDataSet1.Filtered := True;\n</code></pre>\n\n<p>In Delphi XE2 (FMX), this code do not work but I can filter controled records (<code>Controled =1</code>) and it work but I want the un-controled records.</p>\n\n<p>Any Idea or it's a but in the new version?</p>\n"},{"tags":["delphi","delphi-xe2","firemonkey","tstringgrid","livebindings"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":784,"score":3,"question_id":8591818,"title":"How to show more than 200 rows in TStringGrid using LiveBindings?","body":"<p>I have a <code>TDataSource</code> that is backed by a <code>TClientDataset</code> bound to a <code>TStringGrid</code>. I did this by right-clicking on the grid, selecting \"<code>Link to DB Datasource...</code>\", and selecting the DataSource. This setup the LiveBindings for me.</p>\n\n<p>When I run the application, the grid only fills with 200 rows, even though there are 5000 records in the dataset.</p>\n\n<p>I'm unable to find any documentation regarding how to change the number of rows displayed or the proper way to allow the user to scroll through all of the data.</p>\n\n<p>I did find the hard coded <code>200</code> value in <code>TBindScopeDBEnumerator.Create</code> in the unit <code>Data.Bind.DBScope</code>, and when I increase it to <code>10000</code>, I see all 5000 rows in the grid, but this seems like a hack.</p>\n\n<p>What's the proper way to show more than 200 rows in a TStringGrid?</p>\n"},{"tags":["delphi","lazarus"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":108,"score":-1,"question_id":13215561,"title":"Lazarus - For loop limit","body":"<p>I have a code as below and I can't increase for loop variable,</p>\n\n<pre><code>procedure TForm1.FormCreate(Sender: TObject);\nvar\nTextLines :  TStringList;\nTextWords :  TStringList;\nTextChars :  TStringList;\ni         :  Integer;\nj         :  Integer;\njj        :  Integer;\nXPos      :  Integer;\nTgBx      :  TToggleBox;\nlength_e  :  Extended;\nlength_i  :  integer;\nA: integer;\n\nbegin\n     KeyPreview:=True;\n     num := 0;\n\n     TextLines := TStringList.Create;\n     TextWords := TStringList.Create;\n     TextChars := TStringList.Create;\n     XPos := 10;\n\n     i := 0; // Big key loop\n     jj := 0; // Key counter\n     TextLines := TStringList.Create;\n     TextLines.LoadFromFile('c:\\001.txt');\n\n     try\n         begin\n             Split(' ', TextLines[0], TextWords) ;\n\n             Split(':', TextWords[0], TextChars);\n\n\n             for j := 0 to 2 do // HERE'S THE PROBLEM\n             begin\n                 length_e := Length(TextWords[j]);\n                 length_i := Trunc(length_e / 2);\n\n                 for i := 0 to length_i - 1 do\n                 begin // Big keys\n                    TgBx := TToggleBox.Create(Self);\n                    TgBx.Caption := TextChars[i];\n                    TgBx.Parent := Self;\n                    TgBx.Font.Size := 30;\n                    TgBx.Font.Quality := fqAntialiased;\n                    TgBx.Visible := true;\n                    TgBx.Top := 50;\n                    TgBx.Left :=  XPos;\n                    TgBx.Width := 60;\n                    TgBx.Height := 60;\n                    CurrentItem[jj] := TgBx.Caption;\n                    TgBx.Enabled := false;\n                    XPos := XPos + 65;\n                    jj := jj + 1;\n                 end; // Word has been output\n\n                 // Small key\n                 TgBx := TToggleBox.Create(Self);\n                 TgBx.Caption := 'boşluk';\n                 TgBx.Parent := Self;\n                 TgBx.Font.Size := 10;\n                 TgBx.Font.Quality := fqAntialiased;\n                 TgBx.Font.Style:=Font.Style + [fsBold];\n                 TgBx.Visible := true;\n                 TgBx.Top := 87;\n                 CurrentItem[jj] := ' ';\n                 TgBx.enabled := false;\n\n                 TgBx.Left :=  XPos;\n                 xPos := xPos + 110;\n\n                 jj := jj + 1;\n             end;\n         end;\n     finally\n          TextLines.Free;\n     end;\nend;        \n</code></pre>\n\n<p>When I make it:\n    for j := 0 to 3 do</p>\n\n<p>I'm getting error:\n    Project project1 raised exception class 'External: SIGSEGV'\n    At address 403A61</p>\n\n<p>I'm not able to check TextWords using WriteLn or ShowMessage because these give some other errors.</p>\n\n<p>Edit: How can I debug my code using WriteLn or Show Message? Because WriteLn gives this error: Error: Can't read or write variables of this type</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":132,"score":1,"question_id":13210310,"title":"TPanel Transparent","body":"<p>i need to use transparent tpanel in my form. Who can suggest me a good component for it, possibly free? If not is much long is possible post the code or some link about it? Thanks very much.\nMarcello.</p>\n"},{"tags":["delphi","shell","types","delphi-xe"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":337,"score":3,"question_id":4745518,"title":"Which version of IMalloc should I use in Delphi?","body":"<p>I'm trying to refactor a Delphi 5 project in Delphi XE, to do that I need to fix some errors in a unit called BrowseDr. The error I'm getting is </p>\n\n<pre><code>[DCC Error] BrowseDr.pas(1033): E2033 Types of actual and formal var parameters\n must be identical\n\nline 1033:   SHGetMalloc(FShellMalloc);\n</code></pre>\n\n<p>\"MyShlObj\":</p>\n\n<pre><code>//SHGetMalloc declaration \nfunction SHGetMalloc(var ppMalloc: IMalloc): HResult; stdcall;\n</code></pre>\n\n<p>Now the IMalloc used in the declaration of FShellMalloc is derived from a <code>OLE2.IMalloc</code> \nwhile the one used in \"MyShlObj\" is from <code>ActiveX.IMalloc</code>.</p>\n\n<p>Is it possible alter one of them? \nIf yes, is it recommended?</p>\n"},{"tags":["delphi","package","pascal"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13198749,"title":"Delphi package install error - DCU not found","body":"<p>I am trying to install a Delphi package from the VST SDk, my problem is that it says a .dcu is missing.\nThe .dcu is not missing, and before installing the package, it doesn't exist, but is created by the \nIDE during the installation, so it's not precompiled from a former version of Delphi. The .pas file doesn't appear to be incomplete. All the other files appear to be installing just fine, this however is giving me a great load of trouble. I hope someone might help me :) \nIm using Delphi 2010 btw. </p>\n\n<p>Thanks in advance :D\n<a href=\"http://postimage.org/image/viz7mah51/\" rel=\"nofollow\">Image showing my files and errors</a>\n<a href=\"http://sourceforge.net/projects/delphiasiovst/files/Source%20Code/\" rel=\"nofollow\">Here's the SDK - im using 1.3</a></p>\n"},{"tags":["delphi","components","delphi-xe2","design-time"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":104,"score":0,"question_id":13209787,"title":"Detecting insertion of new components at design-time in Delphi","body":"<p>How can my Delphi component detect at design time if any other component is being dropped on the form?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":986,"score":3,"question_id":10314757,"title":"Delphi Converting Array Variant to String","body":"<p>In my delphi program I am communication with a webservice.</p>\n\n<p>On WSDL import I got the following function created-</p>\n\n<pre><code>    function  call(const sessionId: WideString; const resourcePath: WideString;\n const args: Variant): Variant; stdcall;\n</code></pre>\n\n<p>now when I call this inside my code , I want to see what is the returned value</p>\n\n<pre><code>var\np:WideString;\nv:variant;\nVarArray:variant;\nbegin\n\n   //varArray := VarArrayCreate([0,50],varVariant);\n\n   v := (httprio1 as  Mtest).call(a,'giftgit.gift', '28184');\n\n\n   //p := VarArrayget(V,[1] ) ;\n   p := vartostr(v[1]);\n</code></pre>\n\n<p>I get this error in the last line</p>\n\n<p>Could not convert variant of type (Array Variant) into type (String)</p>\n\n<p>I tried with varArray but same problem.\nhow can I solve this ?</p>\n\n<p>Thank you</p>\n"},{"tags":["forms","delphi","parent-child","lazarus"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":13195827,"title":"Lazarus pascal/Delphi - Child form is not editable","body":"<p>I'm creating a new instance of a form and trying to show it as a child from on a PANEL. But The form doesn't seem to be usable. I mean I cannot edit any textbox. But there are other controls like the tree and button that <strong>seem</strong> clickable.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>procedure TForm1.ProcfrmSetupItemCategories;\nvar\n  NewForm: TfrmSetupItemCategories;\nbegin\n  NewForm:=TfrmSetupItemCategories.Create(BodyPanel);\n\n  NewForm.Parent := BodyPanel;\n  NewForm.Top:=5;\n  NewForm.Left:=5;\n  NewForm.Show;\nend;\n</code></pre>\n\n<p>But if I remove the line <code>NewForm.Parent := BodyPanel;</code> the form is editable but it goes out of the parent form/Panel.</p>\n\n<p>Also when the parent is set, the child form is not active (looking at the title bar)</p>\n\n<p>Am I missing something? Please advice.\nThanks!</p>\n"},{"tags":["delphi","firebird","bde"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":114,"score":1,"question_id":13210442,"title":"Delphi BDE example needed","body":"<p>I'm having a hard time locating a simple example of how to use Delphi+BDE for database access, the company I am joining uses this.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":128,"score":0,"question_id":13209506,"title":"How to run code in Design Time?","body":"<p>How can I run some code to change something on a Form in design time?</p>\n\n<p>I have tried this but this works only in Run Time:</p>\n\n<pre><code>constructor TForm1.Create(AOwner: TComponent);\nbegin\n  inherited;\n  Form1.Font.Color := clRed;\nend;\n</code></pre>\n\n<p>I know there are \"magic\" procedures like \"Register\" and there is \"initialization\" but I don't think these can help here. </p>\n\n<p>Please note that my point is not just changing the font color to red but rather doing complex change of the form appearance and I want to see in Design Time.</p>\n"},{"tags":[".net","web-services","delphi","winapi","com"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":592,"score":4,"question_id":5881070,"title":"How to access a .Net web service from a Delphi Win32 application?","body":"<p>What options do I have if I want to enable a Delphi Win32 application to consume a .Net webservice?</p>\n\n<p>Is it possible to interact directly? Or do I have to resort to a middleman-software communicating to the Delphi application per COM for instance?</p>\n\n<p>The Delphi application in question is written in Delphi 2006 but is planned to be updated to Delphi XE soon.</p>\n"},{"tags":["delphi","delphi-2009","firebird2.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13208175,"title":"Delphi2009, IBX and firebird with utf8 give a division by zero error","body":"<p>I'm using Delphi 2009 with firebird 2.5 and with IBXpres I'm getting the \"Division by zero\" error. </p>\n\n<p>The firebird's DB is created with charset <code>UTF8</code> and collation <code>UNICODE_CI</code>.</p>\n\n<p>I already modified the IBSQL.pas, recompiled the ibxpress120.bpl and, at design time, everything works. <a href=\"http://qc.embarcadero.com/wc/qcmain.aspx?d=69856\" rel=\"nofollow\">This is the link with the fix</a></p>\n\n<p>The problem is that I still get the error at runtime when I oen my dataset:</p>\n\n<pre><code>MyIBDataSet.Open;\n</code></pre>\n\n<p>If I use <code>UNICODE_FSS</code> for the charset, everything works, but I can not set the collation to \"case insensitive\"</p>\n\n<p>Any workaround I'm not aware of?</p>\n"},{"tags":["sql","delphi","delphi-xe3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13207224,"title":"Running a query and displaying result it in a TEdit","body":"<p>I have a <code>TComboBox</code> containing a list of names gathered from my database. Next to it is a <code>TEdit</code> that I intend on using for the purposes for displaying the ID number associated to each person. </p>\n\n<p>Since firstName and lastName are separate fields within the table, but displayed together in the TCombobox I have written a small section to split the firstName and lastName into two separate variables:</p>\n\n<blockquote>\n<pre><code> pos := AnsiPos(' ', cbStudents.Text); \n firstName := Copy(cbStudents.Text, 0, pos-1);\n lastName := Copy(cbStudents.Text, pos+1, Length(cbStudents.Text));\n</code></pre>\n</blockquote>\n\n<p>Then I execute the SQL code:</p>\n\n<pre><code>  try\n    query.Open;\n    query.SQL.Add('Select studentID');\n    query.SQL.Add('From student');\n    query.SQL.Add('Where firstName = ' + StrToQuote(firstName));\n    query.SQL.Add('And lastName = ' + StrToQuote(lastName));\n    editID.Text := query\n  finally\n    query.Free;\n  end;\n</code></pre>\n\n<p>Note: <code>StrToQuote</code> encapsulates the variable firstName and lastName with double quotes (\" \")</p>\n\n<p>The error that I am receiving is:</p>\n\n<p>Argument out of range</p>\n\n<p>What am I doing wrong? Thank you in advanced for the help.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":144,"score":4,"question_id":13105660,"title":"Save file> folder with Memo delphi","body":"<p>I'm french so sorry for my little language...</p>\n\n<p>So, my project is here <a href=\"http://stackoverflow.com/questions/13003927/memo-and-create-file-and-folder\">Memo and create file and folder?</a> </p>\n\n<p>i have a problem with my code :</p>\n\n<pre><code>var\n  path: String;\n  F: TextFile;\n  i, e: Integer;\nbegin\n  for i := 0 to Memo1.Lines.Count - 1 do\n  begin\n    if Length(Memo1.Lines[i]) &gt; 0 then\n    begin\n      if Memo1.Lines[i][1] = '\\' then // first character for file\n        if Pos('.', Memo1.Lines[i]) &gt; 0 then // confirm file\n        begin\n          path := extractfilepath(Edit1.Text) + Memo1.Lines[i];\n          // showmessage(path);\n          if not FileExists(path) then\n          begin\n            AssignFile(F, path);\n            Rewrite(F);\n            CloseFile(F);\n          end;\n        end;\n      e := Length(Memo1.Lines[i]);\n      case Memo1.Lines[i][e] of // last character for folder\n        '\\':\n          begin\n            path := extractfilepath(Edit1.Text) + Memo1.Lines[i];\n            if not DirectoryExists(path) then\n              ForceDirectories(path); // create folder\n          end;\n      end;\n    end;\n  end;\nend;\n</code></pre>\n\n<p>my structure in Tmemo is : </p>\n\n<p><img src=\"http://i.stack.imgur.com/h8fKt.png\" alt=\"structure of tmemo\"></p>\n\n<p>and my bad result: </p>\n\n<p><img src=\"http://i.stack.imgur.com/QY8dK.png\" alt=\"bad result\"></p>\n\n<p>i test first and last character for know what is it file or folder and my problem is file saved in currentPath, no in folder1:</p>\n\n<p>Dir:</p>\n\n<pre><code> folder1-&gt;file1.txt \n  folder2 -&gt;file2.txt and file2-3.txt\n   etc..\n</code></pre>\n\n<p>can you help me please?</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":191,"score":1,"question_id":8293990,"title":"Shortcut for switching between edit windows in Delphi IDE?","body":"<p>Is there a shortcut to switch between two edit windows in the Delphi IDE?</p>\n\n<p>Delphi XE here.</p>\n"},{"tags":["java","delphi","class","jni"],"answer_count":6,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":1661,"score":5,"question_id":2997495,"title":"Using a java class from Delphi","body":"<p>I need to use the logic contained in some java classes. I found JNI, but that project seems not updated recently.</p>\n\n<p>Is there a way to use it in a Delphi native application? I use Delphi 2009.</p>\n"},{"tags":["delphi","xmpp","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13153289,"title":"xmpp - how i get notification when my friend logged in, he is in my roster list - delphi","body":"<p>after one  day of searching and reading rfc's i haven't found any tip in this subject.</p>\n\n<p>i wrote delphi component to access openFire server and all steps until now is good, but i face one problem is:</p>\n\n<p>i have many friends in my roster list ,as example my Account Is <strong>\"A@localhost\"</strong>  when account <strong>\"B@localhost\"</strong> logged in I haven't get any notification according to this. </p>\n\n<p>the \"B\" account is added in my roster list .</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["delphi","datetime","dictionary","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":118,"score":1,"question_id":13201914,"title":"Using TTime as the key of a TDictionary","body":"<p>I want to use <code>TTime</code> as the key of a <code>TDictionary</code>, but I encountered a problem with TTime comparisons and therefore I am seeking for an alternative to this. </p>\n\n<p>My particular problem is that I am trying to build some kind of agenda with the hours on the side, represented with a <code>TTime</code> object and I store them in a <code>TDictionary</code> alongside their top coordinate. Given the hour of the task I want to draw on the grid, I can retrieve its top coordinate easily from the dictionary based on the hour of the tasks. Unfortunately, it does not work because <a href=\"http://stackoverflow.com/questions/13201535/why-do-ttime-comparisons-give-unexpected-results\"><code>TTime</code> comparisons give unexpected results</a>. I cannot reliably retrieve the coordinate from the dictionary with a <code>TTime</code>.</p>\n\n<ul>\n<li>How would you solve this problem?</li>\n<li>Would you skip the TDictionary thing altogether and go with another approach?</li>\n</ul>\n"},{"tags":["delphi","firebird"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":95,"score":2,"question_id":13202439,"title":"how to refresh query on client when server has update whithout disconnected and rconnect","body":"<p>I developed an Client/Server data base application, using firebird IBdatabase, IBquery. I need to know how to refresh the data on the server AND client when one of them has updat/insert query. The reason being that when I run a query on the client, after I inserted records into a table, the new records do not reflect in the queries. until i disconnected and rconnect agin\nIm using a firebird db, with interbase vcl, developing in Delphi XE2</p>\n"},{"tags":["delphi","gdi","resource-leak","eoutofresources"],"answer_count":6,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":2743,"score":7,"question_id":2180345,"title":"Hunting down EOutOfResources","body":"<p>Question:</p>\n\n<p>Is there an easy way to get a list of <em>types</em> of resources that leak in a running application?  IOW by connecting to an application ? </p>\n\n<p>I know memproof can do it, but it slows down so much that the application won't even last a minute. Most taskmanager likes can show the number, but not the type.</p>\n\n<p>It is not a problem that the check itself is catastrophic (halts the app process), since I can check with a taskmgr if I'm getting close (or at least I hope)</p>\n\n<p>Any other insights on resource leak hunting (so not memory) is also welcomed.</p>\n\n<p>Background:</p>\n\n<p>I've an Delphi 7/2006/2009 app (compiles with all three) and after about a few week it starts acting funny. However only on one of the places it runs, on several other systems it runs till the power goes out.</p>\n\n<p>I've tried to put in some debug code to narrow the problem down. and found out that the exception is EOutofResources on a save of a file. (the file save can happen thousands of times a day).</p>\n\n<p>I have tried to reason out memory leaks (with fastmm), but since the dataflow is quite high (60MByte/s from gigabit industrial camera's), I can only rule out \"creeping\" memory leaks with fastmm, not quick flashes of memoryleaks that exhaust memory around the time it happens. If something goes wrong, the app fills memory in under half a minute.,</p>\n\n<p>Main suspects are filehandles that are somehow left on some error and  TMetafiles (which are streamed to these files). Minor suspects are VST, popupmenu and tframes</p>\n\n<p>Updates: </p>\n\n<p>Another possible tip: It ran fine for two years with D7, and now the problems are with Turbo Explorer (which I use for stable projects not converted to D2009 ).</p>\n\n<p>Paul-Jan: Since it only happens once a week (and that can happen at night), information acquisition is slow. Which is why I ask this question, need to combine stuff for when I'm there thursday. In short: no I don't know 100% sure. I intend to bring the entire Systemtools collection to see if I can find something (because then it will be running for days). There is also a chance that I see open files. (maybe should try to find some mingw lsof and schedule it)</p>\n\n<p>But the app sees very little GUI action (it is an machine vision inspection app), except screen refresh +/- 15/s which is tbitmap stretchdraw + tmetafile, but I  get this error when saving to disk (TFileStream) handles are probably <i>really</i> exhausted. However in the same stream, TMetafile is also savetostreamed, something which later apps don't have anymore, and they can run from months.  </p>\n\n<p>------------------- UPDATE</p>\n\n<p>I've searched and searched and searched, and managed to reproduce the problems in-vitro two or three times.  The problems happened when memusage was +/- 256MB (the systems have 2GB), user objects 200, gdi objects 500, not one file more open than expected ).</p>\n\n<p>This is not really exceptional. I do notice that I leak small amounts of handles, probably due to reparenting frames (something in the VCL seems to leak HPalette's), but I suspect the core cause is a different problem. I reuse TMetafile, and .clear it inbetween.  I think clearing the metafile doesn't really (always?) resize the resource, eventually each metafile in the entire pool of tmetafile at maximum size, and with 20-40+ tmetafiles (which can be several 100ks each) this will hit the desktop heap limit. </p>\n\n<p>That's theory, but I'll try to verify this by setting the desktop limit to 10MB at the customers, but it will be several weeks before I have confirmation if this changes anything. This theory also confirms why this machine is special (it's possible that this machine naturally has slightly larger metafiles on average). Occasionally freeing and recreating a tmetafile in the pool might also help.</p>\n\n<p>Luckily all these problems (both tmetafile and reparenting) have already been designed out in newer generations of the apps.</p>\n\n<p>Due to the special circumstances (and the fact that I have very limited test windows), this is going to be a while, but I decided to accept the desktop heap as an example for now (though the GDILeaks stuff was also somewhat useful).</p>\n\n<p>Another thing that the audit revealed GDI-types usage in a thread (though only saving tmetafiles (that weren't used or connected otherwise) to streams.</p>\n\n<p>------------- Update 2.</p>\n\n<p>Increasing the desktop limit only seemed to minorly increase the time till the problem occurred.</p>\n\n<p>Unfortunately, I won't be able to follow up on this further, since the machines were updated to a newer version of the framework that doesn't have the problem.</p>\n\n<p>In summary I can only state what the three core modifications were going from the old to the new framework: </p>\n\n<ul>\n<li>I no longer change screens by reparenting frames. I now work with forms that I hide and show. I changed this since I also had very rare crashes or exceptions (that could be clicked away) due to this. The crashes were all while operating the GUI though, not spontaneously like the main problem</li>\n<li>The routine where the crash happened dealt with TMetafile. TMetafile has been designed out, and replace by a simpler own made format. (basically arrays with Opengl vertices)</li>\n<li>Drawing no longer happened with tbitmap with a tmetafile overlay strechdrawn over it, but using OpenGL.</li>\n</ul>\n\n<p>Of course it could be something else too, that got changed in the rewrite of the above parts, fixing some very nasty detail bug. It would have to be an extremely bad one, since I analysed the above system as much as I could.</p>\n\n<p><strong>Updated nov 2012</strong> after some private mail discussion: In retrospect, the next step would have been adding a counter to the metafiles objects, and simply reinstantiate them every x * 1000 uses or so, and see if that changes anything. If you have similar problems, try to see if you can somewhat regularly destroy and reinitialize long living resources that are dynamically allocated.</p>\n"},{"tags":["delphi","datetime","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":101,"score":4,"question_id":13201535,"title":"Why do TTime comparisons give unexpected results?","body":"<p>I have observed some kind of weird behaviour regarding the <code>EncodeDateTime</code> and <code>EncodeTime</code> methods and I am seeking some explanation.</p>\n\n<pre><code>procedure SomeTestCase;\nvar\n    time: TTime;\n    dateTime: TDateTime;\nbegin\n    time := EncodeTime(8, 0, 0, 0);\n    date := EncodeDateTime(2012, 11, 2, 8, 0, 0, 0);\n\n    Assert(time = TimeOf(date)); //Fails\nend;\n</code></pre>\n\n<p>What I've found is that <code>date</code>'s hour portion evaluates to <code>7:59:59</code> instead of <code>8:00:00</code>. But if I set the hour portion of <code>time</code> and <code>date</code> to 9, the assert passes and <code>date</code> evaluates to the expected value. Some hours work while some others don't. Can somebody explain me what is going on?</p>\n"},{"tags":["delphi","freepascal","object-pascal","turbo-pascal"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":133,"score":1,"question_id":13198650,"title":"In-memory layout of array in Turbo Pascal","body":"<p>We have an old application in Turbo Pascal which can save its internal state into a file, and we need to be able to read/write this file in a C# application.</p>\n\n<p>The old application generates the file by dumping various in-memory data structures. In one place, the application just dumps a range of memory, and this memory range contains some arrays. I am trying to noodle out the purpose of the bytes immediately preceding the actual array elements. In particular, the first two items in the block can be represented as:</p>\n\n<pre><code>type\n  string2 = string[2];\n  stringarr2 = array[0..64] of string2;\n  string4 = string[4];\n  stringarr4 = array[0..64] of string4;\n</code></pre>\n\n<p>In the data file, I see the following byte sequence:</p>\n\n<pre><code>25 00 02 02 41 42 02 43 44 ...\n</code></pre>\n\n<p>The <code>25</code> is the number of elements in the array. The <code>02 41 42</code> is the first string element, \"AB\"; the <code>02 43 44</code> is the second string element, \"CD\", and so on. I don't know what the <code>00 02</code> between the array element count and the first array element refers to. It's possible the array element count is <code>25 00</code> and the element size is <code>02</code>, but each array element is actually 3 bytes in size.</p>\n\n<p>In the place in the file where the array of 4-character strings starts, I see the following:</p>\n\n<pre><code>25 00 04 00 00 04 41 42 43 44 04 45 46 47 48\n</code></pre>\n\n<p>Again, there's the <code>25</code> which is the number of elements in the array; <code>04 41 42 43 44</code> is the first element in the array, \"ABCD\", and so on. In between there are the bytes <code>00 04 00 00</code>. Maybe they are flags. Maybe they are some kind of indication of the shape of the array (but I don't see how <code>02</code> and <code>04</code> both indicate a one-dimensional array).</p>\n\n<p>I don't have access to Turbo Pascal to try writing different kinds of arrays to a file, and don't have authorization to install something like Free Pascal, so my opportunities for experimentation along those lines are very limited.</p>\n\n<p>These arrays are not dynamic, since Turbo Pascal didn't have them.</p>\n\n<p>Thanks in advance for any dusty memories.</p>\n"},{"tags":["delphi","components","delphi-xe","teamwork"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":180,"score":6,"question_id":12920400,"title":"How to handle project specific components in Delphi?","body":"<p>Let's say we have a team that works on many different projects. Each team member uses different set of visual/non-visual controls/components during it's development cycle. Since Delphi requires each  component to be compiled and installed globally in the IDE, how to manage this situation while working with project which was started by the other team member? </p>\n\n<p>It would be great if I could checkout the sources of a project from the version control and have the ability to compile it immediately. I don't care or sometimes don't know what visual or non-visual components are required for this project, I guess they all should be included in the project sources. </p>\n\n<p>Maybe there are some tools which could read main project file or directory and compile/install all the needed components on project loading (and uninstall them when project is closed)?  </p>\n\n<p>How do you handle this issue in Delphi? </p>\n"},{"tags":["delphi"],"answer_count":6,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2507,"score":3,"question_id":806534,"title":"Delphi: F2084 Internal Error T2575","body":"<p>Do anybody know what this error means?</p>\n\n<p>It comes and goes in one of my units. Adding a space or a lineshift will sometime solve it, sometime not...</p>\n\n<p>I'm using Delphi 2007.</p>\n"},{"tags":["delphi","delphi-2010","custom-draw","stringgrid"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":130,"score":6,"question_id":13032146,"title":"Add graphical bar to a StringGrid col","body":"<p>Using Delphi 2010 and a TStringGrid component, I currently display five filds from a database query.</p>\n\n<p>Here is a simplied example of what i am doing</p>\n\n<p>//set up the grid</p>\n\n<pre><code>procedure TGriddata.FormCreate(Sender: TObject);\nbegin\n grdMain.Rows[0].commatext:='\"One\",\"Two\",\"Three\",\"Four\",\"Five\"';\n grdMain.ColWidths[0]:= 50;\n grdMain.ColWidths[1]:= 175;\n grdMain.ColWidths[2]:= 175;\n grdMain.ColWidths[3]:= 100;\n grdMain.ColWidths[4]:= 300;\nend;\n</code></pre>\n\n<p>//display the data in the grid\n//note, I am not showing my creation, execution, or destroy of the query</p>\n\n<pre><code>procedure TGriddata.load;\nbegin\n ... \n grdMain.Cells[0,row]:= FieldByName('one').AsString;\n grdMain.Cells[1,row]:= FieldByName('two').AsString;\n grdMain.Cells[2,row]:= FieldByName('three').AsString;\n grdMain.Cells[3,row]:= FieldByName('four').AsString;\n //draw progress bar here\n ...\nend;\n</code></pre>\n\n<p>One of the columns (\"Five\") needs to display a navy blue horizontal bar in the col. It should also diplay some text centered in the bar. I have no expereince using the custom drawing. What properties do i set to only custom draw the one column and use the default drawing for the other columns?</p>\n"},{"tags":["delphi","oracle11g","delphi-xe2","cursors","dbexpress"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":13186183,"title":"Problems returning cursor from stored procedure as ClientDataset","body":"<p>This question directly relates to my <a href=\"http://stackoverflow.com/questions/13054254/how-to-return-oracle-cursor-from-stored-proc-as-client-dataset-using-delphi-and\">Previous Question</a>.</p>\n\n<p>I have a need to create a TClientDataSet on a client from an Oracle 11g cursor contained in a package. I am using Delphi XE2 and DBExpress to connect to the DB and DataSnap to send the data back to the client.</p>\n\n<p>When I configure the TSQLStoredProc to the TClientDataset at design time I can return the cursor as a TClientDataset with no problem and get expected results. </p>\n\n<p>When I try to execute the Stored Procedure at runtime it returns an empty TClientDataset.</p>\n\n<p>Is it possible to configure and execute an Oracle 11g Stored Procedure using TSQLStoredProc at runtime?</p>\n\n<h2>DataSnap Server</h2>\n\n<p><strong>Design time Data Module code [View as Text]</strong></p>\n\n<pre><code>    object StrProc1: TSQLStoredProc\n    SchemaName = 'xxxx'\n    MaxBlobSize = -1\n    Params = &lt;\n      item\n        DataType = ftWideString\n        Precision = 2000\n        Name = 'ABBR'\n        ParamType = ptInput\n        Value = 'ZZZTOP' \n      end\n      item\n        DataType = ftCursor\n        Precision = 8000\n        Name = 'RES'\n        ParamType = ptOutput\n        Size = 8000\n      end&gt;\n    PackageName = 'KP_DATASNAPTEST'\n    SQLConnection = SQLConnection1\n    StoredProcName = 'GETFAXDATA'\n    Left = 408\n    Top = 72\n  end\n  object DataSetProvider1: TDataSetProvider\n    DataSet = StrProc1\n    Left = 408\n    Top = 120\n  end\n  object ClientDataSet1: TClientDataSet\n    Aggregates = &lt;&gt;\n    Params = &lt;&gt;\n    ProviderName = 'DataSetProvider1'\n    Left = 408\n    Top = 176\n  end\n</code></pre>\n\n<p><strong>function to execute Design Time config</strong></p>\n\n<pre><code>function TKPSnapMethods.getCDS_Data3: OLEVariant;\nbegin    \n self.ClientDataSet1.Open;\n result:= self.ClientDataSet1.Data;\n self.SQLConnection1.Close;\nend;\n</code></pre>\n\n<p><strong>function to execute Runtime configuration</strong> This is the code that returns an empty ClientDataSet. The objective is to connect the pieces, set the value of the parameter, open the CDS and return the CDS.Data  </p>\n\n<pre><code>function TKPSnapMethods.getCDS_Data2(schema: String): OleVariant;\nvar\n  cds: TClientDataSet;\n  dsp: TDataSetProvider;\n  strProc: TSQLStoredProc;\n  ProcParams: TList;\nbegin\n  strProc := TSQLStoredProc.Create(self);\n  try\n    strProc.SQLConnection:= SQLCon;//&lt;--A TSQLConnection    \n    dsp := TDataSetProvider.Create(self);\n    try\n      dsp.DataSet := strProc;\n\n      cds := TClientDataSet.Create(self);\n      try\n        cds.DisableStringTrim := True;\n        cds.ReadOnly := True;\n        cds.SetProvider(dsp);\n\n        ProcParams:= TList.Create;    \n        try\n          //Load Stored Procedure Parameters\n          SQLCon.GetProcedureParams('GETFAXDATA','KP_DATASNAPTEST',Schema,ProcParams);\n          LoadParamListItems(StrProc.Params,ProcParams);\n\n          strProc.ParamByName('ABBR').AsString := 'ZZZTOP';//&lt;--Assign Parms\n          strProc.MaxBlobSize := -1;\n          strProc.SchemaName:= Schema;\n          strproc.PackageName:='KP_DATASNAPTEST';\n          strProc.StoredProcName:= 'GETFAXDATA';\n          cds.Open;\n          Result := cds.Data;\n        finally\n          FreeProcParams(ProcParams);\n        end;\n      finally\n        FreeAndNil(cds);\n      end;\n    finally\n      FreeAndNil(dsp);\n    end;\n  finally\n    FreeAndNil(strProc);\n    self.SQLCon.Close;\n  end;\nend;\n</code></pre>\n\n<p><strong>Client Code</strong> this is just a test form that creates a connection to the DataSnap Server executes the ServerMethods and displays the results in a string grid.</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar\n proxy:TKpSnapMethodsClient;\n cds :TClientDataSet;\n field: TField;\n r,c:integer;\nbegin\n  r:=0;\n  c:=0;\n  SQLConTCPSERV.Connected := True; //TSQLConnection\n  proxy:= TKPSnapMethodsClient.Create(SQLConTCPSERV.DBXConnection,false);\n  cds:= TClientDataSet.Create(nil);\n  try\n    //cds.Data:= proxy.getCDS_Data2('TESTTH');//&lt;--Runtime function\n    cds.Data:= proxy.getCDS_Data3; //&lt;--Design time funtion\n    if cds &lt;&gt; nil then\n    begin\n      cds.Open;\n      cds.First;\n      //String grid to display CDS contents.\n      strGrid1.ColCount:= cds.FieldCount; //returns correct #\n      strGrid1.RowCount:= cds.RecordCount;\n\n      while not cds.Eof do  //&lt;--runtime wont make it past here\n      begin\n        for field in cds.fields do //loop fields\n        begin\n          strgrid1.Cells[c,r]:= field.Text; //display results.\n          c:=c+1;\n        end;\n        c:=0;\n        r:=r+1;            \n        cds.Next;\n      end;\n    end\n    else showmessage('DataSet is NIL');\n  finally\n    cds.Free;\n    proxy.Free;\n    SQLConTCPSERV.Connected := False;\n  end;\nend;\n</code></pre>\n\n<p>Once agian I must confess I am new to the Delphi language. I have searched google, code.google, the Embarcadero Developer Network and DBExpress documentation all to no avail.\nI just don't understand why there would be a difference between design time and runtime. </p>\n"},{"tags":["delphi","64bit"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":2540,"score":5,"question_id":1436185,"title":"How can I tell if I'm running on x64?","body":"<p>I just got a bug report for an issue that only occurs when the program is running \"on a 64-bit machine.\"  Now, Delphi doesn't produce 64-bit code, so theoretically that shouldn't matter, but apparently it does in this case.  I think I have a workaround, but it will break things on 32-bit Windows, so I need some way to tell:</p>\n\n<ol>\n<li>If I'm running on a x64 or an x86 processor and</li>\n<li>If I'm running under a 64-bit version of Windows under Win32 emulation or native Win32 on a 32-bit OS.</li>\n</ol>\n\n<p>Does anyone know how I can get those answers from within my app?</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13195941,"title":"Drawing a Progress Bar using TStringGrid's OnDrawCell event","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5149432/grid-progressbar-or-animation\">Grid progressbar or animation</a><br>\n  <a href=\"http://stackoverflow.com/questions/13032146/add-graphical-bar-to-a-stringgrid-col\">Add graphical bar to a StringGrid col</a>  </p>\n</blockquote>\n\n\n\n<p>Using Delphi 2010, I have a TStringGrid with 5 columns</p>\n\n<p>ID, Start, End, Duration, and a column to draw a progress bar in each cell.</p>\n\n<p>column 5 width (example: 60) is set by the Bar width spin edit field in options dialog. </p>\n\n<p>Given that duration is (end - start) * 1440  (example: 0.39 minutes), I need to draw the progress bar as a percentage of the total bar width. (i.e.  39/60 = 65%) therefore the bar should be painted 65% accross the cell. It also needs to show the percentage centered in the bar. (navy blue bar &amp; white text).</p>\n\n<p>can anyone help me to paint this progress bar ? </p>\n\n<pre><code>procedure Tphasedata.grdMainDrawCell(Sender: TObject; ACol, ARow: Integer;\n  Rect: TRect; State: TGridDrawState);\nvar\n  LStrCell: string;\n  LRect: TRect;\nbegin\n with (Sender as TStringGrid) do\n  begin\n    // Don't change color for first Column, first row\n    if (ACol = 0) or (ARow = 0) then\n      Canvas.Brush.Color := clBtnFace\n    else\n    begin\n      case ACol of\n        0: Canvas.Font.Color := clBlack;\n        1: Canvas.Font.Color := clBlue;\n        2: Canvas.Font.Color := clBlue;\n        3: Canvas.Font.Color := clRed;\n      end;\n      // Draw the Band\n      if ARow mod 2 = 0 then\n        Canvas.Brush.Color := $00E1FFF9\n      else\n        Canvas.Brush.Color := $00FFEBDF;\n      Canvas.TextRect(Rect, Rect.Left + 2, Rect.Top + 2, cells[acol, arow]);\n      Canvas.FrameRect(Rect);\n\n      //center the duration text\n      if ACol = 3 then\n      begin\n        LStrCell := Cells[ACol, ARow]; // grab cell text\n        Canvas.FillRect(Rect); // clear the cell\n        LRect := Rect;\n        LRect.Top := LRect.Top + 3; // adjust top to center vertical\n        // draw text\n        DrawText(Canvas.Handle, PChar(LStrCell), Length(LStrCell), LRect, DT_CENTER);\n      end;\n\n     i ACol = 4 then\n     begin\n      // draw progress bar here \n     end; \n    end;\n  end;\n</code></pre>\n"},{"tags":["delphi","audio","delphi-xe2","volume"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":291,"score":3,"question_id":12126287,"title":"How to mute the sound of my application?","body":"<p>I have an application which has sound. I have a global property to mute the sound. The problem is, there's so many different things which can make sound, I would hate to iterate through different class types and mute/unmute their sound. Instead, I'm looking for a way to mute the sound on a global application level. I don't mean muting the entire system volume either.</p>\n\n<p>One scenario: In Windows 7, you can open the Volume Mixer and adjust the volume of individual applications. While I don't intend to change this actual particular value (as I know it's Windows 7 specific), I would like to change the volume of everything in my application all at once. I would also need the ability to completely mute the sound of everything in my application. I need this ability to be compatible with Windows XP and above. I am assuming it will involve Windows API calls, but I have no idea what calls to make.</p>\n"},{"tags":["html5","delphi","http","websocket"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":652,"score":2,"question_id":8595800,"title":"WebSocket server implementations for Delphi","body":"<p>As mentioned on the <a href=\"http://blogs.oracle.com/theaquarium/entry/grizzly_2_2_is_here\" rel=\"nofollow\">Aquarium</a>, the <a href=\"http://en.wikipedia.org/wiki/WebSocket\" rel=\"nofollow\">WebSocket</a> protocol, often described as one of the key elements of HTML5, has finally <a href=\"http://tools.ietf.org/html/rfc6455\" rel=\"nofollow\">been blessed</a> (<a href=\"http://tools.ietf.org/html/rfc6455\" rel=\"nofollow\">RFC 6455</a>).</p>\n\n<p>Which <strong>WebSocket server</strong> implementations are available for Delphi?</p>\n\n<ul>\n<li><a href=\"http://code.google.com/p/delphionrails/\" rel=\"nofollow\">Delphi on Rails</a> (Google Code, <a href=\"http://www.mozilla.org/MPL/\" rel=\"nofollow\">Mozilla Public License 1.1</a>)</li>\n<li><a href=\"http://code.google.com/p/delphiws/\" rel=\"nofollow\">Delphi Web Socket</a> (Google Code, based on Indy 9, <a href=\"http://www.opensource.org/licenses/bsd-license.php\" rel=\"nofollow\">New BSD License</a>)</li>\n</ul>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":13185572,"title":"Code Look/Runs fine but no changes are made","body":"<p>I have the following code, all the code needs to do is go through a list of vehicles and remove the spaces in each registration but before changing it, it should check to make sure the ammended registration doesn't exist. The following code is what I am using:</p>\n\n<pre><code>unit Main;\ninterface\n\nuses\n Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n Dialogs, Menus, cxLookAndFeelPainters, StdCtrls, cxButtons, Gauges, DB,\n DBTables, StrUtils;\n\ntype\nTfrmMain = class(TForm)\n  prgTotal: TGauge;\n  btnStart: TcxButton;\n  tblVeh: TTable;\n  tblVehRegNo: TStringField;\n  procedure btnStartClick(Sender: TObject);\nprivate\n  procedure OpenTable(pTable: TTable);\n  procedure CloseTable(pTable: TTable; pPost: Boolean);\n  { Private declarations }\npublic\n  { Public declarations }\nend;\n\nvar\n  frmMain   : TfrmMain;\n  lvRegLst  : TStringList;\n  lvTblSize : Integer;\n  lvOrigReg : String;\n  lvNewReg  : String;\n  lvTest    : integer;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TfrmMain.btnStartClick(Sender: TObject);\nbegin\n  btnStart.Enabled := False;\n  lvRegLst  := TStringList.Create;\n\n  // Open Tables\n  tblVeh.Open;\n  tblVeh.First;\n\n  // Set progress\n  prgTotal.MinValue := 0;\n  lvTblSize         := tblVeh.RecordCount;\n  prgTotal.MaxValue := tblVeh.RecordCount;\n  btnStart.Caption  := 'Parsing Registration Numbers...';\n\n  // Conversion\n  while not tblVeh.Eof do\n  begin\n    lvRegLst.Add(tblVehRegNo.AsString);\n    tblVeh.Next;\n    prgTotal.AddProgress(1);\n    Application.ProcessMessages;\n  end;\n\n  tblVeh.First;\n  lvTest            := lvRegLst.Count;\n  prgTotal.Progress := 0;\n  btnStart.Caption  := 'Removing Spaces...';\n\n  while not tblVeh.Eof do\n  begin\n    lvOrigReg := tblVehRegNo.AsString;\n    lvNewReg  := AnsiReplaceStr(lvOrigReg,' ','');\n\n    if lvRegLst.IndexOf(lvNewReg) = -1 then\n    begin\n      tblVeh.Edit;\n      tblVehRegNo.AsString := lvNewReg;\n      prgTotal.AddProgress(1);\n      tblVeh.Post;\n    end;\n\n    tblVeh.Next;\n    prgtotal.AddProgress(1);\n    Application.ProcessMessages;\n  end;\n\n  // Close Tables\n  tblVeh.Edit;\n  tblVeh.Post;\n  tblVeh.Close;\n\n  btnStart.Caption := '&amp;Start Conversion';\n  btnStart.Enabled := True;\nend;\n</code></pre>\n\n<p>I have stepped through the code and all looks fine and it successfuly changes the registration against the vehicle but when looking at the table afterwards it's not made any changes.</p>\n"},{"tags":["delphi","bold-for-delphi"],"answer_count":11,"favorite_count":7,"up_vote_count":12,"down_vote_count":0,"view_count":1688,"score":12,"question_id":236656,"title":"Any active Bold for Delphi users?","body":"<p>What are you using as a persistance framework when programming in Delphi?\nIf the application is growing it soon became really complicated to handle the model in SQL ? Bold is a persistance framework for Delphi win32 that really deserve more attention. I use it daily and using OCL instead of SQL to get data from the database saves a lot of time and debugging. When the model is changed Bold translate this to an SQL script and change the database. </p>\n\n<p><strong>EDIT:</strong>\nFor those that are interested in <strong>Bold for Delphi</strong> I have spend this evening on create a site on Google about it. I'm not a guru in html so the design is maybe not so exciting.\nBut I want comments and reactions about the site. You can leave the comments in this thread or at the bottom on the subpage.</p>\n\n<p>And the address is... <a href=\"https://sites.google.com/site/boldfordelphi/\" rel=\"nofollow\">http://sites.google.com/site/boldfordelphi/</a></p>\n\n<p><strong>EDIT2:</strong>\nSome interesting links about the future of Bold:</p>\n\n<ul>\n<li><a href=\"http://lnkd.in/bWUfvA\" rel=\"nofollow\">Linkedin</a> Thread that discuss this.</li>\n<li><a href=\"http://youtu.be/rJKFAP57HcI\" rel=\"nofollow\">Youtube interview</a> Interview with David Intersimone. Interresting part is at (1:45:20)</li>\n<li>Only the <a href=\"http://db.tt/tUTKvDab\" rel=\"nofollow\">Bold question</a> from the video above.</li>\n</ul>\n\n<p>In short David says that Embarcadero don't care about Bold. If Capableobjects see a bussiness opportunity in this, go ahead. It would be great if that was true but I think we need an official statement from Embarcadero before we can finally celebrate this...\nI try to get in touch with the right people for this. </p>\n\n<p><strong>EDIT3:</strong>\nAfter talked with Hans Karlsen CEO of CabableObjects, I can establish that CapableObjects don't have any rights for Bold. David.I was wrong. Therefore I started a <a href=\"http://www.change.org/petitions/embarcadero-technologies-release-the-intellectual-property-of-bold-for-delphi\" rel=\"nofollow\">petition</a> to convince Enbarcadero that there is a demand for Bold. And they would earn money and goodwill to release it as opensource.</p>\n\n<p>So please read it, sign it and spread the world about this petition!\nActually it goes well. I set 100 names as a goal and I already have 93. Will pass 100 any time now with your help :)</p>\n"},{"tags":["arrays","delphi","element","point"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":13171696,"title":"How to remove/delete particular member or element from static \"Array of TPoint\"?","body":"<p>I want to remove/delete particular member or element from static \"Array of TPoint\". How to do this?</p>\n"},{"tags":["delphi","ide","c++builder","rad-studio","external-tools"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":129,"score":0,"question_id":13189587,"title":"Integrating an external code processing tool to the RAD Studio IDE","body":"<p>Early Borland IDEs (TP, TC) has a mean to execute an external tool, process its output via <em>filter</em> and present an user navigable view with messages associated with corresponding file name and line/column number (protocol has been described <a href=\"https://collab.firelab.org/software/projects/lidar/repository/revisions/59/entry/Lidar/BP/UNITS/EXAMPLES/UTILS/GREP2MSG.PAS\" rel=\"nofollow\">here</a>).\nIs there a support for such kind of integration nowadays or I have to resort something like <code>IOTAMessageServices.AddToolMessage</code> (and write such \"fitting\" myself)?</p>\n"},{"tags":["delphi","image-processing","graphics","jpeg"],"answer_count":4,"favorite_count":5,"up_vote_count":8,"down_vote_count":1,"view_count":1613,"score":7,"question_id":8915466,"title":"Converting Jpeg images to Bmp - some images come out blue","body":"<p>There are some Jpg images which Delphi doesn't seem to like. It appears to be specific with the files I'm loading. And the procedure is simple - a) load Jpg image to <code>TJpegImage</code>, b) Assign Jpg object to a <code>TBitmap</code> object, and c) Save and/or display Bmp image. For some reason, these pictures keep coming out with a blueish tint.</p>\n\n<p>These images show perfectly anywhere and everywhere else I load them (windows picture viewer, paint, photoshop, etc.). </p>\n\n<p>Here's a link to one particular file (of hundreds) which has no blue in it - but when loaded into Delphi, comes out blue...</p>\n\n<p><a href=\"http://www.sendspace.com/file/1owbzh\" rel=\"nofollow\">http://www.sendspace.com/file/1owbzh</a></p>\n\n<p>(Used sendspace.com so that I know the website's not trying to convert the image format)</p>\n\n<p>And what I'm doing is very simple...</p>\n\n<pre><code>procedure Load;\nvar\n  J: TJpegImage;\n  B: TBitmap;\nbegin\n  J:= TJpegImage.Create;\n  B:= TBitmap.Create;\n  J.LoadFromFile('C:\\SomeFile.jpg');\n  B.Assign(J);\n  //Either save or display `B` and it appears blueish at this point\n....\n</code></pre>\n\n<p>I want to avoid getting any third party stuff as much as possible. This problem has existed in Delphi versions 7, 2010, and XE2. At least the TImage control in XE2 displays it properly (as opposed to the older two) but that doesn't matter if the TBitmap still doesn't work. What is wrong with this file? And/or, what is wrong with Delphi's rendering?</p>\n\n<p><strong>Added Info</strong></p>\n\n<p>I recently found out something about these images. When they came from the vendors (product pictures), they were in CMYK format. At that time, Delphi 7 didn't properly support these files (with access violations and bad images) so all the pictures were filtered through a converter to RGB color format. Many original images were also TIFF and were converted to JPG. So it appears that the software <code>FastStone Image Resizer</code> must not properly save these files when they go through. The blue image doesn't happen on all of them, just some random batches at a time. The software handles thousands of products, so there are thousands of possible pictures.</p>\n"},{"tags":["delphi","memory-management","struct","delphi-7"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13168959,"title":"Get Position of a struct var","body":"<p>I would like to get a \"position\" of a structure/record.</p>\n\n<p>Say I have this record:</p>\n\n<pre><code>type\n  MyStruct = record\n    MyInteger   : Integer;\n    MyInteger2  : Integer;\n    MyInteger3  : Integer;\n    MyFunc      : function (FirstParam : WideString; SecondParam : String) : Integer;\n    MyString    : String;\n    MyString2   : WideString;\n    MyPchar     : pchar;\nend;\n</code></pre>\n\n<p>As you can see this record has a size of 28 bytes (7 vars x 4 bytes). Basically because all the vars are either 4 byte vars (such as Integer) or pointers (also 4 bytes).\nNow let's say we have this struct loaded in an memory-address (X = 0) (which also means the address for MyInteger would be 0).\nThe address of MyInteger3 (for example) would be 8 (be aware of the X = 0 !)\nHow can I get the position (number/address) of the struct dynamically?</p>\n\n<p>Hope you guys know what I mean?\nThanks in advance.</p>\n\n<p>BTW: \nIs any Var always 4 bytes in a struct?\nEDIT:\nThis is wrong if you fix the spcae : <code>String[100]</code></p>\n"},{"tags":["delphi","dll","dllimport","messagebox","fasm"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":190,"score":1,"question_id":13009012,"title":"FASM - Passing a String to a Delphi DLL","body":"<p>I have a dll coded in Delphi XE2 with the following code:</p>\n\n<pre><code>procedure xMain(MSG:String);export;\nbegin\n  MessageBox(0,PWideChar(MSG),'Title',0);\nend;\n\nexports xMain;\n</code></pre>\n\n<p>Now, I am importing this function in a FASM application like so:</p>\n\n<pre><code>library  dllfile, \"testdll.dll\"\n\nimport   dllfile,\\\n         xMain,   \"xMain\"\n</code></pre>\n\n<p>And utilizing is as so:</p>\n\n<pre><code>section \".data\" data readable writeable\n\nszMSG     db \"Message from FASM application!\",0\n\nsection \".code\" code readable executable\n\ninvoke    xMain,szMSG\n</code></pre>\n\n<p>But the resulting messagebox appears with distorted characters as so:</p>\n\n<p><img src=\"http://i.stack.imgur.com/n6Dci.png\" alt=\"enter image description here\"></p>\n\n<p>That is the exact result of the function call.</p>\n\n<p>How do I go about solving this issue?</p>\n"},{"tags":["delphi","internet-explorer-8","acrobat"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":5157,"score":2,"question_id":1158285,"title":"File Does Not Begin With '%PDF-'","body":"<p>I had a peculiar problem yesterday.  A customer put one of my Delphi apps on some Toshiba laptops, and all was fine until it was time to generate some Acrobat files as a Rave 7 report, which produced the subject error.</p>\n\n<p>The laptops had Acrobat 7 Standard installed with XP SP3 and IE8.  I uninstalled Acrobat 7 Standard, put in Acrobat 5 Reader which they had lying around, and the problem went away.  However, the customer doesn't see backtracking Acrobat as a solution, because the usual environment this Delphi app runs in of XP SP3, IE 7, and Acrobat 7 Standard doesn't show this problem.</p>\n\n<p>A Google search didn't reveal any recent causes or effects.  The Microsoft and Adobe KBs deny that any problem exists.</p>\n\n<p>Any clues as to what specific area needs a workaround?  Today I'm going to uninstall IE8 and reinstall IE7.</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13178785,"title":"GetDateFileModified for Daylight Savings Time","body":"<pre><code>function DateTimeToFileTime(FileTime: TDateTime): TFileTime;\nvar\n  LocalFileTime, Ft: TFileTime;\n  SystemTime: TSystemTime;\nbegin\n  Result.dwLowDateTime := 0;\n  Result.dwHighDateTime := 0;\n  DateTimeToSystemTime(FileTime, SystemTime);\n  SystemTimeToFileTime(SystemTime, LocalFileTime);\n  LocalFileTimeToFileTime(LocalFileTime, Ft);\n  Result := Ft;\nend;\n\nfunction ExtractShortDate(ATimeIn: TDateTime): string;\n// Convert DateTime to short date string\nbegin\n  Result := FormatDateTime('mm/dd/yyyy', ATimeIn);\nend;\n\nfunction ExtractTime(ATimeIn: TDateTime): string;\n// Convert DateTime to am/pm time string\nbegin\n  Result := FormatDateTime('hh:mm AM/PM', ATimeIn);\nend;\n\nfunction GetDateFileModified(AFileName: string): string;\n// Return the file modified date as a string in local time\nvar\n  SR: TSearchRec;\n  UTCTime: Windows.TFileTime;\n  GMTST: Windows.TSystemTime;\n  LocalST: Windows.TSystemTime;\n  ModifyDT: TDateTime;\n  TZ: Windows._TIME_ZONE_INFORMATION;\nbegin\n  Result := '';\n  if FindFirst(AFileName, faAnyFile, SR) = 0 then\n  begin\n    UTCTime := SR.FindData.ftLastWriteTime;\n    if FileTimeToSystemTime(UTCTime, GMTST) then\n    begin\n       // Get Timezone Information\n      if GetTimeZoneInformation(TZ) &lt;&gt; 0 then\n        if SystemTimeToTzSpecificLocalTime(@TZ, GMTST, LocalST) then\n        begin\n          ModifyDT := SystemTimeToDateTime(LocalST);\n          Result := ExtractShortDate(ModifyDT) + ' ' + ExtractTime(ModifyDT);\n        end\n        else\n        begin\n          TaskMessageDlg('Unable To Convert Time', 'Unable to convert SystemTime To LocalTime',\n            mtInformation, [mbOk], 0);\n          Result := '';\n          exit;\n        end;\n    end\n    else\n    begin\n      TaskMessageDlg('Unable To Convert Time', 'Unable to convert FileTime To SystemTime',\n        mtInformation, [mbOk], 0);\n      Result := '';\n      exit;\n    end;\n  end\n  else\n    TaskMessageDlg('File Not Found', ExtractFileName(AFileName) + ' does not exist.',\n      mtInformation, [mbOk], 0);\n  FindClose(SR);\nend;\n</code></pre>\n\n<p>The original code posted did not return the correct time.  The original code was replaced with working code so that others may find this beneficial.</p>\n\n<p><strong>Update</strong>: The code provides the correct time now thanks to all that assisted.</p>\n"},{"tags":["delphi","indy"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13172505,"title":"TIdFtpClient - handling specific error at the server side","body":"<p>Clients periodically send data to server TIdFtpServer in passive mode.\nIn one client machine, where network sometime is breaking I got message:</p>\n\n<p>EIdReplyRFCError : File status okay; about to open data connection.</p>\n\n<p>And next commands also throw exception like:\nEIdReplyRFCError : Requested action aborted: local error in processing.</p>\n\n<p>When any EIdException apperar then clear socket like:</p>\n\n<pre><code>if Assigned(FFtp.IOHandler) then\nbegin\n  FFtp.IOHandler.InputBuffer.Clear;\n  FFtp.IOHandler.Close;\nend;\nFFtp.KillDataChannel;\n</code></pre>\n\n<p>But client cannot longer send data, still EIdReplyRDCError is throwing and I must restart Server FTP. After restart then client reconnect succesfully and can send data.\nIn the server side, I don't logged any uncatched exceptions.</p>\n\n<p>I tried also at the server side, kill clients which no send data over 20 minutes:</p>\n\n<pre><code>try\n  T := FFtpServ.Contexts.LockList;\n  for I := 0 to T.Count - 1 do\n  if TIdFtpServerContext(T[I]).Data &lt;&gt; nil then\n  begin\n    Cl := TFtpCl(TIdFtpServerContext(T[I]).Data);\n\n    Minutes := MinutesBetween(Cl.LastPing, Now);\n    if Minutes &gt;= 20 then\n    begin\n      if(Assigned(TIdFtpServerContext(T[I]).Connection.IOHandler)) then\n      begin\n        TIdFtpServerContext(T[I]).Connection.IOHandler.InputBuffer.Clear;\n        TIdFtpServerContext(T[I]).Connection.IOHandler.Close;\n      end;\n      TIdFtpServerContext(T[I]).KillDataChannel;\n    end;\n  end;\nfinally\n  DM.FFtpServ.Contexts.UnLockList;\nend;\n</code></pre>\n\n<p>But in this approach often I got AccessViolation exception.</p>\n\n<p>Any idea to solve this problem?</p>\n"},{"tags":["delphi","dataset","fastreport"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":3629,"score":6,"question_id":4065317,"title":"How to assign dataset dynamically to Fast report?","body":"<p>I have created a report using Fast Report Designer and calling this using Delphi 6. But datasets for the master databad and the fields are not assinged at design time. Iwant to set these properties at runtime depends on the selected dataset. How can I do that. How can I access the dataset property of the master band in Delphi before calling the preview/print/design ? Added following code in frxReport1BeforePrint.</p>\n\n<pre><code>  t := frxReport1.FindObject('MasterData1') as TfrxMasterData;\n  //if Assigned(t) then\n    //t.DataSet := frxIBODataset1;\n\n  m := frxReport1.FindObject('mTenderType') as TfrxMemoView;\n  if Assigned(m) then\n  begin\n    m.DataSet := frxIBODataset1;\n    m.DataField := 'ACCOUNTNAME';\n    m.Text := '[frxIBODataset1.\"ACCOUNTNAME\"]';\n  end;\n</code></pre>\n\n<p>But I need to set these properties before calling the print/design/preview. Any help is appreciated.</p>\n\n<p>Kind Regards\nSinu</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13182645,"title":"Finding an IHTMLelement from web document containg <Class=\"submit\" .......> using Delphi 2006?","body":"<p>In a <code>twebbrowser</code> application I want to get a pointer to the element containing this element, using Delphi 2006 (!)</p>\n\n<p><code>&lt;input class=\"submit\" type=\"submit\" value=\"&amp;nbsp;Vis veibeskrivelse&amp;nbsp;\" onclick=\"showDirections();\" /&gt; &lt;a href=\"#\" onclick=\"openDirections(); return false;\"&gt;&amp;Aring;pne veibeskrivelse i Google Maps&lt;/a&gt;&lt;br /&gt;</code></p>\n\n<p>I find that <code>IHTMLDocument7</code> implements a <code>getElementsByClassName</code>, but in Delphi 2006, the <code>IHTMLDocument7</code> is not implemented.</p>\n\n<p>Are there other means on getting the pointer to this element?</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":13182352,"title":"Download crypted (XOR) content","body":"<p>I have one online TXT file encrypted with XOR. And I'm using Indy HTTP to read this file. When I do this:</p>\n\n<pre><code>Buff.Text:= HTTP.Get('http://www.blabla.com/xor.txt');\n</code></pre>\n\n<p>the content in Buff is corrupted and I can't decrypt it correctly. How to solve this? Below I'll paste the function I'm using to XOR the txt file:</p>\n\n<pre><code>function TForm1.XorStr(Input: AnsiString; Seed: integer): AnsiString;\nvar\ni : integer;\nOutput : AnsiString;\nbegin\n    Output := '';\n    for i := 1 to Length(Input) do\n        Output := Output + AnsiChar(Ord(Input[i]) XOR (Seed));\n    Result:= Output;\nend;\n</code></pre>\n\n<p>Hope someone can helps me out. Thank you guys!</p>\n"},{"tags":["delphi","directx","hook","pascal","directx-9"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1235,"score":3,"question_id":6489633,"title":"D3D9 Hook - Overlay with Direct3D9","body":"<p>OK, so I'm trying to do some overlay for some extra buttons on a Direct X game.</p>\n\n<p>I found a c++ sample that overlays quite nicely here: <a href=\"http://www.gamedev.net/topic/359794-c-direct3d-hooking-sample/\" rel=\"nofollow\">http://www.gamedev.net/topic/359794-c-direct3d-hooking-sample/</a></p>\n\n<p>So I began to convert it to Delphi. With some logging I can see that it starts the hook on the correct process and hooks Direct3DCreate9() correctly.</p>\n\n<p>Next TMyDirect3D9 is created successfully. But the process crashes from here. </p>\n\n<p>My educated guess (based on some debugging in Ollydbg) that when I return MyDirect3D9 back to the original process via the hooked Direct3DCreate9() and it tries to call one of the class(interface) functions it fails.</p>\n\n<p>Code follows. If I can give any other information to help let me know.</p>\n\n<p>Main DLL:</p>\n\n<pre><code>library LeagueUtilityBox;\n\n{$R *.res}\n\n{$DEFINE DEBUG}\n\nuses\n  Windows,\n  APIHijack in 'APIHijack.pas',\n  Direct3D9 in '..\\DirectX 9.0\\Direct3D9.pas',\n  uSharedMem in '..\\Misc\\uSharedMem.pas',\n  MyDirect3D9 in 'MyDirect3D9.pas',\n  MyDirect3DDevice9 in 'MyDirect3DDevice9.pas',\n  {$IFDEF DEBUG}\n  SysUtils,\n  uLog in '..\\Misc\\uLog.pas',\n  {$ENDIF}\n  uMisc in 'uMisc.pas';\n\nvar\n  SharedMem : TSharedMem;\n  D3DHook: SDLLHook;\n  hHook : DWORD;\n  MyDirect3D9 : TMyDirect3D9;\n\nfunction GetTargetProcess: String;\nconst\n  KeyBase : DWORD = HKEY_CURRENT_USER;\n  KeyLocation : String = 'Software\\LeagueUtilityBox';\nvar\n  RegKey : HKEY;\n  TargetProcess : Array[0..511] Of Char;\n  Count : DWORD;\nbegin\n  Result := '';\n  If RegOpenKeyEx(KeyBase, PChar(KeyLocation), 0, KEY_QUERY_VALUE, RegKey) = ERROR_SUCCESS Then\n    begin\n    Count := 512;\n    If RegQueryValueEx(RegKey, nil, nil, nil, @TargetProcess[0], @Count) = ERROR_SUCCESS Then\n      begin\n      Result := String(TargetProcess);\n    end;\n  end;\nend;\n\ntype\n  TDirect3DCreate9 = function(SDKVersion: LongWord): Pointer; stdcall;\n\nfunction MyDirect3DCreate9(SDKVersion: LongWord): Pointer; stdcall;\nvar\n  OldFunc : TDirect3DCreate9;\n  D3D : PIDirect3D9;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'MyDirect3DCreate9 called');\n  {$ENDIF}\n  Result := nil;\n  OldFunc := TDirect3DCreate9(D3DHook.Functions[0].OrigFn);\n  D3D := OldFunc(SDKVersion);\n  If D3D &lt;&gt; nil Then\n    begin\n    {$IFDEF DEBUG}\n    WriteToLog('C:\\LeagueUtilityBox.log', 'D3D created: 0x' + IntToHex(DWORD(Pointer(D3D)), 8));\n    {$ENDIF}\n    New(MyDirect3D9);\n    MyDirect3D9 := TMyDirect3D9.Create(D3D);\n    {$IFDEF DEBUG}\n    WriteToLog('C:\\LeagueUtilityBox.log', 'MyDirect3D9 Created');\n    {$ENDIF}\n    Result := @MyDirect3D9;\n  end;\nend;\n\nprocedure InitializeHook;\nvar\n  Process : String;\n  I : Integer;\nbegin\n  SetLength(Process, 512);\n  GetModuleFileName(GetModuleHandle(nil), PChar(Process), 512);\n  For I := Length(Process) DownTo 1 Do\n    begin\n    If Process[I] = '\\' Then Break;\n  end;\n  Process := Copy(Process, I + 1, Length(Process));\n  If CompareString(LOCALE_SYSTEM_DEFAULT, NORM_IGNORECASE, PChar(GetTargetProcess), -1, PChar(Process), -1) = 2 Then\n    begin\n    {$IFDEF DEBUG}\n    WriteToLog('C:\\LeagueUtilityBox.log', 'Found target: ' + GetTargetProcess);\n    {$ENDIF}\n    With D3DHook Do\n      begin\n      Name := 'D3D9.DLL';\n      UseDefault := False;\n      DefaultFn := nil;\n      SetLength(Functions, 1);\n      Functions[0].Name := 'Direct3DCreate9';\n      Functions[0].HookFn := @MyDirect3DCreate9;\n      Functions[0].OrigFn := nil;\n    end;\n    {$IFDEF DEBUG}\n    WriteToLog('C:\\LeagueUtilityBox.log', 'About to hook: ' + String(AnsiString(D3DHook.Name)));\n    {$ENDIF}\n    HookAPICalls(@D3DHook);\n    {$IFDEF DEBUG}\n    WriteToLog('C:\\LeagueUtilityBox.log', 'Hook completed: ' + String(AnsiString(D3DHook.Name)));\n    {$ENDIF}\n  end;\nend;\n\nprocedure InitializeDLL;\nbegin\n  SharedMem := TSharedMem.Create('LeagueUtilityBox', 1024);\n  Try\n    hHook := PDWORD(SharedMem.Buffer)^;\n    {$IFDEF DEBUG}\n    WriteToLog('C:\\LeagueUtilityBox.log', 'Initializing DLL: ' + IntToStr(hHook));\n    {$ENDIF}\n  Finally\n    SharedMem.Free;\n  end;\nend;\n\nprocedure UninitializeDLL;\nbegin\n  UnhookWindowsHookEx(hHook);\nend;\n\nfunction WindowsHookCallback(nCode: Integer; WPARAM: Integer; LPARAM: Integer): LRESULT; stdcall;\nbegin\n  Result := CallNextHookEx(hHook, nCode, WPARAM, LPARAM);\nend;\n\nprocedure EntryPoint(Reason: DWORD);\nbegin\n  Case Reason Of\n    DLL_PROCESS_ATTACH:\n      begin\n      InitializeDLL;\n      InitializeHook;\n    end;\n    DLL_PROCESS_DETACH:\n      begin\n      UninitializeDLL;\n    end;\n  end;\nend;\n\nexports\n  WindowsHookCallback;\n\nbegin\n  DLLProc := @EntryPoint;\n  EntryPoint(DLL_PROCESS_ATTACH);\nend.\n</code></pre>\n\n<p>The custom IDirect3D9:</p>\n\n<pre><code>unit MyDirect3D9;\n\ninterface\n\nuses Direct3D9, Windows, uMisc, uLog;\n\ntype\n  PMyDirect3D9 = ^TMyDirect3D9;\n  TMyDirect3D9 = class(TInterfacedObject, IDirect3D9)\n  private\n    fD3D: PIDirect3D9;\n  public\n    constructor Create(D3D: PIDirect3D9);\n\n    function QueryInterface(riid: REFIID; ppvObj: PPointer): HRESULT; stdcall;\n    function _AddRef: DWORD; stdcall;\n    function _Release: DWORD; stdcall;\n\n    function RegisterSoftwareDevice(pInitializeFunction: Pointer): HResult; stdcall;\n    function GetAdapterCount: LongWord; stdcall;\n    function GetAdapterIdentifier(Adapter: LongWord; Flags: DWord; out pIdentifier: TD3DAdapterIdentifier9): HResult; stdcall;\n    function GetAdapterModeCount(Adapter: LongWord; Format: TD3DFormat): LongWord; stdcall;\n    function EnumAdapterModes(Adapter: LongWord; Format: TD3DFormat; Mode: LongWord; out pMode: TD3DDisplayMode): HResult; stdcall;\n    function GetAdapterDisplayMode(Adapter: LongWord; out pMode: TD3DDisplayMode): HResult; stdcall;\n    function CheckDeviceType(Adapter: LongWord; CheckType: TD3DDevType; AdapterFormat, BackBufferFormat: TD3DFormat; Windowed: BOOL): HResult; stdcall;\n    function CheckDeviceFormat(Adapter: LongWord; DeviceType: TD3DDevType; AdapterFormat: TD3DFormat; Usage: DWord; RType: TD3DResourceType; CheckFormat: TD3DFormat): HResult; stdcall;\n    function CheckDeviceMultiSampleType(Adapter: LongWord; DeviceType: TD3DDevType; SurfaceFormat: TD3DFormat; Windowed: BOOL; MultiSampleType: TD3DMultiSampleType; pQualityLevels: PDWORD): HResult; stdcall;\n    function CheckDepthStencilMatch(Adapter: LongWord; DeviceType: TD3DDevType; AdapterFormat, RenderTargetFormat, DepthStencilFormat: TD3DFormat): HResult; stdcall;\n    function CheckDeviceFormatConversion(Adapter: LongWord; DeviceType: TD3DDevType; SourceFormat, TargetFormat: TD3DFormat): HResult; stdcall;\n    function GetDeviceCaps(Adapter: LongWord; DeviceType: TD3DDevType; out pCaps: TD3DCaps9): HResult; stdcall;\n    function GetAdapterMonitor(Adapter: LongWord): HMONITOR; stdcall;\n    function CreateDevice(Adapter: LongWord; DeviceType: TD3DDevType; hFocusWindow: HWND; BehaviorFlags: DWord; pPresentationParameters: PD3DPresentParameters; out ppReturnedDeviceInterface: IDirect3DDevice9): HResult; stdcall;\n  end;\n\nimplementation\n\nuses MyDirect3DDevice9;\n\nconstructor TMyDirect3D9.Create(D3D: PIDirect3D9);\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.Create');\n  {$ENDIF}\n  fD3D := D3D;\nend;\n\nfunction TMyDirect3D9.QueryInterface(riid: REFIID; ppvObj: PPointer): HRESULT; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.QueryInterface');\n  {$ENDIF}\n  Result := fD3D^.QueryInterface(riid, ppvObj);\nend;\n\nfunction TMyDirect3D9._AddRef: DWORD; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9._AddRef');\n  {$ENDIF}\n  Result := fD3D^._AddRef;\nend;\n\nfunction TMyDirect3D9._Release: DWORD; stdcall;\nvar\n  count : DWORD;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9._Release');\n  {$ENDIF}\n  count := fD3D^._Release;\n  If count = 0 Then\n    begin\n    Self.Free;\n  end;\n  Result := count;\nend;\n\nfunction TMyDirect3D9.RegisterSoftwareDevice(pInitializeFunction: Pointer): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.RegisterSoftwareDevice');\n  {$ENDIF}\n  Result := fD3D^.RegisterSoftwareDevice(pInitializeFunction);\nend;\n\nfunction TMyDirect3D9.GetAdapterCount: LongWord; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.GetAdapterCount');\n  {$ENDIF}\n  Result := fD3D^.GetAdapterCount;\nend;\n\nfunction TMyDirect3D9.GetAdapterIdentifier(Adapter: LongWord; Flags: DWord; out pIdentifier: TD3DAdapterIdentifier9): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.GetAdapterIdentifier');\n  {$ENDIF}\n  Result := fD3D^.GetAdapterIdentifier(Adapter, Flags, pIdentifier);\nend;\n\nfunction TMyDirect3D9.GetAdapterModeCount(Adapter: LongWord; Format: TD3DFormat): LongWord; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.GetAdapterModeCount');\n  {$ENDIF}\n  Result := fD3D^.GetAdapterModeCount(Adapter, Format);\nend;\n\nfunction TMyDirect3D9.EnumAdapterModes(Adapter: LongWord; Format: TD3DFormat; Mode: LongWord; out pMode: TD3DDisplayMode): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.EnumAdapterModes');\n  {$ENDIF}\n  Result := fD3D^.EnumAdapterModes(Adapter, Format, Mode, pMode);\nend;\n\nfunction TMyDirect3D9.GetAdapterDisplayMode(Adapter: LongWord; out pMode: TD3DDisplayMode): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.GetAdapterDisplayMode');\n  {$ENDIF}\n  Result := fD3D^.GetAdapterDisplayMode(Adapter, pMode);\nend;\n\nfunction TMyDirect3D9.CheckDeviceType(Adapter: LongWord; CheckType: TD3DDevType; AdapterFormat, BackBufferFormat: TD3DFormat; Windowed: BOOL): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.CheckDeviceType');\n  {$ENDIF}\n  Result := fD3D^.CheckDeviceType(Adapter, CheckType, AdapterFormat, BackBufferFormat, Windowed);\nend;\n\nfunction TMyDirect3D9.CheckDeviceFormat(Adapter: LongWord; DeviceType: TD3DDevType; AdapterFormat: TD3DFormat; Usage: DWord; RType: TD3DResourceType; CheckFormat: TD3DFormat): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.CheckDeviceFormat');\n  {$ENDIF}\n  Result := fD3D^.CheckDeviceFormat(Adapter, DeviceType, AdapterFormat, Usage, RType, CheckFormat);\nend;\n\nfunction TMyDirect3D9.CheckDeviceMultiSampleType(Adapter: LongWord; DeviceType: TD3DDevType; SurfaceFormat: TD3DFormat; Windowed: BOOL; MultiSampleType: TD3DMultiSampleType; pQualityLevels: PDWORD): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.CheckDeviceMultiSampleType');\n  {$ENDIF}\n  Result := fD3D^.CheckDeviceMultiSampleType(Adapter, DeviceType, SurfaceFormat, Windowed, MultiSampleType, pQualityLevels);\nend;\n\nfunction TMyDirect3D9.CheckDepthStencilMatch(Adapter: LongWord; DeviceType: TD3DDevType; AdapterFormat, RenderTargetFormat, DepthStencilFormat: TD3DFormat): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.CheckDepthStencilMatch');\n  {$ENDIF}\n  Result := fD3D^.CheckDepthStencilMatch(Adapter, DeviceType, AdapterFormat, RenderTargetFormat, DepthStencilFormat);\nend;\n\nfunction TMyDirect3D9.CheckDeviceFormatConversion(Adapter: LongWord; DeviceType: TD3DDevType; SourceFormat, TargetFormat: TD3DFormat): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.CheckDeviceFormatConversion');\n  {$ENDIF}\n  Result := fD3D^.CheckDeviceFormatConversion(Adapter, DeviceType, SourceFormat, TargetFormat);\nend;\n\nfunction TMyDirect3D9.GetDeviceCaps(Adapter: LongWord; DeviceType: TD3DDevType; out pCaps: TD3DCaps9): HResult; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.GetDeviceCaps');\n  {$ENDIF}\n  Result := fD3D^.GetDeviceCaps(Adapter, DeviceType, pCaps);\nend;\n\nfunction TMyDirect3D9.GetAdapterMonitor(Adapter: LongWord): HMONITOR; stdcall;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.GetAdapterMonitor');\n  {$ENDIF}\n  Result := fD3D^.GetAdapterMonitor(Adapter);\nend;\n\nfunction TMyDirect3D9.CreateDevice(Adapter: LongWord; DeviceType: TD3DDevType; hFocusWindow: HWND; BehaviorFlags: DWord; pPresentationParameters: PD3DPresentParameters; out ppReturnedDeviceInterface: IDirect3DDevice9): HResult; stdcall;\nvar\n  hr : HRESULT;\nbegin\n  {$IFDEF DEBUG}\n  WriteToLog('C:\\LeagueUtilityBox.log', 'TMyDirect3D9.CreateDevice');\n  {$ENDIF}\n  hr := fD3D^.CreateDevice(Adapter, DeviceType, hFocusWindow, BehaviorFlags, pPresentationParameters, ppReturnedDeviceInterface);\n  If Succeeded(hr) Then\n    begin\n    {$IFDEF DEBUG}\n    WriteToLog('C:\\LeagueUtilityBox.log', 'fD3D^.CreateDevice Succeeded');\n    {$ENDIF}\n    ppReturnedDeviceInterface := TMyDirect3DDevice9.Create(PIDirect3D9(@Self), @ppReturnedDeviceInterface);\n  end;\n  Result := hr;\nend;\n\nend.\n</code></pre>\n\n<p><strong>UPDATE:</strong>\nSo, since the Delphi interfaces seem to act differently than a real one (Delphi has an in between for it to successfully talk to other interfaces). So I just converted the interface to an array of pointers. </p>\n\n<p>Now the program successfully calls CreateDevice(). I can see this both in the logs and stepping through in Ollydbg.</p>\n\n<p>Now what happens is that when CreateDevice calls the original IDirect3D9.CreateDevice() it crashes again. When I debug in Ollydbg I notice that it is dereferencing the pointer once too much. </p>\n\n<p><strong>UPDATE 2:</strong>\nOk, fixed some pointer issues with PIDirect3D9 vs IDirect3D9 in different places. So the original IDirect3D9.CreateDevice() gets called. But it errors with D3DERR_INVALIDCALL!!</p>\n\n<p>So confusing.</p>\n\n<p><strong>UPDATE 3:</strong>\nOk, with some more debugging it seems that when I call the function an extra parameter gets pushed on the stack. Which makes the first param invalid. This is proved further by DirectX Debugging which says iAdapter parameter invalid (first param).</p>\n\n<p><strong>UPDATE 4:</strong>\nWith using IntRefToMethPtr() to get the direct pointer to the original CreateDevice call I was able to get it to call with the stacks the same. Same result. It's looking like I've went the wrong route with trying to hook it in Delphi. </p>\n\n<p><strong>UPDATE 5:</strong>\nRewrote the hooking method. Now I'm just hooking essentially EndScene(). Hook now works fine in a test program (Vertices.exe that came with the hook demo found in the first URL in this post). But in the main game it crashes the game. Either way I've learned a lot.</p>\n"},{"tags":["delphi","generics","soap","delphi-xe2"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":13181842,"title":"Delphi XE2 generics in TRemotable classes","body":"<p>For reasons not really relevant to the question I want to use generics in my TRemotable classes. I've found that Soap.OPToSOAPDomConv.pas has some problems with this. It's using the old RTTI which I guess can't handle generics so the classes is not serialized into xml.</p>\n\n<p>I've managed to change Soap.OPToSOAPDomConv.pas so that it works with generics. My main question is if it is considered ok to do changes in the Delphi source files?\nIf it isn't, is there a better way to do this? As long as it's just me using it I guess there is no big problems, but it's hard to distribute the source to others, and then there's also future changes in Delphi to consider. \nThe rest of this lenghty post is just details about what I'm actually doing :-)</p>\n\n<p>I've changed this in Soap.OPToSOAPDomConv.pas (row 3759)</p>\n\n<pre><code>if SerializeProps then\nbegin\n  { Serialized published properties }\n  Count := GetTypeData(Instance.ClassInfo)^.PropCount;\n  if Count &gt; 0 then\n  begin\n    CheckedElemURI := False;\n    GetMem(PropList, Count * SizeOf(Pointer));\n    try\n      GetPropInfos(Instance.ClassInfo, PropList);\n</code></pre>\n\n<p>To: (not the prettiest implementation I guess)</p>\n\n<p>New variables in the procedure:</p>\n\n<pre><code>Context: TRttiContext;       \nRttiProperty:  TRttiProperty;\n</code></pre>\n\n<p>Row 3759:</p>\n\n<pre><code>if SerializeProps then\nbegin\n  { Serialized published properties }\n  Count := 0;\n  for RttiProperty in Context.GetType(Instance.ClassInfo).GetProperties do\n  begin\n    if RttiProperty.Visibility = mvPublished then //The old method only read published\n      Count := Count + 1;                         //RTTI scoping [mvPublished] requires changes to\n  end;                                            //soap.InvRegistry\n  begin\n    CheckedElemURI := False;\n    GetMem(PropList, Count * SizeOf(Pointer));\n    try\n      I := 0;\n      for RttiProperty in Context.GetType(Instance.ClassInfo).GetProperties do\n        if RttiProperty.Visibility = mvPublished then\n        begin\n          PropList[I] := TRttiInstanceProperty(RttiProperty).PropInfo;\n          I := I + 1;\n        end;\n</code></pre>\n\n<p>Some details as to what I am doing is probably helpful. The background is that the imported wsdl from the SOAP Web Service generates a huge unit, that consists of about 2000 classes and 300k rows of code. The web service design is out of my control. The WSDL Importer makes all of these classes visible in RTTI, which consumes the RTTI space and the unit won't compile.</p>\n\n<p>I've refactored the code here and there and now have a working implementation. While refactoring I found that I could cut away some 50000 rows of redundant code by using generics. Since Delphi won't compile the imported wsdl \"as is\" anyway I will have to maintain the unit manually whenever new methods becomes available in the web service, so I want to make it as readable as possible.</p>\n\n<p>Basically I'm changing according to below. The sample has very simplified classes, and the sample actually has more lines in the refactored code, but considering the original classes has a lot of procedures etc this method really makes the unit a lot more readable, and it's also easier to compose the classes.</p>\n\n<pre><code>TLCar = class(TRemotable)\nprivate\n  FEngine: string;\n  FName: string;\npublished\n  property Name: string read FName write FName;\n  property Engine: string read FEngine write FEngine;\nend;\n\nTLBicycle = class(TRemotable)\nprivate\n  FPedals: string;\n  FName: string;\npublished\n  property Name: string read FName write FName;\n  property Pedals: string read FPedals write FPedals;\nend;\n\nTListCarRequest = class(TRemotable)\nprivate\n  FreturnedTags: TLCar;\npublished\n  property returnedTags: TLCar read FreturnedTags write FreturnedTags;\nend;\n\nTListBiCycleRequest = class(TRemotable)\nprivate\n  FreturnedTags: TLBicycle;\npublished\n  property returnedTags: TLBicycle read FreturnedTags write FreturnedTags;\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>TCommonReturnedTags = class(TRemotable)\nprivate\n  FName: string;\npublished\n  property Name: string read FName write FName;\nend;\n\nTLCar = class(TCommonReturnedTags)\nprivate\n  FEngine: string;\npublished\n  property Engine: string read FEngine write FEngine;\nend;\n\nTLBicycle = class(TCommonReturnedTags)\nprivate\n  FPedals: string;\npublished\n  property Pedals: string read FPedals write FPedals;\nend;\n\nTGenericListRequest&lt;T: TCommonReturnedTags, constructor&gt; = class(TRemotable)\nprivate\n  FreturnedTags: T;\npublished\n  property returnedTags: T read FreturnedTags write FreturnedTags;\nend;\n\nTListCarRequest = class(TGenericListRequest&lt;TLCar&gt;)\nend;\n\nTListBiCycleRequest = class(TGenericListRequest&lt;TLBicycle&gt;)\nend;\n</code></pre>\n\n<p>Kind Regards,</p>\n\n<p>Dan</p>\n"},{"tags":["delphi","exception","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13107428,"title":"Exception ENonAIRException when installing custom package","body":"<p>I have a custom package (which is using FibPlus and IBExpress). Package builds ok, but when trying to install it it gives me this exception : Exception ENonAIRException. Does anyone know something about it? What it generates it? </p>\n\n<p>LE: found <a href=\"http://docwiki.embarcadero.com/VCL/2010/en/DesignEditors.EDesignPropertyError_Members\" rel=\"nofollow\">http://docwiki.embarcadero.com/VCL/2010/en/DesignEditors.EDesignPropertyError_Members</a> - but it doesn't help</p>\n\n<p>LE2: error is raised when installing the package, and the IDE is trying to load the package. bellow the madExcept report:</p>\n\n<pre><code>21ba0eb1 +0ad delphicoreide150.bpl PakList           896 +20 TPackageListItem.LoadDesignPackage\n7c91e485 +009 ntdll.dll                                      KiUserExceptionDispatcher\n7c92487a +048 ntdll.dll                                      RtlAppendUnicodeToString\n207a8c49 +055 coreide150.bpl       PakLoad           217  +7 TPackage.Load\n207ab419 +061 coreide150.bpl       PakMgr            591  +2 TDesignPackage.Load\n21af8317 +05b delphicoreide150.bpl PasCppPakMgr     2253  +4 TIDEDesignPackage.Load\n500a014a +04e rtl150.bpl           Classes          5284  +2 TStrings.IndexOf\n21af7bbb +0ff delphicoreide150.bpl PasCppPakMgr     2059 +20 TProfileData.LoadIntersectingPackageGroups\n21af81db +077 delphicoreide150.bpl PasCppPakMgr     2214  +8 TIDEDesignPackage.LoadRequiredDesignPackages\n21af83ce +112 delphicoreide150.bpl PasCppPakMgr     2266 +17 TIDEDesignPackage.Load\n5003a7c1 +01d rtl150.bpl           System          12170  +2 @AfterConstruction\n21af812b +06b delphicoreide150.bpl PasCppPakMgr     2178 +11 TIDEDesignPackage.DelayLoad\n21ba0f0c +030 delphicoreide150.bpl PakList           916  +3 TPackageListItem.LoadWait\n21ba0e73 +06f delphicoreide150.bpl PakList           891 +15 TPackageListItem.LoadDesignPackage\n21b9feeb +067 delphicoreide150.bpl PakList           559  +7 TPackageListItem.SetIsInstalled\n21b9fcbb +0d3 delphicoreide150.bpl PakList           474 +13 TPackageList.AddPackage\n21bacba0 +090 delphicoreide150.bpl BasePasProjOpts  1670  +8 TProjOptsManager.InstallPackage\n21bade5f +003 delphicoreide150.bpl BasePasProjOpts  2363  +0 TProjectOptions.InstallPackage\n21b8561d +191 delphicoreide150.bpl PasMgr          11722 +18 TPascalPackageCodeUpdater.InstallPackage\n21b028ef +06f delphicoreide150.bpl PkgContainers     178  +8 TStdPackageProjectContainer.CommandHandler\n2079350f +19f coreide150.bpl       ContainerIntf     866 +26 TIDEProjectManagerMenuObject.Execute\n20795136 +176 coreide150.bpl       ContainerIntf    1114 +18 TProjectManagerMenuItem.Click\n5029fc9b +013 vcl150.bpl           Menus            3390  +5 TMenu.DispatchCommand\n502a0e7a +082 vcl150.bpl           Menus            4496  +4 TPopupList.WndProc\n502a0dc9 +01d vcl150.bpl           Menus            4471  +2 TPopupList.MainWndProc\n500afa64 +014 rtl150.bpl           Classes         13491  +8 StdWndProc\n77d189e3 +00a USER32.dll                                     DispatchMessageW\n50358af7 +0f3 vcl150.bpl           Forms            9760 +23 TApplication.ProcessMessage\n50358b3a +00a vcl150.bpl           Forms            9790  +1 TApplication.HandleMessage\n50358e65 +0c9 vcl150.bpl           Forms            9927 +26 TApplication.Run \n</code></pre>\n"},{"tags":["xml","delphi","wsdl"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":13181047,"title":"How to define a Delphi class from XML message","body":"<p>I'm working with Delphi 2007.</p>\n\n<p>With the WSDL importer I created, from an external WSDL, a unit which contains several functions.</p>\n\n<p>Unfortunately it does not contain explicit result types for the XML returned.</p>\n\n<p>F.i. the function getHash('login', 'password') return the following XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=\"...........&gt;\n  &lt;SOAP-ENV:Body&gt;\n    &lt;ns1:getHashResponse&gt;\n      &lt;return xsi:type=\"ns2:Map\"&gt;\n        &lt;item&gt;\n          &lt;key xsi:type=\"xsd:string\"&gt;code&lt;/key&gt;\n          &lt;value xsi:type=\"xsd:string\"&gt;1004&lt;/value&gt;\n        &lt;/item&gt;\n        &lt;item&gt;\n          &lt;key xsi:type=\"xsd:string\"&gt;error&lt;/key&gt;\n          &lt;value xsi:type=\"xsd:string\"&gt;Login was not successfull&lt;/value&gt;\n        &lt;/item&gt;\n      &lt;/return&gt;\n    &lt;/ns1:getHashResponse&gt;\n  &lt;/SOAP-ENV:Body&gt;\n&lt;/SOAP-ENV:Envelope&gt;\n</code></pre>\n\n<p>From this I have been trying to define the correct class.\nWhat I've come up with so far is:</p>\n\n<pre><code>  TKeyValue = class;\n\n  TArrayofKeyValue = array of TKeyValue;\n\n  TKeyValue = class(TRemotable)\n  private\n    FKey: String;\n    FValue: String;\n  published\n    property Key:        String        read FKey     write FKey;\n    property Value:      String        read FValue   write FValue;\n  end;\n\n  function getHash(const uid: WideString; const pwd: WideString): TArrayOfKeyValue; stdcall;\n</code></pre>\n\n<p>When I test with this code I do get two instances of TKeyValue back. But they're both empty.\nWhat is wrong with my class definition? Or am I going about it the wrong way?</p>\n\n<p>Best would be a better WSDL, but that is not up to me.</p>\n"},{"tags":["delphi","automation","word"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":177,"score":5,"question_id":13159644,"title":"How do I work with Word Documents without using COM Automation?","body":"<p>I have read multiple posts on the issue, and none seem to come to a decent conclusion to my question. (Perhaps I'm trying to see if anything has popped up lately.)</p>\n\n<p>I have a small charity app that handles pledges. In doing so, it needs to work with and print  documents.</p>\n\n<p>Thing is, if Word is open in the background, the app thread will hang and won't respond to the closure of Word, and I have to roll back manually and close word. Sure, that all works fine, but I simply cannot guarantee that the end user will close Word, even if I put the instruction in a user manual.</p>\n\n<p>I'm not too fussed about speed, but I guess that if it can be enhanced, it would be a nice little bonus.</p>\n\n<p>Have any libraries been released for Delphi that will allow me to open, edit, print, and save documents? If not, is there a way to use Word Automation in such a way that it will not conflict with another open handle of Word when opened?</p>\n"},{"tags":["delphi","usb","serial-number"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":159,"score":0,"question_id":12582806,"title":"getting the manufacturer serial number of a flash disc in Delphi","body":"<p>I have tried all the code displayed on <a href=\"http://stackoverflow.com/questions/4292395/how-to-get-manufacturer-serial-number-of-an-usb-flash-drive\">this question</a> on my usb flash disk with windows XP sp3, it always return this message \"I/O error 105\" without displaying any serial. what is the solution ?</p>\n"},{"tags":["delphi","opa"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":90,"score":0,"question_id":13180194,"title":"is it possible to use OPA in DELPHI and desktop applications?","body":"<p>I just read this article about <a href=\"http://blog.opalang.org/?view=classic\" rel=\"nofollow\">OPA</a>.\nIs it possible to use it in desktop development with DELPHI win32 ?</p>\n\n<p>This would solve some problem I currently have.</p>\n"},{"tags":["osx","delphi","firemonkey"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":62,"score":6,"question_id":13108282,"title":"Setting the mouseposition in a crossplatform way with Firemonkey 2 (FMX2)","body":"<p>In Firemonkey 2 (FMX2) there is the interface</p>\n\n<p>IFMXMouseService = interface(IInterface)\n    ['{2370205F-CF27-4DF6-9B1F-5EBC27271D5A}']</p>\n\n<p>The interface just has a GetMousePos function.\nBut how can I set the mouseposition in a crossplattform way? \nAny ideas anybody?</p>\n\n<p>The best idea I came up with yet is to do a conditionaly compile until the possibility is existing in FMX - but I do not know how to set the mouseposition via Delphi for MACOSX.\nI would be thankful for any help.</p>\n"},{"tags":["string","delphi","function"],"answer_count":8,"favorite_count":8,"up_vote_count":7,"down_vote_count":0,"view_count":3539,"score":7,"question_id":4186458,"title":"Delphi: Call a function whose name is stored in a string","body":"<p>Is it possible to call a function whose name is stored in a string in Delphi?</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":104,"score":2,"question_id":13174268,"title":"Delphi - W1048 Unsafe typecast of 'string' to 'TFormatSettings'","body":"<p>I'm porting an old project to Delphi XE and I receive this warning on the code bellow.</p>\n\n<pre><code>function RemoveThousandSeperator(Text: String) : String;\nVar P : Integer;\nbegin\n  if length(Text) &gt; 3 then begin\n    p := Pos(FormatSettings.ThousandSeparator,Text);\n   while p &gt;0 do begin\n      Delete(Text,p,1);\n      p := Pos(FormatSettings.ThousandSeparator,Text);\n    end;\n  end;\n  result := Text;\nend;\n</code></pre>\n\n<p>even FormatSettings.ThousandSeparator is of type char.</p>\n\n<p>LE: I am asking if someone can tell me why this warning occurs. The code is old and it will be remade.</p>\n\n<p>LE2 : In order to get this warning all the warnings needs to be set to true in the Delphi Compiler-Hints &amp; Warnings</p>\n\n<p>LE3: If someone needs it - {$WARN UNSAFE_CAST OFF} makes the warning go off. </p>\n\n<p>LE4: a screenshot of the warning for those who believe that the warning is hard to believe</p>\n\n<p><img src=\"http://i.stack.imgur.com/Lcb62.png\" alt=\"enter image description here\"></p>\n"},{"tags":["arrays","delphi","service","web","byte"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":13175959,"title":"Bytes of different file to -127 to 127","body":"<p>I'm going to a Web Service an Array of Byte, the issue that is going the bytes with values ​​from 0-255 and the Web Service accepts only value of -127 to 127, someone could help me?</p>\n\n<p>A snippet of the code is this:</p>\n\n<pre><code>BytesFile : array [1..66000] of Byte;\n\nAssignFile(fileB,'C:\\img.jpg');\nReset(fileB,1);\nBlockRead(fileB, BytesFile , SizeOf(BytesFile ), NumRead);\n</code></pre>\n"},{"tags":["sql","delphi","postgresql","sql-injection","freepascal"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":119,"score":6,"question_id":13171048,"title":"Is there a library for sanitizing query parameters for PostgreSQL or SQL in general, for FreePascal and Delphi?","body":"<p>I got bitten my first sql escaping error (it was long overdue) when I tried to execute the PostgreSQL query below with a value containing an apostrophe eg. <code>O'Brien</code>, using FreePascal and Lazarus</p>\n\n<pre><code>SQL.Add(format('select * from zones where upper(zn_name) &gt;=  %s and upper(zn_name) &lt; %s order by zn_name',[sQuote(zoneMin), sQuote(zoneMax)]));\n</code></pre>\n\n<p>In the query above SQuote is a function that wraps a string in single quotes. Is there some standard library for sanitizing SQL query parameters for  Lazarus/FreePascal or Delphi for that matter?</p>\n"},{"tags":["delphi","file","delphi-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1408,"score":5,"question_id":1642220,"title":"Getting size of a file in Delphi 2010 or later?","body":"<p>Delphi 2010 has a nice set of new file access functions in <code>IOUtils.pas</code> (I especially like the UTC versions of the date-related functions). What I miss so far is something like</p>\n\n<pre><code>TFile.GetSize (const Path : String)\n</code></pre>\n\n<p>What is the Delphi 2010-way to get the size of a file? Do I have to go back and use FindFirst to access <code>TSearchRec.FindData</code>?</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","winapi","unicode","delphi-xe2","ansi"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13168169,"title":"winapinameA vs winapinameW - Unicode vs Ansi - Delphi XE2","body":"<p>I am using Delphi XE2 and importing SHGetFolderPath from Shell32.dll. I am running windows vista x64. When running SHGetFolderPathA The result is unclear.</p>\n\n<p>I.E.:</p>\n\n<pre><code>uses\n  Windows;\n\nfunction SHGetFolderPath(hwnd: Cardinal; csidl: Integer; hToken: Cardinal; dwFlags: Cardinal; pszPath: PChar): Cardinal; stdcall;external 'Shell32.dll' name 'SHGetFolderPathA';\n\nVar\n  Path:Array [0..MAX_PATH] of Char;\n  AppData:String;\n\nbegin\n  SHGetFolderPath(0,$001A,0,0,@path[0]);\n  MessageBox(0,Path,'a',0);\nend.\n</code></pre>\n\n<p>The result is:</p>\n\n<p><img src=\"http://i.stack.imgur.com/jN0qA.png\" alt=\"enter image description here\"></p>\n\n<p>Versus using SHGetFolderPathW:</p>\n\n<p>uses\n      Windows;</p>\n\n<pre><code>function SHGetFolderPath(hwnd: Cardinal; csidl: Integer; hToken: Cardinal; dwFlags: Cardinal; pszPath: PChar): Cardinal; stdcall;external 'Shell32.dll' name 'SHGetFolderPathW';\n\nVar\n  Path:Array [0..MAX_PATH] of Char;\n  AppData:String;\n\nbegin\n  SHGetFolderPath(0,$001A,0,0,@path[0]);\n  MessageBox(0,Path,'a',0);\nend.\n</code></pre>\n\n<p>The result clearly states the path to my AppData folder with no issue.</p>\n\n<p>When running this same code on x32 Vista when using SHGetFolderPathA works just fine.</p>\n\n<p>If someone could shine some light on why this is? I was under the impression the \"W\" api was usually for use on Unicode machines...?</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>I am now using the following code, with the same error:</p>\n\n<pre><code>uses\n  Windows;\n\nfunction SHGetFolderPath(hwnd: HWND; csidl: Integer; hToken: THandle; dwFlags: DWord; pszPath: PAnsiChar): HRESULT; stdcall; external 'SHFolder.dll' name 'SHGetFolderPathA';\n\nvar\n  path: array[0..MAX_PATH] of char;\nbegin\n  SHGetFolderPath(0,$001A,0,0, @path[0]);\n  MessageBox(0,path,'a',0);\nend.\n</code></pre>\n\n<hr>\n\n<p>Final Edit:</p>\n\n<p>Thank you all for the responses. The above declaration of SHGetFolderPath is fine. After looking through all responses, and taking in the information in each, I have come up with the following result:</p>\n\n<pre><code>uses\n  Windows;\n\nfunction SHGetFolderPath(hwnd: HWND; csidl: Integer; hToken: THandle; dwFlags: DWord; pszPath: PAnsiChar): HRESULT; stdcall; external 'shell32.dll' name 'SHGetFolderPathA';\n\nvar\n  path: array[0..MAX_PATH] of ansichar;\n  xRes:String;\nbegin\n  If SHGetFolderPath(0,$001A,0,0, @path[0]) = S_OK Then Begin\n    xRes := Path;\n    MessageBox(0,PWideChar(xRes),'Result',0);\n  End Else\n    MessageBox(0,'An error has occurred.','Result',0);\nend.\n</code></pre>\n\n<p>The resulting messagebox correctly displays the path to my AppData path.</p>\n\n<p>Thanks again for all of the responses.</p>\n"},{"tags":["delphi","email","delphi-2010","indy10"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13151386,"title":"Move mail item from one folder to another folder","body":"<p>How to move mail from one mailbox(user folder) to another mailbox (user folder) in a same mail account.Our mail server supports IMAP and POP3 protocal.I am using Delphi 2010   </p>\n"},{"tags":["delphi","c++builder","vcl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":13158103,"title":"Showing property of a TCheckBox is false when it should be true","body":"<p>I'm using C++ Builder XE, and have a problem with the \"Showing\" property of a TCheckBox.</p>\n\n<p>I have a <code>TForm</code> (ChannelConfigForm), in which there is a <code>TGroupBox</code> (AlarmsGroupBox), in which there is a <code>TCheckBox</code> (A4_en_Xbox).</p>\n\n<p>Sometimes, I cannot see some of the controls on the form.</p>\n\n<p>According to the help documentation :\n\"If the Visible properties of a component and all the parents in its parent hierarchy are true, Showing is guaranteed to be true. If one of the parents containing the control has a Visible property value of false, Showing may be either true or false. \nShowing is a read-only property.\"</p>\n\n<p>To find out what's happening, I wrote the following function to debug the program :\n(note : debugf in this function is simply a debug statement I wrote that works similar to printf, which writes debugging stuff to a form)</p>\n\n<pre><code>void ShowParentTree(TControl *Control)\n{\n  wchar_t Name[32];\n  static int level=0;\n  TWinControl *wc;\n\n  level++;\n  if (level==1)\n    debugf(L\"Parents of control \\\"%s\\\" (%s) :\",\n                       Control-&gt;Name.c_str(),\n                       Control-&gt;ClassName().c_str());\n\n  // Display what Control has as parents and if they're visible and showing\n  debugf(L\"level %d : %s-&gt;Visible  = %s\",level,\n                       Control-&gt;Name.c_str(),\n                       Control-&gt;Visible?L\"true\":L\"false\");\n  wc=(TWinControl *)Control;\n  debugf(L\"level %d : %s-&gt;Showing  = %s\",level,\n                       wc-&gt;Name.c_str(),\n                       wc-&gt;Showing?L\"true\":L\"false\");\n\n  if (Control-&gt;Parent)\n    ShowParentTree((TControl *)Control-&gt;Parent);\n\n  level--;\n}\n</code></pre>\n\n<p>Sometimes when I show the ChannelConfigForm I get the following :</p>\n\n<pre><code>Parents of control \"A4_en_Xbox\" (TCheckBox) :\nlevel 1 : A4_en_Xbox-&gt;Visible  = true\nlevel 1 : A4_en_Xbox-&gt;Showing  = false\nlevel 2 : AlarmsGroupBox-&gt;Visible  = true\nlevel 2 : AlarmsGroupBox-&gt;Showing  = true\nlevel 3 : ChannelConfigForm-&gt;Visible  = true\nlevel 3 : ChannelConfigForm-&gt;Showing  = true\n</code></pre>\n\n<p>which I understand as meaning that the A4_en_Xbox->Showing property is false when I think it should be true.</p>\n"},{"tags":["delphi","zip"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":120,"score":5,"question_id":13164299,"title":"Delphi XE2 TZipFile: replace a file in zip archive","body":"<p>I'd like to replace a file (= delete old and add new) in a zip archive with the Delphi XE2/XE3 standard System.Zip unit. But there are no replace/delete methods. Does anybody have an idea how it could be achieved without needing to extract all files and add them to a new archive?</p>\n\n<p>I have this code, but it adds the \"document.txt\" once more if it's already present:</p>\n\n<pre><code>var\n  ZipFile: TZipFile;\n  SS: TStringStream;\nconst\n  ZipDocument = 'E:\\document.zip';\nbegin\n  ZipFile := TZipFile.Create; //Zipfile: TZipFile\n  SS := TStringStream.Create('hello');\n  try\n    if FileExists(ZipDocument) then\n      ZipFile.Open(ZipDocument, zmReadWrite)\n    else\n      ZipFile.Open(ZipDocument, zmWrite);\n\n    ZipFile.Add(SS, 'document.txt');\n\n    ZipFile.Close;\n  finally\n    SS.Free;\n    ZipFile.Free;\n  end;\nend;\n</code></pre>\n\n<p>Note: I used TPAbbrevia before (that did the job), but I'd like to use Delphi's Zip unit now. So please do not answer something like \"use another library\". Thank you.</p>\n"},{"tags":["delphi","directshow","multimedia"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13163682,"title":"Detect when a new frame is displayed from Camera Stream using DirectShow","body":"<p>I use the following code to connect to the device and stream the video, its works great except I do not know how to detect when the actual frame changes</p>\n\n<p>vars</p>\n\n<pre><code>fGraph: iGraphBuilder;\nfBuilder: iCaptureGraphBuilder2;\nfDevEnum: iCreateDevEnum;\nfClassEnum: iEnumMoniker;\nfMoniker: iMoniker;\nfSrc: iBaseFilter;\nfFetched: pLongInt;\nfvideoWindow: iVideoWindow;\nfmediaControl: iMediaControl;\nfEvent: IMediaEvent;\nfMediaEvent: IMediaEventEx;\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>fGraph := createComObject(CLSID_FilterGraph) as iGraphBuilder;\nfBuilder := createComObject(CLSID_CaptureGraphBuilder2) as iCaptureGraphBuilder2;\nfBuilder.SetFiltergraph(fGraph);\nfDevEnum := createComObject(CLSID_SystemDeviceEnum) as iCreateDevEnum;\nfDevEnum.createClassEnumerator(CLSID_VideoInputDeviceCategory , fClassEnum , 0);\nfClassEnum.next(1 , fMoniker , fFetched);\nfMoniker.bindToObject(nil , nil , IID_IBaseFilter , fSrc);\nfGraph.addFilter(fSrc , 'Video Capture');\nfGraph.queryInterface(IID_IMediaControl , fmediaControl);\nfGraph.queryInterface(IID_IVideoWindow , fvideoWindow);\nfGraph.queryInterface(IID_IMediaEvent , fEvent);\nfEvent.queryInterface(IID_IMediaEventEx , fMediaEvent); // TForm(fOwner)\nfMediaEvent.SetNotifyWindow(self.Handle , WM_MMNOTIFY , Integer(self));\nfBuilder.renderStream(@PIN_CATEGORY_PREVIEW , @MEDIATYPE_VIDEO , fSrc , nil , nil);\nfvideoWindow.put_windowStyle(WS_CHILD or WS_CLIPSIBLINGS);\nfvideoWindow.setWindowPosition(0 , 0 , self.width , self.height);\nfvideoWindow.put_owner(self.Handle);\nfmediaControl.run;\n</code></pre>\n\n<p>As you can see I tried using IMediaEvent and IMediaEventEx, but that only fires when the video stream starting or stopping occur, i need to know every time a new frame is added.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":2,"view_count":209,"score":5,"question_id":13128578,"title":"Why a form with 500 components is slow?","body":"<p>I am creating a form where there are icons- like on desktop and they can be moved freely.\nI want to show sometimes even 500 or more icons so they need to work fast.\nMy icon is: </p>\n\n<blockquote>\n  <p>TMyIcon = class(TGraphicControl)</p>\n</blockquote>\n\n<p>so it does not have a Windows handle.\nThe drawing is:</p>\n\n<blockquote>\n  <ul>\n  <li>1 x Canvas.Rectangle (which is about 64x32)</li>\n  <li>1 x Canvas.TextOut (a bit smaller than the rectangle)</li>\n  <li>1 x Canvas.Draw (image is 32x32)</li>\n  </ul>\n</blockquote>\n\n<p>The code to move stuff is like this:\nMyIconMouseMove:</p>\n\n<pre><code>Ico.Left := Ico.Left + X-ClickedPos.X;\nIco.Top  := Ico.Top  + Y-ClickedPos.Y;\n</code></pre>\n\n<p>On the form there is usually like 50 or so icons- the rest is outside the visible area.\nWhen I have 100 icons- I can move them freely and it works fast. But when I create 500 icons then it gets laggy- but the number of visible icons is still the same.\nHow can I tell Windows to completely ignore the invisible icons so everything works smoothly?</p>\n\n<p>Or maybe there is a component which can show desktop-like icons with ability to move them around? Something like TShellListView with AutoArrange = False?</p>\n"},{"tags":["delphi","logging","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":13155718,"title":"How to enable regions (code folding) on non-.pas files?","body":"<p>Our <code>.log</code> files are plain-text files, that sometimes contain a rather large series of request/response dumps.</p>\n\n<p>I'd really like to surround those with an appropriate <code>{$REGION} / {$ENDREGION}</code> block, and have them fold away when viewed in a capable IDE like Delphi (omnipresent on our developer machines). </p>\n\n<p>However, Delphi doesn't seem to want to apply the code folding to anything that is not a <code>.pas</code>. </p>\n\n<p>Even though I associated <code>.log</code> files with Pascal Source formatting, I just get syntax highlighting, no code folding. </p>\n\n<p>Is there any secret trick to make that happen?</p>\n"},{"tags":["string","delphi","assembly","delphi-7"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":230,"score":2,"question_id":10122338,"title":"Delphi 7, strings problems","body":"<p>In my project I have a problem with strings \"out of memory exception\", MM is not used. The problem shows when lengths of the string goes to 2 300,000 symbols. Despite the fact that there is enough memory and in the same part of code I can create a sting with 100,000,000 characters.</p>\n\n<p>Google did not help, I can't disassemble it (have no skills), so I decided to create a minimal test example, where I can get out of memory exception on string less then 2 000 000 000 symbols. I could not create such example, but I created something stranger:</p>\n\n<pre><code>program Project2;\n{$APPTYPE CONSOLE}\nuses\n   SysUtils;\n\nvar s : string;\n    k : integer;\n\nfunction b : string;\nbegin\n result := 'f';\nend;\n\nprocedure c;\nvar ss : string;\nbegin\n  s := s + '{' +  b + '}';\n  ss :=  'a';\n\n  if k mod 100001 = 0 then\n  begin\n     // ss[1] := 'd';    // uncoment me\n     write(k mod 10);\n  end;\n\n  inc(k);\nend;\n\nbegin\n  while true do c;\nend.\n</code></pre>\n\n<p>This code works fine. It just adds something to a global string with some extra operations. The thing is if  you uncomment marked string it will slow down significantly (with or without optimization). Considering that this assign value once in 100,001 iterations, it must not slow down.</p>\n\n<p>Questions:</p>\n\n<ol>\n<li><p>How do default strings in Delphi work?</p></li>\n<li><p>How to avoid slow down?</p></li>\n<li><p>How to avoid out of memory?</p></li>\n</ol>\n\n<p>P.S. If I include FastMM into the main project the error disappears \np.p.s The example with the string uncommented sends my Windows 7 to BSOD in 3 minutes (from user mode).</p>\n"},{"tags":["delphi","element","freepascal","lazarus","control-array"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13160904,"title":"Lazarus/Delphi - indext/element of item clicked (control array)","body":"<p>I have an array of PANELs on a form and they are used as buttons. There is one event procedure assigned to them. So when I click on a <em>button</em>, I can see it's caption like this:</p>\n\n<pre><code>procedure TForm1.MenuAction0Click(Sender: TObject);\nbegin\n  TPanel(Sender).Font.Bold:= true;\n  ShowMessage( TPanel(Sender).Caption);\n\nend;\n</code></pre>\n\n<p>I want to know the button <em>number</em> (as in array element number) and not the caption. How is this possible?</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":100,"score":1,"question_id":13145632,"title":"LogonUser + CreateProcessAsUser at Service = error 1314","body":"<p>I have a windows service created with Delphi 7, with StartType = stSystem.</p>\n\n<p>Now I need to launch an application to make some things for me.\nThis application has a MainForm and other GDI resources.\nThe parameter passed to the application assigns values for some controls (like edits and memos) and then click at a button....</p>\n\n<p>I'm trying this:</p>\n\n<pre><code>var\n  token: cardinal;\n  si: TStartupInfo;\n  pi: TProcessInformation;\nbegin\n  if not LogonUser('admintest', '', 'secret123', LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, token) then\n    RaiseLastOSError;\n\n  try\n    if not ImpersonateLoggedOnUser(token) then\n      RaiseLastOSError;\n\n    fillchar(si, sizeof(si), 0);\n    si.cb := sizeof(si);\n    si.lpDesktop := PChar('winsta0\\default');\n    if not CreateProcessAsUser(token, nil, '\"c:\\...\\myapp.exe\" -doCrazyThings', nil, nil, false, NORMAL_PRIORITY_CLASS or CREATE_NEW_CONSOLE, nil, nil, si, pi) then\n      RaiseLastOSError;\n\n    CloseHandle(pi.hThread);\n    waitForSingleObject(pi.hProcess, INFINITE);\n    CloseHandle(pi.hProcess);\n  finally\n    CLoseHandle(token);\n  end;\nend;\n</code></pre>\n\n<p><strong>When I run my service executable as a normal application (-noservice), it starts as a Forms.Application and creates a MainForm with a button \"Start\".</strong>\n*<em>The button runs the same code that service run, but it doesn't works and it's rasing the eror code 1314 at createprocessasuser.</em>*</p>\n\n<p><strong>Why? What is the diference between SYSTEM service and a normal application launched by a administrator?</strong></p>\n\n<p>My environment is a Windows 7 Pro x64</p>\n\n<p>What am I doing wrong?\nHow can I solve this?\nCan someone post an example?</p>\n"},{"tags":["delphi","delphi-xe","datasnap"],"answer_count":4,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":1333,"score":0,"question_id":5035085,"title":"Delphi XE – Datasnap Filter problems","body":"<p>I have a tcp/ip  Datasnap -XE Server   that uses a PC1 and Zlib filter</p>\n\n<p>On the Client both of these filters are defined in DataSnap TSqlConnection</p>\n\n<p>When the client connects to the server I get a <strong>\"Connection Closed Gracefully”</strong> error message</p>\n\n<p>If I only use the PC1 filter on its own   - there is no problem</p>\n\n<p>If I only use the Zlib filter on its own    - there is no problem </p>\n\n<p>Any Ideas on how I can get both filters working at the same time?</p>\n"},{"tags":["delphi","soap","delphi-xe2","ews"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13140003,"title":"\"Attribute is not declared\" error in Delphi generated EWS SOAP request","body":"<p>This is working sample code calling ResolveNames in <a href=\"http://msdn.microsoft.com/en-us/library/bb204119%28EXCHG.80%29.aspx\" rel=\"nofollow\">EWS</a> that I generated with <a href=\"http://www.soapui.org\" rel=\"nofollow\">SoapUI</a> after retrieving the WDSL from Exchange Server:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;soapenv:Envelope \n  xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" \n  xmlns:typ=\"http://schemas.microsoft.com/exchange/services/2006/types\" \n  xmlns:mes=\"http://schemas.microsoft.com/exchange/services/2006/messages\"&gt;\n&lt;soapenv:Header&gt;&lt;typ:RequestServerVersion Version=\"Exchange2010\"/&gt;&lt;/soapenv:Header&gt;\n&lt;soapenv:Body&gt;\n  &lt;mes:ResolveNames ReturnFullContactData=\"1\" SearchScope=\"ActiveDirectoryContacts\"&gt;\n    &lt;mes:UnresolvedEntry&gt;deve&lt;/mes:UnresolvedEntry&gt;\n  &lt;/mes:ResolveNames&gt;\n&lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>This is the bare Delphi XE2 code that I use:</p>\n\n<pre><code>procedure TFrmTestEWS.BtnConnectClick(Sender: TObject);\nvar\n   lESB        : ExchangeServicePortType;\n   lResNames   : ResolveNames;\n   lReqVersion : RequestServerVersion;\n   lResResult  : ResolveNamesResponse;\n   lServerVer  : ServerVersionInfo;\n   lUnresolved : String;\nbegin\n   lServerVer  := ServerVersionInfo.Create;\n   lResNames   := ResolveNames.Create;\n   lReqVersion := RequestServerVersion.Create;\n   lUnresolved := 'Deve';\n   with lResNames do\n   begin\n      ReturnFullContactData := true;\n      SearchScope           := ResolveNamesSearchScopeType.ActiveDirectoryContacts;  // Scoped enums is on!\n      ParentFolderIds       := nil;\n      UnresolvedEntry       := lUnresolved;\n   end;\n   lReqVersion.Version := ExchangeVersionType.Exchange2010;\n   lESB := (HTTPRIO1 as ExchangeServicePortType);\n   lESB.ResolveNames(lResNames,\n                     nil,              // Impersonation\n                     nil,              // MailboxCulture\n                     lReqVersion,\n                     lResResult,\n                     lServerVer);\n</code></pre>\n\n<p>It generates:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;SOAP-ENV:Envelope \n  xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" \n  xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" \n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n&lt;SOAP-ENV:Body xmlns:NS1=\"http://schemas.microsoft.com/exchange/services/2006/types\"&gt;\n  &lt;ResolveNames xmlns=\"http://schemas.microsoft.com/exchange/services/2006/messages\" ReturnFullContactData=\"true\" NS1:SearchScope=\"ActiveDirectoryContacts\"&gt;\n    &lt;UnresolvedEntry&gt;deve&lt;/UnresolvedEntry&gt;\n  &lt;/ResolveNames&gt;\n  &lt;MailboxCulture xsi:nil=\"true\"/&gt;\n  &lt;ExchangeImpersonation xsi:nil=\"true\"/&gt;\n  &lt;NS1:RequestServerVersion Version=\"Exchange2010\"/&gt;\n&lt;/SOAP-ENV:Body&gt;\n&lt;/SOAP-ENV:Envelope&gt;\n</code></pre>\n\n<p>The error I get:<br /><br>\nThe request failed schema validation: The 'http://schemas.microsoft.com/exchange/services/2006/types:SearchScope' attribute is not declared.</p>\n\n<p>SearchScope is an attribute as defined in messages.xsd:</p>\n\n<pre><code>&lt;!-- ResolveNames request --&gt;\n\n&lt;xs:complexType name=\"ResolveNamesType\"&gt;\n    &lt;xs:complexContent&gt;\n        &lt;xs:extension base=\"m:BaseRequestType\"&gt;\n            &lt;xs:sequence&gt;\n                &lt;xs:element name=\"ParentFolderIds\" type=\"t:NonEmptyArrayOfBaseFolderIdsType\" minOccurs=\"0\"/&gt;\n                &lt;xs:element name=\"UnresolvedEntry\" type=\"t:NonEmptyStringType\"/&gt;\n            &lt;/xs:sequence&gt;\n            &lt;xs:attribute name=\"ReturnFullContactData\" type=\"xs:boolean\" use=\"required\"/&gt;\n            &lt;xs:attribute name=\"SearchScope\" type=\"t:ResolveNamesSearchScopeType\" default=\"ActiveDirectoryContacts\"/&gt;\n        &lt;/xs:extension&gt;\n    &lt;/xs:complexContent&gt;\n&lt;/xs:complexType&gt;\n\n&lt;xs:element name=\"ResolveNames\" type=\"m:ResolveNamesType\"/&gt;\n</code></pre>\n\n<p>with in types.xsd:</p>\n\n<pre><code>&lt;!-- ResolveNames request --&gt;\n\n&lt;xs:simpleType name=\"ResolveNamesSearchScopeType\"&gt;\n  &lt;xs:restriction base=\"xs:string\"&gt;\n    &lt;xs:enumeration value=\"ActiveDirectory\"/&gt;\n    &lt;xs:enumeration value=\"ActiveDirectoryContacts\"/&gt;\n    &lt;xs:enumeration value=\"Contacts\"/&gt;\n    &lt;xs:enumeration value=\"ContactsActiveDirectory\"/&gt;\n  &lt;/xs:restriction&gt;\n&lt;/xs:simpleType&gt;\n</code></pre>\n\n<p>I thought that NS1:SearchScope=\"ActiveDirectoryContacts\" is incorrect but leaving the NS1: out gives the same error.<br/>\nMaybe postponing the Exchange xmlns specs for types and messages to within the SOAP-ENV:Body is the reason for the error?<br/>\nAlso, the NS1:RequestServerVersion Version=\"Exchange2010\" not being in the SOAP_ENV:Header\n looks suspect.</p>\n\n<p>I have looked at <a href=\"http://stackoverflow.com/questions/12176625/ews-the-required-attribute-traversal-is-missing\">some</a> <a href=\"http://www.delphigroups.info/2/5/344800.html\" rel=\"nofollow\">Google results</a> but could not get it to work.</p>\n\n<p>Basically my question is:<br />\nHow can I move around the tags or xmlns attributes in the generated code until it works, without having to construct the entire SOAP myself?<br/>\nAnd if that is not possible what approach is best so that I can still benefit from the imported type library? (Stuff like <a href=\"http://stackoverflow.com/questions/1327151/soap-request-with-attribute\">this</a>?)</p>\n\n<p>Thanks<br/>\nJan</p>\n"},{"tags":["delphi","wsdl","delphi-xe2","ews"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13084064,"title":"How to fix unresolved types when importing Exchange Web Services (EWS) wsdl file?","body":"<p>When importing the wsdl file from <a href=\"https://ourmail.server/ews/services.wsdl\" rel=\"nofollow\">https://ourmail.server/ews/services.wsdl</a>, I initially got a ton of \"The following types, referred to in the WSDL document are not being represented in this file\" in the generated services.pas.<br />\nI then downloaded the wdsl file to disk, saw that it referenced <a href=\"http://schemas.microsoft.com/exchange/services/2006/messages\" rel=\"nofollow\">http://schemas.microsoft.com/exchange/services/2006/messages</a> and <a href=\"http://schemas.microsoft.com/exchange/services/2006/types\" rel=\"nofollow\">http://schemas.microsoft.com/exchange/services/2006/types</a>, downloaded <a href=\"https://ourmail.server/ews/types.xsd\" rel=\"nofollow\">https://ourmail.server/ews/types.xsd</a> and <a href=\"https://ourmail.server/ews/messages.xsd\" rel=\"nofollow\">https://ourmail.server/ews/messages.xsd</a>\nand modified the start of services.wdsl from</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;wsdl:definitions xmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\" xmlns:tns=\"http://schemas.microsoft.com/exchange/services/2006/messages\" xmlns:s=\"http://www.w3.org/2001/XMLSchema\" targetNamespace=\"http://schemas.microsoft.com/exchange/services/2006/messages\" xmlns:wsdl=\"http://schemas.xmlsoap.org/wsdl/\" xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\"&gt;\n    &lt;wsdl:types&gt;\n        &lt;xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"&gt;\n            &lt;xs:import namespace=\"http://schemas.microsoft.com/exchange/services/2006/messages\" schemaLocation=\"messages.xsd\"/&gt;\n        &lt;/xs:schema&gt;\n    &lt;/wsdl:types&gt;\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;wsdl:definitions xmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\" xmlns:tns=\"http://schemas.microsoft.com/exchange/services/2006/messages\" xmlns:s=\"http://www.w3.org/2001/XMLSchema\" targetNamespace=\"http://schemas.microsoft.com/exchange/services/2006/messages\" xmlns:wsdl=\"http://schemas.xmlsoap.org/wsdl/\" xmlns:t=\"http://schemas.microsoft.com/exchange/services/2006/types\"&gt;\n    &lt;wsdl:types&gt;\n        &lt;xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"&gt;\n            &lt;xs:import namespace=\"http://schemas.microsoft.com/exchange/services/2006/messages\" schemaLocation=\"file://d:/testing/web/exchange web services/types.xsd\"/&gt;\n            &lt;xs:import namespace=\"http://schemas.microsoft.com/exchange/services/2006/messages\" schemaLocation=\"file://d:/testing/web/exchange web services/messages.xsd\"/&gt;\n        &lt;/xs:schema&gt;\n    &lt;/wsdl:types&gt;\n</code></pre>\n\n<p>Now the generated services.pas contains (only) these errors:</p>\n\n<pre><code>// ************************************************************************ //\n// The following types, referred to in the WSDL document are not being represented\n// in this file. They are either aliases[@] of other types represented or were referred\n// to but never[!] declared in the document. The types from the latter category\n// typically map to predefined/known XML or Embarcadero types; however, they could also\n// indicate incorrect WSDL documents that failed to declare or import a schema type.\n// ************************************************************************ //\n// !:double          - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:duration        - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:time            - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:base64Binary    - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:boolean         - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:int             - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:string          - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:language        - \"http://www.w3.org/2001/XMLSchema\"[Hdr][Gbl]\n// !:dateTime        - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:lang            - \"http://www.w3.org/2001/XMLSchema\"[GblAttr]\n// !:nonNegativeInteger - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:anyURI          - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n// !:short           - \"http://www.w3.org/2001/XMLSchema\"[Gbl]\n</code></pre>\n\n<p>What \"xs:import\" line can I add to resolve these?<br />\nI have searched around for the W3C's datatypes.xsd and structures.xsd and tried the same approach, but I can't get it to work.</p>\n"},{"tags":["delphi","memory-leaks","delphi-7","fastmm","dunit"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":152,"score":3,"question_id":12253147,"title":"Delphi 7, FastMM and DUnit GUITesting failing tests with false memory leaks","body":"<p>I've had some problems with FastMM false positives. This time, the leaks are in the cases testing forms. It's very similar to the one I described <a href=\"http://stackoverflow.com/questions/11083350/delphi-7-dunit-and-fastmm-reporting-strings-incorrectly\">here</a>. </p>\n\n<p>I got a form and some plain old VCL controls in it. The first test run shows leaks which, in fact, doesn't exists. The second run gets no leaks. I've searched over all DUnit source code, but couldn't find the reason in order to fix it. Can somebody help me?</p>\n\n<p>I can't afford to run the test twice because: 1. It will be run in a continuous integration; 2. Some tests really take some time and doubling it wouldn't be wise.</p>\n\n<p>I checked the last 3 options in the DUnit GUI:\n    - Report memory leak type on Shutdown\n    - Fail TestCase if memory leaked\n    - Ignore memory leak in SetUp/TearDown</p>\n\n<p>Here are the sample codes:</p>\n\n<pre><code>    // form\n    type\n\n    TForm2 = class(TForm)\n      button1: TButton;\n    end;\n\n    implementation\n\n    {$R *.dfm}\n\n    // test\n    type\n\n    TTest = class(TGUITestCase)\n    private\n      a: TForm2;\n    public\n      procedure SetUp; override;\n      procedure TearDown; override;\n    published\n      procedure Test;\n    end;\n\n    implementation\n\n    procedure TTest.Setup;\n    begin\n      a := TForm2.Create(nil);\n    end;\n\n    procedure TTest.TearDown;\n    begin\n      FreeAndNil(a);\n    end;\n\n    procedure TTest.Test;\n    begin\n      a.Show;\n      a.close;\n    end;\n</code></pre>\n"},{"tags":["delphi","memory-leaks","hook"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":63,"score":5,"question_id":13155964,"title":"Delphi XE memory leak in TWSDLLookup.Destroy method","body":"<p>I am using Delphi XE. I have come across a memory leak problem using Delphi Soap. It turns out to be due to a missing .Free call in <code>TWSDLLookup.Destroy</code>, as described in <a href=\"http://qc.embarcadero.com/wc/qcmain.aspx?d=91160\" rel=\"nofollow\">QC 91160</a></p>\n\n<p>The problem that I have is the described work-around, which is simply to add <code>FLookup.Free</code> to the <code>TWSDLLookup.Destroy</code> method.<br>\n I don't want to change the Delphi source, so I tried copying the unit to my project folder, making the change and recompiling, as described <a href=\"http://stackoverflow.com/questions/1533686/can-i-recompile-the-pas-files-used-by-the-delphi-ide\">here</a> in Tom's answer. The problem with this technique is that it apparently only works if you also recompile all the dependent units. I have tried copying just <code>WSDLLookup.pas</code> to my project directory and I get a Stackoverflow error. I'm not familiar with Web Services / SOAP so I don't know what other units I should copy over if I do use this technique.</p>\n\n<p>Rob Kennedy's answer on the same page describes a different technique involving code hooking - but it doesn't seem to apply to object methods. I have done as he suggests and downloaded the free code for the TNT Unicode controls and located the relevant procedures, but I have been unable to find info on how to hook an object's methods - if indeed this is possible. If I could do this, I would then hook <code>TWSDLLookup.Destroy</code> and add the <code>FLookup.Free</code> call. </p>\n\n<p>Any ideas for how to fix this will be much appreciated. I'm a bit of a newbie programmer so I'm hoping that I've missed something obvious?</p>\n"},{"tags":["delphi","fonts","delphi-xe3","taction"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13154517,"title":"Changing font of TActionMainMenuBar when using Vcl styles","body":"<p>Normally one could change the font of a TActionMainMenuBar or TMainMenu like this: </p>\n\n<pre><code>Screen.MenuFont.Name := 'Calibri';\n</code></pre>\n\n<p>When using Vcl styles this isn't possible any more if a StyleHook is registered for the component. \nI went into the Bitmap Style Designer (formerly known as Vcl Style Designer) and changed the font for the <strong>MenuItemTextNormal</strong>. </p>\n\n<p>Problem is that changing the Font does nothing, I can only successfully change the Color of the text. </p>\n\n<p>Clearly I'm missing something here, why can I change the Color but not the Font?</p>\n"},{"tags":["delphi","windows-shell","controlpanel"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13153493,"title":"Why can't get control panel name?","body":"<p>I use Shell to get control panel</p>\n\n<p>Code: </p>\n\n<pre><code>procedure TForm1.FormCreate(Sender: TObject);\nvar\n  psfDeskTop: IShellFolder;\n  psfWork: IShellFolder; \n  pidworkDir: PITEMIDLIST;\n  pidChild: PITEMIDLIST;\n  pEnumList: IEnumIDList;\n  celtFetched: ULONG;\n  FileInfo: SHFILEINFOW;\n\nbegin\n\n  Memo1.Clear;\n  SHGetDesktopFolder(psfDeskTop);\n  //control panel\n  SHGetSpecialFolderLocation(0, CSIDL_CONTROLS, pidworkDir);  \n  psfDeskTop.BindToObject(pidworkDir, nil, IID_IShellFolder, psfWork);\n  psfWork.EnumObjects(0, SHCONTF_NONFOLDERS or SHCONTF_FOLDERS or SHCONTF_INCLUDEHIDDEN, pEnumList);\n  while pEnumList.Next(1, pidChild, celtFetched) = 0 do\n  begin\n\n    SHGetFileInfo(LPCTSTR(pidChild), 0, FileInfo, SizeOf(FileInfo), SHGFI_PIDL\n      or SHGFI_TYPENAME or SHGFI_DISPLAYNAME or SHGFI_USEFILEATTRIBUTES);\n\n    Memo1.Lines.Add(FileInfo.szDisplayName + '   +');\n\n  end;  \nend;\n</code></pre>\n\n<p>it can't get <code>FileInfo.szDisplayName</code> , i just use  <code>'   +'</code>   to make Memo1 dispaly.\nWhy can't get control panel name ?</p>\n\n<p><img src=\"http://i.stack.imgur.com/JEOW3.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1021,"score":1,"question_id":6906691,"title":"Delphi : Error 'Access violation at address 00536983 in module '","body":"<p>My code :</p>\n\n<pre><code>if dataset.IsEmpty then \n  DoSomething(x);\n</code></pre>\n\n<p>When  'if dataset.IsEmpty' runs l get the following error: 'Access violation at address xxxxxxxxx in module abc'</p>\n\n<p>Why am I getting this error? I don't know the explanation of 'access violation' - can someone please explain this to me and help me avoid this error.</p>\n\n<p>Thank you.</p>\n"},{"tags":["delphi","freepascal","lazarus","z-order"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13152360,"title":"freepascal/delphi components not appearing (z-order issue I think)","body":"<p>I had a PANEL on the form. Then dynamically I create many more panels and place them on the form to look like a menu.</p>\n\n<p>By mistake I deleted the main PANEL. then put it back as a new control.</p>\n\n<p>Now the dynamic buttons don't show. But there's no error. So I'm guessing that the dynamic components are there but invisible (behind the main PANEL).</p>\n\n<p>Is there a way to fix this? I can't seem to find a z-order property for the components.</p>\n\n<p>Please help.</p>\n\n<p>Here's the code segment:</p>\n\n<pre><code>  For MenuItemCount:= 1 to MenuItemLimit Do\n      Begin\n      MenuButtons[MenuItemCount] := TPanel.Create(Self);\n      With MenuButtons[MenuItemCount] do\n          begin\n\n            Width:=180 - (10*MenuItem[MenuItemCount].Level);\n            Left:=4+10*MenuItem[MenuItemCount].Level;\n\n            Height:=25;\n            Top:= 5 + Height * (MenuItemCount-1);\n            Color:= clMenu;\n            Cursor:=crHandPoint;\n\n            Parent := MenuGroup; //Parent container for the items.\n\n            Caption := MenuItem[MenuItemCount].Title;\n\n      end;//End for\n</code></pre>\n\n<p><code>MenuGroup</code> is the parent panel that is placed at design-time.</p>\n"},{"tags":["delphi","postgresql","runtime-error","freepascal","lazarus"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":13138271,"title":"Lazarus Free Pascal / Delphi - RunError 211","body":"<p>I'm trying to connect my Windows XP program (Lazarus) to my Ubuntu postgres server.</p>\n\n<p>When the Lazarus program runs, it seems to compile fine but I get this error:</p>\n\n<blockquote>\n  <p>Project ... raised exception class 'RunError(211)'.</p>\n</blockquote>\n\n<p>Then it terminates execution (and I don't see any output), and opens up a file <strong>customform.inc</strong>. In that file, it shows a procedure <code>procedure TCustomForm.DoCreate;</code> where it highlights a line: <code>if Assigned(FOnCreate) then FOnCreate(Self);</code></p>\n\n<p>I believe this is one of the system's files.</p>\n\n<p>I never get to see any output.\nWhat could this be? Thanks!</p>\n\n<p>MORE INFO:</p>\n\n<p>I've narrowed down the error to this line:</p>\n\n<pre><code>  dbQuery_Menu.SQL.Text:='Select * From \"tblMenus\"';\n\n  dbQuery_Menu.Open;\n</code></pre>\n\n<p>the exception is triggered when the OPEN statement gets executed.</p>\n\n<p>BTW, dbQuery_Menu is defined as a TSQLQuery component.</p>\n\n<p>Clueless! :(</p>\n"},{"tags":["delphi","encryption","delphi-2010","password-protection"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":204,"score":6,"question_id":13145112,"title":"Secure way to store password in Windows","body":"<p>I'm trying to protect a <strong>local database</strong> that contains sensitive info (similar to <a href=\"http://stackoverflow.com/questions/9286398/store-password-in-application\">this question</a>, only <strong>for delphi 2010</strong>)</p>\n\n<p>I'm using <a href=\"http://www.yunqa.de/delphi/doku.php/products/sqlite3/index\" rel=\"nofollow\">DISQLite component</a>, which does support AES encryption, but I still need to protect this password I use to decrypt &amp; read the database.</p>\n\n<p>My initial idea was to generate a random password, store it using something like DPAPI (<code>CryptProtectData</code> and <code>CryptUnprotectData</code> functions found in Crypt32.dll), but I couldn't find any example on that for Delphi</p>\n\n<p>My question is: how can I safely store a randomly generated password? Or, assuming the DPAPI road is secure, how can I implement this DPAPI in Delphi?</p>\n"},{"tags":["delphi","autocomplete","combobox"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":964,"score":4,"question_id":6667054,"title":"How can I filter the contents of a combo box based on what's been typed?","body":"<p>We have a combo box with more than 100 items. </p>\n\n<p>We want to filter out the items as we enter characters in combo box. For example if we entered 'ac' and click on the drop down option then we want it to display items starting with 'ac' only. </p>\n\n<p>How can I do this?</p>\n"},{"tags":["delphi"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":204,"score":7,"question_id":13132973,"title":"String indexing vs. dynamic array indexing in Delphi","body":"<p>In Delphi, why are AnsiStrings indexed from one and dynamic arrays indexed from zero?  Is this a historical accident, to make AnsiStrings work more like ShortStrings, or is there some deeper logic at work?</p>\n"},{"tags":["delphi","delphi-2010","manifest"],"answer_count":1,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":1126,"score":8,"question_id":3417038,"title":"are delphi 2010 programs capable of tackling vista/win7 UAC by default","body":"<p>if you compile a program in D2010 a manifest .res file is automatically generated. is it included in your program by default? or you have to include it yourself?if yes what level of privilage is given to you? my program modifies a registery key would it be able to do so with out any modifications to .res file?if no what modifications i need to do?<br>\n<strong>a side question</strong>: is there a component/expert(prefably free) that can generate/include .res file in my delphi 7 and delphi 2007 projects automatically just like delphi 2010?<br>\n<strong>edit</strong>: forgot to mention i do not have win7 or vista nor have i ever used them<br>\n<strong>edit2</strong>:i have included a manifest file just in case following <a href=\"http://delphi.about.com/od/delphitips2009/qt/delphi-vista-registry-run-on-startup.htm\">this tutorial</a> but the tutorial only talks about windows vista and not 7 would the .xml(manifest) file in this tutorial make my app capable of dealing with win7 UAC too<br>\n<strong>edit3</strong> if i include my own manifest file and delphi is including it by default as well that will make 2 manifest files(1 with admin previlages and 2nd without) would this cause any problems/unpredictable behaviour</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":77,"score":1,"question_id":13105804,"title":"delphi calling AMD ADL c++ dll","body":"<p>Trying to interface with AMD ADL library (DLL) to retrieve info on the graphics card.  Got some of the functions to work but having problems.<br><br>Pls see this post with same question but no answer: <a href=\"http://stackoverflow.com/questions/11110191/ati-adl-adapterinfo-get\">ATI ADL - AdapterInfo_Get</a> <br></p>\n\n<p>The function returns using a delphi array but the content is wrong.<br>\nThe function returns using a pointer to a buffer but the data is the same [wrong].<br>\n<em>[see below for code example]</em><br></p>\n\n<p>The function is defined in the documentation as follows:<br></p>\n\n<pre><code>int ADL_Adapter_AdapterInfo_Get(LPAdapterInfo   lpInfo,   int  iInputSize)          \n\n\nRetrieves all OS-known adapter information. \n\nThis function retrieves the adapter information of all OS-known adapters in the\nsystem. OS-known adapters can include adapters that are physically present in the  \nsystem (logical adapters) as well as ones that are no longer present in the system   \nbut are still recognized by the OS.\n\nSupported Platforms:\nLinux and Windows(XP, Vista and Windows 7); 32bit and 64bit \n\nParameters:\n[in]    iInputSize  The size of the lpInfo buffer. \n[out]   lpInfo  The pointer to the buffer containing the retrieved adapter information. \n\nReturns:\nIf the function succeeds, the return value is ADL_OK. Otherwise the return value is an ADL error code. Result Codes\n\nRemarks:\nThis API take a fixed-size output array. For dynamic-size output, use ADL_Adapter_AdapterInfoX2_Get function. \n</code></pre>\n\n<p>The adl_structures.pas file defines AdapterInfo as follows:\ntype</p>\n\n<pre><code>  AdapterInfo = record\n    iSize : integer;\n    iAdapterIndex : integer;\n    strUDID : array [0..ADL_MAX_PATH] of char;\n    iBusNumber : integer;\n    iDeviceNumber : integer;\n    iFunctionNumber : integer;\n    iVendorID : integer;\n    strAdapterName : array [0..ADL_MAX_PATH] of char;\n    strDisplayName : array [0..ADL_MAX_PATH] of char;\n    iPresent : integer;\n\n   {$IFDEF MSWINDOWS}\n    iExist : Integer;\n    strDriverPath : array [0..ADL_MAX_PATH-1] of Char;\n    strDriverPathExt : array[0..ADL_MAX_PATH-1] of Char;\n    strPNPString : array[0..ADL_MAX_PATH-1] of char;\n    iOSDisplayIndex : integer;  \n   {$ENDIF} { (_WIN32) || (_WIN64) }\n\n  end;\n  LPAdapterInfo = ^AdapterInfo;\n</code></pre>\n\n<p>I declared a type for each function this way:</p>\n\n<pre><code>type\n  TADL_MAIN_CONTROL_CREATE = function(param1 : ADL_MAIN_MALLOC_CALLBACK; param2 : integer) : integer; cdecl;\n  TADL_MAIN_CONTROL_DESTROY = function : integer; cdecl;\n  TADL_OVERDRIVE5_TEMPERATURE_GET = function (iAdapterIndex, iThermalControllerIndex : integer; var lpTemperature : ADLTemperature) : integer; cdecl;\n  TADL_OVERDRIVE5_FANSPEED_GET = function (iAdapterIndex, iThermalControllerIndex: integer; var lpFanSpeedValue: ADLFanSpeedValue): integer; cdecl;\n  TADL_ADAPTER_NUMBEROFADAPTERS_GET = function (var lpNumAdapters: integer): integer; cdecl;\n  TADL_ADAPTER_ACTIVE_GET = function(iAdapterIndex: integer; var lpStatus: Integer): Integer; cdecl;\n  TADL_ADAPTER_ADAPTERINFO_GET = function(AInfo : Pointer; iInputSize: Integer): integer; cdecl;{stdcall;}\n</code></pre>\n\n<p>Created variables this way:</p>\n\n<pre><code>var\n  ADL_Overdrive5_Temperature_Get : TADL_OVERDRIVE5_TEMPERATURE_GET;\n  ADL_Adapter_NumberOfAdapters_Get : TADL_ADAPTER_NUMBEROFADAPTERS_GET;\n  ADL_Adapter_Active_Get : TADL_ADAPTER_ACTIVE_GET;\n  ADL_Adapter_AdapterInfo_Get : TADL_ADAPTER_ADAPTERINFO_GET;\n  ADL_Overdrive5_FanSpeed_Get : TADL_OVERDRIVE5_FANSPEED_GET;\n\n  temperature : ADLTemperature;\n  fanspeed : ADLFanSpeedValue;\n  numGFX, numActiveGFX : Integer;\n  GFXActive : Integer;\n  x, size : integer;\n\n  ADL_Info : AdapterInfo;\n  ADL_PInfo : LPAdapterInfo;\n\n  ADL_AInfo : Array of AdapterInfo;\n\n  ADL_Result : Integer;\n  ActiveAdapters : Array of Integer;\n  Addr : Pointer;\n  strPresent : String;\n</code></pre>\n\n<p>Linking to external functions this way:</p>\n\n<pre><code>ADL_Adapter_NumberOfAdapters_Get := GetProcAddress(hDLL, 'ADL_Adapter_NumberOfAdapters_Get');\n    ADL_Overdrive5_Temperature_Get := GetProcAddress(hDLL, 'ADL_Overdrive5_Temperature_Get');\n    ADL_Adapter_Active_Get := GetProcAddress(hDLL, 'ADL_Adapter_Active_Get');\n    ADL_Adapter_AdapterInfo_Get := GetProcAddress(hDLL, 'ADL_Adapter_AdapterInfo_Get');\n    ADL_Overdrive5_Fanspeed_Get := GetProcAddress(hDLL, 'ADL_Overdrive5_FanSpeed_Get');\n</code></pre>\n\n<p>I then try to get the data into an array and into a memory buffer.  Both return the exact same data but its not valid.  Note that the other functions are working or return valid errors such as \"not supported by driver\".</p>\n\n<p>Array:</p>\n\n<pre><code>if Assigned(ADL_Adapter_AdapterInfo_Get) then\n    begin\n      //*** Array (delphi way)\n      Setlength(ADL_AInfo, numGFX);\n      Addr := ADL_AInfo;\n      size := sizeof(AdapterInfo)*numGFX;\n\n      try\n        ADL_Result := ADL_Adapter_AdapterInfo_Get(Addr, size);\n        If ADL_Result = ADL_OK then\n        begin\n          for x := 0 to numGFX-1 do\n            begin\n              //using a delphi array\n              Memo1.Lines.Add('Vender ID for Adapter Index '+IntToStr(ADL_AInfo[x].iAdapterIndex)+' is '+IntToStr(ADL_AInfo[x].iVendorID));\n              Memo1.Lines.Add('Device Number for Adapter Index '+IntToStr(ADL_AInfo[x].iAdapterIndex)+' is '+IntToStr(ADL_AInfo[x].iDeviceNumber));\n              Memo1.Lines.Add('Adatper Name for Adapter Index '+IntToStr(ADL_AInfo[x].iAdapterIndex)+' is '+ADL_AInfo[x].strAdapterName);\n              Memo1.Lines.Add('Display Name for Adapter Index '+IntToStr(ADL_AInfo[x].iAdapterIndex)+' is '+ADL_aInfo[x].strDisplayName);\n              if ADL_AInfo[x].iPresent = 0 then strPresent := 'not present' else strPresent := 'present';\n              Memo1.Lines.Add('Adapter Index '+IntToStr(ADL_AInfo[x].iAdapterIndex)+' is '+strPresent);\n            end;\n        end\n        else\n          Memo1.Lines.Add('Error : '+IntToStr(ADL_Result));\n      finally\n      end;\n    end;\n</code></pre>\n\n<p>Memory buffer:</p>\n\n<pre><code>if Assigned(ADL_Adapter_AdapterInfo_Get) then\nbegin\n  //*** Pointer (c lookalike)\n  size := sizeof(AdapterInfo)*numGFX;\n  //GetMem(ADL_PInfo, size);\n  ADL_PInfo := AllocMem(sizeof(AdapterInfo) * numGFX);\n\n\n  try\n    ADL_Result := ADL_Adapter_AdapterInfo_Get(ADL_PInfo, size);\n    If ADL_Result = ADL_OK then\n    begin\n      for x := 0 to numGFX-1 do\n        begin\n          //using getmem with a pointer to a record\n          Memo1.Lines.Add('Vender ID for Adapter Index '+IntToStr(ADL_PInfo.iAdapterIndex)+' is '+IntToStr(ADL_PInfo.iVendorID));\n          Memo1.Lines.Add('Device Number for Adapter Index '+IntToStr(ADL_PInfo.iAdapterIndex)+' is '+IntToStr(ADL_PInfo.iDeviceNumber));\n          Memo1.Lines.Add('Adatper Name for Adapter Index '+IntToStr(ADL_PInfo.iAdapterIndex)+' is '+ADL_PInfo.strAdapterName);\n          Memo1.Lines.Add('Display Name for Adapter Index '+IntToStr(ADL_PInfo.iAdapterIndex)+' is '+ADL_PInfo.strDisplayName);\n          if ADL_PInfo.iPresent = 0 then strPresent := 'not present' else strPresent := 'present';\n          Memo1.Lines.Add('Adapter Index '+IntToStr(ADL_PInfo.iAdapterIndex)+' is '+strPresent);\n\n          inc(ADL_Pinfo);\n        end;\n    end\n    else\n      Memo1.Lines.Add('Error : '+IntToStr(ADL_Result));\n\n  finally\n\n   // ZeroMemory(ADL_PInfo, size);\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi","activex","delphi-7","adobe-reader"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":566,"score":0,"question_id":5889122,"title":"Getting Page Number of PDF document from Adobe Reader's ActiveX control","body":"<p>I'm successfully using Delph 7 and the ActiveX control of Adobe Reader version 7 to extract the page number from an open PDF document housed in the ActiveX component (TAcroPDF). I am interested in upgrading to the latest Adobe reader but something changed in Adobe Reader 8 (and 9) that prevented me from upgrading (I have not tested Adobe 10/X). With Adobe 7, I use the Windows SDK function EnumChildWindows to gather the child windows of my form containing the TAcroPDF component and find a control with the name AVPageNumView, then FindWindowEx to get its handle. Then I call SendMessage to get the text of that control which has the page number information. With Adobe 8 and 9, window/control AVPageNumView is no longer there it seems. Thus I am stuck in Adobe 7 and still looking for a way to get the page number, preferably Adobe 9 or 10/X. The goal would be to not have to do a complete rewrite with another technology, but I am open to that if its the only solution.</p>\n\n<p>Thanks,\nMichael</p>\n"},{"tags":["delphi","youtube","autoplay"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13145614,"title":"Youtube embeded in delphi autoplay&loop refreshing","body":"<p>I've just made simple YouTube player in SDI using embedded links inside the <code>TWebBrowser</code> component, and managed to create auto play and loop (loop one and loop all) buttons as well as quality changing radio buttons, but they're all based on hyperlink changes, and therefore does not perform a change while video playing, but have to send \"Go\" command again. I've implemented it with the buttons mentioned above, but it's annoying to restart video when making a change, especially if I just want to set loop somewhere in the middle of the song.</p>\n\n<p>Is there any way of maybe reading current time and set then set link with that time starting, or any other way of solving this, so when pressing the button, the action will be accepted with no refresh, or won't restart the video from beginning?</p>\n\n<p>The default buttons for changing quality within the player itself does exactly that, but can't find a command.</p>\n\n<p>Also, on YouTube there is a button in playlist to loop, as well as randomize, but can't find them either.</p>\n"},{"tags":["delphi","virtualtreeview","tvirtualstringtree"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13146789,"title":"VirtualStringTree: Fix node hitbox after OnBeforeCellPaint","body":"<p>I've for a virtualstringtree control on my form which has to display icons from an imagelist for certain nodes. This works fine, however, it also has to display custom drawn icons that are as tall as the node and square, for certain nodes.</p>\n\n<p>I'm using the OnBeforeCellPaint event to draw these images and change the ContentRect to accommodate for the extra space it requires in the item.</p>\n\n<pre><code>ContentRect.Offset(ContentRect.Height + 4, 0);\n</code></pre>\n\n<p>(The +4 is there to have the same spacing from the \"icon\" for the text as with the ones loaded from the imagelist)</p>\n\n<p>This method seems to work fine, the nodes are drawn correctly and the selection rectangles are as well. However, the hitboxes for clicking the nodes don't seem to get updated. I have to click the original ContentRect to select the node.</p>\n\n<p>How do I update the hitbox?</p>\n"},{"tags":["sql-server","delphi","stored-procedures","ado"],"answer_count":4,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":2252,"score":9,"question_id":254486,"title":"View output of 'print' statements using ADOConnection in Delphi","body":"<p>Some of my MS SQL stored procedures produce messages using the 'print' command.  In my Delphi 2007 application, which connects to MS SQL using TADOConnection, how can I view the output of those 'print' commands?</p>\n\n<p>Key requirements:\n1) I can't run the query more than once; it might be updating things.\n2) I need to see the 'print' results even if datasets are returned.</p>\n"},{"tags":["delphi","tstringgrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13132206,"title":"Calculating StringGrid height when adding a row","body":"<p>Given that I want my string grid to have equal height rows ...</p>\n\n<p>I know that it will start with exactly 5 rows and I make it so at design time.</p>\n\n<p>At run time I may want to add some extra rows (and I have code to not add below the bottom of the parent; at that point I rely on scroll bars).</p>\n\n<p>It seems that sg.height := sg.height + sg.RowHeights[0]; is not producing the expected result - there is unexpecetd whitespace after the last row (I am still trying to calculate how the extra height corresponds to the number of rows, but it looks like it is the height of one row, no matter how many rows are in the grid).</p>\n\n<p>Is there something else I should take into account? (perhaps GridLineWidth?) Or could I have set a property wrongly in the Object Inspector? Should I be using <code>GridHeight</code>, rather than <code>Height</code>?</p>\n\n<p>Note: this problem only occurs when the stringgid is as wide as all cells and the scroll bar appears, drawing over part of the last column. If I leave an ugly blank sapce at the right of the string grid for the scroll bar to fit into, the problem does not occur.</p>\n\n<p>Can anyone tell me the formula to calculate the new gridheight after adding a number of rows? Or wthere I am doing something wrong.</p>\n"},{"tags":["delphi"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":13139865,"title":"How to Read contents of Windows Event Log Using Delphi","body":"<p>Is there a class or function which allows you to read the Windows event log.  This is the log you see when you open  <strong>eventvwr.msc</strong>.  And ideally select a specific log (in my case the <strong>Applications</strong> log under <strong>Windows Log</strong>), and place filters on date and source.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":154,"score":4,"question_id":13135332,"title":"Interfaces without reference counting","body":"<p>After reading many post on StackOverflow about the cons of using automatic reference counting for Interfaces, I started trying to manually reference counting each interface instantiation.</p>\n\n<p>After trying for a full afternoon I give up!</p>\n\n<p>Why do I get Access Violation when I call FreeAndNil(p)?</p>\n\n<p>What follow is a complete listing of my simple unit.</p>\n\n<pre><code>unit fMainForm;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, StdCtrls;\n\ntype\n  TForm4 = class(TForm)\n    btn1: TButton;\n    procedure FormCreate(Sender: TObject);\n    procedure btn1Click(Sender: TObject);\n  end;\n\ntype\n  IPersona = interface(IInterface)\n  ['{44483AA7-2A22-41E6-BA98-F3380184ACD7}']\n    function GetNome: string;\n    procedure SetNome(const Value: string);\n    property Nome: string read GetNome write SetNome;\n  end;\n\ntype\n  TPersona = class(TObject, IPersona)\n  strict private\n    FNome: string;\n    function GetNome: string;\n    procedure SetNome(const Value: string);\n  protected\n    function _AddRef: Integer; stdcall;\n    function _Release: Integer; stdcall;\n    function QueryInterface(const IID: TGUID; out Obj): HResult; stdcall;\n  public\n    constructor Create(const ANome: string);\n    destructor Destroy; override;\n  end;\n\nvar\n  Form4: TForm4;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm4.FormCreate(Sender: TObject);\nbegin\n  ReportMemoryLeaksOnShutdown := True;\nend;\n\nprocedure TForm4.btn1Click(Sender: TObject);\nvar\n  p: IPersona;\nbegin\n  p := TPersona.Create('Fabio');\n  try\n    ShowMessage(p.Nome);\n  finally\n    FreeAndNil(p);\n  end;\nend;\n\nconstructor TPersona.Create(const ANome: string);\nbegin\n  inherited Create;\n  FNome := ANome;\nend;\n\ndestructor TPersona.Destroy;\nbegin\n  inherited Destroy;\nend;\n\nfunction TPersona._AddRef: Integer;\nbegin\n  Result := -1\nend;\n\nfunction TPersona._Release: Integer;\nbegin\n  Result := -1\nend;\n\nfunction TPersona.QueryInterface(const IID: TGUID; out Obj): HResult;\nbegin\n  if GetInterface(IID, Obj) then\n    Result := S_OK\n  else\n    Result := E_NOINTERFACE;\nend;\n\nfunction TPersona.GetNome: string;\nbegin\n  Result := FNome;\nend;\n\nprocedure TPersona.SetNome(const Value: string);\nbegin\n  FNome := Value;\nend;\n\nend.\n</code></pre>\n"},{"tags":["flash","delphi","internet-explorer-9","local","twebbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":109,"score":3,"question_id":13021257,"title":"TEmbeddedWB/Webbrowser set local zone security to accept loading local SWF file does not work but do work in 'real' browser","body":"<p><strong>Story:</strong>\nI developing a game that I want to deploy to many platforms using a webview/embedded browser for the target os. Write once, deploy many times ;-)</p>\n\n<p>The game itself is developed with use of HTML5/CSS3 and javascript and also with a little bit flash for platforms that supports flash like Windows and MacOsX. The flash file is used for audio only, because the HTML5 audio tag can operate different platforms and does not have many features compared to flash. On mobile platforms it will switch back to the audio tag.</p>\n\n<p>Anyway, I have written a 'compiler' that can compact my code and changes/map paths of resources/assets to the local filesystem. This is to be able to deploy games or other apps created with HTML/etc without the need to access the internet and to combine it into a single package. All javascript is minified and 'embedded' in the HTML file including CSS and some small images. But this cannot be done with Flash/SWF files (i think?).</p>\n\n<p><strong>This is my question:</strong>\nI have tested the local version of the game in a 'real' desktop browser like Firefox, Safari, Opera ,Chrome and Internet Explorer 9. Flash is working in all browsers except Chrome. </p>\n\n<p>BUT: when i load it into the embedded version of IE9 (Delphi executable with TEmbeddedWB), it won't load the flash file.\nI found some code to set the zone mapping security but doesn't seems to work:</p>\n\n<pre><code>  var \n   sUrl : string;\n   sw : WideString;\n.....\n.....\n  sUrl:='file:///C:\\mygame\\mygame.html';\n  sw:=WideString( sUrl );\n  if( embeddedWB.SecurityManager.SetZoneMapping(URLZONE_LOCAL_MACHINE, PWideChar( @sw ),SZM_CREATE) = S_OK ) then\n   showMessage( 'OK' )\n  else showMessage( 'NOT SET' );  \n  embeddedWB.Go( sUrl );\n\n.....\n</code></pre>\n\n<p>A messagebox with 'OK' shows up and loads the document but no flash (no sound).</p>\n\n<p>Question: <strong>What is wrong, why is it not working, anybody any idea how to solve this?</strong></p>\n\n<p>For your information:</p>\n\n<ul>\n<li>I have tested that IE9 is running</li>\n<li>The flash file uses Security.allowDomain( \"*\" );</li>\n<li>I have created a security policy xml file for the SWF (crossdomain.xml) </li>\n</ul>\n\n<p>crossdomain.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE cross-domain-policy SYSTEM \"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd\"&gt;\n&lt;cross-domain-policy&gt;\n  &lt;site-control permitted-cross-domain-policies=\"all\" /&gt;\n  &lt;allow-access-from domain=\"*\" /&gt;\n  &lt;allow-http-request-headers-from domain=\"*\" headers=\"*\"/&gt;\n&lt;/cross-domain-policy&gt;    \n</code></pre>\n\n<p>Thank you for any reply. If you have any questions, please let me know.</p>\n"},{"tags":["arrays","web-services","delphi","variant"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":12825099,"title":"Getting Data from a VarArray using Delphi","body":"<p>I have a WebService that returns a Variant me that it has an Array ie varArray, would like to know how to get the data that varArray.</p>\n\n<p>Thanks for the help.</p>\n"},{"tags":["string","delphi","binary"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":108,"score":-3,"question_id":13130396,"title":"Checking the contents of TStringStream","body":"<p>I have some nice or not so nice data in a <code>TStringStream</code> (or it can be any <code>TStream</code>), what I would like to visualize in the best way, if it contains text, I would like to display it as a Text, if it's not possible, I would like to display the Hex codes. I understand that there's no <strong>bullet-proof</strong> way of reliably say that's a text or binary, but not that's the goal, just visualize it for debugging proposes. </p>\n\n<p>So if the string </p>\n\n<ul>\n<li>has only characters <code>Chars</code> with codes, between 32 and 127, I can\naccept it as an <code>AnsiString</code>. <em>it's easy implement</em></li>\n<li>if not, I would try to convert it to an\n<code>Utf8String</code>, as I know <code>Utf8String</code> has a <em>format</em>, so I could decide is\nit a valid utf8 string or not. So I need some kind of function which can\ntell me yes, it can be an utf8string. if I'm wrong, who cares, if it will be an \nunreadable text, that's not a problem, I can't read hex codes fluently either.</li>\n<li>if it's still not the case, I would like to interpret it as a widestring, this is the\nhardest part, because as I know It hasn't got any <em>format</em>, so I would need to guess a\nlot here, this needs the most creativity. If It's completly a mission impossible, than\nskip this point. but say I'm not expecting Chinese characters.</li>\n<li>else: display the hex codes.</li>\n</ul>\n\n<p>I completely rewrite my question, because everybody was commenting to the fact that, where the data came from, and how should I define a protocol (also I get useful hints, thanks for that), which didn't get me closer to solve my problem, which hopefully is described better in the new question.</p>\n"},{"tags":["delphi","compiler-directives"],"answer_count":3,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":204,"score":7,"question_id":13112257,"title":"How can I tell at compile time whether the project is a program or a library?","body":"<p>I'm trying to know if the project is a library or not, after read the help I wrote this code that does not work:</p>\n\n<pre><code>{$IF DEFINED(LIBPREFIX)}\n    {$DEFINE PROJECT_IS_EXECUTABLE}\n    {$UNDEF PROJECT_IS_LIBRARY}\n{$ELSE}\n    {$DEFINE PROJECT_IS_EXECUTABLE}\n    {$UNDEF PROJECT_IS_LIBRARY}\n{$IFEND}\n</code></pre>\n\n<p>I tried DEFINED, DECLARED and </p>\n\n<pre><code>{$IF (LIBPREFIX = '')}\n</code></pre>\n\n<p>Every try always returns the same for DLLs and for programs.\nHow can I do this using only built-in compiler directives?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>My intention is to remove the extra information from \"PE File\". </p>\n\n<p>I do it directly in .dpr project file, so no matter how the other units were compiled, but I can not do the same in DLL projects.</p>\n\n<p>Therefore I was looking a way to block it in DLL projects.</p>\n\n<p>This is how I solved this issue, I add this directives to my .dpr programs:</p>\n\n<pre><code>  {$DEFINE STRIPE_PE_INFO}\n  {$DEFINE STRIPE_RTTI}\n  {$I DDC_STRIP.inc}\n</code></pre>\n\n<p>And DDC_STRIP.inc has all the logic.</p>\n"},{"tags":["delphi","variant"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":92,"score":3,"question_id":13143372,"title":"How to convert Array of bytes to Variant","body":"<p>How to convert a byte array to Variant?\nI have a WebService that should receive an array of byte, but it only accepts variable of type VARIANT, I wonder how to convert in order to pass it as parameter for Web Services.</p>\n\n<p>thank you</p>\n"},{"tags":["delphi","compression","gzip","delphi-xe2","datasnap"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13136033,"title":"DataSnap XE2 Server - Uses GZIP compression?","body":"<p>Does anybody know if a DataSnap server (using HTTP/HTTPS) built with Delphi XE2 uses GZIP compression for it's responses by default?  Is there any way of enabling/disabling this?</p>\n"},{"tags":["delphi","modal","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":123,"score":1,"question_id":13140321,"title":"How do I make a dialog modal with respect to some, but not all, of the program's other windows?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12953225/how-can-i-make-a-form-that-is-not-disabled-when-another-form-is-shown-modally\">How can I make a form that is not disabled when another form is shown modally?</a>  </p>\n</blockquote>\n\n\n\n<p>Suppose I have an application with three forms: a main form that leads the user through a workflow, wizard style; a modal window that shows occasionally in certain steps of the wizard; and a third \"information\" window, which could show at any time, independent of where in the workflow the user is.</p>\n\n<p>How do I make the modal window grab focus away from the main form, but keep the info window usable and responsive at all times?</p>\n\n<p>Using the most obvious <code>InfoFrame.Create(nil).Show</code> from the main frame leaves the info window unusable when the modal form is showing.</p>\n\n<p>Curiously, if I create and show the info window from the modal window, it will be responsive in the desired way, and it persists after the modal window is dismissed. When the modal window is shown again, though, the info window is forced into the background and becomes unresponsive.</p>\n\n<p>How do I make the info windows remain usable at all times, even when another form's <code>ShowModal</code> procedure has been called?</p>\n\n<p><sub>In the actual application I'm working on, there are actually tens of modal forms from about a dozen 'workflow' main windows (many of them are also modal), but only one info window (of which multiple instances may be shown),  I'd prefer not to have to change every call to ShowModal to something else, although I'm not averse to wrapping or subclassing the call if that's the only option.</sub></p>\n"},{"tags":["delphi","delphi-xe","vcl"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":156,"score":6,"question_id":12953225,"title":"How can I make a form that is not disabled when another form is shown modally?","body":"<p>I have a utility dialog (non-modal and stay-on-top) that should be accessible at all times when using the application (think of a dialog that can be used to take notes while working with the application) <strong>even if a modal dialog is displayed</strong>.</p>\n\n<p>The rest of the application cannot be changed.</p>\n\n<p>Is it possible? How could I go about it?</p>\n"},{"tags":["delphi","delphi-xe2","helpfile","helpcontext"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13142493,"title":"Identify which help context ID is being sent to a help file?","body":"<p>I'm working on an application with hundreds of forms and a corresponding help file with over 2,000 topics. I have one particular form which I am assigning a Context ID, but when I press \"F1\", the help file opens on its default page (Which means the ID passed to it wasn't found). I need to find out what ID is being passed to the help file to further debug why it's not bringing up its proper topic. How do I find this number?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13140947,"title":"How to highlight a DBGrid cell?","body":"<p>I'm trying to programatically highlight the current cell in a TDBGrid descendant.   If I do DBGrid.SetFocus, I get the combo box arrow below, which isn't sufficiently highlighted for me.</p>\n\n<p>EDIT:</p>\n\n<p>I'm already doing DBGrid.SelectedField := DataSource.FieldByName('Name');</p>\n\n<p>To bring the user's attention more to the region in question, I set:</p>\n\n<pre><code>DBGrid.Columns[x].Title.Font.Style := [fsbold, fsunderline];  \n</code></pre>\n\n<p>And I set a timer that after five seconds does:</p>\n\n<pre><code>DBGrid.Columns[x].Title.Font.Style := [];\n</code></pre>\n\n<p>What's weird is that after the time goes off, the cell becomes blue (as shown below.) <em>That's the highlight I wanted in the first place.</em> But I don't know enough about grids to know how to get that directly.</p>\n\n<p>My question: how to I get a grid cell highlighted as in the blue example below?  I've never done anything like this before, so I'm a bit lost.  Is this an InPlaceEditor function? </p>\n\n<p>I'm using a descendant of TDBGrid, so I'm not sure if the behavior I'm seeing is intrinsic to TDBGrid, or just in the descendant (in which case I know my question can't be answered here.  )</p>\n\n<p><img src=\"http://i.stack.imgur.com/zLnwI.jpg\" alt=\"Two controls\"></p>\n"},{"tags":["windows","delphi","operating-system","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":13137537,"title":"My Delphi 7 application halts on Application.Initialize and does not return to next line","body":"<p>I have created an application on Delphi 7. my app had running fine since yesterday. I don't know what's happened yesterday which cause my application halts on Application.Initialize line in source code and does not return to next line when i trace the program. I can't run the created executable file from widows niether while the generated file does run on another machine correctly. here is the code where the compiler stops on it:</p>\n\n<blockquote>\n  <p>program Info_Kiosk;</p>\n  \n  <p>uses   SysUtils,   Forms, ... (some other units) ;</p>\n  \n  <p>{$R *.res}</p>\n  \n  <p>begin<br>\n  <strong>Application.Initialize;</strong></p>\n  \n  <p>Application.CreateForm(Tfrm_Main, frm_Main);</p>\n</blockquote>\n\n<p>any help would be appreciated</p>\n"},{"tags":["delphi","delphi-xe2","jvcl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13140697,"title":"JvDock OnCheckIsDockable implementation","body":"<p>After wandering around <code>JvDock*</code> components, I found out that the <code>OnCheckIsDockable</code> event of <code>JvDockClient</code> is not implemented. I couldn't figure where to place a call to this event in <code>JvDockControlForm.pas</code> to enable the functionality the event name advertises. Any ideas? I'm using JVCL Version 3.47</p>\n"},{"tags":["delphi","delphi-xe2","teechart"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13137812,"title":"Can PieSeries of TeeChart summarize non-signifant data into an \"Other\" slice?","body":"<p>I have a <code>TPieSeries</code> which looks like this image when populated with data. Not very bright... Can I instruct the pie series to show the top N most significant records, and summarize the rest in another slice named \"Others\"? So far, the only thing I've come up with has been to set chart paging and order my data so that the top N records are shown on the first page. I'm using TeeChart Standard v2011.03.32815 VCL.\n<img src=\"http://i.stack.imgur.com/o6hi2.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13138573,"title":"TAction.SecondaryShortCuts is language specific. How to set it correctly?","body":"<p>I just used the SecondaryShortCuts-Feature of Delphi's TAction. But Shortcuts are defined by Strings, like \"F5\" or \"Shift+F5\". Now the problem: On my German Windows the action doesn't fire, because the key \"Shift\" is called \"Umsch\" in German!\nDoes it mean the  SecondaryShortCuts-Property is completely useless at design time, because nobody can create applications which work internationally with that?</p>\n\n<p>I could set the key at runtime by translating the VK_SHIFT into the correct name. I tried it via <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms646300%28v=vs.85%29.aspx\" rel=\"nofollow\">GetKeyNameText</a> but this didn't worked because it gave the long form \"Umschalt\" not \"Umsch\". Anybody know the function to get the short version of the key name?</p>\n"},{"tags":["delphi","delphi-5"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":13135259,"title":"Delphi Listbox+CheckListbox","body":"<p>I'm working on a mp3 sending program. I'm using a listbox to display a simple list of mp3 filenames(1.mp3,2.mp3,3.mp3 etc.)and a checklistbox where the connections(ip adress1,ip adress2)are. I want to know how can i save the listbox items with the checklistbox checked items as (links)? For example, if I want to send the 1.mp3 to ipadress1 and ipadress2, then the 2.mp3,3.mp3 for only ipadress2 etc..) I want to use a \"File sending\" button to save it to some txt files. Any idea?T hanks for the answers!</p>\n\n<pre><code>procedure TForm1.ListBox1Click(Sender: TObject);\n var\nItem : TStringList;\nI: Integer;\nbegin\n if ListBox1.ItemIndex = -1 then\n  Exit ;\n if Assigned(ListBox1.Items.Objects[ListBox1.ItemIndex]) then\n  Item := ListBox1.Items.Objects[ListBox1.ItemIndex] as TStringList\n else\n begin\n   Item := TStringList.Create ;\n   ListBox1.Items.Objects[ListBox1.ItemIndex] := Item;\n end ;\nfor I := 0 to CheckListBox1.Items.Count - 1 do\n CheckListBox1.Checked[I] := False; \nfor I := 0 to Item.Count - 1 do\nCheckListBox1.Checked[CheckListBox1.Items.IndexOf(Item[I])] := True; \nend;\n\nprocedure TForm1.CheckListBox1ClickCheck(Sender: TObject);\nvar\nItem : TStringList;\nI    : Integer;\nbegin\nif ListBox1.ItemIndex = -1 then\nbegin\n  ShowMessage('Select the mp3 first!');\n  Exit ;\n  end ;\n if Assigned(ListBox1.Items.Objects[ListBox1.ItemIndex]) then\n Item := ListBox1.Items.Objects[ListBox1.ItemIndex] as TStringList\n else\n begin\n  Item := TStringList.Create;\n  ListBox1.Items.Objects[ListBox1.ItemIndex] := Item;\nend;\nItem.Clear;\n for I := 0 to CheckListBox1.Items.Count - 1 do\n if CheckListBox1.Checked[I] then\n  Item.Add(CheckListBox1.Items[I]);\nend;\n</code></pre>\n"},{"tags":["multithreading","delphi","connection","datasnap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13135166,"title":"How to manage a datasnap connection for multiple threads","body":"<p>I have come to the conclusion that only 1 client thread can access the server through a connection. But how to manage this?</p>\n\n<p>Do I need to lock the connection every time I use the TSQLConnection. With a Server Method for instance?</p>\n\n<p>How to automate my Server Methods to Lock and Unlock the Connection to my server?</p>\n\n<p>Should i convert all my server method calls From</p>\n\n<pre><code>ServerMethod();\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Try\n  Datamodule.lock;\n  ServerMethod\nFinally\n  Datamodule.unlock;\nend;\n</code></pre>\n\n<p>Or Should I give my Threads New Connections?</p>\n\n<p>I use other threads for printing, this needs information from the server.\nPrinting should be done in the background but stil uses the SQL connection from the main Application.</p>\n\n<p><strong>Edit</strong>: The problem with creating a new connection is that the server creates a new ClientSession. So i need to Create and close this Session. Is there a way to create a new connection to the same session?</p>\n"},{"tags":["string","delphi","delphi-7","text-files"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1266,"score":4,"question_id":7752273,"title":"How to save a string to a .txt file in Delphi?","body":"<p>I need to make a program that generates a password that is saved in a text file format in a specific destination I set and the user needs to open the .txt to get the password to 'unlock' another program. </p>\n\n<p>I have already got the code to generate the password in the string sPass and now I need to use the SaveToFile function to save it into the text file I created called Password.txt but I cannot find the general form to use the SaveTo File Function in Delphi and I do not know where to put the sPass and Password.txt in the function. </p>\n\n<p>It should be something like : SaveToFile(...) but I do not know how to save sPass in Password.txt</p>\n\n<p>Edit :</p>\n\n<p>Just one more question, how do you delete what is previously stored in Password.txt before you add the string to it so that Password.txt is blank before the string is added ? Thanks</p>\n"},{"tags":["xml","delphi","xslt"],"answer_count":4,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":3170,"score":5,"question_id":982687,"title":"How do I display XML using an XSLT document, in a Delphi app?","body":"<p>I've been given a sample XML file (ultimately my client will receive several of these each day), and an XSLT file which will apparently transform the XML into something with a meaningful layout, suitable for displaying in a browser or printing.</p>\n\n<p>I'd like to put something into an existing legacy Delphi app, such that the user can pick one of the XML files from the drive and 'display' it (in a TWebBrowser or similar).</p>\n\n<p>I have no idea where to start, and Googling delphi, xml and xslt gets me examples that seem to be datamodule/database based; I just want to transform a given XML file into something on-screen. It looks like it might involve a PageProducer but I can't quite get my head around what I need to do. Anyone offer any pointers, or maybe a link to a quick tutorial?</p>\n\n<p>Many thanks!</p>\n"},{"tags":["delphi","formatting"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":5,"view_count":100,"score":-1,"question_id":13128953,"title":"Get value after decimal separator from floating point number in Delphi","body":"<p>How to get value after decimal separator for given floating point number?</p>\n\n<pre><code>Number: 129.60\nExpected result: 60\n</code></pre>\n"},{"tags":["delphi","debugging","delphi-2009","oci","ntdll"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":108,"score":3,"question_id":13107382,"title":"Delphi - Exception in ntdll.dll on closing after both connection to Oracle and calling a web service method","body":"<p>In Delphi 2009 I'm finding that any time I do perform <strong>both</strong> a connection to Oracle (via OCI.dll) and a call to a web service method I get an exception in ntdll.dll when closing my application in the IDE.</p>\n\n<p>For the connection to Oracle I tried using both DOA (Direct Oracle Access) 4.1.1.0 and ODAC components (latest trial version);</p>\n\n<p>For the web service method call (just a simple \"function HelloWorld: string\") I am using Delphi stock capabilities, after importing the WSDL from the web service.</p>\n\n<p>If I use ODAC components in \"direct\" mode, that is not using OCI.dll, no exception occurs on closing.</p>\n\n<p>If I call a web service method only (without connecting to Oracle), no exception occurs on closing (even if I use either DOA or ODAC components).</p>\n\n<p>If I connect to Oracle (via OCI.dll) only (without calling a web service method), everything goes fine too (no matter if I use either DOA or ODAC components).</p>\n\n<p>The very same code runs perfect when executed both in Delphi 7 and Delphi XE2: no exception occurs on application closing.</p>\n\n<p>Some information:\nDelphi 2009 (stock and Update 3 version)\nOS: Windows 7 32 bit\nOracle Instant Client 10.2.0.4 and Oracle Instant Client 10.2.0.5</p>\n\n<p>I start suspecting that it might be an issue related to heap corruption in Delphi 2009 on application closing...</p>\n\n<p>Any help please?</p>\n\n<p>Steps to reproduce (from the comment):</p>\n\n<ol>\n<li>Create a new VCL Forms Application</li>\n<li>Place a TOracleSession DOA component (named OracleSession1) on the Form</li>\n<li>Place a TButton on the Form (named Button1)</li>\n<li>Place this event handler for the button click event:</li>\n</ol>\n\n<p>Here is the code:</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar\n   MyWebService3Soap: WebService3Soap;\n   s: string;\nbegin\n   OracleSession1.LogonDatabase := 'SomeLogonDB';\n   OracleSession1.LogonUsername := 'SomeUsername';\n   OracleSession1.LogonPassword := 'SomePassword';\n   OracleSession1.Connected := True;\n   ShowMessage('Connected');\n\n   MyWebService3Soap := GetWebService3Soap();\n   s := MyWebService3Soap.HelloWorld(); // Just returns a string such as \"Hello World\"\n   ShowMessage(s);\n end;\n</code></pre>\n\n<p>The \"WebService3Soap\" interface is the one automatically generated by Delphi 2009 WSDL Importer. Here is the meaningful part:</p>\n\n<pre><code>WebService3Soap = interface(IInvokable)\n  ['{F6F12FA6-3881-8BB5-AD71-2408B47692CD}']\n    function  HelloWorld: string; stdcall;\n  end;\n\nfunction GetWebService3Soap(UseWSDL: Boolean=System.False; Addr: string=''; HTTPRIO: THTTPRIO = nil): WebService3Soap;\n\ninitialization\n  InvRegistry.RegisterInterface(TypeInfo(WebService3Soap), 'http://mytest.it/Test3', 'utf-8');\n  InvRegistry.RegisterDefaultSOAPAction(TypeInfo(WebService3Soap), 'http://mytest.it/Test3/HelloWorld');\n  InvRegistry.RegisterInvokeOptions(TypeInfo(WebService3Soap), ioDocument);\nend.\n</code></pre>\n\n<p>Run the application inside the IDE, press the button (close the 2 following ShowMessages) and then close the form.</p>\n"},{"tags":["delphi","encryption","openssl","bignum"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12926554,"title":".Net public key file (.pke) to OpenSSL PEM","body":"<p>We are trying to read in a public key file into our Delphi application so that we can use it for encrypting some data using OpenSSL.  We are stuck at trying to populate the pRSA structure in libeay32.pas.</p>\n\n<p>Basically we have read the modulus and exponent out of the pke file, base 64 decoded them and stored the decoded value in a buffer of type Byte. </p>\n\n<p>From what we can tell these now need to be converted into a BIGNUM structure.  Libeay32 provides a function BN_bin2bn function which accepts a pointer an output a pBIGNUM.</p>\n\n<p>The question is, can we pass the modulus and exponent buffers directly to BN_bin2bn or do they first need to be converted to a format compatible with the BN_bin2bn function?</p>\n\n<p>We are using Delphi 2007.</p>\n"},{"tags":["delphi","events","script","dwscript"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":157,"score":4,"question_id":12549625,"title":"Delphi Web Script (DWScript) link a script method to an external control event","body":"<p>I'm wondering if DWScript supports using a script method as an event handler for a control on a Delphi form.  For example I want to link a TButton OnClick event to a method that exists in script. </p>\n\n<p>I am able to do this with the RemObjects Delphi script engine by calling GetProcMethod which returns a TMethod object.  I then use SetMethodProp to assign the script method to the OnClick event of a button.</p>\n\n<pre><code>procedure LinkMethod(SourceMethodName: String; Instance: TObject; ScriptMethodName: String);\nvar\n  ScriptMethod: TMethod;\nbegin\n  ScriptMethod := ScriptEngine.GetProcMethod(ScripMethodName);\n\n  SetMethodProp(Instance, SourceMethodName, ScriptMethod);\nend;\n</code></pre>\n\n<p>I would like to do this in DWScript instead of the Rem objects script engine as it does some other stuff that I need.</p>\n"},{"tags":["delphi","project","delphi-xe2","options","delphi-xe3"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13126666,"title":"How to use configuration option set with project \"by reference\"","body":"<p>I've spent a couple of days exploring option sets (again) in XE3. They look really clever but either they are (still) broken or its me. What I wanted to do was to create a common option set file for a bunch of projects, say CommonOptions.optset. This is easy to create and edit using the View | Configuration Manager item. In this options set file I put a set of relative search paths such as:</p>\n\n<pre><code>..\\..\\source1;..\\..\\source2;\n</code></pre>\n\n<p>etc. These paths are proven to work when entered into the DEBUG or BASE build configuration directly. When I use the Configuration Manager to apply this common option set as a reference, the paths do not work. If I repeat the application using 'Modify Values' it works fine. To be sure, I deleted the DPROJ (and all the .local stuff too) and let Delphi recreate the DPROJ before applying the option set file as reference again. Still no luck.</p>\n\n<p>I have several libraries with 10's of DPROJ's all of different vintages so I really do need a common way of specifying compiler options, don't include version info etc.</p>\n\n<p>Has anyone got this reference thing to work?</p>\n"},{"tags":["delphi","index","tclientdataset"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":83,"score":5,"question_id":13130578,"title":"Reverse the order on an index for a ClientDataSet","body":"<p>I'm wanting to reverse the order of an index in a TClientDataSet, the following code looks like it should do the trick but does nothing.  Is there a nice way to reverse the order of an index?</p>\n\n<pre><code>procedure TForm8.Button1Click(Sender: TObject);\nvar\n  index: TIndexDef;\nbegin\n  index := ClientDataSet1.IndexDefs.Find('LengthIndex');\n  if ixDescending in index.Options then\n    index.Options := index.Options - [ixDescending]\n  else\n    index.Options := index.Options + [ixDescending];\nend;\n</code></pre>\n"},{"tags":["c++","c","delphi"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":149,"score":3,"question_id":13117566,"title":"Analogs of Delphi types in C/C++","body":"<p>What are analogues for Delphi types <a href=\"http://docwiki.embarcadero.com/Libraries/XE2/en/System.TVarType\" rel=\"nofollow\"><strong>TVarType</strong></a> and <a href=\"http://docwiki.embarcadero.com/Libraries/XE2/en/System.OleVariant\" rel=\"nofollow\"><strong>OleVariant</strong></a> in C/C++ ?</p>\n"},{"tags":["delphi","combobox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":71,"score":-1,"question_id":13129677,"title":"save Combobox item 3,4 delphi","body":"<p>I have a Combobox with 3 item by Default and I want to save items like this:</p>\n\n<pre><code>Item1 //don't save\nItem2 //Don't save\nItems3 //save\n//save all futur items added\n</code></pre>\n\n<p>Why my code it's don't work?</p>\n\n<pre><code>if Combobox1.ItemIndex &gt; 2 then // i used 2 for test and it's no work\n   Combobox1.Items.SaveToFile('util.conf');\nend;\n</code></pre>\n\n<p>If I remove <em>if Combobox1.ItemIndex > 2 then</em> all items are saved...</p>\n\n<p>How to solve this problem?</p>\n"},{"tags":["delphi","delphi-7","music"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":101,"score":3,"question_id":13123587,"title":"How to stop music started via SndPlaySound","body":"<p>At this <a href=\"http://delphi.about.com/od/objectpascalide/a/embed_resources_2.htm\" rel=\"nofollow\">Website</a> I  found how to add music into a .res file and then use it in your delphi .exe. Here is the code for starting the WAVE song.</p>\n\n<pre><code>procedure TForm2.FormActivate(Sender: TObject);\nvar\n   hFind, hRes: THandle;\n   Song: PChar;\n begin\n  hFind := FindResource(HInstance, 'SonicSong', 'WAVE') ;\n  if hFind &lt;&gt; 0 then begin\n    hRes:=LoadResource(HInstance, hFind) ;\n    if hRes &lt;&gt; 0 then begin\n      Song:=LockResource(hRes) ;\n      if Assigned(Song) then SndPlaySound(Song, snd_ASync or snd_Memory) ;\n      UnlockResource(hRes) ;\n    end;\n    FreeResource(hFind) ;\n  end;\nend;\n</code></pre>\n\n<p>So what I would like to know is how do I stop the music when I want to without closing the application?</p>\n"},{"tags":["delphi","delphi-xe2","wia"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":121,"score":3,"question_id":13108742,"title":"How to transfer a scanned image from WIA ImageFile to TBitmap without saving it to disk?","body":"<p>I'm using this code to acquire the scanned image from WIA:</p>\n\n<pre><code>const\n  wiaFormatJPEG = '{B96B3CAE-0728-11D3-9D7B-0000F81EF32E}';\n  wiaFormatPNG = '{B96B3CAF-0728-11D3-9D7B-0000F81EF32E}';\nvar\n  CommonDialog: ICommonDialog;\n  AImage: IImageFile;\n  i: Integer;\nbegin\n  CommonDialog := CreateOleObject('WIA.CommonDialog') as ICommonDialog;\n\n  for i := 1 to Scanner.Properties.Count do\n  begin\n    if (Scanner.Properties[i].Name = 'Horizontal Resolution') or\n      (Scanner.Properties[i].Name = 'Vertical Resolution') then\n      Scanner.Properties[i].Set_Value(72)\n    else if Scanner.Properties[i].Name = 'Horizontal Extent' then\n      Scanner.Properties[i].Set_Value(Round(8.27 * 72))\n    else if Scanner.Properties[i].Name = 'Vertical Extent' then\n      Scanner.Properties[i].Set_Value(Round(11.00 * 72));\n  end;\n  AImage := IUnknown(CommonDialog.ShowTransfer(Scanner, wiaFormatPNG, True)) as IImageFile;\n  //Save the image\n  AImage.SaveFile('D:\\1.' + AImage.FileExtension);\n  imgImage.Picture.LoadFromFile('D:\\1.' + AImage.FileExtension);\n  DeleteFile('D:\\1.' + AImage.FileExtension);\nend;\n</code></pre>\n\n<p><code>Scanner</code> is initialized using this code:</p>\n\n<pre><code>Scanner := DevMgr.DeviceInfos[Integer(cbWIASource.Items.Objects[cbWIASource.ItemIndex])].Connect.Items[1];\n</code></pre>\n\n<p>And <code>DevMgr</code> and <code>cbWIASource</code> are initialized using this code:</p>\n\n<pre><code>DevMgr := CreateOleObject('WIA.DeviceManager') as IDeviceManager;\nfor i := 1 to DevMgr.DeviceInfos.Count do\n    for j := 1 to DevMgr.DeviceInfos[i].Properties.Count do\n      if DevMgr.DeviceInfos[i].Properties[j].Name = 'Name' then\n      begin\n        cbWIASource.Items.AddObject(DevMgr.DeviceInfos[i].Properties[j].Get_Value, TObject(i));\n        Break;\n      end;\n</code></pre>\n\n<p>I was wondering if there is a way to copy the scanned document without first saving it to the disk. I read on MSDN that I can access <code>ARGBData</code> member of <code>ImageFile</code> to access pixel data, but is there a simple way to copy the entire image from <code>FileData</code> to <code>TBitmap</code>? For instance, can I use a <code>TMemoryStream</code>?</p>\n\n<hr>\n\n<p>Just as an update, I found <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms630826%28v=vs.85%29.aspx#SharedSample001\" rel=\"nofollow\">this example</a> on MSDN. I know nothing about VB, but I guess the <code>Picture</code> object is a wrapper around <code>HBITMAP</code>. So, is it logical to conclude that the <code>ImageFile.Picture</code> property is what I need?</p>\n"},{"tags":["sql","delphi","datetime"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":13125373,"title":"Delphi SQL query","body":"<p>I was wondering if you could take a look at my code for date comparison on Delphi. </p>\n\n<p>Code snippet in DELPHI:-</p>\n\n<pre><code>        // SQL QUERRY to gather member information.\n           DMS.ADOQuery1.SQL.Clear;\n           DMS.ADOQuery1.SQL.Add('select HPFROMDT, HPthruDt, MEMBERKEY, MEMBHPKEY, OPFROMDT, OPTHRUDT, HPCODEKEY' +\n                                 ' from MEMBHP' +\n                                 ' where MEMBERKEY = ''' + MembKey + '''   and OPFROMDT &lt;= ''' + date_request + ''' and OPTHRUDT &gt; ''' + date_request +''' '\n</code></pre>\n\n<p>Script snippet in SQL:-</p>\n\n<pre><code>SELECT [MEMBHPKEY]\n      ,[MEMBERKEY]\n      ,[CURRHIST]\n      ,[HPFROMDT]\n      ,[OPFROMDT]\n      ,[OPTHRUDT]\n      ,[HPCODEKEY]\n      ,[HPOPTIONKEY]\n\n  FROM [main].[dbo].[MEMBHP]\n\n  where MEMBERKEY = '1234567' and OPFROMDT &lt;= '2007-08-01' and OPTHRUDT &gt; '2007-08-01'\n</code></pre>\n\n<p>The SQL script obviously compares a constant date  value with the extracted date values. And it works!\nHowever, the Delphi code doesn’t work.  The error message “Conversion failed when converting character string to smalldatetime date type.”</p>\n\n<p>I believe there has to be some kind of conversion technique for Delphi that should allow me to convert into the right variable type…. Any ideas?</p>\n\n<p>I extract date_request as a string variable from a text file....</p>\n\n<pre><code> for i := 11 to length(buffer) do\n                        begin\n                             DT_request := DT_request + buffer[i];\n                        end;\n</code></pre>\n"},{"tags":["delphi","package","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13128975,"title":"Dynamic package linking - using program unit in dynamic package","body":"<p>I wrote a small component which dynamically loads a package on run-time. </p>\n\n<p>So I've got some group project with my main project (<code>exe</code>) and some packages (<code>bpl</code>). Now I want to use in all of them the unit from my <code>exe</code> (<code>Datamod.pas</code>). </p>\n\n<p>So in some unit's <code>uses</code> list of my package I'm adding <code>Datamod</code> and I want to access that datamod at runtime. Everything compiles, voila.</p>\n\n<p>But</p>\n\n<p>As I debug the code - the instance of <code>Datamod</code> class in bpl is not nil, but it gives me an AV as I'm accesing it. What am I missing? Should I export <code>Datamod.pas</code> to other package and make other packages use that package? Why it gives me an AV?</p>\n"},{"tags":["delphi","winapi","process","dump"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":13129312,"title":"RunPE dump process","body":"<p>Is it possible to dump its own process when it got started from runpe?</p>\n\n<p>Where would be the startaddress of the process, etc.?</p>\n\n<p>EDIT:</p>\n\n<p>I have this unit to run an executable from memory:</p>\n\n<pre><code>unit uExecFromMem;\n\ninterface\n\nuses Windows;\n\nfunction ExecuteFromMem(szFilePath:string; pFile:Pointer):DWORD;\n\ntype\n  PImageBaseRelocation = ^TImageBaseRelocation;\n  TImageBaseRelocation = packed record\n     VirtualAddress: DWORD;\n     SizeOfBlock: DWORD;\n  end;\n\nfunction NtUnmapViewOfSection(ProcessHandle:DWORD; BaseAddress:Pointer):DWORD; stdcall; external 'ntdll';\n\nimplementation\n\nprocedure PerformBaseRelocation(f_module: Pointer; INH:PImageNtHeaders; f_delta: Cardinal); stdcall;\nvar\n  l_i: Cardinal;\n  l_codebase: Pointer;\n  l_relocation: PImageBaseRelocation;\n  l_dest: Pointer;\n  l_relInfo: ^Word;\n  l_patchAddrHL: ^DWord;\n  l_type, l_offset: integer;\nbegin\n  l_codebase := f_module;\n  if INH^.OptionalHeader.DataDirectory[5].Size &gt; 0 then\n  begin\n    l_relocation := PImageBaseRelocation(Cardinal(l_codebase) + INH^.OptionalHeader.DataDirectory[5].VirtualAddress);\n    while l_relocation.VirtualAddress &gt; 0 do\n    begin\n      l_dest := Pointer((Cardinal(l_codebase) + l_relocation.VirtualAddress));\n      l_relInfo := Pointer(Cardinal(l_relocation) + 8);\n      for l_i := 0 to (trunc(((l_relocation.SizeOfBlock - 8) / 2)) - 1) do\n      begin\n        l_type := (l_relInfo^ shr 12);\n        l_offset := l_relInfo^ and $FFF;\n        if l_type = 3 then\n        begin\n          l_patchAddrHL := Pointer(Cardinal(l_dest) + Cardinal(l_offset));\n          l_patchAddrHL^ := l_patchAddrHL^ + f_delta;\n        end;\n        inc(l_relInfo);\n      end;\n      l_relocation := Pointer(cardinal(l_relocation) + l_relocation.SizeOfBlock);\n    end;\n  end;\nend;\n\nfunction AlignImage(pImage:Pointer):Pointer;\nvar\n  IDH:          PImageDosHeader;\n  INH:          PImageNtHeaders;\n  ISH:          PImageSectionHeader;\n  i:            WORD;\nbegin\n  IDH := pImage;\n  INH := Pointer(DWORD(pImage) + IDH^._lfanew);\n  GetMem(Result, INH^.OptionalHeader.SizeOfImage);\n  ZeroMemory(Result, INH^.OptionalHeader.SizeOfImage);\n  CopyMemory(Result, pImage, INH^.OptionalHeader.SizeOfHeaders);\n  for i := 0 to INH^.FileHeader.NumberOfSections - 1 do\n  begin\n    ISH := Pointer(DWORD(pImage) + IDH^._lfanew + 248 + i * 40);\n    CopyMemory(Pointer(DWORD(Result) + ISH^.VirtualAddress), Pointer(DWORD(pImage) + ISH^.PointerToRawData), ISH^.SizeOfRawData);\n  end;\nend;\n\nfunction ExecuteFromMem(szFilePath:string; pFile:Pointer):DWORD;\nvar\n  PI:           TProcessInformation;\n  SI:           TStartupInfo;\n  CT:           TContext;\n  IDH:          PImageDosHeader;\n  INH:          PImageNtHeaders;\n  dwImageBase:  DWORD;\n  pModule:      Pointer;\n  dwNull:       DWORD;\nbegin\n  Result := 0;\n  IDH := pFile;\n  if IDH^.e_magic = IMAGE_DOS_SIGNATURE then\n  begin\n    INH := Pointer(DWORD(pFile) + IDH^._lfanew);\n    if INH^.Signature = IMAGE_NT_SIGNATURE then\n    begin\n      FillChar(SI, SizeOf(TStartupInfo), #0);\n      FillChar(PI, SizeOf(TProcessInformation), #0);\n      SI.cb := SizeOf(TStartupInfo);\n      if CreateProcess(nil, PChar(szFilePath), nil, nil, FALSE, CREATE_SUSPENDED, nil, nil, SI, PI) then\n      begin\n        CT.ContextFlags := CONTEXT_FULL;\n        if GetThreadContext(PI.hThread, CT) then\n        begin\n          ReadProcessMemory(PI.hProcess, Pointer(CT.Ebx + 8), @dwImageBase, 4, dwNull);\n          if dwImageBase = INH^.OptionalHeader.ImageBase then\n          begin\n            if NtUnmapViewOfSection(PI.hProcess, Pointer(INH^.OptionalHeader.ImageBase)) = 0 then\n              pModule := VirtualAllocEx(PI.hProcess, Pointer(INH^.OptionalHeader.ImageBase), INH^.OptionalHeader.SizeOfImage, MEM_COMMIT or MEM_RESERVE, PAGE_EXECUTE_READWRITE)\n            else\n              pModule := VirtualAllocEx(PI.hProcess, nil, INH^.OptionalHeader.SizeOfImage, MEM_COMMIT or MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n          end\n          else\n            pModule := VirtualAllocEx(PI.hProcess, Pointer(INH^.OptionalHeader.ImageBase), INH^.OptionalHeader.SizeOfImage, MEM_COMMIT or MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n          if pModule &lt;&gt; nil then\n          begin\n            pFile := AlignImage(pFile);\n            if DWORD(pModule) &lt;&gt; INH^.OptionalHeader.ImageBase then\n            begin\n              PerformBaseRelocation(pFile, INH, (DWORD(pModule) - INH^.OptionalHeader.ImageBase));\n              INH^.OptionalHeader.ImageBase := DWORD(pModule);\n              CopyMemory(Pointer(DWORD(pFile) + IDH^._lfanew), INH, 248);\n            end;\n            WriteProcessMemory(PI.hProcess, pModule, pFile, INH.OptionalHeader.SizeOfImage, dwNull);\n            WriteProcessMemory(PI.hProcess, Pointer(CT.Ebx + 8), @pModule, 4, dwNull);\n            CT.Eax := DWORD(pModule) + INH^.OptionalHeader.AddressOfEntryPoint;\n            SetThreadContext(PI.hThread, CT);\n            ResumeThread(PI.hThread);\n            FreeMem(pFile, INH^.OptionalHeader.SizeOfImage);\n            Result := PI.hThread;\n          end;\n        end;\n      end;\n    end;\n  end;\nend;\n\nend.\n</code></pre>\n\n<p>Then I have Application1 and Application2.</p>\n\n<p>Application1 has Application2 (the complete executable) stored in memory.\nThen Application1 starts Application2 from memory like this: </p>\n\n<pre><code>ExecuteFromMem(paramstr(0), @Application2InMemory) // uses Application1 as Host\n</code></pre>\n\n<p>Now Application2 is loaded in memory and is started!\nHow can Application2 get the it's data (the Application2.exe) back to the disk (or back to a var)?</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":1057,"score":1,"question_id":8768652,"title":"Base64 to Binary (Delphi)","body":"<p>I used Binary to Base64 function that you answered :\n<a href=\"http://stackoverflow.com/questions/5795263/binary-to-base64-delphi/5795440#5795440\">Binary to Base64 (Delphi)</a></p>\n\n<p>I successfully encode a file to base64 string and write it to MsSQL2008 database, but i want to ask a question:\nHow can i write this file to disk again with using EncdDecd.pas?</p>\n"},{"tags":["delphi","popup"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":143,"score":1,"question_id":13123043,"title":"This program spending too much time,even no respond,is there any way to improve it?","body":"<p>1, Add a popupmenu named <code>PopupMenu1</code> </p>\n\n<p>2, Add a menuitem named <code>TestMI</code> </p>\n\n<p>3, Add a Button</p>\n\n<p>and code :</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar\n  MItems: array of TMenuItem;\n  SList: TStringList;\n  FileRec: TSearchrec;\n  i: integer;\nbegin\n\n  SList := TStringList.Create;\n //3000+ files \n  if FindFirst('C:\\Windows\\System32\\*', faNormal or faDirectory, FileRec) = 0\n    then\n    repeat\n      if (FileRec.Name = '.') or (FileRec.Name = '..') then\n        Continue;\n\n      SList.Add(FileRec.Name);\n\n    until FindNext(FileRec) &lt;&gt; 0;\n  FindClose(FileRec);\n\n  if SList.Count &gt; 0 then\n  begin\n    SetLength(MItems, SList.Count);\n    for i := 0 to SList.Count - 1 do\n    begin\n\n      MItems[i] := TMenuItem.Create(TestMI);\n      MItems[i].Caption := SList[i];\n\n    end;\n\n    TestMI.Add(MItems);\n\n  end;\nend;\n</code></pre>\n\n<p>When I click button , it's OK , but when i popup  <code>PopupMenu1</code> and move on  <code>TestMI</code>，Because too many files it no respond. </p>\n\n<p>Is there any way to solve it?</p>\n\n<p>Updata :</p>\n\n<p>I have to use PopupMenu to do this . </p>\n\n<p>I find a program , can do it fast , take 150ms</p>\n\n<p><a href=\"https://docs.google.com/open?id=0B1sDNMAzGE2oZWpTWlpWNHJGZzQ\" rel=\"nofollow\">https://docs.google.com/open?id=0B1sDNMAzGE2oZWpTWlpWNHJGZzQ</a></p>\n\n<p>it use <a href=\"http://www.vclcomponents.com/Delphi/Menus/BarMenu_Components-info.html\" rel=\"nofollow\"><strong>BarMenu Components</strong></a></p>\n\n<p>but i can't compile in Delphi 2009.\nError : </p>\n\n<p>lib\\BarMenus:</p>\n\n<pre><code>{$IFDEF MSWINDOWS}\n  {$IFNDEF DFS_COMPILER_5_UP}\n     {$MESSAGE FATAL 'You need Delphi 5 or higher in order to compile this unit.'}\n  {$ENDIF}\n  Windows, SysUtils, Classes, Graphics, Menus, Forms;\n{$ENDIF}\n</code></pre>\n\n<p>update to @Sertac Akyuz</p>\n\n<p>you solution is useful , in first case. and very thank you.\nand i change that case \nCode : </p>\n\n<pre><code>unit Unit1;\n\ninterface\n\nuses\n  Windows,\n  Messages,\n  SysUtils,\n  Variants,\n  Classes,\n  Graphics,\n  Controls,\n  Forms,\n  Dialogs,\n  StdCtrls,\n  Menus;\n\ntype\n  TForm1 = class(TForm)\n    Button1: TButton;\n    PopupMenu1: TPopupMenu;\n    TestMI: TMenuItem;\n    procedure Button1Click(Sender: TObject);\n    procedure CreMI(MI: TMenuItem);\n    procedure IMonClick(Sender: TObject);\n    procedure AddSubEmpItem(MI: TMenuItem);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm1.IMonClick(Sender: TObject);\nbegin\n\n  CreMI(TMenuItem(Sender));\n\nend;\n\nprocedure TForm1.AddSubEmpItem(MI: TMenuItem);\nvar\n  EmpIM: TMenuItem;\nbegin\n\n  EmpIM := TMenuItem.Create(MI);\n  with EmpIM do\n  begin\n    Caption := '(Folder empty)';\n    Enabled := False;\n    Hint := '';\n    MI.Add(EmpIM);\n  end;\n\nend;\n\nprocedure TForm1.CreMI(MI: TMenuItem);\nvar\n  MItems: array of TMenuItem;\n  SList: TStringList;\n  FileRec: TSearchrec;\n  i: integer;\nbegin\n\n  if (MI.Items[0].Caption = '(Folder empty)') and (MI.Count = 1) then\n  begin\n\n    SList := TStringList.Create;\n\n    if FindFirst(MI.Hint + '\\*', faNormal or faDirectory, FileRec) = 0\n      then\n      repeat\n        if (FileRec.Name = '.') or (FileRec.Name = '..') then\n          Continue;\n\n        SList.Add(FileRec.Name);\n\n      until FindNext(FileRec) &lt;&gt; 0;\n\n    FindClose(FileRec);\n\n    if SList.Count &gt; 0 then\n    begin\n\n      SetLength(MItems, SList.Count);\n      for i := 0 to SList.Count - 1 do\n      begin\n\n        MItems[i] := TMenuItem.Create(MI);\n        MItems[i].Caption := SList[i];\n        MItems[i].Hint := MI.Hint + SList[i] + PathDelim;\n        AddSubEmpItem(MItems[i]);\n        MItems[i].OnClick := IMonClick;\n        MItems[i].AutoHotkeys := maManual;\n\n      end;\n\n      MI.Add(MItems);\n      MI.AutoHotkeys := maManual;\n\n    end;\n  end;\n  //Button1.Caption := IntToStr(MI.Count);\n\nend;\n\nprocedure TForm1.Button1Click(Sender: TObject);\n\nbegin\n\n  AddSubEmpItem(TestMI);\n  CreMI(TestMI);\n\n\nend;\n\nend.\n</code></pre>\n\n<p>Set <code>TestMI.Hint := C:\\</code></p>\n\n<p>Click the button and when I move on <code>C:\\ -&gt; Windows -&gt; System32</code>  it no respond too.\ncan you give some adviese?</p>\n"},{"tags":["delphi","http","browser","shellexecute"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":541,"score":7,"question_id":5127654,"title":"shellexecute fails to open http links for some users","body":"<p>Some users of an app of mine are reporting links dont open in the browser. I always launch them with shellexecute(0, 'open', 'http://...</p>\n\n<p>what could I check for an incorrect(?) setting in the http link associations?</p>\n"},{"tags":["delphi","parsing","date","expression","evaluator"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":68,"score":-1,"question_id":13128298,"title":"Evaluate datetime expressions","body":"<p>I need to evaluate date expressions for my delphi(7) application.</p>\n\n<p>This expressions will calculate dates by a user friendly language.\nTake a look on this examples:</p>\n\n<pre><code>'1/month/year' = this return the first date of the current month and year\n'today+30days' = this return 30 days coupled to the current date\n'(1/moth+1/year)-1day' = this return the last day of the current month\n</code></pre>\n\n<p>The sintaxe can be changed...</p>\n\n<p>What I want to known is if someone known a opensource solutions to do this or something like this...</p>\n"},{"tags":["delphi","delphi-2010","firebird"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":113,"score":1,"question_id":13071007,"title":"conversion error from string, when using params in SQL","body":"<p>using Delphi 2010 (Firebird [testing], MS Sql Server, Oracle [production])</p>\n\n<p>The following is my SQL</p>\n\n<pre><code>SELECT p.script_no, MIN(p.start_Time) as startTime, MAX(p.end_Time) as endTime, \nSUM(p.duration) as TotalDuration\nFROM phase_times p\nWHERE (p.script_no=:scriptNo) AND (Trunc(p.start_time) &gt;= :beginDateRange) AND (Trunc(p.start_time) &lt;= :endDateRange) \nGROUP BY p.script_no\n\n\n\nParamByName('beginDateRange').AsDate:= Date - 30;\nParamByName('endDateRange').AsDate:= Date;\n</code></pre>\n\n<p>I am getting a \"conversion error from string - 10-25-2012\" and i am not sure why, since my datetime fields are in the \"10/25/2012 9:20:49 AM\" format in the database.</p>\n\n<p>If i change it to the following : ParamByName('beginDateRange').AsString := formatDateTime('mm/dd/yyyy',Date - 30).....i get the error \"conversion error from string - 10/25/2012\" </p>\n\n<p>reserching this error has provided me no new avenues, do you have any ideas?</p>\n"},{"tags":["delphi","ado"],"answer_count":6,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":3516,"score":4,"question_id":343553,"title":"How to prevent Delphi ADO from loading the entire table into memory?","body":"<p>I am not a Delphi programmer, but I I got an old Delphi 7 application that I need to fix and it is using ADO.</p>\n\n<p>The database table (MS Accesss) contains +100,000 rows and when I set the ADOTable.Active=true it starts to load the entire table into RAM and that takes a lot of memory and time.</p>\n\n<p>How can I prevent ADO to load the entire table? I tried to set the MaxRecords but it does not help.</p>\n\n<p>Basically all we do is att program startup:</p>\n\n<pre><code>// Connect to database\nDataModule.MyADOConnection.Connected:=true;\n\nDataModule.MeasurementsADOTable.MaxRecords:=1;\n\n// Open datatables\nDataModule.MeasurementsADOTable.Active:=true;\n</code></pre>\n\n<p>After setting Active=true it starts to load the entire measurements into RAM and it takes TIME!</p>\n\n<p>We are using the MSDASQL.1 provider. Perhaps it does not support the MaxRecords property?</p>\n\n<p>How do I add some limiting query into this data object to only \"load TOP 1 * from Measurements\" ?</p>\n"},{"tags":["delphi","delphi-7","tclientdataset"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":221,"score":5,"question_id":8216222,"title":"\"No value for parameter\" error message","body":"<p>I'm new to Delphi7. </p>\n\n<p>When I try to use the editor's \"Add all fields\" feature on a TClientDataSet object a messagebox (the classic error message box) appear with the message \"No value for parameter '(the name of the parameter)'\".<br>\nI can't add fields using the \"all fields\" feature anymore.<br>\nHow can I find the source of the \"No value for parameter\" error? </p>\n"},{"tags":["xml","delphi","delphi-2009","tclientdataset"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2894,"score":1,"question_id":430601,"title":"TClientDataset - XML mapping","body":"<p>I'm trying to save data in a TClientDataSet to an XML file, but it doesn't like some of my fields.  The helpfile says to create a definition, in one of two ways: either with the xmlmapper.exe file in my \\bin folder or with an IDOMDocument interface.</p>\n\n<p>Problem is, xmlmapper.exe isn't there, and IDOMDocument is one of those annoying structures that Delphi 2009 was released without writing up documentation for.  So I have to choose between a non-existent EXE or an interface with no documentation and no indication of which objects implement it or how to create them.</p>\n\n<p>Does anyone know what I'm supposed to do in this case?</p>\n"},{"tags":["delphi","delphi-7","tclientdataset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":273,"score":0,"question_id":11669728,"title":"\"Mismatch in datapacket\" error in TClientDataSet","body":"<p>I have a .cds file that suggest it is <code>TClientDataSet</code> file. When I try to open it whit <code>TClientDataSet</code> in Delphi 7, when set <code>Active</code> to <code>true</code>, error \"Mismatch in datapacket\" has occurred. Please help me :(</p>\n"},{"tags":["delphi","ide","delphi-2010"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":3445,"score":5,"question_id":4265492,"title":"Why Delphi says 'cannot resolve unit name xxx'?","body":"<p>I'm working with Delphi2010 Enterprise Update 4.<br>\nWhen I'm opening my project in the IDE and displaying the mainform code, there are <strong>2 unit names underline in red</strong>.</p>\n\n<p><img src=\"http://img268.imageshack.us/img268/6475/unitnameunresolved.png\" alt=\"xxx\">.</p>\n\n<p>I have <strong>verified</strong> that the path to the unit source is in the <code>Library path</code> and in the <code>Browsing path</code>.</p>\n\n<p>Surprisingly, when I'm doing a right-clicking on the unit and selecting <code>Open file at cursor</code>, it works (ie. delphi opens the right unit).</p>\n\n<p>Any idea about that ?</p>\n"},{"tags":["delphi","fnv"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":364,"score":1,"question_id":4191523,"title":"Implementation of FNV","body":"<p>I am trying to implement FNV hash from <a href=\"http://isthe.com/chongo/tech/comp/fnv/\" rel=\"nofollow\">http://isthe.com/chongo/tech/comp/fnv/</a></p>\n\n<p>I converted the PowerBasic's inline asm on that page into Delphi.</p>\n\n<pre><code>    function ReadFileToMem(sPath:string):Pointer;\n    var\n    hFile:    THandle;\n    pBuffer:  Pointer;\n    dSize:    DWORD;\n    dRead:    DWORD;\n    begin\n    hFile := CreateFile(PChar(sPath), GENERIC_READ, FILE_SHARE_READ, nil, OPEN_EXISTING, 0, 0);\n    if hFile &lt;&gt; 0 then\n        dSize := GetFileSize(hFile, nil);\n        if dSize &lt;&gt; 0 then\n        begin\n          SetFilePointer(hFile, 0, nil, FILE_BEGIN);\n          GetMem(Result, dSize);\n          ReadFile(hFile, Result^, dSize, dRead, nil);\n          if dRead = 0 then\n            MessageBox(0, PChar('Error reading file.'), PChar('Read Error'), MB_ICONEXCLAMATION)\n         end;\n        CloseHandle(hFile);\n    end;\n\n    function GetPointerSize(lpBuffer: Pointer): Cardinal; // Function by ErazerZ\n    begin\n      if lpBuffer = nil then\n        Result := Cardinal(-1)\n      else\n        Result := Cardinal(Pointer(Cardinal(lpBuffer) -4)^) and $7FFFFFFC -4;\n    end;\n\n     FUNCTION FNV32( dwOffset : Pointer; dwLen : DWORD; offset_basis : DWORD) : DWORD ;\n      asm\n     mov esi, dwOffset      //;esi = ptr to buffer\n     mov ecx, dwLen         //;ecx = length of buffer (counter)\n     mov eax, offset_basis  //;set to 2166136261 for FNV-1\n     mov edi, 16777619//&amp;h01000193    //;FNV_32_PRIME = 16777619\n     xor ebx, ebx           //;ebx = 0\n      @nextbyte:\n     mul edi                //;eax = eax * FNV_32_PRIME\n     mov bl, [esi]          //;bl = byte from esi\n     xor eax, ebx           //;al = al xor bl\n     inc esi                //;esi = esi + 1 (buffer pos)\n     dec ecx                //;ecx = ecx - 1 (counter)\n     jnz @nextbyte           //;if ecx is 0, jmp to NextByte\n     mov @result, eax      //;else, function = eax\n\n    end;\n\nprocedure TForm1.Button1Click(Sender: TObject);\nvar\npFile : Pointer;\nhFile : Cardinal;\nbegin\n//Profiler1['Test'].Start;\npFile := ReadFileToMem(fn);\nhFile := FNV32(pFile,GetPointerSize(pFile),2166136261);\n//Profiler1['Test'].Stop;\n//OutputDebugString(pchar(Profiler1['Test'].AsText[tiAll]));\nOutputDebugString(pchar(inttostr(hFile)));\nend;\n</code></pre>\n\n<p>If a size of given file is more that 200KB, the output is random (hash) number. Am I missing something?</p>\n"},{"tags":["delphi","combobox","delphi-7"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1220,"score":1,"question_id":7158995,"title":"Combobox Style 'csDropDownList' in Delphi","body":"<p>I have created one form in delphi 7 and added one combobox on it. The combobox contains the list of items. I dont want that user can enter the value to Combobox so i have set </p>\n\n<pre><code>combobox.style := csDropDownList;\n</code></pre>\n\n<p>But thorugh code i want to use <code>combobox.text := 'New Item';</code> but its not working. Note that the text I want to show is not in the list of items and I don't want to add it there. Please is any solution to this?</p>\n"},{"tags":["delphi","hint","tdbgrid","mouse-coordinates"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":78,"score":1,"question_id":13117423,"title":"Why do my tool tips appear far away from the mouse coordinates?","body":"<p>I want to show a hint as the user moves the mouse over a <code>TDbStringGrid</code>. It almost works, but the hint shows high and to the left.</p>\n\n<p>In my <code>OnMouseMove</code>, I receive X &amp; Y, which I think are abosulte screen corrdinates, but I can use <code>dbGrid.MouseCoord(X, Y)</code> to get a point within the DB grid.</p>\n\n<p>When I show my hint using <code>Application.ActivateHint()</code>, it is placed high and to the left.</p>\n\n<p>Any idea what I am doing wrong?</p>\n"},{"tags":["delphi","delphi-7","stackoverflow","delphi-5","reportbuilder"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":13119955,"title":"How do I debug a stack overflow?","body":"<p>I was wondering if anyone has had a similar experience. I am trying to trace the source of a problem but am coming up with nil. I have a project in Delphi 5 which has Report Builder reports on it. I needed an upgraded version of reportbuilder so I tried running the project in Delphi 7. When my project runs and I click a button to view a report, it views fine. However, if I use a paramstr to run the report (showmainform is set false) and show report procedure runs, I get get a stack overflow error. </p>\n\n<p>The original code was :</p>\n\n<pre><code> if lowercase(ParamStr(1)) = 'termsexceeded' then begin\n    reportsdata.termsexceeded.close;\n    reportsdata.termsexceeded.open;\n    reports.ppTermsExceeded.print;\n    reportsdata.termsexceeded.close;\n    application.terminate;\n  end; \n</code></pre>\n\n<p>And it gave me the stack overflow error on the .print function.</p>\n\n<p>The code that works in Delphi 7 is :</p>\n\n<pre><code> if lowercase(ParamStr(1)) = 'termsexceeded' then begin\n    reportsdata.termsexceeded.close;\n    reportsdata.termsexceeded.open;\n    reports.left := -10000;\n    reports.show;\n    reports.ppTermsExceeded.print;\n    reportsdata.termsexceeded.close;\n    application.terminate;\n  end; \n</code></pre>\n\n<p>Has anybody got a suggestion on how I could debug this to see if the problem lies with my Delphi 7 or with Reportbuilder ?</p>\n\n<p>There are no events on the .show event of the reports form. </p>\n\n<p>Any advice on how to get to the bottom of this would be appreciated.</p>\n\n<p>Regards</p>\n"},{"tags":["delphi"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13120464,"title":"Quick report Multiple Master detail report","body":"<p><hr>anyone know how to make report model like this:</p>\n\n<p>Table1 ->No_INV* , Total\nTable2 ->No_INV**,Fruit,Price</p>\n\n<h2>MyTitle</h2>\n\n<hr>\n\n<p>pls help me to solve this design report\nand sql syntax for adoquery\ni have make a Tquickrep with\nTitleBand1\nDetailBand1\nSubDetailBand1</p>\n\n<p>my result always like this</p>\n\n<h1>No_INV      total</h1>\n\n<h1>Invoice001  1000</h1>\n\n<pre><code>Apple    500\n</code></pre>\n\n<h1>Invoice001  1000</h1>\n\n<pre><code>oranges   500    \n</code></pre>\n\n<h1>Invoice002  1500</h1>\n\n<pre><code>Grape    1000\n</code></pre>\n\n<h1>Invoice002  1500</h1>\n\n<pre><code>Apple     500\n</code></pre>\n\n<p>im using sql syntax as dataset Tquickrep = select T1.No_Inv, T1.Total, T2.Fruit,T2.Price from T1 inner join T2 on T1.No_Inv=T2.No_Inv</p>\n\n<p>i hope my result : </p>\n\n<h1>No_INV    total</h1>\n\n<h1>Invoice001  1000</h1>\n\n<pre><code>Apple    500\nOranges  500\n</code></pre>\n\n<h1>Invoice002  1500</h1>\n\n<pre><code>Grape   1000\nApple    500\n</code></pre>\n"},{"tags":["sql","delphi","firebird"],"answer_count":10,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3261,"score":3,"question_id":1747452,"title":"Parameters in query with in clause?","body":"<p>I want to use parameter for query like this :</p>\n\n<pre><code>SELECT * FROM MATABLE\nWHERE MT_ID IN (368134, 181956)\n</code></pre>\n\n<p>so I think about this </p>\n\n<pre><code>SELECT * FROM MATABLE\nWHERE MT_ID IN (:MYPARAM)\n</code></pre>\n\n<p>but it doesn't work...</p>\n\n<p>Is there a way to do this ?</p>\n\n<p>I actually use IBX and Firebird 2.1 </p>\n\n<p>I don't know how many parameters in IN clause.</p>\n"},{"tags":["delphi","audio","delphi-2010","shoutcast"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":80,"score":-4,"question_id":13113240,"title":"how get shoutcast server save to data in delphi","body":"<p>i have a problem, how get 85.17.20.129:8040 to address shoutcast server audio data save to  local disk and shoutcast how get icy tag ? in delphi only tidtcpclient</p>\n\n<p>example</p>\n\n<pre><code>GET / HTTP/1.1\nAccept: */*\nUser-Agent: NSPlayer/12.00.7601.17514 WMFSDK/12.00.7601.17514\nIcy-Metadata: 1\nAccept-Encoding: gzip, deflate\nHost: 85.17.20.129:8040\nConnection: Keep-Alive\n\nICY 200 OK\nicy-notice1:&lt;BR&gt;This stream requires &lt;a href=\"http://www.winamp.com/\"&gt;Winamp&lt;/a&gt;&lt;BR&gt;\nicy-notice2:SHOUTcast Distributed Network Audio Server/win32 v1.9.8&lt;BR&gt;\nicy-name:POWERTURK\nicy-genre:Various\nicy-url:http://www.powerturk.com\ncontent-type:audio/aacp\nicy-pub:1\nicy-metaint:8192\nicy-br:64\n</code></pre>\n"},{"tags":["delphi","generics","delphi-xe2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":13119794,"title":"Descending generic TObjectLIst","body":"<p>Say I have a base class:</p>\n\n<pre><code>  TPart = class\n  private   \n    FPartId: Integer;\n  public\n    property PartId: Integer read FPartId write FPartId;\n  end;\n</code></pre>\n\n<p>and I have a generic list for this:</p>\n\n<pre><code>  TPartList = class(TObjectList&lt;TPart&gt;)\n  public\n    function IndexOfPart(PartId: Integer): Integer;\n  end;\n</code></pre>\n\n<p>Now, if I descend from my TPart:</p>\n\n<pre><code>  TModulePart = class(TPart)\n  private\n    FQuantity: Integer;\n  public\n    property Quantity: Integer read FQuantity write FQuantity;\n  end;\n</code></pre>\n\n<p>I want to now create a descendent of TPartList but be able to return me a TModulePart item.  Doing this:</p>\n\n<pre><code>  TModulePartList = class(TPartList)\n  end;\n</code></pre>\n\n<p>will by default think that Items property is of type TPart and not TModulePart (naturally).  I don't want to do:</p>\n\n<pre><code>  TModulePartList = class(TObjectList&lt;TModulePart&gt;)\n  end;\n</code></pre>\n\n<p>because then I miss out inheriting from common methods I might have in TPartList.</p>\n\n<p>Is it possible to do? </p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","http","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":46,"score":-2,"question_id":13108432,"title":"http handshake error","body":"<p>I use Indy library to create http server and client apps. on localhost or on local network, works no problem.\nAs an internet application server fails, Third party Client complaining 'Http handshake error'. NO data in response using my own test client.\nI forwarded port to internet in my router. Client uses free dynamic dns.\nConfigured firewall. In my zone alarm firewall it allows connection.\nWhat could be the problem?\nThanks</p>\n"},{"tags":["mysql","delphi","dbexpress","tclientdataset"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":810,"score":1,"question_id":7740772,"title":"Delphi 2010 MySQL Update through ClientDataSet Failing","body":"<p>I am using Delphi 2010 and connecting to a MySQL database using dbexpress. The connection works 100% and I am retrieving my data. The problem comes when I am trying to update data through a dbGrid. I am running through all the entries in the table performing checks on them. When calling the ApplyUpdates method, I was getting \"Record not found or changed by another user\".</p>\n\n<p>Changing the updateMode on the DataSetProvider to upWhereKeyOnly, I am now in the situation where I am receiving \"Unable to find record, no key specified\". I have tried adding</p>\n\n<pre><code>BasysClientDataSet.FieldByName('idPolicy').ProviderFlags := [pfInUpdate, pfInWhere, pfInKey];\n</code></pre>\n\n<p>this to the code, but I am getting the same error. I have tried adding the ProviderFlags to the SQLQuery but I am getting no such field \"idPolicy\"</p>\n"},{"tags":["delphi","dll"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1040,"score":3,"question_id":4661015,"title":"delphi finalizalization code in a DLL","body":"<p>I am moving some functions to a shared DLL (I want to have some called as a Windows hook).</p>\n\n<p>The actual functions are currently in a <code>unit</code>, and it happens to have some <code>initialization</code> and some <code>finalization</code> code.</p>\n\n<p>I was initially thinking on doing a direct transformation from a <code>unit</code> to a <code>library</code>. So I  moved the <code>initialization</code> code in between the main <code>begin</code> and <code>end.</code>. But then I realized I had no place to move the <code>finalization</code> code. I should create and register an special DLL entry point, instead.</p>\n\n<p>My question is. Can I leave the <code>unit</code> with all the functions and the <code>initialization</code> and <code>finalization</code> codes and just create a <code>library</code> stub that <code>uses</code> the unit?  will the <code>finalization</code>it be called? </p>\n"},{"tags":["delphi","tfs2010","delphi-xe2","vsts2010"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":237,"score":2,"question_id":10083402,"title":"Is there any way to link to VSTS 2010 from Delphi XE2?","body":"<p>I am working on Delphi XE2 version. We are planning to move our code base from JEDI to VSTS 2010. Is there any way to add plugin (like JEDI) or link VSTS 2010 to Delphi XE2?</p>\n\n<p>Does Delphi XE2 support such kind of functionality or any plug-in?</p>\n\n<p><strong>Update :</strong> As per my knowledge, Currently there is no integration of JEDI with Delphi XE2 that's the reason we are looking for some other version control utility which integrates with Delphi XE2</p>\n"},{"tags":["delphi","soap","jax-ws"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2401,"score":2,"question_id":462171,"title":"Delphi 2007 not consuming JAX-WS web service properly","body":"<p>I'm having an issue with Delphi 2007 when trying to consume a web service I've set up in Java using JAX-WS. The web service can be consumed fine from another Java program and from a C# / ASP.NET 2.0 website. However, when I try to access the same service using the WSDL Importer in Delphi 2007 (17-DEc-2007 patch), the JAX-WS web service doesn't recognise any of the parameters I'm passing it and nulls them.</p>\n\n<p>I've checked the SOAP message that's being passed by Delphi and compared it to the others and they are pretty much identical (with the exception of some negligable namespace decs and a whole lot of view state from the .NET one!)</p>\n\n<p>I've also been around the web (most helpful link was Dr Bob's <a href=\"http://www.bobswart.nl/Weblog/Blog.aspx?RootId=5:798\" rel=\"nofollow\">http://www.bobswart.nl/Weblog/Blog.aspx?RootId=5:798</a>) but no joy.</p>\n\n<p>Has anybody come across this before?</p>\n\n<p>TIA.</p>\n"},{"tags":["delphi","delphi-2007","twebbrowser"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":389,"score":1,"question_id":3354656,"title":"Acquire PDF returned after Posting to a web site using TWebBrowser","body":"<p>I am using Delphi 2007.  I can successfully Post data to a web site using WebBrowser.Navigate, but afterwards, when that site returns a PDF, while it appears on the screen of the Browser, I cannot figure out how to acquire the PDF programmatically. I can see some text and HTML using Document.Body.InnerHTML, but not the PDF.  Can someone demonstrate how to acquire the PDF which appears after the POST?</p>\n\n<p>Thank yoU!</p>\n"},{"tags":["delphi","indy"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13111880,"title":"How to use TIdThreadSafe class from Indy10","body":"<p>can I use the Indy Command  TIdThreadSafe to make a class MyPrivateClass threadsafe if I define a new Class </p>\n\n<pre><code>   MyNewIndyClass = Class(TIdThreadSafe)\n         FLocal :  MyPrivateClass \n         create\n          ......\n          end;\n</code></pre>\n\n<p>My MyPrivateClass is not Threadsafe as I access TList and TBitmap items inside this class</p>\n\n<p>If I change the TCPServer.Onexecutde Code to to following style</p>\n\n<pre><code>    ......\n\n     aNewIndyClass  :=  MyNewIndyClass.Create; \n\n     aNewIndyClass.FLocal.CallFuntionA; \n\n     aNewIndyClass.FLocal.CallFuntionB; \n\n      ......\n</code></pre>\n\n<p>Idea for this approach : Keep  MyPrivateClass  code unchange, just add the request for the Indy Server onexecute in a separate class </p>\n"},{"tags":["delphi","application","console","label"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":13096682,"title":"Print label with barcode delphi console","body":"<p>I have a console application in Delphi and I have to print a label with a barcode.\nHow would I do that? Create a print service? Or would I use a <code>QuickReport</code>?</p>\n\n<p>The application is to run in telnet.</p>\n"},{"tags":["delphi","delphi-5"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":115,"score":1,"question_id":13110479,"title":"Delphi items compare between 2 listboxes","body":"<p>I want to know how to compare items between listboxes. On my main form there are two listboxes. I want to add item from 1st to 2nd with a click event but when use it, the same item will multiply on 2nd listbox. Any idea to solve <em>\"the file already exists\"</em> ?</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar\n  i: integer;\nbegin\n  for i := ListBox1.Items.Count - 1 downto 0 do\n    if ListBox1.Selected[i] then                       \n      ListBox2.Items.Add(ListBox1.Items.Strings[i]);\nend;\n</code></pre>\n"},{"tags":["delphi","indy"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":13094245,"title":"Indy10 Deadlock at TCPServer","body":"<p>to write information on the processing state to the GUI  inside a tcpserver.onexecute(..)  function , i used the following command sequence</p>\n\n<pre><code>ExecuteDUMMYCommand(Global_Send_Record);\n\nBitMap_PaintImageProcess;\n\nTThread.Synchronize(nil, BitMap_PaintImageProcess);\n</code></pre>\n\n<p>The code is working well on some machines, but on a few it fails. The code execution stops atTThread.Synchronize command. I guess on these machines the function call is trapped inside a deadlock\nAny chance to figure out the real problem behind ?</p>\n\n<p>The procedure BitMap_PaintImageProcess , here I create a Bitmap and do a lot of painting stuff , but is seems that this code is never executed ?</p>\n\n<hr>\n\n<p>I  try to  explain the very long code and reduce to the main points , the critical thread issues are hidden in processing the bitmap inside my Bitmapprocessingclass. \nThis class is accessed inside the GUIProcessing procedures of my ServerMainForm which also has the INDY TCP Server component.</p>\n\n<pre><code>   {---------------   CLASS DEFINITION   -----------------------------}\n\n   TBitMapProcessingClass = class()\n        FBitmap : TBitmap;\n        FList : TListOfSomething;\n\n        procedure ProcessTheBitmap(....);\n        ......   \n        (many many functions);\n        procedure Init;\n        procedure Free;\n        Procedure Create;\n   end;\n\n\n   TMainform = class(TForm)\n\n      MyServer : TIdTCPServer;\n      aBitMaoProcessingClass : TBitMaoProcessingClass;\n      procedure BitMap_PaintImageProcess;\n      procedure BitMap_ListProcess;\n\n      .....\n      end;       \n\n\n\n{-------------------------   Implemantation ------------------------------}\n\n\nprocedure TMainform.IndyTCPServer.Onexecute()\nbegin\n\n   .......\n\n   ExecuteDUMMYCommand(Global_Send_Record);\n\n   BitMap_PaintImageProcess;\n\n   TThread.Synchronize(nil, BitMap_PaintImageProcess);\n\n   .......\n\n\nend;\n\n\n\nprocedure TMainform.BitMap_PaintImageProcess;\n   begin\n\n      DoSomeServerVCLStuff(....);\n\n      aBitMapProcessingClass.ProcessTheBitmap;\n\n\n      DoSomeServerVCLStuff(....);\n\n  end;\n</code></pre>\n"},{"tags":["delphi","winapi","alpha","vcl"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":13109267,"title":"How can I create alpha blended icon/cursor (indirect) from the TBitmap instance of 32 bpp w/o making an temporary DIB section?","body":"<p>According to <a href=\"http://support.microsoft.com/kb/318876\" rel=\"nofollow\">MS KB entry</a>, there is a quirk in <code>CreateIconIndirect</code> which recognizes <code>HBITMAP</code>s been created with <code>BITMAPV5HEADER</code> passed to <code>CreateDIBSection</code> (and BGRA channel layout). </p>\n\n<p>However,  <code>TBitmap</code> instances with <code>(PixelFormat = pf32bit) and (AlphaFormat = afDefined)</code> (behaving as alpha blended for the other purposes) when referred by its <code>Handle</code>s are not being recognized as valid alpha blended bitmaps for creation of icons or cursors.</p>\n\n<p>Currently, I have to create a full copy of TBitmap using described API calls (<a href=\"http://support.microsoft.com/kb/318876\" rel=\"nofollow\">see</a>) to make <code>CreateIconIndirect</code> accept a bitmap handle as alpha blended. How do I overcome this clumsiness?</p>\n"},{"tags":["oracle","delphi","oledb","ado","tclientdataset"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":571,"score":1,"question_id":6821703,"title":"Number column in oracle with ftBCD datatype parameter in ADO occurs \"Unspecified error\" (Oracle Provider for OleDB)","body":"<p>I have programing a delphi with ADO + DataSetProvider + ClientDataSet. In ApplyUpdates of the ClientDataSet, this generate the ADOcommand with parameters based in fields datatypes.</p>\n\n<p>When a parameter is ftBCD, occurs \"Unspecified error\". If you change datatype for ftFloat, ftExtended or ftCurrency, the command is executed successfully. But the datatype of parameter cannot change using ADO+ClientDataSet. The provider used is \"Oracle Provider for OleDB\". </p>\n\n<p>The \"Microsoft provider OleDB for oracle\" execute without problems, but is very slow and I have problems with CLOB column. The oracle is 11g and the client is 11.2.0.2.</p>\n\n<p>The Delphi is Delphi XE. Sample code for error:</p>\n\n<pre><code>vAdo := TADOConnection.Create(nil);\nvAdo.LoginPrompt := false;\nvAdo.ConnectionString := 'Provider=OraOLEDB.Oracle.1;Password=;Persist Security Info=True;User ID=HR;Data Source=server/orcl;Extended Properties=\"\"';\nvAdo.Connected := True;\n\nvAdoCommando := TADOCommand.Create(nil);\nvAdoCommando.Connection := vAdo;\nvAdoCommando.CommandText := 'UPDATE HD_PRIORIDADE SET TEMPORESPOSTA = ? WHERE HANDLE = ? ';\n\nvParametro := vAdoCommando.Parameters.AddParameter;\nvParametro.DataType := ftBCD;\nvParametro.Value     := 12.3;\nvParametro := vAdoCommando.Parameters.AddParameter;\nvParametro.Value := 1;\n\nvAdoCommando.ExecuteOptions := [eoExecuteNoRecords];\nvAdoCommando.Execute(vResult, EmptyParam);\n</code></pre>\n"},{"tags":["performance","delphi","serialization"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":13110821,"title":"Is there a benchmark for Delphi serialization libraries?","body":"<p>For high performance Delphi / Free Pascal applications which need to communicate over IPC / the network I am interested in performance tests of serialization libraries for Delphi.</p>\n\n<p>As this is not for cross-language operation, binary serialization is an option too, it is not limited to JSON or XML. I am also not limited to serialization of TPersistent or TRemotable descendants, or usage of classic vs extended RTTI.</p>\n\n<p>I have not yet seen a benchmark which allows to run performance statistics for available libraries. Have you seen anything in this direction?</p>\n"},{"tags":["delphi","custom-controls","delphi-xe2","vcl"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13110038,"title":"How can I add the glyph property to my custom component?","body":"<p>How can I add a glyph property to my custom component?</p>\n\n<p>Vcl.Buttons has declared class <code>TButtonGlyph</code> but I cannot use it (Delphi is not seeing it with Vcl.Buttons in uses list).</p>\n"},{"tags":["delphi","postbuild-event"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13110071,"title":"Delphi 2007 post-build event, copy exe into specific directory?","body":"<p>In Delphi 2007 how can I copy the newly-built exe into a specific directory using the post-build event?</p>\n\n<p>Any link to a list of build event commands would be much appreciated.</p>\n"},{"tags":["delphi","reflection","properties","delphi-xe","rtti"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":137,"score":3,"question_id":9705656,"title":"Map TRttiProperty to a class definition equivalent","body":"<p>I'm wondering if its possible to reference a class definition directly for purpose of using it in conjunction to RTTI (map a property to TRttiProperty, etc).</p>\n\n<p>E.g.</p>\n\n<p>I would like to use TMyClass.MyProperty as a TRttiProperty, without having to resolve it via a name/ string, this will keep my code and compiler integrity intact, as string variables may be misspelled, etc.</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","soap","delphi-2009","digital-signature"],"answer_count":1,"favorite_count":0,"up_vote_count":14,"down_vote_count":0,"view_count":170,"score":14,"question_id":8184825,"title":"How to verify SOAP signature w/ Delphi 2009?","body":"<p>I'm using the Clever Internet Suite in D2009 to sign a SOAP message and need a way to verify the signed document locally.  The server keeps bouncing the SOAP message with the error \"Hash values do not match\".  </p>\n\n<p>I have to manipulate the document slightly before submitting but not the signed section so I need to find out if this manipulation is causing the error.  I can also obtain the document received by the server and want to verify that copy to see if something is changing in transmission.</p>\n\n<p>Is there a way using the Clever Suite?  Or maybe the Crypto.api?  Even a standalone app that I can feed the document and public key to would be fine.</p>\n\n<p>Thank you for any information you can provide.</p>\n"},{"tags":["delphi","delphi-7","collision-detection","game"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":141,"score":1,"question_id":13063009,"title":"How to test if a shape and a panel are at the same location","body":"<p>The idea is that you must shoot the panel. So the panel will be set to a random location at the top of the screen and then move down to the botom of the screen. You must shoot the panel with the shapes before it reaches the bottom. But I dont know how to test if the created shape is at the location of the panel to reset the panel. At the moment this is my code but the if tests false. </p>\n\n<pre><code>unit Unit1;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, ExtCtrls, StdCtrls, jpeg;\n\nconst\n  MaxRays=100;\n  RayStep=8;\ntype\n   TForm1 = class(TForm)\n   Panel1: TPanel;\n    Timer1: TTimer;\n    Timer2: TTimer;\n    Button1: TButton;\n    Shape1: TShape;\n    Timer3: TTimer;\n    Image1: TImage;\n    procedure Timer2Timer(Sender: TObject);\n    procedure Button1Click(Sender: TObject);\n    procedure FormActivate(Sender: TObject);\n    procedure FormMouseWheelDown(Sender: TObject; Shift: TShiftState;\n      MousePos: TPoint; var Handled: Boolean);\n    procedure FormMouseWheelUp(Sender: TObject; Shift: TShiftState;\n       MousePos: TPoint; var Handled: Boolean);\n     procedure Timer3Timer(Sender: TObject);\n    procedure FormMouseDown(Sender: TObject; Button: TMouseButton;\n      Shift: TShiftState; X, Y: Integer);\n  private\n    { Private declarations }\n    Rays:array[0..MaxRays-1] of TShape;\n\n   public\n   procedure StartPanelAnimation1;\n   procedure DoPanelAnimationStep1;\n   function  PanelAnimationComplete1: Boolean;\n   { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n var key : char;\n{$R *.dfm}\n\n{ TForm1 }\n\n\n\n { TForm1 }\n\n procedure TForm1.DoPanelAnimationStep1;\nbegin\nPanel1.Top := Panel1.Top+1;\nend;\n\nfunction TForm1.PanelAnimationComplete1: Boolean;\nbegin\n Result := Panel1.Top=512;\nend;\n\nprocedure TForm1.StartPanelAnimation1;\nbegin\n  Panel1.Top := 0;\n  Timer1.Interval := 1;\n  Timer1.Enabled := True;\nend;\n\nprocedure TForm1.Timer2Timer(Sender: TObject);\nbegin\n   DoPanelAnimationStep1;\n   if PanelAnimationComplete1 then\n    StartPanelAnimation1;\n   if (shape1.Top &lt; panel1.Top) and (shape1.Left &lt; panel1.Left+104) and (shape1.Left &gt;       panel1.Left)   then\n   begin\n    startpanelanimation1;\n    sleep(10);\n   end;\nend;\n\nprocedure TForm1.Button1Click(Sender: TObject);\nbegin\n button1.Hide;\n  key := 'a';\n  timer2.Enabled := true;\n  StartPanelAnimation1; \nend;\n\nprocedure TForm1.FormActivate(Sender: TObject);\nbegin\n shape1.Visible := false;\n timer2.Enabled := false;\n end;\n\nprocedure TForm1.FormMouseWheelDown(Sender: TObject; Shift: TShiftState;\n  MousePos: TPoint; var Handled: Boolean);\n   begin\nimage1.Left := image1.Left-10;\nend;\n\n procedure TForm1.FormMouseWheelUp(Sender: TObject; Shift: TShiftState;\n  MousePos: TPoint; var Handled: Boolean);\n    begin\n    image1.Left := image1.Left+10;\n   end;\n\nprocedure TForm1.Timer3Timer(Sender: TObject);\nvar\n  i:integer;\nbegin\n  for i:=0 to MaxRays-1 do\n    if Rays[i]&lt;&gt;nil then\n    begin\n      Rays[i].Top:=Rays[i].Top-RayStep;\n      if Rays[i].Top&lt;0 then FreeAndNil(Rays[i]);\n    end;\nend;\n\n\nprocedure TForm1.FormMouseDown(Sender: TObject; Button: TMouseButton;\n  Shift: TShiftState; X, Y: Integer);\n   var\n   i:integer;\nbegin\n  i:=0;\n  while (i&lt;MaxRays) and (Rays[i]&lt;&gt;nil) do inc(i);\n  if i&lt;MaxRays then\n   begin\n    Rays[i]:=TShape.Create(Self);\n    Rays[i].Shape:=stEllipse;\n    Rays[i].Pen.Color:=clRed;\n    Rays[i].Pen.Style:=psSolid;\n    Rays[i].Brush.Color:=clYellow;\n    Rays[i].Brush.Style:=bsSolid;\n    Rays[i].SetBounds(X-4,Y-20,9,41);\n    Rays[i].Parent:=Self;\n    end;\nend;\n\nprocedure TForm1.FormCreate(Sender: TObject);\nvar\n  i:integer;\nbegin\n  for i:=0 to MaxRays-1 do Rays[i]:=nil;\nend;\n\nend.\n</code></pre>\n\n<p>I have tried what @NGLN has said but when I i click the the mouse button the shape moves like 10 pixels then stops, when it stops the panel which was moving down normally is now moving like crazy at the top of the screen changing its left position but the top position stays 0.</p>\n\n<p>Here Is the new code</p>\n\n<pre><code>unit Unit1;\n\ninterface\n\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, ExtCtrls, StdCtrls, jpeg;\n\n  const\n  MaxRays=100;\n  RayStep=8;\ntype\n  TForm1 = class(TForm)\n    Panel1: TPanel;\n    Timer1: TTimer;\n    Timer2: TTimer;\n    Button1: TButton;\n    Shape1: TShape;\n    Timer3: TTimer;\n    Image1: TImage;\n    Timer4: TTimer;\n    procedure Timer2Timer(Sender: TObject);\n    procedure Button1Click(Sender: TObject);\n    procedure FormActivate(Sender: TObject);\n    procedure FormMouseWheelDown(Sender: TObject; Shift: TShiftState;\n      MousePos: TPoint; var Handled: Boolean);\n    procedure FormMouseWheelUp(Sender: TObject; Shift: TShiftState;\n      MousePos: TPoint; var Handled: Boolean);\n    procedure Timer3Timer(Sender: TObject);\n    procedure FormMouseDown(Sender: TObject; Button: TMouseButton;\n      Shift: TShiftState; X, Y: Integer);\n    procedure FormCreate(Sender: TObject);\n  private\n    { Private declarations }\n    Rays:array[0..MaxRays-1] of TShape;\n  public\n   procedure StartPanelAnimation1;\n   procedure DoPanelAnimationStep1;\n   function  PanelAnimationComplete1: Boolean;\n   function EllipticShapeIntersectsPanel(Shape: TShape; Panel: TPanel): Boolean;\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n var key : char;\n{$R *.dfm}\n\n{ TForm1 }\n\n\n\n{ TForm1 }\n\nprocedure TForm1.DoPanelAnimationStep1;\nbegin\nPanel1.Top := Panel1.Top+1;\nend;\n\nfunction TForm1.PanelAnimationComplete1: Boolean;\nbegin\n Result := Panel1.Top=512;\nend;\n\nprocedure TForm1.StartPanelAnimation1;\nvar left : integer;\nbegin\n  Panel1.Top := 0;\n  randomize;\n  left := random(clientwidth-105);\n  panel1.Left := left;\n  Timer1.Interval := 1;\n   Timer1.Enabled := True;\nend;\n\nprocedure TForm1.Timer2Timer(Sender: TObject);\n var I: Integer;\nbegin\n DoPanelAnimationStep1;\n  if PanelAnimationComplete1 then\n    StartPanelAnimation1;\n   I := 0;\n  while (Rays[I] &lt;&gt; nil) and (I &lt; MaxRays)  do\n  begin\n    if EllipticShapeIntersectsPanel(Rays[I], Panel1) then\n    Inc(I);\n    startpanelanimation1;\n  end;\nend;\n\nprocedure TForm1.Button1Click(Sender: TObject);\nbegin\n button1.Hide;\n key := 'a';\n timer2.Enabled := true;\n StartPanelAnimation1;\nend;\n\nprocedure TForm1.FormActivate(Sender: TObject);\nbegin\n shape1.Visible := false;\n timer2.Enabled := false;\nend;\n\nprocedure TForm1.FormMouseWheelDown(Sender: TObject; Shift: TShiftState;\n  MousePos: TPoint; var Handled: Boolean);\nbegin\nimage1.Left := image1.Left-10;\nend;\n\nprocedure TForm1.FormMouseWheelUp(Sender: TObject; Shift: TShiftState;\n  MousePos: TPoint; var Handled: Boolean);\nbegin\n image1.Left := image1.Left+10;\nend;\n\n\nprocedure TForm1.Timer3Timer(Sender: TObject);\nvar\n  i:integer;\nbegin\n  for i:=0 to MaxRays-1 do\n    if Rays[i]&lt;&gt;nil then\n    begin\n      Rays[i].Top:=Rays[i].Top-RayStep;\n      if Rays[i].Top&lt;0 then FreeAndNil(Rays[i]);\n    end;\nend;\n\nprocedure TForm1.FormMouseDown(Sender: TObject; Button: TMouseButton;\n  Shift: TShiftState; X, Y: Integer);\n var\n  i:integer;\n  left : integer;\n  top : integer;\nbegin\n  i:=0;\n  while (i&lt;MaxRays) and (Rays[i]&lt;&gt;nil) do i:= i+10;\n  if i&lt;MaxRays then\n   begin\n    Rays[i]:=TShape.Create(Self);\n    Rays[i].Shape:=strectangle;;\n    Rays[i].Pen.Color:=clRed;\n    Rays[i].Pen.Style:=psSolid;\n    Rays[i].Brush.Color:=clred;\n    Rays[i].Brush.Style:=bsSolid;\n    left := image1.Left+38;\n    top := image1.Top-30;\n    Rays[i].SetBounds(left,top,9,33);\n    Rays[i].Parent:=Self;\n   end;\n\nend;\n\nprocedure TForm1.FormCreate(Sender: TObject);\nbegin\n Screen.Cursor:=crNone;\nend;\n\nfunction TForm1.EllipticShapeIntersectsPanel(Shape: TShape;\n  Panel: TPanel): Boolean;\nvar\n  ShapeRgn: HRGN;\nbegin\n  with Shape.BoundsRect do\n    ShapeRgn := CreateEllipticRgn(Left, Top, Right, Bottom);\n  try\n    Result := RectInRegion(ShapeRgn, Panel.BoundsRect);\n  finally\n    DeleteObject(ShapeRgn);\n  end;\nend;\n\nend. \n</code></pre>\n"},{"tags":["delphi","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":67,"score":1,"question_id":13108710,"title":"Enabling editing for TStringGrid","body":"<p>I am making a simple database application by following this <a href=\"http://www.youtube.com/watch?feature=player_detailpage&amp;v=416qL6is5Xw#t=204s\" rel=\"nofollow\">video</a>. My problem occurs when I use a <code>TStringGrid</code> instead of a <code>TGrid</code> as stated the video because I don't have it. I have a Navigator and  all of my data loaded into the <code>TStringGrid</code>, but I am unable to edit it at all. So far I've tried double clicking an entry, pressing F2 and clicking on the Edit button on the Navigator, but nothing is working.</p>\n\n<p>Is there anything I need to alter in the properties of the <code>TStringGrid</code> to allow editing or is the purpose of it only to display data?</p>\n\n<p>Thank you in advanced!</p>\n"},{"tags":["delphi","sockets","drawing","client-server","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":82,"score":1,"question_id":13108683,"title":"Delphi local net app","body":"<p>Trying to learn how to make server-client apps and stuff like. I trying to draw circles(on mouse click) in all clients so this is how i trying to do that. But it's not working - no errors but form is empty. What i need to fix?\nClient code</p>\n\n<pre><code>unit Client;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, StdCtrls, ExtCtrls, {Figure, Ball,} IdBaseComponent, IdComponent,\n  IdTCPConnection, IdTCPClient, ScktComp;\n\ntype\n  TForm1 = class(TForm)\n    Timer1: TTimer;\n    Button1: TButton;\n    ClientSocket: TClientSocket;\n    procedure FormCreate(Sender: TObject);\n    procedure Button1Click(Sender: TObject);\n    procedure Timer1Timer(Sender: TObject);\n    procedure FormClose(Sender: TObject; var Action: TCloseAction);\n    procedure FormMouseDown(Sender: TObject; Button: TMouseButton;\n      Shift: TShiftState; X, Y: Integer);\n\n\n\n  private\n\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n  f:boolean;\n  p:MyPoint;\n  s:MyPoint;\n  z:TCanvas;\n  obj: MyFigure;\n  pX, pY:Integer;\n  myBuf: array[1..32] of Integer;\n  dataBuf: array[1..32] of Integer;\nimplementation\n\n{$R *.dfm}\n\n\n\nprocedure TForm1.FormCreate(Sender: TObject);\nbegin\n\n  Timer1.Enabled:=false;\n  Timer1.Interval:=5;\n  z:=Form1.Canvas;//TCanvas.Create;\n\n  Button1.Caption:='Пуск';\n\n\n  f:=false;\n\n  ClientSocket.Port:=1234;\n  ClientSocket.Active:= False;\nend;\n\nprocedure TForm1.Button1Click(Sender: TObject);\nbegin\nif not f then\n begin\n  Timer1.Enabled:=true;\n  Button1.Caption:='Стоп';\n  f:=not f;\n end\nelse\n begin\n  Timer1.Enabled:=false;\n  Button1.Caption:='Пуск';\n  ClientSocket.Active:= True;\n  f:=not f;\n end;\nend;\n\nprocedure TForm1.Timer1Timer(Sender: TObject);\nbegin\n //z.Lock;\n\n  //z.Brush.Color:=ClWhite;\n  //z.FillRect(Canvas.ClipRect);\n\n  //obj.Draw(z);\n  if ClientSocket.Active  then\n     ClientSocket.Socket.ReceiveBuf(dataBuf, 32);\n\n  z.Brush.Color:=ClRed; \n  z.Ellipse(dataBuf[1] + 10, dataBuf[2] + 10,dataBuf[1] - 10, dataBuf[2] - 10);\n\n//z.Unlock;\nend;\n\n\n\nprocedure TForm1.FormClose(Sender: TObject; var Action: TCloseAction);\nbegin\n      ClientSocket.Active := false;\nend;\n\n\nprocedure TForm1.FormMouseDown(Sender: TObject; Button: TMouseButton;\n  Shift: TShiftState; X, Y: Integer);\nbegin\n\n  myBuf[1]:=X;\n  myBuf[2]:=Y;\n  if ClientSocket.Active  then\n     ClientSocket.Socket.SendBuf(myBuf, 32);\n\nend;\n\nend.\n</code></pre>\n\n<p>Server</p>\n\n<pre><code>unit ServerProject;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, StdCtrls, ScktComp;\n\ntype\n  TForm1 = class(TForm)\n    ServerSocket1: TServerSocket;\n    procedure FormCreate(Sender: TObject);\n    procedure FormClose(Sender: TObject; var Action: TCloseAction);\n    procedure ServerSocket1ClientRead(Sender: TObject;\n      Socket: TCustomWinSocket);\n    procedure ServerSocket1ClientWrite(Sender: TObject;\n      Socket: TCustomWinSocket);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n  sBufer : array [1..32] of Integer;\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm1.FormCreate(Sender: TObject);\nbegin\n  ServerSocket1.Port:=1234;\n  ServerSocket1.Active := True;\nend;\n\nprocedure TForm1.FormClose(Sender: TObject; var Action: TCloseAction);\nbegin\n  ServerSocket1.Active := false;\nend;\n\nprocedure TForm1.ServerSocket1ClientRead(Sender: TObject;\n  Socket: TCustomWinSocket);\nvar\n  i:integer;\n\nbegin\n  for i := 0 to ServerSocket1.Socket.ActiveConnections-1 do\n  begin\n    with ServerSocket1.Socket.Connections[i] do\n    begin\n      ReceiveBuf(sBufer, 32);\n    end;\n  end;\nend;\n\nprocedure TForm1.ServerSocket1ClientWrite(Sender: TObject;\n  Socket: TCustomWinSocket);\nvar\n  i:integer;\n\nbegin\n  for i := 0 to ServerSocket1.Socket.ActiveConnections-1 do\n  begin\n    with ServerSocket1.Socket.Connections[i] do\n    begin\n      SendBuf(sBufer, 32);\n    end;\n  end;\n\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","ribbon"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1024,"score":1,"question_id":1402373,"title":"How To Read and Write Delphi 2010 RibbonApplicationMenuBar Recent Items To A File","body":"<p>How do you read and write <code>RibbonApplicationMenuBar</code> recent items to a file or an INI file?</p>\n\n<p>The help file is not very helpful for getting at the list of recent item strings to save and reload the recent items.  I can add items to the recent items list by <code>Ribbon1.AddRecentItem( APathFilename)</code> and open the file associated with the recent item with the <code>RecentItemClick</code> event but I can not figure out how to save and reload recent filenames to the recent items list.</p>\n"},{"tags":["delphi","sip","voip"],"answer_count":1,"favorite_count":4,"up_vote_count":1,"down_vote_count":0,"view_count":205,"score":1,"question_id":10876857,"title":"VoIP, SIP, noice reduction, echo cancelation","body":"<p>I am tweaking an existing SIP solution for asterisk VoIP. It is working, but it has no sound quality control or no filters to improve the sound on bad lines. I searched google over and over for existing Delphi solutions in this area or some algorithms, but it seems Delphi is very poor here. I know there are commercial libraries out there that offer at least some of this. But I am looking for free source code so I can either use it or do my own implementation of it. </p>\n\n<p>I have already implemented jitter info and jitter buffer. What I am now looking is:</p>\n\n<ol>\n<li>Filters: Noise reduction, Echo cancelation...etc</li>\n<li>Any other means to improve sound when lagging occurs and in general the line quality is bad.</li>\n</ol>\n\n<p>Do any of you have the knowledge where to get any of this? If nothing else you can provide algorithms or other languages code.</p>\n\n<p>P.S</p>\n\n<p>Any solutions I make will be released back to the community. I will release jitter buffer shortly.</p>\n"},{"tags":["delphi","components","voip","sip"],"answer_count":7,"favorite_count":5,"up_vote_count":8,"down_vote_count":0,"view_count":1835,"score":8,"question_id":7349565,"title":"Are there any good Delphi VoIP SIP SDK/Library/Component?","body":"<p>Are there any good Delphi VoIP SIP SDK/Library/Component that you have personally used? </p>\n\n<p>This is might to be not only open source or free, but and a good commercial solutions within reasonable limits.</p>\n"},{"tags":["delphi","events","dll","cobol","tclientsock"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":565,"score":0,"question_id":3158844,"title":"Delphi DLL - TClientSocket events","body":"<p>I have a DLL with a TClientSocket component, it is used to talk to a Telephone System Machine. The DLL only have PChar parameters in the exports methods, and is not using packages.</p>\n\n<p>When I load the DLL with Delphi app, all the events works fine, no problem so far.</p>\n\n<p>My customer is calling this DLL from a console Win32 Cobol program, and the TClientSocket do not trigger the events when its happen, it uses a main loop to call a check method in DLL to known if is there any returning from the Telephone system, if it returns OK then it call the Get Method, and here is where the problem happen:</p>\n\n<p>In TClientSocket.OnRead event, I call TClientSocket.Socket.ReceiveText, and there are several returns from server app, what make me think that the event is only triggered when I call a method from DLL, and the TClientSocket is holding several returns in the buffer.</p>\n\n<p>The problem is that I cant find any Delimiter to split this Return.</p>\n\n<p>How can I fix this? Is there anything I can add to my DLL to make sure that the OnRead event will be triggered every time when it is not called from a Delphi Program?</p>\n"},{"tags":["delphi","ribbon","mru"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13106786,"title":"How To Read and Write Delphi 2010 RibbonApplicationMenuBar Recent Items from/to a file Part2","body":"<p>This question was previously asked about 3 years ago but only half answered.</p>\n\n<p>The original question is here:\n<a href=\"http://stackoverflow.com/questions/1402373/how-to-read-and-write-delphi-2010-ribbonapplicationmenubar-recent-items-to-a-fil\">How To Read and Write Delphi 2010 RibbonApplicationMenuBar Recent Items To A File</a>\nand the accepted answer gives enough information so that you can figure out how to save the mru list but no information on how to successfully reload it.</p>\n\n<p>This is what I have at the moment.</p>\n\n<p>SaveDocHistory() is called by the closing event on the form and does what it is supposed to.</p>\n\n<pre><code>procedure TfrmMain.SaveDocHistory;\nvar\n  ini : TIniFile;\n  i : Integer;\nbegin\n  Ini := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini'));\n  try\n    ini.EraseSection('DocHistory');\n    ini.WriteString('DocHistory', 'FileCount', IntToStr(RibbonApplicationMenuBar1.RecentItems.Count));\n\n    for i := 0 to Pred(RibbonApplicationMenuBar1.RecentItems.Count) do\n      ini.WriteString('DocHistory', 'File' + IntToStr(i),\n                      RibbonApplicationMenuBar1.RecentItems.Items[i].Caption );\n  finally\n    ini.Free;\n  end;\nend;\n</code></pre>\n\n<p>The resultant ini file entries look like this:</p>\n\n<pre><code>[DocHistory]\nFileCount=3\nFile0=F:\\Projects\\StevenTest\\Test02.rtf\nFile1=F:\\Projects\\StevenTest\\Test1.rtf\nFile2=F:\\Projects\\StevenTest\\Test01.rtf\n</code></pre>\n\n<p>The problem is reloading the RibbonApplicationMenuBar's RecentItems list.  My code 'appears' to work in that in the items are listed in the recently used section of the application - but unlike 'real' mru items they do not response to the click event. Any new items added to the mru list work but not my 'implants'. So it appears that I'm reloading the captions but not the file information.  Here is my code, a function that's called by the FormCreate event of the form holding the RibbonApplicationMenuBar.</p>\n\n<pre><code>procedure TfrmMain.LoadDocHistory;\nvar\n  ini : TIniFile;\n  nCount, i : Integer;\n  sTmp : string;\nbegin\n  Ini := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini'));\n  try\n    nCount := ini.ReadInteger('DocHistory', 'FileCount', 0 );\n\n    for i := 0 to Pred(nCount) do\n    begin\n      sTmp := ini.ReadString('DocHistory', 'File' + IntToStr(i), '');\n      RibbonApplicationMenuBar1.RecentItems.Add.Caption := sTmp;\n    end;\n\n  finally\n    ini.Free;\n  end;\nend;\n</code></pre>\n\n<p>I've tried deciphering Delphi's help but the AddRecentItem() function method they mention either is not applicable to the RibbonApplicationMenuBar or I have been incorrect in the way I tried to use it. I have searched the web but all I've found are multiple references to the previously mentioned thread. If anyone has been successful in getting the 2nd half of this issue resolved I would appreciate the information.</p>\n\n<p>BTW like the title of the post I am using Delphi2010 for this project.</p>\n\n<p>Thanks.. </p>\n"},{"tags":["c++","delphi","http","tunnel"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":829,"score":2,"question_id":6739873,"title":"Http tunnel sample","body":"<p>Is it possible to create an HTTP tunnel in Delphi or C++?</p>\n\n<p>My application connects to several HTTP servers that do not belong to the company I work for. Because of that, our users need to open their firewall ports to allow those connections. I thought about creating a tunnel at my company and redirecting HTTP requests made by my application through this tunnel. This way, my clients will only need to open one port and the tunnel will handle all requests. All requests are made with POST or GET using indy components.</p>\n\n<p><strong>EDIT:</strong> I can't use an HTTP proxy. Some of my users have already got their own HTTP proxy and it is going to be impossible to connect to two different proxy servers at the same time.</p>\n"},{"tags":["c#","delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":127,"score":-2,"question_id":13101575,"title":"Implementation of Delphi's TStringStream in C#","body":"<p>How can I implement a StringStream class in C#, like Delphi's TStringStream class.</p>\n\n<p>Here's how I would do it in Delphi:</p>\n\n<pre><code>var\n    StringStream: TStringStream;\nbegin\n    StringStream := TStringStream.Create('');\n    StringStream.Write('stackoverflow', SizeOf('stackoverflow'));\nend;\n</code></pre>\n\n<p>But in C# I don't have StringStream.</p>\n"},{"tags":["delphi","delphi-xe2","ews"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13084508,"title":"It is possible to use the EWS Managed API from a Delphi Win32 VCL app (and how to start)?","body":"<p>I'm currently investigating accessing Exchange Web Services (EWS) through SOAP (see e.g. <a href=\"http://stackoverflow.com/questions/13084064/how-to-fix-unresolved-types-when-importing-exchange-web-services-ews-wsdl-file\">this prior question</a>), but there also is a recommended <a href=\"http://msdn.microsoft.com/en-us/library/exchange/dd633709%28v=exchg.80%29.aspx\" rel=\"nofollow\">EWS Managed API</a>.</p>\n\n<p>Would it be possible to use that API from a Win32 Delphi-XE2 app? I see people using the API from e.g. PHP with tools like <a href=\"https://github.com/jamesiarmes/php-ews/\" rel=\"nofollow\">PHP-EWS</a> so it looks possible from other languages than C#, but where would I start using Delphi? </p>\n"},{"tags":["delphi","delphi-6"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":13084786,"title":"Delphi command line build (DCC32) error: System.pas not found","body":"<p>Delphi 6 Professional in Win7/x64, with c:\\Delphi6 folder.</p>\n\n<p>Because the ProjectGroups are making OM errors, we need to build the projects one by one. </p>\n\n<p>To provide faster compilation I tried to use DCC32.exe.</p>\n\n<p>I found some info in this site about \"extend dcc32.cfg with 4 options to set the library paths\". \nI set each of them to the \"Delphi/Options/Env. options/Library path\".</p>\n\n<p>Then I tried:</p>\n\n<p>dcc32.exe b \"any.dpr\"</p>\n\n<p>But I got error: System.pas don't found.</p>\n\n<p>I don't understand it - maybe the dcc32.exe want to BUILD the basic pas files too, or I need to use another format.</p>\n\n<p>We need to BUILD each of the projects, because we are using many conditional directives.</p>\n\n<p>Thanks for the every info, suggestion you will write.</p>\n"},{"tags":["delphi","delphi-xe","tchart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13087961,"title":"Change size of depth Axis in rotated view","body":"<p>Using Delphi XE with TeeChart Pro 2011 on Windows 7.</p>\n\n<p>I have a chart which shows the height differences of a disc (in nano-meters). \nIn total there are 100 rectangular fields each with about 1000 data points, almost evenly distributed on the disc. The field at the edges are only partially filled as there is no data outside the disc. <code>IrregularGrid := True;</code> is required to see the data properly.\nIdeally, I'd use a <code>TColorGridseries</code>, as that would provide exactly the (2d)view I want to achieve. Unfortunately the distribution of the data is such that the <code>TColorGridseries</code> simply does not function properly (Known TChart bug).</p>\n\n<p>I turned to the <code>TSurfaceSeries</code>, which can handle the data properly. The main disadvantage is that the 3d aspect puts the Z values on the left axis and the Y values on the depth axis. This results in a side view of the disc. To compensate I can rotate the 3d chart so I get a top view again, however the depth axis is drawn such that I get a chart rectangle with a 1:10 ratio.</p>\n\n<p>My question in the end is simple:\nIs there a way to set the (pixel)length of the depth axis to the same (pixel)length as the horizontal axis, so that I get a 1:1 ratio for the top view of a 3d chart?</p>\n\n<p>Regards,\ndeColaman</p>\n"},{"tags":["delphi","windows-vista"],"answer_count":6,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":716,"score":6,"question_id":514968,"title":"How to run a process non-elevated with Delphi2007","body":"<p>I have an installer-like application that I have to run as elevated on Vista. But from there I have to start a new process as non-elevated. Any hints how to do this with Delphi2007?</p>\n"},{"tags":["delphi","dll","function","pointers"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":4681,"score":3,"question_id":1819180,"title":"(Delphi) Call DLL with function pointer parameter","body":"<p>I'm stuck with calling an external DLL and passing a function (pointer) as parameter.\nI've recently had different problem of passing some arguments to DLL and you helped.\nHope, someone know how to do this as well....</p>\n\n<p>Here's function declaration in DLL (cpp) that needs to be called from Delphi:</p>\n\n<pre>\n<code>\ntypedef void (*PTR_Allocate)(char**, unsigned long*);\ntypedef void (*PTR_Deallocate)(char*);\n\nextern \"C\" export_dll_function void SetAllocateFunction(PTR_Allocate);\nextern \"C\" export_dll_function void SetDeallocateFunction(PTR_Deallocate);\n\nvoid Allocate(char** pbuffer, unsigned long* psize)\n{\n    *psize = *psize * 2;\n    *pbuffer = new char[*psize];\n}\n\nvoid Deallocate(char* buffer)\n{\n    delete[] buffer;\n}\n</code>\n</pre>\n\n<p>Could you please be so kind to help me rewrite this in Delphi (7) ?</p>\n\n<p>Here's what I've tried and it throws an exception (\"External exception\"):</p>\n\n<pre>\n<code>\ntype\n   PByte = ^TByte;\n   TByte = array of byte;\n   TFunc = function(var pbuffer: PByte; var psize: Cardinal): integer; cdecl;\n   Procedure _SetAllocateFunction(var f: TFunc); cdecl;\n\nimplementation\n\nfunction Allocate(var pbuffer: PByte; var psize: Cardinal): Integer; cdecl;\nbegin\n  psize := psize * 2;\n  GetMem(pbuffer, psize);\nend;\n\n   var Func: TFunc;\n   Func := @Allocate;\n   _SetAllocateFunction(Func);   \n</code>\n</pre>\n\n<p>Thank you very much !</p>\n"},{"tags":["delphi","oop","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":140,"score":2,"question_id":13102290,"title":"Passing multiple objects as one parameter","body":"<p>I want to pass multiple objects as one parameter with the smallest effort. </p>\n\n<p>I've got some type</p>\n\n<pre><code>TOpenMode = [omNew, omEdit, omBrowse] \n</code></pre>\n\n<p>And a procedure   </p>\n\n<pre><code>procedure OpenForm(Form: TForm; ANewWindow: boolean = false; \n                   Datasets: TUniDataSet; TableOpenMode: TOpenMode);\n</code></pre>\n\n<p>I want to pass more than one dataset. Can I do that without arrays or creating new objects? How can I make them to be passed in pairs <code>[UniTable1, TOpenMode], [UniTable2, TOpenMode]</code>?</p>\n"},{"tags":["delphi","devexpress","alerts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13100815,"title":"Altering existing message on TdxAlertWindowManager","body":"<p>I use a piece of code like this to show an alert using the <code>TdxAlertWindowManager</code>.\nThis gives me one alert window and in this window there are several messages.\nWhat I would like to do is to show an alert window with the first line of text and on the same window I would like to put a new text.\nThe program is used to connect a computer to some network shares and the message I would like to put looks like:</p>\n\n<pre><code>Connecting drive y: to \\\\server\\foldery\nConnecting drive x: to \\\\server\\folderx\n</code></pre>\n\n<p>and so on for the rest of the shares.\nBut I can't figure out how to do it with <code>TdxAlertWindowManager</code></p>\n\n<p>Some years ago when I made the program I used <code>nxAlert</code> from Berg software, but I don't have it available any more. On that it was no problem to do this.</p>\n\n<pre><code>if fAlertWindow = nil then\n  dxAlertWindowManager.Show(sHpAlertCaption, AlertText, fIndex).Tag := 1\nelse\n  begin\n    fAlertWindow.MessageList.Add(sHpAlertCaption, AlertText, fIndex);\n    fAlertWindow.RestartDisplayTimer;\n  end;\n</code></pre>\n"},{"tags":["delphi","keyboard","delphi-2009","keydown"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1456,"score":0,"question_id":573392,"title":"Delphi 2009 OnKeyDown does not trap as Delphi 2007 does","body":"<p>I have this code</p>\n\n<pre><code>procedure TForm1.Edit1KeyDown(Sender: TObject; var Key: Word; Shift: TShiftState);\nvar\nbegin\n  if not (Key in [Ord('0')..Ord('9')]) then\n    Key := 0;\nend;\n</code></pre>\n\n<p>and it worked fine with Delphi 2007. When I upgraded to Delphi 2009 and I try to press any letter it is accepted and the Key := 0 does not trap the input?</p>\n\n<p>Anyone encountered the same behavior?</p>\n"},{"tags":[".net","delphi","dll","unmanaged"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1255,"score":3,"question_id":2043214,"title":"Unmanaged Exports: Cannot compile assembly","body":"<p>I want to create a .NET assembly that can be accessed from unmanaged code (Delphi 5). </p>\n\n<p>I have found <a href=\"http://sites.google.com/site/robertgiesecke/Home/uploads/unmanagedexports\" rel=\"nofollow\">Unmanaged Exports</a> and followed the steps there but I am unable to successfuly compile even the basic example:</p>\n\n<pre><code>using RGiesecke.DllExport;\n\nnamespace DelphiNET\n{\n    public class Class1\n    {\n        [DllExport(\"add\")]\n        public static int Add(int left, int right)\n        {\n            return left + right;\n        }\n    }\n}\n</code></pre>\n\n<p><code>DelphiNET.csproj</code> project file:</p>\n\n<pre><code>...\n&lt;ItemGroup&gt;\n  &lt;Compile Include=\"Class1.cs\" /&gt;\n  &lt;Compile Include=\"DllExport\\DllExportAttribute.cs\" /&gt;\n  &lt;Compile Include=\"Properties\\AssemblyInfo.cs\" /&gt;\n&lt;/ItemGroup&gt;\n&lt;Import Project=\"$(MSBuildToolsPath)\\Microsoft.CSharp.targets\" /&gt;\n&lt;Import Project=\"DllExport\\RGiesecke.DllExport.targets\" /&gt;\n...\n</code></pre>\n\n<p>Here is the error:</p>\n\n<pre><code>------ Build started: Project: DelphiNET, Configuration: Release Any CPU ------\nc:\\WINDOWS\\Microsoft.NET\\Framework\\v3.5\\Csc.exe /noconfig /nowarn:1701,1702 /errorreport:prompt /warn:4 /define:TRACE /debug:pdbonly /filealign:512 /optimize+ /out:obj\\Release\\DelphiNET.dll /target:library Class1.cs DllExport\\DllExportAttribute.cs Properties\\AssemblyInfo.cs\n\nCompile complete -- 0 errors, 0 warnings\nDelphiNET -&gt; C:\\DelphiNET\\bin\\Release\\DelphiNET.dll\nILDasm: calling 'C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0A\\Bin\\ildasm.exe' with /quoteallnames /nobar \"/out:C:\\Documents and Settings\\Lukas\\Local Settings\\Temp\\tmp29F\\DelphiNET.il\" \"C:\\DelphiNET\\bin\\Release\\DelphiNET.dll\"\nC:\\DelphiNET\\bin\\Release\\DelphiNET.dll : warning EXP0009: Platform is AnyCpu, generating creating binaries for each CPU platform in a separate folder...\nILAsm: calling 'c:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\ILAsm.exe' with /nologo \"/out:C:\\DelphiNET\\bin\\Release\\x86\\DelphiNET.dll\" \"C:\\Documents and Settings\\Lukas\\Local Settings\\Temp\\tmp29F\\DelphiNET.x86.il\" /DLL \"/resource=C:\\Documents and Settings\\Lukas\\Local Settings\\Temp\\tmp29F\\DelphiNET.res\"  /optimize  \nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : \nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Assembling 'C:\\Documents and Settings\\Lukas\\Local Settings\\Temp\\tmp29F\\DelphiNET.x86.il'  to DLL --&gt; 'C:\\DelphiNET\\bin\\Release\\x86\\DelphiNET.dll'\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Source file is ANSI\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : \nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Assembled method RGiesecke.DllExport.DllExportAttribute::.ctor\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Assembled method RGiesecke.DllExport.DllExportAttribute::.ctor\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Assembled method RGiesecke.DllExport.DllExportAttribute::.ctor\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Assembled method RGiesecke.DllExport.DllExportAttribute::get_CallingConvention\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Assembled method RGiesecke.DllExport.DllExportAttribute::set_CallingConvention\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Assembled method RGiesecke.DllExport.DllExportAttribute::get_ExportName\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : Assembled method RGiesecke.DllExport.DllExportAttribute::set_ExportName\nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : \nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : ***** FAILURE ***** \nC:\\DelphiNET\\DllExport\\RGiesecke.DllExport.targets(8,5): error : \nDone building project \"DelphiNET.csproj\" -- FAILED.\n========== Build: 0 succeeded or up-to-date, 1 failed, 0 skipped ==========\n</code></pre>\n\n<p>OS: WinXPSP3,  Microsoft Visual C# 2008 Express Edition with SP1, .NET 3.5 SP1</p>\n\n<p>Any idea what's wrong? Thanks.</p>\n\n<hr>\n\n<p><strong>Edit 23:40:</strong></p>\n\n<p>I have found the bug. It is in the name of the function - <strong>add</strong> and <strong>Add</strong> are too same. When you change one of them, it works.</p>\n"},{"tags":["c#","delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":134,"score":-2,"question_id":13100793,"title":"What is the C# equivalent of Delphi's TList?","body":"<p>In Delphi I have a class and store instances of this class in a list, with this code:</p>\n\n<pre><code>type\n    TMyClass = class\n    public\n        name: String;\n        old: Integer;\n        anx: boolean;\n    end;\n</code></pre>\n\n<p>...</p>\n\n<pre><code>function x(aList: TList): String;\nvar\n    aObj: TMyClass;\n    i: Integer;\nbegin\n    for i:= 1 to aList.Count do\n    begin\n        aObj := aList[i-1];\n    end;\nend;\n</code></pre>\n\n<p>How can I do this in C#?</p>\n\n<p>How my class will receive a <code>TList</code>? And how do I write a <code>TList</code> equivalent in C#?</p>\n"},{"tags":["c#","delphi","delphi-7","safearray"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":13097395,"title":"How to get data from a multidimensional PSafeArray?","body":"<p>I need to read data from a <code>PSafeArray</code> in Delphi.<br>\nThat <code>PSafeArray</code> is returned by a method implemented in a DLL developed in C#. This method returns a two dimensional string array <code>string[,]</code>. How to read such <code>PSafeArray</code> result in Delphi ?</p>\n"},{"tags":["delphi","select","selection","tstringgrid"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1464,"score":3,"question_id":6024965,"title":"Detecting single vs multiple selections in Delphi TStringGrid","body":"<p>This is a follow up to my previous question  <a href=\"http://stackoverflow.com/questions/5950918\">Delphi TStringGrid multi select, determining selected rows</a> regarding Delphi String Grids.  It's a different question.</p>\n\n<p>I was looking more closely at the ONSelectCell Event\nTSelectCellEvent = procedure (Sender: TObject; ACol, ARow: Longint; var CanSelect: Boolean) of object;</p>\n\n<p>I noticed that the TStringGrid.Selection.Top,Bottom properties are not necessarily accurate (within the event itself).  Basically, if someone goes from selecting multiple rows to just one row, the selection.* properties do not get updated, whereas if one selects multiple rows, they do.  </p>\n\n<p>The ARow parameter does get updated regardless of whether one or more rows are selected, but this will only help me if I can determine that one and only one row was selected.  </p>\n\n<p>Eg, If it's just one row that was selected, then use Arow parameter, if more than one row then use Selection.* properties to determine which row(s) are currently selected.</p>\n\n<p>There must be an easier way.... </p>\n\n<p>Thank you!</p>\n"},{"tags":["sql-server","delphi","ado"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":126,"score":7,"question_id":13074765,"title":"TADOQuery Join tables - Insert \\ Delete records from result","body":"<p>Using a single <code>TADOQuery</code> i pull records from two different tables using a left outer join:  </p>\n\n<pre><code>Select M*, D.* from Courier M Left outer join Courier_VT D on M.Courier_Identifier = D.FK_Courier_Identifier\n</code></pre>\n\n<p>I use a <code>TDBGrid</code> to successfully post field updates to my MSSQL DB.</p>\n\n<p>Since there is foreign key reference (<code>FK_Courier_Identifier</code> with <code>Courier_Identifier</code>) I get a error when I insert a record, </p>\n\n<blockquote>\n  <p>Cannot Insert the value Null in to column 'FK_Courier_Identifier', table Courier_VT; column does not allow null</p>\n</blockquote>\n\n<p>but a record is posted in Courier table, i do know that i need to assign the <code>Courier_Identifier</code> to <code>FK_Courier_Identifier</code> before posting but don't how and where to do it</p>\n\n<p>How do we Insert \\ Delete records in this scenario ? Is it possible to achieve using a single <code>TADOQuery</code> ? </p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":13096120,"title":"Enum Const Record Fields","body":"<p>I got some problems with RTTi .. i wana to enumerate all constans values in Record type</p>\n\n<pre><code> type TMyRecord = record\n  const\n    value1: Integer=10;\n    value2: Integer=13;\n    value3: Integer=18;\n    value4: Integer=22;\n end;\nprocedure TForm3.Button1Click(Sender: TObject);\nvar\n ctx:TRttiContext ;\n Field:rtti.TRttiField       ;\nbegin\n for Field in ctx.GetType(TypeInfo(TMyRecord)).GetFields     do\n ListBox1.Items.Add(Field.Name  );  // i got nothing\nend;\n</code></pre>\n\n<p>but when my Record is not a const , my code work fine</p>\n\n<pre><code> type TMyRecord = record\n   value1: Integer;\n   value2: Integer;\n   value3: Integer;\n   value4: Integer;\n  end;\nprocedure TForm3.Button1Click(Sender: TObject);\nvar\n ctx:TRttiContext ;\n Field:rtti.TRttiField       ;\nbegin\n for Field in ctx.GetType(TypeInfo(TMyRecord)).GetFields     do\n ListBox1.Items.Add(Field.Name  );  //its work\nend;\n</code></pre>\n"},{"tags":["delphi","logging"],"answer_count":6,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":1971,"score":11,"question_id":1186976,"title":"Good, free Delphi logging framework","body":"<p>can anybody hint me a good, free Delphi logging framework? It should be easy to use and it should support different \"log writers\" including plain text, database and network.</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":815,"score":4,"question_id":4414870,"title":"How to put CR/LF into a TStringgrid cell?","body":"<p>I want to have one fixed row as a header, but the texts are rather long, so I'd like to increase the row height and insert CR/LF into the cell text.</p>\n\n<p>Googling shows this as a solution (and it's the first thing I thought fo before googling), but it down't see to work.  Any ideas?</p>\n\n<pre><code>Grid.Cells[2,3] := 'This is a sample test' + #13#10 + 'This is the second line';\n</code></pre>\n\n<p>What happens is that the cell contains <code>This is a sample testThis is the second line</code></p>\n\n<p>(Delphi 7 if it makes any difference)</p>\n\n<p>[Bounty] \"My bad. I actually awarded this an answer two years ago without checking and now find that the answer did not work. Aplogies to anyone who was misled. This is a FABOWAQ (frequently asked, often wrongly answered question). GINYF\".</p>\n\n<p>I presume that we are looking to use OnDrawCell, but imagine that we would also have to increase the height of the string grid row which contains the cell.</p>\n\n<p>I will award the answer for either code or a FOSS VCL component.</p>\n\n<p>[Update] must work with Delphi XE2 Starter edition</p>\n"},{"tags":["delphi","delphi-2007"],"answer_count":5,"favorite_count":3,"up_vote_count":5,"down_vote_count":1,"view_count":243,"score":4,"question_id":13087713,"title":"Is there a way to instantiate a desired number of objects in Delphi, without iterating?","body":"<p>I think that C++ supports something on the lines of :</p>\n\n<pre><code>Object objects[100];\n</code></pre>\n\n<p>This would instantiate a 100 objects, right? Is it possible to do this in Delphi (specifically 2007)? Something other than:</p>\n\n<pre><code>for i:=0 to 99 do\n  currentObject = TObject.Create;\n</code></pre>\n\n<p>or using the <code>Allocate</code> function, with a passed size value a hundred times the <code>TObject</code> size, because that just allocates memory, it doesn't actually divide the memory and 'give' it to the objects.\nIf my assumption that the c++ instantiation is instant rather than under-the-hood-iterative, I apologize. </p>\n"},{"tags":["regex","delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":99,"score":5,"question_id":12966334,"title":"How to skip quoted text in regex (or How to use HyperStr ParseWord with Unicode text ?)","body":"<p>I need regex help to create a delphi function to replace the HyperString ParseWord function in Rad Studio XE2. HyperString was a very useful string library that never made the jump to Unicode. I've got it mostly working but it doesn't honor quote delimiters at all. I need it to be an exact match for the function described below:</p>\n\n<blockquote>\n  <p>function ParseWord(const Source,Table:String;var Index:Integer):String;</p>\n  \n  <p>Sequential, left to right token parsing using a table of single\n  character delimiters.  Delimiters within quoted strings are ignored.\n  Quote delimiters are not allowed in Table.</p>\n  \n  <p>Index is a pointer (initialize to '1' for first word) updated by the\n  function to point to next word.  To retrieve the next word, simply\n  call the function again using the prior returned Index value.</p>\n  \n  <p>Note: If Length(Resultant) = 0, no additional words are available. \n  <strong>Delimiters within quoted strings are ignored</strong>. (my emphasis)</p>\n</blockquote>\n\n<p>This is what I have so far:</p>\n\n<pre><code>function ParseWord( const Source, Table: String; var Index: Integer):string;\nvar\n  RE : TRegEx;\n  match : TMatch;\n  Table2,\n  chars : string;\nbegin\n  if index = length(Source) then\n  begin\n    result:= '';\n    exit;\n  end;\n\n  // escape the special characters and wrap in a Group\n  Table2 :='['+TRegEx.Escape(Table, false)+']';\n  RE := TRegEx.create(Table2);\n  match := RE.Match(Source,Index);\n  if match.success then\n  begin\n    result := copy( Source, Index, match.Index - Index);\n    Index := match.Index+match.Length;\n  end\n  else\n  begin\n    result := copy(Source, Index, length(Source)-Index+1);\n    Index := length(Source);\n  end;\nend;\n\n  while ( Length(result)= 0) and (Index&lt;length(Source)) do\n  begin\n    Inc(Index);\n    result := ParseWord(Source,Table, Index);\n  end;\n</code></pre>\n\n<p>cheers and thanks.</p>\n"},{"tags":["delphi","dfm"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":901,"score":0,"question_id":4345261,"title":"Delphi 7 RLINK32 Error reading dfm file - failed read","body":"<p>I just run into a problem that came out of nowhere...\nA DFM file gets read just fine from Delphi when project is built, but when I build it from command line (dcc32) I get error <code>Error: RLINK32: Error reading file \"update.dfm\" Failed read</code></p>\n\n<p>What is more stranger another project containing same file builds with no error from both Delphi and dcc. </p>\n\n<p>Does anyone have a clue of what could cause something like this?</p>\n\n<p>I tried to build from another location, still same.</p>\n\n<p>Operating system is Windows Server 2008. Permissions seems correct.</p>\n"},{"tags":["c#","c++","delphi","winapi","windows-7"],"answer_count":1,"favorite_count":6,"up_vote_count":11,"down_vote_count":0,"view_count":160,"score":11,"question_id":12849341,"title":"How can I create a menu in the start menu for my program?","body":"<p>This may be an easy question but I am not even sure of the terminology to search, so I have to ask. I want my program to have a menu when it is hovered over if it is pinned to the start menu. I am attaching a screenshot where windows powershell illustrates this function, and presents a list of tasks.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/h0gU2.png\" alt=\"enter image description here\"></p>\n\n<p>Other programs sometimes use this to list recently opened files, etc. I am sure this is standard enough that there is a tutorial on it somewhere, would someone mind pointing me to it, or explaining how to do this? I hope that it doesn't matter too much what language is used, but I am proficient in Delphi, C++, and C#.</p>\n"},{"tags":["delphi","winapi","system32"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":152,"score":1,"question_id":12849939,"title":"Can not get msconfig .exe to run in the system32 folder shellexecute Delphi","body":"<p>Im on Win 7  64b.\nIm trying to run msconfig from my delphi app.\nThe msconfig.exe file is in the system32 folder .\nI copied the msconfig.exe to the c:\\ and it works great.\nThis looks like some kind of permission issue.</p>\n\n<pre><code>var\nerrorcode: integer;\n begin\n   errorcode :=\nShellExecute(0, 'open', pchar('C:\\Windows\\System\\msconfig.exe'), nil, nil, SW_NORMAL);\nif errorcode &lt;= 32 then\nShowMessage(SysErrorMessage(errorcode));\nend;\n</code></pre>\n\n<p>Has anyone seen this and figured out how to run the msconfig.exe from the sys32 .</p>\n"},{"tags":["delphi","ide","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":13045976,"title":"RAD Studio XE2 deletes OnClick set in dfm when opening project","body":"<p>We have an application that can be run in Simple or Advanced mode. The difference is what main menu entries are visible. The problem is that RAD Studio XE2 silently deletes the OnClick property value set in the dfm. It points to a procedure hiding some menu items in the Main Menu > File menu.</p>\n\n<p>Steps:<br>\n1. A fresh checkout from subversion to a new folder on disk, one that never existed before.<br>\n2. Opening the main form's dfm and pas files in notepad++ to ensure that the \"OnClick = MenuItem_File1Click\" row is there and that procedure MenuItem_File1Click is in interface and implementation of pas file. Yes, everything looks good.<br>\n3. Open project in RAD Studio XE2.<br>\n4. OnClick property of File menu item in Object Inspector is blank.</p>\n\n<p>We have some other menu items that were handled in FormShow and they work as expected, hidden in Simple mode and visible in Advanced. The workaround was to move the functionality inside the MenuItem_File1Click to FormShow. But I really want to understand why it happened in the first place.</p>\n\n<p>Can anyone explain this behaviour? Has anyone else come across something like this? I tried renaming the procedure to something definitiely not system-like but the IDE removed it anyway.</p>\n"},{"tags":["php","delphi","post","delphi-7","winsock"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":121,"score":3,"question_id":13092908,"title":"Delphi code works in console but not VLC","body":"<p>I made my OWN unit to get a POST request from a webserver using winsocket.</p>\n\n<p>Here is my unit:</p>\n\n<pre><code>unit uGetPost;\n\ninterface\n\nuses\nWinsock,\nSysUtils,\nWindows;\n\nfunction GetPost(CompleteURL, PostData : String; var Results : String ; Port: Integer = 80) : Integer;\n\nimplementation\n\nprocedure RemoveCRLFFromEndAndBeginning (var s : String);\nvar\n i : Integer;\nbegin\n  i := Length(s);\n  while (s[i] = #10) or (s[i] = #13) do begin\n    SetLength (s, i - 1);\n    dec (i);  \n  end;\n  i := 1;\n  while (s[i] = #10) or (s[i] = #13) do begin\n    s := Copy (s, 2, Length(s));\n    inc (i);  \n  end;\nend;\n\nfunction GetIpFromDns(HostName: string): string;\ntype\n  tAddr = array[0..100] of PInAddr;\n  pAddr = ^tAddr;\nvar\n  I: Integer;\n  WSA: TWSAData;\n  PHE: PHostEnt;\n  P: pAddr;\nbegin\n  Result := HostName;\n  WSAStartUp($101, WSA);\n  try\n    PHE := GetHostByName(pChar(HostName));\n    if (PHE &lt;&gt; nil) then\n    begin\n      P := pAddr(PHE^.h_addr_list);\n      I := 0;\n      while (P^[i] &lt;&gt; nil) do\n      begin\n        Result := (inet_nToa(P^[i]^));\n        Inc(I);\n      end;\n    end;\n  except\n  end;\n  WSACleanUp;\nend;\n\nfunction Parsing(Char, Str: string; Count: Integer): string;\nvar\n  i                 : Integer;\n  strResult         : string;\nbegin\n  if Str[Length(Str)] &lt;&gt; Char then\n    Str := Str + Char;\n  for i := 1 to Count do\n  begin\n    strResult := Copy(Str, 0, Pos(Char, Str) - 1);\n    Str := Copy(Str, Pos(Char, Str) + 1, Length(Str));\n  end;\n  Result := strResult;\nend;\n\n\nfunction GetPost(CompleteURL, PostData : String; var Results : String ; Port: Integer = 80) : Integer;\n// 1 = Complete Success\n// 2 = No Content (Length found) or wrong GET/POST\n// 3 = Host found but no php file\n// 4 = Host not found (Total FAIL!);\nvar\n  WSA: TWSAData;\n  Sock: TSocket;\n  Addr: TSockAddrIn;\n  SendBuffer: String;\n  ReceiveBuffer: array[0..4096] of Char;\n  ReceivedBytes: Integer;\n  DNS, RemoteFilePath, FileName: string;\n  i: integer;\n  SentBytes: Integer;\n  ContentLength : Integer;\nbegin\n  result := 4;\n  DNS := Copy(CompleteURL, Pos('http://', CompleteURL) + 7, Length(CompleteURL));\n  RemoteFilePath := Copy(DNS, Pos('/', DNS), Length(DNS));\n  DNS := Copy(DNS, 1, Pos('/', DNS) - 1);\n  i := Length(RemoteFilePath);\n  while (RemoteFilePath[i] &lt;&gt; '/') do\n  begin\n    FileName := RemoteFilePath[i] + FileName;\n    Dec(i);\n  end;  \n  WSAStartup($101, WSA);\n  Sock := Socket(AF_INET, SOCK_STREAM, 0);\n  Addr.sin_family := AF_INET;\n  if (Port &lt; 1) or (Port &gt; 65535) then Port := 80;\n  Addr.sin_port := htons(Port);\n  Addr.sin_addr.S_addr := inet_addr(PChar(GetIPfromDNS(PChar(DNS))));\n  if Connect(Sock, Addr, sizeof(Addr)) = 0 then begin\n    result := 3;\n    SendBuffer := 'POST ' + RemoteFilePath + ' HTTP/1.1' + #13#10 +\n    'Host: ' + DNS + #13#10 +\n    'User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:16.0) Gecko/20100101 Firefox/16.0' + #13#10 +\n    'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' + #13#10 +\n    'Accept-Language: en-US,en;q=0.5' + #13#10 +\n    'Accept-Encoding: gzip, deflate' + #13#10 +\n    'Connection: close' + #13#10 +\n    'Cache-Control: max-age=0' + #13#10 +\n    'Content-Type: application/x-www-form-urlencoded' + #13#10 +\n    'Content-Length: ' + inttostr(Length(PostData)) + #13#10#13#10 +\n    PostData;\n    repeat\n      SentBytes := Send(Sock, SendBuffer[1 + SentBytes], Length(SendBuffer) - SentBytes, 0);\n    until SentBytes &gt;= Length(SendBuffer);\n    repeat\n      ZeroMemory(@ReceiveBuffer, Sizeof(ReceiveBuffer));\n      ReceivedBytes := Recv(Sock, ReceiveBuffer, Sizeof(ReceiveBuffer), 0);\n      if ReceivedBytes &gt; 0 then begin\n        Results := Results + ReceiveBuffer;\n      end;\n    until (ReceivedBytes &lt;= 0);\n    CloseSocket(Sock);\n  end;\n  WSACleanup();\n  if Copy (Results, 10, 6) = '200 OK' then begin\n    result := 2;\n    if Pos ('Content-Length: ', Results) &lt;&gt; 0 then begin\n      i := 1;\n      while Parsing(#13, Results, i) &lt;&gt; '' do begin\n        if Pos ('Content-Length: ' , Parsing(#13, Results, i)) &lt;&gt; 0 then begin\n          ContentLength := strtoint (Copy(Parsing(#13, Results, i), 18, Length (Results)));\n          results := Copy (results,Length(results) - ContentLength + 1, ContentLength);\n          break;\n        end;\n        inc (i);\n      end;\n      if ContentLength &lt;&gt; 0 then begin\n        result := 1;\n        RemoveCRLFFromEndandBeginning (results);\n      end else begin\n        results := '';\n      end;\n    end;\n  end;\nend;\n\n\nend.\n</code></pre>\n\n<p>I run the function GetPost in an VCL application like this:</p>\n\n<pre><code>var\n Res : String;\nbegin\n GetPost ('http://guest1320958.studio2.coderun.com/PHPTest/', 'GET=VERSION', Res);\n ShowMessage (Res);\nend;\n</code></pre>\n\n<p>The results are the followed:</p>\n\n<blockquote>\n  <p>HTTP/1.1 400 Bad Request Content-Type: text/html Date: Fri, 26 Oct\n  2012 18:56:03 GMT Connection: close Content-Length: 35</p>\n  \n  <h1>Bad Request (Invalid Verb)</h1>\n</blockquote>\n\n<p>If i run the the SAME function in an console application like this:</p>\n\n<pre><code>program Project2;\n\n{$APPTYPE CONSOLE}\n\nuses\n  uGetPost;\n\n  var\n   Res : String;\n\nbegin\n  GetPost ('http://guest1320958.studio2.coderun.com/PHPTest/', 'GET=VERSION', Res);\n  writeln (Res);\n  readln;\nend.\n</code></pre>\n\n<p>It works just fine.</p>\n\n<p>My PHP code is this:</p>\n\n<pre><code>&lt;?php\nif (isset($_POST[\"GET\"]))  {\n$funcName = $_POST[\"GET\"];\nswitch($funcName) {\ncase \"VERSION\":\necho \"1.0\";\nbreak;\ncase \"SOMETHINGELSE\":\necho \"...\";\nbreak;\ncase \"ANDSOSON\":\necho \"...\";\n}\n}\n?&gt;\n</code></pre>\n\n<p>I use <a href=\"http://www.coderun.com\" rel=\"nofollow\">www.coderun.com</a> to test my php. </p>\n\n<p>Why does it NOT work in VLC?\nBTW.: If you run the function GetPost in a Thread in VCL like this:</p>\n\n<pre><code>function MyThread ( p : pointer ) : Integer;stdcall;\nvar\n Res : String;\nbegin\n GetPost ('http://guest1320958.studio2.coderun.com/PHPTest/', 'GET=VERSION', Res);\n MessageBoxA (0, pchar(Res), '', 0);\nend;\n\nprocedure StartGetPost;\nvar\n Dummy : DWORD;\nbegin\n CreateThread(NIL,0, @MyThread, NIL,0, Dummy);\nend; \n</code></pre>\n\n<p>... it works all of a sudden...</p>\n\n<p>Why is that? Can please someone help me? Thank you.  </p>\n\n<p>EDIT:\nHere are the results from wireshark:\n<a href=\"http://dl.dropbox.com/u/349314/transfer.pcapng\" rel=\"nofollow\">http://dl.dropbox.com/u/349314/transfer.pcapng</a></p>\n\n<p>EDIT:\nIt looks like that something is wrong with the actual Transmission Header :/</p>\n"},{"tags":["delphi","delphi-7","menuitem"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":172,"score":7,"question_id":10617644,"title":"Creating and Freeing a TMenuItem used by a TPopupMenu","body":"<p>When creating a TMenuItem runtime as shown below:</p>\n\n<p><code>mi := TMenuItem.Create([owner]);</code></p>\n\n<p>and adding to a TPopupMenu like so:</p>\n\n<p><code>PopupMenu1.Items.Add(mi);</code></p>\n\n<p>Do I need to specify the <code>[owner]</code> as PopupMenu1 or can I use <code>nil</code>?</p>\n\n<p>Will <code>mi</code> be free by PopupMenu1 in that case, and if so how can I verify it?</p>\n"},{"tags":["delphi","freepascal"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":13080956,"title":"Can I cross-compile (without linking) with Free Pascal for other platforms?","body":"<p>I have seen that it is possible but not easy to configure cross-compiling with Free Pascal, as there have to be libraries of the target OS on the system.</p>\n\n<p>But I only need a quick syntax-check to verify that the project can be compiled, linking an executable is not required.</p>\n\n<p>So: are there compiler options which I can use to do a <strong>cross-platform test compile</strong> (only) with Free Pascal? </p>\n\n<p>In my case, before checking in the project in source control, I would like to verify on a Windows workstation if the compiler can compile for a Linux or OSX target.</p>\n"},{"tags":["delphi","unit-testing","mocking"],"answer_count":5,"favorite_count":20,"up_vote_count":32,"down_vote_count":0,"view_count":2549,"score":32,"question_id":293755,"title":"What is your favorite Delphi mocking library?","body":"<p>I want to start using mock objects on my Delphi projects.</p>\n\n<p>After a quick google I've found those:</p>\n\n<ul>\n<li><a href=\"http://code.google.com/p/delphi-mock-wizard/\" rel=\"nofollow\">Delphi Mock Wizard</a> </li>\n<li><a href=\"http://sourceforge.net/projects/pascalmock/\" rel=\"nofollow\">PascalMock</a></li>\n</ul>\n\n<p>So my question is what one is your favourite and why?</p>\n"},{"tags":["multithreading","delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":119,"score":2,"question_id":13085188,"title":"Access violation at tcriticalsection.create","body":"<p>I am programming a multi-threaded chat server application. Thus critical section are very necessary. I just made a wrapper class for threaded tree view. It works perfectly in the client but the server raises an AV.</p>\n\n<p>There are two forms, FormServer (which practically does almost no processing except for gui painting) and the DataModuleServer which does all the heavy lifting.</p>\n\n<p>The FormServer gets created first.</p>\n\n<p>Actually the threaded tree view is inside another wrapper class TRoomTree.</p>\n\n<p><strong>TDataModuleServer.Create</strong></p>\n\n<pre><code>procedure TDataModuleServer.cr(Sender: TObject);\nbegin\n  Rooms := TRoomTree.Create (FormServer.tvRooms);\n</code></pre>\n\n<p>tvRooms : the visual treeview</p>\n\n<p><strong>TRoomTree.Create</strong></p>\n\n<pre><code>constructor TRoomTree.Create (TV : TTreeView);\nbegin\n\n  if Assigned (TV) then\n    fTreeView.Create (TV)\n  else\n    exit;\n</code></pre>\n\n<p>fTreeView : the threaded tree view;</p>\n\n<p><strong>TThreadTreeView.Create</strong></p>\n\n<pre><code>constructor TThreadTreeView.Create (TreeView : TTreeView = nil);\nbegin\n\n  fLock := TCriticalSection.Create;\n\n  if Assigned (TreeView) then\n    fTreeView := TreeView\n  else\n    fTreeView := TTreeView.Create (nil);\n\nend;\n</code></pre>\n\n<p>fTreeView : the normal tree view;</p>\n\n<p>Now the TCriticalSection.Create raises an AV exception in ntdll.dll.</p>\n\n<p><strong>Call Stack</strong></p>\n\n<pre><code>:76cac41f KERNELBASE.RaiseException + 0x58\n:0040469c NotifyNonDelphiException + $1C\n:77ecb42b ; ntdll.dll\nuThreadTreeView.TThreadTreeView.Create($26B4300) \nuRoomTree.TRoomTree.Create($26B4300)\nuServer.TDataModuleServer.cr($26A48B0)\nClasses.TDataModule.DoCreate\nClasses.TDataModule.AfterConstruction\nSystem.@AfterConstruction($26A48B0)\nClasses.TDataModule.Create(???)\nForms.TApplication.CreateForm(???,(no value))\nPlayburnServer.PlayburnServer\n:773833aa kernel32.BaseThreadInitThunk + 0x12\n:77ea9ef2 ntdll.RtlInitializeExceptionChain + 0x63\n:77ea9ec5 ntdll.RtlInitializeExceptionChain + 0x36\n</code></pre>\n\n<p>Any help will be greatly appreciated.</p>\n"},{"tags":["delphi","checkbox","mouseevent","delphi-xe2","tstringgrid"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":451,"score":3,"question_id":11719454,"title":"Why don't child controls of a TStringGrid work properly?","body":"<p>I am placing checkboxes (<code>TCheckBox</code>) in a string grid (<code>TStringGrid</code>) in the first column. The checkboxes show fine, positioned correctly, and respond to mouse by glowing when hovering over them. When I click them, however, they do not toggle. They react to the click, and highlight, but finally, the actual <code>Checked</code> property does not change. What makes it more puzzling is I don't have any code changing these values once they're there, nor do I even have an <code>OnClick</code> event assigned to these checkboxes. Also, I'm defaulting these checkboxes to be <em>unchecked</em>, but when displayed, they are <em>checked</em>.</p>\n\n<p>The checkboxes are created along with each record which is added to the list, and is referenced inside a record pointer which is assigned to the object in the cell where the checkbox is to be placed.</p>\n\n<p>String grid hack for cell highlighting:</p>\n\n<pre><code>type\n  THackStringGrid = class(TStringGrid); //used later...\n</code></pre>\n\n<p>Record containing checkbox:</p>\n\n<pre><code>  PImageLink = ^TImageLink;\n  TImageLink = record\n    ...other stuff...\n    Checkbox: TCheckbox;\n    ShowCheckbox: Bool;\n  end;\n</code></pre>\n\n<p>Creation/Destruction of checkbox:</p>\n\n<pre><code>function NewImageLink(const AFilename: String): PImageLink;\nbegin\n  Result:= New(PImageLink);\n  ...other stuff...\n  Result.Checkbox:= TCheckbox.Create(nil);\n  Result.Checkbox.Caption:= '';\nend;\n\nprocedure DestroyImageLink(AImageLink: PImageLink);\nbegin\n  AImageLink.Checkbox.Free;\n  Dispose(AImageLink);\nend;\n</code></pre>\n\n<p>Adding rows to grid:</p>\n\n<pre><code>//...after clearing grid...\n//L = TStringList of original filenames\nif L.Count &gt; 0 then\n  lstFiles.RowCount:= L.Count + 1\nelse\n  lstFiles.RowCount:= 2; //in case there are no records\nfor X := 0 to L.Count - 1 do begin\n  S:= L[X];\n  Link:= NewImageLink(S); //also creates checkbox\n  Link.Checkbox.Parent:= lstFiles;\n  Link.Checkbox.Visible:= Link.ShowCheckbox;\n  Link.Checkbox.Checked:= False;\n  Link.Checkbox.BringToFront;\n  lstFiles.Objects[0,X+1]:= Pointer(Link);\n  lstFiles.Cells[1, X+1]:= S;\nend;\n</code></pre>\n\n<p>Grid's OnDrawCell Event Handler:</p>\n\n<pre><code>procedure TfrmMain.lstFilesDrawCell(Sender: TObject; ACol, ARow: Integer;\n  Rect: TRect; State: TGridDrawState);\nvar\n  Link: PImageLink;\n  CR: TRect;\nbegin\n  if (ARow &gt; 0) and (ACol = 0) then begin\n    Link:= PImageLink(lstFiles.Objects[0,ARow]); //Get record pointer\n    CR:= lstFiles.CellRect(0, ARow); //Get cell rect\n    Link.Checkbox.Width:= Link.Checkbox.Height;\n    Link.Checkbox.Left:= CR.Left + (CR.Width div 2) - (Link.Checkbox.Width div 2);\n    Link.Checkbox.Top:= CR.Top;\n    if not Link.Checkbox.Visible then begin\n      lstFiles.Canvas.Brush.Color:= lstFiles.Color;\n      lstFiles.Canvas.Brush.Style:= bsSolid;\n      lstFiles.Canvas.Pen.Style:= psClear;\n      lstFiles.Canvas.FillRect(CR);\n      if lstFiles.Row = ARow then\n        THackStringGrid(lstFiles).DrawCellHighlight(CR, State, ACol, ARow);\n    end;\n  end;\nend;\n</code></pre>\n\n<p>Here's how it looks when clicking...</p>\n\n<p><img src=\"http://i.stack.imgur.com/zMgyk.png\" alt=\"Reacts to Mouse Click but Doesn't Change\"></p>\n\n<p>What could be causing this? It's definitely not changing the <code>Checked</code> property anywhere in my code. There's some strange behavior coming from the checkboxes themselves when placed in a grid.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I did a brief test, I placed a regular <code>TCheckBox</code> on the form. Check/unchecks fine. Then, in my form's <code>OnShow</code> event, I changed the Checkbox's <code>Parent</code> to this grid. This time, I get the same behavior, not toggling when clicked. Therefore, it seems that a <code>TCheckBox</code> doesn't react properly when it has another control as its parent. How to overcome this?</p>\n"},{"tags":["delphi","tcombobox"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":13080209,"title":"Why doesn't my combo box's OnChange event fire when its parent is a TStringGrid?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11719454/why-dont-child-controls-of-a-tstringgrid-work-properly\">Why don’t child controls of a TStringGrid work properly?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a TStringGrid of variable length, and one column has a TComboBox to alter the data inside. I have made its parent the TStringGrid so that if it is scrolled down I can use the position of the selected rectangle inside the StringGrid.</p>\n\n<p>The problem has arisen because I need to fire an OnChange event: The issue is that when its parent is StringGrid, the only way to fire the OnChange event seems to be using the keyboard events, and selecting its items will not fire the event. I have also tried to redeclare the OnChange event after changing the parent and the OnClick event (which doesn't fire whatsoever).</p>\n\n<p>I'm not really sure why this is occurring but it defintely seems to be a problem with the parent being a TStringGrid.</p>\n"},{"tags":["delphi","firemonkey","ellipsis","delphi-xe3"],"answer_count":1,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":13071591,"title":"Shorten a label in Firemonkey with ellipsis","body":"<p>Is there an ellipsis / ellipsify routine for shortening button or label text in Firemonkey?\neg, to turn:</p>\n\n<p><strong>\"C:\\a really\\really\\really long\\very long path\\even longer path name\"</strong>\ninto\n<strong>\"C:\\a really\\re...\"</strong>\nor\n<strong>\"C:\\a really\\re...path name\"</strong></p>\n\n<p>There are routines around for VCL but it looks like finding Firemonkey's text size will be more involved.</p>\n\n<p>I am using Firemonkey 2 on Delphi XE3</p>\n\n<p>Thanks in advance</p>\n\n<p>... Ok I've created a clunky procedure from Mike Sutton's advice.\nIt only adds the ellipsis at the end of the 1st part of the string but could be modified quite easily for middle or end ellipsis positions. It also takes into account the current objects Font size and style.</p>\n\n<p>Usage would be:</p>\n\n<pre><code>ShortenText(Button1, 'Start of text blah blah blah blah the END is here');\n\nprocedure ShortenText(anFMXObject: TTextControl; newText: string);\nvar\n  aTextObj: TText;\n  shortenTo: integer;\n  modText: string;\nbegin\n  if Length(newText) &gt; 2 then\n  begin\n    modText:= newText+'...';\n    aTextObj:=TText.Create(anFMXObject.Parent);\n    aTextObj.Font.SetSettings(anFMXObject.Font.Family,\n                          anFMXObject.Font.Size,\n                          anFMXObject.Font.Style);\n    aTextObj.WordWrap:= false;\n    aTextObj.AutoSize:= true;\n    aTextObj.Text:= newText;\n    // this next bit generates the change necessary to redraw the new text (bug in XE3 as of Oct 2012)\n    aTextObj.HorzTextAlign:= TTextAlign.taCenter;\n    aTextObj.HorzTextAlign:= TTextAlign.taLeading;\n    // now shorten the text:\n    shortenTo:= round((Length(modText)/aTextObj.Width)*anFMXObject.Width)-1;\n    modText:= LeftStr(modText, shortenTo-3)+'...';\n    anFMXObject.Text:= modText;\n    FreeAndNil(aTextObj);\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi","intraweb"],"answer_count":5,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1981,"score":2,"question_id":5669559,"title":"Alternatives for IntraWeb in Delphi?","body":"<p>Are there any alternatives for IntraWeb for Delphi,<br>\nif I want to write a simple but meaningful webserver in Delphi?</p>\n"},{"tags":["java","delphi","encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":93,"score":3,"question_id":13085698,"title":"Write Java String to file with special encoding","body":"<p>I have got the Java String <code>ôð¤ Ø$î1&lt;¨ V¸dPžÐ ÀH@ˆàÀà¼€@</code>~€4` which I would like to write to a file with ANSI encoding. </p>\n\n<pre><code>BufferedWriter out = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(output),\"windows-1252\"));\n    try {   \n        out.append(str);\n    } finally {\n        out.close();\n    }\n</code></pre>\n\n<p>Debugger says that <code>str</code> contains <code>ôð¤ Ø$î1&lt;¨ V¸dPÐ ÀH@àÀà¼@</code>~4. As soon as I write it to the output file, the file only contains <code>?ÒÜ@4</code>. So whats wrong with my method writing to the File?</p>\n\n<p>Sorry for this weird strings - I am trying to rewrite a delphi 7 function in java. These strings are the only samples I have got.</p>\n"},{"tags":["delphi","delphi-xe2","datasnap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13066278,"title":"DataSnap Rest Server windows Service","body":"<p>i'm try to building a DataSnap Rest Application running as a windows service, but the wizard just have \"Stand-alone VCL application\", \"Stand-alone console application\" and \"ISAPI dynamic link library\"(i'm using Delphi XE2 enterprise). Someone can help me. Thanks.</p>\n"},{"tags":["delphi","remote-access","vnc"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":187,"score":0,"question_id":13035453,"title":"Remote desktop control component (like vnc)","body":"<p>I want to embed a remote control feature to support users of my application.</p>\n\n<p>Currently, I'm using the VNC but I would like to find another solution like a component or VNC delphi implementation.</p>\n\n<p><strong>Now looking for a free or opensource solution.</strong></p>\n"},{"tags":["delphi","delphi-xe2","intraweb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":237,"score":0,"question_id":10510824,"title":"Delphi XE2, Intraweb 2.1.23 and cookies","body":"<p>i did everything exactly the same as in the cookies example (shown here <a href=\"http://www.atozed.com/intraweb/docs/Develop/Cookies.aspx\" rel=\"nofollow\">http://www.atozed.com/intraweb/docs/Develop/Cookies.aspx</a>), but it's not compiling and it says \"[DCC Error] Login.pas(38): E2035 Not enough actual parameters\" and places the courser right after the \"WebApplication.Response.Cooki­es.Add\"</p>\n\n<p>what am i missing?\nis there a unit i need to add to the uses?</p>\n\n<p>i use Delphi XE2, and Intraweb 2.1.23\noh, and i'm new to intraweb...</p>\n\n<p>please help\nthank you</p>\n"},{"tags":["delphi","button","twebbrowser"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":13066692,"title":"Pressing Buttons on a web page via Delphi","body":"<p>Ex1: <a href=\"http://stackoverflow.com/questions/10593494/programmaticaly-click-on-a-link-in-webbrowser-using-dom-delphi-7\">WebBrowser.OleObject.Document.GetElementByID('ID HERE').Click;</a></p>\n\n<p>Ex2: <a href=\"http://stackoverflow.com/questions/3651054/how-to-find-a-button-with-value-in-html-page-webbrowser-delphi\">&lt; input type=\"submit\" VALUE=\"Login\" ></a></p>\n\n<p>The above two examples are for pressing buttons on web pages via Delphi. Ex2 works well on various web sites but not all. Is this because Ex2 only works on HTML buttons? I tried Ex1 but some code is missing, when I try it, I get a message saying 'Object or class type required'. Also Ex1 has no example code, can anyone fill me in on why I get this message and put some code up for Ex1 please.</p>\n"},{"tags":["delphi","winapi"],"answer_count":2,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":173,"score":7,"question_id":11647762,"title":"Align a TPopupMenu to the right hand side of the form?","body":"<p>How can a TPopupMenu be aligned to the right hand side of a form? The problem is that there doesn't seem to be a way to get the width of the Popup menu before you call <code>Popup(X, Y: Integer)</code>.</p>\n\n<p>I'm trying to get a behavior similar to that of the system menu in Chrome.</p>\n\n<p><img src=\"http://i.stack.imgur.com/ogWML.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c++","delphi","dll"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":93,"score":0,"question_id":13082933,"title":"exporting C++ dll to Delphi program","body":"<p>I have a dll with exporting function </p>\n\n<pre><code>extern \"C\" __declspec(dllexport) IDriver * __stdcall GetDriver() \n</code></pre>\n\n<p>There is a programm which is written on Delphi. It can't see the function GetDriver(). \nIt's double awful because I can not get and modify sources of this program.</p>\n\n<p>What may be the reason of successful loading my dll (according log file) and failed call exporting function? Thank you.</p>\n\n<p>Window 7 x64, Visual Studio 2010, C++ project for x86 target </p>\n"},{"tags":["delphi","debugging","windows-7","uac"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":101,"score":-1,"question_id":13065857,"title":"Cannot debug Delphi process because of UAC","body":"<p>I found interesting problem with Win7/X64 machine.</p>\n\n<p>For this time I haven't got problem with Delphi 6 and UAC.\nThe exes are working in their's place, so I can use Delphi debugger with them.</p>\n\n<p>But today I got error on run the project: \"Unable to create process. For this operation you need higher user level\".</p>\n\n<p>How can I prevent this side-effect?\nWhat causes this?\nI don't understand why the older projects are running fine, but this new isn't...</p>\n\n<p>Thanks for every idea, link, information!</p>\n\n<hr>\n\n<p>Additional info:\nNormally I using the Delphi 6 IDE with normal starting (without SysAdmin rigths).\nSo it is never asking me with \"really?\" kind UAC questions.\nAnd every of the older projects are usable with Delphi 6 - I can build, run, debug everything.\nThis problem happened with only this project, so I try to find the differences if possible to solve the problem.\nI using normal directory (\"c:\\dev\\anyproject\"), others are using \"c:\\dev\\otherproject1..2..n\").</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":13051334,"title":"How to create TDictionary containing weak references to interfaces in delphi","body":"<p>I want to create an Tinterfacedobject that contains (ao) two properties ObjectLinks and ObjectBacklinks. Objectlinks contains interface references to other objects, ObjectBacklinks contains the reverse of those links</p>\n\n<p>Both properties consist of a TWeakIntfDictionary = class(TDictionary)\nThe Backlinks property is maintained in the ObjectLinks.ValueNotify event</p>\n\n<p>To make sure the interface referecnes are removed from the dictionary when the original object is free'd, a notification algorith (same as TFmxObject uses) is put into place</p>\n\n<p>As suspected I'm running into all kinds of circular reference problems when creating so many references to the same interfacedobjects :( but i can't seem to get out of this problem. When the FreeNotification is called from the object being destroyed, everything goes fine until it return fro the FreeNOtification. At that point the .Destroy of the object is called again :-(</p>\n\n<pre><code> {1 Dictionary of interfaces (using weak references) using Free notification }\n  TWeakIntfDictionary = class(TDictionary&lt;int64, IInterface&gt;, IFreeNotificationMonitor)\n  protected\n    procedure ValueNotify(const Value: IInterface; Action: TCollectionNotification); override;\n  public\n    procedure FreeNotification(aObject: TObject);\n  end;\n\n  implementation\n\n  procedure TWeakIntfDictionary.FreeNotification(aObject: TObject);\n  var\n    lObj: TPair&lt;int64, IInterface&gt;;\n  begin\n    //Object is going to be destroyed, remove it from dictionary\n    for lObj in Self do\n    begin\n      if (lObj.Value as TObject).Equals(aObject) then\n      begin\n        Remove(lObj.Key);\n        Break;\n      end;\n    end;\n  end;\n\n  procedure TWeakIntfDictionary.ValueNotify(const Value: IInterface; Action: TCollectionNotification);\n  var\n    lDestrIntf: IFreeNotificationBehavior;\n  begin\n      // When a TObject is added to the dictionary, it must support IDestroyNotification\n      // This dictionary is than added to the notificationlist of the TObject\n    if Supports(Value, IFreeNotificationBehavior, lDestrIntf) then\n      case Action of\n        cnAdded:      begin\n                        lDestrIntf.AddFreeNotify(Self);\n                        lDestrIntf._Release;\n                      end;\n        cnRemoved,\n        cnExtracted:  begin\n                        lDestrIntf.RemoveFreeNotify(Self);\n                      end;\n      end\n    else\n      raise EWeakInftDictionaryException.Create('Object added to TWeakIntfDictionary does not support IFreeNotificationBehavior');\n\n    inherited;\n\n  end;\n</code></pre>\n\n<p>Anyone know of a existing implementation of a WeakReferences Dictionary?\nAnyone any suggestions how to solve this ?</p>\n"},{"tags":["sql","oracle","delphi","delphi-7","ado"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":92,"score":2,"question_id":13067374,"title":"TADOQuery does not return any record","body":"<p>I am using Delphi 7 and I have a table named <code>Table_1</code> which has two fields say, <code>IMageCode Varchar(50)</code>, <code>ActImage [Blob in Oracle, VarBinary(Max) in SQL Server]</code>, it has four records inserted including images and respective image code.</p>\n\n<p>When I write a SQL as below in Oracle:</p>\n\n<pre><code>Select * from Table_1 where Upper(ImageCode) ='SUNSET'\n</code></pre>\n\n<p>TADOQuery doesn't return any record, when I check <code>TADOQuery.RecordCount</code> it shows <code>0</code>, when I try to see <code>TADOQuery.IsEmpty</code> it says <code>True</code>. Then same query when I execute in the Oracle editor it returns one record as expected, but in delphi the TADOQuery doen't return any record.</p>\n\n<p>But when I write following simple sql for the oracle database, it returns all four records using TADOQuery:</p>\n\n<pre><code>Select * from Table_1\n</code></pre>\n\n<p>I don't find any issue in SQL server database, as discussed above using TADOQuery.</p>\n\n<pre><code>ADOConnection.Connected := False; \nADOConnection.LoginPrompt := False; \nADOConnection.ConnectionString := &lt;Connection String&gt;; \nADOConnection.Connected := True; \nADOQuery1.Connection := ADOConnection; \nwith ADOQuery1 do begin \n  Active := False; \n  SQL.Clear; \n  //SqL.Add('Select * from Table_1 where Upper(ImageCode) = ' +    QuotedStr(Uppercase(Trim(edtImageCode.Text)))); \n  SqL.Add('Select * from Table_1 where Upper(ImageCode) = ''SUNSET'''); \n  Active := True; \nend; \n</code></pre>\n\n<p>Could anybody put focus what could be the issue?</p>\n"},{"tags":["delphi","windows-services","printing"],"answer_count":8,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":4140,"score":2,"question_id":2579946,"title":"QuickReport throws \"There Is No Default Printer Currently Selected\" Exception","body":"<p>I have created a Delphi Service which prints TQuickReports.  Everything works fine if compiled and run as a Windows Application.  But when converted to operate as a service trying to create a form containing a TQuickRep component throws the exception.</p>\n\n<p>This service runs fine on many other boxes but not this one in particular.  Here are some details:</p>\n\n<ul>\n<li>Using QuickReport version 4.07</li>\n<li>Box is a Windows Server 2008 operating system.</li>\n<li>Using Delphi 2007</li>\n<li><strong>Printer.Printers.Count</strong> is returning a positive value.  In fact I can list out all of the printers.</li>\n<li>I have tried running the service both using Local System Account and Logged on as an Admin.</li>\n</ul>\n"},{"tags":["delphi","installation","virtualtreeview"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1002,"score":1,"question_id":9331490,"title":"Trying to install Virtual Treeview for Delphi XE2","body":"<p>Found trunk here:\n<a href=\"http://virtual-treeview.googlecode.com/svn/trunk/\" rel=\"nofollow\">http://virtual-treeview.googlecode.com/svn/trunk/</a></p>\n\n<p>Downloaded files... Worked through some errors with search paths \n(VirtualTreesD could not locate required package \"dclstd\" - it was in lib/win32/release, added it to library Delphi paths)</p>\n\n<p>When I try build all I get following errors:</p>\n\n<blockquote>\n  <p>[DCC Fatal Error] VirtualTreesR.dpk(29): E2225 Never-build package 'dclstd' must be recompiled\n  [DCC Fatal Error] VirtualTreesD.dpk(35): E2202 Required package 'VirtualTreesR' not found</p>\n</blockquote>\n"},{"tags":["mysql","delphi","dbexpress","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":95,"score":2,"question_id":13081494,"title":"DBX Error: Driver could not be properly initialised","body":"<p>I am running <em>Delphi XE3 (Ultimate Edition)</em>, MySQL database and this is the error I get when a click <code>Test Connection</code>.</p>\n\n<p><img src=\"http://i.stack.imgur.com/XaRut.png\" alt=\"enter image description here\"></p>\n\n<p>As a response, I located the libmysql library in my xampp directory and copied it over to my System32 directory. This does not work however. </p>\n\n<p>Which libraries/drivers is this message referring to and what is the correct directory to place them in?</p>\n\n<p>libmysql version - 5.5.16.0</p>\n"},{"tags":["delphi","winapi","windows-networking"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":344,"score":4,"question_id":11178480,"title":"Mapping a network drive (WebDAV) doesn't work with Windows XP","body":"<p>i've got a problem mapping a network drive (WebDAV) under Windows XP using API method WNetAddConnection2. Under Windows 7 or it works like a charme. My code:</p>\n\n<pre><code>function ConnectDrive(Drive: string; Folder: string;\nUsername: string; Password: string; RestoreAtLogon: Boolean): HRESULT;\n\nvar\n  NetResource: TNetResource;\n  dwFlags: DWORD;\nbegin\n  with NetResource do\n  begin\n    dwType := RESOURCETYPE_DISK;\n    lpLocalName := PChar(Drive);\n    lpRemoteName := PChar(Folder);\n    lpProvider := nil;\n  end;\n\n  if (RestoreAtLogon) then\n    dwFlags := CONNECT_UPDATE_PROFILE\n  else\n    dwFlags := 0;\n\n  Result := WNetAddConnection2(NetResource, PChar(Password),\n    PChar(Username), dwFlags);\nend;\n</code></pre>\n\n<p>Everytime i try to connect Windows tells me: \"The Network name cannot be found\" or \"The Network path cannot be found\"</p>\n\n<p>As i said before, under Windows 7 there is no problem.</p>\n\n<p>If i use commercial tools like Netdrive, this program has no problem mounting the drive under XP, Vista or Windows 7.</p>\n\n<p>Has anyone an idea?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["delphi","collections","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":13075996,"title":"What to do when I need to call owner owner's owner method?","body":"<p>I've got TbsManager class which expose Load method like:</p>\n\n<pre><code> TbsManager = class(TComponent)\n private\n   FItems: TbsItems;  \n public\n   procedure Load(Item: TbsItem);\n</code></pre>\n\n<p>The TbsItem is a TCollectionItem and it's owned by TbsItems:</p>\n\n<pre><code>TbsItem = class(TCollectionItem)\nTbsItems = class(TCollection)\n</code></pre>\n\n<p>I want my TbsItems to have the Load method (which is in the onwer's owner class) and this is how I achieved it:</p>\n\n<pre><code>procedure TbsItem.Load;\nbegin\n  TbsManager(TbsItems(GetOwner).Owner).Load(Self);\nend;\n</code></pre>\n\n<p>I'm not sure if I've done it right. Is it a safe code?</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":5,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":217,"score":2,"question_id":12946150,"title":"How to bring my application to the front?","body":"<p>I know all the reasons why it is a bad idea. I dislike it if a application steals input focus, but this is for purely personal use and I want it to happen; it will not disturb anything. </p>\n\n<p>(for the curious: I am running unit tests in NetBeans, which generate a log file. When my background application sees the log file's timestamp change I want it to parse the log file and come to the front to show the results).</p>\n\n<p><a href=\"http://stackoverflow.com/questions/5282588/how-can-i-bring-my-application-window-to-the-front\">This question</a> did not help, no did googling.  It seems that <code>BringToFront()</code> hasn't worked for a long time and I can't find any alternative that can.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["string","delphi","dynamic","constructor","delphi-7"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":13064719,"title":"Delphi - Create Custom Form Instance (Having Custom Constructor Create) From String Form Name","body":"<p>I'm currently confused about creating form using string form name (as in <a href=\"http://stackoverflow.com/questions/701049/is-there-a-way-to-instantiate-a-class-by-its-name-in-delphi\">Is there a way to instantiate a class by its name in delphi?</a>) but my form has it's own constructor create.</p>\n\n<pre><code>//-BASE CLASS-//\nTBaseForm = class(TForm)\n  constructor Create(param1, param2: string); overload;\nprotected\n  var1, var2: string;    \nend;\n\nconstructor TBaseForm.Create(param1, param2: string);\nbegin\n  inherited Create(Application);\n  var1 := param1;\n  var2 := param2;\nend;\n\n//-REAL CLASS-//\nTMyForm = class(TBaseForm)\nend;\n\n//-CALLER-//\nTCaller = class(TForm)\n  procedure Btn1Click(Sender: TObject);\n  procedure Btn2Click(Sender: TObject);\nend;\n\nuses UnitBaseForm, UnitMyForm;\n\nprocedure TCaller.Btn1Click(Sender: TObject);\nbegin\n  TMyForm.Create('x', 'y');\nend;\n\nprocedure TCaller.Btn1Click(Sender: TObject);\nvar PC: TPersistentClass;\n    Form: TForm;\n    FormBase: TBaseForm;\nbegin\n  PC := GetClass('TMyForm');\n\n  // This is OK, but I can't pass param1 &amp; 2\n  Form := TFormClass(PC).Create(Application);\n\n  // This will not error while compiled, but it will generate access violation because I need to create MyForm not BaseForm.\n  FormBase := TBaseForm(PC).Create('a', 'z');\nend;\n</code></pre>\n\n<p>Based on the code I provided, how can I create a dynamically custom constructor form just by having string form name?\nOr it's really impossible? (I started to think it's impossible)</p>\n"},{"tags":["delphi","ado"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2479,"score":0,"question_id":2942560,"title":"Delphi / ADO : how to get result of Execute()?","body":"<p>I have declared <code>AdoConnection : TADOConnection;</code>  and successfully connected to the default \"mysql\" database (so, no need to pass that code).</p>\n\n<p>Now, taking baby steps to learn, I would like to <code>AdoConnection.Execute('SHOW DATABASES', cmdText);</code>  which seems to work ok, in the sense that it doesn't throw an exception, but I am such a n00b that I don't know how I can examine the result of the command  :-/</p>\n\n<p>Halp!</p>\n"},{"tags":["sql","delphi","ado","jet"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":322,"score":2,"question_id":6044931,"title":"ADO Updateable Queries - error when a one of the joined tables has no record","body":"<p>I use the 'updateable query' feature of ADO, being able to select a dataset from several tables and criteria and display it in a grid or some other UI for the user to browse and edit.</p>\n\n<p>However, and I'm surprised I've not hit this problem before now, when one of the joined tables doesn't have a record for the (master) key, and the user tries to edit a field in that table, ADO gives the famous \"Row cannot be located..\" error on post.</p>\n\n<p>As far as I understand this error, the ADO driver is trying to locate the record in order to update its fields - and, of course, in this instance, there is no record to find. What I was expecting in these circumstances would be that the ADO driver would issue the equivalent of an UPDATE query for the main table, but an INSERT query for the subsidiary table. </p>\n\n<p>Has anyone else come across this problem and found a workround?</p>\n\n<p>The ADO driver used is the Jet 4.0 OLE DB Provider connecting to an Access (mdb) database.</p>\n\n<p>I have ensured that the primary keys fields for both tables are available in the query dataset for the driver to utilise.</p>\n\n<p>Here is a basic version of the SQL I have using:  </p>\n\n<pre><code>SELECT \n    Table1.CustomerNo, Table1.Field1, Table1.Fieldn,  \n    Table2.CustomerNo, Table2.Field1, Table2.Fieldn  \nFROM \n    Table1 \nLEFT JOIN Table2 \n    ON Table1.CustomerNo = Table2.CustomerNo  \nWHERE \n    Table1.CustomerNo = Newcode;\n</code></pre>\n\n<p>As an experiment, I tried the same thing in MS Access 2007, and that worked, so there maybe a solution within ADO (but then Access is probably using a different driver).</p>\n"},{"tags":["sql","delphi","ado"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2279,"score":1,"question_id":1124259,"title":"SQL Return values in Delphi via ADO","body":"<p>Im having this function to determine weather a user exists in a database or not</p>\n\n<p>DM is my DataModule</p>\n\n<p>AQ_LOGIN an ADOQuery</p>\n\n<p>BENU is my Table filled with Users and their Password</p>\n\n<p>Here comes the code:</p>\n\n<pre><code>function UserCheckExist(Login, pw: string): boolean;\nbegin\n    with DM do\n    begin\n        AQ_LOGIN.Close;\n        AQ_LOGIN.SQL.Clear;\n        AQ_LOGIN.SQL.Add('select BLOGIN from BENU where BLOGIN = ''Login'' AND BPW = ''pw''');\n        AQ_LOGIN.Open;\n    end;\nend;\n</code></pre>\n\n<p>My question now is:\nHow can I make the function return true or false weather the User with the according password exists?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["delphi","graphics","bitmap"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":162,"score":6,"question_id":13063535,"title":"Large Bitmap on Delphi","body":"<p>I want to create large Bitmap with code </p>\n\n<pre><code>  LargeBmp := TBitmap.Create;\n  try\n    LargeBmp.Width := 1000; // fine \n    LargeBmp.Height := 15000; // XP - EOutOfResources, Not enough memory, Win 7 - works fine\n    ...\n  finally\n    FreeAndNil(LargeBmp);\n  end;\n</code></pre>\n\n<p>This code raises an <code>EOutOfResources</code> exception with message \"Not enough memory\" on Windows XP but works fine in Windows 7.</p>\n\n<p>What is wrong? Why <em>Not enough memory</em>? It's only 60 MB.</p>\n"},{"tags":["delphi","pascal"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":13031002,"title":"How to read AD displayname","body":"<p>I am using Delphi pascal ver. 4\nI have a user initials and need to get the active directory display name from the initials\nso I do not want to change AD just read - a function will be nice like this:</p>\n\n<pre><code>fullname, user :string;\nuser:='DKTB'\n</code></pre>\n\n<p>(call function)</p>\n\n<pre><code>fullname:=getAdDispayName(user);\n</code></pre>\n\n<p>(after call then fullname = 'Torben Bagge')</p>\n\n<p>I have used google to find it but was only able to find it in C and not pascal.</p>\n"},{"tags":["delphi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13070876,"title":"Displaying Hints in a Delphi XE2 TActionMainMenubar","body":"<p>I am struggling greatly trying to get hints displayed in a TActionMainMenuBar. \nDelphi XE2.</p>\n\n<p>I am creating the menus at runtime.  I add categories, subitems, clear the menu out, that all works great.  Clicking on the menu item works properly (for now it just does a ShowMessage with the action item tag but that's fine).</p>\n\n<p>This is the code that adds a new menu item :</p>\n\n<pre><code>function TActionF.NewAction(AParent: TActionClientItem; Caption: String; aTag : integer; ExecuteAction: TNotifyEvent):TActionClientItem;\nvar\n  newActionClient : TActionClientItem;\n  AnewAction : TAction;\nbegin\n  newActionClient := TActionClientItem(AParent.Items.insert(AParent.Items.Count));\n  newActionClient.Caption := Caption; //??\n  newActionClient.UsageCount := -1; // turn of menu priority stuff for now\n  AnewAction := TAction.Create(Self);\n  AnewAction.Tag := aTag;\n  AnewAction.ImageIndex := -1;\n  AnewAction.Caption := Caption;\n  AnewAction.Hint := Caption + 'Action Tag = ' + IntToStr(aTag);\n  AnewAction.OnHint := acnDoHint;  // fixed, could be parameter, but onHint is never called    !!??\n  AnewAction.OnExecute := ExecuteAction; // passed as parameter\n  newActionClient.Action := AnewAction;\n  Result := newActionClient;\nend;\n</code></pre>\n\n<p>I am setting the Hint\" of the action.  I have also experimented with assigning the OnHint, but the OnHint is never called.  I simply cannot get at that hint when browsing the menu.</p>\n\n<p>I have ShowHint set True everywhere I can see a place to do it.</p>\n\n<p>The problem is that I cannot get any menu hints displayed no matter what I try.   If i could just get at it I could display it myself (if the program won't).  The OnHint is never called.</p>\n\n<p>I have posted the full source of my menu program (Delphi XE2) , a small example narrowed down as best I could, in my public DropBox if anyone wants to see the program.</p>\n\n<p><a href=\"https://dl.dropbox.com/u/58421925/Actions.zip\" rel=\"nofollow\">https://dl.dropbox.com/u/58421925/Actions.zip</a></p>\n"},{"tags":["delphi","migration","delphi-xe2","delphi-xe3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":13063935,"title":"Error: F1026 File not found: 'System.Actions.dcu' switching back to Delphi XE2 from XE3","body":"<p>I'm moving my code to Delphi XE3 from XE2, but it should compile in both. I notice that some units get 'System.Actions' auto added to the USES clause. This then causes an error when returning to XE2 with:</p>\n\n<p>F1026 File not found: 'System.Actions.dcu' (unit scope \"System\" indicates Win64, OSX32, Win32 only)</p>\n\n<p>I've never really understood unit scope properly. Is there a correct solution to resolve this rather than wrapping stuff within compiler version {$IFDEF}'s?</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","mouseover","tdbgrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":13065902,"title":"How to get the text under the cursor in a TDbGrid","body":"<p>Screen width is just not enough to display some text fields. I don't know how to auto-wrap them and I doubt that it can be easily done.</p>\n\n<p>So, I thought that I would do something like  </p>\n\n<pre><code>procedure TForm1.FormMouseMove(Sender: TObject;\n    Shift: TShiftState; X,Y: Integer);\n\n   var column, row : Integer;\nbegin\n  myDbGrid.MouseToCell(X, Y, column, row);\n  myDbGrid.Hinst := myDbGrid.Cells(column, row); // &lt;==== ooops\nend;\n</code></pre>\n\n<p>or, maybe do it in <code>OnShowHint</code> and get the mouse coords &amp; translate them to column &amp; row (more efficient)</p>\n\n<p>but, of course, TDbGrid doesn't have <code>Cells</code>. Any idea how I can set the hint for the control as the user moves the mouse over the \"cells\" of the grid?</p>\n"},{"tags":["delphi","sqlite3","dbexpress","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":13067322,"title":"SQLite option missing from Data Explorer","body":"<p>I am creating an application with <em>Delphi XE3 (Ultimate Edition)</em> that will utilise an embedded SQLite database. I watched various videos in relation to it and I noticed that my Data Explorer did not match that of the video. At first my Data Explorer was empty, all that was there was <code>dbExpress</code>. I've also tried re-running the installer several times and <code>DataSnap</code>, <code>DBXPool</code>, <code>DBXTrace</code>, <code>IBToGo</code> and <code>InterBas</code> appeared, but it was not because of the installation re-run. Anyway, what can I do to get the SQLite option to appear for me?</p>\n\n<p>This is currently what my Data Explorer looks like:</p>\n\n<p><img src=\"http://i.stack.imgur.com/TFHIv.png\" alt=\"Data Explorer\"></p>\n"},{"tags":["delphi","static-analysis","code-quality"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13065355,"title":"How to ignore some files in Delphi QA audits?","body":"<p>I'm using the fabulous <strong>Audits</strong> tool within Delphi XE.<br>\nIt's really useful because it founds some architecture smells, coding rules violations ...  </p>\n\n<p>BUT, I had not found any way to ignore some files. I have 3rd Party files (auto-generated from  XML Data Binding) that produce many warnings ... The report is then polluted as I would like to ignore these files and see only 0 warning when I'm done.</p>\n\n<p><strong>Any way to ignore files in Audits tool ?</strong></p>\n"},{"tags":["delphi","tclientdataset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13067579,"title":"Record pointer change on calling edit in clientdataset","body":"<p>Why would the record pointer change on calling EDIT in cliendataset:</p>\n\n<pre><code>if myClientDataSet.Locate(VsKeyField, VvKeyValue, []) {pointer change as intended) then\nmyClientDataSet.Edit; {pointer changes again to wrong record, why?}\n</code></pre>\n"},{"tags":["delphi","build-process","executable"],"answer_count":14,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":3267,"score":16,"question_id":3199476,"title":"What Can I Do To Reduce My Executable's Size (Delphi)?","body":"<p>I release a single executable (.EXE) for a desktop program using Delphi 2009. I have no external DLLs or resources that I need for the program to run.</p>\n\n<p>I use two components: <a href=\"http://www.lmdinnovative.com/products/lmdelpack/\" rel=\"nofollow\">LMD Innovative's ELPack</a> and <a href=\"http://www.trichview.com/\" rel=\"nofollow\">Sergey Tkachenko's TRichView</a> that are compiled into my executable.</p>\n\n<p>When I build my production version, using the \"Release\" build configuration, the executable file produced is 13,533 KB. </p>\n\n<p>Prior to using Delphi 2009, I was using Delphi 4. The executable it produced was only 2,671 KB while incorporating the same two components and basically having the same code as my current version.</p>\n\n<p>I do understand that Delphi 2009 is completely Unicode (which is the main reason why I upgraded), and being Unicode can cause up to a doubling of size. But this is about 5 times larger.</p>\n\n<p>Is there a reason why my executable has to remain 5 times larger? Or are there some simple ways to cut down a significant chunk of the executable size?</p>\n\n<hr>\n\n<p>Please note. Some people are answering with ways to compress the Delphi EXE. That is not what I am trying to do. I am trying to simply see why so much space is being used to remove what might not be necessary. If that is done, compression can still be done afterwards if so desired.</p>\n\n<p>It really doesn't matter how big or small the executable is once it is installed. It is for downloading purposes and to minimize server load and download times that you want to compress it. I prefer to use <a href=\"http://www.jrsoftware.org/isinfo.php\" rel=\"nofollow\">Inno Setup</a> and compress the program inside the install routine itself. Then when it is installed, it is expanded to full size. That both prevents possible detection as a virus and eliminates the extra startup time needed to uncompress the program in memory. Also I code sign both my executable and my install routine and some compression techniques are incompatible with that.</p>\n\n<p>For more info about compressing, see the StackOverflow question:  <a href=\"http://stackoverflow.com/questions/800505/delphi-exe-compressor/800553\">Delphi EXE compressor?</a></p>\n\n<hr>\n\n<p>ldsandon asked me to provide exactly what options I'm using, so here they are:</p>\n\n<p><img src=\"http://www.beholdgenealogy.com/img/compilingoptions.jpg\" alt=\"Compiling Options\"></p>\n\n<p><img src=\"http://www.beholdgenealogy.com/img/linkingoptions.jpg\" alt=\"Linking Options\"></p>\n"},{"tags":["delphi","tstringgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":13060373,"title":"Mouse over stringgrid when dragging?","body":"<p>Parts of my stringgrid are eligible drop targets, and some are not (first row is column headings, first column is a sort of index and subsequent columns may be dropped to). I have that coded and working. </p>\n\n<p>Now I am thinking that it might be nice to gve a visual indiation to the user as he drags the mouse over a cell which is a potential drop target. I woudl like to highlight the first cell in the row and column of the cell over which he is currently hovering (or possibly the entire row and column, forming a sort of crosshair; I am as yet undecided). I reckon I can code that in <code>OnDrawCell</code>.</p>\n\n<p>I had thought to use <code>OnMouseMove</code> and cehck <code>if Dragging then</code>, but ...</p>\n\n<p>My problem is that when I am dragging the <code>OnMouseMove</code> event never gets called.</p>\n\n<p>Is there any other way to know when the cursor is hovering over a strigngrid during a drag operation?</p>\n"},{"tags":["delphi","winapi","tstringgrid"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":78,"score":6,"question_id":13060257,"title":"What is the normal colo(u)r of a selected stringgrid row?","body":"<p>I am overriding <code>OnDrawCell</code> for a string grid. In certain circumstance, I want to use the normal <code>TColor</code> that is used for the selected row when the system does the drawing (no <code>OnDrawCell</code>).</p>\n\n<p>Which colo(u)r is that? clXXX ?</p>\n"},{"tags":["delphi","windows-7"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":13045709,"title":"taskbar disappear when set to auto-hide an my window set to maximized","body":"<p>I set the Windows taskbar to auto-hide\nwhen i set my application to maximized the small 2 pixel lignes of the taskbar at the bottom disappear and i can't acces to the taskbar after\nif i minimize my application the taskbar reappear.</p>\n\n<p>do you know why ?</p>\n\n<p>i'm under Windows 7\nmy application is programmed in Delphi XE</p>\n\n<p>it's to make a chrome/firefox like application with tabs at the top. \ni give you a sample with the problem of the disappear taskbar :</p>\n\n<p>the DFM</p>\n\n<pre><code>object Form3: TForm3\n  Left = 0\n  Top = 0\n  Caption = 'Form3'\n  ClientHeight = 320\n  ClientWidth = 635\n  Color = clBtnFace\n  Font.Charset = DEFAULT_CHARSET\n  Font.Color = clWindowText\n  Font.Height = -11\n  Font.Name = 'Arial'\n  Font.Style = []\n  OldCreateOrder = False\n  WindowState = wsMaximized\n  OnCreate = FormCreate\n  PixelsPerInch = 96\n  TextHeight = 14\n  object PageControl1: TPageControl\n    AlignWithMargins = True\n    Left = 0\n    Top = 15\n    Width = 635\n    Height = 305\n    Margins.Left = 0\n    Margins.Top = 15\n    Margins.Right = 0\n    Margins.Bottom = 0\n    ActivePage = TabSheet3\n    Align = alClient\n    TabOrder = 0\n    object TabSheet1: TTabSheet\n      Caption = 'TabSheet1'\n    end\n    object TabSheet2: TTabSheet\n      Caption = 'TabSheet2'\n    end\n    object TabSheet3: TTabSheet\n      Caption = 'TabSheet3'\n    end\n  end\nend\n</code></pre>\n\n<p>the code</p>\n\n<pre><code>unit Unit3;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, Dwmapi, ComCtrls, StdCtrls;\n\ntype\n  TForm3 = class(TForm)\n    PageControl1: TPageControl;\n    TabSheet1: TTabSheet;\n    TabSheet2: TTabSheet;\n    TabSheet3: TTabSheet;\n    procedure FormCreate(Sender: TObject);\n  private\n    FWndTopFrameSize : Integer;\n    FWndBorderFrameSize : Integer;\n    procedure WMNCCalcSize(var Message: TWMNCCalcSize); message WM_NCCALCSIZE;\n  end;\n\nvar\n  Form3: TForm3;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm3.FormCreate(Sender: TObject);\nvar\n   r : TRect;\nbegin\n   if DwmCompositionEnabled then begin\n      SetRectEmpty(r);\n      AdjustWindowRectEx(r, GetWindowLong(Handle, GWL_STYLE), False,\n                         GetWindowLong(Handle, GWL_EXSTYLE));\n      FWndTopFrameSize:=-r.Top;\n      FWndBorderFrameSize:=r.Right;\n      GlassFrame.Top:=FWndTopFrameSize+PageControl1.Margins.Top;\n      GlassFrame.Enabled:=True;\n      SetWindowPos(Handle, 0, Left, Top, Width, Height, SWP_FRAMECHANGED);\n   end;\nend;\n\nprocedure TForm3.WMNCCalcSize(var Message: TWMNCCalcSize);\nbegin\n   inherited;\n   if DwmCompositionEnabled then\n      Inc(Message.CalcSize_Params.rgrc[0].Top, -FWndTopFrameSize);\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","application","twebbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13051691,"title":"How can I find the ComServer for a TWebBrowser Asynchronous Pluggable Protocol","body":"<p>I've currently implemented this demo code for an APP sucessfully, <a href=\"http://www.jasontpenny.com/blog/2010/03/23/custom-protocol-handler-in-delphi/\" rel=\"nofollow\">http://www.jasontpenny.com/blog/2010/03/23/custom-protocol-handler-in-delphi/</a>, However it seems to only work if the application is a single form application. </p>\n\n<p>What I have found is that no Factory is returned for CoGetClassObject in:</p>\n\n<pre><code>procedure NewProtocolHandler(const aProtocolName: String; aProtocolCallback: TProtocolCallback; aProtocollType: TGUID);\nvar\n    error : HRESULT;\nbegin\n    if _protocol &lt;&gt; '' then\n        raise Exception.Create('Currently only supports a single asynchronous pluggable protocol');\n\n    _protocol := aProtocolName;\n    _protocolCallback := aProtocolCallback;\n\n    error := CoGetClassObject(Class_AsyncPlugProto_Protocol, CLSCTX_SERVER, nil, IClassFactory, Factory);\n    CoInternetGetSession(0, InternetSession, 0);\n    InternetSession.RegisterNameSpace(Factory, Class_AsyncPlugProto_Protocol, PChar(_protocol), 0, nil, 0);\n\n    CoCreateInstance(aProtocollType, nil {was IUnknown(Self)}, CLSCTX_INPROC_SERVER, IUnknown, MyProtocol);\nend;\n</code></pre>\n\n<p>and I've come to believe that this is due to an incorrect ComServer in the initialization section.</p>\n\n<pre><code>initialization\n    TComObjectFactory.Create(ComServer, TAsyncPlugProto, Class_AsyncPlugProto_Protocol, 'Protocol', '', ciMultiInstance, tmApartment);\nfinalization\n    EndProtocolHandler;\nend. \n</code></pre>\n\n<p>My web browser is not actually part of a form as I've allowed for multiple browsers to be used in my application, so the Browser is declared as a TWinControl and if the conditions are meet for a TWebBrowser its created through :</p>\n\n<pre><code>FBrowser := TWebBrowser.Create(nil);\n</code></pre>\n\n<p>and accessed as:</p>\n\n<pre><code>(FBrowser as TWebBrowser)\n</code></pre>\n\n<p>I'm fairly new to Com functions so how can I go about finding the ComServer relative to the TWebBrowser? </p>\n"},{"tags":["delphi","syntax","history"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":138,"score":4,"question_id":13062882,"title":"Why can the circumflex sign be used for control chars in Delphi and is it a good idea?","body":"<p>I just came across an answer on SO with a curious syntax:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/254407/how-do-i-include-a-newline-character-in-a-string-in-delphi\">How do I include a newline character in a string in Delphi?</a></p>\n\n<p><code>MyString := 'Hello,' + ^M + ^J + 'world!';</code></p>\n\n<p>I've been using Delphi for several years now, but I didn't know you could use the circumflex sign for control characters.</p>\n\n<p>Is this just a left over from the early Delphi or Turbo Pascal days?</p>\n\n<p>Should it be used nowadays?</p>\n\n<p>PS: I'm not asking about advice on the line break characters, there is sLineBreak and other methods as discussed in the original question.</p>\n"},{"tags":["delphi","delphi-xe2","tstringgrid"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":95,"score":-2,"question_id":13035601,"title":"TStringGrid \"Grid Index out of range\", but Grid is populated?","body":"<p>Why would a TStringGrid with a RowCount greater than the passed row, give \"Grid Index Out of Range\"?</p>\n\n<p>I'm populating a TStringGrid in Delphi XE2 and then trying to select a specific row in the grid based on item in that grid.</p>\n\n<p>The grid defined at design and populated at Run Time using the following code:</p>\n\n<pre><code>procedure TMF.SetDeptList(fref, dx: string);\nvar\n  y:       integer;\n  s, dref: string;\nbegin\n  DM.GetDepts(fref);\n  y := 1;\n  while not DM.Q1.Eof do\n  begin\n    MyGrid.RowCount := y + 1;\n    s := SetDeptName(DM.Q1);\n    dref := DM.Q1.FieldByName('dx_ref').AsString;\n    MyGrid.Cells[0, y] := dref;\n    MyGrid.Cells[1, y] := s;\n    DM.GetJobCount(dref);\n    MyGrid.Cells[2, y] := DM.Q3.Fields[0].AsString;\n    inc(y);\n    DM.Q1.Next;\n  end;\n  y := MyGrid.Cols[0].IndexOf(dx);\n  // ShowMessage(MyGrid.Cells[1, y]);\n  MyGrid.Row := y;\nend;\n</code></pre>\n\n<p>\"Dx\" is a passed in department that I want to find in my Grid and set the row to.  The ShowMessage commented out above confirms that \"dx\" appears in the grid where I expect it (in the test case <code>y = 2</code> of <code>MyGrid.RowCount = 5</code>)</p>\n\n<p>Yet the final line gives a <strong>Grid Index Out Of Range</strong> </p>\n\n<p>Any suggestions?</p>\n"},{"tags":["delphi","debugging","delphi-xe3"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":128,"score":3,"question_id":13057133,"title":"Stopping delphi program in an infinite loop","body":"<p>When an indefinite loop occurs in Delphi, the debugger will not even give me a stack trace when I hit the stop button.  If I have a suspicion of where the program is stalling, I can put a breakpoint and it will stop if that is the correct indefinite loop.  </p>\n\n<p>Here is a sample program to deliberately cause an indefinite loop:</p>\n\n<pre><code>procedure TForm1.btnDebugInfiniteLoopClick(Sender: TObject);\nvar I: Integer;\nbegin\n    I:=0;\n    while I&lt;100 do begin\n        I:=1+1;\n        if I&gt;64 then I:=I div 2;\n    end;\nend;\n</code></pre>\n\n<p>When stopped, I get something that looks like:</p>\n\n<pre><code>ntdll.RtlUserThreadStart:\n776301B4 89442404         mov [esp+$04],eax\n776301B8 895C2408         mov [esp+$08],ebx\n776301BC E9E99C0200       jmp $77659eaa\n776301C1 8DA42400000000   lea esp,[esp+$0000]\n776301C8 8DA42400000000   lea esp,[esp+$0000]\n776301CF 90               nop \nntdll.KiFastSystemCall:\n776301D0 8BD4             mov edx,esp\n\n...\n</code></pre>\n\n<p>As I single step (F7), it single steps a few lines, then locks up until I hit break again, at which point I get the same result.</p>\n"},{"tags":["xml","delphi","delphi-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":200,"score":0,"question_id":10930111,"title":"How can I get the Open XML DOM parser to parse an ntEntityRef node?","body":"<p>I have this XML input:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;string&gt;\n&amp;lt;N/A&amp;gt;\n&lt;/string&gt;\n</code></pre>\n\n<p>Here is a short code sample to illustrate the problem:</p>\n\n<pre><code>uses\n  xmldom, oxmldom, XMLDoc, XMLIntf;\n\nprocedure TForm1.Test;\nvar\n  Document     : IXMLDocument;\n  StringNode   : IXMLNode;\n  LessThanNode : IXMLNode;\nbegin\n  DefaultDOMVendor := 'Open XML';\n  Document         := LoadXMLData(Memo1.Lines.Text);\n  StringNode       := Document.DocumentElement;\n  LessThanNode     := StringNode.ChildNodes.First;\n  ShowMessage(LessThanNode.Text); // Displays '' (an emtpy string)\n  ShowMessage(LessThanNode.XML);  // Displays '&amp;lt;'\n  ShowMessage(StringNode.Text);   // Causes an EXMLDocError, because the string node contains more than just a single node with NodeType = ntText\nend;\n</code></pre>\n\n<p>How can I get the <code>Open XML</code> parser to transform the <code>&amp;lt;</code>, <code>&amp;gt</code> and similar XML entities to their real text (like <code>&lt;</code> and <code>&gt;</code>)?</p>\n\n<p>I could write a workaround for the predefined entities in the XML specification:\n<a href=\"http://www.w3.org/TR/2008/REC-xml-20081126/#sec-predefined-ent\" rel=\"nofollow\">http://www.w3.org/TR/2008/REC-xml-20081126/#sec-predefined-ent</a></p>\n\n<p>That won't help with additional entity nodes though ...</p>\n\n<p>Related: <a href=\"http://stackoverflow.com/questions/8416986/why-doesnt-ixmlnode-istextelement-return-true-for-cdata-elements\">Why doesn&#39;t IXMLNode.IsTextElement return True for CDATA elements?</a></p>\n"},{"tags":["delphi","synapse"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":86,"score":4,"question_id":13045943,"title":"Delphi + Synapse: How to check if I am still connected","body":"<p>I am using <a href=\"http://synapse.ararat.cz/doc/help/blcksock.TTCPBlockSocket.html\" rel=\"nofollow\"><code>TTCPBlockSocket</code></a> for a TCP/IP Application . The problem is that I can't determine when the connection is lost.</p>\n\n<p><code>GetLastError</code> returns 0<br>\n<code>Read</code> returns 0</p>\n\n<p>But I encounter these values eaven if the application is connected so I can get it how can I be notified when the TCP/IP connection is lost.</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":13057995,"title":"How do I make my changes to XML-related source files take effect?","body":"<p>I want to make changes to the xmldom and XMLDoc files. I tried to, but I don't know how to test those changes because the program does not seem to be running the code in those files. I tried using a ShowMessage to see if that code was being accessed but it never showed up. Even if I rename the directory the files are in, the program still compiles fine as if it is not actively reading the files at run time but instead has the information stored elsewhere.</p>\n\n<p>How can I change these namespaces and then make sure that the changes are being included in my next compile?</p>\n\n<p><em>Update</em></p>\n\n<p>Well i'm looking for an answer in general..  Because I have had this problem in multiple situations.. But for specifics <a href=\"http://stackoverflow.com/questions/11794540/changing-xml-node-attribute-value-gives-namespace-error\">Changing XML node attribute value gives &quot;Namespace error&quot;</a> (here the answer talks about changing the 'AdomCore_4_3') I want to be able to change it and have the change show up when I compile.  </p>\n"},{"tags":["sql","delphi","delphi-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":13050499,"title":"Selecting records based on start and end datetime fields","body":"<p>I am using delphi 2010 and Firebird (locally) for testing, but eventually will be running my app against MS Sql Server or Oracle.</p>\n\n<p>If I have datetime fields (start_time &amp; end_time), and i want to select all records from the last 30 days, or a rangle of dates, how do i do this, taking into consideration the three databases mentioned above (firebird, sql server, oracle)</p>\n\n<p>The example datetime fields look as such:  10/15/2012 9:20:49 AM</p>\n\n<p>The following is an example sql statement which i would like to add an additional where clause to:</p>\n\n<pre><code>  SQL.Text:= \n      'SELECT J.id, MIN(p.start_Time) as startTime, MAX(p.end_Time) as endTime, ' \n      +  'SUM(p.duration) as TotalDuration ' \n      + 'FROM phases p ' \n      + 'JOIN jobs j ON j.id = p.jobs_Id ' \n      + 'WHERE j.id=:jobId ' \n      + 'GROUP BY j.id';\n</code></pre>\n\n<ol>\n<li><p>How do I select all records from phases where starttime or endtime is within the last 30 days?  </p></li>\n<li><p>How do I select all records from a phases where starttime or endtime fall within a range of dates\n(lets say for example, i am using the params :beginDateRange  &amp; :endDateRange)  </p></li>\n</ol>\n\n<p>thanx for your help</p>\n"},{"tags":["delphi","code-sample","wpd"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13061677,"title":"Looking for examples of Window Portable Device (WPD) API in Delphi","body":"<p>I'm looking to use WPD in Delphi.  I have downloaded and installed the these two type libraries:-</p>\n\n<p>PortableDeviceApiLib_TLB\nPortableDeviceTypesLib_TLB</p>\n\n<p>I have found some sample code for using them, but it is written C# (or is it C++? - no matter, it may as well be Tibetan) which I don't understand.  The manual on MSDN sort of assumes that you know what you are doing and again has its examples are in C.</p>\n\n<p>I need to be able to find the WPD attached devices and transfer images to my application.  </p>\n\n<p>Does anyone have some sample code written in Delphi or a link to such sample code or a delphi tutorial?</p>\n"},{"tags":["delphi","sqlite","sqlite3","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":13057789,"title":"Visually creating database tables with the Data Explorer","body":"<p>I watched a <a href=\"http://www.youtube.com/watch?feature=player_detailpage&amp;v=416qL6is5Xw#t=26s\" rel=\"nofollow\">video</a> in relations to creating and working with databases in Delphi. The video states that you can create the database using code, the data explorer or the SQLite3 console application, but I am unable to find out how to create the database using the Data Explorer. Does anyone know a way I can go about doing this? </p>\n\n<p>Thank you in advanced. </p>\n"},{"tags":["delphi","cursor","oracle11g","delphi-xe2","dbexpress"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":13054254,"title":"How to return Oracle Cursor from stored proc as Client Dataset using Delphi and DBExpress","body":"<p>1st off I am Still a little green to Delphi so this might be a \"mundane detail\" that's being over looked. [sorry in advance]</p>\n\n<p>I have a need to create a TSQLDataset or TClientDataSet from an Oracle 11g cursor contained in a package. I am using Delphi XE2 and DBExpress to connect to the DB and DataSnap to send the data back to the client.</p>\n\n<p>I'm having problems executing the stored procedure from the Delphi code.</p>\n\n<p><strong>Package Head</strong>:</p>\n\n<pre><code>create or replace\nPACKAGE KP_DATASNAPTEST AS \n  procedure GetFaxData(abbr varchar2, Res out SYS_REFCURSOR);\nEND KP_DATASNAPTEST; \n</code></pre>\n\n<p><strong>Package Body</strong>:</p>\n\n<pre><code>create or replace\nPACKAGE  body KP_DATASNAPTEST AS \n  procedure GetFaxData(abbr varchar2, Res out SYS_REFCURSOR)is\n  Begin\n    open Res for \n      SELECT  Name, \n              Address1, \n              City, \n              fax_nbr \n      FROM    name \n      JOIN phone on name.Abrv = phone.abrv \n      WHERE phone.fax_nbr is not null and name.abrv = abbr;\n  end;\nEND KP_DATASNAPTEST;\n</code></pre>\n\n<p>I have no problem executing this procedure in SQL Developer the problem resides in this code on the DataSnap server:</p>\n\n<pre><code>function TKPSnapMethods.getCDS_Data2(): OleVariant;\nvar\n  cds: TClientDataSet;      \n  dsp: TDataSetProvider;\n  strProc: TSQLStoredProc;      \nbegin\n  strProc := TSQLStoredProc.Create(self);\n  try\n    strProc.MaxBlobSize := -1;\n    strProc.SQLConnection:= SQLCon;//TSQLConnection\n\n    dsp := TDataSetProvider.Create(self);\n    try\n      dsp.ResolveToDataSet := True;\n      dsp.Exported := False;\n      dsp.DataSet := strProc;\n      cds := TClientDataSet.Create(self);\n      try\n        cds.DisableStringTrim := True;\n        cds.ReadOnly := True;\n        cds.SetProvider(dsp);\n\n        strProc.Close;\n        strProc.StoredProcName:= 'KP_DATASNAPTEST.GetFaxData';\n        strProc.ParamCheck:= true;\n        strProc.ParamByName('abbr').AsString:= 'ZZZTOP';\n        strProc.Open; //&lt;--Error: Parameter 'Abbr' not found. \n\n        cds.Open;\n        Result := cds.Data;\n      finally\n        FreeAndNil(cds);\n      end;\n    finally\n      FreeAndNil(dsp);\n    end;\n  finally\n    FreeAndNil(strProc);\n    self.SQLCon.Close;\n  end;\nend;\n</code></pre>\n\n<p>I have also tried assigning the param value through the ClientDataSet without any luck.\nI would not be apposed to returning a TDataSet from the function if its easier or produces results. The data is used to populate custom object attributes.</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":94,"score":4,"question_id":12977750,"title":"WM_SYSCOMMAND dont work when child form is maximized","body":"<p>I have a MDI aplication and a window procedure to handle formChild's messages. In this case, catch WM_SYSCOMMAND message to show a text. When form is minimized, show a message.</p>\n\n<p>All works fine,...but</p>\n\n<p>The problem is when child form is maximized and then I try minimized the form, the WM_SYSCOMMAND don't work, the <code>ShowMessage</code> don't show.</p>\n\n<p>What message can I catch in this case?</p>\n\n<pre><code>//TCHild Form Child\n\nfunction MDIChildProc(hwnd: HWND; uMsg: UINT; wParam: WPARAM; lParam: LPARAM): LRESULT; stdcall;\nvar\n  F: TChild;\nbegin\n  F := TChild(FindControl(hwnd));\n  begin\n    case uMsg of\n      WM_SYSCOMMAND:\n      begin\n        case wParam and $FFF0 of\n          SC_MINIMIZE:\n          begin\n            {First Minimize then show text} \n            CallWindowProc(Pointer(F.Tag), hwnd, uMsg, wParam, lParam);  \n            ShowMessage('form minimized');\n          end;\n        end;\n      end;\n    end;\n    Result := CallWindowProc(Pointer(F.Tag), hwnd, uMsg, wParam, lParam);\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":103,"score":-1,"question_id":13056642,"title":"Delphi - Hide console window","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/291631/profiler-and-memory-analysis-tools-for-delphi\">Profiler and Memory Analysis Tools for Delphi</a><br>\n  <a href=\"http://stackoverflow.com/questions/13042036/how-do-i-hide-the-console-window\">How do I hide the console window?</a>  </p>\n</blockquote>\n\n\n\n<p>I'm reposting this to make it more clear. So, here is my console application:</p>\n\n<p><img src=\"http://i.stack.imgur.com/4luwv.jpg\" alt=\"enter image description here\"></p>\n\n<p>That opens a socket to 127.0.0.1:81, when the console application is visible it works fine, now how do I keep it working fine as a console but make the console invisible?</p>\n\n<p>I am using Delphi 2007 (7).</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","delphi-2007"],"answer_count":6,"favorite_count":1,"up_vote_count":9,"down_vote_count":1,"view_count":821,"score":8,"question_id":5585031,"title":"Unit <SomeUnit> Recursively Uses Itself (but it doesn't)","body":"<p>I have a datamodule that's used thoughout one of our line of business apps. It's in the implementation uses clause of almost every unit in the project.</p>\n\n<p>I can modify business logic and other code in the implementation section of the datamodule and compile without any issues. However, any change to the interface section of the datamodule and then compiling results in the compiler error \"Unit MyDataModule recursively uses itself\". A build instead of a compile makes the error go away.</p>\n\n<p>This is a new one I haven't seen before. Of course, I've checked to make sure that there's no way the datamodule is recursively used, and if it were in fact, the build wouldn't change anything.</p>\n\n<p>Does anyone have any ideas of how to track this down or fix it? It's really annoying to have to compile, dismiss the error dialog, and then build every time a new query or method is introduced to the datamodule.</p>\n\n<p><strong>EDIT</strong>: Addressing some of the comments below and in @Marjan's answer:</p>\n\n<p>I'm not using Variants or debug dcus. I've tried a solution in one of the Google search results that looked <a href=\"https://forums.embarcadero.com/message.jspa?messageID=107527\" rel=\"nofollow\">promising</a> about corrupt .identcache or .local files, but that didn't pan out.</p>\n\n<p>Tried @Jørn's suggestion; cleaned up all temp and compiled .dcus, did a compile, and all is well. Made a change to the interface (delared a Boolean variable in the private section of the datamodule's class declaration), and hit Ctrl+F9 to compile. Error. Did a Build, all is well. Compile then works fine. Delete the Boolean, try a compile: error.</p>\n\n<p>I've got roughly 20 projects of similar size (~750K-1M LOC), none of which exhibit this behavior. I've quadruple-checked that the datamodule isn't in the interface section of any of the units in the project. The datamodule itself is not extremely large (a total of 8,345 lines from 'unit' to 'end.', including comments and blank lines). The .dfm, seen as text, is a total of 8,916 lines.</p>\n\n<p><strong>EDIT 2</strong>: I guess I'll have to accept (for now, anyway) that this is a compiler glitch. I'm going to try some rearranging of things to break out some of the functionality into a separate datamodule to see if it's a size limitation (items in the DFM, maybe) or something. Thanks for all the effort. </p>\n"},{"tags":["delphi","interface","coding-style","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":13057354,"title":"Constructor in an Interface","body":"<p>I know - I cannot, but.</p>\n\n<p>I want all classes who will implement my interface to have the same owner (usually defined in constructor). What is the best practice to do that?</p>\n\n<p>Should I use some base abstract class or something like this?</p>\n"},{"tags":["delphi","delphi-7"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13042601,"title":"Adding entire directories to TKaZip","body":"<p>I'm new to working with TKaZip for Delphi7 I can workout how to build and add in single files to be compressed to a .kmz file but I'm stuck on how to compress a selected directory to a .kmz file. </p>\n\n<p>This what I got so far</p>\n\n<pre><code>var\n  FS: TFileStream;\n  KaZip:TKaZip;\n  KmzFileName:TFileName;\n  aFileName : string;\n  savedata : string;\nbegin\n\n    savedata :='C:\\Users\\Puser\\Desktop\\testfolder\\';\n\n   //building .kmz for test\n  aFileName := 'TEST';\n  KmzFileName := ChangeFileExt(aFileName, '.kmz');\n  KaZip := TKaZip.Create(nil);\n  try\n    // create an empty zipfile with .kmz extension:\n    FS := TFileStream.Create(KmzFileName, fmOpenReadWrite or FmCreate);\n    try\n      KaZip.CreateZip(FS);\n    finally\n      FS.Free;\n    end;\n            //now sending files to .kmz\n    KaZip.Open(KmzFileName); // Open the new .kmz zipfile\n    KaZip.AddFilesAndFolders(savedata);\n    KaZip.Close;\n\n  finally\n    KaZip.Free;\n\n  end;\n</code></pre>\n\n<p>original source was <a href=\"http://stackoverflow.com/questions/1082735/creating-compressed-zipped-folder-using-delphi\">Creating Compressed (Zipped) Folder using Delphi</a></p>\n"},{"tags":["delphi","sqlite","unicode","utf-8"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13042340,"title":"delphi 2007 display unicode U+1F48B in UTF-8 string or any other way","body":"<p>I have a sqlite database (UTF-8 encoding). And inside the database i have such record (hex bytes):</p>\n\n<pre><code>D0 9E D0 BA 29 F0 9F 92 8B F0 9F 92 8B\n</code></pre>\n\n<p>Thus the bytes are not alligned, that is:</p>\n\n<pre><code>$D09E = O\n$D0BA = к\n$29 = )\n$F09F928B = U+1F48b (KISS MARK)\n$F09F928B = U+1F48b (KISS MARK)\n</code></pre>\n\n<p>This is how it looks like in the SQLite manager:</p>\n\n<p><img src=\"http://i.stack.imgur.com/deQsM.jpg\" alt=\"enter image description here\"></p>\n\n<p>But whatever i do (UTF8Decode and some custom transformations) i cannot make it to be displayed in my Unicode enabled TNTStringGrid. </p>\n\n<p>Yes, i can get the Ok)?? displayed but then goes either Ок)рџ’‹рџ’‹ or this is how it looks like real (UTF8Encoded): РћРє)рџ’‹рџ’‹</p>\n\n<p>I know it's a hard question, but there must be a solution because the SQLite manager displays it absolutely correct.</p>\n\n<p>So how to display those U+ characters along with normal text?</p>\n\n<p>Please help! 3 days and nights fighting with this task.</p>\n"},{"tags":["delphi","port","delphi-xe","delphi-2007","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":578,"score":9,"question_id":8704912,"title":"TIdHTTP - session has expired message under Delphi XE","body":"<p>I am trying to port my code from Delphi 2007 to Delphi XE (no Update 1 yet). The problem which I have stumbled on is that under Delphi XE I am getting different response from server after sending second GET message.</p>\n\n<p>The message in formated HTML says that my session has expired. However, the same code works without any problems under Delphi 2007 up to this day. I have searched information over the internet and found out that I should use a CookieManager?</p>\n\n<p>The thing is that I am not using any in Delphi 2007 and when I assigned one in Delphi XE the result of my code has not changed. Still I am getting message about expired session.</p>\n\n<p>What else can I try?</p>\n\n<p><strong>Update:</strong> I have found some info that Indy 10 has problems with cookies but they were fixed.</p>\n\n<p>I have downloaded snapshot Indy10_4722, unfortunately the error still occurs.</p>\n\n<p><strong>Update 2 - Code provided</strong></p>\n\n<p>So, I've prepared an example code. This is compatibile with both Delphi (2007 and XE). However to compile it under 2007 you need to have <a href=\"http://www.soft-gems.net/index.php?option=com_content&amp;task=view&amp;id=13&amp;Itemid=33\" rel=\"nofollow\" title=\"GraphicEx library.\">GraphicEx library</a>.</p>\n\n<p>The code is connecting to the real server, loads a security image and displays it one the form. Rewrite letters from image to the edit box and close the form. That is all what you need to do to test it.</p>\n\n<pre><code>program IndyTest;\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, StdCtrls, Contnrs, Menus, ExtCtrls, IdBaseComponent,\n  IdComponent, IdTCPConnection, IdTCPClient, IdHTTP,\n  {$IFDEF VER220}PngImage{$ELSE}GraphicEx{$ENDIF}, StrUtils;\n\n{$R *.res}\n\nprocedure LoadSecurityImage(AImage: TImage; AIdHTTP: TIdHTTP; AImgLink: String);\nvar\n  PNGGraphic: {$IFDEF VER220}TPngImage{$ELSE} TPNGGraphic{$ENDIF};\n  ResponseStream: TMemoryStream;\nbegin\n  ResponseStream := TMemoryStream.Create;\n  PNGGraphic   := {$IFDEF VER220}TPngImage.Create{$ELSE}TPNGGraphic.Create{$ENDIF};\n  try\n    AIdHTTP.Get(AImgLink, ResponseStream);\n    ResponseStream.Position := 0;\n    PNGGraphic.LoadFromStream(ResponseStream);\n    AImage.Picture.Assign(PNGGraphic);\n  finally\n    ResponseStream.Free;\n    PNGGraphic.Free;\n  end;\nend;\n\nfunction GetImageLink(AIdHTTP: TIdHTTP): String;\nvar\n  WebContentStream: TStringStream;\n  Index, Index2: Integer;\nbegin\n  Result := '';\n  WebContentStream := TStringStream.Create('');\n  try\n    AIdHTTP.Request.ContentType := 'application/x-www-form-urlencoded';\n    AIdHTTP.Get('http://czat.wp.pl/i,1,chat.html', WebContentStream);\n    Index := Pos('id=\"secImg\"&gt;', WebContentStream.DataString);\n    if Index &gt; 0 then\n    begin\n      Index := PosEx('src=\"', WebContentStream.DataString, Index) + 5;\n      Index2 := PosEx('\"&gt;', WebContentStream.DataString, Index);\n      if Index &gt; 10 then\n      begin\n        Result := Copy(WebContentStream.DataString, Index, Index2 - Index);\n      end;\n    end;\n  finally\n    WebContentStream.Free;\n  end;\nend;\n\nprocedure CheckForContent(const ANick, AImageSeed: String; AIdHTTP: TIdHTTP);\nvar\n  WebContent: TStringStream;\n  S: String;\nbegin\n  WebContent := TStringStream.Create('');\n  try\n    AIdHTTP.Request.ContentType := 'application/x-www-form-urlencoded';\n    S := 'http://czat.wp.pl/chat.html?i=31179&amp;auth=nie&amp;nick=' + ANick\n      + '&amp;regulamin=tak&amp;simg=' + AImageSeed + '&amp;x=39&amp;y=13';\n    AIdHTTP.Get(S, WebContent);\n    if Pos('&lt;div class=\"applet\"&gt;', WebContent.DataString) &gt; 0 then\n      ShowMessage('It works properly.')\n    else if Pos('&lt;div id=\"alert\"&gt;Sesja wygas', WebContent.DataString) &gt; 0 then\n      ShowMessage('Session expired')\n    else\n      ShowMessage('Unknown result.');\n  finally\n    WebContent.Free;\n  end;\nend;\n\nvar\n  LogForm: TForm;\n  SecurityImage: TImage;\n  Edit: TEdit;\n  IdHTTPWp: TIdHTTP;\nbegin\n  Application.Initialize;\n  IdHTTPWp := TIdHTTP.Create(Application);\n  IdHTTPWp.AllowCookies := True;\n  IdHTTPWp.HandleRedirects := True;\n  IdHTTPWp.HTTPOptions := [hoForceEncodeParams];\n\n  LogForm := TForm.Create(Application);\n  LogForm.Position := poScreenCenter;\n  SecurityImage := TImage.Create(LogForm);\n  SecurityImage.Parent := LogForm;\n  SecurityImage.AutoSize := True;\n  Edit := TEdit.Create(LogForm);\n  Edit.Parent := LogForm;\n  Edit.Top := 64;\n  LoadSecurityImage(SecurityImage, IdHTTPWp, GetImageLink(IdHTTPWp));\n  LogForm.ShowModal;\n  CheckForContent('TestUser', Edit.Text, IdHTTPWp);\n  Application.Run;\nend.\n</code></pre>\n\n<p><strong>Update 3</strong></p>\n\n<p>Data packets for Delphi 2007 example <a href=\"http://speedy.sh/g6MYM/Delphi2007.ssp\" rel=\"nofollow\">are here</a>.</p>\n\n<p>Data packets for Delphi XE example <a href=\"http://speedy.sh/jmHaH/DelphiXE.ssp\" rel=\"nofollow\">are here</a>.</p>\n\n<p>Free program to analyze packets <a href=\"http://www.nirsoft.net/utils/smsniff.html\" rel=\"nofollow\">SmartSniff</a>.</p>\n\n<p>Thanks.</p>\n"},{"tags":["forms","delphi","alignment"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":291,"score":5,"question_id":12811640,"title":"What use are the Align and Anchor properties on TForm?","body":"<p>It's possible to set the Alignment on a TForm, say set one form to alTop and another to alClient - whereby the two forms take up the whole screen area in the obvious way.  Is this a sensible thing to do in an application?</p>\n\n<p>I also notice that anchors are exposed on forms - but I can't think what they would be useful for (resolution changes? MDI apps?)  Any ideas?</p>\n\n<p>Edit:\nI've made a <a href=\"http://youtu.be/Jdf5JVAXb0Q\" rel=\"nofollow\">video about this post</a> to make things clearer.</p>\n"},{"tags":["delphi","indy","indy10","object-pascal"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":130,"score":1,"question_id":13036579,"title":"INDY 10 TCP Server - Combine with non thread safe VCL Code","body":"<p>VCL is not thread safe. Therefore I guess it is not a good idea to write information to the gui in the INDY 10 TCP <code>server.execute(...)</code>  function .</p>\n\n<p>How to send information from the server execute to the VCL ?</p>\n\n<p>I need to modify a TBitmap inside a <code>tcpserver.execute</code> function. How to make that thread safe ?</p>\n"},{"tags":["delphi","twebbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":77,"score":2,"question_id":13026593,"title":"Is there an equivalent to Chromium Embedded's OnResourceResponse in TWebBrowser? (Delphi)","body":"<p>I'm currently trying to view an image being loaded through a Res://imagename at the point its loaded. In Chromium with a res handler I've been able to do this through the ResourceResponse event however, TWebBrowser does not have a similar function as far as I can tell. </p>\n\n<p>I have been able to latch on to the OnDocumentComplete function and have been able to implement a very inefficient way that looks through the whole of the HTML document once its been created...</p>\n\n<pre><code>procedure TNotesBrowser.TBrowserDocumentComplete(ASender: TObject; const pDisp:   IDispatch; var URL: OleVariant);\nvar\n    HTMLDocument2: IHTMLDocument2;\n    i            : Integer;\n    Item         : IHTMLElement;\n    ImageUrl     : string;\nbegin\n    HTMLDocument2 := ((FBrowser as TWebBrowser).Document AS IHTMLDocument2);\n    if HTMLDocument2 &lt;&gt; nil then\n    begin\n        for i := 0 to HTMLDocument2.images.length -1 do\n        begin\n        Item := HTMLDocument2.images.item(i, 'null') As IHTMLElement;\n        ImageUrl:=item.getAttribute('src',0);\n\n        if ContainsText(ImageURL,'ImageName') then\n            if Assigned(FCCICONLoaded) then\n                { Trigger Event }\n                FCCICONLoaded(self);\n        end;\n    end;\nend;\n</code></pre>\n\n<p>However, this is quite a long process. So has anyone else found an event that acts similar to Chromium's OnResourceResponse() to avoid looking through the document? </p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":145,"score":2,"question_id":13033737,"title":"Where is maxint defined - duplicate definition?","body":"<p>I have a projectgroup in which all Win32 programs have the same ..\\PatchLibs search path.\nThis folder contains a patched System.Win.Ctrl.pas containing:</p>\n\n<pre><code>{$IFDEF WIN32}\nfunction _malloc(size: size_t): Pointer; cdecl;\nbegin\n  if (size &gt; MaxInt) then \n  begin                   \n     Result := Nil\n  end\n  else\n  begin\n     try\n        Result := AllocMem(size);\n     except\n        Result := Nil;\n     end;\n  end;\nend;\n</code></pre>\n\n<p>[This patch suppresses an error in midaslib (QC 104337)]</p>\n\n<p>The issue:</p>\n\n<p><em>One</em> of the (smaller) projects gives a W1023 (\"comparing signed and unsigned types\") compiler warning on the 'MaxInt' line, all others build without warnings.<br />\nNone of the projects have System.Win.Ctrl in their uses statements or in their project files.</p>\n\n<p>Thinking there might be two typed constant definitions for Maxint I wanted to prefix Maxint with the 'correct' unit name, but can't find its definition.<br />\nI have searched through all available c:\\program files (x86)\\embarcadero\\rad studio\\9.0\\source*.* files, but found no definitions.<br />\nSystem.MaxInt works  but does not eliminate the warning.<br />\nTypecasting Cardinal(MaxInt) removes the warning, but I'd still prefer the 'fully qualified' solution.<br />\n(size_t is defined as ULONG_PTR is defined as NativeUInt)<br />\nI found Quality Central issue 102873, 69836 and 53202 but these refer to duplicate definitions C++ .h header files</p>\n\n<p>Is my assumption about more than one definition correct? If so, what would/should the unit prefix be? \nAnd most important: why do I get the compiler warning for that one project build only?</p>\n"},{"tags":["delphi","windows-xp","compatibility","backwards-compatibility","windows-98"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":95,"score":2,"question_id":13048854,"title":"Can Delphi 4 Pro be installed and used reliably on Windows XP (or later)?","body":"<p>Several years ago I used Delphi 4 Pro on a Windows '98 SE machine to create Delphi projects.</p>\n\n<p>Would it be feasible to install the same Delphi 4 Pro on a Windows XP machine (or later OS, such as Windows 7) to view and update older Delphi projects?</p>\n"},{"tags":["delphi","zip","cross-platform"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":13048606,"title":"Cross Platform Zip library with AES encryption support","body":"<p>Im looking for an replacement of our current Zip components.</p>\n\n<p>The new components should support:<br>\nWin32, Win64 and Mac in Delphi XE2 upwards as well as<br>\nstandard and AES encryption.</p>\n\n<p>Best is, if the components are actively developed so that future mobile platforms can be used as well.</p>\n\n<p>My searches so far have not been very successful...</p>\n"},{"tags":["delphi","styles","vcl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13046856,"title":"Program border clipping occurs when using VCL styles in DXE3","body":"<p>In Windows 7,</p>\n\n<p>Using a none windows VCL style will cause clipping to occur at the bottom area of the program when the window is maximized which results in the border being drawn behind the windows taskbar.</p>\n\n<p>Turning off Aero does nothing.</p>\n\n<p>In Delphi XE2 there was an exact same problem except that in XE2 the clipping occurred at the top which I admit was a lot more annoying then it occurring at the bottom, nonetheless it sucks, is there a fix for the vcl to actually fit the desktop size?</p>\n\n<p><strong>Important Edit</strong>: This is definitely a glitch when drawing the border of the application, somehow the height isn't calculated correctly, for example if I use the vcl styles on a an application with borderstyle set to bsNone this glitch doesn't happen.</p>\n"},{"tags":["delphi","gui","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":142,"score":5,"question_id":12997108,"title":"Always show options dropdown in TValueListEditor","body":"<p>I'm trying to improve a GUI by reducing the amount of clicks needed to perform some actions. However, one VCL component that's bothering me is a TValueListEditor which contains a list of keys and values, all controlled by dropdowns. Selecting an options always requires three clicks, when only two are needed:</p>\n\n<p><img src=\"http://i.stack.imgur.com/TBDOd.png\" alt=\"Bad\"></p>\n\n<p>At this point in time, the topmost row has focus, and the value can be changed by using the dropdown (two clicks). However, when the user wants to edit a different key, he first has to change focus to that key before he can use the dropdown (three clicks).</p>\n\n<p>Is there any way to show the dropdown arrow on all rows to prevent that extra click?</p>\n\n<p>Here's a mockup example of what I want to achieve:</p>\n\n<p><img src=\"http://i.stack.imgur.com/oRDgo.png\" alt=\"Good\"></p>\n"},{"tags":["sql-server","sql-server-2008","delphi","delphi-xe2","ado"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":138,"score":4,"question_id":13028162,"title":"How to insert a string containing #0 in a NVARCHAR() column in MSSQL?","body":"<p>I'm sure this has a very simple solution, but I've exhausted my resources. I need to insert a bunch of <code>WideString</code> variables which may contain <code>#0</code> into a <code>NVARCHAR(1024)</code> column in MSSQL2k8. <code>#0</code> is treated as the string terminator somewhere in the transition... So, when I store <code>#6'r'#0'abc'</code>, only <code>#6'r'</code> is stored. I'm using <code>TADOQuery</code>. What can I do about this?</p>\n\n<hr>\n\n<p>Here's the code I use:</p>\n\n<pre><code>var\n  S: string;\nbegin\n  S := #6'r'#0'abc';\n  ADOQuery1.Append;\n  ADOQuery1S.Value := S;\n  { At this point, S = #6'r'#0'abc' and ADOQuery1S.Value = #6'r';}\n  ADOQuery1.Post;\nend;\n</code></pre>\n"},{"tags":["delphi","usb","hid","jedi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":1125,"score":0,"question_id":8258075,"title":"Jedi USB project read and write Delphi","body":"<p><p>I am using the Jedi usb hid component to connect to, read and write from a HID device. I have been unable to write to the device. I have been using this code.<br /></p>\n\n<pre><code>type\nTReport = Packed record\n ReportID: byte;\n Data: array [0..64] of byte;\n end;\n\nprocedure TForm1.Button1Click(Sender: TObject);\nvar\n I:integer;\n HidData:TReport;\n written:DWORD;\nbegin\nhiddata.ReportID:=0;\nhiddata.Data[0]:=0;\nhiddata.Data[1]:=$80;\n  for I := 2 to 64 do\n    hiddata.Data[I]:=$FF;\ncurrentdevice.WriteFile(hiddata,currentdevice.Caps.OutputReportByteLength,written);\nend;\n</code></pre>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":110,"score":4,"question_id":13043343,"title":"How to have text as my drag cursor?","body":"<p>When drag / dropping text between two components, is there a simple way to show the text that I am dragging as the drag cursor?</p>\n"},{"tags":["algorithm","delphi","delphi-xe2","permutation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":108,"score":-2,"question_id":13040345,"title":"Function returning permutations of array in delphi","body":"<p>I am trying to implement a function in delphi that takes an array of int digits on input and generates an array of all possible permutations of these digits, and omitting these that start with zero. So for <code>[1, 2, 3]</code> it is <code>[123, 132, 213, 231, 312, 321]</code> and for <code>[1,2,0]</code> it returns <code>[120, 102, 210, 201]</code>. I tried this code: <a href=\"http://rosettacode.org/wiki/Permutations#Delphi\" rel=\"nofollow\">Implementation on RosettaCode</a>, but I want a single function that returns an array, and this code works differently. I tried to somehow adapt this function to my program, whose code is here:</p>\n\n<pre><code>unit Program;\n\ninterface\n\nuses\n  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,\n  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;\n\ntype\n  TItem = Integer;                // declare ordinal type for array item\n  TArray = array[0..3] of TItem;\n  TForm3 = class(TForm)\n    Edit1: TEdit;\n    Button1: TButton;\n    Label1: TLabel;\n    Memo1: TMemo;\n    ListBox1: TListBox;\n\n    procedure Button1Click(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\n\nvar\n  Form3: TForm3;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm3.Button1Click(Sender: TObject);\n\ntype\n  TIdArray = array of Integer;\n  TPowerSet = array of TIdArray;\n\nprocedure Permutation(K: Integer; var A: array of integer);\nvar\n  I, J: Integer;\n  Tmp: TItem;\n\nbegin\n  for I:= Low(A) + 1 to High(A) + 1 do begin\n    J:= K mod I;\n    Tmp:= A[J];\n    A[J]:= A[I - 1];\n    A[I - 1]:= Tmp;\n    K:= K div I;\n  end;\nend;\n\nfunction PowerSet(Ids: TIdArray): TPowerSet;\nvar\n  TotalCombinations: Integer;\n  TotalItems: Integer;\n  Combination: Integer;\n  SourceItem: Integer;\n  ResultItem: Integer;\n  Bit, Bits: Integer;\nbegin\n  TotalItems := Length(Ids);\n\n  // Total number of combination for array of n items = 2 ^ n.\n  TotalCombinations := 2 shl (TotalItems - 1);\n\n  SetLength(Result, TotalCombinations);\n\n  for Combination := 0 to TotalCombinations - 1 do\n  begin\n    // The Combination variable contains a bitmask that tells us which items\n    // to take from the array to construct the current combination.\n    // Disadvantage is that because of this method, the input array may contain\n    // at most 32 items.\n\n    // Count the number of bits set in Combination. This is the number of items\n    // we need to allocate for this combination.\n    Bits := 0;\n    for Bit := 0 to TotalItems - 1 do\n      if Combination and (1 shl Bit) &lt;&gt; 0 then\n        Inc(Bits);\n\n    // Allocate the items.\n    SetLength(Result[Combination], Bits);\n\n    // Copy the right items to the current result item.\n    ResultItem := 0;\n\n    for SourceItem := 0 to TotalItems - 1 do\n      if Combination and (1 shl SourceItem) &lt;&gt; 0 then\n      begin\n        Result[Combination][ResultItem] := Ids[SourceItem];\n        Inc(ResultItem);\n      end;\n  end;\n\nend;\n\nvar\n  first_counter, second_counter: integer;\n  int_array: TIdArray;\n  power_set: TPowerSet;\n  permutation_array: array[1..1000] of integer;\n  A: array of Integer;\n  I, K, Count, main_counter: Integer;\n  S1, S2: ShortString;\n\nbegin\n  SetLength(int_array, Length(Edit1.Text));\n  for I := 0 to (Length(Edit1.Text)-1) do\n    begin\n      int_array[I] := strtoint(Edit1.Text[I+1]);\n    end;\n begin\n  power_set := PowerSet(int_array);\n  main_counter := 0;\n      for first_counter := 0 to Length(power_set)-1 do\n        begin\n          for second_counter := 0 to Length(power_set[first_counter])-1 do\n            begin\n              Listbox1.Items.Add(inttostr(power_set[first_counter][second_counter]));\n              Setlength(A, Length(power_set[first_counter]));\n              Count:= 1;\n              I:= Length(A);\n              while I &gt; 1 do begin\n                Count:= Count * I;\n                Dec(I);\n              end;\n\n              for K:= 0 to Count - 1 do begin\n                for I:= 0 to Length(A)-1 do begin\n                  A[I]:= power_set[first_counter][I];\n                end;\n                Permutation(K, A);\n                S1:= '';\n                for I:=Low(A) to High(A) do begin\n                  Str(A[I]:1, S2);\n                  S1:= S1 + S2;\n                end;\n                permutation_array[main_counter] := strtoint(S1);\n                Inc(main_counter);\n              end;\n            end;\n          Listbox1.Items.Add('----');\n        end;\n        for I := Low(permutation_array) to Length(permutation_array) do\n          begin\n          if permutation_array[I] &lt;&gt; 0 then\n            Memo1.Lines.Add(inttostr(permutation_array[I]));\n          end;\n        end;\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","file-io","bitmap"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13044396,"title":"Delphi isn't writing my file header properly","body":"<p>I thought instead of using TImage with an 8bit BMP I'd save my own Bitmap - which I have done with Delphi a few times before. But for some reason I cannot figure out, the first two bytes of the file is always written as four bytes!\nMy record for the header is</p>\n\n<pre><code>type\n BitmapH = Record\n  head : WORD;\n  filesize : DWORD;\n  reserved : DWORD;\n  bmpoffset : DWORD;\n  bmpheadersize : DWORD;\n  width : DWORD;\n  height : DWORD;\n  planes : WORD;\n  bpp : word;\n  comp : longint;\n  bmdatasize : longint;\n  hres : longint;\n  vres : longint;\n  numofcolors : longint;\n  importantcolors : longint;\n  palette : array[0..1023] of byte;\n end;\n</code></pre>\n\n<p>I've tried even changing it to a 2 byte array still no go. Even with it changed to just head : byte; it still writes 1 byte then pushes junk to the next 3. I must be missing something simple!</p>\n\n<p>Here's how I am writing the file header -</p>\n\n<pre><code>var BM : file of BitmapH;\nvar BMD : file of byte;\nvar header : BitmapH;\nvar i : integer;\nvar test : byte;\nbegin\n\n  AssignFile(BM, 'd:\\test.bmp');\n  Rewrite(BM);\n\n  header.head := 19778;\n//  header.head[1] := 'M';\n  header.filesize := 2102;\n  header.reserved := 0;\n  header.bmpoffset := 1080;\n  header.bmpheadersize := 40;\n  header.width := 32;\n  header.height := 32;\n  header.planes := 1;\n  header.bpp := 8;\n  header.comp := 0;\n  header.bmdatasize := 1024;\n  header.hres := 100;\n  header.vres := 100;\n  header.numofcolors := 0;\n  header.importantcolors := 0;\n\n  for i := 0 to 255 do\n  begin\n    header.palette[i*4] := getBvalue(palette[i]);\n    header.palette[(i*4) + 1] := getBvalue(palette[i]);\n    header.palette[(i*4) + 2] := getBvalue(palette[i]);\n    header.palette[(i*4) + 3] := 0;\n  end;\n\n  Write(BM, header);\n</code></pre>\n\n<p>Sorry for the crudeness, it's just a test :)</p>\n\n<p>Any help is appreciated!</p>\n\n<p>PS - The reason for not using TImage to save is because I am changing the palette on the fly which seems like a hassle to edit via TImage.</p>\n"},{"tags":["delphi"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":240,"score":2,"question_id":10635329,"title":"How to insert character in all possible positions of a string?","body":"<p>I want to insert a char into every possible position of s string except start and end.\ne.g. </p>\n\n<pre><code>abc\nI want to have \na-bc\nab-c\na-b-c\n</code></pre>\n\n<p>Below is my test, but not correct: </p>\n\n<pre><code>procedure TForm1.Button2Click(Sender: TObject);\nvar\nstart, i,j,k,position,loop: integer;\nlaststart,lastend:integer;\nc,item,stem:string;\nstr, prefix:string;\nbegin\nstr:='abcd';\nmemo1.clear;\nmemo1.Lines.Add(str);\nlaststart:=0;\nlastend:=memo1.lines.count-1;\nposition:=0;\nprefix:='';\nloop:=0;\nwhile loop&lt;=length(str)-1 do\n  begin\n\n    for j:= laststart to lastend do\n    begin\n    item:=memo1.lines[j];\n        for k:=length(item) downto 1 do\n        begin\n            if item[k]='-' then\n            begin\n            position:=j;\n            break;\n            end;\n         end;  //for k\n   prefix:=copy(item,1,position);\n   stem:=copy(item,position+1, length(item));\n\n        for start:=1 to length(stem)-1 do\n        begin\n        c:=prefix+copy(stem,1,start)+'-'+\n        copy(stem, start+1,length(stem));\n        memo1.lines.add(c);\n        end;\n     end; //for j\n    laststart:=lastend+1;\n    lastend:=memo1.Lines.Count-1;\ninc(loop);\nend; //end while\n\nend;\n</code></pre>\n\n<p>it outputs: </p>\n\n<pre><code>abcd\na-bcd\nab-cd\nabc-d\na--bcd // not correct\na-b-cd\na-bc-d\nab--cd //incorrect\nab-c-d\nabc--d  //incorrect\na--bc-d //incorrect\n</code></pre>\n\n<p>I feel the maximum possible breaks is lenth(str)-1, abc->most possible is insert 2 '-' (twice). Is this correct?</p>\n\n<p>And are there other faster ways to do it?</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["delphi","documentation","delphi-2009"],"answer_count":6,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":797,"score":5,"question_id":785197,"title":"HTML Doc Tool for Delphi 2009","body":"<p>Is there any free HTML creating documentation tool that fully understands Delphi 2009 features like generics and anonymous methods?</p>\n\n<p>I tried DelphiCodeToDoc but it crashes while parsing the source code.</p>\n"},{"tags":["delphi","comments","freepascal","code-documentation","docblocks"],"answer_count":6,"favorite_count":7,"up_vote_count":5,"down_vote_count":0,"view_count":1109,"score":5,"question_id":750810,"title":"Most common docblock for Delphi and/or FreePascal code","body":"<p>I'm quite familiar with PHP dockblocks since it's been my job for the last 15+ years.</p>\n\n<pre><code>/**\n  * Description\n  *\n  * @tag bla bla\n  * @tag more bla bla\n  */\n</code></pre>\n\n<p>What I'm trying to understand is if there is a standard like that for Delphi and/or FreePascal.</p>\n\n<p>From my analysis on an awful lot of code I never seen any, but I could be dead wrong.</p>\n"},{"tags":["delphi","documentation"],"answer_count":9,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":2187,"score":15,"question_id":33336,"title":"Documenting Delphi","body":"<p>Is there a good tool for scanning a Delphi project and organising the units, forms etc. Maybe it could go down to procedure level and say output to Word or RTF.</p>\n\n<p>This would allow me to get a first cut documentation going for a large product.</p>\n"},{"tags":["delphi","documentation"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":207,"score":2,"question_id":7993009,"title":"Multiple Delphi doc from source","body":"<p>For some open source projects in Delphi 7, I use to comment some informations, NOT only about the code itself, but about the software usage, in my source code that I would now to have in a readable doc for the customers or other dev team peoples.\nThe informations may be :</p>\n\n<ul>\n<li>API interface description</li>\n<li>List of errors numbers</li>\n<li><p>Versions Number  like : </p>\n\n<pre><code>//@@ V 3.9.6 +Add a new function\n//@@ V 3.9.6 -Bug 8987 fixed\n</code></pre></li>\n</ul>\n\n<p>Is there any free or open source documentation tool that I can configure to obtain multiple documentations from the same project with my own tags?\nI am ready to change my tag syntax (for JavaDoc or other).</p>\n\n<p>I don't want to have informations or tools about 'how to document bugs and versions' (consider my example as...an example), just feedback to 'how to make different docs from source with different tags' </p>\n"},{"tags":["delphi","delphi-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":124,"score":4,"question_id":8985661,"title":"Delphi 2007: IDE Model View: Generate Documentation missing?","body":"<p>In my Delphi 2007 IDE I've activated Model Support.<br>\nIn the Model View, I can see all my classes and open an UML diagram for those classes.\nBut how can I generate documentation?<br>\nThere is no <code>Generate Documentation</code> in the Tools dialog, and also none when I right-click items in the Model View.<br>\nWhat am I missing?</p>\n"},{"tags":["delphi","javadoc","sandcastle"],"answer_count":8,"favorite_count":11,"up_vote_count":7,"down_vote_count":0,"view_count":4720,"score":7,"question_id":236047,"title":"Code documentation for delphi similar to javadoc or c# xml doc","body":"<p>I need a code documentation tool similar to javadoc or c# xml doc for delphi code. What is  the best tool? I prefer a technology, which is in the future compatible to the Microsoft sandcastle project.</p>\n"},{"tags":["delphi","documentation"],"answer_count":7,"favorite_count":5,"up_vote_count":4,"down_vote_count":0,"view_count":1050,"score":4,"question_id":673248,"title":"Is there a Delphi code documentor that supports current Delphi syntax?","body":"<p>I am looking for a code documentation tool like PasDoc that supports the Delphi 2007 syntax, in particular nested types.</p>\n\n<p>I checked PasDoc and DelphiDoc but they do not support it.</p>\n\n<p>I don't like the syntax of the builtin XMLDoc but would prefer something more JavaDoc like (that is: Shorter tag syntax, not quite as verbose as</p>\n\n<pre><code>&lt;summary&gt;\n...\n&lt;param&gt;\n...\n</code></pre>\n\n<p>etc.)</p>\n"},{"tags":["delphi","documentation","ndoc"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":460,"score":6,"question_id":53198,"title":"HelpInsight documentation in Delphi 2007","body":"<p>I am using D2007 and am trying to document my source code, using the HelpInsight feature (provided since D2005).  I am mainly interested in getting the HelpInsight tool-tips working.  From various Web-surfing and experimentation I have found the following:</p>\n\n<ol>\n<li>Using the triple slash (///) comment style works more often than the other documented comment styles. i.e.:  <code>{*! comment *}</code> and <code>{! comment }</code></li>\n<li>The comments must precede the declaration that they are for.  For most cases this will mean placing them in the interface section of the code. (The obvious exception is for types and functions that are not accessible from outside the current unit and are therefore declared in the implementation block.)  </li>\n<li>The first comment cannot be for a function. (i.e. it must be for a type - or at least it appears the parser must have seen the \"type\" keyword before the HelpInsight feature works)</li>\n</ol>\n\n<p>Despite following these \"rules\", sometimes the Help-insight just doesn't find the comments I've written. One file does not produce the correct HelpInsight tool-tips, but if I include this file in a different dummy project, it works properly.</p>\n\n<p>Does anyone have any other pointers / tricks for getting HelpInsight to work?</p>\n"},{"tags":["delphi","windows-7","oracle11g","dbexpress"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":13037676,"title":"Why does reconnecting to an Oracle database via dbExpress cause an access violation?","body":"<p>I have a Delphi 2006 application running on Windows 7 that connects to an Oracle database via dbExpress using an Oracle 11 client install. After the first connect, I can query data and everything works as expected. However, when I disconnect and then re-connect, I get the following error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Exception EAccessViolation in module orageneric11.dll at 00450EB5. \nAccess violation at address 048A0EB5 in module 'orageneric11.dll'.\nRead of address 00000038\n</code></pre>\n\n<p>The same application is running fine on Windows XP using an Oracle 10 client install (unfortunately, I don't have a test-setup with XP + Oracle 11 or Windows 7 + Oracle 10).</p>\n\n<p>I have reduced the problem to the following:</p>\n\n<pre><code>program OracleReconnectTest; \n\n{$APPTYPE CONSOLE} \n\nuses\n  SysUtils,\n  SqlExpr; \n\nvar\n  connection: TSQLConnection;\n\nbegin\n  connection := TSQLConnection.Create( nil );\n  connection.DriverName := 'Oracle';\n  connection.LibraryName := 'dbxora30.dll';\n  connection.VendorLib := 'oci.dll';\n  connection.GetDriverFunc := 'getSQLDriverORACLE';\n  connection.LoginPrompt := False;\n  connection.Params.Text :=\n    'DATABASE=TheDatabase' + #$D#$A +\n    'USER_NAME=TheUser' + #$D#$A +\n    'PASSWORD=ThePassword' + #$D#$A +\n    'DECIMAL SEPARATOR=,'; \n\n  connection.Connected := True; \n\n  Writeln( 'Connected once, press ENTER to disconnect and reconnect' );\n  Readln; \n\n  connection.Connected := False;\n  connection.Connected := True; // &lt;- access violation on Windows 7 + Oracle 11\n\n  Writeln( 'Reconnected, press ENTER to exit' );\n  Readln;\nend.\n</code></pre>\n\n<p>I suppose this rules out a problem with my application code. I have stepped through the dbExpress code that comes with Delphi, but haven't encountered anything that looks wrong or would explain this.</p>\n\n<p>So I haven't been able to find anything that indicates this to be a bug in either dbExpress or the Oracle driver. Hence I wouldn't know whether to file a bug against with Embarcadero and/or Oracle.</p>\n\n<p>The version of <code>orageneric11.dll</code> is <code>11.2.0.1</code>, and <code>dbxora30.dll</code> is version <code>10.0.2151.25345</code>.</p>\n\n<p>Because it has caused problems when multiple client versions were installed in parallel, the machine in question only has the 11 client. Using Process Explorer, I have verified that only DLLs from the 11 client are used.</p>\n\n<p>Has anybody else encountered this issue and can point me in the right direction?</p>\n"},{"tags":["delphi","console-application"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":5,"view_count":164,"score":-1,"question_id":13042036,"title":"How do I hide the console window?","body":"<p>I have a basic console window. It is blank and all my program does is run though sockets to a host computer. How do I make the black console window not visible?</p>\n\n<p>I'm using Delphi 2007.</p>\n"},{"tags":["delphi","mouseevent","menuitem"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":13041782,"title":"Detect left/right mouse button on menu item click?","body":"<p>In Delphi XE2, how can I detect if the user clicked a popup menu item with the left or with the right mouse button?</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":147,"score":5,"question_id":13038373,"title":"How can I change the caption of a modal form without access to the source?","body":"<p>I have a third party component that displays a print preview form. I would like to change the caption of the preview form to something more appropriate. Unfortunately I do not have the source for the third party component and the component does not provide the functionality.</p>\n\n<p>Is it possible to somehow catch the modal form as it is being displayed and set it's properties before it is shown?</p>\n"},{"tags":["delphi","variables","initialization"],"answer_count":10,"favorite_count":7,"up_vote_count":38,"down_vote_count":0,"view_count":12704,"score":38,"question_id":132725,"title":"Are delphi variables initialized with a value by default?","body":"<p>I'm new to Delphi, and I've been running some tests to see what object variables and stack variables are initialized to by default:</p>\n\n<pre><code>TInstanceVariables = class\n  fBoolean: boolean; // always starts off as false\n  fInteger: integer; // always starts off as zero\n  fObject: TObject; // always starts off as nil\nend;\n</code></pre>\n\n<p>This is the behaviour I'm used to from other languages, but I'm wondering if it's safe to rely on it in Delphi?  For example, I'm wondering if it might depend on a compiler setting, or perhaps work differently on different machines.  Is it normal to rely on default initialized values for objects, or do you explicitly set all instance variables in the constructor?</p>\n\n<p>As for stack (procedure-level) variables, my tests are showing that unitialized booleans are true, unitialized integers are 2129993264, and uninialized objects are just invalid pointers (i.e. not nil).  I'm guessing the norm is to always set procedure-level variables before accessing them?</p>\n"},{"tags":["html","delphi","editor","wysiwyg"],"answer_count":8,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":8151,"score":11,"question_id":2146116,"title":"WYSIWYG HTML Editor Component for Delphi","body":"<p>I need to send Email from my Delphi application. What I need is a WYSIWYG editor that I can use in the application to create the body of the email in HTML. Any ideas? Thanks, Pieter.</p>\n"},{"tags":["delphi","listview"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":13040587,"title":"Delphi, ListView, how to remove the margin between items in vsIcon","body":"<p>Using Delphi XE3, Listview in vsIcon mode with an imagelist assigned.</p>\n\n<p>I add a few items and assign them an ImageIndex, and there is a very large spacing/margin between each image/item, how can I change that? Is it possible at all without custom drawing?</p>\n"},{"tags":["delphi","documentation-generation"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":514,"score":4,"question_id":4704690,"title":"Using Doc-O-Matic (Express) with Delphi","body":"<p>I am looking for a tool to generate Delphi source code documentation, and I want to give a try to <a href=\"http://www.doc-o-matic.com/editions.html\" rel=\"nofollow\">Doc-O-Matic</a> Express (which is free). Are there any guidelines for beginners how to use Doc-O-Matic Express to document Delphi source code (managing doc-o-matic projects, preferred docblock style, complete docblock syntax, etc) ?</p>\n"},{"tags":["excel","delphi","excel-2010","office-automation"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":13037007,"title":"How can I avoid Excel show Save dialog when automation app exits","body":"<p>I have a excel automation application written in Delphi, that accesses a given excel workbook and extracts applying some internal logic different data of the sheets. </p>\n\n<p>It has worked perfectly for years on Excel 2003 and 2007. </p>\n\n<p>Recently some users have Excel 2010. On those users, when my application exits, Excel shows a dialog box asking the user to Save the unmodified worksheet. The message says something about versions of the formulas to be saved in a new 2010 format. Sorry I don't have the exact words because it is not an english office package. </p>\n\n<p>How can my app prevent excel 2010 showing this annoying and useless box? </p>\n\n<p>Most of the users have Excel 2007, so most of the files that my application needs to process, regardless of the actual Excel version of the user running my app, are in that format, and will be in the future, so migrating all the files is not an option.</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":52,"score":-1,"question_id":13029479,"title":"Delphi 2010 - Cannot find components","body":"<p>I need the following libraries. Don't know the names, but their DCU files are these:</p>\n\n<p>ODSI \nOCL</p>\n\n<p>I would appreciate your help.\nPlease let me know if you've heard about it before.</p>\n\n<p>Thank you.</p>\n"},{"tags":["image","delphi","pointers","sender"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":66,"score":5,"question_id":13035693,"title":"Delphi 7:Attach Image to Mouse","body":"<p>I want a derivate of TImage follow the Cursor when it has been clicked and stop following when it gets clicked again.\nFor this, I created a pointer, named 'Attached', that points to a TImage or a derivate.</p>\n\n<pre><code>var Attached: ^TImage;\n</code></pre>\n\n<p>I also set the derivate of Timage to call the procedure ChangeAttachState when its clicked.</p>\n\n<p>Now, in the ChangeAttachState procedure I want to change the pointer that it points on the clicked Image or point to nil when an Image was already attached. In Code:</p>\n\n<pre><code>procedure TForm1.ChangeAttachState(Sender:TObject);\nbegin\n  if Attached = nil then\n    Attached := @Sender\n  else\n    Attached := nil;\nend;\n</code></pre>\n\n<p>However, the line 'Attached := @Sender' does not seem to work, causing an Access violation when I want to use the pointer to i.e. move the Image to the Right.</p>\n\n<p>I think the pointer points at a wrong location. How can I make the pointer point at the correct save adress or make the clicked Image follow the mouse with other methods?</p>\n\n<p><em>(I hope I used the right technical terms, as English is not my native language)</em></p>\n"},{"tags":["delphi","windows-7","registry","antivirus"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13016267,"title":"Registry \"forgetting\" values","body":"<p>My software stores some values in HKCU\\Software\\mysoftware which has never been a problem. However, I now also store some values in HKCU\\Software\\mysoftware\\Licenses - ie a subdirectory of the existing data. However, 24 hours later those values simply disappear.</p>\n\n<p>I put logging in my software to check it wasn't deleting the keys and there are no log entries, which is quite expected as the software isn't even running. Somebody suggested using process viewer (from Microsoft) which can trace registry events: however, that gave up working (too many events, even though I'm only watching HKCU\\Software\\mysoftware registry events) so I'm still no closer to finding <em>what</em> is deleting those keys!</p>\n\n<p>I use Avast! anti-virus which somebody else suggested could be a culprit. The actual keys are of the form REG_SZ with \"[keyname]=[base64string]\". Nothing fancy, around 150 characters. A few hours after the software is closed I can use registry editor to see those values. But sometime later, they're gone! I rarely reboot.</p>\n\n<p>So what else could be deleting the keys?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here's the Delphi 6 code:</p>\n\n<pre><code>procedure XXX;\nvar\n    registry : TRegistry;\n    code : string;\nbegin\n    try\n        registry := TRegistry.Create;\n        if registry.OpenKey(REGISTRY_ROOT, true) then begin\n            code := [...a base64 string, around 150 chars on average...];\n            registry.WriteString(simname, code);\n        end;\n    finally\n        FreeAndNil(registry);\n    end;\nend;\n</code></pre>\n"},{"tags":["web-services","delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":62,"score":2,"question_id":13034454,"title":"How do I authenticate with the QualityCentral SOAP service?","body":"<p>In the web service description for the SOAP service (at <a href=\"http://qc.embarcadero.com/qc/coBugCGI.exe?intf=ICDSReportPublicInterface\" rel=\"nofollow\">http://qc.embarcadero.com/qc/coBugCGI.exe?intf=ICDSReportPublicInterface</a>), the login method has this signature:</p>\n\n<pre><code>base64Binary    Login(string EMail, string Passcode, string ClientID, string BDN)\n</code></pre>\n\n<p>EMail and Passcode are easy to understand, also I guess that a client may provide a client-side defined identifier and pass it as the third parameter.</p>\n\n<p>What goes into the last parameter with the name BDN?</p>\n"},{"tags":["delphi","transparency"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":13030090,"title":"How do I make an opaque control on a partly transparent form?","body":"<p>I want to make a half-transparent form but I want to put a panel on it which will not be transparent. How do I do that?</p>\n"},{"tags":["delphi","list","duplicates","delphi-xe2","tlist"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":191,"score":2,"question_id":13026787,"title":"Removing duplicates from List","body":"<p>I wrote this function to remove duplicates from a TList descendant, now i was wondering if this could give me problems in certain conditions, and how it does performance wise.</p>\n\n<p>It seems to work with Object Pointers</p>\n\n<pre><code>function TListClass.RemoveDups: integer;\nvar\n  total,i,j:integer;\nbegin\n  total:=0;\n  i := 0;\n  while i &lt; count do begin\n    j := i+1;\n    while j &lt; count do begin\n      if items[i]=items[j] then begin\n       remove(items[j]);\n       inc(total);\n      end\n      else\n        inc(j);\n    end;\n    inc(i);\n  end;\n  result:=total;\nend;\n</code></pre>\n\n<p><strong>Update:</strong>\nDoes this work faster?</p>\n\n<pre><code>function TDrawObjectList.RemoveDups: integer;\nvar\n  total,i,j:integer;\n  templist:TLIST;\nbegin\n  templist:=TList.Create;\n  total:=0;\n  i := 0;\n  while i &lt; count do\n    if templist.IndexOf(items[i])=-1 then begin\n      templist.add(i);\n      inc(i);\n    end else begin\n      remove(items[i]);\n      inc(total);\n    end;\n  result:=total;\n  templist.Free;\nend;\n</code></pre>\n\n<p>You do need another List.</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":102,"score":1,"question_id":13031811,"title":"Difference between datetimes in Hours, Mins, Seconds","body":"<p>I am trying to get the difference between two datetimes and display it in string  as hh:mm</p>\n\n<pre><code>q.parambyname('vstart').asdatetime:=  vstart;\nq.parambyname('vend').asdatetime:= vend;\nd:= vend-vstart;\nmins:= d * 1440;\nq.ParamByName('mins').asBCD:= mins;\n</code></pre>\n\n<p>currently the database stores it in minutes</p>\n\n<p>example (0.39)</p>\n\n<p>I would like to then take it from database and display it in the string format hh:mm</p>\n"},{"tags":["delphi","delphi-7","game","duplication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":157,"score":0,"question_id":13014091,"title":"How to add more objects to my form without adding the same amount of code","body":"<p>I have been making a small game for fun. In the game you are a small spaceship(an image) that shoots lazer beams(shape) at an object(panel). At this moment u can only fire one lazer beam at a time because there is only one lazer beam(shape) and there is only one object(panel) to shoot. So with the coding I have I would like to know how I can add more lazer beams and objects but especially lazer beams because I don't want to repeat the procedures for each lazer beam and for each panel.</p>\n\n<p>Here is the code.</p>\n\n<pre><code>unit Unit1;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, ExtCtrls, StdCtrls, jpeg;\n\ntype\n  TForm1 = class(TForm)\n    Panel1: TPanel;\n    Timer1: TTimer;\n    Timer2: TTimer;\n    Button1: TButton;\n    Shape1: TShape;\n    Timer3: TTimer;\n    Image1: TImage;\n    procedure Timer2Timer(Sender: TObject);\n    procedure Button1Click(Sender: TObject);\n    procedure FormActivate(Sender: TObject);\n    procedure FormMouseWheelDown(Sender: TObject; Shift: TShiftState;\n      MousePos: TPoint; var Handled: Boolean);\n    procedure FormMouseWheelUp(Sender: TObject; Shift: TShiftState;\n      MousePos: TPoint; var Handled: Boolean);\n    procedure Timer3Timer(Sender: TObject);\n    procedure FormMouseDown(Sender: TObject; Button: TMouseButton;\n      Shift: TShiftState; X, Y: Integer);\n  private\n    { Private declarations }\n  public\n   procedure StartPanelAnimation1;\n   procedure DoPanelAnimationStep1;\n   function  PanelAnimationComplete1: Boolean;\n   procedure Startlazeranimation1;\n   procedure DolazeranimationStep1;\n   { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n var key : char;\n{$R *.dfm}\n\n{ TForm1 }\n\n\n\n{ TForm1 }\n\nprocedure TForm1.DoPanelAnimationStep1;\nbegin\nPanel1.Top := Panel1.Top+1;\nend;\n\nfunction TForm1.PanelAnimationComplete1: Boolean;\nbegin\n Result := Panel1.Top=512;\nend;\n\nprocedure TForm1.StartPanelAnimation1;\nbegin\n  Panel1.Top := 0;\n  Timer1.Interval := 1;\n  Timer1.Enabled := True;\nend;\n\nprocedure TForm1.Timer2Timer(Sender: TObject);\nbegin\n DoPanelAnimationStep1;\n  if PanelAnimationComplete1 then\n    StartPanelAnimation1;\n   if (shape1.Top &lt; panel1.Top) and (shape1.Left &lt; panel1.Left+104) and (shape1.Left &gt; panel1.Left)   then\n   begin\n    startpanelanimation1;\n   sleep(10);\n   end;\nend;\n\nprocedure TForm1.Button1Click(Sender: TObject);\nbegin\n button1.Hide;\n  key := 'a';\n  timer2.Enabled := true;\n  StartPanelAnimation1; \nend;\n\nprocedure TForm1.FormActivate(Sender: TObject);\nbegin\n shape1.Visible := false;\n timer3.Enabled := false;\n timer2.Enabled := false;\n end;\n\nprocedure TForm1.FormMouseWheelDown(Sender: TObject; Shift: TShiftState;\n  MousePos: TPoint; var Handled: Boolean);\n   begin\nimage1.Left := image1.Left-10;\nend;\n\n procedure TForm1.FormMouseWheelUp(Sender: TObject; Shift: TShiftState;\n  MousePos: TPoint; var Handled: Boolean);\n    begin\n  image1.Left := image1.Left+10;\nend;\n\nprocedure TForm1.DolazeranimationStep1;\nbegin\n shape1.Top := shape1.Top-10;\nend;\n\n\n procedure TForm1.Startlazeranimation1;\n begin\n shape1.Top := image1.Top;\n shape1.Left := image1.Left+55;\n shape1.Visible := true;\n  Timer3.Interval := 1;\n  Timer3.Enabled := True;\nend;\n\nprocedure TForm1.Timer3Timer(Sender: TObject);\nvar k : integer;\nbegin\n DolazeranimationStep1;\n  if (shape1.Top &lt; panel1.Top) and (shape1.Left &lt; panel1.Left+104) and (shape1.Left &gt; panel1.Left) or         (shape1.Top=clientheight) then\n   begin\n    timer3.Enabled := false;\n    shape1.Visible := false;\n    for k := 1 to 5 do\n    sleep(1);\n    begin\n    application.ProcessMessages;\n    end;\n    shape1.Top := 0;\n    shape1.Left := 0;\n   end;\nend;\n\nprocedure TForm1.FormMouseDown(Sender: TObject; Button: TMouseButton;\n  Shift: TShiftState; X, Y: Integer);\nbegin\n shape1.Show;\n startlazeranimation1;\nend;\n\nend.\n</code></pre>\n\n<p>(The above is the old code) </p>\n\n<p>I have successfully done what Stijn Sanders suggested. But now in this if </p>\n\n<pre><code> if (Shape1.top &lt; panel1.Top) and (shape1.Left &lt; panel1.Left+104) and (shape1.Left &gt; panel1.Left)   then\n</code></pre>\n\n<p>never tests true because shape1 never passes panel1 it, only the shape created on on click passes the panel.</p>\n\n<p>So is there another way to test if the shape is at the pnael.</p>\n"},{"tags":["mysql","delphi","zeos"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":108,"score":1,"question_id":11875687,"title":"Can we create a virtual table with temporary information from the select command (not other tables)?","body":"<p>I need to fill up a TDBLookupComboBox with the options for a ENUM column:</p>\n\n<pre><code>MOD_MARKETING       ENUM('NENHUMA','CONSULTAR','CADASTRAR','GERENCIAR')\n</code></pre>\n\n<p>But I do not want to create a new table in the database project just for that.\nI don't want to use assistant tables. Only tables with the user content.</p>\n\n<p>So, how may I create a temporary virtual table every time I open my application and put those four rows without touch the database structure on the server?</p>\n"},{"tags":["delphi","set","combinations"],"answer_count":2,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":164,"score":8,"question_id":13018641,"title":"Power set of an array in Delphi","body":"<p>I'm trying to write a function that will take an array on input and return array of arrays, containing all possible subsets of input array (power set without empty element). For example for input: <code>[1, 2, 3]</code> the result would be <code>[[1], [2], [3], [1, 2], [1, 3], [2, 3], [1, 2, 3]]</code>.</p>\n\n<p>This function does the job in python:</p>\n\n<pre><code>def list_powerset(lst):\n    result = [[]]\n    for x in lst:\n        result += [subset + [x] for subset in result]\n    result.pop(0)\n    return result\n</code></pre>\n\n<p>But I'm looking for implementation of it in Delphi. Is this possible to accomplish this way or should I look for something else?</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":13028962,"title":"Compiling .dproj files from command line","body":"<p>I am using Embarcadero Delphi XE2 and I've got a project that I want to compile from command line. I managed to do it with dcc32 on a .dpr, but I had to set some settings.</p>\n\n<p>From what I think, the file .dproj has all the necessary paths and stuff so I wouldn't need to set those variables, so my question is:</p>\n\n<p>Is it possible to compile a delphi command line project from a .dproj file?</p>\n\n<p>Greetings.</p>\n"},{"tags":["windows","delphi"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1438,"score":5,"question_id":1078179,"title":"Windows and Hints in Delphi","body":"<p>This morning I finally made my mind and decided to ask you for help. Problem is that in my Delphi application no hints are shown at all...\nI have read about THintAction problem, I have read guides/tutorials/manuals, tried to invoke Hint windows ( firing event handlers ) manually, but nothing worked. They just doesnt show.\nI have run out of ideas ...</p>\n\n<p>I have tried to: setting parent showhints on components, forms, from event handlers, application activatehint() ...</p>\n\n<p>Is there any other way to do this ( except API calls, of course )? </p>\n"},{"tags":["delphi","serial-port","hardware","virtualization","parallel-port"],"answer_count":4,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":997,"score":9,"question_id":589765,"title":"Best VM for Delphi development with parallel port","body":"<p>I see that a number of people are doing S/W development (not just Delphi) using a virtual machine to host the IDE and all required files. I've used Microsoft Virtual PC to debug issues with my Applications on various OS's but with little access 'outside' the VM. My applications use USB, serial and - crucially - direct I/O writes to hardware (via an I/O permission driver). I'd like to have the VM see all of this (only one VM would run at a time of course). Is this possible? Is there a preference of Virtual PC versus VMWare?</p>\n"},{"tags":["delphi","firemonkey"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":146,"score":3,"question_id":12454765,"title":"How to change font size at StringGrid in FM2","body":"<p>How to change font size at StringGrid in rad studio XE3 - FM2 Firemonkey 2 not firemonkey 1</p>\n"},{"tags":["delphi","batch","console"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2401,"score":0,"question_id":771451,"title":"launch a gui program from windows console and then make it 'detach' itself","body":"<p>I'm trying to modify a legacy Delphi 5 app so that it can be launched either from it's icon/via Explorer, or from the console (command-line). When it gets launched from the console, I want the program to detach itself from the console process, so that the console can continue to execute other instructions without waiting for my program to terminate.</p>\n\n<p>I want to use it in a 'batch' file, such that I might have;</p>\n\n<pre>\n@echo off\nrem step 1 - do some stuff here\nrem\nrem step 2 - launch my app\nc:\\myfolder\\myapp\nrem\nrem step 3 - do some more stuff here\n</pre>\n\n<p>and that the console process moves on to step 3 straight after launching my app in step 2.</p>\n\n<p>I'm sure I've done this before, many years ago, but I'm puzzled as to what exactly I did. I don't want to write a tiny console app 'launcher' for my main Windows app - I'm 95% sure that there was a way of doing this within a 'normal' Delphi GUI app. </p>\n\n<p>I guess I could use vbscript or powershell or something to 'execute' my program with some kind of 'nowait' parameter but the client is familiar with batch files and I don't really want to upset the applecart by suggesting he change his scripts or install additional stuff - I'm making changes to the executable anyway and it would be great to tick this box for him too. </p>\n\n<p>Anyone? :-) </p>\n"},{"tags":["delphi","events","tstringgrid"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1745,"score":5,"question_id":5055811,"title":"How can I detect when a user is finished editing a TStringGrid cell?","body":"<p>I would like to return the contents of a cell in a string grid when the user finishes entering the data. The user is finished when pressing the enter key on the keyboard, or single- or double-clicking another cell.</p>\n\n<p>In Lazarus there is a method of FinishedCellEditing, but not in Delphi. How can I detect it in Delphi?</p>\n"},{"tags":["delphi","tmemo"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":196,"score":1,"question_id":13003927,"title":"Memo and create file and folder?","body":"<p>I'm new to Delphi and i'm a french user so sorry for my bad english...</p>\n\n<p>So it is possible to <em>create a file</em> written in <strong>TMemo</strong>?</p>\n\n<pre><code>test.txt\ndir1/dir2/text.txt\ndir3/\n</code></pre>\n\n<p>My TMemo there are 3 lines, so I would like to take the first line and create the file <em>test.txt</em> in the current directory ..</p>\n\n<pre><code>2nd line: create a folder\n\n3rd line: create a folder again+files.txt\n\netc ...\n</code></pre>\n\n<p>I think to use mkdir or ForceDirectories to create Directory and files? etc...</p>\n\n<p>So my conclusion was to automate it.</p>\n\n<p>You can help me please?</p>\n\n<p>a small image so you can see:</p>\n\n<p><img src=\"http://i.stack.imgur.com/pvOu6.jpg\" alt=\"Automate create files&amp;folder\"></p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":13026294,"title":"Cant select procedure as option for event OnMouseDown","body":"<p>I have a shape, when i click OnMouseDown in Object inspecter / Events tab. I would like for it to do the procedure \"SelectMessage\"  But its not showing up as an option. Also if i manually type in \"SelectMessage\"  I get error Property and method Selectmessage are not compatible. </p>\n\n<p>Selectmessage</p>\n\n<pre><code>procedure TFZone1Mod7.Selectmessage(sender: TObject);\nvar\n  ShapeOrderNo: Integer;\nbegin\n  if TryStrToInt(copy(TShape(Sender).Name,6,MaxInt),ShapeOrderNo) then\n    begin\n      LookUpMessage(ShapeOrderNo);\n    end;\nend;\n</code></pre>\n\n<p>If i do </p>\n\n<pre><code>procedure TFZone1Mod7.Shape1MouseDown(Sender: TObject; Button: TMouseButton;\n  Shift: TShiftState; X, Y: Integer);\nbegin\n   selectmessage(sender);\nend;\n</code></pre>\n\n<p>then it will work. but easier to select from events if i can.\nthanks</p>\n"},{"tags":["visual-studio","delphi","tfs","visual-studio-2012","delphi-2009"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":125,"score":1,"question_id":13026384,"title":"How to create a Delphi project in a Visual Studio 2012 solution?","body":"<p>I have a heterogeneous (C#, C++) application with TFS as a versioning system.</p>\n\n<p>I need to put my Delphi code under version control. For this purpose I need to create a project in Visual Studio 2012,</p>\n\n<ol>\n<li>which should be versioned by the TFS, but</li>\n<li>not built by the Visual Studio.</li>\n</ol>\n\n<p>How can I do that?</p>\n\n<p>Is there a better way to do it than to create an empty C++ project and then disable building it?</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":13025038,"title":"Sending self is not working","body":"<p>Not sure on what to make title please edit if needed.  I have a procedure</p>\n\n<pre><code>procedure TFZone1Mod7.ChangeText(sender: TObject);\nvar\n  ShapeOrderNo: integer;\n  FoundComponent: TComponent;\nbegin\n  if TryStrToInt(copy(TShape(Sender).Name,6,MaxInt),ShapeOrderNo) then\n    begin\n      FoundComponent := FindComponent('label'+inttostr(ShapeOrderNo+12));\n      if (FoundComponent is TLabel) then\n            Label25.Caption := TLabel(FoundComponent).Caption\n      else\n          showmessage('not found');\n    end;\n  showmessage(TShape(sender).Name);\n\nend;\n</code></pre>\n\n<p>so i call the procedure on a Shape1MouseEnter.  So i would think (Self) would send shape1 but it dont it sends the form(TFZone1Mod7)  How i can get it to send the shape?\nhere  is how i am calling it.</p>\n\n<pre><code>procedure TFZone1Mod7.Shape1MouseEnter(Sender: TObject);\nbegin\n    changetext(self);\nend;\n</code></pre>\n"},{"tags":["delphi","winapi","delphi-2009"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":1,"view_count":119,"score":6,"question_id":13017111,"title":"How to get a tree view item by the hit test when RTL layout is used?","body":"<p><em><strong>Description:</em></strong></p>\n\n<p>Having a tree view in right-to-left reading mode (RTL), how to get node that was clicked knowing just the click coordinates ? Here is an interposed class, that makes the tree view to use the RTL display and that contains a click handler in which you can see the problem:</p>\n\n<pre><code>unit Unit1;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, ComCtrls, CommCtrl;\n\ntype\n  TTreeView = class(ComCtrls.TTreeView)\n  protected\n    procedure CNNotify(var Msg: TWMNotify); message CN_NOTIFY;\n    procedure CreateParams(var Params: TCreateParams); override;\n  end;\n\ntype\n  TForm1 = class(TForm)\n    TreeView1: TTreeView;\n    procedure FormCreate(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n\n{$R *.dfm}\n\n{ TTreeView }\n\nprocedure TTreeView.CNNotify(var Msg: TWMNotify);\nvar\n  Node: TTreeNode;\n  Point: TPoint;\nbegin\n  inherited;\n  if Msg.NMHdr.code = NM_CLICK then\n  begin\n    Point := ScreenToClient(Mouse.CursorPos);\n    Node := GetNodeAt(Point.X, Point.Y);\n    if Assigned(Node) then\n      ShowMessage('This message never shows...');\n  end;\nend;\n\nprocedure TTreeView.CreateParams(var Params: TCreateParams);\nbegin\n  inherited CreateParams(Params);\n  Params.Style := Params.Style or TVS_RTLREADING;\n  Params.ExStyle := Params.ExStyle or WS_EX_LAYOUTRTL or WS_EX_RIGHT;\nend;\n\n{ TForm1 }    \n\nprocedure TForm1.FormCreate(Sender: TObject);\nvar\n  Node: TTreeNode;\nbegin\n  Node := TreeView1.Items.AddChild(nil, 'Item 1');\n  TreeView1.Items.AddChild(Node, 'SubItem 1');\nend;\n\nend.\n</code></pre>\n\n<p>The problem with this code (or better to say with such tree view in RTL mode) is, that when you click the node (or wherever), the <a href=\"http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.ComCtrls.TCustomTreeView.GetNodeAt\" rel=\"nofollow\"><code>GetNodeAt</code></a> method never returns a valid node (always <code>nil</code>). For those, who don't have Delphi, the <a href=\"http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.ComCtrls.TCustomTreeView.GetNodeAt\" rel=\"nofollow\"><code>GetNodeAt</code></a> method internally calls the <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/bb773897%28v=vs.85%29.aspx\" rel=\"nofollow\"><code>TreeView_HitTest</code></a> macro which when the tree view is in RTL mode, returns <code>NULL</code> like there won't be any item. I am passing to that macro the coordinates obtained through the <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms648390%28v=vs.85%29.aspx\" rel=\"nofollow\"><code>GetCursorPos</code></a> function calculated relatively to the control by the <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/dd162952%28v=vs.85%29.aspx\" rel=\"nofollow\"><code>ScreenToClient</code></a> function.</p>\n\n<p><em><strong>Question:</em></strong></p>\n\n<p>My question is, how to get the clicked node knowing just the mouse coordinates ? How to make a hit test with the tree view in RTL mode ? Should I for instance calculate the mouse horizontal position from right, and if so, how ?</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":153,"score":0,"question_id":12969030,"title":"How to rig some Control.OnMouseEnter event with separate Label.Caption update","body":"<p>I have 12 shapes</p>\n\n<pre><code>Shape1\nShape2\n.....\nShape12\n</code></pre>\n\n<p>and I have 12 labels</p>\n\n<pre><code>Label13\nLabel14\n......\nLabel24\n</code></pre>\n\n<p>I was wondering if there is a way to write such a function, that on mouse enter on a shape would assign corresponding label to a different label, for example Label25:</p>\n\n<pre><code>Label25 :=  \nOnMouseEnter\nshape1 -&gt; label13\nshape2 -&gt; label14\n...\nshape12 -&gt; label24\n</code></pre>\n\n<p>So if the mouse entered Shape1, Label25 would become equal to Label13, and if mouse entered Shape2, Label25 would become equal to Label14 and continue till if mouse entered Shape12 Label25 would become equal to Label24. </p>\n\n<p>I know I can write </p>\n\n<pre><code>label25 := labelxx \n</code></pre>\n\n<p>on each of the mouse enter events. But thought there could be an easier way as the name of the label and shape correspond, where label # is 12 more then the shape # everytime.</p>\n\n<p>After adding the suggested,  I added this </p>\n\n<pre><code>procedure TFZone1Mod7.ChangeText(sender: TObject);\nvar\n  ShapeOrderNo: integer;\n  FoundComponent: TComponent;\nbegin\n  if TryStrToInt(copy(TShape(Sender).Name,6,MaxInt),ShapeOrderNo) then\n    begin\n      FoundComponent := FindComponent('label'+inttostr(ShapeOrderNo+12));\n      if (FoundComponent is TLabel) then\n            Label25.Caption := TLabel(FoundComponent).Caption\n      else\n          showmessage('not found');\n    end;\n  showmessage('failed try');\n\nend;\n\nprocedure TFZone1Mod7.Shape1MouseEnter(Sender: TObject);\nbegin\n    changetext(self);\nend;\n\nend.\n</code></pre>\n\n<p>but everytime its ran i get failed try. \nAm i sending the info wrong?</p>\n"},{"tags":["delphi","char","set","intersection","delphi-5"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":105,"score":3,"question_id":13017822,"title":"Intersection of two strings/ sets","body":"<p>As coming from python I'm looking for something equivalent to this python code (<a href=\"http://docs.python.org/library/sets.html\" rel=\"nofollow\">sets</a>) in delphi5:</p>\n\n<pre><code>&gt;&gt;&gt; x = set(\"Hello\")\n&gt;&gt;&gt; x\nset(['H', 'e', 'l', 'o'])\n\n&gt;&gt;&gt; y = set(\"Hallo\")\n&gt;&gt;&gt; y\nset(['a', 'H', 'l', 'o'])\n\n&gt;&gt;&gt; x.intersection(y)\nset(['H', 'l', 'o'])\n</code></pre>\n"},{"tags":["delphi","oop","interface","callback"],"answer_count":6,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":1693,"score":7,"question_id":704980,"title":"Passing Interface's method as parameter","body":"<p>is it possible to pass inetrface's method as parameters?</p>\n\n<p>I'm trying something like this:</p>\n\n<pre><code>interface\n\ntype\n  TMoveProc = procedure of object;\n  // also tested with TMoveProc = procedure;\n  // procedure of interface is not working ;)\n\n  ISomeInterface = interface\n    procedure Pred;\n    procedure Next;\n  end;\n\n  TSomeObject = class(TObject)\n  public\n    procedure Move(MoveProc: TMoveProc);\n  end;\n\nimplementation\n\nprocedure TSomeObject.Move(MoveProc: TMoveProc);\nbegin\n  while True do\n  begin\n    // Some common code that works for both procedures\n    MoveProc;\n    // More code...\n  end;\nend;\n\nprocedure Usage;\nvar\n  o: TSomeObject;\n  i: ISomeInterface;\nbegin\n  o := TSomeObject.Create;\n  i := GetSomeInterface;\n  o.Move(i.Next);\n  // somewhere else: o.Move(i.Prev);\n  // tested with o.Move(@i.Next), @@... with no luck\n  o.Free;\nend;\n</code></pre>\n\n<p>But it is not working because:</p>\n\n<blockquote>\n  <p>E2010 Incompatible types: 'TMoveProc' and 'procedure, untyped pointer or untyped parameter'</p>\n</blockquote>\n\n<p>Of course I can do private method for each call, but that is ugly. Is there any better way?</p>\n\n<p>Delphi 2006</p>\n\n<p><hr /></p>\n\n<p>Edit:\nI know that I can pass whole interface, but then I have to specify which function use. I don't want two exactly same procedures with one different call. </p>\n\n<p>I can use second parameter, but that is ugly too.</p>\n\n<pre><code>type\n  SomeInterfaceMethod = (siPred, siNext)\n\nprocedure Move(SomeInt: ISomeInterface; Direction: SomeInterfaceMethod)\nbegin\n  case Direction of:\n    siPred: SomeInt.Pred;\n    siNext: SomeInt.Next\n  end;\nend;\n</code></pre>\n\n<p><hr /></p>\n\n<p>Thanks all for help and ideas. Clean solution (for my Delphi 2006) is Diego's Visitor. Now I'm using simple (\"ugly\") wrapper (my own, same solution by TOndrej and Aikislave).</p>\n\n<p>But true answer is \"there is no (direct) way to pass interface's methods as parameters without some kind of provider.</p>\n"},{"tags":["delphi","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":157,"score":0,"question_id":13005646,"title":"Compiler Internal Error upgrading from Delphi 2009 to XE3","body":"<p>Compiling a rather large project (>750K lines) with delphi XE3 (upgrading from 2009)</p>\n\n<p>Getting the following error </p>\n\n<blockquote>\n  <p>[dcc32 Fatal Error] MainForm.pas(3170): F2084 Internal Error: URW1147</p>\n</blockquote>\n\n<p>Similar to this question, however nowhere in the code are generics used.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/9429484/what-should-i-do-about-an-internal-error-when-i-declare-a-generic-array-of-t\">internal error with generic array</a></p>\n\n<p>The error does not correspond to a line of code, but rather just the end of the file.</p>\n\n<p>I.e. after the \"end.\"</p>\n\n<p>Following a google search I have also tried all settings for \"Code inline control\", but no joy.</p>\n\n<p>Not sure where (else) to start looking and would appreciate any educated feedback (or maybe even a wild guess).</p>\n\n<p>Have not yet put in a QC report pending hopefully usefully feedback from here.</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","dunit","unit-testing"],"answer_count":6,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":358,"score":7,"question_id":4906955,"title":"How to access fields of a TTestCase in a TTestSetup class","body":"<p>I am creating unit tests with DUnit. I have a class that takes quite a long time to initialize. </p>\n\n<p>I derive a class TMyTestSetup from TTestSetup and override its Setup method. This SetUp method is only called once for all the tests in my TTestCase. I put the Initialization process in the TMyTestSetup.SetUp routine to increase performance.</p>\n\n<p>My problem is how can I access the object I want to initialize, which is a field of my TMyTest in the TestSetup class? Is the only way to do it declaring it globally?</p>\n\n<p>untested short example:</p>\n\n<pre><code>TMyTestSetup = class(TTestSetup)\n  protected\n    procedure SetUp; override;\nend;\n\nTMyTest = class(TTestcase)\npublic\n    fTakes4Ever2Init : TInits4Ever2Init;\npublished\n  procedure Test1;     \nend;\n\nimplementation\n\nprocedure TMyTestSetup.Setup;\nbegin\n   // How can I access fTakes4Ever2Init from here?\n  fTakes4Ever2Init.create // This is the call that takes long\nend;\n\nprocedure TMyTest.Test1;\nbegin\n  fTakes4Ever2Init.DoSomething;\nend;\n\ninitialization\n  RegisterTest(TMyTestSetup.Create(TMyTest.Suite));\n</code></pre>\n"},{"tags":["delphi","delphi-xe2","jvcl"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":102,"score":2,"question_id":12996421,"title":"JvTreeView and JvCheckTreeView checkbox notification","body":"<p>I have set a <code>JvTreeView.CheckBoxes</code> to <code>True</code>, and the check boxes are displayed and working as expected, but on Windows XP SP3 and below, the <code>OnNodeCheckedChange</code> event is not fired. I googled a little, and found <a href=\"http://issuetracker.delphi-jedi.org/view.php?id=5119\" rel=\"nofollow\">this issue on JVCL issue tracker</a>, but I can not apply it to the latest JVCL release (Version 3.47). Has anyone any fix for the check box event?</p>\n\n<hr>\n\n<p>Update: The event is fired when I change the check box using space bar, but is not fired when I <em>click</em> on the check box.</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":13018631,"title":"How to get package name/version at runtime","body":"<p>I'm loading package at runtime via <code>LoadPackage()</code>. Let's say after load I want to check the version of the package to ensure it's the newest. How can I do that?</p>\n"},{"tags":["delphi","svg","delphi-2010","vcl"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":147,"score":4,"question_id":13015002,"title":"How to implement a user definable interactive map in Delphi 2010?","body":"<p>I'd like to have an interactive <em>floor</em> map (so they're not huge) in my application. The maps will be different for every user, but contain similar elements which only differ by quantity and location. The application will show the map, identify certain elements and link them to information from the database.</p>\n\n<p>To design and store the map, I'd rather not roll my own editor and/or come up with some custom file format. However, it would be nice if the format were open and easily readable. SVG seems  to be the perfect candidate for the job. All there needs to be is a convention of how to name the elements to make them identifiable. But how to go from there? I need something that can render the SVG and distinguish between the different layers.</p>\n\n<p><a href=\"http://domusondelphi.blogspot.com/2012/02/tsvg-or-how-firemonkey-just-became.html\" rel=\"nofollow\" title=\"TSVG. Or how FireMonkey just became thrice as powerful. | Delphi\">TSVG can do exactly this</a> but depends on FireMonkey which I'd rather avoid - it's not even present in Delphi 2010, so I'd have to use another version and do DLL tricks.</p>\n\n<p>Another option would be to use the <a href=\"http://code.google.com/p/delphichromiumembedded/\" rel=\"nofollow\" title=\"delphichromiumembedded - Delphi Chromium Embedded - Google Project Hosting\">Chromium Embedded Framework</a> and create the map using HTML, CSS and JavaScript. That feels very bulky, and would be hard to get right.</p>\n\n<p>Are there any simpler ways to do this that I overlooked, either using SVG or perhaps something completely different?</p>\n\n<p>I'm not sure if a GIS system is appropriate for this. It may very well be overkill.</p>\n"},{"tags":["web-services","delphi","odata","delphi-xe"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":292,"score":2,"question_id":8764903,"title":"Using Delphi to consume oData service recommendations","body":"<p>I'm about to start a project that requires a Delphi XE Windows 32 client to consume an <a href=\"http://www.odata.org/\" rel=\"nofollow\">oData</a> web service.</p>\n\n<p>I can  query the service correctly with some rough and read test code but it's going to be a slog writing a framework to handle the oData protocol - all the filtering, parameters, etc and handling CRUD operations for all the services. Note that this is the Win32 version of Delphi so I don't have things like linq, etc at my disposal.</p>\n\n<p>Are there any Delphi programmers out there that have experience with consuming oData with Delphi? And if so, any recommendations for frameworks, components, etc that would help here?</p>\n"},{"tags":["delphi","odata","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":154,"score":8,"question_id":11721549,"title":"Consume oData service from Delphi","body":"<p>How can I consume a oData webservice from Delphi (I'm trying to interact with the new Bing Search Azure API)? There is almost no information to do this in Delphi. There is a post <a href=\"http://stackoverflow.com/questions/8764903/using-delphi-to-consume-odata-service-recommendations\">here</a> but it does not help much explaining how to consume such service from a Delphi point of view. Can anyone provide a simple example?</p>\n"},{"tags":["delphi","registry","delphi-xe2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12963730,"title":"Is the key order important in the Delphi key 'Known Packages'?","body":"<p>I'm trying to save some Delphi setup info to speed up Delphi installation and I'm getting very confused with registry key value order behaviour. I exported my Delphi XE2 registry key:</p>\n\n<pre><code>HKEY_CURRENT_USER\\Software\\Embarcadero\\BDS\\9.0\\Known Packages\n</code></pre>\n\n<p>to the *.reg file. After deleting it from the registry, and reloading the reg file, Delphi complains about missing bpl's. When I look at the key list, it is now all in alphabetical order - it is NOT in that order in the reg file. I presume that where packages depend on another, the depended package must be listed first. Am I right?</p>\n\n<p>I then used Inno Setup to create three key values in this order - B,A,D. After running it, the registry displays A,B,D key order.</p>\n\n<p>As a component installer I've rarely had dependent packages. What method can I use to leave the keys in the order I chose? Something must have done that because I have a reg file in the order that Delphi requires. It seems crazy that an export followed by an import is not symmetrical.</p>\n"},{"tags":["c#","delphi","io","pipes","named"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":176,"score":3,"question_id":12913935,"title":"Named pipes performance issues","body":"<p>I'm using named pipes for interprocedural communication between C# and Delphi. C# uses the \"System.IO.Pipes\" package, whereas Delphi makes use of \"Libby's pipes.pas\". Unforunatley, the commincation is all but performant: Profiling showed me that the communication takes 72% of the whole runtime, the rest is used by calculations. <br />\nI was able to locate one problem that could take up ressources: If I don't explicitly disconnect the sending client's connection in Delphi, C# doesn't receive any data at all.</p>\n\n<h2>Delphi (sending)</h2>\n\n<pre><code>FClient1.Write(msg[1], Length(msg));\nFClient1.FlushPipeBuffers;\nFClient1.WaitForReply(20);\nFClient1.Disconnect; // disconnect to signalize C# that the writing is finished\nFClient1.Connect;  // connect again to prevent syncronization problems\n</code></pre>\n\n<h2>C# (receiving)</h2>\n\n<pre><code>// Wait for a client to connect\nstc.pipeServer.WaitForConnection();\n    while (reconnect_attempts &lt; MAX_RECONNECT_ATTEMPTS) // \n                    {\n                        string tmp = sr.ReadLine();\n\n                        // if result is empty, try again for &lt;MAX_RECONNECT_ATTEMPTS&gt; times\n                        // so you can elimnate the chance that there's just a single empty request\n                        while (tmp != null)// &amp;&amp; result != tmp) // \n                        {\n                            tmp = sr.ReadLine();\n                            result += tmp;\n                        }\n                    // sleep, increment reconnect, write debugging...\n                    }\nstc.pipeServer.Close();\n</code></pre>\n\n<p>Even though I guess that the reconencting is expensive, I'm not entierelly sure about it. One flow of data (roughly 1 / 11 kb) takes 130 (respcively 270ms for the 11kb) total (sending &amp; receiving). <br />\nMy question would be: Is it neccessary to force-disconnect the pipes to signalize that the client is done writing? As far as my obcservations go, <i>this is only neccessary when sending with libby's</i>. Are there any other possible causes for the poor performance? Thanks in advance. <br /><br />\nAs an addition, here's the sending and receiving done vice versa:</p>\n\n<h2>C# (sending)</h2>\n\n<pre><code> stc.pipeClient.Connect();\n StreamWriter sw = new StreamWriter(stc.pipeClient);\n //sw.AutoFlush = true;\n sw.WriteLine(msg);\n sw.Flush();\n stc.pipeClient.WaitForPipeDrain(); // waits for the other end to read all bytes \n // neither disconenct nor dispose\n</code></pre>\n\n<h2>Delphi (receiving)</h2>\n\n<pre><code> SetLength(S, Stream.Size);   Stream.Read(S[1], Length(S));  \n FPipeBuffer := FPipeBuffer + S;   { TODO 2 : switch case ID }   \n// if the xml is complete, i.e. ends with the closing checksum   \nif (IsFullMessage()) begin\n         begin\n           // end reading, set flag\n           FIsPipeReady := true;\n         end;\n</code></pre>\n"},{"tags":["delphi","delphi-7","delphi-xe2","embarcadero","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":246,"score":0,"question_id":12996363,"title":"Delphi XE3, ugly StringGrid's borders","body":"<p>Why StringGrid's borders are so unclear in XE3, comparing to Delphi7? How to fix that?</p>\n\n<p><img src=\"http://i.stack.imgur.com/JQJ8Z.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi","delphi-xe2","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":13000321,"title":"TIdHttp.Post - can't get utf-8 encoding","body":"<p>How can I force TIdHttp.post method to return the web page encoded in utf-8? I tried <code>http.Request.ContentEncoding := 'UTF-8'</code> but it doesn'twork. Here's my code:</p>\n\n<pre><code>procedure TeUpdateNews.Check;\nvar url: string;\n    Http: TIdHttp;\n    SS: TStringStream;\n    param: TStringList;\n    SWIDESTRING: WideString;\nbegin\n  http := TIDHttp.Create(nil);\n  http.HandleRedirects := true;\n  http.ReadTimeout := 5000;\n  http.Request.ContentEncoding := 'UTF-8';\n\n  param := TStringList.create;\n  param.Clear;\n\n  url := CONST_SOME_WWW;\n\n  try\n    SS := TStringStream.Create;\n    try\n      SWIDESTRING := http.Post(url, param);\n\n       // it's not getting utf-8!\n       ShowMessage(SWIDESTRING); \n    finally\n      SS.Free;\n      param.free;\n    end;\n  finally\n    Http.Free;\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-2006"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":600,"score":5,"question_id":9811940,"title":"Delphi - how do I find out which modal dialog has focus and bring it to the front?","body":"<p>I have a Delphi 2006 app which can pop up a modal dialog in response to an error condition.  It seems to get itself into a state where one of these modal dialogs is open, positioned in front of the main form, but neither form is responding to messages.  Clicking on either gives a \"bonk\".  The app is running fine, the UI is updating the main form, but you can't do anything.  I guess there is most likely another modal dialog under the main form.  Whether it is one of mine or one from Windows I have no idea.</p>\n\n<p>Other points:</p>\n\n<ul>\n<li>the app responds to keyboard shortcuts OK.  One of these shortuts shuts down the app gracefully and this worked.  I have been unable to reproduce the situation since.</li>\n<li>the app has a tray icon.  This responds to right mouse clicks.  If I minimize the app from here the main form minimizes and leaves the modal dialog displayed, still without focus.  If I restore the main form, things are as they were, with neither window having focus.  Alt-tab has similar results. </li>\n<li>platform is Windows 7</li>\n<li>I call DisableProcessWindowsGhosting before any forms are created</li>\n<li><p>I open the modal dialogs with</p>\n\n<pre><code>ModalDialog.PopupParent := MainForm ;\nModalDialog.ShowModal ;\n</code></pre></li>\n<li><p>I postpone these error dialogs if other modal dialogs are open:</p>\n\n<pre><code>if (Application.ModalLevel = 0) then\n    {open modal dialog}\n</code></pre></li>\n</ul>\n\n<p>My question has two parts:</p>\n\n<p>Is there a way of programmatically finding out what window has focus?  I could then take some action for this scenario or a last resort I could them provide a shortcut key to bring it to the front or take some evasive action (depending on the dialog) like set the ModalResult to mrCancel.</p>\n\n<p>How can this situation arise?  Normally when I get a modal dialog behind the main form (I can do that by getting the modal dialog to open, minimizing the app from the tray icon, then restoring the app again - the app main form restores in front of the dialog, with the dialog still retaining focus), I can bring it to the front again by clicking on the tray icon, or close it with the <code>Esc</code> key but it didn't work in this case.</p>\n\n<p><em><strong></em>**UPDATE*<em>*</em></strong></p>\n\n<p>Misha's fix worked apart from non-delphi dialogs like TSaveDialog.  I was able to get them to work as well by adding <code>Application.ModalPopupMode := pmAuto ;</code> just before the call to <code>Execute</code>.</p>\n\n<p>By \"got it to work\" I mean that the save dialog was in front after the following sequence:</p>\n\n<ul>\n<li>open save dialog</li>\n<li>minimize app from tray icon</li>\n<li>restore app from tray icon</li>\n</ul>\n\n<p>whereas it was behind the main form without the <code>ModalPopupMode := pmAuto</code>.</p>\n\n<p>So I'm hoping these changes will help the (as yet unreproduced) problem.  </p>\n"},{"tags":["delphi","outlook","word","mailmerge"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":361,"score":2,"question_id":10372596,"title":"Inputting data from a dbgrid into a word mail merge","body":"<p>I'm wanting to create a mail marge for a letter inputting different names and address on each. I've used Microsoft example as a base point <a href=\"http://support.microsoft.com/kb/229310\" rel=\"nofollow\">http://support.microsoft.com/kb/229310</a> and i've customized it to how i like. But my problem arises when trying to get the data for either selected rows of the dbgrid or just the whole thing. I have no idea how to do it. My first thought was do 1 to the amount of rows, then put some tedit boxes down and put them equal to mailmerged data but that still only does it one at a time. The dbgrid is linked up to a ms outlook.\nThis is how they fill the data..</p>\n\n<pre><code>// Open the file to insert data\nwrdDataDoc := wrdApp.Documents.Open('E:\\Temp.doc');\n for iCount := 1 to (DBGrid1.DataSource.DataSet.RecordCount) do\nwrdDataDoc.Tables.Item(1).Rows.Add;\nFillRow(wrdDataDoc, 2, 'Steve', 'DeBroux',\n    '4567 Main Street', 'Buffalo, NY  98052');\n// Fill in the data\nFillRow(wrdDataDoc, 3, 'Jan', 'Miksovsky',\n    '1234 5th Street', 'Charlotte, NC  98765');\nFillRow(wrdDataDoc, 4, 'Brian', 'Valentine',\n    '12348 78th Street  Apt. 214', 'Lubbock, TX  25874');\n</code></pre>\n\n<p>So how would I grab the data from the dbgrid and fill the file with that information.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":338,"score":2,"question_id":8934995,"title":"How to handle subcomponents and properties created in runtime vs designtime?","body":"<p>I can' t realize this thing. I have a component in DELPHI that includes 2 other components: a Firemonkey Layout and inside of that an dynamic array of TLayout which includes a TRectangle.\nThis is achieved through the property BarNumber.</p>\n\n<p>I have lots of problems about Design Time vs. Runtime behaviour, this is due to the DFM (FMX in Firemonkey) that stores the subcomponents as part of the Object.\nNow. This is the code of the On Create part.</p>\n\n<pre><code>constructor TFluffyTable.Create(Owner: TComponent);\nvar\ni: integer;\nbegin\n  inherited Create(Owner);\n\n  Width:=300;\n  Height:= 160;\n  BarNumber:=100;\n  SetLength(Column, FBarNumber);\n  for i := 0 to (FBarNumber-1) do\n  begin\n     Column[i]:= TColumn.Create(Self);\n     Column[i].Name:= 'Column_' + IntToStr(i);\n     Column[i].Parent:= Self;\n     Column[i].Height:=Height;\n     Column[i].Width:=Width/FBarNumber;\n     Column[i].Align:= TAlignLayout.alMostLeft;\n   end;\n  end;\n</code></pre>\n\n<p>If I register the component and I use it in design time I get the correct number of bars displayed. But if I run the program with the component, I get twice the number of bars, since the EXE loads the values. I managed to solve this with </p>\n\n<pre><code>   if not (csDesigning in ComponentState) then\n</code></pre>\n\n<p>just before the for loop.\nBut I can't see, obviously, the BARS in design mode. Well I can stand that if this is the only solution. \nThat's not over..!\nFor a strange reason, The only one place I can set my values for Width, Height and BarNumber is that part of code. If I set them in the object inspector they won't be considered and reset to default when I run the program.\n(BarNumber is a variable which reads and writes on FBarNumber)</p>\n\n<p>In short: I don't know how to handle and manage my component to make BarNumber and other properties to be set in design time, and to see the correct number of bars in Runtime.\nThank you so much.</p>\n"},{"tags":["osx","delphi","delphi-xe2","firemonkey"],"answer_count":1,"favorite_count":1,"up_vote_count":8,"down_vote_count":1,"view_count":138,"score":7,"question_id":12977734,"title":"FireMonkey/Rad Studio XE2: How can I show the SaveDialog filter on OS X?","body":"<p>I created an (Delphi XE2) Firemonkey sample program which contains a TButton and a TSavedialog with two different filters.\n(The TSaveDialog component supports the Win32/Win64 and OS X platform.)</p>\n\n<p>It works fine on Win32/Win64, but I don't now why it does not show the Savedialog filters on OS X (VirtualBox/OS X 10.7.x).</p>\n\n<p>How can I get it to work on OS X ?</p>\n\n<pre><code>procedure TForm1.Button_SaveClick(Sender: TObject);\nbegin\n  SaveDialog.Filter:='Format_1 (*.fmt1)|*.fmt1|Format_2 (*.fmt2)|*.fmt2';\n\n  If Savedialog.Execute Then ShowMessage(SaveDialog.FileName+#13+'Selected filterindex: '+Inttostr(SaveDialog.FilterIndex));\nend;\n</code></pre>\n"},{"tags":["delphi","internet-explorer-9","mouse","lag","twebbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":13002014,"title":"TEmbeddedWB / TWebbrowser mouse lag (object drag and drop)","body":"<p>I use a TEmbeddedWB in a Delphi project to display a HTML5/CSS3/Javascript game fullscreen. It uses IE9 embedded to render the page. That is working fine but i discover some lag, speed difference compared to other browsers and IE9 itself (when the page is loaded in the browser itself). In a browser there is no lag.</p>\n\n<p>Because the game uses drag and drop features to move objects and can be used on touchscreens, the lag in movements is a little annoying.</p>\n\n<p>I tried several things, disable background drawing, repainting, increase CPU priority above normal, disable TEmbeddedWB features etc. I also tried it with TWebBrowser but has the same issues. </p>\n\n<p>Anybody any idea how to solve this? Found nothing on the internet about this.</p>\n"},{"tags":["delphi","delphi-2009","splitter"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":640,"score":5,"question_id":6109035,"title":"How to create splitter containing components?","body":"<p>I'd like to put some buttons between two resizable panels or directly on the splitter if possible. How do I achieve they will move along with the splitter; how do I anchor them ?</p>\n\n<p><img src=\"http://i.stack.imgur.com/JVw8g.png\" alt=\"screenshot\"></p>\n\n<p><strong>Edit:</strong><br>\nMaybe the most important thing I forgot to mention. That splitter has to be as wide as on the screenshot, and the buttons should lay on it; so those buttons are actually \"floating over splitter\" now.<br></p>\n\n<p>Thanks a lot</p>\n"},{"tags":["delphi","debugging","dll"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12964862,"title":"How to debug a DLL called from a DLL in Delphi","body":"<p>Let's say I have an EXE named A, which loads a DLL named B, which in turn loads another DLL named C.\nAll of these three are written in Delphi.  I have the source for all three. </p>\n\n<p>If I want to debug DLL B, I have no problem.  I go to Run|Parameters and enter A.EXE as the host. \nWhen I click run, Delphi runs A, which loads B, and I can debug to my heart's content. </p>\n\n<p>But debugging DLL C is another matter.<br>\nIt looks like Delphi will only let me debug a DLL loaded directly from the EXE.\nBut this is a DLL loaded from another DLL. </p>\n\n<p>Is there some way to do this? Thanks. </p>\n\n<p>This is Delphi 7.</p>\n"},{"tags":["delphi","package"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12991290,"title":"Delphi wants package name as exe extension","body":"<p>My project is dynamic linked to PackageCommon.bpl. Distributed My project.exe wants PackageCommon.EXE on runtime but when i rename .bpl to .exe it is works fine. What is the reason?</p>\n\n<p><img src=\"http://i50.tinypic.com/2rz9req.png\" alt=\"Image\"></p>\n\n<p>I'm running Delphi XE3 on Windows 7.</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":211,"score":0,"question_id":13005694,"title":"How to declare two inter-linked classes?","body":"<p>I have a question similar to <a href=\"http://stackoverflow.com/questions/5245774/how-to-use-class-wich-defined-below\">this</a>, but in delphi.</p>\n\n<pre><code>type\n  TThreadPopulator = class(TThread)\n  private\n    _owner:TASyncPopulator; //Undeclared identifier\n  end;\n\ntype\n  TAsyncPopulator = class\n  private\n    _updater: TThreadPopulator;\n  end;\n</code></pre>\n\n<p>Solution of mentioned question is not applicable to delphi</p>\n"},{"tags":["delphi","inno-setup"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":13001640,"title":"Using StringToColor in Inno Setup","body":"<p>I would like to assign some color to label (TNewStaticText - property Color: TColor; read write;) on my form.</p>\n\n<p>I have my color stored as '$RRGGBB' (String) and I would like to convert it to TColor using Delphi function StringToColor() but Inno Setup shows me an error if I use this function in script.\nHow to tell Inno Setup to use this function or how to convert String to TColor in Inno to use it with this property?</p>\n"},{"tags":["c#","delphi","com-interop"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":12420045,"title":"Passing C-style arrays of structs/records from delphi 5 to C# via COM","body":"<p>I have a struct defined in a type library imported into both a Delphi 5 and a C# assembly.</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential, Pack = 1)]\npublic struct MyStruct\n{\n    public uint a;\n    public float b;\n}\n\nMyStruct = packed record\n    a: LongWord;\n    b: Single;\nend;\n</code></pre>\n\n<p>On the Delphi side I have a pointer to a C-style array of said structs which I would like to pass via COM to a C# assembly. Ideally, I'd like this to end up on the c# side as a myStruct[], but I'll take a pointer to a properly marshalled block of memory, the since the structs are all blittable.</p>\n\n<p>Two ways I've tried are</p>\n\n<pre><code>void DoFoo([MarshalAs(UnmanagedType.LPArray, SizeParamIndex = 1)] MyStruct[] fooArray, int size);\nvoid DoBar(MyStruct[] barArray, int length);\n</code></pre>\n\n<p>which after being converted to a type library and imported into delphi are</p>\n\n<pre><code>procedure DoFoo(var fooArray: MyStruct; size: Integer); safecall;\nprocedure DoBar(barArray: PSafeArray; length: Integer); safecall;\n</code></pre>\n\n<p>I didn't think safe arrays worked with structs, and the other clearly isn't an array.</p>\n\n<p>Any ideas/links/whatever greatly appreciated.</p>\n"},{"tags":["delphi","vcl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":13003879,"title":"Delphi XE2: InputQuery display box width is over-sized","body":"<p>When trying to using a multi-line APrompt: i.e.</p>\n\n<pre><code>sPrompt := 'some text' + #13#10#10 + 'some more info...' + #13#10 +\n           'Blah, Blah' + #13#10#10 + 'What is your input?';\n</code></pre>\n\n<p>The InputQuery function takes the string as an array of string,\n it calculates the MaxWidth for the Form according to the longest string in the array.</p>\n\n<p>In the above example the InputQuery form is calculated by the length of the string, which is about 50 characters. Though the longest line is a fraction of that.</p>\n\n<p>The result is a very wide InputQuery box being displayed with lots of empty space.\nDoes not look very professional.</p>\n\n<p>When I try to create an array of string to hold each line:</p>\n\n<pre><code>var saPrompt: array of string;\n    sInputString: String;\nBegin\n   SetLength(saPrompt,4);\n   saPrompt[0] := 'some text' + #13#10#10;\n   saPrompt[1] := 'some more info...' + #13#10;\n   saPrompt[2] := 'Blah, Blah' + #13#10#10;\n   saPrompt[3] := 'What is your input?';\n   sInputString := '???';\n\n   If InputQuery('I Need Input?',saPrompt,sInputString) then\n</code></pre>\n\n<p>I can not compile due to No Overload function exists to take these parameters of the InputQuery function.\nI have looked at the Overload InputQuery functions in the Vcl.Dialogs Unit but can not get it to work.</p>\n\n<p>Does anyone know the correct syntax to use the InputQuery Function with a multi-line prompt?</p>\n\n<p>I am using Embarcadero RAD Studio XE2 - Delphi</p>\n\n<p>Thanks in advance for any 'helpful' response.</p>\n"},{"tags":["delphi","delphi-xe2","firemonkey"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":798,"score":2,"question_id":9048346,"title":"How embed a firemonkey form inside a control?","body":"<p>I have tried to embed a form inside a Scrollbox:</p>\n\n<pre><code>procedure TfrmMain.FormCreate(Sender: TObject);\nvar\n  Control:TControlView;\nbegin\n  Control := TControlView.Create(Self);\n  Control.BorderIcons := [];\n  Control.parent := ListControls;\n  Control.width := 800;\n  ListControls.AddObject(Control);\n  Control.Visible:= True;\nend;\n</code></pre>\n\n<p>However the form is displayed behind tfrmMain and outside the bouns of the form.</p>\n\n<p>My idea is put a form inside a panel, and both inside scrollbox. Each form represent a complex item with several controls and stuff (the reason to not use ListBox? Firemonkey control creation is far harder than simply do a form and embed it)</p>\n"},{"tags":["delphi","delphi-xe2","vcl","firemonkey"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":144,"score":3,"question_id":13002691,"title":"How to embed a FireMonkey form in a VCL form seamlessly?","body":"<p>I used the trick described in <a href=\"http://stackoverflow.com/questions/7315050/delphi-xe2-possible-to-instantiate-a-firemonkey-form-in-vcl-application\" title=\"Delphi XE2: Possible to instantiate a FireMonkey Form in VCL application?\">this question</a> to display a FireMonkey form on a TPanel in a VCL application. My problem is that clicking (controls on) the embedded form causes the VCL form (containing that TPanel) to become deactivated. The most obvious consequence of that is the window border changing color all the time.</p>\n\n<p>When displaying a VCL form on a TPanel of another, this doesn't happen; the forms apparently \"merge\". What should I do to reach a similar result with FireMonkey? I want controls on the FireMonkey form to be usable, but keep the parent form activated.</p>\n\n<h1>Update 1</h1>\n\n<h2>VCL</h2>\n\n<pre><code>unit Unit1;\n\ninterface\n\nuses\n  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,\n  System.Classes, Vcl.Graphics, Vcl.Controls, FMX.Forms, Vcl.Forms,\n  Vcl.Dialogs, Vcl.StdCtrls, Vcl.ExtCtrls, FMX.Platform.Win;\n\ntype\n  TMainForm = class(TForm)\n    Panel1: TPanel;\n    Button1: TButton;\n    procedure Button1Click(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  MainForm: TMainForm;\n\nimplementation\n\n{$R *.dfm}\n\nuses FireMonkeyForms;\n\nprocedure TMainForm.Button1Click(Sender: TObject);\nvar\n  LFMForm: FireMonkeyForms.TForm1;\n  LFMHWnd: HWND;\nbegin\n  LFMForm := FireMonkeyForms.TForm1.Create(nil);\n  LFMForm.Left := 0;\n  LFMForm.Top := 0;\n  LFMForm.Height := Panel1.ClientHeight;\n  LFMForm.Width := Panel1.ClientWidth;\n  LFMForm.BorderStyle := TFmxFormBorderStyle.bsNone;\n  LFMForm.BorderIcons := [];\n  LFMHWnd := FmxHandleToHWND(LFMForm.Handle);\n  SetWindowLong(LFMHWnd, GWL_STYLE, GetWindowLong(LFMHwnd, GWL_STYLE) or WS_CHILD);\n  Winapi.Windows.SetParent(LFMHWnd, Panel1.Handle);\n  LFMForm.Visible := True;\nend;\n\nend.\n</code></pre>\n\n<h2>FireMonkey</h2>\n\n<pre><code>unit FireMonkeyForms;\n\ninterface\n\nuses\n  System.SysUtils, System.Types, System.UITypes, System.Classes, System.Variants,\n  FMX.Types, FMX.Controls, FMX.Forms, FMX.Dialogs, FMX.Layouts, FMX.Memo;\n\ntype\n  TForm1 = class(TForm)\n    Label1: TLabel;\n    Memo1: TMemo;\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n\n{$R *.fmx}\n\nend.\n</code></pre>\n"},{"tags":["c#",".net","delphi","delphi-2010","tcpclient"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12970852,"title":"Difference between .net TcpClient and Delphi2010 IdTCPClient","body":"<p>I have the following code written in delphi2010:</p>\n\n<pre><code>  TCPClient := TidTcpClient.Create;\n\n  TCPClient.Host := '192.168.12.131';\n  TCPClient.Port := 1312;\n\n  TCPClient.Connect;\n\n  TCPClient.IOHandler.WriteLn('msg', TEncoding.ASCII);\n  answer := TCPClient.IOHandler.ReadLn(TEncoding.ASCII);\n</code></pre>\n\n<p>This code works well - i get answer.</p>\n\n<p>And i have the following C# code:</p>\n\n<pre><code>var client = new TcpClient();\nclient.Connect(endpoint);\n\nvar stream = client.GetStream();\nvar msgData = System.Text.Encoding.UTF8.GetBytes(\"msg\");\nstream.Write(msgData, 0, msgData.Length);\n\nvar answerData = new Byte[256];\nvar asnwerLength = stream.Read(answerData, 0, answerData.Length);\n</code></pre>\n\n<p>And it didn't work - request timeout.</p>\n\n<p>What is difference between these two parts?</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":148,"score":0,"question_id":12994208,"title":"Access violation at address 003B0E8E in module 'MpLib.dll'. Read of address 00120BF4","body":"<p>I've searched around Stackoverflow for the issue I was having, but they were all very specific for that particular access violation. </p>\n\n<p>The piece of code I believe I am having trouble with is a function called <code>MpqExtractFile</code>, stored in a DLL. </p>\n\n<p><strong>Function:</strong></p>\n\n<pre><code>function MpqExtractFile(var hMPQ: Integer; szToExtract, szExtracted: AnsiString): Boolean; stdcall; external 'MpqLib.dll' name 'B2';\n</code></pre>\n\n<p><strong>Call:</strong></p>\n\n<pre><code>if MpqExtractFile(hMPQ, 'war3map.j', AnsiString(tempDir+'\\war3map.j')) = True\nthen ShowMessage('Success.')\nelse ShowMessage('Failed.');\n</code></pre>\n\n<p>Upon execution of this code my application throws the access violation error so the <code>ShowMessage</code> is not displayed at all.</p>\n\n<p>I am unsure if the above is adequate to even estimate what the problem could be, but if there is anything else I should please tell me.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>This is an extract of the VB.NET source code that I have been interpreting:</p>\n\n<pre><code>Declare Function MpqExtractFile Lib \"MpqLib.dll\" Alias \"B2\" (ByVal hMPQ As Integer, ByVal szToExtract As String, ByVal szExtracted As String) As Boolean\n</code></pre>\n\n<p>I've also used DllExp to gather this information (if it is of any use):</p>\n\n<pre><code>==================================================\nFunction Name     : B2\nAddress           : 0x00413b20\nRelative Address  : 0x00013b20\nOrdinal           : 12 (0xc)\nFilename          : MpqLib.dll\nType              : Exported Function\n==================================================\n</code></pre>\n\n<p>Thank you in advanced!</p>\n"},{"tags":["database","delphi","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":112,"score":2,"question_id":12939283,"title":"How to delete selected database records from a TDBAdvListView?","body":"<p>I am testing out Absolute Database by ComponentAce</p>\n\n<p>I have on my Form a TABSTable, TABSDatabase and a TDataSource and the data is being displayed in a TDBAdvListView, MultiSelect and RowSelect are True. I have only one Table.</p>\n\n<p>When either one or more of the Items in the TDBAdvListView are selected I want to have the Database Delete the selected Records.</p>\n\n<p>I have tried this way in the code below:</p>\n\n<pre><code>procedure TMain.DeleteEntry2Click(Sender: TObject);\nvar\n  i: Integer;\nbegin\n  with DBAdvListView1.DataSource.DataSet do\n  begin\n    for i := DBAdvListView1.Items.Count - 1 downto 0 do begin\n    if DBAdvListView1.Items[i].Selected then\n    begin\n      DBAdvListView1.DataSource.DataSet.GotoBookmark(Pointer(DBAdvListView1.Items[i]));\n      DBAdvListView1.DataSource.DataSet.Delete;\n      end;\n    end;\n  end;\nend;\n</code></pre>\n\n<p>This always results in an Error Message:</p>\n\n<pre><code>Cannot retrieve record - Native error: 10026\n</code></pre>\n\n<p>I have very little experience with database programming, what am I doing wrong?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I have added a new field into the database named ID as an integer starting from 0 in the hopes that I can reference them with the Locate method and tried with the code below. This produces no error but will only delete the top record in the ListView and if I select more than one it will delete different records than selected.</p>\n\n<p>My new code:</p>\n\n<pre><code>procedure TMain.DeleteEntry2Click(Sender: TObject);\nvar\n  i: Integer;\nbegin\n  with DBAdvListView1.DataSource.DataSet do\n  begin\n    DBAdvListView1.BeginUpdate;\n    First;\n    for i := DBAdvListView1.Items.Count - 1 downto 0 do begin\n    if DBAdvListView1.Items[i].Selected then\n    begin\n      if dbTable.Locate('ID',DBAdvListView1.Items[i].Selected,[]) then\n      dbTable.Delete;\n      Next;\n      end;\n    end;\n  dbTable.Close;\n  dbTable.Open;\n  DBAdvListView1.EndUpdate;\n  end;\nend;\n</code></pre>\n\n<p>The dbTable has to be Closed and Opened to see changes for some strange reason - I have tried Refresh to no avail...</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>// To include Table Structure as requested...</p>\n\n<ul>\n<li>ID integer 0</li>\n<li>Title string 200</li>\n<li>Author string 100</li>\n<li>Date string 20</li>\n<li>Location string 60</li>\n<li>Category string 100</li>\n<li>ISBN-13 string 20</li>\n<li>ISBN-10 string 20</li>\n</ul>\n\n<p>In the Absolute Database Utils directory there is a DatabaseManager.exe which I used to create the actual table with and in here I have also now set a Primary Key of the type:</p>\n\n<p>Type - Primary\nName - ID</p>\n\n<p>The fields for the Index:</p>\n\n<p>ColumnName - ID\nCaseInsensitive - False\nASC - True\nMaxIndexSize - 20</p>\n"},{"tags":["delphi","dll"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":13001150,"title":"Why does FASTMM's full debug mode require the fulldebugmode.dll to be in the same folder with the appllcation's .exe file?","body":"<p>When I copy the DLLs into the same folder where the .exe resides, it works. \nThere is a (sort of) workaround for this, though: when I open the debugger options and add the original path of the DLL's to the environment block, it works when I start my project INSIDE my IDE, but it doesn't work when I start the project.exe file in explorer. This is not really an issue, I would just like to know the relationship between these files.</p>\n"},{"tags":["delphi","matrix"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":146,"score":1,"question_id":13000863,"title":"Migrating from static array to dynamic array","body":"<p>Previously i have static array for the matrix dataset design </p>\n\n<pre><code>TMatrix = record\n    row, column: word; {m columns ,n strings }\n    Data: array[1..160, 1..160] of real\n\n var\n Mymatrix  : TMatrix;\n\n begin\n\n Mymatrix.row := 160; - maximum size for row us is 160 for 2 x 2 static design.\n Mymatrix.columns := 160; -  maximum size for column us is 160  for 2 x 2 static design.\n</code></pre>\n\n<p>With the current design i can only have 160 x 160 in 2 dimensional matrix design. If i enter more array size [1..161, 1..161] , the compiler will alert for E2100 Data type too large: exceeds 2 GB error. So if i convert the code into dynamic array , i need to re-structure all my current code to read the matrix starts from 0 . Previoulsy , for static array the array will starts from 1. Some external functions it start to read the matrix from 1.</p>\n\n<p>So , now i'm stuck with my current code which  i need to create more than thousand N x N matrix size . With my current static array design everything went fine if below than 160 x 160 . So , i need to get any solutions without too much to change my current static array design.</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12986385,"title":"Delphi Xe2 inserting records into table based on values from another table","body":"<p>I have the following code that i use to update a table in a database this code used to work in bds 2006 using zeosdblib query components, but now it does not work in delphi xe2. Can anyone please show me where i am going wrong. Thank You </p>\n\n<pre><code>procedure TGoodsReceivedForm.btnCategorizeClick(Sender: TObject);\nvar\n  TempCatTotal : Extended;\n  nCatogory : string;\nbegin\nTempCatTotal := 0;\nzroqryExpcat.Open;\nwith zroqryExpcat do\nbegin\n first;\nwhile not Eof do\nbegin\n zqrySumCategory.Close;\n zqrySumCategory.SQL.Clear;\n zqrySumCategory.SQL.Add('select costcategory,packcost,sum(qty)*packcost as pamount');\n zqrySumCategory.SQL.Add('from pitems');\n zqrySumCategory.SQL.Add('where costcategory=:costcategory and orderno=:orderno');\n zqrySumCategory.SQL.Add('group by costcategory,packcost');\n zqrySumCategory.Params[0].AsString := zroqryExpcat.FieldByName('Description').Value;\n zqrySumCategory.Params[1].AsString := NewPurchaseOrderForm.OrderNumber.Caption ;\n zqrySumCategory.Open;\n zqrySumCategory.First;\n TempCatTotal := 0;\n while not zqrySumCategory.eof do\n begin\n  TempCatTotal := TempCatTotal+zqrySumCategory.FieldByName('pamount').AsFloat;\n  zqrySumCategory.Next;\n end;\n if TempCatTotal &gt; 0 then\n begin\n  zqryInsertExpense.Close;\n  zqryInsertExpense.Params[0].AsString := NewPurchaseOrderForm.OrderNumber.Caption ;\n  zqryInsertExpense.Params[1].AsString := zqrySumCategory.Params[0].AsString ;\n  zqryInsertExpense.Params[2].AsCurrency := TempCatTotal;\n  zqryInsertExpense.Params[3].Asinteger := zroqryExpcat.FieldByName('gl_account_no').Value;\n  zqryInsertExpense.Params[4].AsDate := ReceivedDate.Date;\n  zqryInsertExpense.ExecSQL;\n  zqryInsertExpense.Close;\nend;\nnext;\nend;\nend;\n  zqryListExpenseCat.Close;\n  zqryListExpenseCat.Params[0].Value := NewPurchaseOrderForm.OrderNumber.Caption;\n  zqryListExpenseCat.Open;\nend;   \n</code></pre>\n"},{"tags":["delphi","delphi-xe2","b-tree"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":449,"score":1,"question_id":8837159,"title":"TurboPower B-Tree Filer and Delphi XE2 - Anyone done it?","body":"<p>I might be the last guy on the planet relying on B-Tree Filer but I made the jump from Delphi 2007 to XE2.</p>\n\n<p>After getting over all the AnsiChar and PAnsiChar issues, the code now crashes with a Range Check with zero items on a page.</p>\n\n<p>Is anyone successfully running B-Tree Filer under Delphi XE2?  If so, how'd ya do it? :) </p>\n\n<p><strong>Update</strong> Range check error here:</p>\n\n<pre><code>procedure IsamUnPack(var Page : IsamPage; KeyL : Word); \nvar \n  I, K, S : Word; \n  P : Array [0..0] Of Byte absolute Page; {Real bounds [0..65535]} \nbegin \n K := KeyL + 9; \n S := Pred (Page.ItemsOnPage) * K + 6; \n if KeyL &lt;&gt; MaxKeyLen then begin \n    for I := Page.ItemsOnPage downto 2 do begin \n     Move(P[S], Page.ItemArray[I], K); // Range Check error in Warren P's suggestion \n     S := S - K;  \n     end; \n end; \nend; \n</code></pre>\n\n<p>While Page.ItemsOnPage should never be zero (the Range Check error is valid here) it may have been caused by data alignment issues.  This code, added to BTDEFINE.INC seems to be doing the trick...</p>\n\n<pre><code>{$IFDEF VER230}\n{$DEFINE UsingDelphi}\n{$ENDIF}\n\n{$IFDEF VER230} {Delphi XE2}\n{$A-} {align data on byte boundaries}\n{$B-} {short circuit boolean evaluation}\n{$H+} {long string support}\n{$I-} {suppress I/O checking}\n{$J+} {writeable typed constants}\n{$P-} {do not allow open string parameters}\n{$Q-} {overflow checking off}\n{$R-} {range checking off}\n{$T-} {no type checked pointers with @}\n{$V-} {no var string checking}\n{$X+} {extended syntax on}\n{$DEFINE Delphi2006}\n{$DEFINE Delphi1Plus}\n{$DEFINE Delphi2Plus}\n{$DEFINE Delphi3Plus}\n{$DEFINE Delphi4Plus}\n{$DEFINE Delphi5Plus}\n{$DEFINE Delphi6Plus}\n{$DEFINE Delphi7Plus}\n{$DEFINE Delphi2005Plus}\n{$DEFINE Delphi2006Plus}\n{$ENDIF}\n</code></pre>\n"},{"tags":["delphi","unicode","cmd","delphi-7"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":189,"score":1,"question_id":11024675,"title":"Read Unicode/ANSI from Console","body":"<p>I use this to read a widestring out of the cmd (Windows Shell).</p>\n\n<pre><code>var\n pBuffer       : array [0..250] of WideChar;\n aBuffer       : array [0..250] of Char;\n RealUnicode   : Integer;\n ExtendedAscii : Integer;\nbegin\n RealUnicode   := 2;\n ExtendedAscii := 1;\n // ... pipes etc...\n CreateProcessW(nil, pwidechar(ComSpec + ' /U'), nil, nil, TRUE, (CREATE_NEW_CONSOLE or CREATE_BREAKAWAY_FROM_JOB), nil, nil, StartupInfo, ProcessInfo);\n // ...\n while true do begin\n  sleep (10); // Reduce CPU Usage\n  GetExitCodeProcess(ProcessInfo.hProcess, ExitCode);\n  if ExitCode &lt;&gt; STILL_ACTIVE then Break;\n  FillChar(pBuffer,SizeOf(PBuffer), #0);\n  ReadFile(hoRead, pBuffer[0], 250, BytesRead, nil);    \n  if BytesRead &gt; 0 then begin\n   if (IsTextUnicode(@pBuffer, BytesRead, @RealUNICODE) or IsTextUnicode(@pBuffer, BytesRead, @ExtendedAscii) then begin\n    MessagBoxW(0,dbuffer,'',0);\n   end else begin\n    FillChar    (aBuffer,SizeOf(aBuffer ), #0);\n    CopyMemory  (@aBuffer , @pBuffer, BytesRead * 2);\n    MessageBoxA (0, aBuffer, '', 0);\n   end;\n  end;\n end;\nend;\n</code></pre>\n\n<p>This snippet works actually pretty good. It makes sure that if ansi strings/chars get written into the console (for example - ping.exe) that it gets the ANSI output later. \nUnfortunately, there is one little glitch. I use ping.exe and it works without problems until it returns to the Unicode part. It's actually hard to explain but I hope you guys know what I mean. \nThank you for your help.</p>\n\n<p>EDIT: \nWhen ping.exe is finished, the snippet returns empty strings for some reason. Altough the readbytes > 0</p>\n\n<p>EDIT2:\n<img src=\"http://i.stack.imgur.com/2rMVx.jpg\" alt=\"enter image description here\"></p>\n\n<p>Explanation:\nI started the cmd with CreateProcesW, set the pipes etc, and then read the first buffer bytes (in Unicode). Then I typed in ipconfig and it switched back to ANSI. Then it reads bytes and they are empty ANSI strings. After that, the \"program\" (not cmd) sometimes crashes.</p>\n\n<p>EDIT3:\nI have an example here (with sourcecode and binary).  It's compiled with delphi7 and tntcontrols. If you don't have tntcontrols just put a memo (name : Memo1) in the form. and change the widestrings to strings and/or try to debug it with messageboxW.\n<a href=\"http://dl.dropbox.com/u/349314/UNICODE%20Shell%20Example.rar\" rel=\"nofollow\">http://dl.dropbox.com/u/349314/UNICODE%20Shell%20Example.rar</a>\nThis example does NOT care about the ansi input!</p>\n"},{"tags":["delphi"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":182,"score":1,"question_id":12990942,"title":"Is the if statement necessary in the canonical enumerator MoveNext function?","body":"<p>The canonical MoveNext in a Delphi enumerator is written like this:</p>\n\n<pre><code>function TListEnumerator.MoveNext: Boolean;\nbegin\n  Result := FIndex &lt; FList.Count - 1;\n  if Result then\n    Inc(FIndex);\nend;\n</code></pre>\n\n<p>This is the form used throughout the RTL, VCL etc. This form appears to be widespread in 3<sup>rd</sup> party code also.</p>\n\n<p>I think it can be written more simply like this:</p>\n\n<pre><code>function TListEnumerator.MoveNext: Boolean;\nbegin\n  Inc(FIndex);\n  Result := FIndex &lt; FList.Count;\nend;\n</code></pre>\n\n<p>Is there any good reason why the simpler form cannot be used?</p>\n\n<hr>\n\n<p>My reasoning is as follows. Once <code>MoveNext</code> returns <code>False</code>, the <code>Current</code> property is never accessed again. It doesn't matter that <code>FIndex</code> is off the end of the list since it is never used again. The for in loop is actually implemented like this:</p>\n\n<pre><code>while Enumerator.MoveNext do\n  Enumerator.Current.DoSomething;\n</code></pre>\n\n<p>In fact it actually makes more sense to me that <code>FIndex</code> goes out of bounds. It means that if anyone uses hand-written enumerator code then they will get range check errors in case <code>Current</code> is accessed after <code>MoveNext</code> returns <code>False</code>. </p>\n\n<p>What's more, <code>FIndex</code> is <code>-1</code> before the first call to <code>MoveNext</code>. That is one off the list to the left. And after the final call to <code>MoveNext</code>, the one that returns <code>False</code>, isn't it appropriate that <code>FIndex</code> is <code>Count</code>, that is one off the list to the right. </p>\n"},{"tags":["delphi","delphi-xe2","datasnap","c++builder-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":296,"score":1,"question_id":10157849,"title":"DataSnap XE2 , Disconnecting with second connection in the same client","body":"<p><strong>Hello : This is an important issue about Datasnap XE2 Tcp transport</strong> </p>\n\n<p>I have an old problem , I asked for it before here, but no reply </p>\n\n<p>DataSnap XE2 , Disconnecting with second connection in the same client :</p>\n\n<p>Simple Datasnap server , simple client , ( just call reverse method ) , after few seconds the server destroy one or all the servermethods class , the datasnapserver is tcp protocol , lifecycle=Session , statefull server.</p>\n\n<p>I test the same binary exe on another machines , and another OS ,and I Notice these :</p>\n\n<p>1- The same problem occured when running the server on a computer which linked to router some with WiFi (with / without dhcp ) all OS ( server2003, Win7 ,Winxp ) give the same problem </p>\n\n<p>2- When running the same server on Virtual Machines (all OS ) no problem at all , I use the Oracle Virtual Box , <strong>WHY !</strong></p>\n\n<p>3- In Server implemntation I Change the TCP Transport to http Transport ,   then i have no problem at all <strong>!.</strong></p>\n\n<p>4- I test and try every thing possible ( Networking configuration , Reformating , Fresh OS -- all windows versions -- ) the problem on tcp server transport <strong>still</strong> </p>\n\n<p>5- It occures after (20 seconds -2 minutes ) after calling the client method some times in both connections .</p>\n\n<p>6- I made and test new tcp server (not datasnap) and worked fine , <strong>but DataSnapXE2 TCP server made that problem</strong> </p>\n\n<p>Is there some thing to do , I Just need to know why , I need expectations to test , I try almost every thing possible </p>\n\n<p>I use C++Builder XE2 , no updates , all updates available have nothing about this problem \nI also rebuild in Delphi XE2 , the smae problem </p>\n\n<p>is there somebody know <strong>why</strong> , good advise , <strong>please reply</strong> </p>\n\n<p><strong>Note : DataSnap 2010 , same code , works fine !!</strong></p>\n\n<p><strong>Thank you for your reply in advanced</strong> </p>\n"},{"tags":["delphi","windows-services","tray"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":140,"score":2,"question_id":12331185,"title":"Is it possible to create a tray icon from a service application in Windows Vista or later?","body":"<p>Is it possible to create a tray icon from a Delphi service application under Windows Vista or later?</p>\n"},{"tags":["delphi","crystal-reports","delphi-xe"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2507,"score":1,"question_id":3911912,"title":"Delphi XE - calling Crystal Reports","body":"<p>How do we call Crystal Reports from Delphi XE?\nWhat version of Crystal Reports does Delphi XE support? </p>\n"},{"tags":["delphi","c++builder","virtualtreeview"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":12993003,"title":"Changing drag cursor in VirtualTreeView","body":"<p>When using VirtualTreeView drag operation by default is <code>[doCopy,doMove]</code>. Move operation is indicated by arrow pointer with small box and Copy operation is indicated by same pointer icon but with added [+] next to it.</p>\n\n<p>By default VT uses copy operation and if you press modifier key (<kbd>SHIFT</kbd> key) it modifies operation to move therefore removing the [+] from pointer.</p>\n\n<p>Here is what I need:</p>\n\n<ul>\n<li>reverse the operations (default would be move, with modifier key pressed - copy) and thus reverse pointer arrow too</li>\n<li>replace modifier key - <kbd>CTRL</kbd> instead of <kbd>SHIFT</kbd></li>\n<li>read in an event which of the two operations occurred and start copy or move operation</li>\n</ul>\n\n<p>Any pointers into right direction(s) appreciated.</p>\n"},{"tags":["delphi","delphi-7","manifest","uac","xp-theme"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":140,"score":4,"question_id":12992454,"title":"Delphi 7: Execute application with administrator privileges","body":"<p>How do I add the manifest for UAC without adding XP Themes? </p>\n\n<p>I tried this manifest:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"&gt;\n  &lt;dependency&gt;\n    &lt;dependentAssembly&gt;\n      &lt;assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\"     version=\"6.0.0.0\" processorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\"      language=\"*\"/&gt;\n     &lt;/dependentAssembly&gt;\n  &lt;/dependency&gt;\n  &lt;trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"&gt;\n    &lt;security&gt;\n      &lt;requestedPrivileges&gt;\n        &lt;requestedExecutionLevel\n          level=\"requireAdministrator\"\n          uiAccess=\"false\"/&gt;\n      &lt;/requestedPrivileges&gt;\n    &lt;/security&gt;\n  &lt;/trustInfo&gt;\n&lt;/assembly&gt;\n</code></pre>\n\n<p>but XP themes remains.</p>\n\n<p>I have tried many other manifest, but I get this error:</p>\n\n<p>\"Invalid win32 application\"</p>\n\n<p>Thanks for the help</p>\n"},{"tags":["algorithm","delphi","delphi-7","sudoku"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":95,"score":-1,"question_id":12981210,"title":"Can't make/configure the difficult function","body":"<p><img src=\"http://i.stack.imgur.com/b1nmf.png\" alt=\"Sudoku ex1\"></p>\n\n<p>While solving sudoku I can remove possibility digits (1) and (2) from the cells D[1,2] and D[2,2]. Because (8) and (9) are possible only in those cells, so those cells are either (8 and 9) or (9 and 8). This means that digits (1) and (2) are at the 3rd line of the D block. Thats why I can eliminate the possibility of the digit (1) from the cell A[3,3].</p>\n\n<p>I have been configuring a function to do this during last 40 hours, but couldn't manage. Is there anyone who can make the function to detect this type of intellectual issue (eliminating some possibilities because some other n count of possibilities can exist only in n count of cells, in our case 2 digits 8 and 9 can exist in 2 cells D[1,2] and D[2,2]).</p>\n\n<p>Please dont advice me about other functions of sudoku; I have already done them, the only algorithm that I couldn't program is this one. Btw you can use r[i] (string which consists the possibilities for the row number i), c[i] for the column, and b[i] for the blocks (ex: b[4] (in this image block A) = 1,2,3,4,5,6,7 because 8 and 9 are already defined). Thanks</p>\n"},{"tags":["delphi","osx","rad"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12992304,"title":"FireMonkey/Rad Studio XE2: How can I show the SaveDialog filter on OS X?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12977734/firemonkey-rad-studio-xe2-how-can-i-show-the-savedialog-filter-on-os-x\">FireMonkey/Rad Studio XE2: How can I show the SaveDialog filter on OS X?</a>  </p>\n</blockquote>\n\n\n\n<p>I created an (Delphi XE2) Firemonkey sample program which contains a TButton and a TSavedialog with two different filters. (The TSaveDialog component supports the Win32/Win64 and OS X platform.)</p>\n\n<p>It works fine on Win32/Win64, but I don't now why it does not show the Savedialog filters on OS X (VirtualBox/OS X 10.7.x).</p>\n\n<p>How can I get it to work on OS X ?</p>\n\n<pre><code>procedure TForm1.Button_SaveClick(Sender: TObject);\nbegin\n  SaveDialog.Filter:='Format_1 (*.fmt1)|*.fmt1|Format_2 (*.fmt2)|*.fmt2';\n\n  If Savedialog.Execute Then ShowMessage(SaveDialog.FileName+#13+'Selected filterindex: '+Inttostr(SaveDialog.FilterIndex));\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-xe","delphi-ide"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":571,"score":3,"question_id":6255248,"title":"Control+Click on function is not working in Delphi XE","body":"<p>In Delphi 7 whenever I control+clicked a function/procedure it took me to that function/procedure. But it is not working in Delphi XE - at least not with all functions. I have a function called Associate in ExtUtils.pas\nThe function is correctly compiled so the compiler can find the ExtUtils.pas (and of course the ExtUtils is added to the Uses clause and its folder its added in 'Library path'). But when I control+click the function or the unit name, it doesn't take me there. </p>\n\n<p>Any way to fix this?</p>\n\n<hr>\n\n<p>UPDATE1:\nAlso, Control+Click on a function (declare in the current unit) does not move the cursor in the INTERFACE section where the function is declared. </p>\n\n<p>UPDATE2:<br>\nI temporary put the ExtUtils unit in project's folder and now it works. So, the Control+Click by itself it works but it seems that the IDE has problems finding the unit even it its folder is present in Library Path and Browsing Path.</p>\n\n<p><strong>Similar reports:</strong><br>\n<a href=\"http://webcache.googleusercontent.com/search?q=cache%3auutZnwiqb3gJ%3awww.experts-exchange.com/Programming/Languages/Pascal/Delphi/Q_23956678.html%20%22Control%2bClick%22%20Delphi%20-php&amp;cd=6&amp;hl=en&amp;ct=clnk&amp;client=firefox-a&amp;source=www.google.com\" rel=\"nofollow\">http://webcache.googleusercontent.com</a><br>\n<a href=\"http://webcache.googleusercontent.com/search?q=cache%3aVKlGo0IzzQYJ%3awww.experts-exchange.com/Programming/Languages/Pascal/Delphi/Q_26088365.html%20Delphi%20Bug%20Reporting%20-%20Erratic%20IDE%20Control%20Click&amp;cd=1&amp;hl=en&amp;ct=clnk&amp;client=firefox-a&amp;source=www.google.com\" rel=\"nofollow\">http://webcache.googleusercontent.com</a><br>\n<a href=\"http://cc.embarcadero.com/Item/28269\" rel=\"nofollow\">http://cc.embarcadero.com/Item/28269</a><br>\nOne report right here (see answers below)</p>\n\n<hr>\n\n<p>New test:<br>\nI have fully uninstalled Delphi (and manually delete the files and registry leftovers). Then reinstalled again. NO additional tools except CodeSite were installed, not even the databases. Then I created a new project. It contains a button. When I click the button, it runs the TestMe procedure which is defined in an external PAS file called TestUnit.Pas. I added the path to this library in Library Path and Browsing Path. But the Control+Click on TestMe procedure is still not working! If I hover the mouse over the TestMe procedure, the pop-up says \"Declared in TestUnit\", where the 'TestUnit' word is a blue link. If I click it I hear a Windows system sound but the IDE doesn't take me there (to the unit).</p>\n\n<p>The TestMe procedure is this:</p>\n\n<pre><code>procedure TestMe;\nbegin\n  Beep(800, 500);\nend;\n</code></pre>\n\n<p>If I control+click the Beep procedure, it takes me to Windows.pas. So, this is working.\nPlease let me know if you have in mind a different test.</p>\n\n<p>UPDATE:<br>\nAnd now it works! Without any apparent reasons! I just open and closed and compiled the project. But I make no changes to Delphi except these two: AutoSave options-> Editor files and Project Options.</p>\n\n<p>UPDATE:<br>\nThis cannot be!!!<br>\nSo, now I can access the TestUnit.pas file when I control+click on TestMe procedure.\nSo, I moved the original PAS file (ExtUtils.pas) that didn't wanted to work in my initial test (before Delphi reinstall) in the same folder where TestUnit.pas is. Guess what: I can open (with control+click) to TestUnit.pas but not the ExtUtils.pas!!!!<br>\nDelphi acts so strange and inconsistent!</p>\n\n<p>UPDATE:<br>\nI edited ExtUtils.pas and now I cannot open AGAIN TestUnit.pas.\nKen White won't let me say that Delphi could possible have bugs. So I cannot use the 'bug' together with 'Delphi'. Can anybody put these words together for me?</p>\n\n<p>UPDATE:<br>\nI totally removed any reference to ExtUtils.pas - so I restored the project to the point where it worked (with TestUnit). But now the bug persists. Even if few seconds before it worked with TestUnit now its not working again. </p>\n\n<p>UPDATE:<br>\nNow I realize an important thing: in my source code (in the test project) I have a single line of compilable code:</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nbegin\n TestMe;\nend;\n</code></pre>\n\n<p>The blue dots does not appear for this code - as it wouldn't have been compiled. In those few minutes when the program worked, I have seen the blue dots. \nI have also excluded 'AutoSave options-> Editor files and Project Options' as a possible cause for this issue.</p>\n\n<p>UPDATE:<br>\nI have found a way to fix the problem... for few minutes: I move the project and the library in a different folder (any location will do it). The control+click will work for a while. It even works if I put the files back into the original folder. So, it seems that Delphi keeps some kind of cache of some files. As long as the cache is broken and it keeps the cache, control+click won;t work. But when I move the files, it has to recreate that cache so it will work until the issue reappears and it is stored in the cache.</p>\n"},{"tags":["delphi","com","containers","ole","in-place"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":232,"score":1,"question_id":3972044,"title":"Own \"in-place activation\" OLE Server","body":"<p>I just want to create my own OLE server, which support in-place activation. <BR>\ne.g. In <code>TOlecontrol</code> we can do following:</p>\n\n<pre><code>OleContainer1.CreateObject('WORD.Document',FALSE);\n</code></pre>\n\n<p>That is ok. Word document is embeded into the main application form. But when I tried:</p>\n\n<pre><code>OleContainer1.CreateObject('Server.MyOleServer',FALSE);\n</code></pre>\n\n<p>MyOleServer is allways opened in new separate \"server\" window - form\n(I also checked all values <code>OleControl1.doVerb()</code>, and <code>OleControl1.AllowInPlace := true</code>, but nothing helps. The \"server\" is very simple application, it contains just one empty Form...)</p>\n"},{"tags":["delphi","winsock","ip"],"answer_count":6,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":7085,"score":4,"question_id":576538,"title":"Delphi, How to get all local IPs?","body":"<p>Any one know a way in delphi get a simple list (eg tstrings) of the local ip address.</p>\n\n<p>I have had a look at the other related question, and cant seem to get my head around converting them to delphi.</p>\n"},{"tags":["delphi","com","download-manager"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":12987326,"title":"How to call IDM(Internet Download Manager) from my Delphi application","body":"<p>The <code>IDM</code> offers some API for client applications : <a href=\"http://www.internetdownloadmanager.com/support/idm_api.html\" rel=\"nofollow\">http://www.internetdownloadmanager.com/support/idm_api.html</a></p>\n\n<p>How can I do this via Delphi?</p>\n"},{"tags":["delphi","delphi-xe","chromium"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":148,"score":4,"question_id":12978338,"title":"How do I send post and header data with Chromium?","body":"<p>I am attempting to convert some code from TWebBrowser to Chromium but am having trouble figuring out how to send post and header data with an HTTP request.  </p>\n\n<p>Below is the TWebBrowser functionality I'm trying to implement.</p>\n\n<pre><code>var\nVHeader, PostData: OleVariant;\n\n\nPostData := VarArrayCreate([0, Length(XMLString) - 1], varByte) ;    \nHeaderData := 'Content-Type: application/x-www-form-urlencoded'+ '\\n';\n\nWebBrowser1.Navigate(StrUrl,EmptyParam,EmptyParam,PostData,VHeader);\n</code></pre>\n\n<p>How do I do the equivalent with Chromium?</p>\n"},{"tags":["delphi","animation","delphi-7"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12986712,"title":"How to use animate in Delphi 7","body":"<p>How do I use the animate box that you find in win32 tab in Delphi 7. I have searched the internet but all I found was how to animate your form. The help is appreciated. </p>\n"},{"tags":["sql-server","delphi","delphi-2009","dbexpress"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1383,"score":1,"question_id":2896922,"title":"DBExpress connecting SQL 2008 at runtime with Delphi 2009","body":"<p><br>\nI'm trying to connect at runtime with SQL Server 2008 with Delphi 2009 using DBExpress, it it's not working. When I set all the properties at design time, it works great, but at RunTime, I'm getting \"unknown driver: mssql\". Below is the code: <br></p>\n\n<pre><code>\n  scnConexao := TSQLConnection.Create(nil);\n  scnConexao.DriverName := 'MSSQL';\n  scnConexao.ConnectionName := 'MSSQLConnection';\n  scnConexao.GetDriverFunc := 'getSQLDriverMSSQL';\n  scnConexao.LibraryName := 'dbxmss.dll';\n  scnConexao.VendorLib := 'oledb';\n  scnConexao.LoginPrompt := False;\n  scnConexao.Params.Add('SchemaOverride=sa.dbo');\n  scnConexao.Params.Add('HostName=DESKTOP');\n  scnConexao.Params.Add('DataBase=DBNAME');\n  scnConexao.Params.Add('OS Authentication=False');\n  scnConexao.Params.Add('User_Name=UserName');\n  scnConexao.Params.Add('Password=Password');\n  scnConexao.Params.Add('MSSQL TransIsolation=ReadCommited');\n  scnConexao.Open;\n</code></pre>\n\n<p>I have included the dbxmss.dll in the same directory as my app, but to no avail. Any help would be greatly appreciated. <br>\nTks</p>\n"},{"tags":["delphi","http","delphi-xe2","firemonkey"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":296,"score":1,"question_id":8667219,"title":"How can i use the http.get for delphi xe2 ios firemonkey?","body":"<p>Component or a code to use it for getting a source code of the page in a memo.\nThank you</p>\n"},{"tags":["delphi","passwords"],"answer_count":5,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":1710,"score":9,"question_id":6347686,"title":"How do I conceal the password text in an edit box?","body":"<p>I have an inputbox and would like the user to enter a password, but at the same time hide it. </p>\n\n<p>Is this possible?</p>\n\n<p>This is my code so far: </p>\n\n<pre><code>var password : string;\nbegin\n password := InputBox('Password: ', 'Please enter your password: ', password)\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-xe2","rad-studio","jedi","jedi-code-library"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":121,"score":1,"question_id":12983721,"title":"JCL requires source in Delphi library path","body":"<p>I've installed the JCL into Rad-Studo XE2 and chose the option to modify the library paths as appropriate. This added z:\\3rd party\\Jedi 3.45\\jcl\\lib\\d16\\win32, and z:\\3rd party\\Jedi 3.45\\jcl\\source\\include to the library path in my environment. The win32 directory contains all of the dcu, obj, lib, dcp and res files, freshly compiled, just like it should.</p>\n\n<p>The problem is that if I use a jcl file in my code I am unable to build it unless I add all of the jcl*.pas files to the path. Once I've done that code completion goes for poo, as it seems to be continually recompiling everything.</p>\n\n<p>Where have I gone wrong? </p>\n\n<p><img src=\"http://i.stack.imgur.com/giSXO.png\" alt=\"Library path screenshot\"></p>\n"},{"tags":["delphi","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12983225,"title":"Delete a listbox item in OnDraw?","body":"<p>I have a listbox and add items to it, items are address of files, items are added after some processes and they are inserted like this:</p>\n\n<pre><code>Listbox_Browser.Items := myItems;\n</code></pre>\n\n<p>so as im not adding them one by one i cant check them during inserting ti listbox, i tried to check them in OnDraw and used a code like this: </p>\n\n<pre><code>  Try\n    FileOpenandP(Listbox_Browser.Items[Index]);\n  Except\n    ListBox_Browser.Items.Delete(Index);\n  End;\n</code></pre>\n\n<p>but i got the error \"List index out of bounds\", what is the solution?</p>\n"},{"tags":["arrays","delphi","hex","byte","delphi-xe2"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":159,"score":0,"question_id":12981308,"title":"Delphi - BinToHex and HexToBin : Reversal","body":"<p>I have an array of byte that I wish to convert into a hex string, and then back into an array of byte.</p>\n\n<p>I am using the following to convert into a hex string:</p>\n\n<pre><code>function bintoHex(const bin: array of byte): String;\nconst HexSymbols = '0123456789ABCDEF';\nvar i: integer;\nbegin\n  SetLength(Result, 2*Length(bin));\n  for i :=  0 to Length(bin)-1 do begin\n    Result[1 + 2*i + 0] := HexSymbols[1 + bin[i] shr 4];\n    Result[1 + 2*i + 1] := HexSymbols[1 + bin[i] and $0F];\n  end;\nend;\n</code></pre>\n\n<p>I am unsure how to convert it back into an array of byte properly. I am shooting for something like the following:</p>\n\n<pre><code>Type TDCArray = Array of Byte;\n\nfunction xHexToBin(const HexStr: String): TDCArray;\nconst HexSymbols = '0123456789ABCDEF';\nvar i: integer;\nbegin\n  SetLength(Result, ???); //Need to now get half of the length, unsure how to go about that\n  for i :=  0 to Length(HexStr)-1 do begin\n    //Here convert back into an array somehow...\n    //Result[i] := ???\n  end;\nend;\n</code></pre>\n\n<p>How would I go about doing this?</p>\n\n<p>Also, I am using Delphi XE2.</p>\n"},{"tags":["html","delphi","source"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":137,"score":1,"question_id":12967699,"title":"Delphi: Getting the right source from web pages","body":"<p>I'm using Delphi and I'm trying to get the source from web pages.  Here is my problem, I tried to get the source for a simple (well probably not) web page with Indy (idHttp) and Clever Components (clHttp).  They both returned the same results.  However, if I use IE and/or Google Chrome, they both give the same results but different as the Delphi components (Indy and Clever).  The Delphi components returned source with many objects missing.  However the browsers view source options returned all the code and objects I need.  Finally my question is, is there any way I could retrieve a web page source with Delphi exactly the same way as the ones showing by the browsers ?</p>\n\n<p>Thanks in advance</p>\n\n<p>Mike</p>\n\n<p>Edit: Looks like any of the delphi components can handle the span tags</p>\n"},{"tags":["delphi","winapi","keyboard","delphi-7"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":191,"score":2,"question_id":12973296,"title":"How can I detect how long a key has been held down?","body":"<p>I'm looking for a way to detect how long a key has been held down in a Delphi project and warn user.</p>\n\n<p>I'm working on a chat program and need to see if the person is holding down a letter, like the W key, to spam that chat box. I'll give sample what trying to do in Delphi 7:</p>\n\n<pre><code>//Looking up if key in use and held for lets say 20 seconds\nif (GetAsyncKeyState(Byte(VkKeyScan('W'))) shl 20) &lt;&gt; 0 then\nbegin\n  ShowMessage('W Key Held down too long!');\nend;\n</code></pre>\n\n<p>I'm not sure whether GetAsyncKeyState will give me that information, though. If it doesn't, what will?</p>\n"},{"tags":["delphi","version-control","beyondcompare"],"answer_count":3,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":5655,"score":10,"question_id":3668439,"title":"How do I make Beyond Compare ignore certain differences while comparing versions of Delphi Form Files","body":"<p>I use Beyond Compare (version 3.1.10) to compare different versions of Delphi Form Files, but I don't want to see differences concerning ExplicitTop, ExplicitLeft, ExplicitHeight and ExplicitWidth. </p>\n\n<p>Details:\nThese lines will always begin with a number of whitespace characters, then \"ExplicitXXX = \" and a number. Older versions of Delphi didn't have these lines, so I want to ignore differences where these lines are added to the newest version, and I also want to ignore differences where the number has changed.</p>\n\n<p>Does anyone know how to do this?</p>\n\n<p>Edit:\nDuplicate (more or less) of:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/3652301/how-do-i-configure-beyondcompare-to-ignore-scm-replaced-text-in-comments\">http://stackoverflow.com/questions/3652301/how-do-i-configure-beyondcompare-to-ignore-scm-replaced-text-in-comments</a></p>\n"},{"tags":["windows","delphi","ssd"],"answer_count":5,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":1837,"score":8,"question_id":908188,"title":"Is there any way of detecting if a drive is a SSD?","body":"<p>I'm getting ready to release a tool that is only effective with regular hard drives, not SSD (solid state drive). In fact, it shouldn't be used with SSD's because it will result in a lot of read/writes with no real effectiveness.</p>\n\n<p>Anyone knows of a way of detecting if a given drive is solid-state?</p>\n"},{"tags":["delphi","delphi-7"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":91,"score":1,"question_id":12963060,"title":"How draw an antialias ellipse in delphi 6 without GDI+?","body":"<p>I need to draw an antialias ellipse on bitmap.\nI do'nt love use GDI+.\nhow do it?</p>\n"},{"tags":["sql","sql-server-2008","delphi","delphi-2009"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":165,"score":3,"question_id":12970913,"title":"How to fetch record count from ADO Query?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4237112/how-to-see-progress-of-query-execution-during-handle\">How to see progress of query execution during handle?</a>  </p>\n</blockquote>\n\n\n\n<p>I would like to show a progress bar indicating how much time it would take to fetch the results from database.  </p>\n\n<p>I use <code>TADOQuery</code> and open it in Async mode.  While the query state is <code>stFetching</code>, is there any way to know the [number of records fetched / total records]?</p>\n"},{"tags":["delphi","datetime"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1411,"score":6,"question_id":4122218,"title":"In Delphi: How do I round a TDateTime to closest second, minute, five-minute etc?","body":"<p>Does there exist a routine in Delphi that rounds a TDateTime value to the closest second, closest hour, closest 5-minute, closest half hour etc? </p>\n\n<p>UPDATE:</p>\n\n<p>Gabr provided an answer. There were some small errors, possibly due to the complete lack of testing ;-)</p>\n\n<p>I cleaned it up a bit and tested it, and here's the final(?) version:</p>\n\n<pre><code>function RoundDateTimeToNearestInterval(vTime : TDateTime; vInterval : TDateTime = 5*60/SecsPerDay) : TDateTime;\nvar\n  vTimeSec,vIntSec,vRoundedSec : int64;\nbegin\n  //Rounds to nearest 5-minute by default\n  vTimeSec := round(vTime * SecsPerDay);\n  vIntSec := round(vInterval * SecsPerDay);\n\n  if vIntSec = 0 then exit(vTimeSec / SecsPerDay);\n\n  vRoundedSec := round(vTimeSec / vIntSec) * vIntSec;\n\n  Result := vRoundedSec / SecsPerDay;\nend;\n</code></pre>\n"},{"tags":["delphi","browser","delphi-xe2","firemonkey"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":2692,"score":8,"question_id":7443264,"title":"How to open an URL with the default browser with FireMonkey cross-platform applications?","body":"<p>Usually, I use: <code>ShellExecute(0, 'OPEN', PChar(edtURL.Text), '', '', SW_SHOWNORMAL);</code></p>\n\n<p>How can I have the same behaviour (opening a link in the default browser), on all platforms (Windows <strong>and</strong> OSX)?</p>\n"},{"tags":["delphi","pointers","byte","reverse"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":153,"score":3,"question_id":12966182,"title":"Delphi Reverse order of bytes","body":"<p>I have been trying to write a function that takes two pointers (an input and an output) and writes the bytes from the input into the output in reverse order.  So far I have not been able to make it work correctly.</p>\n\n<pre><code>procedure ReverseBytes(Source, Dest: Pointer; Size: Integer);\nvar\n  Index: Integer;\nbegin\n  Move(Pointer(LongInt(Source) + Index)^, Pointer(LongInt(Dest) + (Size - Index))^ , 1);   \nend;\n</code></pre>\n\n<p>Can anyone please suggest a better way of doing this.  </p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","encoding","character-encoding"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":323,"score":5,"question_id":6895009,"title":"How to detect if a string is Base64Encoded or not?","body":"<p>Which is the best method to detect if a string is Base64Encoded or not (using Delphi)? </p>\n"},{"tags":["delphi","wav","sapi"],"answer_count":1,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":141,"score":9,"question_id":12879417,"title":"text-to-speech-to-wav in Delphi","body":"<p>I imported the SAPI type library into Delphi.  I can output speech to the PC speakers with this code:</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar\n  Voice: TSpVoice;\nbegin\n  Voice := TSpVoice.Create(nil);\n  Voice.Speak('Hello World!', 0);\nend;\n</code></pre>\n\n<p>I can output speech to a <code>.wav</code> file with this code:</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar\n  Voice: TSpVoice;\n  Stream: TSpFileStream;\nbegin\n  Voice := TSpVoice.Create(nil);\n  Stream := TSpFileStream.Create(nil);\n  Stream.Open('c:\\temp\\test.wav', SSFMCreateForWrite, False);\n  Voice.AudioOutputStream := Stream.DefaultInterface;\n  Voice.Speak('Hello World!', 0);\n  Stream.Close;\nend;\n</code></pre>\n\n<p>The problem is that when I play back the <code>.wav</code> file it sounds terrible, like it's using a really low bitrate.  Audacity tells me the file is mono 16-bit 22.05kHz but it sounds much worse than that.</p>\n\n<p>How do I output speech to a mono 16-bit 44.1kHz <code>.wav</code> file that will sound exactly the same as speech output directly to the PC speakers?  I could not figure out how to modify the second code sample to set the bits per sample and the bitrate.</p>\n\n<p><strong>Follup-up:</strong> Glenn's answer solves the bitrate issue.  Thanks for that.  But the quality of the speech output to the <code>.wav</code> file is still inferior to what is output directly to the speakers.  I used screen recording software to record the output from the first block of code as <a href=\"http://www.jgsoft.com/support/helloworldtospeakers.wav\" rel=\"nofollow\">helloworldtospeakers.wav</a>.  The second block of code, with Glenn's line added, produces <a href=\"http://www.jgsoft.com/support/helloworldtowav.wav\" rel=\"nofollow\">helloworldtowav.wav</a>.  The second file clearly has some distortion to it.  Any ideas?</p>\n"},{"tags":["delphi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12966371,"title":"How to synchronize ElTreeItem with its checkbox(Radiobutton)?","body":"<p>Well, there is some problem I am having with this element.</p>\n\n<p>Let ElTreeItem ShowCheckBox be true.</p>\n\n<p>Click the ElTreeItem CheckBox(Radiobutton).</p>\n\n<p><img src=\"http://i.stack.imgur.com/Iteal.png\" alt=\"enter image description here\"></p>\n\n<p>ElTree.Selected is nil(null)</p>\n\n<p>Click the ElTreeItem Text(If its index = 2)</p>\n\n<p><img src=\"http://i.stack.imgur.com/vlHXu.png\" alt=\"enter image description here\"></p>\n\n<p>ElTree.Selected.Index = 2;</p>\n\n<p>Click the ElTreeItem CheckBox(Radiobutton)(If it is in index = 0).</p>\n\n<p><img src=\"http://i.stack.imgur.com/EBDYK.png\" alt=\"enter image description here\"></p>\n\n<p>ElTree.Selected.Index = 2(still 2...)</p>\n\n<p>How can I fix this problem?</p>\n"},{"tags":["delphi","delphi-2007","vcl","tcxgrid","tlist"],"answer_count":2,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":612,"score":3,"question_id":7970017,"title":"tcxGrid using TList as a DataSource","body":"<p>I'm wondering if it's possible to bind a TList object as a cxGrid datasource.</p>\n\n<p>So what I have is a TList object containing various objects that i do not need to persist.\nI want a sort of GridView to serve as an overview of \"selected items\", and the selected items being the objects in the list.</p>\n\n<p>It would be preferable that the columns were to be defined by the object type stored in the TList.</p>\n\n<p>Is this easily doable, and if so would you be able to give me an overview of how this is done.\nI'm currently using a ListBox that uses tabWidth as a sort of column seperator but would prefer to make the switch.</p>\n"},{"tags":["delphi","video"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":102,"score":3,"question_id":12966946,"title":"How to get the installed video card ( Delphi)","body":"<p>Looking for a way to find the installed video card (Chip) on a windows computer.</p>\n\n<p>A solution that supports XP thru Win 7.</p>\n\n<p>I am using Delphi 2010.</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":129,"score":2,"question_id":12930757,"title":"What's the simplest way to monitor for changes to a single file?","body":"<p>Should I look at shell notifications? Is there a good free component, or some example source code?</p>\n\n<p>Or should I just start a one second timer and check the file's timestamp periodically?</p>\n\n<p>It doesn't have to be elegant, just the simplest that will work. I am more interested in the processing which I will do when the file changes (it's a log file, whenever it gets updated I want to parse it and show some details of the test run).</p>\n"},{"tags":["delphi","proxy","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12966450,"title":"IdMappedPortTCP - No Events","body":"<p>I have a the indy component:</p>\n\n<pre><code>IdMappedPortTCP1: TIdMappedPortTCP;\n</code></pre>\n\n<p>and the following initialization:</p>\n\n<pre><code>procedure TForm1.FormCreate(Sender: TObject);\nbegin\n  Memo1.Lines.Clear;\n  IdMappedPortTCP1.MappedHost := '189.200.10.71';\n  IdMappedPortTCP1.MappedPort := 5300;\n  IdMappedPortTCP1.Active := true;\nend;\n\nprocedure TForm1.IdMappedPortTCP1Execute(AContext: TIdContext);\nbegin\n  Memo1.Lines.Add(AContext.Data.ToString);\n  Memo1.Lines.Add('------');\nend;\n\nprocedure TForm1.IdMappedPortTCP1OutboundData(AContext: TIdContext);\nbegin\n  Memo1.Lines.Add(AContext.Data.ToString);\n  Memo1.Lines.Add('+++++++'); //\nend;\n</code></pre>\n\n<p>My other application connects to 189.200.10.71:5300 but the component is not firing...</p>\n\n<p>Where is my fault?</p>\n\n<p>Using XE3 with the include indy components</p>\n"},{"tags":["delphi","firebird","uib"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":12962819,"title":"Firebird error message \"Unsuccessful execution caused by a system error that precludes successful execution of subsequent statements\"","body":"<p>My application generates sometimes this kind of errors when accessing Firebird database:</p>\n\n<blockquote>\n  <p>Unsuccessful execution caused by a system error that precludes\n  successful execution of subsequent statements GDS Code: 335544726 -\n  SQL Code: -902 - Error Code: 406'</p>\n</blockquote>\n\n<p>What could be the problem? Is there any way to debug this?</p>\n\n<p>I'm running Firebird 2.5.1 on Windows 7. There are at least kinterbasdb with Python and UIB components with Delphi in use.</p>\n"},{"tags":["delphi","drag-and-drop","delphi-xe2"],"answer_count":1,"favorite_count":5,"up_vote_count":6,"down_vote_count":0,"view_count":139,"score":6,"question_id":12959880,"title":"How to detect a drag drop outside your application?","body":"<p>I'm trying to emulate the tab dragging functionality of Chrome. I want the user to be able to drag a tab to a new location in the tab strip or drop it outside the application to create a new window. Dragging within the application is easy, but how do I detect when a user drops somewhere not on my app?</p>\n\n<p>In essence I am looking to implement \"tear off\" tabs.</p>\n"},{"tags":["delphi","firemonkey","keyevent","multiplatform"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12964624,"title":"FireMonkey: How to focus the next control on vkReturn?","body":"<p><a href=\"http://stackoverflow.com/questions/6773400/focus-next-control-on-enter-in-overrided-keyup\">Classic VCL question</a>... but how to do the same within <strong>FireMonkey</strong>?</p>\n\n<p>I have several standard <code>TControl</code> who can focus...</p>\n\n<p>For instance, in some <code>TEdit</code>, I want to move to the next focusable control if I press the <code>return key</code></p>\n\n<p>I have try different approach but without success (replacing the key, keychar with 9 when it's 13, ..., forwarding the key events to the form, ...)</p>\n\n<p>Of course, as it is FMX, I'd like a solution which works on all platforms...</p>\n\n<p>If it can <strong>avoid</strong> to:</p>\n\n<ul>\n<li>browse the Children property of the parents,</li>\n<li>have different pieces of code to address the different platforms</li>\n<li>hard-code the <em>tab sequence</em></li>\n<li>..., it will be great  ;o)</li>\n</ul>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":7,"up_vote_count":18,"down_vote_count":0,"view_count":794,"score":18,"question_id":9349530,"title":"Why can a WideString not be used as a function return value for interop?","body":"<p>I have, one more than one occasion advised people to use a return value of type <code>WideString</code> for interop purposes. </p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/8533505/accessing-delphi-dll-throwing-ocasional-exception\">Accessing Delphi DLL throwing ocasional exception</a></li>\n<li><a href=\"http://stackoverflow.com/questions/9322938/asp-net-web-app-calling-delphi-dll-on-iis-webserver-locks-up-when-returning-pch/9328272#9328272\">ASP.NET web app calling Delphi DLL on IIS webserver, locks up when returning PChar string</a></li>\n<li><a href=\"http://stackoverflow.com/questions/9331026/why-can-delphi-dlls-use-widestring-without-using-sharemem\">Why can Delphi DLLs use WideString without using ShareMem?</a></li>\n</ul>\n\n<p>The idea is that a <code>WideString</code> is the same as a <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms221105.aspx\" rel=\"nofollow\"><code>BSTR</code></a>. Because a <code>BSTR</code> is allocated on the shared COM heap then it is no problem to allocate in one module and deallocate in a different module. This is because all parties have agreed to use the same heap, the COM heap.</p>\n\n<p>However, it seems that <code>WideString</code> cannot be used as a function return value for interop.</p>\n\n<p>Consider the following Delphi DLL.</p>\n\n<pre><code>library WideStringTest;\n\nuses\n  ActiveX;\n\nfunction TestWideString: WideString; stdcall;\nbegin\n  Result := 'TestWideString';\nend;\n\nfunction TestBSTR: TBstr; stdcall;\nbegin\n  Result := SysAllocString('TestBSTR');\nend;\n\nprocedure TestWideStringOutParam(out str: WideString); stdcall;\nbegin\n  str := 'TestWideStringOutParam';\nend;\n\nexports\n  TestWideString, TestBSTR, TestWideStringOutParam;\n\nbegin\nend.\n</code></pre>\n\n<p>and the following C++ code:</p>\n\n<pre><code>typedef BSTR (__stdcall *Func)();\ntypedef void (__stdcall *OutParam)(BSTR &amp;pstr);\n\nHMODULE lib = LoadLibrary(DLLNAME);\nFunc TestWideString = (Func) GetProcAddress(lib, \"TestWideString\");\nFunc TestBSTR = (Func) GetProcAddress(lib, \"TestBSTR\");\nOutParam TestWideStringOutParam = (OutParam) GetProcAddress(lib,\n                   \"TestWideStringOutParam\");\n\nBSTR str = TestBSTR();\nwprintf(L\"%s\\n\", str);\nSysFreeString(str);\nstr = NULL;\n\nTestWideStringOutParam(str);\nwprintf(L\"%s\\n\", str);\nSysFreeString(str);\nstr = NULL;\n\nstr = TestWideString();//fails here\nwprintf(L\"%s\\n\", str);\nSysFreeString(str);\n</code></pre>\n\n<p>The call to <code>TestWideString</code> fails with this error:</p>\n\n<blockquote>\n  <p>Unhandled exception at 0x772015de in BSTRtest.exe: 0xC0000005: Access violation reading location 0x00000000.</p>\n</blockquote>\n\n<p>Similarly, if we try to call this from C# with p/invoke, we have a failure:</p>\n\n<pre><code>    [DllImport(@\"path\\to\\my\\dll\")]\n    [return: MarshalAs(UnmanagedType.BStr)]\n    static extern string TestWideString();\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>An unhandled exception of type 'System.Runtime.InteropServices.SEHException'\noccurred in ConsoleApplication10.exe\n\nAdditional information: External component has thrown an exception.\n</code></pre>\n\n<p>Calling <code>TestWideString</code> via p/invoke works as expected.</p>\n\n<p>So, use pass-by-reference with  WideString parameters and mapping them onto <code>BSTR</code> appears to work perfectly well. But not for function return values. I have tested this on Delphi 5, 2010 and XE2 and observe the same behaviour on all versions.</p>\n\n<p>Execution enters the Delphi and fails almost immediately. The assignment to <code>Result</code> turns into a call to <code>System._WStrAsg</code>, the first line of which reads:</p>\n\n<pre><code>CMP     [EAX],EDX\n</code></pre>\n\n<p>Now, <code>EAX</code> is <code>$00000000</code> and naturally there is an access violation.</p>\n\n<p>Can anyone explain this? Am I doing something wrong? Am I unreasonable in expecting <code>WideString</code> function values to be viable <code>BSTR</code>s? Or is it just a Delphi defect?</p>\n"},{"tags":["delphi","class","dll","delphi-xe"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":160,"score":2,"question_id":12954973,"title":"Putting classes in a DLL?","body":"<p>Is it possible to put some classes into a DLL?</p>\n\n<p>I have several custom classes in a project I am working on and would like to have them put in a DLL and then accessed in the main application when needed, plus if they are in a DLL I can reuse these classes in other projects if I need to.</p>\n\n<p>I found this link: <a href=\"http://www.delphipages.com/forum/showthread.php?t=84394\" rel=\"nofollow\">http://www.delphipages.com/forum/showthread.php?t=84394</a> which discusses accessing classes in a DLL and it mentions delegating to a class-type property but I could not find any further information on this in the Delphi help or online.</p>\n\n<p>Is there any reason I should not put classes in a DLL, and if it is ok is there a better way of doing it then in the example from the link above?</p>\n\n<p>Thanks</p>\n"},{"tags":["string","delphi","delphi-xe2","refcounting"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":200,"score":4,"question_id":12837129,"title":"string := const : why different implementation for local and result?","body":"<p>In Delphi function result is frequently implemented as var-parameter (not out-parameter despite QC ticket).</p>\n\n<p>String constants are basically variables with negative refcounter, which should suppress automatic memory [de]allocation. <a href=\"http://docwiki.embarcadero.com/RADStudio/XE3/en/Internal_Data_Formats#Long_String_Types\" rel=\"nofollow\">http://docwiki.embarcadero.com/RADStudio/XE3/en/Internal_Data_Formats#Long_String_Types</a></p>\n\n<p>It really does suppress it: the code below does not leak.</p>\n\n<pre><code>type\n  TDealRecord = record\n    id_Type: Integer;\n    Price: extended;\n    Remark: String;\n  end;\nconst const_loop = 100000000;\n\nfunction TestVar: TDealRecord;\n//procedure TestVar;\nvar\n  Li: Integer;\n  LRec: TDealRecord;\nbegin\n  for Li := 1 to const_loop do begin\n     FillChar(Lrec,SizeOf(LRec), 0);\n     LRec.Remark := 'Test';\n\n//     FillChar(Result,SizeOf(Result), 0);\n//     Result.Remark := 'Test';\n  end;\nend;\n</code></pre>\n\n<p>But change the manipulated variable - and it immediately starts to leak heavily.</p>\n\n<pre><code>function TestVar: TDealRecord;\n//procedure TestVar;\nvar\n  Li: Integer;\n  LRec: TDealRecord;\nbegin\n  for Li := 1 to const_loop do begin\n//     FillChar(Lrec,SizeOf(LRec), 0);\n//     LRec.Remark := 'Test';\n\n     FillChar(Result,SizeOf(Result), 0);\n     Result.Remark := 'Test';\n  end;\nend;\n</code></pre>\n\n<p>It turns out that <code>string := const</code> is implemented with different calls, depending on LValue:</p>\n\n<ol>\n<li>Result: AnsiString -> LStrAsg</li>\n<li>Result: UnicodeString: -> UStrAsg</li>\n<li>Local var: UnicodeString: -> UStrLAsg</li>\n<li>Local var: AnsiString: -> LStrLAsg</li>\n</ol>\n\n<p>And while the latter two are cloning pointer as expected, the former two are copying the string to new instance, like if i add <code>UniqueString</code> call to them.</p>\n\n<p>Why that difference ?</p>\n"},{"tags":["delphi","parameters"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":12958858,"title":"Why can I not use SetLength in a function which receives an array parameter?","body":"<p>I am trying to use the following function to set the length of a dynamic array which is a var param.\nThere is only  an error when I try to compile the code:</p>\n\n<p>[dcc64 Error] lolcode.dpr(138): E2008 Incompatible Types</p>\n\n<pre><code>function execute(var command : array of string) : Boolean;\nbegin\n  // Do something\n  SetLength(command,0);\nend;\n</code></pre>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":336,"score":-4,"question_id":8715834,"title":"Radio buttons in Delphi","body":"<p>I grouped four radio buttons on the radiogroup.  There are create file, create folder, delete and copy radio buttons, but I am having a problem with the copy button.</p>\n\n<p>It's mostly working alright but the message window (saying where the file was copied to the hard drive) is not closing.  How can i make it close?  Or is there a way to refresh the radio buttons?</p>\n\n<p>This is a homework problem.</p>\n\n<p>Here is my code:</p>\n\n<pre><code> procedure TForm1.btnsubmitClick(Sender: TObject);\n  var\n    i,j,k,t,index,pred,delp,temp,temp2:integer;\nbegin\nif rbtncreatefolder.checked = true then\n     begin\n    if (length(edit3.Text)&gt;0) and (edit3.Text&lt;&gt;'..') then begin\n        if (VS&gt;=3)   then  begin\n        if sush(true,nk1,edit3.Text) then  begin\n\n        i:=tabld[nk1].nach;\n        while fat[i]&lt;&gt;1024 do i:=fat[i];\n        fat[i]:=freep(i);\n        tabld[fat[i]].name:=edit3.Text;\n       tabld[fat[i]].format:='';\n        tabld[fat[i]].tip:=true;\n        fat[fat[i]]:=1024;\n        k:=freep(fat[i]);\n        tabld[fat[i]].nach:=k;\n        tabld[k].name:='.';\n        tabld[k].tip:=true;\n        tabld[k].nach:=fat[i];\n        t:=freep(k);\n        fat[k]:=t;\n        tabld[t].name:='..';\n        tabld[t].tip:=true;\n        tabld[t].nach:=nk1;\n        fat[t]:=1024;\n        tabld[fat[i]].razmer:=0;\n        tabld[i].razmer:=tabld[i].razmer+1;\n      reload;\n        end\n        end\n        else\n            showmessage('Not enough free memory!');\n    end\n    else\n      showmessage('Incorrect data or absent!');\nend\nelse if rbtncreatefile.Checked = true then\n  begin\n    if (length(edit3.Text)&gt;0) and (length(edit4.Text)&gt;0)then begin\n        if strtoint(edit4.Text)&lt;32*VS then begin\n         if  sush(false,nk1,edit3.Text) then begin\n\n        i:=tabld[nk1].nach;\n        while fat[i]&lt;&gt;1024 do i:=fat[i];\n        fat[i]:=freep(i);\n        tabld[fat[i]].name:=edit3.Text;\n        tabld[fat[i]].format:=copy(edit3.Text,length(edit3.Text)-4,3);\n        tabld[fat[i]].tip:=false;\n        tabld[fat[i]].razmer:=strtoint(edit4.Text);\n        if radiobutton1.Checked then\n             tabld[fat[i]].format:='txt'\n        else\n             tabld[fat[i]].format:='bin';\n        tabld[fat[i]].nach:=freep(fat[i]);\n        k:=tabld[fat[i]].nach;\n        fat[fat[i]]:=1024;\n        for j:=1 to (tabld[fat[i]].razmer-9) div 32 do begin\n            fat[k]:=freep(k);\n            k:=fat[k];\n        end;\n        fat[k]:=1024;\n        reload;\n        end\n        end\n        else\n            showmessage('Not enough free memory!');\n    end\n    else\n        showmessage('You did not enter name and \\ or File Size!');\nend\n else if rbtndelete.checked = true then\n  begin\nif listbox1.ItemIndex&gt;=0 then begin\n    if listbox1.Items.Strings[listbox1.ItemIndex]&lt;&gt;'dir&gt;..' then begin\n    pred:=tabld[nk1].nach;\n    index:=tabld[nk1].nach;\n    for i:=0 to  listbox1.ItemIndex do begin\n       index:=fat[index];\n       if i&gt;0 then\n          pred:=fat[pred];\n    end;\n    delP:=index;\n    fat[pred]:=fat[index];\n    if tabld[index].tip then begin\n    showmessage('directory \"'+tabld[index].name+'\" and all its subdirectories have been deleted!');\n        rekur(tabld[delp].nach);\n        fat[delp]:=0;\n        fat[tabld[delp].nach]:=0;\n    end\n    else begin\n    showmessage('file \"'+tabld[index].name+'.'+tabld[index].format+'\" was removed!');\n        i:=tabld[index].nach;\n        while fat[i]&lt;&gt;1024 do begin\n         j:=i;\n         i:=fat[i];\n         fat[j]:=0;\n        end;\n        fat[i]:=0;\n        fat[index]:=0;\n        end;\n        reload;\n    end\n    else\n      showmessage('You can not delete this directory!');\nend\nelse\n    showmessage('You did not select the folder to delete!');\nend\n\nelse if rbtncopy.checked = true then\n   begin\nif listbox1.ItemIndex&gt;=0 then begin\n    if listbox1.Items.Strings[listbox1.ItemIndex]&lt;&gt;'dir&gt;..' then begin\n        index:=tabld[nk1].nach;\n        for i:=0 to  listbox1.ItemIndex do\n          index:=fat[index];\n        if tabld[index].tip then begin\n          showmessage('directory \"'+tabld[index].name+'\" and all its subdirectories are copied to the directory \"'+edit2.text+'\" !');\n          temp:=nk1;\n          nk1:=nk2;\n          edit3.Text:=tabld[index].name;\n          btnsubmit.Click;\n          temp2:=tabld[nk2].nach;\n                while   (fat[temp2]&lt;&gt;1024) and (tabld[temp2].name&lt;&gt;tabld[nk1].name) do temp2:=fat[temp2];\n          rekurC(fat[tabld[index].nach],temp2);\n          nk1:=temp;\n        end\n        else begin\n          showmessage('file \"'+tabld[index].name+'.'+tabld[index].format+'\" was copied to directory \"'+edit2.Text+'\"!');\n          temp:=nk1;\n          nk1:=nk2;\n          edit3.Text:=tabld[index].name;\n          edit4.Text:=inttostr(tabld[index].razmer);\n          btnsubmit.Click;\n          nk1:=temp;\n        end\n    end\n    else\n      showmessage('This directory may not be copied!');\nend\nelse\n    showmessage('You have not picked anything up to copy!');\n            reload;\n\nend\n\nelse\n showmessage('select an operator please');\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12961985,"title":"Sharing data between two dynamic packages","body":"<p>I'm loading two packages in run-time (by <code>LoadPackage()</code>) and I want to share some data between them (for example between two forms I created from these packages). How can I achieve that?</p>\n"},{"tags":["delphi","automation","outlook"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12951408,"title":"Issue when sorting items in Outlook folder","body":"<p>I am calling sort on an Outlook folder, trying to <strong>sort by received time</strong>.  However when the folder contains a non-email item (<em>a <code>Task</code></em>), I get an error saying that the <code>ReceivedTime</code> property does not exists.  </p>\n\n<pre><code>oFolderItems := oFolder.Items;\noFolderItems.sort('ReceivedTime',2);  //2 = Descending\n</code></pre>\n\n<p>The reason for the sorting is that for some users there can be thousands of emails in the folder I am accessing, and they only want to see the x number of latest one.  </p>\n\n<p>Any tips on how to avoid the non-email items?</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":127,"score":2,"question_id":12960702,"title":"enum from string","body":"<p>Given the following declarations below, is there a way to retrieve the enum value (e.g. jt_one) from a string value (e.g. 'one')?</p>\n\n<pre><code>type\n TJOBTYPEENUM =(jt_one, jt_two, jt_three);\n\n\nCONST JOBTYPEStrings : ARRAY [jt_one..jt_three] OF STRING =\n     ('one','two','three');\n</code></pre>\n\n<p>Or do i need to create my own function using a nested set of if statements?</p>\n\n<p>NOTE: I am not looking for the string \"jt_one\"</p>\n"},{"tags":["xml","delphi","networking","idhttp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":73,"score":-2,"question_id":12950087,"title":"XML response from the server idhttp","body":"<p>Get send request to the server and receives an error 409, the program is suspended, using try except and ignore her, I had also an error 409 and XML response, how do I read it?</p>\n\n<p>HTTP.Response.gettext - not give it to me, only the information about the server</p>\n\n<p>http.response.rawheaders.commatext - only the information about the server</p>\n\n<p>content lenght matches</p>\n\n<p>The answer can be seen in the sniffer</p>\n\n<p>I get an answer in the program?</p>\n"},{"tags":["delphi","object","constructor"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":147,"score":1,"question_id":12953393,"title":"Why Delphi XE3 gives \"E2382 Cannot call constructors using instance variables\"?","body":"<p>I have a simple piece of code, that compiles in Delphi XE2 but not in XE3, and I don't know why. I have reduced the problematic code to a small bit and would like to know what's wrong with it in Delphi's opinion. Trying to compile a project containing this unit in Delphi XE 2 works fine, but in Delphi XE3 (trial), it gives \"[dcc32 Error] AffineTransform.pas(26): E2382 Cannot call constructors using instance variables\". The only \"eccentric\" thing I know of here is the use of the old-school \"object\" type, where the constructor isn't really exactly the same thing as in real objects (TObject-based class instances).</p>\n\n<p>If I replace the words 'constructor' in this object with 'procedure', then it compiles ok, but why is this, and is this an ok change to do in my code, i.e. is it a change that will have no effect on the functionality?</p>\n\n<pre><code>unit AffineTransform;\n\ninterface\n\ntype\n  { Rectangular area. }\n  TCoordRect = object\n  public\n    Left, Top, Right, Bottom: Real;\n    constructor CreatePos(ALeft, ATop, ARight, ABottom: Real);\n    procedure   Include(AX, AY: Real);\n  end;\n\nimplementation\n\nconstructor TCoordRect.CreatePos(ALeft, ATop, ARight, ABottom: Real);\nbegin\n  Left := ALeft;\n  Top := ATop;\n  Right := ARight;\n  Bottom := ABottom;\nend;\n\nprocedure TCoordRect.Include(AX, AY: Real);\nbegin\n  CreatePos(AX, AY, AX, AY)\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","scroll","delphi-2006"],"answer_count":2,"favorite_count":5,"up_vote_count":1,"down_vote_count":0,"view_count":128,"score":1,"question_id":12955008,"title":"How can I fix the TScrollBar MouseWheel malfunction?","body":"<p>I have a <a href=\"http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.Forms.TScrollBox\" rel=\"nofollow\"><code>TScrollBox</code></a> inside of a <code>TFrame</code> and when I use my mouse's wheel it simply does not goes up nor down the ScrollBox scrolling.</p>\n\n<p>I have tried to use </p>\n\n<pre><code>TScrollBox(Sender).Perform(WM_VSCROLL,1,0); \n</code></pre>\n\n<p>on the <code>FrameMouseWheelDown</code> but it does not trigger.</p>\n\n<p>Any Ideas?</p>\n"},{"tags":["c++","delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":111,"score":4,"question_id":12956967,"title":"FStream reading a binary file written with Delphi's binary writer","body":"<p>im creating a dll in MS Visual Studio 2010 Express which loads a binary data file (*.mgr extension -> used exclusively in my company's applications) using fstream library in C++. The file is created with an app developed by someone else in my company who is using Delphi. He says the first 15 bytes should be some characters which indicate the date the file was created and some other stuff like version of the app:</p>\n\n<p>\"XXXX 2012\".</p>\n\n<p>The result after loading with fstream (in binary mode) and writing another file with fstream (string mode) is as follows:</p>\n\n<p>\"[] X X X X 2 0 1 2\"</p>\n\n<p>The first char is an unknown char (rectangle) then there are spaces between each char. Finally it is 31 bytes wide. 15 for actual chars + 15 for white spaces + 1 for the rect char = 31.</p>\n\n<p>Some other information:\nI'm using C++, the app developer is using Delphi.\nIm using fstream. he is using BW.Write() function. (BW == Binary Writer?)\nHe uses Windows 7 whilst i use Windows XP Professional.</p>\n\n<p>Can you make a diagnosis of the problem?</p>\n\n<p>Thanks in advance</p>\n\n<p><strong>First Edit</strong>: I'm adding c++ code that loads those first bytes.</p>\n\n<p>Firstly he is using Delphi XE2 from embarcadero Rad Studio XE2.</p>\n\n<p>From what i know PChar is a null-terminated string consisting of widechars (since delphi 2009) which are 2 bytes wide as opposed to normal chars (one byte). So basically he's saving words instead of bytes.</p>\n\n<p>here is the code loading the mgr:</p>\n\n<pre><code>wchar_t header[15];\nDXFLIBRARY_API void loadMGR(const char* szFileName, const char* szOutput)\n{\nfstream file;\nfile.open( szFileName, ios::binary | ios::in );\nif(file.is_open()) \n{\n    file.read(reinterpret_cast&lt;char*&gt;(header),sizeof(header));\n}\nfile.close();\n\n//zapis\n\nfstream saveFile;\nsaveFile.open( szOutput, ios::out );\nif(saveFile.is_open())\n{\n    saveFile.write(reinterpret_cast&lt;const char*&gt;(header),sizeof(header));\n}\nsaveFile.close(); \n}\n</code></pre>\n\n<p>Header contains 15 wchar_t's so we get 30 bytes. Still after investigating i have no idea how to convert.</p>\n"},{"tags":["delphi","windows-server-2008-r2","runtime-packages"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":151,"score":1,"question_id":12828068,"title":"Windows 2008 and wrong BPL loading","body":"<p>I have an application builded with Run-time Packages. When the executable starts it auto loads the required packages (.bpl).</p>\n\n<p>Recently we has installed an Windows 2008 R2 server to use as Terminal Services.</p>\n\n<p>We maintain some old compiled versions of our application in different paths, like this:</p>\n\n<pre><code>c:\\app\\version_1\\common.bpl\nc:\\app\\version_1\\app.exe\n\nc:\\app\\version_2\\common.bpl\nc:\\app\\version_2\\app.exe\n</code></pre>\n\n<p>Common.bpl is the a run-time package what app.exe depends on.</p>\n\n<p>THE PROBLEM:</p>\n\n<p>I start <code>\"c:\\app\\version_2\\app.exe\"</code> and it loads <code>\"c:\\app\\version_2\\common.bpl\"</code>.\nWhen I start the <code>\"c:\\app\\version_1\\app.exe\"</code> it loads the WRONG bpl (from version_2).</p>\n\n<p>The path <code>\"c:\\app\\version_2\\\"</code> isn't at the system search path.</p>\n\n<p>At Windows2003 server this problem doesn't occurs.</p>\n\n<p>What can I do to solve this?</p>\n\n<p>Thanks!</p>\n\n<hr>\n\n<p>I have downloaded the Process Explorer (microsoft sysinternals), and checked the loaded modules of each executable, all they are correct!</p>\n\n<p>But I noticed another problem. After start the second version, an entry-not-found-error occurs, telling me what a initialization entry point, of an unit what only exists in one of the versions, could not be found.</p>\n\n<p>Something is very strange. The ProcessExplorer is telling me that the process is loading the correct modoles, but when they are running this seems not be happening.</p>\n\n<p>Seems the applications are sharing the loaded modules.</p>\n\n<hr>\n\n<p><strong>SOLVED</strong></p>\n\n<p>There was a MouseHook using FindVCLWindow, this was generating the AV. </p>\n\n<p>Sorry about inconvenience guys, and thanks!</p>\n"},{"tags":["delphi","winapi","delphi-2009"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":98,"score":1,"question_id":12954545,"title":"Strange WM_CHAR behaviour (wrong chCharCode)","body":"<p>I need to automate entering a certain character (Russian letter <code>Э</code>). In Spy++ the corresponding message looks like this:</p>\n\n<p><code>WM_CHAR chCharCode: '221' (221) cRepeat:1 ScanCode:28 fExtended:0 fAltDown:0 fRepeat:0 fUp:0</code></p>\n\n<p><img src=\"http://i.stack.imgur.com/3ZIMR.png\" alt=\"enter image description here\"></p>\n\n<p>In order to send this message programmatically, I use this Delphi code:</p>\n\n<p><code>SendMessage(Self.PassengerGrid, WM_CHAR, WPARAM(221), LPARAM($280001));</code></p>\n\n<p>When I examine the results of running my code in Spy++, I see following message:</p>\n\n<p><code>WM_CHAR chCharCode: '89' (89) cRepeat:1 ScanCode:28 fExtended:0 fAltDown:0 fRepeat:0 fUp:0</code></p>\n\n<p>Something must be wrong with <code>wParam</code> of my <code>SendMessage</code> call.</p>\n\n<p>How can I fix it (so that the <code>chCharcode</code> is equal to <code>221</code>)` ?</p>\n\n<p><strong>Update 1:</strong></p>\n\n<ul>\n<li>The machine, where this error occurs, has two keyboard languages - English and Russian.</li>\n<li><p>I noticed that when the following code </p>\n\n<p>SendMessage(MyGridHandle, WM_KEYDOWN, VK_OEM_7, LPARAM($390000));\nSendMessage(MyGridHandle, WM_CHAR, WPARAM(221), LPARAM($280001));\nSendMessage(MyGridHandle, WM_KEYUP, VK_OEM_7, LPARAM($c0390001));</p></li>\n</ul>\n\n<p>is executed, the selected language (according to tray icon) changes from Russian to English.</p>\n\n<ul>\n<li>Whatever character I transmit in WM_CHAR, <code>WPARAM</code> of the message is always <code>0x59</code> (<code>89</code>).</li>\n</ul>\n\n<p><strong>Update 2:</strong> Using <code>WM_UNICHAR</code> instead of <code>WM_CHAR</code> doesn't help.</p>\n"},{"tags":["delphi","indy10"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12954995,"title":"Transfer files & Message Passing from One System to remote System using Internet","body":"<p>Which one is (TCP/UDP) best to send files from Client to Remote server using Internet? i.e Which one is fast &amp; reliable of my following requirement.</p>\n\n<p>I have two requirements basically </p>\n\n<pre><code>1. Sending Files from Client to Server (Daily Once)\n2. In Client system running one software, its having different product information, \n   latest packet Time, Product Status, etc . \n   This information is updated every one second. \n   My problem is, To know the Client status at server.\n\n I am not able to decided which design is best of my requirement. They are\n   A.Using TIdTCPClient &amp; TIdTCPServer \n   B.Using TIdTCPClient &amp; TIdCmdTCPServer\n   C.Using TIdCmdClient &amp; TIdTCPServer\n   D.Using TIdCmdClient &amp; TIdCMDTCPServer\n</code></pre>\n\n<p>Please guide to me which design is best &amp; how to implement it with example.</p>\n"},{"tags":["delphi","firebird"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":127,"score":0,"question_id":12953989,"title":"retrieve firebird users passwords","body":"<p>My application currently is using the firebird security to logon for any user of my application.</p>\n\n<p>We are using Delphi7 and Firebird 2.1.</p>\n\n<p>Now we need to change this and we need to control de access by ourself.</p>\n\n<p>We are thinking about retrieve all users passwords from the database (as a conversion routine) and save the password inside our tables....</p>\n\n<p>Is possible to do this?</p>\n\n<p>I'm trying to use the delphi component TIBSecurityService, but without success.</p>\n\n<p>Take a look:</p>\n\n<pre><code>var\n  i: integer;\n  l: TStrings;\n  pwd: string;\nbegin\n  IBSecurityService1.Attach;\n  IBSecurityService1.DisplayUsers;\n  l := TStringList.Create;\n  try\n    for i := 0 to IBSecurityService1.UserInfoCount-1 do\n      l.add(IBSecurityService1.UserInfo[i].UserName);\n\n    while l.Count &gt; 0 do\n      try\n        IBSecurityService1.DisplayUser(l[0]);\n        pwd := IBSecurityService1.Password;\n        // pwd = ''\n      finally\n        l.Delete(0);\n      end;\n  finally\n    l.Free;\n  end;\nend;\n</code></pre>\n\n<p>Thanks for help!</p>\n"},{"tags":["delphi","pdf","vcl"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2029,"score":2,"question_id":898801,"title":"Datagrid export to pdf","body":"<p>how can I can export the data shown on a DBgrid to a pdf file? </p>\n"},{"tags":["delphi","tchromium"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12953657,"title":"How do programmatically click in TChromium","body":"<p>I use TChromium and I want to click on a button or on a link programatticaly.\nSuch as:</p>\n\n<pre><code>ANode: ICefDomNode;\n...\nANode.Click();\n</code></pre>\n\n<p>ICefBrowser has a method </p>\n\n<pre><code>SendMouseClickEvent(x, y: Integer; typ: TCefMouseButtonType; mouseUp: Boolean; clickCount: Integer);\n</code></pre>\n\n<p>but I dont know a coordinates of my ANode for clicking on it.</p>\n"},{"tags":["delphi","bde"],"answer_count":9,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":6049,"score":2,"question_id":372175,"title":"Any idea how to resolve a BDE error $251e?","body":"<p>Here's the situation:</p>\n\n<p>A user of our program suddenly started receiving an error from the Borland Database Engine (BDE) when attempting to start the application.  The error message says that it was unable to initialize the BDE and gives error code $251e.  User is on BDE 5.2.0.2.</p>\n\n<p>I cannot find any official documentation on the error $251e.  The only somewhat useful hit I can get on Google is <a href=\"http://www.mombu.com/microsoft/comp-databases-paradox/t-notes-bde-error-251e-and-other-25xx-codes-576309.html\" rel=\"nofollow\">not very instructive</a> and the suggestion there does no good.</p>\n\n<p>Here are some things that we have tried / discovered:</p>\n\n<ol>\n<li>Other applications that access the BDE the exact same way have no complaints.</li>\n<li>The error occurs on a line where we set Connected := True on the TDatabase component.</li>\n<li>Reinstalling the BDE makes no difference.</li>\n<li>Closing all BDE apps except the one in question makes no difference.</li>\n<li>Changing from using an MSSQL database to a Paradox database makes no difference.</li>\n<li>Making the logged in user a member of the Administrators group on the workstation makes no difference.</li>\n<li>The typically logged in user is a domain user.</li>\n<li>Logging in as a workstation administrator (non-domain) account that was originally setup on the machine as a last resort administration account, all works fine.</li>\n<li>Creating a new workstation user with local admin rights, the problem returns.</li>\n</ol>\n\n<p>The user has been temporarily allowed to use the one workstation admin account that actually works, but this is not an acceptable long-term solution.  Any idea where we might go from here?  Any clue as to what $251e really means?</p>\n\n<p>I know that the BDE is way out of date and no longer supported, but changing the use of the BDE is not an option right now.</p>\n"},{"tags":["delphi","winapi","delphi-2009"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":104,"score":2,"question_id":12950920,"title":"Simulating keyboard input in Delphi using WinAPI","body":"<p>I need to programmatically enter one character into a cell of a Delphi grid (in other application).</p>\n\n<p>In order to do this manually, following steps are required:</p>\n\n<ol>\n<li>Press the F3 button.</li>\n<li>Press the right-arrow key 3 times.</li>\n<li>Press the space button.</li>\n<li>Type letter 'E' on the keyboard.</li>\n<li><p>Press the right-arrow key.</p>\n\n<pre><code> // Press F3 button         \n keybd_event(VK_F3, 0, 0, 0);         \n // Press right arrow key 3 times\n keybd_event(VK_RIGHT, 0, 0, 0);\n keybd_event(VK_RIGHT, 0, 0, 0);\n keybd_event(VK_RIGHT, 0, 0, 0);\n\n // Press the space button\n keybd_event(VK_SPACE, 0, 0, 0);\n\n // Type letter E\n keybd_event(Ord('E'), 0, 0, 0);\n\n // Move to the right\n keybd_event(VK_RIGHT, 0, 0, 0);\n</code></pre></li>\n</ol>\n\n<p>But it doesn't work. When I run this code, nothing seems to happen.</p>\n\n<p>How should I modify this code so that it actually simulates user input?</p>\n"},{"tags":["delphi","delphi-2010","indy10"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":926,"score":5,"question_id":6191402,"title":"TIdHTTPServer file upload","body":"<p>I'm trying to upload files to a Indy(ver. 10.5.5) TIdHTTPServer.<br>\nI've been searching for solutions but no luck thus far, what I've found was for older versions of Indy which were not compatible with the version shipped with Delphi 2010.</p>\n\n<p>What I'm hoping is to achieve simply <strong>upload</strong> a file using \"multipart/form-data\" to the server and <strong>decode</strong> it, simple as that, any help is appreciated.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":341,"score":4,"question_id":3415955,"title":"Delphi 7 persistent business object","body":"<p>Is there any way to make persistence of business objects with data from a database in Delphi 7?\nIs it possible without using components.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":167,"score":1,"question_id":12947618,"title":"Windows Explorer like controls in Delphi","body":"<p>Does any one knows that if there's any build in or 3rd party control that provides a windows explorer like behavior?  Like Tile layout, Details layout， List layout and so on?</p>\n\n<p><img src=\"http://i.stack.imgur.com/SNi6H.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi","rsa","publickey"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12934580,"title":"how to insert modulus and exponent of RSA public key into FGInt package(http://submanifold.be/)","body":"<p>I'm newby in RSA cryptographic methods... I need to verify incoming signature from device. The problem is, that I have to use a delphi IDE and delhi doesn't have implemented some RSA libraries. I find on web the FGInt package on this site: <a href=\"http://submanifold.be/\" rel=\"nofollow\">http://submanifold.be/</a>. I download it(RSA.zip) and I'm in dark - I don't know, how can I put to this code my public key modulus and exponent.</p>\n\n<p>The situation is as follows:\nI have signature from device which I need to compare(verify) with calculated message(challenge). I have also an X509 certificate  with embedded public key. I can extract this public key from these certificate. I can also extract modulus and exponent from public key. My problem is, that I don't know, how can I put the obtained modulus and exponent to RSAVerify procedure of FGInt package. The modulus is 128 bytes(I have it as an array of hexa numbers) long and exponent has value of 65537.</p>\n\n<p>Can somebody help with my question, how can be modulus and exponent values inserted into procedure RSAVerify in FGint package?</p>\n"},{"tags":["delphi","ide","delphi-7","clearcase"],"answer_count":2,"favorite_count":3,"up_vote_count":34,"down_vote_count":0,"view_count":1026,"score":34,"question_id":6670621,"title":"How to hook a method to the Edit event in Delphi 7 IDE?","body":"<p>I'd like to automatically checkout a file when I start to edit it in <strong>Delphi 7</strong> IDE. </p>\n\n<p>ClearCase is my version control system and I really hate the need to checkout a file before starting to edit. It always breaks my thought flow: I'm trying to solve a problem, find where I need to change, try to edit it, fail because the file is read only, open clearcase, search the file, finally checkout, try to edit the file again, fail because the IDE still thinks it is readonly, tell the IDE that isn't readonly. When I finally go back to code, I forgot what I was trying do do. </p>\n\n<p>I've found <a href=\"http://cc.embarcadero.com/item/21664\" rel=\"nofollow\">this nice and simple ClearCase IDE integration code</a>. It works, but uses the deprecated ToolIntf unit.  I've added a couple of shortcuts. Here is a <em>simplified version</em> of it (didn't try to compile):</p>\n\n<pre><code>unit clearcase;\n\ninterface\nuses ToolsApi, ToolIntf;\n\nimplementation\nuses\n  Windows, Dialogs, Classes, ExptIntf, Menus, ShellApi, SysUtils;\n\ntype\n  TDelphiClearcase = class\n  private\n    FClearcaseMenu,\n    FDoCheckOutPasDfm,\n    FDoCheckInPasDfm : TIMenuItemIntf;\n\n    procedure ExecCommand(const command: string; path: PChar = nil);\n  public\n    destructor Destroy;override;\n    procedure DoClick(Sender: TIMenuItemIntf);\n    property ClearcaseMenu: TIMenuItemIntf read FClearcaseMenu write FClearcaseMenu;\n    property DoCheckOutPasDfm:TIMenuItemIntf write FDoCheckOutPasDfm;\n    property DoCheckInPasDfm: TIMenuItemIntf write FDoCheckInPasDfm;\n  end;\n\nvar\n  dcc: TDelphiClearcase = nil;\n\n{ TDelphiClearcase }\n\ndestructor TDelphiClearcase.Destroy;\n  procedure Remove(item: TIMenuItemIntf);\n  begin\n    if( item = nil )then\n      Exit;\n    item.DestroyMenuItem;\n    FreeAndNil(item);\n  end;\nbegin\n  Remove(FDoCheckOutPasDfm);\n  Remove(FDoCheckInPasDfm);\n  inherited;\nend;\n\nprocedure TDelphiClearcase.DoClick(Sender: TIMenuItemIntf);\n  function GetPasDfm(const f: string): string;\n  var\n    aux: string;\n  begin\n    aux := Copy(f, 1, Length(f) - 4);\n    Result := aux + '.pas' + ' ' + aux + '.dfm'\n  end;\n\nvar\n  command, fileName  : string;\nbegin\n  fileName := ToolServices.GetCurrentFile;\n\n  if( Sender = FDoCheckOutPasDfm )then\n    command := 'cleartool co ' + GetPasDfm(fileName)\n  else if( Sender = FDoCheckInPasDfm )then\n    command := 'cleartool ci ' + GetPasDfm(fileName);\n\n  ExecCommand(command);\n\n  ToolServices.ReloadFile(fileName);\n\nend;\n\nprocedure TDelphiClearcase.ExecCommand(const command: string; path: PChar);\nvar\n  pi  : TProcessInformation;\n  stinfo : TStartupInfo;\nbegin\n  FillChar(stinfo, SizeOf(stinfo), 0);\n  stinfo.cb := SizeOf(stinfo);\n\n  if( CreateProcess(nil, PChar(command), nil, nil, True, CREATE_NEW_CONSOLE,\n      nil, path, stinfo, pi) )then begin\n    WaitForSingleObject(pi.hProcess, INFINITE);\n    CloseHandle(pi.hProcess)\n  end\nend;\n\nprocedure CreateMenus;\nvar\n  services: TIToolServices;\nbegin\n  if( BorlandIDEServices = nil )then\n    Exit;\n  services := ToolServices;\n\n  if( services = nil )then\n    Exit;\n\n  dcc := TDelphiClearcase.Create;\n\n  dcc.ClearcaseMenu := services.GetMainMenu.GetMenuItems.InsertItem(6,\n    'C&amp;learcase', 'ClearcaseMenu', 'ClearcaseTools', 0, 0, 0,\n    [mfEnabled, mfVisible], nil);\n\n\n  dcc.DoCheckOutPasDfm := dcc.ClearcaseMenu.InsertItem(2,\n    'Check Out pas and dfm', 'DoCheckOutPasDfm', 'Undo the check outs', ShortCut(Ord('&gt;'),\n    [ssCtrl]), 0, 2,\n    [mfEnabled, mfVisible], dcc.DoClick);\n  dcc.DoCheckInPasDfm:= dcc.ClearcaseMenu.InsertItem(4,\n    'Check In pas and dfm', 'DoCheckInPasDfm', 'Check in current files', ShortCut(Ord('&lt;'),\n    [ssCtrl]), 0, 2,\n    [mfEnabled, mfVisible], dcc.DoClick);\n\nend;\n\nprocedure DestroyMenus;\nbegin\n  FreeAndNil(dcc);\nend;\n\ninitialization\n  CreateMenus;\n\nfinalization\n  DestroyMenus\nend.\n</code></pre>\n\n<p>I'd like to checkout the file when I first start editing it and it is read only. I have no idea how to hook a function to the IDE edit event of a file. Any pointers are welcome.</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":153,"score":3,"question_id":12905010,"title":"Access Violation unless I clean before recompile","body":"<p>I am receiving an access violation after I recompile a certain unit (MyClass) unless I do a clean.  The error is clearly a call to a null object (Write of address 00000000), but when I try to step to it, the compiler won't allow me to step into the code where I think the error is occurring. (Inside a method on the same object.  When i trace into the method, there error after hitting trace into but before going to the line of code.)  This happens in a used unit of MyClass, rather than MyClass itself.</p>\n\n<p>The weird thing is that if I do a clean (or build) and then recompile, the program runs fine.  Any reason this would happen?</p>\n\n<p><strong>Update</strong></p>\n\n<p>The application uses several threads created via the AsyncCalls library.  I use several <code>TEvent</code> and <code>TMultiReadExclusiveWriteSynchronizer</code> objects to keep processes ordered and resources protected.</p>\n"},{"tags":["delphi","winapi","encryption","cryptography","cryptoapi"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":803,"score":3,"question_id":10984064,"title":"WinAPI -> CryptoAPI -> RSA, encrypt with private, decrypt with public","body":"<p>Good day.</p>\n\n<p>I need to teach Windows CryptoAPI to encrypt the message with private (not public) part of the key, and decrypt with public. This is necessary to give users information, that they can read, but can't change.</p>\n\n<p><strong>How it works now:</strong></p>\n\n<p>I get the context</p>\n\n<pre><code>CryptAcquireContext(@Prov, PAnsiChar(containerName), nil, PROV_RSA_FULL, 0)\n</code></pre>\n\n<p>generate a key pair</p>\n\n<pre><code>CryptGenKey(Prov, CALG_RSA_KEYX, CRYPT_EXPORTABLE, @key)\n</code></pre>\n\n<p>Encrypt (and the problem is here. \"key\" - a keypair, and the function uses its public part);</p>\n\n<pre><code>CryptEncrypt(key, 0, true, 0, @res[1], @strLen, buffSize)\n</code></pre>\n\n<p>Decrypt (the same problem here, it uses the private part of the key)</p>\n\n<pre><code>CryptDecrypt(key, 0, true, 0, @res[1], @buffSize)\n</code></pre>\n\n<p>Thank you for your attention / help.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Yes, I could use a digital signature and other metods... </p>\n\n<p>The problem is that I need to encrypt one database field and make sure that no one but me can change it. It will be possible to read this field only with the help of my program (till someone decompiles it and get public key). This could be done with symmetrical key and digital signatures, but then i will need to create another field and store another key and so on... </p>\n\n<p>I do hope that we can somehow teach WIN API to do as I want. I know that i can do so with RSA, and I hope that somehow WinAPI supports this feature.</p>\n"},{"tags":["delphi","pascal","freepascal","hdf5"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":169,"score":6,"question_id":12939214,"title":"Automatically create Delphi/Freepascal interface unit from C header file","body":"<p>Is it possible to automatically generate interface units from C header files? In particular, I want to wrap the HDF5 library, and it would be great if I could avoid writing the interface unit manually.</p>\n"},{"tags":["delphi","dbexpress"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":12941403,"title":"Delphi TDBXTransaction 'Invalid transaction Object'","body":"<p>1st off I am new to Delphi so this may be a \"mundane detail\" that's being over looked. [sorry in advance]</p>\n\n<p>I am getting an 'Invalid Transaction Object' error when I attempt to run a transaction through a datasnap server connected to an Oracle 11g DB. </p>\n\n<p>Due to the system details and the companies business plan we have elected not to use Client Data Sets to handle our transactions. Instead we are attempting to make the Snap server very generic and only handle data access by receiving queries and returning native types. </p>\n\n<p>with that being said here is some sample code that is giving me fits</p>\n\n<pre><code>function TSnapMethods.TransUpdate: boolean;\nvar\n  dbx: TDBXTransaction;\n  params:TParams;\nbegin\n  SqlCon.Open;\n  dbx := SQLCon.DBXConnection.BeginTransaction(TDBXIsolations.ReadCommitted);\n  try\n      params:= TParams.Create(self);\n      with Params.AddParameter do\n      begin\n        name:= 'param';\n        DataType:= ftWideString;\n        ParamType:= ptInput;\n        asString:= 'Bugsville';\n      end;\n      with Params.AddParameter do\n      begin\n        name:= 'var';\n        DataType:= ftWideString;\n        ParamType:= ptInput;\n        asString:= 'ZZZTOP';\n      end;\n      sqlcon.Execute('Update Name set City=:param Where Abrv=:var',params);\n\n      SQLcon.CommitFreeAndNil(dbx);//Breaks here...\n      result:= true;\n  except\n    Sqlcon.RollbackFreeAndNil(dbx);//Breaks here also...\n    result:= false;\n  end;        \nend;\n</code></pre>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":121,"score":6,"question_id":12920442,"title":"Delphi: Is there a tool that can remove conditional directives for particular conditional symbols?","body":"<p>I have many units that contain many conditional directive blocks such as:</p>\n\n<pre><code>{$IFDEF DELPHI6ANDLOWER}\n  *Do something 1*\n{$ELSE}\n  *Do something 2*\n{$ENDIF}\n</code></pre>\n\n<p>Now, I decide to drop the support for Delphi 6 (VER140) and the lower versions.</p>\n\n<p>Is there a tool that can do the magic? Hopefully, the above code becomes:</p>\n\n<pre><code>  *Do something 2*\n</code></pre>\n\n<p>I have tested ModelMaker, CnPack, GExperts, but none of them could do the magic.</p>\n"},{"tags":["delphi","stackoverflow"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":123,"score":1,"question_id":12935503,"title":"OnCalcFields causing StackOverflow","body":"<p>Using Delphi 2005, I have a TwwDBGrid (InfoPower) that allows the user to select part(s) &amp; quantities to generate a quote.  Part of the selection process is to allow the user to add a discount for each part consisting of DiscountAmount and DiscountType.  DiscountAmount is the amount of the discount and DiscountType is the type of discount amount (% off, $ off or flat price).  This data is held in a ClientDataSet called ClientDataSetParts.</p>\n\n<p>Within the OnCalc method (ClientDataSetPartsCalcFields) I have the following code which will recalculate the TotalPrice based on the parts cost and any discounts.  RangePricing is used in the case where a price is calculated based on a quantity within a range (i.e., 1-100 = $100, 101-200 = $150, etc.):</p>\n\n<pre><code>procedure TfrmCustom_Services.ClientDataSetPartsCalcFields(\n  DataSet: TDataSet);\nbegin\n  inherited;\n  // if part is selected then calculate Total\n  if (ClientDataSetPartsSelected.Value) then begin\n    // if range pricing is defined\n    if (ClientDataSetParts.FieldByName('RangePricing').AsBoolean) then begin\n      ClientDataSetParts.FieldByName('TotalPrice').Value :=\n            ClientDataSetParts.FieldbyName('UnitPrice').Value;\n    // otherwise use regular pricing\n    end else begin\n      ClientDataSetParts.FieldByName('TotalPrice').Value :=\n          ClientDataSetParts.FieldbyName('UnitPrice').Value *\n          ClientDataSetParts.FieldByName('Quantity').Value;\n    end;\n\n  // otherwise clear the Total\n  end else begin\n    ClientDataSetParts.FieldByName('TotalPrice').Clear;\n    if (ClientDataSetParts.FieldByName('Quantity').Value &lt;&gt; null) then\n      ClientDataSetParts.FieldByName('Quantity').Clear;\n    if (ClientDataSetParts.FieldByName('DiscountAmount').Value &lt;&gt; null) then\n      ClientDataSetParts.FieldByName('DiscountAmount').Clear;\n    if (ClientDataSetParts.FieldByName('DiscountType').Value &lt;&gt; null) then\n      ClientDataSetParts.FieldByName('DiscountType').Clear;\n  end;\n\n  // Update totals if Discount is applied\n  // Only recalculate if both discount value and type are applied\n  // otherwise will constantly get errors when switching fields\n  if ((ClientDataSetPartsDiscountAmount.Value &gt; 0) and (ClientDataSetPartsDiscountType.Value &lt;&gt; '')) then begin\n    case StringToCaseSelect((ClientDataSetPartsDiscountType.Value), ['% Disc','$ Disc','Price']) of\n      0 :\n      begin\n        ClientDataSetParts.FieldByName('DiscountDollarAmount').Value :=\n            ClientDataSetParts.FieldByName('TotalPrice').Value * (ClientDataSetParts.FieldByName('DiscountAmount').Value/100);\n        ClientDataSetPartsTotalPrice.Value := ClientDataSetPartsTotalPrice.Value - (ClientDataSetPartsTotalPrice.Value * (ClientDataSetPartsDiscountAmount.Value/100));\n      end;\n      1 :\n      begin\n        ClientDataSetParts.FieldByName('DiscountDollarAmount').Value := ClientDataSetPartsDiscountAmount.Value;\n        ClientDataSetPartsTotalPrice.Value := ClientDataSetPartsTotalPrice.Value - ClientDataSetPartsDiscountAmount.Value;\n      end;\n      2 :\n      begin\n        ClientDataSetParts.FieldByName('DiscountDollarAmount').Value :=\n            ClientDataSetPartsTotalPrice.Value - ClientDataSetPartsDiscountAmount.Value;\n        ClientDataSetPartsTotalPrice.Value := ClientDataSetPartsDiscountAmount.Value;\n      end;\n    end;\n  end;\n\nend;\n</code></pre>\n\n<p>The problem comes when I try to calculate DiscountDollarAmount (the actual dollar figure of the discount that I have to return to an outside source via API).  Each time I set the ClientDataSetParts.FieldByName('DiscountDollarAmount').Value, ClientDataSetPartsCalcFields is called again causing endless calls and eventually a stack overflow.</p>\n\n<p>How can I update this value without calling ClientDataSetPartsCalcFields recursively?  </p>\n"},{"tags":["delphi","math"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12927928,"title":"Subtract until reach desired value","body":"<p>Good morning all.</p>\n\n<p>I'm currently trying to figure out something that i'm confident is simple enough but is proving to be a task and a half to actually work out.</p>\n\n<p>I'm working on a project that's designed to minimize drive usage by relocating various files elsewhere. I've got an array (0..12) of <code>int64</code> values that contains the file sizes of the files i might potentially want to move. The array is ordered in a way that's predicted largest file size down to predicted smallest file size. I've also got the names of these files stored in a different array (known as <code>WoWData</code>, also <code>[0..12]</code>). I've then got an \"installation size\", and a \"desired size\".</p>\n\n<p>My task is to calculate which files i need to move in order to bring the \"installation size\" down to the \"desired size\" by going through the array of file sizes, and taking the value away from the Installation size until i reach &lt;= desired size.</p>\n\n<p>Here's some sample code (Delphi/Firemonkey) i've been trying to work with. It's confusing me trying to figure out how to go about such a task and so there'll no doubt be a lot of issues with it;</p>\n\n<pre><code>Global Vars;\n    _WoWDataFileSize : Array [0..12] of Int64;\n    // \"TBWoWDir\" is a TTrackBar (Firemonkey)\n\nvar\n  TotalSize, ReqSize, DiffSize, CurDiff : Int64;\n  i : Integer;\nbegin\n  // Set up initial values to work with\n  ReqSize := Round(TBWoWDir.Value); // Requested Size\n  TotalSize := Round(TBWoWDir.Max); // Actual installation size\n  CurDiff := 0; // Assume as \"Current Difference in size\"\n\n  // Calculate difference between install and requested size\n  DiffSize := TotalSize - ReqSize; // This calculates correctly\n\n// The below is what i'm struggling with\n  repeat\n    for i := Low(_WoWDataFileSize) to High(_WoWDataFileSize) do\n      begin\n        CurDiff := ReqSize - _WoWDataFileSize[i];\n      end;\n  until CurDiff &lt;= ReqSize;\nend;\n</code></pre>\n\n<p>I did try using just a <code>repeat .. until</code> loop without the <code>for</code> loop, but again, i'm getting far too confused while trying to figure it out.</p>\n\n<hr>\n\n<p>Let me provide an example. Let's assume that <code>_WoWDataFileSize[0]</code> is 200, and <code>_WoWDataFileSize[1]</code> through to <code>_WoWDataFileSize[12]</code> are the same value as their array index (e.g. <code>_WoWDataFileSize[6]</code> = 6, <code>_WoWDataFileSize[8]</code> = 8, etc).</p>\n\n<p>If i wanted to calculate the value of 150 (which would be <code>200 - 12 - 11 - 10 - 9 - 8</code>, or <code>Array[0] - Array[12] - Array[11] - Array[10] - Array[9] - Array[8]</code> according to the array), and get a list of files i need to move to meet this requirement from the <code>WoWData</code> array, how would i write the routine?</p>\n\n<p>150 could be replaced by any number as i'm working towards a dynamic user-requested size specified by <code>TBWoWDir.Value</code>.</p>\n\n<p>I'm thinking i might need to do a <code>While</code> loop and use <code>i := i+1</code> setup. Realistically, i could go through and hardcode it so it takes away one value in the array at a time and check each time to see if i'm &lt;= desired value-- it'd be 2-3 lines for each item (so a total of 24-36 lines), but this is both messy to maintain and not optimal. I'm interested to see how it would be done in a loop. I typically don't have trouble with loops, but this is hardly a standard one for me.</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":1143,"score":0,"question_id":7377377,"title":".ini file not creating","body":"<p>I have begun to start working with .ini files because I realise its many advantages compared to a .txt file. Any way, I googled \"delphi inifiles\" and I am now following a guide on <a href=\"http://delphi.about.com/od/objectpascalide/a/tinifile.htm\" rel=\"nofollow\">Delphi About</a>. However the very first line I tried gave me trouble even though all the syntax is right.</p>\n\n<p><strong>Delphi About's Code:</strong></p>\n\n<pre><code>IniFile := TIniFile.Create('myapp.ini') ;\n</code></pre>\n\n<p><strong>My code:</strong> </p>\n\n<pre><code>IniFile := TIniFile.Create('SWEDISH_HOUSE_MAFIA.ini');\n</code></pre>\n\n<p>The only difference is the name of the .ini file itself. Also, yes I have:</p>\n\n<ul>\n<li>Declared 'IniFiles' in the 'uses' clause</li>\n<li>(Locally) Declared IniFile</li>\n</ul>\n\n<p>I have placed that code under FormCreate, but the problem is this .ini file is not created when the program is run. Anyone know what the problem could be? I've asked a friend about it and he said it was a permission issue.</p>\n\n<p>Extra Details:</p>\n\n<ul>\n<li>OS - Windows 7 Ultimate 64 Bit (Administrative rights)</li>\n<li>Program is stored in - My Documents</li>\n<li>I use - Delphi 2010</li>\n</ul>\n"},{"tags":["delphi","winapi","combobox","delphi-2009"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":113,"score":3,"question_id":12935912,"title":"How to find out the index of a combo box item by name using WinAPI in Delphi?","body":"<p>I have a Delphi application A, which needs to select a certain item in a combo box of another Delphi application B.</p>\n\n<p>A knows the text of the combo box item to select.</p>\n\n<p>In order to select the combo box item, application A needs to know the index of the item in the combo box.</p>\n\n<p>How can I figure out the index of a combo box item, when I only know its text?</p>\n"},{"tags":["delphi","api","neo4j"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":134,"score":2,"question_id":12899832,"title":"Using Neo4j from within delphi","body":"<p>any idea how to interact with Neo4J from delphi 2010?</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","interbase","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12929822,"title":"Delphi IBTable readonly error","body":"<p>I just installed the latest version of <code>Embarcadero Delphi XE3</code>. I made a simple form connecting to <code>InterBase</code> Database. I have <code>IBDatabase</code>, <code>IBTable</code>, <code>IBTransaction</code>, <code>Grid</code> and some other components. Everything works fine and it shows data in the grid. But I want to be able to edit this data. So at the <code>IBTable</code> component I set the <code>ReadOnly</code> property to false and every time I do this the program stops working and I get this:</p>\n\n<p><code>Dynamic SQL Error \nSQL error code = - 206 \nColumn unknown \nIBTable1</code></p>\n\n<p>Any idea how to solve this?</p>\n"},{"tags":["delphi","tobjectlist"],"answer_count":1,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":130,"score":8,"question_id":12934015,"title":"Using a large TObjectList and deallocating the unused part","body":"<p>I am using a TObjectList (Delphi 2007) to store A LOT of data- I expect to have around 300 thousand elements or even more. However, when a list is created, it's default size is set to store only four elements, then eight if one tries to add a fifth element, then sixteen if one tries to add a ninth element and so forth. The numbers may be off, but I think the workings are correct. The problem with this is that all the elements have to be copied from the deallocated part of the memory to the new memory block where the new extended list migrates. I would like to set a specific initial size and deallocate (or undo the reservation of memory, since reserving and allocating aren't the same thing) any unused space that the list has allocated/reserved.\nThis probably isn't a lot of code, but I think that there should be a permanent, solid reference to this problem in the form of a question and answer. </p>\n"},{"tags":["delphi","licensing"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":217,"score":4,"question_id":12933424,"title":"Delphi XE3 Named(ESD) license registration limit?","body":"<p>I've just recently purchased Delphi XE3 Professional ESD with Named license and I've checked before purchase to make sure that I can install it on several machines as long as the IDE is used by the same registered user which is myself.</p>\n\n<p>The Delphi XE3 software license enables me to do so ( <a href=\"http://edn.embarcadero.com/article/42481\" rel=\"nofollow\">http://edn.embarcadero.com/article/42481</a>), yet so far I was unable to deduce any information or get any type of direction from Embarcadero which in my opinion are in every possible way trying to <em>discourage</em> users from installing the named license on several machines. Even the Reseller company from which I made the order was convenient enough to lie to me about it.</p>\n\n<p>I've installed and registered this license on two computers so far successfully so according to the info on the website, I'm left with one more available registration.</p>\n\n<p>What happens if my computer crashes or I'm forced to format it?\nIs there a way to deactivate the license, save it on a file then reinstall it after the computer has been cleaned?</p>\n\n<p>Do I really have to use up a registration every time I want to install the license on a computer?</p>\n\n<p>What happens if I use all three available registrations, can I request for an expansion of available registrations?</p>\n"},{"tags":["delphi","serial-port","communication","baud-rate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2001,"score":0,"question_id":1120069,"title":"Find the serial port settings in Delphi","body":"<p>Hi I have the need to find the Baud rate and other settings for a serial port, Looking about on the web, it looks like I should be using <a href=\"http://msdn.microsoft.com/en-us/library/aa363256%28VS.85%29.aspx\" rel=\"nofollow\">GetCommConfig</a>, This returns a TCommConfig record with what I assume is the data I need. The problem is the function I wote returns the wrong values.</p>\n\n<p>The code below looks like it is working, but the baud rate is always 1200, which looking in windows device manager (and altering port settings), is wrong.</p>\n\n<p>I have tried calling it like so:</p>\n\n<pre><code>ComPort('com1');\nComPort('COM1');\nComPort('COM1:');\nComPort('COM4');\nComPort('COM9');\n</code></pre>\n\n<p>the first 4 are valid but return 1200 and the 5th is invalid and returns 0</p>\n\n<pre><code>function ComPort(l_port:String):TCommConfig;\n{Gets the comm port settings}\n    var\n    ComFile: THandle;\n    PortName: array[0..80] of Char;\n    size: cardinal;\n    CommConfig:TCommConfig;\nbegin\n    FillChar(Result, SizeOf(TCommConfig), 0);//blank return value\n\n    try\n        StrPCopy(PortName,l_port);\n        ComFile := CreateFile(PortName,GENERIC_READ or GENERIC_WRITE,0,nil,OPEN_EXISTING,0{ FILE_ATTRIBUTE_NORMAL},0);\n        try\n            if (ComFile &lt;&gt; INVALID_HANDLE_VALUE) then\n            begin\n                FillChar(CommConfig, SizeOf(TCommConfig), 0);//blank record\n                CommConfig.dwSize := sizeof(TCommConfig);//set size\n                //CommConfig.dcb.DCBlength := SizeOf(_dcb);\n                size := sizeof(TCommConfig);\n\n                if (GetCommConfig(ComFile,CommConfig,size)) then\n                begin\n                    Result := CommConfig;\n                end;\n            end;\n        finally\n           CloseHandle(ComFile);\n        end;\n    except\n        Showmessage('Unable to open port ' + l_port);\n    end;\nend;\n</code></pre>\n\n<p>Stepping through the code, the first 4 always hit the line <strong>Result := CommConfig;</strong>, so the GetCommConfig is retuning a valid code, so I must be missing something.</p>\n\n<p>I have tryed verious other things, such as setting the length of the dcb record, but all have the same result, as baud of 1200.</p>\n\n<p>Does anyone know where I am going wrong?</p>\n"},{"tags":["delphi","delphi-7","delphi-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":175,"score":2,"question_id":12881023,"title":"Controlling multiple TEdits as array","body":"<p>I am trying to programme a Sudoku solver, and I want to control 81 <code>TEdit</code> controls as array, but their names are <code>Edit1</code>, <code>Edit2</code>, <code>Edit3</code> instead of <code>Edit[1]</code>, <code>Edit[2]</code>, etc.</p>\n\n<p>I do not want to type <code>OnChange</code> event handlers for all 81 controls separately.</p>\n\n<p>How can I solve this?</p>\n"},{"tags":["delphi","file","toggle","hidden"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":12930825,"title":"Toggle show/hide system files from Delphi","body":"<p>Is there any built-in Delphi function to toggle between show and hide system files (protected operating system files) under Windows? Or maybe a registry entry in HKCU? Or maybe an API function able to do this?</p>\n\n<p>I don't ask for a trick to show/hide this kind of files in my application, I need something to work even for Windows Explorer.</p>\n\n<p>Operating systems : Win XP SP1+, Vista, 7</p>\n\n<p>I don't mind even if I have to pass over an UAC notification.</p>\n"},{"tags":["delphi","sockets","networking","network-programming","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":2,"view_count":108,"score":2,"question_id":12929978,"title":"Send data over multiple users using one software using delphi","body":"<p>I hope there is someone that can help me.\nI am writing a software that users can fill in information into a database, but I  want to install that same software that I created on multiple computers. When a other user is inserting new information into the software and click save then it must show on his/her computer and at the same time on the other PC's in the network.</p>\n\n<p>I think this is a difficult one to crack, but I hope some one can help me.</p>\n\n<p>Greetings</p>\n"},{"tags":["delphi","tooltip","chm"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12931050,"title":"Integrate tooltips with CHM help in Windows app","body":"<p>We're trying to redesign our documentation process for a Windows desktop application, and two of the requirements we have are</p>\n\n<ul>\n<li>Provide 'reference' help in a CHM format </li>\n<li>Provide tooltip help on individual controls</li>\n</ul>\n\n<p>Currently our tooltips are hard-coded into the Delphi/C++Builder forms, but I'd ideally like to avoid the duplication, and have the CHM file as the 'master'</p>\n\n<p>How can we display the Help information in the CHM file as tooltips when the user positions the mouse over certain controls?</p>\n"},{"tags":["delphi","winapi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":12928799,"title":"How to find all text fields in a window?","body":"<p>I have a window with two text fields inside it.</p>\n\n<p>How can I get the handles of <strong>both</strong> text fields using WinAPI calls?</p>\n\n<p>Note: Both text boxes belong to a different application (I make the WinAPI calls in application A and the text boxes are located in application B).</p>\n\n<p><strong>Update 1:</strong></p>\n\n<p>I get <code>Invalid window handle</code> message when invoking <code>GetClassName</code>.</p>\n\n<p>I suppose that something is wrong with my declaration of the callback function.</p>\n\n<p><code>EnumChildWindows</code> is invoked from one of the methods of <code>TMyClass</code> like this:</p>\n\n<pre><code>EnumChildWindows(handle, @TMyClass.CBList, 0);\n</code></pre>\n\n<p>Here's the code of the callback function.</p>\n\n<pre><code>function TMyClass.CBList(Win: THandle; lp: LPARAM): Boolean; stdcall;\nvar\n  ClassName:array [1..1024] of Char;\nbegin\n  GetClassName(Win, PChar(@ClassName), 1024);\n  OutputDebugString(PChar('SysErrorMessage(GetLastError): '));\n\n  result := true;\nend;\n</code></pre>\n"},{"tags":["delphi","session","intraweb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":12769642,"title":"Login page session timeout for kiosk","body":"<p>We have a web-based product written in Delphi and Intraweb, that can be run on a public kiosk (full-screen).</p>\n\n<p>Is there any way using Intraweb to display a login page that isn't part of any session (just a standard Intraweb page), so the session only gets created when the user successfully logs in?</p>\n"},{"tags":["delphi","openssl","delphi-2010","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12917347,"title":"Connection Timed Out + SSL Connection + TCPIP + Indy10.5.5","body":"<p>I am developed one application for sending files client to server using TCP/IP Components using SSL. </p>\n\n<p>Error is <strong>Connection Timed Out</strong> is occurred when Sending Large Files <strong>at Server Side</strong></p>\n\n<p>Server Side (SSL)</p>\n\n<pre><code>   idTCPServer1.IOHandler := IdServerIOHandlerSSLOpenSSL1;\n   OnExecute\n      Acontext.Connection.IOHandler.LargeStream := True;\n      Acontext.Connection.IOHandler.ReadStream(filestream,Filesize);  // Error is occurred here.\n   End;\n</code></pre>\n\n<p>Client Side (SSL)</p>\n\n<pre><code>   idTCPClient1.IOHandler := IdSSLIOHandlerSocketOpenSSL1;\n   idTCPClient1.IOHandler.LargeStream := True;\n   idTCPClient1.IOHandler.WriteStream(fms,-1,True);\n</code></pre>\n\n<p>Connection is established between Client &amp; Server. When send the files after some time Connection Timed out is error is shown at server &amp; at client application going to Not Responding .</p>\n\n<p>Here another scenario is when i connect the Client &amp; Server as Normal using IdIOHandlerStack1 (at Client Side) and server side not assign any Handler. Files transfered successfully with out any problem.</p>\n\n<p>I am using Delphi2010 &amp; Indy10.5.5, DLL Version is 0.9.8.18</p>\n\n<p>anyone guide to me</p>\n"},{"tags":["delphi","firemonkey"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12889428,"title":"Coloring cell background on firemonkey stringgrid according to value from data","body":"<p>It may be basic but I'm have a <em>*</em>* of a time finding sample code to change a row color of a stringgrid based on a value from a database in Firemonkey. I have data coming from a MDB no problems but need the row to be certain colors for ie '1' = red '2' = green etc. I know I have to access the Style elements somehow 'OnApplyStyleLookup'? but at what stage. I have seen questions on changing text style and colour etc but I am digging a hole for myself trying to get to the 'background' element and applying. Any help would be greatly appreciated.\nCheers\nRichard ...(newbie to Firemonkey)</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":96,"score":-1,"question_id":12921466,"title":"SetWindowTheme and process","body":"<p>How to force specific theme on specific application or process via handle?</p>\n\n<p>For example let application.exe use other style not aero default.</p>\n"},{"tags":["delphi"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":434,"score":1,"question_id":7079675,"title":"Math Parser in Delphi","body":"<p>So here is what I am trying to do:</p>\n\n<p>I would like a parser that would evaluate equations and allow me to use custom functions. So, for example, an equation could be: </p>\n\n<pre><code>cos(5) * Patient:['lat1'] \n</code></pre>\n\n<p>and it would let me have a function that does something if it finds Patient: in the expression. </p>\n\n<p>The program I'm working on used a parser called MathParser (http://www.myart.bz/mathparser/), which worked fine in Delphi 2007, but has problems in Delphi XE (because of unicode). The MathParser site has a new version for XE, which I installed, but some functions have been changed around and I'm trying to get it to work right.</p>\n\n<p>So, the problem seems to be with the custom function part, since everything else works fine.</p>\n\n<p>The way I'm adding the functions is:</p>\n\n<pre><code>MathParser.AddFunction('Patient:', FPatFunction, fkMethod, FunctionMethod(PatFunction, 1),\nFalse, False, vtDouble);\nMathParser.AddFunction('Organ:', FOrgFunction, fkMethod, FunctionMethod(OrganFunction, 1),\nFalse, False, vtDouble);\n</code></pre>\n\n<p>And then the functions themselves are</p>\n\n<pre><code>// patient function\nfunction CEquatCalc.PatFunction(const AFunction: PFunction; const AType: PType;\n const ParameterArray: TParameterArray): TValue;\n begin\n  if Assigned(FPatient) and Assigned(FOrgan) then\n   AssignDouble(Result, (FPatient as CPatientItem).GetScoreVal((Trim(ParameterArray[0].Text)), (FOrgan as COrganItem)))\n  else if Assigned(FPatient) then\n   AssignDouble(Result,(FPatient as CPatientItem).GetScoreVal((Trim(ParameterArray[0].Text)), NIL));\n</code></pre>\n\n<p>end;</p>\n\n<pre><code>// organ function\nfunction CEquatCalc.OrganFunction(const AFunction: PFunction; const AType: PType;\n const ParameterArray: TParameterArray): TValue;\n begin\n  AssignDouble(Result, (FOrgan as COrganItem).GetScoreVal((Trim(ParameterArray[0].Text))));\n end;\n</code></pre>\n\n<p>The error that pops up says something like \"Unknown element: lat1\". Unfortunately since the component didn't come with Parser.pas (just the dcu file), I can't debug where it's happening.</p>\n\n<p>Hopefully someone knows what the problem is, and if not, could you recommend another parser that would do what I want? (and is preferably free)</p>\n"},{"tags":["delphi","winapi","winsock","rtsp","tcp-ip"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":141,"score":3,"question_id":12878373,"title":"How to test a network device for a valid RTSP stream?","body":"<p>I am working on a project which streams video/audio through RTSP using VLC Media Player plugin. I would like to provide an option to scan the network for RTSP cameras. I'm sure this will consist of querying a list of all network devices, and testing for port 554. All this I can take care of. However, once I have gotten this far, how do I test the device through port 554 to make sure it's a valid RTSP camera?</p>\n\n<p>I'm assuming there should be something in <code>Winsock</code> to be able to do this, but how should I test a socket connection and make sure it's a valid RTSP stream which I can connect to? Whatever method is used, I shouldn't have to attempt to connect via RTSP to each using any sort of authentication, I'm looking for a lower-level way of determining if the port 554 is actually providing an RTSP stream.</p>\n"},{"tags":["java","delphi","concurrency"],"answer_count":1,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":157,"score":8,"question_id":12917512,"title":"Delphi concurrency memory model?","body":"<p>Is there anything like <a href=\"http://en.wikipedia.org/wiki/Java_Memory_Model\">Java Memory Model</a> in Delphi? To prevent misunderstandings: I mean nothing like \"huge/large/small\", but the things related to visibility of changes to other threads.</p>\n"},{"tags":["delphi","indy","digest-authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":325,"score":2,"question_id":12056951,"title":"401 With Indy IdHttp Digest Authentication in Delphi XE","body":"<p>Trying to do a get() with Digest to a partner's web service with Delphi XE.  </p>\n\n<p>I have included <code>IdAuthenticationDigest</code> to the uses clause which should automatically work from what I've read - but I must be missing something because I'm getting a 401 Unauthorized.  </p>\n\n<p>Code:</p>\n\n<pre><code>begin\n  // Init request:   \n  IdHttp := TIdHttp.Create(nil);\n  try\n    idHttp.Request.ContentType := self.inputType; // 'application/xml'\n    idHttp.Request.Accept := self.outputType; //'application/json';\n\n    // Set request method:\n    idHttp.Request.Method := Method; // 'Get'\n    // Set username and password:\n    idHttp.Request.BasicAuthentication := False;\n    // IdHttp.Request.Username/Password also fails\n    IdHttp.Request.Authentication.Username := 'xx';\n    IdHttp.Request.Authentication.password := 'xx';\n\n    IdHttp.Request.ContentLength := Length(Body);\n\n    // Send request:\n    if Method = 'GET' then\n      Result := idHttp.Get(self.ServiceHost + URI)\n    else\n    if Method = 'POST' then\n      Result := idHttp.Post(self.ServiceHost + URI, SendStream);\n\n   finally\n    idHttp.Free;\n   end;\nend;\n</code></pre>\n"},{"tags":["delphi","svn","versioning"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":142,"score":4,"question_id":12919912,"title":"How do you manage project version with SVN?","body":"<p>Project in Delphi 2007, stored in SVN.</p>\n\n<p>\"Project settings - version info\" - there the project version is stored.\nWhen changing the project version *.dproj file and *.res file are changing.\nAnd I have to commit them to SVN every time when project version changes.</p>\n\n<p>I want to manage project version with SVN.\nFor example, when building the project from svn tag named \"1.12.2\" and revision 12993 I want to get a binary *.exe file with version 1.12.2.12993.</p>\n\n<p>To make it, I should create a *.rc file with text presentation of version info. Then make a *.res file and include it to project with {$R version.res}</p>\n\n<p>What shold I write to *.rc file? What should it's structure look like?\nWhite an example, please.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12922944,"title":"How can I convert this delphi syntax in C#?","body":"<p>Delphi code :</p>\n\n<pre><code>procedure TMainForm.PdtPrintDAT1AfterOptionsLoaded(Sender: TObject;\nvar ReportSettings: TpdtReportSettings);\nbegin\nReportSettings.HideColumns := '~Line#';     {Hide these columns in the report}\nReportSettings.MaxStringColWid[ umTxt ] := 25;    {Make all string columns a max of 25 characters}\nif IncludeSampleAndTimeOnEachPrintedPage then\nReportSettings.NumFixedCols := 3 // 2 + 1 hidden line #\nelse ReportSettings.NumFixedCols := 0;\nReportSettings.OutputFileName := ExtractFilePath( Application.ExeName )\n                             + SUBDIR_REPORTS\n                             + '\\'\n                             + 'Rpt.TXT';\nend;\n</code></pre>\n\n<p>I tried to convert a little bit like this.</p>\n\n<pre><code>public void PdtPrintDAT1AfterOptionsLoaded(Object Sender, ref PdtReportSettings ReportSettings)\n    {\n\n        ReportSettings.HideColumns = \"~Line#\";\n\n        ReportSettings.MaxStringColWid[umTxt] = 25;\n\n        if (Units.Main.IncludeSampleAndTimeOnEachPrintedPage)\n        {\n\n            ReportSettings.NumFixedCols = 3;\n        }\n        else\n        {\n\n            ReportSettings.NumFixedCols = 0;\n        }\n\n        ReportSettings.OutputFileName = Path.GetDirectoryName(System.Environment.GetCommandLineArgs()[0]) + Units.Main.SUBDIR_REPORTS + '\\\\' + \"Rpt.TXT\";\n    }\n</code></pre>\n\n<p>But it gives error in the beginning for this.\nref PdtReportSettings ReportSettings\nThe type or namespace name 'PdtReportSettings' could not be found (are you missing a using directive or an assembly reference?)</p>\n\n<p>How can I solve this?</p>\n"},{"tags":["delphi","soap","dll","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12922301,"title":"procedure _ftol2_sse being called after update to Delphi XE?","body":"<p>In our program we are using a web service to pull back data from a third party into our program.</p>\n\n<p>Ever since we updated to Delphi XE from Delphi 2009, Windows server 2003 users are receiving the following error message when making a SOAP call to the web service.</p>\n\n<p><img src=\"http://i.stack.imgur.com/7TFfY.png\" alt=\"enter image description here\"></p>\n\n<p>msvcrt.dll on Server 2003 does not have the procedure _ftol2_sse which is now being called for some reason..</p>\n\n<p>I know this procedure was not being called when we had our source code on Delphi 2009 because I don't get this error on Windows server 2003 when running those builds.</p>\n\n<p>Is this feasible?  Could a change in the IDE affect which dll procedures are being called?  Does anyone have any insight or ideas on how I might track down or fix this error?</p>\n\n<p>Thanks</p>\n"},{"tags":["multithreading","delphi"],"answer_count":5,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":471,"score":5,"question_id":4136530,"title":"How to manage the return value of a thread?","body":"<p>I created a class derived from <code>TThread</code> that executes in background a query.</p>\n\n<p>I want that this class is decoupled from the client.</p>\n\n<p>This kind of thread has the purpose of executing a simple check (like how many users are currently connected to the application, without blocking the UI), so a simple idea is to use the Synchronize Method.</p>\n\n<p>Anyway since i want it to be decoupled i pass in the constructor a parameter of type</p>\n\n<pre><code>TSyncMethod: procedure of object;\n</code></pre>\n\n<p>Where <code>TSyncMethod</code> is a method on the client (a form in my case).</p>\n\n<p>Anyway how can I pass the value to TSyncMethod? I should write the result on some \"global place\" and then inside my TSyncMethod I check for it?</p>\n\n<p>I also tried to think of </p>\n\n<pre><code>TSyncMethod: procedure(ReturnValue: integer) of object;\n</code></pre>\n\n<p>but of course when I call <code>Synchronize(MySyncMethod)</code> I cannot pass parameters to it.</p>\n"},{"tags":["delphi","gwt","smartgwt","ics"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":792,"score":6,"question_id":7193014,"title":"Real time web based client for delphi app. HOWTO?","body":"<p>First of all what I want is quite complex, at least for me, but on the other hand it sounds exciting.</p>\n\n<p>I have a software written in delphi, and I want a real time web based client for it. </p>\n\n<p>The requirements:</p>\n\n<ul>\n<li>On the client side pure Javascript</li>\n<li>Shiny interface ( GWT, SmartGWT )</li>\n<li>Asynchronous connection between the server and the client. Ajax push, Long Polling, Comet, WebSocket?</li>\n</ul>\n\n<p>On the server side</p>\n\n<ul>\n<li>scale-ability</li>\n</ul>\n\n<p>On the delphi side I think I could use ICS from Overbyte, to handle the requests. I know that THttpAppSrv from ICS pack can easily serve simple content, but what about Websocket, or how can I do long polling with it?</p>\n\n<p>What do you think, is it a good combo ( GWT, SmartGWT on the client side, and ICS on the delphi side ), is there any sample project out there, or is there any other solution?</p>\n\n<p><strong>Update</strong>\nThanks for the useful comments, I think I get closer to the solution. It's good to know that GWT can use a custom server, however I think Arnaud is right, GWT with it's own Jetty server is a complete solution, but unfortunately not for me. :) I think I need a server written in delphi, which can communicate with GWT RPC. </p>\n\n<p><strong>Update 2</strong>\nI accepted Arnaud Bouchez's answer which looks me the best for the original question, however I think there's a better solution (if you change the requirements a little) for creating a client running in the browser for a delphi application. I just make a little comment here, to share the idea. Finally I used a <a href=\"http://nodejs.org/\" rel=\"nofollow\">node.js</a> server, and connected it to my delphi app with the help of <a href=\"http://www.zeromq.org\" rel=\"nofollow\">ZMQ</a>.</p>\n"},{"tags":["delphi","delphi-7","delphi-xe2","delphi-2010","delphi-xe"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":1,"view_count":230,"score":1,"question_id":12918826,"title":"Change Delphi IDE Theme","body":"<p>Is this possible to do? I mean more like Visual Studio 2012 Dark Theme.</p>\n\n<p>White can be painfull sometimes. </p>\n\n<p><strong>I don't mean Code Editor window but the IDE theme.</strong></p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","delphi-xe2","firebird","firebird2.5"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":174,"score":0,"question_id":12917799,"title":"Best way to implement SQL \"Where\" construction in Delphi?","body":"<p>I have Firebird DB table with with fields (FK - ForeignKey Fields):</p>\n\n<pre><code>ID integer,\nFACILITY_ID integer, --FK\nSERVICE_ID integer, --FK\nPROVIDER_ID integer, --FK\nSELLER_ID integer, --FK\nTARIFF_GROUP_ID integer, --FK\nDATE_START date,\nN_NORMATIVE_VALUE numeric(15,2),\nN_METER_VALUE numeric(15,2),\nT_NORMATIVE_VALUE numeric(15,2),\nT_METER_VALUE numeric(15,2),\nIS_ACTIVE smallint\n</code></pre>\n\n<p>I want to load this table into memory and work with it in my Delphi program (readonly). And I have to search records by all of FKs (.... where FACILITY_ID = :FACILITY_ID and SERVICE_ID = :SERVICE_ID etc..)</p>\n\n<p>What is best container for that task: dynamic array or lists or something else? And how to implement this search? Hash maybe?</p>\n\n<p>It's not very large table (1000 records), but will be used inside FOR construction with more than 100000 iterations.</p>\n\n<p>And i'm using Delphi XE2 with IBX &amp; UIB &amp; FB25</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12917332,"title":"Retrieving a string from array of string const","body":"<p>How do I get the string representation if I know the enum of integer value ?</p>\n\n<pre><code>type    \n  MyEnum = (tmp_one, tmp_two, tmp_three);\n\nconst\n  MyTypeNames: array[tmp_one..tmp_three] of string = ('One', 'Two', 'Three');\n</code></pre>\n"},{"tags":["delphi","serial-number","motherboard"],"answer_count":1,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":4960,"score":6,"question_id":2497253,"title":"How to get motherboard id or serial number in Delphi?","body":"<p>How do I get the motherboard ID or serial number from Delphi code?</p>\n\n<p>Is there any example code or articles that I can look at?</p>\n"},{"tags":["windows","delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":249,"score":1,"question_id":10513677,"title":"How to write a property handler for Windows Search integration on Windows 7 in Delphi","body":"<p>I want to create a property handler for my application's file format. I only need it to work in Windows 7. I know that I need to build it in both 32-bit and 64-bit for the different editions of Windows, so no need to remind me of that, although for now I'm stuck with Delphi 2007. I just need pointing in the right direction to get started. Which type of project should I create, and what other steps are mandatory to make this work?</p>\n"},{"tags":["delphi","windows-xp","filepath","shellexecute"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":124,"score":1,"question_id":12893650,"title":"ShellExecute failing if spaces in Path","body":"<p>I have a Delphi application that uses ShellExecute to call a second Delphi Application on a button press.</p>\n\n<p>The applications are stored on the same server, on the same network share.  Their paths are in the format:</p>\n\n<pre><code>const\n   JobManager = 'Z:\\Apps\\Application 1\\Application1.exe';\n   FeeManager = 'Z:\\Apps\\Application 2\\Application2.exe';\n</code></pre>\n\n<p>The call to ShellExecute is made as follows:</p>\n\n<pre><code>rh := FindWindow(PChar('TMF'), PChar('Edit Job Details'));\nif rh = 0 then\nbegin\n   ShellExecute(Handle, 'open', JobManager, nil, nil, SW_SHOWNORMAL);\n   ... \n</code></pre>\n\n<p>As we have three office we have copies of the Apps folder on each office server.  Each server has the Apps folder on a share mapped to \"Z:\"</p>\n\n<p>In one of the offices we have discovered a problem where the Applications cannot be found if the paths contain spaces.  As the applications are straight copies of each other, and work in the other offices the problem seems to be a machine setting.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["delphi","sorting","grid","multi-select"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12917961,"title":"Delphi Grid Multiselect and MemoryData SortOnFields are incompatible","body":"<p>When I sort my TJvDBGrid with MyJvMemoryData.SortOnFields and then try to do a Multiselect with SHIFT (CTRL is no problem), my app freezes. Somehow Multiselect depends on the stuff not being sorted.</p>\n\n<p>Is there a way I can fix this without using a new component?</p>\n"},{"tags":["delphi","interop","delphi-2009","microsoft-ui-automation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":12894215,"title":"How to use MS UI Automation in Delphi 2009","body":"<p>I have a C# application, which uses Microsoft UI Automation functionality, e. g. a call like <code>AutomationElement.RootElement.FindFirst(...)</code>.</p>\n\n<p>Now I need to do the same thing (use MS UI Automation) in Delphi 2009.</p>\n\n<p>How can I </p>\n\n<p>a) declare that my Delphi code uses MS UI Automation library and\nb) make calls like <code>AutomationElement.RootElement.FindFirst(...)</code></p>\n\n<p>?</p>\n\n<p>There are several tutorials (<a href=\"http://edn.embarcadero.com/article/32754\" rel=\"nofollow\">tutorial 1</a>, <a href=\"http://www.blong.com/Conferences/BorCon2004/Interop2/COMNetInterop.htm\" rel=\"nofollow\">tutorial 2</a>) explaining how to package one's own .NET code so that it can be used with Delphi, but in my case I need to use \"pre-packaged\" (already installed) assembly in Delphi.</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>Now I can get access to <code>AutomationElement.RootElemeent</code> on one machine, but it doesn't work on another.</p>\n\n<p>How can I find out the reason, why the attempt to execute <code>uiAutomation := CoCUIAutomation.Create;</code> fails on the second machine?</p>\n"},{"tags":["delphi","delphi-5"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12916674,"title":"DBGrid behaviour after an exception event","body":"<p>I need help with the following problem. I have implemented an editable DBGrid using the following component types: TQuery, TDataSource, TUpdateSQL, TDBGrid. The Query AfterPost event handler applies the changes to the database.</p>\n\n<pre><code>procedure TCardForm.Query2AfterPost(DataSet: TDataSet);\nbegin\n  Query2.ApplyUpdates;\nend;\n</code></pre>\n\n<p>So if I edit a row in the DBGrid and move to another row or press the down arrow key the changes I have made are applied to the database. Everything works fine with one exception. When an incorrect value is entered, a database exception is thrown and a message is shown, for example \"Column ... cannot be NULL\". After clicking OK in the message box the application allows me to browse the DBGrid and to go to another row without trying to apply the changes and without showing the exception message again. It shows the exception message only if I edit another row or edit the same row again. I don't want the application to allow me to do that. I want moving to another row in the DBGrid to be impossible until entering a correct value.</p>\n\n<p>Thanks in advance for your answers!</p>\n"},{"tags":["delphi","advantage-database-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":12906567,"title":"Check health of an Advantage Database connection","body":"<p>I keep a pool of Advantage TAdsConnection objects and hand them out as requested. Occasionally I get one passed out that results in a 6610 error, I'm assuming because it sat idle and the connection got reset. I could just run any old query and catch the 6610, but it's a long wait for that particular error.</p>\n\n<p>Is there a good way to check the health of an advantage connection before I pass it back out?</p>\n"},{"tags":["delphi","windows-7","delphi-2007","tdatetimepicker"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":93,"score":2,"question_id":12915431,"title":"TDateTimePicker.Checked returns True on Windows 7 after the user unchecks the control","body":"<p>I have a form (written in Delphi 2007) with a <code>TDateTimePicker</code> on it, with <code>ShowCheckbox</code> set to <code>True</code></p>\n\n<p>On Windows 7 (64bit) if the <code>TDateTimePicker</code> controls checkbox (in a checked state) is un-checked by the user, the <code>TDateTimePicker.Checked</code> property always returns True, even though the UI has been updated to the un-checked state.</p>\n\n<p>In code I need to check if the user has checked/ unchecked this control. So I use the following</p>\n\n<pre><code>procedure TMyForm.FormCreate(Sender: TObject);\nbegin        \n    myDateTimePicker.Checked := True;\n    myDateTimePicker.Date := date;\nend;\n\nprocedure TMyForm.ButtonOneClick(Sender: TObject);\nbegin\n    if (myDateTimePicker.Checked) then\n    begin\n        //Code was here\n        ShowMessage(BoolToStr(myDateTimePicker.Checked, True));\n    end;\nend;\n</code></pre>\n\n<p>This works fine in Windows XP, but in Windows 7 the <code>Checked</code> property is always <code>True</code> regardless of the status of the actual UI control.</p>\n\n<p>I have tried starting the control Un-checked, and <code>myDateTimePicker.Checked</code> returns <code>False</code> then when the user checks the control it returns <code>True</code> (so far so good) but when the user un-checks it again (into its false/ un-checked state) it still returns <code>True</code>.</p>\n\n<p>Is there a way to fix this or am I doing something daft?</p>\n"},{"tags":["delphi","delphi-xe2","rtti"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12892230,"title":"Can I simplify this use of RTTI in delphi?","body":"<p>I'm doing some work with RTTI in Delphi XE3 and so far, this has resulted in a call to a procedure as follows:</p>\n\n<pre><code>procedure MyProc( ARecordInstance : pointer; ARecordType : PTypeInfo );\n</code></pre>\n\n<p>and I call this routine as follows:</p>\n\n<pre><code>MyProc( @MyRec TypeInfo( TMyRec ));\n</code></pre>\n\n<p>This all works fine.</p>\n\n<p>It occurs to me that I might be able to simplify my procedure to:</p>\n\n<pre><code>procedure MyProc( var ARecord ); or procedure MyProc( ARecord : pointer );\n</code></pre>\n\n<p>..if I can get the type info from ARecord within my procedure. Working with an 'instance' such as 'ARecord' though, TypeInfo gives 'expects a type identifier' error, which is fair. Is there any way that I can pass a single pointer reference to my record and then extract the type from it?</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","object"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12911501,"title":"How to feed fastreports with objects","body":"<p>I'm using Embarcadero Delphi XE2,</p>\n\n<p>I'm using fastreports filled with values from stringlist.</p>\n\n<p>My question is this:\nCan I skip the stringlist and somehow bind some object of my type list to data of fastreport?</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","svn","dfm"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":135,"score":3,"question_id":12911124,"title":"Delphi XE2 changes DFM even though nothing has been changed","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5486957/is-there-a-delphi-option-to-lock-the-design-layout-of-a-form-against-acciden\">Is there a Delphi option to ‘lock’ the design (layout) of a form against accidental changes?</a>  </p>\n</blockquote>\n\n\n\n<p>We recently changed have changed from StarTeam to SVN, but we're having problems with our DFM files. It looks like Delphi changes the DFM files even though we're not actually changing the form. </p>\n\n<p>For example: I open an existing file, I change the active tabsheet, save the file, change the tabsheet back to it's original state, and save it again. When I diff the two files, the PixelsPerInch, TextHeight, Top, and lots of other values have changed? A little sample of my code:</p>\n\n<pre><code>   PixelsPerInch = 96\n      TextHeight = 13\n      inherited PageControl1: TPageControl\n        Top = 105\n        Height = 629\n        Margins.Left = 5\n        Margins.Top = 5\n        Margins.Right = 5\n        Margins.Bottom = 5\n        HotTrack = True\n        inherited TabSheet1: TTabSheet\n          Margins.Left = 5\n          Margins.Top = 5\n          Margins.Right = 5\n          Margins.Bottom = 5\n</code></pre>\n\n<p>My question is: is there a way to let Delphi only change the DFM only if the form has changed? Now, we have conflicts when we Update in SVN all the time.</p>\n"},{"tags":["delphi","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12899452,"title":"How to save a Memo or RichEdit as UTF 8 text file?","body":"<p>i am using Delphi 7, I wrote a program that  get some information from user, combines info from several editboxes and memos and other input components in a memo. How can I save this Memo as a UTF 8 text file?\nI received some files from last program's users without a solution for utf problem and now, when i open the output file i see ???? (as you know!) instead of different language characters, these are not recoverable, are they? </p>\n"},{"tags":["delphi","dll","skype","dllregistration"],"answer_count":3,"favorite_count":14,"up_vote_count":19,"down_vote_count":1,"view_count":2455,"score":18,"question_id":5074563,"title":"Registration-free COM/DLL?","body":"<p>My program is using the Skype4COM.dll (A wrapper for the Skype API).</p>\n\n<p>I am using Delphi 2010 - is there a way to make sure that my program is ALWAYS using the Skype4COM.dll that I will ship it with? The thing is, there are different versions of Skype4COM, and if I register mine over someone elses, their app may not work anymore.</p>\n\n<p>Usually I use RegSvr32 to register the DLL on peoples system, but I heard its possible to make it registration-free (in C#), so my question is: Can we do that in Delphi, too?</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi","dll","delphi-xe","xmldocument"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":214,"score":3,"question_id":12900487,"title":"Alternative to TXMLDocument?","body":"<p>Recently we upgraded our code from delphi2009 to delphiXE and updated our indy components (not sure if this is relevant)</p>\n\n<p>But ever since then we have had errors on Windows 2003 server machines when Loading and saving xml files.  </p>\n\n<p>XMLDoc.LoadFromFile()\nXMLDoc.SaveToFile()</p>\n\n<p><img src=\"http://i.stack.imgur.com/Er2uJ.png\" alt=\"The following is the error\"></p>\n\n<p>The dll msvcrt.dll is much smaller on Windows server 2003  300kb or so compared to over 600kb on other operating systems.. So its missing something in that file and its causing the error..</p>\n\n<p>Does anyone know how to fix this?  Or is there an alternative to XMLDoc that I can try?</p>\n"},{"tags":["xml","delphi","delphi-2010","msxml","idhttp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":144,"score":1,"question_id":12907787,"title":"IdHTTP XML, getting xml, help please","body":"<p>I can not get through IdHTTP XML document from the site. I always had the answer 403 / HTTP 1.1 and text/html (need text/xml)</p>\n\n<p>When using MSXML all well and getting XML file. But I need a proxy, so need idhtop. When using the synapse does not change.</p>\n\n<p><strong>Work with msxml:</strong></p>\n\n<pre><code>CoInitialize(nil);\n     GetXML:={$IFDEF VER210}CoXMLHTTP{$ELSE}CoXMLHTTPRequest{$ENDIF}.Create;\n     GetXML.open('POST', '***************', false, EmptyParam, EmptyParam);\n     GetXML.setRequestHeader('Host', '***************');\n     GetXML.setRequestHeader('User-Agent', 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13');\n     GetXML.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n     GamesBody:='***************';\n     GetXML.send(GamesBody);\n     Form1.Memo2.Lines.Text:=GetXML.responseText;\n     ResultPage:=GetXML.responseText;\n     if Pos('error code', ResultPage)=0 then\n     begin\n    CoUninitialize;\n</code></pre>\n\n<p>How to set up IdHTTP? All settings have changed 100 times Or a connection to a proxy MSXML?</p>\n"},{"tags":["java","web-services","delphi","soap","complextype"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":142,"score":2,"question_id":12890934,"title":"Complex types in Delphi web service","body":"<p>How do I make complex types in a Delphi webservice, specifically soapenc:Array, available within the same namespace as the type defintions that use it. Currently if I try create a new webservice in Java from the wsdl generated from the Delphi app, Java gives the following error:</p>\n\n<pre><code>Error resolving component 'soapenc:Array'. It was detected that 'soapenc:Array' is in namespace 'http://schemas.xmlsoap.org/soap/encoding/', but components from this namespace are not referenceable from schema document...........\n</code></pre>\n\n<p>If I analyse the wsdl, all my method and types use the namepsace 'targetNamespace=\"urn:WebserviceIntf\"' but the types using soapenc:Array are defined as follows:</p>\n\n<pre><code>&lt;xs:complexType name=\"ArrayOfClientDetailAcc\"&gt;\n&lt;xs:complexContent&gt;\n&lt;xs:restriction base=\"soapenc:Array\"&gt;\n&lt;xs:sequence/&gt;\n&lt;xs:attribute xmlns:n1=\"http://schemas.xmlsoap.org/wsdl/\" ref=\"soapenc:arrayType\" n1:arrayType=\"ns2:TClientDetailAccArray[]\"/&gt;\n&lt;/xs:restriction&gt;\n&lt;/xs:complexContent&gt;\n&lt;/xs:complexType&gt;\n</code></pre>\n\n<p>If it's not possible to change this, I would appreciate advise on the best approach to duplicating my Delphi webservice in Java without changing the interface at all, which would disrupt our clients that connect to it.</p>\n\n<p>Your help is appreciated!</p>\n\n<p>I've tried using Axis as per the link suggested but that also gives an error:</p>\n\n<pre><code>C:\\axis&gt;java org.apache.axis.wsdl.WSDL2Java http://mywebservice?wsdl\n- Unable to find required classes (javax.activation.DataHandler and javax.mail.i\nnternet.MimeMultipart). Attachment support is disabled.\nWSDLException (at /definitions/binding/operation[1]/input): faultCode=INVALID_WS\nDL: Element '{http://schemas.xmlsoap.org/wsdl/}input' contained unexpected attri\nbutes: 'message':\n        at com.ibm.wsdl.util.xml.DOMUtils.throwWSDLException(Unknown Source)\n        at com.ibm.wsdl.xml.WSDLReaderImpl.parseBindingInput(Unknown Source)\n        at com.ibm.wsdl.xml.WSDLReaderImpl.parseBindingOperation(Unknown Source)\n\n        at com.ibm.wsdl.xml.WSDLReaderImpl.parseBinding(Unknown Source)\n        at com.ibm.wsdl.xml.WSDLReaderImpl.parseDefinitions(Unknown Source)\n        at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)\n        at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)\n        at com.ibm.wsdl.xml.WSDLReaderImpl.readWSDL(Unknown Source)\n        at org.apache.axis.wsdl.symbolTable.SymbolTable.populate(SymbolTable.jav\na:516)\n        at org.apache.axis.wsdl.symbolTable.SymbolTable.populate(SymbolTable.jav\na:495)\n        at org.apache.axis.wsdl.gen.Parser$WSDLRunnable.run(Parser.java:361)\n        at java.lang.Thread.run(Unknown Source)\n</code></pre>\n"},{"tags":["multithreading","delphi","ping","indy","tthread"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":240,"score":5,"question_id":12858551,"title":"Delphi (XE2) Indy (10) Multithread Ping","body":"<p>I have a room with 60 computers/devices (40 computers and 20 oscilloscopes Windows CE based) and I would like to know which and every one is alive using ping. First I wrote a standard ping (see here <a href=\"http://stackoverflow.com/questions/12723081/delphi-indy-ping-error-10040\">Delphi Indy Ping Error 10040</a>), which is working fine now but takes ages when most computers are offline.</p>\n\n<p>So what I am trying to do is to write a MultiThread Ping but I am quite struggling with it. I have seen only very few examples over the internet and no one was matching my needs, that's why I try to write it myself.</p>\n\n<p>I use XE2 and Indy 10 and the form is only constitued of a memo and a button.</p>\n\n<pre><code>unit Main;\n\ninterface\n\nuses\n  Winapi.Windows, System.SysUtils, System.Classes, Vcl.Forms,\n  IdIcmpClient, IdGlobal, Vcl.StdCtrls, Vcl.Controls;\n\ntype\n  TMainForm = class(TForm)\n    Memo1: TMemo;\n    ButtonStartPing: TButton;\n    procedure ButtonStartPingClick(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\ntype\n  TMyPingThread = class(TThread)\n  private\n    fIndex : integer;\n    fIdIcmpClient: TIdIcmpClient;\n    procedure doOnPingReply;\n  protected\n    procedure Execute; override;\n  public\n    constructor Create(index: integer);\n  end;\n\nvar\n  MainForm: TMainForm;\n  ThreadCOunt : integer;\n\nimplementation\n\n{$R *.dfm}\n\nconstructor TMyPingThread.Create(index: integer);\nbegin\n  inherited Create(false);\n\n  fIndex := index;\n  fIdIcmpClient := TIdIcmpClient.Create(nil);\n  fIdIcmpClient.ReceiveTimeout := 200;\n  fIdIcmpClient.PacketSize := 24;\n  fIdIcmpClient.Protocol := 1;\n  fIdIcmpClient.IPVersion := Id_IPv4;\n\n  //first computer is at adresse 211\n  fIdIcmpClient.Host := '128.178.26.'+inttostr(211+index-1);\n\n  self.FreeOnTerminate := true;\nend;\n\nprocedure TMyPingThread.doOnPingReply;\nbegin\n  MainForm.Memo1.lines.add(inttostr(findex)+' '+fIdIcmpClient.ReplyStatus.Msg);\n  dec(ThreadCount);\n\n  if ThreadCount = 0 then\n    MainForm.Memo1.lines.add('--- End ---');\nend;\n\nprocedure TMyPingThread.Execute;\nbegin\n  inherited;\n\n  try\n    fIdIcmpClient.Ping('',findex);\n  except\n  end;\n\n  while not Terminated do\n  begin\n    if fIdIcmpClient.ReplyStatus.SequenceId = findex then Terminate;\n  end;\n\n  Synchronize(doOnPingReply);\n  fIdIcmpClient.Free;\nend;\n\nprocedure TMainForm.ButtonStartPingClick(Sender: TObject);\nvar\n  i: integer;\n  myPing : TMyPingThread;\nbegin\n  Memo1.Lines.Clear;\n\n  ThreadCount := 0;\n  for i := 1 to 40 do\n  begin\n    inc(ThreadCount);\n    myPing := TMyPingThread.Create(i);\n    //sleep(10);\n  end;\nend;\n\nend.\n</code></pre>\n\n<p>My problem is that it \"seems\" to work when I uncomment the \"sleep(10)\", and \"seems\" not to be working without it. This for sure means I am missing a point in the threading I have written.</p>\n\n<p>In other words. When Sleep(10) is in the code. Every time I clicked the button to get to check the connections the result was correct.</p>\n\n<p>Without the sleep(10), it is working \"most\" of the time but some times the result is wrong giving me a ping echo on offline computers and no ping echo on online computer, as is the ping reply was not assigned to the correct thread.</p>\n\n<p>Any comment or help is welcome.</p>\n\n<p><strong>----- EDIT / IMPORTANT -----</strong></p>\n\n<p>As a general follow up of this question, @Darian Miller started a <a href=\"https://code.google.com/p/delphi-stackoverflow/\" rel=\"nofollow\" title=\"Google Code Project\">Google Code project here</a>  <a href=\"https://code.google.com/p/delphi-stackoverflow/\" rel=\"nofollow\">https://code.google.com/p/delphi-stackoverflow/</a> which is a working basis. I mark his answer as the \"accepted answer\" but users should refer to this open source project (all the credit belongs to him) as it will surely be extended and updated in the future.</p>\n"},{"tags":["windows","delphi","winapi","delphi-7"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":161,"score":6,"question_id":12880144,"title":"Get FileSystem Restrictions","body":"<p>I would like to code a function that tells me if it's possible to WRITE a file/folder to a specific path or not. I would like to do that WITHOUT actually writing any file(s) to the disk. Is there a WINAPI function for that? \nThank you for your help.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":12907020,"title":"Delphi: Is there a refactoring tool to extract a class and its dependencies in a unit to a new unit?","body":"<p>I have a big unit contains many classes, and now I want to refactor that unit by separating certain classes into new units.</p>\n\n<p>I have to admit that I'm lack of experience on using the Delphi built-in IDE features. Utilizing the built-in feature <b>\"Find | Find Local References to Type <i></i>\"</b> didn't help much because the class methods use many unit-level vars, consts, types.</p>\n\n<p>I'm looking for a refactoring tool that can help me to accomplish this easily, preferably an open source one, but sharewares ones are also welcome.</p>\n"},{"tags":["delphi","openssl","delphi-2010","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":118,"score":0,"question_id":12897354,"title":"SSL3_GET_RECORD:wrong version number","body":"<p>I am using TIdTCPClient &amp; TidTCPServer to sending data from Client to Server Through SSL. \nI set the following code at server &amp; Client</p>\n\n<p>*<em>strong text</em>*Server Side</p>\n\n<pre><code>   IdServerIOHandlerSSLOpenSSL1.SSLOptions.Mode = sslmServer\n   IdServerIOHandlerSSLOpenSSL1.SSLOptions.Method = sslvTLSv1\n</code></pre>\n\n<p>*<em>strong text</em>*Cleint Side</p>\n\n<pre><code>   IdSSLIOHandlerSocketOpenSSL1.SSLOptions.Mode = sslmUnassigned\n   IdSSLIOHandlerSocketOpenSSL1.SSLOptions.Method = sslvTLSv1\n</code></pre>\n\n<p>Error is error:<strong>*1408F10B:SSL routines:SSL3_GET_RECORD:wrong version number at Server Side*</strong></p>\n\n<p>When I am executing the Server Application from Delphi IDE, Error message is shown, After click Continue button it establish the connection</p>\n\n<p>At Server &amp; Client both are using the Same DLL Versions</p>\n\n<pre><code>    libeay32.dll - 0.9.8.18\n     ssleay32.dll - 0.9.8.18\n</code></pre>\n\n<p>I am using Delphi Version 2010 &amp; Indy Version is 10.5.5. </p>\n\n<p>The above error is not occurred in Same system. It is happend in client system. \nthe above dlls are placed at Exe Folder.</p>\n\n<p>What am i doing wrong with above code or any wrongly configured..?</p>\n\n<p>thanx in advance</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":96,"score":3,"question_id":12904761,"title":"Catch a reraised exception with multiple catch blocks?","body":"<p>I am catching exceptions and for a specific exception class and error code within that class I do some custom handling.  For all other exceptions, I want to use the generic error handler.  Like such:</p>\n\n<pre><code>on E:EADSDatabaseError  do\n  begin\n    case E.ACEErrorCode of\n      5132: \n        begin\n        //Custom handling\n        end;    \n      else\n        begin\n          raise;\n        end;\n    end;\n  end;\non E:Exception do\n  begin\n    //usual handling\n  end;\n</code></pre>\n\n<p>For most codes in the original error,  I want to fall through to the generic error handler.  However, reraising it does not seem to allow the more general exception class handler to fire. (I'm not sure I would expect it to.  I've never done this sort of thing before.)</p>\n\n<p>Is my best option to have two <code>try/excepts</code>?  </p>\n"},{"tags":["delphi","utf-8","bom","file-attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":129,"score":0,"question_id":12902484,"title":"Why do I lose my UTF-8 BOM when changing file attributes?","body":"<p>I've a test Delphi application that uses TFileStream to write a UTF-8 BOM to a text file, followed by one dummy line of text.</p>\n\n<p>All works as expected, and using the hex viewer plugin for Notepad++ I see the BOM in the output text file.  However, if I then change the attribute of the text file (either programmatically in Delphi or via Windows explorer) on re-opening the file the BOM has been removed.</p>\n\n<p>Sample code that writes the BOM and dummy data to the file:</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nconst\n  cFilename = 'myfile.txt';\nvar\n  fs : TFileStream;\n  gBOM : TBytes;\n  gStr : RawByteString;\nbegin\n  fs := TFileStream.Create(cFilename, fmCreate, fmShareDenyWrite);\n  try\n    gBOM := TEncoding.UTF8.GetPreamble;\n    fs.WriteBuffer(PAnsiChar(gBOM)^, Length(gBOM));\n\n    // Dummy data\n    gStr := UTF8Encode('Dummy string') + AnsiChar(#13) + AnsiChar(#10);\n    fs.WriteBuffer(PAnsiChar(gStr)^, Length(gStr));\n\n    // If you read the file now the BOM will be present, however\n    // the follow line appears to remove it.\n    FileSetAttr(cFilename, faReadOnly);\n\n  finally\n    FreeAndNil(fs);\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi","sockets","delphi-xe2","rtsp","tcp-ip"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":212,"score":5,"question_id":12886383,"title":"TCP Client not receiving responses back from RTSP server","body":"<p>In Delphi XE2, I'm using the <code>TTCPClient</code> component to communicate with an RTSP server. After trial and error not getting a response back from the server, I switched the project to send HTTP requests via port 80 (instead of 554 for RTSP) and tried to send a request to a website (www.google.com specifically). I'm still not getting any response.</p>\n\n<p>I have a <code>TTCPClient</code> component on the main form (<code>Form1</code>) called <code>Client</code>, a <code>TMemo</code> control called <code>Log</code>, a <code>TEdit</code> control called <code>txtHost</code>, and a <code>TBitBtn</code> control. Here's the relevant parts of the code:</p>\n\n<p><strong>Connecting to Server</strong></p>\n\n<pre><code>procedure TForm1.BitBtn1Click(Sender: TObject);\nbegin\n  if Client.Active then Client.Disconnect;\n  Client.RemoteHost:= txtHost.Text;\n  Client.RemotePort:= '80'; // '554';\n  Client.Connect;\nend;\n</code></pre>\n\n<p><strong>OnConnect Event Handler (HTTP)</strong></p>\n\n<pre><code>procedure TForm1.ClientConnect(Sender: TObject);\nvar\n  S: String;\nbegin\n  Client.Sendln('GET / HTTP/1.0');\n  Client.SendLn('');\nend;\n</code></pre>\n\n<p><strong>OnConnect Event Handler (RTSP)</strong></p>\n\n<pre><code>procedure TForm1.ClientConnect(Sender: TObject);\nvar\n  S: String;\nbegin\n  Client.SendLn('OPTIONS * RTSP/1.0');\n  Client.SendLn('CSeq:0');\n  Client.SendLn('');\nend;\n</code></pre>\n\n<p><strong>OnReceive Event Handler</strong></p>\n\n<pre><code>procedure TForm1.ClientReceive(Sender: TObject; Buf: PAnsiChar;\n  var DataLen: Integer);\nvar\n  S, R: String;\nbegin\n  S:= Client.Receiveln;\n  while S &lt;&gt; '' do begin\n    R:= R+ S;\n    S:= Client.Receiveln;\n  end;\n  Log.Lines.Append('&gt; RECEIVED ' + R);\nend;\n</code></pre>\n\n<p><strong>OnError Event Handler</strong></p>\n\n<pre><code>procedure TForm1.ClientError(Sender: TObject; SocketError: Integer);\nbegin\n  Log.Lines.Append('&gt; ERROR '+IntToStr(SocketError));\nend;\n</code></pre>\n\n<p>The <code>OnReceive</code> event is never called, nothing is coming back from any Server I'm connecting to.</p>\n\n<p>What am I doing wrong here?</p>\n\n<p><strong>References</strong></p>\n\n<p>These are some links which I'm referencing to:</p>\n\n<ul>\n<li><a href=\"http://effbot.org/zone/socket-intro.htm\" rel=\"nofollow\">http://effbot.org/zone/socket-intro.htm</a></li>\n<li><a href=\"http://www.ietf.org/rfc/rfc2326.txt\" rel=\"nofollow\">http://www.ietf.org/rfc/rfc2326.txt</a></li>\n<li><a href=\"http://folk.uio.no/meccano/reflector/smallclient.html\" rel=\"nofollow\">http://folk.uio.no/meccano/reflector/smallclient.html</a></li>\n<li><a href=\"http://www.samsungdforum.com/upload_files/files/guide/data/html/html_3/reference/rtsp_specification.html\" rel=\"nofollow\">http://www.samsungdforum.com/upload_files/files/guide/data/html/html_3/reference/rtsp_specification.html</a></li>\n</ul>\n\n<p>The camera I'm working with is <code>Grandstream GXV3601LL</code></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I've concluded that the issue is with the RTSP server, and have asked a question on the forums on Grandstream's website. The code does work with other server connections.</p>\n"},{"tags":["delphi","onclick","fastreport"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12904248,"title":"How to get original memo text from TfrxReport.OnClickObject","body":"<p>I have a FR4 report which I want to make interactive. Report is built upon data from a dataset. In the designer I put expressions like <strong>[Q.\"NAME\"]</strong> into memo objects and they become a values from the dataset at the time of report being built. </p>\n\n<p>I know that there is a <strong>TfrxReport.OnClickObject</strong> event. But from within this event handler I can only obtain a memo text. </p>\n\n<p>So, my question is how to get an original expression (<strong>[Q.\"NAME\"]</strong> in my exmaple) from <strong>TfrxReport.OnClickObject</strong> event handler.</p>\n"},{"tags":["delphi","postgresql","psql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":12363628,"title":"Find if psql command failed for authenticating user","body":"<p>Using <code>Delphi</code> \nhow can you find out of the psql script has returned </p>\n\n<pre><code>   password authentication has failed for user \"myadmin\"\n</code></pre>\n\n<p>when running the following script(psqlRun.bat)</p>\n\n<pre><code>   \"C:\\Program Files\\PostgreSQL\\9.0\\bin\\psql.exe\"  -h localhost -p 5433 -d TestDB -U myadmin -f someSQLscript.sql   \n</code></pre>\n\n<p>The above script was ran using shellexecute</p>\n\n<pre><code>   ReturnedValue:= ShellExecute(Handle,'open',PChar('C:\\psqlRun.bat'), nil, nil, SW_SHOWNORMAL);\n</code></pre>\n\n<p>The returned value was over 32 (<a href=\"http://www.oehive.org/node/528\" rel=\"nofollow\">so it ran successfully</a>)\nbut for me the password authentication failed..\nis there any way to find through delphi is the script failed if the password failed?\nSince the <code>pgpass.conf</code> may not have been created so i cant check the file for user password.\nThe user may not know the password or may have entered wrong password.</p>\n\n<p><strong>so programmatically how to check if the authentication failed?</strong></p>\n\n<p>Note : Postgresql 9.0</p>\n"},{"tags":["delphi","audio","notifications","delphi-xe2","device"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":12899658,"title":"Get automatically notified on audio device connection/disconnection?","body":"<p>Is it possible to get automatically notified whenever the user connects or disconnects an audio device?</p>\n"},{"tags":["delphi","screenshot","dspack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12893953,"title":"How to get a Frame Bitmap from a Video File by DsPack Components?","body":"<p>Is it possible to get a bitmap from a video file by DsPack components?</p>\n\n<p>In this case I'm using this code; but It can't take a screenshot Image:</p>\n\n<pre><code>type\n  TForm4 = class(TForm)\n    FilterGraph1: TFilterGraph;\n    VideoWindow1: TVideoWindow;\n    btnPlay: TButton;\n    SampleGrabber1: TSampleGrabber;\n    btnTakePicture: TButton;\n    Image1: TImage;\n    procedure btnPlayClick(Sender: TObject);\n    procedure btnTakePictureClick(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\n...\n\nprocedure TForm4.btnPlayClick(Sender: TObject);\nbegin\n  SampleGrabber1.FilterGraph := FilterGraph1;\n  VideoWindow1.FilterGraph := FilterGraph1;\n  FilterGraph1.Active := true;\n  FilterGraph1.RenderFile('C:\\TEMP\\1.mp4');\n  FilterGraph1.Play;\nend;\n\nprocedure TForm4.btnTakePictureClick(Sender: TObject);\nbegin\n  SampleGrabber1.GetBitmap(Image1.Picture.Bitmap);\nend;\n</code></pre>\n\n<p>Is it possible to Fix This code?</p>\n"},{"tags":["python","delphi","gsm"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1668,"score":2,"question_id":657100,"title":"Where can i get free GSM libraries/components for delphi or python?","body":"<p>Where can i get good free GSM libraries for <strong>Delphi</strong> or <strong>Python</strong>? Libraries i can use to send and receive sms's on my application?</p>\n\n<p>Gath</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":112,"score":1,"question_id":12761997,"title":"how to you update a numeric field in a table in an access database using numeric variable to modify a row in a table?","body":"<p>The 'Total' field is of a number data type if I leave out the 'IntToStr' is says Incompatible types : string and integer. The function is part of another unit.</p>\n\n<pre><code>Function TAddAnimal.Dead(idead: Integer) : Integer;\nbegin\n  Result := fTotal - iDead;\nend;\n\nprocedure TfrmDead.Button1Click(Sender: TObject);\nbegin\n  ADOQuery1.Active := False ;\n  ADOQuery1.SQL.Text := 'select * from Animals where Name = \"'+LabeledEdit1.Text+'\"';\n  ADOQuery1.Active := True;\n  sName := ADOQuery1.FieldByName('Name').Value  ;\n  sAfriName := ADOQuery1.FieldByName('African Name').Value ;\n  sType := ADOQuery1.FieldByName('Type').Value   ;\n  iTotal := ADOQuery1.FieldByName('Total').Value  ;\n  tAnimal := TAddAnimal.Create(sName, sAfriName, sType, iTotal);\n\n  iDead  := SpinEdit1.Value;\n\n  ADOQuery1.Active:= false;\n  ADOQuery1.SQL.Text:= 'Update Animals set Total = Total - \"'+IntToStr  (tAnimal.Dead (iDead))+'\" where Name = \"'+LabeledEdit1.text+'\"';\n  ADOQuery1.ExecSQL;\n</code></pre>\n"},{"tags":["database","delphi","orm","delphi-7","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":12884321,"title":"Creation of SQL queries in mORMot","body":"<p>I using for access to SQLite from Delphi 7 mORMot <a href=\"http://synopse.info/fossil/wiki?name=Downloads\" rel=\"nofollow\">http://synopse.info/fossil/wiki?name=Downloads</a>. But thus I will use only connection to a database, but not ORM (Object and relational display) therefore me interest creation of SQL queries in mORMot.I want, that to me gave examples of SQL queries without ORM use in mORMot.</p>\n"},{"tags":["delphi","delphi-5"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":122,"score":2,"question_id":12836188,"title":"Exceptions on DBGrid editing","body":"<p>I have implemented an editable DBGrid. If a field is not filled correctly an exception is thrown and a message is shown, for example:</p>\n\n<pre><code>'08:00::00' is not a valid time\n</code></pre>\n\n<p>How can I catch those exceptions so that I can show messages written by me instead of the automatically generated ones? I would be thankful for any help.</p>\n"},{"tags":["delphi","proxy","smtp","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":95,"score":0,"question_id":12634964,"title":"How to Send mails using HTTP Automatically in delphi in Proxy Environment","body":"<p>I wan to send Mails from Delphi application. For this i developed one application with Indy Components.This application is used many clients. In some clients it was working with out any problem. In some Clients having problem because Proxy is enabled. \n   I searched in Internet, i found one alternative sending mails using HTTP protocol. Any body guide to me how to implement that.\n  I am using Delphi2010.</p>\n\n<p>Thanx in advance</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":153,"score":5,"question_id":12895673,"title":"How can I convert a string into a TColor Value?","body":"<p>I am creating a Delphi form and want to assign background color to it on run time. This code:</p>\n\n<pre><code>Form1.Color := clSkyBlue; \n</code></pre>\n\n<p>works well. My problem is that I have stored the color name in a table as a string. So, when I fetch the color name from the table and assign it to <code>Form1.Color</code>, the above statement becomes:</p>\n\n<pre><code>var\n  ColorName: string;\n....\nForm1.Color := ColorName;\n</code></pre>\n\n<p>and this results in a compile time error.</p>\n\n<p>How can I convert a string to a <code>TColor</code> value?</p>\n"},{"tags":["delphi","fastreport"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":525,"score":2,"question_id":7179711,"title":"How are people handling report email with Fast Reports + Delphi","body":"<p>As far as I can tell Fast Reports has trouble sending mail through certain providers, including Gmail, freely admit this issue and claim it will be fixed 'in the future'.  It's going on 12 months since I've heard that from their support team with no change.</p>\n\n<p>Anybody out there able to modify their code and/or override their preview form to get an email that works with every server?</p>\n"},{"tags":["delphi","ms-word","ole","delphi-5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12839923,"title":"Find in Word document with OLE does not work","body":"<p>i have the following function, which should return the position of the first occurrence of the text i'm searching for.\nThe problem: </p>\n\n<ul>\n<li>returns -1  </li>\n<li>throws AV-s, when i'm using the whole document content as a range (or using a range with the boundaries of the document content)</li>\n</ul>\n\n<p>What have i done:</p>\n\n<ul>\n<li>Lots of Google searches, to find the source of the problem, or alternatives to this code</li>\n<li>MSDN digging</li>\n<li>Trial and error</li>\n</ul>\n\n<p>Here is the code:</p>\n\n<pre><code>function FindTextWord(wordApp: TWordApplication; afindText: OleVariant; startIndex, endIndex: Integer; findEndOffsetFast: Boolean): Integer;\nvar\n  matchCase        : OleVariant;\n  matchWholeWord   : OleVariant;\n  matchWildcards   : OleVariant;\n  matchSoundsLike  : OleVariant;\n  matchAllWordForms: OleVariant;\n  fWd          : OleVariant;\n  wrap             : OleVariant;\n  format           : OleVariant;\n  replaceWith      : OleVariant;\n  replace          : OleVariant;\n  myRange          : Range;\n  startSearchOffset: OleVariant;\n  endSearchOffset  : OleVariant;\nbegin\n  WordApp.Selection.Start := 0;\n  WordApp.Selection.End_ := 0;\n  result:=-1;\n  try\n    if (Assigned(WordApp)) then\n    begin\n\n       if (startIndex&lt;1) then\n       begin\n         WordApp.ActiveDocument.GrammarChecked:=true;\n         WordApp.ActiveDocument.SpellingChecked:=true;\n         WordApp.ActiveDocument.ShowGrammaticalErrors:=false;\n         WordApp.ActiveDocument.ShowSpellingErrors:=false;\n         startSearchOffset:=WordApp.ActiveDocument.Content.Start;\n       end else\n       begin\n         startSearchOffset:=startIndex;\n       end;\n\n       if (endIndex&lt;1) then\n       begin\n         if (findEndOffsetFast)or(startIndex&lt;1) then\n         begin\n           endSearchOffset:=WordApp.ActiveDocument.Content.End_;\n         end else\n         begin\n           endSearchOffset:=startSearchOffset+1;\n           WordApp.Selection.Start:=startSearchOffset;\n           while (WordApp.Selection.Start=startSearchOffset)and(endSearchOffset&lt;WordApp.ActiveDocument.Content.End_)and(endSearchOffset-startSearchOffset&lt;4000) do\n           begin\n             endSearchOffset:=endSearchOffset+1;\n             WordApp.Selection.End_:=endSearchOffset;\n           end;\n\n           endSearchOffset:=endSearchOffset-1-Length(afindText);\n         end;\n\n       end else\n       begin\n         endSearchOffset:=endIndex;\n       end;\n\n       myRange:=WordApp.ActiveDocument.Range(startSearchOffset,endSearchOffset);\n       myRange.Find.ClearFormatting;\n       myRange.Start:=Integer(startSearchOffset);\n       myRange.End_:=Integer(endSearchOffset);\n\n\n       MatchCase := False;\n       MatchWholeWord := TRUE;\n       MatchWildcards := False;\n       MatchSoundsLike := False;\n       MatchAllWordForms := False;\n       fWd := True;\n       Wrap := wdFindStop;\n       Format := False;\n       ReplaceWith := '';\n       Replace := wdReplaceNone;\n\n       if MyRange.Find.Execute(aFindText,MatchCase,MatchWholeWord,\n                       MatchWildcards,MatchSoundsLike,\n                       MatchAllWordForms,fWd,\n                       Wrap,Format,ReplaceWith,Replace)\n       then begin\n         if (myRange.Start&gt;=startSearchOffset) then\n         begin\n           if (myRange.Find.Found) then\n           begin\n             result:=myRange.Start;\n           end;\n         end else\n         begin\n           result:=FindTextWord(wordApp,afindText,startIndex,endIndex,false);\n         end;\n       end;\n     end;\n   except\n   end;\nend;\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>The problem is not replacing text (i must remove all HTML tags which may appear in the word document, but with the following twist: if i encounter formatting tags, such as b, i, u, s, strong, and the like, i have to remove them and format the text accordingly)</p>\n"},{"tags":["delphi","zip","filenames"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12895315,"title":"Abbrevia ZIp filename garbled","body":"<p>The Chinese of Win7, I use TAbZipper create a ZIP file, but the zip file on the operating system of the English, the file name of the zip file inside have become garbled.I use the Abbrevia5. How can I do it, in DelphiXE2.</p>\n"},{"tags":["forms","delphi","modal","non-modal"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":133,"score":4,"question_id":12893271,"title":"Delphi: 'ShowModal' from non-modal secondary form","body":"<p>We have an application with a main form and a second non-modal form which can be used side by side. Our main form shows a list of configurations, while the second non-modal form shows a configuration in more detail.</p>\n\n<p>When we show a modal form (requested from the second non-modal form), the main form pops up in front of the second form until we close that modal form.</p>\n\n<p>How can I avoid this behaviour? I already tried creating that last modal form in different ways ('Applicaton.CreateForm', 'TForm.Create', setting the parent), but still get the main form to pop up.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["delphi","delphi-7","access-violation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":91,"score":1,"question_id":12893347,"title":"AVE: Access Violation @adress in module: DELPHI7","body":"<p>This is the handled onchange procedure of 81 TEdit-s (MyEdit[bx,by,x,y]) dynamically created and grouped in a 4 dimensional massive. For now I'm trying to program the Edits to accept only 1 digit. The \"only digits\" part works normal, but \"only 1 digit\" part gives Access Violation Error (AVE). The code:</p>\n\n<pre><code>procedure TForm1.OnHandleChange(Sender: TObject);\nvar\nbx,by,x,y,len : Integer;\nbegin\nbx:=(sender as TEdit).tag div 1000;\nby:=(sender as TEdit).tag div 100-10*bx;\nx:=(sender as TEdit).tag div 10-100*bx-10*by;\ny:=(sender as TEdit).tag-bx*1000-by*100-x*10;\n{*The line below gives the error*} \nif not (MyEdit[bx,by,x,y].text[1] in ['1'..'9']) then MyEdit[bx,by,x,y].text:='';\nMyEdit[bx,by,x,y].SelStart:=length(MyEdit[bx, by, x,y].text);\nif length(MyEdit[bx, by, x,y].text) &gt;1\n              then MyEdit[bx,by,x,y].text:=MyEdit[bx,by,x,y].text[2];\nend;\n</code></pre>\n\n<p>The program executes and works although there is an AVE. Everytime I input a letter instead of a digit - the error comes, I click ok, and program does the job. But it is necessary to remove that error. Is there any way?</p>\n"},{"tags":["delphi","firemonkey","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":122,"score":1,"question_id":12890175,"title":"How I can Take Screen shot from TMediaPlayerControl in FM2?","body":"<p>For doing this action I use below code:</p>\n\n<pre><code>procedure TForm4.Button2Click(Sender: TObject);\nbegin\n  MediaPlayerControl1.MakeScreenshot.SaveToFile('c:\\temp\\e.bmp');\nend;\n</code></pre>\n\n<p>When this code runs bitmap saved to file; but It is a black Image all of the time.\nI am trying for solving this problem.\nplease help me.</p>\n"},{"tags":["delphi","pointer-arithmetic"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1975,"score":2,"question_id":3408472,"title":"what is difference between pchar and pbyte","body":"<p>Why can't I perform this operation:</p>\n\n<pre><code>var\n  data:pbyte;\n  x:int64;\n  o:pointer; \nbegin\n  o:=data+x;\nend;\n</code></pre>\n"},{"tags":["delphi","shift","subtitle"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":201,"score":4,"question_id":12864047,"title":"How to correct / shift subtitle time in SRT (SubRip) files?","body":"<p>How to correct/shift subtitle time forward and backward? Subtitle time format looks like this: \n<code>00:00:52,656 --&gt; 00:00:56,326</code></p>\n\n<p>If subtitle and audio aren't synchronized, for example, subtitle shows up before voice/audio, then all times of subtitle lines (time format: <code>00:00:52,656 --&gt; 00:00:56,326</code>) should be corrected.</p>\n\n<p>So, if time of all subtitle lines must be changed/shifted for 2 sec. forward, then, this time for subtitle line: <code>00:00:52,656 --&gt; 00:00:56,326</code> should be changed to: \n<code>00:00:54,656 --&gt; 00:00:58,326</code>. </p>\n\n<p>And this refers to all times in the subtitle file, not just one line of text/one time.</p>\n\n<hr>\n\n<p>Example of how SubRip (.srt) file looks like:</p>\n\n<pre><code>1\n00:00:52,656 --&gt; 00:00:56,326\nKanalska Zona: Panama\n\n2\n00:00:56,335 --&gt; 00:00:59,755\nFrancuzi su pokušali da izgrade\nkanal pre Amerikanaca.\n</code></pre>\n"},{"tags":["delphi","outlook","embed","mapi"],"answer_count":1,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":500,"score":5,"question_id":3359410,"title":"Embed Image to Outlook using extended mapi functions","body":"<p>I need to embed images in an email and preview the email before it is sent in outlook.  CDO and Redemption is not an option.</p>\n\n<p>I have tried the following code, but the images just appears as a little block.  </p>\n\n<pre><code>  procedure AddAttachment(FullFileName: String; Attachments: Outlook2000.Attachments; CID: String);\n  const\n    PR_ATTACH_CONTENT_ID   = $3712001E;\n    PR_ATTACH_CONTENT_ID_W = $3712001F; // Unicode\n    PR_ATTACH_MIME_TAG     = $370E001E;\n    PR_ATTACH_ENCODING     = $37020102;\n  var\n    IAttach: IMAPIProp;\n    Prop: PSPropValue;\n    AAttachment: Outlook2000.Attachment;\n    FileName: String;\n    PropValue: TSPropValue;\n    Prop1: TSPropTagArray;\n  begin\n    FileName := ExtractFileName(FullFileName);\n    Prop := nil;\n    try\n      AAttachment := Attachments.Add(FullFileName, olByValue, 1, FileName);\n      IAttach := AAttachment.MAPIOBJECT as IMAPIProp;\n      if Assigned(IAttach) then\n        try\n          PropValue.ulPropTag := PR_ATTACH_MIME_TAG;\n          PropValue.Value.lpszA := 'image/jpeg';\n          HrSetOneProp(IAttach, @PropValue);\n          PropValue.ulPropTag := PR_ATTACH_CONTENT_ID;\n          PropValue.Value.lpszA := PAnsiChar(AnsiString(CID));\n          HrSetOneProp(IAttach, @PropValue);\n        finally\n          if Assigned(Prop) then MAPIFreeBuffer(Prop);\n          IAttach := nil;\n        end;\n    except\n    end;\n  end;\n</code></pre>\n"},{"tags":["delphi","email","shell"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":297,"score":0,"question_id":11001835,"title":"Sending Email with signature","body":"<p>I have been using:</p>\n\n<pre><code>        ShellExecute(Self.Handle,\n            nil, PCHAR(format('mailto:%s ?Subject=Assunto: &amp;Body=',[_lEmails ])),\n            nil,\n            nil,\n            SW_NORMAL);\n</code></pre>\n\n<p>to send emails.\nNo Body text so the users that have automatic signatures in their emails clients get those automatically.</p>\n\n<p>Now I want to enable users to insert text as well, but if they do the text gets there but no signature.\nIs there a way to \"force\" this.</p>\n\n<p>Thanks</p>\n"},{"tags":["c++","delphi","static-linking"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":178,"score":3,"question_id":12853537,"title":"Difference between Delphi linker and C++ linker","body":"<p>I come from a Delphi world where importing a DLL function statically is pretty easy. All you need to do is specify the function name and the module like this:</p>\n\n<pre><code>function GetTickCount : DWORD; stdcall; external 'Kernel32.dll';\n</code></pre>\n\n<p>Why in C++ must I use <code>kernel32.lib</code> in order to import the function? Why can't I simply tell the linker to import that function just like in Delphi?</p>\n\n<p>I know it may sound noobish for manny of you, but coming in the C++ world from Delphi can really get confusing.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":157,"score":6,"question_id":12885480,"title":"Delphi exceptions not letting me see local variables","body":"<p>When debugging in Delphi, an exception will correctly tell me the line of code causing the fault, but I cannot get access to any local variables.  Is this a limitation in the debugger?  Or am I missing something simple?  At present, I have to mirror all local variables to a global on the line before the fault, recompile the program and hope to be able to repeat the same exception.  </p>\n\n<p>For example</p>\n\n<pre><code>MyArray[I]:=Foo(...); \n</code></pre>\n\n<p>If <code>I</code> is out of bounds (with bounds checking turned on), I cannot see what the variable <code>I</code> is, unless I mirrored it to a globally scoped debug variable on the previous line.  </p>\n\n<p>Or if I have </p>\n\n<pre><code>MyInteger:=Trunc(MyFloat), \n</code></pre>\n\n<p>and <code>MyFloat</code> is <code>6.1E+17</code>, I have no idea what it's value is.</p>\n"},{"tags":["c#","delphi","licensing","components"],"answer_count":5,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":362,"score":4,"question_id":3068103,"title":"How important to register(license) your own components?","body":"<p>I am new to component building, and I have noticed that other components have a comment on top of their units like agreement, terms and condition etc. whether its free or commercial. </p>\n\n<p>How important is to register(license) your own component and how/where? and when do you need to register it?</p>\n\n<p>How about freeware? Must have a license too?</p>\n\n<p>How do we know that they're using it?</p>\n"},{"tags":["delphi"],"answer_count":5,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":798,"score":2,"question_id":6519154,"title":"Taskbar width, height and position","body":"<p>I need to get the width and height of the taskbar. Also I need the position of the taskbar. How can I get this?</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":126,"score":2,"question_id":12886675,"title":"The procedure entry point <function> could not be located in the dynamic link library <dll>","body":"<p>I have converted all of the VB.NET DLL declarations </p>\n\n<pre><code>Declare Function SFileOpenArchive Lib \"Storm.dll\" Alias \"#266\" (ByVal lpFileName As String, ByVal dwPriority As Integer, ByVal dwFlags As Integer, ByRef hMPQ As Integer) As Boolean\n</code></pre>\n\n<p>over into Delphi.</p>\n\n<pre><code>function SFileOpenArchive(lpFileName: String; dwPriority, dwFlags, hMPQ: Integer): Boolean; stdcall; external 'Storm.dll';\n</code></pre>\n\n<p>However, when I call the functions and compile the program I get the following error:</p>\n\n<blockquote>\n  <p>The procedure entry point SFileOpenArchive could not be located in the dynamic link library Storm.dll.</p>\n</blockquote>\n\n<p>I have ensured that:</p>\n\n<ol>\n<li>the DLL is stored in the same directory as the application</li>\n<li>the functions I have declared exist (I was given the source code which was coded in VB.NET)</li>\n</ol>\n\n<p>What can I do to fix this error?</p>\n\n<p>Thank you in advanced.</p>\n"},{"tags":["delphi","tdbgrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":140,"score":0,"question_id":12861897,"title":"TDBGrid columns design time or run time?","body":"<p>I am using <code>TDBGrid</code> for the first time.</p>\n\n<p>I didn't even notice the <code>Columns</code> property in the object inspector and everything went just fine: the grid was filled.</p>\n\n<p>Then I saw the <code>Columns</code> property and tried it. When I use the object insector to add items to the <code>Columns</code> property of the grid, they do not all of them show up at run time. To me, it looks like the <code>FieldName</code> property is important. It looks like it is correct, but there are no values in some columns.</p>\n\n<p>If I leave this property blank (no columns at all) it seems that the control populates it itself at run time and I do see all the columns. I could live with that. When I set column titles at run time it works, but setting column width does not.</p>\n\n<hr>\n\n<p>[Update] Thanks for the feedback. I am learning slowly. Now I see what is happening. I wanted three of the five columns to be calculated. Two are gotten from INNER JOINs and the third from an SQL 'cast' of <code>SELECT ... FROM_UNIXTIME(&lt;table&gt;.time_stamp)</code>.</p>\n\n<p>If I do not define the columns at design time then these values are populated at run time when I execute my SELECT. Cnn anyone tell me how to set things up at design time? Thanks</p>\n"},{"tags":["delphi","delphi-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12864397,"title":"How to avoid System Exception when Runtime Themes are enabled?","body":"<p>I've just ran over something interesting, enabled runtime themes in Project Options and when a hint is shown on a TDCTree(from old Dream components, similar to TTreeView) and the mouse is moved over another node that should show hint, what I get is:</p>\n\n<pre><code>---------------------------\nDebugger Fault Notification\n---------------------------\nProject DRIVE:\\path\\to\\project\\MyApp.exe faulted with message: 'system exception (code 0xc000041d) at 0x73c84cad'. Process Stopped. Use Step or Run to continue.\n---------------------------\nOK   \n---------------------------\n</code></pre>\n\n<p>I believe that the same issue occurs within IDE, whenever I try to hover over items when adding items at design time.</p>\n\n<p>If I disable runtime themes in Project Options, no exception, but it shows the \"old style XP hint\".</p>\n\n<p>Application by itself raises an exception with Event Name \"APPCRASH\".</p>\n\n<p>Seen quite a few issues related to \"runtime themes\", but haven't seen any way to avoid these issues without disabling them.</p>\n\n<p>Operating system: Windows 7 x64</p>\n\n<p>Delphi: 2007 with December 2007 and February 2008 updates installed</p>\n\n<p><strong>UPDATE 1:</strong></p>\n\n<p>One way to avoid the issue is:</p>\n\n<pre><code>Procedure TDCTreeToolTip.DoHideToolTip;\nBegin\n  Inherited;\n  If FToolTipAdded Then\n    if FTreeNode &lt;&gt; NIL then // fix\n      DeleteToolTip(ToolTipID,FTreeNode.TreeView.Handle);\n  FToolTipAdded:=False;\n  FTreeNode:=Nil;\nEnd;\n</code></pre>\n\n<p>in unit \"dcntree.pas\".</p>\n\n<p>it seems that FTreeNode \"somehow\" gets NIL-ed before the call to DoHideToolTip, so the \"System Exception is raised... it still doesn't explain why only when \"Runtime themes are enabled\"</p>\n\n<p>I don't have time now to investigate this further, but the \"trigger\" is found, need to figure out \"whom\" is pulling it.</p>\n"},{"tags":["delphi","vcl","firemonkey","setparent"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":113,"score":0,"question_id":12883267,"title":"How we can Locate (SetParent) a FireMonkey App inside a VCL Form","body":"<p>I want lacate a FireMonkey Application shell inside a VCL form. \nComments: I can do this action with non FireMonkey Apps; but I can't do this for FireMonkey Applications.</p>\n\n<p>I use this code for VCL Side:</p>\n\n<pre><code>var\n  FmFormHandle: THandle;\n\nprocedure TForm4.Button1Click(Sender: TObject);\nvar\n  Rec: TShellExecuteInfo;\n  AFileName: string;\nconst\n  AVerb = 'open';\n  AParams = '';\n  ADir = '';\nbegin\n  AFileName := ExtractFilePath(Application.ExeName) + 'FM.exe';\n  FillChar(Rec, SizeOf(Rec), #0);\n\n  Rec.cbSize := SizeOf(Rec);\n  Rec.fMask := SEE_MASK_NOCLOSEPROCESS;\n  Rec.lpVerb := PChar(AVerb);\n  Rec.lpFile := PChar(AFileName);\n  Rec.lpParameters := PChar(AParams);\n  Rec.lpDirectory := PChar(ADir);\n  Rec.nShow := SW_HIDE;\n\n  ShellExecuteEx(@Rec);\n  WaitForInputIdle(Rec.hProcess, 5000);\n\n  FmFormHandle := Windows.FindWindow('FM', nil);\n  Windows.SetParent(FmFormHandle, Handle);\n\n  Resize;\n  ShowWindow(FmFormHandle, SW_SHOW);\nend;\nprocedure TForm4.FormResize(Sender: TObject);\nbegin\n  if IsWindow(FmFormHandle) then\n    begin\n      SetWindowPos(FmFormHandle, 0, 0, 0, ClientWidth, ClientHeight,\n        SWP_ASYNCWINDOWPOS);\n    end;\nend;\n</code></pre>\n\n<p>In the fireMonkey side I do't use any special code. just I set the caption property of MainForm to \"FM\".</p>\n\n<p>Please help me. (-_-)</p>\n"},{"tags":["delphi","memory-leaks","freepascal","lazarus"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":210,"score":4,"question_id":12879270,"title":"How to detect memory leaks in Free Pascal/Lazarus?","body":"<p>In Delphi I usually write a simple leak test like that</p>\n\n<pre><code>program MemLeak;\n\n{$APPTYPE CONSOLE}\n\nuses\n  SysUtils;\n\nprocedure Leak;\nbegin\n  { put leaking code here }\nend;\n\nbegin\n  ReportMemoryLeaksOnShutdown:= True;\n  try\n    Leak;\n  except\n    on E: Exception do\n      Writeln(E.ClassName, ': ', E.Message);\n  end;\nend.\n</code></pre>\n\n<p>How to detect memory leaks in Free Pascal/Lazarus?</p>\n"},{"tags":["sql-server-2008","delphi","tadoquery","rows-affected"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":160,"score":3,"question_id":12779534,"title":"Delphi - TADOQuery.RowsAffected always -1 with UPDATE SQL statement","body":"<p>I'm executing a SQL UPDATE statement using a TADOQuery component and want to inspect the number of rows that were updated.  The UPDATE statement is executing fine and the rows are modified accordingly but the .RowsAffected property always returns -1.  The documentation states -1 indicates an error with the statement, but as I say it executes fine.  I've tried prefixing the statement with SET NOCOUNT OFF but this made no difference.  My code is as follows :</p>\n\n<pre><code>var\n  adoUpdateQuery: TADOQuery;\n  blnUpdatedOK: Boolean;\nbegin\n  adoUpdateQuery := TADOQuery.Create(nil);\n  adoUpdateQuery.DisableControls;\n  adoUpdateQuery.Connection := adcMiddleTierDB;\n  adoUpdateQuery.ExecuteOptions := [eoExecuteNoRecords];\n  adoUpdateQuery.SQL.Text := 'UPDATE MyTable SET Status = 1 WHERE Status = 0';\n  try\n    adoUpdateQuery.ExecSQL;\n    blnUpdatedOK := (adoUpdateQuery.RowsAffected &gt; 0);\n</code></pre>\n\n<p>I'm using Delphi XE2, connecting to MS SQL Server 2008R2.</p>\n"},{"tags":["delphi","delphi-7","delphi-xe2","delphi-2010","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":4,"view_count":260,"score":0,"question_id":12873209,"title":"Delphi Scripting and ASM","body":"<p>I tried </p>\n\n<ul>\n<li>Pascal Script</li>\n<li>Fast Script</li>\n<li>Script Studio</li>\n<li>IdScript Engine</li>\n</ul>\n\n<p>However none support inline ASM. Is there some library that DOES support it?</p>\n"},{"tags":["delphi","oop","delphi-7","delphi-xe2","delphi-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":138,"score":5,"question_id":12871142,"title":"How can I declare an array property?","body":"<p>I constructed class system</p>\n\n<pre><code>  TTableSpec=class(Tobject)\n  private\n    FName : string;\n    FDescription : string;\n    FCan_add : Boolean;\n    FCan_edit : Boolean;\n    FCan_delete : Boolean;\n    FFields : array[1..100] of TFieldSpec;\n  public\n    property Name: String read FName;\n    property Description: String read FDescription;\n    property Can_add : Boolean read FCan_add;\n    property Can_edit : Boolean read FCan_edit;\n    property Can_delete : Boolean read FCan_delete;\n    property Fields : array read FFields;\n  end;\n</code></pre>\n\n<p>Thus in TableSpec Fields property shall be the list of fields (I used TFieldSpec array). How to organize the list of fields (using or without using an array) as as a result of compilation I receive an error</p>\n\n<pre><code>[Error] Objects.pas(97): Identifier expected but 'ARRAY' found\n[Error] Objects.pas(97): READ or WRITE clause expected, but identifier 'FFields' found\n[Error] Objects.pas(98): Type expected but 'END' found\n[Hint] Objects.pas(90): Private symbol 'FFields' declared but never used\n[Fatal Error] FirstTask.dpr(5): Could not compile used unit 'Objects.pas'\n</code></pre>\n"},{"tags":["delphi","xmpp","nativexml"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":172,"score":1,"question_id":12871714,"title":"delphi nativexml multi level xml structure","body":"<p>i work with live stream xml structure , i should to check received xml data to desire which way to select , the problem is xml stream is multi level as shown below, all me tests  Stuck with the first phase </p>\n\n<p>server response xml :</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;\n&lt;stream:stream xmlns:stream=\"http://etherx.jabber.org/streams\" xmlns=\"jabber:client\" from=\"messenger.tashbik.com\" id=\"40d07647\" xml:lang=\"en\" version=\"1.0\"&gt;\n\n&lt;stream:features&gt;\n&lt;starttls xmlns=\"urn:ietf:params:xml:ns:xmpp-tls\"&gt;&lt;/starttls&gt;\n&lt;mechanisms xmlns=\"urn:ietf:params:xml:ns:xmpp-sasl\"&gt;\n&lt;mechanism&gt;DIGEST-MD5&lt;/mechanism&gt;\n&lt;mechanism&gt;PLAIN&lt;/mechanism&gt;\n&lt;mechanism&gt;CRAM-MD5&lt;/mechanism&gt;\n&lt;/mechanisms&gt;\n\n&lt;compression xmlns=\"http://jabber.org/features/compress\"&gt;\n&lt;method&gt;zlib&lt;/method&gt;\n&lt;/compression&gt;\n\n&lt;auth xmlns=\"http://jabber.org/features/iq-auth\"/&gt;\n&lt;register xmlns=\"http://jabber.org/features/iq-register\"/&gt;\n&lt;/stream:features&gt;\n</code></pre>\n\n<p>how can i check all xml stream from top to down and access any level i want ?. as example i want to access <strong>stream:features</strong> level to check available futures , also i want to jump to the <strong>compression</strong> level to check it too .</p>\n\n<p>i use NativeXML 4.04</p>\n"},{"tags":["osx","delphi","delphi-xe2","firemonkey","keyevent"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":98,"score":3,"question_id":12876911,"title":"How to get current modifier states with FireMonkey on OSX?","body":"<p>With <strong>Delphi</strong> for Windows, I usually use this code:</p>\n\n<pre><code>function isCtrlDown : Boolean;\nvar\n  ksCurrent : TKeyboardState;\nbegin\n  GetKeyboardState(ksCurrent);\n  Result := ((ksCurrent[VK_CONTROL] and 128) &lt;&gt; 0);\nend;\n</code></pre>\n\n<p><strong>How can I achieve this with FireMonkey on Mac OSX?</strong></p>\n\n<p>I have found <a href=\"http://opensource.apple.com/source/WebCore/WebCore-955.66/platform/mac/KeyEventMac.mm?txt\" rel=\"nofollow\">this</a>, but I don't know how to manage it with FireMonkey/Delphi (which uses, ...):</p>\n\n<pre><code>void PlatformKeyboardEvent::getCurrentModifierState(bool&amp; shiftKey, bool&amp; ctrlKey, bool&amp; altKey, bool&amp; metaKey)\n{\n    UInt32 currentModifiers = GetCurrentKeyModifiers();\n    shiftKey = currentModifiers &amp; ::shiftKey;\n    ctrlKey = currentModifiers &amp; ::controlKey;\n    altKey = currentModifiers &amp; ::optionKey;\n    metaKey = currentModifiers &amp; ::cmdKey;\n}\n</code></pre>\n\n<p>I'm still investigating...\nFor now, I have find this unit with <strong>key events</strong> stuff...\n<code>unit Macapi.AppKit;</code></p>\n"},{"tags":["delphi","freepascal"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":126,"score":1,"question_id":12880243,"title":"Delphi: Which exception class should be used to raise last Win32/Win64 errors?","body":"<ol>\n<li><p>When writing a function/procedure/method that utilizes Windows API functions or functions of certain Windows DLLs (e.g. ntdll.dll), which Delphi exception class should be used to raise the last Win32/Win64 errors?</p>\n<p>Quoted from Delphi XE3 documentation about <a href=\"http://docwiki.embarcadero.com/Libraries/XE3/en/System.SysUtils.EExternal\" rel=\"nofollow\">System.SysUtils.EExternal</a>:</p>\n<blockquote><i>\"Note: <code>EExternal</code> classes represent Win32 exception codes. The <code>ExceptionRecord</code> member points to a <b>Win32</b> exception record.\"</i></blockquote>\n<li><p>From that point, I conclude that there are differences between Win32 and Win64 exception mechanism. What are the differences between them?</p></li>\n<li><p>For debugging purpose&mdash;I mean in regards to the stack frames related stuffs&mdash;, are the differences lead to different code implementation of exception handling for each platform?</p></li>\n</ol>\n"},{"tags":["delphi","runtime","components"],"answer_count":8,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":5811,"score":2,"question_id":1005373,"title":"Creating components at runtime - Delphi","body":"<p>how can I create a component at runtime and then work with it (changing properties, etc.)?</p>\n"},{"tags":["delphi","gexperts","uses-clause"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":145,"score":5,"question_id":12842665,"title":"Adding a unit to the uses clauses of all units in a project?","body":"<p>I am finding that certain kinds of code cleanups and refactorings are made VERY difficult by the difficulty of adding a unit to the uses-clauses of a large project.  </p>\n\n<p>I want to  add a unit to the interface-uses-clause of all delphi .pas units in a single project, and that means manually doing that in over 500 places.  Every time I refactor a giant unit and split it from one unit into two, I can probably search and replace using something like \"notepad++\" to change \"MyOldUnit,\" to \"MyOldUnit,MyNewUnit,\"  but sometimes, that's just not safe to do. It also misses the cases where \"MyOldUnit\" is the last thing in the uses clause (\"uses MyOldUnit;\").</p>\n\n<p>Anyways, search and replacing in files is dangerous business.  If no such tool exists, I am contemplating writing one, using the Castalia delphi parser. I have checked GExperts, Castalia, ModelMakerCodeExplorer and none of them have a way to batch-insert units into all uses clauses in a project.  I'm hoping a tool to do this exists.</p>\n\n<p>Secondly, in many cases, I'm moving a function from one unit where it doesn't belong to another, but this means I need to add that unit to 30% of the project's units, but not the other 70% where it's already added. That means a parser approach is required, not a regex approach.</p>\n"},{"tags":["c#","delphi","assembly","crc","crc32"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":178,"score":4,"question_id":12876436,"title":"Translate Delphi+Assembler CRC32 implementation to C#","body":"<p>I have to translate partially one old and large application from Delphi to .NET (C#).\nHere is one strange (at least for me) implementation of CRC32:</p>\n\n<pre><code>function CRC32(CRC: LongWord; Data: Pointer; DataSize: LongWord): LongWord; assembler;\nasm\n         AND    EDX,EDX\n         JZ     @Exit\n         AND    ECX,ECX\n         JLE    @Exit\n         PUSH   EBX\n         PUSH   EDI\n         XOR    EBX,EBX\n         LEA    EDI,CS:[OFFSET @CRC32]\n@Start:  MOV    BL,AL\n         SHR    EAX,8\n         XOR    BL,[EDX]\n         XOR    EAX,[EDI + EBX * 4]\n         INC    EDX\n         DEC    ECX\n         JNZ    @Start\n         POP    EDI\n         POP    EBX\n@Exit:   RET\n         DB 0, 0, 0, 0, 0 // Align Table\n@CRC32:  DD 000000000h, 077073096h, 0EE0E612Ch, 0990951BAh\n         DD 0076DC419h, 0706AF48Fh, 0E963A535h, 09E6495A3h\n         DD 00EDB8832h, 079DCB8A4h, 0E0D5E91Eh, 097D2D988h\n         DD 009B64C2Bh, 07EB17CBDh, 0E7B82D07h, 090BF1D91h\n         DD 01DB71064h, 06AB020F2h, 0F3B97148h, 084BE41DEh\n         DD 01ADAD47Dh, 06DDDE4EBh, 0F4D4B551h, 083D385C7h\n         DD 0136C9856h, 0646BA8C0h, 0FD62F97Ah, 08A65C9ECh\n         DD 014015C4Fh, 063066CD9h, 0FA0F3D63h, 08D080DF5h\n         DD 03B6E20C8h, 04C69105Eh, 0D56041E4h, 0A2677172h\n         DD 03C03E4D1h, 04B04D447h, 0D20D85FDh, 0A50AB56Bh\n         DD 035B5A8FAh, 042B2986Ch, 0DBBBC9D6h, 0ACBCF940h\n         DD 032D86CE3h, 045DF5C75h, 0DCD60DCFh, 0ABD13D59h\n         DD 026D930ACh, 051DE003Ah, 0C8D75180h, 0BFD06116h\n         DD 021B4F4B5h, 056B3C423h, 0CFBA9599h, 0B8BDA50Fh\n         DD 02802B89Eh, 05F058808h, 0C60CD9B2h, 0B10BE924h\n         DD 02F6F7C87h, 058684C11h, 0C1611DABh, 0B6662D3Dh\n         DD 076DC4190h, 001DB7106h, 098D220BCh, 0EFD5102Ah\n         DD 071B18589h, 006B6B51Fh, 09FBFE4A5h, 0E8B8D433h\n         DD 07807C9A2h, 00F00F934h, 09609A88Eh, 0E10E9818h\n         DD 07F6A0DBBh, 0086D3D2Dh, 091646C97h, 0E6635C01h\n         DD 06B6B51F4h, 01C6C6162h, 0856530D8h, 0F262004Eh\n         DD 06C0695EDh, 01B01A57Bh, 08208F4C1h, 0F50FC457h\n         DD 065B0D9C6h, 012B7E950h, 08BBEB8EAh, 0FCB9887Ch\n         DD 062DD1DDFh, 015DA2D49h, 08CD37CF3h, 0FBD44C65h\n         DD 04DB26158h, 03AB551CEh, 0A3BC0074h, 0D4BB30E2h\n         DD 04ADFA541h, 03DD895D7h, 0A4D1C46Dh, 0D3D6F4FBh\n         DD 04369E96Ah, 0346ED9FCh, 0AD678846h, 0DA60B8D0h\n         DD 044042D73h, 033031DE5h, 0AA0A4C5Fh, 0DD0D7CC9h\n         DD 05005713Ch, 0270241AAh, 0BE0B1010h, 0C90C2086h\n         DD 05768B525h, 0206F85B3h, 0B966D409h, 0CE61E49Fh\n         DD 05EDEF90Eh, 029D9C998h, 0B0D09822h, 0C7D7A8B4h\n         DD 059B33D17h, 02EB40D81h, 0B7BD5C3Bh, 0C0BA6CADh\n         DD 0EDB88320h, 09ABFB3B6h, 003B6E20Ch, 074B1D29Ah\n         DD 0EAD54739h, 09DD277AFh, 004DB2615h, 073DC1683h\n         DD 0E3630B12h, 094643B84h, 00D6D6A3Eh, 07A6A5AA8h\n         DD 0E40ECF0Bh, 09309FF9Dh, 00A00AE27h, 07D079EB1h\n         DD 0F00F9344h, 08708A3D2h, 01E01F268h, 06906C2FEh\n         DD 0F762575Dh, 0806567CBh, 0196C3671h, 06E6B06E7h\n         DD 0FED41B76h, 089D32BE0h, 010DA7A5Ah, 067DD4ACCh\n         DD 0F9B9DF6Fh, 08EBEEFF9h, 017B7BE43h, 060B08ED5h\n         DD 0D6D6A3E8h, 0A1D1937Eh, 038D8C2C4h, 04FDFF252h\n         DD 0D1BB67F1h, 0A6BC5767h, 03FB506DDh, 048B2364Bh\n         DD 0D80D2BDAh, 0AF0A1B4Ch, 036034AF6h, 041047A60h\n         DD 0DF60EFC3h, 0A867DF55h, 0316E8EEFh, 04669BE79h\n         DD 0CB61B38Ch, 0BC66831Ah, 0256FD2A0h, 05268E236h\n         DD 0CC0C7795h, 0BB0B4703h, 0220216B9h, 05505262Fh\n         DD 0C5BA3BBEh, 0B2BD0B28h, 02BB45A92h, 05CB36A04h\n         DD 0C2D7FFA7h, 0B5D0CF31h, 02CD99E8Bh, 05BDEAE1Dh\n         DD 09B64C2B0h, 0EC63F226h, 0756AA39Ch, 0026D930Ah\n         DD 09C0906A9h, 0EB0E363Fh, 072076785h, 005005713h\n         DD 095BF4A82h, 0E2B87A14h, 07BB12BAEh, 00CB61B38h\n         DD 092D28E9Bh, 0E5D5BE0Dh, 07CDCEFB7h, 00BDBDF21h\n         DD 086D3D2D4h, 0F1D4E242h, 068DDB3F8h, 01FDA836Eh\n         DD 081BE16CDh, 0F6B9265Bh, 06FB077E1h, 018B74777h\n         DD 088085AE6h, 0FF0F6A70h, 066063BCAh, 011010B5Ch\n         DD 08F659EFFh, 0F862AE69h, 0616BFFD3h, 0166CCF45h\n         DD 0A00AE278h, 0D70DD2EEh, 04E048354h, 03903B3C2h\n         DD 0A7672661h, 0D06016F7h, 04969474Dh, 03E6E77DBh\n         DD 0AED16A4Ah, 0D9D65ADCh, 040DF0B66h, 037D83BF0h\n         DD 0A9BCAE53h, 0DEBB9EC5h, 047B2CF7Fh, 030B5FFE9h\n         DD 0BDBDF21Ch, 0CABAC28Ah, 053B39330h, 024B4A3A6h\n         DD 0BAD03605h, 0CDD70693h, 054DE5729h, 023D967BFh\n         DD 0B3667A2Eh, 0C4614AB8h, 05D681B02h, 02A6F2B94h\n         DD 0B40BBE37h, 0C30C8EA1h, 05A05DF1Bh, 02D02EF8Dh\n         DD 074726F50h, 0736E6F69h, 0706F4320h, 067697279h\n         DD 028207468h, 031202963h, 020393939h, 048207962h\n         DD 06E656761h, 064655220h, 06E616D64h, 06FBBA36Eh\nend;\n</code></pre>\n\n<p>It's used now and it's somehow working, because data are sent through network and destination devices are processed them OK. \nI need to achieve the same result from C# function and for this reason i played with most recommended on StackOverflow solution related to CRC32 in C# by [)amien, <a href=\"http://damieng.com/blog/2006/08/08/calculating_crc32_in_c_and_net\" rel=\"nofollow\">link here</a>:\nBut I am getting different results:</p>\n\n<pre><code>//Old-Delphi\nprocedure TestCrc();\nvar\n  ret: LongWord;\nconst\n  lArr: array[0..2] of Byte = (49, 50, 51); //\"123\"\nbegin\n  ret := CRC32(0, @lArr, Length(lArr)); //1997126336\n  //print IntToStr(ret); //1997126336\nend\n</code></pre>\n\n<p>and in C#</p>\n\n<pre><code>//New-C#\nstatic void Main(string[] args)\n{\n    Crc32 crc32 = new Crc32(); //Using Default ctor\n    String hash = String.Empty;\n    string testStr = \"123\"; //in bytes {49, 50, 51}\n    byte[] out_bytes = crc32.ComputeHash(Encoding.ASCII.GetBytes(testStr));\n    foreach (byte b in out_bytes) hash += b.ToString(\"x2\").ToLower();\n    Console.WriteLine(\"CRC-32 is {0} ({1})\", hash, BitConverter.ToUInt32(out_bytes, 0));\n    //Output is Uint32 value = 3529721992\n}\n</code></pre>\n\n<p>I don't know where is the difference - maybe in tables and seed?\nOr maybe better solution to wrap old functionality in DLL and access it from new C# application via COM?</p>\n\n<p>Please advice...</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12877378,"title":"how to control fast report objects from a form","body":"<p>how i could control objects in fast report like text width or label caption\nfrom delphi form befor showing report \ni have delphi xe2 fast report 4 and it's my first experince in fast report</p>\n\n<pre><code>in report builder i can do this but now i cant't\n\ndynamc report is vey important it's change all time depending on varibels came   \nfrom delphi form\n</code></pre>\n\n<p>becasue i have dynamic report and it's all time change depend on text from the form</p>\n\n<pre><code>dynamc report is vey important it's change all time depending on varibels came   \nfrom delphi form\n</code></pre>\n"},{"tags":["delphi","firemonkey","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":1,"view_count":272,"score":5,"question_id":12804990,"title":"How to get screen resolution in Firemonkey XE3?","body":"<p>How can I get the screen resolution in Firemonkey 2 (Delphi XE3)?</p>\n"},{"tags":["delphi","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12859944,"title":"Cannot set printer settings via ResetDc when doing the second time call to a dll","body":"<p>I have a dll in which I have printing unit.</p>\n\n<p>In my application I have exported methods to begin,end printing process as well as print documents.</p>\n\n<p>The calls to a dll can be as follows:</p>\n\n<pre><code>1-&gt; begin printing and print document\n2-&gt; print document\n3-&gt; end printing.\n</code></pre>\n\n<p>I am changing settings before each printed page (tray, orientation, etc)\nStep 1 is done successfully\nwhen I make another call (2) and try to change printer settings, method: ResetDc\nfor a dev mode structure returns false ...</p>\n\n<p>Is it the problem that when I am back in app after 1 call, app printers unit changes something which prevents subsequent calls in a dll?</p>\n\n<p>How to workaround the problem?</p>\n\n<h2>EDIT</h2>\n\n<p>Here is the function which set page settings.\nWhen 1 call is made (from the above list) ResetDC is executed successfully, but in the next call ResetDC returns false. Why ... ?</p>\n\n<pre><code>function PRPageSetup(paperSize: Integer = DMPAPER_A4): Boolean;\nvar\n  pDevice: pChar;\n  pDriver: pChar;\n  pPort: pChar;\n  hDMode: THandle;\n  PDMode: PDEVMODE;\n  PrnHandle: THandle;\n\nbegin\n  result := false;\n  GetMem(pDevice, cchDeviceName);\n  GetMem(pDriver, MAX_PATH);\n  GetMem(pPort, MAX_PATH);\n\n  Printer.GetPrinter(pDevice, pDriver, pPort, hDMode);\n\n  if hDMode &lt;&gt; 0 then\n  begin\n    pDMode := GlobalLock(hDMode);\n    if pDMode &lt;&gt; nil then\n    begin                 \n         pDMode^.dmFields := pDMode^.dmFields or DM_PAPERSIZE or DM_ORIENTATION;\n         pDMode^.dmPaperSize := paperSize;        \n\n      if Printer.Printing then\n        PrnHandle := printer.Canvas.Handle\n       else\n        PrnHandle := Printer.Handle;\n\n      if ResetDc(PrnHandle, pDMode^) &lt;&gt; 0\n        then PRCanReset := true\n        else PRCanReset := false;\n\n      Result := true;\n      GlobalUnlock(hDMode);\n    end;\n  end;\n  FreeMem(pDevice, cchDeviceName);\n  FreeMem(pDriver, MAX_PATH);\n  FreeMem(pPort, MAX_PATH);\nend;\n</code></pre>\n"},{"tags":["delphi","twebbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":145,"score":0,"question_id":12874538,"title":"delphi twebrowser: how to select a value in a <select> html element?","body":"<p>I have a Twebbrowser in my delphi application.</p>\n\n<p>My Goal is to <strong>select an option in a  html element whose value is \"value\"</strong>: </p>\n\n<p>Any clue to achieve that ?</p>\n\n<p>regards</p>\n"},{"tags":["delphi","bitmap","transparency"],"answer_count":2,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":470,"score":7,"question_id":7732435,"title":"How to get bitmap transparancy without the need to paint first?","body":"<p>A newly created bitmap seems to have a (white) background by default. At least, a query on the Pixels property confirms. But why is that background color not used as the transparent color when <code>Transparent</code> is set true?</p>\n\n<p>Consider this simple test code:</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar\n  Bmp: TBitmap;\nbegin\n  Bmp := TBitmap.Create;\n  try\n    Bmp.Width := 100;\n    Bmp.Height := 100;\n    Bmp.Transparent := True;\n    Canvas.Draw(0, 0, Bmp);                              // A white block is drawn\n    Bmp.Canvas.Brush.Color := Bmp.Canvas.Pixels[0, 99];  // = 'clWhite'\n    Bmp.Canvas.FillRect(Rect(0, 0, 100, 100));\n    Canvas.Draw(0, 100, Bmp);                            // \"Nothing\" is drawn\n  finally\n    Bmp.Free;\n  end;\nend;\n</code></pre>\n\n<p>For some reason, the entire bitmap surface has to be painted before it can appear transparent, which sounds kind of odd.</p>\n\n<p>The following variations are tried to eliminate the call to <code>FillRect</code>, all with the same outcome (no transparancy):</p>\n\n<ul>\n<li>Only setting <code>Brush.Color</code>,</li>\n<li><code>Brush.Handle := CreateSolidBrush(clWhite)</code>,</li>\n<li><code>PixelFormat := pf32Bit</code>,</li>\n<li><code>IgnorePalette := True</code>,</li>\n<li><code>TransparantColor := clWhite</code>,</li>\n<li><code>TransparantMode := tmFixed</code>,</li>\n<li><code>Canvas.Pixels[0, 99] := clWhite</code> which makes only thát pixel transparent,</li>\n<li><code>Modified := True</code>.</li>\n</ul>\n\n<p>So, the wish is to paint only a portion of a newly created bitmap and get the remaining surface transparent.</p>\n\n<p>Using: Delphi 7, Win 7/64.</p>\n"},{"tags":["delphi","delphi-xe","delphi-xe2"],"answer_count":0,"favorite_count":2,"up_vote_count":37,"down_vote_count":0,"view_count":442,"score":37,"question_id":9122646,"title":"BcdDivide function behave differently in Delphi XE and XE2","body":"<p>FmtBcd.pas has been extensively revised, and rewritten in Delphi XE2.  I have a case that uses division operation on two Bcd values, and shows different results.  A worst case is the Delphi XE2 may prompt Bcd overflow error:</p>\n\n<p>Running the following code in Delphi XE2 console apps:</p>\n\n<pre><code>var A, B, C, D: TBcd;\nbegin\n  A := StrToBcd('1');\n  B := StrToBcd('3');\n  BcdDivide(A, B, C);\n  WriteLn(BcdToStr(C));\n\n  try\n    BcdMultiply(C, C, D);\n    WriteLn(BcdToStr(D));\n  except\n    on E: Exception do\n      WriteLn(E.Message);\n  end;\n\n  ReadLn;\nend.\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>0.333333333333333333333333333333333333333333333333333333333333333\nBCD overflow\n</code></pre>\n\n<p>The variable C contains a Bcd Value with decimal places of 63.  Performing further BcdMultiply operation on variable C will cause a Bcd overflow error.</p>\n\n<p>However, to run the same code in Delphi XE yields the following result without any exception prompt:</p>\n\n<pre><code>0.3333333333\n0.11111111108888888889\n</code></pre>\n"},{"tags":["delphi","ide","editor"],"answer_count":0,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":114,"score":4,"question_id":12874514,"title":"Delphi plugin for pasting text constants in source code?","body":"<p>Inserting (pasting from clipboard) of text constants in the Delphi code editor requires some manual \"postprocessing\" ...</p>\n\n<ul>\n<li>split up long text into multiple lines (and  insert the string concatenation symbol)</li>\n<li>escape quotes (replace single quotes with double quotes)</li>\n<li>enclose the string with quotes</li>\n<li>keep original white space (leading blanks, line feeds)</li>\n</ul>\n\n<p>Is there a IDE plugin available which helps to reduce these manual steps?</p>\n"},{"tags":["delphi","tstringgrid"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":180,"score":2,"question_id":12854401,"title":"How to quickly add many rows to a TStringGrid?","body":"<p>I googled and found a lot of advice, but it all seemed several years old and none of it helped.</p>\n\n<p>I have a string grid with 8 columns and once I get more than a few hundred rows it is taking over 2 seconds to populate (I compared using GetTickCount).</p>\n\n<p>I tried <code>StringGrid.Perform(WM_SETREDRAW, 0, 0)</code> (and <code>0, 1</code> at the end). I tried setting <code>\nVisible := False</code> while updating. Both to no use.</p>\n\n<p>There is no <code>BeginUpdate()</code> method.</p>\n\n<p>Any advice? Delphi XE2 starter. I would be willing to use a FOSS 3rd party VCL string grid if it is tried &amp; tested.</p>\n\n<hr>\n\n<p>[Update]  using TDrawGrid ...  \"A TDrawGrid doesn't have a property \"Cells\", like its brother TStringGrid. Your code has to calculate where to display the data and next it must draw a representation of the data on the \"Canvas\" of the grid.\"  </p>\n\n<p>That sounds like a lot of work to me :-(</p>\n\n<p>Using VirtualTreeView - sounds ok if it is fast enough. I just won't have any child nodes.  (update++ I just read this on <a href=\"http://www.lischke-online.de/index.php/controls/virtual-treeview\" rel=\"nofollow\">the homepage</a> \"Virtual Treeview is extremely fast. Adding one million nodes takes only 700 milliseconds\"). No problems on speed, then. But it woudl nice to just use a string grid. Escpecially one where the user can click &amp; sort.</p>\n\n<p>Alternatively, the stringgrid is only 20 rows high. Maybe I could just handle scrolbar clicks and clear &amp; repopulate those 20 rows when the user scrols?</p>\n\n<p>[Furtehr update] I changed from TStringGrid to TListView which codes have <code>Beginupdate())</code>, but that made a negligible difference.  Ops, I forgot \"viortual mode\" - brb.</p>\n\n<p>Btw, the data are read-only, just for disply.</p>\n\n<p>Surely this is a very common probem?</p>\n"},{"tags":["delphi","delphi-xe2","virtualtreeview","vcl-styles","tvirtualstringtree"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":330,"score":3,"question_id":10215780,"title":"Incorrectly drawn themed checkbox in TVirtualStringTree","body":"<p>Checkbox handling in version 5.0.0 of VirtualTrees.pas appears broken when toThemeAware is enabled. Nodes that are csUncheckedNormal are drawn as checked + hot.</p>\n\n<p>To correctly paint an unchecked, themed checkbox using DrawElement, the Details record must be : Element = teButton, Part = 3, and State = 5. However, VirtualTrees.pas ends up calling DrawElement with State = 1 when a node is set to csUncheckedNormal.</p>\n\n<p>There seems to be a good deal of indirection and extra constants declared in VirtualTrees, so I'm not sure how best to fix this. Ideas welcomed...</p>\n\n<p>(Even the minimal code to get a TVirtualStringTree on screen and filled with some data is a bit lengthy to post here. Aside from the basics, all that's needed to reproduce this is to enable toCheckSupport in TreeOptions.MiscOptions, and set Node.CheckType := ctTriStateCheckBox in the InitNode callback.)</p>\n"},{"tags":["delphi","delphi-7","virtualtreeview","tvirtualstringtree"],"answer_count":1,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":208,"score":3,"question_id":10537016,"title":"How to color blend cells with a background image in VirtualTreeView?","body":"<p>I'm using VT.Background to display a background image in VT with a few columns.<br>\nBut I can't find a way to use different colors for cells because they hide the background image. </p>\n\n<p>I have tried to use <code>OnBeforeItemErase</code> but if I use<code>EraseAction := eaColor</code> the background bitmap area on the cell is also being painted, if I use <code>eaDefault</code> the color is not being applied.</p>\n\n<p>Any idea how this can be done?</p>\n"},{"tags":["delphi","virtualtreeview","tvirtualstringtree"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":200,"score":3,"question_id":10637764,"title":"TVirtualStringTree - How to change the [-] / [+] buttons?","body":"<p>How can I use my own custom buttons (images) to replace the default <code>[-]</code>/<code>[+]</code> buttons in the VST?<br>\nI want to use arrows instead (<img src=\"http://i.stack.imgur.com/dpWiD.png\" alt=\"enter image description here\">, <img src=\"http://i.stack.imgur.com/hEuLl.png\" alt=\"enter image description here\">), but also to support RTL bidi mode (<img src=\"http://i.stack.imgur.com/Z1p5k.png\" alt=\"enter image description here\">, <img src=\"http://i.stack.imgur.com/0X2WF.png\" alt=\"enter image description here\">).</p>\n\n<p>edit: I am aware of the <code>bsTriangle</code> style (ButtonStyle). It does not respect RTL. I want to use my own custom images.</p>\n"},{"tags":["delphi","delphi-7","virtualtreeview","object-pascal","tvirtualstringtree"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":110,"score":1,"question_id":11803379,"title":"VirtualStringTree how to free multiple nodes","body":"<p>I have a VirtualStringTree with X roots and X childnodes.</p>\n\n<p>Every root has a special NodeData assigned.\nEvery childnode has another NodeData assigned. \nHow do I know OnFreeNode which is which? Cause I can't free the data without knowing which record is assigned to it.\nAny Ideas?</p>\n"},{"tags":["delphi","delphi-7","vcl","virtualtreeview","tvirtualstringtree"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":130,"score":1,"question_id":11877505,"title":"VirtualStringTree aligned text and gridlines","body":"<p>I have a virtualstringtree (Gridlines enabled) with X headers and x roots.\nI would like to add children (at least 1) to the roots that have only 1 text which is in the middle and goes through all the headers (independent). So no matter if I resize the headers, etc. the text is always aligned to the actual client size of the VirtualStringTree.</p>\n\n<p>Is this possible? If so, how?</p>\n\n<p><img src=\"http://i.stack.imgur.com/D8R92.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi","delphi-7","virtualtreeview","object-pascal","tvirtualstringtree"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":146,"score":1,"question_id":11946414,"title":"VirtualStringTree OnNodeRightClick","body":"<p>I am looking for a procedure or something that gets fired if I right click on a Node (or in general on the VirtualStringTree)</p>\n\n<p>I have the following scenario:</p>\n\n<ul>\n<li>I have my VST close to a listview.</li>\n<li>I can only multi select root nodes with the mouse (hold mousebutton and move the mouse)</li>\n<li>If I click on ANY child node (right or left) - it is selected (+ [VSelected] State)</li>\n<li>If I right click on a root node it selects automatically and opens a popupmenu.</li>\n</ul>\n\n<p>Now I would like to have a different popupmenu for ( 1 common ) for all my child nodes (and only if they are selected).</p>\n\n<p>Hope you can understand what I mean, thank your for your help.</p>\n"},{"tags":["delphi","delphi-7","virtualtreeview","tvirtualstringtree"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":177,"score":3,"question_id":12142258,"title":"How to select all root or all child nodes in VirtualStringTree?","body":"<p>I would like to select either all root nodes or all child nodes (not all nodes in a VirtualTreeView).<br>\nI've tried to use this code to select all root nodes:</p>\n\n<pre><code>procedure SelectAllRoots;\nvar\n  Node: PVirtualNode;\nbegin\n  Form1.VirtualStringTree1.BeginUpdate;\n  Node := Form1.VirtualStringTree1.GetFirst;\n  while True do \n  begin\n    if Node = nil then \n      Break;\n    if not (vsSelected in Node.States) then\n      Node.States := Node.States + [vsSelected];\n    Node := Form1.VirtualStringTree1.GetNext(Node);\n  end;\n  Form1.VirtualStringTree1.EndUpdate;\nend;\n</code></pre>\n\n<p>I can tell there's a small glitch. \nThe selection is either incomplete or gets stuck. What am I doing wrong ?</p>\n\n<p><strong>Edit:</strong><br>\nI use MultiSelection.</p>\n"},{"tags":["delphi","virtualtreeview","tvirtualstringtree"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":204,"score":1,"question_id":12189058,"title":"How to let TVirtualStringTree to display an icon in disabled state?","body":"<p>I need to display files in a directory to a TVirtualStringTree. So, I use SHGetFileInfo to get files' icons. But seems I can only get \"normal\" icons (Left side on following screen shot). If so, can TVirtualStringTree draw icons as \"disabled\"? Just like you disabled the a node. Please see a screen shot:</p>\n\n<p><img src=\"http://i.stack.imgur.com/uvvao.png\" alt=\"enter image description here\"></p>\n\n<p><strong>UPDATED</strong></p>\n\n<p>There is a <a href=\"http://support.soft-gems.net/forums/viewtopic.php?t=900\" rel=\"nofollow\">similar thread</a> in Soft Gems forum. I can get the rect of the icon then draw the icon myself. I'm using TcxImageList and it can draw the \"disabled\" icon easily. I firstly assigned a non-exist image index in GetImageIndex event so I have a room to draw the icon. Then using following code to draw.</p>\n\n<pre><code>procedure TfrmMain.tvSharesAfterItemPaint(Sender: TBaseVirtualTree; TargetCanvas: TCanvas; Node: PVirtualNode; ItemRect: TRect); \nvar \n  rImage: TRect; \n  OffsetLeft: Integer; \nbegin \n    rImage  := ItemRect; \n\n    with TVirtualStringTree(Sender) do begin \n      if (toShowRoot in TreeOptions.PaintOptions) then \n        OffsetLeft := Indent * (GetNodeLevel(Node) + 1) \n      else \n        OffsetLeft := Indent * GetNodeLevel(Node); \n\n      Inc(rImage.Left, Margin + OffsetLeft); \n      Inc(rImage.Top, (NodeHeight[Node] - Images.Height) div 2); \n      rImage.Right  := rImage.Left + Images.Width; \n      rImage.Bottom := rImage.Top + Images.Height; \n    end; \n\n    // draw the \"normal\" or \"disabled\" icon here\n    imageList.Draw(TargetCanvas, rImage.left, rImage.Top, ...);\n  end; \nend;\n</code></pre>\n"},{"tags":["delphi","c++builder","virtualtreeview","tvirtualstringtree"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12868259,"title":"When to redraw VirtualTreeView after OnNewText event?","body":"<p>I use this code to fill VirtualStringTree and allow renaming items:</p>\n\n<pre><code>//---------------------------------------------------------------------------\n// Structure for the tree\n//---------------------------------------------------------------------------\nstruct TVSTdata\n{\nUnicodeString Name;\n};\n//---------------------------------------------------------------------------\n// Initialization of the tree\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner) : TForm(Owner)\n{\nVirtualStringTree1-&gt;NodeDataSize = sizeof(TVSTdata);\n// Fill all nodes with initial data\nInitializeTree();\n}\n//---------------------------------------------------------------------------\n// Fill all nodes with data and assign FocusedNode\n//---------------------------------------------------------------------------\nvoid TForm1::InitializeTree()\n{\nTVirtualNode* pNode;\nTVirtualNode* pActiveNode;\nTVSTdata*     pData;\n\nVirtualStringTree1-&gt;BeginUpdate();\nVirtualStringTree1-&gt;Clear();\n\npNode = VirtualStringTree1-&gt;AddChild(NULL); pData = static_cast&lt;TVSTdata*&gt;(VirtualStringTree1-&gt;GetNodeData(pNode)); pData-&gt;Name = \"This is name 1\";\npNode = VirtualStringTree1-&gt;AddChild(NULL); pData = static_cast&lt;TVSTdata*&gt;(VirtualStringTree1-&gt;GetNodeData(pNode)); pData-&gt;Name = \"This is name 2\";\npNode = VirtualStringTree1-&gt;AddChild(NULL); pData = static_cast&lt;TVSTdata*&gt;(VirtualStringTree1-&gt;GetNodeData(pNode)); pData-&gt;Name = \"This is name 3\"; pActiveNode = pNode;\npNode = VirtualStringTree1-&gt;AddChild(NULL); pData = static_cast&lt;TVSTdata*&gt;(VirtualStringTree1-&gt;GetNodeData(pNode)); pData-&gt;Name = \"This is name 4\";\npNode = VirtualStringTree1-&gt;AddChild(NULL); pData = static_cast&lt;TVSTdata*&gt;(VirtualStringTree1-&gt;GetNodeData(pNode)); pData-&gt;Name = \"This is name 5\";\n\nVirtualStringTree1-&gt;Selected[pActiveNode] = true;\nVirtualStringTree1-&gt;FocusedNode = pActiveNode; // PROBLEM -&gt; if assigned from within OnNewText will still remain NULL and won't be set to pActiveNode!\nVirtualStringTree1-&gt;EndUpdate();\n}\n//---------------------------------------------------------------------------\n// Just display the text\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::VirtualStringTree1GetText(TBaseVirtualTree *Sender, PVirtualNode Node, TColumnIndex Column, TVSTTextType TextType, UnicodeString &amp;CellText)\n{\nTVSTdata* pData = static_cast&lt;TVSTdata*&gt;(Sender-&gt;GetNodeData(Node));\nCellText = pData-&gt;Name;\n}\n//---------------------------------------------------------------------------\n// Allow editing\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::VirtualStringTree1Editing(TBaseVirtualTree *Sender, PVirtualNode Node, TColumnIndex Column, bool &amp;Allowed)\n{\nAllowed = true;\n}\n//---------------------------------------------------------------------------\n// Now this is where ideally I would reload the tree with new data - after rename\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::VirtualStringTree1NewText(TBaseVirtualTree *Sender, PVirtualNode Node, TColumnIndex Column, UnicodeString NewText)\n{\nNewText = \"not important for this example as tree is reloaded anyway\";\nInitializeTree();  // ERROR is here - after assigning FocusedNode it is still NULL\n//Timer1-&gt;Enabled = true; // If delayed call FocusedNode is correctly assigned and not NULL\n}\n//---------------------------------------------------------------------------\nvoid __fastcall TForm1::Timer1Timer(TObject *Sender)\n{\n//InitializeTree();\n//Timer1-&gt;Enabled = false;\n}\n//---------------------------------------------------------------------------\n</code></pre>\n\n<p><strong>The problem</strong> - when <code>InitializeTree()</code> is called initially and <code>VirtualStringTree1-&gt;FocusedNode</code> is assigned it is correctly assigned (not NULL).</p>\n\n<p>However, if this <code>InitializeTree()</code> function is called within <code>OnNewText</code> to actually reload the tree from database after rename event - after assigning <code>FocusedNode</code> it is remains NULL. So obviously tree cannot be reloaded and assigned <code>FocusedNode</code> from within the <code>OnNewText</code> event.</p>\n\n<p>I implemented delayed call to reload new tree and reassign <code>FocusedNode</code> - by implementing a quick and dirty timer (could have used PostMessage for delayed function call but this is just a dumb example) - after assigning within a timer it no longer NULL and works as expected.</p>\n\n<p>Can anyone point me what is the optimal way to implement reloading of the tree - like a particular event to use in which it is safe to set new <code>FocusedNode</code> and it won't be reassigned back to NULL? Is delayed function call the only way to achieve this or is there a better event to trap (for example if one occurs after <code>OnNewText</code> if this one doesn't allow setting focused node). Of course this works but I am interested if there is a better way to do this.</p>\n"},{"tags":["delphi","tadodataset"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":98,"score":2,"question_id":12491660,"title":"Retreiving autogenerated data in insert on ADODataset","body":"<p>I actually try to do an insert on a ADODataset linked on a table with a autogerenated Guid.\nWhen I try to get the new Id of my record I get some zero for Guid.</p>\n\n<p>Thanks for the help.</p>\n"},{"tags":["iphone","ipad","delphi","tcpclient","tcpserver"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":161,"score":3,"question_id":9560574,"title":"Apple IOS application and Delphi TidCmdTcpServer","body":"<p>I have a server process written in Delphi which has been in production for several years.  It is using the <code>TidCmdTcpServer</code> to communicate with the client (also written in Delphi and using the TidTcpClient).  This server uses has SSL encryption enabled.</p>\n\n<p>I am contemplating writing an iPhone/iPad app to use in addition to the existing client.\nI have searched but have been unable to find any examples of how to connect an IOS client to the SSL encrypted TidCmdTcpServer service running on windows.</p>\n\n<p>Does anyone have any ideas?</p>\n\n<p>Thanks,\nKen</p>\n"},{"tags":["delphi","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":160,"score":2,"question_id":12183067,"title":"Get Column Headers from empty result set with Delphi ADOStoredProc","body":"<p>I run several stored procedures with MS SQL.  When I run the procedures under the MS SQL Server Management Studio, they always return column headers.  I am trying to get this functionality in a Delphi program as well.  Currently, no headers are returned if the data set has no rows.  Using Delphi 7, TADOStoredProc, TADODataset and a string grid:</p>\n\n<pre><code>ADOStoredProc1.ObjectView := True;\nADOStoredProc1.Open;\nADODataSet1.Recordset := ADOStoredProc1.Recordset;\n\n// process the first dataset, which contains rows\n\nif not ADODataSet1.IsEmpty then\nbegin\n  AdvGridWorkbook1.ActiveSheet := 0;\n  // build grid header\n  SetupHeader;\n  // build grid detail\n  SetupDetail;\nend\nelse\nbegin\n  Memo1.Lines.Add('Returned empty data set for Mapping');\nend;\n\n// load the next dataset.  no data rows but MS Studio shows column headers\n\nADODataSet1.Recordset := ADOStoredProc1.NextRecordset(RecordsAffected);\n\nif not ADODataSet1.IsEmpty then // tests as empty\nbegin\n  AdvGridWorkbook1.ActiveSheet := 1;\n  // build grid header - none are returned as IsEmpty = True\n  SetupHeader;\n  // build grid detail\n  SetupDetail;\nend\nelse\nbegin\n// this message is added to my memo field.\n  Memo1.Lines.Add('Returned empty data set for Labor');\nend;\nADODataSet1.Close;\nADOStoredProc1.Close;\n</code></pre>\n\n<p>Does anyone know how MS got column headers to come back?</p>\n\n<p>The stored procedure is:</p>\n\n<pre><code>USE [NG_Test]\nGO\n/****** Object:  StoredProcedure [dbo].[NG_Checks]  ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nALTER PROCEDURE [dbo].[NG_Checks] \n    @fiscal_month_year nvarchar(50)\nAS\nBEGIN\n    declare @production_date datetime\n    declare @start_date datetime\n    declare @end_date datetime\n\n    select @production_date = ng_production_release_date\n    from ng_common_global_provisioning\n\n    select @start_date = start_date, @end_date = end_date\nfrom ng_common_accounting_fiscal_month\n    where fiscal_month_year = @fiscal_month_year\n\n-- this is the 1st dataset returned\n\n    select b.company, b.wo_type, b.wo_code\nfrom ng_accounting_mapping_ng_wo_2_gp b\n    where wo_code not in (select wo_code from ng_wo_codes a)\n\n--  this is the 2nd dataset returned\n    select a.wo_display_id, a.wo_code, a.labor_revenue, a.labor_cost, \n        a.create_date, a.completion_date, a.finalizing_date, a.wo_status\n    from ng_wo_header a, ng_wo_labor_rates b\n    where a.wo_code = b.work_order_code\n        and a.company = b.company\n        and a.wo_type = b.work_order_type\n        and a.wo_type in ('RO', 'BS')\n        and a.labor_revenue is not null and a.labor_revenue &lt;&gt; 0\n        and a.labor_cost is not null and a.labor_cost &lt;&gt; 0\n        and a.create_date &gt; @start_date\n        and a.create_date &lt; @end_date\n        and a.create_date &gt; @production_date\nEND \n</code></pre>\n"},{"tags":["delphi","chromium","tchromium"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":149,"score":3,"question_id":12866605,"title":"Chromium: How to get all form of a loaded page","body":"<p>I try to get the name of all forms of the loaded page. I have done this:</p>\n\n<pre><code>procedure TForm2.Button2Click(Sender: TObject);\nvar\n  L: TStringList;\nbegin\n  L := TStringList.Create;\n\n  try\n    Chromium1.Browser.MainFrame.VisitDomProc(\n      procedure (const doc: ICefDomDocument)\n        procedure IterateNodes(Node: ICefDomNode);\n        begin\n          if not Assigned(Node) then Exit;\n          repeat\n            if Node.ElementTagName = 'FORM' then\n              L.Add(Node.GetElementAttribute('name'));\n\n            if Node.HasChildren then IterateNodes(Node.FirstChild);\n\n            Node := Node.NextSibling;\n          until not Assigned(Node);\n        end;\n      begin\n        IterateNodes(doc.Body);\n      end\n    );\n\n    ShowMessage(L.Text);\n  finally\n    FreeAndNil(L);\n  end;\nend;\n</code></pre>\n\n<p>But I don't have any result. Any idea?</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","delphi-4","quantumgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12858654,"title":"Programmatically adding columns to a TdxDBGrid (Expressquantumgrid by Devexpress)","body":"<p>With a customer I'm stuck developing for this very old version (2.1) of ExpressQuantumGrid by DevExpress. In Delphi 4. I can't find any documentation about it.</p>\n\n<p>Basically I just need to create a bunch of TdxDBGridMaskColumn and \"insert\" them into the grid (TdxDBGrid) at runtime. From the code completion pop-up I can't figure out how.</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi","oop","delphi-7","delphi-xe2","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":104,"score":2,"question_id":12870126,"title":"How to declare cross referenced class types?","body":"<p>I tried to construct a class system in Delphi. The classes <code>TFieldSpec</code> and <code>TTableSpec</code> refer to each other through object properties.</p>\n\n<pre><code>type\n  TFieldSpec=class(Tobject)\n  private\n    FTableSpec : TTableSpec;\n  public\n    property TableSpec : TTableSpec read FTableSpec;\n  end;\n\n  TTableSpec=class(Tobject)\n  private\n    FFields : array[1..100] of TFieldSpec;\n  end;\n</code></pre>\n\n<p>When I compile this, I get this error:</p>\n\n<pre><code>[Error] Objects.pas(66): Undeclared identifier: 'TTableSpec'\n</code></pre>\n\n<p>How to construct these class types?</p>\n"},{"tags":["delphi","ms-word","office-automation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":172,"score":0,"question_id":11264733,"title":"Delphi - Keeping Word Document Focused","body":"<p>I have run into an interesting problem with the current application I'm working on in Delphi. The problem is that in certain circumstances the ActiveDocument of our TWordApplication can be changed before the document is completed.</p>\n\n<p>I have a TWordApplication (WordApp) and a TWordDocument (WordDoc) which are initialised as below:</p>\n\n<pre><code>WordApp.Connect;\nWordApp.Documents.Add(Template, EmptyParam, EmptyParam, EmptyParam);\nWordApp.ChangeFileOpenDirectory(jdir);\nWordDoc.ConnectTo(WordApp.ActiveDocument);\n</code></pre>\n\n<p>Mostly I then update some bookmarks or insert text from a number of templates:</p>\n\n<pre><code>Range := '';\nconvert := msoFalse;\nLinkFile := msoFalse;\nAttach := msoFalse;\nWordApp.Selection.InsertFile(Template, Range, Convert, LinkFIle, Attach);\n</code></pre>\n\n<p>In one workflow the creation of the document is interrupted by the creation of a second document. If this document is not closed after saving then it \"steals\" focus from the original. I think that it is legitimate that the user shouldn't need to remember to close down the second document.</p>\n\n<p>What I want to do is either switch the focus of <strong>WordApp</strong> to <strong>WordDoc</strong> or alternatively \nuse WordDoc directly for the InsertFile - but this doesn't seem to be an option.</p>\n\n<p>(There is a third option where I collate the required data for the second document <strong>before</strong> I create the first document, but that will require a change in application logic.)</p>\n\n<p>Any help?</p>\n"},{"tags":["delphi","qt","vcl"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":1153,"score":2,"question_id":4085461,"title":"Future Delphi with Qt","body":"<p>Will the next version of Delphi be released with cross platform support and Qt based components? If so, do we have to distribute with Qt? (I don't know anything about Qt) \nHow can Qt help the Delphi world, and why did many programmers using C++ start using Qt with, and what will happen to VCL?</p>\n"},{"tags":["arrays","delphi","delphi-7","record","array-sorting"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":178,"score":-1,"question_id":12839957,"title":"passing dynamic array of record to mergesort in Delphi","body":"<p>I have a record type and a dynamic array made up of that record type. I pass it to a mergesort routine and try to set one of it's field properties which is boolean to true but seems does not take effect. </p>\n\n<p>I looked into sorting array of record by other means(see this quicksort for customrecord array: <a href=\"http://en.wikibooks.org/wiki/Algorithm_Implementation/Sorting/Quicksort#Delphi\" rel=\"nofollow\">http://en.wikibooks.org/wiki/Algorithm_Implementation/Sorting/Quicksort#Delphi</a>) or here: <a href=\"http://stackoverflow.com/questions/41733/best-way-to-sort-an-array\">Best way to sort an array</a> (I could not get none of these suggestions to work from here mostly because of creating a comaring function).\nThis question: <a href=\"http://stackoverflow.com/questions/7492993/sorting-of-arrays-alphabetically\">Sorting of Arrays Alphabetically?</a> was helpful and works but this sorting is excruciatingly slow. </p>\n\n<p>CODE:</p>\n\n<pre><code>type    \n       TCustomRecord = Record\n        fLine     : AnsiString; //full line\n        fsubLine     : AnsiString; // part of full line\n        isDuplicate : boolean;  //is that subline duplicate in another line\n        isRefrence     : boolean; // is this line from a refrence file or the one being deduped\n        fIndex    : Cardinal; // original order line was loaded\n       end;\n      TCustomRecordArray = array of TCustomRecord; \n\nfunction Merge2(var Vals: array of TCustomRecord ):Integer;\nvar\n  AVals: array of TCustomRecord;\n\n   //returns index of the last valid element\n  function Merge(I0, I1, J0, J1: Integer):Integer;\n  var\n    i, j, k, LC:Integer;\n  begin\n    LC := I1 - I0;\n    for i := 0 to LC do\n      AVals[i]:=Vals[i + I0];\n      //copy lower half or Vals into temporary array AVals\n\n    k := I0;\n    i := 0;\n    j := J0;\n    while ((i &lt;= LC) and (j &lt;= J1)) do\n    if (AVals[i].fsubLine &lt; Vals[j].fsubLine) then\n    begin\n      Vals[k] := AVals[i];\n      if Vals[k].isRefrence = False then\n        Vals[k].isDuplicate := False;\n      inc(i);\n      inc(k);\n    end\n    else if (AVals[i].fsubLine &gt; Vals[j].fsubLine) then\n    begin\n      Vals[k]:=Vals[j];\n      if Vals[k].isRefrence = False then\n        Vals[k].isDuplicate := False;\n      inc(k);\n      inc(j);\n    end else\n    begin //duplicate\n      Vals[k] := AVals[i];\n      if Vals[k].isRefrence = False then\n        Vals[k].isDuplicate := True;\n      inc(i);\n      inc(j);\n      inc(k);\n    end;\n\n    //copy the rest\n    while i &lt;= LC do begin\n      Vals[k] := AVals[i];\n      inc(i);\n      inc(k);\n    end;\n\n    if k &lt;&gt; j then\n      while j &lt;= J1 do begin\n        Vals[k]:=Vals[j];\n        inc(k);\n        inc(j);\n      end;\n\n    Result := k - 1;\n  end;\n\n //returns index of the last valid element\n\n  function PerformMergeSort(ALo, AHi:Integer): Integer; //returns\n  var\n    AMid, I1, J1:Integer;\n  begin\n\n  //It would be wise to use Insertion Sort when (AHi - ALo) is small (about 32-100)\n    if (ALo &lt; AHi) then\n    begin\n      AMid:=(ALo + AHi) shr 1;\n      I1 := PerformMergeSort(ALo, AMid);\n      J1 := PerformMergeSort(AMid + 1, AHi);\n      Result := Merge(ALo, I1, AMid + 1, J1);\n    end else\n      Result := ALo;\n  end;\n\nbegin\n  //SetLength(AVals, Length(Vals) + 1 div 2);\n  SetLength(AVals, Length(Vals) div 2 + 1);\n  Result := 1 + PerformMergeSort(0, High(Vals));\nend;\n</code></pre>\n\n<p>QUESTION:\nHow can I sort efficiently, preferably using mergesort, this array of record and set some of it's properties according to that sort? Thank you.</p>\n\n<p>UPDATE:\nI added a pointer type and did a modified mergesort on array of pointers. This turned out to be very fast way of sorting the array of record. I added also a compare routine which added the flags I needed. The only part I am not able to do is to add a flag for duplicates based on if they belonged to file A or Reference file.</p>\n\n<p>CODE:</p>\n\n<pre><code>    type    \n          PCustomRecord = ^TCustomRecord; \n          TCustomRecord = Record\n            fLine     : AnsiString; //full line\n            fsubLine  : AnsiString; // part of full line\n            isDuplicate : boolean;  //is that subline duplicate in another line\n            isRefrence     : boolean; // line from a refrence file or the one being deduped\n            isUnique  : boolean; //flag to set if not refrence and not dupe\n            fIndex    : Cardinal; // original order line was loaded\n           end;\n          TCustomRecordArray = array of TCustomRecord;\n          PCustomRecordList = ^TCustomRecordArray;\n\n//set up actual array\n//set up pointer array to point at actual array\n//sort by mergesort first\n// then call compare function - this can be a procedure obviously\n\nfunction Compare(var PRecords: array of PCustomRecord; iLength: int64): Integer;\nvar\n  i : Integer;\nbegin\n  for i := 0 to High(PRecords) do\n  begin\n    Result := AnsiCompareStr(PRecords[i]^.fsubline, PRecords[i+1]^.fsubline);\n    if Result=0 then\n    begin\n      if (PRecords[i].isrefrence = False) then\n        PRecords[i].isduplicate := True\n      else if (PRecords[i+1].isrefrence = False) then\n        PRecords[i+1].isduplicate := True;\n    end;\n  end;\nend; \n\nprocedure MergeSort(var Vals:array of PCustomRecord;ACount:Integer);\nvar AVals:array of PCustomRecord;\n\n  procedure Merge(ALo,AMid,AHi:Integer);\n  var i,j,k,m:Integer;\n  begin\n    i:=0;\n    for j:=ALo to AMid do\n    begin\n      AVals[i]:=Vals[j];\n      inc(i);\n      //copy lower half or Vals into temporary array AVals\n    end;\n\n    i:=0;j:=AMid + 1;k:=ALo;//j could be undefined after the for loop!\n    while ((k &lt; j) and (j &lt;= AHi)) do\n    if (AVals[i].fsubline) &lt;= (Vals[j].fsubline) then\n    begin\n      Vals[k]:=AVals[i];\n      inc(i);inc(k);\n    end\n    else if (AVals[i].fsubline) &gt; (Vals[j].fsubline) then\n    begin\n      Vals[k]:=Vals[j];\n      inc(k);inc(j);\n    end;\n\n    {locate next greatest value in Vals or AVals and copy it to the\n     right position.}\n\n    for m:=k to j - 1 do\n    begin\n      Vals[m]:=AVals[i];\n      inc(i);\n    end;\n    //copy back any remaining, unsorted, elements\n  end;\n\n  procedure PerformMergeSort(ALo,AHi:Integer);\n  var AMid:Integer;\n  begin\n    if (ALo &lt; AHi) then\n    begin\n      AMid:=(ALo + AHi) shr 1;\n      PerformMergeSort(ALo,AMid);\n      PerformMergeSort(AMid + 1,AHi);\n      Merge(ALo,AMid,AHi);\n    end;\n  end;\n\nbegin\n  SetLength(AVals, ACount div 2 + 1);\n  PerformMergeSort(0,ACount - 1);\nend;\n</code></pre>\n\n<p>This is all very fast on small files taking less than one second. Deduping the items in the array that carry a duplicate flag and NOT a reference flag is quite challenging though. As mergesort is a stable sort I tried resorting by boolean flag but did not get what I expected. I used a <code>TStringlist</code> to see if my previous flags are being set up correctly and it works perfectly. The time went up from 1 second to 6 seconds. I know there has to be an easy way to mark the <code>isUnique</code> flag <strong>without</strong> <code>TStringlist</code>.</p>\n\n<p>Here is what I tried:</p>\n\n<pre><code>function DeDupe(var PRecords: array of PCustomRecord; iLength: int64): Integer;\nvar\n  i : Integer;\nbegin\n  for i := 0 to High(PRecords) do\n  begin\n    if (PRecords[i]^.isrefrence = False) and (PRecords[i+1]^.isrefrence = false)then\n    begin\n      Result := AnsiCompareStr(PRecords[i]^.isduplicate, PRecords[i+1]^.isduplicate);\n      if Result = 0 then PRecords[i]^.isUnique := True;\n    end\n    else\n    begin\n      Continue;\n    end;\n  end;\nend;\n</code></pre>\n\n<p>This doesn't get all the values and I did not see a difference with it as I still see lots of duplicates. I think the logic is wrong.</p>\n\n<p>Thanks to all the great souls helping out. To all please allow me the benefit that I may already know how to derive a <code>TObject</code> and how to use a <code>TStringList</code> so the focus is on arrays. </p>\n\n<p>QUESTION:\nHelp me do a function or procedure as above to mark the repeated items with the: \n<em>isRefrence = false and isDuplicate = True and unique</em></p>\n\n<p>EDIT 3:\nI was able to achieve the elimination of duplicates through the use of boolean flags. this helped in keeping the array stable without changing the size of the array. I believe it is much much faster than using <code>TList</code> descendant or <code>TStringList</code>. The use of a basic container such as an array has limitations in ease of coding but is very efficient so I would not pass on it. The pointers made the sorting a breeze. I'm not sure how after I set the pointers to my array when i used the pointer array exactly like I'm using my regular array. And it made no difference whether I derefrenced it or not. I set up the pointer array as such:</p>\n\n<pre><code>  iLength := Length(Custom_array); //get length of actual array\n  SetLength(pcustomRecords, iLength); // make pointer array equal + 1\n\n  for M := Low(Custom_array) to High(Custom_array) do //set up pointers\n  begin\n    pcustomRecords[M] := @Custom_array[M]; \n  end;\n</code></pre>\n\n<p>I tried seperating the sorting from the actual data being sorted as much as I can, but I'm sure there can be improvement.</p>\n\n<pre><code>///////////////////////////////////////////////////////////////////\nfunction Comparesubstring(Item1, Item2: PCustomRecord): Integer;\nbegin\n  Result := AnsiCompareStr(item1^.fsubline, item2^.fsubline);\nend;\n///////////////////////////////////////////////////////////////////\nfunction CompareLine(Item1, Item2: PCustomRecord): Integer;\nbegin\n  Result := AnsiCompareStr(item1^.fLine, item2^.fLine);\nend;\n///////////////////////////////////////////////////////////////////\nfunction Compare(var PRecords: array of PCustomRecord; iLength: int64): Integer;\nvar\n  M, i : Integer;\nbegin\n  M := Length(PRecords);\n  for i := 1 to M-1 do\n  begin\n    Result := Comparesubstring(PRecords[i-1], PRecords[i]);\n    if Result=0 then\n    begin\n      if (PRecords[i-1].isRefrence = False) then\n        PRecords[i-1].isduplicate := True\n      else if (PRecords[i].isRefrence = False) then\n        PRecords[i].isduplicate := True;\n    end;\n  end;\nend;\n///////////////////////////////////////////////////////////////////\n</code></pre>\n"},{"tags":["delphi","components","vcl"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":122,"score":0,"question_id":12856559,"title":"Delphi - unit segregation","body":"<p>My new component (TComponent) uses DsgnIntf since I use custom property editors. The problem is when using the component in a custom VCL application - DSGNINTF.DCU not found! One solution is to add a command line switch to a compiler (dont remember any more what is it), but I don't like that solution. The second solution is a unit segregation. I found this:</p>\n\n<p><a href=\"http://edn.embarcadero.com/article/27717\" rel=\"nofollow\">http://edn.embarcadero.com/article/27717</a></p>\n\n<p>The problem is - I don't understand this article so well.. I don't know what exactly I need to do in my component unit to separate design-time from runtime code. Could someone please make the simplest example and explain it? I just want to avoid problems with \"dsgnintf.dcu not found\" when people using my component. Thank you.</p>\n\n<p>EDIT: \nI looked the article a bit more and I realize the second unit registers the first one. To avoid dsgnintf.dcu problem I presume the second unit must be in it's own .pas file? </p>\n"},{"tags":["multithreading","delphi","event-handling","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":130,"score":0,"question_id":12861198,"title":"Delphi event handling without threads","body":"<p>I'm not a Delphi expert, and I have only a basic understanding of the flow of messages and the handling of events and callbacks. I'm trying to debug an application in D7 that need to combine the foreground procedure (initiated by a button click) with message reception and processing that occurs in the background (handled by a component). They both work properly independently, but when I combine them in one procedure, the message reception doesn't work. </p>\n\n<p>The existing application already has functioning procedures to send a message on a button click, and it can receive a message while running and not processing any buttons. </p>\n\n<p>The normal message reception is handled by a component, which calls my handler (OnInput) as an event. My handler puts the message in a ListBox.</p>\n\n<p>I am trying to write a procedure that sends a message, and waits for a response, in a loop. (pseudocode):</p>\n\n<pre><code>   for N := 0 to nsequence do begin\n       prevcount := ListBox1.items.count; \n       SendMessage(mymessage);  // request the response\n       sleep(500); // allow time for response to arrive\n       for 0 to timeout do begin\n           sleep(100); \n           application.processmessages;  {allow processing to handle incoming message}\n           if ListBox1.items.count &gt; prevcount then break;  {has the message arrived?}\n           end;\n       if ListBox1.items.count = prevcount then exit: {timeout -- fail}\n       end;\n</code></pre>\n\n<p>I think this should be able to be accomplished without threads, but the messages are never received. It always times out. </p>\n\n<p>Are component event handlers able to be called from application.processmessages? The input message works correctly when the application is running and idle, but does not when it is executing a procedure.  What else is required beyond a call to application.processmessages to cause the application to process messages and call the related procedures to handle them?</p>\n\n<p>To trace the incoming message, the path starts with a callback from Windows MMSystem. When the MIDI Input port is opened, the callback is set to point to a handler: procedure midiHandler</p>\n\n<p>In midiHandler, the event is put into a circular buffer: CircbufPutEvent( thisBuffer, @thisEvent). </p>\n\n<p>Then a message is posted back to the application: PostMessage(thisCtlInfo^.hWindow, mim_Data, 0, 0)</p>\n\n<p>That message is handled by: procedure TMidiInput.MidiInput( var Message: TMessage );\nWithin that procedure there is a call to: FOnMIDIInput(Self);</p>\n\n<p>These events are defined in the component's interface as:</p>\n\n<pre><code>{ Events }\nFOnMIDIInput: TNotifyEvent; { MIDI Input arrived }\n</code></pre>\n\n<p>under Published, we have:</p>\n\n<pre><code>{ Events }\nproperty OnMidiInput: TNotifyEvent read FOnMidiInput write FOnMidiInput;\nproperty OnOverflow: TNotifyEvent read FOnOverflow write FOnOverflow;\n</code></pre>\n\n<p>In the Object Inspector, the OnMidiInput event is linked to the procedure MIDIInput1MidiInput;</p>\n\n<p>The procedure MIDIInput1MidiInput first calls GetMidiEvent:</p>\n\n<pre><code>with (Sender As TMidiInput) do\n    begin\n    while (MessageCount &gt; 0) do\n        begin\n\n        { Get the event as an object }\n        thisEvent := GetMidiEvent;\n</code></pre>\n\n<p>GetMidiEvent reads the message out of the circular buffer. The MIDIInput1MidiInput procedure does some checking and validating, and ultimately stores the message in ListBox1.</p>\n\n<p>PS - the input component has a property that returns the count of queued messages in the circular buffer. I check it when the waiting loop times out, and it reports 0 messages. So the callback is apparently not getting to the midiHandler procedure.</p>\n"},{"tags":["delphi","delphi-7","tchromium"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":131,"score":0,"question_id":12865242,"title":"How to iterate DOM nodes in Delphi Chromium Embedded without use of anonymous method?","body":"<p><a href=\"http://stackoverflow.com/questions/5960721/delphi-embedded-chrome\">Delphi Embedded Chrome</a></p>\n\n<p>Due to my limited skill, I cannot figure out how to do the same thing in Delphi 7, as it doesn't support an anonymous method!</p>\n"},{"tags":["ruby","delphi","delphi-xe2","delphi64"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":159,"score":-1,"question_id":12850738,"title":"Execute Ruby in Delphi XE2/64","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1591523/run-a-ruby-script-from-delphi-via-shellexecute\">run a ruby script from delphi via shellexecute</a>  </p>\n</blockquote>\n\n\n\n<p>Is this possible? What i mean is somekind of interpreter to execute and maybe set/read variables from the Ruby engine in DelphiXE2/64.</p>\n\n<p>Thanks</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Is there an updated version of this library?</p>\n"},{"tags":["osx","delphi","delphi-xe2","c++builder","firemonkey"],"answer_count":0,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":224,"score":8,"question_id":12769064,"title":"How to create \"No Activate\" form in Firemonkey","body":"<p>In XCode by adding these methods to your NSView subclass can prevent the window from becoming active when clicking on it:</p>\n\n<pre><code>- (BOOL)shouldDelayWindowOrderingForEvent:(NSEvent )theEvent {\n        return YES;\n}\n- (BOOL)acceptsFirstMouse:(NSEvent )theEvent {\n       return YES; \n}\n- (void)mouseDown:(NSEvent )theEvent {\n       [[[NSApp]] preventWindowOrdering]; \n}\n</code></pre>\n\n<p>In Windows platform It is done by this simple code:</p>\n\n<pre><code>SetWindowLong(hWnd, GWL_EXSTYLE,\n        GetWindowLong(hWnd, GWL_EXSTYLE) | WS_EX_NOACTIVATE);\n</code></pre>\n\n<p>How can I subclass NSView to prevent my FMX TForm becoming active when clicking on it?</p>\n\n<p>How can I create \"<strong>No Activate</strong>\" form in firemonkey?</p>\n\n<p>Thanks.</p>\n"},{"tags":["xml","delphi","root","delphi-2007","txmldocument"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":103,"score":2,"question_id":12859259,"title":"Delphi: EInvalidPointer when trying to access XMLDocument","body":"<p>The following code throws an \"InvalidPointer\" exception everytime I try to access the document's root with <code>XMLDocument.DocumentElement;</code>.</p>\n\n<pre><code>    begin\n      XMLDocument := TXMLDocument.Create(nil); // nil since we don't need an owner\n      AStream := TStream.Create;  // stream for output as string\n      XMLDocument.loadFromXML(xml);// load string\n      if NOT (XMLDocument.IsEmptyDoc) then\n       begin      \n        XMLDocument.Active := true; // actually automatically done by 'loadFromXML'\n\n        // get document root\n        HeadNode := XMLDocument.DocumentElement;\n\n        // add &lt;id&gt;-element, set ID as text\n        idNode := HeadNode.AddChild(XML_ID_PLAIN);\n        idNode.Text := id;\n\n        // ...\n     end;\n    end;\n</code></pre>\n\n<p>The string \"xml\" passed to <code>loadFromXML(string)</code> is valid XML, but the XMLDocument's properties \"XML\" and \"DOMDocument\" are always <code>nil</code>, even though neither the object itself nor its \"IsEmptyDoc\" properties are. Delphi Version is still 2007.</p>\n\n<p>Has anyone an idea what causes this? Thanks in advance.</p>\n"},{"tags":["delphi","windows-services","delphi-xe"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":279,"score":3,"question_id":9377444,"title":"How to control my Win32 service meaning change it's custom parameters, scheduling etc?","body":"<p>I need to develop a Win32 service in Delphi XE and I need to find a way how to control it from the same machine (or eventually other machines in the LAN if possible). By controlling it I mean changing it's internal parameters implemented by me, not Windows service parameters. The service itself should not interact with the desktop. Could you please advise the best way how to do it? </p>\n"},{"tags":["delphi","record"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":160,"score":2,"question_id":12861268,"title":"How to free an object which is in a record?","body":"<p>Here I have a tricky situation, I guess. I need to be able to free an object which is a field of a record. I would normally write the cleanup code in the destructor, if it was a class. But since record types can't introduce a \"destructor\", how would it be possible to call <strong>TObject(Field).Free;</strong> ?</p>\n\n<p>There'll be two types of usage I predict:</p>\n\n<ol>\n<li><p>Replacing the record with a new one.</p>\n\n<p>I think this usage would be easy to implement. Since records are value types and so they are copied on assignment, I can overload the assigning operator and free the objects owned by old record.</p>\n\n<p>( <strong>Edit:</strong> Assignment overloading wasn't able. That's a new info to me.. )</p></li>\n<li><p>Exiting the scope where record variable defined.</p>\n\n<p>I can think of a private method that frees the objects and this method could be called on scope excitation manually. BUT, here is the same question: How to make it more <strong>recordly</strong>? This behaviour kind of feels like a class...</p></li>\n</ol>\n\n<p>Here is a sample (and obviously <strong>not the intended usage</strong>):</p>\n\n<pre><code>TProperties = record\n  ... some other spesific typed fields: Integers, pointers etc..\n  FBaseData: Pointer;\n\n  FAdditionalData: TList&lt;Pointer&gt;;\n  //FAdditionalData: array of Pointer; this was the first intended definition\nend;\n</code></pre>\n\n<p>Assume,</p>\n\n<pre><code>FAdditionalData:=TList&lt;Pointer&gt;.Crete;\n</code></pre>\n\n<p>called in record constructor or manually in record variable scope by accessing the field publicly like</p>\n\n<pre><code>procedure TFormX.ButtonXClick(Sender: TObject);\nvar\n  rec: TProperties;\nbegin\n  //rec:=TProperties.Create(with some parameters);\n\n  rec.FAdditionalData:=TList&lt;Pointer&gt;.Create;\n\n  //do some work with rec\nend;\n</code></pre>\n\n<p>After exiting the ButtonClick scope the <strong>rec</strong> is no more but a <strong>TList</strong> still keeps its existance which causes to memory leaks...</p>\n"},{"tags":["php","delphi","zend-framework","php4delphi"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":125,"score":-1,"question_id":12844875,"title":"php4delphi 64 bit","body":"<p>I tried compiling the php4delphi / php5delphi in XE 2 and it shows errors.\nOriginal author says that 64 bits isn't the official build so that's why he won't support which is pretty sad.</p>\n\n<p><strong>Is there a 64 bit library for this?</strong></p>\n\n<p><a href=\"http://code.google.com/p/php5delphi/\" rel=\"nofollow\">http://code.google.com/p/php5delphi/</a></p>\n\n<p><strong>EDIT:</strong>\nI am trying to execute PHP inside Delphi. It works with 32 bits but not with 64 bit. </p>\n"},{"tags":["sql","arrays","delphi","parameter-passing","tadoquery"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":124,"score":1,"question_id":12859430,"title":"Array parameter for TADOQuery in Delphi 2010","body":"<p>I need to execute a simple query:</p>\n\n<p><code>SELECT * FROM MyTable WHERE Id IN (:ids)</code></p>\n\n<p>Obviously, it returns the set of records which have their primary key 'Id' in the given list. How can I pass an array of integer IDs into ADOQuery.Parameters for parameter 'ids'? I have tried VarArray - it does not work. Parameter 'ids' has FieldType = ftInteger by default, if it matters.</p>\n"},{"tags":["delphi","ping","indy10"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":152,"score":1,"question_id":12723081,"title":"Delphi Indy Ping Error 10040","body":"<p>I have a small piece of code that checks if a computer is alive by pinging it. We use to have a room with 40 computer and I wanna check remotely through my program which on is alive.</p>\n\n<p>Therefore I wrote a little ping function using indy</p>\n\n<pre><code>function TMainForm.Ping(const AHost : string) : Boolean;\nvar\n  MyIdIcmpClient : TIdIcmpClient;\nbegin\n  Result := True;\n\n  MyIdIcmpClient := TIdIcmpClient.Create(nil);\n  MyIdIcmpClient.ReceiveTimeout := 200;\n  MyIdIcmpClient.Host := AHost;\n\n  try\n    MyIdIcmpClient.Ping;\n    Application.ProcessMessages;\n  except\n    Result := False;\n    MyIdIcmpClient.Free;\n    Exit;\n  end;\n  if MyIdIcmpClient.ReplyStatus.ReplyStatusType &lt;&gt; rsEcho Then result := False;\n\n  MyIdIcmpClient.Free;\nend;\n</code></pre>\n\n<p>So I've developped that at home on my wiki network and everthing just work fine.</p>\n\n<p>When I get back to work I tested and I get an error saying</p>\n\n<pre><code>Socket Errod # 10040 Message too long\n</code></pre>\n\n<p>At work we have fixed IPs and all the computer and I are in the same subnet.</p>\n\n<p>I tried to disconnect from the fixed IP and connect to the wifi which of course is DHCP and not in the same subnet, and it is just working fine.</p>\n\n<p>I have tried searching the internet for this error and how to solve it but didn't find much info.</p>\n\n<p>Of course I have tried to change the default buffer size to a larger value but it didn't change anything I still get the error on the fixed IP within same subnet.</p>\n\n<p><strong>Moreover, I don't know if this can help finding a solution, but my code treats exceptions, but in that case it takes about 3-4 seconds to raise the error whereas the Timeout is set to 200 milliseconds. And I cannot wait that long over each ping.</strong></p>\n\n<p>By the way I use delphi 2010 and I think it is indy 10. I also have tested on XE2 but same error.</p>\n\n<p>Any idea</p>\n\n<p><strong>----- EDIT -----</strong></p>\n\n<p><strong>This question is answered, now I try to have this running in multithread and I have asked another question for that</strong>\n<a href=\"http://stackoverflow.com/questions/12858551/delphi-xe2-indy-10-mutlithread-ping\">Delphi (XE2) Indy (10) Mutlithread Ping</a></p>\n"},{"tags":["delphi","tdbgrid"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":125,"score":0,"question_id":12857151,"title":"Tweaking a TDbGrid","body":"<p>I am taking my first stumbling steps into DB aware controls (any good tutorials?).</p>\n\n<p>I have a MySql table with 6 columns and have managed to load it into a TDbGrid.</p>\n\n<p>One of the columns however is an index into another table. It is a bar code and, rather than display that, I would like to display the product name associated with it.</p>\n\n<p>How do I do that?</p>\n\n<p>(and can I hide the \"gutter\" (?) down the left whcih shows the current row?)</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","error-handling","dbexpress","interbase"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12853868,"title":"How can I get the Winsock error code for a dbExpress connect error?","body":"<p>In case of a connection problem, the dbExpress driver throws a TDBXError but does not include a socket error code. The message is simply:</p>\n\n<blockquote>\n  <p>Unable to complete network request to host \"exampledb.local\".\n  Failed to establish a connection</p>\n</blockquote>\n\n<p>Is there a way to retrieve the underlying socket error when this type of exception occurs?</p>\n\n<p>The stack trace is:</p>\n\n<pre><code>main thread ($5934):\n0061aa59 +051 example.exe DBXCommon    447  +0 TDBXContext.Error\n00817f14 +10c example.exe DBXDynalink  796 +21 TDBXMethodTable.RaiseError\n00818553 +013 example.exe DBXDynalink  949  +1 TDBXDynalinkConnection.CheckResult\n00818744 +050 example.exe DBXDynalink 1048  +4 TDBXDynalinkConnection.DerivedOpen\n0061750f +007 example.exe DBXCommon    447  +0 TDBXConnection.Open\n00612fed +0f5 example.exe DBXCommon    447  +0 TDBXConnectionFactory.GetConnection\n00612ef1 +005 example.exe DBXCommon    447  +0 TDBXConnectionFactory.GetConnection\n0062c08f +26f example.exe SqlExpr              TSQLConnection.DoConnect\n005d9019 +039 example.exe DB                   TCustomConnection.SetConnected\n005d8fd4 +004 example.exe DB                   TCustomConnection.Open\n0062b98f +01b example.exe SqlExpr              TSQLConnection.CheckConnection\n0062ebdf +01f example.exe SqlExpr              TCustomSQLDataSet.CheckConnection\n0062efe4 +04c example.exe SqlExpr              TCustomSQLDataSet.OpenCursor\n005e91d5 +055 example.exe DB                   TDataSet.SetActive\n005e901c +004 example.exe DB                   TDataSet.Open\n</code></pre>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":2,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":218,"score":5,"question_id":12842206,"title":"How do I create an alpha blended panel?","body":"<p>I'm trying to display a truly alpha blended TPanel in Delphi XE2. I've found quite a few attempts online, but none of them work correctly.</p>\n\n<p>What I'm trying to achieve is a 'semi modal' form. A form that is displayed over the top of other controls with a faded background in a similar manner to that seen in web browsers.</p>\n\n<p><img src=\"http://i.stack.imgur.com/DiHn7.png\" alt=\"enter image description here\"></p>\n\n<p>I've got it working in a basic form, but it suffers from the following problems:</p>\n\n<ul>\n<li>A large amount of flicker when resizing the panel.</li>\n<li>If a control is moved over the top of the panel it leaves a trail.</li>\n</ul>\n\n<p>Here's my efforts thus far (based on some code I found <a href=\"http://delphi-kb.blogspot.no/2011/06/how-to-create-transparent-tpanel_1516.html\">here</a>).</p>\n\n<pre><code>unit SemiModalFormU;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs, ExtCtrls;\n\ntype\n  ISemiModalResultHandler = interface\n    ['{0CC5A5D0-1545-4257-A936-AD777E0DAFCF}']\n    procedure SemiModalFormClosed(Form: TForm);\n  end;\n\n  TTransparentPanel = class(TCustomPanel)\n  private\n    FBackground: TBitmap;\n    FBlendColor: TColor;\n    FBlendAlpha: Byte;\n\n    procedure ColorBlend(const ACanvas: TCanvas; const ARect: TRect; const ABlendColor: TColor; const ABlendValue: Byte);\n    procedure SetBlendAlpha(const Value: Byte);\n    procedure SetBlendColor(const Value: TColor);\n  protected\n    procedure CaptureBackground;\n    procedure Paint; override;\n\n    procedure WMEraseBkGnd(var msg: TWMEraseBkGnd); message WM_ERASEBKGND;\n    procedure WMMove(var Message: TMessage); message WM_MOVE;\n    procedure WMParentNotify(var Message: TWMParentNotify); message WM_PARENTNOTIFY;\n  public\n    constructor Create(aOwner: TComponent); override;\n    destructor Destroy; override;\n\n    procedure ClearBackground;\n\n    procedure SetBounds(ALeft, ATop, AWidth, AHeight: Integer); override;\n  published\n    property BlendColor: TColor read FBlendColor write SetBlendColor;\n    property BlendAlpha: Byte read FBlendAlpha write SetBlendAlpha;\n\n    property Align;\n    property Alignment;\n    property Anchors;\n  end;\n\n  TSemiModalForm = class(TComponent)\n  strict private\n    FFormParent: TWinControl;\n    FBlendColor: TColor;\n    FBlendAlpha: Byte;\n    FSemiModalResultHandler: ISemiModalResultHandler;\n    FForm: TForm;\n    FTransparentPanel: TTransparentPanel;\n    FOldFormOnClose: TCloseEvent;\n  private\n    procedure OnTransparentPanelResize(Sender: TObject);\n    procedure RepositionForm;\n    procedure SetFormParent(const Value: TWinControl);\n    procedure OnFormClose(Sender: TObject; var Action: TCloseAction);\n  protected\n    procedure Notification(AComponent: TComponent; Operation: TOperation); override;\n  public\n    procedure ShowSemiModalForm(AForm: TForm; SemiModalResultHandler: ISemiModalResultHandler); virtual;\n\n    property ModalPanel: TTransparentPanel read FTransparentPanel;\n  published\n    constructor Create(AOwner: TComponent); override;\n\n    property BlendColor: TColor read FBlendColor write FBlendColor;\n    property BlendAlpha: Byte read FBlendAlpha write FBlendAlpha;\n    property FormParent: TWinControl read FFormParent write SetFormParent;\n  end;\n\nimplementation\n\nprocedure TTransparentPanel.CaptureBackground;\nvar\n  canvas: TCanvas;\n  dc: HDC;\n  sourcerect: TRect;\nbegin\n  FBackground := TBitmap.Create;\n\n  with Fbackground do\n  begin\n    width := clientwidth;\n    height := clientheight;\n  end;\n\n  sourcerect.TopLeft := ClientToScreen(clientrect.TopLeft);\n  sourcerect.BottomRight := ClientToScreen(clientrect.BottomRight);\n\n  dc := CreateDC('DISPLAY', nil, nil, nil);\n  try\n    canvas := TCanvas.Create;\n    try\n      canvas.handle := dc;\n      Fbackground.Canvas.CopyRect(clientrect, canvas, sourcerect);\n    finally\n      canvas.handle := 0;\n      canvas.free;\n    end;\n  finally\n    DeleteDC(dc);\n  end;\nend;\n\nconstructor TTransparentPanel.Create(aOwner: TComponent);\nbegin\n  inherited;\n\n  ControlStyle := controlStyle - [csSetCaption];\n\n  FBlendColor := clWhite;\n  FBlendAlpha := 200;\nend;\n\ndestructor TTransparentPanel.Destroy;\nbegin\n  FreeAndNil(FBackground);\n\n  inherited;\nend;\n\nprocedure TTransparentPanel.Paint;\nbegin\n  if csDesigning in ComponentState then\n    inherited\nend;\n\nprocedure TTransparentPanel.SetBounds(ALeft, ATop, AWidth, AHeight: Integer);\nbegin\n  if (Visible) and\n     (HandleAllocated) and\n     (not (csDesigning in ComponentState)) then\n  begin\n    FreeAndNil(Fbackground);\n\n    Hide;\n\n    inherited;\n\n    Parent.Update;\n\n    Show;\n  end\n  else\n    inherited;\nend;\n\nprocedure TTransparentPanel.WMEraseBkGnd(var msg: TWMEraseBkGnd);\nvar\n  ACanvas: TCanvas;\nbegin\n  if csDesigning in ComponentState then\n    inherited\n  else\n  begin\n    if not Assigned(FBackground) then\n      Capturebackground;\n\n    ACanvas := TCanvas.create;\n    try\n      ACanvas.handle := msg.DC;\n      ACanvas.draw(0, 0, FBackground);\n      ColorBlend(ACanvas, Rect(0, 0, Width, Height), FBlendColor, FBlendAlpha);\n    finally\n      FreeAndNil(ACanvas);\n    end;\n\n    msg.result := 1;\n  end;\nend;\n\nprocedure TTransparentPanel.WMMove(var Message: TMessage);\nbegin\n CaptureBackground;\nend;\n\nprocedure TTransparentPanel.WMParentNotify(var Message: TWMParentNotify);\nbegin\n  CaptureBackground;\nend;\n\nprocedure TTransparentPanel.ClearBackground;\nbegin\n  FreeAndNil(FBackground);\nend;\n\nprocedure TTransparentPanel.ColorBlend(const ACanvas: TCanvas; const ARect: TRect;\n  const ABlendColor: TColor; const ABlendValue: Byte);\nvar\n  BMP: TBitmap;\nbegin\n  BMP := TBitmap.Create;\n  try\n    BMP.Canvas.Brush.Color := ABlendColor;\n    BMP.Width := ARect.Right - ARect.Left;\n    BMP.Height := ARect.Bottom - ARect.Top;\n    BMP.Canvas.FillRect(Rect(0,0,BMP.Width, BMP.Height));\n\n    ACanvas.Draw(ARect.Left, ARect.Top, BMP, ABlendValue);\n  finally\n    FreeAndNil(BMP);\n  end;\nend;\n\nprocedure TTransparentPanel.SetBlendAlpha(const Value: Byte);\nbegin\n  FBlendAlpha := Value;\n\n  Paint;\nend;\n\nprocedure TTransparentPanel.SetBlendColor(const Value: TColor);\nbegin\n  FBlendColor := Value;\n\n  Paint;\nend;\n\n{ TSemiModalForm }\n\nconstructor TSemiModalForm.Create(AOwner: TComponent);\nbegin\n  inherited;\n\n  FBlendColor := clWhite;\n  FBlendAlpha := 150;\n\n  FTransparentPanel := TTransparentPanel.Create(Self);\nend;\n\nprocedure TSemiModalForm.SetFormParent(const Value: TWinControl);\nbegin\n  FFormParent := Value;\nend;\n\nprocedure TSemiModalForm.ShowSemiModalForm(AForm: TForm;\n  SemiModalResultHandler: ISemiModalResultHandler);\nbegin\n  if FForm = nil then\n  begin\n    FForm := AForm;\n    FSemiModalResultHandler := SemiModalResultHandler;\n\n    FTransparentPanel.Align := alClient;\n    FTransparentPanel.BringToFront;\n    FTransparentPanel.Parent := FFormParent;\n    FTransparentPanel.BlendColor := FBlendColor;\n    FTransparentPanel.BlendAlpha := FBlendAlpha;\n\n    FTransparentPanel.OnResize := OnTransparentPanelResize;\n\n    AForm.Parent := FTransparentPanel;\n    FOldFormOnClose := AForm.OnClose;\n    AForm.OnClose := OnFormClose;\n\n    RepositionForm;\n\n    AForm.Show;\n\n    FTransparentPanel.ClearBackground;\n    FTransparentPanel.Visible := TRUE;\n  end;\nend;\n\nprocedure TSemiModalForm.OnFormClose(Sender: TObject; var Action: TCloseAction);\nbegin\n  FForm.OnClose := FOldFormOnClose;\n\n  try\n    FForm.Visible := FALSE;\n\n    FSemiModalResultHandler.SemiModalFormClosed(FForm);\n  finally\n    FForm.Parent := nil;\n    FForm := nil;\n\n    FTransparentPanel.Visible := FALSE;\n  end;\nend;\n\nprocedure TSemiModalForm.Notification(AComponent: TComponent;\n  Operation: TOperation);\nbegin\n  inherited Notification(AComponent, Operation);\n\n  if (Operation = opRemove) then\n  begin\n    if AComponent = FFormParent then\n      SetFormParent(nil);\n  end;\nend;\n\nprocedure TSemiModalForm.OnTransparentPanelResize(Sender: TObject);\nbegin\n  RepositionForm;\nend;\n\nprocedure TSemiModalForm.RepositionForm;\nbegin\n  FForm.Left := (FTransparentPanel.Width div 2) - (FForm.Width div 2);\n  FForm.Top := (FTransparentPanel.Height div 2) - (FForm.Height div 2);\nend;\n\nend.\n</code></pre>\n\n<p>Can anybody help me with the problems or point me to an alpha blend panel that already exists?</p>\n"},{"tags":["delphi","feedback","delphi-xe2","firemonkey"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":1295,"score":6,"question_id":7427196,"title":"With Firemonkey, how to give feedback to the user ? (crHourglass)","body":"<p>Usually, when I have a task which takes some time, I use a script like this:</p>\n\n<pre><code>procedure Work;\nvar\n  cPrevious: TCursor;\nbegin\n  cPrevious     := Screen.Cursor;\n  Screen.Cursor := crHourGlass;\n\n  try    \n  // the task\n\n  finally    \n    Screen.Cursor := cPrevious;\n  end;\nend;\n</code></pre>\n\n<p>With FireMonkey, <em>Screen</em> doesn't have a property: <em>Cursor</em>.</p>\n\n<p>What is the best way to give some feedback to the user?</p>\n\n<hr>\n\n<hr>\n\n<p>I followed the comments and the answer... with a <em>TPanel</em> which has less opacity, and a <em>TAniIndicator</em> (I also blur the other components):</p>\n\n<p><img src=\"http://i.stack.imgur.com/cCxfI.jpg\" alt=\"Feedback\"></p>\n\n<p>Thank you!</p>\n"},{"tags":["delphi","printing","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":12853986,"title":"Creating a virtual printer as an interface for a document management system","body":"<p>I would like to know if the following idea is possible/makes sense?</p>\n\n<p>Create a virtual printer (like \"PDF Printer\" that any application with printing capabilities can see in the printers list) that doesn't print to paper or file, but simply inserts the document \"being printed\" in the document management system (DMS) I developed. Imagine from MSWord i choose \"MyPrinter\" and on \"print\" my custom forms appear and let the user choose where to save the doc file inside my DMS, letting the user set some parameters (related to my DMS).</p>\n\n<p>So after these \"forms\" I have all the data needed to insert the file in the DMS.</p>\n\n<p>I am aware this is somehow \"in the tricks domain\" but it is the only choice to integrate my app with some legacy software (with printing capability) that cannot be repalced.</p>\n\n<p>I'd like to have a comment on this.</p>\n"},{"tags":["delphi","fastreport"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":12719056,"title":"Lock/edit Word / RTF documents generated by FastReport","body":"<p>I am generating forms for users to fill. I am using FastReport to generate RTF files.</p>\n\n<p>Is there any way to restrict user changes in the RTF file to specific areas ?\nI can do that in Word, but if it can be done in fastReport as it generates the files all the better.</p>\n\n<h2>UPDATE:</h2>\n\n<p>I want to know if it can be automatically done with fastreport as it generates the RTF file.</p>\n"},{"tags":["delphi","delphi-xe2","tmemo"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":137,"score":0,"question_id":12855130,"title":"Advanced TMemo functionality","body":"<p>Good day,\nTell me, is it possible to implement a component TMemo following functionality:</p>\n\n<ol>\n<li>Entering text in TMemo, begin the search for the first character you type;</li>\n<li>If a match is found, we conclude that the choice in a list whose elements are displayed as links, then click on the found text that stands out in TMemo.</li>\n<li>Click on the link right - go to the found text similar to item 2</li>\n</ol>\n\n<p>Whether it is possible to implement a standard TMemo, or to look for a component?\nthanks</p>\n"},{"tags":["c#","delphi","process","pipe"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":145,"score":2,"question_id":12852446,"title":"Pipes between C# and Delphi, How to make it work?","body":"<p>I have a console application (Host.exe) that is written in Delphi. It accepts stdin readln and responses to stdout by writeln.\nNow, I want to use Host.exe in C# application in a way that C# gives input to Host.exe and gets the output from Host.exe\nIdeally, I write the code below but it doesn't work: it hangs somewhere in the outputReader.ReadLine();</p>\n\n<pre><code>System.IO.File.WriteAllText(tmp, vbs);\n\nProcess pProcess = new Process();\n\npProcess.StartInfo.WindowStyle = ProcessWindowStyle.Normal;\n\n//strCommand is path and file name of command to run\npProcess.StartInfo.FileName = @\"Host.exe\";\npProcess.StartInfo.Arguments = \"\\\"runa \" + tmp +\"\\\"\";\n// runs script file tmp in background\npProcess.StartInfo.CreateNoWindow = true;\npProcess.StartInfo.UseShellExecute = false;\npProcess.StartInfo.RedirectStandardOutput = true;\npProcess.StartInfo.RedirectStandardInput = true;\npProcess.StartInfo.RedirectStandardError = true;\n\npProcess.Start();\n\nStreamWriter inputWriter = pProcess.StandardInput;\nStreamReader outputReader = pProcess.StandardOutput;\n\nwhile (true)\n{\n    inputWriter.WriteLine(\"getmsg\");\n    inputWriter.Flush();\n    string s = outputReader.ReadLine(); // then do something with it\n\n    inputWriter.WriteLine(\"progressglobal\");\n    inputWriter.Flush();\n\n    string p = outputReader.ReadLine();\n    if (p == \"100\")\n    {\n        break;\n    }\n    Application.DoEvents();\n    Thread.Sleep(1000);\n}\ninputWriter.WriteLine(\"exit\");\ninputWriter.Flush();                    \npProcess.WaitForExit();\n</code></pre>\n\n<p>Many thanks for any suggestions in advance !</p>\n"},{"tags":["delphi","audio","delphi-xe2","microphone"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12853832,"title":"Playing an audio file through the microphone channel","body":"<p>I would like to be able to switch between microphone (human) input and audio file thorugh the microphone input.</p>\n\n<p>The reason for this is that the application I need to develop will be used while another conference app (that uses the microphone as unique input) is running, so I would like to let the user switch from microphone (speaking) to a \"background melody\", but i need that this audio file \"passes through the microphone mixer channel\". (the non virtual counterpart of this is simply: leaving the microphone on while not speaking and turning on the radio so that it plays thorugh the microphone)</p>\n\n<p>I need to do this in Delphi but it is not clear what to do, not only which code to use, did anyone try for something similar?</p>\n"},{"tags":["delphi","rtti"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1320,"score":2,"question_id":168438,"title":"RTTI in Delphi","body":"<p>I'm trying to parse objects to XML in Delphy, so I read about calling the objet's ClassInfo method to get its RTTI info.</p>\n\n<p>The thing is, this apparently only works for TPersistent objects. Otherwise, I have to specifically add a compiler directive {$M+} to the source code for the compiler to generate RTTI info.</p>\n\n<p>So I happily added the directive, only to find that, even if it did return something from the ClassInfo call (it used to return nil), now I cannot retrieve the class' properties, fields or methods from it. It's like it created the object empty.</p>\n\n<p>Any idea what am I missing here? Thanks!</p>\n"},{"tags":["windows","delphi","winapi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12835135,"title":"[delphi]How can I detect whether a folder is in use or not?","body":"<p>I write two thread in one project.</p>\n\n<p>Thread1 is used in coping all files and child folders in folder1 to folder2.</p>\n\n<p>Both of folder1 and folder2, folder3 are from input.</p>\n\n<p>Thread2 is used in checking whether folder2 has any file or child folder, if true ,Move them to folder3(Copy them to folder3, then remove them from folder2). </p>\n\n<p>There has a problem.</p>\n\n<p>Example1</p>\n\n<p>folder1 'C:\\Test\\1'</p>\n\n<p>folder1's children</p>\n\n<p>C:\\Test\\1</p>\n\n<p>C:\\Test\\1\\L.tex</p>\n\n<p>C:\\Test\\1\\sdf.txt</p>\n\n<p>C:\\Test\\1\\2031   &lt;--- it's folder</p>\n\n<p>folder2 'D:\\Sdf\\555'</p>\n\n<p>folder3 'D:\\Sdf\\492pS1'</p>\n\n<p><strong>project running...</strong></p>\n\n<p>Thread1 create D:\\Sdf\\555\\1</p>\n\n<p>Thread2 move D:\\Sdf\\555\\1 to D:\\Sdf\\492pS1\\1</p>\n\n<p>Thread1 create D:\\Sdf\\555\\1\\2031(D:\\Sdf\\555\\1 is removed)</p>\n\n<p><strong>error...</strong> </p>\n\n<p>How can I detect whether a folder is in use or not?</p>\n"},{"tags":["delphi","menu","main"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":99,"score":4,"question_id":12850176,"title":"Submenu wrong position in Delphi application","body":"<p>My application is written in delphi. For some reason the main menu does not behave anymore like it did until yesterday (I probably touched some property without knowing). Now when I click on a menu item with sub-items, though the arrow is located to the right, the submenu keeps opening to the left.</p>\n\n<p><img src=\"http://i.stack.imgur.com/kzJVE.jpg\" alt=\"enter image description here\"></p>\n\n<p>What is the reason and how do I restore it back?</p>\n"},{"tags":["perl","delphi"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":651,"score":1,"question_id":1418963,"title":"How do I add Perl scripting support to a Delphi application?","body":"<p><a href=\"http://search.cpan.org/~gmpassos/PLDelphi-0.02/PLDelphi.pm\" rel=\"nofollow\">PLDelphi is a Perl project hosted on CPAN</a>. I am currently working on a Delphi application and I am investigating the possibility of adding Perl scripting support and read about PLDelphi.</p>\n\n<p>Ideally, I'd like my application to not require Perl to be installed. PLDelphi claims to support this:</p>\n\n<blockquote>\n  <p>To use PLDelphi from your Delphi\n  application without need to install\n  Perl you will need this files in the\n  main diretory of your application:</p>\n  \n  <p>PLDelphi.dll     - The PLDelphi\n  library that loads the Perl\n  interpreter. PLDelphi.pm      - Perl\n  side of PLDelphi. Perl56.dll       -\n  The Perl library in case that you have\n  Perl built dynamic. PLDelphi_dll.pas -\n  PLDelphi classes and DLL wrapper.\n  lib/* - A Perl lib directory with basic .pm files (strict, warnings, etc...)</p>\n</blockquote>\n\n<p>I am aware of <a href=\"http://www.remobjects.com/ps.aspx\" rel=\"nofollow\">RemObjects PascalScript</a> and <a href=\"http://mmm-experts.com/products.aspx?productid=3\" rel=\"nofollow\">embedding Python in Delphi</a>, but in this instance, I am interested primarily in Perl support.</p>\n\n<p>Has anyone used PLDelphi with success? Or have you found other ways to execute Perl scripts from Delphi without the full Perl installation available locally?</p>\n\n<p>EDIT:\nTo be more clear, I found 1 potential solution and that is using PLDelphi. However, I'd like to know if anyone has used it (last updated in 2004) before, and how well it worked.</p>\n\n<p>I'm also interested in hearing about any other options for embedding a Perl interpreter with Delphi.</p>\n"},{"tags":["delphi","winapi","image-processing","gdi+","delphi-6"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":284,"score":1,"question_id":11344504,"title":"Replacing StretchDIBits with GDI+ (while drawing an Image to Printer's canvas)","body":"<p>My application is developed in Delphi 6. This is a resource intesive application due to background processing and large volume of data (It consumes around 60MB - 120MB of physical memory). One of the functionality of this application is to create barcode images and print them.  If user keeps on generating the Barcodes, then at least One out of Ten Barcode has missing lines in it.</p>\n\n<p>I was able to resolve this issue using TExcellenImagePrinter component. But, it diminished the performance a lot. This resolution was rejected by my client and hence, now I am trying to replace the WinAPI StretchDIBits call with GDI+.</p>\n\n<p>The original source code is as following:</p>\n\n<pre><code>procedure PrintBitmap(ARect:TRect; Bitmap:TBitmap);\nvar\n   Info: PBitmapInfo;\n   InfoSize: dword{Integer};\n   Image: Pointer;\n   ImageSize: dword{ integer};\n   iWidth,iHeight :integer;\n   iReturn : integer ;\nbegin\n   GetDIBSizes(Bitmap.handle,InfoSize,ImageSize);\n   if (LoadDIBFromTBitmap(Bitmap,Pointer(Info),Image,iWidth,iHeight)) then\n   begin\n        SetStretchBltMode(Printer.Canvas.handle,STRETCH_HALFTONE);\n        SetBrushOrgEx(Printer.Canvas.handle, 0, 0, NIL);\n        iReturn := StretchDIBits(Printer.Canvas.Handle, ARect.Left, ARect.Top,\n            ARect.Right - ARect.Left, ARect.Bottom - ARect.Top,\n            0, 0, Info^.bmiHeader.biWidth,\n            Info^.bmiHeader.biHeight, Image, Info^,DIB_RGB_COLORS, SRCCOPY);\n   end;\n   FreeMemEx(Info);\n   FreeMemEx(Image);\nend;\n</code></pre>\n\n<p>I got the GDI+ header from the (<a href=\"http://www.progdigy.com/?page_id=7\" rel=\"nofollow\">http://www.progdigy.com/?page_id=7</a>) as suggested by Joe in embarcadero forums (<a href=\"https://forums.embarcadero.com/thread.jspa?messageID=471501#471501\" rel=\"nofollow\">https://forums.embarcadero.com/thread.jspa?messageID=471501#471501</a>).</p>\n\n<p>I have modified my source code as following :</p>\n\n<ul>\n<li><p>Created an object of TGPGraphics class and assigned the printer's handle to it. </p>\n\n<p>gp := TGPGraphics.Create(Printer.Canvas.Handle);</p></li>\n<li><p>Created an onject of TGPBitmap class and assigned the barcode image to it. </p>\n\n<p>bmp := TGPBitmap.Create(Info^,Image); </p>\n\n<p>Info is TBitmapInfo and Image is an pointer.</p></li>\n<li>Assigned the Printer's dimension to the an instance <strong>rect</strong> of TGPRect record</li>\n<li><p>Called the DrawImage function : </p>\n\n<p>gp.DrawImage(bmp,rect);</p></li>\n</ul>\n\n<p>But, after making these changes, empty image is shown in the printer's output.\nCan you point out if I have missed something or my implementation is wrong.\nCan you provide any pointers regarding this?</p>\n"},{"tags":["delphi","c++builder","vcl","twebbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":102,"score":2,"question_id":12836683,"title":"TCppWebBrowser vs TWebBrowser","body":"<p>What is the difference between TCppWebBrowser and TWebBrowser components in C++Builder 2010 and above? There is no mention of TCppWebBrowser in the help, where TWebBrowser has regular help section.</p>\n\n<p>So, which one should I use and is there any real difference?</p>\n"},{"tags":["delphi","delphi-xe2","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":12841377,"title":"Can TidHttpServer (Delphi XE2) handle urlencoded characters?","body":"<p>I have a TidHttpServer listening to port 8844 with the following code:</p>\n\n<pre><code>procedure TForm1.IdHTTPServer1CommandGet(AContext: TIdContext;\n  ARequestInfo: TIdHTTPRequestInfo; AResponseInfo: TIdHTTPResponseInfo);\nbegin\n  if ARequestInfo.Document &lt;&gt; '/favicon.ico' then\n  begin\n    Memo1.Text := ARequestInfo.Params.Text;\n  end;\nend;\n</code></pre>\n\n<p>This is compiled with Delphi XE2. When I browse to </p>\n\n<pre><code>http://localhost:8844/document?Value=%F6   &lt;-- %F6 is the encoded value for ö\n</code></pre>\n\n<p>...I get the result:</p>\n\n<pre><code>value=?\n</code></pre>\n\n<p>If i compile the application using Delphi 2007 I get the following result</p>\n\n<pre><code>value=ö\n</code></pre>\n\n<p>Is this a bug in Indy of something that I have missed?</p>\n"},{"tags":["mysql","delphi","delphi-xe2"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12815962,"title":"Calling TEdit objects based on DB query","body":"<p>I have a form with 7 TEdit having name EditPhone1, EditPhone2 and so on.\nIn the same form I query a DB to get data to fill those TEdits. Of course I cannot know in advance how many results the query will return.\nHow can I call the various TEdit objects when looping on the rowcount of the query?</p>\n"},{"tags":["delphi","debugging"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":12836743,"title":"Module load/unload cycle when debugging Delphi application","body":"<p>Sometimes when running application under Delphi 2009 debugger, as soon as I do anything with the application form (click, move..) Delphi starts to flood Event Log with following messages (similar):</p>\n\n<pre><code>Module Load: UNKNOWN_MODULE_59954.No DebugInfo. Base Address: $02D90000. Process MyApp.exe (5584)\nModule Unload: UNKNOWN_MODULE_59954. Process MyApp.exe (5584)\n</code></pre>\n\n<p>Number of UNKNOWN_MODULE increases for each cycle, so at example there have been almost 60000 module load/unloads.</p>\n\n<p>Application remains unresponsive during this flood. Sometimes I have to just terminate the application to be able to continue.</p>\n\n<p>Any idea how to start tracking the cause of this?</p>\n"},{"tags":["delphi","borland","teamsource"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":12845636,"title":"Borland Teamsource - break admin lock","body":"<p>I work at a shop which uses Delphi for fat-client development, and uses Borland's Teamsource product to manage the source code, etc.  We've had several instances where developers have put an administrative lock on a Teamsource project (thus preventing anyone else from checking in changes for as long as the lock exists) and then have left the company for greener (and hopefully more modern) climes, leaving the admin lock in place.  Our method of handling this is to create a new project, copy in the appropriate files, and move on, but I'm hoping that someone out there can suggest a way to clear the admin lock.  Due to amount of time which has passed (we typically find out that the admin lock was left in place years later when someone has to go in and modify one of the dino-apps) the Windows account which locked it has long since been removed, so the idea of resurrecting the account is likely a non-starter.</p>\n\n<p>Any help or suggestions greatly appreciated.</p>\n"},{"tags":["sql-server","delphi","ado","native","bde"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":258,"score":3,"question_id":12839257,"title":"Delphi connection to SQL Server - 'futureproof' replacement for BDE?","body":"<p>we have an applcation of some size (about 1MLOC) that were started back in the days when BDE was just about to be deprecated. Nowadays we only use it to connect to SQL Server using ODBC. It has worked surprisingly well in spite of its deprecated status, and chances are it will keep on working for another 15 years. However, no one knows if or when it stops working. And if it stops, Embarcadero wouldn't be able to do much about it. So, it's a timebomb, and we need to replace it. But with what?</p>\n\n<p>The ADO-components in Delphi looks promising. There are table and query components that resembles the BDE-components, and they are not third-party components made by a one-man shop that might loose interest. We also look forward to use connection-strings instead of the clunky ODBC-Administrator.</p>\n\n<p>However, about a year ago Microsoft announced that OLE DB is deprecated, and for native development we should use SQL Server Native Client ODBC driver.</p>\n\n<p>So, my qestion is, is the ADO-components in Delphi hardwired to OLD DB? Or would we not be using OLE DB if we select \"SQL Server Native Client\" in the list of drivers?</p>\n\n<p>I expect/fear that to make use of the SQL Server Native Client ODBC driver, we have to set up a datasource in ODBC-Adminstrator, like we do now. Or is it possible to connect with ODBC using connection-strings?</p>\n\n<p>And what Delphi-components exists that can connect to ODBC without using OLE DB?\nYes, I know about dbExpress, but it looks like it would take us years to convert to it from BDE.</p>\n\n<p>Thanks,\nLandShark</p>\n"},{"tags":["multithreading","delphi","ole"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":148,"score":0,"question_id":12840724,"title":"Delphi accessing OleObject from 2 different threads","body":"<p>I have some inherited code for opening IE and I have some troubles, here is what I have:</p>\n\n<p>IEUnit.pas (no form) has routines for LoadIE and OpenIE</p>\n\n<p>OpenIE is called from separate thread and it looks like this</p>\n\n<pre><code>procedure OpenIE(URL: OleVariant; FieldValues: string = '');\nvar ie : IWebBrowser2; // &lt;-- This should become \"global\" variable for the IEUnit\nbegin\n  ie := CreateOleObject('InternetExplorer.Application') as IWebBrowser2;\n  ie.Navigate2(URL, Flags, TargetFrameName, PostData, Headers);\n  ShowWindow(ie.HWND, SW_SHOWMAXIMIZED);\n  ie.Visible := true;\n  ...\nend;\n</code></pre>\n\n<p>I would like to have \"global\" ie variable in the unit and to write LoadIE routine like this :</p>\n\n<p>LoadIE should be called from FormCreate (main thread)</p>\n\n<p>It should just create \"global\" ie object</p>\n\n<pre><code>  ie := CreateOleObject('InternetExplorer.Application') as IWebBrowser2;\n</code></pre>\n\n<p>so the OpenIE function doesn't need to create it, just to use it (purpose is to speed things up)</p>\n\n<p>So problem is how to access same OLE object from 2 different threads, one creates the object, the other one uses it.</p>\n\n<hr>\n\n<p>When I write code that doesn't take care of threads I get an error</p>\n\n<p>exception class EOleSysError with message 'The application called an interface that was marshalled for a different thread'</p>\n\n<p>How should I do it, to take care of threads (I'm not experienced with threads, some reading and video links are welcome).</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["delphi","progress-bar"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2132,"score":0,"question_id":696199,"title":"Delphi Progress Bar","body":"<p>I'm trying to make a progress bar that starts at 0%, and takes 5 seconds to get to 100%. The progress bar will begin to go up as soon as Button1 is clicked. Any advice? I looked on Google, but that gave me nothing good on this sort of thing.</p>\n\n<p>Also, at 0%, there should be a label that says <code>Waiting...</code>, when the progress bar starts, it should go to <code>Working...</code>, and when it's done, it should say <code>Done!</code>.</p>\n"},{"tags":["delphi","delphi-xe2","windows-messages","hint"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":145,"score":1,"question_id":12838372,"title":"Intercepting hint event on delphi","body":"<p>I am trying to change hint text temporarily at a run-time inside of a component,\nwithout changing the <code>Hint</code> property itself.</p>\n\n<p>I've tried catching <code>CM_SHOWHINT</code>, but this event seems to only come to\nform, but not the component itself.</p>\n\n<p>Inserting CustomHint doesnt really work either, because it takes the text\nfrom the <code>Hint</code> property.</p>\n\n<p>my component is descendant from <code>TCustomPanel</code></p>\n\n<p>Here's what i'm trying to do:</p>\n\n<pre><code>procedure TImageBtn.WndProc(var Message: TMessage);\nbegin\n  if (Message.Msg = CM_HINTSHOW) then\n    PHintInfo(Message.LParam)^.HintStr := 'CustomHint';\nend;\n</code></pre>\n\n<p>I've found this code somewhere in the internet, unfortunately it doesn't work tho.</p>\n"},{"tags":["delphi","delphi-2006","tclientdataset","tadoquery","tdatasetprovider"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12835232,"title":"ClientDataSet only partially transferring data from TADOQuery","body":"<p>I have two databases and I need to ensure that all records in one database have a matching record in the other. I will call these DB-SQL and DB-Legacy</p>\n\n<p>This would be easy enough if both had an SQL interface, but unfortunately I only have this type of access to one, the other I have a 'find record / first / next' type interface.</p>\n\n<p>The method that I have chosen to perform this task is to transfer DB-SQL to a clientdataset via the code below:</p>\n\n<pre><code>  var\n    lQuery: TADOQuery;\n    lProvider: TDataSetProvider;\n    lDataSet: TClientDataSet;\n  begin\n    lQuery := TADOQuery.Create(nil);\n    lProvider := TDataSetProvider.Create(nil);\n    lDataSet := TClientDataSet.Create(nil);\n    // we don't need either of these and should speed things up\n    lDataSet.disablecontrols;\n    lQuery.DisableControls;\n    try\n      lQuery.Connection := aConnection;\n      lQuery.SQL.Add('SELECT FieldA, FieldB, FieldC, 0 as FoundInGIS');\n      lQuery.SQL.Add('FROM TableA');\n      // following two lines needed to allow us to modify the FoundInGIS field in the clientdataset\n      lQuery.open;\n      lquery.fieldbyname('FoundInGIS').Readonly := false;\n      lProvider.DataSet := lQuery;\n      lDataSet.Data := lProvider.Data;\n      lDataSet.fieldbyname('FoundInGIS').readonly := false;\n      lDataSet.LogChanges := false;\n      // index by FieldA for quick searching by FindKey later\n      lDataSet.IndexFieldNames := 'FieldA';\n    finally\n      lQuery.Free;\n      lProvider.Free;\n    end;\n</code></pre>\n\n<p>This is based on code at <a href=\"http://www.podgoretsky.com/ftp/docs/Delphi/D5/dg/5_ds3.html#20536\" rel=\"nofollow\">http://www.podgoretsky.com/ftp/docs/Delphi/D5/dg/5_ds3.html#20536</a></p>\n\n<p>This will then allow me to iterate over DB-legacy with First/Next until EOF, searching the ClientDataSet using FindKey to ensure all records in DB-Legacy exist in DB-SQL. By setting the FoundInGIS tag to 1, I can then filter by this value to find all records that are in DB-SQL but not in DB-Legacy.</p>\n\n<p>My problem is that one of our databases is significantly bigger than the others, at 3,310,510 records. lQuery has the correct number of records, however at the end of the procedure lDataSet only has around 2,500,000.</p>\n\n<p>Now, I want to use the cds to make use of the FindKey method, which isn't supported in TADOQuery, however it's not much use if it ignores 1/3 of the records! I'm guessing that there may be an integer overflow somewhere within the DataSetProvider or the ClientDataSet, though it's a bit naughty that it doesn't raise an exception if so! Has anyone else had this kind of issue, and is there a way of sorting it (perhaps by downloading the data in smaller chunks or using another way of populating CDS)?</p>\n\n<p>The SQL-DB in this case is Oracle, but code will also need to work with SQL-Server, though I doubt it's a DB issue.</p>\n\n<p>Edit:\nI'm getting some slightly different behaviour now. When I try removing some of the fields from the query it runs fine. All of the fields run OK individually, but it just can't handle all of them (which supports my overflow hypothesis). I am now, however getting an exception being raised occasionally. The exception is </p>\n\n<pre><code>'Format '%s' invalid or incompatible with argument'\n</code></pre>\n\n<p>This is misleading, as delving down the Debug DCUs shows the error is being raised by </p>\n\n<pre><code>SafeArrayCheck(SafeArrayCopy(VarToDataPacket(Value), FSavedPacket));\n</code></pre>\n\n<p>in TCustomClientDataSet.SetData (DBClient line 1482). This raises an ESafeArrayError (AResult = -2147024882) which becomes a 'Unexpected variant or safe array error', but it can't handle a subsequent call to FormatStr.</p>\n"},{"tags":["delphi","iocp"],"answer_count":6,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":1378,"score":5,"question_id":2302267,"title":"Is there a I/O completion port based component for Delphi?","body":"<p>I am aware of <a href=\"http://en.wikipedia.org/wiki/Internet_Direct\" rel=\"nofollow\">Indy</a>, <a href=\"http://www.vclcomponents.com/Delphi/Winsock___Internet/ICS__Internet_Component_Suite-info.html\" rel=\"nofollow\">ICS</a>, <a href=\"http://synapse.ararat.cz/doku.php/about\" rel=\"nofollow\">Synapse</a> and <a href=\"http://www.clevercomponents.com/products/inetsuite/suite.asp\" rel=\"nofollow\">Clever InetSuite</a>, none of which support <a href=\"http://en.wikipedia.org/wiki/Input/output_completion_port\" rel=\"nofollow\">IOCP</a>. Is there anything else out there?</p>\n\n<p>Edit:\nI found <a href=\"http://iocpclasses.sourceforge.net/\" rel=\"nofollow\">iocpclasses </a>, It's written in Delphi5. Better than nothing I suppose.</p>\n"},{"tags":["delphi","audio","delphi-2010","media","record"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":840,"score":0,"question_id":3178234,"title":"Recording and saving .wav Files with TMediaPlayer (Delphi 2010)","body":"<p>well im really new to the delphi world.</p>\n\n<p>Right now im using the TMediaPlayer to record some sound and save those.\nI made a click event for the record button in the TMediaPlayer which executes a SaveFileDialog. The user should type in some filename he would like to save and then after recording the .wav file he can click on the stop button and it will save his recorded .wav file.</p>\n\n<p>Actually it dont event create a file.</p>\n\n<p>I will show some important code parts of my delphi code</p>\n\n<pre><code>if Button = TMPBtnType.btRecord then\nbegin\nSaveDialogSpeichern.Execute;\nMediaPlayerSound.FileName := SaveDialogSpeichern.FileName;\nMediaPlayerSound.StartRecording;\n\nend\n</code></pre>\n\n<p>and those for save:</p>\n\n<pre><code>  MediaPlayerSound.Stop;\n  MediaPlayerSound.Save;\n</code></pre>\n\n<p>I cant use the bass.dll , so i would like to make this with the TMediaPlayer if there is a possible way</p>\n"},{"tags":["delphi"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":264,"score":1,"question_id":6992389,"title":"Delphi TZipMaster - how to use the Find method?","body":"<p>Using Delphi XE, TZipMaster 1.91 (latest)</p>\n\n<p>I want to get the file name of first file name matching the FSpec arg that is passed to the Find function. However, I get an access violation when calling this function. </p>\n\n<pre><code>  var\n    DBBakFl : String;\n    d : Integer;\n  begin\n    ZipMaster191.ZipFileName := 'myzip.zip';\n\n    try\n      DBBakFl := ZipMaster191.Find('*.FBK', d).FileName;\n    except\n      raise Exception.Create('Find raised an exception');\n    end;\n</code></pre>\n\n<p>Any help appreciated.</p>\n\n<p>EDIT:\nI sent an email got an almost immediate answer from one of the component's authors, Russell Peters. \nSee my answer below.</p>\n"},{"tags":["delphi","thread-safety","critical-section","indy10"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":173,"score":2,"question_id":12832016,"title":"Will a Critical Section help solve this?","body":"<p>Using an Indy 10 TCP command handler, every time I get a command I insert a row into a database and then I read the entire tale from the database to update a string grid.</p>\n\n<p>I am using AnyDac database components and their documentation says \"A connection object and all associated with it objects (like TADQuery, TADTransaction, etc) in each moment of time must be used by a single thread\".</p>\n\n<p>If I send the TCP commands \"slowly\" there is no problem. If I send them \"quickly\" (while AnyDac is still showing the SQL cursor, I get an exception EDatabaseError \"field not found\" - but it exists, of course.</p>\n\n<p>When I receive a TCP command, my code sends a UM_ using PostMEssage to my main form.</p>\n\n<p>What I <em>think</em> is happening is that the main form is reading all the rows from a table as a result of the first TCP command while the TCP command handler is half-way though inserting a new row as a result of the second command - hence \"field not found\"  when I invoke <code>ADQuery1.FieldByName()</code>.</p>\n\n<p>Does that sound like the problem?</p>\n\n<p>If so, how can I prevent it? Can use a Critical Section (where, main thread?)? Or is there some other way?</p>\n\n<hr>\n\n<p>[Update]  I just realized - this cannot be a threading problem (I think). When I get a TCP command I send a UM_ to my main form using PostMessage(). So, no matter how quickly the TCP Commands come, my main form can only process one UM_ at time via its message queue. The TCP command handlers are just a single line to send that message - no d/b access.</p>\n\n<p>BUT - what I don't understand is that if leave \"some time\" between TCP commands all is well, but if I send them \"quickly\" then I get the exception saying that there is no such field in that row of the table.</p>\n"},{"tags":["delphi","deadlock","firebird","database-deadlocks"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":126,"score":1,"question_id":12797817,"title":"Firebird forcebly remove deadlock","body":"<p>I'm using Delphi IBQuery and IBTransaction components to update all records in database with this query:</p>\n\n<pre><code>UPDATE INVOICES SET BLK = 0;\n</code></pre>\n\n<p>When users leave another client application opened it leaves deadlock on some records (opened by users).</p>\n\n<p>The problem is with my application that must complete the query above.</p>\n\n<p>Is it possible to implement some kind of solution to forcebly remove deadlocks? For example an SQL query?</p>\n\n<p>Firebird version is 2.1.2.18118\nrunning on Windows 7</p>\n"},{"tags":["delphi","dynamic-arrays","variant","delphi-6"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":103,"score":4,"question_id":12830822,"title":"Why does assigning a NIL array to a Variant cause a non-empty array to be returned in Delphi 6?","body":"<p>Consider the code below which compiles and runs without error in Delphi 6.  When I recover the dynamic string array, instead of seeing an empty array in <strong>sa</strong>, I see an array with a length of 1 with a single element containing an empty string.  Why is this and how can I safely assign a NIL dynamic array to a Variant and recover it properly?  Here's the code:</p>\n\n<pre><code>TDynamicStringArray = array of string;\n\nvar\n    V: Variant;\n    sa: TDynamicStringArray;\nbegin\n    sa := nil;\n\n    V := sa;\n\n    sa := V;\n\n    OutputDebugString('sa has a single element now with an empty string in it when I expect it to be empty.');\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-xe2","installaware"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12830358,"title":"delphi setup - error cannot start setup  corrupt or password protected ","body":"<p>i have this error at first, when i want to install <code>rad studio xe2</code> on <code>windows xp sp3</code>. im not sure which release of radstudio i have, but the name of <code>iso</code> file is <code>delphicbuilder_xe2_4429_win_dl</code></p>\n\n<p>there is full error :</p>\n\n<blockquote>\n  <p>InstallAware Wizard</p>\n  \n  <p>Cannot start setup - the setup file may be corrupt, or you may have the wrong password. If you downloaded this\n  file, please download a fresh copy. If the file is password protected,\n  check your password and try again.</p>\n</blockquote>\n\n<p>im sure the <code>iso</code> file isn't corrupt and isn't password protected. because i use this <code>iso</code> file, before. but i don't know why it have error when i want to start installation.</p>\n"},{"tags":["delphi","64bit","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":116,"score":4,"question_id":12831305,"title":"Delphi XE2 - Building 64bit applications","body":"<p>I know you are supposed to be able to build x64 apps in Delphi XE2...</p>\n\n<p>I am using a paid version, the starter version.</p>\n\n<p><img src=\"http://i.stack.imgur.com/DPHQq.png\" alt=\"enter image description here\"></p>\n\n<p>I checked in options as well and it will not let me change to 64 bit. Only 32.\nI am also running XE2 from a 64 bit machine.</p>\n\n<p>Could it be because I have the starter version? If so that is kind of ridiculous, see as I paid over $200 for this software.</p>\n"},{"tags":["delphi","debugging"],"answer_count":5,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":1363,"score":5,"question_id":7214213,"title":"How to get line number at runtime","body":"<p>is it possible to get source line number at runtime in Delphi?\nI know JCL debug, but I want to avoid to use it. Also Assert is not exactly what I want. I would like to get something like this, where GetLineNumber would get the source line number. Is it possible to do it without MAP files (anyway will MAP file be generated when I use Assert) ? Is there any example ?</p>\n\n<pre><code>function GetLineNumber: integer;\nbegin\n  ???\nend;\n\nprocedure ThisWouldBeGreat;\nbegin\n  if not SomeCondition then\n    LogMemo.Lines.Add('Error on line: ' + IntToStr(GetLineNumber));\nend;\n\nprocedure ThatsWhatIWont;\nbegin\n  Assert(not SomeCondition, 'Error');\nend;\n</code></pre>\n\n<p>Thank you</p>\n"},{"tags":["delphi","delphi-7","virtualtreeview","tvirtualstringtree"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":222,"score":2,"question_id":11487300,"title":"Edit a root node celltext in VirtualTreeView","body":"<p>I would like to change the cell text of an existing virtual (root) node. I can change the data but I have to refresh the whole TreeView so the GetText get's fired again. Is there an easier way or a possible way to refresh only 1 root node and not the whole tree?</p>\n\n<p>Thank you for your help.</p>\n"},{"tags":["delphi","winapi","audio","twebbrowser","urlmon"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12772289,"title":"Delphi XE2 winapi.urlmon.CoInternetSetFeatureEnabled not found?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4702285/cointernetisfeatureenabled-in-delphi2010\">CoInternetIsFeatureEnabled in Delphi2010</a>  </p>\n</blockquote>\n\n\n\n<p>I am trying to disable the annoying click on navigate sound in twebbrowser control but i can't seem to see the winapi.urlmon. CoInternetSetFeatureEnabled anywhere?</p>\n"},{"tags":["c#","delphi","dialog","interop","modal"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":81,"score":-1,"question_id":12830061,"title":"Delphi Modal Form and C# Application Creating It","body":"<p>I have a program in Delphi - I don't like Delphi (personal opinion).  I don't not have time to rewrite it.  I'm adding new stuff by coding it in C#.</p>\n\n<p>Problem.  I need a modal dialog/forms in C# called from Delphi. It worked fine when the C# stuff was in a DLL, but there were issues with having access to database, everything.  Not worth it.  Not to mention the unmanaged unsupported export and round tripping with il(d)asm.</p>\n\n<p>So now I have 2 exe's.  They communicate via named pipes.  When a message is sent \"ViewEditCategories\" the C# creates a FormViewEditCategories and does a showDialog(hwnd).  If I move the new dialog, it disappears.  hwnd comes from looking up the process.</p>\n\n<p>Has anyone done this?  I just need a simple way to branch out so that the end elements of the menus can be in a different language.  This is making me crazy.</p>\n\n<p>I tried the code for ShowModal in Delphi, and it was a mess.  Stuff wasn't public and I could not get it to compile.</p>\n\n<p>This question could apply to any language really.   How do I make another application's forms or dialogs MODAL to another (separate process) so it can be chained/linked smoothly?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["delphi","sms","gmail"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":188,"score":5,"question_id":12827308,"title":"Sending SMS through Gmail using delphi","body":"<p>As you know we can send SMS to any cellphone with the google chat, \nso can we use this function in a delphi program? \ncan we send sms with delphi?</p>\n"},{"tags":["delphi"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":163,"score":0,"question_id":12823117,"title":"How do I use Pure Data in Delphi?","body":"<p>Libpd is available for several languages, including C#, but I don't see any Delphi bindings. How can I use Pure Data in Delphi?</p>\n"},{"tags":["delphi","sql-server-2000","ado"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":448,"score":2,"question_id":12039306,"title":"Insert NULL with ADO from Delphi to SQL Server 2000","body":"<p>I am trying to insert with the help of ado in DELPHI 2007 to SQL Server 2000, and I've written something like this</p>\n\n<pre><code>insert into (a,b)\nselect :a,:b\n\nqry.parameters.parambyname('a').value := '';\nqry.parameters.parambyname('b').value := '';\n</code></pre>\n\n<p>The error I get is:</p>\n\n<blockquote>\n  <p><em>Disallowed implicit conversion from data type text to datat type nvarchar....<br>\n  use the convert function to run this query.</em></p>\n</blockquote>\n\n<p>The columns in the table have allow null set..</p>\n\n<p>Please help for a work around.</p>\n\n<p>What I want is that the SQL Server table shows NULL where the value is ''</p>\n\n<p>Best regards</p>\n"},{"tags":["delphi","delphi-7"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":96,"score":0,"question_id":12818835,"title":"Drawing bitmap on TMetafileCanvas has no results","body":"<p>I am executing: FCanvas.Draw method on fcanvas of TMetafileCanvas type.</p>\n\n<p>The problem is that the drawn image is:</p>\n\n<ul>\n<li>not visible when document printed to QPrinter local pdf printer</li>\n<li>is visible on BullzipPdf local printer</li>\n<li>is visible in xps file type</li>\n</ul>\n\n<p>What does it depend on? Why does it behave that way?</p>\n\n<p>EDIT\nI forgot to mention that canvas is being printed by using StretchDraw on Printer.Canvas.</p>\n\n<hr>\n\n<p>I have found by chance the following page:\n<a href=\"http://www.code4sale.com/texcellent/prndib.htm\" rel=\"nofollow\">http://www.code4sale.com/texcellent/prndib.htm</a></p>\n\n<p>They sell some libraries which guarantee bitmaps to be printed out on every printer...\nTo be honest I am amazed ...</p>\n\n<p>Is it really possible that printing bitmaps can be so ... complicated ...?</p>\n"},{"tags":["delphi","windows-7"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":152,"score":4,"question_id":12823736,"title":"Delphi: File access and compatibility files (windows 7)","body":"<p>Let's suppose my app in named <code>mysoft</code> and the file I want to READ is <code>afile.bin</code>. <code>mysoft</code> is in the program file folder.\nLet's also suppose that mysoft is not executed with admin privileges.</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar \n  afile: File of Byte;\nbegin\n  AssignFile(Infile, 'C:\\Program Files\\mysoft\\afile.bin');\n  Reset(afile);\n  CloseFile(afile);\nend;\n</code></pre>\n\n<p>The simple code above will create a copy of <code>afile.bin</code> in the compatibility files folder.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>Why ? I only read the damn file, I don't want to modify it.</li>\n<li>How to prevent this other than moving the file in another folder ?</li>\n</ol>\n\n<p>Again I only read the data file, I don't get it.</p>\n"},{"tags":["delphi","unicode","smtp","delphi-2009","indy"],"answer_count":8,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2525,"score":1,"question_id":495619,"title":"Delphi SMTP component that supports UTF-8 or Unicode","body":"<p>It <a href=\"https://forums.codegear.com/thread.jspa?messageID=43720\" rel=\"nofollow\">appears</a> the Indy 10 SMTP component shipped with Delphi 2009 do not properly support unicode in the subject and body.  </p>\n\n<p>Does anyone know of a good alternative, or has anyone made the necessary changes to Indy10 to solve this issue?</p>\n"},{"tags":["delphi","delphi-xe2","rtmp"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12819760,"title":"LIBRTMP Delphi RTMP_Read error?","body":"<p>I think that the unit that I'm using is wrong, because I do reading procedure:</p>\n\n<pre><code>procedure ReadStream (rtmp: RTMP; Stream: TStream);\nvar\n   Buffer: array [0 .. 16384-1] of Byte ;/ / 16kB buffer\n   BytesRead: Integer;\nbegin\n   while True do\n   begin\n     BytesRead: = RTMP_ReadData (rtmp, @ Buffer [0], SizeOf (Buffer));\n     if BytesRead = 0 then\n       exit;\n     Stream.WriteBuffer (Buffer [0], BytesRead);\n   end;\nend;\n</code></pre>\n\n<p>Procedure call:</p>\n\n<pre><code>var\n  MY_RTMP: RTMP;\n  URL_str: string;\n  MY_RTMPPacket: RTMPPacket;\n  URL_char: PAnsiChar;\n  F: TFileStream;\nbegin\n  F: = TFileStream.Create (ExtractFilePath (GetModuleName (0)) + 'Video.flv', fmCreate or fmOpenWrite);\n  URL_str: = 'rtmp :/ / localhost: 1935/Video/test.stream';\n  MY_RTMP: = RTMP_Alloc;\n  RTMP_Init (MY_RTMP);\n  RTMP_SetupURL (MY_RTMP, pcchar (URL_str));\n  RTMP_EnableWrite (MY_RTMP);\n  RTMP_Connect (MY_RTMP, MY_RTMPPacket);\n  RTMP_ConnectStream (MY_RTMP, 0);\n  ReadStream (MY_RTMP, F);\nend;\n</code></pre>\n\n<p>The program compiles, but when you start getting the error message:\n<strong>The procedure entry point RTMP_ReadData not found in library DLL librtmp?</strong>\nBut this function is described in the module, help me find a discrepancy</p>\n\n<p>the library does not function RTMP_ReadData, if trust Dependency Walker. There is a function RTMP_Read, and according to the source:</p>\n\n<p><a href=\"https://github.com/FFmpeg/FFmpeg/blob/master/libavformat/librtmp.c\" rel=\"nofollow\">links</a></p>\n\n<p>function on C as follows:</p>\n\n<pre><code>static int rtmp_read (URLContext * s, uint8_t * buf, int size)\n{\n     LibRTMPContext * ctx = s-&gt; priv_data;\n     RTMP * r = &amp; ctx-&gt; rtmp;\n\n     return RTMP_Read (r, buf, size);\n}\n</code></pre>\n\n<p>and in the module, which I use the description is missing</p>\n\n<p>the module I use an existing entry:</p>\n\n<pre><code>RTMP_READ = record\n       buf: pcchar;\n       bufpos: pcchar;\n       buflen: cuint;\n       timestamp: uint32_t;\n       dataType: uint8_t;\n       flags: uint8_t;\n       status: int8_t;\n       initialFrameType: uint8_t;\n       nResumeTS: uint32_t;\n       metaHeader: pcchar;\n       initialFrame: pcchar;\n       nMetaHeaderSize: uint32_t;\n       nInitialFrameSize: uint32_t;\n       nIgnoredFrameCounter: uint32_t;\n       nIgnoredFlvFrameCounter: uint32_t;\n     end;\n</code></pre>\n\n<p>She imee name that is invoked, but it contains a lot of confusing me options, not related to the function of the load, in my opinion. What do I do with this record?</p>\n"},{"tags":["mysql","delphi","delphi-7","jpeg"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":176,"score":5,"question_id":12697699,"title":"Why do I get JPEG error 42 when it's stored in a database?","body":"<p>I have problem to display my Picture in TImage from my MySql database using Delphi.</p>\n\n<p>I save picture to my database with this code and work Perfectly.</p>\n\n<pre><code>var\n  AStream : TMemoryStream;\n\nAStream := TMemoryStream.Create;\n  try\n    Image1.Picture.Graphic.SaveToStream(AStream);\n    AStream.Position := 0;\n    if ADODataSet1.Active then\n    begin\n      ADODataSet1.Edit;\n      TBlobField(ADODataSet1.FieldByName('MyField')).LoadFromStream(AStream);\n      ADODataSet1.Post;\n    end;\n  finally\n    AStream.Free;\n  end;\n</code></pre>\n\n<p>But, problem is when I want to retrieve that Pictures. I use this code but I can display only first image from my database. I uses this code on DBGrid event - OnDrawColumnCell. AND WHEN I USE THIS CODE I'M GETTING MESSAGE JPEG ERROR #42!</p>\n\n<pre><code>var\n  AStream : TMemoryStream;\nbegin\n  AStream := TMemoryStream.Create;\n  try\n    if ADODataSet1.Active then\n    begin\n      TBlobField(ADODataSet1.FieldByName('MyField')).SaveToStream(AStream);\n      AStream.Position := 0;\n      Image1.Picture.Graphic.LoadFromStream(AStream);\n    end;\n  finally\n    AStream.Free;\n  end;\nend;\n</code></pre>\n\n<p>Can somebody show me how to Fix This Problem.\nThank you.</p>\n"},{"tags":["multithreading","delphi","critical-section","static-array"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":130,"score":1,"question_id":12818411,"title":"Delphi static array thread safety only with critical section","body":"<p>I have a Win32 Thread (no TThread) that runs alle the time and iterates over a static array. The mainthread can modify fields of the array. What is the best way to make this thread-safe <strong>without components like TThreadList</strong> (for a no-vcl application), only with Windows Critical Sections (TRTLCriticalSection)?</p>\n\n<p>Code:</p>\n\n<pre><code>type\n  T = record\n    Idx: Integer;\n    Str: string;\n    Num: Real;\n    Enabled: Boolean;\n  end;\n\nvar\n  A: Array[0..9] of T;\n  Cnt: Integer;\n  CS: TRTLCriticalSection;\n\nprocedure thread;\nvar\n  I: Integer;\nbegin\n  while True do\n  begin\n    for I := Low(A) to High(A) do\n    begin\n      if A[I].Enabled then\n      begin\n        //modify some fields from A[I]\n\n        Inc(A[I].Idx);\n        if A[I].Idx &gt;= 10 then\n        begin\n          A[I].Enabled := False;\n          InterlockedDecrement(Cnt);\n        end;\n      end;\n    end;\n    if Cnt = 0 then Sleep(1);\n  end;\nend;\n\nprocedure Add(...); //called only from mainthread\n\n  function GetFreeField: Integer;\n  begin\n    for Result := Low(A) to High(A) do\n      if not A[Result].Enabled then Exit;\n    Result := -1;\n  end;\n\nvar\n  I: Integer;\nbegin\n  I := GetFreeField;\n  if I = -1 then Exit;\n\n  //set fields A[I]\n\n  A[I].Enabled := True;\n  InterlockedIncrement(Cnt);\nend;\n</code></pre>\n\n<p>At the beginning the array is initialized with enabled = false and cnt = 0.</p>\n\n<p>Is the following modification sufficient?</p>\n\n<pre><code>procedure thread;\nvar\n  I: Integer;\nbegin\n  while True do\n  begin\n    for I := Low(A) to High(A) do\n    begin\n      EnterCriticalSection(CS);\n      if A[I].Enabled then\n      begin\n        LeaveCriticalSection(CS);\n        //modify some fields from A[I]\n\n        Inc(A[I].Idx);\n        if A[I].Idx &gt;= 10 then\n        begin\n          EnterCriticalSection(CS);\n          A[I].Enabled := False;\n          LeaveCriticalSection(CS);\n\n          InterlockedDecrement(Cnt);\n        end;\n      end\n      else\n        LeaveCriticalSection(CS);\n    end;\n    if Cnt = 0 then Sleep(1);\n  end;\nend;\n\nprocedure Add(...); //called only from mainthread\nvar\n  I: Integer;\nbegin\n  I := GetFreeField;\n  if I = -1 then Exit;\n\n  //set fields A[I]\n\n  EnterCriticalSection(CS);\n  A[I].Enabled := True;\n  LeaveCriticalSection(CS);\n\n  InterlockedIncrement(Cnt);\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-7","delphi-xe2","delphi-2010","delphi-2009"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":130,"score":0,"question_id":12817435,"title":"Delphi - Writing a program that reads a series of numbers and adds them up until the user enters 0","body":"<p><strong>This is where I am at So far and when I enter a number in the edit box and press the button it crashes, I am a newbie to Delphi please help! Thanks, Matt</strong></p>\n\n<pre><code>var\n  Form3: TForm3;\n  Count: integer;\n  RunningTotal: Real;\nimplementation\n\n{$R *.dfm}\n\n\n\nprocedure TForm3.btnEnterClick(Sender: TObject);\nbegin\n repeat\n\n   RunningTotal:= RunningTotal + STRTOINT (edtNum.Text);\n until STRTOINT(edtNum.Text)=0;\n  lblAns.Caption:= FLOATTOSTR (RunningTotal);\n\nend;\n\nprocedure TForm3.edtNumChange(Sender: TObject);\nbegin\n\nend;\n\nprocedure TForm3.FormCreate(Sender: TObject);\nbegin\nCount:=0;\nRunningTotal:=0;\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","png","transparency","delphi-7"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":180,"score":2,"question_id":10975372,"title":"How to disable transparency for PNG","body":"<p>How to completely disable transparency of given <code>PNGObject</code>? By the way I am using PNGImage unit of Version 1.564.</p>\n"},{"tags":["delphi","plugins","interface","message","hydra"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":128,"score":2,"question_id":12802847,"title":"RemObjects Hydra Plugin Can't Handle WM_DEVICECHANGE Windows Messages Directly","body":"<p>I Creating a Hydra Host Application and a Hydra Plugin. I put a Procedure for Handling a Windows Message in Plugin; but in this case we can't handle this windows message. for solving this problem we can handle It in Host App and then we must talk with pluging via passing an Interface.\nIn this case I want to find a direct way for handle windows messages in Hydra Plugin. Please help me for solving this problem.</p>\n\n<p><strong>Update 1 for this Question:</strong>\nthis is a simple code for testing:</p>\n\n<p><strong>Plugin Side:</strong></p>\n\n<pre><code>unit VisualPlugin;\n\ninterface\n\nuses\n  { vcl: } Windows, Messages, SysUtils, Variants, Classes, Graphics,\n  Controls, Forms, Dialogs, StdCtrls,\n  { Hydra: } uHYVisualPlugin, uHYIntf;\n\ntype\n  TVisualPlugin1 = class(THYVisualPlugin)\n  private\n\n    procedure WMDEVICECHANGE(var Msg: TMessage); message WM_DEVICECHANGE;\n\n  end;\n\nimplementation\n\nuses\n  { Hydra: } uHYPluginFactories;\n{$R *.dfm}\n\nprocedure Create_VisualPlugin1(out anInstance: IInterface);\nbegin\n  anInstance := TVisualPlugin1.Create(NIL);\nend;\n\nresourcestring\n  sDescription = '';\n\nconst\n  sRequiredPrivilege = '';\n  sUserData = '';\n\n  { TVisualPlugin1 }\n\nprocedure TVisualPlugin1.WMDEVICECHANGE(var Msg: TMessage);\nbegin\n  // ===================================\n  // This Line Of Code Can't Be Run!!!!!!\n  ShowMessage('USB Changed');\n\n  // ===================================\nend;\n\ninitialization\n\nTHYPluginFactory.Create(HInstance, 'VisualPlugin1', Create_VisualPlugin1,\n  TVisualPlugin1, 1, 0, sRequiredPrivilege, sDescription, sUserData);\n\nend.\n</code></pre>\n\n<p><strong>PluginController in Plugin Side:</strong></p>\n\n<pre><code>unit hcPluginController;\n\ninterface\n\nuses\n  {vcl:} SysUtils, Classes, \n  {Hydra:} uHYModuleController, uHYIntf, uHYCrossPlatformInterfaces;\n\ntype\n  TPluginController = class(THYModuleController)\n  private\n  public\n  end;\n\nvar\n  PluginController : TPluginController;\n\nimplementation\n\nuses\n  {Hydra:} uHYRes;\n\n{$R *.dfm}\n\nprocedure HYGetCrossPlatformModule(out result: IHYCrossPlatformModule); stdcall;\nbegin\n  result := PluginController as IHYCrossPlatformModule;\nend;\n\nfunction HYGetModuleController : THYModuleController;\nbegin\n  result := PluginController;\nend;\n\nexports\n  HYGetCrossPlatformModule,\n  HYGetModuleController name name_HYGetModuleController;\n\nresourcestring\n  sDescription = '';\n\nconst\n  sRequiredPrivilege = '';\n\ninitialization\n  PluginController := TPluginController.Create('Plugin.Library', 1, 0, sRequiredPrivilege, sDescription);\n\nfinalization\n  FreeAndNil(PluginController);\n\nend.\n</code></pre>\n\n<p><strong>Host Application Side:</strong></p>\n\n<pre><code>unit fMain;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, uHYModuleManager, uHYIntf, ExtCtrls, StdCtrls;\n\ntype\n  TMainForm = class(TForm)\n    HYModuleManager1: THYModuleManager;\n    Panel1: TPanel;\n    btnLoadPlugin: TButton;\n    procedure btnLoadPluginClick(Sender: TObject);\n    procedure FormCreate(Sender: TObject);\n    procedure FormClose(Sender: TObject; var Action: TCloseAction);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  MainForm: TMainForm;\n\nimplementation\n\n{$R *.dfm}\n\nvar\n  AppDir: string;\n  fPlugin: IHYVisualPlugin;\n\nconst\n  PluginDll = 'Plugin.dll';\n  PluginName = 'VisualPlugin1';\n\nprocedure TMainForm.btnLoadPluginClick(Sender: TObject);\nbegin\n  if HYModuleManager1.FindModule(AppDir + PluginDll) = nil then\n    HYModuleManager1.LoadModule(AppDir + PluginDll);\n\n  HYModuleManager1.CreateVisualPlugin(PluginName, fPlugin, Panel1);\nend;\n\nprocedure TMainForm.FormClose(Sender: TObject; var Action: TCloseAction);\nbegin\n  HYModuleManager1.ReleaseInstance(fPlugin);\n  HYModuleManager1.UnloadModules;\nend;\n\nprocedure TMainForm.FormCreate(Sender: TObject);\nbegin\n  AppDir := ExtractFilePath(Application.ExeName);\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","internet-explorer","ole"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":12817277,"title":"Delphi and Internet Explorer, create \"global\" IE","body":"<p>I have some inherited code for opening IE, this is short version :</p>\n\n<pre><code>procedure OpenIE(URL: OleVariant; FieldValues: string = '');\nvar ie : IWebBrowser2;\nbegin\n  ie := CreateOleObject('InternetExplorer.Application') as IWebBrowser2;\n  ie.Navigate2(URL, Flags, TargetFrameName, PostData, Headers);\n  ShowWindow(ie.HWND, SW_SHOWMAXIMIZED);\n  ie.Visible := true;\n  ...\nend;\n</code></pre>\n\n<p>Since CreateOleObject takes a long time to execute I would like to have one \"prepared\" IE for the first run.</p>\n\n<p>For example in Main FormCreate to call CreateOleObject, then for 1st call of OpenIE to use \"IE\" object already created.</p>\n\n<p>For 2nd, 3rd ... call of OpenIE - just usual call\n    ie := CreateOleObject</p>\n\n<p>When I try to code it, I get some threads and marshaling errors, I am newbie in this area. What would be proper way to do this (some small code example would be great) ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":[".net","delphi","interop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":165,"score":1,"question_id":12806012,"title":"Implementing .NET Interface in Delphi","body":"<p>My main application is in C#, and references another .NET DLL that declares <code>IPlugin</code> and <code>IPluginHost</code>. I now need to import this DLL into a Delphi project so I can make a plugin for the main app. I've heard this is possible, but there is so much about importing classes (which I don't want) or running Delphi code within .NET</p>\n\n<p>Has anyone done this before who can clarify?</p>\n"},{"tags":["delphi","delphi-xe2","rtmp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":206,"score":0,"question_id":12815557,"title":"Download and save RTMP stream to the hard disk using LIBRTMP dll","body":"<p>I am trying to download and save the RTMP stream. In the description of the library I found a method to maintain the flow. Please help me deal with this. Code that I use:</p>\n\n<pre><code>var\n  MY_RTMP: RTMP;\n  URL_str: string;\n  MY_RTMPPacket: RTMPPacket;\n  URL_char: PAnsiChar;\nbegin\n  URL_str: = 'rtmp :/ / localhost: 1935/Video/test.stream';\n  MY_RTMP: = RTMP_Alloc;\n  RTMP_Init (MY_RTMP);\n  RTMP_SetupURL (MY_RTMP, pcchar (URL_str));\n  RTMP_EnableWrite (MY_RTMP);\n  RTMP_Connect (MY_RTMP, MY_RTMPPacket);\n  RTMP_ConnectStream (MY_RTMP, 0);\n  RTMP_Read();\n</code></pre>\n\n<p>but it can only connect to the server\nthe use RTMP_Read (); I wanted to get help, because no idea what parameters must be passed to obtain a result.</p>\n\n<p>LibRTMP definitions:</p>\n\n<pre><code>LIBRTMP(3)      LIBRTMP(3)\nRTMPDump v2.4   2011-07-20  LIBRTMP(3)\n\n\nNAME\n\nlibrtmp − RTMPDump Real-Time Messaging Protocol API\nLIBRARY\n\nRTMPDump RTMP (librtmp, -lrtmp)\nSYNOPSIS\n\n#include &lt;librtmp/rtmp.h&gt;\nDESCRIPTION\n\nThe Real-Time Messaging Protocol (RTMP) is used for streaming multimedia content across a TCP/IP network. This API provides most client functions and a few server functions needed to support RTMP, RTMP tunneled in HTTP (RTMPT), encrypted RTMP (RTMPE), RTMP over SSL/TLS (RTMPS) and tunneled variants of these encrypted types (RTMPTE, RTMPTS). The basic RTMP specification has been published by Adobe but this API was reverse-engineered without use of the Adobe specification. As such, it may deviate from any published specifications but it usually duplicates the actual behavior of the original Adobe clients.\nThe RTMPDump software package includes a basic client utility program in rtmpdump(1), some sample servers, and a library used to provide programmatic access to the RTMP protocol. This man page gives an overview of the RTMP library routines. These routines are found in the -lrtmp library. Many other routines are also available, but they are not documented yet.\n\nThe basic interaction is as follows. A session handle is created using RTMP_Alloc() and initialized using RTMP_Init(). All session parameters are provided using RTMP_SetupURL(). The network connection is established using RTMP_Connect(), and then the RTMP session is established using RTMP_ConnectStream(). The stream is read using RTMP_Read(). A client can publish a stream by calling RTMP_EnableWrite() before the RTMP_Connect() call, and then using RTMP_Write() after the session is established. While a stream is playing it may be paused and unpaused using RTMP_Pause(). The stream playback position can be moved using RTMP_Seek(). When RTMP_Read() returns 0 bytes, the stream is complete and may be closed using RTMP_Close(). The session handle is freed using RTMP_Free().\n\nAll data is transferred using FLV format. The basic session requires an RTMP URL. The RTMP URL format is of the form\n\n  rtmp[t][e|s]://hostname[:port][/app[/playpath]]\nPlain rtmp, as well as tunneled and encrypted sessions are supported.\n\nAdditional options may be specified by appending space-separated key=value pairs to the URL. Special characters in values may need to be escaped to prevent misinterpretation by the option parser. The escape encoding uses a backslash followed by two hexadecimal digits representing the ASCII value of the character. E.g., spaces must be escaped as \\20 and backslashes must be escaped as \\5c.\n\nOPTIONS\n\nNetwork Parameters\n\nThese options define how to connect to the media server.\nsocks=host:port\nUse the specified SOCKS4 proxy.\nConnection Parameters\n\nThese options define the content of the RTMP Connect request packet. If correct values are not provided, the media server will reject the connection attempt.\napp=name\nName of application to connect to on the RTMP server. Overrides the app in the RTMP URL. Sometimes the librtmp URL parser cannot determine the app name automatically, so it must be given explicitly using this option.\ntcUrl=url\nURL of the target stream. Defaults to rtmp[t][e|s]://host[:port]/app.\npageUrl=url\nURL of the web page in which the media was embedded. By default no value will be sent.\nswfUrl=url\nURL of the SWF player for the media. By default no value will be sent.\nflashVer=version\nVersion of the Flash plugin used to run the SWF player. The default is \"LNX 10,0,32,18\".\nconn=type:data\nAppend arbitrary AMF data to the Connect message. The type must be B for Boolean, N for number, S for string, O for object, or Z for null. For Booleans the data must be either 0 or 1 for FALSE or TRUE, respectively. Likewise for Objects the data must be 0 or 1 to end or begin an object, respectively. Data items in subobjects may be named, by prefixing the type with 'N' and specifying the name before the value, e.g. NB:myFlag:1. This option may be used multiple times to construct arbitrary AMF sequences. E.g.\n  conn=B:1 conn=S:authMe conn=O:1 conn=NN:code:1.23 conn=NS:flag:ok conn=O:0\nSession Parameters\n\nThese options take effect after the Connect request has succeeded.\nplaypath=path\nOverrides the playpath parsed from the RTMP URL. Sometimes the rtmpdump URL parser cannot determine the correct playpath automatically, so it must be given explicitly using this option.\nplaylist=0|1\nIf the value is 1 or TRUE, issue a set_playlist command before sending the play command. The playlist will just contain the current playpath. If the value is 0 or FALSE, the set_playlist command will not be sent. The default is FALSE.\nlive=0|1\nSpecify that the media is a live stream. No resuming or seeking in live streams is possible.\nsubscribe=path\nName of live stream to subscribe to. Defaults to playpath.\nstart=num\nStart at num seconds into the stream. Not valid for live streams.\nstop=num\nStop at num seconds into the stream.\nbuffer=num\nSet buffer time to num milliseconds. The default is 30000.\ntimeout=num\nTimeout the session after num seconds without receiving any data from the server. The default is 120.\nSecurity Parameters\n\nThese options handle additional authentication requests from the server.\ntoken=key\nKey for SecureToken response, used if the server requires SecureToken authentication.\njtv=JSON\nJSON token used by legacy Justin.tv servers. Invokes NetStream.Authenticate.UsherToken\nswfVfy=0|1\nIf the value is 1 or TRUE, the SWF player is retrieved from the specified swfUrl for performing SWF Verification. The SWF hash and size (used in the verification step) are computed automatically. Also the SWF information is cached in a .swfinfo file in the user's home directory, so that it doesn't need to be retrieved and recalculated every time. The .swfinfo file records the SWF URL, the time it was fetched, the modification timestamp of the SWF file, its size, and its hash. By default, the cached info will be used for 30 days before re-checking.\nswfAge=days\nSpecify how many days to use the cached SWF info before re-checking. Use 0 to always check the SWF URL. Note that if the check shows that the SWF file has the same modification timestamp as before, it will not be retrieved again.\nEXAMPLES\n\nAn example character string suitable for use with RTMP_SetupURL():\n  \"rtmp://flashserver:1935/ondemand/thefile swfUrl=http://flashserver/player.swf swfVfy=1\"\nENVIRONMENT\n\nHOME\nThe value of $HOME is used as the location for the .swfinfo file.\nFILES\n\n$HOME/.swfinfo\nCache of SWF Verification information\nSEE ALSO\n\nrtmpdump(1), rtmpgw(8)\nAUTHORS\n\nAndrej Stepanchuk, Howard Chu, The Flvstreamer Team \n&lt;http://rtmpdump.mplayerhq.hu&gt;\n</code></pre>\n\n<p>Code used :</p>\n\n<pre><code>{$IFDEF FPC}\n  {$MODE DELPHI}\n  {$PACKRECORDS C}\n{$ENDIF}\n\nunit lrtmp;\n\ninterface\n\nuses windows, sockets, WinSock ;\n\nConst\n{$ifdef windows}\n  LibRtmp = 'librtmp'; // Library name\n  { matching lib version for librtmp.dll, needed for initialization }\n  RTMP_LIBRTMP_VER_STRING='2.3';\n{$else windows}\n  LibRtmp = 'rtmp'; // Library name\n  { matching lib version for librtmp, needed for initialization }\n  RTMP_LIBRTMP_VER_STRING='2.3';\n{$endif windows}\n\n//{$I inttypes}\n\n{AMF Constants}\nConst\n    AMF_NUMBER = 0;\n    AMF_BOOLEAN = 1;\n    AMF_STRING = 2;\n    AMF_OBJECT = 3;\n    AMF_MOVIECLIP = 4;\n    AMF_NULL = 5;\n    AMF_UNDEFINED = 6;\n    AMF_REFERENCE = 7;\n    AMF_ECMA_ARRAY = 8;\n    AMF_OBJECT_END = 9;\n    AMF_STRICT_ARRAY = 10;\n    AMF_DATE = 11;\n    AMF_LONG_STRING = 12;\n    AMF_UNSUPPORTED = 13;\n    AMF_RECORDSET = 14;\n    AMF_XML_DOC = 15;\n    AMF_TYPED_OBJECT = 16;\n    AMF_AVMPLUS = 17;\n    AMF_INVALID = $ff;\n    AMF3_UNDEFINED = 0;\n    AMF3_NULL = 1;\n    AMF3_FALSE = 2;\n    AMF3_TRUE = 3;\n    AMF3_INTEGER = 4;\n    AMF3_DOUBLE = 5;\n    AMF3_STRING = 6;\n    AMF3_XML_DOC = 7;\n    AMF3_DATE = 8;\n    AMF3_ARRAY = 9;\n    AMF3_OBJECT = 10;\n    AMF3_XML = 11;\n    AMF3_BYTE_ARRAY = 12;\n\n{RTMP Constants}\nconst\n  RTMP_LIB_VERSION = $020300;  \n  RTMP_FEATURE_HTTP = $01;  \n  RTMP_FEATURE_ENC = $02;  \n  RTMP_FEATURE_SSL = $04;  \n  RTMP_FEATURE_MFP = $08;  \n  RTMP_FEATURE_WRITE = $10;  \n  RTMP_FEATURE_HTTP2 = $20;  \n  RTMP_PROTOCOL_UNDEFINED = -(1);  \n  RTMP_PROTOCOL_RTMP = 0;  \n  RTMP_PROTOCOL_RTMPE = RTMP_FEATURE_ENC;  \n  RTMP_PROTOCOL_RTMPT = RTMP_FEATURE_HTTP;  \n  RTMP_PROTOCOL_RTMPS = RTMP_FEATURE_SSL;  \n  RTMP_PROTOCOL_RTMPTE = RTMP_FEATURE_HTTP or RTMP_FEATURE_ENC;  \n  RTMP_PROTOCOL_RTMPTS = RTMP_FEATURE_HTTP or RTMP_FEATURE_SSL;  \n  RTMP_PROTOCOL_RTMFP = RTMP_FEATURE_MFP;  \n  RTMP_DEFAULT_CHUNKSIZE = 128;  \n  RTMP_BUFFER_CACHE_SIZE = 16*1024;  \n  RTMP_CHANNELS = 65600;  \n  RTMP_PACKET_TYPE_AUDIO = $08;  \n  RTMP_PACKET_TYPE_VIDEO = $09;  \n  RTMP_PACKET_TYPE_INFO = $12;  \n  RTMP_MAX_HEADER_SIZE = 18;  \n  RTMP_PACKET_SIZE_LARGE = 0;  \n  RTMP_PACKET_SIZE_MEDIUM = 1;  \n  RTMP_PACKET_SIZE_SMALL = 2;  \n  RTMP_PACKET_SIZE_MINIMUM = 3;  \n  RTMP_LF_AUTH = $0001;  \n  RTMP_LF_LIVE = $0002;  \n  RTMP_LF_SWFV = $0004;  \n  RTMP_LF_PLST = $0008;  \n  RTMP_LF_BUFX = $0010;  \n  RTMP_LF_FTCU = $0020;  \n  RTMP_SWF_HASHLEN = 32;  \n  RTMP_READ_HEADER = $01;  \n  RTMP_READ_RESUME = $02;  \n  RTMP_READ_NO_IGNORE = $04;  \n  RTMP_READ_GOTKF = $08;  \n  RTMP_READ_GOTFLVK = $10;  \n  RTMP_READ_SEEKING = $20;  \n  RTMP_READ_COMPLETE = -(3);\n  RTMP_READ_ERROR = -(2);  \n  RTMP_READ_EOF = -(1);  \n  RTMP_READ_IGNORE = 0;\n\nvar\n  FSocket  : TSocket;\n  SockAddrB : TSockAddr;\n  WSAData  : TWSAData;\n\n{AMF Types}\nType\n char = AnsiChar;\n cint = longint;\n cchar = shortint;\n pcchar = ^cchar;\n uint8_t  = Byte;\n uint32_t = LongWord;\n int8_t = char;\n int32_t = LongInt;\n unsigned_char = Byte;\n unsigned_int = LongWord;\n unsigned_short = Word;\n int16_t = smallint;\n cuchar = byte;\n pcuchar = ^cuchar;\n cushort = Word;\n cuint = LongWord;\n cshort = SmallInt;\n clong = LongInt;\n\n    AVal = record\n          av_val : pcchar;\n          av_len : cint;\n        end;\n    PAVal  = ^AVal;\n    AMF3ClassDef = record\n          cd_name : AVal;\n          cd_externalizable : cchar;\n          cd_dynamic : cchar;\n          cd_num : cint;\n          cd_props : PAVal;\n        end;\n    PAMF3ClassDef  = ^AMF3ClassDef;\n    AMF3DataType =  Longint;\n    PAMF3DataType  = ^AMF3DataType;\n    AMFDataType =  Longint;\n    PAMFDataType  = ^AMFDataType;\n    AMFObjectProperty = record\n          {undefined structure}\n        end;\n    PAMFObjectProperty  = ^AMFObjectProperty;\n    AMFObject = record\n          o_num : cint;\n          o_props : PAMFObjectProperty;\n        end;\n    PAMFObject  = ^AMFObject;\n\n{RTMP Types}\n\nType\n  TArray0toRTMP_SWF_HASHLEN1OfUint8_t = array[0..(RTMP_SWF_HASHLEN)-1] of uint8_t;\n  TArray0toRTMP_SWF_HASHLEN101OfCchar = array[0..(RTMP_SWF_HASHLEN+10)-1] of cchar;\n  TArray0toRTMP_MAX_HEADER_SIZE1OfCchar = array[0..(RTMP_MAX_HEADER_SIZE)-1] of cchar;\n  TArray0toRTMP_CHANNELS1OfCint = array[0..(RTMP_CHANNELS)-1] of cint;\n  TArray0toRTMP_BUFFER_CACHE_SIZE1OfCchar = array[0..(RTMP_BUFFER_CACHE_SIZE)-1] of cchar;\n  TArray0to6OfPcchar = array[0..6] of pcchar;\n\n  SockAddr = record\n   sa_family: u_short;\n   sa_data: array[0..13] of Char;\n  end;\n\n  RTMPChunk = record\n      c_headerSize : cint;\n      c_chunkSize : cint;\n      c_chunk : pcchar;\n      c_header : TArray0toRTMP_MAX_HEADER_SIZE1OfCchar;\n    end;\n\n  PRTMPChunk  = ^RTMPChunk;\n\n  RTMPPacket = record\n      m_headerType : uint8_t;\n      m_packetType : uint8_t;\n      m_hasAbsTimestamp : uint8_t;\n      m_nChannel : cint;\n      m_nTimeStamp : uint32_t;\n      m_nInfoField2 : int32_t;\n      m_nBodySize : uint32_t;\n      m_nBytesRead : uint32_t;\n      m_chunk : PRTMPChunk;\n      m_body : pcchar;\n    end;\n\n  PRTMPPacket  = ^RTMPPacket;\n  TArray0toRTMP_CHANNELS1OfPRTMPPacket = array[0..(RTMP_CHANNELS)-1] of PRTMPPacket;\n\n  RTMPSockBuf = record\n      sb_socket : cint;\n      sb_size : cint;\n      sb_start : pcchar;\n      sb_buf : TArray0toRTMP_BUFFER_CACHE_SIZE1OfCchar;\n      sb_timedout : cint;\n      sb_ssl : pointer;\n    end;\n\n  RTMP_LNK = record\n      hostname : AVal;\n      sockshost : AVal;\n      playpath0 : AVal;\n      playpath : AVal;\n      tcUrl : AVal;\n      swfUrl : AVal;\n      pageUrl : AVal;\n      app : AVal;\n      auth : AVal;\n      flashVer : AVal;\n      subscribepath : AVal;\n      token : AVal;\n      extras : AMFObject;\n      edepth : cint;\n      seekTime : cint;\n      stopTime : cint;\n      lFlags : cint;\n      swfAge : cint;\n      protocol : cint;\n      timeout : cint;\n      socksport : cushort;\n      port : cushort;\n      dh : pointer;\n      rc4keyIn : pointer;\n      rc4keyOut : pointer;\n      SWFSize : uint32_t;\n      SWFHash : TArray0toRTMP_SWF_HASHLEN1OfUint8_t;\n      SWFVerificationResponse : TArray0toRTMP_SWF_HASHLEN101OfCchar;\n    end;\n\n  RTMP_READ = record\n      buf : pcchar;\n      bufpos : pcchar;\n      buflen : cuint;\n      timestamp : uint32_t;\n      dataType : uint8_t;\n      flags : uint8_t;\n      status : int8_t;\n      initialFrameType : uint8_t;\n      nResumeTS : uint32_t;\n      metaHeader : pcchar;\n      initialFrame : pcchar;\n      nMetaHeaderSize : uint32_t;\n      nInitialFrameSize : uint32_t;\n      nIgnoredFrameCounter : uint32_t;\n      nIgnoredFlvFrameCounter : uint32_t;\n    end;\n\n  RTMP_METHOD = record\n      name : AVal;\n      num : cint;\n    end;\n\n  PRTMP_METHOD  = ^RTMP_METHOD;\n\n  RTMP = record\n      m_inChunkSize : cint;\n      m_outChunkSize : cint;\n      m_nBWCheckCounter : cint;\n      m_nBytesIn : cint;\n      m_nBytesInSent : cint;\n      m_nBufferMS : cint;\n      m_stream_id : cint;\n      m_mediaChannel : cint;\n      m_mediaStamp : uint32_t;\n      m_pauseStamp : uint32_t;\n      m_pausing : cint;\n      m_nServerBW : cint;\n      m_nClientBW : cint;\n      m_nClientBW2 : uint8_t;\n      m_bPlaying : uint8_t;\n      m_bSendEncoding : uint8_t;\n      m_bSendCounter : uint8_t;\n      m_numInvokes : cint;\n      m_numCalls : cint;\n      m_methodCalls : PRTMP_METHOD;\n      m_vecChannelsIn : TArray0toRTMP_CHANNELS1OfPRTMPPacket;\n      m_vecChannelsOut : TArray0toRTMP_CHANNELS1OfPRTMPPacket;\n      m_channelTimestamp : TArray0toRTMP_CHANNELS1OfCint;\n      m_fAudioCodecs : double;\n      m_fVideoCodecs : double;\n      m_fEncoding : double;\n      m_fDuration : double;\n      m_msgCounter : cint;\n      m_polling : cint;\n      m_resplen : cint;\n      m_unackd : cint;\n      m_clientID : AVal;\n      m_read : RTMP_READ;\n      m_write : RTMPPacket;\n      m_sb : RTMPSockBuf;\n      Link : RTMP_LNK;\n    end;\n\n  PRTMP  = ^RTMP;\n  PRTMP_LNK  = ^RTMP_LNK;\n  PRTMP_READ  = ^RTMP_READ;\n  PRTMPSockBuf  = ^RTMPSockBuf;\n\n{RTMP Variables}\nvar\n    RTMPProtocolStringsLower : Array [0..6] of Pcchar;    //array[0..(RTMP_CHANNELS)-1]\n    RTMP_DefaultFlashVer : AVal;\n    RTMP_ctrlC : cint;\n    {RTMPProtocolStringsLower : TArray0to6OfPcchar; cvar; external;\n    RTMP_DefaultFlashVer : AVal;cvar;external;\n    RTMP_ctrlC : cint;cvar;external;}\n\n {AMF Functions}\nfunction AMF_EncodeString(output:pcchar; outend:pcchar; var str:AVal):pcchar;cdecl;external 'librtmp.dll' name 'AMF_EncodeString';  //LibRtmp = 'librtmp';\nfunction AMF_EncodeNumber(output:pcchar; outend:pcchar; dVal:double):pcchar;cdecl;external 'librtmp' name 'AMF_EncodeNumber';\nfunction AMF_EncodeInt16(output:pcchar; outend:pcchar; nVal:cshort):pcchar;cdecl;external 'librtmp' name 'AMF_EncodeInt16';\nfunction AMF_EncodeInt24(output:pcchar; outend:pcchar; nVal:cint):pcchar;cdecl;external 'librtmp' name 'AMF_EncodeInt24';\nfunction AMF_EncodeInt32(output:pcchar; outend:pcchar; nVal:cint):pcchar;cdecl;external 'librtmp' name 'AMF_EncodeInt32';\nfunction AMF_EncodeBoolean(output:pcchar; outend:pcchar; bVal:cint):pcchar;cdecl;external 'librtmp' name 'AMF_EncodeBoolean';\nfunction AMF_EncodeNamedString(output:pcchar; outend:pcchar; var name:AVal; var value:AVal):pcchar;cdecl;external 'librtmp' name 'AMF_EncodeNamedString';\nfunction AMF_EncodeNamedNumber(output:pcchar; outend:pcchar; var name:AVal; dVal:double):pcchar;cdecl;external 'librtmp' name 'AMF_EncodeNamedNumber';\nfunction AMF_EncodeNamedBoolean(output:pcchar; outend:pcchar; var name:AVal; bVal:cint):pcchar;cdecl;external 'librtmp' name 'AMF_EncodeNamedBoolean';\nfunction AMF_DecodeInt16(data:pcchar):cushort;cdecl;external 'librtmp' name 'AMF_DecodeInt16';\nfunction AMF_DecodeInt24(data:pcchar):cuint;cdecl;external 'librtmp' name 'AMF_DecodeInt24';\nfunction AMF_DecodeInt32(data:pcchar):cuint;cdecl;external 'librtmp' name 'AMF_DecodeInt32';\nprocedure AMF_DecodeString(data:pcchar; var str:AVal);cdecl;external 'librtmp' name 'AMF_DecodeString';\nprocedure AMF_DecodeLongString(data:pcchar; var str:AVal);cdecl;external 'librtmp' name 'AMF_DecodeLongString';\nfunction AMF_DecodeBoolean(data:pcchar):cint;cdecl;external 'librtmp' name 'AMF_DecodeBoolean';\nfunction AMF_DecodeNumber(data:pcchar):double;cdecl;external 'librtmp' name 'AMF_DecodeNumber';\nfunction AMF_Encode(var obj:AMFObject; pBuffer:pcchar; pBufEnd:pcchar):pcchar;cdecl;external 'librtmp' name 'AMF_Encode';\nfunction AMF_Decode(var obj:AMFObject; pBuffer:pcchar; nSize:cint; bDecodeName:cint):cint;cdecl;external 'librtmp' name 'AMF_Decode';\nfunction AMF_DecodeArray(var obj:AMFObject; pBuffer:pcchar; nSize:cint; nArrayLen:cint; bDecodeName:cint):cint;cdecl;external 'librtmp' name 'AMF_DecodeArray';\nfunction AMF3_Decode(var obj:AMFObject; pBuffer:pcchar; nSize:cint; bDecodeName:cint):cint;cdecl;external 'librtmp' name 'AMF3_Decode';\nprocedure AMF_Dump(var obj:AMFObject);cdecl;external 'librtmp' name 'AMF_Dump';\nprocedure AMF_Reset(var obj:AMFObject);cdecl;external 'librtmp' name 'AMF_Reset';\nprocedure AMF_AddProp(var obj:AMFObject; var prop:AMFObjectProperty);cdecl;external 'librtmp' name 'AMF_AddProp';\nfunction AMF_CountProp(var obj:AMFObject):cint;cdecl;external 'librtmp' name 'AMF_CountProp';\nfunction AMF_GetProp(var obj:AMFObject; var name:AVal; nIndex:cint):PAMFObjectProperty;cdecl;external 'librtmp' name 'AMF_GetProp';\nfunction AMFProp_GetType(var prop:AMFObjectProperty):AMFDataType;cdecl;external 'librtmp' name 'AMFProp_GetType';\nprocedure AMFProp_SetNumber(var prop:AMFObjectProperty; dval:double);cdecl;external 'librtmp' name 'AMFProp_SetNumber';\nprocedure AMFProp_SetBoolean(var prop:AMFObjectProperty; bflag:cint);cdecl;external 'librtmp' name 'AMFProp_SetBoolean';\nprocedure AMFProp_SetString(var prop:AMFObjectProperty; var str:AVal);cdecl;external 'librtmp' name 'AMFProp_SetString';\nprocedure AMFProp_SetObject(var prop:AMFObjectProperty; var obj:AMFObject);cdecl;external 'librtmp' name 'AMFProp_SetObject';\nprocedure AMFProp_GetName(var prop:AMFObjectProperty; var name:AVal);cdecl;external 'librtmp' name 'AMFProp_GetName';\nprocedure AMFProp_SetName(var prop:AMFObjectProperty; var name:AVal);cdecl;external 'librtmp' name 'AMFProp_SetName';\nfunction AMFProp_GetNumber(var prop:AMFObjectProperty):double;cdecl;external 'librtmp' name 'AMFProp_GetNumber';\nfunction AMFProp_GetBoolean(var prop:AMFObjectProperty):cint;cdecl;external 'librtmp' name 'AMFProp_GetBoolean';\nprocedure AMFProp_GetString(var prop:AMFObjectProperty; var str:AVal);cdecl;external 'librtmp' name 'AMFProp_GetString';\nprocedure AMFProp_GetObject(var prop:AMFObjectProperty; var obj:AMFObject);cdecl;external 'librtmp' name 'AMFProp_GetObject';\nfunction AMFProp_IsValid(var prop:AMFObjectProperty):cint;cdecl;external 'librtmp' name 'AMFProp_IsValid';\nfunction AMFProp_Encode(var prop:AMFObjectProperty; pBuffer:pcchar; pBufEnd:pcchar):pcchar;cdecl;external 'librtmp' name 'AMFProp_Encode';\nfunction AMF3Prop_Decode(var prop:AMFObjectProperty; pBuffer:pcchar; nSize:cint; bDecodeName:cint):cint;cdecl;external 'librtmp' name 'AMF3Prop_Decode';\nfunction AMFProp_Decode(var prop:AMFObjectProperty; pBuffer:pcchar; nSize:cint; bDecodeName:cint):cint;cdecl;external 'librtmp' name 'AMFProp_Decode';\nprocedure AMFProp_Dump(var prop:AMFObjectProperty);cdecl;external 'librtmp' name 'AMFProp_Dump';\nprocedure AMFProp_Reset(var prop:AMFObjectProperty);cdecl;external 'librtmp' name 'AMFProp_Reset';\nprocedure AMF3CD_AddProp(var cd:AMF3ClassDef; var prop:AVal);cdecl;external 'librtmp' name 'AMF3CD_AddProp';\nfunction AMF3CD_GetProp(var cd:AMF3ClassDef; idx:cint):PAVal;cdecl;external 'librtmp' name 'AMF3CD_GetProp';\n\n{RTMP Functions}\nprocedure RTMPPacket_Reset(var p:RTMPPacket);cdecl;external 'librtmp' name 'RTMPPacket_Reset';\nprocedure RTMPPacket_Dump(var p:RTMPPacket);cdecl;external 'librtmp' name 'RTMPPacket_Dump';\nfunction RTMPPacket_Alloc(var p:RTMPPacket; nSize:cint):cint;cdecl;external 'librtmp' name 'RTMPPacket_Alloc';\nprocedure RTMPPacket_Free(var p:RTMPPacket);cdecl;external 'librtmp' name 'RTMPPacket_Free';\nfunction RTMP_GetTime:uint32_t;cdecl;external 'librtmp' name 'RTMP_GetTime';\nfunction RTMP_ParseURL(url:pcchar; var protocol:cint; var host:AVal; var port:cuint; var playpath:AVal; \n           var app:AVal):cint;cdecl;external 'librtmp' name 'RTMP_ParseURL';\nprocedure RTMP_ParsePlaypath(var input:AVal; var output:AVal);cdecl;external 'librtmp' name 'RTMP_ParsePlaypath';\nprocedure RTMP_SetBufferMS(var r:RTMP; size:cint);cdecl;external 'librtmp' name 'RTMP_SetBufferMS';\nprocedure RTMP_UpdateBufferMS(var r:RTMP);cdecl;external 'librtmp' name 'RTMP_UpdateBufferMS';\nfunction RTMP_SetOpt(var r:RTMP; var opt:AVal; var arg:AVal):cint;cdecl;external 'librtmp' name 'RTMP_SetOpt';\nfunction RTMP_SetupURL(var r:RTMP; url:pcchar):cint;cdecl;external 'librtmp' name 'RTMP_SetupURL';\nprocedure RTMP_SetupStream(var r:RTMP; protocol:cint; var hostname:AVal; port:cuint; var sockshost:AVal; \n            var playpath:AVal; var tcUrl:AVal; var swfUrl:AVal; var pageUrl:AVal; var app:AVal; \n            var auth:AVal; var swfSHA256Hash:AVal; swfSize:uint32_t; var flashVer:AVal; var subscribepath:AVal; \n            dStart:cint; dStop:cint; bLiveStream:cint; timeout:clong);cdecl;external 'librtmp' name 'RTMP_SetupStream';\nfunction RTMP_Connect(var r:RTMP; var cp:RTMPPacket):cint;cdecl;external 'librtmp' name 'RTMP_Connect';\nfunction RTMP_Connect0(var r:RTMP; var svc:sockaddr):cint;cdecl;external 'librtmp' name 'RTMP_Connect0';\nfunction RTMP_Connect1(var r:RTMP; var cp:RTMPPacket):cint;cdecl;external 'librtmp' name 'RTMP_Connect1';\nfunction RTMP_Serve(var r:RTMP):cint;cdecl;external 'librtmp' name 'RTMP_Serve';\nfunction RTMP_ReadPacket(var r:RTMP; var packet:RTMPPacket):cint;cdecl;external 'librtmp' name 'RTMP_ReadPacket';\nfunction RTMP_SendPacket(var r:RTMP; var packet:RTMPPacket; queue:cint):cint;cdecl;external 'librtmp' name 'RTMP_SendPacket';\nfunction RTMP_SendChunk(var r:RTMP; var chunk:RTMPChunk):cint;cdecl;external 'librtmp' name 'RTMP_SendChunk';\nfunction RTMP_IsConnected(var r:RTMP):cint;cdecl;external 'librtmp' name 'RTMP_IsConnected';\nfunction RTMP_Socket(var r:RTMP):cint;cdecl;external 'librtmp' name 'RTMP_Socket';\nfunction RTMP_IsTimedout(var r:RTMP):cint;cdecl;external 'librtmp' name 'RTMP_IsTimedout';\nfunction RTMP_GetDuration(var r:RTMP):double;cdecl;external 'librtmp' name 'RTMP_GetDuration';\nfunction RTMP_ToggleStream(var r:RTMP):cint;cdecl;external 'librtmp' name 'RTMP_ToggleStream';\nfunction RTMP_ConnectStream(var r:RTMP; seekTime:cint):cint;cdecl;external 'librtmp' name 'RTMP_ConnectStream';\nfunction RTMP_ReconnectStream(var r:RTMP; seekTime:cint):cint;cdecl;external 'librtmp' name 'RTMP_ReconnectStream';\nprocedure RTMP_DeleteStream(var r:RTMP);cdecl;external 'librtmp' name 'RTMP_DeleteStream';\nfunction RTMP_GetNextMediaPacket(var r:RTMP; var packet:RTMPPacket):cint;cdecl;external 'librtmp' name 'RTMP_GetNextMediaPacket';\nfunction RTMP_ClientPacket(var r:RTMP; var packet:RTMPPacket):cint;cdecl;external 'librtmp' name 'RTMP_ClientPacket';\nprocedure RTMP_Init(var r:RTMP);cdecl;external 'librtmp' name 'RTMP_Init';\nprocedure RTMP_Close(var r:RTMP);cdecl;external 'librtmp' name 'RTMP_Close';\nfunction RTMP_Alloc:RTMP;cdecl;external 'librtmp' name 'RTMP_Alloc';\nprocedure RTMP_Free(var r:RTMP);cdecl;external 'librtmp' name 'RTMP_Free';\nprocedure RTMP_EnableWrite(var r:RTMP);cdecl;external 'librtmp' name 'RTMP_EnableWrite';\nfunction RTMP_LibVersion:cint;cdecl;external 'librtmp' name 'RTMP_LibVersion';\nprocedure RTMP_UserInterrupt;cdecl;external 'librtmp' name 'RTMP_UserInterrupt';\nfunction RTMP_SendCtrl(var r:RTMP; nType:cshort; nObject:cuint; nTime:cuint):cint;cdecl;external 'librtmp' name 'RTMP_SendCtrl';\nfunction RTMP_SendPause(var r:RTMP; DoPause:cint; dTime:cint):cint;cdecl;external 'librtmp' name 'RTMP_SendPause';\nfunction RTMP_Pause(var r:RTMP; DoPause:cint):cint;cdecl;external 'librtmp' name 'RTMP_Pause';\nfunction RTMP_FindFirstMatchingProperty(var obj:AMFObject; var name:AVal; var p:AMFObjectProperty):cint;cdecl;external 'librtmp' name 'RTMP_FindFirstMatchingProperty';\nfunction RTMPSockBuf_Fill(var sb:RTMPSockBuf):cint;cdecl;external 'librtmp' name 'RTMPSockBuf_Fill';\nfunction RTMPSockBuf_Send(var sb:RTMPSockBuf; buf:pcchar; len:cint):cint;cdecl;external 'librtmp' name 'RTMPSockBuf_Send';\nfunction RTMPSockBuf_Close(var sb:RTMPSockBuf):cint;cdecl;external 'librtmp' name 'RTMPSockBuf_Close';\nfunction RTMP_SendCreateStream(var r:RTMP):cint;cdecl;external 'librtmp' name 'RTMP_SendCreateStream';\nfunction RTMP_SendSeek(var r:RTMP; dTime:cint):cint;cdecl;external 'librtmp' name 'RTMP_SendSeek';\nfunction RTMP_SendServerBW(var r:RTMP):cint;cdecl;external 'librtmp' name 'RTMP_SendServerBW';\nfunction RTMP_SendClientBW(var r:RTMP):cint;cdecl;external 'librtmp' name 'RTMP_SendClientBW';\nprocedure RTMP_DropRequest(var r:RTMP; i:cint; freeit:cint);cdecl;external 'librtmp' name 'RTMP_DropRequest';\nfunction RTMP_ReadData(var r:RTMP; buf:pcchar; size:cint):cint;cdecl;external 'librtmp' name 'RTMP_ReadData';\nfunction RTMP_WriteData(var r:RTMP; buf:pcchar; size:cint):cint;cdecl;external 'librtmp' name 'RTMP_WriteData';\nfunction RTMP_HashSWF(url:pcchar; var size:cuint; hash:pcuchar; age:cint):cint;cdecl;external 'librtmp' name 'RTMP_HashSWF';\n\nimplementation\n\n\nend.\n</code></pre>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":5,"up_vote_count":3,"down_vote_count":1,"view_count":698,"score":2,"question_id":6225787,"title":"Slider (on/off) style component similar to iPad","body":"<p>Anyone knows of a On/off Delphi component similar to the slider control found on the iPad?</p>\n\n<p>TAdvSmoothSlider (http://www.tmssoftware.com/site/advsmoothslider.asp) is the only one I found so far, but I would prefer not to have to purchase/install the entire TMS Smooth Controls Pack.</p>\n\n<p>Anyone knows of a similar component? I already have On/Off images in png format so a component based on png images would also work.</p>\n\n<p>Thanks in advance for any replies/ideas.</p>\n\n<p><img src=\"http://i.stack.imgur.com/iHqWu.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":159,"score":5,"question_id":12807687,"title":"sum value of selected cells in stringgrid","body":"<p>How can I get the sum value of the selected cells or a range in <code>stringgrid</code>? Please note that  sometimes these cells contain string values!</p>\n\n<p>I try <code>GridCoord</code>, but it doesn't work good because sometimes there are \"hidden columns\". </p>\n\n<pre><code>procedure TMainShowForm.StgSelectionChanged(Sender: TObject; ALeft, ATop,\n ARight, ABottom: Integer);\nvar\ni: Integer;\ngc: TGridCoord;\nsum:double;\nbegin\n  for i := 1 to stg.SelectedCellsCount do\n    begin\n      gc := stg.SelectedCell[i - 1];\n      sum:=sum+stg.floats[(gc.X),(gc.Y)];\n    end;\n  AdvOfficeStatusBar1.Panels[0].Text:='Sum = '+ formatfloat('#,##0.',sum);\n  AdvOfficeStatusBar1.Panels[1].Text:='Count = '+ inttostr(stg.SelectedCellsCount);\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-xe2","rtmp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":101,"score":-4,"question_id":12814559,"title":"Record the stream by calling the library LIBRTMP Delphi","body":"<pre><code>var\n  MY_RTMP: RTMP;\n  URL_str: AnsiString;\nbegin\n  URL_str: = 'rtmp :/ / localhost: 1935/Video/test.stream';\n  MY_RTMP: = RTMP_Alloc;\n  RTMP_Init (MY_RTMP);\n  RTMP_SetupURL (MY_RTMP, pcchar (URL_str));\n  RTMP_Connect (MY_RTMP, 0);\n  RTMP_ConnectStream (MY_RTMP, 0);\nend;\n</code></pre>\n\n<p>Error RTMP_Connect (MY_RTMP, 0); - [DCC Error] fMain.pas (36): E2033 Types of actual and formal var parameters must be identical\nthanks in advance</p>\n"},{"tags":["delphi","numbers"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":7,"view_count":1370,"score":-5,"question_id":9968707,"title":"How do I convert a positive number to negative?","body":"<p>How do I convert a positive Integer to a negative with Delphi? I know you could use <code>ABS(int)</code> to convert a negative to a positive, but I need it to convert positive to negative.</p>\n"},{"tags":["delphi","port","ole","forwarding"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":112,"score":1,"question_id":12805067,"title":"Port Forwarding by Using \"HNetCfg.NATUPnP\" Ole Object Failed","body":"<p>I am using a code for forwarding a port. this code works fine on My Windows 7; but I can't use It on Windows XP.</p>\n\n<p><strong>Update 1 For Problem(2012-10-17 07:32:00Z)</strong></p>\n\n<p>This is my source code:</p>\n\n<pre><code>uses\n  ActiveX, oleAuto;\n\nProcedure AddUPnPEntry(Port: Integer; const Name: ShortString; LAN_IP: string);\nVar\n  Nat: Variant;\n  Ports: Variant;\n  SavedCW: Word;\nBegin\n  if NOT(LAN_IP = '127.0.0.1') then\n  begin\n    try\n      Nat := CreateOleObject('HNetCfg.NATUPnP');\n      Ports := Nat.StaticPortMappingCollection;\n\n      // Error Raized From Here!!!\n      ShowMessage(inttostr(Ports.count));\n\n      Ports.Add(Port, 'TCP', Port, LAN_IP, True, name);\n    except\n      ShowMessage('An Error occured with adding UPnP Ports. The ' + name +\n        ' port was not added to the router. Please check to see if  your ' +\n        'router supports UPnP and has it enabled or disable UPnP.');\n    end;\n  end;\nEnd;\n\nprocedure TForm1.Button2Click(Sender: TObject);\nbegin\n  AddUPnPEntry(1234, 'Hello3', '192.168.1.1');\nend;\n</code></pre>\n\n<p>AV Error Message:</p>\n\n<pre><code>Project Project1.exe raised exception class $C0000005 with message 'access violation at 0x00504876: read of address 0x00000000'.\n</code></pre>\n"},{"tags":["delphi","function-pointers"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":169,"score":3,"question_id":12791258,"title":"Delphi: working with Pointer functions","body":"<p>I'm new in delphi, my program developed in delphi working with a dll developed in C++, I need working with pointer functions that throw exceptions of  Access Violation address and after many test  I don't know  how resolve It.</p>\n\n<p>this is defintion of the pointer function in delphi that translate since header c++ </p>\n\n<pre><code>type\n  TMICRCallback   = function: Integer of Object;  stdcall;\n  TStatusCallback = function(dwParam: Cardinal): Integer of Object; stdcall;\n\n  type\n   TBiMICRSetReadBackFunction =\n      function(const nHande:        Integer;\n               pMicrCB:             TMICRCallback;\n               var pReadBuffSize:    Byte;\n               var readCharBuff:     Byte;\n               var pStatus:          Byte;\n               var pDetail:          Byte\n      ): Integer; stdcall;\nvar\n   BiMICRSetReadBackFunction: TBiMICRSetReadBackFunction;\n\ntype\n   TBiMICRSetReadBackFunction =\n      function(const nHande:        Integer;\n               pMicrCB:             TMICRCallback;\n               var pReadBuffSize:    Byte;\n               var readCharBuff:     Byte;\n               var pStatus:          Byte;\n               var pDetail:          Byte\n      ): Integer; stdcall;\nvar\n   BiMICRSetReadBackFunction: TBiMICRSetReadBackFunction;\n</code></pre>\n\n<hr>\n\n<p>this is a code that call the pointer functions</p>\n\n<pre><code>type\n  function CBMICRRead : Integer; stdcall;\n  function CBMICRStatus(dwStatus: LongWord) : Integer;  stdcall;\n\n\n  Respuesta      : TMICRCallback;\n  Estado         : TStatusCallback;\n\n  BiSetStatusBackFunction(m_hApi, Estado);\n\n BiMICRSetReadBackFunction (m_hApi,\n                                    Respuesta,\n                                    m_MICRReadBuffSize,\n                                    m_MICRReadBuff[0],\n                                    m_MICRReadStatus,\n                                    m_MICRReadStDetail); \n</code></pre>\n\n<hr>\n\n<p>This is the C++ side of the interface:</p>\n\n<pre><code>typedef int (CALLBACK* MICRCallback)(void);\ntypedef int (CALLBACK* StatusCallback)(DWORD);\n\n\nint WINAPI BiSetStatusBackFunction(int  nHandle,\n                               int (CALLBACK *pStatusCB)(DWORD dwStatus));\n\nint WINAPI BiMICRSetReadBackFunction(int    nHandle, \n                                     int    (CALLBACK *pMicrCB)(void),\n                                     LPBYTE pReadBuffSize,   \n                                     LPBYTE readCharBuff,    \n                                     LPBYTE pStatus,         \n                                     LPBYTE pDetail);        \n</code></pre>\n"},{"tags":["delphi","gmail","indy"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1522,"score":0,"question_id":5618310,"title":"Sending message to gmail fails with \"Start SSL negotiation command failed.\" error","body":"<p>Tips i followed is found <a href=\"http://blog.marcocantu.com/blog/tip_indy_gmail.html\" rel=\"nofollow\">here</a>.</p>\n\n<p>I do have libeay32.dll and ssleay32.dll in win32 folder.</p>\n\n<p>dfm file:</p>\n\n<pre><code>object tidSMTP: TIdSMTP\n    IOHandler = tidSMTP_SSL\n    SASLMechanisms = &lt;&gt;\n    UseTLS = utUseExplicitTLS\n  end\n  object tidSMTP_SSL: TIdSSLIOHandlerSocketOpenSSL\n    Destination = 'smtp.gmail.com:587'\n    Host = 'smtp.gmail.com'\n    MaxLineAction = maException\n    Port = 587\n    DefaultPort = 0\n    SSLOptions.Mode = sslmUnassigned\n    SSLOptions.VerifyMode = []\n    SSLOptions.VerifyDepth = 0\n  end\n</code></pre>\n\n<p>and Send button click event:</p>\n\n<pre><code>procedure TForm1.btnSendClick(Sender: TObject);\nvar\n  mes:TIdMessage;\n  fromAddress:TIdEmailAddressItem;\n  toAddress:TIdEMailAddressItem;\nbegin\n  tidSMTP.Username := txtUsername.Text;\n  tidSMTP.Password := txtPassword.Text;\n  tidSMTP.Host := txtSMTPserver.Text;           //smtp.gmail.com\n  tidSMTP.Port := StrToInt(txtSMTPport.Text);   //587\n\n  fromAddress := TIdEMailAddressItem.Create;\n  fromAddress.Address := txtUsername.Text;\n\n  toAddress := TIdEMailAddressItem.Create;\n  toAddress.Address := txtTo.Text;\n\n  mes := TIdMessage.Create;\n  mes.ContentType := 'text/plain';\n  mes.From := fromAddress;\n  mes.ReceiptRecipient := toAddress;\n  mes.Subject := txtSubject.Text;\n\n  mes.Body := memoText.Lines;\n\n  tidSMTP.Connect;\n  tidSMTP.Send(mes);\n  tidSMTP.Disconnect;\nend;\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"},{"tags":["delphi","ssl","openssl","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":670,"score":0,"question_id":6539526,"title":"Indy TIdSSLIOHandlerSocketOpenSSL - it works on my PC, not on my friend's","body":"<p>My application is using <code>TIdHTTP.Get</code> to access ClickBank's API. In order for that to work, I have to assign a <code>TIdSSLIOHandlerSocketOpenSSL</code> to the <code>TIdHTTP.IOHandler</code>.</p>\n\n<p>The problem is, that the above setup works fine on my PC (the dev box), however when I send it out to my friends, they get the Forbidden (403) error.</p>\n\n<p>Could it be that they are missing the OpenSSL libaries? I did a search on my PC, and a bunch of apps that my buddys have, includes SLL libraries.</p>\n\n<p>Am I missing something?</p>\n"},{"tags":["delphi","binary","registry"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":125,"score":-3,"question_id":12811340,"title":"How to Write Binary Data into Registry?","body":"<p>In Win7 RegEdit  edit or view a binary just like 1A 2B 3C 4D \nnow I get a string </p>\n\n<pre><code>str := '1A,2B,3C,4D';\n</code></pre>\n\n<p>how to write str into  Registry , and in Win7 RegEdit it display  1A 2B 3C 4D </p>\n"},{"tags":["delphi","cross-application"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":508,"score":2,"question_id":6394300,"title":"Create Button on other application window","body":"<p>I wrote below code to create an extra button on Calculator, but the button don't show:</p>\n\n<pre><code>var\n  Object1 : TButton ;\n  Hand: THandle;\nbegin\n   Hand:= FindWindow('CalcFrame', 'Calculator');\n   Object1 := TButton.CreateParented(Hand);\n   Object1.Show ;\nend;\n</code></pre>\n\n<p>I get the controls on the calculator after running the above code using EnumChildWindow API function and see the created button in control list that EnumChildWindow returns, but why does the created button not show ?</p>\n\n<p>As I remember I use this code on windows XP and it works without problem but now in windows 7 the created button doesn't appear.</p>\n"},{"tags":["delphi","interface","combobox","delphi-2006"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":108,"score":3,"question_id":12788670,"title":"How to Fix the TComboBox Ctl3D Property Bug?","body":"<p>This is an image from a <code>TForm</code> where I have a <code>TEdit</code> at top and a <code>TComboBox</code> at down.</p>\n\n<p><img src=\"http://i.stack.imgur.com/IB6pA.png\" alt=\"enter image description here\"></p>\n\n<p>As you can see, the TEdit does not have the classic 3D border of the Windows controls default theme. That's because I set the <code>Ctl3D property</code> of that component to <code>False</code>. Then you see that the TComboBox has it's normal 3D border, but in this case I also set the <code>Ctl3D property</code> of that component to <code>False</code>, but it continues to show the 3D border.</p>\n\n<p>It seems to be a Delphi bug at development level. How could I fix that at code?</p>\n\n<hr>\n\n<p>After testing RRUZ answer, <code>BevelKind=bkFlat</code>, this came:</p>\n\n<p><img src=\"http://i.stack.imgur.com/uA0e7.png\" alt=\"enter image description here\"></p>\n\n<p>I do not know why it was so different... and bizarre. :-/</p>\n"},{"tags":["delphi","delphi-7","omnixml"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":256,"score":1,"question_id":7594992,"title":"How to delete a child node using OmniXML?","body":"<p>I'd like to delete the line with <code>pathid=\"2\"</code> in the <code>rowpath</code> section...  </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;LostPath Condition=\"Active\" Selected=\"train.exe\" FullPathOfSelected=\"D:\\mygames\\arcade\\train\\\" Selected=\"0\"&gt;\n  &lt;rowdir Name=\"train.exe\" GamePath=\"D:\\mygames\\arcade\\train\\\" Selected=\"0\" /&gt;\n  &lt;rowdir Name=\"othelo.exe\" GamePath=\"D:\\mygames\\arcade\\othello\\\" Selected=\"3\"/&gt;\n  &lt;rowpath Name=\"train.exe\" PathId=\"1\" LevelPath=\"D:\\mygames\\arcade\\train\\levelpack1\" levelsFound=\"27\" /&gt;\n  &lt;rowpath Name=\"train.exe\" PathId=\"2\" LevelPath=\"D:\\mygames\\arcade\\train\\levelpack21\" levelsFound=\"19\" /&gt;\n  &lt;rowpath Name=\"othelo.exe\" PathId=\"0\" LevelPath=\"D:\\mygames\\arcade\\othelo\\levelpack1\" levelsFound=\"11\" /&gt;\n&lt;/LostPath&gt;\n</code></pre>\n\n<p>How can I do that ?</p>\n"},{"tags":["windows","delphi","winapi","harddrive"],"answer_count":2,"favorite_count":4,"up_vote_count":8,"down_vote_count":2,"view_count":459,"score":6,"question_id":8733457,"title":"How to programatically prevent Windows from hard disk drive spin down?","body":"<p>My program performs a task on the hard disk free space.\nThe task is quite long, <strong>it takes 1-2 hours</strong>.</p>\n\n<p>The problem is that on laptop the hard disk may be turned off after few minutes when the user is inactive.</p>\n\n<p><strong>How do I programmatically prevent Windows from hard disk spin down (power off) ?</strong></p>\n"},{"tags":["delphi","delphi-xe2","indy10","last.fm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":140,"score":2,"question_id":12808777,"title":"UTF-8 GET using Indy 10.5.8.0 and Delphi XE2","body":"<p>I'm writing my first Unicode application with Delphi XE2 and I've stumbled upon an issue with GET requests to an Unicode URL. Shortly put, it's a routine in a MP3 tagging application that takes a track title and an artist and queries Last.FM for the corresponding album, track no and genre.</p>\n\n<p>I have the following code: </p>\n\n<pre><code>function GetMP3Info(artist, track: string) : TMP3Data //&lt;---(This is a record)\nvar\n  TrackTitle,\n  ArtistTitle : WideString;\n  webquery    : WideString;\n\n[....]\n\nWebQuery := UTF8Encode('http://ws.audioscrobbler.com/2.0/?method=track.getcorrection&amp;api_key=' + apikey + '&amp;artist=' + artist + '&amp;track=' + track);\n\n//[processing the result in the web query, getting the correction for the artist and title]\n\n// eg: for artist := Bucovina and track := Mestecanis, the corrected values are \n//ArtistTitle := Bucovina;\n// TrackTitle := Mestecăniș;\n\n//Now here is the tricky part:\n\nwebquery := UTF8Encode('http://ws.audioscrobbler.com/2.0/?method=track.getInfo&amp;api_key=' + apikey + '&amp;artist=' + unescape(ArtistTitle) + '&amp;track=' + unescape(TrackTitle)); \n//the unescape function replaces spaces (' ') with '+' to comply with the last.fm requests\n\n[some more processing]\n\nend;\n</code></pre>\n\n<p>The webquery looks in a TMemo just right (http://ws.audioscrobbler.com/2.0/?method=track.getInfo&amp;api_key=e5565002840xxxxxxxxxxxxxx23b98ad&amp;artist=Bucovina&amp;track=Mestecăniș)</p>\n\n<p>Yet, when I try to send a <code>GET()</code> to the webquery using IdHTTP (with the ContentEncoding property set to 'UTF-8'), I see in Wireshark that the component is GET-ing the data to the ANSI value '/2.0/?method=track.getInfo&amp;api_key=e5565002840xxxxxxxxxxxxxx23b98ad&amp;artist=Bucovina&amp;track=Mestec?ni?'</p>\n\n<p>Here is the full headers for the GET requests and responses:</p>\n\n<pre><code>GET /2.0/?method=track.getInfo&amp;api_key=e5565002840xxxxxxxxxxxxxx23b98ad&amp;artist=Bucovina&amp;track=Mestec?ni? HTTP/1.1\n\nContent-Encoding: UTF-8\n\nHost: ws.audioscrobbler.com\n\nAccept: text/html, */*\n\nAccept-Encoding: identity\n\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.23) Gecko/20110920 Firefox/3.6.23 SearchToolbar/1.22011-10-16 20:20:07\n\n\n\nHTTP/1.0 400 Bad Request\n\nDate: Tue, 09 Oct 2012 20:46:31 GMT\n\nServer: Apache/2.2.22 (Unix)\n\nX-Web-Node: www204\n\nAccess-Control-Allow-Origin: *\n\nAccess-Control-Allow-Methods: POST, GET, OPTIONS\n\nAccess-Control-Max-Age: 86400\n\nCache-Control: max-age=10\n\nExpires: Tue, 09 Oct 2012 20:46:42 GMT\n\nContent-Length: 114\n\nConnection: close\n\nContent-Type: text/xml; charset=utf-8;\n\n\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;lfm status=\"failed\"&gt;\n&lt;error code=\"6\"&gt;\n    Track not found\n&lt;/error&gt;\n&lt;/lfm&gt;\n</code></pre>\n\n<p>The question that puzzles me is am I overseeing anything related to setting the property of the <a href=\"/questions/tagged/tidhttp\" class=\"post-tag\" title=\"show questions tagged 'tidhttp'\" rel=\"tag\">tidhttp</a> control? How can I stop the well-formated URL i'm composing in the application from getting wrongfully sent to the server?</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","exception","web-applications","delphi-xe","standalone"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12805832,"title":"Error in module: Uses clause is missing or incorrect","body":"<p>I am trying to create a web server application under RAD Studio Delphi XE. </p>\n\n<p>When I click on <code>New -&gt; others</code>. I get a dialog window with options. I choose VCL for the Web. Then, I get another dialog window with \"standalone application\" and \"ISAPI\" options. </p>\n\n<p>If I choose standalone application option, the compiler doesn't have any problem, but if I choose ISAPI, I get the \"error in module: Uses clause is missing or incorrect\" exception even before it creates the project.</p>\n\n<p>Does anyone know why and how to resolve this problem?</p>\n"},{"tags":["delphi","find","compare","tstringlist"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":165,"score":2,"question_id":12796684,"title":"Delphi: TStringList.Contains?","body":"<p>Is there any integrated solution in Delphi 2007 to check whether a TStringList <b>contains</b> a part of a certain value?</p>\n\n<p>e.g.: </p>\n\n<pre><code>List.AddObject('This is a string', customStringObject1); \nList.AddObject('This is a mushroom', customStringObject2); \nList.AddObject('Random stuff', customStringObject3); \n</code></pre>\n\n<p>Searching for <i>\"This is a\"</i> is supposed to deliver me \"true\", since the first two elements contain this partwise.</p>\n\n<p>The only method i'm aware of so far is <code>TStringList.find(string,integer)</code>, but this performs a complete string comparision, i.e. only searching for <i>This is a string</i> will return true.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["delphi","msbuild"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":126,"score":2,"question_id":12758800,"title":"MSBuild and multiple Delphi versions","body":"<p>I have a project for which I need to build two executables: one under Delphi XE2 and one under XE3. I have a build script which builds each version (i.e. one script for XE2 and one for XE3).</p>\n\n<p>If I run the build script for the last version of the IDE I ran, all works well (i.e. run Delphi XE2, build app, run XE2 build script).</p>\n\n<p>However if I run the build script having just run a different version of the IDE I get an AV as soon as my app starts (I.e. run Delphi XE2, built app, run XE3 build script).</p>\n\n<p>It looks as though something about the build script is being cached/modified by the IDE and I need to restore the appropriate data for the version I want to build with. I've tried this with the .dproj, but no luck.</p>\n\n<p>Or could it be loading form resources - both editions show errors due to non-existent properties at start up if the IDE. If so, is there an easy way around this without having maintain multiple versions of all the .fmx files?</p>\n\n<p>Here's a sample build script:</p>\n\n<pre><code>set path=%path%;c:\\Windows\\Microsoft.NET\\Framework\\v3.5\nset path=%path%;c:\\Program Files (x86)\\Embarcadero\\RAD Studio\\10.0\nset path=%path%;c:\\Documents and Settings\\All Users\\Documents\\RAD Studio\\10.0\nset BDS=c:\\Program Files (x86)\\Embarcadero\\RAD Studio\\10.0\nset FrameworkDir=c:\\Windows\\Microsoft.NET\\Framework\\\nset FrameworkVersion=v3.5\n\nset failed=false\ncd \\myprogs\\monkeystyler\nmsbuild monkeystyler.dproj /t:build /p:config=full||set failed=true\ncd build\nif not %failed%==true goto Done\n\necho ****FAILED TO BULD MONKEYSTYLER\n****\nPause\nexit\n\n:done\n</code></pre>\n"},{"tags":["delphi","winapi","windows-7","delphi-2009","delphi-xe3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":157,"score":2,"question_id":12807758,"title":"Why does a combo box change its text to an item text at font change?","body":"<p>It's obviously a bug, but I cannot track down why happens. Here is a minimalistic code to reproduce. Just drop a combo box and button on a form and write the following event handlers:</p>\n\n<pre><code>procedure TForm1.FormCreate(Sender: TObject);\nbegin\n  ComboBox1.Items.Add('A Item');\n  ComboBox1.Items.Add('B Item');\n  ComboBox1.Items.Add('C Item');\n  ComboBox1.Style := csDropDown;\n  ComboBox1.AutoComplete := False;\nend;\n\nprocedure TForm1.Button1Click(Sender: TObject);\nbegin\n  ComboBox1.Text := 'B';\n  ComboBox1.Font.Color := clRed;\n  ShowMessage(IntToStr(ComboBox1.ItemIndex));\nend;\n</code></pre>\n\n<p>When you click the button for the first time, you will see in the combo edit fully selected text of the second item, but message box will show you the item index equals to -1. When you drop down it, the second item seems to be selected. The second click will set the proper text though, but the rest will be the same as at the first click. So, combo box in this case behaves like if some weird autocompletion would be enabled. </p>\n\n<p>I've tracked this down to the <code>EditWndProc</code> where after font change is received <code>WM_SETTEXT</code> message with the text of the second item, but I don't know where it comes from and why with the text of the second item.</p>\n\n<p>So, my question is quite specific - what (which method) sends the <code>WM_SETTEXT</code> at font change and how does it know about second item text match when the autocompletion is disabled ?</p>\n\n<p>So far I could reproduce this in Delphi 2009 and Delphi XE3 on Windows 7 Home Premium 64-bit with the most recent updates installed.</p>\n"},{"tags":["windows","delphi","registry"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":247,"score":5,"question_id":12485427,"title":"How to Read/Write Windows 7 Library Locations?","body":"<p><strong>Intro</strong></p>\n\n<p>In Windows 7 you have some special folders for documents, pictures and music etc called Libraries.</p>\n\n<p>If you are not aware of them, basically each Library folder can contain Locations (paths) which are basically shortcuts for each Library.</p>\n\n<p><strong>Some examples:</strong></p>\n\n<p><code>Documents (Library)</code></p>\n\n<ul>\n<li>E:\\Personal\\Documents <code>(Location)</code></li>\n<li>F:\\Backups\\Documents <code>(Location)</code></li>\n</ul>\n\n<p><code>Music (Library)</code></p>\n\n<ul>\n<li>E:\\Media\\Music\\Albums <code>(Location)</code></li>\n<li>E:\\Media\\Music\\Singles <code>(Location)</code></li>\n</ul>\n\n<p><code>Pictures (Library)</code></p>\n\n<ul>\n<li>E:\\Media\\Photos <code>(Location)</code></li>\n</ul>\n\n<p>When you click any of these Library folders from Windows Explorer or Start menu, Windows Explorer will show with the Locations defined inside that Library.</p>\n\n<p><strong>Task</strong></p>\n\n<p>What I need to be able to do is read the Locations for each Library type, and be able to write back (update) the Library with my own Locations. I have found that the Libraries are stored in the user AppData folder like this:</p>\n\n<p><code>C:\\Users\\SOMEUSER\\AppData\\Roaming\\Microsoft\\Windows\\Libraries</code></p>\n\n<p>These Libraries are this file type: <strong>Library (.library-ms)</strong> - if you right click on one and select properties, Library tab you can see the Library locations associated with that Library.</p>\n\n<p>I don't see a way of extracting these and putting them for example into a TStringList for editing in Delphi. I wondered if these Library Locations were actually stored in the Windows Registry so with some research from Google I found these paths:</p>\n\n<ul>\n<li>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</li>\n<li>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</li>\n</ul>\n\n<p>But again, I don't see the actual list of Library Locations.</p>\n\n<p>So, how can I read the list of Locations inside a Library file in Delphi, add them to a Listbox or TStringList, edit the entries and then write back the changes? Just been able to extract the Library Location paths would be a start.</p>\n\n<p>I just have a feeling this is going to be one of those questions that has a simple answer I cannot seem to find!</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":5,"favorite_count":6,"up_vote_count":11,"down_vote_count":0,"view_count":9813,"score":11,"question_id":1369191,"title":"What is the compiler version for Delphi 2010?","body":"<p>In Delphi 2010, if I want to do this:</p>\n\n<pre><code>{$IFDEF VER999}\n//some delphi 2010-specific code here\n{$ENDIF}\n</code></pre>\n\n<p>What version # do I need to use in place of \"999\"?</p>\n"},{"tags":["delphi","firemonkey","tscrollbox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12730647,"title":"Using TScrollBox to Contain TExpander components","body":"<p>Well i have one scrollbox aligned to left of my form, inside the scrollbox i have TExpander components aligned to Top, this expanders exceed the area of the scrollbox so i guess the scrollbars must be visibles but they aren't. \nI think the problem is with the aligned on top of the Texpanders because if i change the alignment of the Texpander ho are exceeding the margins of the scrollbox to alNone the scrollbars apear, but i need to have the Texpander aligned on top because his constatly size changing. Any ideas? \nThanks a lot!</p>\n"},{"tags":["delphi","function","pointers","compiler-errors"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":110,"score":1,"question_id":12804039,"title":"\"Incompatible types: method pointer and regular procedure\"","body":"<p>I have a big problem because i dont understand how the pointers really work in delphi </p>\n\n<p>First I take a function declaration from a dll.</p>\n\n<p>FUNCTION:</p>\n\n<pre><code>type\n  TMICRCallback   = function: Integer; stdcall;\n</code></pre>\n\n<p>Then I declare a Function in my code.</p>\n\n<pre><code>function CBMICRRead : Integer;stdcall;\n</code></pre>\n\n<p>The Function its really simple (This is an example)</p>\n\n<pre><code>function TCustomizedTenderPlugin.CBMICRRead : Integer; stdcall;\nvar\n  SUCCESS:integer;\nbegin\n   SUCCESS:=1;\n   Result:= SUCCESS;\nend;\n</code></pre>\n\n<p>I declare a varible like this </p>\n\n<pre><code>Respuesta : TMICRCallback;\n</code></pre>\n\n<p>when i try to assign this variable to my function the problem happens :(</p>\n\n<pre><code>Respuesta      := CBMICRRead;\n</code></pre>\n\n<p>This is my first time using pointers in delphi so maybe its a dumb question but please help me </p>\n"},{"tags":["delphi","background","delphi-xe","background-color","tchromium"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":383,"score":1,"question_id":8645814,"title":"How to change default background color for TChromium component?","body":"<p>I use <a href=\"http://code.google.com/p/delphichromiumembedded/\" rel=\"nofollow\"><code>TChromium</code></a>. I assign <code>AWebPageAsString</code> which is a static HTML page with a gray background color.</p>\n\n<pre><code>FBrowser := TChromium.Create(pnlHolder);\nFBrowser.Visible := false;\nFBrowser.Parent := TWinControl(pnlHolder);\nFBrowser.Align := alClient;\nFBrowser.OnBeforeBrowse := BrowserBeforeBrowse;\nFBrowser.HandleNeeded;\nFBrowser.FontOptions.RemoteFontsDisabled := true;\nFBrowser.Browser.MainFrame.LoadString(AWebPageAsString, 'navigate:webpage');\n</code></pre>\n\n<p>When I start the application it is displayed first with white background and empty content and then my page gets displayed with gray background and actual content.</p>\n\n<p>Is there a way to avoid this ? Maybe have a default background color ?</p>\n"},{"tags":["delphi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12803286,"title":"Cancel Edit Mode when multiselecting rows in TAdvStringGrid","body":"<p>Whenever user expands selection from already clicked cell (cell is editable) then the initial cell content is cleared out (becomes empty) for the time of cells selection.</p>\n\n<p>My suspicion is that if I cancel out from the edit mode on multiselect, then the issue will be fixed. </p>\n\n<p>Is there a TAdvStringGrid event that I can tap to, to cancel Edit Mode when user selects multiple rows?</p>\n\n<p>I have found two events that I thought maybe useful: OnSelectionResized and OnSelectionResize. However, neither of those is triggered upon multiselecting rows.</p>\n"},{"tags":["delphi","windows-vista","printing"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":555,"score":2,"question_id":3706108,"title":"Reading and writting DEVMODE.dmColor","body":"<p>I'm having trouble with the dmColor field fo the DEVMODE structure.  </p>\n\n<p>My default printer is a color printer, if I default output color of the printer properties through the control panel to black and white the DEVMODE.dmColor field always returns DMCOLOR_COLOR instead of DMCOLOR_MONOCHROME.</p>\n\n<p>Even if I default my printer to a black and white only printer, DEVMODE.dmColor still always returns DMCOLOR_COLOR</p>\n\n<p>All of the other DEVMODE fields such as dmDeviceName, dmCopies, dmDuplex, etc work fine.  I have also tried to query DC_COLORDEVICE using the DeviceCapabilities function, microsoft documentation says it should return 1 if the device supports color, 0 if it does not and -1 if an error occured.  This function is always returning -1 but the error code returned by GetLastError translates to \"The operation completed successfully\".  </p>\n\n<p>I'm running under windows Vista and I have specified DM_COLOR in DEVMODE.dmFields, does anyone know why this happens?</p>\n\n<p>Thank you.</p>\n"},{"tags":["delphi","anchor","firemonkey"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":933,"score":2,"question_id":7439927,"title":"How do you set a control anchor with FireMonkey?","body":"<p>FireMonkey controls do not appear to have anchor properties as do VCL controls. How do I make FireMonkey controls automatically adjust when the form resizes?</p>\n"},{"tags":["delphi","ide","styles","vcl","delphi-xe3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":177,"score":1,"question_id":12794973,"title":"Fix VCL Styles Directory in Delphi XE3","body":"<p>I have a problem about VCL Styles in Delphi IDE.\nWhen I change VCL Style From default style to another style in delphi IDE and run program an \"Style 'Style Name' not found\" error comes up. I trying to find a option in IDE to fix Style directory, but I can't find any options. \nPlease, help me to solve this problem and fixing IDE Options.\nthanx a lot.</p>\n"},{"tags":["delphi","sqlite","components"],"answer_count":7,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":9576,"score":5,"question_id":850435,"title":"Delphi components to use with SQlite","body":"<p>What components can I use to use SQlite database with delphi 6\nThanks</p>\n"},{"tags":["delphi","pascal","freepascal"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":245,"score":8,"question_id":12781434,"title":"Why Delphi and FPC usually prefer signed-integer data type to unsigned one?","body":"<p>I'm not a Pascal newbie, but I still don't know until now why Delphi and FPC usually declares parameters and returned values as a signed integer whereas I see them should always be positive. For example:</p>\n\n<ul>\n<li><code>Pos()</code> returns type of Integer. Is it possible to be a negative?</li>\n<li><code>SetLength()</code> declares the <code>NewLength</code> parameter as a type of Integer. Is there a negative length for string?</li>\n<li><code>System.THandle</code> declared as Longint. Is there a negative number for handles?</li>\n</ul>\n\n<p>There are many decisions like those in Delphi and FPC. What considerations they thought were?</p>\n"},{"tags":["xml","delphi","xpath","pascal","txmldocument"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":12797186,"title":"Selecting Multiple XML Nodes from a document and then displaying in a TListbox Delphi","body":"<p>i have used IXMLDocument in delphi to create an XML File, i need to access the text value on each of the nodes called Manufacturer and display the results in a TListBox when Button1 is Clicked.</p>\n\n<p>Here is how i have created the XML File, this is called on FormCreate:</p>\n\n<pre><code>procedure TfrmMain.CreateXML;\nvar\n  BikeXMLDoc: IXMLDocument;\n  Root, Bike, Manufacturer, Model, Year, Ratio1, Ratio2, Ratio3, Ratio4, Ratio5,\n  Ratio6, Ratio7, PriRatio: IXMLNode;\nbegin\n  // Create XML Document for bikes.xml\n  BikeXmlDoc := TXMLDocument.Create(nil);\n  BikeXmlDoc.Active := True;\n  BikeXmlDoc.Options := BikeXmlDoc.Options + [doNodeAutoIndent];\n  BikeXmlDoc.Version := '1.0';\n\n  // Create Document Root Element\n  Root := BikeXmlDoc.CreateNode('Bikes');\n  BikeXmlDoc.DocumentElement := Root;\n\n  // Create First Bike Node\n  Bike := BikeXmlDoc.CreateNode('Bike');\n\n  // Add Required Elements with values for Honda Fireblade 2012\n  Manufacturer := BikeXmlDoc.CreateNode('Manufacturer');\n  Manufacturer.Text := 'Honda';\n  Model := BikeXmlDoc.CreateNode('Model');\n  Model.Text := 'Fireblade CBR1000';\n  Year := BikeXmlDoc.CreateNode('Year');\n  Year.Text := '2012';\n  Ratio1 := BikeXmlDoc.CreateNode('Ratio1');\n  Ratio1.Text := '2.286';\n  Ratio2 := BikeXmlDoc.CreateNode('Ratio2');\n  Ratio2.Text := '1.778';\n  Ratio3 := BikeXmlDoc.CreateNode('Ratio3');\n  Ratio3.Text := '1.500';\n  Ratio4 := BikeXmlDoc.CreateNode('Ratio4');\n  Ratio4.Text := '1.333';\n  Ratio5 := BikeXmlDoc.CreateNode('Ratio5');\n  Ratio5.Text := '1.214';\n  Ratio6 := BikeXmlDoc.CreateNode('Ratio6');\n  Ratio6.Text := '1.138';\n  Ratio7 := BikeXmlDoc.CreateNode('Ratio7');\n  PriRatio := BikeXmlDoc.CreateNode('PriRatio');\n  PriRatio.Text := '1.717';\n\n  // Add elements to XML File\n  Root.ChildNodes.Add(Bike);\n  Bike.ChildNodes.Add(Manufacturer);\n  Bike.ChildNodes.Add(Model);\n  Bike.ChildNodes.Add(Year);\n  Bike.ChildNodes.Add(Ratio1);\n  Bike.ChildNodes.Add(Ratio2);\n  Bike.ChildNodes.Add(Ratio3);\n  Bike.ChildNodes.Add(Ratio4);\n  Bike.ChildNodes.Add(Ratio5);\n  Bike.ChildNodes.Add(Ratio6);\n  Bike.ChildNodes.Add(Ratio7);\n  Bike.ChildNodes.Add(PriRatio);\n\n  // Save the XML File\n  //ShowMessage('XML File Created : ' + AppFileLocation + 'bikes.xml');\n  BikeXmlDoc.SaveToFile(AppFileLocation+'bikes.xml');\n  BikeXmlDoc.Active := False;\n  BikeXmlDoc := nil;\nend;\n</code></pre>\n\n<p>The code is repeated 4 more times adding 4 more elements to the XML File, i have not added the code here as i didnt think it was neccessary. The Finished XML File is this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Bikes&gt;\n  &lt;Bike&gt;\n    &lt;Manufacturer&gt;Honda&lt;/Manufacturer&gt;\n    &lt;Model&gt;Fireblade CBR1000&lt;/Model&gt;\n    &lt;Year&gt;2012&lt;/Year&gt;\n    &lt;Ratio1&gt;2.286&lt;/Ratio1&gt;\n    &lt;Ratio2&gt;1.778&lt;/Ratio2&gt;\n    &lt;Ratio3&gt;1.500&lt;/Ratio3&gt;\n    &lt;Ratio4&gt;1.333&lt;/Ratio4&gt;\n    &lt;Ratio5&gt;1.214&lt;/Ratio5&gt;\n    &lt;Ratio6&gt;1.138&lt;/Ratio6&gt;\n    &lt;Ratio7/&gt;\n    &lt;PriRatio&gt;1.717&lt;/PriRatio&gt;\n  &lt;/Bike&gt;\n  &lt;Bike&gt;\n    &lt;Manufacturer&gt;Kawasaki&lt;/Manufacturer&gt;\n    &lt;Model&gt;ZX6R 636&lt;/Model&gt;\n    &lt;Year&gt;2013&lt;/Year&gt;\n    &lt;Ratio1&gt;2.846&lt;/Ratio1&gt;\n    &lt;Ratio2&gt;2.200&lt;/Ratio2&gt;\n    &lt;Ratio3&gt;1.850&lt;/Ratio3&gt;\n    &lt;Ratio4&gt;1.600&lt;/Ratio4&gt;\n    &lt;Ratio5&gt;1.421&lt;/Ratio5&gt;\n    &lt;Ratio6&gt;1.300&lt;/Ratio6&gt;\n    &lt;Ratio7/&gt;\n    &lt;PriRatio&gt;1.900&lt;/PriRatio&gt;\n  &lt;/Bike&gt;\n  &lt;Bike&gt;\n    &lt;Manufacturer&gt;Suzuki&lt;/Manufacturer&gt;\n    &lt;Model&gt;GSXR1000&lt;/Model&gt;\n    &lt;Year&gt;2011&lt;/Year&gt;\n    &lt;Ratio1&gt;2.562&lt;/Ratio1&gt;\n    &lt;Ratio2&gt;2.052&lt;/Ratio2&gt;\n    &lt;Ratio3&gt;1.714&lt;/Ratio3&gt;\n    &lt;Ratio4&gt;1.500&lt;/Ratio4&gt;\n    &lt;Ratio5&gt;1.360&lt;/Ratio5&gt;\n    &lt;Ratio6&gt;1.269&lt;/Ratio6&gt;\n    &lt;Ratio7/&gt;\n    &lt;PriRatio&gt;1.617&lt;/PriRatio&gt;\n  &lt;/Bike&gt;\n  &lt;Bike&gt;\n    &lt;Manufacturer&gt;Triumph&lt;/Manufacturer&gt;\n    &lt;Model&gt;Daytona 675R&lt;/Model&gt;\n    &lt;Year&gt;2010&lt;/Year&gt;\n    &lt;Ratio1&gt;2.312&lt;/Ratio1&gt;\n    &lt;Ratio2&gt;1.857&lt;/Ratio2&gt;\n    &lt;Ratio3&gt;1.565&lt;/Ratio3&gt;\n    &lt;Ratio4&gt;1.350&lt;/Ratio4&gt;\n    &lt;Ratio5&gt;1.238&lt;/Ratio5&gt;\n    &lt;Ratio6&gt;1.136&lt;/Ratio6&gt;\n    &lt;Ratio7/&gt;\n    &lt;PriRatio&gt;1.848&lt;/PriRatio&gt;\n  &lt;/Bike&gt;\n  &lt;Bike&gt;\n    &lt;Manufacturer&gt;Yamaha&lt;/Manufacturer&gt;\n    &lt;Model&gt;YZF R1&lt;/Model&gt;\n    &lt;Year&gt;2013&lt;/Year&gt;\n    &lt;Ratio1&gt;2.533&lt;/Ratio1&gt;\n    &lt;Ratio2&gt;2.063&lt;/Ratio2&gt;\n    &lt;Ratio3&gt;1.762&lt;/Ratio3&gt;\n    &lt;Ratio4&gt;1.522&lt;/Ratio4&gt;\n    &lt;Ratio5&gt;1.364&lt;/Ratio5&gt;\n    &lt;Ratio6&gt;1.269&lt;/Ratio6&gt;\n    &lt;Ratio7/&gt;\n    &lt;PriRatio&gt;1.512&lt;/PriRatio&gt;\n  &lt;/Bike&gt;\n&lt;/Bikes&gt;\n</code></pre>\n\n<p>How can i make it so when Button1 is pressed the XML File is accessed again, and the text Value of each Manufacturer is listed in ListBox1.Items.</p>\n\n<p>I have tried solutions involving XPath to select only a single node, but i need to be able to select all the nodes.</p>\n\n<p>Thank you people.</p>\n"},{"tags":["delphi","interop","delphi-2010","remobjects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12749795,"title":"Delphi 2010 How do I Implement a Hydra WPF host application sample?","body":"<p>Continuing with our Delphi 2010 thick client to multi-tier migration <a href=\"http://stackoverflow.com/questions/10312731/consuming-c-sharp-wcf-service-from-delphi-2010-client-databinding-and-entity-fr\">(previous question)</a>, we are at the point where we need to find a databinding solution. I have come across RemObjects Hydra. The thing is I can't seem to follow their tutorials <a href=\"http://wiki.remobjects.com/wiki/Hosting_a_Silverlight_plugin#Delphi_Host\" rel=\"nofollow\">for the host program</a> and \n<a href=\"http://wiki.remobjects.com/wiki/WPF_Visual_Plugins\" rel=\"nofollow\">for the plugin</a>\nI have created a Hydra plugin project in visual studio, implemented the interface as described and that builds fine.</p>\n\n<pre><code>[Guid(\"8F1B3EE3-CC69-4685-B141-FAF2F4FB57C4\")]\npublic interface IGridPlugin : IHYCrossPlatformInterface\n{\n    string UserData { get; set; }\n    int ID { get; set; }\n\n}\n</code></pre>\n\n<p>In the plugin:</p>\n\n<pre><code>[Plugin(Name = \"GridPlugin\", Description = \"This is the Grid plugin\", UserData = \"Data\"), VisualPlugin]\npublic partial class GridPlugin : RemObjects.Hydra.WPF.VisualPlugin, IGridPlugin\n{\n</code></pre>\n\n<p>In Delphi I have created a new Hydra host project, imported the interface, but in the form create/load events they mention:</p>\n\n<pre><code>procedure TMainForm.FormCreate(Sender: TObject);\nbegin\n  ModuleManager.LoadModule('SilverlightPlugin.xap');\n  ModuleManager.CreateVisualPlugin('SilverlightPlugin', fInstance, Panel1);\nend;\n</code></pre>\n\n<p>What is fInstance? Also, no files in my WPF plugins project end in .xap, so what am I supposed to pass as a parameter? </p>\n\n<p>Has anyone implemented RemObjects Hydra, how did you achieve this early step?\nAny help will be appreciated.</p>\n"},{"tags":["delphi","memory-management","memory-leaks"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":110,"score":1,"question_id":12733252,"title":"Leak Watcher Tool - Overloading the memory allocation","body":"<p>I'm developing a Tool to help me find memory leak on my application. \nThe feature runs well while I'm working with object (TOBJECT), but I'm getting some problems while I'm working with buffer.\nIn SOME cases, that I could not identify I got some errors in my application, this errors seems to be some bad access to memory. I could not find any possible error on my logic or my code. If some one with more experience with Delphi can help me. Maybe some memory manager particular behavior is causing the problem. </p>\n\n<p>A little more explanations: </p>\n\n<p><strong>Memory Allocation Control</strong></p>\n\n<p>Objective: Count how much memory buffer with determined size is all allocated by the system, exemple:</p>\n\n<h2>Buffer Size | Amount of Allocs | Total Memory Used</h2>\n\n<pre><code>325     |       35265      |    11461125    \n23      |       32         |     736\n...     |       ...        |    ...\n</code></pre>\n\n<p>How I control the memory allocation and deallocation: </p>\n\n<pre><code>I created an array of integer that goes from 0 to 65365. This array will be used to keep the amount of allocs of the corresponding size.\nFor example, If I call GetMem for a buffer of 523, the Array[523] will increase + 1. \n\nThe GetMem, ReallocMem, AllocMem, the problem is easy to resolve 'cause one of it's parameters is the size of the buffer. So I can use this to increase the position of the array.\n\nThe problem cames with the FreeMem, 'cause the only parameter is the pointer of the buffer. I don't know it's size.\n    - I can't create a list to keep the Pointer and it's size. 'Cause there is SO much allocations, it will be so much expensive to the application keep searching/adding/removing items from this list. And this list must to be protected with critical section etc etc. So no way.\n\nHow I'm trying to solve this problem: \n    Just to remeber I created the array to keep the number off allocations. \n\n    Items:     0                              65365\n               |................................|\n    Addess:   $X                            $(65365x SizeOf(Integer))   \n\n    When allocators methos are called, for example: GetMem(52);\n    I changed the behavior of it, I will alloc the requested size (52), but I'll add here a size of an integer;\n    So I will have:  \n\n    0     4                          56 \n    |.....|...........................|\n       $x           \n\n    In the plus space (0..3) I'll set the address of the corresponding space of the array. In this case the address position $array(52). And I add + (SizeOf(Integer)) to the address result of the GetMem, so it will have access just the 52 bytes that were asked for.\n\n    When the FreeMem are called. What I do is:\n        - Get the pointer asked for deallocation.\n        - Decrease the pointer by the size of the integer\n        - Check if the address of the current pointer is relative to the Array of control address.\n        - If it is, I use the the address and decrease 1 from the Array position\n        - And ask for the FreeMem\n</code></pre>\n\n<p>In the biggest part of time and systems it's working very well. BUT, In some moments that I really don't know how and were I get some strange errors in system. Erros that I NEVER get if I deactive this implementation.</p>\n\n<p>I'm commenting the code to get easier to be understood, but It's not a hard code so, here it's:</p>\n\n<p>Other thread in: <a href=\"https://forums.embarcadero.com/thread.jspa?threadID=77787\" rel=\"nofollow\">https://forums.embarcadero.com/thread.jspa?threadID=77787</a></p>\n\n<pre><code>unit uInstancesAnalyser;\n\n    {\n    Functionality: The feature developed in this unit try to watch how the memory are being allocated by your system. The main focus of it is help to find memory leak in the most non intrusive way.\n    How to Install: Put this unit as the first unit of yout project. If use use a third memory manager put this unit just after the unit of your memory manager.\n    How to get it's report: It's not the final version of this unit, so the viewer was not developed. By the momento you can call the\n        method SaveInstancesToFile. It'll create a text file called MemReport in the executable path.\n\n    WARNING: If you use the pointer of the VMT destinated to vmtAutoTable, you should not use the directive TRACEINSTANCES.\n\n    How it works:\n    The feature work in two different approaches:\n    1) Map the memory usage by objects\n    2) Map the memory usage by buffers (Records, strings and so on)\n\n    How are Objects tracked:\n      The TObject.NewInstance was replaced by a new method (TObjectHack.NNewInstanceTrace).\n      So when the creation of an object is called it's redirect to the new method. In this new method is increased the counter of the relative class and change the method in the VMT that is responsible to free the object to a new destructor method (vmtFreeInstance). This new destructor call the decrease of the counter and the old destructor.\n      This way I can know how much of objects of each class are alive in the system.\n\n      (More details about how it deep work can be found in the comments on the code)\n\n    How are Memory Buffer Traced:\n      The GetMem, FreeMem, ReallocMem, AllocMem were replaced by new method that have an special behavior to help track the buffers.\n\n       As the memory allocation use the same method to every kind of memory request, I'm not able to create a single counter to each count of buffer. So, I calculate them base on it size. First I create a array of integer that start on 0 and goes to 65365.\n      When the system ask me to give it a buffer of 65 bytes, I increase the position 65 of the array and the buffer is deallocated I call the decrease of the position of the array corresponding to buffer size. If the size requested to the buffer is bigger or equal to 65365, I'll use the position 65365 of the array.\n\n      (More details about how it deep work can be found in the comments on the code)\n\n    --------------------------------------------------------------------------------------\n    Develop by  Rodrigo Farias Rezino\n        E-mail: rodrigofrezino@gmail.com\n        Stackoverflow: http://stackoverflow.com/users/225010/saci\n         Please, any bug let me know\n    }\n\n    interface\n    {$DEFINE TRACEBUFFER}    {Directive used to track buffer} //Comment to inactive\n    {$DEFINE TRACEINSTANCES} {Directive used to track objects} //Comment to inactive\n\n    //{$DEFINE WATCHTHREADS} // It's not finished\n\n    uses\n      Classes, SyncObjs, uIntegerList;\n\n      {You can register possibles names for some Buffers Sizes, it can be useful when you are working with record. Example\n        TRecordTest = record\n          Field1: Integer\n          Field2: string[50]\n\n        So, you can call RegisterNamedBuffer(TRecordTest, SizeOf(TRecordTest));\n        This way, in on the report of buffer/objects will be explicit what possibles named buffer can be that memory in use.}\n      procedure RegisterNamedBuffer(ABufferName: string; ASize: integer);\n\n      {This function return the possible named buffers registered with that size}\n      function GetBufferName(ASize: integer): string;\n\n      {It's a simple output to save the report of memory usage on the disk. It'll create a file called test.txt in the executable directory}\n      procedure SaveInstancesToFile;\n\n    var\n      {Flag to say if the memory watcher is on or off}\n      SIsMemoryWatcherActive: Boolean;\n\n    implementation\n\n    uses\n       Windows, SysUtils, TypInfo;\n\n    const\n      SIZE_OF_INT = SizeOf(Integer);\n\n      SIZE_OF_MAP = 65365;\n      {$IFDEF WATCHTHREADS}\n      GAP_SIZE = SIZE_OF_INT * 2;\n      {$ELSE}\n      GAP_SIZE = SIZE_OF_INT;\n      {$ENDIF}\n\n    type\n      TArrayOfMap = array [0..SIZE_OF_MAP] of Integer;\n      TThreadMemory = array [0..SIZE_OF_MAP] of Integer;\n\n      {This class is used to Register}\n      TNamedBufferList = class(TIntegerList)\n      public\n        constructor Create;\n\n        function GetBufferName(ASize: integer): string;\n        procedure RegisterNamedBuffer(ABufferName: string; ASize: integer);\n      end;\n\n      PClassVars = ^TClassVars;\n      TClassVars = class(TObject)\n      private\n        class var ListClassVars: TList;\n      public\n        BaseInstanceCount: Integer;\n        BaseClassName: string;\n        BaseParentClassName: string;\n        BaseInstanceSize: Integer;\n        OldVMTFreeInstance: Pointer;\n        constructor Create;\n        class procedure SaveToDisk;\n      end;\n\n      TNamedBuffer = class(TObject)\n        Names: string;\n      end;\n\n      PJump = ^TJump;\n      TJump = packed record\n        OpCode: Byte;\n        Distance: Pointer;\n      end;\n\n      TObjectHack = class(TObject)\n      private\n        FCriticalSection: TCriticalSection;\n        class procedure SetClassVars(AClassVars: TClassVars); //inline;\n        class function GetClassVars: TClassVars; inline;\n\n        procedure IncCounter; inline;\n        procedure DecCounter; inline;\n        procedure CallOldFunction;\n      public\n        constructor Create;\n        destructor Destroy; override;\n\n        class function NNewInstance: TObject;\n        class function NNewInstanceTrace: TObject;\n        procedure NFreeInstance;\n      end;\n\n    var\n      SDefaultGetMem: function(Size: Integer): Pointer;\n      SDefaultFreeMem: function(P: Pointer): Integer;\n      SDefaultReallocMem: function(P: Pointer; Size: Integer): Pointer;\n      SDefaultAllocMem: function(Size: Cardinal): Pointer;\n\n      SThreadMemory: TThreadMemory;\n      SMap: TArrayOfMap;\n      SNamedBufferList: TNamedBufferList;\n\n      {$IFDEF WATCHTHREADS}\n      SMissedMemoryFlow: Integer;\n      {$ENDIF}\n\n    {$REGION 'Util'}\n    type\n      TWinVersion = (wvUnknown, wv95, wv98, wv98SE, wvNT, wvME, wv2000, wvXP, wvVista, wv2003, wv7);\n\n    function GetWinVersion: TWinVersion;\n    var\n      osVerInfo: TOSVersionInfo;\n      majorVersion, minorVersion: Integer;\n    begin\n      Result := wvUnknown;\n      osVerInfo.dwOSVersionInfoSize := SizeOf(TOSVersionInfo);\n      if GetVersionEx(osVerInfo) then\n      begin\n        minorVersion := osVerInfo.dwMinorVersion;\n        majorVersion := osVerInfo.dwMajorVersion;\n        case osVerInfo.dwPlatformId of\n          VER_PLATFORM_WIN32_NT:\n          begin\n            if majorVersion &lt;= 4 then\n              Result := wvNT\n            else if (majorVersion = 5) and (minorVersion = 0) then\n              Result := wv2000\n            else if (majorVersion = 5) and (minorVersion = 1) then\n              Result := wvXP\n            else if (majorVersion = 5) and (minorVersion = 2) then\n              Result := wv2003\n            else if (majorVersion = 6) then\n              Result := wvVista\n            else if (majorVersion = 7) then\n              Result := wv7;\n          end;\n          VER_PLATFORM_WIN32_WINDOWS:\n          begin\n            if (majorVersion = 4) and (minorVersion = 0) then\n              Result := wv95\n            else if (majorVersion = 4) and (minorVersion = 10) then\n            begin\n              if osVerInfo.szCSDVersion[1] = 'A' then\n                Result := wv98SE\n              else\n                Result := wv98;\n            end\n            else if (majorVersion = 4) and (minorVersion = 90) then\n              Result := wvME\n            else\n              Result := wvUnknown;\n          end;\n        end;\n      end;\n    end;\n\n    function GetMethodAddress(AStub: Pointer): Pointer;\n    const\n      CALL_OPCODE = $E8;\n    begin\n      if PBYTE(AStub)^ = CALL_OPCODE then\n      begin\n        Inc(Integer(AStub));\n        Result := Pointer(Integer(AStub) + SizeOf(Pointer) + PInteger(AStub)^);\n      end\n      else\n        Result := nil;\n    end;\n\n    procedure AddressPatch(const ASource, ADestination: Pointer);\n    const\n      JMP_OPCODE = $E9;\n      SIZE = SizeOf(TJump);\n    var\n      NewJump: PJump;\n      OldProtect: Cardinal;\n    begin\n      if VirtualProtect(ASource, SIZE, PAGE_EXECUTE_READWRITE, OldProtect) then\n      begin\n        NewJump := PJump(ASource);\n        NewJump.OpCode := JMP_OPCODE;\n        NewJump.Distance := Pointer(Integer(ADestination) - Integer(ASource) - 5);\n\n        FlushInstructionCache(GetCurrentProcess, ASource, SizeOf(TJump));\n        VirtualProtect(ASource, SIZE, OldProtect, @OldProtect);\n      end;\n    end;\n\n    function PatchCodeDWORD(ACode: PDWORD; AValue: DWORD): Boolean;\n    var\n      LRestoreProtection, LIgnore: DWORD;\n    begin\n      Result := False;\n      if VirtualProtect(ACode, SizeOf(ACode^), PAGE_EXECUTE_READWRITE, LRestoreProtection) then\n      begin\n        Result := True;\n        ACode^ := AValue;\n        Result := VirtualProtect(ACode, SizeOf(ACode^), LRestoreProtection, LIgnore);\n\n        if not Result then\n          Exit;\n\n        Result := FlushInstructionCache(GetCurrentProcess, ACode, SizeOf(ACode^));\n      end;\n    end;\n\n    {$ENDREGION}\n\n    function GetInstanceList: TList;\n    begin\n      Result := TClassVars.ListClassVars;\n    end;\n\n    procedure SaveInstancesToFile;\n    begin\n      TClassVars.SaveToDisk;\n    end;\n\n    procedure OldNewInstance;\n    asm\n      call TObject.NewInstance;\n    end;\n\n    procedure OldAfterConstruction;\n    asm\n      call TObject.InitInstance;\n    end;\n\n    { TObjectHack }\n    type\n      TExecute = procedure of object;\n\n    procedure TObjectHack.CallOldFunction;\n    var\n      Routine: TMethod;\n      Execute: TExecute;\n    begin\n      Routine.Data := Pointer(Self);\n      Routine.Code := GetClassVars.OldVMTFreeInstance;\n      Execute := TExecute(Routine);\n      Execute;\n    end;\n\n    constructor TObjectHack.Create;\n    begin\n\n    end;\n\n    procedure TObjectHack.DecCounter;\n    var\n      ThreadId: Cardinal;\n    begin\n      {$IFDEF WATCHTHREADS}\n      ThreadId := GetCurrentThreadId;\n      SThreadMemory[ThreadId] := SThreadMemory[ThreadId] - Self.InstanceSize;\n      ThreadId := 0;\n      if (Self.ClassType.InheritsFrom(TThread)) then\n        ThreadId := TThread(Self).ThreadID;\n      {$ENDIF}\n\n      GetClassVars.BaseInstanceCount := GetClassVars.BaseInstanceCount -1;\n      CallOldFunction;\n\n      {$IFDEF WATCHTHREADS}\n      if ThreadId &lt;&gt; 0 then\n      begin\n        if SThreadMemory[ThreadId] &lt; 0 then\n          SMissedMemoryFlow := SMissedMemoryFlow + SThreadMemory[ThreadId];\n\n        SThreadMemory[ThreadId] := 0;\n      end;\n      {$ENDIF}\n    end;\n\n    destructor TObjectHack.Destroy;\n    begin\n\n      inherited;\n    end;\n\n    class function TObjectHack.GetClassVars: TClassVars;\n    begin\n      Result := PClassVars(Integer(Self) + vmtAutoTable)^;\n    end;\n\n    function _InitializeHook(AClass: TClass; AOffset: Integer; HookAddress: Pointer): Boolean;\n    var\n      lAddress: Pointer;\n      lProtect: DWord;\n    begin\n      lAddress := Pointer(Integer(AClass) + AOffset);\n      Result := VirtualProtect(lAddress, 4, PAGE_READWRITE, @lProtect);\n      if not Result then\n        Exit;\n\n      CopyMemory(lAddress, @HookAddress, 4);\n      Result := VirtualProtect(lAddress, 4, lProtect, @lProtect);\n    end;\n\n    class procedure TObjectHack.SetClassVars(AClassVars: TClassVars);\n    begin\n      AClassVars.BaseClassName := Self.ClassName;\n      AClassVars.BaseInstanceSize := Self.InstanceSize;\n      AClassVars.OldVMTFreeInstance := PPointer(Integer(TClass(Self)) + vmtFreeInstance)^;\n\n      if Self.ClassParent &lt;&gt; nil then\n        AClassVars.BaseParentClassName := Self.ClassParent.ClassName;\n\n      PatchCodeDWORD(PDWORD(Integer(Self) + vmtAutoTable), DWORD(AClassVars));\n      _InitializeHook(Self, vmtFreeInstance, @TObjectHack.DecCounter);\n    end;\n\n    procedure RegisterClassVarsSupport(const Classes: array of TObjectHack);\n    var\n      LClass: TObjectHack;\n    begin\n      for LClass in Classes do\n        if LClass.GetClassVars = nil then\n          LClass.SetClassVars(TClassVars.Create)\n        else\n          raise Exception.CreateFmt('Class %s has automated section or duplicated registration.', [LClass.ClassName]);\n    end;\n\n    procedure TObjectHack.IncCounter;\n    begin\n      if GetClassVars = nil then\n        RegisterClassVarsSupport(Self);\n\n      GetClassVars.BaseInstanceCount := GetClassVars.BaseInstanceCount + 1;\n    end;\n\n    { TClassVars }\n\n    constructor TClassVars.Create;\n    begin\n      ListClassVars.Add(Self);\n    end;\n\n    class procedure TClassVars.SaveToDisk;\n    var\n      LStringList: TStringList;\n      i: Integer;\n    begin\n      LStringList := TStringList.Create;\n      try\n        LStringList.Add('CLASS | NUMBER OF INSTANCES');\n        {$IFDEF TRACEINSTANCES}\n        for i := 0 to ListClassVars.Count -1 do\n          if TClassVars(ListClassVars.Items[I]).BaseInstanceCount &gt; 0 then\n            LStringList.Add(TClassVars(ListClassVars.Items[I]).BaseClassName + '|' + IntToStr(TClassVars(ListClassVars.Items[I]).BaseInstanceCount));\n        {$ENDIF}\n\n        {$IFDEF TRACEBUFFER}\n        for I := 0 to SIZE_OF_MAP do\n          if SMap[I] &gt; 0 then\n            LStringList.Add(Format('Mem. Size: %d | Amount: %d', [I, SMap[I]]));\n        {$ENDIF}\n\n        LStringList.SaveToFile(ExtractFilePath(ParamStr(0)) + 'MemReport.txt');\n      finally\n        FreeAndNil(LStringList);\n      end;\n    end;\n\n    //////////////////////////////////////////////////////////////////////////////////////\n    ///  Memory manager controller\n\n    function IsInMap(AValue: Integer): Boolean; inline;\n    begin\n      try\n        Result := (AValue &gt; Integer(@SMap)) and (AValue &lt;= Integer(@SMap[SIZE_OF_MAP]));\n      except\n        Result := False;\n      end;\n    end;\n\n    function MemorySizeOfPos(APos: Integer): Integer; inline;\n    begin\n      Result := (APos - Integer(@SMap)) div SIZE_OF_INT;\n    end;\n\n    function NAllocMem(Size: Cardinal): Pointer;\n    var\n      pIntValue: ^Integer;\n      MapSize: Integer;\n      ThreadId: Cardinal;\n    begin\n      if Size &gt; SIZE_OF_MAP then\n        MapSize := SIZE_OF_MAP\n      else\n        MapSize := Size;\n\n      Result := SDefaultAllocMem(Size + GAP_SIZE);\n      pIntValue := Result;\n      SMap[MapSize] := SMap[MapSize] + 1;\n      pIntValue^ := Integer(@SMap[MapSize]);\n\n      {$IFDEF WATCHTHREADS}\n      ThreadId := GetCurrentThreadId;\n      SThreadMemory[ThreadId] := SThreadMemory[ThreadId] + Size;\n\n      pIntValue := Pointer(Integer(Result) + SIZE_OF_INT);\n      pIntValue^ := ThreadId;\n      {$ENDIF}\n\n      Result := Pointer(Integer(Result) + GAP_SIZE);\n    end;\n\n    function NGetMem(Size: Integer): Pointer;\n    var\n      LPointer: Pointer;\n      pIntValue: ^Integer;\n      MapSize: Integer;\n      ThreadId: Cardinal;\n    begin\n      if Size &gt; SIZE_OF_MAP then\n        MapSize := SIZE_OF_MAP\n      else\n        MapSize := Size;\n\n      LPointer := SDefaultGetMem(Size + GAP_SIZE);\n      pIntValue := LPointer;\n      SMap[MapSize] := SMap[MapSize] + 1;\n      pIntValue^ := Integer(@SMap[MapSize]);\n\n      {$IFDEF WATCHTHREADS}\n      ThreadId := GetCurrentThreadId;\n      SThreadMemory[ThreadId] := SThreadMemory[ThreadId] + Size;\n\n      pIntValue := Pointer(Integer(LPointer) + SIZE_OF_INT);\n      pIntValue^ := ThreadId;\n      {$ENDIF}\n\n      Result := Pointer(Integer(LPointer) + GAP_SIZE);\n    end;\n\n    function NFreeMem(P: Pointer): Integer;\n    var\n      pIntValue: ^Integer;\n      LPointer: Pointer;\n      ThreadId: Cardinal;\n      LFreed: Boolean;\n    begin\n      LPointer := Pointer(Integer(P) - GAP_SIZE);\n      pIntValue := LPointer;\n      if IsInMap(pIntValue^) then\n      begin\n        {$IFDEF WATCHTHREADS}\n        ThreadId := Integer(Pointer(Integer(pIntValue) + SIZE_OF_INT)^);\n        SThreadMemory[ThreadId] := SThreadMemory[ThreadId] - MemorySizeOfPos(pIntValue^);\n        {$ENDIF}\n        Integer(Pointer(pIntValue^)^) := Integer(Pointer(pIntValue^)^) - 1;\n        Result := SDefaultFreeMem(LPointer);\n      end\n      else\n        Result := SDefaultFreeMem(P);\n    end;\n\n    function NReallocMem(P: Pointer; Size: Integer): Pointer;\n    var\n      pIntValue: ^Integer;\n      LPointer: Pointer;\n      LSizeMap: Integer;\n      ThreadId: Cardinal;\n    begin\n      LPointer := Pointer(Integer(P) - GAP_SIZE);\n      pIntValue := LPointer;\n      if not IsInMap(pIntValue^) then\n      begin\n        Result := SDefaultReallocMem(P, Size);\n        Exit;\n      end;\n\n      if Size &gt; SIZE_OF_MAP then\n        LSizeMap := SIZE_OF_MAP\n      else\n        LSizeMap := Size;\n\n      //Uma vez com o valor setado, não pode remover o setor\n      Integer(Pointer(pIntValue^)^) := Integer(Pointer(pIntValue^)^) - 1;\n\n      {$IFDEF WATCHTHREADS}\n      ThreadId := Integer(Pointer(Integer(pIntValue) + SIZE_OF_INT)^);\n      SThreadMemory[ThreadId] := SThreadMemory[ThreadId] - MemorySizeOfPos(pIntValue^) + Size;\n      {$ENDIF}\n\n      Result := SDefaultReallocMem(LPointer, Size + GAP_SIZE);\n      SMap[LSizeMap] := SMap[LSizeMap] + 1;\n      pIntValue := Result;\n      pIntValue^ := Integer(@SMap[LSizeMap]);\n      Result := Pointer(Integer(Result) + GAP_SIZE);\n    end;\n\n    procedure TObjectHack.NFreeInstance;\n    var\n      ThreadId: Cardinal;\n    begin\n      {$IFDEF WATCHTHREADS}\n      ThreadId := GetCurrentThreadId;\n      SThreadMemory[ThreadId] := SThreadMemory[ThreadId] - Self.InstanceSize;\n      {$ENDIF}\n      CleanupInstance;\n      SDefaultFreeMem(Self);\n    end;\n\n    class function TObjectHack.NNewInstance: TObject;\n    var\n      ThreadId: Cardinal;\n    begin\n      Result := InitInstance(SDefaultGetMem(Self.InstanceSize));\n      {$IFDEF WATCHTHREADS}\n      ThreadId := GetCurrentThreadId;\n      SThreadMemory[ThreadId] := SThreadMemory[ThreadId] + Self.InstanceSize;\n      {$ENDIF}\n    end;\n\n    class function TObjectHack.NNewInstanceTrace: TObject;\n    var\n      ThreadId: Cardinal;\n    begin\n      try\n        Result := InitInstance(SDefaultGetMem(Self.InstanceSize));\n        if (Result.ClassType = TClassVars) or (Result is EExternal) then\n          Exit;\n\n        TObjectHack(Result).IncCounter;\n        {$IFDEF WATCHTHREADS}\n        ThreadId := GetCurrentThreadId;\n        SThreadMemory[ThreadId] := SThreadMemory[ThreadId] + Self.InstanceSize;\n        {$ENDIF}\n      except\n        raise Exception.Create(Result.ClassName);\n      end;\n    end;\n\n    procedure InitializeArray;\n    var\n      I: Integer;\n    begin\n      for I := 0 to SIZE_OF_MAP do\n        SMap[I] := 0;\n    end;\n\n    type\n      PLocalTest = ^LocalTest;\n      LocalTest = record\n        Size: integer;\n        Size2: string;\n      end;\n\n    procedure ApplyMemoryManager;\n    var\n      LMemoryManager: TMemoryManagerEx;\n    begin\n      GetMemoryManager(LMemoryManager);\n      SDefaultGetMem := LMemoryManager.GetMem;\n      {$IFNDEF TRACEBUFFER}\n      Exit;\n      {$ENDIF}\n      LMemoryManager.GetMem := NGetMem;\n\n      SDefaultFreeMem := LMemoryManager.FreeMem;\n      LMemoryManager.FreeMem := NFreeMem;\n\n      SDefaultReallocMem := LMemoryManager.ReallocMem;\n      LMemoryManager.ReallocMem := NReallocMem;\n\n      SDefaultAllocMem := LMemoryManager.AllocMem;\n      LMemoryManager.AllocMem := NAllocMem;\n\n      SetMemoryManager(LMemoryManager);\n    end;\n\n    procedure TestRecord;\n    var\n      LTest: PLocalTest;\n    begin\n      LTest := AllocMem(1);\n      Dispose(LTest);\n\n      LTest := AllocMem(SIZE_OF_MAP + 1);\n      Dispose(LTest);\n\n      New(LTest);\n      ReallocMem(LTest, SIZE_OF_MAP +1);\n      Dispose(LTest);\n    end;\n\n    procedure TesteObject;\n    var\n      LTestObject: TObject;\n    begin\n      LTestObject := TObject.Create;\n      LTestObject.Free;\n    end;\n\n    { TNamedBuffer }\n\n    constructor TNamedBufferList.Create;\n    begin\n      inherited Create;\n      Sorted := True;\n    end;\n\n    function GetBufferName(ASize: integer): string;\n    begin\n      Result := SNamedBufferList.GetBufferName(ASize);\n    end;\n\n    procedure RegisterNamedBuffer(ABufferName: string; ASize: integer);\n    begin\n      SNamedBufferList.RegisterNamedBuffer(ABufferName, ASize);\n    end;\n\n    function TNamedBufferList.GetBufferName(ASize: integer): string;\n    var\n      LIndex: Integer;\n    begin\n      Result := 'Unknow';\n      LIndex := IndexOf(ASize);\n      if LIndex = -1 then\n        Exit;\n      Result := TNamedBuffer(Objects[LIndex]).Names;\n    end;\n\n    procedure TNamedBufferList.RegisterNamedBuffer(ABufferName: string; ASize: integer);\n    var\n      LIndex: Integer;\n      LNamedBuffer: TNamedBuffer;\n    begin\n      LIndex := IndexOf(ASize);\n      if LIndex = -1 then\n      begin\n        LNamedBuffer := TNamedBuffer.Create;\n        LNamedBuffer.Names := 'Possible types: ' + ABufferName;\n        Self.AddObject(ASize, LNamedBuffer);\n      end\n      else\n        TNamedBuffer(Objects[LIndex]).Names := TNamedBuffer(Objects[LIndex]).Names + ' | ' + ABufferName;\n    end;\n\n    procedure InitializeAnalyser;\n    var\n      LCan: Boolean;\n    begin\n      SIsMemoryWatcherActive := False;\n      SNamedBufferList := TNamedBufferList.Create;\n\n      case GetWinVersion of\n        wv98, wvXP, wvVista, wv7: LCan := True;\n        else LCan := False;\n      end;\n\n      if not LCan then\n        Exit;\n\n      {$IFDEF TRACEINSTANCES}\n      TClassVars.ListClassVars := TList.Create;\n      {$ENDIF}\n\n      {$IFDEF TRACEBUFFER}\n      InitializeArray;\n      {$ENDIF}\n\n      ApplyMemoryManager;\n      ///  Buffer wrapper\n      {$IFDEF TRACEBUFFER}\n      TestRecord;\n        {$IFNDEF TRACEINSTANCES}\n        AddressPatch(GetMethodAddress(@OldNewInstance), @TObjectHack.NNewInstance);\n        {$ENDIF}\n      {$ENDIF}\n\n      ///Class wrapper\n      {$IFDEF TRACEINSTANCES}\n      AddressPatch(GetMethodAddress(@OldNewInstance), @TObjectHack.NNewInstanceTrace);\n      TesteObject;\n      {$ENDIF}\n      SIsMemoryWatcherActive := True;\n    end;\n\n\n    { TThreadDestroy }\n    initialization\n      InitializeAnalyser\n\n    end.\n</code></pre>\n"},{"tags":["delphi","fastmm"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":127,"score":2,"question_id":12798828,"title":"Using FASTMM4 to generate a report without writing to a file","body":"<p>I am trying to hunt down memory leaks in the GUI which is written in Delphi (not a simple task, seeing as the code is enormous- tens of thousands of lines of code). I've made a file parser which analyzes the report generated by <code>FASTMM</code>, and creates <code>TMemoryLeak</code> instances and stores them in a neat <code>VirtualNodeTree</code>. </p>\n\n<p>The problem, however, is that generating such a report and then parsing through it, takes a lot of time. There is a FMM method called <code>CheckBlocksOnShutDown</code>, which I was able to isolate and call just by a click of a button, but, again, it creates a whole new report, which I have to traverse, and store the whole report in my NodeTree. I would like to achieve a near-real-time view of the new memory leaks being created by repeatedly clicking the  </p>\n\n<p>I would like to tweak FASTMM code to make it create memory leak instances \"on the go\", without writing anything to a file. Is this feasible? (simialar <a href=\"http://stackoverflow.com/questions/12539319/how-to-obtain-the-names-of-custom-made-structures-whose-instances-have-leaked-me\">question</a>)</p>\n"},{"tags":["delphi","delphi-xe2","rtmp"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":134,"score":1,"question_id":12798181,"title":"LIBRTMP Delphi: use dll","body":"<p>I have before me the task of loading and saving rtmp stream from the server to your computer. Exploring the internet, I came to the conclusion that it is necessary to use the library <strong>LIBRTMP</strong>. I work in Delphi XE2 and the only appropriate code I found on <a href=\"http://stackoverflow.com/questions/7580891/librtmp-delphi-mapping-of-the-dll\">this page</a> and sales on <a href=\"http://pastebin.com/29XeZMvk\" rel=\"nofollow\">Pascal page</a>.<br>\nI am having difficulties with the translation of this code into a usable form for delphi, because types <code>cint</code>, <code>pcchar</code> and etc I did not recognize.<br>\nI do not work with C or C + +, could you give me directions to work, or it's easier to solve this problem?</p>\n"},{"tags":["c++","delphi","dll","cross-platform","c++builder"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":12797639,"title":"C++ Builder exporting cdecl for cross platform use","body":"<p>I have a library (dll) originally written in MSVS that I need to make cross platform (Mac/Win). I started using XCode but with the new Embarcadero C++ builder XE3 I am thinking that one development environment would be a better way to go.\nThe host application is written in Delphi so more reason to move it to one set of tools.</p>\n\n<p>For my existing code everything is cdecl but I cannot get this to work on C++ builder. If I convert it to stdcall then it works fine but as I understand it I need to use cdecl when using the library under OSX.</p>\n\n<p>In MSVC I export my functions like this:</p>\n\n<pre><code>extern \"C\" __declspec(dllexport) int Init(char * init_dir, DebugCallbackFunc f, DeviceCallbackFunc f1)\n</code></pre>\n\n<p>In C++ Builder I am exporting like this:</p>\n\n<pre><code>extern \"C\" __declspec( dllexport ) int _cdecl Init(char * init_dir, DebugCallbackFunc f, DeviceCallbackFunc f1)\n</code></pre>\n\n<p>The problem is that the Delphi host application always returns NULL with GetProcAddress when I use cdecl but works fine if I change it to stdcall. </p>\n\n<pre><code>TUDMXInit = function(p: PAnsiChar; f: TDebugCallbackFunc; f1: TDeviceCallbackFunc): integer; cdecl;\n</code></pre>\n\n<p>I would also appreciate an example of the best way to handle the '_' that is suppose to prefix the exported function under OSX. Should I just use conditionals to add this at the front of all functions?</p>\n\n<p>Thanks in advance.\nMartin</p>\n"},{"tags":["delphi","winapi","delphi-2009"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":218,"score":3,"question_id":12782567,"title":"What windows messages are used by Delphi to notice changes in a combo box?","body":"<p>I have a Delphi application A, which I need to control from a .NET application B.</p>\n\n<p>Among other things, I need to automate this process:</p>\n\n<ol>\n<li>User selects item X from a combo box.</li>\n<li>Application A notices the change and reacts by displaying a certain panel.</li>\n</ol>\n\n<p>This works fine, if I do it manually.</p>\n\n<p>But when the application B selects a combo box value, no panel is displayed.</p>\n\n<p>This is the problem.</p>\n\n<p>Potential cause of it:</p>\n\n<ol>\n<li>When I select a combo box item, a certain windows message is fired. Some Delphi routine reacts to this message.</li>\n<li>When I select a combo box item programmatically, the only message I send is <code>CB_SETCURSEL</code> and the Delphi app seems to ignore it.</li>\n</ol>\n\n<p>Hence I assume that I can fix the problem, if I </p>\n\n<ol>\n<li>get to know what windows messages are used as a basis for notification about combo box value changes (e. g. <code>OnChange</code>) and</li>\n<li>send that windows message from C# application.</li>\n</ol>\n\n<p>Therefore my question: What are the windows messages, on whose occurrence <code>OnChange</code> (and other events that notify the Delphi application on changed combo box selection) are fired?</p>\n\n<p><strong>Update 1:</strong> Started to implement the solution proposed by David Heffernan</p>\n\n<pre><code>private const int CB_SETCURSEL = 0x14E;\nprivate const int WM_COMMAND = 0x0111;\nprivate const int CBN_SELCHANGE = 0x001;\nprivate const int CN_COMMAND = 0xBD11;\n\nprivate int MakeWParam(int l, int h)\n{\n    return (l &amp; 0xFFFF) | (h &lt;&lt; 16);\n}\n\n...\nIntPtr comboBoxHandle = new IntPtr(comboBox.Current.NativeWindowHandle);\nSendMessage(comboBoxHandle, CB_SETCURSEL, (Int32)myIndexInComboBox, 0);\nSendMessage(comboBoxHandle, CN_COMMAND, MakeWParam(0, CBN_SELCHANGE), 0);\n</code></pre>\n\n<p>At the moment, it doesn't work. </p>\n\n<p><strong>Update 2:</strong></p>\n\n<p>I noticed a very strange thing.</p>\n\n<ol>\n<li>If I invoke <code>CB_SETCURSEL</code> only, the desired item is selected in the combo box.</li>\n<li>If I invoke <code>CB_SETCURSEL</code> and then (after 5 seconds) <code>CN_COMMAND</code>, then nothing is selected in the combo box.</li>\n</ol>\n\n<p>This means - <code>CB_SECURSEL</code> selects the item and <code>CN_COMMAND</code> undoes it.</p>\n\n<p><strong>Update 3</strong>: Styles of the combo box according to Spy++:</p>\n\n<ol>\n<li>WS_CHILDWINDOW</li>\n<li>WS_VISIBLE</li>\n<li>WS_CLIPSIBLINGS</li>\n<li>00000243</li>\n</ol>\n\n<p>Extended styles:</p>\n\n<ol>\n<li>WS_EX_LEFT</li>\n<li>WS_EX_LTRREADING</li>\n<li>WS_EX_RIGHTSCROLLBAR</li>\n</ol>\n\n<p>Class styles:</p>\n\n<ol>\n<li>CS_VREDRAW</li>\n<li>CS_HREDRAW</li>\n<li>CS_DBLCLKS</li>\n</ol>\n\n<p><strong>Update 4</strong>: When I select the combo box item manually, I see following messages in the Spy++ output:</p>\n\n<pre><code>&lt;00177&gt; 0195085E S message:0xBD33 [Custom:WM_APP+15667] wParam:6801164A lParam:0195085E\n&lt;00178&gt; 0195085E R message:0xBD33 [Custom:WM_APP+15667] lResult:4610165A\n</code></pre>\n\n<p>Unfortunately, I couldn't find documentation for this message.</p>\n\n<p><strong>Update 5</strong>: I noticed that the reaction to combo box selection change does occur, but only after a relatively long time (30 seconds to 1 minute). When I do the same thing manually, the reaction occurs instantaneously.</p>\n\n<p>Potential cause of this behaviour: The thread of the .NET application makes the thread of the Delphi application wait for it. Note that the UI interaction code in the .NET app is executed in a separate thread (not the UI thread).</p>\n"},{"tags":["image","delphi"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":444,"score":2,"question_id":10516968,"title":"Delphi: how Add text to an image and save the new image?","body":"<p>the idea is retrieve date from a database (text and a picture) then add these data in another picture (like an ID form) then save the new picture.</p>\n\n<p>how can this be done in delphi? </p>\n\n<p>thx</p>\n"},{"tags":["delphi","rtmp"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":588,"score":2,"question_id":7580891,"title":"LIBRTMP Delphi: mapping of the DLL","body":"<p>When I call the function RTMP_SetupURL from Delphi the URL is not updated in the record RTMP, I tanslated the DLL function like that:</p>\n\n<pre><code>int RTMP_SetupURL(RTMP *r, char *url);\n\nfunction RTMP_SetupURL(var r:RTMP; url:PAnsichar):integer;\n</code></pre>\n\n<p>and the record AVal is declared like that:</p>\n\n<pre><code>AVal = record\nav_val: PansiChar; \nav_len: integer;\nend;\n</code></pre>\n\n<hr>\n\n<p>Before to set the URL there a init problem, my record (RTMP) is not initialized correctly, below my record:</p>\n\n<pre><code>PChar = PAnsiChar;\nuint32_t = LongWord;\nuint8_t = Byte;\nint8_t = char;\nint32_t = LongInt;\nunsigned_int = LongWord;\nunsigned_short = Word;\nint16_t = smallint;\ncchar = Char;\ncint = LongInt; \n\nRTMP = record\nm_inChunkSize : cint;\nm_outChunkSize : cint;\nm_nBWCheckCounter : cint;\nm_nBytesIn : cint;\nm_nBytesInSent : cint;\nm_nBufferMS : cint;\nm_stream_id : cint;\nm_mediaChannel : cint;\nm_mediaStamp : uint32_t;\nm_pauseStamp : uint32_t;\nm_pausing : cint;\nm_nServerBW : cint;\nm_nClientBW : cint;\nm_nClientBW2 : uint8_t;\nm_bPlaying : uint8_t;\nm_bSendEncoding : uint8_t;\nm_bSendCounter : uint8_t;\nm_numInvokes : cint;\nm_numCalls : cint;\nm_methodCalls : PRTMP_METHOD;\nm_vecChannelsIn : array[0..(RTMP_CHANNELS)-1] of PRTMPPacket;\nm_vecChannelsOut : array[0..(RTMP_CHANNELS)-1] of PRTMPPacket;\nm_channelTimestamp : array[0..(RTMP_CHANNELS)-1] of cint;\nm_fAudioCodecs : double;\nm_fVideoCodecs : double;\nm_fEncoding : double;\nm_fDuration : double;\nm_msgCounter : cint;\nm_polling : cint;\nm_resplen : cint;\nm_unackd : cint;\nm_clientID : AVal;\nm_read : RTMP_READ;\nm_write : RTMPPacket;\nm_sb : RTMPSockBuf;\nLink : RTMP_LNK;\nend;\nPRTMP = ^RTMP;\n</code></pre>\n\n<p>then I call:</p>\n\n<pre><code>var MY_RTMP: RTMP;\nMY_RTMP := RTMP_Alloc;\nRTMP_Init(MY_RTMP);\n</code></pre>\n\n<p>all the record is initialized excepted the \"Link\" record that is used when initializing the URL.\nI guess the record is not properly declared</p>\n"},{"tags":["delphi","autocomplete","autosuggest"],"answer_count":2,"favorite_count":10,"up_vote_count":18,"down_vote_count":0,"view_count":1114,"score":18,"question_id":9466547,"title":"How to make a combo box with fulltext search autocomplete support?","body":"<p>I would like a user to be able to type in the second or third word from a <code>TComboBox</code> item and for that item to appear in the <code>AutoSuggest</code> dropdown options</p>\n\n<p>For example, a combo box contains the items:</p>\n\n<ul>\n<li>Mr John Brown  </li>\n<li>Mrs Amanda Brown  </li>\n<li>Mr Brian Jones  </li>\n<li>Mrs Samantha Smith</li>\n</ul>\n\n<p>When the user types \"Br\" the dropdown displays:</p>\n\n<ul>\n<li>Mr John Brown  </li>\n<li>Mrs Amanda Brown  </li>\n<li>Mr Brian Jones  </li>\n</ul>\n\n<p>and when the user types \"Jo\" the dropdown displays:</p>\n\n<ul>\n<li>Mr John Brown  </li>\n<li>Mr Brian Jones  </li>\n</ul>\n\n<p>The problem is that the <code>AutoSuggest</code> functionality only includes items in the dropdown list that begin with what the user has input and so in the examples above nothing will appear in the dropdown. </p>\n\n<p>Is it possible to use the <code>IAutoComplete</code> interface and/or other related interfaces to get around this issue?</p>\n"},{"tags":["delphi","dom","google-maps-api-3","drawing","webbrowser"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":565,"score":4,"question_id":7849576,"title":"How to draw something over WebBrowser component in Delphi","body":"<p>Is it possible to draw or put something over the WebBrowser component to draw on it ?<br> \nWhen I add an image on WebBrowser this image is always under the WebBrowser.\nI need this to draw area over different map types always in the same way.\nFor example I need to draw the same area on Google Maps and open street maps... </p>\n"},{"tags":["delphi","delphi-xe2","datasnap"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":287,"score":3,"question_id":10083967,"title":"How to skip field serialization at JSON marshalling in DataSnap?","body":"<p>Is there a generic way to skip field serialization at JSON marshalling in Delphi XE2 DataSnap ?</p>\n\n<pre><code>TBizObjects = class\n  DataObject: TDataObject; -- skip this field on serializaing descendants\nend;\n\nModel = class(TBizObject);\n</code></pre>\n"},{"tags":["delphi","transactions","delphi-xe2","firebird","pending-changes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12795003,"title":"Determine if a TIBTransaction has pending changes","body":"<p>I'm working with Embarcadero Delphi XE2 and Firebird DB, using <code>TIBDatabase</code>, <code>TIBTransaction</code> and <code>TIBTable</code> components. In a form user can edit data of a DB table and commit/rollback the changes when he wants. <strong>When he closes the form I'd like to ask him if he wants to commit/rollback pending changes.</strong> </p>\n\n<p><strong>But only if there are pending changes</strong>. Otherwise I don't want to bother/confuse the user. <strong>How can I determine it?</strong> I tried <code>Active</code> and <code>InTransaction</code> transaction's properties, but they are always true. If it can be usefull, note that I set <code>AllowAutoStart</code> to true on the transaction. Thanks!</p>\n"},{"tags":["delphi","scroll","tvirtualstringtree"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":10152120,"title":"Ctrl+End behavior of TVirtualStringTree","body":"<p>When user press Ctrl+End, VirtualStringTree jumps to the end vertically which is fine but also horizontally. I don't want it to go to the end horizontally. Horizontal scroll should be leaved as is.</p>\n\n<p>How to tell this?</p>\n\n<p>Thank you.</p>\n"},{"tags":["delphi","dom","delphi-6","tchromium"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":626,"score":2,"question_id":10670452,"title":"How to get elements by name in Delphi Chromium Embedded?","body":"<p>To get a particular DOM node embedded in the current web document from a TChromium instance, using its ID, you use ICefDomDocument.getElementById().  But how do you find elements by the NAME attribute?  Javascript has the document.getElementsByName() method and TWebBrowser (that wraps IE) has a similar call, but I can't figure out how to do this with TChromium.  I need to find some DOM elements that have NAME attributes but no ID attributes.  I searched the <em>ceflib</em> unit and did not see anything that would do it.</p>\n\n<p>Side question.  If anyone has a link to a TChromium \"recipes\" style site or document I could use it.</p>\n\n<p>UPDATE: While waiting for an answer I have come up with the following code for doing getElementsbyName().  I'd like something faster than scanning the entire DOM tree.  If you see something wrong in the code let me know:</p>\n\n<pre><code>type\n    TDynamicCefDomNodeArray = array of ICefDomNode;\n\n\n// Given a Chromium document interface reference and a NAME attribute to search for,\n//  return an array of all DOM nodes whose NAME attribute matches the desired.\nfunction getElementsByName(ADocument: ICefDomDocument; theName: string): TDynamicCefDomNodeArray;\n\n    // Get all the elements with a particular NAME attribute value and return\n    //  an array of them.\n    procedure getElementsByName1(intfParentNode: ICefDomNode; theName: string; var aryResults: TDynamicCefDomNodeArray);\n    var\n        oldLen: integer;\n        intfChildNode: ICefDomNode;\n        theNameAttr: string;\n    begin\n        Result := nil;\n        intfChildNode := nil;\n\n        if Assigned(intfParentNode) then\n        begin\n            // Attributes are case insensitive.\n            theNameAttr := intfParentNode.GetElementAttribute('name');\n\n            if AnsiSameText(theNameAttr, theName) then\n            begin\n                // Name attribute match.  Add it to the results array.\n                oldLen := Length(aryResults);\n                SetLength(aryResults, oldLen + 1);\n                aryResults[oldLen] := intfParentNode;\n            end; // if AnsiSameText(intfParentNode.Name, theName) then\n\n            // Does the parent node have children?\n            if intfParentNode.HasChildren then\n            begin\n                intfChildNode := intfParentNode.FirstChild;\n\n                // Scan them.\n                while Assigned(intfChildNode) do\n                begin\n                    getElementsByName1(intfChildNode, theName, aryResults);\n\n                    if Assigned(intfChildNode) then\n                        intfChildNode := intfChildNode.NextSibling;\n                end;\n            end; // if intfParentNode.HasChildren then\n        end; // if Assigned(intfParentNode) then\n    end;\n\n    // ---------------------------------------------------------------\n\nvar\n    intfCefDomNode: ICefDomNode;\nbegin\n    intfCefDomNode := nil;\n    Result := nil;\n\n    if Assigned(ADocument) then\n    begin\n        // Check the header.\n        intfCefDomNode := ADocument.Document;\n\n        if Assigned(intfCefDomNode) then\n        begin\n            // Check the parent.\n            getElementsByName1(intfCefDomNode, theName, Result);\n        end; // if Assigned(intfCefDomNode) then\n    end; // if Assigned(ADocoument) then\nend;\n\n// ---------------------------------------------------------------\n</code></pre>\n"},{"tags":["delphi","exception","delphi-7"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12795376,"title":"ExitWindowsEx - External exception 80000003","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11927877/how-to-get-rid-of-exception-80000003\">How to get rid of exception 80000003?</a>  </p>\n</blockquote>\n\n\n\n<p>to force the PC shutdown by code, we use the function <code>ExitWindowsEx</code> in Delphi 7\nIt woks well but on a PC of one of our user,\n<code>ExitWindowsEx</code> triggers an exception :  \"<strong>External exception 80000003</strong>\"  </p>\n\n<p>Pc is : Windows 7 x64 Service Pack 1 build 7601</p>\n\n<p>Why that ?</p>\n"},{"tags":["delphi","firebird","delphi-xe2"],"answer_count":5,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1192,"score":6,"question_id":7644686,"title":"Firebird: DBExpress or native components?","body":"<p>I am starting with Firebird and have found components to access a database by Devart.\nThey offer native components (<a href=\"http://www.devart.com/ibdac/\" rel=\"nofollow\" title=\"IBDAC\">IBDAC</a>) or <a href=\"http://www.devart.com/dbx/interbase/\" rel=\"nofollow\">DBExpress</a> drivers. (I am using Delphi XE2 Pro which doesn't include Firebird drivers)</p>\n\n<p>I guess native components are a bit faster, but that's not too important for me.</p>\n\n<p>What are the advantages/disadvantages of each approach and why should I choose one over the other?</p>\n"},{"tags":["delphi","dll","delphi-7","delphi-xe3"],"answer_count":1,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":216,"score":6,"question_id":12774283,"title":"How can I reduce the size of my Delphi dll's?","body":"<p>I recently moved from Delphi 7 to Delphi XE3.</p>\n\n<p>A dll file that was 107kb in Delphi 7 is now compiling to 2.7 MB.\nAnother that was 114kb is now 4.7 MB!</p>\n\n<p>Is this normal?\nWhat might I do to reduce the file sizes?\nIf you need more info please ask.</p>\n\n<p>UPDATE:</p>\n\n<p>Both dll files were already being compiled in release mode.</p>\n\n<p>After following Mason's advice:</p>\n\n<p>The 4.7MB file was reduced to 834kb and the 2.7MB file was reduced to 2.1MB.\nThe 2.1MB file makes use of Generics and an external library called nExcel used for generating Excel files. Whilst nExcel was also used when the file size was smaller the use of Generics is a new addition to the code and I guess may be the reason for the file size remaining fairly large.</p>\n"},{"tags":["delphi","delphi-xe2","firemonkey"],"answer_count":2,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":1125,"score":7,"question_id":8988131,"title":"Fastest way to draw pixels in FireMonkey","body":"<p>I have made the following code:</p>\n\n<pre><code>procedure TForm15.Button1Click(Sender: TObject);\nvar\n  Bitmap1: TBitmap;\n  im: TImageControl;\n  Color: TColor;\n  Scanline: PAlphaColorArray;\n  x,y,i: Integer;\nbegin\n  for i:= 1 to 100 do begin\n    im:= ImageControl1;\n    Bitmap1:= TBitmap.Create(100,100);\n    try\n      for y:= 0 to 99 do begin\n        ScanLine:= Bitmap1.ScanLine[y];\n        for x:= 0 to 99 do begin\n          ScanLine[x]:= Random(MaxInt);\n        end;\n      end;\n      ImageControl1.Canvas.BeginScene;\n      ImageControl1.Canvas.DrawBitmap(Bitmap1, RectF(0,0,Bitmap1.Width, Bitmap1.Height)\n                                     ,im.ParentedRect,1,true);\n      ImageControl1.Canvas.EndScene;\n    finally\n      Bitmap1.Free;\n    end;\n  end;\nend;\n</code></pre>\n\n<p>Is there a faster way to draw pixels in Firemonkey?<br>\nI aim to make a demo program using Conway's game of life.</p>\n"},{"tags":["delphi","compiler-errors","delphi-xe2","broadcast","indy10"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":12791237,"title":"Delphi XE2 TIdUDPClient ReceiveString overload does not work","body":"<p>I am using Embarcadero RAD Studio XE2 Update 4 and the Indy package shipped with it.</p>\n\n<p>My intention is to find a server in LAN with broadcast from a TIdUDPClient that waits for a response from the server to get its IP. Receiving the data works fine if I use the TIdUDPClient method ReceiveString with no arguments.</p>\n\n<p>But when I try to use the overloaded version found in the Indy 10 Documentation version 10.5.8.3 coming with RAD Studio, it does not compile and shows <em>'E2250: There is no overloaded version of 'ReceiveString' that can be called with these arguments'</em>.\nHere is my code:</p>\n\n<pre><code>unit Client;\n\ninterface\n\nuses\n  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,\n  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, IdBaseComponent, IdComponent, IdUDPBase,\n  IdUDPClient, Vcl.StdCtrls, IdGlobal;\n\ntype\n  TFormLC = class(TForm)\n    UDPClient: TIdUDPClient;\n    LServer: TLabel;\n    Label2: TLabel;\n    Label3: TLabel;\n    Button1: TButton;\n    procedure Button1Click(Sender: TObject);\n  private\n    { Private-Deklarationen }\n  public\n    { Public-Deklarationen }\n  end;\n\nvar\n  FormLC: TFormLC;\n\nimplementation\n\n{$R *.dfm}\n\nfunction findServer:string;\nvar ans, ip : string;\n    port: TIdPort;\nbegin\n  with FormLC.UDPClient do begin\n    Active := True;\n    BroadcastEnabled:=True;\n    Broadcast('ServerRequest', 1234);\n    ans := ReceiveString(ip, port);\n    Active := False;\n  end;\n  if SameText(ans, 'ServerAccept') then\n    result := ip\n  else\n    result := '';\nend;\n\n\nprocedure TFormLC.Button1Click(Sender: TObject);\nvar ans:string;\nbegin\n  LServer.Caption := findServer;\nend;\n\nend.\n</code></pre>\n\n<p>I noticed that the <a href=\"http://www.indyproject.org/docsite/html/frames.html?frmname=topic&amp;frmfile=index.html\" rel=\"nofollow\">online documentation</a> of Indy differs from the documentation that comes with the IDE and tried it as described there, without succes.</p>\n\n<p>Any help would be great!</p>\n"},{"tags":["delphi","com","access-denied","switch-user"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":12773935,"title":"After COM API call, getting EOSError Exceptions (access denied) but only when switching users or Locking the station on Windows 7","body":"<p>I have a Delphi 6 application that is getting an <em>EOSError Exception, code 5, access denied</em> but only when I switch away to another Windows 7 user account, or I Lock the station.  I am printing out a stack trace but the error appears to be coming straight from the Application.Run() statement with Application.ProcessMessages() immediately beneath it on the stack.  The rest of the stack is my Exception handling code.</p>\n\n<p>During operation the code does make calls to ShellExecuteEx() and accesses a COM/ActiveX object, but only when the user explicitly clicks a button.  This only happens on Windows 7, not on Windows XP.  I changed my application so that it installs completely to the user app data directory and therefore does not require access to any admin rights directories.  I know that shouldn't matter but I'm pointing it out just in case.</p>\n\n<p>When this happens the Exceptions come fast and furious. I trap them and dump them to an Error Log to avoid plaguing the user with a sea of dialog boxes.  Can anyone tell me what would trigger a flood of these errors merely by switching away from or locking the currently logged-in user?  Why would my app run into trouble when the current user account is not active?</p>\n\n<p>One thought. Do some bitmap operations cause trouble if the user is not currently logged in?  I do have a spinning tag cloud that does Windows API bitmap operations continually to update the tag cloud image.  Could that have something to do with it?</p>\n\n<p>If so, I could try deactivating the tag cloud when the current user is switched away or locked, but I believe I would need code for Delphi that reacts to the events mentioned in this Stack Overflow post:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/652550/how-do-i-detect-a-lock-this-computer-command-from-a-wpf-application\">How do I detect a Lock This Computer command from a WPF application?</a></p>\n\n<p><strong>UPDATE</strong>: I have done some additional testing.  The errors do not occur until I access the COM/ActiveX interface for Evernote, the software I am interacting with.  Once I make the first call to Evernote vai the COM API, the errors happen immediately when I Lock the station.</p>\n"},{"tags":["python","c","windows","delphi","winapi"],"answer_count":1,"favorite_count":10,"up_vote_count":15,"down_vote_count":0,"view_count":334,"score":15,"question_id":12697292,"title":"Detecting reflective DLL injection","body":"<p>In the past few years, malware (and some pen-test tools like Metasploit's meterpreter payload) have begun to use <a href=\"http://www.harmonysecurity.com/files/HS-P005_ReflectiveDllInjection.pdf\">reflective DLL injection (PDF)</a> to load a DLL into the memory of a process. The benefit is that the file is never written to disk and is difficult to detect. Many examples I've seen are based on <a href=\"http://www.joachim-bauch.de/2012/04/09/memorymodule-0-0-3-released/\">Joachim Bauch's work</a>.</p>\n\n<p>However, at DEF CON 20 (this year, 2012) Andrew King demonstrated that he was able to detect DLL's injected using reflective DLL injection. His presentation was called \"<a href=\"https://www.defcon.org/html/defcon-20/dc-20-speakers.html#King\">Detecting Reflective Injection</a>\". Unfortunately, he has not released the source code (which he certainly is under no obligation to do).</p>\n\n<p>In addition, a tool called \"<a href=\"http://www.mertsarica.com/antimeter-tool/\">Antimeter</a>\" can detect the meterpreter engine when loaded using reflective dll injection. Again, closed source.</p>\n\n<p>I understand that Andrew King's tool and Antimeter are both written in Python and use pydbg/pydasm in order to enumerate the memory of running executables.</p>\n\n<p>Does anyone have some general source code (in Python, C, Delphi, or otherwise) that they are willing to share that demonstrates how to detect reflective DLL injection? There are memory forensic tools that can analyze a memory dump and find this, but I'm looking to execute an application on a running system (like antimeter does) and find processes with reflectively injected DLL's.</p>\n\n<p>If you are interested in understanding how reflective DLL injection works, there is some <a href=\"http://code.google.com/p/memorymodule/\">open-source code written in Delphi</a> that shows how to do this.</p>\n\n<p><strong>UPDATE</strong>:\nI tested and I can reflectively inject DLL's without admin rights (and as a regular user), but of course as a USER I can only inject into processes running at the same integrity level (and in my session)...but that still covers applications like the Office suite, Internet Explorer, etc.</p>\n"},{"tags":["windows","delphi","winapi","special-folders","appdata"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":230,"score":6,"question_id":12771473,"title":"Finding a Windows user's \"true\" application data folder?","body":"<p>I have a Delphi 6 application that, like most Windows applications, reads/writes data to the user's \"local application data\" folder.  I use the code below to determine that folder.  Up until now, that code worked for most of my users.  I have encountered a user whose local application data is not in the expected folder:</p>\n\n<pre><code>C:\\Users\\Bob\\AppData\\Roaming\\\n</code></pre>\n\n<p>Usually the local app data folder resolves to:</p>\n\n<pre><code>C:\\Documents and Settings\\Bob\\Application Data\\\n</code></pre>\n\n<p>What is odd about this user's particular situation is that several registry keys normally found in HKEY_LOCAL_MACHINE are actually located in HKEY_CURRENT_USER.  They are running on Windows 7.</p>\n\n<p>For lack of a better word, is there a way to get the \"true\" application data for a user so I can navigate this situation better?  If it's a matter of intelligently choosing between  the CSIDL_APPDATA, CSIDL_COMMON_APPDATA and CSIDL_LOCAL_APPDATA special folders, what is the logic for doing so?  As you can tell I'm looking for an all-purpose function that can root out the correct application data folder regardless of the version of Windows the user is running or their specific PC configuration.</p>\n\n<p>I found this Stack Overflow post that seems to have the answer but it is using function from the .NET library and I am using Delphi 6.  If this solution answers my question, can someone tell me a quick way to replicate it in Delphi:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/915210/how-can-i-get-the-path-of-the-current-users-application-data-folder\">How can i get the path of the current user&#39;s &quot;Application Data&quot; folder?</a></p>\n\n<pre><code>// Function to get the app data special folder.\nfunction GetAppdataFolder: string;\nbegin\n   Result := GetSpecialFolderLocation(CSIDL_APPDATA);\nend;\n</code></pre>\n"},{"tags":["delphi","google","youtube-api","delphi-xe2","synapse"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":166,"score":0,"question_id":12787748,"title":"Sometimes receiving \"Metadata part is too large.\" from server. What this?","body":"<p>I've made an uploader to a YouTube account.\nSometimes I receive this result from the server:</p>\n\n<blockquote>\n  <p>Metadata part is too large.</p>\n</blockquote>\n\n<p>The sent-file size isn't more than 4 MB. </p>\n\n<p>The code:</p>\n\n<pre><code>    { TAuthThread }\n\nconstructor TWorkThread.Create;\nbegin\n  inherited Create(True);\n  fHTTP := THTTPSend.Create;\n  fHTTP.Protocol := '1.1';\n  fHTTP.UserAgent :=\n    'Opera/9.80 (Windows NT 5.1; U; ru) Presto/2.10.289 Version/12.01';\n  fHTTP.Sock.OnStatus := fHttpStatus;\n  fItems := TObjectList.Create;\n\nend;\n\ndestructor TWorkThread.Destroy;\nbegin\n  SyncOnWorkEnd;\n  FreeAndNil(fItems);\n  FreeAndNil(fHTTP);\n  inherited;\nend;\n\nprocedure TWorkThread.Execute;\n\n  procedure ParseError(aStream: TStream);\n  const\n    cLogErrorRec       = '[Error] %d(%s): Type: %s Code: %s Location(%s): %s';\n    cLogErrorRec_NoLoc = '[Error] %d(%s): Type: %s Code: %s';\n  var\n    XML: TNativeXml;\n    xNode, xNode2: TXmlNode;\n    sDomain, sCode, sLocation, sType: string;\n    SS: TStringStream;\n  begin\n    XML := TNativeXml.CreateName('&lt;errors&gt;');\n    try\n      XML.LoadFromStream(aStream);\n      if Assigned(XML.Root) then\n      begin\n        with XML.Root do\n        begin\n          xNode := NodeByName('Error');\n          if Assigned(xNode) then\n          begin\n            with xNode do\n            begin\n              sDomain := ReadString('domain');\n              sCode := ReadString('code');\n              xNode2 := NodeByName('location');\n              if Assigned(xNode) then\n              begin\n\n                sType := xNode2.ReadAttributeString('type');\n                sLocation := xNode2.Value;\n                SyncLog(Format(cLogErrorRec_NoLoc, [fHTTP.ResultCode,\n                  fHTTP.ResultString, sDomain, sCode, sType, sLocation]));\n              end\n              else\n              begin\n                SyncLog(Format(cLogErrorRec_NoLoc, [fHTTP.ResultCode,\n                  fHTTP.ResultString, sDomain, sCode]));\n              end;\n            end;\n          end;\n        end;\n      end\n      else\n      begin\n        SS := TStringStream.Create;\n        try\n          SS.LoadFromStream(aStream);\n          SyncLog('ParseError Func Error: Input stream is not' +\n            'XML stream. DATA as STRING: ' + CRLF + SS.DataString);\n        finally\n          FreeAndNil(SS);\n        end;\n      end;\n    finally\n      FreeAndNil(XML);\n    end;\n  end;\n\nvar\n  sBeginAuthData: string;\n  aStream: TStringStream; // Поток вывода ответа сервера\n  MS: TMemoryStream;\n  sHTML: TStringList;\n  sAuthKey, sFileName, sTitle, sDesc, sBound: string;\n  sItem: TVideoFile;\n  i, iMax: Integer;\n  XML: TNativeXml;\n  sLocationURL: string;\n  sStatus: string;\n  sVideoID: string;\n  sUpURL, sUpToken, iID: string;\nbegin\n  NameThreadForDebugging('TWorkThread');\n  { Place thread code here }\n  aStream := TStringStream.Create;\n  sHTML := TStringList.Create;\n  try\n    try\n\n      fHTTP.Clear;\n      fHTTP.Document.Clear;\n      aStream.Clear;\n      iMax := fItems.Count;\n      for i := 0 to iMax - 1 do\n      begin\n        if Terminated then\n          Exit;\n\n        // ;)\n        fHTTP.Clear;\n        fHTTP.Document.Clear;\n        aStream.Clear;\n\n        sItem := (fItems.Items[i] as TVideoFile);\n        iID := sItem.ID;\n        SyncOnItemChange(iID, i + 1, iMax);\n        SyncLog('Element: ' + iID + ' File: ' + sItem.FileName);\n\n        if not FileExists(sItem.FileName) then\n        begin\n          SyncLog('Skipping file.. Reasson: File does not exists.');\n          Continue;\n        end;\n\n        sBeginAuthData := Format(cGAPI_LoginURL_POST_DATA,\n          [EncodeURL(fUserLogin), EncodeURL(fUserPassword),\n          EncodeURL(cApp_Gid)]);\n        fHTTP.MimeType := 'application/x-www-form-urlencoded';\n        WriteStrToStream(fHTTP.Document, sBeginAuthData);\n        SyncOnWorkEnd;\n        SyncOnWorkBegin;\n        if Terminated then\n          Exit;\n        SyncLog('Reciving token...');\n        if fHTTP.HTTPMethod('POST', cGAPI_LoginURL_POST) then\n        begin\n          if Terminated then\n            Exit;\n\n          aStream.LoadFromStream(fHTTP.Document);\n          sHTML.Text := aStream.DataString;\n          sHTML.NameValueSeparator := '=';\n\n          if fHTTP.ResultCode = 200 then\n          begin\n            if Terminated then\n              Exit;\n            if sHTML.IndexOfName('Auth') &lt;&gt; -1 then\n            begin\n              sAuthKey := sHTML.Values['Auth'];\n              SyncOnLogin(sAuthKey, '', lrOk);\n              SyncLog('Token ricived: ' + sAuthKey);\n              {\n                POST FILE ON WEB\n              }\n              sBound := iID + '_YUB';\n              fHTTP.Clear;\n              fHTTP.Document.Clear;\n              aStream.Clear;\n              SyncLog('Reciving upload token...');\n              // Получение Upload токена:\n              fHTTP.TargetHost := 'gdata.youtube.com';\n              fHTTP.Headers.Add('Authorization: GoogleLogin auth=\"' +\n                sAuthKey + '\"');\n              fHTTP.Headers.Add('X-GData-Key: key=' + cYTDevKey);\n              fHTTP.Headers.Add('GData-Version: 2');\n              fHTTP.MimeType := 'application/atom+xml; charset=UTF-8';\n              if Terminated then\n                Exit;\n              { XML REQUEST }\n              XML := TNativeXml.CreateName('entry');\n              try\n                XML.XmlFormat := xfReadable;\n                with XML.Root do\n                begin\n                  WriteAttributeString('xmlns', 'http://www.w3.org/2005/Atom');\n                  WriteAttributeString('xmlns:media',\n                    'http://search.yahoo.com/mrss/');\n                  WriteAttributeString('xmlns:yt',\n                    'http://gdata.youtube.com/schemas/2007');\n                  with NodeNew('media:group') do\n                  begin\n                    with NodeNew('media:title') do\n                    begin\n                      WriteAttributeString('type', 'plain');\n                      Value := sItem.Title;\n                    end;\n\n                    with NodeNew('media:description') do\n                    begin\n                      WriteAttributeString('type', 'plain');\n                      Value := sItem.Description;\n                    end;\n\n                    with NodeNew('media:category') do\n                    begin\n                      WriteAttributeString('scheme',\n                        'http://gdata.youtube.com/schemas/2007/categories.cat');\n                      Value := 'Film';\n                    end;\n                    WriteString('media:keywords', fTags);\n                  end;\n                end;\n                XML.XmlFormat := xfReadable;\n                XML.SaveToStream(fHTTP.Document);\n              finally\n                FreeAndNil(XML);\n              end;\n\n              { UPLOAD TOKEN REQUEST }\n              SyncOnWorkBegin;\n              if Terminated then\n                Exit;\n              if fHTTP.HTTPMethod('POST', cGAPI_UPLOAD_M2_GETTOKENURL_POST) then\n              begin\n                if Terminated then\n                  Exit;\n                { Получение маркера аплоода }\n                if fHTTP.ResultCode = 200 then\n                begin\n\n                  // PArse XML\n                  try\n                    XML := TNativeXml.CreateName('response');\n                    try\n                      XML.LoadFromStream(fHTTP.Document);\n                      with XML.Root do\n                      begin\n                        sUpURL := ReadString('url');\n                        sUpToken := ReadString('token');\n                      end;\n                    finally\n                      FreeAndNil(XML);\n                    end;\n                  except\n                    on E: Exception do\n                    begin\n                      SyncLog('[Error] ' + E.ClassName + ' ' + E.Message);\n                      SyncOnItemDone(sItem.ID, sError, '');\n                      Continue;\n                    end;\n                  end;\n\n                  fHTTP.Clear;\n                  fHTTP.Document.Clear;\n\n                  // !! Не забыть про ЭТО\n                  fHTTP.Headers.Add('Authorization: GoogleLogin auth=\"' +\n                    sAuthKey + '\"');\n                  fHTTP.Headers.Add('X-GData-Key: key=' + cYTDevKey);\n                  fHTTP.Headers.Add('GData-Version: 2');\n                  // !!\n\n                  SyncLog('Recived upload token = ' + sUpToken);\n                  SyncLog('Preparing to upload a file \"' + sItem.FileName\n                    + '\"...');\n\n                  sHTML.Clear;\n                  sHTML.Add('');\n                  sHTML.Add('--' + sBound);\n                  sHTML.Add(\n                    'content-disposition: form-data; name=\"File\"; Filename=\"' +\n                    ExtractFileName(sItem.FileName) + '\"');\n                  sHTML.Add('Content-Type: Video/flv');\n                  sHTML.Add('');\n                  WriteStrToStream(fHTTP.Document, sHTML.Text);\n\n                  MS := TMemoryStream.Create;\n                  try\n                    MS.LoadFromFile(sItem.FileName);\n                    MS.Position := 0;\n                    fHTTP.Document.CopyFrom(MS, MS.Size);\n                  finally\n                    FreeAndNil(MS);\n                  end;\n\n                  sHTML.Clear;\n                  sHTML.Add('');\n                  sHTML.Add('--' + sBound);\n                  sHTML.Add('content-disposition: form-data; name=\"token\";');\n                  sHTML.Add('Content-Type: Application/octet-string');\n                  sHTML.Add('');\n                  sHTML.Add(sUpToken);\n                  sHTML.Add('--' + sBound);\n                  sHTML.Add('content-disposition: form-data; name=\"submit\";');\n                  sHTML.Add('Content-Type: Application/octet-string');\n                  sHTML.Add('');\n                  sHTML.Add('go');\n                  sHTML.Add('');\n                  sHTML.Add('--' + sBound + '--');\n                  WriteStrToStream(fHTTP.Document, sHTML.Text);\n                  fHTTP.MimeType := 'multipart/form-data; boundary=' + sBound;\n                  SyncLog('Uploading file....');\n                  SyncOnWorkBegin;\n                  if Terminated then\n                    Exit;\n                  if fHTTP.HTTPMethod('POST',\n                    Format(cGAPI_UPLOAD_M2_UPLOADURL_POST, [sUpURL])) then\n                  begin\n                    if Terminated then\n                      Exit;\n                    SyncOnWorkEnd;\n                    if fHTTP.ResultCode = 302 then\n                    begin\n                      fHTTP.Headers.NameValueSeparator := ':';\n                      sLocationURL := fHTTP.Headers.Values['Location'];\n                      if Pos('status=', sLocationURL) &gt; 0 then\n                      begin\n                        Delete(sLocationURL, 1, Pos('status=', sLocationURL) +\n                          Length('status=') - 1);\n                        sStatus := Copy(sLocationURL, 1,\n                          Pos('&amp;', sLocationURL) - 1);\n                        if sStatus = '200' then\n                        begin\n                          SyncLog('File uploaded! Answer: ' + sStatus);\n                          SyncOnItemDone(sItem.ID, sOK, '');\n                        end\n                        else\n                        begin\n                          SyncOnItemDone(iID, sError, '');\n                          SyncLog('Upload error. Answer: ' +\n                            sLocationURL);\n                        end;\n                      end;\n                    end\n                    else\n                    begin\n                      SyncOnItemDone(iID, sError, '');\n                      SyncOnWorkEnd;\n                      ParseError(fHTTP.Document);\n                    end;\n                    if Terminated then\n                      Exit;\n                  end\n                  else\n                  begin\n                    SyncOnItemDone(iID, sError, '');\n                    SyncLog(Format('[Error HTTP] Code: %d Str: %s',\n                      [fHTTP.ResultCode, fHTTP.ResultString]));\n                    SyncOnWorkEnd;\n                  end;\n                  if Terminated then\n                    Exit;\n                end\n                else\n                begin\n                  SyncOnItemDone(iID, sError, '');\n                  ParseError(fHTTP.Document);\n                end;\n                if Terminated then\n                  Exit;\n              end\n              else\n              begin\n                SyncOnItemDone(iID, sError, '');\n                SyncLog(Format('[Error HTTP] Code: %d Str: %s',\n                  [fHTTP.ResultCode, fHTTP.ResultString]));\n                SyncOnWorkEnd;\n              end;\n              if Terminated then\n                Exit;\n            end\n            else\n            begin\n              SyncOnItemDone(iID, sError, '');\n              SyncLog('[Error] Unable to get token');\n              SyncOnWorkEnd;\n            end;\n            if Terminated then\n              Exit;\n          end // if http result\n          else\n          begin\n            if fHTTP.ResultCode = 403 then\n            begin\n              if sHTML.IndexOfName('Error') &lt;&gt; -1 then\n                SyncOnLogin('', '', GetErrorState(sHTML.Values['Error']))\n              else\n                SyncOnLogin(sHTML.Text,\n                  Format('[%d] %s', [fHTTP.ResultCode,\n                  fHTTP.ResultString]), lrNone)\n            end\n            else\n            begin\n              SyncOnLogin(sHTML.Text, Format('[%d] %s', [fHTTP.ResultCode,\n                fHTTP.ResultString]), lrError);\n            end;\n            SyncOnItemDone(sItem.ID, sError, '');\n            SyncOnWorkEnd;\n          end;\n          if Terminated then\n            Exit;\n        end\n        else\n        begin\n          SyncOnItemDone(sItem.ID, sError, '');\n          SyncLog(Format('[Error HTTP] Code: %d Str: %s',\n            [fHTTP.ResultCode, fHTTP.ResultString]));\n          SyncOnWorkEnd;\n          SyncOnLogin(sHTML.Text, Format('[%d] %s', [fHTTP.ResultCode,\n            fHTTP.ResultString]), lrNone);\n        end;\n        if Terminated then\n          Exit;\n      end;\n      if Terminated then\n        Exit;\n    finally\n      FreeAndNil(aStream);\n      FreeAndNil(sHTML);\n    end;\n  except\n    on E: Exception do\n    begin\n      SyncLog(Format('[Error HTTP] Code: %d Str: %s',\n        [fHTTP.ResultCode, fHTTP.ResultString]));\n      SyncLog(Format('[Error HTTP] Code: %d Str: %s',\n        [GetLastError, SysErrorMessage(GetLastError)]));\n    end;\n  end;\n  SyncOnWorkEnd;\nend;\n</code></pre>\n\n<p>All other files successfully sent. \nWhy this is happening?</p>\n\n<p>File transmit request after ClientLogin and GetUploadToken procedures:</p>\n\n<pre><code>POST /action/FormDataUpload/&lt;HERE UPLOAD TOKEN&gt;?nexturl=http://youtube.com/ HTTP/1.1\nHost: uploads.gdata.youtube.com\nKeep-Alive: 300\nConnection: keep-alive\nUser-Agent: Opera/9.80 (Windows NT 5.1; U; ru) Presto/2.10.289 Version/12.01\nContent-Type: multipart/form-data; boundary=3D9C4A05_YUB\nContent-Length: 4874095\nAuthorization: GoogleLogin auth=\"&lt;HERE AUTH TOKEN&gt;\"\nX-GData-Key: key=&lt;HERE MY API KEY&gt;\nGData-Version: 2\n\n\n--3D9C4A05_YUB\ncontent-disposition: form-data; name=\"File\"; Filename=\"12312312.flv\"\nContent-Type: Video/flv\n&lt;FILE DATA AS THE STREAM&gt;\n--3D9C4A05_YUB\ncontent-disposition: form-data; name=\"token\";\nContent-Type: Application/octet-string\n\n&lt;HERE UPLOAD TOKEN&gt;\n--3D9C4A05_YUB\ncontent-disposition: form-data; name=\"submit\";\nContent-Type: Application/octet-string\n\ngo\n\n--3D9C4A05_YUB--\n</code></pre>\n"},{"tags":["delphi","winapi","struct","delphi-xe2","code-conversion"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":195,"score":2,"question_id":12763551,"title":"How to translate RETRIEVAL_POINTERS_BUFFER structure to Delphi?","body":"<p>I'm working with Windows API and have to recreate <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/aa365521%28v=vs.85%29.aspx\" rel=\"nofollow\">a structure</a> inside a Delphi <code>record</code>. I think I have it down, but this one was a little confusing and I need to make sure I did this right.</p>\n\n<p>Here's the original C++ structure:</p>\n\n<pre><code>typedef struct RETRIEVAL_POINTERS_BUFFER {\n  DWORD         ExtentCount;\n  LARGE_INTEGER StartingVcn;\n  struct {\n    LARGE_INTEGER NextVcn;\n    LARGE_INTEGER Lcn;\n  } Extents[1];\n} RETRIEVAL_POINTERS_BUFFER, *PRETRIEVAL_POINTERS_BUFFER;\n</code></pre>\n\n<p>Notice that there's an array struct within this struct. This is where I got lost. If I'm not mistaken, the Delphi version should look like this:</p>\n\n<pre><code>  TExtent = record\n    NextVcn: Integer;\n    Lcn: Integer;\n  end;\n\n  TExtents = array of TExtent;\n\n  PRETRIEVAL_POINTERS_BUFFER = ^TRETRIEVAL_POINTERS_BUFFER;\n  TRETRIEVAL_POINTERS_BUFFER = record\n    ExtentCount: DWORD;\n    StartingVcn: Integer;\n    Extents: TExtents;\n  end;\n</code></pre>\n\n<p>When I use this structure in the Windows API, it does appear to work. But, because of this structure array inside of the structure, I'm a little hesitant that I did this correctly. Does this look right?</p>\n"},{"tags":["delphi","user-interface","frame","delphi-2006"],"answer_count":1,"favorite_count":6,"up_vote_count":4,"down_vote_count":0,"view_count":274,"score":4,"question_id":11675374,"title":"How to make TFrame with rounded corners?","body":"<p>I want to make a component based on a <code>TFrame</code> with <code>TLMDShapeControl</code> (for drawing round corner background) and a <code>TEdit</code> control (that can be also a <code>TComboBox</code> or a <code>TDBEdit</code> and so on).\nAfter that I will use the \"Add to Palette\" command to turn it into a Reusable Component Control.</p>\n\n<p>The problem in that I need it to be width flexible and for that I had the idea of turn everything inside the Frame <code>alClient</code> and the <code>TEdit</code> with 5 pixel margin so the user can see the rounded corners.</p>\n\n<p>It was terrible because I can't use <code>Align</code> and set components one in the top of another. Now I have to copy and paste the components on every time I have to use it! :-(((</p>\n\n<p>The only way I see the right thing is to use only the <code>TEdit</code> with <code>alClient</code> and 5px margin and no <code>TShape</code>. Instead I could make the <code>TFrame</code> to be rounded corner with transparency, so it won't look ugly on of different colors or <code>TImages</code>.</p>\n\n<p>But how do I do that?</p>\n\n<p>Does anyone have any code sample?</p>\n\n<p><img src=\"http://i.stack.imgur.com/xw2HY.png\" alt=\"this is the goal: transparent rounded corners\"></p>\n"},{"tags":["delphi"],"answer_count":3,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":427,"score":7,"question_id":10468787,"title":"How to make one shot timer function in Delphi (like setTimeout in JavaScript)?","body":"<p>The <a href=\"http://www.w3schools.com/jsref/met_win_settimeout.asp\" rel=\"nofollow\"><code>setTimeout</code></a> is helpful in JavaScript language. How would you create this function in delphi ?</p>\n\n<pre><code>SetTimeOut(procedure (Sender: TObject);\nbegin\n  Self.Counter := Self.Counter + 1;\nend, 200);\n</code></pre>\n"},{"tags":["delphi","windows-7","windows-vista","savefiledialog","save-as"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2936,"score":2,"question_id":2145299,"title":"(Save Dialog) How to change file extension automatically on file filter change in Vista/Win7?","body":"<p>While showing a save dialog, I want to hook user's filter type change and change file extension automatically. (e.g. like MSPaint's \"Save As\" operation.)</p>\n\n<p>With TSaveDialog and setting UseLatestCommonDialogs := False, \nI can handle this by the following code. (without latest common dialog support, of cource.)</p>\n\n<pre><code>procedure TForm1.SaveDialog1TypeChange(Sender: TObject);\nvar\n  FName, Ext: string;\nbegin\n  with TSaveDialog(Sender) do\n  begin\n    if DirectoryExists(FileName) then // FileName is Empty\n      exit;\n    case FilterIndex of\n    1: Ext := '.png';\n    2: Ext := '.bmp';\n    3: Ext := '.jpg';\n    end;\n    FName := ChangeFileExt(ExtractFileName(FileName), Ext);\n    SendMessage(Windows.GetParent(Handle), CDM_SETCONTROLTEXT, 1152, LongInt(PChar(FName)));\n  end;\nend;\n</code></pre>\n\n<p>I want to support both XP, and vista/7 with Delphi 2007.</p>\n\n<p>Should I use TFileSaveDialog instead of TSaveDialog with internal wrapper ?\n(And I have to struggle with COM programming using <a href=\"http://akirabbq.spaces.live.com/blog/cns!CEB8A04DC43BCEE9!283.entry\" rel=\"nofollow\">IFileDialogControlEvents</a> ?)</p>\n\n<p>Or can I achieve this with TFileSaveDialog and it's standard properties only ?\n(My development environment is still on XP machine, so I've never tried. sorry.)</p>\n\n<p>I think it's very common task, but I couldn't find any sample code supporting Vista/7...</p>\n"},{"tags":["delphi","delphi-xe2","richedit"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":669,"score":3,"question_id":10474883,"title":"Why am I getting RichEdit line insertion error when I call Delete in OnChange event?","body":"<p>I've googled and checked many places for a solution, but all cases I found differed or involved something more advanced than simply adding or deleting lines. Basically, I want to make a sort of scrolling rich edit (alternative would be moving the caret to the bottom, which I already found a solution for).</p>\n\n<p>I'm adding lines to it and checking <code>Lines.Count</code> with the <code>OnChange</code> event of the rich edit and as soon as it reaches value greater 15 I want to call <code>Lines.Delete(0)</code>, however I get the error:</p>\n\n<pre><code>RichEdit line insertion error\n</code></pre>\n\n<p>Can someone tell me what am I doing wrong here ?</p>\n"},{"tags":["delphi","delphi-2009"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":282,"score":3,"question_id":7704265,"title":"How to create a file shortcut (*.lnk file) on desktop in Windows?","body":"<pre><code>function GetDesktopFolder: string;\nvar\n  buf: array[0..MAX_PATH] of Char;\n  pidList: PItemIDList;\nbegin\n  Result := StrNoDesktopFolderFo;\n  SHGetSpecialFolderLocation(Application.Handle, CSIDL_DESKTOP, pidList);\n  if (pidList &lt;&gt; nil) then\n    if (SHGetPathFromIDList(pidList, buf)) then\n      Result := buf;\nend;\n\nprocedure p;\nvar\n  i: Integer;\n  IObject: IUnknown;\n  ISLink: IShellLink;\n  IPFile: IPersistFile;\n  PIDL: PItemIDList;\n  InFolder: array[0..MAX_PATH] of Char;\n  TargetName: string;\n  LinkName: string;\nbegin\n  TargetName := 'c:\\folder\\exeFile.exe';//hardcoded example\n\n  IObject := CreateComObject(CLSID_ShellLink) ;\n  ISLink := IObject as IShellLink;\n  IPFile := IObject as IPersistFile;\n\n  with ISLink do\n  begin\n    SetDescription('what ever');\n    SetPath(pChar(TargetName)) ;\n    SetWorkingDirectory(pChar(ExtractFilePath(TargetName))) ;\n  end;\n\n  SHGetSpecialFolderLocation(0, CSIDL_DESKTOPDIRECTORY, PIDL) ;\n  SHGetPathFromIDList(PIDL, InFolder) ;\n\n  LinkName := getDesktopFolder+'\\';\n  i := ;\n\n  LinkName:= linkname+ExtractFileName(TargetName)+'.lnk';\n\n  if LinkName = StrNoDesktopFolderFo then\n    Exit;\n  if not FileExists(LinkName) then\n    IPFile.Save(PWChar(LinkName), False);\n\n  Application.Terminate;\nend;\n</code></pre>\n\n<p>The above code causes a lot of errors in Delphi and cannot run twice...</p>\n\n<p>Any ideas ?</p>\n\n<p>Btw. the source is not originally mine, it was picked up from places on the web.</p>\n"},{"tags":["delphi","scintilla"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":410,"score":6,"question_id":7812668,"title":"Is there an example of syntax highlighting for DScintilla?","body":"<p>I have installed <a href=\"http://code.google.com/p/dscintilla/\" rel=\"nofollow\"><code>DScintilla</code></a>, Delphi VCL wrapper for <a href=\"http://www.scintilla.org/\" rel=\"nofollow\"><code>Scintilla</code></a> code editing component, but I can't find any basic example of how to use it.</p>\n\n<p>Could you post some basic code example of syntax highlighting or a reference to code examples for it ?</p>\n"},{"tags":["delphi","winapi","windows-7","delphi-xe2","windows-explorer"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":222,"score":4,"question_id":10680899,"title":"Is there a way to change text background color of the items in Windows Explorer in Windows 7?","body":"<p><img src=\"http://i.stack.imgur.com/lvAl9.jpg\" alt=\"http://screenshots.en.sftcdn.net/en/scrn/39000/39972/xentient-labels-1.jpg\"></p>\n\n<p>Is is possible to change background color of the items in Windows Explorer like the <a href=\"http://xentient-labels.en.softonic.com/\" rel=\"nofollow\"><code>Xentient Labels</code></a> application does ? Is it possible to do so from Delphi XE2 in Windows 7 ?</p>\n"},{"tags":["delphi","tchromium","view-source"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":480,"score":3,"question_id":10833805,"title":"How to disable view source option in Chromium Embedded?","body":"<p>Is it possible to disable view source option in Delphi Chromium Embedded ?<br>\nI haven't found anything suitable in properties/methods list.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":429,"score":4,"question_id":10947836,"title":"How to make a popup menu with scrollbar?","body":"<p>I use <code>TPopupMenu</code> in my program, I would like to add a vertical scrollbar in it and be able to set its size (say 10 visible items), and handle the events moving the slider scrollbar (after clicking on the buttons, or after scrolling the mouse wheel). I would like to know the components with this functional exist, or I will be glad of the theory about creating this component.\nFor example, I need behavior similar to popup menu in Vista/7 Explorer's address bar (with a list of subfolders in current folder)</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","winapi","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":92,"score":1,"question_id":12182596,"title":"Is there a way to modify value of FD_SETSIZE (WinSock) in Delphi?","body":"<p>Is there any way to increment value of <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms739169%28v=vs.85%29.aspx\" rel=\"nofollow\"><code>FD_SETSIZE</code></a> (WinSock) in Delphi 7 application ?</p>\n\n<p>In C++ I can define it before using <code>include</code>, but for Delphi it is impossible.</p>\n"},{"tags":["delphi","pdf","printing","delphi-4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":132,"score":1,"question_id":12765981,"title":"PDF printed as garbage with Brother printers","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2055307/delphi-how-to-print-a-pdf-without-showing-it\">Delphi: How to print a PDF without showing it?</a>  </p>\n</blockquote>\n\n\n\n<p>I am encountering different behavior while printing on different printers.\nOn my printer the PDF print is correct but with \"Brother\" printers the same PDF is printed as gibberish (the content of the file gets printed). If the same PDF file is directly sent to printer using Adobe Reader, its printed correctly on the brother printer also.</p>\n\n<p>To print the PDF file, I read the content in a TMemoryStream object using LoadFromFile function. The docinfo values specified are as below -</p>\n\n<pre><code>DocInfo.pDocName := pChar('My Document');\nDocInfo.pOutput := Nil;\nDocInfo.pDatatype := pChar('RAW');\n</code></pre>\n\n<p>After that Using the WritePrinter function, the command is sent to the printer handle.</p>\n\n<p>Looks to me as if brother printer is not able to read the PDF encoding format.</p>\n\n<p>Any help in this regard is appreciated.  </p>\n\n<p>P.S : My application is in Delphi4.</p>\n"},{"tags":["delphi","webbrowser-control","delphi-xe2","firemonkey"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":1331,"score":7,"question_id":9327111,"title":"Is there a web browser component for use in FireMonkey application?","body":"<p>For Delphi VCL there is <a href=\"http://docwiki.embarcadero.com/Libraries/XE2/en/SHDocVw.TWebBrowser\" rel=\"nofollow\"><code>TWebBrowser</code></a> and some 3rd party components like <a href=\"http://www.bsalsa.com/downloads.html\" rel=\"nofollow\"><code>TEmbeddedWebBrowser</code></a> available for browsing a web.</p>\n\n<p>Is there a similar web browser component but for <strong>Firemonkey</strong> framework in <strong>Delphi XE2</strong> (ideally with Windows and Mac support) ?</p>\n"},{"tags":["windows","delphi","winapi","handle","window-handles"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":1,"view_count":388,"score":5,"question_id":9018903,"title":"How to get count of opened handles that belongs to a certain process?","body":"<p>You can use the program <a href=\"http://technet.microsoft.com/en-us/sysinternals/bb896653\" rel=\"nofollow\">Process Explorer</a> to see how many handles running applications have.  Is there a way with Delphi code to get this number?  I am interested in tracking the number for the application itself; not to find the number of handles used by other applications as Process Explorer is doing. </p>\n\n<p>My intention is for the application to track/detect possible resource leaks.</p>\n"},{"tags":["delphi","components","delphi-xe2","vcl","embarcadero"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12770787,"title":"Delphi IDE Menu integration - INTAServices","body":"<p>I successfully installed my menu item inside Delphi using INTAServices40 but the problem is - menu is missing the next time Delphi starts?! Actually, two menu items are installed; One under Help menu which is ALWAYS shown (IOTAWizardMenu), but the one under Tools menu (TEST menu item) is missing the next time Delphi starts. How to fix this?</p>\n\n<pre><code>unit TESTMENU;\n\ninterface    \nuses\n   ToolsAPI, Classes, Windows, vcl.Menus, vcl.dialogs;    \ntype\n   TCustomMenuItem = class(TNotifierObject, IOTAWizard, IOTAMenuWizard)\n     function GetIDString: string;\n     function GetName: string;\n     function GetState: TWizardState;\n     // Launch the AddIn\n     procedure Execute;\n     function GetMenuText: string;\n   end;\n\n   TCustomMenuHandler = class(TObject)\n    // Handle custom menu\n     procedure HandleClick(Sender: TObject);\n   end;\n\nprocedure Register;\n\nimplementation    \nvar\n  mnuitem: TMenuItem;\n  CustomMenuHandler: TCustomMenuHandler;\n\nprocedure TCustomMenuItem.Execute;\nbegin\n  ShowMessage('IOTAWizardMenu based menu item');\nend;\n\nfunction TCustomMenuItem.GetIDString: string;\nbegin\n  Result := 'TMS.MenuSample';\nend;\n\nfunction TCustomMenuItem.GetMenuText: string;\nbegin\n  Result := 'IOTAWizardMenu';\nend;\n\nfunction TCustomMenuItem.GetName: string;\nbegin\n  Result := 'TMSMenuSample';\nend;\n\nfunction TCustomMenuItem.GetState: TWizardState;\nbegin\n  Result := [wsEnabled];\nend;\n\nprocedure TCustomMenuHandler.HandleClick(Sender: TObject);\nbegin\n  ShowMessage('INTAServices40.MainMenu based menu item');\nend;   \n\nprocedure AddIDEMenu;\nvar\n  NTAServices: INTAServices40;    \nbegin\n  NTAServices := BorlandIDEServices as INTAServices40;\n\n  // avoid inserting twice\n  if NTAServices.MainMenu.Items[9].Find('TEST') = nil then\n  begin\n    CustomMenuHandler := TCustomMenuHandler.Create;\n\n    mnuitem := TMenuItem.Create(nil);\n    mnuitem.Caption := 'TEST';\n    mnuitem.OnClick := CustomMenuHandler.HandleClick;\n    NTAServices.MainMenu.Items[9].Add(mnuitem)\n  end;\nend;\n\nprocedure RemoveIDEMenu;\nvar\n  NTAServices: INTAServices40;\nbegin\n  if Assigned(mnuitem) then\n  begin\n    NTAServices := BorlandIDEServices as INTAServices40;\n    NTAServices.MainMenu.Items[9].Remove(mnuitem);\n    mnuitem.Free;\n    if Assigned(CustomMenuHandler) then\n      CustomMenuHandler.Free;\n  end;\nend;\n\nprocedure Register;\nbegin\n  AddIDEMenu;\n  RegisterPackageWizard(TCustomMenuItem.Create);\nend;\n\ninitialization\n  mnuitem := nil;    \n  CustomMenuHandler := nil;    \nfinalization\n  RemoveIDEMenu;\nend.\n</code></pre>\n\n<p>So, my first problem is how to get menu item TEST shown each time Delphi starts.. Also, I would like to add icon next to the menu item TEST. Any directions? </p>\n\n<p>Thank you</p>\n\n<p><strong>EDIT:</strong> \nI just found out my package is delayed loading. Reading the Internet people say   ForceDemandLoadState(dlDisable) should be called. But, this is not helping me also....</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":126,"score":1,"question_id":12782290,"title":"Drawing over desktop to emphasize mouse clicks with Delphi","body":"<p>How can I draw over the desktop window to draw a circle animation on user clicks...</p>\n\n<p>I already trying the code below, launching a Thread to draw the animation...</p>\n\n<p>The code below works, but has some paint problems:</p>\n\n<pre><code>unit UMouseEmphasizer;\n\ninterface\n\nimplementation\n\nuses\n  Classes, Windows, Messages, Graphics, Forms;\n\ntype\n  TEmphasizePointDrawer = class(TThread)\n  private\n    fPoint: TPoint;\n    fCanvas: TCanvas;\n  protected\n    procedure Execute; override;\n  public\n    constructor Create(pt: TPoint); reintroduce;\n    destructor Destroy; override;\n  end;\n\nconstructor TEmphasizePointDrawer.Create(pt: TPoint);\nbegin\n  fPoint := pt;\n  fCanvas := TCanvas.Create;\n  fCanvas.Handle := GetDCEx(0, 0, DCX_PARENTCLIP);\n  inherited Create(True);\n  FreeOnTerminate := True;\n  Resume;\nend;\n\ndestructor TEmphasizePointDrawer.Destroy;\nbegin\n  ReleaseDC(0, fCanvas.Handle);\n  fCanvas.Free;\n  inherited;\nend;\n\nprocedure TEmphasizePointDrawer.Execute;\nconst\n  INFLATE_DELTA = 10;\nvar\n  i: integer;\n  r: TRect;\nbegin\n  r := rect(0,0,0,0);\n  with fCanvas do\n  begin\n    Brush.Style := bsClear;\n    Pen.Style := psSolid;\n    Pen.Color := clRed;\n    Pen.Width := 2;\n\n    for i := 0 to 2 do\n    begin\n      r := rect(\n        fPoint.X - (i * INFLATE_DELTA),\n        fPoint.Y - (i * INFLATE_DELTA),\n        fPoint.X + (i * INFLATE_DELTA),\n        fPoint.Y + (i * INFLATE_DELTA)\n      );\n      Ellipse(r);\n\n      sleep(100);\n    end;\n  end;\n\n  InflateRect(r, 2, 2);\n  RedrawWindow(0, @R, 0, RDW_INVALIDATE or RDW_UPDATENOW or RDW_ALLCHILDREN);\nend;\n\nfunction MouseHookHandler(nCode: Integer; MsgID: WParam; Data: LParam): LResult; stdcall;\nvar\n  pt: TPoint;\nbegin\n  Result := 0;\n  if nCode &lt; 0 then\n    Exit;\n\n  pt := PMouseHookStruct(Data)^.pt;\n\n  case MsgID of\n    WM_LBUTTONUP:\n      TEmphasizePointDrawer.Create(pt);\n  end;\nend;\n\nvar\n  gHook: HHOOK=0;\n\nprocedure HookMouse; stdcall;\nbegin\n  gHook := SetWindowsHookEx(WH_MOUSE, MouseHookHandler, HINSTANCE, 0);\nend;\n\nprocedure UnhookMouse;\nbegin\n  UnhookWindowsHookEx(gHook);\n  gHook := 0;\nend;\n\ninitialization\n  HookMouse;\n\nfinalization\n  UnhookMouse;\n\nend.\n</code></pre>\n"},{"tags":["delphi","serial-port","port"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":455,"score":1,"question_id":10897606,"title":"COM Port already open in Windows 7","body":"<p>When I try to connect to the COM port on Windows 7, using AsyncPro (TApdComPort), I'm getting the error message like \"Device already open\". But the same application working fine in Win Xp machine. I'm used Delphi 6 to develop the program. Please help me to resolve this issue. \nAppreciate your help.\nThanks.</p>\n"},{"tags":["delphi","rounding","delphi-2007","sse"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":208,"score":-3,"question_id":12782654,"title":"How can I get SSE rounding in a Delphi version prior to XE2?","body":"<p>How can I get XE2 style rounding in the previous Delphi versions, so with SSE ?</p>\n"},{"tags":["delphi","firemonkey","mousedown","mouse-position","childcontrol"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":116,"score":3,"question_id":12781856,"title":"How to get the control under the mouse cursor in onMouseDown event?","body":"<p>I have a TGridLayout filled with some images in a <strong>Firemonkey HD Application</strong>. In the gridLayout's onMouseDown event I want to get the image object on which the user has clicked, but I have only mouse coordinates.</p>\n\n<p>Implementing onMouseDown event for every image is not an option, because if an image is removed from the gridlayout an empty space remains. In this case I also want to know if the user has clicked in this empty area.</p>\n\n<p>Is there a some kind of \"getChildAtPos\" or \"FindVCLWindow\" analog in <strong>Firemonkey</strong>?</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":146,"score":1,"question_id":12780751,"title":"Incompatible Types - TArray<System.Byte> & Byte","body":"<p>I have declared <code>outputBuffer</code> as a <code>Byte</code> and used it accordingly:</p>\n\n<blockquote>\n  <p>TFile.WriteAllBytes(outputPath, outputBuffer);</p>\n</blockquote>\n\n<p>When I compile my program, Delphi outputs:</p>\n\n<blockquote>\n  <p>[DCC Error] StormLib.pas(56): E2010 Incompatible types: 'System.TArray[System.Byte] and 'Byte'</p>\n</blockquote>\n\n<p>Have I used the wrong/out-dated data type for my variable? What must I do to get my program to compile? </p>\n\n<p>Thank you in advanced!</p>\n"},{"tags":["delphi","plugins","delphi-2006"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12752061,"title":"Is there a Plugin for Better Filtering the Delphi 2006 Component Palette items?","body":"<p>I have hundreds of components in my Delphi 2006 installation, but I always have trouble finding those I haven't used before and that may be the solution for what I need at the moment. I have many undocumented packages, but by the name of the component you can have an idea of what it does.</p>\n\n<p>For example:</p>\n\n<p>I need a RadioButton, so I have <code>TRadioButton</code>, <code>TElRadioButton</code> or <code>TAdvRadioButton</code> to choose which one has the custom properties that I need.</p>\n\n<p>But when I click the Filter Button of the Tool Palette, I have to Type from the beginning of the component name. If I could have a field editor where I could type only a part of the name and the Palette showed me the components that had that term in the middle of the name too, I would make my day!!!</p>\n\n<p><strong>Does anyone know how in Delphi 2006?</strong> </p>\n\n<p><img src=\"http://i.stack.imgur.com/hYu6b.png\" alt=\"enter image description here\"></p>\n\n<p><em>I know that Delphi XE2 has this filter field.</em></p>\n\n<p><img src=\"http://i.stack.imgur.com/5Kedg.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi","delphi-xe2","teechart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12777022,"title":"What causes a TeeChart PieSerie to be truncated?","body":"<p>I have a <code>DBChart</code> with 5 <code>PieSerie</code> on it.\nNotice how the last pie is truncated. Is there something I can do to avoid the situation? I'm using TeeChart Standard v2011.03.32815 VCL; and apart from changing the color theme, I haven't changed any property of the charts.\n<img src=\"http://i.stack.imgur.com/FDZH7.png\" alt=\"When 5 charts are drawn together\">\n<img src=\"http://i.stack.imgur.com/GUC0Q.png\" alt=\"When only the chart in question is visible\"></p>\n\n<p>Here is the DFM of the frame which contains the <code>DBChart</code></p>\n\n<pre><code>object frmAdminStats: TfrmAdminStats\n  Left = 0\n  Top = 0\n  Width = 730\n  Height = 610\n  BiDiMode = bdRightToLeft\n  DoubleBuffered = True\n  ParentBiDiMode = False\n  ParentDoubleBuffered = False\n  TabOrder = 0\n  object DBChart1: TDBChart\n    Left = 0\n    Top = 0\n    Width = 730\n    Height = 610\n    AllowPanning = pmNone\n    Foot.Font.Name = 'Tahoma'\n    SubFoot.Font.Name = 'Tahoma'\n    SubTitle.Font.Name = 'Tahoma'\n    Title.Font.Name = 'Tahoma'\n    Title.Text.Strings = (\n      '')\n    Title.Visible = False\n    BottomAxis.LabelsFont.Name = 'Tahoma'\n    BottomAxis.Title.Font.Name = 'Tahoma'\n    DepthAxis.LabelsFont.Name = 'Tahoma'\n    DepthAxis.Title.Font.Name = 'Tahoma'\n    DepthTopAxis.LabelsFont.Name = 'Tahoma'\n    DepthTopAxis.Title.Font.Name = 'Tahoma'\n    LeftAxis.LabelsFont.Name = 'Tahoma'\n    LeftAxis.Title.Font.Name = 'Tahoma'\n    Legend.Font.Name = 'Tahoma'\n    Legend.ResizeChart = False\n    Legend.TextStyle = ltsPlain\n    Legend.Title.Font.Name = 'Tahoma'\n    Legend.Transparent = True\n    Legend.Visible = False\n    Panning.MouseWheel = pmwNone\n    RightAxis.LabelsFont.Name = 'Tahoma'\n    RightAxis.Title.Font.Name = 'Tahoma'\n    TopAxis.LabelsFont.Name = 'Tahoma'\n    TopAxis.Title.Font.Name = 'Tahoma'\n    View3DOptions.Elevation = 315\n    View3DOptions.Orthogonal = False\n    View3DOptions.Perspective = 0\n    View3DOptions.Rotation = 360\n    Zoom.Allow = False\n    OnAfterDraw = DBChart1AfterDraw\n    OnBeforeDrawChart = DBChart1BeforeDrawChart\n    Align = alClient\n    TabOrder = 0\n    OnClick = DBChart1Click\n    ColorPaletteIndex = 13\n    object Series1: TPieSeries\n      LegendTitle = #1580#1606#1587#1740#1578\n      Cursor = crHandPoint\n      Marks.Arrow.Visible = True\n      Marks.Callout.Brush.Color = clBlack\n      Marks.Callout.Arrow.Visible = True\n      Marks.Visible = True\n      Title = #1580#1606#1587#1740#1578\n      XValues.Order = loAscending\n      YValues.Name = 'Pie'\n      YValues.Order = loNone\n      OnClick = Series1Click\n      ExplodeBiggest = 15\n      Frame.InnerBrush.BackColor = clRed\n      Frame.InnerBrush.Gradient.EndColor = clGray\n      Frame.InnerBrush.Gradient.MidColor = clWhite\n      Frame.InnerBrush.Gradient.StartColor = 4210752\n      Frame.InnerBrush.Gradient.Visible = True\n      Frame.MiddleBrush.BackColor = clYellow\n      Frame.MiddleBrush.Gradient.EndColor = 8553090\n      Frame.MiddleBrush.Gradient.MidColor = clWhite\n      Frame.MiddleBrush.Gradient.StartColor = clGray\n      Frame.MiddleBrush.Gradient.Visible = True\n      Frame.OuterBrush.BackColor = clGreen\n      Frame.OuterBrush.Gradient.EndColor = 4210752\n      Frame.OuterBrush.Gradient.MidColor = clWhite\n      Frame.OuterBrush.Gradient.StartColor = clSilver\n      Frame.OuterBrush.Gradient.Visible = True\n      Frame.Visible = False\n      Frame.Width = 4\n      OtherSlice.Legend.Visible = False\n      PiePen.Visible = False\n      RotationAngle = 75\n    end\n    object Series2: TPieSeries\n      Cursor = crHandPoint\n      Marks.Arrow.Visible = True\n      Marks.Callout.Brush.Color = clBlack\n      Marks.Callout.Arrow.Visible = True\n      Marks.Visible = True\n      SeriesColor = clRed\n      Title = #1576#1740#1605#1607' '#1711#1586#1575#1585#1575#1606\n      XValues.Order = loAscending\n      YValues.Name = 'Pie'\n      YValues.Order = loNone\n      OnClick = Series1Click\n      ExplodeBiggest = 15\n      Frame.InnerBrush.BackColor = clRed\n      Frame.InnerBrush.Gradient.EndColor = clGray\n      Frame.InnerBrush.Gradient.MidColor = clWhite\n      Frame.InnerBrush.Gradient.StartColor = 4210752\n      Frame.InnerBrush.Gradient.Visible = True\n      Frame.MiddleBrush.BackColor = clYellow\n      Frame.MiddleBrush.Gradient.EndColor = 8553090\n      Frame.MiddleBrush.Gradient.MidColor = clWhite\n      Frame.MiddleBrush.Gradient.StartColor = clGray\n      Frame.MiddleBrush.Gradient.Visible = True\n      Frame.OuterBrush.BackColor = clGreen\n      Frame.OuterBrush.Gradient.EndColor = 4210752\n      Frame.OuterBrush.Gradient.MidColor = clWhite\n      Frame.OuterBrush.Gradient.StartColor = clSilver\n      Frame.OuterBrush.Gradient.Visible = True\n      Frame.Visible = False\n      Frame.Width = 4\n      OtherSlice.Legend.Visible = False\n      PiePen.Visible = False\n      RotationAngle = 75\n    end\n    object Series3: TPieSeries\n      LegendTitle = #1576#1740#1605#1607' '#1711#1586#1575#1585#1575#1606' '#1605#1705#1605#1604\n      Cursor = crHandPoint\n      Marks.Arrow.Visible = True\n      Marks.Callout.Brush.Color = clBlack\n      Marks.Callout.Arrow.Visible = True\n      Marks.Visible = True\n      Title = #1576#1740#1605#1607' '#1711#1586#1575#1585#1575#1606' '#1605#1705#1605#1604\n      XValues.Order = loAscending\n      YValues.Name = 'Pie'\n      YValues.Order = loNone\n      OnClick = Series1Click\n      ExplodeBiggest = 15\n      Frame.InnerBrush.BackColor = clRed\n      Frame.InnerBrush.Gradient.EndColor = clGray\n      Frame.InnerBrush.Gradient.MidColor = clWhite\n      Frame.InnerBrush.Gradient.StartColor = 4210752\n      Frame.InnerBrush.Gradient.Visible = True\n      Frame.MiddleBrush.BackColor = clYellow\n      Frame.MiddleBrush.Gradient.EndColor = 8553090\n      Frame.MiddleBrush.Gradient.MidColor = clWhite\n      Frame.MiddleBrush.Gradient.StartColor = clGray\n      Frame.MiddleBrush.Gradient.Visible = True\n      Frame.OuterBrush.BackColor = clGreen\n      Frame.OuterBrush.Gradient.EndColor = 4210752\n      Frame.OuterBrush.Gradient.MidColor = clWhite\n      Frame.OuterBrush.Gradient.StartColor = clSilver\n      Frame.OuterBrush.Gradient.Visible = True\n      Frame.Visible = False\n      Frame.Width = 4\n      OtherSlice.Legend.Visible = False\n      PiePen.Visible = False\n      RotationAngle = 75\n    end\n    object Series4: TPieSeries\n      Cursor = crHandPoint\n      Marks.Arrow.Visible = True\n      Marks.Callout.Brush.Color = clBlack\n      Marks.Callout.Arrow.Visible = True\n      Marks.Visible = True\n      Title = #1662#1586#1588#1705#1575#1606\n      XValues.Order = loAscending\n      YValues.Name = 'Pie'\n      YValues.Order = loNone\n      OnClick = Series1Click\n      ExplodeBiggest = 15\n      Frame.InnerBrush.BackColor = clRed\n      Frame.InnerBrush.Gradient.EndColor = clGray\n      Frame.InnerBrush.Gradient.MidColor = clWhite\n      Frame.InnerBrush.Gradient.StartColor = 4210752\n      Frame.InnerBrush.Gradient.Visible = True\n      Frame.MiddleBrush.BackColor = clYellow\n      Frame.MiddleBrush.Gradient.EndColor = 8553090\n      Frame.MiddleBrush.Gradient.MidColor = clWhite\n      Frame.MiddleBrush.Gradient.StartColor = clGray\n      Frame.MiddleBrush.Gradient.Visible = True\n      Frame.OuterBrush.BackColor = clGreen\n      Frame.OuterBrush.Gradient.EndColor = 4210752\n      Frame.OuterBrush.Gradient.MidColor = clWhite\n      Frame.OuterBrush.Gradient.StartColor = clSilver\n      Frame.OuterBrush.Gradient.Visible = True\n      Frame.Visible = False\n      Frame.Width = 4\n      OtherSlice.Legend.Visible = False\n      PiePen.Visible = False\n      RotationAngle = 75\n    end\n    object Series5: TPieSeries\n      Cursor = crHandPoint\n      Marks.Arrow.Visible = True\n      Marks.Callout.Brush.Color = clBlack\n      Marks.Callout.Arrow.Visible = True\n      Marks.Visible = True\n      Title = #1576#1582#1588' '#1607#1575\n      XValues.Order = loAscending\n      YValues.Name = 'Pie'\n      YValues.Order = loNone\n      OnClick = Series1Click\n      ExplodeBiggest = 15\n      Frame.InnerBrush.BackColor = clRed\n      Frame.InnerBrush.Gradient.EndColor = clGray\n      Frame.InnerBrush.Gradient.MidColor = clWhite\n      Frame.InnerBrush.Gradient.StartColor = 4210752\n      Frame.InnerBrush.Gradient.Visible = True\n      Frame.MiddleBrush.BackColor = clYellow\n      Frame.MiddleBrush.Gradient.EndColor = 8553090\n      Frame.MiddleBrush.Gradient.MidColor = clWhite\n      Frame.MiddleBrush.Gradient.StartColor = clGray\n      Frame.MiddleBrush.Gradient.Visible = True\n      Frame.OuterBrush.BackColor = clGreen\n      Frame.OuterBrush.Gradient.EndColor = 4210752\n      Frame.OuterBrush.Gradient.MidColor = clWhite\n      Frame.OuterBrush.Gradient.StartColor = clSilver\n      Frame.OuterBrush.Gradient.Visible = True\n      Frame.Visible = False\n      Frame.Width = 4\n      OtherSlice.Legend.Visible = False\n      PiePen.Visible = False\n      RotationAngle = 75\n    end\n  end\n  object qStats: TADOQuery\n    Connection = dmLabData.ADOConnection\n    ExecuteOptions = [eoAsyncExecute]\n    Parameters = &lt;&gt;\n    Left = 48\n    Top = 40\n  end\n  object tmAdminStats: TJvTimer\n    Enabled = False\n    Interval = 5000\n    OnTimer = tmAdminStatsTimer\n    Left = 48\n    Top = 112\n  end\nend\n</code></pre>\n"},{"tags":["delphi","date","datetimepicker"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":170,"score":-1,"question_id":12777390,"title":"Getting numeric value instead of Date value at RunTime","body":"<p>I'm Getting numeric value of \"DateTimePciker.Date\" at run time. But i want value like '08/10/2012'. How to get DATE value instead of Numeric value?</p>\n\n<p>show picture of runtime:</p>\n\n<hr>\n\n<p><img src=\"http://i.stack.imgur.com/57c7T.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi","delphi-2007"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":4496,"score":6,"question_id":238741,"title":"How do I put GIF/PNG/... image on a BitBtn in Delphi?","body":"<p>I'm using Delphi 2007. How can I put a GIF/PNG image on a BitBtn component? (Preferably, with alpha transparency supported)</p>\n"},{"tags":["delphi","freepascal","calling-convention"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12643502,"title":"compiler option for setting Default calling convention?","body":"<p>I kind of recall that in Turbo Pascal or early Delphi versions there were options to make functions calling convention not register by default but any other type.</p>\n\n<p>Maybe i mistake it for {$W+} or {$STACKFRAMES ON} option, which affects functions prologue and epilogue as well.</p>\n\n<p>I do not want to use pascal pre-processors, but if i could change default convention for some unit it could be useful to me.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12776304,"title":"Delphi 7 - Fetch value from a website","body":"<p>let's see if yaw can help me out here, </p>\n\n<p>Supposing there's a link: www.example.com/test.html</p>\n\n<p>Upon opening, it would show either 0 or 1.</p>\n\n<p>I need to fetch that value. I.e.:</p>\n\n<pre><code>if internet.value := 0 then ShowMessage('False') else ShowMessage('True');\n</code></pre>\n\n<p>It could be using indy components or winsockets, how would I go about this one?</p>\n"},{"tags":["delphi","bitmap","kml"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":123,"score":2,"question_id":12760167,"title":"How georeference image on Delphi?","body":"<p>I have a bitmap, my user set 2 or more marker on the image, then for any marker set latitude and langitude.\nWith this imformation I must create a Ground Overlays for a KML file, so I need know how can I calculate the LatLonBox parameter: north, south, east, west and rotation for the bitmap.</p>\n\n<p>Any ideas?</p>\n\n<p>This is a example of the resut:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;kml xmlns=\"http://www.opengis.net/kml/2.2\"&gt;\n  &lt;Folder&gt;\n    &lt;name&gt;Ground Overlays&lt;/name&gt;\n    &lt;description&gt;Examples of ground overlays&lt;/description&gt;\n    &lt;GroundOverlay&gt;\n      &lt;name&gt;Large-scale overlay on terrain&lt;/name&gt;\n      &lt;description&gt;Overlay shows Mount Etna erupting on July 13th, 2001.&lt;/description&gt;\n      &lt;Icon&gt;\n        &lt;href&gt;http://developers.google.com/kml/documentation/images/etna.jpg&lt;/href&gt;\n      &lt;/Icon&gt;\n      &lt;LatLonBox&gt;\n        &lt;north&gt;37.91904192681665&lt;/north&gt;\n        &lt;south&gt;37.46543388598137&lt;/south&gt;\n        &lt;east&gt;15.35832653742206&lt;/east&gt;\n        &lt;west&gt;14.60128369746704&lt;/west&gt;\n        &lt;rotation&gt;-0.1556640799496235&lt;/rotation&gt;\n      &lt;/LatLonBox&gt;\n     &lt;/GroundOverlay&gt;\n  &lt;/Folder&gt;\n&lt;/kml&gt;\n</code></pre>\n\n<p>My problem are the north, south, east, west and rotation value.\nIn fact my user must load a image then he put 2 or more markers on it and for all markers set latitude and longitude. With this data I think it's possible get north, south, east, west and rotation value but I don't know how.\nIf the user put only 2 markers it's easy, I can calculate dX and dY then north, south, east and west (in this case I set rotation = 0), but if the user set more that 2 points?</p>\n"},{"tags":["delphi","quickreports"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":59,"score":-2,"question_id":12776989,"title":"I want to Remove all the controls from the \"Detail Band\", which is a control of \"Quick Report\" in DELPHI","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12741170/remove-destroy-all-the-control-from-quick-report-detail-band\">Remove/ Destroy all the control from quick report detail band</a>  </p>\n</blockquote>\n\n\n\n<p>Some user say this is  #\"incomplete question\" #, but is a very clear question. I want to Remove all the controls from the \"Detail Band\", which is a control of \"Quick Report\" in DELPHI.</p>\n"},{"tags":["delphi","png","transparency","windows-2000"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12747466,"title":"How to eliminate black backgrounds with PNG images from Delphi image list in Windows 2000","body":"<p>For some time I've tidied up my icons by using stock PNG's from a library imported into TImageList with ColorDepth=cd32Bit. Sunch image lists are used with TMainMenu, TPopupMenu and other components such as Developer Express nav bar etc. This all works fine on WinXP SP3 through Win 7 but certain older versions of XP and all versions of Windows 2000 show black backgrounds (which should be transparent). This is easily proven using a simple test app.</p>\n\n<p>I presume that some support for the transparency is missing in Win2k. Is it possible for me to find out what is missing so that I can obtain correct transparency? I'm using Delphi XE2.</p>\n"},{"tags":["delphi","control","quickreports","removeall"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":64,"score":-2,"question_id":12741170,"title":"Remove/ Destroy all the control from quick report detail band","body":"<p>How to Remove / Destroy all the Controls from the QuickReport's Detail Band?</p>\n\n<p>Some user say this is incomplete question, but is a very clear question. I want to Remove all the controls from the \"Detail Band\", which is a control of \"Quick Report\" in DELPHI.</p>\n"},{"tags":["windows","delphi","inno-setup","uac","user-permissions"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":185,"score":2,"question_id":12772615,"title":"Why is my Delphi 6 program triggering a request for admin rights upon install on only a minority of Windows 7 systems (InnoSetup)?","body":"<p>I have a Delphi 6 program that for most users installs fine while running under a user account without admin privileges.  However, on some systems it triggers a request for admin rights.  Unfortunately mine isn't one of them so it's hard for me to diagnose this problem.  I use InnoSetup 5.1.9 to build my install programs.  </p>\n\n<p>How can I figure out what I need to change about my installation program's configuration to neutralize the need for admin rights on some people's systems?  It's causing trouble for my system because during installation, certain program data files are being copied into the <em>admin</em> account's application data folder.  Then when my program is launched under a <em>user</em> account, those files can not be found since they are not in the <em>user</em> account application folder, where they are expected to be.</p>\n"},{"tags":["delphi","data-structures","memory-management","virtualtreeview"],"answer_count":1,"favorite_count":1,"up_vote_count":9,"down_vote_count":2,"view_count":465,"score":7,"question_id":5993040,"title":"Separate Data Structure vs VirtualStringTree's PVirtualNodes to Store Data?","body":"<p>So I have been messing with creating my own separate data structure. I finally got it working, but then I discovered that the memory usage was ridiculously high compared to the old method.</p>\n\n<p>To test this, I created the same test app, but I would store the data in my PVirtualNodes.</p>\n\n<p>When adding 1000 roots, with 1000 children each, the separate data structure was using around 208 MB, while the PVirtualNode one only used about 160 MB, and it was a wee bit faster as well.</p>\n\n<p>I thought using a separate data structure was supposed to use less memory, and be faster, but I suppose that is the price instead?</p>\n\n<p>Here is the source for the \"Store data in PVirtualNode\": <a href=\"http://pastebin.com/j6L2eHJt\" rel=\"nofollow\">http://pastebin.com/j6L2eHJt</a></p>\n\n<p>Here is the source for the \"Store data in Seperate Datastructure\": <a href=\"http://pastebin.com/iSwR0hW1\" rel=\"nofollow\">http://pastebin.com/iSwR0hW1</a></p>\n"},{"tags":["delphi","delphi-7"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":132,"score":1,"question_id":12768892,"title":"Switching forms in delphi","body":"<p>I am trying to switch between two forms in my delphi application, first, a login screen appears and then the main form of the application appears. </p>\n\n<p>I am using formx.hide and .show to switch between the forms.\neg. \n //after password checking\n  form1.hide;\n  form2.show;</p>\n\n<p>The second form appears, but cannot be interacted with, as if it is disabled.\nWhy would it be doing this?</p>\n"},{"tags":["delphi","devexpress","tcxgrid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":12761805,"title":"Skip group rows when adding recordnumbers","body":"<p>I have the following code to add 'recordnumbers' in a cxGrid but it has the unwanted sideefeect that if it is a grid with grouping then it step one number every time there is a GroupRow and then there is a missing number.\nAny ways to avoid this</p>\n\n<pre><code>procedure TfrmProjectTasksActive.colCountGetDisplayText(Sender: TcxCustomGridTableItem; ARecord: TcxCustomGridRecord; var AText: string);\nvar\n  Row: integer;\nbegin\n  Row := Sender.GridView.DataController.GetRowIndexByRecordIndex(aRecord.RecordIndex, False);\n  aText := Format('%.*d', [3, (Row + 1)]);;\nend;\n</code></pre>\n"},{"tags":["xml","delphi","delphi-xe2","musicbrainz"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":147,"score":1,"question_id":12759717,"title":"Access Violation while parsing XML in Delphi XE2","body":"<p>I'm trying to parse a MusicBraninz XML file in Delphi XE2 using the following code:</p>\n\n<pre><code>webquery := 'http://www.musicbrainz.org/ws/2/recording/?query='+escape(tracktitle)+'&amp;artist:'+escape(ArtistTitle);\n\nLog('WebQuery: ' + webquery, 0);\n\nbegin\n  XMLDoc:= TXMLDocument.Create(nil);\n  XMLDoc.FileName := webQuery;\n  XMLDoc.Active := True;\n\n  Log('Report: ' + XMLDoc.XML.Text, 0);\n\n\n   StartItemNode := XMLDoc.DocumentElement.ChildNodes.First.ChildNodes.FindNode('release-list') ;\n\n   ANode := StartItemNode;\n   repeat\n     Result.Album := ANode.ChildNodes['title'].Text;  &lt;-- Access Violation\n     Result.Status:= ANode.ChildNodes['status'].Text;\n\n     ANode := ANode.NextSibling;\n   until ANode = nil;\n\nend;\n</code></pre>\n\n<p>The XML file is fetched correctly and looks like what's below:</p>\n\n<pre><code>&lt;metadata xmlns=\"http://musicbrainz.org/ns/mmd-2.0#\" xmlns:ext=\"http://musicbrainz.org/ns/ext#-2.0\"&gt;\n&lt;recording-list offset=\"0\" count=\"1\"&gt;\n&lt;recording ext:score=\"100\" id=\"a399eec1-d45d-4505-b475-ead0da6cad17\"&gt;\n&lt;title&gt;Mestecăniș&lt;/title&gt;\n&lt;length&gt;359000&lt;/length&gt;\n&lt;artist-credit&gt;\n&lt;name-credit&gt;\n&lt;artist id=\"8fb78a16-0cba-4175-8c92-d9645dfb007d\"&gt;\n&lt;name&gt;Bucovina&lt;/name&gt;\n&lt;sort-name&gt;Bucovina&lt;/sort-name&gt;\n&lt;/artist&gt;\n&lt;/name-credit&gt;\n&lt;/artist-credit&gt;\n&lt;release-list&gt;\n&lt;release id=\"22b00afc-86ea-445a-8805-b6bfa33da74e\"&gt;\n&lt;title&gt;Duh&lt;/title&gt;\n&lt;status&gt;Official&lt;/status&gt;\n&lt;release-group type=\"EP\" id=\"4e8fb87c-3760-48c1-a3d7-88e7a2c839fa\"&gt;\n&lt;primary-type&gt;EP&lt;/primary-type&gt;\n&lt;/release-group&gt;\n&lt;date&gt;2010&lt;/date&gt;\n&lt;country&gt;RO&lt;/country&gt;\n&lt;medium-list&gt;\n&lt;track-count&gt;5&lt;/track-count&gt;\n&lt;medium&gt;\n&lt;position&gt;1&lt;/position&gt;\n&lt;format&gt;CD&lt;/format&gt;\n&lt;track-list offset=\"3\" count=\"5\"&gt;\n&lt;track&gt;\n&lt;number&gt;4&lt;/number&gt;\n&lt;title&gt;Mestecăniș&lt;/title&gt;\n&lt;length&gt;359000&lt;/length&gt;\n&lt;/track&gt;\n&lt;/track-list&gt;\n&lt;/medium&gt;\n&lt;/medium-list&gt;\n&lt;/release&gt;\n&lt;/release-list&gt;\n&lt;/recording&gt;\n&lt;/recording-list&gt;\n&lt;/metadata&gt;\n</code></pre>\n\n<p>My question is: am I doing anything wrong here? All variables are declared and initialized OK.</p>\n\n<p>Thanks,</p>\n"},{"tags":["delphi","sha"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":2834,"score":7,"question_id":553310,"title":"Delphi: How to calculate the SHA hash of a large file","body":"<p>Hi I need to generate a SHA over a 5 Gig file</p>\n\n<p>Do you know of a non string based Delphi library that can do this ?</p>\n"},{"tags":["c++","c","windows","delphi","winapi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12756751,"title":"KeyInformation parameter of NtEnumerateKey()","body":"<p>I'm curious to know how the <code>KeyInformation</code> parameter should be passed to <code>NtEnumerateKey()</code>. When I run the following code, <code>NtEnumerateKey()</code> returns <code>NTSTATUS = 0xC000000D</code> with the error message <i>\"An invalid parameter was passed to a service or function.\"</i></p>\n\n<p>I'm using Windows 7. Although the following code uses Delphi language, you can answer my question in C language too. My question is not specific to a programming language.</p>\n\n<pre><code>type\n  KEY_NAME_INFORMATION = record\n    NameLength: ULONG;\n    Name: array[0..254] of WCHAR;\n  end;\n  PKEY_NAME_INFORMATION = ^KEY_NAME_INFORMATION;\n\nvar\n  iNtStatus: LONG;\n  hKeyResult: THandle;\n  KeyNameInfo: KEY_NAME_INFORMATION;\n  iResultLen: ULONG;\n\niNtStatus := NtOpenKey(@hKeyResult, (KEY_ENUMERATE_SUB_KEYS) and not\n    SYNCHRONIZE, @rObjAttrs);\nif hKeyResult = 0 then Exit;\n\niNtStatus := NtEnumerateKey(hKeyResult,\n    0,\n    KeyNameInformation,\n    @KeyNameInfo,                 // I'm asking about this parameter,\n    SizeOf(KEY_NAME_INFORMATION), // and also this parameter\n    @iResultLen);\n</code></pre>\n\n<h2>UPDATED: Weird Thing</h2>\n\n<p>If I pass <code>KeyBasicInformation</code> instead of <code>KeyNameInformation</code>, <code>NtEnumerateKey()</code> returns <code>STATUS_SUCCESS</code>. Does not <code>NtEnumerateKey()</code> support the <code>KeyNameInformation</code>?</p>\n\n<pre><code>type\n  KEY_BASIC_INFORMATION = record\n    LastWriteTime: LARGE_INTEGER;\n    TitleIndex: ULONG;\n    NameLength: ULONG;\n    Name: array[0..254] of WCHAR;\n  end;\n  PKEY_BASIC_INFORMATION = ^KEY_BASIC_INFORMATION;\n\nvar\n  KeyBasicInfo: KEY_BASIC_INFORMATION;\n\niNtStatus := NtEnumerateKey(hKeyResult,\n    0,\n    KeyBasicInformation,           // Note this!\n    @KeyBasicInfo,                 // Note this!\n    SizeOf(KEY_BASIC_INFORMATION), // Note this!\n    @iResultLen);\n</code></pre>\n"},{"tags":["sql-server","delphi","sql-server-2008-r2","delphi-2007"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":12401763,"title":"Delphi TAdoDataset TFloatField comma error","body":"<p>My platform Delphi 2007 and SQL Server 2008 R2\nWhen I post my <code>TAdoDataset</code>, I receiving this code at Sql profiler:</p>\n\n<pre><code>exec sp_executesql N'UPDATE \"MYDBNAME\".\"dbo\".\"HESAPISL\" SET \"ADET\"=@P1,\"FIYAT\"=@P2,\"TARIFEID\"=@P3,\"KRMTUTAR\"=@P4,\"SGTUTAR\"=@P5,\"OZELTUTAR\"=@P6,\"HSTKATKITUTAR\"=@P7,\"KRMINDORAN\"=@P8,\"KRMINDTUTAR\"=@P9,\"OZELINDORAN\"=@P10,\"OZELINDTUTAR\"=@P11,\"SGINDORAN\"=@P12,\"HIKUTUICIADET\"=@P13,\"HSTKDVORAN\"=@P14,\"KRMKDVORAN\"=@P15,\"SGKDVORAN\"=@P16,\"EKMASRAFTUTAR\"=@P17,\"HSTPAKETDURUMUID\"=@P18,\"KRMPAKETDURUMUID\"=@P19,\"SGPAKETDURUMUID\"=@P20,\"HSTPAKETEDAHIL\"=@P21,\"KRMPAKETEDAHIL\"=@P22,\"SGPAKETEDAHIL\"=@P23,\"ESKIITEMID\"=@P24,\"ESKIADET\"=@P25,\"ESKIHIKUTUICIADET\"=@P26,\"HSTFYTTUTAR\"=@P27,\"HKMATRAH\"=@P28,\"MLYTTUTAR\"=@P29,\"BAZFYTBIRIM\"=@P30 \nWHERE \"ADET\"=@P31 AND \"FIYAT\"=@P32 AND \"TARIFEID\"=@P33 AND \"KRMTUTAR\"=@P34 AND \"SGTUTAR\"=@P35 AND \"OZELTUTAR\"=@P36 AND \"HSTKATKITUTAR\"=@P37 AND \"KRMINDORAN\"=@P38 AND \"KRMINDTUTAR\"=@P39 AND \"OZELINDORAN\"=@P40 AND \"OZELINDTUTAR\"=@P41 AND \"SGINDORAN\"=@P42 AND \"HIKUTUICIADET\"=@P43 AND \"HSTKDVORAN\"=@P44 AND \"KRMKDVORAN\"=@P45 AND \"SGKDVORAN\"=@P46 AND \"EKMASRAFTUTAR\"=@P47 AND \"HSTPAKETDURUMUID\"=@P48 AND \"KRMPAKETDURUMUID\"=@P49 AND \"SGPAKETDURUMUID\"=@P50 AND \"HSTPAKETEDAHIL\"=@P51 AND \"KRMPAKETEDAHIL\"=@P52 AND \"SGPAKETEDAHIL\"=@P53 AND \"ESKIITEMID\" IS NULL AND \"ESKIADET\" IS NULL AND \"ESKIHIKUTUICIADET\" IS NULL AND \"HSTFYTTUTAR\"=@P54 AND \"HKMATRAH\"=@P55 AND \"MLYTTUTAR\"=@P56 AND \"BAZFYTBIRIM\"=@P57 AND \"HESAPISLID\"=@P58 AND \"HESAPISLID\" IS NULL',N'@P1 float,@P2 float,@P3 int,@P4 float,@P5 float,@P6 float,@P7 float,@P8 float,@P9 float,@P10 float,@P11 float,@P12 float,@P13 numeric(9,2),@P14 numeric(5,2),@P15 numeric(5,2),@P16 numeric(5,2),@P17 float,@P18 int,@P19 int,@P20 int,@P21 bit,@P22 bit,@P23 bit,@P24 int,@P25 float,@P26 numeric(8,2),@P27 float,@P28 float,@P29 float,@P30 numeric(19,4),@P31 float,@P32 float,@P33 int,@P34 float,@P35 float,@P36 float,@P37 float,@P38 float,@P39 float,@P40 float,@P41 float,@P42 float,@P43 numeric(9,2),@P44 numeric(5,2),@P45 numeric(5,2),@P46 numeric(5,2),@P47 float,@P48 int,@P49 int,@P50 int,@P51 bit,@P52 bit,@P53 bit,@P54 float,@P55 float,@P56 float,@P57 numeric(19,4),@P58 int',4,0,078299999999999995,4,0,0,0,31319999999999998,0,0,0,0,0,0,30.00,8.00,8.00,8.00,0,00013333333333337416,0,0,0,0,0,0,7516,6,30.00,0,31333333333333335,0,0,0,6,0,078299999999999995,4,0,0,0,4698,0,0,0,0,0,0,30.00,8.00,8.00,0,0,00020000000000003348,0,0,0,0,0,0,0,47000000000000003,0,0,2.3500,53791\n</code></pre>\n\n<hr>\n\n<p>Example:</p>\n\n<p><code>HSTKDVORAN = 8.00</code> (This is OK! no problem)</p>\n\n<p>But</p>\n\n<p><code>FIYAT = 0,078299999999999995</code> (this is causing an exception/problem)</p>\n\n<p>Float fields values are coming with comma seperated.</p>\n\n<p>When I run this code (at SQL Management Studio), it gets an error:</p>\n\n<pre><code>Msg 8144, Level 16, State 2, Line 0\nProcedure or function has too many arguments specified.\n</code></pre>\n\n<p>How can I fix it?</p>\n"},{"tags":["delphi","pointers","memory-management","delphi-7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12757313,"title":"How to free such pointers?","body":"<p>My custom control has pointers to parent but I don't know how to free those pointers in destructor.</p>\n\n<p>variables:</p>\n\n<pre><code>{Pointers}\n  Form: TForm;\n  GeneralPointer: Pointer;\n  Frame: ^TImage;\n</code></pre>\n\n<p>the constructor:</p>\n\n<pre><code>constructor TViOS.Create(var ImageOutput: TImage);\nbegin\ninherited Create;\n\n  Form := TForm(GetParentForm(TControl(ImageOutput)));\n  GeneralPointer := Addr(ImageOutput);\n  Frame := GeneralPointer;\n...\n</code></pre>\n"},{"tags":["delphi","delphi-xe","taction","tactionmanager"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12761459,"title":"How to obtain all TAction from a TActionManager?","body":"<p>I have a <code>TActionManager</code> in my application, where all the actions are defined. I need to obtain a list of all its actions; currently, using its Actions property I can obtain the \"path\" for the action (<code>GetNamePath</code>) but I also want to obtain its caption.</p>\n\n<p>Is it possible to obtain all actions from an action manager?</p>\n"},{"tags":["delphi","delphi-xe2","vcl-styles"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":163,"score":1,"question_id":12759379,"title":"Is it possible to modify VCL styles at runtime?","body":"<p>I have a <code>TabControl</code> in which each tab represents a distinct set of data. My application uses <code>VCL Styles</code>, and thus setting <code>OwnerDraw</code> to <code>True</code> does not lead to <code>OnDrawTab</code> being called. I was wondering if it is possible to somehow intercept the routine which draws a specific control using <code>VCL Styles</code> (in my case, <code>TabControl</code>), and change the way the control is drawn (for instance, change the <code>Canvas.Font</code>, etc.).</p>\n"},{"tags":["delphi","delphi-xe2","delphi-2007"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":130,"score":1,"question_id":12657388,"title":"How to use Include with Unicode?","body":"<p>I'm try to port some code from D2007 to DXE2.\nThis simplified code compiles fine in D2007. In DXE2 it show this error:</p>\n\n<pre><code>[DCC Warning] Unit1.pas(10): W1050 WideChar reduced to byte char in set expressions.  Consider using 'CharInSet' function in 'SysUtils' unit.\n[DCC Error] Unit1.pas(37): E2010 Incompatible types: 'AnsiChar' and 'Char'\n</code></pre>\n\n<p>Propably a unicode issue.\nCan someone tell me why this happen and how I should correct it ?</p>\n\n<p>Regards</p>\n\n<p>The code:</p>\n\n<pre><code>unit Unit1;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs;\n\ntype\n  TSetOfChar = Set of Char;  // Line 10\n\n  TForm1 = class(TForm)\n    procedure FormCreate(Sender: TObject);\n  private\n    FCharacterSet: TSetOfChar;\n  public\n    property CharacterSet: TSetOfChar read FCharacterSet write FCharacterSet;\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm1.FormCreate(Sender: TObject);\nvar\n  CharacterSet: TSetOfChar;\n  j: Integer;\n  s: String;\nbegin\n  CharacterSet := [];\n  s := 'I''m just testing åäö';\n\n  for j := 1 to Length(s) do\n    Include(CharacterSet, s[j]);  // &lt;- Line 37\n\nend;\n\nend.\n</code></pre>\n\n<p><strong>EDIT:</strong> Note that I am using Delphi 2007 that have no generics. I want code that still works in D2007 because there is a lot of code to port to Unicode. This is slow process.\nWhen everything is ported, verified it works with XE2 then we can use XE2 things like generics. In the meantime we maintain the D2007 as usual and we want to avoid making a XE2 branch in the revision control system.</p>\n"},{"tags":["delphi","generics"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":524,"score":4,"question_id":7215692,"title":"Generics constructor with parameter constraint?","body":"<pre><code>TMyBaseClass=class\n  constructor(test:integer);\nend;\n\nTMyClass=class(TMyBaseClass);\n\nTClass1&lt;T: TMyBaseClass,constructor&gt;=class()\n  public\n    FItem: T;\n    procedure Test;\nend;\n\nprocedure TClass1&lt;T&gt;.Test;\nbegin\n  FItem:= T.Create;\nend;\n\nvar u: TClass1&lt;TMyClass&gt;;\nbegin\n  u:=TClass1&lt;TMyClass&gt;.Create();\n  u.Test;\nend;\n</code></pre>\n\n<p>How do I make it to create the class with the integer param. What is the workaround?</p>\n"},{"tags":["delphi","excel","export","components","export-to-excel"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":1659,"score":6,"question_id":3457472,"title":"Open source component or unit for exporting Delphi TDataSet to native XLS without Excel installed","body":"<p>Do you possibly know about the existence of a free and open sourced Delphi code to export TDataSet to native XLS format? The question was previously asked <a href=\"http://stackoverflow.com/questions/2493071/exporting-to-excel-from-delphi-without-having-excel\">here</a>, yet I am looking for a free solution.</p>\n\n<p>As observed in for example TeeChart.TeeStore.TSeriesDataXLS.SaveToStream writing a native XLS export function is not a rocket science, yet I struggle to find an existing solution, which would definitely save some time and money (for commercial component which would be used in 10-20%).</p>\n\n<p>It would be beneficial if such export code would allow color and text style changes, but for me personally it is not crucial.</p>\n"},{"tags":["delphi","firemonkey","livebindings","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":238,"score":0,"question_id":12547610,"title":"Firemonkey livebindings custom Grid columns","body":"<p>I've trying to add some custom columns to a TGrid, for example column that will consist of TCalendarEdit's and livebind it to DB.<br>\nI came out with two ways of how to implement something like this.  </p>\n\n<ol>\n<li><p>Put CalendarEdit in all rows.<br>\n<strong>Problem is</strong>: I can create custom TCalendarEdit column,<br>\n<code>TDateColumn = class(TColumn)<br>\nprotected<br>\n  function CreateCellControl: TStyledControl; override;<br>\nend;<br>\nfunction TDateColumn.CreateCellControl: TStyledControl;<br>\nbegin<br>\n  Result := TDateCell.Create(grid);<br>\n  Result.Parent := grid;<br>\nend;</code><br>\ncan put it in Grid,<br>\n<code>procedure TForm1.FormCreate(Sender: TObject);<br>\nvar<br>\ncec: TDateColumn;<br>\nbegin<br>\ncec:=TDateColumn.Create(grid1);<br>\ngrid1.AddObject(cec);<br>\nend;</code><br>\nbut then i livebind it to dataset \n<code>LinkGridToDataSource1.Columns.Items[LinkGridToDataSource1.Columns.Count-1].MemberName:='date';</code><br>\nit drops to default string column view!</p></li>\n<li><p>Draw a control over Grid cell then i click on and destroy it then i click on any other place on Grid (and write it's data to Grid).<br>\n<strong>Problem is</strong>: How can i get coordinates and size of cell OnClick?  </p></li>\n</ol>\n\n<p>Thank you.</p>\n"},{"tags":["delphi","post","https","amazon","mws"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":530,"score":2,"question_id":9279089,"title":"Making an HTTPS POST call to Amazon in Delphi 2007","body":"<p>My first question on Stackoverflow - so I hope I don't make myself look stupid! I have used the resource a lot in the past, mainly finding answers from questions others have asked. But this time I seem to be a bit stuck.</p>\n\n<p>I can nearly get there with this using examples on here, but not quite :(</p>\n\n<p>So, here is the problem:</p>\n\n<p>We use the Amazon Product Advertising API to do our repricing on their site. For those who don't know it basically lets you interogate the Amazon database without having to do time consuming operations like scraping web pages. It works very well for us, or has. They are now disbanding this API for sellers and moving us to a new API over at their MWS service.</p>\n\n<p>The calls are subtlely different as far as I can see. The 2 obvious differences are that the PA API uses HTTP and GET whereas the MWS is using HTTPS and POST.</p>\n\n<p>I am not entirely sure the examples in the Amazon documentation are correct as they give examples of creating as hash signed URL request. That is the way we used to sucessfully do it on the PA-API where the GET method was used. But can you do that for POST? I don't think that is possible, although I may be wrong and that is certainly what the examples imply.</p>\n\n<p>Anyway, it (creating a signed URL) doesn't work! So I decided to look along the lines of using some kind of lower level HTTPS POST in Delphi.</p>\n\n<p>I have searched on here and there are several different examples, but I cannot get any of the to work correctly. Some of the examples seem to use INDY 10, unfortunately we are stuck (for compatibility reasons) on INDY 9. I have also looked at the WININET wrapper type functions but I just cannot get a result back other than an exception or errors.</p>\n\n<p>So that is why I am here asking for some help.</p>\n\n<p>How can I make the correctly formatted call to Amazon MWS using Delphi? I have tried examples from pages like:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4223839/how-to-make-https-post-request-in-delphi\">How to make https post request in delphi!</a></p>\n\n<p>etc etc all the ones I could find!</p>\n\n<p>But I get errors back like 'Bad request' (exception).</p>\n\n<p>I have tried using Fiddler (as suggested elsewhere) to look at what is happeining but can't quite get my head around it yet (although I can compose a call in it that works!)</p>\n\n<p>You just know how you get to the point where you can't see the wood for the trees? That is me right now - I've been looking at this everyday since Friday and I keep thinking I have the soution and then it doesn't work.</p>\n\n<p>So I'm looking for some pointers or some direction on this. I don't really want to go upgrading INDY or adding new libraries. I would just prefer to keep things as they are and use what I have available. We are using D2007.</p>\n\n<p>To give an idea what is required, I need to make this kind of call (the GetServiceStatus being the most simple):</p>\n\n<pre><code>POST /Products/2011-10-01?AWSAccessKeyId=&lt;ACCESSKEY&gt;\n  &amp;Action=GetServiceStatus\n  &amp;SellerId=&lt;SELLERID&gt;\n  &amp;SignatureVersion=2\n  &amp;Timestamp=2012-02-14T13%3A26%3A42Z\n  &amp;Version=2011-10-01\n  &amp;Signature=dtAvv595blmv%2FnV0h2Yr5bCGzKYXid0hkOuCmZOb3bc%3D\n  &amp;SignatureMethod=HmacSHA256\n</code></pre>\n\n<p>To this endpoint:</p>\n\n<p><a href=\"https://mws.amazonservices.co.uk/Products/2011-10-01\" rel=\"nofollow\">https://mws.amazonservices.co.uk/Products/2011-10-01</a></p>\n\n<p>I think my problem is in all the examples I have tried I don't know how to set up the call correctly, which is probably why I get the Bad Request errors.</p>\n\n<p>So, a nice simple solution would be most appreciated!</p>\n\n<p>Many thanks for any help,</p>\n\n<p>I'm happy to answer any questions you have to get a working solution,</p>\n\n<p>Best wishes,</p>\n\n<p>Trevor</p>\n\n<hr>\n\n<p>Documentation links and observations:</p>\n\n<p>This is the developer guide for the API:</p>\n\n<p><a href=\"https://images-na.ssl-images-amazon.com/images/G/02/mwsportal/doc/en_US/bde/MWSDeveloperGuide._V161846143_.pdf\" rel=\"nofollow\">https://images-na.ssl-images-amazon.com/images/G/02/mwsportal/doc/en_US/bde/MWSDeveloperGuide._V161846143_.pdf</a></p>\n\n<p>This is the particular part of the API we will be using (that replaces the current product advertising API):</p>\n\n<p><a href=\"https://images-na.ssl-images-amazon.com/images/G/02/mwsportal/doc/en_US/bde/MWSDeveloperGuide._V161846143_.pdf\" rel=\"nofollow\">https://images-na.ssl-images-amazon.com/images/G/02/mwsportal/doc/en_US/bde/MWSDeveloperGuide._V161846143_.pdf</a></p>\n\n<p>The most basic of functions here is the GetServiceStatus function. It takes no parameters. But, it still needs to be authenticated and 'signed' using credentials from Amazon (Seller ID, MWS access key and secret key (for generating a signature). My feeling is that if I can get the most simplest of functions to work then the rest will follow. But the problem of authentification is what makes finding a solution so difficult. There's no test account. And also the timestamp (and therefore the signature for the call) expires and a few minutes.</p>\n\n<p>There is also a 'migration guide':</p>\n\n<p><a href=\"https://images-na.ssl-images-amazon.com/images/G/02/mwsportal/doc/en_US/products/MWSProductsApiMigrationGuide._V140058392_.pdf\" rel=\"nofollow\">https://images-na.ssl-images-amazon.com/images/G/02/mwsportal/doc/en_US/products/MWSProductsApiMigrationGuide._V140058392_.pdf</a></p>\n\n<p>But this document does contain some errors. For example, the end points are incorrect.</p>\n\n<hr>\n\n<p>My latest code inc ssl, cookie manager etc:</p>\n\n<pre><code>var\n  LHTTP                : TIdHTTP;\n  IdSSLIOHandlerSocket : TIdSSLIOHandlerSocket;\n  IdCookieManager      : TIdCookieManager;\n  LParams              : TStringList;\n  LResponse            : string;\n\nbegin\n  IdCookieManager:=TIdCookieManager.Create(self);\n  IdSSLIOHandlerSocket:=TIdSSLIOHandlerSocket.Create(self);\n  with IdSSLIOHandlerSocket do begin\n    SSLOptions.Method := sslvSSLv3;\n  end;\n\n  LHTTP := TIdHTTP.Create(Self);\n  with LHTTP do begin\n    CookieManager:=IdCookieManager;\n    AllowCookies:=true;\n    IOHandler:=IdSSLIOHandlerSocket;\n    Request.ContentType:='text/xml';\n    Port:=443;\n    HandleRedirects:=true;\n    Host:='mws.amazonservices.co.uk';\n    ProtocolVersion:=pv1_1\n  end;\n\n\n  LParams := TStringList.Create;\n  try\n    LParams.Add('AWSAccessKeyId=&lt;ACCESSKEY&gt;');\n    LParams.Add('Action=GetServiceStatus');\n    LParams.Add('SellerId=&lt;SELLERID&gt;)');\n    LParams.Add('SignatureVersion=2');\n    LParams.Add('Timestamp=2012-02-15T13%3A00%3A07Z');\n    LParams.Add('Version=2011-10-01');\n    LParams.Add('Signature=viPlDAbzEBwlTAwq4hNaZi%2Fa1Klf7qIXIP%2BKUsOcJTI%3D');\n    LParams.Add('SignatureMethod=HmacSHA256');\n    LResponse:=LHTTP.Post('https://mws.amazonservices.co.uk/Products/2011-10-01?', LParams);\n    ShowMessage( LResponse );\n  except\n    on E: Exception do\n      ShowMessage('ouch! ' + E.Message );\n  end;\n  LHTTP.Free;\n  IdSSLIOHandlerSocket.Free;\n  IdCookieManager.Free;\nend;\n</code></pre>\n\n<p>This is based on what Amazon are expecting to receive as per their scratchpad. The user agent at the end is optional and not required and is not part of the signing process:</p>\n\n<pre><code>POST /Products/2011-10-01?AWSAccessKeyId=&lt;ACCESSID&gt;\n  &amp;Action=GetServiceStatus\n  &amp;SellerId=&lt;SELLERID&gt;\n  &amp;SignatureVersion=2\n  &amp;Timestamp=2012-02-15T13%3A00%3A07Z\n  &amp;Version=2011-10-01\n  &amp;Signature=viPlDAbzEBwlTAwq4hNaZi%2Fa1Klf7qIXIP%2BKUsOcJTI%3D\n  &amp;SignatureMethod=HmacSHA256 HTTP/1.1\nHost: mws.amazonservices.co.uk\nx-amazon-user-agent: AmazonJavascriptScratchpad/1.0 (Language=Javascript)\nContent-Type: text/xml\n</code></pre>\n\n<p>I have tried to get the information from Fiddler, but it is not showing any traffic from the software but it must be communicating with Amazon to get the '400 bad request' error. Odd.</p>\n"},{"tags":["delphi","firemonkey","delphi-xe3"],"answer_count":1,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":201,"score":7,"question_id":12719749,"title":"How do you style the non-client area in a Firemonkey FM2 application in Delphi XE3","body":"<p>I previously asked this question in the Delphi XE2 timeframe, and the answer then was a pretty <a href=\"http://stackoverflow.com/questions/9013285/delphi-xe2-with-firemonkey-can-you-have-a-non-client-area-that-is-painted-in-a\">ugly hack</a>.</p>\n\n<p>Now Delphi XE3 supports non-client theming, according to the official release notes.   How do you do it in Delphi XE3 in Firemonkey FM2?</p>\n\n<p>I believe it must be something to do with the style-book, but I can't figure it out.  The form itself has an \"EnableBorderStyling\" property which I set to true,  and I am thinking I must have to load a style that contains some nonclient theme data, but I can't find a style that includes it.</p>\n\n<p>The help has nothing about this subject.  </p>\n\n<p><strong>Update2</strong> Okay, it's not broken, it's just that I don't have a style that contains this style element (as RRUZ says). </p>\n\n<pre><code>procedure TForm1.FormShow(Sender: TObject);\nbegin\n  StyleBook := StyleBook1;\n  WindowBorder.UpdateStyle;\nend;\n</code></pre>\n\n<p><strong>Update3</strong>:  Style files appear to be in two different locations, which is confusing:</p>\n\n<pre><code>  C:\\Program Files (x86)\\Embarcadero\\RAD Studio\\10.0\\Redist\\styles\\Fmx        \n  C:\\Users\\Public\\Documents\\RAD Studio\\10.0\\Styles\n</code></pre>\n\n<p>Note that I don't have a Luna.Style (firemonkey style) in either spot, however 5 seconds with the Style Editor tool. (Open, and Save as, and change type to .Style, and I had one!)</p>\n\n<p><strong>Update4</strong>: RRUZ's answer works, but on my system (Windows 8 RTM) the non-client styles don't look right, they have white corners around the areas of the \non't fully paint .  Resizing the window makes it go away, and I'm pretety sure I should be able to force a WM_NCREPAINT or something, and make it go away.</p>\n"},{"tags":["multithreading","delphi","delphi-xe2"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":133,"score":2,"question_id":12751031,"title":"Which wait method to call in an infinite waiting thread for Delphi XE2","body":"<p>if I've got a </p>\n\n<pre><code>While not terminated do\nbegin\n     doStuff;\n\nend\n</code></pre>\n\n<p>loop in the execute method of a Delphi XE2 thread, and I want to not make it bogart all my flops.</p>\n\n<p>What should I call,</p>\n\n<p>in Delphi 7, it was easy, I'd call Sleep(X) where X was inversely proportional to how interesting I thought the thread was.</p>\n\n<p>But now, I've got </p>\n\n<pre><code>SpinWait(X);\n</code></pre>\n\n<p>Which calls YieldProcessor X number of times</p>\n\n<p>and </p>\n\n<pre><code>Yield;\n</code></pre>\n\n<p>which calls the windows function \"SwitchToThread\".</p>\n\n<p>Should I use any of these or should I just set the priority of the thread?</p>\n"},{"tags":["c#","delphi","data","ipc"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":146,"score":1,"question_id":12731405,"title":"How can I pass XML from Delphi to C# without writing to disk?","body":"<p>I have a Delphi application that produces a blob of data that I am currently writing to a file system as xml. This data is then read in by a C# .Net application for further processing.</p>\n\n<p>The issue is that the object graph is large and the resultant xml file is 2 GB+ in size. It takes a relatively long time to write the xml file, and also to read it.</p>\n\n<p>Instead of writing to the file system, how can I transfer the data in RAM where it will be much faster?</p>\n\n<p>I have source code and compilers for both applications. I am using .Net version 4.0 and VS2010  for one application. The other I am using Delphi 5 (I have access to later versions, but I'm unsure if a migration would help).</p>\n\n<p>UPDATE: Thanks for all the suggestions, it's a lot to process. I will post back after further review. </p>\n"},{"tags":["delphi","post","delphi-2010","idhttp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":605,"score":0,"question_id":5969304,"title":"delphi 2010 - tidhttp post","body":"<p>i want to post data to the following url:</p>\n\n<p><a href=\"http://mehratin.heroku.com/personals/new\" rel=\"nofollow\">http://mehratin.heroku.com/personals/new</a></p>\n\n<p>i write the following code but has problem:</p>\n\n<pre><code>procedure TForm1.Button3Click(Sender: TObject);\nvar\n  aStream: TMemoryStream;\n  Params: TStringList;\nbegin\n  aStream := TMemoryStream.Create;\n  Params := TStringList.Create;\n  try\n    with IdHTTP1 do\n    begin\n      Params.Add('fname=123');\n      Params.Add('lname=123');\n      Request.ContentType := 'application/x-www-form-urlencoded';\n      try\n        Response.KeepAlive := False;\n        Post('http://localhost:3000/personals/new', Params);\n      except\n        on E: Exception do\n          showmessage('Error encountered during POST: ' + E.Message);\n      end;\n    end;\n</code></pre>\n\n<p>how can i post data by TIDHtttp.post method in delphi 2010?</p>\n"},{"tags":["windows","visual-studio","delphi","debugging"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12741751,"title":"Switching JIT debuggers?","body":"<p>When you have to maintain different projects with different IDEs, it often makes sense to install them on the same Windows machine.</p>\n\n<p>For instance, mix Visual Studio and Delphi, or various versions of Delphi on the same system (I'm sure others have even different combinations).</p>\n\n<p>One of the things you will find there is that the latest tool installs itself as JIT debugger: the just-in-time debugger that fires when an app crashes.</p>\n\n<p>Depending in which tool and version that app crashed (sometimes you cannot reproduce bugs when running inside the debugger, for instance in case of a Heisenbug), you want to select the debugger in advance.</p>\n\n<p>How can you do that?</p>\n"},{"tags":["delphi","generics","delphi-xe2","delphi-xe3"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":260,"score":3,"question_id":12749344,"title":"Why this code won't compile in XE3","body":"<pre class=\"lang-pas prettyprint-override\"><code>type\n  TForm72 = class(TForm)\n    procedure FormCreate(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }    \n  end;\n\n  TTestForm = class(TForm)\n  public\n    constructor CreateTest(AOwner: TComponent); virtual;\n  end;\n\n  TTestForm1 = class(TTestForm)    \n  public\n    constructor CreateTest(AOwner: TComponent); override;\n  end;\n\n  TTest&lt;T: TTestForm, constructor&gt; = class(TObject)\n  public\n    class procedure Test;\n  end;\n\nvar\n  Form72: TForm72;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm72.FormCreate(Sender: TObject);\nbegin\n  TTest&lt;TTestForm1&gt;.Test;\nend;\n\n{ TTest&lt;T&gt; }\n\nclass procedure TTest&lt;T&gt;.Test;\nvar\n  F: T;\nbegin\n  F := T.CreateTest(Application);\n  Form72.Caption :=  F.Name;\nend;\n\n{ TTestForm }\n\nconstructor TTestForm.CreateTest(AOwner: TComponent);\nbegin\n  inherited Create(AOwner);\nend;\n\n{ TTestForm1 }\n\nconstructor TTestForm1.CreateTest(AOwner: TComponent);\nbegin\n  inherited;\n  Caption := 'Bang';\nend;\n\nend.\n</code></pre>\n\n<p>This code compiled in XE2, but fail with \"[dcc32 Error] Unit71.pas(55): E2010 Incompatible types: 'T' and 'procedure, untyped pointer or untyped parameter'\"  in XE3. What I did wrong, or compiler did wrong? </p>\n"},{"tags":["delphi","delphi-2009"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":92,"score":3,"question_id":12748105,"title":"Delphi 2009 Function eliminated by linker","body":"<p>I want to use the function <code>DateTimeToStr</code> while debugging a project. I want to use either the evaluate/modify window, or the watch window. This always results in the error \"Function eliminated by linker\".</p>\n\n<p>I've ensured that the function is used by the project (I also placed a call explicitly in the function I want to debug), also I turned off  the optimization and recompiled the whole project.</p>\n"},{"tags":["arrays","delphi","tstringlist"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":2057,"score":6,"question_id":5886751,"title":"delphi array of string stringlist conversion","body":"<p>Is there a simple way in delphi to convert an array of strings to a tstringlist?</p>\n"},{"tags":["php","delphi","md5","delphi-xe2","firemonkey"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":208,"score":6,"question_id":12746747,"title":"How to get the same MD5 with Delphi and PHP?","body":"<p>I'm using Delphi <strong>XE2</strong> with FireMonkey.</p>\n\n<p>I have read many other questions about MD5 but didn't find an answer to the issue I have...\nI've also tested different scripts to generate a MD5 from Delphi:</p>\n\n<pre><code>function MD5(const text: string) : string;\nvar\n  md5 : TIdHashMessageDigest5;\nbegin\n  md5    := TIdHashMessageDigest5.Create;\n  Result := LowerCase(md5.HashStringAsHex(text, TEncoding.ANSI));\n  md5.Free;\nend;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>function MD5(const text: String) : string;\nvar\n  md5: IMD5;\nbegin\n  md5:= GetMD5;\n  md5.Init;\n  md5.Update(TByteDynArray(RawByteString(AnsiString(text))), Length(AnsiString(text)));\n  Result := LowerCase(md5.AsString);\nend;\n</code></pre>\n\n<p>Both give me the same results... which is <strong>often</strong> the same I have within PHP:</p>\n\n<pre><code>$md5 = md5($toencode);\n$md5 = hash(\"md5\", $toencode);\n</code></pre>\n\n<p>But the results are different if I use Delphi or PHP, when I request the MD5 of one of these chars: <code>\"</code> or <code>'</code> \nThere are maybe others chars which generate different results but I just find these ones during my tests...</p>\n\n<p>I have tested with many <strong>extended ASCII characters</strong> and have the same MD5...</p>\n\n<p>So, I don't understand why I have differences with few of them (<code>\"</code> or <code>'</code> ), and I'd like to know if there's a way to always generate the PHP MD5 result from Delphi, whatever the chars are.</p>\n\n<p>Any idea?</p>\n\n<blockquote>\n  <p>For instance:</p>\n  \n  <p>with <strong>Delphi</strong>:</p>\n  \n  <p>\": b15835f133ff2e27c7cb28117bfae8f4</p>\n  \n  <p>': 3590cb8af0bbb9e78c343b52b93773c9</p>\n  \n  <p>with <strong>PHP</strong>:</p>\n  \n  <p>\": 3bd864034f446da13581129bb17f9191</p>\n  \n  <p>': 024c94d6e03b6f67a86b952b914816c7</p>\n</blockquote>\n\n<p>Formalizing this question.. I've find the answer... BTW, I post it as others may have the same issue...</p>\n\n<p><code>\"</code> and <code>'</code> are escaped in PHP... so, within Delphi, I have to encode <code>\\\"</code> and <code>\\'</code>... if you think I have forgotten chars or if you want to add some details, do not hesitate...</p>\n"},{"tags":["osx","delphi","delphi-xe2","finder"],"answer_count":1,"favorite_count":1,"up_vote_count":30,"down_vote_count":1,"view_count":663,"score":29,"question_id":8013096,"title":"Howto add menu item to Mac OS Finder in Delphi XE2","body":"<p>I'm working on Delphi XE2 application targetting Mac OS and Windows. And I want to have integration into context menu. For windows this is simple task. But for Mac OS I dont know how to do this.</p>\n\n<p>I've read <a href=\"http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/SysServices/Articles/providing.html\">Providing a Service</a> documentation and tried similar code in Delphi but with no luck.</p>\n\n<p>Look at simple code for Finder integration trials.</p>\n\n<p>App.dpr</p>\n\n<pre><code>program App;\nuses\n   SysUtils,\n{$IFDEF MACOS}\n  AppKit, CocoaTypes, CoreFoundation,\n  CoreServices, Foundation, Mach, ObjCRuntime,\n  ObjectiveC, OCMarshal, OpenGL, QuartzCore, Security,\n  SystemConfiguration,\n{$ENDIF}\n  MessageProvider;\n{$IFDEF MACOS}\nvar\n  app: NSApplication;\n  provider: TMessageProvider;\n{$ENDIF}\n\nbegin\n  Application.Initialize;\n\n{$IFDEF MACOS}\n  provider := TMessageProvider.Create();\n\n  app := TNSApplication.Alloc();\n  app.setServicesProvider(provider);\n{$ENDIF}\n\n  Application.CreateForm(TFormOSVersion, FormOSVersion);\n  Application.Run;\nend.\n</code></pre>\n\n<p>MessageProvider.pas</p>\n\n<pre><code>unit MessageProvider;\n\ninterface\n\nuses\n  FMX.Dialogs\n{$IFDEF MACOS}\n  , AppKit, CocoaTypes, CoreFoundation,\n  CoreServices, Foundation, Mach, ObjCRuntime,\n  ObjectiveC, OCMarshal, OpenGL, QuartzCore, Security,\n  SystemConfiguration\n{$ENDIF}\n  ;\n\ntype\n  TMessageProvider = class\n  public\n    procedure simpleMessage(var userData: string; var error: string);\n  end;\n\nimplementation\n\nprocedure TMessageProvider.simpleMessage(var userData: string; var error: string);\nbegin\n  ShowMessage('Simple message from service.');\n  error := '';\nend;\n\nend.\n</code></pre>\n\n<p>Added configuration to info.plist</p>\n\n<pre><code>&lt;key&gt;NSServices&lt;/key&gt;\n&lt;array&gt;\n  &lt;dict&gt;\n     &lt;key&gt;NSKeyEquivalent&lt;/key&gt;\n     &lt;dict&gt;\n         &lt;key&gt;default&lt;/key&gt;\n         &lt;string&gt;e&lt;/string&gt;\n     &lt;/dict&gt;\n     &lt;key&gt;NSMenuItem&lt;/key&gt;\n     &lt;dict&gt;\n         &lt;key&gt;default&lt;/key&gt;\n         &lt;string&gt;App/Message&lt;/string&gt;\n     &lt;/dict&gt;\n     &lt;key&gt;NSMessage&lt;/key&gt;\n     &lt;string&gt;simpleMesage&lt;/string&gt;\n     &lt;key&gt;NSPortName&lt;/key&gt;\n     &lt;string&gt;App&lt;/string&gt;            \n  &lt;/dict&gt;\n&lt;/array&gt;\n</code></pre>\n\n<p>When run this on Mac OS application hungs and sometimes crashes with 'Bus error' exception.</p>\n\n<p>Can anybody help with this problem?</p>\n\n<p>Or maybe Delphi XE2 doesnt support this kind of functionality?</p>\n"},{"tags":["delphi","email","indy10"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":119,"score":2,"question_id":12746627,"title":"Can Indy's SMTP Authentication method cause an email to go to the junk box in hotmail?","body":"<p>My company has a business app written in Delphi that sends e-mails, it was written on Delphi 7 but we moved to Delphi 2010 earlier this year, due to the port we had to move from Indy 9 to Indy 10.</p>\n\n<p>Before the port we used this code to authenticate on the SMTP server:</p>\n\n<pre><code> ...\n IdSMTP1.AuthenticationType := atLogin;\n IdSMTP1.Username := pUser;\n IdSMTP1.Password := pPassword;\n ...\n</code></pre>\n\n<p>After the port we changed to</p>\n\n<pre><code> ...\n IdSMTP1.AuthType := satDefault;\n IdSMTP1.Username := pUser;\n IdSMTP1.Password := pPassword;\n ...\n</code></pre>\n\n<p>Before the change hotmail put the received e-mails in the inbox, but now it puts them in the junkbox. Can this change in the SMTP Authentication method be the cause of this?</p>\n\n<p>The SMTP server is from my company (ex: smtp.mycompany.com)</p>\n"},{"tags":["sql-server","delphi","stored-procedures","windows-7","compatibility"],"answer_count":3,"favorite_count":1,"up_vote_count":11,"down_vote_count":0,"view_count":970,"score":11,"question_id":3671270,"title":"SQL Server: Why would i add \";1\" to the end of a stored procedure name?","body":"<p>i came across a compatibility issue today, as a customer upgraded from Windows XP to Windows 7.</p>\n\n<p>The (12 year old code) is calling a stored procedure on the SQL Server called </p>\n\n<pre><code>ai_nextid\n</code></pre>\n\n<p>Except that when it calls the stored procedure it is using the name:</p>\n\n<pre><code>ai_nextid;1\n</code></pre>\n\n<p>Yes, with a \"<code>;1</code>\" appended. Apparently the SQL Server driver in Windows 95, Windows 2000, Windows XP, and possibly Windows Vista, are fine with this <strong><em>specifically</em></strong> added suffix. But the SQL Server ODBC driver in Windows 7 is different, and causes the error:</p>\n\n<blockquote>\n  <p>General SQL Error.<br>\n  [Microsoft][ODBC SQL Driver][SQL Server]Could not find stored procedure 'ai_nextid;1'.<br>\n  [Microsoft][ODBC SQL Driver][SQL Server]Indicator variable requried but not supplied'. </p>\n</blockquote>\n\n<p>With native error <a href=\"http://msdn.microsoft.com/en-us/library/aa258751%28SQL.80%29.aspx\" rel=\"nofollow\">2812</a>.</p>\n\n<p>This brings up 4 questions:</p>\n\n<ul>\n<li>why were we appending <code>;1</code> to the end of the stored procedure name? (what does it accomplish)</li>\n<li>why was the SQL Server driver ignoring it?</li>\n<li>why was a breaking change made in Windows 7?</li>\n<li>is the breaking compatibility change documented?</li>\n</ul>\n\n<p>The last two questions would probably be the same, since if they document it, they would justify it.</p>\n"},{"tags":["delphi","class","parent"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":144,"score":1,"question_id":12742965,"title":"Cast an object to parent class in Delphi","body":"<p>Given the following class hierarchy:</p>\n\n<pre><code>TClass1 = class\nend;\n\nTClass2a = class(TClass1)\nend;\n\nTClass2b = class(TClass1)\nend;\n</code></pre>\n\n<p>I operate on them using the following overloaded procedures </p>\n\n<pre><code>procedure DoSomething(AObj : TClass1); overload;\nbegin\n  // ...Do something for TClass1\nend\n\nprocedure DoSomething(AObj : TClass2a); overload;\nbegin\n  // Do something as parent class\n  DoSomething(TClass1(AObj))\n\n  // ...Do something for TClass2a\nend\n\nprocedure DoSomething(AObj : TClass2b); overload;\nbegin\n  // Do something as parent class\n  DoSomething(TClass1(AObj))\n\n  // ...Do something for TClass2b\nend\n</code></pre>\n\n<p>How can I dynamically cast each parameter to its parent class, instead of hard coding it?<br>\nI'd like to replace this:<br></p>\n\n<pre><code>// Do something as parent class\nDoSomething(TClass1(AObj))\n</code></pre>\n\n<p>With something more generic, like this<br></p>\n\n<pre><code>// Do something as parent class\nDoSomething(AObj.ClassParent(AObj))\n</code></pre>\n\n<p><br><br>\n<strong>Update:</strong> DoSomething procedures must reside outside the class hierarchy in this case. I can't reverse the structure, so I can't take advantage of class inheritance and polymorphism.<br>\nFurthermore, this is just an example. I'd like answers to focus on the core question: <strong>how can I cast an object to its parent class</strong> at runtime.   </p>\n"},{"tags":["c++","delphi","winapi","dll","delphi-6"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12744947,"title":"Using C++ DLL in Delphi 6","body":"<p>I have to use an encoding function from an external C++ DLL in Delphi 6.\nFollowing is the declaration provided :</p>\n\n<p><code>long &lt;Function Name&gt; (char *Data, long &amp;Apply, char *ReturnVal, long &amp;Size)</code></p>\n\n<p>Data is the input value, Apply is a boolean value (default : FALSE), ReturnVal is the return value from the DLL and Size is the length of the ReturnVal.</p>\n\n<p>To use this in Delphi 6, I wrote following Code:</p>\n\n<pre><code>implementation\n   const\n     EncoderDLL = '&lt;DLL NAME&gt;';\n     FunctionName = 'FUNCTION NAME';\n   var\n      _TEST : function(const Data : PChar; Apply : PInteger;stOutput : Pchar;\n          iSize : PInteger) : integer; stdcall;\n   .....\n   .....\n   var\n     stInput,stOutput : string;\n     iLength,i1,iResult : integer;\n     hnd : THandle;\n   begin\n     iLength := 0;\n     i1 := 0;\n     stInput := Trim(edtInput.Text);\n     hnd := SafeLoadLibrary(EncoderDLL);\n     if hnd &gt; 0 then\n     begin\n       @_TEST := GetProcAddress(hnd,FunctionName);\n       if @_TEST &lt;&gt; nil then\n       begin\n         iResult := _TEST(PChar(stInput),@i1,PChar(StOutput),@iLength); // ERROR\n       end;\n     end;\n     FreeLibrary(hnd);\n  end;\n</code></pre>\n\n<p>I am getting <strong>Access Violation</strong> in the line having 'ERROR' as comments.</p>\n\n<p>If I replace <strong>PChar</strong> in the function declaration with <strong>string</strong>, then the access violation does not come at the same line. It comes while freeing the library. Also, the value of the iLength parameter is populated correctly.</p>\n\n<p>Can anyone please provide pointers to resolve this issue. </p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":607,"score":1,"question_id":2273119,"title":"How to send an email using PageProducer in Delphi 7?","body":"<p>I am making an application in Delphi 7 and I need to send an email using <code>PageProducer</code> component in order to make it in HTML format. At this point, the objective is to send the email in both formats: <code>text/plain</code> and <code>text/html</code>, but really know how to send it in only one format: either <code>text/plain</code> or <code>text/html</code>. So, how to send an email using <code>PageProducer</code> in both formats: plain and HTML??</p>\n\n<p>I need that because there are webmail servers that don't accept HTML emails.</p>\n"},{"tags":["delphi","tab-ordering"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":465,"score":4,"question_id":6678795,"title":"delphi : move between cells of string grid","body":"<p>How can I move between cells of a string grid in Delphi by tab or arrow keys? As you know, a string grid in delphi has only one tab order but I need to move between cells by arrow keys or tab to be more comfortable and user friendly .</p>\n\n<p>I tried to use a KeyPress event, but this event only knows chars and doesn't know control keys like tab and ...</p>\n"},{"tags":["delphi","delphi-7","virtualtreeview","tvirtualstringtree"],"answer_count":1,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":290,"score":4,"question_id":12146241,"title":"Is it possible to use VirtualStringTree for a master detail grid view?","body":"<p>Alright I got something really tricky here...\nI would like to DRAW/USE Headers to a ChildNode.\nI think the idea is reasonable because it would look amazing to have headers in subnodes so the childnodes can be specified in a table. \nIs there a feature that VST has or is it not possible at all?</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["delphi","google","maps","delphi-7","distance"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":155,"score":1,"question_id":12742136,"title":"Delphi 7:How to get the distance between 2 addresses","body":"<p>I'm writing a program in Delphi for a (fake) courier company as a project. What I need, is the distance between the recipient and the couriers location. So I can work out what mode of transport should be used. </p>\n\n<p>How can this be achieved? Via Google Maps?</p>\n"},{"tags":["delphi","debugging","packages","delphi-xe2"],"answer_count":5,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":737,"score":6,"question_id":8793683,"title":"Delphi App has \"No Debug Info\" when Debugging","body":"<p>We have built an application that uses packages and components.  When we debug the application, the \"Event Log\" in the IDE often shows the our BPLs are being loaded without debug information (\"No Debug Info\").  This doesn't make sense because all our packages and EXEs are built with debug.</p>\n\n<pre><code>_(each project) | Options | Compiling_\n[ x ] Assertions\n[ x ] Debug information\n[ x ] Local symbols\nSymbol reference info = \"Reference info\"\n[   ] Use debug .dcus\n[ x ] Use imported data references\n\n_(each project) | Options | Linking_\n[ x ] Debug information\nMap file = Detailed\n</code></pre>\n\n<p>We have 4 projects, all built with runtime pacakges:</p>\n\n<ol>\n<li>Core.bpl</li>\n<li>Components.bpl</li>\n<li>Plugin.bpl  (uses both #1 &amp; #2)</li>\n<li>MainApp.exe  (uses #1)</li>\n</ol>\n\n<p><strong>Problems Observed</strong></p>\n\n<p>1) Many times when we debug, the Components.bpl is loaded with debug info, but all values in the \"Local Variables\" window are blank.  If you hover your mouse over a variable in the code, there is no popup, and Evaluate window also shows nothing (the \"Result\" pane is always blank).</p>\n\n<p>2) Sometimes the Event Log shows \"No Debug Info\" for various BPLs.  For instance, if we activate the Plugin.bpl project and set it's Run | Parameter's Host Application to be the MainApp.exe, and then press F9, all modules seems to load with \"Has Debug Info\" except for the Plugin.bpl module.  When it loads, the Event Log shows \"No Debug Info\".  However, if we close the app and immediately press F9, it will run it again without recompiling anything and this time Plugin.bpl is loaded with debug (\"Has Debug Info\").</p>\n\n<p><strong>Questions</strong></p>\n\n<p>1) What would cause the \"Local Variables\" window to <em>not</em> display the values?</p>\n\n<p>2) Why are BPLs sometimes loaded without debug info when the BPL was complied with debug and all the debug files (dcu, map, etc.) are available?</p>\n"},{"tags":["delphi","omnithreadlibrary"],"answer_count":0,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":153,"score":4,"question_id":12741784,"title":"How to replace TThread with OmniThreadLibrary?","body":"<p>I am used to create TThread descendants to do longlasting DB operations. My usual construct looks like this:</p>\n\n<pre><code>interface\ntype\n  TMyDBOp = class(TThread)\n  private\n    FConnection: TADOConnection;\n    FCommand1: TADOCommand;\n    FCommand2: TADOCommand; // and many more privated objects, vars ...\n    procedure InitDB;\n    procedure DoneDB;\n    procedure DoDBStuff; // and many more procedures and functions to structure the code\n  protected\n    procedure Execute; override;\n  public\n    constructor Create; reintroduce;\n    property X: T... // and many more properties to set on thread creation\n  end;\n\nimplementation\n\nconstructor TMyDBOp.Create;\nbegin\n  inherited Create(False);\nend;\n\nprocedure TMyDBOp.InitDB;\nbegin\n  FConnection:= TADOConnection.Create(nil);\n  // setup all connection props, setup all other components\nend;\n\nprocedure TMyDBOp.DoneDb;\nbegin\n  FConnection.Close; // and Free, and Free all other components\nend;\n\nprocedure TMyDBOp.DoDBStuff;\nbegin\n  // Execute FCommands, do some calculations, call other TMyDBOp methods etc. etc.\nend;\n\nprocedure TMyDBOp.Execute;\nbegin\n  Try\n    Coinitialize;\n    InitDB;\n    try\n      DoDBStuff;\n    finally\n      DoneDB;\n    End;\n  Except\n    // catch, log, report exceptions ....\n  End;\nend;\n</code></pre>\n\n<p>Then I obviously use this class with</p>\n\n<pre><code>var\n  DBOp: TMyDBOp;\nbegin\n  DBOp:= TMyDBOp.Create;\n  DBOp.Property1:= xyz; // and set all other props\n  DBOp.OnTerminate:= DBOpTerminated; // procedure to catch the thread and read back the results etc. etc.\n  DBOp.Resume;\nend;\n</code></pre>\n\n<p>And of course I usually set DBOp as another component var, to be able to Terminate, or WaitFor the thread.</p>\n\n<p>Now I would like to rewrite these TThread classes and use simillar construct with OmniThreadLibrary. How should i do that? I mean: What base class to use to define all the class components and properites?\n- Should it be a TOmniWorker descendant? Then where is the Execute procedure?\n- Should it be a TObject descendand and the OTLTaks is then created as <code>CreateTask(DBOp.Execute)</code>?\n- Should it be a TObject that I pass as a Parameter for OTLTask created as <code>CreateTask(anonymous method that reads the parameter and calls its Execute)</code>?</p>\n\n<p>Thanks for any hint.</p>\n\n<p>EDIT: (based on gabrs' comment on clarification)\nMy point is that all the samples/tests in OTL source show only a simple usage. Mostly basic \"one-procedure\" threads. For my case I need a rather complex class with subcomponents and subroutines that is all run in a thread. I am look for such a class ancestor and its design pattern.</p>\n"},{"tags":["delphi","debugging","dcu"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":167,"score":2,"question_id":12074306,"title":"How do I stop the debugger from stepping into Delphi-supplied units?","body":"<p>The debugger steps into the source code on errors (like with <kbd>F7</kbd>), but I want to restore the normal working mode where the Delphi basic DCUs (the library) are only compiled into my code, and the sources are not used in debugging.</p>\n\n<p>For example, on an error in my program, the debugger is stepping into Controls.pas, into <code>TControl.Click</code>. The normal case (right after installation) is for Delphi to step over these methods.</p>\n\n<p>Should I recompile Controls.pas without debug information? If so, how?</p>\n\n<hr>\n\n<p>I extending this theme with additional information to better understanding:</p>\n\n<p>We use Delphi6 Prof. what have problem with Mouse (System Error Code 5).\nSo we want to recompile to Controls.pas to replace the Mouse Position getter code.\nThen:</p>\n\n<ol>\n<li>I created a folder for it: \"c:\\D\\Common\\Delphi_Patches\\Delphi_6\\\"</li>\n<li>I put the original Controls.pas into it.</li>\n<li>I modified the Controls.pas, replaced the position getter code.</li>\n<li>I set the Delphi's Library path, set the first folder to \"c:\\D\\Common\\Delphi_Patches\\Delphi_6\\\"</li>\n</ol>\n\n<p>With these steps I can compiled the source with mouse-safe code.</p>\n\n<p>Ok, but then the Delphi everytime steps into Controls.pas on F7, and on any exceptions - this is very \"angermaker\" thing.</p>\n\n<p>No matter that I removed the \"Controls.pas\" from the Library path - then the debugger is finding the original \"Controls.pas\" for it, and opens it... :-(</p>\n\n<p>We don't use \"Use Debug DCU-s\" in any codes.</p>\n\n<p>I tried to remove \"Debug Information\" from compiler options, but it is no matter, the Delphi is opens the original Controls.pas...</p>\n\n<p>So I search the way to Delphi don't step into \"Controls.pas\", but use my dcu...</p>\n\n<p>I hope this provide better context to understand the problem.</p>\n"},{"tags":["delphi","delphi-xe2","datasnap","hung"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":519,"score":3,"question_id":9523543,"title":"Updating client UI while waiting for DataSnap","body":"<p>I created a MDI Delphi app in Delphi XE2 that connects to a DataSnap server via a <code>TSQLConnection</code> component (<code>driver = datasnap</code>).  A right-click on the <code>TSQLConnection</code> at design-time lets me generate the DataSnap client classes (ProxyMethods).</p>\n\n<p>My goal is to have an elapsed time clock [0:00] on the client side that shows how long a DataSnap request takes to service, updated every 1 second.  The two approaches that I have tried, but don't work are:</p>\n\n<p><em><strong>Method #1</em></strong></p>\n\n<blockquote>\n  <p>Use a <strong><code>TTimer</code></strong> with a 1 second interval that updates the elapsed time clock while a ProxyMethod is being execute.  I enable the timer just before calling the ProxyMethod.  While the ProxyMethod is running, the <strong><code>OnTimer</code></strong> event doesn't fire -- a breakpoint in the code is never hit.</p>\n</blockquote>\n\n<p><em><strong>Method #2</em></strong></p>\n\n<blockquote>\n  <p>Same as Method #1, except the timer is a <strong><code>TJvThreadTimer</code></strong>.  While the ProxyMethod is running, the <strong><code>OnTimer</code></strong> event fires, but the <strong><code>OnTimer</code></strong> code doesn't get execute until after the ProxyMethod completes.  This is evident because a breakpoint in the <strong><code>OnEvent</code></strong> code gets hit in rapid succession after the ProxyMethod completes -- like the <strong><code>OnTimer</code></strong> events have all been queued in the main VCL thread.</p>\n</blockquote>\n\n<p>Furthermore, clicking anywhere on the client app while a slow ProxyMethod is running makes the app appear to be hung (\"Not Responding\" appears in title-bar).</p>\n\n<p>I think the best solution is to move the execution of the ProxyMethods to a separate thread.  However, there <strong>must</strong> be an existing solution -- because the related <em>hung</em> app issue seems like it would be a <em>common</em> complaint.  I just can't find the solution.</p>\n\n<p>Any suggestions are appreciated.  Otherwise, I will resign myself to moving the ProxyMethod execution into a separate thread.</p>\n"},{"tags":["delphi","datasource"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":12741650,"title":"DBEdit allow to delete value while DataSource.AutoEdit is false","body":"<p>Good day!</p>\n\n<p>I have a Query, DataSource and DBEdit. DataSource.AutoEdit is false. Query.State is not in dsEdit or dsInsert. So I can't change the value in DBEdit. But if I press Delete key, value in DBEdit deletes (Query.State doesn't change). And if focus leaves this DBEdit, I receive an \"Dataset not in edit or insert mode\". Is that a some bug or something else and how can I fix this? I've tested this in new simple projects to be sure that the problem is not in my project. </p>\n\n<p>Delphi version: Delphi® XE Version 15.0.3953.35171</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":92,"score":0,"question_id":12733421,"title":"delphi: what happens to the objects associated with strings in items collection of a control","body":"<p>What will happen here?</p>\n\n<p>Will the object remain valid when the procedure ends and goes out of scope? Will it remain unallocated or I can still refer that?</p>\n\n<p>I need to add such items whenever a user decides to add items to my control, and I must also add the objects of my class by creating then on user's activity. I am concerned, when I will need to process these objects for further use in my app, will they remain in scope or be accessible? Or their references will be lost?</p>\n\n<pre><code>     procedure TForm1.Button1Click(Sender: TObject);\n     var\n       LMyCustomObj : TMyCustomObject;\n     begin\n       LMyCustomObj := TMyCustomObject.Create;\n\n       ListBox1.Items.AddObject('1', LMyCustomObj);\n     end;\n</code></pre>\n\n<p>Further if I add</p>\n\n<pre><code>     LMyCustomObj.Free; \n</code></pre>\n\n<p>to my function, will they be removed from the control's collection also, or will it result in memory leak?</p>\n"},{"tags":["sql","delphi","delphi-xe2","tclientdataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":137,"score":0,"question_id":12726992,"title":"Refreshing values in a TClientDataset after update","body":"<p>I got a TClientDataset that contains data from several tables. When I apply updates on this dataset it might get out of sync.</p>\n\n<p>I'll give you one example:</p>\n\n<p>In the table to update i got an id called \"Client_id\". The clientdataset also contains a value \"Client_name\" that is fetched from a \"Client\" table and displayed in the GUI.</p>\n\n<p>Then I change the \"Client_id\" in my table and do an apply updates on the table the \"Client_name\" field in my dataset suddenly is out of sync. This is naturally because the clientdataset has not been refreshed.</p>\n\n<p>Now I could do a clientdataet.refresh on the afterpost event, but then the cursor on the dataset jumps to the first record, and I loose my pointer to the updated record.</p>\n\n<p>Anyone got a clue on how to solve this?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":140,"score":2,"question_id":12739132,"title":"Do I need to Free() a TDateTime?","body":"<p>It seems to be working, but I am scratching my head trying to find a memory leak and I am not very good at that sort thing :-(</p>\n\n<pre><code>const UNIX_START_DATE: TDateTime = 25569.0;\n\nfunction UnixToDateTime(USec: Longint): TDateTime;\nbegin\n  Result := (Usec / 86400) + UNIX_START_DATE;\nend;\n</code></pre>\n\n<p>I am not actually calling <code>TDateTime.Create()</code> - but is the compiler (meaning that I would have to free it soemwhere)?  Or, since <code>TDateTime</code> is bascially just a douuble, is the compiler just pushing it on the stack for assignment to the caller?</p>\n"},{"tags":["algorithm","delphi","sorting","computer-science","mergesort"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":135,"score":0,"question_id":12733734,"title":"Dissecting mergesort routine","body":"<p><strong>Disclaimer:</strong> this is a question that requires some explanation of code and algorithm. It is not intended to fix anything or optimize anything but rather facilitate understanding.</p>\n\n<p>My understanding of sorting routines is not great. I asked for help with converting an already available code for mergesort from <code>integer type</code> to <code>string type</code> here: <a href=\"http://stackoverflow.com/questions/12673633/delphi-mergesort-for-string-arrays\">delphi mergesort for string arrays</a>. After I received my answer I set out to understand the sorting routine.</p>\n\n<p>Couple of resources came handy to help understanding:</p>\n\n<ol>\n<li><a href=\"http://www.iti.fh-flensburg.de/lang/algorithmen/sortieren/merge/mergen.htm\" rel=\"nofollow\">http://www.iti.fh-flensburg.de/lang/algorithmen/sortieren/merge/mergen.htm</a></li>\n<li><a href=\"http://www.youtube.com/watch?v=9Qk1t66g7IU\" rel=\"nofollow\">http://www.youtube.com/watch?v=9Qk1t66g7IU</a> </li>\n</ol>\n\n<p>I attempted to dissect the code to follow it along. This question is not my attempt to validate my own understanding of mergesort, but rather show the sorting routine in a clear manner. The value of this question is for people attempting to understand mergesort better. This is essential as other sorts can be understood easier if you understand one prototype well.</p>\n\n<p><strong>My question is why did we add \"1\" to set length and to \"Result\"</strong></p>\n\n<pre><code>SetLength(AVals, Length(Vals) div 2 + 1);\nResult := 1 + PerformMergeSort(0, High(Vals));\n</code></pre>\n\n<p><strong>and why did we subtract \"1\" here?</strong> <em>EDIT: I think K will be out of bounds if not subtract 1?</em></p>\n\n<pre><code>Result := k - 1;\n</code></pre>\n\n<p>here is the code in this question; BTW this is an optimized mergesort as it copies only half the array:</p>\n\n<pre><code>function MergeSortRemoveDuplicates(var Vals: array of Integer):Integer;\nvar\n  AVals: array of Integer;\n\n   //returns index of the last valid element\n  function Merge(I0, I1, J0, J1: Integer):Integer;\n  var\n    i, j, k, LC:Integer;\n  begin\n    LC := I1 - I0;\n    for i := 0 to LC do\n      AVals[i]:=Vals[i + I0];\n      //copy lower half or Vals into temporary array AVals\n\n    k := I0;\n    i := 0;\n    j := J0;\n    while ((i &lt;= LC) and (j &lt;= J1)) do\n    if (AVals[i] &lt; Vals[j]) then begin\n      Vals[k] := AVals[i];\n      inc(i);\n      inc(k);\n    end else  if (AVals[i] &gt; Vals[j]) then begin\n      Vals[k]:=Vals[j];\n      inc(k);\n      inc(j);\n    end else begin //duplicate\n      Vals[k] := AVals[i];\n      inc(i);\n      inc(j);\n      inc(k);\n    end;\n\n    //copy the rest\n    while i &lt;= LC do begin\n      Vals[k] := AVals[i];\n      inc(i);\n      inc(k);\n    end;\n\n    if k &lt;&gt; j then\n      while j &lt;= J1 do begin\n        Vals[k]:=Vals[j];\n        inc(k);\n        inc(j);\n      end;\n\n    Result := k - 1;\n  end;\n\n //returns index of the last valid element\n\n  function PerformMergeSort(ALo, AHi:Integer): Integer; //returns\n  var\n    AMid, I1, J1:Integer;\n  begin\n\n  //It would be wise to use Insertion Sort when (AHi - ALo) is small (about 32-100)\n    if (ALo &lt; AHi) then\n    begin\n      AMid:=(ALo + AHi) shr 1;\n      I1 := PerformMergeSort(ALo, AMid);\n      J1 := PerformMergeSort(AMid + 1, AHi);\n      Result := Merge(ALo, I1, AMid + 1, J1);\n    end else\n      Result := ALo;\n  end;\n\nbegin\n  SetLength(AVals, Length(Vals) div 2 + 1);\n  Result := 1 + PerformMergeSort(0, High(Vals));\nend;\n</code></pre>\n\n<p>here is my understanding with very small modification:</p>\n\n<pre><code>function MergeSortRemoveDuplicates(var Vals: array of Integer):Integer;\nvar\n  AVals: array of Integer;\n\n   //returns index of the last valid element\n  function Merge(I0, I1, J0, J1: Integer):Integer;\n  var\n    i, j, k, LC:Integer;\n  begin\n    // difference between mid-point on leftside\n    // between low(Original_array) and midpoint(true Original_array midpoint)\n    // subtracting I0 which is Low(Original_array)\n    // or here equals zero(0)\n    // so LC is quarter point in Original_array??\n    LC := I1 - I0;\n\n    // here we walk from begining of array\n    // and copy the elements between zero and LC\n    // this is funny call that Vals[i + I0] like 0 + 0\n    // then 1 + 0 and so on. I guess this guarantees if we are\n    // starting from non-zero based array??\n    for i := 0 to LC do\n      AVals[i]:=Vals[i + I0];\n\n\n    // k equal low(Original_array)\n    k := I0;\n\n    // I will be our zero based counter element\n    i := 0;\n\n    // J will be (midpoint + 1) or\n    // begining element of right side of array\n    j := J0;\n\n    // while we look at Copy_array elements\n    // between first element (low(Copy_array)\n    // and original_array from midpoint + 1 to high(Original_array)\n    // we start to sort it\n    while ((i &lt;= LC) and (j &lt;= J1)) do\n\n    // if the value at Copy_array is smaller than the Original_array\n    // we move it to begining of Original_array\n    // remember position K is first element\n    if (AVals[i] &lt; Vals[j]) then begin\n      Vals[k] := AVals[i];\n\n      // move to next element in Copy_array\n      inc(i);\n\n      // move to next element in Original_array\n      inc(k);\n\n    // if the value at copy_array is larger\n    // then we move smaller value from J Original_array (J is midpoint+1)\n    // to position K original_array (K now is the lower part of ) Original_array)\n    end else  if (AVals[i] &gt; Vals[j]) then begin\n      Vals[k]:=Vals[j];\n\n      //move K to the next element in Original_array\n      inc(k);\n\n      // move j to next element in Original_array\n      inc(j);\n\n    // if the value in Original_array is equal to the element in Copy_array\n    // do nothing and count everything up\n    // so we end up with one copy from duplicate and disregard the rest\n    end else begin //duplicate\n      Vals[k] := AVals[i];\n      inc(i);\n      inc(j);\n      inc(k);\n    end;\n\n    //copy the rest\n    while i &lt;= LC do begin\n      Vals[k] := AVals[i];\n      inc(i);\n      inc(k);\n    end;\n\n    // if the counters do not endup at the same element\n    // this means we have some that maybe leftover on\n    // the right side of the Original_array.\n    // This explains why K does not equal J : there are still elements left over\n    // then copy them to Original_array\n    // starting at position K.\n    if k &lt;&gt; j then\n      while j &lt;= J1 do begin\n        Vals[k]:=Vals[j];\n        inc(k);\n        inc(j);\n      end;\n\n    // why K - 1?\n    // function needs result so return will be null if called\n    // I don't understand this part\n    Result := k - 1;\n  end;\n\n //returns index of the last valid element\n\n  function PerformMergeSort(ALo, AHi:Integer): Integer; //returns\n  var\n    AMid, I1, J1:Integer;\n  begin\n\n  //It would be wise to use Insertion Sort when (AHi - ALo) is small (about 32-100)\n    if (ALo &lt; AHi) then\n    begin\n      AMid:=(ALo + AHi) shr 1;    // midpoint\n      I1 := PerformMergeSort(ALo, AMid);  //recursive call I1 is a data point on the left\n      J1 := PerformMergeSort(AMid + 1, AHi);  // recursive call I1 is a data point on the right\n      Result := Merge(ALo, I1, AMid + 1, J1);\n    end else\n      Result := ALo;\n  end;\n\nbegin\n  // test if array is even then we can split nicely down middle\n  if Length(Vals) mod 2 = 0 then\n  begin\n    SetLength(AVals, Length(Vals) shr 1);\n    Result := PerformMergeSort(0, High(Vals));\n  end\n  else\n  //array is odd let us add 1 to it and make it even\n  // shr 1 is essentially dividing by 2 but doing it on the bit level\n  begin\n    SetLength(AVals, (Length(Vals) + 1) shr 1);\n    Result := PerformMergeSort(0, High(Vals));\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12738523,"title":"Filling a RichEdit from an external procedure","body":"<p>I have written a procedure that fills a RichEdit component depending on the input.</p>\n\n<pre><code>procedure LoadCPData(ResName: String);\nbegin\n  ResName := AnsiLowercase(ResName) + '_data';\n  rs := TResourceStream.Create(hInstance, ResName, RT_RCDATA);\n  try\n    rs.Position := 0;\n    info.reMeta.Lines.LoadFromStream(rs);\n  finally\n    rs.Free;\n  end;\nend;\n</code></pre>\n\n<p>Note: The above procedure is stored in an external <code>.pas</code> file called Functions.</p>\n\n<p>When I go to call the procedure in my form the RichEdit remains empty. However, if I were to place that code block in the form itself, the RichEdit component fills the data without a problem as expected. Now I could place the above code block in the form itself, but I plan on using the procedure multiple times in a <code>case</code> statement.</p>\n\n<p>What will I need to include in order for my procedure to work?</p>\n\n<p>Thank you in advanced!</p>\n"},{"tags":["delphi","ado"],"answer_count":2,"favorite_count":2,"up_vote_count":23,"down_vote_count":0,"view_count":466,"score":23,"question_id":11034362,"title":"Do ADO components, especially TADOCommand, work more reliably with un-named, or named parameters, in some cases?","body":"<p>There are several questions on StackOverflow that seem to have answers that contradict each other on the subject of ADO/OleDB, delphi TADOQuery/TADOCommand and the subject of parameters.</p>\n\n<p>Parameters can be introduced two ways, in the CommandText or SQL property of an ADO component.  Named parameters, which work most of the time for me, are introduced with colons:</p>\n\n<pre><code>  select a, b, c from bar where bat = :baz\n</code></pre>\n\n<p>This works, 99% of the time for me, just fine. Every now and then I find that ADO or Delphi's wrappers around it, won't accept \":baz\" and requires that I write this instead:</p>\n\n<pre><code>  select f, g, h from bar where bat = ?\n</code></pre>\n\n<p>This results in an unnamed parameter, instead of a named parameter. When an ADO Query or ADO Command contains only one parameter, this isn't a big deal. But that's not when ADO acts up on me. Yesterday it acted one way, and today, a different way with a dual-command in a single TADOCommand object, like this, with two commands in one CommandText string:</p>\n\n<pre><code>delete from bar where id = :id1\ndelete from bat where id = :id2\n</code></pre>\n\n<p>I had to change it to this:</p>\n\n<pre><code>delete from bar where id = ?\ndelete from bat where id = ?\n</code></pre>\n\n<p>It worked all day yesterday. Today, I had to change it back to the first version, to get it to work. The symptom was that the ADO parameters disappeared and would not come back, and when I try to execute the command I get an error, index out of range, when I try to access <code>Parameters[0]</code>.  Nothing gives me any warning that the parameters are going away.  It seems that a few connections to the ADO dataset, at designtime, jogs the <code>TADOCommand</code> component, in particular, and it \"just breaks on me\".  It is particularly maddening when you're trying to write a query or a command, and you know it works, but the ADO component has decided not to accept \"?\" or \":x\" right now.  You can get around its total inability to function by switching from one to the other. But it frustrates me, and probably actually completely blocks other people. I know some people always dynamically build their SQL in code, and avoid using <code>Parameters</code>, and maybe <em>this is why</em>.</p>\n\n<p>Possible answers to my question that I'm anticipating are:</p>\n\n<ol>\n<li><p>ADO doesn't support multiple commands, or at least Delphi's wrappers don't. Or maybe <code>TADOCommand</code> just doesn't work reliably here.</p></li>\n<li><p>Parameters are a buggy area in all of ADO, or all of Delphi's ADO wrappers?</p></li>\n<li><p>You're doing it wrong.</p></li>\n</ol>\n\n<p>I'm using Delphi XE2, but I've seen similarly dodgy behaviour in 2007, 2009, 2010, and XE.\nI'm using Microsoft OLEDB Provider for SQL Server as my OLEDB Provider.</p>\n"},{"tags":["delphi","directshow","dspack"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12695617,"title":"How to initialize a TFilter with a known Video Capture source without using TSysDevEnum.GetMoniker?","body":"<p>Is it possible to create/initailize a TFilter object with a known Video Capture source without using TSysDevEnum.GetMoniker(...)?</p>\n\n<p>The Video Capture Source's name and other details are already known and can be obtained by GraphEdit Filter Browser. The intention is to speed up the initialization of TFilter and attach it to the FilterGraph programmatically.</p>\n"},{"tags":["delphi"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":170,"score":2,"question_id":12719843,"title":"Should I do periodic checks in an OnIdle handler or a timer?","body":"<p>I want to log the user out of my application after a period of inactivity.</p>\n\n<p>Would it be better to put my check for inactivity in the applciation's OnIdle handler or in a timer handler?</p>\n\n<p>Granularity is not too important. Logout can be plus/minus a few seconds, maybe even a minute.</p>\n\n<p>I get the feeling that the app's OnIdle is going to be firing too often. Any advice? The code iteself is only a few lines.</p>\n"},{"tags":["multithreading","delphi","critical-section","readerwriterlockslim","readerwriterlock"],"answer_count":2,"favorite_count":3,"up_vote_count":12,"down_vote_count":2,"view_count":336,"score":10,"question_id":10378253,"title":"Faster TMultiReadExclusiveWriteSynchronizer?","body":"<p>Is there a <em>faster</em> kind of <code>TMultiReadExclusiveWriteSynchronizer</code> out there? FastCode perhaps?</p>\n\n<p>Starting with Windows Vista, Microsoft added a <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/aa904937%28v=vs.85%29.aspx\">Slim Reader/Writer lock</a>. It <a href=\"http://blog.delphi-jedi.net/2011/09/16/slim-readwrite-lock-the-fast-alternative-to-tmultireadexclusivewritesynchronizer/\">performs much better</a> than Delphi's <code>TMultiReadExclusiveWriteSynchronizer</code>. Unfortunately it only exists in Windows Vista and later, something which few customers actually have yet.</p>\n\n<p>Presumably the concepts in use inside a <code>Slim Reader/Writer lock</code> could be redone in native Delphi code - but has anyone done it?</p>\n\n<p>i have a situation where acquiring and releasing locks on a <code>TMultiReadExclusiveWriteSynchronizer</code> (even when there's no contention - a single thread), causes 100% overhead (the operation time doubles). i can run without locking, but then my class is no longer thread-safe.</p>\n\n<p>Is there a faster <code>TMultiReadExclusiveWriteSynchronizer</code>?</p>\n\n<p><strong>Note</strong>: If i use a <code>TCriticalSection</code> i only suffer a 2% performance hit (although critical sections are known to be fast when the <em>acquire</em> succeeds, i.e. while it's single threaded and there's no contention). The downside of a CS is that i lose the \"<em>multiple readers</em>\" capability.</p>\n\n<h2>Bonus Reading</h2>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/853316/is-critical-section-always-faster\">Is Critical Section always faster?</a></li>\n<li><a href=\"http://synopse.info/forum/viewtopic.php?id=322\">How to write fast multi-thread Delphi applications</a></li>\n</ul>\n"},{"tags":["delphi","smtp","c++builder","indy"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":138,"score":1,"question_id":12572096,"title":"Indy SMTP hangs or freezes up on Connect method","body":"<p>I have a client attempting to connect SMTP server. I have the OnStatus event linked to the smtp client and see the</p>\n\n<p>Resolving / Connecting / Connected states.  But sometimes there is a hangup / application freezes when trying to connect.  I see the Connected state being raised from OnStatus though.  What could the issue be.  I ruled out the Resolving DNS ans et both ConnectTimeout and Readtimeout settings on smtp as shown here:</p>\n\n<pre><code>  smtp.OnStatus := SMTPStatus;\n  smtp.ConnectTimeout := 10000;\n  smtp.ReadTimeout := 10000;\n  smtp.Connect;\n  // SOMETIMES MY LOG DOES NOT GET HERE Log('AfterConnect');\n  if smtp.Connected then\n  begin\n    smtp.Send(Mess);\n    smtp.Disconnect;\n  end\n</code></pre>\n\n<p>On about 600KB attachment it seems to be getting stuck on encoding the attachment part and never completes, currently the encoding type is the default one.</p>\n\n<pre><code>10/3/2012 10:21:43 AM  Status: Resolving hostname XXXXXXXXXX.com.\n10/3/2012 10:21:43 AM  Status: Connecting to 10.5.2.171.\n10/3/2012 10:21:44 AM  Status: Connected.\n10/3/2012 10:21:45 AM  Status: Encoding text\n10/3/2012 10:21:45 AM  Status: Encoding attachment\n</code></pre>\n"},{"tags":["delphi","indy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12669560,"title":"Extra Header info from Indy message","body":"<p>I'm reading email headers from an IMAP account using Indy in Delphi 2007.</p>\n\n<p>The Msg (TidMessage) Date property gives the date and time the email was sent (from the client), I'm trying to get the date and time the email was received by the server by inspecting the ExtraHeaders property, can this be done?</p>\n\n<p>So far I've tried Msg.ExtraHeaders.Values['Received'] and Msg.ExtraHeaders.Text, both of which returned an empty string.</p>\n\n<p>Am I going about this the right way?</p>\n"},{"tags":["c#","delphi","window","draw","handle"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":77,"score":1,"question_id":12697570,"title":"How do I paint to a non-.Net host window from a C# DLL?","body":"<p>I have an application in Delphi 6, and due to library issues, I need to write a component in C# or C++ that will exist on a Delphi form. The program is currently Delphi and C#, and it calls C# for dialogs. I need something embedded into a TForm that will allow me to draw that component in C#.</p>\n\n<p>I think I can create a component in Delphi and during its <code>Paint</code> routine I just call the function in the DLL. But what do I pass to the C# DLL so that it can paint in that window, and how would I get C# to actually do it?</p>\n\n<p>I guess just being able to paint in some arbitrary DC on demand in C# is all I need to do.</p>\n"},{"tags":["delphi","internet-explorer","registry"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":110,"score":3,"question_id":12718636,"title":"Get IE version on Delphi - registry solution not working","body":"<p>I use this function to get IE version. But in some cases it cannot find this key and returns 0. Is there another way that does not rely on registry ?</p>\n\n<pre><code>function GetIEVersion: string;\nvar\n   Reg: TRegistry;\n   S: string;\n   i : integer;\nbegin\n   Reg := TRegistry.Create;\n   with Reg do\n      begin\n         RootKey := HKEY_LOCAL_MACHINE;\n         OpenKey('Software\\Microsoft\\Internet Explorer', False);\n         if ValueExists('Version') then\n          begin\n            S := ReadString('Version');\n          end\n         else\n         begin\n            S := '0';\n         CloseKey;\n        end;\n         Free;\n      end;\n    result := s;\nend;\n</code></pre>\n"},{"tags":["windows","delphi","serial-port","communication","delphi-units"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":541,"score":0,"question_id":1592989,"title":"How can i CloseComm, OpenComm, WriteComm and ReadComm with the windows unit?","body":"<p>I have an old comm unit that uses WinTypes,WinProcs. As i understand these were merged too the Windows unit. \nAre there similar functions in the Windows unit?</p>\n"},{"tags":["delphi","proxy","twebbrowser"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12732843,"title":"Authentification on HTTP proxy in Delphi XE","body":"<p>I need a little help:</p>\n\n<pre><code>uses wininet, urlmon;\n....\n\nvar proxy_info : PInternetProxyInfo;\n....\n\nbegin\n  user:='mycooluser';\n  pass:='mycoolpass';\n  UserAgent:='MSIE';\n  New (proxy_info);\n  proxy_info^.dwAccessType := INTERNET_OPEN_TYPE_PROXY;\n  proxy_info^.lpszProxy := PAnsiChar('XXX.XXX.XXX.XXX:ZZZZ');\n  proxy_info^.lpszProxyBypass := PAnsiChar('');\n  UrlMkSetSessionOption(INTERNET_OPTION_PROXY_USERNAME, PAnsichar(user), Length(user)+1, 0);\n  UrlMkSetSessionOption(INTERNET_OPTION_PROXY_PASSWORD, PAnsichar(pass), Length(pass)+1, 0);\n  UrlMkSetSessionOption(URLMON_OPTION_USERAGENT, PChar(UserAgent), Length(UserAgent)+1, 0);\n  UrlMkSetSessionOption(INTERNET_OPTION_PROXY, proxy_info, SizeOf(Internet_Proxy_Info), 0);\n  Dispose(proxy_info);\n\n  EmbeddedWB1.Navigate('http://2ip.ru');\nend;\n</code></pre>\n\n<p>But it's doesn't work, although this proxy 100% working if its just specify in the IE settings.</p>\n"},{"tags":["delphi","delphi-2010","vcl","delphi-xe3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":173,"score":0,"question_id":12725383,"title":"Install both Delphi 2010 and XE3 on the same Windows?","body":"<p>My Win7 now installed RAD Studio 2010 with Delphi 2010, can I install Delphi XE3 separately? So both Delphi 2010 and XE3 work on the same Windows?</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi","delphi-xe2","dwscript"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":12685466,"title":"DWScript: Add an new array definition to a dwsUnit at runtime","body":"<p>What is the method, using Delphi XE2, to call to add Array definition to a <code>dwsUnit</code> component at runtime?</p>\n\n<p><code>MyDwsUnit.Arrays.Add</code> returns a <code>TCollectionItem</code>, not <code>TdwsArray</code>, while adding an array definition at design time adds a <code>TdwsArray</code> instance!.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":12730989,"title":"How to override AdvancedCustomDrawItem - TreeView","body":"<p>i'm trying to override AdvancedCustomDrawItem Method since i want to make my owner TreeView \nthis is my attempt :</p>\n\n<pre><code>type TTreeView=class (Vcl.ComCtrls.TTreeView )\n  protected\n  procedure AdvancedCustomDrawItem(\n  Node: TTreeNode; State: TCustomDrawState; Stage: TCustomDrawStage;\n  var PaintImages, DefaultDraw: Boolean);override;\n\n end;\n</code></pre>\n\n<p>but i got this error :\n[dcc32 Error] Unit1.pas(10): E2137 Method 'AdvancedCustomDrawItem' not found in base class</p>\n"},{"tags":["oracle","delphi","reportbuilder"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12729437,"title":"Report Builder - Reporting in Multiple Languages","body":"<p>I need to create 2 reports in ReportBuilder which produce identical output except that one report needs to produce English text and the other in French. The labels/headings on the report will need to be translated from English to French and in some cases the data returned will also have to be translated. </p>\n\n<p>I was thinking about doing this by creating the English statement as a base class then inheriting from this to create the French report, changing the labels as necessary. My question is how is the best way to go about translating the data itself? </p>\n\n<p>I am using Delphi BDS 2006, Oracle 11g and ReportBuild v10 </p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":127,"score":2,"question_id":12726756,"title":"How to pass multiple file extensions to TDirectory.GetFiles?","body":"<p><code>TDirectory.GetFiles</code> has a parameter called <a href=\"http://docwiki.embarcadero.com/Libraries/en/System.IOUtils.TDirectory.GetFiles\" rel=\"nofollow\"><code>SearchPattern</code></a>. Embarcadero's documentation says</p>\n\n<blockquote>\n  <p>The mask used when matching file names (for example, \"*.exe\" matches all the executable files).   </p>\n</blockquote>\n\n<p>However, I want to pass multiple file types. I get those types from a <code>FilterComboBox.Mask</code>. So, it is a string that looks like <code>'*.txt;*.rtf;*.doc'</code>. </p>\n\n<p>I have tried to pass that string directly to <code>GetFiles</code> and it doesn't work. Do I have to parse it, break it into pieces and feed every individual piece to <code>GetFiles</code>?</p>\n"},{"tags":["xml","delphi","nativexml"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":100,"score":1,"question_id":12721815,"title":"Create data in xml from txt file","body":"<p>I want to creat this xml file from a txt file...</p>\n\n<p>\n\n\n\n\n \n\n</p>\n\n<p>i do this\nCode:</p>\n\n<pre><code> FXml := TNativeXml.CreateName('Root');\n FXml.XmlFormat := xfReadable;\n open the file\n AssignFile(TFile,'user.txt');\n Reset(TFile);\n while not eof(TFile) do \n begin\n    Readln(TFile,text);\n    r :=  Pos(' ',text);\n    t2 := Trim(Copy(text,1,Length(text)));\n    t1 := Trim(Copy(t2,0,r));\n    FXml.Root.NodeNew('row');\n    FXml.Root.NodeByName('row').WriteAttributeString('user',t2);\n    FXml.Root.NodeByName('row').WriteAttributeString('pin',t1);\n end;\n   FXml.SaveToFile('new.xml');\n FXml.free;\n</code></pre>\n\n<p>something i do wrong with nodebyname but what... </p>\n\n<p>Thank you...</p>\n"},{"tags":["delphi","virtualtreeview"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":119,"score":2,"question_id":12728022,"title":"How to enable checkboxes in Virtual TreeView columns headers?","body":"<p>I'm using Virtual TreeView V5.0.1 (06 Sep 2012) in Delphi XE2. Setting <code>CheckBox := True</code> on a header column property does not enables the checkbox, so here's the question, how do I enable checkboxes on column headers?</p>\n\n<p><img src=\"http://i.stack.imgur.com/RXEHz.png\" alt=\"enter image description here\"></p>\n"},{"tags":["delphi","windows-7","delphi-xe2","core-audio"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":124,"score":3,"question_id":12660480,"title":"Exception calling \"IAudioSessionManager2.GetSessionEnumerator()\" in Delphi XE2","body":"<p>The code below, compiled under Delphi XE2 Win32 and running under Win 7 64 bit, produces the following exception when executing the line \"AudioSessionManager2.GetSessionEnumerator\":</p>\n\n<p><em>\"Project22.exe raised exception class $C0000005 with message 'access violation at 0x7027edb2: write of address 0x0051ced6'\"</em></p>\n\n<p>My knowledge of exception classes or what they mean is lacking, so I have no idea as to what the exception means or how to go about fixing it.</p>\n\n<p>Here is the code that raises the exception (asserts used to debug code):</p>\n\n<pre><code>var\n  HRES: HRESULT;\n  DeviceEnumerator: IMMDeviceEnumerator;\n  DefaultDevice: IMMDevice;\n  AudioSessionManager2: IAudioSessionManager2;\n  Enumerator: IAudioSessionEnumerator;\nbegin\n\n  CoInitialize( nil );\n\n  HRES := CoCreateInstance( CLSID_MMDeviceEnumerator, nil, CLSCTX_ALL, IID_IMMDeviceEnumerator, DeviceEnumerator );\n  Assert( Succeeded( HRES ) );\n\n  HRES := DeviceEnumerator.GetDefaultAudioEndpoint( eRender, eMultimedia, DefaultDevice );\n  Assert( Succeeded( HRES ) );\n\n  HRES := DefaultDevice.Activate( IID_IAudioSessionManager2, CLSCTX_ALL, nil, IUnknown( AudioSessionManager2 ) );\n  Assert( Succeeded( HRES ) );\n\n  HRES := AudioSessionManager2.GetSessionEnumerator( Enumerator );  // &lt;- EXCEPTION HERE\n  Assert( Succeeded( HRES ) );\n\n  [snip]\n</code></pre>\n\n<p>I'm using the Core Audio definitions from <a href=\"http://code.google.com/p/mfpack-media-foundation/source/browse/trunk#trunk/MFPACK/CoreAudio\" rel=\"nofollow\">MFPack on Google Code</a>, with the IAudioSessionManager2 and IAudioSessionEnumerator interfaces looking as follow:</p>\n\n<pre><code>IAudioSessionManager2 = interface(IUnknown)\n['{77AA99A0-1BD6-484F-8BC7-2C654C9A9B6F}']\n  function GetSessionEnumerator(out SessionEnum: IAudioSessionEnumerator): HResult; stdcall;\n  function RegisterSessionNotification(SessionNotification: IAudioSessionNotification): HResult; stdcall;\n  function UnregisterSessionNotification(SessionNotification: IAudioSessionNotification): HResult; stdcall;\n  function RegisterDuckNotification(const sessionID: LPCWSTR; const duckNotification: IAudioVolumeDuckNotification): HResult; stdcall;\n  function UnregisterDuckNotification(const duckNotification: IAudioVolumeDuckNotification): HResult; stdcall;\nend;\n\nIAudioSessionEnumerator = interface(IUnknown)\n['{E2F5BB11-0570-40CA-ACDD-3AA01277DEE8}']\n  function GetCount(out SessionCount: integer): HResult; stdcall;\n  function GetSession(const SessionCount: integer; out Session: IAudioSessionControl): HResult; stdcall;\nend;\n</code></pre>\n\n<p>I believe the interfaces are properly defined and I also double-checked the GUIDs.</p>\n\n<p>Since the same sequence of instructions execute as intended under Visual Studio 2012 (Win32 project), I suspect the problem is with my code (little doubt here), the Core Audio interfaces definitions or Delphi. The C++ code running in VS is the following:</p>\n\n<pre><code>IMMDeviceEnumerator *DeviceEnumerator = NULL;\nIMMDevice* DefaultDevice = NULL;\nIAudioSessionManager2* AudioSessionManager = NULL;\nIAudioSessionEnumerator* Enumerator = NULL;\nHRESULT HR;\n\nHR = CoCreateInstance( __uuidof(MMDeviceEnumerator), NULL, CLSCTX_ALL, __uuidof(IMMDeviceEnumerator), (void**)&amp;DeviceEnumerator );\nHR = DeviceEnumerator-&gt;GetDefaultAudioEndpoint( eRender, eMultimedia, &amp;DefaultDevice );\nHR = DefaultDevice-&gt;Activate( __uuidof(IAudioSessionManager2), CLSCTX_ALL, NULL,(void**)&amp;AudioSessionManager );\nHR = AudioSessionManager-&gt;GetSessionEnumerator( &amp;Enumerator );\n</code></pre>\n\n<p>With the C++ code I can retrieve the session enumerator correctly and use GetCount, etc.</p>\n\n<p>I spent countless hours trying to find out what was wrong with my code and I'm still clueless, so <em>any</em> help would greatly be appreciated.</p>\n"},{"tags":["delphi","column-width","tdbgrid"],"answer_count":5,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":2816,"score":2,"question_id":2004167,"title":"How do I make a TDBGrid's columns fit the grid's width?","body":"<p>I've got a TDBGrid with predefined columns, and I just can't get the width right.  I can mess with the Width property of the columns in the Form Designer and get the width to look just right at design time, but at runtime, for whatever reason, the columns tend to be significantly wider, and I end up with a scroll bar at the bottom of the grid.  Is there any way to get make the columns size themselves correctly without all the trial-and-error, especially if the grid only has one or two of them?</p>\n"},{"tags":["delphi","canvas","styles","brush"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":126,"score":1,"question_id":12709166,"title":"Diagonal brush style gives me black area","body":"<p>I want to draw a diagonal cross into a Canvas with this code:</p>\n\n<pre><code>InFlateRect(r, -1, -1);\nCanvas.Brush.Color := clYellow;\nCanvas.Brush.Style := bsFDiagonal;\nCanvas.Pen.Color := clRed;\n//Pen.Style := psClear;\nCanvas.Rectangle(r);\n</code></pre>\n\n<p>But the result is a black box.</p>\n\n<p>If I remove the style changing, a normal solid yellow area I got.</p>\n\n<p>Why is the rectangle black with this code?</p>\n\n<p>Thanks for every suggestion</p>\n\n<hr>\n\n<p>Sorry for missing info, I extend it:\nThis procedure is using TMetaFileCanvas to draw. On normal Form I can draw any brush style, like the TShape...</p>\n"},{"tags":["delphi","port","delphi-2010","intraweb","tms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":158,"score":1,"question_id":10721360,"title":"TMS Intraweb How to set port manually","body":"<p>I want to set the port of my website manually, but whenever I use a TMS component, the port will be set randomly.</p>\n\n<p>How can I specify the port of my application while using TMS components?</p>\n"},{"tags":["delphi","indy"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":179,"score":6,"question_id":12722606,"title":"Log in to website from Delphi","body":"<p>I would ask if someone was kind enough to explain to me how to login at webpage from Delphi app. All the examples I've found here have proved useless to me or I'm doing something wrong. I'm tired of the search and the code that does not work. </p>\n\n<p>There is no error message, I even get page code into Memo but seems it's code from login page (not account [dashboard] page) - seems this code can't pass auth at all and I don't know why.</p>\n\n<p>What is wrong in this code : </p>\n\n<pre><code>procedure Login;\nvar\n HTTP: TIdHTTP;\n Param: TStringList;\n S: String;\nbegin\n HTTP := TIdHTTP.Create(nil);\n HTTP.CookieManager := Main_Form.CookieManager;\n Param := TStringList.Create;\n Param.Clear;\n Param.Add('login=example');\n Param.Add('password=example');\n\ntry\n HTTP.Get ('http://www.filestrum.com/login.html');\n HTTP.Post('http://www.filestrum.com/login.html', Param);\n S := HTTP.Get ('http://www.filestrum.com/?op=my_account');\n Main_Form.Memo2.Lines.Add(S);\nfinally\n  HTTP.Free;\n  Param.Free;\nend;\nend;\n</code></pre>\n\n<p>or with this version :</p>\n\n<pre><code>procedure Login;\nvar\n HTTP: TIdHTTP;\n S: String;\nbegin  \n HTTP                             := TIdHTTP.Create(nil);\n HTTP.CookieManager               := Main_Form.CookieManager;\n HTTP.Request.BasicAuthentication := True;\n HTTP.Request.Username            := 'example';\n HTTP.Request.Password            := 'example';\n HTTP.AllowCookies                := True;\n HTTP.HandleRedirects             := True;\n\n S := HTTP.Get ('http://www.filestrum.com/?op=my_account');\n Main_Form.Memo2.Lines.Add(S);\nend;\n</code></pre>\n\n<p>Used Delphi XE2 and there is no way to make this code running and login. It's same with XE3 demo. As I said, I'm really tired searching some solution, waste days into it and nothing.</p>\n\n<p>Please guys, some help here. Really need it.</p>\n"},{"tags":["delphi","tstringlist","tstrings"],"answer_count":5,"favorite_count":2,"up_vote_count":19,"down_vote_count":0,"view_count":659,"score":19,"question_id":9379607,"title":"Why variables are declared as TStrings and created as TStringList?","body":"<p>Why variables are declared as <code>TStrings</code> and created as <code>TStringList</code>?</p>\n\n<p>eg: the var <code>sl</code> is declared as <code>TStrings</code> but created as <code>TStringList</code></p>\n\n<pre><code>var\n  sl : TStrings;\nbegin\n  sl := TStringList.Create;\n\n  // add string values...\n  sl.Add( 'Delphi' );\n  sl.Add( '2.01' );\n\n  // get string value using its index\n  // sl.Strings( 0 ) will return\n  //   'Delphi'\n  MessageDlg(\n    sl.Strings[ 0 ],\n    mtInformation, [mbOk], 0 );\n\n  sl.Free;\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-5"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":130,"score":0,"question_id":12710967,"title":"Dbgrid - automatic post to database","body":"<p>I have a form with a query, a dataset, an editable dbgrid and an updatesql component. When I need to save the changes made in the dbgrid, I call this procedure:</p>\n\n<pre><code>procedure TEditCardDetailForm.SaveChanges;\nbegin\n  Database1.StartTransaction;\n  try\n    Query2.ApplyUpdates;\n    Database1.Commit;\n  except\n    Database1.Rollback;\n    raise;\n  end;\n  Query2.CommitUpdates;\nend;\n</code></pre>\n\n<p>However I want the changes to be applied automatically to the database when I press Enter or go to another row after editing a cell in the dbgrid - the way it is done when I use a TTable component. Is there a way to do it?</p>\n"},{"tags":["delphi","vcl","delphi-xe2","firemonkey"],"answer_count":4,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":3178,"score":10,"question_id":7315050,"title":"Delphi XE2: Possible to instantiate a FireMonkey Form in VCL application?","body":"<p>Prior to Delphi XE2, we have VCL only to create GUI apps.  Delphi XE2 states that:</p>\n\n<blockquote>\n  <p>Caution: FireMonkey (FMX) and the Visual Component Library (VCL) are\n  not compatible and cannot be   used in the same project or\n  application. That is, an application must be exclusively one or the\n  other, either FireMonkey or VCL. The incompatibility is caused by\n  framework differences between FireMonkey (FMX) and VCL.</p>\n</blockquote>\n\n<p>My application is a pure VCL application that built with runtime packages.  All VCL forms are stored in runtime package.  If I am going to create a FireMonkey form and store in a package, do I have any chance to instantiate this FireMonkey form in my VCL application at runtime?  So I may enjoy the 3D or HD effects of FireMonkey.</p>\n"},{"tags":["delphi","windows-xp","direct3d","direct3d9"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":185,"score":0,"question_id":10551512,"title":"High CPU usage when on secondary display (windowed mode)","body":"<p>Our custom DirectShow Video Renderer uses Direct3D9. When displayed in windowed mode (covering the whole display srface) on the primary display/monitor it performs well with CPU usage low, but when it's displayed on the secondary monitor the CPU (kernel) usage goes really high due to DirectX using the cpu to do the transfer between devices. This happens only on Windows XP.\nI create the Direct3DDevice9 using the appropriate adapter, at least I think I am.\nFirst I get the monitor handle for the specified window handle and then search for the D3D adapter that corresponds to this monitor using GetAdapterMonitor().\nWhen moving the window and reinitializing the device I can see that the Adapter changes from 0 to 1, as expected. Is there something else I should do?\nhere's the relevant code (Delphi).</p>\n\n<pre><code>Adapter := D3DADAPTER_DEFAULT;\nif (FWnd &lt;&gt; 0) and (FWnd &lt;&gt; INVALID_HANDLE_VALUE) then\nbegin\n  monitor := MonitorFromWindow(FWnd, MONITOR_DEFAULTTONEAREST);\n  for idxAdapter := 0 to D3D.GetAdapterCount - 1 do\n    if D3D.GetAdapterMonitor(idxAdapter) = monitor then\n    begin\n      Adapter := idxAdapter;\n      Break;\n    end;\nend;\nResult := D3D.GetDeviceCaps(Adapter, D3DDEVTYPE_HAL, Caps);\n\nPP.BackBufferCount := 1;\nPP.BackBufferFormat := FFormat; // xrgb\nPP.BackBufferWidth := FWidth;\nPP.BackBufferHeight := FHeight;\nPP.Flags := D3DPRESENTFLAG_VIDEO;\nPP.PresentationInterval := D3DPRESENT_INTERVAL_ONE;\nPP.SwapEffect := D3DSWAPEFFECT_DISCARD;\n\nPP.hDeviceWindow := FWnd;\nPP.Windowed := not FFullScreen;\n\nD3D.CreateDevice(Adapter, D3DDEVTYPE_HAL, FWnd, D3DCREATE_MULTITHREADED or D3DCREATE_MIXED_VERTEXPROCESSING, @PP, Device);\n</code></pre>\n\n<p>Other players and renderers don't have this problem. MPC-HC and madVR had this problem but fixed it. Looking at MPC-HC's code I can't find any significant differences to how I'm doing it.</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":1,"view_count":1621,"score":8,"question_id":7422689,"title":"Selecting a directory with TOpenDialog","body":"<p>I'd really like to know the various ways I could select a directory with the TOpenDialog, whether it be downloading a new component or using what is provided by Delphi, but preferably using what is provided by Delphi. </p>\n\n<p>Prior to this, I have been using the SelectDirectory command but I think it'd be a difficulty for the users of my program to look for the specified directory.</p>\n\n<p>I think the SelectDirectory is 'weak' because it can be a long process when searching for the directory you want. Say for example, you want to navigate to the Application Data directory. How long or difficult would it be to navigate there? In the end, users may not even reach their desired directory. </p>\n\n<p>I need something like this where the user can copy and paste directories into the directory address bar at the top there.</p>\n\n<p><img src=\"http://i.stack.imgur.com/hQ9vy.png\" alt=\"enter image description here\"></p>\n\n<p>Thank you for all your answers.</p>\n"},{"tags":["delphi","compression","delphi-2010","decompression"],"answer_count":6,"favorite_count":2,"up_vote_count":4,"down_vote_count":1,"view_count":647,"score":3,"question_id":7442047,"title":"Compression component","body":"<p>I am looking for a compression component that supports Delphi2010 and allow me to do the basic operations of:</p>\n\n<ul>\n<li>create .zip archives</li>\n<li>extract from .zip archives</li>\n<li>delete .zip archives</li>\n</ul>\n\n<p>I also need the component to be free for commercial usage and possibly does not use/rely on a DLL (I don't mind if it does).</p>\n\n<p>So far I have looked into <a href=\"http://www.componentace.com/zip_component_zip_delphi_zipforge.htm\" rel=\"nofollow\">ZipForge</a>, <a href=\"http://www.componentace.com/compression_component_compression_delphi_encryption_delphi_flexcompress.htm\" rel=\"nofollow\">FlexCompress</a>, <a href=\"http://kadao.dir.bg/download/\" rel=\"nofollow\">KaZip</a> and <a href=\"http://www.rarlab.com/rar_add.htm\" rel=\"nofollow\">UnRAR</a>, but I found out that I needed to purchase a license to commercially use ZipForge and FlexCompress. When it came to KaZip, there were errors in the code so I was unsuccessful in terms of installing the component. Whereas UnRAR was just that; it only decompressed .zip or .rar archives.</p>\n\n<p>So In summary, I need a compression component that:</p>\n\n<ul>\n<li>is free for commercial use</li>\n<li>supports <strong>Delphi 2010</strong></li>\n<li>performs the above stated operations</li>\n<li>does not use DLLs (however, I do not mind)</li>\n</ul>\n"},{"tags":["delphi","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":206,"score":7,"question_id":7306355,"title":"Counting folders within a folder","body":"<p>Does anyone know a code I can use to count the number of folders in a specified directory?</p>\n"},{"tags":["delphi","internet-explorer"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":420,"score":1,"question_id":3253284,"title":"How do you get the currently installed version of IE with Delphi?","body":"<p>How can I get the version IE installed in my computer?</p>\n\n<hr>\n\n<p>I've figured out a work-around on my problem so that I don't have to check for the version of the currently installed IE anymore. Thanks for the answers though. :) </p>\n"},{"tags":["delphi","canvas","gdi","alphablending","ownerdraw"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":166,"score":3,"question_id":12717003,"title":"Alphablend and TransparentBlt","body":"<p>This question is related to my <a href=\"http://stackoverflow.com/q/12700165/62576\">earlier question</a> on SO.</p>\n\n<p>I want to combine two layers with alpha applied only to a specific portion of the source layer. One way I tried was to set SourceConstantAlpha to $ff (and have the function use the alpha channel in the source layer).</p>\n\n<p>This kind of works - although slow (I guess I can speed it up by using ScanLines), the kind of part is that I cannot figure out what to set the alpha channel to. The documentation suggests that the calculation is:</p>\n\n<pre><code>st.Red  = Src.Red   + (1 - Src.Alpha) * Dst.Red\n</code></pre>\n\n<p>I have tried a few different values by guess work, but my first question is: How do I compute the alpha value?</p>\n\n<p>After reading a few other SO questions, I came across the TransparentBlt function, which does the masking well (and fast) but not the transparency, is there a way to combine\nthese two calls together (maybe using a third layer) ?</p>\n\n<pre><code>unit MainWnd;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, ExtCtrls, ControlsEx;\n\ntype\n{------------------------------------------------------------------------------}\n  TfrmMain = class(TForm)\n    PaintBox1: TPaintBox;\n    procedure PaintBox1Paint(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  frmMain: TfrmMain;\n\nimplementation\n\n{$R *.dfm}\n\n{..............................................................................}\nprocedure copyToAlpha(const in_bitmap : TBitmap; const in_transparentColor : TColor;\n        const in_transparency : integer);\nvar\n  x : integer;\n  y : integer;\n  p : integer;\nbegin\n  ASSERT(in_bitmap.PixelFormat = pf32bit);\n\n  for x := 0 to in_bitmap.Width - 1 do\n  begin\n    for y := 0 to in_bitmap.Height - 1 do\n    begin\n      p := in_bitmap.Canvas.Pixels[x, y];\n      if TColor(p) &lt;&gt; in_transparentColor then\n      begin\n        in_bitmap.Canvas.Pixels[x, y] := p or (in_transparency shl 24);\n      end\n      else\n        in_bitmap.Canvas.Pixels[x, y] := p or ($ff shl 24);\n    end;\n  end;  \nend;\n\n{..............................................................................}\nprocedure alphaBlendTest(\n        const in_target : TCanvas;\n        const in_width : integer;\n        const in_height : integer);\nconst\n  BARSIZE = 30;\nvar\n  bitmap  : TBitmap;\n  r       : TRect;\n  blendFn : BLENDFUNCTION;\n  ret     : Boolean;\nbegin\n  blendFn.BlendOp             := AC_SRC_OVER;\n  blendFn.SourceConstantAlpha := $ff;\n  blendFn.BlendFlags          := 0;\n  blendFn.alphaFormat         := AC_SRC_ALPHA;\n\n  bitmap := TBitmap.Create;\n  try\n    bitmap.Width              := in_width;\n    bitmap.Height             := in_height;\n    bitmap.PixelFormat        := pf32bit;\n    bitmap.HandleType         := bmDIB;\n    bitmap.TransparentColor   := clFuchsia;\n    bitmap.Transparent        := true;  \n    bitmap.Canvas.Brush.Color := clFuchsia;\n    bitmap.Canvas.FillRect(Bounds(0, 0, in_width, in_height));\n    bitmap.Canvas.Brush.Color := clGreen;\n\n    r := Bounds(\n        in_width div 2 - (in_width div 3) div 2,\n        0,\n        (in_width div 3) + 1,\n        BARSIZE          + 1);\n\n   bitmap.Canvas.Rectangle(r);\n   // done drawing\n\n   //copyToAlpha(bitmap, clFuchsia, 1);\n   ret := Windows.TransparentBlt(\n        in_target.Handle,\n        0,\n        0,\n        in_width,\n        in_height,\n        bitmap.Canvas.Handle,\n        0,\n        0,\n        in_width,\n        in_height,\n        clFuchsia);\n        //blendFn);\n\n    ASSERT(ret);\n  finally\n    bitmap.Free;\n  end;\nend;\n\n\n\n{..............................................................................}\nprocedure TfrmMain.PaintBox1Paint(Sender: TObject);\nvar\n  r: TRect;\nbegin\n  PaintBox1.Canvas.Brush.Color := clBlue;\n  r := Bounds(0, 0, PaintBox1.ClientWidth, PaintBox1.ClientHeight);\n  PaintBox1.Canvas.FillRect(r);\n  PaintBox1.Canvas.Brush.Color := clRed;\n  PaintBox1.Canvas.Ellipse(0, 0, PaintBox1.ClientWidth, PaintBox1.ClientHeight);\n\n  alphaBlendTest(PaintBox1.Canvas, PaintBox1.ClientWidth, PaintBox1.ClientHeight);\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":176,"score":0,"question_id":12710603,"title":"Programmtically Print to PDF","body":"<p>I have a customer who wants to print to PDF and Physical printer at the same time. They don't want to print the physical copy from the PDF, why I don't know. I tried saving as a temporary RTF file and calling ShellExecute to print to Adobe but doesn't appear this works.</p>\n\n<p>Does anyone have a way without a 3rd party PDF library to print to PDF from a file?</p>\n\n<p>UPDATE: To clarify a bit the user is working with a dynamic document creator. They see preview text on the screen in a TRichEdit and the current print method is the TRichEdit's print command (RichEdit.Print). The first attempt to a pdf was by saving the contents of this rich edit to a temp.rtf file. </p>\n"},{"tags":["delphi","service"],"answer_count":6,"favorite_count":3,"up_vote_count":12,"down_vote_count":0,"view_count":1908,"score":12,"question_id":2401528,"title":"How can I disable a service via Delphi?","body":"<p>I use a routine that can start and stop services via Delphi but I also need to be able to disable them, is it possible?</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":96,"score":-1,"question_id":12706153,"title":"Inconsistent search behaviour in XE2?","body":"<p>Find in Files (all files in project, no regexp): \"Integer(\"<br/>\n(\"\" are not part of the search term) with 'Whole words only' checked \nreturns these 6 lines:</p>\n\n<pre><code>PlanRoutines.BekijkRefplan( Integer( Items.Objects[ ItemIndex ] ));\nPlanRoutines.BekijkRefplan( Integer( Items.Objects[ ItemIndex ] ));\nResult := Integer( ComboBoxStatus.Properties.Items.Objects[ ComboBoxStatus.ItemIndex ] );\nLNieuweStatus := Integer( ComboBoxNieuweStatus.Properties.Items.Objects[ ComboBoxNieuweStatus.ItemIndex ] );\nLVanafStatus  := Integer( ComboBoxVanafStatus.Properties.Items.Objects[ ComboBoxVanafStatus.ItemIndex ] );\nLTotStatus    := Integer( ComboBoxNieuweStatus.Properties.Items.Objects[ ComboBoxTotStatus.ItemIndex ] );\n</code></pre>\n\n<p>How come?</p>\n\n<p>I would expect this first search to find <em>no</em> results (I accidentally had WWO checked when this happened)</p>\n\n<p>With WWO unchecked, searching for \" Integer(\"  (note the extra space in front) Delphi finds approx 100 lines including those 6 mentioned above.</p>\n\n<p>Even the search dialog itself has weird behaviour:\nIf I copy or type \"Integer(\" into the search edit, then insert a space in front, the cursor jumps to the end of \"Integer(\".<br/>\nThis does not happen if I type another character in front of \"Integer(\", or if I type a space in front of e.g. \"string\", \"string(\" or \"String(\"</p>\n\n<p>Can anyone confirm? What is my Delphi XE2 Update 4 Hotfix 1 (16.0.4504.48759) doing (Win7 64bit)?</p>\n\n<p>It's not a big deal, just curious.</p>\n\n<p>(That initial search result is wrong, but I would not intentially do that search. WWO was still checked from a previous search).</p>\n\n<p>Additional examples that surprise me: with WWO on, search \"TMyEventHandlers.\" -> 0 results, search \":= true\" -> 0 results, search \"true)\" -> plenty results, search \"(Sender:\" -> 0 results. I do not understand how Delphi behaves here. The only thing I can can conclude right now is 'Better make sure to only have chars/digits' in the search string when checking WWO.</p>\n"},{"tags":["delphi","oop","design-patterns","delphi-2010"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":74,"score":4,"question_id":12476023,"title":"Can I implement change tracking on a classes that derive from a wsdl imported classes in Delphi 2010?","body":"<p>Is there a way to implement change tracking in a derived class without overriding the getters and setters of the base class?<br/>\nI have an entity framework based multi-tier project in development with the data access and business logic eventually moving to C# based server application. (Data access has already been migrated) The client is in Delphi 2010.<br/>\nI have used data transfer objects for passing information between the client and server, however it was necessary to implement my own change tracking from Delphi. I originally achieved that by inheriting from the Dtos in the wsdl and \"overriding\" the getters and setters.\nBase class in wsdl import (no real control over this):</p>\n\n<pre><code>// ************************************************************************ //\n  // XML       : DtoCONTAINER_JNL, global, &lt;complexType&gt;\n  // Namespace : http://k3scs.com/WCF\n  // ************************************************************************ //\n  DtoCONTAINER_JNL = class(DtoBase)\n  private\n    FJNL_ID: Integer;\n    FJNL_TYPE_ID: Integer;\n    FJNL_DATE: TXSDateTime;\n published\n    property JNL_ID:      Integer      read FJNL_ID write FJNL_ID;\n    property JNL_TYPE_ID: Integer      read FJNL_TYPE_ID write FJNL_TYPE_ID;\n    property JNL_DATE:    TXSDateTime  read FJNL_DATE write FJNL_DATE;\n</code></pre>\n\n<p>Derived classes:</p>\n\n<pre><code>  TDtoCONTAINER_JNL = class(DtoCONTAINER_JNL, IDto)\n  private\n    FName             : string;\n    FReferenceCounted : boolean;\n    _isNew            : boolean;\n    FModified         : boolean;\n    FJNL_ID           : integer;\n    FJNL_TYPE_ID      : integer;\n    FJNL_DATE         : TDateTime;\n  public\n    property JNL_ID : integer read FJNL_ID write SetJNL_ID;\n    property JNL_TYPE_ID : integer read FJNL_TYPE_ID write SetJNL_TYPE_ID;\n    property JNL_DATE : TDateTime read GetJNL_DATE write SetJNL_DATE;\n</code></pre>\n\n<p>typical setter method:</p>\n\n<pre><code>procedure TDtoCONTAINER_JNL.SetJNL_DATE(const value : TDateTime);\nbegin\n  ChangedProperties:= DtoGenerics.ChangeTracker('JNL_DATE', value, inherited JNL_DATE, self.IsLoaded, ChangedProperties);\n  inherited JNL_DATE := DtoGenerics.GetXsDate(value);\nend;\n</code></pre>\n\n<p>typical getter method:</p>\n\n<pre><code>function TDtoCONTAINER_JNL.GetJNL_DATE : TDateTime;\nbegin\n  Result := DtoGenerics.GetDate(inherited JNL_DATE);\nend;\n</code></pre>\n\n<p>Whenever a property is set, the change tracker adds this property name to a list of changed properties for return to the server. This allows the update statements to be targeted and efficient. The problem is each of the getters/setters have practically made the derived classes incompatible with the base, that is, polymorphism is broken, and casting no longer works as expected.<br/>\nThe classes above are generated from a t4 template in C# based on the corresponding database tables/entities, so changing the over 100 classes shouldn't be a problem.<br/>\nDoes anyone have any experience with this?<br/>\nAny suggestions will be appreciated.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>the Wsdl importer consists mainly of constants that use string format or something similar to create the Delphi equivalent of the complex types. I made the following changes, using similar constant names to easily identify my changes, and also where to place them in relation to pre-existing code.\nIdeally, I would get rid of inheritance completely and just use modified versions of my classes in the wsdl, because I still can't submit a modified Tdto even if I cast it back to a Dto class because the web service rejects it with a message like \"expecting DtoObject, but got undtoUnit.TdtoObject instead\".\nSo, I make do with inheritance to handle conversions between ArrayOfObjects to TList and vice versa.\nHere are the changes, as best as I can remember:</p>\n\n<pre><code>// In WSDLImpConst\n// I changed sRemoteClassDeclPas constant value of 'private' to 'proctected'\n// Then I added these after SUnitInit\nsTrackerDec   =     sTrackerProcPrefix+ sTrackerProcArgs                  + sLineBreak;\nsTrackerProc  =      sTrackerDec + 'begin'                                + sLineBreak +\n        '  Result:= nProps;'                                              + sLineBreak +\n        '  if (_loaded) and (oVal &lt;&gt; pVal) then'    + sLineBreak +\n        '  begin '                                                        + sLineBreak +\n        '    Result := TrackChange(pName, nProps);'                       + sLineBreak +\n        '  end;'                                                          + sLineBreak +\n        'end;'                                                            + sLineBreak ;\n\n\nsTracker2Dec  =       sTrackerProcPrefix+ sTracker2ProcArgs               + sLineBreak;\nsTracker2Proc  =      sTracker2Dec + 'begin'                              + sLineBreak +\n        '  Result:= nProps;'                                              + sLineBreak +\n        '  if (_loaded) and (oVal &lt;&gt; DateTimeToXSDateTime(pVal)) then'    + sLineBreak +\n        '  begin '                                                        + sLineBreak +\n        '    Result := TrackChange(pName, nProps);'                       + sLineBreak +\n        '  end;'                                                          + sLineBreak +\n        'end;'                                                            + sLineBreak ;\n\nsTracker3Dec  =       sTrackerProcPrefix+ sTracker3ProcArgs               + sLineBreak;\nsTracker3Proc  =      sTracker3Dec + 'begin'                              + sLineBreak +\n        '  Result:= nProps;'                                              + sLineBreak +\n        '    if nProps = '''' then'                                       + sLineBreak +\n        '      nProps := pName'                                           + sLineBreak +\n        '    else'                                                        + sLineBreak +\n        '      nProps := pName + '','' + nProps;'                         + sLineBreak +\n        '  Result:= nProps;'                                              + sLineBreak +\n        'end;'                                                            + sLineBreak ;\nsTracker4Dec  =       sTrackerProcPrefix+ sTracker4ProcArgs               + sLineBreak;\nsTracker4Proc  =      sTracker4Dec + 'begin'                              + sLineBreak +\n        '  Result:= nProps;'                                              + sLineBreak +\n        '  if (_loaded) and (oVal &lt;&gt; pVal) then'                          + sLineBreak +\n        '  begin '                                                        + sLineBreak +\n        '    Result := TrackChange(pName, nProps);'                       + sLineBreak +\n        '  end;'                                                          + sLineBreak +\n        'end;'\n\n//Added my own setters:\nsRemoteClassSetterImplPas = 'procedure %0:s.Set%1:s(const A%2:s: %2:s);'  + sLineBreak +\n              'begin'                                                     + sLineBreak +\n              '  F%1:s := A%2:s;'                                         + sLineBreak +\n              'end;'                                                      + sLineBreak;\n\nsRemoteClassSetterImplPas2= 'procedure %0:s.Set%1:s(const A%2:s: %2:s);'  + sLineBreak +\n              'begin'                                                     + sLineBreak +\n              '  F%1:s := A%2:s;'                                         + sLineBreak +\n              '  F%1:s_Specified := True;'                                + sLineBreak +\n              'end;'                                                      + sLineBreak;\n\nsRemoteClassSetterImplPas3 = 'procedure %0:s.Set%1:s(const A%2:s: %2:s);' + sLineBreak +\n              'begin'                                                     + sLineBreak +\n              '  ChangedProperties:= TrackChange(''%1:s'', A%2:s, F%1:s, self.IsLoaded, ChangedProperties);' + sLineBreak +\n              '  F%1:s := A%2:s;'                             + sLineBreak +\n              'end;'                                          + sLineBreak;\n\nsRemoteClassSetterImplPas4 = 'procedure %0:s.Set%1:s(const A%2:s: %2:s);'    + sLineBreak +\n              'begin'                                         + sLineBreak +\n              '  ChangedProperties:= TrackChange(A%2:s, F%1:s, ''%1:s'', self.IsLoaded, ChangedProperties);' + sLineBreak +\n              '  F%1:s := A%2:s;'                             + sLineBreak +\n              'end;'                                          + sLineBreak;\n// And for indexed properties\nsRemoteClassSetterImplPasIdx2=\n              'procedure %0:s.Set%1:s(Index: Integer; const A%2:s: %2:s);'    + sLineBreak +\n              'begin'                                         + sLineBreak +\n              '  F%1:s := A%2:s;'                             + sLineBreak +\n              '  F%1:s_Specified := True;'                    + sLineBreak +\n              'end;'                                          + sLineBreak;\n\nsRemoteClassSetterImplPasIdx3 =\n              'procedure %0:s.Set%1:s(Index: Integer; const A%2:s: %2:s);'    + sLineBreak +\n              'begin'                                         + sLineBreak +\n              '  ChangedProperties:= TrackChange(''%1:s'', A%2:s, F%1:s, self.IsLoaded, ChangedProperties);' + sLineBreak +\n              '  F%1:s := A%2:s;'                             + sLineBreak +\n              'end;'                                          + sLineBreak;\n\nsRemoteClassSetterImplPasIdx4 =\n              'procedure %0:s.Set%1:s(Index: Integer; const A%2:s: %2:s);'    + sLineBreak +\n              'begin'                                         + sLineBreak +\n              '  ChangedProperties:= TrackChange(A%2:s, F%1:s, ''%1:s'', self.IsLoaded, ChangedProperties);' + sLineBreak +\n              '  F%1:s := A%2:s;'                             + sLineBreak +\n              'end;'                                          + sLineBreak;\n\n// Added these before the SImplDecl constant:\nsIntfFactoryDecl   = '_di_%0:s Get%0:s(bool useWSDL=false, AnsiString addr=\"\", THTTPRIO* HTTPRIO=0);' + sLineBreak + sLineBreak;\nsTrackerProcPrefix =  'function TrackChange';\nsTrackerProcArgs =  '(const pName: string; pVal, oVal: variant; _loaded: boolean; nProps: string): string; overload';\nsTracker2ProcArgs = '(const pName: string; pVal: TDateTime; oVal: txsdateTime; _loaded:boolean; nProps: string): string; overload;';\nsTracker3ProcArgs = '(const pName: string; nProps: string): string; overload;';\nsTracker4ProcArgs = '(pVal, oVal: TByteDynArray; const pName: string; _loaded: boolean; nProps: string): string; overload';\nsIntfTrackDecl   = sTrackerProcPrefix + sTrackerProcArgs+ sLineBreak;\nsIntfTrack2Decl   = sTrackerProcPrefix + sTracker2ProcArgs+ sLineBreak;\nsIntfTrack3Decl   = sTrackerProcPrefix + sTracker3ProcArgs+ sLineBreak;\nsIntfTrack4Decl   = sTrackerProcPrefix + sTracker4ProcArgs+ sLineBreak;\n\n// Then in WSDLPasWriter I added my new constant arrays:\n\nSetterImpl2:array[Boolean] of string = (sRemoteClassSetterImplPas2, sRemoteClassSetterImplPasIdx2);\nSetterImpl3:array[Boolean] of string = (sRemoteClassSetterImplPas3, sRemoteClassSetterImplPasIdx3);\nSetterImpl4:array[Boolean] of string = (sRemoteClassSetterImplPas4, sRemoteClassSetterImplPasIdx4);\n\n// then modified the setter section in 'WriteComplexTypeClass'\n{ Setter }\nif UseSetGets or GenSpecifiedSupport(Member) then\nbegin\nif GenSpecifiedSupport(Member) then\nbegin\n  WriteFmt(SetterImpl2[HasIndexDecl(Member)],[WSDLType.LangName,\n                                        Member.LangName,\n                                        Member.DataType.LangName])\nend\nelse\nbegin\n  if (ContainsStr(BaseName, 'Dto')) and (not ContainsStr(Member.DataType.LangName, 'XS'))\n  and (not ContainsStr(Member.DataType.LangName, 'ArrayOf')) then\n    if (ContainsStr(Member.DataType.LangName, 'TByteDynArray')) then\n      WriteFmt(SetterImpl4[HasIndexDecl(Member)],[WSDLType.LangName,\n                                              Member.LangName,\n                                              Member.DataType.LangName])\n    else\n      WriteFmt(SetterImpl3[HasIndexDecl(Member)],[WSDLType.LangName,\n                                              Member.LangName,\n                                              Member.DataType.LangName])\n\n  else\n    WriteFmt(SetterImpl1[HasIndexDecl(Member)],[WSDLType.LangName,\n                                            Member.LangName,\n                                            Member.DataType.LangName]);\n\nend;\n\n// at WriteInterfaceEnd I added\n\nWriteFmt(sIntfTrackDecl, []);\nWriteFmt(sIntfTrack2Decl, []);\nWriteFmt(sIntfTrack3Decl, []);\nWriteFmt(sIntfTrack4Decl, []);\n\n// at WriteInterfaceBegin I added\nWriteLn(sTrackerProc, []);\nWriteLn(sTracker2Proc, []);\nWriteLn(sTracker3Proc, []);\nWriteLn(sTracker4Proc, []);\n// finally I changed the wsdlImp dpr and replaced 'AnsiString' (or 'widestring' I can't remember) with 'string' \n</code></pre>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":120,"score":3,"question_id":12711204,"title":"Get file name of file used to open the associated application","body":"<p>I want to write a small app that does some data manipulation on the contents of a simple text file.</p>\n\n<p>I just want to be able to right click such a file, choose 'Open with' in Windows, select my app, then the app opens, parses the file, does some stuff and closes immediately again.</p>\n\n<p>Question: when my app starts, how do I get the file name that triggered the app to start?</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":162,"score":1,"question_id":12707624,"title":"Rounded Rectangle In Delphi","body":"<p>i have been trying to draw a rounded rectangle with spacing in the border, but i cant seem to find a way to do this using the Canvas.RoundRect function, and i am not that good in maths to draw the edges myself, i can draw a rectangle with spacing using the Canvas.MoveTo and Canvas.LineTo functions, but i dont know how to make the edges rounded. Currently what i am doing is i make yellow rectangle at the place where i want to make the spacing in the border but the problem is when i am printing i have to directly draw on printer canvas and i have to draw on a transparent sheet, so a background color will cause problems. Anyone who can help me build a custom drawing routine or tell me how can i erase that area and still print on a transparent paper without any background color. The yellow background color is just for a preview, when i am drawing to a printer canvas the background is transparent.</p>\n\n<p>See the image to know what i mean by spacing in the border line.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Uy2Q1.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks</p>\n"},{"tags":["c#","delphi","pinvoke"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":311,"score":4,"question_id":10584690,"title":"Using Delphi's stuct arrays and strings in C#","body":"<p>I've been trying to invoke a method that have been created in Delphi in the following way:  </p>\n\n<pre><code> function _Func1(arrParams: array of TParams): Integer;stdcall;    \n\n type \n   TParams = record\n   Type: int;\n   Name: string;\n   Amount : Real;\n end;\n</code></pre>\n\n<p>My code is:</p>\n\n<pre><code>[DllImport(\"some.dll\", EntryPoint = \"_Func1\", CallingConvention = CallingConvention.StdCall)]\npublic static extern int Func(\n  [MarshalAs(UnmanagedType.LPArray, ArraySubType=UnmanagedType.Struct)] TParams[] arrParams)\n</code></pre>\n\n<p>And the struct is:</p>\n\n<pre><code>[StructLayoutAttribute(LayoutKind.Sequential, CharSet = CharSet.Ansi)]\npublic struct TParams\n{\n  public int Type;\n  [MarshalAs(UnmanagedType.AnsiBStr)]\n  public string Name;\n  public double Amount;\n}\n</code></pre>\n\n<p>When I am calling this method I'm getting the error:\nCannot marshal field 'Name' of type 'TParams': Invalid managed/unmanaged type combination (String fields must be paired with LPStr, LPWStr, BStr or ByValTStr).</p>\n\n<p>However none of those combinations works, as Delphi's strings are prefixed with its length and it is Ansi for sure (I've tried it  with other string parameters). Does anyone have a clue how to solve this?</p>\n"},{"tags":["delphi","ms-word","bitmap","rtf","delphi-2007"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":611,"score":4,"question_id":3092876,"title":"Image not displaying in ms word after converting it from Bitmap to RTF (but displaying in wordpad)","body":"<p>I am trying to convert a bitmap file to rtf using Delphi 2007.</p>\n\n<p>I used below code for conversion.</p>\n\n<pre><code>function BitmapToRTF(pict: TBitmap): string;\nvar\n  bi, bb, rtf: string;\n  bis, bbs: Cardinal;\n  achar: ShortString;\n  hexpict: string;\n  I: Integer;\nbegin\n  GetDIBSizes(pict.Handle, bis, bbs);\n  SetLength(bi, bis);\n  SetLength(bb, bbs);\n  GetDIB(pict.Handle, pict.Palette, PChar(bi)^, PChar(bb)^);\n  rtf := '{\\rtf1 {\\pict\\dibitmap0 ';\n  SetLength(hexpict, (Length(bb) + Length(bi)) * 2);\n  I := 2;\n  for bis := 1 to Length(bi) do\n  begin\n    achar := Format('%x', [Integer(bi[bis])]);\n    if Length(achar) = 1 then\n      achar := '0' + achar;\n    hexpict[I - 1] := achar[1];\n    hexpict[I] := achar[2];\n    Inc(I, 2);\n  end;\n  for bbs := 1 to Length(bb) do\n  begin\n    achar := Format('%x', [Integer(bb[bbs])]);\n    if Length(achar) = 1 then\n      achar := '0' + achar;\n    hexpict[I - 1] := achar[1];\n    hexpict[I] := achar[2];\n    Inc(I, 2);\n  end;\n  rtf := rtf + hexpict + ' }}';\n  Result := rtf;\nend;\n</code></pre>\n\n<p>Now my problem is <strong>i was not able to view the image in MS Word or Viewer.</strong></p>\n\n<p>But <strong>i can view the image in word pad.</strong></p>\n\n<p>Please suggest me in solving this problem.</p>\n"},{"tags":["delphi","rest","uri","delphi-xe2","datasnap"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":342,"score":2,"question_id":8229932,"title":"REST Datasnap override URI mapping","body":"<p>I wrote a small REST server with the REST datasnap in delphi XE2.\nThere is a default mapping between HTTP methods (POST, PUT etc.) and the functions defined in delphi, this is done by a delphi component.</p>\n\n<p><a href=\"http://docwiki.embarcadero.com/RADStudio/en/REST#URI_Mapping\" rel=\"nofollow\">This wiki entry</a> describes the URI mapping but also notes that the default mapping can be override by the programmer.</p>\n\n<blockquote>\n  <p>The mapping pattern can be overridden. The user can override the mapping for each type based on class name and method name parameters.</p>\n</blockquote>\n\n<p>But I didn't find any explanation how to override the mapping.</p>\n\n<p>How can I change the default mapping?</p>\n"},{"tags":["mysql","delphi","foreign-keys"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":99,"score":0,"question_id":12691376,"title":"How to delete two linked rows from MySQL database?","body":"<p>Can somebody show my how to delete two linked rows?</p>\n\n<p>I use Delphi 2007 and MySQL.</p>\n\n<p>I have a database with two tables:</p>\n\n<pre><code>CREATE TABLE `Picture`.`Picture` (\n  `ID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,\n  `IMG` LONGBLOB,\n  PRIMARY KEY (`ID`)\n)\nENGINE = InnoDB;\n\nCREATE TABLE `contacts` (\n  `ID` int(10) unsigned NOT NULL auto_increment,\n  `FirstName` varchar(45) NOT NULL,\n  `LastName` varchar(45) NOT NULL,\n  `Phone` varchar(45) default NULL,\n  `PICID` int(10) unsigned default NULL,\n  PRIMARY KEY  (`ID`),\n  KEY `FK_contacts_1` (`PICID`),\n  CONSTRAINT `FK_contacts_1` FOREIGN KEY (`PICID`) REFERENCES `picture` (`ID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1; \n</code></pre>\n\n<p>In my Delphi Application I have <kbd>Delete</kbd> button. When I find some contact on my DBGrid and press <kbd>Delete</kbd> button I can delete only contact from table <code>contacts</code>, I also want to delete contact picture.</p>\n\n<p>I want to delete row from table <code>contacts</code> and row from table <code>Picture</code>. Table <code>Picture</code> is linked to table <code>contacts</code> with <code>foreign key</code>.</p>\n"},{"tags":["delphi","delphi-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":154,"score":-2,"question_id":8591907,"title":"Delphi 2010 How to do something on form startup without requiring the user to take some action ( Button click, etc..)","body":"<p>How to do something on form startup like :</p>\n\n<pre><code>  RichEdit1.Lines.Add('sorry email@exemple.com is already in our database');\n</code></pre>\n\n<p>NOT untill the user take some action ( Button click, etc..)</p>\n\n<p>I tried with the code below and it works but i am obliged to click on the button one in order to add that line into the richEdit1 compenent.</p>\n"},{"tags":["delphi","build"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12670807,"title":"How to attempt to build all project in a project group even if one fails to compile","body":"<p>We have a Jenkins task that runs overnight and compiles a project group containing all of our projects. Unfortunately this task stops on the first error in a project. This means we don't get the full list of errors in the project group and even though more than one checkin may have contained errors only one checkin will be flagged as a problem.</p>\n\n<p>Is there any way to force the Delphi compiler to continue to build all projects in the project group?</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12702446,"title":"How do I use flags included in a DLL?","body":"<p>The function I am using contains three parameters where one of which requires a flag (fCreationDisposition):</p>\n\n<blockquote>\n  <p><code>function MpqOpenArchiveForUpdate(lpFileName: LPCSTR; fCreationDisposition, dwHashTableSize: DWord): THandle; stdcall; external 'lmpqapi.dll';</code></p>\n</blockquote>\n\n<p>The <a href=\"http://sfsrealm.hopto.org/inside_mopaq/chapter4.htm\" rel=\"nofollow\">documentation</a> states that there are five usable flags. However, when I use any of the flags Delphi tells me that it is an \"undeclared identifier\". </p>\n\n<p>Is there anything extra that I must add in order to be able to access the flags without Delphi telling me that it is an \"undeclared identifier\"? </p>\n\n<p>Note: Under the <code>uses</code> section I have called for the function:</p>\n\n<blockquote>\n  <p><code>function MpqOpenArchiveForUpdate(lpFileName: LPCSTR; fCreationDisposition, dwHashTableSize: DWord): THandle; stdcall; external 'lmpqapi.dll';</code></p>\n</blockquote>\n"},{"tags":["delphi","gui","pascal"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":127,"score":1,"question_id":12406529,"title":"Delphi sprites (knob)","body":"<p>I'm currently designing a GUI that should contain a knob. </p>\n\n<p>The png file is kind of like a \"motion-picture\"-stacked (in lack of better words).</p>\n\n<p>Let's assume the image is 32 in length,, and each knob is 32 in height: I need the code \nto go down 32 per turn. So at default the Timage is showing 32x32 of the image, but when the knob is turned up (By mouseclick and moving the mouse upwards) it shows 32x64 of the png and so on. </p>\n\n<p>How would i proceed to do this ? I know I could render each image individually, and then change image one by one, but that seems like a bad way. </p>\n"},{"tags":["delphi","generics","delphi-xe","type-inference"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":123,"score":7,"question_id":12693755,"title":"type inference based on generic argument type (Delphi)","body":"<p>I'm trying to write a generic function that accepts matching parameter types.<br>\nDelphi does infer the type parameter correctly in the simple case of plain arguments.</p>\n\n<p>eg:</p>\n\n<pre><code>type\n  TFoo = class\n    function Pair&lt;T&gt;(e1, e2: T): TList&lt;T&gt;;\n  end;\n</code></pre>\n\n<p>calling this with <code>aFoo.Pair(1, 2);</code> works perfectly fine, but when I change the parameter signature to a generic type</p>\n\n<pre><code>type\n  TFoo = class\n    function InsertInto&lt;T&gt;(aList: TList&lt;T&gt;; aVal: T): TList&lt;T&gt;;\n  end;\n</code></pre>\n\n<p>and try to call it<br>\n<code>aFoo.InsertInto(TList&lt;String&gt;.Create, 'bar');</code></p>\n\n<p>then the compiler complains about it:<br>\n<code>E2010 Incompatible types: 'Generics.Collections.TList&lt;uTest.TFoo.InsertInto.T&gt;' and 'Generics.Collections.TList&lt;System.String&gt;'</code></p>\n\n<p>Is there any way I can write this (or a similar) method, so that the client doesnt have to specity the type parameter?<br>\n<code>aFoo.InsertInto&lt;String&gt;(TList&lt;String&gt;.Create, 'bar');</code></p>\n"},{"tags":["delphi","canvas","alphablending","ownerdraw"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":12700165,"title":"Why does AlphaBlend always return false (drawing on canvas)?","body":"<p>I am trying to blend two canvases together using the windows alphablend API call. First I draw some thing on the main canvas (destination), then instantiate another canvas using TBitmap, draw onto that, and then blend the two together (following an answer here on SO).</p>\n\n<p>However, I am finding that it always returns false, at first I thought it had something to do with passing the wrong handles for source and destination, but I cannot figure it out. what could it be?</p>\n\n<pre><code>unit MainWnd;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, ExtCtrls, ControlsEx;\n\ntype\n{------------------------------------------------------------------------------}\n  TfrmMain = class(TForm)\n    PaintBox1: TPaintBox;\n    procedure PaintBox1Paint(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  frmMain: TfrmMain;\n\nimplementation\n\n{$R *.dfm}\n\n{..............................................................................}\nprocedure alphaBlendf(\n        const in_target       : TCanvas;\n        const in_transperancy : integer;\n        const in_color        : TColor;\n        const in_rect         : TRect;\n        const in_width        : integer;\n        const in_height       : integer);\nvar\n  w          : integer;\n  h          : integer;\n  bitmap     : TBitmap;\n  blendFn    : BLENDFUNCTION;\n  ret        : boolean;\nbegin\n  blendFn.BlendOp             := AC_SRC_OVER;\n  blendFn.SourceConstantAlpha := 80;\n\n try\n   w := in_rect.Right - in_rect.Left - 1;\n   h := in_rect.Bottom - in_rect.Top - 1;\n\n   bitmap                    := TBitmap.Create;\n   bitmap.PixelFormat        := pf32bit;\n   bitmap.Width              := w;\n   bitmap.Height             := h;\n   bitmap.Canvas.Brush.Color := in_color;\n\n   bitmap.Canvas.Rectangle(in_rect);\n\n   ret := Windows.AlphaBlend(\n        in_target.Handle,\n        0,\n        0,\n        in_width,\n        in_height,\n        bitmap.Canvas.Handle,\n        0,\n        0,\n        in_width,\n        in_height,\n        blendFn);\n\n   if ret then in_target.TextOut(0, 0, 'ok')\n          else in_target.TextOut(0, 0, 'fail');\n  finally\n   bitmap.Free;\n  end;\nend;\n\n{..............................................................................}\nprocedure TfrmMain.PaintBox1Paint(Sender: TObject);\nvar\n  r: TRect;\nbegin\n  PaintBox1.Canvas.Brush.Color := $FCFFB5;\n  PaintBox1.Canvas.FillRect(r);\n\n  r := Rect(0, 0, 100, 100);\n  alphaBlendf(PaintBox1.Canvas, 0, clLime, r, PaintBox1.ClientWidth, PaintBox1.ClientHeight);\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12699776,"title":"\"Handle\" Data Type Equivalent","body":"<p>I am reading the documentation for <a href=\"http://sfsrealm.hopto.org/inside_mopaq/chapter4.htm\" rel=\"nofollow\">MoPaQ</a> and trying to convert the functions over to Delphi because some of the data types mentioned in the documentation do not directly match the ones in Delphi.</p>\n\n<p>This is the function I am having troubles with:</p>\n\n<blockquote>\n  <p><code>HANDLE WINAPI MpqOpenArchiveForUpdate(LPCSTR lpFileName, DWORD dwCreationDisposition, DWORD dwHashTableSize);</code></p>\n</blockquote>\n\n<p>In Delphi, I have converted it as:</p>\n\n<blockquote>\n  <p><code>function MpqOpenArchiveForUpdate(lpFileName: Char, CreationDisposition, dwHashTableSize: LongWord); external 'lmpqapi.dll';</code></p>\n</blockquote>\n\n<p>For one, I am missing the return type for my function which I believe is <code>HANDLE</code> (according to the documentation). If that is the case, what is the Delphi equivalent for the <code>HANDLE</code> data type?</p>\n\n<p>Thank you in advanced!</p>\n"},{"tags":["delphi","file","version","check"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":102,"score":1,"question_id":12699744,"title":"Check file version of and .exe file (Server Side) and if newer download","body":"<p>I want to point to a <a href=\"http://somesite.com/somefile.exe\" rel=\"nofollow\">http://somesite.com/somefile.exe</a> and check the file version of the exe server side and compare the version info  to the same .exe file all ready on my computer. If the server side file is newer then I want to down load it.</p>\n\n<p>I have functions to download the file and check the file version but I want to check if the file version is newer than the one i have on my computer.</p>\n\n<p>I do not want to download the exe to my computer and then check the file version.</p>\n\n<p>Has anyone here been able to do this.</p>\n\n<p>Thanks for your help.</p>\n\n<pre><code>function GetVersion(sFileName:string): string;\nvar\n VerInfoSize: DWORD;\n VerInfo: Pointer;\n  VerValueSize: DWORD;\n  VerValue: PVSFixedFileInfo;\n Dummy: DWORD;\nbegin\nVerInfoSize := GetFileVersionInfoSize(PChar(sFileName), Dummy);\nGetMem(VerInfo, VerInfoSize);\nGetFileVersionInfo(PChar(sFileName), 0, VerInfoSize, VerInfo);\nVerQueryValue(VerInfo, '\\', Pointer(VerValue), VerValueSize);\n with VerValue^ do\nbegin\n Result := IntToStr(dwFileVersionMS shr 16);\n Result := Result + '.' + IntToStr(dwFileVersionMS and $FFFF);\n Result := Result + '.' + IntToStr(dwFileVersionLS shr 16);\n Result := Result + '.' + IntToStr(dwFileVersionLS and $FFFF);\nend;\n FreeMem(VerInfo, VerInfoSize);\nend;\n\nprocedure TForm1.Button1Click(Sender: TObject);\n var\n Http: TIdHTTP;\n MS: TMemoryStream;\nbegin\n Http := TIdHTTP.Create(nil);\n  try\n   MS := TMemoryStream.Create;\n  try\n   Http.OnWork:= HttpWork;\n\n  Http.Get('http://live.sysinternals.com/ADExplorer.exe', MS);\n  MS.SaveToFile('C:\\ADExplorer.exe');\n\n finally\n   MS.Free;\n end;\nfinally\nHttp.Free;\n end;\n\nend;\n</code></pre>\n"},{"tags":["delphi","stream","sql-server-2008-r2","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":211,"score":2,"question_id":12225450,"title":"TSQLQuery only streams first 1MB of data correctly for large strings","body":"<p>(see Edit #1 with stack trace and Edit #2 with workaround at end of post)</p>\n\n<p>While troubleshooting <a href=\"http://stackoverflow.com/questions/12210174/tsqlquery-fieldbyname-asstring-tstringstream-corrupts-data\">TSQLQuery.FieldByName().AsString -&gt; TStringStream Corrupts Data</a>, I found that a <code>TSQLQuery.FieldByName().AsBytes</code> will only stream exactly 1MB of <code>varchar(max)</code> data correctly.</p>\n\n<ul>\n<li>Using WireShark, I verified that the data is <em>all</em> being handed to the Delphi app <em>correctly</em>.</li>\n<li>I verified that it <em>always</em> writes out the correct number of bytes to the output file, but any bytes that exceed <strong>exactly 1MB</strong> are null bytes.</li>\n<li>Additionally, <code>TSQLQuery.FieldByName().AsString</code> and <code>.AsWideString</code> also exhibit the same behavior.</li>\n</ul>\n\n<p>What would cause <code>.AsBytes</code> to supply the correct number of bytes to the <code>TFileStream</code>, but <code>null</code> all bytes that exceed 1MB?</p>\n\n<h2>Test Case</h2>\n\n<p>This test case creates two output files.  <code>Plus14.txt</code> is 1MB + 14 bytes.  <code>Plus36.txt</code> is 1MB + 36 bytes.  In both cases, the bytes more than 1MB are <code>null</code> byte values.  I even tried a 16MB string.  The first 1MB of the output file was correct; the next 15MB were all <code>null</code> bytes.</p>\n\n<h2>SQL Server</h2>\n\n<pre><code>use tempdb\ngo\ncreate procedure RunMe\nas\n  declare @s1 varchar(max), @s2 varchar(max)\n\n  set @s1 = '0123456789ABCDEF'\n  set @s2 = @s1 + @s1 + @s1 + @s1 + @s1 + @s1 + @s1 + @s1 -- 128 bytes\n  set @s1 = @s2 + @s2 + @s2 + @s2 + @s2 + @s2 + @s2 + @s2 -- 1,024 bytes\n  set @s2 = @s1 + @s1 + @s1 + @s1 + @s1 + @s1 + @s1 + @s1 -- 8,192 bytes\n  set @s1 = @s2 + @s2 + @s2 + @s2 + @s2 + @s2 + @s2 + @s2 -- 65,536 bytes\n  set @s2 = @s1 + @s1 + @s1 + @s1 + @s1 + @s1 + @s1 + @s1 -- 524,288 bytes\n  set @s1 = @s2 + @s2                                     -- 1,048,576 bytes\n\n  set @s2 = @s1 + 'this is a test'                        -- 1MB + 14 bytes\n  set @s1 = @s1 + 'of the emergency broadcasting system'  -- 1MB + 36 bytes\n\n  select @s2 as Plus14, @s1 as Plus36\ngo\ngrant execute on RunMe to public\ngo\n</code></pre>\n\n<h2>Delphi DFM</h2>\n\n<p>Default form, with this <code>TSQLConnection</code> dropped on it (and one <code>TButton</code>):</p>\n\n<pre><code>object SQLConnection1: TSQLConnection\n  DriverName = 'MSSQL'\n  GetDriverFunc = 'getSQLDriverMSSQL'\n  LibraryName = 'dbxmss.dll'\n  LoginPrompt = False\n  Params.Strings = (\n    'User_Name=user'\n    'Password=password'\n    'SchemaOverride=%.dbo'\n    'DriverUnit=Data.DBXMSSQL'\n\n      'DriverPackageLoader=TDBXDynalinkDriverLoader,DBXCommonDriver160.' +\n      'bpl'\n\n      'DriverAssemblyLoader=Borland.Data.TDBXDynalinkDriverLoader,Borla' +\n      'nd.Data.DbxCommonDriver,Version=16.0.0.0,Culture=neutral,PublicK' +\n      'eyToken=91d62ebb5b0d1b1b'\n\n      'MetaDataPackageLoader=TDBXMsSqlMetaDataCommandFactory,DbxMSSQLDr' +\n      'iver160.bpl'\n\n      'MetaDataAssemblyLoader=Borland.Data.TDBXMsSqlMetaDataCommandFact' +\n      'ory,Borland.Data.DbxMSSQLDriver,Version=16.0.0.0,Culture=neutral' +\n      ',PublicKeyToken=91d62ebb5b0d1b1b'\n    'GetDriverFunc=getSQLDriverMSSQL'\n    'LibraryName=dbxmss.dll'\n    'VendorLib=sqlncli10.dll'\n    'VendorLibWin64=sqlncli10.dll'\n    'HostName=localhost'\n    'Database=tempdb'\n    'MaxBlobSize=-1'\n    'LocaleCode=0000'\n    'IsolationLevel=ReadCommitted'\n    'OSAuthentication=False'\n    'PrepareSQL=True'\n    'BlobSize=-1'\n    'ErrorResourceFile='\n    'OS Authentication=True'\n    'Prepare SQL=False')\n  VendorLib = 'sqlncli10.dll'\n  Left = 8\n  Top = 8\nend\n</code></pre>\n\n<h2>Delphi PAS</h2>\n\n<p>The code for the <code>TButton.OnClick</code>:</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar qry: TSQLQuery;\n\n  procedure save(str: string);\n  var data: TBytes; fs: TFileStream;\n  begin\n    fs := TFileStream.Create(Format('c:\\%s.txt', [str]), fmCreate);\n    try\n      data := qry.FieldByName(str).AsBytes;\n      if data &lt;&gt; nil then\n        fs.WriteBuffer(data[0], Length(data));\n    finally\n      FreeAndNil(fs);\n    end;\n  end;\n\nbegin\n  SQLConnection1.Open;\n  qry := TSQLQuery.Create(nil);\n  try\n    qry.MaxBlobSize := -1;\n    qry.SQLConnection := SQLConnection1;\n    qry.SQL.Text := 'set nocount on; exec RunMe';\n    qry.Open;\n    save('Plus14');\n    save('Plus36');\n  finally\n    FreeAndNil(qry);\n  end;\n  SQLConnection1.Close;\nend;\n</code></pre>\n\n<h2>&lt;&lt;&lt; Edit #1 - Stack Trace >>></h2>\n\n<p>I traced through Embarcadero's code and found the place where the <code>null</code> bytes first appear.</p>\n\n<ul>\n<li><code>FMethodTable.FDBXRow_GetBytes</code></li>\n<li><code>Data.DBXDynalink.TDBXDynalinkByteReader.GetBytes(0,0,(...),0,1048590,True)</code></li>\n<li><code>Data.SqlExpr.TCustomSQLDataSet.GetFieldData(1,$7EC80018)</code></li>\n<li><code>Data.SqlExpr.TCustomSQLDataSet.GetFieldData(???,$7EC80018)</code></li>\n<li><code>Data.DB.TDataSet.GetFieldData($66DB18,$7EC80018,True)</code></li>\n<li><code>Data.SqlExpr.TSQLBlobStream.ReadBlobData</code></li>\n<li><code>Data.SqlExpr.TSQLBlobStream.Read((no value),1048590)</code></li>\n<li><code>System.Classes.TStream.ReadBuffer((no value),1048590)</code> <em>1MB + 14b</em></li>\n<li><code>Data.DB.TBlobField.GetAsBytes</code></li>\n<li><code>Unit1.save('Plus14')</code></li>\n</ul>\n\n<p>When <code>FDBXRow_GetBytes</code> returns, <code>Value: TBytes</code> is 1048590 bytes, with <code>null</code> values set for the last 14 bytes.</p>\n\n<p>I'm not sure what to try next.  Any help is greatly appreciated.</p>\n\n<h2>&lt;&lt;&lt; Edit #2 - Workaround >>></h2>\n\n<p>I set <code>SQLConnection1.MaxBlobSize := 2097152</code>, and now all bytes are stream to the output files correctly.  So the problem only seems to occur when <code>.MaxBlobSize = -1</code>.</p>\n\n<p>The urgency to fix the issue is gone now that I found a workaround.  However, I would still like to get <code>-1</code> to work if possible since the values from my database will sometimes exceed 50 megs.  So any suggestions or help is still appreciated.</p>\n\n<h2>&lt;&lt;&lt; Edit #3 - Bug Report >>></h2>\n\n<p>I filed a bug report with Embarcadero (QC #108475).  I will report back once the bug has been acknowledged / fixed.</p>\n\n<h2>&lt;&lt;&lt; Edit #4 - Escalated Bug Report >>></h2>\n\n<p>I found today that using this workaround will sometimes causes a <code>TClientDataSet</code> to throw an <code>EOleException</code> with the text '<strong>Catastrophic Failure</strong>'.  Apparently a <code>TClientDataSet</code> prefers a <code>MaxBlobSize := '-1';</code>.  Consequently, I escalated the bug report at Embarcadero.  Hopefully they will provide a fix or a better workaround for this soon.</p>\n"},{"tags":["delphi","api","pascal","translate"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":1,"view_count":467,"score":5,"question_id":7476375,"title":"Translating Languages In Delphi","body":"<p>I have been looking for ages now for some code that can translate any language to another but none of the code I find works.<br>\nI know Google has a good translate API but I can't get anyone's Delphi code on it to work.<br>\nThere is always an error that comes in the way.\nAny help would be much appreciated, I need a program that can translate ASAP of my final school project.  </p>\n"},{"tags":["delphi","blocking","mht","imessage"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":104,"score":4,"question_id":12690331,"title":"Create *. Mht-file (Web Archive)","body":"<p>Use the following representation of the function to generate a Web archive from a local html file</p>\n\n<pre><code>function TLessonConstructor2.CreateMHT( const FileName : string):boolean ;\n var\n  oMSG:IMessage;\n  oConfig: IConfiguration;\n  sFileName: string;\n  Stream: _Stream;\nbegin\n  //CoInitializeEx(nil, COINIT_APARTMENTTHREADED);\n  //CoInitialize(nil);\n  try\n    Result  := false;\n    sFileName := ChangeFileExt(FileName, '.mht');\n    DeleteFile(PAnsiChar(sFileName));\n    try\n    oConfig := CoConfiguration.Create();\n    oMSG    := CoMessage.Create();\n    oMSG.Configuration := oConfig;\n    oMSG.CreateMHTMLBody(FileName,CdoSuppressNone,'','');\n    Stream:=oMSG.GetStream;\n    Stream.SaveToFile(sFileName,adSaveCreateOverWrite);\n    Stream.Cancel;\n    Stream.Close;\n    Result := True;\n    except\n      on E: Exception do\n      begin\n       Result  := false;\n       MessageDlg(E.Message, mtError, [mbOK], 0);\n      end;\n    end;\n  finally\n  //  CoUnInitialize;\n    Stream:=nil;\n    oConfig:=nil;\n    oMSG:=nil;\n  end;\nend;\n</code></pre>\n\n<p><strong>FileName</strong> - full path to the html.</p>\n\n<p>After performing <strong>oMSG.CreateMHTMLBody (FileName, CdoSuppressNone,'','')</strong>; This file is locked for as long as the basic process is completed. However, this file should be removed after processing.</p>\n\n<p>Any idea what the problem is?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":127,"score":10,"question_id":12696469,"title":"How can I make a tree view re-think whether or not a horizontal scroll bar is needed?","body":"<p>Consider the following very simple unit:</p>\n\n<p><strong>Unit1.pas</strong></p>\n\n<pre><code>unit Unit1;\n\ninterface\n\nuses\n  Windows, Classes, Controls, Forms, ComCtrls;\n\ntype\n  TForm1 = class(TForm)\n    TreeView1: TTreeView;\n    procedure FormCreate(Sender: TObject);\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n\n{$R *.dfm}\n\nconst\n  SLongString = 'blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah';\n\nprocedure TForm1.FormCreate(Sender: TObject);\nvar\n  Node: TTreeNode;\nbegin\n  TreeView1.Width := 200;\n  Node := TreeView1.Items.Add(nil, SLongString);\n  Node.Text := 'blah';\nend;\n\nend.\n</code></pre>\n\n<p><strong>Unit1.dfm</strong></p>\n\n<pre><code>object Form1: TForm1\n  ClientHeight = 137\n  ClientWidth = 216\n  OnCreate = FormCreate\n  PixelsPerInch = 96\n  TextHeight = 13\n  object TreeView1: TTreeView\n    Left = 8\n    Top = 8\n    Width = 198\n    Height = 121\n  end\nend\n</code></pre>\n\n<p>Add this to a VCL Forms app and run. The result looks like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/UCaCh.png\" alt=\"enter image description here\"></p>\n\n<p>I would like for the horizontal scroll bar not to be showing.  How can I achieve this?</p>\n\n<p>Now I realise that I could remove the line of code that assigns the very long string. But this is a cut-down program for the purpose of my question. In <a href=\"http://stackoverflow.com/questions/12693995/how-do-i-measure-the-width-available-for-text-in-a-tree-view-item\">the real app the text of the nodes is changing</a> and I want the scroll bars to show if they are needed, and not show if they are not needed.</p>\n\n<p>I know about the <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/bb760013.aspx\"><code>TVS_NOHSCROLL</code></a> style but I can't use that. Sometimes the tree view contains text that is wider than the available space. And sometimes not.</p>\n\n<p>I also want to use <code>TTreeView</code> and do not want to use virtual tree view. Not that I have anything against virtual tree view, just that my app is currently using <code>TTreeView</code>.</p>\n"},{"tags":["osx","delphi","firemonkey"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12668685,"title":"Filesetattr is not available with XE3 (Firemonkey)","body":"<p>I want create a hidden ini file under macosX environment with Firemonkey (XE3).\nBut unfortunaly this command is not known anymore in system.utilys</p>\n\n<p>Somebody tips?</p>\n"},{"tags":["delphi","tlist","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":109,"score":1,"question_id":12683328,"title":"How can read grouped data from a TList<> in Delphi","body":"<p>In C# Linq would make this super-easy but I am new to using Lists in Delphi and I need some advice.</p>\n\n<p>I have a list of objects stored as <code>TList&lt;IMyInterface&gt;</code> with each object essentially being a collection of data, e.g.</p>\n\n<pre><code>1, 1, 2, 2, 2, 2, 3, 4, 4, 4 \n</code></pre>\n\n<p>I wish to create a new <code>TList&lt;TList&lt;IMyInterface&gt;&gt;</code> where the items in the list are grouped such as:</p>\n\n<pre><code>1, 1 \n2, 2, 2, 2, 2 \n3 \n4, 4, 4 \n</code></pre>\n\n<p>What would be the most effective way of doing this in Delphi XE3 (starter edition)?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12692745,"title":"How do I free a form that's owned by something else?","body":"<p>I have a form dynamically created that needs to be destroyed:</p>\n\n<ul>\n<li>later (at application shutdown) IF <code>AssignData</code> succeeds, or</li>\n<li>immediately in case <code>AssignData</code> crashes.</li>\n</ul>\n\n<p>Since the form is owned by the application, it is not safe to just call <code>FreeAndNil</code> on it. But <code>Close</code> also won't work; it won't close the window.</p>\n\n<pre><code>FrmLoader:= TFrmLoader.Create(Application);  &lt;----- Application is the Owner                            \nTRY\n  FrmLoader.AssignData(FileData);                                      \nEXCEPT                                                              \n  FreeAndNil(FrmLoader);  // &lt;------ unsafe                                            \n  FrmLoader.Close;        // &lt;------ this is the safe method to close it but won't work\n  RAISE;       \nEND;\nFrmLoader.DoStuff;\n</code></pre>\n"},{"tags":["json","delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":110,"score":1,"question_id":12684057,"title":"Delphi / SuperObject - Accessing Subnodes","body":"<p>I have the following JSON from my server:</p>\n\n<pre><code>{\n   \"userid\":\"12\",\n   \"username\":\"TestChar\",\n   \"logged\":\"yes\",\n   \"status\":\"Premium User\",\n   \"areas\":{\n      \"SERVICEAREA_XX1\":{\n         \"id\":\"1\",\n         \"area\":\"SERVICEAREA_XX1\",\n         \"version\":\"3000\",\n         \"usr_group\":\"0\"\n      },\n      \"SERVICEAREA_XX2\":{\n         \"id\":\"2\",\n         \"area\":\"SERVICEAREA_XX2\",\n         \"version\":\"31000\",\n         \"usr_group\":\"0\"\n      },\n      \"SERVICEAREA_XX3\":{\n         \"id\":\"3\",\n         \"area\":\"SERVICEAREA_XX3\",\n         \"version\":\"2000\",\n         \"usr_group\":\"1\"\n      }\n   }\n}\n</code></pre>\n\n<p>With SuperObjects i can get the count of \"SERVICEAREA\"'s with</p>\n\n<pre><code>ob['areas'].AsObject.count\n</code></pre>\n\n<p>How can i now get access to the elements of the different \"SERVICEAREA\"'s?</p>\n\n<p>Thanks for your help...</p>\n"},{"tags":["xml","delphi","pascal"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":153,"score":3,"question_id":12678848,"title":"Access Part of an XML Document in Delphi","body":"<p>i have used the delphi data binding wizard with my xml file, and everything compiles and runs fine. </p>\n\n<p>I have 3 comboboxes on my form. Manufacturer, Model and Year. </p>\n\n<p>Manufacturer is populated using the following code on FormCreate.</p>\n\n<pre><code>procedure TfrmMain.FormCreate(Sender: TObject);\nvar\n  RGearing : IXMLracegearingType;\n  i : Integer;\nbegin\n  // Load XML Document into Memory\n  RGearing := Getracegearing(XMLDocument1);\n\n  // Populate Manufacturer combobox\n  for i := 0 to RGearing.Car.Count-1 do\n  begin\n    cbManufac.Items.Add(RGearing.Car[i].Manufacturer);\n  end;\n\n  // Copy current selected Manufacturer to string variable\n  varManufac := cbManufac.ListItems[(cbManufac.ItemIndex)].Text;\nend;\n</code></pre>\n\n<p>My question is how can i populate the Model combobox based on the current manufacturer that is selected.</p>\n\n<p>Here is the XML File that goes with it</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;gearing&gt;\n  &lt;car&gt;\n    &lt;id&gt;1&lt;/id&gt;\n    &lt;manufacturer&gt;Ford&lt;/manufacturer&gt;\n    &lt;model&gt;Test 1&lt;/model&gt;\n    &lt;year&gt;&lt;/year&gt;\n  &lt;/car&gt;\n  &lt;car&gt;\n    &lt;id&gt;2&lt;/id&gt;\n    &lt;manufacturer&gt;Ford&lt;/manufacturer&gt;\n    &lt;model&gt;Test 2&lt;/model&gt;\n    &lt;year&gt;&lt;/year&gt;\n  &lt;/car&gt;\n  &lt;car&gt;\n    &lt;id&gt;3&lt;/id&gt;\n    &lt;manufacturer&gt;Honda&lt;/manufacturer&gt;\n    &lt;model&gt;Test 1&lt;/model&gt;\n    &lt;year&gt;&lt;/year&gt;   \n  &lt;/car&gt;\n  &lt;settings&gt;\n    &lt;form_height&gt;&lt;/form_height&gt;\n    &lt;form_width&gt;&lt;/form_width&gt;\n  &lt;/settings&gt;\n&lt;/gearing&gt;\n</code></pre>\n\n<p>So if the manufacturer selected is Ford then the model combobox needs to display Test 1 and Test 2 as the items.</p>\n"},{"tags":["windows","delphi","calendar","windows-vista"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":81,"score":2,"question_id":12692800,"title":"How do I launch Windows Calendar to show a specific day?","body":"<p>I want to launch Windows Calendar viewing a certain day. Is there any way to do this?</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/aa911847.aspx\" rel=\"nofollow\">I already did the same thing with Calendar on Window Mobile</a>, but the same way doesn't work on Windows Vista.</p>\n"},{"tags":["windows","delphi","backup","delphi-7"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":155,"score":0,"question_id":11885634,"title":"Incremental online backup using Delphi","body":"<p>I am trying to implement a new feature in our Delpi project that will help our users to make backups online on our servers, so I've used Indy FTP component to build a form that will upload / download the user files or folders</p>\n\n<p>But I need to offer the ability to do incremental backups. Where our users can only upload ONLY 'new' differences to their files and folders. So for example if I have a text file with size 5 KB, and I've added text to it worth additional 2 KB, then the backup will just upload those extra 2 KB and NOT the whole 7 KB</p>\n\n<p>So can someone please recommend any approach, algorithm to start with?</p>\n\n<p>Thanks for your time </p>\n\n<p>Note: we are using Delphi 7</p>\n"},{"tags":["delphi","gui","sorting","virtualtreeview"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":157,"score":2,"question_id":12687064,"title":"Is it ever preferable to sort GUI elements instead of sorting the data and have the GUI show the sorted data?","body":"<p>A related <a href=\"http://stackoverflow.com/questions/12671022/implementing-tobjectlists-sort-without-copy-paste-code\">question</a> about sorting may be relevant to answering this one. I've realized that VirtualTreeView offers a sorting method of it's own, but it seems to work slower than just sorting through the data itself, and letting the GUI refresh.</p>\n\n<p>Is it ever \"good practice\" to manipulate GUI elements instead of the data that they display, and why?</p>\n"},{"tags":["delphi","serial-port"],"answer_count":4,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":1006,"score":10,"question_id":419653,"title":"Which simple future-proof Delphi serial comms code to use?","body":"<p>I've been a fan of Turbopower Async Pro for years, now taken up on SourceForge and it works very well. However, it's complex and I've never really made use of its features other than the port component. I'm updating my code for D2009 etc and am tempted to move to something simpler since I have my own wrapper around it. There are lots of port components out there but are there any recommendations here? Thanks.</p>\n"},{"tags":["delphi","delphi-xe2","delphi-2010","delphi-xe3"],"answer_count":2,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":220,"score":7,"question_id":12679240,"title":"Delphi XE2 RTTI broken?","body":"<p>I recently migrated from D2010 to DXE2 and found a showstopper bug (Or feature????) in XE2 and XE3 (Tested in my friend XE3) related to RTTI generation for TBytes fields inside classes.</p>\n\n<p>I found that the RTTI information for a TBytes variable inside a class is never generated.</p>\n\n<p>The following code works well in D2010, but shows the message \"Error\" in XE2/XE3</p>\n\n<p>Does anyone have any clue??? This will totally break all our software data serialization implementation</p>\n\n<p>To test the code please add Rtti unit to the uses declaration</p>\n\n<pre><code>type\n\n  TMyClass = class\n  public\n    Field1: Integer;\n    Field2: TBytes;\n  end;\n\n\nprocedure TForm2.Button1Click(Sender: TObject);\nvar\n  i: Integer;\n  Data: TMyClass;\n  Rtti: TRttiContext;\n  RttiClassType: TRttiInstanceType;\nbegin\n\n  Data := TMyClass.Create;\n  try\n\n    // Get the context\n    Rtti := TRttiContext.Create;\n    try\n\n      // Get the type for the class\n      RttiClassType := TRttiInstanceType(Rtti.GetType(Data.ClassInfo));\n\n      // Check the fields\n      for i := 0 to High(RttiClassType.GetFields) do\n      begin\n\n        // Check the field type\n        if not Assigned(RttiClassType.GetFields[i].FieldType) then\n          ShowMessage('Error');\n\n      end;\n\n    finally\n      Rtti.Free;\n    end;\n\n  finally\n    Data.Free;\n  end;\n\nend;\n</code></pre>\n\n<p>The error message will be displayed when checking for Field2 that is a TBytes becayse the FieldType is always nil!!!</p>\n\n<p>Does anyone has any clue of what have changed in the RTTI from D2010 do XE2? Maybe because the TBytes type was changed from array of Byte to the generic array??</p>\n\n<p>Please help me</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1499,"score":2,"question_id":4861825,"title":"Strange \"A component named TFrm1 already exists\" error","body":"<p><br>\nI want to let the user to create multiple instances of the same form (let's call it Form1 which is a MDI child form). So I have two procedures like this where I create the forms.</p>\n\n<pre><code>procedure MyProcedure1;           // procedure 2 is similar. it also has a var called MyFrm\nvar MyFrm: TFrm1;\nbegin\n  ... \n  MyFrm:= TFrm1.create(MainForm);\n  MyFrm.BringToFront;\n  MyFrm.LoadFromFile(someFile);\nend;\n</code></pre>\n\n<p>As you can see MyFrm is local var. This is ok for me as I don't need to programatically access the form after I create it. There is no other global variable named Frm1. In the OnClose event of MyFrm I have Action:= caFree;  </p>\n\n<p>What could cause the error above? \nA user sent that error. It happened only once and I cannot reproduce it. </p>\n\n<hr>\n\n<p><strong>Edit:</strong>  </p>\n\n<ol>\n<li><p>The error appears in the \"MyFrm:= TFrm1.create\" line.</p></li>\n<li><p>Some people suggested that I need to programatically give <strong>unique names</strong> to my dynamically created forms. I also wondered myself what name a form takes when it is created so I stepped into the code while calling the MyProcedure1 procedure.<br>\nDelphi automatically gives unique names like<br>\nMyFrm.name= MyFrm, then<br>\nMyFrm.name= MyFrm_1,<br>\nMyFrm.name= MyFrm_2,<br>\nMyFrm.name= MyFrm_3, and so on.</p></li>\n<li><p>The MyFrm.Name is not altered in LoadFromFile. I have checked (breakpoint) the value of 'MyFrm.Name' at the end of procedure MyProcedure1; after LoadFromFile. The name is unique. </p></li>\n<li><p>As some people suggested, I override the SetName procedure and checked the name of TMyFrm. Indeed each form gets a unique name.</p>\n\n<p>procedure TMyFrm.SetName(const Value: TComponentName);<br>\nbegin<br>\n   ShowMessage(Value);<br>\n   inherited;<br>\nend;  </p></li>\n<li><p>I have many forms in this app but only the MainForm is auto-created.</p></li>\n<li><p>I don't use threads. Anyway this will not be relevant since the forms are created by user (so multi-threading is irrelevant unless the user can create 2 forms at the same time).</p></li>\n</ol>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":79,"score":2,"question_id":12686240,"title":"Delphi: Can we use metaclass reference to access properties at runtime or designtime?","body":"<p>The question arises from the need to reuse a code for different types of objects.<br/></p>\n\n<ul>\n<li>Scenario:</li>\n</ul>\n\n<p>Drag and Drop in listboxes either from a different listbox or same.<br/>\nabove question arises, when i try to implement drag and drop in same control.<br/>\nthe user can rearrange items in a listbox by dragging them up or down.<br/>\nI have written the logic, it works.<br/>\nThe problem is, in my app, i have used different kind of listboxes as per requirement.<br/>\nSo their type gets changed. in order to use the same code for drag and drop,<br/>\nwhen the source and sender is same, i typecasted different list-boxes to the common ancestor TCustomListBox<br/>\nand then sent that to the function which performs the moving of items.<br/>\nThe function swaps the items from the items collection to their new positions.<br/></p>\n\n<ul>\n<li><p>Now particular scenario:</p>\n\n<p>i have used a checklistbox which has a checkbox associated with each item.<br/>\nIt so happens, that with each item, there is an object of checkstate associated.<br/>\nNow in the function, for moving items, i use a tstringlist for temporary storing the items<br/>\nand their objects and then delete them from the control and then reinsert them in the control.<br/>\nbut in case of this checklistbox, when i delete an item, the item gets deleted,<br/>\nbut its corresponding checkstate object remains and it gets associated to the next item,<br/>\nwhich is not desired.<br/>\nso right now i am using an int variable as a mode indicator for normal,<br/>\nand special dragdrop.<br/>\nwhen it is special, as in case of checklistbox, i typecast it to tchecklist and<br/>\nthen access its delete method which removes item alongwith its checkstate.<br/></p>\n\n<p>So instead of using an int as a mode, i was wondering,<br/>\nwhether i can use a class reference of the base class of all listboxes and<br/>\nthen how can i access the properties of a particular listbox type, if the need arises.<br/>\nthe above solution, is not optimum, thats why, i need a more generic and proper way.\nSee if you can help. thanks. and thanks for the advise, i do care for this community, i am not used  to editing features. sorry.</p></li>\n</ul>\n\n<p><strong>i am using delphi 6.</strong><br/>\nThe declaration for the function is as follows :-<br/>\n          DragDropItemsInListBox(p_HostIndex : Integer; p_HostListBox : TCustomListBox;<br/>\n          p_Mode:Integer);\n<br/>\n<br/>\ncall:-<br/>\n  the hostindex is the drop site index, hostlistbox is the control on which the item will be dropped,<br/>\n  in this case, the source control and destination control is same,<br/>\n  and mode indicates the way of deleting.<br/>\n            DragDropItemsInListBox(3,TCustomListBox(Source), 1);<br/>\n<br/>\n<br/>\n  if the mode is 0 then i delete items normally as in:-<br/>\n             p_HostListBox.items.delete(i);\n<br/>\n<br/>\n  if it is 1, which indicates special processing,<br/>\n  in this case as i know what to do, therefore i use,<br/>\n<br/>\n             if p_Mode = 1 then <br/>\n                (p_HostListBox as TRzCheckList).items.delete(i);\n<br/>\n<br/>\n<br/>\n  this removes the item alongwith the checkstate object.<br/>\n  but i dont wanna rely on this int based differentiation.<br/>\n  can i use metaclasses and if i normally call items.delete,<br/>\n  then will it apply to that specific type?</p>\n"},{"tags":["delphi","compiler","params"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":163,"score":1,"question_id":12620542,"title":"Delphi compiler options","body":"<p>When compiling a Delphi app you have some params to use in the config $(Config)\\$(Platform) places the compiled file in Release\\Win32 \nAre there any param that gives me the programname as stated in the DPR file (which is also the name of the exe file)</p>\n\n<p>Just to make it a bit more clear what I want:\nI want all my compiled exe to be put in a Folder called C:_Delphi_Compiled\\Projectname\\Config\\Platform  (Using the project I mention further down it will be C:_Delphi_Compiled\\GUIDmaker\\Release\\Win32)\nThis will give me a bit more control over my projects exe files and DCU files</p>\n"},{"tags":["delphi","tcp-ip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12686474,"title":"Delphi 6 - TIdTCPClient - Disconnect fails after sendcmd","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3574847/how-to-disconnect-the-tcpclient-totally-indy\">How to disconnect the TCPClient Totally ? (Indy)</a>  </p>\n</blockquote>\n\n\n\n<p>Using the following code to send information to my networked device, the device responds as expected but I can't get the TIdTCPClient component to disconnect (my application hangs and fails to close).</p>\n\n<pre><code>procedure TForm1.Button5Click(Sender: TObject);\nvar myIDTCPClient : TIdTCPClient;\nmycommand : string;\nbegin\nmemo1.Lines.loadfromfile('testfile.txt');\nmycommand := Memo1.Lines.Text;\nMemo1.Lines.Clear;\ntry\n  myIDTCPClient := TIdTCPClient.Create(nil);\n  myIDTCPClient.Host := Edit1.Text;\n  myIDTCPClient.Port := 9100;\n  myIDTCPClient.Connect;\n  myIDTCPClient.SendCmd(mycommand);\nfinally\n  //myIDTCPClient.DisconnectSocket;\n  myIDTCPClient.Disconnect;\n  myIDTCPClient.Free;\nend;\nend;\n</code></pre>\n\n<p>Any suggestions on how I close the connection so that application closes as normal?</p>\n\n<p>TIA</p>\n"},{"tags":["delphi","intraweb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":11504959,"title":"Intraweb TIWUserSession members losing value","body":"<p>Using Delphi 2007 with bundled version of Intraweb.  Making use of the built in <strong>usersession</strong> mechanism.  In the usersession unit I have added public members (integer) to the TIWUserSession and these are initialized in a login screen.  </p>\n\n<p>I am finding sometimes the values of these public members are being lost: some calls they are proper, but other calls they are unassigned integers.  Has anyone else experienced this?  </p>\n\n<p>My solution at this point is to not rely on the usersession but instead use a cookie and recalculate these members based on the cookie.</p>\n"},{"tags":["delphi","twebbrowser"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":12669196,"title":"opening page in webbrowser","body":"<p>I am using TWebBrowser to open a site.</p>\n\n<p>When it opens, it comes with the message that the webbrowser (ie 9) is out of date and that I should replace it. This is the only time I get it.</p>\n\n<p>How can I avoid it (it makes opening the page realy slow)?</p>\n"},{"tags":["delphi","directshow","dspack"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":169,"score":2,"question_id":12680600,"title":"How to capture frames using Delphi/DSPack without displaying it on TVideoWindow?","body":"<p>DSpack has example code to play a DirectShow compatible video device and to capture the video frames simultaneously. A TVideoWindow is attached to the FilterGraph to display the video (Firgure-1). If you remove the TVideoWindow, then the Operating System (Windows) will automatically bring up ActiveMovie and display the video on a separate window (Figure-2). </p>\n\n<p>Is there a way to use DSPack to capture video frames without using any of the GUI components and without displaying the video?</p>\n\n<p>DSPack forum has some mention about NullRenderer filter but there is no documentation or examples on how to use it. Looks like we can achieve that if we manually replace the Video Renderer with Null Render directly in the GraphEdit (Figure-3). </p>\n\n<p>How can we achive the result shown in Figure-3 by doing all manipulations within the code? DSPack does not explain how to create a Null Renderer.</p>\n\n<pre><code>Figure-1: The graph of the default example code\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/1EyBe.png\" alt=\"Figure-1\"></p>\n\n<pre><code>Figure-2: Shows what happens if I remove the TVideoWindow\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/stKes.png\" alt=\"Figure-2\"></p>\n\n<pre><code>Figure-3: Shows what happens if I replace Video Renderer with a \n         Null Renderer and manually connect them in the GraphEdit. \n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/rugNy.png\" alt=\"Figure-3\"></p>\n\n<p><strong>This is what I ended up doing (so far)</strong></p>\n\n<p>Call the following <code>ReassignSampleGrabberOutput</code> just before <code>filterGraph.Play;</code></p>\n\n<pre><code>procedure TForm1.ReassignSampleGrabberOutput;\nvar\n  nullRenderer : IBaseFilter;\n  nullRendererPins: IEnumPins;\n  nullRendererPin : IPin;\n  graph:   IGraphBuilder;\nbegin\n\n  nullRenderer := CreateComObject(CLSID_NullRenderer) as IBaseFilter;\n  FilterGraph1.QueryInterface(IID_IGraphBuilder, graph);\n  graph.AddFilter(nullRenderer, 'Null Renderer');\n\n  nullRenderer.EnumPins(nullRendererPins);\n\n  nullRendererPins.Reset;\n\n  if nullRendererPins.Next(1, nullRendererPin, nil) = S_OK then\n  begin\n    //SampleGrabber1.OutPutPin.Disconnect;\n    //SampleGrabber1.OutPutPin.Connect(nullRendererPin, nil);\n\n    graph.Disconnect(SampleGrabber1.OutPutPin);\n    graph.FindFilterByName('Video Renderer', filter);\n    graph.RemoveFilter(filter);\n    graph.Connect(SampleGrabber1.OutPutPin, nullRendererPin);\n\n  end;\nend;\n</code></pre>\n"},{"tags":["algorithm","delphi","delphi-7","pascal","mergesort"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":214,"score":0,"question_id":12673633,"title":"delphi mergesort for string arrays","body":"<p>Found this coded mergesort on <a href=\"http://www.explainth.at/en/delphi/dsort.shtml\" rel=\"nofollow\">http://www.explainth.at/en/delphi/dsort.shtml</a> (site down but try wayback machine or this site: <a href=\"http://read.pudn.com/downloads192/sourcecode/delphi_control/901147/Sorts.pas__.htm\" rel=\"nofollow\">http://read.pudn.com/downloads192/sourcecode/delphi_control/901147/Sorts.pas__.htm</a>) but essentially the array defined was not for an array of string.\n<code>type TSortArray = array[0..8191] of Double;</code>\nI want to pass an array of string that would possibly eliminate duplicates (this would be Union?) <em>and preserve original order if possible for later resorting it back to original index position minus the duplicates of course (original index)</em> so array can be passed back for further processing. I am using very large files of strings with millions of strings (14 to 30 million) so <code>TStringList</code> is not an option. Best option for these large files is to use arrays of string or arrays of records (or maybe single linked list??) and sort with stable algorithm made for large amount of data.</p>\n\n<ol>\n<li>How can I change this to take array of string?</li>\n<li>How can it be further modified to delete or at least mark duplicates?</li>\n<li>Is it possible to store original index number to place back strings in original position?</li>\n<li>Are arrays of string or arrays of record better for large number of strings as compared to a single linked list?</li>\n</ol>\n\n<p>Questions are listed in order of importance so if you answer question number 1 only that is fine. Thank you in advance for all your input.</p>\n\n<hr>\n\n<pre><code>procedure MergeSort(var Vals:TSortArray;ACount:Integer);\nvar AVals:TSortArray;\n\n  procedure Merge(ALo,AMid,AHi:Integer);\n  var i,j,k,m:Integer;\n  begin\n    i:=0;\n    for j:=ALo to AMid do\n    begin\n      AVals[i]:=Vals[j];\n      inc(i);\n      //copy lower half or Vals into temporary array AVals\n    end;\n\n    i:=0;j:=AMid + 1;k:=ALo;//j could be undefined after the for loop!\n    while ((k &lt; j) and (j &lt;= AHi)) do\n    if (AVals[i] &lt; Vals[j]) then\n    begin\n      Vals[k]:=AVals[i];\n      inc(i);inc(k);\n    end else\n    begin\n      Vals[k]:=Vals[j];\n      inc(k);inc(j);\n    end;\n    {locate next greatest value in Vals or AVals and copy it to the\n     right position.}\n\n    for m:=k to j - 1 do\n    begin\n      Vals[m]:=AVals[i];\n      inc(i);\n    end;\n    //copy back any remaining, unsorted, elements\n  end;\n\n  procedure PerformMergeSort(ALo,AHi:Integer);\n  var AMid:Integer;\n  begin\n    if (ALo &lt; AHi) then\n    begin\n      AMid:=(ALo + AHi) shr 1;\n      PerformMergeSort(ALo,AMid);\n      PerformMergeSort(AMid + 1,AHi);\n      Merge(ALo,AMid,AHi);   &lt;==== passing the array as string causes AV breakdown here\n    end;\n  end;\n\nbegin\n  SetLength(AVals, ACount);\n  PerformMergeSort(0,ACount - 1);\nend;\n</code></pre>\n"},{"tags":["delphi","cookies","intraweb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":11591436,"title":"intraweb XII+isapi+iis7 cookie not saved?","body":"<p>I developed an intraweb XII small app which save a cookie:</p>\n\n<pre><code> ck:=THTTPCookie.Create('coo1','valcoo1','',now+7);\n WebApplication.Response.Cookies.Add(ck);\n</code></pre>\n\n<p>Where I reopen the app, I use:</p>\n\n<pre><code>WebApplication.Request.CookieFields.Values['coo1']\n</code></pre>\n\n<p>If I run in debug in my pc the app all is OK.\nWhen I deply the isapi dll to an IIS7 server, the cookie is not reloaded.</p>\n\n<p>Could someone help me ?</p>\n\n<p>thanks</p>\n"},{"tags":["delphi","google","index","intraweb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":146,"score":0,"question_id":12115338,"title":"Delphi Intraweb website not indexed by google","body":"<p>I have made a website with Intraweb and it is working in my home-server. I have a basic home.html working in a IIS where I have included  to redirect to the port 8888. \nIt is working well, but google don't index misite:8888, only misite is indexed and, when I search misite in google no title or description appears.\nMust I include some instructions in my Intraweb Delphi WebSite to get it.\nThe website is www.raizcuadrada.es, \nThanks</p>\n"},{"tags":["delphi","return","winsock","recv"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12666657,"title":"why does recv sometimes not return when connection is closed?","body":"<p>I have a simple winsock client/server application. Mostly everything works fine, but sometimes recv does not return a value even when the client application is terminated.</p>\n\n<p>Quote from MSDN:</p>\n\n<blockquote>\n  <p>If no error occurs, recv returns the number of bytes received and the\n  buffer pointed to by the buf parameter will contain this data\n  received. If the connection has been gracefully closed, the return\n  value is zero. Otherwise, a value of SOCKET_ERROR is returned, and a\n  specific error code can be retrieved by calling WSAGetLastError.</p>\n</blockquote>\n\n<p>What could be the reason for that recv never returns and hangs forever without a connection to the client?</p>\n\n<p>The relevant server code:</p>\n\n<pre><code>const\n  BUFSIZE = 512;\nvar\n  Sock: TSocket;\n  I   : Integer;\n  Buf : AnsiString;\nbegin\n  repeat\n    SetLength(Buf, BUFSIZE);\n    //blocking call\n    I := recv(Sock, Pointer(Buf)^, BUFSIZE, 0);\n    if I &gt; 0 then\n    begin\n      SetLength(Buf, I);\n      //do s.th. with Buf\n    end;\n  until I &lt;= 0; //Connection closed or error\n\n  //Sometimes never here\n\n  Synchronize(procedure\n  begin\n    FOnConnectionClosed(Self, Sock, WSAGetLastError);\n  end);\nend.\n</code></pre>\n"},{"tags":["multithreading","delphi","winapi","delphi-7","multitasking"],"answer_count":3,"favorite_count":1,"up_vote_count":9,"down_vote_count":0,"view_count":389,"score":9,"question_id":11942827,"title":"Why threads starve even on preemptive multitasking OS (Windows 7)","body":"<p>I wrote a Win32 application (in Delphi-7 which is 32-bit using TThread class) to create 100 threads. Each thread when resumed will continuously (in a loop) increment a 64 bit counter associated with the thread object (so no locking or sharing of data). </p>\n\n<p>If you let the system run for 10 to 15 seconds and stop after that, you should see roughly the same counts in each of the threads. But what I observed was that 81 threads ran under 400 million loops and the remaining ones looped more than 950 million times. Slowest thread got only 230 million compared to the fastest 2111 million. </p>\n\n<p>According to MSDN, the preemptive multitasking is at the thread-level (not process level), so each of my thread should have gotten its time-slice in a round-robin fashion. What am I missing here and why is this discrepancy? </p>\n\n<p>Edit1: Machine configuration: Intel i7 Quad Core 3.4GHz with hyper-threading turned on (8 active threads at a time). Running Windows-7 64 bit professional (and the test application is 32 bit)</p>\n\n<p>Edit2 (thread code): The test application is built with optimization turned on and without any debug info. Run the test application outside of IDE.</p>\n\n<pre><code>type\n\n  TMyThread = class(TThread)\n  protected\n    FCount: Int64;\n  public\n    constructor Create;\n    procedure Execute; override;\n    property Count: Int64 read FCount;\n  end;\n\n\n{ TMyThread }\n\nconstructor TMyThread.Create;\nbegin\n  inherited Create(True);\n  FCount := 0;\nend;  \n\nprocedure TMyThread.Execute;\nbegin\n  inherited;\n  while not Terminated do\n  begin\n    Inc(FCount);\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi","serialization","delphi-2007"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":109,"score":2,"question_id":12672215,"title":"Forcing the default value of a Real to be written in WriteComponent()","body":"<p>In a particular way of using the default built-in \"component streaming system\", I've found that it's problematic that the value of a property is not written if it's equal to the default value.</p>\n\n<p>Let's considering the following scheme:</p>\n\n<p>You use <strong>WriteComponent()</strong> and <strong>ReadComponent()</strong> in order to save the particular state of a component. We call this state a <em>preset</em>. The component contains various Real-typed properties with a setter.</p>\n\n<p>We know that if a property is equal to its default value then the preset won't include the value.</p>\n\n<p>So for our component</p>\n\n<ol>\n<li>we set the property <strong>AFLoat</strong> to <em>0.0</em></li>\n<li>we save the preset in a stream (MyStream.WriteComponent(MyInstance))</li>\n<li>we set the property  <strong>AFLoat</strong> to <em>0.101</em></li>\n<li>we reload the preset (MyStream.ReadComponent(MyInstance))</li>\n</ol>\n\n<p>Finally after the reloading of the preset, <strong>AFLoat</strong> is still equal to <em>0.101</em> while we were expecting its value to be <em>0.0</em>.</p>\n\n<p>The origin of the bug is quite obviously that the default value of a property is never written in a component stream. So in step <em>2</em>: the property is not written and then in step 4 it's not read...Quite anoying isn't it!</p>\n\n<p>Is there a way to force the default value of a property to be written in a component stream ? Actually I have a home-made fix for the Real-typed properties but I'd like to know if there's a well know way to overcome the underlyed issue.</p>\n\n<p>My custom fix is to reset the Real-typed properties to 0 by using TypInfos before calling <strong>ReadComponent()</strong></p>\n\n<pre><code>Procedure ResetFloatToNull(Const AnObject: TObject; Recursive: Boolean);\nVar\n  i,j: Integer;\n  LList: PPropList;\nBegin\n  j := GetPropList( AnObject, LList);\n  If j &gt; 0 Then For i:= 0 To j-1 Do\n    Case LList^[i].PropType^.Kind Of\n    // floats with the object scope\n    tkFloat: SetFloatProp(AnObject,LList^[i].Name,0);\n    // floats with a subobject scope (IsSubComponent)\n    tkClass: If Recursive Then\n      ResetFloatToNull( TObject(GetOrdProp(AnObject,LList^[i])), True);\n    End;\n  FreeMem(LList);\nEnd;\n</code></pre>\n\n<p>But if no other methods exist, then (implicit &amp; secondary question): shouldn't EMB gives up the default value ? While it has a little interest in the IDE object inspector (Reset to Inherited, in the contextual menu) it completely leads to various annoyances in the Component serialization system...</p>\n\n<p>I hope you get the basic problem, otherwise I can add a small example...</p>\n\n<hr>\n\n<p>Small demo of the bug (added after the first answer by DH and the comment war):</p>\n\n<pre><code>program Project1;\n{$APPTYPE CONSOLE}\nuses\n  SysUtils,\n  classes;\n\ntype\n  TTestClass = class(TComponent)\n  private\n    ffloat1,ffloat2: single;\n  published\n    property float1: single read ffloat1 write ffloat1;\n    property float2: single read ffloat2 write ffloat2;\n  end;\n\nvar\n  str: TMemoryStream;\n  testclass: TTestClass;\n\nbegin\n  testclass := TTestClass.Create(Nil);\n  str := TMemoryStream.Create;\n  //\n  testclass.float1 := 0.31;\n  testclass.float2 := 0.32;\n  //\n  testclass.float1 := 0.0;\n  testclass.float2 := 0.2;\n  str.WriteComponent(testclass);\n  writeln( 'we have wrote a state when the prop 1 is equal to 0.0 and prop 2 is equal to 0.2');\n  //\n  testclass.float1 := 0.1;\n  testclass.float2 := 0.3;\n  writeln( 'then we set the prop 1 to 0.1 and prop 2 to 0.3');\n  writeln('');\n  //\n  writeln( 'we reload the state saved when the prop 1 was equal to 0.0 and prop 2 to 0.2   and we get:');\n  str.Position := 0;\n  str.ReadComponent(testclass);\n  writeln( Format( 'prop 1 equal to %.2f', [testclass.float1]));\n  writeln( Format( 'prop 2 equal to %.2f', [testclass.float2]));\n  //\n  writeln('');\n  writeln('prop 1 has not been restored because the default value 0.0 was not written');\n  writeln('prop 2 has been restored because a non default value was written and read');\n  //\n  ReadLn;\n  str.free;\n  testclass.free;\nend.\n</code></pre>\n"},{"tags":["delphi","delphi-xe","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":206,"score":4,"question_id":12673397,"title":"Delphi XE - faster alternative to System.Pos function","body":"<p>I know that a lot of code from FastStrings has been included into Delphi XE. I need to process several thousands of files and do some text processing. Is there a 'faster' alternative to the <a href=\"http://docwiki.embarcadero.com/Libraries/en/System.Pos\" rel=\"nofollow\">System.Pos</a> routine?</p>\n"},{"tags":["delphi","png","delphi-2007","timage"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":3190,"score":4,"question_id":616417,"title":"How can I display a transparent PNG on Delphi 2007?","body":"<p>The TImage control doesn't support PNG. Is there some third party component that will?</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi","ado","delphi-2007","vcl","tdbgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12679419,"title":"is it possible to edit a field in a VCL TDBGrid with TADOTable as a data source?","body":"<p>I recently modified some old UI code using Delphi's VCL to use ADO instead of BDE.  One of the screens used a TDBGrid control to modify the underlying DataSource, but it appears that is no longer possible to edit the values in the grid.  Here is how I have it configured:</p>\n\n<p>TDBGrid->TDataSource->TADOTable</p>\n\n<p>I found this post on another forum that seemed related:\n<a href=\"http://coding.derkeiler.com/Archive/Delphi/alt.comp.lang.borland-delphi/2009-08/msg00023.html\" rel=\"nofollow\">http://coding.derkeiler.com/Archive/Delphi/alt.comp.lang.borland-delphi/2009-08/msg00023.html</a></p>\n\n<p>Is this a limitation of ADO?  Or do I simply need to change the settings of a control somewhere? (cursor type or something?)</p>\n"},{"tags":["xml","delphi","xml-schema"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":12674592,"title":"Required tags not present when using Delphi XML Data Binding Wizard","body":"<p>I am using the XML Data Binding Wizard in Delphi XE2.\nThe schema has required tags of this type:</p>\n\n<pre><code>&lt;xs:element name=\"MyReport\" type=\"MyReportType\" /&gt;\n&lt;xs:complexType name=\"MyReportType\"&gt;\n  &lt;xs:all&gt;\n    &lt;xs:element name=\"Header\" type=\"HeaderType\" /&gt;\n    &lt;xs:element name=\"Values\" type=\"ValuesType\" /&gt;\n    &lt;xs:element name=\"Events\" type=\"EventsType\" /&gt;\n  &lt;/xs:all&gt;\n&lt;/xs:complexType&gt;\n</code></pre>\n\n<p>The problem is that if I don't add any elements to e.g. the Values-group, there will be no <code>&lt;Values&gt;</code>-tag, and the XML-file will fail validation against the XSD. This would probably not be a problem if the interface was providing a method for \"adding\" the Values-tag.</p>\n\n<p>Is there a standard way of handling this, or am I using the generated code incorrectly?</p>\n\n<p><strong>Put simply</strong>, is there <em>any</em> way, work-around or otherwise, using the code from the Data Binding Wizard, to produce the following XML (which is what is needed to validate using the above schema when there are no child nodes), given HeaderType, ValuesType and EventsType are of complexType:</p>\n\n<pre><code>&lt;MyReport&gt;\n  &lt;Header /&gt;\n  &lt;Values /&gt;\n  &lt;Events /&gt;\n&lt;/MyReport&gt; \n</code></pre>\n\n<p>(I know there are other similar issues, like the code generated by <code>&lt;xs:sequence&gt;</code> not enforcing the correct order in the final XML-file, but at least for that one, there's a work-around by simply inserting the children in the right order. I still think it would be nice if Embarcadero would provide a complete interface, which takes more of these features into account.)</p>\n"},{"tags":["delphi","tclientdataset"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":124,"score":1,"question_id":11477326,"title":"TADO recordset XML to TClientDataSet XML format","body":"<p>I'm saving <strong>TADO recordset</strong> to  <strong>XML</strong> \nand trying to load it to <strong>TClientDataSet</strong> but geting error about wrong XML format.</p>\n\n<p>How can i transform ADO XML recordset format to TClientDataset format.</p>\n\n<p>thanks.</p>\n"},{"tags":["delphi","tclientdataset"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":440,"score":1,"question_id":465647,"title":"Filtering A TClientDataSet On A NestedDataSet Field","body":"<p>I have a small application I am working on that is almost finished thanks to \nthose who have assisted me here.  I have one last task however.\nI need to be able to Filter a TClientDataSet on a NestedDataSet field.</p>\n\n<pre><code>ClientDataset1\nField0: Name (Lake Name)\nClientDataset2\nField0: Species (Fish Species)\n\ntype\n  TDataModule1 = class( TDataModule )\n    ClientDataSet1: TClientDataSet;\n    ClientDataSet2: TClientDataSet;\n    ClientDataSet1Name: TStringField;\n    ClientDataSet1County: TStringField;\n    ClientDataSet1Town: TStringField;\n    ClientDataSet1Area: TStringField;\n    ClientDataSet1MaximumDepth: TStringField;\n    ClientDataSet1MeanDepth: TStringField;\n    ClientDataSet1MapFilename: TStringField;\n    ClientDataSet1Species: TDataSetField;\n    ClientDataSet2Species: TStringField;\n    procedure DataModuleDestroy( Sender: TObject );\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nData:\nNate Pond\n    Brook trout\n    Creek chub\n    Golden shiner\nBlack Pond\n    Brook trout\n    Brown bullhead\n    Common shiner\nLake Placid\n    Lake trout\n    Smallmouth bass\n    Yellow perch\n</code></pre>\n\n<p>I need to to filter ClientDataset1 to show all lakes that have Brook trout \nin the ClientDataset Species field.</p>\n\n<pre><code>Filtered:\nNate Pond\n    Brook trout\n    Creek chub\n    Golden shiner\nBlack Pond\n    Brook trout\n    Brown bullhead\n    Common shiner\n</code></pre>\n\n<p>How can a filter (or other means) be created to accomplish this?\nAre there any third-party componets that will do this?</p>\n\n<p>Thanks,</p>\n\n<p>Bill</p>\n"},{"tags":["delphi","tclientdataset"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1680,"score":3,"question_id":4006830,"title":"How i can delete all the records from a TClientDataset at once?","body":"<p>Is possible delete all the records from a <code>TClientDataset</code> at once?</p>\n"},{"tags":["delphi","tclientdataset"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":271,"score":3,"question_id":455815,"title":"Restructure a TClientdataset","body":"<p>Can a TClientDataSet XML file be restructured without losing data? Are there any demo applications or source code that shows how to do such a restructure?</p>\n"},{"tags":["delphi","sorting","refactoring"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":179,"score":3,"question_id":12671022,"title":"Implementing TObjectList's sort without copy/paste code","body":"<p>I have a procedure for sorting nodes in a node tree (<a href=\"http://www.lischke-online.de/index.php/controls/virtual-treeview\" rel=\"nofollow\">VirtualTreeView</a>)\nAll memory leaks, extracted from FMM4 report, are stored in objects of a class TMemoryLeakList(these are the list I want to sort), which are stored in a list of lists called TGroupedMemoryLeakList, and both TMLL and TGMLL extend TObjectList. If I want to keep the functionality of being able to chose between ascending and descending sort order and choosing between sorting by one of four different data types, I 'have to' implement EIGHT different comparison methods (4 sort types * 2 sort directions) which I pass on to the main sorting method, because my TMLL list extends TObjectList. The main sorting method look like <a href=\"http://pastebin.com/mcZJNBRi\" rel=\"nofollow\">this</a>.</p>\n\n<p>The values for the fields fSortType and fSortDirection are acquired from the GUI comboboxes.\nOne of those eight generic comparison functions looks like <a href=\"http://pastebin.com/sBnY3Jkd\" rel=\"nofollow\">this</a>.\nThe seven remaining are copy/pasted variations of this one.</p>\n\n<p>Is there any rational way to refactor this huge amount of copy paste code and still keep the functionality of choosing a specific sort type and direction?</p>\n"},{"tags":["delphi","c++builder","glscene"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":473,"score":6,"question_id":10516638,"title":"How can I solve fatal compiler errors when installing GLScene into RAD Studio 2010?","body":"<p>I'm trying to <strong>install GLScene into RAD Studio 2010</strong>, with the aim of using it from a mostly C++ project. I downloaded the <a href=\"http://sourceforge.net/projects/glscene/files/SVN%20Snapshots/\">latest snapshot (5991, November 2011)</a> and have been trying to compile and install the two main packages:  <code>GLScene_DesignTime</code> and <code>GLScene_RunTime</code>. I haven't even tried some of the other libraries (CUDA, etc), I just want to get the base packages running.</p>\n\n<p>I've encountered a number of problems, one of which I can't solve, and I'm seeking the help of anyone on SO who has <strong>successfully installed GLScene</strong>, or might know <strong>how to solve these Delphi compiler errors.</strong></p>\n\n<h2>First problem (solved?)</h2>\n\n<p>When compiling, a number of files gave the following error:</p>\n\n<pre><code>[DCC Warning] GLSelection.pas(297): W1025 Unsupported language feature: 'abstract class method'\n</code></pre>\n\n<p>This is caused by a method declaration something like:</p>\n\n<pre><code>TGLBaseSelectTechnique = class\n  public\n    class function IsSupported: Boolean; virtual; abstract;\n</code></pre>\n\n<p>It seems that a virtual abstract class method is not supported in Delphi 2010, and I have solved it by removing '<code>abstract</code>' and providing a dummy implementation, e.g. just returning <code>false</code>.</p>\n\n<h2>The second problem (not solved) - Delphi compiler fatal errors</h2>\n\n<p>I am now encountering two more serious errors. When compiling, the compiler fails like so:</p>\n\n<pre><code>[DCC Fatal Error] Exception EAccessViolation: Access violation at address 05AE8ED9 in module 'dcc140.dll'. Read of address 00000003\n[DCC Error] Catastrophic failure (Exception from HRESULT: 0x8000FFFF (E_UNEXPECTED))\n</code></pre>\n\n<p>It doesn't say what file caused this, but I <em>think</em> it's caused by <code>Spline.pas</code>. Occasionally and not as often, I get this:</p>\n\n<pre><code>[DCC Fatal Error] Spline.pas(1): F2084 Internal Error: AV062D8ED9-R00000003-0\n</code></pre>\n\n<p>This indicates <code>Spline.pas</code>, and I think the first error is probably related to the file too, because after getting the first one if I then clean the project, cleaning will fail saying it could not delete <code>Spline.hpp</code>. (I have to close and reopen the IDE.) <code>Spline.hpp</code> just contains the following:</p>\n\n<pre><code>// CodeGear C++Builder\n// Copyright (c) 1995, 2009 by Embarcadero Technologies, Inc.\n// All rights reserved\n\n// (DO NOT EDIT: machine generated header) 'Spline.pas' rev: 21.00\n\n#ifndef SplineHPP\n#define SplineHPP\n\n#pragma delphiheader begin\n#pragma option push\n#pragma option -w-      // All warnings off\n#pragma option -Vx      // Zero-length empty class member functions\n#pragma pack(push,8)\n#include &lt;System.hpp&gt;   // Pascal unit\n#include &lt;Sysinit.hpp&gt;  // Pascal unit\n</code></pre>\n\n<p>and there it stops.  It looks to me like it failed when trying to generate the HPP file.</p>\n\n<p><strong>I always get one of these two failures.</strong>  The second is the only one I can tie to a specific file; the first fails halfway through the project, but I can't see where it got up to when it failed.  I am compiling from inside the IDE.</p>\n\n<p>I've looked in <code>Spline.pas</code>, and it seems pretty basic code - I can't see anything unusual at all. You can <a href=\"http://glscene.svn.sourceforge.net/viewvc/glscene/trunk/Source/Base/Spline.pas?revision=6065&amp;view=markup\">find it here</a>, and apparently the file <a href=\"http://glscene.svn.sourceforge.net/viewvc/glscene/trunk/Source/Base/\">hasn't been touched for seven years</a>... so I think it should compile :)</p>\n\n<p>If I change the project settings so it does not generate headers, it compiles fine. (Generating just obj files, and any other of the settings that does not include \"headers\", all work fine.) But this isn't a good workaround for me - after all, I need to use it from C++ Builder, so my normal setting would be \"Generate all C++ Builder files\". At a bare minimum, I need HPP and OBJ files.</p>\n\n<p>Has anyone here used GLScene in a recent version of C++ Builder? Have you encountered similar problems? Any idea how to solve this one?</p>\n\n<p>I am using:</p>\n\n<ul>\n<li>RAD Studio 2010 (fully patched and up to date; DDevExtensions and IDEFixPack installed.)</li>\n<li>The November 2011 snapshot; I tried the March 2011 snapshot too, and got the same problems.  <a href=\"http://sourceforge.net/projects/glscene/files/SVN%20Snapshots/\">Link to snapshots here</a>.</li>\n<li>The Delphi 2010 packages modified <em>only</em> by changing the linker output to generate C++ Builder files; and also the BCB 6 packages.  Both give the same errors.</li>\n</ul>\n"},{"tags":["regex","delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12673441,"title":"TRegExpr why (.*$) expression works twice on the string?","body":"<p>I'm parsing the string with <code>TRegExpr</code>. Expression looks like:</p>\n\n<pre><code>(.*$)\n</code></pre>\n\n<p>It means it should find the whole string, but after finding it when I use command <code>ExecNext</code>, it finds empty string, but the line is over already because of the <code>$</code> symbol.</p>\n\n<p>Can someone explain such behavior?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12672178,"title":"Delphi XE2 GetTextExtentPoint32 fails when called by a thread","body":"<p>This simple example raise exception (invalid parameter) when double clicking on Button1.</p>\n\n<p>You may have to click several times to get the message.</p>\n\n<p>What is wrong with this code ?</p>\n\n<pre><code>type\n  TForm2 = class(TForm)\n    Button1: TButton;\n    procedure Button1Click(Sender: TObject);\n  end;\n\n  TTestThread = class(TThread)\n  protected\n    procedure Execute; override;\n  end;\n\nvar\n  Form2: TForm2;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm2.Button1Click(Sender: TObject);\nvar MyThread : TTestThread;\nbegin\n  MyThread:=TTestThread.Create(true);\n  MyThread.FreeOnTerminate:=True;\n  MyThread.Priority:=tpHighest;\n  MyThread.Resume;\nend;\n\n{ TTestThread }\n\nprocedure TTestThread.Execute;\nvar len : integer;\nbegin\n len := Form2.Canvas.TextWidth('test');\n if (len=0) then\n  Raise Exception.Create(SysErrorMessage(GetLastError));\nend;\n\nend.\n</code></pre>\n"},{"tags":["mysql","delphi","queue","high-availability"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":12670171,"title":"High availability for self-developed Delphi SMTP Relay Server?","body":"<p>I'm wondering what is the best way to implement high availability for a self-developed SMTP Relay Server that needs to handle 30-100 emails per second.</p>\n\n<p>What this server essentially does is to authenticate with various smtp clients, and then relay to specific mail servers and handle errors, e.g. mail server not available, etc.  Hence, a queue is required to contain the email messages, which can contain big attachments.  For high availability, the system should support clustering, which I can use Windows Clustering for a primary/secondary active cluster.</p>\n\n<p>I reckon that the Email Queue can reside in:</p>\n\n<ol>\n<li>Memory (this method is out for obvious reason.)</li>\n<li>RDMS</li>\n<li>File (I believe this is what IIS Virtual SMTP uses?)</li>\n<li>Embedded DB such as SQLite</li>\n<li>Mix of SQLite and File</li>\n<li>Some fanciful 3rd party Queue product that needs to be installed and configured?</li>\n</ol>\n\n<p>The usual method for high availability is to use an RDBMS such as MySQL, but using an RDBMS for a message queue is going to slow down the performance significantly unless I have a powerful MySQL server.  On top of that, I will have to implement MySQL clustering which is not easy.  Also, I read somewhere that no one should use MySQL as a queue - <a href=\"http://www.engineyard.com/blog/2011/5-subtle-ways-youre-using-mysql-as-a-queue-and-why-itll-bite-you/\" rel=\"nofollow\">http://www.engineyard.com/blog/2011/5-subtle-ways-youre-using-mysql-as-a-queue-and-why-itll-bite-you/</a></p>\n\n<p>Alternatively, I can use SQLite+File, this will probably be the fastest (other than pure memory) and easiest to deploy method (nothing to install), but there's no clustering for SQLite so if the server crashes, the unsent messages may still be lost.</p>\n"},{"tags":["delphi","fastmm"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":79,"score":3,"question_id":12670438,"title":"Generating a FASTMM report WITHOUT the shutdown dialog","body":"<p>I would like my Delphi project to generate the a FASTMM memory leak report during the program runtime, if possible, and append to that report on shutdown, without having to see <a href=\"http://imgur.com/2vWRQ\" rel=\"nofollow\">this dialog</a> every time I close the program.</p>\n\n<p>If it is not possible to make FMM create the report and edit it N times during runtime, I would at least like to get rid of the annoying dialog, since I already have the report with much more details than the dialog shows.</p>\n"},{"tags":["delphi","dll-injection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":163,"score":1,"question_id":12670668,"title":"delphi xe3 dll injection for 64bit dll to 64bit proccess doesn't work","body":"<p>I'm using this code to inject my 64bit dll into a 64bit process on windows 7 64 bit,CreateRemoteThread return 200  but still the dll does not injected, I tested my dll with another source and it works fine, Process Explorer shows that my code does not work,What can be wrong with this code, I'm using delphi XE3 and i have compile the code on 64bit target platform.</p>\n\n<pre><code>function InjectDLL(dwPID: DWORD; DLLPath: pwidechar): integer;\nvar\ndwThreadID: Cardinal;\nhProc, hThread, hKernel: NativeUInt;\nBytesWritten: NativeUInt;\npRemoteBuffer, pLoadLibrary: Pointer;\nbegin\ntry\nhProc := OpenProcess(PROCESS_ALL_ACCESS, False, dwPID);\nif hProc = 0 then\nbegin\n  Result := 0;\n  Exit;\nend;\npRemoteBuffer := VirtualAllocEx(hProc, nil, Length(DLLPath) + 1, MEM_COMMIT,\n  PAGE_READWRITE);\nif pRemoteBuffer = nil then\nbegin\n  Result := 0;\n  Exit;\nend;\nif WriteProcessMemory(hProc, Pointer(pRemoteBuffer), lpvoid(DLLPath),\n  Length(DLLPath) + 1, BytesWritten) = False then\nbegin\n  Result := 0;\n  Exit;\nend;\nhKernel := GetModuleHandle(pwidechar('kernel32.dll'));\npLoadLibrary := (GetProcAddress(hKernel, pansichar('LoadLibraryA')));\nhThread := CreateRemoteThread(hProc, Pointer(nil), 0, Pointer(pLoadLibrary),\n  Pointer(pRemoteBuffer), 0, dwThreadID);\n\nWaitForSingleObject(hThread, INFINITE);\nVirtualFreeEx(hProc, Pointer(pRemoteBuffer), Length(DLLPath) + 1,\n  MEM_RELEASE);\nCloseHandle(hThread);\nCloseHandle(hProc);\n// ShowMessage(IntToStr(hThread)+' '+ inttostr(dwThreadID));\nResult := 1;\nexcept\non d: exception do\nbegin\nend;\nend;\nend;\n</code></pre>\n"},{"tags":["delphi","delphi-xe2","firemonkey"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12617885,"title":"How to Make a form snap to edges of the screen","body":"<p>I just recently started learning Firemonkey, so if the question is stupid, please do not kick. How can I make a Firemonkey form that sticks to the edges of the screen. In VCL is easily done by using the properties ScreenSnap: = true and SnapBuffer: = 15 for example. Another way - processing messages WM_WWINDOWPOSCHANGING or WM_MOVING. How can I make the same with FireMonkey?</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","certificate","generate","csr"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":12670131,"title":"Creating Certificate request with cryptoApi","body":"<p>I am trying to generate CSR in my application at runtime. The problem is, when calling CryptExportPublicKeyInfo i get error 8009000D - NTE_NO_KEY. I tried the example from MSDN here: <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/aa382364(v=vs.85).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/windows/desktop/aa382364(v=vs.85).aspx</a> and got exactly the same error. Can someone point me the right way?</p>\n\n<pre><code>  procedure TCertMgr.GenCSR(const CommonName: WideString;\n  var ACertString: WideString);\n\n  const\n    CertOU: WideString = 'OU';\n    CertO: WideString = 'O';\n    CertL: WideString = 'L';\n    CertS: WideString = 'S';\n    CertC: WideString = 'C';\n    CertE: WideString = 'mail@mail';\n    CertCN: WideString = 'CN';\n\n    CertContainer = 'HorSgwCont';\n\ntype\n  TRDNArr = array[0..6] of CERT_RDN_ATTR;\n\n\n  procedure FillRDNs(var ARDNs: TRDNArr);\n  begin\n\n    ARDNs[0].pszObjId := szOID_COMMON_NAME;\n    ARDNs[0].dwValueType := CERT_RDN_UNICODE_STRING;\n    ARDNs[0].Value.cbData := Length(CommonName);\n    ARDNs[0].Value.pbData:= PBYTE(CertCN);\n\n    ARDNs[1].pszObjId := szOID_ORGANIZATIONAL_UNIT_NAME;\n    ARDNs[1].dwValueType := CERT_RDN_UNICODE_STRING;\n    ARDNs[1].Value.cbData := Length(CertOU);\n    ARDNs[1].Value.pbData:= PBYTE(CertOU);\n\n    ARDNs[2].pszObjId := szOID_ORGANIZATION_NAME;\n    ARDNs[2].dwValueType := CERT_RDN_UNICODE_STRING;\n    ARDNs[2].Value.cbData := Length(CertO);\n    ARDNs[2].Value.pbData:= PBYTE(CertO);\n\n    ARDNs[3].pszObjId := szOID_LOCALITY_NAME;\n    ARDNs[3].dwValueType := CERT_RDN_UNICODE_STRING;\n    ARDNs[3].Value.cbData := Length(CertL);\n    ARDNs[3].Value.pbData:= PBYTE(CertL);\n\n    ARDNs[4].pszObjId := szOID_STATE_OR_PROVINCE_NAME;\n    ARDNs[4].dwValueType := CERT_RDN_UNICODE_STRING;\n    ARDNs[4].Value.cbData := Length(CertS);\n    ARDNs[4].Value.pbData:= PBYTE(CertS);\n\n    ARDNs[5].pszObjId := szOID_COUNTRY_NAME;\n    ARDNs[5].dwValueType := CERT_RDN_UNICODE_STRING;\n    ARDNs[5].Value.cbData := Length(CertC);\n    ARDNs[5].Value.pbData:= PBYTE(CertC);\n\n    ARDNs[6].pszObjId := szOID_RSA_emailAddr;\n    ARDNs[6].dwValueType := CERT_RDN_UNICODE_STRING;\n    ARDNs[6].Value.cbData := Length(CertE);\n    ARDNs[6].Value.pbData:= PBYTE(CertE);\n  end;\n\nvar\n  RDNs: TRDNArr;\n  RDN: CERT_RDN;\n  CertName: CERT_NAME_INFO;\n  CertNameEncLen: DWORD;\n  CertNameEnc: PBYTE;\n  NameBlob: CERT_NAME_BLOB;\n  CSRInfo: CERT_REQUEST_INFO;\n  CryptoProv: HCRYPTPROV;\n  Container: PChar;\n  PubKeyInfoLen: DWORD;\n  PubKeyInfo: PCERT_PUBLIC_KEY_INFO;\n  CryptoAlgParams: CRYPT_OBJID_BLOB;\n  CryptoAlg: CRYPT_ALGORITHM_IDENTIFIER;\n  SignedEncCertLen: DWORD;\n  SignedEncCert: PBYTE;\n  Error: Integer;\nbegin\n  FillRDNs(RDNs);\n  RDN.cRDNAttr := 7;\n  RDN.rgRDNAttr := @RDNs;\n  CertName.cRDN := 1;\n  CertName.rgRDN := @RDN;\n  CryptEncodeObject(PKCS_7_ASN_ENCODING or X509_ASN_ENCODING, X509_NAME, @CertName, nil, @CertNameEncLen);\n  GetMem(CertNameEnc, CertNameEncLen);\n  CryptEncodeObject(PKCS_7_ASN_ENCODING or X509_ASN_ENCODING, X509_NAME, @CertName, CertNameEnc, @CertNameEncLen);\n  NameBlob.cbData := CertNameEncLen;\n  NameBlob.pbData := CertNameEnc;\n  CSRInfo.Subject := NameBlob;\n  CSRInfo.dwVersion := CERT_REQUEST_V1;\n  CSRInfo.cAttribute := 0;\n  CSRInfo.rgAttribute := nil;\n  Container := CertContainer;\n  CryptAcquireContext(@CryptoProv, CertContainer, MS_DEF_PROV, PROV_RSA_FULL, 0);\n  CryptExportPublicKeyInfo(CryptoProv, AT_SIGNATURE, PKCS_7_ASN_ENCODING or X509_ASN_ENCODING, nil, @PubKeyInfoLen);\n  GetMem(PubKeyInfo, PubKeyInfoLen);\n  //------fails here-------------------------------\n  CryptExportPublicKeyInfo(CryptoProv, AT_SIGNATURE, PKCS_7_ASN_ENCODING or X509_ASN_ENCODING, pubKeyInfo, @PubKeyInfoLen);  \n  CSRInfo.SubjectPublicKeyInfo := PubKeyInfo^;\n  FillChar(CryptoAlgParams, sizeof(CryptoAlgParams), 0);\n  CryptoAlg.pszObjId := szOID_OIWSEC_sha1RSASign;\n  CryptoAlg.Parameters := CryptoAlgParams;\n  CryptSignAndEncodeCertificate(CryptoProv, AT_SIGNATURE, PKCS_7_ASN_ENCODING or X509_ASN_ENCODING, X509_CERT_REQUEST_TO_BE_SIGNED, @CSRInfo, @CryptoAlg, nil, nil, @SignedEncCertLen);\n  GetMem(SignedEncCert, SignedEncCertLen);\n  CryptSignAndEncodeCertificate(CryptoProv, AT_SIGNATURE, PKCS_7_ASN_ENCODING or X509_ASN_ENCODING, X509_CERT_REQUEST_TO_BE_SIGNED, @CSRInfo, @CryptoAlg, nil, nil, @SignedEncCertLen);\nend;\n</code></pre>\n"},{"tags":["delphi","properties","editor","runtime","firemonkey"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":11597839,"title":"FireMonkey property editor at runtime","body":"<p>In an HD form in FireMonkey, can I invoke the Brush property editor at runtime?</p>\n\n<p>e.g. when the application is running, upon click of a button, I want to show the TBrush property editor in Modal. When the user selects the brush type, I want to apply it on the form or other components. Can this be achieved?</p>\n"},{"tags":["delphi","keyboard-shortcuts","delphi-7"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":143,"score":5,"question_id":12659300,"title":"Adding a shortcut to a programmatically added system menu option","body":"<p>In my application, I have a base form in which various items are added to the system menu, for example</p>\n\n<pre><code> AppendMenu (SysMenu, MF_SEPARATOR, 0, '');\n AppendMenu (SysMenu, MF_STRING, SC_Sticky, 'Sticky');\n AppendMenu (SysMenu, MF_STRING, SC_Original, 'Original');\n</code></pre>\n\n<p>How does one add keyboard shortcuts to these menu options (eg Alt-F2, Alt-F3)? </p>\n\n<p>I can't use the standard method of using an accelerator (ie &amp;Sticky for Alt-S) as the real menu captions are in Hebrew and accelerators don't seem to work properly with this language.</p>\n"},{"tags":["delphi","winapi","windows-7","resizable","flyout"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":460,"score":5,"question_id":7408768,"title":"How to make a window like Windows 7 Notifications Flyouts, (WS_THICKFRAME but NOT-RESIZABLE)","body":"<p>I just made a <a href=\"http://vitimtk.blogspot.com/2011/09/ibrightness-tray.html\">small app here</a> in Delphi 7 that simulates the default system icons, like Volume, Battery, Clock, Network.  </p>\n\n<p>I'm trying to follow all Microsoft recomendations here <a href=\"http://msdn.microsoft.com/en-us/library/aa511448.aspx#flyouts\">http://msdn.microsoft.com/en-us/library/aa511448.aspx#flyouts</a></p>\n\n<p>To make a window look like a flyout, i'm using this code:</p>\n\n<pre><code>//declaration\n\nTForm1 = class(TForm)\n\nprotected\n  procedure CreateParams(var Params: TCreateParams); override;\nend;\n</code></pre>\n\n<p>implementation</p>\n\n<pre><code>procedure TForm1.CreateParams(var Params: TCreateParams);\nbegin\n  inherited;\n  Params.Style := WS_POPUP or WS_THICKFRAME;\n  Params.ExStyle := Params.ExStyle or WS_EX_TOPMOST;\nend;\n</code></pre>\n\n<p><strong>My problem is the WS_THICKFRAME allows user to resize the window. How can I fix this?</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/VSr3S.jpg\" alt=\"Resizable Window Issue\"></p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":620,"score":0,"question_id":2262692,"title":"How to conjure Input mask Editor?","body":"<p>Is is possible somehow to pop up Input Mask Editor at run-time? I was looking for it on internet, but no success,  it si not included in standard dialogs... </p>\n\n<p>I want user to make his own input mask... </p>\n\n<p>thanx</p>\n"},{"tags":["delphi","bidirectional","teechart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12493746,"title":"How can I change the BiDi mode of a TeeChart's legend?","body":"<p>Is it possible to simply change the <code>BiDiMode</code> of a <code>TChart</code>'s legend? Or I have to draw the whole legend manually?</p>\n"},{"tags":["delphi","delphi-2009","dll-injection","microsoft-ui-automation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12669348,"title":"How to detect color change of a TSemaphor control?","body":"<p>I have an application A, which has a little text box, surrounded by a frame, which indicates whether the system is ready or not. The text and the frame reside inside a Delphi <code>TSemaphor</code> control.</p>\n\n<ol>\n<li>During initialization, the frame is <strong>yellow</strong>.</li>\n<li>When the initialization has completed and the system is ready, the frame turns <strong>green</strong>.</li>\n</ol>\n\n<p>In another application B, I need to detect when application A has been initialized and is ready.</p>\n\n<p>How can I do this (detect change of color of the frame) in application A with least possible effort and under following constraints</p>\n\n<ol>\n<li>application A cannot be changed (I don't have its source code),</li>\n<li>application A has no automation interface,</li>\n<li>the only change that occurs, when the application A becomes ready, is the color change</li>\n</ol>\n\n<p>?</p>\n\n<p>There are following approaches to solving this problem I'm aware of:</p>\n\n<ol>\n<li>Use image recognition (http://sikuli.org/)</li>\n<li>Find out the color of the pixel at the respective position.</li>\n<li>Use an injected DLL to get access to TSemaphore attributes.</li>\n</ol>\n"},{"tags":["delphi","components","vcl"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":136,"score":3,"question_id":12663891,"title":"Automatic building and installing Delphi components","body":"<p>So, my Delphi component is functional and working, aside few details yet to cover. What I would like is to create a setup (Inno setup) that would automatically install my component into user's Delphi/C++ Builder IDE. I presume I must use delphi command line compiler, but how?</p>\n\n<p>Thank you.</p>\n"},{"tags":["delphi"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":289,"score":0,"question_id":12208671,"title":"Remove duplicates from combobox","body":"<p>Say i have a combobox with </p>\n\n<pre><code>apples\napples\npears\noranges\noranges\n</code></pre>\n\n<p>i would like to have it show</p>\n\n<pre><code>apples\npears\noranges\n</code></pre>\n\n<p>how can i do this?</p>\n"},{"tags":["delphi","firemonkey"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":12182359,"title":"Embarcadero FireMonkey 3D camera rotation and zoom","body":"<p>I search a example for camera rotation and zooming in FireMonkey 3D. Like use left mouse button to rotate the camera around the scene and use the mouse wheel to zoom in and out.</p>\n\n<p>Can anybody help me?</p>\n"},{"tags":["delphi","listview","delphi-xe2","firemonkey"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":144,"score":0,"question_id":11980845,"title":"Listview in Firemonkey","body":"<p>I would like to display a list of items with columns and bind them to some custom objects of mine. There is no ListView control in Firemonkey, so what is the recommended way of doing this? I'd like the columns to be easily resizable, but don't require editable items.</p>\n"},{"tags":["delphi","object","3d","firemonkey"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":82,"score":2,"question_id":11734843,"title":"How to pick 3D-Objects with Mouse in FireMonkey at Runtime","body":"<p>i have searched now for a long time and found no answer. Please give me a little help. I have various 3D-objects in a TVieport3D and want to pick them in runtime-mode with my mouse. But i don't know how to do this. Thank you</p>\n"},{"tags":["delphi","printing","compiler-errors","firemonkey"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":11428511,"title":"Firemonkey HD printing not working - out of range error","body":"<p>Firemonkey printing issue.</p>\n\n<p>XE2 update 4.  FM form for Win32/64/OSX</p>\n\n<p>Printing with the following code as suggested in the Embarcadero wiki</p>\n\n<p><a href=\"http://docwiki.embarcadero.com/RADStudio/en/Printing_from_a_FireMonkey_Application\" rel=\"nofollow\">http://docwiki.embarcadero.com/RADStudio/en/Printing_from_a_FireMonkey_Application</a></p>\n\n<p>FMX.Printer in the uses clause.</p>\n\n<p>Using the code below straight from the wiki, but keep getting an out of \nbounds error.  Not sure which array is out of bounds.  Found the \nfollowing bug record,</p>\n\n<p><a href=\"http://qc.embarcadero.com/wc/qcmain.aspx?d=101322\" rel=\"nofollow\">http://qc.embarcadero.com/wc/qcmain.aspx?d=101322</a></p>\n\n<p>but line 486 in my copy of FMX.Printer.win does not have the code it \nsuggests to be altered.  Also not sure how I would recompile the printer \nunits either.\nWorkarounds\n   FMX.Printer.Win, line 486 currently reads:\n     for I := 0 to Count - 1 do</p>\n\n<p>It should be replaced with:\n     for I := 0 to FPrinters.Count - 1 do</p>\n\n<p>Bit of a dead end.  Is anyone else printing successfully in firemonkey.</p>\n\n<p>A printer is connected and working for other applications.</p>\n\n<p>The code from Embarcadero wiki...</p>\n\n<pre><code>procedure  TMyForm.PrintButtonClick(Sender:  TObject);\nvar\nSrcRect,  DestRect:  TRectF;\n\nbegin\n{ Set the default DPI for the printer. The SelectDPI routine defaults\n  to the closest available resolution as reported by the driver. }\nPrinter.ActivePrinter.SelectDPI(1200,  1200);\n\n{ Set canvas filling style. }\nPrinter.Canvas.Fill.Color  :=  claBlack;\nPrinter.Canvas.Fill.Kind  :=  TBrushKind.bkSolid;\n\n{ Start printing. }\nPrinter.BeginDoc;\n\n{ Set the Source and Destination TRects. }\nSrcRect:=  Image1.LocalRect;\nDestRect:=  TRectF.Create(0,  0,  Printer.PageWidth,  Printer.PageHeight);\n\n{ Print the picture on all the surface of the page and all opaque. }\nPrinter.Canvas.DrawBitmap(Image1.Bitmap,  SrcRect,  DestRect,  1);\n\n{ Finish printing job. }\nPrinter.EndDoc; \nend;\n</code></pre>\n"},{"tags":["delphi","png","delphi-xe2","firemonkey","tbitmap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":296,"score":0,"question_id":8653521,"title":"How to check if the PNG image loaded into FMX.TBitmap has an alpha channel?","body":"<p>I'm loading PNG images into <code>FMX.Type.TBitmap</code> in Delphi-XE2 Update3 FireMonkey HD application. How do I check if loaded PNG image has an alpha channel or not?</p>\n\n<p>Currently if I load an image with an alpha channel it has alpha info in <code>Bitmap.Scanline[Y]^[X]</code> in a form of $AABBGGRR. However if I load PNG image without alpha the said record has only $00BBGGRR entries (AA = 0), just like an image with clear alpha. Hence the problem - how to determine if it is RGBA image with the alpha fully transparent or it is a RGB image (in this case I will process it to make the alpha fully opaque). Note: Checking through all pixels is not an option.</p>\n\n<p>FMX TBitmap has no <code>PixelFormat</code> property, nor I could find <code>HasAlpha</code> flag.</p>\n"},{"tags":["delphi","c++builder","c++builder-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":85,"score":-1,"question_id":12665110,"title":"String type in c++builder (RAD XE2) handle 2047 character only?","body":"<p>I have a project with Indy (using RAD XE2) and I get a return string from IdHTTP like:\nString result = IdHTTP->Get(url);\nthe problem is reuslt is limited at 2047 character lenght. \nHow can i handle full return string?\nThank you.</p>\n\n<p>Edit: This issue occurs when in debug mode only (using Step into).</p>\n"},{"tags":["windows","delphi","winapi"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":123,"score":3,"question_id":12645417,"title":"Can Delphi themed toolbars have dividers that are centred between their tool buttons?","body":"<p>I have noticed a rather annoying oddity with Delphi toolbars. I have a <code>TToolbar</code> that has logical groups of icons. To make the grouping stand out I would like to use separator buttons, with style <code>tbsDivider</code>.</p>\n\n<p>When I do this, it looks like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/BkJr3.png\" alt=\"enter image description here\"></p>\n\n<p>Note the double vertical lines between each icon. The right hand one is in the middle of the separator tool button. The left hand one is on the left edge of the separator tool button.</p>\n\n<p>So, I can switch to <code>tbsSeparator</code> which removes the middle line:</p>\n\n<p><img src=\"http://i.stack.imgur.com/oVpNg.png\" alt=\"enter image description here\"></p>\n\n<p>But I'm not keen on that since I'd like the divider to be in the middle.</p>\n\n<p>I looked at an ancient version of my real app and found that it had centred separators. It seems that is possible when Windows themes are disabled.  Here's what it looks like with <code>tbsDivider</code> and the application manifest removed:</p>\n\n<p><img src=\"http://i.stack.imgur.com/3qqie.png\" alt=\"enter image description here\"></p>\n\n<p>That's the layout I am looking for. Is this attainable when themes are active?</p>\n\n<p>I did find a discussion of the issue on the Embarcadero forums, but there was no useful insight: <a href=\"https://forums.embarcadero.com/message.jspa?messageID=467842\" rel=\"nofollow\">https://forums.embarcadero.com/message.jspa?messageID=467842</a></p>\n\n<p>For sake of completeness, here's the pertinent extract from the .dfm file</p>\n\n<pre><code>object ToolButton1: TToolButton\n  Left = 0\n  Top = 0\n  ImageIndex = 0\nend\nobject ToolButton2: TToolButton\n  Left = 23\n  Top = 0\n  Width = 16\n  ImageIndex = 1\n  Style = tbsDivider\nend\nobject ToolButton3: TToolButton\n  Left = 39\n  Top = 0\n  ImageIndex = 1\nend\nobject ToolButton4: TToolButton\n  Left = 62\n  Top = 0\n  Width = 16\n  ImageIndex = 2\n  Style = tbsDivider\nend\nobject ToolButton5: TToolButton\n  Left = 78\n  Top = 0\n  ImageIndex = 2\nend\n</code></pre>\n"},{"tags":["delphi","delphi-7"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":109,"score":2,"question_id":12656296,"title":"How can I repeat a song?","body":"<p>I have a TMediaPlayer called MediaPlayer1 I then open a file(a song) I play it.\nnow my problem is that I need the song to repeat until the program stops.</p>\n\n<p>The idea is that the form activates and then repeats the specified song until the form is closed.</p>\n\n<pre><code>MediaPlayer1.Filename := 'filename';\n</code></pre>\n\n<p>Then it opens it</p>\n\n<pre><code>MediaPlayer1.Open;\n</code></pre>\n\n<p>Then it plays it</p>\n\n<pre><code>MediaPlayer1.Play;\n</code></pre>\n\n<p>So now the song is playing but when it ends I want it to play again(repeat) and then again until the form is closed.</p>\n\n<p>I tried what David Heffernan said but it does not work, I think I did something wrong can someone pleas correct me.</p>\n\n<pre><code>unit Unit1;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, MPlayer, StdCtrls;\n\ntype\n  TForm1 = class(TForm)\n    MediaPlayer1: TMediaPlayer;\n    Label1: TLabel;\n    procedure FormActivate(Sender: TObject);\n    procedure MediaPlayer1Notify(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n\n{$R *.dfm}\n\nprocedure TForm1.FormActivate(Sender: TObject);\nbegin\n mediaplayer1.FileName:='E:\\it project\\mario.mid';\n mediaplayer1.Open;\n mediaplayer1.AutoRewind:=true;\n mediaplayer1.Play;\n mediaplayer1.Notify:=true;\nend;\n\nprocedure TForm1.MediaPlayer1Notify(Sender: TObject);\nbegin\n  if MediaPlayer1.NotifyValue=nvSuccessful then begin\n    MediaPlayer1.Play;  \n    MediaPlayer1.Notify := True;\n  end;\nend;\nend.\n</code></pre>\n"},{"tags":["delphi","generics","interface","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":99,"score":1,"question_id":12660279,"title":"Can I create a generic list of a particular interface in Delphi?","body":"<p>In C# I can create a generic list that contains a specific Interface, such as:</p>\n\n<pre><code>myList = List&lt;IMyInterface&gt;;\n</code></pre>\n\n<p>Can I do the same thing in Delphi XE3, and if so how?</p>\n\n<p>I know I can create a TInterfaceList to store a list of interfaces but it's not strongly typed\nso I would still need to cast when using objects in the list.</p>\n\n<p>Is there a strongly typed way of doing this?</p>\n"},{"tags":["delphi","batch-file","delphi-xe"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":150,"score":7,"question_id":12660674,"title":"Run batch file from Delphi IDE","body":"<p>Does anybody know, is there any way (default or third-party) to start batch file which is opened in Delphi IDE editor, by keypress or button? </p>\n\n<p>I mean simply press, say, F9, and get cmd.exe window with my batch file, from editor, runnning in this window.</p>\n\n<p>In some older Delphi version, might be Delphi 5, batch files could be created as projects, so there it was really F9. However, in Delphi XE I see no such project \"type\".</p>\n"},{"tags":["delphi","networking","nat","upnp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12661452,"title":"Ports not getting mapped for P2P, help using nat-pmp","body":"<p>We have developed an app which primarily provides udp P2P connectivity with other hosts around the world. So we have to deal with all kinds of nat topologies.</p>\n\n<p>I have tried udp hole punching and upnp for port forwarding.</p>\n\n<p>udp port punching successfully occurs only when the clients are behind the same nat, and upnp is marred by its lack of support on different routers.</p>\n\n<p>Entering ports manually in NAT table isn't the way as it is quiet difficult for noobs.</p>\n\n<p>I was thinking of nat-pmp but couldn't find any code related help around, can someone please help.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":12661263,"title":"Unable to pass a function reference to a form from a frame","body":"<p>I have an application that I am building, that has a PageControl with several created TabSheets, on which I place on of several pre-defined frames.  There is a routine in each frame called \"GetValue\" that parses the contents of it's controls into a string and returns the result.  On the main form (RGMain) I have:</p>\n\n<pre><code>Type\n   TGetValueFunction = Function: String;\n...   \nPrivate\n   fGetValueFunction: TGetValueFunction;\n...      \nPublic\n   Property GetValueFunction: TGetValueFunction Write fGetValueFunction;\n</code></pre>\n\n<p>In each of the Frames I have:</p>\n\n<pre><code>Public\nConstructor Create(AQwner: TComponent);\n...\nInterface\nConstructor TBooleanChoiceFrame.Create(AOwner: TComponent);\n   Begin\n   Inherited Create(AOwner);\n   RGMain.GetValueFunction := GetValue; &lt;&lt;&lt;&lt; compile error on this line\n   End;\n</code></pre>\n\n<p>E2009 Incompatble types: 'regular procedure and method pointer'</p>\n\n<p>Beyond correcting the problem, is this even the correct way to solve the problem of getting access to the GetValue routine in each frame?</p>\n"},{"tags":["delphi","mask"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":215,"score":3,"question_id":12619235,"title":"File Masking in delphi","body":"<p>I am trying to find all files that have the extenstion .cbr or .cbz</p>\n\n<p>If i set my mask to *.cb?   </p>\n\n<p>it finds *.cbproj files.  How can i set the mask to only find .cbr and .cbz files?</p>\n\n<p>here is code i am using.</p>\n\n<p>I have two edit boxes EDIT1 is the location to search, EDIT2 is where i put my mask. A listbox to show what it found and a Search button. </p>\n\n<pre><code>edit1 := c:\\\nedit2 := mask (*.cb?)\n</code></pre>\n\n<p>space</p>\n\n<pre><code>    procedure TFAutoSearch.FileSearch(const PathName, FileName : string; const InDir : boolean);\nvar Rec  : TSearchRec;\n    Path : string;\nbegin\nPath := IncludeTrailingBackslash(PathName);\nif FindFirst(Path + FileName, faAnyFile - faDirectory, Rec) = 0 then\n try\n   repeat\n     ListBox1.Items.Add(Path + Rec.Name);\n   until FindNext(Rec) &lt;&gt; 0;\n finally\n   FindClose(Rec);\n end;\n\nIf not InDir then Exit;\n\nif FindFirst(Path + '*.*', faDirectory, Rec) = 0 then\n try\n   repeat\n    if ((Rec.Attr and faDirectory) &lt;&gt; 0)  and (Rec.Name&lt;&gt;'.') and (Rec.Name&lt;&gt;'..') then\n     FileSearch(Path + Rec.Name, FileName, True);\n   until FindNext(Rec) &lt;&gt; 0;\n finally\n   FindClose(Rec);\n end;\nend; //procedure FileSearch\n\n\n\nprocedure TFAutoSearch.Button1Click(Sender: TObject);\nbegin\n  FileSearch(Edit1.Text, Edit2.Text, CheckBox1.State in [cbChecked]);\nend;\n\nend.\n</code></pre>\n"},{"tags":["delphi","gis","postgis","spatialite"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":137,"score":2,"question_id":12649732,"title":"Is there Delphi support for GIS specialized databases?","body":"<p>Such as <a href=\"http://postgis.refractions.net/\" rel=\"nofollow\">PostGIS</a> and <a href=\"http://www.gaia-gis.it/gaia-sins/\" rel=\"nofollow\">SpatiaLite</a>?</p>\n\n<p>I am using AnyDac, which does not provide support. Are there any other components which can make life easier for me when working with such GIS enabled databses in Delphi?</p>\n\n<hr>\n\n<p>[Update] If not an you want one, then please post requierments to <a href=\"http://stackoverflow.com/questions/12657702/what-features-should-an-interface-component-to-gis-databases-have\">my other question</a>. Thank you.</p>\n"},{"tags":["delphi","interface","scheduled-tasks"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":12376630,"title":"ITaskService interface Access Violation","body":"<p>I have a peculiar problem with the Task Scheduler interfaces and I would be very happy if someone could help.</p>\n\n<p>A part of my application reads the items from the Task Scheduler. Under XP I use the Task Scheduler v1.0 interfaces from a unit from JEDI Library.\nUnder Vista and Win7 I used the TaskSchd.pas unit found in <a href=\"http://teran.karelia.pro/articles/item_4443.html\" rel=\"nofollow\">this article</a>. It contains the definitions for the new 2.0 interfaces.\nI use Delphi XE2, Update 4.</p>\n\n<p>The problem is that I get an Access Violation when I call the Connect method of the ITaskService interface.\nThe error message is <em>\"First chance exception at $0055C73C. Exception class $C0000005 with message 'access violation at 0x0055c73c: read of address 0x0000000b'.\"</em></p>\n\n<p>The code I use is:</p>\n\n<pre><code>procedure TSomeClass.TaskScheduler(...);\nvar\n  TS : ITaskService;\n  TaskFolder : ITaskFolder;\nbegin\n  TS := CoTaskScheduler.Create();\n  TS.Connect('', '', '', '');\n  ......\nend;\n</code></pre>\n\n<p>The code is in a separate unit in a class descendant from TObject.\nThis is enough to cause AV, even without doing anything else with the interface. The AV happens when the function exits though, not at the Connect line, so it might be related to the releasing of the object.</p>\n\n<p>I have ran some tests, but could not find where the problem is. Here is what is strange:</p>\n\n<ul>\n<li>The AV happens only in Release builds, in Debug it works properly</li>\n<li>If I turn off Optimization in Project Options > Compiling then again the code works. If I turn it on in Debug build, the code stops working.</li>\n<li>If I place this in some method in the main form, it works again.</li>\n<li>I have called CoInitialize, but it does not have any effect</li>\n<li>I tried to duplicate it in a blank new app, but I could not, so it is somehow related to another unit or class in the application </li>\n</ul>\n\n<p>It is probably something very simple that I am missing about interfaces, but I have not been able to find it.\nThe code otherwise works, I can get and display the list of tasks. The problem comes when the Compiling > Optimizations option is turned on, which is the default for the Release build.</p>\n\n<p>One solution would be to just turn off the Optimizations, but I would rather find the cause of the problem.</p>\n\n<p><strong>Edit:</strong> I have included additional info about the AV, CoInitialize, Delphi and the ITaskService header file.</p>\n"},{"tags":["delphi","usercontrols","calendar","scheduling"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":570,"score":3,"question_id":7882803,"title":"Looking for a scheduling/calendar component","body":"<p>I'm looking for a custom visual component for Delphi 7 which handles scheduling on a calendar. I'm not looking for an actual calendar, and I'm definitely not looking for some overhauled licensed component. I just want a simple visual component, with a trackbar-like list of items. For example, along the left, I could have employee names listed. Each of those records stretches across the control. To the right, the X axis represents time, and each employee (Y Axis) record could have multiple time periods (start..finish), which are not only displayed to the right of the employee, but also user can resize each period, drag them, delete them, etc. It's obviously going to be used for that exact purpose, for scheduling employee hours. I don't need anything which is integrated with anything else, such as database, I can do all that work myself. I just want a simple control that can be used for visually creating such a schedule.</p>\n"},{"tags":["performance","delphi","data-binding","virtualization","delphi-xe3"],"answer_count":0,"favorite_count":5,"up_vote_count":7,"down_vote_count":0,"view_count":172,"score":7,"question_id":12658470,"title":"Live Binding with Automatic updates in XE3 (no need to call Notify() as in XE2)","body":"<p>I am currently using Delphi XE2, and heard about their new Live Binding with Automatic updates in XE3 (no need to call Notify() as in XE2).</p>\n\n<p>in C# or in Delphi XE2 we have to implement <code>INotyfiablePropertyChange</code> (<code>Notify();</code> in Delphi), and this approach really makes sense as we have full control over the contents to be updated and when to update it so we can fine tune the performance and implement virtualization easily.</p>\n\n<p>But I just want to know how does it works, what kind of mechanism they have done in order to implement it, and i have no clue how they have did it, following are the assumptions may have used to implement Automatic updates.</p>\n\n<ol>\n<li><p>Timer : A timer tick frequently and refreshes all the data </p>\n\n<blockquote>\n  <p><em>Very slow performance no virtualisation</em></p>\n</blockquote></li>\n<li><p>Compiler Level Feature : All the <code>notify() events</code> related codes implemented by the compiler auto-magically </p>\n\n<blockquote>\n  <p><em>Lots of over heads</em></p>\n</blockquote></li>\n<li><p>Somme other Approach: </p></li>\n</ol>\n\n<p>Please help me to identified how they have implemented it.</p>\n\n<p>I am currently using XE3 trial so i don't have access to the source code, <strong>your answers will help me decide whether to switch to new features or not</strong>.  I have a class(collection item) with 400 properties to bind(Not all of them all the time), so the performance really plays a major role in the stability of my application.  </p>\n"},{"tags":["delphi","network-programming","polling","ping","iocp"],"answer_count":5,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":3626,"score":7,"question_id":4886691,"title":"What's the best way to ping many network devices in parallel?","body":"<p>I poll a lot of devices in network (more than 300) by iterative ping.</p>\n\n<p>The program polls the devices sequentially, so it's slow.\nI'd like to enhance the speed of polling.</p>\n\n<p>There some ways to do this in Delphi 7:</p>\n\n<ol>\n<li>Each device has a thread doing ping. Manage threads manually.</li>\n<li>Learn and use Indy 10. Need examples.</li>\n<li>Use overlapped I/O based on window messages.</li>\n<li>Use completion ports based on events.</li>\n</ol>\n\n<p>What is faster, easier? Please, provide some examples or links for example.</p>\n"},{"tags":["delphi","inheritance","properties","setter"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":85,"score":4,"question_id":12656417,"title":"Add setter to property in descendant class","body":"<p>I have two Delphi classes.  The parent class declares a string field FSSN and matching property SSN with accessors that read and write the field directly.  In my child class I want to redeclare the property SSN to use a setter from the child class (to transform the SSN if possible before writing it to the field).</p>\n\n<p>The property SSN will be set by a method of the parent class, but (if the instance is an instance of the child class) I want the <em>child</em> setter to be called.  When I run the code, however, I never enter the child setter and the field appears to be set directly using the property declaration in the parent.</p>\n\n<p>Can this be done?</p>\n\n<p>(I realize I could accomplish this by introducing the setter procedure in the parent class and overriding in the child; I'd rather not disturb the parent class if possible).</p>\n\n<p>Here's what I have so far (in a drastically simplified version, of course):</p>\n\n<pre><code>TCustomPerson = class(TObject)\n  protected\n    FSSN: String;\n  public\n    procedure LoadFromXML(ANode: IXMLNode);\n    property SSN: String read FSSN write FSSN;\n\nTMyPerson = class(TCustomPerson)\n  protected\n    procedure SetSSN(ASSN: String);\n  public\n    property SSN: String read FSSN write SetSSN; // &lt;=== Setter introduced.\n\n procedure TCustomPerson.LoadFromXML(ANode: IXMLNode);\n var ThisSSN: String;\n begin\n    //extract SSN from XML into ThisSSN\n    SSN := ThisSSN;                             // Expect to invoke SetSSN.\n end\n\nprocedure TMyPerson.SetSSN(ASSN: String);\nbegin\n    FSSN := ValidateSSN(ASSN);                  // &lt;== Breakpoint here never reached.\nend\n</code></pre>\n"},{"tags":["performance","delphi"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12656104,"title":"Catching the message before InsertControl procedure","body":"<p>I try to create huge number of TWinControl (100 000) at runtime. It goes quickly. But if I change the type to TCustomControl (which has useful property Canvas), it goes pretty slow. The reason for it is, that constructor of TCustomControl creates TControlCanvas too, and it slows down the process significantly. \nMy idea is to make a descendant of TWinControl, which would create TControlCanvas only, when it is inserted on the form. (This huge number is not inserted implicitly)</p>\n\n<p>Is it possible to catch event before (or right after) the descendant is inserted? </p>\n\n<p>Thanx for ideas</p>\n"},{"tags":["delphi","firemonkey"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":102,"score":5,"question_id":12635372,"title":"How to create the radial gradient in Firemonkey","body":"<p>I have a FireMonkey form with the following code on the OnPaint event of the form. I was expecting a ball with a radial gradient but I only get a red ball, no gradient. Question is what am I doing wrong. Running it on XE3. If I change the gradient style to gsLinear, I do get a linear gradient. Is there something else I have to specify to get the radial gradient to show?</p>\n\n<pre><code> procedure TForm2.FormPaint(Sender: TObject; Canvas: TCanvas; const ARect: TRectF);\n var MyRect : TRectF;\n begin\n   MyRect.Create (85, 85, 115, 115);\n\n   Canvas.Fill.Gradient.Style := TGradientStyle.gsRadial;\n   Canvas.Fill.Gradient.Color := claRed;\n   Canvas.Fill.Gradient.Color1 := claBlue;\n   Canvas.Fill.Kind := TBrushKind.bkGradient;\n   Canvas.FillEllipse (MyRect, 100);\n end;\n</code></pre>\n"},{"tags":["delphi","memory","free","multi-dimensional"],"answer_count":1,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":135,"score":4,"question_id":12654320,"title":"How to Free Memory when Out-of-memory exception occurs in Delphi using SetLength","body":"<p>I have a piece of Delphi code</p>\n\n<pre><code>var\n  a: array of array of array of integer;\nbegin\n  try\n   SetLength(a, 100000, 100000, 10000); // out of memory here\n   doStuffs(a); \n  except\n   a = nil; // try to free the memory \n  end;\nend;\n</code></pre>\n\n<p>The above code tries to allocate lots of memory and <code>out-of-memory</code> will be caught. The <code>a=nil</code> will be executed, but the memory isn't freed.</p>\n\n<p>Is there a way to free the memory in the case of out-of-memory exception?</p>\n\n<p>I tried <code>SetLength(a, 0, 0, 0)</code> and <code>Finalize(a)</code>, and both won't work either.</p>\n"},{"tags":["c#","delphi","pinvoke","delphi-2010"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":109,"score":2,"question_id":12652936,"title":"Send binary data from a Delphi DLL do a C# App","body":"<p>I have a Delphi 2010 DLL that will be used to compress some data from a C# APP. The DLL function looks like this:</p>\n\n<pre><code>function CompressString(aInputString: PAnsiChar; aInputStringSize: Integer; \n  var aOutPutString: PAnsiChar; var aOutPutStringSize: Integer; \n  var aErrorMsgBuffer: PAnsiChar; var aErrorMsgBufferSize: integer): Integer; \n  stdcall; export;\n</code></pre>\n\n<p>The C# method looks like this:</p>\n\n<pre><code>[DllImport(\"MyDLL.dll\", CallingConvention=CallingConvention.StdCall, CharSet=CharSet.Ansi)]\npublic static extern int CompressString(string aInputString, \n  int aInputStringSize, ref string aOutPutString, \n  out int aOutPutStringSize, ref string aErrorMsgBuffer, \n  out int aErrorMsgBufferSize);\n</code></pre>\n\n<p>My problem is that <code>aOutPutString</code> is being truncated, only part of the data is being seen by the C# App. If I change <code>aOutPutString</code> inside the Delphi DLL to be a simple literal constant (only for testing) it works fine.</p>\n\n<p>Inside the DLL, I am working with strings. In the end of the function, I call:</p>\n\n<pre><code>StrPCopy(aOutPutString, vOutOutAnsiStr);\n</code></pre>\n\n<p>To convert an <code>AnsiString</code> do <code>PAnsiChar</code>.</p>\n\n<p>I guess I should not be using <code>PAnsiChar</code> but an <code>array of byte</code>, but I am not sure how to do that.</p>\n"},{"tags":["multithreading","delphi","listbox","item"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":235,"score":1,"question_id":11547928,"title":"How to use thread Delphi","body":"<p>I work for a few days of this application. Form freezes until the entire transaction. How do I use Tread?</p>\n\n<pre><code>procedure TForm1.ListBox1Click(Sender: TObject);\nvar\n  I: Integer;\n  S: String;\n\n  begin\n\n   I := Listbox1.ItemIndex;\n\n    if I &lt;&gt; -1 then\n    begin\n    S := Listbox1.Items[I];\n    IdHTTP1.ProxyParams.ProxyServer := Fetch(S, ':');\n    IdHTTP1.ProxyParams.ProxyPort := StrToInt(S);\n\n    try\n\n    IdHTTP1.ReadTimeout:=strtoint(form1.ComboBox1.Text); // ZMAAN AŞIMI\n   IdHTTP1.Get(Edit4.Text);                         // POST GET\n\n  Memo1.Lines.Add(Format('Sıra %d %s', [I, 'Bağlandı.']));\n\n except\n\n Memo1.Lines.Add(Format('Sıra %d %s', [I, 'Bağlanamadı.']));\n\nIdHTTP1.Disconnect;   // ÖLDÜR.\nend;\nend;\nend;\n\nprocedure TForm1.Timer1Timer(Sender: TObject);\nbegin\n   Timer1.Enabled := False;\n  try\n    ListBox1Click(nil);\n    if ListBox1.ItemIndex &lt; ListBox1.Items.Count - 1 then\n      ListBox1.ItemIndex := ListBox1.ItemIndex + 1\n    else\n      ListBox1.ItemIndex := -1;\n   finally\n    Timer1.Enabled := True;\n  end;\n\n  if ListBox1.ItemIndex = -1 then\nTimer1.Enabled:=false;\n\nend;\n\n\nprocedure TForm1.BitBtn2Click(Sender: TObject);\nbegin\n  Timer1.Enabled := true;\nend;\n</code></pre>\n\n<p>Thank you in advance.</p>\n"},{"tags":["delphi","tdbgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12652955,"title":"Delphi 7 - TDBGrid style","body":"<p>How to use stylized table in Delphi 7?\nFor example:</p>\n\n<p><img src=\"http://i.stack.imgur.com/MuaTb.png\" alt=\"enter image description here\"></p>\n"},{"tags":["windows","delphi","winapi"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12652717,"title":"Create shortcut with Delphi and specify its privilege level","body":"<p>I am using the following code to make shortcuts in Delphi. I want to make a shortcut with \"Run this program as an administrator\" box checked in Privilege Level properties of shortcut. Is there any way to do this?</p>\n\n<pre><code>function MakeShortcut(Dst, Src: String; Desc: String = ''; Arg: String = ''; WorkDir: String = ''; Icon: String = ''; IconI: Integer = 0; Show: Integer = SW_SHOWNORMAL; HotKey: Word = 0): Boolean;\nvar\n  u: IUnknown;\n  s: IShellLink;\n  f: IPersistFile;\n  p: WideString;\nbegin\ntry\n  u := CreateComObject(CLSID_SHELLLINK);\n  s := u as IShellLink;\n  f := u as IPersistFile;\n  s.SetPath(PChar(Src));\n  if (WorkDir = '') then WorkDir := ExtractFileDir(Src);\n  s.SetWorkingDirectory(PChar(WorkDir));\n  if (Icon = '') then Icon := Src;\n  s.SetIconLocation(PChar(Icon), IconI);\n  s.SetDescription(PChar(Desc));\n  s.SetArguments(PChar(Arg));\n  s.SetShowCmd(Show);\n  s.SetHotkey(HotKey);\n  p := Dst;\n  Result := Succeeded(f.Save(PWChar(p), False));\nexcept\n  Result := False;\nend;\nend;\n</code></pre>\n"},{"tags":["delphi","opos"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":170,"score":-1,"question_id":12649626,"title":"Using OPOS in Delphi","body":"<p>when I use TOPOSPOSPrinter.open using OPOS an \"Interface Not Supported\" error message comes up</p>\n\n<p>I try to use a printer IBM4610 but when i use the driver OPUS this problem results.</p>\n\n<p>The code compile.</p>\n\n<p>CODE</p>\n\n<pre><code>function TCustomizedTenderPlugin.HandleEvent: WordBool;\nvar\n\n  ret:Integer;\n\n  mic : Pointer;\n\n  {pruebas con opos}\n  PosPrinter: TOPOSPOSPrinter;\n\n\n\nbegin\n  {CREDENCIALES DE LA IMPRESORA . MODIFICAR DEPENDIENDO DEL TIPO}\n   CargarIni(puerto);    \n\n      try\n         {Conexion con impresora}\n         PosPrinter:= TOPOSPOSPrinter.Create(nil);\n         PosPrinter.Open('4610_IBM',ret); // AQUI DA ERROR\n         ShowMessage(VarToStr(ret));\n         PosPrinter.Close(ret);\n         ShowMessage(VarToStr(ret));\n      Except\n        // mensaje de error del \n\n        // me da Interface not supported\n      end;\n\n\nend;\n</code></pre>\n\n<p>Please I need help.</p>\n\n<p>Thanks for your kind help :)</p>\n"},{"tags":["delphi","delphi-xe2","firebird","datasnap","tclientdataset"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":234,"score":4,"question_id":12047797,"title":"Obtain Trigger generated values after ApplyUpdates with a TClientDataSet","body":"<p>I have a (Firebird) DB.  For most of my tables I have a trigger which fires before insert which will create the Primary Key (PK) for me via a generator as well as write to the newly inserted records a Created Date value and a Created By value.  I also have an update trigger which writes to an Updated Date field and an Updated By field.</p>\n\n<p>eg (Client is a table in my DB):</p>\n\n<pre><code>create trigger t_client_id for client\nactive before insert\nas begin\n  new.client_id = gen_id(gen_client_id, 1);\n  new.created = current_timestamp;\n  new.created_by = current_user;\n  new.lock_vn = 1;\nend ^\n\ncreate trigger t_client_update for client\nactive before update\nas begin\n  new.updated = current_timestamp;\n  new.updated_by = current_user;\nend ^   \n</code></pre>\n\n<p>When I apply updates thru my ClientDataSet (CDS) - which are attached to remote TDataSetProviders via a TDSProviderConnection, how can I \"retrieve\" these generated values?  If I edit an existing one (which will in turn call the t_client_update trigger, calling RefreshRecord will get the updated and updated_by fields.  However, the Doco says to use that method cautiously, so that may not be the correct way to achieve this.  I call it straight after I've called ApplyUpdates(-1).</p>\n\n<p>The CDS I use only contains the one record I am attempting to Edit.  For a New record, the CDS is in dsInsert mode.  Everything is written to the DB ok so I just need to get this new data back out again.  I have also tried using a CDS which contains ALL records in the table too to see if it was any simpler but didn't make any difference - unsurprisingly.  The reason I need this information is simply to show to the user in DB Aware controls these values.  They are read only.</p>\n\n<p>I could call a Get on the record I guess when editing an existing record, using the PK, but that won't help for an Insert as I don't know what the new PK is.  </p>\n\n<p>Example of where I attempt to ApplyUpdates to my CDS (actDSSave is a TDataSetPost action)</p>\n\n<pre><code>  dsState := actDSSave.DataSource.DataSet.State;\n  DoApplyUpdates(-1);\n  if dsState = dsEdit then\n    TClientDataSet(actDSSave.DataSource.DataSet).RefreshRecord;\n</code></pre>\n\n<p>I am using TIBQuery for my dataset attached to the remote DataSetProvider.  This query SQL is a simple <strong>select * from client where client_id = :client_id</strong>.  I have tried associating this query with a TIBUpdateSQL too as well as trying to set poAutoRefresh to true in the DataSetProvider.</p>\n\n<p>So is it possible to obtain these Trigger generated values this way or do I need to approach it in a different way? Another way I can think of, is to create stored procedures which do CRUD against each table and use that instead (with appropriate in/out params to return this new data) but hopefully I don't have to go down that track. Hopefully I have provided sufficient info here to explain and replicate the issue.  </p>\n\n<p>Thanks</p>\n\n<p><strong>EDIT</strong>\nRealised in above, DoApplyUpdates(-1) is my own method.  It's implementation at the moment is simply:</p>\n\n<pre><code>FdatCommon.cdsClient.ApplyUpdates(MaxErrorCount);\n</code></pre>\n\n<p>FdatCommon is a TDataModule containing my CDS.</p>\n"},{"tags":["delphi","dll","dllimport"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":144,"score":1,"question_id":12648387,"title":"Using C dll in delphi return nothing","body":"<p>I have been trying to reuse a C dll file in delphi based on this <a href=\"http://maxdb.sap.com/documentation/sqldbc/SQLDBC_API/SQLDBC__C_8h.html#a252\" rel=\"nofollow\">documentation</a>. </p>\n\n<p>Server was running well, i could access and used the database on local server with \njava and php.</p>\n\n<p>On delphi i used dynamic load and worked well on all functions that return variables but failed on those that return interface.</p>\n\n<pre><code>unit for library :\nunit SQLDBC_C;\n\ninterface\nuses windows, classes, sysutils;\n\ntype\n  SQLDBC_IRuntime = interface\n  end;\n\nvar\n  getSDKVersion : function :Pchar; stdcall;\n  ClientRuntime_GetClientRuntime: function (errorText:Pchar; errorTextSize:Integer) : SQLDBC_IRuntime; stdcall;\n\nimplementation\n\nvar\n  libhandle : THandle;\n\nprocedure initLibrary;\nbegin\n  libhandle := LoadLibrary('libSQLDBC_C.dll');\n  if libhandle&gt;=23 then begin\n     @getSDKVersion:=GetProcAddress(libhandle,'getSDKVersion');\n     @ClientRuntime_GetClientRuntime:=\n        GetProcAddress(libhandle,'ClientRuntime_GetClientRuntime');\n  end;\nend;\n\ninitialization\nbegin\n  initLibrary;\nend;\n\nfinalization\nbegin\n  if libhandle&gt;=32 then\n    FreeLibrary(libhandle);\nend;\n\nend.\n</code></pre>\n\n<p>here is the test procedure :</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nvar\n  err : array [0..200] of char;\n  rt : SQLDBC_IRuntime;\n\nbegin\n  Memo1.Clear;\n  FillChar(err, sizeof(err), 0);\n  Memo1.Lines.Add(getSDKVersion); //this function successed\n\n  rt := ClientRuntime_GetClientRuntime(@err,200); \n  //this function had no return value, (rt always nil) but no error return at err variable\n  if assigned(rt) then begin\n    ......\n  end;\nend;\n</code></pre>\n\n<p>I've read the similar problems asked by <a href=\"http://stackoverflow.com/questions/2266417/delphi-calling-a-function-from-a-vc-dll-that-exports-a-interface-class\">geskill</a>, <a href=\"http://stackoverflow.com/questions/6629852/delphi-interface-from-dll\">Dan Hacker</a>, <a href=\"http://stackoverflow.com/questions/8846545/is-it-safe-to-use-interfaces-from-dll\">max</a> and <a href=\"http://stackoverflow.com/questions/4798283/calling-dlls-with-pointers-in-delphi\">Ron</a> but it could not solve my problem.</p>\n\n<p>Could anyone told me what's wrong here?</p>\n"},{"tags":["mysql","delphi","proxy","zeos"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":82,"score":5,"question_id":12605773,"title":"Redirect TCP MySQL connection to proxy","body":"<p>I have a Delphi application which connects to a MySQL published database on Internet with address like mysql01.xxx.com:3306.</p>\n\n<p>However, my client computer is behind a proxy and I just can connect if I pass by the proxy. I use the ZeosLib to connect and it doesn't have proxy authentication.</p>\n\n<p>Is it possible to forward connection to the proxy using some kind of proxy forward program? Is there another possibility to solve this problem?</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["delphi","loops","delphi-7"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":12637058,"title":"on my delphi 7 application one part of the code freezes or disables the rest of the things on the form","body":"<p>My application should generate a random sum calculate the answer then put it in a edit box on a panel and then the panel should move down and repeat (I have done all of this). OK the problem is while the panel is moving down nothing else works it is as if everything is disabled.</p>\n\n<pre><code>unit Unit5;\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,\n  Dialogs, jpeg, ExtCtrls, StdCtrls, math, Buttons;\n\ntype\n  TForm1 = class(TForm)\n    Image1: TImage;\n    Panel1: TPanel;\n    Edit1: TEdit;\n    Panel6: TPanel;\n    Shape1: TShape;\n    Panel7: TPanel;\n    Label1: TLabel;\n    Edit6: TEdit;\n    Label2: TLabel;\n    Button1: TButton;\n    Image5: TImage;\n    Edit7: TEdit;\n    Image2: TImage;\n    Label3: TLabel;\n    Timer1: TTimer;\n    procedure FormActivate(Sender: TObject);\n    procedure Button1Click(Sender: TObject);\n    procedure Image2Click(Sender: TObject);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nvar\n  Form1: TForm1;\n\nimplementation\n var hori : integer;\n     vert : integer;\n     back : integer;\n     value1 : integer;\n     value2 : integer;\n     answer : integer;\n     star: integer;\n     stranswer: string;\n     k : integer;\n{$R *.dfm}\n\nprocedure TForm1.FormActivate(Sender: TObject);\nbegin\n panel1.hide;\n panel7.Hide;\n back:=0;\n star:=0;\n end;\n\nprocedure TForm1.Button1Click(Sender: TObject);\nbegin\n stranswer:= inttostr(answer);\n if edit6.Text=stranswer then\n begin\n  star:=star+1;\n  edit7.text:=inttostr(star);\n\n end;\n button1.Caption:='Next';\n panel7.Show;\n edit6.SetFocus;\n panel1.show;\n randomize;\n hori:=random(840);\n value1:=random(10);\n value2:=random(10);\n panel1.Top:=0;\n panel1.Left:=hori;\n update;\n answer:=value1+value2;\n edit1.text:=('                '+inttostr(value1)+' + '+inttostr(value2));\n for k:= 1 to 512 do\n  begin\n   vert:= vert+1;\n   panel1.Top:= vert;\n   update;\n   sleep(50)\n  end;\nend;\n\nprocedure TForm1.Image2Click(Sender: TObject);\nbegin\n  back:=1;\n  form5.Close;\n  button1.show;\nend;\n\nend.\n</code></pre>\n\n<p>If you want I can send you a picture of the form.\nIf you can please help me.</p>\n"},{"tags":["delphi","delphi-7","pascal","with-statement"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":189,"score":1,"question_id":12642524,"title":"If I create an object in a \"with\" clause, do I still need to free it?","body":"<p>In my source I see and use often a construction like:</p>\n\n<pre><code>with TSQLDataSet.Create(nil) do try\n  //Dosomething, get a result from a query.    \nfinally\n  Free;\nend;\n</code></pre>\n\n<p>But I also often see the construction: </p>\n\n<pre><code>with TSQLDataSet.Create(nil) do begin\n  //Dosomething, get a result from a query.    \nend;\n</code></pre>\n\n<p>If I create objects with a with contruction, do I need to free them or is that automatic at the end of the with-block?</p>\n"},{"tags":["delphi","postgresql","delphi-7"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":127,"score":1,"question_id":12598957,"title":"Convert hex to string when read from registry","body":"<p>I'm working with Delphi 7 application and BDE (legacy software).\nwhenever the password is changed/saved from ODBC admin\nlike this (example if the password was  <code>my,password</code> )</p>\n\n<p><img src=\"http://i.stack.imgur.com/vDnRa.jpg\" alt=\"enter image description here\"></p>\n\n<p>It gets saved as <code>my%2cpassword</code> in the registry.</p>\n\n<p><img src=\"http://i.stack.imgur.com/5VtC6.jpg\" alt=\"enter image description here\"></p>\n\n<p>And my application reads the registry path </p>\n\n<blockquote>\n  <p>HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\mysource<br>\n   Password</p>\n</blockquote>\n\n<p>then uses the password to execute a psql command,</p>\n\n<pre><code>   \"C:\\Program Files (x86)\\PostgreSQL\\9.0\\bin\\psql.exe\"  -h localhost -p 5432 -d myDB -U myadmin -f \"C:\\Users\\user\\AppData\\Roaming\\ff.sql\"\n</code></pre>\n\n<p>Since the password now has <code>%2c</code> inside it instead of <code>,</code> the authentication fails.\nAs I read the password and write to the <code>pgpass.conf</code> file.</p>\n\n<p>How to convert the Hex characters to proper string when the HEX character are mixed with normal character?</p>\n"},{"tags":["delphi","delphi-xe2","google-drive-sdk"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":107,"score":2,"question_id":12609419,"title":"503 error with multipart upload GoogleDrive Api v2","body":"<p>I'm attempting to work with the Google Drive API in Delphi XE2, and thus far, I have just about everything working. One thing I'm struggling with is the multipart upload. When I attempt to upload a file, I get a 503 error. Normally, that should indicate a problem with the server. However, when I send an upload request with the same body and headers to the same URL using fiddler rather than my API, the file is uploaded successfully. This tells me there has to be a problem with my code. This particular function is a mess, but here it is.</p>\n\n<pre><code>function TGoogleDriveApi.MultipartUpload(aStream : TStream; aTitle : string = 'Untitled';\n  aDescription : string = ''; mimeType : string = 'application/octet-stream';\n  indexableText : IGoogleDriveIndexableText = nil;\n  lastViewedByMeDate : string = ''; modifiedDate : string = '';\n  parents : IGoogleDriveParentList = nil) : IGoogleDriveFile;\nvar\n  json, url, body, boundry, contentType : string;\n  ss : TStringStream;\n  ms : TMemoryStream;\n  lHttpHelper : IHttpHelper;\n  streamBytes : TBytes;\nbegin\n  boundry := 'a_boundry';\n  body := '--'+boundry+sLineBreak;\n  body := body + 'Content-Type: application/json; charset=UTF-8';\n  lHttpHelper := THttpHelper.Create;\n  if(Token.IsExpired) then\n    Token.Refresh(TokenUrl, OAuth.ClientId, OAuth.ClientSecret);\n  url := 'https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart&amp;access_token='+lHttpHelper.UrlEncode(Token.access_token);\n  json := '{';\n  json := json + '\"title\": \"'+aTitle+'\"';\n  if(aDescription &lt;&gt; '') then\n    json := json + ', \"description\": \"'+aDescription+'\"';\n  if(lastViewedByMeDate &lt;&gt; '') then\n    json := json + ', \"lastViewedByMeDate\": \"'+lastViewedByMeDate+'\"';\n  json := json + ', \"mimeType\": \"'+mimeType+'\"';\n  if(modifiedDate &lt;&gt; '') then\n    json := json + ', \"modifiedDate\": \"'+modifiedDate+'\"';\n  json := json + '}';\n  body := body + sLineBreak + sLineBreak + json + sLineBreak + sLineBreak + '--'+boundry;\n  body := body + sLineBreak + 'Content-Type: '+mimeType + sLineBreak  + sLineBreak;\n  body := body + 'some test text from the api' + sLineBreak + sLineBreak + '--'+boundry+'--';\n\n  ss := TStringStream.Create;\n  ss.WriteString(body);\n  ss.Position := 0;\n  ms := TMemoryStream.Create;\n  ms.Write(ss,ss.Size);\n  SetLength(streamBytes,aStream.Size);\n  aStream.Read(streamBytes,aStream.Size);\n  ms.Write(streamBytes[0],aStream.Size);\n  ss.Clear;\n  ss.Position := 0;\n  ss.WriteString(sLineBreak + sLineBreak + '--'+boundry+'--');\n  ss.Position := 0;\n  ms.Write(ss,ss.Size);\n\n  contentType := 'multipart/related; boundary=\"'+boundry+'\"';\n  json := lHttpHelper.PostResponse(url,contentType,ms);\n  FreeAndNil(ss);\n  FreeAndNil(ms);\n  Result := nil;\nend;\n</code></pre>\n\n<p>The line that causes problems is the <code>lHttpHelper.PostResponse</code> call. The code for that is shown here:</p>\n\n<pre><code>function THttpHelper.PostResponse(url, contentType : string; aStream : TStream) : string;\nvar\n  lHTTP: TIdHTTP;\n  lStream : TStringStream;\n  handler : TIdSSLIOHandlerSocketOpenSSL;\nbegin\n  lStream := TStringStream.Create;\n  lHTTP := TIdHTTP.Create(nil);\n  handler := TidSSLIOHandlerSocketOpenSSL.Create(nil);\n  handler.SSLOptions.Method := sslvSSLv3;\n  lHTTP.IOHandler := handler;\n  try\n    lHTTP.Request.ContentType := contentType;\n    lHTTP.Post(url,aStream,lStream);\n    lStream.Position := 0;\n    Result := lStream.ReadString(lStream.Size);\n      //except\n  finally\n    lStream.Free;\n    lHTTP.Free;\n    handler.Free;\n\n    lStream := nil;\n    lHTTP := nil;\n    handler := nil;\n  end;\nend;\n</code></pre>\n\n<p>I'm currently calling the <code>MultipartUpload</code> function from my test, shown here</p>\n\n<pre><code>procedure TestIGoogleDriveApi.TestMultipartUpload;\nvar\n  ReturnValue : IGoogleDriveFile;\n  fs : TFileStream;\nbegin\n  fs := TFileStream.Create('testupload.jpg',fmOpenRead);\n  ReturnValue := FIGoogleDriveApi.MultipartUpload(fs,'Test Multipart Image Upload from API.txt','test file','image/jpeg');\n  FreeAndNil(fs);\n  if(ReturnValue = nil) then\n    fail('ReturnValue cannot be nil');\nend;\n</code></pre>\n\n<p>Any ideas what might be causing the problems? I'm not even sure what to suspect at this point.</p>\n"},{"tags":["string","delphi","debugging","delphi-xe2","remote-debugging"],"answer_count":3,"favorite_count":3,"up_vote_count":52,"down_vote_count":0,"view_count":764,"score":52,"question_id":11631625,"title":"Remote debugging with XE2 - display of strings","body":"<p>I'm remote debugging a large app between DElphi XE2 (update #4) and a Windows XP target. PAServer is running on the target and the application works fine and stops at breakpoints (you would NOT believe how hard just that achievement was - hint - delete your DPROJ and start again if it has been through any IDE prior to XE).</p>\n\n<p>I notice that the display of local variables and watches show my strings in a strange format compared to the usual display of the 'some string' format that one sees when debugging locally. I see:</p>\n\n<p><img src=\"http://i.stack.imgur.com/kSq2Q.png\" alt=\"enter image description here\"></p>\n\n<p>Can anyone tell me why the strings are displayed this way? I also get quite a bit of { NULL } and garbage between {}'s on output variables that are not yet assigned.\nThanks.</p>\n\n<p>. I see that this format indicates wide strings. I tried a simple app on Windows 7 and got the following result. My App at a breakpoint:</p>\n\n<p><img src=\"http://i.stack.imgur.com/XyI23.png\" alt=\"enter image description here\"></p>\n\n<p>The displayed local string variables:</p>\n\n<p><img src=\"http://i.stack.imgur.com/q4FHB.png\" alt=\"enter image description here\"></p>\n\n<p>Note the truncated 'Hello'. It would seem that XE2 has a problem with remote unicode strings at times. My PaServer is version 1.0.2. Can anyone check that this is the latest? 'Twas taken from Update #4...</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":82,"score":3,"question_id":12646269,"title":"Delphi - Include TD32 Debug Info","body":"<p>I am using Delphi 5.0 and trying to make applcation compatible with Test Complete. For that I have to build my application by selecting the Project --> Project Options --> Linker -->Include TD32 Debug Info. This all works good, but question is there any disadvantage of including that debug info in application. One thing I have noticed is the applcation size is increased 3 times around. Please let me know how much safe it is to use application with selecting Include TD32 Debug Info.</p>\n\n<p>Thanks for help.. </p>\n"},{"tags":["delphi"],"answer_count":3,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":240,"score":9,"question_id":12627526,"title":"Is it possible to Alpha Blend a VCL control on a TForm?","body":"<p>Is it possible to implement Alpha Blend or similar effect on a VCL control on a TForm? </p>\n\n<p>For example, consider the following screenshot where there are two TPanels in addition to other controls. Both the panels are made draggable (<em>See</em> <a href=\"http://delphi.about.com/library/weekly/aa102505a.htm\" rel=\"nofollow\">How to Move and Resize Controls at Run Time</a>). </p>\n\n<p>Is it possible to make these panels translucent while being dragged so that you can see what is underneath?</p>\n\n<p><img src=\"http://i.stack.imgur.com/vmHm1.jpg\" alt=\"Sample form image\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/NuUMz.png\" alt=\"Solution proposed by TLama and Uwe Raabe\"></p>\n"},{"tags":["delphi","format","delphi-2010","locale","undefined"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1403,"score":2,"question_id":2083540,"title":"Delphi - undeclared identifier: LOCALE_SYSTEM_DEFAULT","body":"<p>I'm trying to format a float (extended) by the system locale's default currency settings.  I have found the key proponent to this solution to be the following line:</p>\n\n<p><code>\nGetLocaleFormatSettings(LOCALE_SYSTEM_DEFAULT, format_settings);\n</code></p>\n\n<p>and everywhere I look, they provide the solution exactly as shown (no class specifier before, like System.LOCALE_SYSTEM_DEFAULT or anything).  However, my compiler is insistent that LOCALE_SYSTEM_DEFAULT is an undeclared identifier.  It <i>seems</i> to me that the only requirement is to have \"uses SysUtils\", which I do.</p>\n\n<p>I'm using Delphi 2010.  Does anybody know why my compiler can't find this seemingly implicit constant?</p>\n\n<p>Thanks in abundance,\n<br/>Jared</p>\n"},{"tags":["c#","delphi","soap","wsdl"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":104,"score":4,"question_id":12645527,"title":"How can Delphi understand a nillable int through SOAP?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12434202/blank-value-in-web-service-for-int64-type\">Blank value in web service for Int64 type</a>  </p>\n</blockquote>\n\n\n\n<p>I have a WebService made with c# and it needs to be accessible through a Delphi Desktop application.</p>\n\n<pre><code>  &lt;s:element minOccurs=\"1\" maxOccurs=\"1\" name=\"ParamName\" nillable=\"true\" type=\"s:int\" /&gt;\n</code></pre>\n\n<p>But looks like Delphi can't handle nillable int defined in WSDL. How can I do this?</p>\n"},{"tags":["delphi","hash","components","vcl","sha"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":132,"score":1,"question_id":12640858,"title":"Delphi DCrypt - How to isolate SHA256?","body":"<p>I'm writing my own component in Delphi XE2 but I primary use C++ Builder. That is why I need some help regarding Delphi DCrypt library.</p>\n\n<p>My new component needs to have a method (function) that calculates sha256 hash value of a string. I know for DCrypt library and I use it for some time but this time I need to isolate SHA256 hash algorithm and add it in my new component. </p>\n\n<p>DCrypt has stored SHA256 in DCPsha256.pas but since I'm not so skilled in Delphi I don't know what to do. I don't need to install TDCP_sha256, I just need to be able to calculate SHA256 inside my new component.</p>\n\n<p>Ideas? Thanks.</p>\n"},{"tags":["multithreading","delphi","exception-handling","delphi-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":163,"score":3,"question_id":12362851,"title":"How to Handle Exceptions thrown in AsyncCalls function without calling .Sync?","body":"<p>When I am using AsyncCalls, how do you best get the exception into the main thread?  For example:</p>\n\n<pre><code>procedure TUpdater.needsToGoFirst();\nbegin\n  asyncCall := TAsyncCalls.Invoke(procedure \n  begin \n    //some stuff\n    if (possiblyTrueCondition = True) then\n      raise Exception.Create('Error Message');\n    //more stuff\n    TAsyncCalls.VCLSync(procedure \n    begin \n      notifyUpdates(); \n    end);\n  end);\nend;\n\nprocedure TUpdater.needsToGoSecond();\nbegin\n  asyncCall2 := TAsyncCalls.Invoke(procedure \n  begin \n    //initial stuff\n    asyncCall.Sync();\n    //stuff that needs to go second\n    TAsyncCalls.VCLSync(procedure \n    begin \n      notifyUpdates(); \n    end);\n  end);\nend;\n</code></pre>\n\n<p>I know calling <code>asycCall.Sync</code> will throw the exception for me, but due the the way I'm currently having my thread notify the main thread that updates have been made, I really don't have anywhere that I'm calling <code>Sync</code> in the main thread.  Doing so also proves difficult because I actually have another thread that is calling <code>Sync</code> to make sure some things are set before acquiring resources the first thread should process first.</p>\n\n<p>Do I need to wrap the innards of these functions with a try-catch and use a <code>VCLSync</code> to get the exception to the main thread myself?  Is is there a better way to check for exceptions in a main thread idle loop of some kind?</p>\n\n<p><strong>Edit 1</strong></p>\n\n<p>Another thought I had was to create a loops whose only job is to check the IAscynCall references for exceptions and use that to Raise the exception to the main thread, rather than duplicating that code in every post.  The <code>needsToGoSecond</code> metod may still get to the exception first, but it will then hold the exception and the loop would catch it there.</p>\n"},{"tags":["delphi","msbuild","delphi-xe2"],"answer_count":0,"favorite_count":6,"up_vote_count":17,"down_vote_count":0,"view_count":991,"score":17,"question_id":8068481,"title":"How to build using MSBuild and Delphi XE2","body":"<p>I've been building projects using Delphi XE and MSBuild using the following simple example which works fine in a batch file. Project1 is an empty project created using 'File | New | VCL forms application in the IDE:</p>\n\n<pre><code>call \"c:\\Program Files (x86)\\Embarcadero\\RAD Studio\\8.0\\bin\\rsvars.bat\"\nmsbuild.exe /target:Build /p:config=Release  \"c:\\scratch\\test\\project1.dproj\" \npause\n</code></pre>\n\n<p>If I created a new empty project in Delphi XE2, save it as project1.dproj (the dproj is VERY different from XE) and run the following:</p>\n\n<pre><code>call \"c:\\Program Files (x86)\\Embarcadero\\RAD Studio\\9.0\\bin\\rsvars.bat\"\nmsbuild.exe /target:Build /p:config=Release  \"c:\\scratch\\test\\project1.dproj\" \npause\n</code></pre>\n\n<p>It gives: </p>\n\n<pre><code>Build FAILED.\n\n\"c:\\scratch\\test\\project7.dproj\" (Build target) (1) -&gt;\n  c:\\scratch\\test\\project7.dproj : error MSB4057: The target \"Build\" does not e\nxist in the project.\n\n    0 Warning(s)\n    1 Error(s)\n\nTime Elapsed 00:00:00.00\n</code></pre>\n\n<p>I've tried various target names including things I find in Codegear.Delphi.Targets but I dont know wnough about MSBuild. Can anyone help with what I should put please?</p>\n\n<p>LATER RESOLUTION: This was tried on another PC with XE2 and it works ok as suggested by David below. In fact the problem was the content of the RSVARS.BAT file which did not specify the BDS path correctly.</p>\n"},{"tags":["delphi","oledb","ado"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":10970,"score":5,"question_id":113860,"title":"How to check if an OLEDB driver is installed on the system?","body":"<p>How can I make sure that a certain OLEDB driver is installed when I start my application? I use ADO from Delphi and would like to display a descriptive error message if the driver is missing. The error that's returned from ADO isn't always that user-friendly.</p>\n\n<p>There are probably a nice little function that returns all installed drivers but I haven't found it.</p>\n"},{"tags":["sql-server-2008","delphi","delphi-xe2","sqlclr"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":141,"score":0,"question_id":12637118,"title":"SQL Server: stored procedure and CLR Proc return data differently","body":"<p>I'm using Delphi XE2 to call a stored procedure that returns data. The stored procedure is basically:</p>\n\n<pre><code>set nocount on -- ensures that Delphi will see that dataset\n...\nexec StoredProcThatReturnsData\n...\nupdate [table]\nupdate [another table]\n</code></pre>\n\n<p>When the main procedure is a T-SQL procedure, it finishes executing the main procedure including the last <code>update</code> statements <strong>before it returns the data</strong> to Delphi.</p>\n\n<p>When the main procedure is a CLR procedure, it returns the data at the moment the sub-procedure finishes executing and doesn't run the <code>update</code> statements until I close the <code>TSQLQuery</code> object in Delphi.</p>\n\n<p>The Delphi code looks like this:</p>\n\n<pre><code>rpt := TSQLQuery.Create(nil);\ntry\n  rpt.MaxBlobSize := -1;\n  rpt.SQLConnection := ASqlConnection;\n  rpt.SQL.Text := 'exec RunMainProc';\n  rpt.Open;\n  // do some things that depend on the update statements\n  // process the 'rpt' data\nfinally\n  FreeAndNil(rpt);\nend;\n</code></pre>\n\n<p>The CLR proc looks like this:</p>\n\n<pre><code>[Microsoft.SqlServer.Server.SqlProcedure]\npublic static void RunReport(SqlGuid ReportID, SqlGuid UserID, SqlBoolean ForDownload)\n{\n  using (SqlConnection con = new SqlConnection(\"context connection=true\"))\n  {\n    con.Open();\n    using (SqlCommand cmd = new SqlCommand())\n    {\n      cmd.Connection = con;\n      cmd.CommandText = \"[identical SQL as T-SQL proc]\";\n      SqlContext.Pipe.ExecuteAndSend(cmd);\n    }\n  }\n}\n</code></pre>\n\n<p>Why does the T-SQL procedure finish executing before returning the data while the CLR procedure waits to run the <code>update</code> statements until after Delphi closes/destroys the <code>rpt</code> query?</p>\n"},{"tags":["delphi","styles","delphi-xe2","firemonkey"],"answer_count":1,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":2219,"score":5,"question_id":7461233,"title":"How to change the default FireMonkey style in Delphi XE2","body":"<p>I saw a youtube video (can't remember which one) where the user changed an option in Delphi XE2 to change the default style for an entire FireMonkey application. After much hunting I can't find the option.</p>\n\n<p>IDE Insight for 'style' shows me 'Default Style - Custom Styles (Forms)' under 'Project Options'. But unless I'm being particularly thick, there's no such option there.</p>\n"},{"tags":["c#",".net","delphi"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":200,"score":3,"question_id":12635170,"title":"How to byte array received from socket, to C# structure","body":"<p>I have to Develop a Service (C#) which read data from Network Device via TCP Socket and convert this is C# structure.</p>\n\n<p>I am basing on existing, old Delphi application which is doing all this stuff and I have to migrate logic in C#. </p>\n\n<p>EDITED:\nI got a snapshot from C-Source of original data-structure:</p>\n\n<pre><code>struct _RequestMsgStruct\n{\n    UCHAR           request_ver; //In DELPHI it is represented as Byte\n    USHORT          mac_addr[3];    /* MAC Address */\n    UINT            product_type; //In DELPHI - Cardinal\n    UCHAR           supply_type; //In DELPHI - Byte\n    short           reserved0; //In DELPHI - SmallInt\n    UCHAR           oper_ver[4]; //In DELPHI - CARDINAL !!!\n    USHORT          brd_id; //In DELPHI - WORD\n    unsigned short  exp_id1; //In DELPHI - WORD\n\n    //In DELPHI - string[15]; //Array [0..15] of char;\n    UCHAR           serial_no[16]; /* Serial Number. 16th char have to be NULL */ \n    UCHAR           _name[32]; /* Name */ //Length of payload may vary //In DELPHI - string[31]\n\n    float           data_avg; //In DELPHI - Single\n    ULONG           key[5]; //In DELPHI - array [0..19] of Byte\n}__attribute__ ((packed));\n</code></pre>\n\n<p>There is Delphi Packed record with over 200 fields of different types... it look approximately like:</p>\n\n<pre><code>  TREC_DATA = packed record\n      ID            : Byte;\n      MAC_ADDRESS   : array [0..5] of Byte;\n      fieldCard     : cardinal;\n      fieldSI       : SmallInt; \n      fieldW        : WORD;\n      SERIAL_NUMBER : string[15]; //Array [0..15] of char;\n      fieldSingle   : Single;\n      fieldArrOfB   : array [0..19] of Byte;\n    end;\n</code></pre>\n\n<p>To move byte array to structure in Delphi there is next code:</p>\n\n<pre><code>Move(inBytesArr[StartIdx], DelphiStruct, aMsgSize)\n</code></pre>\n\n<p>To convert string files (e.g. SERIAL_NUMBER) there is also such code:</p>\n\n<pre><code>var\n  pc: Pchar;\n...\npc := @inBytesArr[StartIdx + SerialN_Pos_Idx];\nDelphiStruct.SERIAL_NUMBER := pc;\n</code></pre>\n\n<p>I having deal with such conversion for first time and I don't know from where to start:</p>\n\n<ul>\n<li><p>How to convert this structure to c#?\n-- Should I use <code>LayoutKind.Sequential</code> or <code>LayoutKind.Explicit</code>, with or wiyhout <code>[FieldOffset(N)]</code> attribute?\n-- How I have to declare array of bytes in target c# structure: as <code>fixed</code> buffer or using <code>[MarshalAs(UnmanagedType.ByValArray...)]</code> attribute?</p></li>\n<li><p>Which is better way to marshal input bytes array to final C# structure: using <code>Marshal.PtrToStructure</code> or GCHandle.Alloc(bytes, GCHandleType.Pinned) + <code>AddrOfPinnedObject</code>?</p></li>\n</ul>\n\n<p>Please help me, at least, to get start point in understating from where i need to start.</p>\n"},{"tags":["sql-server","delphi","login"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":12641280,"title":"How to connect to MSSQL server in Delphi with different user than 'sa'?","body":"<p>I have users created and I want to connect with SDAC in Delphi. I can login with 'sa' but not with created users.</p>\n"},{"tags":["c++","delphi","components","c++builder","vcl"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":224,"score":5,"question_id":12597678,"title":"Tag editor component for Delphi/C++Builder","body":"<p>I need a VCL tag editor component for Delphi or C++Builder, similar to what's available for JavaScript: e.g. <a href=\"http://aehlke.github.com/tag-it/examples.html\" rel=\"nofollow\">this one</a>, or <a href=\"http://xoxco.com/projects/code/tagsinput/\" rel=\"nofollow\">this one</a> or StackOverflow's own tags editor.</p>\n\n<p>Is there something like this available or do I need to make it from scratch?</p>\n\n<p>Some specific things that I need are:</p>\n\n<ul>\n<li>Editor should allow either scrolling or become multi-line if more tags are present than the editor's width allows. If multi-line, there should be an option to define some maximum height however, preventing it from becoming too tall</li>\n<li>Option to select whether tags are created when pressing space or comma key</li>\n<li>Prompt text in the editor, when it is not focused (for example \"Add new tag\")</li>\n<li>Ideally, you should be able to move between tags (highlighting them) using the keyboard arrows, so you can delete any tag using the keyboard only</li>\n</ul>\n"},{"tags":["windows","delphi","winapi","delphi-xe2","delphi-2007"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":314,"score":2,"question_id":12637203,"title":"Why does CreateProcess give error 193 (%1 is not a valid Win32 app)","body":"<p>The code below fails to start documents. I get error 193 (%1 is not a valid Win32 app). Starting executables work fine.\nThe files are properly associated, they start the corresponding app when double clicked.\nI have searched SO and elsewhere for the error message, createprocess stuff etc. (E.g. <a href=\"http://stackoverflow.com/questions/331829/why-is-createprocess-failing-in-windows-server-2003-64-bit\">Why is CreateProcess failing in Windows Server 2003 64-bit?</a>\nI know about quoting the command line.</p>\n\n<ul>\n<li><p>This is a Delphi XE2 (Update 4) Win32 app in a Win7 64bit VMWare VM. </p></li>\n<li><p>The code also fails on the host machine (Win7 64 bit) and in a Virtual PC VM with 32bit XP.</p></li>\n<li><p>The apps that should start in the Win7 VM (Excel 2003 and Crimson Editor) are 32 bit.</p></li>\n<li><p>The failure occurs both when starting from the IDE or when running the test app standalone</p></li>\n<li><p>It used to be Delphi2007 code, the compiled D2007 app where this code comes from works fine everywhere.</p></li>\n</ul>\n\n<p>What's wrong with the code? It's almost as if I'm overlooking something very obvious....</p>\n\n<p>Thanks in advance,</p>\n\n<p>Jan</p>\n\n<pre><code>procedure StartProcess(WorkDir, Filename: string; Arguments : string = '');\nvar\n  StartupInfo  : TStartupInfo;\n  ProcessInfo  : TProcessInformation;\n  lCmd         : string;\n  lOK          : Boolean;\n  LastErrorCode: Integer;\nbegin\n  FillChar( StartupInfo, SizeOf( TStartupInfo ), 0 );\n  StartupInfo.cb := SizeOf( TStartupInfo );\n  StartupInfo.dwFlags := STARTF_USESHOWWINDOW;\n  StartupInfo.wShowWindow := sw_Normal;\n\n  FillChar( ProcessInfo, SizeOf( TProcessInformation ), 0 );\n\n  lCmd := '\"' +  WorkDir + FileName + '\"';     // Quotes are needed http://stackoverflow.com/questions/265650/paths-and-createprocess\n  if Arguments &lt;&gt; '' then lCmd := lCmd + ' ' + Arguments;\n\n  lOk := CreateProcess(nil,\n                       PChar(lCmd),\n                       nil,\n                       nil,\n                       FALSE,  // TRUE makes no difference\n                       0,      // e.g. CREATE_NEW_CONSOLE or NORMAL_PRIORITY_CLASS makes no difference\n                       nil,\n                       nil,    // PChar(WorkDir) makes no difference\n                       StartupInfo,\n                       ProcessInfo);\n\n  if lOk then\n  begin\n    try\n      WaitForSingleObject(ProcessInfo.hProcess, INFINITE);\n    finally\n      CloseHandle( ProcessInfo.hThread );\n      CloseHandle( ProcessInfo.hProcess );\n    end;\n  end\n  else\n  begin\n    LastErrorCode := GetLastError;\n    ShowMessage(IntToStr(LastErrorCode) + ': ' + SysErrorMessage(LastErrorCode));\n  end;\nend;\n\nprocedure TFrmStartProcess.Button1Click(Sender: TObject);\nbegin\n   StartProcess('c:\\program files (x86)\\axe3\\','axe.exe');    // Works\nend;\n\nprocedure TFrmStartProcess.Button2Click(Sender: TObject);\nbegin\n   StartProcess('d:\\','klad.xls');                            // Fails\nend;\n\nprocedure TFrmStartProcess.Button3Click(Sender: TObject);\nbegin\n   StartProcess('d:\\','smimime.txt');                         // Fails\nend;\n</code></pre>\n"},{"tags":["windows","delphi","winapi","desktop","windows-shell"],"answer_count":1,"favorite_count":3,"up_vote_count":12,"down_vote_count":1,"view_count":305,"score":11,"question_id":8256022,"title":"How to enter Windows Flip 3D mode on Windows Vista and above?","body":"<p>Is it possible to trigger the <a href=\"http://windows.microsoft.com/en-US/windows-vista/Using-Windows-Flip-3D\" rel=\"nofollow\"><code>Flip 3D mode</code></a> on Windows Vista above systems programmatically?<br><br>\n<img src=\"http://i.stack.imgur.com/FV9TO.png\" alt=\"enter image description here\"><br><br>\nIt is the same as if you manually press <kbd>CTRL</kbd> + <kbd>WIN</kbd> + <kbd>TAB</kbd></p>\n"},{"tags":["delphi","delphi-xe2","fpc"],"answer_count":3,"favorite_count":19,"up_vote_count":19,"down_vote_count":0,"view_count":865,"score":19,"question_id":8460037,"title":"List of Delphi language features and version in which they were introduced/deprecated","body":"<p>Before I begin, I would like to point out that I have honestly and genuinely searched repeatedly and exhaustively via Google for such a thing, and been unable to find one.</p>\n\n<p>I require (for a project I'm developing) a list of all Delphi (2007 to XE2, I no longer support any version older than 2007) \"Language Features\", and the versions in which they were introduced and (where applicable) deprecated, improved or removed.</p>\n\n<p>I have noted similar questions to this on Stack Overflow before, though most of those were phrased in the form of \"which feature is best\", and closed as deemed unsuitable.</p>\n\n<p>If anyone knows of such a list (or has enough spare time to compile one), I would be very greatful.</p>\n\n<p>The accepted answer will either contain a link to such a list, or the list itself.</p>\n"},{"tags":["delphi","osx","pascal","lazarus"],"answer_count":6,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":2159,"score":4,"question_id":591678,"title":"How can I perform the equivalent of shellexecute() in Lazarus for a Mac?","body":"<p>How can I perform the equivalent of <code>shellexecute()</code> in Lazarus for a Mac?</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":12636397,"title":"Cannot build after reinstalling XE2","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5656975/delphi-xe-f1027-unit-not-found-system-pas-or-binary-equivalents-dcu-upon\">Delphi XE - F1027 Unit not found: &#39;System.pas&#39; or binary equivalents (.dcu) upon Activation of trial version</a>  </p>\n</blockquote>\n\n\n\n<p>I had to format myu win7 machine so i reinstalled Delphi XE2 from scratch (Embarcadero® RAD Studio XE2 Version 16.0.4429.46931 ). \nAfter installing it I installed all my third party components (some of them were not for Update 4, like SDAC from Devart, I had v 6.1).</p>\n\n<p>Now if I do a new VCL Forms application and build it (so no logic, just an empty form) I have:</p>\n\n<pre><code>[DCC Fatal Error] Project1.dpr(1): F1027 Unit not found: 'System.pas' or binary equivalents `(.dcu)`\n</code></pre>\n\n<p>My first thought is uninstall all and reinstall, but do you have a clue?</p>\n\n<p>Where should I start from?</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","progress-bar"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":158,"score":1,"question_id":12635838,"title":"Delphi show progress on clientdataset open","body":"<p>My current code</p>\n\n<pre><code>   Screen.Cursor := crSQLWait;\n   ProgressDlg := TProgressDlg.Create(Application);\n   try\n      ProgressDlg.ProgressLabel.Caption := 'Loading data. Please wait...';\n      ProgressDlg.Show;\n      Application.ProcessMessages;\n      if MainCDS.RemoteServer &lt;&gt; nil then\n      begin\n         MainCDS.Active := false;\n         MainCDS.Active := true; \n      end;\n   finally\n      FreeAndNil(ProgressDlg);\n      Screen.Cursor := crDefault;\n   end;\n</code></pre>\n\n<p>How can I make my marquee progressbar on ProgressDlg move while MainCDS is opening, cause now progressbar is freezed while MainsCDS is opening. Hope You understand my problem.</p>\n"},{"tags":["sql-server","delphi","datagridview","tcxgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12624308,"title":"Form details to be displayed in the grid","body":"<p>I have basic question from my side, as I am Beginner level in Delphi XE2.</p>\n\n<p>I am using VCL form and entering the Form details in the edit box and to be displayed in the grid with several basic operation like Add, Delete and Update/Retrieve. Whereas the details have to be saved in the SQL server.</p>\n\n<p>If I am using the form later on, i need the Previous data in the grid from the SQL. For those operation my Update/Retrieve field operation must be done on Delphi or SQL server.</p>\n\n<p>Hope everyone would have come across these basic forms. So help me.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Regards,\nRajan.</p>\n"},{"tags":["php","delphi","authentication","password-protection"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":12626644,"title":"Authentication system - Return information that have to change every time","body":"<p>I have a application (made in Delphi) that contains a Authentication system (login &amp; password).</p>\n\n<p>This system is in PHP, and the application get results from PHP using HTTP <strong>GET</strong> method.\nThe system returns 'OK' if login and password are correct, and 'NO' if not correct.</p>\n\n<p>Like this...</p>\n\n<pre><code>procedure Check;\nvar\n x: string;\nbegin\n x:=Get('www.mywebsite.com/auth.php?user=xxxxxx&amp;pass=zzzzzz');\n if x='OK' then \n  UnlockFeatures\n else\n  MessageBox(0,'You're not VIP','Error',0);\nend;\n</code></pre>\n\n<p>Well, it works fine, but it is very easy to circumvent this system with sniffers, packet editor or proxy.</p>\n\n<p><strong>So, I want to get some information (in PHP) that changes every time, and that could be possible get the same information by my application.</strong></p>\n\n<p><strong>What can I do?</strong></p>\n\n<p>I don't need codes. Just tips, suggestions, please...</p>\n\n<p>Thanks...</p>\n"},{"tags":["delphi","redraw"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":137,"score":2,"question_id":12632346,"title":"Repaint small part of form only using Delphi?","body":"<p>In my program I have a custom <code>TPanel</code> that slides out from above and has buttons and images on it. It slides out fine but when I go to hide it, it is very slow. I have tried several methods and all are the same result. If you notice below I tried Redraw thinking I could just redraw the trailing rect but this call redraws the entire form as does all the other methods I have tried. I even tried using scroll. Am I calling it wrong or is there a better way to just update the form part that needs updating as the panel moves up?</p>\n\n<pre><code>while z&gt;mypanels[panel].Fstarttop do\nbegin\n   if z-x&lt;mypanels[panel].Fstarttop then z:=mypanels[panel].Fstarttop else z:=z-x;\n   updaterect:=Rect(mypanels[panel].left,z+mypanels[panel].height,mypanels[panel].left+mypanels[panel].width,mypanels[panel].top+mypanels[panel].height);\n   mypanels[panel].top:=z;\n   //mypanels[panel].Repaint;\n   //Application.ProcessMessages;  \n   //mypanels[panel].ScrollBy(0,-x);\n   //InvalidateRect(form1.Handle,@updaterect,FALSE);\n   //Application.ProcessMessages;\n   //RedrawWindow(form1.Handle,@updaterect, 0, RDW_UPDATENOW);\n   //form1.refresh;\nend;\n</code></pre>\n"},{"tags":["delphi","windows-7","windows-vista","core-audio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12632345,"title":"Vista/7 CoreAudio pascal files for Delphi","body":"<p>I've been looking all around for the CoreAudio pascal files and I can't find them. I searched the Rad Studio XE2 source directory to no avail.</p>\n\n<p>On Google I found some partial files but none I found was the whole package or seem to include IAudioSessionManager2.</p>\n\n<p>Are there any definitions that include new features in Win 7 or will I have to do my own conversion?</p>\n\n<p>Thanks!</p>\n"},{"tags":["delphi","project"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":323,"score":6,"question_id":6762194,"title":"How to prevent Delphi modifying its DPR (project source) unexpectedly","body":"<p>To maintain its project, Delphi sometimes adds or removes stuff from the DPR file (project source). I quite like to format my stuff in the DPR as if it is an ordinary unit, for example to group together the 'used' frame references and project source files. I make copies of it and can go back when this happens but every so often, I'll notice that the DPR has had all its source file references smashed into a single block.</p>\n\n<p>Anyone else suffer from this? Is there any way of preventing this from happening (other than a read-only file).\nThanks</p>\n"},{"tags":["delphi"],"answer_count":9,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":391,"score":5,"question_id":6607890,"title":"Pros and cons of explicitly adding your unit names to Delphi's project source","body":"<p>I've been using Delphi for years and years and each of my projects is compiled from source into the exe - no packages etc. If 'MyUnitA.pas' is used anywhere, it is simply declared in the interface or implementation section of another unit that requires it. This all works fine everywhere and means that in my project source (dpr) there are only frame definitions (which seem to be needed there else they dont show up in the frame list) and the 'odd' definition of a unit that must be called very early eg madExcept, FastMM etc.</p>\n\n<p>I notice that XE baulks a bit sometimes at resolving stuff in the dpr until you actually compile it. In addition, when working with packages its a warning if stuff has to be implicitly pulled in without having been explicitly added to the package. This got me wondering whether we should be diligently adding ALL of our used units to our dpr (like the package definition) or right-click project and 'Add to project'. What do you do?</p>\n"},{"tags":["delphi","interface","delphi-2010"],"answer_count":0,"favorite_count":5,"up_vote_count":37,"down_vote_count":1,"view_count":873,"score":36,"question_id":7759081,"title":"Is the compiler treatment of implicit interface variables documented?","body":"<p>I asked a similar <a href=\"http://stackoverflow.com/questions/5354696/the-mysterious-case-of-the-unexpected-implicit-interface-variable\">question</a> about implicit interface variables not so long ago.</p>\n\n<p>The source of this question was a bug in my code due to me not being aware of the existence of an implicit interface variable created by the compiler. This variable was finalized when the procedure that owned it finished. This in turn caused a bug due to the lifetime of the variable being longer than I had anticipated.</p>\n\n<p>Now, I have a simple project to illustrate some interesting behaviour from the compiler:</p>\n\n<pre><code>program ImplicitInterfaceLocals;\n\n{$APPTYPE CONSOLE}\n\nuses\n  Classes;\n\nfunction Create: IInterface;\nbegin\n  Result := TInterfacedObject.Create;\nend;\n\nprocedure StoreToLocal;\nvar\n  I: IInterface;\nbegin\n  I := Create;\nend;\n\nprocedure StoreViaPointerToLocal;\nvar\n  I: IInterface;\n  P: ^IInterface;\nbegin\n  P := @I;\n  P^ := Create;\nend;\n\nbegin\n  StoreToLocal;\n  StoreViaPointerToLocal;\nend.\n</code></pre>\n\n<p><code>StoreToLocal</code> is compiled just as you would imagine. The local variable <code>I</code>, the function's result, is passed as an implicit <code>var</code> parameter to <code>Create</code>. The tidy up for <code>StoreToLocal</code> results in a single call to <code>IntfClear</code>. No surprises there.</p>\n\n<p>However, <code>StoreViaPointerToLocal</code> is treated differently. The compiler creates an implicit local variable which it passes to <code>Create</code>. When <code>Create</code> returns, the assignment to <code>P^</code> is performed. This leaves the routine with two local variables holding references to the interface. The tidy up for <code>StoreViaPointerToLocal</code> results in two calls to <code>IntfClear</code>.</p>\n\n<p>The compiled code for <code>StoreViaPointerToLocal</code> is like this:</p>\n\n<pre><code>ImplicitInterfaceLocals.dpr.24: begin\n00435C50 55               push ebp\n00435C51 8BEC             mov ebp,esp\n00435C53 6A00             push $00\n00435C55 6A00             push $00\n00435C57 6A00             push $00\n00435C59 33C0             xor eax,eax\n00435C5B 55               push ebp\n00435C5C 689E5C4300       push $00435c9e\n00435C61 64FF30           push dword ptr fs:[eax]\n00435C64 648920           mov fs:[eax],esp\nImplicitInterfaceLocals.dpr.25: P := @I;\n00435C67 8D45FC           lea eax,[ebp-$04]\n00435C6A 8945F8           mov [ebp-$08],eax\nImplicitInterfaceLocals.dpr.26: P^ := Create;\n00435C6D 8D45F4           lea eax,[ebp-$0c]\n00435C70 E873FFFFFF       call Create\n00435C75 8B55F4           mov edx,[ebp-$0c]\n00435C78 8B45F8           mov eax,[ebp-$08]\n00435C7B E81032FDFF       call @IntfCopy\nImplicitInterfaceLocals.dpr.27: end;\n00435C80 33C0             xor eax,eax\n00435C82 5A               pop edx\n00435C83 59               pop ecx\n00435C84 59               pop ecx\n00435C85 648910           mov fs:[eax],edx\n00435C88 68A55C4300       push $00435ca5\n00435C8D 8D45F4           lea eax,[ebp-$0c]\n00435C90 E8E331FDFF       call @IntfClear\n00435C95 8D45FC           lea eax,[ebp-$04]\n00435C98 E8DB31FDFF       call @IntfClear\n00435C9D C3               ret \n</code></pre>\n\n<p>I can guess as to why the compiler is doing this. When it can prove that assigning to the result variable will not raise an exception (i.e. if the variable is a local) then it uses the result variable directly. Otherwise it uses an implicit local and copies the interface once the function has returned thus ensuring that we don't leak the reference in case of an exception.</p>\n\n<p>But I cannot find any statement of this in the documentation. It matters because interface lifetime is important and as a programmer you need to be able to influence it on occasion.</p>\n\n<p>So, does anybody know if there is any documentation of this behaviour? If not does anyone have any more knowledge of it? How are instance fields handled, I have not checked that yet. Of course I could try it all out for myself but I'm looking for a more formal statement and always prefer to avoid relying on implementation detail worked out by trial and error.</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>To answer Remy's question is mattered to me when I needed to finalize the object behind the interface before carrying out another finalization.</p>\n\n<pre><code>begin\n  AcquirePythonGIL;\n  try\n    PyObject := CreatePythonObject;\n    try\n      //do stuff with PyObject\n    finally\n      Finalize(PyObject);\n    end;\n  finally\n    ReleasePythonGIL;\n  end;\nend;\n</code></pre>\n\n<p>As written like this it is fine. But in the real code I had a second implicit local which was finalized after the GIL was released and that bombed. I solved the problem by extracting the code inside the Acquire/Release GIL into a separate method and thus narrowed the scope of the interface variable.</p>\n"},{"tags":["delphi","delphi-xe"],"answer_count":2,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":222,"score":7,"question_id":11922047,"title":"How to make a list box with Office XP theme like selection rectangle?","body":"<p>What would be the most simple and clean way to show a focused/selected listbox item with a Office XP style?</p>\n\n<p>See this sample image to show the idea more clearer:</p>\n\n<p><img src=\"http://i.stack.imgur.com/a7E3a.png\" alt=\"enter image description here\"></p>\n\n<p>I think I need to set the Listbox Style to either <code>lbOwnerDrawFixed</code> or <code>lbOwnerDrawVariable</code> and then modify the OnDrawItem event?</p>\n\n<p>This is where I am stuck, I am not really sure what code to write in there, so far I tried:</p>\n\n<pre><code>procedure TForm1.ListBox1DrawItem(Control: TWinControl; Index: Integer;\n  Rect: TRect; State: TOwnerDrawState);\nbegin\n  with (Control as TListBox).Canvas do\n  begin\n    if odSelected in State then\n    begin\n      Brush.Color := $00FCDDC0;\n      Pen.Color   := $00FF9933;\n      FillRect(Rect);\n    end;\n\n    TextOut(Rect.Left, Rect.Top, TListBox(Control).Items[Index]);\n  end;\nend;\n</code></pre>\n\n<p>I should of known that would not work, I get all kind of funky things going on:</p>\n\n<p><img src=\"http://i.stack.imgur.com/D1csy.png\" alt=\"enter image description here\"></p>\n\n<p>What am I doing wrong, more importantly what do I need to change to make it work?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c","delphi","delphi-7","converter"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":107,"score":2,"question_id":12626434,"title":"how to convert data type byte[] in c to delphi?","body":"<p>This is code I need to convert delphi: </p>\n\n<pre><code>LPBYTE readCharBuff = NULL;\nBYTE readBuffSize;\n\nreadCharBuff = new BYTE[200];\nreadBuffSize    = 200;\n\nreadCharBuff[readBuffSize] = '\\0';\n</code></pre>\n\n<p>Thanks for your help</p>\n"},{"tags":["delphi","windows-7","delphi-5","quickreports","xp-mode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":312,"score":0,"question_id":8613945,"title":"QuickReport and Windows 7 XP Mode","body":"<p>I have an application developed in Delphi 5 that works very well in Windows 7 using the XP Mode, except for one code:</p>\n\n<pre><code>TQRCompositeReport.Prepare\n</code></pre>\n\n<p>That function only works if I am using an administrator account.\nIf I am using an account that don't have administrator privileges, it works only if the \"XP Mode\" is disabled.\nSince I have some errors runing my app in Windows 7 without XP Mode, I have to activate this option.  Then, I can't preview or print any reports using this command to prepare it.</p>\n\n<p>I have the idea that it may concerns to some temporary files that quick report generates, once it does work using administrator accounts. However, the default temporary folder in Windows 7 is \"C:\\users\\username\\App Data\\Local\\Temp\\ and the user has privilege to create and modify files in this folder.</p>\n"},{"tags":["delphi","alignment","anchor","centering"],"answer_count":1,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":139,"score":8,"question_id":12614453,"title":"Anchors := [akCenter]?","body":"<p>How can I center a control within its parent? And how to keep it centered when the parent resizes?</p>\n\n<p>I know I could write a <code>Parent.OnResize</code> event handler to move the control manually, but not all container components have an <code>OnResize</code> event, and I would like to do this automatically.</p>\n\n<p>Is there an <code>akCenter</code> anchor?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":12621161,"title":"Odd behavior when action assigned to BitBtn","body":"<p>I have an action assigned to a BitBtn and to a menu item.\nThe action's caption is '&amp;Save' (has an accelerator on s). The shortcut for this action is 'Ctrl+S'.</p>\n\n<p>When I run the app and press the S key the action is executed because of the accelerator. I think is pretty odd. The user sees that the keyboard shortcut is 'Ctrl+s' but still the action is executed with 's'. \nThe program says something but does something else - this could be considered a full fledged bug. Right? </p>\n\n<p>Plus that if there are multiple actions with similar shortcuts (ctrl+s, ctrl+shift+s, etc) or many menus with items with 's' as accelerator the user will be very very confused about why 's' does 'save file' and not 'save project'.</p>\n\n<p>I want the action executed with 'Ctrl+s'. How do I do that?</p>\n\n<p>(I know that I could edit button's caption to remove its accelerator' but if I reassign the action to the button I will have to remember to re-edit button's caption. There are too many actions and buttons there.).</p>\n"},{"tags":["performance","delphi","exe","pascal","createprocess"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":293,"score":1,"question_id":12622425,"title":"Delphi: Fast alternative to CreateProcess","body":"<p>I'm looking for a fast alternative to CreateProcess in Delphi to execute certain calculations in an exe, including several return-values in XML.\nCurrently, I'm calling an C#-exe with certain parameters. One of these calls takes approx. 0.5s - which is <em>way</em> to expensive, since this exe needs to be called a couple of hundred times (unfortunatley iterative calls, i.e. multithreading won't speed up the job).</p>\n\n<p>My current code looks like this (found the solution to get the console output of the exe somwhere on StackOverflow).</p>\n\n<pre><code>IsExecutable := CreateProcess(\n            nil,\n            PChar(WorkDir + Exe + CommandLine),\n            nil,\n            nil,\n            True,\n            HIGH_PRIORITY_CLASS,\n            nil,\n            nil,\n            StartupInfo,\n            ProcessInformation);\nCloseHandle(StdOutPipeWrite);\n    if IsExecutable then\n      try\n        repeat\n          WasOK := ReadFile(StdOutPipeRead, Buffer, 255, BytesRead, nil);\n          if BytesRead &gt; 0 then\n          begin\n            Buffer[BytesRead] := #0;\n            Result := Result + Buffer;\n          end;\n        until not WasOK or (BytesRead = 0);\n        WaitForSingleObject(ProcessInformation.hProcess, INFINITE);\n      finally\n        CloseHandle(ProcessInformation.hThread);\n        CloseHandle(ProcessInformation.hProcess);\n      end\n</code></pre>\n\n<p>Btw, I'm not very good a Delphi - actually, I kinda feel like the \"I have no idea what I'm doing\" dog-meme-thing...</p>\n"},{"tags":["delphi","delphi-2009","vcl"],"answer_count":7,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2445,"score":2,"question_id":826231,"title":"'0.0' is not a valid timestamp when accessing OldValue of TClientDataSet's TDateField","body":"<p>When I use the following code in a newly inserted record in a TClientDataSet:</p>\n\n<pre><code>cdsMyDateField.OldValue &lt;&gt; Null\n</code></pre>\n\n<p>I get an EConvertError:</p>\n\n<pre><code>''0.0' is not a valid timestamp'.\n</code></pre>\n\n<p>Looking at Delphi's VCL's code, it tries to convert the value to TDateTime which results in this Exception because the value (Null) is an invalid DateTime, but as I'm comparing Variants I thought that it would return a variant, which would be Null in this case, but that doesn't happen, instead I get this exception.</p>\n\n<p>I know that I can just check if the DataSet.State = dsInsert before comparing the values, as if the State = dsInsert every OldValue is Null, but I want to understand why the OldValue tries to convert the value instead of Just returning Null in all Fields when the State = dsInsert.</p>\n\n<p>Can anyone please give me some light?</p>\n"},{"tags":["delphi","ide","delphi-2009","ambiguity"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":93,"score":4,"question_id":12624306,"title":"Is there a workaround for \"incompatible parameter list\" message from Delphi IDE?","body":"<p>Please consider this simplified example:</p>\n\n<pre><code>type\n  TForm43 = class(TForm)\n    drwgrd1: TDrawGrid;\n    procedure drwgrd1DrawCell(Sender: TObject; ACol, ARow: Integer; \n      Rect: Windows.TRect; State: TGridDrawState);\n  private\n    { Private declarations }\n  public\n    { Public declarations }\n  end;\n\nprocedure TForm43.drwgrd1DrawCell(Sender: TObject; ACol, ARow: Integer;\n  Rect: Windows.TRect; State: TGridDrawState);\nbegin\n  Rect.Left := 5;\nend;\n</code></pre>\n\n<p>In method <code>drwgrd1DrawCell</code> I've explicitly used <code>Windows.TRect</code> to resolve ambiguity beetween <code>TRect</code> defined in two different units. Everything works fine, code is compiling.\nBut everytime when I save the above unit I am getting a question from the Delphi IDE which asks: \"<em>The drwgrd1DrawCell method referenced by drwgrd1.OnDrawCell has an incompatible parameter list. Remove the reference?</em>\"</p>\n\n<p>This is very annoying. Is there any way to turn off this message dialog or to write my code in a  way that it would not be shown? Unfortunately I can not change my <code>TRect</code> for <code>TRect2</code> or something like that.</p>\n"},{"tags":["javascript","asp.net","delphi","webbrowser"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":169,"score":1,"question_id":12610641,"title":"Expanding obout.com ASP.NET TreeView from Delphi WebBrowser","body":"<p>I have a website using this a treeview component:</p>\n\n<p><a href=\"http://www.obout.com/t2/ex_expand_levels.aspx\" rel=\"nofollow\">http://www.obout.com/t2/ex_expand_levels.aspx</a></p>\n\n<p>I need expand all nodes of the treeview.I DONT have the buttons (nor the functions) just the treeview itself. (Please find the code sample below)</p>\n\n<p>I have loaded the page and able to send JavaScript to the website, but have not been able to simulate click on the \"+\" signs to expand a nodes. I have got several.</p>\n\n<p>I would really like to see a simple example code if possible in Delphi.</p>\n\n<p>The Delphi code I am using to exec the Javascript is the following:</p>\n\n<p>My form got a WebBrowser, an Edit and a Button:</p>\n\n<pre><code>uses MSHTML;\n\nprocedure TForm1.ButtonJSButtonClick(Sender: TObject);\n  { Make browser exec JS }\nvar\n  Doc: IHTMLDocument2;      // current HTML document\n  HTMLWindow: IHTMLWindow2; // parent window of current HTML document\n  JSFn: string;             // stores JavaScipt function call\nbegin\n\n  // Get reference to current document\n  Doc := WebBrowser1.Document as IHTMLDocument2;\n  if not Assigned(Doc) then\n    Exit;\n  // Get parent window of current document\n  HTMLWindow := Doc.parentWindow;\n  if not Assigned(HTMLWindow) then\n    Exit;\n  // Run JavaScript\n  try\n    JSFn := Edit1.Text;\n    HTMLWindow.execScript(JSFn, 'JavaScript');\n  except\n    // handle exception in case JavaScript fails to run\n    ShowMessage('Error running JavaScript |'+Edit1.Text+'|');\n  end;\nend;\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Zsolt</p>\n\n<p>JavaScript:</p>\n\n<pre><code>&lt;!--   ASP TreeView component   http://www.obout.com   --&gt;\n\n\n\n&lt;LINK REL=stylesheet HREF=\"/_tree/treeStyle_Explorer/obout_treeview.css\" &gt; \n&lt;SCRIPT LANGUAGE=\"JavaScript\"&gt;\n&lt;!--\nvar op2, ob_tb, ob_url, selected_node_id;\nfunction ob_wk(os, url) {\n    var ot = os.parentNode.nextSibling.firstChild.nextSibling;\n    var lensrc = (os.src.length - 8);\n    var s = os.src.substr(lensrc, 8);\n    if (s == \"inus.gif\") {\n        ot.style.display = \"none\";\n        os.src = \"/_tree/treeStyle_Explorer/plusik.gif\";\n    }\n    if (s == \"usik.gif\") {\n        ot.style.display = \"block\";\n        os.src = \"/_tree/treeStyle_Explorer/minus.gif\";\n    if (url != \"\") {\n        var s = os.parentNode.nextSibling.firstChild.nextSibling.innerText;\n        if (s != \"Loading ...\") {\n            return;\n        }\n        ob_url = url;\n        ob_tb = os;\n        window.setTimeout(\"ob_tm()\", 100);\n    }\n    }\n}\n\nfunction ob_tm() {\n    var xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\n    xmlhttp.open(\"GET\", ob_url, false);\n    xmlhttp.send(\"\");\n    ob_tb.parentNode.nextSibling.firstChild.nextSibling.outerHTML = xmlhttp.responseText;\n}\n\nfunction ob_ft(e) {\n    if (e.tagName == \"TABLE\" &amp;&amp; e.className == \"ob_zz\") {\n        if (typeof op2 != \"undefined\") {\n            op2.style.backgroundColor = \"transparent\";\n            op2.style.border = \"0px solid #999999\";\n            op2.style.margin = \"1px\";\n        }\n        e.style.backgroundColor = \"#E6E6E6\";\n        e.style.border = \"0px solid #aaceeb\";\n        e.style.margin = \"0px\";\n        op2 = e;\n        selected_node_id = e.children(0).children(0).children(1).id;\n    }\n    else {\n        ob_ft(e.parentNode);\n    }\n}\n\nfunction ob_os(e){\n    var os = e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children(0).children(0);\n    if (os != null) {\n    if ((typeof os != \"undefined\") &amp;&amp; (os.tagName == \"IMG\")) {\n        var lensrc = (os.src.length - 8);\n        var s = os.src.substr(lensrc, 8);\n        if ((s == \"inus.gif\") || (s == \"usik.gif\")) {\n            e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children(0).children(0).click();\n        }\n    }\n    else {\n        ob_os(e.parentNode);\n    }\n}}\n\n//--&gt;\n&lt;/SCRIPT&gt;\n\n\n\n\n&lt;!--   ASP TreeView component   http://www.obout.com   --&gt;\n\n\n\n&lt;div id=\"divTree\" name=\"divTree\" style=\"background:;background-image: url('');overflow-X:auto; overflow-Y:auto; width:; height:;\"&gt;&lt;table cellspacing=0 cellpadding=0 border=0 style=\"display:block;\"&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img class=ob_ic src='/_tree/treeStyle_Explorer/minus.gif' onclick=\"ob_wk(this, '')\"&gt;&lt;/td&gt;&lt;td&gt;&lt;table cellspacing=0 cellpadding=0 border=0 class=ob_zz&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img width=16 class=ob_ic src='/_tree/xpGlobe.gif'&gt;&lt;/td&gt;&lt;td id=a0 onclick='ob_ft(this)' class=ob_td&gt;Root&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table cellspacing=0 cellpadding=0 border=0 style=\"display:block;\"&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img class=ob_ic src='/_tree/treeStyle_Explorer/plusik.gif' onclick=\"ob_wk(this, '')\"&gt;&lt;/td&gt;&lt;td&gt;&lt;table cellspacing=0 cellpadding=0 border=0 class=ob_zz&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img width=16 class=ob_ic src='/_tree/folder.gif'&gt;&lt;/td&gt;&lt;td id=b1 onclick='ob_ft(this)' class=ob_td&gt;&lt;SPAN onclick='ob_os(this)'&gt;TREE&lt;/SPAN&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table cellspacing=0 cellpadding=0 border=0 style=\"display:none;\"&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img class=ob_ic src='/_tree/treeStyle_Explorer/plusik.gif' onclick=\"ob_wk(this, '')\"&gt;&lt;/td&gt;&lt;td&gt;&lt;table cellspacing=0 cellpadding=0 border=0 class=ob_zz&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img width=16 class=ob_ic src='/_tree/xpHome.gif'&gt;&lt;/td&gt;&lt;td id=c1 onclick='ob_ft(this)' class=ob_td&gt;&lt;SPAN onclick='ob_os(this)'&gt;Site1&lt;/SPAN&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table cellspacing=0 cellpadding=0 border=0 style=\"display:none;\"&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&lt;table cellspacing=0 cellpadding=0 border=0 class=ob_zz&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img width=16 class=ob_ic src='/_tree/xpPanel.gif'&gt;&lt;/td&gt;&lt;td id=d1 onclick='ob_ft(this)' class=ob_td&gt;&lt;input type=checkbox name=sIteID value=1_DD32B129-527A-42FA-A0D0-FE3C0ED65BC5&gt;&lt;STRONG&gt;Site1&gt;Unit1&lt;/STRONG&gt;&lt;input type=hidden name=sup_ value={DD32B129-527A-42FA-A0D0-FE3C0ED65BC5}&gt;&lt;/td&gt;&lt;td align=right&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img class=ob_ic src='/_tree/treeStyle_Explorer/plusik.gif' onclick=\"ob_wk(this, '')\"&gt;&lt;/td&gt;&lt;td&gt;&lt;table cellspacing=0 cellpadding=0 border=0 class=ob_zz&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img width=16 class=ob_ic src='/_tree/xpHome.gif'&gt;&lt;/td&gt;&lt;td id=c2 onclick='ob_ft(this)' class=ob_td&gt;&lt;SPAN onclick='ob_os(this)'&gt;Site2&lt;/SPAN&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table cellspacing=0 cellpadding=0 border=0 style=\"display:none;\"&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&lt;table cellspacing=0 cellpadding=0 border=0 class=ob_zz&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img width=16 class=ob_ic src='/_tree/xpPanel.gif'&gt;&lt;/td&gt;&lt;td id=d2 onclick='ob_ft(this)' class=ob_td&gt;&lt;input type=checkbox name=sIteID value=2_E6DC2021-F8E9-4FBE-93F5-79C953FA7BA8&gt;&lt;STRONG&gt;Site2&gt;Unit2&lt;/STRONG&gt;&lt;input type=hidden name=sup_ value={E6DC2021-F8E9-4FBE-93F5-79C953FA7BA8}&gt;&lt;/td&gt;&lt;td align=right&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img class=ob_ic src='/_tree/treeStyle_Explorer/plusik.gif' onclick=\"ob_wk(this, '')\"&gt;&lt;/td&gt;&lt;td&gt;&lt;table cellspacing=0 cellpadding=0 border=0 class=ob_zz&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img width=16 class=ob_ic src='/_tree/xpHome.gif'&gt;&lt;/td&gt;&lt;td id=c3 onclick='ob_ft(this)' class=ob_td&gt;&lt;SPAN onclick='ob_os(this)'&gt;Site3&lt;/SPAN&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table cellspacing=0 cellpadding=0 border=0 style=\"display:none;\"&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&lt;table cellspacing=0 cellpadding=0 border=0 class=ob_zz&gt;&lt;tr&gt;&lt;td width=1 class=ob_ic&gt;&lt;img width=16 class=ob_ic src='/_tree/xpPanel.gif'&gt;&lt;/td&gt;&lt;td id=d3 onclick='ob_ft(this)' class=ob_td&gt;&lt;input type=checkbox name=sIteID value=3_01B94E4C-A21A-4C76-920E-C2B9773CE2B8&gt;&lt;STRONG&gt;Site3&gt;Unit3&lt;/STRONG&gt;&lt;input type=hidden name=sup_ value={01B94E4C-A21A-4C76-920E-C2B9773CE2B8}&gt;&lt;/td&gt;&lt;td align=right&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;\n&lt;SCRIPT LANGUAGE=\"JavaScript\"&gt;&lt;!--\nob_ft(b1);\n //--&gt;&lt;/script&gt;\n\n\n&lt;!--   ASP TreeView component   http://www.obout.com   --&gt;\n</code></pre>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":1,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":275,"score":7,"question_id":10532445,"title":"Cropping a Bitmap to the nearest pixels?","body":"<p><strong>How can I crop a bitmap to the nearest outside pixels, but leave a space of 1px around the canvas?</strong></p>\n\n<p>Take these sample images to illustrate the question:</p>\n\n<p><img src=\"http://i.stack.imgur.com/z3A6e.png\" alt=\"enter image description here\"> <strong>=</strong> <img src=\"http://i.stack.imgur.com/UaqlD.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/Qigmj.png\" alt=\"enter image description here\"> <strong>=</strong> <img src=\"http://i.stack.imgur.com/B8D5L.png\" alt=\"enter image description here\"></p>\n\n<p>Also if you could explain how to find the invisible bounding box I think it is called, that would be really useful.</p>\n\n<p>By invisible bounding box, the below images should clarify some more:</p>\n\n<p><img src=\"http://i.stack.imgur.com/bLDqb.png\" alt=\"enter image description here\"> <img src=\"http://i.stack.imgur.com/bwz2u.png\" alt=\"enter image description here\"></p>\n\n<p>I think that is how you find the Rect positions?</p>\n\n<p>It seems this can be achieved by using the CalcCloseCrop procedure as written by TLama to find this box.</p>\n\n<p>I though I could work it out from some similar answers but have been unable to. I think if you find the invisible box outside the pixels you could just copy that part for the crop, or is there more to it then that?</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","devexpress","delphi-xe","tcxgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":12624448,"title":"How can I modify the text of a data base field on DrawCell? TcxGrid","body":"<p>Previously with the default DBGrid I could alter the value of a cell without altering the data in a database with the following code.</p>\n\n<pre><code>procedure TEMRForm.DBGridCDrawColumnCell(Sender: TObject; const Rect: TRect;\nDataCol: Integer; Column: TColumn; State: TGridDrawState);\nbegin\n  if Column.FieldName = 'START_DATE' then\n  begin\n    DBGridC.Canvas.FillRect(Rect);          \n    DBGridC.Canvas.TextOut(Rect.Left+2,Rect.Top+2,Column.Field.Text + ' *');\n  end;\nend;\n</code></pre>\n\n<p>Which worked great, but I am having trouble implementing this same kind of functionality on a cxgrid.  Here is my current code which shows no indication of the cell value being changed.  </p>\n\n<pre><code>procedure TEMRForm.cxGridCDBTableView1CustomDrawCell(\nSender: TcxCustomGridTableView; ACanvas: TcxCanvas;\nAViewInfo: TcxGridTableDataCellViewInfo; var ADone: Boolean);\nvar\nARect: Trect;\nbegin\n  ARect := AViewInfo.Bounds;\n  if AViewInfo.Item.Caption = 'Start Date' then\n  begin\n    ACanvas.FillRect(ARect);\n    ACanvas.TextOut(ARect.Left+2,ARect.Top+2,TableC.FieldByName('START_DATE').AsString+' *');\n  end;\nend;\n</code></pre>\n"},{"tags":["delphi","internet-explorer","proxy","delphi-7","indy"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":1620,"score":9,"question_id":8961257,"title":"Detecting IE Proxy settings and using with TIdHTTP","body":"<p>How do I set TIdHTTP to use IE proxy configuration?<br>\nIt should be compatible with XP/Vista/Win7 and reliable.</p>\n"},{"tags":["delphi","internet-explorer","iframe","bho"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":11954802,"title":"Inject iFrame into IE BHO","body":"<p>I'm developing a IE BHO to deny some certain URLs. When I find one target URL, I want to open one iframe, above the webpage showing a warning. To find what URL the user is, I'm using the BeforeNavigate2 event. When I find a target URL, I'll create the iframe. So the code for now is:</p>\n\n<pre><code>procedure DoBeforeNavigate2(\n               const pDisp: IDispatch;\n               var URL: OleVariant;\n               var Flags: OleVariant;\n               var TargetFrameName: OleVariant;\n               var PostData: OleVariant;\n               var Headers: OleVariant;\n               var Cancel: WordBool\n               );\nvar\nDocument: IHTMLDocument2;\niFrame: IHTMLElement;\nbegin\n  Document:= IE.Document as IHTMLDocument2;\n  iFrame:= Document.createElement('iframe');\n  iFrame.setAttribute('src', 'http://www.google.com/', 0);\n  iFrame.setAttribute('id', 'iFrame', 0);\n  iFrame.setAttribute('style', 'position: fixed; left: 0px; top: 0px; border: 0px; width: 100%; height: 100%; background-color: white', 0);\nend;\n</code></pre>\n\n<p>it's supposed to open an iframe with google.com above all websites, but it just crash IE... can someone help-me solve this?Thank's!</p>\n"},{"tags":["delphi"],"answer_count":4,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":194,"score":8,"question_id":12625721,"title":"What is the DataModule (dm) in Delphi?","body":"<p>What is the purpose of having a DataModule in your project? Does it have any special properties compared to a normal class or module? What are the conventions of what it's usually used for?</p>\n"},{"tags":["c#","delphi","pinvoke"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":12623008,"title":"Using a Delphi native dll in C# (DllImport issue)","body":"<p>I'm having issues importing a Delphi native dll to .net. \nI'm getting <em>System.EntryPointNotFoundException</em>. </p>\n\n<p><strong>Here's my delphi dll:</strong></p>\n\n<pre><code>procedure ProcedimientoEncriptar(texto,clave,resultado:PChar); export stdcall;\n    var ...\n    begin\n    ....\n    ....\n    end;\n\n    exports\n      ProcedimientoEncriptar ;\n</code></pre>\n\n<p><strong>And here's my DllImport on .Net (C#) code:</strong></p>\n\n<pre><code>[DllImport(\"CryptoDLL.dll\", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Auto)]\n        public static extern void ProcedimientoEncriptar([MarshalAs(UnmanagedType.LPStr)]string texto, [MarshalAs(UnmanagedType.LPStr)]string clave, [MarshalAs(UnmanagedType.LPStr)] StringBuilder resultado);\n</code></pre>\n\n<p>Any help would be appreciated,\nDiego.</p>\n"},{"tags":["delphi","datagridview","row","tcxgrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12617612,"title":"drag row and move from cx grid to other panel in Delphi","body":"<p>I have question regarding Tcx Grid where my database are displayed. </p>\n\n<p>I want to click some particular row by taking all details from that row and move to the other.</p>\n\n<p>Could anyone help me, any advise are welcome.</p>\n"},{"tags":["delphi","http","rest","delphi-xe2","datasnap"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":435,"score":1,"question_id":11011461,"title":"Delphi XE2 DataSnap Server - Log client connection user/properties","body":"<p>I'm building an XE2 DataSnap server which will serve connections from REST clients.  My DSServerClass LifeCycle property is set to 'Invocation'. What I want to do is to log the details of all client connections to the server, including the following details : username, IP address, protocol, application name.  I can currently get these details using the following events :</p>\n\n<p>DSAuthenticationManager - UserAuthenticate() : username, protocol  (using the standard parameters passed in)</p>\n\n<p>DSServer - Connect() : protocol, IP address, application name  (using DSConnectEventObject.ChannelInfo.ClientInfo)</p>\n\n<p>What I want to do is just log once for all details, but it seems I can't get all the details I need in one event.  I tried using a shared private variable in the class but as expected this gave inconsistent results - the wrong IP address against the wrong username.  Is there another way to achieve what I want?</p>\n\n<p>Jonathan</p>\n"},{"tags":["delphi","tlistview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":109,"score":1,"question_id":12622428,"title":"Border colors in TListView (Delphi)","body":"<p>I am trying to customize Background color and font color of a ListView item using OnCustomDrawItem event. However, the border color of subitem is always the background color of ListView. Does anyone know how to fix this? Here is the code i am using:</p>\n\n<pre><code>procedure TForm1.ListView1CustomDrawItem(Sender: TCustomListView;\n  Item: TListItem; State: TCustomDrawState; var DefaultDraw: Boolean);\nvar\n  lst: TListView;\n  i: integer;\n  f1, f2, c1, c2: TColor;\nbegin\n  if (TListView(Sender).ViewStyle = vsIcon) then\n    Exit;\n  lst := Sender as TListView;\n  lst.Canvas.Brush.Style := bsSolid;\n  i := lst.Items.Count;\n  if (i mod 2) &lt;&gt; 0 then\n  begin\n    c1 := clWhite;\n    c2 := $00F8F8F8;\n    f1 := clBlue;\n    f2 := clBlack;\n  end else\n  begin\n    c1 := $00F8F8F8;\n    c2 := clWhite;\n    f1 := clBlack;\n    f2 := clBlue;\n  end;\n  // Painting...\n  if (Item.Index mod 2) = 0 then\n  begin\n    lst.Canvas.Brush.Color := c2;\n    lst.Canvas.Font.Color := f2;\n  end else\n  begin\n    lst.Canvas.Brush.Color := c1;\n    lst.Canvas.Font.Color := f1;\n  end;\nend;\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>There is a GAP between column of SubItems. This GAP is the color of ListView's background.</p>\n\n<p>I use Delphi XE2 and OS: Windows 7 bit bit.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12619937,"title":"Why does 2nd call to ShBrowseForFolder fail in this code?","body":"<p>The wrapper code below for calling ShBrowseForFolder works only once: if I call the Execute method a second time, the dialog does not appear on the \"PtrIDL := ShBrowseForFolder(BrowseInfo);\" call. Can anyone see what's wrong?</p>\n\n<pre><code>unit ShBrowseU;\n(* Wrapper for ShBrowseForFolder\n *  22/01/2004\n *\n * Changes JD 6-7-2012:\n * - Inherit from TComponent\n * - Published properties\n * Changes JD 27-9-2012:\n * - Coinitialize call only once\n * Todo:\n * - Make UNCFolder, FolderCheck, Options and SelIconIndex published properties\n * - Catch Left/Top input &lt; 0\n * - Component needs icon\n *)\n\ninterface\n\nuses\n  Windows, Messages, SysUtils, Classes, Dialogs, ShlObj ;\n\ntype\n  TFolderCheck = function(Sender : TObject; Folder : string) : boolean of object;\n\n  TShBrowseOption = (sboBrowseForComputer, sboBrowseForPrinter,\n                     sboBrowseIncludeFiles, sboBrowseIncludeURLs,\n                     sboDontGoBelowDomain, sboEditBox, sboNewDialogStyle,\n                     sboNoNewFolderButton, sboReturnFSAncestors,\n                     sboReturnOnlyFSDirs, sboShareable, sboStatusText,\n                     sboUAHint, sboUseNewUI, sboValidate);\n  TShBrowseOptions = set of TShBrowseOption;\n\n  TShBrowse = class(TComponent)\n  private\n    FBrowseWinHnd : THandle;\n    FCaption : string;\n    FFolder : string;\n    FFolderCheck : TFolderCheck;\n    FInitFolder : string;\n    FLeft : integer;\n    FOptions : TShBrowseOptions;\n    FSelIconIndex : integer;\n    FTop : integer;\n    FUserMessage : string;\n    WinFlags : DWord;\n    FCoInitialized: Boolean;\n    procedure Callback(Handle : THandle; MsgId : integer; lParam : DWord);\n    function GetUNCFolder : string;\n    function IdFromPIdL(PtrIdL : PItemIdList; FreeMem : boolean) : string;\n    procedure SetOptions(AValue : TShBrowseOptions);\n  protected\n    property BrowseWinHnd : THandle read FBrowseWinHnd write FBrowseWinHnd;\n  published\n    property Caption : string read FCaption write FCaption;\n    property InitFolder : string read FInitFolder write FInitFolder;\n    property Left : integer read FLeft write FLeft; // both Left &amp; Top must be &gt; 0 to position window\n    property Top : integer read FTop write FTop;\n    property UserMessage : string read FUserMessage write FUserMessage;\n  public\n    constructor Create(AOwner: TComponent); override;\n    function Execute : boolean;\n    property Folder : string read FFolder;\n    property UNCFolder : string read GetUNCFolder;\n    property FolderCheck : TFolderCheck write FFolderCheck;\n    property Options : TShBrowseOptions read FOptions write SetOptions;\n    property SelIconIndex : integer read FSelIconIndex;\n  end;\n\nimplementation\n\nuses\n  ActiveX;\n\nconst\n  BIF_RETURNONLYFSDIRS    = $00000001;\n  BIF_DONTGOBELOWDOMAIN   = $00000002;\n  BIF_STATUSTEXT          = $00000004;\n  BIF_RETURNFSANCESTORS   = $00000008;\n  BIF_EDITBOX             = $00000010;\n  BIF_VALIDATE            = $00000020;\n  BIF_NEWDIALOGSTYLE      = $00000040;\n  BIF_USENEWUI            = $00000040;\n  BIF_BROWSEINCLUDEURLS   = $00000080;\n  BIF_NONEWFOLDERBUTTON   = 0;\n  BIF_UAHINT              = 0;\n  BIF_BROWSEFORCOMPUTER   = $00001000;\n  BIF_BROWSEFORPRINTER    = $00002000;\n  BIF_BROWSEINCLUDEFILES  = $00004000;\n  BIF_SHAREABLE           = $00008000;\n  BFFM_VALIDATEFAILED     = 3;\n\n  ShBrowseOptionArray : array[TShBrowseOption] of DWord =\n                    (BIF_BROWSEFORCOMPUTER, BIF_BROWSEFORPRINTER,\n                     BIF_BROWSEINCLUDEFILES, BIF_BROWSEINCLUDEURLS,\n                     BIF_DONTGOBELOWDOMAIN, BIF_EDITBOX, BIF_NEWDIALOGSTYLE,\n                     BIF_NONEWFOLDERBUTTON, BIF_RETURNFSANCESTORS,\n                     BIF_RETURNONLYFSDIRS, BIF_SHAREABLE, BIF_STATUSTEXT,\n                     BIF_UAHINT, BIF_USENEWUI, BIF_VALIDATE);\n\nfunction ShBFFCallback(hWnd : THandle; uMsg : integer;\n                       lParam, lpData : DWord) : integer; stdcall;\n{connects the ShBFF callback general function to the\n Delphi method which handles it}\nbegin\n  TShBrowse(lpData).Callback(hWnd, uMsg, lParam); // calls object's method\n  Result := 0;\nend;\n\nconstructor TShBrowse.Create(AOwner: TComponent);\nbegin\n  inherited Create(AOwner);\n  Caption := 'Browse for folder';  // default\n  UserMessage := 'Select folder';  // default\nend;\n\nprocedure TShBrowse.Callback(Handle : THandle; MsgId : integer; lParam : DWord);\n{Delphi method which handles the ShBFF callback}\nvar\n  WorkArea, WindowSize : TRect;\n  BFFWidth, BFFHeight : integer;\n  SelOK : boolean;\nbegin\n  FBrowseWinHnd := Handle;\n  case MsgId of\n    BFFM_INITIALIZED :\n        begin\n          if (FLeft = 0) or (FTop = 0) then begin\n            {center the browse window on screen}\n            GetWindowRect(FBrowseWinHnd, WindowSize);  // get ShBFF window size\n            with WindowSize do begin\n              BFFWidth := Right - Left;\n              BFFHeight := Bottom - Top;\n            end;\n            SystemParametersInfo(SPI_GETWORKAREA, 0, @WorkArea, 0); // get screen size\n            with WorkArea do begin  // calculate ShBFF window position\n              FLeft := (Right - Left - BFFWidth) div 2;\n              FTop := (Bottom - Top - BFFHeight) div 2;\n            end;\n          end;\n          {set browse window position}\n          // SetWindowPos(FBrowseWinHnd, HWND_TOP, FLeft, FTop, 0, 0, SWP_NOSIZE);\n          SetWindowPos(FBrowseWinHnd, HWND_TOPMOST, FLeft, FTop, 0, 0, SWP_NOSIZE);  // Always on top\n          if (FCaption &lt;&gt; '') then\n            {set Caption}\n            SendMessage(FBrowseWinHnd, WM_SETTEXT, 0, integer(PChar(FCaption)));\n          if (FInitFolder &lt;&gt; '') then\n            {set initial folder}\n            SendMessage(FBrowseWinHnd, BFFM_SETSELECTION, integer(LongBool(true)),\n                        integer(PChar(FInitFolder)));\n        end;\n    BFFM_SELCHANGED :\n        begin\n          if Assigned(FFolderCheck) then\n            {get folder and check for validity}\n            if (lParam &lt;&gt; 0) then begin\n              FFolder := IdFromPIdL(PItemIdList(lParam), false);\n              {check folder ....}\n              SelOK := FFolderCheck(Self, FFolder);\n              {... en/disable OK button}\n              SendMessage(Handle, BFFM_ENABLEOK, 0, integer(SelOK));\n            end; {if (lParam &lt;&gt; nil)}\n          {end; if Assigned(FFolderCheck)}\n        end;\n  {  BFFM_IUNKNOWN :;\n    BFFM_VALIDATEFAILED :;  }\n  end;\nend;\n\nprocedure TShBrowse.SetOptions(AValue : TShBrowseOptions);\nvar\n  I : TShBrowseOption;\nbegin\n  if (AValue &lt;&gt; FOptions) then begin\n    FOptions := AValue;\n    WinFlags := 0;\n    for I := Low(TShBrowseOption) to High(TShBrowseOption) do\n      if I in AValue then\n        WinFlags := WinFlags or ShBrowseOptionArray[I];\n  end;\nend;\n\nfunction TShBrowse.Execute : boolean;\n// Called to display the ShBFF window and return the selected folder\nvar\n  BrowseInfo : TBrowseInfo;\n  IconIndex  : integer;\n  PtrIDL     : PItemIdList;     // Item identifier list\nbegin\n  FillChar(BrowseInfo, SizeOf(TBrowseInfo), #0);\n  IconIndex := 0;\n  with BrowseInfo do begin\n    hwndOwner := Self.FBrowseWinHnd;\n    PIDLRoot  := nil;\n    pszDisplayName := nil;\n    lpszTitle := PChar(FUserMessage);\n    ulFlags   := WinFlags;\n    lpfn      := @ShBFFCallback;\n    lParam    := integer(Self); // this object's reference\n    iImage    := IconIndex;\n  end;\n\n//  if not FCoInitialized then FCoInitialized := Succeeded(CoInitializeEx(nil,COINIT_APARTMENTTHREADED));\n\n  PtrIDL := ShBrowseForFolder(BrowseInfo);\n  if PtrIDL = nil then\n    Result := false\n  else begin\n    FSelIconIndex := BrowseInfo.iImage;\n    FFolder := IdFromPIdL(PtrIDL, true);   // This clears memory again\n    Result := true;\n  end; {if PtrIDL = nil else}\nend;\n\nfunction TShBrowse.IdFromPIdL(PtrIdL : PItemIdList; FreeMem : boolean) : string;\nvar\n  AMalloc : IMalloc;\nbegin\n  Result := '';\n  SetLength(Result, MAX_PATH);\n  SHGetPathFromIDList(PtrIDL, PChar(Result));\n  Result := trim(Result);\n  Result := string(PChar(Result));\n  // When a PIDL is passed via BFFM_SELCHANGED and that selection is OK'ed\n  // then the PIDL memory is the same as that returned by ShBrowseForFolder.\n  // This leads to the assumption that ShBFF frees the memory for the PIDL\n  // passed by BFFM_SELCHANGED if that selection is NOT OK'ed. Hence one\n  // should free memory ONLY when ShBFF returns, NOT for BFF_SELCHANGED\n  if FreeMem then begin\n    {free PIDL memory ...}\n    ShGetMalloc(AMalloc);\n    AMalloc.Free(PtrIDL);\n  end;\nend;\n\nfunction TShBrowse.GetUNCFolder : string;\n  function GetErrorStr(Error : integer) : string;\n  begin\n    Result := 'Unknown Error : ' + IntToStr(Error); // default\n    case Error of\n      ERROR_BAD_DEVICE :         Result := 'Invalid path';\n      ERROR_CONNECTION_UNAVAIL : Result := 'No connection';\n      ERROR_EXTENDED_ERROR :     Result := 'Network error';\n      ERROR_MORE_DATA :          Result := 'Buffer too small';\n      ERROR_NOT_SUPPORTED :      Result := 'UNC name not supported';\n      ERROR_NO_NET_OR_BAD_PATH : Result := 'Unrecognised path';\n      ERROR_NO_NETWORK :         Result := 'Network unavailable';\n      ERROR_NOT_CONNECTED :      Result := 'Not connected';\n    end;\n  end;\n\nvar\n  LenResult  : Cardinal;\n  Error      : integer;\n  PtrUNCInfo : PUniversalNameInfo;\n\nbegin\n  {note that both the PChar _and_ the characters it\n   points to are placed in UNCInfo by WNetGetUniversalName\n   on return, hence the extra allocation for PtrUNCInfo}\n  LenResult := 4 + MAX_PATH; // \"4 +\" for storage for lpUniversalName == @path\n  SetLength(Result, LenResult);\n  PtrUNCInfo := AllocMem(LenResult);\n  // bh, 13-8-2012, PAnsiChar replaced by PWideChar\n  Error := WNetGetUniversalName(PWideChar(FFolder), UNIVERSAL_NAME_INFO_LEVEL,\n                                PtrUNCInfo, LenResult);\n  if Error = NO_ERROR then begin\n    Result := string(PtrUNCInfo^.lpUniversalName);\n    SetLength(Result, Length(Result));\n    end\n  else\n    Result := GetErrorStr(Error);\nend;\n\nend.\n</code></pre>\n\n<p>Note that I commented out the CoInitializeEx call, but that makes no difference. </p>\n\n<p>This is XE2 code , a Win32 testapp under Win7 64 bits.</p>\n\n<p>Thanks in advance\nJan</p>\n"},{"tags":["wcf","delphi","c#-4.0","delphi-7"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":115,"score":2,"question_id":12604734,"title":"Delphi: WSDL objects not included in WSDL file","body":"<p>I am trying to create a WCF service in C# for use by a client app built using Delphi.  When downloading the WSDL in Delphi, no objects are included in the file generated by Delphi.</p>\n\n<p>What do I have to do in C# to declare the objects in the WSDL when imported into Delphi? </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I am using EntityFramework in C# to generate the classes from the database (it was an existing database so please don't tell me I should do code first).  Here is an example of one of the class files:</p>\n\n<pre><code>namespace LeadVendorModel\n{\n    using System;\n    using System.Collections.Generic;\n    using System.Data.Entity;\n\n    public partial class T_LeadVendorEmailDetail : DbContext\n    {\n        public int LeadVendorEmailDetailID { get; set; }\n        public int LeadVendorEmailID { get; set; }\n        public string Field_label { get; set; }\n        public string Field_Data { get; set; }\n        public Nullable&lt;System.DateTime&gt; EnteredOn { get; set; }\n\n        public virtual T_LeadVendorEmailHeader T_LeadVendorEmailHeaders { get; set; }\n    }\n}\n</code></pre>\n\n<p>I am simply using the 'Publish' action in the C# project to publish the project.  I am not sure where else I would define the types/objects that Delphi is complaining about.  Is there a XML setting that I need to add to Web.config?</p>\n\n<p>I am happy to give any other info needed, just not sure what else would help (first time using EF and first time creating an API).</p>\n\n<p><strong>END EDIT</strong></p>\n\n<p>Here is a snippet of the generated file (no objects created):</p>\n\n<pre><code>unit LeadService;\n\ninterface\n\nuses InvokeRegistry, SOAPHTTPClient, Types, XSBuiltIns;\n\ntype\n\n  // ************************************************************************ //\n  // The following types, referred to in the WSDL document are not being represented\n  // in this file. They are either aliases[@] of other types represented or were referred\n  // to but never[!] declared in the document. The types from the latter category\n  // typically map to predefined/known XML or Borland types; however, they could also\n  // indicate incorrect WSDL documents that failed to declare or import a schema type.\n  // ************************************************************************ //\n  // !:GetFranchiseDetails - \"http://tempuri.org/\"\n  // !:GetFranchiseDetailsResponse - \"http://tempuri.org/\"\n  // !:FranchiseExists - \"http://tempuri.org/\"\n  // !:FranchiseExistsResponse - \"http://tempuri.org/\"\n  // !:GetLeadDetails  - \"http://tempuri.org/\"\n  // !:GetLeadDetailsResponse - \"http://tempuri.org/\"\n  // !:GetLookupList   - \"http://tempuri.org/\"\n  // !:GetLookupListResponse - \"http://tempuri.org/\"\n  // !:SubmitLead      - \"http://tempuri.org/\"\n  // !:SubmitLeadResponse - \"http://tempuri.org/\"\n  // !:SubmitLeadAction - \"http://tempuri.org/\"\n  // !:SubmitLeadActionResponse - \"http://tempuri.org/\"\n  // !:SubmitLeadOutcome - \"http://tempuri.org/\"\n  // !:SubmitLeadOutcomeResponse - \"http://tempuri.org/\"\n\n\n  // ************************************************************************ //\n  // Namespace : http://tempuri.org/\n  // binding   : wsHttpBinding\n  // service   : LeadService\n  // port      : wsHttpBinding\n  // ************************************************************************ //\n  ILeadService = interface(IInvokable)\n  ['{C61A5600-2BA8-436A-41AA-F81C45A9A738}']\n    function  GetFranchiseDetails(const parameters: GetFranchiseDetails): GetFranchiseDetailsResponse; stdcall;\n    function  FranchiseExists(const parameters: FranchiseExists): FranchiseExistsResponse; stdcall;\n    function  GetLeadDetails(const parameters: GetLeadDetails): GetLeadDetailsResponse; stdcall;\n    function  GetLookupList(const parameters: GetLookupList): GetLookupListResponse; stdcall;\n    function  SubmitLead(const parameters: SubmitLead): SubmitLeadResponse; stdcall;\n    function  SubmitLeadAction(const parameters: SubmitLeadAction): SubmitLeadActionResponse; stdcall;\n    function  SubmitLeadOutcome(const parameters: SubmitLeadOutcome): SubmitLeadOutcomeResponse; stdcall;\n  end;\n\nfunction GetILeadService(UseWSDL: Boolean=System.False; Addr: string=''; HTTPRIO: THTTPRIO = nil): ILeadService;\n</code></pre>\n\n<p>Here is a snippet of another Delphi generated file which includes the object definitions:</p>\n\n<pre><code>interface\n\nuses InvokeRegistry, SOAPHTTPClient, Types, XSBuiltIns;\n\ntype\n\n  // ************************************************************************ //\n  // The following types, referred to in the WSDL document are not being represented\n  // in this file. They are either aliases[@] of other types represented or were referred\n  // to but never[!] declared in the document. The types from the latter category\n  // typically map to predefined/known XML or Borland types; however, they could also\n  // indicate incorrect WSDL documents that failed to declare or import a schema type.\n  // ************************************************************************ //\n  // !:dateTime        - \"http://www.w3.org/2001/XMLSchema\"\n  // !:int             - \"http://www.w3.org/2001/XMLSchema\"\n  // !:boolean         - \"http://www.w3.org/2001/XMLSchema\"\n  // !:decimal         - \"http://www.w3.org/2001/XMLSchema\"\n  // !:string          - \"http://www.w3.org/2001/XMLSchema\"\n\n  CompanyID            = class;                 { \"http://...\" }\n  Address              = class;                 { \"http://...\" }\n  Property_            = class;                 { \"http://...\" }\n  AppointmentRequest   = class;                 { \"http://...\" }\n\n\n  { \"http://...\" }\n  PersonServiceRoleID = (\n      BuyersAgent, \n      SellersAgent, \n      SellersLawyer, \n      BuyersLawyer, \n      Seller,\n      Buyer, \n      Owner, \n      Tenant, \n      TransactionCoordinator, \n      RelocationCoordinator, \n      ReferredBy,\n      ContractorAdministrator, \n      InsuranceAgent, \n      Contractor,\n      PropertyManagement, \n      Buyer1,\n      Seller1, \n      Owner1, \n      Tenant1\n);\n\n  { \"http://...\" }\n  PersonSearchCriteriaActiveType = (DeletedOnly, Both, UndeletedOnly);\n\n  ArrayOfInt = array of Integer;                { \"http://...\" }\n\n\n  // ************************************************************************ //\n  // Namespace : http://...\n  // ************************************************************************ //\n  CompanyID = class(TRemotable)\n  private\n    FServiceCompanyID: Integer;\n  published\n    property ServiceCompanyID: Integer read FServiceCompanyID write FServiceCompanyID;\n  end;\n\n\n  // ************************************************************************ //\n  // Namespace : http://...\n  // soapAction: http://...\n  // transport : http://schemas.xmlsoap.org/soap/http\n  // binding   : CompanySoap\n  // service   : Company\n  // port      : CompanySoap\n  // URL       : http://...\n  // ************************************************************************ //\n  CompanySoap= interface(IInvokable)\n  ['{44A8B9BE-7E75-8534-279B-46BF5D1674D7}']\n    function  GetAvailableAppointments(const appointmentRequest: AppointmentRequest; const companyID: CompanyID): ArrayOfAppointmentSlot; stdcall;\n    function  GetQuote(const quoteRequest: QuoteRequest; const companyID: CompanyID): ServiceFee; stdcall;\n    function  GetPropertyTypes(const companyID: CompanyID): ArrayOfPropertyType; stdcall;\n    function  GetFoundationTypes(const companyID: CompanyID): ArrayOfFoundationType; stdcall;\n    function  GetServiceTypes(const companyID: CompanyID): ArrayOfServiceType; stdcall;\n    function  GetServiceProfessionals(const companyID: CompanyID): ArrayOfInspectorDetails; stdcall;\n    function  ScheduleAppointment(const appointmentslot: AppointmentSlot; const customer: Contact; const companyID: CompanyID; const Quote: QuoteRequest; const agent: ArrayOfServiceAgent): AppointmentInfo; stdcall;\n    function  FindAppointment(const contactID: Integer; const companyID: CompanyID): ArrayOfAppointmentInfo; stdcall;\n    procedure CancelAppointment(const companyID: CompanyID; const appointmentID: Integer); stdcall;\n    function  CustomerLookUp(const criteria: PersonSearchCriteria): ArrayOfContact; stdcall;\n    function  AddContact(const customer: Contact; const companyID: CompanyID): Contact; stdcall;\n    function  UpdateContact(const customer: Contact; const companyID: CompanyID): Contact; stdcall;\n    function  ProcessCompanyID(const serviceCompanyID: CompanyID): CompanyID; stdcall;\n  end;\n\nfunction GetCompanySoap(UseWSDL: Boolean=System.False; Addr: string=''; HTTPRIO: THTTPRIO = nil): CompanySoap;\n</code></pre>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":63,"score":3,"question_id":12620359,"title":"How can I convert a TRTTIInstanceType obj reference to its actual object reference?","body":"<p>I am trying to use extented RTTI features This is where i stuck.</p>\n\n<pre><code>t := (c.FindType('Classes.TStringList') as TRttiInstanceType);\nSL := t.GetMethod('Create').Invoke(t.MetaclassType,[]);\nt.GetMethod('Add').Invoke(SL,['Hello Do you like my hat?']);\nLines := t.GetProperty('Text').GetValue(SL.AsObject);\n</code></pre>\n\n<p>Untill now it works fine\nNow i want to alter the value</p>\n\n<pre><code>Lines := 'Test';\n\nt.GetProperty('Text').SetValue(**?**,Lines);\n</code></pre>\n\n<p>What should i give here the TRTTIinstancetype reference or the actual object reference.\nIf Actual Object reference how will i give that.</p>\n\n<pre><code>TestStringList := t(**how will i get the actual object from this TRTTIinstancetype**).\n</code></pre>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12619319,"title":"Refresh label caption before loading?","body":"<p>I have a piece of code:</p>\n\n<pre><code>setEnableControls(false);\nlblLoading.Caption:='Loading tree contents, please wait.';\nsomeBigLoading(); \nsetEnableControls(true);\nlblLoading.Caption:='';\n</code></pre>\n\n<p>The problem is, the label's caption text doesn't refresh until after the \"big loading\" is complete. \nIs there a way to make the program process the message in the message queue, BEFORE going onto the next command?</p>\n"},{"tags":["delphi","tframe"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":99,"score":1,"question_id":12612442,"title":"Centering a Tframe within a TTabSheet;","body":"<p>I have a delphi application that used a <code>PageControl</code> with a number of <code>TabSheets</code>.  I also create new <code>TabSheets</code> at runtime and populate them with instances of predefined frames.  These frames work well, except for the cosmetic problem of not centering on the <code>TabSheet</code>.  I have tried to use <code>Frame.Align := alClient</code>, but that didn't do it.  The relevant code follows:</p>\n\n<pre><code>CreateNewPage(3);\nNewLimitedChoiceFrame := TLimitedChoiceFrame.Create(NewInputPage);\nNewLimitedChoiceFrame.Parent := NewInputPage;\n</code></pre>\n\n<p><code>CreateNewPage</code> creates a new instance of a <code>TabSheet</code> and makes the <code>PageControl</code> it's owner and parent.  The result is assigned to the global variable <code>NewInputPage</code>.</p>\n"},{"tags":["delphi","refactoring","folder","delphi-xe","directory-structure"],"answer_count":4,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":336,"score":9,"question_id":12617648,"title":"How to reorganize the folder structure of my units in Delphi?","body":"<p>I started a prototype with Delphi with <strong>all source files under one single directory</strong>.<br>\nNow, I want to <strong>reorganize everything with folders</strong>.  </p>\n\n<p>I found two way to do this.</p>\n\n<p>1/ First is to open each unit in Delphi IDE and <code>Save as</code>  the new folder. Then delete the old unit file.</p>\n\n<p>2/ Under windows explorer, reorganize everything, then open the project in Delphi IDE, remove reference to old (unknown) units, and then add each unit folder by folder.</p>\n\n<p>As I have 100+ units, it is really painful, whatever method I use (1 or 2).<br>\n<strong>How are you doing such reorganization ?</strong>\nDid I miss a feature ?</p>\n"},{"tags":["delphi","teechart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12601971,"title":"Is it possible to draw TeeChart PieSeries titles on the pies instead of the legend?","body":"<p>I have a <code>DBChart</code> with four <code>PieSeries</code> on it. Each chart has multiple slices, and is multicolored. I'd like to have the title of each series written either on it or beneath it, instead of the legend. Is there any easy way to accomplish this? I'm using TeeChart Standard v2011.03.32815 VCL</p>\n"},{"tags":["delphi","windows-7","delphi-7","windows-server-2008-r2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":222,"score":2,"question_id":12349922,"title":"Window 7 & Windows Server 2008 R2: significant increase in run time","body":"<p>We are developing a console software, with Delphi 7.</p>\n\n<p>To simplify, this software is using an embedded TCP server to answer to external requests from a CGI. These answers contain generated HTML pages with Teechart graphs, and data extracted from a database, using DbExpress.</p>\n\n<p>On Windows 7 and Windows 2008 R2 servers, we noticed significant increase of the run time of our software – 2 or 3 times the original process time on Windows XP or Windows Server 2003 – in a standard context of execution: software launched as a Service with the system user account.</p>\n\n<p>But when our software is launched as a simple user, from command prompt, or directly from the IDE (debug mode), the problem simply disappear.</p>\n\n<p><strong>My first question is : has anyone already noticed this problem?</strong></p>\n\n<p>Using ProcessExplorer, we also noticed that when the software is launched as a service, there is no GDI Handle created, nor is a User Handle. But when the software is launched with a user account, some of these handles are created. With Windows XP  and Windows Server 2003, either the software is launched as a service or with a simple user account, these handles are always created.</p>\n\n<p><strong>Can this observation be linked with our problem?</strong></p>\n\n<p><strong>If you already noticed these behaviour, how did you fix the problem?</strong></p>\n"},{"tags":["mysql","delphi","64bit","delphi-xe2","dbexpress"],"answer_count":6,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":6023,"score":2,"question_id":7577658,"title":"Delphi XE2 dbExpress MySQL connection","body":"<p>No matter what I've tried, I couldn't make XE2 to connect to a MySQL with dbExpress. The problem has actually many faces. First, target MySQL is either 32- or 64-bits, which affects the libmysql.dll that comes with the MySQL installation, which seems to be misleading because XE2 IDE is a 32-bit application and it only accepts 32-bit DLLs. So I needed to use a 32-bit installation libmysql.dll, put it under Windows\\System32 (or to the project's folder itself), and then set the Target compile platform to 32-bit in my project (so that it won't try to use 64-bit dbxmys.dll, just in case), still with no luck. All the combinations I tried resulted with this error: \"DBX Error: Driver could not be properly initialized. Client library may be missing.......\"</p>\n\n<p>Anyone who's able to make XE2 dbExpress connect to a MySQL server? I need your help. Thanks in advance.</p>\n\n<p>Windows 7 64-bit (dev platform with XE2), MySQL 5.5.16 32-bit (installed on a remote XP 32-bit) / MySQL 5.1.54 64-bit (installed on a remote XP x64) (tried with both, by using their libmysql.dlls)</p>\n"},{"tags":["delphi","delphi-xe2","soap-client","firemonkey"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":85,"score":1,"question_id":12608255,"title":"How do I create a generic Firemonkey SOAP client with arbitrary WSDL?","body":"<p>I want to create (for OSX) a simple Firemonkey SOAP client that enables me to specify an endpoint and SOAP method, then pass arbitrary XML inside a SOAP envelope.  It's my job to make sure my XML conforms to the WSDL on the other end; since it's a general-purpose utility there is not one WSDL schema I can wire into the application.</p>\n\n<p>I was able to do this easily in a VCL application on Delphi XE2 using the THTTPReqResp component - works like charm.  But when I try to create a Firemonkey equivalent for this application, it seems like I'm forced to import a specific WSDL and bind to that.  Is there a way to do something more generic?  The various SOAP components seem a lot more complex to work with and I'm not finding either good documentation or demo applications that do what I need to do.</p>\n\n<p>Thanks in advance - E.</p>\n"},{"tags":["delphi","dynamic","methods","invoke"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12611409,"title":"Delphi Dynamic method invocation","body":"<p>Does anyone know of a free library for Delphi 2009 and below that allows you to invoke methods dynamically?</p>\n\n<p>I have started writing my own code for this but I have the feeling that it is beyond me.</p>\n\n<p>Thanks</p>\n"},{"tags":["c","delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":105,"score":-1,"question_id":12612243,"title":"Convert C Code to Delphi","body":"<p>I need to convert this Line from C to Delphi.</p>\n\n<pre><code>Int CALLBACK EXPORT EXAMPLEFUNCTION(VOID){\n  SETEVENT(hasync);\n  Return Success;\n}\n</code></pre>\n\n<p>Please i need some  help.</p>\n\n<p>thanks ;)</p>\n"},{"tags":["delphi","operator-keyword","semicolon"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":110,"score":1,"question_id":12611855,"title":"Delphi: Missing Operator or Semicolon","body":"<p>I am using Indy 10(TIdTcpServer) and I get the following error:</p>\n\n<pre><code>[DCC Error] MainForm.pas(88): E2066 Missing operator or semicolon\n</code></pre>\n\n<p>When trying to run this code:</p>\n\n<pre><code>procedure TForm1.SendMessage(Data: String; Client: Integer);\nvar\n  List: TList;\n  AContext: TIdContext;\nbegin\n  List := idTcpServer1.Contexts.LockList;\n  AContext(List[0]).Connection.IOHandler.WriteLn(Data);  // Line 88\nend;\n</code></pre>\n\n<p>I cannot figure out what I am missing; any help?</p>\n"},{"tags":["xml","delphi","delphi-2010","xmldocument"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":12459128,"title":"How can I read and write data from an xml file using Delphi","body":"<p>I am trying to read and write to an XMLDocument, I am new to xml.  I want to be able to read the data of the different Nodes and write changes to the file.  I was only able to read the heading Node:  Here is the code:</p>\n\n<pre><code>  var\n    DispenseData, Clinic: IXMLNode;\n    Current: Integer;\n  begin\n    Memo1.Lines.Clear;\n    current := 0;\n    Clinic := XMLDocument1.DocumentElement.ChildNodes['Msg_Header'];  //Msg_Header\n    Clinic.ChildNodes['Version'].Text := '7.1';\n    Memo1.Lines.Add(Clinic.ChildNodes['Version'].Text);\n    Memo1.Lines.Add(Clinic.ChildNodes['MsgType'].Text);\n    Memo1.Lines.Add(Clinic.ChildNodes['RequestType'].Text);\n    Clinic := XMLDocument1.DocumentElement.NextSibling;//('DispenseData');\n    Memo1.Lines.Add(Clinic.NextSibling['RxId'].Text);\n    XMLDocument1.SaveToFile('C:\\Program Files\\Wescom\\Parata\\file\\new.xml');\n  end;\n</code></pre>\n"},{"tags":["sql","delphi","ocl"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":295,"score":2,"question_id":3017937,"title":"Translate SQL to OCL?","body":"<p>I have a piece of SQL that I want to translate to OCL. I'm not good at SQL so I want to increase maintainability by this. We are using Interbase 2009, Delphi 2007 with Bold and modeldriven development. Now my hope is that someone here both speaks good SQL and OCL :-)\nThe original SQL:</p>\n\n<pre><code>Select Bold_Id, MessageId, ScaniaId, MessageType, MessageTime, Cancellation, ChassieNumber, UserFriendlyFormat, ReceivingOwner, Invalidated, InvalidationReason,\n(Select Parcel.MCurrentStates From Parcel\nWhere ScaniaEdiSolMessage.ReceivingOwner = Parcel.Bold_Id) as ParcelState From ScaniaEdiSolMessage\nWhere MessageType = 'IFTMBP' and\nnot Exists (Select * From ScaniaEdiSolMessage EdiSolMsg\nWhere EdiSolMsg.ChassieNumber = ScaniaEdiSolMessage.ChassieNumber and EdiSolMsg.ShipFromFinland = ScaniaEdiSolMessage.ShipFromFinland and EdiSolMsg.MessageType = 'IFTMBF') and\ninvalidated = 0 Order By MessageTime desc\n</code></pre>\n\n<p>After a small simplification:</p>\n\n<pre><code>Select Bold_Id, (Select Parcel.MCurrentStates From Parcel \nwhere ScaniaEdiSolMessage.ReceivingOwner = Parcel.Bold_Id) From ScaniaEdiSolMessage\nWhere MessageType = 'IFTMBP' and not Exists (Select * From ScaniaEdiSolMessage\nEdiSolMsg Where EdiSolMsg.ChassieNumber = ScaniaEdiSolMessage.ChassieNumber and\nEdiSolMsg.ShipFromFinland = ScaniaEdiSolMessage.ShipFromFinland and \nEdiSolMsg.MessageType = 'IFTMBF') and invalidated = 0\n</code></pre>\n\n<p><strong>NOTE</strong>: There are 2 cases for MessageType, 'IFTMBP' and 'IFTMBF'.</p>\n\n<p>So the table to be listed is ScaniaEdiSolMessage.\nIt has attributes like:</p>\n\n<ul>\n<li>MessageType: String </li>\n<li>ChassiNumber: String </li>\n<li>ShipFromFinland: Boolean</li>\n<li>Invalidated: Boolean</li>\n</ul>\n\n<p>It has also a link to table Parcel named ReceivingOwner with BoldId as key.</p>\n\n<p>So it seems like it list all rows of ScaniaEdiSolMessage and then have a subquery that also list all rows of ScaniaEdiSolMessage and name it EdiSolMsg. Then it exclude almost all rows. In fact the query above give one hit from 28000 records.</p>\n\n<p>In OCL it is easy to list all instances:</p>\n\n<pre><code>ScaniaEdiSolMessage.allinstances\n</code></pre>\n\n<p>Also easy to filter rows by select for example:</p>\n\n<pre><code>ScaniaEdiSolMessage.allinstances-&gt;select(shipFromFinland and not invalidated)\n</code></pre>\n\n<p>But I do not understand how I should make a OCL to match the SQL above.</p>\n"},{"tags":["json","flash","delphi","delphi-xe2","twebbrowser"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":140,"score":2,"question_id":12596787,"title":"Parsing a flash json response (Delphi/ TWebbrowser)","body":"<p>I have a flash game and get updates after pressing a button. Only a table inside the flash gets updated and the changes are not shown in the html source (well, its flash after all). Logging with Fiddler shows first one encrypted package (containing all data of the table after decoding with Fiddler) followed by 16x json packages (single entry of the table).</p>\n\n<p>What i want to know is how to get those single packages in Delphi. </p>\n\n<p>I do not want to alter the data, i simply want to read them. I cant make any changes to anything (webserver, flash, etc).</p>\n"},{"tags":["delphi","delphi-xe2","dbgrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":121,"score":0,"question_id":12607860,"title":"Strange behaviour of DBGrid in Delphi while scrolling down with mouse wheel","body":"<p>I have a problem and I don't know how to solve it.</p>\n\n<h2>So here it is -></h2>\n\n<p>I had a program in Delphi 7 and I wanted to move it on Delphi XE2...</p>\n\n<p>Now I moved it and everything works fine, except one thing...</p>\n\n<p>When I want to scroll down with my mouse wheel, it scrolls up... Strange...</p>\n\n<p>Than, I made a new project from XE2, and put DBGrid and all connection components that are required to successfully pass the connection and everything is fine. It scrolls down nicely.</p>\n\n<p>So, how to solve this kind of problem?</p>\n"},{"tags":["delphi","freepascal","lazarus"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":165,"score":4,"question_id":12594489,"title":"Differences in Form Initialization between Delphi and Lazarus?","body":"<p>MainForm creates some secondary Frame objects at runtime to display various option panels. </p>\n\n<p>Here's a typical constructor for one of those frame classes (they each extend TFrame):</p>\n\n<pre><code>constructor Tframe2.Create(AOwner: TComponent);\nbegin\n    inherited;\n    edTime.Text := '12:00pm'; //edTime is a TEdit control. this line is where it throws the exception\n    //etc.\nend;\n</code></pre>\n\n<p>This code worked fine in Delphi (whether or not it was the right way to do things), but the same code in Lazarus keeps throwing an EInvalidOperation exception, because the control (TEdit) has no parent \"window\" assigned yet (rsControlHasNoParentWindow), which actually kind of makes sense when I examine the code because the parent doesn't appear to be getting assigned until after the constructor is called. </p>\n\n<p>Here is the code in MainForm the initializes the secondary frame:</p>\n\n<pre><code>if Assigned(frame) then FreeAndNil(frame);\ncase Node.AbsoluteIndex of\n    optInterval: frame := Tframe2.Create(Self); //here's where the constructor gets called.\n    //etc\nend;\nframe := TframeOther.Create(Self); \nif Assigned(frame) then\nbegin\n    frame.Parent := panOptions; //here's where Tframe2's parent gets set\n    frame.Align := alClient;\nend;  \n</code></pre>\n\n<p>So can anyone explain whether there's any important differences between Delphi and Lazarus as far as form initialization sequence? </p>\n\n<p>And what the most standard way to resolve this type of initialization order problem would be? Comparing to other languages I'm more familiar with, there might be different strategies to resolve such errors. I could add another parameter to the constructor, or if there's a method that gets called post constructor pre-drawing it on the screen that I could override I could relocate that code, or just make a helper method and call it after setParent gets called. Any particular best practice here?</p>\n\n<p>Edit]: It appears this may be specific to TEdit in some way. It looks like the lines initializing the state for checkboxes are not having the same issue. Could this just be a bug in Lazarus?</p>\n"},{"tags":["multithreading","delphi","synchronization","delphi-xe2","vcl"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":239,"score":2,"question_id":8804731,"title":"Prevent Delphi MDI application from creating TApplication in external DLL","body":"<p><strong>This is the question (the rest is just so you can tell me I'm doing it all wrong)</strong>. </p>\n\n<p>Is there any way I can ensure that the first binary file to be ran (i.e. my executable) is the first one to initialize vcl.controls.pas?</p>\n\n<hr>\n\n<p>I asked <a href=\"http://stackoverflow.com/questions/7742954/tthread-synchronize-causing-near-deadlock-in-delphi-2009-worked-in-delphi-7\">this question a few months ago</a> and I figured out how to fix it there and synchronize was working again just swell for Delphi 2009.  </p>\n\n<p>Now we've got Delphi XE2 and the same symptom is happening.  TThread.Synchronize locks up until the system idles or you move the mouse over the active form causing the program to go super slow.  I could recreate the problem in Delphi 2009 because I got lucky and found the source to be an non-circuitously linked DLL, but I don't believe this to be the case with XE2.  I don't know why XE2 decides to initialize code differently than Delphi 7 or 2009, but according to my answer on the other question, nothing really changed with TThread, so it must be somewhere else.</p>\n\n<p>Well, I've been stepping through the initializations of my main MDI app and it appears to call TApplication.Create (which happens in the initialization of VCL.Controls.pas) inside a linked DLL.  I can't say that I understand why this is a problem since I build everything with the same runtime packages (VCL, RTL, etc...).</p>\n"},{"tags":["c#","delphi","winapi","messagebox"],"answer_count":1,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":239,"score":6,"question_id":12570167,"title":"Getting the text from a dialog box that does not use a label control?","body":"<p>This is a continuation of my previous question <a href=\"http://stackoverflow.com/questions/12532812/how-to-supress-a-dialog-box-an-inproc-com-server-displays\">How to supress a dialog box an Inproc COM Server displays</a>.</p>\n\n<hr>\n\n<h2>Background:</h2>\n\n<p>A recap of my situation: I have a Inproc COM Server written in Delphi from a 3rd party. One of the functions I call will display a error message dialog box if it traps a specific type of error. The issue is I am trying to process data in bulk, and the data source I am using is causing that error dialog to pop up a lot (thanks to the answer of my previous question it now auto closes and I was able to run it to completion, it would have shown the dialog box and required someone to press OK 9923 times). The process blocks till the message box is closed.</p>\n\n<hr>\n\n<h2>Question:</h2>\n\n<p>I would like to have better logging of what the error dialog said. However any attempt to get get the body text of the dialog box has failed.</p>\n\n<p><img src=\"http://i.stack.imgur.com/01WJr.png\" alt=\"Image of Dialog Box\"></p>\n\n<pre><code>//Snip\n\nprivate void StartWindowListener()\n{\n    //Queue the watcher on the message pump if we are not watching.\n    if (_watcherRunning == false)\n    {\n        _watcherRunning = true;\n        _dummyForm.BeginInvoke(new Action(() =&gt;\n        {\n            _watcherRunning = false;\n\n            //If we are not inside the com object don't enumerate.\n            if (_insideCom == false) return;\n\n            // Enumerate windows to find dialogs\n            EnumThreadWndProc callback = new EnumThreadWndProc(CheckWindow);\n            EnumThreadWindows(GetCurrentThreadId(), callback, IntPtr.Zero);\n            GC.KeepAlive(callback);\n        }));\n    }\n}\n\nprivate bool CheckWindow(IntPtr hWnd, IntPtr lp)\n{\n    // Checks if hWnd is the expected dialog\n    StringBuilder sb = new StringBuilder(260);\n    GetClassName(hWnd, sb, sb.Capacity);\n    if (sb.ToString() == \"TMessageForm\")\n    {\n        //This returns the dialog box's title\n        GetWindowText(hWnd, sb, sb.Capacity);\n\n        //This returns IntPtr.Zero\n        var hDialogText = GetDlgItem(hWnd, 0xFFFF);\n        if (hDialogText != IntPtr.Zero)\n            GetWindowText(hDialogText, sb, sb.Capacity);\n\n        //This returns a empty string\n        GetDlgItemText(hWnd, 0xFFFF, sb, sb.Capacity);\n\n\n        //Only sees the OK button.\n        IntPtr hCtl = IntPtr.Zero;\n        HashSet&lt;IntPtr&gt; seen = new HashSet&lt;IntPtr&gt;();\n        while ((hCtl = GetNextDlgGroupItem(hWnd, hCtl, false)) != IntPtr.Zero)\n        {\n            //When we see the same control twice, break out of the loop.\n            if (seen.Add(hCtl) == false)\n                break;\n\n            GetClassName(hCtl, sb, sb.Capacity);\n            SendMessage(hCtl, WM_GETTEXT, sb.Capacity, sb)\n\n            //Close the dialog by sending WM_CLOSE to the window\n            SendMessage(hWnd, WM_CLOSE, IntPtr.Zero, IntPtr.Zero);\n        }\n\n         //Snip...\n    }\n    return true;\n}\n\n//Snip...\n\n// P/Invoke declarations\nconst int WM_CLOSE = 0x0010;\nprivate delegate bool EnumThreadWndProc(IntPtr hWnd, IntPtr lp);\n[DllImport(\"user32.dll\")]\nprivate static extern bool EnumThreadWindows(int tid, EnumThreadWndProc callback, IntPtr lp);\n[DllImport(\"user32.dll\")]\nprivate static extern int GetClassName(IntPtr hWnd, StringBuilder buffer, int buflen);\n[DllImport(\"user32.dll\")]\nprivate static extern IntPtr SendMessage(IntPtr hWnd, int msg, IntPtr wp, IntPtr lp);\n[DllImport(\"kernel32.dll\")]\nprivate static extern int GetCurrentThreadId();\n</code></pre>\n\n<p>I thought I may have been interrupting the dialog before it gets to add the text to it (it is not fully painted yet when I break in the above code). However putting a <code>Application.DoEvents</code> inside StartWindowListener before it starts the enumeration allows the dialog box to fully paint but I still get the same results as I posted with the above code.</p>\n\n<p>Doing a Ctrl-C works correctly on the dialog box so I could use that in a pinch, but being that I have to repeat this 9923 times I would like to avoid using that programmatically.</p>\n\n<p>Is there any other methods I can try to get the text from the Message box?</p>\n"},{"tags":["performance","delphi","text-rendering"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":159,"score":1,"question_id":12607720,"title":"How do I render text quickly when each character needs separate placement and formatting?","body":"<p>I try to display formatted text on the screen. At first the very simple HTML text is parsed (there are tags like b,u,i) and then each character is rendered using <code>Canvas.TextOut</code> function in appropriate position and font.</p>\n\n<p>The first thing I noticed is, that rendering of every separate character on the canvas is rather slow. The rendering of whole sentence is much faster. It is obvious, when the canvas is forced to repaint, when form is moved around the screen.</p>\n\n<p>One solution would be to cluster the characters with even fonts and render them at once. But it won't help too much, when the formatting is rich. In addition I need the characters to be the discrete entities, which could be rendered in any way. For example, there is no WinAPI to support text alignment taJustify or in block writing...</p>\n\n<p>Another approach is to render on bitmap, or to use wisely <code>ClipRect</code> property of TCanvas (I haven't tried yet). </p>\n\n<p>Anyway, when the same formatted text is displayed in TRichEdit, there is no time penalty by repaint operation. Another quick example are all major browsers, which has no problem to display tons of formated text... do they render each character like I do, but they do it more efficiently ??? I do not know. </p>\n\n<p>So do you know some recipe to speeding up the application (formatted text rendering?).</p>\n\n<p>Thanx for your ideas...</p>\n\n<p>Sample code: (make TForm as big as possible, grab it with mouse and drag it down under screen. When you move it up, you will see \"jumpy\" movement)</p>\n\n<pre><code>procedure TForm1.FormPaint(Sender: TObject);\nvar i, w, h, j:integer;\n    s:string;\n    switch:Boolean;\nbegin\n   w:=0;\n   h:=0;\n   s:='';\n   for j:=0 to 5 do\n       for i:=65 to 90 do s:=s + Char(i);\n\n   switch:=False; // set true to see the difference\n\n   if switch then\n     begin\n     for j:=0 to 70 do begin\n         for i := 1 to Length(s) do\n         begin\n         Form1.Canvas.TextOut(50+ w,h +70 , s[i]);\n         w:=w +  Form1.Canvas.TextWidth(s[i]);\n         end;\n         w:=0;\n         h:=h+15;\n         end;\n     end\n    else\n      begin\n      for j:=0 to 70 do begin\n       Form1.Canvas.TextOut(50+ w,h +70 , s);\n       w:=w +  Form1.Canvas.TextWidth(s);  // not optimalized just for comparison\n       w:=0;                               // not optimalized just for comparison\n       h:=h+15;\n       end;\n      end;\nend;\n</code></pre>\n"},{"tags":["delphi","indy10","anydac"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12601365,"title":"Are Indy 10 TCP command handlers asynchronous?","body":"<p>I have been having exceptions crop in my application, either <code>stack overflow</code> or <code>our of memory</code>. They show up in different places, depending on when the system has had enough. To put it another way, running the app twice won’t lead to the same exception in the same place.</p>\n\n<p>I have some timers which cause database access. The AnyDac d/b component guys tell me that I can't reuse a global <code>TADConnection</code> but have to allocate it dynamically in each timer handler, which I have done.</p>\n\n<p>I just thought that I had had a d'oh! moment when I looked at the latest stack trace.</p>\n\n<pre><code>fMainForm.TMainForm.GetToolNumberFromContext($31846FB4)\nfMainForm.TMainForm.Received_HEART_BEAT($249AEFD0)\nIdCommandHandlers.TIdCommand.DoCommand\nIdCommandHandlers.TIdCommandHandler.DoCommand(???,$31846FB4,'')\nIdCommandHandlers.TIdCommandHandler.Check('HEART_BEAT',$31846FB4)\nIdCommandHandlers.TIdCommandHandlers.HandleCommand($31846FB4,'HEART_BEAT') &lt;===\nuADDatSManager.TADDatSRow.SetBlobLength($7DA10FDC,0,$C18DDDC,10,0,1,False)\nuADDatSManager.TADDatSRow.SetBlobData($7DA10FDC,0,$C18DDDC,10,False)\nuADDatSManager.TADDatSRow.SetData(0,$C18DDDC,10)\nuADPhysMySQL.TADPhysMySQLCommand.FetchRow($7D2F4F90,nil)\nuADPhysMySQL.TADPhysMySQLCommand.InternalFetchRowSet($7D2F4F90,nil,50)\nuADPhysManager.DoFetch(0,50,50,False)\nuADPhysManager.TADPhysCommand.FetchBase($7D2F4F90,False)\nuADPhysManager.TADPhysCommandAsyncFetch.Execute\nuADStanAsync.TADStanAsyncExecutor.ExecuteOperation(False)\nuADStanAsync.TADStanAsyncExecutor.Run\nuADPhysManager.TADPhysCommand.ExecuteTask(TADPhysCommandAsyncFetch($7DA24FEC) as IADStanAsyncOperation,TADPhysCommandAsyncFetch($7DA24FF8) as IADStanAsyncHandler,True)\nuADPhysManager.TADPhysCommand.Fetch($7D2F4F90,False,True)\nuADCompClient.TADCustomCommand.Fetch($7D2F4F90,False,True)\nuADCompClient.TADCustomTableAdapter.Fetch(False)\nuADCompClient.TADAdaptedDataSet.DoFetch($7D2F4F90,False,fdDown)\nuADCompDataSet.TADDataSet.InternalFetchRows(False,True,fdDown)\nuADCompDataSet.TADDataSet.GetRecord($7DA1AFF4,gmNext,True)\nData.DB.TDataSet.GetNextRecord\nData.DB.TDataSet.GetNextRecords\nData.DB.TDataSet.SetBufferCount(???)\nData.DB.TDataSet.UpdateBufferCount\nData.DB.TDataSet.DoInternalOpen\nData.DB.TDataSet.OpenCursor(???)\nuADCompDataSet.TADDataSet.OpenCursor(False)\nuADCompClient.TADRdbmsDataSet.OpenCursor(False)\nData.DB.TDataSet.SetActive(???)\nuADCompDataSet.TADDataSet.SetActive(True)\nData.DB.TDataSet.Open\nuADCompClient.TADRdbmsDataSet.Open('SELECT * FROM tagged_chemicals',(...),(...))\nuADCompClient.TADRdbmsDataSet.Open('SELECT * FROM tagged_chemicals')\nfMainForm.TMainForm.CheckEndOfScheduleTimerTimer($B116FAC)\nVcl.ExtCtrls.TTimer.Timer\nVcl.ExtCtrls.TTimer.WndProc(???)\nSystem.Classes.StdWndProc(133584,275,1,0)\n:768a62fa ; C:\\Windows\\syswow64\\USER32.dll\n:768a6d3a USER32.GetThreadDesktop + 0xd7\n:768a77c4 ; C:\\Windows\\syswow64\\USER32.dll\n:768a788a USER32.DispatchMessageW + 0xf\nVcl.Forms.TApplication.ProcessMessage(???)\n</code></pre>\n\n<p>I don't understand that marked line, the sudden switch from AnyDac to Indy code  </p>\n\n<pre><code>IdCommandHandlers.TIdCommandHandlers.HandleCommand($31846FB4,'HEART_BEAT') &lt;===\nuADDatSManager.TADDatSRow.SetBlobLength($7DA10FDC,0,$C18DDDC,10,0,1,False)\n</code></pre>\n\n<p>Can someone please explain it?  Thanks</p>\n\n<p>My first thought was that Indy was interrupting AnyDac, perhaps because it called Applciation.ProcessMessages or similar, but I don't see that on the stack ... </p>\n\n<p>But if it can do that, then can it interrupt \"normal\" non-timer handler code?</p>\n\n<p>I was sure that I had it cracked and that the problem was that my TCP command handlers were reusing an AnyDac component used by something else ... then I looked at my code and saw that there is no database access in the command handlers or in anything that they call.</p>\n\n<p>I am stumped. Does what I wrote even make sense? Can anyone offer any advice?</p>\n\n<p>Thanks a 1,000,000 in advance for any help.</p>\n"},{"tags":["delphi","openssl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12602337,"title":"AES library compatible with openssl","body":"<p>I have a linux c++ server application witch sends AES128 encrypted strings. The library that the application is using is open SSL.</p>\n\n<p>Is there any delphi library I can use to encrypt data witch needs to be sent to the server . I have found an unit but the data isn't decripted ok between the server and client.</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":131,"score":3,"question_id":12582787,"title":"How can I track down an Out of Memory exception?","body":"<p>The stack looks like this  </p>\n\n<pre><code>:7576b9bc KERNELBASE.RaiseException + 0x58\n:671c57ad ; F:\\invariant data - not DropBox\\3rd_party_vcl\\MAD collection\\madExcept\\Dlls\\madExcept32.dll\n:671c953f ; F:\\invariant data - not DropBox\\3rd_party_vcl\\MAD collection\\madExcept\\Dlls\\madExcept32.dll\n:71a80013 \nSystem._ReallocMem(???,???)\n:0040497d @ReallocMem + $45\nSystem._DynArraySetLength\nIdIOHandler.TIdIOHandler.ReadFromSource(True,-2,True)\nIdIOHandler.TIdIOHandler.ReadLn(#$A,-1,16384,$D3B6FF0)\nIdIOHandler.TIdIOHandler.ReadLn(nil)\nIdCmdTCPServer.TIdCmdTCPServer.ReadCommandLine($7CC1AFB4)\nIdCmdTCPServer.TIdCmdTCPServer.DoExecute($7CC1AFB4)\nIdContext.TIdContext.Run\nIdTask.TIdTask.DoRun\nIdThread.TIdThreadWithTask.Run\nIdThread.TIdThread.Execute\n:004ccf91 HookedTThreadExecute + $2D\nSystem.Classes.ThreadProc($7A486F84)\nSystem.ThreadWrapper($7BFBEFF8)\n:004cce73 CallThreadProcSafe + $F\n:004ccee0 ThreadExceptFrame + $3C\n:7559339a kernel32.BaseThreadInitThunk + 0x12\n:76f39ef2 ntdll.RtlInitializeExceptionChain + 0x63\n:76f39ec5 ntdll.RtlInitializeExceptionChain + 0x36\n</code></pre>\n\n<p>none of which is my code. It loks like INDY code, but I realize that if my code is buggy then the exception can still be thrown somewhere elase as a result of me taking all the memory.</p>\n\n<p>I am running MAD Except with leak detection on.  If I run for w hile and close the program, it reports no leak. If I leave the program running for a few hours I get the out of memory exception.</p>\n\n<p>I only have two calls to Create(), both are in timer handlers and I have set the timer duration to one second in order to stres stest. The handlers are pretty simple and always Free() the created object.</p>\n\n<p>Is there anything else I can look at, apart from the code of the timer handlers?</p>\n\n<p>Here's the code if anyone really needs to see it ... these are the only two palces where I <code>Create()</code> an object ...</p>\n\n<pre><code>procedure TMainForm.ServerAliveTimerTimer(Sender: TObject);\n\n   var timestamp : LongInt;\n       ADConnection: TADConnection;\n       theDialogForm : TDialogFormForm;\nbegin\n   ServerAliveTimer.Enabled := False;\n   TraceInfo('ServerAliveTimer expired after ' + IntToStr(ServerAliveTimer.Interval div 1000) + ' seconds');\n\n   try\n      ADConnection := TADConnection.Create(Self);\n      ADConnection.DriverName := 'mysql';\n      ADConnection.Params.Add('Server=' + MAIN_STOREROOM_IP_ADDRESS);\n      ADConnection.Params.Add('Database=XXX');\n      ADConnection.Params.Add('User_Name=XXX');\n      ADConnection.Params.Add('Password=XXX');\n      ADConnection.Params.Add('Port=3306');\n      ADConnection.Connected := True;\n\n   except\n      on E : Exception do\n      begin\n         StopAllTimers();\n\n         TraceError('Database error. Failed to create ADO connection');\n\n         ADConnection.Free();\n\n         theDialogForm := TDialogFormForm.Create(Nil);\n         theDialogForm.ShowTheForm('Database problem'+#13+#10+''+#13+#10+\n                                   E.ClassName+#13+#10+\n                                   E.Message);\n\n         StopTheApplication();\n         Exit;\n      end;\n   end;\n\n   if isMainStoreRoom then\n   begin\n      CheckIfStoreRoomIsAlive(SECONDARY_STOREROOM_IP_ADDRESS);\n   end\n   else\n   begin\n      CheckIfStoreRoomIsAlive(MAIN_STOREROOM_IP_ADDRESS);\n   end;\n\n   // Now, update our own timestamp\n   try\n      timestamp  := GetCurrentUnixTimeStamp();\n      ADConnection.ExecSQL('UPDATE server_status SET alive_timestamp=\"' + IntToStr(timestamp) + '\" WHERE ip_address=\"' + ipAddress + '\"');\n\n   except\n      on E : Exception do\n      begin\n         TraceError('Database error. Failed to upate timestamp for ip_address = \"' +\n                        ipAddress + ' in table \"server_status\"' + #13#10#13#10 +\n                        E.ClassName+#13+#10+\n                        E.Message);\n         ADConnection.Free();\n         Exit;\n      end;\n   end;\n\n   ADConnection.Free();\n   ServerAliveTimer.Enabled := True;\nend;     // ServerAliveTimerTimer()\n</code></pre>\n\n<p>and  </p>\n\n<pre><code>procedure TMainForm.CheckEndOfScheduleTimerTimer(Sender: TObject);\n   var ADConnection : TADConnection;\n       ADQuery : TADQuery;\n       secondsSinceMidnight : LongInt;\n       timeNow : LongInt;\n       today : LongInt;\n       checkoutDay : LongInt;\n       checkoutExpireTime : LongInt;\n       theDialogForm : TDialogFormForm;\n       rfidTag : String;\n       i : integer;\nbegin\n   CheckEndOfScheduleTimer.Enabled := False;\n\n   ADConnection := Nil;\n   ADQuery := Nil;\n\n   try\n      TraceInfo('CheckEndOfScheduleTimer expired after ' + IntToStr(CheckEndOfScheduleTimer.Interval div 1000) + ' seconds');\n\n      secondsSinceMidnight := GetSecondsSinceMidnight();\n      timeNow := GetCurrentUnixTimeStamp();\n      today := timeNow - secondsSinceMidnight;\n\n      ADConnection := TADConnection.Create(nil);\n      ADConnection.DriverName := 'mysql';\n      ADConnection.Params.Add('Server=' + MAIN_STOREROOM_IP_ADDRESS);\n      ADConnection.Params.Add('Database=XXX');\n      ADConnection.Params.Add('User_Name=XXX');\n      ADConnection.Params.Add('Password=XXX');\n      ADConnection.Params.Add('Port=3306');\n      ADConnection.Connected := True;\n\n      ADQuery := TADQuery.Create(ADConnection);\n      ADQuery.Connection := ADConnection;\n      ADQuery.Open('SELECT * FROM tagged_chemicals');\n      ADQuery.FetchAll();\n\n      for i := 0 to Pred(ADQuery.Table.Rows.Count) do\n      begin\n         if ADQuery.Table.Rows[i].GetData('checked_out') = 'N' then\n            Continue;\n\n         checkoutDay        := ADQuery.Table.Rows[i].GetData('checkout_day');\n         checkoutExpireTime := ADQuery.Table.Rows[i].GetData('checkout_expire_time');\n\n         if (today + secondsSinceMidnight) &gt; (checkoutDay + checkoutExpireTime) then\n         begin\n            rfidTag := ADQuery.Table.Rows[i].GetData('rfid_tag');\n\n            TraceInfo('End of pouring time for RFID tag (' + IntToStr(secondsSinceMidnight) + ' seconds after midnight');\n\n            ADConnection.ExecSQL('UPDATE tagged_chemicals ' +\n                                    'SET checked_out=\"N\", ' +\n                                        'checkout_day=\"0\", ' +\n                                        'checkout_expire_time=\"0\" ' +\n                                 ' WHERE  rfid_tag=\"' + rfidTag + '\"');\n         end;\n      end;\n\n      ADQuery.Free();\n      ADConnection.Free();\n\n   except\n      On E: Exception do\n      begin\n         ADQuery.Free();\n         ADConnection.Free();\n         TraceError('Databse exception (' + E.ClassName + ') : \"' + E.Message + '\"');\n\n         theDialogForm := TDialogFormForm.Create(Nil);\n         theDialogForm.ShowTheForm('Database error when checking end of pouring time'+#13+#10+''+#13+#10+\n                    E.ClassName+#13+#10+\n                    E.Message);\n      end;\n   end;\n\n   CheckEndOfScheduleTimer.Enabled := True;\nend;     // CheckEndOfScheduleTimerTimer()\n</code></pre>\n"},{"tags":["delphi","delphi-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":109,"score":2,"question_id":12605323,"title":"GlobalAlloc causes my Delphi app hang?","body":"<p>I'm want to convert a string value to a global memory handle and vice versa, using the following functions I've just written.</p>\n\n<p>But <code>StrToGlobalHandle()</code> causes my testing program hangs. So <code>GlobalHandleToStr()</code> is untest-able yet and I'm also wondering if my code is logical or not.</p>\n\n<pre><code>function StrToGlobalHandle(const aText: string): HGLOBAL;\nvar\n  ptr: PChar;\nbegin\n  Result := 0;\n  if aText &lt;&gt; '' then\n  begin\n    Result := GlobalAlloc(GMEM_MOVEABLE or GMEM_ZEROINIT, length(aText) + 1);\n    if Result &lt;&gt; 0 then\n    begin\n      ptr := GlobalLock(Result);\n      if Assigned(ptr) then\n      begin\n        StrCopy(ptr, PChar(aText));\n        GlobalUnlock(Result);\n      end\n    end;\n  end;\nend;\n\nfunction GlobalHandleToStr(const aHandle: HGLOBAL): string;\nvar\n  ptrSrc: PChar;\nbegin\n  ptrSrc := GlobalLock(aHandle);\n  if Assigned(ptrSrc) then\n  begin\n    SetLength(Result, Length(ptrSrc));\n    StrCopy(PChar(Result), ptrSrc);\n    GlobalUnlock(aHandle);\n  end\nend;\n</code></pre>\n\n<p>Testing code:</p>\n\n<pre><code>procedure TForm3.Button1Click(Sender: TObject);\nvar\n  h: HGLOBAL;\n  s: string;\n  s2: string;\nbegin\n  s := 'this is a test string';\n  h := StrToGlobalHandle(s);\n  s2 := GlobalHandleToStr(h);\n  ShowMessage(s2);\n  GlobalFree(h);\nend;\n</code></pre>\n\n<p>BTW, I want to use these two functions as helpers to send string values between programs - send a global handle from process A to process B, and process B get the string using <code>GlobalHandleToStr()</code>. \nBTW 2, I know WM_COPY and other IPC methods, those are not suitable in my case.</p>\n"},{"tags":["delphi","winapi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":12604263,"title":"CreateProcessAsUser How to add privileges?","body":"<p>I'm trying to call execute an application from another windows application under another users account using this code:</p>\n\n<pre><code>procedure TForm1.Button3Click(Sender: TObject);\nvar\n  userName: string;\n  password: string;\n  domain: string;\n  path: string;\n  logonok: boolean;\n  impok: boolean;\n  hUserToken: THandle;\n  ProcessCreatedOK: Boolean;\n  startupInfo: TStartupInfo;\n  processInfo: TProcessInformation;\n  err: DWORD;\nbegin\n    username := 'theusername';\n    password := 'thepassword';\n    domain := '';\n    Path := 'myapp.exe';\n\n    LogonOK := LogonUser(PWideChar(username), PWideChar(domain), PWideChar(password),\n      LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT, hUserToken);\n\n    if LogonOK then\n    begin\n      impOK := ImpersonateLoggedOnUser(hUserToken);\n\n      if impok then\n      begin\n        FillChar(startupInfo, SizeOf(startupInfo), 0);\n        startupInfo.CB := SizeOf(startupinfo);\n        startupInfo.dwFlags := STARTF_USESHOWWINDOW;\n        startupinfo.wShowWindow := SW_SHOWNORMAL;\n\n        NewState.PrivilegeCount := 1;\n        res := LookupPrivilegeValue(\n          nil,\n          SE_ASSIGNPRIMARYTOKEN_NAME,\n          NewState.Privileges[0].Luid);\n          Win32Check(res);\n\n        NewState.Privileges[0].Attributes := SE_PRIVILEGE_ENABLED;\n        res := AdjustTokenPrivileges(\n          hUserToken,\n          False,\n          NewState,\n          SizeOf(NewState),\n          nil,\n          returnLength);\n        Win32Check(res);\n\n        NewState.PrivilegeCount := 1;\n        res := LookupPrivilegeValue(\n          nil,\n          SE_INCREASE_QUOTA_NAME,\n          NewState.Privileges[0].Luid);\n          Win32Check(res);\n\n        NewState.Privileges[0].Attributes := SE_PRIVILEGE_ENABLED;\n        res := AdjustTokenPrivileges(\n          hUserToken,\n          False,\n          NewState,\n          SizeOf(NewState),\n          nil,\n          returnLength);\n        Win32Check(res);\n\n        ProcessCreatedOK := CreateProcessAsUser(\n           hUserToken,\n           nil,\n           PChar(path),\n           nil, nil,\n           false,\n           CREATE_NEW_CONSOLE or NORMAL_PRIORITY_CLASS, nil, nil,\n           startupInfo, processInfo);\n\n        if GetLastError &lt;&gt; 0 then\n        begin\n          err := GetlastError;\n          ShowMessage(inttostr(err) + ' ' +  SysErrorMessage(err));\n        end;\n      end;\n    end;\n</code></pre>\n\n<p>I'm getting a 1314 \"A required privilege is not held by the client\" error.</p>\n\n<p>Now from some digging around I can see that I need to apply some privileges to the impersonated account: SE_ASSIGNPRIMARYTOKEN_NAME and SE_INCREASE_QUOTA_NAME?</p>\n\n<p>Does anyone have some suggestions on how to do this?</p>\n\n<p>I've seen the JCL example given in this Stackoverflow <a href=\"http://stackoverflow.com/questions/2746053/delphi-and-createprocessasuser-example\">answer</a> but I get similar issues with regards to account privileges.</p>\n\n<p>I'd prefer not to use CreateProcessWithLogonW - I can explain why on request.</p>\n"},{"tags":["delphi","audio"],"answer_count":4,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":11450,"score":12,"question_id":246723,"title":"How to play a wav-File in Delphi?","body":"<p>Which functions are available within Delphi to play a sound-file?</p>\n"},{"tags":["delphi","delphi-2009"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":157,"score":3,"question_id":12600197,"title":"String comparison in Delphi","body":"<p>I have two strings, which I need to compare for equality.</p>\n\n<p>String 1 is created in this way:</p>\n\n<pre><code>var\n    inBuf: array[0..IN_BUF_SIZE] of WideChar;\n    stringBuilder : TStringBuilder;\n    mystring1:string;\n    ...\nbegin\n\nstringBuilder := TStringBuilder.Create;\n\nfor i := startOfInterestingPart to endOfInterestingPart do\nbegin\n  stringBuilder.Append(inBuf[i]);\nend;\n\nmystring1 := stringBuilder.ToString();\nstringBuilder.Free;\n</code></pre>\n\n<p>String 2 is a constant string <code>'ABC'</code>.</p>\n\n<p>When string 1 is displayed in a debug console, it is equal to 'ABC'. But the comparisons</p>\n\n<ol>\n<li><code>AnsiCompareText(mystring1, 'ABC')</code></li>\n<li><code>mystring1 = 'ABC'</code></li>\n<li><code>CompareStr(mystring1, 'ABC')</code></li>\n</ol>\n\n<p>all report inequality.</p>\n\n<p>I suppose that I need to convert string 2 (<code>'ABC'</code>) to the same type as the string 1.</p>\n\n<p>How can I do that?</p>\n\n<p><strong>Update 26.09.2012:</strong></p>\n\n<p><code>aMessage</code> is displayed in the log output as {FDI-MSG-START-Init-FDI-MSG-END}</p>\n\n<p>Here's the code for printing the length of strings:</p>\n\n<pre><code>StringToWideChar('{FDI-MSG-START-Init-FDI-MSG-END}', convString, iNewSize);\n\n...\n\nOutputDebugString(PChar('Len (aMessage): ' + IntToStr(Length(aMessage))));\nOutputDebugString(PChar('Len (original constant): ' + IntToStr(Length('{FDI-MSG-START-Init-FDI-MSG-END}'))));\nOutputDebugString(PChar('Len (convString): ' + IntToStr(Length(convString))));\n</code></pre>\n\n<p>And here's the log output:</p>\n\n<pre><code>[3580] Len (aMessage): 40\n[3580] Len (original constant): 32\n[3580] Len (convString): 0\n</code></pre>\n"},{"tags":["delphi","regional","strtofloat"],"answer_count":6,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":6833,"score":3,"question_id":788098,"title":"Convert string with commas to float","body":"<p>Is there a built-in Delphi function which would convert a string such as '3,232.00' to float?  StrToFloat raises an exception because of the comma.  Or is the only way to strip out the comma first and then do StrToFloat?</p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","dde","message-passing"],"answer_count":6,"favorite_count":13,"up_vote_count":8,"down_vote_count":0,"view_count":9266,"score":8,"question_id":512366,"title":"How do I send a string from one instance of my Delphi program to another?","body":"<p>What is the best and easiest way to send a string from one instance of my program to another instance of my program? The receiving program has to execute a procedure, using the received string as a parameter.</p>\n\n<p>I started reading about DDE but I got confused. What other options do I have, and what is the easiest way to implement this?</p>\n"},{"tags":["delphi","background-color","tstringgrid"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":3106,"score":3,"question_id":6701462,"title":"delphi : how can I change color of a cell in string grid","body":"<p>I want to change background color ( not font ) of a cell in string grid in delphi .</p>\n\n<p>Just one cell not a row or a column.</p>\n\n<p>Can I?</p>\n\n<hr>\n\n<p>RRUZ : your procedure is correct and works but in my procedure doesn't work. </p>\n\n<p>My procedure:</p>\n\n<p>x is a global array of integer</p>\n\n<pre><code>procedure TF_avalie_salon.StringGrid1DrawCell(Sender: TObject; ACol,\n    ARow: Integer; Rect: TRect; State: TGridDrawState);\n    var   S: string;\nbegin\n    S := StringGrid1.Cells[ACol, ARow];\n    StringGrid1.Canvas.FillRect(Rect);\n    SetTextAlign(StringGrid1.Canvas.Handle, TA_CENTER);\n    StringGrid1.Canvas.TextRect(Rect,Rect.Left + (Rect.Right - Rect.Left) div 2, Rect.Top + 2, S);\n    if (ARow&lt;&gt;0 )AND(acol&lt;&gt;0)AND(gridclick=true) then\n    begin\n        try\n          gridclick:=false;\n          x[acol+((strtoint(Edit_hafte.Text)-1)*7),arow]:=strtoint(StringGrid1.Cells[ACol, ARow]);\n        except\n          x[acol+((strtoint(Edit_hafte.Text)-1)*7),arow]:=0;\n          StringGrid1.Cells[acol,arow]:='0';\n          with TStringGrid(Sender) do\n          begin\n            Canvas.Brush.Color := clGreen;\n            Canvas.FillRect(Rect);\n            Canvas.TextOut(Rect.Left+2,Rect.Top+2,Cells[ACol, ARow]);\n          end;\n        end;\n    end;\nend;\n</code></pre>\n\n<hr>\n\n<p>When I use Canvas.Brush.Color with below code , Canvas.Brush.Color doesn't work. If I inactive below code I can change the cells color. But I need both.</p>\n\n<pre><code>    S := StringGrid1.Cells[ACol, ARow];\n    StringGrid1.Canvas.FillRect(Rect);\n    SetTextAlign(StringGrid1.Canvas.Handle, TA_CENTER);\n    StringGrid1.Canvas.TextRect(Rect,Rect.Left + (Rect.Right - Rect.Left) div 2, Rect.Top + 2, S);\n</code></pre>\n"},{"tags":["delphi","ieee-754"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":117,"score":-1,"question_id":8404434,"title":"delphi convert microsoft binary to ieee (8bits)","body":"<p>Somebody has the code to convert from old MSB to ieee (delphi real)?</p>\n\n<p>In google I've only founded the 4bit conversion, but not for 8bits:</p>\n\n<pre><code>function MBF2IEEE(MBFVal: Single): Single;\nvar\n   Output: array[1..4] of byte;\n   Value: Single absolute Output;\n//   Sign: byte;\n   LSB: Byte;\nbegin\n   try\n      Output[4] := TInput(MBFVal)[4];\n      { if value is non-zero, do some bit shuffling }\n      if Output[4] &gt; 2 then begin\n         Output[3] := TInput(MBFVal)[3];\n         Output[2] := TInput(MBFVal)[2];\n         Output[1] := TInput(MBFVal)[1];\n         Output[4] := Output[4] - $02;\n         LSB := Output[4] and $01;\n         Output[4] := (Output[4] shr 1) or (Output[3] and $80);\n         if LSB = 0 then\n            Output[3] := Output[3] and $7f\n         else\n            Output[3] := Output[3] or $80;\n      { else return 0 }\n      end else begin\n         Output[1] := 0;\n         Output[2] := 0;\n         Output[3] := 0;\n         Output[4] := 0;\n      end;\n      Result := Value;\n   except\n      Output[1] := 0;\n      Output[2] := 0;\n      Output[3] := 0;\n      Output[4] := 0;\n   end;\nend;\n</code></pre>\n\n<p>(from this page\n<a href=\"http://www.experts-exchange.com/Programming/Languages/Pascal/Delphi/Q_20245266.html\" rel=\"nofollow\">http://www.experts-exchange.com/Programming/Languages/Pascal/Delphi/Q_20245266.html</a>)</p>\n\n<p>Thanks!</p>\n"},{"tags":["sql","sql-server","delphi","delphi-xe2","dbexpress"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":118,"score":2,"question_id":12574986,"title":"Create Trigger from Delphi Code using Native Client Driver","body":"<p>I have an insert trigger that contains dynamic sql stored as a resource for my XE2 project. It also contains placeholders for the database name and table name that are substituted when the Delph code runs to execute the SQL.</p>\n\n<p>Originally I was using the DevArt SQL Server driver against a SqlExpress database, but am now wanting to use ODBC and the SQL Native Client driver against a LocalDB database.</p>\n\n<p>What I have found is that my original create trigger scripts no longer work.</p>\n\n<p>I am using TSQLQuery.ExecSQL to execute my SQL commands.</p>\n\n<pre><code>CREATE TRIGGER [dbo].[#TableName#_INSERT_TRIGGER] ON [#DatabaseName#].[dbo].[#TableName#] FOR INSERT\n</code></pre>\n\n<p>causes a </p>\n\n<p><strong>'[Microsoft][SQL Server Native Client 11.0][SQL Server]Cannot create trigger on 'EvaluationCompany_COPYDB.dbo.COPY_PRODUCTS' as the target is not in the current database.'</strong></p>\n\n<p>The parser class I use does split SQL scripts at the GO keyword into separate statements, so I amended my create trigger script to say</p>\n\n<pre><code>USE [#DatabaseName#]\nGO\nCREATE TRIGGER [dbo].[#TableName#_INSERT_TRIGGER] ON [dbo].[#TableName#] FOR INSERT\n</code></pre>\n\n<p>which is what you would do in SSMS but that says</p>\n\n<p><strong>'[Microsoft][SQL Server Native Client 11.0][SQL Server]The object 'dbo.COPY_PRODUCTS' does not exist or is invalid for this operation.'</strong></p>\n\n<p>Probably because the \"current database\" for the CREATE is not the one set by USE, as it seems to be forgotten.</p>\n\n<p>I tried my usual way of stringing sql statements into a single execute by doing </p>\n\n<pre><code>USE [#DatabaseName#];\nCREATE TRIGGER [dbo].[#TableName#_INSERT_TRIGGER] ON [dbo].[#TableName#] FOR INSERT\n</code></pre>\n\n<p>but that throws the expected </p>\n\n<p><strong>'[Microsoft][SQL Server Native Client 11.0][SQL Server]'CREATE TRIGGER' must be the first statement in a query batch.'</strong></p>\n\n<p>So I wrapped the whole CREATE...END in a EXEC [#DatabaseName#].[sys].[sp_ExecuteSQL] N' ' and tried to execute that. If I paste the contents of the string variable into SSMS it executes fine, but when passed to the ExecSQL, it says</p>\n\n<p><strong>'[Microsoft][SQL Server Native Client 11.0][SQL Server]The request for procedure 'sp_executesql' failed because 'sp_executesql' is a procedure object.'</strong></p>\n\n<p>which is kind of nonsensical. So now I am at a loss as to how to create a trigger on a table using dbExpress and the SQL Server native client.</p>\n"},{"tags":["delphi"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":216,"score":3,"question_id":12567505,"title":"Sortable DBGrid","body":"<p>I want to implement a sortable DBgrid (that sorts its rows when clicked on column title). I managed to make it sortable in an ascending order but I can't do it in a descending order. Here are my design settings:</p>\n\n<pre><code>Query1.DatabaseName:='Test';\nDataSetProvider1.DataSet:=Query1;\nClientDataSet1.ProviderName:=DataSetProvider1;\nDataSource1.DataSet:=ClientDataSet1;\nDBGrid1.DatSource:=DataSource1;\n</code></pre>\n\n<p>And here are fragments of my code:</p>\n\n<pre><code>procedure TForm2.FormShow(Sender: TObject);\nbegin\n  Query1.Open;\n  ClientDataSet1.Data:=DataSetProvider1.Data;\n  ClientDataSet1.AddIndex('objnameDESC','objname',[ixDescending]);\n  ClientDataSet1.AddIndex('SUM(cd.worktime)DESC','SUM(cd.worktime)',[ixDescending]);\nend;\n\nprocedure TForm2.DBGrid1TitleClick(Column: TColumn);\nbegin\n  case Column.Index of\n  0: if ClientDataSet1.IndexFieldNames='objname' then\n       ClientDataSet1.IndexFieldNames:='objnameDESC'\n     else\n       ClientDataSet1.IndexFieldNames:='objname';\n  1: if ClientDataSet1.IndexFieldNames='SUM(cd.worktime)' then\n       ClientDataSet1.IndexFieldNames:='SUM(cd.worktime)DESC'\n     else\n       ClientDataSet1.IndexFieldNames:='SUM(cd.worktime)';\n  end;\nend;\n</code></pre>\n\n<p>When I click on a column title for the first time, sorting is done in an ascending order - so up to here everything is OK. When I click for the second time I expect sorting in a descending order to be done but instead I get the message:</p>\n\n<pre><code>Project ... raised Exception class EDatabaseError with message\n'ClientDataSet1: Field 'objnameDESC' not found'.\n</code></pre>\n\n<p>Any ideas about what I am doing wrong?</p>\n"},{"tags":["c","delphi","dll","header"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":129,"score":3,"question_id":12592697,"title":"Convert C Header to delphi","body":"<pre><code>int  WINAPI  BiMICRSetReadBackFunction(\n    int  nHandle,\n    int  (CALLBACK  *pMicrCB)(void),\n    LPBYTE  pReadBuffSize,\n    LPBYTE  readCharBuff,\n    LPBYTE  pStatus,\n    LPBYTE  pDetail);\n\n    typedef int (CALLBACK* MICRCallback)(void);\n    typedef int (CALLBACK* StatusCallback)(DWORD);\n\n    int WINAPI BiSetInkStatusBackFunction(int nHandle,\n        int (CALLBACK *pStatusCB)(DWORD dwStatus)\n);\n</code></pre>\n\n<p>I need to convert this function to Delphi.</p>\n\n<p>I tried to use <code>headconv4.2</code> but the resulting static unit is not completed, and errors occur when compiling.</p>\n\n<p>Thanks in advance for  your kind help :D</p>\n"},{"tags":["windows","linux","delphi","spawning"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":982,"score":4,"question_id":805045,"title":"How to spawn Linux process from Windows application?","body":"<p>My interactive 32-bit Windows app (now moving from Delphi [Ent] 2007 to 2009) uses command-line interactions to spawn child processes that do computationally-intensive tasks, which in turn write text files that the GUI parent app parses and analyzes - resulting in an interactive graphical display of the results.</p>\n\n<p>I have access to a multiprocessor (multi-user) Linux cluster (via ssh), and would like to off-load the heavy lifting to that cluster.  My question is how to spawn the processes in Linux from my Windows app.  I can envision using secure FTP to put and get files, but not sure how to spawn the child processes in Linux.</p>\n\n<p>Some leads for further reading would be fine - but code/pseudocode would be ideal.  I can imagine that this may be more about Windows-Linux interaction than Delphi.</p>\n"},{"tags":["delphi","delphi-7","object-pascal"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":106,"score":2,"question_id":12595822,"title":"Typecasting WideString breaks array of widechar","body":"<p>I use this procedure to ENUM the keys into a TNTListView (UNICODE) in Delphi 7</p>\n\n<pre><code>procedure TForm1.TntButton1Click(Sender: TObject);\nvar\n k        : HKEY;\n Buffer   : array of widechar;\n i        : Integer;\n iRes     : Integer;\n BuffSize : DWORD;\n item     : TTNTListItem;\n WS       : WideString;\nbegin\n if RegOpenKeyExW (HKEY_CURRENT_USER, 'Software', 0, KEY_READ, K) = ERROR_SUCCESS then begin\n  try\n    i := 0;\n    BuffSize := 1;\n    while true do begin\n      SetLength (Buffer, BuffSize);\n      iRes := RegEnumKeyW(k, I, @Buffer[0], BuffSize);\n      if iRes = 259 then break;\n      if iRes = 234 then begin\n        inc (BuffSize);\n        continue;\n      end;\n      messageboxw (0, @Buffer[0], '', 0);\n      item := TNTListView1.Items.Add;\n      item.Caption := WideString (Buffer); // BREAKS IT\n      { SOLUTION }\n      SetLength (WS, BuffSize - 1);\n      CopyMemory (@WS[1], @Buffer[0], (BuffSize * 2));\n      { .... }\n      inc (i);\n      BuffSize := 1;\n    end;\n  finally\n    RegCloseKey (k);\n    SetLength (Buffer, 0);\n  end;\n end;\nend;\n</code></pre>\n\n<p>I see that most of the listviewitems are trimmed! However if I show the Buffer in the messagebox it shows the complete string in the right length. Is this a Bug of the listview or am I missing something like a NULL CHAR (or even 2)? </p>\n\n<p>Thanks for help.</p>\n\n<p>EDIT: I just noticed that the Buffer get's trimmed into half when I cast it to a widestring.</p>\n\n<p>EDIT2: No bug in the listview. The WideString Cast breaks the string somehow and / or doesn't detect the NULL CHAR(s).</p>\n"},{"tags":["delphi","vst"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":897,"score":5,"question_id":671636,"title":"Has anybody out there used Delphi for programming VST's?","body":"<p>Has anybody out there used Delphi for programming a Virtual Studio Technology plugin?</p>\n"},{"tags":["delphi","audio","signal-processing","asio","vst"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":12564167,"title":"Getting full audio frequency spectrum with Tobybears VST Template?","body":"<p>I'm trying to make a simple frequency analyzer VST plugin using Tobybears VST Template for Delphi.</p>\n\n<p>The problem I'm having is that I cant seem to find any documentation or information about how to get something like an array of values that represent the different frequencies from a chunk of audio data that is recieved from the host.</p>\n\n<p>Does anybody have a clue on how to do this?</p>\n\n<p>Also, my VST host keeps crashing whenever I try to use the DelphiASIOVst library, which is another library for making custom VSTs.</p>\n\n<p>Thanks!</p>\n"},{"tags":["windows","multithreading","delphi","service","message"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":483,"score":0,"question_id":3889611,"title":"how do i send a custom message to a windows service?","body":"<p>I have implemented a windows xp service application that starts a couple of working threads.\nFrom one of the threads i need to send custom messages back to the service.\nHow do i do that?</p>\n"},{"tags":["delphi","c++builder","vcl","c++builder-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":12587984,"title":"Forms opened in DLL shows in task manager, how to hide?","body":"<p>I have a number of forms that are launched, via COM, in a XE2 DLL.  The caller is a VC 6 application.</p>\n\n<p>Every form that opens up shows up as an application in TaskManager, I don't want that, these windows are just dialog boxes, not applications.  </p>\n\n<p>Is there a setting I can use to not have these windows show?</p>\n\n<p>I am using C++ Builder XE2, but a Delphi solution would probably work for me.</p>\n"},{"tags":["c++","c","delphi","dll","header"],"answer_count":7,"favorite_count":3,"up_vote_count":8,"down_vote_count":1,"view_count":3427,"score":7,"question_id":100596,"title":"Best resources for converting C/C++ dll headers to Delphi?","body":"<p>A rather comprehensive site explaining the difficulties and solutions involved in using a dll written in c/c++ and the conversion of the .h header file to delphi/pascal was posted to a mailing list I was on recently, so I thought I'd share it, and invite others to post other useful resources for this, whether they be links, conversion tools, or book/paper titles.</p>\n\n<p>One resource per answer please, so we'll end up with the most popular/best resources bubbling to the top.</p>\n"},{"tags":["sql-server","delphi","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":113,"score":0,"question_id":12595867,"title":"Passing parameter values from Delphi to a SQL Server stored procedures by name","body":"<p>My question is same as Shaun's (<a href=\"http://stackoverflow.com/questions/7883851/passing-sql-server-stored-procedure-parameter-names-via-delphi\">link</a>)</p>\n\n<p>But, that question seem to have no answer.</p>\n\n<p>Is there tools other than <code>TADOStoredProc</code> that possible to be used to pass parameter by name?</p>\n\n<p>I know it's possible by using <code>Parameters.Refresh</code>. But I dont want to use that because it makes additional round-trip to server.</p>\n\n<p>I also have tried <a href=\"http://www.devart.com/unidac/\" rel=\"nofollow\">UniDAC</a>, but it also not possible to pass parameter by name.</p>\n"},{"tags":["arrays","delphi","pointers","function-overloading","overload-resolution"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":244,"score":4,"question_id":12578185,"title":"How does Delphi resolve overloaded functions with Pointer(typeless one) parameters?","body":"<p>Below are few overloaded functions. \nTry to guess which function of those would get called.</p>\n\n<pre><code>program Project2;\n    {$APPTYPE CONSOLE}\n\nuses\n  Types, SysUtils;\n\nprocedure Some(const Buf); overload;\n  begin\n    Writeln('const-typeless')\n  end;\n\n//procedure Some(var Buf); overload;\n//  begin\n//    Writeln('var-typeless')\n//  end;\n\n//procedure Some(Buf :TByteDynArray); overload;\n//  begin\n//    Writeln('Byte dynamic array');\n//  end;\n\nprocedure Some(Buf :array of Byte); overload;\n  begin\n    Writeln('Byte open array');\n  end;\n\nprocedure Some(Buf :TArray&lt;Byte&gt;); overload;\n  begin\n    Writeln('TBytes AKA byte generic array');\n  end;\n\n//procedure Some(Buf :TBytes); overload;\n//  begin\n//    Writeln('TBytes AKA byte generic array');\n//  end;\n\nvar p: pointer;\n\nbegin\n  try\n    { TODO -oUser -cConsole Main : Insert code here }\n    WriteLn ('Calling overloaded procedure with Pointer parameter:');\n\n    Write('  * nil: '); p := nil; Some(p);\n    Write('  * garbage: '); p := Pointer(1); Some(p);\n  except\n    on E: Exception do\n      Writeln(E.ClassName, ': ', E.Message);\n  end;\n\n  ReadLn;\nend.\n</code></pre>\n\n<p>In fact, the 1nd one is called and throws AV on 2ndcall.\nGiven old VCL pattern of using Pointer and Integer interchangeably (such as TList and TStrings.Objects and TWinControl.Tag) that may cause unexpected AVs on a rather regular code.</p>\n\n<p><em>{$T+}</em> does not change it, so it does not that Delphi thinks ^Byte is Pointer.\nHowever declaring <em>p: PInteger;</em> fixes it. Also open-array variant is not called for pointer, and is treated/name-mangled differently than generic-array variant. Dynamic array is name-mangled differently from generic array, so both can be used, yet at call site \"ambiguos overload\" error would happen. However, if to compile with generic array disabled and dinamic array uncommented - the same weird behavior happens.</p>\n\n<p>Why does the compiler resolve to dynamic/generic array when parameter is a Pointer, and resolve to constant typeless when parameter is PInteger ?</p>\n\n<ul>\n<li>Related: <a href=\"http://stackoverflow.com/questions/12526786\">How does Delphi resolve overloaded functions with integral parameters?</a></li>\n<li>Related: <a href=\"http://stackoverflow.com/questions/11029353\">why two aliases to &quot;array of string&quot; treated differently?</a></li>\n<li>Related: <a href=\"http://qc.embarcadero.com/wc/qcmain.aspx?d=108978\" rel=\"nofollow\">QC 108978</a></li>\n<li>Code from: <a href=\"http://www.sql.ru/forum/actualthread.aspx?tid=970289\" rel=\"nofollow\">http://www.sql.ru/forum/actualthread.aspx?tid=970289</a></li>\n</ul>\n\n<p>PS. Opened <a href=\"http://qc.embarcadero.com/wc/qcmain.aspx?d=109019\" rel=\"nofollow\">QC 109019</a></p>\n"},{"tags":["windows","delphi","gesture"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":12594394,"title":"XE3 Metropolis app and Pull Down/Swipe down to close?","body":"<p>Does anyone have a custom gesture for XE3 Metropolis apps to emulate the windows 8 swipe down/pull down with the mouse to close an application ?</p>\n\n<p>XE3 only has right click/swipe up with a close button.</p>\n\n<p>Thanks</p>\n"},{"tags":["delphi","exception-handling","try-finally","try-except"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":119,"score":2,"question_id":12593907,"title":"When should I use \"try\" blocks, and which kind should I use?","body":"<p>Two very basic questions about exception handling in Delphi.</p>\n\n<p>1) When to <code>Try</code>? My guess is that I don't need a <code>Try</code> clause around</p>\n\n<ul>\n<li>strightforward code such as assignments, conditionals and loops</li>\n<li>access to my VCL compnents</li>\n</ul>\n\n<p>but that I do need to <code>Try</code></p>\n\n<ul>\n<li>database access</li>\n<li>any thrid party components, as I don't know if they might raise an exception or not</li>\n<li>anything which the help system shows can raise an exception</li>\n</ul>\n\n<p>Did I miss anything?</p>\n\n<p>2) Try ... Finally or Try ... Except ... or both?\nFor years I have thought this to be an either / or choice, until @RRUZ answered <a href=\"http://stackoverflow.com/questions/12574843/how-to-set-my-ip-address-programmatically/12575095#12575095\">one of my questions</a> with some code which went  </p>\n\n<pre><code> try\n    CoInitialize(nil);\n    try\n      SetStaticIpAddress('Network card name','192.168.1.1','255.255.255.0');\n    finally\n      CoUninitialize;\n    end;\n except\n    on E:EOleException do\n        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));\n    on E:Exception do\n        Writeln(E.Classname, ':', E.Message);\n end;\n</code></pre>\n\n<p>Question: is that except only going to catch exceptions from <code>CoInitialize(nil);</code> or also from <code>SetStaticIpAddress('Network card name','192.168.1.1','255.255.255.0');</code>?</p>\n\n<p>To put it another way, is it possible to have my cake and eat it by having a bested try finally within a try except?</p>\n\n<hr>\n\n<p>[update] the answer to #2 seems to be yes. This code shows both dialog boxes ...  </p>\n\n<pre><code>procedure TForm3.FormCreate(Sender: TObject);\n  var x, zero : Integer;\nbegin\n   zero := 0;\n   try\n      try\n        x := 42 div zero;\n      finally\n         MessageDlg('Divide by zero finally', mtInformation, [mbOK], 0);\n      end;\n\n   Except\n     on E: Exception do\n     MessageDlg('Divide by zero exception handled', mtInformation, [mbOK], 0);\n   end;\nend;\n</code></pre>\n"},{"tags":["delphi","vb6","delphi-7","sendmessage","wm-copydata"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":209,"score":1,"question_id":12577701,"title":"Sendmessage with WM_COPYDATA from vb6 to delphi is garbled","body":"<p>i am sending data to a delphi app using WM_COPYDATA from vb6 app. in my system which local is english, i receive the data correctly, but on another system with dutch local, the receive text is garbled.</p>\n\n<p>the receiving app is the delphi, the code is</p>\n\n<pre><code>procedure TReceiverMainForm.WMCopyData(var Msg: TWMCopyData);\nvar\n  copyDataType: TCopyDataType;\nbegin\n  copyDataType := TCopyDataType(Msg.CopyDataStruct.dwData);\n\n  //Handle of the Sender\n  mmoResult.Lines.Add(Format('WM_CopyData from: %d', [msg.From]));\n\n  case copyDataType of\n    cdtString: HandleCopyDataString(Msg.CopyDataStruct);\n  end;\n\n  //Send something back\n  msg.Result := mmoResult.Lines.Count;\nend;\n\nprocedure TReceiverMainForm.HandleCopyDataString(\n  copyDataStruct: PCopyDataStruct);\nvar\n  s: string;\nbegin\n  s := PChar(copyDataStruct.lpData);\n  mmoResult.Lines.Add(s);\nend;\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>here is the vb6 code that is sending the data, the data am sending is string</p>\n\n<pre><code>Dim buf() As Byte\nReDim buf(1 To LenB(Message))\nCall CopyMemory(buf(1), ByVal Message, Len(Message))\ncds.dwData = 0\ncds.cbData = Len(Message) + 1\ncds.lpData = VarPtr(buf(1))\n' Send the string.\nDim i As Long\ni = SendMessage(lHwnd, WM_COPYDATA, MainForm.hwnd, cds)\n</code></pre>\n\n<p>can anyone tell me what am doing wrong?</p>\n"},{"tags":["delphi","delphi-xe2","vcl-styles"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":163,"score":2,"question_id":12574234,"title":"How to manually include a VCL Style in my application?","body":"<p>I have an application which uses conditionals to be able to compile it either as a VCL Forms Application or as a Windows Service Application in Delphi XE2. However, since I have manually altered the project's main source file, the IDE will no longer allow me to make certain modifications using the standard Project Options window. Specifically, I am not able to select VCL Styles to include or implement.</p>\n\n<p>Therefore, I have to implement VCL Styles manually. So, I added the two necessary units <code>Vcl.Themes</code> and <code>Vcl.Styles</code> to my project's initialization unit (which in this case is NOT the same as the project's main unit), and essentially copied the code from a working application into this new application.</p>\n\n<p>Here's the project's main unit:</p>\n\n<pre><code>program MyServiceApplication;\n\nuses\n  uMyService in 'uMyService.pas' {MyService: TService},\n  uMyServiceMain in 'uMyServiceMain.pas',\n  uMyServiceInit in 'uMyServiceInit.pas',\n  uMyServiceTest in 'uMyServiceTest.pas' {frmMyServiceTest};\n\n{$R *.RES}\n\nbegin\n  RunMyService;\nend.\n</code></pre>\n\n<p>And then in the project's initialization unit:</p>\n\n<pre><code>unit uMyServiceInit;\n\ninterface\n\nuses\n{$IFDEF TESTAPP}\n  Vcl.Forms,\n  Vcl.Themes,\n  Vcl.Styles,\n  uMyServiceTest,\n{$ELSE}\n  Vcl.SvcMgr,\n  uMyService,\n{$ENDIF TESTAPP}\n  uMyServiceMain\n  ;\n\nprocedure RunMyService;\n\nimplementation\n\nprocedure RunMyService;\nbegin\n{$IFDEF TESTAPP}\n  Application.Initialize;\n  Application.MainFormOnTaskbar := True;\n  TStyleManager.TrySetStyle('Carbon'); //&lt;--- WILL NOT RUN - STYLE DOES NOT EXIST\n  Application.Title := 'My Windows Service Application';\n  Application.CreateForm(TfrmMyServiceTest, frmMyServiceTest);\n{$ELSE}\n  if not Application.DelayInitialize or Application.Installing then\n    Application.Initialize;\n  Application.CreateForm(TMyService, MyService);\n{$ENDIF TESTAPP}\n  Application.Run;\nend;\n\nend.\n</code></pre>\n\n<p>The trouble is, when the application runs, I get an error <code>Style 'Carbon' could not be found.</code> simply because this style has not been included and compiled into the application.</p>\n\n<p>How can I compile this style manually into this application so that the VCL Styles can implement it?</p>\n\n<p>PS: The reason why the initialization is in a separate unit is because if the conditionals were implemented inside the application's main unit, the IDE would <em>destroy</em> the code.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>One thing I have tried: I opened a working project's <code>.dproj</code> file and searched for this style <code>carbon</code> hoping to find some configuration for it there, since the working project used this style, but with no luck. The word does not exist anywhere in that file.</p>\n"},{"tags":["delphi","winapi","bitmap","gdi","grayscale"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":910,"score":4,"question_id":8559341,"title":"How to convert bitmap to grayscale by pixel intensity using GDI?","body":"<p>I'm looking for the simple solution of how to convert the 32-bit bitmap to grayscale using GDI (not GDI+). Is there a possibility e.g. by changing the bitmap's pallete or something ?</p>\n\n<p>Of course there is plenty of examples in Delphi like <a href=\"http://www.swissdelphicenter.ch/torry/showcode.php?id=437\" rel=\"nofollow\">this one</a>, but I'm looking for a WinAPI function which would do this without iteration through the lines.</p>\n"},{"tags":["delphi","c++builder","mdi"],"answer_count":1,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":209,"score":7,"question_id":12588292,"title":"MDI application consumes 100% cpu in idle","body":"<p>I'm working on MDI application written in C++ Builder 2010. When child window is in maximized state, application consumes 100% of CPU time in idle mode.  </p>\n\n<p>I have used 'Very Sleepy' profiler and it shows that function <code>Sd_childFinalize</code> is using 99% of CPU resources but I can't find it in my code. sd_Child.cpp is the C++ unit where MDI child form class is defined. I only found <code>@@Sd_child@Finalize</code> symbol in executable file. Please help me to understand how to debug this issue.</p>\n\n<p>Thanks in advance.\nYuri.</p>\n"},{"tags":["delphi","delphi-xe","advantage-database-server"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":104,"score":1,"question_id":12539001,"title":"Advantage Table File in use error. How can I resolve?","body":"<p>I'm having trouble getting a certain table to open up in more then one instance of my program.\nWhats happening is I'm trying to allow users to open up and replace a current table(part of a data dictionary - FileForm.ImagesTable) with an older table (not included in the data dictionary).  It works great for one instance of the program but when we try to open up that same file simultaneously on another instance.  I get the following error.</p>\n\n<p><strong>FileName.ADT This file is in use.  Enter a new name or close the file that's open in another program.</strong></p>\n\n<p>Below is the code I have reassigning the table name and datapath to the selected table.</p>\n\n<pre><code>OpenDialog1.FileName := '*.adt';\nOpenDialog1.Filter := 'Software 6.0 Files (*.adt)|*.adt|Software 5.x Files (*.dbf)|*.dbf';\nOpenDialog1.InitialDir := DataPath;\nif OpenDialog1.Execute then\nbegin\n    Str1 := Trim(OpenDialog1.FileName);\n    if Length(Str1) = 0 then\n        Exit;\n    DSImage.Enabled := False;\n\n    with FileForm.ImagesTable do\n    begin\n        Active := False;\n        AfterOpen := FileForm.TableOther.AfterOpen;\n        DataBaseName := ExtractFilePath(Str1);   \n        TableName :=  ExtractFileName(Str1);\n        Active := True;\n    end;\n end;\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong> * Using Advtantage 8.1, Seems to be a windows error because the error happens in the dialogue window.  And yes Exclusive is set to false. </p>\n\n<p><img src=\"http://i.stack.imgur.com/SDG17.png\" alt=\"error\"></p>\n\n<hr>\n\n<p>Any thougths on why this is happening and how this could be resolved are appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["multithreading","delphi"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":208,"score":1,"question_id":12577021,"title":"How to free a thread in delphi","body":"<p>I have multithreaded application as I ask <a href=\"http://stackoverflow.com/questions/12575590/why-terminated-property-of-thread-is-set\">here</a>.\nI want to terminate the thread, and start a new one when following method is called.</p>\n\n<pre><code>procedure TFRABData.RefreshDataset;\nvar\n  GridUpdater: TGridUpdater;\nbegin\n  if Assigned(updaterThread) and (updaterThread &lt;&gt; nil) then\n  begin\n    updaterThread.Terminate;\n  end;\n  GridUpdater := TGridUpdater.Create(True);\n  GridUpdater.OwnerForm := Self;\n  updaterThread := GridUpdater;\n  GridUpdater.FreeOnTerminate := False;\n  GridUpdater.Start;\n  CodeSite.Send('RefreshDataset executed');\nend\n</code></pre>\n\n<p>but, when <code>FreeOnTerminate</code> set to <code>True</code>, I get Access Violation, but when <code>FreeOnTerminate</code> set to <code>False</code>, I get memory leak. How to free the thread? </p>\n"},{"tags":["delphi","winapi","antivirus"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":173,"score":1,"question_id":12579273,"title":"Win32 WriteFile does not return because of Antivirus","body":"<p>My code is written in Delphi 7, but I don't think it plays a particular role.</p>\n\n<p>I try to overwrite the content of a file with WriteFile.\nIt works perfectly except when writing a \".dll\" file and antivirus is active.</p>\n\n<ul>\n<li>Opening the handle to the file is still OK.</li>\n<li>writing is blocked : <strong>WriteFile function does not RETURN !!!</strong></li>\n</ul>\n\n<p>The antivirus seems to prevent from overwriting in that dll.\nBut, the worst is that I have to reboot the PC because my app is blocked, task manager is blocked, Windows Explorer is blocked, etc.</p>\n\n<p>How can I prevent this ?</p>\n\n<p>Any ideas ?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12585318,"title":"Adding text headers to a textbox","body":"<p>I am relatively new to Delphi and this is probably a very basic query but I havent been able to find an answer thus far.</p>\n\n<p>The question is, I have built a form which contains an unlimited free text field into which users will enter data. When the form loads I would like to have headings in the text field as a prompt for users to make relevant notes under these headings. </p>\n\n<p>Is there any way to insert these headings into a free text field so that they display each time the form loads?</p>\n\n<p>Many thanks.</p>\n"},{"tags":["delphi","pointers","tvirtualstringtree"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":251,"score":2,"question_id":6961182,"title":"Writing data to PVirtualNode without setting each field value manually","body":"<p>Lets say I have this node data record:</p>\n\n<pre><code>Type\n  PPerson = ^TPerson;\n  TPerson = record\n   Name: String;\n   Age: Integer;\n   SomeBool: Boolean;\n  end;\n</code></pre>\n\n<p>To populate my VirtualStringTree, I would do this:</p>\n\n<pre><code>Procedure AddToTree(Person: TPerson);\nVar\n Node: PVirtualNode;\n Data: PPerson;\nBegin\n Node := VT.AddChild(nil);\n Data := VT.GetNodeData(Node);\n Data.Name := Person.Name;\n Data.Age  := Person.Age;\n Data.SomeBool := Person.SomeBool;\nEnd;\n\nProcedure TMyForm.MyButtonClick(Sender: TObject);\nVar\n Person: TPerson;\nBegin\n Person.Name := 'Jeff';\n Person.Age := 16;\n Person.SomeBool := False;\n AddToTree(Person);\n\nEnd:\n</code></pre>\n\n<p>Now, while this works perfectly fine, I would like to simplify it, so whenever I add new fields to the record, I wont have modify the AddToTree method.</p>\n\n<p>So I tried this:</p>\n\n<pre><code>Procedure AddToTree(Person: TPerson);\nBegin\n VT.AddChild(nil,@Person);\nEnd;\n</code></pre>\n\n<p>This compiles, <strong>but</strong> it appears the <code>PVirtualNode</code> did not get the data, because my VT is not displaying anything, and when breaking in the OnGetText event, I see the variables are empty.</p>\n\n<p>What am I doing wrong? :)</p>\n"},{"tags":["delphi","draw","invisible"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":137,"score":1,"question_id":12584604,"title":"Draw an invisible control on a canvas in Delphi","body":"<p>I made a calendar component for Delphi. Now I want to add a visual effect to it while changing months (like Windows Vista standard calendar).</p>\n\n<p>Now I want to create an invisible duplicate of the component and draw that one on the canvas to use it for the visual effect. I tried <code>BitBlt</code> function but it does not work because the control is invisible. Is there any way to draw an invisible control on a canvas?</p>\n"},{"tags":["wcf","delphi","wcf-data-services","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":12577304,"title":"How do set the timeout on a wcf service caller in Delphi?","body":"<p>I have a straightforward call to a wcf service hosted by iis I'm Delphi 2010</p>\n\n<p>The operation being called on the service could take several minutes </p>\n\n<p>What is the best way of avoiding a timeout error in Delphi?</p>\n\n<p>I deliberately put a Thread.Sleep inside my WCF Service force it to wait for 31 seconds</p>\n\n<p>After 30 seconds I got the error</p>\n\n<p>Project  raised exception class ESOAPHTTPException with message 'The handle is in the wrong state for the requested operation - URL:http://10.1.1.4/STC.WcfServices.Host/FlexProcurementService.svc - SOAPAction:http://navsl.stcenergy.com/FlexProcurement/FlexProcurementService/GetPassthroughSummaryGridReportData'.</p>\n\n<p>This turned out to be a bug in Delphi 2010 which I have applied the patch for, so now I get the error operation timed out</p>\n\n<pre><code>function GetFlexProcurementService(const objServiceInfo: TWCFService; UseWSDL: Boolean; Addr: string; HTTPRIO: THTTPRIO): FlexProcurementService;\nvar\n  RIO: THTTPRIO;\nbegin\n  Result := nil;\n  if (Addr = '') then\n  begin\n    if UseWSDL then\n      Addr := objServiceInfo.WSDL\n    else\n      Addr := objServiceInfo.URL;\nend;\nif HTTPRIO = nil then\n  RIO := THTTPRIO.Create(nil)\nelse\n  RIO := HTTPRIO;\ntry\n  Result := (RIO as FlexProcurementService);\n  if UseWSDL then\n  begin\n    RIO.WSDLLocation := Addr;\n    RIO.Service := objServiceInfo.Svc;\n    RIO.Port := objServiceInfo.Prt;\n  end else\n    RIO.URL := Addr;\nfinally\n  if (Result = nil) and (HTTPRIO = nil) then\n    RIO.Free;\nend;\n</code></pre>\n\n<p>end;</p>\n\n<p>Paul</p>\n"},{"tags":["delphi","windows-7","delphi-2010","alt-tab"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":585,"score":2,"question_id":3039279,"title":"App disappears from Win7's ALT-TAB list sometimes","body":"<p>I've been having some trouble with one of my Delphi 2010 projects lately.  It seems that sometimes, when I have a form open as a modal dialog, the app stops showing up in the ALT-TAB list until I close the dialog.  It's still in the Taskbar, but not in ALT-TAB, which means I can't switch to it without using the mouse.</p>\n\n<p>Running under Windows 7, 64-bit.  Has anyone seen this before?  Any idea what causes it and how to fix it?</p>\n"},{"tags":["delphi","google-app-engine","oauth","indy"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":123,"score":2,"question_id":12408798,"title":"AppEngine error 400 when requesting access token","body":"<p>I'm writing a Delphi based PC application which accesses an AppEngine servlet. I'm trying to use the OAuth 1.0 dance to authenticate users and allow access to a restricted part of the application.\nI'm able to get access to the restricted servlet using a browser and going through google user authentication.\nI'm now trying to implement the dance.\nI successfully get the token and token secret using OAuthGetRequestToken.</p>\n\n<pre><code>Key := 'XXXX.appspot.com';\nSecret := 'YYYY';\nURL := 'https://XXXX.appspot.com/_ah/OAuthGetRequestToken';\nConsumer := TOAuthConsumer.Create(Key, Secret);\nHMAC := TOAuthSignatureMethod_HMAC_SHA1.Create;\nARequest := TOAuthRequest.Create(URL);\nARequest := ARequest.FromConsumerAndToken(Consumer, nil, URL,'','oob','');\nARequest.Sign_Request(HMAC, Consumer, nil,true);\nURL := URL + '?' + ARequest.GetString;\nidHTTP1.Get(URL,ms);\nARequest.Destroy;\nHMAC.Destroy;\nConsumer.Destroy;\n</code></pre>\n\n<p>The GET request and response look like this:</p>\n\n<pre><code>GET /_ah/OAuthGetRequestToken HTTP/1.1\nHost: XXXX.appspot.com\nAccept: */*\nAuthorization: OAuth oauth_version=\"1.0\", oauth_nonce=\"1511ec6d98e5b89c561b1af4b3022476\", oauth_timestamp=\"1347534557\", oauth_consumer_key=\"XXXX.appspot.com\", oauth_callback=\"oob\", oauth_signature_method=\"HMAC-SHA1\", oauth_signature=\"JPSgMsipsLumldKsca8SA8gDXgw%3D\"\n\nHTTP/1.1 200 OK\nDate: Thu, 13 Sep 2012 11:09:18 GMT\nContent-Type: text/html\nServer: Google Frontend\nContent-Length: 88\noauth_token=4%2FY4ReEZt9v8IYHJ_4WnZYkzurXOgw&amp;oauth_token_secret=S9150fuyvo_jjr43Cd47CPzY\n</code></pre>\n\n<p>Next, I authorize the token.</p>\n\n<pre><code>URL := 'https://inksureauth.appspot.com/_ah/OAuthAuthorizeToken?oauth_token='+TOAuthUtil.urlEncodeRFC3986(Token.Text);\nIdHTTP1.Get(URL,ms);  \n</code></pre>\n\n<p>I'm redirected to the google web page for login. As I stated 'oob' for callback, I receive a verification code on the web page which I copy.</p>\n\n<p>Finally, I try to get exchange the token for an access token. Here I fail.</p>\n\n<pre><code>URL := 'https://XXXX.appspot.com/_ah/OAuthGetAccessToken';\nKey := 'XXXX.appspot.com';\nSecret := 'YYYY';\nConsumer := TOAuthConsumer.Create(Key, Secret);\nARequest := TOAuthRequest.Create(URL);\nAToken := TOAuthToken.Create(TOAuthUtil.urlEncodeRFC3986(Token.Text), TokenSecret.Text);\nARequest.HTTPURL := URL;\nARequest := ARequest.FromConsumerAndToken(Consumer,AToken , URL,'','','VERIFICATION CODE FROM WEB PAGE');\nHMAC := TOAuthSignatureMethod_HMAC_SHA1.Create;\nARequest.Sign_Request(HMAC, Consumer, AToken,true);\nURL := URL + '?' + ARequest.GetString;\nIdHTTP1.Disconnect;\nIdHTTP1.Get(URL,ms);\nHMAC.Destroy;\nARequest.Destroy;\nConsumer.Destroy;\n</code></pre>\n\n<p>The GET command looks like this:</p>\n\n<pre><code>GET /_ah/OAuthGetAccessToken?oauth_version=1.0&amp;oauth_nonce=4A86BEECE494C25AF94882F74DEE6231&amp;oauth_timestamp=1347545383&amp;oauth_consumer_key=XXXX.appspot.com&amp;oauth_verifier=yGEhCENYOlni2ayo8aNckyPG&amp;oauth_token=4%2FEKGFo9i2wmuMGcBLmbmQhqDba0z4&amp;oauth_signature_method=HMAC-SHA1&amp;oauth_signature=2ZwRvGp8LnXenTXrjYo5%2FtFHW30%3D HTTP/1.1\n</code></pre>\n\n<p>And the response:</p>\n\n<pre><code>HTTP/1.1 400 Bad Request\nDate: Thu, 13 Sep 2012 14:09:44 GMT\nContent-Type: text/html; charset=UTF-8\nServer: Google Frontend\nContent-Length: 273\n\n\n&lt;html&gt;&lt;head&gt;\n&lt;meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"&gt;\n&lt;title&gt;400 Bad Request&lt;/title&gt;\n&lt;/head&gt;\n&lt;body text=#000000 bgcolor=#ffffff&gt;\n&lt;h1&gt;Error: Bad Request&lt;/h1&gt;\n&lt;h2&gt;Your client has issued a malformed or illegal request.&lt;/h2&gt;\n&lt;h2&gt;&lt;/h2&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>I used the OAuth playground to access the same application and it is successful in retrieving the access key. I compared the playground's request parameters to the parameters generated by my application and they are compatible. I used my signing function to sign a request generated by the playground and the signatures matched. What other reason can there be for the last step to fail? \nIs it possible to get a more informative response from the authentication server beyond \"Your client has issued a malformed or illegal request\"?</p>\n\n<p>Update: I have used my application to retrieve an access token to Google calendar successfuly. Using the same code I change back to the AppEngine application and fail on the GetAccessToken step.</p>\n"},{"tags":["delphi","matlab","delphi-xe","ole"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":169,"score":0,"question_id":11392191,"title":"Call Matlab function with string parameters from Delphi XE using OLE","body":"<p>I'm trying to call a Matlab function from Delphi XE using a OLE object. The function has 2 string parameters.\nWhen I try the Matlab code in Matlab (2008a) itself, it is all OK but for some reason I cannot get the input parameters to Matlab from Delphi XE.</p>\n\n<p>Does anyone have an idea how to achieve this?\nAs you can see in my code, I also tried setting variables in the workspace, which is an acceptable workaround for me.</p>\n\n<pre><code>function Matlab_DoIt(const aInput, aOutput: string): string;\nvar\n  vMatlab, vInput: Variant;\nbegin\n  vInput := aInput;\n  vMatlab := CreateOleObject('matlab.application');\n  vMatlab.visible := 1;\n  vMatlab.Execute('cd c:\\localdata\\LSCT\\Matlab');\n  // vMatlab.Execute('input=' + aInput); // nothing happens\n  // vMatlab.PutCharArray('input', 'base', aInput); // nothing happens\n  // vMatlab.PutCharArray('input', 'base', vInput); // bad variable type error\n  // vMatlab.PutCharArray('input', 'global', aInput); // nothing happens\n  // vMatlab.PutWorkspaceData('input', 'base', aInput); // nothing happens\n  // vMatlab.PutWorkspaceData('input', 'base', vInput); // bad variable type error\n  // vMatlab.PutWorkspaceData('input', 'global', aInput); // nothing happens\n  // vMatlab.Execute(Format('LSCT_tool_run(%s,%s)', [aInput, aOutput])); // nothing happens\n  // vMatlab.Execute(Format('LSCT_tool_run(''%s'',''%s'')', [aInput, aOutput])); // nothing happens\n  // vMatlab.Execute(Format('LSCT_tool_run(\"%s\",\"%s\")', [aInput, aOutput])); // nothing happens\n  vMatlab.Execute('LSCT_tool_run'); // creates the file, but it is empty\nend;\n</code></pre>\n\n<p>The matlab code writes a txt file containing the two parameters:\n    function LSCT_tool_run(input_path, output_path)</p>\n\n<pre><code>diary ([c:\\localdata\\LSCT\\Matlab\\MyFile.txt]);\ndiary on;\n% fprintf(input); only when I try to set the input variable\nfprintf(inpput_path);\nfprintf(output_path);\ndiary off;\n</code></pre>\n"},{"tags":["windows","delphi","usb"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2544,"score":3,"question_id":4292395,"title":"How to get manufacturer serial number of an USB flash drive?","body":"<p>How can I retrieve the manufacturer serial number of an USB flash drive in Delphi ?</p>\n\n<p>I have tried this:</p>\n\n<pre><code>function GetDiskVolSerialID(ADriveName: Char): Cardinal;\nvar\n  DiskDrive: string;\n  FileSystemFlags: DWORD;\n  VolumeSerialNumber: DWORD;\n  MaximumComponentLength: DWORD;\nbegin\n  DiskDrive := ADriveName + ':\\';\n  GetVolumeInformation(PChar(DiskDrive),\n                       nil,\n                       0,\n                       @VolumeSerialNumber,\n                       MaximumComponentLength,\n                       FileSystemFlags,\n                       nil,\n                       0);\n  Result := VolumeSerialNumber;\nend;\n</code></pre>\n\n<p>But it doesn't return correct result!</p>\n"},{"tags":["delphi","rest","delphi-7"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":660,"score":3,"question_id":366291,"title":"Delphi 7 & ICS sending DELETE requests","body":"<p>How can I send a DELETE request with delphi 7 and the ICS component so that I can access a REST api?</p>\n"},{"tags":["delphi","post","httpclient"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1023,"score":1,"question_id":2403676,"title":"Delphi: problem with httpcli (ICS) post method","body":"<p>I am using HttpCli component form ICS to POST a request. I use an example that comes with the component. It says:</p>\n\n<pre><code>procedure TForm4.Button2Click(Sender: TObject);\nvar\n    Data : String;\nbegin\n    Data:='status=no';\n    HttpCli1.SendStream := TMemoryStream.Create;\n    HttpCli1.SendStream.Write(Data[1], Length(Data));\n    HttpCli1.SendStream.Seek(0, 0);\n    HttpCli1.RcvdStream := TMemoryStream.Create;\n    HttpCli1.URL := Trim('http://server/something');\n    HttpCli1.PostAsync;\nend;\n</code></pre>\n\n<p>But it fact, it sends not </p>\n\n<blockquote>\n  <p>status=no</p>\n</blockquote>\n\n<p>but</p>\n\n<blockquote>\n  <p>s.t.a.t.u</p>\n</blockquote>\n\n<p>I can't understand, where is the problem. Maybe someone can show an example, how to send POST request with the help of HttpCli component?</p>\n\n<p>PS I can't use Indy =)</p>\n"},{"tags":["delphi","indy"],"answer_count":7,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":1133,"score":11,"question_id":2663494,"title":"Indy or ICS or ? ","body":"<p>Can any one tell me which is more stable?  I know each has their own advantages and disadvantages.  But which one is better for http, etc?</p>\n\n<p>In my previous application I used indy9 but I wasn't satisfied with it, as I would sometimes get strange errors.</p>\n\n<p>Can anyone recommend one?</p>\n"},{"tags":["facebook","delphi","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":494,"score":0,"question_id":3428440,"title":"access facebook with ICS-SSL","body":"<p>I'm trying to access/login to Facebook with a program (OverbyteIcsHttpTst.exe) compiled with Delphi using the component ThttpCli (<a href=\"http://www.overbyte.be/eng/products/ics.html\" rel=\"nofollow\">ICS-SSL</a>, which is the latest version that supports https).</p>\n\n<p>The idea is that I want to to access Facebook just like an ordinary browser does.</p>\n\n<p>For example, I tried to login by using \"post\" to send some data to Facebook with the following code:</p>\n\n<pre><code>https://login.facebook.com/login.php?login_attempt=1\n\nPOSTDATA=charset_test=%E2%82%AC%2C%C2%B4%2C%E2%82%AC%2C%C2%B4%2C%E6%B0%B4%2C%D0%94%2C%D0%84&amp;locale=en_US&amp;email=yourmail%40yahoo.com&amp;pass=yourpassword&amp;charset_test=%E2%82%AC%2C%C2%B4%2C%E2%82%AC%2C%C2%B4%2C%E6%B0%B4%2C%D0%94%2C%D0%84&amp;lsd=XAN99\n\nCooKies : datr=1281135108-ea5c44949be49439183341b84db24aeb6c589ca1d31dc0c0da28d; expires=Sun, 05-Aug-2012 22:51:48 GMT; path=/; domain=.facebook.com;lsd=0ygNR; path=/; domain=.facebook.com;reg_fb_gate=http%3A%2F%2Fwww.facebook.com%2F; path=/; domain=.facebook.com;reg_fb_ref=http%3A%2F%2Fwww.facebook.com%2F; path=/; domain=.facebook.com\n</code></pre>\n\n<p>But I'm still stuck on the main page.  Is anything missing? </p>\n\n<p>Thanks.</p>\n"},{"tags":["delphi","delphi-7"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":282,"score":1,"question_id":5189471,"title":"Send Record Via ICS (Internet Component Suite) Delphi","body":"<p>i want to send record with <a href=\"http://www.overbyte.be/frame_index.html?redirTo=/products/ics.html\" rel=\"nofollow\">ICS (Internet Component Suite)</a> from client to server\ni have a record</p>\n\n<pre><code>PIPCDataPhone = ^TIPCDataPhone;                        \nTIPCDataPhone = record                                     \n  cmd: string[15];                                       \n  Mode: Integer;                                          \nend;\n</code></pre>\n\n<p>i want to sent that record to server using the protocol TCP</p>\n\n<p>thanks</p>\n"},{"tags":["delphi"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":245,"score":2,"question_id":6182918,"title":"Delphi, MultiPartHttpDownloader from ICS: download several files sequentially","body":"<p>Can anybody tell me how to download several files sequentially using MultiPartHttpDownloader from ICS in Delphi?</p>\n\n<p>Thanks!!!</p>\n"},{"tags":["delphi","file","download","gzip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":194,"score":0,"question_id":6526220,"title":"problem with HTTPCLI download with gzip-deflate on server","body":"<p>I use DELPHI 7 with this code for a long time with ICS7 without any problems... My code download a page using httpcli and save in my local disk.</p>\n\n<p>but now ,after a fews months, the main site was updated and uses gzip-deflate and I think that this is the problem, I don't know how to\nhandle this, and my code stop working. please, need help.</p>\n\n<p>download ICS7 package:\nICS7 package => <a href=\"http://www.overbyte.be/arch/OverbyteIcsV7.zip\" rel=\"nofollow\">http://www.overbyte.be/arch/OverbyteIcsV7.zip</a></p>\n\n<p>download my full code (with sources and compiled exe).</p>\n\n<p><a href=\"http://www.fileden.com/files/2010/4/9/2822525/load-page-using-ICS7.zip\" rel=\"nofollow\">http://www.fileden.com/files/2010/4/9/2822525/load-page-using-ICS7.zip</a></p>\n"},{"tags":["multithreading","delphi","sockets","vcl"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":274,"score":3,"question_id":8352818,"title":"How can I push a TWSocket's OnDataAvailable() event to a background thread in my Delphi 6 application?","body":"<p>I have a Delphi 6 application that uses the ICS component suite to do socket communications.  I have my own server socket VCL component that creates client TWSocket sockets when a new session becomes available.  The client sockets I create do have the Multithreaded property set to TRUE, but all that does is changes the way the client socket handles socket messages to a manner that is safe from a background thread (non-main VCL thread).  TWSocket does not spawn a thread to handle socket data traffic, which is what I need.</p>\n\n<p>I need to have the receive calls occur off the main VCL thread, the main user interface thread, because the incoming data to the client socket is audio data that needs to be processed rapidly, in 50-100 milliseconds or less.  In other words, one hiccup on the main VCL thread and the audio stream is disrupted.  This is why I want to push the OnDataAvailable() event that fires whenever incoming data is available on to a high priority background thread.  In other words, I want to force the message processing loop belonging to the client TWSocket object to a background thread.</p>\n\n<p>I believe I can do this by creating the client socket via a background thread, but I'm hoping to avoid that since currently I use a VCL component I made that acts as a socket server.  This is the entity that Accepts the incoming connection and spawns the client sockets.  The socket server is created on the main VCL thread.</p>\n\n<p>Therefore my question is, is there a (relatively) easy way to create the client sockets so they use an existing background thread to do their socket processing, especially the FD_RECV message handling?  If not an existing background thread, then I will create one for each client socket I create, but I need to know how to make sure the new TWSocket object uses that background thread when it runs its message loop that processes socket messages, so how would I do that?</p>\n"},{"tags":["delphi","ssl","indy","delphi-5"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":584,"score":1,"question_id":7902152,"title":"Delphi 5 Indy/ics SSL workaround?","body":"<p>I'm getting errors like:</p>\n\n<blockquote>\n  <p>\"IndyProtocols5 does not use or support IdSSLOpenSSLHeaders..\"</p>\n</blockquote>\n\n<p>when attempting to install Indy 9 or 10 with my Delphi5 and notice it is a problem for others. This causes the exception:</p>\n\n<blockquote>\n  <p>\"Could not load SSL library\"</p>\n</blockquote>\n\n<p>when using IdHttp.IOHandler.</p>\n\n<p>The applications I have inherited include so many unsupported D5 components, upgrading to D6+ is unfortunately beyond my skillset. I want to initially use Indy for posting and downloading CSV, but potentially calling web services too.</p>\n\n<p>Is there a known workaround for this or should I start looking in to other options like ICS which may still work with D5.</p>\n\n<p>Thanks </p>\n"},{"tags":["jquery","delphi","serialization","delphi-2010"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":224,"score":0,"question_id":11427706,"title":"Convert Record to Serialized Form Data for sending via HTTP","body":"<p>Is there a way to convert this Record</p>\n\n<pre class=\"lang-default prettyprint-override\"><code>TError = record\n  code: Word;\n  message: String;\nend;\n\nTState = record\n  caption: String;\n  address: Cardinal;\n  counters: TArray&lt;Word&gt;;\n  errors: TArray&lt;TError&gt;;\nend;\n</code></pre>\n\n<p>to serialized Form Data string (<code>Content-Type: application/x-www-form-urlencoded</code>) like</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>caption=Foo&amp;\naddress=175896&amp;\ncounters[]=2&amp;\ncounters[]=2&amp;\nerrors[0][code]=52&amp;\nerrors[0][message]=ERR_NOT_AVAILABLE\n</code></pre>\n\n<p>for sending via HTTP?</p>\n\n<p>Maybe there is some function similar to <a href=\"http://api.jquery.com/jQuery.param/\" rel=\"nofollow\">JQuery.param()</a>?</p>\n"},{"tags":["delphi","image-processing","jpeg","delphi-7"],"answer_count":10,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2138,"score":2,"question_id":1639790,"title":"Processing large images with Delphi for saving as .jpeg","body":"<p>In Delphi 7, I have a library that uses the TCanvas component to output some information. The resulting image is about 4800*6000 pixels and I would like to print it and save it as <code>.jpeg</code>.</p>\n\n<p>To achieve this, I created a TBitmap and gave its Canvas as parameter to the library and then I assigned the bitmap to the jpeg. Apparently, this is taking too much memory, because I am getting an exception when trying to set the bitmap's width and height, saying \"Not enough storage is available to process this command.\"</p>\n\n<pre><code>// output to printer\nPrinter.BeginDoc();\ndoPrint(Printer.Canvas);\nPrinter.EndDoc();\n\n// output in bmp.Canvas\nbmp := TBitmap.Create;\nbmp.Width := Printer.PageWidth;\nbmp.Height := Printer.PageHeight; // &lt;- BAM! Exception!\ndoPrint(bmp.Canvas);\n\n// save as jpeg\njpg := TJPEGImage.Create;\njpg.Assign(bmp);\njpg.SaveToFile('...');\n\n// free\nbmp.Free();\njpg.Free();\n</code></pre>\n\n<p>What am I doing wrong? Could I save Printer.Canvas directly as a <code>.jpeg</code> file?</p>\n\n<p>Edit: Updated image size approximation from 2000*2000 to 4800*6000</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":372,"score":0,"question_id":1473165,"title":"Drawing and Not enough storage?","body":"<p>hi \n I want draw a table with Timage canvas but when i want draw a large table, occur this error \"not enough storage is available to process this command\"</p>\n\n<p>increase the SharedSection in Registry,but not effect at my problem.  </p>\n\n<p>please guide me..</p>\n"},{"tags":["delphi","winapi","vcl","notification-area"],"answer_count":3,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":1111,"score":3,"question_id":3712551,"title":"How can I check if my application has focus?","body":"<p>What I want to do is check if my application has focus because if it is not then I will popup an Alert Window just over the Notification Area to display some message to the end user.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":178,"score":3,"question_id":12574843,"title":"How to set my IP address programmatically?","body":"<p>How can I set my IP address programmatically?</p>\n\n<p>My application is checking it, using code from <a href=\"http://www.delphitricks.com/source-code/internet/get_your_own_ip_address.html\" rel=\"nofollow\">DelphiTricks</a> (although I am not sure if the code from <a href=\"http://delphi.about.com/od/networking/l/aa103100a.htm\" rel=\"nofollow\">About.com</a> might not be better)</p>\n\n<p>I want to be able to set the address programmatically for testing purposes. And (I don't know if this is important), I want to be able to do so even I am not attached to any network (on a laptop, on a train).</p>\n"},{"tags":["delphi","delphi-7","filestream"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":166,"score":7,"question_id":12576325,"title":"TReadOnlyCachedFileStream error on files greater than 2 GB","body":"<p>David Heffernan posted a custom filestream here:\n<a href=\"http://stackoverflow.com/questions/5639531/buffered-files-for-faster-disk-access\">Buffered files (for faster disk access)</a></p>\n\n<p>It works on files less than 2 GB without problems and is very fast. On files greater than 2GB it fails around 1.90 GB consistently. The error is: </p>\n\n<p><code>Project1.exe raised exception class EStreamError with message 'SetFilePointerEx failed for C:\\Projects\\Huge.txt. An Attempt was made to move the file pointer before the beginning of the file'. Process stopped.</code> </p>\n\n<p>`</p>\n\n<pre><code>const\n bufsz = 65536; //64K\nvar\n  strTmp : AnsiString;\n  bufStreamIN  : TReadOnlyCachedFileStream;\n  bufStreamOut : TWriteCachedFileStream;\n  strmsize, BytesRead, M, NumberOfBytes, J : LongWord;\n  Buffer: PByte;\n\n      J := bufStreamIn.Size; \ntry\n      while (bufStreamIN.Position &lt; J)  do\n      begin\n        BytesRead := bfStreamIN.Read(Buffer^, bufsz);\n        NumberOfBytes := NumberOfBytes + BytesRead;\n        SetLength(strTmp, BytesRead);\n        strTmp := Copy(PAnsiChar(Buffer), 1, BytesRead);\n        bufStreamOut.WriteBuffer(Pointer(strTmp)^, Length(strTmp));\n        StrTmp := '';\n        strmsize := j - NumberOfBytes;\n        if strmsize &gt; BytesRead then\n          bfStreamIN.Position := bfStreamIN.Seek(BytesRead, soFromCurrent)\n        else bfStreamIN.Position := bfStreamIN.Seek(strmsize, soFromCurrent);\n        ProgressBar1.Position := 100*bfStreamIN.Position div J;\n        Application.ProcessMessages;\n      end;\n    finally\n      Memo1.Lines.Add('Done');\n    end;\n  finally\n    FreeMem(Buffer);\n    bufStreamIN.Free;\n    bufStreamOut.Free;\n  end;`\n</code></pre>\n\n<p>This works on files less than 2GB without problems and even works without checking size of stream left to read here:</p>\n\n<pre><code>if strmsize &gt; BytesRead then\n      bfStreamIN.Position := bfStreamIN.Seek(BytesRead, soFromCurrent)\n    else bfStreamIN.Position := bfStreamIN.Seek(strmsize, soFromCurrent);\n</code></pre>\n\n<p>such as this which works on files less than 2GB:</p>\n\n<pre><code>bufStreamIN.Position := bufStreamIN.Seek(NumberOfBytes, soFromBeginning);\n</code></pre>\n\n<p>I use Delphi 7 32bit and my OS is Win 7 64bit with 4GB RAM\nI used JCL's TJclBufferedStream and it works very well on that Huge file without problems. Only problem is that it is much much slower. </p>\n\n<p>In my DPR I have used this as was suggested by another post I read in order to use higher memory but here I think it is not memory problem:  <code>{$SetPEFlags $0020}</code></p>\n\n<p>The full unit with some changes that were suggested in the other post:</p>\n\n<pre><code>interface\n\nuses\n  Classes,\n  Windows,\n  SysUtils,\n  Math;\n\ntype\n  IStreamErrorHandler = interface\n    ['{B2A95D51-DD0D-49C2-9511-638EE4F911C8}']\n    procedure HandleError(const Msg: string='');\n  end;\n\n  TBaseCachedFileStream = class(TStream, IStreamErrorHandler)\n  private\n    function QueryInterface(const IID: TGUID; out Obj): HResult; stdcall;\n    function _AddRef: Integer; stdcall;\n    function _Release: Integer; stdcall;\n  protected\n    FHandle: THandle;\n    FOwnsHandle: Boolean;\n    FCache: PByte;\n    FCacheSize: Integer;\n    FPosition: Int64;//the current position in the file (relative to the beginning of the file)\n    FCacheStart: Int64;//the postion in the file of the start of the cache (relative to the beginning of the file)\n    FCacheEnd: Int64;//the postion in the file of the end of the cache (relative to the beginning of the file)\n    FFileName: string;\n    FLastError: DWORD;\n    procedure HandleError(const Msg: string);\n    procedure RaiseSystemError(const Msg: string; LastError: DWORD); overload;\n    procedure RaiseSystemError(const Msg: string); overload;\n    procedure RaiseSystemErrorFmt(const Msg: string; const Args: array of const);\n    function CreateHandle(FlagsAndAttributes: DWORD): THandle; virtual; abstract;\n    function GetFileSize: Int64; virtual;\n    procedure SetSize(NewSize: LongInt); override;\n    procedure SetSize(const NewSize: Int64); override;\n    function FileRead(var Buffer; Count: Longword): Integer;\n    function FileWrite(const Buffer; Count: Longword): Integer;\n    function FileSeek(const Offset: Int64; Origin: TSeekOrigin): Int64;\n  public\n    constructor Create(const FileName: string); overload;\n    constructor Create(const FileName: string; CacheSize: Integer); overload;\n    constructor Create(const FileName: string; CacheSize: Integer; Handle: THandle); overload; virtual;\n    destructor Destroy; override;\n    property CacheSize: Integer read FCacheSize;\n    function Read(var Buffer; Count: Longint): Longint; override;\n    function Write(const Buffer; Count: Longint): Longint; override;\n    function Seek(const Offset: Int64; Origin: TSeekOrigin): Int64; override;\n  end;\n  TBaseCachedFileStreamClass = class of TBaseCachedFileStream;\n\n  IDisableStreamReadCache = interface\n    ['{0B6D0004-88D1-42D5-BC0F-447911C0FC21}']\n    procedure DisableStreamReadCache;\n    procedure EnableStreamReadCache;\n  end;\n\n  TReadOnlyCachedFileStream = class(TBaseCachedFileStream, IDisableStreamReadCache)\n  (* This class works by filling the cache each time a call to Read is made and\n     FPosition is outside the existing cache.  By filling the cache we mean\n     reading from the file into the temporary cache.  Calls to Read when\n     FPosition is in the existing cache are then dealt with by filling the\n     buffer with bytes from the cache.\n  *)\n  private\n    FUseAlignedCache: Boolean;\n    FViewStart: Int64;\n    FViewLength: Int64;\n    FDisableStreamReadCacheRefCount: Integer;\n    procedure DisableStreamReadCache;\n    procedure EnableStreamReadCache;\n    procedure FlushCache;\n  protected\n    function CreateHandle(FlagsAndAttributes: DWORD): THandle; override;\n    function GetFileSize: Int64; override;\n  public\n    constructor Create(const FileName: string; CacheSize: Integer; Handle: THandle); overload; override;\n    property UseAlignedCache: Boolean read FUseAlignedCache write FUseAlignedCache;\n    function Read(var Buffer; Count: Longint): Longint; override;\n    procedure SetViewWindow(const ViewStart, ViewLength: Int64);\n  end;\n\n  TWriteCachedFileStream = class(TBaseCachedFileStream, IDisableStreamReadCache)\n  (* This class works by caching calls to Write.  By this we mean temporarily\n     storing the bytes to be written in the cache.  As each call to Write is\n     processed the cache grows.  The cache is written to file when:\n       1.  A call to Write is made when the cache is full.\n       2.  A call to Write is made and FPosition is outside the cache (this\n           must be as a result of a call to Seek).\n       3.  The class is destroyed.\n\n     Note that data can be read from these streams but the reading is not\n     cached and in fact a read operation will flush the cache before\n     attempting to read the data.\n  *)\n  private\n    FFileSize: Int64;\n    FReadStream: TReadOnlyCachedFileStream;\n    FReadStreamCacheSize: Integer;\n    FReadStreamUseAlignedCache: Boolean;\n    procedure DisableStreamReadCache;\n    procedure EnableStreamReadCache;\n    procedure CreateReadStream;\n    procedure FlushCache;\n  protected\n    function CreateHandle(FlagsAndAttributes: DWORD): THandle; override;\n    function GetFileSize: Int64; override;\n  public\n    constructor Create(const FileName: string; CacheSize, ReadStreamCacheSize: Integer; ReadStreamUseAlignedCache: Boolean); overload;\n    destructor Destroy; override;\n    function Read(var Buffer; Count: Longint): Longint; override;\n    function Write(const Buffer; Count: Longint): Longint; override;\n  end;\n\n\n    function GetFileSizeEx(hFile: THandle; var lpFileSize: Int64): BOOL;\n      stdcall; external 'kernel32.dll';\n    function SetFilePointerEx(hFile: THandle; liDistanceToMove: Int64;\n      lpNewFilePointer: PInt64; dwMoveMethod: DWORD): BOOL;\n      stdcall; external 'kernel32.dll';\n\nimplementation\n\n{ TBaseCachedFileStream }\n\nconstructor TBaseCachedFileStream.Create(const FileName: string);\nbegin\n  Create(FileName, 0);\nend;\n\nconstructor TBaseCachedFileStream.Create(const FileName: string; CacheSize: Integer);\nbegin\n  Create(FileName, CacheSize, 0);\nend;\n\nconstructor TBaseCachedFileStream.Create(const FileName: string; CacheSize: Integer; Handle: THandle);\nconst\n  DefaultCacheSize = 16*1024;\n  //16kb - this was chosen empirically - don't make it too large otherwise the progress report is 'jerky'\nbegin\n  inherited Create;\n  FFileName := FileName;\n  FOwnsHandle := Handle=0;\n  if FOwnsHandle then begin\n    FHandle := CreateHandle(FILE_ATTRIBUTE_NORMAL);\n  end else begin\n    FHandle := Handle;\n  end;\n  FCacheSize := CacheSize;\n  if FCacheSize&lt;=0 then begin\n    FCacheSize := DefaultCacheSize;\n  end;\n  GetMem(FCache, FCacheSize);\nend;\n\ndestructor TBaseCachedFileStream.Destroy;\nbegin\n  FreeMem(FCache);\n  if FOwnsHandle and (FHandle&lt;&gt;0) then begin\n    CloseHandle(FHandle);\n  end;\n  inherited;\nend;\n\nfunction TBaseCachedFileStream.QueryInterface(const IID: TGUID; out Obj): HResult;\nbegin\n  if GetInterface(IID, Obj) then begin\n    Result := S_OK;\n  end else begin\n    Result := E_NOINTERFACE;\n  end;\nend;\n\nfunction TBaseCachedFileStream._AddRef: Integer;\nbegin\n  Result := -1;\nend;\n\nfunction TBaseCachedFileStream._Release: Integer;\nbegin\n  Result := -1;\nend;\n\nprocedure TBaseCachedFileStream.HandleError(const Msg: string);\nbegin\n  if FLastError&lt;&gt;0 then begin\n    RaiseSystemError(Msg, FLastError);\n  end;\nend;\n\nprocedure TBaseCachedFileStream.RaiseSystemError(const Msg: string; LastError: DWORD);\nbegin\n  raise EStreamError.Create(Trim(Msg+'  '+ SysErrorMessage(GetLastError)));\n  //raise EStreamError.Create(Trim(Msg+'  '+GetSystemErrorString(LastError)));\nend;\n\nprocedure TBaseCachedFileStream.RaiseSystemError(const Msg: string);\nbegin\n  RaiseSystemError(Msg, GetLastError);\nend;\n\nprocedure TBaseCachedFileStream.RaiseSystemErrorFmt(const Msg: string; const Args: array of const);\nbegin\n  RaiseSystemError(Format(Msg, Args));\nend;\n\nfunction TBaseCachedFileStream.GetFileSize: Int64;\nbegin\n  if not GetFileSizeEx(FHandle, Result) then begin\n    RaiseSystemErrorFmt('GetFileSizeEx failed for %s.', [FFileName]);\n  end;\nend;\n\nprocedure TBaseCachedFileStream.SetSize(NewSize: LongInt);\nbegin\n  SetSize(Int64(NewSize));\nend;\n\nprocedure TBaseCachedFileStream.SetSize(const NewSize: Int64);\nbegin\n  Seek(NewSize, soBeginning);\n  if not Windows.SetEndOfFile(FHandle) then begin\n    RaiseSystemErrorFmt('SetEndOfFile for %s.', [FFileName]);\n  end;\nend;\n\nfunction TBaseCachedFileStream.FileRead(var Buffer; Count: Longword): Integer;\nbegin\n  if Windows.ReadFile(FHandle, Buffer, Count, LongWord(Result), nil) then begin\n    FLastError := 0;\n  end else begin\n    FLastError := GetLastError;\n    Result := -1;\n  end;\nend;\n\nfunction TBaseCachedFileStream.FileWrite(const Buffer; Count: Longword): Integer;\nbegin\n  if Windows.WriteFile(FHandle, Buffer, Count, LongWord(Result), nil) then begin\n    FLastError := 0;\n  end else begin\n    FLastError := GetLastError;\n    Result := -1;\n  end;\nend;\n\nfunction TBaseCachedFileStream.FileSeek(const Offset: Int64; Origin: TSeekOrigin): Int64;\nbegin\n  if not SetFilePointerEx(FHandle, Offset, @Result, ord(Origin)) then begin\n    RaiseSystemErrorFmt('SetFilePointerEx failed for %s.', [FFileName]);\n  end;\nend;\n\nfunction TBaseCachedFileStream.Read(var Buffer; Count: Integer): Longint;\nbegin\n  Assert(False);\n  //raise EAssertionFailed.create; //RaiseAssertionFailed(Result);\nend;\n\nfunction TBaseCachedFileStream.Write(const Buffer; Count: Integer): Longint;\nbegin\n  Assert(False);\n  //raise EAssertionFailed.Create; //RaiseAssertionFailed(Result);\nend;\n\nfunction TBaseCachedFileStream.Seek(const Offset: Int64; Origin: TSeekOrigin): Int64;\n//Set FPosition to the value specified - if this has implications for the\n//cache then overriden Write and Read methods must deal with those.\nbegin\n  case Origin of\n  soBeginning:\n    FPosition := Offset;\n  soEnd:\n    FPosition := GetFileSize+Offset;\n  soCurrent:\n    inc(FPosition, Offset);\n  else\n    Assert(False); //RaiseAssertionFailed;\n  end;\n  Result := FPosition;\nend;\n\n{ TReadOnlyCachedFileStream }\n\nconstructor TReadOnlyCachedFileStream.Create(const FileName: string; CacheSize: Integer; Handle: THandle);\nbegin\n  inherited;\n  SetViewWindow(0, inherited GetFileSize);\nend;\n\nfunction TReadOnlyCachedFileStream.CreateHandle(FlagsAndAttributes: DWORD): THandle;\nbegin\n  Result := Windows.CreateFile(\n    PChar(FFileName),\n    GENERIC_READ,\n    FILE_SHARE_READ,\n    nil,\n    OPEN_EXISTING,\n    FlagsAndAttributes,\n    0\n  );\n  if Result=INVALID_HANDLE_VALUE then begin\n    RaiseSystemErrorFmt('Cannot open %s.', [FFileName]);\n  end;\nend;\n\nprocedure TReadOnlyCachedFileStream.DisableStreamReadCache;\nbegin\n  inc(FDisableStreamReadCacheRefCount);\nend;\n\nprocedure TReadOnlyCachedFileStream.EnableStreamReadCache;\nbegin\n  dec(FDisableStreamReadCacheRefCount);\nend;\n\nprocedure TReadOnlyCachedFileStream.FlushCache;\nbegin\n  FCacheStart := 0;\n  FCacheEnd := 0;\nend;\n\nfunction TReadOnlyCachedFileStream.GetFileSize: Int64;\nbegin\n  Result := FViewLength;\nend;\n\nprocedure TReadOnlyCachedFileStream.SetViewWindow(const ViewStart, ViewLength: Int64);\nbegin\n  if ViewStart&lt;0 then begin\n    Assert(False); //raise EAssertionFailed.Create(); //RaiseAssertionFailed;\n  end;\n  if (ViewStart+ViewLength)&gt;inherited GetFileSize then begin\n    Assert(False); //raise EAssertionFailed.Create(); //RaiseAssertionFailed;\n  end;\n  FViewStart := ViewStart;\n  FViewLength := ViewLength;\n  FPosition := 0;\n  FCacheStart := 0;\n  FCacheEnd := 0;\nend;\n\nfunction TReadOnlyCachedFileStream.Read(var Buffer; Count: Longint): Longint;\nvar\n  NumOfBytesToCopy, NumOfBytesLeft, NumOfBytesRead: Longint;\n  CachePtr, BufferPtr: PByte;\nbegin\n  if FDisableStreamReadCacheRefCount&gt;0 then begin\n    FileSeek(FPosition+FViewStart, soBeginning);\n    Result := FileRead(Buffer, Count);\n    if Result=-1 then begin\n      Result := 0;//contract is to return number of bytes that were read\n    end;\n    inc(FPosition, Result);\n  end else begin\n    Result := 0;\n    NumOfBytesLeft := Count;\n    BufferPtr := @Buffer;\n    while NumOfBytesLeft&gt;0 do begin\n      if (FPosition&lt;FCacheStart) or (FPosition&gt;=FCacheEnd) then begin\n        //the current position is not available in the cache so we need to re-fill the cache\n        FCacheStart := FPosition;\n        if UseAlignedCache then begin\n          FCacheStart := FCacheStart - (FCacheStart mod CacheSize);\n        end;\n        FileSeek(FCacheStart+FViewStart, soBeginning);\n        NumOfBytesRead := FileRead(FCache^, CacheSize);\n        if NumOfBytesRead=-1 then begin\n          exit;\n        end;\n        Assert(NumOfBytesRead&gt;=0);\n        FCacheEnd := FCacheStart+NumOfBytesRead;\n        if NumOfBytesRead=0 then begin\n          FLastError := ERROR_HANDLE_EOF;//must be at the end of the file\n          break;\n        end;\n      end;\n\n      //read from cache to Buffer\n      NumOfBytesToCopy := Min(FCacheEnd-FPosition, NumOfBytesLeft);\n      CachePtr := FCache;\n      inc(CachePtr, FPosition-FCacheStart);\n      Move(CachePtr^, BufferPtr^, NumOfBytesToCopy);\n      inc(Result, NumOfBytesToCopy);\n      inc(FPosition, NumOfBytesToCopy);\n      inc(BufferPtr, NumOfBytesToCopy);\n      dec(NumOfBytesLeft, NumOfBytesToCopy);\n    end;\n  end;\nend;\n\n{ TWriteCachedFileStream }\n\nconstructor TWriteCachedFileStream.Create(const FileName: string; CacheSize, ReadStreamCacheSize: Integer; ReadStreamUseAlignedCache: Boolean);\nbegin\n  inherited Create(FileName, CacheSize);\n  FReadStreamCacheSize := ReadStreamCacheSize;\n  FReadStreamUseAlignedCache := ReadStreamUseAlignedCache;\nend;\n\ndestructor TWriteCachedFileStream.Destroy;\nbegin\n  FlushCache;//make sure that the final calls to Write get recorded in the file\n  FreeAndNil(FReadStream);\n  inherited;\nend;\n\nfunction TWriteCachedFileStream.CreateHandle(FlagsAndAttributes: DWORD): THandle;\nbegin\n  Result := Windows.CreateFile(\n    PChar(FFileName),\n    GENERIC_READ or GENERIC_WRITE,\n    0,\n    nil,\n    CREATE_ALWAYS,\n    FlagsAndAttributes,\n    0\n  );\n  if Result=INVALID_HANDLE_VALUE then begin\n    RaiseSystemErrorFmt('Cannot create %s.', [FFileName]);\n  end;\nend;\n\nprocedure TWriteCachedFileStream.DisableStreamReadCache;\nbegin\n  CreateReadStream;\n  FReadStream.DisableStreamReadCache;\nend;\n\nprocedure TWriteCachedFileStream.EnableStreamReadCache;\nbegin\n  Assert(Assigned(FReadStream));\n  FReadStream.EnableStreamReadCache;\nend;\n\nfunction TWriteCachedFileStream.GetFileSize: Int64;\nbegin\n  Result := FFileSize;\nend;\n\nprocedure TWriteCachedFileStream.CreateReadStream;\nbegin\n  if not Assigned(FReadStream) then begin\n    FReadStream := TReadOnlyCachedFileStream.Create(FFileName, FReadStreamCacheSize, FHandle);\n    FReadStream.UseAlignedCache := FReadStreamUseAlignedCache;\n  end;\nend;\n\nprocedure TWriteCachedFileStream.FlushCache;\nvar\n  NumOfBytesToWrite: Longint;\nbegin\n  if Assigned(FCache) then begin\n    NumOfBytesToWrite := FCacheEnd-FCacheStart;\n    if NumOfBytesToWrite&gt;0 then begin\n      FileSeek(FCacheStart, soBeginning);\n      if FileWrite(FCache^, NumOfBytesToWrite)&lt;&gt;NumOfBytesToWrite then begin\n        RaiseSystemErrorFmt('FileWrite failed for %s.', [FFileName]);\n      end;\n      if Assigned(FReadStream) then begin\n        FReadStream.FlushCache;\n      end;\n    end;\n    FCacheStart := FPosition;\n    FCacheEnd := FPosition;\n  end;\nend;\n\nfunction TWriteCachedFileStream.Read(var Buffer; Count: Integer): Longint;\nbegin\n  FlushCache;\n  CreateReadStream;\n  Assert(FReadStream.FViewStart=0);\n  if FReadStream.FViewLength&lt;&gt;FFileSize then begin\n    FReadStream.SetViewWindow(0, FFileSize);\n  end;\n  FReadStream.Position := FPosition;\n  Result := FReadStream.Read(Buffer, Count);\n  inc(FPosition, Result);\nend;\n\nfunction TWriteCachedFileStream.Write(const Buffer; Count: Longint): Longint;\nvar\n  NumOfBytesToCopy, NumOfBytesLeft: Longint;\n  CachePtr, BufferPtr: PByte;\nbegin\n  Result := 0;\n  NumOfBytesLeft := Count;\n  BufferPtr := @Buffer;\n  while NumOfBytesLeft&gt;0 do begin\n    if ((FPosition&lt;FCacheStart) or (FPosition&gt;FCacheEnd))//the current position is outside the cache\n    or (FPosition-FCacheStart=FCacheSize)//the cache is full\n    then begin\n      FlushCache;\n      Assert(FCacheStart=FPosition);\n    end;\n\n    //write from Buffer to the cache\n    NumOfBytesToCopy := Min(FCacheSize-(FPosition-FCacheStart), NumOfBytesLeft);\n    CachePtr := FCache;\n    inc(CachePtr, FPosition-FCacheStart);\n    Move(BufferPtr^, CachePtr^, NumOfBytesToCopy);\n    inc(Result, NumOfBytesToCopy);\n    inc(FPosition, NumOfBytesToCopy);\n    FCacheEnd := Max(FCacheEnd, FPosition);\n    inc(BufferPtr, NumOfBytesToCopy);\n    dec(NumOfBytesLeft, NumOfBytesToCopy);\n  end;\n  FFileSize := Max(FFileSize, FPosition);\nend;\nend.\n</code></pre>\n"},{"tags":["delphi","datasnap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":196,"score":1,"question_id":12351657,"title":"Delphi (DataSnap) Slow","body":"<p>I have recently started using DataSnap in Delphi to produce what will be a RESTful web service. After following guides by the man himself Marco Cantu and several others on the internet I have successfully got the whole 'chain' working.</p>\n\n<p>But there is a small issue of speed; the client can now send a stream (along with it's size) to the server (which, because of the bug here <a href=\"http://stackoverflow.com/questions/12097470/datasnap-xe2-and-tstream-method-parameters/12099038#12099038\">DataSnap XE2 and TStream method parameters</a>, is read upto the sent size), and the server will reassemble it into a file and save it on disk.</p>\n\n<p>But foir a 3.66MiB file, this takes over 50 seconds!</p>\n\n<p>Should this be the case? On the server I have:</p>\n\n<pre><code>try\n   F := TFileStream.Create('written.dat', fmCreate);\n   F.Position := 0;\n   F.CopyFrom(Data, DataSize);\nfinally \n   F.Free; \n</code></pre>\n\n<p>And on the client end:</p>\n\n<pre><code>var\n  Server: TServerMethods1Client;\n  DBStream: TFileStream;\nbegin\n  Server := TServerMethods1Client.Create(SQLConnection1.DBXConnection);\n  try\n    DBStream := TFileStream.Create('DataSnapServer.exe', fmOpenRead);\n    DBStream.Position := 0;\n    Showmessage(IntToStr(Server.SendData(DBStream, DBStream.Size)));\n  finally\n    Server.Free;\n</code></pre>\n\n<p>Any help appreciated!</p>\n\n<p>Cheers,\nAdrian</p>\n"},{"tags":["multithreading","delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":114,"score":4,"question_id":12575590,"title":"Why Terminated property of thread is set?","body":"<p>I have multithread application. </p>\n\n<pre><code>procedure TGridUpdater.Execute;\nbegin\n  inherited;\n  CodeSite.Send('Thread executed');\n  sp := ConnectionFactory.GetConnection.LoadStoredProc('rab_itemData');\n  sp.CreateParam('Tahun', ftInteger, sppdInput).Value := _form.tahun;\n  sp.Open;\n  Synchronize(DoProgress1);\n  sp.DataSet.First;\n  I := 0;\n  CodeSite.Send('Terminated value is ' + BoolToStr(Terminated)); //The terminated property is 'True' here. Why?\n\n  while (not Terminated) and (not sp.DataSet.Eof) do\n  begin\n    CodeSite.Send('Entering loop');\n    Synchronize(DoProgress);\n    I := I + 1;\n    sp.DataSet.Next;\n  end;\n  Synchronize(DoProgress2);\n\nend;\n</code></pre>\n\n<p>Method to run thread</p>\n\n<pre><code>procedure TFRABData.RefreshDataset;\nvar\n  GridUpdater: TGridUpdater;\nbegin\n  GridUpdater := TGridUpdater.Create(True);\n  GridUpdater.OwnerForm := Self;\n  GridUpdater.Start;\n  CodeSite.Send('RefreshDataset executed');\n  GridUpdater.Free;\nend;\n</code></pre>\n"},{"tags":["iphone","ios","delphi","gestures","firemonkey"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":1025,"score":5,"question_id":7884150,"title":"How can I use gestures on iPhone apps using Delphi Firemonkey?","body":"<p>I am trying to write an iPhone app using Delphi XE2 / FireMonkey and have got past many of the initial hurdles, but am now stuck on gesture handling.</p>\n\n<p>I have created a test app with a TVertScrollBox, but I cannot scroll the contents, unless I enable the scroll bars (which are <em>very</em> thin), and touch those.  This is not very iPhone friendly (and almost unusable).  Would appreciate a pointer in the right direction.</p>\n\n<p>Documentation seems to suggest using UIGestureRecognizer...</p>\n\n<p><a href=\"http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html\">http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html</a></p>\n\n<p>...however these need to be attached to a View, whereas the app is using a FireMonkey form.</p>\n\n<p>Any thoughts would be appreciated.</p>\n"},{"tags":["delphi","encryption","cryptography","delphi-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":12573582,"title":"Key derivation function in Delphi 2010","body":"<p>Anyone knows how to generate key from a plain-text password? I mean a secure Key derivation function with salt.</p>\n\n<p>ie.</p>\n\n<pre><code>function KeyDerivationProc(APassword : String) : String;\nbegin\n     // ...\nend;\n</code></pre>\n\n<p>I'm using Delphi (2010). I thought about DCPcrypt2 and OpenPGPBlackbox, but I'm really lost here.</p>\n\n<p><strong>Any help</strong> would be greatly appreciated, thanks!</p>\n"},{"tags":["delphi","vcl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":149,"score":0,"question_id":12550934,"title":"How to modify TCustomEdit so that all descendants inherit the changes?","body":"<p>After reading <a href=\"http://stackoverflow.com/questions/9941787/is-it-possible-to-determine-if-the-text-in-a-dbedit-is-longer-than-what-is-visib\">this question</a>, I was wondering if it is possible to modify <code>TCustomEdit</code> to check for the text width in a way that all of its descendants inherit the changes too?</p>\n"},{"tags":["c#","delphi","delphi-xe2","com-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":219,"score":2,"question_id":12253360,"title":"C# COM => pointer => delphi interface","body":"<p>Couple of days I cant make solution to solve my problem. I have interface and class in C# which visible as COM server. And I have Delphi application where I need to access this interface. But in my case I need in C# side to return 32 bit pointer to interface and at Delphi side - to convert pointer to interface. What is done?\nc# side. All attributes written well, source code is cutted because original class is much bigger, but idea is understandable:</p>\n\n<pre><code>[ComVisible(true)]\n[CLSCompliant(true)]\n[Guid(\"C1A57BD0-AAA2-4AB8-BA2F-ADFA04275AD5\")]\n[ClassInterface(ClassInterfaceType.None),\n ComSourceInterfaces(typeof(IProcPreviewEndArgs))]\npublic class ProcPreviewEndArgs : IProcPreviewEndArgs\n{\n\n   [ComVisible(true), PreserveSig]\n   public IntPtr CreateNew()\n   {\n       var obj = new ProcPreviewEndArgs();\n       GC.SuppressFinalize(obj);\n       return Marshal.GetComInterfaceForObject(obj, typeof (IProcPreviewEndArgs));\n   }\n}\n</code></pre>\n\n<p>delphi side:</p>\n\n<pre><code>type\n  PIProcPreviewEndArgs = ^IProcPreviewEndArgs;\n\n Index, Res: Integer;\n ppa : IProcPreviewEndArgs;\n pppa : PIProcPreviewEndArgs;\n\n  ppa := CoProcPreviewEndArgs.Create;   // Creates COM object via Delphi services\n  ppa.CreateNew(Res);                   // Creates object of the same type, returns as Ret (Integer)\n  pppa := PIProcPreviewEndArgs(Res);    // Trying to cast Intereger to interface\n  pppa^.CreateNew(Res); // just to test calling posibility\n</code></pre>\n\n<p>On pppa^ (getting instance by pointer) ACCESS VIOLATION exception is thrown. pointer Res is not null. It is about 60 000 000. Basicly it is kernel space area.</p>\n\n<p><strong>UPD</strong></p>\n\n<pre><code>[CLSCompliant(true), ComVisible(true),\n InterfaceType(ComInterfaceType.InterfaceIsIUnknown),\n Guid(\"10572D64-B612-468F-86B3-D12F0B6E3CD2\")]\npublic interface IProcPreviewEndArgs\n{\n    IntPtr CreateNew();\n    IntPtr Get(int aMin, int aMax, uint cMin, uint cMax);\n    void ToAngle(int x, int y, int w, int h, out int nx, out int ny, out int nw, out int nh);\n    IntPtr GetImage();\n}\n</code></pre>\n\n<p>Delphi (generated by Delphi and working well when using standard Delphi methods to manipulate COM objects): </p>\n\n<pre><code> IProcPreviewEndArgs = interface(IUnknown)\n    ['{10572D64-B612-468F-86B3-D12F0B6E3CD2}']\n    function CreateNew(out pRetVal: Integer): HResult; stdcall;\n    function Get(aMin: Integer; aMax: Integer; cMin: LongWord; cMax: LongWord; out pRetVal: Integer): HResult; stdcall;\n    function ToAngle(x: Integer; y: Integer; w: Integer; h: Integer; out nx: Integer; \n                     out ny: Integer; out nw: Integer; out nh: Integer): HResult; stdcall;\n    function GetImage(out pRetVal: Integer): HResult; stdcall;\n  end;\n</code></pre>\n\n<p>Delphi version: <strong>Delphi XE2</strong></p>\n"},{"tags":["delphi","copy","freepascal"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":219,"score":5,"question_id":12542200,"title":"function Copy() in Free Pascal","body":"<p>Delphi allows 3 versions of the <code>Copy</code> function:</p>\n\n<pre><code>function CopyTest(const S: string): string;\nbegin\n  Result:= Copy(S, 1, 5);\n  Result:= Copy(S, 1);\n//  Result:= Copy(S);   //  not allowed for strings, allowed for dyn arrays\nend;\n</code></pre>\n\n<p>FreePascal seems to compile only the 1st (3-arg) version; for the others I have compile-time error</p>\n\n<pre><code>Error: Wrong number of parameters specified for call to \"$fpc_ansistr_copy\"\n</code></pre>\n\n<p>Am I missing some FPC compiler switch or <code>Copy</code> overloads are not available in Free Pascal?</p>\n"},{"tags":["c++","delphi","smtp","indy","smtpclient"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":106,"score":1,"question_id":12465579,"title":"IdSMTP stuck on the Connect method","body":"<p>I am using IdSMTP and creating / destroying the TIdSMTP component dynamically in my form.  Most of the time there are no issues with the smtp.Connect but I found that there are situations where the main UI will get stuck and become unresponsive. </p>\n\n<p>I added the ConnectTimeout and the ReadTimeout properties but still getting the same issue.  The application becomes unresponsive and forces us to kill the process.</p>\n\n<pre><code>  smtp.ConnectTimeout := 10000;\n  smtp.ReadTimeout := 10000;\n  smtp.Connect;\n  if smtp.Connected then\n  begin\n    smtp.Send(Mess);\n    smtp.Disconnect;\n  end\n</code></pre>\n\n<p>I have a OnStatus event bound to stmp that is being raised by idstmp control \nResolving\nConnecting \nConnected </p>\n\n<p>But for some reason the Connect still makes the application free and act unresponsive.</p>\n"},{"tags":["multithreading","delphi","debugging","windbg","critical-section"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":145,"score":4,"question_id":12245951,"title":"\"DebugInfo for CritSec does not point back to the critical section\" when analysing deadlock","body":"<p>I'm using Windbg to analyse a deadlock occurring in an data-snap application server written in delphi. </p>\n\n<p>When I run </p>\n\n<pre><code>!analyze -hang -v\n</code></pre>\n\n<p>I get this</p>\n\n<pre>\n:000:x86> !analyze -hang -v\n*******************************************************************************\n*                                                                             *\n*                        Exception Analysis                                   *\n*                                                                             *\n*******************************************************************************\n\nGetPageUrlData failed, server returned HTTP status 404\nURL requested: http://watson.microsoft.com/00000000.htm?Retriage=1\n\nFAULTING_IP: \n+6ced240\n00000000 ??              ???\n\nEXCEPTION_RECORD:  ffffffffffffffff -- (.exr 0xffffffffffffffff)\nExceptionAddress: 0000000000000000\n   ExceptionCode: 80000003 (Break instruction exception)\n  ExceptionFlags: 00000000\nNumberParameters: 0\n\nFAULTING_THREAD:  0000000000000000\n\nBUGCHECK_STR:  HANG\n\nDEFAULT_BUCKET_ID:  APPLICATION_HANG\n\nPROCESS_NAME:  ********.exe\n\nERROR_CODE: (NTSTATUS) 0xcfffffff - \n\nEXCEPTION_CODE: (NTSTATUS) 0xcfffffff - \n\nMOD_LIST: \n\nNTGLOBALFLAG:  0\n\nAPPLICATION_VERIFIER_FLAGS:  0\n\nDERIVED_WAIT_CHAIN:  \n\nDl Eid Cid     WaitType\n-- --- ------- --------------------------\n   0   c7c.2634 Critical Section       \n\nWAIT_CHAIN_COMMAND:  ~0s;k;;\n\nBLOCKING_THREAD:  0000000000002634\n\nPRIMARY_PROBLEM_CLASS:  APPLICATION_HANG\n\nLAST_CONTROL_TRANSFER:  from 0000000077138df4 to 000000007711f8b1\n\nSTACK_TEXT:  \n0018fc50 77138df4 00000c6c 00000000 00000000 ntdll_77100000!NtWaitForSingleObject+0x15\n0018fcb4 77138cd8 00000000 00000000 03fe0940 ntdll_77100000!RtlpWaitOnCriticalSection+0x13e\n0018fcdc 7369324f 736a3134 00000000 03fe0940 ntdll_77100000!RtlEnterCriticalSection+0x150\nWARNING: Stack unwind information not available. Following frames may be wrong.\n0018fcec 7369af5f 00000388 00000000 003d1e00 mswsock!GetLspGuid+0x19af\n0018fd08 76366958 00000388 0018fd84 0018fd9c mswsock!GetLspGuid+0x96bf\n0018fd38 0018fd58 763668cd 00000388 0018fd84 ws2_32!WSAAccept+0x84\n00000000 00000000 00000000 00000000 00000000 0x18fd58\n\n\nFOLLOWUP_IP: \nmswsock!GetLspGuid+19af\n7369324f 33db            xor     ebx,ebx\n\nSYMBOL_STACK_INDEX:  3\n\nSYMBOL_NAME:  mswsock!GetLspGuid+19af\n\nFOLLOWUP_NAME:  MachineOwner\n\nMODULE_NAME: C:\\Windows\\System32\\mswsock\n\nIMAGE_NAME:  lld\n\nDEBUG_FLR_IMAGE_TIMESTAMP:  4ce7c83d\n\nSTACK_COMMAND:  ~0s ; kb\n\nFAILURE_BUCKET_ID:  APPLICATION_HANG_cfffffff_lld!Unloaded\n\nBUCKET_ID:  X64_HANG_mswsock!GetLspGuid+19af\n\nWATSON_STAGEONE_URL:  http://watson.microsoft.com/00000000.htm?Retriage=1\n\nFollowup: MachineOwner\n---------\n</pre>\n\n<p>I then did </p>\n\n<pre><code>!locks -V\n</code></pre>\n\n<p>to see which lock it was waiting on and to my surprise it returned this,</p>\n\n<pre>\n0:000:x86> !locks -V\n\nCritSec ntdll!RtlCriticalSectionLock+0 at 0000000077057060\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nCritSec ntdll!LdrpLoaderLock+0 at 0000000077057490\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nCritSec ntdll!RtlpDynamicFunctionTableLock+0 at 0000000077057468\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nCritSec ntdll!FastPebLock+0 at 000000007705a900\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nCritSec ntdll!RtlpProcessHeapsListLock+0 at 000000007705a240\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nCritSec +270208 at 0000000000270208\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    1\n\nCritSec ntdll!EtwProvCritSect+0 at 000000007705a120\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nCritSec ntdll!EtwPrivSessionCritSect+0 at 000000007705a1e0\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nCritSec +10208 at 0000000000010208\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nCritSec +276f40 at 0000000000276f40\nLockCount          NOT LOCKED\nRecursionCount     0\nOwningThread       0\nEntryCount         0\nContentionCount    0\n\nScanned 10 critical sections\n</pre>\n\n<p>From looking at the call stack </p>\n\n<pre>\nSTACK_TEXT:  \n0018fc50 77138df4 00000c6c 00000000 00000000 ntdll_77100000!NtWaitForSingleObject+0x15\n0018fcb4 77138cd8 00000000 00000000 03fe0940 ntdll_77100000!RtlpWaitOnCriticalSection+0x13e\n0018fcdc 7369324f 736a3134 00000000 03fe0940 ntdll_77100000!RtlEnterCriticalSection+0x150\nWARNING: Stack unwind information not available. Following frames may be wrong.\n0018fcec 7369af5f 00000388 00000000 003d1e00 mswsock!GetLspGuid+0x19af\n0018fd08 76366958 00000388 0018fd84 0018fd9c mswsock!GetLspGuid+0x96bf\n0018fd38 0018fd58 763668cd 00000388 0018fd84 ws2_32!WSAAccept+0x84\n00000000 00000000 00000000 00000000 00000000 0x18fd58\n</pre>\n\n<p>I determined it was waiting on a critical section at address 0x736a3134 (First parameter passed to RtlEnterCriticalSection) so I ran this</p>\n\n<pre><code>!critsec 736a3134\n</code></pre>\n\n<p>That gave me this output</p>\n\n<pre>\n0:000:x86> !critsec 736a3134\n\nDebugInfo for CritSec at 00000000736a3134 does not point back to the critical section\nNOT an initialized critical section.\n\nCritSec mswsock!WSPStartup+6f64 at 00000000736a3134\nWaiterWoken        Yes\nLockCount          -1\nRecursionCount     11028\nOwningThread       c6c\nEntryCount         1f49dad6\nContentionCount    88000000\n*** Locked\n</pre>\n\n<p>Now the penny dropped, the pointer to the critical section has become corrupted, possibly due to concurrent thread access and lack of synchronisation elsewhere in the code </p>\n\n<p>My question is how do I track down where this is or find out if it is another problem? </p>\n\n<p>PS: this bug only appears when the application is under heavy load with maybe 700 clients connected </p>\n\n<p>(it is using one thread per connection and I know 32bit applications will be limited to aprox 2000 threads at the default thread stack size and this is not the best approach)</p>\n\n<p>PPS: I have multiple crash dumps where the application is hung waiting on different critical sections, in each case the pointer for the critical section appears not to point to a critical section.</p>\n"},{"tags":["delphi","delphi-7","tclientdataset"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":158,"score":1,"question_id":12563781,"title":"Delphi 7 TClientDataSet aggregates don't work if sorting by a different index","body":"<p>I got a ClientDataset that has three aggregate fields. The aggregates calculate, amongst others, the total ordered amount per customer, so they use an index on the customer ID.</p>\n\n<p>I use this ClientDataset for a report (FastReports), which displays all customers and their orders, grouped per customer and sorted by order date. </p>\n\n<p>Therefore, I have two indexes on the ClientDataSet, one on CustomerId (for the grouping and aggregate fields), and one on CustomerId+OrderDate (for the sorting).</p>\n\n<p>Now, when I choose the sorting index for the client dataset, the aggregates don't work anymore and return empty values in my report. They only work if I choose the grouping index for the ClientDataset itself, even though each individual aggregate already uses the right index.</p>\n\n<p>I'd very much like this to work, because I will either have to write a lot of extra code, or adjust my report (I want to display the totals on top of each group, so the FR SUM expression won't work well either).</p>\n"},{"tags":["delphi","firemonkey","synedit"],"answer_count":1,"favorite_count":3,"up_vote_count":33,"down_vote_count":0,"view_count":794,"score":33,"question_id":9102818,"title":"SynEdit for Firemonkey?","body":"<p>Is there a synedit package that works with firemonkey (or someone working on it) ?</p>\n\n<p>From what I can gather there was a VGScene port earlier (see: <a href=\"https://forums.embarcadero.com/thread.jspa?threadID=58470\">this site</a>), but it seems to been removed.</p>\n\n<p>Also see <a href=\"http://ksdev.blogspot.com/2010/08/synedit-for-vgscene.html\">this site</a>: </p>\n"},{"tags":["delphi","login","user","administrator","non-english"],"answer_count":5,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":856,"score":7,"question_id":4019286,"title":"Checking for Administrator user login in non-English installations of windows","body":"<p>I have some small questions...I have a program that stores a list of users in a database and compares on program startup if the user is in the list or is an administrator before letting them use it. At the moment, the way I'm using to check if the user is an administrator is simply by comparing the username to a string constant called 'ADMINISTRATOR'. Will this work on a non-Engish system? I.E. does Windows use a language specific version of 'administrator'?  Or maybe is there an enumerated version of the Admin user that I can use to check with instead of my 'ADMINISTRATOR' string? (you know, just like how Windows folders are enumerated). I'm using Delphi 2009 by the way. Thanks in advance!</p>\n"},{"tags":["delphi","delphi-xe2"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":180,"score":3,"question_id":12554094,"title":"How to let the cursor go to the end of the string, when adding chars via button clicks using keypad","body":"<p>Im building a form that will function like a keypad on a touch screen. The problem Im having at the moment is that when I person presses a button for example the '1' button, it must add that char '1' to an edit box, which displays the keys already pressed. Now the problem Im experiencing is that once a person presses a key, I can add the char to the string already displayed in the edit box, but the cursor goes to  the front of the edit box, and does not appear at the back. I use the following code to add a char to the edit box:</p>\n\n<pre><code>edtPassword.text := edtPassword.text + key;\n</code></pre>\n\n<p>Now that just adds the char to the end of the edit box, but how do I move the cursor to the end of the edit box.</p>\n\n<p>Plus I do also have a backspace button, what code would I use the erase the last char of the string in the edit box if you clicked it?</p>\n\n<p>Im using Delphi XE2</p>\n"},{"tags":["delphi","intraweb","delphi-xe3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":127,"score":2,"question_id":12478576,"title":"Why does WebApplication.SendFile fail with \"Reply type already set\"?","body":"<p>Steps:</p>\n\n<ol>\n<li>I created a new IntraWeb application using the <code>IntraWeb Application Wizard</code>.</li>\n<li>I put a TIWButton on the form.</li>\n<li>I put this code in to the OnClick event handler:</li>\n</ol>\n\n<p><code>WebApplication.SendFile('D:\\Temp\\ClearAll.sql');</code></p>\n\n<p>Clicking on the button raises an exception of type <code>Exception</code> with the message <code>Reply type already set</code>.</p>\n\n<p>Any ideas what's going wrong?</p>\n\n<p>Delphi is XE3 with IntraWeb XIV.</p>\n\n<p>I tried the same with Deplhi 2007 (IntraWeb 9) and it works, so this seems to be a bug in IntraWeb XIV.</p>\n\n<p>Can sombody please confirm this?</p>\n"},{"tags":["delphi","devexpress","tcxgrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":12563341,"title":"Outlook-like search in cxGrid","body":"<p>Is there anyone who know if it is possible to have a <a href=\"http://www.devexpress.com/Products/VCL/ExQuantumGrid/Index.xml\" rel=\"nofollow\">cxGrid</a> have a searchbar like in Outlook contacts where you just press one letter and the first contact with that letter in lastname is shown?</p>\n\n<p>I would love to see an example of this, but so far my search everywhere has been without result.</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1076,"score":0,"question_id":3075320,"title":"RLINK32: Error opening file \"...\\Data.DFM\". Occurs the first time I build a project after opening Delphi","body":"<p>I get this error the first time I build/compile a particular project after opening Delphi (D6 Pro). Subsequent builds do not give the error. </p>\n"},{"tags":["delphi","components","c++builder"],"answer_count":4,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":4724,"score":6,"question_id":402455,"title":"HTML Editor for CBuilder/Delphi","body":"<p>I need to find basic WYSIWYG HTML editor component for C++Builder 5 to let users to create some simple text that I will paste into existing HTML page template.\nJust a simple support to create links, add images, use headers/bold/italic.</p>\n"},{"tags":["delphi","dbgrid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":12458412,"title":"Editable DBGrid?","body":"<p>I am a beginner in Delphi and I need help with the following problem. I have to implement an editable DBGrid on my form. The DBGrid displays results from a query joining 3 tables. I managed to make the DBGrid editable but the edits have no effect on the database. I can insert, edit or delete rows in the DBGrid but these changes do not get saved to the database. I have the following settings:</p>\n\n<pre><code>Query2.DatabaseName=Test\nQuery2.SQL=SELECT cd.hourstart, cd.hourfinish, o.objname, cd.\"work\", cd.worktime  \n           FROM Card c JOIN CardDetail cd ON c.N=cd.card  \n           JOIN objects o ON cd.project=o.N  \n           WHERE c.worker=5 AND c.data=CONVERT(DATE, GETDATE())\nQuery2.UpdateObject=UpdateSQL2  \nQuery2.CachedUpdates=True  \nQuery2.RequestLive=True\n\nUpdateSQL2.DeleteSQL=delete from CardDetail  \n                     where hourstart = :OLD_houerstart and  \n                     hourfinish = :OLD_houerfinish and  \n                     work = :OLD_work and  \n                     worktime = :OLD_worktime\nUpdateSQL2.InsertSQL=...  \nUpdateSQL2.ModifySQL=...  \n\nDataSource2.DataSet=Query2  \nDBGrid2.DataSource=DataSource2 \n</code></pre>\n\n<p>I am probably missing something but I don't know what. Any help would be appreciated!</p>\n"},{"tags":["windows","delphi","stackoverflow"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":273,"score":4,"question_id":12558014,"title":"I don't understand stack overflow with repeated DispatchMessageW in the call stack","body":"<p>This is a Delphi application, but I suppose it is a general Windows programming question.</p>\n\n<p>I left my application running (in the Delphi IDE)over the weekend and have just come back to find a Stack Overflow.</p>\n\n<p>The stack starts like this ...  </p>\n\n<pre><code>:75c4417e kernel32.GetDriveTypeW + 0x23\n:75c452ae kernel32.IsProcessorFeaturePresent + 0xa9\n:75c45272 kernel32.IsProcessorFeaturePresent + 0x6d\n:75c45248 kernel32.IsProcessorFeaturePresent + 0x43\n:7678410b KERNELBASE.LoadStringBaseExW + 0xc7\n:76678ed2 USER32.LoadStringW + 0x19\n:0040c4ae LoadResString + $4A\nuADStanDef.TADDefinition.Create(nil)\nuADStanDef.TADDefinition.CreateTemporary\nuADStanDef.TADConnectionDefTemporaryFactory.CreateObject\nuADStanFactory.TADManager.CreateInterface((1050358107, 62550, 16757, (168, 100, 178, 87, 60, 74, 32, 21)),(no value),True)\nuADStanFactory.ADCreateInterface((1050358107, 62550, 16757, (168, 100, 178, 87, 60, 74, 32, 21)),(no value),True)\nuADCompClient.TADCustomConnection.Create($2DB7EB0)\nfMainForm.TMainForm.ServerAliveTimerTimer($2E8DE38)    &lt;========== my code\n:004f1546 Winapi + $4F1546\n:00461316 Winapi + $461316\n:766762fa ; C:\\Windows\\syswow64\\USER32.dll\n:76676d3a USER32.GetThreadDesktop + 0xd7\n:766777c4 ; C:\\Windows\\syswow64\\USER32.dll\n:7667788a USER32.DispatchMessageW + 0xf\n</code></pre>\n\n<p>So, a timer is expiring, I am creating a new object (of an AnyDac component) and the stack overflows. The code definitely frees the object. I have appended it below for those who want to check, but I don't think that that is my question.</p>\n\n<p>The stack then continues  </p>\n\n<pre><code>:7669cdfd ; C:\\Windows\\syswow64\\USER32.dll\n:7669cf5c ; C:\\Windows\\syswow64\\USER32.dll\n:766cf73c ; C:\\Windows\\syswow64\\USER32.dll\n:766cfa18 ; C:\\Windows\\syswow64\\USER32.dll\n:766cfb1f USER32.MessageBoxTimeoutW + 0x52\n:766cfd15 USER32.MessageBoxExW + 0x1b\n:766cfd57 USER32.MessageBoxW + 0x18\n:00549986 Vcl + $549986\n:00549aa2 Vcl + $549AA2\n:00549873 Vcl + $549873\n:00461316 Winapi + $461316\n:766762fa ; C:\\Windows\\syswow64\\USER32.dll\n:76676d3a USER32.GetThreadDesktop + 0xd7\n:766777c4 ; C:\\Windows\\syswow64\\USER32.dll\n:7667788a USER32.DispatchMessageW + 0xf\n</code></pre>\n\n<p>with that block repeated for three thoussand line(!) and I have no idea what it is or what it is doing.  It then ends  </p>\n\n<pre><code>StoreRoom.StoreRoom\n:75c4339a kernel32.BaseThreadInitThunk + 0x12\n:77eb9ef2 ntdll.RtlInitializeExceptionChain + 0x63\n:77eb9ec5 ntdll.RtlInitializeExceptionChain + 0x36\n</code></pre>\n\n<p>I do no tunderstand all of that repeated stack - can anyone advise?</p>\n\n<p>(And for the astutute of you who notice that my exception handling is showing a dialog, that is a TForm which closes when the user clicks OK)</p>\n\n<p>My code :</p>\n\n<pre><code>procedure TMainForm.ServerAliveTimerTimer(Sender: TObject);\nbegin\n   try\n      ADConnection := TADConnection.Create(Self);  &lt;======= stack overflow here\n      ADConnection.DriverName := 'mysql';\n      ADConnection.Params.Add('Server=' + MAIN_STOREROOM_IP_ADDRESS);  \n      // other params, such as password, removed for posting\n      ADConnection.Connected := True;\n\n   except\n      on E : Exception do\n      begin\n         ADConnection.Free();\n         theDialogForm := TDialogFormForm.Create(Nil);\n         theDialogForm.ShowTheForm('Database problem'+#13+#10+''+#13+#10+\n                                   E.ClassName+#13+#10+E.Message);    \n         StopTheApplication();   &lt;===== just calls ExitProcess(0);\n         Exit;                     as I had problems with Halt elsewhere in the code\n      end;\n   end;\n\n   if isMainStoreRoom then\n   begin\n      CheckIfStoreRoomIsAlive(SECONDARY_STOREROOM_IP_ADDRESS);\n   end\n   else\n   begin\n      CheckIfStoreRoomIsAlive(MAIN_STOREROOM_IP_ADDRESS);\n   end;\n\n   try    // Now, update our own timestamp\n      timestamp  := GetCurrentUnixTimeStamp();\n      ADConnection.ExecSQL('UPDATE server_status SET alive_timestamp=\"' + IntToStr(timestamp) + '\" WHERE ip_address=\"' + ipAddress + '\"');\n\n   except\n      on E : Exception do\n      begin\n         ADConnection.Free();\n         Exit;\n      end;\n   end;\n\n   ADConnection.Free();\nend;     // ServerAliveTimerTimer()\n</code></pre>\n"},{"tags":["delphi","indy","indy10"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":148,"score":0,"question_id":12541983,"title":"Exception on reading broadcast data with TIdUDPServer (Indy 10) using Delphi 7","body":"<p>I'm having problems trying to use OnUDPRead Event of TIdUDPServer to read broadcast Data sent from a IdUDPClient Client I created.  I've tried using the examples shown in the following questions but to no avail.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/3480729/how-can-i-send-a-broadcast-message-in-delphi\">How can I send a broadcast message in Delphi</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/10585088/reading-data-with-tidudpserver\">Reading data with TIdUDPServer</a></p>\n\n<p>I'm able to bind TIdUDPServer to the port I specify:</p>\n\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nbegin\n  IdUDPServer1.BroadcastEnabled := True;\n  IdUDPServer1.DefaultPort := StrToInt(edit2.Text);\n  IdUDPServer1.Bindings.Add.IP := '0.0.0.0';\n  //IdUDPServer1.ThreadedEvent:=True;\n  IdUDPServer1.Active := True;\nend;\n</code></pre>\n\n<p>IdUDPServer1UDPRead is triggered successfully showing that the UDP Server is working, but I get an exception at this line -> DataStringStream.CopyFrom(AData, AData.Size);</p>\n\n<blockquote>\n  <p>Exception:Access violation at address 004BA415 in module\n  'IndyUDPReceiver.exe'. Read of address 74736574</p>\n</blockquote>\n\n<pre><code>procedure TForm1.IdUDPServer1UDPRead(Sender: TObject;\n  AData: TStream; ABinding: TIdSocketHandle);\nvar\n  DataStringStream: TStringStream;\n  msg: string;\nbegin\n  try\n    DataStringStream := TStringStream.Create('');\n    try\n      DataStringStream.CopyFrom(AData, AData.Size);\n      msg := DataStringStream.DataString;\n      Memo1.Lines.Add(msg);\n    finally\n      DataStringStream.Free;\n    end;\n  except\n    on E: Exception do\n    begin\n      Memo1.Lines.Add('Exception:' + E.Message);\n      DataStringStream.Free;\n    end;\n  end;\nend;\n</code></pre>\n\n<p>I've uploaded the full Client and Server to: <a href=\"http://www.2shared.com/file/5SRweGIa/Indy_UDP.html\" rel=\"nofollow\">http://www.2shared.com/file/5SRweGIa/Indy_UDP.html</a></p>\n\n<p>Grateful for any pointers. :)</p>\n"},{"tags":["delphi","winapi"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":150,"score":3,"question_id":12532370,"title":"Folder icon change doesn't take effect","body":"<p>I change the default system folder icon via registry key</p>\n\n<pre><code>Reg := TRegistry.Create; \ntry \n  Reg.RootKey := HKEY_LOCAL_MACHINE;\n  Reg.OpenKey('Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons', True);\n  Reg.WriteString('3', 'C:\\MyIcon.icl,0');\nfinally\n  RegFile.Free;\nend;\n</code></pre>\n\n<p>I can change registry values, but the problem is I need to restart the OS for it to take effect.</p>\n\n<p>To fix it I tried:</p>\n\n<pre><code>SendMessage(HWND_BROADCAST, WM_SETTINGCHANGE, 0, 0);\n</code></pre>\n\n<p>and: </p>\n\n<pre><code>SHChangeNotify(SHCNE_ASSOCCHANGED, SHCNF_IDLIST, nil, nil);\n</code></pre>\n\n<p>It works on WinXP but does not on Win7.</p>\n\n<p>How can i fix it on Win7?</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":163,"score":-2,"question_id":12505572,"title":"Delphi - Two Modal forms","body":"<p>I have a main form (A) that call a modal form (B). and (B) call another modal form (C) and they work normal </p>\n\n<p>the problem when I added new modal form (D) and make it called from (B) then when I close the form (D) the form (B) also closed !! although I made sure the close button modal result = mrnone</p>\n\n<p>please advise</p>\n\n<p>Code:</p>\n\n<pre><code>Form A calling B\n\nB := TB.Create(self);\nB.ShowModal;\n\nForm B Calling C\nC := TC.Create(self);\nC.ShowModal;\n\nForm B Calling D\nD := TD.Create(self);\nD.ShowModal;\n</code></pre>\n\n<p>I use Delphi 2010</p>\n\n<p>More Code added\nthis is how I free the form that cause the problem and make the caller close !</p>\n\n<pre><code>procedure TForm2.FormClose(Sender: TObject; var Action: TCloseAction);\nbegin\n  action := cafree;\nend;\n\nprocedure TForm2.FormDestroy(Sender: TObject);\nbegin\n  Form2 := nil;\nend;\n</code></pre>\n\n<p>This is how I show the modal form </p>\n\n<pre><code>procedure Tmymodalfrm.Button1Click(Sender: TObject);\nbegin\n  form2 := Tform2.Create(self);\n  form2.ShowModal;\nend;\n</code></pre>\n\n<p>And after tracing with the call stack I get the code that originally created form B which is so normal:</p>\n\n<pre><code>   B := TB.Create(self);\n   B.ShowModal; \n</code></pre>\n\n<p>and I am going crazy soon :)</p>\n"},{"tags":["image","delphi","delphi-2009","ribbon","transparent"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":861,"score":7,"question_id":1084260,"title":"Why are my transparent images used in a Delphi 2009 Ribbon not transparent on runtime?","body":"<p>I just played around with the new Delphi 2009 ribbon, added a few pages, groups and actionclients (large buttons) to it. I created some transparent 32x32px PNGs in Photoshop and put them into a TImageList (set to cd32bit). I added this list to the Actionmanager's Images property, to show them on the buttons.\nAt designtime the icons in the ribbon look just fine, but when compiling and starting the app they have a black background.\nAny idea what causes this and how I can fix this? I do not want to create the images with the ribbon color as background, because I cannot switch to another colorset of the ribbon then.</p>\n\n<p>Thanks in advance\nMarc</p>\n"},{"tags":["delphi"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":131,"score":2,"question_id":12554646,"title":"Get pixel coordinates of a word in a Delphi TEdit","body":"<p>Greetings collective wonderfolk of the internet.</p>\n\n<p>I'm trying to underline specific words in a TEdit (actually a TNxEdit from Berg NextSuite - but it's a derivative of TEdit). However in order to do this I need to know the pixel coordinates of said word.</p>\n\n<p>This is fairly easy to do if the start of the text is visible, however I can't work out how to do it if the start of the text has been scrolled off the end.</p>\n\n<p>Is there some way of determining the exact coordinates of a given word directly? Failing that, determining which text is visible in the edit and which isn't? Or some other ingenious method.</p>\n\n<p><b>Edit1:</b> To cover some of the current answers:</p>\n\n<p>The requirements are to implement a spell checker on a column of a TNxGrid component, which limits me to TNxEdit. If I could choose which component I used I would have switched by now :(</p>\n\n<p>I can do the drawing the line. TNxEdit has a canvas that allows me to draw the underline quite happily providing I can work out the correct coordinates.</p>\n\n<p>If the start of the edit text is visible, i.e. there's no scrolling off the front, then I can determine the correct start position and the length of the line using TextExtent.</p>\n\n<p>The issue comes in the scenario where the start of the text has scrolled off the front. Not being able to determine how much is scrolled off the front means I can't work out the starting position for the line. The length of the line becomes a problem if the word I want to highlight is also partially scrolled.</p>\n"},{"tags":["delphi","debugging","memory-leaks","fastmm"],"answer_count":0,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":163,"score":8,"question_id":12539319,"title":"How to obtain the names of custom-made structures whose instances have leaked memory?","body":"<p>I am working a on parser which will go through a FASTMM4 memory leak report and store all relevant data in a custom-made structure/class. I use <a href=\"http://www.lischke-online.de/index.php/controls/virtual-treeview\" rel=\"nofollow\">VirtualTreeView</a> to display each class that has leaked instances  as a node in the tree. <a href=\"http://i.imgur.com/wGVn2.png\" rel=\"nofollow\">The tree</a> -\nNotice that the FIRST node says unknown. This is because FASTMM calls a method <em>AClass</em> to determine weather it is a class or not. When it finds custom structures, it marks them as unknown, which doesn't make my report analyzer very effective since most memory leaks come from these custom structures and records. </p>\n\n<p>Question: Is there a way to use DebugInfo or some other tool like <a href=\"http://jvcl.delphi-jedi.org/\" rel=\"nofollow\">JVCL</a> to gather those debug symbols and compare their memory addresses to the ones found in the memory-leak-report-file? I would like my tree to stop showing UNKNOWN and show the names of these custom structures.\nI am new to Delphi programming, and even newer to tackling memory leaks, so any help would mean much!</p>\n"},{"tags":["delphi","sql-server-2005","stored-procedures","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":462,"score":1,"question_id":3227880,"title":"Everytime I try to communicate with my database with stored procedures I get this \"Cannot perform this operation on a closed dataset\"","body":"<p>I'm working on a Delphi project with a MS SQL Server database, I connected the database with ADOConnection, DataSource and ADOProc components from Borland Delphi 7 and I added this code in behind:</p>\n\n<pre><code>procedure TForm1.Button2Click(Sender: TObject);\nbegin\n  ADOStoredProc1.ProcedureName := 'sp_Delete_Clen';\n  ADOStoredProc1.Refresh;\n  ADOStoredProc1.Parameters.ParamByName('@clenID').Value := Edit6.Text;\n  ADOStoredProc1.Active := True;\n  ADOStoredProc1.ExecProc;\nend;\n</code></pre>\n\n<p>The component Edit6 is an editbox that takes the ID of the tuple that should be deleted from the database and ADOStoredProc1 is the stored procedure in the database that takes 1 parametar (the ID you want to delete).\nThe project runs with no problems, I even got a TADOTable and a DBGrid that load the information from the database, but when I try to delete a tuple from the database using its ID written in the EditBox I get this Error: \"Cannot perform this operation on a closed dataset\" and the breakpoint of the project is when the application tries to add the value for the 'clenID' parameter.\nWhere is my mistake and how to fix it?</p>\n"},{"tags":["java","delphi","delphi-xe2"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":176,"score":-4,"question_id":11817169,"title":"How to check is Java is installed on Windows?","body":"<p>How to check, is Java is installed on Windows systems ?</p>\n"},{"tags":["delphi","memory-leaks","delphi-xe2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":116,"score":2,"question_id":12550887,"title":"How can I register an expected memory leak for an Interface object","body":"<p>Is it possible to register an Interface with the <code>RegisterExpectedMemoryLeak</code> procedure?</p>\n\n<p>I have a private field declared as:</p>\n\n<pre><code>FDragDropTarget: IDropTarget;\n</code></pre>\n\n<p>I then create an instance of this and attempt to Register a known memory leak for this object:</p>\n\n<pre><code>  FDragDropTarget := TDropTarget.Create(lcMain.Handle, FDragDrop);\n  RegisterExpectedMemoryLeak(FDragDropTarget);\n</code></pre>\n\n<p>However I get a compiler error stating that there is Incompatible types: 'Pointer' and 'IDropTarget'.  To me, my interface instance is a pointer anyway?</p>\n\n<p>So can I do this?  It's being reported via the ReportMemoryLeaksOnShutdown := True statement I have in my .dpr file.</p>\n\n<pre><code>begin\n  ReportMemoryLeaksOnShutdown := True;\n  Application.Initialize;\n  Application.MainFormOnTaskbar := True;\n  Application.CreateForm(TForm2, Form2);\n  Application.Run;\nend.\n</code></pre>\n\n<p>TDropTarget is my implementation of the IDropTarget interface:</p>\n\n<pre><code>  TDropTarget = class(TInterfacedObject, IDropTarget)\n  ...\n  end;\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["database","delphi","driver","dbexpress"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":854,"score":1,"question_id":872419,"title":"Where can I find free open source dbexpress driver for mysql","body":"<p>I need a dbx driver for mysql. It should be free. Open source is appreciated. (delphi 7+ and mysql 5+) </p>\n"},{"tags":["delphi","tcpclient","freeze","winsock2","synapse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":119,"score":0,"question_id":12382905,"title":"Synapse TBlockSocket occasionally freezes","body":"<p>I've createdan application which communicates with external device using TCP/IP as a client. I'm using Synapse library (v40) for communication. Sometimes however communication freezes. I managed to get callstack with JclDebug,showing that despite defined timeout, receiving packets is the problem.</p>\n\n<p>Delphi 2009 is used.</p>\n\n<p>Is there anything I can do to fix this issue? Bug in Synapse?</p>\n\n<pre><code>[77297094] KiFastSystemCallRet \n[006193FE] blcksock.TBlockSocket.InternalCanRead (Line 2741, \"synapse\\blcksock.pas\") \n[0061945C] blcksock.TBlockSocket.CanRead (Line 2764, \"synapse\\blcksock.pas\") \n[006185E5] blcksock.TBlockSocket.RecvPacket (Line 2324, \"synapse\\blcksock.pas\") \n[0061888F] blcksock.TBlockSocket.RecvTerminated (Line 2410, \"synapse\\blcksock.pas\")    \n... my own code..\n</code></pre>\n\n<p><strong>Edit:</strong> The blocking line is:</p>\n\n<pre><code>x := synsock.Select(FSocket + 1, @FDSet, nil, nil, TimeVal);\n</code></pre>\n\n<p>Select -function is from winsock2 API.</p>\n\n<p><strong>Edit2:</strong> TimeVal is set by Synapse code:</p>\n\n<pre><code>var\n  TimeVal: PTimeVal;\n  TimeV: TTimeVal;\n..\n  TimeV.tv_usec := (Timeout mod 1000) * 1000;\n  TimeV.tv_sec := Timeout div 1000;\n  TimeVal := @TimeV;\n  if Timeout = -1 then\n    TimeVal := nil;\n</code></pre>\n\n<p>Original source code is here: <a href=\"http://synalist.svn.sourceforge.net/viewvc/synalist/trunk/blcksock.pas?revision=154&amp;view=markup\" rel=\"nofollow\">http://synalist.svn.sourceforge.net/viewvc/synalist/trunk/blcksock.pas?revision=154&amp;view=markup</a></p>\n\n<p>Timeout used is 1000.</p>\n\n<p><strong>Edit3:</strong> I've two client threads running to communicate with two different hosts. It looks like only other one is hanging. Application has been running now since thursday. Thread #2 hung after 5 hours, but thread #1 is still running.</p>\n"},{"tags":["delphi","error-handling","delphi-7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":12546582,"title":"Incompatible types: 'WideChar' and 'Char' delphi 7","body":"<p>I am getting an error in my delphi code when using shellexecute to call an external progrem</p>\n\n<pre><code>procedure TReceiverMainForm.btnSearchClick(Sender: TObject);\n var\n  args:string;\nbegin\n  mmoResult.Clear;\n//  args := ' /d='  + TIdURI.URLEncode(Trim(sSearch)) + ' /t=ReceiverMainForm /s=30 /m=1'\nargs := ' /q='  + httpencode(Trim(txtSearch.Text)) + ' /t=ReceiverMainForm /s='+Trim(txtS.Text)+' /m='+Trim(txtM.Text);\n  ShellExecute(Handle, 'open', 'YTD.exe', pWideChar(args), nil, SW_SHOWNORMAL);\nend;\n</code></pre>\n\n<p>how do i reslve this error?</p>\n"},{"tags":["delphi","delphi-xe","rtti"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":141,"score":6,"question_id":12547913,"title":"Can \"unused\" classes be made available in Delphi XE","body":"<p>I'm working in Delphi XE, windows 7.</p>\n\n<p>In an application I want to enable different report types for my users to select.\nTo do this, I have 1 base report class and a subclass per report type (xml, csv, ppt, etc).</p>\n\n<pre><code>{Just an illustrating example}\nTBaseReport = class\npublic\n  constructor Create;\n  procedure GenerateReport; virtual; abstract;\n  class function ReportType: string; virtual; abstract;\nend;\n\nT*Report = class(TBaseReport);\n//Etcetera.\n</code></pre>\n\n<p>What I want to do is use Rtti to detect all report classes and list their ReportType.\nAfter that, I want to use Rtti to create an instance of the chosen report class and call GenerateReport. All in all, this is not too difficult to achieve.</p>\n\n<p>However there is a major drawback: I'm never hard coding the use of the descending classes, so the code does not get included in the executable. </p>\n\n<p><em>Is there a decent way to force the linker/compiler to include these classes?</em></p>\n\n<p>A(n ugly) work around would be to simulate usage of the reports in their initialization section, but I'd rather not do that.\nA better solution is to make the base class persistent and to call 'RegisterClass(T*Report);' in the initialization section. It works, but I do not see any other need to make them persistent, so again, I'd rather not do that. On the other hand, maybe this is the only way to do it?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["delphi","delphi-7","delphi-2010"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1038,"score":5,"question_id":9689650,"title":"Delphi unicode porting : Incompatible types: 'Char' and 'AnsiChar' error with Win32 functions like CharToOEM?","body":"<p>I am trying to convert some old delphi 7 code to Delphi 2010  </p>\n\n<pre><code>function AnsiToDOS(S: String): String;\nbegin\n  SetLength(Result, Length(S));\n  if S &lt;&gt; '' then begin\n     CharToOEM(PChar(S), PChar(Result));\n  end;\nend;\n</code></pre>\n\n<p>I get the \"Incompatible types: 'Char' and 'AnsiChar' \" error at the line:</p>\n\n<p>CharToOEM (external User32 function) found in</p>\n\n<p>Windows.pas unit</p>\n\n<p>Can i rewrite this AnsiToDos fuction somehow, or do i need to write my own CharToOEM routine?</p>\n\n<p>thanks</p>\n"},{"tags":["delphi","keyboard","trace","tracing","keystroke"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":89,"score":3,"question_id":12547666,"title":"Keystroke Device Tracing (Delphi)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3060512/how-to-distinguish-multiple-keyboards-in-delphi\">How to distinguish Multiple Keyboards in Delphi?</a>  </p>\n</blockquote>\n\n\n\n<p>If I have two keyboards attached to the same computer, is it possible to trace which keyboard a keystroke came from, and if so, how can i do it in delphi?</p>\n"},{"tags":["delphi","rtti"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":169,"score":1,"question_id":12531178,"title":"Get constant fields from a class using RTTI","body":"<p>Can I enumerate the constants(const) from a class?</p>\n\n<p>I have tried</p>\n\n<pre><code>MyClass = class\nconst\n  c1 = 'c1';\n  c2 = 'c2';\n  c3 = 'c3';\nend;\n\nprocedure GetConst();\nvar\n  ctx: TRttiContext;\n  objType: TRttiType;\n  field: trttifield;\n  s: string;\nbegin\n  ctx := TRttiContext.Create;\n  objType := ctx.GetType(MyClass.ClassInfo);\n  for field in objType.GetDeclaredFields do\n    s:= field.Name;\nend;\n</code></pre>\n\n<p>I would like to get c1, c2, c2. </p>\n\n<p>Is this possible?</p>\n\n<p>edit:\nwhat I want to do is define some keys for some external symbols(for a cad program)</p>\n\n<pre><code>symbol1=class\n    const\n    datafield1='datafield1';\n    datafield2='datafield2';\nend;\nsymbol2=class\n    const\n    datafield21='datafield21abc';\n    datafield22='datafield22abc';\nend\n</code></pre>\n\n<p>I don't like to use fields for this because I prefer not to seperate declareration and initialization.\nI can't use an enum since I can't define the value as a string.</p>\n"},{"tags":["delphi"],"answer_count":1,"favorite_count":7,"up_vote_count":15,"down_vote_count":0,"view_count":296,"score":15,"question_id":12526786,"title":"How does Delphi resolve overloaded functions with integral parameters?","body":"<p>Consider the following program:</p>\n\n<pre><code>program IntegerOverloads;\n{$APPTYPE CONSOLE}\n\nprocedure WordOrCardinal(Value: Word); overload;\nbegin\n  Writeln('Word');\nend;\n\nprocedure WordOrCardinal(Value: Cardinal); overload;\nbegin\n  Writeln('Cardinal');\nend;\n\nprocedure SmallintOrInteger(Value: Smallint); overload;\nbegin\n  Writeln('Smallint');\nend;\n\nprocedure SmallintOrInteger(Value: Integer); overload;\nbegin\n  Writeln('Integer');\nend;\n\nprocedure ShortintOrSmallint(Value: Shortint); overload;\nbegin\n  Writeln('Shortint');\nend;\n\nprocedure ShortintOrSmallint(Value: Smallint); overload;\nbegin\n  Writeln('Smallint');\nend;\n\nprocedure Main;\nvar\n  _integer: Integer;\n  _cardinal: Cardinal;\n  _word: Word;\nbegin\n  WordOrCardinal(_Integer);\n  SmallintOrInteger(_cardinal);\n  ShortintOrSmallint(_word);\nend;\n\nbegin\n  Main;\n  Readln;\nend.\n</code></pre>\n\n<p>The output when compiled by XE2 is:</p>\n\n<pre><code>Cardinal\nInteger\nSmallint\n</code></pre>\n\n<p>The output when compiled by Delphi 6 is:</p>\n\n<pre><code>Word\nSmallint\nShortint\n</code></pre>\n\n<p>The <a href=\"http://docwiki.embarcadero.com/RADStudio/en/Procedures_and_Functions#Overloading_Procedures_and_Functions\" rel=\"nofollow\">documentation</a> states (emphasis mine):</p>\n\n<blockquote>\n  <p>You can pass to an overloaded routine parameters that are not\n  identical in type with those in any of the routine's declarations, but\n  that are assignment-compatible with the parameters in more than one\n  declaration. This happens most frequently when a routine is overloaded\n  with different integer types or different real types - for example:</p>\n\n<pre><code>procedure Store(X: Longint); overload;\nprocedure Store(X: Shortint); overload;\n</code></pre>\n  \n  <p>In these cases, when it is possible to do so without ambiguity, the\n  compiler invokes the routine whose parameters are of the <strong>type with the\n  smallest range that accommodates the actual parameters in the call</strong>.</p>\n</blockquote>\n\n<p>But that does seem to apply here. None of the procedure calls in the example code accept a type that accommodates the actual parameters in the call.</p>\n\n<p>I cannot find any documentation that describes what rule the compiler follows. Can anyone point me to such documentation?</p>\n\n<p>This question was prompted by the following articles:</p>\n\n<ul>\n<li><a href=\"http://www.deltics.co.nz/blog/?p=1233\" rel=\"nofollow\">ReverseBytes()</a></li>\n<li><a href=\"http://stackoverflow.com/questions/1482699/zeroconf-bonjour-code-that-works-in-delphi-7-not-working-in-2009\">ZeroConf/Bonjour Code that works in Delphi 7 not working in 2009</a></li>\n<li><a href=\"http://www.deltics.co.nz/blog/?p=1240\" rel=\"nofollow\">What's in a Word ... ?</a></li>\n</ul>\n\n<hr>\n\n<h3>Update</h3>\n\n<p>Prompted by Ken White's comments, I wrote another program to illustrate some more oddities:</p>\n\n<pre><code>program IntegerOverloadsPart2;\n{$APPTYPE CONSOLE}\n\nprocedure Test(Value: Byte); overload;\nbegin\n  Writeln('Byte');\nend;\n\nprocedure Test(Value: Word); overload;\nbegin\n  Writeln('Word');\nend;\n\nprocedure Test(Value: Cardinal); overload;\nbegin\n  Writeln('Cardinal');\nend;\n\nprocedure Test(Value: Uint64); overload;\nbegin\n  Writeln('Uint64');\nend;\n\nprocedure Main;\nvar\n  _byte: Byte;\n  _shortint: Shortint;\n  _word: Word;\n  _smallint: Smallint;\n  _cardinal: Cardinal;\n  _integer: Integer;\n  _uint64: UInt64;\n  _int64: Int64;\nbegin\n  Writeln('Unsigned variables passed as parameters:');\n  Test(_byte);\n  Test(_word);\n  Test(_cardinal);\n  Test(_uint64);\n  Writeln;\n  Writeln('Signed variables passed as parameters:');\n  Test(_shortint);\n  Test(_smallint);\n  Test(_integer);\n  Test(_int64);\nend;\n\nbegin\n  Main;\n  Readln;\nend.\n</code></pre>\n\n<p>When compiled by XE2 the output is:</p>\n\n<pre><code>Unsigned variables passed as parameters:\nByte\nWord\nCardinal\nUint64\n\nSigned variables passed as parameters:\nUint64\nUint64\nUint64\nUint64\n</code></pre>\n\n<p>On Delphi 6 I have to remove the <code>UInt64</code> overload since that type does not exist on Delphi 6 the output is:</p>\n\n<pre><code>Unsigned variables passed as parameters:\nByte\nWord\nCardinal\n\nSigned variables passed as parameters:\nByte\nByte\nByte\n</code></pre>\n\n<p>Again neither behaviour looks consistent with the statement that:</p>\n\n<blockquote>\n  <p>In these cases, when it is possible to do so without ambiguity, the\n  compiler invokes the routine whose parameters are of the <strong>type with the\n  smallest range that accommodates the actual parameters in the call</strong>.</p>\n</blockquote>\n"},{"tags":["delphi","delphi-xe2","vcl-styles"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":167,"score":1,"question_id":12543573,"title":"Delphi TListView DoubleBuffered doesn't work if you are using Styles","body":"<p>When you enable application styles and set TListView's DoubleBuffered property to True, it doesn't work. When you update listitems and their subitems, it flickers. Does anyone have a solution for this?</p>\n\n<p>I actually liked Styles however there are still technical issues. Now i can not trust styles.</p>\n\n<p>Thanks,\nK.</p>\n"},{"tags":["delphi","delphi-xe2","firemonkey"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":11710275,"title":"DBlookup combobox","body":"<p>I know this is questioned before, but i can't manage to get it work.\nIs there any sample for dblookup combobox with livebindigs (firemonkey) between a client data set and a combobox pointing to the FK of the client data set available.\nThank you in advance for any help.</p>\n"},{"tags":["delphi","firemonkey","delphi-xe3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12530189,"title":"Tms TileControl","body":"<p>Does anybody know, how to implement a close button on a tms tilecontrol, and have an event fired uppon mouse click? Its delphi xe3 firemonkey.\nAny help could be very helpfull.\nThank you in advance</p>\n"},{"tags":["delphi","attributes","annotations","nested"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":332,"score":3,"question_id":7173496,"title":"Nested Attributes in Delphi","body":"<p>Is there a way to use nested attributes in Delphi? At the moment I'm using Delphi XE.</p>\n\n<p>For example:</p>\n\n<pre><code>TCompoundAttribute = class (TCustomAttribute)\npublic\n  constructor Create (A1, A2 : TCustomAttribute)\nend;\n</code></pre>\n\n<p>And the usage would be</p>\n\n<pre><code>[ TCompoundAttribute (TSomeAttribute ('foo'), TOtherAttribute ('bar')) ]\n</code></pre>\n\n<p>At the moment this leads to an internal error. This would be a nice feature to create some boolean expressions on attributes.</p>\n"},{"tags":["windows","delphi","api","delphi-xe2","system32"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":307,"score":2,"question_id":11717826,"title":"Preventing WM_DEVICECHANGE from dispatching","body":"<p>I'm developing a Windows 7 application which has to prevent WinDVD from triggering new disc availability when inserted (i.e. inserting a DVD).</p>\n\n<p><strong>Background information:</strong></p>\n\n<p>I'm working out this little application for a company which has to compare two movie players at a time playing simultaneously the same DVD, from different drives. </p>\n\n<p>They're doing heuristic quality testing to determine best DVD player at the moment to bundle it into their new line of PCs. </p>\n\n<p>At the moment their best choice seem to be WinDVD, so every other test has to be conducted against it. Problem is, when they insert first DVD, it's all right the default player WinDVD starts.</p>\n\n<p>Then when they insert the second disc, the default player responds first, so they are forced to close the window and open the other player they're testing. </p>\n\n<p>This is done for many movies that represent a reference to them to spot color rendering and image quality. It becomes tedious for users to close the additional window when it shows up, as this operation is due to be repeated hundreds of times a week. </p>\n\n<p>My program is trying to inhibit default player' second response</p>\n\n<p>I thought to intercept a WM_DEVICECHANGE message to somehow create a global hook for it.</p>\n\n<p>Problem is, intercepting WM_DEVICECHANGE works very well, but it doesn't block WinDVD's ability to trigger new units insertion, evidently letting the message being delivered anyways. Due to this I started thinking how to prevent that message being dispatched after my interception.</p>\n\n<p>In order to realize this global hook I thought of, I'm using this line of code:</p>\n\n<pre><code>CurrentHook:=setwindowshookex(WH_CALLWNDPROC,HookProcAdd,LibHandle,0);\n</code></pre>\n\n<p>linked to the callback contained within a DLL of mine and I can see that WM_DEVICECHANGE is correctly intercepted, but as I said the message is still dispatched to the whole system.</p>\n\n<p>Any suggestion appreciated.</p>\n\n<h2>Updates:</h2>\n\n<p>@TOndrej : \nI've tried what follows:</p>\n\n<pre><code>var\n  rlen         : DWORD;\n  pRelen       : ^DWORD;\n  h            : THandle;\n  val : Boolean;\n  pVal: ^Boolean;\n  res : Boolean;\nbegin\n  rlen := 0;\n  val := True;\n  pVal := @val;\n  pRelen := @val;\n  h := CreateFile(PChar('\\\\.\\d:'), GENERIC_READ or GENERIC_WRITE, FILE_SHARE_READ or FILE_SHARE_WRITE, nil,\n    OPEN_EXISTING, 0, 0);\n  if h &lt;&gt; INVALID_HANDLE_VALUE then\n  begin\n    res:= DeviceIoControl(h,\n                          IOCTL_STORAGE_MCN_CONTROL,\n                          pVal,\n                          SizeOf(val),\n                          nil,\n                          0,\n                          rlen,\n                          nil);\n    if not res then\n    begin\n\n      ShowMessage('Error');\n    end;\n\n    CloseHandle(h);\n  end;\nend;\n</code></pre>\n\n<p>but res is false every time. What am I missing?</p>\n"},{"tags":["delphi"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":924,"score":4,"question_id":1954491,"title":"stop flickering","body":"<p>I have an old program written in borland pascal and in Delphi if I use the Form1.Canvas.LineTo and MoveTo functions I get a flickering effect. Can anyone tell me how to get rid of the flickering?</p>\n\n<p>thanks</p>\n"},{"tags":["delphi","delphi-xe","datasnap"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":124,"score":2,"question_id":12528504,"title":"Delphi XE Disconnect or Terminate a datasnap client session","body":"<p>We are developing a new Datasnap server (tcp/ip) with Delphi XE and have run into an issue. We do not know when the client disconnects in an abnormal way, ie. the connection is dropped or the client pc is rebooted.</p>\n\n<p>When a client establishes a connection we save it's details in a list as so:</p>\n\n<pre><code>TClientInfo = record\n  Id: integer;\n  Session: TDSSession;\n  LastSeen: TDateTime;\nend;\n...\nClientInfoList: TDictionary&lt;Integer, TClientInfo&gt;;\n...\n//OnConnect    \nClientInfo.ClientId := ClientId;\nClientInfo.Session := TDSSessionManager.GetThreadSession;\nClientInfo.LastSeen := Now();\nClientInfoList.Add(ClientId, ClientInfo); \n</code></pre>\n\n<p>Ideally we would want to iterate throught the ClientInforList and disconnect any client that has not been seen for 30 minutes, but this is where I have a problem.</p>\n\n<p>I have tried to disconnect or terminate the client session as follows without any luck.</p>\n\n<pre><code>for i in ServerContainer.ClientInfoList.Keys do\n  begin      \n    ClientInfo := TClientInfo(ServerContainer.ClientInfoList[i]);\n    ClientInfo.Session.Terminate;\n  end;\n</code></pre>\n\n<p>Is there a way of doing this in Delphi XE?</p>\n"},{"tags":["javascript","delphi","spidermonkey"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":113,"score":3,"question_id":12540713,"title":"Can I execute a Javascript function inside Spidermonkey and get the return value?","body":"<p>I'm just getting into using Delphi with Spidermonkey.  Previously I would load a web page into a TWebBrowser component and interact with the Javascript code in the loaded web page.  This was messy because to return values back to delphi I had to load them into a DOM object via the Javascript code and then inspect the DOM from Delphi to find that object and access it's <em>value</em> property.</p>\n\n<p>With Spidermonkey, can I execute a specific Javascript function and get the return value easily and directly back into Delphi?  If so, please point me to a quick code example that would be helpful.  The 3 samples that came with Spidermonkey don't seem to get into this.</p>\n"}]}
